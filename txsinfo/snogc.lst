SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOGC	MAC	16-Feb-67 12:03		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76

     1						SUBTTL	Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76
     2
     3					; COPYRIGHTS 1972,1973,1976,1977 STEVENS INSTITUTE OF TECHNOLOGY
     4					; HOBOKEN, NEW JERSEY, 07030
     5					; ALL RIGHTS RESERVED.
     6
     7					  ;UNIVERSALS
     8
     9						SEARCH	JOBDAT		;JOB DATA AREA DEFINITIONS
    10						SEARCH	MACTEN		;DEC-10 COMMON MACROS
    11						SEARCH	UUOSYM		;TOPS10 UUO SYMBOL DEFINITIONS
    12						SEARCH	SNOPRM		;SITBOL PARAMETER FILE
    13
    14					  ;DIRECTIVES
    15
    16						.DIRECT	.XTABM		;EXCLUDE TABS FROM MACRO CALLS
    17						SALL			;SUPPRESS MACRO EXPANSIONS
    18	400000'					TWOSEG	400K		;TWOSEGMENT CODE
    19
    20					  ;VERSION NUMBER
    21
    22			000005			GCVER==5		;MAJOR VERSION NUMBER
    23			000000			GCMIN==0		;MINOR VERSION NUMBER
    24			000305			GCEDT==305		;EDIT LEVEL
    25			000000			GCWHO==0		;CUSTOMER ARGUMENT
    26
    27					  ;TITLE
    28
    29						TITLE.	GC,SNOGC,<Garbage Collector>
    30		474300	000000			GCSIX==SIXBIT /GC/	; SNOGC ABBREVIATION IN SIXBIT
    31		436060	000000			GCASC==ASCIZ /GC/	; SNOGC ABBREVIATION IN ASCII
    32						SALL
    33
    34
    35					  ;SHOW UNIVERSAL VERSION NUMBERS
    36
    37	400000'	043100	000450			SHOW.	%%JOBD		;VERSION NUMBER OF JOBDAT
    38	400000'	000200	000025			SHOW.	%%MACT		;VERSION NUMBER OF MACTEN
    39	400000'	001400	000457			SHOW.	%%UUOS		;VERSION NUMBER OF UUOSYM
    40	400000'	000500	000305			SHOW.	%%SNOP		;VERSION NUMBER OF SNOPRM
    41
    42						GCTTL				; Title
    43						GCPTX				; PASS2 assembly message
SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 2
SNOGC	MAC	16-Feb-67 12:03		Table of Contents

    44						SUBTTL	Table of Contents
    45
    46					;		Table of Contents for Garbage Collector
    47					;
    48					;
    49					;			   Section			      Page
    50					;   1. Table of Contents. . . . . . . . . . . . . . . . . . .    2
    51					;   2. REVISION HISTORY . . . . . . . . . . . . . . . . . . .    3
    52					;   3. MISC DEFINITIONS . . . . . . . . . . . . . . . . . . .    4
    53					;   4. ENTRY POINTS . . . . . . . . . . . . . . . . . . . . .    5
    54					;   5. GENERAL DISPATCHING. . . . . . . . . . . . . . . . . .    7
    55					;   6. STACK MARKING. . . . . . . . . . . . . . . . . . . . .    9
    56					;   7. GRID MARKING . . . . . . . . . . . . . . . . . . . . .   10
    57					;   8. SPECIAL BLOK MARKING PROCEDURES. . . . . . . . . . . .   12
    58					;   9. PHASE II - ADDRESS MODIFICATION. . . . . . . . . . . .   20
    59					;  10. - PHASE III (DATA MOVEMENT). . . . . . . . . . . . . .   22
    60					;  11. FINAL WRAP-UP. . . . . . . . . . . . . . . . . . . . .   24
SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 3
SNOGC	MAC	16-Feb-67 12:03		REVISION HISTORY

    61						SUBTTL	REVISION HISTORY
    62
    63					COMMENT	\
    64
    65					START OF VERSION 5.
    66					122	RENAME MODULES & CLEAN UP.
    67					270	Clean some misc. things in SNOGC.
    68					305	CORE UUO in SNOGC should use ADDI, not IORI to round to next 1K.
    69					\
SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 4
SNOGC	MAC	16-Feb-67 12:03		MISC DEFINITIONS

    70						SUBTTL	MISC DEFINITIONS
    71
    72			000000*			NFLOOR==IGNOQ##		; NEW FLOOR
    73		000000000000#			BLIST==IGNOQ##+1	; BLOK LIST
    74

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 5
SNOGC	MAC	16-Feb-67 12:03		ENTRY POINTS

    75						SUBTTL	ENTRY POINTS
    76
    77	400000'	265 11 0 00 000000*	CLLCT::	JSP	TLINK,CVTINT##	; 2ND ARGUMENT
    78	400001'	003 01 0 00 000071 		ERROR.	1,57		; BAD ARGUMENT
    79
    80	400002'	332 05 0 01 000000 		SKIPE	P2,0(STACK)	; WAS THE ARGUMENT 0?
    81	400003'	202 05 0 00 000000*		MOVEM	P2,TOOMCH##	; NO, USE IT AS MAX. SLACK
    82	400004'	274 01 0 00 400665'		SUB	STACK,[2,,2]	; POP STACK
    83						 ; 
    84	400005'	265 11 0 00 400000*		JSP	TLINK,CVTINT	; 1ST ARGUMENT
    85	400006'	003 01 0 00 000071 		ERROR.	1,57		; BAD ARGUMENT
    86
    87	400007'	332 05 0 01 000000 		SKIPE	P2,0(STACK)	; WAS ARG 0?
    88	400010'	202 05 0 00 000000*		MOVEM	P2,BROOM##	; NO, USE AS BREATHING ROOM
    89	400011'	265 06 0 00 400024'		JSP	SLINK,CGCOL	; ORDER UP ONE COMPLETE GC
    90
    91	400012'	400 17 0 00 000000 		CLEAR	Q3,		; DETERMINE ...
    92	400013'	047 17 0 00 000011 		CORE	Q3,		; MAX CORE
    93	400014'	240 17 0 00 000012 		ASH	Q3,^D10		; IN WORDS
    94
    95	400015'	200 16 0 00 000115 		MOVE	Q2,.JBHRL	; LOAD SIZE -1 OF ...
    96	400016'	275 16 0 00 000000*		SUBI	Q2,JOBHGH##	;[270] THIS IS THE HIGH SEGMENT
    97	400017'	270 16 0 00 000044 		ADD	Q2,.JBREL	; INCREASE BY SIZE-1 OF LOW
    98	400020'	275 17 0 16 000002 		SUBI	Q3,2(Q2)	; FIND AMOUNT LEFT
    99	400021'	270 00 0 00 000017 		ADD	Z,Q3		; ADD TO RETURNED VALUE
   100
   101	400022'	202 00 0 01 000000 		MOVEM	Z,0(STACK)	; RETURN SUM
   102	400023'	254 00 0 04 000001 		JRST	1(PLINK)	; NORMAL RETURN
   103
   104						 ; TYPE S ROUTINE TO PERFORM A COMPLETE
   105						 ; GARBAGE COLLECTION (DESTROY FLAP## ADDRESSES)
   106
   107	400024'				CGCOL::	 ;
   108						 ; CLEAR OUT FLOATING ADDRESSES IN SAVE AREAS
   109
   110	400024'	402 00 0 00 000000*		CLEARM	FLAP##		; CLEAR ...
   111	400025'	402 00 0 00 000000#		CLEARM	FLAP+2		; PRIMARY AREA
   112	400026'	200 00 0 00 400666'		MOVE	Z,[SAVEP##,,SAVES##]; THEN ...
   113	400027'	251 00 0 00 000000#		BLT	Z,FLAQ##+3	; COPY AREA TO S,T & Q
   114
   115	400030'	402 00 0 00 000000*		CLEARM	SEDIM##		; CLEAR THE SEDIMENT
   116	400031'	402 00 0 00 000000*		CLEARM	SUBJ##		; DELETE THE SUBJECT
   117
   118	400032'	265 15 0 00 400034'		JSP	QLINK,GCOL	; GARBAGE COLLECT
   119	400033'	254 00 0 06 000000 		JRST	0(SLINK)	; AND RETURN
   120

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 6
SNOGC	MAC	16-Feb-67 12:03		ENTRY POINTS

   121						 ; TYPE Q ENTRY POINTS TO THE GARBAGE COLLECTOR
   122
   123						 ; GCOL, UNCONDITIONALLY COLLECT STORAGE
   124
   125	400034'	476 00 0 00 000000#	GCOL::	SETOM	IGNOQ##+2		; FLAG ENTRY POINT
   126	400035'	402 00 0 00 000000#		CLEARM	IGNOQ+3		; NO EXCESS NEEDED
   127	400036'	254 00 0 00 400060'		JRST	GCOLF1		; JOIN GCOLF PROLOGUE
   128
   129						 ; GCOLG, GARBAGE COLLECT TO ENSURE SUPPLY OF GROWING STORAGE
   130
   131	400037'	200 17 0 00 000000*	GCOLG::	MOVE	Q3,FLOOR##	; FIND AMOUNT LEFT
   132	400040'	274 17 0 00 000000*		SUB	Q3,GSURF##	; IN GRID
   133	400041'	317 00 0 00 000017 		CAMG	Z,Q3		; ENOUGH LEFT?
   134	400042'	254 00 0 15 000000 		JRST	0(QLINK)	; YES
   135
   136	400043'	402 00 0 00 400030*		CLEARM	SEDIM		; SEDIMENT GETS MOVED
   137	400044'	402 00 0 00 000000#		CLEARM	IGNOQ##+2		; FLAG ENTRY
   138	400045'	202 00 0 00 000000#		MOVEM	Z,IGNOQ+3	; SAVE ORIGINAL REQUEST
   139	400046'	270 00 0 00 400040*		ADD	Z,GSURF##		; ADD PRESENT SURFACE
   140	400047'	271 00 0 00 000764 		ADDI	Z,XGRID		; GIVE A LITTLE EXTRA
   141	400050'	202 00 0 00 000000*		MOVEM	Z,NFLOOR	; ESTABLISH AS NEW FLOOR
   142	400051'	254 00 0 00 400062'		JRST	GCOLF2		; JOIN GCOLF PROLOGUE
   143
   144						 ; GCOLF, GARBAGE COLLECT TO ENSURE FLOATING STORAGE
   145
   146	400052'	200 17 0 00 000000*	GCOLF::	MOVE	Q3,CEIL##		; FIND AMOUNT
   147	400053'	274 17 0 00 000002 		SUB	Q3,SURF		; LEFT
   148	400054'	317 00 0 00 000017 		CAMG	Z,Q3		; ENOUGH?
   149	400055'	254 00 0 15 000000 		JRST	0(QLINK)	; YES
   150
   151	400056'	402 00 0 00 000000#		CLEARM	IGNOQ+2		; FLAG ENTRY
   152	400057'	202 00 0 00 000000#		MOVEM	Z,IGNOQ+3	; SAVE ORIGNAL VALUE
   153
   154						 ; HERE FORM GCOL
   155
   156	400060'	200 00 0 00 400037*	GCOLF1:	MOVE	Z,FLOOR		; OLD FLOOR IS ...
   157	400061'	202 00 0 00 400050*		MOVEM	Z,NFLOOR	; GOOD ENOUGH
   158
   159						 ; HERE FROM GCOLF
   160
   161	400062'	265 00 0 00 000000*	GCOLF2:	PUSHR	PSTQ		; SAVE ALL REGISTERS
   162	400063'	000015	000004
   163	400064'	350 00 0 00 000000*		AOS	NGCS##		; INDICATE FACT OF GCOL
   164
   165	400065'	200 15 0 00 400060*		MOVE	Q1,FLOOR	; IF NO SEDIMENT
   166	400066'	336 00 0 00 400043*		SKIPN	SEDIM		; THEN USE FLOOR
   167	400067'	202 15 0 00 400066*		MOVEM	Q1,SEDIM	; AS THE SEDIMENTARY LEVEL
   168
   169	400070'	200 00 0 00 400065*		MOVE	Z,FLOOR		; INSERT A ...
   170	400071'	274 00 0 00 400046*		SUB	Z,GSURF		; DUMMY BLOK HEADER ...
   171	400072'	322 00 0 00 400200'		JUMPE	Z,GCI		; INTO THE GROWING ...
   172	400073'	505 00 0 00 000417 		HRLI	Z,JKBLOK	; REGION IN ORDER ...
   173	400074'	200 17 0 00 400071*		MOVE	Q3,GSURF	; TO BRIDGE THE GAP BETWEEN ...
   174	400075'	202 00 0 17 000000 		MOVEM	Z,BTCODE&BLENG(Q3) ; GROWING AND FLOATING STORE
SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 6-1
SNOGC	MAC	16-Feb-67 12:03		ENTRY POINTS

   175
   176	400076'	254 00 0 00 400200'		JRST	GCI		; JOIN PHASE I
   177

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 7
SNOGC	MAC	16-Feb-67 12:03		GENERAL DISPATCHING

   178						SUBTTL	GENERAL DISPATCHING
   179
   180						 ; RECOVERY NUMBERS
   181
   182			000001			RC.STK==1		; STACKS
   183			000002			RC.GB==2		; GRID BLOKS
   184			000003			RC.VB==3		; VARIABLE BLOKS
   185			000000			RC.HST==0		; HISTORY STACK
   186
   187	400077'	400245'	400132'		GCDISP:	RECOHS,,GCLERR		; HISTORY STACK RECOVERY
   188	400100'	400224'	400132'			RECOSK,,GCLERR		; INTEGER (STACK RECOVERY)
   189	400101'	400272'	400132'			RECOGB,,GCLERR		; REAL (GRID BLOK RECOVERY)
   190	400102'	400310'	000000			RECOVB,,0		; STRING (VARIABLE BLOCK RECOVERY)
   191	400103'	400321'	400317'			RECOP,,MARKP		; PATTERN
   192	400104'	400340'	400332'			RECOA,,MARKA		; ARRAY
   193	400105'	400350'	400343'			RECOC,,MARKC		; EXPRESSION
   194	400106'	400350'	400343'			RECOC,,MARKC		; CODE
   195	400107'	400363'	400353'			RECOT,,MARKT		; TABLE
   196	400110'	400132'	400132'			GCLERR,,GCLERR		; NO BLOK ASS. WITH NDT
   197	400111'	400405'	400401'			RECOD,,MARKD		; DEFINED DATATYPE
   198	400112'	400132'	000000			GCLERR,,0		; CHARACTER TABLE
   199	400113'	400377'	400367'			RECOUT,,MARKUT		; UTILITY
   200	400114'	400132'	000000			GCLERR,,0		; I/O BLOK
   201						IFN <.-GCDISP>-<TEBLOK&77>,<PRINTX GCDISP TABLE IS OFF>
   202	400115'	400417'	400410'			RECOTE,,MARKTE		; TABLE ELEMENT
   203	400116'	400132'	000000			GCLERR,,0		; JUNK BLOK
   204	400117'	400132'	000000			GCLERR,,0		; DEFINED FUNCTION
   205	400120'	400132'	000000			GCLERR,,0		; DATATYPE FBLOK
   206	400121'	400431'	400424'			RECOFF,,MARKFF		; FIELD FBLOK
   207	400122'	400132'	000000			GCLERR,,0		; EXTERNAL FBLOK
   208	400123'	400363'	400365'			RECOT,,MARKTF		; TRACED FBLOK
   209	400124'	400377'	400367'			RECOUT,,MARKUT		; TRACE BLOK
   210	400125'	400377'	400367'			RECOUT,,MARKUT		; INPUT-ASSOCIATED BLOK
   211	400126'	400377'	400367'			RECOUT,,MARKUT		; OUTPUT-ASSOCIATED BLOK
   212	400127'	400132'	000000			GCLERR,,0		; BUFFER BLOK
   213	400130'	400132'	000000			GCLERR,,0		; OLD BUFFER BLOK
   214						IFN <.-GCDISP>-<STBLOK&77>,<PRINTX GCDISP TABLE IS OFF>
   215	400131'	400132'	000000			GCLERR,,0		; STREAM BLOK
   216
   217	400132'	001 17 0 00 000000 	GCLERR:	ERROR	15
   218

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 8
SNOGC	MAC	16-Feb-67 12:03		GENERAL DISPATCHING

   219						; PROFLC - PROCESS A FLOATING ADDRESS CONDITIONALLY 
   220						; (ON THE APPEARANCE OF THE FLDC BIT)
   221						; T3 CONTAINS ADDRESS OF POTENTIALLY FLOATING ADDRESS
   222
   223	400133'	616 06 0 13 000000 	PROFLC:	TDNN	S1,0(T3)	; FLOATING?
   224	400134'	254 00 0 15 000000 		JRST	0(QLINK)	; NO
   225
   226						 ; PROFLU - UNCONDITIONAL FLOATING ADDRESS
   227
   228	400135'	550 16 0 13 000000 	PROFLU:	HRRZ	Q2,0(T3)	; LOAD ADDRESS
   229	400136'	311 16 0 00 400070*		CAML	Q2,FLOOR	; BELOW THE FLOOR ?
   230	400137'	311 16 0 00 000002 		CAML	Q2,SURF		; OR ABOVE THE SURFACE?
   231	400140'	254 00 0 15 000000 		JRST	0(QLINK)	; YES, RETURN
   232
   233	400141'	311 16 0 00 400067*		CAML	Q2,SEDIM	; POINTING TO SEDIMENT?
   234	400142'	254 00 0 00 400146'		JRST	PROFL1		; NO
   235	400143'	336 00 0 16 000001 		SKIPN	GCFLD(Q2)	; YES, IF NOT PREV. MARKED
   236	400144'	476 00 0 16 000001 		SETOM	GCFLD(Q2)	; MARK IT ...
   237	400145'	254 00 0 15 000000 		JRST	0(QLINK)	; AND RETURN
   238
   239	400146'	550 17 0 16 000001 	PROFL1:	HRRZ	Q3,GCFLD(Q2)	; LOAD TOP OF LIST
   240
   241	400147'	542 13 0 16 000001 		HRRM	T3,GCFLD(Q2)	; INSERT OUR POINTER
   242	400150'	542 17 0 13 000000 		HRRM	Q3,0(T3)	; INSERT HIS IN OURS
   243	400151'	326 17 0 15 000000 		JUMPN	Q3,0(QLINK)	; IF PREVIOUSLY MARKED, RETURN
   244
   245						 ; FALL THRU IF BLOK HAS NOT PREVIOUSLY BEEN MARKED
   246
   247	400152'	554 17 0 16 000000 		HLRZ	Q3,BTCODE(Q2)	; LOAD BLOK TYPE
   248	400153'	405 17 0 00 000077 		ANDI	Q3,DTNUM	; MAKE AN INDEX
   249	400154'	550 17 0 17 400077'		HRRZ	Q3,GCDISP(Q3)	; LOAD ADDRESS OF PROCESSOR
   250	400155'	322 17 0 15 000000 		JUMPE	Q3,0(QLINK)	; RETURN IF NONE REQUIRED
   251
   252	400156'	506 14 0 16 000001 		HRLM	T4,GCFLD(Q2)	; INSERT BACK POINTER
   253	400157'	200 14 0 00 000016 		MOVE	T4,Q2		; POINT TO NEW BLOK
   254	400160'	254 00 0 17 000000 		JRST	0(Q3)		; BEGIN NEW BLOK
   255
   256						 ; GENERALIZED RECOVERY PROCEDURE
   257						 ; FIRST WALK DOWN CHAIN UNTIL A 0 IS FOUND
   258
   259	400161'	550 13 0 14 000001 	RECO:	HRRZ	T3,GCFLD(T4)	; LOAD HEAD OF CHAIN
   260
   261	400162'	550 00 0 13 000000 	RECO1:	HRRZ	Z,0(T3)		; TEST FOR ...
   262	400163'	322 00 0 00 400166'		JUMPE	Z,RECO2		; ZERO, JUMP IF
   263	400164'	200 13 0 00 000000 		MOVE	T3,Z		; ADVANCE IF NOT ZERO
   264	400165'	254 00 0 00 400162'		JRST	RECO1		; AND LOOP
   265
   266	400166'	554 14 0 14 000001 	RECO2:	HLRZ	T4,GCFLD(T4)	; LOAD PREVIOUS BLOK ADDR
   267	400167'	554 17 0 14 000000 		HLRZ	Q3,BTCODE(T4)	; GET BLOK TYPE
   268	400170'	405 17 0 00 000077 		ANDI	Q3,DTNUM	; MASK TO GET BLOK NUMBER
   269	400171'	554 16 0 17 400077'		HLRZ	Q2,GCDISP(Q3)	; PICK UP RECOVERY ADDR
   270	400172'	254 00 0 16 000000 		JRST	0(Q2)		; JUMP INDIRECT
   271

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 9
SNOGC	MAC	16-Feb-67 12:03		STACK MARKING

   272						SUBTTL	STACK MARKING
   273
   274						 ; STACK CONTROL WORDS
   275
   276	400173'	000000*	000001		SCW:	XWD	STBASE##,STACK	; SYSTEM STACK
   277	400174'	000000*	000000*			XWD	NSBASE##,NSTACK##	; NAME STACK
   278	400175'	400176'	400177'		LSCW:	XWD	.+1,.+2		; TENDED FID AREA
   279	400176'	000000000000#			EXP	TENDED##-1,AID##-1
   280	400177'	000000000000#
   281
   282						 ; HERE TO BEGIN MARKING EVERYTHING
   283
   284	400200'	505 06 0 00 004000 	GCI:	HRLI	S1,FLDC		; S1 IS NEVER CHANGED
   285
   286						 ; FIRST LOOK AT THE STACKS
   287
   288	400201'	201 04 0 00 400172'		MOVEI	P1,SCW-1	; POINT ABOVE STACK CONTROL WORDS
   289	400202'	201 14 0 00 000004 		MOVEI	T4,P1	 	; P1 IS A FAKE HEAD
   290
   291						 ; LOOP HERE TO PROCESS NEXT STACK
   292
   293	400203'	201 04 0 04 000001 	GCI.1:	MOVEI	P1,1(P1)	; POINT TO NEXT CONTROL WORD
   294	400204'	303 04 0 00 400175'		CAILE	P1,LSCW		; BEYOND LAST CONTROL WORD?
   295	400205'	254 00 0 00 400226'		JRST	GCI.HS		; GO PROCESS HISTORY STACK
   296
   297	400206'	505 04 0 00 000001 		HRLI	P1,RC.STK	; INSERT RECOVERY CODE
   298
   299						 ; LOAD P2 WITH UPPER LIMIT
   300						 ; T3 WITH FIRST ELEMENT ADDRESS
   301
   302	400207'	550 15 0 04 000000 		HRRZ	Q1,0(P1)	; LOAD POINTER TO STACK WORD
   303	400210'	550 05 0 15 000000 		HRRZ	P2,0(Q1)	; LOAD LAST ADDRESS OF STACK
   304
   305	400211'	554 15 0 04 000000 		HLRZ	Q1,0(P1)	; LOAD POINTER TO STACK BASE
   306	400212'	550 13 0 15 000000 		HRRZ	T3,0(Q1)	; LOAD ADDRESS OF BASE
   307	400213'	271 13 0 00 000001 		ADDI	T3,1		; POINT DIRECTLY AT FIRST ENTRY
   308
   309						 ; LOOP TO PROCESS NEXT STACK ITEM
   310
   311	400214'	311 13 0 00 000005 	GCI.2:	CAML	T3,P2		; ARE WE BELOW THE STACK TOP?
   312	400215'	254 00 0 00 400203'		JRST	GCI.1		; NO - GET NEXT STACK
   313
   314	400216'	200 12 0 13 000000 		MOVE	T2,0(T3)	; LOAD FIRST DESCRIPTOR
   315	400217'	607 12 0 00 001000 		TLNN	T2,SJUNKF	; JUNK?
   316	400220'	254 00 0 00 400223'		JRST	GCI.3		; NO
   317
   318	400221'	271 13 0 12 000000 		ADDI	T3,0(T2)	; BUMP OVER JUNK
   319	400222'	254 00 0 00 400214'		JRST	GCI.2		; AND LOOP
   320
   321	400223'	265 15 0 00 400133'	GCI.3:	JSP	QLINK,PROFLC	; PROCESS ITEM
   322
   323						 ; STACK RECOVERY POINT
   324
   325	400224'	201 13 0 13 000002 	RECOSK:	MOVEI	T3,2(T3)	; SKIP TO NEXT
SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 9-1
SNOGC	MAC	16-Feb-67 12:03		STACK MARKING

   326	400225'	254 00 0 00 400214'		JRST	GCI.2		; AND LOOP
   327
   328						 ; MARKING THE HISTORY STACK
   329
   330						 ; LOOK FOR A WORD OF THE FORM D.EX3,,----
   331						 ; THE NEXT WORD SHOULD BE PROCESSED UNCONDITIONALLY
   332						 ; IF ANYTHING INTERESTING IT WILL BE A PATTERN
   333
   334	400226'	550 13 0 00 000000*	GCI.HS:	HRRZ	T3,HSBASE##	; LOAD ADDRESS ...
   335	400227'	271 13 0 00 000001 		ADDI	T3,1		; OF BASE OF HISTORY STACK
   336	400230'	550 05 0 00 000003 		HRRZ	P2,HSR		; LOAD CURREN TOP OF HSTACK
   337	400231'	515 04 0 00 000000 		HRLZI	P1,RC.HST	; P1 HOLDS THE RECOVERY TYPE
   338	400232'	201 14 0 00 000004 		MOVEI	T4,P1		; POINT TO PSUEDO BLOK HEAD
   339
   340	400233'	311 13 0 00 000005 	GCI.H1:	CAML	T3,P2		; ARE WE DONE?
   341	400234'	254 00 0 00 400246'		JRST	GCI.GR		; YES
   342
   343	400235'	554 11 0 13 000000 		HLRZ	T1,0(T3)	; LOAD TYPE
   344	400236'	302 11 0 00 000000*		CAIE	T1,D.EX3##	; LOOKING FOR ONE OF THESE
   345	400237'	344 13 0 00 400233'		AOJA	T3,GCI.H1	; LOOP BACK
   346
   347	400240'	340 13 0 00 000000 		AOJ	T3,		; INCREMENT
   348	400241'	554 11 0 13 000000 		HLRZ	T1,0(T3)	;T CHECK TYPE
   349	400242'	302 11 0 00 004004 		CAIE	T1,PDT		; BETTER BE PATTERN
   350	400243'	001 17 0 00 000000 		ERROR	15		; COMPLAIN
   351	400244'	265 15 0 00 400133'		JSP	QLINK,PROFLC	; PROCESS IT
   352
   353						 ; HISTORY STACK RECOVERY POINT
   354
   355	400245'	344 13 0 00 400233'	RECOHS:	AOJA	T3,GCI.H1	; BACK FOR MORE
   356

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 10
SNOGC	MAC	16-Feb-67 12:03		GRID MARKING

   357						SUBTTL	GRID MARKING
   358
   359	400246'	200 05 0 00 400141*	GCI.GR:	MOVE	P2,SEDIM	; UPPER LIMIT
   360	400247'	200 13 0 00 000000*		MOVE	T3,GRID##	; STARTING POINT
   361
   362	400250'	311 13 0 00 000005 	GCI.G1:	CAML	T3,P2		; WITHIN BOUNDS?
   363	400251'	254 00 0 00 400434'		JRST	GCII		; NO - OFF TO PHASE II
   364
   365	400252'	200 12 0 13 000000 		MOVE	T2,BTCODE&BLENG(T3) ; LOAD CODE-LENGTH
   366	400253'	607 12 0 00 000400 		TLNN	T2,BLOKF	; A BLOK?
   367	400254'	254 00 0 00 400275'		JRST	GCI.V		; NO - PROCESS VARIABLE
   368
   369						 ; A BLOK HAS BEEN FOUND IN TH GRID AREA
   370
   371	400255'	554 11 0 13 000000 		HLRZ	T1,BTCODE(T3)	; FROM THE BLOK TYPE
   372	400256'	405 11 0 00 000077 		ANDI	T1,DTNUM	; FIND ITS INDEX
   373	400257'	550 15 0 11 400077'		HRRZ	Q1,GCDISP(T1)	; GET PROCESSING ADDRESS
   374	400260'	326 15 0 00 400263'		JUMPN	Q1,GCI.G2	; UNLESS 0, JUMP
   375
   376						 ; NO PROCESSING NEEDED
   377
   378	400261'	271 13 0 12 000000 		ADDI	T3,0(T2)	; SKIP PAST BLOK
   379	400262'	254 00 0 00 400250'		JRST	GCI.G1		; AND LOOP
   380
   381						 ; HERE IF BLOK HAS FLOATNG ADDRESSES
   382
   383	400263'	505 04 0 00 000002 	GCI.G2:	HRLI	P1,RC.GB	; INSERT RECOVERY CODE
   384	400264'	540 04 0 00 000013 		HRR	P1,T3		; SAVE STATE HERE
   385	400265'	504 00 0 00 000014 		HRL	Z,T4		; POINTER TO RECOVERY CODE
   386	400266'	541 00 0 00 400667'		HRRI	Z,[0]		; AND POINTER TO PSUEDO-LIST
   387	400267'	202 00 0 13 000001 		MOVEM	Z,GCFLD(T3)	; INTO GCFLD FOR RECOVERY
   388
   389	400270'	200 14 0 00 000013 		MOVE	T4,T3		; POINT TO BLOK AND ...
   390	400271'	254 00 0 15 000000 		JRST	0(Q1)		; JUMP TO PROCESS IT.
   391
   392						 ; RECOVERY OPERATION FOR GRID BLOKS
   393
   394	400272'	550 13 0 04 000000 	RECOGB:	HRRZ	T3,BLENG(P1)	; LOAD LENGTH OF BLOK
   395	400273'	271 13 0 04 000000 		ADDI	T3,0(P1)	; ADD ADDRESS OF BLOK
   396	400274'	254 00 0 00 400250'		JRST	GCI.G1		; AND LOOP
   397

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 11
SNOGC	MAC	16-Feb-67 12:03		GRID MARKING

   398						 ; VARIABLE BLOCK PROCESSING
   399
   400	400275'	505 04 0 00 000003 	GCI.V:	HRLI	P1,RC.VB	; TYPE OF PROCESSING
   401	400276'	540 04 0 00 000013 		HRR	P1,T3		; POINT TO VB-TOP
   402	400277'	265 15 0 00 400133'		JSP	QLINK,PROFLC	; PROCESS VALUE OF VARIABLE
   403
   404	400300'	201 13 0 04 000002 	GCI.V1:	MOVEI	T3,VLABEL(P1)	; PROCESS LABEL ...
   405	400301'	265 15 0 00 400135'		JSP	QLINK,PROFLU	; FIELD
   406
   407	400302'	201 13 0 04 000003 	GCI.V2:	MOVEI	T3,VFUNC(P1)	; PROCESS FUNCTION ...
   408	400303'	265 15 0 00 400135'		JSP	QLINK,PROFLU	; FIELD
   409
   410	400304'	201 13 0 04 000004 	GCI.V3:	MOVEI	T3,VNAME(P1)	; PROCESS NAME ...
   411	400305'	265 15 0 00 400133'		JSP	QLINK,PROFLC	; FIELD
   412
   413	400306'	201 13 0 04 000007 	GCI.V4: MOVEI	T3,VARSIZ(P1)	; POINT TO BEYOND VB
   414	400307'	254 00 0 00 400250'		JRST	GCI.G1		; AND JOIN MAIN GRID LOOP
   415
   416						 ; HERE FOR RECOVERY DURING VARIABLE BLOCK PROCESSING
   417
   418	400310'	306 13 0 04 000000 	RECOVB:	CAIN	T3,VALUE(P1)	; PROCESSING VALUE?
   419	400311'	254 00 0 00 400300'		JRST	GCI.V1		; YES
   420
   421	400312'	306 13 0 04 000002 		CAIN	T3,VLABEL(P1)	; LABEL?
   422	400313'	254 00 0 00 400302'		JRST	GCI.V2		; YES
   423
   424	400314'	306 13 0 04 000003 		CAIN	T3,VFUNC(P1)	; FUNCTION FIELD
   425	400315'	254 00 0 00 400304'		JRST	GCI.V3		; YES
   426
   427	400316'	254 00 0 00 400306'		JRST	GCI.V4		; MUST BE END
   428

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 12
SNOGC	MAC	16-Feb-67 12:03		SPECIAL BLOK MARKING PROCEDURES

   429						SUBTTL	SPECIAL BLOK MARKING PROCEDURES
   430
   431						 ; MARKING FOR PATTERN
   432
   433	400317'	201 13 0 14 000002 	MARKP:	MOVEI	T3,PSTART(T4)	; POINT TO FIRST DESCRIPTOR
   434	400320'	265 15 0 00 400133'		JSP	QLINK,PROFLC	; PROCESS DESCRIPTO
   435
   436						 ; HERE FOR RECOVERY AND INITIALIZATON
   437
   438	400321'	550 12 0 14 000000 	RECOP:	HRRZ	T2,BLENG(T4)	; LOAD LENGTH OF PATTERN
   439	400322'	271 12 0 14 000000 		ADDI	T2,0(T4)	; FND ADDRESS OF BOTTOM
   440	400323'	306 13 0 14 000002 		CAIN	T3,PSTART(T4)	; IF AT BEGINNING
   441	400324'	201 13 0 14 000003 		MOVEI	T3,LPHDR+PARG-PNDSZ(T4)	; INITIALIZE
   442
   443	400325'	271 13 0 00 000004 	MARKP1:	ADDI	T3,PNDSZ	; POINT TO NEXT NODE
   444	400326'	311 13 0 00 000012 		CAML	T3,T2		; WITHIN BOUNDS?
   445	400327'	254 00 0 00 400161'		JRST	RECO		; NO - RECOVER
   446	400330'	265 15 0 00 400133'		JSP	QLINK,PROFLC	; PROCESS FLOATING ADDR
   447	400331'	254 00 0 00 400325'		JRST	MARKP1		; AND REPEAT
   448

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 13
SNOGC	MAC	16-Feb-67 12:03		SPECIAL BLOK MARKING PROCEDURES

   449						 ; ARRAY BLOK (ABLOK) PROCESSING
   450
   451	400332'	201 13 0 14 000002 	MARKA:	MOVEI	T3,APROTO(T4)	; PROCESS ...
   452	400333'	265 15 0 00 400133'		JSP	QLINK,PROFLC	; PROTOTYPE
   453
   454	400334'	550 13 0 14 000004 	MARKA1:	HRRZ	T3,NSUBS(T4)	; LOAD # OF SUBSCRIPTS
   455	400335'	242 13 0 00 000001 		LSH	T3,1		; DOUBLE IT
   456	400336'	271 13 0 14 000005 		ADDI	T3,SUBFAC(T4)	; POINT TO FIRST ELEMENT
   457	400337'	254 00 0 00 400370'		JRST	MRKUT1		; TREAT LIKE A UTILITY
   458
   459						 ; HERE FOR ARRAY RECOVERY
   460
   461	400340'	302 13 0 14 000002 	RECOA:	CAIE	T3,APROTO(T4)	; WERE WE PROCESSING PROTOTYPE?
   462	400341'	254 00 0 00 400377'		JRST	RECOUT		; NO - TREAT LIKE UTILITY
   463	400342'	254 00 0 00 400334'		JRST	MARKA1		; YES - FIND FIRST ELEMENT
   464

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 14
SNOGC	MAC	16-Feb-67 12:03		SPECIAL BLOK MARKING PROCEDURES

   465						 ; CODE BLOK MARKING
   466
   467	400343'	201 13 0 14 000002 	MARKC:	MOVEI	T3,LCLINK(T4)	; PROCESS LAST 
   468	400344'	265 15 0 00 400135'		JSP	QLINK,PROFLU	; CODE BLOK
   469
   470	400345'	201 13 0 14 000003 	MARKC1:	MOVEI	T3,NCLINK(T4)	; PROCESS NEXT ...
   471	400346'	265 15 0 00 400135'		JSP	QLINK,PROFLU	; CODE BLOK
   472
   473	400347'	254 00 0 00 400161'		JRST	RECO		; ALL DONE, JUST RECOVER
   474	 
   475
   476						 ; HERE FOR RECOVERY DURING CBLOK PROCESSING
   477
   478	400350'	306 13 0 14 000002 	RECOC:	CAIN	T3,LCLINK(T4)	; WERE WE HERE LAST?
   479	400351'	254 00 0 00 400345'		JRST	MARKC1		; YES - JOIN CODE PROCESSING
   480	400352'	254 00 0 00 400161'		JRST	RECO		; NO - JUST RECOVER
   481

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 15
SNOGC	MAC	16-Feb-67 12:03		SPECIAL BLOK MARKING PROCEDURES

   482						 ; MARKING TABLES (AND TFBLOKS)
   483
   484
   485	400353'	201 13 0 14 000003 	MARKT:	MOVEI	T3,TBUCK(T4)	; POINT TO FIRST BUCKET
   486	400354'	550 12 0 14 000000 	MARKT1:	HRRZ	T2,BLENG(T4)	; PLACE LIMIT ...
   487	400355'	271 12 0 14 000000 		ADDI	T2,0(T4)	; IN T2
   488	400356'	311 13 0 00 000012 	MARKT2:	CAML	T3,T2		; ARE WE STILL BELOW LIMIT
   489	400357'	254 00 0 00 400161'		JRST	RECO		; NO - RECOVER
   490
   491	400360'	265 15 0 00 400135'		JSP	QLINK,PROFLU	; PROCESS ELEMENT
   492	400361'	271 13 0 00 000001 		ADDI	T3,1		; INCREMENT POINTER
   493	400362'	254 00 0 00 400356'		JRST	MARKT2		; AND LOOP
   494
   495						 ; RECOVERY POINT FOR TABLES
   496
   497	400363'	271 13 0 00 000001 	RECOT:	ADDI	T3,1		; INCREMENT POINTER
   498	400364'	254 00 0 00 400354'		JRST	MARKT1		; AND GO RESTORE LIMIT
   499
   500						 ; TFBLOK PROCESSING
   501
   502	400365'	201 13 0 14 000004 	MARKTF:	MOVEI	T3,TFOLD(T4)	; POINT TO FIRST FIELD
   503	400366'	254 00 0 00 400354'		JRST	MARKT1		; JOIN TABLE PROCESSING
   504

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 16
SNOGC	MAC	16-Feb-67 12:03		SPECIAL BLOK MARKING PROCEDURES

   505						 ; UTILITY BLOK (UTBLOK) PROCESSING
   506
   507	400367'	201 13 0 14 000002 	MARKUT:	MOVEI	T3,LHDR(T4)	; POINT TO FIRST DESCRIPTOR
   508	400370'	550 12 0 14 000000 	MRKUT1:	HRRZ	T2,BLENG(T4)	; LENGTH OF BLOK
   509	400371'	271 12 0 14 000000 		ADDI	T2,0(T4)	; POINTER BEYOND BLOK
   510	400372'	311 13 0 00 000012 	MRKUT2:	CAML	T3,T2		; BEYOND BLOK?
   511	400373'	254 00 0 00 400161'		JRST	RECO		; YES
   512
   513	400374'	265 15 0 00 400133'		JSP	QLINK,PROFLC	; PROCESS DESCRIPTOR
   514	400375'	271 13 0 00 000002 		ADDI	T3,2		; NEXT DESCRIPTOR
   515	400376'	254 00 0 00 400372'		JRST	MRKUT2		; AND LOOP
   516
   517						 ; RECOVERY FOR UTBLOK
   518
   519	400377'	271 13 0 00 000002 	RECOUT:	ADDI	T3,2		; INCREMENT TO NEXT
   520	400400'	254 00 0 00 400370'		JRST	MRKUT1		; AND JOIN PROCESSING
   521

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 17
SNOGC	MAC	16-Feb-67 12:03		SPECIAL BLOK MARKING PROCEDURES

   522						 ; DEFINED DATATYPE PROCESSING
   523
   524	400401'	201 13 0 14 000002 	MARKD:	MOVEI	T3,ADFBLK(T4)	; PROCESS ...
   525	400402'	265 15 0 00 400135'		JSP	QLINK,PROFLU	; ASSOCIATED FBLOK
   526
   527	400403'	201 13 0 14 000003 	MARKD1:	MOVEI	T3,DFLDS(T4)	; POINT TO ITS FIELDS
   528	400404'	254 00 0 00 400370'		JRST	MRKUT1		; AND TREAT AS UTILITY BLOK
   529	
   530						 ; RECOVERY FOR A DBLOK
   531
   532	400405'	302 13 0 14 000002 	RECOD:	CAIE	T3,ADFBLK(T4)	; WAS THIS WHAT WE WERE PROCESSING
   533	400406'	254 00 0 00 400377'		JRST	RECOUT		; NO - RECOVER LIKE UTILITY
   534	400407'	254 00 0 00 400403'		JRST	MARKD1		; YES - INITIALIZE
   535

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 18
SNOGC	MAC	16-Feb-67 12:03		SPECIAL BLOK MARKING PROCEDURES

   536						 ; TABLE ELEMENT (TEBLOK) PROCESSING
   537
   538	400410'	201 13 0 14 000002 	MARKTE:	MOVEI	T3,TEREF(T4)	; PROCESS THE
   539	400411'	265 15 0 00 400133'		JSP	QLINK,PROFLC	; REFERENCE ELEMENT
   540
   541	400412'	201 13 0 14 000004 	MRKTE1:	MOVEI	T3,TEVAL(T4)	; PROCESS THE ...
   542	400413'	265 15 0 00 400133'		JSP	QLINK,PROFLC	; VALUE
   543
   544	400414'	201 13 0 14 000006 	MRKTE2:	MOVEI	T3,TELINK(T4)	; PROCESS THE ...
   545	400415'	265 15 0 00 400135'		JSP	QLINK,PROFLU	; LINK (THE NEXT TEBLOK)
   546
   547	400416'	254 00 0 00 400161'		JRST	RECO		; AND RECOVER
   548
   549						 ; RECOVERY FOR TEBLOK'S
   550
   551	400417'	306 13 0 14 000006 	RECOTE:	CAIN	T3,TELINK(T4)	; WERE WE HERE?
   552	400420'	254 00 0 00 400161'		JRST	RECO		; YES - ALL DONE
   553
   554	400421'	302 13 0 14 000004 		CAIE	T3,TEVAL(T4)	; HOW ABOUT HERE?
   555	400422'	254 00 0 00 400412'		JRST	MRKTE1		; NO - GO PROCESS IT
   556	400423'	254 00 0 00 400414'		JRST	MRKTE2		; YES - ON TO THE LINK
   557

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 19
SNOGC	MAC	16-Feb-67 12:03		SPECIAL BLOK MARKING PROCEDURES

   558						 ; FIELD FUNCTION (FFBOK) PROCESSING
   559
   560						 ; (NOTE: THIS HAPPENS TO BE THE SAME AS TFBLOK)
   561
   562	400424'	201 13 0 14 000004 	MARKFF:	MOVEI	T3,FFDFBL(T4)	; PROCESS ...
   563	400425'	265 15 0 00 400135'		JSP	QLINK,PROFLU	; THE ASSOCIATED FBLOK
   564
   565	400426'	201 13 0 14 000005 	MRKFF1:	MOVEI	T3,FFLINK(T4)	; THEN GET THE LINK
   566	400427'	265 15 0 00 400135'		JSP	QLINK,PROFLU	; 
   567
   568	400430'	254 00 0 00 400161'		JRST	RECO
   569
   570						 ; RECOVERY FOR FFBLOK
   571
   572	400431'	302 13 0 14 000004 	RECOFF:	CAIE	T3,FFDFBL(T4)	; WERE WE HERE?
   573	400432'	254 00 0 00 400161'		JRST	RECO		; NO - MUST BE DONE
   574	400433'	254 00 0 00 400426'		JRST	MRKFF1		; YES - DO THE LINK
   575

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 20
SNOGC	MAC	16-Feb-67 12:03		PHASE II - ADDRESS MODIFICATION

   576						SUBTTL	PHASE II - ADDRESS MODIFICATION
   577
   578						 ; IN THIS PHASE, ALL LOCATIONS CHAINED OFF 
   579						 ; THE GCFLD OF A BLOK ARE ADJUSTED TO POINT TO
   580						 ; THE NEW LOCATION OF THE BLOK
   581
   582	400434'	200 11 0 00 400061*	GCII:	MOVE	T1,NFLOOR	; T1 WILL POINT TO THE NEW
   583	400435'	274 11 0 00 400136*		SUB	T1,FLOOR	; ADJUST BY AMOUNT OF ...
   584	400436'	270 11 0 00 400246*		ADD	T1,SEDIM	; SEDIMENT
   585	400437'	200 12 0 00 400436*		MOVE	T2,SEDIM	; T2 WILL POINT TO THE OLD
   586	400440'	201 10 0 00 000000#		MOVEI	S3,BLIST	; POINT TO LIST OF BLOKS
   587
   588						 ; MAIN LOOP OF PHASE II
   589
   590	400441'	311 12 0 00 000002 	GCII1:	CAML	T2,SURF		; STILL BELOW SURFACE?
   591	400442'	254 00 0 00 400502'		JRST	GCII8		; NO - DONE OF PHASE II
   592
   593	400443'	550 07 0 12 000000 		HRRZ	S2,BLENG(T2)	; LOAD SIZE OF BLOK
   594	400444'	336 00 0 12 000001 		SKIPN	GCFLD(T2)	; SH9ULD WE SAVE THIS BLOK?
   595	400445'	254 00 0 00 400500'		JRST	GCII7		; NO
   596
   597	400446'	552 12 0 10 000000 		HRRZM	T2,0(S3)	; ADD BLOK TO LIST
   598	400447'	201 10 0 12 000001 		MOVEI	S3,GCFLD(T2)	; POINT TO NEXT RECEPTACLE
   599
   600	400450'	554 00 0 12 000000 		HLRZ	Z,BTCODE(T2)	; LOAD BLOK TYPE
   601	400451'	302 00 0 00 000403 		CAIE	Z,SBLOK		; TEST FOR STRING
   602	400452'	254 00 0 00 400471'		JRST	GCII4		; NO
   603
   604						 ; FOR STRINGS FIND MAXIMUM PENETRATION INTO SBLOK
   605
   606	400453'	201 13 0 00 000007 		MOVEI	T3,7		; BUT DO THIS
   607	400454'	612 13 0 00 400064*		TDNE	T3,NGCS		; ONLY EVERY 8
   608	400455'	254 00 0 00 400471'		JRST	GCII4		; GC'S
   609
   610	400456'	550 15 0 12 000001 		HRRZ	Q1,GCFLD(T2)	; HEAD OF CHAIN
   611	400457'	400 16 0 00 000000 		CLEAR	Q2,		; VALUE SET HERE
   612
   613	400460'	554 17 0 15 000001 	GCII2:	HLRZ	Q3,1(Q1)	; LOAD OFFSET
   614	400461'	270 17 0 15 000001 		ADD	Q3,1(Q1)	; ADD LENGTH
   615	400462'	305 16 0 17 000000 		CAIGE	Q2,0(Q3)	; NEW HIGH?
   616	400463'	201 16 0 17 000000 		MOVEI	Q2,0(Q3)	; YES
   617
   618	400464'	550 15 0 15 000000 		HRRZ	Q1,0(Q1)	; LOAD ADDRESS OF NEXT DESCRIPTOR
   619	400465'	326 15 0 00 400460'		JUMPN	Q1,GCII2	; AND LOOP IN NON-ZERO
   620
   621	400466'	271 16 0 00 000016 		ADDI	Q2,<NBYTES*LHDR>+<NBYTES-1> ; DETERMINE ...
   622	400467'	231 16 0 00 000005 		IDIVI	Q2,NBYTES	; SBLOK SIZE
   623	400470'	542 16 0 12 000000 		HRRM	Q2,BLENG(T2)	; INSERT NEW SIZE
   624
   625

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 21
SNOGC	MAC	16-Feb-67 12:03		PHASE II - ADDRESS MODIFICATION

   626						 ; NOW CHAIN DOWN THRU LIST OF FLOATING ADDRESSES
   627
   628	400471'	550 14 0 12 000001 	GCII4:	HRRZ	T4,GCFLD(T2)	; FIRST ON THE LIST
   629
   630	400472'	550 15 0 14 000000 	GCII5:	HRRZ	Q1,0(T4)	; SAVE EXITIN ADDRESS
   631	400473'	542 11 0 14 000000 		HRRM	T1,0(T4)	; PLUG NEW LOCATION
   632	400474'	200 14 0 00 000015 		MOVE	T4,Q1		; TRANSFER ADDRESS
   633	400475'	326 14 0 00 400472'		JUMPN	T4,GCII5	; LOOP WHILE NON-ZERO
   634
   635	400476'	550 15 0 12 000000 		HRRZ	Q1,BLENG(T2)	; GET DURRENT BLOK LENGT
   636	400477'	270 11 0 00 000015 		ADD	T1,Q1		; INCREMNT PAST BLOK
   637
   638						 ; HERE IF BLOK WAS NOT MARKED
   639
   640	400500'	270 12 0 00 000007 	GCII7:	ADD	T2,S2		; INCREMENT PAST OLD BLOK
   641	400501'	254 00 0 00 400441'		JRST	GCII1		; AND LOOP
   642
   643						 ; FINISH UP WITH PASS II
   644
   645	400502'	402 00 0 10 000000 	GCII8:	CLEARM	0(S3)		; INDICATE END OF CHAIN
   646	400503'	200 02 0 00 000011 		MOVE	SURF,T1		; SAVE SURFACE
   647
   648						 ; CHECK SEDIMENT AND RECORD IN S1 THE 
   649						 ; MAXIMUM SEDIMENTATION LEVEL FOR NEXT TIME
   650						 ; (OR LEAVE IT AS 0 IF IT WAS ALL REFERENCED)
   651
   652	400504'	400 06 0 00 000000 		CLEAR	S1,		; INITIALIZE S1
   653	400505'	200 11 0 00 400435*		MOVE	T1,FLOOR	; BEGIN AT THE FLOOR
   654
   655	400506'	311 11 0 00 400437*	GCII9:	CAML	T1,SEDIM	; STILL IN SEDIMENT?
   656	400507'	254 00 0 00 400517'		JRST	GCIII		; NO - PHASE III
   657
   658	400510'	326 06 0 00 400513'		JUMPN	S1,GCII9A	; IF TOP OF SED. HAS NOT BEEN FOUND
   659	400511'	336 00 0 11 000001 		SKIPN	GCFLD(T1)	; AND IF BLOK HAS NOT BEEN TOUCHED
   660	400512'	200 06 0 00 000011 		MOVE	S1,T1		; ESTABLISH AS SED. LEVEL
   661
   662	400513'	402 00 0 11 000001 	GCII9A:	CLEARM	GCFLD(T1)	; CLEAR FIELD
   663	400514'	550 12 0 11 000000 		HRRZ	T2,BLENG(T1)	; GET BLOK LENGTH
   664	400515'	270 11 0 00 000012 		ADD	T1,T2		; BUMP PAST BLOK
   665	400516'	254 00 0 00 400506'		JRST	GCII9		; AND LOOP FOR MORE
   666

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 22
SNOGC	MAC	16-Feb-67 12:03		PHASE III (DATA MOVEMENT)

   667						SUBTTL  PHASE III (DATA MOVEMENT)
   668
   669	400517'	200 12 0 00 000000#	GCIII:	MOVE	T2,BLIST	; LIST OF BLOKS
   670	400520'	200 11 0 00 400506*		MOVE	T1,SEDIM	; DESTINATION
   671
   672						 ; LOOP FOR UPWARD MOVEMENT
   673
   674	400521'	322 12 0 00 400542'	GCIII1:	JUMPE	T2,GCIII2	; JUMP IF DONE
   675	400522'	550 17 0 12 000000 		HRRZ	Q3,BLENG(T2)	; GET LENGTH
   676	400523'	550 13 0 12 000001 		HRRZ	T3,GCFLD(T2)	; LOAD NEXT BLOK
   677	400524'	402 00 0 12 000001 		CLEARM	GCFLD(T2)	; CLEAR FOR NEXT GC
   678	400525'	306 11 0 12 000000 		CAIN	T1,0(T2)	; REFLEXIVE MOVE?
   679	400526'	254 00 0 00 400537'		JRST	GCIII9		; YES
   680
   681	400527'	336 00 0 00 000006 		SKIPN	S1		; WAS SED. ALREADY MARKED?
   682	400530'	200 06 0 00 000011 		MOVE	S1,T1		; NO MARK IT
   683
   684	400531'	540 00 0 00 000011 		HRR	Z,T1		; 'TO' ADDRESS
   685	400532'	504 00 0 00 000012 		HRL	Z,T2		; 'FROM' ADDRESS
   686	400533'	270 11 0 00 000017 		ADD	T1,Q3		; POINT BEYOND BLOK
   687	400534'	251 00 0 11 777777 		BLT	Z,-1(T1)	; DO THE MOVE
   688	400535'	200 12 0 00 000013 		MOVE	T2,T3		; GET NEXT ADDRESS
   689	400536'	254 00 0 00 400521'		JRST	GCIII1		; AND LOOP
   690	
   691						 ; HERE IF NO BLT IS NEEDED
   692
   693	400537'	270 11 0 00 000017 	GCIII9:	ADD	T1,Q3		; NEXT DESTINATION
   694	400540'	200 12 0 00 000013 		MOVE	T2,T3		; NEXT BLOK
   695	400541'	254 00 0 00 400521'		JRST	GCIII1		; LOOP FOR MORE
   696						 ; HERE AFTER ALL BLOKS HAVE BEEN COALESCED
   697						 ; INTO A CONTIGOUS REGION BEGINNING WITH FLOOR
   698
   699						 ; ALLOCATE MORE CORE IF NEEDED
   700
   701	400542'	202 06 0 00 400520*	GCIII2:	MOVEM	S1,SEDIM	; INSERT NEW SED. LEVEL
   702
   703	400543'	200 16 0 00 000002 		MOVE	Q2,SURF		; DO WE ...
   704	400544'	270 16 0 00 400010*		ADD	Q2,BROOM	; NEED ...
   705	400545'	270 16 0 00 000000#		ADD	Q2,IGNOQ+3	; (ORIGINAL REQUEST)
   706	400546'	317 16 0 00 400052*		CAMG	Q2,CEIL		; MORE CORE?
   707	400547'	254 00 0 00 400560'		JRST	GCIII3		; NO
   708
   709	400550'	271 16 0 00 001000 		ADDI	Q2,1000		;[305] Round up
   710	400551'	275 16 0 00 000100 		SUBI	Q2,MARGIN	; BUT LEAVE SAFETY MARGIN
   711	400552'	202 16 0 00 400546*		MOVEM	Q2,CEIL		; THIS WILL BE THE NEW CEILING
   712	400553'	271 16 0 00 000100 		ADDI	Q2,MARGIN	; ADD SAFETY MARGIN
   713	400554'	311 16 0 00 000000*		CAML	Q2,HIWATR##	; IS THIS THE MOST SO FAR?
   714	400555'	202 16 0 00 400554*		MOVEM	Q2,HIWATR	; YES - MARK
   715	400556'	047 16 0 00 000011 		CORE	Q2,		; REQUEST THIS MUCH
   716						JRST	[	HRROI P1,-^D6001	; INDICATE
   717	400557'	254 00 0 00 400670'			 JRST	ABSERR## ]	; ERROR 6.1
   718
   719
   720	400560'	200 12 0 00 400434*	GCIII3:	MOVE	T2,NFLOOR	; LET T2 =
SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 22-1
SNOGC	MAC	16-Feb-67 12:03		PHASE III (DATA MOVEMENT)

   721	400561'	274 12 0 00 400505*		SUB	T2,FLOOR	; NFLOOR - FLOOR
   722	400562'	322 12 0 00 400613'		JUMPE	T2,GCEND	; IF SAME, JUMP TO WRAP-UP
   723
   724	400563'	200 13 0 00 400560*		MOVE	T3,NFLOOR	; RESET ...
   725	400564'	202 13 0 00 400561*		MOVEM	T3,FLOOR	; FLOOR
   726	400565'	402 00 0 00 400542*		CLEARM	SEDIM		; SED. LEVEL IS OBSOLETE
   727
   728	400566'	200 06 0 00 000002 		MOVE	S1,SURF		; FIND AMOUNT ...
   729	400567'	274 06 0 00 400563*		SUB	S1,NFLOOR	; TO BE MOVED
   730	400570'	230 06 0 00 000012 		IDIV	S1,T2		; DIVIDE BY DISTANCE MOVED
   731

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 23
SNOGC	MAC	16-Feb-67 12:03		PHASE III (DATA MOVEMENT)

   732						 ; S1 CONTANS # OF WHOLE CHUNKS TO BE MOVED
   733						 ; T2 CONTAINS SIZE OF CHUNKS
   734						 ; S2 CONTAINS REMAINDER
   735
   736	400571'	200 14 0 00 000002 		MOVE	T4,SURF		; DETERMINE DESTINATION ...
   737	400572'	274 14 0 00 000007 		SUB	T4,S2		; OR REMAINDER
   738	400573'	200 00 0 00 000007 		MOVE	Z,S2		; LOAD AMOUNT TO BE MOVED
   739	400574'	322 07 0 00 400576'		JUMPE	S2,GCIII4	; AVOID I NUMBER IS 0
   740	400575'	265 15 0 00 400603'		JSP	QLINK,MOVEUP	; DO THE MOVE
   741
   742	400576'	361 06 0 00 400613'	GCIII4:	SOJL	S1,GCEND	; INDEX ON S1
   743	400577'	274 14 0 00 000012 		SUB	T4,T2		; BUMP DESTINATION
   744	400600'	200 00 0 00 000012 		MOVE	Z,T2	 ; LOAD THE AMOUNT
   745	400601'	265 15 0 00 400603'		JSP	QLINK,MOVEUP	; DO THE MOVE
   746	400602'	254 00 0 00 400576'		JRST	GCIII4		; LOOP FOR MORE
   747
   748
   749					;	MOVEUP - MOVES A BLOCK OF CORE UPWARD TO A NON-
   750					;	OVERLAPPING REGION. CALLING SEQUENCE:
   751					;	LOAD Z WITH AMOUNT TO BE MOVED
   752					;	LOAD T4 WITH DESTINATION
   753					;	LOAD T2 WITH AMOUNT BLOK IS TO BE DISPLACED
   754					;	JSP	QLINK,MOVEUP
   755					;	RETURN - T2 & T4 ARE PRESERVED
   756
   757	400603'	200 17 0 00 000014 	MOVEUP:	MOVE	Q3,T4		; 'TO' ADDRESS
   758
   759	400604'	200 16 0 00 000014 		MOVE	Q2,T4		; COMPUTE ...
   760	400605'	274 16 0 00 000012 		SUB	Q2,T2		; 'FROM' ADDRESS
   761	400606'	504 17 0 00 000016 		HRL	Q3,Q2		; AND PLACE INTO Q3-LEFT
   762
   763	400607'	200 16 0 00 000014 		MOVE	Q2,T4		; COMPUTE ULTIMATE
   764	400610'	270 16 0 00 000000 		ADD	Q2,Z		; DESTINATION
   765	400611'	251 17 0 16 777777 		BLT	Q3,-1(Q2)	; AND DO A BLT
   766	400612'	254 00 0 15 000000 		JRST	0(QLINK)	; AND RETURN
   767

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 24
SNOGC	MAC	16-Feb-67 12:03		FINAL WRAP-UP

   768						SUBTTL	FINAL WRAP-UP
   769
   770	400613'	200 12 0 00 400003*	GCEND:	MOVE	T2,TOOMCH	; LET T2 =
   771	400614'	270 12 0 00 000002 		ADD	T2,SURF		; TOOMCH+SURF
   772	400615'	270 12 0 00 000000#		ADD	T2,IGNOQ+3	; ORIGNAL REQUEST
   773	400616'	435 12 0 00 001777 		IORI	T2,1777		; ROUND UP
   774	400617'	275 12 0 00 000100 		SUBI	T2,MARGIN	; BUT ALLOW FOR MARGIN
   775	400620'	311 12 0 00 400552*		CAML	T2,CEIL		; TOO MUCH SLACK?
   776	400621'	254 00 0 00 400626'		JRST	GCEND1		; NO
   777
   778	400622'	202 12 0 00 400620*		MOVEM	T2,CEIL		; YES - SET LOWER CEILING
   779	400623'	271 12 0 00 000100 		ADDI	T2,MARGIN	; ADD SAFETY MARGIN
   780	400624'	047 12 0 00 000011 		CORE	T2,		; REQUEST LESS CORE
   781	400625'	001 17 0 00 000000 		ERROR	15		; STRANGE ERROR
   782
   783	400626'	265 00 0 00 000000*	GCEND1:	POPR	PSTQ		; RESTOR REGISTERS
   784	400627'	000014	000004
   785	400630'	200 00 0 00 000000#		MOVE	Z,IGNOQ+3	; RELOAD Z
   786	400631'	336 00 0 00 000000#		SKIPN	IGNOQ+2		; GCOL ENTRY?
   787	400632'	254 00 0 15 000000 		JRST	0(QLINK)	; NO - JUST RETURN
   788
   789	400633'	200 00 0 00 400622*		MOVE	Z,CEIL		; FIND AMOUNT
   790	400634'	274 00 0 00 000002 		SUB	Z,SURF		; OF ROOM LEFT
   791	400635'	254 00 0 15 000000 		JRST	0(QLINK)	; AND RETURN
   792
   793

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 25
SNOGC	MAC	16-Feb-67 12:03		FINAL WRAP-UP

   794					;	BLOK - UTILITY FUNCTION (LAZY MAN'S CORE
   795					;	ALLOCATION METHOD.	THE BLOK IS ZEROE'D.
   796					;	CALLING SEQUENCE:
   797					;	LOAD Z WITH	BTCODE,,BLENG
   798					;	JSP	QLINK,BLOK
   799					;	ERROR	(CURRENTLY NOT USED)
   800					;	RETURN - BLOK IS ALLOCATED, DESCRIPTOR IS RETURNED ON STACK
   801
   802	400636'	550 16 0 00 000000 	BLOK::	HRRZ	Q2,Z		; GET LENGTH
   803	400637'	270 16 0 00 000002 		ADD	Q2,SURF		; FINAL POSITION OF SURF
   804	400640'	313 16 0 00 400633*		CAMLE	Q2,CEIL		; ARE WE BEYOND LIMITS
   805	400641'	254 00 0 00 400656'		JRST	BLOK1		; YES
   806
   807	400642'	202 00 0 02 000000 		MOVEM	Z,BTCODE&BLENG(SURF) ; FIRST WORD
   808	400643'	541 17 0 02 000002 		HRRI	Q3,GCFLD+1(SURF)	; 'TO' ADDRESS
   809	400644'	505 17 0 02 000001 		HRLI	Q3,GCFLD(SURF)	; & 'FROM' ADDRESS FOR ...
   810	400645'	402 00 0 02 000001 		CLEARM	GCFLD(SURF)	; ZEROING OUT ...
   811	400646'	251 17 0 16 777777 		BLT	Q3,-1(Q2)	; THE BLOK
   812
   813	400647'	540 00 0 00 000002 		HRR	Z,SURF		; FORM FIRST ...
   814	400650'	621 00 0 00 000400 		TLZ	Z,BLOKF		; WORD ...
   815	400651'	661 00 0 00 004000 		TLO	Z,FLDC		; OF RETURN DESCRIPTOR
   816	400652'	261 01 0 00 000000 		PUSH	STACK,Z		; AND ...
   817	400653'	261 01 0 00 400667'		PUSH	STACK,[0]	; RETURN IT.
   818
   819	400654'	200 02 0 00 000016 		MOVE	SURF,Q2		; UPDATE SURFACE
   820	400655'	254 00 0 15 000001 		JRST	1(QLINK)	; AND RETURN
   821
   822						 ; HERE IF A COLLECT IS NEEDED
   823
   824	400656'	202 00 0 00 000000*	BLOK1:	MOVEM	Z,BLOKSV##	; SAVE ARG
   825	400657'	202 15 0 00 000000#		MOVEM	Q1,BLOKSV+1	; SAVE LINK
   826	400660'	550 00 0 00 000000 		HRRZ	Z,Z		; NEED JUST THE AMOUNT
   827	400661'	265 15 0 00 400052'		JSP	QLINK,GCOLF	; ENSURE THIS MUCH
   828	400662'	200 00 0 00 400656*		MOVE	Z,BLOKSV	; RESTOR ...
   829	400663'	200 15 0 00 000000#		MOVE	Q1,BLOKSV+1	; THINGS
   830	400664'	254 00 0 00 400636'		JRST	BLOK		; AND START ANEW
   831
   832

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 26
SNOGC	MAC	16-Feb-67 12:03		FINAL WRAP-UP

   833						END

NO ERRORS DETECTED

HI-SEG. BREAK IS 400672
PROGRAM BREAK IS 000000
CPU TIME USED 05:29.393

44P CORE USED
SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page S-1
SNOGC	MAC	16-Feb-67 12:03		SYMBOL TABLE

ABSERR		400671'	ext	GCII5		400472'		MRKTE1		400412'		SEDIM		400565'	ext	
ADFBLK		000002	sin	GCII7		400500'		MRKTE2		400414'		SJUNKF		001000	sin	
AID		000000	ext	GCII8		400502'		MRKUT1		400370'		SLINK		000006		
APROTO		000002	sin	GCII9		400506'		MRKUT2		400372'		STACK		000001		
BLENG		000000	sin	GCII9A		400513'		NBYTES		000005	spd	STBASE		000000	ext	
BLIST	000000000000#	pol	GCIII		400517'		NCLINK		000003	sin	STBLOK		000432	sin	
BLOK		400636'	int	GCIII1		400521'		NFLOOR		000000*	spd	SUBFAC		000005	sin	
BLOK1		400656'		GCIII2		400542'		NGCS		400454'	ext	SUBJ		400031'	ext	
BLOKF		000400	sin	GCIII3		400560'		NSBASE		000000	ext	SURF		000002		
BLOKSV		400662'	ext	GCIII4		400576'		NSTACK		400174'	ext	T1		000011		
BROOM		400544'	ext	GCIII9		400537'		NSUBS		000004	sin	T2		000012		
BTCODE		000000	sin	GCLERR		400132'		P1		000004		T3		000013		
CEIL		400640'	ext	GCMIN		000000	spd	P2		000005		T4		000014		
CGCOL		400024'	int	GCOL		400034'	int	PARG		000002	sin	TBUCK		000003	sin	
CLLCT		400000'	int	GCOLF		400052'	int	PDT		004004	sin	TEBLOK		000416	sin	
CORE	047000	000011		GCOLF1		400060'		PLINK		000004		TELINK		000006	sin	
CVTINT		400005'	ext	GCOLF2		400062'		PNDSZ		000004	sin	TENDED		000000	ext	
D.EX3		400236'	ext	GCOLG		400037'	int	PPL		000014	spd	TEREF		000002	sin	
DFLDS		000003	sin	GCSIX	474300	000000	spd	PPR		400626'	ext	TEVAL		000004	sin	
DTNUM		000077	sin	GCVER		000005	spd	PROFL1		400146'		TFOLD		000004	sin	
E1$57		000000	sin	GCWHO		000000	spd	PROFLC		400133'		TLINK		000011		
E15$		000000	sin	GRID		400247'	ext	PROFLU		400135'		TOOMCH		400613'	ext	
ERR	001000	000000		GSURF		400074'	ext	PSHR		400062'	ext	VALUE		000000	sin	
ERR.	003000	000000		HIWATR		400555'	ext	PSTART		000002	sin	VARSIZ		000007	sin	
FFDFBL		000004	sin	HSBASE		400226'	ext	Q1		000015		VFUNC		000003	sin	
FFLINK		000005	sin	HSR		000003		Q2		000016		VLABEL		000002	sin	
FLAP		400024'	ext	IGNOQ		400567'	ext	Q3		000017		VNAME		000004	sin	
FLAQ		000000	ext	JKBLOK		000417	sin	QLINK		000015		XGRID		000764	spd	
FLDC		004000	sin	JOBHGH		400016'	ext	RC.GB		000002	spd	Z		000000		
FLOOR		400564'	ext	LCLINK		000002	sin	RC.HST		000000	spd	%%JOBD	043100	000450	spd	
FTDEBU		000000	spd	LHDR		000002	sin	RC.STK		000001	spd	%%MACT	000200	000025	spd	
GCASC	436060	000000	spd	LPHDR		000005	sin	RC.VB		000003	spd	%%SNOP	000500	000305	spd	
GCDISP		400077'		LREGP		000002	spd	RECO		400161'		%%UUOS	001400	000457	spd	
GCEDT		000305	spd	LREGQ		000003	spd	RECO1		400162'		.JBHRL		000115		
GCEND		400613'		LREGS		000003	spd	RECO2		400166'		.JBREL		000044		
GCEND1		400626'		LREGT		000004	spd	RECOA		400340'		
GCFLD		000001	sin	LSCW		400175'		RECOC		400350'		
GCI		400200'		MARGIN		000100	spd	RECOD		400405'		
GCI.1		400203'		MARKA		400332'		RECOFF		400431'		
GCI.2		400214'		MARKA1		400334'		RECOGB		400272'		
GCI.3		400223'		MARKC		400343'		RECOHS		400245'		
GCI.G1		400250'		MARKC1		400345'		RECOP		400321'		
GCI.G2		400263'		MARKD		400401'		RECOSK		400224'		
GCI.GR		400246'		MARKD1		400403'		RECOT		400363'		
GCI.H1		400233'		MARKFF		400424'		RECOTE		400417'		
GCI.HS		400226'		MARKP		400317'		RECOUT		400377'		
GCI.V		400275'		MARKP1		400325'		RECOVB		400310'		
GCI.V1		400300'		MARKT		400353'		REGP		000004	spd	
GCI.V2		400302'		MARKT1		400354'		S1		000006		
GCI.V3		400304'		MARKT2		400356'		S2		000007		
GCI.V4		400306'		MARKTE		400410'		S3		000010		
GCII		400434'		MARKTF		400365'		SAVEP		000000	ext	
GCII1		400441'		MARKUT		400367'		SAVES		400666'	ext	
GCII2		400460'		MOVEUP		400603'		SBLOK		000403	sin	
GCII4		400471'		MRKFF1		400426'		SCW		400173'		

SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOGC	MAC	16-Feb-67 12:03		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

ABSERR	   717
ADFBLK	   524	   532
AID	   279
APROTO	   451	   461
BLENG	   174	   365	   394	   438	   486	   508	   593	   623	   635	   663	   675	   807
BLIST	    73#	   586	   669
BLOK	   802#	   830
BLOK1	   805	   824#
BLOKF	   366	   814
BLOKSV	   824	   825	   828	   829
BROOM	    88	   704
BTCODE	   174	   247	   267	   365	   371	   600	   807
CEIL	   146	   706	   711	   775	   778	   789	   804
CGCOL	    89	   107#
CLLCT	    77#
CVTINT	    77	    84
D.EX3	   344
DFLDS	   527
DTNUM	   248	   268	   372
E1$57	    78#	    85#
E15$	   217#	   350#	   781#
FFDFBL	   562	   572
FFLINK	   565
FLAP	   110	   111
FLAQ	   113
FLDC	   284	   815
FLOOR	   131	   156	   165	   169	   229	   583	   653	   721	   725
FTDEBU	   161	   783
GCASC	    31#
GCDISP	   187#	   201	   214	   249	   269	   373
GCEDT	    24#
GCEND	   722	   742	   770#
GCEND1	   776	   783#
GCFLD	   235	   236	   239	   241	   252	   259	   266	   387	   594	   598	   610	   628	   659	   662
	   676	   677	   808	   809	   810
GCI	   171	   176	   284#
GCI.1	   293#	   312
GCI.2	   311#	   319	   326
GCI.3	   316	   321#
GCI.G1	   362#	   379	   396	   414
GCI.G2	   374	   383#
GCI.GR	   341	   359#
GCI.H1	   340#	   345	   355
GCI.HS	   295	   334#
GCI.V	   367	   400#
GCI.V1	   404#	   419
GCI.V2	   407#	   422
GCI.V3	   410#	   425
GCI.V4	   413#	   427
GCII	   363	   582#
SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOGC	MAC	16-Feb-67 12:03		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

GCII1	   590#	   641
GCII2	   613#	   619
GCII4	   602	   608	   628#
GCII5	   630#	   633
GCII7	   595	   640#
GCII8	   591	   645#
GCII9	   655#	   665
GCII9A	   658	   662#
GCIII	   656	   669#
GCIII1	   674#	   689	   695
GCIII2	   674	   701#
GCIII3	   707	   720#
GCIII4	   739	   742#	   746
GCIII9	   679	   693#
GCLERR	   187	   188	   189	   196	   198	   200	   203	   204	   205	   207	   212	   213	   215	   217#
GCMIN	    23#
GCOL	   118	   125#
GCOLF	   146#	   827
GCOLF1	   127	   156#
GCOLF2	   142	   161#
GCOLG	   131#
GCSIX	    30#
GCVER	    22#
GCWHO	    25#
GRID	   360
GSURF	   132	   139	   170	   173
HIWATR	   713	   714
HSBASE	   334
HSR	   336
IGNOQ	    72	    73	   125	   126	   137	   138	   151	   152	   705	   772	   785	   786
JKBLOK	   172
JOBHGH	    96
LCLINK	   467	   478
LHDR	   507	   621
LPHDR	   441
LREGP	   161	   783
LREGQ	   161	   783
LREGS	   161	   783
LREGT	   161	   783
LSCW	   278#	   294
MARGIN	   710	   712	   774	   779
MARKA	   192	   451#
MARKA1	   454#	   463
MARKC	   193	   194	   467#
MARKC1	   470#	   479
MARKD	   197	   524#
MARKD1	   527#	   534
MARKFF	   206	   562#
MARKP	   191	   433#
MARKP1	   443#	   447
SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOGC	MAC	16-Feb-67 12:03		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

MARKT	   195	   485#
MARKT1	   486#	   498	   503
MARKT2	   488#	   493
MARKTE	   202	   538#
MARKTF	   208	   502#
MARKUT	   199	   209	   210	   211	   507#
MOVEUP	   740	   745	   757#
MRKFF1	   565#	   574
MRKTE1	   541#	   555
MRKTE2	   544#	   556
MRKUT1	   457	   508#	   520	   528
MRKUT2	   510#	   515
NBYTES	   621	   622
NCLINK	   470
NFLOOR	    72#	   141	   157	   582	   720	   724	   729
NGCS	   163	   607
NSBASE	   277
NSTACK	   277
NSUBS	   454
P1	   288	   289	   293	   294	   297	   302	   305	   337	   338	   383	   384	   394	   395	   400
	   401	   404	   407	   410	   413	   418	   421	   424	   716
P2	    80	    81	    87	    88	   303	   311	   336	   340	   359	   362
PARG	   441
PDT	   349
PLINK	   102
PNDSZ	   441	   443
PPL	   161#	   161	   162	   783#	   783	   784
PPR	   783
PROFL1	   234	   239#
PROFLC	   223#	   321	   351	   402	   411	   434	   446	   452	   513	   539	   542
PROFLU	   228#	   405	   408	   468	   471	   491	   525	   545	   563	   566
PSHR	   161
PSTART	   433	   440
Q1	   165	   167	   302	   303	   305	   306	   373	   374	   390	   610	   613	   614	   618	   619
	   630	   632	   635	   636	   825	   829
Q2	    95	    96	    97	    98	   228	   229	   230	   233	   235	   236	   239	   241	   247	   252
	   253	   269	   270	   611	   615	   616	   621	   622	   623	   703	   704	   705	   706	   709
	   710	   711	   712	   713	   714	   715	   759	   760	   761	   763	   764	   765	   802	   803
	   804	   811	   819
Q3	    91	    92	    93	    98	    99	   131	   132	   133	   146	   147	   148	   173	   174	   239
	   242	   243	   247	   248	   249	   250	   254	   267	   268	   269	   613	   614	   615	   616
	   675	   686	   693	   757	   761	   765	   808	   809	   811
QLINK	   118	   134	   149	   224	   231	   237	   243	   250	   321	   351	   402	   405	   408	   411
	   434	   446	   452	   468	   471	   491	   513	   525	   539	   542	   545	   563	   566	   740
	   745	   766	   787	   791	   820	   827
RC.GB	   183#	   383
RC.HST	   185#	   337
RC.STK	   182#	   297
RC.VB	   184#	   400
RECO	   259#	   445	   473	   480	   489	   511	   547	   552	   568	   573
SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOGC	MAC	16-Feb-67 12:03		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

RECO1	   261#	   264
RECO2	   262	   266#
RECOA	   192	   461#
RECOC	   193	   194	   478#
RECOD	   197	   532#
RECOFF	   206	   572#
RECOGB	   189	   394#
RECOHS	   187	   355#
RECOP	   191	   438#
RECOSK	   188	   325#
RECOT	   195	   208	   497#
RECOTE	   202	   551#
RECOUT	   199	   209	   210	   211	   462	   519#	   533
RECOVB	   190	   418#
REGP	   161	   162	   783	   784
S1	   223	   284	   652	   658	   660	   681	   682	   701	   728	   729	   730	   742
S2	   593	   640	   737	   738	   739
S3	   586	   597	   598	   645
SAVEP	   112
SAVES	   112
SBLOK	   601
SCW	   276#	   288
SEDIM	   115	   136	   166	   167	   233	   359	   584	   585	   655	   670	   701	   726
SJUNKF	   315
SLINK	    89	   119
STACK	    80	    82	    87	   101	   276	   816	   817
STBASE	   276
STBLOK	   214
SUBFAC	   456
SUBJ	   116
SURF	   147	   230	   590	   646	   703	   728	   736	   771	   790	   803	   807	   808	   809	   810
	   813	   819
T1	   343	   344	   348	   349	   371	   372	   373	   582	   583	   584	   631	   636	   646	   653
	   655	   659	   660	   662	   663	   664	   670	   678	   682	   684	   686	   687	   693
T2	   314	   315	   318	   365	   366	   378	   438	   439	   444	   486	   487	   488	   508	   509
	   510	   585	   590	   593	   594	   597	   598	   600	   610	   623	   628	   635	   640	   663
	   664	   669	   674	   675	   676	   677	   678	   685	   688	   694	   720	   721	   722	   730
	   743	   744	   760	   770	   771	   772	   773	   774	   775	   778	   779	   780
T3	   223	   228	   241	   242	   259	   261	   263	   306	   307	   311	   314	   318	   325	   334
	   335	   340	   343	   345	   347	   348	   355	   360	   362	   365	   371	   378	   384	   387
	   389	   394	   395	   401	   404	   407	   410	   413	   418	   421	   424	   433	   440	   441
	   443	   444	   451	   454	   455	   456	   461	   467	   470	   478	   485	   488	   492	   497
	   502	   507	   510	   514	   519	   524	   527	   532	   538	   541	   544	   551	   554	   562
	   565	   572	   606	   607	   676	   688	   694	   724	   725
T4	   252	   253	   259	   266	   267	   289	   338	   385	   389	   433	   438	   439	   440	   441
	   451	   454	   456	   461	   467	   470	   478	   485	   486	   487	   502	   507	   508	   509
	   524	   527	   532	   538	   541	   544	   551	   554	   562	   565	   572	   628	   630	   631
	   632	   633	   736	   737	   743	   757	   759	   763
TBUCK	   485
TEBLOK	   201
SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOGC	MAC	16-Feb-67 12:03		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

TELINK	   544	   551
TENDED	   279
TEREF	   538
TEVAL	   541	   554
TFOLD	   502
TLINK	    77	    84
TOOMCH	    81	   770
VALUE	   418
VARSIZ	   413
VFUNC	   407	   424
VLABEL	   404	   421
VNAME	   410
XGRID	   140
Z	    99	   101	   112	   113	   133	   138	   139	   140	   141	   148	   152	   156	   157	   161
	   169	   170	   171	   172	   174	   261	   262	   263	   385	   386	   387	   600	   601	   684
	   685	   687	   738	   744	   764	   783	   785	   789	   790	   802	   807	   813	   814	   815
	   816	   824	   826	   828
.JBHRL	    95
.JBREL	    97
SNOGC - Garbage Collector  %5(305)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOGC	MAC	16-Feb-67 12:03		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Macro/Opdef cross reference

CORE	    92	   715	   780
ERR	   217	   350	   781
ERR.	    78	    85
ERROR	   217	   350	   781
ERROR.	    78	    85
GCPTX	    43
GCTTL	    42
MIDENT	   162	   784
POPR	   783
PPADDR	   161#	   162	   783#	   784
PPINIT	   161	   783
PPLENG	   161#	   162	   783#	   784
PUSHR	   161
SHOW.	    37	    38	    39	    40
TITLE.	    29  X .F