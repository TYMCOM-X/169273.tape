SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 1
SNOSYN	MAC	13-Oct-66 21:59		MA355/JDS/DRH/MP/RCM/VB		15-JUN-76

     1						SUBTTL	MA355/JDS/DRH/MP/RCM/VB		15-JUN-76
     2
     3					; COPYRIGHTS 1972,1973,1976,1977 STEVENS INSTITUTE OF TECHNOLOGY
     4					; HOBOKEN, NEW JERSEY, 07030
     5					; ALL RIGHTS RESERVED.
     6
     7					  ;UNIVERSALS
     8
     9						SEARCH	MACTEN		;DEC-10 COMMON MACROS
    10						SEARCH	SNOPRM		;SITBOL PARAMETER FILE
    11
    12					  ;DIRECTIVES
    13
    14						.DIRECT	.XTABM		;EXCLUDE TABS FROM MACRO CALLS
    15						SALL			;SUPPRESS MACRO EXPANSIONS
    16	400000'					TWOSEG	400K		;TWOSEGMENT CODE
    17
    18					  ;VERSION NUMBER
    19
    20			000005			SYNVER==5		;MAJOR VERSION NUMBER
    21			000000			SYNMIN==0		;MINOR VERSION NUMBER
    22			000246			SYNEDT==246		;EDIT LEVEL
    23			000000			SYNWHO==0		;CUSTOMER ARGUMENT
    24
    25					  ;TITLE
    26
    27						TITLE.	SYN,SNOSYN,<Syntactical Analyzer>
    28		637156	000000			SYNSIX==SIXBIT /SYN/	; SNOSYN ABBREVIATION IN SIXBIT
    29		516631	600000			SYNASC==ASCIZ /SYN/	; SNOSYN ABBREVIATION IN ASCII
    30						SALL
    31
    32
    33					  ;SHOW UNIVERSAL VERSION NUMBERS
    34
    35	400000'	000200	000025			SHOW.	%%MACT		;VERSION NUMBER OF MACTEN
    36	400000'	000500	000305			SHOW.	%%SNOP		;VERSION NUMBER OF SNOPRM
    37
    38						SYNTTL			; Title
    39						SYNPTX			; PASS2 assembly message
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 2
SNOSYN	MAC	13-Oct-66 21:59		Table of Contents

    40						SUBTTL	Table of Contents
    41
    42					;		Table of Contents for Syntactical Analyzer
    43					;
    44					;
    45					;			   Section			      Page
    46					;   1. Table of Contents. . . . . . . . . . . . . . . . . . .    2
    47					;   2. REVISION HISTORY . . . . . . . . . . . . . . . . . . .    3
    48					;   3. CODE ENTRY POINT . . . . . . . . . . . . . . . . . . .    4
    49					;   4. CVTEXP . . . . . . . . . . . . . . . . . . . . . . . .    5
    50					;   5. SPECIAL TOKEN INITIALIZATION . . . . . . . . . . . . .    6
    51					;   6. STATEMENT LOOP (STLOOP). . . . . . . . . . . . . . . .    7
    52					;   7. TOKEN PROCESSING . . . . . . . . . . . . . . . . . . .    9
    53					;   8. GOTO'S . . . . . . . . . . . . . . . . . . . . . . . .   14
    54					;   9. UTILITIES. . . . . . . . . . . . . . . . . . . . . . .   16
    55					;  10. COMPILER ERROR HANDLING. . . . . . . . . . . . . . . .   22
    56					;  11. MISC. DATA . . . . . . . . . . . . . . . . . . . . . .   24
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 3
SNOSYN	MAC	13-Oct-66 21:59		REVISION HISTORY

    57						SUBTTL	REVISION HISTORY
    58
    59					COMMENT	\
    60
    61					START OF VERSION 5.
    62					122	RENAME MODULES & CLEAN UP.
    63					164	Don't compile unevaluated expressions inline any longer.
    64					246	Remove the definition of CSTACK to the parameter file.
    65					\
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 4
SNOSYN	MAC	13-Oct-66 21:59		REVISION HISTORY

    66
    67						SUBTTL	CODE ENTRY POINT
    68
    69					; CODE IS ONE OF TWO ENTRY POINTS TO THIS MODULE. (THE
    70					; OTHER IS CVTEXP.) CODE CAN RECEIVE CONTROL EITHER AT
    71					; EXECUTION TIME (THE CODE BUILT-IN FUNCTION) OR AT 
    72					; PRE-EXECUTION TIME. IN THE LATTER CASE, CODE IS 
    73					; CALLED BY THE INTERPRETER TO COMPILE THE USERS PROGRAM.
    74					; THE WORD PREX INDICATES WHETHER THE PRE-EXECUTION 
    75					; STAGE IS IN EFFECT.
    76
    77	400000'	202 04 0 00 000000*	CODE::	MOVEM	PLINK,IGNOP##	; SAVE LINKING REGISTER
    78	400001'	402 00 0 00 000000*		CLEARM	ENDFLG		; SET WHEN EOP IS ENCOUNTERED
    79	400002'	402 00 0 00 000000*		CLEARM	EXFLAG		; DISTINGUISH ENTRY POINT
    80	400003'	402 00 0 00 000000*		CLEARM	LAST		; OFFSET OF LAST STATEMENT
    81
    82	400004'	265 06 0 00 000000*		JSP	SLINK,TKINIT##	; LET TOKEN INITIALIZE
    83	400005'	254 00 0 00 400010'		JRST	CODE1		; ERROR RETURN
    84
    85	400006'	265 11 0 00 400553'		JSP	TLINK,CBINIT	; INITIALIZE A CBLOK
    86	400007'	254 00 0 00 400042'		JRST	VB.ALL		; GO ALLOCATE SOME VARIABLE BLOCKS
    87
    88						 ; HERE IF ERROR RETURN FROM TKINIT
    89
    90	400010'	332 00 0 00 000000*	CODE1:	SKIPE	PREX##		; IS IT COMPILE TIME?
    91	400011'	001 14 0 00 000004 		ERROR	12,4		; YES - INCORRECTIBLE READ ERROR
    92	400012'	200 05 0 01 777777 		MOVE	P2,-1(STACK)	; GET DESCRIPTOR TOP
    93	400013'	312 05 0 00 000000*		CAME	P2,NULLST##	; WAS ARG NULL?
    94	400014'	003 01 0 00 000070 		ERROR.	1,56		; NO - INVALID DT
    95	400015'	001 15 0 00 000067 		ERROR	13,55		; YES - INVALID VALUE
    96
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 5
SNOSYN	MAC	13-Oct-66 21:59		CODE ENTRY POINT

    97
    98						SUBTTL	CVTEXP	ENTRY POINT
    99
   100					; THIS IS THE OTHER ENTRY POINT. CVTEXP ESSENTIALLY COMPILES A 
   101					; STRING INTO AN EXPRESSION. IT DIFFERS FROM CODE IN THAT 
   102					; NO STATEMENT HEADER IS PRODUCED AND THAT SPECIAL OPERATORS AT
   103					; LEVEL 0 ARE NOT SEARCHED FOR AND GOTO'S ARE UNALLOWED.
   104					; WHERE A DISTINCTION MUST BE MADE BETWEEN CVTEXP AND CODE THE 
   105					; EXFLAG IS EXAMINED.
   106
   107	400016'	202 04 0 00 400000*	CVTEXP::MOVEM	PLINK,IGNOP##	; SAVE LINKING REGISTER
   108	400017'	476 00 0 00 400002*		SETOM	EXFLAG		; INDICATE ENTRY POINT
   109
   110	400020'	554 06 0 01 777777 		HLRZ	S1,-1(STACK)	; PICK UP DATATYPE
   111	400021'	306 06 0 00 004006 		CAIN	S1,EDT		; IS IT EXPRESSION ALREADY
   112	400022'	254 00 0 04 000001 		JRST	1(PLINK)	; SUCCEED IF SO
   113
   114	400023'	265 11 0 00 000000*		JSP	TLINK,CVTSTR##	; IT HAD BETTER BE STRING
   115	400024'	254 00 0 04 000000 		JRST	0(PLINK)	; NO - FAIL
   116
   117	400025'	265 06 0 00 000000*		JSP	SLINK,EXINIT##	; INITIALIZE TOKEN FOR EXPRESSIONS
   118	400026'	254 00 0 04 000000 		JRST	0(PLINK)	; MUST HAVE BEEN NULL - FAIL
   119
   120	400027'	402 00 0 00 000000*		CLEARM	GTZONE		; CLEAR GTZONE FLAG AND ...
   121	400030'	402 00 0 00 000000*		CLEARM	CURSOE		; AN CURRENT EXPRESSION START OFFSET
   122	400031'	201 00 0 00 000001 		MOVEI	Z,1		; INITIALIZE LEVEL TO ...
   123	400032'	202 00 0 00 000000*		MOVEM	Z,LEVEL		; 1 TO AVOID COMPLICATIONS
   124
   125	400033'	265 11 0 00 400553'		JSP	TLINK,CBINIT	; INITIALIZE CBLOK
   126	400034'	254 00 0 00 400061'		JRST	STLP1		; JOIN NORMAL PROCESSING
   127
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 6
SNOSYN	MAC	13-Oct-66 21:59		CVTEXP	ENTRY POINT

   128
   129						SUBTTL	SPECIAL TOKEN INITIALIZATION
   130
   131			000005			NVBS==5		; NUMBER OF VARIABLE BLOCKS
   132
   133	400035'	000123	000000*		VB.TBL:	XWD	"S",VB.S##	; FOR S GOTO'S
   134	400036'	000106	000000*			XWD	"F",VB.F##	; FOR F GOTO'S
   135	400037'	000052	000000*			XWD	"*",VB.ST##	; TO DETECT EXPRESSIONS
   136	400040'	000040	000000*			XWD	" ",VB.BL##	; TO DETECT IMPLICIT PATTERN MATCHING
   137	400041'	000075	000000*			XWD	"=",VB.EQ##	; TO IGNORE IMPLICIT PATTERN MATCHING
   138
   139						 ; BRANCH HERE FROM OPENING PAGE
   140
   141	400042'	336 00 0 00 400010*	VB.ALL:	SKIPN	PREX##		; PRE-EXECUTION?
   142	400043'	254 00 0 00 400056'		JRST	STLOOP		; NO - IGNORE THIS
   143	400044'	201 06 0 00 000005 		MOVEI	S1,NVBS		; LOAD NUMBER OF BLOCKS
   144
   145						 ; LOOP TO ALLOCATE VARIABLE BLOCKS
   146						 ; 
   147	400045'	500 07 0 06 400034'	VB.AL1:	HLL	S2,VB.TBL-1(S1)	; CHAR. TO S2 LEFT
   148	400046'	541 07 0 00 000001 		HRRI	S2,1		; LENGTH IS 1
   149	400047'	261 01 0 00 000000*		PUSH	STACK,$ALPHA##	; PART OF &ALPHABET
   150	400050'	261 01 0 00 000007 		PUSH	STACK,S2	; PUSH PREPARED WORD
   151	400051'	265 11 0 00 000000*		JSP	TLINK,INSTAL##	; INSTALL INTO SYMBOL TABLE
   152	400052'	001 17 0 00 000000 		ERROR	15		; THIS CAN'T FAIL
   153	400053'	200 07 0 06 400034'		MOVE	S2,VB.TBL-1(S1)	; LOAD THE ASSOCIATED ADDRESS
   154	400054'	202 00 0 07 000000 		MOVEM	Z,0(S2)		; STORE THE RESULT
   155	400055'	367 06 0 00 400045'		SOJG	S1,VB.AL1	; LOOP UNTIL S1 IS EXHAUSTED
   156
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 7
SNOSYN	MAC	13-Oct-66 21:59		SPECIAL TOKEN INITIALIZATION

   157
   158						SUBTTL	STATEMENT LOOP (STLOOP)
   159
   160					; IMPURE LOCATIONS USED EXCLUSIVELY BY SYN ZEROED AT THE 
   161					; START OF EACH STATEMENT.
   162
   163						 ; LOOP FOR PROCESSING STATEMENTS
   164
   165	400056'	402 00 0 00 400032*	STLOOP:	CLEARM	LEVEL##		; ZERO OUT ...
   166	400057'	200 00 0 00 400643'		MOVE	Z,[LEVEL,,LEVEL+1] ; ABOVE ...
   167	400060'	251 00 0 00 000000*		BLT	Z,ENDLBL	; LOCATIONS
   168
   169
   170						 ; MERGE HERE FROM CVTEXP ENTRY POINT
   171
   172	400061'	200 04 0 00 000000*	STLP1:	MOVE	CSTACK,HSTACK##	; USE HISTORY STACK FOR COMPILING
   173	400062'	261 04 0 00 400644'		PUSH	CSTACK,[0]	; PUSH ON HIGH FENCE
   174	400063'	261 04 0 00 400644'		PUSH	CSTACK,[0]	; FENCES HAVE 0 PRECEDENCE
   175	400064'	202 05 0 00 000000#		MOVEM	P2,FLAP##+1	; STATEMENT BEGINNING
   176	400065'	332 00 0 00 400017*		SKIPE	EXFLAG##		; ARE WE DOING AN EXPRESSION?
   177	400066'	254 00 0 00 400125'		JRST	TKLOOP		; YES - IGNORE THE REST
   178
   179	400067'	200 11 0 00 000000*		MOVE	T1,FLAP		; LOAD ADDRESS ...
   180	400070'	270 11 0 00 000000#		ADD	T1,FLAP+1	; OF STATEMENT
   181
   182	400071'	204 00 0 00 000000*		MOVS	Z,PAGENO##	; GET CURRENT PAGE NO.
   183	400072'	404 00 0 00 400645'		AND	Z,[CDARGS,,0]	; MASK HIGH ORDER BITS
   184	400073'	434 00 0 00 400646'		IOR	Z,[CDIF,,BGST##] ; COMPLETE RESTOF HEADER
   185	400074'	202 00 0 11 000000 		MOVEM	Z,CHEAD(T1)	; FILL HEAD
   186
   187	400075'	204 00 0 00 000000*		MOVS	Z,CMPNO##	; GET STATEMENT #
   188	400076'	202 00 0 11 000001 		MOVEM	Z,CSTNO(T1)	; INSERT INTO CBLOK
   189	400077'	350 00 0 00 400075*		AOS	CMPNO		; BUMP FOR NEXT TIME
   190
   191	400100'	271 05 0 00 000003 		ADDI	P2,CRULE	; MOVE PAST HEADER
   192
   193						 ; PROCESS LABEL
   194
   195	400101'	265 06 0 00 000000*		JSP	SLINK,TOKEN##	; CALL FOR A TOKEN
   196	400102'	254 00 0 00 400602'		JRST	CERR		; REPORT ERROR
   197	400103'	254 00 0 00 400132'		JRST	TKEND		; END OF PROGRAM
   198
   199	400104'	336 06 0 00 000000 		SKIPN	S1,Z		; IS RETURNED VALUE 0?
   200	400105'	254 00 0 00 400125'		JRST	TKLOOP		; YES - IGNORE
   201
   202	400106'	200 16 0 00 000000#		DMOVE	Q1,FLAP##	; GET ADDRESS OF CBLOK
   203	400107'	200 15 0 00 400067*
   204									; GET OFFSET OF CURRENT STATEMENT
   205
   206	400110'	332 00 0 00 400042*		SKIPE	PREX		; IS IT PRE-EXECUTION?
   207	400111'	254 00 0 00 400121'		JRST	LBL2		; YES - BRANCH
   208
   209	400112'	200 11 0 06 000006 		MOVE	T1,VFLAGS(S1)	; LOAD FLAGS OF VARIABLE BLOCK
   210	400113'	607 11 0 00 200000 		TLNN	T1,LTFLAG	; IS LABEL BEING TRACED?
   211	400114'	254 00 0 00 400123'		JRST	LBL1		; BRANCH IF NOT
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 7-1
SNOSYN	MAC	13-Oct-66 21:59		STATEMENT LOOP (STLOOP)

   212
   213	400115'	200 12 0 06 000002 		MOVE	T2,VLABEL(S1)	; PICK UP ADDRESS OF TRBLOK
   214	400116'	202 15 0 12 000002 		DMOVEM	Q1,TRVAL(T2)	; PLUG TRVAL ...
   215	400117'	202 16 0 12 000003 
   216									; FIELD
   217	400120'	254 00 0 00 400125'		JRST	TKLOOP		; AND GO GET FIRST TOKEN
   218 
   219						 ; BRANCH HERE FOR COMPILE-TIME INSERTION
   220
   221	400121'	550 12 0 06 000002 	LBL2:	HRRZ	T2,VLABEL(S1)	; LOAD PREVIOUS LABEL
   222	400122'	326 12 0 00 400637'		JUMPN	T2,RCE.PL	; BRANCH IF PREV. DEFINED
   223
   224						 ; MERGE HERE FOR NORMAL LABEL INSERTION
   225
   226	400123'	504 15 0 00 000016 	LBL1:	HRL	Q1,Q2		; CONDENSCE TO ONE WORD
   227	400124'	202 15 0 06 000002 		MOVEM	Q1,VLABEL(S1)	; PLUG LABEL FIELD
   228
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 8
SNOSYN	MAC	13-Oct-66 21:59		STATEMENT LOOP (STLOOP)

   229
   230						 ; HERE TO GET FIRST NON-LABEL TOKEN AND ALL SUBSEQUENT TOKENS
   231
   232	400125'	265 06 0 00 400101*	TKLOOP:	JSP	SLINK,TOKEN	; CALL TO GET A TOKEN
   233	400126'	254 00 0 00 400602'		JRST	CERR		; REPORT ERROR
   234	400127'	254 00 0 00 400142'		JRST	TKEOS		; END OF STATEMENT
   235						 ; 
   236						 ; NORMAL RETURN FROM TOKEN. TRANSFER TO PROPER ROUTINE
   237
   238	400130'	554 06 0 00 000000 		HLRZ	S1,Z		; ROUTINE ADDRESS IN LEFT HALF OF TOKEN
   239	400131'	254 00 0 06 000000 		JRST	0(S1)		; DO THE BRANCH
   240
   241						 ; END OF PROGRAM DETECTED BY TOKEN
   242
   243	400132'	200 04 0 00 400016*	TKEND:	MOVE	PLINK,IGNOP	; RESTORE LINK (STACK NO LONGER NEEDED)
   244
   245	400133'	476 00 0 00 400001*		SETOM	ENDFLG##		; INDICATE END ENCOUNTERED
   246	400134'	202 00 0 00 400060*		MOVEM	Z,ENDLBL##	; SAVE RETURNED VALUE
   247
   248	400135'	200 00 0 00 400647'		MOVE	Z,[CDIF,,EOP##]	; FINAL TOKEN
   249	400136'	265 15 0 00 400447'		JSP	QLINK,PUT	; INSERTED INTO CBLOK
   250
   251	400137'	265 15 0 00 400560'		JSP	QLINK,CBSNIP	; SNIP OFF REST OF CBLOK
   252
   253	400140'	400 05 0 00 000000 		CLEAR	P2,		; 0 MEANS NO NEXT STATEMENT
   254	400141'	254 00 0 00 400146'		JRST	TKEOS1		; GO FILL IN HEADER
   255
   256						 ; END OF STATEMENT RETURN FROM TOKEN
   257
   258	400142'	265 11 0 00 400520'	TKEOS:	JSP	TLINK,FLUSH	; FLUSH OUT THE STACK
   259	400143'	254 00 0 00 400146'		JRST	TKEOS1		; HIGH FENCE - GOOD
   260	400144'	201 00 0 00 000000*		MOVEI	Z,CE.BL##	; TOO MANY LEFT'S
   261	400145'	254 00 0 00 400602'		JRST	CERR		; GIVE ERROR AND NO FLUSH
   262
   263						 ; HERE TO FILL IN STATEMENT HEADER
   264
   265	400146'	332 00 0 00 400065*	TKEOS1:	SKIPE	EXFLAG		; TEST FOR EXPRESSION
   266	400147'	254 00 0 00 400214'		JRST	ENDEXP		; YES - GOTO SPECIAL END
   267
   268	400150'	200 06 0 00 400107*		MOVE	S1,FLAP		; GET ADDRESS OF ...
   269	400151'	270 06 0 00 000000#		ADD	S1,FLAP+1	; STATEMENT HEADER
   270
   271						 ; FILL IN  CFGOTO FIELD
   272
   273	400152'	336 07 0 00 000000*		SKIPN	S2,RGT##		; SKIP IF A RECOVERY GOTO WAS DETECTED
   274	400153'	200 07 0 00 000005 		MOVE	S2,P2		; NO - USE NEXT STATEMENT
   275	400154'	542 07 0 06 000001 		HRRM	S2,CFGOTO(S1)	; FILL FIELD
   276
   277						 ; FILL IN ANY IMMEDIATE GOTO
   278
   279	400155'	336 07 0 00 000000*		SKIPN	S2,FGT##		; TEST FOR ANY FAIL GOTO'S
   280	400156'	254 00 0 00 400164'		JRST	TKEOS2		; NONE - THEN NO IMMEDIATES
   281	400157'	200 10 0 00 000005 		MOVE	S3,P2		; S3 TO HOLD DESTINATION OF IMMEDIATE
   282	400160'	317 07 0 00 000000*		CAMG	S2,SGT##		; IF SGT IS THERE AND GR THAN FGT ...
   283	400161'	200 10 0 00 400160*		MOVE	S3,SGT		; THEN MAKE IT THE DESTINATION.
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 8-1
SNOSYN	MAC	13-Oct-66 21:59		STATEMENT LOOP (STLOOP)

   284	400162'	270 07 0 00 400150*		ADD	S2,FLAP		; POINT TO THE FAIL GOTO
   285	400163'	202 10 0 07 777777 		MOVEM	S3,-1(S2)	; AN IMMEDIATE GOTO OCCURS JUST BEFORE
   286						 ;			; THE FAIL GOTO.
   287
   288						 ; FILL IN THE CLAST & CNEXT FIELDS
   289
   290	400164'	200 10 0 00 000005 	TKEOS2:	MOVE	S3,P2		; P2 IS NEXT OFFSET
   291	400165'	200 07 0 00 000000*		MOVE	S2,CBLENG##	; LOAD LENGTH OF CBLOK
   292	400166'	242 07 0 00 777777 		LSH	S2,-1		; DIVIDE BY 2
   293	400167'	311 05 0 00 000007 		CAML	P2,S2		; IS P2 LESS THAN THIS AMOUNT
   294	400170'	201 10 0 00 000004 		MOVEI	S3,CCODE	; NO - NEXT STATEMENT TO BEGIN NEW CBLOK
   295	400171'	504 10 0 00 400003*		HRL	S3,LAST##		; GET OFFSET OF LAST STATEMENT
   296	400172'	202 10 0 06 000002 		MOVEM	S3,CLAST&CNEXT(S1)	; PLUG BOTH FIELDS
   297
   298	400173'	200 10 0 00 000000#		MOVE	S3,FLAP+1	; MAKE THE CURRENT STATEMENT ...
   299	400174'	202 10 0 00 400171*		MOVEM	S3,LAST		; THE LAST.
   300
   301						 ; NEW CBLOK REQUIRED?
   302
   303	400175'	332 00 0 00 400133*		SKIPE	ENDFLG		; TEST FOR END OF PROGRAM
   304	400176'	254 00 0 00 400202'		JRST	TKEOS3		; YES - GO WRAP-UP
   305	400177'	311 05 0 00 000007 		CAML	P2,S2		; AGAIN TEST FOR P2 TOO BIG
   306	400200'	265 11 0 00 400540'		JSP	TLINK,CBMORE	; IT IS - ALLOCATE A NEW CBLOK
   307	400201'	254 00 0 00 400056'		JRST	STLOOP		; GET NEXT STATEMENT
   308
   309						 ; END OF PROGRAM
   310
   311	400202'	336 07 0 00 400134*	TKEOS3:	SKIPN	S2,ENDLBL	; GET BEGIN LABEL THAT APPEARED ...
   312									; ON END CARD
   313	400203'	254 00 0 04 000001 		JRST	1(PLINK)	; NO SUCH LABEL APPEARED
   314
   315	400204'	336 10 0 07 000002 		SKIPN	S3,VLABEL(S2)	; PICK UP OFFSET/ADDRESS
   316	400205'	254 00 0 00 400211'		JRST	BADLBL		; IT ISN'T EVEN A LABEL
   317
   318	400206'	542 10 0 01 777777 		HRRM	S3,-1(STACK)	; INSERT CBLOK ADDRESS
   319	400207'	546 10 0 01 000000 		HLRM	S3,0(STACK)	; AND OFFSET
   320	400210'	254 00 0 04 000001 		JRST	1(PLINK)	; AND RETURN
   321
   322						 ; THE LABEL ON THE END CARD WAS UNDEFINED
   323
   324	400211'	201 00 0 00 000000*	BADLBL:	MOVEI	Z,CE.UT##	; BAD TRANSFER ADDRESS
   325	400212'	265 06 0 00 000000*		JSP	SLINK,CERROR	; PUT OUT MESSAGE
   326	400213'	254 00 0 04 000001 		JRST	1(PLINK)	; AND RETURN
   327
   328						 ; END OF EXPRESSION
   329
   330	400214'	200 00 0 00 400650'	ENDEXP:	MOVE	Z,[CONST,,NULLST] ; BEWARE ...
   331	400215'	306 05 0 00 000004 		CAIN	P2,CCODE	; OF ...
   332	400216'	265 15 0 00 400447'		JSP	QLINK,PUT	; NULLITY
   333
   334	400217'	200 00 0 00 400651'		MOVE	Z,[CDIF,,EOE##]	; PREPARE TRAP FOR ...
   335	400220'	265 15 0 00 400447'		JSP	QLINK,PUT	; INTERPRETER
   336
   337	400221'	201 00 0 00 000000 		MOVEI	Z,0		; PUT A 0 WORD ...
   338	400222'	265 15 0 00 400447'		JSP	QLINK,PUT	; BEHIND IT
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 8-2
SNOSYN	MAC	13-Oct-66 21:59		STATEMENT LOOP (STLOOP)

   339
   340	400223'	265 15 0 00 400560'		JSP	QLINK,CBSNIP	; SNIP OFF REST OF CBLOK
   341
   342	400224'	201 00 0 00 004006 		MOVEI	Z,EDT		; MAK RETURNED ...
   343	400225'	506 00 0 01 777777 		HRLM	Z,-1(STACK)	; VALUE OF TYPE EXPRESSION
   344
   345	400226'	200 04 0 00 400132*		MOVE	PLINK,IGNOP	; RESTORE LINKING
   346	400227'	254 00 0 04 000001 		JRST	1(PLINK)	; NORMAL RETURN
   347
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 9
SNOSYN	MAC	13-Oct-66 21:59		STATEMENT LOOP (STLOOP)

   348
   349						SUBTTL	TOKEN PROCESSING
   350
   351						INTERN	SY.ID,SY.CON,SY.FUN,SY.ARY,SY.UNY,SY.BIN
   352						INTERN	SY$COL,SY$COM,SY$LB,SY$LP,SY$RP,SY$RB
   353
   354
   355						 ; PROCESSING IDENTIFIERS
   356
   357	400230'	505 00 0 00 064000 	SY.ID:	HRLI	Z,VAR		; COMPILES INTO A VARIABLE
   358
   359						 ; MERGE HERE FROM MANY PLACES
   360
   361	400231'	265 15 0 00 400447'	PZLOOP:	JSP	QLINK,PUT	; PUT TOKEN INTO CBLOK ...
   362	400232'	254 00 0 00 400125'		JRST	TKLOOP		; AND LOOP BACK TO GET A NEW TOKEN
   363
   364
   365						 ; CONSTANTS
   366
   367	400233'	505 00 0 00 160000 	SY.CON:	HRLI	Z,CONST		; INDICATE CONSTANT
   368	400234'	254 00 0 00 400231'		JRST	PZLOOP		; PUT Z AND LOOP
   369
   370
   371						 ; FUNCTON REFERENCE - Z RIGHT CONTAINS IDENT. ADDR.
   372
   373	400235'	201 06 0 00 000000*	SY.FUN:	MOVEI	S1,GOTO##	; LOAD GOTO INDICATOR IN CASE
   374	400236'	265 15 0 00 400402'		JSP	QLINK,GTTEST	; IS GOTO?
   375	400237'	254 00 0 00 400410'		JRST	CONDGT		; YES - CONDITIONAL GOTO
   376
   377	400240'	505 00 0 00 400244'		HRLI	Z,BK.FUN	; INSERT BACK-UP ADDRESS
   378
   379						 ; HERE TO PUSH A LOW FENCE (FROM MANY PLACES)
   380
   381	400241'	261 04 0 00 000000 	FNLOOP:	PUSH	CSTACK,Z	; Z LEFT CONTAINS BACK-UP ADDRESS
   382	400242'	261 04 0 00 400644'		PUSH	CSTACK,[0]	; 0 PRECEDENCE MEANS FENCE
   383	400243'	254 00 0 00 400125'		JRST	TKLOOP		; LOOP FOR NEXT TOKEN
   384
   385						 ; BACK-UP PROCESSING FOR FUNCTIONS (S3 CONTAINS # OF ARGS)
   386
   387	400244'	550 00 0 04 000001 	BK.FUN:	HRRZ	Z,1(CSTACK)	; GET IDENTIFIER ADDRESS
   388	400245'	271 00 0 00 000003 		ADDI	Z,VFUNC		; POINT TO VFUNC FIELD
   389	400246'	505 00 0 10 200000 		HRLI	Z,CDF(S3)	; INSERT FUNC + ARG COUNT
   390
   391	400247'	254 00 0 00 400231'		JRST	PZLOOP		; PUT Z AND LOOP
   392
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 10
SNOSYN	MAC	13-Oct-66 21:59		TOKEN PROCESSING

   393
   394						 ; ARRAY REFERENCE - Z RIGHT CONTAINS ID ADDRESS
   395
   396	400250'	201 06 0 00 000000*	SY.ARY:	MOVEI	S1,DGOTO##	; IF GOTO ITS A DIRECT GOTO
   397	400251'	265 15 0 00 400402'		JSP	QLINK,GTTEST	; IS GOTO?
   398	400252'	254 00 0 00 400410'		JRST	CONDGT		; YES - PROCESS CONDITIONAL GOTO'S
   399
   400	400253'	505 00 0 00 064000 		HRLI	Z,VAR		; ID IS ACTUALLY THE FIRST ARGUMENT
   401	400254'	265 15 0 00 400447'		JSP	QLINK,PUT	; INSERT INTO CBLOK
   402
   403	400255'	505 00 0 00 400257'		HRLI	Z,BK.ARY	; INSERT BACK-UP ADDRESS
   404	400256'	254 00 0 00 400241'		JRST	FNLOOP		; PUSH FENCE AND LOOP
   405
   406						 ; BACK-UP PROCESSING FOR ARRAYS (S3 CONTAINS # OF ARGS)
   407
   408	400257'	515 00 0 10 000001 	BK.ARY:	HRLZI	Z,1(S3)		; NO OF ARGS + 1 TO Z LEFT
   409	400260'	270 00 0 00 400652'		ADD	Z,[CDF,,ITEM$$]	; IMPLIED FUNCTION IS ITEM
   410	400261'	254 00 0 00 400231'		JRST	PZLOOP		; PUT Z AND LOOP
   411
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 11
SNOSYN	MAC	13-Oct-66 21:59		TOKEN PROCESSING

   412
   413						 ; UNARY OPERATORS
   414
   415	400262'	550 00 0 00 000000 	SY.UNY:	HRRZ	Z,Z		; CLEAR OUT LEFT HALF OF TOKEN
   416	400263'	316 00 0 00 400037*		CAMN	Z,VB.ST##		; CHECK FOR UNARY *
   417	400264'	254 00 0 00 400272'		JRST	SY.STR		; YES, GO HANDLE IT AS SPECIAL CASE
   418
   419	400265'	271 00 0 00 000002 		ADDI	Z,VUNARY	; POINT TO VUNARY FIELD
   420	400266'	505 00 0 00 200001 		HRLI	Z,CDF+1		; INSERT UNARY FUNCTION CODE
   421	400267'	261 04 0 00 000000 		PUSH	CSTACK,Z	; PUSH OPERATOR ONTO STACK
   422	400270'	261 04 0 00 400653'		PUSH	CSTACK,[1000]	; INFINITE PRECEDENCE
   423	400271'	254 00 0 00 400125'		JRST	TKLOOP		; LOOK FOR ANOTHER TOKEN
   424
   425						 ; HERE TO PROCESS UNARY *
   426
   427	400272'	200 00 0 00 400030*	SY.STR:	MOVE	Z,CURSOE##	; SAVE CURRENT EXPRESSION START...
   428	400273'	265 15 0 00 400447'		JSP	QLINK,PUT	; IN THE CURRENT CBLOK
   429
   430	400274'	202 05 0 00 400272*		MOVEM	P2,CURSOE	; P2 IS NEW CURSOE
   431
   432	400275'	200 00 0 00 400651'		MOVE	Z,[CDIF,,EOE##]	; INDICATE END OF EXPRESSION
   433	400276'	261 04 0 00 000000 		PUSH	CSTACK,Z	; PUSH ONTO STACK
   434	400277'	261 04 0 00 400653'		PUSH	CSTACK,[1000]	; LIKE AN OPERATOR
   435	400300'	254 00 0 00 400125'		JRST	TKLOOP		; LOOK FOR ANOTHER TOKEN
   436
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 12
SNOSYN	MAC	13-Oct-66 21:59		TOKEN PROCESSING

   437
   438						 ; BINARY OPERATORS
   439
   440	400301'	550 06 0 00 000000 	SY.BIN:	HRRZ	S1,Z		; GET ADDRESS OF VARIABLE BLOCK
   441	400302'	201 10 0 06 000003 		MOVEI	S3,VBINRY(S1)	; POINT TO BINARY FIELD OF VB
   442
   443	400303'	332 00 0 00 400056*		SKIPE	LEVEL		; TEST LEVEL
   444	400304'	254 00 0 00 400321'		JRST	SY.BN1		; NONZERO - BYPASS CHECKS
   445
   446	400305'	332 00 0 00 400027*		SKIPE	GTZONE##		; ARE WE IN THE GOTO ZONE
   447	400306'	254 00 0 00 400335'		JRST	SY.BN4		; YES - SPECIAL PROCESSING NEEDED
   448
   449	400307'	332 00 0 00 000000*		SKIPE	PMFLAG##		; ANY PREVIOUS BIN. OPS AT LEVEL 0?
   450	400310'	254 00 0 00 400321'		JRST	SY.BN1		; YES, SKIP IMPLICIT PATT. MATCHING
   451	400311'	476 00 0 00 400307*		SETOM	PMFLAG		; FLAG BIN OP AT LEVEL 0
   452
   453	400312'	312 06 0 00 400040*		CAME	S1,VB.BL##	; IF OP IS BLANK
   454	400313'	254 00 0 00 400321'		JRST	SY.BN1		; DON'T BRANCH HERE, BUT
   455
   456						 ; IMPLICIT PATTERN MATCHING
   457
   458	400314'	201 10 0 00 400641'		MOVEI	S3,MTCH$$	; POINT TO PATTERN MATCHING
   459	400315'	476 00 0 00 400311*		SETOM	PMFLAG		; AND SET THE FLAG.
   460	400316'	201 06 0 00 000006 		MOVEI	S1,6		; IMPLIED RIGHT PRECEDENCE
   461	400317'	201 07 0 00 000007 		MOVEI	S2,7		; IMPLIED LEFT PRECEDENCE
   462	400320'	254 00 0 00 400323'		JRST	SY.BN5		; JOIN NORMAL PROCESSING
   463
   464						 ; JUMP HERE IF NOT IMPLICIT PATTERN MATCH
   465
   466	400321'	554 07 0 06 000002 	SY.BN1:	HLRZ	S2,LPREC(S1)	; GET LEFT PRECEDENCE TO S2
   467	400322'	554 06 0 06 000003 		HLRZ	S1,RPREC(S1)	; RIGHT PREC. TO S1
   468						 ; 
   469						 ; MERGE HERE FROM IMPLICIT PATTERN MATCHING
   470
   471	400323'	505 10 0 00 200002 	SY.BN5:	HRLI	S3,CDF+2	; MOVE IN 2-ARG INDICATOR
   472
   473						 ; LOOP HERE TO TEST PRECEDENCE
   474
   475	400324'	317 07 0 04 000000 	SY.BN2:	CAMG	S2,0(CSTACK)	; COMPARE LEFT PR. WITH PR. ON STACK
   476	400325'	254 00 0 00 400331'		JRST	SY.BN3		; LOWER; DISGORGE ITEM
   477	400326'	261 04 0 00 000010 		PUSH	CSTACK,S3	; HIGHER, PUSH IT ONTO STACK.
   478	400327'	261 04 0 00 000006 		PUSH	CSTACK,S1	; ALSO PUSH RIGHT PRECEDENCE
   479	400330'	254 00 0 00 400125'		JRST	TKLOOP		; AND LOOP BACK
   480
   481						 ; HIGH PRECEDENCE OPERATOR ON STACK
   482
   483	400331'	262 04 0 00 000000 	SY.BN3:	POP	CSTACK,Z	; REMOVE PRECEDENCE
   484	400332'	262 04 0 00 000000 		POP	CSTACK,Z	; REMOVE OPERATOR
   485	400333'	265 15 0 00 400447'		JSP	QLINK,PUT	; PUT OPERATOR OUT
   486	400334'	254 00 0 00 400324'		JRST	SY.BN2		; RESUME COMPARISONS
   487
   488						 ; HERE FOR LEVEL 0 OPERATOR IN GOTO ZONE
   489
   490	400335'	316 06 0 00 400312*	SY.BN4:	CAMN	S1,VB.BL	; ONLY BLANK IS ALLOWED HERE.
   491	400336'	254 00 0 00 400125'		JRST	TKLOOP		; OK - BUT DON'T INSERT IN CBLOK
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 12-1
SNOSYN	MAC	13-Oct-66 21:59		TOKEN PROCESSING

   492	400337'	254 00 0 00 400631'		JRST	RCE.GT		; BAD OPERATOR
   493
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 13
SNOSYN	MAC	13-Oct-66 21:59		TOKEN PROCESSING

   494
   495						 ; THE COLON
   496
   497	400340'	332 00 0 00 400146*	SY$COL:	SKIPE	EXFLAG		; MAKE SURE WE'RE NOT DOING EXPRESSIONS
   498	400341'	254 00 1 00 400226*		JRST	@IGNOP		; FAIL IF WE ARE
   499
   500	400342'	476 00 0 00 400305*		SETOM	GTZONE		; SET FLAG TO INDICATE GOTO ZONE
   501
   502	400343'	265 11 0 00 400520'		JSP	TLINK,FLUSH	; FLUSH ALL OPERATORS FROM STACK
   503	400344'	254 00 0 00 400125'		JRST	TKLOOP		; HIGH FENCE - GOOD
   504	400345'	254 00 0 00 400633'		JRST	RCE.BL		; REPORT IMBALANCE - TOO MANY LEFTS
   505
   506
   507						 ; THE COMMA
   508
   509	400346'	265 11 0 00 400520'	SY$COM:	JSP	TLINK,FLUSH	; REMOVE LATEST OPERATORS
   510	400347'	254 00 0 00 400635'		JRST	RCE.BR		; HIGH FENCE -	NOT ENOUGH LEFTS
   511
   512	400350'	201 00 0 00 000000*		MOVEI	Z,CE.IC##	; POTENTIAL ERROR IS 'ILL CHAR'
   513	400351'	554 06 0 04 777777 		HLRZ	S1,-1(CSTACK)	; GET LAST 'BACK-UP' ADDR
   514	400352'	306 06 0 00 400125'		CAIN	S1,TKLOOP	; WAS IS AN OPEN PAREN?
   515	400353'	254 00 0 00 400623'		JRST	CERR1		; YUP - GIVE DIAGNOSTIC
   516
   517	400354'	505 00 0 00 400356'		HRLI	Z,BK$COM	; BACK-UP ROUTINE FOR COMMA
   518	400355'	254 00 0 00 400241'		JRST	FNLOOP		; PUSH FENCE AND LOOP
   519
   520						 ; BACK-UP FOR COMMA
   521
   522	400356'	340 10 0 00 000000 	BK$COM:	AOJ	S3,		; ADD ONE TO ARG COUNT
   523	400357'	274 04 0 00 400654'		SUB	CSTACK,[2,,2]	; BUMP STACK FOR NEXT FENCE
   524	400360'	554 07 0 04 000001 		HLRZ	S2,1(CSTACK)	; PICK UP NEXT BACK-UP ADDRESS
   525	400361'	254 00 0 07 000000 		JRST	0(S2)		; AND BRANCH TO IT
   526
   527
   528						 ; LEFT BRACKET
   529
   530	400362'	201 06 0 00 400250*	SY$LB:	MOVEI	S1,DGOTO##	; IF GOTO, ITS A DIRECT GOTO
   531	400363'	265 15 0 00 400402'		JSP	QLINK,GTTEST	; CHECK FOR GOTO
   532	400364'	254 00 0 00 400436'		JRST	UNCOND		; PROCESS UNCONDITIONAL GOTO'S
   533
   534	400365'	505 00 0 00 400257'		HRLI	Z,BK.ARY	; MUST BE COMPILER ARRAY REF.
   535	400366'	254 00 0 00 400241'		JRST	FNLOOP		; PUSH FENCE AND LOOP
   536
   537
   538						 ; LEFT PAREN
   539
   540	400367'	201 06 0 00 400235*	SY$LP:	MOVEI	S1,GOTO##	; IF GOTO, ITS A PLAIN GOTO
   541	400370'	265 15 0 00 400402'		JSP	QLINK,GTTEST	; CHECK FOR GOTO
   542	400371'	254 00 0 00 400436'		JRST	UNCOND		; YES - UNCOND. GOTO
   543
   544	400372'	505 00 0 00 400125'		HRLI	Z,TKLOOP	; BACK-UP PROCEDURE IS THE NO-OP
   545	400373'	254 00 0 00 400241'		JRST	FNLOOP		; PUSH FENCE AND LOOP
   546
   547
   548						 ; RIGHT PAREN AND RIGHT BRACKET
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 13-1
SNOSYN	MAC	13-Oct-66 21:59		TOKEN PROCESSING

   549	400374'				SY$RP:	 ;
   550	400374'	375 00 0 00 400303*	SY$RB:	SOSGE	LEVEL		; DECREMENT AND TEST LEVEL
   551	400375'	254 00 0 00 400635'		JRST	RCE.BR		; IF IT GOES NEG. - TOO MANY RIGHTS
   552
   553	400376'	265 11 0 00 400520'		JSP	TLINK,FLUSH	; FLUSH OUT
   554	400377'	254 00 0 00 400635'		JRST	RCE.BR		; HIGH FENCE - TOO MANY RIGHTS
   555
   556	400400'	400 10 0 00 000000 		CLEAR	S3,		; ZERO OUT ARG. COUNT
   557	400401'	254 00 0 00 400356'		JRST	BK$COM		; MAKE LIKE A COMMA
   558
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 14
SNOSYN	MAC	13-Oct-66 21:59		TOKEN PROCESSING

   559
   560						SUBTTL	GOTO'S
   561
   562					; UTILITY GTTEST - TESTS WHETHER A FUNCTION OR PARENTHESIZED
   563					; EXPRESSION IS TO BE TREATED AS A GOTO.
   564					;
   565					; CALLING SEQUENCE:
   566					;	JSP	QLINK,GTTEST
   567					;	IS GOTO
   568					;	IS NOT GOTO
   569
   570	400402'	350 16 0 00 400374*	GTTEST:	AOS	Q2,LEVEL	; BUMP AND LOAD LEVEL
   571	400403'	336 00 0 00 400342*		SKIPN	GTZONE		; IN THE GOTO ZONE?
   572	400404'	254 00 0 15 000001 		JRST	1(QLINK)	; NO - GIVE NO GOTO
   573
   574	400405'	302 16 0 00 000001 		CAIE	Q2,1		; WAS LEVEL 0?
   575	400406'	254 00 0 15 000001 		JRST	1(QLINK)	; NO - GIVE NO GOTO
   576	400407'	254 00 0 15 000000 		JRST	0(QLINK)	; YES - GIVE GOTO
   577
   578
   579						 ; CONDITIONAL GOTO'S
   580
   581	400410'	550 07 0 00 000000 	CONDGT:	HRRZ	S2,Z		; GET ASSOCIATED IDENTIFIER
   582	400411'	316 07 0 00 400035*		CAMN	S2,VB.S##		; IS IT 'S'?
   583	400412'	254 00 0 00 400416'		JRST	SUCCGT		; YES
   584
   585	400413'	316 07 0 00 400036*		CAMN	S2,VB.F##		; IS IT 'F'?
   586	400414'	254 00 0 00 400426'		JRST	FAILGT		; YES
   587
   588	400415'	254 00 0 00 400631'		JRST	RCE.GT		; BAD FUNCTION
   589
   590
   591						 ; SUCCESS GOTO
   592
   593	400416'	332 00 0 00 400152*	SUCCGT:	SKIPE	RGT		; OK IF NO RECOVERY GOTO EXISTS
   594	400417'	332 00 0 00 400155*		SKIPE	FGT		; OK IF RGT WAS FGT
   595	400420'	332 00 0 00 400161*		SKIPE	SGT		; 'OK' MEANS TEST FOR PREVIOUS SGT
   596	400421'	254 00 0 00 400631'		JRST	RCE.GT		; OTHERWISE REPORT ERROR
   597	400422'	202 05 0 00 400420*		MOVEM	P2,SGT		; FILL IN SUCCESS GOTO
   598
   599						 ; MERGE HERE FROM OTHER GOTO'S BEFORE LOOPING
   600						 ; S1 CONTAINS TYPE OF GOTO
   601
   602	400423'	505 06 0 00 400443'	GTLOOP:	HRLI	S1,BK.GT	; COMMON BACK-UP PROCEDURE
   603	400424'	200 00 0 00 000006 		MOVE	Z,S1		; PLACE FENCE INTO Z
   604	400425'	254 00 0 00 400241'		JRST	FNLOOP		; PUSH FENCE AND LOOP
   605
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 15
SNOSYN	MAC	13-Oct-66 21:59		GOTO'S

   606
   607						 ; FAIL GOTO
   608
   609	400426'	332 00 0 00 400416*	FAILGT:	SKIPE	RGT		; TEST FOR PREVIOUS RECOVERY GOTO
   610	400427'	254 00 0 00 400631'		JRST	RCE.GT		; REPORT GOTO ERROR IF SO
   611
   612	400430'	200 00 0 00 400655'		MOVE	Z,[CDIF,,IGOTO##]	; INSERT IMMEDIATE GOTO ...
   613	400431'	265 15 0 00 400447'		JSP	QLINK,PUT	; TO BRANCH AROUND FGOTO
   614	400432'	265 15 0 00 400447'		JSP	QLINK,PUT	; THIS TO BE PLUGGED LATER
   615
   616	400433'	202 05 0 00 400426*		MOVEM	P2,RGT		; SET RECOVERY GOTO
   617	400434'	202 05 0 00 400417*		MOVEM	P2,FGT		; SET FAIL GOTO
   618
   619	400435'	254 00 0 00 400423'		JRST	GTLOOP		; LOOP BACK VIA COMMON CODE
   620
   621
   622						 ; UNCONDITIONAL GOTO
   623
   624	400436'	336 00 0 00 400433*	UNCOND:	SKIPN	RGT		; IF RECOVERY ALREADY EXISTS REPORT ERR
   625	400437'	332 00 0 00 400422*		SKIPE	SGT		; SKIP IF SUCCESS GOTO NOT THERE
   626	400440'	254 00 0 00 400631'		JRST	RCE.GT		; REPORT GOTO ERROR
   627
   628	400441'	202 05 0 00 400436*		MOVEM	P2,RGT		; SET RECOVERY GOTO
   629	400442'	254 00 0 00 400423'		JRST	GTLOOP		; LOOP BACK VIA GOTO'S
   630
   631
   632						 ; COMMON BACK-UP FOR GOTO'S
   633
   634	400443'	540 00 0 04 000001 	BK.GT:	HRR	Z,1(CSTACK)	; GET DGOTO/GOTO ADDRESS
   635	400444'	505 00 0 00 600000 		HRLI	Z,CDIF		; MAKE IT AN INTERPRETER FUNCTION
   636	400445'	265 15 0 00 400447'		JSP	QLINK,PUT	; INSERT TOKEN INTO CBLOK
   637	400446'	254 00 0 00 400125'		JRST	TKLOOP		; AND LOOP BACK
   638
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 16
SNOSYN	MAC	13-Oct-66 21:59		GOTO'S

   639
   640						SUBTTL	UTILITIES
   641
   642					; PUT - PUT A TOKEN INTO THE CBLOK POINTED TO BY FLAP
   643					; AT AN OFFSET INDICATED BY P2.
   644					; CALLING SEQUENCE:
   645					;	LOAD Z WITH TOKEN
   646					;	JSP	QLINK,PUT
   647					;	RETURN
   648
   649	400447'	350 17 0 00 000005 	PUT:	AOS	Q3,P2		; INCREMENT OFFSET AND LEVEL INTO Q3
   650	400450'	270 17 0 00 400162*		ADD	Q3,FLAP		; FORM ADDRESS+1 OF NEW ENTRY
   651	400451'	202 00 0 17 777777 		MOVEM	Z,-1(Q3)	; INSERT TOKEN
   652
   653	400452'	316 00 0 00 400651'		CAMN	Z,[CDIF,,EOE]	; DID WE JUST STORE EOE ?
   654	400453'	336 00 0 00 400274*		SKIPN	CURSOE		; YES, BUT WAS IT UNARY * ?
   655	400454'	254 00 0 00 400514'		JRST	PUT1		; NO, BYPASS EXPRESSION HANDLING
   656
   657						 ; HERE TO ALLOCATE AN EBLOK FOR OUT-OF-LINE EXPRESSION
   658
   659	400455'	265 00 0 00 000000*		PUSHR	TQ		; ELEVATE OUR STATUS...
   660	400456'	000010	000011
   661	400457'	265 00 0 00 000000*		PUSHSA	T		; TO BE A TYPE T ROUTINE
   662	400460'	000011	000000*
   663
   664	400461'	200 13 0 00 000005 		MOVE	T3,P2		; CURRENT POINTER INTO T3
   665	400462'	274 13 0 00 400453*		SUB	T3,CURSOE	; MINUS CURSOE = LENGTH OF EBLOK
   666	400463'	505 00 0 00 000406 		HRLI	Z,EBLOK		; WE WANT AN EBLOK
   667	400464'	541 00 0 13 000002 		HRRI	Z,LHDR(T3)	; OF LENGTH = HEADER + P2 - CURSOE
   668	400465'	265 15 0 00 000000*		JSP	QLINK,BLOK##	; ALLOCATE IT
   669	400466'	001 17 0 00 000000 		ERROR	15		; CAN'T FAIL
   670
   671	400467'	200 15 0 00 400450*		MOVE	Q1,FLAP		; GET THE CURRENT CBLOK ADDRESS
   672	400470'	270 15 0 00 400462*		ADD	Q1,CURSOE	; PLUS CURSOE = 'FROM' ADDRESS
   673	400471'	507 00 0 00 000015 		HRLS	Q1		; IN THE LEFT HALF
   674	400472'	540 16 0 01 777777 		HRR	Q2,-1(STACK)	; ADDRESS OF EBLOK...
   675	400473'	541 15 0 16 000002 		HRRI	Q1,LHDR(Q2)	; PLUS HEADER LENGTH IS 'TO' ADDRESS
   676	400474'	271 16 0 13 000002 		ADDI	Q2,LHDR(T3)	; EBLOK ADDRESS PLUS LENGTH
   677	400475'	251 15 0 16 777777 		BLT	Q1,-1(Q2)	; MOVE EXPRESSION CODE INTO EBLOK
   678
   679	400476'	201 00 0 00 000002 		MOVEI	Z,LHDR		; LENGTH OF BLOK HEADER TO Z
   680	400477'	202 00 0 01 000000 		MOVEM	Z,0(STACK)	; IS OFFSET TO START OF EXPRESSION
   681	400500'	265 11 0 00 000000*		JSP	TLINK,UBENTR##	; PUT DESCRIPTOR IN CURRENT UTBLOK
   682	400501'	505 00 0 00 160000 		HRLI	Z,CONST		; THIS IS JUST LIKE A CONSTANT
   683
   684	400502'	200 05 0 00 400470*		MOVE	P2,CURSOE	; RESET P2 TO MOST RECENT SOE
   685	400503'	200 17 0 00 400467*		MOVE	Q3,FLAP		; GET ADDRESS OF CURRENT CBLOK
   686	400504'	271 17 0 05 777777 		ADDI	Q3,-1(P2)	; POINT TO PREVIOUS CURSOE VALUE
   687	400505'	250 00 0 17 000000 		EXCH	Z,0(Q3)		; STORE TOKEN AND FETCH OLD CURSOE
   688	400506'	202 00 0 00 400502*		MOVEM	Z,CURSOE	; RESTORE PREVIOUS VALUE OF CURSOE
   689
   690	400507'	265 00 0 00 000000*		POPSA	T		; POP SAVE AREA AND COME BACK...
   691	400510'	000011	400460*
   692	400511'	265 00 0 00 000000*		POPR	TQ		; DOWN TO TYPE Q
   693	400512'	000007	000011
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 16-1
SNOSYN	MAC	13-Oct-66 21:59		UTILITIES

   694	400513'	254 00 0 15 000000 		JRST	0(QLINK)	; RETURN TO CALLER
   695
   696						 ; HERE TO CHECK CBLOK SIZE
   697
   698	400514'	315 05 0 00 400165*	PUT1:	CAMGE	P2,CBLENG	; ARE WE AT THE END OF THE CBLOK ?
   699	400515'	254 00 0 15 000000 		JRST	0(QLINK)	; NO - RETURN
   700
   701	400516'	201 00 0 00 000000*		MOVEI	Z,CE.LS##	; GIVE LONG-STATEMENT ...
   702	400517'	254 00 0 00 400623'		JRST	CERR1		; ERROR MESSAGE.
   703
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 17
SNOSYN	MAC	13-Oct-66 21:59		UTILITIES

   704
   705					; FLUSH - WILL FLUSH OPERATORS OUT OF THE CSTACK INTO THE
   706					; CBLOK, STOPPING AT THE FIRST FENCE (0 PRECEDENCE).
   707					;
   708					; CALLING SEQUENCE:
   709					;	JSP	TLINK,FLUSH
   710					;	HIGH FENCE (0 ELEMENT)
   711					;	LOW FENCE (NON ZERO ELEMENT)
   712
   713						 ; TEST FOR FENCE
   714
   715	400520'	332 00 0 04 000000 	FLUSH:	SKIPE	0(CSTACK)	; ARE WE AT A FENCE ALREADY?
   716	400521'	254 00 0 00 400525'		JRST	FLUSH1		; NO - TAKE BRANCH
   717
   718						 ; TAKE PROPER RETURN
   719
   720	400522'	336 00 0 04 777777 		SKIPN	-1(CSTACK)	; CHECK FOR HIGH FENCE
   721	400523'	254 00 0 11 000000 		JRST	0(TLINK)	; YES - HIGH
   722	400524'	254 00 0 11 000001 		JRST	1(TLINK)	; NO - LOW
   723
   724						 ; FLUSH ONE ELEMENT FROM THE STACK
   725
   726	400525'	262 04 0 00 000000 	FLUSH1:	POP	CSTACK,Z	; REMOVE PRECEDENCE
   727	400526'	262 04 0 00 000000 		POP	CSTACK,Z	; POP OPERATOR
   728	400527'	265 15 0 00 400447'		JSP	QLINK,PUT	; INSERT OPERATOR INTO CBLOK
   729	400530'	254 00 0 00 400520'		JRST	FLUSH		; LOOP FOR MORE
   730
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 18
SNOSYN	MAC	13-Oct-66 21:59		UTILITIES

   731
   732					; CBALL (CBLOK ALLOCATE) IS USED BY BOTH CBINIT AND
   733					; CBMORE TO ALLOCATE A CBLOK.
   734					;
   735					; CALLING SEQUENCE:
   736					;	JSP	T4,CBALL
   737
   738						 ; ESTABLISH ROOM
   739
   740	400531'	200 00 0 00 400514*	CBALL:	MOVE	Z,CBLENG	; GET LENGTH OF CBLOK
   741	400532'	265 15 0 00 000000*		JSP	QLINK,GCOLF##	; ENSURE THIS MUCH SPACE
   742
   743	400533'	505 00 0 00 000407 		HRLI	Z,CBLOK		; INSERT BLOK TYPE
   744	400534'	265 15 0 00 400465*		JSP	QLINK,BLOK##	; ALLOCATE THE CBLOK
   745	400535'	001 17 0 00 000000 		ERROR	15		; CAN'T FAIL
   746
   747	400536'	201 05 0 00 000004 		MOVEI	P2,CCODE	; INITIALIZE P2
   748	400537'	254 00 0 14 000000 		JRST	0(T4)		; AND RETURN
   749
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 19
SNOSYN	MAC	13-Oct-66 21:59		UTILITIES

   750
   751					; CBMORE - CALLED WHENEVER THE CURRENT CBLOK IS RUNNING LOW
   752					;
   753					; CALLING SEQUENCE
   754					;	JSP	TLINK,CBMORE
   755
   756	400540'	200 00 0 00 400656'	CBMORE:	MOVE	Z,[CDIF,,LRGOTO##]	; INSERT LAST ...
   757	400541'	265 15 0 00 400447'		JSP	QLINK,PUT	; TOKEN INTO CBLOK
   758
   759	400542'	265 15 0 00 400560'		JSP	QLINK,CBSNIP	; SNIP OFF THE UNUSED PORTION
   760
   761	400543'	265 14 0 00 400531'		JSP	T4,CBALL	; GET THE NEXT CBLOK
   762	400544'	262 01 0 00 000000 		POP	STACK,Z		; JUNK
   763	400545'	262 01 0 00 000016 		POP	STACK,Q2	; GET POINTER TO NEW
   764
   765	400546'	200 15 0 00 400503*		MOVE	Q1,FLAP		; GET POINTER TO OLD
   766	400547'	202 16 0 00 400546*		MOVEM	Q2,FLAP		; REESTABLISH CURRENT
   767
   768	400550'	202 16 0 15 000003 		MOVEM	Q2,NCLINK(Q1)	; INTERCONNECT ...
   769	400551'	202 15 0 16 000002 		MOVEM	Q1,LCLINK(Q2)	; THE PAIR
   770
   771	400552'	254 00 0 11 000000 		JRST	0(TLINK)	; AND RETURN
   772
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 20
SNOSYN	MAC	13-Oct-66 21:59		UTILITIES

   773
   774					; CBINIT - INITIALIZE A CBLOK - CALLED AT THE BEGINNING
   775					; OF COMPILATION.
   776					;
   777					; CALLING SEQUENCE:
   778					;	JSP	TLINK,CBINIT
   779
   780	400553'	265 14 0 00 400531'	CBINIT:	JSP	T4,CBALL	; ALLOCATE THE CBLOK
   781
   782	400554'	200 13 0 01 777777 		MOVE	T3,-1(STACK)	; PICK UP DESCRIPTOR TOP ...
   783	400555'	202 13 0 00 400547*		MOVEM	T3,FLAP		; AND STORE INTO FLAP.
   784
   785	400556'	202 05 0 01 000000 		MOVEM	P2,0(STACK)	; PLACE INITIAL OFFSET INTO STACK
   786	400557'	254 00 0 11 000000 		JRST	0(TLINK)	; AND RETURN
   787
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 21
SNOSYN	MAC	13-Oct-66 21:59		UTILITIES

   788
   789					; CBSNIP - WILL REMOVE THE UNUSED PORTION OF THE CURRENT
   790					; CBLOK RETURNING IT TO THE AVAILABLE STORAGE POOL.
   791					; P2 INDICATES THE CURRENT LENGTH OF THE CBLOK
   792					; CALLING SEQUENCE:
   793					;	JSP	QLINK,CBSNIP
   794
   795	400560'	550 16 0 00 400555*	CBSNIP:	HRRZ	Q2,FLAP		; LOAD ADDRESS OF CBLOK
   796	400561'	550 00 0 16 000000 		HRRZ	Z,BLENG(Q2)	; ORIGINAL LENGTH OF CBLOK
   797	400562'	275 00 0 05 000000 		SUBI	Z,0(P2)		; AMOUNT OF REMAINING STORAGE
   798	400563'	305 00 0 00 000002 		CAIGE	Z,2		; NO SENSE SNIPPING UNLESS WE ...
   799	400564'	254 00 0 15 000000 		JRST	0(QLINK)	; GET AT LEAST 2 WORDS
   800	400565'	542 05 0 16 000000 		HRRM	P2,BLENG(Q2)	; INSERT NEW LENGTH
   801
   802	400566'	271 16 0 05 000000 		ADDI	Q2,0(P2)	; POINT PAST BOTH ...
   803	400567'	270 16 0 00 000000 		ADD	Q2,Z		; REGIONS AND SEE IF WE'RE ...
   804	400570'	312 16 0 00 000002 		CAME	Q2,SURF		; AT THE SURFACE
   805	400571'	254 00 0 00 400574'		JRST	CBSNP1		; AND JUMP IF NOT
   806
   807	400572'	274 02 0 00 000000 		SUB	SURF,Z		; OTHERWISE BRING SURFACE
   808	400573'	254 00 0 15 000000 		JRST	0(QLINK)	; DOWN AND RETURN
   809
   810						 ; CREATE A JUNK BLOK TO FILL THE VOID
   811
   812	400574'	200 16 0 00 400560*	CBSNP1:	MOVE	Q2,FLAP		; GET ORIGINAL ADDRESS
   813	400575'	271 16 0 05 000000 		ADDI	Q2,0(P2)	; POINT JUST AFTER CBLOK
   814	400576'	270 00 0 00 400657'		ADD	Z,[JKBLOK,,0]	; PREPARE TYPE LENGTH
   815	400577'	202 00 0 16 000000 		MOVEM	Z,BTCODE&BLENG(Q2)	; PLUG HEADER
   816	400600'	402 00 0 16 000001 		CLEARM	GCFLD(Q2)	; MAKE GC HAPPY
   817	400601'	254 00 0 15 000000 		JRST	0(QLINK)	; AND RETURN
   818
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 22
SNOSYN	MAC	13-Oct-66 21:59		UTILITIES

   819
   820						SUBTTL	COMPILER ERROR HANDLING
   821
   822					;	CERR IS THE MAIN ENTRY POINT. Z CONTAINS SOME
   823					; ERROR INDICATION. THE RETURN POINT IS TKEOS1 (DURING
   824					; PRE-EXECUTION ONLY).
   825
   826	400602'	402 00 0 00 000000#	CERR:	CLEARM	IGNOP+1		; FLAG TO INDICATE ENTRY POINT
   827
   828	400603'	332 00 0 00 400110*		SKIPE	PREX		; ARE WE IN EXECUTION
   829	400604'	254 00 0 00 400611'		JRST	CERR2		; NO - BRANCH TO GIVE MESSAGE
   830
   831	400605'	200 04 0 00 400341*		MOVE	PLINK,IGNOP	; YES - LOAD LINK REG.
   832	400606'	332 00 0 00 400340*		SKIPE	EXFLAG		; EXPRESSION?
   833	400607'	254 00 0 04 000000 		JRST	0(PLINK)	; YES - FAIL
   834	400610'	254 00 0 00 000000*		JRST	FRET1##		; NO - FAIL AND CLEAN STACK
   835
   836						 ; HERE IF ERROR OCCURRED DURING COMPILATION TIME
   837
   838	400611'	265 06 0 00 400212*	CERR2:	JSP	SLINK,CERROR##	; PRINT THE MESSAGE
   839
   840	400612'	200 05 0 00 000000#		MOVE	P2,FLAP+1	; POINT TO ...
   841	400613'	271 05 0 00 000003 		ADDI	P2,CRULE	; FIRST TOKEN OF STATEMENT
   842	400614'	200 00 0 00 400660'		MOVE	Z,[CDIF,,ERRST##]	; INSERT ERROR INDICATOR ...
   843	400615'	265 15 0 00 400447'		JSP	QLINK,PUT	; INTO CBLOK
   844
   845	400616'	402 00 0 00 400434*		CLEARM	FGT		; REMOVE GOTO'S
   846	400617'	402 00 0 00 400441*		CLEARM	RGT		; THAT MAY HAVE OCCURRED
   847
   848	400620'	336 00 0 00 000000#		SKIPN	IGNOP+1		; TEST ENTRY POINT
   849	400621'	254 00 0 00 400146'		JRST	TKEOS1		; CERR - JUST RETURN
   850	400622'	254 00 0 00 400625'		JRST	CERR1A		; CERR1 - GO LOOP ON TOKEN
   851
   852
   853					; CERR1 IS LIKE CERR EXCEPT THAT AFTER PRINTING OUT
   854					; AN ERROR MESSAGE, TOKEN IS CALLED REPEATEDLY UNTIL
   855					; AN END-OF-STATEMENT OR ERROR IS GIVEN.
   856
   857						 ; FIRST GIVE DIAGNOSTIC
   858
   859	400623'	476 00 0 00 000000#	CERR1:	SETOM	IGNOP+1		; FLAG TO INDICATE ENTRY
   860	400624'	254 00 0 00 400603'		JRST	CERR+1		; DELIVER MESSAGE
   861
   862						 ; RETURN IS TO HERE
   863
   864	400625'	265 06 0 00 400125*	CERR1A:	JSP	SLINK,TOKEN	; CALL TOKEN UNTIL ...
   865	400626'	255 00 0 00 000000 		JFCL			; (NO-OP) EITHER THIS ...
   866	400627'	254 00 0 00 400146'		JRST	TKEOS1		; OR THIS OCCURS.
   867	400630'	254 00 0 00 400625'		JRST	CERR1A		; OTHERWISE LOOP.
   868
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 23
SNOSYN	MAC	13-Oct-66 21:59		COMPILER ERROR HANDLING

   869
   870					;	SPECIFIC ERRORS
   871
   872						 ; REPORT CE.GT (ERROR IN GOTO)
   873
   874	400631'	201 00 0 00 000000*	RCE.GT:	MOVEI	Z,CE.GT##
   875	400632'	254 00 0 00 400623'		JRST	CERR1
   876
   877						 ; TOO MANY LEFT PARENS OR LEFT BRACKETS
   878
   879	400633'	201 00 0 00 400144*	RCE.BL:	MOVEI	Z,CE.BL
   880	400634'	254 00 0 00 400623'		JRST	CERR1
   881
   882						 ; INSUFFICIENT NUMBER OF LEFT PARENS OR LEFT BRACKETS
   883
   884	400635'	201 00 0 00 000000*	RCE.BR:	MOVEI	Z,CE.BR##
   885	400636'	254 00 0 00 400623'		JRST	CERR1
   886
   887						 ; PREVIOUSLY DEFINED LABEL
   888
   889	400637'	201 00 0 00 000000*	RCE.PL:	MOVEI	Z,CE.PL##
   890	400640'	254 00 0 00 400623'		JRST	CERR1
   891
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 24
SNOSYN	MAC	13-Oct-66 21:59		COMPILER ERROR HANDLING

   892
   893						SUBTTL	MISC. DATA
   894
   895						 ; PURE DATA
   896
   897	400641'	000000000000#		MTCH$$:	MTCH$##		; ADDRESS OF PATTERN MATCHING ROUTINE
   898	400642'	000000000000#		ITEM$$:	ITEM$##		; ADDRESS OF ARRAY REFERENCE ROUTINE
   899
   900						END

NO ERRORS DETECTED

HI-SEG. BREAK IS 400661
PROGRAM BREAK IS 000000
CPU TIME USED 05:31.302

44P CORE USED
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page S-1
SNOSYN	MAC	13-Oct-66 21:59		SYMBOL TABLE

BADLBL		400211'		ENDFLG		400175'	ext	PSHR		400455'	ext	TKEND		400132'		
BGST		400646'	ext	ENDLBL		400202'	ext	PSHSA		400457'	ext	TKEOS		400142'		
BK$COM		400356'		EOE		400651'	ext	PUT		400447'		TKEOS1		400146'		
BK.ARY		400257'		EOP		400647'	ext	PUT1		400514'		TKEOS2		400164'		
BK.FUN		400244'		ERR	001000	000000		PZLOOP		400231'		TKEOS3		400202'		
BK.GT		400443'		ERR.	003000	000000		Q1		000015		TKINIT		400004'	ext	
BLENG		000000	sin	ERRST		400660'	ext	Q2		000016		TKLOOP		400125'		
BLOK		400534'	ext	EXFLAG		400606'	ext	Q3		000017		TLINK		000011		
BTCODE		000000	sin	EXINIT		400025'	ext	QLINK		000015		TOKEN		400625'	ext	
CBALL		400531'		FAILGT		400426'		RCE.BL		400633'		TRVAL		000002	sin	
CBINIT		400553'		FGT		400616'	ext	RCE.BR		400635'		UBENTR		400500'	ext	
CBLENG		400531'	ext	FLAP		400574'	ext	RCE.GT		400631'		UNCOND		400436'		
CBLOK		000407	sin	FLUSH		400520'		RCE.PL		400637'		VAR		064000	sin	
CBMORE		400540'		FLUSH1		400525'		REGT		000011	spd	VB.AL1		400045'		
CBSNIP		400560'		FNLOOP		400241'		RGT		400617'	ext	VB.ALL		400042'		
CBSNP1		400574'		FRET1		400610'	ext	RPREC		000003	sin	VB.BL		400335'	ext	
CCODE		000004	sin	FTDEBU		000000	spd	S1		000006		VB.EQ		400041'	ext	
CDARGS		007777	sin	GCFLD		000001	sin	S2		000007		VB.F		400413'	ext	
CDF		200000	sin	GCOLF		400532'	ext	S3		000010		VB.S		400411'	ext	
CDIF		600000	sin	GOTO		400367'	ext	SAVET		400510'	ext	VB.ST		400263'	ext	
CE.BL		400633'	ext	GTLOOP		400423'		SGT		400437'	ext	VB.TBL		400035'		
CE.BR		400635'	ext	GTTEST		400402'		SLINK		000006		VBINRY		000003	sin	
CE.GT		400631'	ext	GTZONE		400403'	ext	STACK		000001		VFLAGS		000006	sin	
CE.IC		400350'	ext	HSTACK		400061'	ext	STLOOP		400056'		VFUNC		000003	sin	
CE.LS		400516'	ext	IGNOP		400605'	ext	STLP1		400061'		VLABEL		000002	sin	
CE.PL		400637'	ext	IGOTO		400655'	ext	SUCCGT		400416'		VUNARY		000002	sin	
CE.UT		400211'	ext	INSTAL		400051'	ext	SURF		000002		Z		000000		
CERR		400602'		ITEM$		000000	ext	SY$COL		400340'	int	$ALPHA		400047'	ext	
CERR1		400623'		ITEM$$		400642'		SY$COM		400346'	int	%%MACT	000200	000025	spd	
CERR1A		400625'		JKBLOK		000417	sin	SY$LB		400362'	int	%%SNOP	000500	000305	spd	
CERR2		400611'		LAST		400174'	ext	SY$LP		400367'	int	
CERROR		400611'	ext	LBL1		400123'		SY$RB		400374'	int	
CFGOTO		000001	sin	LBL2		400121'		SY$RP		400374'	int	
CHEAD		000000	sin	LCLINK		000002	sin	SY.ARY		400250'	int	
CLAST		000002	sin	LEVEL		400402'	ext	SY.BIN		400301'	int	
CMPNO		400077'	ext	LHDR		000002	sin	SY.BN1		400321'		
CNEXT		000002	sin	LPREC		000002	sin	SY.BN2		400324'		
CODE		400000'	int	LREGQ		000003	spd	SY.BN3		400331'		
CODE1		400010'		LREGT		000004	spd	SY.BN4		400335'		
CONDGT		400410'		LRGOTO		400656'	ext	SY.BN5		400323'		
CONST		160000	sin	LSAVET		000011	spd	SY.CON		400233'	int	
CRULE		000003	sin	LTFLAG		200000	sin	SY.FUN		400235'	int	
CSTACK		000004		MTCH$		000000	ext	SY.ID		400230'	int	
CSTNO		000001	sin	MTCH$$		400641'		SY.STR		400272'		
CURSOE		400506'	ext	NCLINK		000003	sin	SY.UNY		400262'	int	
CVTEXP		400016'	int	NULLST		400650'	ext	SYNASC	516631	600000	spd	
CVTSTR		400023'	ext	NVBS		000005	spd	SYNEDT		000246	spd	
DGOTO		400362'	ext	P2		000005		SYNMIN		000000	spd	
E1$56		000000	sin	PAGENO		400071'	ext	SYNSIX	637156	000000	spd	
E12$4		000000	sin	PLINK		000004		SYNVER		000005	spd	
E13$55		000000	sin	PMFLAG		400315'	ext	SYNWHO		000000	spd	
E15$		000000	sin	PPL		000007	spd	T1		000011		
EBLOK		000406	sin	PPR		400511'	ext	T2		000012		
EDT		004006	sin	PPSA		400507'	ext	T3		000013		
ENDEXP		400214'		PREX		400603'	ext	T4		000014		

SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 1
SNOSYN	MAC	13-Oct-66 21:59		MA355/JDS/DRH/MP/RCM/VB		15-JUN-76


Symbol cross reference

BADLBL	   316	   324#
BGST	   184
BK$COM	   517	   522#	   557
BK.ARY	   403	   408#	   534
BK.FUN	   377	   387#
BK.GT	   602	   634#
BLENG	   796	   800	   815
BLOK	   668	   744
BTCODE	   815
CBALL	   740#	   761	   780
CBINIT	    85	   125	   780#
CBLENG	   291	   698	   740
CBLOK	   743
CBMORE	   306	   756#
CBSNIP	   251	   340	   759	   795#
CBSNP1	   805	   812#
CCODE	   294	   331	   747
CDARGS	   183
CDF	   389	   409	   420	   471
CDIF	   184	   248	   334	   432	   612	   635	   653	   756	   842
CE.BL	   260	   879
CE.BR	   884
CE.GT	   874
CE.IC	   512
CE.LS	   701
CE.PL	   889
CE.UT	   324
CERR	   196	   233	   261	   826#	   860
CERR1	   515	   702	   859#	   875	   880	   885	   890
CERR1A	   850	   864#	   867
CERR2	   829	   838#
CERROR	   325	   838
CFGOTO	   275
CHEAD	   185
CLAST	   296
CMPNO	   187	   189
CNEXT	   296
CODE	    77#
CODE1	    83	    90#
CONDGT	   375	   398	   581#
CONST	   330	   367	   682
CRULE	   191	   841
CSTACK	   172	   173	   174	   381	   382	   387	   421	   422	   433	   434	   475	   477	   478	   483
	   484	   513	   523	   524	   634	   715	   720	   726	   727
CSTNO	   188
CURSOE	   121	   427	   430	   654	   665	   672	   684	   688
CVTEXP	   107#
CVTSTR	   114
DGOTO	   396	   530
E1$56	    94#
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 1
SNOSYN	MAC	13-Oct-66 21:59		MA355/JDS/DRH/MP/RCM/VB		15-JUN-76


Symbol cross reference

E12$4	    91#
E13$55	    95#
E15$	   152#	   669#	   745#
EBLOK	   666
EDT	   111	   342
ENDEXP	   266	   330#
ENDFLG	    78	   245	   303
ENDLBL	   167	   246	   311
EOE	   334	   432	   653
EOP	   248
ERRST	   842
EXFLAG	    79	   108	   176	   265	   497	   832
EXINIT	   117
FAILGT	   586	   609#
FGT	   279	   594	   617	   845
FLAP	   175	   179	   180	   202	   203	   268	   269	   284	   298	   650	   671	   685	   765	   766
	   783	   795	   812	   840
FLUSH	   258	   502	   509	   553	   715#	   729
FLUSH1	   716	   726#
FNLOOP	   381#	   404	   518	   535	   545	   604
FRET1	   834
FTDEBU	   659	   661	   690	   692
GCFLD	   816
GCOLF	   741
GOTO	   373	   540
GTLOOP	   602#	   619	   629
GTTEST	   374	   397	   531	   541	   570#
GTZONE	   120	   446	   500	   571
HSTACK	   172
IGNOP	    77	   107	   243	   345	   498	   826	   831	   848	   859
IGOTO	   612
INSTAL	   151
ITEM$	   898
ITEM$$	   409	   898#
JKBLOK	   814
LAST	    80	   295	   299
LBL1	   211	   226#
LBL2	   207	   221#
LCLINK	   769
LEVEL	   123	   165	   166	   443	   550	   570
LHDR	   667	   675	   676	   679
LPREC	   466
LREGQ	   659	   692
LREGT	   659	   692
LRGOTO	   756
LSAVET	   661	   690
LTFLAG	   210
MTCH$	   897
MTCH$$	   458	   897#
NCLINK	   768
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 1
SNOSYN	MAC	13-Oct-66 21:59		MA355/JDS/DRH/MP/RCM/VB		15-JUN-76


Symbol cross reference

NULLST	    93	   330
NVBS	   131#	   143
P2	    92	    93	   175	   191	   253	   274	   281	   290	   293	   305	   331	   430	   597	   616
	   617	   628	   649	   664	   684	   686	   698	   747	   785	   797	   800	   802	   813	   840
	   841
PAGENO	   182
PLINK	    77	   107	   112	   115	   118	   243	   313	   320	   326	   345	   346	   831	   833
PMFLAG	   449	   451	   459
PPL	   659#	   659	   660	   661#	   661	   662	   690#	   690	   691	   692#	   692	   693
PPR	   692
PPSA	   690
PREX	    90	   141	   206	   828
PSHR	   659
PSHSA	   661
PUT	   249	   332	   335	   338	   361	   401	   428	   485	   613	   614	   636	   649#	   728	   757
	   843
PUT1	   655	   698#
PZLOOP	   361#	   368	   391	   410
Q1	   202	   203	   214	   215	   226	   227	   671	   672	   673	   675	   677	   765	   768	   769
Q2	   226	   570	   574	   674	   675	   676	   677	   763	   766	   768	   769	   795	   796	   800
	   802	   803	   804	   812	   813	   815	   816
Q3	   649	   650	   651	   685	   686	   687
QLINK	   249	   251	   332	   335	   338	   340	   361	   374	   397	   401	   428	   485	   531	   541
	   572	   575	   576	   613	   614	   636	   668	   694	   699	   728	   741	   744	   757	   759
	   799	   808	   817	   843
RCE.BL	   504	   879#
RCE.BR	   510	   551	   554	   884#
RCE.GT	   492	   588	   596	   610	   626	   874#
RCE.PL	   222	   889#
REGT	   659	   660	   692	   693
RGT	   273	   593	   609	   616	   624	   628	   846
RPREC	   467
S1	   110	   111	   143	   147	   153	   155	   199	   209	   213	   221	   227	   238	   239	   268
	   269	   275	   296	   373	   396	   440	   441	   453	   460	   466	   467	   478	   490	   513
	   514	   530	   540	   602	   603
S2	   147	   148	   150	   153	   154	   273	   274	   275	   279	   282	   284	   285	   291	   292
	   293	   305	   311	   315	   461	   466	   475	   524	   525	   581	   582	   585
S3	   281	   283	   285	   290	   294	   295	   296	   298	   299	   315	   318	   319	   389	   408
	   441	   458	   471	   477	   522	   556
SAVET	   661	   661#	   662	   690	   691
SGT	   282	   283	   595	   597	   625
SLINK	    82	   117	   195	   232	   325	   838	   864
STACK	    92	   110	   149	   150	   318	   319	   343	   674	   680	   762	   763	   782	   785
STLOOP	   142	   165#	   307
STLP1	   126	   172#
SUCCGT	   583	   593#
SURF	   804	   807
SY$COL	   352	   497#
SY$COM	   352	   509#
SY$LB	   352	   530#
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 1
SNOSYN	MAC	13-Oct-66 21:59		MA355/JDS/DRH/MP/RCM/VB		15-JUN-76


Symbol cross reference

SY$LP	   352	   540#
SY$RB	   352	   550#
SY$RP	   352	   549#
SY.ARY	   351	   396#
SY.BIN	   351	   440#
SY.BN1	   444	   450	   454	   466#
SY.BN2	   475#	   486
SY.BN3	   476	   483#
SY.BN4	   447	   490#
SY.BN5	   462	   471#
SY.CON	   351	   367#
SY.FUN	   351	   373#
SY.ID	   351	   357#
SY.STR	   417	   427#
SY.UNY	   351	   415#
SYNASC	    29#
SYNEDT	    22#
SYNMIN	    21#
SYNSIX	    28#
SYNVER	    20#
SYNWHO	    23#
T1	   179	   180	   185	   188	   209	   210
T2	   213	   214	   215	   221	   222
T3	   664	   665	   667	   676	   782	   783
T4	   748	   761	   780
TKEND	   197	   243#
TKEOS	   234	   258#
TKEOS1	   254	   259	   265#	   849	   866
TKEOS2	   280	   290#
TKEOS3	   304	   311#
TKINIT	    82
TKLOOP	   177	   200	   217	   232#	   362	   383	   423	   435	   479	   491	   503	   514	   544	   637
TLINK	    85	   114	   125	   151	   258	   306	   502	   509	   553	   681	   721	   722	   771	   786
TOKEN	   195	   232	   864
TRVAL	   214	   215
UBENTR	   681
UNCOND	   532	   542	   624#
VAR	   357	   400
VB.AL1	   147#	   155
VB.ALL	    86	   141#
VB.BL	   136	   453	   490
VB.EQ	   137
VB.F	   134	   585
VB.S	   133	   582
VB.ST	   135	   416
VB.TBL	   133#	   147	   153
VBINRY	   441
VFLAGS	   209
VFUNC	   388
VLABEL	   213	   221	   227	   315
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 1
SNOSYN	MAC	13-Oct-66 21:59		MA355/JDS/DRH/MP/RCM/VB		15-JUN-76


Symbol cross reference

VUNARY	   419
Z	   122	   123	   154	   166	   167	   182	   183	   184	   185	   187	   188	   199	   238	   246
	   248	   260	   324	   330	   334	   337	   342	   343	   357	   367	   377	   381	   387	   388
	   389	   400	   403	   408	   409	   415	   416	   419	   420	   421	   427	   432	   433	   440
	   483	   484	   512	   517	   534	   544	   581	   603	   612	   634	   635	   651	   653	   659
	   661	   666	   667	   679	   680	   682	   687	   688	   690	   692	   701	   726	   727	   740
	   743	   756	   762	   796	   797	   798	   803	   807	   814	   815	   842	   874	   879	   884
	   889
$ALPHA	   149
SNOSYN - Syntactical Analyzer  %5(246)	MACRO %53B(1156)-1 21:47 14-Mar-88 Page 1
SNOSYN	MAC	13-Oct-66 21:59		MA355/JDS/DRH/MP/RCM/VB		15-JUN-76


Macro/Opdef cross reference

DMOVE	   202
DMOVEM	   214
ERR	    91	    95	   152	   669	   745
ERR.	    94
ERROR	    91	    95	   152	   669	   745
ERROR.	    94
MIDENT	   660	   662	   691	   693
POPR	   692
POPSA	   690
PPADDR	   659#	   660	   661#	   662	   690#	   691	   692#	   693
PPINIT	   659	   661	   690	   692
PPLENG	   659#	   660	   661#	   662	   690#	   691	   692#	   693
PUSHR	   659
PUSHSA	   661
SHOW.	    35	    36
SYNPTX	    39
SYNTTL	    38
TITLE.	    27  b@