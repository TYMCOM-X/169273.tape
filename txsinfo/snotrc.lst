SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOTRC	MAC	13-Oct-66 22:17		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76

     1						SUBTTL	Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76
     2
     3					; COPYRIGHTS 1972,1973,1976,1977  STEVENS INSTITUTE OF TECHNOLOGY
     4					; HOBOKEN, NEW JERSEY, 07030
     5					; ALL RIGHTS RESERVED.
     6
     7					  ;UNIVERSALS
     8
     9						SEARCH	MACTEN		;DEC-10 COMMON MACROS
    10						SEARCH	SNOPRM		;SITBOL PARAMETER FILE
    11
    12					  ;DIRECTIVES
    13
    14						.DIRECT	.XTABM		;EXCLUDE TABS FROM MACRO CALLS
    15						SALL			;SUPPRESS MACRO EXPANSIONS
    16	400000'					TWOSEG	400K		;TWOSEGMENT CODE
    17
    18					  ;VERSION NUMBER
    19
    20			000005			TRCVER==5		;MAJOR VERSION NUMBER
    21			000000			TRCMIN==0		;MINOR VERSION NUMBER
    22			000251			TRCEDT==251		;EDIT LEVEL
    23			000000			TRCWHO==0		;CUSTOMER ARGUMENT
    24
    25					  ;TITLE
    26
    27						TITLE.	TRC,SNOTRC,<Tracing Routines>
    28		646243	000000			TRCSIX==SIXBIT /TRC/	; SNOTRC ABBREVIATION IN SIXBIT
    29		522450	300000			TRCASC==ASCIZ /TRC/	; SNOTRC ABBREVIATION IN ASCII
    30						SALL
    31
    32
    33					  ;SHOW UNIVERSAL VERSION NUMBERS
    34
    35	400000'	000200	000025			SHOW.	%%MACT		;VERSION NUMBER OF MACTEN
    36	400000'	000500	000305			SHOW.	%%SNOP		;VERSION NUMBER OF SNOPRM
    37
    38						TRCTTL				;Title
    39						TRCPTX				; PASS2 assembly message
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 2
SNOTRC	MAC	13-Oct-66 22:17		Table of Contents

    40						SUBTTL	Table of Contents
    41
    42					;		Table of Contents for Tracing Routines
    43					;
    44					;
    45					;			   Section			      Page
    46					;   1. Table of Contents. . . . . . . . . . . . . . . . . . .    2
    47					;   2. REVISION HISTORY . . . . . . . . . . . . . . . . . . .    3
    48					;   3. MISC DEFINITIONS . . . . . . . . . . . . . . . . . . .    4
    49					;   4. PRIMARY FUNCTION
    50					;        4.1.   STOPTR. . . . . . . . . . . . . . . . . . . .    5
    51					;        4.2.   TRACE . . . . . . . . . . . . . . . . . . . .    5
    52					;   5. COMMON SUBROUTINES . . . . . . . . . . . . . . . . . .    6
    53					;   6. VALUE TRACING. . . . . . . . . . . . . . . . . . . . .   10
    54					;   7. FUNCTION TRACING . . . . . . . . . . . . . . . . . . .   12
    55					;   8. LABEL TRACING. . . . . . . . . . . . . . . . . . . . .   15
    56					;   9. KEYWORD TRACING. . . . . . . . . . . . . . . . . . . .   17
    57					;  10. PRIMARY FUNCTION
    58					;       10.1.   ASSIGN. . . . . . . . . . . . . . . . . . . .   19
    59					;       10.2.   DUMP. . . . . . . . . . . . . . . . . . . . .   20
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 3
SNOTRC	MAC	13-Oct-66 22:17		REVISION HISTORY

    60						SUBTTL	REVISION HISTORY
    61
    62					COMMENT	\
    63
    64					START OF VERSION 5.
    65					122	RENAME MODULES & CLEAN UP.
    66					131	Add code to process associated variables.
    67					132	Fix bug in collection of Wsedim.
    68					150	Prevent labels from becoming undefined.  The wrong AC
    69						was being used for indexing.
    70					152	Save more info about traces.
    71					224	Third argument to TRACE is converted to string,
    72						it shoould not be.  Fix it.
    73					225	Fix typo
    74					251	Add missing PORTAL
    75					\
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 4
SNOTRC	MAC	13-Oct-66 22:17		MISC DEFINITIONS

    76						SUBTTL	MISC DEFINITIONS
    77
    78			000000*		TRFL==XERRF##		;TRACE FILE SAME AS ERROR FILE
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 5
SNOTRC	MAC	13-Oct-66 22:17		PRIMARY FUNCTION -- STOPTR

    79						SUBTTL	PRIMARY FUNCTION -- STOPTR
    80
    81	400000'	402 00 0 00 000000#	STOPTR::CLEARM	IGNOP##+3		; FLAG ENTRY
    82	400001'	254 00 0 00 400045'		JRST	TRACE2		; JOIN COMMON PROCESSING
    83
    84
    85						SUBTTL	PRIMARY FUNCTION -- TRACE
    86
    87	400002'	476 00 0 00 000000#	TRACE::	SETOM	IGNOP##+3		; FLAG ENTRY
    88	400003'	201 11 0 00 001750 		MOVEI	T1,^D1000	; BOOST ...
    89	400004'	272 11 0 00 000000*		ADDM	T1,$TRACE##	; # OF TRACE REQUESTS
    90
    91	400005'	200 05 0 00 000000 		MOVE	P2,Z		; # OF ARGS
    92
    93	400006'	307 05 0 00 000001 	TRAC.A:	CAIG	P2,1		; LOOP TO REMOVE UNNECESSARY NULLS
    94	400007'	254 00 0 00 400015'		JRST	TRAC.B		; BUT ONLY FOR LAST 3 ARGUMENTS
    95
    96	400010'	200 00 0 01 777777 		MOVE	Z,-1(STACK)	; CHECK FOR THE NULL STRING...
    97	400011'	312 00 0 00 000000*		CAME	Z,NULLST##	; AS AN ARGUMENT
    98	400012'	254 00 0 00 400015'		JRST	TRAC.B		; QUIT IF WE HAVE OTHER THAN NULL STRING
    99
   100	400013'	274 01 0 00 000000*		SUB	STACK,XWD22##	; OTHERWISE PRUNE STACK AND...
   101	400014'	364 05 0 00 400006'		SOJA	P2,TRAC.A	; ADJUST NUMBER OF ARGUMENTS
   102
   103	400015'	200 00 0 00 401303'	TRAC.B:	MOVE	Z,[TRBLOK,,6]	; ALLOCATE
   104	400016'	306 05 0 00 000004 		CAIN	P2,4		; A
   105	400017'	541 00 0 00 000012 		HRRI	Z,12		; TRACE
   106	400020'	306 05 0 00 000003 		CAIN	P2,3		; BLOK
   107	400021'	541 00 0 00 000010 		HRRI	Z,10		; OF
   108	400022'	265 15 0 00 000000*		JSP	QLINK,BLOK##	; SIZE
   109	400023'	001 17 0 00 000000 		ERROR	15		; DEPINDING
   110	400024'	262 01 0 00 000000#		POP	STACK,FLAP##+1	; ON 
   111	400025'	262 01 0 00 000000*		POP	STACK,FLAP##	; # OF ARGUMENTS
   112
   113	400026'	254 00 1 05 400026'		JRST	@<TRTBL-1>(P2)	; FAN OUT
   114
   115	400027'	000000	400052'		TRTBL:	EXP	TRACE1,TRACE2,TRACE3,TRACE4
   116	400030'	000000	400045'
   117	400031'	000000	400042'
   118	400032'	000000	400033'
   119
   120						 ; 4TH ARGUMENT
   121
   122	400033'	265 11 0 00 000000*	TRACE4:	JSP	TLINK,CVTNAM##	; INSIST
   123	400034'	003 01 0 00 000150 		ERROR.	1,104		; ON
   124	400035'	332 00 0 01 000000 		SKIPE	0(STACK)	; NATURAL
   125	400036'	003 01 0 00 000150 		ERROR.	1,104		; VARIABLE
   126
   127	400037'	200 06 0 00 400025*		MOVE	S1,FLAP##		; STORE
   128	400040'	262 01 0 06 000011 		POP	STACK,TRFUNC+1(S1) ; INTO TRFUNC
   129	400041'	262 01 0 06 000010 		POP	STACK,TRFUNC(S1) ; FIELD OF TRBLOK
   130
   131						 ; 3RD ARGUMENT
   132
   133	400042'	200 06 0 00 400037*	TRACE3:	MOVE	S1,FLAP##	;[224] STORE
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 5-1
SNOTRC	MAC	13-Oct-66 22:17		PRIMARY FUNCTION -- TRACE

   134	400043'	262 01 0 06 000007 		POP	STACK,TRTAG+1(S1) ; INTO TRTAG
   135	400044'	262 01 0 06 000006 		POP	STACK,TRTAG(S1)	; FIELD OF TRBLOK
   136
   137						 ; HERE FROM STOPTR ENTRY
   138
   139	400045'	265 11 0 00 000000*	TRACE2:	JSP	TLINK,CVTSTR	; 2ND ARG
   140	400046'	003 01 0 00 000146 		ERROR.	1,102		; MUST BE STRING
   141
   142	400047'	550 05 0 01 000000 		HRRZ	P2,0(STACK)	; NULL STRING?
   143	400050'	326 05 0 00 400054'		JUMPN	P2,TRC2.2	; JUMP IF NOT
   144	400051'	274 01 0 00 400013*		SUB	STACK,XWD22##	; POP STACK IF SO
   145
   146						 ; HERE FROM ONE ARGUMENT CASE
   147
   148	400052'	201 07 0 00 000126 	TRACE1:	MOVEI	S2,"V"		; ASSUME VALUE
   149	400053'	254 00 0 00 400060'		JRST	TRC2.3		; JOIN PROCESSING
   150
   151						 ; HERE IF 2ND ARG WAS NONNULL
   152
   153	400054'	265 15 0 00 000000*	TRC2.2:	JSP	QLINK,CVTPTR##	; GET
   154	400055'	000000	000000			0
   155	400056'	001 17 0 00 000000 		ERROR	15		; FIRST
   156	400057'	134 07 0 00 000000 		ILDB	S2,Z		; CHARACTER
   157
   158	400060'	265 11 0 00 400033*	TRC2.3:	JSP	TLINK,CVTNAM	; INSIST THAT FIRST
   159	400061'	003 01 0 00 000145 		ERROR.	1,101		; ARG. BE NAME
   160
   161	400062'	200 06 0 00 400042*		MOVE	S1,FLAP##		; ADDR OF TRBLOK
   162	400063'	336 00 0 00 000000#		SKIPN	IGNOP##+3		; TRACE?
   163	400064'	201 06 0 00 000000#		MOVEI	S1,FLAP##+2-TRNAME ; NO, PUT IT IN FLAP##+2
   164
   165	400065'	262 01 0 06 000005 		POP	STACK,TRNAME+1(S1) ; NAME
   166	400066'	262 01 0 06 000004 		POP	STACK,TRNAME(S1) ; INTO TRBLOK
   167
   168	400067'	200 05 0 01 000001 		MOVE	P2,1(STACK)	; GET ADDRESS
   169	400070'	270 05 0 01 000002 		ADD	P2,2(STACK)	; OF VARIABLE
   170
   171	400071'	306 07 0 00 000126 		CAIN	S2,"V"		; VALUE TRACING?
   172	400072'	254 00 0 00 400075'		JRST	TRC2.4		; YES, GO ON
   173	400073'	332 00 0 01 000002 		SKIPE	2(STACK)	; NATURAL VARIABLE?
   174	400074'	001 15 0 00 000065 		ERROR	13,53		; NO - COMPLAIN
   175						 ; 
   176						 ; HERE TO TABLE OFF TO CORRECT ROUTINE
   177
   178	400075'	306 07 0 00 000126 	TRC2.4:	CAIN	S2,"V"
   179	400076'	254 00 0 00 400264'		JRST	TRCVAL
   180	400077'	306 07 0 00 000106 		CAIN	S2,"F"
   181	400100'	254 00 0 00 400421'		JRST	TRCFUN
   182	400101'	306 07 0 00 000114 		CAIN	S2,"L"
   183	400102'	254 00 0 00 400621'		JRST	TRCLAB
   184	400103'	306 07 0 00 000113 		CAIN	S2,"K"
   185	400104'	254 00 0 00 400670'		JRST	TRCKEY
   186	400105'	306 07 0 00 000122 		CAIN	S2,"R"
   187	400106'	254 00 0 00 400423'		JRST	TRCRET
   188	400107'	306 07 0 00 000103 		CAIN	S2,"C"
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 5-2
SNOTRC	MAC	13-Oct-66 22:17		PRIMARY FUNCTION -- TRACE

   189	400110'	254 00 0 00 400424'		JRST	TRCCAL
   190	400111'	001 15 0 00 000074 		ERROR	13,60
   191
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 6
SNOTRC	MAC	13-Oct-66 22:17		PRIMARY FUNCTION -- TRACE

   192
   193						SUBTTL	COMMON SUBROUTINES
   194
   195						 ;------------------------------------------------------
   196						 ; BARS - (BAR TENDER)
   197						 ; CALLING SEQUENCE:
   198						 ;	JSP	SLINK,BARS
   199						 ;	RETURN
   200
   201	400112'	261 01 0 00 000000*	BARS:	PUSH	STACK,SYSTR##	; PUSH
   202	400113'	261 01 0 00 000000*		PUSH	STACK,S.BAR##	; ONE BAR
   203	400114'	200 00 0 00 000000*		MOVE	Z,$FNCLV##	; REQUEST FOR &FNCLEVEL OF THESE
   204	400115'	270 00 0 00 000000*		ADD	Z,BARINC##	; ADD ANY INCREMENT
   205	400116'	402 00 0 00 400115*		CLEARM	BARINC		; ERASE THE INCREMENT
   206	400117'	335 00 0 00 000000 		SKIPGE	Z		; BEWARE OF NEGATIVES.
   207	400120'	001 17 0 00 000000 		ERROR	15		; SIGNAL ERROR
   208	400121'	265 11 0 00 000000*		JSP	TLINK,DUPLI##	; DUPLICATION
   209	400122'	255 00 0 00 000000 		JFCL			; CAN'T ERR
   210	400123'	254 00 0 06 000000 		JRST	0(SLINK)	; RETURN
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 7
SNOTRC	MAC	13-Oct-66 22:17		COMMON SUBROUTINES

   211
   212						 ;------------------------------------------------------
   213						 ; IMAGE - A ROUTINE TO COMPUTE THE
   214						 ; PRINTABLE IMAGE OF A DESCRIPTOR.
   215						 ; CALLING SEQUENCE:
   216						 ; 	LOAD Q2 WITH ADDRESS OF DESCRIPTOR
   217						 ;	JSP	SLINK,IMAGE
   218						 ;	RETURN
   219
   220	400124'	265 15 0 00 000000*	IMAGE::	JSP	QLINK,LOCVAL##	; POINT TO VALUE
   221
   222	400125'	554 15 0 16 000000 		HLRZ	Q1,0(Q2)	; GET DT
   223	400126'	261 01 0 16 000000 		PUSH	STACK,0(Q2)	; PUSH VALUE
   224	400127'	261 01 0 16 000001 		PUSH	STACK,1(Q2)	; ONTO STACK
   225	400130'	202 06 0 00 000000*		MOVEM	SLINK,LNCLSV##	; SAVE RETURN
   226
   227	400131'	306 15 0 00 004005 		CAIN	Q1,ADT		; IS IT AN ARRAY
   228	400132'	254 00 0 00 400152'		JRST	IMAG.A		; PROCESS ARRAY
   229	400133'	306 15 0 00 004003 		CAIN	Q1,SDT		; IS IT A STRING
   230	400134'	254 00 0 00 400144'		JRST	IMAG.S		; PROCESS STRING
   231	400135'	306 15 0 00 004012 		CAIN	Q1,DDT		; IS IT DEFINED?
   232	400136'	254 00 0 00 400172'		JRST	IMAG.D		; PROCESS DEFINE TYPE
   233	400137'	306 15 0 00 004010 		CAIN	Q1,TDT		; TABLE?
   234	400140'	254 00 0 00 400205'		JRST	IMAG.T		; YES
   235
   236	400141'	265 11 0 00 400045*		JSP	TLINK,CVTSTR	; TRY CONVERTING TO STRING
   237	400142'	265 15 0 00 000000*		JSP	QLINK,DTNAME##	; FAIL, THEN USE DT
   238	400143'	254 00 0 06 000000 		JRST	0(SLINK)	; AND RETURN.
   239	400144'	265 06 0 00 000000*	IMAG.S:	JSP	SLINK,LINE.##	; SANDWICH
   240	400145'	000000	000003			XWD	0,3		; THE
   241	400146'	004003	401304'			XWD	SDT,["'",,1]	; STRING
   242	400147'	000001	000001			XWD	STACK,1		; BETWEEN
   243	400150'	004003	401304'			XWD	SDT,["'",,1]	; QUOTES
   244
   245	400151'	254 00 1 00 400130*		JRST	@LNCLSV		; AND RETURN
   246
   247	400152'	200 10 0 01 777777 	IMAG.A:	MOVE	S3,-1(STACK)	; GET ADDR OF ABLOK
   248	400153'	265 15 0 00 400142*		JSP	QLINK,DTNAME	; CONVERT TO NAME (ARRAY)
   249
   250	400154'	261 01 0 10 000002 		PUSH	STACK,APROTO(S3) ; PUSH PROTOTYPE
   251	400155'	261 01 0 10 000003 		PUSH	STACK,APROTO+1(S3) ; ONTO STACK
   252
   253	400156'	554 11 0 10 000004 		HLRZ	T1,AHASH(S3)	; RETRIEVE ID #
   254	400157'	261 01 0 00 401305'	IMA.A1:	PUSH	STACK,[IDT,,0]	; AND PUSH IT
   255	400160'	261 01 0 00 000011 		PUSH	STACK,T1	; ONTO STACK
   256
   257	400161'	265 06 0 00 400144*		JSP	SLINK,LINE.	; LET LINE. COMPOSE THE IMAGE
   258	400162'	000000	000006			XWD	0,6		; 6 ARGUMENTS
   259	400163'	000001	000003			XWD	STACK,3		; ARRAY
   260	400164'	004003	401306'			XWD	SDT,["(",,1]	;  (
   261	400165'	000001	000002			XWD	STACK,2		;  PROTOTYPE
   262	400166'	004003	401307'			XWD	SDT,[")",,1]	;         )
   263	400167'	004003	000000*			XWD	SDT,S.NO##	;   #
   264	400170'	000001	000001			XWD	STACK,1		;  ID #
   265
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 7-1
SNOTRC	MAC	13-Oct-66 22:17		COMMON SUBROUTINES

   266	400171'	254 00 1 00 400151*		JRST	@LNCLSV		; AND RETURN
   267
   268						 ; HERE FOR DEFINED DATATYPES
   269
   270	400172'	200 10 0 01 777777 	IMAG.D:	MOVE	S3,-1(STACK)	; ADDR OF DBLOK
   271	400173'	265 15 0 00 400153*		JSP	QLINK,DTNAME	; FIND ITS NAME
   272	400174'	554 11 0 10 000002 		HLRZ	T1,DHASH(S3)	; GET ITS ID #
   273
   274	400175'	261 01 0 00 401305'	IMA.D1:	PUSH	STACK,[IDT,,0]	; AND PUSH IT
   275	400176'	261 01 0 00 000011 		PUSH	STACK,T1	; ONTO THE STACK
   276
   277	400177'	265 06 0 00 400161*		JSP	SLINK,LINE.	; COMPOSE A STRING
   278	400200'	000000	000003			XWD	0,3		; 3 ARGUMENTS
   279	400201'	000001	000002			XWD	STACK,2		;  DT NAME
   280	400202'	004003	400167*			XWD	SDT,S.NO	;     #
   281	400203'	000001	000001			XWD	STACK,1		;   <ID #>
   282
   283	400204'	254 00 1 00 400171*		JRST	@LNCLSV		; AND RETURN
   284
   285						 ; HERE FOR TABLES
   286
   287	400205'	200 10 0 01 777777 	IMAG.T:	MOVE	S3,-1(STACK)	; SAVE ADDR OF TBLOK
   288	400206'	265 15 0 00 400173*		JSP	QLINK,DTNAME	; GET NAME
   289	400207'	554 11 0 10 000002 		HLRZ	T1,THASH(S3)	; AND ITS HASH NO
   290	400210'	261 01 0 00 401305'		PUSH	STACK,[IDT,,0]	; GET
   291	400211'	550 12 0 10 000002 		HRRZ	T2,TNBUCK(S3)	; PROTO-
   292	400212'	261 01 0 00 000012 		PUSH	STACK,T2	; TYPE
   293	400213'	254 00 0 00 400157'		JRST	IMA.A1		; JOIN ARRAY PROCESSING
   294
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 8
SNOTRC	MAC	13-Oct-66 22:17		COMMON SUBROUTINES

   295
   296						 ;------------------------------------------------------
   297						 ; TIMECL (TIME CLAUSE) PRODUCES THE MESSAGE:
   298						 ;     TIME =  <TIME>
   299
   300						 ; CALLING SEQUENCE:
   301						 ; 	JSP	SLINK,TIMECL
   302						 ;	RETURN		; STRING LEFT ON STACK
   303
   304	400214'	202 06 0 00 400204*	TIMECL:	MOVEM	SLINK,LNCLSV	; SAVE LINK
   305
   306	400215'	265 15 0 00 000000*		JSP	QLINK,MSTIME##	; GET THE TIME
   307	400216'	274 00 0 00 000000*		SUB	Z,TIME.C##	; SINCE END OF 
   308	400217'	202 00 0 00 000000*		MOVEM	Z,TR.TIM##	; COMPILATION
   309
   310	400220'	265 06 0 00 400177*		JSP	SLINK,LINE.	; PREPARE
   311	400221'	000000	000002			XWD	0,2		; THE
   312	400222'	004003	000000*			XWD	SDT,S.TIME##	; TIME
   313	400223'	002001	400217*			XWD	IDT,TR.TIM	; CLAUSE
   314
   315	400224'	254 00 1 00 400214*		JRST	@LNCLSV		; RETURN
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 9
SNOTRC	MAC	13-Oct-66 22:17		COMMON SUBROUTINES

   316
   317						 ;------------------------------------------------------
   318						 ; TRCALL (TRACE CALL) IS USED AS AN INITIAL
   319						 ; PART OF EVERY TRACE EFFORT.  SIDE EFFECTS INCLUDE
   320						 ; UPDATING &TRACE.
   321						 ; CALLING SEQUENCE:
   322						 ;	LOAD T2 WITH ADDRESS OF TRBLOK
   323						 ; 	JSP	TLINK,TRCALL
   324						 ;	NO TRACE  (&TRACE LE 0)
   325						 ; 	NO FUNC   (SIZE TRBLOK LT ^D10)
   326						 ;	FUNC CALLED
   327
   328	400225'	337 00 0 00 400004*	TRCALL::SKIPG	$TRACE##	; &TRACE ON?
   329	400226'	254 00 0 11 000000 		JRST	0(TLINK)	; NO
   330
   331	400227'	370 14 0 00 400225*		SOS	T4,$TRACE##	; DECREMENT $TRACE
   332
   333	400230'	322 12 0 11 000001 		JUMPE	T2,1(TLINK)	; ZERO MEANS NO FUNCTION
   334	400231'	550 13 0 12 000000 		HRRZ	T3,BLENG(T2)	; GET LENGTH OF BLOK
   335	400232'	307 13 0 00 000010 		CAIG	T3,TRFUNC	; FUNCTION THERE?
   336	400233'	254 00 0 11 000001 		JRST	1(TLINK)	; NO
   337
   338	400234'	402 00 0 00 400116*		CLEARM	BARINC		; WIPE OUT BAR INCREMENT
   339	400235'	402 00 0 00 400227*		CLEARM	$TRACE##	; CLEAR &TRACE
   340	400236'	265 00 0 00 000000*		PUSHR	PST		; SAVE OUR STATE
   341	400237'	000012	000004
   342	400240'	265 00 0 00 000000*		PUSHSA	MIPS		;[152] on the stack
   343	400241'	000046	000000*
   344
   345	400242'	261 01 0 12 000004 		PUSH	STACK,TRNAME(T2)	; PUSH
   346	400243'	261 01 0 12 000005 		PUSH	STACK,TRNAME+1(T2)	; NAME
   347	400244'	261 01 0 12 000006 		PUSH	STACK,TRTAG(T2)		; AND
   348	400245'	261 01 0 12 000007 		PUSH	STACK,TRTAG+1(T2)	; TAG
   349
   350	400246'	201 00 0 00 000002 		MOVEI	Z,2		; SET THE NUMBER OF ARGS
   351	400247'	200 13 0 12 000010 		MOVE	T3,TRFUNC(T2)	; GET ADDR OF VB
   352	400250'	201 15 0 13 000003 		MOVEI	Q1,VFUNC(T3)	; POINT TO VFUNC FIELD
   353	400251'	202 15 0 00 000000#		MOVEM	Q1,IGNOP##+2	; SAVE FOR &ERRPARM
   354	400252'	200 14 0 13 000003 		MOVE	T4,VFUNC(T3)	; GET ADDR OF FBLOK
   355	400253'	265 04 0 14 000003 		JSP	PLINK,FCODE(T4)	; CALL THE FUNCTION
   356	400254'	334 00 0 00 000000 		SKIPA			; FAILED, SO WH  357	400255'	274 01 0 00 400051*		SUB	STACK,XWD22##	; REMOVE RETURNED VALUE
   358
   359	400256'	265 00 0 00 000000*		POPSA	MIPS		;[152] Restore ...
   360	400257'	000046	400241*
   361	400260'	265 00 0 00 000000*		POPR	PST		; OUR STATE
   362	400261'	000011	000004
   363	400262'	202 14 0 00 400235*		MOVEM	T4,$TRACE##	; RESTORE &TRACE
   364	400263'	254 00 0 11 000002 		JRST	2(TLINK)	; AND RETURN
   365
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 10
SNOTRC	MAC	13-Oct-66 22:17		COMMON SUBROUTINES

   366
   367						SUBTTL	VALUE TRACING
   368
   369						 ; VALUE TRACING SETUP
   370
   371						 ; S1 - THE TRBLOK
   372						 ; P2 - THE VARIABLE BLOCK
   373
   374	400264'				TRCVAL:	 ; FIRST REMOVE ANY OLD VALUE TRACING
   375
   376	400264'	200 07 0 00 000005 		MOVE	S2,P2		; GET ADDRESS OF VARIABLE
   377
   378	400265'	554 10 0 07 000000 	TRCVL3:	HLRZ	S3,0(S2)	; LOAD DATATYPE
   379	400266'	302 10 0 00 034000 		CAIE	S3,TVAR		; TRAPPED?
   380	400267'	254 00 0 00 400304'		JRST	TRCVL1		; NO
   381
   382	400270'	200 10 0 07 000000 		MOVE	S3,0(S2)	; ADDR OF BLOK
   383	400271'	554 11 0 10 000000 		HLRZ	T1,BTCODE(S3)	; TYPE
   384	400272'	306 11 0 00 000425 		CAIN	T1,TRBLOK	; TRACED?
   385	400273'	254 00 0 00 400276'		JRST	TRCVL2		; YES - GO REMOVE
   386
   387	400274'	201 07 0 10 000002 		MOVEI	S2,TRVAL(S3)	; ELSE
   388	400275'	254 00 0 00 400265'		JRST	TRCVL3		; TRY NEXT DESCRIPTOR
   389
   390	400276'	541 00 0 07 000000 	TRCVL2:	HRRI	Z,0(S2)		; TRANSFER
   391	400277'	505 00 0 10 000002 		HRLI	Z,TRVAL(S3)	; OLD VALUE
   392	400300'	251 00 0 07 000001 		BLT	Z,1(S2)		; BACK
   393
   394	400301'	336 00 0 00 000000#		SKIPN	IGNOP##+3		; TRACE() ?
   395	400302'	254 00 0 00 000000*		JRST	RETNUL##	; NO, STOPTR()
   396	400303'	254 00 0 00 400306'		JRST	TRCVL4		; GO ON IF YES
   397
   398	400304'	336 00 0 00 000000#	TRCVL1:	SKIPN	IGNOP##+3		; STOPTR?
   399	400305'	254 00 0 04 000000 		JRST	0(PLINK)	; YES
   400
   401						 ; OLD VALUE TRACING IS NOW REMOVED
   402						 ; READY TO INSERT NEW TRACING
   403
   404	400306'				TRCVL4:
   405					IFN FTPAV,<
   406	400306'	200 12 0 00 000005 		MOVE	T2,P2		; Point to variable
   407	400307'	201 13 0 00 000144 		MOVEI	T3,TRLVL	; GvET DEFAULT LEVEL POSITION IN TRAP CHAIN
   408	400310'	265 11 0 00 000000*		JSP	TLINK,FNDPOS##	; FvIND THE CORRECT POSITION IN TRAP CHAIN
   409	400311'	200 05 0 00 000012 		MOVE	P2,T2		; PvUT BACK IN P2
   410					>;END OF IFN FTPAV
   411	400312'	200 15 0 05 000000 		MOVE	Q1,0(P2)	; LIFT
   412	400313'	200 16 0 05 000001 		MOVE	Q2,1(P2)	; OLD VALUE
   413	400314'	202 15 0 06 000002 		MOVEM	Q1,TRVAL(S1)	; MOVEM
   414	400315'	202 16 0 06 000003 		MOVEM	Q2,TRVAL+1(S1)	; INTO VALUE FIELD OF TRBLOK
   415
   416	400316'	505 06 0 00 034000 		HRLI	S1,TVAR		; COMPOSE
   417	400317'	201 07 0 00 400323'		MOVEI	S2,VTRC		; TVAR
   418	400320'	202 06 0 05 000000 		MOVEM	S1,0(P2)	; AND MOVE
   419	400321'	202 07 0 05 000001 		MOVEM	S2,1(P2)	; INTO OLD DESCR.
   420
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 10-1
SNOTRC	MAC	13-Oct-66 22:17		VALUE TRACING

   421	400322'	254 00 0 00 400302*		JRST	RETNUL		; AND RETURN
   422
   423
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 11
SNOTRC	MAC	13-Oct-66 22:17		VALUE TRACING

   424
   425						 ; TRAPPED VARIABLE VALUE TRACING
   426
   427	400323'	254 00 0 00 400326'	VTRC:	JRST	TVVT1		; VALUE
   428	400324'	254 00 0 00 400333'		JRST	TVVT2		; NAME
   429	400325'	254 00 0 00 400340'		JRST	TVVT3		; ASSIGNMENT
   430
   431	400326'	200 10 0 01 777777 	TVVT1:	MOVE	S3,-1(STACK)	; ADDR OF TRBLOK
   432	400327'	274 01 0 00 400255*		SUB	STACK,XWD22##	; POP STACK
   433	400330'	261 01 0 10 000002 		PUSH	STACK,TRVAL(S3)	; PUSH REAL ...
   434	400331'	261 01 0 10 000003 		PUSH	STACK,TRVAL+1(S3) ; VALUE
   435
   436	400332'	254 00 0 06 000001 		JRST	1(SLINK)	; AND RETURN
   437
   438	400333'	201 07 0 00 064000 	TVVT2:	MOVEI	S2,VAR		; CONSTRUCT
   439	400334'	506 07 0 01 777777 		HRLM	S2,-1(STACK)	; VAR
   440	400335'	201 07 0 00 000002 		MOVEI	S2,TRVAL	; OUT OF
   441	400336'	202 07 0 01 000000 		MOVEM	S2,0(STACK)	; TVAR
   442
   443	400337'	254 00 0 06 000001 		JRST	1(SLINK)	; AND RETURN
   444
   445						 ; ASSIGNING A VALUE TO A TRACED VARIABLE
   446
   447	400340'	200 11 0 01 777775 	TVVT3:	MOVE	T1,-3(STACK)	; ADDRESS OF TRBLOK
   448	400341'	505 11 0 00 064000 		HRLI	T1,VAR		; INDICATE VARIABLE
   449	400342'	261 01 0 00 000011 		PUSH	STACK,T1	; PUSH ...
   450	400343'	201 12 0 00 000002 		MOVEI	T2,TRVAL	; VARIABLE
   451	400344'	261 01 0 00 000012 		PUSH	STACK,T2	; ONTO STACK
   452
   453	400345'	261 01 0 01 777775 		PUSH	STACK,-3(STACK)	; REPRODUCE 
   454	400346'	261 01 0 01 777775 		PUSH	STACK,-3(STACK)	; VALUE
   455	400347'	265 11 0 00 000000*		JSP	TLINK,ASGNVL##	; MAKE ASSIGNMENT
   456					IFE FTPAV,<
   457						ERROR	15		; CAN'T FAIL
   458					>
   459					IFN FTPAV,<
   460						JRST	[SUB	STACK,XWD44##	;FAILED -- CLEAN UP STACK
   461	400350'	254 00 0 00 401310'			JRST	(SLINK)]	;[225] AND RETURN FAILURE
   462					>
   463	400351'	274 01 0 00 400327*		SUB	STACK,XWD22##	; POP OFF VARIABLE
   464
   465						 ; HERE TO DO ACTUAL TRACING
   466
   467	400352'	550 12 0 01 777775 		HRRZ	T2,-3(STACK)	; CALL THE ...
   468	400353'	265 11 0 00 400225'		JSP	TLINK,TRCALL	; PD TRACE FUNCTION
   469	400354'	334 00 0 00 000000 		SKIPA			; &TRACE = 0
   470	400355'	254 00 0 00 400360'		JRST	VTRC1		; NO SUPPLIED
   471
   472	400356'	274 01 0 00 400351*		SUB	STACK,XWD22##	; REMOVE VALUE
   473	400357'	254 00 0 06 000001 		JRST	1(SLINK)	; GIVE NORMAL RETURN
   474
   475						 ; HERE TO SUPPLY CANNED MESSAGE
   476
   477	400360'	271 06 0 00 000001 	VTRC1:	ADDI	SLINK,1		; PREPARE FOR INDIRECT
   478	400361'	202 06 0 00 000000*		MOVEM	SLINK,SLKSAV##	; SAVE  LINK
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 11-1
SNOTRC	MAC	13-Oct-66 22:17		VALUE TRACING

   479
   480	400362'	550 07 0 01 777775 		HRRZ	S2,-3(STACK)	; ADDR OF TRBLOK
   481	400363'	201 11 0 07 000004 		MOVEI	T1,TRNAME(S2)	; POINT TO NAME
   482	400364'	336 00 0 07 000005 		SKIPN	TRNAME+1(S2)	; NATURAL VARIABLE?
   483	400365'	254 00 0 00 400377'		JRST	VTRC2		; YES
   484
   485	400366'	200 11 0 00 400011*		MOVE	T1,NULLST	;[224] Asume null string (tag)
   486	400367'	550 10 0 07 000000 		HRRZ	S3,BLENG(S2)	;[224] Is there ...
   487	400370'	307 10 0 00 000006 		CAIG	S3,TRTAG	;[224]  a tag ?
   488	400371'	254 00 0 00 400377'		 JRST	VTRC2		;[224] No
   489
   490	400372'	261 01 0 07 000006 		PUSH	STACK,TRTAG(S2)	;[224] Yes - Store it
   491	400373'	261 01 0 07 000007 		PUSH	STACK,TRTAG+1(S2) ;[224] onto the stack
   492	400374'	265 11 0 00 400141*		JSP	TLINK,CVTSTR##	;[224] Convert to a string
   493	400375'	265 15 0 00 400206*		 JSP	QLINK,DTNAME##	;[224] Don't convert, use the datatype
   494	400376'	254 00 0 00 400401'		JRST	VTRC4		;[244] Continue
   495
   496	400377'	261 01 0 11 000000 	VTRC2:	PUSH	STACK,0(T1)	; PUSH ID WHATEVER
   497	400400'	261 01 0 11 000001 		PUSH	STACK,1(T1)	; IT IS.
   498
   499						 ; MERGE HERE FROM KEYWORD CASE
   500
   501	400401'	201 16 0 01 777775 	VTRC4:	MOVEI	Q2,-3(STACK)	; GET IMAGE OF
   502	400402'	265 06 0 00 400124'		JSP	SLINK,IMAGE	; VALUE STILL ON STACK
   503
   504	400403'	265 06 0 00 400214'		JSP	SLINK,TIMECL	; TIME CLAUSE
   505	400404'	265 06 0 00 400112'		JSP	SLINK,BARS	; PREFIX
   506
   507	400405'	265 06 0 00 000000*		JSP	SLINK,LINE##	; PUT OUT MESSAGE
   508	400406'	000000*	000010			XWD	TRFL,8		; 8 ARGUMENTS
   509	400407'	000001	000001			XWD	STACK,1		;   ! ! !
   510	400410'	004003	000000*			XWD	SDT,S.STMT##	; IN STATEMENT
   511	400411'	002007	000000*			XWD	IDT+6,$STNO##	;  <&STNO>
   512	400412'	004003	000000*			XWD	SDT,S.CLT##	;     :
   513	400413'	000001	000004			XWD	STACK,4		;  <VARIABLE>
   514	400414'	004003	000000*			XWD	SDT,S.EQL##	;      =
   515	400415'	000001	000003			XWD	STACK,3		;   <VALUE>
   516	400416'	000001	000002			XWD	STACK,2		;  , TIME = <TIME>
   517
   518	400417'	274 01 0 00 400356*		SUB	STACK,XWD22##	; WIPE AWAY ORIGNAL VALUE
   519	400420'	254 00 1 00 400361*		JRST	@SLKSAV		; AND RETURN
   520
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 12
SNOTRC	MAC	13-Oct-66 22:17		FUNCTION TRACING

   521						SUBTTL	FUNCTION TRACING
   522
   523						 ; FUNCTON TRACING SETUP
   524
   525	400421'	205 07 0 00 140000 	TRCFUN:	MOVSI	S2,VRTFL!VCTFL
   526	400422'	254 00 0 00 400425'		JRST	TRFUN1		; JOIN COMMON PROCESSNG
   527
   528	400423'	334 07 0 00 401312'	TRCRET:	SKIPA	S2,[VRTFL,,0]	; LOAD RETURN FLAG
   529	
   530	400424'	205 07 0 00 100000 	TRCCAL:	MOVSI	S2,VCTFL	; LOAD CALL TRACE FLAG
   531
   532						 ; ALL MEET HERE
   533
   534	400425'	332 00 0 00 000000#	TRFUN1:	SKIPE	IGNOP##+3		; TRACE() ?
   535	400426'	254 00 0 00 400433'		JRST	TRCFN1		; YES
   536
   537	400427'	616 07 0 05 000006 		TDNN	S2,VFLAGS(P2)	; WAS?
   538	400430'	254 00 0 04 000000 		JRST	0(PLINK)	; NO
   539	400431'	412 07 0 05 000006 		ANDCAM	S2,VFLAGS(P2)	; REST
   540	400432'	254 00 0 00 400322*		JRST	RETNUL##	; AND RETURN
   541
   542						 ; HERE TO IMPLEMENT THE TRACE PART 
   543
   544	400433'	550 12 0 05 000003 	TRCFN1:	HRRZ	T2,VFUNC(P2)	; DO WE
   545	400434'	554 13 0 12 000000 		HLRZ	T3,BTCODE(T2)	; ALREADY HAVE
   546	400435'	306 13 0 00 000424 		CAIN	T3,TFBLOK	; A TFBLOK
   547	400436'	254 00 0 00 400454'		JRST	TRCFN2		; YES
   548
   549	400437'	200 00 0 00 401313'		MOVE	Z,[TFBLOK,,8]	; ALLOCATE
   550	400440'	265 15 0 00 400022*		JSP	QLINK,BLOK	; A TFBLOK
   551	400441'	001 06 0 00 000001 		ERROR	6,1		; OR OVERFLOW
   552	400442'	262 01 0 00 000000 		POP	STACK,Z		; JUNK
   553	400443'	262 01 0 00 000012 		POP	STACK,T2	; ADDRESS OF
   554
   555	400444'	550 11 0 05 000003 		HRRZ	T1,VFUNC(P2)	; RETRIEVE FBLOK
   556	400445'	542 12 0 05 000003 		HRRM	T2,VFUNC(P2)	; INSERT TFBLOK
   557	400446'	542 11 0 12 000004 		HRRM	T1,TFOLD(T2)	; INSERT FBLOK ADDRESS
   558	400447'	200 00 0 11 000002 		MOVE	Z,FFLAGS&FNARGS(T1) ; TRANSFER 
   559	400450'	202 00 0 12 000002 		MOVEM	Z,FFLAGS&FNARGS(T2) ; GOODIES
   560
   561	400451'	200 00 0 00 401314'		move	z,[jsp p2,trcfn4##] ;[251] get the instruction
   562	400452'	202 00 0 12 000003 		MOVEM	Z,FCODE(T2)	; INSERT TO SIMULATE OTHER
   563
   564	400453'	542 05 0 12 000007 		HRRM	P2,TFVB(T2)	; ALSO INSERT VB ADDR
   565
   566	400454'	436 07 0 05 000006 	TRCFN2:	IORM	S2,VFLAGS(P2)	; SET FLAGS
   567
   568	400455'	200 06 0 00 400062*		MOVE	S1,FLAP##		; DO WE
   569	400456'	550 15 0 06 000000 		HRRZ	Q1,BLENG(S1)	; HAVE A FUNCTION
   570	400457'	307 15 0 00 000010 		CAIG	Q1,TRFUNC	; TO SPECIFY?
   571	400460'	254 00 0 00 400432*		JRST	RETNUL		; NO, JUST RETURN
   572
   573	400461'	603 07 0 00 100000 		TLNE	S2,VCTFL	; CALL?
   574	400462'	542 06 0 12 000006 		HRRM	S1,TFCT(T2)	; YES, SET TRBLOK
   575	400463'	603 07 0 00 040000 		TLNE	S2,VRTFL	; RETURN?
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 12-1
SNOTRC	MAC	13-Oct-66 22:17		FUNCTION TRACING

   576	400464'	542 06 0 12 000005 		HRRM	S1,TFRT(T2)	; YES, SET TRBLOK
   577
   578	400465'	254 00 0 00 400460*		JRST	RETNUL		; NOW RETURN
   579
   580
   581
   582	400466'	200 05 0 05 000000 	trcfn3::move	p2,tfold-fcode-1(p2) ;[251] get address of the block
   583	400467'	254 00 0 05 000003 		JRST	FCODE(P2)	;[251] Spring off to the code
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 13
SNOTRC	MAC	13-Oct-66 22:17		FUNCTION TRACING

   584
   585						 ; CLMESS - WILL PRINT A CALL MESSAGE
   586						 ; CALLING SEQUENCE
   587						 ; 	LOAD Z WTH # OF ARGUMENTS
   588						 ;	PUSH Z ARGUMENTS ONTO STACK
   589						 ;	PUSH NAME OF FUNCTON ONTO STACK
   590						 ;	JSP  SLINK,CLMESS
   591						 ;	RETURN
   592
   593						 ; ON RETURN Z HAS NOT BEEN CHANGED AND THE STACK
   594						 ; IS POPPED ONE DESCRIPTOR
   595
   596	400470'	262 01 0 00 000000#	CLMESS::POP	STACK,FLAS##+1	; SAVE
   597	400471'	262 01 0 00 000000*		POP	STACK,FLAS##	; FUNCTION NAME
   598	400472'	200 10 0 00 000001 		MOVE	S3,STACK	; SAVE STACK POSITION
   599	400473'	202 00 0 00 000007 		MOVEM	Z,S2		; SAVE # OF ARGS
   600	400474'	265 00 0 00 400236*		PUSHR	PS		; SAVE REGS.
   601	400475'	000006	000004
   602	400476'	261 01 0 00 400471*		PUSH	STACK,FLAS##	; PUSH FUNCTION 
   603	400477'	261 01 0 00 000000#		PUSH	STACK,FLAS##+1	; NAME
   604
   605						 ; PREPARE ARGUMENT LIST
   606
   607	400500'	261 01 0 00 000000*		PUSH	STACK,$ALPHA##	; PUSH
   608	400501'	261 01 0 00 401306'		PUSH	STACK,["(",,1]	; "(" ONTO STACK
   609
   610	400502'	200 04 0 00 000007 		MOVE	P1,S2		; # OF ARGUMENTS
   611	400503'	201 05 0 10 000001 		MOVEI	P2,1(S3)	; POINT TO JUST BEYOND LAST ARG
   612	400504'	274 05 0 00 000007 		SUB	P2,S2		; POINT TO ...
   613	400505'	274 05 0 00 000007 		SUB	P2,S2		; FIRST ARG
   614	400506'	322 04 0 00 400521'		JUMPE	P1,CLMES1	; JUMP IF NO ARGS
   615
   616						 ; LOOP FOR PROCESSING ARGUMENTS
   617
   618	400507'	200 16 0 00 000005 	CLMES2:	MOVE	Q2,P2		; POINT TO DESCRIPTOR
   619	400510'	265 06 0 00 400124'		JSP	SLINK,IMAGE	; GET ITS IMAGE
   620
   621	400511'	363 04 0 00 400523'		SOJLE	P1,CLMES3	; JUMP IF THIS IS THE LAST
   622
   623	400512'	265 06 0 00 400220*		JSP	SLINK,LINE.	; COMBINE ...
   624	400513'	000000	000003			XWD	0,3		; WITH ...
   625	400514'	000001	000002			XWD	STACK,2		; REST ...
   626	400515'	000001	000001			XWD	STACK,1		; OF ARGS AND
   627	400516'	004003	401315'			XWD	SDT,[",",,1]	; END WITH COMMA
   628
   629	400517'	271 05 0 00 000002 		ADDI	P2,2		; POINT TO NEXT ARG
   630	400520'	254 00 0 00 400507'		JRST	CLMES2		; AND LOOP BACK
   631
   632						 ; HERE IF NO ARGS
   633
   634	400521'	261 01 0 00 400366*	CLMES1:	PUSH	STACK,NULLST	; PUSH NULL ...
   635	400522'	261 01 0 00 000000#		PUSH	STACK,NULLST+1	; STRING
   636
   637						 ; HERE UPON COMPLETION OF ARG LIST
   638
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 13-1
SNOTRC	MAC	13-Oct-66 22:17		FUNCTION TRACING

   639	400523'	265 06 0 00 400512*	CLMES3:	JSP	SLINK,LINE.	; JOIN
   640	400524'	000000	000003			XWD	0,3		; TGETHER
   641	400525'	000001	000002			XWD	STACK,2		; EARLY ARGS
   642	400526'	000001	000001			XWD	STACK,1		; LAST ARG
   643	400527'	004003	401307'			XWD	SDT,[")",,1]	; TERMINAL ")"
   644
   645	400530'	265 06 0 00 400112'		JSP	SLINK,BARS	; MAKE BARS
   646
   647	400531'	335 00 0 00 000000*		SKIPGE	$FTRC##		; &FTRACE NEGATIVE?
   648	400532'	254 00 0 00 400547'		JRST	CLMES4		; YES, GO GIVE SHORT MESSAGE
   649
   650	400533'	265 06 0 00 400214'		JSP	SLINK,TIMECL	; TIME CLAUSE
   651
   652						 ; MAIN MESSAGE
   653
   654	400534'	265 06 0 00 400405*		JSP	SLINK,LINE
   655	400535'	000000*	000010			XWD	TRFL,8		; 8 ARGS
   656	400536'	000001	000002			XWD	STACK,2		; PREFIX
   657	400537'	000001	000004			XWD	STACK,4		; FUNCTION NAME
   658	400540'	000001	000003			XWD	STACK,3		; ARGUMENT LIST
   659	400541'	004003	000000*			XWD	SDT,S.CLST##	; CALLED IN STMT
   660	400542'	002001	400411*			XWD	IDT,$STNO##	;   <STNO>
   661	400543'	004003	000000*			XWD	SDT,S.LEV##	; AT LEVEL
   662	400544'	002001	400114*			XWD	IDT,$FNCLV	; <LEVEL #>
   663	400545'	000001	000001			XWD	STACK,1		; TME
   664
   665	400546'	254 00 0 00 400554'		JRST	CLMES5		; WRAP UP
   666
   667						 ; HERE TO GIVE ABBREVIATED MESSAGE
   668
   669	400547'	265 06 0 00 400534*	CLMES4:	JSP	SLINK,LINE
   670	400550'	000000*	000003			XWD	TRFL,3
   671	400551'	000001	000001			XWD	STACK,1		; BARS
   672	400552'	000001	000003			XWD	STACK,3		; FUNCTION NAME
   673	400553'	000001	000002			XWD	STACK,2		; ARGUMENT LIST
   674
   675	400554'	265 00 0 00 400260*	CLMES5:	POPR	PS		; RESTORE
   676	400555'	000005	000004
   677	400556'	200 00 0 00 000007 		MOVE	Z,S2		; CONDITONS
   678	400557'	254 00 0 06 000000 		JRST	0(SLINK)	; AND RETURN
   679
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 14
SNOTRC	MAC	13-Oct-66 22:17		FUNCTION TRACING

   680
   681
   682						 ; RTMESS - RETURN MESSAGE
   683						 ; CALLING SEQUENCE:
   684						 ;	LOAD S2 WITH ADDRESS OF DESCR. OR 0
   685						 ; 	PUSH	NAME OF FUNCTION
   686						 ;	JSP	SLINK,RTMESS
   687						 ;	RETURN
   688
   689	400560'	202 06 0 00 400420*	RTMESS::MOVEM	SLINK,SLKSAV	; SAVE RETURN
   690	400561'	322 07 0 00 400565'		JUMPE	S2,RTMS1	; RETURN VALUE?
   691
   692	400562'	200 16 0 00 000007 		MOVE	Q2,S2		; LOAD ARGUMENT FOR IMAGE
   693	400563'	265 06 0 00 400124'		JSP	SLINK,IMAGE	; CREATE THE IMAGE
   694	400564'	254 00 0 00 400567'		JRST	RTMS2		; JOIN COMMON PROCESSING
   695
   696						 ; NO RETURN VALUE
   697
   698	400565'	261 01 0 00 400521*	RTMS1:	PUSH	STACK,NULLST	; THROW A 
   699	400566'	261 01 0 00 000000#		PUSH	STACK,NULLST+1	; NULL STRING ONTO THE STACK
   700
   701	400567'	265 06 0 00 400112'	RTMS2:	JSP	SLINK,BARS	; MAKE BARS
   702	400570'	261 01 0 00 400112*		PUSH	STACK,SYSTR	; PUSH  
   703	400571'	200 11 0 00 000000*		MOVE	T1,$RTNTP##	; THE
   704	400572'	261 01 0 11 000000 		PUSH	STACK,0(T1)	; &RTNTYPE
   705
   706	400573'	265 06 0 00 400523*		JSP	SLINK,LINE.	; PUT OUT MESSAGE
   707	400574'	000000*	000006			XWD	TRFL,6		; (6 ARGUMENTS)
   708	400575'	000001	000002			XWD	STACK,2		;  ! ! !
   709	400576'	000001	000004			XWD	STACK,4		;  <FNAME>
   710	400577'	004003	401316'			XWD	SDT,[" ",,1]	;
   711	400600'	000001	000001			XWD	STACK,1		;  RETURN
   712	400601'	004003	000000*			XWD	SDT,S.ED##	;    'ED
   713	400602'	000001	000003			XWD	STACK,3		;  <VALUE>
   714
   715	400603'	331 00 0 00 400531*		SKIPL	$FTRC##		; SHORT OR LONG?
   716	400604'	254 00 0 00 400611'		JRST	RTMS3		; GO GIVE LONG IF POSITIVE
   717
   718	400605'	265 06 0 00 400547*		JSP	SLINK,LINE	; PUT
   719	400606'	000000*	000001			XWD	TRFL,1		; OUT SHORT
   720	400607'	000001	000001			XWD	STACK,1		; MESSAGE
   721
   722	400610'	254 00 1 00 400560*		JRST	@SLKSAV		; AND RETURN
   723
   724	400611'	265 06 0 00 400214'	RTMS3:	JSP	SLINK,TIMECL	; MAKE TIME CLAUSE
   725
   726	400612'	265 06 0 00 400605*		JSP	SLINK,LINE	; MAKE LONG
   727	400613'	000000*	000004			XWD	TRFL,4		; MESSAGE
   728	400614'	000001	000002			XWD	STACK,2		; ORIGNAL SHORT MESSAGE
   729	400615'	004003	400410*			XWD	SDT,S.STMT	; IN STMT
   730	400616'	002001	400542*			XWD	IDT,$STNO	;  <STNO>
   731	400617'	000001	000001			XWD	STACK,1		;  TIME = ..
   732
   733	400620'	254 00 1 00 400610*		JRST	@SLKSAV		; AND RETURN
   734
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 15
SNOTRC	MAC	13-Oct-66 22:17		FUNCTION TRACING

   735
   736						SUBTTL	LABEL TRACING
   737
   738						 ; HERE FOR LABEL TRACING SETUP
   739						 ; (S1 = TRBLOK, P2 = VB)
   740
   741	400621'	205 14 0 00 200000 	TRCLAB:	MOVSI	T4,LTFLAG	; POISE FLAG IN PLACE
   742	400622'	616 14 0 05 000006 		TDNN	T4,VFLAGS(P2)	; ALREADY TRACED?
   743	400623'	254 00 0 00 400633'		JRST	TRCLB1		; NO
   744
   745	400624'	412 14 0 05 000006 		ANDCAM	T4,VFLAGS(P2)	; ZAP OUT BIT
   746	400625'	200 12 0 05 000002 		MOVE	T2,VLABEL(P2)	; RESTORE
   747	400626'	540 13 0 12 000002 		HRR	T3,TRVAL(T2)	;[150] to 
   748	400627'	504 13 0 12 000003 		HRL	T3,TRVAL+1(T2)	;[150] non-
   749	400630'	202 13 0 05 000002 		MOVEM	T3,VLABEL(P2)	; TRACE STATUS
   750
   751	400631'	336 00 0 00 000000#		SKIPN	IGNOP##+3		; STOPTR?
   752	400632'	254 00 0 00 400465*		JRST	RETNUL		; YES
   753
   754	400633'	336 00 0 00 000000#	TRCLB1:	SKIPN	IGNOP##+3		; STOPTR?
   755	400634'	254 00 0 04 000000 		JRST	0(PLINK)	; YES, FAIL
   756
   757	400635'	436 14 0 05 000006 		IORM	T4,VFLAGS(P2)	; ESTABLISH LTFLAG
   758	400636'	200 15 0 05 000002 		MOVE	Q1,VLABEL(P2)	; LOAD THE LABEL
   759	400637'	556 15 0 06 000003 		HLRZM	Q1,TRVAL+1(S1)	; INSERT OFFSET
   760	400640'	505 15 0 00 004007 		HRLI	Q1,CDT		; INSERT ...
   761	400641'	202 15 0 06 000002 		MOVEM	Q1,TRVAL(S1)	; FIRST DESCR WORD
   762
   763	400642'	552 06 0 05 000002 		HRRZM	S1,VLABEL(P2)	; INSERT TRBLOK INTO VB
   764
   765	400643'	254 00 0 00 400632*		JRST	RETNUL		; AND RETURN
   766
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 16
SNOTRC	MAC	13-Oct-66 22:17		LABEL TRACING

   767
   768						 ; HERE TO TRACE LABEL
   769
   770						 ; CALLING SEQUENCE:
   771						 ;	LOAD S2 WITH ADDRESS OF VB
   772						 ;	JSP  SLINK,LTRC
   773						 ;	RETURN
   774
   775	400644'	550 12 0 07 000002 	LTRC::	HRRZ	T2,VLABEL(S2)	; GET ADDR OF TRBLOK
   776	400645'	265 11 0 00 400225'		JSP	TLINK,TRCALL	; CALL EXTERNAL FUNCTION
   777	400646'	334 00 0 00 000000 		SKIPA			; &TRACE WAS 0
   778	400647'	334 00 0 00 000000 		SKIPA			; NO EXTERNAL FUNCTION
   779	400650'	254 00 0 06 000000 		JRST	0(SLINK)	; JUST RETURN
   780
   781						 ; HERE TO GIVE CANNED MESSAGE
   782
   783	400651'	202 06 0 00 400620*		MOVEM	SLINK,SLKSAV	; SAVE LINK
   784
   785	400652'	261 01 0 07 000004 		PUSH	STACK,VNAME(S2)	; PUSH NAME
   786	400653'	261 01 0 07 000005 		PUSH	STACK,VNAME+1(S2) ; OF LABEL
   787
   788	400654'	265 06 0 00 400214'		JSP	SLINK,TIMECL	; TIME CLAUSE
   789	400655'	265 06 0 00 400112'		JSP	SLINK,BARS	; MAKE BARS
   790
   791	400656'	265 06 0 00 400612*		JSP	SLINK,LINE	; MAKE MESSAGE
   792	400657'	000000*	000007			XWD	TRFL,7		; FROM 7 ARGS
   793	400660'	000001	000001			XWD	STACK,1		;  ! ! !
   794	400661'	004003	400615*			XWD	SDT,S.STMT	; IN STMT
   795	400662'	002007	400616*			XWD	IDT+6,$STNO	; <&STNO>
   796	400663'	004003	400412*			XWD	SDT,S.CLT	;    :
   797	400664'	004003	000000*			XWD	SDT,S.TRAN##	; TRANSFER TO
   798	400665'	000001	000003			XWD	STACK,3		;  <LABEL>
   799	400666'	000001	000002			XWD	STACK,2		;  TIME = <TIME>
   800
   801	400667'	254 00 1 00 400651*		JRST	@SLKSAV		; AND RETURN
   802
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 17
SNOTRC	MAC	13-Oct-66 22:17		LABEL TRACING

   803
   804						SUBTTL	KEYWORD TRACING
   805
   806						 ; KEYWORD SETUP
   807
   808	400670'	554 12 0 05 000006 	TRCKEY:	HLRZ	T2,VKEY(P2)	; GET KEYW #
   809	400671'	405 12 0 00 000077 		ANDI	T2,77		; IN T2 RIGHT
   810
   811	400672'	201 13 0 12 000000*		MOVEI	T3,PROTKW##(T2)	; POINT TO CORRECT ENTRY
   812	400673'	201 10 0 00 000000*		MOVEI	S3,TB.FNC##	; PERHAPS &FNCLEVEL
   813	400674'	306 12 0 00 000007 		CAIN	T2,7		; IS IT?
   814	400675'	254 00 0 00 400711'		JRST	TRCKY1		; YES, JUMP
   815
   816	400676'	201 10 0 00 000000*		MOVEI	S3,TB.STC##	; PERHAPS &STCOUNT
   817	400677'	306 12 0 00 000013 		CAIN	T2,13		; IS IT?
   818	400700'	254 00 0 00 400711'		JRST	TRCKY1		; YES, JUMP
   819
   820	400701'	201 10 0 00 000000*		MOVEI	S3,TB.STF##	; PERHAPS &STFCOUNT
   821	400702'	306 12 0 00 000014 		CAIN	T2,14		; IS IT?
   822	400703'	254 00 0 00 400711'		JRST	TRCKY1		; YES, JUMP
   823
   824	400704'	201 13 0 12 000000#		MOVEI	T3,UPROKW##-40(T2) ; UNPROTECTED KEYWORD?
   825	400705'	201 10 0 00 000000*		MOVEI	S3,TB.ERR##	; MUST BE &ERRTYPE
   826	400706'	306 12 0 00 000044 		CAIN	T2,44		; BUT IS IT?
   827	400707'	254 00 0 00 400711'		JRST	TRCKY1		; YES, JUMP
   828
   829	400710'	001 15 0 00 000106 		ERROR	13,70		; NON-TRACEABLE
   830
   831						 ; HERE WITH S3 POINTING TO DESCRIPTOR FOR TRBLOK
   832						 ; AND WITH T3 POINTING TO KEYWORD WORD.
   833
   834	400711'	554 07 0 13 000000 	TRCKY1:	HLRZ	S2,0(T3)	; GET ADDRESS OF KEYWORD CELL
   835	400712'	336 00 0 00 000000#		SKIPN	IGNOP##+3		; STOPTR?
   836	400713'	254 00 0 00 400720'		JRST	TRCKY3		; YES, GO RETURN
   837
   838	400714'	202 10 0 07 000001 		MOVEM	S3,1(S2)	; PUT IN ADDR OF DESCRIPTOR
   839	400715'	505 06 0 00 004014 		HRLI	S1,UTDT		; MAKE DATATYPE UTILITY
   840	400716'	202 06 0 10 000000 		MOVEM	S1,0(S3)	; PLUG AS DESCRIPTOR
   841
   842	400717'	254 00 0 00 400643*		JRST	RETNUL		; RETURN NULL STRING
   843
   844						 ; HERE IF JUST STOPTR
   845
   846	400720'	336 00 0 07 000001 	TRCKY3:	SKIPN	1(S2)		; WERE WE ALREADY TRACING
   847	400721'	254 00 0 04 000000 		JRST	0(PLINK)	; NO, FAIL
   848
   849	400722'	402 00 0 07 000001 		CLEARM	1(S2)		; CLEAR FLAG
   850	400723'	402 00 0 10 000000 		CLEARM	0(S3)		; CLEAR TRBLOK
   851	400724'	254 00 0 00 400717*		JRST	RETNUL		; RETURN NULL STRIG
   852
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 18
SNOTRC	MAC	13-Oct-66 22:17		KEYWORD TRACING

   853
   854						 ; KEYWORD TRACE PROCESSING
   855						 ; CALLING SEQUENCE
   856						 ; 	JSP	SLINK,-------
   857						 ; 	RETURN
   858
   859	400725'	201 10 0 00 000000*	ETPTRC::MOVEI	S3,$ERRTP##	; &ERRTYPE
   860	400726'	254 00 0 00 400735'		JRST	KTRC
   861
   862	400727'	201 10 0 00 400544*	FNCTRC::MOVEI	S3,$FNCLV	; &FNCLEVEL
   863	400730'	254 00 0 00 400735'		JRST	KTRC
   864
   865	400731'	201 10 0 00 000000*	STCTRC::MOVEI	S3,$STCNT##	; &STCOUNT
   866	400732'	254 00 0 00 400735'		JRST	KTRC
   867
   868	400733'	201 10 0 00 000000*	STFTRC::MOVEI	S3,$STFCT##	; &STFCOUNT
   869	400734'	254 00 0 00 400735'		JRST	KTRC
   870
   871	400735'	200 12 0 10 000001 	KTRC:	MOVE	T2,1(S3)	; LOAD ADDRESS OF ...
   872	400736'	200 12 0 12 000000 		MOVE	T2,0(T2)	; TRBLOK
   873	400737'	265 11 0 00 400225'		JSP	TLINK,TRCALL	; AND TRY PD TRACE
   874	400740'	254 00 0 06 000000 		JRST	0(SLINK)	; &TRACE = 0
   875	400741'	334 00 0 00 000000 		SKIPA			; NO PD FUNCTION
   876	400742'	254 00 0 06 000000 		JRST	0(SLINK)	; FUNCTION WAS CALLED
   877
   878						 ; HERE TO SUPPLY CANNED TRACE MESSAGE
   879
   880	400743'	261 01 0 00 401305'		PUSH	STACK,[IDT,,0]	; PUSH ...
   881	400744'	261 01 0 10 000000 		PUSH	STACK,0(S3)	; VALUE OF KEYWORD
   882	400745'	202 06 0 00 400667*		MOVEM	SLINK,SLKSAV	; SAVE RETURN
   883
   884	400746'	200 12 0 10 000001 		MOVE	T2,1(S3)	; ADDRESS OF ...
   885	400747'	200 12 0 12 000000 		MOVE	T2,0(T2)	; TRBLOK TO T2
   886						JUMPE	T2,[		; JUMP IF REENTER
   887
   888						 PUSH	STACK,SYSTR	; PUSH
   889						 PUSH	STACK,S.REE##	; REENTER MESSAGE
   890						 CLEARM	$STCNT+1	; CLEAR &STCOUNT TRACE
   891	400750'	322 12 0 00 401317'		 JRST	VTRC4]		; JOIN VALUE PROCESSING
   892
   893	400751'	200 13 0 12 000004 		MOVE	T3,TRNAME(T2)	; ADDRESS OF VB TO T3
   894	400752'	261 01 0 13 000004 		PUSH	STACK,VNAME(T3)	; INSERT NAME
   895	400753'	261 01 0 13 000005 		PUSH	STACK,VNAME+1(T3) ; OF KEYWORD ON STACK
   896
   897	400754'	265 06 0 00 400573*		JSP	SLINK,LINE.	; PRODUCE
   898	400755'	000000	000002			XWD	0,2		; KEYWORD LOOKING THING
   899	400756'	004003	401323'			XWD	SDT,["&",,1]	; &
   900	400757'	000001	000001			XWD	STACK,1		; NAME
   901
   902	400760'	254 00 0 00 400401'		JRST	VTRC4		; JOIN VALUE PROCESSING
   903
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 19
SNOTRC	MAC	13-Oct-66 22:17		PRIMARY FUNCTION -- ASSIGN

   904						SUBTTL	PRIMARY FUNCTION -- ASSIGN
   905
   906
   907	400761'	265 11 0 00 000000*	ASGN::	JSP	TLINK,CVTVAL##	; ENSURE A VALUE
   908	400762'	254 00 0 00 000000*		JRST	FRET2##		; OR FAIL
   909
   910	400763'	554 00 0 01 777775 		HLRZ	Z,-3(STACK)	; IS VARIABLE ...
   911	400764'	306 00 0 00 034000 		CAIN	Z,TVAR		; TRAPPED?
   912	400765'	254 00 0 00 400771'		JRST	ASGNTR		; YES
   913
   914	400766'	265 11 0 00 400347*		JSP	TLINK,ASGNVL##	; JUST CALL ASSIGN FUNC
   915					IFE FTPAV,<
   916						ERROR	15		;CAN'T HAPPEN
   917					>
   918					IFN FTPAV,<
   919	400767'	254 00 0 04 000000 		JRST	(PLINK)		;ASSIGNMENT FAILED
   920					>
   921
   922	400770'	254 00 0 04 000001 		JRST	1(PLINK)	; AND RETURN
   923
   924	400771'	200 05 0 01 777776 	ASGNTR:	MOVE	P2,-2(STACK)	; LOAD ADDRESS
   925	400772'	265 06 0 05 000002 		JSP	SLINK,2(P2)	; AND GO CALL FUNCTION
   926					IFE FTPAV,<
   927						ERROR	15		;CAN'T HAPPEN
   928					>
   929					IFN FTPAV,<
   930	400773'	254 00 0 04 000000 		JRST	(PLINK)		;ASSIGNMENT FAILED
   931					>
   932	400774'	254 00 0 04 000001 		JRST	1(PLINK)	; RETURN NORMAL
   933
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 20
SNOTRC	MAC	13-Oct-66 22:17		PRIMARY FUNCTION -- DUMP

   934						SUBTTL	PRIMARY FUNCTION -- DUMP
   935
   936
   937	400775'	402 00 0 00 000000*	DUMP::	CLEARM	SEDIM##		; KLEAN UNDA DA RUG TWO
   938	400776'	265 15 0 00 000000*		JSP	QLINK,GCOL##	; CLEAR OUT ALL DEAD THINGY'S
   939	400777'	265 11 0 00 000000*		JSP	TLINK,CVTINT##	; ENSURE AN INTEGER
   940	401000'	254 00 0 00 401101'		JRST	DUMPAG		; NO, MUST BE SOME AGGREGATE
   941	401001'	262 01 0 00 000000*		POP	STACK,IGNOP##	; SAVE ARGUMENT
   942	401002'	262 01 0 00 000000 		POP	STACK,Z		; IGNORE DT
   943
   944	401003'	337 00 0 00 401001*		SKIPG	IGNOP##		; IGNORE DUMP?
   945	401004'	254 00 0 00 400724*		JRST	RETNUL		; YES
   946
   947	401005'	200 11 0 00 000000*		MOVE	T1,VTABLE##	; MAKE THE SYMBOL TABLE
   948	401006'	274 11 0 00 401324'		SUB	T1,[-TDT,,TBUCK]	; LOOK LIKE A TABLE
   949	401007'	261 01 0 00 000011 		PUSH	STACK,T1	; PUSH IT ...
   950	401010'	261 01 0 00 401325'		PUSH	STACK,[0]	; ONTO THE STACK
   951	401011'	200 00 0 00 401326'		MOVE	Z,[-1,,VNAME]	; AND SORT (IN REVERSE) ON ...
   952	401012'	265 05 0 00 000000*		JSP	P2,VTSORT##	; THE NAMES
   953	401013'	274 01 0 00 400417*		SUB	STACK,XWD22##	; POP TABLE
   954
   955	401014'	200 05 0 00 400476*		MOVE	P2,FLAS		; TRANSFER
   956	401015'	202 05 0 00 400455*		MOVEM	P2,FLAP##		; TABLE
   957	401016'	265 15 0 00 000000*		JSP	QLINK,NSRT1##	; AND JUNKIFY IT
   958	401017'	550 05 0 05 000002 		HRRZ	P2,TNBUCK(P2)	; LOAD COUNT OF ITEMS
   959
   960	401020'	361 05 0 00 401036'	DUMP1:	SOJL	P2,DUMP1A	; LOOP ON P2
   961	401021'	550 06 0 00 401015*		HRRZ	S1,FLAP##		; LOAD TBL ADDR
   962	401022'	271 06 0 05 000003 		ADDI	S1,TBUCK(P2)	; POINT TO BUCKET
   963	401023'	200 06 0 06 000000 		MOVE	S1,0(S1)	; LOAD ADDRESS FROM BUCKET
   964	401024'	261 01 0 06 000004 		PUSH	STACK,VNAME(S1)	; PUSH NAME ONTO ...
   965	401025'	261 01 0 06 000005 		PUSH	STACK,VNAME+1(S1)	; STACK
   966
   967	401026'	201 16 0 06 000000 		MOVEI	Q2,VALUE(S1)	; PUT ...
   968	401027'	265 06 0 00 400124'		JSP	SLINK,IMAGE	; VALUE ONTO STACK
   969
   970	401030'	265 06 0 00 400656*		JSP	SLINK,LINE	; PRINT THE LINE
   971	401031'	000000*	000003			XWD	TRFL,3
   972	401032'	000001	000002			XWD	STACK,2
   973	401033'	004003	000000*			XWD	SDT,S.TEQ##
   974	401034'	000001	000001			XWD	STACK,1
   975
   976	401035'	254 00 0 00 401020'		JRST	DUMP1		; LOOP BACK
   977
   978	401036'				DUMP1A:	 ; HERE WHEN DONE OF LOOP
   979
   980	401036'	377 00 0 00 401003*		SOSG	IGNOP##		; ORIGNAL ARG GT 1?
   981	401037'	254 00 0 00 401004*		JRST	RETNUL		; NO, JUST RETURN
   982
   983						 ; HERE TO DUMP BLOK IN FLOATING STORE
   984
   985	401040'	202 04 0 00 000000#		MOVEM	PLINK,IGNOP##+1	; SAVE LINK
   986	401041'	200 04 0 00 000000*		MOVE	P1,FLOOR##	; POINT TO FIRST BLOK
   987
   988	401042'	554 05 0 04 000000 	DUMPF:	HLRZ	P2,BTCODE(P1)	; LOAD CODE
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 20-1
SNOTRC	MAC	13-Oct-66 22:17		PRIMARY FUNCTION -- DUMP

   989	401043'	306 05 0 00 000405 		CAIN	P2,ABLOK	; ARRAY?
   990	401044'	254 00 0 00 401061'		JRST	DUMPFA		; YES, GO DUMP IT
   991	401045'	306 05 0 00 000412 		CAIN	P2,DBLOK	; DEFINED BLOK?
   992	401046'	254 00 0 00 401063'		JRST	DUMPFD		; YES, GO PROCESS IT
   993	401047'	306 05 0 00 000410 		CAIN	P2,TBLOK	; TABLE?
   994	401050'	254 00 0 00 401057'		JRST	DUMPFT		; YES
   995
   996						 ; RETURN BACK HERE AFTER DUMPING
   997
   998	401051'	550 05 0 04 000000 	DUMPF1:	HRRZ	P2,BLENG(P1)	; GET LENGTH
   999	401052'	270 04 0 00 000005 		ADD	P1,P2		; ADD TO GET TO NEXT BLOK
  1000	401053'	315 04 0 00 000002 		CAMGE	P1,SURF		; STILL BELOW SURFACE?
  1001	401054'	254 00 0 00 401042'		JRST	DUMPF		; YES, GO BACK
  1002
  1003	401055'	200 04 0 00 000000#		MOVE	PLINK,IGNOP##+1	; LOAD RETURN
  1004	401056'	254 00 0 00 401037*		JRST	RETNUL		; AND RETURN
  1005
  1006						 ; HERE IF DUMPABLE BLOK IS FOUND
  1007
  1008	401057'	505 04 0 00 004010 	DUMPFT:	HRLI	P1,TDT	; INSERT TABLE DT
  1009	401060'	334 00 0 00 000000 		SKIPA
  1010	401061'	505 04 0 00 004005 	DUMPFA:	HRLI	P1,ADT		; AN ARRAY!
  1011	401062'	334 00 0 00 000000 		SKIPA			; JOIN PROCESSING
  1012	401063'	505 04 0 00 004012 	DUMPFD:	HRLI	P1,DDT		; A DEFINED DATA OBJECT!
  1013	401064'	202 04 0 00 401021*		MOVEM	P1,FLAP##		; SAVE THIS AGGREGATE
  1014	401065'	402 00 0 00 000000#		CLEARM	FLAP##+1		; AND CLEAR OUT 2ND WORD TOO.
  1015	401066'	265 00 0 00 400240*		PUSHSA	P		; SAVE P AREA
  1016	401067'	000011	000000*
  1017
  1018	401070'	261 01 0 00 000004 		PUSH	STACK,P1	; NOW PUSH ON
  1019	401071'	261 01 0 00 401325'		PUSH	STACK,[0]	; THE AGGREGATE
  1020	401072'	265 04 0 00 400775'		JSP	PLINK,DUMP	; AND MAKE THE RECURSIVE CALL
  1021	401073'	001 17 0 00 000000 		ERROR	15		; THIS CAN'T HAPPEN
  1022	401074'	274 01 0 00 401013*		SUB	STACK,XWD22##	; IGNORE RETURNED VALUE
  1023
  1024	401075'	265 00 0 00 400256*		POPSA	P		; RESTORE OURSELVES
  1025	401076'	000011	401067*
  1026	401077'	550 04 0 00 401064*		HRRZ	P1,FLAP##		; THIS TELLS US WHERE WE WERE.
  1027	401100'	254 00 0 00 401051'		JRST	DUMPF1		; JOIN REG. PROCESSING.
  1028
  1029						 ; HERE TO DUMP A SINGLE AGGREGATE
  1030
  1031	401101'	202 04 0 00 000000#	DUMPAG:	MOVEM	P1,IGNOP##+1	; SAVE RETURN
  1032	401102'	262 01 0 00 000000#		POP	STACK,FLAP##+3	; SAVE
  1033	401103'	262 01 0 00 000000#		POP	STACK,FLAP##+2	; ARGUMENT
  1034	401104'	202 01 0 00 000000#		MOVEM	STACK,IGNOP##+3	; SAVE STACK
  1035
  1036	401105'	201 16 0 00 000000#		MOVEI	Q2,FLAP##+2	; POINT TO VALUE
  1037	401106'	265 06 0 00 400124'		JSP	SLINK,IMAGE	; GET ITS IMAGE
  1038
  1039	401107'	265 06 0 00 401030*		JSP	SLINK,LINE	; PUT OUT
  1040	401110'	000000*	000001			XWD	TRFL,1		; A BLANK
  1041	401111'	004003	401316'			XWD	SDT,[" ",,1]	; LINE
  1042
  1043	401112'	265 06 0 00 401107*		JSP	SLINK,LINE	; NOW
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 20-2
SNOTRC	MAC	13-Oct-66 22:17		PRIMARY FUNCTION -- DUMP

  1044	401113'	000000*	000001			XWD	TRFL,1		; PUT OUT ITS
  1045	401114'	000001	000001			XWD	STACK,1		; IMAGE
  1046
  1047	401115'	554 11 0 00 000000#		HLRZ	T1,FLAP##+2	; GET THE DATATYPE
  1048	401116'	306 11 0 00 004005 		CAIN	T1,ADT		; ARRAY?
  1049	401117'	254 00 0 00 401126'		JRST	DUMPA		; YES
  1050	401120'	306 11 0 00 004012 		CAIN	T1,DDT		; DEFINED?
  1051	401121'	254 00 0 00 401221'		JRST	DUMPD		; YES
  1052	401122'	306 11 0 00 004010 		CAIN	T1,TDT		; TABLE?
  1053	401123'	254 00 0 00 401247'		JRST	DUMPT		; YES
  1054	401124'	201 17 0 00 000000#	  MOVEI  Q3,FLAP##+2  ; POINT TO BADNESS
  1055	401125'	005 01 0 00 000156 		ERROR%	1,110		; BAD TYPE
  1056
  1057						 ; THE COMPLETE ARRAY DUMPER
  1058
  1059	401126'	200 05 0 00 000000#	DUMPA:	MOVE	P2,FLAP##+2	; LOAD ABLOK ADDR
  1060	401127'	550 06 0 05 000004 		HRRZ	S1,NSUBS(P2)	; GET # OF SUBSCRIPTS
  1061	401130'	202 06 0 00 000000#		MOVEM	S1,IGNOP##+2	; SAVE THIS NUMBER
  1062
  1063	401131'	271 06 0 06 000005 		ADDI	S1,SUBFAC(S1)	; COMPUTE OFFSET OF FIRST ARRAY ELEMENT
  1064	401132'	202 06 0 00 000000#		MOVEM	S1,FLAP##+3	; SAVE IN CONVENIENT SPOT
  1065
  1066						 ; LOOP TO PUSH SUBSCRIPTS ONTO STACK
  1067
  1068	401133'	200 06 0 00 000000#		MOVE	S1,IGNOP##+2	; RELOAD NUMBER OF SUBSCRS.
  1069	401134'	550 10 0 00 000000#		HRRZ	S3,FLAP##+2	; POINT TO ABLOK
  1070
  1071	401135'	574 07 0 10 000006 	DUMPA1:	HLRE	S2,SUBLBD(S3)	; GET LOWER BOUND
  1072	401136'	550 11 0 10 000006 		HRRZ	T1,SUBDIM(S3)	; GET ITS SIZE
  1073	401137'	505 11 0 00 002001 		HRLI	T1,IDT		; TYPE IS INTEGER
  1074	401140'	261 01 0 00 000011 		PUSH	STACK,T1	; PUSH TYPE
  1075	401141'	261 01 0 00 000007 		PUSH	STACK,S2	; PUSH BOUND
  1076	401142'	271 10 0 00 000002 		ADDI	S3,2		; NEXT DIMENSION
  1077	401143'	367 06 0 00 401135'		SOJG	S1,DUMPA1	; LOOP ON NUMBER OF SUBS.
  1078
  1079	401144'	261 01 0 00 400570*	DUMPA2:	PUSH	STACK,SYSTR	; PUSH
  1080	401145'	261 01 0 00 000000*		PUSH	STACK,S.BLLB##	;	 " <"
  1081	401146'	200 05 0 00 000000#		MOVE	P2,IGNOP##+2	; LOAD NUMBER OF SUBS
  1082	401147'	550 04 0 00 000000#		HRRZ	P1,IGNOP##+3	; POINT TO STACK START
  1083
  1084	401150'	271 04 0 00 000002 	DUMPA3:	ADDI	P1,2		; CRAWL UP STACK
  1085	401151'	261 01 0 00 401305'		PUSH	STACK,[IDT,,0]	; PUSH
  1086	401152'	261 01 0 04 000000 		PUSH	STACK,0(P1)	; CURRENT INTEGER
  1087	401153'	363 05 0 00 401162'		SOJLE	P2,DUMPA4	; JUMP IF THIS IS THE LAST
  1088
  1089	401154'	265 06 0 00 400754*		JSP	SLINK,LINE.	; COMBINE
  1090	401155'	000000	000003			XWD	0,3		;
  1091	401156'	000001	000002			XWD	STACK,2		; ALL PREVIOUS SUBSCRIPTS
  1092	401157'	000001	000001			XWD	STACK,1		; WITH THIS ONE
  1093	401160'	004003	401315'			XWD	SDT,[",",,1]	; AND APPEND A COMMA
  1094
  1095	401161'	254 00 0 00 401150'		JRST	DUMPA3		; BACK FOR THE NEXT ONE
  1096
  1097						 ; HERE TO COMBINE ALL AND PRINT
  1098
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 20-3
SNOTRC	MAC	13-Oct-66 22:17		PRIMARY FUNCTION -- DUMP

  1099	401162'	550 16 0 00 000000#	DUMPA4:	HRRZ	Q2,FLAP##+2	; POINT TO 
  1100	401163'	270 16 0 00 000000#		ADD	Q2,FLAP##+3	; NEXT VALUE
  1101	401164'	350 00 0 00 000000#		AOS	FLAP##+3		; AND INCREMENT
  1102	401165'	350 00 0 00 000000#		AOS	FLAP##+3		; WHILE WE'RE HER
  1103	401166'	265 06 0 00 400124'		JSP	SLINK,IMAGE	; GET THE IMAGE OF IT
  1104
  1105	401167'	265 06 0 00 401112*		JSP	SLINK,LINE	; PUT OUT DUMP
  1106	401170'	000000*	000005			XWD	TRFL,5		; 5 ARGS
  1107	401171'	000001	000003			XWD	STACK,3		; EARLY SUBSCRIPTS	
  1108	401172'	000001	000002			XWD	STACK,2		; LAST SUBSCRIPT
  1109	401173'	004003	401327'			XWD	SDT,[">",,1]	; CLOSE OFF
  1110	401174'	004003	401033*			XWD	SDT,S.TEQ	;		=
  1111	401175'	000001	000001			XWD	STACK,1		;	<VALUE>
  1112
  1113						 ; HERE TO INCREMENT SUBSCRIPTS
  1114
  1115	401176'	200 06 0 00 000000#		MOVE	S1,IGNOP##+2	; LOAD # OF SUBS
  1116	401177'	550 07 0 00 000001 		HRRZ	S2,STACK	; TOP OF STACK
  1117
  1118	401200'	350 00 0 07 000000 	DUMPA6:	AOS	0(S2)		; INCREMENT LAST SUBSCRIPT
  1119	401201'	370 11 0 07 777777 		SOS	T1,-1(S2)	; DECREMENT FROM SUBDIM
  1120	401202'	602 11 0 00 777777 		TRNE	T1,-1		; WAS THIS THE LAST?
  1121	401203'	254 00 0 00 401144'		JRST	DUMPA2		; NO, DUMP OUT NEXT.
  1122	401204'	363 06 0 00 401216'		SOJLE	S1,DUMPA9	; BRANCH IF WE'RE OUT OF SUBS.
  1123
  1124						 ; HERE TO INCREMENT TO NEXT HIGHER SUBSCRIPT
  1125
  1126	401205'	550 10 0 00 000000#		HRRZ	S3,FLAP##+2	; GET
  1127	401206'	271 10 0 06 000000 		ADDI	S3,0(S1)	; THE LOWER BOUND
  1128	401207'	271 10 0 06 000000 		ADDI	S3,0(S1)	; OF THE CURRENT
  1129	401210'	550 11 0 10 000006 		HRRZ	T1,SUBDIM(S3)	; SUBSCRIPT
  1130	401211'	574 12 0 10 000006 		HLRE	T2,SUBLBD(S3)	; AS WELL AS THE DIM.
  1131	401212'	542 11 0 07 777777 		HRRM	T1,-1(S2)	; AND RESTORE THE STACK
  1132	401213'	202 12 0 07 000000 		MOVEM	T2,0(S2)	; TO ITS ORIGNAL STATE
  1133
  1134	401214'	275 07 0 00 000002 		SUBI	S2,2		; BUMP TO NEXT SUBSCRIPT
  1135	401215'	254 00 0 00 401200'		JRST	DUMPA6		; AND LOOP FOR MORE
  1136
  1137						 ; HERE ON COMPLETION OF DUMPING
  1138
  1139	401216'	200 04 0 00 000000#	DUMPA9:	MOVE	PLINK,IGNOP##+1	; RESTORE RET. ADDR
  1140	401217'	200 01 0 00 000000#		MOVE	STACK,IGNOP##+3	; RESTORE STACK
  1141	401220'	254 00 0 00 401056*		JRST	RETNUL		; RETURN NULL STRING
  1142
  1143						 ; HERE TO DUMP OUT DEFINED DATA ITEM
  1144
  1145	401221'	402 00 0 00 000000#	DUMPD:	CLEARM	IGNOP##+2		; INDICATES WHICH ITEM
  1146
  1147	401222'	350 06 0 00 000000#	DUMPD1:	AOS	S1,IGNOP##+2	; BUMP AND LOAD
  1148	401223'	200 05 0 00 000000#		MOVE	P2,FLAP##+2	; GET ADDR OF DBLOK
  1149	401224'	550 07 0 05 000002 		HRRZ	S2,ADFBLK(P2)	; GET ADDR OF DFBLOK
  1150	401225'	550 10 0 07 000002 		HRRZ	S3,FNARGS(S2)	; GET NUMBER OF ARGS
  1151	401226'	313 06 0 00 000010 		CAMLE	S1,S3		; STILL WITHIN BLOK?
  1152	401227'	254 00 0 00 401216'		JRST	DUMPA9		; NO, RETURN
  1153
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 20-4
SNOTRC	MAC	13-Oct-66 22:17		PRIMARY FUNCTION -- DUMP

  1154	401230'	270 07 0 00 000006 		ADD	S2,S1		; GET THE ADDRESS ...
  1155	401231'	200 11 0 07 000004 		MOVE	T1,DFFLDS-1(S2) ; OF THE VB TO T1
  1156	401232'	261 01 0 11 000004 		PUSH	STACK,VNAME(T1) ; AND PUSH FIELD
  1157	401233'	261 01 0 11 000005 		PUSH	STACK,VNAME+1(T1) ; NAME
  1158
  1159	401234'	242 06 0 00 000001 		LSH	S1,1		; DOUBLE INDEX OF ITEM
  1160	401235'	271 05 0 06 000001 		ADDI	P2,DFLDS-2(S1)	; COMPUTE ADDRESS
  1161	401236'	201 16 0 05 000000 		MOVEI	Q2,0(P2)	; OF VALUE INTO Q2
  1162	401237'	265 06 0 00 400124'		JSP	SLINK,IMAGE	; AND LET IMAGE DO ITS THING
  1163
  1164	401240'	265 06 0 00 401167*		JSP	SLINK,LINE	; PUT OUT THE LINE
  1165	401241'	000000*	000004			XWD	TRFL,4		; 4 ARGUMENTS
  1166	401242'	004003	401316'			XWD	SDT,[" ",,1]	; INDENTATION
  1167	401243'	000001	000002			XWD	STACK,2		; FIELD NAME
  1168	401244'	004003	401174*			XWD	SDT,S.TEQ	;	 =
  1169	401245'	000001	000001			XWD	STACK,1		; <VALUE>
  1170
  1171	401246'	254 00 0 00 401222'		JRST	DUMPD1		; AND LOOP
  1172
  1173						 ; TABLE DUMPING
  1174
  1175	401247'	261 01 0 00 000000#	DUMPT:	PUSH	STACK,FLAP##+2	; PUSH TABLE
  1176	401250'	261 01 0 00 000000#		PUSH	STACK,FLAP##+3	; BACK ONTO STACK
  1177	401251'	265 11 0 00 000000*		JSP	TLINK,TSEQ##	; SEQUENCE THRU EVERY ELEMENT
  1178	401252'	265 15 0 00 401254'		JSP	QLINK,DUMPT1	; FOR EACH ONE CALL DUMPT1
  1179
  1180	401253'	254 00 0 00 401216'		JRST	DUMPA9		; AND THEN DO FINAL WRAP UP
  1181
  1182						 ; Q-TYPE SUBROUTINE TO PRINT OUT A TABLE ELEMENT
  1183						 ; T4 HOLDS ADDRESS OF TEBLOK
  1184
  1185	401254'	265 00 0 00 401066*	DUMPT1:	PUSHSA	ST		; ELEVATE PRIVILEGE
  1186	401255'	000022	000000*
  1187	401256'	265 00 0 00 400474*		PUSHR	STQ		; TO THAT OF TYPE S
  1188	401257'	000013	000006
  1189
  1190	401260'	261 01 0 14 000004 		PUSH	STACK,TEVAL(T4)	; PUSH THE
  1191	401261'	261 01 0 14 000005 		PUSH	STACK,TEVAL+1(T4) ; VALUE
  1192
  1193	401262'	201 16 0 14 000002 		MOVEI	Q2,TEREF(T4)	; FIND THE IMAGE OF THE 
  1194	401263'	265 06 0 00 400124'		JSP	SLINK,IMAGE	; REFERENCE DESCR
  1195
  1196	401264'	201 16 0 01 777775 		MOVEI	Q2,-3(STACK)	; FIND THE IMAGE OF THE
  1197	401265'	265 06 0 00 400124'		JSP	SLINK,IMAGE	; VALUE
  1198
  1199	401266'	265 06 0 00 401240*		JSP	SLINK,LINE	; OUTPUT THE MESSAGE
  1200	401267'	000000*	000005			XWD	TRFL,5		;
  1201	401270'	004003	401145*			XWD	SDT,S.BLLB	;	 <
  1202	401271'	000001	000002			XWD	STACK,2		;	REF
  1203	401272'	004003	401327'			XWD	SDT,[">",,1]	;	 >
  1204	401273'	004003	401244*			XWD	SDT,S.TEQ	;	 =
  1205	401274'	000001	000001			XWD	STACK,1		; VAL
  1206
  1207	401275'	274 01 0 00 401074*		SUB	STACK,XWD22##	; REMOVE OLD VAL
  1208	401276'	265 00 0 00 400554*		POPR	STQ		; RESTORE ...
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 20-5
SNOTRC	MAC	13-Oct-66 22:17		PRIMARY FUNCTION -- DUMP

  1209	401277'	000012	000006
  1210	401300'	265 00 0 00 401075*		POPSA	ST		; STATE
  1211	401301'	000022	401255*
  1212
  1213	401302'	254 00 0 15 000000 		JRST	0(QLINK)	; AND RETURN
  1214
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 21
SNOTRC	MAC	13-Oct-66 22:17		PRIMARY FUNCTION -- DUMP

  1215
  1216						END

NO ERRORS DETECTED

HI-SEG. BREAK IS 401330
PROGRAM BREAK IS 000000
CPU TIME USED 08:08.952

44P CORE USED
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page S-1
SNOTRC	MAC	13-Oct-66 22:17		SYMBOL TABLE

ABLOK		000405	sin	E1$110		000000	sin	PPR		401276'	ext	TB.STF		400701'	ext	
ADFBLK		000002	sin	E13$53		000000	sin	PPSA		401300'	ext	TBLOK		000410	sin	
ADT		004005	sin	E13$60		000000	sin	PROTKW		400672'	ext	TBUCK		000003	sin	
AHASH		000004	sin	E13$70		000000	sin	PSHR		401256'	ext	TDT		004010	sin	
APROTO		000002	sin	E15$		000000	sin	PSHSA		401254'	ext	TEREF		000002	sin	
ASGN		400761'	int	E6$1		000000	sin	Q1		000015		TEVAL		000004	sin	
ASGNTR		400771'		ERR	001000	000000		Q2		000016		TFBLOK		000424	sin	
ASGNVL		400766'	ext	ERR%	005000	000000		Q3		000017		TFCT		000006	sin	
BARINC		400234'	ext	ERR.	003000	000000		QLINK		000015		TFOLD		000004	sin	
BARS		400112'		ETPTRC		400725'	int	REGP		000004	spd	TFRT		000005	sin	
BLENG		000000	sin	FCODE		000003	sin	REGS		000006	spd	TFVB		000007	sin	
BLOK		400440'	ext	FFLAGS		000002	sin	RETNUL		401220'	ext	THASH		000002	sin	
BTCODE		000000	sin	FLAP		401077'	ext	RTMESS		400560'	int	TIME.C		400216'	ext	
CDT		004007	sin	FLAS		401014'	ext	RTMS1		400565'		TIMECL		400214'		
CLMES1		400521'		FLOOR		401041'	ext	RTMS2		400567'		TLINK		000011		
CLMES2		400507'		FNARGS		000002	sin	RTMS3		400611'		TNBUCK		000002	sin	
CLMES3		400523'		FNCTRC		400727'	int	S.BAR		400113'	ext	TR.TIM		400223'	ext	
CLMES4		400547'		FNDPOS		400310'	ext	S.BLLB		401270'	ext	TRAC.A		400006'		
CLMES5		400554'		FRET2		400762'	ext	S.CLST		400541'	ext	TRAC.B		400015'		
CLMESS		400470'	int	FTDEBU		000000	spd	S.CLT		400663'	ext	TRACE		400002'	int	
CVTINT		400777'	ext	FTPAV	777777	777777	spd	S.ED		400601'	ext	TRACE1		400052'		
CVTNAM		400060'	ext	GCOL		400776'	ext	S.EQL		400414'	ext	TRACE2		400045'		
CVTPTR		400054'	ext	IDT		002001	sin	S.LEV		400543'	ext	TRACE3		400042'		
CVTSTR		400374'	ext	IGNOP		401036'	ext	S.NO		400202'	ext	TRACE4		400033'		
CVTVAL		400761'	ext	IMA.A1		400157'		S.REE		401320'	ext	TRBLOK		000425	sin	
DBLOK		000412	sin	IMA.D1		400175'		S.STMT		400661'	ext	TRC2.2		400054'		
DDT		004012	spd	IMAG.A		400152'		S.TEQ		401273'	ext	TRC2.3		400060'		
DFFLDS		000005	sin	IMAG.D		400172'		S.TIME		400222'	ext	TRC2.4		400075'		
DFLDS		000003	sin	IMAG.S		400144'		S.TRAN		400664'	ext	TRCALL		400225'	int	
DHASH		000002	sin	IMAG.T		400205'		S1		000006		TRCASC	522450	300000	spd	
DTNAME		400375'	ext	IMAGE		400124'	int	S2		000007		TRCCAL		400424'		
DUMP		400775'	int	KTRC		400735'		S3		000010		TRCEDT		000251	spd	
DUMP1		401020'		LINE		401266'	ext	SAVEM		400257'	ext	TRCFN1		400433'		
DUMP1A		401036'		LINE.		401154'	ext	SAVEP		401076'	ext	TRCFN2		400454'		
DUMPA		401126'		LNCLSV		400224'	ext	SAVES		401301'	ext	TRCFN3		400466'	int	
DUMPA1		401135'		LOCVAL		400124'	ext	SDT		004003	sin	TRCFN4		401314'	ext	
DUMPA2		401144'		LREGP		000002	spd	SEDIM		400775'	ext	TRCFUN		400421'		
DUMPA3		401150'		LREGQ		000003	spd	SLINK		000006		TRCKEY		400670'		
DUMPA4		401162'		LREGS		000003	spd	SLKSAV		400745'	ext	TRCKY1		400711'		
DUMPA6		401200'		LREGT		000004	spd	STACK		000001		TRCKY3		400720'		
DUMPA9		401216'		LSAVEI		000010	spd	STCTRC		400731'	int	TRCLAB		400621'		
DUMPAG		401101'		LSAVEM		000014	spd	STFTRC		400733'	int	TRCLB1		400633'		
DUMPD		401221'		LSAVEP		000011	spd	STOPTR		400000'	int	TRCMIN		000000	spd	
DUMPD1		401222'		LSAVES		000011	spd	SUBDIM		000006	sin	TRCRET		400423'		
DUMPF		401042'		LSAVET		000011	spd	SUBFAC		000005	sin	TRCSIX	646243	000000	spd	
DUMPF1		401051'		LTFLAG		200000	sin	SUBLBD		000006	sin	TRCVAL		400264'		
DUMPFA		401061'		LTRC		400644'	int	SURF		000002		TRCVER		000005	spd	
DUMPFD		401063'		MSTIME		400215'	ext	SYSTR		401317'	ext	TRCVL1		400304'		
DUMPFT		401057'		NSRT1		401016'	ext	T1		000011		TRCVL2		400276'		
DUMPT		401247'		NSUBS		000004	sin	T2		000012		TRCVL3		400265'		
DUMPT1		401254'		NULLST		400565'	ext	T3		000013		TRCVL4		400306'		
DUPLI		400121'	ext	P1		000004		T4		000014		TRCWHO		000000	spd	
E1$101		000000	sin	P2		000005		TB.ERR		400705'	ext	TRFL		000000*	spd	
E1$102		000000	sin	PLINK		000004		TB.FNC		400673'	ext	TRFUN1		400425'		
E1$104		000000	sin	PPL		000022	spd	TB.STC		400676'	ext	TRFUNC		000010	sin	
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page S-2
SNOTRC	MAC	13-Oct-66 22:17		SYMBOL TABLE

TRLVL		000144	sin	
TRNAME		000004	sin	
TRTAG		000006	sin	
TRTBL		400027'		
TRVAL		000002	sin	
TSEQ		401251'	ext	
TVAR		034000	sin	
TVVT1		400326'		
TVVT2		400333'		
TVVT3		400340'		
UPROKW		000000	ext	
UTDT		004014	sin	
VALUE		000000	sin	
VAR		064000	sin	
VCTFL		100000	sin	
VFLAGS		000006	sin	
VFUNC		000003	sin	
VKEY		000006	sin	
VLABEL		000002	sin	
VNAME		000004	sin	
VRTFL		040000	sin	
VTABLE		401005'	ext	
VTRC		400323'		
VTRC1		400360'		
VTRC2		400377'		
VTRC4		400401'		
VTSORT		401012'	ext	
XERRF		000000	ext	
XWD22		401275'	ext	
XWD44		401310'	ext	
Z		000000		
$ALPHA		400500'	ext	
$ERRTP		400725'	ext	
$FNCLV		400727'	ext	
$FTRC		400603'	ext	
$RTNTP		400571'	ext	
$STCNT		400731'	ext	
$STFCT		400733'	ext	
$STNO		400662'	ext	
$TRACE		400262'	ext	
%%MACT	000200	000025	spd	
%%SNOP	000500	000305	spd	


SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOTRC	MAC	13-Oct-66 22:17		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

ABLOK	   989
ADFBLK	  1149
ADT	   227	  1010	  1048
AHASH	   253
APROTO	   250	   251
ASGN	   907#
ASGNTR	   912	   924#
ASGNVL	   455	   914
BARINC	   204	   205	   338
BARS	   201#	   505	   645	   701	   789
BLENG	   334	   486	   569	   998
BLOK	   108	   550
BTCODE	   383	   545	   988
CDT	   760
CLMES1	   614	   634#
CLMES2	   618#	   630
CLMES3	   621	   639#
CLMES4	   648	   669#
CLMES5	   665	   675#
CLMESS	   596#
CVTINT	   939
CVTNAM	   122	   158
CVTPTR	   153
CVTSTR	   139	   236	   492
CVTVAL	   907
DBLOK	   991
DDT	   231	  1012	  1050
DFFLDS	  1155
DFLDS	  1160
DHASH	   272
DTNAME	   237	   248	   271	   288	   493
DUMP	   937#	  1020
DUMP1	   960#	   976
DUMP1A	   960	   978#
DUMPA	  1049	  1059#
DUMPA1	  1071#	  1077
DUMPA2	  1079#	  1121
DUMPA3	  1084#	  1095
DUMPA4	  1087	  1099#
DUMPA6	  1118#	  1135
DUMPA9	  1122	  1139#	  1152	  1180
DUMPAG	   940	  1031#
DUMPD	  1051	  1145#
DUMPD1	  1147#	  1171
DUMPF	   988#	  1001
DUMPF1	   998#	  1027
DUMPFA	   990	  1010#
DUMPFD	   992	  1012#
DUMPFT	   994	  1008#
DUMPT	  1053	  1175#
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOTRC	MAC	13-Oct-66 22:17		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

DUMPT1	  1178	  1185#
DUPLI	   208
E1$101	   159#
E1$102	   140#
E1$104	   123#	   125#
E1$110	  1055#
E13$53	   174#
E13$60	   190#
E13$70	   829#
E15$	   109#	   155#	   207#	  1021#
E6$1	   551#
ETPTRC	   859#
FCODE	   355	   562	   582	   583
FFLAGS	   558	   559
FLAP	   110	   111	   127	   133	   161	   163	   568	   956	   961	  1013	  1014	  1026	  1032	  1033
	  1036	  1047	  1054	  1059	  1064	  1069	  1099	  1100	  1101	  1102	  1126	  1148	  1175	  1176
FLAS	   596	   597	   602	   603	   955
FLOOR	   986
FNARGS	   558	   559	  1150
FNCTRC	   862#
FNDPOS	   408
FRET2	   908
FTDEBU	   340	   342	   359	   361	   600	   675	  1015	  1024	  1185	  1187	  1208	  1210
FTPAV	   405	   456	   459	   915	   918	   926	   929
GCOL	   938
IDT	   254	   274	   290	   313	   511	   660	   662	   730	   795	   880	  1073	  1085
IGNOP	    81	    87	   162	   353	   394	   398	   534	   751	   754	   835	   941	   944	   980	   985
	  1003	  1031	  1034	  1061	  1068	  1081	  1082	  1115	  1139	  1140	  1145	  1147
IMA.A1	   254#	   293
IMA.D1	   274#
IMAG.A	   228	   247#
IMAG.D	   232	   270#
IMAG.S	   230	   239#
IMAG.T	   234	   287#
IMAGE	   220#	   502	   619	   693	   968	  1037	  1103	  1162	  1194	  1197
KTRC	   860	   863	   866	   869	   871#
LINE	   507	   654	   669	   718	   726	   791	   970	  1039	  1043	  1105	  1164	  1199
LINE.	   239	   257	   277	   310	   623	   639	   706	   897	  1089
LNCLSV	   225	   245	   266	   283	   304	   315
LOCVAL	   220
LREGP	   340	   361	   600	   675
LREGQ	  1187	  1208
LREGS	   340	   361	   600	   675	  1187	  1208
LREGT	   340	   361	  1187	  1208
LSAVEI	   342	   359
LSAVEM	   342	   359
LSAVEP	   342	   359	  1015	  1024
LSAVES	   342	   359	  1185	  1210
LSAVET	  1185	  1210
LTFLAG	   741
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOTRC	MAC	13-Oct-66 22:17		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

LTRC	   775#
MSTIME	   306
NSRT1	   957
NSUBS	  1060
NULLST	    97	   485	   634	   635	   698	   699
P1	   610	   614	   621	   986	   988	   998	   999	  1000	  1008	  1010	  1012	  1013	  1018	  1026
	  1031	  1082	  1084	  1086
P2	    91	    93	   101	   104	   106	   113	   142	   143	   168	   169	   376	   406	   409	   411
	   412	   418	   419	   537	   539	   544	   555	   556	   561	   564	   566	   582	   583	   611
	   612	   613	   618	   629	   742	   745	   746	   749	   757	   758	   763	   808	   924	   925
	   952	   955	   956	   958	   960	   962	   988	   989	   991	   993	   998	   999	  1059	  1060
	  1081	  1087	  1148	  1149	  1160	  1161
PLINK	   355	   399	   538	   755	   847	   919	   922	   930	   932	   985	  1003	  1020	  1139
PPL	   340#	   340	   341	   342#	   342	   343	   359#	   359	   360	   361#	   361	   362	   600#	   600
	   601	   675#	   675	   676	  1015#	  1015	  1016	  1024#	  1024	  1025	  1185#	  1185	  1186	  1187#
	  1187	  1188	  1208#	  1208	  1209	  1210#	  1210	  1211
PPR	   361	   675	  1208
PPSA	   359	  1024	  1210
PROTKW	   811
PSHR	   340	   600	  1187
PSHSA	   342	  1015	  1185
Q1	   222	   227	   229	   231	   233	   352	   353	   411	   413	   569	   570	   758	   759	   760
	   761
Q2	   222	   223	   224	   412	   414	   501	   618	   692	   967	  1036	  1099	  1100	  1161	  1193
	  1196
Q3	  1054
QLINK	   108	   153	   220	   237	   248	   271	   288	   306	   493	   550	   938	   957	  1178	  1213
REGP	   340	   341	   361	   362	   600	   601	   675	   676
REGS	  1187	  1188	  1208	  1209
RETNUL	   395	   421	   540	   571	   578	   752	   765	   842	   851	   945	   981	  1004	  1141
RTMESS	   689#
RTMS1	   690	   698#
RTMS2	   694	   701#
RTMS3	   716	   724#
S.BAR	   202
S.BLLB	  1080	  1201
S.CLST	   659
S.CLT	   512	   796
S.ED	   712
S.EQL	   514
S.LEV	   661
S.NO	   263	   280
S.REE	   889
S.STMT	   510	   729	   794
S.TEQ	   973	  1110	  1168	  1204
S.TIME	   312
S.TRAN	   797
S1	   127	   128	   129	   133	   134	   135	   161	   163	   165	   166	   413	   414	   416	   418
	   568	   569	   574	   576	   759	   761	   763	   839	   840	   961	   962	   963	   964	   965
	   967	  1060	  1061	  1063	  1064	  1068	  1077	  1115	  1122	  1127	  1128	  1147	  1151	  1154
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOTRC	MAC	13-Oct-66 22:17		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

	  1159	  1160
S2	   148	   156	   171	   178	   180	   182	   184	   186	   188	   376	   378	   382	   387	   390
	   392	   417	   419	   438	   439	   440	   441	   480	   481	   482	   486	   490	   491	   525
	   528	   530	   537	   539	   566	   573	   575	   599	   610	   612	   613	   677	   690	   692
	   775	   785	   786	   834	   838	   846	   849	  1071	  1075	  1116	  1118	  1119	  1131	  1132
	  1134	  1149	  1150	  1154	  1155
S3	   247	   250	   251	   253	   270	   272	   287	   289	   291	   378	   379	   382	   383	   387
	   391	   431	   433	   434	   486	   487	   598	   611	   812	   816	   820	   825	   838	   840
	   850	   859	   862	   865	   868	   871	   881	   884	  1069	  1071	  1072	  1076	  1126	  1127
	  1128	  1129	  1130	  1150	  1151
SAVEM	   342	   342#	   343	   359	   360
SAVEP	  1015	  1015#	  1016	  1024	  1025
SAVES	  1185	  1185#	  1186	  1210	  1211
SDT	   229	   241	   243	   260	   262	   263	   280	   312	   510	   512	   514	   627	   643	   659
	   661	   710	   712	   729	   794	   796	   797	   899	   973	  1041	  1093	  1109	  1110	  1166
	  1168	  1201	  1203	  1204
SEDIM	   937
SLINK	   210	   225	   238	   239	   257	   277	   304	   310	   436	   443	   461	   473	   477	   478
	   502	   504	   505	   507	   619	   623	   639	   645	   650	   654	   669	   678	   689	   693
	   701	   706	   718	   724	   726	   779	   783	   788	   789	   791	   874	   876	   882	   897
	   925	   968	   970	  1037	  1039	  1043	  1089	  1103	  1105	  1162	  1164	  1194	  1197	  1199
SLKSAV	   478	   519	   689	   722	   733	   783	   801	   882
STACK	    96	   100	   110	   111	   124	   128	   129	   134	   135	   142	   144	   165	   166	   168
	   169	   173	   201	   202	   223	   224	   242	   247	   250	   251	   254	   255	   259	   261
	   264	   270	   274	   275	   279	   281	   287	   290	   292	   345	   346	   347	   348	   357
	   431	   432	   433	   434	   439	   441	   447	   449	   451	   453	   454	   460	   463	   467
	   472	   480	   490	   491	   496	   497	   501	   509	   513	   515	   516	   518	   552	   553
	   596	   597	   598	   602	   603	   607	   608	   625	   626	   634	   635	   641	   642	   656
	   657	   658	   663	   671	   672	   673	   698	   699	   702	   704	   708	   709	   711	   713
	   720	   728	   731	   785	   786	   793	   798	   799	   880	   881	   888	   889	   894	   895
	   900	   910	   924	   941	   942	   949	   950	   953	   964	   965	   972	   974	  1018	  1019
	  1022	  1032	  1033	  1034	  1045	  1074	  1075	  1079	  1080	  1085	  1086	  1091	  1092	  1107
	  1108	  1111	  1116	  1140	  1156	  1157	  1167	  1169	  1175	  1176	  1190	  1191	  1196	  1202
	  1205	  1207
STCTRC	   865#
STFTRC	   868#
STOPTR	    81#
SUBDIM	  1072	  1129
SUBFAC	  1063
SUBLBD	  1071	  1130
SURF	  1000
SYSTR	   201	   702	   888	  1079
T1	    88	    89	   253	   255	   272	   275	   289	   383	   384	   447	   448	   449	   481	   485
	   496	   497	   555	   557	   558	   703	   704	   947	   948	   949	  1047	  1048	  1050	  1052
	  1072	  1073	  1074	  1119	  1120	  1129	  1131	  1155	  1156	  1157
T2	   291	   292	   333	   334	   345	   346	   347	   348	   351	   406	   409	   450	   451	   467
	   544	   545	   553	   556	   557	   559	   562	   564	   574	   576	   746	   747	   748	   775
	   808	   809	   811	   813	   817	   821	   824	   826	   871	   872	   884	   885	   886	   893
	  1130	  1132
T3	   334	   335	   351	   352	   354	   407	   545	   546	   747	   748	   749	   811	   824	   834
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOTRC	MAC	13-Oct-66 22:17		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

	   893	   894	   895
T4	   331	   354	   355	   363	   741	   742	   745	   757	  1190	  1191	  1193
TB.ERR	   825
TB.FNC	   812
TB.STC	   816
TB.STF	   820
TBLOK	   993
TBUCK	   948	   962
TDT	   233	   948	  1008	  1052
TEREF	  1193
TEVAL	  1190	  1191
TFBLOK	   546	   549
TFCT	   574
TFOLD	   557	   582
TFRT	   576
TFVB	   564
THASH	   289
TIME.C	   307
TIMECL	   304#	   504	   650	   724	   788
TLINK	   122	   139	   158	   208	   236	   329	   333	   336	   364	   408	   455	   468	   492	   776
	   873	   907	   914	   939	  1177
TNBUCK	   291	   958
TR.TIM	   308	   313
TRAC.A	    93#	   101
TRAC.B	    94	    98	   103#
TRACE	    87#
TRACE1	   115	   148#
TRACE2	    82	   115	   139#
TRACE3	   115	   133#
TRACE4	   115	   122#
TRBLOK	   103	   384
TRC2.2	   143	   153#
TRC2.3	   149	   158#
TRC2.4	   172	   178#
TRCALL	   328#	   468	   776	   873
TRCASC	    29#
TRCCAL	   189	   530#
TRCEDT	    22#
TRCFN1	   535	   544#
TRCFN2	   547	   566#
TRCFN3	   582#
TRCFN4	   561
TRCFUN	   181	   525#
TRCKEY	   185	   808#
TRCKY1	   814	   818	   822	   827	   834#
TRCKY3	   836	   846#
TRCLAB	   183	   741#
TRCLB1	   743	   754#
TRCMIN	    21#
TRCRET	   187	   528#
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOTRC	MAC	13-Oct-66 22:17		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

TRCSIX	    28#
TRCVAL	   179	   374#
TRCVER	    20#
TRCVL1	   380	   398#
TRCVL2	   385	   390#
TRCVL3	   378#	   388
TRCVL4	   396	   404#
TRCWHO	    23#
TRFL	    78#	   508	   655	   670	   707	   719	   727	   792	   971	  1040	  1044	  1106	  1165	  1200
TRFUN1	   526	   534#
TRFUNC	   128	   129	   335	   351	   570
TRLVL	   407
TRNAME	   163	   165	   166	   345	   346	   481	   482	   893
TRTAG	   134	   135	   347	   348	   487	   490	   491
TRTBL	   113	   115#
TRVAL	   387	   391	   413	   414	   433	   434	   440	   450	   747	   748	   759	   761
TSEQ	  1177
TVAR	   379	   416	   911
TVVT1	   427	   431#
TVVT2	   428	   438#
TVVT3	   429	   447#
UPROKW	   824
UTDT	   839
VALUE	   967
VAR	   438	   448
VCTFL	   525	   530	   573
VFLAGS	   537	   539	   566	   742	   745	   757
VFUNC	   352	   354	   544	   555	   556
VKEY	   808
VLABEL	   746	   749	   758	   763	   775
VNAME	   785	   786	   894	   895	   951	   964	   965	  1156	  1157
VRTFL	   525	   528	   575
VTABLE	   947
VTRC	   417	   427#
VTRC1	   470	   477#
VTRC2	   483	   488	   496#
VTRC4	   494	   501#	   891	   902
VTSORT	   952
XERRF	    78
XWD22	   100	   144	   357	   432	   463	   472	   518	   953	  1022	  1207
XWD44	   460
Z	    91	    96	    97	   103	   105	   107	   156	   203	   204	   206	   307	   308	   340	   342
	   350	   359	   361	   390	   391	   392	   549	   552	   558	   559	   561	   562	   599	   600
	   675	   677	   910	   911	   942	   951	  1015	  1024	  1185	  1187	  1208	  1210
$ALPHA	   607
$ERRTP	   859
$FNCLV	   203	   662	   862
$FTRC	   647	   715
$RTNTP	   703
$STCNT	   865	   890
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOTRC	MAC	13-Oct-66 22:17		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

$STFCT	   868
$STNO	   511	   660	   730	   795
$TRACE	    89	   328	   331	   339	   363
SNOTRC - Tracing Routines  %5(251)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOTRC	MAC	13-Oct-66 22:17		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Macro/Opdef cross reference

ERR	   109	   155	   174	   190	   207	   551	   829	  1021
ERR%	  1055
ERR.	   123	   125	   140	   159
ERROR	   109	   155	   174	   190	   207	   551	   829	  1021
ERROR%	  1055
ERROR.	   123	   125	   140	   159
MIDENT	   341	   343	   360	   362	   601	   676	  1016	  1025	  1186	  1188	  1209	  1211
POPR	   361	   675	  1208
POPSA	   359	  1024	  1210
PPADDR	   340#	   341	   342#	   343	   359#	   360	   361#	   362	   600#	   601	   675#	   676	  1015#	  1016
	  1024#	  1025	  1185#	  1186	  1187#	  1188	  1208#	  1209	  1210#	  1211
PPINIT	   340	   342	   359	   361	   600	   675	  1015	  1024	  1185	  1187	  1208	  1210
PPLENG	   340#	   341	   342#	   343	   359#	   360	   361#	   362	   600#	   601	   675#	   676	  1015#	  1016
	  1024#	  1025	  1185#	  1186	  1187#	  1188	  1208#	  1209	  1210#	  1211
PUSHR	   340	   600	  1187
PUSHSA	   342	  1015	  1185
SHOW.	    35	    36
TITLE.	    27
TRCPTX	    39
TRCTTL	    38[@