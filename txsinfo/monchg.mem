

P034/K
------

/J01
----

F3TSER: ADDED IN CODE TO DO READ INTERRUPT TYPE TAPE TRANSFERS.
ALSO ADDED READ AND WRITE ERROR RECOVERY CODE, SINCE NEW MICROCODE
DOESN'T DO WRITE ERROR RECOVERY ANY MORE. THIS VERSION OF F3TSER MUST
RUN WITH THE NEW TAPE MICROCODE - WILL NOT RUN WITH OLD TAPEMICROCODE.
NEW TAPE MICROCODE WILL SUPPORT EITHER OLD OR NEW VERSION OF F3TSER.
/EVS 4-21-81

/J02
----

FILUUO: Dskclr mode 0 now sets Adjmws to -1.  /Todd 5-1-81

F3TSER: Discovered that new OVRRUN bit (overrun of tape channel)
comes up when reading record longer than channel word count.
Changed OD.WF status checking code to allow this to happen.
(not good that can't detect combination overrun and length error).
/EVS 5-1-81

/J03
----

COMCON: Added UNDEL command to call the file undeleter program. /Todd 5-5-81


/J04
----
F3TSER: Discovered that EOF bit is really EOT indicator on writes.
Indicates reading a file mark on reads. The real EOT bit in tape status
only says tape is at exactly EOT. Changed forward and back record,
write gap and write tape mark, read and write interrupt routines to
reflect this. Now, IOTEND will only come on on writes, IODEND will
only come on on reads. Program is responsible for detecting two EOF marks
as logical EOT on reads. I don't know if this is compatible with our other
tape services. /EVS 5-8-81.

/J05
----
F3TSER: Make OD.SKR and OD.BSR always clear IOLEND and IOTEND after J04
change took that behavior away. Set TUBSB in tape UDB on hung
tape transfers. /EVS 5-8-81.

/J06
----

COMCON: Modify WSCTL CALLI to not change JBTSTS<JWSADJ> on read-type
functions.
/DARREN 5-13-81

SCNSER: Fix for the "Messy Screen" KS Block I/O bug. at GOBIO2+13,14,15.  /GLYONS 5-13-81

COMMON: Fix for the primitive RM/RP drivers to wait a few ms before
testing to see if write done so as not to saturate the unibus. 
/Todd 5-14-81

APXKON,FILIO,COMMOD: New disk driver. Has hung disk code fixed,
multiple transfer capability (doesn't call FILINT for each page transferred
if a group of contiguous pages is started, instead calls when all pages
in group are finished). This saves some CPU time, and also
was done to attempt to be able to reduce the time between end of last page
transfer and beginning of next page in less than 60 microseconds.
However, disk I/O rate didn't speed up at all, indicating that must
start the next transfer in less than 60 microseconds. I timed PI cycles
at 42 us, and time it took from after PI cycle to time next transfer
was sucessfully started at 42us, for total of 84 us. /EVS 5-19-81

/J07
----

Removed Ginzburg's SETE password.  /WRS 5-21-81

APXKON:  Fixed bug in disk driver which forgot to turn off disk
conroller "idle" flag after a transfer - caused lost tape interrupts,
since tape would interrupt and disk control idle flag would still be
on.  (Foonly interrupts aren't like interrupts on the other machines,
where as long as the interrupt flag is on the interrupt will keep
coming in.  You only get one interrupt when the flag is set by the
microcode (microcode keeps a count for every channel of how many
flags were set for each channel)). /EVS 5-26-81

/J08
----

Added the XMAGNUM command to COMCON to run (SYS)XMAGNU.  /WRS 5-26-81

/J09
----

COMMON:	Slight change to KS primitive disk code that TODD fixed to handle
4 or more disk drives on the KS.  wouldn't complile because macro doesn't
like "100." as a notation for 100 decimal.  Changed 100. and 2000. to 
^D100 and ^D2000 (near symbol RMP1:).  /GLYONS 6-8-81


/J10
----

SCNSER: Moved command request and forced command bits from the left
  half of LDBDDB to the left   half of TTYTAB.
- Remove the spare LDB and all of its associated merde.
- Overhaul the ZAP/HANG code to reflect the aforementioned.
- Remove TTYCOM, COMWCM, SETKIL, and TTFCOM.
- Modify LOGIN/TTYINI/INISET to assign frame number before forcing
  command.
- Don't allow aux circuits to log into a shut system.
COMCON: Moved forced command/command request bits into left half of
  TTYTAB.
- Overhaul command dispatcher, assuming job number is always assigned.
- Add the following routines:
  * CHKKIL - called at end of command dispatch to see if job needs
    to be killed (copied/modified from SCNSER:SETKIL).
  * COMKJB - kill a detached job/frame.
  * COMWCM - Set command request &/or forced command for a frame
    (copied/modified from SCNSER:COMWCM).
  * COMCMR - Command finish-up (copied/modified from SCNSER:TTYCMR)
  * TTFCOM table - copied from SCNSER.
  * FRMCOM - Find a frame with command pending (copied/modified
    from SCNSER:TTYCOM).
FRMSER: Extract FRMASN (Assign Frame Number) routine from CREFRM
  and make it callable from LOGIN in SCNSER.
UUOCON: Changed RLSLDB UUO to CPOPJ.
COMMON: Define COMFLG bit table in jobs rather than ports.
- Change LINNTB to BITNTB and redefine for general use.
- Remove now-extraneous PVZHNG byte pointer.
- Delete now-unused LINTBE definition.
CLOCK1: Move TIMSET and TIMRST argument words here from SCNSER and
  add CLKJOB byte pointer for writing job # into them.
PICON: Use CLKJOB instead of hard-coded byte pointer.

/DARREN 6-9-81

/J11
----

COMMON - Remove symbol SETWCH, no longer used.
CLOCK1 - Clear JBTWCH in CLRJBT, prevents job from getting previous job's
  WATCH setting.
/DARREN 6-10-81

/J12
----

PICON - Make APR console messages more precise and more verbose for maint.
  engineers who turn out to need almost as much hand-holding as operators.
/DARREN 6-10-81

/J13
----

ONCE:	Added a warning message when bringing up a 2020 manually to the
effect that "the KMC will not be loaded so the Host will NEVER synch. with
the Base".  Also made the CONSOLE command available to non 2020 monitors.
/GLYONS 6-19-81

/J14
----

UUOCON:	Define CIOPR for F3 as well as KS.
CIOPR:	A quick debug version for the F3.  Doesn't work yet but won't hurt
anything.    /GLYONS 6-20-81

/J15
----

COMCON - Fix problem where jobs would get hung with command pending
	because COMCNT was zero, caused by cases where job would exit
	from command dispatcher with different job number than that
	with which they entered (e.g., ATTACH).
/DARREN 6-22-81

/J16
----

SCNSER: Input and skip auxcals will no longer go into wait when there are
echo chars, but no input chars and no chars can be converted (because of
backpressure, etc.).  Also, if a job becomes detached after an inc and
skip auxcal has begun execution, the auxcal will error return.  /TODD 6-29-81

/J17
----

SCNSER: Execute echo logic even for a backpressured port.  Don't allow
output if it is attempted.  This allows echo characters to be converted
into input characters when a port is backpressured and echoing is turned
off (as for an aux circuit).  /TODD 7-7-81

/J18
----

SCNSER: Fix code to allow echo when backpressure on.  /TODD 7-7-81

/J19
----

SCNSER: Allow backpressure off to be output on a backpressured port.
Change definition of BPOKBN to fix off-by-one error.  /TODD 7-7-81

/J20
----

SCNSER: Clear SKPFLG befor ABTUUO is called in TWAITC.  /TODD 7-8-81

/J21
----

SCNSER: Process only data present in input ring at start of processing
before servicing the output ring.  This should solve the problem of character
lossage that results from reading too much data for one port before 
backpressure can be applied.   /TODD 7-14-81

/J22
----

removed E.Socci SETE password
removed G.Lyons SETE password
changed W.Soley SETE password
/WRS 7-17-81

IOCSS - Add BFICLN fix which forces "previous context user" before trying to
clear user's input buffers, thus preventing STKAC crashes.
/DARREN 7-23-81

SCHED1 - Change AOS BADSS to STOPCD at PAGWK1+2 in yet another further
attempt to track down JBTPGO loop bug.
/DARREN 7-23-81

UUOCON - Always allow (SYS) programs to write to the CTY.
Logoff programs that SETNAM to EUTHAN (giggle).
/DARREN 7-24-81

FILRIB - Add hack at RIBEX2 to insure correct value for RIBSZS before trying
to expand RIB (to be removed when problem has been diagnosed more thoroughly).
Also count number of times each of the RIB expansion routines is called.
/DARREN 7-24-81

/J23
----


SCNSER: Added routine BPTEST to test to see whether few enough chars remain
to be read such that backpressure can be turned off on a port.  Call this
routine where necessary.  Previously backpressure was turned off too often
causing the number of unread input chars for a port to progressively increase
until chars were thrown away.  Changed TIHLTN to be max number of chars in
input ring for one port so that backpressure on has a chance to be put in the
output ring.  Fixed code at TTYSTR to consider both def and remote echo
break chars.  /Todd 7-24-81



/J24
----

SCNSER: FIXES TO ABOVE.   /TODD 7-24-81

/J25
----

RMXKON: inserted fix for RMX ECC bug that was patched on 654 and
seems to work.  Simply forces page transfer when doing retries
since block transfers seem to not work very well.
/WRS 7-27-81

SCNSER: Extended Trmtab to include entries for new terminal types supported
by Tymnet.  /TODD 7-28-81

COMMON - Redefine SCNN (# TTY DDBs) to JOBN+PORTN+1 from 
MAX(JOBN,PORTN)+AXDDBS.  Incidentally, symbol AXDDBS is now
extraneous (i.e., never referenced anywhere).
/DARREN 7-29-81

/J26
----

Added 2 new entries to CONFIG table in COMMON:
    PATMAP= CONFIG+42/ bit n is on if patch n is installed
    MONID= CONFIG+43/ sixbit serial number of monitor in form M#####
	changed for every monitor to prevent confusion when config
	changes or such.
/WRS 8-13-81

/J27
----

RMXKON - Correct RMXADD to give error return only when actually attempting
to read past end of cylinder (previously gave error even when reading up to
the end).
/DARREN 8-14-81

RMXKON - Check for zero offset before backing up to previous block, thus
preventing exec page faults in ECC correction routine DATERR. (Ernie's fix)
/DARREN 8-16-81

COMCON: Remove check for non-zero job number upon return from command
dispatch, since we no longer depend on it for updating the tables.  This
fix will prevent further crashes at COMDIS+5. /Darren
/DARREN 8-17-81

IOCSS: Added Chanio function 46, .chnxt.  If Chan is -1 the number of
the next free chan is returned and the chanio skip-returns.  If Chan is
a legal chan #, the chanio skip-returns if the chan is not in use.
Otherwise, the chanio non-skip-returns.   /TODD 8-17-81

/J28
----

CIOPR: fixed bug which left interrupts enabled after a nodeload.
/ernstd   /TODD 8-24-81

/J29
----

IOCSS: Set the "previous context user" bit to user before doing a buffered
mode close and restore to previous previous context user when done.  This
is necessary so that the monitor can do a close on chan 0.  /TODD 8-24-81

/J30
----

COMCON - Put COMDIS+5 crash check back in - will fix individual commands
instead.  /DARREN 8-25-81

FILUUO - Fix DSKCOM command to always restore J before exit.
/DARREN 8-25-81

/J31
----

CORE1: fixed code in DOXCT routine which handles UXCT## macros to not
reference 1(P) so that interrupts might be less devestating.  /WRS 8-27-81

/J32
----

F3TSER: Changed OLDMOP to use exec virtual locations starting at %ONC instead
of page 500.  This is necessary because page 500 (and above) may be used for
other things in a big enough monitor.  Hopefully the use of %onc to %onc + ?
is not in conflict with anything else.  There is currently no good way to
know precisely which exec virtual pages are "claimed".   /TODD 8-31-81

/J33
----

F3TSER: Minor change to above F3TSER change.  /TODD 9-1-81

COMMON: FILUUO: changed crash code to pickup PCs from STOPCD(SLO) and 
STOPCD(NO) in a more structured and accurate manner.  Also STOPPC will now
only get decremented when it contains a real PC so DEP in 30 will not
show up as STOPPC/-1 anymore.   /WRS 9-1-81

/J34
----

FILRIB: Remove RIBEX2 hack, add better checks in RIBCK1 for consistency
between RIBSZS and RIBSNM, and fix DLTSRB to adjust RIBSZS when RIBSNM has
been decremented to zero.
/DARREN 9-2-81

/J35
----

COMMON: Do a TNCONO for F3s when sys comes down to tell the node that
the sys is down.  This allows the node to resync with the host much faster
because the node waits ~1 min. after it first learns that the host is down
before resynching.  /TODD 9-2-81

Changed terminal characteristic fields for IR and OR (input baud rate and
output baud rate) to 4 bits from 3 bits to be compatable with Tymnets new
codes.  Change is actually per DWS.  /WRS 9-2-81

CORE1: Make sure VALID and REMOVE set up J before calling PAGWAT.  This
should prevent any more JBTPGO loops, but it's hard to say since the
problem couldn't be duplicated reliably.  /DARREN 9-9-81

/J36
----

COMCON: Fix TIME command to restore job # after an attempt to get time
on another job without appropriate lic.  Caused COMDIS+5 crash when TIM 0
tried.   /TODD 9-10-81

COMMON: Created the crash data block (CRSDB) where all important crash
data is storred in an orderly defined manner so programs like CRSHID can
get at them without symbols or other kludge.  /WRS 9-11-81

/J37
----

UUOCON: Set Jbtslc to Max Jbtslc and new process lic in Setlic.  This allows
process lic to be reduced and then restored when proc lic was increased
by a previous Setlic past Jbtslc.  This can occur if frame lic increased
by a sete or another frame.  Problem occurs when frame lic is reduced after
proc lic is increased.   /TODD 9-16-81

S.MAC: Added access right 32 for license passing.  /TODD 9-17-81

/J38
----


COMMON: Add new UPT location UPTMTM (micro-cycle timer) plus new interrupt
type (15) and byte pointer JBYMCY into trap word UPTTP1 (which is now full).

CLOCK1: Add routine CHKMTM to update micro-cycle timer (called from TIMADJ).

UUOCON: Add CALLI -144 SETMCY (Set Micro-cycle Timer).

PICON: Add routine SETMCY (called from UUOCON) to set micro-cycle timer.
/DARREN 9-21-81

/J39
----

ONCE: Changed the SCAN and SCNTB macros to allow for a more versatle
set of commands and options, and to ignore the UNI and STR fields needed
in the corresponding macros in ONCDSK.  Modified the CMDSCN routine from
the ONCDSK module to work with the new macros and made it local to ONCE.

ONCE: Added the FULL command for bringing up the monitor to run a FULL
      DSKCLN for this time only.  Nothing is written in the HOM pages.
/CARL 10-9-81

/J40
----

Scnser: Tihltn <- 2 * size input ring (in chars) + Tiwrnn.  This should
reduce character losage for bases that don't know when to quit sending
us characters on one port.   /TODD 10-13-81

Note: Lospdp does NOT necessarily mean that we're too slow in requesting
backpressure.  Consider:  host receives .ge. tiwrnn chars so requests
and sends bp on, next time thru i ring lopbpn gets set again because
# chars is .gt. tiwrnn and .lt. tihltn, enough chars are present in
ring so that further reading of chars causes tihltn to be exceeded.  This
may (should) be changed.   /TODD 10-13-81

/J41
----

ONCE: Again modified SCAN and SCNTB macros.  Moved CMDSCN routine back
      into ONCDSK.  Changed FULL command to be highest priority even to
      override DSKCLN xxxxxx set by FILES.

      Made FILES command harder to enter by asking for verification to
      enter the ONCDSK dialogue.

ONCDSK: Modified SCAN and SCNTB macros as per ONCE.  Added some better
      documentation in the HELP messages for the commands.  Added a bit
      to the SCNTB macros to require verifiation of individual commands.

      Removed earlier edit for REFRESH command and cleaned up some of
      the associated code.
/CARL 10-15-81

/J42
----

S:  Bumped counter OND in MAPONC macro from 6 to 7 because ONCDSK
    grew some.  /CARL 10-15-81

/J43
----

Scnser: Make Auxcal function 10 behave like Skpinc for command port.
Previously would assume chars were present if a command was waiting
to be rescaned.   /TODD 10-16-81

Scnser: Don't wake job if backpressured port that is not in input wait
attempts to echo a character.  /TODD 10-21-81

SCNSER: Added AUXCAL 100 (.AXTTP) to set sixbit terminal type.  Added
 corresponding 'TTY' command (TTY TYPE FOO).  /dws
/DWS 10-23-81

/J44
----

ONCE: Fix problem with SCNTB macro under IFKMC < ... > conditional.
It seems that IFKMC translates to "REPEAT 1," and an extra set of
angle brackets "REPEAT 1,<< ... >> causes MACRO-10 to break generating
correct code, but producing assembly error messages.  Changed SCNTB
macro to omit the duplicate "<>"'s allowing a clean assembly.
/CARL 10-28-81

UUOCON: Fix typo in setlic mod to update Jbtslc.   /TODD 10-28-81

/J45
----

Changed SETE password.  /WRS 10-29-81

/J46
----


Scnser: Fix an earlier fix.   /TODD 10-29-81

/J47
----

Scnser: Change parameter name for tty command to set terminal type to
"class" from "type" since type was already taken.   /TODD 10-29-81

/J48
----

Common: Fix bug that caused free core Aobjn pointer to have its length
set too large if the size of the free core bit table is greater than
^D144 words.   /TODD 11-3-81

/J49
----

ONCE: Removed "Entering ONCE ... type HELP for help..." message.

ONCDSK: SHORTened the verification message to ask "Are you SURE you
      want to do this? " instead of very long message.  /CARL 11-5-81

Core1:  Location Maxcor contains the beginning of free core relative
address of the highest free core block assigned.  Accessable via
Getlnk gettab.   /TODD 11-6-81

/J50
----

F3tser: Fixed Oldmop to work with odd %onc.   /TODD 11-6-81

/J51
----

ONCE: Accidentally deleted label HLPCMD: while shortening messages.
      Checked code & renamed label HLPCM1 and all references to HLPCMD.
      Verification still re-types the HELP text for the command which
      needs verification.  /CARL 11-6-81

COMMON: changed defaults for PPORTN to JOBN/2
/WRS 11-10-81

/J52
----


F3tser: Setup Oldmop buffer byte pointer correctly.  /TODD 11-12-81

/J53
----

F3tser, Magser: Fix buffered mode tape op to work when buffer empty.  Two
problems were present: (1) SRFX didn't return properly for emptfer.
(2) MT resource was not released when buffer was empty.  /TODD 11-13-81

/J54
----

COMCON: Modified DAYTIM command code to display the time zone immediately
after the date and time display.  Currently "unknown" time zones have the
letter designation as copied from the YAMM.  For daylight-savings time,
the associated codes have a plus-sign "+" after the letter.

COMCON: Moved routine PRTIME out of the daytime command and made it
callable to return "hh:mm:ss" on the current output device.  Routine
PRTIM has been changed print 2 digits each for SS.HH although it may
leave out HH:MM:.... if both are zero.  Will also print 2 digits for
minutes.  (uses common code from PRTIME).

COMCON: Removed "TVEDIT" command from the list of RPG commands since
noone uses it (as per WRS).  Added "VUE" command in its place for that
time when VUE is added to RPG.  (Maybe soon?)

UUOCON: Made routine DSTCHK internal so that the daytime command can
check to see if the current time/date is between periods of daylight-
savings, as per the table in uuocon.  /CARL 11-18-81

/J55
----

COMCON: Changed WATCH-DAY routine to use PRTIME instead of PRTIM.  We
don't want to see hh:mm:ss.hh for time of day.  However, we are leaving
out the time zones from this command.  Also, fixed code which printed
out a clobberred register as the hundredths of seconds.  Now works ok.
/CARL 11-18-81

/J56
----

IOCSS: Get UPT and UPX locks in cannonical order (lowest frame number
first) in Vreplu to avoid deadlock.  /TODD 11-18-81

/J57
----

Frmser: Install Sligos fix to Chepar.  Previously right of parent
instead of child was being checked.  /TODD 11-20-81

/J58
----

Doubled SAT and RIB PCB allocation for 38 on a hunch.   /WRS 11-20-81

/J59
----

COMCON:  Changed time-zone table to reflect JST and JST+ for Tokyo (I),
         to print WET for GMT+daylight, EET for CET+daylight, EEDT for
         EET+daylight (Europe).  /CARL 11-24-81

ERRMSG, UUOCON: Define new error class 3 (ill inst trap) subtype 4 to
be called when an illegal CALL parameter is given.  Previously a
non-existent CALL would do a SEEK.  /TODD 11-30-81

/J60
----

FILIO: Turn on disk PI at end of UUOSK1.  On FOOs this caused sys to hang
after a SEEK because of a ucode bug: if PI n pending, but off and m pending
and on where m>n, m will not fire.  On other than FOOs ch7 (or something)
turns the disk PI back on. /TODD 12-1-81



CONF??, COMMON, CLOCK1: Delete extraneous conditional assembly switches from
CONF?? files and from monitor.  The following symbols are now useless:
	SYS40N, SYS50N - we no longer use DEC disk service
	DSKN - yes, we have disks on our systems
	LEVDN, LEVCN - refs to DEC level "C" and "D" disk service
	PDP10N, KT10AN - we have no PDP-6's
	DDTN - always included
	MOVIEN - we don't dump to line printers
	DISN, PENN, T340N, TVP10N, T30N, DTAN, DTCN, MTAN, MTBN, MTCN -
		- obsolete DEC peripheral devices
	TEMPN, TMPN, TMPLN - yes, we have TMPCOR
	LOKN, CMNN, RTTRPN - misc. obsolete DEC switches
/DARREN 12-2-81

/J61
----

COMMON,
S, PICON, CLOCK1, SCNSER, CLUBS, ERRCON ,SEGCON: Fix probs. with Hiber return
and interrupt on wake uuo and exit in child identified by Sligos.  A new
flag, EXCFLG, now exists.  It's function is analogous to WAKFLG.
JBYFEX, child frame exit channel number, has been replaced with JBYEXC.
Previously WAKFLG served both function and confusion resulted. For example,
Hiber on Wake would return on exit in child.  WAKFLG, EXCFLG are now
set only when TAKTRP isn't called.  This avoids getting two interrupts/
hiber returns for one cause.  For same reason JBYFEX, JBYWAK are cleared
in TTSCLR.  WAKFLG, EXCFLG are also cleared in SEGCON (so that a wake/exit
directed to previous process will not affect the new process) and at
logout.  Note that the behavior of wake and exit in child are now sufficiently
different from the past so that programs that were were written to cope 
with the bugs may not now work.  In fact, some may sleep forever waiting
for a second interrupt which won't come.   /TODD 12-4-81


/J62
----

COMCON: Changed table entries for time zones to those agreed upon with
        international.  Zones 60,61 and 62 (european daylight times)
        have been renamed "WEST","CEST" and "EEST" for Western, Central
        and Eastern EUROPEAN SUMMER TIME.   /CARL 12-7-81

/J63
----

SCNSER: Clear LOPBOP (PTY block-output-in-progress) flag in BIOZAP, so that
receiving a zapper on a PTY port in block I/O mode won't crash at PGBOP+2
as it used to.  /DARREN 12-8-81

SCNSER: Fix TIHLTN value calculation.  /TODD 12-10-81

SCNSER: Fix bug that caused Inchwl to deadlock a job if job was backpressured
and less than Tiwkc chars were waiting to be read.  Now Inchwl will return
any time chars are waiting and port is backpressured.  /TODD 12-10-81

/J64
----
P034/L
------

/K01
----

S: Changed the IFCPU and IFNCPU macros to "repeat cpzz" instead of
   "repeat cpzz," so that IFCPU(x),< ... >  would not generate two
   commas.  /CARL 12-28-81

PICON,ONCE: Fixed Typoe of "IFCPU (x),< mumble >,end ..." which should
   have been "IFCPU (x),< mumble > ; end ... "  (Yes, a comma and not
   a semicolon).  /CARL 12-28-81

UUOCON: Fix X macro used in WAYS macro.  Put a "," between the IFB,IFNB
   and the code to be generated.  Also, add missing ")" close-paren to
   the last item in the WAYS macro (fixed undefined symbol).
   /Carl 12-28-81

UUOCON: Removed SEXTERNAL symbol references SYDFTA and SYDMTX and made
   them conditional on non-zero definitions of the configuration symbols
   FTAUN (# of FTA's) and MAGUN (# of MTA's).

UUOCON: Magically transformed .ELINK into .LNKEND for the new MACRO,
   leaving .ELINK alone for the old MACRO %46.

CTYSIM,CIOPR,KMCSER,DR11C,DZKON,ONCE: Removed SEXTERNAL references to
   DZDO,DRDO,KMCDO,DZINI,DRINI,KMCINI,KMCSMN,KMCCMN and made them all
   conditional on IFKMC.  DZDO,DRDO and KMCDO are defined in CTYSIM as
   always.  /CARL 12-28-81

SIMKL,ONCE: Removed SEXTERNAL references to ONCGO,MONDEB,& PATSIZ and
   added the symbol KL$SIM in the simulator which is checked for non-zero
   by ONCE under an IFCPU (KL) conditional.  Code was added to the patch
   code in the simulator to set KL$SIM non-zero.  /CARL 12-29-81

DDT: Commented out the line "SEXTERN OVTAB." in DDT.  This symbol is not
   even referenced once in the source. (OR in *.mac in M33 or MPL) except
   for LOADER.MAC which is only generating a DUMMY location OVTAB. if it
   doesn't exist already (Special case!).  /CARL 12-29-81

Note:  The monitor now has NO S-EXTERNALS in it.  It will now load using
LINK-10.  With the exception of external POINTer references, the monitor
will also assemble under MACRO %53B.   /CARL 12-29-81

COMMON: (UUOCON,FRMSER,COMCON) Moved pointer UPYPSR from UUOCON into
   COMMON and added corresponding pointers USYPSR & UXYPSR for %UPS
   and %UPX.  All 3 are internal and referenced elsewhere at least once.
   /CARL 12-30-81

COMMON: (SCHED1,CORE1,UUOCON,COMCON,PICON,ONCE) Moved pointers from
   literals in many modules into COMMON where the symbols used are defined.
   New symbols are UPYPTx,UPYPXx,USYPTx,USYPXx,UXYPTx and EPYPSx where <x>
   is either "N" or "M" depending upon whether %xxx.N or %xxx.N-1 is used
   as argument to the macros.  /CARL 12-30-81

COMMON,CORE1: Moved macro definition UPTPTR from CORE1 into S so that it
   can be used where necessary.  Moved the only use of it into COMMON with
   the pointers UPYPTx as mentioned above.  Also: *** NOTE *** I changed
   the name of the macro (UPTPTR) to (UPYPTR) so as not to conflict with
   the UPT symbol UPTPTR.  /CARL 12-31-81

COMMOD,CORE1: Moved pointers from literals into COMMOD for their def's
   and created 2 more symbols RB1PNO and BA1NBB which are near to RBYPNO
   and BAYNBB in definition, but not quite!  /CARL 12-31-81

COMMON,MAPIO,CORE1: Defined some more bit masks in COMMON so that less
   polish is needed for adding bit definitions in other modules. New
   symbols: LMMMXW, LMMSUP, LMMRED, LMMRDW for LMAP bit configurations.
   /CARL 12-31-81

COMMOD,FILRIB: More about pointers: RBYUNA, RBYUNR and RBYUNV for getting
   the unit from ATBRIB(P2), DRBRIB(P1) and DEVRIB(F).  /CARL 12-31-81

FRMSER: Changed BYTE (18) arg,0  to XWD arg,0 inside JDSMAC macro to fix E
   errors in the new macro.  comment used to say something about a bug in
   the old MACRO, but it assembles ok with either version at present.  Also
   changed reference to literal to use UXYPSR in COMMON.  /CARL 12-31-81

FILUUO: Fixed [XWD BYTE (5)0 (3)CPRRED (10)1 (8)0 (10)%COW.N+CNVVPN] to
   simply [<CPRRED>B7+1B17+%COW.N+CNVVPN] to work with the new MACRO.
   Macro-46 simply allowed that construct. Amazing!  /CARL 12-31-81

COMMOD,FILFND: Defined SPTNMM to be SPTNME justified to SPNNFE so we don't
   have to play games with externals.  /CARL 12-31-81

ACTSER: Changed the ATB macro to use Xwd rather than BYTE and added
   a ",0" to the end of each line where a 4th argument was wanted.
   Put angle brackets "<>" around constants used in arithmetic with
   an external.  Fixed "Polish too complex" error.  /CARL 12-31-81


/K02
----

COMMON, CLOCK1, UUOCON: Removed job tables JBTRMT and JBTRMC (no longer used).
/DARREN 1-6-82


CONF??.mac, COMMON: The following symbols have been moved from CONF??.MAC to
COMMON or deleted entirely:  SYSDEV,SYSNAM,SYSDAT,RP10N,RA10N,C0FHN,C0DPN,
C0MDN,RD10N,NUMPRT,COREN,SEGNX,CR10N,CDPN,SPCINT,SPCDDB,SPCSAV.
/DARREN 1-10-82

/K03
----

COMCON: In JOBKL, delay call to TTYKIL until after returning from KILUPT.
This should prevent job from being rescheduled with TTYTAB(J)=0, which int
turn should prevent any more crashes at SCNSER:STTLK+6.
/DARREN 1-11-82

COMCON: Set Errflg in P3 instead of clearing J to indicate error at COR2+2.
Error happens when CORE command requires hiseg to be deleted.  Problem
was discovered by noticing that SYSTAT followed by CORE 5 (with SY lic)
crashes system.  /TODD 1-19-82

Errcon: Don't set up previous context F when Adrerr is called.  Fixes 
bug that would either crash system or print a bogus device name in
address check error message.  Sys would crash if user ac 4 had a value
such that an exec mpe would occur.  /Todd  /TODD 2-1-82

/K04
----

COMMON - Add new job table JBTSCA which contains TRU scaling argument,
	plus byte pointers to the 4 9-bit fields.
CLOCK1 - Modify GTCGSZ (Get Charging Size) to use TRU scaling args if present.
UUOCON - Modify CLKTRU to do size-dependent and size-independent components
	seperately, scaling size-independent according to JBTSCA args.  Add
	XCHARG function 7 for TRU scaling.
/DARREN 2-9-82

/K05
----

COMMON: Allow FCWDS to be defined in Conf.  /TODD 2-10-82

/K06
----

PICON: Added Internal label PGFUIO just prior to PGFAIL with contents
       PC.UIO,,PGFAIL to be used by ONCE inside IFCPU(KI) conditional
       for getting there on page-fail conditions.  /CARL 2-18-82

ONCE:  Changed all occurrances of [EXTERNAL] and [POLISH] to non-literals
       so that MACRO 53B can be used for assembly.  /CARL 2-18-82

/K07
----

Comcon: change UNDEL command to UNDELETE.  /TODD 2-23-82

FILIO - Add counter OHTREP to count number of times INSOHT is called more
than once for the same disk page; also halfword table OHTCPN for Core Page
Number of disk page entered in OHTTAB.  /DARREN 2-23-82

ONCE:  Modified routines Evaset and Evaclr and added Evahi to allow
	dynamic data structure allocation to start at next pg after
	initial Syssiz.  Previously started at %Min (pg 400).  Evahi
	determines if virtual address has transitioned from below per-
	process area to within or above it.  If it has, it sets Evasiz
	to %Min.  
COMMON, ONCE:  Call Evahi after Evasiz is modified.  Repeat allocation 
	code for a particular data structure if it couldn't fit below pg
	340 and addr wasn't previoulsy above %Min.  /TODD 2-25-82

/K08
----

KSSYM,KSIORG: Updated XCREF/RCREF to .XCREF/.CREF so that either macro
    can assemble the sources for a KS processor. /Carl 2-Mar-82

KSSYM,ONCE: Moved WRHSB from ONCE to KSSYM where it belonged. /Carl 2-Mar-82

ONCE: Removed more literals so that ONCE would assemble for the KS.  The
    Old MACRO %46 would not fold literals on pass 2 tha same as pass 1,
    thus we got "P" errors during assembly.
      /CARL 3-2-82

/K09
----

ONCE: Text message at HLPCMD was re-inserted to catch illegal commands
      given to the ONCE> prompt.  Removed originally because it was too
      verbose.  Now skipped upon entry.  Message:
      ?Unrecognized command - Please type HELP for help.
        /CARL 3-3-82

IOCSS:	Push F at CLOSE3 and pop at UCLS3 so can tell if buffered io
was being done so can determine whether to restore previous pc.uio state.
Solves XBASIC Getseg error problem.  /TODD 3-3-82

COMMOD, CONF??.EXP - Move a few more symbols out of the config files -
  C1FHN, C1DPN, C1MDN (defined only on a few VF KI's and always to 0)
/DARREN 3-5-82

S,FILUUO - Add DMOVPG to disk DDB dispatch table.
APXKON - Ernie changes - ?
CORE1 - Add "validate even if private" flagg VL.VPP.
IOCSS - Add CHANIO function 47 - VMOVPG.
SWAMP - Make UPDAC0 an external entry point.
SIMIO - Don't undo 4 disk-block charge after SIMCRE, no longer accrued.
FILFND - (quote) "Add routine DECUNS to decrement ATBUMC & ATBMXW, and
  remove SPT entry for unshared DP so it can be moved to another file."
MAPIO - All the good stuff:
  Add VM kernel routine KMOVPG to "take a page which is currently mapped
    and not part of a file and cause it to be mappable from the specified
    position of a file open on the channel."
  Add routine LOKHPW, called (by KFCRE & KMOVPG) when holding only the
    atomic file lock and needing the write lock to manipulate a slot past
    highest page written (HPW).
  Add entry SWEPRH to SWEEP to sweep file with real holes despite TITO
   crock; modify SWEEP to use VMOVPG if sweeping 1 real page (SIMIO case).
/DARREN 3-9-82

/K10
----

IOCSS, CORE1:  Call Uniupt from Reprlu to release %upt lock if held
by current frame and not complain if not.  Delete Reprl1 code because
can always get upt lock (eventually).  /TODD 3-10-82

/K11
----

CONF??, COMMON: (KS only) Move definitions of LPTN, LPRUN, and LPRVEC
from CONF?? to COMMON, enclosed by IFCPU(KS), since they're the same on
all 2020's.  Remove VECMIN, VECMAX, VECNUM, TBISTR, and TBIEND as perhaps
the silliest consistency check ever devised.
COMMON, ONCE: Use size of TBISAV table to init loop counter in SETUBT.
/DARREN 3-13-82

COMMON - Remove two more job tables that appear to be unused - JBTCB2 and
  JBTIDN - apparently used by CLUBS at some point in history.  /DARREN 3-18-82

/K12
----

Scnser: Have Newjer zap tty after printing out error message.  Previously
job capacity exceeded would not kill port and this eventually would
cause a crash in addition to the nuisance of echoing user name and
leaving port in limbo.  /Todd  /TODD 4-8-82


S, FILUUO: Install new close flag, CLSDMP=200, to set file dumped bit.
This will allow TITO to set file dumped without doing a rename and
potentially changing some other rib data.  /TODD 4-13-82

/K13
----

UUOCON - Time to remove EUTHAN hack from SETNAM.
/DARREN 4-16-82

FILIO - One-line fix to INSOHT change.
/DARREN 4-19-82

COMCON: added POP command - special form of ATTACH to attach you to your
parent (if any) and log out current job.  /WRS 4-20-82

COMCON: updated several messages to talk about frames not jobs.  /WRS 4-20-82

COMCON: changed attach code to check for attached frame license greater than
source frame license.  /WRS 4-20-82

FILUUO: changed LICMSK to return the current license in the case where
the requested license is greater than the current (for example it used
to be that LICMSK(WA,WF)=0, rather now LICMSK(WA,WF)=WF)  /WRS 4-20-82

/K14
----

COMCON: fixed POP command to handle errors more gracefully  /WRS 4-20-82

/K15
----

COMCON: more fixes to ATTACH and POP license restrictions  /WRS 4-20-82

IOCSS - Fix function code check, broken when NXTCHN was added.
/DARREN 4-21-82

COMCON - Change INITIA command to .INITI for obscure and perverse
  reasons.  /DARREN 4-21-82

MAPIO - Fix KMOVPG for case where file page argument is -1 (insert after
  current EOF).  /DARREN 4-27-82

/K16
----

S: Change CLSDMP to be 100000 from 200 to avoid conflict with possible
DEC expansion.  /TODD 4-30-82

ONCDSK: Modified STSREF (REFRESH) to force a call to UPDHOM after the
        refresh is complete.

ONCDSK: Split GETRAN into SETRAN (start timer) and GETRAN (stop timer
        and read number into RANNO) and call both routines whenever
        CMDSCN is called by ONCE or ONCDSK so that the clock is always
        running while waiting for command input.  This solves the KS,
        KL problem doing a refresh and setting the pack-set id to 0.
          /CARL 5-5-82

/K17
----

ONCDSK: Removed erroneous calls to SETCHG which may have clobbered
        something since U was not guaranteed to be setup in /K16.
        Re-Inserted LSH to zap low order 12 bits in GETRAN since a
        KL always returns 0 [Inside IFCPU(KL)].
Note: REFSTR rewrites the HOM pages before it returns to ONCDSK, so
      no other forced rewrites are necessary in ONCE.
      /CARL 5-7-82

ONCDSK:  Fixed CMDSCN routine to skip return on "NO" answer to the
         "are you sure" question, so that it doesn't complain about
         commands which require verification as "unrecognized".
ONCDSK:  Added local symbol CMDMSG which if non-zero will only type
         the "Are you sure" question on verification rather than the
         verbose help text put in for operators to read.  Mainly for
         debugging use when jumping in and out of ONCE/ONCDSK.
/CARL 5-8-82

FRMSER - Add .FRMOP 41 (Stop Frame) - simulates ^C on a frame.  /DARREN 5-25-82

/K18
----

DDT: Changed code which checked for processor type to check FOONLY using

DDT: Changed F3 processor check from AOBJN test to PUSH test for KA/F3's.
     Ac/ 0,,-1  PUSH Ac,0  (1,,0 no carry; 2,,0 otherwise) TLZ Ac,1 to have
     all good DEC hardware return 0.  /CARL 5-29-82

/K19
----

COMCON: changed ATTCHK (check source / target frame license for attach) to
check frame license rather than process license (ooops).  /WRS 6-7-82

SCNSER: Only negotiate for BIO ports if on a Tymnet base.  I.e., if a
KI or KL.  /TODD 6-22-82

/K20
----

Mapio:  Return valid error code from sweep vmovpg failure.  Solves crashes
caused by copying a file into a full directory.  /TODD 7-13-82

/K21
----

FRMSER: Add new format .FOCFM call, allowing new JBTPPN = caller's
   AUN, PVYMSK bits in JBTPRV to be different, plus provision for
   running LOGINN in the child frame.
	NEWWAY:	MOVSI	ac,.FOCFM
		FRMOP	ac,BLOCK
		  error return
		normal return
	BLOCK:	flags,,count
		exp JBTPPN,JBTPRV,JBTAUN,JBTUNM,JBTUN1
	;FLAGS
	CF.OLD== 1B0			; this word is -cnt,,adr (old way)
	CF.LOG== 1B17			; run LOGINN in child
FRMSER: Add .FRMOP 42 - Force command on frame, this was the chosen
   generalization of "force INITIA command", plus new .FRMOP error
   code 37 (illegal command).
UUOCON, FRMSER: Move code for CHPRJ calli (change project code) from
   UUOCON to FRMSER and add a FRMOP entry point (.FRMOP 43).
COMCON: Add routine to return forced command index given SIXBIT string,
   called by .FRMOP 42.
 - Allow LOGINN to be run in a detached frame.
 - Have POP command run LOGOUT, remove CPOP routine.
 - Add PCOM & DCOM commands (both run PCOM) and PEAK command (runs PEAK).
 - Remove PCHECK command and code.
 - Add .USESTAT command to display incremental data.
SCNSER: In normal character mode, have ^T force .USESTAT command if
   LDBDCX<LXLRTC> is set.
 - Add "TTY [NO] RTCOMP" & AUXCAL 101 to set/clear LXLRTC.


/K22
----


/K24
----

/K24
----

Assigned JP.MAI (1b8) in priv word to indicate (new) mail waiting.  Added
SETMAI UUO (CALLI -145) using most of SETMAL as a subroutine.  Added code
in SCNSER to print "[Mail Waiting]" if JP.MAI set.  Note:  None of the
above invalidates any of the JP.MAL (old RPG mail) stuff.
/DWS 7-19-82

/K25
----

/K26
----

Common, Clock1, Uuocon:
   Add Inactivity Timeout feature.  New job table, JBTINA, keeps track
of user specified inactivity timeout (0 if off), time since job was
last active, and whether the inactivty limit was hit.  Once-a-minute code
in Clock1 increments inactivity counters.  If the time-limit is hit, the
process will be evicted if enabled for eviction otherwise it will be
hung (killed regardless of hang/zap action specified by user).  Changing
the timeout limit is accomplished with the SET AUTOLOGOUT n command,
SET NOAUTOLOGOUT command, SETPRV UUO with bit 2000 set as desired
(if old Jbtprv 2000 XOR new Jbtprv 2000 = 1 then limit is updated) to set/
clear a timeout of 15 min., and CALLI ac,-146 where ac is limit in min.
Gettab -55 has been added to read the Jbtina word.

Scnser:
   New hang flag, (1B13), causes job to be hard killed without detaching.
Needed so that Logout can print message when autologout occurs.

/TODD 7-21-82

SCNSER: Changed TRMBYP to a 5 bit field for network terminal ID code (TIC).
 Also extended the table TRMTAB to 32 entries, making up something reasonable
 for the as yet undefined codes.  /WRS 8-2-82

/K27
----

/K28
----

Commod, Oncdsk, Refstr, Swamp, Filuuo:  Remove all code pertaining to
the obsolete swapping area.  /TODD 8-10-82

/K29
----

COMMON, COMMOD - Move another whole bunch of symbols from the CONF?? files
into COMMON and COMMOD, mostly inside IFCPU/IFNCPU conditionals. 
/DARREN 8-17-82

/K30
----

/K31
----

SCNSER - Comment out IFKMC conditional which ended up inside IFCPU(<KI,KL>)
conditional last time around, thus causing assembly error when building
monitor for KL system.  /DARREN 8-19-82

Frmser:  Add capability to pass lic. to new style Crefrm.  Setting flag
1b16 passes word after Logtab arg block ANDed with the parent's process
lic. to the child as its frmae lic.    /TODD 8-19-82

/K32
----

ONCDSK,REFSTR: Renamed RANNO in ONCDSK to RANHOM since all but one use
    was to hold the value of HOMRAN for packset-id checks.  Added RANNO
    as internal to REFSTR only for setting HOMRAN during the REFRESH
    command.  RANNO is set to a random # each time a command is entered
    to ONCE or ONCDSK.  /CARL 8-27-82

/K33
----


UUOCON, ERRCON, ERRMSG - Add frame stop and frame exit (equivalent
to EXIT and EXIT 1), CALLI -142 (frame error class 4, type 2) and
-147 (class 4, type 7).  Treats error code in AC as either octal (if
left half is zero) or SIXBIT (if not).  Also merged ERRMSG.MAC into
ERRCON.MAC.

/DARREN 8-28-82

/K34
----

COMMON - Replace EVAHI with EVMALC, which does ONCE-time core allocation
  across the pre-process area.  Adjust AC use in LINKDB to use proper
  AC's for EVMALC call.  Modify free-core allocation to allocate in
  ^D145 word blocks.  Use %ERR rather than %DDT in crash code when
  copying context pages.
S - eliminate exec virtual page for %DDT.
ONCE - Call EVASET to set up exec page map before setting up ONCE
  PCB's and calling FILMAN.  Modify OPCBST/OPCBCL to use existing
  map slots for ONCE PCB's rather than inventing them.  Modify
  routines which allocate EVM to call EVMALC.
ONCDSK, COMMOD - Call EVMALC to allocate STT storage, eliminate
  HICORE and CORGRB.

/DARREN 9-1-82


COMMOD, CONF?? - Move symbols FTA and FTATYP from CONF?? files into
  COMMOD, delete AXDDBS (no longer used), allow M.SBSZ (SNOOP
  histogram buffer size) to default to 0.

/DARREN 9-1-82

/K35
----

CORE1 - Add context page lock/unlock log in order to track down problem
of this monitor not working properly on KL processors.  /DARREN 9-21-82

/K36
----

FRMSER - Copy project code from parent to child in CREFRM.
/DARREN 9-22-82

SCNSER:  Added routine CHKYEL to TINASS UUO to check for condition prexisting
when interrupt is enabled to prevent yellow ball races.  /WRS 9-25-82

/K37
----

Frmser:  Change the exec XCT HRRM to an exec XCT MOVEM in FRMCFH
because HRRM doesn't work on KI's if the destination is to a register.
The register affected is in the kernel block not the user's.
/TODD 10-1-82

/K38
----



COMCON Modified the send routine in order to allow a user with either
op license or acct suprprv to talk with all persons in their gan. Two
additional registers were brought in to the SEND routine, and because
it was not known if they contained important information or not, their
contents were pushed on to the stack upon entry. This required modifying
all points at which the SEND routine exited in order that the stack was
the same upon exit.  /MATOKA 10-8-82

/K39
----

S.MAC: Change PVDINA to lh 400 from rh 2000.  Rh 2000 in priv. word
is used to indicate that a TRU budget is present.  This wasn't documented.
/TODD 12-1-82

COMCON - Give special prompt [!] if in PDP mode and any license set.
/DARREN 12-2-82

SETETY - Remove Sherman's SETE password.
/DARREN 12-7-82

ONCE,ONCDSK:  Modified the HELP texts and printed messages in the
        ONCE/FILES dialogues to remove the word "ONCDSK" from all
        places and to make the terminology clearer to operations.
        (This will now match the NEW documentation Rick Daniels is
        putting together for the /L operator mini-manuals.)
/CARL 12-8-82

/K40
----

COMMOD - Put back place-holders for obsolete entries that went away.
/DARREN 12-15-82

/K41
----

FRMSER: fixed problem causing assembler to generate bad code resulting
in .FOSVA not working.  Made JDSVTB table a fullword table rather than
halfword (making it 2 words longer).  Took out about a dozen instructions
to make up for it.  /WRS 1-14-83

UUOCON, ERRCON: changed name of fail exit, stop ...
    Fail Stop   is CALLI -147   is continuable   is HST 4,,7
    Fail Exit   is CALLI -142   is not continuable   is HST 4,,2
/WRS 1-15-83

/K42
----

FRMSER: Fixed misplaced flag in /K41 edit.  STARCL belongs on the
        CCL vector rather than the normal start vector for the
        .FOSVA frmop.   /CARL 2-4-83

/K43
----

ONCE - Split EVASET into two routines, so that high-seg page map set-up
and setting the lower boundary for EVM allocation can be done at different
points in ONCE.  The new routine EVMINI can be called more than once to
allow for the perversities of the FILES subsystem.  /DARREN 2-9-83

SEGCON, ERRCON - Fix old "TRANSMISSION ERROR" message to type out "I/O
error on file FILNAM.EXT".  /DARREN 2-9-83

CORE1 - Remove context page lock/unlock debug code, since problems seem
to be fixed.  /DARREN 2-9-83

/K44
----

SCNSER: added code to TATUUO (ATTACH UUO) and RETACH (UUO) to allow
user to specify forcing target frame to RUN state if not already so,
by calling SETRUN.  This may not make sense with certain other options
specified.  In particular, in RETACH, it will only work when the port
being moved is being attached as the command port.  The option is
selected as follows:
    bit 1B15 in the AC of an ATTACH UUO
    bit 1B4 in the bits field of a RETACH UUO argument block
/WRS 3-15-83

/K45
----

ONCDSK - When setting up for REFRESH, insure that RANHOM is non-zero before
  calling RWRHOM to re-write home pages, so that subsequent call to RDHOME
  will not generate the "MISSING OR INCONSISTENT PACK SET ID" message when
  using a virgin pack set.  /DARREN 3-18-83

/K46
----


REFSTR - Repair the home page retrieval pointer table which got broken
  back in K27/K28 - the table must match the home page exactly.
/DARREN 3-20-83

/K47
----

PICON:  Fixed typo from /K06 version - moving INTERN PGFUIO inside an
	IFNCPU(KI) conditional.
SIMKL:  Repeat 0'ed OUT the KL-simulator leaving the global symbol KL$SIM
	inside an IFCPU(KL) conditional.  If the KL-simulator is wanted,
	should be re-installed via a new config symbol, so that PARIS can
	continue to exclude it if desired.   /CARL  3-24-83

ONCE - Fix recently-introduced bug in PGY table allocation - CAVPGN is
  NOT the size of the PGY table if there are holes in core...
/DARREN 3-31-83

/K50
----


P034/M
------

/L01
----


Inserted console messages in ONCE and in SCNSER that describe what is
	happening during RELOAD
/SUTTOND 8-31-83

/L02
----


Modified CORE1 @ REMOV5+5 to handle context pages for frames other
	than the current frame.  This should fix the REMCHR+4 and REMCHR+11
	crashes.
/SUTTOND 8-31-83

/L03
----

Added Dave Sutton to SETE tables
/SUTTOND 9-19-83

/L04
----

Inserted code in routine DEVPHY: to crash if the user requests
device SYS and SYS cannot be found in the DDB chain
/SUTTOND 10-5-83

/L05
----

SCNSER: removed local variables THSTIM and MXTIM and made them external.
Code will now use the global THSTIM and MXTIM defined in COMMON and
appearing in NSWTAB+41 and NSWTAB+42 (gettabable) like it was supposed to.
/WRS 10-6-83

/L06
----

Enclosed test for disk unit off-line inside IFCPU (F3) conditional @
KONTOK: in ONCDSK module  /SUTTOND 10-20-83

/L07
----

Set EVASIZ to zero @ FILOPT+5 in ONCDSK so that EVMINI will get
called the 1st time EVMALC is called when allocating memory for
UDB's.
/SUTTOND 10-28-83

/L08
----

POP registers S and P1 off the stack in case of error in argument
to TALK command in SEND: routine in COMCON module
/SUTTOND 11-1-83

/L09
----

Deleted command to clear Cache Sweep Done Flag in routines CSUNL: and
CSVAL: in module PICON.  Not necessary since monitor waits every time
for Cache Sweep Done interrupt.
/SUTTOND 11-2-83

/L10
----

COMCON: Added "Special Command Mode" to run RCM program in case
PVSCMD is set and user types otherwise illegal command.
S.MAC: added PVSCMD==200,,0
FRMSER: Child now inherits RCM program on a CREFRM
Note: RCM program now receives monitor parsed command name in sixbit
in user AC 1.  This prevents problem caused by multiple rescan's.
/WRS 11-3-83

/L11
----

Removed Darren Price from SETE tables
/SUTTOND 11-7-83

/L12
----

Prevented loop in DB linkages by inserting a conditional @SRCFINI+6
in module FILFND
/SUTTOND 11-16-83

/L13
----

Modified ONCE and COMMON so that FRECOR will default to the available
executive virtual memory below ONCE.
/SUTTOND 11-21-83

/L14
----

Added code @ KEYSET+3 in PICON to crash if SCNINT is not called within
2000 tics(17 secs).
/SUTTOND 12-13-83

/L15
----

Amplified error messages in routine UNTDWN: in module ONCDSK
/SUTTOND 1-11-84

Added PVLOS - LogoutOnStop.  Added check at COMCON:STOP and CLOCK1:STOP1
to force LOGOUT if its set and job is being stopped.  Also check at command
dispatch time in COMCON and force RestrictedCommandMode if PVLOS is set.
Lastly, added code to FRMSER:PSHPRV and UUOCON:SETPRV to allow user to set,
but never clear PVLOS.  /WRS 1-20-84

/L16
----

Changed COMCON so panic logouts (like EXIT in a logged out job and
EXIT or STOP in a PV.LOS job) happen immediately rather than being
postponed until the next command input.  /WRS 1-27-84

/L17
----

Modified default open files/frame(OPNFPF) in COMMOD to be ^D10
so that there will be plenty of room for ATB's & FNB's in systems
with more than 1 Meg.  Specify smaller OPNFPF in the CONFnn file
for systems with less memory if necessary.    /SUTTOND 1-31-84


/L18
----

Deleted Adele Newmon from SETETY tables.
/SUTTOND 2-6-84

/L19
____

Modified SKIPGE to MOVE at CLRACH+6 in FILUUO, eliminating slow
crash since FNBALT(xx) is initialized to -1 for debug purposes
/SUTTOND 2-23-84

/L20
____

Inserted cache sweep in CRASHX: routine in COMMON so that memory
in the crash file looks the same as it did to the CPU at the
time fo the crash.  /SUTTOND 2-29-84

/L21
----

Entered test for beyond last legal priority bit in LDBOUT(U) in
routine SCOTTY: at  GOLIN+2.  Don't do output on line if test fails.
/SUTTOND 3-2-84

/L22
----

CLOCK1: Modified inactivity timer code @INACT2+2 to use one less
        instruction, and eliminate use of T2.  Also changed comments
        for better understanding of the routine.  /CARL 4-20-84

/L23
----

ONCE:   Change CONSOLE command to set CTY flag, Added NETWORK command
        to clear CTY flag.  Use GO, FULL, MANUAL or READONLY to bring
        up the system.

CTYSIM: Allow lower-case on all commands, added ctrl-z ? to print a
        short help text of legal ones.  /CARL 4-23-84

/L24
----

P034/L
------

/K01
----

S: Changed the IFCPU and IFNCPU macros to "repeat cpzz" instead of
   "repeat cpzz," so that IFCPU(x),< ... >  would not generate two
   commas.  /CARL 12-28-81

PICON,ONCE: Fixed Typoe of "IFCPU (x),< mumble >,end ..." which should
   have been "IFCPU (x),< mumble > ; end ... "  (Yes, a comma and not
   a semicolon).  /CARL 12-28-81

UUOCON: Fix X macro used in WAYS macro.  Put a "," between the IFB,IFNB
   and the code to be generated.  Also, add missing ")" close-paren to
   the last item in the WAYS macro (fixed undefined symbol).
   /Carl 12-28-81

UUOCON: Removed SEXTERNAL symbol references SYDFTA and SYDMTX and made
   them conditional on non-zero definitions of the configuration symbols
   FTAUN (# of FTA's) and MAGUN (# of MTA's).

UUOCON: Magically transformed .ELINK into .LNKEND for the new MACRO,
   leaving .ELINK alone for the old MACRO %46.

CTYSIM,CIOPR,KMCSER,DR11C,DZKON,ONCE: Removed SEXTERNAL references to
   DZDO,DRDO,KMCDO,DZINI,DRINI,KMCINI,KMCSMN,KMCCMN and made them all
   conditional on IFKMC.  DZDO,DRDO and KMCDO are defined in CTYSIM as
   always.  /CARL 12-28-81

SIMKL,ONCE: Removed SEXTERNAL references to ONCGO,MONDEB,& PATSIZ and
   added the symbol KL$SIM in the simulator which is checked for non-zero
   by ONCE under an IFCPU (KL) conditional.  Code was added to the patch
   code in the simulator to set KL$SIM non-zero.  /CARL 12-29-81

DDT: Commented out the line "SEXTERN OVTAB." in DDT.  This symbol is not
   even referenced once in the source. (OR in *.mac in M33 or MPL) except
   for LOADER.MAC which is only generating a DUMMY location OVTAB. if it
   doesn't exist already (Special case!).  /CARL 12-29-81

Note:  The monitor now has NO S-EXTERNALS in it.  It will now load using
LINK-10.  With the exception of external POINTer references, the monitor
will also assemble under MACRO %53B.   /CARL 12-29-81

COMMON: (UUOCON,FRMSER,COMCON) Moved pointer UPYPSR from UUOCON into
   COMMON and added corresponding pointers USYPSR & UXYPSR for %UPS
   and %UPX.  All 3 are internal and referenced elsewhere at least once.
   /CARL 12-30-81

COMMON: (SCHED1,CORE1,UUOCON,COMCON,PICON,ONCE) Moved pointers from
   literals in many modules into COMMON where the symbols used are defined.
   New symbols are UPYPTx,UPYPXx,USYPTx,USYPXx,UXYPTx and EPYPSx where <x>
   is either "N" or "M" depending upon whether %xxx.N or %xxx.N-1 is used
   as argument to the macros.  /CARL 12-30-81

COMMON,CORE1: Moved macro definition UPTPTR from CORE1 into S so that it
   can be used where necessary.  Moved the only use of it into COMMON with
   the pointers UPYPTx as mentioned above.  Also: *** NOTE *** I changed
   the name of the macro (UPTPTR) to (UPYPTR) so as not to conflict with
   the UPT symbol UPTPTR.  /CARL 12-31-81

COMMOD,CORE1: Moved pointers from literals into COMMOD for their def's
   and created 2 more symbols RB1PNO and BA1NBB which are near to RBYPNO
   and BAYNBB in definition, but not quite!  /CARL 12-31-81

COMMON,MAPIO,CORE1: Defined some more bit masks in COMMON so that less
   polish is needed for adding bit definitions in other modules. New
   symbols: LMMMXW, LMMSUP, LMMRED, LMMRDW for LMAP bit configurations.
   /CARL 12-31-81

COMMOD,FILRIB: More about pointers: RBYUNA, RBYUNR and RBYUNV for getting
   the unit from ATBRIB(P2), DRBRIB(P1) and DEVRIB(F).  /CARL 12-31-81

FRMSER: Changed BYTE (18) arg,0  to XWD arg,0 inside JDSMAC macro to fix E
   errors in the new macro.  comment used to say something about a bug in
   the old MACRO, but it assembles ok with either version at present.  Also
   changed reference to literal to use UXYPSR in COMMON.  /CARL 12-31-81

FILUUO: Fixed [XWD BYTE (5)0 (3)CPRRED (10)1 (8)0 (10)%COW.N+CNVVPN] to
   simply [<CPRRED>B7+1B17+%COW.N+CNVVPN] to work with the new MACRO.
   Macro-46 simply allowed that construct. Amazing!  /CARL 12-31-81

COMMOD,FILFND: Defined SPTNMM to be SPTNME justified to SPNNFE so we don't
   have to play games with externals.  /CARL 12-31-81

ACTSER: Changed the ATB macro to use Xwd rather than BYTE and added
   a ",0" to the end of each line where a 4th argument was wanted.
   Put angle brackets "<>" around constants used in arithmetic with
   an external.  Fixed "Polish too complex" error.  /CARL 12-31-81


/K02
----

COMMON, CLOCK1, UUOCON: Removed job tables JBTRMT and JBTRMC (no longer used).
/DARREN 1-6-82


CONF??.mac, COMMON: The following symbols have been moved from CONF??.MAC to
COMMON or deleted entirely:  SYSDEV,SYSNAM,SYSDAT,RP10N,RA10N,C0FHN,C0DPN,
C0MDN,RD10N,NUMPRT,COREN,SEGNX,CR10N,CDPN,SPCINT,SPCDDB,SPCSAV.
/DARREN 1-10-82

/K03
----

COMCON: In JOBKL, delay call to TTYKIL until after returning from KILUPT.
This should prevent job from being rescheduled with TTYTAB(J)=0, which int
turn should prevent any more crashes at SCNSER:STTLK+6.
/DARREN 1-11-82

COMCON: Set Errflg in P3 instead of clearing J to indicate error at COR2+2.
Error happens when CORE command requires hiseg to be deleted.  Problem
was discovered by noticing that SYSTAT followed by CORE 5 (with SY lic)
crashes system.  /TODD 1-19-82

Errcon: Don't set up previous context F when Adrerr is called.  Fixes 
bug that would either crash system or print a bogus device name in
address check error message.  Sys would crash if user ac 4 had a value
such that an exec mpe would occur.  /Todd  /TODD 2-1-82

/K04
----

COMMON - Add new job table JBTSCA which contains TRU scaling argument,
	plus byte pointers to the 4 9-bit fields.
CLOCK1 - Modify GTCGSZ (Get Charging Size) to use TRU scaling args if present.
UUOCON - Modify CLKTRU to do size-dependent and size-independent components
	seperately, scaling size-independent according to JBTSCA args.  Add
	XCHARG function 7 for TRU scaling.
/DARREN 2-9-82

/K05
----

COMMON: Allow FCWDS to be defined in Conf.  /TODD 2-10-82

/K06
----

PICON: Added Internal label PGFUIO just prior to PGFAIL with contents
       PC.UIO,,PGFAIL to be used by ONCE inside IFCPU(KI) conditional
       for getting there on page-fail conditions.  /CARL 2-18-82

ONCE:  Changed all occurrances of [EXTERNAL] and [POLISH] to non-literals
       so that MACRO 53B can be used for assembly.  /CARL 2-18-82

/K07
----

Comcon: change UNDEL command to UNDELETE.  /TODD 2-23-82

FILIO - Add counter OHTREP to count number of times INSOHT is called more
than once for the same disk page; also halfword table OHTCPN for Core Page
Number of disk page entered in OHTTAB.  /DARREN 2-23-82

ONCE:  Modified routines Evaset and Evaclr and added Evahi to allow
	dynamic data structure allocation to start at next pg after
	initial Syssiz.  Previously started at %Min (pg 400).  Evahi
	determines if virtual address has transitioned from below per-
	process area to within or above it.  If it has, it sets Evasiz
	to %Min.  
COMMON, ONCE:  Call Evahi after Evasiz is modified.  Repeat allocation 
	code for a particular data structure if it couldn't fit below pg
	340 and addr wasn't previoulsy above %Min.  /TODD 2-25-82

/K08
----

KSSYM,KSIORG: Updated XCREF/RCREF to .XCREF/.CREF so that either macro
    can assemble the sources for a KS processor. /Carl 2-Mar-82

KSSYM,ONCE: Moved WRHSB from ONCE to KSSYM where it belonged. /Carl 2-Mar-82

ONCE: Removed more literals so that ONCE would assemble for the KS.  The
    Old MACRO %46 would not fold literals on pass 2 tha same as pass 1,
    thus we got "P" errors during assembly.
      /CARL 3-2-82

/K09
----

ONCE: Text message at HLPCMD was re-inserted to catch illegal commands
      given to the ONCE> prompt.  Removed originally because it was too
      verbose.  Now skipped upon entry.  Message:
      ?Unrecognized command - Please type HELP for help.
        /CARL 3-3-82

IOCSS:	Push F at CLOSE3 and pop at UCLS3 so can tell if buffered io
was being done so can determine whether to restore previous pc.uio state.
Solves XBASIC Getseg error problem.  /TODD 3-3-82

COMMOD, CONF??.EXP - Move a few more symbols out of the config files -
  C1FHN, C1DPN, C1MDN (defined only on a few VF KI's and always to 0)
/DARREN 3-5-82

S,FILUUO - Add DMOVPG to disk DDB dispatch table.
APXKON - Ernie changes - ?
CORE1 - Add "validate even if private" flagg VL.VPP.
IOCSS - Add CHANIO function 47 - VMOVPG.
SWAMP - Make UPDAC0 an external entry point.
SIMIO - Don't undo 4 disk-block charge after SIMCRE, no longer accrued.
FILFND - (quote) "Add routine DECUNS to decrement ATBUMC & ATBMXW, and
  remove SPT entry for unshared DP so it can be moved to another file."
MAPIO - All the good stuff:
  Add VM kernel routine KMOVPG to "take a page which is currently mapped
    and not part of a file and cause it to be mappable from the specified
    position of a file open on the channel."
  Add routine LOKHPW, called (by KFCRE & KMOVPG) when holding only the
    atomic file lock and needing the write lock to manipulate a slot past
    highest page written (HPW).
  Add entry SWEPRH to SWEEP to sweep file with real holes despite TITO
   crock; modify SWEEP to use VMOVPG if sweeping 1 real page (SIMIO case).
/DARREN 3-9-82

/K10
----

IOCSS, CORE1:  Call Uniupt from Reprlu to release %upt lock if held
by current frame and not complain if not.  Delete Reprl1 code because
can always get upt lock (eventually).  /TODD 3-10-82

/K11
----

CONF??, COMMON: (KS only) Move definitions of LPTN, LPRUN, and LPRVEC
from CONF?? to COMMON, enclosed by IFCPU(KS), since they're the same on
all 2020's.  Remove VECMIN, VECMAX, VECNUM, TBISTR, and TBIEND as perhaps
the silliest consistency check ever devised.
COMMON, ONCE: Use size of TBISAV table to init loop counter in SETUBT.
/DARREN 3-13-82

COMMON - Remove two more job tables that appear to be unused - JBTCB2 and
  JBTIDN - apparently used by CLUBS at some point in history.  /DARREN 3-18-82

/K12
----

Scnser: Have Newjer zap tty after printing out error message.  Previously
job capacity exceeded would not kill port and this eventually would
cause a crash in addition to the nuisance of echoing user name and
leaving port in limbo.  /Todd  /TODD 4-8-82


S, FILUUO: Install new close flag, CLSDMP=200, to set file dumped bit.
This will allow TITO to set file dumped without doing a rename and
potentially changing some other rib data.  /TODD 4-13-82

/K13
----

UUOCON - Time to remove EUTHAN hack from SETNAM.
/DARREN 4-16-82

FILIO - One-line fix to INSOHT change.
/DARREN 4-19-82

COMCON: added POP command - special form of ATTACH to attach you to your
parent (if any) and log out current job.  /WRS 4-20-82

COMCON: updated several messages to talk about frames not jobs.  /WRS 4-20-82

COMCON: changed attach code to check for attached frame license greater than
source frame license.  /WRS 4-20-82

FILUUO: changed LICMSK to return the current license in the case where
the requested license is greater than the current (for example it used
to be that LICMSK(WA,WF)=0, rather now LICMSK(WA,WF)=WF)  /WRS 4-20-82

/K14
----

COMCON: fixed POP command to handle errors more gracefully  /WRS 4-20-82

/K15
----

COMCON: more fixes to ATTACH and POP license restrictions  /WRS 4-20-82

IOCSS - Fix function code check, broken when NXTCHN was added.
/DARREN 4-21-82

COMCON - Change INITIA command to .INITI for obscure and perverse
  reasons.  /DARREN 4-21-82

MAPIO - Fix KMOVPG for case where file page argument is -1 (insert after
  current EOF).  /DARREN 4-27-82

/K16
----

S: Change CLSDMP to be 100000 from 200 to avoid conflict with possible
DEC expansion.  /TODD 4-30-82

ONCDSK: Modified STSREF (REFRESH) to force a call to UPDHOM after the
        refresh is complete.

ONCDSK: Split GETRAN into SETRAN (start timer) and GETRAN (stop timer
        and read number into RANNO) and call both routines whenever
        CMDSCN is called by ONCE or ONCDSK so that the clock is always
        running while waiting for command input.  This solves the KS,
        KL problem doing a refresh and setting the pack-set id to 0.
          /CARL 5-5-82

/K17
----

ONCDSK: Removed erroneous calls to SETCHG which may have clobbered
        something since U was not guaranteed to be setup in /K16.
        Re-Inserted LSH to zap low order 12 bits in GETRAN since a
        KL always returns 0 [Inside IFCPU(KL)].
Note: REFSTR rewrites the HOM pages before it returns to ONCDSK, so
      no other forced rewrites are necessary in ONCE.
      /CARL 5-7-82

ONCDSK:  Fixed CMDSCN routine to skip return on "NO" answer to the
         "are you sure" question, so that it doesn't complain about
         commands which require verification as "unrecognized".
ONCDSK:  Added local symbol CMDMSG which if non-zero will only type
         the "Are you sure" question on verification rather than the
         verbose help text put in for operators to read.  Mainly for
         debugging use when jumping in and out of ONCE/ONCDSK.
/CARL 5-8-82

FRMSER - Add .FRMOP 41 (Stop Frame) - simulates ^C on a frame.  /DARREN 5-25-82

/K18
----

DDT: Changed code which checked for processor type to check FOONLY using

DDT: Changed F3 processor check from AOBJN test to PUSH test for KA/F3's.
     Ac/ 0,,-1  PUSH Ac,0  (1,,0 no carry; 2,,0 otherwise) TLZ Ac,1 to have
     all good DEC hardware return 0.  /CARL 5-29-82

/K19
----

COMCON: changed ATTCHK (check source / target frame license for attach) to
check frame license rather than process license (ooops).  /WRS 6-7-82

SCNSER: Only negotiate for BIO ports if on a Tymnet base.  I.e., if a
KI or KL.  /TODD 6-22-82

/K20
----

Mapio:  Return valid error code from sweep vmovpg failure.  Solves crashes
caused by copying a file into a full directory.  /TODD 7-13-82

/K21
----

FRMSER: Add new format .FOCFM call, allowing new JBTPPN = caller's
   AUN, PVYMSK bits in JBTPRV to be different, plus provision for
   running LOGINN in the child frame.
	NEWWAY:	MOVSI	ac,.FOCFM
		FRMOP	ac,BLOCK
		  error return
		normal return
	BLOCK:	flags,,count
		exp JBTPPN,JBTPRV,JBTAUN,JBTUNM,JBTUN1
	;FLAGS
	CF.OLD== 1B0			; this word is -cnt,,adr (old way)
	CF.LOG== 1B17			; run LOGINN in child
FRMSER: Add .FRMOP 42 - Force command on frame, this was the chosen
   generalization of "force INITIA command", plus new .FRMOP error
   code 37 (illegal command).
UUOCON, FRMSER: Move code for CHPRJ calli (change project code) from
   UUOCON to FRMSER and add a FRMOP entry point (.FRMOP 43).
COMCON: Add routine to return forced command index given SIXBIT string,
   called by .FRMOP 42.
 - Allow LOGINN to be run in a detached frame.
 - Have POP command run LOGOUT, remove CPOP routine.
 - Add PCOM & DCOM commands (both run PCOM) and PEAK command (runs PEAK).
 - Remove PCHECK command and code.
 - Add .USESTAT command to display incremental data.
SCNSER: In normal character mode, have ^T force .USESTAT command if
   LDBDCX<LXLRTC> is set.
 - Add "TTY [NO] RTCOMP" & AUXCAL 101 to set/clear LXLRTC.


/K22
----


/K24
----

/K24
----

Assigned JP.MAI (1b8) in priv word to indicate (new) mail waiting.  Added
SETMAI UUO (CALLI -145) using most of SETMAL as a subroutine.  Added code
in SCNSER to print "[Mail Waiting]" if JP.MAI set.  Note:  None of the
above invalidates any of the JP.MAL (old RPG mail) stuff.
/DWS 7-19-82

/K25
----

/K26
----

Common, Clock1, Uuocon:
   Add Inactivity Timeout feature.  New job table, JBTINA, keeps track
of user specified inactivity timeout (0 if off), time since job was
last active, and whether the inactivty limit was hit.  Once-a-minute code
in Clock1 increments inactivity counters.  If the time-limit is hit, the
process will be evicted if enabled for eviction otherwise it will be
hung (killed regardless of hang/zap action specified by user).  Changing
the timeout limit is accomplished with the SET AUTOLOGOUT n command,
SET NOAUTOLOGOUT command, SETPRV UUO with bit 2000 set as desired
(if old Jbtprv 2000 XOR new Jbtprv 2000 = 1 then limit is updated) to set/
clear a timeout of 15 min., and CALLI ac,-146 where ac is limit in min.
Gettab -55 has been added to read the Jbtina word.

Scnser:
   New hang flag, (1B13), causes job to be hard killed without detaching.
Needed so that Logout can print message when autologout occurs.

/TODD 7-21-82

SCNSER: Changed TRMBYP to a 5 bit field for network terminal ID code (TIC).
 Also extended the table TRMTAB to 32 entries, making up something reasonable
 for the as yet undefined codes.  /WRS 8-2-82

/K27
----

/K28
----

Commod, Oncdsk, Refstr, Swamp, Filuuo:  Remove all code pertaining to
the obsolete swapping area.  /TODD 8-10-82

/K29
----

COMMON, COMMOD - Move another whole bunch of symbols from the CONF?? files
into COMMON and COMMOD, mostly inside IFCPU/IFNCPU conditionals. 
/DARREN 8-17-82

/K30
----

/K31
----

SCNSER - Comment out IFKMC conditional which ended up inside IFCPU(<KI,KL>)
conditional last time around, thus causing assembly error when building
monitor for KL system.  /DARREN 8-19-82

Frmser:  Add capability to pass lic. to new style Crefrm.  Setting flag
1b16 passes word after Logtab arg block ANDed with the parent's process
lic. to the child as its frmae lic.    /TODD 8-19-82

/K32
----

ONCDSK,REFSTR: Renamed RANNO in ONCDSK to RANHOM since all but one use
    was to hold the value of HOMRAN for packset-id checks.  Added RANNO
    as internal to REFSTR only for setting HOMRAN during the REFRESH
    command.  RANNO is set to a random # each time a command is entered
    to ONCE or ONCDSK.  /CARL 8-27-82

/K33
----


UUOCON, ERRCON, ERRMSG - Add frame stop and frame exit (equivalent
to EXIT and EXIT 1), CALLI -142 (frame error class 4, type 2) and
-147 (class 4, type 7).  Treats error code in AC as either octal (if
left half is zero) or SIXBIT (if not).  Also merged ERRMSG.MAC into
ERRCON.MAC.

/DARREN 8-28-82

/K34
----

COMMON - Replace EVAHI with EVMALC, which does ONCE-time core allocation
  across the pre-process area.  Adjust AC use in LINKDB to use proper
  AC's for EVMALC call.  Modify free-core allocation to allocate in
  ^D145 word blocks.  Use %ERR rather than %DDT in crash code when
  copying context pages.
S - eliminate exec virtual page for %DDT.
ONCE - Call EVASET to set up exec page map before setting up ONCE
  PCB's and calling FILMAN.  Modify OPCBST/OPCBCL to use existing
  map slots for ONCE PCB's rather than inventing them.  Modify
  routines which allocate EVM to call EVMALC.
ONCDSK, COMMOD - Call EVMALC to allocate STT storage, eliminate
  HICORE and CORGRB.

/DARREN 9-1-82


COMMOD, CONF?? - Move symbols FTA and FTATYP from CONF?? files into
  COMMOD, delete AXDDBS (no longer used), allow M.SBSZ (SNOOP
  histogram buffer size) to default to 0.

/DARREN 9-1-82

/K35
----

CORE1 - Add context page lock/unlock log in order to track down problem
of this monitor not working properly on KL processors.  /DARREN 9-21-82

/K36
----

FRMSER - Copy project code from parent to child in CREFRM.
/DARREN 9-22-82

SCNSER:  Added routine CHKYEL to TINASS UUO to check for condition prexisting
when interrupt is enabled to prevent yellow ball races.  /WRS 9-25-82

/K37
----

Frmser:  Change the exec XCT HRRM to an exec XCT MOVEM in FRMCFH
because HRRM doesn't work on KI's if the destination is to a register.
The register affected is in the kernel block not the user's.
/TODD 10-1-82

/K38
----



COMCON Modified the send routine in order to allow a user with either
op license or acct suprprv to talk with all persons in their gan. Two
additional registers were brought in to the SEND routine, and because
it was not known if they contained important information or not, their
contents were pushed on to the stack upon entry. This required modifying
all points at which the SEND routine exited in order that the stack was
the same upon exit.  /MATOKA 10-8-82

/K39
----

S.MAC: Change PVDINA to lh 400 from rh 2000.  Rh 2000 in priv. word
is used to indicate that a TRU budget is present.  This wasn't documented.
/TODD 12-1-82

COMCON - Give special prompt [!] if in PDP mode and any license set.
/DARREN 12-2-82

SETETY - Remove Sherman's SETE password.
/DARREN 12-7-82

ONCE,ONCDSK:  Modified the HELP texts and printed messages in the
        ONCE/FILES dialogues to remove the word "ONCDSK" from all
        places and to make the terminology clearer to operations.
        (This will now match the NEW documentation Rick Daniels is
        putting together for the /L operator mini-manuals.)
/CARL 12-8-82

/K40
----

COMMOD - Put back place-holders for obsolete entries that went away.
/DARREN 12-15-82

/K41
----

FRMSER: fixed problem causing assembler to generate bad code resulting
in .FOSVA not working.  Made JDSVTB table a fullword table rather than
halfword (making it 2 words longer).  Took out about a dozen instructions
to make up for it.  /WRS 1-14-83

UUOCON, ERRCON: changed name of fail exit, stop ...
    Fail Stop   is CALLI -147   is continuable   is HST 4,,7
    Fail Exit   is CALLI -142   is not continuable   is HST 4,,2
/WRS 1-15-83

/K42
----

FRMSER: Fixed misplaced flag in /K41 edit.  STARCL belongs on the
        CCL vector rather than the normal start vector for the
        .FOSVA frmop.   /CARL 2-4-83

/K43
----

ONCE - Split EVASET into two routines, so that high-seg page map set-up
and setting the lower boundary for EVM allocation can be done at different
points in ONCE.  The new routine EVMINI can be called more than once to
allow for the perversities of the FILES subsystem.  /DARREN 2-9-83

SEGCON, ERRCON - Fix old "TRANSMISSION ERROR" message to type out "I/O
error on file FILNAM.EXT".  /DARREN 2-9-83

CORE1 - Remove context page lock/unlock debug code, since problems seem
to be fixed.  /DARREN 2-9-83

/K44
----

SCNSER: added code to TATUUO (ATTACH UUO) and RETACH (UUO) to allow
user to specify forcing target frame to RUN state if not already so,
by calling SETRUN.  This may not make sense with certain other options
specified.  In particular, in RETACH, it will only work when the port
being moved is being attached as the command port.  The option is
selected as follows:
    bit 1B15 in the AC of an ATTACH UUO
    bit 1B4 in the bits field of a RETACH UUO argument block
/WRS 3-15-83

/K45
----

ONCDSK - When setting up for REFRESH, insure that RANHOM is non-zero before
  calling RWRHOM to re-write home pages, so that subsequent call to RDHOME
  will not generate the "MISSING OR INCONSISTENT PACK SET ID" message when
  using a virgin pack set.  /DARREN 3-18-83

/K46
----


REFSTR - Repair the home page retrieval pointer table which got broken
  back in K27/K28 - the table must match the home page exactly.
/DARREN 3-20-83

/K47
----

PICON:  Fixed typo from /K06 version - moving INTERN PGFUIO inside an
	IFNCPU(KI) conditional.
SIMKL:  Repeat 0'ed OUT the KL-simulator leaving the global symbol KL$SIM
	inside an IFCPU(KL) conditional.  If the KL-simulator is wanted,
	should be re-installed via a new config symbol, so that PARIS can
	continue to exclude it if desired.   /CARL  3-24-83

ONCE - Fix recently-introduced bug in PGY table allocation - CAVPGN is
  NOT the size of the PGY table if there are holes in core...
/DARREN 3-31-83

/K50
----
P034/M
------

/L01
----

ONCE, SCNSER - Inserted console messages that describe what is
	happening during RELOAD.  /SUTTOND 8-31-83

/L02
----

CORE1 - modified code @ REMOV5+5 to handle context pages for frames other
	than the current frame.  This should fix the REMCHR+4 and REMCHR+11
	crashes.  /SUTTOND 8-31-83

/L03
----

Added Dave Sutton to SETE tables.  /SUTTOND 9-19-83

/L04
----

IOCSS:	Inserted code in routine DEVPHY: to crash if the user requests
	device SYS and SYS cannot be found in the DDB chain.
	/SUTTOND 10-5-83

/L05
----

SCNSER: removed local variables THSTIM and MXTIM and made them external.
Code will now use the global THSTIM and MXTIM defined in COMMON and
appearing in NSWTAB+41 and NSWTAB+42 (gettabable) like it was supposed to.
/WRS 10-6-83

/L06
----

ONCDSK: Enclosed test for disk unit off-line inside IFCPU (F3)
	conditional @ KONTOK.  /SUTTOND 10-20-83

/L07
----

ONCDSK: Set EVASIZ to zero @ FILOPT+5 so that EVMINI will get
	called the 1st time EVMALC is called when allocating memory
	for UDB's.  /SUTTOND 10-28-83

/L08
----

COMCON: POP registers S and P1 off the stack in case of error in
	argument to TALK command in SEND: routine.  /SUTTOND 11-1-83

/L09
----

PICON:	Deleted command to clear Cache Sweep Done Flag in routines CSUNL
	and CSVAL.  Not necessary since monitor waits every time for
	cache-sweep-done interrupt.  /SUTTOND 11-2-83

/L10
----

COMCON: Added "Special Command Mode" to run RCM program in case
	PVSCMD is set and user types otherwise illegal command.
S.MAC:  added PVSCMD==200,,0
FRMSER: Child now inherits RCM program on a CREFRM

Note: RCM program now receives monitor parsed command name in sixbit
in user AC 1.  This prevents problem caused by multiple rescan's.
/WRS 11-3-83

/L11
----

Removed Darren Price from SETE tables.  /SUTTOND 11-7-83

/L12
----

FILFND: Prevented loop in DB linkages by inserting a conditional
	at SRCFINI+6.  /SUTTOND 11-16-83

/L13
----

Modified ONCE and COMMON so that FRECOR will default to the available
executive virtual memory below ONCE.  /SUTTOND 11-21-83

/L14
----

PICON:  Added code @ KEYSET+3 to crash if SCNINT is not called within
	2000 tics(17 secs).  /SUTTOND 12-13-83

/L15
----

ONCDSK: Amplified error messages in routine UNTDWN.  /SUTTOND 1-11-84

Added PVLOS - LogoutOnStop.  Added check at COMCON:STOP and CLOCK1:STOP1
to force LOGOUT if its set and job is being stopped.  Also check at command
dispatch time in COMCON and force RestrictedCommandMode if PVLOS is set.
Lastly, added code to FRMSER:PSHPRV and UUOCON:SETPRV to allow user to set,
but never clear PVLOS.  /WRS 1-20-84

/L16
----

Changed COMCON so panic logouts (like EXIT in a logged out job and
EXIT or STOP in a PV.LOS job) happen immediately rather than being
postponed until the next command input.  /WRS 1-27-84

/L17
----

Modified default open files/frame(OPNFPF) in COMMOD to be ^D10
so that there will be plenty of room for ATB's & FNB's in systems
with more than 1 Meg.  Specify smaller OPNFPF in the CONFnn file
for systems with less memory if necessary.    /SUTTOND 1-31-84


/L18
----

Deleted Adele Newmon from SETETY tables.  /SUTTOND 2-6-84

/L19
----

FILUUO: Modified SKIPGE to MOVE at CLRACH+6, eliminating slow
	crash since FNBALT(xx) is initialized to -1 for debug
	purposes.  /SUTTOND 2-23-84

/L20
----

COMMON: Inserted cache sweep in CRASHX routine so that memory in
	the crash file looks the same as it did to the CPU at the
	time of the crash.  /SUTTOND 2-29-84

/L21
----

SCNSER: Entered test for beyond last legal priority bit in LDBOUT(U)
	in routine SCOTTY at  GOLIN+2.  Don't do output on line if test
	fails.  /SUTTOND 3-2-84

/L22
----

CLOCK1: Modified inactivity timer code @INACT2+2 to use one less
        instruction, and eliminate use of T2.  Also changed comments
        for better understanding of the routine.  /CARL 4-20-84

/L23
----

ONCE:   Change CONSOLE command to set CTY flag, Added NETWORK command
        to clear CTY flag.  Use GO, FULL, MANUAL or READONLY to bring
        up the system.

CTYSIM: Allow lower-case on all commands, added ctrl-z ? to print a
        short help text of legal ones.  /CARL 4-23-84

/L24
----

PICON: changed EVICT UUO to set PV.LOS (logout on stop) so an evicted job
that gets sick and halts or doesn't know any better and exits will get
logged out.    /WRS 5-22-84

/L25
----

SCHED1: changed default setting for MAPQUE (JBTWRS) feature to off.
	/WRS 6-6-84

PICON:	Removed edit /L14, code at KEYSET+3 which caused a crash if
	routine SCNINT was not called within so many (2000) tics.
	We don't need to MAKE the system "crash" here!  /CARL 6-7-84

ONCDSK: Modified CMDSCN routine, near CMDSC5 to disregard verification
	if CMDMSG is non-zero, and added new bit for MKTBL macro AB.CVR
	to ignore verify bit (AB.VER) if CTYDO flag is set (for CONSOLE).

ONCE:	Defined AB.CVR for ONCE/ONCDSK command table bits, set the bit
	for MANUAL and READONLY.  Modified CONSOLE and NETWORK commands
	to give an acceptance response and a reminder to type one of the
	system startup commands: GO, FULL, MANUAL, READONLY.

	Modified SUTTOND's amplified INITIA message to only print when
	INITIA is really being forced, i.e. TLNN (STAUTO),STATES
	/CARL 6-7-84

	Fixed TYPO which broke abbreviation of CONSOLE command by
	mispelling NETWORK as <CONSOLE>.  Also changed code at CHGSYS
	to allow larger than 255 as host number on micro-node bases.
	KI/KL's still have 255 maximum.  /CARL 6-8-84

S.MAC:	Changed SIZONC from 4 to 5 in MAPONC call for KS.  /CARL 6-13-84

/L27
----

Removed Lois Lindley from Sete and added Osman Guven.  /OSMAN 6-20-84

/L30
----

ACTSER: Copy UPTLOG for new frame into supervisor info when writing the
	accounting record for .FOCFM (we are assuming that the LOGIN UUO
	handles this correctly elsewhere).  /OSMAN 7-6-84

/L31
----

F3TSER: Fixed radix in formula which calculates byte pointer into EPT page map
	to ^D18 and ^O1000 to avoid confusion.  The assembler defaults to ^D
	in the offset part of the pointer, so the calclation was always wrong.
        /CARL 7-8-84

P034/N
------

/M01
----

Mis-release by Dave Sutton caused confusion.  So, to avoid further
confusion as to which /M this is, it has been decided to skip the
release of P034/M altogether and proceed to the next release.

P034/P
------

/N01
----

COMMON, COMCON, CLOCK1 and UUOCON:  Renamed pointer JBYLIM for inactivity
	time-out to JBYINA so that JBYLIM could be used for TRU-limit
	interrupt pointer.  /CARL

COMMON: Added interrupt cause (16) and pointer JBYLIM for the interrupt
	channel.  Points to last 6 bits of UPTTP1.  TRU limit is stored
	in JBTLIM(J) as per "SET LIMIT" command, UUO not yet defined.
	/CARL 6-15-84

/N02
----

COMMON: Added new job table JBTINT to hold interrupt channel assignments
	which were previously in LH of JBTIOA and RH of JBTSLC.  Also
	moved new TRU interrupt from UPTTP1 here since it must be in main
	memory for clock level.  Above changes affect byte pointers in
	table INTBYP.  /CARL 6-22-84

PICON:  Removed unnecessary references to JBTIOA,JBTSLC and changed code
	at APRENB/APRDIS to clear JBTINT instead.  Same change done in
	INTADR code at INTAD1+5.  Also cleared %UPT+UPTTP1 here since it
	seemed like it "ought" to be done here as well.  /CARL 6-22-84

PICON:  Removed label INTAD3 by changing test condition and calling an
	existing routine instead of jrst'ing past code block.  /CARL 6-22-84

CLOCK1: Added code to fire the TRU interrupt if enabled when the user
	exceeds his limit instead of just falling through to ERRTLE.
	Added label CIP5B for call to ERRTLE just prior to CIP6.
	/CARL 6-22-84



/N03
----

COMCON:	Set maximum of ^D3435973 for SET LIMIT and complain if more is
	specified.  Changed SETLIM references to SETTRU.  Now sets both
	JBTLIM(J) and JBTSLM(J) to the current "maximum" limit.

COMMON:	Replaced table JBTTRU with JBTSLM to contain the maximum TRU
	limit for the frame.  JBTLIM is used for the current TRU limit
	from now on and is checked at clock level, reset from JBTSLM on
	RESET UUO (or frame reset) or SETLIM uuo with argument of 0.

UUOCON:	Added SETLIM (CALLI -150) functions to set/reset (.SLSET), extend
	(.SLEXT) and increment (.SLINC) the current TRU limit.  GETTAB
	table -56 (.GTSLM) returns the limit set by the console, and the
	old .GTLIM (GETTAB -30) returns the current limit as before.
        /CARL 7-21-84

/N04
----

CLOCK1:	Added JBTSLM to CLRJBT routine, fixed critical place test by
	loading XWD JACCT,KJP instead of JACCT+KJP in TRU check routine.
        /CARL 7-22-84

/N05
----

COMMOD: Added <> around XP definition of SPTNMM to circumvent what
	appears to be a MACRO bug.  SPTNMM is correctly defined as
	17 instead of 62.  Was only used once @CRESP1+5 in FILFND
	which should be patched to HRRI T3,17 in P034/N. /CARL 10-21-84

/N06
----

FILUUO: Fixed typo in definiton of ECOD'x where x is %%XCOD which
        was initialized to - instead of 0.  Apparently was bad since
        originally written in P030/D.  /CARL 10-22-84

SCNSER: Moved misplaced code (RTCONT) from RTATS+6 to after TATUUO at
        TATUU1+4.  Apparently calls to RTATS where source DDB neq DDB
        for the port # in F fell into RTCONT erroneously.
	/CARL 11-12-84

ONCDSK: Copied "DDT" and "BOOTS" commands from ONCE into FILES just
        to make it easier to get out of FILES in hairy situations.
        No more "reboot monitor" when stuck in FILES. /CARL 12-5-84

/N07
----

ACTSER: Changed WRTAC1+4 from JRST @SPCACT-40(T3) to XCT SPCACT-40(T3) to
        force execution of STOPCD instead of jrst SYSCRS.  /CARL 2-27-85


UUOCON: changed SETMAI calli to set mail waiting based on job number rather
than user name and changed PRVMSK to allow non-priv jobs to set/clear own
[mail waiting] bit.  (for TUMS)  /WRS 3-3-85


/N08
----

CLOCK1: Added check for UBR non zero before doing context switching
	wrubr, when switching jobs or setting up nuljob.  /CARL 3-29-85


ONCE:	Added UPTTB0 with BLT pointer for UPT trap vectors so we can copy
	UPT stuff into page 0 to aid in tracking UBR=0 bug.  /CARL 3-30-85

COMMON: Moved non-F3 IRING/ORING buffers and anything else not hard-coded
	for page-0 locations out of the way so page 0 was as free as was
	possible for tracking UBR=0 bug.  /CARL 3-30-85

/N09
----

S:	Commented out MAPONC(DUM,1) to see if we really need it!  It
	was put in originally because we thought something wanted an
	extra page, possibly fixed with /L31? F3TSER fix.  /CARL 4-10-85

/N10
----

UUOCON:	Changed code using register to copy EPYPSN [EPTPTR(%UPS.N)] then
	does a DPB PG,register to simply do DPB PG,EPYPSN to free an AC.
        /CARL 4-12-85

FRMSER:	Put in check for NULQ in FRMASN, since only jobs actually in the
	NULL queue should be re-assigned.    /CARL 4-12-85

COMMON:	Added symbol BADQUE which is incremented every time a frame is
	attempted assignment because JNA is clear, but the job is NOT
	in the NUL queue.  /CARL 4-12-85

SETETY: Sete password changed.  /WRS 5-21-85

KMCSER: Fixed code at SETRM1, changed AOS T2,PG3ADR to AOS PG3ADR which
	was only executed if the IRING was NOT in page 0.  /CARL 6-13-85


/N11
----

UUOCON: Changed GETTAB .GTSLF tables from XWD FOO+WAYFOO,TABLE(J) to
	XWD FOO+WAYFOO+J,TABLE to get around bug with polish fixups in
	the new MACRO %53A(1152).  /CARL 5-16-85

UUOCON: Add some new GETTAB table pointers to provide the proper tables
	for STOPCDs and compatibility with DECs TOPS-10 tables which
	only have dissimilar indicies.  /CARL
	Changed SETINA and SETPRV UUOs to use default inactivity value
	from NSWTBL.  Added SETUUO function to set it.  /CARL

COMMON:	Added FETTBL,FETMXL globals for the feature test tables, added
	CRSLEN,CSRMXL for addition to the GETTAB index table.  /CARL
	Added INADEF to NSWTBL (re-using obsolete offset word 7) for
	the default inactivity time limit.  /CARL

COMMOD:	Change EXTERNAL to ## and INTERNAL to ::.  /CARL

COMCON:	Interned WATTAB,COMTAB,SETBL and added WATMXL,COMMXL,SETMXL for
	the new GETTAB indicies in UUOCON, sixbit table of WATCH,MONITOR
	and SET commands.  (Added TTY and TERMINAL to SET table to jump
	into the TTY command).  /CARL
	Added SET DEFAULT INACTIVITY [N] command requires OP to set the
	system-wide inactivity logout time limit in minutes.  /CARL

SCNSER:	Added TTYTBL @ TTCWDT+1 (to skip 'NO') and TTYMXL for the new
	GETTAB indicies.  Sixbit table of TTY commands.  /CARL 6-18-85

S:	Changed STOPCD macro.  /JMS 6-19-85

ERRCON:	Put in a dummy DIE routine (which fakes a JSR SYSCRS).  /JMS 6-19-85

F3TSER:	Replace JSR SYSCRS with STOPCD, update all STOPCDs.  /JMS 6-19-85
MAGSER:	Replace JSR SYSCRS with STOPCD, update all STOPCDs.

LPTSER:	Update all STOPCDs to assemble with new macro.  /JMS 6-19-85

/N12
----

ERRCON:	Install DEC's DIE routine (from 7.03 sources) to process stopcodes.

COMMON:	Defined global variables - .CPxxx = CPU Data Block, .SYxxx = System
	wide error counts.  Included only the variables used by DIE routine.

COMCON:	Add PRTPPN and PRTDDB routines.  The latter outputs the DDB pointed
	to by F as DEVICE:FILE.EXT[P,PN].

PICON:	Minor mods to the order in which routines are called for fatal APR err.

SCNSER:	Added more routines to output data to the CTY.

/JMS 6-24-85

	The new stuff is between "Start of STOPCD data" (page 45) and
	"End of STOPCD data" (page 56), with additional information up to
	"End of SYSCRS/REBOOT" (page 59).

COMMON:	Add DEC's routines, RCDCSB records CPU status block, TYPSTB displays it.
	Redefine JOB=.CPJOB, add DVCSTS (under REPEAT 0) to do CONI on all.

S:	Defined DEBUGF flags, PIOFF and PION macros, XCT and CPU stop types.

F3TSER:	Slight reformatting of STOPCDs.
MAGSER:	Slight reformatting of STOPCDs.
LPTSER:	Slight reformatting of STOPCDs.

PICON:	Remove routine to output KL CPU status (replaced by RCDCSB and TYPSTB).
	Give names to STOPCDs at APRFAT and nonzero in 30.  Add FLTCHK routine.

ERRCON:	Change DIE routine to use the right global symbols.  Set up an
	emergency stack for EXEC PDL OV.

UUOCON:	Make GETTAB table 51 point to .SYSxx variables, table 52 to CRSHAC.

CLOCK1:	Add code to calculate the Universal Date/Time and store it in DATE.

SCNSER:	Add dummy routine to save protocol/disable keep-alive.

SIMIO:	Add routine at SIMIOS(FCR.E+3) to output T1 via STOPCD routines.

/JMS 6-29-85

COMCON:	The PRTDDB routine borrowed from COMCON.703 uses DEC's convention of
	<PUSHJ P,SAVE1>, had to change to <JSP T4,SAVE1>.  The routine PRPER can
	not be used to print a period (license prints "!").   /JMS 6-30-85

/N13
----

ALL:	Add the line S$NAME='module' at the beginning of each source file.
/JMS 7-1-85

COMCON,SCNSER:	Change name of routine to print a prompt to PRPRMT.  Add
	PRPER to output a period only.  /JMS 7-2-85

COMMON:	Change ">=" to ".GE." to balance angle brackets.  /JMS 7-2-85

COMFAK:	Combine COMFAK and COMTXT into COMTXT.MAC, change command files to
	assemble COMTXT without S+K?SYM.  /JMS 7-2-85

COMMOD:	Make FTULNH global again.  WARNING: COMMOD.N12 will not load on KI
	or KL because FTULNH is not declared as being INTERNAL.  /JMS 7-3-85

/N14
----

FILFND,CTYSIM,ONCE,DZKON,DR11C,KMCSER,COMCON,F3TSER,MAGSER,REFSTR:
	Remove all references to SYSCRS from these files.
/JMS 7-9-85

COMCON,COMMON: Added code at COMMAND+1 to count times COMCNT is wrong
	in CMNOTF (%SYCCO) and at COMCMR+6 to count total commands that
	are processed in COMTOT (%SYNCP).  /CARL 7-9-85


FILFND: Added the following stopcodes...
	FILDMO (DSKCLN) DRB Max count overflow
	FILDMU (DSKCLN) DRB Max count underflow
	FILANF (DSKCLN) ATB not found in list
	FILBNF (DSKCLN) DDB not found in FNB device block list
	FILATB (DSKCLN) Bad ATB pointer
	FILLAS (DSKCLN) LMAP slot active/super
	FILAMO (DSKCLN) ATB Max write count overflow
	FILSEO (DSKCLN) SPT free entry count overflow
	FILAUO (DSKCLN) ATB Unshared map count overflow
	FILAUU (DSKCLN) ATB Unshared map count underflow
	FILAUS (DSKCLN) ATB Unshared map count with valid SPT

FILIO:  Added the following stopcodes...
	PGENIO (STOP) Paging Error: No I/O in progress
	PGEZER (STOP) Paging Error: Page count is zero
	PGEOOR (STOP) Paging Error: Out of range
	PGENDP (STOP) Paging Error: Not a disk page
	OHTFUL (STOP) Output Hash Table Full - Too many DP errors
	OHTENF (STOP) Output error Hash Table - Entry not found

CORE1:  Added the following stopcodes...
	REMVPG (STOP) Remove virtual page - Error
	BACRFP (DSKCLN) SAT (M) Bit already clear - File Page
	BACRVP (DSKCLN) SAT (M) Bit already clear - Virtual Page
	ULKNME (STOP) Unlock UPx - Not mine error
	PFLNUL (STOP) Page fault from NULL JOB
	PFLPR0 (STOP) Page fault writing - Page protection 0
	LAFUPS (STOP) LMAP Activation Failure - %UPS preserved
	LAFPOR (STOP) LMAP Activation Failure - Page out of range
	LDFPOR (STOP) LMAP Deactivation Failure - Page out of range
	CHTFLS (STOP) CHT Failure - Search: RBMASK bits on
	CHTFNJ (STOP) CHT Failure - Remove: No job in use list
	CHTFIU (STOP) CHT Failure - Remove: In use/io in progress
	CHTFNF (STOP) CHT Failure - Remove: CP not found in CHT
	CHTFMU (STOP) CHT Failure - Remove: Multiply used PGYADR
	CHTFDP (STOP) CHT Failure - Insert: Duplicate page
	LRFPRx (STOP) LMAP Read Failure: Page out of range
	LSFUFx (STOP) LMAP Store Failure - LDC count underflow
	LSFPRx (STOP) LMAP Store Failure - Page out of range
	PGUSEO (STOP) Page Use Error: Count increment overflow
	PGUSEU (STOP) Page Use Error: Count decrement underflow
	PGUSEA (STOP) Page Use Error: Slot still active
	PGWNME (STOP) Page Wait queue error: Not me
/CARL 7-10-85

CORE1,DEBUG,FILRIB,FILUUO,FRMSER,MAPIO,SEGCON,SIMIO: move OPDEFs to S

S:	The OPDEFs moved into S are the following negative CALLIs:
	VDSKPT, PERSTS, VALPAG, PREREF, WSCTL, PERSET, PAGSTS, VPROT, VCREAT,
	VCLEAR, VREMOV, VREPL.  VPGSTS was changed in DDT, MAPIO, and SIMIO
	to conform with the YAMM, which says that CALLI -71 is PAGSTS.
/JMS 7-11-85

APXKON,F3TSER: Copy F3-OPDEFs into F3SYM.
SCNSER:	Move TYMNET opdef into F3SYM.
/JMS 7-11-85

KSSYM:	Changed OPDEF WRADB[JFCL] to DEFINE WRADB,<PRINTX KS does not have ADB>.
ERRCON,CLOCK1:	Put all references to WRADB inside IFNCPU(KS).
/JMS 7-12-85

ERRCO:	Add PUSHJ P,PRTDIR to output username of file in STOPCD processor.
COMCON:	Create PRTDIR, which outputs username in parenthesis.  Calls PPNUSR.
FILUUO:	Create PPNUSR and USRPPN - routines to translate PPN to USERNAME and
	USERNAME to PPN.  These two routines search only the in-core tables,
	and give a nonskip return if not found.  USRPPN is the first part of
	the LOKLUD routine (the second part reads LUD.SYS).
/JMS 7-15-85

Module Old name Times    New name  (note: DISK=STOPCD(.,DSKCLN,...)
====== ========  ==  ==============================================
CLOCK1 CIP7+3     1  STOP,PAGZER,<Pager - UPT is zero>
COMCON CKRCER+2   1              no STOPCD at this location
COMMOD SAXINT+5   1  INFO,SAXIN1,<Spurious SA-10 interrupt>
COMMON EPT+43     1              no STOPCD at this location
COMMON SYSINA+4   9  CPU ,CRS147,<147 restart>
CORE1  ACTLMS+4   1  STOP,LAFUPS,<LMAP Activation Failure - %UPS preserved>
CORE1  DECUS0+7   1  STOP,PGUSEA,<Page Use Error: Slot still active>
CORE1  PAGWAT+1   1  STOP,PGWNME,<Page Wait queue error: Not me>
CORE1  REMCHR+4   1  STOP,CHTFNJ,<CHT Failure - Remove: No job in use list>
CORE1  REMV16+7   1  STOP,REMVPG,<Remove virtual page - Error>
CORE1  REMV31+14  4  DISK,BACRFP,<SAT (M) Bit already clear - File Page>
CORE1  REMV41+3   1  DISK,BACRVP,<SAT (M) Bit already clear - Virtual Page>
CORE1  SRCCHT+1   1  STOP,CHTFLS,<CHT Failure - Search: RBMASK bits on>
CORE1  STOLMA+1  12  STOP,LSFUFA,<LMAP Store Failure - LDC Count underflow>
CORE1  USRFLT+3   4  STOP,PFLNUL,<Page fault with LDC in use>
ERRCON EXCMPE+3   1  STOP,S..IME,<Illegal Memory-reference from Exec>
ERRCON INSSIM+2   0  STOP,S..UIL,<Uuo at Interrupt Level>
ERRCON ILLINS+2  98 DEBUG,S..EUE,<Exec Uuo Error>
ERRCON UUOCTR     4  JOB ,UUOCTR,<UUO from Concealed mode, Trap>
ERRCON UUOSTR     0  CPU ,UUOSTR,<UUO from Supervisor mode, Trap>
FILFND CNVATP+1   1  DISK,FILATB,<Bad ATB pointer>
FILFND DECRMV+13  3  DISK,FILAMO,<ATB Max write count overflow>
FILFND DECUMC+4   2  DISK,FILAUU,<ATB Unshared map count underflow>
FILFND DECUMC+10 10  DISK,FILAUS,<ATB Unshared map count zero with SPT>
FILFND ULKDB0+4   3  DISK,FILBNF,<DDB Not found in FNB device block list>
FILFND USRUSI+22  1 DEBUG,USRUS1,<Unexpected CHANIO error in USETI>
FILIO  INSOH3+1   3  STOP,OHTFUL,<Output Hash Table Full - Too many DP errors>
FILRIB USEOUT+3  15  DISK,RIBBRP,<RIB error - Bad Retreival Pointer>
FILRIB RIBERR+6  14  DISK,RIBTME,<Too Many RIB errors - disk is unsafe>
FILUUO CLRACH+7   1              no STOPCD at this location
FILUUO CLRCOM+5   1  DISK,CLRCM1,<CLRCOM decremented DRBCNT too far>
FILUUO TSTRES+13  1  DISK,UUOXWR,<UUO eXit with Resources still owned>
FILUUO UPDUFD+16  2  DISK,UFDER1,<UFD error return from DIRSRC>
FILUUO USRUSI+22  1  DEBG,USRUS1,<Unexpected CHANIO error in USETI>
FTASER FXWN21+12  1              no STOPCD at this location
FTASER SCMBF1+3   2  JOB ,MTATMW,<Too many data words>
FTASER SGTDEV+14  1              no STOPCD at this location
MAPIO  MAPF34+4   7  JOB ,MPFBRP,<MAPF error - Bad Retreival Pointer>
PATCH            12              patches to the Monitor to get more information
PCBIO  GETTR1+2   1  STOP,GETTR3,<End of list detected at GETTR1+2>
PCBIO  GTDON4+4   1  JOB ,GTDON1,<PCB link zero at GTDONE+12 or GTDON4+4>
PCBIO  MAPALL+4   8  STOP,MAPAL1,<Bad Retreival Pointer detected at MAPALL+4>
PICON  APRFAT    26  CPU ,APRFAT,<Fatal APR error - hardware failure>
PICON  USEPER+3   2  STOP,NJBPER,<Parity error in Null Job>
PLTSER PLTBL+3    1              STOPPC=147 (PLTBL=144, see COMMON SYSINA+4)
PTPSER PTPBL+3    1              STOPPC=147 (PTPBL=144, see COMMON SYSINA+4)
SCHED1 PAGWK1+2   3  JOB ,PAGWK2,<Job not coming out of SW queue at PAGWK1+2>
SCNSER CNTPRT     1  INFO,TTYBMT,<Bad Message Type from Base>
SCNSER FRCIBF+1   1 DEBUG,TTYBNP,<Block mode IO not in progress>
SCNSER GETBBP+1   5  STOP,TTYNFB,<No Free Buffrers>
SCNSER PGBIN+6    1  JOB ,TTYNPB,<No PTY Buffer for block IO>
SCNSER PGTRI+7    2  XCT ,TTYNPB,<No PTY Buffer for block IO>
SEGCON MAPHSF     1  JOB ,MAPHSF,<Unexpected error from CHANIO VMAP>
SIMIO  FCR.E+4   23  JOB ,SIMIOX,<Unexpected error at SIMIOS>
SIMIO  SIMRM1+1   1  JOB ,SIMRMV,<Unexpected VREMOV error at SIMRM1+1>
SWAMP  GIVPGK+5   8  DISK,GIVPG1,<Error in GIVPGK - F bit is not on>
SWAMP  GTSA42+5   1  DISK,GTSA43,<Error at GTSA42 - STTPTR is zero>
SWAMP  SEAR15+1   1  DISK,SEAR14,<Error at SEAR15+1 - No bits free in SAT>
UUOCON USRXIT+3   3  JOB ,UUOXWL,<UUO eXit With Locks still active>
/JMS 7-17-85

COMMON:	Put DEC's definitions for the CONFIG table inside REPEAT 0,<>.
/JMS 7-18-85

S:	Added ND and NDL macros.  They define a value as being global if not
	already defined, and show the value defined in the listing.  All
	occurrances of IFNDEF FOO,<XP FOO,BAR> can be replaced with ND FOO,BAR.
/JMS 7-18-85

COMMOD:	Added XP SPCBN,30 and XP RPCBN,14 inside IFCPU(KL)
CONF##:	Removed XP SPCBN,30 and XP RPCBN,14 from all KL config files.
/JMS 7-18-85

MAPIO,SEGCON:	"STOPCD ] ;COMMENT" is OK, but MACRO generates bad code for
	"STOPCD ] ;COMMENT ;;ADD1PG+5".  Cure: Move "]" to seperate line.
/JMS 7-19-85

/N15
----

COMMON,UUOCON,FRMSER:	Add CARL's changes to enable job inactivity timer from
	LOGIN and CREFRM uuos.

ONCE:	Change the instruction that sets up the LUUO trap to
	IFCPU (KI),<MOVEM T1,EPT+41>
	IFNCPU(KI),<MOVEM T1,41>	;KL and KS use Exec virtual address 41.
/JMS 7-19-85

S	Change "1B<tab>" back to "1B0<tab>".  MACRO 47 was generating "good"
	code for this, MACRO 53 rightly reported an "N" error.
/JMS 7-23-85

/N16
----



ONCE:   Added 2 lines @ ONCGP1+lots to initialize the default inactivity
	timer INADEF to INADFL  /CARL 7-24-85

COMCON,ERRCON: Minor reformatting of STOPCD output.  /JMS 7-24-85

FILUUO: Fixed logic error in PPN=>USERNAME search.  Save JOB around
	code to grab CB resource to get GFD'd USERNAME.  /JMS 7-24-85

/N17
----

COMCON:	Fix PJOBX to output 'DET' for jobs that are detached.
FILUUO:	Clean up the stack before calling GIVCBR in USRPPN and PPNUSR routines.
ERRCON:	Add a new frame halt status code for jobs halted by a job STOPCODE.
	For halt class HC.SYS added HT.MED - Monitor Error Detected at user PC.
S:	Add PFALL macro.  Use "PFALL ADDR" instead of ";JRST ADDR".
/JMS 7-25-85

/N18
----

ONCE:	Moved setting of INADEF from (/N16 p.13) to p.33 just after the
	BLT that clears all of COMMON's low core (SYSBEG, etc).  /CARL 7-25-85

SCNSER: Changed TTYBMT and TTYBPN stopcodes from INFO to STOP, since we
	aren't really able to continue at this point.  BMT - unknown or
	bad message type, we could be anywhere inside a message, BPN -
	bad port #, we need to sift through (some messages are multi-word
	and we can't just go to SCNIN2).   Added TTYBZP INFO stopcd in
	the BADPRT code, for message types which should be 0 or are really
	ignored anyway, to print the info, then execute the code for the
	appropriate message as if no error occurred.  /CARL 7-25-85

SCNSER,ERRCON: Changed TTYBPN stopcd and added TTYBZP stopcd to use PRTP1U
	routine in ERRCON to print out P1 & U, as Message type and Port for
	bad message (or) port stopcds that eventually continue.  /CARL 7-25-85

ERRCON:	Fix the KI version of the routine to type out the instruction that
	caused an IME stopcode (Illegal memory-reference from Exec).

UUOCON:	Add comments describing which DEC CALLIs we are missing.  Match
	angle brackets.

/N19
----

DDT: Fixed 1^B,2^B,3^B buffers and munched FILDDT commands as well.
     /CARL 7-26-85

COMMON: Removed (POPJ) "No CRASH.EXE" message till later date.  Removed
	symbol SYSBG1, never referenced.  Moved NFCNT to %SYCCO until we
	get a chance to check where referenced.  /CARL 7-26-85

UUOCON: PRVMSK had PDVINA on the wrong side of the comma.  /CARL 7-26-85

/N20
----

ERRCON:	Call CONMES instead of CONMSG for JOB stopcodes, CONMSG hung the
	CPU.  /JMS 7-26-85

COMMON:	Move DSKDIE from COMMON to ERRCON and document it.  /JMS 7-26-85
	Deleted NFCNT (same as CMNOTF / %SYCCO) never referenced.
	/CARL 7-26-85


/N21
----

UUOCON:	Add dispatches for CALLI 67 and CALLI 70 uuos.  Each one currently
	points to a POPJ, but if the POPJ at CALI67 is changed to a JFCL,
	then CALLI 67 causes a JOB stopcode (S..JOB).  If the POPJ at CALI70
	is patched to a JFCL, then CALLI 70 causes a DEBUG stopcode (S..CI7).
/JMS 7-29-85

CLOCK1:	Add code to call routine in ERRCON to decrement the stopcodes-per-minute
	counter.  (TOPS-10 now uses 2-word CLOCK requests, TYMCOM-X only 1 word)
ERRCON:	Set up right data for the clock request.  Current limits are to stop
	if 2 stopcodes within 60 seconds, 4 stopcodes within an 8-minute period,
	and 8 stopcodes per hour.
/JMS 7-29-85

/N22
----

CTYSIM: Change POPJ's to JRST CTYOUT to force string output (fixes to
	CTY ^Z<xxx> messages), Change some JRST's to PJRSTs.  /CARL 7-29-85

/N23
----

ERRCON:	Add SKIPE S to not output job status twice during STOPCD.
SCNSER:	Clear byte count consistantly so that we don't put 34 characters into
	a 32 byte message.  WRS noticed that the two extra characters were
	getting thrown away because they were not accounted for.
/JMS 7-30-85

DDT:	Change the default $1M mask to 1000.  Now DDT will output "LABEL+offset"
	where offset can go up to 777.  Add OPDEF for VPEEK, POKE, and SETMOD
	so that it will assemble with MACRO 53.
/JMS 7-30-85

CLOCK1: In once-a-minute check for JBYINA against JBTINA(J), change the
	CAIL to a CAILE to only give the user 0-59 seconds rather than
	60-119 seconds extra slack time for autologout.  /CARL 7-31-85

/N24
----

FILIO:	Change STOPCD(,XCT,BADSAT) and give it a unique name.
	STOPCD(.+1,INFO,WRTSAT,WRTST1,<Disk output error writing SAT>)
	This STOPCD was hit on C57 and did not output enough info.  It now
	outputs the disk page number that got the error.  (Note: the stopcode
	BADSAT in SWAMP is when a SAT is read from the disk, and fails the
	consistancy check.  WRTSAT is when the SAT cannot be written.

SCNSER:	JFCL out the JSR SPCINI in SVPPC routine until we know it works.

ERRCON:	Comment out MOVE U,LINTAB(U) in DIETYO until the CTY gets an LDB.

COMMON:	Carl found a PUSHJ P,SAVE4 in the part of RCDSTB that reads the
	SBUS DIAGs.  It needed to be JSP T4,SAVE4 and was causing the KL to
	halt due to ILL MEM REF when the stopcode processor was saving the
	machine status.

HALT:	For your info:  There are only two occurrances of the HALT instruction
	in the Monitor.  The first is at DIE+1, DIEREH=Recursion in Error
	Handler.  This is if a 2nd stopcode occurs while processing a stopcode.
	The second HALT occurs if the Console PDP-11 is not running when a
	stopcode is detected.  This is because the CTY cannot be used to output
	information.  (If the PDP-11 is reloaded, and the KL continued, the
	stopcode will then be processed.)
/JMS 8-14-85

/N25
----

PICON:	Ignore nonzero in 30 if we are in the process of outputting a STOPCD.
ERRCON:	Re-enable channel 1 interrupts for JOB, DEBUG, and INFO stopcodes.
	This is so that the base will not get upset and crash the PDP-10 when
	the system is continued after one of the above stopcodes. 
/JMS 8-19-85

/N26
----

ERRCON: Added PRTCRS routine to print out 30 and the Key in a useful
	manner.  /Carl
PICON:  Changed CRSHWD checking STOPCD to call PRTCRS.  /Carl
COMMON:	Reformatted crash code, commented out where it tells the base
	where to dump into PDP-10 memory. (Never again!)
	Added SYSBTS:: at 146 to JRST LODBTS so this may eventually
	work someday.  /CARL 8-20-85

/N27
----


SCNSER: Fixed problem with loop in input ring processing caused by bad
	JRST ZAPLOG's which should have been PUSHJ P,ZAPLOG's.  Reworked
	LOGIN & RCVAUX to use new-style ZAPLOG and return to SCNIN1.
	Put a DEBUG stopcode at ZAPLOG which is called in a few places.
	Added INFO stopcode TTYZNE to notify us if a zapper hasn't been
	reflected to the base and the base re-assigns the same port.
	Added state 7, .ASWTP to aux-circuit build tables which causes
	RCVSUR to check for errors and if none, reset the build process
	back to state 1, .ASRQ1 to re-try the circuit; SNDAUX will
	continue to decrement the response timeout unless a response is
	received.  Thus, if we get a bad type 7 message from the base,
	we will (a) No longer loop forever, (b) not confuse either the
	base or the user by a spurious zapper, (c) actually zap the aux
	port and re-request another circuit from the supervisor to keep
	everyone happy.  If we get a bad type 6 message from the base,
	we will (a) No longer loop forever, (b) recover gracefully and
	print a stopcode message on the CTY before continuing.  /CARL 8-30-85


/N28
----

PROBLEM: CRSHID gives up, says "the crash code was not executed".
DIAGNOSIS: In /N23 and /N27, 3 words of the crash data block are not set up.
CURE:  Set up STOPCN, PISTS, and APRSTS when a STOPCODE is hit.
Note: The LH of CONFIG-2 still points to the old crash data block.  GETTAB
  table 44 points to the new crash data block.  (GETTAB tables 55 and 56
  need to be defined to do this right.)

COMMON: Change 5 lines in the crash code to set up STOPCN, PISTS, and APRSTS.
UUOCON: Make table 44 point to .GTCRS for now.  /JMS 8-31-85

/N29
----
  |O}