SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 1
SNOPAV	MAC	13-Oct-66 22:26		DAVID R. HANSON/RCM/VB		15-JULY-76

     1						SUBTTL	DAVID R. HANSON/RCM/VB		15-JULY-76
     2
     3					;COPYRIGHT (C) 1976,1977 STEVENS INSTITUTE OF TECHNOLOGY
     4					;HOBOKEN, NEW JERSEY, 07030.
     5					;ALL RIGHTS RESERVED.
     6
     7					; Support for programmer access to the trapped variable concept
     8
     9					  ;UNIVERSALS
    10
    11						SEARCH	JOBDAT		;JOB DATA AREA DEFINITIONS
    12						SEARCH	MACTEN		;DEC-10 MACRO DEFINITIONS
    13						SEARCH	UUOSYM		;TOPS-10 UUO SYMBOLS
    14						SEARCH	SNOPRM		;SITBOL PARAMETERS
    15
    16					  ;DIRECTIVES
    17
    18						.DIREC	.XTABM		;EXCLUDE TABS FROM MACRO CALLS
    19						SALL			;SUPPRESS MACRO EXPANSIONS
    20	400000'					TWOSEG	400K		;TWO SEGMENT CODE
    21
    22					  ;VERSION NUMBERS
    23
    24			000005			PAVVER==5		;MAJOR VERSION NUMBER
    25			000000			PAVMIN==0		;MINOR VERSION NUMBER
    26			000135			PAVEDT==135		;EDIT LEVEL
    27			000000			PAVWHO==0		;CUSTOMER ARGUMENT
    28
    29					  ;TITLE
    30
    31						TITLE.	PAV,SNOPAV,<Programmer Defined Variable Associations>
    32		604166	000000			PAVSIX==SIXBIT /PAV/	; SNOPAV ABBREVIATION IN SIXBIT
    33		502032	600000			PAVASC==ASCIZ /PAV/	; SNOPAV ABBREVIATION IN ASCII
    34						SALL
    35
    36
    37					  ;SHOW UNIVERSAL'S VERSION NUMBERS
    38
    39	400000'	000500	000305			SHOW.	%%SNOP		;VERSION NUMBER OF SNOPRM
    40	400000'	043100	000450			SHOW.	%%JOBD		;VERSION NUMBER OF JOBDAT
    41	400000'	000200	000025			SHOW.	%%MACT		;VERSION NUMBER OF MACTEN
    42	400000'	001400	000457			SHOW.	%%UUOS		;VERSION NUMBER OF UUOSYM
    43
    44					IFE FTPAV,<END>			; stop now if we don't want this feature
    45
    46						PAVTTL			; Title
    47						PAVPTX			; PASS2 assembly message
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 2
SNOPAV	MAC	13-Oct-66 22:26		Table of Contents

    48						SUBTTL	Table of Contents
    49
    50					;		Table of Contents for Programmer Defined Variable Associations
    51					;
    52					;
    53					;			   Section			      Page
    54					;   1. Table of Contents. . . . . . . . . . . . . . . . . . .    2
    55					;   2. REVISION HISTORY . . . . . . . . . . . . . . . . . . .    3
    56					;   3. Primary Function ASSOCIATE(var,process). . . . . . . .    4
    57					;   4. Primary Function DISASSOCIATE(var,process) . . . . . .    5
    58					;   5. Trap Handling
    59					;        5.1.   TAVVAL. . . . . . . . . . . . . . . . . . . .    6
    60					;        5.2.   TAVNAM. . . . . . . . . . . . . . . . . . . .    7
    61					;        5.3.   TAVASS. . . . . . . . . . . . . . . . . . . .    8
    62					;   6. Process Description Access Function
    63					;        6.1.   GPRTYP. . . . . . . . . . . . . . . . . . . .    9
    64					;        6.2.   GPRFCT. . . . . . . . . . . . . . . . . . . .   10
    65					;        6.3.   GPRLVL. . . . . . . . . . . . . . . . . . . .   11
    66					;        6.4.   GPRACT. . . . . . . . . . . . . . . . . . . .   12
    67					;   7. Utility Function
    68					;        7.1.   FNDPOS. . . . . . . . . . . . . . . . . . . .   13
    69					;        7.2.   VACALL. . . . . . . . . . . . . . . . . . . .   14
    70					;        7.3.   CHKACT. . . . . . . . . . . . . . . . . . . .   15
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 3
SNOPAV	MAC	13-Oct-66 22:26		REVISION HISTORY

    71						SUBTTL	REVISION HISTORY
    72
    73					COMMENT	\
    74					131	ADDITION OF THIS MODULE TO SITBOL FROM THE UNIVERSITY OF 
    75						ARIZONA, DAVID R. HANSON
    76					134	Add PORTALs for execute only.
    77					135	Remove definitions to the parameter file (SNOPRM).
    78					\
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 4
SNOPAV	MAC	13-Oct-66 22:26		Primary Function ASSOCIATE(var,process)

    79						SUBTTL	Primary Function ASSOCIATE(var,process)
    80
    81						 ; Insure correct arguments
    82
    83	400000'	554 11 0 01 777777 	ASSC::	HLRZ	T1,-1(STACK)	; get datatype of second argument
    84	400001'	302 11 0 00 004012 		CAIE	T1,DDT		; defined?
    85	400002'	003 01 0 00 000456 		 ERROR.	1,302		; no--signal error
    86
    87	400003'	550 11 0 01 777777 		HRRZ	T1,-1(STACK)	; yes--get address of DBLOK
    88	400004'	550 11 0 11 000000 		HRRZ	T1,BLENG(T1)	; get length of DBLOK
    89	400005'	305 11 0 00 000011 		CAIGE	T1,PRLEN	; big enough?
    90	400006'	003 15 0 00 000454 		 ERROR.	13,300		; no
    91
    92	400007'	265 11 0 00 400271'		JSP	TLINK,GPRLVL	; get association level
    93	400010'	003 01 0 00 000457 		 ERROR.	1,303		; bad datatype
    94	400011'	202 12 0 00 000000*		MOVEM	T2,IGNOP##	; save for later
    95	400012'	262 01 0 00 000000#		POP	STACK,FLAP##+1	; save defined datatype...
    96	400013'	262 01 0 00 000000*		POP	STACK,FLAP##	;  for later
    97
    98	400014'	265 11 0 00 000000*		JSP	TLINK,CVTNAM##	; convert first argument to name
    99	400015'	003 01 0 00 000457 		 ERROR.	1,303		; what?
   100
   101						 ; Get some storage for the VABLOK
   102
   103	400016'	200 00 0 00 400427'		MOVE	Z,[VABLOK,,VALEN]; we need a VABLOK
   104	400017'	265 15 0 00 000000*		JSP	QLINK,BLOK##	; get some floating store
   105	400020'	001 06 0 00 000001 		 ERROR	6,1		; die big
   106	400021'	262 01 0 00 000000 		POP	STACK,Z		; toss junk
   107	400022'	262 01 0 00 000005 		POP	STACK,P2	; get address of block
   108
   109						 ; Fill in fields of VABLOK
   110
   111	400023'	515 15 0 00 002001 		HRLZI	Q1,IDT		; Flag field is an integer
   112	400024'	202 15 0 05 000010 		MOVEM	Q1,VAFLG(P2)	; and
   113	400025'	402 00 0 05 000011 		CLEARM	VAFLG+1(P2)	; is initially 0
   114
   115	400026'	200 16 0 00 000000#		DMOVE	Q1,FLAP		; get descriptor for defined datatype
   116	400027'	200 15 0 00 400013*
   117	400030'	202 15 0 05 000006 		DMOVEM	Q1,VAPROC(P2)	; store process description
   118	400031'	202 16 0 05 000007 
   119
   120	400032'	200 13 0 01 000000 		DMOVE	T2,-1(STACK)	; get variable name
   121	400033'	200 12 0 01 777777 
   122	400034'	202 12 0 05 000004 		DMOVEM	T2,VANAME(P2)	; store it
   123	400035'	202 13 0 05 000005 
   124
   125	400036'	270 12 0 00 000013 		ADD	T2,T3		; point to value of variable
   126	400037'	200 13 0 00 400011*		MOVE	T3,IGNOP	; get association level
   127	400040'	265 11 0 00 400313'		JSP	TLINK,FNDPOS	; find position in trap chain
   128	400041'	200 16 0 12 000001 		DMOVE	Q1,0(T2)	; get old value
   129	400042'	200 15 0 12 000000 
   130	400043'	202 15 0 05 000002 		DMOVEM	Q1,VAVAL(P2)	; store in VABLOK
   131	400044'	202 16 0 05 000003 
   132	400045'	505 05 0 00 034000 		HRLI	P2,TVAR		; create trapped variable
   133	400046'	202 05 0 12 000000 		MOVEM	P2,0(T2)	; replace original value by a trap
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 4-1
SNOPAV	MAC	13-Oct-66 22:26		Primary Function ASSOCIATE(var,process)

   134	400047'	201 15 0 00 400101'		MOVEI	Q1,TAV		; get trap handling address
   135	400050'	202 15 0 12 000001 		MOVEM	Q1,1(T2)	; this is second word
   136
   137	400051'	254 00 0 00 000000*		JRST	RETNL1##	; pop name and return null string
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 5
SNOPAV	MAC	13-Oct-66 22:26		Primary Function DISASSOCIATE(var,process)

   138						SUBTTL	Primary Function DISASSOCIATE(var,process)
   139
   140	400052'	262 01 0 00 000000#	DASSC::	POP	STACK,FLAP+1	; pop process description
   141	400053'	262 01 0 00 400027*		POP	STACK,FLAP
   142
   143	400054'	265 11 0 00 400014*		JSP	TLINK,CVTNAM##	; convert first argument to name
   144	400055'	003 01 0 00 000461 		 ERROR.	1,305		; not a name
   145	400056'	550 05 0 01 777777 		HRRZ	P2,-1(STACK)	; get address of value
   146	400057'	270 05 0 01 000000 		ADD	P2,0(STACK)	; add offset so P2 points to value
   147	400060'	200 10 0 00 400053*		MOVE	S3,FLAP		; get first word of process descriptor
   148
   149						 ; Loop removing specific associations
   150
   151	400061'	554 15 0 05 000000 	DASSC1:	HLRZ	Q1,0(P2)	; get datatype of value
   152	400062'	302 15 0 00 034000 		CAIE	Q1,TVAR		; trapped variable?
   153	400063'	254 00 0 00 400051*		 JRST	RETNL1##	; no--we are at the end
   154
   155	400064'	550 06 0 05 000000 		HRRZ	S1,0(P2)	; get address of trapping block
   156	400065'	554 15 0 06 000000 		HLRZ	Q1,BTCODE(S1)	; get block code
   157	400066'	306 15 0 00 000414 		CAIN	Q1,VABLOK	; is it a VABLOK?
   158	400067'	312 10 0 06 000006 		CAME	S3,VAPROC(S1)	; yes--but is process the same?
   159	400070'	254 00 0 00 400077'		 JRST	DASSC2		; no--not VABLOK or specific process
   160
   161						 ; Here to disconnect the association
   162
   163	400071'	370 00 0 06 000011 		SOS	VAFLG+1(S1)	; deactivate the association. If we are
   164									; currently processing this one then
   165									; VAFLG+1 will be -2.  See TAVASS.
   166	400072'	200 16 0 06 000003 		DMOVE	Q1,VAVAL(S1)	; load value hidden in trapping block
   167	400073'	200 15 0 06 000002 
   168	400074'	202 15 0 05 000000 		DMOVEM	Q1,0(P2)	; overwrite trapped variable
   169	400075'	202 16 0 05 000001 
   170	400076'	254 00 0 00 400061'		JRST	DASSC1		; loop for more
   171
   172						 ; Here if TVAR did not point to VABLOK or specific process
   173
   174	400077'	201 05 0 06 000002 	DASSC2:	MOVEI	P2,LHDR(S1)	; point to next value
   175	400100'	254 00 0 00 400061'		JRST	DASSC1		; try again
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 6
SNOPAV	MAC	13-Oct-66 22:26		Trap Handling -- TAVVAL

   176						SUBTTL	Trap Handling -- TAVVAL
   177
   178
   179	400101'	254 00 0 00 400104'	TAV::	JRST	TAVVAL		; want value
   180	400102'	254 00 0 00 400151'		JRST	TAVNAM		; want name
   181	400103'	254 00 0 00 400156'		JRST	TAVASS		; want to assign
   182
   183					; TAVVAL -- get value of an associated variable.  Call is
   184					;
   185					;	push TVAR descriptor
   186					;	JSP	SLINK,TAV+0
   187					;	 fail--stack unchanged
   188					;	success--TVAR replaced by value
   189					;
   190					; Type S, unstable.
   191					;
   192	400104'	265 11 0 00 400402'	TAVVAL:	JSP	TLINK,CHKACT	; active?
   193	400105'	254 00 0 00 400144'		 JRST	TVAL4		; no
   194	400106'	254 00 0 00 400144'		 JRST	TVAL4		; no
   195
   196	400107'	265 11 0 00 400231'		JSP	TLINK,GPRTYP	; yes--get trap type
   197	400110'	003 01 0 00 000454 		 ERROR.	1,300		; bad datatype in process DDT
   198						JRST	@[TVAL1
   199	400111'	254 00 1 12 400430'			  TVAL3](T2)	; dispatch on type
   200
   201	400112'	265 11 0 00 400255'	TVAL1:	JSP	TLINK,GPRFCT	; get address of function variable block
   202	400113'	003 01 0 00 000455 		 ERROR.	1,301		; not a name
   203	400114'	202 12 0 00 000000*		MOVEM	T2,IGNOS##	; save for later
   204	400115'	274 01 0 00 000000*		SUB	STACK,XWD22##	; toss DDT
   205
   206	400116'	550 13 0 01 777777 		HRRZ	T3,-1(STACK)	; get address of VABLOK
   207	400117'	261 01 0 13 000002 		PUSH	STACK,VAVAL(T3)	; push value
   208	400120'	261 01 0 13 000003 		PUSH	STACK,VAVAL+1(T3)
   209	400121'	265 11 0 00 000000*		JSP	TLINK,CVTVAL##	; insure a real value
   210						 JRST	[SUB	STACK,XWD22##	; failed--prune stack
   211	400122'	254 00 0 00 400432'			 JRST	0(SLINK)]	; give fail return
   212	400123'	262 01 0 00 000000#		POP	STACK,FLAS##+1	; success-save real value
   213	400124'	262 01 0 00 000000*		POP	STACK,FLAS##
   214
   215	400125'	200 12 0 00 400114*		MOVE	T2,IGNOS##	; get back function address
   216	400126'	550 13 0 01 777777 		HRRZ	T3,-1(STACK)	; point to VABLOK
   217	400127'	201 14 0 00 400124*		MOVEI	T4,FLAS		; point to value
   218	400130'	476 00 0 13 000011 		SETOM	VAFLG+1(T3)	; set interlock
   219	400131'	265 11 0 00 400347'		JSP	TLINK,VACALL	; call programmer's function
   220	400132'	254 00 0 00 400140'		 JRST	TVAL2		; user said fail!
   221
   222						 ; Here upon successfull return from programmer's function
   223
   224	400133'	550 13 0 01 777775 		HRRZ	T3,-3(STACK)	; get address of VABLOK
   225	400134'	402 00 0 13 000011 		CLEARM	VAFLG+1(T3)	; clear interlock
   226	400135'	262 01 0 01 777776 		POP	STACK,-2(STACK)	; overwrite TVAR with...
   227	400136'	262 01 0 01 777776 		POP	STACK,-2(STACK)	;  new value
   228	400137'	254 00 0 06 000001 		JRST	1(SLINK)	; return a winner
   229
   230						 ; Here if programmer's function failed
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 6-1
SNOPAV	MAC	13-Oct-66 22:26		Trap Handling -- TAVVAL

   231
   232	400140'	550 13 0 01 777777 	TVAL2:	HRRZ	T3,-1(STACK)	; get address of VABLOK
   233	400141'	402 00 0 13 000011 		CLEARM	VAFLG+1(T3)	; clear interlock
   234	400142'	254 00 0 06 000000 		JRST	0(SLINK)	; fail
   235
   236						 ; Here for in-active trap--just return value
   237
   238	400143'	274 01 0 00 400115*	TVAL3:	SUB	STACK,XWD22##	; pop off useless DDT
   239	400144'	262 01 0 00 000013 	TVAL4:	POP	STACK,T3	; toss junk second word
   240	400145'	262 01 0 00 000013 		POP	STACK,T3	; get VABLOK address
   241	400146'	261 01 0 13 000002 		PUSH	STACK,VAVAL(T3)	; push value
   242	400147'	261 01 0 13 000003 		PUSH	STACK,VAVAL+1(T3)
   243	400150'	254 00 0 06 000001 		JRST	1(SLINK)	; return
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 7
SNOPAV	MAC	13-Oct-66 22:26		Trap Handling -- TAVNAM

   244						SUBTTL	Trap Handling -- TAVNAM
   245
   246					; TAVNAM -- get name of an associated variable.  Call is
   247					;
   248					;	push TVAR descriptor
   249					;	JSP	SLINK,TAV+1
   250					;	 fail--stack unchanged
   251					;	success--TVAR replaced with VAR
   252					;
   253					; Type S, stable.
   254					;
   255	400151'	201 13 0 00 064000 	TAVNAM:	MOVEI	T3,VAR		; get VAR datatype code
   256	400152'	506 13 0 01 777777 		HRLM	T3,-1(STACK)	; change TVAR to VAR
   257	400153'	201 13 0 00 000002 		MOVEI	T3,VAVAL	; get offset to real value
   258	400154'	202 13 0 01 000000 		MOVEM	T3,0(STACK)	; set as offset for VAR
   259
   260	400155'	254 00 0 06 000001 		JRST	1(SLINK)	; return
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 8
SNOPAV	MAC	13-Oct-66 22:26		Trap Handling -- TAVASS

   261						SUBTTL	Trap Handling -- TAVASS
   262
   263					; TAVASS -- assignment to an associated variable.  Call is
   264					;
   265					;	push TVAR descriptor
   266					;	push value descriptor to be assigned
   267					;	JSP	SLINK,TAV+2
   268					;	 fail--value popped, TVAR remains
   269					;	success--value assigned, value popped, and TVAR remains
   270					;
   271					; Type S, unstable.
   272					;
   273	400156'	262 01 0 00 000000#	TAVASS:	POP	STACK,FLAS+1	; pop value to be..
   274	400157'	262 01 0 00 400127*		POP	STACK,FLAS	;  assigned exposing TVAR
   275
   276	400160'	265 11 0 00 400402'		JSP	TLINK,CHKACT	; active?
   277	400161'	254 00 0 00 400217'		 JRST	TASS4		; no
   278	400162'	254 00 0 00 400217'		 JRST	TASS4		; no
   279
   280	400163'	265 11 0 00 400231'		JSP	TLINK,GPRTYP	; yes--get type
   281	400164'	003 01 0 00 000454 		 ERROR.	1,300		; bad datatype
   282						JRST	@[TASS3
   283	400165'	254 00 1 12 400434'			  TASS1](T2)	; dispatch on type
   284
   285	400166'	265 11 0 00 400255'	TASS1:	JSP	TLINK,GPRFCT	; get associated function name
   286	400167'	003 01 0 00 000455 		 ERROR.	1,301		; not a name
   287	400170'	274 01 0 00 400143*		SUB	STACK,XWD22##	; toss DDT
   288
   289	400171'	550 13 0 01 777777 		HRRZ	T3,-1(STACK)	; get address of VABLOK
   290	400172'	201 14 0 00 400157*		MOVEI	T4,FLAS		; point to value
   291	400173'	476 00 0 13 000011 		SETOM	VAFLG+1(T3)	; set interlock
   292	400174'	265 11 0 00 400347'		JSP	TLINK,VACALL	; call programmer's function
   293	400175'	254 00 0 00 400213'		 JRST	TASS2		; it failed
   294
   295						 ; Here upon successful return from programmer's function
   296
   297	400176'	262 01 0 00 000000#		POP	STACK,FLAS+1	; pop value to be
   298	400177'	262 01 0 00 400172*		POP	STACK,FLAS	;  assigned exposing the TVAR
   299	400200'	550 13 0 01 777777 		HRRZ	T3,-1(STACK)	; get address of VABLOK
   300	400201'	351 00 0 13 000011 		AOSL	VAFLG+1(T3)	; increment interlock flag and test
   301	400202'	254 00 0 00 400217'		 JRST	TASS4		; association still connected--go assign
   302
   303						 ; Here if the association function disconnected the VABLOK
   304						 ; by calling DISASSOCIATE.
   305
   306	400203'	274 01 0 00 400170*		SUB	STACK,XWD22##	; toss TVAR
   307	400204'	261 01 0 13 000004 		PUSH	STACK,VANAME(T3); push name of associated variable
   308	400205'	261 01 0 13 000005 		PUSH	STACK,VANAME+1(T3)
   309	400206'	201 15 0 00 064000 		MOVEI	Q1,VAR		; make it a VAR...
   310	400207'	506 15 0 01 777777 		HRLM	Q1,-1(STACK)	;  instead of NDT
   311	400210'	261 01 0 01 777777 		PUSH	STACK,-1(STACK)	; replicate variable...
   312	400211'	261 01 0 01 777777 		PUSH	STACK,-1(STACK)	;  for ASGNVL
   313	400212'	254 00 0 00 400223'		JRST	TASS5		; go assign value to the real variable
   314
   315						 ; Here if programmer's function failed
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 8-1
SNOPAV	MAC	13-Oct-66 22:26		Trap Handling -- TAVASS

   316
   317	400213'	550 13 0 01 777777 	TASS2:	HRRZ	T3,-1(STACK)	; get VABLOK address
   318	400214'	402 00 0 13 000011 		CLEARM	VAFLG+1(T3)	; clear interlock
   319	400215'	254 00 0 06 000000 		JRST	0(SLINK)	; indicate failure
   320
   321						 ; Here if trap is in-active--simply try to assign the value
   322
   323	400216'	274 01 0 00 400203*	TASS3:	SUB	STACK,XWD22##	; get rid of useless DDT
   324	400217'	540 13 0 01 777777 	TASS4:	HRR	T3,-1(STACK)	; get address of VABLOK
  400220'	505 13 0 00 064000 		HRLI	T3,VAR		; make a pointer to...
   326	400221'	261 01 0 00 000013 		PUSH	STACK,T3	;  the real value of...
   327	400222'	261 01 0 00 400436'		PUSH	STACK,[VAVAL]	;  the variable
   328
   329						 ; Merge here to assign the value to the variable.  We
   330						 ; may trigger other associations.
   331
   332	400223'	261 01 0 00 400177*	TASS5:	PUSH	STACK,FLAS	; put value to be assigned...
   333	400224'	261 01 0 00 000000#		PUSH	STACK,FLAS+1	;  back on stack
   334	400225'	265 11 0 00 000000*		JSP	TLINK,ASGNVL##	; do the assignment
   335	400226'	254 00 0 06 000000 		 JRST	0(SLINK)	; fail
   336
   337	400227'	274 01 0 00 400216*		SUB	STACK,XWD22##	; success--remove extra variable
   338	400230'	254 00 0 06 000001 		JRST	1(SLINK)	; return
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 9
SNOPAV	MAC	13-Oct-66 22:26		Process Description Access Function -- GPRTYP

   339						SUBTTL	Process Description Access Function -- GPRTYP
   340
   341					; GPRTYP -- get type field.  Call is
   342					;
   343					;	push descriptor for process defined datatype
   344					;	JSP	TLINK,GPRTYP
   345					;	 fail--PRTYP field is wrong datatype
   346					;	success--T2 is 0 for FETCH, 1 for STORE
   347					;
   348					; Type T, unstable.
   349					;
   350	400231'	202 11 0 00 000000*	GPRTYP::MOVEM	TLINK,TLNKSV##	; save the link
   351	400232'	200 12 0 01 777777 		MOVE	T2,-1(STACK)	; get DBLOK address
   352	400233'	261 01 0 12 000003 		PUSH	STACK,PRTYP(T2)	; push type field
   353	400234'	261 01 0 12 000004 		PUSH	STACK,PRTYP+1(T2)
   354	400235'	265 11 0 00 000000*		JSP	TLINK,CVTSTR##	; convert to string
   355	400236'	254 00 0 00 400253'		 JRST	TFAIL1		; fail--pop stack and return
   356
   357	400237'	265 15 0 00 000000*		JSP	QLINK,CVTPTR##	; success--convert to pointer
   358	400240'	000000	000000			0			; no basing
   359	400241'	254 00 1 00 400231*		JRST	@TLNKSV		; null string loses
   360	400242'	134 12 0 00 000000 		ILDB	T2,Z		; get first character
   361
   362	400243'	302 12 0 00 000123 		CAIE	T2,"S"		; STORE?
   363	400244'	306 12 0 00 000163 		CAIN	T2,"s"
   364						 JRST	[MOVEI	T2,1		; yes--get a one
   365	400245'	254 00 0 00 400437'			 JRST	TSUCC]		; return a winner
   366
   367	400246'	302 12 0 00 000106 		CAIE	T2,"F"		; FETCH?
   368	400247'	306 12 0 00 000146 		CAIN	T2,"f"
   369	400250'	634 12 0 00 000012 		 TDZA	T2,T2		; yes--return a zero
   370	400251'	254 00 1 00 400241*		JRST	@TLNKSV		; not FETCH or STORE
   371	400252'	254 00 0 00 400267'		JRST	TSUCC		; return a winner
   372
   373						 ; Here to pop stack and fail
   374
   375	400253'	274 01 0 00 400227*	TFAIL1:	SUB	STACK,XWD22##	; pop stack
   376	400254'	254 00 1 00 400251*	TFAIL:	JRST	@TLNKSV		; fail return
   377
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 10
SNOPAV	MAC	13-Oct-66 22:26		Process Description Access Function -- GPRFCT

   378						SUBTTL	Process Description Access Function -- GPRFCT
   379
   380					; GPRFCT -- get address of the variable block for the associated
   381					; programmer-defined function.  Call is
   382					;
   383					;	push descriptor for process defined datatype
   384					;	JSP	TLINK,GPRFCT
   385					;	 fail--bad datatype
   386					;	success--T2 contains variable block address
   387					;
   388					; Type T, unstable.
   389					;
   390	400255'	202 11 0 00 400254*	GPRFCT::MOVEM	TLINK,TLNKSV	; save the link
   391	400256'	200 12 0 01 777777 		MOVE	T2,-1(STACK)	; get DBLOK address
   392	400257'	261 01 0 12 000005 		PUSH	STACK,PRFCT(T2)	; push function descriptor
   393	400260'	261 01 0 12 000006 		PUSH	STACK,PRFCT+1(T2)
   394	400261'	265 11 0 00 400054*		JSP	TLINK,CVTNAM##	; convert to name
   395	400262'	254 00 0 00 400253'		 JRST	TFAIL1		; not a name--give error return
   396	400263'	332 00 0 01 000000 		SKIPE	0(STACK)	; natural variable?
   397	400264'	254 00 0 00 400253'		 JRST	TFAIL1		; no--fail
   398	400265'	550 12 0 01 777777 		HRRZ	T2,-1(STACK)	; yes--get variable block address
   399	400266'	274 01 0 00 400253*	TSUCC1:	SUB	STACK,XWD22##	; prune stack
   400	400267'	200 11 0 00 400255*	TSUCC:	MOVE	TLINK,TLNKSV	; restore link
   401	400270'	254 00 0 11 000001 		JRST	1(TLINK)	; return success
   402
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 11
SNOPAV	MAC	13-Oct-66 22:26		Process Description Access Function -- GPRLVL

   403						SUBTTL	Process Description Access Function -- GPRLVL
   404
   405					; GPRLVL -- get association level.  Call is
   406					;
   407					;	push descriptor for process defined datatype
   408					;	JSP	TLINK,GPRLVL
   409					;	 fail--bad datatype
   410					;	success--T2 contain integer level
   411					;
   412					; Type T, stable.
   413					;
   414	400271'	202 11 0 00 400267*	GPRLVL::MOVEM	TLINK,TLNKSV	; save the link
   415	400272'	200 12 0 01 777777 		MOVE	T2,-1(STACK)	; get DBLOK address
   416	400273'	261 01 0 12 000011 		PUSH	STACK,PRLVL(T2)	; push level descriptor
   417	400274'	261 01 0 12 000012 		PUSH	STACK,PRLVL+1(T2)
   418	400275'	265 11 0 00 000000*		JSP	TLINK,CVTINT##	; convert to integer
   419	400276'	254 00 0 00 400253'		 JRST	TFAIL1		; oops--bad datatype
   420	400277'	200 12 0 01 000000 		MOVE	T2,0(STACK)	; get value
   421	400300'	254 00 0 00 400266'		JRST	TSUCC1		; pop stack and return success
   422
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 12
SNOPAV	MAC	13-Oct-66 22:26		Process Description Access Function -- GPRACT

   423						SUBTTL	Process Description Access Function -- GPRACT
   424					; GPRACT -- get association active status.  Call is
   425					;
   426					;	push descriptor for process defined datatype
   427					;	JSP	TLINK,GPRACT
   428					;	 fail--bad datatype
   429					;	success--T2 is 0 if not active, 1 if active
   430					;
   431					; Type T, stable.
   432					;
   433	400301'	202 11 0 00 400271*	GPRACT::MOVEM	TLINK,TLNKSV	; save the link
   434	400302'	200 12 0 01 777777 		MOVE	T2,-1(STACK)	; get DBLOK address
   435	400303'	261 01 0 12 000007 		PUSH	STACK,PRACT(T2)	; push activity descriptor
   436	400304'	261 01 0 12 000010 		PUSH	STACK,PRACT+1(T2)
   437	400305'	265 11 0 00 400275*		JSP	TLINK,CVTINT	; convert to integer
   438	400306'	254 00 0 00 400253'		 JRST	TFAIL1		; fail
   439	400307'	336 00 0 01 000000 		SKIPN	0(STACK)	; active?
   440	400310'	634 12 0 00 000012 		 TDZA	T2,T2		; no--return zero
   441	400311'	201 12 0 00 000001 		MOVEI	T2,1		; yes--return 1
   442	400312'	254 00 0 00 400266'		JRST	TSUCC1		; pop stack and give success return
   443
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 13
SNOPAV	MAC	13-Oct-66 22:26		Utility Function -- FNDPOS

   444						SUBTTL	Utility Function -- FNDPOS
   445
   446					; FNDPOS -- find the proper position according to level in a chain
   447					; of trapping blocks.  Call is
   448					;
   449					;	MOVE	T2,addr of first value
   450					;	MOVE	T3,new level
   451					;	JSP	TLINK,FNDPOS
   452					;	return--T2 points to value that must be displaced
   453					;
   454					; Type T, stable.
   455					;
   456	400313'	202 11 0 00 000000*	FNDPOS::MOVEM	TLINK,SVTLNK##	; save the link
   457	400314'	202 13 0 00 000000*		MOVEM	T3,T3SAV	; save new level
   458
   459						 ; Walk down list until we find the proper place
   460
   461	400315'	554 15 0 12 000000 	POS1:	HLRZ	Q1,0(T2)	; get datatype of current value
   462	400316'	302 15 0 00 034000 		CAIE	Q1,TVAR		; trapped variable ?
   463	400317'	254 00 0 11 000000 		  JRST	0(TLINK)	; no--we are end of chain
   464
   465	400320'	550 15 0 12 000000 		HRRZ	Q1,0(T2)	; yes--get trapping block address
   466	400321'	554 16 0 15 000000 		HLRZ	Q2,BTCODE(Q1)	; get block code
   467	400322'	302 16 0 00 000414 		CAIE	Q2,VABLOK	; variable association block?
   468	400323'	254 00 0 00 400336'		  JRST	POS2		; no--must be one of the others
   469
   470						 ; Here if trapping block is one of ours
   471
   472	400324'	202 12 0 00 000000*		MOVEM	T2,T2SAV##	; yes--save T2
   473	400325'	261 01 0 15 000006 		PUSH	STACK,VAPROC(Q1); push process description
   474	400326'	261 01 0 15 000007 		PUSH	STACK,VAPROC+1(Q1)
   475	400327'	265 11 0 00 400271'		JSP	TLINK,GPRLVL	; get its level
   476	400330'	003 01 0 00 000460 		 ERROR.	1,304		; bad datatype
   477	400331'	274 01 0 00 400266*		SUB	STACK,XWD22##	; rid stack of DDT
   478	400332'	200 11 0 00 400313*		MOVE	TLINK,SVTLNK	; restore link
   479	400333'	200 17 0 00 000012 		MOVE	Q3,T2		; put level in Q3
   480	400334'	200 12 0 00 400324*		MOVE	T2,T2SAV	; restore T2
   481	400335'	254 00 0 00 400342'		JRST	POS3		; merge below
   482
   483						 ; Here for other trapping blocks (TRBLOK, IABLOK, & OABLOK)
   484
   485	400336'	301 16 0 00 000425 	POS2:	CAIL	Q2,TRBLOK	; is it one of...
   486	400337'	303 16 0 00 000427 		CAILE	Q2,OABLOK	;  the expected blok types?
   487	400340'	001 17 0 00 000000 		 ERROR	15		; no--we found a bug
   488	400341'	200 17 0 16 400014'		MOVE	Q3,[EXP TRLVL,IALVL,OALVL]-TRBLOK(Q2)	; yes--get default
   489
   490						 ; Here with Q3 = current trapping block's level
   491
   492	400342'	313 17 0 00 400314*	POS3:	CAMLE	Q3,T3SAV##	; found the right place?
   493	400343'	254 00 0 11 000000 		 JRST	0(TLINK)	; yes--return with T2 set up
   494	400344'	200 15 0 12 000000 		MOVE	Q1,0(T2)	; no--get trapping block address
   495	400345'	201 12 0 15 000002 		MOVEI	T2,VAVAL(Q1)	; point to next value
   496	400346'	254 00 0 00 400315'		JRST	POS1		; try again
   497
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 14
SNOPAV	MAC	13-Oct-66 22:26		Utility Function -- VACALL

   498						SUBTTL	Utility Function -- VACALL
   499
   500					; VACALL -- call a programmer defined function to effect the
   501					; trap.  Call is
   502					;
   503					;	load T2 with variable block address of function name
   504					;	load T3 with VABLOK address
   505					;	load T4 with address of second argument descriptor
   506					;	JSP	TLINK,VACALL
   507					;	 failed--stack unchanged
   508					;	success--returned value placed on stack
   509					;
   510					; Type T, unstable.
   511					;
   512	400347'	265 00 0 00 000000*	VACALL::PUSHR	PST		; elevate to...
   513	400350'	000012	000004
   514	400351'	265 00 0 00 000000*		PUSHSA	MIPS		; godly state
   515	400352'	000046	000000*
   516
   517	400353'	261 01 0 13 000004 		PUSH	STACK,VANAME(T3); first argument--name of variable
   518	400354'	261 01 0 13 000005 		PUSH	STACK,VANAME+1(T3)
   519	400355'	261 01 0 14 000000 		PUSH	STACK,0(T4)	; second argument--some value
   520	400356'	261 01 0 14 000001 		PUSH	STACK,1(T4)
   521	400357'	261 01 0 13 000006 		PUSH	STACK,VAPROC(T3); third argument--process description
   522	400360'	261 01 0 13 000007 		PUSH	STACK,VAPROC+1(T3)
   523	400361'	201 00 0 00 000003 		MOVEI	Z,3		; indicate 3 arguments
   524
   525	400362'	201 15 0 12 000003 		MOVEI	Q1,VFUNC(T2)	; get address of VFUNC field
   526	400363'	202 15 0 00 000000#		MOVEM	Q1,IGNOP+2	; save for &ERRPARM
   527	400364'	200 14 0 12 000003 		MOVE	T4,VFUNC(T2)	; get FBLOK address
   528	400365'	265 04 0 14 000003 		JSP	PLINK,FCODE(T4)	; call function
   529	400366'	265 15 0 00 400372'		 JSP	Q1,ACALL1	; fail--set Q1 non-zero and jump
   530
   531	400367'	400 15 0 00 000000 		CLEAR	Q1,		; indicate success
   532	400370'	262 01 0 00 000000#		POP	STACK,FLAQ##+1	; pop returned value
   533	400371'	262 01 0 00 000000*		POP	STACK,FLAQ##
   534
   535	400372'	265 00 0 00 000000*	ACALL1:	POPSA	MIPS		; restore the state...
   536	400373'	000046	400352*
   537	400374'	265 00 0 00 000000*		POPR	PST		;  of the system
   538	400375'	000011	000004
   539	400376'	326 15 0 11 000000 		JUMPN	Q1,0(TLINK)	; return if function failed
   540
   541	400377'	261 01 0 00 400371*		PUSH	STACK,FLAQ	; push on returned value
   542	400400'	261 01 0 00 000000#		PUSH	STACK,FLAQ+1
   543	400401'	254 00 0 11 000001 		JRST	1(TLINK)	; return
   544
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 15
SNOPAV	MAC	13-Oct-66 22:26		Utility Function -- CHKACT

   545						SUBTTL	Utility Function -- CHKACT
   546
   547					; CHKACT -- check activity status.  Also checks &ASSOCIATE.  Call
   548					; is
   549					;
   550					;	push TVAR on stack
   551					;	JSP	TLINK,CHKACT
   552					;	 here if datatype error
   553					;	 here if not active
   554					;	 here if active--Defined datatype placed on stack
   555					;
   556					; Type T, unstable.
   557					;
   558	400402'	336 00 0 00 000000*	CHKACT::SKIPN	$ASSOC##	; &ASSOCIATE = 0?
   559	400403'	254 00 0 11 000001 		 JRST	1(TLINK)	; yes--give speedy return
   560
   561	400404'	550 16 0 01 777777 		HRRZ	Q2,-1(STACK)	; get VABLOK address
   562	400405'	332 00 0 16 000011 		SKIPE	VAFLG+1(Q2)	; are we trying to recurse?
   563	400406'	254 00 0 11 000001 		 JRST	1(TLINK)	; yes--we are not active now
   564
   565	400407'	554 17 0 16 000006 		HLRZ	Q3,VAPROC(Q2)	; get datatype of process description
   566	400410'	302 17 0 00 004012 		CAIE	Q3,DDT		; defined datatype?
   567	400411'	254 00 0 11 000000 		 JRST	0(TLINK)	; no
   568	400412'	550 17 0 16 000006 		HRRZ	Q3,VAPROC(Q2)	; yes--get address of DBLOK
   569	400413'	550 17 0 17 000000 		HRRZ	Q3,BLENG(Q3)	; get length of DBLOK
   570	400414'	305 17 0 00 000011 		CAIGE	Q3,PRLEN	; enough?
   571	400415'	254 00 0 11 000000 		 JRST	0(TLINK)	; no
   572
   573	400416'	202 11 0 00 400332*		MOVEM	TLINK,SVTLNK	; save the link
   574	400417'	261 01 0 16 000006 		PUSH	STACK,VAPROC(Q2); push DDT descriptor on stack
   575	400420'	261 01 0 16 000007 		PUSH	STACK,VAPROC+1(Q2)
   576	400421'	265 11 0 00 400301'		JSP	TLINK,GPRACT	; get active field
   577						 JRST	[SUB	STACK,XWD22##	; bad datatype--prune stack
   578	400422'	254 00 0 00 400444'			 JRST	@SVTLNK]	; return
   579
   580	400423'	200 11 0 00 400416*		MOVE	TLINK,SVTLNK	; restore link
   581	400424'	326 12 0 11 000002 		JUMPN	T2,2(TLINK)	; return if active
   582	400425'	274 01 0 00 400331*		SUB	STACK,XWD22##	; prune stack
   583	400426'	254 00 0 11 000001 		JRST	1(TLINK)	; not active
   584
   585						END

NO ERRORS DETECTED

HI-SEG. BREAK IS 400446
PROGRAM BREAK IS 000000
CPU TIME USED 04:28.985

42P CORE USED
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page S-1
SNOPAV	MAC	13-Oct-66 22:26		SYMBOL TABLE

ACALL1		400372'		PAVMIN		000000	spd	TVAL3		400143'		
ASGNVL		400225'	ext	PAVSIX	604166	000000	spd	TVAL4		400144'		
ASSC		400000'	int	PAVVER		000005	spd	TVAR		034000	sin	
BLENG		000000	sin	PAVWHO		000000	spd	VABLOK		000414	sin	
BLOK		400017'	ext	PLINK		000004		VACALL		400347'	int	
BTCODE		000000	sin	POS1		400315'		VAFLG		000010	sin	
CHKACT		400402'	int	POS2		400336'		VALEN		000012	sin	
CVTINT		400305'	ext	POS3		400342'		VANAME		000004	sin	
CVTNAM		400261'	ext	PPL		000011	spd	VAPROC		000006	sin	
CVTPTR		400237'	ext	PPR		400374'	ext	VAR		064000	sin	
CVTSTR		400235'	ext	PPSA		400372'	ext	VAVAL		000002	sin	
CVTVAL		400121'	ext	PRACT		000007	sin	VFUNC		000003	sin	
DASSC		400052'	int	PRFCT		000005	sin	XWD22		400444'	ext	
DASSC1		400061'		PRLEN		000011	sin	Z		000000		
DASSC2		400077'		PRLVL		000011	sin	$ASSOC		400402'	ext	
DDT		004012	spd	PRTYP		000003	sin	%%JOBD	043100	000450	spd	
E1$300		000000	sin	PSHR		400347'	ext	%%MACT	000200	000025	spd	
E1$301		000000	sin	PSHSA		400351'	ext	%%SNOP	000500	000305	spd	
E1$302		000000	sin	Q1		000015		%%UUOS	001400	000457	spd	
E1$303		000000	sin	Q2		000016		
E1$304		000000	sin	Q3		000017		
E1$305		000000	sin	QLINK		000015		
E13$30		000000	sin	REGP		000004	spd	
E15$		000000	sin	RETNL1		400063'	ext	
E6$1		000000	sin	S1		000006		
ERR	001000	000000		S3		000010		
ERR.	003000	000000		SAVEM		400373'	ext	
FCODE		000003	sin	SLINK		000006		
FLAP		400060'	ext	STACK		000001		
FLAQ		400377'	ext	SVTLNK		400445'	ext	
FLAS		400223'	ext	T1		000011		
FNDPOS		400313'	int	T2		000012		
FTDEBU		000000	spd	T2SAV		400334'	ext	
FTPAV	777777	777777	spd	T3		000013		
GPRACT		400301'	int	T3SAV		400342'	ext	
GPRFCT		400255'	int	T4		000014		
GPRLVL		400271'	int	TASS1		400166'		
GPRTYP		400231'	int	TASS2		400213'		
IALVL		000310	sin	TASS3		400216'		
IDT		002001	sin	TASS4		400217'		
IGNOP		400037'	ext	TASS5		400223'		
IGNOS		400125'	ext	TAV		400101'	int	
LHDR		000002	sin	TAVASS		400156'		
LREGP		000002	spd	TAVNAM		400151'		
LREGS		000003	spd	TAVVAL		400104'		
LREGT		000004	spd	TFAIL		400254'		
LSAVEI		000010	spd	TFAIL1		400253'		
LSAVEM		000014	spd	TLINK		000011		
LSAVEP		000011	spd	TLNKSV		400301'	ext	
LSAVES		000011	spd	TRBLOK		000425	sin	
OABLOK		000427	sin	TRLVL		000144	sin	
OALVL		000454	sin	TSUCC		400267'		
P2		000005		TSUCC1		400266'		
PAVASC	502032	600000	spd	TVAL1		400112'		
PAVEDT		000135	spd	TVAL2		400140'		

SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 1
SNOPAV	MAC	13-Oct-66 22:26		DAVID R. HANSON/RCM/VB		15-JULY-76


Symbol cross reference

ACALL1	   529	   535#
ASGNVL	   334
ASSC	    83#
BLENG	    88	   569
BLOK	   104
BTCODE	   156	   466
CHKACT	   192	   276	   558#
CVTINT	   418	   437
CVTNAM	    98	   143	   394
CVTPTR	   357
CVTSTR	   354
CVTVAL	   209
DASSC	   140#
DASSC1	   151#	   170	   175
DASSC2	   159	   174#
DDT	    84	   566
E1$300	   197#	   281#
E1$301	   202#	   286#
E1$302	    85#
E1$303	    93#	    99#
E1$304	   476#
E1$305	   144#
E13$30	    90#
E15$	   487#
E6$1	   105#
FCODE	   528
FLAP	    95	    96	   115	   116	   140	   141	   147
FLAQ	   532	   533	   541	   542
FLAS	   212	   213	   217	   273	   274	   290	   297	   298	   332	   333
FNDPOS	   127	   456#
FTDEBU	   512	   514	   535	   537
FTPAV	    44
GPRACT	   433#	   576
GPRFCT	   201	   285	   390#
GPRLVL	    92	   414#	   475
GPRTYP	   196	   280	   350#
IALVL	   488
IDT	   111
IGNOP	    94	   126	   526
IGNOS	   203	   215
LHDR	   174
LREGP	   512	   537
LREGS	   512	   537
LREGT	   512	   537
LSAVEI	   514	   535
LSAVEM	   514	   535
LSAVEP	   514	   535
LSAVES	   514	   535
OABLOK	   486
OALVL	   488
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 1
SNOPAV	MAC	13-Oct-66 22:26		DAVID R. HANSON/RCM/VB		15-JULY-76


Symbol cross reference

P2	   107	   112	   113	   117	   118	   122	   123	   130	   131	   132	   133	   145	   146	   151
	   155	   168	   169	   174
PAVASC	    33#
PAVEDT	    26#
PAVMIN	    25#
PAVSIX	    32#
PAVVER	    24#
PAVWHO	    27#
PLINK	   528
POS1	   461#	   496
POS2	   468	   485#
POS3	   481	   492#
PPL	   512#	   512	   513	   514#	   514	   515	   535#	   535	   536	   537#	   537	   538
PPR	   537
PPSA	   535
PRACT	   435	   436
PRFCT	   392	   393
PRLEN	    89	   570
PRLVL	   416	   417
PRTYP	   352	   353
PSHR	   512
PSHSA	   514
Q1	   111	   112	   115	   116	   117	   118	   128	   129	   130	   131	   134	   135	   151	   152
	   156	   157	   166	   167	   168	   169	   309	   310	   461	   462	   465	   466	   473	   474
	   494	   495	   525	   526	   529	   531	   539
Q2	   466	   467	   485	   486	   488	   561	   562	   565	   568	   574	   575
Q3	   479	   488	   492	   565	   566	   568	   569	   570
QLINK	   104	   357
REGP	   512	   513	   537	   538
RETNL1	   137	   153
S1	   155	   156	   158	   163	   166	   167	   174
S3	   147	   158
SAVEM	   514	   514#	   515	   535	   536
SLINK	   211	   228	   234	   243	   260	   319	   335	   338
STACK	    83	    87	    95	    96	   106	   107	   120	   121	   140	   141	   145	   146	   204	   206
	   207	   208	   210	   212	   213	   216	   224	   226	   227	   232	   238	   239	   240	   241
	   242	   256	   258	   273	   274	   287	   289	   297	   298	   299	   306	   307	   308	   310
	   311	   312	   317	   323	   324	   326	   327	   332	   333	   337	   351	   352	   353	   375
	   391	   392	   393	   396	   398	   399	   415	   416	   417	   420	   434	   435	   436	   439
	   473	   474	   477	   517	   518	   519	   520	   521	   522	   532	   533	   541	   542	   561
	   574	   575	   577	   582
SVTLNK	   456	   478	   573	   578	   580
T1	    83	    84	    87	    88	    89
T2	    94	   120	   121	   122	   123	   125	   128	   129	   133	   135	   199	   203	   215	   283
	   351	   352	   353	   360	   362	   363	   364	   367	   368	   369	   391	   392	   393	   398
	   415	   416	   417	   420	   434	   435	   436	   440	   441	   461	   465	   472	   479	   480
	   494	   495	   525	   527	   581
T2SAV	   472	   480
T3	   125	   126	   206	   207	   208	   216	   218	   224	   225	   232	   233	   239	   240	   241
	   242	   255	   256	   257	   258	   289	   291	   299	   300	   307	   308	   317	   318	   324
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 1
SNOPAV	MAC	13-Oct-66 22:26		DAVID R. HANSON/RCM/VB		15-JULY-76


Symbol cross reference

	   325	   326	   457	   517	   518	   521	   522
T3SAV	   457	   492
T4	   217	   290	   519	   520	   527	   528
TASS1	   283	   285#
TASS2	   293	   317#
TASS3	   282	   323#
TASS4	   277	   278	   301	   324#
TASS5	   313	   332#
TAV	   134	   179#
TAVASS	   181	   273#
TAVNAM	   180	   255#
TAVVAL	   179	   192#
TFAIL	   376#
TFAIL1	   355	   375#	   395	   397	   419	   438
TLINK	    92	    98	   127	   143	   192	   196	   201	   209	   219	   276	   280	   285	   292	   334
	   350	   354	   390	   394	   400	   401	   414	   418	   433	   437	   456	   463	   475	   478
	   493	   539	   543	   559	   563	   567	   571	   573	   576	   580	   581	   583
TLNKSV	   350	   359	   370	   376	   390	   400	   414	   433
TRBLOK	   485	   488
TRLVL	   488
TSUCC	   365	   371	   400#
TSUCC1	   399#	   421	   442
TVAL1	   198	   201#
TVAL2	   220	   232#
TVAL3	   199	   238#
TVAL4	   193	   194	   239#
TVAR	   132	   152	   462
VABLOK	   103	   157	   467
VACALL	   219	   292	   512#
VAFLG	   112	   113	   163	   218	   225	   233	   291	   300	   318	   562
VALEN	   103
VANAME	   122	   123	   307	   308	   517	   518
VAPROC	   117	   118	   158	   473	   474	   521	   522	   565	   568	   574	   575
VAR	   255	   309	   325
VAVAL	   130	   131	   166	   167	   207	   208	   241	   242	   257	   327	   495
VFUNC	   525	   527
XWD22	   204	   210	   238	   287	   306	   323	   337	   375	   399	   477	   577	   582
Z	   103	   106	   360	   512	   514	   523	   535	   537
$ASSOC	   558
SNOPAV - Programmer Defined Variable Associations  %5(135)	MACRO %53B(1156)-1 21:48 14-Mar-88 Page 1
SNOPAV	MAC	13-Oct-66 22:26		DAVID R. HANSON/RCM/VB		15-JULY-76


Macro/Opdef cross reference

DMOVE	   115	   120	   128	   166
DMOVEM	   117	   122	   130	   168
ERR	   105	   487
ERR.	    85	    90	    93	    99	   144	   197	   202	   281	   286	   476
ERROR	   105	   487
ERROR.	    85	    90	    93	    99	   144	   197	   202	   281	   286	   476
MIDENT	   513	   515	   536	   538
PAVPTX	    47
PAVTTL	    46
POPR	   537
POPSA	   535
PPADDR	   512#	   513	   514#	   515	   535#	   536	   537#	   538
PPINIT	   512	   514	   535	   537
PPLENG	   512#	   513	   514#	   515	   535#	   536	   537#	   538
PUSHR	   512
PUSHSA	   514
SHOW.	    39	    40	    41	    42
TITLE.	    31    ]@ö