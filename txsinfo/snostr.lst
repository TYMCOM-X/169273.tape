SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 1
SNOSTR	MAC	13-Oct-66 22:05		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76

     1						SUBTTL	Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76
     2
     3					; COPYRIGHTS 1972,1973,1976,1977  STEVENS INSTITUTE OF TECHNOLOGY
     4					; HOBOKEN, NEW JERSEY, 07030
     5					; ALL RIGHTS RESERVED.
     6
     7					  ;UNIVERSALS
     8
     9						SEARCH	JOBDAT		;JOB DATA AREA DEFINITIONS
    10						SEARCH	MACTEN		;DEC-10 COMMON MACROS
    11						SEARCH	UUOSYM		;TOPS10 UUO SYMBOL DEFINITIONS
    12						SEARCH	SNOPRM		;SITBOL PARAMETER FILE
    13
    14					  ;DIRECTIVES
    15
    16						.DIRECT	.XTABM		;EXCLUDE TABS FROM MACRO CALLS
    17						SALL			;SUPPRESS MACRO EXPANSIONS
    18	400000'					TWOSEG	400K		;TWOSEGMENT CODE
    19
    20					  ;VERSION NUMBER
    21
    22			000005			STRVER==5		;MAJOR VERSION NUMBER
    23			000000			STRMIN==0		;MINOR VERSION NUMBER
    24			000233			STREDT==233		;EDIT LEVEL
    25			000000			STRWHO==0		;CUSTOMER ARGUMENT
    26
    27					  ;TITLE
    28
    29						TITLE.	STR,SNOSTR,<Strings>
    30		636462	000000			STRSIX==SIXBIT /STR/	; SNOSTR ABBREVIATION IN SIXBIT
    31		516512	200000			STRASC==ASCIZ /STR/	; SNOSTR ABBREVIATION IN ASCII
    32						SALL
    33
    34
    35					  ;SHOW UNIVERSAL VERSION NUMBERS
    36
    37	400000'	043100	000450			SHOW.	%%JOBD		;VERSION NUMBER OF JOBDAT
    38	400000'	000200	000025			SHOW.	%%MACT		;VERSION NUMBER OF MACTEN
    39	400000'	001400	000457			SHOW.	%%UUOS		;VERSION NUMBER OF UUOSYM
    40	400000'	000500	000305			SHOW.	%%SNOP		;VERSION NUMBER OF SNOPRM
    41
    42						STRTTL			; Title
    43						STRPTX			; PASS2 assembly message
SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 2
SNOSTR	MAC	13-Oct-66 22:05		Table of Contents

    44						SUBTTL	Table of Contents
    45
    46					;		Table of Contents for Strings
    47					;
    48					;
    49					;			   Section			      Page
    50					;   1. Table of Contents. . . . . . . . . . . . . . . . . . .    2
    51					;   2. REVISION HISTORY . . . . . . . . . . . . . . . . . . .    3
    52					;   3. ASCII. . . . . . . . . . . . . . . . . . . . . . . . .    4
    53					;   4. CAT - THE CONCATENATION OPERATOR . . . . . . . . . . .    5
    54					;   5. DIFFER & IDENT . . . . . . . . . . . . . . . . . . . .    6
    55					;   6. DUPL(S,N). . . . . . . . . . . . . . . . . . . . . . .    7
    56					;   7. THE LEXICAL COMPARISON PREDICATES. . . . . . . . . . .    8
    57					;   8. LPAD & RPAD. . . . . . . . . . . . . . . . . . . . . .    9
    58					;   9. REPLACE(S1,S2,S3). . . . . . . . . . . . . . . . . . .   11
    59					;  10. REVERSE(S) . . . . . . . . . . . . . . . . . . . . . .   13
    60					;  11. SIZE(S). . . . . . . . . . . . . . . . . . . . . . . .   14
    61					;  12. SUBSTR(S,K,L). . . . . . . . . . . . . . . . . . . . .   15
    62					;  13. TRIM(S). . . . . . . . . . . . . . . . . . . . . . . .   16
    63					;  14. ASBLOK . . . . . . . . . . . . . . . . . . . . . . . .   17
    64					;  15. CONCAT - CONCATENATE STRINGS . . . . . . . . . . . . .   18
    65					;  16. DUPLI - INTERNAL FORM OF DUPL. . . . . . . . . . . . .   19
    66					;  17. EQINIT - INITIALIZATION FOR EQUAL AND LEQUAL . . . . .   20
    67					;  18. EQUAL - TESTS FOR EQUALITY BETWEEN STRINGS . . . . . .   21
    68					;  19. IDINIT & IDENT . . . . . . . . . . . . . . . . . . . .   22
    69					;  20. LEQUAL - LEXICAL TEST FOR STRINGS. . . . . . . . . . .   23
    70					;  21. STCON - STRING CONSTANT (TO GROWING AREA). . . . . . .   24
SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 3
SNOSTR	MAC	13-Oct-66 22:05		REVISION HISTORY

    71						SUBTTL	REVISION HISTORY
    72
    73					COMMENT	\
    74
    75					START OF VERSION 5.
    76					122	RENAME MODULES & CLEAN UP.
    77					226	REPLACE with unequal second and third arguments should fail
    78						not give an error message.
    79					233	FIX EDIT 226, SO REPLACE WILL WORK.
    80					\
SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 4
SNOSTR	MAC	13-Oct-66 22:05		ASCII

    81						SUBTTL	ASCII
    82
    83					;	ASCII(N) WILL RETURN A SINGLE CHARACTER SPECIFIED BY THE
    84					;	INTEGER N.	N IS INTERPRETED AS AN OCTAL NUMBER.
    85					;	THUS, ASCII(11) IS THE TAB CHARACTER.
    86
    87	400000'				ASCI.0::ASCII:
    88	400000'	265 11 0 00 000000*		JSP	TLINK,CVTINT##	; MAKE SURE ARG IS INTEGER
    89	400001'	003 01 0 00 000153 		ERROR.	1,107		; BAD ARG.
    90	400002'	262 01 0 00 000006 		POP	STACK,S1	; INTEGER IS PLACED IN S1
    91	400003'	262 01 0 00 000000 		POP	STACK,Z		; THIS IS GARBAGE.
    92	400004'	400 05 0 00 000000 		CLEAR	P2,		; SHIFT COUNT IN P2
    93	400005'	403 07 0 00 000010 		CLEARB	S2,S3		; CLEAR S2 IN CASE OF 0
    94									; ACCUMULATED VALUE IS HELD IN S3
    95
    96	400006'	322 06 0 00 400015'	ASC.1:	JUMPE	S1,ASC.2	; DONE IF S1 FALLS TO 0
    97	400007'	231 06 0 00 000012 		IDIVI	S1,^D10		; INTERPRET THE NUMBER AS DECIMAL
    98									; REMAINDER GOES TO S2
    99	400010'	303 07 0 00 000007 		CAILE	S2,7		; ARE WE AN OCTAL LOOKING NUMBER
   100	400011'	001 15 0 00 000066 		ERROR	13,54		; NOPE -- BAD ARG TO ASCII
   101	400012'	246 07 0 00 777775 		LSHC	S2,-3		; SHIFT REM. INTO S3
   102	400013'	271 05 0 00 000003 		ADDI	P2,3		; RECORD AMOUNT OF SHIFT IN P2
   103	400014'	254 00 0 00 400006'		JRST	ASC.1		; LOOP
   104
   105	400015'				ASC.2:
   106	400015'	246 07 0 05 000000 		LSHC	S2,(P2)		; CORRECT VALUE IN S2
   107	400016'	301 07 0 00 000200 		CAIL	S2,^D128	; MUST BE LESS THAN 128
   108	400017'	001 15 0 00 000072 		ERROR	13,58		; ERRONEOUS ARG TO ASCII
   109	400020'	504 07 0 00 000007 		HRL	S2,S2		; PUT OFFSET INTO LEFT HALF
   110	400021'	541 07 0 00 000001 		HRRI	S2,1		; LENGTH OF STRING IS 1
   111	400022'	261 01 0 00 000000*		PUSH	STACK,$ALPHA##	; SBLOK IS &ALPHABET
   112	400023'	261 01 0 00 000007 		PUSH	STACK,S2	; COMPLETE STRING DESC.
   113	400024'	254 00 0 04 000001 		JRST	1(PLINK)	; SUCCESSFUL RETURN
   114

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 5
SNOSTR	MAC	13-Oct-66 22:05		CAT - THE CONCATENATION OPERATOR

   115						SUBTTL	CAT - THE CONCATENATION OPERATOR
   116
   117					;	STRING CONCATENATION IS HANDLED HERE
   118					;	PATTERN CONCATENATION (AS WELL AS ANY OTHER
   119					;	KIND) IS HANDLED ELSEWHERE.
   120					;	NONSTRING ARGUMENTS ARE PASSED OFF TO CATP.
   121
   122	400025'	205 05 0 00 004003 	CAT::	MOVSI	P2,SDT		; LOAD P2 WITH NULL STRING TOP
   123	400026'	316 05 0 01 777777 		CAMN	P2,-1(STACK)	; SKIP IF 2ND ARG IS NONNULL
   124	400027'	254 00 0 00 400052'		JRST	CAT1		; TAKE BRANCH FOR NULL 2ND ARG
   125	400030'	316 05 0 01 777775 		CAMN	P2,-3(STACK)	; CHECK 1ST ARG FOR NULL
   126	400031'	254 00 0 00 400054'		JRST	CAT2		; BRANCH IF FIRST IS NULL
   127
   128							;	HERE IF NEITHER ARG IS NULL
   129
   130	400032'	265 11 0 00 000000*		JSP	TLINK,CVTSTR##	; TRY TO CONVERT 2ND ARG
   131	400033'	254 00 0 00 000000*		JRST	CATP##		; NO GO - LET PATTERNS HANDLE THIS
   132	400034'	262 01 0 00 000000#		POP	STACK,FLAP+1	; SAVE THE STRNG IN THE FLAP## ...
   133	400035'	262 01 0 00 000000*		POP	STACK,FLAP##	; REGION
   134
   135	400036'	265 11 0 00 400032*		JSP	TLINK,CVTSTR	; CONVERT THE 1ST ARG. TO STRING
   136	400037'	254 00 0 00 400057'		JRST	CAT3		; NO GO - TAKE BRANCH
   137
   138	400040'	262 01 0 00 000000#		POP	STACK,FLAP##+3	; REMOVE THE DESCRIPTOR ...
   139	400041'	262 01 0 00 000000#		POP	STACK,FLAP##+2	; FROM THE STACK
   140	400042'	261 01 0 00 400035*		PUSH	STACK,FLAP##	; NOW PUSH ...
   141	400043'	261 01 0 00 000000#		PUSH	STACK,FLAP##+1	; THESE DESCRIPTORS ...
   142	400044'	261 01 0 00 000000#		PUSH	STACK,FLAP##+2	; BACK ONTO ...
   143	400045'	261 01 0 00 000000#		PUSH	STACK,FLAP##+3	; THE STACK
   144
   145	400046'	201 00 0 00 000002 		MOVEI	Z,2		; SET UP ARGUMENT TO CONCAT
   146	400047'	265 11 0 00 400504'		JSP	TLINK,CONCAT	; CALL CONCATENATE
   147	400050'	001 13 0 00 000015 		ERROR	11,13		; EXCEEDED &MAXLNGTH
   148	400051'	254 00 0 04 000001 		JRST	1(PLINK)	; NORMAL RETURN
   149
   150							;	IF 2ND ARG IS NULL CONTROL ARRIVES HERE
   151	400052'	274 01 0 00 401043'	CAT1:	SUB	STACK,[XWD 2,2]	; REMOVE 2ND ARGUMENT
   152	400053'	254 00 0 04 000001 		JRST	1(PLINK)	; RETURN SUCCESS
   153	
   154							; 	IF FIRST ARG IS NULL CONTROL ARRIVES HERE
   155	400054'	262 01 0 01 777776 	CAT2:	POP	STACK,-2(STACK)	; REMOVE 1ST ...
   156	400055'	262 01 0 01 777776 		POP	STACK,-2(STACK)	; ARGUMENT
   157	400056'	254 00 0 04 000001 		JRST	1(PLINK)	; RETURN SUCCESS
   158
   159							; 	IF 1ST ARG IS STRANGE, COME HERE
   160	400057'	261 01 0 00 400042*	CAT3:	PUSH	STACK,FLAP##	; PUSH 2ND ARG ...
   161	400060'	261 01 0 00 000000#		PUSH	STACK,FLAP##+1	; ONTO STACK
   162	400061'	254 00 0 00 400033*		JRST	CATP		; LET PATTERN BUILDER HANDLE THIS
   163

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 6
SNOSTR	MAC	13-Oct-66 22:05		DIFFER & IDENT

   164						SUBTTL	DIFFER & IDENT
   165
   166					;	THE BUILT-IN FUNCTIONS DIFFER(X,Y) AND IDENT(X,Y)
   167
   168	400062'	265 11 0 00 400630'	DFFR::	JSP	TLINK,IDINIT	; USE TYPE
   169	400063'	265 11 0 00 400670'		JSP	TLINK,IDENT	; T ROUTINES
   170	400064'	254 00 0 00 000000*		JRST	RETNUL##	; SUCCEED
   171	400065'	254 00 0 04 000000 		JRST	0(PLINK)	; FAIL
   172
   173
   174	400066'	265 11 0 00 400630'	IDENT0::JSP	TLINK,IDINIT	; T
   175	400067'	265 11 0 00 400670'		JSP	TLINK,IDENT	; ROUTINES
   176	400070'	254 00 0 04 000000 		JRST	0(PLINK)	; FAIL
   177	400071'	254 00 0 00 400064*		JRST	RETNUL##	; SUCCEED
   178

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 7
SNOSTR	MAC	13-Oct-66 22:05		DUPL(S,N)

   179						SUBTTL	DUPL(S,N)
   180
   181	400072'	265 11 0 00 400000*	DUPL::	JSP	TLINK,CVTINT	; CONVERT 2ND ARG TO INTEGER
   182	400073'	003 01 0 00 000077 		ERROR.	1,63		; BAD 2ND ARG
   183	400074'	262 01 0 00 000007 		POP	STACK,S2	; SAVE VALUE OF N
   184	400075'	262 01 0 00 000000 		POP	STACK,Z		; THIS IS GARBAGE
   185
   186	400076'	321 07 0 00 000000*		JUMPL	S2,FRET1##	; NEGATIVE N WILL CAUSE FAILURE
   187
   188	400077'	265 11 0 00 400036*		JSP	TLINK,CVTSTR	; CONVERT FIRST ARGUMENT
   189	400100'	003 01 0 00 000100 		ERROR.	1,64		; BAD 1ST ARGUMENT
   190	400101'	200 00 0 00 000007 		MOVE	Z,S2		; LOAD REG 0 WITH N
   191	400102'	265 11 0 00 400540'		JSP	TLINK,DUPLI	; CALL UTILITY FOR DUPLICATING
   192	400103'	001 13 0 00 000012 		ERROR	11,10		; EXCEEDED &MAXLNGTH
   193	400104'	254 00 0 04 000001 		JRST	1(PLINK)	; NORMAL RETURN
   194

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 8
SNOSTR	MAC	13-Oct-66 22:05		THE LEXICAL COMPARISON PREDICATES

   195						SUBTTL	THE LEXICAL COMPARISON PREDICATES
   196
   197					;		LEQ	 LGE	 LGT	 LLE	 LLT	 LNE
   198
   199	400105'	205 05 0 00 002000 	LEQ::	MOVSI	P2,2000		; INSERT JUMP CODE FOR JUMPE
   200	400106'	254 00 0 00 400120'		JRST	LEX		; JOIN COMMON PROCESSING
   201
   202	400107'	205 05 0 00 005000 	LGE::	MOVSI	P2,5000		;INSERT CODE FOR JUMPGE
   203	400110'	254 00 0 00 400120'		JRST	LEX		; JOIN COMMON CODE
   204
   205	400111'	205 05 0 00 007000 	LGT::	MOVSI	P2,7000		; INSERT CODE FOR JUMPG
   206	400112'	254 00 0 00 400120'		JRST	LEX		; JOIN COMMON CODE
   207
   208	400113'	205 05 0 00 003000 	LLE::	MOVSI	P2,3000		; INSERT CODE FOR JUMPLE
   209	400114'	254 00 0 00 400120'		JRST	LEX		; JOIN COMMON CODE
   210
   211	400115'	205 05 0 00 001000 	LLT::	MOVSI	P2,1000		; INSERT CODE FOR JUMPL
   212	400116'	254 00 0 00 400120'		JRST	LEX		; JOIN COMMON CODE
   213
   214	400117'	205 05 0 00 006000 	LNE::	MOVSI	P2,6000		; INSERT CODE FOR JUMPN
   215					;	JRST	LEX		; JOIN COMMON CODE
   216
   217
   218					;	MERGE HERE FROM ALL 6 LEXICAL ENTRY POINTS.
   219	400120'	265 11 0 00 400077*	LEX:	JSP	TLINK,CVTSTR	; MAKE SURE 2ND ARG IS STRING
   220	400121'	003 01 0 00 000044 		ERROR.	1,36		; BAD 2ND ARG.
   221	400122'	262 01 0 00 000000#		POP	STACK,FLAP##+1	; SAVE THIS DESCRIPTOR ...
   222	400123'	262 01 0 00 400057*		POP	STACK,FLAP##	; IN THE FLAP## REGION 
   223	400124'	265 11 0 00 400120*		JSP	TLINK,CVTSTR	; MAKE SURE FIRST ARGUMENT IS STRING
   224	400125'	003 01 0 00 000043 		ERROR.	1,35		; BAD FIRST ARGUMENT
   225
   226					;	IN THE SUBSEQUENT COMPUTATION S1 WILL BE SET POSITIVE,
   227					;	ZERO, OR NEGATIVE DEPENDING ON WHETHER THE FIRST
   228					;	ARGUMENT IS RESPECTIVELY GREATER THAN, EQUAL TO , OR LESS 
   229					;	THAN THE 2ND ARGUMENT.
   230
   231					;	MERGE HERE FROM IDENT AND DIFFER (STRING CASE)
   232	400126'	400 06 0 00 000000 	LEXC:	SETZ	S1,		; INITIALIZE S1 TO 0
   233	400127'	265 11 0 00 400576'		JSP	TLINK,EQINIT	; GO INITIALIZE LEQUAL TEST
   234	400130'	254 00 0 00 400142'		JRST	LEXC1		; MUST HAVE BEEN NULL STRING
   235	400131'	261 01 0 00 400123*		PUSH	STACK,FLAP##	; PUSH THE 2ND ARGUMENT
   236	400132'	261 01 0 00 000000#		PUSH	STACK,FLAP##+1	; ONTO THE STACK
   237	400133'	265 11 0 00 400704'		JSP	TLINK,LEQUAL	; GO CALL LEXICAL COMPARISON
   238	400134'	201 06 0 00 000001 		MOVEI	S1,1		; 2ND LESS THAN FIRST
   239	400135'	334 00 0 00 000000 		SKIPA			; 2ND = FIRST
   240	400136'	474 06 0 00 000000 	LX.2ND:	SETO	S1,		; 2ND GREATER THAN FIRST
   241
   242					;	MERGE HERE FROM LEXC1 (FIRST ARG HAD BEEN NULL)
   243	400137'	434 05 0 00 401044'	LX.CMP:	IOR	P2,[JUMP S1,RETNUL]	; INSERT REST OF INSTR.
   244	400140'	256 00 0 00 000005 		XCT	P2		; RETURN NULL IF S1 SATISFIES
   245									; SPECIFIED CONDITION.
   246	400141'	254 00 0 04 000000 		JRST	0(PLINK)	; OTHERWISE FAIL
   247
   248	400142'	274 01 0 00 401043'	LEXC1:	SUB	STACK,[2,,2]	; POP NULL STRING 
SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 8-1
SNOSTR	MAC	13-Oct-66 22:05		THE LEXICAL COMPARISON PREDICATES

   249	400143'	200 07 0 00 400131*		MOVE	S2,FLAP##	; LOAD FIRST WORD OF 2ND ARG
   250	400144'	312 07 0 00 000000*		CAME	S2,NULLST##	; IS THIS ALSO THE NULL STRING
   251	400145'	254 00 0 00 400136'		JRST	LX.2ND		; NO - 2ND ARG IS GREATER
   252	400146'	254 00 0 00 400137'		JRST	LX.CMP		; YES - 2ND ARG IS ALSO NULL
   253									; S1 IS ALREADY 0 - GO MAKE COMP.
   254

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 9
SNOSTR	MAC	13-Oct-66 22:05		LPAD & RPAD

   255						SUBTTL	LPAD & RPAD
   256
   257	400147'	265 06 0 00 400164'	LPAD::	JSP	SLINK,PADCOM	; OFF TO COMMON ROUTINE
   258
   259					;	MERGE HERE FROM RPAD
   260	400150'	201 00 0 00 000002 	LPAD1:	MOVEI	Z,2		; INDICATE 2 ARGS FOR
   261	400151'	265 11 0 00 400504'		JSP	TLINK,CONCAT	; CONCATENATE
   262	400152'	001 13 0 00 000013 		ERROR	11,11		; EXCEEDED &MAXLNGTH
   263	400153'	254 00 0 04 000001 		JRST	1(PLINK)	; NORMAL RETURN
   264
   265	400154'	265 06 0 00 400164'	RPAD::	JSP	SLINK,PADCOM	; PROCESS ARGS
   266	400155'	200 00 0 01 000000 		MOVE	Z,0(STACK)	; EXCHANGE
   267	400156'	250 00 0 01 777776 		EXCH	Z,-2(STACK)	; THE
   268	400157'	202 00 0 01 000000 		MOVEM	Z,0(STACK)	; TOP
   269	400160'	200 00 0 01 777777 		MOVE	Z,-1(STACK)	; TWO
   270	400161'	250 00 0 01 777775 		EXCH	Z,-3(STACK)	; DESCRIP-
   271	400162'	202 00 0 01 777777 		MOVEM	Z,-1(STACK)	; TORS
   272	400163'	254 00 0 00 400150'		JRST	LPAD1
   273

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 10
SNOSTR	MAC	13-Oct-66 22:05		LPAD & RPAD

   274					;	HERE TO PROCESS ARGS FOR LPAD AND RPAD
   275					;	AN S-TYPE ROUTINE WHICH LEAVES TWO STRINGS
   276					;	ON THE STACK.	THE FIRST IS THE FIRST STRING
   277					;	ARGUMENT.	THE SECOND IS THE 3RD ARGUMENT
   278					;	DUPLICATED THE CORRECT NUMBER OF TIMES.
   279
   280	400164'				PADCOM:
   281	400164'	302 00 0 00 000002 		CAIE	Z,2		; SKIP ON NORMAL 2-ARG CASE
   282	400165'	254 00 0 00 400171'		JRST	PAD3		; MUST BE 3 ARGS
   283	400166'	261 01 0 00 400022*		PUSH	STACK,$ALPHA	; PUSH BLANK ...
   284	400167'	261 01 0 00 401045'		PUSH	STACK,[XWD " ",1]	; ONTO STACK
   285	400170'	254 00 0 00 400200'		JRST	PAD1		; JOIN PROCESSING
   286
   287	400171'	302 00 0 00 000003 	PAD3:	CAIE	Z,3		; SKIP IF 3 ARGS
   288	400172'	001 15 0 00 000071 		ERROR	13,57		; HE GOOFED
   289	400173'	265 11 0 00 400124*		JSP	TLINK,CVTSTR	; MAKE IT A STRING
   290	400174'	003 01 0 00 000113 		ERROR.	1,75		; BAD 3RD ARGUMENT
   291	400175'	550 07 0 01 000000 		HRRZ	S2,0(STACK)	; LOAD LENGTH TO S2
   292	400176'	302 07 0 00 000001 		CAIE	S2,1		; IF 1 SKIP
   293	400177'	001 15 0 00 000070 		ERROR	13,56		; OTHERWISE HE ERRED
   294
   295					;	MERGE HERE FROM THE 2 ARG CASE
   296	400200'	262 01 0 00 000000#	PAD1:	POP	STACK,FLAP+1	; SAVE THE 3RD ARG
   297	400201'	262 01 0 00 400143*		POP	STACK,FLAP	; IN THE FLAP AREA
   298
   299	400202'	265 11 0 00 400072*		JSP	TLINK,CVTINT	; CONVERT 2ND ARG
   300	400203'	003 01 0 00 000114 		ERROR.	1,76		; BAD 2ND ARG
   301	400204'	262 01 0 00 000007 		POP	STACK,S2	; SAVE VALUE IN S2
   302	400205'	262 01 0 00 000000 		POP	STACK,Z		; GET RID OF DATATYPE
   303
   304	400206'	265 11 0 00 400173*		JSP	TLINK,CVTSTR	; CONVERT 1ST ARG
   305	400207'	003 01 0 00 000115 		ERROR.	1,77		; BAD 1ST ARG
   306	400210'	550 10 0 01 000000 		HRRZ	S3,0(STACK)	; LENGTH TO S3
   307	400211'	274 07 0 00 000010 		SUB	S2,S3		; NUMBER OF CHARS. NEEDED TO S2
   308	400212'	323 07 0 04 000001 		JUMPLE	S2,1(PLINK)	; IF WE HAVE ENOUGH, RETURN
   309
   310	400213'	200 00 0 00 000007 		MOVE	Z,S2		; LOAD ARG FOR CALL TO DUPL
   311	400214'	261 01 0 00 400201*		PUSH	STACK,FLAP	; PUSH PAD ...
   312	400215'	261 01 0 00 000000#		PUSH	STACK,FLAP+1	; CHAR. BACK ONTO STACK
   313	400216'	265 11 0 00 400540'		JSP	TLINK,DUPLI	; DUPLICATE PAD CHAR
   314	400217'	001 13 0 00 000013 		ERROR	11,11		; STRING TOO LONG
   315	400220'	254 00 0 06 000000 		JRST	0(SLINK)	; RETURN TO SENDER
   316

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 11
SNOSTR	MAC	13-Oct-66 22:05		REPLACE(S1,S2,S3)

   317						SUBTTL	REPLACE(S1,S2,S3)
   318
   319					;	EFFIC IS OBTAINED BY NOT BUILDING A TABLE
   320					;	IF S2 AND S3 ARE THE SAME AS 'LAST TIME'
   321
   322	400221'	200 11 0 00 000001 	RPLC::	MOVE	T1,STACK	; SAVE THE STACK
   323	400222'	201 06 0 00 000003 		MOVEI	S1,3		; THERE ARE 4 WORDS TO BE COMPARED
   324	400223'	262 01 0 00 000007 	RPL4:	POP	STACK,S2	; RETRIEVE STACK VALUE
   325	400224'	312 07 0 06 000000*		CAME	S2,RP.A2##(S1)	; COMPARE THIS WITH FORMER VALUE
   326	400225'	254 00 0 00 400260'		JRST	RPL3		; IF UNEQUAL, BRANCH
   327	400226'	365 06 0 00 400223'		SOJGE	S1,RPL4		; DEDUCT FROM S1 AND GO BACK
   328
   329					;	MERGE HERE AFTER TABLE CONSTRUCTION
   330	400227'	265 11 0 00 400206*	RPL1:	JSP	TLINK,CVTSTR	; CONVERT 1ST ARG TO STRING
   331	400230'	003 01 0 00 000130 		ERROR.	1,88		; BAD FIRST ARG
   332	400231'	550 05 0 01 000000 		HRRZ	P2,0(STACK)	; EXTRACT LENGTH OF THIS STRING
   333	400232'	323 05 0 04 000001 		JUMPLE	P2,1(PLINK)	; IF THIS IS 0, RETURN IT.
   334
   335	400233'	200 00 0 00 000005 		MOVE	Z,P2		; LOAD ARGUMENT AND ...
   336	400234'	265 15 0 00 400450'		JSP	QLINK,ASBLOK	; ALLOCATE AN SBOK
   337	400235'	001 13 0 00 000015 		ERROR	11,13		; &MAXLNGTH ERROR
   338	400236'	200 13 0 01 777777 		MOVE	T3,-1(STACK)	; SAVE IN T3 THE FIRST DESCR. WORD
   339	400237'	265 15 0 00 000000*		JSP	QLINK,CVTPTR##	; CONVERT NEW STRING TO POINTER
   340	400240'	000000	000000			0			; DON'T BASE IT
   341	400241'	001 17 0 00 000000 		ERROR	15		; THIS CAN'T HAPPEN
   342	400242'	202 00 0 00 000011 		MOVEM	Z,T1		; SAVE POINTER OF NEW STRING IN T1
   343
   344	400243'	265 15 0 00 400237*		JSP	QLINK,CVTPTR	; NOW CONVERT OLD STRING
   345	400244'	000000	000000			0			; NO BASING
   346	400245'	254 00 0 00 000000*		JRST	RETNL1##	; MUST HAVE BEEN NULL STRING
   347	400246'	202 00 0 00 000012 		MOVEM	Z,T2		; SAVE POINTER IN T2
   348
   349	400247'	261 01 0 00 000013 		PUSH	STACK,T3	; PUSH VALUE TO BE RETURNED
   350	400250'	261 01 0 00 000005 		PUSH	STACK,P2	; THROW IN LENGTH
   351	400251'	200 06 0 00 000000*		MOVE	S1,RP.TBL##	; LET S1 POINT TO TABLE
   352
   353					;	START OF LOOP FOR REPLACEMENT
   354	400252'	134 07 0 00 000012 	RPL2:	ILDB	S2,T2		; GRAB FIRST BYTE OF SUBJECT STRING
   355	400253'	270 07 0 00 000006 		ADD	S2,S1		; ADD IN THE TABLE ADDRESS
   356	400254'	200 07 0 07 000002 		MOVE	S2,CTBITS(S2)	; PICK UP REPLACEMENT BYTE
   357	400255'	136 07 0 00 000011 		IDPB	S2,T1		; INSERT INTO NEW STRING
   358	400256'	367 05 0 00 400252'		SOJG	P2,RPL2		; DECREMENT AND REPEAT (AND TEST)
   359	400257'	254 00 0 04 000001 		JRST	1(PLINK)	; SUCCESSFUL RETURN
   360

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 12
SNOSTR	MAC	13-Oct-66 22:05		REPLACE(S1,S2,S3)

   361					;	HERE IF THE 2ND AND 3RD ARGUMENTS ARE DIFFERENT FROM BEFORE
   362	400260'	200 01 0 00 000011 	RPL3:	MOVE	STACK,T1	; RESTORE STACK
   363	400261'	265 11 0 00 400227*		JSP	TLINK,CVTSTR	; CONVERT 3RD ARG.
   364	400262'	003 01 0 00 000126 		ERROR.	1,86		; BAD 3RD ARG
   365	400263'	262 01 0 00 000000#		POP	STACK,RP.A2##+3	; SAVE ARG FOR ...
   366	400264'	262 01 0 00 000000#		POP	STACK,RP.A2##+2	; NEXT TIME
   367
   368	400265'	265 11 0 00 400261*		JSP	TLINK,CVTSTR	; CONVERT 2ND ARG
   369	400266'	003 01 0 00 000127 		ERROR.	1,87		; BAD ARG
   370	400267'	262 01 0 00 000000#		POP	STACK,RP.A2##+1	; SAVE ARG FOR ...
   371	400270'	262 01 0 00 400224*		POP	STACK,RP.A2##	; NEXT TIME
   372
   373					;	EITHER A TABLE HAS BEEN CREATED BEFORE IN WHICH CASE
   374					;	WE'LL USE IT OR IT HAS NOT BEEN CREATED IN WHICH CASE
   375					;	WE MUST ALLOCATE ONE.
   376	400271'	336 06 0 00 400251*	RPL7:	SKIPN	S1,RP.TBL##	; LOAD S1 WITH TABLE ADDRESS
   377	400272'	254 00 0 00 400327'		JRST	RPL5		; GO CREATE TABLE
   378	400273'	271 06 0 00 000201 		ADDI	S1,CTBITS+^D127	; POINT TO LAST WORD IN TABLE
   379	400274'	201 07 0 00 000177 		MOVEI	S2,177		; INDEXING VARIBLE (ALSO IN-
   380									; SERTION CHARACTER)
   381
   382	400275'	202 07 0 06 000000 		MOVEM	S2,0(S1)	; PLUG CHARACTER INTO TABLE
   383	400276'	370 00 0 00 000006 		SOS	S1		; POINT TO NEXT WORD IN TABLE
   384	400277'	365 07 0 00 400275'		SOJGE	S2,.-2		; DECREMENT CHRACTER AND LOOP
   385
   386	400300'	261 01 0 00 400270*		PUSH	STACK,RP.A2	; PUSH 2ND ARG. BACK ...
   387	400301'	261 01 0 00 000000#		PUSH	STACK,RP.A2+1	; ONTO STACK
   388	400302'	265 15 0 00 400243*		JSP	QLINK,CVTPTR	; CONVERT TO POINTER
   389	400303'	000000	000000			0
   390	400304'	254 00 0 00 400335'		JRST	RPL6		; MUST BE NULL STRING
   391	400305'	202 00 0 00 000012 		MOVEM	Z,T2		; SAVE POINTER IN T2
   392
   393	400306'	261 01 0 00 000000#		PUSH	STACK,RP.A2+2	; PUSH 3RD ARG ...
   394	400307'	261 01 0 00 000000#		PUSH	STACK,RP.A2+3	; ONTO STACK
   395	400310'	265 15 0 00 400302*		JSP	QLINK,CVTPTR	; CONVERT TO POINTER
   396	400311'	000000	000000			0
   397	400312'	254 00 0 00 400076*		 JRST	FRET1##		;[226] Fail - Unequal arguments
   398	400313'	202 00 0 00 000013 		MOVEM	Z,T3		; SAVE IN T3
   399
   400	400314'	200 06 0 00 400271*		MOVE	S1,RP.TBL	; LET S1 POINT TO THE TABLE
   401	400315'	550 14 0 00 000000#		HRRZ	T4,RP.A2+1	; GET LENGTH OF 2ND ARG.
   402	400316'	550 15 0 00 000000#		HRRZ	Q1,RP.A2+3	; GET LENGTH OF 3RD ARG.
   403	400317'	312 14 0 00 000015 		CAME	T4,Q1		; ARE THEY EQUAL, SKIP IF SO
   404	400320'	254 00 0 00 400312*		 JRST	FRET1##		;[226] Fail - Unequal arguments
   405
   406					;	LOOP FOR INSERTING CHARACTERS INTO THE TABLE
   407	400321'	134 16 0 00 000012 	RP.INS:	ILDB	Q2,T2		; GET BYTE FROM 2ND ARG.
   408	400322'	271 16 0 06 000000 		ADDI	Q2,0(S1)	; ADD IN ADDRESS OF TABLE
   409	400323'	134 17 0 00 000013 		ILDB	Q3,T3		; RETRIEVE CORRESPONDING BYTE OF 3RD
   410	400324'	202 17 0 16 000002 		MOVEM	Q3,CTBITS(Q2)	; INSERT BYTE
   411	400325'	367 14 0 00 400321'		SOJG	T4,RP.INS	; GO BACK AND LOOP
   412	400326'	254 00 0 00 400227'		JRST	RPL1		; TABLE IS FINISHED - RESUME PROCESSING
   413
   414					;	HERE IF A TABLE HAS TO BE CREATED
SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 12-1
SNOSTR	MAC	13-Oct-66 22:05		REPLACE(S1,S2,S3)

   415					;	WE'LL USE A CHARACTER TABLE ALTHOUGH IN AN UNUSUAL WAY
   416	400327'	200 00 0 00 401046'	RPL5:	MOVE	Z,[XWD CTBLOK,^D128+CTBITS]
   417	400330'	265 15 0 00 000000*		JSP	QLINK,BLOK##	; ALLOCATE THE BLOK
   418	400331'	001 17 0 00 000000 		ERROR	15		; NO ERROR IS POSSIBLE HERE
   419	400332'	262 01 0 00 000000#		POP	STACK,RP.TBL+1	; RETRIEVE DESCRIPTOR
   420	400333'	262 01 0 00 400314*		POP	STACK,RP.TBL	; FROM STACK
   421	400334'	254 00 0 00 400271'		JRST	RPL7
   422
   423					;	HERE IF 2ND ARG IS NULL
   424	400335'	274 01 0 00 401043'	RPL6:	SUB	STACK,[XWD 2,2]	; POP 2ND ARG FROM THE STACK
   425	400336'	200 11 0 00 400144*		MOVE	T1,NULLST	; LOAD NULL STRING
   426	400337'	312 11 0 00 000000#		CAME	T1,RP.A2+2	; IS 3RD ARG. ALSO NULL
   427	400340'	254 00 0 00 400320*		 JRST	FRET1##		;[266] Fail - Unequal arguments
   428	400341'	254 00 0 00 400227'		JRST	RPL1		; YES - THIS REPLACE IS A NOOP
   429

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 13
SNOSTR	MAC	13-Oct-66 22:05		REVERSE(S)

   430						SUBTTL	REVERSE(S)
   431
   432	400342'	265 11 0 00 400265*	RVRS::	JSP	TLINK,CVTSTR	; ENSURE STRING ARGUMENT
   433	400343'	003 01 0 00 000131 		ERROR.	1,89		; BAD ARGUMENT
   434
   435	400344'	200 00 0 01 000000 		MOVE	Z,0(STACK)	; SAVE STRING ...
   436	400345'	202 00 0 00 000000#		MOVEM	Z,FLAP+1	; DESCRIPTOR ...
   437	400346'	200 00 0 01 777777 		MOVE	Z,-1(STACK)	; IN FLAP ...
   438	400347'	202 00 0 00 400214*		MOVEM	Z,FLAP		; REGION
   439
   440	400350'	265 15 0 00 400310*		JSP	QLINK,CVTPTR	; CONVERT DESCRIPTOR TO POINTER
   441	400351'	000000	000005			P2			; BASED ON P2
   442	400352'	254 00 0 00 400245*		JRST	RETNL1##		; REMOVE 1 DESCRIPTOR AND RETURN NULL
   443	400353'	202 00 0 00 000006 		MOVEM	Z,S1		; SAVE THE POINTER
   444
   445	400354'	550 07 0 00 000000#		HRRZ	S2,FLAP+1	; S2 WILL HOLD THE STRING LENGTH
   446	400355'	200 00 0 00 000007 		MOVE	Z,S2		; SET UP ARGUMENT FOR CALL TO ASBLOK
   447	400356'	265 15 0 00 400450'		JSP	QLINK,ASBLOK	; ALLOCATE AN SBLOK
   448	400357'	001 13 0 00 000015 		ERROR	11,13		; EXCEEDED &MAXLNGTH
   449	400360'	202 07 0 01 000000 		MOVEM	S2,0(STACK)	; INSERT LENGTH INTO STRING DESCR.
   450
   451	400361'	200 11 0 00 000007 		MOVE	T1,S2		; COPY LENGTH
   452	400362'	231 11 0 00 000005 		IDIVI	T1,5		; WORD COUNT IN T1, BYTE COUNT IN T2
   453	400363'	200 05 0 00 400347*		MOVE	P2,FLAP		; LOAD BASE REG. FOR STRING ARG
   454	400364'	200 15 0 01 777777 		MOVE	Q1,-1(STACK)	; LOAD BASE REGISTER FOR NEW STRING
   455	400365'	270 15 0 00 000011 		ADD	Q1,T1		; ADD IN WORD COUNT
   456	400366'	322 12 0 00 400373'		JUMPE	T2,RV.2		; IF BYTE COUNT IS 0 JUMP INTO LOOP
   457
   458					;	TOP OF LOOP
   459	400367'	134 13 0 00 000006 	RV.1:	ILDB	T3,S1		; LOAD T3 WITH NEXT BYTE
   460	400370'	246 13 0 00 777771 		LSHC	T3,-7		; SHIFT BYTE INTO T4
   461	400371'	367 12 0 00 400367'		SOJG	T2,RV.1		; IF STILL MORE IN T2, GO BACK
   462
   463					;	A WORD (OR A PARTIAL WORD IF THIS IS THE FIRST TIME THRU)
   464					;	OF CHARACTERS HAS JUST BEEN LOADED INTO T4 IN REVERSE.
   465					;	SINCE THESE CHARACTERS WERE OBTAINED FROM THE FRONT OF
   466					;	THE ARGUMENT STRING, THEY MUST NOW BE DEPOSITED INTO THE
   467					;	BACK END OF THE NEWLY CONSTRUCTED STRING
   468	400372'	202 14 0 15 000002 		MOVEM	T4,SCHARS(Q1)	; STORE CHARACTERS INTO LAST WORD
   469	400373'	201 12 0 00 000005 	RV.2:	MOVEI	T2,5		; REINITIALIZE T2 IN CASE WE GO AGAIN
   470	400374'	361 11 0 04 000001 		SOJL	T1,1(PLINK)	; LOOP ON WORD COUNT
   471	400375'	364 15 0 00 400367'		SOJA	Q1,RV.1		; ADJUST NEW STRING POINTER AND LOOP
   472

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 14
SNOSTR	MAC	13-Oct-66 22:05		SIZE(S)

   473						SUBTTL	SIZE(S)
   474
   475	400376'	265 11 0 00 400342*	SIZE::	JSP	TLINK,CVTSTR	; CONVERT ARG TO STRING
   476	400377'	003 01 0 00 000045 		ERROR.	1,37		; BAD ARGUMENT TO SIZE
   477	400400'	205 00 0 00 002001 		MOVSI	Z,IDT		; LOAD Z WITH INTEGER DATA TYPE
   478	400401'	202 00 0 01 777777 		MOVEM	Z,-1(STACK)	; PLUG 1ST DESCRIPTOR WORD
   479	400402'	506 00 0 01 000000 		HRLM	Z,0(STACK)	; ZERO OUT OFFSET FIELD
   480	400403'	254 00 0 04 000001 		JRST	1(PLINK)	; SUCCESSFUL RETURN
   481

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 15
SNOSTR	MAC	13-Oct-66 22:05		SUBSTR(S,K,L)

   482						SUBTTL	SUBSTR(S,K,L)
   483
   484					;	LET A AND B BE THE OFFSET AND LENGTH WITHIN THE 
   485					;	DESCRIPTOR FOR S.	LET A' AND B' BE THE NEW OFFSET
   486					;	AND LENGTHS RESPECTIVELY.	THEN
   487					;
   488					;	A' = A + K - 1
   489					;	B' = L
   490					;
   491					; PROVIDED:	K-1 GREATER THAN OR EQUAL TO 0
   492					;		L	 GREATER THAN OR EQUAL TO 0
   493					;		L	 LESS THAN OR EQUAL TO B - (K-1)
   494					;
   495					;	SUBSTR FAILS IF ANY OF THESE CONDITIONS IS NOT SATISFIED
   496					;	
   497					;	ALSO	SUBSTR(S,K) HAS AN IMPLIED L OF 
   498					;		L = B - (K-1)
   499
   500
   501	400404'	306 00 0 00 000002 	SBSTR::	CAIN	Z,2	; TEST FOR NUMBER OF ARGS BEING EQUAL TO 2
   502	400405'	254 00 0 00 400442'		JRST	SB.2	; TAKE THIS BRANCH IF SO
   503	400406'	302 00 0 00 000003 		CAIE	Z,3	; SKIP IF 3 ARGS
   504	400407'	001 15 0 00 000062 		ERROR	13,50	; BAD 2ND ARG TO SUBSTR
   505
   506	400410'	265 11 0 00 400202*		JSP	TLINK,CVTINT	; CONVERT 3RD ARGUMENT TO INTEGER
   507	400411'	003 01 0 00 000141 		ERROR.	1,97		; BAD 3RD ARG
   508	
   509	400412'	262 01 0 00 000010 		POP	STACK,S3	; L IS SAVED IN S3
   510	400413'	262 01 0 00 000000 		POP	STACK,Z		; GET RID OF THIS JUNK
   511	400414'	321 10 0 00 000000*		JUMPL	S3,FRET2##	; FAIL IF S3 IS NEGATIVE
   512	400415'	322 10 0 00 000000*		JUMPE	S3,RETNL2##	; IF S3 IS 0 RETURN NULL STRING
   513
   514					;	MERGE HERE FROM 2-ARGUMENT CASE WITH S3 = 0
   515	400416'	265 11 0 00 400410*	SB.3:	JSP	TLINK,CVTINT	; CONVERT 2ND ARG TO INTEGER
   516	400417'	003 01 0 00 000140 		ERROR.	1,96		; BAD 2ND ARG
   517	400420'	262 01 0 00 000007 		POP	STACK,S2	; 2ND ARG (K) TO S2
   518	400421'	262 01 0 00 000000 		POP	STACK,Z		; REMOVE HEADER
   519	400422'	361 07 0 00 400340*		SOJL	S2,FRET1##	; KEEP K-1 IN S2. ALSO FAIL IF NEG.
   520
   521	400423'	265 11 0 00 400376*		JSP	TLINK,CVTSTR	; CONVERT FIRST ARG TO STRING
   522	400424'	003 01 0 00 000137 		ERROR.	1,95		; BAD FIRST ARG.
   523	400425'	554 11 0 01 000000 		HLRZ	T1,0(STACK)	; OFFSET (A) TO T1
   524	400426'	550 12 0 01 000000 		HRRZ	T2,0(STACK)	; LENGTH (B) TO T2
   525	400427'	274 12 0 00 000007 		SUB	T2,S2		; B-(K-1) IS NOW IN T2
   526	400430'	321 12 0 00 400422*		JUMPL	T2,FRET1##	; IF NEGATIVE WE FAIL
   527
   528	400431'	336 00 0 00 000010 		SKIPN	S3		; IF S3 IS ZERO ...
   529	400432'	200 10 0 00 000012 		MOVE	S3,T2		; SET IT TO B-(K-1)
   530
   531	400433'	322 10 0 00 400352*		JUMPE	S3,RETNL1##	; RETURN NULL IF LENGTH IS 0
   532	400434'	313 10 0 00 000012 		CAMLE	S3,T2		; SKIP IF L	LE	B-(K-1)
   533	400435'	254 00 0 00 400430*		JRST	FRET1##		; FAIL IF OTHERWISE
   534	400436'	270 11 0 00 000007 		ADD	T1,S2		; A + K - 1 TO T1 (THIS IS A')
   535	400437'	504 10 0 00 000011 		HRL	S3,T1		; MAKE (A',B') WORD IN S3
SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 15-1
SNOSTR	MAC	13-Oct-66 22:05		SUBSTR(S,K,L)

   536	400440'	202 10 0 01 000000 		MOVEM	S3,0(STACK)	; INSERT THIS INTO STACK
   537	400441'	254 00 0 04 000001 		JRST	1(PLINK)	; AND RETURN
   538
   539					;	2-ARGUMENT SUBSTR
   540	400442'	400 10 0 00 000000 	SB.2:	SETZ	S3,		; SET 3RD ARG. TO 0
   541	400443'	254 00 0 00 400416'		JRST	SB.3		; JOIN MAIN PROCESSING
   542

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 16
SNOSTR	MAC	13-Oct-66 22:05		TRIM(S)

   543						SUBTTL	TRIM(S)
   544
   545	400444'	265 11 0 00 400423*	TRIM::	JSP	TLINK,CVTSTR	; ENSURE STRING
   546	400445'	254 00 0 04 000001 		JRST	1(PLINK)	; OK - JUST RETURN
   547
   548	400446'	265 11 0 00 401004'		JSP	TLINK,TRIMT	; USE T VERSION OF TRIM
   549	400447'	254 00 0 04 000001 		JRST	1(PLINK)	; AND RETURN
   550

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 17
SNOSTR	MAC	13-Oct-66 22:05		ASBLOK

   551						SUBTTL	ASBLOK
   552
   553					;	CALLING SEQUENCE:
   554					;
   555					;	LOAD Z WITH # OF CHARS
   556					;	JSP	QLINK,ASBLOK
   557					;	WILL ALLOCATE AN SBLOK.	
   558					;	THE VALUE WILL BE RETURNED ON THE STACK AND
   559					;	WILL BE A DOUBLE-0 STRING DESCRIPTOR.
   560	400450'				ASBLOK::
   561	400450'	313 00 0 00 000000*		CAMLE	Z,$MAXL##		; COMPARE REQUEST WITH KEYWORD
   562									; (&MAXLNGTH)
   563	400451'	254 00 0 15 000000 		JRST	0(QLINK)	; TAKE ERROR EXIT IF TOO BIG
   564	400452'	202 00 0 00 000016 		MOVEM	Z,Q2		; PUT # IN Q2 SO DIVISION IS POSS.
   565	400453'	271 16 0 00 000016 		ADDI	Q2,SCHARS*5+4	; ADD EVEN MORE BYTES
   566	400454'	231 16 0 00 000005 		IDIVI	Q2,NBYTES	; DIVIDE BY NUMBER OF BYTES PER WORD
   567									; REQUIRED IN Q2
   568	400455'	505 16 0 00 000403 		HRLI	Q2,SBLOK	; PREPARE REST OF HEADER
   569
   570					;	MERGE HERE AFTER GARBAGE COLLECT
   571	400456'	202 16 0 02 000000 	ASB2:	MOVEM	Q2,BTCODE&BLENG(SURF)
   572									; INSERT HEADER WORD
   573	400457'	402 00 0 02 000001 		CLEARM	GCFLD(SURF)	; CLEAR GCFLD
   574	400460'	200 17 0 00 000002 		MOVE	Q3,SURF		; SAVE IN Q3 CURRENT SURFACE
   575	400461'	271 02 0 16 000000 		ADDI	SURF,0(Q2)	; INCREMENT SURF BY REQ. AMOUNT.
   576	400462'	313 02 0 00 000000*		CAMLE	SURF,CEIL##	; SKIP IF NO GARB. COLL. IS NEEDED
   577	400463'	254 00 0 00 400472'		JRST	ASB1		; GO HANDLE THE GC CASE
   578	400464'	505 17 0 00 004003 		HRLI	Q3,SDT		; PREPARE DESCRIPTOR WORD
   579	400465'	261 01 0 00 000017 		PUSH	STACK,Q3	; RETURN THIS VALUE
   580	400466'	261 01 0 00 401047'		PUSH	STACK,[0]	; RETURN DOUBLE-0 STRING
   581	400467'	500 17 0 00 401050'		HLL	Q3,[POINT 7,0-0]; RETURN POINTER ...
   582	400470'	271 17 0 00 000002 		ADDI	Q3,SCHARS	; IN Q3
   583	400471'	254 00 0 15 000001 		JRST	1(QLINK)	; NORMAL RETURN
   584
   585					;	HERE IF INSUFFICIENT ROOM
   586	400472'	275 02 0 16 000000 	ASB1:	SUBI	SURF,0(Q2)	; BRING SURFACE BACK TO PREVIOUS LEVEL
   587	400473'	200 17 0 00 000000 		MOVE	Q3,Z		; SAVE # OF CHARS.
   588	400474'	265 00 0 00 000000*		PUSHR	Q		; SAVE Q REGISTERS
   589	400475'	000004	000015
   590	400476'	201 00 0 16 000000 		MOVEI	Z,0(Q2)		; LOAD NUMBER OF WORDS NEEDED
   591	400477'	265 15 0 00 000000*		JSP	QLINK,GCOLF##	; MAKE ROOM
   592	400500'	265 00 0 00 000000*		POPR	Q		; RESTORE Q REGISTERS
   593	400501'	000003	000015
   594
   595	400502'	254 00 0 00 400456'		JRST	ASB2		; BACK TO JOIN MAIN PROC.
   596	400503'	301 00 0 00 016614 		CAIL	Z,16614		; JUST FOR UPDATE.SNO
   597

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 18
SNOSTR	MAC	13-Oct-66 22:05		CONCAT - CONCATENATE STRINGS

   598						SUBTTL	CONCAT - CONCATENATE STRINGS
   599
   600					;	 CALLING SEQUENCE:
   601					;
   602					;	PUSH STRING DESCRIPTORS ONTO STACK (IN REVERSE ORDER)
   603					;	LOAD Z WITH # OF ARGS
   604					;	JSP	TLINK,CONCAT
   605					;	ERROR RETURN
   606					;	NORMAL RETURN - RETURNED VALUE AT STACK TOP
   607
   608	400504'				CONCAT::
   609	400504'	200 12 0 00 000000 		MOVE	T2,Z		; COPY # OF STRINGS INTO T2
   610	400505'	200 13 0 00 000001 		MOVE	T3,STACK	; T3 WILL INDEX THROUGH THE STACK
   611	400506'	400 14 0 00 000000 		CLEAR	T4,		; ZERO OUT T4
   612
   613					;	THIS IS THE TOP OF A LOOP TO COMPUTE THE LENGTH OF THE 
   614					;	RESULTING STRING
   615	400507'	270 14 0 13 000000 	CC1:	ADD	T4,0(T3)	; ADD OFFSET - LENGTH OF ARG. STRING
   616	400510'	275 13 0 00 000002 		SUBI	T3,2		; DECREMENT T3
   617	400511'	367 00 0 00 400507'		SOJG	Z,CC1		; DO THIS FOR EACH ARGUMENT
   618
   619					;	FALL THRU WHEN T4 HAS THE TOTAL ACCUMULTED LENGTHS
   620					;	IN ITS RIGHT HALF
   621	400512'	550 00 0 00 000014 		HRRZ	Z,T4		; INSERT TOTAL LENGTH INTO Z
   622	400513'	265 15 0 00 400450'		JSP	QLINK,ASBLOK	; ALLOCATE THE SBLOK
   623	400514'	254 00 0 11 000000 		JRST	0(TLINK)	; PASS ERROR BACK
   624	400515'	200 13 0 01 777777 		MOVE	T3,-1(STACK)	; SAVE STRING DESCRIPTOR ...
   625	400516'	202 13 0 00 000000*		MOVEM	T3,FLAT##	; IN FLAT AREA
   626	400517'	552 14 0 00 000000#		HRRZM	T4,FLAT##+1	; INSERT LENGTH INTO 2ND DESCR WORD
   627
   628	400520'	202 17 0 00 000014 		MOVEM	Q3,T4		; SAVE POINTER IN T4
   629	400521'	274 01 0 00 401043'		SUB	STACK,[2,,2]	; POP STACK
   630
   631					;	TOP OF LOOP THAT CONCATENATES STRINGS
   632	400522'	550 13 0 01 000000 	CC2:	HRRZ	T3,0(STACK)	; SAVE ITS LENGTH
   633	400523'	265 15 0 00 400350*		JSP	QLINK,CVTPTR	; GET POINTER FOR IT
   634	400524'	000000	000000			0			; NO BASING NEEDED
   635	400525'	254 00 0 00 400535'		JRST	CC4		; MUST HAVE BEEN A NULL STRING
   636
   637	400526'	134 15 0 00 000000 	CC3:	ILDB	Q1,Z		; GET CHARACTER OF STRING TO BE ...
   638									; CONCATENATED IN.
   639	400527'	136 15 0 00 000014 		IDPB	Q1,T4		; INSERT THIS CHARACTER INTO MAIN STRING
   640	400530'	367 13 0 00 400526'		SOJG	T3,CC3		; DO IT FOR AS MANY CHARACTERS AS ARE
   641									; IN THE SUBSTRING.
   642	400531'	367 12 0 00 400522'		SOJG	T2,CC2		; LOOP ON NUMBER OF STRINGS
   643
   644					;	CONCATENATION IS COMPLETED.
   645	400532'	261 01 0 00 400516*	CC5:	PUSH	STACK,FLAT##	; RETURN ...
   646	400533'	261 01 0 00 000000#		PUSH	STACK,FLAT##+1	; SAVED ...
   647	400534'	254 00 0 11 000001 		JRST	1(TLINK)	; STRING
   648
   649					;	IF ONE OF THE STRINGS WAS A NULL COME HERE
   650	400535'	274 01 0 00 401043'	CC4:	SUB	STACK,[XWD 2,2]	; GET RID OF DESCRIPTOR
   651	400536'	367 12 0 00 400522'		SOJG	T2,CC2		; DEDUCT FROM # OF STRINGS COUNT
SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 18-1
SNOSTR	MAC	13-Oct-66 22:05		CONCAT - CONCATENATE STRINGS

   652	400537'	254 00 0 00 400532'		JRST	CC5		; NON LEFT? RETURN
   653

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 19
SNOSTR	MAC	13-Oct-66 22:05		DUPLI - INTERNAL FORM OF DUPL

   654						SUBTTL	DUPLI - INTERNAL FORM OF DUPL
   655
   656					;	 CALLING SEQUENCE:
   657					;
   658					;	PUSH STRING DESCRIPTOR ONTO STACK (MUST BE STRING)
   659					;	LOAD Z WITH NUMBER OF DUPLICATONS
   660					;	JSP	TLINK,DUPLI
   661					;	ERROR - STRING TOO LONG
   662					;	NORMAL - STRING ARG IS REPLACED BY RETURNED VALUE
   663					;
   664					;	 REGISTER ALLOCATION FOR DUPLI(S,N)
   665					;
   666					;	T2 : SIZE(S)
   667					;	T3 : N
   668					;	T4 : POINTER FOR DUPL (THE RETURNED STRING)
   669					;	Q1 : COUNTER FOR INNER LOOP
   670					;	Q2 : INNER LOOP POINTER TO S
   671
   672	400540'	202 00 0 00 000013 	DUPLI::	MOVEM	Z,T3		; SAVE N IN T3
   673	400541'	550 12 0 01 000000 		HRRZ	T2,0(STACK)	; SIZE(S) TO T2
   674	400542'	220 00 0 00 000012 		IMUL	Z,T2		; OVERALL LENGTH TO Z
   675	400543'	327 00 0 00 400550'		JUMPG	Z,DUPLI1	; JUMP IF THIS LENGTH EXCEEDS 0
   676	400544'	274 01 0 00 401043'		SUB	STACK,[XWD 2,2]	; POP STACK
   677	400545'	261 01 0 00 400336*		PUSH	STACK,NULLST	; RETURNING ...
   678	400546'	261 01 0 00 000000#		PUSH	STACK,NULLST+1	; NULL STRING
   679	400547'	254 00 0 11 000001 		JRST	1(TLINK)	; NORMAL EXIT
   680
   681	400550'	202 00 0 00 000014 	DUPLI1:	MOVEM	Z,T4		; SAVE THIS QUANTITY
   682	400551'	265 15 0 00 400450'		JSP	QLINK,ASBLOK	; ALLOCATE AN SBLOK
   683	400552'	254 00 0 11 000000 		JRST	0(TLINK)	; EXCEEDED &MAXLNGTH
   684	400553'	202 14 0 00 000000#		MOVEM	T4,FLAT##+1	; STORE ULTIMATE LENGTH
   685	400554'	200 00 0 01 777777 		MOVE	Z,-1(STACK)	; TRANSFER DESCR. TOP
   686	400555'	202 00 0 00 400532*		MOVEM	Z,FLAT##	; TO FLAT AREA
   687
   688	400556'	265 15 0 00 400523*		JSP	QLINK,CVTPTR	; CONVERT SBLOK TO POINTER
   689	400557'	000000	000000			0			; NO BASING NEEDED
   690	400560'	001 17 0 00 000000 		ERROR	15,0		; THIS CAN'T HAPPEN
   691	400561'	202 00 0 00 000014 		MOVEM	Z,T4		; SAVE DUPL POINTER IN T4
   692	400562'	265 15 0 00 400556*		JSP	QLINK,CVTPTR	; CONVERT S TO POINTER
   693	400563'	000000	000000			0
   694	400564'	254 00 0 11 000001 		JRST	1(TLINK)	; IF THE STRING IS NULL WE OUGHT
   695									; TO RETURN THE NULL STRING
   696
   697					;	OUTER LOOP (INITIALIZE VALUES)
   698	400565'	200 15 0 00 000012 	DUPLI2:	MOVE	Q1,T2		; COUNTER FOR INNER LOOP IS SIZE(S)
   699	400566'	200 16 0 00 000000 		MOVE	Q2,Z		; POINTER FOR S IS SAVED IN Z
   700
   701					;	INNER LOOP
   702	400567'	134 17 0 00 000016 	DUPLI3:	ILDB	Q3,Q2		; PICK UP CHAR. FROM S
   703	400570'	136 17 0 00 000014 		IDPB	Q3,T4		; PUT BYTE INTO DUPL
   704	400571'	367 15 0 00 400567'		SOJG	Q1,DUPLI3	; BRANCH IF Q1 IS STILL POSITIVE
   705					;	INNER LOOP COMPLETED
   706
   707	400572'	367 13 0 00 400565'		SOJG	T3,DUPLI2	; OUTER LOOP BASED ON N
SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 19-1
SNOSTR	MAC	13-Oct-66 22:05		DUPLI - INTERNAL FORM OF DUPL

   708
   709	400573'	261 01 0 00 400555*		PUSH	STACK,FLAT##	; LOAD NEW STRING ...
   710	400574'	261 01 0 00 000000#		PUSH	STACK,FLAT##+1	; ONTO STACK ...
   711	400575'	254 00 0 11 000001 		JRST	1(TLINK)	; AND RETURN SUCCESSFULLY
   712

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 20
SNOSTR	MAC	13-Oct-66 22:05		EQINIT - INITIALIZATION FOR EQUAL AND LEQUAL

   713						SUBTTL	EQINIT - INITIALIZATION FOR EQUAL AND LEQUAL
   714
   715					;	 CALLING SEQUENCE:
   716					;
   717					;	PUSH STRING DESCRIPTOR ONTO STACK
   718					;	JSP	TLINK,EQINIT
   719					;	ERROR -		REFLECTS ERROR BY CVTPTR, STACK UNPOPPED
   720					;	NORMAL -		STACK POPPED, THE SAVET AREA IS SET UP AS BELOW
   721					;
   722					;		FLAT&FLAT+1 = ORIGINAL STRING DESCRIPTOR
   723					;		IGNOT = POINTER
   724					;		IGNOT+1 = LENGTH
   725
   726	400576'				EQINIT::
   727	400576'	200 00 0 01 777777 		MOVE	Z,-1(STACK)	; SAVE STRING DESCRIPTOR
   728	400577'	202 00 0 00 400573*		MOVEM	Z,FLAT		; IN ...
   729	400600'	200 00 0 01 000000 		MOVE	Z,0(STACK)	; FLAT ...
   730	400601'	202 00 0 00 000000#		MOVEM	Z,FLAT+1	; AREA
   731	400602'	552 00 0 00 000000#		HRRZM	Z,IGNOT##+1	; SAVE LENGTH IN IGNOT AREA
   732	400603'	265 15 0 00 400562*		JSP	QLINK,CVTPTR	; CONVERT STRING TO POINTER
   733	400604'	000000	000012			T2		; BASE ON T2
   734	400605'	254 00 0 11 000000 		JRST	0(TLINK)	; TAKE ERROR EXIT
   735	400606'	202 00 0 00 000000*		MOVEM	Z,IGNOT##	; SAVE POINTER IN IGNOT
   736	400607'	254 00 0 11 000001 		JRST	1(TLINK)	; TAKE NORMAL EXIT
   737

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 21
SNOSTR	MAC	13-Oct-66 22:05		EQUAL - TESTS FOR EQUALITY BETWEEN STRINGS

   738						SUBTTL	EQUAL - TESTS FOR EQUALITY BETWEEN STRINGS
   739
   740					;	 CALLING SEQUENCE:
   741					;
   742					;	PUSH STRING DESCRIPTOR ONTO STACK
   743					;	JSP	TLINK,EQUAL
   744					;	NO	; THE GIVEN STRING IS NOT EQUAL
   745					;	YES	; THE GIVEN STRING IS EQUAL TO THE ONE PREVIOUSLY
   746					;		; PASSED TO EQINIT.
   747
   748	400610'				EQUAL::
   749	400610'	550 14 0 01 000000 		HRRZ	T4,0(STACK)	; LENGTH OF STRING TO T2
   750	400611'	312 14 0 00 000000#		CAME	T4,IGNOT+1	; COMPARE WITH OLD LENGTH
   751	400612'	254 00 0 00 400626'		JRST	EQUAL1		; TAKE JUMP IF UNEQUAL
   752
   753	400613'	265 15 0 00 400603*		JSP	QLINK,CVTPTR	; GET POINTER FOR STRING
   754	400614'	000000	000000			0			; NO BASE
   755	400615'	254 00 0 00 400626'		JRST	EQUAL1		; IF NULL, TAKE THIS BRANCH
   756
   757	400616'	200 12 0 00 400577*		MOVE	T2,FLAT		; LOAD BASE FOR OLD STRING
   758	400617'	200 15 0 00 400606*		MOVE	Q1,IGNOT	; LOAD POINTER OF OLD STRING
   759
   760	400620'	134 16 0 00 000015 	EQUAL2:	ILDB	Q2,Q1		; LOAD NEXT CHARACTER FROM OLD
   761	400621'	134 17 0 00 000000 		ILDB	Q3,Z		; LOAD NEXT CHARACTER FROM NEW
   762	400622'	312 16 0 00 000017 		CAME	Q2,Q3		; SKIP IF THESE ARE EQUAL
   763	400623'	254 00 0 11 000000 		JRST	0(TLINK)	; TAKE UNEQUAL EXIT
   764	400624'	367 14 0 00 400620'		SOJG	T4,EQUAL2	; GO BACK FOR MORE
   765	400625'	254 00 0 11 000001 		JRST	1(TLINK)	; TAKE SUCCESS EXIT
   766
   767	400626'	274 01 0 00 401043'	EQUAL1:	SUB	STACK,[XWD 2,2]	; POP STACK
   768	400627'	254 00 0 11 000000 		JRST	0(TLINK)	; TAKE NOT EQUAL EXIT
   769

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 22
SNOSTR	MAC	13-Oct-66 22:05		IDINIT & IDENT

   770						SUBTTL	IDINIT & IDENT
   771
   772					;   CALLING SEQUENCE:
   773					;	PUSH DESCRIPTOR ONTO STACK
   774					;	JSP	TLINK,IDINIT
   775					;	RETURN - FLAT AREA INITIALIZED
   776					;
   777					;	PUSH DESCRIPTOR ONTO STACK
   778					;	JSP	TLINK,IDENT
   779					;	NOT IDENTICAL WITH OTHER DESCRIPTOR
   780					;	IDENTICAL WITH OTHER DESCRIPTOR
   781					;
   782					;	STACK IS POPPED ONE DESCRIPTOR IN ALL 3 CASES
   783
   784	400630'	554 12 0 01 777777 	IDINIT::HLRZ	T2,-1(STACK)	; DATATYPE # TO ...
   785	400631'	405 12 0 00 000077 		ANDI	T2,DTNUM	; T2
   786
   787	400632'	303 12 0 00 000012 		CAILE	T2,MAXDTN	; WITHIN RANGE?
   788	400633'	254 00 0 00 400655'		JRST	ID.D2		; NO EXTERNAL.
   789
   790	400634'	254 00 0 12 400635'		JRST	ID.VEC(T2)	; JUMP INTO TABLE
   791
   792						 ; JUMP TABLE FOR IDINIT
   793
   794	400635'	254 00 0 00 400655'	ID.VEC: JRST	ID.D2		; COMPARE BOTH WORDS
   795	400636'	254 00 0 00 400655'		JRST	ID.D2		; INTEGER
   796	400637'	254 00 0 00 400655'		JRST	ID.D2		; REAL
   797	400640'	254 00 0 00 400675'		JRST	ID.STR		; STRING
   798	400641'	254 00 0 00 400650'		JRST	ID.D1		; PATTERN
   799	400642'	254 00 0 00 400650'		JRST	ID.D1		; ARRAY
   800	400643'	254 00 0 00 400655'		JRST	ID.D2		; EXPRESSION
   801	400644'	254 00 0 00 400655'		JRST	ID.D2		; CODE
   802	400645'	254 00 0 00 400650'		JRST	ID.D1		; TABLE
   803	400646'	254 00 0 00 400655'		JRST	ID.D2		; NAME
   804	400647'	254 00 0 00 400650'		JRST	ID.D1		; DEFINED DATATYPE
   805
   806						 ; COMPARE FIRST WORDS
   807
   808	400650'	265 13 0 00 400664'	ID.D1:	JSP	T3,ID.RET	; SET T3 AND RETURN
   809
   810						 ; HERE ON SUBSEQUENT CALLS
   811
   812	400651'	200 12 0 00 400616*		MOVE	T2,FLAT		; ARE ...
   813	400652'	312 12 0 01 777777 		CAME	T2,-1(STACK)	; FIRST WORDS THE SAME?
   814	400653'	254 00 0 00 400671'		JRST	ID.NO		; NO
   815	400654'	254 00 0 00 400673'		JRST	ID.YES		; YES
   816
   817						 ; COMPARE TWO WORDS
   818
   819	400655'	265 13 0 00 400664'	ID.D2:	JSP	T3,ID.RET
   820
   821	400656'	200 12 0 00 400651*		MOVE	T2,FLAT		; LOAD FIRST WORD
   822	400657'	200 13 0 00 000000#		MOVE	T3,FLAT+1	; AND 2ND WORD
   823	400660'	316 12 0 01 777777 		CAMN	T2,-1(STACK)	; EITHER FIRST ...
SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 22-1
SNOSTR	MAC	13-Oct-66 22:05		IDINIT & IDENT

   824	400661'	312 13 0 01 000000 		CAME	T3,0(STACK)	; OR 2ND DIFFERENT ...
   825	400662'	254 00 0 00 400671'		JRST	ID.NO		; THEN TAKE THIS BRANCH
   826	400663'	254 00 0 00 400673'		JRST	ID.YES		; OTHERWISE THIS ONE
   827
   828	400664'	202 13 0 00 000000#	ID.RET:	MOVEM	T3,IGNOT+2	; SAVE TEST ADDRESS
   829	400665'	262 01 0 00 000000#		POP	STACK,FLAT+1	; SAVE DESCRIPTOR ...
   830	400666'	262 01 0 00 400656*		POP	STACK,FLAT	; FOR SUBSEQUENT TESTS
   831	400667'	254 00 0 11 000000 		JRST	0(TLINK)	; AND RETURN
   832
   833						 ; NOW WE CAN DEFINE IDENT
   834
   835	400670'	254 00 1 00 000000#	IDENT::	JRST	@IGNOT##+2	; JUMP TO PROCESSOR
   836
   837						 ; RETURN COMES TO EITHER ID.YES OR ID.NO
   838						 ; EXCEPT FOR STRINGS WHICH IS HANDLED BY EQUAL
   839
   840	400671'	274 01 0 00 401043'	ID.NO:	SUB	STACK,[2,,2]	; POP STACK
   841	400672'	254 00 0 11 000000 		JRST	0(TLINK)	; FAIL EXIT
   842
   843	400673'	274 01 0 00 401043'	ID.YES:	SUB	STACK,[2,,2]	; POP STACK
   844	400674'	254 00 0 11 000001 		JRST	1(TLINK)	; SUCCESS EXIT
   845
   846						 ; STRINGS ARE HANDLED HERE
   847
   848	400675'	200 12 0 01 777777 	ID.STR:	MOVE	T2,-1(STACK)	; NULL
   849	400676'	316 12 0 00 400545*		CAMN	T2,NULLST	; STRING?
   850	400677'	254 00 0 00 400650'		JRST	ID.D1		; YES
   851
   852	400700'	201 13 0 00 400703'		MOVEI	T3,ID.ST1	; SET 
   853	400701'	202 13 0 00 000000#		MOVEM	T3,IGNOT+2	; COMPARE ADDRESS
   854	400702'	364 11 0 00 400576'		SOJA	TLINK,EQINIT	; THINK ABOUT IT
   855
   856	400703'	254 00 0 00 400610'	ID.ST1:	JRST	EQUAL		; LET EQUAL HANDLE THIS
   857

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 23
SNOSTR	MAC	13-Oct-66 22:05		LEQUAL - LEXICAL TEST FOR STRINGS

   858						SUBTTL	LEQUAL - LEXICAL TEST FOR STRINGS
   859
   860					;	 CALLING SEQUENCE:
   861					;
   862					;	PUSH STRING DESCRIPTOR ONTO STACK
   863					;	JSP	TLINK,LEQUAL
   864					;	LESS THAN
   865					;	EQUAL TO
   866					;	GREATER THAN
   867					;
   868					;	THE COMPARISON IS MADE WITH RESPECT TO THE STRING
   869					;	PREVIOUSLY PASSED TO EQINIT
   870
   871	400704'				LEQUAL::
   872	400704'	550 14 0 01 000000 		HRRZ	T4,0(STACK)	; LOAD LENGTH OF NEW STRING
   873	400705'	200 13 0 00 000014 		MOVE	T3,T4		; SAVE THIS LENGTH IN T3
   874	400706'	313 14 0 00 000000#		CAMLE	T4,IGNOT+1	; SKIP IF NEW LENGTH LT OLD
   875	400707'	200 14 0 00 000000#		MOVE	T4,IGNOT+1	; MIN. LENGTH TO T4
   876
   877	400710'	265 15 0 00 400613*		JSP	QLINK,CVTPTR	; CONVERT ARG TO POINTER
   878	400711'	000000	000000			0			; NO BASE REGISTER REQUIRED
   879	400712'	254 00 0 00 400731'		JRST	LEQ3		; PROBABLY NULL STRING
   880
   881	400713'	200 12 0 00 400666*		MOVE	T2,FLAT		; BASE OLD STRING POINTER
   882	400714'	200 15 0 00 400617*		MOVE	Q1,IGNOT	; LOAD POINTER OF OLD STRING
   883
   884					;	TOP OF COMPARISON LOOP
   885	400715'	134 16 0 00 000015 	LEQ1:	ILDB	Q2,Q1		; LOAD CHRACTER FROM OLD STRING
   886	400716'	134 17 0 00 000000 		ILDB	Q3,Z		; LOAD CHARACTER FROM NEW STRING
   887	400717'	312 16 0 00 000017 		CAME	Q2,Q3		; SKIP IF THESE 2 CHAR. ARE EQUAL
   888	400720'	254 00 0 00 400726'		JRST	LEQ2		; TAKE NON EQUAL CASE.
   889	400721'	367 14 0 00 400715'		SOJG	T4,LEQ1		; LOOP ON T4 (MIN STRING LENGTH)
   890	400722'	274 13 0 00 000000#		SUB	T3,IGNOT+1	; (LENGTH NEW) - (LENGTH OLD) TO T3
   891	400723'	322 13 0 11 000001 		JUMPE	T3,1(TLINK)	; SAME? - TAKE EQUAL EXIT
   892	400724'	327 13 0 11 000002 		JUMPG	T3,2(TLINK)	; GREATER? - TAKE GR TH EXIT
   893	400725'	254 00 0 11 000000 		JRST	0(TLINK)	; ONLY ONE EXIT LEFT - TAKE IT
   894
   895	400726'	274 17 0 00 000016 	LEQ2:	SUB	Q3,Q2	; GET DIFFERENCE BETWEEN NEW AND OLD TO Q3
   896	400727'	327 17 0 11 000002 		JUMPG	Q3,2(TLINK)	; TAKE 'GREATER THAN' EXIT
   897	400730'	254 00 0 11 000000 		JRST	0(TLINK)	; OTHERWISE TAKE 'LESS THAN' EXIT
   898
   899	400731'	274 01 0 00 401043'	LEQ3:	SUB	STACK,[XWD 2,2]	; BUMP STACK
   900	400732'	254 00 0 11 000000 		JRST	0(TLINK)	; TAKE 'LESS THAN' EXIT
   901

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 24
SNOSTR	MAC	13-Oct-66 22:05		STCON - STRING CONSTANT (TO GROWING AREA)

   902						SUBTTL	STCON - STRING CONSTANT (TO GROWING AREA)
   903
   904					;	CALLING SEQUENCE:
   905					;
   906					;	PUSH STRING DESCRIPTOR ONTO STACK
   907					;	JSP	TLINK,STCON	; INSERT STRING CONSTANT
   908					;	RETURN WITH NEW DESCRIPTOR REPLACING OLD
   909
   910
   911	400733'	550 16 0 01 777777 	STCON::	HRRZ	Q2,-1(STACK)	; MAKE SURE ...
   912	400734'	317 16 0 00 400462*		CAMG	Q2,CEIL		; STRING BLOK
   913	400735'	315 16 0 00 000000*		CAMGE	Q2,FLOOR##	; IS IN ...
   914	400736'	254 00 0 11 000000 		JRST	0(TLINK)	; THE FLOATING AREA
   915
   916	400737'	550 12 0 01 000000 		HRRZ	T2,0(STACK)	; GET LENGTH
   917	400740'	313 12 0 00 000000*		CAMLE	T2,STCREM##	; ENOUGH ROOM
   918	400741'	254 00 0 00 400760'		JRST	STCON2		; NO
   919
   920	400742'	265 15 0 00 400710*		JSP	QLINK,CVTPTR	; GET ...
   921	400743'	000000	000000			0			; POINT-
   922	400744'	001 17 0 00 000000 		ERROR	15		; ER
   923
   924	400745'	261 01 0 00 000000*		PUSH	STACK,STCHD##	; LOAD
   925	400746'	200 16 0 00 000000*		MOVE	Q2,STCTOT##	; NEW
   926	400747'	274 16 0 00 400740*		SUB	Q2,STCREM##	; DESCRIP-
   927	400750'	504 16 0 00 000016 		HRL	Q2,Q2		; OR
   928	400751'	540 16 0 00 000012 		HRR	Q2,T2		; ONTO 
   929	400752'	261 01 0 00 000016 		PUSH	STACK,Q2	; STACK
   930
   931						 ; TOP OF LOOP
   932
   933	400753'	134 16 0 00 000000 	STCON1:	ILDB	Q2,Z		; COPY ...
   934	400754'	136 16 0 00 000000*		IDPB	Q2,STCPTR##	; CHARACTER
   935	400755'	370 00 0 00 400747*		SOS	STCREM		; DECREMENT COUNT
   936	400756'	367 12 0 00 400753'		SOJG	T2,STCON1	; LOOP ON LENGTH OF STRING
   937
   938	400757'	254 00 0 11 000000 		JRST	0(TLINK)	; AND RETURN
   939
   940						 ; HERE IF A NEW SBLOK NEED BE ALLOCATED
   941
   942	400760'	271 12 0 00 000310 	STCON2:	ADDI	T2,^D200	; 40 WORDS
   943	400761'	231 12 0 00 000005 		IDIVI	T2,5		; WORD COUNT
   944	400762'	200 00 0 00 000012 		MOVE	Z,T2		; NEEDED LENGTH
   945	400763'	265 15 0 00 000000*		JSP	QLINK,GCOLG##	; ENSURE ROOM
   946	400764'	200 00 0 00 000012 		MOVE	Z,T2		; RESTORE Z
   947	400765'	200 16 0 00 000000*		MOVE	Q2,GSURF##	; SAVE SBLOK ADDR
   948	400766'	272 00 0 00 400765*		ADDM	Z,GSURF		; UPDATE GSURF
   949
   950	400767'	505 00 0 00 000403 		HRLI	Z,SBLOK		; COMPLETE ...
   951	400770'	202 00 0 16 000000 		MOVEM	Z,BTCODE&BLENG(Q2) ; HEADER
   952	400771'	402 00 0 16 000001 		CLEARM	GCFLD(Q2)	; CLEAR FOR HYGIENE
   953
   954	400772'	275 12 0 00 000002 		SUBI	T2,2		; DETERMINE ...
   955	400773'	221 12 0 00 000005 		IMULI	T2,5		; NUMBER OF 
SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 24-1
SNOSTR	MAC	13-Oct-66 22:05		STCON - STRING CONSTANT (TO GROWING AREA)

   956	400774'	202 12 0 00 400755*		MOVEM	T2,STCREM	; CHARACH-
   957	400775'	202 12 0 00 400746*		MOVEM	T2,STCTOT	; TERS
   958
   959	400776'	505 16 0 00 004003 		HRLI	Q2,SDT		; MAKE DESCRIP-
   960	400777'	202 16 0 00 400745*		MOVEM	Q2,STCHD	; TOR TOP
   961
   962	401000'	201 16 0 16 000000 		MOVEI	Q2,0(Q2)	; MAKE POINTER
   963	401001'	270 16 0 00 401051'		ADD	Q2,[POINT 7,2]	; TO FIRST ...
   964	401002'	202 16 0 00 400754*		MOVEM	Q2,STCPTR	; BYTE
   965
   966	401003'	254 00 0 00 400733'		JRST	STCON		; RESUME PROCESSING
   967

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 25
SNOSTR	MAC	13-Oct-66 22:05		STCON - STRING CONSTANT (TO GROWING AREA)

   968					;	TRIMT - A TYPE T ROUTINE TO TRIM TRAILING BLANKS
   969					; CALLING SEQUENCE
   970					;	PUSH STRING DESCRIPTOR
   971					;	JSP	TLINK,TRIMT
   972					;	RETURN (ARGUMENT REPLACED BY RETURNED VALUE)
   973
   974	401004'	550 12 0 01 777777 	TRIMT::	HRRZ	T2,-1(STACK)	; LOAD SBLOK POINTER
   975	401005'	322 12 0 11 000000 		JUMPE	T2,0(TLINK)	; NULL STRING EXIT
   976
   977	401006'	554 15 0 01 000000 		HLRZ	Q1,0(STACK)	; OFFSET
   978	401007'	550 17 0 01 000000 		HRRZ	Q3,0(STACK)	; LENGTH
   979	401010'	271 15 0 17 000000 		ADDI	Q1,0(Q3)	; SUM
   980	401011'	231 15 0 00 000005 		IDIVI	Q1,5		; Q1 - WORDS, Q2 - BYTES
   981	401012'	271 12 0 15 000002 		ADDI	T2,SCHARS(Q1)	; POINT TO WORD
   982	401013'	200 14 0 12 000000 		MOVE	T4,0(T2)	; MOVE WORD TO T4
   983	401014'	200 15 0 00 000016 		MOVE	Q1,Q2		; COPY # OF BYTES OFFSET
   984	401015'	221 15 0 00 000007 		IMULI	Q1,7		; SHIFT THIS MANY BYTES
   985	401016'	246 13 0 15 000000 		LSHC	T3,0(Q1)	; INTO T3
   986
   987						 ; SEARCH BACKWARDS FOR NONBLANK BY SHIFTING
   988
   989	401017'	361 16 0 00 401031'	TRIMT1:	SOJL	Q2,TRIMT2	; IF Q2 IS 0 REFRESH WORD
   990	401020'	400 14 0 00 000000 		CLEAR	T4,		; ZERO OUT TEST WORD
   991	401021'	246 13 0 00 777771 		LSHC	T3,-7		; SHIFT INTO T4 HIGH
   992	401022'	312 14 0 00 401052'		CAME	T4,[ASCII / /]	; BLANK?
   993	401023'	254 00 0 00 401041'		JRST	TRIMT3		; NO - DONE
   994	401024'	367 17 0 00 401017'		SOJG	Q3,TRIMT1	; DECREMENT LENGTH
   995
   996						 ; STRING WAS ALL BLANK
   997
   998	401025'	274 01 0 00 401043'	TRIMT4:	SUB	STACK,[2,,2]	; POP DESCRIPTOR
   999	401026'	261 01 0 00 400676*		PUSH	STACK,NULLST	; RETURN ...
  1000	401027'	261 01 0 00 000000#		PUSH	STACK,NULLST+1	; NULL ...
  1001	401030'	254 00 0 11 000000 		JRST	0(TLINK)	; STRING
  1002
  1003						 ; HERE TO PICK UP PREVIOUS WORD
  1004
  1005	401031'	200 13 0 12 777777 	TRIMT2:	MOVE	T3,-1(T2)	; LOAD PREVIOUS WORD
  1006	401032'	242 13 0 00 777777 		LSH	T3,-1		; GET RID OF BIT 35
  1007	401033'	201 16 0 00 000005 		MOVEI	Q2,5		; PRIME Q2
  1008	401034'	312 13 0 00 401053'		CAME	T3,["     "]	; ALL BLANK?
  1009	401035'	364 12 0 00 401017'		SOJA	T2,TRIMT1	; NO - LOOK AT EACH CHAR.
  1010
  1011	401036'	275 17 0 00 000005 		SUBI	Q3,5		; 5 FEWER BYTES
  1012	401037'	323 17 0 00 401025'		JUMPLE	Q3,TRIMT4	; IF NONE LEFT- RETURN NULL
  1013
  1014	401040'	364 12 0 00 401031'		SOJA	T2,TRIMT2	; LOOP FOR MORE
  1015
  1016						 ; WRAP-UP
  1017
  1018	401041'	542 17 0 01 000000 	TRIMT3:	HRRM	Q3,0(STACK)	; PLUG LENGTH
  1019	401042'	254 00 0 11 000000 		JRST	0(TLINK)	; RETURN
  1020

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 26
SNOSTR	MAC	13-Oct-66 22:05		STCON - STRING CONSTANT (TO GROWING AREA)

  1021						END

NO ERRORS DETECTED

HI-SEG. BREAK IS 401054
PROGRAM BREAK IS 000000
CPU TIME USED 06:51.278

44P CORE USED
SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page S-1
SNOSTR	MAC	13-Oct-66 22:05		SYMBOL TABLE

ASB1		400472'		E13$56		000000	sin	P2		000005		STRWHO		000000	spd	
ASB2		400456'		E13$57		000000	sin	PAD1		400200'		SURF		000002		
ASBLOK		400450'	int	E13$58		000000	sin	PAD3		400171'		T1		000011		
ASC.1		400006'		E15$		000000	sin	PADCOM		400164'		T2		000012		
ASC.2		400015'		E15$0		000000	sin	PLINK		000004		T3		000013		
ASCI.0		400000'	int	EQINIT		400576'	int	PPL		000003	spd	T4		000014		
ASCII		400000'		EQUAL		400610'	int	PPR		400500'	ext	TLINK		000011		
BLENG		000000	sin	EQUAL1		400626'		PSHR		400474'	ext	TRIM		400444'	int	
BLOK		400330'	ext	EQUAL2		400620'		Q1		000015		TRIMT		401004'	int	
BTCODE		000000	sin	ERR	001000	000000		Q2		000016		TRIMT1		401017'		
CAT		400025'	int	ERR.	003000	000000		Q3		000017		TRIMT2		401031'		
CAT1		400052'		FLAP		400363'	ext	QLINK		000015		TRIMT3		401041'		
CAT2		400054'		FLAT		400713'	ext	REGQ		000015	spd	TRIMT4		401025'		
CAT3		400057'		FLOOR		400735'	ext	RETNL1		400433'	ext	Z		000000		
CATP		400061'	ext	FRET1		400435'	ext	RETNL2		400415'	ext	$ALPHA		400166'	ext	
CC1		400507'		FRET2		400414'	ext	RETNUL		401044'	ext	$MAXL		400450'	ext	
CC2		400522'		FTDEBU		000000	spd	RP.A2		400300'	ext	%%JOBD	043100	000450	spd	
CC3		400526'		GCFLD		000001	sin	RP.INS		400321'		%%MACT	000200	000025	spd	
CC4		400535'		GCOLF		400477'	ext	RP.TBL		400333'	ext	%%SNOP	000500	000305	spd	
CC5		400532'		GCOLG		400763'	ext	RPAD		400154'	int	%%UUOS	001400	000457	spd	
CEIL		400734'	ext	GSURF		400766'	ext	RPL1		400227'		
CONCAT		400504'	int	ID.D1		400650'		RPL2		400252'		
CTBITS		000002	sin	ID.D2		400655'		RPL3		400260'		
CTBLOK		000413	sin	ID.NO		400671'		RPL4		400223'		
CVTINT		400416'	ext	ID.RET		400664'		RPL5		400327'		
CVTPTR		400742'	ext	ID.ST1		400703'		RPL6		400335'		
CVTSTR		400444'	ext	ID.STR		400675'		RPL7		400271'		
DFFR		400062'	int	ID.VEC		400635'		RPLC		400221'	int	
DTNUM		000077	sin	ID.YES		400673'		RV.1		400367'		
DUPL		400072'	int	IDENT		400670'	int	RV.2		400373'		
DUPLI		400540'	int	IDENT0		400066'	int	RVRS		400342'	int	
DUPLI1		400550'		IDINIT		400630'	int	S1		000006		
DUPLI2		400565'		IDT		002001	sin	S2		000007		
DUPLI3		400567'		IGNOT		400714'	ext	S3		000010		
E1$107		000000	sin	LEQ		400105'	int	SB.2		400442'		
E1$35		000000	sin	LEQ1		400715'		SB.3		400416'		
E1$36		000000	sin	LEQ2		400726'		SBLOK		000403	sin	
E1$37		000000	sin	LEQ3		400731'		SBSTR		400404'	int	
E1$63		000000	sin	LEQUAL		400704'	int	SCHARS		000002	sin	
E1$64		000000	sin	LEX		400120'		SDT		004003	sin	
E1$75		000000	sin	LEXC		400126'		SIZE		400376'	int	
E1$76		000000	sin	LEXC1		400142'		SLINK		000006		
E1$77		000000	sin	LGE		400107'	int	STACK		000001		
E1$86		000000	sin	LGT		400111'	int	STCHD		400777'	ext	
E1$87		000000	sin	LLE		400113'	int	STCON		400733'	int	
E1$88		000000	sin	LLT		400115'	int	STCON1		400753'		
E1$89		000000	sin	LNE		400117'	int	STCON2		400760'		
E1$95		000000	sin	LPAD		400147'	int	STCPTR		401002'	ext	
E1$96		000000	sin	LPAD1		400150'		STCREM		400774'	ext	
E1$97		000000	sin	LREGQ		000003	spd	STCTOT		400775'	ext	
E11$10		000000	sin	LX.2ND		400136'		STRASC	516512	200000	spd	
E11$11		000000	sin	LX.CMP		400137'		STREDT		000233	spd	
E11$13		000000	sin	MAXDTN		000012	sin	STRMIN		000000	spd	
E13$50		000000	sin	NBYTES		000005	spd	STRSIX	636462	000000	spd	
E13$54		000000	sin	NULLST		401026'	ext	STRVER		000005	spd	

SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 1
SNOSTR	MAC	13-Oct-66 22:05		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

ASB1	   577	   586#
ASB2	   571#	   595
ASBLOK	   336	   447	   560#	   622	   682
ASC.1	    96#	   103
ASC.2	    96	   105#
ASCI.0	    87#
ASCII	    87#
BLENG	   571	   951
BLOK	   417
BTCODE	   571	   951
CAT	   122#
CAT1	   124	   151#
CAT2	   126	   155#
CAT3	   136	   160#
CATP	   131	   162
CC1	   615#	   617
CC2	   632#	   642	   651
CC3	   637#	   640
CC4	   635	   650#
CC5	   645#	   652
CEIL	   576	   912
CONCAT	   146	   261	   608#
CTBITS	   356	   378	   410	   416
CTBLOK	   416
CVTINT	    88	   181	   299	   506	   515
CVTPTR	   339	   344	   388	   395	   440	   633	   688	   692	   732	   753	   877	   920
CVTSTR	   130	   135	   188	   219	   223	   289	   304	   330	   363	   368	   432	   475	   521	   545
DFFR	   168#
DTNUM	   785
DUPL	   181#
DUPLI	   191	   313	   672#
DUPLI1	   675	   681#
DUPLI2	   698#	   707
DUPLI3	   702#	   704
E1$107	    89#
E1$35	   224#
E1$36	   220#
E1$37	   476#
E1$63	   182#
E1$64	   189#
E1$75	   290#
E1$76	   300#
E1$77	   305#
E1$86	   364#
E1$87	   369#
E1$88	   331#
E1$89	   433#
E1$95	   522#
E1$96	   516#
E1$97	   507#
SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 1
SNOSTR	MAC	13-Oct-66 22:05		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

E11$10	   192#
E11$11	   262#	   314#
E11$13	   147#	   337#	   448#
E13$50	   504#
E13$54	   100#
E13$56	   293#
E13$57	   288#
E13$58	   108#
E15$	   341#	   418#	   922#
E15$0	   690#
EQINIT	   233	   726#	   854
EQUAL	   748#	   856
EQUAL1	   751	   755	   767#
EQUAL2	   760#	   764
FLAP	   132	   133	   138	   139	   140	   141	   142	   143	   160	   161	   221	   222	   235	   236
	   249	   296	   297	   311	   312	   436	   438	   445	   453
FLAT	   625	   626	   645	   646	   684	   686	   709	   710	   728	   730	   757	   812	   821	   822
	   829	   830	   881
FLOOR	   913
FRET1	   186	   397	   404	   427	   519	   526	   533
FRET2	   511
FTDEBU	   588	   592
GCFLD	   573	   952
GCOLF	   591
GCOLG	   945
GSURF	   947	   948
ID.D1	   798	   799	   802	   804	   808#	   850
ID.D2	   788	   794	   795	   796	   800	   801	   803	   819#
ID.NO	   814	   825	   840#
ID.RET	   808	   819	   828#
ID.ST1	   852	   856#
ID.STR	   797	   848#
ID.VEC	   790	   794#
ID.YES	   815	   826	   843#
IDENT	   169	   175	   835#
IDENT0	   174#
IDINIT	   168	   174	   784#
IDT	   477
IGNOT	   731	   735	   750	   758	   828	   835	   853	   874	   875	   882	   890
LEQ	   199#
LEQ1	   885#	   889
LEQ2	   888	   895#
LEQ3	   879	   899#
LEQUAL	   237	   871#
LEX	   200	   203	   206	   209	   212	   219#
LEXC	   232#
LEXC1	   234	   248#
LGE	   202#
LGT	   205#
LLE	   208#
SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 1
SNOSTR	MAC	13-Oct-66 22:05		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

LLT	   211#
LNE	   214#
LPAD	   257#
LPAD1	   260#	   272
LREGQ	   588	   592
LX.2ND	   240#	   251
LX.CMP	   243#	   252
MAXDTN	   787
NBYTES	   566
NULLST	   250	   425	   677	   678	   849	   999	  1000
P2	    92	   102	   106	   122	   123	   125	   199	   202	   205	   208	   211	   214	   243	   244
	   332	   333	   335	   350	   358	   441	   453
PAD1	   285	   296#
PAD3	   282	   287#
PADCOM	   257	   265	   280#
PLINK	   113	   148	   152	   157	   171	   176	   193	   246	   263	   308	   333	   359	   470	   480
	   537	   546	   549
PPL	   588#	   588	   589	   592#	   592	   593
PPR	   592
PSHR	   588
Q1	   402	   403	   454	   455	   468	   471	   637	   639	   698	   704	   758	   760	   882	   885
	   977	   979	   980	   981	   983	   984	   985
Q2	   407	   408	   410	   564	   565	   566	   568	   571	   575	   586	   590	   699	   702	   760
	   762	   885	   887	   895	   911	   912	   913	   925	   926	   927	   928	   929	   933	   934
	   947	   951	   952	   959	   960	   962	   963	   964	   983	   989	  1007
Q3	   409	   410	   574	   578	   579	   581	   582	   587	   628	   702	   703	   761	   762	   886
	   887	   895	   896	   978	   979	   994	  1011	  1012	  1018
QLINK	   336	   339	   344	   388	   395	   417	   440	   447	   563	   583	   591	   622	   633	   682
	   688	   692	   732	   753	   877	   920	   945
REGQ	   588	   589	   592	   593
RETNL1	   346	   442	   531
RETNL2	   512
RETNUL	   170	   177	   243
RP.A2	   325	   365	   366	   370	   371	   386	   387	   393	   394	   401	   402	   426
RP.INS	   407#	   411
RP.TBL	   351	   376	   400	   419	   420
RPAD	   265#
RPL1	   330#	   412	   428
RPL2	   354#	   358
RPL3	   326	   362#
RPL4	   324#	   327
RPL5	   377	   416#
RPL6	   390	   424#
RPL7	   376#	   421
RPLC	   322#
RV.1	   459#	   461	   471
RV.2	   456	   469#
RVRS	   432#
S1	    90	    96	    97	   232	   238	   240	   243	   323	   325	   327	   351	   355	   376	   378
	   382	   383	   400	   408	   443	   459
SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 1
SNOSTR	MAC	13-Oct-66 22:05		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

S2	    93	    99	   101	   106	   107	   109	   110	   112	   183	   186	   190	   249	   250	   291
	   292	   301	   307	   308	   310	   324	   325	   354	   355	   356	   357	   379	   382	   384
	   445	   446	   449	   451	   517	   519	   525	   534
S3	    93	   306	   307	   509	   511	   512	   528	   529	   531	   532	   535	   536	   540
SB.2	   502	   540#
SB.3	   515#	   541
SBLOK	   568	   950
SBSTR	   501#
SCHARS	   468	   565	   582	   981
SDT	   122	   578	   959
SIZE	   475#
SLINK	   257	   265	   315
STACK	    90	    91	   111	   112	   123	   125	   132	   133	   138	   139	   140	   141	   142	   143
	   151	   155	   156	   160	   161	   183	   184	   221	   222	   235	   236	   248	   266	   267
	   268	   269	   270	   271	   283	   284	   291	   296	   297	   301	   302	   306	   311	   312
	   322	   324	   332	   338	   349	   350	   362	   365	   366	   370	   371	   386	   387	   393
	   394	   419	   420	   424	   435	   437	   449	   454	   478	   479	   509	   510	   517	   518
	   523	   524	   536	   579	   580	   610	   624	   629	   632	   645	   646	   650	   673	   676
	   677	   678	   685	   709	   710	   727	   729	   749	   767	   784	   813	   823	   824	   829
	   830	   840	   843	   848	   872	   899	   911	   916	   924	   929	   974	   977	   978	   998
	   999	  1000	  1018
STCHD	   924	   960
STCON	   911#	   966
STCON1	   933#	   936
STCON2	   918	   942#
STCPTR	   934	   964
STCREM	   917	   926	   935	   956
STCTOT	   925	   957
STRASC	    31#
STREDT	    24#
STRMIN	    23#
STRSIX	    30#
STRVER	    22#
STRWHO	    25#
SURF	   571	   573	   574	   575	   576	   586
T1	   322	   342	   357	   362	   425	   426	   451	   452	   455	   470	   523	   534	   535
T2	   347	   354	   391	   407	   456	   461	   469	   524	   525	   526	   529	   532	   609	   642
	   651	   673	   674	   698	   733	   757	   784	   785	   787	   790	   812	   813	   821	   823
	   848	   849	   881	   916	   917	   928	   936	   942	   943	   944	   946	   954	   955	   956
	   957	   974	   975	   981	   982	  1005	  1009	  1014
T3	   338	   349	   398	   409	   459	   460	   610	   615	   616	   624	   625	   632	   640	   672
	   707	   808	   819	   822	   824	   828	   852	   853	   873	   890	   891	   892	   985	   991
	  1005	  1006	  1008
T4	   401	   403	   411	   468	   611	   615	   621	   626	   628	   639	   681	   684	   691	   703
	   749	   750	   764	   872	   873	   874	   875	   889	   982	   990	   992
TLINK	    88	   130	   135	   146	   168	   169	   174	   175	   181	   188	   191	   219	   223	   233
	   237	   261	   289	   299	   304	   313	   330	   363	   368	   432	   475	   506	   515	   521
	   545	   548	   623	   647	   679	   683	   694	   711	   734	   736	   763	   765	   768	   831
	   841	   844	   854	   891	   892	   893	   896	   897	   900	   914	   938	   975	  1001	  1019
TRIM	   545#
SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 1
SNOSTR	MAC	13-Oct-66 22:05		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

TRIMT	   548	   974#
TRIMT1	   989#	   994	  1009
TRIMT2	   989	  1005#	  1014
TRIMT3	   993	  1018#
TRIMT4	   998#	  1012
Z	    91	   145	   184	   190	   260	   266	   267	   268	   269	   270	   271	   281	   287	   302
	   310	   335	   342	   347	   391	   398	   416	   435	   436	   437	   438	   443	   446	   477
	   478	   479	   501	   503	   510	   518	   561	   564	   587	   588	   590	   592	   596	   609
	   617	   621	   637	   672	   674	   675	   681	   685	   686	   691	   699	   727	   728	   729
	   730	   731	   735	   761	   886	   933	   944	   946	   948	   950	   951
$ALPHA	   111	   283
$MAXL	   561
SNOSTR - Strings  %5(233)	MACRO %53B(1156)-1 21:49 14-Mar-88 Page 1
SNOSTR	MAC	13-Oct-66 22:05		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Macro/Opdef cross reference

ERR	   100	   108	   147	   192	   262	   288	   293	   314	   337	   341	   418	   448	   504	   690
	   922
ERR.	    89	   182	   189	   220	   224	   290	   300	   305	   331	   364	   369	   433	   476	   507
	   516	   522
ERROR	   100	   108	   147	   192	   262	   288	   293	   314	   337	   341	   418	   448	   504	   690
	   922
ERROR.	    89	   182	   189	   220	   224	   290	   300	   305	   331	   364	   369	   433	   476	   507
	   516	   522
MIDENT	   589	   593
POPR	   592
PPADDR	   588#	   589	   592#	   593
PPINIT	   588	   592
PPLENG	   588#	   589	   592#	   593
PUSHR	   588
SHOW.	    37	    38	    39	    40
STRPTX	    43
STRTTL	    42
TITLE.	    29Z1Pt