SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOPL	MAC	13-Oct-66 22:20		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76

     1						SUBTTL	Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76
     2
     3					; COPYRIGHTS 1972,1973,1976,1977  STEVENS INSTITUTE OF TECHNOLOGY
     4					; HOBOKEN, NEW JERSEY, 07030
     5					; ALL RIGHTS RESERVED.
     6
     7					  ;UNIVERSALS
     8
     9						SEARCH	JOBDAT		;JOB DATA AREA DEFINITIONS
    10						SEARCH	MACTEN		;DEC-10 COMMON MACROS
    11						SEARCH	UUOSYM		;TOPS10 UUO SYMBOL DEFINITIONS
    12						SEARCH	SNOPRM		;SITBOL PARAMETER FILE
    13
    14					  ;DIRECTIVES
    15
    16						.DIRECT	.XTABM		;EXCLUDE TABS FROM MACRO CALLS
    17						SALL			;SUPPRESS MACRO EXPANSIONS
    18	400000'					TWOSEG	400K		;TWOSEGMENT CODE
    19
    20					  ;VERSION
    21
    22			000005			PLVER==5		;MAJOR VERSION NUMBER
    23			000000			PLMIN==0		;MINOR VERSION NUMBER
    24			000207			PLEDT==207		;EDIT LEVEL
    25			000000			PLWHO==0		;CUSTOMER ARGUMENT
    26
    27					  ;TITLE
    28
    29						TITLE.	PL,SNOPL,<Local Pattern Routines>
    30		605400	000000			PLSIX==SIXBIT /PL/	; SNOPL ABBREVIATION IN SIXBIT
    31		502300	000000			PLASC==ASCIZ /PL/	; SNOPL ABBREVIATION IN ASCII
    32						SALL
    33
    34
    35					  ;SHOW UNIVERSAL VERSION NUMBERS
    36
    37	400000'	043100	000450			SHOW.	%%JOBD		;VERSION NUMBER OF JOBDAT
    38	400000'	000200	000025			SHOW.	%%MACT		;VERSION NUMBER OF MACTEN
    39	400000'	001400	000457			SHOW.	%%UUOS		;VERSION NUMBER OF UUOSYM
    40	400000'	000500	000305			SHOW.	%%SNOP	;VERSION NUMBER OF SNOPRM
    41
    42
    43
    44						PLTTL			; Title
    45						PLPTX			; PASS2 message
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 2
SNOPL	MAC	13-Oct-66 22:20		Table of Contents

    46						SUBTTL	Table of Contents
    47
    48					;		Table of Contents for Local Pattern Routines
    49					;
    50					;
    51					;			   Section			      Page
    52					;   1. Table of Contents. . . . . . . . . . . . . . . . . . .    2
    53					;   2. REVISION HISTORY . . . . . . . . . . . . . . . . . . .    3
    54					;   3. CVTPAT - CONVERT TO PATTERN UTILITY. . . . . . . . . .    4
    55					;   4. PEVAL - EVALUATION ROUTINE FOR PRIMS . . . . . . . . .    6
    56					;   5. PEVALI - PEVAL TO INTEGER. . . . . . . . . . . . . . .    7
    57					;   6. PEVALS - PEVAL TO STRING . . . . . . . . . . . . . . .    8
    58					;   7. PATALL - USED BY BUILT-INS TO ALLOCATE NODE. . . . . .    9
    59					;   8. UPDATE - USED BY BUILT-INS TO UPDATE SURF. . . . . . .   10
    60					;   9. PTRLPL - USED BY LEN AND TAB TO UPDATE STPTR . . . . .   11
    61					;  10. POSTAB - USED BY BUILT-INS POS,RPOS,TAB,RTAB . . . . .   12
    62					;  11. PATPRO - USED BY MOST BUILT-INS AND CVTPAT . . . . . .   13
    63					;  12. BRKPRO - USED BY BREAKX. . . . . . . . . . . . . . . .   14
    64					;  13. EVLPRO - USED BY CVTPAT FOR EXPRESSIONS. . . . . . . .   15
    65					;  14. KEYWORD
    66					;       14.1.   $FAIL . . . . . . . . . . . . . . . . . . . .   16
    67					;       14.2.   $FENCE. . . . . . . . . . . . . . . . . . . .   17
    68					;       14.3.   $REM. . . . . . . . . . . . . . . . . . . . .   18
    69					;  15. ANY - BUILT IN USED BY PATTERN BUILDER . . . . . . . .   19
    70					;  16. PR.ANY - PRIMITIVE USED BY ANY(S) & NOTANY(S). . . . .   20
    71					;  17. PR$ANY - PRIMITIVE USED BY ANY(E). . . . . . . . . . .   21
    72					;  18. NTNY - BUILT-IN USED BY PATTERN BUILDER. . . . . . . .   22
    73					;  19. PR$NTN - PRIMITIVE USED BY NOTANY(E) . . . . . . . . .   23
    74					;  20. BREAK - BUILT-IN USED BY PATTERN BUILDER . . . . . . .   24
    75					;  21. PR.BRK - PRIMITIVE USED BY BREAK(S). . . . . . . . . .   25
    76					;  22. PR$BRK - PRIMITIVE USED BY BREAK(E). . . . . . . . . .   26
    77					;  23. BREAKX - BUILT-IN CALLED BY PATTERN BUILDER. . . . . .   27
    78					;  24. SPAN - BUILT-IN USED BY PATTERN BUILDER. . . . . . . .   28
    79					;  25. PR.SPN - PRIMITIVE USED BY SPAN(S) . . . . . . . . . .   29
    80					;  26. PR$SPN - PRIMITIVE USED BY SPAN(E) . . . . . . . . . .   30
    81					;  27. LEN - BUILT-IN USED BY PATTERN BUILDER . . . . . . . .   31
    82					;  28. PR.LEN - PRIMITIVE USED BY LEN(N). . . . . . . . . . .   32
    83					;  29. PR$LEN - PRIMITIVE USED BY LEN(E). . . . . . . . . . .   33
    84					;  30. POS - BUILT-IN USED BY PATTERN BUILDER . . . . . . . .   34
    85					;  31. PR.POS - PRIMITIVE USED BY POS(N). . . . . . . . . . .   35
    86					;  32. PR$POS - PRIMITIVE USED BY POS(E). . . . . . . . . . .   36
    87					;  33. RPOS - BUILT-IN USED BY PATTERN BUILDER. . . . . . . .   37
    88					;  34. PR.RPS - PRIMITIVE USED BY RPOS(N) . . . . . . . . . .   38
    89					;  35. PR$RPS - PRIMITIVE USED BY RPOS(E) . . . . . . . . . .   39
    90					;  36. RTAB - BUILT-IN USED BY PATTERN BUILDER. . . . . . . .   40
    91					;  37. PR.RTB - PRIMITIVE USED BY RTAB(N) . . . . . . . . . .   41
    92					;  38. PR$RTB - PRIMITIVE USED BY RTAB(E) . . . . . . . . . .   42
    93					;  39. TAB - BUILT-IN USED BY PATTERN BUILDER . . . . . . . .   43
    94					;  40. PR.TAB - PRIMITIVE USED BY TAB(N). . . . . . . . . . .   44
    95					;  41. PR$TAB - PRIMITIVE USED BY TAB(E). . . . . . . . . . .   45
    96					;  42. PR.FL - PRIMITIVE USED FOR FAIL. . . . . . . . . . . .   46
    97					;  43. PR.GBL - PRIMITIVE USED BY BAL . . . . . . . . . . . .   47
    98					;  44. PR.LN1 - PRIMITIVE FOR LEN(1). . . . . . . . . . . . .   48
    99					;  45. PR.LFL - PRIMITIVE TO LENGTH FAIL. . . . . . . . . . .   49
   100					;  46. PR.STR - PRIMITIVE FOR 'STRING' SCAN . . . . . . . . .   50
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 2-1
SNOPL	MAC	13-Oct-66 22:20		Table of Contents

   101					;  47. PR.CN1 AND PR.IN1 - IMMEDIATE AND CONDITIONAL NAMING ONE   51
   102					;  48. PRCNB1 AND PRINB1 - IMMEDIATE AND CONDITIONAL NAMING WITH BACK-UP ONE  52
   103					;  49. PR.CN2 - CONDITIONAL NAMING TWO. . . . . . . . . . . .   53
   104					;  50. PRCNB2 - CONDITIONAL NAMING WITH BACK UP TWO . . . . .   54
   105					;  51. PR.IN2 - IMMEDIATE NAMING TWO. . . . . . . . . . . . .   55
   106					;  52. PRINB2 - IMMEDIATE NAMING WITH BACKUP TWO. . . . . . .   56
   107					;  53. NAMELIST PROCESSOR - PNAMEL. . . . . . . . . . . . . .   57
   108					;  54. CURS$ - BUILT-IN TO BUILD NODE . . . . . . . . . . . .   58
   109					;  55. PR.CUR - PRIMITIVE FOR @VARIABLE . . . . . . . . . . .   59
   110					;  56. PR$CUR - PRIMITIVE FOR @EXPRESSION . . . . . . . . . .   60
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 3
SNOPL	MAC	13-Oct-66 22:20		REVISION HISTORY

   111						SUBTTL	REVISION HISTORY
   112
   113					COMMENT	\
   114
   115					START OF VERSION 5.
   116					122	RENAME MODULES & CLEAN UP.
   117					164	Change VA for unevaluated expressions being no longer inline.
   118					207	Clean up some of the code.
   119					\
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 4
SNOPL	MAC	13-Oct-66 22:20		REVISION HISTORY

   120
   121						SUBTTL	CVTPAT - CONVERT TO PATTERN UTILITY
   122
   123					;	CALLING SEQUENCE:
   124					;	PUSH STRING DESCRIPTOR
   125					;	JSP	TLINK,CVTPAT
   126					;	ERROR	;	ARG LEFT ON STACK - WILL NOT
   127						;	CONVERT
   128					;	NORMAL	;	CONVERTED VALUE IS ON STACK
   129
   130	400000'	554 00 0 01 777777 	CVTPAT::	HLRZ	Z,-1(STACK)	;  RETRIEVE DATATYPE
   131	400001'	306 00 0 00 004004 		CAIN	Z,PDT		;  PATTERN?
   132	400002'	254 00 0 11 000001 		JRST	1(TLINK)	;  NORMAL - PATTERN ALREADY.
   133	400003'	306 00 0 00 004006 		CAIN	Z,EDT		;  EXPRESSION?
   134	400004'	254 00 0 00 400100'		JRST	CEXPAT		;  YES, CONVERT HERE
   135	400005'	202 11 0 00 000000*		MOVEM	TLINK,CVPTSV##	;  SAVE TLINK
   136	400006'	265 11 0 00 000000*		JSP	TLINK,CVTSTR##	;  STRING?
   137	400007'	254 00 1 00 400005*		JRST	@CVPTSV		;  ERROR, RETURN
   138	400010'	336 00 0 01 000000 		SKIPN	0(STACK)	;  NULL STRING?
   139	400011'	254 00 0 00 400061'		JRST	NULLND		;  YES
   140	400012'	261 01 0 01 777777 		PUSH	STACK,-1(STACK)	;  SAVE SDT ON STACK
   141	400013'	261 01 0 01 777777 		PUSH	STACK,-1(STACK)	;   . . .
   142	400014'	265 15 0 00 000000*		JSP	QLINK,CVTPTR##	;  POINTER?
   143	400015'	000000	000012			T2	;		REG
   144	400016'	254 00 0 11 000000 		JRST	0(TLINK)	;  NO
   145	400017'	261 01 0 00 401276'		PUSH	STACK,[XWD IDT,0]	; PUSH DESC FOR G.C.
   146	400020'	261 01 0 00 000000 		PUSH	STACK,Z		;  POINTER IN REG 0, SAVE IT
   147	400021'	261 01 0 01 777775 		PUSH	STACK,-3(STACK)	;SET UP FOR CVTCS
   148	400022'	261 01 0 01 777775 		PUSH	STACK,-3(STACK)	;  ETC.
   149	400023'	201 00 0 00 000001 		MOVEI	Z,1		;  LENGTH OF STRING = 1 FOR FIRST
   150						;CHARACTER, ONLY THE FIRST CHARACTER NEED BE CONVERTED
   151						;	TO BE PLACED IN PSTART
   152	400024'	542 00 0 01 000000 		HRRM	Z,0(STACK)	;  PLACE 1 IN LENGTH OF DESC.
   153	400025'	265 11 0 00 000000*		JSP	TLINK,CVTCS##	;  CHARACTER SET?
   154	400026'	001 17 0 00 000000 		ERROR	15		;  ERROR, WEIRD!
   155	400027'	200 11 0 00 400007*		MOVE	TLINK,CVPTSV	;  RESTORE TLINK
   156	400030'	200 00 0 00 000002 		MOVE	Z,SURF		;  ALLOCATE SPACE FROM 
   157	400031'	505 00 0 00 400255'		HRLI	Z,PATPRO	;  SURF FOR . . .
   158	400032'	251 00 0 02 000014 		BLT	Z,LPHDR+2*PNDSZ-1(SURF)	;  PATTERN PROTOTYPE
   159	400033'	201 00 0 00 000015 		MOVEI	Z,LPHDR+2*PNDSZ	;  SIZE OF PROTOTYPE . . .
   160	400034'	542 00 0 02 000000 		HRRM	Z,BLENG(SURF)	;  PLACE IN RIGHT HALF OF PBLOK
   161	400035'	201 13 0 02 000005 		MOVEI	T3,LPHDR(SURF)	;  T3 -> BEGINNING OF NODE
   162	400036'	262 01 0 02 000003 		POP	STACK,PSTART+1(SURF)	;  POP CHARACTER SET . . .
   163	400037'	262 01 0 02 000002 		POP	STACK,PSTART(SURF)	;  DESCRIPTOR INTO PSTART
   164	400040'	262 01 0 13 000007 		POP	STACK,PNDSZ+PARG+1(T3)	;  POP POINTER INTO NODE
   165	400041'	262 01 0 01 000000 		POP	STACK,(STACK)	;[207]	POP STRING DESCRIPTOR . .. .
   166	400042'	262 01 0 00 000000 		POP	STACK,Z		;  SECOND WORD INTO PARG
   167	400043'	202 00 0 13 000003 		MOVEM	Z,PARG+1(T3)	;  TO BE PLACED IN PARG
   168	400044'	542 00 0 02 000004 		HRRM	Z,PMIN(SURF)	; AND PMIN
   169	400045'	262 01 0 13 000002 		POP	STACK,PARG(T3)	;  POP FIRST WORD TOO
   170	400046'	201 00 0 00 401065'		MOVEI	Z,PR.STR	;  PRIMITIVE FOR STRING . .    
   171	400047'	202 00 0 13 000000 		MOVEM	Z,PPROG(T3)	;  TO BE PLACED IN PPROG
   172
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 5
SNOPL	MAC	13-Oct-66 22:20		CVTPAT - CONVERT TO PATTERN UTILITY

   173
   174	400050'	201 12 0 00 000015 		MOVEI	T2,2*PNDSZ+LPHDR	;  VALUE USED TO INCREMENT
   175						;	SURF
   176	400051'	200 00 0 00 000002 	SRFUPD:	MOVE	Z,SURF		;  LOAD ADDRESS OF PBLOK TO 
   177						;	UPDATE SURF
   178	400052'	505 00 0 00 004004 		HRLI	Z,PDT		;  INSERT PATTERN DATATYPE IN PBLOK
   179	400053'	261 01 0 00 000000 		PUSH	STACK,Z		;  PUSH DESCRIPTOR FOR PDT
   180	400054'	261 01 0 00 401277'		PUSH	STACK,[0]	;  ON TO STACK
   181	400055'	270 02 0 00 000012 		ADD	SURF,T2		;  UPDATE SURFACE - VALUE IN T2
   182	400056'	311 02 0 00 000000*		CAML	SURF,CEIL##	;  IF SURF<CEIL, SKIP
   183	400057'	265 15 0 00 000000*		JSP	QLINK,GCOL##	;  GARBAGE COLLECT IF NOT
   184	400060'	254 00 0 11 000001 		JRST	1(TLINK)	;  NORMAL RETURN
   185	400061'	200 11 0 00 400027*	NULLND:	MOVE	TLINK,CVPTSV	;  RESTORE TLINK
   186	400062'	200 00 0 00 000002 		MOVE	Z,SURF		;  ALLOCATE SPACE FOR PROTOTYPE
   187	400063'	505 00 0 00 400255'		HRLI	Z,PATPRO	;  FROM SURF
   188	400064'	251 00 0 02 000010 		BLT	Z,LPHDR+PNDSZ-1(SURF)	;ETC.
   189	400065'	201 00 0 00 000011 		MOVEI	Z,LPHDR+PNDSZ	;  SIZE OF PROTOTYPE PLACE IN
   190	400066'	542 00 0 02 000000 		HRRM	Z,BLENG(SURF)	;  RIGHT HALF OF PBLOK
   191	400067'	201 13 0 02 000005 		MOVEI	T3,LPHDR(SURF)	;  T3->BEGINNING OF NODE
   192	400070'	262 01 0 00 000000 		POP	STACK,Z		;  RETRIEVE SDT DESCRIPTOR
   193	400071'	202 00 0 13 000003 		MOVEM	Z,PARG+1(T3)	;  PLACE IN PARG - 2ND WORD
   194	400072'	542 00 0 02 000004 		HRRM	Z,PMIN(SURF)	;  AND ALSO IN PMIN
   195	400073'	262 01 0 13 000002 		POP	STACK,PARG(T3)	;  POP FIRST WORD INTO PARG
   196	400074'	201 00 0 00 000000*		MOVEI	Z,SC.S		;  GO TO SUCCESS IF NULL STRING
   197	400075'	202 00 0 13 000000 		MOVEM	Z,PPROG(T3)	;  PLACE IN PPROG
   198	400076'	201 12 0 00 000011 		MOVEI	T2,PNDSZ+LPHDR	;  VALUE TO INCREMENT SURF
   199	400077'	254 00 0 00 400051'		JRST	SRFUPD		;  GO AND UPDATE SURF
   200
   201					;	MERGE HERE IF EXPRESSION
   202	400100'	200 00 0 00 000002 	CEXPAT:	MOVE	Z,SURF		;  ALLOCATE SPECIFIC . . .
   203	400101'	505 00 0 00 400317'		HRLI	Z,EVLPRO	;  PATTERN PROTOTYPE FOR
   204	400102'	251 00 0 02 000010 		BLT	Z,LPHDR+PNDSZ-1(SURF)	;  FOR AN EXPRESSION
   205
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 6
SNOPL	MAC	13-Oct-66 22:20		CVTPAT - CONVERT TO PATTERN UTILITY

   206
   207	400103'	262 01 0 02 000010 		POP	STACK,LPHDR+PARG+1(SURF)	;POP DESCR INTO
   208	400104'	262 01 0 02 000007 		POP	STACK,LPHDR+PARG(SURF)		;	PATTERN NODE
   209	400105'	201 12 0 00 000011 		MOVEI	T2,PNDSZ+LPHDR		; PLACE VALUE TO BE ADDED TO
   210						;	SURF IN T2
   211	400106'	254 00 0 00 400051'		JRST	SRFUPD		;  UPDATE SURF
   212
   213	
   214						SUBTTL	PEVAL - EVALUATION ROUTINE FOR PRIMS
   215
   216					;	CALL:
   217					;		MOVEI	T2,LOC(DESCR OF EBLOK)
   218					;		JSP	TLINK,PEVAL##
   219					;	RETURN:
   220					;		TO CALL+1 IF EVAL FAILED.	BAD ARG ON STACK
   221					;		TO CALL+2 IF EVAL SUCCEEDED.	EVALUATED ARG ON STACK
   222
   223	400107'	554 17 0 12 000000 	PEVAL::	HLRZ	Q3,0(T2)	; PICK UP DATATYPE
   224	400110'	302 17 0 00 004006 		CAIE	Q3,EDT		; EXPRESSION?
   225	400111'	254 00 0 00 400153'		JRST	PEVALX		; NO
   226
   227	400112'	550 17 0 12 000000 		HRRZ	Q3,0(T2)	; ADDRESS OF CBLOK
   228	400113'	270 17 0 12 000001 		ADD	Q3,1(T2)	; LOCATION OF EXPRESSION
   229	400114'	200 15 0 17 000001 		MOVE	Q1,1(Q3)	; LOAD NEXT WORD
   230	400115'	312 15 0 00 401300'		CAME	Q1,[CDIF,,EOE##] ; END OF EXP?
   231	400116'	254 00 0 00 400122'		JRST	PEVAL1		; NO
   232
   233	400117'	261 01 0 17 000000 		PUSH	STACK,0(Q3)	; PUSH SINGLE ELEMENT
   234	400120'	261 01 0 00 401277'		PUSH	STACK,[0]	; ONTO THE STACK
   235	400121'	254 00 0 11 000001 		JRST	1(TLINK)	; AND RETURN
   236
   237	400122'	265 00 0 00 000000*	PEVAL1:	PUSHSA	MIPS		;HAVE A LONG ONE
   238	400123'	000046	000000*
   239	400124'	265 00 0 00 000000*		PUSHR	PST		;	EVERYTHING
   240	400125'	000012	000004
   241	400126'	202 03 0 00 000000*		MOVEM	HSR,HSTACK##	;	AND RESET HIST STACK POINTER
   242
   243	400127'	261 01 0 12 000000 		PUSH	STACK,0(T2)	;PUT ARG ONTO STACK
   244	400130'	261 01 0 12 000001 		PUSH	STACK,1(T2)	;	DESCR IS 2 WORDS
   245
   246	400131'	201 00 0 00 000001 	PEVAL0:	MOVEI	Z,1		;EVALUATE 
   247	400132'	265 04 0 00 000000*		JSP	PLINK,EVAL##	;	OUR ONE ARG
   248	400133'	254 00 0 00 400137'		JRST	PEVALF		;FAILED.
   249
   250	400134'	262 01 0 00 000000#		POP	STACK,FLAT##+1	; SAVE ...
   251	400135'	262 01 0 00 000000*		POP	STACK,FLAT	; RETURNED VALUE
   252	400136'	254 00 0 00 400140'		JRST	PEVALD		; AND JUMP
   253
   254
   255	400137'	334 15 0 00 401277'	PEVALF:	SKIPA	Q1,[0]		;FAIL RETURN FROM EVAL. RECORD FAIL IN Q1
   256
   257	400140'	201 15 0 00 000001 	PEVALD:	MOVEI	Q1,1	;SUCCESS. RECORD THAT IN Q1
   258
   259	400141'	200 03 0 00 400126*		MOVE	HSR,HSTACK	;RESTORE EVERYBODY'S
   260	400142'	265 00 0 00 000000*		POPR	PST		;	STATUS INDIC'S
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 6-1
SNOPL	MAC	13-Oct-66 22:20		PEVAL - EVALUATION ROUTINE FOR PRIMS

   261	400143'	000011	000004
   262	400144'	265 00 0 00 000000*		POPSA	MIPS		; AND REGS
   263	400145'	000046	400123*
   264	400146'	322 15 0 11 000000 		JUMPE	Q1,0(TLINK)	; FAIL? GIVE FAIL EXIT
   265
   266	400147'	201 12 0 00 400135*		MOVEI	T2,FLAT		; POINT TO RET. VALUE
   267	400150'	554 16 0 00 400147*		HLRZ	Q2,FLAT		; LOAD DATA TYPE
   268	400151'	306 16 0 00 004006 		CAIN	Q2,EDT		; ITS NOT EXPRESSION?
   269	400152'	254 00 0 00 400107'		JRST	PEVAL		; IT IS, BACK FOR MORE
   270
   271	400153'	261 01 0 12 000000 	PEVALX:	PUSH	STACK,0(T2)	;PUT RSLT OR ORIG ARG
   272	400154'	261 01 0 12 000001 		PUSH	STACK,1(T2)	;	ONTO STACK AS THE ANSWER
   273
   274	400155'	254 00 0 11 000001 		JRST	1(TLINK)		;	-NORMAL RETURN
   275
   276
   277					;
   278					;
   279					;	SUBROUTINE TO SQUEEZE OUT SINGLE-ELEMENT
   280					;	UNEVALUATED EXPRESSIONS
   281					;	CALL:
   282					;	MOVEI	T2,LOC(DESCR OF EXP)
   283					;	JSP	T3,SQZE
   284						 ;MAY ALTER T2 & Q3
   285					;	RETURN:
   286					;	TO CALL + 1 IF FOUND NON-EXPR SOMEWHERE
   287					;	TO CALL + 2 IF FOUND A LONG EXPRESSION
   288					;		T2 = LOC(RESULT OF SEARCH), ALWAYS
   289					;
   290	400156'	554 00 0 12 000000 	SQZE:	HLRZ	Z,0(T2)		;CHECK FOR EXPR
   291	400157'	302 00 0 00 004006 		CAIE	Z,EDT		;	IF NOT,
   292	400160'	254 00 0 13 000000 		JRST	0(T3)		;	EXIT QUICK
   293
   294	400161'	550 17 0 12 000000 		HRRZ	Q3,0(T2)	;CHECK FOR SIMPLE EXPR
   295	400162'	550 00 0 17 000000 		HRRZ	Z,BLENG(Q3)	;	IS IT A SHORT ONE?
   296	400163'	302 00 0 00 000004 		CAIE	Z,LHDR+2	;	I.E., ONE DESCR LONG?
   297	400164'	254 00 0 13 000001 		JRST	1(T3)		;NO- EXIT TO DO THE LONG EVAL
   298
   299	400165'	201 12 0 17 000002 		MOVEI	T2,LHDR(Q3)	;YES- USE IT INSTEAD.
   300	400166'	254 00 0 00 400156'		JRST	SQZE		;	AND TRY TO REPEAT IT.
   301
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 7
SNOPL	MAC	13-Oct-66 22:20		PEVAL - EVALUATION ROUTINE FOR PRIMS

   302
   303						SUBTTL	PEVALI - PEVAL TO INTEGER
   304					;	TYPE S ROUTINE - PEVAL TO INTEGER CALLED BY POS, RPS, TAB,
   305					;	LEN, RTAB - RETURNS WITH A NONNEGATIVE INTEGER ON STACK
   306					;	CALLING SEQUE
   307					;		HAVE P2 SET TO ADDR OF PATT NODE
   308					;	JSP	SLINK,PEVALI
   309					;	NORMAL RETURN
   310
   311	400167'	201 12 0 05 000002 	PEVALI:	MOVEI	T2,PARG(P2)	;SET UP FOR PEVAL- ARG ADDR
   312	400170'	265 11 0 00 400107'		JSP	TLINK,PEVAL	;  CALL PEVAL
   313	400171'	254 00 0 00 000000*		JRST	SC.MF##		;  ERROR, MATCH FAIL
   314
   315	400172'	265 11 0 00 000000*		JSP	TLINK,CVTVAL##	; CONVERT VARIABLES
   316						JRST	[SUB STACK,[2,,2]
   317	400173'	254 00 0 00 401302'			 JRST SC.MF]	; POP STACK AND FAIL
   318
   319	400174'	265 11 0 00 000000*		JSP	TLINK,CVTINT##	;  CONVERT DESCRIPTOR TO INTEGER
   320	400175'	003 01 0 00 000002 		ERROR.	1,2		;RQD INT ARG AND IT'S NOT.
   321	400176'	335 00 0 01 000000 		SKIPGE	0(STACK)	;  NONNEGATIVE?
   322	400177'	001 15 0 00 000001 		ERROR	13,1		;  NO, ERROR
   323	400200'	254 00 0 06 000000 		JRST	0(SLINK)	; RETURN
   324
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 8
SNOPL	MAC	13-Oct-66 22:20		PEVALI - PEVAL TO INTEGER

   325
   326						SUBTTL	PEVALS - PEVAL TO STRING
   327
   328					;	TYPE S ROUTINE - PEVAL TO STRING
   329					;	CALLED BY PR$ANY, PR$NTNY, PR$SPN, PR$BRK
   330					;	RETURNS WITH A NONNULL STRING ON STACK
   331					;	CALLING SEQUENCE:
   332
   333					;	HAVE P2 SET TO PATT NODE
   334					;	JSP	SLINK,PEVALS
   335					;	NORMAL RETURN
   336
   337
   338	400201'	201 12 0 05 000002 	PEVALS:	MOVEI	T2,PARG(P2)	;	SET UP FOR PEVAL
   339	400202'	265 11 0 00 400107'		JSP	TLINK,PEVAL	;  CALL PEVAL
   340	400203'	254 00 0 00 400171*		JRST	SC.MF		;  ERROR
   341
   342	400204'	265 11 0 00 400172*		JSP	TLINK,CVTVAL	; MAKE VALUE
   343						JRST	[SUB STACK,[2,,2]
   344	400205'	254 00 0 00 401302'			 JRST SC.MF]	; POP STACK AND FAIL
   345
   346	400206'	265 11 0 00 400006*		JSP	TLINK,CVTSTR	;  CONVERT DESCRIPTOR FROM PEVAL TO STR
   347	400207'	003 01 0 00 000006 		ERROR.	1,6		;RQD STRING AND IT'S NOT.
   348	400210'	200 00 0 01 777777 		MOVE	Z,-1(STACK)	;  YES, SEE IF NULL
   349	400211'	316 00 0 00 000000*		CAMN	Z,NULLST##	;  . . .
   350	400212'	001 15 0 00 000006 		ERROR	13,6		;  YES, ERROR
   351	400213'	254 00 0 06 000000 		JRST	0(SLINK)	;  NO, RETURN
   352
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 9
SNOPL	MAC	13-Oct-66 22:20		PEVALS - PEVAL TO STRING

   353
   354						SUBTTL	PATALL - USED BY BUILT-INS TO ALLOCATE NODE
   355
   356					;	THIS ROUTINE ALLOCATES A PATTERN NODE WITHOUT UPDATING SURF
   357					;	AND IS CALLED BY THE VARIOUS PATTERN BUILT-IN FUNCTIONS
   358					;	AND ANY OTHER PATTERN LOCAL TYPE ROUTINES WHERE APPLICABLE
   359					;	CALLING SEQUENCE:
   360					;	JSP TLINK,PATALL
   361
   362	400214'	200 00 0 00 000002 	PATALL:	MOVE	Z,SURF		;  MOVE SURF POINTER TO REG 0
   363	400215'	505 00 0 00 400255'		HRLI	Z,PATPRO	;  INSERT PATTERN PROTOTYPE 
   364						;	ADDRESS IN REG 0
   365	400216'	251 00 0 02 000010 		BLT	Z,LPHDR+PNDSZ-1(SURF)	;  MOVE ENTIRE PROTOTYPE
   366						;	INTO FLOATING STORAGE
   367	400217'	201 12 0 02 000005 		MOVEI	T2,LPHDR(SURF)	;  T2 -> NODE
   368	400220'	262 01 0 12 000003 		POP	STACK,PARG+1(T2)	;  POP ARGUMENT INTO . . .
   369	400221'	262 01 0 12 000002 		POP	STACK,PARG(T2)	;  PARG FIELD OF NODE
   370	400222'	254 00 0 11 000000 		JRST	0(TLINK)	;  RETURN
   371
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 10
SNOPL	MAC	13-Oct-66 22:20		PATALL - USED BY BUILT-INS TO ALLOCATE NODE

   372
   373						SUBTTL	UPDATE - USED BY BUILT-INS TO UPDATE SURF
   374
   375					;	THIS ROUTINE DOES THE FIRST UPDATE ON SURF CALLED AFTER
   376					;	THE NODE IS FILLED IN.
   377					;	THE ROUTINE IS CALLED BY THE VARIOUS PATTERN BUILT-IN
   378					;	FUNCTIONS ETC.
   379					;	CALLING SEQUENCE:
   380					;	JRST UPDATE
   381
   382	400223'	200 00 0 00 000002 	UPDATE:	MOVE	Z,SURF		;  LOAD ADDRESS OF PBLOK
   383	400224'	505 00 0 00 004004 		HRLI	Z,PDT		;  INSERT PATTERN DATATYPE
   384	400225'	261 01 0 00 000000 		PUSH	STACK,Z		;  PUSH DESCRIPTOR FOR . . .
   385	400226'	261 01 0 00 401277'		PUSH	STACK,[0]	;  PDT ONTO STACK
   386	400227'	271 02 0 00 000011 		ADDI	SURF,PNDSZ+LPHDR	;  UPDATE SURFACE OF FLOATING STORGE
   387	400230'	311 02 0 00 400056*		CAML	SURF,CEIL##	;  IF SURF IS BELOW CEIL, SKIP
   388	400231'	265 15 0 00 400057*		JSP	QLINK,GCOL	;  OTHERWISE GARBAGE COLLECT
   389	400232'	254 00 0 04 000001 		JRST	1(PLINK)	;  RETURN TO PATTERN BUILDER
   390
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 11
SNOPL	MAC	13-Oct-66 22:20		UPDATE - USED BY BUILT-INS TO UPDATE SURF

   391
   392						SUBTTL	PTRLPL - USED BY LEN AND TAB TO UPDATE STPTR
   393
   394					;	THE FOLLOWING ROUTINE IS USED BY LEN AND TAB TO UPDATE STPTR. 
   395					;	USED BY PRIMITIVES LEN AND TAB, NOT BUILT-INS
   396					;	IF MORE THAN ONE WORD OR BYTE IS REQUIRED TO UPDATE
   397					;	STPTR.
   398					;	CALLING SEQUENCE:
   399					;	JRST PTRLPL	OR	JRST PTRLP
   400
   401	400233'	550 00 0 00 000007 	PTRLPL:	HRRZ	Z,S2		;  S2  CONTAINS THE NUMBER OF WORDS
   402	400234'	272 00 0 00 000000*		ADDM	Z,STPTR##	;  UPDATE STPTR
   403					;	MERGE HERE IF THERE ARE LESS THAN FIVE BYTES TO ADD TO STPTR
   404
   405	400235'	361 10 0 00 400074*	PTRLP:	SOJL	S3,SC.S##	;S3-BYTE CNT- LE 0? THEN QUIT
   406	400236'	133 00 0 00 400234*		IBP	STPTR		;	IF NOT YET, INC ONCE
   407	400237'	254 00 0 00 400235'		JRST	PTRLP		;	AND SEE IF THAT FINISHES IT
   408
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 12
SNOPL	MAC	13-Oct-66 22:20		POSTAB - USED BY BUILT-INS POS,RPOS,TAB,RTAB

   409						SUBTTL	POSTAB - USED BY BUILT-INS POS,RPOS,TAB,RTAB
   410
   411					;	THE FOLLOWING ROUTINE IS COMMON CODE FOR RTAB,TAB,RPOS, AND POS
   412					;	-	THE BUILT-INS.	
   413					;	CALLING SEQUENCE:	
   414					;	MOVEI	P2,PR$---	;	P2 HAS THE PRIMITIVE IF
   415						;	AN EXPRESSION OCCURS FOR ANY
   416						;	OF THE FOUR BUILT-INS E.G.
   417						;	PR$PO
   418					;	MOVEI	S3,PR.---	;	S3 HAS THE PRIMITIVE IF
   419						;	IT IS POSSIBLE TO CONVERT TO
   420						;	INTEGER
   421					;	JSP	SLINK,POSTAB	;	GO HERE
   422					;	RETURN HERE IF EXPRESSION
   423					;	RETURN HERE IF INTEGER IN ORDER TO INITIALIZE PSTART
   424					; 
   425
   426	400240'	265 11 0 00 400174*	POSTAB:	JSP	TLINK,CVTINT	;  INTEGER?
   427	400241'	254 00 0 00 400247'		JRST	PSTB.X		;  NO, TRY EXPRESSION.
   428	400242'	335 00 0 01 000000 		SKIPGE	0(STACK)	;  NEGATIVE ARGUMENT?
   429	400243'	001 15 0 00 000016 		ERROR	13,14	; ERROR - NEGATIVE ARGUMENT
   430	400244'	265 11 0 00 400214'		JSP	TLINK,PATALL	;  ALLOCATE PATTERN PROTOTYPE
   431	400245'	202 10 0 12 000000 		MOVEM	S3,PPROG(T2)	;  STORE PRIMITIVE NAME
   432	400246'	254 00 0 06 000001 		JRST	1(SLINK)	;  GO INITIALIZE PSTART IF NECESSARY
   433					;	MERGE HERE TO TRY FOR EXPRESSION
   434	400247'	554 00 0 01 777777 	PSTB.X:	HLRZ	Z,-1(STACK)	;  RETRIEVE DATATYPE
   435	400250'	302 00 0 00 004006 		CAIE	Z,EDT		;  EXPRESSION?
   436	400251'	003 01 0 00 000051 		ERROR.	1,41		;  ERROR., NEITHER INTEGER OR EXPR
   437	400252'	265 11 0 00 400214'		JSP	TLINK,PATALL	;  ALLOCATE PATTERN PROTOTYPE
   438	400253'	202 05 0 12 000000 		MOVEM	P2,PPROG(T2)	;  STORE EXPRESSION PRIMITIVE
   439						;	ENTRY POINT
   440	400254'	254 00 0 06 000000 		JRST	0(SLINK)	;  RETURN IF EXPRESSION
   441
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 13
SNOPL	MAC	13-Oct-66 22:20		PATPRO - USED BY MOST BUILT-INS AND CVTPAT

   442						SUBTTL	PATPRO - USED BY MOST BUILT-INS AND CVTPAT
   443
   444					;	THE FOLLOWING PROTOTYPE IS USED BY MOST BUILT-INS AND CVTPAT
   445					;
   446	400255'	000404	000011		PATPRO:	XWD	PBLOK,PNDSZ+LPHDR	;  PATTERN BLOCK AND SIZE
   447						REPEAT	LPHDR,<0>	;  FILL WITH ZEROS
   448	400256'	000000	000000
   449	400257'	000000	000000
   450	400260'	000000	000000
   451	400261'	000000	000000
   452	400262'	000000	000000
   453	400263'	400000	400000			XWD	400000,400000	;  NO ALTERNATE, NO SUBSEQUENT
   454						REPEAT	2*PNDSZ-2,<0>	;  REST OF FIRST NODE FILLED
   455	400264'	000000	000000
   456	400265'	000000	000000
   457	400266'	000000	000000
   458	400267'	000000	000000
   459	400270'	000000	000000
   460	400271'	000000	000000
   461						;	WITH ZEROS AS WELL AS 2ND 
   462						;	NODE
   463
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 14
SNOPL	MAC	13-Oct-66 22:20		BRKPRO - USED BY BREAKX

   464						SUBTTL	BRKPRO - USED BY BREAKX
   465
   466					;	THE FOLLOWING PROTOTYPE IS USED BY THE BUILT-IN BREAKX
   467					;
   468	400272'	000404	000025		BRKPRO:	XWD	PBLOK,PNDSZ*4+LPHDR	;  THIS PROTO HAS 4 NODES
   469						REPEAT	LPHDR-1,<0>	;  FILL WITH ZEROS IN SMALL 
   470	400273'	000000	000000
   471	400274'	000000	000000
   472	400275'	000000	000000
   473	400276'	000000	000000
   474						;	PORTION OF FIRST NODE
   475	400277'	000000	400235*			XWD	0,SC.S
   476	400300'	400000	000011			XWD	400000,LPHDR+PNDSZ
   477						REPEAT	PNDSZ-2,<0>	
   478	400301'	000000	000000
   479	400302'	000000	000000
   480
   481	400303'	000000	400503'			XWD	0,PR.BRK	;  PPROG FIELD - ALWAYS SUCCESS
   482	400304'	400000	000015			XWD	400000,LPHDR+PNDSZ*2	;  NO ALTERNATE, 3RD
   483						;	NODE IS SUBSEQUENT
   484						REPEAT	PNDSZ-2,<0>	;  ZEROS
   485	400305'	000000	000000
   486	400306'	000000	000000
   487	400307'	000000	400277*			XWD	0,SC.S		;  PPROG LOCATION
   488	400310'	000021	400000			XWD	LPHDR+3*PNDSZ,400000 ;	NO SUBSQ, ALT IS 4TH NODE
   489						REPEAT	PNDSZ-2,<0>	;  ZEROS
   490	400311'	000000	000000
   491	400312'	000000	000000
   492	400313'	000000	401055'			XWD	0,PR.LN1	;  PPROG
   493	400314'	400000	000011			XWD	400000,LPHDR+PNDSZ	;  NO ALT, SUBS IS 2ND NODE
   494	400315'	002001	000000			XWD	IDT,0		;  PARG FIELD
   495	400316'	000000	000001			1	;		MINIMUM LENGTH IS 1
   496
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 15
SNOPL	MAC	13-Oct-66 22:20		EVLPRO - USED BY CVTPAT FOR EXPRESSIONS

   497						SUBTTL	EVLPRO - USED BY CVTPAT FOR EXPRESSIONS
   498
   499					;	THE FOLLOWING PROTOTYPE IS USED BY CVTPAT IF AN EXPRESSION
   500					;	OCCURS.
   501					; 
   502	400317'	000404	000011		EVLPRO:	XWD	PBLOK,PNDSZ+LPHDR	;  1 NODE
   503						REPEAT	LPHDR-2,<0>	;  ZEROS
   504	400320'	000000	000000
   505	400321'	000000	000000
   506	400322'	000000	000000
   507	400323'	000000	000001			EXP	1		; MINIMUM LENGTH
   508	400324'	000000	000000*			XWD	0,PR.EX1##	;  PPROG
   509	400325'	400000	400000			XWD	400000,400000		;	NO ALT, NO SUBS
   510						REPEAT	PNDSZ-2,<0>	;  ZEROS
   511	400326'	000000	000000
   512	400327'	000000	000000
   513
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 16
SNOPL	MAC	13-Oct-66 22:20		KEYWORD -- $FAIL

   514						SUBTTL	KEYWORD -- $FAIL
   515
   516					;	THIS IS THE PATTERN PROTOTYPE FOR THE KEYWORD $FAIL
   517					; 
   518	400330'	000404	000011		$FAIL::	XWD	PBLOK,PNDSZ+LPHDR	;  PATTERN BLOCK AND SIZE
   519						REPEAT	LPHDR-1,<0>	;  ZEROS
   520	400331'	000000	000000
   521	400332'	000000	000000
   522	400333'	000000	000000
   523	400334'	000000	000000
   524	400335'	000000	401015'			XWD	0,PR.FL		;  PPROG
   525	400336'	400000	400000			XWD	400000,400000	;  NO ALT, NO SUBSQUENT
   526						REPEAT	PNDSZ-2,<0>	;  ZEROS
   527	400337'	000000	000000
   528	400340'	000000	000000
   529
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 17
SNOPL	MAC	13-Oct-66 22:20		KEYWORD -- $FENCE

   530						SUBTTL	KEYWORD -- $FENCE
   531
   532					;	THIS IS THE PATTERN PROTOTYPE FOR THE KEYWORD $FENCE
   533					; 
   534	400341'	000404	000015		$FENCE::	XWD	PBLOK,2*PNDSZ+LPHDR	;  PATTERN BLOCK AND SIZE
   535						REPEAT	LPHDR-1,<0>	;  ZEROS
   536	400342'	000000	000000
   537	400343'	000000	000000
   538	400344'	000000	000000
   539	400345'	000000	000000
   540	400346'	000000	400307*			XWD	0,SC.S		;  MATCHES NULL STRING
   541						;	IF SUCCEEDS , IF NOT, ABORTS
   542	400347'	000011	400000			XWD	LPHDR+PNDSZ,400000	;  ALT IS ABORT - 2ND NODE, 
   543						;	NO SUBSEQUENT
   544						REPEAT	PNDSZ-2,<0>	;  ZEROS
   545	400350'	000000	000000
   546	400351'	000000	000000
   547	400352'	000000	000000*			XWD	0,PR.ABT##	;  ALTERNATE NODE, ABORT
   548	400353'	400000	400000			XWD	400000,400000	;  NO ALT, NO SUBS
   549						REPEAT	PNDSZ-2,<0>	;  ZEROS
   550	400354'	000000	000000
   551	400355'	000000	000000
   552
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 18
SNOPL	MAC	13-Oct-66 22:20		KEYWORD -- $REM

   553						SUBTTL	KEYWORD -- $REM
   554
   555					;	THIS IS THE PATTERN PROTOTYPE FOR THE KEYWORD $REM
   556					;
   557	400356'	000404	000011		$REM::	XWD	PBLOK,PNDSZ+LPHDR	;  PATTERN BLOCK AND SIZE
   558						REPEAT	LPHDR-1,<0>	;  ZEROS
   559	400357'	000000	000000
   560	400360'	000000	000000
   561	400361'	000000	000000
   562	400362'	000000	000000
   563	400363'	000000	400755'			XWD	0,PR.RTB	;  SAME AS . . .
   564	400364'	400000	400000			XWD	400000,400000	;  RTAB(0) - THEREFORE . . .
   565	400365'	002001	000000			XWD	IDT,0		;  INTEGER VALUE = 0
   566	400366'	000000	000000			0	;		. . .
   567
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 19
SNOPL	MAC	13-Oct-66 22:20		ANY - BUILT IN USED BY PATTERN BUILDER

   568						SUBTTL	ANY - BUILT IN USED BY PATTERN BUILDER
   569
   570					;	THIS ROUTINE ALLOCATES SPACE FROM SURF AND FORMS
   571					;	PROTOTYPE FOR ANY AS WELL AS NOTANY
   572					;	CALLING SEQUENCE:	
   573					;	PUSH DESCRIPTOR
   574					;	JSP PLINK,ANY
   575					;	ERROR RETURN
   576					;	NORMAL RETURN FROM UPDATE(COMMON CODE)
   577					;
   578	
   579	400367'	265 11 0 00 400206*	ANY::	JSP	TLINK,CVTSTR	;  STRING?
   580	400370'	254 00 0 00 400410'		JRST	ANY.EX		;  ERROR, TRY EXPRESSION
   581	400371'	200 00 0 01 777777 		MOVE	Z,-1(STACK)	;  TEST FOR . . .
   582	400372'	316 00 0 00 400211*		CAMN	Z,NULLST	;  NULL STRING.
   583	400373'	001 15 0 00 000025 		ERROR	13,21		;  NULL STRING, ERROR.
   584	400374'	265 11 0 00 400025*		JSP	TLINK,CVTCS	;  OK, CONVERT TO CHARACTER SET
   585	400375'	001 17 0 00 000000 		ERROR	15		;  ERROR, WEIRD!
   586					;	MERGE HERE FROM NOTANY BUILT-IN
   587	
   588	400376'	265 11 0 00 400214'	NTNY1:	JSP	TLINK,PATALL	;  COMMON CODE TO ALLOCATE NODE
   589	400377'	200 00 0 12 000002 		MOVE	Z,PARG(T2)	;  INITIALIZE PSTART . . .
   590	400400'	202 00 0 02 000002 		MOVEM	Z,PSTART(SURF)	;  WITH CHARACTER SET IN . . .
   591	400401'	200 00 0 12 000003 		MOVE	Z,PARG+1(T2)	;  PARG . . .
   592	400402'	202 00 0 02 000003 		MOVEM	Z,PSTART+1(SURF)	;  . . . 
   593	400403'	201 10 0 00 400416'		MOVEI	S3,PR.ANY	;  PPROG - PRIMITIVE FOR MATCHER
   594	400404'	202 10 0 12 000000 	ANY1:	MOVEM	S3,PPROG(T2)	;  STORE IN PPROG
   595	400405'	201 00 0 00 000001 		MOVEI	Z,1		;  MINIMUM LENGTH . . .
   596	400406'	202 00 0 02 000004 		MOVEM	Z,PMIN(SURF)	;  STORE IN PMIN
   597	400407'	254 00 0 00 400223'		JRST	UPDATE		;  UPDATE SURF POINTER
   598					;	GO HERE TO TRY FOR AN EXPRESSION 
   599	400410'	554 00 0 01 777777 	ANY.EX:	HLRZ	Z,-1(STACK)	;  EXPRESSION?
   600	400411'	302 00 0 00 004006 		CAIE	Z,EDT		;  . . .
   601	400412'	003 01 0 00 000060 		ERROR.	1,48		;  NEITHER EXPR OR STRING
   602	400413'	201 10 0 00 400427'		MOVEI	S3,PR$ANY	;  PRIMITIVE ENTRY POINT FOR AN
   603						;	EXPRESSION
   604	400414'	201 11 0 00 400404'		MOVEI	TLINK,ANY1	;  RETURN FROM PATALL = TLINK
   605	400415'	254 00 0 00 400214'		JRST	PATALL		;  ALLOCATE NODE AND THEN REJOIN
   606						;	MAIN PROCESSING OF ANY
   607
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 20
SNOPL	MAC	13-Oct-66 22:20		PR.ANY - PRIMITIVE USED BY ANY(S) & NOTANY(S)

   608						SUBTTL	PR.ANY - PRIMITIVE USED BY ANY(S) & NOTANY(S)
   609
   610					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN
   611					;	PR.ANY IS ENCOUNTERED IN A NODE
   612					;	CALLING SEQUENCE:
   613					;	JRST PR.ANY
   614					;	RETURN EITHER GOES TO SUCCESS, LENGTH-FAIL, OR MATCH FAIL
   615					;
   616	400416'	337 00 0 00 000000*	PR.ANY::SKIPG	CURSOR##	;  CHECK CURSOR VALUE FOR LENGTH
   617						;	FAILURE.	IF CURSOR <= 0
   618						;	FAILS.	SINCE ANY REQUIRES
   619						;	LENGTH OF 1
   620	400417'	254 00 0 00 000000*		JRST	SC.LF##		;  ENTRY POINT FOR LENGTH FAIL
   621	400420'	200 07 0 05 000002 		MOVE	S2,PARG(P2)	;  P2 -> CURRENT NODE
   622						;	RETRIEVE FIRST WORD OF
   623						;	DESCRIPTOR,	SET UP S2 AND
   624	400421'	200 10 0 05 000003 		MOVE	S3,PARG+1(P2)	;  S3  FOR CHECK
   625	400422'	265 11 0 00 000000*	ANY.PR:	JSP	TLINK,CHECK##	;  STREAM FOR ANY(S)
   626	400423'	254 00 0 00 400203*		JRST	SC.MF		;  MATCH FAILURE
   627	400424'	133 00 0 00 400236*		IBP	STPTR		;  UPDATE STPTR
   628	400425'	370 00 0 00 400416*		SOS	CURSOR		;  UPDATE CURSOR
   629	400426'	254 00 0 00 400346*		JRST	SC.S		;  RETURN TO SUCCESS
   630
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 21
SNOPL	MAC	13-Oct-66 22:20		PR$ANY - PRIMITIVE USED BY ANY(E)

   631						SUBTTL	PR$ANY - PRIMITIVE USED BY ANY(E)
   632
   633					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN
   634					;	PR$ANY IS ENCOUNTERED IN A NODE - SIGNIFIES
   635					;	THAT AN EXPRESSION MUST BE EVALUATED FOR ANY( )
   636					;	CALLING SEQUENCE:
   637					;	JRST PR$ANY
   638					;	RETURN EITHER GOES TO LENGTH FAILURE, MATCH FAIL, OR SUCCESS
   639					;
   640	400427'	337 00 0 00 400425*	PR$ANY::	SKIPG	CURSOR		;  IF CURSOR <= 0 . . .
   641	400430'	254 00 0 00 400417*		JRST	SC.LF		;  LENGTH FAIL
   642	400431'	265 06 0 00 400201'		JSP	SLINK,PEVALS	;  PEVAL TO STRING
   643	400432'	265 11 0 00 400374*		JSP	TLINK,CVTCS	;  CONVERT EVALUATED EXPRESSION
   644						;	TO CHARACTER SET IF POSSIBLE
   645	400433'	001 17 0 00 000000 		ERROR	15		;  UNABLE TO CONVERT
   646					;	MERGE HERE FROM PR$NTNY
   647	400434'	262 01 0 00 000010 	ANYNT:	POP	STACK,S3	;  SET UP S2 . . .
   648	400435'	262 01 0 00 000007 		POP	STACK,S2	;  AND S3 TO MERGE WITH PR.ANY
   649	400436'	254 00 0 00 400422'		JRST	ANY.PR		;  MERGE WITH PR.ANY TO DO SCAN
   650
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 22
SNOPL	MAC	13-Oct-66 22:20		NTNY - BUILT-IN USED BY PATTERN BUILDER

   651						SUBTTL	NTNY - BUILT-IN USED BY PATTERN BUILDER
   652
   653					;	THIS ROUTINE ALLOCATES SPACE FROM SURF AND FORMS
   654					;	PROTOTYPE FOR NOTANY BY CALLING THE BUILT-IN
   655					;	ANY - UTILIZES CONVERT TO CHARACTER SET COMPLEMENT
   656					;	CALLING SEQUENCE:
   657					;	PUSH DESCRIPTOR
   658					;	JSP PLINK,NTNY
   659					;	ERROR RETURN
   660					;	NORMAL RETURN FROM UPDATE(COMMON CODE)
   661					;
   662	
   663	400437'	265 11 0 00 400367*	NTNY::	JSP	TLINK,CVTSTR	;  STRING?
   664	400440'	254 00 0 00 400447'		JRST	NTNY.X		;  TRY EXPRESSION
   665	400441'	200 00 0 01 777777 		MOVE	Z,-1(STACK)	;  RETRIEVE DATATYPE
   666	400442'	316 00 0 00 400372*		CAMN	Z,NULLST	;  NULL STRING?
   667	400443'	001 15 0 00 000024 		ERROR	13,20		;  ERROR FOR NULL STRING IN NOTANY
   668	400444'	265 11 0 00 000000*		JSP	TLINK,CVTCSC##	;  CONVERT TO CHARACTER SET
   669						;	COMPLEMENT TO MERGE WITH ANY()
   670	400445'	001 17 0 00 000000 		ERROR	15		;  WEIRD ERROR!
   671	400446'	254 00 0 00 400376'		JRST	NTNY1		;  ENTER INTO ANY() BUILT-IN
   672					;	MERGE HERE TO TEST FOR AN EXPRESSION
   673	
   674	400447'	554 00 0 01 777777 	NTNY.X:	HLRZ	Z,-1(STACK)	;  RETRIEVE DATATYPE
   675	400450'	302 00 0 00 004006 		CAIE	Z,EDT		;  EXPRESSION?
   676	400451'	003 01 0 00 000057 		ERROR.	1,47		;  NEITHER EXPR OR STRING
   677	400452'	201 10 0 00 400455'		MOVEI	S3,PR$NTN	;  SET UP S3 WITH PPROG TO JOIN
   678						;	WITH ANY BUILT-IN
   679	400453'	265 11 0 00 400214'		JSP	TLINK,PATALL	;  ALLOCATE NODE ETC
   680	400454'	254 00 0 00 400404'		JRST	ANY1		;  JOIN BUILT-IN ANY()
   681
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 23
SNOPL	MAC	13-Oct-66 22:20		PR$NTN - PRIMITIVE USED BY NOTANY(E)

   682						SUBTTL	PR$NTN - PRIMITIVE USED BY NOTANY(E)
   683
   684					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN
   685					;	PR$NTN IS ENCOUNTERED IN THE PPROG FIELD OF A NODE
   686					;	- SIGNIVIES THAT AN EXPRESSION MUST BE EVALUATED
   687					;	FOR NOTANY( )
   688					;	CALLING SEQUENCE:
   689					;	JRST PR$NTN
   690					;	RETURN EITHER GOES TO LENGTH FAILURE, MATCH FAIL, OR SUCCESS
   691					;
   692	400455'	337 00 0 00 400427*	PR$NTN::	SKIPG	CURSOR		;  IF CURSOR <= 0 . . .
   693	400456'	254 00 0 00 400430*		JRST	SC.LF		;  LENGTH FAIL
   694	400457'	265 06 0 00 400201'		JSP	SLINK,PEVALS	;  PEVAL TO STRING TO EVALUATE
   695	400460'	265 11 0 00 400444*		JSP	TLINK,CVTCSC	;  CONVERT EVALUATED EXPR TO CS
   696	400461'	001 17 0 00 000000 		ERROR	15		;  ERROR, WEIRD!
   697	400462'	254 00 0 00 400434'		JRST	ANYNT		;  MERGE WITH PR$ANY
   698
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 24
SNOPL	MAC	13-Oct-66 22:20		BREAK - BUILT-IN USED BY PATTERN BUILDER

   699						SUBTTL	BREAK - BUILT-IN USED BY PATTERN BUILDER
   700
   701					;	THIS ROUTINE ALLOCATES SPACE FROM SURF AND FORMS
   702					;	PROTOTYPE FOR BREAK 
   703					;	CALLING SEQUENCE:
   704					;	PUSH DESCRIPTOR
   705					;	JSP PLINK,BREAK
   706					;	ERROR RETURN
   707					;	NORMAL RETURN FROM UPDATE(COMMON CODE)
   708					;
   709	400463'	265 11 0 00 400437*	BREAK::	JSP	TLINK,CVTSTR	;  STRING?
   710	400464'	254 00 0 00 400476'		JRST	BRK.EX		;  TRY EXPRESSION
   711	400465'	200 00 0 01 777777 		MOVE	Z,-1(STACK)	;  RETRIEVE DATATYPE
   712	400466'	316 00 0 00 400442*		CAMN	Z,NULLST	;  NULL STRING?
   713	400467'	001 15 0 00 000023 		ERROR	13,19		;  YES, ERROR
   714	400470'	265 11 0 00 400432*		JSP	TLINK,CVTCS	;  NO, CONVERT TO CS
   715	400471'	001 17 0 00 000000 		ERROR	15		;  WEIRD!
   716	400472'	201 10 0 00 400503'		MOVEI	S3,PR.BRK	;  PRIMITIVE FOR PPROG IN S3
   717					;	MERGE HERE AFTER TEST FOR EXPRESSION
   718	400473'	265 11 0 00 400214'	BRK1:	JSP	TLINK,PATALL	;  COMMON CODE
   719	400474'	202 10 0 12 000000 		MOVEM	S3,PPROG(T2)	;  STORE PRIMITIVE
   720	400475'	254 00 0 00 400223'		JRST	UPDATE		;  UPDATE SURF 
   721					;	MERGE HERE TO TEST FOR EXPRESSION
   722	400476'	554 00 0 01 777777 	BRK.EX:	HLRZ	Z,-1(STACK)	;  RETRIEVE DATATYPE
   723	400477'	302 00 0 00 004006 		CAIE	Z,EDT		;  EXPRESSION?
   724	400500'	003 01 0 00 000056 		ERROR.	1,46		;  NEITHER EXPR NOR STRING
   725	400501'	201 10 0 00 400524'		MOVEI	S3,PR$BRK	;  PRIMITIVE FOR PPROG
   726	400502'	254 00 0 00 400473'		JRST	BRK1		;  JOIN NORMAL PROCESSING
   727
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 25
SNOPL	MAC	13-Oct-66 22:20		PR.BRK - PRIMITIVE USED BY BREAK(S)

   728						SUBTTL	PR.BRK - PRIMITIVE USED BY BREAK(S)
   729
   730					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN
   731					;	PR.BRK IS ENCOUNTERED IN A NODE
   732					;	USED BY BREAK() AND BREAKX()
   733					;	CALLING SEQUENCE:
   734					;	JRST PR.BRK
   735					;	RETURN GOES TO MATCH FAILURE, LENGTH FAILURE OR SUCCESS
   736					; 
   737	400503'	200 07 0 05 000002 	PR.BRK::	MOVE	S2,PARG(P2)	;  SET UP T2 AND . . .
   738	400504'	200 10 0 05 000003 		MOVE	S3,PARG+1(P2)	;  T3 FOR STR. - PT -> CURRENT 
   739						;	NODE
   740	400505'	261 01 0 00 400455*	BRK.PR:	PUSH	STACK,CURSOR	;  SAVE CURSOR VALUE(OLD)
   741	400506'	261 01 0 00 400424*		PUSH	STACK,STPTR	;  SAVE STPTR VALUE(OLD)
   742	400507'	350 00 0 00 400505*		AOS	CURSOR		;  ADD ONE TO CURSOR
   743	400510'	265 11 0 00 000000*		JSP	TLINK,STR.##	;  STREAM FOR CHARACTER IN STRING
   744	400511'	254 00 0 00 400521'		JRST	RES.BK		;  ERROR, RESTORE CURSOR ETC.
   745	400512'	274 01 0 00 401301'		SUB	STACK,[XWD 2,2]	;	TAKE OLD VALUE OF CURSOR AND
   746						;	STPTR OFF STACK
   747	400513'	373 00 0 00 400507*		SOSLE	CURSOR		;  UPDATE CURSOR TO GET BACK IN 
   748						;	SYNCH
   749	400514'	254 00 0 00 400426*		JRST	SC.S		;  IF CURSOR > 0, GO TO SUCCESS
   750	400515'	550 00 0 00 000000#		HRRZ	Z,SUBJ##+1	;  IF SUBJECT AND . . .
   751	400516'	312 00 0 00 000000*		CAME	Z,MAXLEN##	;  MAXLEN ARE EQUAL THEN . . .
   752	400517'	254 00 0 00 400514*		JRST	SC.S		;  RESTORE AND LF , ELSE SUCCESS
   753	400520'	270 01 0 00 401301'		ADD	STACK,[2,,2]	; RESTORE STACK
   754	400521'	262 01 0 00 400506*	RES.BK:	POP	STACK,STPTR	;  RESTORE STPTR
   755	400522'	262 01 0 00 400513*		POP	STACK,CURSOR	;  RESTORE CURSOR
   756	400523'	254 00 0 00 400456*		JRST	SC.LF		;  LENGTH FAIL
   757
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 26
SNOPL	MAC	13-Oct-66 22:20		PR$BRK - PRIMITIVE USED BY BREAK(E)

   758						SUBTTL	PR$BRK - PRIMITIVE USED BY BREAK(E)
   759
   760					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN
   761					;	PR$BRK IS ENCOUNTERED IN THE PPROG FIELD OF A NODE
   762					;	USED BY BREAK(E) AND BREAKX(E) - JOINS PR.BRK
   763					;	CALLING SEQUENCE:
   764					;	JRST PR$BRK
   765					;	RETURN GOES TO SUCCESS, MATCH FAIL, OR LENGTH FAIL
   766					;	AFTER EXPRESSION IS EVALUATED AND MATCH ATTEMPTED
   767					; 
   768	400524'	265 06 0 00 400201'	PR$BRK::	JSP	SLINK,PEVALS	;  CALL PEVAL TO STRING
   769	400525'	265 11 0 00 400470*		JSP	TLINK,CVTCS	;  CONVERT EVALUATED EXPRESSION
   770						;	TO CHARACTER SET
   771	400526'	001 17 0 00 000000 		ERROR	15		;  STRANGE ERROR
   772	400527'	262 01 0 00 000010 		POP	STACK,S3	;  SET UP S2 AND S3 . . .
   773	400530'	262 01 0 00 000007 		POP	STACK,S2	;  FOR STR. IN PR.BRK
   774	400531'	254 00 0 00 400505'		JRST	BRK.PR		;  JOIN PR.BRK
   775
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 27
SNOPL	MAC	13-Oct-66 22:20		BREAKX - BUILT-IN CALLED BY PATTERN BUILDER

   776						SUBTTL	BREAKX - BUILT-IN CALLED BY PATTERN BUILDER
   777
   778					;	THIS ROUTINE ALLOCATES SPACE FROM SURF - DOES NOT NEED TO
   779					;	BUILD PROTOTYPE - ALREADY IN CORE - SPECIAL TO BREAKX
   780					;	CALLING SEQUENCE:
   781					;	PUSH DESCRIPTOR
   782					;	JSP PLINK,BRKX
   783					;	ERROR RETURN
   784					;	NORMAL RETURN AFTER AN UPDATE PERFORMED OF SURF
   785					;
   786	400532'	265 11 0 00 400463*	BRKX::	JSP	TLINK,CVTSTR	;  STRING?
   787	400533'	254 00 0 00 400561'		JRST	BRKX.X		;  NO, TRY EXPRESSION.
   788	400534'	200 00 0 01 777777 		MOVE	Z,-1(STACK)	;  RETRIEVE OFFSET AND LENGTH
   789	400535'	316 00 0 00 400466*		CAMN	Z,NULLST	;  NULL STRING?
   790	400536'	001 15 0 00 000022 		ERROR	13,18		;  YES, ERROR
   791	400537'	265 11 0 00 400525*		JSP	TLINK,CVTCS	;  CONVERT TO CS
   792	400540'	001 17 0 00 000000 		ERROR	15		;  WEIRD ERROR!
   793	400541'	201 10 0 00 400503'		MOVEI	S3,PR.BRK	;  PPROG PRIMITIVE IF STRING
   794	400542'	200 00 0 00 000002 	BRX1:	MOVE	Z,SURF		;  ALLOCATE BREAKX . . .
   795	400543'	505 00 0 00 400272'		HRLI	Z,BRKPRO	;  PROTOTYPE
   796	400544'	251 00 0 02 000024 		BLT	Z,LPHDR+4*PNDSZ-1(SURF)
   797	400545'	201 12 0 02 000011 		MOVEI	T2,LPHDR+PNDSZ(SURF)	;  T2 -> 2ND NODE OF PROTO
   798	400546'	262 01 0 12 000003 		POP	STACK,PARG+1(T2)	;  2ND HAS DESCRIPTOR
   799	400547'	262 01 0 12 000002 		POP	STACK,PARG(T2) ; . . .
   800	400550'	202 10 0 12 000000 		MOVEM	S3,PPROG(T2)	;  PPROG PRIMITIVE - STORE
   801	400551'	200 00 0 00 000002 		MOVE	Z,SURF		;  PUSH . . .
   802	400552'	505 00 0 00 004004 		HRLI	Z,PDT		;  . . .
   803	400553'	261 01 0 00 000000 		PUSH	STACK,Z		;  PDT ONTO . . .
   804	400554'	261 01 0 00 401277'		PUSH	STACK,[0]	;  STACK
   805	400555'	271 02 0 00 000025 		ADDI	SURF,4*PNDSZ+LPHDR	;  UPDATE SURF POINTER
   806	400556'	311 02 0 00 400230*		CAML	SURF,CEIL	;  SURF < CEIL?
   807	400557'	265 15 0 00 400231*		JSP	QLINK,GCOL	;  NO, GARBAGE COLLECT
   808	400560'	254 00 0 04 000001 		JRST	1(PLINK)	;  RETURN TO PATTERN BUILDER
   809					;	MERGE HERE TO TEST FOR EXPRESSION
   810	400561'	554 00 0 01 777777 	BRKX.X:	HLRZ	Z,-1(STACK)	;  RETRIEVE DATATYPE
   811	400562'	302 00 0 00 004006 		CAIE	Z,EDT		;  EXPRESSION?
   812	400563'	003 01 0 00 000055 		ERROR.	1,45		;  NEITHER STRING NOR EXPR
   813	400564'	201 10 0 00 400524'		MOVEI	S3,PR$BRK	;  S3 HAS PRIMITIVE FOR PPROG
   814	400565'	254 00 0 00 400542'		JRST	BRX1		;  JOIN MAIN PROCESSING
   815
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 28
SNOPL	MAC	13-Oct-66 22:20		SPAN - BUILT-IN USED BY PATTERN BUILDER

   816						SUBTTL	SPAN - BUILT-IN USED BY PATTERN BUILDER
   817
   818					;	THIS ROUTINE ALLOCATES SPACE FROM SURF AND FORMS
   819					;	PROTOTYPE FOR SPAN()
   820					;	CALLING SEQUENCE:
   821					;	PUSH DESCRIPTOR
   822					;	JSP PLINK,SPAN
   823					;	ERROR RETURN
   824					;	NORMAL RETURN FROM UPDATE(COMMON CODE)
   825
   826	400566'	265 11 0 00 400532*	SPAN::	JSP	TLINK,CVTSTR	;  STRING?
   827	400567'	254 00 0 00 400607'		JRST	SPAN.X		;  NO, TRY EXPRESSION
   828	400570'	200 00 0 01 777777 		MOVE	Z,-1(STACK)	;  NULL STRING?
   829	400571'	316 00 0 00 400535*		CAMN	Z,NULLST	;  . . .
   830	400572'	001 15 0 00 000021 		ERROR	13,17		;  YES, ERROR.
   831	400573'	265 11 0 00 400537*		JSP	TLINK,CVTCS	;  NO, CONVERT TO CS
   832	400574'	001 17 0 00 000000 		ERROR	15		;  WON'T CONVERT, WHY?!
   833	400575'	265 11 0 00 400214'		JSP	TLINK,PATALL	;  COMMON CODE TO ALLOCATE NODE
   834	400576'	200 00 0 12 000002 		MOVE	Z,PARG(T2)	;  INITIALIZE . . .
   835	400577'	202 00 0 02 000002 		MOVEM	Z,PSTART(SURF)	;  PSTART . . .
   836	400600'	200 00 0 12 000003 		MOVE	Z,PARG+1(T2)	;  . . .
   837	400601'	202 00 0 02 000003 		MOVEM	Z,PSTART+1(SURF)	;  . . .
   838	400602'	201 10 0 00 400615'		MOVEI	S3,PR.SPN	;  PRIMITIVE FOR PPROG
   839	
   840					;	MERGE HERE AFTER TEST FOR EXPRESSION
   841	
   842	400603'	202 10 0 12 000000 	SPAN1:	MOVEM	S3,PPROG(T2)	;  STORE PRIMITIVE ENTRY POINT
   843	400604'	201 00 0 00 000001 		MOVEI	Z,1		;  MINIMUM LENGTH FOR MATCH
   844	400605'	202 00 0 02 000004 		MOVEM	Z,PMIN(SURF)	;  STORE IN PMIN
   845	400606'	254 00 0 00 400223'		JRST	UPDATE		;  UPDATE SURF AND RETURN
   846
   847					;	GO HERE TO TEST FOR EXPRESSION
   848
   849	400607'	554 00 0 01 777777 	SPAN.X:	HLRZ	Z,-1(STACK)	;  RETRIEVE DATATYPE
   850	400610'	302 00 0 00 004006 		CAIE	Z,EDT		;  EXPRESSION?
   851	400611'	003 01 0 00 000054 		ERROR.	1,44		;  NO, ERROR.- NEITHER STRING 
   852						;	NOR EXPRESSION
   853	400612'	201 10 0 00 400630'		MOVEI	S3,PR$SPN	;  PRIMITIVE FOR EXPR
   854	400613'	201 11 0 00 400603'		MOVEI	TLINK,SPAN1	;  RETURN POINT IN MAIN PROCESS
   855	400614'	254 00 0 00 400214'		JRST	PATALL		;  ALLOCATE PATTERN
   856
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 29
SNOPL	MAC	13-Oct-66 22:20		PR.SPN - PRIMITIVE USED BY SPAN(S)

   857						SUBTTL	PR.SPN - PRIMITIVE USED BY SPAN(S)
   858
   859					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN PR.SPN
   860					;	IS ENCOUNTERED IN A NODE OF THE PATTERN BLOCK
   861					;	CALLING SEQUENCE:
   862					;	JRST	PR.SPN
   863					;	RETURN EITHER GOES TO SUCCESS, LENGTH-FAIL, OR MATCH-FAIL
   864
   865	400615'	337 00 0 00 400522*	PR.SPN::SKIPG	CURSOR		;  TEST CURSOR FOR LENGTH FAIL
   866	400616'	254 00 0 00 400523*		JRST	SC.LF		;  IF <= 0,  LENGTH-FAIL
   867	400617'	200 10 0 05 000003 		DMOVE	S2,PARG(P2)	;  SET UP REGISTERS S2 . . .
   868	400620'	200 07 0 05 000002 
   869					;	MOVE	S3,PARG+1(P2)	;  S3 FOR STREAMING WHERE P2 ->
   870						;	CURRENT NODE
   871	
   872					;	MERGE HERE FROM PR$SPN
   873
   874	400621'	265 11 0 00 400422*	SPN.PR:	JSP	TLINK,CHECK	;  CHECK FIRST CHARACTER FIRST
   875	400622'	254 00 0 00 400423*		JRST	SC.MF		;  SINCE FIRST CHARACTER DOES
   876						;	NOT MATCH, MATCH FAIL.
   877	400623'	265 11 0 00 000000*		JSP	TLINK,STR.C##	;  STREAM FOR CHARACTER SET
   878						;	COMPLEMENT SO KNOW WHEN TO
   879						;	STOP THE SCAN
   880	400624'	255 00 0 00 000000 		JFCL			;[163] Runnout - but match worked
   881	400625'	336 00 0 00 400615*		SKIPN	CURSOR		;[163] Don't do it.
   882	400626'	133 00 0 00 400521*		IBP	STPTR##		;[163] Increment the byte pointer
   883	400627'	254 00 0 00 400517*		JRST	SC.S		;  MATCH ALSO SUCCEEDED
   884
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 30
SNOPL	MAC	13-Oct-66 22:20		PR$SPN - PRIMITIVE USED BY SPAN(E)

   885						SUBTTL	PR$SPN - PRIMITIVE USED BY SPAN(E)
   886
   887					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN PR$SPN
   888					;	IS ENCOUNTERED IN A NODE OF THE PATTERN BLOCK
   889					;	THIS ROUTINE IS ONLY USED FOR EVALUATING EXPRESSION
   890					;	FOR SPAN.
   891					;	CALLING SEQUENCE:
   892					;	JRST	PR$SPN
   893					;	RETURN EITHER GOES TO SUCCESS, LENGTH-FAIL, OR MATCH-FAIL
   894	400630'	337 00 0 00 400625*	PR$SPN::SKIPG	CURSOR		;  CHECK FOR LENGTH-FAILURE
   895	400631'	254 00 0 00 400616*		JRST	SC.LF		;  FAIL, IF <= 0.
   896	400632'	265 06 0 00 400201'		JSP	SLINK,PEVALS	;  CALL PEVAL TO STRING TO 
   897						;	ATTEMPT TO EVALUATE EXPR
   898	400633'	265 11 0 00 400573*		JSP	TLINK,CVTCS	;  ON RETURN, CONVERT TO CS
   899	400634'	001 17 0 00 000000 		ERROR	15		;  WON'T CONVERT, WHY?!
   900	400635'	262 01 0 00 000010 		POP	STACK,S3	;  SET UP S2, AND S3 FOR . . .
   901	400636'	262 01 0 00 000007 		POP	STACK,S2	;  STREAMING
   902	400637'	254 00 0 00 400621'		JRST	SPN.PR		;  JOIN PR.SPN TO STREAM
   903
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 31
SNOPL	MAC	13-Oct-66 22:20		LEN - BUILT-IN USED BY PATTERN BUILDER

   904						SUBTTL	LEN - BUILT-IN USED BY PATTERN BUILDER
   905
   906					;	THIS ROUTINE ALLOCATES SPACE FROM SURF AND FORMS
   907					;	PROTOTYPE FOR LEN.
   908					;	CALLING SEQUENCE:
   909					;	PUSH DESCRIPTOR
   910					;	JSP PLINK,LEN
   911					;	ERROR RETURN
   912					;	NORMAL RETURN FROM UPDATE(COMMON CODE)
   913
   914	400640'	265 11 0 00 400240*	LEN::	JSP	TLINK,CVTINT	;  INTEGER?
   915	400641'	254 00 0 00 400656'		JRST	LEN.EX		;  NO, TRY EXPRESSION
   916	400642'	335 00 0 01 000000 		SKIPGE	0(STACK)	;  NEGATIVE INTEGER?
   917	400643'	001 15 0 00 000014 		ERROR	13,12		;  YES, ERROR
   918	400644'	265 11 0 00 400214'		JSP	TLINK,PATALL	;  ALLOCATE PROTOTYPE
   919	400645'	201 00 0 00 400665'		MOVEI	Z,PR.LEN	;  PATTERN PRIMITIVE
   920	400646'	202 00 0 12 000000 		MOVEM	Z,PPROG(T2)	;  STORE IN PPROG
   921	400647'	200 15 0 12 000003 		MOVE	Q1,PARG+1(T2)	;  LOAD INTEGER INTO Q1 TO . . .
   922	400650'	202 15 0 02 000004 		MOVEM	Q1,PMIN(SURF)	;  IN PMIN.
   923	400651'	542 15 0 12 000002 		HRRM	Q1,PARG(T2)	;  RETAIN ACTUAL INTEGER VALUE
   924						;	IN RIGHT HALF OF PARG
   925	400652'	231 15 0 00 000005 		IDIVI	Q1,5		;  DETERMINE NO. OF WORDS AND
   926						;	BYTES
   927	400653'	506 15 0 12 000003 		HRLM	Q1,PARG+1(T2)	;  WORDS IN Q1 . . .
   928	400654'	542 16 0 12 000003 		HRRM	Q2,PARG+1(T2)	;  BYTES IN Q2, STORE IN PARG+1
   929	400655'	254 00 0 00 400223'		JRST	UPDATE		;  UPDATE SURF
   930					;	MERGE HERE TO TEST FOR EXPRESSION
   931	400656'	554 00 0 01 777777 	LEN.EX:	HLRZ	Z,-1(STACK)	;  RETRIEVE DATATYPE
   932	400657'	302 00 0 00 004006 		CAIE	Z,EDT		;  EXPRESSION?
   933	400660'	003 01 0 00 000047 		ERROR.	1,39		;  NEITHER INTEGER NOR EXPRESSION
   934	400661'	265 11 0 00 400214'		JSP	TLINK,PATALL	;  ALLOCATE NODE
   935	400662'	201 10 0 00 400676'		MOVEI	S3,PR$LEN	;  PRIMITIVE FOR EXPRESSION
   936	400663'	202 10 0 12 000000 		MOVEM	S3,PPROG(T2)	;  PLACE IN PPROG
   937	400664'	254 00 0 00 400223'		JRST	UPDATE		;  UPDATE SURF
   938
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 32
SNOPL	MAC	13-Oct-66 22:20		PR.LEN - PRIMITIVE USED BY LEN(N)

   939						SUBTTL	PR.LEN - PRIMITIVE USED BY LEN(N)
   940
   941					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN
   942					;	PR.LEN IS ENCOUNTERED IN A NODE OF THE PATTERN BLOCK.
   943					;	CALLING SEQUENCE:
   944					;	JRST PR.LEN
   945					;	RETURN EITHER GOES TO SUCCESS, LENGTH-FAIL OR MATCH FAIL
   946
   947	400665'	550 06 0 05 000002 	PR.LEN::	HRRZ	S1,PARG(P2)	;  RETRIEVE VALUE OF INTEGER
   948	400666'	554 07 0 05 000003 		HLRZ	S2,PARG+1(P2)	;  NUMBER OF WORDS
   949	400667'	550 10 0 05 000003 		HRRZ	S3,PARG+1(P2)	;  NUMBER OF BYTES TO BE 
   950						;	USED IN PTRLPL
   951					;	MERGE HERE FROM PR$LEN	
   952	400670'	313 06 0 00 400630*	LEN.PR:	CAMLE	S1,CURSOR	;  IF CURSOR < INTEGER VALUE . . 
   953	400671'	254 00 0 00 400631*		JRST	SC.LF		;  LENGTH FAIL
   954	400672'	322 06 0 00 400627*		JUMPE	S1,SC.S		;  IF INT = O, MATCH NULL STR
   955	400673'	210 00 0 00 000006 			MOVN	Z,S1			;[207] OTHERWISW UPDATE ..
   956	400674'	272 00 0 00 400670*			ADDM	Z,CURSOR		;[207] CURSOR BY LEN OF INT VALUE
   957	400675'	254 00 0 00 400233'		JRST	PTRLPL		;  UPDATE STPTR AND RETURN FROM
   958						;	PTRLPL TO SC.S
   959
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 33
SNOPL	MAC	13-Oct-66 22:20		PR$LEN - PRIMITIVE USED BY LEN(E)

   960						SUBTTL	PR$LEN - PRIMITIVE USED BY LEN(E)
   961
   962					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN
   963					;	PR$LEN IS ENCOUNTERED IN A NODE - SIGNIFIES
   964					;	THAT AN EXPRESSION MUST BE EVALUATED FOR LEN()
   965					;	CALLING SEQUENCE:
   966					;	JRST PR$LEN
   967					;	RETURN EITHER GOES TO LENGTH-FAIL, MATCH FAIL OR SUCCESS
   968
   969	400676'	265 06 0 00 400167'	PR$LEN::	JSP	SLINK,PEVALI	;  EVALUATE EXPR, DESCR. ON
   970	400677'	262 01 0 00 000007 		POP	STACK,S2	;  TOP OF STACK . .
   971	400700'	262 01 0 01 000000 		POP	STACK,(STACK)	;[207]	POP STACK
   972	400701'	202 07 0 00 000006 		MOVEM	S2,S1		;  S1 = VALUE OF INTEGER
   973	400702'	231 07 0 00 000005 		IDIVI	S2,5		;  S2 = WORDS, S3  BYTES
   974	400703'	254 00 0 00 400670'		JRST	LEN.PR		;  MERGE WITH PR.LEN FOR UPDATE
   975
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 34
SNOPL	MAC	13-Oct-66 22:20		POS - BUILT-IN USED BY PATTERN BUILDER

   976						SUBTTL	POS - BUILT-IN USED BY PATTERN BUILDER
   977
   978					;	THIS ROUTINE ALLOCATES SPACE FROM SURF AND FORMS
   979					;	PROTOTYPE FOR POS() - ALSO CALLS COMMON ROUTINE
   980					;	USED BY RPOS, TAB, AND RTAB.
   981					;	CALLING SEQUENCE:
   982					;	JSP PLINK,POS
   983					;	ERROR RETURN
   984					;	NORMAL RETURN FROM UPDATE(COMMON CODE)
   985
   986	400704'	201 05 0 00 400723'	POS::	MOVEI	P2,PR$POS	;  P2 = PRIMITIVE FOR EXPR
   987	400705'	201 10 0 00 400715'		MOVEI	S3,PR.POS	;  S3 = PRIMITIVE FOR INTEGER
   988	400706'	265 06 0 00 400240'		JSP	SLINK,POSTAB	;  COMMON ROUTINE
   989	400707'	254 00 0 00 400223'		JRST	UPDATE		;  RETURN FROM POSTAB IF EXPR
   990						;	CONTROL GOES TO UPDATE
   991	400710'	200 00 0 12 000002 		MOVE	Z,PARG(T2)	;  RETURN IF INTEGER
   992	400711'	202 00 0 02 000002 		MOVEM	Z,PSTART(SURF)	;  UPDATE . . .
   993	400712'	200 00 0 12 000003 		MOVE	Z,PARG+1(T2)	;  . . .
   994	400713'	202 00 0 02 000003 		MOVEM	Z,PSTART+1(SURF)	;  PSTART
   995	400714'	254 00 0 00 400223'		JRST	UPDATE		;  UPDATE SURF
   996
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 35
SNOPL	MAC	13-Oct-66 22:20		PR.POS - PRIMITIVE USED BY POS(N)

   997						SUBTTL	PR.POS - PRIMITIVE USED BY POS(N)
   998
   999					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN
  1000					;	PR.POS IS ENCOUNTERED IN A NODE
  1001					;	CALLING SEQUENCE:
  1002					;	JRST PR.POS
  1003					;	RETURN EITHER GOES TO SUCCESS, LENGTH-FAIL, OR MATCH FAIL
  1004
  1005	400715'	200 07 0 05 000003 	PR.POS::	MOVE	S2,PARG+1(P2)	;  RETRIEVE VALUE OF ARGUMENT
  1006					;	MERGE HERE FROM PR$POS
  1007	400716'	274 07 0 00 400516*	RPSM:	SUB	S2,MAXLEN	;  SUBTRACT FROM VALUE . . .
  1008	400717'	270 07 0 00 400674*		ADD	S2,CURSOR	;  MAXLEN - CURSOR
  1009	400720'	322 07 0 00 400672*		JUMPE	S2,SC.S		;[207] IF =, CURSOR POSITION OK
  1010	400721'	327 07 0 00 400622*		JUMPG	S2,SC.MF	;[207] CURSOR BEYOND POINT
  1011	400722'	254 00 0 00 400671*		JRST	SC.LF		;[207] IMPOSSIBLE NOT ENOUGH CHAR.
  1012
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 36
SNOPL	MAC	13-Oct-66 22:20		PR$POS - PRIMITIVE USED BY POS(E)

  1013						SUBTTL	PR$POS - PRIMITIVE USED BY POS(E)
  1014
  1015					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN
  1016					;	PR$POS IS ENCOUNTERED IN A NODE - SIGNIFIES
  1017					;	THAT AN EXPRESSION MUST BE EVALUATED FOR POS()
  1018					;	CALLING SEQUENCE:
  1019					;	JRST PR$POS
  1020					;	RETURN GOES TO LF,MF,OR SUCCESS
  1021
  1022	400723'	265 06 0 00 400167'	PR$POS::	JSP	SLINK,PEVALI	;  EVALUATE
  1023	400724'	262 01 0 00 000007 		POP	STACK,S2	;  SET UP S2 TO MERGE WITH PR.POS
  1024	400725'	262 01 0 01 000000 		POP	STACK,(STACK)	;[207]	POP STACK
  1025	400726'	254 00 0 00 400716'		JRST	RPSM		;  MERGE WITH PR.POS
  1026
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 37
SNOPL	MAC	13-Oct-66 22:20		RPOS - BUILT-IN USED BY PATTERN BUILDER

  1027						SUBTTL	RPOS - BUILT-IN USED BY PATTERN BUILDER
  1028
  1029					;	THIS ROUTINE ALLOCATES SPACE FROM SURF AND FORMS
  1030					;	PROTOTYPE FOR RPOS 
  1031					;	CALLING SEQUENCE:
  1032					;	PUSH DESCRIPTOR
  1033					;	JSP PLINK,RPOS
  1034					;	ERROR RETURN
  1035					;	NORMAL RETURN FROM UPDATE(COMMON CODE)
  1036
  1037	400727'	201 05 0 00 400744'	RPOS::	MOVEI	P2,PR$RPS	;  P2=PRIMITIVE FOR EXPR.
  1038	400730'	201 10 0 00 400740'		MOVEI	S3,PR.RPS	;  S3 = PRIMITIVE FOR INT.
  1039	400731'	265 06 0 00 400240'		JSP	SLINK,POSTAB	;  COMMON CODE
  1040	400732'	254 00 0 00 400223'		JRST	UPDATE		;  RETURN IF EXPR, UPDATE
  1041	400733'	200 00 0 12 000002 		MOVE	Z,PARG(T2)	;  RETURN IF INTEGER . . .
  1042	400734'	202 00 0 02 000002 		MOVEM	Z,PSTART(SURF)	;  SET UP PSTART . . .
  1043	400735'	200 00 0 12 000003 		MOVE	Z,PARG+1(T2)	;  WITH A NEGATIVE . . .
  1044	400736'	452 00 0 02 000003 		SETCAM	Z,PSTART+1(SURF)	;  VALUE
  1045	400737'	254 00 0 00 400223'		JRST	UPDATE		;  UPDATE AND RETURN
  1046
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 38
SNOPL	MAC	13-Oct-66 22:20		PR.RPS - PRIMITIVE USED BY RPOS(N)

  1047						SUBTTL	PR.RPS - PRIMITIVE USED BY RPOS(N)
  1048
  1049					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN
  1050					;	PR.RPS IS ENCOUNTERED IN A NODE
  1051					;	CALLING SEQUENCE:
  1052					;	JRST PR.RPS
  1053					;	RETURN EITHER GOES TO MF, LF, OR SUCCESS
  1054
  1055	400740'	200 10 0 05 000003 	PR.RPS::	MOVE	S3,PARG+1(P2)	;  RETRIEVE VALUE OF ARG
  1056					;	MERGE HERE FROM PR$RPS
  1057	400741'	550 07 0 00 000000#	RPS.PR:	HRRZ	S2,SUBJ+1	;  LENGTH OF SUBJECT STRING
  1058	400742'	274 07 0 00 000010 		SUB	S2,S3		;  SET UP TO ENTER POS
  1059	400743'	254 00 0 00 400716'		JRST	RPSM		;  MERGE WITH PR.POS
  1060						;	SINCE POS(L-N)=RPOS(N)
  1061
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 39
SNOPL	MAC	13-Oct-66 22:20		PR$RPS - PRIMITIVE USED BY RPOS(E)

  1062						SUBTTL	PR$RPS - PRIMITIVE USED BY RPOS(E)
  1063
  1064					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN
  1065					;	PR$RPS IS ENCOUNTERED IN A NODE - SIGNIFIES
  1066					;	THAT AN EXPRESSION MUST BE EVALUATED FOR RPOS()
  1067					;	CALLING SEQUENCE:
  1068					;	JRST PR$RPS
  1069					;	RETURN GOES TO LF, MF, OR SUCCESS
  1070
  1071	400744'	265 06 0 00 400167'	PR$RPS::	JSP	SLINK,PEVALI	;  EVALUATE
  1072	400745'	262 01 0 00 000010 		POP	STACK,S3	;  S3=INTEGER VALUE
  1073	400746'	262 01 0 01 000000 		POP	STACK,(STACK)	;[207]	POP STACK
  1074	400747'	254 00 0 00 400741'		JRST	RPS.PR		;  MERGE WITH PR.RPS
  1075
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 40
SNOPL	MAC	13-Oct-66 22:20		RTAB - BUILT-IN USED BY PATTERN BUILDER

  1076						SUBTTL	RTAB - BUILT-IN USED BY PATTERN BUILDER
  1077
  1078					;	THIS ROUTINE ALLOCATES SPACE FROM SURF AND FORMS
  1079					;	PROTOTYPE FOR RTAB()
  1080					;	CALLING SEQUENCE:
  1081					;	PUSH DESCRIPTOR
  1082					;	JSP PLINK,RTAB
  1083					;	ERROR RETURN
  1084					;	NORMAL RETURN FROM UPDATE(COMMON CODE)
  1085
  1086
  1087	400750'	201 05 0 00 400761'	RTAB::	MOVEI	P2,PR$RTB	;  SET UP P2 WITH PRIM FOR EXPR
  1088	400751'	201 10 0 00 400755'		MOVEI	S3,PR.RTB	;  PRIMITIVE FOR INTEGER
  1089	400752'	265 06 0 00 400240'		JSP	SLINK,POSTAB	;  COMMON CODE
  1090	400753'	254 00 0 00 400223'		JRST	UPDATE		;  RETURN IF EXPR
  1091	400754'	254 00 0 00 400223'		JRST	UPDATE		;  RETURN IF INTEGER, UPDATE
  1092
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 41
SNOPL	MAC	13-Oct-66 22:20		PR.RTB - PRIMITIVE USED BY RTAB(N)

  1093						SUBTTL	PR.RTB - PRIMITIVE USED BY RTAB(N)
  1094
  1095					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN
  1096					;	PR.RTB IS ENCOUNTERED IN A NODE.
  1097					;	CALLING SEQUENCE:
  1098					;	JRST PR.RTB
  1099					;	RETURN GOES TO MF, LF, OR SUCCESS
  1100
  1101	400755'	200 07 0 05 000003 	PR.RTB::	MOVE	S2,PARG+1(P2)	;  RETRIEVE ARGUMENT FOR RTAB
  1102	
  1103					;	MERGE HERE FROM PR$RTB
  1104	400756'	550 10 0 00 000000#	RTB.PR:	HRRZ	S3,SUBJ+1	;  RETRIEVE LENGTH OF SUBJ
  1105	400757'	274 10 0 00 000007 		SUB	S3,S2		;  S3 = L-N SINCE TAB(L-N)= 
  1106						;	RTAB(N)
  1107	400760'	254 00 0 00 400773'		JRST	TAB.PR		;  MERGE WITH PR.TAB
  1108
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 42
SNOPL	MAC	13-Oct-66 22:20		PR$RTB - PRIMITIVE USED BY RTAB(E)

  1109						SUBTTL	PR$RTB - PRIMITIVE USED BY RTAB(E)
  1110
  1111					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN
  1112					;	PR$RTB IS ENCOUNTERED IN A NODE - SIGNIFIES
  1113					;	THAT AN EXPRESSION MUST BE EVALUATED FOR RTAB()
  1114					;	CALLING SEQUENCE:
  1115					;	JRST PR$RTB
  1116					;	RETURN GOES TO MF, LF, OR SUCCESS
  1117
  1118	400761'	265 06 0 00 400167'	PR$RTB::	JSP	SLINK,PEVALI	;  EVALUATE
  1119	400762'	262 01 0 00 000007 		POP	STACK,S2	;  ARGUMENT FOR RTAB IN S2
  1120	400763'	262 01 0 01 000000 		POP	STACK,(STACK)	;[207]	POP STACK
  1121	400764'	254 00 0 00 400756'		JRST	RTB.PR		;  MERGE WITH PR.RTB
  1122
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 43
SNOPL	MAC	13-Oct-66 22:20		TAB - BUILT-IN USED BY PATTERN BUILDER

  1123						SUBTTL	TAB - BUILT-IN USED BY PATTERN BUILDER
  1124
  1125					;	THIS ROUTINE ALLOCATES SPACE FROM SURF AND FORMS
  1126					;	PROTOTYPE FOR TAB()
  1127					;	CALLING SEQUENCE:
  1128					;	PUSH DESCRIPTOR
  1129					;	JSP PLINK,TAB
  1130					;	ERROR RETURN
  1131					;	NORMAL RETURN FROM UPDATE(COMMON CODE)
  1132
  1133	400765'	201 05 0 00 401011'	TAB::	MOVEI	P2,PR$TAB	;  PRIMITIVE EXPR. ENTRY
  1134	400766'	201 10 0 00 400772'		MOVEI	S3,PR.TAB	;  PRIMITIVE FOR INTEGER
  1135	400767'	265 06 0 00 400240'		JSP	SLINK,POSTAB	;  COMMON CODE
  1136	400770'	254 00 0 00 400223'		JRST	UPDATE		;  RETURN FOR EXPR
  1137	400771'	254 00 0 00 400223'		JRST	UPDATE		;  RETURN FOR INTEGER UPDATE
  1138
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 44
SNOPL	MAC	13-Oct-66 22:20		PR.TAB - PRIMITIVE USED BY TAB(N)

  1139						SUBTTL	PR.TAB - PRIMITIVE USED BY TAB(N)
  1140
  1141					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN
  1142					;	PR.TAB IS ENCOUNTERED IN A NODE.
  1143					;	CALLING SEQUENCE:
  1144					;	JRST PR.TAB
  1145					;	RETURN GOES TO MF, LF, OR SUCCESS
  1146
  1147	400772'	200 10 0 05 000003 	PR.TAB::	MOVE	S3,PARG+1(P2)	;  RETRIEVE VALUE OF ARGUMENT
  1148	
  1149					;	MERGE HERE FROM PR$TAB
  1150	400773'	200 07 0 00 400716*	TAB.PR:	MOVE	S2,MAXLEN	;  S2 = MAXLEN
  1151	400774'	274 07 0 00 000010 		SUB	S2,S3		;  S2 = MAXLEN - VALUE
  1152	400775'	321 07 0 00 400722*		JUMPL	S2,SC.LF	;  IF ARG > MAXLEN, LEN-FAIL
  1153	400776'	313 07 0 00 400717*		CAMLE	S2,CURSOR	;  IF S2 > CURSOR, THEN . . .
  1154	400777'	254 00 0 00 400721*		JRST	SC.MF		;  MATCH FAIL
  1155	401000'	200 10 0 00 400776*		MOVE	S3,CURSOR	;  RETRIEVE OLD CURSOR VALUE
  1156	401001'	274 10 0 00 000007 		SUB	S3,S2		;  S3 = CURSOR-(MAXLEN-ARG) =
  1157						;	NUMBER OF BYTES TO INC. STPTR
  1158	401002'	202 07 0 00 401000*		MOVEM	S2,CURSOR	;  UPDATE NEW CURSOR
  1159	401003'	336 00 0 00 000000*		SKIPN	FUTILE##		;  TEST FUTILITY FLAG TO SEE
  1160						;	IF	PUSH HSTACK WITH ALT
  1161	401004'	254 00 0 00 400235'		JRST	PTRLP		;  NO, UPDATE STPTR
  1162	401005'	505 07 0 00 000000*		HRLI	S2,D.LF##	;  YES, USE NEG. 
  1163	401006'	261 03 0 00 000007 		PUSH	HSR,S2		;  PUSH [D.LF CURSOR]
  1164	401007'	261 03 0 00 400626*		PUSH	HSR,STPTR	;  PUSH [STPTR]
  1165	401010'	254 00 0 00 400235'		JRST	PTRLP		;  UPDATE STPTR
  1166
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 45
SNOPL	MAC	13-Oct-66 22:20		PR$TAB - PRIMITIVE USED BY TAB(E)

  1167						SUBTTL	PR$TAB - PRIMITIVE USED BY TAB(E)
  1168
  1169					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHEN
  1170					;	PR$TAB IS ENCOUNTERED INA NODE - SIGNIFIES
  1171					;	THAT AN EXPRESSION MUST BE EVALUATED FOR TAB()
  1172					;	CALLING SEQUENCE:
  1173					;	JRST PR$TAB
  1174					;	RETURN GOES TO MF, LF, OR SUCCESS
  1175
  1176	401011'	265 06 0 00 400167'	PR$TAB::JSP	SLINK,PEVALI	;  EVALUATE INTEGER
  1177	401012'	262 01 0 00 000010 		POP	STACK,S3	;  ARGUMENT IN S3
  1178	401013'	262 01 0 01 000000 		POP	STACK,(STACK)	;[207]	POP STACK
  1179	401014'	254 00 0 00 400773'		JRST	TAB.PR		;  MERGE WITH PR.TAB
  1180
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 46
SNOPL	MAC	13-Oct-66 22:20		PR.FL - PRIMITIVE USED FOR FAIL

  1181						SUBTTL	PR.FL - PRIMITIVE USED FOR FAIL
  1182
  1183					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER
  1184					;	WHEN PR.FL IS IN NODE - BUILT IN BY BUILDER
  1185					;	CALLING SEQUENCE:
  1186					;	JRST PR.FL
  1187					;	RETURN GOES TO MF OR LF
  1188
  1189	401015'	331 00 0 00 401002*	PR.FL::	SKIPL	,CURSOR		;  CURSOR LESS THAN 0?
  1190	401016'	254 00 0 00 400777*		JRST	SC.MF		;  NO, MATCH FAIL
  1191	401017'	254 00 0 00 400775*		JRST	SC.LF		;  YES, LENGTH FAIL
  1192
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 47
SNOPL	MAC	13-Oct-66 22:20		PR.GBL - PRIMITIVE USED BY BAL

  1193						SUBTTL	PR.GBL - PRIMITIVE USED BY BAL
  1194
  1195					;	THIS ROUTINE IS CALLED ONLY WHEN BAL IS REFERENCED.
  1196					;	IT IS CALLED BY THE PATTERN MATCHER.
  1197					;	CALLING SEQUENCE: 
  1198					;	JRST PR.GBL
  1199					;	RETURN GOES TO LF, MF, OR SUCCESS
  1200
  1201	401020'	337 00 0 00 401015*	PR.GBL::	SKIPG	CURSOR		;  CHECK CURSOR VALUE
  1202	401021'	254 00 0 00 401017*		JRST	SC.LF		;  CURSOR <= 0, LF
  1203	401022'	200 07 0 00 000000*		MOVE	S2,SYSCT##	;  S2 -> SYSTEM CHAR. TABLE
  1204	401023'	200 10 0 00 401304'		MOVE	S3,[Y.LP!Y.RP]	;  MASK FOR "()"
  1205	401024'	265 11 0 00 400621*		JSP	TLINK,CHECK	;  CHECK FIRST CHARACTER
  1206	401025'	254 00 0 00 401052'		JRST	GBAL1		;  ERROR, ONLY ONE LETTER
  1207	401026'	302 16 0 00 000050 		CAIE	Q2,"("		;  SEE IF LEFT-PAREN
  1208	401027'	254 00 0 00 401016*		JRST	SC.MF		;  NO, THEREFORE UNBALANCED
  1209	401030'	261 01 0 00 401020*		PUSH	STACK,CURSOR	;  SAVE CURSOR . . .
  1210	401031'	261 01 0 00 401007*		PUSH	STACK,STPTR	;  AND STPTR
  1211	401032'	370 00 0 00 401030*		SOS	CURSOR		;  BUMP OVER . . .
  1212	401033'	133 00 0 00 401031*		IBP	STPTR		;  THE LEFT-PAREN
  1213	401034'	201 06 0 00 000001 		MOVEI	S1,1		;  S1 HOLDS PAREN COUNT
  1214	
  1215	401035'	265 11 0 00 400510*	GBAL2:	JSP	TLINK,STR.	;  LOOK FOR ANOTHER "()"
  1216	401036'	254 00 0 00 401047'		JRST	GBAL3		;  NONE
  1217	401037'	370 00 0 00 401032*		SOS	CURSOR		;  UPDATE CURSOR AND . . .
  1218	401040'	133 00 0 00 401033*		IBP	STPTR		;  STPTR TO STREAM FOR NEXT PAR
  1219	401041'	306 16 0 00 000050 		CAIN	Q2,"("		;  IS IT "("?
  1220	401042'	344 06 0 00 401035'		AOJA	S1,GBAL2	;  YES, ADD 1 TO S1.
  1221	401043'	367 06 0 00 401035'		SOJG	S1,GBAL2	;  NO, IT IS ")" , SUB 1.
  1222	401044'	274 01 0 00 401301'		SUB	STACK,[XWD 2,2]	;	POP STACK OF SAVED VALUES
  1223	401045'	402 00 0 00 401003*		CLEARM	FUTILE		;  CLEAR THE FUTILE FLAG
  1224	401046'	254 00 0 00 400720*		JRST	SC.S		;  SUCCESSFUL RETURN SINCE
  1225						;	S1 = 0
  1226					;	ENTER HERE IF UNBALANCED
  1227	401047'	262 01 0 00 401040*	GBAL3:	POP	STACK,STPTR	;  RESTORE . . .
  1228	401050'	262 01 0 00 401037*		POP	STACK,CURSOR	;  THINGS
  1229	401051'	254 00 0 00 401027*		JRST	SC.MF		;  MATCH FAIL
  1230					;	ENTER HERE FOR SINGLE CHARACTER	
  1231	401052'	370 00 0 00 401050*	GBAL1:	SOS	CURSOR		;  JUMP OVER CHARACTER
  1232	401053'	133 00 0 00 401047*		IBP	STPTR		;  . . .
  1233	401054'	254 00 0 00 401046*		JRST	SC.S		;  SUCCESSFUL RETURN
  1234
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 48
SNOPL	MAC	13-Oct-66 22:20		PR.LN1 - PRIMITIVE FOR LEN(1)

  1235						SUBTTL	PR.LN1 - PRIMITIVE FOR LEN(1)
  1236
  1237					;	THIS ROUTINE IS USED BY VARIOUS OTHER PRIMITIVES
  1238					;	AND IS CALLED BY PATTERN MATCHER
  1239					;	CALLING SEQUENCE:
  1240					;	JRST PR.LN1
  1241					;	RETURN GOES TO LF OR SUCCESS
  1242
  1243	401055'	337 00 0 00 401052*	PR.LN1::	SKIPG	CURSOR		;  IS CURSOR > 0?
  1244	401056'	254 00 0 00 401021*		JRST	SC.LF		;  NO, LENGTH FAIL.
  1245	401057'	370 00 0 00 401055*		SOS	CURSOR		;  YES, UPDATE CURSOR BY 1
  1246	401060'	133 00 0 00 401053*		IBP	STPTR		;  UPDATE STPTR BY 1 BYTE
  1247	401061'	254 00 0 00 401054*		JRST	SC.S		;  SUCCESS
  1248
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 49
SNOPL	MAC	13-Oct-66 22:20		PR.LFL - PRIMITIVE TO LENGTH FAIL

  1249						SUBTTL	PR.LFL - PRIMITIVE TO LENGTH FAIL
  1250
  1251					;	THIS ROUTINE IS CALLED BY PATTERN MATCHER FOR
  1252					;	ANY TIME LENGTH FAIL IS DESIRED
  1253					;	CALLING SEQUENCE:
  1254					;	JRST PR.LFL
  1255					;	RETURN GOES TO LENGTH FAIL
  1256
  1257	401062'	201 07 0 00 000001 	PR.LFL::	MOVEI	S2,1		;  TURN . . .
  1258	401063'	436 07 0 00 401045*		IORM	S2,FUTILE	;  FUTILITY FLAG ON
  1259	401064'	254 00 0 00 401056*		JRST	SC.LF		;  LENGTH FAIL
  1260
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 50
SNOPL	MAC	13-Oct-66 22:20		PR.STR - PRIMITIVE FOR 'STRING' SCAN

  1261						SUBTTL	PR.STR - PRIMITIVE FOR 'STRING' SCAN
  1262
  1263					;	THIS ROUTINE IS CALLED BY THE PATTERN MATCHER WHENEVER
  1264					;	PR.STR IS ENCOUNTERED IN THE NODE
  1265					;	CALLING SEQUENCE:
  1266					;	JRST PR.STR
  1267					;	RETURN GOES TO LF, MF, OR SUCCESS
  1268
  1269	401065'	550 13 0 05 000003 	PR.STR::	HRRZ	T3,PARG+1(P2)	;  RETRIEVE LEN OF STRING FOR
  1270						;	LOOPING AND TESTING
  1271	401066'	313 13 0 00 401057*		CAMLE	T3,CURSOR	;  IF SIZE(STRING)>CURSOR . . .
  1272	401067'	254 00 0 00 401064*		JRST	SC.LF		;  LENGTH FAIL
  1273	401070'	200 12 0 05 000002 		MOVE	T2,PARG(P2)	;  T2 USED IN CVTPTR TO FORM
  1274						;	POINTER TO STRING
  1275	401071'	200 17 0 00 000000*		MOVE	Q3,SUBJ		;  Q3 USED IN SUBJ STRING
  1276	401072'	200 06 0 00 401066*		MOVE	S1,CURSOR	;  SAVE OLD CURSOR VALUE
  1277	401073'	200 07 0 00 401060*		MOVE	S2,STPTR	;  SAVE OLD STPTR VALUE
  1278	401074'	200 00 0 05 000007 		MOVE	Z,PNDSZ+PARG+1(P2)	;  RETRIEVE POINTER TO STRING
  1279						;	FROM NODE
  1280	401075'	135 11 0 00 401073*		LDB	T1,STPTR	;  GET CHARACTER OF SUBJ, STRING
  1281	401076'	134 10 0 00 000000 	STRLP:	ILDB	S3,Z		;  GET CHARACTER OF STRING
  1282	401077'	312 10 0 00 000011 		CAME	S3,T1		;  COMPARE =?
  1283	401100'	254 00 0 00 401105'		JRST	RESPTR		;  NO, RESTORE OLD CURS AND PTR
  1284	401101'	370 00 0 00 401072*		SOS	CURSOR		;  YES, UPDATE CURSOR . . .
  1285	401102'	134 11 0 00 401075*		ILDB	T1,STPTR	;  AND STPTR AND GET CHARACTER
  1286	401103'	366 13 0 00 401076'		SOJN	T3,STRLP	;  JUMP IF T3 NOT = 0.
  1287	401104'	254 00 0 00 401061*		JRST	SC.S		;  =0, LOOP COMPLETE, RETURN.
  1288					;	ENTER HERE TO RESTORE THINGS
  1289	401105'	202 07 0 00 401102*	RESPTR:	MOVEM	S2,STPTR	;  STPTR RESTORED
  1290	401106'	202 06 0 00 401101*		MOVEM	S1,CURSOR	;  CURSOR RESTORED
  1291	401107'	254 00 0 00 401051*		JRST	SC.MF		;  MATCH FAIL
  1292
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 51
SNOPL	MAC	13-Oct-66 22:20		PR.CN1 AND PR.IN1 - IMMEDIATE AND CONDITIONAL NAMING ONE

  1293						SUBTTL	PR.CN1 AND PR.IN1 - IMMEDIATE AND CONDITIONAL NAMING ONE
  1294
  1295					;	THESE ROUTINES ARE ONE AND THE SAME - THEY PLACE
  1296					;	THE CURSOR VALUE ON THE STACK AND PLACE ALT 
  1297					;	ON HISTORY STACK
  1298					;	THEY ARE CALLED DURING NAMING BY PATTERN MATCHER.
  1299					;	CALLING SEQUENCE:
  1300					;	JRST PR.IN1	OR JRST PR.CN1
  1301					;	RETURN GOES TO SUCCESS
  1302
  1303	401110'	200 00 0 00 400773*	PR.XN1:: MOVE	Z,MAXLEN		;PLACE MAXLEN-CURSOR
  1304	401111'	274 00 0 00 401106*		SUB	Z,CURSOR		;	(SUBSTR LEFT OFFSET)
  1305	401112'	261 01 0 00 401276'		PUSH	STACK,[XWD IDT,0]	;	AS AN INTEGER
  1306	401113'	261 01 0 00 000000 		PUSH	STACK,Z			;	ON THE SYSTEM STACK
  1307
  1308	401114'	261 03 0 00 401305'		PUSH	HSR,[XWD D.XB1##,0]	;AND PUT THE FAILURE CLEANUP
  1309	401115'	261 03 0 00 000000 		PUSH	HSR,Z			;	NODE ON H.S.
  1310										;(DON'T NEED CURSOR OR STPTR)
  1311	401116'	254 00 0 00 401104*		JRST	SC.S			;AND RETURN SUCCESS
  1312
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 52
SNOPL	MAC	13-Oct-66 22:20		PRCNB1 AND PRINB1 - IMMEDIATE AND CONDITIONAL NAMING WITH BACK-UP ONE

  1313						SUBTTL	PRCNB1 AND PRINB1 - IMMEDIATE AND CONDITIONAL NAMING WITH BACK-UP ONE
  1314
  1315					;	THESE ROUTINES ARE ONE IN THE SAME - THEY BOTH JUST
  1316					;	POP THE STACK AND RETURN LNTH FAILFULLY
  1317					;	CALLING SEQUENCE:
  1318					;	JRST PR.CNB1 OR JRST PR.INB1
  1319					;	RETURN GOES TO LNTH FAIL
  1320
  1321	401117'	274 01 0 00 401301'	PR.XB1:: SUB 	STACK,[XWD 2,2]		;POP SYSTEM STACK
  1322	401120'	254 00 0 00 401067*		JRST	SC.LF			;AND GO GET THE REAL ALT
  1323
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 53
SNOPL	MAC	13-Oct-66 22:20		PR.CN2 - CONDITIONAL NAMING TWO

  1324						SUBTTL	PR.CN2 - CONDITIONAL NAMING TWO
  1325
  1326					;	THIS ROUTINE PUSHES THE NAMESTACK WITH A VARIABLE AND THE
  1327					;	OLD AND NEW CURSOR VALUES - CALLED BY PATTERN MATCHER
  1328					;	CALLING SEQUENCE:
  1329					;	JRST PR.CN2
  1330					;	RETURN GOES TO SUCCESS
  1331
  1332	401121'	200 10 0 00 000000*	PR.CN2::MOVE	S3,NSTACK##	;  S3 -> NAMESTACK
  1333	401122'	261 10 0 05 000002 		PUSH	S3,PARG(P2)	;  PUT VAR ON NSTACK . . .
  1334	401123'	261 10 0 05 000003 		PUSH	S3,PARG+1(P2)	;  . . .
  1335	401124'	261 10 0 00 401276'		PUSH	S3,[XWD IDT,0]		;DESCR HEAD FOR SUBSTR INDIC
  1336	401125'	200 00 0 01 000000 		MOVE	Z,0(STACK)		;;NOW BRACKET THE MTCHED SUBSTR
  1337	401126'	554 11 0 00 000000#		HLRZ	T1,SUBJ+1		;GET SUBJ'S BASIC OFFSET
  1338	401127'	200 12 0 00 401110*		MOVE	T2,MAXLEN		;CALC OFFSET OF CUR POSIT
  1339	401130'	274 12 0 00 401111*		SUB	T2,CURSOR		;	FROM STR HEAD
  1340	401131'	274 12 0 00 000000 		SUB	T2,Z		;CUR OFFSET LESS BEGIN OFFSET=LNTH
  1341	401132'	270 00 0 00 000011 		ADD	Z,T1		;MAKE UP REAL OFFSET IN SBLOK
  1342	401133'	504 12 0 00 000000 		HRL	T2,Z		;COMPOSE OFFSET//LNTH
  1343	401134'	261 10 0 00 000012 		PUSH	S3,T2			;AND STORE ON NAME STACK
  1344	401135'	202 10 0 00 401121*		MOVEM	S3,NSTACK		;UPDATE NAME STK PERM PTR
  1345	401136'	274 01 0 00 401301'		SUB	STACK,[XWD 2,2]	;POP THE CURSOR FM SYSSTK
  1346
  1347	401137'	261 03 0 00 401306'		PUSH	HSR,[XWD D.CB2##,0]	;PUT THE FAIL FIXUP RTN
  1348	401140'	261 03 0 00 000000 		PUSH	HSR,Z			;	INDIC ONTO H.S.
  1349							;FIXUP NEEDS ONLY TO BE CALLED--
  1350							; CURSOR & STPTR FIELDS WILL NOT BE USED
  1351	401141'	254 00 0 00 401116*		JRST	SC.S		;  RETURN SUCCESSFULLY
  1352
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 54
SNOPL	MAC	13-Oct-66 22:20		PRCNB2 - CONDITIONAL NAMING WITH BACK UP TWO

  1353						SUBTTL	PRCNB2 - CONDITIONAL NAMING WITH BACK UP TWO
  1354
  1355					;	THIS ROUTINE PUSHES TWO FULL WORDS OF ZEROS ON
  1356					;	THE STACK AND BUMPS THE NSTACK DOWN 4 WORDS
  1357					;	CALLING SEQUENCE:
  1358					;	JRST PRCNB2
  1359					;	RETURN GOES TO LNTH FAIL
  1360
  1361	401142'	200 10 0 00 401135*	PR.CB2::MOVE	S3,NSTACK	;  S3 -> NSTACK
  1362	401143'	554 00 0 10 000000 		HLRZ	Z,0(S3)			;RETRIEVE STR DESC BOTTOM
  1363	401144'	554 17 0 00 000000#		HLRZ	Q3,SUBJ+1		;GET SUBJ'S BASIC OFFSET
  1364	401145'	274 00 0 00 000017 		SUB	Z,Q3			;	AND TAKE IT OUT,LEAVING
  1365										;	THE LOCAL OFFSET
  1366	401146'	261 01 0 00 401276'		PUSH	STACK,[XWD IDT,0]	;AND PUT IT BACK ONTO SYSSTK
  1367	401147'	261 01 0 00 000000 		PUSH	STACK,Z			;	INCASE WE COME THRU PR.CN2 AGAIN
  1368	401150'	274 10 0 00 401307'		SUB	S3,[XWD 4,4]	;	POP NSTACK
  1369	401151'	202 10 0 00 401142*		MOVEM	S3,NSTACK	;  NSTACK VALUE CHANGED
  1370	401152'	254 00 0 00 401120*		JRST	SC.LF		;GO GET REAL ALT
  1371
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 55
SNOPL	MAC	13-Oct-66 22:20		PR.IN2 - IMMEDIATE NAMING TWO

  1372						SUBTTL	PR.IN2 - IMMEDIATE NAMING TWO
  1373
  1374					;	THIS ROUTINE ASSIGNS A VALUE IMMEDIATELY
  1375					;	CALLING SEQUENCE:
  1376					;	JRST PR.IN2
  1377					;	RETURN GOES TO SUCCESS
  1378
  1379	401153'				PR.IN2::
  1380	401153'	262 01 0 00 000007 		POP	STACK,S2	;  POP MAXLEN-CURSOR INTO S2
  1381	401154'	262 01 0 01 000000 		POP	STACK,(STACK)	;[207]POP OFF THE DESCR HDR
  1382	401155'	201 12 0 05 000002 		MOVEI	T2,PARG(P2)		;EVALUATE ARG IF NECESSARY
  1383	401156'	265 11 0 00 400107'		JSP	TLINK,PEVAL		;	AND PUT RSLT ON STK
  1384						JRST	[ADD STACK,[2,,2]
  1385	401157'	254 00 0 00 401310'			 JRST SC.MF]	; PUSH STACK AND FAIL
  1386	
  1387					;	GO HERE TO TEST FOR VAR OR TVAR
  1388	401160'	460 00 0 01 777777 	IN23:	SETCM	Z,-1(STACK)	;  RETRIEVE DATATYPE
  1389	401161'	603 00 0 00 024000 		TLNE	Z,NONDC+FLDC	;  TEST NONDC BIT
  1390	401162'	001 16 0 00 000010 		ERROR	14,8		;  NOT A VAR OR TVAR
  1391	401163'	554 12 0 00 000000#		HLRZ	T2,SUBJ+1	;  GET OFFSET FROM SUBJ STRING
  1392	401164'	202 07 0 00 000011 		MOVEM	S2,T1		;  SAVE MAXLEN-CURSOR
  1393	401165'	270 07 0 00 000012 		ADD	S2,T2		;  ADD MAXLEN-CURS TO ORIG OFFSET
  1394	401166'	200 10 0 00 401127*		MOVE	S3,MAXLEN		; CURRENT STR OFFSET
  1395	401167'	274 10 0 00 401130*		SUB	S3,CURSOR		; (MAX-CURS)	LESS
  1396	401170'	274 10 0 00 000011 		SUB	S3,T1			; LEFT-SIDE OFFS GIVES LENGTH
  1397	401171'	506 07 0 00 000010 		HRLM	S2,S3		;  OFFSET AND LENGTH OF STRING
  1398	401172'	261 01 0 00 401071*		PUSH	STACK,SUBJ	;  FIRST DESC. WORD
  1399	401173'	261 01 0 00 000010 		PUSH	STACK,S3	;  SECOND DESC. WORD FOR ASGNVL
  1400	401174'	265 15 0 00 401227'		JSP	QLINK,FIXNUL	; MAKE 0-LENGTH STRINGS NULL
  1401
  1402	401175'	505 11 0 00 000000*		HRLI	T1,D.IB2##	;SET UP FAILURE FIXER ON HIST STK
  1403	401176'	261 03 0 00 000011 		PUSH	HSR,T1		;IF FAILURE COMES BACK THRU HERE,
  1404	401177'	261 03 0 00 000000 		PUSH	HSR,Z	;STPTR UNUSED;	WE HAVE TO RESTORE THE CURSOR
  1405							;TO THE SYSTEM STACK IN CASE FAILURE BACKS UP
  1406							;A LITTLE BUT NOT AS FAR AS PR.XB1.
  1407							;NOTICE THIS IS NOT THE CURSOR THAT WE'RE PUTTING
  1408							;INTO THE CURSOR'S SLOT, BUT RATHER MAXLEN-CURSOR
  1409							;I.E., THE LEFT OFFSET OF THE MATCHED SUBSTRING.
  1410							;THAT'S PRECISELY THE QUANTITY THAT HAS TO GET
  1411							;PUT BACK ON THE SYSTEM STACK IN CASE OF FAILURE.
  1412							;NEVER MIND THE STPTR SLOT ON H.S.; IT'S NOT USED HERE.
  1413							;SEE ALSO PR.IB2
  1414
  1415	401200'	265 11 0 00 000000*		JSP	TLINK,ASGNVL##	;  GO ASSIGN VALUE 
  1416					IFE FTPAV,<
  1417						ERROR	14,8		;COULDN'T ASSIGN IT.
  1418					>
  1419					IFN FTPAV,<
  1420	401201'	254 00 0 00 401107*		JRST	SC.MF		;ASSIGNMENT FAILED -- MATCH FAILS
  1421					>
  1422	401202'	274 01 0 00 401301'		SUB	STACK,[XWD 2,2]	;	POP STACK BEFORE RETURN
  1423	401203'	254 00 0 00 401141*		JRST	SC.S		;  RETURN SUCCESSFULLY TO PM
  1424	
  1425
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 56
SNOPL	MAC	13-Oct-66 22:20		PRINB2 - IMMEDIATE NAMING WITH BACKUP TWO

  1426						SUBTTL	PRINB2 - IMMEDIATE NAMING WITH BACKUP TWO
  1427
  1428					;		ROUTINE FETCHES MATCHED SUBSTRING OFFSET FROM H.S.
  1429					;		WHERE IT WAS SAVED BY PR.IN2 AND WAS TAKEN OFF H.S.
  1430					;		AND PUT INTO "CURSOR" BY SCAN.	THIS OFFSET IS THEN
  1431					;		PUSHED BACK ONTO SYSTEM STACK WHERE PR.IN2
  1432					;		EXPECTS TO FIND IT(JUST IN CASE BACKUP FINDS A 
  1433					;		SUCCESS AND RUNS FORWARD INTO PR.IN2 AGAIN)
  1434
  1435					;	CALLING SEQUENCE:
  1436					;	JRST PR.IB2
  1437					;	RETURN GOES TO LNTH FAIL
  1438
  1439	401204'	261 01 0 00 401276'	PR.IB2:: PUSH	STACK,[XWD IDT,0]	;PUSH THE LEFT-OFFSET
  1440	401205'	261 01 0 00 401167*		PUSH	STACK,CURSOR		;BACK ONTO THE SYS STK
  1441	401206'	254 00 0 00 401152*		JRST	SC.LF			;NOW GO GET THE REAL ALT
  1442
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 57
SNOPL	MAC	13-Oct-66 22:20		NAMELIST PROCESSOR - PNAMEL

  1443						SUBTTL	NAMELIST PROCESSOR - PNAMEL
  1444
  1445					;	THIS IS A SECONDARY ROUTINE CALLED BY THE PATTERN MATCHER
  1446					;	AND IS USED FOR PROCESSING THE NAME STACK
  1447					;	UPON ENTRY, S2 -> BASE OF NAME STACK AND S3 -> END OF NAME
  1448					;	STACK.	NAME STACK IS PROCESSED ON A FIFO BASIS.
  1449					;	CALLING SEQUENCE:
  1450					;	JSP	SLINK,PNAMEL
  1451					;	NORMAL RETURN
  1452
  1453	401207'	301 07 0 10 000000 	PNAMEL::	CAIL	S2,0(S3)	;S2 .LT. S3?
  1454	401210'	254 00 0 06 000000 		JRST	0(SLINK)		;	NO - DONE - EXIT
  1455	401211'	201 12 0 07 000001 		MOVEI	T2,1(S2)		;MAKE SURE ENTRY
  1456	401212'	265 11 0 00 400107'		JSP	TLINK,PEVAL		;	IS EVALUATED
  1457	401213'	254 00 0 00 401225'		JRST	PNAME1		;	FAILED- SKIP ASSGT
  1458	401214'	460 00 0 01 777777 		SETCM	Z,-1(STACK)		;CHECK RSLT IS VAR OR TVAR
  1459	401215'	603 00 0 00 024000 		TLNE	Z,NONDC+FLDC		;	SKIP IF SO
  1460	401216'	001 16 0 00 000010 		ERROR	14,8			;	NOT.	CAN'T ASSIGN
  1461	401217'	261 01 0 00 401172*		PUSH	STACK,SUBJ		;VALUE TO ASSIGN- STRING
  1462	401220'	261 01 0 07 000004 		PUSH	STACK,4(S2)		;	AND THE SUBSTR BRACKETER
  1463	401221'	265 15 0 00 401227'		JSP	QLINK,FIXNUL	; MAKE 0-LENGTH STRINGS NULL
  1464	401222'	265 11 0 00 401200*		JSP	TLINK,ASGNVL		; ASSIGN IT
  1465					IFE FTPAV,<
  1466						ERROR	14,8			;	COULDN'T
  1467					>
  1468					IFN FTPAV,<
  1469	401223'	334 00 0 00 000000 		SKIPA			;ASSIGNMENT FAILED -- SO WHAT
  1470					>;END OF IFN FTPAV
  1471	401224'	274 01 0 00 401301'		SUB	STACK,[XWD 2,2]		;POP VALUE OFF STACK
  1472
  1473	401225'	271 07 0 00 000004 	PNAME1:	ADDI	S2,4			;GO TO NEXT N.S. ENTRY
  1474	401226'	254 00 0 00 401207'		JRST	PNAMEL			;	THEN LEAVE IF ALL DONE
  1475	
  1476						 ; TERTIARY ROUTINE TO CONVERT 0-LENGTH STRINGS TO NULL
  1477
  1478	401227'	550 16 0 01 000000 	FIXNUL:	HRRZ	Q2,0(STACK)	; GET LENGTH
  1479	401230'	326 16 0 15 000000 		JUMPN	Q2,0(QLINK)	; INSTANT RETURN IF NOT NULL
  1480
  1481	401231'	274 01 0 00 401301'		SUB	STACK,[2,,2]	; POP STACK
  1482	401232'	261 01 0 00 400571*		PUSH	STACK,NULLST	; PUSH ON ...
  1483	401233'	261 01 0 00 000000#		PUSH	STACK,NULLST+1	; NULL STRING
  1484	401234'	254 00 0 15 000000 		JRST	0(QLINK)	; AND RETURN
  1485
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 58
SNOPL	MAC	13-Oct-66 22:20		CURS$ - BUILT-IN TO BUILD NODE

  1486						SUBTTL	CURS$ - BUILT-IN TO BUILD NODE
  1487
  1488					;	THIS ROUTINE BUILDS THE NODE AND ALLOCATES STORAGE OFF
  1489					;	SURF FOR THE PATTERN BUILDER.	CALLED WHEN @ SEEN.
  1490					;	CALLING SEQUENCE:
  1491					;	JSP	PLINK,CURS
  1492					;	ERROR RETURN
  1493					;	NORMAL RETURN FROM UPDATE(COMMON CODE)
  1494
  1495	401235'	460 00 0 01 777777 	CURS::	SETCM	Z,-1(STACK)	;  RETRIEVE 1ST WORD
  1496	401236'	603 00 0 00 024000 		TLNE	Z,NONDC+FLDC	;  TEST FOR VAR OR TVAR
  1497	401237'	254 00 0 00 401244'		JRST	CURS.X		;  MAY BE AN EXPRESSION
  1498
  1499	401240'	265 11 0 00 400214'		JSP	TLINK,PATALL	;  ALLOCATE NODE
  1500	401241'	201 00 0 00 401255'		MOVEI	Z,PR.CUR	;  PRIMITIVE FOR VAR OR TVAR
  1501	401242'	202 00 0 12 000000 		MOVEM	Z,PPROG(T2)	;  PLACE IN PPROG
  1502	401243'	254 00 0 00 400223'		JRST	UPDATE		;  NORMAL RETURN AFTER UPDATE
  1503	
  1504					;	ENTER HERE IF EXPRESSION
  1505	401244'	265 11 0 00 400204*	CURS.X:	JSP	TLINK,CVTVAL	;  INSURE A VALUE
  1506	401245'	001 17 0 00 000000 		ERROR	15		;  THIS CAN'T HAPPEN
  1507	401246'	554 00 0 01 777777 		HLRZ	Z,-1(STACK)	;  RETRIEVE DATATYPE
  1508	401247'	302 00 0 00 004006 		CAIE	Z,EDT		;  MUST BE AN EXPRESSION
  1509	401250'	001 16 0 00 000007 		ERROR	14,7		;  WRONG KIND OF VALUE, HE LOSES
  1510
  1511	401251'	265 11 0 00 400214'		JSP	TLINK,PATALL	;  ALLOCATE NODE
  1512	401252'	201 10 0 00 401267'		MOVEI	S3,PR$CUR	;  PRIMITIVE FOR EXPR.
  1513	401253'	202 10 0 12 000000 		MOVEM	S3,PPROG(T2)	;  PLACE IN PPROG OF NODE
  1514	401254'	254 00 0 00 400223'		JRST	UPDATE		;  NORMAL RETURN
  1515
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 59
SNOPL	MAC	13-Oct-66 22:20		PR.CUR - PRIMITIVE FOR @VARIABLE

  1516						SUBTTL	PR.CUR - PRIMITIVE FOR @VARIABLE
  1517
  1518					;	THIS ROUTINE ASSIGNS THE VALUE OF THE CURSOR TO A VARIABLE.
  1519					;	IT IS CALLED BY THE PATTERN MATCHER AS WELL AS
  1520					;	BY PR$CUR.
  1521					;	CALLING SEQUENCE:
  1522					;	JRST PR.CUR
  1523					;	RETURN GOES TO SUCCESS UNLESS A WEIRD ERROR OCCURS
  1524
  1525	401255'	261 01 0 05 000002 	PR.CUR::	PUSH	STACK,PARG(P2)	; PUSH NAME ONTO ...
  1526	401256'	261 01 0 05 000003 		PUSH	STACK,PARG+1(P2)	; STACK
  1527	401257'	261 01 0 00 401276'	PR.CUS:	PUSH	STACK,[IDT,,0]	; PUSH DESCRIPTOR TOP
  1528
  1529	401260'	200 00 0 00 401166*		MOVE	Z,MAXLEN	;  OBTAIN MAXLEN
  1530	401261'	274 00 0 00 401205*		SUB	Z,CURSOR	;  SUBTRACT CURSOR
  1531	401262'	261 01 0 00 000000 		PUSH	STACK,Z		;  PUSH VALUE TO BE ASSIGNED . . . 
  1532	401263'	265 11 0 00 401222*		JSP	TLINK,ASGNVL	;  CALL ASGNVL
  1533					IFE FTPAV,<
  1534						ERROR	15
  1535					>
  1536					IFN FTPAV,<
  1537	401264'	254 00 0 00 401201*		JRST	SC.MF		;ASSIGNMENT FAILED -- MATCH FAILS
  1538					>
  1539	401265'	274 01 0 00 401301'		SUB	STACK,[XWD 2,2]	;	POP STACK
  1540	401266'	254 00 0 00 401203*		JRST	SC.S		;  NORMAL RETURN
  1541
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 60
SNOPL	MAC	13-Oct-66 22:20		PR$CUR - PRIMITIVE FOR @EXPRESSION

  1542						SUBTTL	PR$CUR - PRIMITIVE FOR @EXPRESSION
  1543
  1544					;	THIS ROUTINE DETERMINES IF AN EXPRESSION
  1545					;	WHICH IS EVALUATED HERE IS A VAR OR A TVAR
  1546					;	THEN PR.CUR IS CALLED TO ASSIGN VALUE.
  1547					;	CALLING SEQUENCE:
  1548					;	JRST PR$CUR
  1549					;	RETURN FINALLY GOES TO SC.S
  1550
  1551	401267'	201 12 0 05 000002 	PR$CUR::	MOVEI	T2,PARG(P2)		;LOC OF EXPR DESCR
  1552	401270'	265 11 0 00 400107'		JSP	TLINK,PEVAL		;EVALUATE IT.
  1553	401271'	254 00 0 00 401264*		JRST	SC.MF			;	FAILED.	PASS IT BACK
  1554	401272'	460 00 0 01 777777 		SETCM	Z,-1(STACK)		;CHK RESULT IS VAR OR TRAPVAR
  1555	401273'	603 00 0 00 024000 		TLNE	Z,NONDC+FLDC		;	SKP IF OK
  1556	401274'	001 16 0 00 000007 		ERROR	14,7			;	NOT OK.	HOLLER
  1557	401275'	254 00 0 00 401257'		JRST	PR.CUS			;GO JOIN COMMON CODE
  1558						END

NO ERRORS DETECTED

HI-SEG. BREAK IS 401312
PROGRAM BREAK IS 000000
CPU TIME USED 10:08.939

44P CORE USED
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page S-1
SNOPL	MAC	13-Oct-66 22:20		SYMBOL TABLE

ANY		400367'	int	EDT		004006	sin	PLEDT		000207	spd	Q1		000015		
ANY.EX		400410'		EOE		401300'	ext	PLINK		000004		Q2		000016		
ANY.PR		400422'		ERR	001000	000000		PLMIN		000000	spd	Q3		000017		
ANY1		400404'		ERR.	003000	000000		PLSIX	605400	000000	spd	QLINK		000015		
ANYNT		400434'		EVAL		400132'	ext	PLVER		000005	spd	REGP		000004	spd	
ASGNVL		401263'	ext	EVLPRO		400317'		PLWHO		000000	spd	RES.BK		400521'		
BLENG		000000	sin	FIXNUL		401227'		PMIN		000004	sin	RESPTR		401105'		
BREAK		400463'	int	FLAT		400150'	ext	PNAME1		401225'		RPOS		400727'	int	
BRK.EX		400476'		FLDC		004000	sin	PNAMEL		401207'	int	RPS.PR		400741'		
BRK.PR		400505'		FTDEBU		000000	spd	PNDSZ		000004	sin	RPSM		400716'		
BRK1		400473'		FTPAV	777777	777777	spd	POS		400704'	int	RTAB		400750'	int	
BRKPRO		400272'		FUTILE		401063'	ext	POSTAB		400240'		RTB.PR		400756'		
BRKX		400532'	int	GBAL1		401052'		PPL		000046	spd	S1		000006		
BRKX.X		400561'		GBAL2		401035'		PPR		400142'	ext	S2		000007		
BRX1		400542'		GBAL3		401047'		PPROG		000000	sin	S3		000010		
CDIF		600000	sin	GCOL		400557'	ext	PPSA		400144'	ext	SAVEM		400145'	ext	
CEIL		400556'	ext	HSR		000003		PR$ANY		400427'	int	SC.LF		401206'	ext	
CEXPAT		400100'		HSTACK		400141'	ext	PR$BRK		400524'	int	SC.MF		401311'	ext	
CHECK		401024'	ext	IDT		002001	sin	PR$CUR		401267'	int	SC.S		401266'	ext	
CURS		401235'	int	IN23		401160'		PR$LEN		400676'	int	SLINK		000006		
CURS.X		401244'		LEN		400640'	int	PR$NTN		400455'	int	SPAN		400566'	int	
CURSOR		401261'	ext	LEN.EX		400656'		PR$POS		400723'	int	SPAN.X		400607'		
CVPTSV		400061'	ext	LEN.PR		400670'		PR$RPS		400744'	int	SPAN1		400603'		
CVTCS		400633'	ext	LHDR		000002	sin	PR$RTB		400761'	int	SPN.PR		400621'		
CVTCSC		400460'	ext	LPHDR		000005	sin	PR$SPN		400630'	int	SQZE		400156'		
CVTINT		400640'	ext	LREGP		000002	spd	PR$TAB		401011'	int	SRFUPD		400051'		
CVTPAT		400000'	int	LREGS		000003	spd	PR.ABT		400352'	ext	STACK		000001		
CVTPTR		400014'	ext	LREGT		000004	spd	PR.ANY		400416'	int	STPTR		401105'	ext	
CVTSTR		400566'	ext	LSAVEI		000010	spd	PR.BRK		400503'	int	STR.		401035'	ext	
CVTVAL		401244'	ext	LSAVEM		000014	spd	PR.CB2		401142'	int	STR.C		400623'	ext	
D.CB2		000000	ext	LSAVEP		000011	spd	PR.CN2		401121'	int	STRLP		401076'		
D.IB2		401175'	ext	LSAVES		000011	spd	PR.CUR		401255'	int	SUBJ		401217'	ext	
D.LF		401005'	ext	MAXLEN		401260'	ext	PR.CUS		401257'		SURF		000002		
D.XB1		000000	ext	NONDC		020000	sin	PR.EX1		400324'	ext	SYSCT		401022'	ext	
E1$2		000000	sin	NSTACK		401151'	ext	PR.FL		401015'	int	T1		000011		
E1$39		000000	sin	NTNY		400437'	int	PR.GBL		401020'	int	T2		000012		
E1$41		000000	sin	NTNY.X		400447'		PR.IB2		401204'	int	T3		000013		
E1$44		000000	sin	NTNY1		400376'		PR.IN2		401153'	int	TAB		400765'	int	
E1$45		000000	sin	NULLND		400061'		PR.LEN		400665'	int	TAB.PR		400773'		
E1$46		000000	sin	NULLST		401232'	ext	PR.LFL		401062'	int	TLINK		000011		
E1$47		000000	sin	P2		000005		PR.LN1		401055'	int	UPDATE		400223'		
E1$48		000000	sin	PARG		000002	sin	PR.POS		400715'	int	Y.LP	010000	000000	spd	
E1$6		000000	sin	PATALL		400214'		PR.RPS		400740'	int	Y.RP	004000	000000	spd	
E13$1		000000	sin	PATPRO		400255'		PR.RTB		400755'	int	Z		000000		
E13$12		000000	sin	PBLOK		000404	sin	PR.SPN		400615'	int	$FAIL		400330'	int	
E13$14		000000	sin	PDT		004004	sin	PR.STR		401065'	int	$FENCE		400341'	int	
E13$17		000000	sin	PEVAL		400107'	int	PR.TAB		400772'	int	$REM		400356'	int	
E13$18		000000	sin	PEVAL0		400131'		PR.XB1		401117'	int	%%JOBD	043100	000450	spd	
E13$19		000000	sin	PEVAL1		400122'		PR.XN1		401110'	int	%%MACT	000200	000025	spd	
E13$20		000000	sin	PEVALD		400140'		PSHR		400124'	ext	%%SNOP	000500	000305	spd	
E13$21		000000	sin	PEVALF		400137'		PSHSA		400122'	ext	%%UUOS	001400	000457	spd	
E13$6		000000	sin	PEVALI		400167'		PSTART		000002	sin	
E14$7		000000	sin	PEVALS		400201'		PSTB.X		400247'		
E14$8		000000	sin	PEVALX		400153'		PTRLP		400235'		
E15$		000000	sin	PLASC	502300	000000	spd	PTRLPL		400233'		

SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOPL	MAC	13-Oct-66 22:20		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

ANY	   579#
ANY.EX	   580	   599#
ANY.PR	   625#	   649
ANY1	   594#	   604	   680
ANYNT	   647#	   697
ASGNVL	  1415	  1464	  1532
BLENG	   160	   190	   295
BREAK	   709#
BRK.EX	   710	   722#
BRK.PR	   740#	   774
BRK1	   718#	   726
BRKPRO	   468#	   795
BRKX	   786#
BRKX.X	   787	   810#
BRX1	   794#	   814
CDIF	   230
CEIL	   182	   387	   806
CEXPAT	   134	   202#
CHECK	   625	   874	  1205
CURS	  1495#
CURS.X	  1497	  1505#
CURSOR	   616	   628	   640	   692	   740	   742	   747	   755	   865	   881	   894	   952	   956	  1008
	  1153	  1155	  1158	  1189	  1201	  1209	  1211	  1217	  1228	  1231	  1243	  1245	  1271	  1276
	  1284	  1290	  1304	  1339	  1395	  1440	  1530
CVPTSV	   135	   137	   155	   185
CVTCS	   153	   584	   643	   714	   769	   791	   831	   898
CVTCSC	   668	   695
CVTINT	   319	   426	   914
CVTPAT	   130#
CVTPTR	   142
CVTSTR	   136	   346	   579	   663	   709	   786	   826
CVTVAL	   315	   342	  1505
D.CB2	  1347
D.IB2	  1402
D.LF	  1162
D.XB1	  1308
E1$2	   320#
E1$39	   933#
E1$41	   436#
E1$44	   851#
E1$45	   812#
E1$46	   724#
E1$47	   676#
E1$48	   601#
E1$6	   347#
E13$1	   322#
E13$12	   917#
E13$14	   429#
E13$17	   830#
E13$18	   790#
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOPL	MAC	13-Oct-66 22:20		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

E13$19	   713#
E13$20	   667#
E13$21	   583#
E13$6	   350#
E14$7	  1509#	  1556#
E14$8	  1390#	  1460#
E15$	   154#	   585#	   645#	   670#	   696#	   715#	   771#	   792#	   832#	   899#	  1506#
EDT	   133	   224	   268	   291	   435	   600	   675	   723	   811	   850	   932	  1508
EOE	   230
EVAL	   247
EVLPRO	   203	   502#
FIXNUL	  1400	  1463	  1478#
FLAT	   250	   251	   266	   267
FLDC	  1389	  1459	  1496	  1555
FTDEBU	   237	   239	   260	   262
FTPAV	  1416	  1419	  1465	  1468	  1533	  1536
FUTILE	  1159	  1223	  1258
GBAL1	  1206	  1231#
GBAL2	  1215#	  1220	  1221
GBAL3	  1216	  1227#
GCOL	   183	   388	   807
HSR	   241	   259	  1163	  1164	  1308	  1309	  1347	  1348	  1403	  1404
HSTACK	   241	   259
IDT	   145	   494	   565	  1305	  1335	  1366	  1439	  1527
IN23	  1388#
LEN	   914#
LEN.EX	   915	   931#
LEN.PR	   952#	   974
LHDR	   296	   299
LPHDR	   158	   159	   161	   174	   188	   189	   191	   198	   204	   207	   208	   209	   365	   367
	   386	   446	   447	   468	   469	   476	   482	   488	   493	   502	   503	   518	   519	   534
	   535	   542	   557	   558	   796	   797	   805
LREGP	   239	   260
LREGS	   239	   260
LREGT	   239	   260
LSAVEI	   237	   262
LSAVEM	   237	   262
LSAVEP	   237	   262
LSAVES	   237	   262
MAXLEN	   751	  1007	  1150	  1303	  1338	  1394	  1529
NONDC	  1389	  1459	  1496	  1555
NSTACK	  1332	  1344	  1361	  1369
NTNY	   663#
NTNY.X	   664	   674#
NTNY1	   588#	   671
NULLND	   139	   185#
NULLST	   349	   582	   666	   712	   789	   829	  1482	  1483
P2	   311	   338	   438	   621	   624	   737	   738	   867	   868	   947	   948	   949	   986	  1005
	  1037	  1055	  1087	  1101	  1133	  1147	  1269	  1273	  1278	  1333	  1334	  1382	  1525	  1526
	  1551
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOPL	MAC	13-Oct-66 22:20		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

PARG	   164	   167	   169	   193	   195	   207	   208	   311	   338	   368	   369	   589	   591	   621
	   624	   737	   738	   798	   799	   834	   836	   867	   868	   921	   923	   927	   928	   947
	   948	   949	   991	   993	  1005	  1041	  1043	  1055	  1101	  1147	  1269	  1273	  1278	  1333
	  1334	  1382	  1525	  1526	  1551
PATALL	   362#	   430	   437	   588	   605	   679	   718	   833	   855	   918	   934	  1499	  1511
PATPRO	   157	   187	   363	   446#
PBLOK	   446	   468	   502	   518	   534	   557
PDT	   131	   178	   383	   802
PEVAL	   223#	   269	   312	   339	  1383	  1456	  1552
PEVAL0	   246#
PEVAL1	   231	   237#
PEVALD	   252	   257#
PEVALF	   248	   255#
PEVALI	   311#	   969	  1022	  1071	  1118	  1176
PEVALS	   338#	   642	   694	   768	   896
PEVALX	   225	   271#
PLASC	    31#
PLEDT	    24#
PLINK	   247	   389	   808
PLMIN	    23#
PLSIX	    30#
PLVER	    22#
PLWHO	    25#
PMIN	   168	   194	   596	   844	   922
PNAME1	  1457	  1473#
PNAMEL	  1453#	  1474
PNDSZ	   158	   159	   164	   174	   188	   189	   198	   204	   209	   365	   386	   446	   454	   468
	   476	   477	   482	   484	   488	   489	   493	   502	   510	   518	   526	   534	   542	   544
	   549	   557	   796	   797	   805	  1278
POS	   986#
POSTAB	   426#	   988	  1039	  1089	  1135
PPL	   237#	   237	   238	   239#	   239	   240	   260#	   260	   261	   262#	   262	   263
PPR	   260
PPROG	   171	   197	   431	   438	   594	   719	   800	   842	   920	   936	  1501	  1513
PPSA	   262
PR$ANY	   602	   640#
PR$BRK	   725	   768#	   813
PR$CUR	  1512	  1551#
PR$LEN	   935	   969#
PR$NTN	   677	   692#
PR$POS	   986	  1022#
PR$RPS	  1037	  1071#
PR$RTB	  1087	  1118#
PR$SPN	   853	   894#
PR$TAB	  1133	  1176#
PR.ABT	   547
PR.ANY	   593	   616#
PR.BRK	   481	   716	   737#	   793
PR.CB2	  1361#
PR.CN2	  1332#
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOPL	MAC	13-Oct-66 22:20		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

PR.CUR	  1500	  1525#
PR.CUS	  1527#	  1557
PR.EX1	   508
PR.FL	   524	  1189#
PR.GBL	  1201#
PR.IB2	  1439#
PR.IN2	  1379#
PR.LEN	   919	   947#
PR.LFL	  1257#
PR.LN1	   492	  1243#
PR.POS	   987	  1005#
PR.RPS	  1038	  1055#
PR.RTB	   563	  1088	  1101#
PR.SPN	   838	   865#
PR.STR	   170	  1269#
PR.TAB	  1134	  1147#
PR.XB1	  1321#
PR.XN1	  1303#
PSHR	   239
PSHSA	   237
PSTART	   162	   163	   590	   592	   835	   837	   992	   994	  1042	  1044
PSTB.X	   427	   434#
PTRLP	   405#	   407	  1161	  1165
PTRLPL	   401#	   957
Q1	   229	   230	   255	   257	   264	   921	   922	   923	   925	   927
Q2	   267	   268	   928	  1207	  1219	  1478	  1479
Q3	   223	   224	   227	   228	   229	   233	   294	   295	   299	  1275	  1363	  1364
QLINK	   142	   183	   388	   807	  1400	  1463	  1479	  1484
REGP	   239	   240	   260	   261
RES.BK	   744	   754#
RESPTR	  1283	  1289#
RPOS	  1037#
RPS.PR	  1057#	  1074
RPSM	  1007#	  1025	  1059
RTAB	  1087#
RTB.PR	  1104#	  1121
S1	   947	   952	   954	   955	   972	  1213	  1220	  1221	  1276	  1290
S2	   401	   621	   648	   737	   773	   867	   868	   901	   948	   970	   972	   973	  1005	  1007
	  1008	  1009	  1010	  1023	  1057	  1058	  1101	  1105	  1119	  1150	  1151	  1152	  1153	  1156
	  1158	  1162	  1163	  1203	  1257	  1258	  1277	  1289	  1380	  1392	  1393	  1397	  1453	  1455
	  1462	  1473
S3	   405	   431	   593	   594	   602	   624	   647	   677	   716	   719	   725	   738	   772	   793
	   800	   813	   838	   842	   853	   900	   935	   936	   949	   987	  1038	  1055	  1058	  1072
	  1088	  1104	  1105	  1134	  1147	  1151	  1155	  1156	  1177	  1204	  1281	  1282	  1332	  1333
	  1334	  1335	  1343	  1344	  1361	  1362	  1368	  1369	  1394	  1395	  1396	  1397	  1399	  1453
	  1512	  1513
SAVEM	   237	   237#	   238	   262	   263
SC.LF	   620	   641	   693	   756	   866	   895	   953	  1011	  1152	  1191	  1202	  1244	  1259	  1272
	  1322	  1370	  1441
SC.MF	   313	   317	   340	   344	   626	   875	  1010	  1154	  1190	  1208	  1229	  1291	  1385	  1420
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOPL	MAC	13-Oct-66 22:20		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

	  1537	  1553
SC.S	   196	   405	   475	   487	   540	   629	   749	   752	   883	   954	  1009	  1224	  1233	  1247
	  1287	  1311	  1351	  1423	  1540
SLINK	   323	   351	   432	   440	   642	   694	   768	   896	   969	   988	  1022	  1039	  1071	  1089
	  1118	  1135	  1176	  1454
SPAN	   826#
SPAN.X	   827	   849#
SPAN1	   842#	   854
SPN.PR	   874#	   902
SQZE	   290#	   300
SRFUPD	   176#	   199	   211
STACK	   130	   138	   140	   141	   145	   146	   147	   148	   152	   162	   163	   164	   165	   166
	   169	   179	   180	   192	   195	   207	   208	   233	   234	   243	   244	   250	   251	   271
	   272	   316	   321	   343	   348	   368	   369	   384	   385	   428	   434	   581	   599	   647
	   648	   665	   674	   711	   722	   740	   741	   745	   753	   754	   755	   772	   773	   788
	   798	   799	   803	   804	   810	   828	   849	   900	   901	   916	   931	   970	   971	  1023
	  1024	  1072	  1073	  1119	  1120	  1177	  1178	  1209	  1210	  1222	  1227	  1228	  1305	  1306
	  1321	  1336	  1345	  1366	  1367	  1380	  1381	  1384	  1388	  1398	  1399	  1422	  1439	  1440
	  1458	  1461	  1462	  1471	  1478	  1481	  1482	  1483	  1495	  1507	  1525	  1526	  1527	  1531
	  1539	  1554
STPTR	   402	   406	   627	   741	   754	   882	  1164	  1210	  1212	  1218	  1227	  1232	  1246	  1277
	  1280	  1285	  1289
STR.	   743	  1215
STR.C	   877
STRLP	  1281#	  1286
SUBJ	   750	  1057	  1104	  1275	  1337	  1363	  1391	  1398	  1461
SURF	   156	   158	   160	   161	   162	   163	   168	   176	   181	   182	   186	   188	   190	   191
	   194	   202	   204	   207	   208	   362	   365	   367	   382	   386	   387	   590	   592	   596
	   794	   796	   797	   801	   805	   806	   835	   837	   844	   922	   992	   994	  1042	  1044
SYSCT	  1203
T1	  1280	  1282	  1285	  1337	  1341	  1392	  1396	  1402	  1403
T2	   143	   174	   181	   198	   209	   223	   227	   228	   243	   244	   266	   271	   272	   290
	   294	   299	   311	   338	   367	   368	   369	   431	   438	   589	   591	   594	   719	   797
	   798	   799	   800	   834	   836	   842	   920	   921	   923	   927	   928	   936	   991	   993
	  1041	  1043	  1273	  1338	  1339	  1340	  1342	  1343	  1382	  1391	  1393	  1455	  1501	  1513
	  1551
T3	   161	   164	   167	   169	   171	   191	   193	   195	   197	   292	   297	  1269	  1271	  1286
TAB	  1133#
TAB.PR	  1107	  1150#	  1179
TLINK	   132	   135	   136	   144	   153	   155	   184	   185	   235	   264	   274	   312	   315	   319
	   339	   342	   346	   370	   426	   430	   437	   579	   584	   588	   604	   625	   643	   663
	   668	   679	   695	   709	   714	   718	   743	   769	   786	   791	   826	   831	   833	   854
	   874	   877	   898	   914	   918	   934	  1205	  1215	  1383	  1415	  1456	  1464	  1499	  1505
	  1511	  1532	  1552
UPDATE	   382#	   597	   720	   845	   929	   937	   989	   995	  1040	  1045	  1090	  1091	  1136	  1137
	  1502	  1514
Y.LP	  1204
Y.RP	  1204
Z	   130	   131	   133	   146	   149	   152	   156	   157	   158	   159	   160	   166	   167	   168
	   170	   171	   176	   178	   179	   186	   187	   188	   189	   190	   192	   193	   194	   196
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOPL	MAC	13-Oct-66 22:20		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Symbol cross reference

	   197	   202	   203	   204	   237	   239	   246	   260	   262	   290	   291	   295	   296	   348	   349
	   362	   363	   365	   382	   383	   384	   401	   402	   434	   435	   581	   582	   589	   590
	   591	   592	   595	   596	   599	   600	   665	   666	   674	   675	   711	   712	   722	   723
	   750	   751	   788	   789	   794	   795	   796	   801	   802	   803	   810	   811	   828	   829
	   834	   835	   836	   837	   843	   844	   849	   850	   919	   920	   931	   932	   955	   956
	   991	   992	   993	   994	  1041	  1042	  1043	  1044	  1278	  1281	  1303	  1304	  1306	  1309
	  1336	  1340	  1341	  1342	  1348	  1362	  1364	  1367	  1388	  1389	  1404	  1458	  1459	  1495
	  1496	  1500	  1501	  1507	  1508	  1529	  1530	  1531	  1554	  1555
$FAIL	   518#
$FENCE	   534#
$REM	   557#
SNOPL - Local Pattern Routines  %5(207)	MACRO %53B(1156)-1 21:51 14-Mar-88 Page 1
SNOPL	MAC	13-Oct-66 22:20		Gimpel--Ma355/JDS/DRH/MP/RCM/VB		15-Jun-76


Macro/Opdef cross reference

DMOVE	   867
ERR	   154	   322	   350	   429	   583	   585	   645	   667	   670	   696	   713	   715	   771	   790
	   792	   830	   832	   899	   917	  1390	  1460	  1506	  1509	  1556
ERR.	   320	   347	   436	   601	   676	   724	   812	   851	   933
ERROR	   154	   322	   350	   429	   583	   585	   645	   667	   670	   696	   713	   715	   771	   790
	   792	   830	   832	   899	   917	  1390	  1460	  1506	  1509	  1556
ERROR.	   320	   347	   436	   601	   676	   724	   812	   851	   933
MIDENT	   238	   240	   261	   263
PLPTX	    45
PLTTL	    44
POPR	   260
POPSA	   262
PPADDR	   237#	   238	   239#	   240	   260#	   261	   262#	   263
PPINIT	   237	   239	   260	   262
PPLENG	   237#	   238	   239#	   240	   260#	   261	   262#	   263
PUSHR	   239
PUSHSA	   237
SHOW.	    37	    38	    39	    40
TITLE.	    29 Z |