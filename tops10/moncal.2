                                                        LOGOUT [CALLI 17]


                             LOGOUT [CALLI 17]                             LOGOUT [CALLI 17]



   Function

        Releases all I/O devices associated  with  the  calling  job  and
        returns  them  to  the monitor's pool of available devices, along
        with the job's allocated core and its job number.

        To perform this call, the user program should use the RUN UUO  to
        call SYS:LOGOUT.EXE, where SYS is the [1,4] area.

        The LOGOUT UUO has no error return.  If the calling  program  has
        JACCT  privileges and is named LOGOUT.EXE, this call logs out the
        job.  Otherwise, the call functions like an EXIT UUO.

   Calling Sequence

        LOGOUT
        return

   Related Calls

        EXIT









































                                   22-217
   LOOKUP [OPCODE 076]


                            LOOKUP [OPCODE 076]                            LOOKUP [OPCODE 076]



   Function

|       Selects a file for input.  Use FILOP. to perform a lookup for  an
|       extended  I/O  channel.   The  LOOKUP call is meaningful only for
        directory devices (disk, DECtape, labelled  magnetic  tape),  and
        for  TSK  devices (initiated for task-to-task communication).  It
        is a no-op for other devices, always taking the normal return for
        these.

   Calling Sequence

        The LOOKUP monitor call, like the ENTER  call,  has  two  calling
        sequences:   one  using  a  4-word argument list and one using an
        extended argument list.  The argument lists  for  LOOKUP,  ENTER,
        and  RENAME  UUOs  are identical.  These are described in Section
        11.13.  The  four-word  argument  list  is  detailed  in  Section
        11.13.1.   The  extended  argument  list  is described in Section
        11.13.2.

   Normal Return

                                                            addr        For DECtape, the monitor returns a 4-word block at  addr  in  the
        following form:

        ______    ________        Offset    Contents

           0      The SIXBIT file name.

           1      The extension, creation date, and first block number:

                         ____   ________                         Bits   Contents

                         0-17   The SIXBIT file extension.
                        18-20   The high-order three  bits  of  the  file
                                creation date.
                        21-25   Reserved.
                        26-35   The first physical (data) block number.

          2       Remainder of creation date:

                         ____   ________                         Bits   Contents

                         0-23   Reserved.
                        24-35   The  low-order  12  bits  of   the   file
                                creation date.

          3       Length and address of file:

                         ____   ________                         Bits   Contents

                         0-17   Negative   of   number   of   words    in
                                zero-compressed file.
                        18-35   Address of word preceding the first  word
                                of the file.

        For disk files, and labelled magtape  files,  refer  to  Sections
        11.13.1  and  11.13.2 for the argument blocks returned by LOOKUP,
        ENTER, and RENAME UUOs.




                                   22-218
                                                      LOOKUP [OPCODE 076]


   Error Return

        The error codes for LOOKUP are the same as those for  ENTER,  and
        are documented in Section 11.14.

   Examples

        For more information about  doing  I/O  and  examples  using  the
        LOOKUP call, refer to Chapter 11.

























































                                   22-219
   MERGE. [CALLI 173]


                             MERGE. [CALLI 173]                             MERGE. [CALLI 173]



   Function

        Merges an .EXE file or  a  portion  of  an  .EXE  file  into  the
        currently  loaded low segment in memory, ignoring page 0 from the
        .EXE file.

   Calling Sequence

                MOVEI   ac,addr
                MERGE.  ac,
                  error return
                normal return
                ...
        addr:   SIXBIT/device/
                SIXBIT/filename/
                SIXBIT/extension/
                EXP     0
|               XWD     proj,prog \
|                       0,addr2   /
|               XWD     low-page,hi-page \
|                       -n,,addr3        |
|                       0                /

                addr        where:  addr is the address of the 6-word argument block.

                device                device is the name of the device on which the  .EXE  file
                resides.

                filename                filename specifies the name of the .EXE file.

                extension                extension specifies the extension of the .EXE file.

                proj,prog                proj,prog is the project-programmer  number  representing
                the  directory  in  which  the .EXE file resides.  If you
                specify  this  word  as  zero,  your  directory  path  is
                                                         addr                assumed.   If this word is [XWD 0,addr], addr points to a
                PATH.  block containing the full path  specification  for
                the file.  Refer to the description of the PATH.  monitor
                call for information pertaining  to  the  format  of  the
                PATH.  block.

                The last word of the argument block  has  three  possible
                         low-page       hi-page                forms:   low-page  and  hi-page  specify  the lower-bound
                virtual page number  and  the  upper-bound  virtual  page
                number  of  the  .EXE  file  to  be  loaded into your low
|               segment.  Specifying -n,,addr3 indicates that each of the
|               n  ranges  of  pages given in addr3 (in low-page, hi-page
|               form) are to be  MERGEd.   This  format  saves  you  from
|               performing multiple MERGEs.  Finally, placing zero in the
|               last word causes the low-segment pages in the  .EXE  file
|               to be merged.

   Normal Return

        The .EXE file pages are merged into the current  low  segment  in
        memory.    The  accumulators  are  destroyed  and  channel  0  is
        released.





                                   22-220
                                                       MERGE. [CALLI 173]


   Error Return

        The error return is taken if any errors are detected; the monitor
                                        ac        returns  an  error  code in the ac.  The possible error codes are
        listed in Chapter 11.

   Related Calls

        GETSEG, RUN

|  Common Errors
|  
|        o  Forgetting to save the acs over the MERGE.
|  
|        o  Forgetting that channel 0 is destroyed.
|  
|        o  Attempting to MERGE high segment data.

















































                                   22-221
|  MONRT. [CALL 1,12]


                             MONRT. [CALL 1,12]|                            MONRT. [CALL 1,12]



   Function

        Identical to the call:

                EXIT 1,

        See the EXIT monitor call.  Note  that  this  function  does  not
        perform a RESET for your job.






















































                                   22-222
                                                        MSTIME [CALLI 23]


                             MSTIME [CALLI 23]                             MSTIME [CALLI 23]



   Function

        Returns the current time of day.

   Calling Sequence

                MSTIME ac,
                return

   Return

        The time elapsed (in milliseconds) since midnight is returned  in
            ac        the ac.

   Related Calls

        DATE, RUNTIM, TIMER













































                                   22-223
   MTAID [CALLI 126]


                             MTAID. [CALLI 126]                             MTAID. [CALLI 126]



   Function

        Associates a SIXBIT reel identifier  with  a  specified  magnetic
        tape drive.  This call requires JACCT or [1,2] privileges.

   Calling Sequence

               MOVE     ac,[SIXBIT/device/]    \
               MOVEI    ac,channo              |
               MOVEI    ac,udx                 /
               MOVE     ac+1,[SIXBIT/reelid/]
               MTAID.   ac,
                 error return
               normal return

                device        where:  device is the  SIXBIT  physical  or  logical  name  of  a
                device.

                channo                channo is the number of an initialized channel.

                udx                udx is the Universal Device Index for a device.

                reelid                reelid is the SIXBIT tape reel identifier, or 0 to  clear
                the current reelid.

        Note that your program can also  clear  the  reel  identifier  by
        using  function code 11 (MTUNL.) to the MTAPE monitor call; or by
        deassigning the drive, using the REASSI UUO.   All  reel-specific
        error  counts  are  cleared by the MTAID.  call in order that all
        accumulated data for the specific reel is accurate.

   Normal Return

        The monitor has associated the  tape  reel  identifier  with  the
        specified  magtape device; the reel identifier is included in all
        media reports.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

         -2    MTINA%    Specified device is not available to your job or
                         your job is not privileged.
         -1    MTINX%    Specified device is nonexistent or not a magtape
                         device.

   Examples

                MOVE    T1,[SIXBIT/MTA0/]
                MOVE    T1+1,[SIXBIT/REEL1/]
                MTAID.  T1,
                  JRST  ERROR

   Related Calls

        MTAPE, MTCHR., TAPOP.




                                   22-224
                                                       MTAPE [OPCODE 072]


                             MTAPE [OPCODE 072]                             MTAPE [OPCODE 072]



   Function

        Passes the monitor a code for an extended  set  of  calls;  these
        calls perform functions for magnetic tapes and are usually called
|       MTAPEs.  Use FILOP. or TAPOP. to perform magnetic tape or DECtape
|       functions on extended I/O channels.

        Each defined MTAPE code also has a symbolic name; in this chapter
        the  MTAPEs  are  discussed in alphabetical order by their names.
        For example, MTAPE  3  has  the  name  MTEOF.;  its  function  is
        discussed under the name MTEOF.

|       Magtape I/O is described in Volume 1, Chapter 14.

        The MTAPEs are:

                          MTWAT.  [MTAPE 0]
                          MTREW.  [MTAPE 1]
                          MTEOF.  [MTAPE 3]
                          MTSKR.  [MTAPE 6]
                          MTBSR.  [MTAPE 7]
                          MTEOT.  [MTAPE 10]
                          MTUNL.  [MTAPE 11]
                          MTBLK.  [MTAPE 13]
                          MTSKF.  [MTAPE 16]
                          MTBSF.  [MTAPE 17]
                          MTDEC.  [MTAPE 100]
                          MTIND.  [MTAPE 101]
                          MTLTH.  [MTAPE 200]

        After your program issues the MTAPE  monitor  call,  the  monitor
        waits  for  the magnetic tape to complete any action in progress.
        The monitor then clears bits  18-25  of  the  file  status  word,
        initiates  the  indicated  MTAPE  function,  and  returns control
        immediately to your program.

        The I/O service routine may be reading several  blocks  ahead  of
        your program when performing I/O in buffered mode.  The execution
        of the MTAPE monitor call affects only the physical  position  of
        the  magnetic  tape and does not change the data that has already
        been read into the buffer.  Therefore, when your  program  issues
        either  an IN, INPUT, OUT, or OUTPUT call after the MTAPE monitor
        call, the monitor may not  retrieve  the  buffer  containing  the
        block  requested.   To guarantee that the requested block will be
        in the buffer, your program can set  up  a  single  buffer  ring.
        With  a single buffer ring the monitor is prohibited from reading
        ahead, and it stops the device after every  IN,  INPUT,  OUT,  or
        OUTPUT  monitor call.  Alternatively, your program can set bit 30
        (IO.SYN) in the I/O status word.  Setting  this  bit  causes  the
        monitor  to stop the device after each buffer is filled on an IN,
        INPUT, OUT,  OUTPUT,  or  FILOP. monitor  call.   Note  that  the
        FILOP. monitor call provides the functions of the MTAPE calls.










                                   22-225
   MTBLK. [MTAPE 13]


                             MTBLK. [MTAPE 13]                             MTBLK. [MTAPE 13]



   Function

|       Writes three inches of blank  tape.   Use  FILOP. to  perform  an
|       MTBLR. on an extended I/O channel.

   Calling Sequence

                MTBLK.  channo,
                return

                channo        where:  channo is the number  of  a  channel  initialized  for  a
                magtape device.

   Return

        Three inches of blank tape are written on the  device  associated
        with the given channel.

   Examples

                MTBLK.  5,

        Three inches of blank tape is written to the magtape on the  unit
        associated with channel 5.

   Related Calls

        FILOP., TAPOP.

   Common Errors

        Including an error return where none exists.

        Forgetting to include a comma after the channel number.




























                                   22-226
                                                        MTBSF. [MTAPE 17]


                             MTBSF. [MTAPE 17]                             MTBSF. [MTAPE 17]



   Function

|       Backspaces one file on  a  magtape.   Use  FILOP. to  perform  an
|       MTBSF. on an extended I/O channel.

   Calling Sequence

                MTBSF.  channo,
                return

                channo        where:  channo is the number  of  a  channel  initialized  for  a
                magtape device.

   Return

        The monitor backspaces over one file  on  the  device  associated
        with  the  given  channel.   The  monitor  moves  the tape in the
        reverse direction until the  tape  has  passed  a  tape  mark  or
        reached  the  beginning  of  the  tape.   The backspace operation
        positions the tape heads either immediately in front  of  a  tape
        mark or at the beginning of the tape.

        In most cases, your program should skip  forward  over  the  file
        mark  to  the beginning of the file.  However, when the backspace
        operation has positioned to the beginning of the  tape  and  when
        your  program  issues  the  MTSKF.   call,  the monitor skips the
        entire first file on the tape, stopping at the beginning  of  the
        second  file  rather  than  leaving  the  tape  positioned at the
        beginning of the first file.  Therefore, a correct  sequence  for
        backspacing a file is:

        1.  MTBSF.  to backspace the file.

        2.  MTWAT.  to wait for completion

        3.  STATO MT,IO.BOT to determine whether this is the beginning of
            the tape.

        4.  MTSKF.  to skip over the file mark if it is not the beginning
            of the tape.

        It is necessary to wait after the MTBSF.  instruction  to  ensure
        that  the  move  is complete before testing to see whether or not
        this is the beginning of the tape, but your program can  use  the
        MTWAT.  call to wait for the spacing operation to be completed.

   Examples

             MTBSF.  5,

        Backspaces over 1 file on the tape associated with channel 5.

   Related Calls

        FILOP., TAPOP.

   Common Errors

        Including an error return when none exists.

        Forgetting to include a comma after the channel number.

                                   22-227
   MTBSR. [MTAPE 7]


                              MTBSR. [MTAPE 7]                              MTBSR. [MTAPE 7]



   Function

|       Backspaces one record on a magtape device.  Use FILOP. to perform
|       an MTBSR. on an extended I/O channel.

   Calling Sequence

                MTBSR.  channo,
                return

                channo        where:  channo is the number  of  a  channel  initialized  for  a
                magtape device.

   Return

        The monitor backspaces over one record on the  device  associated
        with the given channel.

   Examples

                MTBSR.  7,

        Tall backspaces over a record on the magtape associated with
        channel 7.

   Related Calls

        FILOP., TAPOP.

   Common Errors

        Including an error return where none exists.

        Forgetting to include a comma after the channel number.




























                                   22-228
                                                       MTCHR. [CALLI 112]


                             MTCHR. [CALLI 112]                             MTCHR. [CALLI 112]



   Function

        Returns information about the state of a magtape drive.

   Calling Sequence

                MOVE    ac,[SIXBIT/device/]  \
                MOVEI   ac,channo            |
                MOVEI   ac,udx               |
                MOVE    ac,[XWD len,addr]    /
                MTCHR.  ac,
                  error return
                normal return
                . . .
                                       applicable only if ac contains        addr:   device-identifier     ;applicable only if ac contains
                                        len,,addr                BLOCK   20            ; len,,addr

                device        where:  device is the  SIXBIT  physical  or  logical  name  of  a
                device.

                channo                channo is the number of an initialized channel.

                udx                udx is the Universal Device Index for a device.

                Optionally, you can specify the length  and  location  of
                the argument list:

                len                len is the length of the argument list.

                addr                addr is the address of the argument list, and  the  words
                    addr+1                at  addr+1  will  be  filled in by the monitor on return.
                The argument list is used only if the length and  address
                                     ac                are  given  in  the  ac  instead  of  a device identifier
                (device, channel number, or UDX).

                device-identifier                device-identifier is set by the user program and contains
                the device name, UDX, or channel number.

   Normal Return

                                            ac        The monitor returns a value in the  ac,  and,  if  you  used  the
        optional  argument  list, the monitor returns values beginning at
        addr+1        addr+1.

                                 ac        The word returned in the ac is in the format:

        ____   ______    _______        Bits   Symbol    Meaning

        0-17   MT.AWC    The word  count  of  the  last  record  read  or
                         written.
       18-26   MT.CRC    If a 9-track NRZI tape, this field contains  the
                         last    cyclic   redundancy   character   (CRC);
                         otherwise, this field contains 0.
|      27-29   MT.NCR    The number of characters not  accounted  for  in
|                        MT.AWC,   read  from  the  tape  into  the  last
                         addressed location during the last read.
          30             Reserved for use by DIGITAL.  Should contain 0.
          31   MT.7TR    The unit is a 7-track unit.
          32   MT.WLK    The tape transport is write-locked.



                                   22-229
   MTCHR. [CALLI 112]


        ____   ______    _______        Bits   Symbol    Meaning

       33-35   MT.DEN    The tape density code:

                         ____   ______    _______                         Code   Symbol    Density

                           1    .MTDN2    200 bits per inch (8.1 rows per
                                          mm).
                           2    .MTDN5    556 bits per  inch  (22.5  rows
                                          per mm).
                           3    .MTDN8    800 bits per  inch  (32.2  rows
                                          per mm).
                           4    .MTD16    1600 bits per inch  (65.3  rows
                                          per mm).
                           5    .MTD62    6250 bits per inch (255.5  rows
                                          per mm).

        When the monitor determines the value of the density indicator to
        be  returned, it examines the I/O status bits you set in the OPEN
        call.  The monitor returns the density identifier you set in  the
        OPEN  call.  If you did not use INIT or OPEN to specify a density
        indicator, the monitor determines whether or not you  issued  the
        SET DENSITY monitor command.  If you did, the monitor returns, in
            ac        the ac, the same value you specified in the monitor command.   If
        neither,  the  monitor returns the system-default density.  (Note
        that when you issue a GETSTS, the monitor examines only  the  I/O
        status  bits  set  by the OPEN.  If you did not specify a density
        indicator with OPEN, the monitor returns a 0  when  you  issue  a
        GETSTS.  Therefore, when you issue a GETSTS, the monitor does not
        further  investigate  the  density  indentifier  or  supply   the
        system-default density indicator.)

        If you use the optional argument list, the monitor  returns  data
             addr+1        at   addr+1  and  the  subsequent  locations.   The  information,
                 addr+1        starting addr+1, is returned as:

        ______ ______    ________        Offset Symbol    Contents

           0   .MTCHN    Channel number.

           1   .MTRID    SIXBIT reel identifier of the tape.

           2   .MTWRD    Number of files read since the beginning of  the
                         tape.

           3   .MTREC    Number of records since last end-of-file.

           4   .MTCRD    Number  of  characters  read  since  last   tape
                         unload.

           5   .MTCWR    Number of characters  written  since  last  tape
                         unload.

           6   .MTSRE    Number of soft read errors since last unload.

           7   .MTHRE    Number of hard read errors since last unload.

          10   .MTSWE    Number of soft write errors since last unload.

          11   .MTHWE    Number of hard write errors since last unload.

          12   .MTTME    Total number of read and write errors since last
                         tape unload.



                                   22-230
                                                       MTCHR. [CALLI 112]


        ______ ______    ________        Offset Symbol    Contents

          13   .MTTDE    Number of device errors since system startup.

          14   .MTTUN    Number of unloads since system reload.

          15   .MTRTY    Number of retries to resolve last error; if  bit
                         1 is set, the error is a hard error.

          16   .MTCCR    Character count  of  the  last  record  read  or
                         written.

          17   .MTPBE    Position before error.  The file  number  before
                         last  error  (right  half),  and  record  number
                         before last error (left half).

                                                          _______________          20   .MTFES    Final error state.  Refer to the TOPS-10/TOPS-20
                         _____ ______                         SPEAR Manual.

   Error Return

                                                         ac        The error return is taken and -1 returned in the ac if the device
        you specified was not a magnetic tape unit or was nonexistent.

   Related Calls

        TAPOP.







































                                   22-231
   MTDEC. [MTAPE 100]


                             MTDEC. [MTAPE 100]                             MTDEC. [MTAPE 100]



   Function

        Initializes a channel for DIGITAL-compatible mode tape  handling.
|       Use FILOP. to perform an MTDEC. on an extended I/O channel.

        In DIGITAL compatible mode, the monitor writes or reads  36  bits
        in  5  frames  of  a  9-track magnetic tape.  The tape can be any
        density  or  parity  and  is  not  industry-compatible.   DIGITAL
        compatible  mode is the default mode that is set when the channel
        is opened.

        The DIGITAL-compatible mode remains in effect until  the  channel
        is  released,  or until you issue the MTIND. monitor call for the
        channel.

   Calling Sequence

                MTDEC.  channo,
                return

                channo        where:  channo is the number  of  a  channel  initialized  for  a
                magtape device.

   Return

        The device associated with the given channel is  initialized  for
        DIGITAL-compatible mode handling.

   Examples

                MTDEC.  11,

   Related Calls

        FILOP., TAPOP.

   Common Errors

        Including an error return where none exists.

        Forgetting to include a comma after the channel number.





















                                   22-232
                                                         MTEOF. [MTAPE 3]


                              MTEOF. [MTAPE 3]                              MTEOF. [MTAPE 3]



   Function

|       Writes an end-of-file mark on a magtape.  Use  FILOP. to  perform
|       an MTEOF. on an extended I/O channel.

   Calling Sequence

                MTEOF.  channo,
                return

                channo        where:  channo is the number  of  a  channel  initialized  for  a
                magtape device.

   Return

        The monitor writes an end-of-file mark on the specified device.

   Examples

                MTEOF.  10,

   Related Calls

        FILOP., TAPOP.

   Common Errors

        Including an error return when none exists.

        Forgetting to include a comma after the channel number.
































                                   22-233
   MTEOT. [MTAPE 10]


                             MTEOT. [MTAPE 10]                             MTEOT. [MTAPE 10]



   Function

        Advances a magtape device to the logical or physical end-of-tape.
|       Use FILOP. to perform an MTEOT on an extended I/O channel.

        The  logical  end-of-tape  is  indicated   by   two   consecutive
        end-of-file  marks.   The MTEOT.  call positions the tape between
        these two marks, allowing files to be appended to the tape.

   Calling Sequence

                MTEOT.  channo,
                return

                channo        where:  channo is the number  of  a  channel  initialized  for  a
                magtape device.

   Return

        The monitor positions the tape between the two end-of-file  marks
        that indicate the end-of-tape.

   Examples

                MTEOT.  6,

   Related Calls

        FILOP., TAPOP.

   Common Errors

        Including an error return when none exists.

        Forgetting to include a comma after the channel number.



























                                   22-234
                                                       MTIND. [MTAPE 101]


                             MTIND. [MTAPE 101]                             MTIND. [MTAPE 101]



   Function

        Initializes a channel for industry-compatible mode tape handling.
|       Use FILOP. to perform an MTIND. on an extended I/O channel.

        In industry-compatible mode, the monitor writes or reads 32  bits
        in  4 frames of a 9-track magnetic tape, ignoring the low-order 4
        bits of each PDP-10 word.  MTIND.  will set a default density  to
        1600 BPI, or the highest density allowed on the drive.

        The industry-compatible mode remains in effect until the  channel
        is  released,  or until you issue the MTDEC. monitor call for the
        channel.

   Calling Sequence

                MTIND.  channo,
                return

                channo        where:  channo is the number  of  a  channel  initialized  for  a
                magtape device.

   Return

        The device associated with the given channel is  initialized  for
        industry-compatible mode handling.

   Examples

                MTIND.  10,

   Related Calls

        FILOP., TAPOP.

   Common Errors

        Including an error return when none exists.

        Forgetting to include a comma after the channel number.






















                                   22-235
   MTLTH. [MTAPE 200]


                             MTLTH. [MTAPE 200]                             MTLTH. [MTAPE 200]



   Function

        Sets a flag to read the next record on the given  device  at  low
|       threshold  (TM10  only).   Use  FILOP. to  perform  MTLTH. on  an
|       extended I/O channel.

   Calling Sequence

                MTLTH.  channo,
                return

                channo        where:  channo is the number  of  a  channel  initialized  for  a
                magtape device.

   Return

        The monitor sets a flag to read the next record  from  the  given
        device at low threshold.

   Examples

                MTLTH.  5,

   Related Calls

        FILOP., TAPOP.

   Common Errors

        Including an error return when none exists.

        Forgetting to include a comma after the channel number.






























                                   22-236
                                                         MTREW. [MTAPE 1]


                              MTREW. [MTAPE 1]                              MTREW. [MTAPE 1]



   Function

|       Rewinds a magtape.  Use FILOP. to perform MTREW. on  an  extended
|       I/O channel.

   Calling Sequence

                MTREW.  channo,
                return

                channo        where:  channo is the number  of  a  channel  initialized  for  a
                magtape device.

   Return

        The monitor rewinds the tape on the specified device.

   Examples

                MTREW.  5,

        Rewind the magtape associated with channel 5.

   Related Calls

        FILOP., TAPOP.

   Common Errors

        Including an error return when none exists.

        Forgetting to include a comma after the channel number.






























                                   22-237
   MTSKF. [MTAPE 16]


                             MTSKF. [MTAPE 16]                             MTSKF. [MTAPE 16]



   Function

|       Skips forward one  file  on  a  magtape  device.   Use  FILOP. to
|       perform MTSKF on an extended I/O channel.

   Calling Sequence

                MTSKF.  channo,
                return

                channo        where:  channo is the number  of  a  channel  initialized  for  a
                magtape device.

   Return

        The monitor skips forward one file on the specified device, using
        a series of skip record operations.

   Examples

                MTSKF.  7,

        This call skips over  a  file  on  the  magtape  associated  with
        channel 7.

   Related Calls

        FILOP., TAPOP.

   Common Errors

        Including an error return when none exists.

        Forgetting to include a comma after the channel number.




























                                   22-238
                                                         MTSKR. [MTAPE 6]


                              MTSKR. [MTAPE 6]                              MTSKR. [MTAPE 6]



   Function

|       Skips forward one record on  a  magtape  device.   Use  FILOP. to
|       perform MTSKR. on an extended I/O channel.

   Calling Sequence

                MTSKR.  channo,
                return

                channo        where:  channo is the number  of  a  channel  initialized  for  a
                magtape device.

   Return

        The monitor skips forward one record on the specified device.

   Examples

                MTSKR.  7,

        This call skips a record on the magtape associated  with  channel
        7.

   Related Calls

        FILOP., TAPOP.

   Common Errors

        Including an error return when none exists.

        Forgetting to include a comma after the channel number.





























                                   22-239
   MTUNL. [MTAPE 11]


                             MTUNL. [MTAPE 11]                             MTUNL. [MTAPE 11]



   Function

|       Unloads a magnetic tape.   Use  FILOP. to  perform  MTUNL. on  an
|       extended  I/O  channel.  If the drive is under the control of MDA
        (under GALAXY version 4.1 and later), this call only rewinds  the
        tape.

   Calling Sequence

                MTUNL.  channo,
                return

                channo        where:  channo is the number  of  a  channel  initialized  for  a
                magtape device.

        The MTUNL.   call  initializes  all  automatic  error  reporting.
        Therefore,  reel-specific  errors can be summarized regardless of
        the method used to change reels.  An entry into the system  error
                                 _______________ _____ ______        log  file  (refer to the TOPS-10/TOPS-20 SPEAR Manual) is written
        in the following format:

             Drive number (in the form MTxn)
             SIXBIT/reelid/
             Number of characters read since last MTUNL.
             Number of characters written since the last MTUNL.
             Number of soft-read errors since the last MTUNL.
             Number of hard-read errors since the last MTUNL.
             Number of soft-write errors since the last MTUNL.
             Number of hard-write errors since the last MTUNL.

        These numbers will be output on both the operator's terminal  and
        your terminal (if WATCH MTA is set) in the following format:

             [MTxn:reelid READ (c/h/s)=a/b/c WRITE (c/h/s)=d/e/f]

                x        where:  x is an alphabetic representing the tape controller,

                n                n is a number representing the drive number.

                reelid                reelid is the reel identification.

                a                a is the number of characters read.

                b                b is the number of hard-read errors.

                c                c is the number of soft-read errors.

                d                d is the number of characters written.

                e                e is the number of hard-write errors.

                f                f is the number of soft-write errors.

             a  b      c        When a, b, and c are 0, the information pertaining to  READ  will
        not be printed.

             d  e      f        When d, e, and f are 0, the information pertaining to WRITE  will
        not be printed.




                                   22-240
                                                        MTUNL. [MTAPE 11]


|       To prevent this message from being printed, you can  use  SETUUO,
|       or type the .STWTC function of the following monitor command:

             .SET WATCH NO MTA

   Return

        The monitor rewinds the tape on the specified device.

   Examples

                MTUNL.  7,

        This call rewinds the tape associated with channel 7.

   Related Calls

        FILOP., TAPOP.

   Common Errors

        Including an error return when none exists.

        Forgetting to include a comma after the channel number.










































                                   22-241
   MTUNL. [MTAPE 11]


                                MTWAT. [MTAPE 0]                                MTWAT. [MTAPE 0]



   Function

        Stops program execution until all spacing and I/O operations  for
|       a  magnetic  tape  device  are  completed.  Use FILOP. to perform
|       MTWAT. on an extended I/O channel.  Your program  should  execute
        this call after all tape-positioning operations.

   Calling Sequence

                MTWAT. channo,
                return

                 channo        where:   channo is the number of  a  channel  initialized  for  a
                magtape device.

   Return

                                         return        The monitor resumes execution at return after all spacing and I/O
        operations for the specified device are completed.

   Related Calls

        TAPOP.

   Common Errors

        Including an error return.



































                                   22-242
                                                       MVHDR. [CALLI 131]


                             MVHDR. [CALLI 131]                             MVHDR. [CALLI 131]



   Function

        Allows  you  to  move  the  buffer  ring  control  block  for  an
        initialized  channel  from one location to another.  This move is
        accomplished by  changing  the  monitor's  pointer  to  the  ring
        control block.

   Calling Sequence

                MOVEI   ac,channo
                MOVE    ac+1,[XWD outring,inring]
                MVHDR.  ac,
                  error return
                normal return

                channo        where:  channo is the number of an initialized channel.

                outring                outring is the new address  of  the  output  buffer  ring
                control block, or 0.

                inring                inring is the  new  address  of  the  input  buffer  ring
                control block, or 0.

        outring     inring        outring and inring must be in your current low segment.

        If you give 0 as the address of either buffer ring control block,
        the address is not changed.

   Normal Return

        The pointers to the specified control blocks are changed.

   Error Return

                                                    ac        The following error code is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          1    MVHDR%    Channel not initialized.

        If you specify an illegal address, the monitor halts your job and
        displays the following error message:

             ?Illegal address in UUO at user PC nnnnnn


















                                   22-243
   NODE. [CALLI 157]


                             NODE. [CALLI 157]                             NODE. [CALLI 157]



   Function

        Performs miscellaneous functions associated with  ANF-10  network
        nodes.

   Calling Sequence

                MOVE    ac,[XWD fcncode,addr]
                NODE.   ac,
                  error return
                normal return
                . . .
        addr:   EXP len
                first argument
                . . .
                last argument

                fcncode        Where:  fcncode is one of the function codes described below.

                addr                addr is the address of the argument list.

                len                len is the length of the argument  list  (including  this
                                                      last  argument                word);  and  the  words  up  through  last  argument  are
                arguments for the specified function.

        The function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

          1    .NDALN    Reserved for use by DIGITAL.

          2    .NDRNN    Given either a  node  number  or  a  node  name,
                                                   ac                         returns  the other in the ac.  The argument list
                         for .NDRNN is:

                         addr:   EXP     2
                                 node-id

                               node-id                         Where node-id is the SIXBIT name  or  the  octal
                         node  number of the node.  If you specify a node
                                                                  ac                         name, the node number is returned in the ac.  If
                         you  specify  the  node number, the node name is
                                         ac                         returned in the ac.

          3    .NDSSM    Sends   special    network    station    control
                         (maintenance)  messages.  This function requires
                         that the calling job be logged-in under [1,2] or
                         have  POKE.   privileges.  The argument list for
                         .NDSSM is:

                         addr:   XWD     seconds,4
                                 node-id
                                 XWD     send-bytes,send-buffer
                                 XWD     receive-bytes,receive-buffer

                               seconds                         where seconds is the number of seconds  to  wait
                         before  a  timeout  error (NDTOE%) occurs.  This
                         field is ignored  if  an  input  buffer  is  not
                         specified;  the default is eight seconds if 0 is
                         specified.


                                   22-244
                                                        NODE. [CALLI 157]


        ____   ______    ________        Code   Symbol    Function

                         node-id                         node-id is the SIXBIT node name  or  octal  node
                         number of the node.

                         send-bytes                         send-bytes is the number of 8-bit  bytes  to  be
                         sent.

                         send-buffer                         send-buffer is the address of the first byte  of
                         the message.

                         receive-bytes                         receive-bytes is the  number  of  bytes  in  the
                         receive  buffer.   When  the  receive  buffer is
                                                        receive-bytes                         filled, the monitor will  set  receive-bytes  to
                         the  number  of  bytes  actually  stored  in the
                         buffer.

                         receive-buffer                         receive-buffer is the address of the  buffer  to
                         store the response.

                                                      receive-bytes                         If  the  value  for   both   receive-bytes   and
                         receive-buffer                         receive-buffer is 0, the monitor returns control
                         to your program without waiting for  a  response
                         from the node.

          4    .NDRBM    Receives bootstrap messages from a remote  node.
                         This  function  requires that the calling job be
                         logged-in under [1,2] or have POKE.  privileges.
                         The argument list for .NDRBM is:

                         addr:   EXP     4
                                 0               ;returned node number
                                 0               ;not used
                                 XWD     count,addr

                               count                         where count is the number of 8-bit bytes  to  be
                         received.

                         addr                         addr is the first address  of  the  buffer.   If
                         there   is  a  boot  message  to  be  read,  the
                         following occurs:


                         1.  The second word of  the  argument  block  is
                             filled  in  with the number of the node that
                             sent  the  boot  request   station   control
                             message.

                         2.  The boot request message is copied into  the
                             input buffer.

                         3.  The count field is updated  to  reflect  the
                             actual number of bytes stored.













                                   22-245
   NODE. [CALLI 157]


        ____   ______    ________        Code   Symbol    Function

          5    .NDRCI    Returns the number of devices at each node for a
                         list  of  device  types.   The argument list for
                         .NDRCI is:

                         addr:   EXP     len
                                 node-id
                                 EXP     0       ;reserved
                                 BLOCK   buflength

                               len                         where len is the length  of  the  argument  list
                          len                         (len-1 = number of following arguments).

                         node-id                         node-id is the SIXBIT name of the  node  or  the
                         octal node number.

                                                  node-id                         The word following  the  node-id  must  be  zero
                         because it is reserved for use by DIGITAL.

                         buflength                         buflength is the number of words to reserve  for
                         the returned data.

                         Your program must supply the device types in the
                                                             addr+3                         right half of each word starting at addr+3.  The
                         device types are returned by the DEVTYP call and
                         are  documented  under  that  call.  The monitor
                         returns, in the left halves of these words,  the
                         count  of  devices  whose  type  is given in the
                         right half.  Each word returned will appear as:

                                 XWD device-count,device-type

          6    .NDOUT    Obsolete.

          7    .NDIN     Obsolete.

         10    .NDTCN    Connects remote terminals to the  local  system.
                         The argument list for .NDTCN is:

                         addr:   EXP 2
                                 XWD node,line

                               node                         where node is the octal number of  the  node  to
                         which the terminal is connected.

                         line                         line is the remote line number of  the  terminal
                         to  be  connected.   On  a  normal  return,  the
                         monitor returns the SIXBIT  terminal  number  in
                              ac                         the  ac.   The  normal  return  is  taken if the
                         terminal is connected to the system on which the
                         program  is running.  Therefore, a normal return
                         from this call does not mean that  the  terminal
                         is connected to your job.

         11    .NDTDS    Disconnects a remote  terminal  from  the  local
                         system and, optionally, reconnects it to another
                         host system.  The argument list is:

                         addr:   EXP m
                                 SIXBIT/TTYnnu/
                                 EXP node-number

                               m                         where m is the  length  of  the  argument  block
                         (either 2 or 3).

                                   22-246
                                                        NODE. [CALLI 157]


        ____   ______    ________        Code   Symbol    Function

                         TTYnnu                         TTYnnu  is  the  terminal  name  of  the   local
                         terminal to be reconnected or disconnected.

                         node-number                         node-number is the number of the node  to  which
                         you  wish  the terminal to be reconnected.  This
                         word is optional.

                         On a normal return, the  terminal  specified  by
                         TTYnnu                         TTYnnu  is  disconnected  from the local system.
                              node-number                         If a node-number is specified, the terminal will
                         be  connected  to  that host.  In this case, the
                         action performed is the same as if you issued  a
                         SET HOST monitor command.

         12    .NDLND    Returns the list of defined nodes.  The argument
                         list is:

                         addr:   EXP n
                                 arg1
                                 ...
                                 argn

                               n                         where n is the length of the argument list.

                                                 ac                         On a normal return, the ac contains  the  number
                                            arg1         argn                         of known nodes and arg1 through argn contain the
                         node  numbers  of  the  known  nodes.   If   the
                         argument  block is not long enough to return the
                         complete  list  of  known  nodes,  the  list  is
                         truncated.

         13    .NDNDB    Returns the specified type of information  about
                         a specified node.  The argument list is:

                         addr:   EXP n
                                 node-id
                                 EXP sub-fcn-code
                                 arg1
                                 ...
                                 argn

                               n                         where n is the length of the argument block.

                         node-id                         node-id is either an  octal  node  number  or  a
                         SIXBIT node name.

                         sub-fcn-code                         sub-fcn-code  is  the  sub-function  code   that
                         specifies   the   type   of  information  to  be
                                    arg1         argn                         returned.  arg1 through argn are words that your
                         program reserves for the information returned by
                         the monitor.

                         ____    ______  _______                         Code    Symbol  Meaning

                          1     ND.NNM    Returns the number of the node.

                          2     ND.SNM    Returns the SIXBIT name of  the
                                          node.

                          3     ND.SID    Returns the software ID  as  an
                                          ASCIZ string.



                                   22-247
   NODE. [CALLI 157]


                         ____   ______    _______                         Code   Symbol    Meaning

|                         4     ND.DAT    Returns  the  date   the   NODE
|                                         software  was  generated  as an
                                          ASCIZ string.

                          5     ND.LMA    Returns the last  NCL  (Network
                                          Command    Language)    message
                                          assigned (on output).

                          6     ND.LMS    Returns the  last  NCL  message
                                          sent (on output).

                          7     ND.LAR    Returns  the   last   NCL   ACK
                                          received (on output).

                         10     ND.LAP    Returns  the   last   NCL   ACK
                                          processed (on output).

                         11     ND.LMR    Returns the  last  NCL  message
                                          processed (on input).

                         12     ND.LMP    Returns the  last  NCL  message
                                          received (on input).

                         13     ND.LAS    Returns  the   last   NCL   ACK
                                          message sent.

                         14     ND.MOM    Returns the counter for maximum
                                          outstanding messages.

                         15     ND.TOP    Returns a list of network  link
                                          descriptors of the form:

                                               XWD cost,node

                                                  cost                                          where:  cost is the  line  cost
                                               node                                          and  node is the name of a node
                                          that is connected to  the  node
                                                           addr                                          specified   in   addr+1.    One
                                          descriptor is returned for each
                                          neighboring  node.  A zero word
                                          signifies the end of the list.

                         16     ND.CNF    Returns       the        device
                                          configuration for a node in the
                                          following format:

                                               XWD obj-type,number

                                                   obj-type                                          where:   obj-type  is  the  NCL
                                                            number                                          device  type  and number is the
                                          count  of  devices.   One  such
                                          descriptor is returned for each
                                          type of device on the node.

                         17     ND.CTJ    Returns the station control job
                                          number.

                         20     ND.OPR    Returns the terminal number  of
                                          the OPR terminal.





                                   22-248
                                                        NODE. [CALLI 157]


        ____   ______    ________        Code   Symbol    Function

          14   .NDGNF    Sets or reads  the  "greeted"  node  flag.   The
                         format of the argument list is:

                         addr:   EXP 2
                                 node-number
                                 arg

                                   node-number                         where the node-number is the number of the  node
                         for  which  the "greeted" node flag is to be set
                                                                      arg                         and/or read.  The flag may be specified  in  arg
                                              arg          node-number                         and  is  returned in arg.  If the node-number is
                         specified as 0, the node  number  of  the  first
                                                            addr+1                         "ungreeted"  node  is  returned in addr+1.  This
                         function is intended to be  used  by  privileged
                         programs  that  perform a node-specific function
                         to a node when it comes on line.

   Normal Return

        The function is performed.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          1    NDIAL%    Illegal argument list.
          2    NDINN%    Illegal node name or node number.
          3    NDPRV%    Not enough privileges.
          4    NDNNA%    Node not available.
          5    NDNLC%    Job not locked in core.
          6    NDTOE%    Timeout error.
          7    NDRNZ%    Reserved word is not zero.
         10    NDNND%    Channel not initialized or not a network device.
                                                                       ac         11    NDIOE%    I/O  error  occurred.   The  left  half  of   ac
                         contains  I/O  status  bits.   For a list of I/O
                         status bits, see Volume 1.
         12    NDNFC%    No free core.
         13    NDIAJ%    In use by another job.
         14    NDNMA%    No message available.
         15    NDTNA%    Terminal not available.
         16    NDNLT%    Not a legal terminal.
         17    NDISF%    Illegal sub-function.
         20    NDRBS%    Receive buffer too small.
         21    NDNUG%    No ungreeted nodes.
|        22    NDILN%    Illegal line number in station-control message.
|        23    NDADC%    Address check performed while reading or writing
|                        arguments.















                                   22-249
   NSP. [CALLI 205]


                              NSP. [CALLI 205]                              NSP. [CALLI 205]



   Function

        The NSP.  monitor call enables task-to-task communication between
        programs   running   on   nodes   in   DECnet-10  networks.   The
        communicating programs may be on separate nodes or the same node.
                                                         _________ ______        For information on using this call, refer to the DECnet-10 User's
        _____        Guide.

   Calling Sequence

                MOVEI   ac,addr
                NSP.    ac,
                  error return
                normal return
                . . .
        addr:   argument 1
                argument 2
                argument 3

              addr        Where addr is the address of an argument list appropriate to  the
                                                argument 1        function  code  given  in  bits 9-17 of argument 1.  The function
        codes are:

             ____   ______    _______             Code   Symbol    Meaning

              1     .NSFEA    Enter active state.

              2     .NSFEP    Enter passive state.

              3     .NSFRI    Read connect information.

              4     .NSFAC    Accept connection.

              5     .NSFRJ    Reject connection.

              6     .NSFRC    Read connect confirm information.

              7     .NSFSD    Synchronous disconnect.

             10     .NSFAB    Abort connection.

             11     .NSFRD    Read disconnect data.

             12     .NSFRL    Release the channel.

             13     .NSFRS    Read the channel status.

             14     .NSFIS    Send interrupt data.

             15     .NSFIR    Receive interrupt data.

             16     .NSFDS    Send normal data.

             17     .NSFDR    Receive normal data.

             20     .NSFSQ    Set quotas.

             21     .NSFRQ    Read quotas.




                                   22-250
                                                         NSP. [CALLI 205]


             ____   ______    _______             Code   Symbol    Meaning

             22-23            Reserved for use by DIGITAL.

             24     .NSFPI    Set PSI reasons for software interrupts.

   Normal Return

                                                              ac        The specified function has been  performed  and  the  ac  is  not
        changed.

   Error Return

        On an error return from NSP., one of the following error codes is
                        ac        returned in the ac:

        ____   ______    _____        Code   Symbol    Error

        1      NSABE%    The argument block was formatted incorrectly.
        2      NSALF%    An allocation attempt failed.
        3      NSBCN%    An invalid channel number was specified.
        4      NSBFT%    An illegal format  type  was  specified  in  the
                         process descriptor block.
        5      NSCFE%    The connect block was formatted incorrectly.
        6      NSIDL%    Interrupt data block pointed to a  string  block
                         that was too long.
        7      NSIFM%    Illegal flow control.
        10     NSILF%    Illegal function code specified.
        11     NSJQX%    Job quota exhausted.
        12     NSLQX%    Link quota exhausted.
        13     NSNCD%    No connect data to read.
        14     NSPIO%    Percentage input out of bounds.
        15     NSPRV%    Insufficient  privileges  to  perform  specified
                         function.
        16     NSSTB%    Segment size too big.
        17     NSUKN%    Unknown node name was specified.
        20     NSUXS%    Unexpected or unspecified state.
        21     NSWNA%    Wrong number of arguments.
        22     NSWRS%    Function call while connected in wrong state.
        23     NSCBL%    Wrong length for connect block.
        24     NSPBL%    Wrong length for process block.
        25     NSSBL%    Wrong length for string block.
        26     NSUDS%    Unexpected state:  disconnect sent.
        27     NSUDC%    Unexpected state:  disconnect confirmed.
        30     NSUCF%    Unexpected state:  no confidence.
        31     NSULK%    Unexpected state:  no link.
        32     NSUCM%    Unexpected state:  no communication.
        33     NSUNR%    Unexpected state:  no resources.

        NSP.  error codes 34 to 56 correspond to DECnet disconnect codes.

        34     NSRBO%    Rejected by object.
        35     NSDBO%    Disconnected by object when running.
        36     NSRES%    No resources.
        37     NSUNN%    Unrecognized node name.
        40     NSRNS%    Remote node shut down.
        41     NSURO%    Unrecognized object.
        42     NSIOF%    Invalid object name format.
        43     NSOTB%    Object too busy.
        44     NSABM%    Abort by management.
        45     NSABO%    Abort by object.
        46     NSINF%    Invalid node name format.
        47     NSLNS%    Local node shut down.
        50     NSACR%    Access control rejection.
        51     NSNRO%    No response from object.

                                   22-251
   NSP. [CALLI 205]


        ____   ______    _____        Code   Symbol    Error

        52     NSNUR%    Node unreachable.
        53     NSNLK%    No link.
        54     NSDSC%    Disconnect complete.
        55     NSIMG%    Image field too long.
        56     NSREJ%    Reason for rejection was not specified.
        57     NSBCF%    Invalid combination of NS.EOM and NS.WAI flags.
        60     NSADE%    Address error.

























































                                   22-252
                                                       NTMAN. [CALLI 206]


                             NTMAN. [CALLI 206]                             NTMAN. [CALLI 206]



   Function

        Performs various functions for the network managment layer of the
        DECnet-10  network  product.   This  call is used only by the NML
        program and is not intended for use by  customer  programs.   The
        NTMAN.   call is common to both DECnet-10 and DECnet-20 products,
        and therefore may change at any time without notice.   This  call
        requires JACCT, [1,2], or JP.POK privileges.

   Calling Sequence

                MOVEI   ac,addr
                NTMAN.  ac,
                  error return
                normal return
                . . .
        addr:   len
                entity
                ptr to entity-id
                fcn-code
                info-type
                EXP     0
                ptr to data
                len of data
                BLOCK   1

              addr        where addr is  the  address  of  the  argument  block,  which  is
        formatted as:

        ____   ______    ________        Word   Symbol    Contents

                                                                    len        0      .NTCNT    The number of words in the argument block (len).

                              entity        1      .NTENT    The  entity  on  which  the  action  is  to   be
                         performed.  The types of entities are:

                         ____    ______  _______                         Code    Symbol  Meaning

                         0       .NTNOD  Network node.
                         1       .NTLIN  Communications line.
                         2       .NTLOG  Reserved for DIGITAL use.
                         3       .NTCKT  Circuit.

        2      .NTEID    A byte pointer to an entity identification.  The
                         byte  pointer  must point to a node number, line
                         number, or circuit number.

        3      .NTFCN    Contains the function code.  The function  codes
                         are:

                         ____    ______  ________                         Code    Symbol  Function

                         -2      .NTMAP  Returns  node  number  for  node
                                         name,  or  node  name  for  node
                                         number.

                         -1      .NTREX  Returns the node-id of the local
                                         node.

                         0       .NTSET  Sets a parameter.


                                   22-253
   NTMAN. [CALLI 206]


                         ____    ______  ________                         Code    Symbol  Function

                         1       .NTCLR  Clears a parameter.

                         2       .NTZRO  Zeroes counters.

                         3       .NTSHO  Shows selected items.

                         4       .NTSZC  Shows and zeroes counters.

                         5       .NTRET  Returns a list of entities.

                         6       .NTEVQ  Removes an item from  the  event
                                         queue.

         ____  ______    ________         Word  Symbol    Contents

         4     .NTSEL    Selection criteria for function.  The  following
                         allow  you  to  select  the  item  on  which the
                         function is to be performed:

                         ____    ______  _______                         Code    Symbol  Meaning

                         -3 to -1        Used by .NTRET:

                         -3      .NTLOP  Loop.

                         -2      .NTACT  Active items.

                         -1      .NTKNO  Known items.

                         0 to 4          Used by .NTSHO:

                         0       .NTSUM  Summary.

                         1       .NTSTA  Status.

                         2       .NTCHA  Characteristics.

                         3       .NTCOU  Counters.

                         4       .NTEVT  Reserved for DIGITAL use.

        5      .NTQUA    Reserved for DIGITAL use.

        6      .NTBPT    Byte pointer to data.

        7      .NTBYT    Byte count for data.

        10     .NTERR    Returned information or error code.

|       11     .NTMAX    Quantity to place in .NTCNT.

   Normal Return

        The requested information is returned in the address  pointed  to
        by .NTERR, or data is changed according to the function code.  On
        a successful return, error code 1 (NESUC%) is returned in .NTERR.








                                   22-254
                                                       NTMAN. [CALLI 206]


   Error Return

                                          ac        The error code is returned in the ac and  in  the  .NTERR  offset
        into  the argument block.  Note that a successful return from the
        call places error code 1 (NESUC%) into the offset .NTERR into the
                                                                 ac        argument block, and error NEADC% is returned only in the ac.  The
        error codes for NTMAN.  are defined with decimal values and are:

        ____   ______    _____        Code   Symbol    Error

        1      NESUC%    Successful call.
        -1     NEUFO%    Invalid function or option.
        -2     NEIMF%    Invalid message format.
        -3     NEPRV%    Insufficient privileges.
        -4               Reserved for use by DIGITAL
        -5     NEMPE%    Management program error.
        -6     NEUPT%    Invalid parameter.
        -7               Reserved for use by DIGITAL
        -8     NEURC%    Invalid entity.
        -9     NTINI%    Invalid entity identifier.
        -10    NELCE%    Line communication error.
        -11    NECWS%    Component in wrong state.
        -12 to -14       Reserved for use by DIGITAL.
        -15    NERES%    Resource error.
        -16    NEIPV%    Invalid parameter value.
        -17 to -19       Reserved for use by DIGITAL.
        -20    NENRM%    No room, or slot already taken.
        -21              Reserved for use by DIGITAL.
        -22    NEPNA%    Parameter not applicable to entity.
        -23    NEPVL%    Parameter value too long.
        -24              Reserved for use by DIGITAL.
        -25    NEOPF%    Operational failure.
        -26    NEFNS%    Function not supported.
        -27    NEIPG%    Invalid parameter grouping.
        -28              Reserved for use by DIGITAL.
        -29    NEPAM%    Parameter missing from argument list.
        -30 to -46       Reserved for use by DIGITAL.
                                                    ac        -47    NEADC%    Address check (returned in ac only).




























                                   22-255
   OPEN [OPCODE 050]


                             OPEN [OPCODE 050]                             OPEN [OPCODE 050]



   Function

|       Initializes a channel for I/O operation.  Use FILOP. to assign an
|       extended I/O channel.

   Calling Sequence

               OPEN      channo,addr
                 error return
               normal return
               . . .
        addr:  argument list

                channo        Where:  channo is the number of a channel.

                addr                addr is the address of the argument list.   The  argument
                list is:

        ____   ______    ________        Word   Symbol    Contents

           0   .OPMOD    Flags and status bits.  The I/O status bits  are
                         a  set  of 18 bits (right halfword) that reflect
                         the current state of a file transmission.   They
                         are  initially  set  by  your  program  with the
                         INIT/OPEN monitor call.  Thereafter, the monitor
                         sets  the  bits,  but  your program can test and
                         reset them using any of several monitor calls.

                         ____   ______    _______                         Bits   Symbol    Meaning

                            0   UU.PHS    Only physical device names will
                                          be  used  in  the  search.  All
                                          logical names  defined  by  the
                                          job will be ignored.

                            1   UU.DEL    Disables  error  logging;  only
                                          user-mode  diagnostic  programs
                                          may set this bit.

                            1   UU.FSP    Specifies  a  full  SCNSER  PTY
                                          (pseudo-terminal).    That  is,
                                          all  terminal   characteristics
                                          that  are  normally ignored for
                                          PTYs will be set and  enforced.
                                          Refer to Chapter 15.

                            2   UU.DER    Disables  error   retry;   only
                                          user-mode  diagnostic  programs
                                          may set this bit.

                            2   UU.BJP    If the given device is  a  PTY,
                                          and  if  the calling program is
                                          privileged, this bit  specifies
                                          that  jobs  logging on this PTY
                                          are  to  be  treated  as  batch
                                          jobs.






                                   22-256
                                                        OPEN [OPCODE 050]


                         ____   ______    _______                         Bits   Symbol    Meaning

                            2   UU.DMR    Disables  message  re-assembly.
                                          This  bit  is  used  in  ANF-10
                                          intertask   communication    to
                                          allow  the  receipt of messages
                                          that do not have  the  EOM  bit
                                          set.   This  flag should be set
                                          if  UU.AIO  is  set   for   TSK
                                          devices.  (Refer to Chapter 5.)

                            3   UU.AIO    I/O   is   nonblocking.    This
                                          prevents   the   monitor   from
                                          stopping your job to  wait  for
                                          I/O to be completed.

                            4   UU.IBC    Disables  clearing  of  buffers
                                          after    each   output.    Your
                                          program must also set BF.IBC in
                                          the  .BFADR  word of the buffer
                                          ring    header.     (This    is
                                          applicable   to   buffered  I/O
                                          only.  Refer to Chapter 11.)

                            5   UU.SOE    Enables synchronization on each
                                          I/O  error.   The  monitor does
                                          not perform more I/O until your
                                          program clears the error bits.

                            6   UU.RRC    Enables  automatic  rewrite  of
                                          RIB   on   change.    This  bit
                                          pertains only to disk  devices,
                                          causing  the monitor to rewrite
                                          the  file's  RIB   whenever   a
                                          change to the file requires it.
                                          This is  used  to  ensure  file
                                          integrity   in   the  event  of
                                          system failure.

                            7   UU.LBF    Allows the use of large buffers
                                          (multiples  of  one  block) for
                                          disk I/O on this channel.

                         8-14   UU.DEC    Reserved for use by DIGITAL.

                        15-17   UU.CUS    Reserved for use by customers.

                        18-21   IO.ERR    Error flags:

                                ____   ______    _____                                Flag   Symbol    Error

                                 18    IO.IMP    Improper mode flag.
                                 19    IO.DER    Error    detected     by
                                                 device.
                                 20    IO.DTE    Hard data error.
                                 21    IO.BKT    Block too large.

                           22   IO.EOF    End-of-file reached.

                           23   IO.ACT    I/O active.






                                   22-257
   OPEN [OPCODE 050]


                         ____   ______    _______                         Bits   Symbol    Meaning

                        24-29             Device-dependent  flags   (some
                                          flags    are    repeated    for
                                          different devices).   Refer  to
                                          the  appropriate device chapter
                                          in   Volume    1    for    more
                                          information.

                                ____   ______    _______                                Flag   Symbol    Meaning

                                 24    IO.BOT    Beginning    of     tape
                                                 encountered     (magtape
                                                 only).

                                 24    IO.PTI    Subjob  is  in  terminal
                                                 input  wait  state  (PTY
                                                 only).

                                 25    IO.EOT    End of tape  encountered
                                                 (magtape only).

                                 25    IO.PTO    Subjob  is  in  terminal
                                                 output  wait  state (PTY
                                                 only).

                                 25    IO.ABS    Enable user  break  mask
                                                 (terminals only).

                                 26    IO.PAR    Parity  of  tape,  where
                                                 IO.PAR=1     for    even
                                                 parity.    Odd    parity
                                                 (IO.PAR=0)  is used only
                                                 for   EBCDIC    labelled
                                                 tapes (magtape only).

                                 26    IO.PTM    Subjob  is  in   monitor
                                                 mode (PTY only).

                                 26    IO.BKA    Break on all  characters
                                                 (terminals only).

                                 27    IO.TEC    Truth  in  echoing  mode
                                                 (terminals only).

                                 27    IO.MAI    Maintenance   DMR   mode
                                                 (KDP   and  DTE  devices
                                                 only).

                                 26-28 IO.DEN    Bit   mask   for    tape
                                                 density, where:
                                                      0 = standard
                                                      1 = 200
                                                      2 = 556
                                                      3 = 800
                                                 For  densities  of  1600
                                                 and    6250,    IO.DEN=0
                                                 (magtape  only).    This
                                                 flag  is  obsolete.  Use
                                                 TAPOP.   to   set   tape
                                                 density.

                                 28    IO.SSD    Semi-standard data  mode
                                                 (DECtape devices only).


                                   22-258
                                                        OPEN [OPCODE 050]


                                ____   ______    _______                                Flag   Symbol    Meaning

                                 28    IO.SUP    Suppress         echoing
                                                 (terminals only).

                                 29    IO.D29    DEC029 mode (card  punch
                                                 only).

                                 29    IO.SIM    Super-image  mode  (card
                                                 reader only).

                                 29    IO.WHD    Write disk-pack  headers
                                                 (disk only).

                                 29    IO.NSD    Non-standard  data  mode
                                                 (DECtape devices only).

                                 29    IO.SFF    Suppress   form    feeds
                                                 (line printers only).

                                 29    IO.NRC    Read  with   no   reread
                                                 check (magtape only).

                                 29    IO.FCS    Obsolete      (terminals
                                                 only).

                                 29    IO.LEM    Line     editor     mode
                                                 (terminals only).

                           30   IO.SYN    Synchronous input.

                           31   IO.UWC    Uses  user  word   count.    By
                                          default  this  bit  is not set,
                                          and the  monitor  computes  the
                                          amount    of    data    to   be
                                          transmitted  using   the   byte
                                          pointer  in  the buffer header.
                                          If this flag is  set,  however,
                                          the   monitor   uses  the  byte
                                          count.  Meaningful  for  output
                                          only.

                        32-35   IO.MOD    Data mode.  In  general,  modes
                                          0-14  are  considered "buffered
                                          I/O modes" and modes 15-17  are
                                          "dump  I/O modes." The possible
                                          values  for   the   data   mode
                                          (IO.MOD) in .OPMOD are:

                                _____  ______    _______                                Value  Symbol    Meaning

                                 0     .IOASC    ASCII  mode   (for   any
                                                 device except display).

                                 1     .IOASL    ASCII line mode (for any
|                                                device except display).

                                 2     .IOPIM    Packed    image     mode
                                                 (terminal only).

                                 3     .IOBYT    Byte    mode    (magtape
                                                 device only).




                                   22-259
   OPEN [OPCODE 050]


                                _____  ______    _______                                Value  Symbol    Meaning

|                                4     .IOAS8    8-bit     ASCII     mode
|                                                (terminal,
|                                                pseudo-terminal,     and
|                                                line printers only).

                                 5               Reserved  for   use   by
                                                 DIGITAL.

                                 6-7             Reserved  for   use   by
                                                 customers.

                                 10    .IOIMG    Image  mode   (for   any
                                                 except display device).

                                 11-12           Reserved  for   use   by
                                                 DIGITAL.

                                 13    .IOIBN    Image binary  mode  (for
                                                 disk,  DECtape, magtape,
                                                 plotter, card device, or
                                                 papertape device).

                                 14    .IOBIN    Binary  mode  (for  same
                                                 devices as .IOIBN).

                                 15    .IOIDP    Image  dump  mode   (for
                                                 display devices only).

                                 16    .IODPR    Dump  record  mode  (for
                                                 disk,     DECtape,    or
                                                 magtape devices).

                                 17    .IODMP    Dump  mode  (for   disk,
                                                 DECtape,    or   magtape
                                                 devices).
        ____   ______    ________        Word   Symbol    Contents

           1   .OPDEV    SIXBIT physical or logical name or  UDX  of  the
                         device to be initialized on the channel or UDX.

           2   .OPBUF    Buffer addresses (used for buffered I/O only):

                         ____    _______                         Bits    Meaning

                          0-17   Address of the  control  block  for  the
                                 output  buffers  for  the given channel.
                                 If buffered  I/O  is  not  to  be  used,
                                 specify  0  for the buffer control block
                                 address.

                         18-35   Address of the  control  block  for  the
                                 input buffers for the given channel.  If
                                 buffered I/O is not to be used,  specify
                                 0 for the buffer control block address.










                                   22-260
                                                        OPEN [OPCODE 050]


   Normal Return

        The specified channel is initialized.

   Error Return

        The monitor takes the error return if the specified device is  in
        use,  if  the  device  does  not  exist,  or  if  the  device  is
        restricted.  To assign a restricted device, use the MOUNT monitor
        command before running the program, or use the .QUMNT function of
        the QUEUE. call.























































                                   22-261
   OPEN [OPCODE 050]


   Examples

        ;Subroutine to OPEN the disk in dump mode
        ;Call with:
        ;       PUSHJ    P,DMPINI
        ;       RETURN HERE

        DMPINI: OPEN     DSK,OPNBLK     ;OPEN the disk on channel "DSK"
                  JRST   NOTAVL         ;Device is busy
                ENTER    DSK,FILE       ;Create a new file
                  JRST   FILBAD         ;Cannot ENTER file name in
                                        ;  disk directory.
                POPJ     P,             ;Return - file is now open for
                                        ;  Dump mode output.

        ;Here if device DSK:  cannot be OPENed
        NOTAVL: OUTSTR   [ASCIZ "?CANNOT OPEN DSK:
        "]                              ;Print an error message
                EXIT                    ;Return to the monitor

        ;Here if file cannot be created
        FILBAD: OUTSTR   [ASCIZ "?CANNOT CREATE DSK:DUMP.BIN
        "]                              ;Print an error message
                EXIT                    ;Return to the monitor

        OPNBLK: EXP      .IODMP         ;Select dump mode
                SIXBIT   /DSK/          ;Device name
                EXP      0              ;No buffers

        FILE:   SIXBIT   /DUMP/         ;File name
                SIXBIT   /BIN/          ;File name extension
                EXP      0              ;Default protection
                EXP      0              ;Default directory

        ;Subroutine to write data in buffer
        ;Call with:
        ;       FILL BUFFER WITH DATA
        ;       PUSHJ    P,DMPOUT
        ;       RETURN HERE

|       DMPOUT: OUT      DSK,OUTLST     ;Write data
                  POPJ   P,             ;No errors - Return to caller
                OUTSTR   [ASCIZ "?OUTPUT ERROR FOR DSK:DUMP.BIN
        "]                              ;Output error message
                EXIT                    ;Return to monitor

        ;Command list for output
        OUTLST: IOWD     BUFSIZ,BUFFER  ;Write BUFSIZ words from buffer
                EXP      0              ;End of command list

        BUFFER: BLOCK    BUFSIZ         ;Output buffer

        ;Subroutine to close out file
        ;Call with:
        ;       PUSHJ    P,DMPDON
        ;       RETURN HERE
        ;

        DMPDON: CLOSE    DSK,           ;Write the end of file
                STATO    DSK,IO.ERR     ;Are there any errors?
                  POPJ   P,             ;No-return
                OUTSTR   [ASCIZ "?ERROR CLOSING DSK:DUMP.BIN
        "]                              ;Print error message
                EXIT                    ;Return to the monitor


                                   22-262
                                                        OPEN [OPCODE 050]


   Related Calls

        FILOP., INIT































































                                   22-263
   OTHUSR [CALLI 77]


                             OTHUSR [CALLI 77]                             OTHUSR [CALLI 77]



   Function

        Determines  whether  other  jobs  are  logged   in   under   your
        project-programmer number (PPN).

   Calling Sequence

                OTHUSR  ac,
                  alternate return
                normal return

   Normal Return

            ac        The ac contains your project-programmer number; the normal return
        occurs  only  if  there  are  other  jobs  logged  in  under your
        project-programmer number.

   Alternate Return

        The alternate return is taken if no  other  jobs  are  logged  in
        under your project-programmer number.

   Examples

                OTHUSR  T1,
                  JRST  ONLY1

        If other jobs are logged in under your project-programmer number,
        execution continues.  If not, control is passed to ONLY1.

































                                   22-264
                                                         OUT [OPCODE 057]


                              OUT [OPCODE 057]                              OUT [OPCODE 057]



   Function

        Transmits data from your job's physical memory area to  the  file
|       selected for the given channel.  Use FILOP. to perform an OUT UUO
|       on an extended I/O channel.

   Calling Sequence

                OUT     channo,addr
                normal return
                  error return

                channo        Where:  channo is the number of an initialized channel.

                                  addr                In buffered mode, addr contains the address of the .BFHDR
                                                                     addr                (header) word of the buffer to be used.  If you give addr
                as 0, the next buffer is used.

                              addr                In dump mode, addr is the address of the  first  word  of
                the command list.  See IN call.

   Normal Return

                                  addr+1        The data in the buffer at addr+1 is transferred.

   Error Return

        If an error occurs, you should examine the  I/O  status  bits  to
        determine  the cause of the error.  Use the GETSTS call to obtain
        I/O status bits.


                                      NOTE

                If, while using non-blocking  I/O,  your  program
                takes  the  error  return with no error bits set,
                that indicates you  have  exhausted  all  of  the
                output  buffers.   You  must  wait until a buffer
                becomes available.  The  program  at  this  point
                should  not  attempt to store any more data based
                on the state  of  the  use  bit.   Instead,  keep
                trying the OUT call until it succeeds.


   Examples

        See Chapter 11.

   Related Calls

        FILOP., IN, INPUT, OUTPUT











                                   22-265
   OUT [OPCODE 057]


   Common Errors


         o  If the specified address is illegal, the  monitor  stops  the
            job and prints:

                 ?Address check for device YYYYYY:;UUO at user PC xxxxx

         o  Failure to supply a command list address in dump mode.

         o  Forgetting to initialize the channel.























































                                   22-266
                                                      OUTBUF [OPCODE 065]


                            OUTBUF [OPCODE 065]                            OUTBUF [OPCODE 065]



   Function

        Sets up an output  buffer  ring  with  the  specified  number  of
|       buffers  for  the  specified  initialized channel.  Use FILOP. to
|       perform an OUTBUF for an extended I/O channel.
|  
|                                     NOTE
|  
|               The  monitor  allocates  buffers  in  the  user's
|               address space starting at the location pointed to
|               by the contents of .JBFF.  This has no meaning in
|               a non-zero section, unless that section is mapped
|               to section 0.  Use the FILOP.   monitor  call  to
|               specify  buffer  starting addresses in a non-zero
|               section.
|  

   Calling Sequence

                OUTBUF channo,bufcnt
                return

                channo        Where:  channo is the number of an initialized channel.

                bufcnt                bufcnt is the number of buffers to set up  in  the  ring.
                               buffers                If  you  give  buffers as 0, the monitor uses its default
                number of buffers for  the  ring.   This  default  varies
|               according  to  the  device and for disks, and is a MONGEN
                parameter that can also  be  set  with  the  SET  DEFAULT
                BUFFERS monitor command.

   Return

        The buffer ring is set up.

   Related Calls

        FILOP., INBUF

|  Common Errors
|  
|       See the INBUF call for some common errors and their explanations.




















                                   22-267
   OUTCHR [TTCALL 1,]


                             OUTCHR [TTCALL 1,]                             OUTCHR [TTCALL 1,]



   Function

        Sends an ASCII character to the job's controlling terminal.

   Calling Sequence

                OUTCHR location
                return

                location        Where:  location is the address of the word containing the output
                character; the ASCII code for the character is taken from
                              location                bits 29-35 of location.

   Return

                                                            location        The monitor takes an ASCII code from bits 29-35 of  location  and
        displays the character on the user terminal.

   Related Calls

        OUTSTR, TRMOP.

   Common Errors

                                 location         o  Typing a comma after location.

         o  Assuming OUTCHR takes an immediate  value  in  the  effective
            address field.


































                                   22-268
                                                      OUTPUT [OPCODE 067]


                            OUTPUT [OPCODE 067]                            OUTPUT [OPCODE 067]



   Function

|       Sends data from memory to an initialized channel.  Use  FILOP. to
|       perform  an  OUTPUT  for  an  extended  I/O  channel.  The OUTPUT
        monitor call is the same as the OUT monitor call, except that OUT
        takes  the  error  return  if  any  error bits are set in the I/O
        status word, and OUTPUT ignores the error bits and has  only  one
        return location.

   Calling Sequence

                OUTPUT channo,addr
                return

                channo        Where:  channo is the number of an initialized channel.

                addr                addr is one of the following:

                 o  If the channel was initialized for  dump  mode,  then
                    addr                    addr is the address of an I/O command list.

                 o  If the channel was  initialized  for  buffered  mode,
                          addr                    then  addr  is  the address of the second word of the
                    next buffer to be used; if you  give  0  (the  normal
                    case), the next buffer in the ring is used.

   Return

        Data is output to the device on the channel.


   Related Calls

|       IN, INPUT, OUT, FILOP.

   Common Errors

        Same as IN call.
























                                   22-269
   OUTSTR [TTCALL 3,]


                             OUTSTR [TTCALL 3,]                             OUTSTR [TTCALL 3,]



   Function

        Sends an ASCIZ string to the user terminal.

   Calling Sequence

                OUTSTR  addr
                return
                . . .
        addr:   ASCIZ/string/

                addr        Where:  addr is the address of the ASCIZ string to  be  displayed
                                    string                on the terminal and string is the string to be sent.

   Return

        The string is displayed on the user terminal.

   Examples

        See OPEN call.

   Related Calls

        OUTCHR, TRMOP.

   Common Errors

                             addr        Typing a comma after addr.

































                                   22-270
                                                        PAGE. [CALLI 145]


                             PAGE. [CALLI 145]                             PAGE. [CALLI 145]



   Function

        Manipulates pages and the data associated  with  those  pages  in
        your job's address space.

   Calling Sequence

                MOVE    ac,[XWD fcncode,addr]
                PAGE.   ac,
                  error return
                normal return
                . . .
        addr:   len
                first argument
                . . .
                last argument

                fcncode        where:  fcncode is one of the function codes described below.

                addr                addr is the address of the argument list.

                len                len is the number of words that follow  in  the  argument
                                                      last  argument                list;   and  the  words  up  through  last  argument  are
                arguments for the given function, usually page numbers of
                                                              len                memory pages being manipulated.  The value of len must be
                greater than 2 or the negative of a value greater than 2.

                    len                The len can be specified as a negative  value.   In  this
                case,  only  one  argument follows.  That argument is the
                page number of the first page in a  set,  where  the  set
                contains  that  page plus the number of consecutive pages
                                                           len                indicated by the value.  For example, when len contains a
                negative  value  (such as -3), the argument (for example,
                page number 401), is the first  of  3  consecutive  pages
                (for  this  example,  pages  401,  402  and  403),  to be
                manipulated.

                The pages you can specify are restricted by the following
                attributes:

                 o  Page zero cannot be paged out or destroyed.

                 o  If the high segment is sharable, it cannot  be  paged
                    out.

                 o  If the page is a SPY page, it cannot be paged out.

                 o  If a page is locked in core, it cannot be paged out.














                                   22-271
   PAGE. [CALLI 145]


        The function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

          0    .PAGIO    Swaps a page in or out.  Pages  swapped  in  are
                         added  to the working set; pages swapped out are
                         moved to secondary storage.

                         Use one word in the argument list for each  page
                         to be swapped, or specify a negative list length
                         to specify a set of consecutive pages.   If  you
                         use  more  than  one  argument  word,  the  page
                         numbers  must  be  in  ascending  order.    Each
                         argument word is in the form:

                                 XWD     flags,pageno

                                 pageno                         where:  pageno is the number of the page  to  be
|                        swapped  (in the range 0-511 on a KS, or 0-16383
                                        flags|                        on a KL)  and  flags  is  one  or  both  of  the
                         following:

                         ___    ______    _______                         Bit    Symbol    Meaning

                           0    PA.GAF    Swap the page out if  this  bit
                                          is set; swap it in if not set.
                           1    PA.GSL    Swap to slow swapping space  if
                                          this  bit  is set; swap to fast
                                          space if not set.
|                          2    PA.GDC    Suppresses error codes  PAGCE%,
|                                         PAGME%, PAGSC%, and PAGSM%.

          1    .PAGCD    Creates or destroys a specified page.   Use  one
                         argument  word  for  each  page to be created or
                         destroyed.  If you use more than one  word,  the
                         specified  pages  must  be  in  ascending order.
                         Each argument word is of the form:

                                 XWD     flags,pageno

                                 pageno                         where:  pageno specifies the number of the  page
|                        (in the range 0-511 on a KS, or 0-16383 on a KL)
                                                        flags                         to be created or destroyed and flags is  one  or
                         both of the following:

                         ___    ______    _______                         Bit    Symbol    Meaning

                           0    PA.GAF    Destroy the page if this bit is
                                          set;  create  the  page if this
                                          bit is not set.
|                          1     PA.GDC   Create the page on disk if this
                                          bit  is  set;  create a page in
                                          the working set if this bit  is
                                          not set.












                                   22-272
                                                        PAGE. [CALLI 145]


        ____   ______    ________        Code   Symbol    Function

          2    .PAGEM    Moves or exchanges a page.  The  page  is  moved
                         from  one  virtual  address  to  another, or two
                         pages exchange locations.   You  cannot  move  a
                         page  to a location that is allocated to another
                         page and you cannot exchange  pages  unless  the
                         source pages are allocated.

                         Use one argument word for each page to be  moved
                         or exchanged.  If you use more than one argument
                         word, the specified pages must be  in  ascending
                         order.  Each argument word is of the form:

                                 <flag>+<source>B17+<destination>B35

                                 source                         where:  source is the page number of the page to
                                    destination                         be  moved, destination is the page number of the
                         location to receive the page, and the  following
                         flag                         flag can be set:

                         ____   ______    _______                         Flag   Symbol    Meaning

                           0    PA.GAF    Exchange the pages if this  bit
                                          is set; move the source page if
                                          this bit is not set.

          3    .PAGAA    Sets or clears  the  access-allowed  bit  for  a
                         page.  The access-allowed bit may be changed for
                         any page in the  working  set.   If  a  page  is
                         accessed  that  has  this  bit off, a page fault
                         occurs.

                         Use  one  argument  word  for  each  page  whose
                         access-allowed bit is to be changed.  If you use
                         more than one argument, the specified pages must
                         be in ascending order.  Each argument word is of
                         the form:

                                 XWD     flags,pageno

                                 pageno                         where:  pageno is the page number  of  the  page
                                                           flag                         whose  bit  is to be changed, and flag is one or
|                        more of the following:

                         ____   ______    _______                         Flag   Symbol    Meaning

                           0    PA.GAF    Clear  access-allowed  for  the
                                          page  if  this  bit is set; set
                                          access-allowed if this  bit  is
                                          not set.
                           1    PA.GSA    Automatically              sets
                                          access-allowed  on  page fault;
                                          dispatch  to  page  handler  on
                                          page  fault  if this bit is not
                                          set.
|                          2    PA.GDC    Ignores fact that page does not
|                                         exist,  suppressing  error code
|                                         PAGME%.







                                   22-273
   PAGE. [CALLI 145]


        ____   ______    ________        Code   Symbol    Function

          4    .PAGWS    This function returns a bit map of  those  pages
                         in  the current working set.  In the PAGE. call,
                         you specify the number of words that are  to  be
|                        returned.   There  is  one bit for each possible
                         page.  If a bit is set, the page associated with
                         that  bit  is  a  part  of the working set.  For
                         example, Word 1  contains  the  bits  associated
                         with  pages  0  through  35; Word 2 contains the
                         bits associated with pages 36 through 71, and so
|                        on.   The  end of the bit map does not end on an
|                        integral word boundary, so the last word in  the
|                        map  is  padded  with  zeroes.   The bit map for
|                        another section begins on a new word.

          5    .PAGGA    Returns a bit map indicating  which  pages  have
                         their access-allowed bits set.  This bit map has
                         the same format as the one returned for function
                         code  4  (.PAGWS).   If a bit in the map is set,
                         the page associated with that bit is accessible.
                         In  the  PAGE. monitor  call,  you  specify  the
                         number of words in the bit map that  are  to  be
                         returned.

          6    .PAGCA    Determines the type  of  access  allowed  for  a
                         given   page.    There  is  no  argument  block;
                         instead, you specify the function  code  in  the
                                              ac                         left  half  of  the  ac (bits 0-17) and the page
                                                         ac                         number in the right half of the ac (bits 18-35):
                         [function,,page-number].   On  a  normal return,
                         the monitor will set one or  more  of  the  bits
                         listed below:

                         ____   ______    _______                         Bits   Symbol    Meaning

                           0    PA.GNE    Page does not exist.
                           1    PA.GWR    Writable page.
                           2    PA.GRD    Readable page.
                           3    PA.GAA    Access allowed.
                           4    PA.GAZ    Allocated page, but zero.
                           5    PA.GCP    Page cannot be paged out.
                           6    PA.GPO    Page is paged out.
                           7    PA.GHI    Page is in high segment.
                           8    PA.GSH    Page is sharable.
                           9    PA.GSP    Page  is  SPYing  (mapped  onto
                                          running monitor).
                          10    PA.GLK    Page is locked in memory.
|                         11    PA.GNC    Page is not  cached  (KL10  and
|                                         KS10 only).
|                         12    PA.GSN    Section does not exist.
|                         13    PA.GVR    Page is virtual (SPY page).
|                         14    PA.GIN    Page is in an indirect section,
|                                         that  is, a section mapped onto
|                                         another section.
|                         15              Reserved for use by DIGITAL.
|                      16-20    PA.GSC    Section  is  independent,  that
|                                         is,   a  section  that  another
|                                         section is mapped onto.  PA.GIN
|                                         must  be  set  for PA.GSC to be
|                                         set.
|                         21              Reserved for use by DIGITAL.
|                      22-35    PA.GPN    Page number the SPY page  which
|                                         the   specified  user  page  is
|                                         SPYing on.

                                   22-274
                                                        PAGE. [CALLI 145]


        ____   ______    ________|       Code   Symbol    Function
|  
|         7    .PAGCH    Changes the pages in a high segment, or  creates
                         a  high  segment from a contiguous collection of
                         pages.  The argument block  is  written  in  the
                         following format:

                           addr:  Number of words following.
                         addr+1:  Number of pages to be remapped.
                         addr+2:  Start page number.
                         addr+3:  Destination page number.

                         addr+3                         addr+3 is  an  optional  word  of  the  argument
                         block.   If  not specified, page 400 is assumed.
                         This function waits for all I/O to  stop  before
                         creating  the high segment.  On a normal return,
                         the specified pages are REMAPped into  the  high
                         segment,   which   begins  at  destination  page
                         number.  The error return is taken if all of the
                         pages  specified by start page number and number
                         of pages to be remapped do not exist,  or  if  a
                         page included in the list already exists in your
|                        program's address space.  If the number of pages
|                        specified  is negative, those pages are remapped
|                        from the low segment to the  high  segment,  and
|                        appended  to  the  existing hi-seg.  Note that a
|                        sharable  high  segment  cannot  be  created  or
|                        affected  with  this function code.  If only one
|                        argument is given, the number of pages specified
|                        is deleted from the end of the high segment.

         10    .PAGCB    Sets or clears  the  cache  bit  for  the  page.
                         (This  flag  is  automatically  set if PA.GAF is
                         on.) This function sets or clears the cache  bit
|                        on  a  per-page basis (KL10 and KS10 only).  The
                         argument word format is as follows:

|                        Bit 0       If this bit,  PA.GAF,  is  set,  the
                                     cache    bit    is    set   in   the
                                     corresponding  entry  in  the  job's
                                     page  map.   If clear, the cache bit
                                     is clear.
|                        Bit 1       This bit, PA.GDC, ignores  the  fact
|                                    that    a    page   doesn't   exist,
|                                    suppressing error code PAGME%.
|                        Bits 2-26   Reserved.
                         Bits 27-35  The page number.

                         If there is more than one argument word  in  the
                         argument  block,  the  page numbers specified in
                         those words must be in ascending numeric  order.
                         The   error  return  is  taken  if  any  of  the
                         following are true:

                          o  The function or call is not implemented.

                          o  A high segment  page  is  specified  in  the
                             argument list.

                          o  The argument list is not set up properly.
|  
|                         o  The job is not locked in core.




                                   22-275
   PAGE. [CALLI 145]


        ____   ______    ________        Code   Symbol    Function

         11    .PAGSP    Allows your program to map an arbitrary  set  of
                         pages  from memory or from the monitor's virtual
                         address space into the program's address  space.
                         Use  one  argument  word  for  each  page  to be
                         mapped.  If you use more than one argument word,
                         you  must  specify the pages in ascending order.
                         The argument word is formatted as follows:

|                             <flags>+<source>B17+<destination>B35

                               flags|                        where flags are one or more of the following:

                         ___    ______    _______                         Bit    Symbol    Meaning

                           0    PA.GAF    Remove the page from the user's
                                          addressing  space.  If not set,
                                          add the  monitor  page  to  the
                                          user's  addressing space at the
                                          specified page number.

|                          1    PA.GDC    On  a  create,  this  bit  will
|                                         overlay   an  already  existing
|                                         page.  On a delete, if the page
|                                         does  not  exist, it is ignored
|                                         and  error   code   PAGME%   is
|                                         suppressed.

                         source                         source is the page number of  the  source  page.
                         If  UU.PHY  is  set  in  the  PAGE. monitor call
                                 source                         itself, source is a physical page in memory.  If
                                              source                         UU.PHY  is  not set, source is a monitor virtual
                         address mapped through the executive page map.

                         destination                         destination is the page number of the page to be
                         mapped into your address space.

                         This function requires that the calling job have
                         PEEK privileges on all of core.

|        12    .PAGSC    Creates or destroys a  specified  section.   Use
|                        one argument word for each section to be created
|                        or destroyed.   For  more  than  one  word,  the
|                        sections  or  arguments  must  be  specified  in
|                        ascending order.  Each argument word is  of  the
|                        form:
|  
|                             XWD <flag>+<source>B17+<destination>B35
|  
|                        where flag is one of the following:
|  
                         ____   ______    _______|                        Bits   Symbol    Meaning
|  
|                          0    PA.GSF    Delete  the   section   if   it
|                                         exists,  create  the section if
|                                         it does not exist.
|  
|                          1    PA.GMS    Map the sections  specified  in
|                                         PA.GSS and PA.GDS together.
|  
|                          2    PA.GDC    On  a  create,   any   existing
|                                         section   is   emptied.   On  a
|                                         delete, ignore  a  non-existant
|                                         section.

                                   22-276
                                                        PAGE. [CALLI 145]


        ____   ______    ________|       Code   Symbol    Function
|  
|                        If  PA.GMS  is  set,   give   the   source   and
|                        destination sections using the following format:
|  
                         ____   ______    _______|                        Bits   Symbol    Meaning
|  
|                         4-17  PA.GSS    The  section  number   of   the
|                                         source section.
|  
|                        18-22            Reserved for use by DIGITAL.
|  
|                        22-35  PA.GDS    The  section  number   of   the
|                                         destination section.
|  
        ____   ______    ________|       Code   Symbol    Function
|  
|        13    .PAGBM    Returns  a  bit  map  that   indicates   whether
|                        specified  page  accessibility attributes belong
|                        to a certain page.  If, in the return,  the  bit
|                        map  is  set  on,  the  page  has  the specified
|                        attributes.
|  
|                        Each argument word is of the form:
|  
|                             EXP   count
|                             EXP   attribute-settings
|                             EXP   care-mask
|                             EXP   starting-page-no
|  
|                        where:
|  
|                        count is the number of arguments.
|  
|                        attribute-settings is the  word  indicating  the
|                        desired  state of the given attribute.  The page
|                        accessibility attribute bits  are  the  same  as
|                        those given for .PAGCA.
|  
|                        care-mask is the word specifying which  bits  of
|                        the  attribute-settings word should be examined.
|                        Note that PA.GSC, the independent  section  bit,
|                        is checked only when PA.GIN is turned on in both
|                        .PAGCA  and  in  the  care   mask   in   .PAGBM.
|                        Likewise,   PA.GPN,  the  SPY  page  number,  is
|                        checked only when PA.GSP is on in .PAGCA and the
|                        care mask in .PAGBM.
|  
|                        starting-page-no specifies the  page  number  of
|                        the page that is mapped to bit 0 of the mask.
|  
|        14    .PAGAL    Determines the type  of  access  allowed  for  a
|                        given page.  The argument block is:
|  
|                             EXP   count
|                             EXP   starting-page
|  
|                        where:
|  
|                        count is the number of arguments.
|  
|                        starting-page is the starting page of  the  area
|                        in  which  information  is  to be returned.  The
|                        bits returned are the same as for .PAGCA.


                                   22-277
   PAGE. [CALLI 145]


   Normal Return

                                                       ac        The specified function has been performed; the ac is unchanged.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          0    PAGUF%    Function not implemented.
          1    PAGIA%    Illegal argument.
          2    PAGIP%    Illegal page number.
          3    PAGCE%    Page should not exist, but does.
          4    PAGME%    Page should exist, but does not.
          5    PAGMI%    Page should be in core, but is not.
          6    PAGCI%    Page should not be in core, but is.
          7    PAGSH%    Page is in sharable high segment.
         10    PAGIO%    Paging I/O error.
         11    PAGNS%    No swapping space available.
         12    PAGLE%    Core limit exceeded.
         13    PAGIL%    Function illegal if page locked.
         14    PAGNX%    Cannot allocate zero  page  with  virtual  limit
                         zero.
         15    PAGNP%    Not enough privileges.
|        16    PAGSC%    Section should not exist, but does.
|        17    PAGSM%    Section should exist, but does not.
|        20    PAGIS%    Illegal section.






































                                   22-278
                                                        PATH. [CALLI 110]


                             PATH. [CALLI 110]                             PATH. [CALLI 110]



   Function

        Sets or reads a user's default directory path, reads the  default
        directory  path  for  a  device  or  channel,  or  sets  or reads
        pathological device name definitions.  A pathological device name
        is a logical name defining a directory search path in the form:

             dev:file.ext[UFD,SFD1,SFD2,...SFD5].

        Refer to Section 12.6.5 for more information.

   Calling Sequence

               MOVE    ac,[XWD len,addr]
               PATH.   ac,
                 error return
               normal return
               . . .
        addr:  argument list

                len        where:  len is the length of the argument  list.   The  value  in
                this  word  must  be  at  least 3.  If you specify 0, the
                length defaults to 3.

                addr                addr is the address of the argument list.

        There are two types of argument blocks  for  the  PATH.   monitor
        call.   Type  1 is used for reading and setting default directory
        paths for users, channels,  or  devices.   Type  2  is  used  for
        reading or defining pathological names.

   ________ _____ ____ _   Argument Block Type 1

        Argument Block Type 1 is used for  reading  and  setting  default
        directory  paths  for users, channels, or devices.  This argument
        type is used for all  functions  (specified  in  .PTFCN),  except
        functions  -6 and -5 (.PTFRN and .PTFSN).  The function codes are
        listed below.

        ______  ______  ________        Offset  Symbol  Contents

          0    .PTFCN    A SIXBIT device name; or a  job  number  in  the
                         left  half and a function code or channel number
                         in the right half.

                         If  you  specify  a  device  name,  the  monitor
                         returns the default path for that device.

                         If you specify a job number and  function  code,
                         or  a job number and channel number, the word is
                         formatted as follows:

                         ____    ______  ________                         Bits    Symbol  Contents

                          0-17   PT.JBN  Job  number.   This  job  number
                                         defaults  to  your job number if
                                         not in the range  of  1  to  the
                                         highest legal job number.




                                   22-279
   PATH. [CALLI 110]


                         ____    ______  ________                         Bits    Symbol  Contents

                         18-35   PT.FCN  Function code or channel number.
                                         The  function  codes  and  their
                                         meanings are listed below.

                                         If you specify a channel  number
                                         instead  of a function code, the
                                         monitor returns the default path
                                         for the device currently open on
                                         that channel.   If  accessing  a
                                         file   that   is   open  on  the
                                         specified channel,  the  monitor
                                         returns  the actual path for the
                                         file.

                                         The function codes are:

                                         ____  ______    ________                                         Code  Symbol    Function

                                         -6    .PTFRN    Reads          a
                                                         pathological
                                                         name.  Refer  to
                                                         Argument   Block
                                                         Type 2.

                                         -5    .PTFSN    Sets           a
                                                         pathological
                                                         name.  Refer  to
                                                         Argument   Block
                                                         Type 2.

                                         -4    .PTFRL    Returns       an
                                                         additional  path
                                                         to  be  searched
                                                         when  a  file is
                                                         not   in    your
                                                         directory  path.
                                                         (For    example,
                                                         the      monitor
                                                         returns     SYS,
                                                         NEW,  or LIB, if
                                                         appropriate.
                                                         See  word .PTSWT
                                                         below.)

                                         -3    .PTFSL    Sets          an
                                                         additional  path
                                                         to  be  searched
                                                         when  a  file is
                                                         not   found   in
                                                         your   directory
                                                         path.       (See
                                                         .PTFRL.)    When
                                                         you specify this
                                                         function   code,
                                                         you must  supply
                                                         the    following
                                                         words   in   the
                                                         argument block:

                                                         .PTFCN
                                                         .PTSWT
                                                         .PTPPN


                                   22-280
                                                        PATH. [CALLI 110]


                                         ____  ______    ________                                         Code  Symbol    Function

                                         -2    .PTFSD    Sets the default
                                                         path  to  search
                                                         if  no  path  is
                                                         specified.

                                         -1    .PTFRD    Reads        the
                                                         default     path
                                                         that is searched
                                                         if  no  path  is
                                                         specified.

        1      .PTSWT    Flags.   The  flags  are  only   applicable   to
                         specific  functions.   All  flags  apply  if you
                         specify a device name or channel number  in  the
                         previous word (.PTFCN).

                         ____    ______  _______                         Bits    Symbol  Meaning

                          25     PT.EDA  Returned to  indicate  that  the
                                         device  or  channel  number  was
                                         both a pathological name and  an
                                         ersatz  device  name.  This flag
                                         is ignored on all Set functions.

                          26     PT.DLN  Returned to  indicate  that  the
                                         device  or  channel specified in
                                         .PTFCN is a  pathological  name.
                                         Therefore,    this    flag    is
                                         applicable only when a device or
                                         channel  number  is specified in
                                         .PTFCN.

                          29     PT.SLT  Returned to indicate the type of
                                         search  list  associated  with a
                                         device or channel.   The  search
                                         list types are:

                                         ____  ______    ____                                         Code  Symbol    Type

                                          0    .PTSLN    No  search  list
                                                         has         been
                                                         associated  with
                                                         the    specified
                                                         device        or
                                                         channel.
                                          1    .PTSLJ    Job search list.
                                          2    .PTSLA    ALL search list.
                                          3    .PTSLS    SYS search list.
                                                         .PTSLS        is
                                                         applicable  only
                                                         when  a   device
                                                         name  or channel
                                                         number        is
                                                         specified     in
                                                         .PTFCN.

                         30      PT.IPP  Returned to  indicate  that  the
                                         device  specified  in .PTFCN has
                                         an implied PPN, as in  the  case
                                         of  an  ersatz device name.  The
                                         implied PPN is returned  in  the
                                         following word, .PTPPN.


                                   22-281
   PATH. [CALLI 110]


                         ____    ______  _______                         Bits    Symbol  Meaning

                         30      PT.DTL  Set to prevent any change to the
                                         status  of LIB, allowing changes
                                         to NEW and SYS without  changing
                                         LIB.   This  flag is useful only
                                         for function code .PTFSL.

                         31      PT.LIB  Returned to  indicate  that  LIB
                                         (if  defined  for your job) will
                                         be searched on each structure in
                                         your job search list, after your
                                         default path for each  structure
                                         in  the job search list has been
                                         exhausted in the attempt to find
                                         a  file.   The LIB ersatz device
                                         name  can   be   defined   using
                                         function  .PTFSL,  or by setting
                                         flag   PT.SEA   in    the    LIB
                                         pathological   name   definition
                                         using function .PTFRN.

                         32      PT.NEW  Returned to indicate that,  when
                                         SYS is specified or implied, the
                                         NEW area [1,5] will be  searched
                                         before the SYS area [1,4].

                         33      PT.SYS  Returned to  indicate  that  SYS
                                         (ersatz  device  name for [1,4])
                                         will   be   searched   on   each
                                         structure  in  your  job  search
                                         list after your default path  to
                                         each  structure  in  the  search
                                         list has been exhausted  in  the
                                         attempt to find a file.

                       34-35     PT.SCN  Controls      searching       of
                                         higher-level        directories.
                                         (Similar  to  /SCAN  switch   to
                                         SETSRC  program,  but  overrides
                                         the  setting  of   /SCAN.)   The
                                         values  of  this  field can be 0
                                         (use  same  scanning  status  as
                                         before  the PATH.  call), or one
                                         of the following:

                                         _____ ______    ______ _______                                         Value Symbol    Switch Setting

                                           0             Use      default
                                                         setting.
                                           1   .PTSCN    Turns   scanning
                                                         off.
                                           2   .PTSCY    Turns   scanning
                                                         on.

                                         The scanning status is  returned
                                         if   you  specify  a  device  or
                                         channel number in .PTFCN, or  if
                                         you  use  function  .PTFRD.  The
                                         status  is  set  using  function
                                         .PTFSD.   These bits are checked
                                         when the path block is given for
                                         LOOKUP, GETSEG, RUN, MERGE., and
                                         FILOP. calls.


                                   22-282
                                                        PATH. [CALLI 110]


                         ____    ______  _______                         Bits    Symbol  Meaning

                         34      PT.SNW  Set to indicate that NEW (ersatz
                                         device  name  for [1,5]) will be
                                         searched before  [1,4]  whenever
                                         SYS is specified or implied.

                         35      PT.SSY  Returned to  indicate  that  SYS
                                         (ersatz  device  name for [1,4])
                                         will   be   searched   on   each
                                         structure  in  your  job  search
                                         list after your default path  to
                                         each  structure  in  the  search
                                         list has been exhausted  in  the
                                         attempt to find a file.

        The following table lists the information that can be  stored  in
        .PTFCN  and  indicates  the flags in .PTSWT that apply to each of
        the functions .PTFRD, .PTFSD, .PTFSL, and .PTFRL:



                    Table 22-1:  PATH.  Functions and Flags                    Table 22-1:  PATH.  Functions and Flags



                ______                          _________                Device                          Functions

        ____    __ _______     ______         ______    ______ ______        Flag    or Channel     .PTFRD         .PTFSD    .PTFSL .PTFRL


        PT.EDA    X
        PT.DLN    X
        PT.SLT    X
        PI.IPP    X
        PT.DTL                                            X
        PT.LIB    X              X
        PT.NEW    X              X
        PT.SYS    X              X
        PT.SCN    X              X              X
        PT.SNW                                            X         X
        PT.SSY                                            X         X

        ______ ______    ________        Offset Symbol    Contents

          2    .PTPPN    The PPN (UFD) of the path.  For function .PTFRL,
                         the  library PPN, if any, is returned here.  For
                         function .PTFSL, the library  PPN  is  set  from
                         this word unless PT.DTL is set in .PTSWT.

          3    .PTSFD    The first level of SFD, as the SFD name,  stored
                         in SIXBIT.  TOPS-10 allows up to 5 nested levels
                         of SFDs, but MONGEN  allows  this  value  to  be
                         lower than 5.  You can obtain the maximum number
                         of SFD levels allowed, from the  right  half  of
                         the   item   %LDSFD   in  GETTAB  table  .GTLVD.
                         Subsequent words contain lower levels of SFDs.

          4-10 .  .  .   Name of the following SFD levels.

          11   .PTMAX    Maximum length.  Contains a 0 to end  the  PATH.
                         block.




                                   22-283
   PATH. [CALLI 110]


   ________ _____ ____ _   Argument Block Type 2

        This argument block is used to read and define pathological names
        (logical names for directory paths) using functions .PTFSN to set
        the pathological name and .PTFRN to read the  pathological  name.
        The offsets into the argument block are:

        ______ ______    ________        Offset Symbol    Contents

        0      .PTFCN    Job number and function code  in  the  following
                         format:

                         ____    ______  ________                         Bits    Symbol  Contents

                         0-17    PT.JBN  Ignored for functions .PTFSN and
                                         .PTFRN.

                         18-35   PT.FCN  Function  code.   The   function
                                         codes and their meanings are:

                                         ____  ______    ________                                         Code  Symbol    Function

                                         -6    .PTFRN    Returns
                                                         information  (in
                                                         .PTLNM)    about
                                                         the      current
                                                         pathological
                                                         name  or returns
                                                         the         next
                                                         pathological
                                                         name in the list
                                                         of       defined
                                                         names.

                                         -5    .PTFSN    Defines       or
                                                         deletes        a
                                                         pathological
                                                         name.  To delete
                                                         a name, you must
                                                         also   set  flag
                                                         PT.UDF in .PTLNF
                                                         and  specify the
                                                         name    to    be
                                                         deleted       in
                                                         .PTLNM.

        1      .PTLNF    Pathological name flags:

                         ____    ______  _______                         Bits    Symbol  Meaning

                           0     PT.SEA  The directories included in  the
                                         definition  of this pathological
                                         name will  be  searched  when  a
                                         file is not found in the default
                                         directory path when you issue  a
                                         LOOKUP  monitor  call.  (This is
                                         similar to  .PTFSL,  but  allows
                                         more flexibility.) PT.SEA can be
                                         set for  only  one  pathological
                                         device.      However,    several
                                         directories can be specified for
                                         a single pathological name.




                                   22-284
                                                        PATH. [CALLI 110]


                         ____    ______  _______                         Bits    Symbol  Meaning

                           1     PT.UDF  Deletes the  definition  of  the
                                         pathological  name  specified in
                                         .PTLNM.  You must  also  specify
                                         function code -5 (.PTFSN) above.

                           2     PT.RCN  Returns    data    about     the
                                         pathological  name  specified in
                                         .PTLNM when you specify function
                                         code  -6 (.PTFRN).  If this flag
                                         is 0 for  function  .PTFRN,  the
                                         monitor  returns, in .PTLNM, the
                                         next pathological  name  defined
                                         in the list.

                           3             Reserved for use by DIGITAL.

                           4     PT.OVR  Indicates that the file name and
                                         extension   specified   in   the
                                         definition of  the  pathological
                                         device  should override those in
                                         the    argument    block     for
                                         LOOKUP/ENTER  calls.   Used with
                                         both .PTFRN and .PTFSN.

                                         For example,  when  FOO/OVERRIDE
                                         is defined as DSKA:FOO.DAT[1,2],
                                         a LOOKUP of FOO:BAR.DAT will not
                                         find   BAR.DAT;   it  will  find
                                         FOO.DAT.   When  PT.OVR  is  not
                                         set,  the  pathological  name is
                                         used to  define  defaults.   For
                                         example,  when FOO is defined as
                                         DSKA:FOO.DAT[1,2], a LOOKUP  for
                                         FOO:BAR would find BAR.DAT

        2      .PTLNM    For function .PTFRN,  set  this  word  to  0  to
                         return  the  first pathological name in the list
                         of names defined for your job, or the next  path
                         name  in  this  word.   For the .PTFSN function,
                         this word contains the  path  name  (in  SIXBIT)
                         that you wish to define or delete.

        3      .PTLSB    First word of the pathological name sub-block.

                         Each sub-block is in  the  format  shown  below.
                         Offsets  are  from  the  start of the sub-block.
                         The SFD list for the path begins at Word  5  and
                         is  terminated  with a zero word.  The zero word
                         must not be past Word 12 (.PTLEL).

                         The entire list of sub-blocks must be terminated
                         by  two zero words following the last sub-block.
                                                in addition                         These must be reserved in addition to .PTLEL.

                         Each path sub-block is formatted as:

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .PTNOD  Reserved to DIGITAL  for  future
                                         expansion.
                           1     .PTLSL  SIXBIT  device  (such  as  DSKB,
                                         DSK, ALL, or SSL).


                                   22-285
   PATH. [CALLI 110]


                         ______  ______  ________                         Offset  Symbol  Contents

                           2     .PTFIL  File name.
                           3     .PTEXT  File extension.
                           4     .PTLPP  PPN.
                           5     .PTLSF  Start of SFD list.
                         6-11            Subsequent SFD levels.
                          12     .PTLEL  Zero  word,  to  terminate   SFD
                                         list.
                          13     .PTLZT  First  of  the   two-word   zero
                                         terminator  for  the entire list
                                         of path blocks.

                         You can include as many sub-blocks as you  wish,
                         up  to 77 (octal), except that the length of the
                         entire list of sub-blocks (including the header)
                         may not exceed 144 octal words.

   Normal Return

        For Read functions, the argument block  is  filled  in;  for  Set
        functions, the function is completed.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____    ______    _____        Code    Symbol    Error

        -1      PTNSS%    No such SFD as that specified in search list.
         0      PTNDD%    Specified channel was not  OPEN,  or  specified
                          device was not a disk device.
         1      PTTME%    Too many entries in PATH.  block.
         2      PTTMN%    Too many pathological names defined.
         3      PTNSN%    Attempt to delete nonexistent name.
         4      PTNFS%    No per-process free core.
         5      PTANE%    Tried  to  define  a  pathological  name   that
                          already exists.
         6      PTNEN%    Non-existent pathological name used in argument
                          block for .PTFRN and .PTFSN.
         7      PTNSJ%    No such job as the job number you specified  in
                          the argument block.
        10                Reserved for use by DIGITAL.
        11      PTNAI%    Invalid number  of  arguments  specified.   You
|                         must  include  3 words in the block for calling
|                         sequence 1; 5 words in the  block  for  calling
|                         sequence 2.



















                                   22-286
                                                        PATH. [CALLI 110]


   Examples

        This example defines the following pathological name:

        FOO/SEARCH=DSKB:[10,10,MON,NEW],DSKC:[10,11,OLD]

        The code to define the pathological name FOO is:

                MOVE    T1,[XWD ARGLEN,ARGLST]
                PATH.   T1,
                  JRST  ERROR
                JRST    CONTIN
        ARGLST: EXP     .PTFSN        ;Function code
                EXP     PT.SEA        ;/SEARCH attribute
                SIXBIT/FOO/           ;Logical path name to define
                EXP     0             ;Start of first group
                SIXBIT/DSKB/
                0                     ;file name
                0                     ;extension
                XWD     10,10
                SIXBIT/MON/
                SIXBIT/NEW/
                EXP     0             ;Word terminating PATH spec
                EXP     0             ;Start of second group
                SIXBIT/DSKC/
                0                     ;file name
                0                     ;extension
                XWD     10,11
                SIXBIT/OLD/
                EXP     0             ;Word terminating PATH spec
                EXP     0             ;Two words terminating PATH block
                EXP     0
        ARGLEN==.-ARGLST              ;Length of arg list

































                                   22-287
   PEEK [CALLI 33]


                              PEEK [CALLI 33]                              PEEK [CALLI 33]



   Function

        Returns the contents of any location in the  monitor.   The  PEEK
        monitor  call  requires that your program have bit 16 (JP.SPA) or
        bit 17 (JP.SPM) set in the GETTAB table .GTPRV, or  your  program
        must  have  JACCT  privileges.   If  you  do  not have the proper
                        ac        privileges, the ac is cleared.

   Calling Sequence

|               MOVE    ac,addr
                PEEK    ac,
                return

                addr|       where:  addr is the 30 bit address of the  word  in  the  monitor
                virtual address space to be returned.

        If you set UU.PHY in this call, using the instruction:

             PEEK ac,UU.PHY

        the specified address is assumed to be a physical memory  address
        instead of a virtual address.

   Return

                                                                 addr        On return, the contents of the monitor location given by addr  is
                           ac        returned  in  the  ac.   If  the  calling  job  does not have the
                                                    ac        required privileges, the monitor clears the ac.

   Related Calls

        PAGE., POKE, SPY





























                                   22-288
                                                        PERF. [CALLI 162]


                             PERF. [CALLI 162]                             PERF. [CALLI 162]



   Function

        Allows privileged programs to perform system measurements over  a
        period of time.  The PERF. call works only on the KL10 processor.
        Note that only one job at a time may use the performance meter on
        each CPU.  The PERF. functions are discussed in Chapter 10.

   Calling Sequence

                MOVE    ac,[XWD n,addr]
                PERF.   ac,
                  error return
                normal return
                . . .
        addr:   XWD     fcncode,faddr
                . . .
                XWD     fcncode,faddr

                n        where:  n is the  number  of  function  words  specified  in  the
                                                addr                argument block, which begins at addr.

                addr                addr is the address of the argument block.  The  argument
                block  is  a  list of the functions to be enabled and the
                address of the argument list that defines each  function,
                allowing  you  to  specify multiple functions in a single
                monitor call.

                fcncode                fcncode is one of the function  codes  described  on  the
                following pages of this manual.

                faddr                faddr is the address of the function code argument  list.
                Each  function  must  have a corresponding argument list.
                These argument lists  are  described  with  the  function
                codes.

        The function codes and their meanings are:

             ____   ______    ________             Code   Symbol    Function

               1    .PRSET    Sets up the performance meter.
               2    .PRSTR    Starts the performance meter.
               3    .PRRED    Reads the performance meter.
               4    .PRSTP    Stops the performance meter.
               5    .PRRES    Releases the performance meter.
               6    .PRBPF    Turns background PERF analysis off.
               7    .PRBPN    Turns background PERF analysis on.
















                                   22-289
   PERF. [CALLI 162]


                             faddr        The argument list at faddr for the .PRSET function is:

        ______ ______    ________        Offset Symbol    Contents

           0   .PMLEN    Length of the argument list.

           1   .PMCPU    CPU type:

                         ___    ______    ___ ____                         Bit    Symbol    CPU Type

                           0    PM.PD6    PDP-6.
                           1    PM.KA     KA10.
                           2    PM.KI     KI10.
                           3    PM.KL     KL10.
                           4    PM.KS     KS10.

           2   .PMMOD    CPU number and mode:

                         ____   ______    _______                         Bits   Symbol    Meaning

                         0-17   PM.CPN    CPU number.
                           18   PM.MOD    Interval mode.  If this bit  is
                                          not set, a count of the enabled
                                          events (specified in  following
                                          words)  is  kept.   If  on, the
                                          duration of the  enabled  event
                                          (in clock ticks) is kept.
                           19   PM.CLR    Clears    performance     meter
                                          counts.   Resets  the  counters
                                          when the call  is  issued.   If
                                          you  clear  this bit, the meter
                                          will  be  set  but  any  values
                                          currently  in  the counters are
                                          left unchanged.

           3   .PMCSH    Cache enable flags:

                         ____   ______    _______                         Flag   Symbol    Meaning

                           0    PM.CCR    Count references.
                           1    PM.CCF    Count fills.
                           2    PM.EWB    Count EBOX writebacks.
                           3    PM.SWB    Count sweep writebacks.
                           4    PM.SYN    Synchronize   performance   and
                                          accounting meters.

           4   .PMPIE    Priority interrupt enable flags:

                         ____   ______    _______                         Flag   Symbol    Meaning

                           0    PM.PI0    Enable for channel 0 (DTE).
                           1    PM.PI1    Enable for channel 1.
                           2    PM.PI2    Enable for channel 2.
                           3    PM.PI3    Enable for channel 3.
                           4    PM.PI4    Enable for channel 4.
                           5    PM.PI5    Enable for channel 5.
                           6    PM.PI6    Enable for channel 6.
                           7    PM.PI7    Enable for channel 7.
                           8    PM.NPI    Enable  for  no  interrupt   in
                                          progress.






                                   22-290
                                                        PERF. [CALLI 162]


        ______ ______    ________        Offset Symbol    Contents

           5   .PMPCE    Program counter enable flags:

                         ____   ______    _______                         Flag   Symbol    Meaning

                           0    PM.UPC    User-mode enable.
                           1    PM.XPC    Executive-mode enable.

           6   .PMMPE    Microcode probe enable flags:

                         ____   ______    _______                         Flag   Symbol    Meaning

                           0    PM.MPE    Enable microcode probe.

           7   .PMHPE    Hardware probe enable flags:

                         ____   ______    _______                         Flag   Symbol    Meaning

                           0    PM.P0L    Probe zero low.
                           1    PM.P0H    Probe zero high.

                           10   .PMJOB    Job enable flag:

                         _____  ______    _______                         Value  Symbol    Meaning

                           -2   .PMNUL    Enable for null job.
                           -1   .PMSLF    Enable for calling job.

          11   .PMCHN    Channel enable flags:

                         ____   ______    _______                         Flag   Symbol    Meaning

                           0    PM.EC0    Enable for channel 0.
                           1    PM.EC1    Enable for channel 1.
                           2    PM.EC2    Enable for channel 2.
                           3    PM.EC3    Enable for channel 3.
                           4    PM.EC4    Enable for channel 4.
                           5    PM.EC5    Enable for channel 5.
                           6    PM.EC6    Enable for channel 6.
                           7    PM.EC7    Enable for channel 7.

                         faddr        The arguments at faddr and  following  for  the  .PRSTR,  .PRRED,
        .PRSTP, and .PRRES functions are:

        ______ ______    ________        Offset Symbol    Contents

           0   .PMLEN    Length of the argument list.
           1   .PMCPN    CPU number.
           2   .PMHTB    High-order word of time-base.
           3   .PMLTB    Low-order word of time-base.
           4   .PMHPM    High-order word of performance counter.
           5   .PMLPM    Low-order word of performance counter.
           6   .PMHMC    High-order MBOX reference count.
           7   .PMLMC    Low-order MBOX reference count.

        The argument offsets for the .PRBPF and .PRBPN functions are:

        ______ ______    ________        Offset Symbol    Contents

           0   .PMLEN    Length of argument block.
           1   .PMCPU    CPU type (same as .PRSET).
           2   .PMMOD    CPU and flags (same as .PRSET).
           3   .PMBPI    Sample interval in ticks.


                                   22-291
   PERF. [CALLI 162]


   Normal Return

        For the .PRSET function, the performance meter is set.

        For the .PRSTR  function,  the  monitor  starts  the  performance
        meter.

        For the .PRRED function, the monitor  has  supplied  the  updated
                   faddr+2         faddr+7        values for faddr+2 through faddr+7.

        For the .PRSTP  and  .PRRES  functions,  the  monitor  stops  the
        performance    meter   or   releases   the   performance   meter,
        respectively.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          1    PRCPU%    Invalid CPU specified.
          2    PRNXC%    Nonexistent CPU specified.
          3    PRMOD%    Improper mode specified.
          4    PRSET%    Meter not set up.
          5    PRUSE%    Meter already in use.
          6    PRRUN%    Meter already running.
          7    PRJOB%    Invalid job number.
         10    PRNRN%    Meter not running.
         11    PRNIM%    Function not implemented.
         12    PRFUN%    Invalid function code.
         13    PRPRV%    Not enough privileges.



































                                   22-292
                                                       PIBLK. [CALLI 212]


                             PIBLK. [CALLI 212]                             PIBLK. [CALLI 212]



   Function

        Returns the address of the 4-word interrupt control block for the
        current  interrupt  in  progress  on  the  Programmable  Software
        Interrupt (PSI) system.  Refer to Chapter 6 for more  information
        about using the (PSI) system.

        This call is used by generic  interrupt  processes  that  service
        multiple  interrupt  conditions.   Note  that  this call will not
        generate an interrupt when UUO interrupts are enabled.

   Calling Sequence

                PIBLK.  ac,
                  error return
                normal return

   Normal Return

        On a successful  return  from  this  call,  the  address  of  the
                                                 ac        interrupt control block is stored in the ac.

   Error Return

        The call can take the error return  with  one  of  the  following
                                  ac        error codes stored in the ac:

         ____   ______    _____         Code   Symbol    Error

         0      PSNIN%    The PSI system has  not  been  initialized  for
                          this job.

         1      PSNIP%    No interrupt is in progress.

   Related Calls

|       DEBRK., PIFLG., PIINI., PIJBI., PIRST., PISAV., PISYS., PITMR.

























                                   22-293
|  PIFLG. [CALLI 216]


                             PIFLG. [CALLI 216]|                            PIFLG. [CALLI 216]
|  
|  
|  
|  Function
|  
|       The PIFLG.  monitor call allows you to retrieve the PC  flags  of
|       the  highest level pending interrupt that have been stored in the
|       monitor.  Flags are stored  in  the  monitor  if  you  are  using
|       extended  addressing  format, set by the PS.IEA bit of the PIINI.
|       monitor call.
|  
|  Calling Sequence
|  
|               MOVE    ac,.PSFRD          \
|               MOVE    ac,[flags,,.PSFWT] /
|               PIFLG.  ac,
|                 error return
|               normal return
|  
|       where:  flags are one or more of the  interrupt  PC  flags.   The
|               function codes are:
|  
         ____   ______    ________|        Code   Symbol    Function
|  
|        0      .PSFRD    Read interrupt flags.
|  
|        1      .PSFWT    Write interrupt flags.
|  
|  Normal Return
|  
|       The requested action is performed.  Flags are returned in the ac.
|  
|  Error Return
|  
|       One of the following codes in returned in the ac:
|  
         ____   ______    _____|        Code   Symbol    Error
|  
|        0      PSFNI%    PSI system not initialized.
|        1      PSFNP%    No interrupt in progress.
|        2      PSFEA%    Extended addressing format for PI system not in
|                         use.
|        3      PSFIF%    Illegal function code.
|  
|  Related Calls
|  
|       PIBLK., PIINI., PIJBI., PISAV., PISYS., PITMR.


















                                   22-294
                                                        PIINI [CALLI 135]


                             PIINI. [CALLI 135]                             PIINI. [CALLI 135]



   Function

        Initializes the programmable software interrupt (PSI) facility by
        clearing  any  old interrupts and storing the base address of the
        interrupt vector block.  Refer to Chapter 6 for more  information
        about using the PSI system.

   Calling Sequence

|               MOVE    ac, [flag + addr]
                PIINI.  ac,
                  error return
                normal return
                . . .
        addr:

|       where:  flag is one or more of the following:
|  
         ____   ______    _______|        Bits   Symbol    Meaning
|  
|          0    PS.UCS    Use the current (PC)  section  for  the  vector
|                         section.   (IFIW) If PS.UCS is not set, addr is
|                         treated as a 30-bit address.
|  
|          1    PS.IEA    Use extended addressing format.   A  30-bit  PC
|                         word  is  stored  in the old PC location in the
|                         PSI block when an interrupt occurs.   No  flags
|                         are  stored in the PC.  Flags are stored in the
|                         monitor,  and  may  be   returned   using   the
|                         PIFLG. UUO.

                addr                addr is the base address of the  first  interrupt  vector
                block.   The  interrupt  vector block is a list of one or
                more sub-blocks, each of which is formatted as follows:

        ______ ______    ________        Offset Symbol    Contents

|          0   .PSVNP    New program counter; this is the address of  the
                         interrupt service routine.

           1   .PSVOP    Old program counter; this is the address of  the
                         next  instruction after the instruction that was
                         being executed when the interrupt occurred.   If
                         the  instruction  was  a  monitor  call,  .PSVOP
                         contains  the  return  address  for  the   call;
                         however,  if  the  monitor  terminated the call,
                         .PSVOP contains the address of the call itself.

           2   .PSVFL    Control flags, and either device condition flags
                         or a non-I/O condition code.

                         The control flags are:

                         ____   ______    _______                         Bits   Symbol    Meaning

                           1    PS.VPO    Disable  all  interrupts;  they
                                          can    be    reenabled   by   a
                                          PISYS. monitor call.




                                   22-295
   PIINI [CALLI 135]


                         ____   ______    _______                         Bits   Symbol    Meaning

                           2    PS.VTO    Disable   all   interrupts   of
                                          higher   priority   until   the
                                          program gives a  DEBRK. monitor
                                          call.

                           3    PS.VAI    Allow control block  to  accept
                                          additional   interrupts.    Use
                                          DEBRK.  to dismiss interrupts.

                           4    PS.VDS    Dismiss     any      additional
                                          interrupt   requests  for  this
                                          condition or device until  this
                                          interrupt  is  dismissed (using
                                          DEBRK.).

                           5    PS.VPM    Print any standard message that
                                          is  relevant  to this interrupt
                                          condition.

                           6    PS.VIP    Interrupts are in progress  for
                                          this  interrupt  control block.
                                          This  flag  is  used   by   the
                                          monitor.

|                        17-35            The  right   half   of   .PSVFL
                                          contains the condition (reason)
                                          for the interrupt.   These  are
                                          divided    into    device   I/O
                                          conditions     and      non-I/O
                                          conditions,  and  are described
                                          under the PISYS.  monitor call.

|         3    .PSVIS    Interrupt status.  When this auxiliary  word  is
|                        returned by a device I/O interrupt, it contains:

                              udx,,file-status

   Normal Return

        The program can use the PISYS. call to add  or  delete  interrupt
        conditions.

   Error Return

|       The call can take the error return  with  one  of  the  following
|       error codes stored in the ac:
|  
        ____   ______    _______|       Code   Symbol    Meaning
|  
|         1    PIIBC%    Illegal bit or section number given.
|         2    PIADC%    Address check occurred.
|         3    PINFS%    The monitor does not have sufficient free core.

   Examples

        See Chapter 6.

   Related Calls

        DEBRK., PIFLG., PIJBI., PIRST., PISAV., PISYS.




                                   22-296
                                                        PIJBI [CALLI 175]


                             PIJBI. [CALLI 175]                             PIJBI. [CALLI 175]



   Function

        The PIJBI.  monitor call allows one job to interrupt another with
        a  software  interrupt.   The interrupted job must be waiting for
        the interrupt; it cannot be busy handling a  previous  interrupt.
        The  receiver  enables  cross-job  interrupts by using the PISYS.
        UUO (non-I/O condition .PCJBI).

   Calling Sequence

|               MOVE    ac,[XWD target,status]
                PIJBI.  ac,
                  error return
                normal return

                target|       where:  target is either the job context number  of  the  job  to
|               interrupt,  or  the  job  number of the job to interrupt.
                Status                Status is the status of the interrupt.  The  status  word
                is described in Volume 1.

                A -1 for the job number will interrupt the  job  that  is
                executing the monitor call.

                The job to be interrupted must be enabled  for  cross-job
                interrupts  or  else  the call will fail.  Note that this
                situation requires cooperation  between  two  jobs,  much
                like ENQ/DEQ or IPCF.  If the target job is processing an
                interrupt, the sender must try again because requests are
                not queued.

   Normal Return

        The interrupted job will receive a word of the following form:

|            [source,,status]

              source|       where source is the job context number of the job  that  performs
                                       status        the  PIJBI.   call,  and  the  status  is the status that the job
        included in the call.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

         ____  ______    _______         Code  Symbol    Meaning

          0    PSJNE%    Job not enabled  or  the  program  specified  an
                         invalid job number.
          1    PSJOP%    Job  has  an  interrupt  in  progress.   Try  to
                         interrupt again.

   Related Calls

|       DEBRK., PIFLG., PIINI., PISAV., PIRST., PISYS.








                                   22-297
   PIRST. [CALLI 141]


                             PIRST. [CALLI 141]                             PIRST. [CALLI 141]



   Function

        Restores the saved state of the interrupt  facility.   This  does
        not restore any pending interrupts.

   Calling Sequence

                MOVEI   ac,buffer
                PIRST.  ac,
                  error return
                normal return

                buffer        where:  buffer is the address of  the  data  saved  by  a  PISAV.
                monitor call.

   Normal Return

        The state of the  interrupt  facility  as  saved  by  PISAV.   is
        restored.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          0    PSNRS%    Not restoring what was saved.
          1    PSNME%    Not enough monitor core to contain data base.

   Related Calls

|       DEBRK., PIFLG., PIINI., PIJBI., PISAV., PISYS.






























                                   22-298
                                                       PISAV. [CALLI 140]


                             PISAV. [CALLI 140]                             PISAV. [CALLI 140]



   Function

        Returns the monitor's data for the current state of the  software
        interrupt  facility.   Use PIRST. to restore this data to current
        state.

   Calling Sequence

                MOVE    ac,[XWD buflength,buffer]
                PISAV.  ac,
                  error return
                normal return
                . . .
        buffer: BLOCK   buflength

                buflength        where:  buflength is the length of the buffer for  returned  data
                 buflength                (buflength  = 2 + (3 * blocks)).  The data is returned in
                a series of 3-word blocks, one block for  each  interrupt
                vector.

                buffer                buffer is the address of the buffer.

   Normal Return

                                          buffer        The interrupt data is returned at buffer in the format:

        ______ ______    ________        Offset Symbol    Contents

           0   .PSSFC    Flags and count:

                         ____   ______    _______                         Bits   Symbol    Meaning

                            0   PS.SON    The interrupt facility is on.
|                           1             Reserved.
|                           2   PS.SEA    System      using      extended
|                                         addressing.
|                        3-17             Reserved.
                        18-35             Count of  words  returned.   If
                                          error   code   PSBTS%   (0)  is
                                          returned,  this  count  is  the
                                          number  of  words  required  to
                                          save  the   current   interrupt
                                          system.

           1   .PSSIV    Address of interrupt control block vector.

           2   .PSSBL    Address of first 3-word argument block.

        Each 3-word argument block is in the form:

        ______ ______    ________        Offset Symbol    Contents

           0   .PSECN    Condition or device.

           1   .PSEOR    Offset,,reasons.

           2   .PSEPR    Priority,,0.





                                   22-299
   PISAV. [CALLI 140]


   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          0    PSBTS%    Block too small.
          1    PSBSZ%    Buffer size is 0 words.

   Examples

                       _______ _____ ______|       See Chapter 6, Monitor Calls Manual, Volume 1.

   Related Calls

|       DEBRK., PIFLG., PIINI., PIJBI., PIRST., PISYS.


















































                                   22-300
                                                       PISYS. [CALLI 136]


                             PISYS. [CALLI 136]                             PISYS. [CALLI 136]



   Function

        Controls the program interrupt facility during execution.

   Calling Sequence

                MOVE    ac,[EXP flags+addr]
                PISYS.  ac,
                  error return
                normal return
                . . .
        addr:   SIXBIT/device/      \
                EXP    channo       |
                EXP    udx          |
                EXP    condition    /
                XWD vectoroffset,reasons
                XWD priority, 0

                flags        where:  flags are one or more of  the  function  flags  described
                below.

                addr                addr is the address of the argument list.

                device                device is the SIXBIT  physical  or  logical  name  of  an
                initialized device.

                channo                channo is the number of an initialized channel.

                udx                udx is the Universal Device Index for a device.

                condition                condition is one of the non-I/O condition codes described
                below.

                vectoroffset                vectoroffset is the relative address of the control block
                for  the  interrupt  (maximum value for this is stored in
                GETTAB table .GTCNF, item %CNMVO).

                reasons                reasons are flags (described below) specifying the device
                conditions that can cause an interrupt.

                priority                priority is the priority level assigned to the interrupt.
                Priority  0  is the lowest level.  Higher values indicate
                which events may interrupt  other  events.   The  maximum
                priority  level is available in GETTAB table .GTCNF, item
                %CNMIP (normally 3).

                The function flags and their meanings are:


        ____   ______    _______        Bits   Symbol    Meaning

           1   PS.FOF    Turns off the interrupt facility.

           2   PS.FON    Turns on the interrupt facility.

           3   PS.FCP    Clears all pending interrupts.

|          4   PS.FCS    Clears all pending interrupts for a given device
|                        or condition.



                                   22-301
   PISYS. [CALLI 136]


        ____   ______    _______        Bits   Symbol    Meaning

           5   PS.FRC    Removes the specified device or condition.

           6   PS.FAC    Adds the specified device or condition.

        The non-I/O condition codes and their meanings are:

        ____   ______    _______        Code   Symbol    Meaning

          -1   .PCTLE    Time limit exceeded for batch job.  The job  run
                         time (in milliseconds) is returned in the status
                         word.  You can change the job's time limit  with
                         the SET TIME monitor command.

          -2   .PCTMR    Timer interrupt  occurred.   This  condition  is
                         enabled with the PITMR.  call.

          -3   .PCSTP    CTRL/C received from user terminal.  If the  job
                         was  in  terminal input wait state, bit 0 of the
                         status word is set.

          -4   .PCUUO    A monitor call is about  to  be  processed;  the
                         status word contains the monitor call.

          -5   .PCIUU    An illegal monitor call has been processed;  the
                         status word contains the monitor call.

          -6   .PCIMR    An illegal memory reference occurred; the status
                         word contains the effective address.

          -7   .PCACK    An  address  check  occurred;  the  status  word
                         contains the device name.

         -10   .PCARI    An exceptional arithmetic condition occurred.

         -11   .PCPDL    A pushdown list overflow occurred.

         -12   .PCNSP    The  DECnet   NSP.    monitor   call   interrupt
                         occurred.  Refer to the NSP.  UUO.

         -13   .PCNXM    A reference to nonexistent memory occurred.

         -14   .PCAPC    A line-frequency clock tick occurred  while  the
                         job  was  running.  Note that this does not mean
                         an interrupt occurs on  every  clock  tick,  but
                         only  on those that occur while the job is being
                         serviced by the CPU.  The status  word  contains
                         the date and time in universal format.

         -15   .PCUEJ    A fatal error occurred for the job.

         -16   .PCXEJ    An external condition caused a fatal  error  for
                         the job.

         -17   .PCKSY    A KSYS (end of  timesharing)  warning  occurred;
                         the  status  word contains the number of minutes
                         left until KSYS.

         -20   .PCDSC    The dataset status changed.






                                   22-302
                                                       PISYS. [CALLI 136]


        ____   ______    _______        Code   Symbol    Meaning

         -21   .PCDAT    An ATTACH or DETACH monitor call  was  executed.
                         For  ATTACH  the  status  word  contains -1; for
                         DETACH the status word  contains  the  Universal
                         Device Index for the terminal.

         -22   .PCWAK    A WAKE monitor call  was  executed;  the  status
                         word contains the job number of the waker.

         -23   .PCABK    An address break condition occurred.

         -24   .PCIPC    An IPCF packet is in your job's input queue; the
                         status word contains the associate variable.

         -25   .PCDVT    DECnet logging event occurred.   Returns  DR.xxx
                         conditions,  indicating  that  an event occurred
                         that the DECnet management layer must handle.

|        -26   .PCQUE    One  or   more   resources   requested   by   an
                         ENQ. monitor  call  is now available; the status
                         word  contains   the   inclusive   OR   of   the
                         request-ids of the granted requests.

         -27   .PCNET    The ANF-10 network topology  changed.   You  can
                         obtain   the   state  of  the  network  using  a
                         NODE. monitor call.

         -30   .PCJBI    Cross-job interrupt.

         -31   .PCDTC    Date/time changed.  The offset from the previous
                         UDT is returned in the status word.  This offset
                         should be added to a previously stored UDT.

|        -32   .PCOOB    An out-of-band character was received.
|  
|        -33   .PCRC1    Reserved for customer use.
|  
|        -34   .PCRC2    Reserved for customer use.
|  
|        -35   .PCSCS    SCS event.
|  
|        -36   .PCETH    ETHERNET event.

        The device interrupt reason flags and their meanings are:

        ____   ______    ______ _________        Flag   Symbol    Device Condition

         19    PS.RID    Input done.

         20    PS.ROD    Output done.

         21    PS.REF    End-of-file.

         22    PS.RIE    Input error.

         23    PS.ROE    Output error.

         24    PS.RDO    Device off-line.

         25    PS.RDF    Device full.

         26    PS.RQE    Quota exceeded.



                                   22-303
   PISYS. [CALLI 136]


         27    PS.RWT    I/O wait.

         28    PS.ROL    Device on-line.

         29    PS.RRC    RIB has changed.

|        30    PS.RDH    Device hung.
|  
|        31    PS.RSW    Reel switch.
|  
|        32    PS.RIA    Input available.


   Normal Return

        The specified function is executed or the condition is enabled.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

                                                                       ac          0    PSTMA%    Although no bits in the  left  half  of  the  ac
                         require  an  argument  list,  the  right half is
                         nonzero.
                                              ac          1    PSNFS%    The left half of the ac is zero.
          2    PSUKF%    Unknown function flag.
          3    PSOOF%    Both the on and off function flags are set.
                                           addr          4    PSUKC%    Address check for addr.
          5    PSDNO%    Device not initialized.
          6    PSPRV%    Privilege failure.
          7    PSIVO%    Invalid vector offset; not a multiple of  4,  or
                         too  large.   This  value may not be larger than
                         the limit given in the item %CNMVO in the GETTAB
                         table .GTCNF.
                                          addr+2         10    PSUKR%    Nonzero value at addr+2.
         11    PSPTL%    Priority too large.   Highest  priority  allowed
                         can be obtained from GETTAB table %CNMIP.
         12    PSNRW%    Nonzero right halfword in control block.
         13    PSPND%    Facility not initialized by PIINI.
         14    PSARF%    Function flags for both "add" and  "remove"  are
                         set.

   Examples

                       _______ _____ ______        See Chapter 6, Monitor Calls Manual, Volume 1.

   Related Calls

|       DEBRK., PIFLG., PIINI., PIJBI., PIRST., PISAV.















                                   22-304
                                                       PITMR. [CALLI 203]


                             PITMR. [CALLI 203]                             PITMR. [CALLI 203]



   Function

        Enables the PSI system to interrupt after  a  duration  of  time.
        The PSI system must be initialized with the PIINI.  call.

   Calling Sequence

                MOVE    ac,[XWD flag,interval]
                PITMR.  ac,
                  error return
                normal return

                flag        where:  flag is bit 0, which can be  set  to  indicate  that  the
                interval  is specified in milliseconds.  If bit 0 is off,
                the interval is assumed to be the number of seconds.

                interval                interval is the number of seconds to wait, then interrupt
                this  job; if bit 0 is set, then the interval is taken as
                                                interval                the number of milliseconds.  If interval is specified  as
                0, the default is 1 clock tick.

   Restrictions

         o  The job must  enable  the  timer  condition  (.PCTMR),  using
            PISYS.

         o  A second request will override the first, because the job can
            have only one timer interrupt request pending at a time.

         o  Specified in milliseconds, the maximum  interval  is  262.143
            seconds.

         o  In seconds, the maximum interval is 1 hour,  12  minutes,  49
            seconds (at 60 Hz); or 1 hour, 27 minutes, and 22 seconds (at
            50 Hz).


   Normal Return

        The program continues at the skip return and is interrupted  with
        the timer condition after the specified interval.

   Error Return

                                                                     ac        The program receives one of the following error codes in the ac:

         ____   ______    _____         Code   Symbol    Error

         0      PSTNE%    Timer interrupts are not enabled for your  job.
                          Use  PISYS.   call to enable for these types of
                          interrupts.
         1      PSUFB%    Unknown function bit.  The only bit that may be
                                                      ac                          set in the left half of the ac is bit 0.









                                   22-305
   PJOB [CALLI 30]


                              PJOB [CALLI 30]                              PJOB [CALLI 30]



   Function

        Returns the job number of your job.

   Calling Sequence

                PJOB    ac,
                only return

   Return

                                           ac        Your job number is returned in the ac.

   Related Calls

        CTLJOB














































                                   22-306
                                                         POKE [CALLI 114]


                             POKE. [CALLI 114]                             POKE. [CALLI 114]



   Function

        Changes  the  value  of  a  word  in  monitor  core.   Using  the
        POKE. call requires [1,2], JACCT, or JP.POK privileges.

   Calling Sequence

                MOVE    ac,[XWD 3,addr]
                POKE.   ac,
                  error return
                normal return
                . . .
        addr:   monitor-addr
                oldvalue
                newvalue

                addr        where:  addr is the address of the argument list.

                monitor-addr                monitor-addr is the address of the  monitor  word  to  be
                changed.

                oldvalue                oldvalue is the value of the word before the change.

                newvalue                newvalue is to be the value of the word after the change.
                If you set UU.PHY using the instruction:

                     POKE. ac,UU.PHY

                monitor-addr                monitor-addr is assumed to be a physical memory  address.
                                            monitor-addr                If  you  do not set UU.PHY, monitor-addr is assumed to be
                an executive virtual address.

   Normal Return

        The value of the specified monitor word is changed.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          0    PKNPV%    Your job is not properly privileged.
          1    PKDIF%    The value of the given word  is  different  from
                                      oldvalue                         the value of oldvalue.
                                      monitor-addr          2    PKBAD%    The value of monitor-addr is not a valid monitor
                         address.

   Related Calls

        PAGE., PEEK., SPY











                                   22-307
   QUEUE. [CALLI 201]


                             QUEUE. [CALLI 201]                             QUEUE. [CALLI 201]

   Function

        Allows your program to communicate with system  components.   The
        actual  communication  is  accomplished  by QUEUE., using IPCF in
        your behalf, but the QUEUE. call allows you to  communicate  with
        system  components  using  standard argument block formats.  Some
        functions  provided  by  system  components  are  not  accessible
        through  QUEUE.,  and  in  these  cases  you must format your own
        IPCF. messages.  For example, QUEUE.  allows you to send messages
        to  the  GALAXY batch and spooling system, the accounting system,
        and site-specific components.

        Many of the implemented  functions  relate  directly  to  monitor
        commands.   Therefore,  information  about these functions can be
        obtained from the Commands Manual.

   Calling Sequence

                MOVE    ac,[XWD len,addr]
                QUEUE.  ac,
                  error return
                normal return
                . . .
        addr:   

                len        where:  len is the length of the argument list, and must be 5  or
                greater.

                addr                addr is the  address  of  the  argument  list,  which  is
                formatted as follows:

|       Argument         |==============================================|
|       Block     .QUFNC |    QF.FLG    |     QF.HLN    |    QF.FNC     |
|       Header           |----------------------------------------------|
|                 .QUNOD |                   Node-id                    |
|                        |----------------------------------------------|
|                        |  Length of (QR.LEN)  |  Pointer to (QR.BLK)  |
|                 .QURSP |    Response Block    |    Response Block     |
|                        |----------------------------------------------|
|                 .QUTIM |                                 |   QT.TIM   |
|                        |==============================================|
|       Argument         |     |                |                       |
|       Block            |     |                |                       |
|                 .QUARH |  I  |      QA.LEN    |        QA.TYP         |
|                        |----------------------------------------------|
|                 .QUARV |               Value or Pointer               |
|                        |==============================================|

















                                   22-308
                                                       QUEUE. [CALLI 201]


|       Each word of the argument block header is described below:

        ____   ______    ________        Word   Symbol    Contents

|       0      .QUFNC    Flags, header block length, and  function  code.
|                        The  flag  field (QB.FLG) is in Bits 0-11 of the
                         left half of the word, in which you can set  any
                         of the following flags:

                         ___     ______  _______                         Bit     Symbol  Meaning

                          0      QF.RSP  User wants acknowledgement  text
                                         returned    at    the    address
                                         specified  in  Word  2  of  this
                                         block, .QURSP.

                          1      QF.PIP  Your privileged job is  invoking
                                         privileges to perform privileged
                                         QUEUE.   call  functions.    You
                                         must   set   this  flag  to  use
                                         privileged functions of QUEUE.

                          2      QF.NBR  Non-blocking return.   The  call
                                         will  return  automatically, and
                                         the function will  be  performed
                                         while  your  program runs.  This
                                         flag     is     useful      with
                                         function .QUWTO   and   requires
                                         privileges.

|                        The length of the header block is  contained  in
|                        Bits 12-17, defined by the symbol QB.HLN.

                         The right half of word 0 contains  the  function
|                        code.   Function  codes are listed at the end of
|                        the argument header block description.

        1      .QUNOD    ANF-10  network  node  identifier.    You   must
                         specify  whether the function is to be performed
                         at  the  central  site  (where  the  program  is
                         running)  or  at a remote station.  If this word
                         is 0, the central site is assumed.  If  you  set
                         this  word to -1, the located node (defined by a
                         LOCATE command or monitor call) is used.

        2      .QURSP    Pointer to the first word of  a  block  reserved
                         for  acknowlegement  response  from  the  system
|                        component.  Data  is  read  from  this  word  if
|                        QF.RSP=1 in the function word.  If non-zero, the
                         .QURSP word  must  contain  the  length  of  the
                         response block in the left half (QU.LEN) and the
                         address of the first word of the response  block
                         in the right half (QU.BLK).

|       3      .QUTIM    This optional header word contains  the  maximum
|                        number  of  seconds  to wait for a response.  If
|                        the time is exceeded,  the  call  returns  error
|                        code  11.   If  this  word  contains  0,  or  is
|                        non-existent, there is no implied time limit  on
|                        the request.






                                   22-309
   QUEUE. [CALLI 201]


   The function codes that you can specify in Word 0 (.QUFNC) are:

        ____   ______    ________        Code   Symbol    Function

          -n             Reserved for use by customers.

          1    .QUPRT    Prints a file.

          2    .QUCDP    Punches a file on cards.

          3    .QUPTP    Punches a file on paper tape.

          4    .QUPLT    Plots a file.

          5    .QUBAT    Processes  the  file  under  BATCON,  the  batch
                         controller.

          6    .QUALC    Allocates a volume set.

          7    .QUDAL    Deallocates a volume set.

         10    .QUMNT    Mounts a volume set.

         11    .QUDIS    Dismounts a volume set.

         12    .QUWTO    Writes to operator.

         13    .QUWTR    Writes to operator with reply.

         14    .QUVAL    Validates an account.

         15    .QUMAE    Makes an accounting entry by sending  a  message
                         to  the ACTDAE program.  Refer to ACTSYM.MAC for
                         the format of accounting entries.

|       The argument header block is followed by the one or more argument
|       blocks.   These argument blocks each consist of a header word and
|       one or more data words.
|  
|       The header describes the data word.  If Bit 0 of the header  word
|       is  set,  the  data  words contain the value of the argument.  If
|       however, Bit 0 in  the  header  word  is  clear,  the  data  word
|       contains  the  address  of  the data block.  The remainder of the
|       header word provides the length and type code.






















                                   22-310
                                                       QUEUE. [CALLI 201]


|       The argument block, therefore, is formatted as follows:
|  
        ____   ______    ________|       Word   Symbol    Contents
|  
|        0     .QUARH    Contains information  about  the  data  word(s).
|                        Specifically:
|  
|  
                         ____    ______  ________|                        Bits    Symbol  Contents
|  
|                         0      QA.IMM  If this bit is set, the argument
|                                        for  the  function is a one-word
|                                        value,  contained  in  the  data
|                                        word.
|  
|                                        If this bit is clear,  the  data
|                                        word contains the address of the
|                                        data block (IFIW or GFIW).
|  
|                        6-17    QA.LEN  This field contains  the  number
|                                        of  words  in the data block.  A
|                                        value of zero is interpreted  as
|                                        one.
|  
|                        18-35   QA.TYP  This field contains the code for
|                                        the  type of data block that the
|                                        data word points to.
|  
|        1     .QUARV    Contains either the first word of the  value  of
|                        an  immediate  argument  for  the  function,  or
|                        contains the single-word address of a data block
|                        that contains the argument.

        Each function can be described by  one  or  more  types  of  data
        blocks.   The  data blocks are listed below in the order of their
        type codes.  Include  all  the  data  block  types  that  specify
        information  that is needed to perform the function you specified
        in .QUFNC.

|       Use the value of QA.IMM to specify the location of the data.   If
|       QA.IMM=1, the data words contain the data.  If QA.IMM=0, the data
|       word points to a data block.

        For the allocation, mounting, dismounting,  and  deallocation  of
|       volume  sets  (functions 6-11), you must first specify Block Type
|       37 (.QBVSN) to specify  the  magtape  volume  set  name  or  disk
|       structure  name.  Then list the data blocks that contain or point
        to data about the request.


















                                   22-311
   QUEUE. [CALLI 201]


        The data block types are:

        ____   ______    ________        Type   Symbol    Contents

         10    .QBFIL    File specification block.  You must include this
                         type  of  data  block for any function on a file
                         (such as printing a file).

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBFSR  SIXBIT structure name.
                           1     .QBFFL  SIXBIT file name.
                           2     .QBFEX  SIXBIT  extension.   The   right
                                         half of this word must be 0.
                           3     .QBFPP  UFD number (PPN).
                           4     .QBFS1  First level of SFD in SIXBIT.
                           5     .QBFS2  Second level of SFD (SIXBIT).
                           6     .QBFS3  Third level of SFD (SIXBIT).
                           7     .QBFS4  Fourth level of SFD (SIXBIT).
                          10     .QBFS5  Fifth level of SFD (SIXBIT).

        11     .QBCOP    Number of copies block:

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBCNO  Number of copies of the file  to
                                         be output.

        12     .QBFRM    Forms type block:

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBFTY  Forms type in SIXBIT.

|       13     .QBPTP    Print  file  type  block  (for  function  .QUPRT
                         only):

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBPCD  File format code.   Include  one
                                         of the following codes:

                         ____    ______  _______                         Code    Symbol  Meaning

                           1     .QBPAS  ASCII.
                           2     .QBPFR  FORTRAN.
                           3     .QBPCB  COBOL.
                           4     .QBPAI  Augmented image.
                           5     .QBPSA  Stream ASCII.
                           6     .QBP11  Eleven.
                           7     .QBPIM  Image.
                          10     .QBP8B  8-bit ASCII.














                                   22-312
                                                       QUEUE. [CALLI 201]


        ____   ______    ________        Type   Symbol    Contents

        14     .QBODP    Output disposition block.  Specifies the fate of
                         the file after the file is spooled.

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBODB  Output file disposition, one  of
                                         the following:

                         ____    ______  _______                         Code    Symbol  Meaning

                           0     .QBODK  Preserve    the    file    after
                                         processing it.
                           1     .QBODD  Delete the file after processing
                                         it.
                           2     .QBODR  Rename   the   file   into   the
                                         spooling    area,    effectively
                                         deleting it  from  the  original
                                         area immediately.

        15     .QBUNT    Unit type:

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBUDA  Device attributes  in  the  left
                                         half.  If .QBUPH is specified in
                                         the left half, you must  specify
                                         the  unit  number  in  the right
                                         half of this word.   The  device
                                         attribute codes are:

                         ____    ______  _______                         Code    Symbol  Meaning

                           1     .QBULC  Lowercase printer.
                           2     .QBUUC  Uppercase printer.
                           3     .QBUPH  Physical  device  (specify  unit
                                         number in right half).
                           4     .QBUGN  Generic device.

        16     .QBAFT    Specifies the date and time at which the request
                         should be processed.

                         ______  ______  _______                         Offset  Symbol  Meaning

                           0     .QBADT  Time  in   universal   date/time
                                         format.

        17     .QBLIM    Specifies the maximum number of units  to  which
                         the  job is limited.  For printer requests, this
                         is the number of pages.  For  batch  processing,
|                        this  refers  to number of seconds of processing
                         time, and so forth.

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBLNO  Number  of  pages,  seconds,  or
                                         appropriate limit.








                                   22-313
   QUEUE. [CALLI 201]


        ____   ______    ________        Type   Symbol    Contents

        20     .QBUNI    Specifies whether a batch job can  be  processed
                         at the same time as others from the same PPN, or
                         if only one batch job from this PPN can run at a
                         time.

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBNVL  Uniqueness code:

                         ____    ______  _______                         Code    Symbol  Meaning

                            1    .QBNNO  Does not need to be unique.
                            2    .QBNYE  Must be unique.

        21     .QBRES    Specifies  whether  a  batch   job   should   be
                         restarted   by   the  operator  if  the  job  is
                         terminated unexpectedly (by  a  system  failure,
                         for example).

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBRVL  Restart code:

                         ____    ______  _______                         Code    Symbol  Meaning

                            1    .QBRNO  Do not restart the job.
                            2    .QBRYE  Restart the job.

        22     .QBLOG    Specifies the circumstances under which to print
                         a log file of the batch job.

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBLVL  Output type code:

                         ____    ______  _______                         Code    Symbol  Meaning

                            1    .QBLNL  Never print a log file.
                            2    .QBLLG  Always print a log file.
                            3    .QBLLE  Print a log file only  when  the
                                         batch  job is terminated with an
                                         error.

        23     .QBACT    Account  string  block.   Specifies  the   ASCIZ
|                        account  string for a batch job.  Argument words
|                        .QBAC1 through .QBAC8 contain the ASCIZ string.

        24     .QBFNC    Reserved for use by DIGITAL.

        25     .QBNOD    Specifies the  node  at  which  the  actual  job
                         processing  should  be  done (destination node).
                         Node number must be a remote non-host station in
                         an ANF-10 network.

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBNND  Destination   node   number   or
                                         SIXBIT node name.






                                   22-314
                                                       QUEUE. [CALLI 201]


        ____   ______    ________        Type   Symbol    Contents

        26     .QBNAM    User's name block:

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBNM1  First word of SIXBIT user name.
                           1     .QBNM2  Second word of SIXBIT user name.

        27     .QBOID    Specifies the owner's PPN:

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBOPP  Owner's PPN.

        30     .QBNOT    Specifies whether to notify  the  job  when  the
                         request is finished.

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBNTL  Notify value:

                         ____    ______  _______                         Code    Symbol  Meaning

                            1    .QBNTY  Notify  job  when   request   is
                                         complete.
                            2    .QBNML  Reserved for use by DIGITAL.
                            3    .QBNJB  Reserved for use by DIGITAL.

        31     .QBBLT    Specifies the action to take on  the  batch  log
                         file:

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBBVL  One of the following:

                         ____    ______  _______                         Code    Symbol  Meaning

                            1    .QBBND  Append  output   log   file   to
                                         existing log file.
                            2    .QBBDE  Supersede existing log file.
                            3    .QBBSP  Spool  log   file   to   printer
                                         without  preserving  it  in your
                                         area.

        32     .QBJBN    Specifies the job name:

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBJNM  SIXBIT job name.

        33     .QBCDI    Contains the batch job's default path block  for
                         batch requests.

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBCPP  PPN.
                           1     .QBCS1  First word of PATH block.
                           2     .QBCS2  Second word of PATH block.
                           3     .QBCS3  Third word of PATH block.
                           4     .QBCS4  Fourth word of PATH block.
                           5     .QBCS5  Fifth word of PATH block.




                                   22-315
   QUEUE. [CALLI 201]


        ____   ______    ________        Type   Symbol    Contents

        34     .QBNTE    Specifies a note to  include  on  output  header
                         pages.

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBNM1  1 to 6 SIXBIT characters.
                           1     .QBNM2  1   to   6   SIXBIT   characters
                                         (maximum of 12 characters).

        35     .QBBGN    Specifies the page number of the file  to  begin
                         printing,  or  the line number or tag in a batch
                         file where processing should begin.

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBBPN  Beginning   page   number   (for
                                         printing),   line   number  (for
                                         batch jobs), or tag (in  SIXBIT)
                                         at  which  to begin processing a
                                         batch job.

        36     .QBPRI    Specifies the relative priority of the  request.
                         Unprivileged   users   can   specify  priorities
                         between 1  and  20,  and  privileged  users  can
|                        specify  a  priority  in  the  range of 1 to 62.
                         These limits  can  be  changed  by  GALGEN,  the
                         GALAXY   generation  program.   If  you  specify
                         priority  0  or  63,  the  default  priority  is
                         assumed.

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBPVL  Priority value (1 to 62).

        37     .QBVSN    Contains the ASCIZ volume set name.

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBVAS  Beginning of  ASCIZ  volume  set
                                         name.

        40     .QBMSG    Contains the WTO/WTOR message block:

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBMAS  Beginning of the  ASCIZ  message
                                         for the operator.

        41     .QBTYP    Contains the privileged  WTO/WTOR  message  type
                         block.   WTO  sends  message to operator without
                         requiring response.  WTOR requires response from
                         operator.

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBTAS  Beginning of ASCIZ  message  for
                                         the operator.







                                   22-316
                                                       QUEUE. [CALLI 201]


        ____   ______    ________        Type   Symbol    Contents

        42     .QBDEN    Specifies the tape density:

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBTDN  Tape density code.  Refer to the
                                         .TFDEN  function  of  the TAPOP.
                                         call.

        43     .QBTRK    Specified the tape track code:

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBDRV  Tape track request code:

                         ____    ______  _______                         Code    Symbol  Meaning

                            1    .QBDR9  9-track tape.
                            2    .QBDR7  7-track tape.

        44     .QBLTP    Specifies the tape label type.

                         ______  ______  ________                         Offset  Symbol  Contents

                           0     .QBLAB  Label type code.  Refer  to  the
                                         .TFLBL  function  of  the TAPOP.
                                         call.

        45     .QBRMK    Specifies the remark text:

                         ______  ______  _______                         Offset  Symbol  Meaning

                           0     .QBREM  Start of ASCIZ remark to be sent
                                         to operator with request.

        46     .QBVOL    Specifies the tape volume list:

                         ______  ______  _______                         Offset  Symbol  Meaning

                           0     .QBVLS  Start of  list  of  SIXBIT  tape
                                         volume  identifiers.   A maximum
                                         of 63 volumes is allowed.

        47     .QBLNM    Specifies the volume set logical name:

                         ______  ______  _______                         Offset  Symbol  Meaning

                           0     .QBLGN  SIXBIT  logical  name  for  this
                                         volume set.

        50     .QBMFG    Specifies  MOUNT/DISMOUNT  flags,  indicated  by
                         setting/clearing bits in the following word:

                         ______  ______  _______                         Offset  Symbol  Meaning

                           0     .QBMDF  Flags to control  the  MOUNT  or
                                         DISMOUNT request:








                                   22-317
   QUEUE. [CALLI 201]


        ____   ______    ________        Type   Symbol    Contents

                         ____    ______  _______                         Flag    Symbol  Meaning

                           0     QB.PAS  Add the structure to the passive
                                         search  list (active search list
                                         is default).
                           1     QB.EXC  Exclusive/sharable        access
                                         (sharable  is  default for disk,
                                         exclusive is default for tapes).
                           2     QB.NOC  Prevent files from being created
                                         on the volume set.  (The default
                                         is to allow file creation.)
                           3     QB.DSK  This is a  disk  file  structure
                                         request.
                           4     QB.TAP  This is a magtape request.
                           5     QB.WLK  Write-lock   the   volume    set
                                         (default for magtapes).
                           6     QB.WEN  Write-enable  the   volume   set
                                         (default for disk).
                           7     QB.REM  Ask  operator  to   remove   the
                                         structure when you dismount it.
                           8     QB.SCR  Ask  the  operator  to  mount  a
                                         scratch tape.
                           9     QB.ARD  Always recompute disk usage.

        51     .QBAFN    Specifies   the   accounting   daemon   (ACTDAE)
|                        subfunction.    .QBAFN   is   not  intended  for
|                        customer use.  To use this privileged  function,
                         you  must  set the flag QF.PIP in the first word
                         of the argument block.

|       52     .QBAET    Specifies the usage entry type.   This  type  is
|                        not intended for customer use.

                           To use this privileged function, you must  set
                           QF.PIP  in  the  first  word  of  the argument
                           block.
|  
|       53     .QBTTY    Contains a SIXBIT terminal name.  This block  is
|                        not   intended   for  customer  use.  .QBTTY  is
|                        included in the IPCF message the  monitor  sends
|                        to ORION for a 'SEND OPR' command.
|  
|       54     .QBFNT    Contains a  six-word  (maximum)  argument  block
|                        that  specifies  a  font name.  LPTSPL uses this
|                        ASCIZ string to locate the requested font  file.
|                        Argument words are .QBFN0 to .QBFN5.
|  
|       55     .QBEVT    Specifies an event to take place at the interval
|                        requested  in  .QBREP  (Type 56).  .QBEV0 is the
|                        argument word containing one  of  the  following
|                        options:
|  
                         ____    ______  _____|                        Code    Symbol  Event
|  
|                          1     EV.KSY  KSYS
|                          4     EV.ATO  Time-of-day
|                          5     EV.USG  Usage file closure
|                          6     EV.BIL  Billing file closure
|                          7     EV.OPR  ORION log file closure





                                   22-318
                                                       QUEUE. [CALLI 201]


        ____   ______    ________|       Type   Symbol    Contents
|  
|       56     .QBREP    Repeats the event requested  in  .QBEVT  at  the
|                        interval  given  in  the  .QBRP0  argument word.
|                        .QBRP0 contains one of the following options:
|  
                          ____   ______  _______|                         Flag   Symbol  Meaning
|  
|                         0      QB.NOW  Event happens now.
|                         1      QB.DLY  Event happens daily.
|                         2      QB.WKY  Event happens weekly.
|                         3      QB.TIM  Event happens at specified time
|  
|                        Or, you may specify .QB.RP0  as  day,,-1,  where
|                        day is the day of the week when the event occurs
|                        (Wednesday=0, Thursday=1, and so on.)
|  
|       57     .QBESW    Contains the event  switch  block.   This  block
|                        holds  two words.  .QBESD is the event-dependent
|                        switch   value   word,   and   .QBESI   is   the
|                        event-independent  switch  value  word.  You may
|                        specify one of the following flags for .QBESI:
|  
                           ____  ______  _______|                          Flag  Symbol  Meaning
|  
|                           0    QB.FSF  Failsoft option.
|  
|                           1    QB.NFS  No failsoft.
|  
|       60     .QBAST    Sets the OPR intervention  bit  to  one  of  the
|                        following:
|  
                           ___   ______  _______|                          Bit   Symbol  Meaning
|  
|                           1    .QBOIY  Enable OPR intervention.
|                           2    .QBOIN  Disable OPR intervention.
|  
|       61     .QBPRC    Sets the IBM /PROCESSING node.
|  
|       62     .QBOPT    Specifies a SIXBIT batch option name.  .QBOP0 is
|                        the offset to the option name.
|  
|       63     .QBDIS    Specifies   text   to   be   printed    for    a
|                        DISTRIBUTION: header.   .QBDI0  is the offset to
|                        the first word of ASCIZ data.
|  
|       64     .QBUSR    Specifies   text   to   be   printed    for    a
|                        USERNAME: header.   .QBUS0  is the offset to the
|                        first word of ASCIZ data.

   Normal Return

        On the return from QUEUE., the IPCF messages have  been  sent  to
        appropriate  components.   If you requested a response by setting
                                                             ac        QF.RSP, the following information is returned in the ac:

        ____   ______    _______        Bits   Symbol    Meaning

        18     QU.RBT    Response from GALAXY was too long  for  reserved
|                        space  (as  specified  in  .QURSP) and had to be
                         truncated.
        19     QU.RBR    Response from GALAXY was returned.
        23-35  QU.RBL    Contains the length  of  the  returned  response
                         from GALAXY.


                                   22-319
   QUEUE. [CALLI 201]


   Error Return

        The error codes and their meanings are:

         ____   ______    _______         Code   Symbol    Meaning

           1    QUIAL%    Illegal argument list.
           2    QUILF%    Illegal function.
           3    QUNFS%    No monitor free core.
           4    QUADC%    Address check.
           5    QUCNR%    Component not running or has no system PID.
           6    QUFER%    Fatal error returned from ORION.
           7    QUSOC%    Invalid message from ORION.
          10    QUNPV%    Insufficient privileges.
|         11    QUTMO%    Timeout limit exceeded.



















































                                   22-320
                                                        REASSI [CALLI 21]


                             REASSI [CALLI 21]                             REASSI [CALLI 21]



   Function

        Reassigns or deassigns a device for  a  job.   Your  program  can
        reassign a device if the device is assigned to your job, or if it
        is not  assigned  to  any  job.   Restricted  devices  cannot  be
        reassigned  by unprivileged jobs.  The logical name assignment is
        also cleared, unless the calling job has JACCT privileges  or  is
        logged in under [1,2].

   Calling Sequence

                MOVEI   ac,jobno
                MOVE    ac+1,[SIXBIT/device/]  \
                MOVEI   ac+1,channo            |
                MOVEI   ac+1,udx               /
                REASSI  ac,
                return

                jobno        where:  jobno is the number of  a  logged-in  job  to  which  the
                device  is  to  be  reassigned.   Use  -1 to indicate the
                current job or 0 to deassign the device.

                device                device is the  SIXBIT  physical  or  logical  name  of  a
                device.

                channo                channo is the number of an initialized channel.

                udx                udx is the Universal Device Index for a device.

   Return

               ac        If the ac is unchanged on the return from the call, the device is
        reassigned as requested.

                                                                jobno        If the device is restricted and you  specified  0  for  jobno  to
        deassign  the  device,  it  is  returned  to the system's pool of
        restricted devices.

        A restricted device can be reassigned to an unprivileged job only
        by a privileged job.

        On the return from this call, the monitor  performs  an  implicit
        RELEAS  monitor call for the device, unless you specified 0 or -1
                jobno        for the jobno.

               ac                               jobno        If the ac is cleared on the return, the jobno was not a valid job
        number.

               ac        If the ac contains -1 on the return, the device is  not  assigned
        to  the  specified  job.   The  device  is your job's controlling
        terminal, or the device name given is a duplicate of an  existing
        logical device name.

           ac        If ac+1 is cleared on a return from the call, the device  is  not
        assigned  to  your job, or the device you specified was a disk or
        your job's controlling terminal.






                                   22-321
   REASSI [CALLI 21]


   Common Errors

         o  Forgetting that there is only one return  location  from  the
            call.

         o  Attempting to assign a restricted device.

   Related Calls

        DEVLMN
























































                                   22-322
                                                       RECON. [CALLI 202]


                             RECON. [CALLI 202]                             RECON. [CALLI 202]



   Function

        Performs tasks to aid system reconfiguration and diagnosis.  This
        call is not recommended for use by customer programs and requires
        [1,2] or JACCT privileges.  It  is  used  by  the  CONFIG  system
        facility  to take system snapshots, suspend the system, and other
        system-wide functions.  To perform the functions offered  by  the
|       RECON. call,  use  the  CONFIG command level from the OPR program
                           _______ __________ _______ ________  _________|       (documented in the TOPS-10 Operator's Command Language  Reference
        ______|       Manual),  because  the functions must be performed in the correct
        order or the system will fail to continue.

   Calling Sequence

|               MOVE    ac,[fcncode,,addr]
                RECON.  ac
                  error return
                normal return
        addr:   argument-block

                fcncode        where:  fcncode is one of the functions described below.

                addr                addr  contains  an  argument  block.   The  data  in  the
                argument   block  depends  on  the  function  code.   For
                functions that do not require  an  argument,  use  0  for
                addr                addr.

        The function codes, their meanings, and argument blocks are:

        ____   ______    _______        Code   Symbol    Meaning

          0    .RCROM    Prevents execution of all  jobs  on  the  system
                                                             addr                         except  the job number specified in addr+1.  Use
                         -1 for current job.  If the job number is 0, the
                         function  is  to resume normal timesharing.  The
                         argument block for this call is:

                                 MOVE    ac,[.RCROM,,addr]
                                 RECON.  ac,
                                   error return
                                 normal return
                                 . . .
                         addr:   2       ;length of argument block
                                 jobno   ;contains -1 for current job

          1    .RCSPN    Causes  a  suspension   of   the   system.    To
                         accomplish  this,  the  monitor writes a copy of
                         memory to CRASH.EXE on disk, and the  system  is
                         halted.  This last action is taken as the result
                         of the CONFIG command  SUSPEND.   This  function
                         does  not  require  an  argument  block,  so the
                         calling sequence is:

                                 MOVE    ac,[.RCSPN,,0]
                                 RECON.  ac,
                                   error return
                                 normal return





                                   22-323
   RECON. [CALLI 202]


        ____   ______    _______        Code   Symbol    Meaning

          2    .RCCI7    Causes the  monitor  to  perform  a  continuable
                         stopcode  (stopcode CI7), take a dump of memory,
                         and continue automatically.  This dump is called
                         a   "snapshot,"   and  allows  you  to  diagnose
                         problems by obtaining a dump without halting the
                         system.  The .RCCI7 function does not require an
                         argument block, so the  calling  sequence  looks
                         like:

                                 MOVE    ac,[.RCCI7,,0]
                                 RECON.  ac,
                                   error return
                                 normal return

          3    .RCNAR    Clears and sets the DF.NAR  bit  in  the  DEBUGF
                         word,  which  controls whether the system should
                         automatically    reload    on    non-continuable
                         stopcodes.   The  DEBUGF  word is defined in the
                         monitor symbol file S.MAC,  and  is  manipulated
                         during  analysis  of system errors.  By default,
                         DF.NAR is set, and automatic reload is  enabled.
                         You  can  clear  the  bit to prevent auto-reload
                         when debugging the  system,  but  this  function
                         requires that you be logged in under [1,2].

                         The DF.NAR bit is set/cleared according  to  the
                         second word in the argument block.  If Word 1 of
                         the argument is 0, the DF.NAR  is  cleared,  and
                         automatic reload is enabled (default state).  If
                         you place a non-zero value in Word 1, DF.NAR  is
                         set,  and  the  system  will  not  automatically
                         reload  on  a  non-continuable  stopcode.    The
                         calling sequence for this function is:

                                 MOVE    ac,[.RCNAR,,addr]
                                 RECON.  ac,
                                   error return
                                 normal return
                                 . . .
                         addr:   2       ;length of argument block
                                 -1      ;to disable auto-reload

          4    .RCBTX    Changes the BOOTXT command string to the command
                         string you specify in the argument.  The calling
                         sequence for this function is:

                                 MOVE    ac,[.RCBTX,,addr]
                                 RECON.  ac,
                                   error return
                                 normal return
                                 . . .
                         addr:   n             ;length of argument block
                                 command-list  ;first word

                               n                         where n is the length of the command string  (in
                         words) + 1.  The command string cannot exceed 16
                         words, and cannot include line-feeds; therefore,
                                                n                         the  maximum value for n is 17.  For information
                         about the BOOTXT command string, refer to BTXLEN
                         in the COMMON monitor source file.




                                   22-324
                                                       RECON. [CALLI 202]


        ____   ______    _______        Code   Symbol    Meaning

          5    .RCRLD    Causes the system to be reloaded.   The  monitor
                         will  be  reloaded  from  the  file specified in
                         BOOTXT, and a crash dump  will  be  taken.   You
                         must  be  logged into [1,2] to use this function
                         (JACCT privileges  alone  are  not  sufficient).
                         This  function  causes  an RLD stopcode and does
                         not  require  an  argument  list.   The  calling
                         sequence for this function is:

                                 MOVE    ac,[.RCRLD,,0]
                                 RECON.  ac,
                                   error return
                                 normal return

          6    .RCRAC    Causes auto-configuration (AUTCON) to run on the
                         specified   CPU(s)  to  automatically  configure
                         disks and tapes into the  monitor's  data  base.
                         You  must  be  logged  in  as  [1,2] to use this
                         function.   The  calling   sequence   for   this
                         function is:

                                 MOVE    ac,[.RCRAC,,n]
                                 RECON.  ac,
                                   error return
                                 normal return

                               n                                n                         where n specifies the CPU number.  If  n  =  -1,
                         AUTCON will run on all CPUs.
|  
|         7    .RCDET    Detaches a CPU or a device as specified  in  the
|                        argument  block.   The  calling  sequence  is as
|                        follows:
|  
|                                 MOVE    ac,[.RCDET,,addr]
|                                 RECON.  ac,
|                                   error return
|                                 normal return
|  
|                        addr:    2       ;length of argument block
|                                 SIXBIT CPU name
|                                      or
|                                 SIXBIT device name
|  
|         10   .RCATT    Attaches  a  CPU  or  device  specified  in  the
|                        argument block.  The calling sequence for .RCATT
|                        is:
|  
|                                 MOVE    ac,[.RCDET,,addr]
|                                 RECON.  ac,
|                                   error return
|                                 normal return
|  
|                        addr:    2       ;length of argument block
|                                 SIXBIT CPU name
|                                      or
|                                 SIXBIT device name
|  
|         11   .RCMON    Sets a given range of memory on-line.  The range
|                        is  given  in  two  words of the argument block.
|                        The first word specifies the first page  of  the
|                        range,  and  the second word indicates the first
|                        page beyond the range.  The calling sequence is:


                                   22-325
   RECON. [CALLI 202]


|                                 MOVE    ac,[.RCMON,,addr]
|                                 RECON.  ac
|                                   error return
|                                 normal return
|  
|                        addr:    3       ;length of argument block
|                                 first page in range
|                                 last page in range +1
|  
|         12   .RCMOF    Sets a given  range  of  memory  off-line.   You
|                        specify  the  range  the same way as for .RCMON.
|                        The calling sequence is:
|  
|                                 MOVE    ac,[.RCMOF,,addr]
|                                 RECON.  ac
|                                   error return
|                                 normal return
|  
|                        addr:    3       ;length of argument block
|                                 first page in range
|                                 last page in range +1
|  
|         13   .RCCPU    Returns the CPU accessibility  mask.   The  mask
|                        indicates  which  CPU  is  using  the  specified
|                        device.  The calling sequence for .RCCPU is:
|  
|                                 MOVE    ac,[.RCCPU,,addr]
|                                 RECON.  ac,
|                                   error return
|                                 normal return
|  
|                        addr:    2       ;length of argument block
|                                 SIXBIT device name
|  
|                        The bit mask returned in the ac indicates  which
|                        CPU is associated with the device.  For example,
|                        IB35=CPU.
|  
|         14   .RCIOW    Indicates when I/O on the  system  is  complete.
|                        The calling sequence is:
|  
|                                 MOVSI   ac,.RCIOW
|                                 RECON.  ac,
|                                   error return
|                                 normal return
|  
|                        The return occurs after active I/O on the system
|                        has finished.

   Normal Return

        The specified function is performed.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          1    RCIAL%    Illegal argument list.
          2    RCNPU%    Not privileged.
          3    RCNTS%    Timesharing already stopped on some CPU.
          4    RCNIJ%    Illegal job number.
          5    RCNCD%    This function cannot be performed.


                                   22-326
                                                       RECON. [CALLI 202]


          6    RCNAC%    Address check.
          7    RCNIS%    Illegal command string for BOOTXT.
         10    RCICN%    Illegal CPU number.
|        11    RCNCR%    CPU still running.
|        12    RCNCA%    Can't attach disk.
|        13    RCNDS%    Device is spooled.
|        14    RCNAA%    Device is already attached.
|        15    RCNID%    Illegal device.
|        16    RCNDU%    Device is in use.
|        17    RCNND%    Can't detach disk.
|        20    RCNNL%    Can't set memory off-line.
|        21    RCNMM%    Can't remove monitor memory.
|        22    RCNTB%    Job or jobs too big.
|        23    RCNLJ%    Can't move locked job(s).




















































                                   22-327
   RELEAS [OPCODE 071]


                            RELEAS [OPCODE 071]                            RELEAS [OPCODE 071]



   Function

|       Releases an I/O channel.  Use FILOP. to perform a  RELEAS  on  an
|       extended I/O channel.

   Calling Sequence

                RELEAS  channo,
                return

                channo        Where:  channo is the number of an initialized channel.

   Return

        The  device   is   released,   the   channel   is   closed,   any
        device-dependent  operations are performed, and any enqueue locks
        are released.

        If the given channel is not initialized,  the  monitor  takes  no
        action.

   Examples

        See Chapter 11, Volume 1.

   Common Errors

        Forgetting the comma after the channel number.

   Related Calls

        FILOP.






























                                   22-328
                                                         REMAP [CALLI 37]


                              REMAP [CALLI 37]                              REMAP [CALLI 37]



   Function

        Moves the specified portion of a program's low segment  into  the
        high  segment,  discarding  the  old  high  segment from the user
        addressing space.  The new low segment will be the  previous  low
        segment  minus the amount remapped.  This monitor call is used by
        the LINK program when you use the EXECUTE monitor command.

|       The .PAGCH function of the PAGE UUO has the  same  capability  as
|       REMAP, but is more flexible.

   Calling Sequence

                MOVE  ac,[XWD origin,addr]
                REMAP ac,
                  error return
                normal return

                addr        where:  addr is the highest address in the low segment (that  is,
                the first address of the new high segment).

                origin                origin is the origin of the high segment.

        The monitor waits until all I/O is completed in the  low  segment
        before executing the REMAP monitor call.  Then the monitor rounds
        the address to the nearest  core  allocation  unit  (512  decimal
        words).

   Normal Return

                                            addr         o  The monitor stores the value of addr in the  location  .JBREL
            in the job data area.

         o  The monitor sets the left half of .JBHRL to zero (it  deletes
            the previous high segment).

         o  The monitor stores the highest legal  user  address  for  the
            high segment in the right half of .JBHRL.

         o  The monitor changes the hardware mapping.

         o  The monitor sets the user-mode  write-protect  bit  (the  new
            high segment is non-sharable).

                                ac         o  The contents of the ac are preserved.

   Error Return

        The monitor takes the  error  return  if  any  of  the  following
        conditions is found:

         o  A negative argument is specified.

         o  The requested remapping would cause  the  high  and  the  low
            segments to overlap.

         o  The sum of the high segment  origin  plus  its  length  would
            cause  the  high  segment  to  start  (or  end) at an address
            outside the program's virtual address space (that is, greater
            than or equal to 256K).


                                   22-329
   REMAP [CALLI 37]


         o  The specified argument exceeds the length of the low segment.
            Also,  remapping  will  not  occur, and the high segment will
            remain unchanged in the user's address space.

         o  The segment is locked in memory.


   Related Calls

        CORE, GETSEG, MERGE., PAGE.
























































                                   22-330
                                                      RENAME [OPCODE 055]


                            RENAME [OPCODE 055]                            RENAME [OPCODE 055]



   Function

        Performs one or more of the following functions:

         o  Alters  file  attributes,  including  the  file  name,   file
            extension, and access privilege code of the file.

         o  Changes an SFD name.

         o  Deletes the specified file.

         o  Performs an implicit CLOSE.

|       Use FILOP. to perform a RENAME on an extended I/O channel.

   Calling Sequence

                RENAME  channo,addr
                  error return
                normal return

                channo        where:  channo is the number of an initialized channel.   If  the
                channel  is  an  extended  channel,  use  FILOP. function
                .FORNM.

                addr                addr is the address of the argument list.   The  argument
                list  is equivalent to that of LOOKUP and ENTER calls and
                is described in Section 11.13.

        RENAME has two forms of argument block:  the four-word block  and
        the  extended  argument  block.  The short-form (4-word) argument
        list is described in Section 11.13.1.  The extended argument list
        is  described  in  Section  11.13.2.  For DECtape files, refer to
        Chapter 13 for descriptions of the arguments.

        The only way that your program can RENAME a file into or  out  of
        an  SFD is to refer to an explicit path using the PATH.  argument
        block (by including  an  [XWD  0,addr]  instruction  as  the  PPN
        argument).   If  a  RENAME  is given that attempts to move a file
        into or out of an SFD without specifying  an  explicit  path,  it
        will  take  the normal return (assuming no other errors), but the
        file will not change directories.

        To delete a file after all read references have been  made,  your
        program  should  specify  the value of zero in the address of the
        file name word in the RENAME block.

        A delete function on a  channel  that  is  open  for  output,  to
        supersede  a  file,  simply  aborts the creation of the new file.
        This is equivalent to a CLOSE with CL.RST set.

        Although only a privileged job can delete a UFD, an  unprivileged
        job can delete an empty SFD.  Note that you must set your path to
        a different area before you can delete the current SFD.   If  the
        directory  is  not  empty  or  if  a  job  is currently using the
        directory, the monitor returns  the  DIRECTORY  NOT  EMPTY  error
        code.





                                   22-331
   RENAME [OPCODE 055]


        A CLOSE is optional after a RENAME because  a  RENAME  implicitly
        performs  a CLOSE.  A CLOSE should not be issued between a LOOKUP
        and a RENAME if the file is not in the  default  directory  path,
        because  the  CLOSE  erases all memory of the path.  If RENAME is
        performed and the file is not in the default  path,  the  monitor
                                                              addr        returns the FILE NOT FOUND error in the right half of addr+1.

   Restriction

        If your program attempts to change the extension  of  an  SFD,  a
        protection  error results.  An error also results if your program
        attempts to alter the name, extension, or PPN associated  with  a
        UFD or the PPN associated with an ersatz device name.

   Normal Return

        On a normal return, the monitor returns the same information on a
        RENAME as on a LOOKUP and ENTER.  Refer to Section 11.13.

   Error Return

        The error return is taken under the following conditions:

         o  No file has been opened on the specified channel.

         o  The specified file cannot be found.

         o  The specified file is  currently  in  the  process  of  being
            written, superseded, or renamed.

         o  Your program does not  have  the  appropriate  privileges  to
            RENAME the file.

         o  The new file name already exists (occurs when  changing  file
            names).

        The monitor returns the error code for the RENAME monitor call in
                           addr        the  right half of addr+1 of the 4-word argument block, or in the
                      addr        right half of addr+3 in the extended argument block.   The  error
        code  overwrites  the  high-order three bits of the creation date
        and the entire access date.

        This overwriting of data does not cause any problems for programs
        that recover from RENAME errors by aborting or by re-initializing
        the argument list.  However, programs  that  attempt  to  recover
        from  an  error  by  fixing  only  the  incorrect  portion of the
        argument block and  then  reexecuting  the  monitor  call  should
                                  addr      addr        restore the right half of addr+1 or addr+3 before reexecuting the
        RENAME monitor call.  Error codes are restricted to a maximum  of
        15 bits to allow programs to recover from an error in a file with
        a zero creation date.  See Section 11.14  for  a  list  of  error
        codes.














                                   22-332
                                                      RESCAN [TTCALL 10,]


                            RESCAN [TTCALL 10,]                            RESCAN [TTCALL 10,]



   Function

        Resets the input buffer pointer to point to the beginning of  the
        previous  command.   Note  that if the RESCAN UUO is issued after
        the first terminal input or output instruction, the command is no
        longer in the buffer.

   Calling Sequence

                RESCAN  flag
                  return 1
                  return 2

                flag        where:  flag controls the action of returning from the call.  The
                flag  is bit 35 of the word.  If the flag is not set, the
                                       return 1                call always returns at return 1.  If the flag is set, the
                                 return 2                call  returns at return 2 when no command is in the input
                                                  return 1                buffer, otherwise, the call takes return 1.

   Example

                RESCAN 1        ;Read TTY input
|               SKPINL          ;Is anything there?
|                 JRST  PROMPT  ;No, must be typeahead
                                ;Read command line
                  . . .

   Common Errors

        Placing a comma after the flag.
































                                   22-333
   RESDV. [CALLI 117]


                             RESDV. [CALLI 117]                             RESDV. [CALLI 117]



   Function

        Resets a specified channel.  RESDV. is similar to  RESET,  except
        that  only  one  channel  is  reset  and  any outstanding data is
        discarded.  If RESDV.  is performed on a disk device, the file is
        discarded (refer to the CLOSE function CL.RST).

   Calling Sequence

                MOVEI   ac,channo
                RESDV.  ac,
                  error return
                normal return

                channo        where:  channo is the number of an initialized channel.

   Normal Return

        The channel is reset.  Files  that  were  being  created  on  the
        channel  are  deleted; any older files with the same name remain.
        All I/O for the channel is stopped, and device  allocations  made
        on  the  channel  by  INIT,  OPEN,  or FILOP. are closed.  If the
        device was not assigned by ASSIGN, ALLOCATE, REASSI, or MOUNT, it
        is returned to the monitor's pool of available devices.  (See the
        Commands Manual for descriptions of these three commands.)

   Error Return

               ac        If the ac contains -1, no device was associated with the channel.

   Related Calls

        CLOSE, RELEASE, RESET

   Common Errors

        Placing the channel number in the ac field.

























                                   22-334
                                                          RESET [CALLI 0]


                              RESET [CALLI 0]                              RESET [CALLI 0]



   Function

        Initializes a program.  Resets the program's runtime  environment
        to its initial state.

   Calling Sequence

                RESET
                return

   Return

        The monitor initializes the program.  This includes the following
        functions:

         o  Clears  all  device  allocations  except  those  for  devices
            assigned by ASSIGN, REASSI, or MOUNT.

         o  Sets the job's first free location (right half of  .JBFF)  to
            its  starting value (left half of .JBSA).  This allows buffer
            space to be reclaimed when the program is restarted.

         o  Clears  the  left  half  of  .JBFF  (the  job's  first   free
            location).

         o  Deletes any files that have not been closed.

         o  Sets the user-mode write-protect bit for  the  high  segment.
            This  prevents  inadvertent data storage in the high segment,
            and is done even if the segment is nonsharable.

         o  Unlocks your program, if it is locked in core.

         o  Releases any realtime devices.

         o  Resets any high-priority queue values to the value  given  in
            the last HPQ command.

         o  Resumes timesharing if it was stopped  by  a  TRPSET  monitor
            call.

         o  Resets any actions taken by APRENB, HIBER, or UTRP.   monitor
            calls in your program.

         o  Clears all program counter flags  for  your  program  (except
            USRMODE and PUBLIC) that may be set.

         o  Clears any  process  identifications  (PIDs)  for  your  job,
            except job-wide PIDs.

         o  Clears the software interrupt facility for your job.

         o  Releases and dequeues any enqueue locks or requests for  your
            job.








                                   22-335
   RESET [CALLI 0]


         o  Clears all of the data mode bits and the  noecho  bit  for  a
            terminal.    However,   if   the  RESET  is  executed  for  a
            not-logged-in job, whose program name is  LOGIN,  the  noecho
            bit will not be cleared.  This allows noecho to be set by the
            LOGIN command.

         o  Removes and undefines all SNOOP.  breakpoints.



























































                                   22-336
                                                         RTTRP [CALLI 57]


                              RTTRP [CALLI 57]                              RTTRP [CALLI 57]



   Function

        Connects a device to or releases it from the  realtime  interrupt
        facility.  For a discussion of realtime devices, interrupt modes,
        and traps, refer to Chapter 9, Volume 1.

        To use the RTTRP call, your job must have the  JP.RTT  privilege.
        To use an EPT-mode trap, your job must have the JP.TRP privilege.
        Your job must also have the JP.LCK privilege  in  order  to  lock
        itself in core on the correct CPU.

   Calling Sequence

                MOVEI ac,addr
                RTTRP ac,
                  error return
                normal return
                . . .
        addr:   argument list

                addr        where:  addr is the address of the argument list.

        The contents of the argument list depend on  the  interrupt  mode
        your program is setting up.

   Normal Return

        The  device  is  connected  to  or  released  from  the  realtime
        interrupt facility.

   Error Return

        The monitor returns one or more of the following error  flags  in
             ac        the  ac.  Before returning, the monitor scans the entire argument
        list to discover as many errors as possible.

        ___    ______    _____        Bit    Symbol    Error

         23    RTNEC%    Nonexistent CPU.
         24    RTJNP%    Not enough privileges.
         25    RTNC0%    Not runnable on CPU0.
         26    RTDIU%    Device in use by another job.
         27    RTIAU%    Illegal  accumulator  used   during   RTTRP   at
                         interrupt.
         28    RTJNL%    Job not locked (or not privileged).
         29    RTSLE%    System limit for realtime devices exceeded.
         30    RTILF%    Illegal format for I/O instruction.
         31    RTPWI%    Pointer word illegal.
         32    RTEAB%    Error address out of bounds.
         33    RTTAB%    Trap address bad.
         34    RTPNB%    PI   channel   not   currently   available   for
                         BLKI/BLKO.
         35    RTPNA%    PI channel not available.


   Related Calls

        HPQ, TRPSET, UJEN




                                   22-337
   RUN [CALLI 35]


                               RUN [CALLI 35]                               RUN [CALLI 35]



   Function

        Transfers execution control from the current program  to  another
        program.   The monitor replaces both the high and low segments of
        your address space with the segments of the called program.   The
        function  of the RUN UUO is described in more detail in Chapter 2
|       Volume 1.

   Calling Sequence

                MOVSI   ac,start-addr-increment
                HRRI    ac,addr
                RUN     ac,
                  error return
                . . .
        addr:   SIXBIT/device/
                SIXBIT/filename/
                SIXBIT/extension/           ;or zero
                EXP     0
|               XWD     proj,prog\
|               XWD     0,addr1  /
                XWD     0,core   \          ;or zero
|               XWD     -1,,addr2/          ;optional

                start-addr-increment        where:  start-addr-increment is  an  increment  to  the  starting
                address of the called program.  This increment is used to
                call indirect command files and should be 0 or 1.  If any
                other value is used, the meddling bit is set for the job,
                unless the program is execute-only.  For an  execute-only
                program, this value can be only 0 or 1.

                addr|               addr is the address of the 6- or 7-word argument block.

                device                device is the logical or  physical  name  of  the  device
                where the program being called resides.

                filename                filename is the name of the file being called (containing
                either or both high and low segments).

                extension                extension is the file extension of the low  segment  file
                (normally .EXE or blank).

                proj,prog|               proj,prog specifies the owner of the called program.   If
                this  word  is  zero, the monitor assumes that the called
                program is in  your  directory  (that  is,  your  PPN  is
                assumed),  or  the  PPN  is determined from the directory
                name  (for  example,  SYS=[1,4]).   If   this   word   is
|               [XWD 0,addr1],  addr1 points to a PATH.  block containing
                the complete path for the file.  Refer to the description
                of  the PATH.  monitor call for information pertaining to
                the format of the PATH.  block.

                core                core is the total amount of core to be reserved  for  the
                called  program.   This word must be included, but may be
                zero.  For a program that  contains  both  low  and  high
                segments,  the  amount  of core required to load the high
                segment is subtracted from  the  core  assignment  first.
                The amount reserved for the low segment is the remainder.




                                   22-338
                                                           RUN [CALLI 35]


|       addr2   contains a section  number  indicating  where  the  image
|               should  be  loaded.   Using  this  argument results in an
|               error if the .EXE file is not a single section program in
|               Section 0.

        Normally your program sets up only the first  two  words  of  the
        argument  block,  leaving  the  rest of the words in the argument
        block zero.

        You can omit values and accept defaults for all parameters in the
                             device     filename        argument list except device and filename.  The defaults are:

                extension                extension  defaults to .EXE.
                PPN                PPN        defaults to your PPN.
                core                core       defaults to the amount  required  by  the  new
                           program.

   Normal Return

        The  new  program  is   started   at   its   new   address   plus
        start-addr-increment                     ac        start-addr-increment.   The  contents of ac may be changed on the
        return, and the new contents  are  unpredicatable,  because  they
        vary  from  one  monitor  release to the next.  The RUN call also
        performs an implicit RESET call.

   Error Return

        The error return is taken if any errors are detected; the monitor
                                         ac        returns  an  error  code  in the ac.  Your program can attempt to
        recover from an error and continue the program's  execution.   If
        you set the left half of the error return location to a HALT, the
        monitor will not return to the program but will  print  an  error
        message.  Your terminal will be at monitor level.

        If you do not include a HALT in the left half of the error return
        location, your program can analyze the error code returned in the
        ac        ac.  If the error code indicates an  error  from  which  you  can
        recover,  your  program  can  issue  another  RUN  monitor  call,
        possibly  including  a  HALT  instruction  in  the  error  return
        location.

        If your program is using overlays, the monitor will  not  attempt
        to  return  to your program.  Therefore, you should place the RUN
        monitor call in the low segment of  your  program,  in  case  the
        error is discovered after the high segment has been released.  If
        the call is issued from the low segment and an error occurs,  the
        high   segment   of   the   program   is   cleared  and  must  be
        re-initialized.

        If the call is issued from the high segment and an error  occurs,
        the monitor may halt the job and print the following message:

|            ?Illegal address in UUO at user PC xxxxxx

        For this reason, the RUN  call  should  be  given  from  the  low
        segment.

        See Section 11.14 for a list of error codes.


   Related Calls

        GETSEG, MERGE.



                                   22-339
   RUNTIM [CALLI 27]


                             RUNTIM [CALLI 27]                             RUNTIM [CALLI 27]



   Function

        Returns  the  cumulative  runtime   (in   milliseconds   or   ten
        microsecond units) for a specified job.

   Calling Sequence

                MOVEI    ac,jobno
                   HRLI  ac,(RN.PCN)        ;optional for high precision
                RUNTIM   ac,
                return

                jobno        where:  jobno is the number of a logged-in job (use  0  for  your
                own  job).   You  may  optionally  set  the  sign bit 1B0
                (RN.PCN), to return the runtime for the specified job  in
                ten microsecond units (high-precision runtime).

   Return

            ac        The ac contains the cumulative runtime (in milliseconds) for  the
                                                   ac        specified job.  If no such job exists, the ac contains 0.

   Examples

                MOVEI   T1,0
                RUNTIM  T1,

        This code returns the cumulative runtime for the current  job  in
        T1.

































                                   22-340
                                                        SAVE. [CALLI 210]


                             SAVE. [CALLI 210]                             SAVE. [CALLI 210]

   Function

        Saves the program in memory as an executable (.EXE) file on disk.
        This call is similar to the SAVE monitor command.

   Calling Sequence

                MOVE    ac,[flag,,addr]
                SAVE.   ac,
                  error return
                normal return
                . . .
        addr:   SIXBIT/device/
                SIXBIT/filename/
                SIXBIT/extension/     ;or zero
                EXP     0
|               XWD     proj,prog
|               XWD     0,addr1
|               XWD     0,0       \   ;core argument
|                       -n,,addr1 |
|               XWD     0,core    /

                    flag                 ac        where:  the flag is bit 0 of the ac.  When set, this bit (SS%SSH)
                indicates  that  the  program  should  be  saved  with  a
                sharable high segment (similar to SSAVE monitor command).

                addr1|               addr1 is the address of  the  argument  block,  which  is
                formatted  like  the  argument  blocks  of GETSEG and RUN
                        device                calls.  device is the disk name or logical  name  of  the
                                                                 filename                disk  device  where the file should be written.  filename
                    extension                and extension contain the file name and file extension of
                                              extension                the  new  file.   Note  that  extension  is  optional and
                defaults to .EXE.  The extension is optional because  the
                RUN monitor command will not accept file extensions other
                than .EXE.

                PPN                PPN is the UFD of the directory where the file should  be
                stored.   If  you  put 0 in this word, the default is the
                PPN of the user running the program.  You can specify the
                address of a PATH.  block instead of the PPN.

|               addr2 is the address of a block of n words that  describe
|               the  pages  to be SAVEd from core into the file.  Each of
|               the n words is in the form begin page,,end page.

   Normal Return

        The program in memory is written to disk  in  executable  format.
        The contents of all accumulators may be changed; the new contents
        are not reliable and are  subject  to  change  from  one  monitor
        release  to  the  next.   The  SAVE.   call  releases  channel  0
        implicitly.

   Error Return

        If an error occurs in the process of executing the  SAVE.   call,
        the non-skip return is taken and an error code is returned in the
        ac        ac.  Refer to Section 11.14 for the list of error codes.






                                   22-341
   SCHED. [CALLI 150]


                             SCHED. [CALLI 150]                             SCHED. [CALLI 150]



   Function

        Reads or sets  system  scheduling  parameters.   JACCT  or  [1,2]
        privileges   are  required  to  issue  the  SCHED. monitor  call.
|       However, the read functions may  be  used  by  a  user  with  SPY
|       privileges,  and  the write functions are available to users with
|       POKE privileges.

   Calling Sequence

                MOVE    ac,[XWD len,addr]
                SCHED.  ac,
                  error return
                normal return
                . . .
        addr:   XWD     fcncode,fcnarg
                . . .
                XWD     fcncode,fcnarg

                len        where:  len is the length of the argument list.

                addr                addr is the address of the argument list.

                fcncode                fcncode is one of the function codes described below.

                fcnarg                fcnarg is the  address  of  the  argument  list  for  the
                corresponding function code.

        The function codes, their meanings, and their arguments are:

          ____ ______    ________          Code Symbol    Function

             0 .SCRSI    Reads  the  micro  scheduling   interval.    The
                         monitor   returns  the  scheduling  interval  at
                         fcnarg                         fcnarg.

        400000 .SCSSI    Sets the micro scheduling interval.  The word at
                         fcnarg                         fcnarg should contain:

                         ____    ______  ________                         Word    Symbol  Contents

                          0      .SCBSI  Scheduling interval.

             1 .SCRMI    Reads the minimum core usage function evaluation
                         interval.   The  monitor returns the interval at
                         fcnarg                         fcnarg.

        400001 .SCSMI    Sets the minimum core usage evaluation interval.
                                     fcnarg                         The word at fcnarg should contain:

                         ____    ______  ________                         Word    Symbol  Contents

                          0      .SCBMI  Minimum core usage interval.









                                   22-342
                                                       SCHED. [CALLI 150]


          ____ ______    ________          Code Symbol    Function


             2 .SCRCQ    Reads  class  quotas  and  flags.   The  monitor
                                                               fcnarg                         returns  the  quotas  and  flags  at  fcnarg and
                         following in the form:

                         ____   ______    ________                         Word   Symbol    Contents

                            0   .SCBCT    Count of following words.
                            1   .SCBCQ    Class and quota:

                                          ____   ______    _______                                          Bits   Symbol    Meaning

                                             0   SC.FCQ    Set  if  quota
                                                           is fixed.
                                          1-17   SC.CLN    Class number.
                                          18-35  SC.CLQ    Class quota.

                         There is one word of the form of .SCBCQ for each
                         word specified by the word count.

                                                                   fcnarg        400002 .SCSCQ    Sets class quotas and flags.  The data at fcnarg
                         is  the  same  as  that  returned  by the .SCRCQ
                         function.

             3 .SCRTS    Reads the base  quantum  runtime.   The  monitor
                                                    fcnarg                         returns the time slices at fcnarg in the form:

                         ____   ______    ________                         Word   Symbol    Contents

                            0   .SCBCT    Count of following words.
                            1   .SCBP1    Base quantum runtime for PQ1.
                            2   .SCBP2    Base quantum runtime for PQ2.

        400003 .SCSTS    Sets the base quantum runtime for  one  or  both
                                               fcnarg                         queues.   The data at fcnarg is the same as that
                         returned by the .SCRTS function.

             4 .SCRUF    Reads the desired channel  use  fraction.   This
                         fraction  is  the  swapping  channel utilization
                         percentage.  The monitor returns the channel use
                                      fcnarg                         fractions at fcnarg in the form:

                         ____   ______    ________                         Word   Symbol    Contents

                            0   .SCBCT    Count of following words.
                            1   .SCBUF    Channel number  in  left  half;
                                          use fraction in right half.

                         There is one word of the form of .SCBUF for each
                         word specified by the word count.

        400004 .SCSUF    Sets the desired channel use fraction.  The data
                             fcnarg                         at  fcnarg  is  the same as that returned by the
                         .SCRUF function.

             5 .SCRJC    Reads  the  scheduler  class  for  a  job.   The
                                      fcnarg                         arguments at fcnarg are of the form:

                         ____   ______    ________                         Word   Symbol    Contents

                            0   .SCBCT    Count of following words.
                            1   .SCBJC    Job number in  the  left  half;
                                          class in the right half.

                                   22-343
   SCHED. [CALLI 150]


          ____ ______    ________          Code Symbol    Function

                         There is one word of the form of .SCBJC for each
                         word  specified  by the word count.  The monitor
                         returns the class for each given job.

        400005 .SCSJC    Sets  the  scheduler  class  for  a  job.    The
                                        fcnarg                         arguments  at  fcnarg  are the same as those for
                         the .SCRJC function.

             6 .SCRMC    Reads the  minimum  core  usage  per  job.   The
                                                                   fcnarg                         monitor returns the minimum core usage at fcnarg
                         (.SCBMC).

        400006 .SCSMC    Sets  the  minimum  core  usage  per  job.   The
                                                                   fcnarg                         monitor   reads   the  core  usage  from  fcnarg
                         (.SCBMC).

             7 .SCRCU    Reads  the  class  usage  since  startup.    The
                                                                fcnarg                         monitor  returns the class runtimes at fcnarg in
                         the form:

                         ____    ______  ________                         Word    Symbol  Contents

                           0     .SCBCT  Count of following words.
                           1     .SCBCU  Runtime for class 0.

                         There is one word of the form of .SCBCU for each
                         word specified by the word count.

            10 .SCREF    Obsolete.  The  offset  symbol  .SCBEF  is  also
                         obsolete.

        400010 .SCSEF    Obsolete.

            11 .SCRMM    Reads the minimum core  usage  multiplier.   The
                                                                   fcnarg                         monitor   returns   the   multiplier  at  fcnarg
                         (.SCBMM).

        400011 .SCSMM    Sets the minimum  core  usage  multiplier.   The
                                                                   fcnarg                         monitor   reads   the   multiplier  from  fcnarg
                         (.SCBMM).

            12 .SCRDC    Reads the  default  class  for  new  jobs.   The
                                                                   fcnarg                         monitor  returns  the  default  class  at fcnarg
                         (.SCBDC).

        400012 .SCSDC    Sets  the  default  class  for  new  jobs.   The
                                                                   fcnarg                         monitor  reads  the  default  class  from fcnarg
                         (.SCBDC).

            13 .SCRRC    Reads the minimum core usage  requeue  constant.
                                                                   fcnarg                         The  monitor  returns  the  constant  at  fcnarg
                         (.SCBRC).

        400013 .SCSRC    Sets the minimum core  usage  requeue  constant.
                                                                   fcnarg                         The  monitor  reads  the  constant  from  fcnarg
                         (.SCBRC).

            14 .SCRPM    Reads  the  minimum  core  usage  maximum.   The
                         monitor returns the maximum (in microseconds) at
                         fcnarg                         fcnarg (.SCBPM).




                                   22-344
                                                       SCHED. [CALLI 150]


          ____ ______    ________          Code Symbol    Function

        400014 .SCSPM    Sets  the  minimum  core  usage  maximum.    The
                         monitor reads the maximum (in microseconds) from
                         fcnarg                         fcnarg (.SCBPM).

            15 .SCRML    Reads quantum  multipliers  for  PQ1,  PQ2,  and
                         scale factor.  The monitor returns the values at
                         fcnarg                         fcnarg in the format:

                         ____   ______    ________                         Word   Symbol    Contents

                            0   .SCBCT    Count of the following words.
                            1   .SCBMP    Queue  number  in  left   half,
                                          quantum   multiplier  in  right
                                          half.
                            2   .SCBMQ    Queue  number  in  left   half,
                                          quantum   multiplier  in  right
                                          half.
                            3   .SCBMR    3 in left half, scale factor in
                                          right half (SC.BMR==3,,0).

        400015 .SCSML    Sets quantum multipliers for PQ1, PQ2, and scale
                                              fcnarg                         factor.  The data at fcnarg must the the same as
                         that returned by the .SCRML function.

            16 .SCRMX    Reads the maximum quantum  run  for  PQ1  and/or
                         PQ2.   The  monitor  returns the maximum quantum
                                fcnarg                         run at fcnarg in the format:

                         ____   ______    ________                         Word   Symbol    Contents

                            0   .SCBCT    Count of the following words.
                            1   .SCBMX    Queue  number  in  left   half,
                                          maximum    time    slice    (in
                                          milliseconds)  in  right  half.
                                          The returned block contains one
                                          word of the form of .SCBMX  for
                                          each word specified in the word
                                          count.

        400016 .SCSMX    Sets the maximum quantum run for PQ1 and/or PQ2.
                                     fcnarg                         The data at fcnarg must be in the same format as
                         that returned by the .SCRMX function.

            17 .SCRSQ    Reads  secondary  class  quotas.   The   monitor
                                               fcnarg                         returns the quotas at fcnarg in the format:

                         ____   ______    ________                         Word   Symbol    Contents

                            0   .SCBCT    Count of following words.
                            1   .SCBSQ    Class in left  half,  quota  in
                                          right half.

                                     fcnarg                         The data at fcnarg contains one word of the form
                         of  .SCBSQ  for  each word indicated by the word
                         count.

                                                                   fcnarg        400017 .SCSSQ    Sets secondary class quotas.  The data at fcnarg
                         must be in the same form as that returned by the
                         .SCRSQ function.





                                   22-345
   SCHED. [CALLI 150]


          ____ ______    ________          Code Symbol    Function

            20 .SCRIQ    Reads the time percentage  to  scan  queue  just
                         swapped   in   before  subqueues.   The  monitor
                                                        fcnarg                         returns the time percentage at fcnarg (.SCBIQ).

        400020 .SCSIQ    Sets the time  percentage  to  scan  queue  just
                         swapped  in before subqueues.  The monitor reads
                                                  fcnarg                         the time percentage from fcnarg (.SCBIQ).

            21 .SCRSS    Reads swap scan time.  The monitor  returns  the
                                           fcnarg                         swap scan time at fcnarg (.SCBSS).

        400021 .SCSSS    Sets swap scan time.  The monitor reads the swap
                                        fcnarg                         scan time from fcnarg (.SCBSS).

            22 .SCRBB    Reads number for background batch subqueue.  The
                                                       fcnarg                         monitor returns the number at fcnarg (.SCBBB).

        400022 .SCSBB    Sets number for background batch subqueue.   The
                                                       fcnarg                         monitor reads the number from fcnarg (.SCBBB).

            23 .SCRBS    Reads background batch swap time interval.   The
                                                         fcnarg                         monitor returns the interval at fcnarg (.SCBBS).

        400023 .SCSBS    Sets background batch swap time  interval.   The
                                                         fcnarg                         monitor reads the interval from fcnarg (.SCBBS).

            24 .SCRSF    Reads scheduler fairness  factor.   The  monitor
                                                        fcnarg                         returns the fairness factor at fcnarg (.SCBSF).

        400024 .SCSSF    Sets scheduler  fairness  factor.   The  monitor
                                                        fcnarg                         reads the fairness factor from fcnarg (.SCBSF).

            25 .SCRSW    Reads  swapper  fairness  factor.   The  monitor
                                                        fcnarg                         returns the fairness factor at fcnarg (.SCBSW).

        400025 .SCSSW    Sets swapper fairness factor.  The monitor reads
                                                  fcnarg                         the fairness factor from fcnarg (.SCBSW).

            26 .SCRIO    Reads in-core fairness.  The monitor returns the
                                     fcnarg                         fairness at fcnarg (.SCBIO).

        400026 .SCSIO    Sets in-core fairness.  The  monitor  reads  the
                                       fcnarg                         fairness from fcnarg (.SCBIO).

            27 .SCRSC    Reads SCDCOR.  The monitor returns the value  of
                                   fcnarg                         SCDCOR at fcnarg (.SCBSC).

        400027 .SCSSC    Sets SCDCOR.  The monitor reads  the  value  for
                                     fcnarg                         SCDCOR from fcnarg (.SCBSC).

            30 .SCRSO    Reads the CPU scan order.  The  monitor  returns
                                                           fcnarg                         the  scan  order  for each CPU at fcnarg+1.  The
                                           fcnarg                         argument block at fcnarg  is  the  same  as  the
                         information  you  give  to set the scan order in
                         function 400030 (.SCSSO).









                                   22-346
                                                       SCHED. [CALLI 150]


          ____ ______    ________          Code Symbol    Function

        400030 .SCSSO    Sets the CPU scan order.  The argument  list  at
                         fcnarg                         fcnarg should appear as:

                         ____   ______    ________                         Word   Symbol    Contents

                           0    .SCBCT    Word count.
                           1    .SCBSO    Scan order for CPU0.
                           2    .SCBSO    Scan order for CPU1.
                           . . .

                         Where  .SCBSO  is  0  if  the  scan   order   is
                         [HPQ,PQ1,PQ2]    or    1   if   the   order   is
                         [HPQ,PQ2,PQ1].

|  
|           31 .SCRRT    Reads  dormant  segment   retention   time   (in
|                        jiffies).  The monitor returns retention time at
|                        fcnarg (.SCBRT).
|  
|       400031 .SCSST    Sets  dormant  segment  retention   time.    The
|                        monitor   reads   retention   time  from  fcnarg
|                        (.SCBRT).
|  
|           32 .SCRFG    Reads the free core goal.  The  monitor  returns
|                        the  free  core  goal at fcnarg in the following
|                        format:
|  
                         ____   ______    _______|                        Word   Symbol    Meaning
|  
|                          0    .SCBFG    Minimum free core size (goal).
|  
|                          1    .SCBFL    Maximum free core size.
|  
|                        Both, .SCBFG and .SCBFL are percentages of  user
|                        core as determined when the system was booted.
|  
|       400032 .SCSFG    Sets the free core goal.  The monitor reads  the
|                        goal from fcnarg in the format given in function
|                        .SCRFG.

   Normal Return

        The function has been performed.





















                                   22-347
   SCHED. [CALLI 150]


   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          1    SCHAC%    Address check.
          2    SCHUF%    Unknown function code.
          3    SCHUJ%    Unknown job.
          4    SCHNP%    Not enough privileges.
          5    SCHUC%    Unknown class.
          6    SCHUQ%    Unknown queue.
          7    SCHNC%    Nonexistent channel.
         10    SCHEB%    Bad exponential factor.
         11    SCHMI%    Cannot set protection if MCUINT is nonzero.
         12              Reserved for use by DIGITAL.
         13    SCHNH%    Not 100%.
         14    SCHFN%    Fairness not positive.
|        15    SCHIC%    Illegal CPU number specified in function .SCSSO.
|        16    SCHUO%    Unknown scan order specified in function .SCSSO.














































                                   22-348
|                                                        SCS. [CALLI 213]


                              SCS. [CALLI 213]|                             SCS. [CALLI 213]
|  
|  
|  
|  Function
|  
|       Provides the diagnostic interface to the  Systems  Communications
|       Service layer of the System Communications Architecture, allowing
|       information to be exchanged between  jobs  on  different  systems
|       connected over a CI.
|  
|       This monitor call is used in DIGITAL-supplied hardware diagnostic
|       programs  and  is  not  intended to be used in customer programs.
|       The program must be run under [1,2] or have JACCT  privileges  to
|       use the SCS. UUO.
|  
|  Calling Sequence
|  
|               MOVEI   ac,addr
|               SCS.    ac,
|                 error return
|               normal return
|  
|       addr:   len,,function
|  
|       where:  addr is the starting address of the argument  block,  len
|               specifies  the  total  length  of the argument block, and
|               function is one of the function  codes  described  below.
|               The function word is formatted as follows:
|  
|               Word          Field
                ______  ____  ______  ________|               Symbol  Bits  Symbol  Contents
|  
|               .SSFNC  1-17  SS.LEN  Length of argument block, including
|                                     this word.
|                       18-35 SS.FNC  One of the  function  codes  listed
|                                     below.
|  
|               Function codes are:
|  
                ____   ______   _______|               Code   Symbol   Meaning
|  
|                 0    .SSCON   Requests a connection.
|                 1    .SSLIS   Listens for a connection.
|                 2    .SSREJ   Rejects a connection request.
|                 3    .SSDIS   Disconnects and closes a connection.
|                 4    .SSSDG   Sends a datagram.
|                 5    .SSQRD   Queues a buffer(s) to receive datagram.
|                 6    .SSSMG   Sends a message.
|                 7    .SSQRM   Queues buffer(s) to receive message.
|                10    .SSCSP   Returns information about a status  of  a
|                               connection.
|                11    .SSRCD   Returns configuration data for  a  remote
|                               system.
|                12    .SSSTS   Returns information  about  status  of  a
|                               connection.
|                13    .SSRMG   Receives a message.
|                14    .SSMAP   Maps a buffer for DMA transfer.
|                15    .SSUMP   Unmaps a buffer for DMA transfer.
|                16    .SSSND   Sends data to remove host.
|                17    .SSREQ   Requests delivery of data.
|               20-21           Reserved.
|                22    .SSRDG   Receives a datagram.
|                23    .SSACC   Accepts a connection request.


                                   22-349
|  SCS. [CALLI 213]


|                24    .SSGDE   Returns entry from data request  complete
|                               queue.
|                25    .SSEVT   Returns entry from event queue.
|                26    .SSCRD   Cancels datagram receive.
|                27    .SSCRM   Cancels message receive.
|                30    .SSGLN   Gets local node number.
|               31-34           Reserved.
|                35    .SSRBS   Returns minimum buffer sizes.
|                36    .SSRPS   Returns path status.
|  
|  Normal Return
|  
|       The function is performed successfully and the program  continues
|       at the skip return.
|  
|  Error Return
|  
|       The function is not performed, and the error code is returned  in
|       the ac.  The error codes and their meanings are:
|  
        ____   ______    _____|       Code   Symbol    Error
|  
|        0     SSNPV%    Insufficient privileges.
|        1     SSIFC%    Illegal function code.
|        3     SSACR%    Address check reading argument block.









































                                   22-350
|                                                      SEBLK. [CALLI 214]


                             SEBLK. [CALLI 214]|                            SEBLK. [CALLI 214]
|  
|  
|  
|  Function
|  
|       SEBLK.  is a privileged monitor call used  only  by  DAEMON.   It
|       returns system error block data.
|  
|  Calling Sequence
|  
|               MOVE    ac,[arglen,,arglst]
|               SEBLK.  ac
|                 error return
|               normal return
|  
|       where:  arglen is length of the argument list stored at arglst.
|  
|  Normal Return
|  
|       The monitor returns information about system errors in the  block
|       starting  at arglst.  The number of words stored in the monitor's
|       error block is returned in the ac.  This tells you  whether  your
|       block  was  long enough to hold the information; if the block was
|       not long enough, the monitor truncated the information.
|  
|  Error Return
|  
|       One of the following codes is returned in the ac:
|  
        ____   ______    _____|       Code   Symbol    Error
|  
|         0    SBNPV%    Job not privileged.
|         1    SBNEQ%    No error blocks on queue.
































                                   22-351
   SENSE. [CALLI 133]


                             SENSE. [CALLI 133]                             SENSE. [CALLI 133]



   Function

        Returns the I/O status bits for a device.  I/O status bits can be
        cleared individually using the CLRST.  monitor call.

   Calling Sequence

               MOVE        ac,[XWD len,addr]
               SENSE.    ac,
                 error return
               normal return
               . . .
        addr:  SIXBIT/device/       \
               EXP       channo     |
               EXP       udx        /
               XWD       length,status
               . . .
        status:      SIXBIT/name/
        status+1:    XWD 0,GETSTS-bits
        status+2:    DEVSTS-word

                len        where:  len is the length of the argument list, which must be 2.

                addr                addr is the address of the argument list.

                device                device is the SIXBIT  physical  or  logical  name  of  an
                initialized device.

                channo                channo is the number of an initialized channel.

                udx                udx is the Universal Device Index for a device.

                Device, channo, and UDX are alternate ways of  specifying
                the device for which you desire the status bits.

                length                length specifies the number of words in the status block.
                This  value should equal the number of devices multiplied
                by 3.

                status                status is the address of the status block.

        The status block is returned in the form:

        ______ ______    ________        Offset Symbol    Contents

           0   .SNSDV    The SIXBIT name of the device.

           1   .SNSST    The status bits for the device (GETSTS).

           2   .SNSDS    The device status (DEVSTS) bits for the  device.
                         DEVSTS  bits  are  from  the device DDB, and are
                         different for each device.

   Normal Return

                                                                status        The name and status bits for the device are returned at status.






                                   22-352
                                                       SENSE. [CALLI 133]


   Error Return

        If the SENSE. monitor call is not implemented on your system, the
        ac        ac  is unchanged; otherwise, the following error code is returned
               ac        in the ac:

        ____   ______    _____        Code   Symbol    Error

          1    SNSBD%    Illegal device specified.

   Related Calls

        CLRST.





















































                                   22-353
   SETDDT [CALLI 2]


                              SETDDT [CALLI 2]                              SETDDT [CALLI 2]



   Function

        Sets the value of .JBDDT in the Job Data Area.  Note that  .JBDDT
        is  protected from a direct MOVEM because the monitor has its own
        copy of .JBDDT and restores its value at every context switch.

   Calling Sequence

                MOVE    ac,[last-addr,,start-addr]
                SETDDT  ac,
                return

                last-addr                                  start-addr        where:  last-addr is the last address for DDT and  start-addr  is
                the new start address.

   Return

        The start address and last address for DDT are set.












































                                   22-354
                                                       SETLCH [TTCALL 7,]


                             SETLCH [TTCALL 7,]                             SETLCH [TTCALL 7,]



   Function

        Sets  the  line  characteristics  for  your   job's   controlling
        terminal.   The line characteristics can be read using the GETLCH
        call.

   Calling Sequence

                SETLCH  [XWD flags,lineno]
                return

                flags        where:  flags are described below.

                lineno                lineno is the line number for a terminal that  can  be  a
                terminal  line  number  (such  as  37 for TTY37) or a UDX
|               (such as UXTRM+37 for TTY37).

                                              lineno        If you give a  negative  number  for  lineno,  the  current  user
        terminal  is  assumed.   Flags  can be changed only for the job's
        controlling terminal.

            flags        The flags are:

        ____   ______    ______________        Flag   Symbol    Characteristic

          0    GL.ITY    Pseudo-terminal (PTY).
          1    GL.CTY    Operator's terminal (CTY).
          2    GL.DSP    Display console (DIS).
          3    GL.DSL    Dataset data line.
          4              Reserved.
          5    GL.HDP    Half-duplex line.
          6    GL.REM    Remote terminal.
          7    GL.RBS    Remote batch terminal.
         10              Reserved.
         11    GL.LIN    User has typed some input.
         12              Reserved.
         13    GL.LCM    Terminal in lowercase mode.
         14    GL.TAB    Terminal has tab capability.
         15    GL.LCP    Local copy only (no echo).
         16    GL.PTM    The CTRL/Q papertape switch is on.
         17    GL.NEC    No echo from program.

   Return

        The line characteristics are  set  as  requested.   The  argument
        block is not changed.

   Related Calls

        GETLCH, TRMOP.

   Common Errors

        Using an ac in the calling sequence.








                                   22-355
   SETNAM [CALLI 43]


                             SETNAM [CALLI 43]                             SETNAM [CALLI 43]



   Function

        Changes the name of the current  program  in  the  monitor's  job
        table.   This  name  is  used  by  some monitor commands, such as
|       USESTAT (CTRL/T) and SYSTAT.

        The SETNAM monitor call also clears the SYS program bit (which is
        used  by  GALAXY),  clears  the  execute-only and JACCT bits, and
        causes a version typeout if a version watch has been set with the
        SET  WATCH  VERSION  monitor  command  or with the .STWTC, ST.WVR
        function of SETUUO.

   Calling Sequence

                MOVE    ac,[SIXBIT/name/]
                SETNAM  ac,
                return

                name        where:  name is the new program name for the job.

   Return

        The new program name is entered in the monitor's job table.

   Examples

                MOVE    T1,[SIXBIT/NEWNAM/]
                SETNAM  T1,

        This code changes the program name for the job to NEWNAM.
































                                   22-356
                                                      SETSTS [OPCODE 060]


                            SETSTS [OPCODE 060]                            SETSTS [OPCODE 060]



   Function

|       Sets bits in the file status word for a  device.   Use  FILOP. to
|       perform a SETSTS for an extended I/O channel.

   Calling Sequence

                SETSTS channo,bits
                return

                channo        where:  channo is the number of an initialized channel.

                bits                bits are I/O status bits.  For a  complete  list  of  I/O
                status bits, see the appropriate device chapter in Volume
                1.

   Return

        The I/O status bits are set.

   Examples

                GETSTS     CHN,T1        ;get status in T1
                TRZ        T1,IO.ERR     ;keep mode and device-
                                         ; dependant bits
                SETSTS     CHN,(T1)      ;clear errors

   Related Calls

        CLRST., GETSTS

   Common Errors

        1.  If the SETSTS monitor call is done for a channel that has not
            been initialized, the monitor stops the job and prints:

                 ?IO to unassigned channel at user PC nnnnnn

        2.  If the data mode is  illegal  for  the  device,  the  monitor
            prints:

                 ?Illegal data mode for device xxxnnn;  UUO  at  user  PC
                 nnnnnn



















                                   22-357
   SETUUO [CALLI 75]


                             SETUUO [CALLI 75]                             SETUUO [CALLI 75]



   Function

        Sets system or job parameters.  To set  system  parameters,  your
        job  must  have  the  JACCT  bit  set, or must be logged in under
        [1,2], and may not be a batch job.

   Calling Sequence

                MOVE    ac,[XWD fcncode,argument]
                SETUUO  ac,
                  error return
                normal return

                fcncode        where:  fcncode is one of the function codes described below.

                argument                argument is an argument for the given function code.

        The function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

          0    .STCMX    Sets the maximum core size that a user  job  may
                         use  (the  sum  of  the  high  and low segments,
|                        CORMAX).  The minimum value is  set  by  MONGEN.
                         The  maximum  value  is the size of user core in
                         words.

          1    .STCMN    Sets the guaranteed amount  of  contiguous  core
                         that  a  single  unlocked  job can use (CORMIN).
                         The valid values are in the range 0  to  CORMAX.
                         This argument is referred to as CORMIN.

|         2    .STDAY    Obsolete.

          3    .STSCH    Sets parameters in the  %CNSTS  word  in  GETTAB
                         table  11.   The  argument gives the flags.  The
                         flags and their meanings are:

                         ___    ______    _______                         Bit    Symbol    Meaning

                          26    ST%NDL    No automatic down-line load  of
                                          DC72,   DC71,  or  DAS80-series
                                          remote station.
                          27    ST%NOP    No operator coverage.
                          28    ST%NSP    Allow device unspooling.
                          29    ST%ASS    Allow  device  assignment   and
                                          initialization.
                          32    ST%NRT    No remote TTYs.
                          33    ST%BON    LOGINs for batch jobs only.
                          34    ST%NRL    No remote LOGINs.
                          35    ST%NLG    No LOGINs except CTY.











                                   22-358
                                                        SETUUO [CALLI 75]


        ____   ______    ________        Code   Symbol    Function

          4    .STCDR    Specifies the input name  for  the  card  reader
                         job,  which  is  stored  in  the  left  half  of
|                        location  .GTSPL.   The  argument  is  given  in
                         single   quotes   that   contain   three  SIXBIT
                         characters forming the job name.   For  example,
                         the MOVE statement in the calling sequence might
                         be:

                              MOVE AC1,[XWD .STCDR,'XYZ']

                         to specify the input name XYZ.

          5    .STSPL    Sets or clears the spooling state for the  job's
                                                                       ac                         devices.   You  specify  the flag bits in the ac
|                        and they are set in bits 31  to  35  of  .GTSPL.
                         The flags and their meanings are:

                         ___    ______    _______                         Bit    Symbol    Meaning

                          31    JS.PCR    Spool card reader.
                          32    JS.PCP    Spool card punch.
                          33    JS.PPT    Spool paper tape punch.
                          34    JS.PPL    Spool plotter.
                          35    JS.PLP    Spool line printer.

          6    .STWTC    Sets flags  for  SET  WATCH  routine  (refer  to
                         monitor  command SET WATCH).  The argument gives
                         one or more of the flags, which are:

                         ___    ______    _______                         Bit    Symbol    Meaning

                           9    ST.WCN    /MESSAGE:CONTINUATION.
                          10    ST.WFL    /MESSAGE:FIRST.
                          11    ST.WPR    /MESSAGE:PREFIX.
                          11    ST.WMS    /MESSAGE:ALL.
|                         19    ST.WCX    Watch contexts.
                          19    ST.WDY    Watch daytime at start.
                          20    ST.WRN    Watch runtime.
                          21    ST.WWT    Watch wait time.
                          22    ST.WDR    Watch disk reads.
                          23    ST.WDW    Watch disk writes.
                          24    ST.WVR    Watch versions.
                          25    ST.WMT    Watch statistics for magtapes.
                          26    ST.WFI    Watch file accessed.
                       19-26    ST.WAL    Watch all.

          7    .STDAT    Sets the system date as the number of days since
                         January  1,  1964, in 15-bit form.  The argument
                         gives the number of days as:

                                     1            3                         ((year-1964)12+(month-1))31+(day-1)

         10    .STOPR    Sets the SIXBIT name of the terminal to be  used
                         as  the  operator  terminal.  The argument gives
                         the address of the word containing the name.

         11    .STKSY    Sets  the  decimal  number  of   minutes   until
                         timesharing   ends;  this  value  is  stored  in
                         SYSKTM.   If  SYSKTM  is   0,   timesharing   is
                         continued indefinitely.




                                   22-359
   SETUUO [CALLI 75]


        ____   ______    ________        Code   Symbol    Function

         12    .STCLM    Sets the maximum number of words of memory  that
                         the  job  can use.  This value is converted from
                         words to pages (at 512 words/page) and stored in
                         location JB.CLR in table .GTLIM.  This value may
                         be set to zero,  indicating  that  there  is  no
                         maximum limit.

         13    .STTLM    Sets the maximum number of seconds the  job  can
                         run.   The  argument  is  the  number of seconds
                         permitted.  This  function  cannot  be  used  by
                         batch  jobs  that  already  have  a  time limit.
                         However, this function is allowed for  non-batch
                         jobs,   batch  jobs  with  no  time  limit,  and
                         privileged batch jobs with  or  without  a  time
                         limit.

         14    .STCPU    Specifies the CPU on which the job  is  to  run.
                         The argument gives one of the following flags:

                         ___    ______    _______                         Bit    Symbol    Meaning

                          30    SP.CR5    Run on CPU5.
                          31    SP.CR4    Run on CPU4.
                          32    SP.CR3    Run on CPU3.
                          33    SP.CR2    Run on CPU2.
                          34    SP.CR1    Run on CPU1.
                          35    SP.CR0    Run on CPU0.

                         .STCPU  is  a  privileged  function,   requiring
                         JP.CCC privileges.  The error return is taken if
                         you attempt to change the CPU specification on a
                         single-CPU system.

         15    .STCRN    Sets runnability for CPUs.  The  argument  gives
                         one or more of the following flags:

                         ___    ______    _______                         Bit    Symbol    Meaning

                          30    SP.CR5    CPU5 is runnable.
                          31    SP.CR4    CPU4 is runnable.
                          32    SP.CR3    CPU3 is runnable.
                          33    SP.CR2    CPU2 is runnable.
                          34    SP.CR1    CPU1 is runnable.
                          35    SP.CR0    CPU0 is runnable.

                         The error return is  taken  if  you  attempt  to
                         issue this function on a single-CPU system.

         16    .STLMX    Sets the maximum number  of  jobs  that  can  be
                         logged  in at any one time; this value is stored
                         in location  LOGMAX.   The  argument  gives  the
                         maximum  number  of jobs; this number must be at
                         least 1, but no more than  the  system  maximum,
                         which  is  defined  by the symbol JOBN.  JOBN is
                         the system limit defined  when  the  monitor  is
                         generated by MONGEN.

                         If you give a number smaller than the number  of
                         jobs currently logged in, no new jobs can log in
                         until the number of jobs falls below LOGMAX.




                                   22-360
                                                        SETUUO [CALLI 75]


        ____   ______    ________        Code   Symbol    Function

                         You can obtain  the  number  of  jobs  currently
                         logged  in  from  the  location %CNLNM in GETTAB
                         table .GTCNF.

         17    .STBMX    Sets the maximum number of batch jobs  that  can
                         be  logged  in  at  any  one time; this value is
                         stored in location BATMAX.  The  argument  gives
                         the  maximum  number  of batch jobs; this number
                         must be less than the system maximum,  which  is
                         defined by the symbol JOBN.

                         You  can  obtain  the  number  of   batch   jobs
                         currently  logged in from the location %CNBNM in
                         GETTAB table .GTCNF.

         20    .STBMN    Sets the  number  of  jobs  reserved  for  batch
                         processing  (BATMIN).   The  argument  gives the
                         minimum number of jobs reserved.  The value must
|                        be in the range 1 to the value of BATMAX-1.

         21    .STDFL    Sets the action to occur if the user disk  space
                         is  filled  for the job.  The argument is one of
                         the following codes:

                         ____   ______    _______                         Code   Symbol    Meaning

                           0    .DFPSE    Pause when disk filled for job.
                           1    .DFERR    Error when disk filled for  job
                                          or  the  user's  quota has been
                                          exceeded.

                         Any other value for argument returns the current
                                                        ac                         setting  for  .STDFL  in  the  ac;  the  initial
                         default setting is .DFERR.

         22    .STMVM    Sets  the  system-wide  virtual   memory   limit
                                                        ac                         (GVPL).  The value returned in ac depends on the
                         given argument:

                          o  If the  given  argument  is  less  than  the
                             current virtual memory page count, the value
                             returned is  the  total  amount  of  virtual
                             memory in use by all virtual memory users.

                          o  If the given argument is  greater  than  the
                             current  available swapping space, the value
                             returned is the total  amount  of  available
                             swapping space.

                          o  If the given argument is  greater  than  the
                             total  amount of virtual memory currently in
                             use,  the  value  returned  is   the   given
                             argument.

         23    .STMVR    Obsolete.   This  historical   SETUUO   function
                                                                      ac                         always takes the error return and clears the ac.








                                   22-361
   SETUUO [CALLI 75]


        ____   ______    ________        Code   Symbol    Function

         24    .STUVM    Sets the maximum virtual memory page  limit  and
                         the  maximum  physical  memory  page limit.  The
                         argument gives the address  of  the  word  whose
                         format is:

                              LH = maximum virtual page limit (MVPL)
                              RH = maximum physical page limit (MPPL)

                         If the left half of the word (MVPL)  is  0,  the
                         user cannot use the virtual memory option.  When
                         MVPL is set to 0, MPPL should also be set to  0.
                         If  the right half (MPPL) is 0, the user can use
                         all of the system's physical memory.

         25    .STCVM    Sets the current memory maximum.   The  argument
                         is the address of a word whose format is:

                              LH = current virtual page limit (CVPL)
                              RH = current physical guideline or limit
                                   (CPPL)

                         The  left  half  (CVPL)  of  the  word  at   the
                         indicated  address  contains the current virtual
                         page limit.

                         If bit 18 (ST.VSG) is 0, the right  half  (CPPL)
                         contains the current physical page guideline; if
                         bit 18 is 1, bits 19 to 35 contain  the  current
                         physical   page   limit.    A  guideline  is  an
                         approximate physical page limit.

                         The guideline algorithm  allows  you  to  set  a
                         memory limit that will not be strictly enforced.
                         The page fault handler will attempt to meet  the
                         page  limit  within  a  window of approximation,
                         allowing slight over-allocation  to  accommodate
                         the  program.   If  you  set the ST.VSG bit, the
                         allocation is taken as a limit, and  that  limit
|                        is strictly enforced.

         26    .STTVM    Sets the  time  interval  between  virtual  time
                         traps  in  milliseconds.   A  virtual  time trap
                         causes a Code 4 page fault  to  the  page  fault
                         handler each time the time interval has elapsed.
                         The argument gives the  number  of  milliseconds
                         between traps.

         27    .STABK    Sets the address break condition.  On  a  normal
                         return,  the new address break condition and the
                         break  address  have  been  set.   The   address
                         conditions  are specified in the word pointed to
                         by the argument.  These conditions are:

                         ____   ______    ________                         Bits   Symbol    Contents

                            0   ST.AEX    Set to break on EXECUTE.
                            1   ST.ARD    Set to break on READ.
                            2   ST.AWR    Set to break on WRITE.






                                   22-362
                                                        SETUUO [CALLI 75]


        ____   ______    ________        Code   Symbol    Function

                         ____   ______    ________                         Bits   Symbol    Contents

                            3   ST.AUU    Set   to   break   on   monitor
                                          reference.

|                         4-8             Specify the section number  for
|                                         the break address.
                         9-17   ST.ACT    The number of times  the  break
                                          address  is  to  be  referenced
                                          before an interrupt occurs.
                         18-35  ST.ADR    Sets the break address.

                         To clear the address break, clear bits 0 through
                         3.

                         If  you   have   enabled   for   address   break
                         interrupts,  the PSI system will interrupt on an
                         address  break.   If  the  PSI  system  is   not
                         enabled,  the  monitor  will  stop  your job and
                         display the following message on your terminal:

                              %Address break at user PC xxxxxx

|        30    .STPGM    Sets the name of a program that  will  run  when
|                        the  current program session finishes executing.
|                        You must run the program executing  this  SETUUO
|                        from  SYS:, under [1,2], or with JACCT privilege
|                        set.  The argument block is:
|  
|                            EXP     flag       ;Bits 2-35 reserved to
|                                                DEC
|                            SIXBIT /progra/    ;progra is program name
|  
|                        The  monitor  does  an  implied   RUN   UUO   on
|                        SYS:progra.EXE  when the current program session
|                        ends.  Program session termination occurs  under
|                        one of the following conditions:
|  
|                         o  When Bit 0 of the flag is set,  the  session
|                            terminates  whenever the job would otherwise
|                            enter monitor mode (for instance, EXIT  UUO,
|                            ^C,  illegal  memory reference, or swap read
|                            error).   If  the  job   becomes   detached,
|                            issuing  the unprivileged ATTACH command (or
|                            the ATTACH UUO) does not attach you  to  the
|                            job  in  monitor  mode.   You will attach in
|                            user mode instead.  The DETACH  function  of
|                            the ATTACH UUO allows you to detach, leaving
|                            your terminal in monitor mode.
|  
|                         o  When Bit 0 of the flag is clear, the session
|                            terminates  whenever  you  execute a command
|                            that destroys the core image.  The  RUN  UUO
                                                      _______|                            executes  SYS:progra.EXE instead of whatever
|                            command you issued.   You  can  still  enter
|                            monitor  mode  when your program terminates,
|                            or when you issue an  ATTACH  command.   You
|                            may  then  execute any command that does not
|                            change the core image, as well as  the  KJOB
|                            command.   Commands  that automatically save
|                            the current context and push to a new one do
|                            not change the core image.


                                   22-363
   SETUUO [CALLI 75]


        ____   ______    ________|       Code   Symbol    Function
|  
|                        The status of .STPGM remains in effect until  it
|                        is  explicitly  cleared by a privileged program,
|                        or the job logs  out.   Whenever  .STPGM  is  in
|                        effect,  the program may execute RUN UUOs on any
|                        file.  Control may even transfer  to  a  program
|                        that is not privileged to execute this SETUUO.
|  
|                        If  .STPGM  specifies  an   inaccessible   file,
|                        SYS:LOGOUT  will be run when the program session
|                        terminates.

         31    .STDFR    Sets  deferred   spooling.    If   argument   is
                         non-zero,  spooled  output  will  not  be queued
                         until the job logs out.  If  argument  is  zero,
                         spooled  output  will  be queued as each file is
                         closed.

         32    .STHST    Sets the host system.  This  function  logically
                         attaches   the   controlling   terminal  to  the
                         specified host system in an ANF-10 network.  The
                         job  on  the  previous  system becomes detached.
                         The calling sequence is:

                                 MOVE    ac,[.STHST,,addr]
                                 SETUUO  ac,
                                   error return
                                 normal return
                                 . . .
                                 addr:   node number or SIXBIT node name

         33    .STDEF    Sets default  values  for  job-wide  parameters.
                         The calling sequence for the .STDEF function is:

                                 MOVE    ac,[XWD .STDEF,addr]
                                 SETUUO  ac,
                                   error return
                                 normal return
                                 . . .
                         addr:   XWD arglen,subfcncode
                                 argument

                                 arglen                         where:  arglen gives the number of arguments  to
                         follow.

                         subfcncode                         subfcncode is one of the  following  subfunction
                         codes:

                         ____   ______    ___________                         Code   Symbol    Subfunction

                           0    .STDPC    Set  default  protection  code.
                                          addr                                          addr+1 contains the new default
                                          protection code.
                           1    .STDNB    Set  default  number  of   disk
                                                     addr                                          buffers.   addr+1  contains the
                                          new  default  number  of   disk
                                          buffers.
|                          2    .STDAD    Controls whether LOGIN will ask
|                                         you about attaching to this job
|                                         should  you   previously   have
|                                         detached  from  it.  JD.DAD  in
|                                         .GTDFL contains  the  value  of
|                                         the flag.


                                   22-364
                                                        SETUUO [CALLI 75]


        ____   ______    ________|       Code   Symbol    Function
|  
                                          ________  ______  ______|                                         Argument  JD.DFL  Action
|  
|                                         zero      clear   LOGIN    will
|                                                           ask     about
|                                                           this job.
|                                         non-zero  set     LOGIN    does
|                                                           not   ask  if
|                                                           you  want  to
|                                                           attach     to
|                                                           this job.

                           3    .STDSB    Sets the default size of a disk
                                          buffer.   Refer  to  SET BIGBUF
                                                                   addr                                          monitor    command.      addr+1
                                          contains  the  new  disk buffer
                                          size (value is number of blocks
                                          per buffer).

         34    .STPRV    Sets the privilege and  capability  words.   The
                         calling sequence for the .STPRV function is:

                                 MOVE    ac,[XWD .STPRV,arglst]
                                 SETUUO  ac,
                                 . . .
                         arglst: XWD     0,subfcncode
                                 argument

                         subfcncode                         subfcncode is one of the  following  subfunction
                         codes:

                         ____   ______    ___________                         Code   Symbol    Subfunction

                           0    .STCPW    Sets entire privilege word.
                           1    .STCPS    Sets    specified    bits    of
                                          privilege word.
                           2    .STCPC    Clears   specified   bits    of
                                          privilege word.
                           3    .STCCW    Sets entire capability word.
                           4    .STCCS    Sets    specified    bits    of
                                          capability word.
                           5    .STCCC    Clears   specified   bits    of
                                          capability word.

                                         NOTE

                 You can always clear bits  in  the  privilege  word.
                 However,   you  can  set  only  those  bits  in  the
                 privilege word that are set in the capability  word,
                 unless you are a privileged job.

         35    .STBSN    Sets batch stream number (settable only once per
                         instance).

         36    .STWTO    Sets write-to-operator values.  Refer to  GETTAB
                         table .GTOBI.









                                   22-365
   SETUUO [CALLI 75]


        ____   ______    ________        Code   Symbol    Function

         37    .STCDN    Sets CPU up/down status.   To  control  the  CPU
                         up/down  status, set the appropriate bits in the
                         argument, from the following list:

                         ___      ________                         Bit      Function

                         18       Remove CPU from system.
                         19       Suspend the CPU.
                         20       Add the CPU to the system.

                         The CPU number must be stored in bits  33-35  of
                         the argument.

         40    .STCSB    Sets or clears cache bits.   The  cache  can  be
                         enabled   or  disabled  for  the  monitor's  low
                         segment by setting the argument to 1  to  enable
                         cache, or 0 to disable cache.

         41    .STFPS    Sets or clears  floating-point  simulation.   To
                         set  floating  point  simulation,  put  1 in the
                         argument.   To  clear  it,  put  0  in  in   the
                         argument.

         42    .STOPP    Allows various levels of operators  to  run  OPR
                         without [1,2] privileges and without having full
                         file access.  This value may be read from GETTAB
                         table .GTOBI, and will be be used by LOGIN.

         43    .STQST    Sets  queue  structure.   This  sets  the   file
                         structure on which GALAXY queues will be stored.

         44    .STCSZ    Sets the size of  the  software  disk  cache  in
                         blocks.   This  value  can  be  set  with MONGEN
                         symbol M.CBMX.  The default value of  M.CBMX  is
                         the  number  of  jobs on the system.  The .STCSZ
                         function is illegal if M.CBMX=0.   The  argument
                         for  this  function specifies the number of disk
                         blocks for the cache.

         45    .STEBP    Sets the EDDT breakpoint facility.  The argument
                         to  this  function  is  either 0 (to disable the
                         facility) or 1 (to enable the facility).

         46    .STBPT    Sets the DDT breakpoint facility.  The  argument
                         to  this  function  is  either 0 (to disable the
                         facility) or 1 (to enable the facility).

         47    .STTMS    Sets the system time of day.  Specify  the  time
                         as the number of seconds past midnight.

|        50    .STCXP    Sets the maximum core size that a user  job  may
|                        use  (CORMAX).  The maximum value is the size of
|                        the user core in pages.
|  
|        51    .STCNP    Sets the guaranteed amount  of  contiguous  core
|                        that  a  single  unlocked  job can use (CORMIN),
|                        with the argument in pages.

   Normal Return

                                          ac        The function is performed and the ac is unchanged.



                                   22-366
                                                        SETUUO [CALLI 75]


   Error Return

               ac        If the ac is cleared, you do not have  sufficient  privileges  or
        you gave an illegal job number, CPU number, or argument.

               ac        If the ac is not changed on an error  return,  the  function  you
        requested is not implemented in the monitor.

        Otherwise, one of the following error codes can  be  returned  in
            ac        the ac:

         ____   ______    _____         Code   Symbol    Error

         0      STNAR%    Specified CPU(s) not running (functions  .STCPU
                          and .STCRN).
         1      STDHP%    Insufficient privileges  to  perform  specified
                          function.
         2      STISN%    Illegal structure name (function .STQST).
         3      STITM%    Illegal time (resulting time would  be  greater
                          than 23:59:59).

   Related Calls

        JBSET.










































                                   22-367
   SETUWP [CALLI 36]


                             SETUWP [CALLI 36]                             SETUWP [CALLI 36]



   Function

        Sets or clears user-mode write  protection  for  the  job's  high
        segment.   You must use the SETUWP call to clear write protection
        before your program can modify its high segment.

                                                                 ac        Because the previous setting of this bit is returned in  ac,  you
        can  write  subroutines  that  preserve  the previous setting and
        restore them before returning.

   Calling Sequence

                MOVEI     ac,fcncode
                SETUWP    ac,
                  error return
                normal return

                fcncode        where:  fcncode is one of the following function codes:

                ____     ________                Code     Function

                  0      Write-enables the high segment.
                  1      Write-protects the high segment.

   Normal Return

        The user-mode write protection bit is set as specified,  and  the
                                            ac        previous setting is returned in the ac.

   Error Return

        The error return is taken under the following conditions:

         o  If the high segment is a SPY segment.

         o  If the high segment has been meddled.

         o  If the user does not have the access privileges  required  to
            access the specified high segment.























                                   22-368
                                                      SKPINC [TTCALL 13,]


                            SKPINC [TTCALL 13,]                            SKPINC [TTCALL 13,]



   Function

        Skips the next program instruction if at least one character  can
        be  input  from  the job's controlling terminal.  The SKPINC call
        does not input a character.   SKPINC  clears  the  CTRL/O  output
        state  and  sets the terminal to "character mode", preventing the
        monitor from processing control characters, such  as  DELETE  and
        CTRL/U, as input line editing commands.

        This call is useful in a compute-bound program that should  check
        occasionally for user input.

   Calling Sequence

                SKPINC
                  return 1
                  return 2

                                    return 1        where:  the call returns to return 1 if there is no  user  input,
                      return 2                or to return 2 is there is user input.

   Related Calls

        SKPINL






































                                   22-369
   SKPINL [TTCALL 14,]


                            SKPINL [TTCALL 14,]                            SKPINL [TTCALL 14,]



   Function

        Skips the next instruction if at least one line can be input from
        the  job's  controlling  terminal.   SKPINL  sets the terminal to
        "line mode" and clears the CTRL/O output state.

   Calling Sequence

                SKPINL
                  return 1
                  return 2

                                    return 1        where:  the call returns to return 1 if a complete line  has  not
                                     return 2                been  typed,  or  to return 2 if a complete line has been
                typed.

   Related Calls

        SKPINC











































                                   22-370
                                                         SLEEP [CALLI 31]


                              SLEEP [CALLI 31]                              SLEEP [CALLI 31]



   Function

        Causes your program to become dormant for a specified  number  of
        real-time seconds.

   Calling Sequence

                MOVEI ac,seconds
                SLEEP ac,
                return

                seconds        where:  seconds gives the number of seconds that the  job  is  to
                                     seconds                sleep.   If you give seconds as 0, the program will sleep
                for one clock tick.  The maximum sleep time is 68 seconds
                (or  82  seconds  for systems using 50 Hz frequency).  If
                you require a longer sleep period, use the HIBER  monitor
                call.

   Return

        Your job becomes dormant and the monitor  sets  the  JBTST2  bit,
        JS.SLP.   The monitor will clear this bit when the specified time
        has elapsed and your job becomes runnable again.   All  potential
        job-wakers  should  check this bit and wake a job only if the bit
        is cleared.

   Examples

                MOVEI T1,1
                SLEEP T1,

        This code puts your job to sleep for 1 second.

   Related Calls

        HIBER


























                                   22-371
   SNOOP. [CALLI 176]


                             SNOOP. [CALLI 176]                             SNOOP. [CALLI 176]



   Function

        Allows privileged programs to insert breakpoints in  the  monitor
        that  trap to a user program.  The user program must be locked in
        core when the trap occurs (refer to  LOCK  monitor  call).   This
        feature  is  used  for fault insertion, performance analysis, and
        trace functions.  Only one job can use SNOOP. at any time.


                                     CAUTION


                Improper use of the SNOOP.  call  can  cause  the
                system  to  fail  in  a  number  of  ways.   User
                programs   may   require   special    code    for
                multiprocessor systems because the monitor may be
                executing the same code simultaneously on several
                systems and at different interrupt levels.


        Refer to  Chapter  10  for  more  information  about  the  SNOOP.
        monitor  call.   Do  not  attempt  to use this call until you are
        familiar with its operation.


   Calling Sequence

                MOVE    ac,[XWD fcncode,addr]
                SNOOP.  ac,
                  error return
                normal return
                . . .
        addr:   argument list

                fcncode        where:  fcncode is one of the function codes described below.

                addr                addr is the address of the argument list.  The  words  at
                addr                addr depend on the given function.

        The function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

          0    .SODBP    Defines breakpoints.  This function  is  illegal
                         if breakpoints have been inserted.

                         The argument list for the .SODPB function is:

                         arglst: EXP     arglength
                                 EXP     symbol checksum
                                 EXP     address
                                 instruction
                                 . . .
                                 EXP     address
                                 instruction







                                   22-372
                                                       SNOOP. [CALLI 176]


                                 arglength                         where:  arglength is the length of the  argument
                         list.    This   must   be   2 +  the  number  of
                         address-instruction pairs in the  argument  list
                         times 2 .

                         symbol checksum                         symbol checksum is the checksum from the current
                         monitor's symbol table.

                         The checksum is required to ensure that the user
                         is  setting breakpoints in the intended monitor.
                         Your program  can  obtain  the  version  of  the
                         monitor  that  is  read  in by BOOTS from GETTAB
                         table .GTCNF, where the relevant items are:

                         ______    ____      ________                         Offset    Item      Contents

                         137       %CNBCP    Bootstrap CPU number.
                         140       %CNBCL    Bootstrap line number.
                         141       %CNNCR    Number of CPUs allowed to
                                             run.
                         142       %CNMBS    Bootstrap file structure.
                         143       %CNMBF    Bootstrap file name.
                         144       %CNMBX    Bootstrap file extension.
                         145       %CNMBD    Bootstrap file directory.
                         155       %CNSF1    Bootstrap first SFD.
                         156       %CNSF2    Bootstrap second SFD.
                         157       %CNSF3    Bootstrap third SFD.
                         160       %CNSF4    Bootstrap fourth SFD.
                         161       %CNSF5    Bootstrap fifth SFD.

                         The checksum is followed by  a  series  of  word
                         pairs,  each  of  which  defines a breakpoint by
                         specifying, in the first word of each pair,  the
                         monitor    virtual   address   where   the   new
                         instruction is to be placed, and, in the  second
                         word  of  the  pair,  the  new instruction to be
                         inserted.  Specifically, the argument  list  for
                         SNOOP.  function 0 is:

                         ____    ______  ________                         Word    Symbol  Contents

                           0     .SOLEN  The length of the argument list,
                                         (the number of breakpoints being
                                         defined times two, plus two).

                           1     .SOMSC  The  checksum  of  the   monitor
                                         symbol table.

                           2     .SOMVA  Monitor  virtual  address  where
                                         new   instruction   is   to   be
                                         inserted.

                           3     .SOBPI  New instruction.

                         .SOMVA and .SOBPI are repeated for each replaced
                         instruction.










                                   22-373
   SNOOP. [CALLI 176]


        ____   ______    ________        Code   Symbol    Function

          1    .SOIBP    Inserts all breakpoints that have  been  defined
                         using  function  0.  Your program must be locked
                         in contiguous executive virtual  memory  to  use
                         this function (see the LOCK monitor call).

          2    .SORBP    Removes inserted breakpoints from monitor code.

          3    .SOUBP    Undefines breakpoints  that  have  been  removed
                         using function 2.

          4    .SONUL    Null function.   This  function  allows  you  to
                         execute  code  inserted  at  label BP$000, after
                         ensuring that your job owns the SNOOP  resource.
                         This  may be used by a program that must execute
                         code in monitor context and wants to ensure that
                         only this program can invoke the inserted code.

                         If you  do  not  own  the  SNOOP  resource,  the
                         instruction  at  BP$000 is not executed, and the
                         error code SOSAS% is returned.

   Normal Return

        The indicated function has been performed.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          1    SOIAL%    Illegal argument list.
          2    SONPV%    Not enough privileges.
          3    SOSAS%    Another program already snooping.
          4    SOMBX%    Maximum number of breakpoints exceeded.
          5    SOIBI%    Breakpoints already inserted.
          6    SONFS%    No monitor free core available.
          7    SOADC%    Address check.
         10    SOINL%    Program  not  locked  in  contiguous   executive
                         virtual memory.
         11    SOWMS%    Monitor symbol table checksum does not match.























                                   22-374
                                                       SNOOP. [CALLI 176]


   Examples

        The monitor computes the symbol table checksum in the following
        manner:

                MOVE    T1,.JBSYM
                SETZM   CHKSUM
        LOOP:   MOVE    T2,(T1)
                EXCH    T2,CHKSUM
                ROT     T2,1
                ADD     T2,CHKSUM
                EXCH    T2,CHKSUM
                AOBJN   T1,LOOP

                        .
                        .
                        .
                MOVE    T1,[XWD .SODBP,PUTEM]
                SNOOP.  T1,
                  JRST  NOGOOD
                MOVE    T1,[XWD .SOIBP,0]
                SNOOP.  T1,
                  JRST  NOBTTR
                        .
                        .
                        .
        PUTEM:  EXP     6
                EXP     MONITOR-CHECKSUM
                EXP     12345
                JRST    HOOK1
                EXP     12355
                JRST    HOOK2

        At this point the breakpoints  have  been  inserted.   To  remove
        them:

                        .
                        .
                        .
                MOVE    T1,[XWD .SORBP,0]
                SNOOP.  T1,
                  JRST  BUMMER
                MOVE    T1,[XWD .SOUBP,0]
                SNOOP.  T1,
                  JRST  LOSTIT
                        .
                        .
                        .


















                                   22-375
   SPPRM. [CALLI 172]


                             SPPRM. [CALLI 172]                             SPPRM. [CALLI 172]



   Function

        Sets parameters for spooled files.

   Calling Sequence

                MOVE    ac,[length,addr]
                SPPRM.  ac,
                  error return
                normal return
                . . .
        addr:   function code
                device-id
                parameters
                .
                .
                .

                length        where:  length is the length of the argument list.

                addr                addr is the address of the argument list; and the data at
                addr                addr is listed below.

                function code                function code specifies the type of file.

                device-id                device-id identifies the device.

                parameters                parameters describes  the  characteristics  of  the  file
                processing   to   be  performed.   These  parameters  are
                optional.

        Specifically, the argument list is:

        ____   ______    ________        Word   Symbol    Contents

          0    .SPPFN    Function code, one of the following:

                         ____   ______    ________                         Code   Symbol    Function

                           1    .SPSFP    Sets spooled file parameters.
                           2    .SPSPR    Sets  spooled  parameters   for
                                          renamed files.

          1    .SPPDN    SIXBIT name of spooled device, channel number of
                         spooled  file,  or  the  UDX of the device.  The
                         following words are optional

          2    .SPPCP    Number of copies.

          3    .SPPFM    SIXBIT forms name.

          4    .SPPLM    Limit.










                                   22-376
                                                       SPPRM. [CALLI 172]


        ____   ______    ________        Word   Symbol    Contents

          5    .SPPSF    Spooling flags:

                         ____   ______    _______                         Bits   Symbol    Meaning

                          1-2   SP.DFR    Deferred/immediate flag.

                                          _____  ______    _______                                          Value  Symbol    Setting

                                            1    .SPDFD    Deferred.  The
                                                           spooler should
                                                           not      start
                                                           processing the
                                                           file until the
                                                           user  job logs
                                                           out.
                                            2    .SPDFI    Immediate.
                                                           Begin spooling
                                                           immediately.

                        30-35   SP.TYP    Type of device, as reported  by
                                          DEVTYP monitor call.

          6    .SPPDA    Device attributes:

                         ____   ______    _________                         Bits   Symbol    Attribute

                            0   SP.UPC    Uppercase (LPT).
                            1   SP.LWC    Lowercase (LPT).
                           18   SP.PHY    Physical  unit  is   given   in
                                          SP.UNI.
                        28-35   SP.UNI    Physical unit number (if SP.PHY
                                          set).

          7    .SPPND    Node at which processing is to be done.

         10    .SPPAF    Time at which to begin  processing  (similar  to
                         /AFTER switch).

         11    .SPNM1    In-your-behalf user name (word 0 of  word  pair)
                         in SIXBIT.

         12    .SPNM2    Second word of user name, in SIXBIT.

         13    .SPMAX    Maximum length of argument block.

   Normal Return

        The specified parameters are set.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

         -1    SPPAC%    Address check.
          0    SPPIA%    Illegal length for argument list.
          1    SPPID%    Illegal device.
          2    SPPNA%    Device not assigned or initialized.
          3    SPPNS%    Device not spooled.
          4    SPPNC%    No free core for spooled parameter block.
          5    SPPIF%    Illegal function code.


                                   22-377
   SPY [CALLI 42]


                               SPY [CALLI 42]                               SPY [CALLI 42]



   Function

|       Maps monitor section zero low-segment  address  space  into  your
        program's  high  segment.   Use  of the SPY monitor call requires
        that bit 16 (JP.SPA) or bit 17 (JP.SPM)  in  the  privilege  word
        .GTPRV be set.  The SPY segment cannot be write-enabled.

        The SPY monitor call can be used to examine  the  monitor  during
        timesharing; it allows read-only access to monitor locations.

        The SPY segment size cannot be changed by a CORE monitor call; if
        you attempt to do this, the CORE call will take its error return.

   Calling Sequence

                MOVEI   ac,monitoraddr
                SPY     ac,
                  error return
                normal return

                monitoraddr        where:  monitoraddr is the highest exec virtual (monitor) address
                                                              monitoraddr                desired.   Monitor low-segment core from 0 to monitoraddr
                is mapped into user  high-segment  core  from  400000  to
                       monitoraddr                            monitoraddr                400000+monitoraddr.   Therefore  the value of monitoraddr
                can be any value between 0 and 377777.

        Note that you cannot save this portion of memory with  the  SAVE.
        monitor call.

   Normal Return

        The desired monitor core  is  mapped  into  your  program's  high
        segment.

   Error Return

        The  error  return  occurs  if  you  use  an  invalid  value  for
        monitoraddr        monitoraddr,  or  if  your  program  does  not  have the required
        privileges.

   Examples

|       This code maps some of the monitor's section zero low segment.

                MOVE     T1,[%CNSIZ]
                GETTAB   T1,
                  HALT
                SPY      T1,
                  JRST      ERROR

   Related Calls

        PAGE., PEEK, POKE.









                                   22-378
                                                       STATO [OPCODE 061]


                             STATO [OPCODE 061]                             STATO [OPCODE 061]



   Function

        Tests the I/O status word for a device and skips if  any  of  the
|       specified  bits  are  set.   Use FILOP. to perform a STATO for an
|       extended  I/O  channel.   The  I/O  status   bits   are   defined
        differently  for each device.  Therefore, the bits appropriate to
        each device are described in Volume 1  in  the  chapter  on  that
        device.

   Calling Sequence

                STATO channo,mask
                  return 1
                  return 2

                channo        Where:  channo is the number of an initialized channel.

                mask                mask is a  halfword  of  bits,  where  each  bit  sets  a
                corresponding bit in the I/O status word.  The I/O status
                word is described in  Volume  1,  in  each  chapter  that
                pertains to a specific device.

        The I/O status bits are a  set  of  18  bits  (right  half)  that
        reflect  the  current  state  of  a  file transmission.  They are
        initially set by your program with the  INIT/OPEN  monitor  call.
        Thereafter,  the monitor sets the bits, but your program can test
        and reset them with any of several monitor calls.

   Return

                            return 1        The call returns to return 1 if all of the specified bits are  0,
              return 2        or to return 2 if any of the specified bits are set to 1.

   Examples

        See OPEN call.

   Related Calls

        STATZ






















                                   22-379
   STATZ [OPCODE 063]


                             STATZ [OPCODE 063]                             STATZ [OPCODE 063]



   Function

        Tests the I/O status (also  called  "file  status")  word  for  a
|       device  and  skips if all of the specified bits are cleared.  Use
|       FILOP. to perform a STATZ on an  extended  I/O  channel.   For  a
        complete list of I/O status bits, refer to the appropriate device
        chapter in Volume 1.

   Calling Sequence

                STATZ channo,mask
                  return 1
                  return 2

                channo        where:  channo is the number of an initialized channel.

                mask                mask is a  halfword  in  which  each  bit  that  you  set
                corresponds to a bit in the I/O status word.

        The I/O status bits are a  set  of  18  bits  (right  half)  that
        reflect  the  current  state  of  a  file transmission.  They are
        initially set by your program with the  INIT/OPEN  monitor  call.
        Thereafter,  the monitor sets the bits, but your program can test
        and reset them with any of several monitor calls.

   Return

                            return 1        The call returns to return 1 if one or more of the specified bits
                    return 2        is 1, or to return 2 if all of the specified bits are 0.

   Related Calls

        STATO





























                                   22-380
                                                        STRUUO [CALLI 50]


                             STRUUO [CALLI 50]                             STRUUO [CALLI 50]



   Function

|       Modifies the search list for a job or for the system.  Except for
|       function  0,  the  functions  and calling sequence for the STRUUO
        monitor call are subject to change; therefore you should not  use
        anything but function 0 in user programs.  All functions except 0
        are privileged functions.

   Calling Sequence

                MOVE   ac,[XWD len,addr]
                STRUUO ac,
                  error return
                normal return
                . . .
        addr:   fcncode
                first argument
                . . .
                last argument

                len        where:  len is the length of the argument list.

                addr                addr is the address of the argument list.  The format  of
                the argument block is different depending on the function
                code specified in the first word of the argument block.

                fcncode                fcncode is one of the function codes described below; the
                                    last  argument                words  up  through  last  argument  are arguments for the
                given function.  The function codes  and  their  meanings
                are are described below:


        ____   ______    ________        Code   Symbol    Function

          0    .FSSRC    Defines a new job search list.   The  format  of
                         the argument block is shown below:

                         ____    ______  ________                         Word    Symbol  Contents

                           0     .FSFCN  The function code.  (.FSSRC)

                           1     .FSCSO  Offset to  first  word  of  file
                                         structure  block,  as  used  for
                                         argument list to JOBSTR  monitor
                                         call.

                         The first word of the argument block is followed
                         by  blocks of three words each.  Each three-word
                         block contains, in the first word, the structure
                         name; in the second word, zero; and in the third
                         word, flags that are described  for  the  JOBSTR
                         monitor call.










                                   22-381
   STRUUO [CALLI 50]


        ____   ______    ________        Code   Symbol    Function

                         Your program  cannot  create  files  on  a  file
                         structure  unless  it  has  access  to  the file
                         structure.   However,  by   using   the   .FSSRC
                         function  your  program can add a file structure
                         to its search list.  If your program attempts to
                         delete  a  file  structure from its search list,
                         the monitor moves the file structure's name from
                         the  job's  active  search  list  to its passive
                         search list.  To remove the file structure  from
                         the  active  or  passive  search list, issue the
                         DISMOUNT monitor command.

          1    .FSDSL    Defines a new search list for a job or for  SYS.
                         MOUNT   uses   this  function  to  complete  the
                         mounting or dismounting procedures and to add or
                         delete file structures from another job's search
                         list.   The  argument  block  for   the   .FSDSL
                         function is shown below:

                         ____    ______  ________                         Word    Symbol  Contents

                           0     .FSFCN  Function code.  (.FSDSL)

                           1     .FSDJN  The  number  of  the  job  whose
                                         search list is to be defined.

                           2     .FSDPP  The project-programmer number of
                                         the job.

                           3     .FSDFL  The flag word.   If  bit  35  is
                                         set,   (DF.SRM),   the   monitor
                                         removes   all    deleted    file
                                         structures from the job's search
                                         list  and  decrements  the  file
                                         structure's mount count.  If bit
                                         35  is  not  set,  the   monitor
                                         places    all    deleted    file
                                         structures in the passive search
                                         list.     To   delete   a   file
                                         structure,  it  must  have  been
                                         present  in  the  current search
                                         list  and  not  listed  in   the
                                         argument block.

                           4     .FSDSO  Offset to first word  of  JOBSTR
                                         argument block.

                         The argument block contains as  its  first  four
                         words:   the  function  code,  a  job  number, a
                         project-programmer  number,  and  a  flag  word.
                         These  four  words  are  followed by one or more
                         three-word entries (each is  an  argument  block
                         like that used by the JOBSTR call).  The entries
                         specify the file structures to be in the  search
                         list.   The  order  in which the file structures
                         appear in the argument block  is  the  order  in
                         which they will appear in the search list.







                                   22-382
                                                        STRUUO [CALLI 50]


        ____   ______    ________        Code   Symbol    Function

                         If the job  number  and  the  project-programmer
                         number  are  both  -1,  the  monitor assumes the
                         search list for your job is to be  defined.   If
                         the  job  number  is  0, the monitor ignores the
                         project-programmer  number  and   modifies   the
                         system search list (SYS).  If a value other than
                         -1 or 0 is specified, the  monitor  defines  the
                         search  list  of  the job with the specified job
                         number  and   project-programmer   number.    To
                         indicate the FENCE, your program must substitute
                         XWD 0,0 for SIXBIT/name/ in the  first  word  of
                         the   three-word   entry.    When  your  program
                         specifies  the  FENCE  there   will   be   three
                         consecutive zero words in the three-word entry.

          2    .FSDEF    Makes a new file structure  available  to  users
                         (for  example,  defines  a  new file structure).
                         The file structure name, status, list of  drives
                         and   their   associated   units   (packs),  and
                         information for initializing components  of  the
                         monitor  data base are specified in the argument
                         block.   Specifically,  the  function  does  the
                         following:


                          o  Builds a prototype structure data block.

                          o  Links and  initializes  all  necessary  Unit
                             Data Blocks.

                          o  Allocates  core  and  initializes  the   SPT
                             tables and SAB rings.

                          o  Sets the state of the units to PACK MOUNTED.

                          o  Creates a TABSTR entry (assigns a number  to
                             the file structure).

                         The argument block for the  .FSDEF  function  is
                         shown below:

                         ____    ______  ________                         Word    Symbol  Contents

                           0     .FSFCN  Function code.  (.FSDEF)

                           1     .FSNST  Pointer   to    the    structure
                                         parameter  block,  in  the  form
                                         (length,,address).

                           2     .FSNUN  Pointer to  the  unit  parameter
                                         block  for  unit  0, in the form
                                         (length,,address).

                           3             Pointer to  the  unit  parameter
                                         block  for  unit  1, in the form
                                         (length,,address).

                                 .
                                 .
                                 .




                                   22-383
   STRUUO [CALLI 50]


                         The structure parameter block  is  formatted  as
                         follows:

                         ____    ______  ________                         Word    Symbol  Contents

                           0     .FSSNM  File structure  name  in  SIXBIT
                                         (word HOMSNM in the HOME block).

                           1     .FSSNU  Number   of   units    in    the
                                         structure.

                           2     .FSSHL  Highest  logical  block   number
                                         (that  is,  .FSSBU  times .FSSNU
                                         - 1).

                           3     .FSSSZ  Size (in  blocks)  of  the  file
                                         structure.  (That is, the sum of
                                         the values of  UNIBPU  for  each
                                         unit.   The  value of UNIBPU can
                                         be found in word .DCUSZ returned
                                         by the DSKCHR. call).

                           4     .FSSRQ  Obsolete.

                           5     .FSSRF  Obsolete.

                           6     .FSSTL  Number  of   FCFS   (first-come,
                                         first-served)    blocks    left.
                                         (That is, the sum of the  values
                                         of .FSUTL for each unit).

                           7     .FSSOD  Number  of  blocks  allowed  for
                                         overdraw  (stored  as a negative
                                         number).  See HOMOVR in the HOME
                                         block.

                          10     .FSSMP  First   retrieval   pointer   to
                                         Master   File   Directory.   See
                                         HOMPT1 in the HOME block.

                          11     .FSSML  -1  if  .FSSMP   is   the   only
                                         retrieval  pointer  to  MFD.  To
                                         set this word, you must read the
                                         RIB  and  test its contents.  Do
                                         not use COPIPT  from  HOMUN1  in
                                         the HOME block.

                          12     .FSSUN  Logical unit number  within  the
                                         file structure where MFD begins.
                                         (See  HOMUN1   from   the   HOME
                                         block.)

                          13     .FSSTR  Number of retries on  an  error.
                                         The  suggested  value  for  this
                                         word is 10 (decimal).

                          14     .FSSBU  Largest block on unit.  (Largest
                                         value  of  UNIBPU,  returned  in
                                         .DCUSZ by DSKCHR.)







                                   22-384
                                                        STRUUO [CALLI 50]


                         ____    ______  ________                         Word    Symbol  Contents

                          15     .FSSBC  Number     of     blocks     per
                                         super-cluster (see HOMBSC in the
                                         HOME block).

                          16     .FSSSU  Number  of  super-clusters   per
                                         unit  (see  HOMSCU  in  the HOME
                                         block).

                          17     .FSSIG  Obsolete.

                          20     .FSSCC  Byte pointer  to  cluster  count
                                         (see HOMCNP in the HOME block).

                          21     .FSSCK  Byte   pointer   to    retrieval
                                         pointer  checksum (see HOMCKP in
                                         the HOME block).

                          22     .FSSCA  Byte   pointer   to    retrieval
                                         pointer   cluster  address  (see
                                         HOMCLP in the HOME block).

                          23     .FSPVT  -1  if   this   is   a   private
                                         structure (see the HOPPVS bit in
                                         HOMPVS in the HOME block).

                          24     .FSPPN  PPN  of  file  structure   owner
                                         (each  half  is -1 if wild) (see
                                         HOMOPP in the HOME block).

                          25     .FSSCR  Block  in  structure  containing
                                         RIB for CRASH.EXE (see HOMCRS in
                                         the HOME block).

                          26     .FSK4C  Number  of  K  to  reserve   for
                                         CRASH.EXE on disk (see HOMK4C in
                                         the HOME block).

                         The format of the unit parameter block is:

                         ____    ______  ________                         Word    Symbol  Contents

                           0     .FSUNM  Unit name  in  SIXBIT  (such  as
                                         RPA0).

                           1     .FSUID  Pack identifier  (that  is,  the
                                         pack  serial  number  in SIXBIT;
                                         see HOMHID in the HOME block).

                           2     .FSULN  Logical   name    within    file
                                         structure    (such   as   DSKB0,
                                         DSKB1,...DSKB77; see  HOMLOG  in
                                         the HOME block).












                                   22-385
   STRUUO [CALLI 50]


                         ____    ______  ________                         Word    Symbol  Contents

                           3     .FSULU  Logical unit-number within  file
                                         structure    (0,1,2,....FSSNU-1)
                                         (see HOMLUN in the HOME block).

                           4     .FSUDS  Status bits.  These are:

                                         ___   ______   _______                                         Bit   Symbol   Meaning

                                          0    FS.UWL   Software
                                                        write-lock.
                                          1    FS.USA   Obsolete.

                                         FS.UWL is  meaningful  only  for
                                         the first unit in the structure.

                           5     .FSUGP  Number of sequential  blocks  to
                                         try  for  on  sequential  output
                                         (see HOMGRP in the HOME block).

                           6     .FSUTL  Number of free blocks  on  unit,
                                         minus   a  safety  factor.   The
                                         suggested safety factor  is  one
                                         block  of  safety  for every 500
                                         (decimal) blocks  of  disk.   Do
                                         not  allocate  safety blocks for
                                         the swapping space.   Thus,  the
                                         suggested   safety   factor   is
                                         (UNIBPU-HOMK4S*8)/500.      This
                                         value  should  be  truncated  to
                                         less than 500  (decimal)  blocks
                                         per unit.

                           7     .FSUBC  Number  of  blocks  per  cluster
                                         (see HOMBPC in the HOME block).

                          10     .FSUCS  Number of clusters per SAT (that
                                         is, (UNIBPU/HOMBPC-1)/HOMSPU+1).

                          11     .FSUWS  Number of words  per  SAT  (that
                                         is, (.FSUCS-1)/36 + 1).

                          12     .FSUSC  Number  of  SATs  in  core  (see
                                         HOMSIC in the HOME block).

                          13     .FSUSU  Number of  SATs  per  unit  (see
                                         HOMSPU in the HOME block).

|                         14     .FSUSP  Pointer     to     SPT     table
                                         (length,,address).

                          15     .FSUSB  First block  for  swapping  (see
                                         HOMSLB in the HOME block).

                          16     .FSUKS  Number of K for SWAP.SYS.   (See
                                         HOMK4S in the HOME block.)









                                   22-386
                                                        STRUUO [CALLI 50]


                         The format of the SPT table is:

                         ____    ________                         Word    Contents

                            0    Pointer to 1st SAT block.
                            1    Pointer to 2nd SAT block.
                            .
                            .
                            .
                            n    Pointer to nth SAT block.

                         Each word in the SPT table is in the form:

                         ____    _______                         Bits    Contain

                         0-12    Number of free clusters in this SAT.
                         13-35   Address of SAT (as a cluster number).

          3    .FSRDF    Allows your program to change the  status  of  a
                         file structure if its mount count is 0 or 1.  If
                         the  mount  count  is  1,  the  job  number  and
                         project-programmer   number  arguments  must  be
                         those for the job that has the structure mounted
                         (in  its  search  list).   If the job number and
                         project-programmer  number  are  both  -1,   the
                         search list for your job is assumed.

                         The argument block for the  .FSRDF  function  is
                         listed below.

                         ____    ______  ________                         Word    Symbol  Contents

                           0     .FSFCN  The function code (.FSRDF).

                           1     .FSRJN  The job number or -1.

                           2     .FSRPP  The project-programmer number or
                                         -1.

                           3     .FSRNM  The file structure name.

                           4     .FSRST  The  new  status  bits   to   be
                                         assigned.

          4    .FSLOK    Allows your program to place a file structure in
                         a  state  where  no  new  LOOKUPs  or ENTERs are
                         allowed.  The monitor will allow current reading
                         and writing to continue until a CLOSE is issued.
                         This function  can  be  used  to  force  a  file
                         structure into a dormant state so that it can be
                         removed from the system with minimal  damage  to
                         its  users.  For example, this function could be
                         followed by .FSREM.  The argument block for this
                         function is described below:

                         ____    ______  ________                         Word    Symbol  Contents

                           0     .FSFCN  The function code (.FSRDF).

                           1     .FSLNM  The  file  structure   name   in
                                         SIXBIT.





                                   22-387
   STRUUO [CALLI 50]


      ____     ______    ________      Code     Symbol    Function

        5      .FSREM    Removes a file structure from the system.   This
                         removal  takes place immediately, with no regard
                         for the users of the file structure.   Normally,
                         this function is preceded by the .FSLOK function
                         to   prepare   the   structure   for    removal.
                         Specifically,   the  .FSREM  function  does  the
                         following:

                          o  Takes  the  non-error  return  if  the  file
                             structure does not exist.

                          o  Removes the file  structure  name  from  the
                             search  list of all jobs and from the system
                             search list.

                          o  Unlinks and returns to the  free  core  pool
                             any UFB or access blocks.

                          o  For every unit, sets the state  to  NO  PACK
                             MOUNTED  and returns any core taken from the
                             free core pool.

                          o  Clears KNOWLEDGE bits in  the  PPB  and  NMB
                             blocks.

                          o  Unlinks STR data blocks and returns its core
                             if taken from the free core pool.

                          o  Deletes (or marks for deletion) all sharable
                             high  segments  initialized  from  the  file
                             structure.

                          o  Clears the TABSTR entry.

                          o  Takes the non-error return.

                         The argument block for the  .FSREM  function  is
                         shown below:

                         ____    ______  ________                         Word    Symbol  Contents

                           0     .FSFCN  The function code (.FSREM).

                           1     .FSMNM  The  file  structure   name   in
                                         SIXBIT.

           6   .FSULK    Tests  and  sets  the  software  write-lock  bit
                         associated  with  each  UFD.   This  function is
                         used, along with the .FSUCL function, to control
                         programs  (such  as LOGOUT and LOGIN) attempting
                         to modify a UFD at  the  same  time.   With  the
                         interlock  bit  set, only one program can modify
                         the UFD at a time.  Other programs  should  WAIT
                         for the interlock to be cleared.










                                   22-388
                                                        STRUUO [CALLI 50]


                         The argument block for the  .FSULK  function  is
                         shown below.

                         ____    ______  ________                         Word    Symbol  Contents

                           0     .FSFCN  The function code (.FSULK).

                           1     .FSINM  The  file  structure   name   in
                                         SIXBIT.

                           2     .FSIPP  The PPN of the UFD.

                         If the interlock bit is set for a program  other
                         than  your program, your program takes the error
                         return.


           7   .FSUCL    Clears the software interlock associated with  a
                         UFD.   Once a program has cleared the interlock,
                         another program may set the interlock  (function
                         .FSULK)  and modify the UFD.  The argument block
                         for the .FSUCL function is shown below:

                         ____    ______  ________                         Word    Symbol  Contents

                           0     .FSFCN  The function code (.FSUCL).

                           1     .FSGNM  The  file  structure   name   in
                                         SIXBIT.

                           2     .FSGPP  The PPN of the UFD.

         10    .FSETS    Tests error recovery procedures for the  monitor
                         and  your  programs  by  causing  hard  and soft
                         errors to be simulated  on  the  specified  disk
                         unit of the system.

                                               NOTE

                             This function is  obsolete  and  applies
                             only to RP10 and RC10 controllers.

                         All error recovery and reporting procedures  are
                         followed  through  by  the  monitor as if a real
                         error had occurred.  This  function  causes  the
                         monitor  to  enter  the simulated hard errors in
                         the BAT block just as  it  would  enter  a  real
                         error.    Therefore,  field  service  should  be
                         notified of any error simulations that are being
                         done.

                         This function is implemented only for disk packs
                         and  should  not be attempted for the fixed-head
                         disk because the counts will not be decremented.
                         When  a  unit  is  removed  from the system, the
                         error test sequence is terminated.










                                   22-389
   STRUUO [CALLI 50]


                         The argument block for the  .FSETS  function  is
                         listed below.

                         ____    ______  ________                         Word    Symbol  Contents

                           0     .FSFCN  The function code (.FSETS).

                           1     .FSEUN  The disk pack name.

                           2     .FSEGT  The  number  of  good   transfer
                                         interrupts  before simulation of
                                         error.

                           3     .FSEDB  The number of bad DATAI's before
                                         the end of simulated error.

                           4     .FSEDO  Error DATAI bits ORed with DATAI
                                         bits received from the hardware.

                           5     .FSEDA  Error DATAI  bits  ANDCMed  with
                                         DATAI  bits  received  from  the
                                         hardware.

                           6     .FSECB  The number of bad  CONIs  before
                                         terminating    simulated   error
                                         sequence.

                           7     .FSECO  Error CONI bits ORed  with  CONI
                                         bits received from the hardware.

                           10    .FSECA  Error  CONI  bits  ANDCMed  with
                                         CONI   bits  received  from  the
                                         hardware.

                         Note that the CONI mentioned above  is  executed
                         after  a  data  transfer  interrupt;  the  DATAI
                         mentioned above is executed before connecting to
                         the  unit  to  initiate  a  position or transfer
                         operation.

        ____   ______    ________        Code   Symbol    Function

         11    .FSNMW    Modifies the 'nocreate' and 'write-lock'  status
                         of  a  file  structure.   The argument block for
                         this function is shown below.

                         ____    ______  ________                         Word    Symbol  Contents

                           0     .FSFCN  The function code (.FSNMW).

                           1     .FSMFS  The file structure name.

                           2     .FSMFL  The flag word:

                                         ___   ______     _______                                         Bit   Symbol     Meaning

                                          0    FS.MWL     Write-lock bit.
                                          1    FS.MNC     No create bit.








                                   22-390
                                                        STRUUO [CALLI 50]


         ____  ______    ________         Code  Symbol    Function

         12    .FSCLR    Unlocks a file structure.  The argument list is:

                         ____    ______  ________                         Word    Symbol  Contents

                           0     .FSFCN  The function code (.FSCLR).

                           1     .FSCFS  The  file  structure   name   in
                                         SIXBIT.

   Normal Return

        The function is performed.

   Error Return

        Before the monitor  accepts  the  newly-defined  search  list  by
        copying  it  in  the PDB, it checks that the number of structures
        defined is less than the system-defined  maximum  limit  for  the
        job.  This limit is stored in GETTAB table %LDMSS.  If the number
                                                                   ac        exceeds the maximum, the error return is  taken  and  the  ac  is
        cleared.

        Otherwise, one of the following error codes is  returned  in  the
        ac        ac:

        ____         ______    _____        Code         Symbol    Error

           0         FSILF%    An illegal function code was specified.
           1         FSSNF%    One  or  more  of  the  specified   file
                               structures were not found.
           2         FSSSA%    One  or  more  of  the  specified   file
                               structures are in single-access mode.
           3         FSILE%    One or more illegal entries are  in  the
                               argument block.
           4         FSTME%    There are too many entries in the search
                               list.
           5         FSUNA%    One or more of the specified  units  are
                               not available.
           6         FSPPN%    The    specified    job    number    and
                               project-programmer number do not match.
           7         FSMCN%    The mount count is greater than 1.
          10         FSNPV%    Your job is not  privileged  but  should
                               be.
          11         FSFSA%    The  specified  file  structure  already
                               exists.
          12         FSILL%    The  argument  block  length  has   been
                               specified incorrectly.
          13         FSUNC%    Unable to complete the call.
          14         FSNFS%    The  system  has  reached  the   maximum
                               number of file structures.
          15         FSNCS%    There is not enough free  core  for  the
                               data block.
          16         FSUNF%    An illegal unit has been specified.
          17         FSRSL%    A file structure name is repeated  in  a
                               search list
          20         FSASL%    Structure  contains  units   in   active
                               search list.
          21         FSISN%    You specified an illegal structure name.

   Related Calls

        DSKCHR, GOBSTR, JOBSTR


                                   22-391
   SUSET. [CALLI 146]


                            SUSET. [CALLI 146]                            SUSET. [CALLI 146]



   Function

        Selects a logical block number to be either read or written  on
        subsequent  IN/INPUT  or  OUT/OUTPUT  monitor calls relating to
        either a file structure or a unit  name.   This  call  requires
        your program to have [1,2] or JACCT privileges.

        The block number is relative to a file structure if the channel
        was  initialized  with  a  structure name (such as DSKB) and no
        file is open on the channel (that is, no LOOKUP  or  ENTER  was
        performed).

        The block number is relative to a unit number  if  the  channel
        was  initialized  with a physical or logical unit name (such as
        RPA4 or DSKB) and no file is open on the channel (that  is,  no
        LOOKUP or ENTER was performed).

        Refer to Section 11.7.5 for more detailed discussion of SUSET.

   Calling Sequence

                MOVE    ac,[EXP flags]
                SUSET.  ac,
                  error return
                normal return

                flags        where:  flags are as follows:

        ____   ______    _______        Bits   Symbol    Meaning

           0             Reserved.
           1   SU.SOT    Output (input if not set).
           2   SU.SMN    Maintenance cylinder.  You can  set  this  bit
                         only  if  your  job  is logged in under [6,6].
                         SU.SBL (below) must  contain  the  maintenance
                         cylinder.
           3             Reserved.
        4-12   SU.SCH    Channel number.  The channel number may be  an
                         extended  channel  number  obtained  from  the
                         FILOP.  monitor call.
       13-35   SU.SBL    Block  number  or  maintenance  cylinder   (if
                         SU.SMN is on).

   Normal Return

        The specified block will be the  next  one  read/written  on  a
        subsequent   IN/OUT  monitor  call.   The  SUSET. monitor  call
        returns with the I/O status bit IO.BKT set if your job does not
        have  enough  privileges,  or  if the given block number is too
        large.












                                   22-392
                                                       SUSET. [CALLI 146]


   Error Return

                                                    ac        The following error code is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

         -1    SUSNP%    Not enough privileges.

   Related Calls

        FILOP., USETI, USETO























































                                   22-393
   SYSPHY [CALLI 51]


                            SYSPHY [CALLI 51]                            SYSPHY [CALLI 51]



   Function

        Returns the name of a physical disk unit on the system.

   Calling Sequence

                MOVEI   ac,0                    \
                MOVE    ac,[SIXBIT/device/]     /
                SYSPHY  ac,
                  error return
                normal return

                device        where:  device is the physical unit name returned by a previous
                call (such as SIXBIT/RPA0/).

   Normal Return

                   ac        If you set ac to 0, the monitor returns the first physical disk
                  ac        name  in  ac.   If  you  gave  the  name of a disk, the monitor
        returns the next physical disk name, or, if there are  no  more
                                            ac        disks, the monitor returns 0 in the ac.

   Error Return

                                                  device        The monitor takes the error return if the device you  gave  was
        neither 0 nor the name of a disk unit.

   Examples

        Example to get all units in system

                 SETZB    T1,T2           ;T1=Table pointer, T2=unit
                                          ; name
        LOOP:    SYSPHY   T2,             ;Get next one
                   JRST   ERROR
                 JUMPE    T2,CONTIN       ;Done if zero
                 MOVEM    T2,PHYTAB(T1)   ;Save in table
                 AOJA     T1,LOOP         
        PHYTAB:  BLOCK    ^D64

   Related Calls

        DVPHY., SYSSTR



















                                   22-394
                                                        SYSSTR [CALLI 46]


                            SYSSTR [CALLI 46]                            SYSSTR [CALLI 46]



   Function

        Returns the name of a file structure on the system.

   Calling Sequence

                 MOVEI    ac,0                    \
                 MOVE     ac,[SIXBIT/device/]     /
                 SYSSTR   ac,
                   error return
                 normal return

                device        where:  device is the structure name  returned  by  a  previous
                call.

   Normal Return

                   ac        If you set ac to 0, the monitor  returns  the  first  structure
                  ac        name  in  ac.  If you gave the name of a structure, the monitor
                                           ac        returns the next structure name in ac, or if there are no  more
                                                   ac        structures, the monitor returns a 0 in the ac.

   Error Return

                                                  device        The monitor takes the error return if the device you  gave  was
        neither 0 nor the name of a structure.

   Examples

        Example to get all units on system

                 SETZB    T1,T2           ;Use T1 as table index, T2 as
                                          ; structure name
        LOOP:    SYSSTR   T2,             ;Get next structure
                   JRST   ERROR           
                 JUMPE    T2,CONTIN       ;Done if structure is zero
                 MOVEM    T2,STRTAB(T1)   ;Save in table
                 AOJA     T1,LOOP         ;Get next one
        STRTAB:  BLOCK    ^D64            ;Where to put structures

   Related Calls

        DVPHY., SYSPHY.



















                                   22-395
   TAPOP. [CALLI 154]


                            TAPOP. [CALLI 154]                            TAPOP. [CALLI 154]



   Function

        Performs various  magnetic  tape  operations.   Several  TAPOP.
        functions are identical to or extensions of other monitor calls
        such as MTAPE and MTCHR.  All TAPOP.  functions assume that the
        specified  device  has  been assigned to your job by the ASSIGN
        monitor command or the  OPEN/INIT  monitor  call  or  that  the
        calling job has SPY privileges.

   Calling Sequence
                MOVE    ac,[XWD len,addr]
                TAPOP.  ac,
                  error return
                normal return
                . . .
        addr:   EXP     fncode
                SIXBIT/device/   \
                EXP     channo   |
                EXP     udx      /
                first argument
                . . .
                last argument

                len        where:  len is the length of the argument list.

                addr                addr is the address of the argument list.

                fcncode                fcncode is one of the function codes described below.

                device                device is the SIXBIT physical  or  logical  name  of  a
                device.

                channo                channo is the number of an initialized channel.

                udx                udx is the Universal Device Index for a device and  the
                                    last argument                words  up  through  last argument are arguments for the
                given function.

        The function codes fall into four groups:

           _____         _________           Codes         Functions

           0 -  777      Perform specific actions.

        1000 - 1777      Read parameters.

        2000 - 2777      Set parameters.  These function codes are  not
                         explicitly  listed  in the descriptions below.
                         To set a parameter, use the corresponding read
                         function  name plus the offset .TFSET (=1000).
                         For example, to set the density indicator, use
                         the   read  density  indicator  mnemonic  plus
                         .TFSET:

                         .TFDEN+.TFSET

        3000 - 3777      Reserved for customer-defined functions.





                                   22-396
                                                       TAPOP. [CALLI 154]


        The function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

           1   .TFWAT    Waits for I/O to be completed.

           2   .TFREW    Rewinds tape to load point.

           3   .TFUNL    Rewinds and unloads tape.

           4   .TFFSB    Skips forward one block.

           5   .TFFSF    Skips forward one file.

           6   .TFSLE    Skips to logical end-of-tape.

           7   .TFBSB    Skips backward one block.

          10   .TFBSF    Skips backward one file.

          11   .TFWTM    Writes a tape mark.

          12   .TFWLG    Writes 3 inches of blank tape.

          13   .TFDSE    Erases entire tape (data  security,  TX01/TX02
                         on DX10/DX20 only).

          14   .TFWLE    Writes logical end-of-tape (two tape marks for
                         unlabeled tapes).

          15   .TFLBG    Gets  the  tape  label  device   data   block.
                                              ac                         Returns  the name in ac.  This is a privileged
                         function for use by the label processor.

          16   .TFLRL    Releases the tape  label  device  data  block.
                         This  is  a privileged function for use by the
                         label processor.

          17   .TFLSU    Swaps units.  This is  a  privileged  function
                         for use by the label processor.

          20   .TFLDD    Destroys the tape label data base.  This is  a
                         privileged  function  for  use  by  the  label
                         processor.

          21   .TFFEV    Forces end-of-volume processing.  This  allows
                         your  program to write the end-of-volume label
                         before  PULSAR  finds  the  end-of-tape.   The
                         monitor   assumes   a   multivolume  file  and
                         automatically issues an operator MOUNT request
                         for the next volume.

          22   .TFURQ    Requests label processing.  Set flag .TFCLE to
                         clear a tape labelling error.

          23   .TFSMM    Sets maintenance mode on the tape  controller.
                         This is a privileged function.

          24   .TFCMM    Clears   maintenance   mode   on   the    tape
                         controller.  This is a privileged function.

          25   .TFCEC    Clears  error   counters.    This   privileged
                         function  is  restricted  for  use by the tape
                         label processor.


                                   22-397
   TAPOP. [CALLI 154]


        ____   ______    ________        Code   Symbol    Function

                                        ac        1000   .TFTRY    Returns in the ac the number of retries on the
                         last error.

                                    ac        1001   .TFDEN    Returns in ac the density code for  the  tape.
                         To  set  the  density code, use .TFDEN+.TFSET;
                         the monitor reads the new  density  code  from
                         addr+2                         addr+2.  Note that in order to set the density
                         with this function code, IO.DEN must be  zero.
                         The density codes and their meanings are:

                         ____    ______  _______                         Code    Symbol  Density

                          0      .TFD00  Unit default.
                          1      .TFD20  200 bits/inch (8.1 rows/mm).
                          2      .TFD55  556 bits/inch (22.5 rows/mm).
                          3      .TFD80  800 bits/inch (32.2 rows/mm).
                          4      .TFD16  1600 bits/inch (65.3 rows/mm).
                          5      .TFD62  6250     bits/inch      (255.5
                                         rows/mm).
                          6-17           Reserved for use by DIGITAL.

                                        ac        1002   .TFKTP    Returns in the ac the controller type code for
                         the  tape.   To  set the controller type code,
                         use .TFKTP+.TFSET; the monitor reads  the  new
                                                          addr+2                         controller   type   code   from  addr+2.   The
                         controller type codes and their meanings are:

                         ____   ______    __________ ____                         Code   Symbol    Controller Type

                           0    .TFKTA    TM10A (TU10/20/30/40/41).
                           1    .TFKTB    TM10B (TU10/20/30/40/41).
                           2    .TFKTC    TM10C (TU43).
                           3    .TFKTX    TX01/TX02       on       DX10
                                          (TU70,71,72).
                           4    .TFKTM    TM02/TM03    on     RH10/RH20
                                          (TU16,TU45).
                           5    .TFKRH    TM02/TM03 on RH11 (TU45).
                           6    .TFKD2    TX02 on DX20 (TU70,71,72).
|                          7    .TFK78    TU78 on TM78.

                                           ac        1003   .TFRDB    Returns  in  the  ac  the  read-backwards  bit
                         (TM02/TX01/TX02  only).   The bit is on if the
                         tape is set for  read-backwards,  or  off  for
                         normal  read.   See  Chapter  14.   To set the
                         read-backwards  bit,  use  .TFRDB+.TFSET;  the
                                                    addr+2                         monitor reads the bit from addr+2.

                                        ac        1004   .TFLTH    Returns in the ac the bit for read next record
                         at low threshold (TM10A/B/C only).  The bit is
                         on if the tape is set for  low  threshold,  or
                         off   if   not.    To   set   the   bit,   use
                         .TFLTH+.TFSET; The monitor reads the bit  from
                         addr+2                         addr+2.

                                         ac        1005   .TFPAR    Returns in the  ac  the  status  of  the  even
                         parity  bit  (for 7-track tapes only).  To set
                         the  status  of  the  even  parity  bit,   use
                         .TFPAR+.TFSET;  the  monitor  reads the status
                              addr+2                         from addr+2.





                                   22-398
                                                       TAPOP. [CALLI 154]


        ____   ______    ________        Code   Symbol    Function

                                        ac        1006   .TFBSZ    Returns in the ac the block size for the tape.
                         The  returned  value  is  one greater than the
                         number of data words per record.  To  set  the
                         block  size,  use  .TFBSZ+.TFSET;  the monitor
                                                   addr+2                         reads the block size from addr+2.

                                        ac        1007   .TFMOD    Returns in the ac the data mode code  for  the
                         tape.    To   set  the  data  mode  code,  use
                         .TFMOD+.TFSET; the monitor reads the data mode
                                     addr+2                         code  from  addr+2.   The  data mode codes and
                         their meanings are:

                         ____   ______    ____ ____                         Code   Symbol    Data Mode

                           0    .TFMDD    DIGITAL-compatible core  dump
                                          mode  for 7-track and 9-track
                                          tapes.  The monitor uses  the
                                          default  mode,  either code 1
                                          (.TFMID) or code 5 (.TFM7T).
                           1    .TFMID    DIGITAL-compatible core  dump
                                          mode  for 9-track tapes.  The
                                          monitor  reads   and   writes
                                          36-bit  words  in  5  frames.
                                          This mode  is  also  settable
                                          with MTDEC.  monitor call.
                           2    .TFM8B    Industry-compatible     8-bit
                                          mode,  with 4 bytes per word.
                                          This mode  is  also  settable
                                          with the .MTIND monitor call,
                                          except   that   the   default
                                          density for this mode is 1600
                                          BPI.
                           3    .TFM6B    6-bit mode, 6 bytes per  word
                                          (9-track, TU70 only).
                           4    .TFM7B    ANSI/ASCII  7-bit   mode,   5
                                          bytes per word (TU70 only).
                           5    .TFM7T    DIGITAL-compatible    7-track
                                          core dump mode (SIXBIT).

                                        ac        1010   .TFTRK    Returns in the ac the track status bit for the
                         tape  (0  for 9-track, 1 for 7-track).  To set
                         the track status bit, use  .TFTRK+.TFSET;  the
                                                    addr+2                         monitor reads the bit from addr+2.

                                        ac        1011   .TFWLK    Returns in the ac the write-lock bit  for  the
                         tape (1 if write-locked, 0 if not).

                                        ac        1012   .TFCNT    Returns in the ac the character count  of  the
                         last record (the actual record length).

                                              ac        1013   .TFRID    Returns   in   the   ac   the   SIXBIT    reel
                         identification  for the tape.  To set the reel
                         identification, use .TFRID+.TFSET; the monitor
                         reads  the  SIXBIT  reel  identification  from
                         addr+2                         addr+2.

                                        ac        1014   .TFCRC    Returns in the ac the last  cyclic  redundancy
                         character (9-track NZRI only).






                                   22-399
   TAPOP. [CALLI 154]


        ____   ______    ________        Code   Symbol    Function

                                        ac        1015   .TFSTS    Returns in the ac the unit  status  flags  for
                         the    tape.     To   set   the   flags,   use
                         .TFSTS+.TFSET; the  monitor  reads  the  flags
                               addr+2                         from  addr+2.  The unit status flags and their
                         meanings are:

                         ___    ______    _______                         Bit    Symbol    Meaning

                          18    TF.UNS    Unit is not schedulable.
                          19    TF.BOT    Beginning-of-tape mark.
                          20    TF.WLK    Write-lock.
                          21    TF.REW    Unit is rewinding.
                         22-32            Reserved.
                          33    TF.STA    Unit is started.
                          34    TF.SEL    Unit is selected.
                          35    TF.OFL    Unit is off-line.

        1016   .TFSTA    Returns unit statistics for the  tape  device.
                         Your  program  supplies  the function code and
                                   addr     addr+1                         device at addr and addr+1.  (These values  are
                         identical  to  those  returned  for the MTCHR.
                         monitor call.) The monitor returns the  device
                                       addr                         statistics at addr in the format:

                         ______ ______   ________                         Offset Symbol   Contents

                            0   .TSFUN   Function code (user-supplied).
                            1   .TSDEV   Device (user-supplied).
                            2   .TSRID   SIXBIT reel identifier.
                            3   .TSFIL   Number of files read since the
                                         beginning of the tape.
                            4   .TSREC   Number of records  since  last
                                         tape unload.
                            5   .TSCRD   Number  of   characters   read
                                         since last tape unload.
                            6   .TSCWR   Number of  characters  written
                                         since last tape unload.
                            7   .TSSRE   Soft read  errors  since  last
                                         tape unload.
                           10   .TSHRE   Hard read  errors  since  last
                                         tape unload.
                           11   .TSSWE   Soft write errors  since  last
                                         tape unload.
                           12   .TSHWE   Hard write errors  since  last
                                         tape unload.
                           13   .TSTME   Total number of  errors  since
                                         last tape unload.
                           14   .TSTDE   Total  device   errors   since
                                         system startup.
                           15   .TSTUN   Total   unloads   since   last
                                         system reload.
                           16   .TSRTY   Number of retries  to  resolve
                                         last error.
                           17   .TSCCR   Character count of last record
                                         read or written.
                           20   .TSPBE   Position  before  last  error:
                                         file  number  (in  left half);
                                         record number (in right half).
                           21   .TSFES   Final error  state.   See  the
                                         _______________ _____ ______                                         TOPS-10/TOPS-20 SPEAR Manual.




                                   22-400
                                                       TAPOP. [CALLI 154]


        ____   ______    ________        Code   Symbol    Function

                                        ac        1017   .TFIEP    Returns in the ac the initial error pointer.

                                        ac        1020   .TFFEP    Returns in the ac the final error pointer.


                                    NOTE

                  Function codes 1021 and 1022 return  the
                  blocks  pointed  to  by  1017  and 1020.
                  These blocks are  for  communication  of
                  errors  to DAEMON and may change without
                  notice.


                                        ac        1021   .TFIER    Returns in the ac the initial error status.

                                        ac        1022   .TFFER    Returns in the ac the final error status.

                                        ac        1023   .TFFED    Returns in the ac the final error disposition.

                                         ac        1024   .TFLBL    Returns in the  ac  the  label  processing  type
                         code.   To  set  the label processing type code,
                         use .TFLBL+.TFSET; the  monitor  reads  the  new
                                     addr+2                         code  from  addr+2.   The  label processing type
                         codes and their meanings are:

                         ____   ______    _____ __________ ____                         Code   Symbol    Label Processing Type

                           0    .TFLBP    Bypass  label  processing.   To
                                          set this value, the job must be
                                          privileged.
                           1    .TFLAL    ANSI labels.
                           2    .TFLAU    ANSI labels with user labels.
                           3    .TFLIL    IBM labels.
                           4    .TFLIU    IBM labels with user labels.
                           5    .TFLTM    Leading tape mark.
                           6    .TFLNS    Nonstandard labels.
                           7    .TFLNL    No  labels.   When  tapes   are
                                          processed  with  no labels, the
                                          label processor is used only to
                                          verify  that  the tape does not
                                          contain    a    tape     label.
                                          Unlabeled  tapes  can be copied
                                          to create a labeled tape.
                          10    .TFCBA    DIGITAL COBOL ASCII labels.
                          11    .TFCBS    DIGITAL COBOL SIXBIT labels.
                          12    .TFLNV    Same as .TFLNL except that user
                                          program   is   responsible  for
                                          dealing with an EOT.  This type
                                          is   the  default.   To  switch
                                          reels  after  end-of-tape,  use
                                          TAPOP.  function .TFFEV.

        1025   .TFPLT    Performs  functions  identical  to  the   .TFLBL
                         function  1024  above,  except  that  it  allows
                         access to files and  tape  labels.   Using  this
                         function,   you   can  examine  and  modify  the
                         contents  of  a  label.   The  .TFPLT   function
                         requires the JP.POK, [1,2], or JACCT privilege.





                                   22-401
   TAPOP. [CALLI 154]


        ____   ______    ________        Code   Symbol    Function

        1026   .TFLTC    Returns the last  tape  label  termination  code
                         from   the   tape   label   processor.    It  is
                         recommended that you use DEVOP. function .DFRES,
                         because more information can be returned by that
                         function.  The return codes are:

                         ____    ______  _____                         Code    Symbol  Error

                           1     .TFTCP  Continue processing.
                           2     .TFTRE  Returned EOF.
                           3     .TFTLT  Label type error.
                           4     .TFTHL  Header label error.
                           5     .TFTTL  Trailer label error.
                           6     .TFTVL  Volume label error.
                           7     .TFTDV  Device error.
                           10    .TFTDE  Data error.
                           11    .TFTWL  Write lock error.
                           12    .TFPSE  Positioning error.
                           13    .TFBOT  Beginning of tape.
                           14    .TFIOP  Illegal operation.
                           15    .TFFNF  File not found.
                           16    .TFCAN  Operator cancelled request.
                           17    .TFTMV  Too many volumes requested.

                                        ac        1027   .TFDMS    Returns in the ac the diagnostic  mode  set  bit
                         (TX01/TX02  on  DX10  only).   This bit is 1 for
                         diagnostic mode, otherwise 0.  To set this  bit,
                         use .TFDMS+.TFSET; the monitor reads the new bit
                              addr+2                         from addr+2.

                                        ac        1030   .TFFSO    Returns in the ac  the  bit  showing  whether  a
                         forced  SENSE  command  will  be  issued  to the
                         controller (TX01/TX02 on DX10/DX20  only)  after
                         the  completion  of every operation.  To set the
                         bit, use .TFFSO+.TFSET; the  monitor  reads  the
                                       addr+2                         new  bit from addr+2.  This bit should be set by
                         diagnostic programs only, because it slows  down
                         tape operations considerably.

                                        ac        1031   .TFMFC    Returns in the ac the maximum frame  count.   To
                         set  the  count,  use .TFMFC+.TFSET; the monitor
                                                      addr+2                         reads the  new  count  from  addr+2.   Use  this
                         function to speed tape throughput for a TU16, or
                         TU45, TU70, TU71, or TU72 that does not have  an
                         integral  number  of  bytes per word.  The count
                         stays in effect until your  program  performs  a
                         RESET  with another TAPOP. monitor call or until
                         the  tape  is  RELEASed  (if  the   device   was
                         ASSIGNed).   This  function  allows  a TU70 or a
                         TU16 to read and write tapes that do not have an
                         integral   number   of  bytes  per  word.   This
                         function provides tape compatibility with  other
                         systems.











                                   22-402
                                                       TAPOP. [CALLI 154]


        ____   ______    ________        Code   Symbol    Function

                                        ac        1032   .TFPDN    Returns in the ac  flags  showing  the  possible
                         densities  for  a  tape.   The  flags  and their
                         meanings are:

                         ___    ______    _______                         Bit    Symbol    Density

                          31    TF.DN5    6250 bits/inch (255.5 rows/mm)
                          32    TF.DN4    1600 bits/inch (65.3 rows/mm).
                          33    TF.DN3    800 bits/inch (32.2 rows/mm).
                          34    TF.DN2    550 bits/inch (22.5 rows/mm).
                          35    TF.DN1    200 bits/inch (8.1 rows/mm).

                                    addr+2        1033   .TFLPR    Returns at addr+2  the  tape  label  parameters.
                         This  function  causes  the  first  input  label
                         processing if there is no file open  for  input.
                         To  set  the  parameters, use .TFLPR+.TFSET; the
                         monitor  reads  the  parameters   beginning   at
                         addr+2                         addr+2.   This  set  function  is  legal only if
                         there is no file open for output  on  the  given
                         channel.  The parameters given apply to the next
                         file  to  be  written.   The   format   of   the
                                       addr                         parameters at addr is:

                         ______ ______    ________                         Offset Symbol    Contents

                            0   .TPFUN    Function code (user-supplied).
                            1   .TPDEV    Device (user-supplied).
                            2   .TPREC    Record format and form control:

                                          ____  ______    _______                                          Bits  Symbol    Meaning

                                          0-17  TR.FCT    Forms  control
                                                          byte;  one   of
                                                          the   following
                                                          codes:

                                          ____  ______    _______                                          Code  Symbol    Meaning

                                           1    .TFCNO    Records on tape
                                                          do  not contain
                                                          form    control
                                                          characters.
                                           2    .TFCAS    First character
                                                          of  each record
                                                          is    a    form
                                                          control
                                                          character.
                                           3    .TFCAM    Records on tape
                                                          contain     all
                                                          required   form
                                                          control
                                                          characters.

                                          ____  ______    _______                                          Bits  Symbol    Meaning

                                          18-35 TR.RFM    Record format
                                                          byte;  one   of
                                                          the   following
                                                          codes:





                                   22-403
   TAPOP. [CALLI 154]


                                          ____  ______    _______                                          Code  Symbol    Meaning

                                            0   .TRFDF    Default
                                                          (Fixed).
                                            1   .TRFFX    Fixed (F).
                                            2   .TRFVR    Variable (D).
                                            3   .TRFSP    Spanned (S).
                                            4   .TRFUN    Undefined (U).

                         ______ ______    ________                         Offset Symbol    Contents

                            3   .TPRSZ    Record size in characters.
                            4   .TPBSZ    Block size in characters.
                            5   .TPEXP    Expiration   date   in   15-bit
                                          format.

                                          ____  ______    _______                                          Bits  Symbol    Meaning

                                          18-35 TP.EEX    Expiration
                                                          date.
                                           0-17 TP.ECR    Creation date.

                            6   .TPPRO    Protection code.
                            7   .TPSEQ    File sequence number.
                            10  .TPFNM    File name (17 ASCII  characters
                                          maximum).
                            14  .TPGEN    Generation and version numbers.

                                          ____   ______   _______                                          Bits   Symbol   Meaning

                                           0-17  TP.GEN   Generation
                                                          number.
                                          18-35  TP.VER   Generation
                                                          version number.

                            Function  code  2033  (to  set   tape   label
                            parameters) is legal only if there is no file
                            currently open for output  on  the  specified
                            channel.   The numbers you specify must apply
                            to the next file to be written.

                            Function code 1033 (to read label parameters)
                            always  returns  these numbers and causes the
                            first input label processing if there  is  no
                            file open for input.


   Normal Return

        The function is performed.
















                                   22-404
                                                       TAPOP. [CALLI 154]


   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

         -1    TPACS%    Address check while storing answer.
          0    TPIFC%    Illegal function code.
          1    TPPRV%    Not enough privileges.
          2    TPNMT%    Not a magtape device.
          3    TPVOR%    Specified value out of range.
          4    TPACR%    Address check reading arguments.
          5    TPCBS%    Parameter cannot be set.
          6    TPNIA%    Tape not initialized or assigned.
          7    TPNLP%    No label processor.
         10    TPETC%    Termination code error.
         11    TPIJN%    Illegal job number.
         12    TPLRF%    Label release function required.
         13    TPLSI%    Set label parameter function illegal after first
                         output.
         14    TPLOE%    Attempted to read information from a  label  DDB
                         owned by someone else.
         15    TPDNC%    Drive not capable of specified density.
         16    TPWWL%    Write attempted to write-locked tape.

   Examples

                MOVE    T1,[XWD 2,ARGLST]  ;Pointer to arg list
                TAPOP.  T1,                ;Get controller type
                 JRST   ERROR              ;Error
                CAIE    T1,.TFKTX          ;If DX10
                CAIN    T1,.TFKD2          ;Or DX20
                SKIPA                      ;Data security erase
                                           ;  will work
                JRST    NODSE              ;Otherwise don't try it
                MOVE    T1,[XWD 2,DSELSI]  ;Pointer to arg list
                TAPOP.  T1,                ;Erase the entire tape
                 JRST   ERROR              ;Error
                JRST    CONTIN             ;Skip argument blocks
        ARGLST: EXP     .TFKTP             ;Function to read
                                           ;  controller types
                SIXBIT  /TAPE/             ;Device is "TAPE"
        DSELST: EXP     .TFDSE             ;Function to do
                                           ;  data security erase
                SIXBIT  /TAPE/             ;Device is "TAPE"
        CONTIN:                            ;Continue

        This example performs a data security erase on the logical device
        "TAPE"  if  and  only  if  the controller is capable of doing so.
        (DX10/DX20).

   Related Calls

        MTAID., MTAPE, MTCHR.












                                   22-405
   TIMER [CALLI 22]


                              TIMER [CALLI 22]                              TIMER [CALLI 22]



   Function

        Returns the time of day since midnight (00:00)  in  jiffies.   (A
        jiffy is 1/60 second.)


                                      NOTE

                For systems using  50  Hz  power,  jiffy  =  1/50
                second.    Therefore   it   is  good  programming
                practice to use the MSTIME monitor  call  on  any
                system, because MTSIME call gives the time of day
                in milliseconds and is independent of the type of
                power used.



   Calling Sequence

                TIMER   ac,
                only return

   Return

                                                                ac        The number of jiffies since midnight is returned in the ac.

   Related Calls

        DATE, MSTIME

































                                   22-406
                                                        TMPCOR [CALLI 44]


                             TMPCOR [CALLI 44]                             TMPCOR [CALLI 44]



   Function

        Creates, reads, writes, or manipulates temporary  files  left  in
        core from the running of one program to another.  Those files are
        referenced by a three-character file name.  All files are deleted
        when  the  job  is  logged  out.  If the monitor call fails, your
        program should write DSK:nnnNAM.TMP, where nnn is the job number.
        This  arrangement improves response time and minimizes the number
        of disk reads.

   Calling Sequence

                MOVE    ac,[XWD fcncode,addr]
                TMPCOR  ac,
                  error return
                normal return
                . . .
        addr:   XWD     'nam',0
                IOWD    buflength,buffer

                fcncode        where:  fcncode is one of the function codes described below.

                addr                addr gives the address of the argument list.

                nam                nam is a 3-character SIXBIT string that is the file name.

                buflength                buflength is the length of the buffer for the call.

                buffer                buffer gives the address of the buffer for the call.

        The function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

          0    .TCRFS    Obtains free space.  For this function, set  the
                         ac                         ac  to  0  before  the call; no argument list is
                                                             ac                         required.  On a normal return, the  ac  contains
                         the  number  of  free  words  available  to your
                         program (510 decimal).

          1    .TCRRF    Reads  a  file.   The  length  of  the  file  is
                                           ac                         returned  in  the ac, and as much of the file as
                         possible is copied into the buffer for the call.
                                                                       ac                         You can check for truncation by comparing the ac
                            buflength                         to buflength.

                         The error return occurs if the specified file is
                         not  found;  in  this  case,  the number of free
                         words available to your program is  returned  in
                             ac                         the ac.

          2    .TCRDF    Reads and deletes a file.  Performs all the same
                         functions  as .TCRRF and in addition deletes the
                         file.  Note that the file is deleted even if  it
                         is too long to fit in the buffer for the call.







                                   22-407
   TMPCOR [CALLI 44]


        ____   ______    ________        Code   Symbol    Function

          3    .TCRWF    Writes the contents of the buffer into  a  file.
                         The requested length of the file is the value of
                         buflength                         buflength.  If there is already a  file  of  the
                         specified  name,  it is deleted and the space is
                         reclaimed.

                         The requested size of the file is  specified  by
                         buflength                         buflength.   If  there  is  not  enough space to
                         write the entire file, nothing is  written,  the
                         ac                         ac  is  set to the number of free words of space
                         available to the user, and the error  return  is
                         taken.

                         If there is enough space, the file  is  written.
                              ac                         The  ac is set to the amount of space left after
                         the file has been written and the normal  return
                         is taken.

                         If insufficient space is available, none of  the
                         file  is  written,  the error return occurs, and
                         the number  of  free  words  available  to  your
                                                    ac                         program is returned in the ac.

          4    .TCRRD    Reads a directory.  The number of .TMP files  in
                                                            ac                         your  directory is returned in the ac, and their
                         file names are written into the buffer  for  the
                         call.   You  can  check  for  truncation  of the
                                                               buflength                         directory list by comparing the ac to buflength.

                         Each entry in the buffer is of the form:

                              XWD  'nam',length

                                 length                         where:  length is the  length  of  the  file  in
                                 words.

                                 nam                                 nam is the file name.

                         The error return occurs only if the call is  not
                         implemented.

          5    .TCRDD    Reads and deletes from directory.  This performs
                         all the same functions as .TCRRD and in addition
                         deletes all files from your directory.

   Examples

                MOVE    T1,[XWD .TCRWF,ARGLST]
                TMPCOR  T1,
                  JRST  TMCERR
                JRST    CONTIN
        ARGLST: XWD     'XYZ',0
                IOWD    <BUFEND-BUFFER>,BUFFER
        BUFFER: ASCIZ /THIS IS THE TEXT FOR THE FILE./
        BUFEND:
        CONTIN:

        This example writes the text at BUFFER into the file XYZ if space
        is available.





                                   22-408
                                                       TRMNO. [CALLI 115]


                             TRMNO. [CALLI 115]                             TRMNO. [CALLI 115]



   Function

        Returns the number of the terminal controlling a specified job.

   Calling Sequence

                MOVEI   ac,jobno  \
                MOVNI   ac,1      /
                TRMNO.  ac,
                  error return
                normal return

                jobno        where:  jobno is the number of a logged-in job (use  -1  for  the
                current job).

   Normal Return

                                                                ac        Returns the UDX for the controlling  terminal  in  the  ac.   The
        format  of  Universal Device Index names is .UXxxx.  The range of
        values is 200000  through  200777  (octal).   The  symbol  .UXTRM
        (200000) is the offset for the terminal indexes.

   Error Return

                                ac        Zero is returned in the ac and indicates one of the errors listed
        below:


         o  The  job  is  currently  detached  (that  is,  there  is   no
            controlling terminal).

         o  The job number specified is unassigned.

         o  The job number specified is illegal.

         o  The job number specified is a negative number other than -1.


   Examples

        Your program can determine which of the  above  error  conditions
        occurred  by  using  the  JOBSTS  monitor  call.  An example of a
        program using this call for this purpose is shown below.

                MOVE    T1,JOBN
                TRMNO.  T1,
                  JRST  .+2
                JRST    OK            ;No error
                MOVNI   T1,JOBN
                PJOB    T1,
                MOVNS   T1,
                JOBSTS  T1,
                  JRST  ILLNUM        ;Job number illegal
                JUMPL   T1,DETJOB     ;Job is detached
                JRST    NOJOB         ;No such job







                                   22-409
   TRMNO. [CALLI 115]


   Related Calls

        TRMOP.

   Common Errors

        Using .UXTRM as a mask instead of an offset.



























































                                   22-410
                                                       TRMOP. [CALLI 116]


                             TRMOP. [CALLI 116]                             TRMOP. [CALLI 116]



   Function

        Performs   various    operations    for    terminals.     Several
        TRMOP. functions  are  identical  to,  or  extensions  of, TTCALL
        monitor calls.

   Calling Sequence

                MOVE    ac,[XWD len,addr]
                TRMOP.  ac,
                  error return
                normal return
                . . .
        addr:   EXP     fcncode
                EXP     udx
                first argument
                . . .
                last argument

                len        where:  len is the length of the argument list.

                addr                addr is the address of the argument list.

                fcncode                fcncode is one of the function codes described below.

                udx                udx is the Universal Device Index for a terminal,  or  -1
                can   be  used  to  indicate  the  program's  controlling
                                                     last  argument                terminal.   The  words  up  through  last  argument   are
                arguments for the given function.

        The argument list is formatted as follows:

        ____   ______    ________        Word   Symbol    Contents

          0    .TOFNC    Function code.

          1    .TOUDX    Universal Device Index or -1.

          2    .TOAR2    Argument word.

          3    .TOAR3    Argument word.

          4    .TOAR4    Argument word.

          5    .TOAR5    Argument word.

          6    .TOAR6    Argument word.

        The argument words contain values that are read  or  set  by  the
        function  code,  and they differ for each function.  The function
        codes fall into four groups:

        _____   ______   _______        Codes   Symbol   Actions

        0-777            Perform a specific action.

        1000-1777         Read parameters.

        1000    .TOSET   Add this  value  (symbol  .TOSET)  to  the  read
                         function,    thus    setting    the    specified
                         parameter(s).

                                   22-411
   TRMOP. [CALLI 116]


        _____   ______   _______        Codes   Symbol   Actions

        2000 - 2777      Set  parameters.   These   functions   are   not
                         explicitly listed in the descriptions below.  To
                         set a  parameter,  use  the  corresponding  Read
                         function  plus  the  offset .TOSET (=1000).  For
                         example, to set a terminal's receive speed,  use
                         the receive speed function plus .TOSET:

                              .TORSP + .TOSET

        3000 - 3777      Reserved for customer-defined functions.

        The function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

           1   .TOSIP    Takes  the  error  (non-skip)  return   if   the
                                                                    ac                         terminal's  input  buffer  is  empty.  The ac is
                         unchanged.

           2   .TOSOP    Takes  the  error  (non-skip)  return   if   the
                                                                    ac                         terminal's  output  buffer  is empty.  The ac is
                         unchanged.

           3   .TOCIB    Clears the terminal's input buffer.

           4   .TOCOB    Clears the terminal's output buffer.

           5   .TOOUC    Outputs  a  character  to  the   terminal;   the
                         character is in bits 29 to 35 of .TOAR2.

           6   .TOOIC    Outputs an image-mode character to the terminal;
                         the character is in bits 28 to 35 of .TOAR2.

           7   .TOOUS    Outputs an ASCIZ string  to  the  terminal;  the
                         address  of the string is in .TOAR2.  If the job
                         number at the receiving  terminal  is  different
                         from  your  job  number, the character string is
                         limited to 128 characters.  If  you  attempt  to
                         send  more  than  128  characters to a job other
                         than your own, characters may be lost.

          10   .TOINC    Inputs a character from  the  terminal  in  line
                         mode;  the  character is stored in bits 29 to 35
                                ac                         of the ac.

          11   .TOIIC    Inputs  an   image-mode   character   from   the
                         terminal;  the character is stored in bits 28 to
                                   ac|                        35 of the ac.  This function is not  implemented
|                        by the monitor.

          12   .TODSE    Enables a modem (dataset) for outgoing calls.

          13   .TODSC    Enables and places outgoing  calls  on  a  modem
                         with  a  dialer.  A telephone number of up to 17
                         decimal digits  is  stored  in  4-bit  bytes  in
                         .TOAR2  and .TOAR3 (terminated by a 17).  If the
                         caller must wait for a  second  dial  tone  (for
                         example,  after  dialing  9), a 5-second wait is
                         indicated by a 16 byte.





                                   22-412
                                                       TRMOP. [CALLI 116]


        ____    ______   ________        Code    Symbol   Function

          14    .TODSF   Disconnects a call  (for  example,  hangs  up  a
                         modem).

          15    .TORSC   Rescans an input line.

          16    .TOELE   Sets the terminal element to the  number  stored
                         in .TOAR2.

          17    .TOEAB   Enables autobaud detection.

                                                                      ac          20    .TOISC   Inputs a character from the terminal to the  ac;
                         waiting   in  character  mode  if  no  input  is
                         available.

          21    .TOTYP   Puts an ASCIZ string into the  terminal's  input
                         buffer;  the address of the string is in .TOAR2.
|                        A string of more than 300 characters results  in
|                        a range error.

                                                                  addr          22    .TOGMS   Returns terminal's MIC status  bits  in  addr+2.
                                                                   addr                         If  MIC  is  not  controlling  the  job,  addr+2
                         contains 0.  The status bits are as follows:

                         ____   ______    _______                         Bits   Symbol    Meaning

                            0   TO.CHK    Flag bit for word.  If this bit
                                          is  set,  there  are  other set
                                          bits in the word.
                            1   TO.CCT    A CTRL/C was typed.
                            2   TO.OCS    An operator-sent character  was
                                          received.
                            3   TO.ECS    An    error    character    was
                                          received.
                            4   TO.CPT    A CTRL/P was typed.
                            5   TO.CBT    A CTRL/B was typed.
                            6   TO.STL    Silence this line.
                            7   TO.LMM    Line is in monitor mode.
                            8   TO.LUM    Line is in user mode.
                            9   TO.C1O    Line is in column 1 on output.
                           10   TO.CAT    A CTRL/A was typed.
                           11   TO.RSP    Error response.
                           12   TO.RSY    Response code sync.
                           13   TO.LOG    MIC is logging.
                           14             Reserved.
                        15-21   TO.AOC    The received operator character
                                          (ASCII).
                        22-28   TO.AEC    The  received  error  character
                                          (ASCII).
                        29-35   TO.MMJ    MIC master job number.

            23 .TOSMS    Sets the  terminal's  MIC  status  bits  to  the
                         contents  of  .TOAR2.   The bits are the same as
                         those returned by the .TOGMS function above.

            24 .TOCLR    Clears the MIC status bits.

            25 .TODSP    Displays an ASCIZ string on the  terminal.   The
                         address of the string is in .TOAR2.

            26 .TOGMR    Returns the MIC response buffer.  The address of
                         the 21-word buffer is in .TOAR2.



                                   22-413
   TRMOP. [CALLI 116]


          ____  ______   ________          Code  Symbol   Function

            27  .TOLOG   Returns the MIC log buffer.  The address of  the
                         21-word buffer is in .TOAR2.

                                                            ac            30  .TODSS   A modem is present if bit 0 of the ac is set  on
                         return;  bits 1 to 35 are reserved.  If the line
                         is not a dataset line,  the  monitor  takes  the
                                                                      ac                         error return and returns the TOIMP% error in ac.

            31  .TOSBS   Sets the terminal break  character  set.   Using
                         this  function,  you  can  define the characters
                         that,  when  typed  on  the  terminal,  will  be
                         interpreted  by the monitor as break characters,
                         indicating the end of the input  line.   In  the
                         argument block, you must specify the following:

                         addr:   .TOSBS          ;function code
                                 udx             ;terminal's UDX
                                 field-width     ;auto-break
                                 break mask      ;first word 
                                 . . .           ; of break table
                                 break mask      ;last word

                         Where the  field-width  defines  the  number  of
                         characters  to  be  accepted  on  an input line.
                         After the specified  number  of  characters  are
                         typed, a break is automatically made.  The field
                         width must be between 1 and 255.

                         The break mask is a 4-word block indicating  the
                         mask  of  bits (in the left-hand 32 bits of each
                         word from .TOAR3 through .TOAR6)  that  indicate
                         the  octal  representation  of  characters to be
                         defined as break characters.   You  must  enable
                         break set mode by setting flag IO.ABS in the I/O
                         status  word.   Refer  to  Volume  1  for   more
                         information.

          32   .TORBS    Reads the terminal  break  character  set.   The
                         field   width  is  returned  in  .TOAR2  of  the
                         argument block, and the break mask  is  returned
                         in   words  .TOAR3  through  .TOAR6.   Refer  to
                         .TOSBS.

          33   .TOISO    Sets counted image  output  string  mode.   This
                         function   allows   your  program  to  output  a
                         specified  number  of  characters  in  a  single
                         sequence.   This  function allows screen editors
                         and  display-oriented  programs  to  update  the
                         terminal  screen more efficiently.  The argument
                         block for this function is:

                         addr:   .TOISO          ;function
                                 udx             ;terminal's UDX
                                 byte-size,,byte-count
                                 string-address

                         Where the size of each byte (7  or  8  bits)  is
                         specified  in  byte-size,  and the length of the
                         string is specified in byte-count.   The  string
                         address  is  a  pointer  to  the location of the
                         output string.



                                   22-414
                                                       TRMOP. [CALLI 116]


        _____   ______   _______        Codes   Symbol   Actions

|         34   .TOFLM    Returns the carriage to the left margin.
|  
|         35   .TOGCS    Reads  the  special   character   status.    The
|                        conditions   read   are   set   in   the  TC.VAL
|                        field.  .TOSCS explains  TC.VAL.   The  argument
|                        block for .TOGCS is:
|  
|                        addr:  .TOGCS
|                               udx
|                               len2,,addr2
|                        addr2: character to read
|  
|                        The number of words given in len at  addr2  have
|                        the  TC.VAL  field  filled  in  from the current
|                        settings described in .TOSCS.
|  
|       36      .TOSCS   Sets the special character status.   The  .TOSCS
|                        argument block is:
|  
|                        addr:  .TOSCS
|                               udx
|                               len2,,addr2
|  
|                        addr2: mask + values + character
|  
|                        The fields in addr2 are:
|  
                         ____    ______   _______|                        Bits    Symbol   Meaning
|  
|                        0-13    TC.MOD   The  mask  of  the  fields   to
|                                         change.
|                        14-27   TC.VAL   The  conditions  read  or  set.
|                                         See   below   for   a  list  of
|                                         condition bits.
|                        28-35   TC.CHR   The   character    which    the
|                                         condition(s) applies to.
|  
|                        Bits which may be  selected  for  the  character
|                        are:
|  
                         ___     ______   _______|                        Bit     Symbol   Meaning
|  
|                        31      TC.CLR   For  control  characters  only,
|                                         clears  the  input  buffer when
|                                         the  character's  interrupt  is
|                                         posted.
|                        32      TC.DFR   Defer the character's interrupt
|                                         type.
|                        33      TC.OOB   An out-of-band character.  This
|                                         character  causes  an interrupt
|                                         when received.
|                        34      TC.NSA   Disable special action.
|                        35      TC.BRK   Line break character.
|  
|       37      .TOUNR   Allows   reading   of   only   already    echoed
|                        characters.   No further echoing occurs until an
|                        empty buffer is returned, a no  input  available
|                        return   is   taken,  or  a  null  character  is
|                        returned.  The argument block is:
|  
|                        addr:    .TOUNR
|                                 udx       ;terminal UDX


                                   22-415
   TRMOP. [CALLI 116]


        ____    ______   ________        Code    Symbol   Function
|  
|       40      .TOASO   Sets counted  ASCII  output  string  mode.   The
|                        argument  block is identical to .TOISO, function
|                        33, except for the function code.

                                         ac        1000    .TOOIP   Returns, in the ac, the  output-in-progress  bit
                         (1 in Bit 35 if output is in progress, otherwise
                         ac=0).

                                         ac        1001    .TOCOM   Returns, in the ac, the monitor-mode bit  (1  in
                         bit 35 if terminal is in monitor mode, otherwise
                         ac=0).

                                         ac        1002    .TOXON   Returns, in the ac, the papertape bit (1 in  bit
                         35  if  terminal is in papertape mode, otherwise
                         ac=0).  To set the bit, use  .TOXON+.TOSET;  the
                         monitor  reads  the  bit from .TOAR2.  When this
                         bit is set, the functions of CTRL/S  and  CTRL/Q
                         are defined to control the papertape.  If CTRL/S
                         and CTRL/Q were defined previously for  stopping
                         and  continuing terminal output, these functions
                         are  temporarily  superseded  by  the  papertape
                         function.   When  you clear .TOXON, the terminal
                         output function is restored.

                                         ac        1003    .TOLCT   Returns, in the ac, the lowercase bit (1 in  bit
                         35  if no lowercase capability, otherwise ac=0).
                         To set the bit, use .TOLCT+.TOSET;  the  monitor
                         reads the bit from .TOAR2.

                                         ac        1004    .TOSLV   Returns, in the ac, the slave bit (1 in  bit  35
                         if  the terminal is slaved, otherwise ac=0).  To
                         set the  bit,  use  .TOSLV+.TOSET;  the  monitor
                         reads the bit from .TOAR2.

                                         ac        1005    .TOTAB   Returns, in the ac, the tab-capability  bit  for
                         the  terminal  (1  in bit 35 if the terminal has
                         tab capability, otherwise  ac=0).   To  set  the
                         bit,  use  .TOTAB+.TOSET;  the monitor reads the
                         bit from .TOAR2.

                                         ac        1006    .TOFRM   Returns, in the ac, the formfeed-capability  bit
                         for  the  terminal  (1 in bit 35 if the terminal
                         performs formfeeds, otherwise ac=0).  To set the
                         bit,  use  .TOFRM+.TOSET;  the monitor reads the
                         bit from .TOAR2.

                                         ac        1007    .TOLCP   Returns, in the ac, the local-copy bit  for  the
                         terminal  (1  in  bit  35  if characters are not
                         echoed, otherwise ac=0).  To set  the  bit,  use
                         .TOLCP+.TOSET;  the  monitor  reads the bit from
                         .TOAR2.

                                         ac        1010    .TONFC   Returns, in the ac, the free CRLF  bit  for  the
                         terminal  (1  in  bit  35  if free CRLFs are not
                         performed, otherwise ac=0).  To set the bit, use
                         .TONFC+.TOSET;  the  monitor  reads the bit from
                         .TOAR2.          The          free          CRLF
                         (carriage-return/line-feed)  is  placed  in  the
                         terminal output buffer when the maximum width of
                         the  line  is  reached.   Set  the terminal line
                         width  using  .TOWID,  SET  TTY  WIDTH   monitor
                         command,  or  by setting the terminal type.  The
                         free CRLF function is enabled by default.

                                   22-416
                                                       TRMOP. [CALLI 116]


        ____    ______   ________        Code    Symbol   Function

                                         ac        1011    .TOHPS   Returns, in the ac, the horizontal  position  of
                         the  carriage or cursor (in the range 0 to octal
                         377).

                                         ac        1012    .TOWID   Returns, in the ac, the carriage width  for  the
                         terminal  (in  the range 16 to 255 decimal).  To
                         set this value, use .TOWID+.TOSET;  the  monitor
                         reads the width from .TOAR2.

                                         ac        1013    .TOSND   Returns, in the ac, the GAG bit for the terminal
                         (1  in bit 35 if NOGAG, otherwise ac=0).  To set
                         this bit, use .TOSND+.TOSET; the  monitor  reads
                         the  bit  from  .TOAR2.   Refer  to  the SET TTY
                         monitor command in the Commands Manual.

                                         ac        1014    .TOHLF   Returns, in the ac, the half-duplex bit for  the
                         terminal  (1  in  bit  35  if the terminal is in
                         half-duplex mode, otherwise ac=0).  To set  this
                         bit,  use  .TOHLF+.TOSET;  the monitor reads the
                         bit from .TOAR2.  Refer to the SET  TTY  monitor
                         command in the Commands Manual.

                                          ac        1015    .TORMT   Returns, in the  ac,  the  remote  bit  for  the
                         terminal (1 in bit 35 if the terminal is remote,
                         otherwise  ac=0).   To   set   this   bit,   use
                         .TORMT+.TOSET;  the  monitor  reads the bit from
                         .TOAR2.  Refer to the SET TTY monitor command in
                         the Commands Manual.

                                         ac        1016    .TODIS   Returns, in the ac,  the  display  bit  for  the
                         terminal  (1  in  bit  35  if  the terminal is a
                         display device, otherwise ac=0).   To  set  this
                         bit,  use  .TODIS+.TOSET;  the monitor reads the
                         bit from  .TOAR2.   You  may  set  this  bit  to
                         indicate that the terminal is a display terminal
                         if any of the following is true:

                          o  The terminal can backspace the cursor.

                          o  A space character on the terminal erases the
                             character pointed to by the cursor.


                         Refer to the SET  TTY  monitor  command  in  the
                         Commands Manual.

                                         ac        1017    .TOFLC   Returns, in the ac, the filler class  code  (the
                         number  of  fillers  used  for  padding) for the
                         terminal (in the range 0  to  3).   To  set  the
                         code,  use  .TOFLC+.TOSET; the monitor reads the
                         code from .TOAR2.  Refer to the SET TTY  monitor
                         command in the Commands Manual.

                                         ac        1020    .TOTAP   Returns, in the ac, the papertape-enable bit for
                         the  terminal  (1  in  bit  35  if  papertape is
                         enabled, otherwise ac=0).  To set this bit,  use
                         .TOTAP+.TOSET;  the  monitor  reads the bit from
                         .TOAR2.  Refer to the SET TTY monitor command in
                         the Commands Manual.





                                   22-417
   TRMOP. [CALLI 116]


        ____    ______   ________        Code    Symbol   Function

                                         ac        1021    .TOPAG   Returns, in the ac, the bit  setting  for  paged
                         display  mode (1 in bit 35 if the terminal is in
                         paged display mode,  otherwise  ac=0).   To  set
                         this  bit,  use .TOPAG+.TOSET; the monitor reads
                         the bit from .TOAR2.

                                         ac        1022    .TOSTP   Returns, in the ac, the output-stopped  bit  for
                         the terminal (1 in bit 35 if output has stopped,
                         otherwise ac=0).  The output-stopped bit is  set
                         when, for example, the terminal reaches its page
                         limit.

                                         ac        1023    .TOPSZ   Returns, in the ac, the number of lines for  the
                         current page setting (in the range 0 to 63).  To
                         set the number of lines, use .TOPSZ+.TOSET;  the
                         monitor reads the number of lines from .TOAR2.

                                           ac        1024    .TOPCT   Returns, in  the  ac,  the  value  of  the  page
                         counter (in the range 0 to 63).

                                         ac        1025    .TOBLK   Returns, in the ac, the bit  setting  for  blank
                         line  handling  (1  in  bit 35 if multiple blank
                         lines are to  be  reduced  to  one  blank  line,
                         otherwise   ac=0).    To   set   the   bit,  use
                         .TOBLK+.TOSET; the monitor reads the bit setting
                         from .TOAR2.

                                         ac        1026    .TOALT   Returns, in the ac, the bit setting  for  ESCape
                         (altmode)  character handling (1 in bit 35 if no
                         conversion, 0 if the ASCII codes 175 and 176 are
                         converted   to   033).   To  set  the  bit,  use
                         .TOALT+.TOSET; the monitor reads the bit setting
                         from .TOAR2.

                                         ac        1027    .TOAPL   Returns, in the ac, the bit setting for APL mode
                         (1  in  bit  35 if in APL mode, otherwise ac=0).
                         To set the bit, use .TOAPL+.TOSET;  the  monitor
                         reads the bit setting from .TOAR2.

                                         ac        1030    .TORSP   Returns, in the ac, the code for the  terminal's
                         receive   speed.    To   set   the   code,   use
                         .TORSP+.TOSET; the monitor reads the  code  from
                         .TOAR2.   (Note that the send and receive speeds
                         cannot both be 0.)  The codes and their meanings
                         are:

                         ____   ______    _____                         Code   Symbol    Speed

                           1    .TO005    50 baud.
                           2    .TO007    75 baud.
                           3    .TO011    110 baud.
                           4    .TO013    134.5 baud.
                           5    .TO015    150 baud.
                           6    .TO020    200 baud.
                           7    .TO030    300 baud.
                          10    .TO060    600 baud.
                          11    .TO120    1200 baud.
                          12    .TO180    1800 baud.
                          13    .TO240    2400 baud.
                          14    .TO480    4800 baud.
                          15    .TO960    9600 baud.
                          16    .TOEXA    External A.
                          17    .TOEXB    External B.

                                   22-418
                                                       TRMOP. [CALLI 116]


        ____    ______   ________        Code    Symbol   Function

                                         ac        1031    .TOTSP   Returns, in the ac, the code for the  terminal's
                         transmit   speed.    To   set   the   code,  use
                         .TORSP+.TOSET; the monitor reads the  code  from
                         .TOAR2.   (Note that the send and receive speeds
                         cannot both be 0.)  The codes and their meanings
                         are  the  same  as those for the .TORSP function
                         above.

                                         ac        1032    .TODBK   Returns, in the ac,  the  bit  setting  for  the
                         terminal's  debreak  capability  (1 in bit 35 if
                         debreak is enabled, otherwise ac=0).  To set the
                         bit,  use  .TODBK+.TOSET;  the monitor reads the
                         bit setting from .TOAR2.  (Meaningful for  model
                         2741 terminals only.)

                                         ac        1033    .TO274   Returns, in the ac, the bit to show whether  the
                         terminal is a 2741 (1 in bit 35 if so, otherwise
                         ac=0).  To set the bit, use  .TO274+.TOSET;  the
                         monitor  reads  the  bit  from .TOAR2.  You must
                         have [1,2] or JACCT privileges to set this  bit,
                         because   the   2741   terminal   is  no  longer
                         supported.

                                         ac        1034    .TOTDY   Returns, in the ac, the terminal's TIDY  setting
                         (1 in bit 35 if TIDY, 0 if NOTIDY).  (Meaningful
                         for model 2741 terminals only.)

        1035    .TOACR   Returns, in the ac, the auto-CRLF column number.
                         If  this  value  is  not  zero,  the first space
                         character received from the terminal, after  the
                         specified    column,    is    converted   to   a
                         carriage-return/line-feed  sequence.    If   the
                         value in the ac is zero, no automatic conversion
                         on input is performed.  To set this  value,  use
                         .TOACR+.TOSET.   Include  the  column  number in
                         .TOAR2 as a decimal value from 0 to 255.

                                          ac        1036    .TORTC   Returns, in the  ac,  the  bit  for  CTRL/R  and
                         CTRL/T   compatibility   (0   in   bit   35   if
                         compatibility is enabled, otherwise  ac=1).   To
                         set  the  bit, use .TORTC; the monitor reads the
                         bit from .TOAR2.

                                         ac        1037    .TOPBS   Returns, in the ac, the word containing the  PIM
                         (packed   image  mode)  break  set  (four  9-bit
                         bytes).  To set this  word,  use  .TOPBS+.TOSET;
                         the  monitor reads the word from .TOAR2.  If the
                         ninth bit of the argument is set, the bytes  are
                         compared  as  7-bit  bytes.  If the ninth bit is
                         clear, the bytes are compared as 8-bit bytes.

                                            ac        1040    .TODEM   Returns,  in  the  ac,  the  bit   showing   the
                         deferred-echo  mode  (1  in  bit  35  if echo is
                         deferred  until  input  is  required,  otherwise
                         ac=0).   To set this bit, use .TODEM+.TOSET; the
                         monitor reads the bit from .TOAR2.

                                         ac        1041    .TOTRM   Returns, in the ac, the  SIXBIT  terminal  type.
                         To    set    the   terminal   type   code,   use
                         .TOTRM+.TOSET; the monitor reads the SIXBIT name
                         of  the  terminal  type  from .TOAR2.  The valid
                         terminal types may be obtained from GETTAB table
                         .GTTNM.

                                   22-419
   TRMOP. [CALLI 116]


        ____    ______   ________        Code    Symbol   Function

                                         ac        1042    .TOBCT   Returns, in the ac, number of commands processed
                         in  the  left  half,  and  the  number  of break
                         characters received in the right half.

                                         ac        1043    .TOICT   Returns, in the ac, number of  input  characters
                         received.

                                         ac        1044    .TOOCT   Returns, in the ac, number of output  characters
                         sent.

                                          ac        1045    .TOOSU   Returns, in the  ac,  output  suppression  state
                         (CTRL/O).

                                         ac        1046    .TOFCS   Returns, in the ac, full character set.

        1047    .TOBKA   "Break on all characters" mode.  If this is off,
                         the  break  occurs  on each line.  If it is set,
                         breaks occur on each character.

        1050             Reserved for use by DIGITAL.

        1051             Reserved for use by DIGITAL.

        1052    .TOTIC   Returns number of characters in input buffer.

        1053             Reserved for use by DIGITAL.

        1054    .TOBKC   Returns number  of  break  characters  in  input
                         buffer.

        1055    .TOECC   Returns   number   of   unprocessed   (unechoed)
                         characters in input buffer.

        1056    .TOTTC   Returns total number of characters in  monitor's
                         input buffer.

        1057    .TOTOC   Returns total number of characters in  monitor's
                         output buffer.

        1060    .TOLNB   Returns length of terminal form/page.

        1061    .TOLNC   Returns number of lines remaining in page.

        1062    .TOSSZ   Returns stop size (number of  lines  to  output)
                         for automatic CTRL/S.

        1063    .TOSTC   Returns  page  stop  counter  (number  of  lines
                         remaining on page).

        1064-1066        Reserved for use by DIGITAL.

        1067    .TOSTO   Specifies that output will stop after the number
                         of lines specified for .TOSSZ.

        1070    .TOSST   Does not reset page stop counters  after  CTRL/S
                         and CTRL/Q.

        1071    .TOSBL   Sounds terminal bell on automatic page stop.

        1072    .TOFSP   Provides pseudo-terminals with the sceen-editing
                         facilities  of  a  physical terminal.  This is a
                         read-only function.


                                   22-420
                                                       TRMOP. [CALLI 116]


        ____    ______   ________        Code    Symbol   Function

        1073    .TOOFL   Returns offline bit.  If 0 is  returned  in  the
                         ac,  the  terminal  exists.  This is a read-only
                         function.

        1074    .TOECH   Returns  echo  status.   If  set,   echoing   is
                         enabled.

        1075    .TOAPC   Returns asynchronous port characteristics.  This
                         is a read-only function.

                         ____  ______  _______                         Code  Symbol  Meaning

                         0.    .TOUNK  Unknown.
                         1     .TOHWD  Hard-wired.
                         2     .TODSD  Dataset line.
                         3-4           Reserved
                         5     .TOADL  Auto-dial.
                         6             Reserved.
                         7     .TONRT  NRTSER line.
|                        10    .TOLAT  LAT line.
|                        11    .TOCTM  CTERM line.
|  
|       1076    .TOUNP   Enables  unpause  character;  continues   output
|                        after   CTRL/S.    (The   enabled  character  is
|                        interpreted, on input, like CTRL/Q.)
|  
|       1077    .TOESC   Enables ESCape character (behaves like ESC key).
|                        In   other   words,  the  enabled  character  is
|                        interpreted, on input, as the ESCape  character,
|                        (ASCII character 033).
|  
|       1100    .TOSWI   Enables two-character switch sequence.
|  
|       1101    .TO8BT   Enables 8-bit terminal I/O.
|  
|       1102    .TO8BI   Enables 8-bit I/O mode on a terminal.
|  
|       1103    .TOQOT   Enables     the     terminal     quote      (^V)
|                        character.  .TTQOT,   when   combined  with  any
|                        character, behaves as  a  single  character.   A
|                        ^V-character  combination is deleted by a single
|                        rubout,  and  echoes  as  one   character.    ^V
|                        suppresses  special action on the next character
|                        you type.  The character is echoed without being
|                        processed.
|  
|       1104    .TOMXT   Returns maximum idle time  before  an  automatic
|                        disconnect.
|  
|       1105    .TOADT   Returns   time   remaining   before    automatic
|                        disconnect.
|  
|       1106    .TOCLE   Enables command-level echoing.











                                   22-421
   TRMOP. [CALLI 116]


   Normal Return

        The monitor performs the function.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          0    TOILF%    Illegal function code.
          1    TOPRC%    Not privileged.
          2    TORGB%    Illegal range.
          3    TOADB%    Illegal argument list address or length.
          4    TOIMP%    Line is not a dataset line.
          5    TODIL%    Error in dialing routine.
          6    TOTNA%    Terminal not available.
          7    TONBM%    Terminal is not in break set mode.  You must set
                         IO.ABS  with  the OPEN UUO before you can define
                         and enable break characters.
|         10   TONIB%    Illegal byte size specified.













































                                   22-422
                                                        TRPSET [CALLI 25]


                             TRPSET [CALLI 25]                             TRPSET [CALLI 25]



   Function

        Prevents jobs other than the calling job from running.   You  can
        (if  you  have  the  JP.TRP privilege) use this call to guarantee
        fast response to realtime interrupts.

        For  a  complete  discussion  of  realtime  traps   and   related
|       programming practices, see Chapter 9, Volume 1.

   Calling Sequence

               MOVE      ac,[XWD len,addr]
               TRPSET    ac,
                 error return
               normal return
               . . .
        addr:    JSR     address
                 BLKI    address

                len        where:  len is the length of the argument list.

                addr                addr is the address of the argument list.

                address                address is the address of a location  to  be  patched  to
                trap  directly  to your program.  This address must be in
                the range 40 to 57 (octal).

   Normal Return

        The monitor has suspended execution of other jobs.

   Error Return

        The error return occurs if the TRPSET call is not implemented, or
        if your job is not privileged.


   Related Calls

        HPQ, LOCK, RTTRP, UJEN






















                                   22-423
   TSK. [CALLI 177]


                              TSK. [CALLI 177]                              TSK. [CALLI 177]



   Function

        Performs miscellaneous functions for network nodes.  This monitor
        call   can   be   used  by  applications  that  wish  to  perform
        non-blocking connects and disconnects.  Also, it can be  used  by
        applications  translating  ANF-10 protocol into another protocol.
        These applications usually require more control over the  connect
        message than that provided by the standard LOOKUP/ENTER sequence.

        The  TSK.   monitor  call  is  an  alternative   to   using   the
        LOOKUP/ENTER method for opening/defining network links.  Once the
        link enters the run state (.TKSOK), the normal OUT and IN monitor
        calls  can be used to send or receive data over the network link.
        The TSK device cannot be designated as an MPX-controlled  device,
        but asynchronous I/O can be performed.

        Refer to Chapter 5 for more  information  about  using  the  TSK.
        monitor call.

   Calling Sequence

                MOVE    ac,[XWD length,addr]
                TSK.    ac,
                  error return
                normal return

        addr:   EXP     func-code     ;.TKAFN
                EXP     channo        ;.TKACH
                EXP     arg1          ;.TKAA1
                EXP     arg2          ;.TKAA2
                EXP     arg3          ;.TKAA3

                function        where:  function is one of the function codes listed below.

                channo                channo is the I/O channel number on which the device  TSK
                has been opened.

                Each argument is an argument for the  specified  function
                code.

        Most arguments will be pointers to  Network  Process  Descriptors
        (NPDs), having the following format:

                XWD  length,addr

                length        where:  length is the length of the NPD (must be at least 3).

                addr                addr is the location of the NPD.

        Associated with each task link  are  two  processes:   the  local
        process  and remote process.  The processes are named by the NPD.
        The format of the NPD is:

             ______  ______  _______             Offset  Symbol  Meaning

               0     .TKNND  Node number (-1 implies any node, but is not
                             valid when used in the remote passive NPD).

               1     .TKNLN  Length of ASCII process  name  that  follows
                             (number of characters).


                                   22-424
                                                         TSK. [CALLI 177]


             ______  ______  _______             Offset  Symbol  Meaning

               2     .TKNPN  First word of the ASCII process name.

        The following lists the function codes for TSK.:

        ____   ______    _______        Code   Symbol    Meaning

                                                              arg1          1    .TKFRS    Returns the state of  the  link  in  arg1.   The
                         possible states are:

                         ____   _____     _______                         Code   State     Meaning

                           0    .TKSID    The link  is  idle.   The  call
                                                                     arg2                                          destroys  the  contents of arg2
                                          and stores the reason  for  the
                                                       arg3                                          disconnect.  arg3 is unchanged.
                           1    .TKSCI    The  link  is  waiting  for   a
                                          connect  initiate  message.  It
                                          returns the local  NPD  in  the
                                                                arg2                                          area  pointed  to  by arg2.  It
                                          returns the remote NPD  in  the
                                                             arg3                                          area pointed to by arg3.
                           2    .TKSCC    The  link  is  waiting  for   a
                                          connect  confirmation  message.
                                          It returns the local NPD at the
                                                                 arg2                                          location  specified in arg2 and
                                          the remote NPD at the  location
                                                       arg3                                          specified in arg3.
                           3    .TKSOK    The link  is  operational.   It
                                          returns  the  local  NPD at the
                                                                arg2                                          location specified in arg2  and
                                          the  remote NPD at the location
                                                       arg3                                          specified in arg3.
                           4    .TKSDC    The  link  is  waiting  for   a
                                          disconnect         confirmation
                                          message.  It returns the  local
                                          NPD  at  the location specified
                                             arg2                                          in arg2 and the remote  NPD  at
                                                                    arg3                                          the location specified in arg3.

                         You may include a  pointer  (len,,addr)  to  the
                         local  NPD in arg2.  You can include the pointer
                         to  the  remote  NPD  in  arg3.   These   words,
                         however, are optional.

          2    .TKFEP    Enters the link into  the  passive  state.   The
                         link  must  be in the .TKSID state.  The monitor
                         reads and  stores  the  local  and  remote  NPDs
                                       arg2     arg3                         pointed to by arg2 and arg3.

                         If, at a later  time,  the  monitor  receives  a
                         Connect  Initiate  message  that  "matches"  the
                         remote NPD, the following occurs:


                          o  The monitor deletes the remote NPD.

                          o  The monitor builds a new remote NPD from the
                             information  given  in  the connect message.
                             The job can read the new NPD  by  using  the
                             .TKFRS  function  to  determine  the process
                             that initiated the connection.



                                   22-425
   TSK. [CALLI 177]


        ____   ______    _______        Code   Symbol    Meaning


                      o  The monitor enters  the  link  into  the  .TKSOK
                         state.

                      o  The monitor issues a device on-line interrupt to
                         the  job if the job enabled this condition using
                         the PSI system.


          3    .TKFEA    Enters the link into the active  state.   Before
                         issuing  this  function  the link must be in the
                         .TKSID state.  All other states cause  an  error
                         code (TKILS%) to be returned.  When this code is
                         issued, the monitor reads the local NPD  pointed
                                 arg1                         to  by  arg1  and  the  remote NPD pointed to by
                         arg2                         arg2.  It then sends a Connect Initiate  request
                         to  the  node/task  specified in the remote NPD.
                         It puts the link into the TKSCC state and  takes
                         the  normal  return.   The  link  remains in the
                         TKSCC  state  until   a   Connect   Confirm   or
                         Disconnect function is issued.

                         If a Connect  Confirm  is  issued,  the  monitor
                                                                arg2                         discards  the remote NPD pointed to by arg2.  It
                         builds a new remote NPD using the information in
                         the  Connect  Confirm message (so that it can be
                         read by a .TKFRS function).  The link is  placed
                         in  the  .TKSOK state and the controlling job is
                         given  a  device  on-line  interrupt   (if   the
                         condition was enabled using the PSI system).

                         If a Disconnect function is issued, the  monitor
                         discards   both   the   local   and  remote  NPD
                         specifications.  It places  the  link  into  the
                         .TKSID  (idle)  state  and gives the controlling
                         job a device  off-line  interrupt  (if  the  job
                         enabled this condition using the PSI system).

          4    .TKFEI    Enters the  link  into  the  idle  state.   This
                         function is illegal for those tasks in .TKSDC or
                         .TKSCC states and is a no-op for  those  already
                         in   the   idle  state  (.TKSID).   The  monitor
                         performs the following for those links in .TKSCI
                         and .TKSOK states:

                              .TKSCI  Both NPDs are released.   The  link
                                      state is set to .TKSID.

                              .TKSOK  A Disconnect Initiate is sent.  The
                                      link state is set to .TKSDC.

                         When Disconnect Confirmed message is issued at a
                         later  time,  the  monitor frees both NPDs, sets
                         the link state to .TKSID, and issues  a  "device
                         off-line" interrupt.









                                   22-426
                                                         TSK. [CALLI 177]


        ____   ______    _______        Code   Symbol    Meaning

          5    .TKFWT    Puts the link into the wait state.  If the  link
                         is  in  either  the  .TKSID or .TKSOK state, the
                         monitor takes  the  normal  return  immediately.
                         The  monitor  performs  the  following for those
                         links in the other states:

                              _____   ________                              State   Function

                              .TKSCI  waits  for  a  transition  to   the
                                      .TKSOK state and then returns.

                              .TKSCC  waits for a  transition  to  either
                                      the  .TKSOK  or .TKSID states, then
                                      returns.

                              .TKSDC  waits for a  transition  to  .TKSID
                                      and then returns.

          6    .TKFOT    Performs  output   with   control   of   message
                         disassembly.   This  function  is valid only for
                         links  in  the  .TKSOK  state.   This   function
                         performs  an  OUT  monitor call on the specified
                         channel.  If the OUT is successful, the contents
                         of  the  buffer will be sent without an EOF bit.
                         If unsuccessful, the monitor places  error  code
                                         ac                         TKUDW%  in  the ac and returns the device status
                                 arg1                         word in arg1.

          7    .TKFIN    Performs input with  message  reassembly.   This
                         function  is  valid  only for those links in the
                         .TKSOK state.  It performs an IN monitor call on
                         the  specified channel.  If the IN is successful
|                        (non-skip return), and UU.DMR was not set on the
|                        OPEN,  the  monitor  reads  the  message  as one
|                        entire buffer  and  takes  a  skip  return.   If
|                        UU.DMR  was  set,  the  message  is read without
|                        reassembly.  If the IN fails, the monitor places
                                                       ac                         error  code  TKUDW%  in  the  ac  and stores the
                                               ac                         device status word in ac+1.

          10   .TKFRX    Returns the status of  the  link  in  arg1  (see
                         .TKFRS  for  a  list  of codes) and the "segment
                         size," or the maximum  message  size,  in  arg2.
                         Note  that  the segment size is only returned if
                         the link is in "OK" state (.TKSOK).

   Normal Return

        The specified function has been performed.















                                   22-427
   TSK. [CALLI 177]


   Error Return

                                                            ac        One of the following error codes is returned in the ac.

        ____   ______   _______        Code   Symbol   Meaning

          1    TKTNL%   TSKSER not loaded (intertask communication is not
                        supported).
          2    TKATS%   Argument list was too short.
          3    TKUNP%   Insufficient privileges.
          4    TKILF%   Illegal function.
          5    TKILC%   Illegal channel (not a TSK device or channel  not
                        open).
          6    TKILN%   Illegal NPD.
          7    TKNTS%   NPD too short.
         10    TKILS%   Function is illegal in this state.
         11    TKNFC%   Not enough  monitor  free-core  to  perform  this
                        function.
         12    TKNFL%   No free links.  (NETLAT is full.)
         13    TKNXN%   Attempt to connect to a non-existent node.
         14    TKUDW%   IN or OUT UUO (.TKFOT or .TKFIN) did not skip.

   Related Calls

        NODE.









































                                   22-428
                                                      TTCALL [OPCODE 051]


                            TTCALL [OPCODE 051]                            TTCALL [OPCODE 051]



   Function

        Passes the monitor a code for an extended  set  of  calls;  these
        calls perform terminal functions and are usually called TTCALLs.

        Each defined TTCALL code also has a symbolic  name;  the  TTCALLs
        are  discussed  in  alphabetical order by their symbolic names in
        this section.  For  example,  TTCALL 1,  has  the  symbolic  name
        OUTCHR;  its  function is discussed under the name OUTCHR in this
        section.

        The TTCALLs and their symbolic names are:

             ______              ______ ________             Symbol              TTCALL Function

             INCHRW              [TTCALL 0,]
             OUTCHR              [TTCALL 1,]
             INCHRS              [TTCALL 2,]
             OUTSTR              [TTCALL 3,]
             INCHWL              [TTCALL 4,]
             INCHSL              [TTCALL 5,]
             GETLCH              [TTCALL 6,]
             SETLCH              [TTCALL 7,]
             RESCAN              [TTCALL 10,]
             CLRBFI              [TTCALL 11,]
             CLRBFO              [TTCALL 12,]
             SKPINC              [TTCALL 13,]
             SKPINL              [TTCALL 14,]
             IONEOU              [TTCALL 15,]

        Note that  TTCALL  operations  are  performed  only  on  physical
        terminals, not on a device with the logical name TTY.






























                                   22-429
   UGETF [OPCODE 073]


                             UGETF [OPCODE 073]                             UGETF [OPCODE 073]



   Function

        Returns the block number of the next free block on a DECtape; the
|       UGETF  call  is a no-op for other devices.  Use FILOP. to perform
|       UGETF for an extended I/O channel.

   Calling Sequence

                UGETF   channo,addr
                return
                . . .
        addr:   BLOCK   1

                channo        where:  channo is the channel number of an initialized device.

                addr                addr is the address of the  location  where  the  monitor
                will return a block number at addr.

   Return

                                                               addr        The block number of the next free block is returned at addr.   If
        this  call precedes an ENTER, the inter-block spacing factor used
        for output is reduced to that used for .SAV files.  This function
        is  used  to  reduce  the  number  of times the tape must reverse
        direction when reading a large file.

   Related Calls

        FILOP.

































                                   22-430
                                                        UJEN [OPCODE 100]


                             UJEN [OPCODE 100]                             UJEN [OPCODE 100]



   Function

        Dismisses a  realtime  interrupt  from  a  user-supplied  service
        routine, if such a routine is in progress.

   Calling Sequence

                UJEN
                return

   Return

        The  monitor  restores  all   accumulators   and   executes   the
        instruction

                JEN @counter

                counter        where:  counter is the address of the program counter stored by a
                JSR instruction when the interrupt occurred.

        Note that you can dismiss a user-mode interrupt with a  JRST  12,
        instruction.

   Related Calls

        RTTRP, TRPSET




































                                   22-431
   UNLOK. [CALLI 120]


                             UNLOK. [CALLI 120]                             UNLOK. [CALLI 120]



   Function

        Unlocks one or both segments for the current job.  Your  job  can
        also be unlocked when the monitor implicitly executes a RESET for
        your program.  This occurs in any of the following cases:

         o  Your program executes a RUN monitor call.

         o  You issue any of the monitor commands that invoke a program.

   Calling Sequence

                MOVE   ac,[XWD high,low]
                UNLOK. ac,
                  error return
                normal return

                high        where:  high can be  0  or  1.   If  set,  the  high  segment  is
                unlocked.   If  clear,  the  status  of  the high segment
                remains the same.

                low                low can be 0 or 1.  If set, the low segment is  unlocked.
                If clear, the status of the low segment remains the same.
                                high       low                If you set both high  and  low,  both  segments  will  be
                unlocked.

        A high segment shared by several jobs cannot be  unlocked  unless
        the  SN%LOK  bit is off for all those jobs.  This bit is bit 5 in
        GETTAB table 14, .GTSGN.  This bit will be on for each  job  that
        issued  the  LOCK  monitor call for the high segment, but has not
        issued a subsequent UNLOK.  call for the high segment.

   Normal Return

        The specified segments  are  unlocked  and  become  eligible  for
        swapping.   Any existing meter points (set by the METER.  monitor
        call) are cleared, and any real-time devices are  reset.   CORMAX
        is changed to show the newly available pages, if any.

   Error Return

        The error return occurs only if the UNLOK.  monitor call  is  not
        implemented  on  your  system.  You must use either a RESET or an
        EXIT monitor call instead.

   Related Calls

        LOCK














                                   22-432
                                                       USETI [OPCODE 074]


                             USETI [OPCODE 074]                             USETI [OPCODE 074]



   Function

        Specifies a block on disk or DECtape  to  be  read,  written,  or
        updated.  This function can also be performed by SUSET. and FILOP
|       calls.  (Use FILOP. to perform USETI on an extended I/O channel.)

        The monitor call sequence  for  reading  a  file  starting  at  a
        specific block is listed below:

             LOOKUP
             USETI
             INPUT

        The monitor call sequence  for  writing  a  file  starting  at  a
        specific block is shown below:

             ENTER
             USETO
             OUTPUT

        The monitor call sequence for updating a file is:

             LOOKUP
             ENTER
             USETO      ;or USETI
             OUTPUT     ;or INPUT

        If your job is privileged (that is, running with  the  JACCT  bit
        set  or running under [1,2]) and your program does not perform an
        ENTER before a USETO or a LOOKUP  before  a  USETI,  the  monitor
        performs  super  I/O.   If  your  job  is not privileged and your
        program does not perform an ENTER before  a  USETO  or  a  LOOKUP
        before a USETI, the monitor sets IO.BKT in the I/O status word.

|       The OPEN-ENTER-USETI sequence does not  perform  super  I/O.   It
|       returns  an IO.IMP error.  Likewise, an IO.IMP error results from
|       OPEN-LOOKUP-USETO.  Refer to  Chapter  11,  Volume  1,  for  more
        information about using file positioning calls.

   Calling Sequence

                USETI   channo,n
                return

                channo        Where:  channo is the channel number for an initialized device.

                n                n is the number of the block to be used for I/O.

                For  DECtape,  the  block  number  is  relative  to   the
                beginning of the tape.

                          n                For disk, n is a block number, when  the  file  is  open.
                                                                 n|               When  the  call  is  not  preceded  by a LOOKUP, n is the
                address of a word where the block number is stored.  This
                is  a super-USETI call, because this method allows you to
                specify a block number, greater than 18 bits, relative to
                the beginning of the structure.





                                   22-433
   USETI [OPCODE 074]


        The action of the USETI call on disk devices is determined by the
                 n        value of n as follows:

        _____                            _______        Value                            Meaning

        -n, n = 2 to 10 (octal)          The nth extended RIB is read.

        -1                               IO.EOF is set in the I/O  status
                                         word,  causing an end-of-file on
                                         the next  INPUT.   On  the  next
                                         OUTPUT,  the data is appended to
                                         the file.

        0                                The prime RIB  is  read  on  the
                                         next INPUT.

        1 to file size                   The block specified is  read  on
                                         next INPUT.  If the file size is
                                         greater than or equal to 777770,
                                         it  is  recommended that you use
                                         FILOP. function .FOUSI.

        file size to 777770              The IO.EOF bit is set in the I/O
                                         status    word,    causing    an
                                         end-of-file on the next INPUT.


   Related Calls

        FILOP., SUSET., USETO

   Common Errors


         o  Not synchronizing I/O with USETI or USETO.

         o  Not initializing a device on channo.





























                                   22-434
                                                       USETO [OPCODE 075]


                             USETO [OPCODE 075]                             USETO [OPCODE 075]



   Function

        Selects a block on disk or  DECtape  to  be  written  by  an  OUT
        monitor  call.   This  function  can  be performed by SUSET.  and
|       FILOP.   (Use  FILOP.   to  perform  USETO  on  an  extended  I/O
|       channel.)  Refer  to  the USETI UUO and Chapter 11, Volume 1, for
        more information.

   Calling Sequence

                USETO   channo,n
                return

                channo        Where:  channo is the channel number for an initialized device.

                n                n is the number of the I/O block.

                             n                For DECtape, n  is  the  block  number  relative  to  the
                beginning of the tape.

                          n                For disk, n is a block number if  a  previous  ENTER  has
                                                      n                been used to open a file.  Otherwise, n is the address of
                a word that contains the block  number  relative  to  the
                beginning   of   the  structure  or  unit  (super-USETO),
                allowing you to specify a block number  greater  than  18
                bits.

        The action of the USETO call for disk is determined by the  value
           n        of n as follows:

        _____                            _______        Value                            Meaning

|       -n for n = 2 to 10 (octal)       Equivalent To a USETO 777776  to
                                         777770; you may not write to the
                                         RIBs of a file.

        -1                               The  most  recently   input   or
                                         output  block  is  re-written on
                                         the next OUTPUT.

        0                                The IO.BKT is set  in  the  file
                                         status word.

        1 to file size                   The specified block  is  written
                                         on the next OUTPUT.  If the file
                                         size is greater than or equal to
                                         777777,  it  is recommended that
                                         you use FILOP. function .FOUSO.

        file size to 777776              The monitor allocates all blocks
                                         from  the  block after file size
                                         to  the  block  before  the  one
                                         specified.  Each block allocated
                                         is  written  with  zeros.    The
                                         block   specified  is  the  next
                                         block  written   in   the   next
                                         OUTPUT.





                                   22-435
   USETO [OPCODE 075]


   Related Calls

        FILOP., SUSET., USETI

   Common Errors


         o  Not synchronizing I/O with USETI or USETO.

         o  Not initializing a device on channo.
























































                                   22-436
                                                        UTPCLR [CALLI 13]


                             UTPCLR [CALLI 13]                             UTPCLR [CALLI 13]



   Function

|       Clears a DECtape directory.  Use FILOP. to perform UTPCLR  on  an
|       extended  I/O  channel.   The  UTPCLR monitor call is a no-op for
        other devices.

   Calling Sequence

                UTPCLR  channo,
                return

                channo        where:  channo is the channel number for an initialized device.

   Normal Return

        The monitor clears the directory by clearing the first  83  words
        (except  those  7-bit  bytes  describing blocks 0, 1, 2, 100, and
        1102 through 1105 octal).

   Common Errors

         o  I/O to unassigned channel at user PC xxxxxx.

                                                   ac         o  Forgetting to place the channel in the ac or  forgetting  the
                        channo            comma after channo.

                                          channo         o  Not initializing a DECtape on channo.



































                                   22-437
   UTRP. [CALLI 174]


                             UTRP. [CALLI 174]                             UTRP. [CALLI 174]



   Function

        Sets or reads user trap instructions.  This UUO allows a user  to
|       handle  non-zero section LUUOs, arithmetic overflows, or pushdown
|       list overflows by depositing instructions in locations  420,  421
        and  422  in  the  UPMP.  Usually these instructions are calls to
        user-supplied subroutines.

   Calling Sequence

                MOVE   ac,[XWD fcncode,addr]
                UTRP. ac,
                  error return
                normal return
                . . .
        addr:   length
                trapno
                trapinstr
                . . .
                trapno
                trapinstr

                fcncode        where:  fcncode is one of the function codes described below.

                addr                addr is the address of the argument list.

                length                length is the number of words in the argument list.

                trapno                trapno is the number of a trap.  Trap numbers are  listed
                below.

                trapinstr                trapinstr is the instruction to call the trap routine.

        The function codes and their meanings are:

        ____   ______    _______        Code   Symbol    Meaning

|         0    .UTRED    Reads the contents of the trap location.  A zero
|                        opcode cannot be used as a trap instruction, but
|                        a  zero  fullword  here  will  restore   monitor
|                        handling of the specific condition.

          1    .UTSET    Sets the contents of the trap location.

        The trap numbers are:

        ____   ______    _______        Code   Symbol    Meaning

          0    .UTLUU    Stores the contents of  the  4  word  LUUO  trap
                         block in the UPT.

          1    .UTAOF    Arithmetic overflow trap (location  421  in  the
                         UPMP).
          2    .UTPOV    Pushdown list overflow trap (location 422 in the
                         UPMP).

   Normal Return

        The specified traps are cleared or set.



                                   22-438
                                                        UTRP. [CALLI 174]


   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          1    UTIAD%    Illegal address.
          2    UTUKF%    Unknown function.
          3    UTITN%    Illegal trap number.
          4    UTIUT%    Illegal user trap instruction.

   Related Calls

        ABRENB, .JBINT trapping, PSI system




















































                                   22-439
   WAIT [CALLI 10]


                              WAIT [CALLI 10]                              WAIT [CALLI 10]



   Function

        Causes program execution to wait until all data transmissions  on
|       a  given channel are completed.  Use FILOP. to perform WAIT on an
|       extended I/O channel.

   Calling Sequence

                WAIT    channo,
                return

                channo        where:  channo is the channel number for an initialized device.

   Normal Return

        The monitor stops your program's execution until transmissions on
        the channel are completed.

   Common Errors

         o  Using WAIT on a tape which is spacing (see MTWAT.).

                                         channo         o  Not initializing a device on channo.

                                     channo         o  Omitting the comma after channo.





































                                   22-440
                                                          WAKE [CALLI 73]


                              WAKE [CALLI 73]                              WAKE [CALLI 73]



   Function

        Sets the wake bit for a specified job.

   Calling Sequence

                MOVEI   ac,jobno
                WAKE    ac,
                  error return
                normal return

                jobno        Where:  jobno is the number of a logged-in job (use  -1  for  the
                current job).

        You can design a real-time  process  control  job  to  run  other
        process  control jobs when specific alarm conditions occur.  WAKE
        can be called from an RTTRP job running at interrupt level;  this
        allows  the  real-time  job  to  wake its background quickly when
        necessary.  See  the  RTTRP  monitor  call  for  restrictions  on
        accumulators when calling from the interrupt level.

        If your job does not have  the  required  privileges,  the  error
                                                    ac        return  occurs  and  the monitor clears the ac.  A JACCT or [1,2]
        job may WAKE any job.  If any condition enabled in the last HIBER
        call  occurs, the wake bit for the job is set.  At the next HIBER
        call, the wake bit is cleared and  the  monitor  returns  at  the
        normal  return  immediately.   The wake bit prevents the job from
        oversleeping a wake condition.

   Normal Return

        The specified job is awake and resumes execution  at  the  normal
        return for the HIBER call that made the job dormant.

   Error Return

                                                                   ac        Your job did  not  have  the  required  privileges.   The  ac  is
        cleared.

   Related Calls

        Refer to the HIBER monitor call.




















                                   22-441
   WHERE [CALLI 63]


                              WHERE [CALLI 63]                              WHERE [CALLI 63]



   Function

        Returns the node number for a device.

   Calling Sequence

                MOVE   ac,[SIXBIT/device/]  \
                MOVEI  ac,channo            |
                MOVEI  ac,udx               /
                WHERE  ac,
                  error return
                normal return

                device        where:  device is the  SIXBIT  physical  or  logical  name  of  a
                device.

                channo                channo is the number of an initialized channel.

                udx                udx is the Universal Device Index for a device.

        When your program  specifies  OPR  as  the  device,  the  monitor
        returns  the  node number at which your job is logically located.
        Refer to the LOCATE command description in the Commands Manual.

        When your program  specifies  CTY  as  the  device,  the  monitor
        returns the node number of your job's host system.

        When your program  specifies  TTY  as  the  device,  the  monitor
        returns  the  node  number  to  which your terminal is physically
        located.

   Normal Return

        The monitor returns the status flags for the node  and  the  node
                                                  ac        number  for  the  given  device  in  the  ac.   The format of the
        returned word is:

        ____   ______    _______        Bits   Symbol    Meaning

        0-12             Reserved for use by DIGITAL.
          13   RM.SDU    Dial-up node.
       14-17   RM.SUP    Status of the node:

                         _____  ______    ______                         Value  Symbol    Status

                           1    .RMSUN    Not  in  contact  with  central
                                          site.
                           2    .RMSUD    Down.
                           4    .RMSUG    Loading.
                          10    .RMSUL    Loaded.

       18-35             Node number for device.

   Error Return

        A nonexistent device was specified.

   Related Calls

        LOCATE, NODE.


                                   22-442
M3!