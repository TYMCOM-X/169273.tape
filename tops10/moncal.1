


               * * * * * * * * * * * * * * * * * * * * * * *
               *                                           *
               *                                           *
               *      F I E L D   T E S T   D R A F T      *
               *                                           *
               *                                           *
               * * * * * * * * * * * * * * * * * * * * * * *




                        TOPS-10 Monitor Calls Manual

                                  Volume 2

|                         AA-K039B-TB, AA-K039B-T1
|  
|  
|                               August 1985

                       This  manual   describes   the
                       monitor  calls used by TOPS-10
                       MACRO programmers  to  request
                       services  that  are controlled
                       by the TOPS-10  monitor.   The
                       TOPS-10  Monitor  Calls Manual
                       consists   of   two   volumes.
                       Volume 1 is an overview of the
                       services  available   to   the
                       programmer.   Volume  2  is  a
                       detailed list of the calls and
                       coding sequences that are used
                       to invoke those services.

|                      This   manual   updates    the
                       previous  manual  of  the same
                       name,   SDC    order    number
|                      AA-K039B-TB.

|  Operating System:   TOPS-10  Version 7.03
|  
|  Software:           GALAXY   Version 5.1





   digital equipment corporation      marlboro, massachusetts


















                                     1



                                              First Printing, August 1980
                                                   Updated, December 1981
                                                   Revised, February 1984
|                                                    Updated, August 1985



   The information in this document is subject to change  without  notice
   and  should  not  be  construed  as  a commitment by Digital Equipment
   Corporation.  Digital Equipment Corporation assumes no  responsibility
   for any errors that may appear in this document.

   The software described in this document is furnished under  a  license
   and  may  only  be used or copied in accordance with the terms of such
   license.

   No responsibility is assumed for the use or reliability of software on
   equipment that is not supplied by DIGITAL or its affiliated companies.





|  Copyright  C , 1971, 1980, 1981, 1984, 1985 Digital Equipment Corporation.
                                 All Rights Reserved.





   The postage-prepaid READER'S COMMENTS form on the last  page  of  this
   document  requests  the  user's  critical  evaluation  to assist us in
   preparing future documentation.

   The following are trademarks of Digital Equipment Corporation:

        DEC                 DECnet              IAS
        DECUS               DECsystem-10        MASSBUS
        Digital Logo        DECSYSTEM-20        PDT
        PDP                 DECwriter           RSTS
        UNIBUS              DIBOL               RSX
        VAX                 EduSystem           VMS
                                                VT























                                     2



                                      CONTENTS



   CHAPTER 22      MONITOR CALL DESCRIPTIONS


   CHAPTER 23      GETTAB TABLES

           23.1    HOW TO USE GETTAB TABLES . . . . . . . . . . . .  23-1
           23.2    HOW TO USE GETTAB SUBTABLES  . . . . . . . . . .  23-1
           23.3    ADDING ITEMS TO THE MONITOR'S GETTAB TABLES  . .  23-3
           23.4    ADDING NEW GETTAB TABLES TO THE MONITOR  . . . .  23-4
           23.5    ALPHABETIC LISTING . . . . . . . . . . . . . . .  23-4
           23.6    TOPS-10 GETTAB TABLES  . . . . . . . . . . . . .  23-6


   APPENDIX A      GLOSSARY


   APPENDIX B      .EXE FILES

           B.1     THE DIRECTORY  . . . . . . . . . . . . . . . . . . B-1


   APPENDIX C      FILE DAEMON

           C.1     USER INTERFACE . . . . . . . . . . . . . . . . . . C-1
           C.2     THE FILE DAEMON  . . . . . . . . . . . . . . . . . C-1
           C.3     ACCESS.USR . . . . . . . . . . . . . . . . . . . . C-3
           C.4     MONITOR INTERFACE TO A FILE DAEMON . . . . . . .  C-10


   INDEX


   TABLES

           22-1    PATH. Functions and Flags  . . . . . . . . . .  22-283
           C-1     ACCESS.USR Switches  . . . . . . . . . . . . . . . C-4
           C-2     Access Codes . . . . . . . . . . . . . . . . . .  C-11
           C-3     File Daemon Codes  . . . . . . . . . . . . . . .  C-12
           C-4     File Daemon Flags  . . . . . . . . . . . . . . .  C-13























                                     xi















                                  PREFACE                                  PREFACE



   This is the second  volume  of  the  2-volume  TOPS-10  Monitor  Calls
   Manual.   Volume 1 describes the facilities offered by the monitor for
   assembly language programs.  You can use the information in  Volume  1
   to learn how to implement these facilities in your programs.

   Volume 2 contains a detailed description of  each  monitor  call,  its
   calling  sequence,  functions,  and  error  codes,  if any.  It is the
   definitive list of the monitor call  functions.   For  information  on
   using  these  calls, you should you read Volume 1 before attempting to
   use Volume 2.

   Not all devices are supported under current versions of  TOPS-10.   In
   the  interest  of  providing  useful information, this manual includes
   references to unsupported and obsolete hardware.  For  support  status
   of hardware and software, please refer to the current TOPS-10 Software
   Product Description.

|  Obsolete monitor calls are marked, either in the CALLI UUO, or in  the
|  chapter   in   which  they  were  previously  described.   Appropriate
|  substitutes, (if any), for obsolete calls are also indicated.  Section
|  23.5 lists the GETTAB tables, and notes any which are obsolete.

   If you find any errors in this manual, please fill  out  the  Reader's
   Comment  Card  found  at the back of the manual and mail it to DIGITAL
   Equipment Corporation.

   All reported errors will be corrected  as  soon  as  possible.   These
   corrections  are  distributed  automatically  to notebook subscribers.
   Availability of updates to  this  manual  will  be  announced  in  the
   ________ ________   Software Dispatch newsletter.




















                                    xii












                                 CHAPTER 22                                 CHAPTER 22

                         MONITOR CALL DESCRIPTIONS                         MONITOR CALL DESCRIPTIONS



   This chapter describes each of the TOPS-10 monitor  calls.   For  each
   description the following information is included, if applicable:

         o  Function:  briefly describes the general use of the call.

         o  Calling Sequence:  shows the  format  for  the  call.   Cases
            where  a  word  may  contain  one  of  a  number  of types of
            information are indicated by the  presence  of  braces  ({ })
            containing the options.

         o  Restrictions:  describes any unusual  conditions  that  might
            affect the operation of the call or its effect on the calling
            program.

         o  Normal Return:  describes the result of a normal return  from
            the call and any operational aspects with which you should be
            concerned.

         o  Error Return:  describes the result of an error on return.

         o  Example:  shows one or more examples of the call.

         o  Related Calls:  lists other, related monitor calls.

         o  Common Errors:  describes common user errors.

   In the  calling  sequences  shown,  the  following  definitions  apply
   throughout this section:

            ac         o  ac:   an  arbitrary  accumulator;  often  used  for   passing
            arguments  to  the  call  and to store an error code returned
            from a call.

            return         o  return:  the statement to which control passes on return from
            a call.

            normal return         o  normal return:  the statement to which control passes  if  no
            error occurs in executing a call.

            error return         o  error return:  the statement to which control  passes  if  an
            error occurs in executing a call.

   The monitor call names are defined in the file UUOSYM.MAC; the  CALLI,
   MTAPE,  and  TTCALL  monitor calls offer extensions through parameters
   passed to the monitor.






                                    22-1
   ACCLG. [CALLI 204]


                             ACCLG. [CALLI 204]                             ACCLG. [CALLI 204]



   Function

        Used by the LOGIN system program to increment LOGNUM  and  ensure
        that  LOGIN does not exceed the maximum number of logged-in jobs.
        The monitor performs  the  following  functions  for  the  ACCLG.
        call:

        1.  Increments LOGNUM (a word containing the number of  logged-in
            jobs).

        2.  Checks the LOGNUM  against  the  appropriate  access  maximum
            (LOGMAX for timesharing jobs or BATMAX for batch jobs).


   Calling Sequence

                MOVSI   ac,(flags)
                ACCLG.  ac
                  error return
                normal return

        where:  flags are:

        ___    ______    _______        Bit    Symbol    Meaning

        0      AC.MAX    Check LOGMAX.
        1      AC.BMX    Check BATMAX.
        2      AC.DCR    Decrement LOGNUM count.

   Normal Return

        On a normal return, LOGNUM has been incremented and  the  maximum
        is not exceeded.  If the LOGIN program is halted before the LOGIN
        UUO has successfully completed, however, the program should  trap
        the  CTRL/C  exit  and  perform another ACCLG.  call, setting the
        AC.DCR flag to decrement the LOGNUM  count  before  allowing  the
        program to exit.

   Error Return

        When this call takes the error return, one of the following error
                                      ac        codes will be returned in the ac.

   Error Codes

        ____   ______    _____        Code   Symbol    Error

          1    ACLMX%    LOGMAX check failed.  That is, to  log  in  this
                         job would exceed LOGMAX.
          2    ACLBM%    BATMAX check failed.
          3    ACLIL%    Invalid argument to ACCLG.  call.
          4    ACLJL%    ACCLG.  with  AC.DCR  set  produced  an  invalid
                         decrement.
          5    ACLDC%    An ACCLG.  with AC.DCR had been  attempted  when
                         the LOGNUM had not been incremented.







                                    22-2
                                                        ACCT. [CALLI 167]


                             ACCT. [CALLI 167]                             ACCT. [CALLI 167]



   Function

        Reads or changes the account string for a job.

   Calling Sequence

               MOVE      ac,[XWD fcn-code,addr]
               ACCT.     ac,
                 error return
               normal return
               . . .
        addr:  EXP       len
               . . .
               last argument

                fcn-code        where:  fcn-code is one of the function codes described below.

                addr                addr is the address of the argument block.

                len                len is the length of the argument  block  (not  including
                                                        last argument                this  word),  and  the words up through last argument are
                arguments for the given function.

        The function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

          0    .ACTCH    Changes the account  string  for  the  specified
                         job.   The first word of the argument block must
                         contain a 1 for the  number  of  arguments;  the
                         second  word  must contain either a byte pointer
                         to  the  ASCIZ  account  string  or   the   word
                                               address                         [-1,,address],  where address is the location of
                         the account string.  In the latter case, account
                         strings   must   be  left-justified  on  a  word
                         boundary.

                         You must have JACCT privileges to  use  function
                         code 0.  Note that [1,2] privileges alone do not
                         provide ability to perform this function.

          1    .ACTRD    Reads the account string for the specified  job.
                         The  first  word  of  the  argument  block  must
                         contain a 2 for the  number  of  arguments;  the
                         second  word must contain the job number for the
                         desired account string (-1 for the calling job);
                         the third word must contain the address of where
                         to return the account string.

                                      NOTE

                The maximum length for account strings is set  by
                the  system  administrator  when  the  monitor is
                generated by MONGEN (symbol name  MLACTS).   This
                default  can be changed if your installation uses
                fewer than 39 characters in its account strings.






                                    22-3
   ACCT. [CALLI 167]


   Normal Return

|       If the function was .ACTCH, the account string  is  changed.   If
|       the function was .ACTRD, the account string for the job is in the
                                 addr+2        addr+1        location pointed to  by  addr+2,  and  addr+1  contains  the  job
        number.

   Error Return

                                         ac        An error code is returned in the ac.  The error codes  and  their
        meanings are:

        ____   ______    _____        Code   Symbol    Error

|         1    ACTTL%    Account string too long  for  your  buffer;  the
                         leftmost characters have been stored.
          2    ACTAC%    Address check error.
          3    ACTIL%    Illegal argument.
          4    ACTNJ%    Nonexistent job number.
          5    ACTPS%    JACCT privileges required.

   Example

                MOVE    T1,[XWD .ACTRD,ARGLST]
                ACCT.   T1,
                  JRST  ERROR
                JRST    CONTIN
        ARGLST: EXP     2
        JOBNO:  EXP     -1
        ACCADR: EXP     ACCSTR
        ACCSTR: BLOCK   ^D8
              .  .  .
        ERROR:  error routine
        CONTIN: success routine

        This code sequence  places  the  ASCIZ  account  string  for  the
        calling job into the locations starting at ACCSTR.

   Related Calls

        GETPPN, PJOB

























                                    22-4
                                                        APRENB [CALLI 16]


                             APRENB [CALLI 16]                             APRENB [CALLI 16]



   Function

        Enables trap servicing for a program.  When a  condition  enabled
        for  trap servicing occurs, control is transferred to the address
        given by .JBAPR in the job data area.  See  Chapter  6  for  more
        information about handling traps.

   Calling Sequence

                MOVEI   ac,flags
                APRENB  ac,
                return

                flags        where:  flags is a halfword containing flag bits as follows:

        ___    ______    ____ _________        Bit    Symbol    Trap Condition

        18     AP.REN    Repetitive enable.

        19     AP.POV    Pushdown list overflow.

        21     AP.ABK    Reserved.

        22     AP.ILM    Memory protection violation.

        23     AP.NXM    Nonexistent memory.

        24     AP.PAR    Memory parity error.

        26     AP.CLK    Clock tick.  The clock ticked while your program
                         was  actively  running; this trap does not occur
                         for every clock tick.

        29     AP.FOV    Floating-point overflow.

        32     AP.AOV    Arithmetic overflow.

        When one of these conditions occurs while  the  processor  is  in
        user mode, the monitor:

        1.  Stores the PC in location .JBTPC in the Job  Data  Area.   If
            the  PC is equal to the first or second location in your trap
            servicing routine, the program is terminated.

        2.  Clears the arithmetic and floating-point overflow flags.

        3.  Transfers  control  to  your  trap-servicing   routine;   the
            location is given by the right half of location .JBAPR in the
            Job Data Area.

        Your program must place the address of the trap-servicing routine
        into .JBAPR before executing the APRENB monitor call.










                                    22-5
   APRENB [CALLI 16]


                                      NOTES


                 o  If your trap-servicing routine  contains  the
               instruction

                            JRSTF @.JBTPC

                    the processor bits are cleared and the  state
                    of the CPU is restored; control resumes where
                    the interrupt occurred.

                 o  The APRENB monitor call clears the trap after
                    an  occurrence  of  any  selected  condition;
                    therefore your program must call APRENB after
                    each trap occurs.

                 o  To enable repeated trap  interceptions,  your
                    program  should  set  AP.REN  (bit  18)  when
                    executing the  APRENB  call;  however,  clock
                    interrupts  must be reenabled after each trap
                    occurs.

                 o  If your program does not  enable  for  traps,
                    overflow   conditions  and  clock  ticks  are
                    ignored,  but  the  other  conditions  listed
                    above produce fatal errors.



   Example

                MOVEI   T1,OVERFL     ;Get routine address
                                      ; To handle overflow
                MOVEM   T1,.JBAPR     ;Put into .JBAPR
                MOVEI   T1,AP.AOV     ;Arithmetic overflow flag
                APRENB  T1,           ;To .JBAPR on arith ovflw
                JRST    CONTIN        ;On to something else
        OVERFL: OUTSTR  [ASCIZ /ARITHMETIC OVERFLOW ERROR/]
                JRSTF   @.JBTPC       ;Resume execution
                 .  .  .
        CONTIN:                       ;Something else

        This code sequence sets up an  overflow  message  for  the  first
        arithmetic  overflow; note that this example will not handle more
        than one arithmetic overflow.

   Common Errors

        Not reenabling the interrupt after each trap has occurred.

        Failing to set up .JBAPR prior to the APRENB call.

   Related Calls

|       UTRP., PISYS










                                    22-6
                                                       ATTACH [CALLI 104]


                             ATTACH [CALLI 104]                             ATTACH [CALLI 104]



   Function

        Attaches a terminal line to a job.  For  example,  this  call  is
|       used  by  the BATCON program to attach and detach jobs from their
        terminals at system shutdown.  This call is  more  powerful  than
        the ATTACH monitor command.

        An unprivileged job can use the ATTACH monitor call only  if  its
        terminal  is  in  user  mode, and it can only detach from its own
        controlling terminal.

   Calling Sequence

                MOVE    ac,[EXP <flag>+<lineno>B17+<jobno>B35]
                ATTACH  ac,
                  error return
                normal return

                flag        where:  flag is one of the bits described below.

                lineno                lineno is a line number (restricted to 16 bits).

                jobno                jobno is the number of a logged-in job (use  -1  for  the
                current job).

           jobno        If jobno is -1, your job is detached from the  current  line  and
                                             jobno        attached  to  the specified line; if jobno is 0, the job attached
                                                        jobno        to the line specified by lineno is detached; if jobno is positive
        (requires  JACCT  or  [1,2] privileges), the monitor detaches the
        specified job from its  current  line  and  attaches  it  to  the
        specified line.

        The flags and their meanings are:

             ___    ______    ________ ____             Bit    Symbol    Terminal Mode

              0     AT.UMM    Puts terminal in  monitor  (command)  mode.
|                             However, .STPGU of the SETUUO may force the
|                             terminal into user mode.
              1     AT.UUM    Puts terminal in user mode.

        If neither flag is set, the terminal mode is not  changed.   Note
        that this is the terminal mode, not the job mode.

        To attach an arbitrary job to a terminal:

             jobno             jobno     should be the number of the job to be attached.

             lineno             lineno    should be the number of the terminal to which  the
                       job is to be attached.

             flag             flag      is the mode to which the new terminal will be set.

        The previous terminal will be left in monitor mode.

        To attach your current  job  to  a  terminal,  follow  the  above
        definitions, with the following exception:

             jobno             jobno     should be less than 0 (-1 is recommended).



                                    22-7
   ATTACH [CALLI 104]


        To detach an arbitrary terminal:

             jobno             jobno     must be zero.

             lineno             lineno    should  be  the  number  of  the  terminal  to  be
                       detached.

             flags             flags     will be ignored.  The terminal  will  be  left  in
                       monitor mode.

        To detach your job's controlling terminal:

             jobno             jobno     must be zero.

             lineno             lineno    should be -1 or 777777.  If you explicitly include
                       777777,  the  first  two  bits  of  the  value are
                       ignored, producing  177777  (both  flag  bits  are
                       off).

             flags             flags     are ignored.  The terminal is  placed  in  monitor
                       mode.

   Normal Return

        The job is attached or detached as specified, and the terminal is
        in the specified mode.

   Error Return

            ac        The ac is cleared.  An error return occurs only  if  you  use  an
        illegal  line  or  job number, or if you do not have the required
        privileges for the call.

   Example

                MOVSI   T1,-1
                ATTACH  T1,
                  JRST  ATTERR
                JRST    CONTIN
                .  .  .
        ATTERR: error routine
        CONTIN: success routine

        This example detaches the current job from its terminal line; the
        mode is not changed.





















                                    22-8
                                                       CALLI [OPCODE 047]


                             CALLI [OPCODE 047]                             CALLI [OPCODE 047]



   Function

        Passes the monitor a code for an extended set of  monitor  calls,
        called  CALLIs.   The  negative CALLI codes, except CALLI -1, are
        reserved for customer-defined monitor  calls.   All  non-negative
        codes  and  -1  are  reserved for use by DIGITAL.  Any CALLIs not
        listed  in  the  following  table  are  not  supported   or   not
|       implemented.   Obsolete  CALLIS. are  marked  as  such,  and some
|       indicate an appropriate, supported monitor call to substitute for
|       the obsolete call.  They are not described in this manual.

        The defined CALLIs also have symbolic names; in this chapter they
        are  listed  in  alphabetical order by symbol name.  For example,
        CALLI -1 is named LIGHTS, and is described in this chapter  under
        LIGHTS.

        The CALLIs and their symbolic names are listed in numerical order
        on the following pages.












































                                    22-9
   CALLI [OPCODE 047]


        ______    _____ ________      ______    _____ ________        Symbol    CALLI Function      Symbol    CALLI Function

|       LIGHTS    (Obsolete)          WHERE     [CALLI 63]
        RESET     [CALLI 0]           DEVNAM    [CALLI 64]
|       DDTIN     (Obsolete;          CTLJOB    [CALLI 65]
|                 use TTCALL)
        SETDDT    [CALLI 2]           GOBSTR    [CALLI 66]
|       DDTOUT    (Obsolete;          HPQ       [CALLI 71]
|                 use OUTSTR)
        DEVCHR    [CALLI 4]           HIBER     [CALLI 72]
|       GETCHR    (Obsolete;          WAKE      [CALLI 73]
|                 use DEVCHR)
        WAIT      [CALLI 10]          CHGPPN    [CALLI 74]
        CORE      [CALLI 11]          SETUUO    [CALLI 75]
        EXIT      [CALLI 12]          OTHUSR    [CALLI 77]
        MONRT.    [CALLI 1,12]        CHKACC    [CALLI 100]
        UTPCLR    [CALLI 13]          DEVSIZ    [CALLI 101]
        DATE      [CALLI 14]          DAEMON    [CALLI 102]
        LOGIN     [CALLI 15]          JOBPEK    [CALLI 103]
        APRENB    [CALLI 16]          ATTACH    [CALLI 104]
        LOGOUT    [CALLI 17]          DAEFIN    [CALLI 105]
|       SWITCH    (Obsolete)          FRCUUO    [CALLI 106]
        REASSI    [CALLI 21]          DEVLNM    [CALLI 107]
        TIMER     [CALLI 22]          PATH.     [CALLI 110]
|       MSTIME    [CALLI 23]          METER.    (Obsolete;
|                                                use SNOOP.)
        GETPPN    [CALLI 24]          MTCHR.    [CALLI 112]
        TRPSET    [CALLI 25]          JBSET.    [CALLI 113]
        TRPJEN    [CALLI 26]          POKE.     [CALLI 114]
        RUNTIM    [CALLI 27]          TRMNO.    [CALLI 115]
        PJOB      [CALLI 30]          TRMOP.    [CALLI 116]
        SLEEP     [CALLI 31]          RESDV.    [CALLI 117]
|       SETPOV    (Obsolete;          UNLOK.    [CALLI 120]
|                 use APRNEB)
        PEEK      [CALLI 33]          DISK.     [CALLI 121]
        GETLIN    [CALLI 34]          DVRST.    [CALLI 122]
        RUN       [CALLI 35]          DVURS.    [CALLI 123]
        SETUWP    [CALLI 36]          XTTSK.    [CALLI 124]
        REMAP     [CALLI 37]          CAL11.    [CALLI 125]
        GETSEG    [CALLI 40]          MTAID.    [CALLI 126]
        GETTAB    [CALLI 41]          IONDX.    [CALLI 127]
        SPY       [CALLI 42]          CNECT.    [CALLI 130]
        SETNAM    [CALLI 43]          MVHDR.    [CALLI 131]
        TMPCOR    [CALLI 44]          ERLST.    [CALLI 132]
        DSKCHR    [CALLI 45]          SENSE.    [CALLI 133]
        SYSSTR    [CALLI 46]          CLRST.    [CALLI 134]
        JOBSTR    [CALLI 47]          PIINI.    [CALLI 135]
        STRUUO    [CALLI 50]          PISYS.    [CALLI 136]
        SYSPHY    [CALLI 51]          DEBRK.    [CALLI 137]
        DEVTYP    [CALLI 53]          PISAV.    [CALLI 140]
        DEVSTS    [CALLI 54]          PIRST.    [CALLI 141]
        DEVPPN    [CALLI 55]          IPCFR.    [CALLI 142]
|       SEEK      (Obsolete)          IPCFS.    [CALLI 143]
        RTTRP     [CALLI 57]          IPCFQ.    [CALLI 144]
        LOCK      [CALLI 60]          PAGE.     [CALLI 145]
        JOBSTS    [CALLI 61]          SUSET.    [CALLI 146]
        LOCATE    [CALLI 62]          SCHED.    [CALLI 150]









                                   22-10
                                                       CALLI [OPCODE 047]


        ______    _____ ________        Symbol    CALLI Function

        ENQ.      [CALLI 151]
        DEQ.      [CALLI 152]
        ENQC.     [CALLI 153]
        TAPOP.    [CALLI 154]
        FILOP.    [CALLI 155]
        NODE.     [CALLI 157]
        ERRPT.    [CALLI 160]
        ALLOC.    [CALLI 161]
        PERF.     [CALLI 162]
        DIAG.     [CALLI 163]
        DVPHY.    [CALLI 164]
        GTNTN.    [CALLI 165]
        GTXTN.    [CALLI 166]
        ACCT.     [CALLI 167]
        DTE.      [CALLI 170]
        DEVOP.    [CALLI 171]
        SPPRM.    [CALLI 172]
        MERGE.    [CALLI 173]
        UTRP.     [CALLI 174]
        PIJBI.    [CALLI 175]
        SNOOP.    [CALLI 176]
        TSK.      [CALLI 177]
        KDP.      [CALLI 200]
        QUEUE.    [CALLI 201]
        RECON.    [CALLI 202]
        PITMR.    [CALLI 203]
        ACCLG.    [CALLI 204]
        NSP.      [CALLI 205]
        NTMAN.    [CALLI 206]
        DNET.     [CALLI 207]
        SAVE.     [CALLI 210]
        CMAND.    [CALLI 211]
        PIBLK.    [CALLI 212]
|       SCS.      [CALLI 213]
|       SEBLK.    [CALLI 214]
|       CTX.      [CALLI 215]
|       PIFLG.    [CALLI 216]
|       IPCFM.    [CALLI 217]
|       LLMOP.    [CALLI 220]
|       LATOP.    [CALLI 221]
|       KNIBT.    [CALLI 222]
|       CHTRN.    [CALLI 223]
|       ETHNT.    [CALLI 224]





















                                   22-11
   CAL11. [CALLI 125]


                             CAL11. [CALLI 125]                             CAL11. [CALLI 125]



   Function

        Performs front-end testing and debugging functions.   Using  this
        call,  you  can  obtain  information about PDP-11 based front end
        nodes, send and  receive  front-end  messages,  and  examine  and
        deposit into the front-end software.

   Calling Sequence

                MOVE    ac,[XWD len,addr]
                CAL11.  ac,
                  error return
                normal return
                . . .
        addr:   XWD port,fcn-code     ;.C11FC
                address               ;.C11AD
                value                 ;.C11CN
                qstart                ;.C11EN

                len        where:  len is the length of the argument block.

                addr                addr is the address of the argument block.   Starting  at
|               this   address,  the  call  accepts  up  to  four  words,
                depending on the function code.

        The argument block for  CAL11.   UUOs  depends  on  the  function
        specified  in  the  right  half  of the function word (.C11FC) at
        addr        addr.  The function word contains a  port  specification  in  the
        left half, and the function code in the right half.

        Therefore, the format of the argument list for CAL11.  is:

        ______     ______             _______        Offset     Symbol             Meaning

          0        .C11FC     Function   word,   containing   the    port
                              specification  and  the function code.  The
                              left half of this word contains the type of
                              port,  in  either of the following formats.
                              The first format is old, and may be used by
                              existing programs.  However, the new format
                              is recommended for new programs.

                              The old format for the left half is:

                              ____      ______           _______                              Bits      Symbol           Meaning

                              9-17      C1.CNO     Type of PDP-11:

                              9-14      C1.1NT     Type of port
                                                   (see C1.1TY below).

                              14-17     C1.1NN     CPU number.

                                                                  addr                              The new format for the left half of addr is
                              as  follows.   Note  that  this  format  is
                              signified by the setting of bit 0, the sign
                              bit.





                                   22-12
                                                       CAL11. [CALLI 125]


                              ____      ______     _______                              Bits      Symbol     Meaning

                              0         C1.1NF     New  format  for  port
                                                   specification.

                              1-8       C1.1XX     Reserved  for  use  by
                                                   DIGITAL.

                              9-11      C1.1TY     Type code, one of  the
                                                   following:

                                        ____     ______     _______                                        Code     Symbol     Meaning

                                         0       .C11DL     DL-10
                                         1       .C11DT     DTE-20
                                         2       .C11KD     KMC/DUP
|                                        3       .C11DR     DMR-11

                              11-14     C1.1CN     CPU number.

                              15-17     C1.1PN     Port number.

                              The right half of .C11FC (C1.1FC)  contains
                              the function code.  The arguments following
                              .C11FC  depend  on  the  function,  so  the
                              argument   lists  are  described  for  each
                              function code listed below.

        The function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

          0    .C11DP    Deposits the specified  data  in  the  specified
                         location.   The argument block for this function
                         is:

                         addr:   XWD     port,.C11DP     ;.C11FC
                                 EXP     dpaddr          ;.C11AD
                                 EXP     value           ;.C11CN

                                 dpaddr                         where:  dpaddr is the  address  to  receive  the
                                 value.

                                 value                                 value is the data to be deposited.

                         This function requires the JP.POK privilege.

          1    .C11EX    Examines the specified location.   The  argument
                         list for this function is:

                         addr:   XWD     port,.C11EX     ;.C11FC
                                 EXP     exaddr          ;.C11AD

                                 exaddr                         where:  exaddr is the address to be examined.

                         The data at the specified location  is  returned
                                ac                         in the ac.

                         This function requires the JP.POK privilege.







                                   22-13
   CAL11. [CALLI 125]


        ____   ______    ________        Code   Symbol    Function

          2    .C11QU    Queues a request to the front end.  The argument
                         list for this function is:

                         addr:   XWD     port,.C11QU     ;.C11FC
                                 BLOCK 2
                                 EXP     qstart          ;.C11EN

                                 qstart                         where:  qstart is the first word of a data block
                                 containing   information  regarding  the
                                 front end function.

                         This function requires the JP.POK privilege.

          3    .C11NM    Returns the name of the program running  on  the
                         PDP-11.   The SIXBIT program name is returned in
                         ac                         ac.  The argument list for this function is:

                         addr:   XWD     port,.C11NM     ;.C11FC

          4    .C11UP    Returns the status of the PDP-11 (0 for down,  1
                                                                 ac                         for up).  The status is returned in the ac.  The
                         argument list for this function is:

                         addr:   XWD     port,.C11UP     ;.C11FC

          5    .C11SM    Sends a message.  The  argument  list  for  this
                         function is:

                         addr:   XWD     port,.C11SM     ;.C11FC

          6    .C11RM    Receives a message.  The argument list for  this
                         function is:

                         addr:   XWD     port,.C11RM     ;.C11FC

          7    .C11TY    Returns the node  type  and  node  number.   The
                         argument list for this function is:

                         addr:   XWD     port,.C11TY     ;.C11FC

                         The node number is returned in the left half  of
                              ac                         the  ac,  and  the  node type is returned in the
                         right half, as one of the following type codes:

                         ____   ______    _______                         Code   Symbol    Meaning

                           1    .C1D76    DC76.
                           2    .C1D75    DC75/DN87.
                           3    .C1D60    DN60.
                           4    .C1D8S    DN87S.
                           5    .C1CFE    Console front end.
                           6    .C1MCB    DECnet-10 MCB front end.












                                   22-14
                                                       CAL11. [CALLI 125]


   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          1    C11NP%    Job not privileged.
          2    C11UF%    Unknown function.
          3    C11ND%    Wrong type of PDP-11 specified.
          4    C11IU%    Examine/deposit function already in use.
          5    C11NA%    No answer to examine/deposit.
          6    C11TS%    Queue entry too short.
          7    C11NE%    Not enough arguments.
          10   C11IA%    Invalid address specified for examine/deposit.
          11   C11IQ%    Invalid argument for queue request function.
          12   C11IC%    Insufficient core.
          13   C11RP%    DTE-reload bit is set, or  primary  protocol  is
                         not running.
          14   C11IE%    Insufficient exec virtual memory.
          15   C11IL%    Illegal packet length.
          16   C11NC%    CPU is not running.
          17   C11IT%    Illegal type code specified.
          20   C11IP%    Illegal port number specified.
          21   C11DL%    No DL10 support in this monitor.
          22   C11DT%    No DTE support in this monitor.
          23   C11KD%    No KDP support in this monitor.
          24   C11DR%    No DMR support in this monitor.







































                                   22-15
   CHGPPN [CALLI 74]


                             CHGPPN [CALLI 74]                             CHGPPN [CALLI 74]



   Function

        Changes the project-programmer number (PPN) for the current  job.
        This  call  is  reserved  for  the exclusive use of the LOGIN and
        INITIA programs.

   Calling Sequence

                MOVE    ac,[XWD projno,progno]
                CHGPPN  ac,
                  error return
                normal return

                projno,progno        where:  projno,progno is the new project-programmer number (PPN).

   Normal Return

        The PPN for the current job is changed to the given number.

   Error Return

        Occurs if the calling job is already logged in, or if either  the
                                                   ac        project or programmer number is zero.  The ac is unchanged.

   Example

                MOVE   T1,[XWD 27,5031]
                CHGPPN T1,
                  JRST ERROR

        This code sequence  changes  the  PPN  for  the  current  job  to
        27,5031.

   Related Calls

        GETPPN, LOGIN


























                                   22-16
                                                       CHKACC [CALLI 100]


                             CHKACC [CALLI 100]                             CHKACC [CALLI 100]



   Function

        Determines whether a file may be accessed, based  on  your  job's
        current  PPN  and the file access protection code.  Your programs
        should  not  make  assumptions  concerning   the   access   codes
        associated  with  a file; they should use the CHKACC monitor call
        to determine if access  is  permitted  to  that  file.   This  is
        especially  true  for privileged programs that are constrained by
        the access  privileges  of  a  non-privileged  project-programmer
        number for which they are performing a task.

        The CHKACC call does not function correctly on systems  that  are
        running  a  file  daemon  program,  such  as FILDAE.  So, if your
        system is running a FILDAE type  program,  use  the  FILOP. call.
        The  FILOP. monitor  call  allows a privileged program to specify
        that an operation is to be  performed  only  when  the  operation
        would  be  legal  if  performed by a specified project-programmer
        number.  In most cases, the FILOP.  function eliminates the  need
        for  the  CHKACC  monitor  call.   New programs should be written
|       using FILOP.'s "in your behalf" capability (.FOPPN).

   Calling Sequence

                MOVEI  ac,addr
                CHKACC ac,
                  error return
                normal return
                . . .
        addr:   XWD fcn-code,<ufdprot>B26+<filprot>B35
                XWD projno,progno     ;For file
                XWD projno,progno     ;For accessing program

                addr        where:  addr is the address of the argument block.

                fcn-code                fcn-code is one of the function codes described below.

                ufdprot                ufdprot is a directory protection code.

                filprot                filprot is a file protection code.

                projno,progno                projno,progno is a project-programmer number (PPN).


                                          NOTE

                    When your  program  specifies  function  codes  0
                    through  6,  the  monitor  ignores  the directory
                    protection.  When your program specifies function
                    codes  7  and  10,  the  monitor ignores the file
                    protection.












                                   22-17
   CHKACC [CALLI 100]


        The function codes and their meanings are:

        ____   ______    ______        Code   Symbol    Access

          0    .ACCPR    Checks  whether  your   job   can   change   the
                         protection for the file.

          1    .ACREN    Checks whether your job can rename the file.

          2    .ACWRI    Checks whether your job can write the file.

          3    .ACUPD    Checks whether your job can update the file  (in
                         old update mode).

          4    .ACAPP    Checks whether your job can append to the file.

          5    .ACRED    Checks whether your job can read the file.

          6    .ACEXO    Checks whether your job can execute the file.

          7    .ACCRE    Checks whether your job can create the  file  in
                         the user's UFD.

         10    .ACSRC    Checks whether your job can read  the  directory
                         as a file.

        The right to access a file is determined by:


         o  The type of access desired.

         o  The project-programmer number of the user desiring access  to
            the file.

         o  The project-programmer number of the directory containing the
            file.

         o  The protection field of the file or the protection  field  of
            the directory.

        Note that access to a file is not dependent  on  the  file  name.
        However,  the  file  name  is  needed if your program is going to
        perform a LOOKUP.

        The owner of a UFD or an SFD can always read the UFD or SFD as  a
        directory.

   Normal Return

                                     ac        The monitor returns 0 in the ac if access to the file is allowed,
        or -1 if access is not allowed.

   Error Return

            ac        The ac is unchanged; this occurs only  if  you  gave  an  invalid
        function code or CHKACC is not implemented on your system.










                                   22-18
                                                       CHKACC [CALLI 100]


   Example

        The following code checks  to  see  if  the  user  logged  in  as
        [11,315] can change a file with protection <055> in the directory
        area [27,5031].

                MOVEI   T1,ARGLST
                CHKACC  T1,
                  JRST  ERROR
                JRST    CONTIN
        ARGLST: XWD     .ACCPR,<775>B26+<055>B35
                XWD     27,5031       ;For files
                XWD     11,315        ;For accessing program

   Related Calls

        FILOP.

   Common Errors

        Assuming that the CHKACC call grants access to a file.   Remember
        that  it  only  tests  the accessibility of the file.  FILDAE can
        still deny access to the file on  a  LOOKUP,  ENTER,  RENAME,  or
        FILOP. call.  The File Daemon program is described in Appendix C.










































                                   22-19
|  CHTRN. [CALLI 223]


                             CHTRN. [CALLI 223]|                            CHTRN. [CALLI 223]
|  
|  
|  
|  Function
|  
|       CHTRN.  is used to translate characters from  one  representation
|       to  another.   For instance, CHTRN.  may be used to convert 7-bit
|       characters to 8-bit characters.
|  
|  Calling Sequence
|  
|               XMOVEI  ac,addr
|               CHTRN. ac,
|                 error return
|               normal return
|  
|       addr:  XWD   flags, source count
|              EXP   source byte pointer (word one)
|              EXP   source byte pointer (word two)
|              XWD   reserved, destination count
|              EXP   destination byte pointer (word one)
|              EXP   destination byte pointer (word two)
|  
|       where:  flags are one or more of the flags listed below.
|               source count is the number  of  bytes  stored  where  the
|               source byte pointer indicates.
|  
|               destination count is the number of bytes available at the
|               location the destination byte pointer indicates.
|  
|       The flag bits are:
|  
        ____   ______    _______|       Flag   Symbol    Meaning
|  
|         0    CH.FBR    Fallback  represntation  (translates  8-bit   to
|                        7-bit).
|         1    CH.OVR    Includes   overprinting    in    the    fallback
|                        representation.
|         2    CH.RAI    Changes lower case to upper case.
|         3    CH.6BT    Converts ASCII characters to SIXBIT.
|         4    CH.IGN    Ignores  extra  bits;   does   not   range-check
|                        characters.
|         5    CH.ESC    Maps 7-bits ESCape sequences to  8-bit  wherever
|                        possible.
|         6    CH.X6B    Expands SIXBIT source to ASCII destination.
|  
|  Normal Return
|  
|       The ac is unchanged.  The byte pointers returned  will  have  any
|       indirection  and  indexing  resolved.   If you specify a one-word
|       global byte pointer, the pointers will be expanded from  one-word
|       global format to two-word global format.
|  
|  Error Return
|  
|       One of the following codes is returned in the ac:
|  
        ____   ______    _____|       Code   Symbol    Error
|  
|         1    CHADC%    Address   check   while   reading   or   writing
|                        arguments.
|         2    CHBYP%    Illegal byte pointer.
|         3    CHINV%    Unknown or reserved flag bit specified.
|         4    CHILC%    Illegal     character     encountered     during

                                   22-20
|                                                      CHTRN. [CALLI 223]


|                        translation.
|         5    CHDCE%    Destination count exhausted prematurely.
|         6    CHIBC%    Invalid bit combination specified.































































                                   22-21
   CLOSE [OPCODE 070]


                             CLOSE [OPCODE 070]                             CLOSE [OPCODE 070]



   Function

        Terminates transmission of data to or from a  file.   Closes  the
        file  for  both  input  and output.  The default functions of the
        CLOSE call for unbuffered data modes are:

         o  The output side of the channel is closed.  In unbuffered data
            modes, the effect is to execute a device-dependent function.

         o  The input side of the channel  is  closed.   The  end-of-file
            flag  is cleared.  Further actions depend on the data mode in
            unbuffered  data  modes.   The  effect  is   to   execute   a
            device-dependent function.

        In buffered data modes, the following operations are performed on
        the output side of the channel:

         o  All data in the buffers that have not been transmitted to the
            the device is written to the device.

         o  Device-dependent functions are performed.

         o  The ring use bit is set to 1, indicating that the ring is not
            in use.

         o  The buffer byte count, the third word of the  buffer  header,
            is set to 0.

         o  Control returns to the  user  program  when  transmission  is
            complete.

        In buffered data modes, if a ring buffer  exists,  the  following
        operations are performed to close the input side of the channel:

         o  The monitor waits until the device is inactive.

         o  The use bit of each buffer is cleared, to indicate  that  the
            buffer is empty.

         o  The use bit of the buffer ring is set to 1, to indicate  that
            the ring is not in use.

         o  The buffer byte count is set to 0.

         o  Control returns to the user program.

        If a file is being written to disk at  the  time  of  the  output
        CLOSE,  the  unwritten  blocks  at  the  end of the disk file are
        deallocated.  On input CLOSE, the access date of a disk  file  is
        updated if any data was actually read.  (LOOKUP followed by CLOSE
        does not change the access date.)

        If the file is being output to the card punch, the last  card  is
        punched,  followed by an end-of-file card.  This end-of-file card
        and the header card contain  the  file  identification  punch  in
        column 1, which is ignored by the card reader service routine.

        If a file is being output to magtape, two EOF marks  are  written
        and the tape position is backspaced over one EOF.



                                   22-22
                                                       CLOSE [OPCODE 070]


        If a file is being  output  to  the  line  printer,  a  form-feed
        character is appended to the last block of data.

   Calling Sequence

               CLOSE     channel,flags
               return

                channel        where:  channel is the channel number for the file.

                flags                flags are one or more of  the  function  flags  described
                below.

        The function flags and their meanings are:

        ____   ______    ________        Bits   Symbol    Function

        29     CL.DAT    Deletes the name block and  access  tables  from
                         the  disk data base and the space is returned to
                         monitor free core.  For example,  this  function
                         is used by BACKUP on a RESTORE operation.

        30     CL.RST    Inhibits deletion of the original file, if  any,
                         for an ENTER call that creates or supersedes the
                         file.  The new copy of the file is discarded.

        31     CL.NMB    Inhibits deletion of the name block  and  access
                         tables  in  monitor  memory;  this  function  is
                         effective only if a LOOKUP call was executed for
                         the  channel,  but  no subsequent INPUT call for
                         the channel was executed.

        32     CL.ACS    Prevents updating of the file access date.   For
                         example, this feature is used by BACKUP, to save
                         files on magtape without changing  their  access
                         dates.

        33     CL.DLL    Inhibits deallocation of any unwritten blocks at
                         the end of a disk file.

        34     CL.IN     Inhibits  closing  of  the  input  side  of  the
                         channel.

        35     CL.OUT    Inhibits closing  of  the  output  side  of  the
                         channel.

   Return

        The function is performed.

   Example

        See Chapter 11, Monitor Calls Manual Vol. 1.

   Related Calls

        LOOKUP, ENTER, RENAME









                                   22-23
   CLRBFI [TTCALL 11,]


                            CLRBFI [TTCALL 11,]                            CLRBFI [TTCALL 11,]



   Function

        Clears text from the terminal input buffer.  This call  is  often
        used  to  clear  any  further user commands when an error occurs;
|       otherwise, incorrect processing (due to user  type  ahead)  could
        follow the error.

   Calling Sequence

                CLRBFI
                return

   Return

        All text is cleared from the input buffer.

   Related Calls

        TTCALLs, TRMOP.











































                                   22-24
                                                      CLRBFO [TTCALL 12,]


                            CLRBFO [TTCALL 12,]                            CLRBFO [TTCALL 12,]



   Function

|       Clears the terminal output buffer.  This monitor call is normally
|       equivalent to typing CTRL/O.

   Calling Sequence

                CLRBFO
                return

   Return

        The terminal output buffer is cleared.

   Related Calls

|       TTCALLs, TRMOP., CLRBFI













































                                   22-25
   CLRST. [CALLI 134]


                             CLRST. [CALLI 134]                             CLRST. [CALLI 134]



   Function

        Clears or sets the I/O status bits for a  device.   This  enables
        your  program  to  continue after an I/O error has occurred.  The
        CLRST. UUO functions like SETSTS, taking the list of devices  and
        I/O  status  bits for each device, with the additional ability to
        specify devices not explicitly OPENed on an I/O channel.

        You can examine the current setting of the  I/O  status  bits  by
        using the SENSE. monitor call.

   Calling Sequence

                MOVE    ac,[XWD len,addr]
                CLRST.  ac,
                  error return
                normal return
                . . .
        addr:   SIXBIT/device/   \
                EXP     channo   |     ;.CLRSX
                EXP     udx      /
                XWD     0,setsts-value ;.CLRST
                SIXBIT/device/   \
                EXP     channo   |     ;.CLRSX
                EXP     udx      /
                XWD     0,setsts-value ;.CLRST
                . . .

                len        where:  len is the length of the argument list.

                addr                addr is the address of the argument list, containing  one
                or more 2-word entries.

                device                device is the  SIXBIT  physical  or  logical  name  of  a
                device.

                channo                channo is the number of an initialized channel.

                udx                udx is the universal device index for a device.

                setsts-value                setsts-value is the halfword value of the I/O status bits
                for  the  given device, channel, or udx; and it specifies
                the new settings for the I/O status bits.

        Your program can clear the I/O status  bits  for  more  than  one
        device.   The  argument  block  contains  a 2-word entry for each
        device.

        For a complete list of I/O status bits,  see  Chapter  11.   Each
        type  of  device  has  a unique set of I/O status bits, which are
        described in the chapter about the appropriate device.

   Normal Return

        The I/O status bits for each specified device are cleared.







                                   22-26
                                                       CLRST. [CALLI 134]


   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          1    CLRID%    Illegal device specified.
          2    CLRNO%    Specified device does not belong to your job.


   Example

                MOVE    T1,[XWD <CONTIN-ARGLST>,ARGLST]
                CLRST.  T1,
                  JRST ERROR
                JRST    CONTIN
        ARGLST: SIXBIT  /DTA0/
                EXP     0
                EXP     CHANNO
                EXP     0
                  . . .
        CONTIN:

        This code sequence clears the I/O status bits for  DTA0  and  the
        device  associated  with the channel whose number is the value of
        CHANNO.

   Related Calls

        ERLST., GETSTS, SENSE., SETSTS




































                                   22-27
   CMAND. [CALLI 211]


                             CMAND. [CALLI 211]                             CMAND. [CALLI 211]



   Function

        Defines commands that run specified programs, and manipulates the
|       job's  user-defined  command  list.  In the argument list to this
        call, your program defines a command name that, when typed  as  a
        monitor  command,  will  run  the  program  specified by the file
        specification that is also included in  the  command  list.   The
        CMAND. UUO  allows  you  to  define multiple command names in the
        argument list, and allows you to read the command  list  that  is
        already defined for your job.

   Calling Sequence

                MOVE    ac,[XWD fcn-code,addr]
                CMAND.  ac,
                  error return
                normal return

                fcn-code        where:  fcn-code is the function code.  The  function  codes  are
                listed below.

                addr                addr is the address of the argument list.   The  argument
                list for each function code is described in the following
                list of function codes.

                The function codes and their meanings are:

        ____   ______    _______        Code   Symbol    Meaning

|       0      .CMINT    Initializes   (clears)   any   current   command
                         definitions  and  creates  a new command list as
                                      addr                         specified at addr.  The argument list stored  at
                         addr                         addr is formatted as follows:

|                        addr:  flag,,length       ;.CMFLA
                                command name       ;.CMNAM
|                               device name        ;.CMDVC
|                               file name          ;.CMFLE
|                               file extension     ;.CMEXT 
                                PPN                ;.CMPPN
                                first SFD          ;.CMSFD
                                second SFD
                                          . . .
                                0                  ;end of command list

                                   flags|                        Where the flags to be stored in the left half of
                         .CMFLG indicates the number of characters in the
                         command that must be input to define the command
                         uniquely.  The flags are:

                              ____    ______  _______                              Mask    Symbol  Meaning

                              10B17   CM.UN1  Command     is     uniquely
                                              identified   by  the  first
                                              character of its name.

                              4B17    CM.UN2  Command     is     uniquely
                                              identified by the first two
                                              characters.



                                   22-28
                                                       CMAND. [CALLI 211]


                              ____    ______  _______                              Mask    Symbol  Meaning

                              2B17    CM.UN3  Command     is     uniquely
                                              identified   by  the  first
                                              three characters.

                              1B17    CM.UN4  Command     is     uniquely
                                              identified   by  the  first
                                              four characters.
|  
|                             1B12    CM.AUT  Command   is   defined   as
|                                             automatically   saving  the
|                                             job's current context.  The
|                                             command  will  create a new
|                                             context,   in   which   the
|                                             called  program  will  run.
|                                             The  original  context   is
|                                             restored  when  the program
|                                             terminates.

                                       length                         And where the length is the number of  words  in
                         the  command  block, stored in the right half of
|                        .CMFLA, and symbolized by CM.COU.

                         The rest  of  the  command  block  contains  the
                         command   name   (in   SIXBIT),   and  the  file
                         specification of the program to be run when  the
                         command is used.  Note that the command block is
                         of variable length, depending on the  SFD  level
                         of the directory where the file is stored.

                         You  can  define  more  than  one   command   by
                         including  a command block for each command, and
                         storing them in  contiguous  blocks.   The  last
|                        word,  where  the next .CMFLA might be expected,
                         must be set to zero.

        1      .CMADD    Adds one or  more  command  definitions  to  the
                         current  command  list.   The argument block for
                         this function  is  identical  to  that  used  by
|                        function 0 (.CMINT).

        2      .CMDEL    Deletes one or more commands  from  the  current
                         list of defined commands.  The argument list for
                         this function is:

                         addr:  length              ;.CMSIZ
                                first command       ;.CMCMN
                                     .
                                     .
                                     .

                         The length of the argument list is equal to  the
                         entire  length  of  the argument list, including
                         .CMSIZ.  The commands to be deleted  are  listed
                         in   the  following  words,  and  each  must  be
                         equivalent to the .CMNAM word where the  command
|                        was  defined  (see  .CMINT argument list).  Note
                         that commands in the command list that  are  not
                         listed  in  the  .CMDEL  argument  list  are not
                         affected by this function.





                                   22-29
   CMAND. [CALLI 211]


        ____   ______    _______        Code   Symbol    Meaning

        3      .CMLST    Lists all the currently defined  command  names.
                         The argument list for this function is:

                         addr:  length
                                BLOCK length-1

                               length                         where length  is  the  length  of  the  argument
|                        block, and length-1 is the number of commands to
                         return.  On a successful  return,  the  argument
                         block appears as:

                         addr:  length              ;.CMSIZ
                                first command       ;.CMNAM
                                     .
                                     .
                                     .

                         Where  .CMSIZ  contains  the  total  number   of
                         defined   commands.    The   command  names  are
                         returned starting at .CMNAM.   If  the  reserved
                         block  is  not  long enough, the list of command
                         names is limited to the reserved space.

        4      .CMRET    Returns information about a command.   You  must
                         include the argument list as:

                         addr:  length              ;.CMSIZ
                                command name        ;.CMCNM

                         In this argument list, specify the length of the
                         block  to be returned in .CMSIZ, and the name of
                         the defined command  for  which  information  is
                         desired, in .CMCNM.  The information is returned
                         in the form of a command block (same as argument
|                        list for .CMINT), for the command name.

        5      .CMDMP    Dumps the command data base.  This function uses
                         argument list:

                         addr:  length
                                BLOCK length-1

                         After the call returns successfully, a  list  of
                         all the command blocks for defined commands will
|                        be returned at addr.  See  function  0  (.CMINT)
                         for  the  format of the returned command blocks.
                         Note  that  the  last  command  block  will   be
                         followed  by  a zero word to indicate the end of
                         the command list.

   Normal Return

        The state of a return  from  CMAND. UUO  is  described  for  each
        function listed above.










                                   22-30
                                                       CMAND. [CALLI 211]


   Error Return

        On an error return, the CMAND. UUO takes the non-skip return  and
        returns  the  appropriate  code  from the following list of error
        codes:

        ____   ______    _____        Code   Symbol    Error

        1      CMIAL%    Your program specified an illegal argument list.
                         The  argument list length was either too long or
                         too short.
        2      CMADC%    Address check occurred.
        3      CMNER%    Not enough room to define commands in your job's
                         per-process space.
        4      CMDNF%    Your program did not finish reading the  command
                                                                 addr                         list.   The  buffer size you allowed at addr was
                         not enough to contain all the information to  be
                         returned.
        5      CMNSN%    No such command name.  On  a  .CMRET  or  .CMDEL
                         function,  you  specified  a command that is not
                         defined.

   Example

                MOVE AC,[XWD .CMADD,CMBLK]
                CMAND. AC,
                 error return
                success         ;Command has been defined

        CMBLK:  CM.UN3!6        ;/UNIQUE:3, and 6 words in block
                SIXBIT /XDDT/   ;Command name
                SIXBIT /DSKA/   ;Device name
                SIXBIT /DDT/    ;File name
                EXP 0           ;Extension. Might as well leave zero
                XWD 1,4         ;PPN

        This will define the XDDT command to run DSKA:DDT[1,4].





























                                   22-31
   CNECT. [CALLI 130]


                             CNECT. [CALLI 130]                             CNECT. [CALLI 130]



   Function

        Connects or disconnects a device associated with an MPX  channel.
        You  can  use  CNECT. only with devices that are MPX-controllable
        (specifically, terminals, pseudo-terminals, line  printers,  card
        readers, paper tape punches, and remote data terminals).

   Calling Sequence

                MOVEI     ac,addr
                CNECT.    ac,
                  error return
                normal return
                . . .
        addr:   XWD       fcn-code,channel
                SIXBIT/device/       \
                EXP     udx          /

                addr        where:  addr is the address of the argument block.

                fcn-code                fcn-code is one of the function codes described below.

                channel                channel is the number of an initialized MPX channel.

                device                device is the SIXBIT physical, generic, or  logical  name
                of a device.

                udx                udx is the Universal Device Index for the device.

        Your program must initialize an MPX channel for the device  using
        an  OPEN call, before using the CNECT. call to connect the device
        to an MPX channel.  The device must be initialized and  connected
        to the MPX channel before it can be used for any I/O.

        The function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

          1    .CNCCN    Connects the device to an MPX channel.

          2    .CNCDC    Equivalent to  CLOSE  and  disconnect  from  MPX
                         channel.

          3    .CNCDR    Equivalent to  RESET  and  disconnect  from  MPX
                         channel.

          4    .CNOFE    Determines output feasibility.

   Normal Return

        The specified device is connected,  disconnected,  reset,  and/or
        closed,  as  appropriate  for  the  given function code.  For the
        .CNCCN function, the Universal Device Index  for  the  device  is
                        ac        returned in the ac.








                                   22-32
                                                       CNECT. [CALLI 130]


                                                                ac        For the .CNOFE function, two values are returned in the ac.   The
                             ac        left  half  of  the  ac  contains the user address of the current
                                                             ac        output buffer, or 0 if none.  The right half of the  ac  contains
        the  number  of  data  requests  for  a  network  device  (except
        terminals, which return a 1 if output is possible),  0  if  there
        are  no data requests for the network device, or -1 if the device
        is local.  The number of data requests indicates  the  number  of
        buffers  that  the  remote device can accept before your job will
        block in output wait state.

        Your program can perform an output UUO to the device if the  left
                    ac        half of the ac contains 0 and the right half is non-zero.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          1    CNCNM%    MPX channel not initialized.
          2    CNCUD%    Nonexistent device.
          3    CNCCM%    Illegal device for MPX.
          4    CNCNF%    Not enough memory for control blocks.
          5    CNCNC%    Device not connected.
          6    CNCNO%    Device illegal or not initialized.
          7    CNCII%    Invalid Universal Device Index.
         10    CNCUF%    Invalid function code.
         11    CNCDU%    Device is not available to your job.
         12    CNCSD%    Device is spooled; not MPX-controllable.

   Example

                MOVEI   T1,ARGLST
                CNECT.  T1,
                  JRST ERROR
                JRST    CONTIN
        ARGLST: XWD     .CNCDC,CHANNO
                SIXBIT  /TTY111/

        This code  sequence  disconnects  the  device  TTY111,  which  is
        associated  with  the  MPX  channel  given by CHANNO, from an MPX
        channel.
























                                   22-33
   CORE [CALLI 11]


                              CORE [CALLI 11]                              CORE [CALLI 11]



   Function

        Allows your program to dynamically expand or  contract  its  core
        allocation  in either or both segments.  Note that neither of the
        segments may be locked in core.

   Calling Sequence

                MOVE    ac,[XWD hiseg,lowseg]
                CORE    ac,flag
                  error return
                normal return

                hiseg        where:  hiseg is the highest relative address to be used  in  the
                program high segment.

                lowseg                lowseg is the highest relative address to be used in  the
                program low segment.

                flag                flag is a flag bit (UU.PHY) to  indicate  that  the  core
                assignment applies to physical memory.  To set this flag,
                set bit 19.  When bit 19=0, virtual memory references are
                allowed.   When  bit  19=1,  all  memory  references  are
                accepted as physical addresses.

|       Note that if the CORE UUO is executed in a non-zero section,  all
|       core  address  arguments  will be interpreted as section-relative
|       values.  That is, all references are assumed to  be  relative  to
|       the current section.

           hiseg        If hiseg = 0, the core assignment for the high  segment  is  left
                      lowseg        unchanged; if lowseg = 0, the core assignment for the low segment
        is left unchanged.

                               hiseg        If you give a non-zero hiseg that is  less  than  400000  or  the
        length  of  the  low  segment  (whichever  is  greater), the high
        segment is eliminated.  Doing this from the high  segment  causes
        an illegal memory reference.

|       If your program has no high segment, or if you give a  CORE  call
        that   eliminates  the  high  segment,  you  can  create  a  new,
                                            hiseg        non-sharable high segment by giving hiseg  greater  than  400000.
        You  can  make  the  new  high  segment  sharable  by  doing  the
        following:

         o  Giving it a .EXE extension.

         o  Writing it onto a storage device.

         o  Closing the file.

|        o  Using the SSAVE monitor command, or the  SAVE. UUO  with  the
            SS%SSH flag, to save the entire core image.

         o  Initializing the program  with  a  GET,  R,  or  RUN  monitor
            command, or with a RUN, MERGE., or GETSEG monitor call.

                                                             lowseg        If you use the CORE monitor call giving a value for  lowseg  that
        is  less  than  or  equal  to  .JBREL,  the  monitor  removes any
        noncontiguous pages from your  address  space;  these  pages  may
        include  the  page  fault handler (PFH) or VMDDT.  To avoid this,

                                   22-34
                                                          CORE [CALLI 11]


        use the PAGE. monitor call to choose only the needed pages.

        Before expanding core, you should compare  the  highest  required
        address  with  the highest legal address (stored in .JBREL).  The
        example below shows how to expand core only if necessary.

        You can specify the beginning of your program's high  segment  by
        using  the  REMAP  monitor call, the /NEWPAGE or /SET switches to
        LINK, or the TWOSEG pseudo-op to MACRO.

   Normal Return

            ac|       The ac contains the current virtual memory limit  in  1K  blocks.
|       However,  if  the  CORE  monitor  call  is issued from a non-zero
|       section, the virtual memory limit is not returned in the ac.

   Error Return

        The error return  occurs  if  any  of  the  following  conditions
        occurs:

                     hiseg         o  You give hiseg < 400001, but you  do  not  have  write-access
            privileges.

                          hiseg     lowseg         o  You give both hiseg and lowseg as zero.  In  this  case,  the
                                                        ac            number of free 1K blocks is returned in the ac.

         o  The sum of the requested new low segment and  the  previously
            existing  high  segment  exceeds  your  allowed program size.
            Core assignment is not changed; the maximum  allowed  program
                                                   ac            size (in 1K blocks) is returned in the ac.

         o  The sum of the requested new low and  high  segments  exceeds
            your  allowed  program size.  Core assignment is not changed;
            the maximum allowed program size (in 1K blocks)  is  returned
                   ac            in the ac.

                       lowseg         o  You give a lowseg argument that would extend the low  segment
            into the high segment.

         o  One or both segments are locked.

   Example

                MOVE    T1,NEWSIZ     ;Set up for call
                PUSHJ   P,CHKCOR      ;Call for core
                JRST    CONTIN

        ;Subroutine to get core only if needed

        CHKCOR: CAMG    T1,.JBREL##   ;Core size OK?
                POPJ    P,            ;Yes
                CORE    T1,           ;Get more core
                  JRST  ERROR         ;To error routine
                POPJ    P,            ;Core increase OK

   Related Calls

        PAGE.







                                   22-35
   CTLJOB [CALLI 65]


                             CTLJOB [CALLI 65]                             CTLJOB [CALLI 65]



   Function

        Obtains the number of the job that  is  controlling  a  specified
        subjob.  The subjob must be attached to a pseudo-terminal.

   Calling Sequence

                MOVEI   ac,jobno
                CTLJOB  ac,
                  error return
                normal return

                jobno        where:  jobno is the number of  the  controlled  job,  or  -1  to
                specify your current job.

   Normal Return

                                                             ac        The number of the controlling job is returned in the ac.  If  the
                      jobno        job  given by jobno is not controlled by a pseudo-terminal (PTY),
                                   ac        the number returned in the ac is -1.

   Error Return

        Occurs if the job number is illegal.

   Example

                MOVNI  T1,1
                CTLJOB T1,
                  JRST ERROR

        This code sequence returns the number of the controlling  job  in
        T1.

   Related Calls

        PJOB

























                                   22-36
|                                                        CTX. [CALLI 215]


                              CTX. [CALLI 215]|                             CTX. [CALLI 215]
|  
|  
|  
|  Function
|  
|       CTX.  allows you to manipulate contexts.  (For  a  discussion  of
|       contexts,  see  Volume  1.)  Since  the argument block of CTX. is
|       never written by the monitor, it may reside in a  write-protected
|       page or a in literal.
|  
|  Calling Sequence
|  
|               XMOVEI ac,argblk
|               CTX.   ac
|                 error return
|               normal return
|  
|       where:  argblk is the following argument block:
|  
|                                            17                        35
|               |=======================================================|
|               | P |  RESERVED  |  LENGTH   |      FUNCTION CODE       |
|               |-------------------------------------------------------|
|               |                  DATA BUFFER LENGTH                   |
|               |-------------------------------------------------------|
|               |                  DATA BUFFER ADDRESS                  |
|               |-------------------------------------------------------|
|               |                  SIXBIT CONTEXT NAME                  |
|               |-------------------------------------------------------|
|               |         RESERVED           |    RUN UUO OFFSET        |
|               |-------------------------------------------------------|
|               |                 RUN UUO BLOCK ADDRESS                 |
|               |-------------------------------------------------------|
|               |        TMPCOR LENGTH       |    SIXBIT NAME           |
|               |-------------------------------------------------------|
|               |                 TMPCOR BUFFER ADDRESS                 |
|               |-------------------------------------------------------|
|               |           MAXIMUM LENGTH OF ARGUMENT BLOCK            |
|               |=======================================================|
|  
|               The format of the argument block is:
|  
        ______ ______    ________|       Offset Symbol    Contents
|  
|          0   .CTFNC    The function code word.  It also contains one of
|                        the  following  flags,  and  the  length  of the
|                        argument block, in the following format:
|  
                         ____   ______    _______|                        Bits   Symbol    Meaning
|  
|                           0   CT.PHY    Physical only RUN UUO.
|                         2-8             Reserved for DIGITAL.
|                        9-17   CT.LEN    Length of the  argument  block,
|                                         including .CTFNC.
|                       18-35   CT.FNC    One  of  the   function   codes
|                                         listed below.
|  
|          1   .CTDBL    Holds the data  buffer  length  in  words.   510
|                        decimal words is the maximum.
|  
|          2   .CTDBA    Contains the full 30-bit  address  of  the  data
|                        buffer.  If the IFIW (sign bit) is on, a section
|                        local address, relative to the section CTX.   is
|                        executed in, is referenced.

                                   22-37
|  CTX. [CALLI 215]


|          3   .CTNAM    Used to hold a context name when creating a  new
|                        context.   When manipulating contexts, this word
|                        may contain a context name or context number.
|  
|          4   .CTRNO    RUN UUO word.  This holds the offset that  would
|                        normally go into the left half of the RUN UUO ac
|                        (0 for terminal input, or 1 for indirect command
|                        file input).
|  
|          5   .CTRNB    Holds the 30 bit address of  the  block  address
|                        that  would ordinarily go into the right half of
|                        the RUN UUO ac.
|  
|          6   .CTTMN    Contains the TMPCOR  length  in  the  left  half
|                        (bits  0-17),  and  its SIXBIT name in the right
|                        half (bits 18-35).
|  
|          7   .CTTMB    The TMPCOR buffer address.
|  
|         10   .CTMAX    Maximum length of the argument block.
|  
|       Valid function codes for the .CTFNC are:
|  
        ____   ______    ________|       Code   Symbol    Function
|  
|          0   .CTSVH    Saves the current context  and  halts  the  job.
|                        This  has  the  effect  of  a  PUSH command (see
|                        Operating System Commands  Manual,  Chapter  1).
|                        The  context  created is inferior.  The inferior
|                        context is deleted as soon as you switch from it
|                        back to the superior one.
|  
|          1   .CTSUR    Saves the current context, and runs  a  program.
|                        This  is  the  equivalent of doing an auto-save,
|                        then a restore, at monitor level.
|  
|          2   .CTSVT    Creates a parallel context by saving the current
|                        one,  and creating a new top level context.  The
|                        new context is different from one  formed  by  a
|                        PUSH  chain,  as  it  is not inferior, nor is it
|                        associated with a chain of PUSHed contexts.
|  
|          3   .CTSVS    Saves  the  current  context,  and  switches  to
|                        another,  (already existing) one.  For instance,
|                        you could use .CTSVR to  create  a  new  context
|                        running  a  program,  and  switch  back  to  the
|                        previous context using .CTSVS.  You could  later
|                        return  to  the  context  created by .CTSVR, and
|                        restart the program  in  that  context,  without
|                        waiting for it to re-initialize.
|  
|          4   .CTSVD    Switches to the specified context,  deletes  it,
|                        and  returns to the previous (saved) context.  A
|                        specific  deletion  is  required  for   parallel
|                        contexts only.
|  
|          5   .CTRDB    Reads  the  data  buffer  without  changing  the
|                        information.   An  inferior context uses this to
|                        read data when a superior context passes to it.
|  
|          6   .CTWDB    Writes the data  buffer.   An  inferior  context
|                        writes  data  to  its superior using this.  Once
|                        data has been  written,  the  old  data  in  the
|                        superior context is lost.


                                   22-38
|                                                        CTX. [CALLI 215]


|          7   .CTRQT    Reads the context quota and saved-page quota for
|                        a job.  The following offsets in the data buffer
|                        are required:
|  
                         ______ ______    ________|                        Offset Symbol    Contents
|  
|                           0   .CTJOB    Job   number,    supplied    by
|                                         program.
|                           1   .CTCTQ    Returned context quota.
|                           2   .CTPGQ    Returned saved-pages quota.
|  
|         10   CTSQT     Sets the context quota  and  saved-pages  quota.
|                        The  data  buffer  offsets  are  the same as for
|                        .CTRQT.
|  
|         11   .CTDIR    Returns  a  directory  map  of   all   contexts.
|                        (GETTAB  %CTBDM contains the byte pointer to the
|                        directory byte-stream.) The data buffer  offsets
|                        returned are:
|  
                         ______ ______    ________|                        Offset Symbol    Contents
|  
|                           0   .CTJOB    Target job number.
|                           1   .CTWCT    Word count of byte-stream data.
|                           2   .CTFDW    First   data   word   of    the
|                                         directory byte-stream.
|  
|         12   .CTINF    Returns information about a particular  context.
|                        The data buffer offsets returned are:
|  
                         ______ ______    ________|                        Offset Symbol    Contents
|  
|                           0   .CTJOB    Target job number.
|                           1   .CTCNO    Number of target context.
|                           2   .CTCNM    Name of target context.
|                           3   .CTSNO    Superior context's number.
|                           4   .CTSNM    Superior context's name.
|                           5   .CTPGM    Program  running  or  saved  in
|                                         target context, if any.
|                           6   .CTITM    Idle time (in clock ticks).
|  
|       On any return, the ac contains:
|  
        ____   ______    _______|       Bits   Symbol    Meaning
|  
|          0   CT.DAT    Set if data returned to the buffer.
|          1   CT.DBT    Returned if the buffer is truncated.
|          2   CT.ETX    Set if UUO error text in the buffer.
|          3   CT.RUN    Set for a RUN UUO error.
|      18-27   CT.RDL    Count of words returned in the buffer.
|      28-35   CT.ERR    CTX.   or  RUN   UUO   error   code.    Returned
|                        regardless  of  whether  or  not the data buffer
|                        contains error text.
|  
|  Normal Return
|  
|       No errors will be flagged in CT.ETX, CT.RUN, or CT.ERR.   Offsets
|       (if  any)  from  requested  functions  are  returned  in the data
|       buffer.







                                   22-39
|  CTX. [CALLI 215]


|  Error Return
|  
|       One or more of the following error codes is returned in  bits  28
|       through 35 of the ac:
|  
        ____   ______    _____|       Code   Symbol    Error
|  
|          0   CXIFC%    Illegal function code.
|          1   CXACR%    Address check performed while reading arguments.
|          2   CXACS%    Address check performed while storing answers.
|          3   CXNEA%    Insufficient number of arguments.
|          4   CXNLI%    User not logged in.
|          5   CXLOK%    Program locked in core.
|          6   CXDET%    Job detached.
|          7   CXSCE%    System context quota exceeded.
|         10   CXSPE%    System page quota exceeded.
|         11   CXJCE%    Job context quota exceeded.
|         12   CXJPE%    Job page quota exceeded.
|         13   CXNCS%    Insufficient core to save context.
|         14   CXNCD%    Not enough core to return data block.
|         15   CXICN%    Illegal context number.
|         16   CXNSC%    No superior context.
|         17   CXNPV%    No privileges to set quotas.
|         20   CXIJN%    Illegal job number.
|         21   CXCSI%    Users cannot switch to an intermediate context.
|         22   CXCDI%    Users cannot delete an intermediate context.
|         23   CXCDC%    Users cannot delete the current context.
|         24   CXCNP%    Context not privileged.
|         25   CXNDA%    No data block is available.





































                                   22-40
                                                       DAEFIN [CALLI 105]


                             DAEFIN [CALLI 105]                             DAEFIN [CALLI 105]



   Function

        Indicates  that  a  request  to  the  DAEMON  program  has   been
        completed.   This  monitor call is reserved for the exclusive use
        of the DAEMON program.

        If the specified job was in the DAEMON wait  state,  the  monitor
        requeues the specified job to the run queue.

   Calling Sequence

                MOVE   ac,[XWD length,addr]
                DAEFIN ac,
                  error return
                normal return
                . . .
        addr:   jobno

                length        where:  length is the length of the argument block.

                addr                addr is the address of the argument block.

                jobno                jobno is the number of the logged-in job to be restarted.

   Normal Return

                               ac        The monitor leaves the ac unchanged, requeues the specified  job,
        and clears the JDC bit in the job status word .GTSTS.

   Error Return

                                   ac        The  monitor  clears  the  ac.   This  occurs  if  you  are   not
        privileged,  if  the  job  number  is  illegal or zero, or if the
        request could not be completed.

   Example

                MOVE   T1, [XWD 1,ARGLST]
                DAEFIN T1,
                  JRST ERROR
                JRST   CONTIN
        ARGLST: EXP    JOBNO

   Related Calls

        DAEMON
















                                   22-41
   DAEMON [CALLI 102]


                             DAEMON [CALLI 102]                             DAEMON [CALLI 102]



   Function

        Invokes the system program  DAEMON.   When  a  job  executes  the
        DAEMON  monitor call, the monitor puts the job into JD wait (sets
        the JDC bit in the GETTAB table .GTSTS) and wakes DAEMON.  DAEMON
        examines  the  status word .GTSTS for each job in the system; for
        each job in the JD wait  state,  DAEMON  performs  the  requested
        function.  When the specified function has been completed, DAEMON
        issues a DAEFIN monitor call to make the job runnable.

   Calling Sequence

                MOVE   ac,[XWD length,addr]
                DAEMON ac,
                  error return
                normal return
                . . .
        addr:   EXP    fcn-code
                . . .
                last argument

                length        where:  length is the length of the argument block.

                addr                addr is the address of the argument block, which contains
                fcn-code                fcn-code  in the first word, followed by an argument list
                which differs for each function code.  The argument lists
                are described below.

        The function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

|         1    .DCORE    Obsolete





























                                   22-42
                                                       DAEMON [CALLI 102]


        ____   ______    ________        Code   Symbol    Function

|         2    .CLOCK    Enters a request in the clock queue to wake your
                         job  after  a  specified  number  of seconds has
                         elapsed.   As  soon  as  the  request  has  been
                         entered in the queue, you should issue a call to
|                        HIBER with no time  argument.   An  argument  of
                         zero  clears  the job's entry in the clock queue
                         and wakes the job.

                         The argument list for the .CLOCK function is:

                         addr:   .CLOCK
                                 EXP     seconds

                                 seconds                         where:  seconds is the number of seconds  before
|                        the  job  DAEMON  should  wake.   The  preferred
                         method for awakening the program after  a  short
                         amount of time is by using the HIBER. call.

          3    .FACT     Makes an entry in  the  system  accounting  file
|                        FACT.SYS.    Your   job   must  have  the  JACCT
|                        privilege, or be logged in  under  [1,2].   Note
|                        that  the USAGE accounting system should be used
|                        instead of the FACT file accounting  system,  as
|                        FACT  is  no  longer  supported.   Refer  to the
                                            __________  _____  __________|                        QUEUE. UUO and the TOPS-10/20  Usage  Accounting
                         ______|                        Manual   for  information  about  writing  USAGE
|                        accounting entries.  The system accounting  file
|                        entry  must  require  fewer  than  24  words  of
|                        memory.  This entry may be  stored  (by  DAEMON)
|                        for  as long as 10 minutes before being written.
                         DAEMON closes the current  FACT  file  when  its
                         length reaches 2048 blocks, and opens a new FACT
                         file.

                         The argument list for the .FACT function is:

                         addr:   .FACT
                                 first word of entry
                                 . . .
                                 last word of entry

                         Your job must have the JACCT  privilege,  or  be
|                        logged  in  under  [1,2].   Note  that the USAGE
|                        accounting system should be used instead of  the
|                        FACT  file  accounting  system,  as  FACT  is no
|                        longer supported.  Refer to the  QUEUE. UUO  and
                               __________  _____  __________  ______|                        the   TOPS-10/20  Usage  Accounting  Manual  for
                         information  about  writing   USAGE   accounting
                         entries.

          4    .DMQUE    Reserved for use by DIGITAL.

          5    .DMERR    Makes an entry in the error file; the third  and
                         following   words  of  the  argument  block  are
|                        written into the error file.  Your job must  hve
|                        JACCT or [1,2] privileges.

                         The argument block for the .DMERR function is:

                         addr:   .DMERR
                                 EXP     ercode
                                 first word of message
                                 . . .

                                   22-43
   DAEMON [CALLI 102]


                                 last word of message

                                 ercode                         where:  ercode is a code to be  entered  in  the
                         error file.






























































                                   22-44
                                                       DAEMON [CALLI 102]


                         first word of message ... last word  of  message                         first word of message ... last word  of  message
                         are  words  of  data  to be entered in the error
                         file SYS:ERROR.SYS.  The codes are:

                         ______  ______  _______                         Ercode  Symbol  Meaning

                         1       .ESWHY  Answer  to  ONCE's  Why   Reload
                                         question, and comment, if any.
                         2       .ESMSE  Continuable stopcode.
                         3       .ESMPE  KI memory parity error.
                         4       .ESNXM  KI non-existent memory error.
                         5       .ESCIN  Information  extracted  from   a
                                         crash.
                         6       .ESCPE  Channel-detected  memory  parity
                                         error or non-existent memory.
                         7       .ESDRE  DAEMON restarted.
                         10      .ESHDE  Hardware-detected device error.
                         11      .ESMDE  Massbus device error.
                         12      .ESDXE  DX20 device error.
                         14      .ESSWE  Software event.  The events are:

                              ____    ______  _____                              Code    Symbol  Event

                              1       .SWEPK  POKE.  function.
                              2       .SWESN  SNOOP.  function.
                              3       .SWETP  TRPSET function.
                              4       .SWERT  RTTRP.  function.
                              5       .SWMS1  Miscellaneous     debugging
                                              event number 1.
                              6       .SWMS2  Miscellaneous     debugging
                                              event number 2.

                         15      .ESCSE  Configuration   status   change.
                                         The  condition  change codes are
                                         listed below:

                              ____    ______  ______ ______                              Code    Symbol  Status Change

                              0       .CSCAT  Attach function
                              1       .CSCDT  Detach function.
                              2       .CSCXC  Exchange function.
                              3       .CSCTC  Date/time change.
                              4       .CSCCF  DETACH CPU function.
                              5       .CSCCO  ATTACH CPU function.
                              6       .CSCNF  Node off-line.
                              7       .CSCNO  Node on-line.
                              10      .CSCMO  Set memory on-line.
                              11      .CSCMF  Set memory off-line.

                         16      .ESSLM  System log message.
                         17      .ESDEB  Software requests data.
                         21      .ESTAP  Magnetic   tape   errors    (see
                                         TAPSER).
                         30      .ESKLE  KL  processor  error  data  from
                                         RSX-20F front end.
                         31      .ESFER  Front end reload.
                         33      .ESHSB  KS processor halt status block.
                         42      .ESTPS  Magnetic    tape     performance
                                         statistics code (see TAPSER).
                         43      .ESCFG  Maximum     configuration     in
                                         AVAIL.SYS.
                         44      .ESMRV  Monitor run values in AVAIL.SYS.
                         45      .ESDSC  Disk statistics (usually from  a
                                         crash).


                                   22-45
   DAEMON [CALLI 102]


                         ______  ______  _______                         Ercode  Symbol  Meaning

                         46      .ESBAV  Beginning  of   AVAIL.SYS   time
                                         stamp.
                         47      .ESEAV  End of AVAIL.SYS time stamp.
                         50      .ESDLE  DL10 hardware error.
                         51      .ESKIP  KI  parity/non-existent   memory
                                         interrupt.
                         52      .ESKLP  KL  parity/non-existent   memory
                                         interrupt.
                         54      .ESKSN  KS non-existent memory trap.
                         55      .ESKPT  KL/KS parity trap.
                         56      .ESSNX  Non-existent memory scan.
                         57      .ESSPR  Parity memory scan.
                         61      .ESKDT  KL data parity trap.
                         62      .ESMOT  KL data parity interrupt.
                         63      .ESCSB  CPU status block.
                         64      .ESDSB  Device status block.
                         67      .ESKAE  KL addressing failure.
                         71      .ESLPT  Line printer error.
                         72      .ESHCC  Hard copy controller entry.
                         100     .ESDTC  Date/time change (obsolete).
                         201     .ESNUS  Network utility started.
                         202     .ESNDL  Network down-line load.
                         203     .ESNUD  Network up-line dump.
                         210     .ESNHE  Network hardware error.
                         211     .ESNSE  Network software error.
                         220     .ESNOE  Network operator entry.
                         221     .ESNTC  Network topology change.
                         230     .ESNLC  Network line counter.
                         231     .ESNNS  Network node statistic entry.
                         377     .ESHIA  Hiatus in ERROR.SYS.
                         775     .ESOFF  Marker for first word  of  block
                                         as  pointer  to  start  of first
                                         entry.
                         777     .ESEOF  End-of-file flag.

                         .DMERR is a privileged function; to use  it  you
                         must  have  the JACCT privilege, or be logged in
                         under [1,2].

                                               NOTE

                             For a complete description of the format
                             of  the  error  file, refer to the SPEAR
                             Reference Manual.

        6      .DMCTL    Reserved for use by DIGITAL.

   Normal Return

        The monitor performs the specified function and issues  a  DAEFIN
                                                    ac        monitor call to make the job runnable.  The ac is cleared.













                                   22-46
                                                       DAEMON [CALLI 102]


   Error Return

        If DAEMON is not running, control returns to  the  error  return,
                ac        but the ac is unchanged.

                                                                 ac        If DAEMON is running, an error code is returned in  the  ac,  and
        control  returns  to the error return.  The error codes and their
        meanings are:

        ____   ______    _____        Code   Symbol    Error

          1    DMILF%    Illegal function code.
          2    DMACK%    Address check.
          3    DMWNA%    Incorrect number of arguments.
          4    DMSNH%    Impossible error.  If this occurs, please report
                         it to your Software Support Specialist.
          5    DMCWF%    File cannot be written.
          6    DMNPV%    Not enough privileges.
          7    DMFFB%    Incorrect format for FACT file entry.
         10    DMPTH%    Invalid path.

   Example

                MOVE   T1,[2,,ADDR]
                DAEMON T1,
                  JRST ERROR
                JRST CONTIN
                 . . .
        ADDR:   .CLOCK
                EXP    5

        This code puts the program to sleep for 5 seconds.

   Related Calls

        DAEFIN






























                                   22-47
   DATE [CALLI 14]


                              DATE [CALLI 14]                              DATE [CALLI 14]



   Function

        Returns a code giving the system date.  The code  is  an  integer
        given by the formula:

             code = 31[12(year-1964)+(month-1)]+(day-1)

        You can obtain  the  current  day,  month,  and  year  using  the
        formulas:

             day = mod(code,31)+1
             month = mod(code/31,12)+1
             year = (code/372)+1964

        The DATE call is  equivalent  to  using  GETTAB  to  obtain  item
        %CNDAT.   The  day,  month,  and  year are stored in GETTAB items
        %CNDAY, %CNMON, and %CNYER, respectively.  Your program can avoid
        the  computations  needed to interpret the data returned from the
        DATE call by GETTABing the  specific  items,  but  the  efficient
        program  will  avoid  performing  three  separate GETTAB calls by
        GETTABing %CNDAT and then dividing the data into its  appropriate
        components.

   Calling Sequence

                DATE   ac,
                return

   Example

        The following macro computes the current day, month, and year.

             DEFINE    CURDAT(DAY,MONTH,YEAR)<
                DATE   T1,
                IDIVI  T1,^D31
                ADDI   T2,1
                MOVEM  T2,DAY
                IDIVI  T1,^D12
                ADDI   T2,1
                MOVEM  T2,MONTH
                ADDI   T1,^D1964
                MOVEM  T1,YEAR
                >

   Related Calls

        TIMER















                                   22-48
                                                       DEBRK. [CALLI 137]


                             DEBRK. [CALLI 137]                             DEBRK. [CALLI 137]



   Function

        Dismisses a PSI software  interrupt,  reenabling  any  conditions
        disabled by the interrupt.  See Chapter 6 for a discussion of the
        software interrupt system.

        On a DEBRK.  monitor call, the monitor scans the queue of pending
        interrupts,  looking  for  conditions  requiring  service  by  an
        interrupt routine.  If one is found,  the  interrupt  occurs  and
        control passes to the interrupt routine.  If no such condition is
        found, DEBRK. restarts the interrupted process beginning  at  the
        point  within  your job where the interrupt occurred (usually the
        instruction after the last instruction that was executed).

   Calling Sequence

                DEBRK.
                  return 1
                  return 2

   Return

        The DEBRK. call normally returns  to  old  PC  (see  Chapter  6).
        Return 1                                        return 2        Return 1 is taken if DEBRK. is not implemented; return 2 is taken
        if there is no interrupt in progress.

   Related Calls

        PIBLK., PIINI., PIRST., PISAV., PISYS.

































                                   22-49
   DEQ. [CALLI 152]


                              DEQ. [CALLI 152]                              DEQ. [CALLI 152]



   Function

        Dequeues  one  or  more  requests  for  enqueued  resources,   or
        relinquishes  ownership  of  one or more enqueued resources.  See
        Chapter 8 for a discussion of the ENQ/DEQ facility.

   Calling Sequence

                MOVE    ac,[XWD .DEQDR,addr]        \
                MOVE    ac,[XWD .DEQDA,0]           |
                MOVE    ac,[XWD .DEQID,request-id]  /
                DEQ.    ac,
                  error return
                normal return

                function        where:  function is one of the function codes listed below.

                addr                addr is the address of an argument block,  which  is  the
                same as the one used for the ENQ. call.

                request-id                request-id is a request identifier that you specified  in
                the ENQ. argument block.

        For a discussion of these  parameters  and  the  format  of  each
        request block, refer to the ENQ. call.

        The function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

          0    .DEQDR    This  function  dequeues  a  specific   request.
                         After  a  normal return, the monitor has removed
                         the specified request from the specified  queue,
                         or  the  monitor  has dissolved the lock between
                         the job and the specified resource.   The  error
                         return  is  taken  if  you set up the call in an
                         incorrect format, or  if  you  have  no  pending
                         requests  and  you  are  not  the  owner  of the
                         specified resource.  On  an  error  return,  the
                                                              ac                         monitor returns an error code in the ac.

          1    .DEQDA    This function removes all of your  requests  for
                         ownership  and  dissolves  all  of your resource
                         locks.  The error return is taken if  you  write
                         the  call  in  an incorrect format, or if you do
                         not have any pending requests or locks.   On  an
                         error  return, the monitor returns an error code
                                ac                         in the ac.  You  should  perform  this  function
                         before  EXITing;  otherwise,  when you perform a
                         CLOSE, the function will fail but the nature  of
                         the failure will be difficult to determine.  The
                         monitor  automatically   performs   the   .DEQDA
                         function  when  you  issue  a  RESET or a LOGOUT
                         monitor call.








                                   22-50
                                                         DEQ. [CALLI 152]


        ____   ______    ________        Code   Symbol    Function

          2    .DEQID    This function requires  the  request-id  in  the
                                             ac                         right  half  of the ac.  The monitor removes all
                         requests of yours with the specified  request-id
                         from resource queues, and it dissolves all locks
                         of yours with  the  specified  request-id.   You
                         should   specify  this  function  when  you  are
                         dequeueing requests that were made in  the  same
                         ENQ.  argument block.  The error return is taken
                         if you have set up the call incorrectly, if  you
                         have  no pending requests, or if you are not the
                         owner of a resource.

   Normal Return

        The specified requests are dequeued and the specified  locks  are
        dissolved.

   Error Return

        If an error is found in one of the requests in a multiple request
        DEQ.   monitor  call,  the  error return is taken and the monitor
                                     ac        returns an error code in the ac.  However, the  ENQ/DEQ  facility
        continues  processing until all of the dequeue requests have been
        performed.  Therefore, the monitor will have dequeued  all  valid
        requests whether or not an error resulted from another request in
        the same monitor call.  If errors are found in  several  requests
                                                                       ac        of  the  same  monitor  call,  the  error code returned in the ac
        reflects the last error found.

        If you specify that you want to dequeue a request or  dissolve  a
        lock  associated  with a pooled resource, the monitor will return
        an error code if you attempt to dequeue more resources  than  you
        own  within the pool.  However, you can dequeue a subset of those
        resources that you own within a pool, still  retaining  ownership
        of those you did not dequeue.  Therefore, you cannot dequeue more
        resources than you own, but you do not have to dequeue  all  that
        you own in one request.

        The error codes for the DEQ.  call are identical to those of  the
        ENQ.   call.   They  are  listed  in  the description of the ENQ.
        call.

   Example

        DEQ. monitor calls that specify multiple requests are treated  as
        multiple  DEQ. monitor  calls,  each specifying a single request.
        This is not true for the ENQ. monitor call.  For example:

                       MOVE    T1 [XWD .DEQDR,DEQBLK]
                       DEQ.    T1,
                         JRST ERROR
                       JRST    SUBR

             DEQBLK:   2,,^D8
                       0,,400000
                       0,,2
                       POINT 7,[ASCIZ/TEST/]
                       ^D10,,1
                       0,,4
                       POINT 7,[ASCIZ/TESER/]
                       ^D10,,1



                                   22-51
   DEQ. [CALLI 152]


        The above code is, in effect, identical to the following, but the
        following is less efficient:

                       MOVE    T1,[XWD .DEQDR,DEQ1]
                       DEQ.    T1,
                         JRST ERROR

             DEQ:      MOVE    T1,[XWD .DEQDR,DEQ2]
                       DEQ.    T1,
                         JRST ERROR
                       JRST    SUBR

             DEQ1:     1,,^D5
                       0,,400000
                       0,,2
                       POINT 7,[ASCIZ/TEST/]
                       ^D10,,1

             DEQ2:     1,,^D5
                       0,,400000
                       0,,4
                       POINT 7,[ASCIZ/TESER/]
                       ^D10,,1

   Related Calls

        ENQ., ENQC.







































                                   22-52
                                                         DEVCHR [CALLI 4]


                              DEVCHR [CALLI 4]                              DEVCHR [CALLI 4]



   Function

        Returns the physical characteristics of a specified device.

   Calling Sequence

                MOVE     ac,[SIXBIT/device/]  \
                MOVEI    ac,channo            |
                MOVEI    ac,udx               /
                DEVCHR   ac,
                  return

                device        where:  device is the  SIXBIT  physical  or  logical  name  of  a
                device.

                channo                channo is the number of an initialized channel.

                udx                udx is the Universal Device Index for a device.

   Return

        If  the  device  is  not  found,  or  if  your  program  has  not
                                                          ac        initialized  the  device,  the monitor clears the ac.  Otherwise,
            ac        the ac contains flags giving the physical characteristics of  the
        device.  The flags and their meanings are:

        ____   ______    ______ __ ____        Bits   Symbol    Device or Mode

          0    DV.DRI    DECtape whose directory is in  memory;  you  can
                         clear  this bit by using the REASSI monitor call
                         for the device.

          1    DV.DSK    Disk.

          2    DV.CDR    Card device.  If DV.IN is  set,  it  is  a  card
                         reader; if DV.OUT is set, it is a card punch.

          3    DV.LPT    Line printer.

          4    DV.TTA    Terminal that is currently controlling a job.

          5    DV.TTU    Terminal that is in use.

          6    DV.2IO    Device can do input and output at the same time.

          7    DV.DIS    Special display device.  Note that this does not
                         indicate the "display" terminal characteristic.

          8    DV.LNG    Device with long dispatch table; this means that
                         monitor  calls  other than INPUT, OUTPUT, CLOSE,
                         and RELEAS can perform real functions.

          9    DV.PTP    Papertape punch.

         10    DV.PTR    Papertape reader.

         11    DV.DTA    DECtape.





                                   22-53
   DEVCHR [CALLI 4]


        ____   ______    ______ __ ____        Bits   Symbol    Device or Mode

         12    DV.AVL    The device is available or is assigned  to  your
                         job.

         13    DV.MTA    Magnetic tape.

         14    DV.TTY    Terminal.

         15    DV.DIR    The device is a directory device.  You can  test
                         this  bit to determine whether ENTER/LOOKUP must
                         be done before you can start I/O to the device.

         16    DV.IN     Input device.

         17    DV.OUT    Output device.

         18    DV.ASC    The device has been initialized  by  the  ASSIGN
                         monitor command.

         19    DV.ASP    The device has been assigned by the INIT,  OPEN,
                         or FILOP. monitor call.

|       Bits 20-35 specify the modes that are legal for the device.

         20    DV.M17    Mode 17, dump.  This is the  same  as  IO.MOD  =
                         .IODMP returned from a GETSTS monitor call.

         21    DV.M16    Mode 16, dump records.   This  is  the  same  as
                         IO.MOD  =  .IODPR returned from a GETSTS monitor
                         call.

         22    DV.M15    Mode 15, image dump.  This is the same as IO.MOD
                         = .IOIDP returned from a GETSTS monitor call.

         23    DV.M14    Mode 14, binary.  This is the same as  IO.MOD  =
                         .IOBIN returned from a GETSTS monitor call.

         24    DV.M13    Mode 13, image binary.   This  is  the  same  as
                         IO.MOD  =  .IOIBN returned from a GETSTS monitor
                         call.

         25    DV.M12    Mode 12, reserved for use by DIGITAL.

         26    DV.M11    Mode 11, reserved for use by DIGITAL.

         27    DV.M10    Mode 10, image.  This is the same  as  IO.MOD  =
                         .IOIMG returned from a GETSTS monitor call.

         28    DV.M7     Mode 7, reserved for use by customers.

         29    DV.M6     Mode 6, reserved for use by customers.

         30    DV.M5     Mode 5, reserved for use by DIGITAL.

         31    DV.M4     Mode 4, reserved for use by DIGITAL.

         32    DV.M3     Mode 3, byte.  This is  the  same  as  IO.MOD  =
                         .IOBYT returned from a GETSTS monitor call.

         33    DV.M2     Mode 2, packed  image.   This  is  the  same  as
                         IO.MOD  =  .IOPIM returned from a GETSTS monitor
                         call.



                                   22-54
                                                         DEVCHR [CALLI 4]


        ____   ______    ______ __ ____        Bits   Symbol    Device or Mode

         34    DV.M1     Mode 1, ASCII line.  This is the same as  IO.MOD
                         = .IOASL returned from a GETSTS monitor call.

         35    DV.M0     Mode 0, ASCII.  This is the  same  as  IO.MOD  =
                         .IOASC returned from a GETSTS monitor call.

                                    NOTE

           To check for the NUL device, use DEVCHR to see if both
           DV.DSK and DV.TTY are set.


   Example

|            MOVE      T1,[SIXBIT/DEV/]
             DEVCHR    T1,
             TLNN      T1,(DV.DSK)
               JRST    NOTDSK
             JRST      ISDSK

|       This example checks to see if device DEV (assumed to be a logical
        name)  is  a  disk.   The call returns to NOTDSK if it is not and
        returns to ISDSK if it is.

   Related Calls

        DEVLNM





































                                   22-55
   DEVLNM [CALLI 107]


                             DEVLNM [CALLI 107]                             DEVLNM [CALLI 107]



   Function

        Assigns (or clears) a logical device name to a device.

   Calling Sequence

                MOVE     ac,[SIXBIT/device/]  \
                MOVEI    ac, channo           |
                MOVEI    ac,udx               /
                MOVE     ac+1,[SIXBIT/name/]
                DEVLNM   ac,
                  error return
                normal return

                device        where:  device is the SIXBIT physical or logical name of a device
                to which you wish to assign a logical name.

                channo                channo is the number of an initialized channel.

                udx                udx is the Universal Device Index for a device.

                name                name is the logical name to be assigned  to  the  device.
                    name|               If  name  is  binary  zero,  any  existing  logical  name
                assignment will be cleared.

   Normal Return

                                                        ac      ac        The logical name is assigned to the device; the ac and  ac+1  are
        unchanged.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

         -3    DVLNA%    Device not assigned to your job.
         -2    DVLIU%    Logical name already in use.
         -1    DVLNX%    No such device or channel.

   Related Calls

|       DEVCHR, DEVNAM, DEVOP., DEVPPN, DEVSIZ, DEVSTS, DEVTYP, REASSI

   Common Errors

        Assuming that DEVLNM also causes the device to become  associated
        with  your  job.   Use  the  REASSI  call  to actually obtain the
        device.













                                   22-56
                                                        DEVNAM [CALLI 64]


                             DEVNAM [CALLI 64]                             DEVNAM [CALLI 64]



   Function

        Returns the physical name of a device.

   Calling Sequence

                MOVE     ac,[SIXBIT/device/]  \
                MOVEI    ac,channo            |
                MOVEI    ac,udx               /
                DEVNAM   ac,
                  error return
                normal return

                device        where:  device is the logical device name whose physical name  is
                desired.

                channo                channo is the number of an initialized channel.

                udx                udx is the Universal Device Index for a device.

   Normal Return

        The SIXBIT physical name of the device is returned in the ac.

   Error Return

        If the specified device  does  not  exist  or  if  the  specified
                                        ac        channel is not initialized, the ac is cleared.

   Related Calls

        DEVCHR, DEVLNM, DEVOP., DEVPPN, DEVSIZ, DEVSTS, DEVTYP






























                                   22-57
   DEVOP. [CALLI 171]


                             DEVOP. [CALLI 171]                             DEVOP. [CALLI 171]



   Function

        Performs miscellaneous device functions for  devices  other  than
|       terminals,  tapes,  disks,  or  TSKs.   Use  TRMOP. for  terminal
|       functions, TAPOP.  for tape functions, DISK. for disk  functions,
|       or TSK. for TSK functions.

   Calling Sequence

                MOVE     ac,[XWD length,addr]
                DEVOP.   ac,
                  error return
                normal return
                . . .
        addr:   EXP      fcn-code
                SIXBIT/device/  \
                EXP      channo |
                EXP      udx    /
        addr+2: arglst

                length        where:  length is the length of the argument block.

                addr                addr is the address of the argument block.

                fcn-code                fcn-code is one of the function codes described below.

                device                device is the  SIXBIT  physical  or  logical  name  of  a
                device.

                channo                channo is the number of an initialized channel.

                udx                udx is the Universal Device Index for a device.

                arglst                arglst  begins  the  list  of  arguments  for  the  given
                function.

        All function codes listed below  use  the  2-word  argument  list
        shown  above.   Additionally, some function codes accept a longer
        argument list.  For those codes that accept argument list  longer
        than  2  words,  the  argument  list  format  is  shown  with the
        description of the function code.

        The function codes are defined within the following four ranges:

             0000-0777 Performs a specific action.
             1000-1777 Reads a parameter.
             2000-2777 Sets a parameter.
             3000-3777 Reserved for customer definition.

        The Read/Set function codes are parallel (for  example,  function
        code  1002  reads  a  parameter  and  code  2002  sets  the  same
        parameter).  The symbol .DFSET is equal to 1000, and can be added
        to  the  read  parameter  to  establish  the  offset  for the set
        parameter.  Therefore, to read the  page  counter,  use  function
        .DFPCT.  To set the page counter, use .DFPCT+.DFSET.

                                          ac        The monitor returns values in the ac for the Read functions.





                                   22-58
                                                       DEVOP. [CALLI 171]


        The function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

           1   .DFLLV    Loads the standard vertical forms control unit.

           2   .DFENV    Enables  the  system  to  load  a   non-standard
                         vertical forms control unit.

           3   .DFDVL    Disables  loading  non-standard  vertical  forms
                         control unit.

        4-10             Reserved for use by Digital.

          11   .DFLR2    Loads  a  translation  RAM  into   LP20.    This
                         function  takes  a  4-word  argument list of the
                         form:

                         addr:   .DFLR2
                                 device \
                                 channo |
                                 udx    /
                                 8-bit byte count for RAM
                                 address of RAM buffer

          12   .DFLV2    Loads a VFU through LP20.  This function takes a
                         4-word argument list of the form:

                         addr:   .DFLV2
                                 device \
                                 channo |
                                 udx    /
                                 7-bit byte count of VFU
                                 address of VFU data

          13   .DFMDC    Clears DVCMDA.   This  is  the  flag  indicating
                         whether  the  device  is  controlled  by MDA (in
                         GALAXY Version 4.1 and  later).   This  function
                         requires privileges.

          14   .DFMDS    Sets  DVCMDA.   This  is  the  flag   indicating
                         whether  the  device  is  controlled  by MDA (in
                         GALAXY Version 4.1 and  later).   This  function
                         requires privileges.

        15-777           Reserved for use by Digital.

        1000   .DFPCT    Returns the line printer's page counter  in  the
                         ac                         ac.

        2000             Sets the page counter value in addr+2.  The page
                         counter  is  limited  to  12 bits.  The argument
                         list for .DFPCT is:

                         addr:   .DFPCT
                                 SIXBIT/device/ \
                                 EXP   channo   |
                                 EXP   udx      /
                                 EXP   counter







                                   22-59
   DEVOP. [CALLI 171]


        ____   ______    ________        Code   Symbol    Function

        1002   .DFHCW    Reads the  line  printer  characteristics.   The
                                                                       ac                         printer  characteristics  are returned in the ac
                         in the form:

                         ____   ______    _______                         Bits   Symbol    Meaning

                         0      DF.LCP    Lowercase capability.

                         1      DF.PGC    Has page counter.

                         2                Reserved.

|                        3-5    DF.VFT    Code for type of vertical forms
                                          control  unit  (VFU).  The type
                                          codes are:

                                          ____   ______    ____                                          Code   Symbol    Type

                                            0    .DFVTO    Papertape VFU.
                                            1    .DFVTD    DAVFU.
                                            2    .DFVTN    No VFU.

|                        6-8    DF.TYP    Code for character  set  codes.
                                          The set codes are:

                                          ____   ______    _________ ___                                          Code   Symbol    Character set

                                            0    .DFC64    Set   of    64
                                                           characters.
                                            1    .DFC95    Set   of    95
                                                           characters.
                                            2    .DFC28    Set   of   128
                                                           characters.
                                            3    .DFVAR    Variable  size
                                                           set.

|                        9-11   DF.CLS    Code for  line  printer  class.
                                          The class codes are:

                                          ____   ______    _____                                          Code   Symbol    Class

                                            0    .DFSUK    Unknown.
                                            1    .DFSBX    BA10.
                                            2    .DFSLC    LP100.
                                            3    .DFS20    LP20.
                                            4    .DFSA1    LP11.
                                            5    .DFSA2    LP20.

                         12-14  DF.CLU    Line printer class, as the type
                                          of unit.  The unit codes are:

                                          ____   ______    ____                                          Code   Symbol    Type

                                              0  .DFUUK    Unknown.
                                              1  .DFUFG    LP05-type.
                                              2  .DFULN    LN01-type.

                         18-35  DF.CSN    Character set name, in SIXBIT.






                                   22-60
                                                       DEVOP. [CALLI 171]


        ____   ______    ________        Code   Symbol    Function

        2002             Sets  the  line  printer  characteristics.   The
                         argument list for .DFHCW is:

                         addr:   .DFHCW
                                 SIXBIT/device/ \
                                 EXP   channo   |
                                 EXP   udx      /
                                 EXP   characteristics

                         Defines   the    characteristics    using    the
                         definitions listed above for the Read function.

|       1003   .DFRES    The extended I/O  error  status  for  the  given
                                                   ac                         device is returned in the ac.

                         The error status is returned  as  a  code.   The
                         error codes are:

                         ____   ______    _____                         Code   Symbol    Error

                           1    IOPLE%    Page limit exceeded (LPT).
                           2    IOVFE%    VFU format error (LPT).
                           3    IOLTE%    Label type error (MTA).
                           4    IOHLE%    Header label error (MTA).
                           5    IOTLE%    Trailer label error (MTA).
                           6    IOVLE%    Volume label error (MTA).
                           7    IODER%    Hard device error.
                          10    IOPAR%    Parity error.
                          11    IOWLE%    Write-lock error.
                          12    IOIPO%    Illegal  positioning  operation
                                          (MTA).
                          13    IOBOT%    Beginning of tape (MTA).
                          14    IOIOP%    Illegal operation (MTA).
                          15    IOFNF%    File not found (MTA).
                          16    IOCAN%    Operator    cancelled    volume
                                          switch request (MTA).
                          17    IOTMV%    Too many volumes in volume  set
                                          (MTA).
                          20    IONND%    Network node down.
                          21    IOUNC%    Undefined  character  interrupt
                                          (LP20).
                          22    IORPE%    RAM parity error (LP20).
                          23    IOLRA%    Tape  labelling   request   was
                                          aborted by a RESET UUO (MTA).


        1004   .DFRDS    A  status  code  for  the  specified  device  is
                                         ac                         returned in the ac.

                         The status codes and their meanings are:

                         ___    ______    ______                         Bit    Symbol    Status

|                        0      DF.OFL    Device off-line.
                         34     DF.LLE    DAVFU load-enabled.
                         35     DF.LVE    A VFU error occurred.

                         The bits returned in the left half of the ac are
                         device-independent;  the  bits  returned  in the
                         right half are device-specific.




                                   22-61
   DEVOP. [CALLI 171]


   Normal Return

        The specified function is executed.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

         -1    DFACS%    Address check.
          0    DFIFC%    Illegal function code.
          1    DFPRV%    Not enough privileges.
          2    DFIFD%    Function invalid for device.
          3    DFNLR%    Value out of range.
          4    DFNXD%    Nonexistent device.
          5    DFNDV%    No DAVFU (LPT only).
          6    DFNIA%    Device not initialized.
          7    DFDOL%    Device off-line.
         10    DFCNS%    Page counter not set (LPT only).
         11    DFNPC%    No page counter (LPT only).
         12    DFENI%    Extended error recovery not implemented.
         13    DFNVC%    Non-variable character set.

        If the monitor call has not been implemented on your system,  the
                                                         ac        error return is taken and the monitor leaves the ac unchanged.

   Related Calls

        DEVCHR, DEVLNM, DEVNAM, DEVPPN, DEVSIZ, DEVSTS, DEVTYP




































                                   22-62
                                                        DEVPPN [CALLI 55]


                             DEVPPN [CALLI 55]                             DEVPPN [CALLI 55]



   Function

        Returns the project-programmer number  (PPN)  associated  with  a
        disk  device  or an ersatz device.  Note that the DEVPPN UUO does
        not return SFD names.  It is recommended that  programs  use  the
        PATH. call to return complete directory names.

   Calling Sequence

                MOVE     ac,[SIXBIT/device/]  \
                MOVEI    ac,channo            |
                MOVEI    ac,udx               /
                DEVPPN   ac,
                  error return
                normal return

                device        where:  device is the SIXBIT physical, logical, or ersatz name of
                a disk device.

                channo                channo is a channel number for a disk device.

                udx                udx is the Universal Device Index for a disk device.

   Normal Return

                                                               ac        The PPN for the specified device is returned  in  the  ac.   Note
        that  if  you have enabled /NEW in your search list, the returned
        PPN for SYS will be [1,5] instead of [1,4].

   Error Return

        The error return occurs in two cases.  The cause of the error  is
        indicated by the value returned:

                                       ac         o  If zero is returned in the ac; the device does not exist,  or
            you have not initialized it.

         o  If your own PPN is returned; the device is not a disk device.

   Related Calls

        DEVCHR, DEVLNM, DEVNAM, DEVOP, DEVSIZ, DEVSTS, DEVTYP, PATH.




















                                   22-63
   DEVSIZ [CALLI 101]


                             DEVSIZ [CALLI 101]                             DEVSIZ [CALLI 101]



   Function

        Returns the buffer size and standard  number  of  buffers  for  a
        device.

   Calling Sequence

                MOVEI   ac,addr
                DEVSIZ  ac,
                  error return
                normal return
                . . .
        addr:   EXP    status
                SIXBIT/device/    \
                EXP    channo     |
                EXP    udx        /

                addr        where:  addr is the address of the argument block.  Normally, the
                address  points  to the OPEN block used to initialize the
                device.

                status                status is the I/O  status  word,  which  must  match  the
                information  given  when the channel was initialized with
                INIT, OPEN, or FILOP.

                device                device is the  SIXBIT  physical  or  logical  name  of  a
                device.

                channo                channo is the number of an initialized channel.

                udx                udx is the Universal Device Index for a device.

        Note that the format for the argument block is identical  to  the
        format  used for the OPEN monitor call and that the OPEN block is
        ordinarily used as the DEVSIZ block.  The  number  and  sizes  of
        buffers  differ among different data modes, and depending on mode
        modifier bits.

   Normal Return

            ac        The ac contains the default number of buffers in its  left  half,
        and  the  default  buffer size (including a 3-word header) in its
        right half.  If you specify a device that was initialized in dump
                                     ac        mode, the monitor clears the ac and takes the normal return.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

         -2    DVSIM%    Illegal data mode.
         -1    DVSNX%    Nonexistent device.
          0    DVSDM%    Dump mode specified; therefore, buffer  size  is
                         not applicable.

   Related Calls

        DEVCHR, DEVLNM, DEVNAM, DEVOP., DEVPPN, DEVSTS, DEVTYP



                                   22-64
                                                        DEVSTS [CALLI 54]


                             DEVSTS [CALLI 54]                             DEVSTS [CALLI 54]



   Function

        Returns the device status word from the device data block  (DDB).
        This  call  returns the last CONI performed for the device, which
        is different for each device type and model.   To  interpret  the
        device status word, refer to the hardware manual for the specific
        device.

   Calling Sequence

                MOVE   ac,[SIXBIT/device/]  \
                MOVEI  ac,channo            |
                MOVEI  ac,udx               /
                DEVSTS ac,
                  error return
                normal return

                device        where:  device is the  SIXBIT  physical  or  logical  name  of  a
                device.

                channo                channo is the number of a channel.

                udx                udx is the Universal Device Index for a device.

        You can specify any device on an I/O bus.  Where  multiple  units
        are  on  a  single  controller,  the  status of the controller is
        returned.

   Normal Return

                                                   ac        The device status word is returned in the  ac.   If  the  service
        routine  for  the device does not store a CONI, the returned word
        may be useless.   Devices  having  both  a  controller  and  data
        interrupt store the controller CONI.

   Error Return

                                                                   ac        If the device does not exist or is not  initialized,  the  ac  is
        cleared.

   Related Calls

        DEVCHR, DEVLNM, DEVNAM, DEVOP., DEVPPN, DEVSIZ, DEVTYP

   Common Errors


         o  Confusing  "device  status"  (DEVSTS)   with   "I/O   status"
            (GETSTS).   GETSTS  returns the file (I/O) status bits, which
            are documented in Volume  1.   DEVSTS  returns  the  hardware
            device status.

         o  Confusing the "device status" returned by DEVSTS with the I/O
            error status that is returned by the DEVOP. UUO.








                                   22-65
   DEVTYP [CALLI 53]


                             DEVTYP [CALLI 53]                             DEVTYP [CALLI 53]



   Function

        Returns the physical properties for a device.

   Calling Sequence

                MOVE   ac,[SIXBIT/device/]  \
                MOVEI  ac,channo            |
                MOVEI  ac,udx               /
                DEVTYP ac,
                  error return
                normal return

                device        where:  device is the  SIXBIT  physical  or  logical  name  of  a
                device.

                channo                channo is the number of an initialized channel.

                udx                udx is the Universal Device Index for a device.

   Normal Return

               ac        If the ac is 0, there was no such device; otherwise,  the  device
                                      ac        type bits are returned in the ac as follows:

        ____   ______    ______________        Bits   Symbol    Characteristic

           0   TY.MAN    Directory device; a LOOKUP/ENTER is mandatory.

         1-7             Reserved.

           8   TY.GEN    If the argument is a SIXBIT name,  this  bit  is
                         set if the device is generic.

           9   TY.MDA    Controlled by MDA (mountable device allocator).

          10   TY.EHF    Extended hardware features;  for  example,  this
                         bit  is  set  for  a line printer with lowercase
                         capability.

          11   TY.MPX    MPX-controllable.

          12   TY.AVL    Available to your job.

          13   TY.SPL    Spooled.

          14   TY.INT    Interactive; there is output  after  each  break
                         character.

          15   TY.VAR    Capable of variable buffer size.

          16   TY.IN     Input capability.

          17   TY.OUT    Output capability.

       18-26   TY.JOB    Job number to  which  the  device  is  currently
                         assigned.

       27-28             Reserved.



                                   22-66
                                                        DEVTYP [CALLI 53]


        ____   ______    ______________        Bits   Symbol    Characteristic

          29   TY.RAS    Restricted; assigned only to privileged  job  or
                         by MOUNT command.

       30-35   TY.DEV    One of the following device type codes:

                         ____   ______    ______ ____                         Code   Symbol    Device Type

                           0    .TYDSK    Disk.
                           1    .TYDTA    DECtape.
                           2    .TYMTA    Magnetic tape.
                           3    .TYTTY    Terminal.
                           4    .TYPTR    Papertape reader.
                           5    .TYPTP    Papertape punch.
                           6    .TYDIS    Display unit.
                           7    .TYLPT    Line printer.
                          10    .TYCDR    Card reader.
                          11    .TYCDP    Card punch.
                          12    .TYPTY    Pseudo-terminal.
                          13    .TYPLT    Plotter.
                          14    .TYEXT    External task.
                          15    .TYMPX    MPX-controlled.
                          16    .TYPAR    PA611R on a DC44.
                          17    .TYPCR    PC11(R) on a DC44.
                          20    .TYPAP    PA611P on a DC44.
                          21    .TYLPC    LPC-11 on a DC44.
                          22    .TYPCP    PC-11(P) on a DC11.
                          23    .TYWTY    WTY device on a DC11.
                          24    .TYTSK    Network task.
                          25    .TYD78    DAS78 device.
                          26    .TYRDA    Remote data entry device.
                          27    .TYMCR    Monitor   command   interpreter
                                          (MCR) device.
                          30    .TYDRA    DTR01/DR01 device.
                          31    .TYKDP    KMC/DUP interface.
                          32    .TYDTE    DTE interface.
                          33    .TYDDP    DDP device.
                          34    .TYDMR    DMR device.
|                         35    .TYRX2    RX02 floppy disk controller.
|                        36-57            Reserved for use by DIGITAL.
                         60-77            Reserved for use by customers.

   Error Return

        The DEVTYP monitor call should never take the error return.

   Related Calls

        DEVCHR, DEVLNM, DEVNAM, DEVOP., DEVPPN, DEVSIZ, DEVSTS

   Common Errors

        Assuming that a normal return indicates that the device exists.












                                   22-67
   DIAG. [CALLI 163]


                             DIAG. [CALLI 163]                             DIAG. [CALLI 163]



   Function

        Provides diagnostic functions for devices and CPUs.

   Calling Sequence

|               MOVE   ac,[-len,,addr]
                DIAG.  ac,
                  error return
                normal return
                  . . .
        addr:   fcn-code
                argument

                len        where:  len is the length of the argument list.

                addr                addr is the address of the argument list.

                fcn-code                fcn-code is one of the function codes listed below.

                argument                argument is different for each function code;  each  type
                of argument is described with its function code below.

        ____   ______    _______        Code   Symbol    Meaning

        0-6              Reserved for use by DIGITAL.

          7    .DIAKU    Returns the controller and unit  numbers  for  a
                         device.  The format of the argument list is:

                              addr:  EXP .DIAKU
                                     SIXBIT/device/

                         On a normal return, the controller  device  code
                                                                   ac                         will  be returned in the left half of the ac and
                         the unit number will be returned  in  the  right
                         half.

         10    .DIACS    Forces a CPU status block  read  on  a  CPU  and
                         forces  DAEMON  to make an error entry (code 63)
                         in ERROR.SYS.  (The error codes and entry  types
                         are  listed with the DAEMON call.) This function
                         requires that you have JP.POK, [1,2],  or  JACCT
                         privileges.  The format of the argument list is:

                              addr:  EXP .DIACS
                                     EXP CPU-number

         11    .DIADS    Reads the device status for all devices  on  the
                         specified CPU into a GETTAB table in the monitor
                         and forces DAEMON to make an error  entry  (code
                         64)  in  ERROR.SYS.   (The error codes and entry
                         types are listed with  the  DAEMON  call.)  This
                         function  requires  that you have JP.POK, [1,2],
                         or  JACCT  privileges.   The  format   for   the
                         argument list is:

                              addr:  EXP .DIADS
                                     EXP CPU-number



                                   22-68
                                                        DIAG. [CALLI 163]


        ____   ______    _______        Code   Symbol    Meaning

         13    .DIANL    Enables  and  disables   automatic   reload   of
                         microcode in DX20 when the DX20 fails.

                              addr:  EXP .DIANL
                                     EXP flag,CPUn

                                   flag                         where the flag specifies the action and CPUn  is
                         the  CPU number.  If flag=0, automatic reloading
                         of the DX20 is enabled.  A  non-zero  value  for
                         the  flag  disables auto-reload.  The CPU number
                         can be -1 to indicate all CPUs.

|        15    .DIASM    Seizes    the    specified     magnetic     tape
|                        controller(s).   The  argument list is formatted
|                        as:
|  
|                             addr:  EXP .DIASM
|                                    SIXBIT/device/
|  
|                        /device/ may be either a device name, or zero to
|                        indicate all units.
|  
|        16    .DIARM    Releases    the    specified    magnetic    tape
|                        controllers.  The argument list is formatted as:
|  
|                             addr:  EXP .DIARM
|                                    SIXBIT/device/
|  
|                        /device/ may be either a device name, or zero to
|                        indicate all units.
|  
|       107    .DIACC    Manipulates the CI port counters.  The format of
|                        the argument list is:
|  
|                             addr:  EXP CPUno,, .DIACC
|                                    EXP channo,,sub-ftn
|  
|                        The  only  valid  channel  number  is  7.    The
|                        counters are manipulated in the manner indicated
|                        in the sub-function.  Valid sub-functions are:
|  
                              ____    ________|                             Code    Function
|  
|                               0     Gets counters.
|                               1     Releases counters.
|                               2     Points to counters.
|                               3     Reads counters.
|  
|       111    .DIACI    Enables or disables the CI.  The  argument  list
|                        is formatted as:
|  
|                             addr:  CPUno,, .DIACI
|                                    channo
|                                    flag
|  
|                        The only valid value for channel  number  is  7.
|                        Flag  indicates  whether  .DIACI  will enable or
|                        disable the CI.  When the flag  value  is  zero,
|                        the  CI  is set off line.  A non-zero flag value
|                        sets the CI on line.

   Normal Return


                                   22-69
   DIAG. [CALLI 163]


        The specified function has been performed.

   Error Return

            ac        The ac is unchanged if the DIAG.  monitor call is not implemented
        on  the  system.   Otherwise, one of the following error codes is
        returned in the ac:

        ____   ______    _______        Code   Symbol    Meaning

          1    DIANP%    Not enough privileges.
          2    DIAIA%    Illegal number of arguments.
          3    DIAIC%    Illegal controller number.
          4    DIAIU%    Illegal unit number.
          5    DIAAA%    Some units already assigned.
          6    DIADM%    Unit not in diagnostic mode.
          7    DIAAJ%    Unit assigned to another job.
         10    DIAFC%    Not enough free core.
         11    DIAAU%    No assigned units.
         12    DIACP%    IOWD crosses page boundary.
         13    DIAIF%    Illegal function.
         14    DIAVC%    Job must not be virtual.
         15    DIANC%    No such CPU.
         16    DIANR%    CPU not running.
         17    DIABA%    Invalid argument list.
|        20    DIACI%    No CI port on specified CPU.
|        21    DIATO%    The Read Port Counters function timed out.
|        22    DIANK%    No NI port on specified CPU.






































                                   22-70
                                                        DISK. [CALLI 121]


                             DISK. [CALLI 121]                             DISK. [CALLI 121]



   Function

        Performs miscellaneous disk functions.

   Calling Sequence

                MOVE   ac,[XWD fcn-code,addr]
                DISK.  ac,
                  error return
                normal return

                fcn-code        where:  fcn-code is one of the function codes described below.

                addr                addr is the address of the argument list.  Each  function
                code  requires a different argument list.  Therefore, the
                argument lists are described below, with the  appropriate
                function codes.

   Normal Return

        On a successful return from the call, the function you  specified
                                              ac        is  accomplished,  and  neither  the  ac nor the argument list is
        affected.

   Error Return

        Each function can produce its own set of error codes on an  error
        return  from  the DISK.  call.  The error code is returned in the
        ac        ac.   A  negative  error  code   is   one   of   the   following,
        general-purpose error codes:

        ____   ______    _______        Code   Symbol    Meaning

         -2    DUINP%    Not enough privileges to perform the function.
         -1    DUILF%    Illegal function requested.

        A positive error code indicates an error that is specific to  the
                             ac        function  code.  The ac is unchanged if DISK.  is not implemented
        on your system.  In the argument lists described below:

                device                device is the  SIXBIT  physical  or  logical  name  of  a
                device.

                channo                channo is the number of an initialized channel.

                udx                udx is the Universal Device Index for a device.

                structure                structure is the SIXBIT name of a file structure.














                                   22-71
   DISK. [CALLI 121]


        The function codes, their meanings,  argument  lists,  and  error
        codes are:

        ____   ______    ________        Code   Symbol    Function

          0    .DUPRI    Sets the disk priority level.  The argument list
                         for .DUPRI is:

                         addr:   XWD     channo,priority

|                        where:    channo  is  an   initialized   channel
                         number.  You can use -2 to indicate all channels
                         for  the  job,  or   -1   for   all   explicitly
                         initialized channels for this job.

                         priority                         priority is in the range -3 to +3 (0  is  normal
                         priority and +3 is the highest priority).

                         If you set  the  priority  for  a  channel,  the
                         setting  overrides  the setting for the job, and
                         remains in effect until you change it or release
                         the channel.

                         If you set the priority for the entire job,  the
                         setting  remains  in  effect until you change it
                         with another DISK. call or  with  a  SET  DSKPRI
                         monitor command.

                         The maximum priority level you can use for  your
                         job  is  stored  in bits 1 and 2 (JP.DPR) of the
                         job privilege table (GETTAB table 6, .GTPRV).

                         On an error return from this  function,  one  of
                         the  following  error codes may be stored in the
                         ac                         ac:

                         ____    ______  _______                         Code    Symbol  Meaning

                         1       DUPIP%  Priority higher than JP.DPR.
                         2       DUPNO%  Channel not initialized.
                         3       DUPIA%  Illegal channel number or code.

          1    .DUSEM    Sets PDP-10/PDP-11 compatibility mode (22-sector
|                        mode  on the RP04/RP06) for the channel.  .DUSEM
                         is a privileged function.  The argument list for
                         .DUSEM is:

                         addr:     EXP   channo

                         On an error return from this  function,  one  of
                         the following error codes may be returned in the
                         ac                         ac:

                         ____    ______  _______                         Code    Symbol  Meaning

                         1       DUSID%  Illegal device.
                         2       DUSCM%  The  device  does  not   support
                                         22-sector mode.








                                   22-72
                                                        DISK. [CALLI 121]


        ____   ______    ________        Code   Symbol    Function

          2    .DUSTM    Clears PDP-10/PDP-11 compatibility mode.  .DUSTM
                         is a privileged function.  The argument list for
                         .DUSTM is:

                         addr:     EXP   channo

                         On an error return from this  function,  one  of
                         the  following  error  codes may be retunrned in
                             ac                         the ac:

                         ____    ______  _______                         Code    Symbol  Meaning

                         1       DUSID%  Illegal device.
                         2       DUSCM%  The  device  does  not   support
                                         22-sector mode.

          3    .DUUNL    Unloads an RP04 or  RP06  drive.   .DUUNL  is  a
                         privileged  function.   The  argument  list  for
                         .DUUNL is:

                         addr:   SIXBIT/device/

                               device                         where device is the name  of  a  specific  unit,
                         such as RPA0.

                         On an error return from this  function,  one  of
                         the following error codes may be returned in the
                         ac                         ac:

                         ____    ______  _______                         Code    Symbol  Meaning

                         1       DUUIU%  Illegal unit name.
                         2       DUUNI%  Structure  is  illegal  or   not
                                         available.
                         3       DUUNU%  Device cannot be unloaded.

          4    .DUOLS    Takes a controller/channel off-line  soon.   The
                         monitor  will  continue I/O that is in progress,
                         but will not use  the  controller  for  new  I/O
                         requests.  .DUOLS is a privileged function.  The
                         argument list for .DUOLS is:

                         addr:   SIXBIT/controller/

                                controller                         where  controller  is  the  name   of   a   disk
                         controller, such as RPA.

                         On an error return from this  function,  one  of
                         the following error codes may be returned in the
                         ac                         ac:

                         ____    ______  _______                         Code    Symbol  Meaning

                         1       DUOIP%  Specified controller/channel  is
                                         being put off-line.
                         2       DUOSK%  Nonexistent controller.
                         3       DUOSS%  If controller were set off-line,
                                         there   would   not   be  enough
                                         swapping space.
                         4       DUOIS%  Unit in structure cannot be  set
                                         off-line.
                         5       DUOES%  Not enough space for IOWDs.
|                        6       DUOPI%  Unit cannot be  removed  because

                                   22-73
   DISK. [CALLI 121]


|                                        it contains IPCF pages.

































































                                   22-74
                                                        DISK. [CALLI 121]


        ____   ______    ________        Code   Symbol    Function

          5    .DUOLN    Takes a controller/channel  off-line  now.   The
                         monitor stops current I/O on that controller and
                         will  not  use  the  controller  for   new   I/O
                         requests.  .DUOLN is a privileged function.  The
                         argument list for .DUOLN is:

                         addr:   SIXBIT/controller/

                         On an error return from this  function,  one  of
                         the following error codes may be returned in the
                         ac                         ac:

                         ____    ______  _______                         Code    Symbol  Meaning

                         1       DUOIP%  Specified controller/channel  is
                                         being put off-line.
                         2       DUOSK%  Nonexistent controller.
                         3       DUOSS%  If controller were set off-line,
                                         there   would   not   be  enough
                                         swapping space.
                         4       DUOIS%  Unit in structure cannot be  set
                                         off-line.
                         5       DUOES%  Not enough space for IOWDs.
|                        6       DJOPI%  Unit cannot be  removed  because
|                                        it contains IPCF pages.

          6    .DUONL    Puts   a   controller/channel   on-line.    This
                         function makes the controller available for I/O.
                         .DUONL is a privileged function.   The  argument
                         list for .DUONL is:

                         addr:   SIXBIT/controller/

                         On an error return from this  function,  one  of
                         the following error codes may be returned in the
                         ac                         ac:

                         ____    ______  _______                         Code    Symbol  Meaning

                         1       DUOIP%  Specified controller/channel  is
                                         being put off-line.
                         2       DUOSK%  Nonexistent controller.
                         3       DUOSS%  If controller were set off-line,
                                         there   would   not   be  enough
                                         swapping space.
                         4       DUOIS%  Unit in structure cannot be  set
                                         off-line.
                         5       DUOES%  Not enough space for IOWDs.
|                        6       DJOPI%  Unit cannot be  removed  because
|                                        it contains IPCF pages.

          7    .DUUFD    Sets call for UFD compressor.  The argument list
                         for .DUUFD is:

                         addr:   EXP channo

                         where channo specifies a channel on which a file
                         is  open.  The UFD in which the file exists will
                         be compressed.

                         This function does not force the compression  to
                         take place immediately, but sets the compression
                         to be performed on the next output CLOSE  for  a

                                   22-75
   DISK. [CALLI 121]


                         file  in  this UFD.  By default, the compression
                         is performed on an  output  CLOSE  only  if  the
                         directory contains an empty block.































































                                   22-76
                                                        DISK. [CALLI 121]


        ____   ______    ________        Code   Symbol    Function

         10    .DUSWP    Removes a disk unit  from  the  active  swapping
                         list.   .DUSWP  is  a  privileged function.  The
                         argument list for .DUSWP is:

                         addr:   SIXBIT/device/

                         On an error return from this  function,  one  of
                         the following error codes may be returned in the
                         ac                         ac:

                         ____    ______  _______                         Code    Symbol  Meaning

                         1       DUOIP%  Specified controller/channel  is
                                         being put off-line.
                         2       DUOSK%  Nonexistent controller.
                         3       DUOSS%  If controller were set off-line,
                                         there   would   not   be  enough
                                         swapping space.
                         4       DUOIS%  Unit in structure cannot be  set
                                         off-line.
                         5       DUOES%  Not enough space for IOWDs.
|                        6       DUOPI%  Unit cannot be  removed  because
|                                        it contains IPCF pages.

         11    .DUASW    Adds a disk unit to the  active  swapping  list.
                         .DUASW  is  a privileged function.  The argument
                         list for .DUASW is:

                         addr:  SIXBIT/device/

                         On an error return from this  function,  one  of
                         the following error codes may be returned in the
                         ac                         ac:

                         ____    ______  _______                         Code    Symbol  Meaning

                         1       DUANU%  No such unit.
                         2       DUAAI%  Unit already in active  swapping
                                         list.
                         3       DUASF%  SWPTAB is full.
                         4       DUAN4%  This error code is obsolete.
                         5       DUANS%  No swapping space (SWAP.SYS)  on
                                         pack.

         12    .DUASD    Adds a structure to the system dump  list.   The
                         argument list for .DUASD is:

                         addr:   SIXBIT/structure/

                         On an error return from this  function,  one  of
                         the following error codes may be returned in the
                         ac                         ac:

                         ____    ______  _______                         Code    Symbol  Meaning

                         1       DUDND%  No such structure.
                         2       DUDNC%  No crash space on structure.
                         3       DUDAD%  Structure already on system dump
                                         list.
                         4       DUDDF%  System dump list full.




                                   22-77
   DISK. [CALLI 121]


        ____   ______    ________        Code   Symbol    Function

         13    .DURSD    Removes a structure from the system  dump  list.
                         The argument list for .DURSD is:

                         addr:   SIXBIT/structure/

                         On an  error  return  from  this  function,  the
                                                                     ac                         following error code may be returned in the ac:

                         ____    ______  _______                         Code    Symbol  Meaning

                         1       DUDNS%  Structure  not  in  system  dump
                                         list.

         14    .DULEN    Returns the number of written blocks in the file
                            ac                         in ac.  The argument list for .DULEN is:

                         addr:  EXP channo

         15    .DUCLM    Clears MDA wait for  the  specified  unit.   The
                         argument list for .DUCLM is:

                         addr:   SIXBIT/device/

                         This function is used by the  GALAXY  batch  and
                         spooling  system  and  requires  [1,2]  or JACCT
                         privileges.

         16    .DUFRE    Returns the amount of free space in a given  UFD
                         before  the  logged  in quota is exhausted.  The
                         argument list for .DUFRE is:

                         addr:   SIXBIT/structure/
                                 XWD p,pn

                         If there is no job logged in with the  specified
                         PPN,  the normal return is taken with bit 0 set.
                         This bit setting is returned by the DSKCHR call,
                         when DC.NPA is returned in .DCUFT (arg+1).  This
                         signifies  the  fact  that  the  quota  is   not
                         available.

                         On an  error  return  from  this  function,  the
                                                                     ac                         following error code may be returned in the ac:

                         ____    ______  _______                         Code    Symbol  Meaning

                         1       DUFND%  No such structure.

   Related Calls

        DSKCHR













                                   22-78
                                                        DNET. [CALLI 207]


                             DNET. [CALLI 207]                             DNET. [CALLI 207]



   Function

|       Obtains information about DECnet network nodes and environment in
|       your  network  area only.  This monitor call is for use in system
|       programs associated with DECnet-10 Versions 3.0 and 4.0.

   Calling Sequence

|               XMOVEI  ac,addr
                DNET.   ac,
                  error return
                normal return
        addr:   argument list

                addr        where:  addr is the address of the argument list.  Each  function
                code  requires a different argument list.  The first word
                of every argument list (.DNFFL)  contains  the  following
                information in the following bit fields:

                addr:  flags+fcn-code,,len

                      flags                where flags (DN.FLA) are:

                ___      ______   _______                Bit      Symbol   Meaning

                0        DN.FLS   Used   with   functions   that   return
                                  information  about  single  entities (a
                                  node  or  link).   Indicates  that  the
                                  function  should step through the list,
                                  returning information  about  the  next
                                  entity in the list.

                1        DN.FLK   List  information  only   about   known
                                  nodes.

                2        DN.FLR   List  information  only  about   active
                                  (reachable) nodes.

                3        DN.FLE   List information  only  about  EXECUTOR
                                                         _________ ______                                  nodes.   Refer  to the DECnet-10 User's
                                  _____                                  Guide for more information.

        The function codes and argument lists are described below:

        ____   ______    _______        Code   Symbol    Meaning

        1      .DNLNN    Lists node names.  You specify the following  at
                         addr:

                         addr:   flag+<.DNLNN,,length>
                                 BLOCK length-1

                         You must include one of the following flags:

                         ___     ______  _______                         Bit     Symbol  Meaning

                          1      DN.FLK  List known nodes.
                          2      DN.FLR  List active nodes.
                          3      DN.FLE  List EXECUTOR nodes.



                                   22-79
   DNET. [CALLI 207]


                              length                         And  length  is  the  length  of  the  block  to
                         reserve.

                         The monitor returns the  argument  list  in  the
                         following form:

                         ______  ______  ________                         Offset  Symbol  Contents

                          1      .DNCNT  Number of node names returned in
                                         the list.

                          2      .DNNMS  First node name

                          3       . . .  Second node name

                                  . . .

        2      .DNNDI    Returns information about a node.   You  specify
                                          addr:                         the following at addr:

                         addr:   flag+<.DNNDI,,length>
                                 node-name
                                 BLOCK length-2

                         You must include one of the following flags:

                         ___     ______  _______                         Bit     Symbol  Meaning

                          0      DN.FLS  Step through list of nodes.   If
                                         you  set  this flag, you must be
                                         sure that addr+1 will contain  0
                                         on  the  first call, to start at
                                         the first node in the node list.
                                         The    nodes   are   listed   in
                                         numerical order, by address.
                          1      DN.FLK  List only known nodes.
                          2      DN.FLR  List only active nodes.
                          3      DN.FLE  List only EXECUTOR nodes.

                             length                         And length is the length of the  argument  block
                         returned.   If  you  do not specify step mode by
                                                                node-name                         setting DN.FLS, you must specify  the  node-name
                         in addr+1.

                         The monitor returns the  argument  list  in  the
                         following form:

                         ______  ______  ________                         Offset  Symbol  Contents

                          1      .DNNAM  Node name.

                          2      .DNRTR  Router   information,   in   the
                                         following format:

                                         Bit 0 (DN.RCH)  is  set  if  the
                                         node is reachable.

                                         Bits 1-17 (DN.HOP)  contain  the
                                         number  of hops to the specified
                                         node.

                                         Bits 18-35 (DN.CST) contain  the
                                         cost   of   the   path   to  the
                                         specified node.


                                   22-80
                                                        DNET. [CALLI 207]


                         ______  ______  ________                         Offset  Symbol  Contents

                          3      .DNLLI  Link   information,    in    the
                                         following format:

                                         Bit 0 (DN.VLD) is on if the word
                                         contains valid information.

                                         Bits 1-17 (DN.LNK)  contain  the
                                         number  of  active  links to the
                                         node.

                                         Bits 18-35 (DN.DLY) contain  the
                                         message delay time to the node.

                          4      .DNADR  Node address.

                          5-10   DNCKT   Circuit  name,  up  to  4  ASCIZ
                                         words.   This string may contain
                                         up to 16 characters.

        3      .DNSLS    Shows  link  status.   You  must   specify   the
                         following at addr:

                         addr:   DN.FLS+<.DNSLS,,length>
                                 jobno,,channo

                         where the flag DN.FLS (step through  node  list)
                                            length                         is  optional,  and length is the number of words
                         reserved for the returned argument list.  If you
                         set  DN.FLS,  be  sure  that  addr+1 is 0 on the
                         first call, so that the information is  returned
                         starting at the first node in the node list.

                         The monitor returns the  argument  list  in  the
                         following form:

                         ______  ______  ________                         Offset  Symbol  Contents

                          1      .DNJCN  Currently displayed  job  number
                                         and link number.

                          2      .DNNOD  Remote node name, in SIXBIT.

                          3      .DNOBJ  Object  types,  where  the  left
                                         half   (DN.DOB)   contains   the
                                         destination object type, and the
                                         right half (DN.SOB) contains the
                                         source object type.

                          4      .DNSTA  Status word.  The left  half  of
                                         this  word (DN.LSW) contains the
                                         status  variable  bits  and  the
                                         link  status code.  The variable
                                         bits are:

                                         ___   ______   _______                                         Bit   Symbol   Meaning

                                          0    NS.IDA   Interrupt data is
                                                        available.
                                          1    NS.IDR   Interrupt    data
                                                        may be sent.




                                   22-81
   DNET. [CALLI 207]


                                         ___   ______   _______                                         Bit   Symbol   Meaning

                                          2    NS.NDA   Normal  data   is
                                                        available.
                                          3    NS.NDR   Normal  data  may
                                                        be sent.

                                         The remainder of the  left  half
                                         contains    a    numeric    code
                                         associated with the symbol  that
                                         is stored in the right half.

                                         The  right  half  of  this  word
                                         (DN.STA)   contains   a   SIXBIT
                                         symbol representing  the  status
                                         of  the  link.  The status codes
                                         and  associated  SIXBIT  symbols
                                         are:

                                         ____  ______   _____                                         Code  Symbol   State

                                           1    CW      Connect wait.
                                           2    CR      Connect   message
                                                        received.
                                           3    CS      Connect   message
                                                        sent.
                                           4    RJ      Remote       task
                                                        rejected  connect
                                                        initiation
                                                        message.
                                           5    RN      Link  is  up  and
                                                        running.
                                           6    DR      Disconnect
                                                        message received.
                                           7    DS      Disconnect
                                                        message sent.
                                          10    DC      Disconnect
                                                        message  has been
                                                        confirmed.
                                          11    CF      No confidence  in
                                                        link.
                                          12    LK      No link exists.
                                          13    CM      No  communication
                                                        has taken place.
                                          14    NR      No      resources
                                                        exist.

                          5      .DNQUO  Quota word, where the left  half
                                         (DN.IQT)   contains   the  input
                                         quota,  and   the   right   half
                                         (DN.OQT)   contains  the  output
                                         quota.

                          6      .DNSEG  Segment size.

                          7      .DNFLO  Flow control option,  where  the
                                         left  half (DN.XMF) contains the
                                         flow  control  option  used  for
                                         transmission, and the right half
                                         (DN.RCF)   contains   the   flow
                                         control    option    used    for
                                         receiving messages.




                                   22-82
                                                        DNET. [CALLI 207]


                       ______  ______  ________                       Offset  Symbol  Contents

                       10      .DNMSG  Message count word, where the left
                                       half  (DN.MRC) contains the number
                                       of  messages  received,  and   the
                                       right  half  (DN.MXM) contains the
                                       number of messages transmitted.

                       11      .DNMPR  Monitor process word.  If the  job
                                       number  at  .DNJCN  is -1, this is
                                       the terminal  number  that  NRTSER
                                       has been given for this particular
                                       link.  This word is 0 for any  job
                                       number other than -1.

   Error Return

        On an error, one of the following error codes is returned in  the
        ac        ac:

        ____   ______   _____        Code   Symbol   Error

         1     DNADE%   Address error.
         2     DNWNA%   Wrong number of arguments.
         3     DNIDN%   Illegal job number.
         4     DNFNE%   Illegal function number.
         5     DNILF%   Illegal flag set.
         6     DNNSN%   No such node name.
         7     DNNSC%   No such channel.

   Normal Return

|       If DECnet-10 Version 3 or 4 is  included  in  your  monitor,  the
        normal  return  is  taken  for  every  DNET.  call except when it
        reaches the end of the  node  list  while  returning  information
        about nodes in the list.

   Example

        The following example shows the programming sequence used to list
|       known  nodes,  up  to  the specified length, starting at location
        DNARG.

                MOVE    T1,[DN.FLK+<.DNLNN,,100>]
                MOVEM   T1,DNARG
                MOVEI   T1,DNARG
                DNET.   T1,
                  HALT                ;Error return
        DNARG:  BLOCK   100

        On a normal  return,  the  argument  block  is  filled  with  the
        following information:

        DNARG:  DN.FLK!<.DNLNN,,100>  ;Fcn-code+flags
                20                    ;Number of nodes
                SIXBIT/ONE/           ;Node names
                SIXBIT/TWO/
                SIXBIT/THREE/
                SIXBIT/KL1026/
                SIXBIT/JINX/
                SIXBIT/GNOME/
                .
                .
                .


                                   22-83
   DSKCHR [CALLI 45]


                             DSKCHR [CALLI 45]                             DSKCHR [CALLI 45]



   Function

        Returns  the   characteristics   of   a   disk   device.    These
        characteristics are needed to allocate storage efficiently on the
        disk.

   Calling Sequence

                MOVE      ac,[XWD len,addr]
                DSKCHR    ac,
                  error return
                normal return
                . . .
        addr:   SIXBIT/name/
                BLOCK     len-1

                name        where:  name is the SIXBIT name of a file structure, a controller
                type,  a  controller,  a logical unit, a physical unit, a
                                                                      len                physical device, or a channel number.  The value  of  len
                is the number of words in the argument list.

                If more than one unit was specified, the monitor  returns
                              ac                values in the ac and the argument block, pertinent to the
                first unit specified.  If more than  one  file  structure
                                                                   ac                was  specified,  the monitor returns values in the ac and
                argument block, pertinent to the first unit on the  first
                file structure.

   Normal Return

        On a successful return, the disk characteristics are returned  in
        addr+1            addr+<length-1>        addr+1   through  addr+<length-1>,  and  disk  status  flags  are
                        ac        returned in the ac.  For a complete  list  of  I/O  status  bits,
        refer to Chapter 11.

        The contents of the returned argument block are:

        ______ ______    ________        Offset Symbol    Contents

          0    .DCNAM    The argument supplied for the call.  This is the
                         only  word  in  the argument block that the user
                         program supplies.  The .DCNAM argument may be  a
                         channel number.

          1    .DCUFT    The number of blocks left in  your  job's  quota
                         before  the  UFD is exhausted.  If this value is
                         negative (DC.NPA==1B0), the  UFD  has  not  been
                         accessed  since the job logged in, and the quota
                         is not available.  To  obtain  this  information
                         for  jobs  other  than  your own, use the .DUFRE
                         function of the DISK. UUO.

          2    .DCFCT    The number of  first-come,  first-served  blocks
                         available to all users.

          3    .DCUNT    The number of blocks available to all  users  on
                         this file structure.

          4    .DCSNM    SIXBIT name of the structure to which this  unit
                         belongs.


                                   22-84
                                                        DSKCHR [CALLI 45]


        ______ ______    ________        Offset Symbol    Contents

          5    .DCUCH    The size characteristics:

                         ____    ______  _______                         Bits    Symbol  Meaning

                         0-8     DC.UCC  Number of blocks per cluster.
                         9-17    DC.UCT  Number of blocks per track.
                         18-35   DC.UCY  Number of blocks per cylinder.

          6    .DCUSZ    Number of 128-word blocks on the unit.

          7    .DCSMT    Mount count for the structure.   This  count  is
                         the  number  of  jobs  that  performed  a  MOUNT
                         command  for   this   file   structure   without
                         executing  a  DISMOUNT command.  Note that LOGIN
                         performs an implied MOUNT of all  structures  in
                         DSK, the default job search list.

         10    .DCWPS    Number of words per SAT block.

         11    .DCSPU    Number of SAT blocks for each unit.

         12    .DCK4S    Space (in K) allocated for swapping.

         13    .DCSAJ    Mount word for the structure:

                         _____   _______                         Value   Meaning

                         0,,0    No job or more  than  one  job  has  the
                                 structure mounted.
                                                  n                         -1,,n   One job (number  n)  has  the  structure
                                 mounted   and   the   structure  is  not
                                 single-access.
                                                  n                         0,,n    One job (number  n)  has  the  structure
                                 mounted    and    the    structure    is
                                 single-access.

         14    .DCULN    SIXBIT logical name of the unit.

         15    .DCUPN    SIXBIT physical name of the unit.

         16    .DCUID    SIXBIT identification of the unit.

         17    .DCUFS    First logical block to be used for swapping.

         20    .DCBUM    Number of blocks per unit (including maintenance
                         cylinders).

         21    .DCCYL    Current cylinder number.

         22    .DCBUC    Number   of   blocks   per   unit   in    PDP-11
                         compatibility mode.

         23    .DCLPQ    Length of the position wait queue.

         24    .DCLTQ    Length of the transfer wait queue.

         25    .DCALT    Unit name for alternate port.

         26    .DCOWN    Owner PPN of structure.

         27    .DCPAS    Position in active swapping list if argument was
                         a physical unit; -1 if not in list.


                                   22-85
   DSKCHR [CALLI 45]


        ______ ______    ________        Offset Symbol    Contents

         30    .DCPSD    Position in system dump list if argument  was  a
                         structure; -1 if not in list.

         31    .DCBSC    Blocks per super-cluster.

|        32    .DCXCH    The extended unit characteristics:
|  
                         ____    ______  _______|                        Bits    Symbol  Meaning
|  
|                        0-8     DC.XCC  Data channel number
|                        9-17    DC.XCK  Unit controller number
|                        18-26   DC.XCU  Physical unit number
|                        27-35   DC.XCA  Bit  mask  of  accessible   CPUs
|                                        (1B35=CPU0, 1B34=CPU1, etc.)
|  
|        33    .DCDET    Name of the alternate port.  The port  does  not
|                        have to be attached.
|  
|        34    .DCNUS    The name of the next unit in the specified  file
|                        structure.
|  
|        35    .DCBRC    Count of blocks read by buffered I/O.
|  
|        36    .DCBWC    Count of blocks written by buffered I/O.
|  
|        37    .DCDRC    Count of blocks read by dump I/O.
|  
|        40    .DCDWC    Count of blocks written by dump I/O.
|  
|        41    .DCMRC    Count of blocks read by monitor I/O.
|  
|        42    .DCMWC    Count of blocks written by monitor I/O.
|  
|        43    .DCSRC    Count of blocks read by swap I/O.
|  
|        44    .DCSWC    Count of blocks written by swap I/O.
|  
|        45    .DCPRC    Count of blocks read by paging I/O.
|  
|        46    .DCPWC    Count of blocks written by paging I/O.
|  
|        47    .DCFKS    Remaining swap space.
|  
|        50    .DCCBK    Count of disk cache blocks in use.
|  
|        51    .DCCRC    Count of disk cache read calls.
|  
|        52    .DCCRH    Count of disk cache read hits.
|  
|        53    .DCCWC    Count of disk cache write calls.
|  
|        54    .DCCWH    Count of disk cache write hits.
|  
|        55    .DCSDV    Count of soft device/search errors.
|  
|        56    .DCSDT    Count of soft data errors.
|  
|        57    .DCHDV    Count of hard device/search errors.
|  
|        60    .DCHDT    Count of hard data errors.
|  
|        61    .DCECT    Count of retries on last error.


                                   22-86
                                                        DSKCHR [CALLI 45]


|        62    .DCSER    Count of SAT errors.
|  
|        63    .DCRER    Count of RIB errors.
|  
|        64    .DCCER    Count of software checksum/consistency errors.
|  
|        65    .DCHBN    Logical  block  number  of  last  error  (within
|                        unit).
|  
|        66    .DCERR    Last error status.
|  
|        67    .DCSDF    Last error status.
|  
|        70    .DCHDI    Last error status.
|  
|        71    .DCSDI    Last error status.
|  
|        72    .DCNHG    Count of non-recoverable transfer-hung errors.
|  
|        73    .DCTHG    Count of transfer-hung errors.
|  
|        74    .DCPHG    Count of position-hung errors.
|  
|        75    .DCSHG    Count of software-hung errors.
|  
|        76    .DCMAX    Length of DSKCHR argument block.  The  value  of
                         this symbol may change as words are added to the
                         DSKCHR block.

                                  ac        The flags returned in the ac are as follows:

        ____   ______    _______        Bits   Symbol    Meaning

           0   DC.RHB    Disk pack off-line; the monitor must reread  the
                         home  block  before the next operation to verify
                         the pack identification.

           1   DC.OFL    Unit is off-line.

           2   DC.HWP    Hardware write-protected.

           3   DC.SWP    Belongs to write-protected file structure.

           4   DC.SAF    Belongs to single-access file structure.

           5   DC.ZMT    Mount count is zero.

           6   DC.PRV    Belongs to private file structure.

         7-8   DC.STS    Status code for unit:

                         ____    ______  ______                         Code    Symbol  Status

                          0      .DCSTP  Has pack mounted.
                          2      .DCSTN  No pack mounted.
                          3      .DCSTD  Unit down.

           9   DC.MSB    Unit has more than one SAT block.

          10   DC.NNA    Belongs to  a  structure  that  has  a  lock  to
                         prevent  further  INIT, LOOKUP, ENTER, OPEN, and
                         FILOP. calls (NNA - "no new access").  This lock
                         is set by a privileged STRUUO function.



                                   22-87
   DSKCHR [CALLI 45]


          11   DC.AWL    Write-locked for all jobs.

       12-13   DC.CPU    CPU number of the CPU to  which  the  device  is
|                        connected.   DC.XCC  in  word  .DCXCH supersedes
|                        DC.CPU.
|  
|         14   DC.ALT    Dual-ported device.
|  
|      15-17   DC.TYP    Type of argument passed with the DSKCHR call:
|  
                         ____    ______  _______|                        Code    Symbol  Meaning
|  
|                         0      .DCTDS  Generic name, such as DSK.
|                         1      .DCTAB  File structure  subset,  because
|                                        of abbreviation, such as D.
|                         2      .DCTFS  File  structure  name,  such  as
|                                        DSKA.
|                         3      .DCTUF  Unit within file structure, such
|                                        as DSKA0.















































                                   22-88
                                                        DSKCHR [CALLI 45]


                         ____    ______  _______|                        Code    Symbol  Meaning
|  
|                         4      .DCTCN  Controller class name,  such  as
|                                        FH.
|                         5      .DCTCC  Controller name, such as RPA.
|                         6      .DCTPU  Physical unit, such as RPA0.
|  
|      18-20   DC.DCN    Data  channel  number  that  software  lists  as
|                        connected to hardware; first data channel is 0.
|  
|      21-26   DC.CNT    Controller type:
|  
                         ____    ______  __________ ____|                        Code    Symbol  Controller Type
|  
|                         1      .DCCFH  RC10 for RD10 and RM10-B.
|                         2      .DCCDP  RP10 for RP02 and RP03.
|                         4      .DCCFS  RH10 for fixed head disk.
|                         5      .DCCRP  RH10/RH20/RH11 for  moving  head
|                                        disk   (RP04,  RP06,  RP07,  and
|                                        RM03).
|                         6      .DCCRN  RH20 for RP20.
|                         7      .DCCRA  HSC50 for CI disks.

       27-29   DC.CNN    Controller number; first one of each type is 0.

       30-32   DC.UNT    Unit type:

                         ____    ______  _______  ____                         Code    Symbol  Meaning  When

                          0      .DCUFD  RD10    (DC.CNT=1).
                          0      .DCUS4  RS04    (DC.CNT=4)
                          0      .DCUR4  RP04    (DC.CNT=5)
                          0      .DCUN0  RP20    (DC.CNT=6)
|                         0      .DCU80  RA80    (DC.CNT=7)
                          1      .DCUFM  RM10-B  (DC.CNT=1)
                          1      .DCUD2  RP02    (DC.CNT=2)
                          1      .DCUR6  RP06    (DC.CNT=5)
|                         1      .DCU81  RA81    (DC.CNT=7)
                          2      .DCUD3  RP03    (DC.CNT=2)
                          2      .DCUR3  RM03    (DC.CNT=5)
|                         2      .DCU60  RA60    (DC.CNT=7)
                          3      .DCUR7  RP07    (DC.CNT=5)

       33-35   DC.UNN    Physical  unit  number  within  the  controller;
                         first one is 0.

   Error Return

        The error return occurs if any of  the  following  conditions  is
        found:

                            addr         o  The argument at addr is 0.

         o  The device does not exist or channel is not initialized.

         o  The argument is illegal.










                                   22-89
   DSKCHR [CALLI 45]


   Example

        The  following  example  checks  a  user's  logged-in  quota   on
        structure DSKB:

               MOVE   T1,[2,,ADDR]
               DSKCHR T1,
                 JRST NOQTA
               SKIPGE ADDR+.DCUFT
                 JRST NOQTA
                 . . .
        ADDR:  SIXBIT /DSKB/
               BLOCK 1

        This code tests the value returned from the  DSKCHR  call.   When
        DSKCHR fails, or when no quota is returned at ADDR+1, the program
        jumps to NOQTA, where it must act on  the  possibility  that  the
        structure is not mounted or there is no quota on the structure.
















































                                   22-90
                                                         DTE. [CALLI 170]


                              DTE. [CALLI 170]                              DTE. [CALLI 170]



   Function

        Performs functions for the DTE (KL  systems  only),  and  is  not
        recommended for customer programs.  To use the DTE. monitor call,
        you must have the JP.POK or JACCT  privilege,  or  be  logged  in
        under [1,2].

   Calling Sequence

                MOVE  ac,[fcn-code,addr]
                DTE.  ac,
                  error return
                normal return
                . . .
        addr:   argument list

                fcn-code        where:  fcn-code is one of the function codes described below.

                addr                addr is the address of the argument list.  Each  function
                requires  a different argument list.  These are described
                below.

        In the following discussion of the DTE. functions,

            cpuno         o  cpuno is the number of a CPU.

            dteno         o  dteno is the number of a DTE.

            fedno         o  fedno is the unit number of a front-end device.

        The function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

          0    .DTECL    Clears a PDP-11 on a DTE.  The argument list for
                         the .DTECL function is:

                         addr:   XWD     cpuno,dteno

          1    .DTEST    Starts primary protocol on a DTE.  The  argument
                         list for the .DTEST function is:

                         addr:   XWD     cpuno,dteno

          2    .DTETB    Sets  the  byte  pointer  for   messages   being
                         transferred  to  the DECsystem-10.  The argument
                         list for the .DTETB function is:

                         addr:   XWD     cpuno,dteno
                                 EXP     <byte pointer to DECsystem-10>

          3    .DTEEB    Sets the byte pointer for  messages  transmitted
                         to the PDP-11.  The argument list for the .DTEEB
                         function is:

                         addr:   XWD     cpuno,dteno
                                 EXP     <byte pointer to PDP-11>





                                   22-91
   DTE. [CALLI 170]


        ____   ______    ________        Code   Symbol    Function

          4    .DTERW    Returns the PDP-11 reload ROM word  in  the  ac.
                         The argument list for the .DTERW function is:

                         addr:   XWD     cpuno,dteno

                         If bit 4 (DT.RP4) is set on return,  the  PDP-11
                         got code from the disk.

                                    ac          5    .DTEMN    Return (in ac) the master  DTE  number  for  the
                         CPU.   The argument list for the .DTEMN function
                         is:

                         addr:   XWD     cpuno,dteno

          6    .DTEPR    Presses the PDP-11 reload button.  The  argument
                         list for the .DTEPR function is:

                         addr:   XWD     cpuno,dteno

          7    .DTEGS    Returns the status word for the DTE.  The status
                                                                      ac                         word  for  the  specified DTE is returned in ac.
                         The argument list for the .DTEGS function is:

                         addr:   XWD     cpuno,dteno

                         The status flags that can be returned are:

                         ____   ______    _______                         Flag   Symbol    Meaning

                           6    DT.DTX    DTE exists.
                           7    DT.DTM    DTE is master DTE.
                           8    DT.PPC    DTE    is    running    primary
                                          protocol.
                           9    DT.SPC    DTE   is   running    secondary
                                          protocol.
                          10    DT.RLD    DTE needs reloading.

         10    .DTERJ    Sets reload job number.  The argument  list  for
                         the .DTERJ function is:

                         addr:   EXP     jobno

                                 jobno                         where:  jobno is the job number for the reload.

         11    .DTEGF    Returns  front-end  device  unit  number.    The
                         argument list for the .DTEGF function is:

                         addr:   XWD     cpuno,dteno
                                 EXP     fedno

         12    .DTEIF    Front-end device input.  The argument  list  for
                         the .DTEIF function is:

                         addr:   XWD     cpuno,dteno
                                 EXP     fedno
                                 XWD     byte-count, addr-of-input-buffer

         13    .DTEOF    Front-end device output.  The argument list  for
                         the .DTEOF function is:

                         addr:   XWD     cpuno,dteno
                                 EXP     fedno
                                 XWD     byte-count,addr-of-output-buffer

                                   22-92
                                                         DTE. [CALLI 170]


        ____   ______    ________        Code   Symbol    Function

         14    .DTEFG    Returns (in ac)  the  front-end  device  status.
                         The argument list for the .DTEFG function is:

                         addr:   XWD     cpuno,dteno
                                 EXP     fedno

                         The returned device status flags are:

                         ____   ______    _______                         Flag   Symbol    Meaning

                          28    DT.FER    Fatal error.
                          29              Reserved.
                          30    DT.EOF    End of file.
                          31    DT.IOP    I/O in progress.
                          32    DT.SER    Soft error.
                          33    DT.HER    Hard error.
                          34    DT.OFL    Off-line.
                          35    DT.NXD    Nonexistent device.

         15    .DTEFS    Sets front-end device status.  The argument list
                         for the .DTEFS function is:

                         addr:   XWD     cpuno,dteno
                                 EXP     fedno
                                 EXP     status

                                 status                         where:  status  is  the  status  word  for   the
                         front-end device.

         16    .DTEFR    Releases a front-end device.  The argument  list
                         for the .DTEFR function is:

                         addr:   XWD     cpuno,dteno
                                 EXP     fedno

         17    .DTERC    Releases KL error chunks.  The argument list for
                         the .DTERC function is:

                         addr:   XWD     cpuno,0

         20    .DTERT    Releases the KL error timer.  The argument  list
                         for the .DTERT function is:

                         addr:   XWD     cpuno,0

         21    .DTEDT    Returns Universal Device  Indexes  for  terminal
                         lines leading to the DL11s on the specified DTE.
                         The argument list for this function is:

                         addr:   XWD     cpuno,dteno

                         On a successful return, the UDX is  returned  in
                              ac                         the  ac.  However, for DTE 0, which is dedicated
                                                                       ac                         to the  console  front  end  (RSX-20F),  the  ac
                         contains the KLINIK line's UDX in the left half,
                         and the CTY's UDX in the right half.








                                   22-93
   DTE. [CALLI 170]


        ____   ______    ________        Code   Symbol    Function

         22    .DTESU    Specifies the type of protocol that will run  on
                         the  DTE.   The  argument list for this function
                         is:

                         addr:   XWD     cpuno,dteno
                                 SIXBIT/user-name/

                                   user-name                         where the user-name  is  one  of  the  following
                         protocol types:

                              DECNET  for DECnet-10.
                              ANF     for ANF-10.
                              IBM     for IBM communications.
                              NOBODY  if  the  DTE  is  not   running   a
                                      protocol.
                              PROGRA  if the DTE is dedicated to a job.

        23     .DTERU    Reads the protocol type of the protocol that  is
                         running on the DTE.  The argument list is:

                         addr:   XWD     cpuno,dteno
                                 BLOCK   2

                         The information is  returned  in  the  following
                         format:

                         addr:   XWD     cpuno,dteno
                                 SIXBIT/user-name/
                                 EXP     jobn

                               user-name                         where user-name is  the  name  of  the  protocol
                         running on the DTE (refer to .DTESU above).  The
                                     jobn                         job number (jobn) is returned in addr+2 only  if
                         user-name is PROGRA.

        24     .DTELS    Loads a  secondary  bootstrap  from  your  job's
                         memory  area,  using  the  PDP-11 bootstrap ROM.
                         This function must be  preceded  by  the  .DTECL
                         (clear)  and  .DTEPR  (press  reload) functions.
                         You must also use function .DTEDM (dump)  before
                         you  can  load any bootstrap.  The argument list
                         for this function is:

                         addr:   XWD     cpuno,dteno
                                 POINT   16,addr1
                                 EXP     length

                         where addr+1 contains a byte pointer  indicating
                                                                   length                         the location of the secondary loader, and length
                         is the length of the loader, in 16-bit bytes.














                                   22-94
                                                         DTE. [CALLI 170]


        ____   ______    ________        Code   Symbol    Function

        25     .DTEDM    Dumps PDP-11 memory, using the PDP-11  bootstrap
                         ROM.   Before  you use this function, be sure to
                         use functions .DTECL (clear) and  .DTEPR  (press
                         reload).  You must always dump the PDP-11 memory
                         before you can load a program into  its  memory.
                         The argument list for this function is:

                         addr:   XWD     cpuno,dteno
                                 POINT   16,addr1
                                 EXP     count

                         where addr+1  contains  a  byte-pointer  to  the
                                                                 count                         memory  that  must be dumped, and where count is
                         the number of 16-bit  bytes  to  dump  from  the
                         PDP-11.

|       26     .DTKPS    Not intended for customer use.
|  
|       27     .DTKPR    Not intended for customer use.

   Normal Return

        The function is performed, and any requested value is  stored  in
            ac        the ac.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          1    DTENP%    Not enough privileges.
          2    DTEUF%    Illegal function code.
          3    DTEDC%    Illegal CPU or DTE number.
          4    DTEAP%    Primary protocol already running.
          5    DTEPT%    Power fail did not come up.
          6    DTEDE%    Doorbell did not clear.
          7    DTTTE%    To TOPS-10 error during BOOT sequence.
         10    DTEDD%    No response from PDP-11 after BOOT sequence.
         11    DTEIJ%    Illegal job number.
         12    DTEIB%    Illegal byte count.
         13    DTENI%    Front-end device not initialized.
         14    DTEFB%    Front-end device in use by another job.
         15    DTENF%    Nonexistent front-end device.
         16    DTEFE%    Fatal error on front-end device.
         17    DTESE%    Error starting primary protocol.
         20    DTENC%    No free core for front-end device buffers.
         21    DTETE%    KL error data timer expired.
         22    DTECM%    The FEDSER monitor module was told not  to  send
                         messages to the PDP-11.
         23    DTEIU%    Tried to set line to illegal user value.
         24    DTEWU%    Wrong line user for function.
         25    DTEEV%    No exec virtual memory to perform function.
         26    DTEIP%    Illegal byte pointer.










                                   22-95
   DVPHY. [CALLI 164]


                             DVPHY. [CALLI 164]                             DVPHY. [CALLI 164]



   Function

        Returns the physical names of all devices of a given type, or  of
        all  devices  supported  by  the system (except pseudo-terminals,
        terminals, MPX devices, and disks).

   Calling Sequence

               MOVE      ac,[XWD len,addr]
               DVPHY.    ac,
                 error return
               normal return
               . . .
        addr:  EXP       device-type   \
               EXP       -1            /
               BLOCK     1

                len        where:  len is the length of the argument block (must be 2).

                addr                addr is the address of the argument block.

                device-type                device-type is one of the device type codes returned from
                the  DEVTYP  monitor  call,  such  as  .TYLPT  for a line
                printer.  A value of -1 means all  devices  supported  by
                the system.

                                  addr+1        On the first DVPHY. call, addr+1 should contain  0;  the  monitor
        returns  the name of the first device.  If you leave this name in
        addr+1        addr+1, the next DVPHY. call returns the name of the next device,
        and  so  forth.   When all devices have been returned (by several
                                         addr+1        calls), the monitor returns 0 in addr+1.

   Normal Return

                 addr+1        For 0 in addr+1, the  monitor  returns  the  name  of  the  first
                                     a        device; for a device name in addr+1, the monitor returns the name
                                                    ac        of the next device, or, if no more, 0.  The ac is unchanged.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          1    DVPIA%    Illegal argument length.
          2    DVPIT%    Illegal device type.
          3    DVPNP%    Nonexistent physical device.
          4    DVPNT%    Nonexistent device type.














                                   22-96
                                                       DVPHY. [CALLI 164]


   Example

        The following example shows how to obtain the physical  names  of
        all line printers on the system:

                SETZB   T1,ADDR+1          ;Initialize counter and device name
        TAG1:   MOVE    T2,[XWD 2,ADDR]    ;Set up call
                DVPHY.  T2,                ;Get name
                  JRST  ERROR              ;Error
                SKIPN   T3,ADDR+1          ;Get name, skip if not at end
                  JRST  TAG2               ;0 means we're done
                MOVEM   T3,LPTNAM(T1)      ;Save in next block-slot
                AOJA    T1,TAG1            ;Increment count and loop
        TAG2:   MOVEM   T1,NLPT            ;Save count
                JRST    CONTIN
        NLPT:   BLOCK   1
        LPTNAM: BLOCK   10
        ADDR:   EXP     .TYLPT             ;Type is LPT
                EXP     0                  ;Start with first device
        CONTIN:

   Related Calls

        SYSPHY, SYSSTR

   Common Errors

        Using a SIXBIT name for device type.






































                                   22-97
   DVRST. [CALLI 122]


                             DVRST. [CALLI 122]                             DVRST. [CALLI 122]



   Function

        Restricts the use of a device.  Once restricted,  the  device  is
        then  assignable  only  by  the operator; unprivileged users must
        request assignment through the MOUNT monitor command before using
        the   OPEN/INIT   monitor   call.   (See  the  Commands  Manual.)
        Privileged users (JACCT or [1,2]) can still use the OPEN or  INIT
        monitor  call,  or  the  ASSIGN  command,  if  the  device is not
        controlled by MDA.

        The DVRST. monitor call requires the JACCT privilege or that  you
        be logged in under [1,2].

   Calling Sequence

                MOVE    ac,[SIXBIT/device/]  \
                MOVEI   ac,channo            |
                MOVEI   ac,udx               /
                DVRST.  ac,
                  error return
                normal return

                device        where:  device is the SIXBIT physical or logical name of a device
                to be designated as being restricted.

                channo                channo is the number of an initialized channel.

                udx                udx is the Universal Device Index for a device.

   Normal Return

        The device is restricted.

   Error Return

        The error return occurs if any of  the  following  conditions  is
                   ac        found (the ac is unchanged):

         o  You do not have the JACCT privilege  or  are  not  logged  in
            under [1,2].

         o  The specified device does not exist.

         o  The device is a disk.


   Related Calls

        DVURS.













                                   22-98
                                                       DVURS. [CALLI 123]


                             DVURS. [CALLI 123]                             DVURS. [CALLI 123]



   Function

        Removes  the  restriction  created  by  a  DVRST. monitor   call.
        DVURS. requires  the  JACCT  privilege  or  that you be logged in
        under [1,2].

   Calling Sequence

                MOVE   ac,[SIXBIT/device/] \
                MOVEI  ac,channo           |
                MOVEI  ac,udx              /
                DVURS. ac,
                  error return
                normal return

                device        where:  device is the SIXBIT physical or logical name of a device
                that is to be returned to unrestricted status.

                channo                channo is the number of an initialized channel.

                udx                udx is the Universal Device Index for a device.

   Normal Return

        The restriction is removed.  The device is available  for  public
        use and returned to the monitor's pool of available devices.

   Error Return

        The error return occurs if any of  the  following  conditions  is
        found (the ac is unchanged):

         o  You do not have the JACCT privilege  or  are  not  logged  in
            under [1,2].

         o  The given device does not exist.


   Related Calls

        DVRST.





















                                   22-99
   ENQ. [CALLI 151]


                              ENQ. [CALLI 151]                              ENQ. [CALLI 151]



   Function

        Requests access to resources that are defined by cooperating user
        programs.   The  ENQ.   call  is  one of three monitor calls that
        provide  control  over  the  ENQ/DEQ  facility,  which   provides
        resource  definition,  control  over  access  to  resources,  and
        deadlock detection for the resources.  The  ENQ/DEQ  facility  is
        described in Chapter 8.

   Calling Sequence

                MOVE   ac,[XWD fcn-code,addr]
                ENQ.   ac,
                  error return
                normal return
                . . .
        addr:   EXP     <size>B5+<number>B17+<len>B35     ;header block
                XWD     0,request-id                      
                XWD     time-limit
                <lock block>
                <lock block>
                    .
                    .
                    .

                fcn-code        where:  fcn-code is one of the function codes listed below.

                addr                addr is the address of the argument block, which consists
                of a header block followed by one or more lock blocks.

        The header block contains 1 to 3 words, in the following order:

        ______ ______     ________        Offset Symbol     Contents

          0    .ENQLL    The header size, the number  of  lock  requests,
                         and  the total length of the argument, including
                         the header and all the words  in  all  the  lock
                         blocks.    Specifically,   the  .ENQLL  word  is
                         formatted as follows:

                         ____   ______   _____                         Bits   Symbol   Value

                                         Size                         0-5    EQ.BHS   Size of the header block.   This
                                         value   is   between  1  and  3,
                                         because  the  second  and  third
                                         words are optional.  If you omit
                                         this value, the default is 2.

                                         Number                         6-17   EQ.LNL   Number of lock blocks  following
                                         the  header  block.  Include one
                                         lock  block  for  each  resource
                                         requested.










                                   22-100
                                                         ENQ. [CALLI 151]


                         ____   ______   _____                         Bits   Symbol   Value

                                               length                         18-35  EQ.LLB   Total length (in words)  of  the
                                         argument  block.   All  the lock
                                         blocks in a single request  must
                                         be  the  same length.  Thus, the
                                         value of EQ.LLB  is  the  header
                                         block  length  (EQ.BHS) plus the
                                         length of each lock block  times
                                         the    number    of    resources
                                         requested (EQ.LNL).

        ______ ______     ________        Offset Symbol     Contents

                                   request-id        1      .ENQRI    An 18-bit request-id identifying  this  request.
                         This   optional   value   identifies   the  ENQ.
                         request, enabling you to  identify  it  when  it
                         causes  a  software  interrupt.   This is useful
                         when you use the ENQ/DEQ facility in conjunction
                         with the software interrupt (PSI) system.  After
                         an interrupt is generated,  the  request-ids  of
                         the  granted  requests are inclusively ORed into
                         the status word  of  the  interrupt  block.   To
                         receive  a software interrupt, use function code
                         2 (.ENQSI) when you issue the ENQ. monitor call.
                         The  request-id  can  also be used with the DEQ.
                         call to dequeue a specific request.

                         Time limit        2      .ENQTL    Time limit specifying the number of  seconds  to
                         wait for each request in the call to be granted.
                         If any resource is  not  available  within  that
                         time limit, the call takes the error return with
                                                      ac                         the ENQTL% error code in the ac.  This  word  is
                         optional.   If you include the time limit in the
                                                     size                         header block, specify 3 for size in word 0.

        Each lock block represents a separate ENQ.  request.  There is no
        limit  to the number of locks that can be requested, but multiple
        requests in the same ENQ.  call must be given level numbers.  The
        locks will be granted in the order of the level numbers.

        The format of a lock block is:

               EXP      <flags+level>B17+<channo>B35 ;lock block
               byte-pointer               \
               EXP      flags+user-code   |
               EXP      user-code         /
               XWD pool-size,number       \
               XWD 0,sharer-group         /
               XWD mask-len,mask-addr
               XWD block-len,block-addr

|       where a lock block is two to five  words  long,  identifying  the
        resource  to  be locked and describing the characteristics of the
        lock.   The  first  requestor  of   a   resource   defines   lock
        characteristics.   Subsequent requests for the same resource must
        conform to those characteristics or wait until  the  resource  is
        released by the first requestor.








                                   22-101
   ENQ. [CALLI 151]


        In the case of multiple-lock requests, all the lock blocks  in  a
        single  ENQ.   request  must be the same length.  Specifically, a
        lock block can contain the following words:

        ______ ______    ________        Offset Symbol    Contents

          0    .ENQFL    Contains  the  flag  bits,  level  number,   and
                         channel number.  The flags are:

                         ___     ______  _______                         Bit     Symbol  Meaning

                         0       EQ.FSR  The lock request allows sharers.
                                         If  you do not set this bit, the
                                         monitor assumes that you require
                                         exclusive    access    to    the
                                         resource.   Unless   the   first
                                         requestor  for the resource sets
                                         this flag, no requests  for  the
                                         same  resource (specified in the
                                         next  word,   .ENQBP)   can   be
                                         granted    until    the    first
                                         requestor  dequeues  it   (using
                                         DEQ.   or  RESET).  If the first
                                         requestor sets this  bit,  other
                                         programs  with  the  same sharer
                                         group number as  that  specified
                                         in  .ENQPS  can obtain access to
                                         the resource while it is  locked
                                         for your job.

                         1       EQ.FLB  Bypass  level  checking.    When
                                         multiple request blocks are made
                                         in a single ENQ.  call, you must
                                         assign  a  level  number to each
                                         request.   When  EQ.FLB  is  not
                                         set,  lower-level resources will
                                         be granted  before  higher-level
                                         resources  are  considered.  The
                                         EQ.FLB   flag   prevents    this
                                         level-checking,         allowing
                                         resources    to    be    granted
                                         regardless  of  their  order  by
                                         level number.

                         2       EQ.FLT  Grant a  long-term  lock.   That
                                         is,   after   the   resource  is
                                         dequeued by all users, the  lock
                                         data  is  preserved  for about 5
                                         minutes.

                         3       EQ.FEL  Grant  an  eternal  lock.   This
                                         prevents   the   resources  from
                                         being   dequeued   automatically
                                         when  your  program  performs  a
                                         RESET function.

                         4       EQ.FAB  Abort   the   resource.     This
                                         prevents the resource from being
                                         accessible to any other user.  A
                                         request   for  an  aborted  lock
                                         causes error code ENQAB%  to  be
                                                               ac                                         returned   in   the   ac.    The
                                         resource cannot  be  granted  to
                                         another   user   until   it   is
                                         dequeued.

                                   22-102
                                                         ENQ. [CALLI 151]


                         ___     ______  _______                         Bit     Symbol  Meaning

                         5       EQ.FDD  Set  deadlock  detection.   This
                                         flag  prevents your request from
                                         causing   a    deadlock    among
                                         resource users.  If this flag is
                                         set, and granting  your  request
                                         would cause a deadlock, the ENQ.
                                         call takes the error return with
                                                                  ac                                         error code ENQDD% in the ac.

                         6       EQ.FCW  Specifies  that  a  36-bit  user
                                         code  is  included  in  the next
                                         word  (.ENQBP).   This  is   the
                                         preferred method of specifying a
                                         user code in the lock block.

                         7-8             Reserved for use by DIGITAL.

                                                level-number                         9-17    EQ.FLV  9-bit  level-number   that   you
                                         assign  to  each  request  in  a
                                         multiple-lock  request.   In   a
                                         multiple-lock  request (a single
                                         ENQ.  call  containing  multiple
                                         lock  blocks),  each  lock block
                                         must be assigned a level number;
                                         the  locks  will  be  granted in
                                         ascending    numerical     order
                                         according   to   level   number,
                                         unless you  set  EQ.FLB  (bypass
                                         level   checking)  in  the  flag
                                         word.

                                                              channel                         18-35   EQ.FCC  The number  of  the  channel  on
                                         which   the  resource  is  being
                                         accessed (positive integer),  to
                                         associate the lock with the file
                                         that is open  on  that  channel.
                                         Alternatively, you can specify a
                                         negative number  indicating  one
                                         of the following conditions:

                                         ____   ______   _______                                         Code   Symbol   Meaning

                                         -3     .EQFPL   The         lock
                                                         requested  is  a
                                                         privileged
                                                         global  lock and
                                                         the resource  is
                                                         available   only
                                                         to   [1,2]    or
                                                         JACCT      jobs.
                                                         This code allows
                                                         privileged  jobs
                                                         to define  locks
                                                         on  resources to
                                                         prevent   access
                                                         from
                                                         unprivileged
                                                         jobs.






                                   22-103
   ENQ. [CALLI 151]


                                         ____   ______   _______                                         Code   Symbol   Meaning

                                         -2     .EQFGL   The lock you are
                                                         requesting  is a
                                                         global     lock.
                                                         Specifying  this
                                                         code    prevents
                                                         access   to  the
                                                         resource    from
                                                         any  other  job.
                                                         To   use    this
                                                         code,  your  job
                                                         must have JP.ENQ
                                                         set    in    its
                                                         privilege word.
                                         -1     .EQFJB   The  lock  is  a
                                                         job-wide   lock,
                                                         preventing
                                                         access   to  the
                                                         resource    from
                                                         any        other
                                                         requests by your
                                                         job.


          1    .ENQBP    Specifies the resource to be  locked.   You  can
                               pointer                          user-code                         use a pointer to an ASCIZ string, or a user-code
                         in this word (more on  this  later).   You  must
                         include this word in every lock block because it
                         defines the resource you are requesting.

                         When the first program to request  the  resource
                         is  granted a lock, it is said to have ownership
                         of the resource.  When a second program makes an
                         ENQ.   call with the same value in this word (if
                         a user-code is  specified)  or  the  same  ASCIZ
                         string  (if a byte pointer is used), the request
                         is for the same resource that was granted to the
                                       The  contents of the word to which                         first  job.   The  contents of the word to which
                         the  byte  pointer  refers,  or  the  user  code                         the  byte  pointer  refers,  or  the  user  code
                         itself,  are  purely  arbitrary  values  to  the                         itself,  are  purely  arbitrary  values  to  the
                         monitor.  The monitor only checks lock  requests                         monitor.  The monitor only checks lock  requests
                         for matches, granting or preventing locks on the                         for matches, granting or preventing locks on the
                         basis of matching strings.  This is the  key  to                         basis of matching strings.  This is the  key  to
                         the ENQ/DEQ access-checking mechanism.                         the ENQ/DEQ access-checking mechanism.

                         If the flag EQ.FCW is set in the  previous  word
                         (.ENQFL),  .ENQBP must contain a 36-bit value as
                           user-code                         a user-code.

                         If EQ.FCW is not set, and the flag EQ.BUC is set
                         in  .ENQBP  (that  is, a value of 5 is placed in
                         bits 0-2), the rest of the word must  contain  a
                                user-code                         33-bit user-code.

                         If neither flag is set, this word (.ENQBP)  must
                                   pointer                         contain a pointer to an ASCIZ text string.  This
                         may be either a standard  byte  pointer  in  the
                         form:

                              POINT 7,address,bit-location





                                   22-104
                                                         ENQ. [CALLI 151]


        ______ ______    ________        Offset Symbol    Contents

                         Or, if the  ASCIZ  string  is  stored  in  7-bit
                         bytes,   starting  at  the  first  byte  of  the
                                                        pointer                         location being referenced, the pointer can  take
                         the form:

                              XWD -1,address

                                             address                         The ASCIZ string at address  can  be  up  to  30
                         (decimal)  words.  The maximum string length for
                         your system is stored in %EQMSS in GETTAB  table
                         .GTENQ.

                         Cooperating programs (those requesting the  same
                         resources)  must  specify  exactly the same user
                         code or ASCIZ string.

        2      .ENQPS    Specifies either a  pool  number  for  a  pooled
                         resource,   or  a  sharer  group  number  for  a
                         sharable resource.  This word  is  optional  and
                         defaults to 0.

                         For a pooled resource,  the  word  contains  the
                         pool-size                              number                         pool-size  in  the  left  half and the number of
                         resources requested from the pool in  the  right
                         half.  For a sharable resource, the left half is
                         zero,  and   the   right   half   contains   the
                         sharer-group                         sharer-group number.  Thus, a resource cannot be
                         pooled and also be accessible to a sharer group.

                         A  pooled  resource  is  defined  by  the  first
                         requestor  of  the  resource.  By specifying the
                         number of resources in the pool,  the  requestor
                         is  defining  the  number  of  "copies"  of  the
                         resource to be made available.  Each copy of the
                         resource  can  be requested for exclusive access
                         by specifying the same  resource  identifier  in
                                                       pool-size                         word  .ENQBP  and  the  same  pool-size  in word
                         .ENQPS.  The requestor must also specify, in the
                         right  half  of  .ENQPS  (EQ.PPR), the number of
                         copies of the resource to lock.

                         If the left half of .ENQPS (EQ.PPS)  is  0,  the
                                                             sharer-group                         right  half  (EQ.PPR) specifies the sharer-group
                         number, thus defining a group of jobs  that  can
                         simultaneously  share the resource.  Any program
                         that sets the flag EQ.FSR and specifies the same
                         resource  and  the same sharer group number will
                         be granted its  request.   Therefore,  when  you
                         share  the  ownership  of a resource, only other
                         jobs  in  the  same  sharer  group  are  allowed
                         ownership  of  the  resource.   The sharer group
                         number defaults to 0.  Therefore, if  the  first
                         requestor  specifies  a  sharable  resource  but
                         omits the sharer group  number,  all  subsequent
                         sharable  requests  for  the  resource that also
                         omit the sharer group number, or that set it  to
                         0, will be granted immediately.







                                   22-105
   ENQ. [CALLI 151]


        ______ ______    ________        Offset Symbol    Contents

        3      .ENQMS    Contains a pointer to the bit mask  representing
                         the  portions  of  a resource to be locked.  The
                                                 mask-len                         pointer consists of the mask-len stored  in  the
                                             mask-addr                         left  half, and the mask-addr in the right half.
                         The bit mask, describing fields of  bits  to  be
                         locked,  is  stored at the location specified in
                         mask-addr                         mask-addr, and the length of the  bit  mask  (in
                                                 mask-len                         words) is stored in the mask-len.  This provides
                         a  facility  for  partitioning   the   resource,
                         allowing  locks on portions of a resource.  This
                         word is optional and defaults to 0.

                                      block-length      block-addr        4      .ENQTB    Contains the block-length and  block-addr  of  a
                         lock-associated data block.  This data block can
                         be used to pass information to subsequent  users
                         of a resource.  To use this facility, you should
                         set EQ.FLT, thus  preserving  all  lock  request
                         data  for  the  resource  for at least 5 minutes
                         after you dequeue the resource.   This  word  is
                         optional and defaults to 0.

        The function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

          0    .ENQBL    Requests ownership of a resource.  Your job will
                         block  if  the  resource is not available.  Your
                         request is placed in a queue associated with the
                         specified  resource.   If  more than one request
                         was included in your ENQ.  call, your  job  will
                         block  until all the requests have been granted.
                         After all requests have been granted, the normal
                                                                      ac                         return  is  taken and the monitor clears the ac.
                         If you set the flag  EQ.FBL  in  .ENQFL  of  the
                         request  block  (to  bypass level checking), the
                         monitor could return a nonzero value.  A nonzero
                         value  indicates  that a level number sequencing
                         error occurred, but it was ignored  because  you
                         specified   that   level   numbers  were  to  be
                         bypassed.

          1    .ENQAA    Requests ownership of  a  resource  and  returns
                         immediately  if the resource is unavailable.  If
                         all requests specified in this  argument  cannot
                         be  granted  immediately,  the  system  will not
                         enter any requests in the queues associated with
                         those  resources  and  the error return is taken
                         with error code 1 (ENQRU%) in the ac.   However,
                         if  the  system  can  grant all of your requests
                         immediately, the normal return is taken and  the
                                            ac                         monitor leaves the ac unchanged.













                                   22-106
                                                         ENQ. [CALLI 151]


        ____   ______    ________        Code   Symbol    Function

          2    .ENQSI    Requests ownership of a  resource  and,  if  the
                         resource  is not immediately available, causes a
                         software interrupt  when  the  resource  becomes
                         available.   You  can use this function when the
                         Programmable Software Interrupt (PSI) system  is
                         enabled, to prevent your job from blocking while
                         waiting for the requests to be granted.

                         If all the requests in the call can  be  granted
                         immediately,  this  function  is  equivalent  to
                         function  code  0  (.ENQBL).   If  any  of   the
                         requests  are  not available, the call takes the
                         error return with error code 1 (ENQRU%)  in  the
                         ac                         ac.    In  this  case,  your  job  can  continue
                         processing until it receives a  .PCQUE  software
                         interrupt.   The  interrupt  control  block will
                         contain the request-ids of the requests that are
                         granted,  inclusively ORed into the status word.
                         The PSI system is described in Chapter 6.

          3    .ENQMA    Modifies an existing request made by  your  job.
                         If  the modification you specify in this request
                         is identical to the request you made earlier, no
                         action  is  taken and the normal return is taken
                         from the call.  If you do not have a request  in
                         any  queue,  the  error  return is taken and the
                         monitor returns error code 24  (ENQNE%)  in  the
                         ac                         ac.   If  you specify more than one request with
                         this function  code  and  the  error  return  is
                         taken, you must issue the ENQC.  monitor call to
                         determine which (if  any)  modification  request
                         was  granted.   The  error code that the monitor
                                        ac                         returns in the ac reflects only the  last  error
                         that occurred as the result of this call.

                         You  can  modify  a   request   from   exclusive
                         ownership  to  shared  ownership,  but  you will
                         receive an error code if you attempt to modify a
                         request  from  shared  to exclusive ownership if
                         other jobs are also sharing  the  resource.   To
                         modify   a  request  from  shared  to  exclusive
                         ownership  when  other  jobs  are  sharing   the
                         resource,   you  must  first  DEQ. the  request.
                         Then, enqueue it again as an exclusive ownership
                         request.

   Normal Return

        All requests in the call  are  granted,  and  the  resources  are
        locked for your program.














                                   22-107
   ENQ. [CALLI 151]


   Error Return

                                                               ac        One of the following error codes is returned  in  the  ac  on  an
        error  return.   These  error codes are also returned on an error
        from a DEQ.  or ENQC.  call.  They are described in  more  detail
        in Chapter 8.

        ____   ______    _____        Code   Symbol    Error

          1    ENQRU%    At least one of the requested resources  is  not
                         available.
          2    ENQBP%    You  requested  an  illegal  number  of   pooled
                         resources.
          3    ENQBJ%    You specified an illegal job number.
          4    ENQBB%    You specified an illegal byte size for the  byte
                         pointer.   The  byte  size must be between 1 and
                         36, inclusive.
          5    ENQST%    The ASCIZ string is too long.  It must  be  less
                         than 30 (decimal) words.  (Refer to GETTAB table
                         .GTENQ, item %EQMSS for current maximum  message
                         length.)
          6    ENQBF%    You specified an illegal function code.
          7    ENQBL%    You specified an illegal argument  list  length.
                         The  total  argument  list  for the call must be
                         header-block-size plus (request-block-size times
                         number-of-requests).
         10    ENQIC%    You specified an illegal number of requests.
         11    ENQBC%    You specified an illegal channel number.
         12    ENQPI%    Your program does not have enough privileges for
                         the given function.
         13    ENQNC%    Not enough core available, or the maximum number
                         of  active  locks  (item  %EQMAQ in GETTAB table
                         .GTENQ) has been exceeded.
         14    ENQFN%    Device is not initialized or is not a disk.
         15    ENQIN%    The address for the byte pointer is indirect  or
                         indexed; this is not allowed.
         16    ENQNO%    Your program cannot dequeue  resources  it  does
                         not own.
         17    ENQLS%    Levels are not specified in ascending order.
         20    ENQCC%    Illegal modification of  ownership;  you  cannot
                         change   a  request  from  shared  to  exclusive
                         ownership.   You  must  DEQ. the  request,  then
                         ENQ. it with EQ.FSR set.
         21    ENQQE%    Your ENQ quota has been exceeded; your quota  is
                         set by the system administrator.
         22    ENQPD%    The number of resources in  the  pool  disagrees
                         with the number in your request.
         23    ENQDR%    Duplicate  request;  identical  to   a   request
                         already in the queue.
         24    ENQNE%    Not enqueued on this lock.
         25    ENQLD%    Level in request does not match lock.
         26    ENQED%    Insufficient privileges for this  function;  you
                         must have JP.ENQ set.
         27    ENQME%    Mask too long or lengths do not match.
         30    ENQTE%    Lock-associated table is too long.
         31    ENQAB%    A resource that was requested has been marked as
                         aborted.
         32    ENQGF%    Attempt to ENQ. with EQ.FEL option  on  a  ghost
                         file.
         33    ENQDD%    Deadlock detected.
         34    ENQTL%    Time limit exceeded.





                                   22-108
                                                         ENQ. [CALLI 151]


   Example

                  .
                  .
                  .
                  MOVE     T2,[XWD 10,ADDR]     ;Initialize channel
                  FILOP.   T2,
                    JRST ERROR1                 ;Error return
                  JRST     ENQ                  ;Normal return

        ADDR:     XWD CHAN,1                    ;Channel and LOOKUP
                  EXP MODE                      ;Data mode
                  SIXBIT/DSK/                   ;Device
                  0,,0                          ;Buffer addresses
                  0,,0
                  0,,ADDR1                      ;LOOKUP block
                  0,,0
                  0,,0

        ADDR1:    SIXBIT/FILE/                  ;File name
                  SIXBIT/EXT/                   ;Extension
                  XWD 0,0
                  XWD 27,4072                   ;Project-programmer
                                                ;Number

        ENQ:      MOVE     T3,[XWD 0,ADDR3]     ;Function and address
                  ENQ.     T3,
                    JRST ERROR3                 ;Error return
                  JRST NORM                     ;Normal return

        ADDR3:    XWD 1,5                       ;Number of locks, length of block
                  XWD 0,1                       ;Request identifier
                  XWD 0,CHAN                    ;Resource on chan
                  POINT 7,[ASCIZ/NAME/]         ;Pointer to resource
                  0,,0                          ;Not a pooled resource

                  .
                  .
                  .

        ERROR1:   OUTSTR ERROR2
                  JRST DONE

        ERROR3:   OUTSTR ERROR4
                  JRST DONE

        ERROR2:   ASCIZ/ERROR WITH FILOP./


        ERROR4:   ASCIZ/ERROR WITH ENQ./

                  .
                  .
                  .
        DONE:     EXIT

   Related Calls

        DEQ., ENQC.







                                   22-109
   ENQC. [CALLI 153]


                             ENQC. [CALLI 153]                             ENQC. [CALLI 153]



   Function

        Returns information about the current state of  ENQ/DEQ  requests
        and  sets  access  rights  for the ENQ/DEQ facility (privileged).
        Refer to Volume 1 for more information about  using  the  ENQ/DEQ
        calls.   For  more information about the contents of the argument
        block, refer to the ENQ. call.

   Calling Sequence

        Each function of the ENQC.  call  requires  a  different  calling
        sequence.   The  calling  sequence  for  each  ENQC. function  is
        described below, for the appropriate function.

        The ENQC. function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

          0    .ENQCS    Returns a 3-word status block for each specified
                         lock.   The  calling  sequence  for  the  .ENQCS
                         function is:

                                 MOVE    ac,[XWD .ENQCS,addr]
                                 MOVEI   ac+1,buffer
                                 ENQC.   ac,
                                   error return
                                 normal return
                                 . . .
                         addr:   EXP     parameters
                                 XWD     0,request-id
                                 EXP     time limit
                                 first word of first lock block
                                 . . .
                                 last word of last lock block
                         buffer: BLOCK   <locks>*3
                                 . . .

                                 addr                         where:  addr is  the  address  of  the  argument
                                 list.

                                 buffer                                 buffer is the address of  a  buffer  (of
                                        locks                                 length locks*3) for storing the returned
                                 three-word status blocks.

                                 parameters                                 parameters is a word of the form:

                                 <size>B5+<locks>B17+<length>B35

                                         size                                 where:  size is the size of  the  header
                                 block (1 to 3).

                                 locks                                 locks is the number of  lock  blocks  in
                                 the argument list.









                                   22-110
                                                        ENQC. [CALLI 153]


        ____   ______    ________        Code   Symbol    Function

                         length                                      size                         length is the length of each  lock  block  (size
                         plus  number  of  locks times the length of each
                         lock block).

                                                              request-id                         The right half of addr+1 may contain request-id,
                         an optional request identifier.

                         time limit                         time limit is an optional  time  limit  for  the
                         request to be granted.

                         On  a  normal  return,  the  monitor  returns  a
                         three-word  status  block  for  each request, at
                         buffer                         buffer.  The format of each block is:

                         ______ ______    _______                         Offset Symbol    Meaning

                            0   .ENQCF    Flags:

                                          ____   ______    _______                                          Bits   Symbol    Meaning

                                             0   EQ.CFI    Invalid lock.
                                             1   EQ.CFO    This  user  is
                                                           owner.
                                             2   EQ.CFQ    This  user  is
                                                           in  queue  for
                                                           specified
                                                           resource.
                                             3   EQ.CFX    Owner's access
                                                           is exclusive.
                                           4-8             Reserved.
                                          9-17   EQ.CFL    Level number.
|                                        18-26   EQ.CFC    The    owner's
|                                                          context
|                                                          number.
|                                        27-35   EQ.CFJ    The    owner's
|                                                          job  number or
|                                                          an error code.

                            1   .ENQCT    A  time  stamp,  in   universal
                                          date-time   format,  indicating
                                          the  time  that  the  lock  was
                                          granted;  or 0, indicating that
                                          the resource is available.

|                           2   .ENQCI    The left half (EQ.CIQ) contains
|                                         the number of users sharing the
|                                         resource.    The   right   half
|                                         (EQ.CID)      contains      the
|                                         request-id of request.















                                   22-111
   ENQC. [CALLI 153]


        ____   ______    ________        Code   Symbol    Function

                                                     ac          1    .ENQCG    Returns  user's  quota  in  ac.    The   calling
                         sequence for the .ENQCG function is:

                                 MOVE    ac,[XWD .ENQCG,addr]
                                 ENQC.   ac,
                                   error return
                                 normal return
                                 . . .
                         addr:   XWD     0,jobno

                                 jobno                         where:  jobno is the number of the job whose ENQ
                                                jobno                         quota is required.  If jobno is -1, your own job
                         is assumed.

          2    .ENQCC    Changes user's quota.  The calling sequence  for
                         the .ENQCC function is:

                                 MOVE    ac,[XWD .ENQCC,addr]
                                 ENQC.   ac,
                                   error return
                                 normal return
                                 . . .
                         addr:   XWD     quota,jobno

                                 quota                         where:  quota is the new ENQ/DEQ quota.

                         jobno                         jobno is the number of the job whose quota is to
                                            jobno                         be  changed.   If  jobno  is -1, your own job is
                         assumed.

                         This function sets the lock quota for a specific
                         job.   To  perform  this function, you must have
                         POKE privileges, be a [1,2] job, or  be  running
                         with  the  JACCT bit set.  The ENQ/DEQ quota for
                         the specified job will be set to the  value  you
                         specify in the left half of the argument word on
                                                                   ac                         a normal return.  On a normal return, the ac  is
                         cleared.   If  you  attempt to use this function
                         without  the  required  privileges,  the   error
                         return is taken and the monitor returns an error
                                     ac                         code in the ac.

          3    .ENQCD    Dumps the data base.  The calling  sequence  for
                         the .ENQCD function is:

                                 MOVE    ac,[XWD .ENQCD,addr]
                                 ENQC.   ac,
                                   error return
                                 normal return
                                 . . .
                         addr:   XWD     0,len

                                 addr                         where:  addr is  the  address  of  a  buffer  to
                         receive the returned data.

                         len                         len is the  length  of  the  data  block  to  be
                         returned, minus one word.







                                   22-112
                                                        ENQC. [CALLI 153]


                         This function dumps the data base (all lock  and
                         queue  entries).  The entire data base is placed
                                                       addr                         in your area, beginning with  addr+1.   If  this
                         length  is  not  large enough to accommodate the
                         entire data base, the monitor returns as much as
                         possible  of the data base.  The end of the data
                         base is indicated by a word containing -1.   You
                         must   have   SPY  privileges  to  specify  this
                         function code.  The format of the returned  data
                         is described in Chapter 8.

   Normal Return

        The requested function is performed.

   Error Return

                                                    ac        The error codes that can be returned in the ac on an error return
        are  identical  to  those that can be returned from the ENQ.  and
        DEQ.  calls.  The error codes are listed in  the  description  of
        the ENQ.  call.

   Related Calls

        DEQ., ENQ.









































                                   22-113
   ENTER [OPCODE 077]


                             ENTER [OPCODE 077]                             ENTER [OPCODE 077]



   Function

        Specifies an output file to create, supersede, or update a  file.
|       Use FILOP. to perform an ENTER for an extended I/O channel.

   Calling Sequence

        The ENTER monitor call has two  types  of  argument  lists:   one
        using  a  four-word  argument  list  and  one  using  an extended
        argument list.  The extended argument list offers many additional
        options  for ENTERing a file.  For complete information about the
        argument lists, refer to Section 11.13.

        The calling sequence for the ENTER UUO is:

                ENTER   channo,addr
                  error return
                normal return

                addr        where:  addr is the address  of  the  argument  list.   Refer  to
                Section  11.13  for  more  information about the argument
                list.

   Normal Return

        When you use the short form of the argument  block,  the  monitor
                                              addr        returns a four-word argument block at addr.

        Refer to Section 11.13.1 for information about the argument block
        that is returned.

        When you use the extended argument list, the monitor returns  the
        information that is listed on Section 11.13.2.

   Error Return

        On an error return from ENTER, the monitor returns an error  code
        in either of the following:


         o  For the short-form argument block, the error code  is  stored
                                 addr+1            in the right half of addr+1 of the 4-word argument block


         o  For the extended-form  argument  block,  the  error  code  is
                                          addr+3            returned in the right half of addr+3.

        It is possible to LOOKUP/RENAME a file after using  an  ENTER  to
        specify  the  argument  list, referring to the same argument list
        with subsequent calls.  Note, however, that on  an  error  return
        from  the  ENTER,  the error code overwrites the high-order three
        bits of the creation date and the entire  access  date.   Because
        most  programs recover from these errors by either aborting or by
        reinitializing the entire argument  block,  this  overwriting  of
        data  normally  does  not cause any problems.  However, a program
        may attempt to recover from an error by fixing only the incorrect
        portion  of  the  argument block and then reexecuting the monitor
        call.  These programs should always initialize  the  contents  of
        these locations before reexecuting the ENTER monitor call.



                                   22-114
                                                       ENTER [OPCODE 077]


        Error codes are restricted to a maximum of 15 bits  to  eliminate
        problems  when  recovering  from  an  error in a file with a zero
        creation date.  The error codes are described in Section 11.14.

   Examples

        See Chapter 11.

   Related Calls

        ENTER, FILOP., INIT, LOOKUP, OPEN, RENAME























































                                   22-115
   ERLST. [CALLI 132]


                             ERLST. [CALLI 132]                             ERLST. [CALLI 132]



   Function

        Returns data giving the status of each device on an  MPX  channel
        that has errors.

   Calling Sequence

                MOVEI   ac,addr
                ERLST.  ac,
                  error return
                normal return
                . . .
        addr:   XWD     length,channo
                BLOCK   length-1

                addr        where:  addr is the address of the argument block.

                length                length is the length of the argument  block;  the  length
                should  be the number of devices connected to the channel
                plus two.

                channo                channo is the number of an initialized channel.

   Normal Return

                                    addr        The monitor returns data at addr+1 for  devices  on  the  channel
                                       addr        that have errors.  The data at addr is in the format:

        addr:   XWD length,channo
                EXP number of devices
                XWD udx,status
                . . .
                XWD udx,status

                length     channo        where:  length and channo were given in the call.

                number of devices                number of devices is the number of devices on the channel
                that have encountered errors.

                udx                udx is the Universal Device  Index  of  a  device  having
                errors.

                status                status is a halfword containing I/O status bits  for  the
                device.  These bits are identical to those returned for a
                GETSTS monitor call.

        The monitor continues to return device error information  in  the
        argument block until all space allocated by your program has been
        filled.  Your program should  check  the  value  of  addr+1.   If
        addr+1  is  greater  than  the length of the argument block minus
        two, the device error list  is  incomplete  because  of  lack  of
        space.

        For a list of I/O status bits,  see  the  appropriate  device  in
        Volume 1.







                                   22-116
                                                       ERLST. [CALLI 132]


   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          1    ERLBC%    Illegal channel number.
          2    ERLNM%    Not an MPX-channel.

   Related Calls

        CLRST., GETSTS, SENSE.






















































                                   22-117
   ERRPT. [CALLI 160]


                             ERRPT. [CALLI 160]                             ERRPT. [CALLI 160]



   Function

        ERRPT. is a privileged monitor  call  used  only  by  the  DAEMON
        program  to  ask  the  monitor for the next error condition to be
        logged in the error file.

   Calling Sequence

                MOVE   ac,[XWD len,addr]
                ERRPT. ac,
                  error return
                normal return
                . . .
        addr:   BLOCK 4

                len                   addr        where:  len is the length and addr is the address of the argument
                list that is filled in by the monitor on a normal return.

   Normal Return

        If an error condition (such as a stopcode or a hardware error) is
                                                                  addr        found,  the  monitor  places  values  in the locations at addr as
        follows:

        ______ ______    ________        Offset Symbol    Contents

           0   .ERPT0    Address, job number, and error code:

                         ____   ______    _______                         Bits   Symbol    Meaning

                         0-17   ER.PAD    Address used by DAEMON.
                        18-26   ER.PJN    Job number.
                        27-35   ER.PCD    Error code for the error file.

           1   .ERPT1    Two monitor internal addresses:

                         ____   ______    _______                         Bits   Symbol    Meaning

                         0-17   ER.PDA    Address of DDB for device  with
                                          error condition.
                        18-35   ER.PUA    Address of UDB for device  with
                                          error.

           2   .ERPT2    CPU number.

                         ____   ______    _______                         Bits   Symbol    Meaning

                          0-14            Reserved for use by DIGITAL.
                         15-17  ER.CPU    CPU number on which  error  was
                                          detected.
                         18-35            Reserved for use by DIGITAL.

           3   .ERPT3    Reserved for use by Digital.









                                   22-118
                                                       ERRPT. [CALLI 160]


   Error Return

        One of the following conditions occurred:

         o  The ERRPT. call is not implemented.

         o  The calling sequence was improper.

         o  No appropriate error condition was found.  In this case,  the
                                   addr            values of the words at addr are unchanged.
























































                                   22-119
|  ETHNT. [CALLI 223]


                             ETHNT. [CALLI 223]|                            ETHNT. [CALLI 223]
|  
|  
|  
|  Function
|  
|       The ETHNT. monitor call accesses the Ethernet.  ETHNT. allows you
|       to read the Ethernet configuration, enable and disable protocols,
|       enable and disable multicast  addresses,  and  send  and  receive
|       datagrams.   For  an  overview  of  Ethernet,  as  well as a full
|       description of  datagram  buffers  (addressed  using .ETUBL)  and
|       function  buffers  (addressed  using .ETBFL and .ETBFA), refer to
|       Chapter 5, Volume 1.  The ETHNT. UUO requires  JACCT,  [1,2],  or
|       JP.POK privileges.
|  
|  Calling Sequence
|  
|               XMOVEI  ac,addr
|               ETHNT.  ac,
|                 error return
|               normal return
|  
                addr|       where:  addr is the address of the ETHNT. argument block.
|  
|       The argument block is:
|  
|       |=======================================================|
|       |    Flags     |   Function   | Argument Block Length   |
|       |=======================================================|
|       |                                                       |
|       |             Function-Specific Arguments               |
|       |                                                       |
|       |=======================================================|
|  
|       The format of the argument block is:
|  
        ______  ______   ________|       Offset  Symbol   Contents
|  
|          0    .ETFCN   Function code word for the argument block.  This
|                        word  contains the length of the argument block,
|                        and may also contain a flag.  Its format is:
|  
                           ____    ______     _______|                          Bits    Symbol     Meaning
|  
|                           0-8    ET.FFL     Function-specific flags.
|  
                                              ____  ______  _______|                                             Flag  Symbol  Meaning
|  
|                                             0     ET.FBK  Reserved  for
|                                                           use        by
|                                                           DIGITAL.
|  
|                                             1     ET.FZC  Zeroes
|                                                           counters
|                                                           after    they
|                                                           have     been
|                                                           read.     Use
|                                                           this     flag
|                                                           with
|                                                           functions
|                                                           .ETRCC,
|                                                           .ETRPC,   and
|                                                           .ETRKC.



                                   22-120
|                                                      ETHNT. [CALLI 223]


|                          9-17    ET.FFN     One of the  function  codes
|                                             listed  at  the  end of the
|                                             argument block description.
|  
|                         18-35    ET.FLN     Length  of   the   argument
|                                             block.
|  
|          1    .ETPSW   Contains the  portal  status  and  the  assigned
|                        portal ID.  ET.PST (Bits 0-8) may contain one or
|                        more of the following flags:
|  
                         ____  ______   _______|                        Flag  Symbol   Meaning
|  
|                          0   ET.PON   Portal is online.
|  
|                          1   ET.PXB   Transmit buffers available.
|  
|                          2   ET.PRB   Receive buffers available.
|  
|                        The rest  of  .ETPSW  contains  the  portal  ID,
|                        .ETPID, assigned by the monitor.
|  
|          1    .ETCSW   Contains  the  channel  list  and  channel   ID.
|                        ET.CST  (Bits  0-8) contains the channel status.
|                        If the ET.CON flag in ET.CST is on, the  channel
|                        is  online.   ET.CID  (Bits  9-35)  contains the
|                        channel ID.
|  
|          1    .ETKSW   Contains the status  and  ID  of  a  controller.
|                        ET.KST   (Bits   0-8)  contains  the  controller
|                        status.  If the ET.KON flag in ET.KST is on, the
|                        controller   is   online.   ET.KID  (Bits  9-35)
|                        contains the controller ID.
|  
|          2    .ETAR1   Contains the first  function-specific  argument.
|                        Function-specific  arguments  are  described  in
|                        each of the function codes below.
|  
|          3    .ETAR2   Contains the second function-specific argument.
|  
|       Valid function codes for .ETFCN are:
|  
        ____  ______     _______|       Code  Symbol     Meaning
|  
|         1   .ETOPN     Opens a user portal.   This  function  specifies
|                        the  protocol  type  to be enabled, and protocol
|                        specific flags.  The argument block is:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETOPN
|                                       in  Bits  9-17, and the length of
|                                       the argument  block,  4,  in  the
|                                       right half.
|  
|                         2    .ETPSW   Returns the portal status in Bits
|                                       0-8  and  portal ID in Bits 9-35.
|                                       Use the portal ID  in  subsequent
|                                       calls using this portal.
|  
|                         3    .ETCIW   Identifies the  Ethernet  channel
|                                       on  which  the protocol should be
|                                       enabled.



                                   22-121
|  ETHNT. [CALLI 223]


|                         4    .ETPIW   Identifies the protocol  type  to
|                                       be   enabled   on   the  Ethernet
|                                       channel.  Set the ET.PAD flag  in
|                                       the left half of .ETPIW to enable
|                                       padding for the protocol.
|  
|         2   .ETCLS     Closes a user portal and releases all  resources
|                        associated   with   it.    The   argument  block
|                        contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETCLS
|                                       in  Bits  9-17, and the length of
|                                       the argument  block,  2,  in  the
|                                       right half.
|  
|                         2    .ETPSW   Returns the portal status in Bits
|                                       0-8  and  portal ID in Bits 9-35.
|                                       Use the portal ID  in  subsequent
|                                       calls using this portal.
|  
|         3   .ETQRB     Queues receive datagram buffers.   The  argument
|                        block contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETQRB
|                                       in  Bits  9-17, and the length of
|                                       the argument  block,  3,  in  the
|                                       right half.
|  
|                         2    .ETPSW   Returns the portal status in Bits
|                                       0-8  and  portal ID in Bits 9-35.
|                                       Use the portal ID  in  subsequent
|                                       calls using this portal.
|  
|                         3    .ETUBL   Contains the address of the  user
|                                       buffer descriptor list.  Refer to
|                                       Chapter  5,  Volume  1  for   the
|                                       format   of   the   user   buffer
|                                       descriptor list.
|  
|         4   .ETRRQ     Reads receive queue.  This function  fills  each
|                        block  in  the  buffer descriptor list with data
|                        appropriate  to  a   received   datagram.    The
|                        argument block contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETRRQ
|                                       in  Bits  9-17  and the length of
|                                       the argument  block,  3,  in  the
|                                       right half.
|  
|                         2    .ETPSW   Returns the portal status in Bits
|                                       0-8  and  portal ID in Bits 9-35.
|                                       Use the portal ID  in  subsequent
|                                       calls using this portal.
|  
|                         3    .ETUBL   Contains the address of the  user
|                                       buffer descriptor list.  Refer to
|                                       Chapter  5,  Volume  1  for   the
|                                       format   of   the   user   buffer


                                   22-122
|                                                      ETHNT. [CALLI 223]


|                                       descriptor  list.    The   status
|                                       field  in  .UBSTS  of  the buffer
|                                       descriptor contains zero  if  the
|                                       datagram       was       received
|                                       successfully.
|  
|         5   .ETQXB     Transmits datagram  buffer  to  the  destination
|                        Ethernet   address   specified   in  the  buffer
|                        descriptor block.  The argument block contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETQXB
|                                       in  Bits  9-17, and the length of
|                                       the argument  block,  3,  in  the
|                                       right half.
|  
|                         2    .ETPSW   Returns the portal status in Bits
|                                       0-8  and  portal ID in Bits 9-35.
|                                       Use the portal ID  in  subsequent
|                                       calls using this portal.
|  
|                         3    .ETUBL   Contains the address of the  user
|                                       buffer descriptor list.  Refer to
|                                       Chapter  5,  Volume  1  for   the
|                                       format   of   the   user   buffer
|                                       descriptor list.
|  
|         6   .ETRXQ     Returns   data   associated   with   transmitted
|                        datagrams.  The argument block contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETRXQ
|                                       in  Bits  9-17, and the length of
|                                       the argument  block,  3,  in  the
|                                       right half.
|  
|                         2    .ETPSW   Returns the portal status in Bits
|                                       0-8  and  portal ID in Bits 9-35.
|                                       Use the portal ID  in  sebsequent
|                                       calls using this portal.
|  
|                         3    .ETUBL   Contains the address of the  user
|                                       buffer descriptor list.  Refer to
|                                       Chapter  5,  Volume  1  for   the
|                                       format   of   the   user   buffer
|                                       descriptor list.  On a successful
|                                       transmission, the returned status
|                                       is zero.
|  
|         7   .ETEMA     Enables a portal to receive  datagrams  destined
|                        for  an  Ethernet multicast address.  .ETEMA may
|                        not be used  while  a  promiscuous  receiver  is
|                        active.  The argument block for .ETEMA contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETEMA
|                                       in  Bits  9-17, and the length of
|                                       the argument  block,  4,  in  the
|                                       right half.
|  
|                         2    .ETPSW   Returns the portal status in Bits


                                   22-123
|  ETHNT. [CALLI 223]


|                                       0-8  and  portal ID in Bits 9-35.
|                                       Use the portal ID  in  subsequent
|                                       calls using this portal.
|  
|                         3    .ETMCA   Contains the  two  word  Ethernet
|                                       multicast address.
|  
|        10   .ETDMA     Disables a portal from receiving datagrams bound
|                        for  a multicast address.  The multicast address
|                        you disable must have  been  previously  enabled
|                        using  the  .ETEMA function.  The argument block
|                        contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETDMA
|                                       in  Bits  9-17, and the length of
|                                       the argument  block,  4,  in  the
|                                       right half.
|  
|                         2    .ETPSW   Returns the portal status in Bits
|                                       0-8  and  portal ID in Bits 9-35.
|                                       Use the portal ID  in  subsequent
|                                       calls using this portal.
|  
|                         3    .ETMCA   Contains the  two  word  Ethernet
|                                       multicast address.
|  
|        11   .ETRCL     Returns a  list  of  all  known  channels.   The
|                        argument block contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETRCL
|                                       in  Bits  9-17, and the length of
|                                       the argument  block,  4,  in  the
|                                       right half.
|  
|                         2    .ETCSW   Reserved.
|  
|                         3    .ETBFL   Contains  the   length   of   the
|                                       destination buffer.
|  
|                         4    .ETBFA   Contains  the  address   of   the
|                                       destination buffer.
|  
|        12   .ETRCI     Returns information about  a  specific  channel.
|                        The argument block contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETRCI
|                                       in  Bits  9-17, and the length of
|                                       the argument  block,  4,  in  the
|                                       right half.
|  
|                         2    .ETCSW   Identifies the  Ethernet  channel
|                                       on  which to enable the specified
|                                       protocol.  Bits 0-8  contain  the
|                                       channel   status,  including  the
|                                       ET.CON   flag,   indicating   the
|                                       channel  is  online.   Bits  9-35
|                                       contain the channel ID.



                                   22-124
|                                                      ETHNT. [CALLI 223]


|                         3    .ETBFL   Contains  the   length   of   the
|                                       destination buffer.
|  
|                         4    .ETBFA   Contains  the  address   of   the
|                                       destination buffer.
|  
|        13   .ETRCC     Returns a list of the counters associated with a
|                        channel,  and  (optionally)  zeroes  them.   The
|                        argument block contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETRCC
|                                       in  Bits  9-17, and the length of
|                                       the argument  block,  4,  in  the
|                                       right  half.  Set the ET.FZC flag
|                                       of  .ETFCN  if   you   want   the
|                                       counters zeroed after information
|                                       is returned.
|  
|                         2    .ETCSW   Identifies the  Ethernet  channel
|                                       on  which to enable the specified
|                                       protocol.  Bits 0-8  contain  the
|                                       channel   status,  including  the
|                                       ET.CON   flag,   indicating   the
|                                       channel  is  online.   Bits  9-35
|                                       contain the channel ID.
|  
|                         3    .ETBFL   Contains  the   length   of   the
|                                       destination buffer.
|  
|                         4    .ETBFA   Contains  the  address   of   the
|                                       destination buffer.
|  
|        14   .ETSCA     Sets the  physical  address  associated  with  a
|                        channel.  The argument block contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETSCA
|                                       in  Bits  9-17, and the length of
|                                       the argument  block,  4,  in  the
|                                       right half.
|  
|                         2    .ETCSW   Identifies the  Ethernet  channel
|                                       on  which to enable the specified
|                                       protocol.  Bits 0-8  contain  the
|                                       channel   status,  including  the
|                                       ET.CON   flag,   indicating   the
|                                       channel  is  online.   Bits  9-35
|                                       contain the channel ID.
|  
|                         3    .ETEAD   Specifies the  physical  address.
|                                       .ETEAD is two words long.  It may
|                                       not be a multicast address.
|  
|        15   .ETRPL     Returns a list of all portals on a channel.  The
|                        argument block contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETRPL
|                                       in  Bits  9-17, and the length of
|                                       the argument  block,  4,  in  the


                                   22-125
|  ETHNT. [CALLI 223]


|                                       right half.
|  
|                         2    .ETCSW   Identifies the  Ethernet  channel
|                                       on  which to enable the specified
|                                       protocol.  Bits 0-8  contain  the
|                                       channel   status,  including  the
|                                       ET.CON   flag,   indicating   the
|                                       channel  is  online.   Bits  9-35
|                                       contain the channel ID.
|  
|                         3    .ETBFL   Contains  the   length   of   the
|                                       destination buffer.
|  
|                         4    .ETBFA   Contains  the  address   of   the
|                                       destination buffer.
|  
|                        The list is returned in  the  specified  buffer,
|                        with each portal ID occupying a full word, right
|                        justified (.ETPSW format).
|  
|         16  .ETRPI     Returns all information (except counters)  about
|                        a specific portal.  The argument block contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETRPI
|                                       in  Bits  9-17, and the length of
|                                       the argument  block,  4,  in  the
|                                       right half.
|  
|                         2    .ETPSW   Returns the portal status in Bits
|                                       0-8  and  portal ID in Bits 9-35.
|                                       Use the portal ID  in  subsequent
|                                       calls using this portal.
|  
|                         3    .ETBFL   Contains  the   length   of   the
|                                       destination buffer.
|  
|                         4    .ETBFA   Contains  the  address   of   the
|                                       destination buffer.
|  
|                        The information is  returned  in  the  specified
|                        buffer.
|  
|         17  .ETRPC     Returns a list of the counters associated with a
|                        portal,   and  (optionally)  zeroes  them.   The
|                        argument block contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETRPC
|                                       in  Bits  9-17, and the length of
|                                       the argument  block,  4,  in  the
|                                       right  half.  Set the ET.FZC flag
|                                       if you want the  counters  zeroed
|                                       after    the    information    is
|                                       returned.
|  
|                         2    .ETPSW   Returns the portal status in Bits
|                                       0-8  and  portal ID in Bits 9-35.
|                                       Use the portal ID  in  subsequent
|                                       calls using this portal.
|  
|                         3    .ETBFL   Contains  the   length   of   the


                                   22-126
|                                                      ETHNT. [CALLI 223]


|                                       destination buffer.
|  
|                         4    .ETBFA   Contains  the  address   of   the
|                                       destination buffer.
|  
|         20  .ETRKL     Returns a list of all controllers on a  channel.
|                        The argument block contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN     Contains  the   function   code
|                                       .ETRKL  in  Bits  9-17,  and  the
|                                       length of the argument block,  4,
|                                       in the right half.
|  
|                         2    .ETKSW   Reserved.
|  
|                         3    .ETBFL   Contains  the   length   of   the
|                                       destination buffer.
|  
|                         4    .ETBFA   Contains  the  address   of   the
|                                       destination buffer.
|  
|                        The list is returned in  the  specified  buffer,
|                        with each portal ID occupying a full word, right
|                        justified (.ETKSW format).
|  
|         21  .ETRKI     Returns all information (except counters)  about
|                        a   specific  controller.   The  argument  block
|                        contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETRKI
|                                       in  Bits  9-17, and the lenght of
|                                       the argument  block,  4,  in  the
|                                       right half.
|  
|                         2    .ETKSW   Returns the controller status and
|                                       ID.  Bits 0-8 contain the status,
|                                       and the controller ID is in  Bits
|                                       9-35.   The  ET.KON  flag  in the
|                                       status  field  indicates  whether
|                                       the controller is online.
|  
|                         3    .ETBFL   Contains  the   length   of   the
|                                       destination buffer.
|  
|                         4    .ETBFA   Contains  the  address   of   the
|                                       destination buffer.
|  
|                        The information is  returned  in  the  specified
|                        buffer.
|  
|         22  .ETRKC     Returns a list of the counters associated with a
|                        controller,  and  (optionally) zeroes them.  The
|                        argument block contains:
|  
                         ____  ______   ________|                        Word  Symbol   Contents
|  
|                         1    .ETFCN   Contains the function code .ETRKC
|                                       in  Bits  9-17, and the length of
|                                       the argument  block,  4,  in  the
|                                       right  half.  Set the ET.FZC flag


                                   22-127
|  ETHNT. [CALLI 223]


|                                       if you want the  counters  zeroed
|                                       after    the    information    is
|                                       returend.
|  
|                         2    .ETKSW   Returns the controller status and
|                                       ID.  Bits 0-8 contain the status,
|                                       and the controller ID is in  Bits
|                                       9-35.   The  ET.KON  flag  in the
|                                       status  field  indicates  whether
|                                       the controller is online.
|  
|                         3    .ETBFL   Contains  the   length   of   the
|                                       destination buffer.
|  
|                         4    .ETBFA   Contains  the  address   of   the
|                                       destination buffer.
|  
|  Normal Return
|  
|       The requested function is performed, and information is  returned
|       as specified in the description of the function.
|  
|  Error Return
|  
|       One of the following codes is returned in the ac:
|  
        ____    ______   _____|       Code    Symbol   Error
|  
|         1     ETPRV%   Program has insufficient privileges.
|         2     ETADC%   Address check attempting to read argument block.
|         3     ETIAL%   Illegal argument list length.
|         4     ETILF%   Illegal function code specified.
|         5     ETUEE%   Unexpected Ethernet error.
|         6     ETRES%   Insufficient resources.
|         7     ETIPI%   Invalid portal ID.
|        10     ETICI%   Invalid channel ID.
|        11     ETIPT%   Invalid protocol type.
|        12     ETPIU%   Protocol type already in use.
|        13     ETPRA%   Promiscuous receiver active.
|        14     ETBAC%   Buffer address check.
|        15     ETIBS%   Invalid buffer size.
|        16     ETIBP%   Invalid byte pointer.
|        17     ETIEA%   Invalid Ethernet address.
|        20     ETPQE%   Portal quota exceeded.
|        21     ETBQE%   Buffer quota exceeded.





















                                   22-128
                                                          EXIT [CALLI 12]


                              EXIT [CALLI 12]                              EXIT [CALLI 12]



   Function

        Stops job execution and optionally resets the job.

   Calling Sequence

                EXIT     fcn-code,
                continue return

                fcn-code        where:  fcn-code is one of the function codes described below.

                continue return                continue return is the instruction to be executed if  the
                user issues a valid CONTINUE monitor command.

        The function codes and their meanings are:

        ____   ________        Code   Function

         0     Performs the following:

                o  Releases all I/O devices, closing files if necessary.

                o  Unlocks the job from core.

                o  Sets the user-mode  write-protect  bit  for  the  high
                   segment.

                o  Resets APR traps to zero.

                o  Clears PC flags.

                o  Performs a RESET and stops the job.

               If timesharing was stopped by a TRPSET monitor  call,  the
               monitor  resumes  timesharing.   A  RESET  monitor call is
               executed, and the word EXIT is typed on your terminal, and
               the terminal is left in monitor mode.  You cannot continue
               with the CONT or CCONT monitor command.

         1     Performs the following:

                o  Clears PC flags.

                o  Stops the job.

               EXIT is not printed on your terminal, and you can continue
               program  execution with the CONT or CCONT monitor command.
               If you use function code 1, you should first  RELEASE  all
               devices  and  channels;  a convenient way to do this is to
               use the RESET monitor call.  The symbol  for  EXIT  1,  is
               MONRT.

|       2-17   Reserved for use by DIGITAL.

   Related Calls

        LOGOUT, MONRT.





                                   22-129
   FILOP. [CALLI 155]


                             FILOP. [CALLI 155]                             FILOP. [CALLI 155]



   Function

        Performs various file operations, including initializing channels
        and creating, deleting, writing, reading, renaming, appending to,
        and superseding files.

   Calling Sequence

                MOVE    ac,[XWD len,addr]
                FILOP.  ac,
                  error return
                normal return
                . . .
        addr:   arglst

                len        where:  len is the length of the argument list.

                addr                addr is the address of the argument list.

        The argument block  for  FILOP. functions  1  through  6  and  13
        through 15 looks like this:

         0        9                    17 18                          35
        !===============================================================!
        !  Flags !             FO.CHN    !         Function Code        !
        !---------------------------------------------------------------!
        !                            I/O mode                           !
        !---------------------------------------------------------------!
        !                       Device name or UDX                      !
        !---------------------------------------------------------------!
        !      Output buffer header      !     Input buffer header      !
        !---------------------------------------------------------------!
        !    Number of output buffers    !   Number of input buffers    !
        !---------------------------------------------------------------!
        !      Ptr to RENAME block       !     Ptr to LOOKUP block      !
        !---------------------------------------------------------------!
        !      Length of PATH block      !      Ptr to PATH block       !
        !---------------------------------------------------------------!
        !         Project number         !      Programmer number       !
        !---------------------------------------------------------------!
        ! Length of filespec block       !    Ptr to filespec block     !
        !---------------------------------------------------------------!
|       ! Output buffer starting addr    !  Input buffer starting addr  !
|       !---------------------------------------------------------------!
|       !      Output buffer size        !      Input buffer size       !
|       !===============================================================!

        The format of the argument list (for functions 1-6 and 13-15) is:

        ______ ______    ________        Offset Symbol    Contents

           0   .FOFNC    Flags, channel number, and function code:

                         ____   ______    _______                         Bits   Symbol    Meaning

                          0     FO.PRV    Indicates that the program with
                                          appropriate  privileges  ([1,2]
                                          or    JACCT)    will    perform
                                          privileged    FILOP. functions.
                                          You must set this  bit  to  use
                                          privileged FILOP. functions.

                                   22-130
                                                       FILOP. [CALLI 155]


                         ____   ______    _______                         Bits   Symbol    Meaning

                          1     FO.ASC    Assigns  an  extended   channel
                                          number,  one  that  is  greater
                                          than 17.  When you set this bit
                                          for  an OPEN function (function
                                          codes 1 through 6) the  monitor
                                          assigns   the   next  available
                                          channel   number.    It    then
                                          performs      the     requested
                                          function.    On   return,   the
                                          monitor  returns  the  assigned
                                          channel number in FO.CHN in the
                                          argument block or, if FO.CFW is
                                          set, in the address pointed  to
                                          by the left half of the word at
                                          the   location   specified   in
                                          FO.FNC.   The  number  will  be
                                          equal to or greater than 20  so
                                          that  existing  channel  number
                                          allocations   will    not    be
                                          affected.

                          2     FO.UOC    Specifies the file that is open
                                          on    the   channel   that   is
                                          indicated in the right half  of
                                          this  word (.FOFNC).  Normally,
                                          a RENAME function is  performed
                                          on  the  file  specified in the
                                          right half of .FOLEB.  When you
                                          set   this  bit,  however,  the
                                          right   half   of   .FOLEB   is
                                          ignored,  and  the  function is
                                          performed on the file  that  is
                                          open on the specified channel.

                          3     FO.CFW    Indicates that the  right  half
                                          of  this function word contains
                                          an address.  At  that  address,
                                          you must store:

                                          channel-addr,,function-code

                                          where the channel-addr  is  the
                                          address   where   the   channel
                                          number  is  stored.   For  this
                                          format,  the  field  FO.CHN  is
                                          ignored.

                         4-8              Reserved for use by DIGITAL.

                         9-17   FO.CHN    Channel number.

                        18-35   FO.FNC    Function code (see below).

        ______ ______    ________        Offset Symbol    Contents


           1   .FOIOS    I/O status (open  mode).   Note  that  any  bits
                         appearing here may also be set by OPEN call (see
                         .OPMOD in OPEN call).

           2   .FODEV    SIXBIT device name or Universal Device Index.



                                   22-131
   FILOP. [CALLI 155]


        ______ ______    ________        Offset Symbol    Contents

           3   .FOBRH    Buffer ring header pointers:

                         ____   _______                         Bits   Meaning

                         0-17   Address of output buffer ring header.
                         18-35  Address of input buffer ring header.

                         If the value of this word  is  0,  there  is  no
                         corresponding buffer ring header.

           4   .FONBF    Number of buffers needed.  The left half is  the
                         number of output buffers needed.  The right half
                         is the number of input buffers needed.  If  zero
                         buffers are requested in a FILOP.  monitor call,
                         the monitor does not set  up  any  buffers.   It
                         also  does  not  clear  any  buffer ring that is
                         already set up, and does  not  clear  the  first
                         word  of the buffer ring header.  Thus, a FILOP.
                         causing an OPEN allows an old buffer ring to  be
                         recycled.

                         This word allows a user program to  set  up  its
                         own  buffer  ring.  If you specify 777777 octal,
                         the monitor sets up a  ring  of  2  buffers  for
                         non-disk  devices.   If  no default has been set
                         for  this  job,  the  monitor  uses  the  system
                         default  for  non-disk  devices,  or a ring of n
                         buffers for disk devices, where n  is  specified
                         by  the  SET  DEFAULT BUFFERS monitor command or
                         SETUUO.  This argument to FILOP.   performs  the
                         same  action  as  the  INBUF  and OUTBUF monitor
                         calls and is needed only for buffered I/O.

           5   .FOLEB    Pointers to RENAME and LOOKUP/ENTER blocks:

                         ____   _______                         Bits   Meaning

                         0-17   Address  of  RENAME  block  (see   RENAME
                                monitor call).
                         18-35  Address  of   LOOKUP/ENTER   block   (see
                                LOOKUP/ENTER monitor call).

           6   .FOPAT    Length of, and pointer to PATH. block (see PATH.
                         monitor  call).   The  actual  path  of the file
                         found or created is returned in this  block.   A
                         specific  path  for finding or creating the file
                         must still be specified in the LOOKUP, ENTER, or
                         RENAME argument block.

|          7   .FOPPN    Project-programmer number.  Set the FO.PRV  flag
|                        if  you  include  this  word and want it to take
|                        effect.  The  monitor  then  performs  the  file
                         operation  as  if the current job were logged in
                         under the given PPN.  If FO.PRV is set in Word 0
                         (.FOFNC),  and  a  PPN is supplied in this word,
                         your program acquires the file access rights and
                         restrictions of that PPN.  This allows you to do
                         file operations in behalf of the user whose  PPN
                         you  include here.  If you specify [1,2] in this
                         word, you acquire full file access.   This  word
                         is  ignored  if  the  job is not logged in under
                         [1,2] or does not have JACCT privileges.


                                   22-132
                                                       FILOP. [CALLI 155]


        ______ ______    ________        Offset Symbol    Contents

           10  .FOFSP    Length of and pointer to a block  in  which  the
                         full  file  specification of the new file should
                         be stored.  If you include this word,  the  file
                         specification    is    returned   automatically.
                         Alternatively,  you  can  specify  function   33
                         (.FOFIL)  to only return the file specification.
                         Refer to .FOFIL for the format of  the  returned
                         block.

|          11  .FOBSA    Buffer starting address.  The left half contains
|                        the  starting address of the output buffer ring,
|                        (FO.OSA)  the  right  half  holds  the  starting
|                        address of the input buffer ring, (FO.ISA).
|  
|          12  .FOBSZ    Size of the input and output buffers.  The  left
|                        half,  FO.OSZ,  contains the output buffer size.
|                        FO.ISZ, the right half, holds the  size  of  the
|                        input buffer.
|  
|          13  .FOMAX    Length of the FILOP. argument block.

        The function codes and their meanings are:

        ____   ______    ________        Code   Symbol    Function

          1    .FORED    Opens the file  described  by  the  LOOKUP/ENTER
                         block for reading (duplicates LOOKUP call).  You
                         must include the LOOKUP/ENTER block pointer  for
                         directory   devices  when  you  are  using  this
                         function.

          2    .FOCRE    Creates the file described by  the  LOOKUP/ENTER
                         block.  This function strictly requires creation
                         of the file; if a matching file is found in  the
                         directory,  the  error  return  is  taken.   The
                         LOOKUP/ENTER block pointer is required  for  the
                         .FOCRE function.

          3    .FOWRT    Writes the file described  by  the  LOOKUP/ENTER
                         block.   This  function  supersedes any matching
                         file in the directory, or creates  a  new  file.
                         The  LOOKUP/ENTER  block pointer is required for
                         the .FOWRT function.

          4    .FOSAU    Updates the file described by  the  LOOKUP/ENTER
                         block  in  exclusive access mode.  No other user
                         can write to this file until it is closed.   The
                         LOOKUP/ENTER  block  pointer is required for the
                         .FOSAU function.  If the specified file does not
                         exist, it will be created automatically for this
                         function.

          5    .FOMAU    Updates the file described by  the  LOOKUP/ENTER
                         block,  in multi-access mode.  This allows other
                         users  to  read  and  write   the   file.    The
                         LOOKUP/ENTER  block  pointer is required for the
                         .FOMAU function.







                                   22-133
   FILOP. [CALLI 155]


        ____   ______    ________        Code   Symbol    Function

          6    .FOAPP    Appends   to   the   file   described   in   the
                         LOOKUP/ENTER  block.   Note  that if the buffers
                         were built by this FILOP. call, the  last  block
                         of  the file will be read into the first buffer.
                         The byte count and byte pointer are set to write
                         data  immediately  after  the  last  word of the
                         file.   The  LOOKUP/ENTER   block   pointer   is
                         required for the .FOAPP function.

          7    .FOCLS    Closes the  file  associated  with  the  channel
                                                     addr                         specified  in  the  word at addr.  This function
                         does not  accept  the  standard  FILOP. argument
                         list.   Instead,  you  include  the  CLOSE flags
                                                     addr                         (refer to the CLOSE UUO) in addr+1.  The monitor
                         executes  a  GETSTS  call for the file.  The I/O
                                                         ac                         status bits are returned in the ac.  For a  list
                         of  I/O  status  bits,  refer to the appropriate
|                        device chapter in Volume  1.   If  the  argument
|                        block  is two or more words long, then the right
|                        half of .FOIOS is taken to be the optional CLOSE
|                        status bits (for example, CL.DAT or CL.NMB).  If
                         there are errors, the monitor  takes  the  error
                                                                 ac                         return and returns an error code in the ac.

         10    .FOURB    Checkpoints the file associated with the channel
                                                        addr|                        specified   in  the  word  at  addr.   Only  the
|                        function word of the FILOP.  argument  block  is
|                        required.  The monitor writes all output buffers
                         to disk, updates directories, updates  checksums
                         in  RIB  pointers,  and  updates the end-of-file
                         pointer.  The file remains open for further I/O.

                         The .FOURB function is meaningful only for files
                         that are being written.

                                               NOTE

                             If output is not complete,  the  monitor
                             writes  the  last partially filled word;
                             this may leave null bytes in the word.


         11    .FOUSI    Performs a USETI monitor  call  (specifies  next
                         block  number to be input) for a specified block
                         of  the  file  associated   with   the   channel
                                        addr                         specified  at  addr, setting that block for next
                         input.  The format of the argument list for  the
                         .FOUSI function is:

                         addr:   XWD     channo,.FOUSI
                                 EXP     blockno

                                 channo       blockno                         where:  channo  and  blockno  give  the  channel
                         number  and  block number of the file.  Refer to
                         the USETI call for more information.

                         On a normal return,  the  I/O  status  bits  are
                                         ac                         returned in the ac.  The monitor takes the error
                         return if the block number is  larger  than  the
                         specified   file   or  no  previous  LOOKUP  was
|                        executed.  .FOUSI returns error code  %ERILU  if
|                        the  argument  block  is  not  exactly two words
|                        long.

                                   22-134
                                                       FILOP. [CALLI 155]


        ____   ______    ________        Code   Symbol    Function

         12    .FOUSO    Performs a USETO monitor call  for  a  specified
                         block  of  the  file associated with the channel
                                      addr                         specified at addr, setting that block  for  next
                         output.  The format of the argument list for the
                         .FOUSO function is:

                         addr:   XWD     channo,.FOUSO
                                 EXP     blockno

                                 channo       blockno                         where:  channo  and  blockno  give  the  channel
                         number  and  block number of the file.  Refer to
                         the USETO call for more information.

                         The monitor takes the error return if not enough
                         space  is  available  or  no  previous ENTER was
|                        executed.  The I/O status word  is  returned  in
                              ac|                        the  ac for a successful return.  .FOUSO returns
|                        error code %ERILU if the argument block  is  not
|                        exactly two words long.

         13    .FORNM    Renames the file described by the RENAME  block.
                         The  LOOKUP/ENTER  block  pointer and the RENAME
                         block  pointer  are  required  for  the   .FORNM
                         function, unless the file is already open on the
                         specified channel.  However, if a file  is  open
                         on  the  channel specified in .FOFNC, and if you
                         set the flag FO.UOC in the same word,  then  the
                         right   half  of  .FOLEB  is  ignored,  and  the
                         function is performed on the open file.

         14    .FODLT    Deletes the file described by the LOOKUP  block.
                         Pointers  to  both  LOOKUP and RENAME blocks are
                         required for this function, unless you  set  the
                         flag  FO.UOC,  and a file is open on the channel
                         specified in .FOFNC.  In this  case,  the  right
                         half  of  .FOLEB  is ignored and the function is
                         performed on the open file.

         15    .FOPRE    Preallocates space for the file described by the
                         LOOKUP/ENTER   block.   This  function  is  most
                         useful for batch jobs.  If a  preallocated  file
                         is  entered  but not written, the space is still
                         allocated;  a  CLOSE  for  the  file  will   not
                         deallocate the space.

                         If the file is entered immediately  after  being
                         preallocated,   it   is   not   superseded;  any
                         subsequent ENTER to the file will supersede  it.
                         The  LOOKUP/ENTER  block pointer is required for
                         the .FOPRE function.

         16    .FOSIO    Opens a  device  for  super-I/O  (refer  to  the
                         SUSET. UUO).    The  first  four  words  of  the
                         argument list are required  for  this  function.
|                        This function does not require .FOLEB.









                                   22-135
   FILOP. [CALLI 155]


        ____   ______    ________        Code   Symbol    Function

         17    .FOINP    Performs INPUT monitor call.   Reads  data  from
                         the  file  opened on the specified channel.  The
                         argument list is:

                         addr:   XWD     channo,.FOINP
                                 addr1
|                                optional block for USETI

                                  addr1                         where:   addr1 is the address of the next buffer
                         to  be  used  in non-dump I/O, or the address of
                         the dump mode command list if  using  dump  I/O.
                         This  word  is  optional  for non-dump I/O.  For
                                          addr1                         USETI functions, addr1 is the address of a  word
|                        containing  the  block  number of the file.  The
                                                               ac|                        device status word is returned in the ac.

         20    .FOOUT    Performs OUTPUT monitor call.   Writes  data  to
                         the  file  opened on the specified channel.  The
                         argument list is:

                         addr:   XWD     channo,.FOOUT
                                 addr1
|                                optional block for USETO

                                  addr1                         where:   addr1 is the address of the next buffer
                         to  be  used  or  the  address  of the dump mode
                         command list.  For USETO functions, this address
                         is  the  location  of  a  word that contains the
|                        block number of the file.   .FOIOS  is  optional
|                        for  buffered I/O modes.  The device status word
                                            ac|                        is returned in the ac.

         21    .FOSET    Performs SETSTS monitor call.  The format of the
                         argument list is:

                         addr:   XWD     channo,.FOSET
                                 EXP     setsts-bits

|                        This function returns error code %ERILU  if  the
|                        argument block is not exactly two words long.

         22    .FOGET    Performs GETSTS monitor call.   The  I/O  status
                                                   ac                         bits  are returned in the ac.  The format of the
                         argument list is:

                         addr:   XWD     channo,.FOGET

         23    .FOREL    Performs RELEAS monitor call.  The format of the
                         argument list is:

                         addr:   XWD     channo,.FOREL

         24    .FOWAT    Waits for I/O to  finish.   The  format  of  the
                         argument list is:

                         addr:   XWD     channo,.FOWAT

         25    .FOSEK    Obsolete.






                                   22-136
                                                       FILOP. [CALLI 155]


        ____   ______    ________        Code   Symbol    Function

         26    .FORRC    Rewrites the RIB of a file if  it  has  changed.
|                        This  function  is ignored and the normal return
|                        is taken if the channel is not a disk or if  the
|                        RIB has not changed.  The argument list for this
|                        function is:

                         addr:  XWD     channo,.FORRC

         27    .FOGTF    Returns the block number of the first file on  a
|                        DECtape.   If the device on the channel is not a
|                        DECtape, the ac is not changed.  This duplicates
                         the  UGETF  call, but allows you to use extended
                         channel numbers.  The  argument  list  for  this
                         function is:

                         addr:   XWD     channo, .FOGTF

         30    .FOMTP    Performs the function  of  an  MTAPE. call,  but
                         allows you to use extended channel numbers.  The
                         MTAPE.  code is included in the FILOP.  argument
                         list as shown:

                         addr:   XWD     channo,.FOMTP
                                 EXP     n

                                                                        n                         In the argument list shown here, the value of  n
                         is   equivalent   to  the  MTAPE. code  for  the
                         function to be employed.   For  example,  EXP  1
                         would perform the MTREW. function.

|                        This function returns error code %ERILU  if  the
|                        argument block is not two or more words long.

         31    .FOUTP    Clears  a  DECtape  directory.   Duplicates  the
                         UTPCLR   call.    The  argument  list  for  this
                         function is:

                         addr:   XWD     channo, .FOUTP

|                        This  function  returns  the  ac  unchanged   if
|                        successful.

         32    .FORAW    Renames the file with the  specified  number  of
                         words  for allocation.  Same function as .FORNM,
                         but allocation in words is specified  in  .RBSIZ
                         of extended RENAME argument block.

         33    .FOFIL    Returns the file specification of the file  that
                         is  open  on  this  channel.  To return the file
                         specification as  well  as  to  perform  another
                         function,   include  Word  10  (.FOFSP)  in  the
                         argument  block  instead  of  using  the  .FOFIL
                         function.   The  argument list for this function
                         is:

                         addr:   XWD     channo,.FOFIL
                                 XWD     len,addr2

                                                                     len                         where the second word contains the length  (len)
                                       addr2                         and  address (addr2) of the block where the file
                         specification should be stored.



                                   22-137
   FILOP. [CALLI 155]


        ____   ______    ________        Code   Symbol    Function

|        34    .FOFXI    Performs an INPUT monitor call,  using  extended
|                        addressing and dump mode I/O.  The argument list
|                        is:
|  
|                        addr:   XWD     channo, .FOFXI
|                                addr1
|  
|                        where:  channo is the channel number from  which
|                        data is read from the opened file.  addr1 is the
|                        address  of  the  command  list,  which  has   a
|                        two-word  format.   The  first word contains the
|                        length of the command  list.   The  second  word
|                        holds the address where I/O should be performed.
|                        If the length is zero, the address in the second
|                        word  is  the location of the next command list.
|                        When both the length and the address  are  zero,
|                        the end of the list has been encountered.
|  
|        35    .FOFXO    Performs an OUTPUT monitor call, using  extended
|                        addressing and dump-mode I/O.  The argument list
|                        is:
|  
|                        addr:   XWD     channo, .FOFXO
|                                addr1
|  
|                        where:  channo is the channel  number  on  which
|                        data  is  written  to the opened file.  addr1 is
|                        the address of the command list.   Command  list
|                        format is described above in .FOFXI.

        The file specification is returned when you use  function  .FOFIL
        or  when  you  specify  an  address in .FOFSP (offset 10 into the
        argument  block).   For  .FOFSP,  the  following  data  block  is
        returned  at  the  address  you  specify in the right half of the
        word.  For .FOFIL, this data is returned in the argument block at
        addr2.

             ______  ______  ________             Offset  Symbol  Contents

              0      .FOFND  Reserved for use by DIGITAL.
              1      .FOFDV  Device name.
              2      .FOFFN  File name.
              3      .FOFEX  File extension.
              4      .FOFPP  PPN.
              5      .FOFSF  First SFD.
              6-10           Subsequent levels of SFDs.

        Note that words 5 through 10 are returned only where appropriate,
        and  that  the  entire  block  is ended by a zero word.  When you
        reserve the block for the file specification, be sure to  include
        space for this zero word.

        Multiple channels of a single job and/or multiple jobs can update
        a  file  simultaneously  using  FILOP.   The  monitor  imposes no
        restrictions or interlocks when a file  is  being  simultaneously
        updated.   Therefore, users must ensure that separate jobs do not
        update the same block of the same file at  the  same  time.   The
        ENQ/DEQ  Facility (refer to Chapter 8) may be used to ensure that
        such interference does  not  occur,  but  the  monitor  does  not
        require its use when simultaneously updating a file.




                                   22-138
                                                       FILOP. [CALLI 155]


        To  update  a  file  simultaneously,  your  program  performs   a
        FILOP. monitor  call  using function code 5 (.FOMAU).  A file can
        be updated in this manner when the file is idle, when it is being
        read,  or  when it is being updated by other jobs.  A file cannot
        be simultaneously updated if the file is in single-access  update
        mode;  that is, when a LOOKUP and an ENTER have been performed or
        a FILOP. has been performed with function code 4  (.FOSAU)  or  6
        (.FOAPP).

        Note that even though an extended LOOKUP/ENTER/RENAME  block  can
        be  specified  by  the  FILOP. monitor  call, your program cannot
        change the file attributes of a simultaneously updated file.  The
        current file attributes will be returned in the extended argument
        block on a LOOKUP, and those same values will  be  used  for  the
        ENTER.   In  other  words,  FILOP. uses  the LOOKUP values on the
        ENTER.

        In order to prevent excessive monitor overhead, files that are to
        be simultaneously updated should be pre-allocated into contiguous
        blocks,  if  possible.   This  will  prevent  the   creation   of
        inefficient  retrieval  pointers, and will lessen the chance that
        extended RIBs will be created.

   Normal Return

        The requested function has been performed.

   Error Return

                                        ac        Error codes are returned in the ac for the FILOP. call.  If -1 is
                        ac        returned in the ac, an invalid argument list was supplied.  Other
        error codes are identical to those used by  LOOKUP/ENTER.   These
        are  listed  in  Section  11.14,  in Volume 1.  Note that several
                                                    ac        functions return the I/O status word in the ac.
































                                   22-139
   FILOP. [CALLI 155]


   Examples

|       See Chapter 11, Monitor Calls Manual, Volume 1.

   Related Calls

        CLOSE, ENTER, GETSTS, IN/INPUT, LOOKUP, MTAPE, OPEN,  OUT/OUTPUT,
        PATH.,   RELEAS,  RENAME,  SETSTS,  SUSET.,  UGETF,  USETI/USETO,
        UTPCLR, WAIT

























































                                   22-140
                                                       FRCUUO [CALLI 106]


                             FRCUUO [CALLI 106]                             FRCUUO [CALLI 106]



   Function

        Forces a monitor command for a job or a terminal.   This  monitor
        call requires JP.POK, JACCT, or [1,2] privileges.

   Calling Sequence

                MOVE    ac,[XWD len,addr]
                FRCUUO  ac,
                  error return
                normal return
                . . .
        addr: SIXBIT /command/
|               XWD 0,jobno    \ ;optional arguments
                XWD 0,udx      /

                len|       where:  len is the length of the argument list.  If  you  give  a
|               zero len, the default is 1.

                addr                addr is the address of the argument list.

                command                command is the name of a command (from the list below).

                jobno|               jobno is the number of a logged-in job.  If you omit  the
|               jobno, or specify it as zero, the current job is assumed.

                udx                udx is the Universal Device Index for the terminal.

        The names of the commands that can be forced are:

        _______         _______        Command         Meaning

        .BPT            Forces  a   DDT   breakpoint   trap,   simulating
                        <CTRL/D>.

        .BYE            Detaches the job, this command is forced  when  a
                        dataset disconnects.

        .FCONT          Continues the job; this command is forced when  a
                        job  is continued after it was halted by "Waiting
                        for operator action." (Refer to JCONTINUE monitor
                        command in the Commands Manual.)

        .HALT           Stops the job; this command is  forced  when  you
                        type CTRL/C.

        .HELLO          Connects (greets) the job; this command is forced
                        when  a  dataset  or  network connect occurs, and
                        runs INITIA.

        .NETLD          Invokes  execution  of  the  program  which  does
                        automatic  down-line  loading  for  ANF-10 series
                        remote software.

        .RESTA          Greets the job but does not run INITIA.

        .TYPE           Types  the  current   input   buffer;   this   is
                        equivalent to typing CTRL/R.




                                   22-141
   FRCUUO [CALLI 106]


        _______         _______        Command         Meaning

|       HALT             Stops the job (regardless of CTRL/C trapping).

        INITIA          This  command  is  forced  when  the  system   is
                        initialized and is used to run INITIA for certain
                        terminals (this is controlled by MONGEN).

        KJOB            Kills the job; this command is used  to  force  a
                        job to terminate.

        USESTA          Types status information; this is  equivalent  to
                        typing either CTRL/T or the USESTAT command.

   Normal Return

                                     ac        The command is executed; the ac is unchanged.

   Error Return

            ac        The ac is cleared.

   Examples

                MOVE    T1,[XWD 2,ADDR]
                FRCUUO  T1,
                  JRST  FRCERR
                JRST    CONTIN
        ADDR:   SIXBIT  /.TYPE/
                XWD     0,0

        This code sequence displays the contents of  the  terminal  input
        buffer  for  the  current  job,  as  though  the  user  had typed
        <CTRL/R>.
































                                   22-142
                                                       GETLCH [TTCALL 6,]


                             GETLCH [TTCALL 6,]                             GETLCH [TTCALL 6,]



   Function

        Returns the line characteristics for a terminal line.

   Calling Sequence

                GETLCH  addr
                return
                . . .
        addr:   XWD     0,lineno

                addr        where:  addr is the address of the argument list.

                lineno                lineno  is  the  line  number  for  the  terminal   whose
                                                                    addr                characteristics  are  required.   If you use -1 for addr,
                the  monitor  returns  characteristics  for  your   job's
                controlling terminal.

   Normal Return

                                   addr        If the job is detached and addr contained -1, the monitor returns
        a 0 word.  On a normal return, the monitor returns the terminal's
                                 addr        UDX in the right half of addr (.UXTRM + lineno).

        The following line characteristics are returned in the left  half
                       addr        of the word at addr:

        ___    ______    ______________        Bit    Symbol    Characteristic

          0    GL.ITY    Pseudo-terminal (PTY).

          1    GL.CTY    Operator's terminal (CTY).

          2    GL.DSP    Display console (DIS).

          3    GL.DSL    Dataset line.

|         4    GL.CNE    No characters are echoed.

          5    GL.HDP    Half-duplex line.

          6    GL.REM    Remote terminal.

          7    GL.RBS    Remote batch terminal.

|       8-9              Reserved for use by DIGITAL.
|  
|        10    GL.8BM    Terminal is open in 8-bit I/O mode.

         11    GL.LIN    User has typed some input.

|        12    GL.SLV    TTY SLAVE is in effect.

         13    GL.LCM    Terminal in lowercase mode.

         14    GL.TAB    Terminal has tab capability.

         15    GL.LCP    Local copy only (no echo).




                                   22-143
   GETLCH [TTCALL 6,]


        ___    ______    ______________        Bit    Symbol    Characteristic

         16    GL.PTM    Papertape mode is on  (CTRL/Q,  CTRL/S,  and  so
                         forth,   control  papertape  motion  instead  of
                         terminal output).

         17    GL.NEC    Terminal   is    in    no-echo    mode.     This
                         characteristic  is  set by setting IO.SUP in the
|                        OPEN  call,  or   by   SETSTS,   or   by   TRMOP
|                        function .TOCOB.   This  setting  is  overridden
                         when the job goes to monitor level, and  echoing
                         resumes.   You  can clear this bit using a RESET
                         call.

        If you use an invalid line number, the monitor returns 0  in  the
                                 addr        left half of the word at addr.

   Related Calls

        GETLIN, SETSTS, TRMOP., TTCALL

   Common Errors

                             addr        Typing a comma after addr.










































                                   22-144
                                                        GETLIN [CALLI 34]


                             GETLIN [CALLI 34]                             GETLIN [CALLI 34]



   Function

        Returns the SIXBIT monitor-assigned name of the terminal attached
        to your job.

   Calling Sequence

                GETLIN  ac,
                return

   Return

                                                  ac        The SIXBIT name of the terminal is in the ac, left-justified,  in
                                   nnn        the  form  TTYnnn,  where  nnn  is  the  dynamic  terminal number
        associated with your job's terminal.

                                                         ac        If your job is not attached to any terminal, the ac contains:

                XWD     0,'nam'

                nam        Where:  nam is the right half of the  name  of  the  terminal  to
                                                                   nnn                which  your  job  was  last  attached  (that  is,  nnn in
                TTYnnn).

   Examples

                GETLIN  T1,           ;Get terminal name
                TLNN    T1,-1         ;Job detached?
                JRST    NOTTY         ;Yes
                  . . .               ;No

        This sequence gets the name of  the  terminal  for  the  job  and
        checks whether the job is currently detached.





























                                   22-145
   GETPPN [CALLI 24]


                             GETPPN [CALLI 24]                             GETPPN [CALLI 24]



   Function

        Returns the project-programmer number (PPN) for your job.

   Calling Sequence

                GETPPN  ac,
                normal return
                  alternate return

                alternate return        Where:  alternate return is taken if your program has  the  JACCT
                bit set and another job is logged in under the same PPN.

        The GETPPN monitor call returns the project number  in  the  left
                       ac        half  of  the  ac, and the programmer number in the right half of
            ac        the ac.

   Examples

                GETPPN  T1,
                JFCL
                MOVEM   T1,MYPPN

        This code gets the PPN  regardless  of  whether  the  program  is
        JACCTed.

   Related Calls

        OTHUSR

   Common Errors

        Forgetting the sequence of normal return  followed  by  alternate
        return.




























                                   22-146
                                                        GETSEG [CALLI 40]


                             GETSEG [CALLI 40]                             GETSEG [CALLI 40]



   Function

        Replaces the current program  high  segment  with  a  given  high
        segment.   Refer  to Chapter 2 for specific information about the
        implementation of this call and the state of  memory  during  the
        GETSEG operation.

   Calling Sequence

                MOVEI   ac,addr
                GETSEG  ac,
                  error return
                normal return
                . . .
        addr:   SIXBIT/device/
                SIXBIT/filename/
                SIXBIT/extension/
                EXP     0
                XWD     proj,prog       ;or PATH. pointer
|               XWD     0,addr2  \      ;core argument
|               XWD     -1,addr3 /

                addr        where:  addr is the address of the 6-word argument block.

                addr2|               addr2 is the address of a PATH block.

                device                device is the name  of  the  device  on  which  the  high
                segment resides.

                filename                filename specifies the name of the  file  containing  the
                new high segment.

                extension                extension specifies the extension of the file  containing
                the new high segment.

                proj,prog                proj,prog  is  the  project-programmer  number  for   the
                directory in which the high segment file resides.  If you
                specify this word to be zero, your default directory path
|               is  assumed.   If you specify this word as [XWD 0,addr3],
                addr3|               addr3 points to a PATH.  block containing the  full  path
                specification  for the file.  Refer to the description of
                the PATH.  monitor call for the format of a PATH. block.

|               The core argument word is optional.  If it is  zero,  the
|               high  segment  is  placed  into  the  current PC section.
|               Otherwise, addr3 is the address  containing  the  section
|               number where the high segment will be placed.

        The GETSEG monitor call allows your program to initialize a  high
        segment  from  a file or from a currently-loaded sharable segment
        without affecting your program's low segment.  This facility  can
        be  used  for  shared data segments, shared program overlays, and
        runtime routines (such as FORTRAN and COBOL object-time systems).
        On  KL  processors,  if  the  high segment obtained by the GETSEG
        monitor call is an execute-only segment, it is a  concealed  high
        segment.






                                   22-147
   GETSEG [CALLI 40]


|       You can give zeros for any  argument  except  the  file  name  or
|       device.  The defaults are:

                extension   .EXE
                PPN         default directory path


   Normal Return

        The monitor replaces the current high segment with the given high
        segment.

                                      NOTES

                If the given file contains both a high and a  low
                segment,  the  monitor  brings  in  only the high
                segment.

                The  contents  of  the   accumulators   are   not
                preserved  (this  function  varies  from  monitor
                version to monitor version).

                The left half of .JBHRL is cleared.

                The right half  of  .JBHRL  is  set  to  the  new
                highest legal user address in the high segment.

                .JBSA and .JBREN  are  cleared  if  they  contain
                addresses  in the new high segment.  This removes
                the program's start address,  so  that  an  error
                will occur on a START or REENTER command.

                Channel 0 is released by the GETSEG call.   Other
                channels  are  not released.  Refer to the RELEAS
                UUO.

        A GETSEG call made from the current program's  high  segment  can
        succeed  only if the start of the new high segment coincides with
        the normal return for the call.  Program execution returns to the
        user  program  at  the PC corresponding to the normal return from
        the GETSEG UUO  in  the  previous  segment.   It  is  the  user's
        responsibility  to  ensure  that this PC contains instructions he
        wishes to be executed.

   Error Return

        See Section 11.14 a list of GETSEG errors.

   Related Calls

        MERGE., RELEAS, RUN

   Common Errors


         o  Forgetting to save the acs over the GETSEG.

         o  Forgetting that channel 0 is destroyed.

         o  Forgetting that a GETSEG from a high segment returns  control
            to the PC in the new high segment.





                                   22-148
                                                      GETSTS [OPCODE 062]


                            GETSTS [OPCODE 062]                            GETSTS [OPCODE 062]



   Function

|       Returns the I/O status bits for a device.  Use FILOP. to  perform
|       GETSTS  on an extended I/O channel.  The specific I/O status bits
        for each device are listed in Volume 1 in the chapter specific to
        the device.

   Calling Sequence

                GETSTS channo,addr
                return
                ...
        addr:   BLOCK  1

                channo        where:  channo is the channel number of the channel for which the
                I/O status word is desired.

                addr                addr is the address of the word to receive the I/O status
                word.

   Return

        The monitor returns the I/O status bits in the right half of  the
                  addr        word  at  addr, and the data mode for I/O in the left half of the
                addr        word at addr.  The I/O status bits that are possible are:

        ____    ______  _______        Bits    Symbol  Meaning

        18-21   IO.ERR  Bit mask for device-independent I/O error flags.

        18      IO.IMP  Software detected improper data mode, or checksum
                        error occurred.

        19      IO.DER  Device error.  Refer to specific device for cause
                        of this error.

        20      IO.DTE  Data error.

        21      IO.BKT  Block  too  large,  quota   exceeded,   or   file
                        structure is full.

        22      IO.EOF  End of file was reached.

        23      IO.ACT  Device is active.

        24-29           Device-dependant error flags.  These  are  listed
                        for  each  device  in  the appropriate chapter in
                        Volume 1.

        30      IO.SYN  Synchronous mode I/O.

        31      IO.UWC  Use user's word count.

        32-35           Data mode of the I/O, indicated  by  one  of  the
                        codes that are listed in Table 11-2 in Volume 1.







                                   22-149
   GETSTS [OPCODE 062]


   Related Calls

        CLRST., ERLST., FILOP., SENSE., SETSTS, STATO, STATZ

   Common Errors

         o  Forgetting that there is only one return from the call.

         o  If you give a nonexistent or  uninitialized  channel  number,
            the  monitor  stops your job and prints the following message
            on your terminal:

                 ?I/O to unassigned channel at user PC address

                  address            where address gives the program counter for your job  at  the
            time of the failure.


















































                                   22-150
                                                        GETTAB [CALLI 41]


                             GETTAB [CALLI 41]                             GETTAB [CALLI 41]



   Function

        Returns a word from one of the monitor's GETTAB tables,  allowing
        your  program  to  read many types of job and system information.
        The GETTAB tables are listed in Chapter 23.

   Calling Sequence

                MOVE    ac,[XWD index,table]
                GETTAB  ac,
                  error return
                normal return

                index        where:  index is an index into the specified table.  If the table
                is  indexed  by  job  number,  you  can  use -1 to obtain
                information about your own job.

                If the table is indexed by job number or segment  number,
                you  can use -2 to return information about your own high
                segment.

                table                table gives the number of the GETTAB table.

   Normal Return

                                                             ac        The requested word from the table is returned in the ac.

   Error Return

        The index or the table number was invalid.

   Examples

        See Chapter 23 for examples.




























                                   22-151
   GOBSTR [CALLI 66]


                             GOBSTR [CALLI 66]                             GOBSTR [CALLI 66]



   Function

        Returns file structure names from the search list for  a  job  or
        for the system.

        To use the GOBSTR call for a job other than your  own,  you  must
        have  either  the JP.SPA privilege or the JP.SPM privilege set in
        your .GTPRV word, or you must have JACCT privileges, or  the  job
        must be logged into [1,2].

        For a discussion of file structures in a  search  list,  see  the
        SETSRC program in the Commands Manual.

   Calling Sequence

                MOVE    ac,[XWD len,addr]
                GOBSTR  ac,
                  error return
                normal return
                . . .
        addr:   EXP     jobno         ;.DFGJN
                XWD     projno,progno ;.DFGPP
                EXP     -1            ;.DFGNM for first in list        \
                EXP     0             ;.DFGNM for first after FENCE    |
                SIXBIT/structure/     ;.DFGNM for next in list         /
                EXP     0             ;.DFGDR
                BLOCK   1

                len        where:  len is the length of the argument list.

                addr                addr is the address of the argument list.

                addr                addr+2  contains  the  structure  name,  or  0,  or   -1.
                Therefore  you  can begin with the first name in the list
                               addr+2                by using -1 at addr+2; then when the monitor returns  the
                                                                   addr+2                first  name in the list, you can leave the name in addr+2
                to call for the second name, and so forth.  If  the  next
                item  in  the  list  is FENCE, the monitor returns 0.  If
                there are no more items in the list, the monitor  returns
                -1.

                jobno                jobno is the number of a logged-in job (use  -1  for  the
                current job; use 0 for the system search list).

                projno,progno                projno,progno is a project-programmer number (PPN).

                structure                structure is the SIXBIT name of a file structure.

                                        addr        I/O status bits are returned at addr+4 as follows:

        ____   ______    _______        Bits   Symbol    Meaning

         0     DF.SWL    If on, software write-protect is set.

         1     DF.SNC    If on, creation of files is not allowed on  this
                         structure,   unless   the   structure   name  is
                         explicitly included in the  file  specification.
                         Refer to Chapter 12 for more information.




                                   22-152
                                                        GOBSTR [CALLI 66]


   Normal Return

        The monitor returns the required SIXBIT structure name (or  0  or
               addr+2                             addr        -1) at addr+2, and the I/O status word at addr+4.

   Error Return

                                                                    ac        The monitor returns one of the following error codes in the ac:

             ____    ______      _______             Code    Symbol      Meaning

               3     DFGIF%      File structure name is not 0, -1,  or  a
                                 file structure name in SIXBIT.
               6     DFGPP%      The    specified    job    number    and
                                 project-programmer    number    do   not
                                 correspond.
              10     DFGNP%      Your job is not privileged.
              12     DFGLN%      The specified  length  of  the  argument
                                 block is invalid.

   Examples

        The following code reads all the structures  in  the  job  search
        list.

                MOVEI  T1,0                  ;Initialize counter
        LOOP:   MOVE   T2,[.DFGST+1,,ADDR]
                GOBSTR T2,                   ;Get next structure
                  JRST ERROR
                MOVE   T2,ADDR+.DFGNM        ;Get structure name
                MOVEM  T2,STRTAB(T1)         ;Save in table
                AOJE   T2,CONTIN             ;Last one if -1
                AOJA   T1,LOOP               ;Bump table pointer and loop
        ADDR:   EXP    JOBNO                 ;Job number
                XWD    PROJ,PROG             ;PPN
                EXP    -1                    ;Get first one in list
                EXP    0
                EXP    0
        STRTAB: BLOCK  30                    ;Space to store search list

   Related Calls

|       JOBSTR, STRUUO, SYSSTR, DSKCHR























                                   22-153
   GTNTN. [CALLI 165]


                             GTNTN. [CALLI 165]                             GTNTN. [CALLI 165]



   Function

|       Returns the node number and line number  for  a  terminal.   This
|       call is applicable to network systems only.

   Calling Sequence

                MOVE    ac,[SIXBIT/terminal-name/]     \
                MOVEI   ac,udx                         |
                MOVEI   ac,channo                      /
                GTNTN.  ac,
                  error return
                normal return

                channo        where:  channo is the channel number of the channel to which  the
                terminal is connected.

                udx                udx is the Universal Device Index for the terminal.

                terminal-name                terminal-name  is  the  monitor-assigned  name   of   the
                terminal returned when you use the GETLIN monitor call.

   Normal Return

                                                                       ac        The monitor returns the node number and the line number in the ac
        in the form:

             node-number,,line-number

            node-number        The node-number is the number of the node at which the  specified
                                    line-number        terminal  is  located.  The line-number on non-network systems is
        equivalent  to  the  terminal  number.   On  a  network   system,
        line-number|       line-number  is  the  physical line number of the terminal on the
        node to which the terminal is connected.

        Networked terminals are assigned logical line numbers from a pool
|       of  network  terminal  numbers  when  they  connect  to  a  host.
|       Therefore, the logical line number will change as the  particular
|       node  to which the terminal is attached comes on-line, and as the
|       terminal connects to, and disconnects from a host.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          0    NTNSD%    Nonexistent device.
          1    NTNAT%    Device is not a terminal.
          2    NTTNC%    Terminal is not connected.

   Related Calls

        GTXTN.








                                   22-154
                                                       GTXTN. [CALLI 166]


                             GTXTN. [CALLI 166]                             GTXTN. [CALLI 166]



   Function

|       Returns the physical name of the terminal for a  given  node  and
|       line number.  This call applies to network systems only.

   Calling Sequence

                MOVE    ac,[XWD nodeno,lineno]
                GTXTN.  ac,
                  error return
                normal return

                nodeno        Where:  nodeno is the node number for a terminal.

                lineno                lineno is the physical line number for  the  terminal  at
                the node.

   Normal Return

                                                         ac        The physical name of the terminal is returned in ac in the form:

                SIXBIT/name/

                name        Where:  name is the  physical  name  of  the  terminal  (such  as
                TTY427).

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          0    XTUNT%    Unknown terminal (node number or the line number
|                        specified  is  not  known or node or line is not
                         connected to the DECsystem-10).
          1    XTNLT%    Not a legal terminal.

   Related Calls

        GTNTN., NODE.






















                                   22-155
   HIBER [CALLI 72]


                              HIBER [CALLI 72]                              HIBER [CALLI 72]



   Function

        Suspends execution of the job until a specified event occurs.

   Calling Sequence

                MOVE    ac,[flags+sleeptime]
                HIBER   ac,
                  error return
                normal return

                flags        Where:  flags specify conditions described below.

                sleeptime|               sleeptime gives the amount of time for the job to  sleep.
                If  HB.SEC is set in flags, the sleeptime is specified in
|               seconds; otherwise, it is specified in milliseconds.

        The sleeptime is rounded upward to the next larger jiffy, with  a
        maximum of 262 seconds.  If you set HB.SEC, the maximum sleeptime
|       is about 72 minutes (at 60 Hz) or 87 minutes (at 50 Hz).  If  you
|       need   a   longer  sleeptime,  use  the .CLOCK  function  of  the
|       DAEMON UUO.  If you give the sleeptime as 0, the job sleeps until
        awakened  by  one  of  the specified events, or by a WAKE monitor
        call.

        If your job is hibernating, it can be woken  by  another  job  if
        that job has sufficient privileges.  Refer to the WAKE UUO.

        To prevent your job from oversleeping and missing an  event,  the
        monitor  sets  the  wakeup  bit even if the job is already awake.
        You can use another HIBER call to  clear  the  bit.   You  cannot
        assume that any of the specified events actually occurred to WAKE
        your job; therefore you should test for all the events  that  may
|       have  caused  your  job to awaken, and explicitly execute another
|       HIBER call if you were WAKEd unexpectedly.

        You can also clear the wake-enable bit for your job by using  the
        RESET  monitor  call.   Note  that  until the first HIBER call is
        executed, there is no protection  against  wakeup  commands  from
        other  jobs.   To  guarantee  your  job's  protection, you should
        execute a WAKE monitor call for your job,  followed  by  a  HIBER
        call  giving  the  protection  you  want.   The HIBER will return
        immediately, having set the protection codes as desired.

        The bits and their meanings are:

        ____   ______    _______        Bits   Symbol    Meaning

        0      HB.SWP    Clear the in-core protect time, making  the  job
                         available for swapping out.

        1      HB.SEC    The sleeptime is specified in seconds.

        10     HB.IPC    Wake the job when an IPCF packet  is  placed  in
                         its input queue.

        11     HB.RIO    Wake the job when asynchronous I/O is completed.

        12     HB.RPT    Wake the job for PTY activity.



                                   22-156
                                                         HIBER [CALLI 72]


        13     HB.RTL    Wake the job when a line of  terminal  input  is
                         typed  on  any terminal assigned to your job, or
                         if there is a rescanable line available  on  the
                         job's controlling terminal.


        ____   ______    _______        Bits   Symbol    Meaning

        14     HB.RTC    Wake the job when a character of terminal  input
                         is ready.

        15     HB.RWJ    Wake the job only on a WAKE  monitor  call  from
                         the job itself.  Setting this bit prevents other
                         jobs from waking your job, unless the other  job
                         is privileged.

        16     HB.RWP    Wake the job only on a WAKE monitor call from  a
                         job having the same programmer number.

        17     HB.RWT    Wake the job only on a WAKE monitor call from  a
                         job having the same project number.

   Normal Return

        When an enabled HIBER condition occurs, execution resumes at  the
        normal return.

   Error Return

        The HIBER  call  takes  the  error  return  only  if  it  is  not
        implemented on your system.

   Examples

                MOVSI   T1,(HB.RWP+HB.RWT)
                HIBER   T1,
                  JRST  ERROR

        This code sequence causes the job to sleep until  awakened  by  a
        WAKE   monitor   call   from   another   job   having   the  same
        project-programmer number.  See also RTTRP call.

   Related Calls

        SLEEP, WAKE

   Common Errors

         o  Forgetting to protect against WAKEs from other jobs.

         o  Assuming a particular event woke your job,  without  actually
            checking.














                                   22-157
   HPQ [CALLI 71]


                               HPQ [CALLI 71]                               HPQ [CALLI 71]



   Function

        Places your job in, or removes  your  job  from  a  high-priority
        scheduler queue.

        You cannot use HPQ unless your system administrator has  set  the
        privilege  value  JP.HPQ  to  a nonzero value.  This value is the
        highest priority queue you can request.   This  monitor  call  is
        primarily  intended  for  real-time  programs where fast response
                                                           _______  _____        time is critical.  Refer  to  Chapter  9  of  the  Monitor  Calls
        ______        Manual, Volume 1, for more information.

   Calling Sequence

                MOVEI   ac,queue
                HPQ     ac,
                  error return
                normal return

                queue        Where:  queue is the number of the required high priority  queue.
                The  lowest  queue  number  is 1; the highest is a system
                                                            queue                parameter (the default is 5).  If you give  queue  as  0,
                your job returns to the normal scheduler queue.

   Normal Return

        The monitor places your job in the given queue.

   Error Return

            ac                                             queue        The ac contains -1; you gave an illegal value for  queue  or  you
        are not a privileged user.

   Related Calls

        RTTRP, TRPSET, UJEN


























                                   22-158
                                                          IN [OPCODE 056]


                              IN [OPCODE 056]                              IN [OPCODE 056]



   Function

|       Reads  data  from  an  initialized  channel  into  memory.    Use
|       FILOP. to perform an IN for an extended I/O channel.

   Calling Sequence

                IN channo,addr
                normal return
                  error return


                channo        where:  channo is the number of an initialized I/O channel.

                addr                addr is one of the following:


                 o  If the channel was initialized for  dump  mode,  then
                    addr                    addr gives the address of an I/O command list.

                 o  If the channel was  initialized  for  buffered  mode,
                         addr                    then addr gives the address of the second word of the
                    next buffer to be used; if you  give  0  (the  normal
                    case), the next buffer in the ring is used.

                Note that the return locations for this call are  in  the
                reverse  order  from  the  convention  for  other  calls,
                because the normal return follows the calling instruction
                and the error return follows the normal return.

   Normal Return

        Data is input from the channel.

   Error Return

        The monitor found an end-of-file  mark  or  errors  in  the  data
        (reflected  in  the  I/O status word).  If using non-blocking I/O
        mode, the error return could indicate no available data.  This is
        indicated  by  no error bits set in the I/O status word.  Use the
        GETSTS call to read the I/O status bits.

   Examples

        See LOOKUP call.

   Related Calls

|       INPUT, OUT, OUTPUT, FILOP.













                                   22-159
   IN [OPCODE 056]


   Common Errors

         o  If the channel was not initialized, the monitor stops the job
            and prints:

                 ?I/O to unassigned channel at user PC xxxxx

         o  If the specified address is illegal, the  monitor  stops  the
            job and prints:

                 ?Address check for device yyyyyy:UUO at user PC xxxxx

         o  If the monitor cannot allocate buffers in your address space,
            the monitor stops the job and prints (see INBUF):

                 ?Address check for device yyyyyy:UUO at user PC xxxxx


















































                                   22-160
                                                       INBUF [OPCODE 064]


                             INBUF [OPCODE 064]                             INBUF [OPCODE 064]



   Function

        Sets up an input buffer ring with the specified number of buffers
|       for  a given initialized channel.  Use FILOP. to perform an INBUF
|       on an extended I/O channel.

                                      NOTE

                Buffers are  allocated  by  the  monitor  in  the
                user's  address  space  starting  at the location
|               pointed to by the contents of .JBFF.  This symbol
|               represents  a  word in the Job Data Area.  As the
|               JDA  exists  only  in  Section  0,   you   cannot
|               initialize a buffer in a non-zero section, unless
|               that section is mapped to  section  0.   Use  the
|               FILOP. monitor  call  to  specify buffer starting
|               addresses in a non-zero section.


   Calling Sequence

                INBUF channo,buffers
                return

                channo        where:  channo is the number of an initialized channel.

                buffers                buffers is the number of buffers to set up in  the  ring.
                                                buffers                For  disk  devices, if you give buffers as 0, the monitor
                uses the value given in the SET DEFAULT  BUFFERS  monitor
                command  or SETUUO.  If no value has been set, the system
                default (a  MONGEN  parameter)  is  used.   For  non-disk
                devices, 2 buffers are assumed.

   Normal Return

        The buffer ring is set up.

   Related Calls

        FILOP., OUTBUF

   Common Errors

         o  If the channel was not initialized, the monitor stops the job
            and prints:

                 ?Address check for device yyyyyy:UUO at user PC xxxxx

         o  If the monitor cannot allocate buffers in your address space,
            the monitor stops the job and prints:

                 ?Address check for device yyyyyy:UUO at user PC xxxxx

         o  If your program tries  to  use  INBUF  or  OUTBUF  to  create
            buffers  outside  the job's core image, the job cannot expand
            because the system runs out of virtual memory and the monitor
            stops the job and prints:

                 ?Illegal address in UUO at user PC xxxxx



                                   22-161
   INBUF [OPCODE 064]


|        o  If you use INBUF or OUTBUF to set  up  a  buffer  ring  in  a
|           non-zero  section, the monitor stops the job and displays the
|           following error message:
|  
|                ?Illegal INBUF/OUTBUF for device yyyyyy at user PC xxxxx





























































                                   22-162
                                                       INCHRS [TTCALL 2,]


                             INCHRS [TTCALL 2,]                             INCHRS [TTCALL 2,]



   Function

        Reads an ASCII character from the  job's  controlling  terminal's
        input  buffer,  skipping  on return if a character was available.
        INCHRS also sets "character mode," in which the program will  not
        wait  for  the  end  of  the  line  of  input  from the terminal.
        Therefore, CTRL/U, DELETE, and other line-editing characters will
        not function as they do for the monitor.  See Chapter 15 for more
        specific information.

   Calling Sequence

                INCHRS  addr
                return 1 ;no character in buffer
                return 2 ;character read from buffer
                ...
        addr:   BLOCK 1

                addr        where:  addr is the address  of  a  word  to  contain  the  input
                character  (in  bits  29  to 35); the rest of the word is
                cleared.

   Return

        If a character has been input, the monitor copies it to  bits  29
                             addr        to 35 of the word at addr.

   Related Calls

        TRMOP., TTCALL

   Common Errors

                             addr        Typing a comma after addr.




























                                   22-163
   INCHRW [TTCALL 0,]


                             INCHRW [TTCALL 0,]                             INCHRW [TTCALL 0,]



   Function

        Inputs an ASCII character from the terminal's input buffer.   The
        monitor  waits  for  a  character  if  none is available.  INCHRW
        inputs the character regardless of whether a  complete  line  has
        been  typed.   If  the  program  is  not prepared to handle every
        possible control character, you should consider using the  INCHWL
        call instead of INCHRW.

   Calling Sequence

                INCHRW addr
                return

                addr        where:  addr is the address of the  word  to  receive  the  ASCII
                input  character.   The character is placed in bits 29-35
                of the word; the rest of the word is cleared.

        If  no  character  has  been  input,  the  monitor  waits  for  a
        character.

   Return

        If a character has been input, the monitor places  the  character
                                     addr        in bits 29-35 of the word at addr.

   Related Calls

        TRMOP., TTCALL

   Common Errors

                             addr        Typing a comma after addr.





























                                   22-164
                                                        INCHSL [TTCALL ,]


                             INCHSL [TTCALL 5,]                             INCHSL [TTCALL 5,]



   Function

        Inputs a character in line mode from the terminal's input buffer,
        skipping  on  return  if the input was terminated by a line break
        character such as carriage-return/line-feed.

   Calling Sequence

                INCHSL addr
                return 1
                return 2

                addr        where:  addr is the address of the word to receive the  character
                (in bits 29 to 35); the rest of the word is cleared.

                return 1                return 1 is the return instruction when a line break  has
                not been input from the terminal

                return 2                return 2 is the return  instruction  when  a  line  break
                character has been input from the terminal.

   Return

        If a line break has been input from  the  terminal,  the  monitor
                     return 2        returns  at  return 2 with the next character of the line in bits
                                             return 1        29-35 of addr; if not, it returns at return 1.

   Related Calls

        TRMOP., TTCALL

   Common Errors

                             addr        Typing a comma after addr.




























                                   22-165
   INCHWL [TTCALL 4,]


                             INCHWL [TTCALL 4,]                             INCHWL [TTCALL 4,]



   Function

        Inputs a character from the terminal input buffer, waiting  until
|       a  break  character is encountered.  With this type of input, the
        monitor handles line-editing characters like DELETE, CTRL/R,  and
        so forth.

                        _______ _____ ______        See Chapter 15, Monitor Calls Manual, Vol.  1 for a discussion of
        break characters.

   Calling Sequence

                INCHWL addr
                return

                addr        where:  addr gives the address of the word to contain  the  input
                character; the rest of the word is cleared.

   Return

                                                        addr        The character is right-justified in the word at addr.   The  rest
        of the word is cleared.

   Related Calls

        TRMOP., TTCALL

   Common Errors

                             addr        Typing a comma after addr.
































                                   22-166
                                                        INIT [OPCODE 041]


                             INIT [OPCODE 041]                             INIT [OPCODE 041]



|  Obsolete; use OPEN or FILOP..





























































                                   22-167
   INPUT [OPCODE 066]


                             INPUT [OPCODE 066]                             INPUT [OPCODE 066]



   Function

|       Inputs data from an initialized channel to memory.  Use FILOP. to
|       perform  an  INPUT on an extended I/O channel.  INPUT is the same
        as IN, except INPUT does not give an error return if an error  or
        EOF  condition  occurs.   The user must check for such conditions
        with GETSTS, STATZ, or STATO.

                                      NOTE

                Programs doing non-blocking I/O should use the IN
                monitor call or FILOP. function .FOINP.


   Calling Sequence

                INPUT channo,addr
                return

                channo        where:  channo is the number of an initialized channel.

                addr                addr is one of the following:

                                                              addr         o  If the channel is initialized for dump mode, then addr  gives
            the address of an I/O command list.

                                                                     addr         o  If the channel is initialized for buffered  mode,  then  addr
            gives the address of the second word of the next buffer to be
            used; if you give 0 (the default), the  next  buffer  in  the
            ring is used.

   Return

        Data is input from the channel.

   Related Calls

        FILOP., IN, OUT, OUTPUT

   Common Errors

         o  If the channel was not initialized, the monitor stops the job
            and prints:

                 ?I/O to unassigned channel at user PC xxxxx

         o  If the specified address is illegal, the  monitor  stops  the
            job and prints:

                 ?Address check for device yyyyyy:UUO at user PC xxxxx

         o  If the monitor cannot allocate buffers in your address space,
            the monitor stops the job and prints:

                 ?Address check for device yyyyyy:UUO at user PC xxxxx







                                   22-168
                                                       IONDX. [CALLI 127]


                             IONDX. [CALLI 127]                             IONDX. [CALLI 127]



   Function

        Returns the Universal Device Index (UDX) for a device or channel.
        For information about terminal names and their UDXs, refer to the
        TRMNO. UUO.

   Calling Sequence

                MOVE   ac,[SIXBIT/device/] \
                MOVEI  ac,channo           /
                IONDX. ac,
                  error return
                normal return

                device        where:  device is the SIXBIT physical or logical name of a device
                for which its UDX is desired.

                channo                channo is the number of an initialized channel.

   Normal Return

        The Universal Device Index for the specified  device  or  current
        device on the specified channel is returned in the ac.

   Error Return

                 ac        If  the  ac  is  cleared,  you  gave  a  nonexistent  device   or
        SIXBIT/MPX/ as a device name.


































                                   22-169
   IONEOU [TTCALL 15,]


                            IONEOU [TTCALL 15,]                            IONEOU [TTCALL 15,]



   Function

        Sends an 8-bit image character to the terminal's output buffer.

   Calling Sequence

                IONEOU    addr
                return

                addr        where:  addr contains the 8-bit character in bits 28 to 35.

   Return

        The 8-bit character is output to the terminal.

   Related Calls

        OUTCHR

   Common Errors

                             addr        Typing a comma after addr.








































                                   22-170
|                                                      IPCFM. [CALLI 217]


                             IPCFM. [CALLI 217]|                            IPCFM. [CALLI 217]
|  
|  
|  
|  Function
|  
|       Communicates with  [SYSTEM]INFO  and  [SYSTEM]IPCC,  replacing  a
|       message exchange.
|  
|  Calling Sequence
|  
|              XMOVEI   ac,addr
|              IPCFM.   ac,
|                error return
|              normal return
|  
|       addr:  flags dest,,len
|              addr1
|              optional in-your-behalf process ID (PID)
|  
|       addr1: message block
|  
|       where: addr is the address of the packet header block.
|  
|              flags are one or both of the flags in  the  packet  header
|              block.
|  
|              dest is the destination PID.  len is  the  length  of  the
|              packet header block.
|  
|  
|       The argument block at addr is:
|  
        ______ ______    ________|       Offset Symbol    Contents
|  
|          0   .IPCMF    Flags, destination, and length  fields,  in  the
|                        following format:
|  
                         ____   ______    _______|                        Bits   Symbol    Meaning
|  
|                           0   IP.CMP    Invoking privileges.   The  job
|                                         must  have  IPCF  privileges to
|                                         use this bit.
|  
|                           1   IP.CMI    Indirect sender's PID.
|  
|                        2-14             Reserved for DIGITAL.
|  
|                        15-17  IP.CMD    Destination process  code,  one
|                                         of the following:
|  
                                          ____  ______  _______|                                         Code  Symbol  Meaning
|  
|                                           1   .IPCCC  [SYSTEM]IPCC
|                                           2   .IPCCF  System-wide [SYSTEM]INFO
|                                           3   .IPCCP  Receiver's [SYSTEM]INFO
|  
|                       18-26             Reserved for DIGITAL.
|  
|                       27-35   IP.CML    Total   length   of   argumnent
|                                         block, including .IPCMF.
|  
|       1      .IPCMP    Pointer to [SYSTEM]IPCC or [SYSTEM]INFO  message
|                        block  detailed  below.   The  pointer  may be a


                                   22-171
|  IPCFM. [CALLI 217]


|                        30-bit address or a section address (if an  IFIW
|                        is  given),  relative to the section the message
|                        block is in.   No  indexing  or  indirection  is
|                        allowed.
|  
|       2      .IPCMI    In-your-behalf word; the PID on whose behalf  to
|                        perform  this operation, 0 for your own job.  If
|                        this word is non-zero, IPCF privileges  must  be
|                        enabled  or  the  given  PID must belong to your
|                        current JCH.  If .IPCMI is on, it  contains  the
|                        address (30-bit or IFIW) of the PID.
|  
|       The message block at addr 1 for [SYSTEM]IPCC is:
|  
        ______ ______    ________|       Offset Symbol    Contents
|  
|          0   .IPCS0    Holds the caller's identifier in the left  half,
|                        and  one  of the following function codes in the
|                        right half:
|  
                         ____   ______    _______|                        Code   Symbol    Meaning
|  
|                           1   .IPCSE    Enables IPCF privileges.
|                           2   .IPCSD    Disables IPCF privileges.
|                           3   .IPCSI    Obtains PID of [SYSTEM]INFO for
|                                         user of PID.
|                           4   .IPCSF    Sets  the   program   specified
|                                         in .IPCS1     to     act     as
|                                         [SYSTEM]INFO  for  the  program
|                                         specified in .IPCS2.  If you do
|                                         not specify .IPCS2, the  system
|                                         is assumed as the default.
|                           5   .IPCSZ    Deletes PID.
|                           6   .IPCSC    Creates PID for job.
|                           7   .IPCSQ    Sets PID quota.
|                          10   .IPCSO    Changes owner  of  PID,  assign
|                                         new job number.
|                          11   .IPCSJ    Supplies job number of PID.
|                          12   .IPCSP    Gives PID list for job.
|                          13   .IPCSR    Reads job quota.
|                          16   .IPCQS    Sets PID quota.
|                          17   .IPCQR    Reads PID quota.
|                          23   .IPCLP    Locates PID in system PID table
|                                         and index.
|                          24   .IPCWP    Writes system PID table.
|                          25   .IPCRP    Reads system PID table.
|                          26   .IPCSU    Closes spooled file.
|  
|          1   .IPCS1    First argument.
|  
|          2   .IPCS2    Second argument.
|  
|          3   .IPCS3    Third argument.
|  
|       The message block for [SYSTEM]INFO is:
|  
        ______ ______    ________|       Offset Symbol    Contents
|  
|          0   .IPCI0    The left half holds the caller's identifier; the
|                        right   half   contains  one  of  the  following
|                        function codes:
|  
                         ____   ______    _______|                        Code   Symbol    Meaning



                                   22-172
|                                                      IPCFM. [CALLI 217]


|                           1   .IPCIW    What is PID (ASCIZ).
|                           2   .IPCIG    Gets PID name.
|                           3   .IPCII    Assigns PID name until reset.
|                           4   .IPCIJ    Assigns PID name until logout.
|                           5   .IPCID    Drops specific PID.
|                           6   .IPCIR    Drops names set in .IPCII.
|                           7   .IPCIL    Drops names set in .IPCIJ.
|                           10  .IPCIN    Notifies  when   the   PID   is
|                                         dropped.
|  
|          1   .IPCI1    First argument.
|  
|          2   .IPCI2    Second argument.
|  
|  Normal return
|  
|       The system process returns data in a packet to the user's message
|       block.
|  
|  Error Return
|  
|       The ac will contain one of the error  messages  documented  under
|       IPCFR. UUO.
|  
|  Related calls
|  
|       .IPCFQ, .IPCFR, .IPCFS







































                                   22-173
   IPCFQ. [CALLI 144]


                             IPCFQ. [CALLI 144]                             IPCFQ. [CALLI 144]



   Function

        Returns  information  about  a  job's  IPCF  input  queue.    The
        information  returned is the packet header block for the next (if
        any) packet in the queue of packets  sent  by  the  inter-process
        communication  facility.  The IPCF calls are described in Chapter
             _______ _____ ______|       7 of Monitor Calls Manual, Volume I.

   Calling Sequence

               MOVE ac,[XWD len,addr]
               IPCFQ. ac,
                 error return
               normal return
               . . .
        addr:  BLOCK len

                len                                              addr        where:  len is the length of the block (4 to 6 words) at addr  to
                receive returned data.

                addr                addr is the address of the block to receive the data.

   Normal Return

            ac        The ac is not changed.  The packet  header  block  for  the  next
                                                 addr        packet  in  the  queue  is  returned  at addr.  The format of the
        information returned is described in Chapter 7.

        ______ ______    ________        Offset Symbol    Contents

           0   .IPCFL    Flag word of the next packet in the queue.

           1   .IPCFS    Sender's PID.

           2   .IPCFR    Receiver's PID.

           3   .IPCFP    Length of next message and number of packets:

                         ____             _______                         Bits             Meaning

                         0-17             Length of next message.
                        18-35             Number of packets in your input
                                          queue.

           4   .IPCFU    Sender's PPN.

           5   .IPCFC    Sender's capability word:

                         ____   ______    _______                         Bits   Symbol    Meaning

                            0   IP.JAC    Sender  has  JACCT   privileges
                                          set.
                            1   IP.JLG    Sender is logged in.
                            2   IP.SXO    Sender is execute-only.
                            3   IP.POK    Sender   has    POKE. privilege
                                          (JP.POK).
                            4   IP.IPC    Sender   has   IPCF   privilege
                                          (JP.IPC).




                                   22-174
                                                       IPCFQ. [CALLI 144]


|                        5-25             Reserved.
|                          26   IP.SCN    Sender's context number.
                        27-35   IP.SJN    Sender's job number.

   Error Return

        If there is no packet in the input queue, IPCFQ. takes the  error
                                                 ac        return  and returns an error code in the ac.  The error codes for
        all IPCF calls are listed under the IPCFR. call.

   Related Calls

|       IPCFR., IPCFM., IPCFS.





















































                                   22-175
   IPCFR. [CALLI 142]


                             IPCFR. [CALLI 142]                             IPCFR. [CALLI 142]



   Function

        Retrieves a packet from the IPCF  input  queue  for  the  calling
        process.  The IPCF facility and the format of the argument blocks
                                      _______ _____ ______|       are described in Chapter 7 of Monitor Calls Manual, Volume I.

   Calling Sequence

                MOVE    ac,[XWD len,addr]
                IPCFR.  ac,
                  error return
                normal return
                . . .
        addr:   EXP     flags
                BLOCK   2
                XWD     len2,addr2
                . . .
        addr:   BLOCK len2

                len        where:  len is the length of the packet header block.

                addr                addr is the address of the packet header block.

                flags                flags is the flag word  (.IPCFL)  in  the  packet  header
                block.

                len2                len2 is the length of the packet to be retrieved.  If the
                packet  is  going  to  be a page of data, this field must
                                                                  ac                contain 512 or an error code is returned in  the  ac  and
                the IPCFR.  monitor call takes the error return.

                addr2                addr2 is the address of the packet message block.

        The retrieving process should check the contents of the flag word
        (word 0, .IPCFL).  If there is an error condition associated with
        the packet, it will be indicated  in  bits  24-29.   Error  codes
                          ac        received  in  the ac indicate an error with the monitor call (for
        example, if the packet was not received).

        If the IPCFR.  monitor call is issued but there are no packets in
        the input queue, the job cannot continue executing until a packet
        is placed in the input queue.  To prevent the job from  blocking,
        bit  0  (IP.CFB)  should be set in the flag word.  When IP.CFB is
        set and there are no packets in the input queue when  the  IPCFR.
        call  is  issued,  the  call  will  take the error return and the
                                                         ac.        monitor will return error code 3 (IPCNT%) in the ac.

        When a process is retrieving a page of data, bit 19  (IP.CFV)  in
        the  flag  word  must  be  set and the length of the data message
        block (left half of .IPCFP)  must  contain  1000  or  the  IPCFR.
        monitor call fails and the monitor returns error code 21 (IPCPR%)
        in the ac.

        If the retrieved packet is shorter than the  number  of  reserved
                           len2        words  (that  is,  len2),  the  packet is retrieved and the extra
        words are left unchanged.  If, however, the  number  of  reserved
        words is not long enough to store the packet, the IPCFR.  monitor
        call takes the error return and the monitor returns error code  5
        (IPCTL%)  in the ac.  To prevent this error, the receiver can set
        bit 4 (IP.CFT) in the flag word indicating that, if the packet is
        too long for the reserved space, the message should be truncated.

                                   22-176
                                                       IPCFR. [CALLI 142]


   Normal Return

        On a normal return, the monitor returns the  associated  variable
                               ac        (see Chapter 7) in the ac indicating that there is another packet
        waiting in the queue.  If there are no more packets in the queue,
                                   ac        the  monitor  clears  the  ac.   The  packet  retrieved  from the
        process' input queue is returned to the address specified in  the
                                                addr        IPCFR.   monitor  call  (beginning with addr).  The packet header
        block is filled in as follows:

        ______ ______    ________        Offset Symbol    Contents

           0   .IPCFL    The left half remains the same, the  right  half
                         contains flags (see Chapter 7).

           1   .IPCFS    Sender's PID.

           2   .IPCFR    Receiver's PID.

           3   .IPCFP    Length and location of data:

                         ____   ________                         Bits   Contents

                         0-17   Message length.
                        18-35   Address  of   message,   for   short-form
                                messages  (default),  or  page  number of
                                long-form messages.  If the  page  number
                                refers to a non-existent page, error code
                                IPCAC% is returned.

           4   .IPCFU    Sender's PPN.  If the argument block  length  is
                         less than 5, this word is not returned.

           5   .IPCFC    Sender's capability word:

                         ____   ______    _______                         Bits   Symbol    Meaning

                            0   IP.JAC    Sending   program   has   JACCT
                                          privileges.
                            1   IP.JLG    Sender is logged in.
                            2   IP.SXO    Sender is execute-only.
                            3   IP.POK    Sender   has    POKE. privilege
                                          (JP.POK).
                            4   IP.IPC    Sender   has   IPCF   privilege
                                          (JP.IPC).
|                        5-17             Reserved.
|                       18-26   IP.SCN    Sender's context number.
                        27-35   IP.SJN    Sender's job number.

                         If the argument block length  is  less  than  6,
                         this word is not returned.















                                   22-177
   IPCFR. [CALLI 142]


   Error Return

        The packet is not retrieved and one of the following error  codes
                           ac        is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          1    IPCAC%    Address check.
          2    IPCNL%    Packet header not long enough.
          3    IPCNP%    No packet in receiving queue.
          4    IPCIU%    Page is in use (locked in core).
          5    IPCTL%    Data too long for user's buffer.
          6    IPCDU%    Receiver's PID unknown.
          7    IPCDD%    Receiver disabled.
         10    IPCRS%    No room in sender's quota.
         11    IPCRR%    No room in receiver's quota.
         12    IPCRY%    No room in system storage.
         13    IPCUP%    Unknown page (send) or duplicate page (receive).
         14    IPCIS%    Invalid sender PID.
         15    IPCPI%    Not enough privileges.
         16    IPCUF%    Unknown function code.
         17    IPCBJ%    Illegal job number.
         20    IPCPF%    PID table full.
         21    IPCPR%    Page requested, normal text.
         22    IPCIE%    Paging I/O error.
         23    IPCBI%    Bad index for system PID table.
         24    IPCUI%    Undefined PID in system table.
         25    IPCRU%    Receiver PID unknown or does not match job.
         70    IPCFU%    [SYSTEM]INFO has unknown internal error.
         71    IPCCF%    [SYSTEM]IPCC request from [SYSTEM]INFO failed.
         72    IPCFF%    [SYSTEM]INFO failed to complete an ASSIGN.
         73    IPCQP%    PID quota exceeded.
         74    IPCBP%    Unknown PID.
         75    IPCDN%    Duplicate name.
         76    IPCNN%    No such name.
         77    IPCBN%    Name has illegal characters.

   Examples

   An example of the IPCFR.  monitor call is shown below.

               MOVE   T2,[XWD 6,PHB]     ;Length and address of packet
               IPCFR. T2,                ; To be retrieved.
                 JRST ERR
               JRST NORM

        PHB:   EXP 0                     ;No flags
               EXP 0                     ;Sender's PID
               EXP 0                     ;Receiver's PID
               10,,PMB1                  ;Length and address of packet
                                         ;Message block to be retrieved
               EXP 0                     ;PPN of sender
               EXP 0                     ;Capabilities of sender

        PMB1:  EXP 0
               EXP 0
               EXP 0
               .
               .
               .
               EXP 0





                                   22-178
                                                       IPCFR. [CALLI 142]


        On a normal return from the IPCFR.  monitor call, the packet  has
        been  retrieved  from  the  input queue.  If no packet was in the
        input queue, the call takes the error return, and error code 3 is
                         ac        returned  in the ac.  Below is an example of what a response from
        [SYSTEM]INFO could be after a request for a PID.

          PHB  20                ;The packet was sent by [SYSTEM]INFO
        PHB+1  2001              ;[SYSTEM]INFO's PID
        PHB+2  31                ;Job number of receiver
        PHB+3  4,,PMB1           ;Length and address of packet message
                                 ; block
        PHB+4  1,,2              ;PPN of sender
        PHB+5  260000,,14        ;Capabilities of sender

          PMB1 32,,3             ;User code and function code
        PMB1+1 400000,,4001      ;The requested PID
        PMB1+2 ASCIZ/CORP/       ;The symbolic name
        PMB1+3 0

        The IPCFR. monitor call can take the normal return and return  an
        error  code  in  the  flag  word of the packet header block.  For
        example, word 0 of the packet  header  block  could  contain  the
        following:

             PHB/  0520

        This means that the length of the packet message block  specified
        in  the  IPCFR.  monitor call was not long enough, so the monitor
        returned error code 5 in the flag word.  The 20 in the flag  word
        indicates  that the message in the receiver's input queue is from
        [SYSTEM]INFO.

        If a process sends a request to [SYSTEM]INFO to  obtain  the  PID
        associated  with  the  symbolic  name "FRED," the following could
        result:

        ________  ________        Location  Contents

           AC     0              ;indicating a normal return and no
                                 ;errors set in the AC; no more packets
                                 ;in queue.
          PHB     7620           ;the flag word
        PHB+1     2003           ;the sender's PID
        PHB+2     16411          ;the receiver's PID
        PHB+3     10,,PMB        ;length and addr of message block

          PMB     11,,1          ;user code and function code
        PMB+1     0              ;no response
        PMB+2     ASCIZ/FRED/    ;symbolic name

        The first word of the packet, PHB,  contains  7620.   This  value
        indicates the following

                       76   2 0
                       !    ! !
                       !    ! !
                       !    ! !->not a "returned to sender" packet
                       !    !
                       !    !->sent by [SYSTEM]INFO
                       !
                       !->error code 76 - unknown name





                                   22-179
   IPCFR. [CALLI 142]


        The call to [SYSTEM]INFO  succeeded,  and  a  normal  return  was
        taken.  The number of packets still in the queue is stored in the
        ac        ac.

        Error code 76 in the flag word indicates that the  symbolic  name
        "FRED" is not associated with any currently assigned PID.

   Related Calls

|       IPCFM., IPCFQ., IPCFS.
























































                                   22-180
                                                       IPCFS. [CALLI 143]


                             IPCFS. [CALLI 143]                             IPCFS. [CALLI 143]



   Function

        Sends an IPCF packet to the specified process.

        By giving the receiver's  PID  as  the  PID  of  [SYSTEM]INFO  or
        [SYSTEM]IPCC,  you  can obtain information from the IPCF facility
        itself (see Chapter 7).

   Calling Sequence

                MOVE   ac,[XWD len,addr]
                IPCFS. ac,
                  error return
                normal return
                . . .
        addr:   flags
                sender's PID
                receiver's PID
                XWD len,addr2
                . . .
        addr2:  message-word-0
                .
                .
                .
|               message-word-(len-1)

                len        where:  len is the length of the packet header block.  The length
                of  this  block must be equal to or greater than 4 or the
                                                             ac                monitor returns error code 2 (IPCNL%) in the ac.

                addr                addr is the address of the packet header block.

                flags                flags is the flag word in the packet header block.

                sender's PID                sender's PID is Word 1 of the packet header block.

                receiver's PID                receiver's PID is Word 2 in the packet header block.

                len2                len2 is the length of the  packet  message  block.   When
                sending  a  short-form  message,  this  value  should not
|               exceed 12 octal.  The limit may be GETTABed in %IPCML.

                addr2                addr2 is the address of the packet message block.

                message-word-0           message-word-n                message-word-0  through  message-word-n  are  the   words
                making  up  the packet message block.  Refer to Chapter 7
                for more information.

   Normal Return

                                ac|       On a normal return, the ac is unchanged and the packet  described
                                            addr|       by  the  packet  header  block  at  addr  has  been placed in the
        intended receiver's queue.

        ______ ______    ________        Offset Symbol    Contents

|          0   .IPCFL    Flags are the same as those described in Chapter
|                        7.

           1   .IPCFS    Sender's PID.


                                   22-181
   IPCFS. [CALLI 143]


        ______ ______    ________        Offset Symbol    Contents

           2   .IPCFR    Receiver's  PID.   If  you  use  the   PID   for
                         [SYSTEM]INFO   or   for  [SYSTEM]IPCC,  you  can
                         retrieve  information  from  the  IPCF  facility
                         itself (see Chapter 7).

           3   .IPCFP    Length and location of data:

                         ____   ________                         Bits   Contents

                         0-17   Message length.
                        18-35   Address of message.

   Error Return

                                                             ac        On an error return, an error code is returned in the ac  and  the
        packet  is  not  sent.   The  error  codes  are  listed under the
        IPCFR. call.

   Examples

|       This code fragment sends a packet to [SYSTEM]INFO, asking that  a
|       PID be assigned with the symbolic name LJC.

               MOVE    T1,[XWD 4,PHB] ;Length and address of packet
               IPCFS.  T1,            ; header block
                 JRST ERROR
               JRST NORMAL

|       PHB:   0                      ;This is a packet header
               0                      ;Sender's PID
|              0                      ;Receiver's PID (your [SYSTEM]INFO)
               XWD 3,PMB              ;Length and addr of message block

|       PMB:   XWD 234,.IPCII         ;Ack code and function (assigns PID)
|              0                      ;No duplicate PID
               ASCIZ/LJC/             ;Symbolic name

   Related Calls

|       IPCFM., IPCFQ., IPCFR.
























                                   22-182
                                                       JBSET. [CALLI 113]


                             JBSET. [CALLI 113]                             JBSET. [CALLI 113]



   Function

        Sets system or job parameters for another  job.   Your  job  must
        have  the  JACCT  bit set, or must be logged in under [1,2].  You
        can use the SETUUO  monitor  call  to  set  parameters  for  your
        current job.

   Calling Sequence

                MOVE   ac,[XWD len,addr]
                JBSET. ac,
                  error return
                normal return
                . . .
        addr:   XWD    0,jobno
                XWD    fcn-code,argument

                len        where:  len is the length of the argument list.

                addr                addr is the address of the argument list.

                jobno                jobno is the number of  the  job  for  which  the  SETUUO
                function is to be performed.

                fcn-code                fcn-code is one of the  function  codes  described  under
                SETUUO.

                argument                argument is an argument for the given function code.

        Refer to the SETUUO description for a list of all function  codes
        and their meanings.

   Normal Return

                                                ac        The function has been performed and the ac is left unchanged.

   Error Return

        The error return is taken if the calling job is  not  privileged,
        the  specified  job  number  is  illegal,  or the SETUUO function
        failed.





















                                   22-183
   JOBPEK [CALLI 103]


                             JOBPEK [CALLI 103]                             JOBPEK [CALLI 103]



   Function

        Reads or writes another job's core; that job's  high  segment  is
        readable but not writable.

        To use the JOBPEK call, you must have POKE  privileges  (JP.POK),
        your  program must have JACCT set, or you must be logged in under
        [1,2].

   Calling Sequence

                MOVEI  ac,addr
                JOBPEK ac,
                  error return
                normal return
                . . .
        addr:   EXP    <flags>+jobnoB17+countB35
                XWD    readaddr,writeaddr

                addr        where:  addr is the address of the argument list.

                flags                flags is one or more of the flags listed below.

                jobno                jobno (JK.JOB) is the number of the logged-in  job  whose
                core is to be read or written, stored in bits 9-17.

                count                count (JK.WCT) is the number  of  words  to  be  read  or
                written (the maximum can be obtained using GETTAB to read
                item %CNJPK from table .GTCNF), stored in bits 18-35.

                readaddr                readaddr is the location of the first word to be read.

                writeaddr                writeaddr is  the  location  of  the  first  word  to  be
                written.

        The flags and their meanings are:

        ___    ______    _______        Bit    Symbol    Meaning

          0    JK.WRT    Write the other job's core; if not set, read the
                         other job's core.

          1    JK.UPM    Read the other job's UPMP (user page map page or
                         user page table).  JK.WRT must not be set.

          2    JK.EVA    Source address is  between  340000  and  377777;
                         treat  it  as  if  it  were an executive virtual
                         address mapped through the specified job's UPMP.
                         Both JK.WRT and JK.UPM must be off.

          3    JK.AIO    Do not block if data is inaccessible (due to the
                         state  of  cache  on  SMP systems); set this bit
                         only if you set either JK.UPM or JK.EVA.

        Notice that if the other job's core is  to  be  read  (JK.WRT  is
                         readaddr        cleared),  then  readaddr  is  a  location  in  the other job and
        writeaddr        writeaddr is a location in the current  program.   If  the  other
                                                            readaddr        job's  core  is to be written (JK.WRT is set), then readaddr is a
                                            writeaddr        location in the current program and writeaddr is  a  location  in
        the other job.


                                   22-184
                                                       JOBPEK [CALLI 103]


   Normal Return

        The specified words are transferred between the other job and the
        current job.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _______        Code   Symbol    Meaning

          1    JKNPV%    Job not privileged.
          2    JKIJN%    Illegal job number.
          3    JKSWP%    Job swapped out or in transit.
          4    JKIAD%    Illegal address (source or destination).
          5    JKDNA%    Data not addressable (if JK.AIO is set), or  the
                         monitor had to wait more than one minute for the
                         job to be moved into or out of core.
          6    JKPNC%    Page not in core.
          7    JKIOE%    I/O error occurred.
|        10    JKABZ%    Target address is in  an  "allocated  but  zero"
|                        page.

   Examples

               MOVEI     T1,ADDR
               JOBPEK    T1,
                 JRST    ERROR
               JRST      CONTIN
               . . .
        ADDR:  EXP       14B17+1000B35
               XWD       10000,12000

        This example reads 1000 (octal) words from the  core  of  job  14
        into the current job's core.  Reading begins at location 10000 in
        the other job; writing begins at location 12000  in  the  current
        job.





























                                   22-185
   JOBSTR [CALLI 47]


                             JOBSTR [CALLI 47]                             JOBSTR [CALLI 47]



   Function

        Returns names of file structures in your job's search list.   For
        a discussion of file structures in a search list, see Chapter 11.

   Calling Sequence

                MOVE    ac,[XWD len,addr]
                JOBSTR  ac,
                  error return
                normal return
                . . .
        addr:   SIXBIT/str/           ;.DFJNM
                EXP     0             ;reserved
                EXP     0             ;.DFJST

                len        where:  len is the length of the argument list (.DFJBL).

                addr                addr is the  address  of  the  argument  list.   You  can
                                          str                include a structure name (str) at addr to obtain the name
                of the next structure in your job search list,  or  0  to
                obtain the first structure in your active search list, or
                -1 to obtain the first structure in  your  job's  passive
                search  list  (after  FENCE  in  search  list returned by
                SETSRC program).

                addr+1                addr+1 (.DFJDR) is reserved.

                At addr+2 (.DFJST), the monitor returns the write-protect
                flag for the structure.  The flags are:

                ____   ______   _______                Bits   Symbol   Meaning

                0      DF.SWL   Software write-protect.
                1      DF.SNC   Do not create files  on  this  structure;
                                create   only   if   specified   as  file
                                structure or a physical device name.

   Normal Return

                         addr        If you give 0 at addr, the monitor returns the first structure in
        the search list after the FENCE.

        If you give -1, the monitor returns the first  structure  in  the
        list.

        If you give a SIXBIT structure name (or leave the one the monitor
        last entered), the monitor returns the next structure name in the
        search list.  When there are no more structures in the list,  the
                                  addr        monitor  returns  -1  at  addr.   If the next item in the list is
        FENCE, the monitor returns 0.

        Therefore you can begin with the first name in the list by  using
              addr        -1 at addr.  When the monitor returns the first name in the list,
                                  addr        you can leave the name in addr to call for the second  name,  and
        so forth.






                                   22-186
                                                        JOBSTR [CALLI 47]


   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          3    DFGIF%    Illegal file structure name.
         12    DFGLN%    Illegal argument length.


   Examples

        The following example reads all structures in  the  job's  search
        list:

                MOVEI   T1,0                 ;Initialize counter
        LOOP:   MOVE    T2,[.DFJBL,,ADDR]    ;Pointer to argument block
                JOBSTR  T2,                  ;Get next structure (on 0 or -1)
                  JRST  ERROR
                MOVE    T2,ADDR+.DFJNM       ;Get structure
                MOVEM   T2,STRTAB(T1)        ;Save in table
                AOJE    T2,CONTIN            ;All done if -1
                AOJA    T1,LOOP              ;Bump table pointer and loop
        ADDR:   EXP     -1                   ;Start with the first one
                EXP     0
                EXP     0
        STRTAB: BLOCK   30                   ;Where to store search list
        CONTIN:   .
                  .
                  .

   Related Calls

        DVPHY., GOBSTR, SYSPHY, SYSTR
































                                   22-187
   JOBSTS [CALLI 61]


                             JOBSTS [CALLI 61]                             JOBSTS [CALLI 61]



   Function

        Provides  information  (including  checking   statistics)   about
        terminal   devices,   pseudo-terminals,   and   software   states
        associated with terminals.  For more information about  terminals
        and pseudo-terminals, refer to Chapter 15.

   Calling Sequence

                MOVEI  ac,udx    \
                MOVEI  ac,channo |
                MOVNI  ac,jobno  /
                JOBSTS ac,
                  error return
                normal return

                udx        where:  udx is the Universal Device Index  of  the  terminal  for
                which information is desired.

                channo                channo is the  number  of  an  I/O  channel  on  which  a
                terminal device has been opened.

                jobno                jobno is the number of a logged-in  job  associated  with
                the  terminal.   To  obtain  status of a pseudo-terminal,
                provide the job number of the controlled job.  Note  that
                the  negative  of the job number is used because positive
                values are interpreted as channels or UDXs.

   Normal Return

        The  monitor  returns  a  status  word  for  the  job,  with  the
        appropriate flags set from the following list.

        ____   ______    _______        Bits   Symbol    Meaning

          0    JB.UJA    The given job number is assigned.

          1    JB.ULI    The job is logged in.

          2    JB.UML    Terminal is at monitor level.

          3    JB.UOA    Terminal output is available.

          4    JB.UDI    The terminal is at user  level  and  is  in  the
                         input  wait state, or the terminal is at monitor
                         level and can accept a  command.   There  is  no
                         command  waiting  to  be decoded, the job is not
                         running, and the job is not stopped waiting  for
                         operator intervention.

          5    JB.UJC    JACCT is set for the job.  Note that this  means
                         that two CTRL/Cs will not stop the job.

          6    JB.URN    The job is running.  This bit is zero if the job
                         is in a wait state.

          7    JB.UFC    The terminal device is in "full  character  set"
                         mode.   This characteristic can be set using the
                         TRMOP.  UUO.



                                   22-188
                                                        JOBSTS [CALLI 61]


        ____   ______    _______        Bits   Symbol    Meaning

          8    JB.UBK    The  terminal  device  is  in  "break   on   all
                         characters"  mode.   This  characteristic can be
|                        set using the TRMOP., OPEN, or FILOP.  UUOs.

         9-10            Reserved for use by DIGITAL.

         11    JB.UNE    The terminal device is in "no echo" mode.   This
|                        characteristic  can  be  set  using  the TRMOP.,
|                        OPEN, or FILOP.  UUOs.

|        12    JB.UTO    The terminal is in terminal  output  state.   In
|                        other  words,  the  job  is  blocked waiting for
|                        terminal output.

         13    JB.UCC    The terminal characteristics have changed  since
                         last JOBSTS.

         14    JB.UNT    The terminal connected  to  the  pseudo-terminal
                         has used SET HOST to connect to another system.

       15-26             Reserved for use by DIGITAL.

       777B35  JB.UJN    Bit mask  to  contain  job  number  (0  if  none
                         assigned).

|  Since JB.UOA will be set if any output is pending, but JB.UTO will  be
|  set  if  the output buffer for the terminal is full, you can make each
|  INPUT UUO transfer more data, by testing  for  JB.UTO  before  JB.UOA,
|  then doing on INPUT for a PTY.

   Error Return

        One of the following occurred:

         o  The specified job number or channel number is invalid.

         o  There was no terminal on the specified channel.



























                                   22-189
   KDP. [CALLI 200]


                              KDP. [CALLI 200]                              KDP. [CALLI 200]



   Function:

        Loads, dumps, and starts the KMC-11 (KS systems only).

   Calling Sequence:

                MOVE    ac,[XWD len,addr]
                KDP.    ac,
                  error return
                normal return
                 ...
        addr:   EXP     fcn-code
                argument 1
                argument 2
                argument 3

                len        where:  len is the length of the argument block.

                addr                                         addr                addr is location of the argument block.  At  addr,  store
                                      fcn-code                the  function  code  (fcn-code).   The  remainder  of the
                argument block depends on the function to be performed.


   The function codes are:

        ____   ______    _______        Code   Symbol    Meaning

          1    .KDPKN    Returns in argument 1 the number of  KMC-11S  on
                         the system.

          2    .KDPDN    Returns in argument 2 the count  of  DUP-11S  on
                         the KMC that you specify in argument 1.

          3    .KDPSS    Returns  in  argument  2  the  status   of   KMC
                         specified in argument 1.

          4    .KDPHA    Halts the KMC-11 specified in argument 1.

          5    .KDPMC    Master-clears the KMC specified in argument 1.

          6    .KDPST    Starts the KMC specified in argument 1.

          7    .KDPRE    Reads the CRAM location from the  KMC  specified
                         in  argument  1 and pointed to by the address in
                         argument 2.  The  CRAM  location  is  stored  in
                         argument 3.

         10    .KDPWR    Writes in CRAM location from the  KMC  specified
                         in  argument  1,  at  the  address  specified in
                         argument 2, from the value stored in argument 3.

        101    .KDLRS    Reads line status of KMC specified  in  argument
                         1,  on line of DUP specified in argument 2.  The
                         line status is returned in the  address  pointed
                         to  by argument 3.  Argument 3 must be specified
                                               len                   addr                         as [len,,addr], where len is the length and addr
                         is  the  address of the block where status is to
                         be stored.

        102    .KDLHA    Stops DDCMP on a line specified by  the  KMC  in
                         argument 1 and the DUP in argument 2.

                                   22-190
                                                         KDP. [CALLI 200]


        ____   ______    _______        Code   Symbol    Meaning

        103    .KDLST    Starts DDCMP on a line specified by the  KMC  in
                         argument 1 and the DUP in argument 2.

        104    .KDLSU    Sets  the  line's  user.   Specify  the  KMC  in
                         argument  1,  the  DUP  in  argument  2, and the
                         SIXBIT/user/  in  argument  3.   Refer  to   the
                         DTE. call for more information about line users.

        105    .KDLRU    Returns the line's user in argument 3.  You must
                         specify  the  KMC  in  argument 1 and the DUP in
                         argument 2.

   Error Return

        One of the following error codes may be returned:

        ____   ______    _______        Code   Symbol    Meaning

          1    KDILF%    Illegal function code.
          2    KDILK%    Illegal KMC-11 number.
          3    KDALS%    Argument list too short.
          4    KDIWR%    Function is illegal when KMC-11 is running.
          5    KDICA%    Illegal CRAM address (.KDPRE or .KDPWR).
          6    KDILL%    Illegal line (DUP-11) number.
          7    KDKNR%    Function is illegal when KMC-11 is not running.
         10    KDLNS%    DDCMP was not started on the line.
         11    KDLAS%    DDCMP was already started on the line.
         13    KDUNP%    User not privileged to perform this function.




































                                   22-191
|  KNIBT. [CALLI 222]


                             KNIBT. [CALLI 222]|                            KNIBT. [CALLI 222]
|  
|  
|  
|  Function
|  
|       Provides  functions  for  starting  and   stopping   the   NIA-20
|       microprocessor,  and  reading and writing its control RAM (CRAM).
|       This call requires POKE privileges.
|  
|  Calling Sequence
|  
|              XMOVEI   ac,addr
|              KNIBT.   ac
|                error return
|              normal return
|  
|       addr:  fcncode,,len
|              CPUno,,channo
|              args
|  
|       where: addr is the address of the argument list.
|  
|              fcncode is one of the function codes described below.
|  
|              len is the length of the argument block.
|  
|              CPUno is the number of  the  CPU  to  which  the  KLNI  is
|              attached.
|  
|              channo  is  the  RH20  channel  number   of   the   NIA-20
|              microprocessor.
|  
|              args are arguments specific to the functions you  want  to
|              perform on the NIA-20.
|  
|       The format of the argument block is:
|  
        ______ ______    ________|       Offset Symbol    Contents
|  
|          0   .KBFCN    This word holds the function code and the length
|                        of  the  KNIBT.  argument block.  The left half,
|                        KB.FCN, holds one of the function  codes  listed
|                        below.    KB.ALN,  the  right  half,  holds  the
|                        length.
|  
|          1   .KBKID    This is the KLNI identification word.  The  left
|                        half,  KB.CPU,  holds the CPU number.  The right
|                        half, KB.RH2, holds the RH20 channel  number  of
|                        the  NIA-20.   The only currently valid value of
|                        KB.RH2 is 5.
|  
|          2   .KBCRA    CRAM address, the third  word  in  the  argument
|                        block  for  functions .KBSTA, .KBRED, and .KBWRT
|                        (see below).
|  
|          3   .KBCCH    Contains the high order bits (0-29) of the  CRAM
|                        for the NIA-20.  This word is used in the .KBRED
|                        and .KBWRT argument blocks.
|  
|          4   .KBCCL    Holds the low order bits (30-59) of  the  NIA-20
|                        CRAM.  .KBRED and .KBWRT also use this word.
|  
|       The function codes for .KBFCN are as follows:


                                   22-192
|                                                      KNIBT. [CALLI 222]


        ____   ______    _______|       Code   Symbol    Meaning
|  
|          1   .KBSTS    Returns the status of the KLNI in the user's ac.
|                        Status  information is returned in the following
|                        format:
|  
                         ____   ______    _______|                        Bits   Symbol    Meaning
|  
|                           0   KS.RUN    NIA-20 is running.
|                           1   KS.MAI    NIA-20 is in maintenance mode.
|                           2   KS.RLD    Reload the NIA-20.
|                           3   KS.NAR    No auto-reload flag.
|                           4   KS.ARD    Auto-reload is disabled.
|                        5-17             Reserved for DIGITAL.
|                       18-35   KS.RJB    Job  number  of  job  reloading
|                                         NIA-20.
|  
|          2   .KBSRJ    Sets the current job as the job  to  reload  the
|                        NIA-20.
|  
|          3   .KBSTP    Stops the NIA-20.   This  must  be  done  before
|                        .KBSTA, .KBRED, or .KBWRT are performed.
|  
|          4   .KBSTA    Starts the NIA-20 microprocessor at  a  specific
|                        CRAM address given in .KBCRA.
|  
|          5   .KBRED    Reads the contents of the CRAM location given in
|                        .KBCRA,  placing the CRAM words into .KBCCH, and
|                        .KBCCL.
|  
|          6   .KBWRT    Writes the contents of a specific CRAM location.
|                        .KBCRA,  .KBCCH,  and  .KBCCL  are  the argument
|                        words for .KBWRT.
|  
|  Normal Return
|  
|       The specified function is performed; status bits are returned  in
|       the ac for function .KBSTS.
|  
|  Error Return
|  
|       One of the following error codes is returned in the ac:
|  
        ____   ______    _____|       Code   Symbol    Error
|  
|         1    KBPRV%    Insufficient privileges.
|         2    KBADC%    An address check has been performed.
|         3    KBIAL%    Invalid argument list.
|         4    KBILF%    Illegal function.
|         5    KBICS%    Illegal CPU specified.
|         6    KBCNA%    CPU not available.
|         7    KBKDE%    NIA-20 doesn't exist.
|        10    KBKMM%    NIA-20 is in maintenance mode.
|        11    KBDNS%    NIA-20 microprocessor didn't start.
|        12    KBDNI%    NIA-20 microprocessor didn't initialize.
|        13    KBICA%    Invalid CRAM address.
|        14    KBCRE%    CRAM read error.
|        15    KBCWE%    CRAM write address.
|        16    KBNRJ%    Not the reload job.
|  
|  Related Call
|  
|       DIAG.



                                   22-193
|  LATOP. [CALLI 221]


|                            LATOP. [CALLI 221]
|  
|  
|  
|  Function
|  
|       Performs Local Area Terminal (LAT) functions.  This  function  is
|       not intended for customer use.
|  
|  Calling Sequence
|  
|               MOVEI   ac,addr
|               LATOP.  ac,
|                 error return
|               normal return
|  
|       addr:   EXP     len
|               function code
|               argument list
|               .  .  .
|  
|       where addr is the address of the argument list, len is the  total
|       length  of  the  argument  list including this word, and function
|       code is the function code or symbol listed below.  The  remainder
|       of the argument list differs depending on the function code.  The
|       appropriate argument list is described below for each function.
|  
|       The functions are:
|  
        ____   ______    _______|       Code   Symbol    Meaning
|  
|       0      .LASET    Sets LAT parameters for  the  local  node.   The
|                        parameters  you  set  using  this  function  are
|                        dynamic  parameters  stored  only  in  the  host
|                        software.  Your program must have JACCT or [1,2]
|                        privileges to set LAT parameters.
|  
|       The parameters you can set with .LASET are:
|  
        ____   ______    _______|       Code   Symbol    Meaning
|  
|       1      .LPMAC    Maximum number of active circuits.
|       2      .LPMCO    Maximum number of simultaneous connects.
|       3      .LPNUM    Host number.
|       4      .LPLAS    LAT access state.
|       5      .LPRLI    Circuit retransmit limit.
|       6      .LPTIM    Retransmit initial value.
|       7      .LPMTI    Multicast timer initial value.
|       10     .LPCOD    Group codes.
|       11     .LPNNM    Host node name.
|       12     .LPNID    Host node identification string.
|       13     .LPSRV    Service rating and description.
|  
|       To set parameters with codes 1  through  12,  use  the  following
|       argument list to .LASET:
|  
        ____   ______    ________|       Word   Symbol    Contents
|  
|       0      .LAACT    Argument list length.
|       1      .LAFCN    EXP     .LASET.
|       2      .LAPRM    Parameter code identifying the parameter  to  be
|                        set.
|       3      .LAVAL    Contents depend on the parameter code:



                                   22-194
|                                                      LATOP. [CALLI 221]


                         ___ _____      ______ ________|                        For Codes      .LAVAL Contains
|  
|                        1 through 7    new parameter value
|                        10             address of a bit mask
|                        11 through 13  ASCIZ string pointer
|  
|       4      .LAQUA    Qualifier (required for parameter code 13  only)
|                        contains the following:
|  
                         ___  ______    _______|                        Bit  Symbol    Meaning
|  
|                        0    LA%RAT    Rating
|                        1    LA%DSC    Service description
|  
|       5      .LADSC    ASCIZ  string  pointer  to  service  description
|                        string (LA%DSC=1).
|  
|       Argument Lists for .LASET
|  
|       The .LASET function accepts the argument list that is appropriate
|       to  the  parameter code you specify in addr+2, .LAPRM.  Parameter
|       codes 1 through 7 accept an argument directly from .LAVAL.  On  a
|       successful  return,  the parameter you specify will be set to the
|       value you include in .LAVAL.
|  
|       Parameter code 10 (group codes) requires the  address  of  a  bit
|       mask  in  .LAVAL.  The bit mask is 8 words long, representing the
|       group codes of terminals that can access the host.  The bit  mask
|       is  numbered decimally from 0 to 255, signified by bits 0 through
|       31 of each word.  Each bit you set represents a group number that
|       is allowed to access the system.
|  
|       Each word in the group code bit mask is formatted as:
|  
|       0 1 2 3 4................................31 32-----35
|       --------------------------------------------------------
|       | Each bit represents a group number        |  Ignored  |
|       --------------------------------------------------------
|  
|       The group numbers that are represented by each word, starting  at
|       ADDR:, are:
|  
             ____        _____ _______|            Word        Group Numbers
|  
|            ADDR:       0 through 31
|            ADDR+1:     32 through 63
|            ADDR+2:     64 through 95
|            ADDR+3:     96 through 127
|            ADDR+4:     128 through 159
|            ADDR+5:     160 through 191
|            ADDR+6:     192 through 223
|            ADDR+7:     224 through 255
|  
|       To specify a group code number, set the corresponding bit in  the
|       bit  mask.  For example, to set group 64, set bit 0 in the second
|       word of the bit mask.
|  
|       Parameter codes 11 and 12 require  an  ASCIZ  string  pointer  in
|       .LAVAL.   The  pointer  may be specified as a byte pointer, or in
|       the form -1,,addr, where addr is the address of the ASCIZ string.






                                   22-195
|  LATOP. [CALLI 221]


|       Parameter  code  13  allows  you  to  set  service   rating   and
|       description.   The  contents  of .LAVAL include flags and service
|       rating.  Depending on the  flags  you  set,  you  may  include  a
|       pointer in the following word, .LADSC.
|  
|       The flags you can set in .LAVAL for parameter code 13 are:
|  
        ___    ______    _______|       Bit    Symbol    Meaning
|  
|       0      LA%RAT    Sets the rating as specified in the  right  half
|                        of  this  word.   If this bit is not set, and no
|                        previous rating has been set, then the rating is
|                        automatically set to the default value.
|  
|       1      LA%DSC    Sets the service description as specified by the
|                        next word.
|  
|       If bit 1 is set, then .LADSC must contain an ASCIZ pointer  to  a
|       service description string.  If LA%DSC is set but .LADSC contains
|       0, the service description string is cleared.
|  
        ____   ______    _______|       Code   Symbol    Meaning
|  
|       1      .LACLR    Clear  specified  LAT  node  parameters.    This
|                        function requires JACCT or [1,2] privileges.
|  
|                        The argument list for  .LACLR  consists  of  the
|                        following words:
|  
                         ____   ______   ________|                        Word   Symbol   Contents
|  
|                        0      .LAACT   EXP     len
|                        1      .LAFCN   EXP     .LACLR
|                        2      .LAPRM   Parameter  code  (see   function
|                                        code 0).
|                        3      .LAVAL   Depends  on  parameter  code  in
|                                        .LAPRM.
|                                        For parameter code 10,  contains
|                                        the  address  of  the group code
|                                        bit  mask.   For  parameter  13,
|                                        contains  the  ASCIZ  pointer to
|                                        service  name  to  clear.   This
|                                        word  is  ignored  for all other
|                                        parameters.
|  
        ____   ______    _______|       Code   Symbol    Meaning
|  
|       2      .LASCH    Shows the LAT characteristics.  You can use this
|                        function  to obtain the values of both permanent
|                        and dynamic parameters.
















                                   22-196
|                                                      LATOP. [CALLI 221]


|                        The argument block for this function is:
|  
                         ____   ______   ________|                        Word   Symbol   Contents
|  
|                        0      .LAACT   EXP     len
|                        1      .LAFCN   EXP     .LASCH
|                        2      .LABCT   EXP     len1
|                        3      .LABFA   addr1
|  
|                        where len is the length of the  argument  block.
|                        The  value  of  len1  is the number of words you
|                        have   reserved   to   contain   the    returned
|                        information.   On  the  return, the left half of
|                        len1  contains  the  actual  number   of   words
|                        returned.   The  value  of addr1 is the location
|                        where the information  will  be  stored  on  the
|                        return.
|  
        ____   ______    _______|       Code   Symbol    Meaning
|  
|       3      .LASTC    Shows   connects.    This    function    returns
|                        information  about the active LAT connections at
|                        the local node.
|  
|                        The argument list is:
|  
                         ____   ______   ________|                        Word   Symbol   Contents
|  
|                        0      .LAACT   EXP     len
|                        1      .LAFCN   EXP     .LASTC
|                        2      .LABCT   EXP     len1
|                        3      .LABFN   addr1
|  
|                        where the value of len  is  the  length  of  the
|                        argument block.  The value of len1 is the number
|                        of words reserved for the information that  will
|                        be  returned.   On  the return, the left half of
|                        this word contains the actual  number  of  words
|                        returned.   The  value  of  addr1 is the address
|                        where the information will be returned.
|  
        ____   ______    _______|       Code   Symbol    Meaning
|  
|       4      .LASAS    Shows adjacent servers.  This  function  returns
|                        information  about  LAT servers that are able to
|                        access the local node.
|  
|                        The argument block for this function is:
|  
                         ____   ______   ________|                        Word   Symbol   Contents
|  
|                        0      .LAACT   EXP     len
|                        1      .LAFCN   EXP     .LASAS
|                        2      .LABCT   EXP     len1
|                        3      .LABFA   addr1
|                        4      .LAQUA   pointer 










                                   22-197
|  LATOP. [CALLI 221]


|                        where len is the length of  the  argument  list.
|                        The  value  of  len1  is  the  number  of  words
|                        reserved for the information.   On  the  return,
|                        the  left  half of this word contains the actual
|                        number of words used.  The value of addr1 is the
|                        location where the information will be returned.
|  
|                        .LAQUA contains an ASCIZ  string  pointer  to  a
|                        location  containing  the  server name.  You may
|                        specify .LAQUA to receive  information  about  a
|                        specific LAT server.  This returns a Full Format
|                        Server Block.  The default action, if this  word
|                        is  zero,  is to return a summary of all servers
|                        (Short Format Server Block).
|  
        ____   ______    _______|       Code   Symbol    Meaning
|  
|       5      .LASCO    Shows counters.  The argument list is:
|  
                         ____   ______   ________|                        Word   Symbol   Contents
|  
|                        0      .LAACT   EXP     len
|                        1      .LAFCN   EXP     .LASCO
|                        2      .LABCT   EXP     len1
|                        3      .LABFA   addr1
|                        4      .LAQUA   pointer
|  
|                        where len is the length of the  argument  block.
|                        The  value  of  len1  is  the  number  of  words
|                        reserved for information that will be  returned.
|                        On  the  return,  the  left  half  of  this word
|                        contains the actual number  of  words  returned.
|                        The  value  of  addr1  is the location where the
|                        information will be returned.
|  
|                        The last  word,  .LAQUA,  is  optional  and  may
|                        contain  an  ASCIZ  string  pointer (addr2) to a
|                        word  containing  the  server  name,  to  obtain
|                        counter  information  about the specific server.
|                        To obtain totals information, leave .LAQUA zero.
|  
        ____   ______    _______|       Code   Symbol    Meaning
|  
|       6      .LAZRO    Zeroes counters.  This function  requires  JACCT
|                        or [1,2] privileges.  The argument list is:
|  
                         ____   ______   ________|                        Word   Symbol   Contents
|  
|                        0      .LAACT   EXP     len
|                        1      .LAFCN   EXP     .LAZCO
|                        2      .LABCT   EXP     len1
|                        3      .LABFA   addr1
|                        4      .LAQUA   pointer













                                   22-198
|                                                      LATOP. [CALLI 221]


|                        where len is the length of the  argument  block.
|                        The  value  of  len1  is  the  number  of  words
|                        reserved for information that will be  returned.
|                        On  the  return, the left half of this word will
|                        contain the actual  number  of  words  returned.
|                        The  value  of  addr1  is the location where the
|                        information will be returned.
|  
|                        The last  word,  .LAQUA,  is  optional  and  may
|                        contain  an  ASCIZ  string  pointer  to  a  word
|                        containing the server name,  to  obtain  counter
|                        information  about the specific server.  To zero
|                        all totals, zero the contents of .LAQUA.
|  
|  Normal Return
|  
|       On a successful completion of the monitor call, the  skip  return
|       is  taken,  the  requested information is stored in the specified
|       locations, and the ac contains the address of the argument list.
|  
|       Several LATOP.  functions return information in a buffer starting
|       at  the  address  stored in Word 3 of the argument block, .LABFA.
|       The functions and the format  of  the  information  returned  are
|       listed below.
|  
|       Function .LASCH (Show Characteristics)
|  
|  
|                      Show Buffer Format
|  
|       0-----------------------------17  18------------------------35
|       -----------------------------------------------------------------
|       |      MAX-ALLOC-CIRCUITS         |     N-ALLOC-CIRCUITS        |
|       -----------------------------------------------------------------
|       |      MAX-ACTIVE-CIRCUITS        |     N-ACTIVE-CIRCUITS       |
|       -----------------------------------------------------------------
|       |      MAX-CONNECTS               |     N-CONNECTS              |
|       -----------------------------------------------------------------
|       |      HOST-NUMBER                |     LAT-TERMINAL-ACCESS-STA |
|       -----------------------------------------------------------------
|       |      HOST-RETRANSMIT-LIMIT      |     HOST-CIRCUIT-TIMER      |
|       -----------------------------------------------------------------
|       |      HOST-MULTICAST-TIMER       |     Reserved                |
|       -----------------------------------------------------------------
|       |      HIGH-PROTOCOL-VERSION      |     LOW-PROTOCOL-VERSION    |
|       -----------------------------------------------------------------
|       |      PROTOCOL-ECO               |     CURRENT-PROTOCOL-VERSION|
|       -----------------------------------------------------------------
|       |      MAX-SLOT-SIZE              |     MAX-SLOTS               |
|       -----------------------------------------------------------------
|       |      FRAME-SIZE                 |     MAX-SERVICES            |
|       -----------------------------------------------------------------
|       |                  HOST GROUP CODES (8 words)                   |
|       -----------------------------------------------------------------
|       |      HOST-NAME count            |     HOST-ID count           |
|       -----------------------------------------------------------------
|       |                  HOST NAME (2 words)                          |
|       -----------------------------------------------------------------
|       |                  HOST ID (13 words)                           |
|       -----------------------------------------------------------------
|       |                  Service Blocks (19 words per service)        |
|       -----------------------------------------------------------------
|       .pg
|                         Service Block Format
|  

                                   22-199
|  LATOP. [CALLI 221]


|       -----------------------------------------------------------------
|       |                  HOST-SERVICE-NAME-RATING                     |
|       -----------------------------------------------------------------
|       |      SERVICE-NAME count        |  SERVICE-DESCRIPTION count   |
|       ----------------------------------------------------------------- 
|       |                  SERVICE-NAME (4 words)                       |
|       -----------------------------------------------------------------
|       |                  SERVICE-DESCRIPTION (13 words)               |
|       -----------------------------------------------------------------
|  
|       Function .LASTC (Show Connects)
|  
|                       Connect Block Format
|  
|       -----------------------------------------------------------------
|       |                      Terminal Number                          |
|       -----------------------------------------------------------------
|       |     Server Name count         |        Indeterminate          |
|       -----------------------------------------------------------------
|       |                       Server Name (4 words)                   |
|       -----------------------------------------------------------------
|  
|  
|       Function .LASAS (Show Adjacent Servers)
|  
|                        Full Format Block
|  
|       -----------------------------------------------------------------
|       |                 Server Ethernet Address (2 words)             |
|       -----------------------------------------------------------------
|       |    FRAME-SIZE                |       SERVER-VERSION           |
|       -----------------------------------------------------------------
|       |    MAX-SLOTS                 |       Indeterminate            |
|       -----------------------------------------------------------------
|       |    CIRCUIT-TIMER             |       KEEP-ALIVE-TIMER         |
|       -----------------------------------------------------------------
|       |    PRODUCT-TYPE              |       STATE                    |
|       -----------------------------------------------------------------
|       |    SERVER-NUMBER             |       SERVER-NAME count        |
|       -----------------------------------------------------------------
|       |    SERVER-LOCATION count     |       Unused                   |
|       -----------------------------------------------------------------
|       |                      SERVER-NAME (4 words)                    |
|       -----------------------------------------------------------------
|       |                      SERVER-LOCATION (4 words)                |
|       -----------------------------------------------------------------
|  
|                       Short Format Block
|  
|       -----------------------------------------------------------------
|       |    SERVER-NUMBER             |       SERVER-NAME count        |
|       -----------------------------------------------------------------
|       |                      SERVER-NAME (4 words)                    |
|       -----------------------------------------------------------------
|       |                      ETHERNET-ADDRESS (2 words)               |
|       -----------------------------------------------------------------










                                   22-200
|                                                      LATOP. [CALLI 221]


|       Functions .LASCO (Show Counters) and .LAZCO (Zero Counters)
|  
|                       Counter Block Format
|  
|       -----------------------------------------------------------------
|       |                    Messages Received                          |
|       -----------------------------------------------------------------
|       |                    Messages Sent                              |
|       -----------------------------------------------------------------
|       |                    Messages Retransmitted                     |
|       -----------------------------------------------------------------
|       |                    Receive Sequence Errors                    |
|       |---------------------------------------------------------------|
|       |                    Illegal Messages Received                  |
|       -----------------------------------------------------------------
|       |                    Resource Failures                          |
|       -----------------------------------------------------------------
|  
|  
|  Error Return
|  
|       On an error return, the non-skip return  is  taken,  and  the  ac
|       contains an error code.  The error codes are:
|  
             ____   ______   _______|            Code   Symbol   Meaning
|  
|            0      LABTS%   The buffer size you allocated was too  small
|                            for  the  amount  of  information available.
|                            The actual number of words that are required
|                            is stored in the left half of .LABCT.
|            1      LAVOR%   Value of a parameter is outside the  allowed
|                            range.
|            2      LALNO%   LAT is not operational.
|            3      LASVR%   Invalid or unknown LAT server name.
|            4      LAIPN%   Invalid LAT parameter.
|            5      LAIPV%   Invalid LAT parameter value.
|            6      LASVC%   Invalid or unknown LAT service name.
|            7      LAILR%   Insufficient LAT resources.
|            10     LAHAS%   LAT host name already set.
|            11     LAIVF%   Invalid function code.
|            12     LAABS%   Argument list too small.
|            13     LAADC%   Address check for argument  list  (specified
|                            address not in memory)
|            14     LAPRV%   Not enough privileges.






















                                   22-201
|  LLMOP. [CALLI 220]


                             LLMOP. [CALLI 220]|                            LLMOP. [CALLI 220]
|  
|  
|  
|  Function
|  
|       Performs functions for the network management  layer  of  DECnet.
|       This call is used only by the NML program and is not intended for
|       use in customer programs.  The LLMOP. UUO may change at any  time
|       without  notice.   This  call  requires  [1,2],  JP.POK, or JACCT
|       privileges.
|  
|  Calling Sequence
|  
|               MOVE   ac1, fcncode
|               XMOVEI ac2, addr
|               LLMOP. ac2,
|                 error return
|               normal return
|  
|       where:  fcncode is the function code.  The argument  block  found
|               at  addr  is  specific  to the function code contained in
|               ac1.
|  
|               addr is the address of the argument block.
|  
|       Function codes for LLMOP.  are:
|  
        ____    ______   ________|       Code    Symbol   Function
|  
|         0     .ELDIR   Builds an Ethernet loopback  message  from  data
|                        supplied in the argument block, and transmits it
|                        to the destination address.  The argument  block
|                        is:
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                          0      .LMCID   Channel ID.  Bits  34  and  35
|                                          (LM%CID)  contain the value of
|                                          the Ethernet port to use.
|  
|                          1-2    .LMDST   Destination address.
|  
|                          3      .LMREQ   Request number, containing:
|  
                                           ____   ______   _______|                                          Bits   Symbol   Meaning
|  
|                                           0     LM%AIC   Assigns
|                                                          interrupt
|                                                          channel
|                                                          specified   in
|                                                          LM%ICH.
|  
|                                          12-17  LM%ICH   Contains   PSI
|                                                          channel     to
|                                                          interrupt when
|                                                          the    message
|                                                          arrives.








                                   22-202
|                                                      LLMOP. [CALLI 220]


        ____    ______   ________|       Code    Symbol   Function
|  
                                           ____   ______   _______|                                          Bits   Symbol   Meaning
|  
|                                          18-35  LM%REQ   Contains   the
|                                                          request number
|                                                          returned    by
|                                                          LLMOP.    This
|                                                          value is  used
|                                                          in    function
|                                                          .ELRPY.
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                          4      .LMRBL   Length of the loopback request
|                                          data  buffer.   The right half
|                                          (LM%MBL) contains  the  length
|                                          of  the  data  portion  of the
|                                          loopback message.
|  
|                          5      .LMRBP   Pointer  to  loopback  request
|                                          data buffer.
|  
|         1     .ELAST   Builds  an  Ethernet   loopback   message,   and
|                        transmits it according to the type of assistance
|                        required.   The  first  words  in  the  argument
|                        block,   .LMCID,  .LMDST,  .LMREQ,  .LMRBL,  and
|                        .LMRBP, are described in function  .ELDIR.   The
|                        remainder of the argument block is:
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                         6-7     .LMAST   Address of the  node  used  as
|                                          the  assistant in the loopback
|                                          request.  This may  not  be  a
|                                          multicast address.
|  
|                          10     .LMHLP   Assistance  level.   Level  1,
|                                          .LMXMT,  forwards the loopback
|                                          message    to     both     the
|                                          destination  and  local nodes.
|                                          Level 2, .LMRCV, forwards  the
|                                          loopback  message to assistant
|                                          and  local  nodes.   Level  3,
|                                          .LMFUL,  forwards  the message
|                                          to destination, assistant, and
|                                          local nodes.
|  
|       2       .ELRPY   Reads the loopback reply message.  The  argument
|                        block is:
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                          0      .LMCID   Channel ID.  Bits  34  and  35
|                                          (LM%CID)  contain the value of
|                                          the Ethernet port to use.
|  
|                         1-2     .LMSRC   Address of the  remote  system
|                                          that satisfied a loop assisted
|                                          operation.






                                   22-203
|  LLMOP. [CALLI 220]


        ____    ______   ________|       Code    Symbol   Function
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                          3      .LMREQ   Request  number.   The   right
|                                          half   (LM%REQ)  contains  the
|                                          request number of the reply to
|                                          be   read.    The   caller  is
|                                          blocked   until   the    reply
|                                          arrives.
|  
|                          4      .LMRBL   Length of  the  loop  response
|                                          buffer.     The    left   half
|                                          (LM%RML)  contains  on  return
|                                          the  length  of  the  received
|                                          loop reply message data.   The
|                                          right  half (LM%MBL) holds the
|                                          maximum  length  of  the  loop
|                                          response  message  buffer that
|                                          you supply.
|  
|                          5      .LMRBP   Pointer to loop reply buffer.
|  
|       3       .ELAIC   Assigns interrupt channel for Ethernet  loopback
|                        reply.  The argument block is:
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                          0      .LMCID   Channel ID, where Bits 34  and
|                                          35  (LM%CID) contain the value
|                                          of the Ethernet port to use.
|  
|                          1      .LMICF   Interrupt  channel  flags,  in
|                                          the form:
|  
                                           ____   ______   _______|                                          Bits   Symbol   Meaning
|  
|                                           0     LM%AIC   Assigns    the
|                                                          interrupt
|                                                          channel  given
|                                                          in LM%ICH when
|                                                          lit.
|  
|                                          12-17  LM%ICH   Contains   the
|                                                          PSI channel to
|                                                          interrupt when
|                                                          the   loopback
|                                                          message
|                                                          arrives.
|                                                          LM%ICH returns
|                                                          an  error  for
|                                                          all  but   the
|                                                          first  process
|                                                          to request it.
|  
|       4       .ELABT   Aborts the loop request.  The argument block is:
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                          0      .LMCID   Channel ID, where bits 34  and
|                                          35  contain  the  value of the
|                                          Ethernet port to use.




                                   22-204
|                                                      LLMOP. [CALLI 220]


        ____    ______   ________|       Code    Symbol   Function
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                          3      .LMREQ   Request  number.   The   right
|                                          half,   LM%REQ,  contains  the
|                                          number of the  request  to  be
|                                          aborted.
|  
|       5       .ELSTS   Obtains status of  Ethernet  loopback  requests.
|                        The argument block is:
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                          0      .LMCID   Channel ID, where bits 34  and
|                                          35  contain  the  value of the
|                                          Ethernet port to use.
|  
|                          1      .LMSTF   Status code for  the  request.
|                                          The    right   half,   LM%RTC,
|                                          contains one of the  following
|                                          status codes:
|  
                                           ____   ______   ______|                                          Code   Symbol   Status
|  
|                                           0     .LMPND   Request
|                                                          pending,
|                                                          incomplete.
|  
|                                           1     .LMSUC   Request
|                                                          completed
|                                                          successfully.
|  
|                                           2     .LMABT   Request
|                                                          aborted.
|  
|                                           3     .LMTXF   Transmit
|                                                          failed.
|  
|                                           4     .LMCCE   Channel
|                                                          communication
|                                                          error.
|  
|  
|                          2      .LMCST   Status returned from the  KLNI
|                                          port driver.
|  
|                          3      .LMREQ   Request  number.   The   right
|                                          half,   LM%REQ,  contains  the
|                                          number of the  request  to  be
|                                          aborted.
|  
|       6       .RCRID   Transmits a Read Identify  protocol  message  to
|                        the  destination  address  node on the Ethernet.
|                        Use the .RCRPY function to read  the  System  ID
|                        reply  message.  The argument block is identical
|                        to that of function .ELDIR.  The value  returned
|                        in   LM%REQ  of  .LMREQ  must  be  used  in  any
|                        subsequent .RCRPY, .RCABT, or .RCSTS calls.
|  
|       7       .RCRCT   Transmits a Read Counters  protocol  message  to
|                        the  destination  address  node on the Ethernet.
|                        Use the .RCRPY function to read  the  System  ID
|                        reply  message.  The argument block is identical
|                        to that of function .ELDIR.

                                   22-205
|  LLMOP. [CALLI 220]


        ____    ______   ________|       Code    Symbol   Function
|  
|       10      .RCIDS   Transmits a System ID protocol  message  to  the
|                        destination  address node on the Ethernet.  This
|                        function blocks the program until  the  transmit
|                        is completed.  The argument block is:
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                          0      .LMCID   Channel ID, where bits 34  and
|                                          35  (LM%CID) contain the value
|                                          of the Ethernet port to use.
|  
|                         1-2     .LMDST   Destination address.
|  
|       11      .RCRBT   Transmits  a  Boot  protocol  message   to   the
|                        destination   address   node  on  the  Ethernet.
|                        .RCRBT blocks  the  issuing  process  until  the
|                        transmit is completed.  The argument block is:
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                          0      .LMCID   Channel ID, where bits 34  and
|                                          35  (LM%CID) contain the value
|                                          of the Ethernet port to use.
|  
|                         1-2     .LMDST   Destination node address.
|  
|                         3-4     .LMPWD   8-byte verification code.  The
|                                          code  is  transmitted  to  the
|                                          remote system, which  uses  it
|                                          in  deciding  whether to allow
|                                          the boot request.   The  8-bit
|                                          bytes  are  packed  four  to a
|                                          word.
|  
|                          5      .LMCIF   Control  information,  in  the
|                                          form:
|  
                                           ____   ______   _______|                                          Bits   Symbol   Meaning
|  
|                                          26     LM%BDV   Specifies  the
|                                                          boot   device,
|                                                          where        0
|                                                          indicates  the
|                                                          system
|                                                          default, and 1
|                                                          represents   a
|                                                          specified
|                                                          device.
|  
|                                          27     LM%BSV   Specifies  the
|                                                          boot   server,
|                                                          where 0 is the
|                                                          system
|                                                          default, and 1
|                                                          indicates
|                                                          requesting   a
|                                                          system.







                                   22-206
|                                                      LLMOP. [CALLI 220]


        ____    ______   ________|       Code    Symbol   Function
|  
                                           ____   ______   _______|                                          Bits   Symbol   Meaning
|  
|                                          28-35  LM%PRO   Specifies  the
|                                                          processor   to
|                                                          boot.        0
|                                                          indicates  the
|                                                          system
|                                                          processor, and
|                                                          1   represents
|                                                          the
|                                                          communication
|                                                          processor.
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                        6        .LMDID   Device ID  in  an  8-bit  byte
|                                          string.
|  
|                        7        .LMSID   Software ID in an  8-bit  byte
|                                          string.
|  
|       12      .RCRPY   Reads the response  to  a  request  ID  or  Read
|                        Counters  function.   The format of the argument
|                        block  is  the  same  as  for  .ELRPY.    .LMSRC
|                        contains  the  address  of  the responding node.
|                        .LMRBL contains the returned message length, and
|                        .LMRBP   contains  a  pointer  to  the  response
|                        buffer.
|  
|       13      .RCRSV   Transmits a reserve remote console MOP  message.
|                        The  argument block contains .LMCID, .LMDST, and
|                        .LMPWD, as described in function .RCRBT.
|  
|       14      .RCREL   Transmits a release remote console MOP  message.
|                        The argument block contains .LMCID and .LMDST.
|  
|       15      .RCSND   Sends ASCII console command  data  to  a  remote
|                        console  and  polls  for  response  data.  If no
|                        command data  is  included,  the  function  only
|                        polls for response data.  The argument block is:
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                          0      .LMCID   Channel ID, in the form:
|  
                                           ____   ______   _______|                                          Bits   Symbol   Meaning
|  
|                                           16    LM%CBF   Command  break
|                                                          flag.  If this
|                                                          bit is set,  a
|                                                          break
|                                                          condition   in
|                                                          the     serial
|                                                          byte    stream
|                                                          precedes   the
|                                                          command   data
|                                                          buffer.







                                   22-207
|  LLMOP. [CALLI 220]


        ____    ______   ________|       Code    Symbol   Function
|  
                                           ____   ______   _______|                                          Bits   Symbol   Meaning
|  
|                                           17    LM%MNO   Message
|                                                          number,  which
|                                                          is  a  one-bit
|                                                          sequence
|                                                          number,
|                                                          indicating the
|                                                          current
|                                                          Console
|                                                          Requestor
|                                                          command
|                                                          message.
|  
|                                          34-35  LM%CID   Channel ID.
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                        1-2      .LMDST   Destination address.
|  
|                         3       .LMREQ   Request number,  as  described
|                                          in .ELDIR.
|  
|                         4       .LMRBL   Length  of   console   request
|                                          buffer.    The   right   half,
|                                          LM%MBL, contains  the  maximum
|                                          buffer length.
|  
|                         5       .LMRBP   Pointer to the remote  console
|                                          data buffer.
|  
|       16      .RCPOL   Polls for completion of the Send Console Command
|                        function.  The argument block is:
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                          0      .LMCID   Channel ID and returned flags,
|                                          in the form:
|  
                                           ____   ______   _______|                                          Bits   Symbol   Meaning
|  
|                                           7     LM%RDL   Indicates that
|                                                          received  data
|                                                          was lost.  The
|                                                          flag is set by
|                                                          the      local
|                                                          requestor   if
|                                                          the   response
|                                                          data    buffer
|                                                          was  to  small
|                                                          to receive the
|                                                          data from  the
|                                                          remote node.
|  
|                                          15     LM%RDO   Indicates that
|                                                          response  data
|                                                          was lost,  due
|                                                          to   a  buffer
|                                                          overrun     or
|                                                          error
|                                                          condition.



                                   22-208
|                                                      LLMOP. [CALLI 220]


        ____    ______   ________|       Code    Symbol   Function
|  
                                           ____   ______   _______|                                          Bits   Symbol   Meaning
|  
|                                          16     LM%CDL   Indicates that
|                                                          command   data
|                                                          was      lost.
|                                                          This  flag  is
|                                                          set if command
|                                                          data   in  the
|                                                          Console
|                                                          Command
|                                                          message    was
|                                                          lost.      The
|                                                          remote  server
|                                                          sets this bit.
|  
|                                          17     LM%MNO   Message
|                                                          number,  which
|                                                          is  a  one-bit
|                                                          sequence
|                                                          number,
|                                                          indicating the
|                                                          current
|                                                          Console
|                                                          Requestor
|                                                          command
|                                                          message.
|  
|                                          34-35  LM%CID   Channel ID.
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                         1-2     .LMSRC   Source   node   and   physical
|                                          address  of the node that sent
|                                          this reply.
|  
|                          3      .LMREQ   Request   ID,   assigned    by
|                                          .RCSND.
|  
|                          4      .LMRBL   Length  of  console   response
|                                          buffer.   The  format  of  the
|                                          buffer is described in .ELRPY
|  
|                          5      .LMRBP   Pointer to the remote  console
|                                          data buffer.
|  
|       20      .RCABT   Aborts an outstanding  remote  console  request.
|                        The  argument  block  is  identical  to  that of
|                        .ELABT.
|  
|       21      .RCSTS   Obtains status of a remote console request.  The
|                        argument block is identical to that of .ELSTS.













                                   22-209
|  LLMOP. [CALLI 220]


|       22      .RCADR   Obtains a channel address.  The  argument  block
|                        is:
|  
                         ______   ______   ________|                        Offset   Symbol   Contents
|  
|                           0     .LMCID   Channel ID, where bits 34  and
|                                          35  contain  the  value of the
|                                          Ethernet port to use.
|  
|                          1-2    .LMHWA   Hardware address.
|  
|                          3-4    .LMPYA   Physical address.
|  
|  Normal Return
|  
|       On  a  successful  completion,  the   requested   functions   are
|       performed,   and  any  returns  are  made  as  specified  in  the
|       description of the function code.
|  
|  Error Return
|  
|       One of the following codes is returned in the ac:
|  
        ____    ______   _____|       Code    Symbol   Error
|  
|        1      LMPRV%   Program has insufficient privileges.
|        2      LMIIF%   Program specified an illegal function.
|        3      LMICN%   Program specified an illegal channel number.
|        4      LMOFF%   LLMOP is off.





































                                   22-210
                                                        LOCATE [CALLI 62]


                             LOCATE [CALLI 62]                             LOCATE [CALLI 62]



   Function

        Changes the logical node number for the current job.   This  call
        functions  in the ANF-10 network to allow you to route device I/O
        to devices at  other  nodes.   Subsequent  references  to  output
        devices  (such  as line printers) and input devices (such as card
        readers), when implicitly requested  or  generically  referenced,
        will  be assumed to refer to devices on the node you specify with
        this call.

   Calling Sequence

                MOVE   ac,[SIXBIT/nodename/]     \
                MOVEI  ac,nodenumber             /
                LOCATE ac,
                  error return
                normal return

                nodename        where:  nodename is the SIXBIT physical name of a node.

                nodenumber                nodenumber is one of the following:

                 -1      Changes your job's location to the physical node
                         of your terminal.

                 0       Changes your job's location to that of the  host
                         computer.

                 n       Changes your job's location to  node  number  n,
                         where n is a positive integer.

   Normal Return

        The location of your job is changed as specified.  Any subsequent
        generic  device  specifications  are associated with the new node
        number and node name.

   Error Return

        The error return  occurs  if  the  LOCATE  monitor  call  is  not
        implemented  on  your system, or if you specified an invalid node
        number or node name.

   Examples

                MOVEI   T1,3
                LOCATE  T1,
                  JRST  ERROR

        Locates your job at node number 3.

   Related Calls

        WHERE








                                   22-211
   LOCK [CALLI 60]


                              LOCK [CALLI 60]                              LOCK [CALLI 60]



   Function

        Locks the current job into user memory.  Note that there are  two
        calling  sequences  for  LOCK.   The standard calling sequence is
        described under Calling  Sequence  1  and  the  extended  calling
        sequence  is  described  under  Calling Sequence 2.  The extended
        calling sequence locks a segment starting at a specified page  in
        physical memory.

        The default function of this  call  locks  the  segments  of  the
        program as set by bits 17 and 35 in the accumulator.  Bit 17 must
        be set to lock the high segment; bit 35 must be set to  lock  the
        low  segment.  The specified segment(s) is locked into physically
        contiguous memory in contiguous executive virtual  memory  space,
        unless you set flags in the accumulator to specify otherwise.
|  
|                                     NOTE
|  
|               Programs  using  user  mode  extended  addressing
|               cannot use the LOCK monitor call.

   _______ ________ _   Calling Sequence 1

                MOVE    ac,[flags]
                LOCK    ac,
                  error return
                normal return

                flags        where:  flags include one or more of the following bits:

        ___    ______    ________        Bit    Symbol    Function

         14    LK.HLC    Locks the high segment in user core and sets its
                         cache bit.  If this bit is off, the high segment
                         is  locked  with  its  cache  bit   off.    KL10
                         processors  will  run your program faster if you
                         use LK.HLC; however,  for  a  real-time  program
                         that has direct access to memory, you should not
                         set LK.HLC.

         15    LK.HNP    Locks the high segment without forcing  the  job
                         to   be   locked   into   physically  contiguous
                         locations.  If this bit  is  not  set,  physical
                         contiguity   for  the  locked  high  segment  is
                         required.

         16    LK.HNE    Locks the high segment  without  forcing  it  to
                         reside in executive virtual memory.  If this bit
                         is not set, the locked high segment must  reside
                         in executive virtual memory.

                                               NOTE

                             For executive-mode, real-time  trapping,
                             your  high  segment  must be locked into
                             contiguous executive virtual memory.

         17    LK.HLS    Locks the high segment.  Without this  bit  set,
|                        the  high  segment  will not be locked, and bits
|                        14-16 will be ignored.


                                   22-212
                                                          LOCK [CALLI 60]


        ___    ______    ________        Bit    Symbol    Function

         32    LK.LLC    Locks the low segment in user core and sets  its
                         cache  bit.  If this bit is off, the low segment
                         is locked with its cache  bit  off.   Processors
                         will  run your program faster if you use LK.LLC;
                         however, for a real-time program that has direct
                         access to memory, you should not set LK.LLC.

         33    LK.LNP    Locks the low segment without requiring physical
                         contiguous  locations  for  the low segment.  If
                         this bit is not set, the  low  segment  must  be
                         locked into physically contiguous locations.

         34    LK.LNE    Locks the low segment without requiring the  low
                         segment  to  reside in executive virtual memory.
                         If this bit is not set, the low segment must  be
                         locked into executive virtual memory.

                                               NOTE

                             For executive-mode, real-time  trapping,
                             your  low  segment  must  be locked into
                             contiguous executive virtual memory.

|        35    LK.LLS    Locks the low segment.  If this  bit  is  clear,
|                        the  lowseg  will  not be locked, and bits 32-32
|                        will be ignored.

   _______ ________ _   Calling Sequence 2

                MOVE    ac,[XWD -n,addr]
                LOCK    ac,
                  error return
                normal return
                . . .
        addr:   fcn-code
                hiseg,,lowseg

                n        where:  n is the number of arguments plus  one,  expressed  as  a
                negative value.

                addr                addr is the address of the argument block.

                fcn-code                fcn-code is the function code described below.

                hiseg                                              lowseg                hiseg is set if the high segment is to be locked.  lowseg
                is set if the low segment is to be locked.

        ____   ______    _______        Code   Symbol    Meaning

         0     .LKPPN    Locks the  high  and/or  the  low  segment  into
                         contiguous   physical  pages,  starting  at  the
                         physical page number specified in the  argument.
                                             addr+1                         The  left  half  of addr+1 contains the starting
                         page  number  of  the  high  segment;  if   this
                         halfword  is  0, the high segment is not locked.
                                           addr+1                         The right half of addr+1 contains  the  starting
                         page number of the low segment; if this halfword
                         is 0, the low segment is not locked.

        If you use Calling Sequence 2 when the  system  is  running  with
        KL-paging  the  low  segment  is  locked  into  the second higher
        physical page.


                                   22-213
   LOCK [CALLI 60]


   Normal Return

                   Calling Sequence 1        When using Calling Sequence 1, the monitor has locked the program
        into  core.   If  physical  or  executive  virtual  contiguity is
                                                             ac        required, the following information is stored in the ac:

             XWD hiseg,lowseg

                hiseg        where:  hiseg is the address of the high segment (0  if  no  high
                segment exists).

                lowseg                lowseg is the address of the low segment.

                                          ac        If no contiguity is required, the ac is cleared.

        The monitor will lock your  program  into  memory  and  take  the
        normal return if all of the following conditions are met:

         o  The lock privilege bit (JP.LCK) is set for your job.

         o  The locked job would not prevent any other job from expanding
            to its guaranteed minimum (CORMIN).

         o  The locked job would not prevent any other current  job  from
            running.  (Note that unlocked jobs can exceed CORMIN.)

         o  For executive virtual  mapping,  the  locked  job  would  not
            exceed   the  maximum  amount  of  executive  virtual  memory
            available for locking.

         o  The job either has no high segment, or has  a  sharable  high
            segment.

         o  The job is not virtual and has a contiguous core image.


                   Calling Sequence 2        When using Calling Sequence 2, the monitor  locks  the  specified
        segment  (contiguously  and  physically)  starting at the page in
        physical memory specified in your program.  If you  specify  that
        the  low segment is to be locked, the monitor locks your job into
        the next higher physical page location than the one you specified
        in the right half of your argument.

   Error Return

                                                            ac        One of the following error codes is returned in the ac:

        ____   ______    _____        Code   Symbol    Error

          0    LKNIS%    The LOCK call, or a feature  you  requested,  is
                         not implemented on your system; or you attempted
                         to lock a nonsharable high segment.
          1    LKNLP%    No locking privilege.
          2    LKNCA%    Not enough core available; your locked job would
                         prevent running an unlocked job.
          3    LKNCM%    Not enough  core  for  CORMIN;  your  job  would
                         prevent maintaining CORMIN for unlocked jobs.
          4    LKNEM%    Not enough core for  executive  virtual  memory;
                         your   locked   job  would  exceed  the  maximum
                         allowable executive  virtual  memory.   You  can
                         obtain  the executive virtual memory maximum and
                         in-use values  from  the  GETTAB  table  .GTCnV,
                         where  n  is  the CPU number.  The maximum is in
                         word 43 (%CVEVM) of the  table  and  the  in-use
                         value is in word 44 (%CVEVU).

                                   22-214
                                                          LOCK [CALLI 60]


        ____   ______    _____        Code   Symbol    Error

          5    LKNIA%    Illegal flags specified.
          6    LKNPU%    Specified page not available.  You would receive
                         this  error  on an extended LOCK call if the two
                         segments would overlap,  one  or  both  segments
                         would overlap another locked job or the monitor,
                         or one or both segments  would  be  outside  the
                         range of on-line memory.
          7    LKNAL%    Illegal movement specified.  You tried to move a
                         locked segment or place a segment into executive
                         virtual memory.

   Examples

        See Chapter 9.


















































                                   22-215
   LOGIN [CALLI 15]


                              LOGIN [CALLI 15]                              LOGIN [CALLI 15]



   Function

        Informs the monitor that a job has successfully  logged  in,  and
        passes   certain   parameters   to  the  monitor  (including  the
        project-programmer number).  The calling job must not  be  logged
        in.

        The LOGIN monitor call is used by the LOGIN and  INITIA  programs
        and is not intended for customer use.

   Calling Sequence

                MOVE    ac,[XWD -len,addr]
                LOGIN   ac,
|               return
                 ...
        addr:   proj,,prog             ;JBTPPN  (.GTPPN)
                privilege bits         ;JBTPRV  (.GTPRV)
                user-name              ;first half, .PDNM1  (.GTNM1)
                user-name              ;second half, .PDNM2 (.GTNM2)
                charge #               ;.PDCN0  (.GTCNO)

                len        where:  len is the length of the argument list.

                addr                addr is the address of the argument list.   The  data  in
                the argument list is to be passed to the monitor.

|  Return
|  
|       The job is logged in, if it is not already logged in.

   Related Calls

        ACCLG., CHGPPN, LOGOUT




























                                   22-216
X@%