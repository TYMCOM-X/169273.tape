


 










               SITBOL - A SNOBOL4 for the DECsystem-10

                              26-Jan-78

                           Version %5(303)






                    For information on SITBOL contact:
                         SITBOL Project
                         Computer Center
                         Stevens Institute of Technology
                         Hoboken, New Jersey, 07030
                         Phone:  (201) 792-2700




















Copyright (c) 1972,  1973,  1976,  1977,  1978  Stevens  Institute  of
Technology Hoboken, New Jersey.  All rights reserved.

This document is supplied for informational purposes only and  implies
no  commitment  by  Stevens  Institute of Technology for any errors in
this documentation.
SITBOL - A SNOBOL4 for the DECsystem-10                         Page 2
INTRODUCTION


1.0  INTRODUCTION

     SITBOL is a full SNOBOL4 that runs in a minimum of 3+12K or 3+16K
with  a  single  segment  (with  dynamic  growth) and is substantially
faster (up to 10 times) than the existing SNOBOL4 supplied by  Digital
Equipment  Corporation  (hereinafter  called  DECBOL).  It is tailored
more closely to the DECsystem-10 environment  with  file  manipulation
capabilities, binary mode I/O, additional keywords and sequence number
support.



   1.1  Current Limitations

        SITBOL does not support FORTRAN  formats.   Otherwise,  except
   for  minor  abberations, is upward compatible with both SNOBOL4 and
   SPITBOL.  See section 5 for a list of minor differences.



   1.2  Reprograming

        The only substantial incompatibility is that  FORTRAN  I/O  is
   not  used,  and FORTRAN-style formats are not recognized.  Also the
   IFILE and  OFILE  encumbrance  is  sidestepped.   Modifications  of
   DECBOL  and  SPITBOL  programs  to  run  under SITBOL are generally
   limited to this area and so far this has not proven difficult.  See
   section 5 for a list of minor incompatibilities.



   1.3  Character Set

        The character set is compatible with DECBOL, viz.   Back-slash
   (\)  is  the unary negation operator, exclamation (!) is the symbol
   for PATTERN  alternation,  tabs  are  syntactically  equivalent  to
   blanks  and  lower  case  identifiers  are permitted.  In addition,
   underscore (i.e.  back-arrow) is permitted in identifiers  and  can
   also  be used as an operator (assignment).  Comments may begin with
   exclamation (!), semi-colon (;) and up-arrow (^).  Up-arrow  is  an
   operator pre-defined as PATTERN alternation.  (Translation programs
   convert the EBCDIC vertical bar to up-arrow).
SITBOL - A SNOBOL4 for the DECsystem-10                         Page 3
USAGE


2.0  USAGE

   2.1  The Command String

        The command string takes the form:

             * OUTPUT-FILE , LISTING-FILE = INPUT-FILES

   (blanks surrounding delimiters are optional) 

   OUTPUT-FILE   The file  which  receives  strings  assigned  to  the
                 variable OUTPUT.  If the extension is absent (but the
                 name present) LST is assumed.

   LISTING-FILE  THE  file   containing   the   source   listing   and
                 statistics.   If absent, no listing is generated.  If
                 only the extension is absent, .LST is assumed.

   INPUT-FILES   A  sequence  of  input  files  separated  by   commas
                 containing  source  and  input  data.  A reference to
                 INPUT will begin reading from the line following  the
                 END  label.   No  End-of-File  indication is given at
                 file boundaries.



   2.2  Default I/O Associations

        INPUT and OUTPUT are associated with command string  files  as
   indicated  in  2.1.  The variable PUNCH has no pre-association.  On
   the other hand, TTY is  preassociated  with  the  teletype  (device
   TTY:) for both input and output.  For example:

        LOOP X = TTY :F(END)
             TTY = IDENT(X) 'NULL, TRY AGAIN' :S(LOOP)

   Will loop until a non-null input string is typed (or an End-of-File
   occurs indicated by ^Z).



   2.3  Switches

        Switches may appear anywhere within  the  command  string  and
   terminate with a blank or a break.



      2.3.1  /S Or /Sn - /S requests more stack.  /Sn requests n  more
      words  if n>256 or nK more words.  The default stack size (total
      for 3 stacks) is 550 words.
SITBOL - A SNOBOL4 for the DECsystem-10                         Page 4
USAGE


      2.3.2  /C Or /Cn - /C requests more initial core.  /Cn  requests
      n  words  of  initial core (or nK words if n < 256).  Since core
      expands dynamically the /C switch is not  normally  useful.   It
      can  be used to determine the nature of a bug.  If a bug repeats
      exactly with the /C switch then  it  is  not  garbage-collection
      dependent.



      2.3.3  /H - This produces a time histogram  in  file  XXXHST.TMP
      (where   XXX  is  the  current  job  number).   the  program  is
      intercepted each 1/60 of a second and  the  statement  currently
      being  executed  is  charged with one tick.  Ticks are indicated
      adjacent to each statement.  Sequence numbers in the source file
      are ignored.  Compilation-time ticks are charged to statement 1.
      Statistics-generation  and   histogram-preparation   ticks   are
      charged to the end statement.


           Other switches exist but are not too significant.



   2.4  Simplified Use Of SITBOL

   Assume that P.SNO is a SNOBOL source file and D.DAT is data.  Then:

            .EX P+D.DAT

   Will compile and execute the program.  Strings assigned  to  OUTPUT
   will  go to the file D.LST (in general, to the <last name>.LST) and
   strings read via INPUT will come from file D.DAT.  A source listing
   can be obtained via the /L switch.  Thus

             .EX P /L

   Produces a listing on P.LST as well as output on P.LST.   user  can
   supply his own file on output, eg:

             .EX X.MAC = P+D /L

   Here  the  listing  is  still  produced  on  the  .LST  file  (viz.
   D.S.RLST)  whereas  OUTPUT  is directed to X.MAC.  Here INPUT comes
   from D.SNO.
SITBOL - A SNOBOL4 for the DECsystem-10                         Page 5
USAGE


   2.5  Helpful Hints

      2.5.1  Sequence Numbers - It pays to sequence number the  source
      file  when  working from a terminal.  SITBOL recognizes sequence
      numbers  in  the  source  and  numbers  statements  accordingly.
      Hence, diagnostic and trace information is given in terms of the
      sequence numbers.  This eliminates the need for  fresh  listings
      and facilitates editing.



      2.5.2  Easy Tracing - It is generally not  necessary  to  modify
      the  source program to trace the program flow.  For example, let
      ALPHA.SNO be a SNOBOL4 source program.  Then:

              .R SNOBOL
              *,ALPHA
                      TRACE('A') ;  TRACE('B')
                      TRACE('LAB','L')
                      TRACE('STCOUNT','K')
              ^Z

      will trace variables A and B, label LAB and keyword &STCOUNT.



   2.6  Error Messages

   When a error occurs which is not trapped, a message is printed  out
   which  consists  of  an error-name and an error message.  The error
   name is a six character abbreviation for the error such as  SNOUFO,
   which  is  an  abbreviation for 'Reference to undefined function or
   operator.'.  The verbosity of the error message  is  determined  by
   the  keyword  &ERRLEVEL,  which  is  explained  further  in section
   4.3.1.10.  an example of  a  typical  error  message  would  be  as
   follows:

            ?SNOTUL in statement 4 at level 0
            Transfer to an undefined label.



3.0  I/O PROGRAMMING

     In the following, file means any file specification (in the usual
format, viz.
      DEVICE :  NAME .  EXT [PROJ,PROG,SFD1,SFD2,SFD3,...] <PROT>

With any parts missing and with the usual defaults).  But if the  name
is  missing  and  if  the  ext  is  'ufd'  the [proj,prog] is taken to
designate a file directory number.  Stream means any sequence of  file
specifications separated by commas.
SITBOL - A SNOBOL4 for the DECsystem-10                         Page 6
I/O PROGRAMMING


   3.1  Variable Associations

      3.1.1  INPUT(name,stream,format) - Input-associates  the   named
      variable  with  a list of files under a given format.  The range
      of formats is given below.  any previous association is removed.
      If the second argument is null, the INPUT stream is assumed.



      3.1.2  OUTPUT(name,file,format) - Output-associates  a  variable
      with  a  single  file  under  the  given  format.   Any previous
      association is removed.  If the second  argument  is  null,  the
      OUTPUT file is assumed.



      3.1.3  DETACH(name) - Detaches any association  from  the  named
      variable



   3.2  Other I/O Functions

      3.2.1  DELETE(file) - Deletes the indicated file.  If  the  file
      did not previously exist, DELETE will fail.



      3.2.2  RENAME(file,file) - Renames the 2nd file to the  name  of
      the first.  RENAME will fail if either the second file cannot be
      found or the first file can be found.   If  the  first  file  is
      null,  the  2nd  will not be deleted.  To delete a file you must
      use DELETE.



      3.2.3  FILE(stream) - Fails if not all files exist (returns  the
      null  string).  FILE also fails if erroneous file spec syntax is
      discovered.



      3.2.4  REWIND(stream) - Closes the indicated  files  and  resets
      the sequence.  A file may be a member of more than one sequence.
      All sequences composed of the same files in the same  order  are
      regarded as identical and are simultaneously reset by REWIND.  A
      null argument implies the INPUT  stream  (including  the  source
      program).
SITBOL - A SNOBOL4 for the DECsystem-10                         Page 7
I/O PROGRAMMING


      3.2.5  ENDFILE(file) - Closes the  file.   Any  subsequent  read
      from  the  file  will  cause  reading  from  the beginning.  Any
      subsequent write will begin writing a new file.  A null argument
      implies the OUTPUT file.



      3.2.6  TTY() Or TTY('C') - a predicate which will test to see if
      a  line of input is available (TTY()) or if a character of input
      is available (TTY('C')) on the teletype.



   3.3  Formats

        A format, if given, is usually a single character (like  'T').
   By means of a format the user can specifiy word mode or ASCII mode.



      3.3.1  ASCII Mode Formats - NULL - normal string I/O.  On  input
      a  break  is  made on the sequence <CR> <LF> and the terminating
      characters are not returned.  On output a <CR> <LF> is appended.
      More  generally,  on  input,  a  break is detected at a terminal
      control character sequence (TCC sequence) which  is  defined  as
      ARBNO(<CR>) SPAN(<LF> <FF> <VT> <ALTM>).  Thus <CR> <LF> <FF> is
      considered as a single TCC sequence.



         3.3.1.1  'T' - (Terminal format) leaves the TCC  sequence  on
         on input and assumes its presence on output.  (I.E.  Does not
         add <CR> <LF>)



         3.3.1.2  'N' - (Sequenced numbered format)  does  not  remove
         sequence numbering on input.  Adds the sequence number bit on
         output.



         3.3.1.3  'C' - (Character format) reads one  character  at  a
         time on



         3.3.1.4  'A' - (Append mode) skips to the end  of  an  output
         file before doing any output.  On input this is treated as an
         error.


         'N' and 'T' may be used in combination to make an exact  copy
         of a nonsequenced file use 'T' for both input and output.  To
SITBOL - A SNOBOL4 for the DECsystem-10                         Page 8
I/O PROGRAMMING


         copy a sequenced numbered file, use 'NT' for both  input  and
         output.



      3.3.2  Word Mode Formats - 



         3.3.2.1  D - (direct format) writes an INTEGER or REAL  as  a
         word on output.  Reads an INTEGER on input.



         3.3.2.2  O - (octal format) reads a 12-character  string  (of
         octal looking digits) on input.  Writes a 12 character string
         on output.



         3.3.2.3  B - (binary format) reads a 36-character string  (of
         1's  and  0's)  on  input;   writes  a 36-character string on
         output.



         3.3.2.4  S - (SIXBIT format) reads a  6-character  string  on
         input  (converts  from 6-BIT to ASCII);  writes a 6-character
         string on output.



         3.3.2.5  U - (unspec format) reads a  5-character  string  on
         input   (essentially   without   conversion)   and  writes  a
         5-character string on output.  Notes -

              If the item to be written is shorter  than  required  it
         will  be  padded  on the left with 0's in 'O' and 'B' formats
         and on the right with 0's in 'A' and 'S' formats.



      3.3.3  Format Compatibility Provisions - For compatibility  with
      other  SNOBOLs, on input the format may be INTEGER and on output
      the format may be ' ', '+', '1' or '0'.  The characters will  be
      prefixed to the output string.
SITBOL - A SNOBOL4 for the DECsystem-10                         Page 9
ADDITIONAL FACILITIES


4.0  ADDITIONAL FACILITIES

     Additional facilities are provided for the SITBOL user either for
compatibility  with  other  systems  and/or because of their intrinsic
worth.



   4.1  DECBOL Compatible Extensions

      4.1.1  ASCII(n) - Where n is an octal-looking string or  integer
      will  return  the  corresponding  character.   Thus ASCII(15) is
      carriage return.



      4.1.2  Reenter Command - Reenter  of   an   interrupted   SNOBOL
      program will issue a printout at the start of the next statement
      to be executed and execution will continue on as if no interrupt
      had  occurred.   Thus the programmer may monitor the behavior of
      long programs without altering their  performance.   The  method
      used  is  to  increment  &TRACE  by  1  and  set a special TRACE
      indicator for &STCOUNT.  If &STCOUNT is already being traced  no
      special TRACE indicator is set.  Hence the user may gain control
      at reenter TIME by means of programmer-defined TRACE functions.

           If the program is looping during pattern matching as in:

              S ?  ARBNO() FAIL

      The reenter will not produce a  printout.   A  printout  can  be
      produced  by  tracing a variable associated with a subpattern of
      the pattern that is looping.  For example:

              TRACE(.A)
              &TRACE = 0
              ..
              S ?  ARBNO() NULL $ A FAIL



   4.2  SPITBOL Compatible Extensions

      4.2.1  LPAD(s,n,c) And RPAD(s,n,c) - Will return the  result  of
      padding  the  string  s on the left (or respectively right) with
      character c until it is n  long.   If  c  is  absent,  blank  is
      assumed.  S is returned unchanged if it is already long enough.
SITBOL - A SNOBOL4 for the DECsystem-10                        Page 10
ADDITIONAL FACILITIES


      4.2.2  REVERSE(s) - Returns a reversed copy of string s.



      4.2.3  BREAKX(s) - Is like BREAK(s) except  that  it  will  take
      implicit alternatives matching all strings broken on a character
      of  s.   (BREAKX(s)  is  equivalent  to  BREAK(s)   ARBNO(LEN(1)
      BREAK(s)))



      4.2.4  SUBSTR(S,I,L) - Returns the substring (ala PL/I)  of  the
      string s of length l beginning at character i.  If l is missing,
      the remainder of the string is assumed.



      4.2.5  Context-free Subscripting - The      pointed      bracket
      construction  may  be  used  after  all  ARRAY  or  TABLE valued
      expressions.  Thus A<I><J> refers to the Jth  item  of  the  Ith
      ARRAY (or TABLE) of A.



      4.2.6  SETEXIT(NAME) - Will establish name as the label to go to
      on  the  next  error (provided &ERRLIMIT is > 0).  return can be
      made via CONTINUE.  Termination can  be  made  via  ABORT.   All
      errors can be trapped except class 6 (memory overflow).



      4.2.7  Aggregate Dumping - If DUMP is given and  argument  of  2
      (or  more)  as  in DUMP(2) , all aggregates (ARRAYS, tables, and
      defined types) are dumped.  Each aggregate is assigned an ID  at
      creation  and  this  number is used to key all trace information
      with dumps.  Aggregates are also dumped with &DUMP  =  2.   Also
      DUMP(A),   where  A  is  any  aggregate,  will  just  dump  that
      aggregate.



      4.2.8  Scientific Notation For REALs - A  REAL  number  can   be
      specified  as <number>E<integer> but without intervening blanks.
      Thus 5.6E-5 is an allowable constant.



      4.2.9  CLEAR(LIST,FLAG) - The first argument allows  a  list  of
      natural variable names (separated by commas) to denote variables
      whose values should not be cleared.  Flag, if 1, indicates  that
      pattern-valued variables should not be cleared.
SITBOL - A SNOBOL4 for the DECsystem-10                        Page 11
ADDITIONAL FACILITIES


      4.2.10  LEQ,LGE,LGT,LLE,LLT,LNE - SITBOL, like  SPITBOL,  allows
      for a complete set of six lexical comparison predicates.



   4.3  Exclusive SITBOL Features

      4.3.1  Environmental Additions - 



         4.3.1.1  &JOBNO - Is the current job number



         4.3.1.2  &COMMAND - Is the original  command  string  (minus
         switches).



         4.3.1.3  EXIT(n) - There are 3 possibilities, n = 0, -1 or 1.
         EXIT(0)  will  exit.  A subsequent SAVE will save the program
         at its current state.  A subsequent  RUN  will  continue  the
         program  by returning from EXIT().  To use EXIT() one must be
         running from a .HGH segment as opposed  to  a  .EXE  program.
         This is most easily accomplished by doing a:

                  .COPY SNOBOL.HGH=SYS:SNOBOL.EXE

         wed by a .RUN SNOBOL all in lieu of a .R SNOBOL.

              EXIT(-1) will delete the high segment before exiting.  A
         subsequent SAVE will save only the low segment.  When the low
         segment is run, it will look for the file SYS:SNOBOL.EXE.  If
         the  version numbers of the two segments are incompatible the
         nonrecoverable ERROR ?SNOVER  is  given.   EXIT(1)  will  not
         close  I/O  activity but returns to the user at command level
         (EXIT 1, UUO).  Only a dot appears at the terminal.  The user
         may  continue  at  this  point effectively returning from the
         EXIT(1) call.

         EXIT(-1,,ARG) will now set the name of  the  program  to  arg
         before exiting.  The argument is a string.



         4.3.1.4  TIME(1) - Will   return   the   time   of   day   in
         milliseconds.   (TIME() retains its function of returning the
         CPU time).
SITBOL - A SNOBOL4 for the DECsystem-10                        Page 12
ADDITIONAL FACILITIES


         4.3.1.5  &HISTOGRAM - &HISTOGRAM provides a method whereby a
         user may prepare a time-histogram of his program (or any part
         of it) in his own  format  (rather  than  use  the  automatic
         facility  provided  by  the /H switch).  The initial value of
         &HISTOGRAM is null.  After assigning a 1, such as:

                 &HISTOGRAM = 1

         The  value  of  &HISTOGRAM  will  be  an  array  of  integers
         (initially  0).   The ARRAY is dimensioned 0:n where n is the
         number of the last statement compiled.  (It is usually better
         to  avoid  using  sequence-numbered  source files in making a
         &HISTOGRAM.) At each clock interval (1/60 of a  second)  A<0>
         and  A<I>  will  be incremented where A is the array and I is
         the statement currently being executed.  to get the array and
         stop the incrementing, the following can be used:

                  A = &HISTOGRAM
                 &HISTOGRAM = 0

         in the above, the second  statement  causes  a  halt  to  the
         histogram activity and resets &HISTOGRAM to null.  &HISTOGRAM
         can Be restarted as before.

              If it is  necessary  to  make  many  histograms,  it  is
         suggested  that  the  array  (such  as a above) be zeroed out
         explicitly by  the  programmer  (with  a  loop)  because  the
         &HISTOGRAM  is  created  in  growing  storage  and  is  never
         garbage-collected.



         4.3.1.6  COLLECT(N,M) - A call to COLLECT  forces  a  garbage
         collection.  If nonzero, n becomes the new breathing room and
         m the new shrink coefficient.  If, after collecting, there is
         not  breathing room, core expands.  If there is more than the
         shrink coefficient, core contracts.  N and  M  are  1000  and
         3000 by default respectively.



         4.3.1.7  RUN(fILE,INCREMENT) - Will run the  indicated  file.
         The  entry  point  used  is  the  normal entry point plus the
         indicated increment.  See RUN uuo.



         4.3.1.8  &PPN - &PPN is the user's project-programmer number
         as an 11-character octal-looking string.
SITBOL - A SNOBOL4 for the DECsystem-10                        Page 13
ADDITIONAL FACILITIES


         4.3.1.9  &VERSION - &VERSION will set the version number  of
         the  low-segment  so  the  on an EXIT a version number can be
         associated with a saved file.  When &VERSION 's value is read
         it  contains  the  version number of SITBOL in a 12-character
         octal string.



         4.3.1.10  &ERRLEVEL, &ERRMSG, &ERRNAME - Three keywords have
         been  added  to  be compatable with the new error processing.
         &ERRLEVEL sets the level  of  message  print  out  during  an
         error.   A value of one will only printout the prefix form of
         the error message (i.e.  ?SNOTUL in statement 3 at level 0.).
         A  value of two will printout the entire error message.  Zero
         (which is the default) will print out the  message  occurding
         to the Message Level set at LOGIN.

         The keywords &ERRMSG and &ERRNAME contain the  error  message
         and  the  6-character  abbreviation respectively, in addition
         the older keyword &ERRTYPE will still return the value in the
         form  xx.yyy,  where  xx is the major error number and yyy is
         the minor error number.



      4.3.2  Language Extensions - 



         4.3.2.1  Assignment Operator (=) - "="  is  an  operator  (of
         lowest  precedence, associating to the right) and returns the
         value assigned if a value is needed  or  the  variable  if  a
         variable is needed.  Thus:

                 A = B = 'ABC'

         Assigns 'ABC' to both A and B.  Also:

                  SUBJ PATT .  (V = )

         Will assign to V the null string, then do  a  pattern  match,
         and  then  assign to V a 2nd time conditionally on success of
         the pattern.



         4.3.2.2  Pattern Matching Operator (?) - In addition to being
         able  to  invoke pattern-matching in the traditional way, the
         SITBOLite may initiate pattern-matching at any point within a
         statement by means of the ?  operator (precedence just higher
         than = and associating to the right).  The value returned  is
         the  string  matched.  If used as a variable it will invoke a
         routine to effect the standard substring replacement.  Thus:
SITBOL - A SNOBOL4 for the DECsystem-10                        Page 14
ADDITIONAL FACILITIES


                  S ANY(&ALPHABET ?  C REM)

         Will scan S for a character  greater  than  or  equal  to  C.
         Also:

                  S = \(S ?  X) S ',' X

         Will append string X to S provided X is  not  already  in  S.
         Also:

                  S1 ?  P1 .  (S2 ?  P2 .  T2) = T2

         Will scan S1 for P1 and S2 for  P2  and  switch  the  matched
         substrings.   Replacement  following a pattern match can take
         place even if the subject is not a variable.  Thus:

                  X = (&ALPHABET ?  '0123456789' = )

         Assigns to X all characters except numerics.



         4.3.2.3  Inexhaustible Binary Operators - Any   sequence   of
         operators can be used as a unique binary operator.  Thus:

                  OPSYN('=/=', 'DIFFER', 2)
                 A =/= B :S(DIFFERENT)

         Is valid.  Thus the user has an infinite number of  operators
         at  his  disposal.  Precedence is the default precedence (See
         5.2).



         4.3.2.4  FUNCTION(name) - Will succeed and  return  the  null
         string  if name is the name of a function (either built-in or
         defined) and will fail otherwise.



         4.3.2.5  LABEL(name) - Will  succeed  and  return  the   null
         string  if  name  is  the name of a label (either built-in or
         defined) and fails otherwise.



         4.3.2.6  Numeric Goto's - Numeric   values   within   <>-type
         goto's  are  taken  to  be relative to the current statement.
         Null is treated as zero.  Thus:

                  S ' ' = :S<>

         Removes all blanks from S.  Also:
SITBOL - A SNOBOL4 for the DECsystem-10                        Page 15
ADDITIONAL FACILITIES


                  L = INPUT :F(END) ;  L ?  P :F<-1>

         Will continue to read until a pattern P is  found  (and  fall
         through) or until and End-of-File is encountered.



         4.3.2.7  Internal Conversions - The  I/O  conversion  formats
         'B',  'O',  'S'  and 'U' have been made available for non-I/O
         uses by extending the convert function.  A third argument  to
         CONVERT  may  be  a format.  If the 2nd argument is 'STRING',
         the conversion is similar  to  word-mode  input.   The  first
         argument  must be INTEGER or REAL (or convertible to NUMERIC)
         and this specifies a 36-BIT word to be converted.  Thus:

                   CONVERT(12,'STRING','O')

         Returns '000000000014'.  If the 2nd argument is 'INTEGER'  or
         'REAL',   the   first   argument  must  be  type  STRING  (or
         convertible to it).  It is converted as it would be on output
         in  word-mode  I/O.  The resulting word is branded INTEGER or
         REAL depending on the 2nd argument.  Thus:

                   CONVERT('14', .INTEGER, 'O')

         Will return 12.  (.INTEGER in the above is equivalent to  but
         faster than 'INTEGER'.)



         4.3.2.8  SORT & RSORT - The SORT and RSORT  (reversed  SORT)
         functions  provide a comprehensive sorting facility which can
         sort in  ascending  (SORT)  or  descending  (RSORT)  order  a
         hetrogenous mix of different objects embedded in a variety of
         data structures.  Objects are sorted  primarily  on  DATATYPE
         and secondarily on VALUE.  The ordering of objects within the
         types INTEGER, REAL and STRING is the natural one (i.e.   The
         one defined by the predicates GT, GE, LGT, LEQ, etc.).  Names
         of  natural  variables  SORT  lower  than  names  of  created
         variables.   Otherwise  ordering  of  objects within the NAME
         datatype class as well as within each other class is based on
         order  of creation.  The aggregate to be sorted may either be
         a TABLE or a singly or doubly dimensioned ARRAY as follows:

             Tables   -   SORT(TABLE   [,INTEGER])   OR    RSORT(TABLE
         [,INTEGER])

         Will return an ARRAY of dimension n,2  (same  as  convert  to
         ARRAY)  where  n  is  the  number  of nonnull elements in the
         TABLE.  The optional  second  argument  may  be  1  (sort  by
         reference) or 2 (sort by value).  If the argument is missing,
         1 is assumed.

         Singly   dimensioned   arrays   -    SORT(A    [,NAME])    OR
SITBOL - A SNOBOL4 for the DECsystem-10                        Page 16
ADDITIONAL FACILITIES


         RSORT(A[,NAME])

         Will sort singly dimensioned arrays  with  any  lower  bound.
         The  second argument, if present, is the name of a field of a
         programmer-defined datatype.  The value  returned  is  a  new
         array  with  the same dimensions as the old.  If a field name
         is given, the comparand is the value of the  indicated  field
         whereas  the  item  sorted  is  the entire data object.  If a
         field name is given, the elements of the array need  not  all
         be  of  the  same  type nor all programmer-defined.  The sort
         does  not  invert  the  order  of  equal  elements  so   that
         successive  sorts  on  different  fields  produces  a  proper
         lexical ordering.

         Doubly  dimensioned  arrays  -  SORT(A  [,INT])  and  RSORT(A
         [,INT])

         Where the array A is  two-dimensional  returns  a  new  array
         (same dimensions) sorted according to the column indicated by
         the second argument.  Other columns are permuted accordingly.
         Equal  elements  are not inverted so that successive sorts on
         different columns will produce a proper lexical ordering.



         4.3.2.9  RANDOM(n) - RANDOM(0)  will  return  a  REAL  number
         uniformly  distributed on the interval (0,1).  RANDOM(n), for
         n>0, will return an INTEGER uniformly distributed on the  set
         of integers 1, 2, ,3 ,. ,N.  N may not be negative.

              The random number generator's memory (warm-up  constant)
         consists  of  a  single  non-negative  integer  (initially 0)
         contained in the (unprotected) keyword  &RANDOM.   Hence  any
         generated sequence may be repeated by setting &RANDOM to 0 or
         to any saved value.  If set from the time-of-day clock as  in
         &RANDOM  =  TIME(1)  ,  truly  unpredictable sequences can be
         obtained (for game playing, for example).



         4.3.2.10  The Built-in Label REPEAT - 

              Passing control to REPEAT will repeat the  execution  of
         the  statement that was interrupted for error processing (see
         SETEXIT, 4.2.6).  This  is  to  permit  the  continuation  of
         interrupted  programs  after  the source of an error has been
         corrected.  Examples include compiling segments of a  program
         on a demand basis.  See &ERRPARM, 4.3.2.11.
SITBOL - A SNOBOL4 for the DECsystem-10                        Page 17
ADDITIONAL FACILITIES


         4.3.2.11  &ERRPARM - This read-only keyword is set  by  some
         errors to a value which will further identify the error.  The
         following errors alter the value of &ERRPARM.

         ERROR SNOUFO - Undefined function or operator -  &ERRPARM  is
         set to the name of the function or operator.

         ERROR SNOTUL - Transfer to undefined label - &ERRPARM is  set
         to the name of the label

         ERROR SNOLFN - Label of defined function  is  non-existent  -
         &ERRPARM is set to the name of the label

         All  illegal  datatype  errors  will  set  &ERRPARM  to   the
         offending value.



         4.3.2.12  &SIZE - This read-only keyword returns the size of
         the low segment in words.



         4.3.2.13  &COMPNO - This  settable  keyword  designates  the
         statement  number  of  the next statement to be compiled (via
         the CODE function).  Statements  are  numbered  consecutively
         thereafter.



         4.3.2.14  MTAPE(function,file-spec,format) - The user has the
         ability  to  position  a magtape through the use of the MTAPE
         function.  The first argument should be  an  integer  in  the
         range of 0 thru 6 having the following functions:
                       0 = Rewind the tape
                       1 = Write one End-of-File mark
                       2 = Skip one record
                       3 = Backspace one record
                       4 = Space to logical End-of-Tape
                       5 = Skip one file
                       6 = Backspace one file

         An argument outside this range will cause an error  (?snomta)
         to  occur.  The drive will wait for the operation to complete
         before continuing.  If the device specified in the  file-spec
         is  not  a magtape drive, then MTAPE will give a fail-return.
         Otherwise,  it  will  return  the  null  string.   The  third
         argument  should  be a format in which the MTA will be OPENed
         if it is not already so.  If the third argument is null  then
         ASCII  is assumed, i.e.  all missing args are supplied as the
         null string.  The formats are described in section 3.3
SITBOL - A SNOBOL4 for the DECsystem-10                        Page 18
ADDITIONAL FACILITIES


         4.3.2.15  RESCAN() - This  returns  the  last  command   line
         issued at monitor level, i.e. in:

                         .R XXX;MSG

         The entire command line may be recovered.  RESCAN may only be
         issued  once, repeated calls will get a fail return (remember
         that COMPIL does a RESCAN).  The datatype returned  will,  of
         course, be a string.



         4.3.2.16  External Functions - 

              External functions have been implemented  to  allow  the
         SNOBOL   user  access  to  routines  in  MACRO-10.   Two  new
         functions to load and unload the external functions have been
         implemented.  These functions are called LOAD and UNLOAD.



              4.3.2.16.1  LOAD - Is used to load an external function.
              It  expects  two  arguments:  the prototype and the file
              spec.

                   The prototype is a string of the form:

                   Fname(DTarg1,DTarg2,. . . ,DTargn)retDT

              This  specifies  the   function   name,   the   datatype
              associated  with  each  argument  passed to the external
              function, and the datatype that  the  function  returns.
              Like  programmer  defined  functions, external functions
              may have any reasonable number of arguments.  The number
              of  arguments  is  defined  as the number of commas plus
              one.  Thus  it  is  impossible  to  define  an  external
              function  having  no  arguments, but this should have no
              serious consequence.  The first six  characters  of  the
              function name are considered to be the name of the entry
              point declared with the external procedure.  Both  upper
              and  lower  case  characters  may  be  used in naming an
              external function, but no distinction between upper  and
              lower case is made for defining the entry point.

                   If no file name is supplied the LOAD function  will
              assume DSK:SNOLIB.REL.
SITBOL - A SNOBOL4 for the DECsystem-10                        Page 19
ADDITIONAL FACILITIES


              4.3.2.16.2  Calling And Argment Conventions - The SITBOL
              external  functions  are  called with and pass arguments
              with the standard F10 conventions.  The .REL  file  must
              not  contain  any  absolute addresses or link item types
              which could not be loaded (i.e.,  high  segments).   The
              entry  point  need  only  be  internal.  An example of a
              external function to do a GETTAB UUO is as follows:
           
           
           GETAB::      MOVS    0,@0(16)        ;AC 16 is the arg pointer
                HRR     0,@1(16)        ;AC 0 is the returned AC
                GETTAB  0,              ;Do the UUO
                AOS     (17)            ;Signal a fail for SITBOL
                POPJ    17,             ;Return to SITBOL
                END
           
           
              note the error return;  the incrementing of  the  return
              ac signals to SITBOL that the function has failed.  This
              external function would be called by:

                   result = GETAB(1,24)         :F(goofed)S(ok)




              4.3.2.16.3  UNLOAD - This function unloads  an  external
              function  from  core.  It has one argument.  The name of
              the external function to be unloaded.



         4.3.2.17  Programmer-Defined Variable Associations - 

              This new feature allows the programmer to associate  the
         execution  of  a  programmer defined function with the act of
         assigning a variable a value or retrieving  the  value  of  a
         variable.   The  facility  is  especially  useful for program
         monitoring and debugging.

              This  facility  is  implemented  by  calling   the   new
         functions ASSOCIATE and DISASSOCIATE.



              4.3.2.17.1  ASSOCIATE(NAME,PROCESSDESCRIPTION) - There
              are two kinds of associations.  Associations such as the
              built-in input association  are  referred  to  as  fetch
              assocations, since they are triggered whenever the value
              of a variable  is  fetched.   The  type  of  association
              exhibited   in   value   tracing   is   called  a  store
              association.  A programmer defined  association  may  be
              either  a  fetch or a store association.  A variable may
              have any number  of  associations  of  either  type.   A
SITBOL - A SNOBOL4 for the DECsystem-10                        Page 20
ADDITIONAL FACILITIES


              association  is  made by the execution of a statement of
              the form

                   ASSOCIATE(NAME,PROCESSDESCIPTION)

              The NAME is the name of the variable to  be  associated.
              The  PROCESSDESCRIPTION  is  an instance of a programmer
              defined data object with four fields.  The  contents  of
              the  fields describe the process that is associated with
              the variable given by NAME.  The programmer defined data
              object that is usually used is defined by the statement

                   DATA('PROCESS(TYPE,FUNCT,ACTIVE,LEVEL')

              The TYPE field must be  either  the  string  'FETCH'  or
              'STORE',  indicating the type of association.  The FUNCT
              field contains the name of the built  in  or  programmer
              defined function that is to be called whenever the value
              of the associated variable is stored or fetched.  If the
              ACTIVE   field  contains  a  nonzero  integer  when  the
              variable is referenced for either a fetch or  store  the
              association  is  considerd active and the function named
              in the FUNCT field is called.  If the value is zero  the
              association  is  ignored.   In  the case where there are
              multiple associations for a single variable the  integer
              contained  in  the  LEVEL  field is used to indicate the
              position of the association with respect to the existing
              associations with the variable.

                   A programmer defined association function is called
              with  three  arguments.   For  the fetch asociation, the
              arguments are (i) the name of the  associated  variable,
              (ii)  the  current  value of that variable and (iii) the
              process description.



              4.3.2.17.2  DISASSOCIATE(NAME,PROCESSDESCRIPTION) - This
              undoes  the  effect  of ASSOCIATE.  All the associations
              with  the  variable  given  in  NAME  and  described  by
              PROCESSDESCRIPTION  are removed.  Other associations are
              not affected.



         4.3.2.18  SNODDT - 

              The module SNODEB has been added to  SNOBOL  to  support
         SNODDT.   The SNOBOL program SNODDT.SNO must be used with the
         new features for debugging.   The  commands  for  SNODDT  are
         similar  to  those  of  DDT.  A complete list of commands for
         SNODDT can be found in the appendix.
SITBOL - A SNOBOL4 for the DECsystem-10                        Page 21
ADDITIONAL FACILITIES


              To load SNODDT with your program use the command  string
         of:

              *SNO:SNODDT,your-program              _



5.0  SYSTEM PECULIARITIES

This section describes slight differences between SNOBOL4  and  SITBOL
which may but probably won't cause difficulties.



   5.1  Control Cards

   SITBOL does not recognize any control cards.  It treats  them  like
   comments.



   5.2  Operator Precedence

   For compatibility with SNOBOL4 and to obtain a rational  precedence
   for  ?   the  precedence  of  several  undefined  operators are not
   consistent with SNOBOL4.  a complete list of operators from  higher
   to lower precedence is given below:

            $ .
           ** (right)
           *
           /
           + -
           blank
           %
           &   \ @ (default precedence)
           !  ^
           ?  (right)
           = _ (right)

   In the table above all operators accept those  indicated  associate
   to the left.



   5.3  ARBNO Heuristic

   ARBNO(P), where P  matches  the  null  string  (ever),  will  cause
   failure  in  SNOBOL4  whereas SITBOL shows no mercy and just loops.
   This increases the speed of most programs.
SITBOL - A SNOBOL4 for the DECsystem-10                        Page 22
SYSTEM PECULIARITIES


   5.4  The One-Character Assumption

   The  difficulties  caused  by  the  one-character  assumption  have
   virtually been eliminated in SITBOL.  For example:
            SUBJECT PAT $ V *LGT(V,'SAM') Would not work  as  expected
   if   *LGT()   came   at   the   end  of  the  subject  because  the
   pattern-matching heuristic feels that *LGT() should match at  least
   one  character.  In SITBOL the one-character assumption is retained
   for breaking recursive loops but not for any other context (such as
   the one above).



   5.5  Keywords

   TRACE() will set &TRACE to 1000.   &STLIMIT  is  set  initially  to
   infinity (2 ** 35).



   5.6  Compiler Input

   Unlike  DECBOL,  SITBOL   does   not   treat   columns   73-80   as
   identification.  All of the line is regarded as statement.



   5.7  Redefinition Of Unary *

   All operators and functions may be redefined or OPSYN'ed to  except
   unary * (SITBOL uses polish suffix for speed).



   5.8  Backspace Function

   This function is not implemented in SITBOL.



   5.9  REAL Exponents

   An expression of the form:  ARGUMENT ** REAL is not permitted.



   5.10  Names Of Keywords

   The unary name operator (.) may not be applied  to  keywords.   Eg.
   .&STLIMIT will signal an error.
SITBOL - A SNOBOL4 for the DECsystem-10                        Page 23
SYSTEM PECULIARITIES


   5.11  CONVERT(object,'STRING')

   Only INTEGERs, REALs, NAMEs and STRINGs can be converted to STRING.
   Other objects fail as in SPITBOL.












                              APPENDIX A

                           SNODDT COMMANDS



     The following is a summary of the SNODDT commands.

1.  Set a breakpoint - label;offset;cnt;exp;tag$B

2.  Remove a breakpoint - label;offset$0B

3.  Monitor calls to a function - name;cnt;exp;tag$C

4.  Case monitoring calls to a function - name$0C

5.  Dump a value - f1;f2;f3; . . .;fn$D

6.  Execute a SNOBOL4 expression (no typeout) - exp$E.

7.  Monitor fetches to a variable name - name;cnt;exp;tag$F

8.  Case monitoring fetches to a variable - name$0F

9.  Go to RETURN - $G

10.  Go to indicated statement - label;offset$G.

11.  Type help file for SNODDT - $H.

12.  Reenter with original or supplied command string - string$I.

13.  Compile SNOBOL4 code - string$K.

14.  List the file from cnt1 to cnt2 - cnt1;cnt2;filename$L.

15.  Proceed from an interrupt (zero count) - $P.

16.  Proceed from an interrupt and set repeat count to cnt - cnt$P.

17.  Monitor the return from a function - name;cnt;exp;tag$R.

18.  Cease the monitoring of returns from a functions - name$0R.
SNODDT COMMANDS                                                Page A-2



19.  Monitor stores to the variable specified - name;cnt;exp;tag$s

20.  Cease monitoring stores to a variable - name$0S.

21.  Restrict variable name to be type - name;type;tag$T.

22.  Remove type restriction for variable name - name$0T

23.  Execute a SNOBOL4 expression and type the result - exp$X

24.  Read commands from the file specified - file-spec$Y.

25.  Exit from SNODDT - $Z.










                       [End of SITBOL.RND]
 FQ/KØ