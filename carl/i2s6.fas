	&STLIMIT  = 99999999
	&ANCHOR = 1
	OUTPUT("TTY",0,-1)
	INPUT("INTTY",0,80)
*
*		PATTERNS NECESSARY FOR FUNCTIONS
*
	NULL	=

	DEFINE('OPT(PAT)')
	DEFINE('CHR(NUM)')
+							:(SETUP)

OPT	OPT	=	PAT ! NULL			:(RETURN)
*
*
CHR	&ALPHABET LEN(NUM) LEN(1) . CHR			:(RETURN)
*
*

SETUP
	UPPER	=	'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
	LOWER	=	'abcdefghijklmnopqrstuvwxyz'
	ALPHA	=	UPPER LOWER
	OCTAL	=	'01234567'
	DIGITS	=	'0123456789'
	DIGIT	=	ANY(DIGITS)
	CHAR	=	ANY(DIGITS ALPHA)
	SIGN	=	"+" ! "-"
	QUOTE	=	ANY("'|" '"')
	TAB	=	CHR(9)
	CRLF	=	CHR(13) CHR(10)
	SEP	=	NSPAN(",; " TAB)
	MONTAB	=	"JanFebMarAprMayJunJulAugSepOctNovDec"
	DATE()	BREAK(DIGITS) SPAN(DIGITS) . MONTH '/' SPAN(DIGITS) . DAY
+			'/' REM . YEAR
	MONTAB	LEN((MONTH - 1) * 3) LEN(3) . MON
	TODAY	= DAY '-' MON '-' YEAR
	MONTHS	=	( ANY("Jj") ANY("Aa") ANY("Nn") )
+		!	( ANY("Ff") ANY("Ee") ANY("Bb") )
+		!	( ANY("Mm") ANY("Aa") ANY("RrYy") )
+		!	( ANY("Aa") ANY("Pp") ANY("Rr") )
+		!	( ANY("Jj") ANY("Uu") ANY("NnLl") )
+		!	( ANY("Aa") ANY("Uu") ANY("Gg") )
+		!	( ANY("Ss") ANY("Ee") ANY("Pp") )
+		!	( ANY("Oo") ANY("Cc") ANY("Tt") )
+		!	( ANY("Nn") ANY("Oo") ANY("Vv") )
+		!	( ANY("Dd") ANY("Ee") ANY("Cc") )

	DATES	= SPAN(DIGITS) ANY("-/") (MONTHS ! SPAN(DIGITS))
+				 ANY("-/") SPAN(DIGITS)

* 
*		PATTERNS FOR PARSING INPUT FILES
*
	SOSNUM	=	POS(0) DIGIT DIGIT DIGIT DIGIT DIGIT TAB            
 

START	INCHAN  = OPEN("DSK(0,2)")
	OUTCHAN = OPEN("DSK(2,2)")
	KATCHAN = OPEN("DSK(2,2)")

NEXT	TTY = 'Node,slot,initials: '
	MYLINE = INTTY					:F(END)
	MYLINE	POS(0) RPOS(0)				:S(END)
	MYLINE	SPAN(OCTAL) . NODE
+		BREAK(DIGITS) SPAN(DIGITS) . SLOT
+		BREAK(', ' TAB) SPAN(', ' TAB) REM . INITIALS
+							:S(OK)

	TTY = 'Please enter node#, slot#, and your initials.' CRLF
+							:(NEXT)


OK	NODE = LPAD(NODE,5,'0')
	SLOT = LPAD(SLOT,2,'0')
	NODE LEN(1) . FIRST REM . NODE
	FIRST '0'					:F(ADDN)
	FIRST = 'D'
ADDN	NODE = 'N' FIRST NODE


	TYM = NODE '.TYM'
	INPUT("IN",LOOKUP(TYM,INCHAN),160)		:F(NOTYM)
	OUTPUT("OUT",ENTER(TYM,OUTCHAN),160)		:F(NOTYM)
	TTY = TYM CRLF

	I2IS.PAT = (ARB "KERNEL CODE" BREAK(DIGITS)) . BEG
+		SPAN(DIGITS '.') REM . GEB
	NODE.PAT = (ARB "NODE CODE" BREAK(DIGITS)) . BEG
+		SPAN(DIGITS '.') REM . GEB
	LOAD.PAT = (ARB "LOAD DATE" BREAK(DIGITS)) . BEG DATES REM . GEB
	NSLOT.EQ.PAT =  ANY('Nn') ANY('Ss') ANY('Ll') ANY('Oo') ANY('Tt')
+			SPAN(' ' TAB) ANY('Ee') ANY('Qq')
+			SPAN(' ' TAB) SPAN(DIGITS) . NSLOT
	CONSAT.EQ.PAT = ANY('Cc') ANY('Oo') ANY('Nn') ANY('Ss')
+			ANY('Aa') ANY('Tt') SPAN(' ' TAB)
+			ANY('Ee') ANY('Qq') SPAN(' ' TAB) '1'

TYML	LINE = IN					:F(TYMF)
	LINE SOSNUM =
* 
*		TYM file pattern matches go here
*
	LINE I2IS.PAT					:S(IPAT)
	LINE NODE.PAT					:S(NPAT)
TYMP	LINE LOAD.PAT					:S(LPAT)
	LINE ARB . BEG DATES REM . GEB			:S(DPAT)
	LINE ARB NSLOT.EQ.PAT				:S(TYMO)
	LINE ARB CONSAT.EQ.PAT				:S(CPAT)
TYMO	OUT = LINE					:(TYML)

IPAT	LINE = BEG '11.33' GEB
	LINE NODE.PAT					:F(TYMP)
NPAT	LINE = BEG ' 5.33' GEB
	OUT = LINE
	TTY = LINE CRLF					:(TYML)
LPAT	TTY = BEG TODAY GEB CRLF
	OUT = BEG TODAY GEB				:(TYML)
DPAT	TTY = BEG TODAY GEB '/' INITIALS CRLF
	OUT = BEG TODAY GEB '/' INITIALS		:(TYML)
CPAT	OUT = LINE
	OUT = 'SPAM	EQ	1		:* ENABLE PERFORMANCE MONITOR'
	GT(NSLOT,1)					:S(CPAT0)
	OUT = 'TII.FG	EQ	0		:  SET TO  0  IF ONLY CONSAT SLOT'
+							:(CPAT1)
CPAT0	OUT = 'TII.FG	EQ	1		:  SET TO  0  IF ONLY CONSAT SLOT'
CPAT1	OUT = '					:  SET TO  1  IF ANY OTHER SLOTS'
	OUT = 'FGFREQ	EQ	$A 10		:  FASTER FG FREQUENCY FOR DEDICATED CONSATS'
+							:(TYML)

NOTYM	TTY = "?Cannot find " TYM CRLF
TYMF	CLOSE(INCHAN)
	CLOSE(OUTCHAN)

	T01 = NODE '.T' SLOT

	INPUT("IN",LOOKUP(T01,INCHAN),160)		:F(NOT01)
	OUTPUT("OUT",ENTER(T01,OUTCHAN),160)		:F(NOT01)
	TTY = T01 CRLF

	MPVC.PAT = (ARB '(' ANY('Mm') ANY('Pp') ANY('Vv') ANY('Cc') ',') . BEG
+		   SPAN(DIGITS) BREAK(')') REM . GEB

T01L	LINE = IN					:F(T01F)
	LINE SOSNUM =
* 
*		T01 file pattern matches go here
*
	LINE MPVC.PAT					:S(MPAT)
	OUT = LINE					:(T01L)

MPAT	OUT = BEG '11' GEB				:(T01L)

NOT01	TTY = "?Cannot find " T01 CRLF
T01F	CLOSE(INCHAN)
	CLOSE(OUTCHAN)

	C01 = NODE '.C' SLOT
	K01 = NODE '.K' SLOT
	MPVVID.EQ.PAT = ARB ('MPVVID.' ! 'mpvvid.')

	INPUT("IN",LOOKUP(C01,INCHAN),160)		:S(DOC01A)
	TTY = "?Cannot find  " C01 CRLF			:(C01F)
DOC01A	OUTPUT("KAT",ENTER(K01,KATCHAN),160)		:S(DOC01B)
	TTY = "?Cannot enter " K01 CRLF			:(C01F)
DOC01B	OUTPUT("OUT",ENTER(C01,OUTCHAN),160)		:S(DOC01)
	TTY = "?Cannot enter " C01 CRLF			:(C01F)
DOC01	TTY = C01 CRLF
	OUT = ';; UPDATED ' TODAY ' ' NODE ' ISCS ' INITIALS
	OUT = ';@(NTS)ISCS06.I35'
	OUT = ';A' NODE '.T' SLOT
	OUT = ';@MPVC8.DEF'
	OUT = ';@(NTS)ISCS06.R35'
	OUT = ';@(ASYNCPAT)MPVVID.603'

DOC01D	LINE = IN					:F(DOC01E)
	KAT  = LINE
	LINE	POS(0) RPOS(0)				:S(DOC01D)
	LINE	MPVVID.EQ.PAT				:S(DOC01D)
	LINE	ARB ( '(ASYNCPAT)' ! '(asyncpat)' )	:F(DOC01D)
	TTY  = LINE ' Y/N  [No]? '
	ANS  = INTTY
	ANS	POS(0) ('Y' ! 'y') POS(1)		:F(DOC01D)
	OUT  = LINE					:(DOC01D)

DOC01E	CLOSE(KATCHAN)
	OUT = '1;F' NODE '.N' SLOT
	OUT = 'CTA,CTASIZ;PSEG0,S0SIZE;PSEG1,S1SIZE;PSEGD,SDSIZE;P%P%Q'
C01F	CLOSE(OUTCHAN)

	C00 = NODE '.C00'
	OUTPUT("OUT",ENTER(C00,OUTCHAN),160)		:S(DOC00)
	TTY = "?Cannot find " C00 CRLF
DOC00	TTY = C00 CRLF
	OUT = ';; UPDATED ' TODAY ' ' NODE ' ISIS-II T-II ' INITIALS
	OUT = ';@(NTS)TII05.I33'
	OUT = ';A' NODE '.TYM'
	OUT = ';AISXRAY.GGY'
	OUT = ';@(NTS)TII05.R33'
	OUT = '1;F' NODE '.N00'
	OUT = ';X(SOURCE)TIII05.WRT'
C00F	CLOSE(OUTCHAN)

	CMD = NODE '.CMD'
	OUTPUT("OUT",ENTER(CMD,OUTCHAN),160)		:S(DOCMD)
	TTY = "?Cannot find " CMD CRLF			:(CMDF)
DOCMD	TTY = CMD CRLF
	OUT = ';; UPDATED ' TODAY ' ' NODE ' ISIS-II T-II ' INITIALS
	OUT = ';@(SOURCE)I2IS11.I01'
	OUT = ';A' NODE '.TYM'
	OUT = ';AGOODGY.NQA'
	OUT = ';@(NTS)I2IS11.R33'
	OUT = '1;F' NODE '.NIB'
	OUT = '70;T0,CRCT;PINTLEN,IEND-INTLEN;P%PSEGF,SFSIZE;P%Q'
CMDF	CLOSE(OUTCHAN)				:(NEXT)

END
