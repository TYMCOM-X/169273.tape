                        REMOTE X-RAY USERS GUIDE            July 7, 1981


       
       
       
       
       
       
       
       
       
       
       
       
                               REMOTE  X-RAY
       
       
                                    by
       
                               Milan  Momirov
                              INTRODUCTION













            Remote  X-RAY  is an  interactive  debugging  and monitoring
       system that resides in  all TYMNET-II nodes, both SOLO  and ISIS,
       that are running code Version 3.07 or later.  It permits the user
       to read and (if authorised) write memory and provides a  menue of
       commands  that  conveniently  display  information  regarding the
       node's  configuration,   neighbors,  performance,   and  internal
       diagnostics.

            SOLO X-RAY vs. ISIS X-RAY

            Apart from certain commands that apply specifically  to ISIS
       or SOLO code, the only  difference between SOLO and ISIS  XRAY is
       in the use of the TTY port on the ENGINE multi-function  card. On
       an ISIS machine, this card belongs to the ISIS debugger, DDT, and
       therefore XRAY can only be accessed through the network (ie., the
       node must  be up).  On a SOLO  machine, the  TTY port  belongs to
       XRAY, and since XRAY is run independently of the node code  it is
       possible to  use XRAY  via the TTY  even though  the node  may be
       down.

            ACCESSING X-RAY THROUGH THE NETWORK

            The login  string is  XRAY:<host number>;password  where the
       host number is that of the node kernel. XRAY will respond with:
       
               X-RAY
               NODE: <node #>
               HOST: <host #>
               TIME: <xray time - (five digits FASTC).(3 digits SLOWC)>

            On rare occasions the  login may be unsuccessful;  this will
       most likely  be due to  one of two  reasons. First,  the channels
       allocated to remote XRAY are also used for other functions and if
       no  channels  are  available the  login  request  will  be zapped
       without warning  or explaination. Second,  only one  Remote X-RAY
       user can be logged in at one time; subsequent attempts to  log in
       are zapped. Try again in about 10 minutes.

            LEAVING REMOTE X-RAY

            To log out  type control-Z ( just  Z for Version  3.06)  and
       the circuit will be zapped without any logoff message.



                                   1
                              INTRODUCTION


            NODE TIME AND CLOCKS

            The basic time unit is one bit of FASTC, which is 1/600 sec.
       Time  intervals  are  generally  displayed  in  this   unit,  and
       occasionally in seconds. The format for the <node time>  and also
       for the message time in CRYPTO diagnostics is:

                    <1-sec clock>.<lower 12 bits of FASTC>

            The  lower   12  bits   of  FASTC   cycle  every   6.8  sec;
       equivalently, each one of these bits represents 26.6 ms.

            CRYPTO MESSAGES

            These   are   internal   diagnostic   messages  continuously
       generated  by  the  node   code  in  response  to  a  variety  of
       conditions. If a CRYPTO  diagnostic is generated while a  user is
       logged into XRAY the  corresponding message will be  displayed on
       the  users  terminal  unless automatic  crypto  display  has been
       turned off using the  CD command.   The last 256  CRYPTO messages
       are stored  in the CRYPTO buffer, and can be retrieved  for later
       examination with the  CM and CL  commands. A full  description of
       the CRYPTO messages is at the end of this document.

            XRAY COMMAND FORMAT

            All XRAY commands are of the form:

                    <COMMAND> <ARG1>...<ARGN> <carriage return>

            where COMMAND is a 1  or 2 letter command and  the arguments
       are seperated by commas or spaces.

            COMMAND ERRORS

            To abort  any command  type control-C for  a remote  user or
       <break> for the TTY.

            COMMAND AUTHORIZATION

            Generally, the XRAY user  will have access to only  a subset
       of XRAY's commands. Attempting to execute an unauthorized command
       results in an error message.













                                   2
                            COMMAND SUMMARY


            New or augmented commands are noted by  '**'






            CD**    Controls display of CRYPTO messages on user terminal

            CL      Displays last N CRYPTO messages

            CM      Displays all CRYPTO messages of particular type

            DB**    Initiates link-delay measurements

            DD**    Displays data obtained from DB command

            DE**    Ends delay measurement

            IS      Information on node-ISIS interface

            IR      Information on node-ISIS interface rings

            KD      Displays link parameters for given neighbor

            KS**    Link traffic and bandwidth utilization information

            ND      Summary of neighbor activity on all node lines

            NS**    Internal node performance monitoring parameters

            R       Read memory

            RR      Read Registers

            RS**    Read Symbolic

            SA      Symbol address

            SY      Symbol table display

            TD**    Display trace of command-channel records

            TL**    Initiate TSN trace on link

            TM**    Display data from TSN operation

            W       Write into memory

            WF      Write into memory a fullword at a time






                                   3
                           X-RAY COMMAND LIST













            **************************************************

                                    CD      <ARG>

            CD selects whether Crypto messages will be displayed  on the
       users terminal as they are generated by the node code ( ARG = 0 )
       or not ( ARG = 1 ).

            With  no arguments  CD displays  the current  Crypto display
       mode. The  messages are stored  in the Crypto  buffer and  can be
       retrieved with the CL  and CM commands regardless of  the display
       mode.
       
       >CD 1
       
        AUTO CRYPTO OFF
       
       >CD
       
        AUTO CRYPTO OFF

            ***************************************************

                                    CM <Message number>

            CM  works from  the beginning  of the  CRYPTO buffer  to the
       current buffer position printing out all the  diagnostic messages
       of  the specified  type.  Example  with CRYPTO  message   0B (CRQ
       BUILT THROUGH NODE)
       
       >CM 0B
       00245.F6C 0B: CRQ BUILT 000B204E
       00245.FE5 0B: CRQ BUILT 000B304D
       00245.05E 0B: CRQ BUILT 000B404C
       00245.0DB 0B: CRQ BUILT 000B5032

            ***************************************************

                                    CL <count>

            CL  displays the  last  <count> (hex)  CRYPTO  messages. For
       example:
       


                                   4
                           X-RAY COMMAND LIST


       >CL 4
       0037A.3B8 0A: NO NEIGHBOR 0000052E
       0037A.3B8 0C: CRQ ZAP 0001F031
       0038A.B17 0B: CRQ BUILT 0003104F
       0038B.B8B 0B: CRQ BUILT 000B2032

            !!!! NOTE !!!!  The CRYPTO buffer area is not cleared when a
       node crashes and restarts, so be sure that the messages displayed
       with a  CM command (  which searches the  ENTIRE Crypto  buffer )
       refer to the currently running code and are not leftovers from an
       earlier crash. Make sure the message time makes sense.

            If the text BAD MESSAGE  is output during execution of  a CL
       command, ignore all Crypto messages preceeding it.










































                                   5
                           X-RAY COMMAND LIST


            ***************************************************

                                    DB 0

            The DB command  permits the X-ray  user to measure  the link
       delay between the  node and any one  of its T-II  neighbors. This
       command  causes a  circuit to  be built  to a  neighbor  and test
       characters to  be periodically  sent down  the circuit.  The test
       characters consist of a halfword of FASTC followed by an optional
       number of fill halfwords, then another halfword of FASTC.  When a
       test packet returns  the  travel time is computed and  stored and
       may be  examined using  the DD  command. Strictly  speaking, this
       process measures  the round-trip delay,  but the  values obtained
       are  divided by  2 when displayed by  the DD command  to estimate
       the one-way delay.

            The DB command prompts  for four parameters relating  to the
       test circuit and then causes the circuit to be built. The current
       status of the circuit is described by a field in the DD command.
       
       >DB 0
       
       PRIORITY: 0
       HW FILL: 0
       FASTC INTERVAL: 800
       NODE LIST: 2031
       
       >
       

            PRIORITY  =  0 for  normal  (customer) circuit,  1  for high
       priority (ILC,command) circuit.

            HW FILL =  size of test  packet in hw. A  fill of 0  sends a
       single  hw  of FASTC  while  a  non-zero FILL  adds  in  FILL hw.
       Generally, unless measurements on large packets  are specifically
       desired there is no benefit to choosing a non-zero fill.

            FASTC INTERVAL   = Time interval  in fastc  between periodic
       measurements. An interval of 800 corresponds to a test  every 3.5
       seconds.

            NODE LIST = T-II neighbor number in octal.

            ***********************************************











                                   6
                           X-RAY COMMAND LIST


            *************************************************

                                    DD 0

            DD  displays  link delay  data  gathered on  a  test circuit
       created  using the  DB command,  and also  indicates  the current
       status of the test circuit.
       
       >DD 0
       
       
            **** AVE1, AVE2 AND DATA IN UNITS OF 6.66 MSEC ****
       
           TIME  STAT  FLAG  HWF   AVE1  AVE2  PTR
           0800  0001  80B0  0000  0008  0000  0028
       
           NODES : 2031
       
           DATA  :
           0008  0008  0009  0008  0009  0009  000C  0009
           0009  0008  0009  000A  0008  000A  000A  0009
           0009  0008  000A  000A  0016  0008  0009  0008
           0009  0009  0008  0009  0009  0009  0009  0008
       
       TIME    The time interval in FASTC units between tests.
       
       STAT    Current test circuit status.
                 0001  => Circuit up
                 FFFF  => Circuit zapped by node (due to link out, etc)
                 FFFE  => Circuit zapped by user with DE command
       
       FLAG    Flag field in needle that built the test circuit.
                 80B0 => ordinary circuit
                 81B0 => high priority circuit
       
       HWF     Number of fill halfwords in the test packet.
       
       AVE1    Average of the last 32 delay times.
       
       AVE2    Average of the last 512 delay times.
       
       PTR     Pointer into the delay times storage area.
               If the circuit is up this poiner will increment
               once per TIME interval as a new sample arrives.
       
       NODES   Neighbor at other end of test circuit.
       
       DATA    Last 32 delay times.
       

            ************************************************

                                    DE 0



                                   7
                           X-RAY COMMAND LIST


            DE ends the delay measurement operation by zapping  the test
       circuit. The value FFFE will be stored into the STAT field of the
       DD  command  to register  that  the circuit  was  zapped  by user
       command.

            *************************************************


















































                                   8
                           X-RAY COMMAND LIST


                                    IS    (ISIS NODES ONLY)

            ISIS  SNAP  Outputs  information  about  the  node code-isis
       interface.
       
       >IS
       IRCC  ORCC  ICHN  ICON  OHST  ILLG  IDSM  ODSM
       0000  0000  0000  0000  0000  0000  0000  0000
       
       IRCC    = Total character count passed from node code to ISIS 
                 dispatcher.
       ORCC    = Total character count passed from ISIS dispatcher to 
                 node code.
       ICHN    = Port number of external circuit most recently built 
                 to DISPATCHER interface
       ICON    = Originating node number for  port number in ICHAN
       OHST    = Host on this machine that most recently requested and 
                 received a port
       ILLG    = Count of total number of illegal logon characters 
                 received from hosts in the machine.
       IDISM   = Number of 1/16-sec dismisses while writing into
                 DISPATCHER ring
       ODISM   = Number of 1/16-sec dismisses while reading from
                 DISPATCHER ring
       

            ***************************************************

                                    IR    (ISIS NODES ONLY)

            ISIS RINGS  displays the input  and output pointers  for the
       node code-dispatcher communication rings. Example:
       
       >IR
       TO ISIS         FROM ISIS
       FILL  EMPTY     FILL  EMPTY
       NODE  ISIS      ISIS  NODE
       0014  0014      0048  0048


















                                   9
                           X-RAY COMMAND LIST


            ***************************************************

                                    KD <neighbor node number>

            LINK  DESCRIPTOR displays  parameters relating  to  the link
       between the node and a neighbor. An example with neighbor 2003:
       
       >KD 2003
       
       NODE  TPBO  NLWS  SPNM  NCHN  ISEC  NRTR  AMSK
       0403  0810  0108  8408  0080  05E2  0612  00FF
       OSEC  NRMK  NRXM  LRT   LAS   LRM   LAR   NAS
       0642  064E  065A  507E  507E  211D  211C  5080
       BNOD  CHN0  B.PT  E.PT  ACHN  LINES
       0000  0640  0C00  0D00  0008  00
       
       NODE    = Neighbor node number in HEX
       TBPO    = Line type, BORI indicator
       NLWS    = Number of lines attached, Window size
       SPNM    = Link speed, Link number
       NCHN    = Number of channels currently assigned to the link
       ISEC    = Pointer to input sector for link
       NRTR    = Pointer to next record to be torn
       AMSK    = Mask for acknowledgment truncation
       OSEC    = Pointer to output sector
       NRMK    = Pointer to next record to be made
       NRXM    = Pointer to next record to be transmitted
       LRT     = Number of last record torn
       LAS     = Number of last acknowledgment sent
       LRM     = Number of last record made
       LAR     = Number of last acknowledgment received
       NAS     = Number of next acknowledgment to be sent
       BNOD    = Node number if TIILNK, else 0 
       CHN0    = Absolute channel number of link channel 0
       B.PT    = Offset to start of permuter table entries 
                 (from KIOTAB) for this link
       E.PT    = Offset to end of permuter table entries for link
       ACHN    = Number of active channels over link
       LINES   = List of all lines attached to link
       
















                                   10
                           X-RAY COMMAND LIST


            ***************************************************

                                    KS <neighbor number>

            KS displays traffic and bandwidth utilization data  over the
       last minute for the link to the specified neighbor.
       
       >ks 2031
       
        ** ALL VALUES DECIMAL **
       
       LOGICAL LINK CHARACTERS
           CPS IN : 0001  HWM : 0788
           CPS OUT: 0018  HWM : 0102
       PHYSICAL LINK CHARACTERS
           CPS IN : 0038  HWM : 0946
           CPS OUT: 0045  HWM : 0144
       PACKET OVERHEAD
           IN : 95  %     OUT : 58  %
       BANDWIDTH UTILIZATION
           IN : 03  %     OUT : 03  %
        OVERLOAD COUNT   :0000
        SATURATED COUNT  :0000
       
       LOGICAL LINK CHARACTERS  Data character rate only, in char/sec
       
       PHYSICAL LINK CHARACTERS Total character rate, including packet
                                 header, record header(s), checksums
                                 and some inter-node control packets.
       
       HWM                      High water mark or peak value attained
                                 by data rate values since node came up.
       
       PACKET OVERHEAD          (Total bytes-Data bytes) as a percent
                                 of total bytes. Measures the percent
                                 of traffic that is used to perform 
                                 network control functions.
       
       BANDWIDTH UTILIZATION    Physical traffic as percent of maximum
                                data rate the link can carry.
       
       OVERLOADED COUNT         A link is considered overloaded when all
                                the channels on that link hot been
                                serviced at least once in the last half
                                second.
       
       SATURATED COUNT          A link is considered saturated whenever 
                                it has not gone idle at least once in
                                the last 1/2 second.

            *************************************************





                                   11
                           X-RAY COMMAND LIST


            *************************************************

                                    ND

            NODE DESCRIPTION  takes no arguments  and supplies  node and
       neighbor information.  A sample output is as follows:
       
       >ND
       NODE   VERSION   CRHCNT  CRSHID     CRSHAD
       2163  00000306     0001    0000    00000000
       PORTS  PASSTHRUS  ALNK  TLNK  XLNK   LINES  SYNC  SIO
       0000    0000      0003  0009  0009    0010  0010  0000
       SECONDS SINCE LAST CRASH (HEX) - 0000D575
        LINK/LINE STATUS:
       SYNC LINE 00  2003  UP - WSIZ 08    9.6  0004  CIRCUITS, XLINK
       SYNC LINE 01  2161  UP - WSIZ 08    9.6  0002  CIRCUITS, XLINK
       SYNC LINE 02  UNUSED
       SYNC LINE 03  UNUSED
       SYNC LINE 04  UNUSED
       SYNC LINE 05  2160  UP - WSIZ 08    9.6  0002  CIRCUITS, XLINK
       SYNC LINE 06  UNUSED
       SYNC LINE 07  UNUSED
       SYNC LINE 08  2002  *DOWN*
       SYNC LINE 09  UNUSED
       SYNC LINE 0A  UNUSED
       SYNC LINE 0B  UNUSED
       SYNC LINE 0C  UNUSED
       SYNC LINE 0D  UNUSED
       SYNC LINE 0E  UNUSED
       SYNC LINE 0F  UNUSED
       
       TIILNK NEIGHBORS DOWN - ZIP
       
       VERSION   number has the high-order digit = 1 for an ISIS node
                 and = 0 for SOLO.
       CRHCNT  = Crash count. Increments each time the node halts 
                 and restarts. A newly-loaded node has CRHCNT = 1
       CRSHID  = As documented for CRYPTO message 00
       CRSHAD  = The virtual address of the last crash. Power-fail => 0.
       PORTS   = Number of channels terminating in node to ISIS 
                 dispatcher or KERNEL ports.
       PASSTHRUS = number of passsthrough channels
       ALINK   = The total number of active links
       TLINK   = The total number of links specified in the TYMFILE
       XLINK   = number of unassigned  (wild-card) links in the TYMFILE
       LINES, SYNC, SIO= total number of lines, number of SYNC lines 
                 and number of SIO lines respectively.
       TIILNK NEIGHBORS DOWN refers to those neighbors specifically
                named in the node's TYMFILE.
       

            The CIRCUITS field  should always be at  least 2 for  a link
       which is up.  Line numbers  are as they would be given  to LOADII
       for a downline load.


                                   12
                           X-RAY COMMAND LIST


            ***************************************************
       
                                       NS
       

            NODE  STATUS  takes  no  arguments.  It  displays one-second
       averages and peak values  of certain operating parameters  and is
       useful in estimating node load.
       
       >NS
       
       EXCT  EXLW  EXHW  EDHW  EEHW  SYHW  NEHW  NECT
       00A1  005D  00A6  0004  001A  0015  9CE4  0009
       
        RMK XCT  RMK NMK  PACKETS
       00002B4F 00002ACA 00000085
       
       NODE'S TOTAL CPS RATES (IN DECIMAL):
       CPSO  CPSI  HWMO  HWMI
       0044  0000  0086  0853
       
       SYLV  0.5S  SPDR  SWIT  LINK  DWLI  XRAY  1SEC
       0000  0246  182D  0143  0000  0000  0000  002B
       
       
       EXCT    = Average number of node-code EXEC loop iterations per
                 second averaged over the last minute.
       EXLW    = The lowest EXCT value computed since the node started
       EXHW    = The highest EXCT value computed since the node started
       EDHW    = The longest FASTC time the node was code dismissed to
                 the ISIS or SOLO KERNEL
       EEHW    = The longest time in FASTC units for a single EXEC loop
                 iteration
       SYHW    = The longest FASTC time between SYLVER executions
       NEHW    = The longest FASTC time for the node to process a needle
       NECT    = Count of valid needles processed by node since startup
       RMK XCT = total number of calls to RMAKE in the last minute
       RMK NMK = number of these calls in which no records were made
       PACKETS = number of packets made in RMAKE during last minutwe
       

            NODE'S TOTAL  CPS RATES  (IN DECIMAL):  Identical to  the KS
       command PHYSICAL CHARACTER  COUNT field, but  showing cummulative
       data for all links.

            SYLV  0.5S  SPDR   SWIT  LINK  DWLI   XRAY  1SEC :  The node
       code  consists of  a  collection of  independent  processes, each
       performing a part of the network function. These  fields identify
       the eight highest priority  processes and the time spent  in each
       over the last minute in units of FASTC.

            ***************************************************




                                   13
                           X-RAY COMMAND LIST


            ***************************************************
       
                               R <start address> <count>
                               R <start address>

            READ <count> HEX bytes beginning at the EVEN address <start-
       address>.  If no count is  given the default is 16  bytes.  X-ray
       operates under MAC relocation and protection, and expects virtual
       addresses for the R and  W commands. To read absolute  memory add
       A0000  to the  absolute address.  Thus, R  100 will  read virtual
       address 100 while R A0100 will read absolute address 100.  If the
       address is not in the code address space  BAD ADDRESS is typed.

            ***************************************************
       
                               RR

            READ  REGISTERS. Following  a  node code  crash  (MAC error,
       Illegal  instruction  or  node-code  detected  error)   the  node
       registers immediately  prior to  the error are  saved in  an area
       ERRREG and RR  displays this area. ERRREG  is not cleared  upon a
       node  restart, and  will therefore  retain information  about the
       most recent crash.

            *************************************************
       
                               RS <Symbol Name> <count>
       

            RS is identical  to R except that  a search for  <Symbol> is
       done in  the internal symbol  table and the  value, if  found, is
       used as the starting address.
       >RS EXEPSW 4
       
       10048: 0FF0 CA00
       

            ***************************************************
       
                               SA <Symbol Address>

            SYMBOL  ADDRESS Wwill  supply the  address of  the specified
       symbol if it is contained in the internal symbol table.

            ***************************************************
       
                               SY *
                               SY <character>

            SYMBOL  TABLE.  The  symbol  table  contains  the  names and
       locations of several  commonly used node  code symbols. With  a *
       argument, SY displays the  entire symbol table. With  a character
       argument,  only those  symbols beginning  with the  character are
       displayed.


                                   14
                           X-RAY COMMAND LIST


            ***************************************************























































                                   15
                           X-RAY COMMAND LIST


            ***************************************************
       
                               TD <number> <char>
       
       

            TRACE COMMAND CHANNEL DATA: The node code keeps a history of
       all records that it sent  and received on the command  channel to
       the supervisor. These records are stored in a circular buffer and
       may be  retrieved and  displayed in convenient  form with  the TD
       command.

            The TD  command takes  two arguments:  record count  and I/O
       selection.   Both  arguments  are  optional.  The   record  count
       specifies the  number of records  to be displayed,  starting with
       the most recent, and the I/O argument selects input (char =   I )
       or output (char  = O ) records  only.  The defaults  are: display
       all qualifying records in the buffer, and display both  input and
       output records.

            In addition  to displaying  the data  bytes, the  TD command
       displays the command  channel number ( 20  or 21 ) and  the FASTC
       time the record was made by RMAKE or torn by RTEAR.

            The  significance  of  the various  node  to  supervisor and
       supervisor to  node messages are  explained in the  Principles of
       Operation manual. Note that a single record may contain more than
       one message.

            Example 1: Display last 3 OUTPUT records: ( Note there is NO
       SPACE between the first and second argument)
       
       >TD 3O
       
       I/O  CHN  TIME
       
       OUT 0020  198E  84  69  14  89  70  60  E3  EF  84  69  14  89
                       E2  00  1C  A2  84  69  14  89  E1  00  1C  9D
                       84  69  14  89  E4  00  1C  A1  84  69  14  89
                       E3  00  1C  9C
       OUT 0020  3F83  84  69  14  89  70  60  E3  F1  84  69  14  89
                       E2  00  1C  BF  84  69  14  89  E1  00  1C  BC
                       84  69  14  89  E4  00  1C  BE  84  69  14  89
                       E3  00  1C  BB
       OUT 0020  0B5C  84  69  0B  80  01  00
       










                                   16
                           X-RAY COMMAND LIST


            *************************************************
                               TSN - Trace Sync Events

            The TSN option is a tool for examining the link  between two
       nodes in terms of the packet headers each node is sending  to the
       other. In addition to recording the transmission and reception of
       good packets, the TSN process records the occurence  of exception
       conditions such as checksum  errors, bad record numbers,  and bad
       acknowledgments. This detailed information permits the X-RAY user
       to reconstruct each node's  perception of the link  condition far
       more  completely than  through the  information available  in the
       supervisor PROBE log.

            TSN operates in three processes of the node code. These are:
       SYLVER, which is the  first node code process to  receive packets
       from a  link, RMAKE,  which makes  packets for  transmission, and
       RTEAR,  which  tears  down  packets  received  from  SYLVER.  Two
       seperate TSN  event tables are  maintained, one filled  by SYLVER
       and the  other by RMAKE  and RTEAR. They  are referred to  as the
       FOREGROUND and BACKGROUND tables  respectively.

            The TSN  option must  be specified at  assembly time  in the
       TYMFILE. It is a low overhead option and is  recommended whenever
       the node is  to be used in  a new configuration or  with untested
       data communication hardware.

            *************************************************
       
                               TL <neighbor number>
       

            TRACE LINK writes a neighbor number into the TSLINK  cell in
       memory, thereby initiating the TSN process for that link. The TSN
       option must have been specified  in the TYMFILE for this to  be a
       valid command.  The TSN data may be examined with the TM F and TM
       B commands.

            Tracing  on  a  link  will cease  when  the  TSLINK  cell is
       cleared. This can be done by the X-RAY user by doing TL 0, and is
       also done automatically by the node code when a reset  patterd is
       received on a link being monitored.

            With no arguments TL displays the current neighbor number in
       the TSLINK cell.

            ***********************************************
       
       
                               TM F or TM B
       

            TRACE MONITOR displays the FOREGROUND ( TM F ) or BACKGROUND
       ( TM B )  tables of data gathered by  the TSN process on  a link.



                                   17
                           X-RAY COMMAND LIST


       The TSN option must have  been specified in the TYMFILE  for this
       to be a valid command.
       
       >TM F
       
        EVENT     LINE  HEAD  ACK   RECN     FASTC
       
       ZERO BIT    04    20    BE    00    82    D6E3
       GOOD REC    04    20    BE    F3    82    D6E3
       ZERO BIT    04    30    A0    00    82    D91B
       RESET       04    30    A0    04    71    D91C
       

            In the description of the TSN option, 'RECORD'  and 'PACKET'
       are used interchangably.  'Record' refers to the physical record,
       or packet, not the logical  record, and the record number  is the
       same as the packet number.

            There  are eight  possible events  in the  FOREGROUND table.
       Except where noted otherwise, the data fields have  the following
       significance:
       
       LINE    =       Physical line number
       
       HEAD    =       First byte of packet header
       
       ACK     =       Acknowledgment field of packet header. This is
                       the packet number of the last good packet the
                       neighbor received from the node.
       
       RECN    =       Record number field of packet header. This
                       field identifies the packet for subsequent
                       acknowledgment by the neighbor.
       
       
       FASTC   =       Lower 3 bytes of FASTC indicating packet
                       arrival time
       

            The possible FOREGROUND events are:
       
       ZERO BIT : A line in marking state went to a space indicating
                  a possible BORI. First two bytes of potential packet
                  header are in HEAD and ACK fields.
       
       GOOD REC : A good packet (physical record) has been received
       
       BAD ACK  : A packet passed the checksum but its acknowledgment
                  field is out of sequence with earlier acknowledgments
       
       BAD RECN : A packet has passed the checksum but its record number
                  field is out of sequence with earlier packet numbers.
       
       CKSM ERR : A packet failed the checksum


                                   18
                           X-RAY COMMAND LIST


       
       DUMMYREC : In the absence of other activity dummy records
                  are exchanged between nodes to keep the link up
       
       REXMISSN : A retransmisssion of a packet has been received.
       

            The BACKGROUND table is accessed in similar fashion:
       
       >TM B
       
       
        EVENT     VA1   VA2   VA3   VA4      FASTC
       
       PKT MADE    01    20    02    03    05    E056
       PKT TORN    01    10    00    02    05    DFD8
       PKT MADE    00    20    01    02    05    DF16
       PKT TORN    00    10    00    01    05    DE8E
       PKT MADE    FF    20    00    01    05    DDDC
       PKT TORN    FF    10    00    00    05    DD62
       

            There are four possible BACKGROUND events. These are:
       
       PKT MADE        A packet has been made in RMAKE and queued
                       for transmission on the link.
                       VA1 = Last acknowledgment sent to neighbor
                       VA2 = First byte in packet just made
                       VA3 = Neighbor packet most recently torn
                       VA4 = Record number of packet just made
       
       PKT TORN        Packet from neighbor torn in RTEAR
                       VA1 = Last acknowledgment to neighbor sent
                       VA2 = First byte of packet torn
                       VA3 = acknowledgment field in packet
                       VA4 = Record number field in packet
       
       DETACH          Line Detached on link
                       VA1 = Line number
                       VA2 = ?
                       VA3 = Number of last record torn on link
                       VA4 = Detach reason, as in CRYPTO message 04
       
       ATTACH          Line attached on link
                       VA1 = Line number
                       VA2 = ?
                       VA3 = ?
                       VA4 = ?
       







                                   19
                           X-RAY COMMAND LIST


            ************************************************
                               W <start address> <count>
                               W <start address>

            WRITE  <count>  HEX  bytes  beginning  at  the  EVEN  <start
       address> The default  count is 2  bytes. XRAY displays  and opens
       memory a halfword at a time, following which the user may enter a
       hex half-word.  Leading zeroes are not needed (i.e., 1A  = 001A).
       Typing <CR>  returns the  user to  command mode.   Typing /  or \
       causes XRAY to close this halfword and open and display the next.
       This command requires authorization.

            ***************************************************
       
                               WF <start address> <count>

            WRITE FULLWORD. Identical to W except that memory is written
       a fullword at a time.

            ***************************************************




































                                   20
                            CRYPTO MESSAGES













            These diagnostic messages are continuously generated  by the
       node code and the last  256 are stored in the CRYPTO  buffer. One
       24-bit numerical value is  passed into the buffer along  with the
       message  itself.  This  numerical  value  will  have  a different
       significance for each of the individual CRYPTO messages.   In the
       node  code,  this  value  is  passed  in  register  0;  hence the
       references to 'R0'.  Only the lower 24  bits may be used  to pass
       values. The  convention is  that if a  message needs  two values,
       they are stored in the upper and lower half-words of R0,  and the
       XRAY  user  must  mentally seperate  the  single  number  that is
       displayed  into its   components. In  a few  messages,  the first
       value may  be too large  to be  expressed in 8  bits, so  the two
       vlaues are  stored in bits  8-19 and bits  20-31. All  values are
       displayed in HEX.

            Crypto messages have four fields. These are:
       
               1. <Node time message was generated>
               2. <CRYPTO message number>
               3. <Message text>
               4. <Single 32-bit value of which only
                   the lower 24 are significant>
       

            The  following text  is an  expanded version  of  the actual
       messages that are displayed.



















                                   21
                              CRYPTO MESSAGES


       
       MESSAGE #               TEXT
       
       00      : CRASH. R0 = CRASH ID, CRASH ADDRESS (5 DIGITS)
                 CRASH ID : 0 => OOPS, 4 => ILLEGAL INST, 8=> MAC ERR
       01      : LINK UP - R0 HAS LINK #, NEIGHBOR #
       02      : LINK DOWN. R0 = NEIGHBOR NUMBER
       03      : NO PERMUTER TABLE HALF PAGES AVAILABLE FOR NEW
               : LINK - R0 HAS LINK # IN UPPER HW, NEIGHBOR # IN LOWER
       04      : LINE DETACHED. R0 = REASON FOR DETACH, LINE NUMBER
               : REASON : 1=> NO REC RECEIVED, 2=> NO GOOD REC RECEIVED,
               :          3 => RESET RECEIVED, 4 => BORI ZAP
       05      : TAKEOVER. R0 = SUPERVISOR NUMBER
       06      : SUPERVISOR STOP
       07      : SUPERVISOR CRQ LOST. R0 = 0
       08      : SHUFFLER ERROR
       09      : ZAPPER ON UNASSIGNED CHANNEL FROM T-I NEIGHBOR - R0
               : HAS CHANNEL NUMBER IN UPPER HW, NEIGHBOR # IN LOWER HW
       0A      : NO NEIGHBOR - R0 HAS NEIGHBOR NUMBER
       0B      : CRQ BUILT. R0 = NEEDLE ENTRY PORT, EXIT PORT
       0C      : CRQ ZAP. R0 = ZAPPER ENTRY PORT, EXIT PORT
               : THE PRECEEDING TWO MESSAGES MUST BE MANUALLY ENABLED
               : BY LETTING CRYDIS > 0
       0D      : TERMINATING NEEDLE SPECIFIES A DESTINATION HOST NOT 
               : ON THIS NODE. CRQ IS ZAPPED.  R0 = HOST NUMBER
       0E      : GOBBLER OR OTHER CHARACTER PAIR FOLLOWS NEEDLE.
               : R0 = CHARACTER.
       0F      : TIMEOUT ON CHANNEL PROCESSING NEEDLE. R0=ABS CHN#
       10      : CHANNEL IN USE - R0 HAS CHANNEL NUMBER
       11      : REBUILD REQUEST. R0 = EXIT PORT #
       12      : CRQ REBUILD COMPLETE. R0 = TERM #,  EXIT CHN
       13      : REBUILD REJECT
       14      : REBUILD DATA LOST
       15      : CHANGE IN HOST STATUS - R0 HAS STATUS AND HOST #
       16      : NEW LINE ATTACHED. R0 = LINE #, NEIGHBOR #
       17      : OUT OF COMMAND PORTS
       18      : EARLY ZAPPER FOLLOWS NEEDLE. R0 = ABS CHANNEL NO.
       19      : OUT OF CHANNELS TO NEIGHBOR. R0 = NEIGHBOR # (HEX)
       1A      : BAD NEEDLE POINT RECEIVED. R0 = 'NEEDLE POINT'
       1B      : OUT OF PORTS TO NODE KERNEL
       1C      : NO MORE PORTS TO ISIS DISPATCHER
       1D      : SIO INTERRUPT REPORT -R0 = INTERRUPT CODE, DAUGHTERBOARD
               : PORT # IN UPPER HW, ABSOLUTE LINE # IN LOWER HW.
               : INTERRUPT CODE - 1 = ASYNC INTERRUPT, 2 = CCW ERROR,
               : 6 = UNDERRUN, 8 = I/O COMMAND ERROR
       1E      : TYMNET-I LINE WENT 4 SECONDS WITH NO GOOD RECORDS
               : RECEIVED - R0 HAS NEIGHBOR NUMBER
       1F      : RTD DETECTED NON-GOBBLING ZAPPER - R0 HAS BF
       20      : LINE SUSPENDED DUE TO RESET ERROR - R0 HAS LINE NUMBER
               : IN UPPER HALFWORD, # OF SECONDS SUSPENDED IN LOWER HW
       21      : LINK SHRINK - R0 HAS NEIGHBOR NUMBER
       22      : LINK BUBBLE - R0 HAS LINK #, NEIGHBOR #
       23      : INVALID LOGGER ENTRY - R0 HAS ILLEGAL BF
       24      : SUP DATA ON UNASSIGNED CHANNEL - R0 HAS CHANNEL NUMBER


                                    22
                              CRYPTO MESSAGES


       25      : SUP ZAP ON UNASSIGNED CHANNEL - R0 HAS CHANNEL NUMBER
       26      : INVALID MACHINE NUMBER ON SUP COMMAND CIRCUIT - R0 HAS
               : ERRONEOUS NEIGHBOR NUMBER (WE COULD BE OUT OF SYNC
               : ON COMMAND CIRCUIT)
       27      : INVALID COMMAND TYPE FROM SUP - R0 HAS BAD COMMAND MINUS 8
       28      : DATA ON UNASSIGNED CHANNEL FROM NEIGHBOR - R0
               : HAS CHANNEL NUMBER IN UPPER HW, NEIGHBOR # IN LOWER HW
       29      : NEEDLE ON ASSIGNED CHANNEL - R0 HAS CHANNEL NUMBER IN
               : UPPER HW, NEIGHBOR NUMBER IN LOWER HW
       2A      : RECEIVED 03 CHARACTER PAIR WHICH IS INVALID - R0 HAS
               : INVALID 2ND CHAR IN UPPER HW, ABSOLUTE CHANNEL IN LOWER
       2B      : INTERNAL HOST CHANNEL TIMEOUT. A CHANNEL
               : WITH TIMEOUT ENABLED HASNT RECEIVED DATA FOR 2 MIN
               : CRQ IS ZAPPED. R0 =  FUNCTION BYTE, ABSOLUTE CH #
               : FUNCTION BYTE = LINE # FOR DWL CRQ, FFFF OTHERWISE
       2C      : A NEW DOWNLINE LOAD CRQ HAS BEEN ESTABLISHED.
               : R0 = TARGET LINE #,  ABSOLUTE CH # TO HOST.
       2D      : DOWNLINE LOAD LINE CRQ ZAP.  R0=LINE NUMBER,CHN NUMBER
       2E      : OUT OF INTERNAL HOST PORTS DOWNLINE LOAD, REMOTE X-RAY 
               : AND PLITEXT REQUESTS WILL BE ZAPPED UNTIL A PORT FREES UP.
       2F      : ISIS HOST OUT OF PORTS
       30      : SYNC SCAN ERROR.  R0 - LN*2, SEG 0B OFFSET
       31      : DETDGN CALLING ERROR - R0 MEANINGLESS
       32      : SIO BUFFER COUNT ERROR. R0 - LN*2, COUNT
       32      : SIO BUFFER COUNT ERROR. R0 - LN*2, COUNT
       33      : SIO MOTHER-BOARD TIMEOUT. R0 - LINE NUMBER, SVC INDEX.
               : INDEX :  2 = CONNECT SVC, 3 = INPUT SVC, 4 = OUTPUT
       34      : CIRCUIT BUILDING ERRORS. R0 - COUNT
       35      : CIRCUIT COUNTING INCONSISTENCY. R0 HAS NUMBER
                OF OCCURRENCES, MAGNITUDE OF INCONSISTENCY.
       36      : LINK ERROR - CHN GREATER THAN MAX ON THIS LINK. R0 = CHN
       37      : LINK ERROR - BAD CHN IN B.P. REC. R0 HAS CHN
       38      : LINK ERROR - ILC BUF ZERO. R0=0
       39      : LINK SNIP DUE TO LINK ERROR. R0 HAS NEIGHBOR NUMBER
       3A      : SIO CARD BUSY. R0 HAS COMMAND
       3B      : SIO CARD RING INTERRUPT. R0 HAS STATUS




















                                    23
} ±