NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 1
NAD01.R06	24-JUL-87 17:39		NAD FILE LAYOUT

					TITLE	NAD   NODE ASSEMBLER AND DEBUGGER.
					SUBTTL	NAD FILE LAYOUT
					SALL			;SUPPRESS MACRO EXPANTIONS
				; ******************************************************************
				; **			PROPRIETARY INFORMATION			  **
				; **								  **
				; **  This  source code listing constitutes the proprietary pro-  **
				; **  perty of MDC-TYMNET. The recipient, by receiving this pro-  **
				; **  gram listing,  agrees that  neither this  listing  nor the  **
				; **  information  disclosed herein nor any  part  thereof shall  **
				; **  be reproduced or transferred to other documents or used or  **
				; **  disclosed  to others  for manufacturing or  for any  other  **
				; **  purpose except  as specifically  authorized in  writing by  **
				; **  MDC-TYMNET.						  **
				; ******************************************************************
				; **			PROGRAM IDENTIFICATION			  **
				; **								  **
				; **  Version Number	: 1.06	  Release Date : 9/1/87		  **
				; **								  **
				; **  File Name		: nad01.r06				  **
				; **								  **
				; **  File Description	: Macro source file for NAD		  **
				; **								  **
				; **  File Abstract	: This is the only source file for NAD.   **
				; **			: The command file NAD01.C05 will create  **
				; **			: the file NAD.SAV.			  **
				; **								  **
				; ******************************************************************
			000001	VERSION==1			;NAD version
			000006	REVISION==6			;Revision level of version
	000137				LOC	137
	000137	000001	000006		XWD	VERSION,REVISION
	000000'				RELOC	0

				;	COMMENTS ON CONDITIONAL JUMPS AND SKIPS REFER TO THE JUMP OR SKIP PATH

				;	NAD FILE LAYOUT
				;	MACRO DEFINITIONS
				;	SYMBOLIC DEFINITIONS AND SOME CONSTANTS AND VARIABLES
				;	IZY			INITIALIZE SYMBOL TABLE
				;	IZ			INITIALIZE NAD
				;	GF (GET FILE)		GETS AND ASSEMBLES FILE
				;	GS (GET STATEMENT)	GETS AND ASSEMBLES STATEMENT
				;	GE (GET EXPRESSION)	GETS AND ASSEMBLES EXPRESSIONS
				;	GK  (TOKEN GETTER)	GETS CHR OR SUBSTRING AND TRANSLATES TO A VALUE
				;	SYMBOL LOOKUP ROUTINES
				;	FILE HANDLER AND SWAPPER
				;	LISTER
				;	SYMBOL DICTIONARY UTILITY
				;	DIRECTIVE PROCESSORS
				;	INSTRUCTION PROCESSORS
				;	ERROR MESSAGE HANDLER
				;	MISCELLANY
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 1-2
NAD01.R06	24-JUL-87 17:39		NAD FILE LAYOUT

				;	DEBUGGER COMMAND HANDLER
				;	DEBUGGER COMMANDS
				;	TABLES AND ERROR MESSAGES
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 2
NAD01.R06	24-JUL-87 17:39		MACRO DEFINITIONS

					SUBTTL	MACRO DEFINITIONS
				;		*********************************************

					OPDEF	QER	[31_33]
					OPDEF	CIT	[30_33]	;CALL INPUT TRAP PROCESSOR
					OPDEF	MEND	[32_33] ;MACRO END
					OPDEF	MARG	[33_33] ;MACRO ARG
					OPDEF	MAE	[34_33] ;MACRO ARG END
					OPDEF	TMES	[35_33]	;type message
					OPDEF	CPF	[	PUSHJ	S,PF]	;CALL PROGRAM FAILURE
					OPDEF	RETURN		[POPJ	S,]
					OPDEF	PJS		[PUSHJ S,]

					DEFINE	TYPE (TYPEA),<
					TMES	[ASCIZ	\TYPEA\]>

				;	GET FREE LIST ENTRY TO W.
					DEFINE	GFL,<
					SKIPN	W,@FL
					PJS	GM
					EXCH	W,FL>

				;	RETURN FREE LIST ENTRY FROM REGISTER "R"
					DEFINE	DFL(R),<
					EXCH	R,FL
					HRRZM	R,@FL>

				;	CONVERT CHARACTER TO TYMNET CHARACTER BY ADDING PARITY BIT
					DEFINE	TYMNET(C),<200!C>

				;	Check if aux circuit defined. If not go to NOAUX.
					DEFINE	AUXCHK,<
					SKIPGE	CN
					JRST	NOAUX>

				;DEFINE REGISTERS
			000001	S=1			;PUSH DOWN STACK POINTER
			000002	I=2			;CURRENT INPUT CHARACTER POINTER
			000003	C=3			;CURRENT INPUT CHARACTER (USUALLY)
			000004	V=4
			000005	U=5
			000006	VS=6
			000007	OS=7
			000010	W=10
			000011	X=11
			000012	Y=12
			000013	L=13
			000014	M=14
			000015	F=15			;Primary Flag values
			000016	F2=16			;Secondary Flag values

					DEFINE	ALS (ALSX,ALSSTR),<ALSB==ALSX
					IRP	ALSSTR,<	ALSSTR==ALSB
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 2-2
NAD01.R06	24-JUL-87 17:39		MACRO DEFINITIONS

						ALSB==ALSB+1>>

					DEFINE	DSP (DSPLST),<IRP DSPLST,<DSPX DSPLST>>
					DEFINE	DSPX (DSPXA),<DSP2 DSPXA>
					DEFINE	DSP2 (DSP2A,DSP2B),<ALS ALSB,DSP2A
					EXP	DSP2B>

					DEFINE	CA (BYTSIZ),	;BYTSIZ IS HALFWORD IF BYTSIZ ARG IS H.
				<	PJS	CA'BYTSIZ'SUB>

					DEFINE	DBYTE (BREG),	;DEPOSIT A BYTE
				<	MOVE	W,V		;;NEXT PHYSICAL ADDRESS
					SUB	W,VTAB+2	;;BIAS TO VIRTUAL ADDRESS
					CA			;;GET LOCAL BYTE ADDRESS
					DPB	BREG,W		;;DEPOSIT BYTE 2
					ADDI	V,1		;;INCREMENT ADDRESS
				>

				;	DEFINE IO CHANNELS FOR SYMBOLIC, LISTING, OBJECT, IMAGE BINARY,
				;	AND CROSS TEMPORARY.
					ALS	10,<ICH,LCH,JCH,BCH,TCH>

				;	DEFINE CHR TYPES
					ALS	0,<IT,OH,DIG,UAF,LAF,UGZ,LGZ,PE,OP,DE,VB,EM,CO,MA,AE>

				;	DEFINE OPERATORS AND BUILD OPERATOR INDEXED PRECEDENCE TABLE.
			000000		ALSB==0
	000000'	000000	000007	PREC:	DSP	<<UAT,7>,<UBSLH,7>,<UPLU,7>,<UMIN,7>>
	000001'	000000	000007
	000002'	000000	000007
	000003'	000000	000007
			000004		NU==ALSB
	000004'	000000	000004		DSP	<<BPLU,4>,<BMIN,4>>
	000005'	000000	000004
			000002		NB==BPLU-UPLU
	000006'	000000	000005		DSP	<<STAR,5>,<SLASH,5>,<AMP,2>,<EXCL,1>,<PERC,1>,<UPAR,6>>
	000007'	000000	000005
	000010'	000000	000002
	000011'	000000	000001
	000012'	000000	000001
	000013'	000000	000006
			000014		NAO==ALSB		;NUMBER OF ARITHMETIC OPERATORS
					ALS	NAO,<BFO>;	;BBF (BUILD BACKWORD FORWARD).
	000014'	000000	000000		DSP	<<OLPAR,0>,<ORPAR,0>,<OT,0>>
	000015'	000000	000000
	000016'	000000	000000

				;	DELIMITERS
					ALS	0,<BLA,TAB,COM,DOL,LPAREN,RPAREN,EQSIGN,LBRAK,RBRAK>;	;EXPRESSION DELIMITERS

			000011		NED==ALSB
					ALS	ALSB,<COLON,SEMIC,CAR>;	;STATEMENT DELIMITERS
			000003		NSD==ALSB-NED
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 2-3
NAD01.R06	24-JUL-87 17:39		MACRO DEFINITIONS


					DEFINE	JV (AJV),<
					IRP	AJV,<
					JRST	AJV>>

				;	BORROW AND RESTORE REGISTERS.
					DEFINE	BAR (BARA),<BARADR==.
					BARM==0
					BARN==0
					IRP	BARA,<BARM==1_BARA!BARM>
					REPEAT	20,<IFN	1_BARN&BARM,<PUSH	S,BARN>
					BARN==BARN+1>
					PJS	.-BARADR+.+2
					REPEAT	20,<BARN==BARN-1
					IFN	1_BARN&BARM,<POP	S,BARN>>
					RETURN>

				;	CONDITIONAL DEPOSIT BYTE.
					DEFINE	CDPB (CDPBAC,CDPBD),<
					SKIPE	LSTMSK
					DPB	CDPBAC,CDPBD>

					DEFINE	PE (PEMSG,PERET),<QER	[XWD PEMSG,PERET]>

				;	INCREMENT LINE COUNTER EXCEPT DURING MACRO EXPANSION
					DEFINE	INCLC,<
					SKIPN	MACSTK
					AOS	LC>
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 3
NAD01.R06	24-JUL-87 17:39		SYMBOLIC DEFINITIONS AND VARIABLES

					SUBTTL	SYMBOLIC DEFINITIONS AND VARIABLES
				;		*********************************************


					EXTERN	.JBFF,.JBREN

				;Left half of Primary Flag values (register F)
			000001	ESCSW==1			;ESCAPE FLAG
			000002	VBSEEN==2			;VERTICAL BAR SEEN BY TOKEN GETTER
			000004	LSI==4				;1 if listing conditionals (IF, ELSE, EI)
			000010	EXPRIP==10			;EXPRESSION EVALLUATION IN PROGRESS
			000020	NOMACX==20			;SUPPRESS MACRO EXPANSIONS
			000040	NOLIST==40			;1 IF NOLIST
			000100	ENDFND==100			;1 IF "END" STATEMENT FOUND
			000200	ENDRPT==200			;STATEMENT IS END REPEAT (LISTER)
			000400	LSR==400			;0 IF LISTING REPEATED REPEAT LOOP
			001000	LSCEOL==1000			;STATEMENT TERMINATOR WAS ";" (LISTER)
			002000	LSX==2000			;0 IF LISTING MACRO EXPANSIONS
			004000	ABTASM==4000			;1 if assembly aborted
			010000	EOFF==10000			;EOF ENCOUNTERED
			020000	LSCNF==20000			;NOLIST OR UNTRUE IF (LISTER)
			040000	LSF==40000			;0 IF LISTING UNTRUE IF LINES
			100000	LSL==100000			;0 IF LISTING NOLISTED LINES AS IS
			200000	DCCF==200000			;DEBUG COMMAND CHARACTER ; : OR % SEEN
			400000	UTRUIF==400000			;1 IF IN UNTRUE IF

				;Right half of Primary Flag values (register F)
			000001	ASONLY==1			;1 IF ONLY ASSEMBLING,NOT LISTING
			000002	SUPLST==2			;1 IF SUPPRESSING LISTING
			000004	LPASS1==4			;1 IF PASS ONE LISTINGS HAPPENING
			000010	LPASS2==10			;1 IF PASS TWO LISTING HAPPENING
			000020	NEWSEC==20			;1 IF NEXT PAGE SHOULD BE NEW SECTION
			000040	TTLFND==40			;1 IF TITLE NOT YET FOUND IN PASS ONE
			000100	CREF==100			;1 IF CREF HAPPENING THIS PASS
			000200	FSBTTL==200			;1 IF FIRST SUBTITLE NOT YET FOUND
			001000	PRPTOK==1000			;1 if last token scanned was in proprietary code
			002000	INCREF==2000			;1 IF OUTPUTING CREF INFO
			004000	PRPCOD==4000			;1 if in proprietary code
			010000	LSTTTL==10000			;1 IF LISTING TITLE
			020000	LSTDTL==20000			;1 IF LISTING DEFAULT TITLE
			040000	MASCAN==40000			;1 IF SCANNING FOR MACRO ARGUMENTS IN CALL
			100000	MBSCAN==100000			;1 IF SCANNING MACRO BODY IN DEFINITION
			200000	MKSHAD==200000			;1 if constructing shadow symbol table
			400000	LSLOCK==400000			;1 if input file is proprietary and not listed

				;Right half of Secondary Flag values (register F2)
			000001	FRCLST==1			;1 if all assembles should list
			000002	MLTLST==2			;1 if multiple assemblies to single file
			000004	CRFLST==4			;1 if listing is a CREF listing
			000010	PS1LST==10			;1 if pass one listing desired
			000020	TYMPRP==20			;1 if user has TYMSHARE PROPRIETARY license
			000040	BINMOD==40			;1 if debugger in binary mode
			000100	CONDST==100			;1 if statement is conditional (IF, ELSE, EI)
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 3-2
NAD01.R06	24-JUL-87 17:39		SYMBOLIC DEFINITIONS AND VARIABLES


				;Monitor symbol definitions
			040000	JP.TYM==1B21			;TYMSHARE PROPRIETARY license
		777777	777753	.GTFPN==-25			;GETTAB of file PPN
			000006	.GTPRV==6			;GETTAB of user privledge
		777777	777756	.GTUNM==-22			;GETTAB of user name (1-6) SIXBIT
		777777	777757	.GTUN1==-21			;GETTAB of user name (7-12) SIXBIT
			000011	.GTCNF==11			;GETTAB of configuration table

				;Symbol table bits in word zero
			400000	SYUNDF==400000			;symbol is undefined
			200000	SYSHNU==200000			;symbol was not defined (only shadow table)
			100000	SYPROP==100000			;symbol was defined in proprietary file
			040000	SYPRPM==040000			;symbol is macro from proprietary code or macro

			002007	HASHSZ==2007			;HASH TABLE SIZE
			000004	RPMAX==4			;MAX NUMBER OF ACTIVE REPEAT BLOCKS
			000000	CHRIT==00			;INPUT TRAP CHARACTER (MUST BE 0)


			000120		NPDS==120		;PUSH DOWN STACK SIZE
			000020		NIPD==20		;INTERRUPT STACK SIZE
	000017'			IPDS:	BLOCK	NIPD		;STACK FOR AUX INTERRUPT
	000037'	000000	000000	INTS:	0
	000040'			PDS:	BLOCK	NPDS		;PUSHDOWN STACK AND SOME TEMPORARY STORAGE SPACE

	000160'	777740	000163'	ESKP:	IOWD	40,ESK1
	000161'	777740	000203'		IOWD	40,ESK2
	000162'			ESK:	BLOCK	2		;STACK POINTERS FOR STATEMENT ERROR STACK
	000164'			ESK1:	BLOCK	20
	000204'			ESK2:	BLOCK	20
			000010		UCERN==10
	000224'	000000	000000	UCERC:	Z
	000225'			UCPCT:	BLOCK	UCERN		;TABLE OF PC S THAT HAVE BAD DISPLACEMENTS FOUND BY UC

			000002		NNEST==2		;NUMBER OF LEVELS ALLOWED OF NESTED "'"S
			000020		NVS==20			;NUMBER OF VALUES THAT CAN FIT INTO VALUE STACK
			000024		NOS==NVS+4		;ALLOW A FEW MORE OPERATORS THAN VALUES
	000235'	000000	000000	OPS:	0			;POINTER TO OP STACK
	000236'	000000	000000	VALS:	0			;POINTER TO VAL STACK
	000237'	000000	000000	VALSF:	0			;POINTER TO UNDEF FLAG STACK
	000240'			VALSS:	BLOCK	NVS*NNEST
	000300'			VALSFS:	BLOCK	NVS*NNEST	;FLAGS THAT SPECIFIY WHETHER VALS IS UNDEFINED
	000340'			OPSS:	BLOCK	NOS*NNEST	;OPERATOR STACK
	000410'	000000	000412'	IBSLP:	Z	BSLPS		;initial value for backslash stack pointer
	000411'	000000	000000	BSLP:	Z			;backslash stack pointer
	000412'			BSLPS:	BLOCK	NOS*NNEST	;backslash stack. -1 if \ arg, 0 otherwise

	000462'	000000	000000	LABEL:	Z
	000463'	000000	000000	LABELP:	Z
	000464'	000000	000000	LLABEL:	Z
	000465'	000000	000000	LLC:	Z
	000466'	000000	000000	TYP6C:	Z
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 3-3
NAD01.R06	24-JUL-87 17:39		SYMBOLIC DEFINITIONS AND VARIABLES

	000467'	000000	000000	DOTP:	Z
	000470'	000000	000000	CURSEG:	0			;CURRENT SEGMENT INDEX
				;SEGMENT TABLE - INITIAL PC VALUES
	000471'			SEGSAV:	BLOCK	20		;FOR SAVING INITIAL SEGTAB
	000511'	000000	000000	SEGTAB:	EXP 0,200000,400000,600000
	000512'	000000	200000
	000513'	000000	400000
	000514'	000000	600000
	000515'	000001	000000		EXP 1000000,1200000,1400000,1600000
	000516'	000001	200000
	000517'	000001	400000
	000520'	000001	600000
	000521'	000002	000000		EXP 2000000,2200000,2400000,2600000
	000522'	000002	200000
	000523'	000002	400000
	000524'	000002	600000
	000525'	000003	000000		EXP 3000000,3200000,3400000,3600000
	000526'	000003	200000
	000527'	000003	400000
	000530'	000003	600000
	000531'	000000	000000	SEGTOP:	EXP 0,200000,400000,600000
	000532'	000000	200000
	000533'	000000	400000
	000534'	000000	600000
	000535'	000001	000000		EXP 1000000,1200000,1400000,1600000
	000536'	000001	200000
	000537'	000001	400000
	000540'	000001	600000
	000541'	000002	000000		EXP 2000000,2200000,2400000,2600000
	000542'	000002	200000
	000543'	000002	400000
	000544'	000002	600000
	000545'	000003	000000		EXP 3000000,3200000,3400000,3600000
	000546'	000003	200000
	000547'	000003	400000
	000550'	000003	600000
	000551'	000000	000000	PC:	Z
	000552'	000000	000000	PCP:	Z
	000553'	000000	000000	PCP1:	Z
	000554'	000000	000000	PCP2:	Z
	000555'	260040	025257'	PCV1:	CPF
	000556'	000000	000000	PCV2:	Z
	000557'	576043	574445	MOA:	SIXBIT	"OPCODE"	;MODULE NUMBER 0
	000560'	475457	424154		SIXBIT	"GLOBAL"
	000561'	165541	436257		SIXBIT	".MACRO"	;RESERVED FOR SYSTEM USE
	000562'	161646	624545		SIXBIT	"..FREE"
	000563'	554151	560000		SIXBIT	"MAIN  "
	000564'				BLOCK	44+MOA-.
	000623'			MOORG:	BLOCK	44		;VALUE OF ORIGIN WHEN THIS MODULE STARTED EFFECT
	000667'			MOUSE:	BLOCK	44		;USING REGISTOR ASSOCIATED WITH A MODULE
	000733'	000000	000000	IBF0:	Z			;ADDRESS OF FIRST INPUT BUFFER
	000734'	000000	000016	JSPEC:	16
	000735'	446353	000000		SIXBIT	/DSK/
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 3-4
NAD01.R06	24-JUL-87 17:39		SYMBOLIC DEFINITIONS AND VARIABLES

	000736'	000000	000000		0
	000737'	000000	000016	BSPEC:	16			;NAD IMAGE BINARY FILE SPEC
	000740'	446353	000000		SIXBIT	/DSK/
	000741'	000000	000000		0
	000742'	000000	000012	BL:	12			;EXTENDED LOOKUP BLOCK
	000743'				BLOCK	11
	000754'	000000	000000	LSPEC:	0
	000755'	446353	000000		SIXBIT	/DSK/
	000756'	002301'	000000		LOH,,0
	000757'	000000	000017	TSPEC:	17			;CROSS REQUEST FILE SPEC
	000760'	446353	000000		SIXBIT	/DSK/
	000761'	000000	000000		0
	000762'	000000	000006	TL:	6			;CROSS REQUEST EXTENDED LOOKUP AND ENTER BLOCKS
	000763'	000000	000000		0
	000764'	202020	436245	TE:	SIXBIT	/000CRE/
	000765'	645560	000000		SIXBIT	/TMP/
	000766'	000000	000000		0
	000767'	000000	000000	TLSIZE:	0			;FILE SIZE
	000770'			TR:	BLOCK	4		;CROSS REQUEST DELETE BLOCK
	000774'	000000	000000	SWAPC:	Z
	000775'	000000	000000	DMSCTR:	Z
	000776'	000000	000000	LSPACE:	Z
	000777'	000000	000000	LSTMSK:	Z			;-1=PASS 1, 0=PASS 2
	001000'	000000	000000	DSW:	Z			;ZERO IF GS NOT CALLED BY DEBUGGER

			000013	.CHOPN==13			;init a device and channel
			000004	.CHLK==4			;select a file for input
			000022	.CHIBF==22			;create input buffer ring
			000014	.CHIN==14			;buffered input
			000000	.CHREL==0			;release a device

			000001	CMDNBF==1			;number of input buffers for each file
			000206	CMDSBF==3+CMDNBF*<3+200>	;input buffer size
			000005	CMDMAX==5			;number of command files
			000004	CMDLIM==CMDMAX-1		;highest command file number
			000020	CMDCHN==20			;first command file channel

	001001'			CMDUSR:	BLOCK	2		;command file user name
	001003'	000000	000000	CMDBLK:	Z			;open block
	001004'	446353	000000		SIXBIT	/DSK/
	001005'	000000	000000		Z
	001006'			CMDNAM:	BLOCK	4		;lookup block
	001012'			CMDBUF:	BLOCK	CMDSBF*CMDMAX	;command file input buffers
	002250'			CMDBFA:	BLOCK	0		;addresses of input buffers
			000000	CMDX==0
					REPEAT	CMDMAX,<
					EXP	CMDBUF+CMDX*CMDSBF
				CMDX==CMDX+1>
	002250'	000000	001012'
	002251'	000000	001220'
	002252'	000000	001426'
	002253'	000000	001634'
	002254'	000000	002042'
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 3-5
NAD01.R06	24-JUL-87 17:39		SYMBOLIC DEFINITIONS AND VARIABLES

	002255'	777777	777777	CURCMD:	EXP	-1		;index of current commmand file
	002256'	000000	000000		EXP	0		;CMDECO(-1) for inital value of echoing
	002257'			CMDECO:	BLOCK	CMDMAX		;-1 if no echo, 0 if echo of command input
	002264'	260040	022124'		PJS	CTINP		;input routine for command file -1, always terminal
	002265'			CMDSRC:	BLOCK	CMDMAX		;command file source
	002272'	260040	022124'	GCHI:	PJS	CTINP		;GET CHAR INSTRUCTION
	002273'			LEUSR:	BLOCK	2		;listing file user name
	002275'			LE:	BLOCK	4
	002301'			LOH:	BLOCK	3
	002304'	000000	000000	ISPEC:	0
	002305'	446353	000000		SIXBIT	/DSK/
	002306'	000000	002325'		XWD	0,IH
	002307'	564144	000000	OBJNAM:	SIXBIT	/NAD/		;OBJECT FILE NAME
	002310'	645560	000000	OBJNM1:	SIXBIT	/TMP/
	002311'			JE:	BLOCK	4
				;
				;	The source file lookup block. An extended lookup block
				;	is used to get the PPN of the file being looked up. This is returned is IL+1
				;	replacing the address of the username (ILUSR). The PPN is used to determine
				;	if the file to be assembled comes from the directory from which NAD
				;	was started.
				;
	002315'			ILUSR:	BLOCK	2		;input file user name
	002317'	000000	000005	IL:	Z	5		;INPUT FILE LOOKUP BLOCK
	002320'				BLOCK	5		;a five data word extended lookup block
	002325'			IH:	BLOCK	3		;INPUT FILE BUFFER RING HEADER

			002320'	IFPPN=IL+1			;PPN value in input file LOOKUP block
	002330'			NADFPN:	BLOCK	1		;PPN of file where loaded from
	002331'			SYLOCK:	BLOCK	1		;0 if symbols not in proprietary code,
								;SYPROP otherwise

				;	NAD IMAGE BINARY I/O MACROS
					DEFINE	IBINP(BUFF,R,BAD),
				<	IFNB	<BAD>,<MOVE R,BAD
				>	IFNB	<R>,<USETI BCH,1(R)
				>	INPUT	BCH,[BYTE (18)-200,1,0,0]>

					DEFINE	IBOUT(BUFF,R,BAD),
				<	IFNB	<BAD>,<MOVE R,BAD
				>	IFNB	<R>,<USETO BCH,1(R)
				>	OUTPUT	BCH,[BYTE (18)-200,BUFF-1,0,0]>

					DEFINE	IIBSW(X,N),
				<	MOVEI	W,X
					MOVEI	V,N
					PJS	ISYIB
					CPF>

					DEFINE	OIBSW(X,N),
				<	MOVEI	W,X
					MOVEI	V,N
					PJS	OSYIB>
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 3-6
NAD01.R06	24-JUL-87 17:39		SYMBOLIC DEFINITIONS AND VARIABLES


				;	NAD IMAGE BINARY FILE ID RECORD BLOCK.
	002332'	000000	000000	IBID:	0			;ID HEADER (4/1,12/BAD,20/**)
	002333'	000000	000000	IBPSA:	0			;PROGRAM START ADDRESS
	002334'	000000	000000	IBDATE:	0			;CREATION DATE (PDP FORMAT)
	002335'	000000	000000	IBTIME:	0			;CREATION TIME IN MSEC
	002336'			IBUNAM:	BLOCK	2		;USERNAME FOR FILE (6BIT)
	002340'			IBFILE:	BLOCK	2		;FILENAME AND EXTENSION (6BIT)
	002342'			IBAUTH:	BLOCK	2		;USERNAME OF AUTHOR (6BIT)
	002344'			IBRIX:	BLOCK	2*100-12-2		;2 WORD RECORD INDEXES
	002530'	000000	000000		0
	002531'	000000	000000	IBIDC:	0			;CHAIN TO NEXT ID RECORD BLOCK

				;	NEW RECORD BLOCK
	002532'			NRHDR:	BLOCK	2		;4/TYPE, 12/BAD, 20/**
	002534'			NRDATA:	BLOCK	176		;36/**
	002732'	001100	002731'	NREND:	1100,,NRDATA+175

				;	NIB MEMORY IMAGE BLOCK.
			002532'	MIHDR=NRHDR			;4/2, 12/BAD, 20/PAD; 15/BCNT, 1/U, 20/VAD
			002534'	MIDATA=NRDATA			;4(1/0,8/BYTE) OR 1/1,8/BYTE,1/0,8/BYTE,18/REPEAT CNT
			002732'	MIEND=NREND
			077776	MIBMAX==77776			;MAXIMUM BYTES IN A MEMORY IMAGE RECORD.
								;LIMITED BY SIZE OF 'BCNT' FIELD IN HEADER (ONLY 15 BITS)
								;AND THE DESIRE TO HAVE AN EVEN NUMBER OF BYTES IN EACH RECORD.


				;	NIB SYMBOL TABLE BLOCK
			002532'	SYHDR=NRHDR			;4/3, 12/BAD, 20/COUNT; 36/MODULE
			002534'	SYDATA=NRDATA			;36/**
			002732'	SYEND=NREND

				;	MAC set and memory bank record
			002532'	MSHDR=NRHDR			;4/4, 12/**, 20/Subtype; 36/Data

				;	NIB FLAGS AND POINTERS.
	002733'	400414	000000	IBTYPP:	POINT	4,(M),3		;RECORD TYPE POINTER
	002734'	241414	000000	IBBADP:	POINT	12,(M),15	;BLOCK ADDRESS POINTER
	002735'	002414	000000	IBPADP:	POINT	20,(M),35	;PHYSICAL ADDRESS POINTER
			002735'	IBSYCP=IBPADP			;SYMBOL TABLE ENTRY COUNT
			002735'	IBMSTP=IBPADP			; MAC set entry subtype pointer
	002736'	251714	000001	IBCNTP:	POINT	15,1(M),14	;BYTE COUNT POINTER
	002737'	240114	000001	IBUVAP:	POINT	1,1(M),15	;UNDEFINED VIRTUAL ADDRESS FLAG POINTER
	002740'	002414	000001	IBVADP:	POINT	20,1(M),35	;VIRTUAL ADDRESS POINTER
	002741'	000000	000000	BRNGL:	0			;BEGIN OF GET MEMORY RANGE LIST
	002742'	000000	000000	ERNGL:	0			;END OF GET MEMORY RANGE LIST
	002743'	000000	000000	MIALL:	0			;<0 IF PUT/GET SELECTIVE,ELSE >=0
	002744'	000000	000000	MIDAP:	0			;NEXT DATA BYTE POINTER (IN MI BLOCK)
			002744'	SYDAP=MIDAP
	002745'	000000	000000	IBRIXP:	0			;NEXT AVAILABLE INDEX SLOT FOR NIB PUTS
	002746'	000000	000000	SCNT:	0			;SAVED IMAGE BINARY BYTE COUNT (WHEN>77777)
	002747'	777777	777777	BFSW:	-1			;0=NEW FILE, 1=OLD, -1=NONE
	002750'	000000	000000	BAD:	0			;NEXT BLOCK TO OUTPUT/INPUT
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 3-7
NAD01.R06	24-JUL-87 17:39		SYMBOLIC DEFINITIONS AND VARIABLES

	002751'	000000	000000	B1BAD:	0			;FIRST BLOCK OF SYMBOL TABLE RECORD
	002752'			SYBUFF:	BLOCK	3		;BUFFER FOR SYMBOL TABLE ENTRIES
			000001	MSMSTY==1			; MAC set record subtype
			000004	MSTYP==4			; MAC set record type
			000003	SYTYP==3			;SYMBOL TABLE RECORD TYPE
			000002	MITYP==2			;MEMORY IMAGE RECORD TYPE
			000001	IDTYP==1			;ID RECORD TYPE
	002755'	202222	272731	IBSOVR:	SIXBIT	/022779/	; State table version of invalid macro defs
	002756'	203020	303023	IBSVER:	SIXBIT	/080883/	; State table version on nib file
	002757'			IBMMUL:	BLOCK	1		; Multiplier for macro size in definition
			000200	NIBSW==200			;NUMBER OF NIB STATE TABLE WORDS

				;	LISTER FLAGS, CONSTANTS AND VARIABLES.
			000170	ICHPLN==^D120			;INITIAL CHARACTERS/LINE
			000221	CPLMAX==^D145			;MAXIMUM CHARACTERS/LINE
			000062	CPLMIN==^D50			;MINIMUM CHARACTERS/LINE
			000070	ILNPPG==^D56			;INITIAL LINES/PAGE
			777777	LPPMAX==777777			;MAXIMUM LINES/PAGE
			000004	LPPMIN==^D4			;MINIMUM LINES/PAGE
	002760'	000000	000170	CHPLN:	ICHPLN			;CHARACTERS/LINE
	002761'	000000	000070	LNPPG:	ILNPPG			;LINES/PAGE
	002762'	000000	000000	LSTLN:	Z			;-1 IF LINE NOT YET LISTED
								; 0 IF MORE OF LINE TO LIST
								; 1 IF LINE DONE LISTING
	002763'	000000	000000	SAVCHR:	Z			;SAVE CHARACTER BETWEEN LINE LISTINGS
			000020	HEXSIZ==20			;CHAR POS FOR HEX IN LISTING (NOT PC)
			000150	ITXTSZ==ICHPLN-HEXSIZ		;INITIAL TEXT SIZE
	002764'	000000	000150	TXTSIZ:	ITXTSZ			;TEXT SIZE
	002765'	000000	000000	LNLEFT:	0			;LINES LEFT ON PAGE BEING LISTED
	002766'	201011	640610	STDTTL:	ASCIZ	"  NAD-000000 00-XXX-00 00:00"
	002767'	265406	030140
	002770'	301404	030140
	002771'	266613	054132
	002772'	301404	030140
	002773'	351406	000000
	002774'	267254	167132	MONTH:	ASCII	"-jan-"
	002775'	267154	561132		ASCII	"-feb-"
	002776'	267334	171132		ASCII	"-mar-"
	002777'	267036	071132		ASCII	"-apr-"
	003000'	267334	174532		ASCII	"-may-"
	003001'	267256	567132		ASCII	"-jun-"
	003002'	267256	566132		ASCII	"-jul-"
	003003'	267036	563532		ASCII	"-aug-"
	003004'	267474	570132		ASCII	"-sep-"
	003005'	267374	372132		ASCII	"-oct-"
	003006'	267355	773132		ASCII	"-nov-"
	003007'	267114	561532		ASCII	"-dec-"
			000056	TTLMIN==^D46			;MINIMUM CHARACTERS IN TITLE
			000024	TTLSIZ==<CPLMAX-TTLMIN>/5+1	;SIZE OF TITLE BUFFERS
	003010'			TTLBF:	BLOCK	TTLSIZ		;TITLE BUFFER
	003034'			DTTLBF:	BLOCK	TTLSIZ		;DEFAULT TITLE BUFFER
			000031	STLMIN==^D25			;MINIMUM CHARACTERS IN SUBTITLE
			000031	STLSIZ==<CPLMAX-STLMIN>/5+1	;SIZE OF SUBTITLE BUFFERS
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 3-8
NAD01.R06	24-JUL-87 17:39		SYMBOLIC DEFINITIONS AND VARIABLES

	003060'			STLBF:	BLOCK	STLSIZ		;SUBTITLE BUFFER
	003111'			DSTLBF:	BLOCK	STLSIZ		;DEFAULT SUBTITLE BUFFER
	003142'	000000	000000	SECNUM:	Z			;CURRENT SECTION NUMBER
	003143'	000000	000000	PAGNUM:	Z			;CURRENT PAGE NUMBER
	003144'	000000	000000	TXTOUT:	Z			;NUMBER OF TEXT CHARACTERS OUTPUT SO FAR
	003145'	000000	000000	NORPT:	0			;DON'T LIST REPEATED REPEAT IF NOLIST OR UNTRUE IF
	003146'			SYSNO:	BLOCK	7		;Sysno buffer for %V command

	003155'	122002	101012	SWRAN:	XWD	122002,101012
	003156'	000000	000000	UCC:	Z
	003157'	000000	000000	GESF:	Z
	003160'	000000	000000	OPCODE:	Z
	003161'	000000	000000	R1:	Z
	003162'	000000	000000	DISP:	Z
	003163'	000000	000000	FX2:	Z
	003164'	000000	000000	SX2:	Z
	003165'	000000	000000	RUSING:	Z
	003166'	000000	000000	UDISP:	Z			;0 if disp defined, -1 if undefined
	003167'	000000	000000	GSEC:	Z			;STATEMENT ERROR COUNT
	003170'	000000	000000	ERRCNT:	Z			;Assembly error count
	003171'			GMTVAL:	BLOCK	1		;Fixed GMT value for file assembly
	003172'			TIMFIX:	BLOCK	3		;used for time fixing with DATUUO
	003175'	000000	000000	UNSW:	Z			;SET TO -1 BY UN DIR. TO INHIBIT DEN FROM TYPING UNDEFINEDS
	003176'	000000	000000	IFLINE:	0			;LINE NUMBER OF OUTER IF STATEMENT
	003177'	000000	000000	IFLABL:	0			;LABEL NAME OF OUTER IF STATEMENT
	003200'	000000	000000	IFLOCL:	0			;LOCAL LINE OF OUTER IF STATEMENT
	003201'	000000	000000	TRUTH:	0			;USED BY LISTER TO REMEMBER IF BODY STATUS
	003202'	000000	000000	IFC:	Z
	003203'	000000	000000	IFT:	Z
	003204'	000000	000000	ELSESW:	Z
	003205'	000000	000000	RPF:	Z
	003206'	000000	000000	RELINE:	0			;LINE NUMBER OF OUTER REPEAT STATEMENT
	003207'	000000	000000	RELABL:	0			;LABEL NAME OF OUTER REPEAT STATEMENT
	003210'	000000	000000	RELOCL:	0			;LOCAL LINE OF OUTER REPEAT STATEMENT
	003211'	000000	000000	RPPTR:	Z
	003212'			RPL:	BLOCK	RPMAX
	003216'			RPI:	BLOCK	RPMAX
	003222'			RPC:	BLOCK	RPMAX
	003226'			RPLC:	BLOCK	RPMAX
	003232'			RLINEI:	BLOCK	RPMAX
	003236'			RPMAC:	BLOCK	RPMAX		;macro invocation at repeat start
			000010		NSB==10			;SIDE BFRS FOR INPUT
			000030		IINBUF==30		;MINIMUM NUMBER OF BFRS IN INPUT RING
			000010		NLBF==10		;EXTRA BFRS FOR INPUT IF NOT LISTING.
	003242'	000000	000000	PTB:	Z			;POINTER TO TRAILING BFR
	003243'	000000	000000	PAB:	Z			;POINTER TO ACTIVE BFR
	003244'	000000	000000	PLB:	Z			;POINTER TO LEADING BFR
	003245'	000000	000000	LTT:	Z
	003246'	000000	000000	LPG:	Z
	003247'	000000	000000	GFS:	Z
			003000	LSVSIZ==3000			;SIZE OF LISTING SAVE BUFFER
	003250'	000000	000000	LSVCNT:	Z			;NUMBER OF CHARACTER LEFT IN LSTBUF
	003251'			LSTBUF:	BLOCK	LSVSIZ		;LISTER LINE SAVE BUFFER
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 3-9
NAD01.R06	24-JUL-87 17:39		SYMBOLIC DEFINITIONS AND VARIABLES

	006251'	000000	000000	LSVP:	Z			;LISTER LINE SAVE BUFFER POINTER
	006252'	000000	000000	LISTI:	Z			;SAVE CURRENT TEXT POINTER START
	006253'	000000	000000	PCORG:	Z
	006254'	777777	777777	PCL:	-1			;-1 IF NO MEMORY DATA TO LIST, PC TO LIST FROM, PC AND SIGN
				;				BIT FOR PC THAT IS NOT IN LINE WITH THE VALUE OF .
	006255'	000000	000000	LINEI:	Z			;BEGINING OF LINE POINTER
	006256'	000000	000000	LC:	Z			;LINE COUNT
	006257'	000000	000000	LEC:	Z			;LINE ERROR COUNT
	006260'			PET1:	BLOCK	20
	006300'			PET2:	BLOCK	20
	006320'	000000	000000	GEUOK:	Z

	006321'	000000	000000	GSSTK:	Z			;stack pointer on entering GS
	006322'	000000	000000	UX:	Z			;previous pointer from FY
	006323'	000000	000000	UL:	Z			;UL AND UM MUST BE IN CONSECUTIVE LOCATIONS
	006324'	000000	000000	UM:	Z
	006325'	777777	777777	MM:	-1			;MODULE MASK
	006326'	777777	777777	MM1:	-1
	006327'	000000	000000	DFODLO:	Z
	006330'	000000	000004	MODULE:	4			;CURRENT MODULE NUMBER
	006331'	000000	000000	AMM:	Z			;MODULE MASK AT ASSEMBLY START
	006332'	000000	000000	AMODUL:	Z			;MODULE NUMBER AT ASSEMBLY START
	006333'	000000	000020	TRADIX:	20
	006334'	000000	000020	RADIX:	20
	006335'	000000	000020	ARADIX:	20			;RADIX WHEN STARTING ASSEMBLER
	006336'	070000	000000	BACKUP:	XWD	70000,
	006337'			TP:	BLOCK	40		;TEST PACKAGE OR PATCH AREA

				;	DEBUGGER STORAGE
	006377'	000000	000000	CRS:	Z

				;	Interrupt system definitions.
				;	The definitions for the names xxxCHN must correspond with the
				;	location of the interrupt routines in the transfer table TIV.

			000001	IA.DIS==1			;Disable interrupt system
			000002	IA.REE==2			;Enable interrupt system
			000004	IA.CLR==4			;Clear interrupt system

			000000	.IAESC==0			;Receipt of escape
			000001	.IACHR==1			;Receipt of a character
			000005	.IALOS==5			;Character lost on input
			000007	.IAZAP==7			;Receipt of a circuit zapper

			000001	ESCCHN==1			;Escape interrupt channel
			000002	ZAPCHN==2			;Zapper interrupt channel
			000003	LOSCHN==3			;Character lost interrupt channel
			000004	CHRCHN==4			;Character received interrupt channel

	006400'	000000	000000	TIV:	EXP	0,ESC,0,AUXZAP,0,AUXLOS,0,AUXINT ;TRAP INTERUPT VECTOR (OLDPC,,TRAPADR)
	006401'	000000	025761'
	006402'	000000	000000
	006403'	000000	026040'
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 3-10
NAD01.R06	24-JUL-87 17:39		SYMBOLIC DEFINITIONS AND VARIABLES

	006404'	000000	000000
	006405'	000000	026067'
	006406'	000000	000000
	006407'	000000	026073'
	006410'	000000	000000	CN:	0
	006411'	000000	000000	ICX:	Z
	006412'	000000	000000	OBR:	Z			;OUTPUT BAUD RATE
	006413'			ESCBLK:	BLOCK	4
	006417'	777777	777777	XIRX3R:	-1
	006420'			MDPAIR:	BLOCK	2
	006422'	000000	000000	AAPC:	Z
	006423'			LVV:	BLOCK	2		;VALUE VECTOR FOR DEBUGGER COMMANDS.
				;				 CONTAINS (VALUE OF LAST ARG, 0) FOR
				;				 EXPRESSIONS OR 2-6 BYTE INSTRUCTION VALUE
				;				 AND BYTE COUNT (SEE XVU)
	006425'			XIVU:	BLOCK	2
	006427'	000000	000000	XIU:	Z
	006430'	000000	000000	XIW:	Z
	006431'	260040	025257'	TNX:	CPF
	006432'	000000	000000	SWMIN:	Z
	006433'	000000	000001	LOCAL:	1
	006434'	000000	000000	DBLCHR:	Z			;LAST CHR PREPARED FOR OUTPUT BY DB.
	006435'	000000	000000	DBC0:	Z
	006436'	000000	000000	DBC1:	Z
	006437'	000000	000000	BC:	Z			;BLANK COUNT
	006440'	000000	000000	ARGC:	Z			;NUMBER OF ARGS SEEN FOR DEBUGGER COMMAND
	006441'	000000	000000	ARGC1:	Z			;SAME AS ARGC FOR USE BY AA ONLY

	006442'	000000	000000	IPC:	Z
	006443'	000000	000000	TOM:	Z			;TYPE OUT MODE
	006444'	000000	000000	COS:	Z			;CURRENT OUTPUT SIZE (HALFWORD OR FULLWORD)
	006445'	000000	000000	DTOM:	Z			;NOTE TOM AND COS TREATED AS DOUBLE WORD IN CRET COMMAND
	006446'	000000	000000	DCOS:	Z
	006447'	000000	000000	WCLM:	Z			;WIDTH OF COLUMNS FOR OUTPUT
	006450'	000000	000000	NCLM:	Z			;NUMBER OF COLUMNS FOR OUTPUT
	006451'	000000	000000	DWCLM:	Z			;WIDTH OF COLUMNS FOR OUTPUT
	006452'	000000	000000	DNCLM:	Z			;NUMBER OF COLUMNS FOR OUTPUT
	006453'	000000	000000	CLMCNT:	Z			;CURRENT COLUMN COUNT
	006454'	000000	000000	OPEN:	Z			;NON-ZERO IF MEMORY IS OPEN
	006455'	000000	000000	CMACNT:	Z
	006456'	000000	006457'	P6:	.+1
	006457'	051040	000004		OUTCHR	V
	006460'	136200	006462'		IDPB	V,DOS
	006461'	000000	000000	DOSX:	Z
	006462'	440700	006463'	DOS:	POINT	7,.+1
	006463'				BLOCK	20		;DISASSEMBLY OUTPUT STRING
	006503'	201004	020100	CS0:	ASCII	"     "
	006504'			CS:	BLOCK	17		;COMMAND STRING
	006523'			LCS:	BLOCK	1		;LAST COMMAND STRING POINTER
			000020	NCARGS==20			;NUMBER OF COMMAND ARGS ALLOWED
	006524'	000000	000000	VTABP:	Z
	006525'			VTAB:	BLOCK	2*NCARGS
	006565'	000000	000000	CMLADR:	Z
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 3-11
NAD01.R06	24-JUL-87 17:39		SYMBOLIC DEFINITIONS AND VARIABLES

	006566'	000000	000000	CMLDTA:	Z
	006567'	000000	000000	CMLU:	Z
	006570'	000000	000000	CMLCHR:	Z			;CURRENT COMMAND CHARACTER
	006571'	000000	000000	ICCHR:	Z			;CURRENT ENGINE COMMAND CHARACTER
	006572'	000000	000000	ICCTRM:	Z			;-1 if command terminator sent, 0 if not
	006573'	000000	031332'	ICJMP:	Z	IC2		;ENGINE COMMAND ARGS AFTER COMMAND KLUDGE JUMP
	006574'	000000	000000	ASCHEX:	Z
	006575'	000000	000100	FCSMIN:	100			;NUMBERS BELOW THIS ARE NOT TRANSLATED TO SYMBOLS
				;		 UNLESS USER EXECUTES VALUE;@ COMMAND
	006576'	000000	000200	FCSBND:	200			;MAX SYMBOL DIFFERENCE IN FCS
	006577'	260040	025257'	GECALL:	CPF
				;	END OF DEBUGGER STORAGE

	006600'	000000	006601'	FL:	EXP	.+1,0,0,0
	006601'	000000	000000
	006602'	000000	000000
	006603'	000000	000000
	006604'	000000	000000	YENDSV:	Z
	006605'	000000	000000	YEND:	Z
	006606'	000000	000000	YEND1:	Z
	006607'	000000	000000	YSUM:	EXP	0
	006610'			YHASHT:	BLOCK	HASHSZ
	010617'			EYH:

	010617'			SHASHT:	BLOCK	HASHSZ		;Shadow symbol table
	012626'			ESYH:
			004000		PGSIZ==4000		;PDP 10 WORDS PER PAGE
			000004		NPG==4			;NUMBER OF IN CORE PAGES
			000200		NPGD==200		;THE PROGRAM LOGIC MUST BE CHANGED ALONG WITH
								;THESE PARAMETERS. THESE ARE COMMENT PARAMETERS.

	012626'			CP:	REPEAT	PGSIZ/200,<XWD -200,0>
	012626'	777600	000000
	012627'	777600	000000
	012630'	777600	000000
	012631'	777600	000000
	012632'	777600	000000
	012633'	777600	000000
	012634'	777600	000000
	012635'	777600	000000
	012636'	777600	000000
	012637'	777600	000000
	012640'	777600	000000
	012641'	777600	000000
	012642'	777600	000000
	012643'	777600	000000
	012644'	777600	000000
	012645'	777600	000000
	012646'	000000	000000		Z
	012647'			PGT:	BLOCK	NPGD		;PAGE MAPPING TABLE
				;STORAGE FOR MACRO FACILITY
	013047'	013047'	013047'	MACFRE:	XWD	MACFRE,MACFRE	; Macro body free list. Start list empty
	013050'	000000	000000		0			; Set this entry empty
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 3-12
NAD01.R06	24-JUL-87 17:39		SYMBOLIC DEFINITIONS AND VARIABLES

	013051'	000000	000000	MACVER:	Z			;macro invocation counter
	013052'	000000	000000	MACCUR:	Z			;current macro invocation
	013053'	000000	000000	MACCNT:	Z			;NUMBER OF CHARS LEFT IN PORTION OF DEF BLOCK
	013054'	000000	000000	MACI:	Z			;SAVE INPUT POINTER FOR ERRORS DURING EXPANSIONS
	013055'	000000	000000	MACN:	Z			;POSITION IN MACRO STACK FOR ERROR MESSAGES
	013056'	000000	000000	MACSTK:	Z			;MACRO ARGUMENT CALL STACK
	013057'	000000	000000	IPSTK:	Z			;INPUT TEXT POINTER STACK
	013060'	000000	000000	ALWARG:	Z			;ALLOW DUMMY AFTER THIS CHAR IN MACRO DEF
	013061'	000000	000000	MCHCNT:	Z			;NUMBER OF WORDS IN MACRO DEF BLOCK
	013062'			MSYSAV:	BLOCK	2		;SAVE OF MACRO ARG DURING DEFINITION
	013064'	000000	000000	MACTXT:	Z			;ADDRESS OF TEXT CHAIN DURING MACRO DEFINITION
	013065'	000000	000000	NMARGS:	0			;ARG COUNT
			000020	NMACA==20			;MAX NUMBER OF ARGS ALLOWED
	013066'			MACARG:	BLOCK	NMACA		;SPACE FOR BYTE POINTERS TO ARG STRINGS
			000777	MBMAX==777			;Maximum number of blocks in macro definition
			002775	MWMAX==3*MBMAX			;Maximum number of words in a macro definition
			000017	MBSIZ==5*3			;Number of characters in a macro block
	013106'			MACBUF:	BLOCK	MWMAX		; Buffer for macro def and call while scanning
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 4
NAD01.R06	24-JUL-87 17:39		INITIALIZE NAD

					SUBTTL	INITIALIZE NAD
				;		*********************************************


	016103'			IZ:				;INITIALIZE NAD
	016103'	047000	000000		RESET
	016104'	403640	000016		SETZB	F,F2		;INITIALIZE ALL FLAGS TO OFF
	016105'	515400	320000		HRLZI	W,320000
	016106'	202400	006325'		MOVEM	W,MM		;SET UP MODULE MASK
	016107'	201400	000004		MOVEI	W,4
	016110'	202400	006330'		MOVEM	W,MODULE
					DMOVE	W,[ OPSS(OS)
	016111'	120400	034112'			VALSS(VS)]	;INIT EXPR STACK PTRS
	016112'	124400	000235'		DMOVEM	W,OPS
	016113'	200400	034114'		MOVE	W,[ VALSFS(VS)]
	016114'	202400	000237'		MOVEM	W,VALSF
	016115'	402000	000412'		SETZM	BSLPS		;set first stack word to not \
	016116'	402000	000464'		SETZM	LLABEL
	016117'	402000	000465'		SETZM	LLC
	016120'	402000	003034'		SETZM	DTTLBF		;SET NULL DEFAULT TITLE
	016121'	402000	003111'		SETZM	DSTLBF		;SET NULL DEFAULT SUBTITLE
	016122'	402000	003142'		SETZM	SECNUM		;START AT SECTION ONE
	016123'	200040	034115'		MOVE	S,[IOWD NPDS,PDS]
	016124'	200400	002307'		MOVE	W,OBJNAM	;MAKE OBJECT FILE NAME
	016125'	047440	000030		PJOB	X,		;OF FORM "NAD237.TMP"
	016126'	231440	000012		IDIVI	X,^D10		;extract digits
	016127'	242440	000006		LSH	X,6		;move high order digit to tens place
	016130'	246440	000006		LSHC	X,6		;move both over another char position
	016131'	434400	000011		IOR	W,X		;insert high order digit
	016132'	434400	000012		IOR	W,Y		;insert low order digit
	016133'	660400	202031		TRO	W,'009'
	016134'	202400	002307'		MOVEM	W,OBJNAM
	016135'	200200	000010		MOVE	V,W		;DELETE ANY EXISTING FILES WITH SAME NAMES
	016136'	350000	000004		AOS	V
	016137'	200240	002310'		MOVE	U,OBJNM1
	016140'	400400	000000		SETZ	W,
	016141'	050500	000734'		OPEN	JCH,JSPEC
	016142'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	016143'	370000	000004	IZ0:	SOS	V		;GET NEXT NAME IN SEQUENCE
	016144'	124200	002311'		DMOVEM	V,JE
	016145'	402000	002313'		SETZM	JE+2
	016146'	402000	002314'		SETZM	JE+3
	016147'	077500	002311'		ENTER	JCH,JE
	016150'	254000	016152'		JRST	.+2
	016151'	661400	000001		TLO	W,1		;SET FLAG FOR DONE
	016152'	402000	002311'		SETZM	JE
	016153'	055500	002311'		RENAME	JCH,JE
	016154'	255000	000000		JFCL
	016155'	606200	000017		TRNN	V,17		;ALL DONE?
	016156'	254000	016161'		JRST	IZ2		;YES
	016157'	607400	000001		TLNN	W,1		;DONE?
	016160'	254000	016143'		JRST	IZ0		;NO
	016161'	120400	000160'	IZ2:	DMOVE	W,ESKP		;INITIAL ERROR STACK POINTERS
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 4-2
NAD01.R06	24-JUL-87 17:39		INITIALIZE NAD

	016162'	124400	000162'		DMOVEM	W,ESK
	016163'	200400	034116'		MOVE	W,[PJS UUO]
	016164'	202400	000041		MOVEM	W,41		;SET UUO PUSHJ
	016165'	201400	025664'		MOVEI	W,CRESC1	;SET REENTER ADDRESS
	016166'	202400	000000*		MOVEM	W,.JBREN
	016167'	200400	000000*		MOVE	W,.JBFF
	016170'	202400	000733'		MOVEM	W,IBF0
	016171'	541410	032154		HRRI	W,IINBUF*203+NSB*201+10*203+NPG+NPG*PGSIZ(W)	;IINBUF BFRS FOR INPUT,
				;				NSB SIDE BFRS, 10 LISTING BFRS,NPG FOR SWAP MAP, NPG*PGSIZ FOR 
				SWAP SPACE
	016172'	552400	006605'		HRRZM	W,YEND
	016173'	552400	006606'		HRRZM	W,YEND1
	016174'	402000	002301'		SETZM	LOH		;SET LISTING FILE NOT OPEN
	016175'	336000	000467'		SKIPN	DOTP
	016176'	260040	035373'		PJS	IZY		;INITIALIZE OPCODES
	016177'	260040	016213'		PJS	IZPG
	016200'	200240	016212'		MOVE	U,VER		;NAD VERSION
	016201'	260040	022000'		PJS	TYP6		;OUTPUT VERSION
				;	MOVE NAD VERSION INTO TITLE
	016202'	200440	034117'		MOVE	X,[POINT 6,VER]
	016203'	200500	034120'		MOVE	Y,[POINT 7,STDTTL+1,6]
	016204'	134400	000011		ILDB	W,X
	016205'	271400	000040		ADDI	W,40		;CONVERT FROM SIXBIT TO ASCII
	016206'	136400	000012		IDPB	W,Y
	016207'	603440	770000		TLNE	X,770000
	016210'	254000	016204'		JRST	.-4
	016211'	254000	025663'		JRST	CRIZ

				;	Generate the version as a sixbit string. Set radix to decimal
				;	to get a decimal radix.
					DEFINE	SIXVER(V,R)<SIXBIT /'V'.'R'/>
					RADIX	10
	016212'	211626	000000	VER:	SIXVER(\VERSION,\REVISION)
					RADIX	8

	016213'			IZPG:				;INITIALIZE PAGING AREA
	016213'	402000	035373'		SETZM	MEMBAS		;ZERO PAGING AREA
	016214'	200400	034121'		MOVE	W,[XWD MEMBAS,MEMBAS+1]
	016215'	251400	055372'		BLT	W,EMEM-1
	016216'	211400	000004		MOVNI	W,4
	016217'	200440	034122'		MOVE	X,[ADDI W,MEMBAS]
	016220'	202450	012653'		MOVEM	X,PGT+4(W)	;MARK THE IN CORE PAGES
	016221'	271440	004000		ADDI	X,PGSIZ
	016222'	341400	016220'		AOJL	W,.-2
	016223'	211400	000174		MOVNI	W,NPGD-4
	016224'	200440	034123'		MOVE	X,[PJS SWAP]
	016225'	202450	013047'		MOVEM	X,PGT+NPGD(W)
	016226'	341400	016225'		AOJL	W,.-1		;MARK SWAPPED OUT PAGES
	016227'	263040	000000		RETURN

NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 5
NAD01.R06	24-JUL-87 17:39		GET FILE

					SUBTTL	GET FILE
				;		*********************************************


	016230'	606640	000014	GF:	TRNN	F,LPASS1+LPASS2	;WILL THERE BE A LISTING?
	016231'	254000	016242'		JRST	GF1		;NO
	016232'	200400	034124'		MOVE	W,[DTTLBF,,TTLBF] ;MOVE DEFAULT TITLE TO TITLE BUFFER
	016233'	251400	003033'		BLT	W,TTLBF+TTLSIZ-1
	016234'	260040	022747'		PJS	TTLDAT		;PUT TIME AND DATE IN STANDARD TITLE
	016235'	200400	034125'		MOVE	W,[DSTLBF,,STLBF] ;MOVE DEFAULT SUBTITLE TO SUBTITLE BUFFER
	016236'	251400	003110'		BLT	W,STLBF+STLSIZ-1
	016237'	660640	010240		TRO	F,TTLFND+LSTTTL+FSBTTL
	016240'	606640	020000		TRNN	F,LSTDTL	;SHOULD DEFAULT TITLE BE LISTED?
	016241'	620640	010000		TRZ	F,LSTTTL	;NO. DON'T LIST TITLE
	016242'	400400	000000	GF1:	SETZ	W,		;SYLOCK for non proprietary code
	016243'	602640	400000		TRNE	F,LSLOCK	;Is listing to be locked out?
	016244'	515400	100000		HRLZI	W,SYPROP	;Yes, turn on symbol lock.
	016245'	202400	002331'		MOVEM	W,SYLOCK	;And save for symbol definitions.
	016246'	200400	000551'		MOVE	W,PC
	016247'	200440	000470'		MOVE	X,CURSEG	;RESET SEG BACK TO 0
	016250'	202411	000511'		MOVEM	W,SEGTAB(X)
	016251'	313411	000531'		CAMLE	W,SEGTOP(X)	;IS PC>MAX(PC)
	016252'	202411	000531'		MOVEM	W,SEGTOP(X)	;YES. SET MAX(PC)=PC
	016253'	400440	000000		SETZ	X,
	016254'	200411	000511'		MOVE	W,SEGTAB(X)
	016255'	202400	000551'		MOVEM	W,PC
	016256'	202400	006253'		MOVEM	W,PCORG
	016257'	200400	034126'		MOVE	W,[SEGTAB,,SEGSAV] ;COPY SEGTAB FOR LISTER
	016260'	251400	000510'		BLT	W,SEGSAV+17
	016261'	260040	023762'		PJS	GETGMT		;Get a GMT value to use for assembly..
	016262'	202200	003171'		MOVEM	V,GMTVAL	;..so that CURGMT has same value in both passes
	016263'	200400	006334'		MOVE	W,RADIX		;SAVE RADIX AT START OF ASSEMLBY FOR LISTER
	016264'	202400	006335'		MOVEM	W,ARADIX	;SO THAT LISTER STARTS WITH SAME RADIX
	016265'	200400	006325'		MOVE	W,MM		;SAVE MODULE MASK AT ASSEMBLY START..
	016266'	202400	006331'		MOVEM	W,AMM		;..SO THAT LISTER STARTS WITH SAME MASK.
	016267'	200400	006330'		MOVE	W,MODULE	;SAVE MODULE NUMBER AT ASSEMBLY START..
	016270'	202400	006332'		MOVEM	W,AMODUL	;..SO THAT LISTER STARTS WITH SAME MASK.
	016271'	476000	000777'		SETOM	LSTMSK
	016272'	260040	016455'		PJS	INTASM		;INITIALIZE ASSEMBLE
	016273'	260040	020753'		PJS	SHBEG		;check if shadow is to be constructed
	016274'	606640	000010		TRNN	F,LPASS2	;LISTING IN PASS 2?
	016275'	606640	000004		TRNN	F,LPASS1	;OR NO LISTING IN PASS 1?
	016276'	254000	016305'		JRST	GF2		;YES. JUST ASSEMBLE IN PASS 1
	016277'	200400	002760'		MOVE	W,CHPLN		;USE FULL LINE FOR TEXT
	016300'	202400	002764'		MOVEM	W,TXTSIZ
	016301'	260040	021300'		PJS	OLF		;OPEN LISTING FILE
	016302'	260040	022165'		PJS	LST		;ASSEMBLE W/ LISTING
	016303'	260040	021327'		PJS	CLF		;CLOSE LISTING FILE
	016304'	254000	016306'		JRST	GF3
	016305'	260040	016425'	GF2:	PJS	ASSEM		;GO DO FIRST PASS W/O LISTING
	016306'	260040	021255'	GF3:	PJS	CIF		;CLOSE SOURCE FILE
	016307'	603640	004000		TLNE	F,ABTASM	;was assembly aborted
	016310'	263040	000000		RETURN			;yes. exit
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 5-2
NAD01.R06	24-JUL-87 17:39		GET FILE

	016311'	402000	000777'		SETZM	LSTMSK		;INDICATE PASS 2
	016312'	626640	040000		TRZN	F,MASCAN	;ARE MACRO ARGS STILL BEING SCANNED?
	016313'	254000	016315'		JRST	GF4		;no
	016314'	035000	034127'		TYPE	<$File ended while scanning arguments in macro call. No ) found>
	016315'	626640	100000	GF4:	TRZN	F,MBSCAN	;is macro body still being scanned?
	016316'	254000	016320'		JRST	GF5		;no
	016317'	035000	034144'		TYPE	<$File ended while scanning macro definition. No [ or ] found.>
	016320'	260040	016367'	GF5:	PJS	IFCHK		;CHECK IF "IF" STILL ACTIVE
	016321'	260040	016373'		PJS	RECHK		;CHECK IF "REPEAT" STILL ACTIVE
	016322'	200600	006330'		MOVE	M,MODULE
	016323'	200614	032632'		MOVE	M,LBIT(M)	;REFERENCE LOCAL UNDEFINEDS
	016324'	352000	003175'		AOSE	UNSW
	016325'	260040	025441'		PJS	TU		;TYPE UNDEFINEDS UNLESS UN DIRECTIVE RAN
	016326'	035000	034161'		TYPE	<$End of assembly>
	016327'	606640	000010		TRNN	F,LPASS2	;LISTING IN PASS 2?
	016330'	254000	016362'		JRST	GF30		;NO. GO FINISH ASSEMBLY
	016331'	660640	000200		TRO	F,FSBTTL	;IGNORE FIRST SUBTITLE
	016332'	035000	034165'		TYPE	($Lister working)
	016333'	260040	020762'		PJS	SHMID		;restore pass 1 symbol table from shadow table
	016334'	200400	006253'		MOVE	W,PCORG
	016335'	202400	000551'		MOVEM	W,PC
	016336'	200400	034171'		MOVE	W,[SEGSAV,,SEGTAB] ;RESTORE INITIAL SEGTAB
	016337'	251400	000530'		BLT	W,SEGTAB+17
	016340'	200400	006332'		MOVE	W,AMODUL	;GET MODULE NUMBER AT ASSEMBLY START..
	016341'	202400	006330'		MOVEM	W,MODULE	;..RESET FOR LISTER SCAN.
	016342'	200400	006331'		MOVE	W,AMM		;GET MODULE MASK AT ASSEMBLY START..
	016343'	202400	006325'		MOVEM	W,MM		;..RESET FOR LISTER SCAN.
	016344'	200400	006335'		MOVE	W,ARADIX	;GET RADIX AT ASSEMBLY START
	016345'	202400	006334'		MOVEM	W,RADIX		;AND RESET FOR SECOND FILE SCAN
	016346'	260040	016455'		PJS	INTASM		;INITIALIZE ASSEMBLY
	016347'	402000	000776'		SETZM	LSPACE		;LISTING BUFFERS NEEDED FOR LISTING
	016350'	260040	021205'		PJS	OIF		;OPEN INPUT FILE AND START IO
	016351'	322400	034172'		JUMPE	W,[CPF]		;ABORT IF CAN'T OPEN SECOND TIME
	016352'	260040	021300'		PJS	OLF		;OPEN LISTING FILE
	016353'	200400	002760'		MOVE	W,CHPLN		;GET TOTAL CHAR IN LISTING LINE
	016354'	275400	000030		SUBI	W,HEXSIZ+10	;REDUCE BY HEX AND PC SIZE
	016355'	202400	002764'		MOVEM	W,TXTSIZ	;FOR TOTAL TEXT SIZE
	016356'	260040	022165'		PJS	LST		;GO GET LISTING IN PASS 2
	016357'	260040	021327'		PJS	CLF		;CLOSE LISTING FILE
	016360'	260040	021255'		PJS	CIF		;CLOSE SOURCE FILE
	016361'	260040	021025'		PJS	SHEND		;clear and check shadow table
	016362'	200400	000551'	GF30:	MOVE	W,PC		;GET CURRENT PC
	016363'	200440	000470'		MOVE	X,CURSEG	;REFERENCE CURRENT SEGMENT
	016364'	313411	000531'		CAMLE	W,SEGTOP(X)	;IS PC>MAX(PC)?
	016365'	202411	000531'		MOVEM	W,SEGTOP(X)	;YES. SET MAX(PC)=PC
	016366'	263040	000000		RETURN

	016367'	201600	003176'	IFCHK:	MOVEI	M,IFLINE
	016370'	336000	003202'		SKIPN	IFC		;IF STILL ACTIVE
	016371'	263040	000000		RETURN			;NO
	016372'	254000	016400'		JRST	IRCHK
	016373'	201600	003206'	RECHK:	MOVEI	M,RELINE	;GET POINTER TO STATE INFORMATION
	016374'	332000	003205'		SKIPE	RPF		;REPEAT FAULT FOUND
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 5-3
NAD01.R06	24-JUL-87 17:39		GET FILE

	016375'	254000	016400'		JRST	IRCHK		;YES
	016376'	336000	003211'		SKIPN	RPPTR		;STILL IN ACTIVE REPEAT
	016377'	263040	000000		RETURN			;NO
	016400'	035000	034173'	IRCHK:	TYPE	<$***>
	016401'	200214	000000		MOVE	V,(M)		;GET LINE NUMBER
	016402'	201500	000012		MOVEI	Y,12		;DECIMAL RADIX
	016403'	260040	022015'		PJS	TN
	016404'	336254	000001		SKIPN	U,1(M)		;TYPE OUT LABEL IF THERE WAS ONE
	016405'	254000	016416'		JRST	GF10
	016406'	260040	021763'		PJS	BL3
	016407'	260040	022000'		PJS	TYP6
	016410'	200214	000000		MOVE	V,(M)		;GET ABS LINE #
	016411'	274214	000002		SUB	V,2(M)		;TURN INTO LOCAL LINE #
	016412'	322200	016416'		JUMPE	V,GF10
	016413'	051700	000053		OUTCHI	"+"
	016414'	201500	000012		MOVEI	Y,12
	016415'	260040	022015'		PJS	TN		;TYPE OUT OFFSET FROM LABEL
	016416'	035000	034174'	GF10:	TYPE	<$Unmatched >
	016417'	302600	003176'		CAIE	M,IFLINE
	016420'	254000	016423'		JRST	GF13
	016421'	035000	034177'		TYPE	<IF statement>
	016422'	263040	000000		RETURN
	016423'	035000	034202'	GF13:	TYPE	<REPEAT statement>
	016424'	263040	000000		RETURN

				;	ASSEMBLE FILE WITHOUT LISTING.
	016425'	202040	003247'	ASSEM:	MOVEM	S,GFS		;EOF NEEDS TO KNOW WAY OUT
	016426'	660640	000001		TRO	F,ASONLY	;SET ONLY ASSEMBLING
	016427'	620640	000100		TRZ	F,CREF		;DON'T GET CREF LISTING
	016430'	336000	013056'	ASSEM1:	INCLC
	016431'	350000	006256'
	016432'	402000	013055'	ASSEM5:	SETZM	MACN		;CLEAR MACRO STACK COUNT
	016433'	202100	006255'		MOVEM	I,LINEI		;SAVE START OF LINE FOR ERRORS
	016434'	260040	016473'	ASSEM2:	PJS	GS
	016435'	603640	004100		TLNE	F,ENDFND+ABTASM	;WAS LAST STATEMENT AN "END" or aborted
	016436'	254000	016446'		JRST	ASSEM3		;YES
	016437'	135140	000002		LDB	C,I
	016440'	302140	000015		CAIE	C,15		;WAS THE EOS A <CR>?
	016441'	254000	016451'		JRST	ASSEM4		;NO, IT WAS A ;
	016442'	260040	021753'		PJS	GCHR		;YES, REMOVE THE <LF>
	016443'	332000	006257'		SKIPE	LEC
	016444'	260040	025264'		PJS	TLE
	016445'	254000	016430'		JRST	ASSEM1
	016446'	332000	006257'	ASSEM3:	SKIPE	LEC		;ANY "END" OR EOF ERRORS?
	016447'	260040	025264'		PJS	TLE		;YES
	016450'	263040	000000		RETURN
	016451'	335000	013055'	ASSEM4:	SKIPGE	MACN		;IS MACRO STACK OK
	016452'	332000	006257'		SKIPE	LEC		;OR ARE THERE NO PENDING ERRORS
	016453'	254000	016434'		JRST	ASSEM2		;YES. CONTINUE WITH ASSEMBLY
	016454'	254000	016432'		JRST	ASSEM5		;NO. CLEAR OLD LINE SAVE

				;	INITIALIZE FOR PASS 1 OR PASS 2
	016455'	541400	017066'	INTASM:	HRRI	W,GE1U
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 5-4
NAD01.R06	24-JUL-87 17:39		GET FILE

	016456'	552400	006577'		HRRZM	W,GECALL	;ALLOW SOME UNDEFINED SYMBOLS
	016457'	402000	003205'		SETZM	RPF
	016460'	402000	003211'		SETZM	RPPTR
	016461'	402000	003202'		SETZM	IFC
	016462'	402000	003203'		SETZM	IFT
	016463'	402000	006256'		SETZM	LC
	016464'	402000	006257'		SETZM	LEC
	016465'	402000	000464'		SETZM	LLABEL
	016466'	402000	003175'		SETZM	UNSW
	016467'	402000	000470'		SETZM	CURSEG		;START IN SEGMENT 0
	016470'	621640	405352		TLZ	F,VBSEEN+EXPRIP+LSCEOL+ENDRPT+NOLIST+UTRUIF+ENDFND+ABTASM
	016471'	620640	140000		TRZ	F,MASCAN+MBSCAN
	016472'	263040	000000		RETURN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 6
NAD01.R06	24-JUL-87 17:39		GET STATEMENT

					SUBTTL	GET STATEMENT
				;		*********************************************


	016473'	202040	003247'	GS:	MOVEM	S,GFS		;EOF NEEDS TO KNOW WAY OUT
	016474'	202040	006321'		MOVEM	S,GSSTK		;save stack pointer in case of abort
	016475'	200400	006334'		MOVE	W,RADIX
	016476'	202400	006333'		MOVEM	W,TRADIX
	016477'	402000	003157'		SETZM	GESF
	016500'	200400	006325'		MOVE	W,MM
	016501'	661400	500000		TLO	W,500000
	016502'	202400	006326'		MOVEM	W,MM1
	016503'	402000	003167'		SETZM	GSEC
	016504'	621640	000020		TLZ	F,NOMACX	;PREPARE TO SET NO MACRO EXPANSION FLAG
	016505'	603640	400000		TLNE	F,UTRUIF	;IN UNTRUE "IF"?
	016506'	661640	000020		TLO	F,NOMACX	;UNTRUE "IF". SUPPRESS MACRO EXPANSIONS
	016507'	260040	017525'		PJS	GK
				;			BLA  NUM SYM USYM OPR DLIM ILL
	016510'	254005	016511'		JV	<.+1(U),GS2,GS2E,GSL,GSL,GS1E,GSD,GS1E>
	016511'	254000	016555'
	016512'	254000	016521'
	016513'	254000	016540'
	016514'	254000	016540'
	016515'	254000	016520'
	016516'	254000	016522'
	016517'	254000	016520'

	016520'	031000	034206'	GS1E:	PE	MSFCI,GSF	;OTHERWISE CHR IS ILLEGAL
	016521'	031000	034207'	GS2E:	PE	MSFCI,GSFX	;NUMBER IN LABEL POSITION

	016522'	544400	000003	GSD:	HLR	W,C
	016523'	256010	016524'		XCT	.+1(W)

	016524'	260040	025257'		CPF		;BLANK	;REPORT ASSEMBLER INTERNAL ERROR
	016525'	260040	025257'		CPF		;TAB	;REPORT ASSEMBLER INTERNAL ERROR
				;		  ,     $   (   )    =    [    ]    :   ;  <CR>
				;						      <LF> <FF>
	016526'	254000	016520'		JV	<GS1E,GSF,GS1E,GS1E,GS1E,GS1E,GS1E,GSF,GSF,GSF>
	016527'	254000	016627'
	016530'	254000	016520'
	016531'	254000	016520'
	016532'	254000	016520'
	016533'	254000	016520'
	016534'	254000	016520'
	016535'	254000	016627'
	016536'	254000	016627'
	016537'	254000	016627'

	016540'			GSL:				;LABEL
	016540'	544440	000003		HLR	X,C
	016541'	200451	032676'		MOVE	X,RBIT(X)
	016542'	620440	006003		TRZ	X,1_BLA+1_TAB+1_SEMIC+1_CAR
	016543'	435443	777767		IORI	X,-DE(C)
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 6-2
NAD01.R06	24-JUL-87 17:39		GET STATEMENT

	016544'	322440	016546'		JUMPE	X,.+2
	016545'	031000	034210'		PE	MSILT,GSFX	;LABEL DIDNT TERMINATE WITH A LEGAL DELIMITER
	016546'	200400	000551'		MOVE	W,PC
	016547'	202400	000463'		MOVEM	W,LABELP	;SAVE LABEL PC FOR GSF OR PEQ
	016550'	200440	006256'		MOVE	X,LC
	016551'	202440	000465'		MOVEM	X,LLC
	016552'	202540	000464'		MOVEM	L,LLABEL
	016553'	607640	400000		TLNN	F,UTRUIF	;IF UNTRUE "IF"
	016554'	202540	000462'		MOVEM	L,LABEL		; THEN DON'T DEFINE LABEL.

	016555'			GS2:;	GET STATEMENT AFTER LABEL FIELD
	016555'	515400	500000		HRLZI	W,500000
	016556'	202400	006326'		MOVEM	W,MM1		;LIMIT SEARCH TO OPCODES
	016557'	260040	017525'		PJS	GK
	016560'	256005	016561'		XCT	.+1(U)

	016561'	254000	016555'		JRST	GS2		;BLANK, TAB
	016562'	031000	034211'		PE	MSIOC,GSFX	;NUMBER
	016563'	254000	016575'		JRST	GS2A		;SYMBOL
	016564'	031000	034212'		PE	MSUOC,GSFX	;UNDEFINED SYMBOL
	016565'	031000	034213'		PE	MSIOC,GSF	;OPERATOR
	016566'	254000	016570'		JRST	GS2D		;DELIMETER
	016567'	031000	034213'		PE	MSIOC,GSF	;ILLEGAL CHARACTER

	016570'	544400	000003	GS2D:	HLR	W,C
	016571'	200410	032676'		MOVE	W,RBIT(W)
	016572'	602400	007000		TRNE	W,1_SEMIC+1_CAR+1_COLON
	016573'	254000	016627'		JRST	GSF
	016574'	031000	034213'		PE	MSIOC,GSF

	016575'	200400	006325'	GS2A:	MOVE	W,MM
	016576'	202400	006326'		MOVEM	W,MM1
	016577'	135400	034214'		LDB	W,[POINT 6,(M),11]
	016600'	200410	017010'		MOVE	W,PC9V(W)
	016601'	202400	000556'		MOVEM	W,PCV2
	016602'	556200	003160'		HLRZM	V,OPCODE
	016603'	200400	000551'		MOVE	W,PC
	016604'	202420	000467'		MOVEM	W,@DOTP
	016605'	603640	400000		TLNE	F,UTRUIF
	016606'	254000	016613'		JRST	GS2C		;ASSEMBLING AN UNTRUE IF BLOCK
	016607'	332000	000556'	GS2B:	SKIPE	PCV2
	016610'	202400	006254'		MOVEM	W,PCL
	016611'	260044	000000		PJS	(V)
	016612'	254000	016627'		JRST	GSF

	016613'	550440	000004	GS2C:	HRRZ	X,V
	016614'	306440	024131'		CAIN	X,DIF
	016615'	254000	016625'		JRST	GS2F
	016616'	306440	024165'		CAIN	X,DELSE
	016617'	254000	016625'		JRST	GS2F
	016620'	306440	024210'		CAIN	X,DEI
	016621'	254000	016625'		JRST	GS2F
	016622'	306440	023674'		CAIN	X,DEN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 6-3
NAD01.R06	24-JUL-87 17:39		GET STATEMENT

	016623'	254000	016625'		JRST	GS2F
	016624'	254000	016644'		JRST	GST		;ASSEMBLY UNTRUE AND NOT AN IF, EI, OR END STATEMENT
	016625'	621640	000020	GS2F:	TLZ	F,NOMACX	;FORCE MACRO EXPANSIONS EVEN IF UNTRUE IF
	016626'	254000	016607'		JRST	GS2B

				;	STATEMENT FLUSH. FINISH UP STATEMENT PROCESSING AND FLUSH TO EOS.
	016627'	270100	006336'	GSF:	ADD	I,BACKUP	;CAUSE RESCAN OF TERMINATOR. MAY BE CR
	016630'	336400	003156'	GSFX:	SKIPN	W,UCC
	016631'	254000	016634'		JRST	.+3
	016632'	260040	017517'		PJS	GERC
	016633'	402000	003156'		SETZM	UCC
	016634'	336540	000462'		SKIPN	L,LABEL
	016635'	254000	016644'		JRST	GST		;IS THERE A LABEL NOT YET DEFINED
	016636'	402000	000462'		SETZM	LABEL
	016637'	200300	000463'		MOVE	VS,LABELP
	016640'	200240	006325'		MOVE	U,MM
	016641'	202240	006326'		MOVEM	U,MM1
	016642'	514240	006330'		HRLZ	U,MODULE
	016643'	260040	020401'		PJS	DY
				;	JRST	GST		;SCAN TO END OF STATEMENT AND RETURN TO GS CALLER
	016644'	134140	000002	GST:	ILDB	C,I
	016645'	200143	032742'		MOVE	C,CT(C)		;Lookup character type
	016646'	256003	016650'	GSTS:	XCT	GSTX(C)		;Dispatch on character type
	016647'	256003	016667'		XCT	GSTXD(C)	;Dispatch on character type

	016650'	030000	016644'	GSTX:	CIT	GST		;LOOK FOR MORE INPUT
					REPEAT	DE-1,<JRST GST>
	016651'	254000	016644'
	016652'	254000	016644'
	016653'	254000	016644'
	016654'	254000	016644'
	016655'	254000	016644'
	016656'	254000	016644'
	016657'	254000	016644'
	016660'	254000	016644'
	016661'	544140	000003		HLR	C,C		;DELIMITER
	016662'	254000	016644'		JRST	GST		;VERTICAL BAR
	016663'	032000	016644'		MEND	GST		;MACRO END
	016664'	254000	016644'		JRST	GST		;' (CONCATENATION)
	016665'	033000	016644'		MARG	GST		;MACRO ARGUMENT
	016666'	034000	016644'		MAE	GST		;MACRO ARG END
	016667'			GSTXD:	REPEAT	SEMIC,<	JRST	GST>
	016667'	254000	016644'
	016670'	254000	016644'
	016671'	254000	016644'
	016672'	254000	016644'
	016673'	254000	016644'
	016674'	254000	016644'
	016675'	254000	016644'
	016676'	254000	016644'
	016677'	254000	016644'
	016700'	254000	016644'
	016701'	263040	000000		RETURN			; <LF> ;
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 6-4
NAD01.R06	24-JUL-87 17:39		GET STATEMENT

	016702'	263040	000000		RETURN			; <FF> <CR>

				;	ADVANCE PC AND CHECK FOR REUSED MEMORY
	016703'	260040	017050'	PC2:	PJS	ALIGN2
	016704'	271400	000002		ADDI	W,2
	016705'	250400	000551'		EXCH	W,PC
	016706'	260040	025620'		CA	H
	016707'	135000	000010		LDB	0,W
	016710'	202400	000552'		MOVEM	W,PCP
	016711'	404000	000777'		AND	0,LSTMSK
	016712'	322000	000556'		JUMPE	0,PCV2
	016713'	254000	016732'		JRST	PCER

	016714'	260040	017050'	PC22:	PJS	ALIGN2
	016715'	271400	000004		ADDI	W,4
	016716'	250400	000551'		EXCH	W,PC
	016717'	260040	025620'		CA	H
	016720'	202400	000552'		MOVEM	W,PCP
	016721'	135500	000010		LDB	Y,W
	016722'	200400	000551'		MOVE	W,PC
	016723'	275400	000002		SUBI	W,2
	016724'	260040	025620'		CA	H
	016725'	202400	000553'		MOVEM	W,PCP1
	016726'	135000	000010		LDB	0,W
	016727'	434000	000012		IOR	0,Y
	016730'	404000	000777'		AND	0,LSTMSK
	016731'	322000	000556'		JUMPE	0,PCV2
	016732'	332000	001000'	PCER:	SKIPE	DSW
	016733'	254000	000556'		JRST	PCV2
	016734'	031000	034215'		PE	MSAIUM,ABORT

	016735'	260040	017050'	PC222:	PJS	ALIGN2
	016736'	271400	000006		ADDI	W,6
	016737'	250400	000551'		EXCH	W,PC
	016740'	260040	025620'		CA	H
	016741'	202400	000552'		MOVEM	W,PCP
	016742'	135300	000010		LDB	VS,W
	016743'	200400	000551'		MOVE	W,PC
	016744'	275400	000004		SUBI	W,4
	016745'	260040	025620'		CA	H
	016746'	202400	000553'		MOVEM	W,PCP1
	016747'	135340	000010		LDB	OS,W
	016750'	200400	000551'		MOVE	W,PC
	016751'	275400	000002		SUBI	W,2
	016752'	260040	025620'		CA	H
	016753'	202400	000554'		MOVEM	W,PCP2
	016754'	135000	000010		LDB	0,W
	016755'	434000	000007		IOR	0,OS
	016756'	434000	000006		IOR	0,VS
	016757'	404000	000777'		AND	0,LSTMSK
	016760'	322000	000556'		JUMPE	0,PCV2
	016761'	254000	016732'		JRST	PCER

NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 6-5
NAD01.R06	24-JUL-87 17:39		GET STATEMENT

	016762'	254000	000556'	PC0:	JRST	PCV2

	016763'	260040	017050'	PC02:	PJS	ALIGN2
	016764'	254000	000556'		JRST	PCV2

	016765'	260040	017056'	PC04:	PJS	ALIGN4
	016766'	254000	000556'		JRST	PCV2

	016767'	200040	006321'	ABORT:	MOVE	S,GSSTK		;restore stack pointer
	016770'	661640	004000		TLO	F,ABTASM	;report assembly abort
	016771'	263040	000000		RETURN

	016772'	035000	034216'	NADAB:	TYPE	<$Type "CONTINUE" to save new NIB or listing file>
	016773'	047040	000012		EXIT	1,

	016774'	260040	021541'	NADEX:	PJS	UBID		;UPDATE NIB ID BLOCK
	016775'	402000	002745'		SETZM	IBRIXP		;set no nib block to update
	016776'	476000	002747'		SETOM	BFSW		;set no NIB file
	016777'	071540	000000		RELEASE	BCH,		;DON'T ZAP NIB FILE
	017000'	071500	000000		RELEAS	JCH,		;AVOID ZAPPING TMP FILE
	017001'	620700	000002		TRZ	F2,MLTLST
	017002'	260040	021327'		PJS	CLF		;DON'T ZAP LISTING FILE
	017003'	260040	022147'		PJS	CFACLS		;Close all command files
	017004'	047000	000000		RESET
	017005'	561400	777777		HRROI	W,-1
	017006'	047400	777733		ZAPCIR	W,
	017007'	047000	000012		EXIT

					DEFINE	PC9M (PC9ARG),<PC9CT==1
					IRP	PC9ARG,<PC9ARG'V==PC9CT
					PC9CT==PC9CT+1
					JRST	PC9ARG>>
	017010'	000000	000000	PC9V:	0
					PC9M	<RR,RR1,LPSR,RI,RI2,BF,BF1,RX,RX0,DBS,DHS,DWS,DBC,DHC,DWC,DAC,DSC,DXC,DEN,DORG,
	017011'	254000	024710'	DBND,DSEG>
	017012'	254000	024714'
	017013'	254000	024701'
	017014'	254000	025115'
	017015'	254000	025140'
	017016'	254000	024723'
	017017'	254000	024726'
	017020'	254000	024766'
	017021'	254000	024765'
	017022'	254000	024263'
	017023'	254000	024275'
	017024'	254000	024303'
	017025'	254000	024311'
	017026'	254000	024325'
	017027'	254000	024355'
	017030'	254000	024445'
	017031'	254000	024442'
	017032'	254000	024415'
	017033'	254000	023674'
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 6-6
NAD01.R06	24-JUL-87 17:39		GET STATEMENT

	017034'	254000	024232'
	017035'	254000	024217'
	017036'	254000	023657'
					PURGE	PC9M

	017037'	254000	026403'	PC9D:	JV	<XIRR,XIRR,XIRR,XIRI1,XIRI2,XIBF,XIBF,XIRX,XIRX>	;DISASSEMBLY TABLE
	017040'	254000	026403'
	017041'	254000	026403'
	017042'	254000	026352'
	017043'	254000	026373'
	017044'	254000	026333'
	017045'	254000	026333'
	017046'	254000	026343'
	017047'	254000	026343'
	017050'			EPC9D:

	017050'	606400	000001	ALIGN2:	TRNN	W,1
	017051'	263040	000000		RETURN
	017052'	350000	006254'		AOS	PCL
	017053'	350000	000463'		AOS	LABELP
	017054'	350400	000551'		AOS	W,PC
	017055'	263040	000000		RETURN

	017056'	606400	000003	ALIGN4:	TRNN	W,3
	017057'	263040	000000		RETURN
	017060'	271400	000003		ADDI	W,3
	017061'	620400	000003		TRZ	W,3
	017062'	202400	006254'		MOVEM	W,PCL
	017063'	202400	000463'		MOVEM	W,LABELP
	017064'	202400	000551'		MOVEM	W,PC
	017065'	263040	000000		RETURN

NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 7
NAD01.R06	24-JUL-87 17:39		GET EXPRESSION

					SUBTTL	GET EXPRESSION
				;		**************************************************


				;	GET EXPRESSION TO V. U =0 NORMALLY, 1 IF NUL EXP, 2 IF ONE
				;		UNDEFINED SYMBOL FOUND AND GE1U CALLED. AND U =3 IF ILLEGAL EXP

	017066'	476000	006320'	GE1U:	SETOM	GEUOK		;REACH GE THRU HERE TO ALLOW ONE UNDEFINED IN EXPRESSION
	017067'	402000	003156'		SETZM	UCC
	017070'	254000	017072'		JRST	GEGO
	017071'	402000	006320'	GE:	SETZM	GEUOK
	017072'	661640	000010	GEGO:	TLO	F,EXPRIP	;FLAG EXPR EVALUATION IN PROGRESS
	017073'	200400	000410'		MOVE	W,IBSLP		;initialize backslash pointer
	017074'	202400	000411'		MOVEM	W,BSLP
	017075'	402000	003245'		SETZM	LTT
	017076'	403300	000007		SETZB	VS,OS		;INITIALIZE VALUE AND OPERATOR STACKS
	017077'	260040	017525'	GEA:	PJS	GK
	017100'	200400	000005		MOVE	W,U		;CURRENT TOKEN TYPE
	017101'	250400	003245'		EXCH	W,LTT
	017102'	256005	017103'		XCT	.+1(U)

	017103'	254010	017112'		JV	<GE0(W),GE1(W),GE2(W),GE3(W),GE4(W),GED>
	017104'	254010	017120'
	017105'	254010	017126'
	017106'	254010	017134'
	017107'	254010	017142'
	017110'	254000	017221'
	017111'	031000	034230'		PE	MSIC,GEF
	017112'	254000	017077'	GE0:	JV	<GEA,GED,GED,GED,GESE0,GESE0>
	017113'	254000	017221'
	017114'	254000	017221'
	017115'	254000	017221'
	017116'	254000	017151'
	017117'	254000	017151'
	017120'	254000	017216'	GE1:	JV	<GEPV,GESE0,GESE0,GESE0,GEPV,GEPV>
	017121'	254000	017151'
	017122'	254000	017151'
	017123'	254000	017151'
	017124'	254000	017216'
	017125'	254000	017216'
	017126'	254000	017212'	GE2:	JV	<GEPV0,GESE0,GESE0,GESE0,GEPV0,GEPV0>
	017127'	254000	017151'
	017130'	254000	017151'
	017131'	254000	017151'
	017132'	254000	017212'
	017133'	254000	017212'
	017134'	254000	017175'	GE3:	JV	<GEPVU0,GESE0,GESE0,GESE0,GEPVU0,GEPVU0>
	017135'	254000	017151'
	017136'	254000	017151'
	017137'	254000	017151'
	017140'	254000	017175'
	017141'	254000	017175'
	017142'	254000	017152'	GE4:	JV	<GEOPU,GEOPNU,GEOPNU,GEOPNU,GEOPU,GEOPU>
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 7-2
NAD01.R06	24-JUL-87 17:39		GET EXPRESSION

	017143'	254000	017166'
	017144'	254000	017166'
	017145'	254000	017166'
	017146'	254000	017152'
	017147'	254000	017152'

	017150'	031000	034231'	GESE:	PE	MSSE,GEF
	017151'	031000	034232'	GESE0:	PE	MSSE,GEF0

	017152'	554200	000003	GEOPU:	HLRZ	V,C
	017153'	306200	000001		CAIN	V,UBSLH		;backslash operator?
	017154'	254000	017163'		JRST	GEOP2		;yes. go set backslash stack
	017155'	305200	000004		CAIGE	V,NU
	017156'	254000	017173'		JRST	GEOP1
	017157'	551204	777776		HRRZI	V,-NB(V)
	017160'	305200	000004		CAIGE	V,NU
	017161'	254000	017173'		JRST	GEOP1
	017162'	031000	034233'		PE	MSONU,GEF
	017163'	350000	000411'	GEOP2:	AOS	BSLP		;point to next stack entry
	017164'	476020	000411'		SETOM	@BSLP		;signify in backslash operation
	017165'	254000	017173'		JRST	GEOP1		;go stack operator

	017166'			GEOPNU:				;OPERATOR NOT UNARY
	017166'	554440	000003		HLRZ	X,C
	017167'	305440	000004		CAIGE	X,NU
	017170'	031000	034234'		PE	MSMUO,GEF
	017171'	200200	000011		MOVE	V,X
	017172'	260040	017341'		PJS	GEES
	017173'	202220	000235'	GEOP1:	MOVEM	V,@OPS		;PUSH OPERATOR INTO OPERATOR STACK
	017174'	344340	017077'		AOJA	OS,GEA

	017175'	606640	000100	GEPVU0:	TRNN	F,CREF		;SHOULD CREF BE OUTPUT?
	017176'	254000	017201'		JRST	GEPVU		;NO
	017177'	201400	000001		MOVEI	W,1		;OUTPUT SYMBOL REFERENCE
	017200'	260040	023050'		PJS	OUTSYM

	017201'			GEPVU:;	PUSH UNDEFINED VALUE
	017201'	332020	000411'		SKIPE	@BSLP		;in backslash operation?
	017202'	254000	017205'		JRST	GEPVU1		;yes. allow all undefined symbols
	017203'	352000	006320'		AOSE	GEUOK		;SEE IF UNDEFINED ALLOWED IN THIS EXPRESSION
	017204'	031000	034235'		PE	MSUS,GEPVU2	;replace undefined with zero
	017205'	402020	000236'	GEPVU1:	SETZM	@VALS		;UNDEFINED VALUE IS 0 IF NO SYMBOL TABLE CHAIN
	017206'	476020	000237'		SETOM	@VALSF		;MARK THIS VALUE AS UNDEFINED
	017207'	344300	017077'		AOJA	VS,GEA
	017210'	400200	000000	GEPVU2:	SETZ	V,		;value zero
	017211'	254000	017216'		JRST	GEPV		;go define

	017212'	606640	000100	GEPV0:	TRNN	F,CREF		;CREF LISTING?
	017213'	254000	017216'		JRST	GEPV		;NO
	017214'	201400	000001		MOVEI	W,1		;OUTPUT SYMBOL REFERENCE
	017215'	260040	023050'		PJS	OUTSYM

	017216'	202220	000236'	GEPV:	MOVEM	V,@VALS		;PUSH VALUE ONTO STACK
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 7-3
NAD01.R06	24-JUL-87 17:39		GET EXPRESSION

	017217'	402020	000237'		SETZM	@VALSF		;MARK VALUE AS DEFINED
	017220'	344300	017077'		AOJA	VS,GEA

	017221'			GED:
	017221'	544440	000003		HLR	X,C
					JV	<.+1(X),GEDT0,GEDT0,GEDT,GEDDOL,GEDLP,GEDRP,GEEQS,GEDT,GEDT,GEDT,GEDT,GEDT,GEDT
	017222'	254011	017223'	>
	017223'	254000	017240'
	017224'	254000	017240'
	017225'	254000	017241'
	017226'	254000	017306'
	017227'	254000	017262'
	017230'	254000	017274'
	017231'	254000	017335'
	017232'	254000	017241'
	017233'	254000	017241'
	017234'	254000	017241'
	017235'	254000	017241'
	017236'	254000	017241'
	017237'	254000	017241'

	017240'	133000	000002	GEDT0:	IBP	I		;POINT AT BLANK STRING TERMINATOR
	017241'	201200	000017	GEDT:	MOVEI	V,OT		;SET OPERATOR TERMINATOR TO GRIND OUT THE STACK
	017242'	260040	017341'		PJS	GEES		;EVALUATE STACK
	017243'	326340	034237'		JUMPN	OS,[PE MSEI,GEF]	;STACK NOT COMPLETELY EVALUATED
	017244'	621640	000010		TLZ	F,EXPRIP	;TURN OFF FLAG, WE'RE DONE ONE WAY OR ANOTHER
	017245'	201240	000002		MOVEI	U,2		;U=2 IF LEGAL UNDEFINED EXPRESSION
	017246'	333000	006320'		SKIPLE	GEUOK		;were there too many undefines?
	017247'	254000	017260'		JRST	GEDT1		;go exit with value zero
	017250'	336200	000006		SKIPN	V,VS		;NUL EXPRESSION IF VALUE STACK EMPTY
	017251'	364240	034240'		SOJA	U,[RETURN]	;NUL EXPESSION, SET V=0, U=1
	017252'	372000	000006		SOSE	VS		;IF VS NOT = 1, THEN STACK NOT PROPERLY EVALUATED.
	017253'	031000	034241'		PE	MSESE,[RETURN]	;DID NOT END UP WITH EXACTLY ONE VALUE
	017254'	200220	000236'		MOVE	V,@VALS		;PICK UP LAST STACK VALUE
					AND	U,@VALSF		;LAST VAL STACK FLAG IS -1 IF AN UNDEFINED, OTHERWISE 0
	017255'	404260	000237'
	017256'	420220	000237'		ANDCM	V,@VALSF
	017257'	263040	000000		RETURN
	017260'	400200	000000	GEDT1:	SETZ	V,		;return value zero
	017261'	263040	000000		RETURN

	017262'	201200	000004	GEDLP:	MOVEI	V,4
	017263'	202200	003245'		MOVEM	V,LTT		;TREAT RIGHT PAREN LIKE AN OPERATOR.
	017264'	201200	000015		MOVEI	V,OLPAR		;LEFT PAREN LEGAL IF LAST TOKEN WAS 0 OR 4.
	017265'	254010	017266'		JV	<.+1(W),GEOP1,GESE,GESE,GESE,GEOP1,GESE>
	017266'	254000	017173'
	017267'	254000	017150'
	017270'	254000	017150'
	017271'	254000	017150'
	017272'	254000	017173'
	017273'	254000	017150'

	017274'	201200	000016	GEDRP:	MOVEI	V,ORPAR		;RIGHT PAREN LEGAL IF LAST TOKEN WAS 1,2, OR 3.
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 7-4
NAD01.R06	24-JUL-87 17:39		GET EXPRESSION

	017275'	202400	003245'		MOVEM	W,LTT		;KEEP OLD LTT. RPARENS ARE NOT PUSHED ONTO STACK.
	017276'	256010	017300'		XCT	GEDRPX(W)
	017277'	254000	017077'		JRST	GEA
	017300'	254000	017150'	GEDRPX:	JRST	GESE
					REPEAT	3,<PJS GEES>
	017301'	260040	017341'
	017302'	260040	017341'
	017303'	260040	017341'
	017304'	254000	017150'		JV	<GESE,GESE>
	017305'	254000	017150'

	017306'	250400	003245'	GEDDOL:	EXCH	W,LTT
				;				DONT UPDATE LAST TOKEN TYPE SINCE RADIX
				;				SETTER IS NOT PART OF THE EXPRESSION
	017307'	134200	000002	GEDOL1:	ILDB	V,I
	017310'	200144	032742'		MOVE	C,CT(V)		;Lookup character type
	017311'	256003	017316'		XCT	GEDX1(C)	;Dispatch on character type
	017312'	326200	017314'		JUMPN	V,.+2
	017313'	201200	000020		MOVEI	V,20
	017314'	202200	006333'		MOVEM	V,TRADIX
	017315'	254000	017077'		JRST	GEA

	017316'	030000	017307'	GEDX1:	CIT	GEDOL1		;LOOK FOR MORE INPUT
	017317'	031000	034242'		PE	MSRV,GEF
	017320'	275200	000060		SUBI	V,60
	017321'	275200	000067		SUBI	V,67
	017322'	275200	000127		SUBI	V,127
					REPEAT	6,<PE	MSRV,GEF>
	017323'	031000	034242'
	017324'	031000	034242'
	017325'	031000	034242'
	017326'	031000	034242'
	017327'	031000	034242'
	017330'	031000	034242'
	017331'	032000	017307'		MEND	GEDOL1
	017332'	031000	034242'		PE	MSRV,GEF
	017333'	033000	017307'		MARG	GEDOL1
	017334'	034000	017307'		MAE	GEDOL1

	017335'	332240	003245'	GEEQS:	SKIPE	U,LTT		;IS THIS THE FIRST CHR OF EXPRESSION
	017336'	031000	034243'		PE	MSIL,GEF	;ILLEGAL LITERAL
	017337'	621640	000010		TLZ	F,EXPRIP
	017340'	344240	034240'		AOJA	U,[RETURN]	;U=1 FOR NUL EXPRESSION

	017341'			GEES:				;V IS THE STACK OPERATOR
	017341'	322340	034240'		JUMPE	OS,[RETURN]	;NO OPERATORS ON THE STACK. NOTHING TO EVALUATE
	017342'	361340	017404'		SOJL	OS,GEESE	;DECREMENT STACK POINTER
	017343'	200620	000235'		MOVE	M,@OPS		;LOAD LAST OPERATOR
	017344'	302600	000015		CAIE	M,OLPAR		;WAS IT A LEFT PAREN
	017345'	254000	017351'		JRST	GES1		;NO, DONT WORRY ABOUT PAREN RULES
	017346'	302200	000016		CAIE	V,ORPAR		;IS CURRENT OPERATOR A RIGHT PAREN
	017347'	271340	000001		ADDI	OS,1		;NO, DON'T REMOVE LEFT PAREN
	017350'	263040	000000		RETURN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 7-5
NAD01.R06	24-JUL-87 17:39		GET EXPRESSION

	017351'	271340	000001	GES1:	ADDI	OS,1		;RESTORE STACK POINTER
	017352'	200004	000000'		MOVE	0,PREC(V)
	017353'	313014	000000'		CAMLE	0,PREC(M)
	017354'	263040	000000		RETURN			;DONT EVALUATE STACK UNTIL LOWER PRECEDENCE
	017355'	361300	017404'		SOJL	VS,GEESE	;DECREMENT STACKS TO SIMULATE POP
	017356'	361340	017404'		SOJL	OS,GEESE
	017357'	200520	000236'		MOVE	Y,@VALS		;RIGHT HAND VALUE TO Y
	017360'	200420	000237'		MOVE	W,@VALSF	;-1 IF UNDEFINED VALUE IN Y
	017361'	301600	000004		CAIL	M,NU
	017362'	361300	017404'		SOJL	VS,GEESE	;BINARY OPERATOR. REMOVE LEFT HAND VALUE
	017363'	200460	000236'		MOVE	X,@VALS		;LEFT HAND VALUE
	017364'	332020	000411'		SKIPE	@BSLP		;backslash operation?
	017365'	254000	017375'		JRST	GEBSL1		;yes. don't evaluate expression
	017366'	326400	017410'		JUMPN	W,GESUR		;RIGHT HAND VALUE UNDEFINED
	017367'	332020	000237'		SKIPE	@VALSF
	017370'	254000	017406'		JRST	GESUL		;LEFT HAND VALUE UNDEFINED

	017371'	256014	017474'		XCT	GESX(M)		;EVALUATE DEFINED VALUES (UNARY OR BINARY)
	017372'	202460	000236'	GES2:	MOVEM	X,@VALS		;PUT COMBINED VALUE BACK INTO STACK
	017373'	402020	000237'		SETZM	@VALSF
	017374'	344300	017341'		AOJA	VS,GEES

	017375'	302600	000001	GEBSL1:	CAIE	M,UBSLH		;is this the actual backslash operator?
	017376'	254000	017402'		JRST	GEBSL2		;no. just preserve definedness.
	017377'	551450	000001		HRRZI	X,1(W)		;value is 1 if defined, 0 otherwise
	017400'	370000	000411'		SOS	BSLP		;pop backslash stack
	017401'	254000	017372'		JRST	GES2		;and go stack vaaclue
	017402'	436420	000237'	GEBSL2:	IORM	W,@VALSF	;if one arg undefined, expr is undefined
	017403'	344300	017341'		AOJA	VS,GEES

	017404'	262040	000006	GEESE:	POP	S,VS		;ERROR, ABORT
	017405'	031000	034231'		PE	MSSE,GEF

	017406'	435600	000040	GESUL:	IORI	M,40		;MARK LEFT AND RIGHT VALUES SWITCHED
	017407'	250440	000012		EXCH	X,Y
	017410'	336420	006600'	GESUR:	GFL	
	017411'	260040	020656'
	017412'	250400	006600'			;X IS DEFINED, Y IS UNDEFINED, M IS OP.
	017413'	322500	017416'		JUMPE	Y,.+3		;NO CHAIN YET
	017414'	552412	000002		HRRZM	W,2(Y)		;CHAIN TO PREVIOUS ENTRY
	017415'	254000	017417'		JRST	.+2
	017416'	504500	000010		HRL	Y,W
					HRR	Y,W		;Y CONTAINS [XWD <BEGINNING CHAIN POINTER>,<END CHAIN POINTER>]
	017417'	540500	000010
	017420'	542612	000000		HRRM	M,(Y)
	017421'	202452	000001		MOVEM	X,1(Y)
	017422'	402012	000002		SETZM	2(Y)
	017423'	202520	000236'		MOVEM	Y,@VALS
	017424'	202500	003156'		MOVEM	Y,UCC		;UNDEFINED CHAIN POINTER
	017425'	476020	000237'		SETOM	@VALSF	;MARK THIS VALUE AS UNDEFINED
	017426'	344300	017341'		AOJA	VS,GEES

	017427'	134140	000002	GEF0:	ILDB	C,I
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 7-6
NAD01.R06	24-JUL-87 17:39		GET EXPRESSION

	017430'	200143	032742'		MOVE	C,CT(C)		;Lookup character type
	017431'	544400	000003	GEF:	HLR	W,C		;SOMETHING BAD HAPPENED - FLUSH REST OF EXPR
	017432'	256003	017433'		XCT	.+1(C)		;Dispatch on character type
	017433'	030000	017427'		CIT	GEF0		;LOOK FOR MORE INPUT
	017434'	254000	017427'		JV	<GEF0,GEF0,GEF0,GEF0,GEF0,GEF0,GEF0,GEFT(W),GEF9,GEF0>
	017435'	254000	017427'
	017436'	254000	017427'
	017437'	254000	017427'
	017440'	254000	017427'
	017441'	254000	017427'
	017442'	254000	017427'
	017443'	254010	017452'
	017444'	254000	017466'
	017445'	254000	017427'
	017446'	032000	017427'		MEND	GEF0
	017447'	254000	017427'		JRST	GEF0
	017450'	033000	017427'		MARG	GEF0
	017451'	034000	017427'		MAE	GEF0
	017452'	254000	017466'	GEFT:	JV	<GEF9,GEF9,GEF9,GEF9,GEF0,GEF0,GEF0,GEF0,GEF9,GEF9,GEF9,GEF9>
	017453'	254000	017466'
	017454'	254000	017466'
	017455'	254000	017466'
	017456'	254000	017427'
	017457'	254000	017427'
	017460'	254000	017427'
	017461'	254000	017427'
	017462'	254000	017466'
	017463'	254000	017466'
	017464'	254000	017466'
	017465'	254000	017466'
	017466'	621640	000010	GEF9:	TLZ	F,EXPRIP	;TURN OFF EXPR IN PROGRESS FLAG
	017467'	201240	000003		MOVEI	U,3		;GE ERROR RETURN
	017470'	400400	000000		SETZ	W,
	017471'	250400	003156'		EXCH	W,UCC
	017472'	326400	017517'		JUMPN	W,GERC		;RETURN UNDEFINED CHAIN STORAGE AND EXIT GE
	017473'	263040	000000		RETURN

	017474'	460440	000012	GESX:	SETCM	X,Y
	017475'	260040	025257'		CPF			;backslash should never get here
	017476'	200440	000012		MOVE	X,Y		;UNARY PLUS
	017477'	210440	000012		MOVN	X,Y		;UNARY MINUS
	017500'	270440	000012		ADD	X,Y		;PLUS
	017501'	274440	000012		SUB	X,Y
	017502'	260040	017510'		PJS	GEMUL
	017503'	230440	000012		IDIV	X,Y
	017504'	404440	000012		AND	X,Y
	017505'	434440	000012		IOR	X,Y
	017506'	430440	000012		XOR	X,Y
	017507'	242452	000000		LSH	X,(Y)

	017510'	261040	000012	GEMUL:	PUSH	S,Y
	017511'	224440	000012		MUL	X,Y
	017512'	332000	000011		SKIPE	X
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 7-7
NAD01.R06	24-JUL-87 17:39		GET EXPRESSION

	017513'	242440	000043		LSH	X,43
	017514'	434440	000012		IOR	X,Y
	017515'	262040	000012		POP	S,Y
	017516'	263040	000000		RETURN

	017517'	554500	000010	GERC:	HLRZ	Y,W		;RETURN UNDEFINED VALUE CHAIN
	017520'	514412	000002		HRLZ	W,2(Y)
	017521'	250500	006600'		DFL	Y		;RETURN CELL POINTED TO BY "Y"
	017522'	552520	006600'
	017523'	326400	017517'		JUMPN	W,GERC
	017524'	263040	000000		RETURN

NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 8
NAD01.R06	24-JUL-87 17:39		GET TOKEN

					SUBTTL	GET TOKEN
				;		**************************************************


				;	GET TOKEN TYPE TO U.0=BLANKS,1=NUM,2=SYMBOL,3 UND SYM,4=OP,5=DELIM,6=ILLEGAL
				;	C = CT TABLE ENTRY FOR TYPES 0, 4, 5, 6
				;	V = THE NUMBER VALUE FOR TYPE 1
				;	L = THE SYMBOL FOR TYPE 2 OR 3
				;	M = THE SYMTAB POINTER FOR TYPE 2, 0 FOR TYPE 3
				;	MACROS ARE EXPANDED BEFORE PROCESSING.

	017525'	134140	000002	GK:	ILDB	C,I
	017526'	200143	032742'		MOVE	C,CT(C)		;Lookup character type
	017527'	256003	017531'		XCT	GKX(C)		;Dispatch on character type
	017530'	263040	000000		RETURN
	017531'	030000	017525'	GKX:	CIT	GK		;LOOK FOR MORE INPUT
	017532'	201240	000006		MOVEI	U,6		;ILLEGAL CHARACTER
				;		 DIG A-F a-f G-Z g-z  .
	017533'	254000	017651'		JV	<GKN,GKY,GKY,GKY,GKY,GKY>
	017534'	254000	017714'
	017535'	254000	017714'
	017536'	254000	017714'
	017537'	254000	017714'
	017540'	254000	017714'
	017541'	201240	000004		MOVEI	U,4		;OPERATOR
	017542'	254000	017641'		JV	<GKD,GKD>	;DELIMITER, VERTICAL BAR
	017543'	254000	017641'
	017544'	032000	017525'		MEND	GK		;MACRO END
	017545'	201240	000006		MOVEI	U,6		;' (ILLEGAL)
	017546'	033000	017525'		MARG	GK		;MACRO ARGUMENT
	017547'	034000	017525'		MAE	GK		;MACRO ARG END

	017550'			GKE:	;VERTICAL BAR - EVAL EXPRESSION, INSERT TEXT INTO SYMBOL
	017550'	663640	000002		TLOE	F,VBSEEN	;HAVE WE ALREADY SEEN ONE?
	017551'	254000	017751'		JRST	GKY5		;YES - THIS IS TERMINATING QUOTE
	017552'	550141	000000		HRRZ	C,(S)		;GET CALLERS ADDRESS
	017553'	302140	017100'		CAIE	C,GEA+1		;IS CALLER GE?
	017554'	403300	000007		SETZB	VS,OS		;INIT STACK POINTERS IF NOT CALLED FROM GE

	017555'	261040	000013		PUSH	S,L		;SAVE SOME THINGS
	017556'	261040	000010		PUSH	S,W
	017557'	261040	000235'		PUSH	S,OPS
	017560'	261040	000007		PUSH	S,OS
	017561'	272340	000235'		ADDM	OS,OPS		;UPDATE STACK POINTERS
	017562'	261040	000236'		PUSH	S,VALS
	017563'	261040	000237'		PUSH	S,VALSF
	017564'	261040	000006		PUSH	S,VS
	017565'	272300	000236'		ADDM	VS,VALS
	017566'	272300	000237'		ADDM	VS,VALSF
	017567'	261040	000410'		PUSH	S,IBSLP
	017570'	261040	000411'		PUSH	S,BSLP
	017571'	350140	000411'		AOS	C,BSLP		;increment backslash pointer
	017572'	202140	000410'		MOVEM	C,IBSLP		;and set as new value
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 8-2
NAD01.R06	24-JUL-87 17:39		GET TOKEN

	017573'	402020	000411'		SETZM	@BSLP		;start stack as not in backslash
	017574'	261040	006320'		PUSH	S,GEUOK
	017575'	261040	003156'		PUSH	S,UCC
	017576'	261040	006326'		PUSH	S,MM1		;INCASE SYMBOL IN OPCODE FIELD
	017577'	200200	006325'		MOVE	V,MM		; THEN USE NONOPCODE SYMBOLS
	017600'	202200	006326'		MOVEM	V,MM1
	017601'	261040	000015		PUSH	S,F		;save proprietary token indicator
	017602'	260040	017071'		PJS	GE		;GET EXPRESSION VALUE
	017603'	621640	000002		TLZ	F,VBSEEN	;TURN OFF VERTICAL BAR FLAG
	017604'	262040	000010		POP	S,W		;restore proprietary token
	017605'	620640	001000		TRZ	F,PRPTOK	;clear value from bar evaluation
	017606'	602400	001000		TRNE	W,PRPTOK	;was old value set?
	017607'	660640	001000		TRO	F,PRPTOK	;yes, set as current value
	017610'	262040	006326'		POP	S,MM1
	017611'	262040	003156'		POP	S,UCC
	017612'	262040	006320'		POP	S,GEUOK
	017613'	262040	000411'		POP	S,BSLP
	017614'	262040	000410'		POP	S,IBSLP
	017615'	262040	000006		POP	S,VS
	017616'	262040	000237'		POP	S,VALSF
	017617'	262040	000236'		POP	S,VALS
	017620'	262040	000007		POP	S,OS
	017621'	262040	000235'		POP	S,OPS
	017622'	262040	000010		POP	S,W
	017623'	262040	000013		POP	S,L
	017624'	326240	034245'		JUMPN	U,[ PE MSUE,[RETURN]] ;ARG MUST BE DEFINED
	017625'	261040	034170'		PUSH	S,[0]		;CONVERT VALUE TO STRING
	017626'	230200	006333'	GKE1:	IDIV	V,TRADIX
	017627'	261045	032612'		PUSH	S,HEX6(U)	;FORM SIXBIT STRING
	017630'	326200	017626'		JUMPN	V,GKE1
	017631'	262040	000004	GKE2:	POP	S,V		;GET NEXT DIGIT
	017632'	322200	017724'		JUMPE	V,GKY2		;0 IS TERMINATOR
	017633'	136200	000010		IDPB	V,W		;ADD CHAR TO STRING
	017634'	603400	770000		TLNE	W,770000	;ROOM FOR MORE CHARS?
	017635'	254000	017631'		JRST	GKE2		;GET NEXT CHR
	017636'	262040	000004	GKE3:	POP	S,V		;L IS FULL. FLUSH EXTRA CHARS
	017637'	326200	017636'		JUMPN	V,GKE3
	017640'	254000	017724'		JRST	GKY2

	017641'			GKD:;	DELIMITER OR BLANK OR TAB FIELD
	017641'	607140	777776		TLNN	C,-2		;CHECK FOR BLANK AND TAB (TYPES 0 AND 1)
	017642'	254000	017645'		JRST	GKD1
	017643'	201240	000005		MOVEI	U,5
	017644'	263040	000000		RETURN
	017645'	260040	021742'	GKD1:	PJS	FBT		;FLUSH BLANKS AND TABS
	017646'	400240	000000		SETZ	U,
	017647'	200140	033002'		MOVE	C,CT+40		;SET BLANK AS TERMINATOR
	017650'	263040	000000		RETURN

	017651'	400200	000000	GKN:	SETZ	V,		;BUILD NUMBER INTO V
	017652'	200440	006333'		MOVE	X,TRADIX	;Get the radix for this moment
	017653'	554400	000003	GKN1:	HLRZ	W,C		;Get the normalized value of the character
	017654'	274403	017707'		SUB	W,GKNN-2(C)	;Convert the character to a number
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 8-3
NAD01.R06	24-JUL-87 17:39		GET TOKEN

	017655'	311400	000011		CAML	W,X		;Compare with the radix
	017656'	031000	034246'		PE	MSRV,.+1	;Treat digit >= the radix as an error
	017657'	224200	000011		MUL	V,X		;Multiply the accumulator by the radix
	017660'	332000	000004		SKIPE	V		;Check for zero result
	017661'	242200	000043		LSH	V,43		;Shift out all but LSB of result
	017662'	434200	000005		IOR	V,U		;LOGICAL MULTIPLY(replace sign bit by MSB)
	017663'	270200	000010		ADD	V,W		;Add current number to accumulator
	017664'	134140	000002	GKN2:	ILDB	C,I		;Get next character
	017665'	200143	032742'		MOVE	C,CT(C)		;Lookup character type
	017666'	256003	017667'		XCT	.+1(C)		;Dispatch on character type
	017667'	030000	017664'		CIT	GKN2		;GET MORE CHARACTERS
				;		 CRAP DIG  A-F  a-f  G-Z  g-z   .    OPR DELIM  |
	017670'	254000	017706'		JV	<GKN9,GKN1,GKN1,GKN1,GKN9,GKN9,GKN9,GKN9,GKN9,GKN9>
	017671'	254000	017653'
	017672'	254000	017653'
	017673'	254000	017653'
	017674'	254000	017706'
	017675'	254000	017706'
	017676'	254000	017706'
	017677'	254000	017706'
	017700'	254000	017706'
	017701'	254000	017706'
	017702'	032000	017664'		MEND	GKN2		;MACRO END
	017703'	254000	017706'		JRST	GKN9		;' (CONCATINATION)
	017704'	033000	017664'		MARG	GKN2		;MACRO ARGUMENT
	017705'	034000	017664'		MAE	GKN2		;MACRO ARG END
	017706'	201240	000001	GKN9:	MOVEI	U,1
	017707'	270100	006336'		ADD	I,BACKUP	;DECREMENT BYTE POINTER BY ONE CHARACTER
	017710'	263040	000000		RETURN
	017711'	000000	000060	GKNN:	EXP	60,67,127
	017712'	000000	000067
	017713'	000000	000127

	017714'			GKY:				;GET A SYMBOL FROM STREAM AND LOOKUP VALUE
	017714'	620640	001000		TRZ	F,PRPTOK	;save whether token was in proprietary code
	017715'	602640	004000		TRNE	F,PRPCOD	;  at start of token scan
	017716'	660640	001000		TRO	F,PRPTOK
	017717'	400540	000000		SETZ	L,		;BUILD SIXBIT INTO L
	017720'	200400	034247'		MOVE	W,[POINT 6,L]	; POINT TO LEFT OF L
	017721'	544200	000003		HLR	V,C
	017722'	256003	017732'		XCT	GKYX1(C)
	017723'	136200	000010	GKY1:	IDPB	V,W		;PUT A SIXBIT BYTE IN W
	017724'	134200	000002	GKY2:	ILDB	V,I		;READ FROM INPUT STREAM
	017725'	200144	032742'		MOVE	C,CT(V)		;PICK UP CHR PROPERTIES
	017726'	256003	017732'		XCT	GKYX1(C)	;CONVERT TO SIXBIT MAYBE
	017727'	603400	770000		TLNE	W,770000
	017730'	254000	017723'		JRST	GKY1		;GET NXT CHR
	017731'	254000	017724'		JRST	GKY2		;L IS FULL. FLUSH EXTRA CHRS.

	017732'	030000	017724'	GKYX1:	CIT	GKY2		;GET MORE CHARACTERS
	017733'	254000	017751'		JRST	GKY5		;GARBAGE CHARACTERS
	017734'	275200	000040		SUBI	V,40		;DIGIT
	017735'	275200	000040		SUBI	V,40		;A-F
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 8-4
NAD01.R06	24-JUL-87 17:39		GET TOKEN

	017736'	405200	000077		ANDI	V,77		;a-f
	017737'	275200	000040		SUBI	V,40		;G-Z
	017740'	405200	000077		ANDI	V,77		;g-z
	017741'	201200	000016		MOVEI	V,'.'		; .
				;		  OPR DELIM  |
	017742'	254000	017751'		JV	<GKY5,GKY5,GKE>
	017743'	254000	017751'
	017744'	254000	017550'
	017745'	032000	017724'		MEND	GKY2		;MACRO END
	017746'	254000	017724'		JRST	GKY2		;' (CONCATINATION)
	017747'	033000	017724'		MARG	GKY2		;MACRO ARGUMENT
	017750'	034000	017724'		MAE	GKY2		;MACRO ARG END

	017751'	270100	006336'	GKY5:	ADD	I,BACKUP	;SYMBOL IN W
	017752'	260040	020203'		PJS	FY
	017753'	201240	000002		MOVEI	U,2
	017754'	327600	017760'		JUMPG	M,GKM0
	017755'	124540	006323'		DMOVEM	L,UL
	017756'	202440	006322'		MOVEM	X,UX
	017757'	344240	034240'		AOJA	U,[RETURN]

	017760'	607600	000075	GKM0:	TLNN	M,75		;IS IT A MACRO? (MODULE 2)
	017761'	607600	000002		TLNN	M,2
	017762'	263040	000000		RETURN			;NO, RETURN
	017763'	603640	000020		TLNE	F,NOMACX	;SHOULD MACRO EXPANSIONS BE SUPPRESSED
	017764'	263040	000000		RETURN			;YES. EXIT WITH SYMBOL NAME
	017765'	260040	017767'		PJS	MACSET		;SET UP MACRO AND ARGS
	017766'	254000	017525'		JRST	GK

				;SET UP MACRO CALL, EAT ARGS, ETC.
	017767'	606640	000100	MACSET:	TRNN	F,CREF		;CREF LISTING?
	017770'	254000	017773'		JRST	MACST0		;NO
	017771'	201400	000005		MOVEI	W,5		;OUTPUT MACRO REFERENCE
	017772'	260040	023050'		PJS	OUTSYM
	017773'	135500	034250'	MACST0:	LDB	Y,[POINT 9,2(M),35]	;GET NUMBER OF ARGUMENTS
	017774'	541512	000001		HRRI	Y,1(Y)		; COMPUTE NARGS+1
	017775'	210540	000012		MOVN	L,Y		; FORM POINTER TO STORE BYTE
	017776'	504540	000013		HRL	L,L		; POINTER FOR EACH ARG.
	017777'	541540	013106'		HRRI	L,MACBUF	; POINTER = -(NARGS+1),,ARGADDR-1
	020000'	201440	002775		MOVEI	X,MWMAX		; Number of words in macro buffer
	020001'	274440	000012		SUB	X,Y		; Less words for argument pointers
	020002'	221440	000005		IMULI	X,5		; Compute number of characters for text
	020003'	202440	013053'		MOVEM	X,MACCNT	; Save for insertion of characters
	020004'	271500	013106'		ADDI	Y,MACBUF	; Construct byte pointer for first arg
	020005'	505500	440700		HRLI	Y,(POINT 7,0)
	020006'	400240	000000		SETZ	U,		;ZERO PAREN COUNTER
	020007'	336000	013055'		SKIPN	MACN		;IS THIS A FIRST LEVEL EXPANSION
	020010'	202100	013054'		MOVEM	I,MACI		;YES. SAVE "I" FOR ERROR MESSAGE TYPEOUT
	020011'	331000	013055'		SKIPL	MACN		;IS EXPANSION FROM START OF LINE STILL ON
	020012'	350000	013055'		AOS	MACN		;YES. KEEP TRACK OF EXPANSION
	020013'	260040	021753'		PJS	GCHR		;GET NEXT CHR
	020014'	302140	000050		CAIE	C,"("		;MUST BE LPAR IF ANY ARGS
					JRST	[ADD I,BACKUP	;DECREMENT BYTE POINTER BY ONE CHARACTER
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 8-5
NAD01.R06	24-JUL-87 17:39		GET TOKEN

	020015'	254000	034251'			JRST GKM3]
	020016'	660640	040000		TRO	F,MASCAN	;set scanning macro argument list
	020017'	252540	020064'	GKM9:	AOBJP	L,GKM2		;ANYMORE ARGS TO GET?
	020020'	202513	000000		MOVEM	Y,(L)		;YES. SAVE ADDRESS OF ARG START
	020021'	275500	013106'		SUBI	Y,MACBUF	; Convert to relative to start of block
	020022'	250513	000000		EXCH	Y,(L)		; And save relative address instead
	020023'	134140	000002	GKM:	ILDB	C,I		;PROCESS ARGS
	020024'	200203	032742'		MOVE	V,CT(C)		;Lookup character type
	020025'	256004	020027'		XCT	GKM1(V)		;STUFF OR SWITCH TO PROCESSING ROUTINE
	020026'	254000	020023'		JRST	GKM

	020027'	030000	020023'	GKM1:	CIT	GKM		;GET MORE CHARACTERS
					REPEAT	DE-1,< PJS PUTMCH>	;NON-DELIMITER
	020030'	260040	023311'
	020031'	260040	023311'
	020032'	260040	023311'
	020033'	260040	023311'
	020034'	260040	023311'
	020035'	260040	023311'
	020036'	260040	023311'
	020037'	260040	023311'
	020040'	254000	020046'		JRST	GKMD		;DELIMITER
	020041'	260040	023311'		PJS	PUTMCH		;NON-DELIMITER
	020042'	032000	020023'		MEND	GKM		;MACRO END
	020043'	254000	020061'		JRST	GKMLIT		;' (LITERAL CHARACTER FLAG)
	020044'	033000	020023'		MARG	GKM		;MACRO ARGUMENT
	020045'	034000	020023'		MAE	GKM		;MACRO ARG END

	020046'	306140	000051	GKMD:	CAIN	C,")"		;RIGHT PAREN MEANS END OF ARG PROCESSING
	020047'	361240	020074'		SOJL	U,GKMDUN	;FINISH CALL IF OUTER PAREN
	020050'	306140	000050		CAIN	C,"("		;CHECK FOR NEW ARGUMENT LIST
	020051'	340240	000000		AOJ	U,		;COUNT ITS PAREN
	020052'	306140	000054		CAIN	C,","		;COMMA DELIMITS ARGS
	020053'	322240	020056'		JUMPE	U,GKMD1		;END ARG IF NOT IN PARENS
	020054'	260040	023311'		PJS	PUTMCH		;TREAT OTHER DELIMITERS AS NORMAL CHARS
	020055'	254000	020023'		JRST	GKM

	020056'	201140	000002	GKMD1:	MOVEI	C,2		;TERMINATE CURRENT ARG
	020057'	260040	023311'		PJS	PUTMCH
	020060'	254000	020017'		JRST	GKM9

	020061'	260040	021753'	GKMLIT:	PJS	GCHR		;TAKE ONE CHARACTER LITERALLY
	020062'	260040	023311'		PJS	PUTMCH
	020063'	254000	020023'		JRST	GKM

	020064'	260040	021753'	GKM2:	PJS	GCHR		;IGNORE REST OF ARGUMENT STRING
	020065'	306140	000051		CAIN	C,")"		;UNTIL FIRST RIGHT PAREN
	020066'	361240	020103'		SOJL	U,GKM5		;EXIT IF OUTER PAREN
	020067'	306140	000050		CAIN	C,"("		;COUNT OPEN PARENS
	020070'	340240	000000		AOJ	U,
	020071'	306140	000140		CAIN	C,"`"		;IF LITERAL CHARACTER
	020072'	260040	021753'		PJS	GCHR		;THEN ACCEPT ONE CHAR WITHOUT ")" CHECK
	020073'	254000	020064'		JRST	GKM2
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 8-6
NAD01.R06	24-JUL-87 17:39		GET TOKEN


	020074'	201140	000002	GKMDUN:	MOVEI	C,2		;TERMINATE CURRENT ARG
	020075'	260040	023311'		PJS	PUTMCH
	020076'	252540	020103'	GKM3:	AOBJP	L,GKM5		;ANY ARGS NOT SET
	020077'	202513	000000		MOVEM	Y,(L)		;YES. SET THEM ALL TO NULL STRING.
	020100'	275500	013106'		SUBI	Y,MACBUF	; Convert to relative to start of block
	020101'	250513	000000		EXCH	Y,(L)		; And save relative address instead
	020102'	254000	020074'		JRST	GKMDUN
	020103'	620640	040000	GKM5:	TRZ	F,MASCAN	;clear scanning for macro arguments
	020104'	335000	013053'		SKIPGE	MACCNT		; Is macro argument text too big?
	020105'	402000	013053'		SETZM	MACCNT		; Yes. Ignore excess (kludge!)
	020106'	260040	023361'		PJS	FMACD		; Move argument strings to free storage
	020107'	200400	013064'		MOVE	W,MACTXT	;GET START OF CALL BLOCK
	020110'	200500	013061'		MOVE	Y,MCHCNT	;GET SIZE OF BLOCK
	020111'	506510	000000		HRLM	Y,(W)		;STORE SIZE IN BLOCK HEADER
	020112'	250400	013056'		EXCH	W,MACSTK	;SET STACK TO POINT TO NEW BLOCK
	020113'	542420	013056'		HRRM	W,@MACSTK	;SET NEW BLOCK TO POINT TO REST OF STACK
	020114'	260040	025640'		PJS	SAVIP		;SAVE TEXT PTR FOR RETURN
	020115'	200400	013057'		MOVE	W,IPSTK		;pointer to top stack entry
	020116'	350500	013051'		AOS	Y,MACVER	;get next invocation number
	020117'	250500	013052'		EXCH	Y,MACCUR	;set as current macro invocation
	020120'	622640	004000		TRZE	F,PRPCOD	;clear proprietary setting, and test to save
	020121'	661500	400000		TLO	Y,400000	;use sign bit to save old setting
	020122'	202510	000002		MOVEM	Y,2(W)		;save previous invocation number
	020123'	200514	000000		MOVE	Y,(M)		;get word zero of macro definition
	020124'	603500	040000		TLNE	Y,SYPRPM	;was macro defined in proprietary code?
	020125'	660640	004000		TRO	F,PRPCOD	;yes, still in proprietary code
	020126'	602640	000003		TRNE	F,SUPLST+ASONLY ;SHOULD LISTING BE SUPPRESSED?
	020127'	254000	020143'		JRST	GKM4		;YES.
	020130'	133000	000002		IBP	I		;SAVE CURRENT STATEMENT INCLUDING MACRO
	020131'	260040	022727'		PJS	LSVLNE		; CALL. SET BYTE POINTER TO AFTER ")"
	020132'	270100	006336'		ADD	I,BACKUP	;RESTORE BYTE POINTER TO ")"
	020133'	336000	000777'		SKIPN	LSTMSK		;IF LISTING IN PASS 1,SUPPRESS EXPANSION
	020134'	603640	002040		TLNE	F,LSX+NOLIST	;SHOULD MACRO EXPANSION BE SUPPRESSED?
	020135'	660640	000002		TRO	F,SUPLST	;YES.
	020136'	606640	000002		TRNN	F,SUPLST	;SHOULD MACRO EXPANSION BE SUPPRESSED?
	020137'	375000	003250'		SOSGE	LSVCNT		;ANY ROOM IN BUFFER?
	020140'	254000	020143'		JRST	GKM4		;NO
	020141'	201140	000133		MOVEI	C,"["		;BRACKET MACRO BODY IN LISTING
	020142'	136140	006251'		IDPB	C,LSVP
	020143'	554114	000002	GKM4:	HLRZ	I,2(M)		; Get pointer to macro text
	020144'	505100	440700		HRLI	I,(POINT 7,0)	; and construct byte pointer
	020145'	202100	006252'		MOVEM	I,LISTI		;AND SAVE IN CASE THIS NEEDS TO BE SAVED
	020146'	263040	000000		RETURN

				;	END OF TOKEN GETTER
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 9
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE PROCESSORS

					SUBTTL	SYMBOL TABLE PROCESSORS
				;		**************************************************


				;	Symbol Table. There are HASHSZ lists that chain symbol table entries.
				;	The head of the appropriate list is found by a simple hash of the
				;	sixbit key. There are 3 words per entry.
				;	Word 0 left
				;	  Bit 0 (SYUNDF)	: 1 if symbol is undefined
				;	  Bit 1	(SYSHNU)	: 1 if symbol was not defined (only in shadow table)
				;	  Bit 2	(SYPROP)	: 1 if symbol came from proprietary file
				;	  Bit 3	(SYPRPM)	: 1 if macro came from proprietary file
				;	  Bits 4-5	: unused
				;	  Bits 6-11	: opcode type, only for opcodes, module 0
				;	  Bits 12-17	: module #. 0 for opcodes, 1 for global, 2 for macros,
				;			:	3 unused, 4-37 for user (4 is MAIN)
				;	Word 0 right	List chain address or 0 if end of chain
				;	Word 1		36 bits of sixbit ASCII
				;	Word 2		Value word

				;	Undefined symbols that are entered in the table have bit 0 word 0 on
				;	and the value word is borrowed until the value is known to point
				;	to a chain that is waiting for the value. The chain may go through
				;	node memory and symbol table space. If the chain goes through
				;	symbol table space the chain is a compute chain that stores opcodes
				;	and values that must be combined with the symbol value to create
				;	an expression value. Word 2 contains zeros in the left half when
				;	it points to a compute chain. When word 2 points to user memory it
				;	contains a 20 bit byte pointer and the sign bit is on. Chains through
				;	memory may be spliced to a compute chain that comes back to memory
				;	and later goes into another compute chain. When UC unravels compute
				;	chains it accumulates an expression value and then deposits into node
				;	memory according to the node byte address at the
				;	end of the compute chain and then resets the accumulated value to the
				;	symbol value before proceeding further through the chaining.
				;	A compute chain entry looks like this:
				;	Word 0. All zeros except for a right adjusted five bit operation code
				;		preceded by a bit that if on means do non communative operation
				;		with the arguments in reverse order.
				;	Word 1. The right hand value for the 36 bit operation. The value that
				;		is delivered to this entry in the chain is the left hand value.
				;	Word 2. A symbol table address to continue compute chain or a byte
				;		address and the sign bit on if the end of the compute chain.
				;	Values are chained though memory when the chain is unraveled by DY
				;	and UC. The chains are created by SPLICE which splices a new value
				;	destination into an undefined chain.
				;	The chaining through memory uses PDP 10 halfwords to chain through
				;	node memory halfwords. Before a halfword has its defined value in
				;	it, it may contain a 15 bit relative to PC backword chain element
				;	or a 15 bit symbol table index. These chaining addresses are left
				;	adjusted into an 18 bit PDP 10 halfword that will ultimately contain
				;	a 16 bit value. There is a bit on to the right of the 15 bits if the 15
				;	bits is node memory backward chaining. The 2 other bits tell the chain
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 9-2
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE PROCESSORS

				;	unraveler the mode in which the value should be stored (immediate value,
				;	RX1 or RX2 value, etc.). Undefined chains end with a 0 pointer.

				;DELETE SYMBOL (SIXBIT IN L)
	020147'	260040	020203'	DELSYM:	PJS	FY		;see if symbol defined
	020150'	322600	020156'		JUMPE	M,DELSY1	;not there
	020151'	602640	200000		TRNE	F,MKSHAD	;if making shadow table, forget its a macro
	020152'	400400	000000		SETZ	W,		;dont tell RY its a macro
	020153'	260040	020157'		PJS	RY		;remove from symbol table
	020154'	602640	200000		TRNE	F,MKSHAD	;shadow table for pass 2 needed?
	020155'	260040	020712'		PJS	SHOLD		;yes. enter old value before delete
	020156'	263040	000000	DELSY1:	RETURN

				;	Remove symbol from symbol table.
				;	Called with M set to entry to remove, X set to previous entry and
				;	W set to module bit mask. Destroys W and V.
				;	Note the input to RY is the output of FY for a symbol in the table.
				;

	020157'	607400	100000	RY:	TLNN	W,100000	;IS SYMBOL TO BE DELETED FROM MODULE 2 (A MACRO)
	020160'	254000	020164'		JRST	RY1		;NO
	020161'	554414	000002		HLRZ	W,2(M)		;GET ADDRESS OF TEXT
	020162'	135200	020331'		LDB	V,MBSPNT	;GET NUMBER OF WORDS TO RETURN
	020163'	260040	020337'		PJS	REMAC		;AND RETURN TO FREE LIST
	020164'	321600	020173'	RY1:	JUMPL	M,RY5		;CHECK FOR UNDEFINED SYMBOL
	020165'	550214	000000	RY2:	HRRZ	V,(M)		;GOT IT, PICK UP CHAIN POINTER
	020166'	542211	000000		HRRM	V,(X)		;SPLICE THIS ENTRY OUT OF THE LIST
	020167'	550400	000014		HRRZ	W,M		;clear flag bits in M
	020170'	250400	006600'		DFL	W		;RETURN ENTRY CUT OUT TO FREE LIST
	020171'	552420	006600'
	020172'	263040	000000		RETURN
	020173'	336014	000002	RY5:	SKIPN	2(M)		;ANY UNRESOLVED REFERENCES
	020174'	254000	020165'		JRST	RY2		;NO, ALLRIGHT TO DELETE SYMBOL
	020175'	400300	000000		SETZ	VS,		;SET UP A ZERO SYMBOL
	020176'	261040	000011		PUSH	S,X		;SAVE REG X
	020177'	260040	020424'		PJS	UC		;UNCHAIN THIS SYMBOL
	020200'	031000	034253'		PE	MSKILL,RY6
	020201'	262040	000011	RY6:	POP	S,X 		;RESTORE X
	020202'	254000	020165'		JRST	RY2

				;	Find symbol in L and whose module is in module mask MM1.
				;	Return M=0 if not in table, otherwise set M to address of entry.
				;	Always return X as address of previous entry.
				;	If found return W as module mask bit and V as value.
				;	Also set left of M to left of first word of entry.

	020203'	214400	000013	FY:	MOVM	W,L
	020204'	231400	002007		IDIVI	W,HASHSZ		;Divide by size of list head array
	020205'	541611	006610'		HRRI	M,YHASHT(X)	;Use remainder to make address of list head
	020206'	550440	000014	FY1:	HRRZ	X,M		;save previous pointer
	020207'	550614	000000		HRRZ	M,(M)		;Get next symbol entry
	020210'	322600	020221'		JUMPE	M,FY2		;Return if no symbol found
	020211'	312554	000001		CAME	L,1(M)		;Is this a match on the symbol?
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 9-3
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE PROCESSORS

	020212'	254000	020206'		JRST	FY1		;No, continue search
	020213'	135400	034254'		LDB	W,[POINT 6,0(M),17]	;Yes, load up module number
	020214'	200410	032632'		MOVE	W,LBIT(W)
	020215'	616400	006326'		TDNN	W,MM1		;Is this the one we are looking for?
	020216'	254000	020206'		JRST	FY1		;No, continue searching
	020217'	500614	000000		HLL	M,(M)		;Yes, load up the flag bits
	020220'	200214	000002		MOVE	V,2(M)		;Load up the value
	020221'	263040	000000	FY2:	RETURN


				;	FCS	FIND CLOSE SYMBOL TO V.
				;		 PUT DIF IN U. SYM TAB PTR TO W.
				;		 CALLER PUTS MODULE FILTER IN M.
	020222'	261040	000006	FCS:	BAR	<X,Y,L,VS>	;SAVE REGISTERS OVER CALL
	020223'	261040	000011
	020224'	261040	000012
	020225'	261040	000013
	020226'	260040	020234'
	020227'	262040	000013
	020230'	262040	000012
	020231'	262040	000011
	020232'	262040	000006
	020233'	263040	000000
	020234'	200240	006576'		MOVE	U,FCSBND	;MAXIMUM DIFFERENCE FOR SYMBOL TO BE CONSIDERED CLOSE
	020235'	474400	000000		SETO	W,		;INITIALIZE TO UNDEFINED
	020236'	200300	006575'		MOVE	VS,FCSMIN	
	020237'	316600	032632'		CAMN	M,LBIT		;IS IT AN OPERATOR?
	020240'	201300	000400		MOVEI	VS,400		;YES. ALLOW OPERATORS ONLY >=400
	020241'	315200	000006		CAMGE	V,VS
	020242'	263040	000000		RETURN
	020243'	211500	002007		MOVNI	Y,HASHSZ	;FORM POINTER TO HASH TABLE
	020244'	254000	020274'		JRST	FC4		;START SEARCH
	020245'	200311	000002	FC1:	MOVE	VS,2(X)		;Get symbol value
	020246'	316600	032632'		CAMN	M,LBIT		;Test for opcode mode
	020247'	554311	000002		HLRZ	VS,2(X)		;Opcode value is a halfword
	020250'	274300	000004		SUB	VS,V		;Subtract search value from symbol value
	020251'	210300	000006		MOVN	VS,VS		;Form search value minus symbol value
	020252'	321300	020271'		JUMPL	VS,FC2		;Continue search if search value less than symbol value
	020253'	311300	000005		CAML	VS,U		;Compare difference with limit
	020254'	254000	020271'		JRST	FC2		;Continue search if difference too big
	020255'	201551	000002		MOVEI	L,2(X)		;Get address of value
	020256'	316540	000467'		CAMN	L,DOTP
	020257'	254000	020271'		JRST	FC2
	020260'	135540	034255'		LDB	L,[POINT 6,(X),17] ;Extract the module #
	020261'	616613	032632'		TDNN	M,LBIT(L)	;Compare with requested #
	020262'	254000	020271'		JRST	FC2		;Continue search if wrong module
	020263'	200551	000000		MOVE	L,(X)		;Get word 0 of entry
	020264'	603540	100000		TLNE	L,SYPROP	;Is symbol in proprietary code?
	020265'	254000	020271'		JRST	FC2		;Yes, don't print in debug mode.
				;	GOOD SYMBOL FOUND
	020266'	200240	000006		MOVE	U,VS		;Save difference
	020267'	200400	000011		MOVE	W,X		;Save pointer
	020270'	322240	034240'		JUMPE	U,[RETURN]	;Zero difference is the end of the search
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 9-4
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE PROCESSORS

	020271'	550451	000000	FC2:	HRRZ	X,(X)		;Get next symbol table entry
	020272'	327440	020245'	FC3:	JUMPG	X,FC1		;Continue if not end of chain
	020273'	345500	034240'		AOJGE	Y,[RETURN]	;Increment pointer to next hash table entry
	020274'	550452	010617'	FC4:	HRRZ	X,EYH(Y)	;Get Symbol table entry from hash table
	020275'	254000	020272'		JRST	FC3

				;	DEFINE A MACRO OR OPCODE. CALLED WITH NAME IN "L" AND VALUE IN
				;	"VS".

	020276'	606640	000100	DOM:	TRNN	F,CREF		;CREF LISTING?
	020277'	254000	020302'		JRST	DOM0		;NO
	020300'	201400	000006		MOVEI	W,6		;OUTPUT MACRO DEFINITION
	020301'	260040	023050'		PJS	OUTSYM
	020302'	602640	004000	DOM0:	TRNE	F,PRPCOD	;is definition in proprietary code?
	020303'	661240	040000		TLO	U,SYPRPM	;yes, mark macro as proprietary.
	020304'	515400	500000		HRLZI	W,500000	;ONLY REDEFINE AN OPCODE OF MACRO
	020305'	202400	006326'		MOVEM	W,MM1
	020306'	260040	020203'		PJS	FY		;IS SYMBOL ALREADY DEFINED
	020307'	322600	020326'		JUMPE	M,DOM2		;NO. GO MAKE NEW ENTRY
	020310'	321400	020314'		JUMPL	W,DOM1		;JUMP IF OPCODE
	020311'	554414	000002		HLRZ	W,2(M)		;IF MACRO, GET TEXT ADDRESS
	020312'	135200	020331'		LDB	V,MBSPNT	;GET NUMBER OF WORDS TO RETURN
	020313'	260040	020337'		PJS	REMAC		;AND RETURN TO FREE LIST
	020314'	606640	200000	DOM1:	TRNN	F,MKSHAD	;shadow needed?
	020315'	254000	020323'		JRST	DOM3		;no
	020316'	260040	020712'		PJS	SHOLD		;shadow old value.
	020317'	200400	000014		MOVE	W,M		;get old module number
	020320'	430400	000005		XOR	W,U		;compare with new
	020321'	603400	000077		TLNE	W,77		;are they different (has it changed) ?
	020322'	260040	020717'		PJS	SHNEW		;yes. shadow new symbol
	020323'	502254	000000	DOM3:	HLLM	U,(M)		;SET NEW MODULE NUMBER
	020324'	202314	000002		MOVEM	VS,2(M)		;STORE NEW VALUE WORD
	020325'	263040	000000		RETURN
	020326'	200200	000006	DOM2:	MOVE	V,VS		;PASS VALUE WORD IN "V"
	020327'	260040	020364'		PJS	MY		;MAKE NEW ENTRY
	020330'	263040	000000		RETURN
	020331'	111114	000002	MBSPNT:	POINT	9,2(M),26	;POINTS TO MACRO BLOCK SIZE

				; Remove block addressed by W from list. Uses registers X and Y.
				; Leaves W unchanged
				;
	020332'	540450	000000	REMBLK: HRR	X,(W)		; Get block after block W
	020333'	544510	000000		HLR	Y,(W)		; Get block before block W
	020334'	542452	000000		HRRM	X,(Y)		; Have block before W point to block after
	020335'	506511	000000		HRLM	Y,(X)		; Have block after W point to block before
	020336'	263040	000000		RETURN
				;
				; Return Macro block addressed by W to list. List is sorted by size.
				;
	020337'	550400	000010	REMAC:	HRRZ	W,W		; Clear left half of W
	020340'	302200	000001		CAIE	V,1		; Is it a single cell?
	020341'	254000	020345'		JRST	REMAC1		; No, it is larger. Save on Macro free list
	020342'	250400	006600'		DFL	W		; Yes, return to single cell free list.
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 9-5
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE PROCESSORS

	020343'	552420	006600'
	020344'	263040	000000		RETURN
	020345'	261040	000011	REMAC1:	PUSH	S,X		; Save registers X and Y
	020346'	261040	000012		PUSH	S,Y
	020347'	202210	000001		MOVEM	V,1(W)		; Get size of entry to return
	020350'	201500	013047'		MOVEI	Y,MACFRE	; Get address of list header
	020351'	540512	000000	REMAC2: HRR	Y,(Y)		; Get address of next list entry
	020352'	315212	000001		CAMGE	V,1(Y)		; If block is bigger, it goes before
	020353'	254000	020351'		JRST	REMAC2		; Block smaller, try next
	020354'	542510	000000		HRRM	Y,(W)		; Have block point to after block
	020355'	544452	000000		HLR	X,(Y)		; Get before block
	020356'	506450	000000		HRLM	X,(W)		; Have block point to before block
	020357'	506412	000000		HRLM	W,(Y)		; Have after block point to returned block
	020360'	542411	000000		HRRM	W,(X)		; Have before block point to returned block
	020361'	262040	000012		POP	S,Y		; Restore registers Y and X
	020362'	262040	000011		POP	S,X
	020363'	263040	000000		RETURN

				;	Make symbol entry.
				;	Called with L set to name, V set to value, U set to left half flags
				;	and X set to address of previous entry where new is to go.
				;	Return M set to address of new entry, X and W destroyed.

	020364'	336420	006600'	MY:	GFL
	020365'	260040	020656'
	020366'	250400	006600'
	020367'	200600	000010		MOVE	M,W		;put address of new entry in M
	020370'	550411	000000		HRRZ	W,(X)		;put address of next entry in W
	020371'	500400	000005		HLL	W,U		;construct first word of new entry in W
	020372'	202414	000000		MOVEM	W,(M)		;store first word of new entry
	020373'	202554	000001		MOVEM	L,1(M)		;store name in second word
	020374'	202214	000002		MOVEM	V,2(M)		;store value in third word
	020375'	542611	000000		HRRM	M,(X)		;have previous point to new entry
	020376'	602640	200000		TRNE	F,MKSHAD	;shadow table in use?
	020377'	260040	020717'		PJS	SHNEW		;yes. shadow new symbol
	020400'	263040	000000		RETURN


				;	DY	define a symbol
				;	Put symbol definition into the symbol table.  Handle forward references
				;	to the symbol by calling UC to unchain the mess.
				;	ARGUMENTS:	L HAS SIXBIT SYMBOL.
				;			VS HAS NEW VALUE.
	020401'	606640	000100	DY:	TRNN	F,CREF		;CREF LISTING?
	020402'	254000	020407'		JRST	DY0		;NO
	020403'	201400	000001		MOVEI	W,1		;OUTPUT SYMBOL DEFINITION
	020404'	260040	023050'		PJS	OUTSYM
	020405'	201400	000002		MOVEI	W,2		;mark as local
	020406'	260040	022617'		PJS	LOCN
	020407'	260040	020203'	DY0:	PJS	FY		;Does the symbol already exist?
	020410'	322600	020420'		JUMPE	M,DY1		;No, go make new one
	020411'	602640	200000		TRNE	F,MKSHAD	;Yes, shadow in use?
	020412'	260040	020712'		PJS	SHOLD		;Yes, shadow old value
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 9-6
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE PROCESSORS

	020413'	434600	002331'		IOR	M,SYLOCK	;Insert symbol lock in left half of M
	020414'	502614	000000		HLLM	M,(M)		;and store bak in entry
	020415'	321600	020424'		JUMPL	M,UC		;SYMBOL HAS UNDEFINED FLAG ON
	020416'	202314	000002		MOVEM	VS,2(M)
	020417'	263040	000000		RETURN
	020420'	200200	000006	DY1:	MOVE	V,VS
	020421'	434240	002331'		IOR	U,SYLOCK	;Set symbol lock for new symbol
	020422'	260040	020364'		PJS	MY		;Make an entry for the symbol
	020423'	263040	000000		RETURN			;ENTER SYMBOL INTO TABLE

				;	UC	Handle undefined symbol forward reference chain
	020424'	621600	400000	UC:	TLZ	M,SYUNDF	;Turn off undefined bit
	020425'	502614	000000		HLLM	M,(M)		;and store back in entry
	020426'	200400	000006		MOVE	W,VS
	020427'	200200	000006		MOVE	V,VS		;V IS TEMPORARY VALUE. VS IS SYMBOL VALUE.
	020430'	250414	000002		EXCH	W,2(M)
	020431'	322400	020613'	UC1:	JUMPE	W,UC9
	020432'	327400	020537'		JUMPG	W,UCY
	020433'	550500	000010		HRRZ	Y,W		;Save pointer to memory reference cell
	020434'	200412	000001		MOVE	W,1(Y)		;Get location in engine memory for fixup
	020435'	200340	000010		MOVE	OS,W		;..and save the location
	020436'	260040	025630'		CA	K
	020437'	200452	000000		MOVE	X,(Y)		;Get type of reference
	020440'	254011	020441'		JV	<.+1(X),UCH,UCW,UCRX,UCRX3>
	020441'	254000	020460'
	020442'	254000	020445'
	020443'	254000	020476'
	020444'	254000	020517'
	020445'	311200	034256'	UCW:	CAML	V,[-1_40]
	020446'	311200	034257'		CAML	V,[1_40]
	020447'	260040	020530'		PJS	UCER1
	020450'	241200	777760		ROT	V,-20
	020451'	137200	000010		DPB	V,W		;STORE LEFT BYTE
	020452'	200400	000007		MOVE	W,OS
	020453'	271400	000002		ADDI	W,2
	020454'	260040	025620'		CA	H
	020455'	241200	000020		ROT	V,20
	020456'	137200	000010		DPB	V,W
	020457'	254000	020464'		JRST	UCH1
	020460'			UCH:				;STORE A HALFWORD INTO USER MEMORY
	020460'	311200	034260'		CAML	V,[-1_20]
	020461'	301200	200000		CAIL	V,1_20
	020462'	260040	020530'		PJS	UCER1
	020463'	137200	000010		DPB	V,W		;DEPOSIT HALFWORD
	020464'	200200	000006	UCH1:	MOVE	V,VS
	020465'	200400	000012		MOVE	W,Y		;Restore pointer to reference cell
	020466'	254000	020545'		JRST	UCY2		;Continue with rest of chain

	020467'	261040	000000	UCRX0:	PUSH	S,0
	020470'	200000	000007		MOVE	0,OS
	020471'	275000	000002		SUBI	0,2
	020472'	621000	400000		TLZ	0,400000
	020473'	260040	025430'		PJS	QPC
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 9-7
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE PROCESSORS

	020474'	262040	000000		POP	S,0
	020475'	400200	000000		SETZ	V,
	020476'			UCRX:				;PUT DISPLACEMENT FIELD INTO RX1 OR RX2 INSTRUCTION
	020476'	616200	034261'		TDNN	V,[-1_16]
	020477'	254000	020506'		JRST	UCRX1
	020500'	274200	000007		SUB	V,OS		;RELATIVE TO P DISP
	020501'	270200	034262'		ADD	V,[1_43-2]	;CORRECT FOR UNINCREMENTED PC AND SIGN BIT OF OS
	020502'	311200	034261'		CAML	V,[-40000]	;IS IT TOO FAR BEHIND PC
	020503'	301200	040000		CAIL	V,40000		;IS IT TOO FAR BEYOND PC
	020504'	254000	020467'		JRST	UCRX0
	020505'	435200	100000		IORI	V,100000	;TELL CPU TO USE RX2 ADDRESSING
	020506'	137200	000010	UCRX1:	DPB	V,W
	020507'	254000	020464'		JRST	UCH1

	020510'	261040	000000	UCRX30:	PUSH	S,0
	020511'	200000	000007		MOVE	0,OS
	020512'	275000	000004		SUBI	0,4
	020513'	621000	400000		TLZ	0,400000
	020514'	260040	025430'		PJS	QPC
	020515'	262040	000000		POP	S,0
	020516'	400200	000000		SETZ	V,
	020517'			UCRX3:				;PUT 3 BYTE ADRS INTO RX3 INSTRUCTION
	020517'	603200	777700		TLNE	V,777700
	020520'	254000	020510'		JRST	UCRX30
	020521'	137200	000010		DPB	V,W		;MIDDLE AND RIGHT BYTE
	020522'	200400	000007		MOVE	W,OS
	020523'	275400	000001		SUBI	W,1
	020524'	260040	025610'		CA
	020525'	241200	777760		ROT	V,-20
	020526'	137200	000010		DPB	V,W		;LEFT BYTE
	020527'	254000	020464'		JRST	UCH1

	020530'	261040	000000	UCER1:	PUSH	S,0
	020531'	200000	000007		MOVE	0,OS
	020532'	621000	400000		TLZ	0,400000
	020533'	260040	025430'		PJS	QPC
	020534'	400200	000000		SETZ	V,
	020535'	262040	000000		POP	S,0
	020536'	263040	000000		RETURN


	020537'	200450	000001	UCY:	MOVE	X,1(W)
	020540'	200510	000000		MOVE	Y,(W)
	020541'	405500	000077		ANDI	Y,77
	020542'	626500	000040		TRZN	Y,40
	020543'	250440	000004		EXCH	X,V
	020544'	256012	020567'		XCT	UCX(Y)
	020545'	550500	000010	UCY2:	HRRZ	Y,W
	020546'	200410	000002		MOVE	W,2(W)
	020547'	250500	006600'		DFL	Y		;RETURN CELL "Y" TO FREE LIST
	020550'	552520	006600'
	020551'	254000	020431'		JRST	UC1

NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 9-8
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE PROCESSORS

	020552'	200510	000002	UCBF:	MOVE	Y,2(W)		;Point to cell with Engine address
	020553'	200012	000001		MOVE	0,1(Y)		;Get Engine address
	020554'	621000	400000		TLZ	0,400000	;P COUNTER
	020555'	274440	000000		SUB	X,0		;RELATIVE TO P DIFFERENCE
	020556'	606200	000400		TRNN	V,400
	020557'	210440	000011		MOVN	X,X		;BACKWARD OR FORWARD SHORT JUMP
	020560'	241440	777777		ROT	X,-1		;HALFWORD COUNTER
	020561'	636440	034263'		TDZN	X,[-20]
	020562'	254000	020565'		JRST	UCBF1		;MUST BE FOUR BITS
	020563'	260040	025430'		PJS	QPC		;QUE PC IN TABLE FOR ERROR OUTPUT IN TLE9A
	020564'	403200	000011		SETZB	V,X
	020565'	434200	000011	UCBF1:	IOR	V,X		;BUILD INSTRUCTION
	020566'	254000	020545'		JRST	UCY2

	020567'	460200	000011	UCX:	SETCM	V,X
	020570'	260040	025257'		CPF			;CAN NEVER BE IN UNDEFINED EXPRESSION
	020571'	200200	000011		MOVE	V,X		;UNARY PLUS
	020572'	210200	000011		MOVN	V,X		;UNARY MINUS
	020573'	270200	000011		ADD	V,X		;PLUS
	020574'	274200	000011		SUB	V,X
	020575'	260040	020604'		PJS	UCMUL
	020576'	230200	000011		IDIV	V,X
	020577'	404200	000011		AND	V,X
	020600'	434200	000011		IOR	V,X
	020601'	430200	000011		XOR	V,X
	020602'	242211	000000		LSH	V,(X)
	020603'	254000	020552'		JRST	UCBF

	020604'	261040	000005	UCMUL:	PUSH	S,U
	020605'	224200	000011		MUL	V,X
	020606'	332000	000004		SKIPE	V
	020607'	242200	000043		LSH	V,43
	020610'	434200	000005		IOR	V,U
	020611'	262040	000005		POP	S,U
	020612'	263040	000000		RETURN

	020613'	336000	000224'	UC9:	SKIPN	UCERC
	020614'	263040	000000		RETURN
	020615'	031000	034264'		PE	MSSD,[RETURN]

				;	PUT ANOTHER ELEMENT ON THE CHAIN THAT WILL BE
				;	FILLED LATER WHEN THE SYMBOL IS DEFINED. Y=SPECIAL COMPUTE CHAIN,
				;	DESTINATION FOR VALUE PTR IN VS. U RIGHT IS MEMORY INSTRUCTION TYPE (0-3).

	020616'	335600	006324'	SPLICE:	SKIPGE	M,UM		;M=0. NO SYMBOL TABLE ENTRY FOR THIS UNDEFINED SYMBOL.
	020617'	254000	020632'		JRST	SC1		;SPLICE INTO CHAIN
	020620'	332000	000014		SKIPE	M
	020621'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	020622'	261040	000005		PUSH	S,U
	020623'	504240	006330'		HRL	U,MODULE	;DEFINE SYMBOL
	020624'	661240	400000		TLO	U,SYUNDF
	020625'	200440	006322'		MOVE	X,UX		;get previous address from FY for MY
	020626'	200540	006323'		MOVE	L,UL
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 9-9
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE PROCESSORS

	020627'	400200	000000		SETZ	V,
	020630'	260040	020364'		PJS	MY
	020631'	262040	000005		POP	S,U
	020632'	331000	000777'	SC1:	SKIPL	LSTMSK		;only splice in pass 1
	020633'	254000	020654'		JRST	SCP2
	020634'	336420	006600'		GFL	
	020635'	260040	020656'
	020636'	250400	006600'			;Allocate a reference cell
	020637'	200440	000010		MOVE	X,W		;Save pointer to reference cell
	020640'	661400	400000		TLO	W,400000	;Mark as pointer to reference cell
	020641'	326500	020645'		JUMPN	Y,SC2		;THERE IS A COMPUTE CHAIN FOR THIS EXPRESSION
	020642'	250414	000002		EXCH	W,2(M)		;Have symbol table point to reference cell
	020643'	202411	000002		MOVEM	W,2(X)		;Have reference cell point to previous chain
	020644'	254000	020651'		JRST	SC3
	020645'	554540	000012	SC2:	HLRZ	L,Y
	020646'	250554	000002		EXCH	L,2(M)
	020647'	202551	000002		MOVEM	L,2(X)		;Have reference cell point to previous chain
	020650'	202412	000002		MOVEM	W,2(Y)		;Have new chain point to reference cell
	020651'	202251	000000	SC3:	MOVEM	U,(X)		;Save flag bits in reference cell
	020652'	202311	000001		MOVEM	VS,1(X)		;Save engine memory reference
	020653'	263040	000000		RETURN
	020654'	202500	003156'	SCP2:	MOVEM	Y,UCC		;save chain to be deleted at end of statement
	020655'	263040	000000		RETURN

				;
				; Get memory for free list of three word cells. Return with at least one
				; new cell on free list.
				;
	020656'	554400	013047'	GM:	HLRZ	W,MACFRE	; Get address of smallest block on free list
	020657'	336010	000001		SKIPN	1(W)		; Is it really a block?
	020660'	254000	020667'		JRST	GM1		; No. Need to get new memory
	020661'	261040	000011		PUSH	S,X		; Save registers for block remove
	020662'	261040	000012		PUSH	S,Y
	020663'	260040	020332'		PJS	REMBLK		; Remove block from free list
	020664'	262040	000012		POP	S,Y
	020665'	200450	000001		MOVE	X,1(W)		; Get number of cells in block
	020666'	254000	020701'		JRST	GM2		; Go link to free list
	020667'	550400	006605'	GM1:	HRRZ	W,YEND		; Get current end of memory
	020670'	271400	003000		ADDI	W,3000		; Allocate in multiples of 1000 cells
	020671'	607400	777777		TLNN	W,777777	; Is request past end of memory
	020672'	047400	000011		CORE	W,
	020673'	260040	020711'		PJS	GME		; Out of memory
	020674'	550400	006605'		HRRZ	W,YEND		; Get address of start of block
	020675'	271400	003000		ADDI	W,3000		; New address of end of memory
	020676'	250400	006605'		EXCH	W,YEND		; Set new memory end and get address of block
	020677'	261040	000011		PUSH	S,X		; Save register for count
	020700'	201440	001000		MOVEI	X,1000		; Number of cells allocated
	020701'	552420	006600'	GM2:	HRRZM	W,@FL		; Put cells at end of free list
	020702'	551410	000003	GM3:	HRRZI	W,3(W)		; Address of next cell, three words long
	020703'	552410	777775		HRRZM	W,-3(W)		; Have previous cell point to cell
	020704'	367440	020702'		SOJG	X,GM3		; Any more cells to link?
	020705'	262040	000011		POP	S,X		; Restore X
	020706'	402410	777775		SETZM	W,-3(W)		; Make last cell end of list
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 9-10
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE PROCESSORS

	020707'	550420	006600'		HRRZ	W,@FL		; Address of second cell on free list
	020710'	263040	000000	XPS:	RETURN
	020711'	031000	034265'	GME:	PE	MSOOM,ABORT

				;	Shadow Symbol Table Routines
				;
				;	Put an old definition in shadow symbol table.
				;	This is a symbol table entry that is in the symbol table and whose
				;	value is changing or who is being deleted.
				;	Called with M set to address of symbol table entry and
				;	L set to symbol name. Destroys registers W, X and V.
				;
	020712'	260040	020726'	SHOLD:	PJS	SHADOW		;is it already in shadow symbol table
	020713'	263040	000000		RETURN			;yes. only save on first change
	020714'	200214	000002		MOVE	V,2(M)		;get old value
	020715'	202210	000002		MOVEM	V,2(W)		;and save
	020716'	263040	000000		RETURN

				;	Put a new definition in shadow symbol table.
				;	This is a symbol that is being added to the symbol table.
				;	The symbol is marked in the shadow table is not being in the
				;	symbol table by setting bit 1 of the first word of the entry.
				;	Called with L set to symbol name and U set to module number.
				;	Destroys registers W, X and V.
				;
	020717'	261040	000014	SHNEW:	PUSH	S,M		;save to set flags
	020720'	500600	000005		HLL	M,U		;insert flags
	020721'	661600	200000		TLO	M,SYSHNU	;add not in table bit
	020722'	260040	020726'		PJS	SHADOW		;is it already in the shadow symbol table?
	020723'	255000	000000		JFCL			;yes. nothing to do
	020724'	262040	000014		POP	S,M
	020725'	263040	000000		RETURN

				;	Search shadow symbol table.
				;	Called with symbol name in L and module number in U.
				;	Skips if symbol not found and returns in W the address of
				;	the new table entry. Table entry has name set from L and value
				;	set from VS and flag bits set from the left half of M.
				;	Destroys registers W, X and V.
				;
	020726'	214400	000013	SHADOW:	MOVM	W,L		;hash symbol
	020727'	231400	002007		IDIVI	W,HASHSZ
	020730'	541211	010617'		HRRI	V,SHASHT(X)	;get address of shadow table word
	020731'	550440	000004	SHAD1:	HRRZ	X,V		;save previous pointer
	020732'	550204	000000		HRRZ	V,(V)		;get address of next entry
	020733'	322200	020743'		JUMPE	V,SHAD2		;symbol not in table
	020734'	312544	000001		CAME	L,1(V)		;is this the symbol?
	020735'	254000	020731'		JRST	SHAD1		;no. try next
	020736'	500404	000000		HLL	W,(V)		;get module number of entry
	020737'	430400	000014		XOR	W,M		;compare to old symbol
	020740'	603400	000077		TLNE	W,77
	020741'	254000	020731'		JRST	SHAD1		;no, try next
	020742'	263040	000000		RETURN			;symbol found. exit
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 9-11
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE PROCESSORS

	020743'	336420	006600'	SHAD2:	GFL
	020744'	260040	020656'
	020745'	250400	006600'
	020746'	542411	000000		HRRM	W,(X)		;put new entry in shadow table
	020747'	512610	000000		HLLZM	M,(W)		;set flag bits
	020750'	202550	000001		MOVEM	L,1(W)		;set name
	020751'	350001	000000		AOS	(S)		;skip return to signify not found
	020752'	263040	000000		RETURN

				;	Begin shadow symbol table.
				;	Set switch to create shadow table only if there will be a second pass.
				;
	020753'	606640	000010	SHBEG:	TRNN	F,LPASS2	;will there be a second pass?
	020754'	263040	000000		RETURN			;no. no shadow table
	020755'	660640	200000		TRO	F,MKSHAD	;set make shadow bit
	020756'	200400	034266'		MOVE	W,[XWD SHASHT,SHASHT+1]
	020757'	402000	010617'		SETZM	SHASHT		;zero shadow table
	020760'	251400	012625'		BLT	W,ESYH-1
	020761'	263040	000000		RETURN

				;	Prepass 2 shadow table processing.
				;	Restore symbol table to its state at beginning of pass 1.
				;
	020762'	620640	200000	SHMID:	TRZ	F,MKSHAD	;clear make shadow table flag
	020763'	211500	002007		MOVNI	Y,HASHSZ	;negative table size to Y
	020764'	550352	012626'	SHMID1:	HRRZ	OS,ESYH(Y)	;get shadow table word
	020765'	322340	021023'	SHMID2:	JUMPE	OS,SHMID5	;no entries for this word.
	020766'	500347	000000		HLL	OS,(OS)		;get flag bits
	020767'	200547	000001		MOVE	L,1(OS)		;get symbol name
	020770'	135240	034267'		LDB	U,[POINT 6,OS,17]	;get module number
	020771'	200405	032632'		MOVE	W,LBIT(U)	;get module mask bit
	020772'	202400	006326'		MOVEM	W,MM1		;and set for FY
	020773'	260040	020203'		PJS	FY		;find symbol in symbol table
	020774'	326600	021010'		JUMPN	M,SHMID3	;jump if symbol in symbol table
	020775'	603340	200000		TLNE	OS,SYSHNU	;was it in table when put in shadow
	020776'	254000	021021'		JRST	SHMID4		;no leave shadow and symbol tables alone
	020777'	510240	000007		HLLZ	U,OS		;get flag bits for MY
	021000'	621340	777700		TLZ	OS,777700	;clear all but module number in flag bits
	021001'	661340	200000		TLO	OS,SYSHNU	;set new symbol bit
	021002'	502347	000000		HLLM	OS,(OS)		;and set shadow table
	021003'	200207	000002		MOVE	V,2(OS)		;get old value
	021004'	603240	400000		TLNE	U,SYUNDF	;is value undefined chain?
	021005'	400200	000000		SETZ	V,		;yes. restore as empty chain
	021006'	260040	020364'		PJS	MY		;and put back in symbol table
	021007'	254000	021021'		JRST	SHMID4
	021010'	502354	000000	SHMID3:	HLLM	OS,(M)		;restore flag bits
	021011'	502607	000000		HLLM	M,(OS)		;save new flag bits
	021012'	250207	000002		EXCH	V,2(OS)		;save new value and get old one
	021013'	603340	400000		TLNE	OS,SYUNDF	;is it undefined?
	021014'	400200	000000		SETZ	V,		;yes. store a null chain
	021015'	202214	000002		MOVEM	V,2(M)		;restore old value
	021016'	400400	000000		SETZ	W,
	021017'	603340	200000		TLNE	OS,SYSHNU	;should symbol be removed from table?
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 9-12
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE PROCESSORS

	021020'	260040	020157'		PJS	RY		;yes. do it
	021021'	550347	000000	SHMID4:	HRRZ	OS,(OS)		;get next entry
	021022'	254000	020765'		JRST	SHMID2
	021023'	341500	020764'	SHMID5:	AOJL	Y,SHMID1
	021024'	263040	000000		RETURN

				;	Finish shadow table.
				;	Restore any undefined chains from end of pass 1 and insure
				;	that there are no problems.
				;
	021025'	211500	002007	SHEND:	MOVNI	Y,HASHSZ	;negative table size
	021026'	550352	012626'	SHEND1:	HRRZ	OS,ESYH(Y)	;get first entry
	021027'	322340	021072'	SHEND2:	JUMPE	OS,SHEND8	;no more entries, get next word
	021030'	500347	000000		HLL	OS,(OS)
	021031'	200547	000001		MOVE	L,1(OS)		;get symbol name
	021032'	135240	034267'		LDB	U,[POINT 6,OS,17]	;get module number
	021033'	200405	032632'		MOVE	W,LBIT(U)	;module mask bit
	021034'	202400	006326'		MOVEM	W,MM1		;store for FY
	021035'	260040	020203'		PJS	FY		;find symbol in symbol table
	021036'	326600	021042'		JUMPN	M,SHEND3	;jump if in symbol table
	021037'	607340	200000		TLNN	OS,SYSHNU	;is it in shadow table
	021040'	260040	021074'		PJS	SHBUG		;yes. error
	021041'	254000	021065'		JRST	SHEND7		;no. ok
	021042'	603340	200000	SHEND3:	TLNE	OS,SYSHNU	;is it in shadow?
	021043'	260040	021074'		PJS	SHBUG		;no. error
	021044'	200240	000007		MOVE	U,OS		;get flag bits for compare
	021045'	430240	000014		XOR	U,M		;compare flags
	021046'	603240	777777		TLNE	U,777777	;are they the same?
	021047'	260040	021074'		PJS	SHBUG		;no. error
	021050'	321600	021056'		JUMPL	M,SHEND5	;jump if value not defined in symbol table.
	021051'	603400	100000		TLNE	W,100000	;is it a macro?
	021052'	254000	021062'		JRST	SHEND6		;yes. dont compare values directly
	021053'	312207	000002		CAME	V,2(OS)	;are values the same?
	021054'	260040	021074'	SHEND4:	PJS	SHBUG		;no. error
	021055'	254000	021065'		JRST	SHEND7		;yes. ok
	021056'	326200	021054'	SHEND5:	JUMPN	V,SHEND4	;undefined value better be zero
	021057'	200207	000002		MOVE	V,2(OS)		;restore undefined chain
	021060'	202214	000002		MOVEM	V,2(M)
	021061'	254000	021065'		JRST	SHEND7
	021062'	554407	000002	SHEND6:	HLRZ	W,2(OS)			;delete macro body
	021063'	135200	034270'		LDB	V,[POINT 9,2(OS),26]
	021064'	260040	020337'		PJS	REMAC
	021065'	550400	000007	SHEND7:	HRRZ	W,OS
	021066'	550347	000000		HRRZ	OS,(OS)		;get next entry
	021067'	250400	006600'		DFL	W
	021070'	552420	006600'
	021071'	254000	021027'		JRST	SHEND2
	021072'	341500	021026'	SHEND8:	AOJL	Y,SHEND1
	021073'	263040	000000		RETURN

	021074'	035000	034271'	SHBUG:	TYPE	<$Shadow table error for: >
	021075'	200247	000001		MOVE	U,1(OS)
	021076'	260040	022000'		PJS	TYP6		;print name
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 9-13
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE PROCESSORS

	021077'	322600	021106'		JUMPE	M,SHBUG1
	021100'	035000	034277'		TYPE	<$Symbol table: >
	021101'	554254	000000		HLRZ	U,(M)		;flag bits
	021102'	260040	022042'		PJS	TOCT
	021103'	051700	000040		OUTCHI	" "
	021104'	200254	000002		MOVE	U,2(M)		;value
	021105'	260040	022042'		PJS	TOCT
	021106'	035000	034303'	SHBUG1:	TYPE	<$Shadow table: >
	021107'	554247	000000		HLRZ	U,(OS)		;flag bits
	021110'	260040	022042'		PJS	TOCT
	021111'	051700	000040		OUTCHI	" "
	021112'	200247	000002		MOVE	U,2(OS)		;value
	021113'	260040	022042'		PJS	TOCT
	021114'	263040	000000		RETURN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 10
NAD01.R06	24-JUL-87 17:39		FILE HANDLER AND PAGE SWAPPER

					SUBTTL	FILE HANDLER AND PAGE SWAPPER
				;		**************************************************


				;	Get a file name.
				;
				;	This routine has two entry points
				;		GFN if the file name comes from the command stream and
				;			is terminated with a carriage return and
				;		GFNX if the input source and the terminator is specified by the caller.
				;
				;	Scanning for a file name will terminate unsuccessfully on three
				;	conditions, one, scanning the terminator in the middle of a username
				;	or before a name is given, two, scanning a question mark anywhere,
				;	three, scanning a second period in the name or a nonletter
				;	or digit in the name. A successful file name must be of the
				;	following form (where [...] means that ... is optional)
				;
				;		[(username)]name[.[extension]]
				;
				;	where username is any string not containing the terminator, a question
				;	mark or a right parenthesis and name and extension are strings of at
				;	least one character consisting of only letters or digits.
				;
				;	Input-
				;		GFN - None
				;		GFNX - C: terminator
				;		      VS: instruction which when eXeCuTed returns the next
				;				character in W
				;
				;	Output-
				;		L: name of one to six charcaters
				;		M: extension of zero to three characters
				;		X: first word of user name or 0
				;		Y: second word of user name
				;		U: -1 if . scanned before extension, otherwise 0
				;
				;	Registers used- OS, W, VS, C
				;
				;
	021115'	200300	034307'	GFN:	MOVE	VS,[XCT GCHI]	;setup to scan command stream
	021116'	201140	000015		MOVEI	C,15		; and terminate on carriage return
	021117'	403540	000014	GFNX:	SETZB	L,M		;zero name and extension
	021120'	403440	000012		SETZB	X,Y		;zero user name
	021121'	400240	000000		SETZ	U,		;and period flag
	021122'	256000	000006		XCT	VS		;get first character of file name
	021123'	302400	000050		CAIE	W,"("		;does it start with a user name?
	021124'	254000	021146'		JRST	GFN3		;no
	021125'	200340	034310'		MOVE	OS,[POINT 6,X]	;store name in X and Y
	021126'	256000	000006	GFN1:	XCT	VS		;get next character of user name
	021127'	306400	000051		CAIN	W,")"		;is it the end?
	021130'	254000	021145'		JRST	GFN2		;yes
	021131'	312400	000003		CAME	W,C		;is it the terminator or
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 10-2
NAD01.R06	24-JUL-87 17:39		FILE HANDLER AND PAGE SWAPPER

	021132'	306400	000077		CAIN	W,"?"		; a question mark?
	021133'	263040	000000		RETURN			;yes, fail
	021134'	316340	034311'		CAMN	OS,[POINT 6,X+1,35]	;have twelve characters been scanned?
	021135'	254000	021126'		JRST	GFN1		;yes, ignore this one
	021136'	301400	000141		CAIL	W,"a"		;lower case?
	021137'	303400	000172		CAILE	W,"z"
	021140'	334000	000000		SKIPA
	021141'	275400	000040		SUBI	W,40		;yes, convert to uppper
	021142'	275400	000040		SUBI	W,40		;convert to sixbit
	021143'	136400	000007		IDPB	W,OS		;and save in username
	021144'	254000	021126'		JRST	GFN1		;go scan next character
	021145'	256000	000006	GFN2:	XCT	VS		;get first name character after user name
	021146'	200340	034247'	GFN3:	MOVE	OS,[POINT 6,L]	;put name in L
	021147'	316400	000003	GFN4:	CAMN	W,C		;is it the terminator?
	021150'	254000	021201'		JRST	GFN7		;yes. go end scan
	021151'	306400	000056		CAIN	W,"."		;is it the start of the extension?
	021152'	254000	021174'		JRST	GFN6		;yes. go start it
	021153'	301400	000060		CAIL	W,"0"		;is it a digit
	021154'	303400	000071		CAILE	W,"9"
	021155'	334000	000000		SKIPA
	021156'	254000	021167'		JRST	GFN5		;yes. go add to file name
	021157'	301400	000101		CAIL	W,"A"		;is it an upper case letter?
	021160'	303400	000132		CAILE	W,"Z"
	021161'	334000	000000		SKIPA
	021162'	254000	021167'		JRST	GFN5		;yes. go store it in file name
	021163'	301400	000141		CAIL	W,"a"		;is it a lower case letter?
	021164'	303400	000172		CAILE	W,"z"
	021165'	263040	000000		RETURN			;no. invalid character in name or extension
	021166'	275400	000040		SUBI	W,40		;convert to upper case
	021167'	275400	000040	GFN5:	SUBI	W,40		;convert to sixbit
	021170'	603340	770000		TLNE	OS,770000	;anymore room for character?
	021171'	136400	000007		IDPB	W,OS		;yes
	021172'	256000	000006		XCT	VS		;get next character
	021173'	254000	021147'		JRST	GFN4		;and go scan it
	021174'	321240	034240'	GFN6:	JUMPL	U,[RETURN]	;fail if period already scanned
	021175'	474240	000000		SETO	U,		;flag period scanned
	021176'	200340	034312'		MOVE	OS,[POINT 6,M,17]	;set up to store extension
	021177'	256000	000006		XCT	VS		;get first character of extension
	021200'	254000	021147'		JRST	GFN4
	021201'	207000	000014	GFN7:	MOVSS	M		;put extension in left half
	021202'	322540	034240'		JUMPE	L,[RETURN]	;fail if no name given
	021203'	350001	000000		AOS	(S)		;skip return on success
	021204'	263040	000000		RETURN

	021205'			OIF:				;OPEN INPUT FILE
	021205'	621640	010000		TLZ	F,EOFF
	021206'	476000	000775'		SETOM	DMSCTR
	021207'	200500	000733'		MOVE	Y,IBF0
	021210'	271500	002010		ADDI	Y,NSB*201
	021211'	202500	016167*		MOVEM	Y,.JBFF		;START OF RING
	021212'	050400	002304'		OPEN	ICH,ISPEC
	021213'	254000	021253'		JRST	OIFE
	021214'	402000	002323'		SETZM	IL+4		;clear lookup block
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 10-3
NAD01.R06	24-JUL-87 17:39		FILE HANDLER AND PAGE SWAPPER

	021215'	403400	002324'		SETZB	W,IL+5
	021216'	332000	002315'		SKIPE	ILUSR
	021217'	551400	002315'		HRRZI	W,ILUSR
	021220'	202400	002320'		MOVEM	W,IL+1		;store address of user name or zero if no user name
	021221'	076400	002317'		LOOKUP	ICH,IL
	021222'	254000	021253'		JRST	OIFE
	021223'	200400	000776'		MOVE	W,LSPACE
	021224'	064410	000030		INBUF	ICH,IINBUF(W)
	021225'	066400	000000		INPUT	ICH,
	021226'	062400	000011		GETSTS	ICH,X
	021227'	602440	020000		TRNE	X,20000
	021230'	254000	021726'		JRST	ITEOF
	021231'	602440	740000		TRNE	X,740000
	021232'	254000	021732'		JRST	ITIOER
	021233'	200500	000733'		MOVE	Y,IBF0
	021234'	505500	000000		HRLI	Y,CHRIT_13
	021235'	201440	000010		MOVEI	X,NSB		;INITIALIZE SIDE RING
	021236'	271500	000201		ADDI	Y,201
	021237'	202512	777777		MOVEM	Y,-1(Y)
	021240'	367440	021236'		SOJG	X,.-2
	021241'	540440	000733'		HRR	X,IBF0
	021242'	542452	777777		HRRM	X,-1(Y)		;WRAP AROUND POINTER
	021243'	552440	003242'		HRRZM	X,PTB		;POINTER TO TRAILING BFR (WHICH HAPPENS TO BE EMPTY)
	021244'	271440	000201		ADDI	X,201
	021245'	552440	003243'		HRRZM	X,PAB		;ACTIVE BFR.REG. IT WILL POINT TO END OF PAB
	021246'	271440	000201		ADDI	X,201
	021247'	552440	003244'		HRRZM	X,PLB		;LEADING BFR JUST BEYOND END OF PAB
	021250'	541111	777777		HRRI	I,-1(X)
	021251'	505100	440700		HRLI	I,(POINT 7,0)	;RECEIVE TRP CHR ON 1ST ILDB C,I
	021252'	334400	000001		SKIPA	W,S		;SET W NON ZERO FOR NO ERROR SIGNAL
	021253'	400400	000000	OIFE:	SETZ	W,
	021254'	263040	000000		RETURN

	021255'	070400	000000	CIF:	CLOSE	ICH,
	021256'	071400	000000		RELEASE	ICH,
	021257'	402000	002325'		SETZM	IH
	021260'	263040	000000		RETURN

	021261'			OJF:				;OPEN OBJECT FILE
	021261'	050500	000734'		OPEN	JCH,JSPEC
	021262'	254000	021276'		JRST	OJFE
	021263'	120200	002307'		DMOVE	V,OBJNAM
	021264'	124200	002311'	OJF1:	DMOVEM	V,JE
	021265'	402000	002313'		SETZM	JE+2
	021266'	402000	002314'		SETZM	JE+3		;SETUP ENTER
	021267'	077500	002311'		ENTER	JCH,JE
	021270'	334000	000000		SKIPA
	021271'	263040	000000		RETURN
	021272'	606200	000017		TRNN	V,17
	021273'	254000	021276'		JRST	OJFE
	021274'	370000	000004		SOS	V
	021275'	254000	021264'		JRST	OJF1		;FILE NAME IN USE. TRY ANOTHER NAME.
	021276'	035000	034313'	OJFE:	TYPE	<$Can't open object file>
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 10-4
NAD01.R06	24-JUL-87 17:39		FILE HANDLER AND PAGE SWAPPER

	021277'	254000	016772'		JRST	NADAB

	021300'	332000	002301'	OLF:	SKIPE	LOH		;DON'T OPEN IF ALREADY OPEN.
	021301'	263040	000000		RETURN
	021302'	050440	000754'		OPEN	LCH,LSPEC	;OPEN LISTING FILE CHANNEL
	021303'	254000	021325'		JRST	OLFE
	021304'	332000	002275'		SKIPE	LE		;HAS FILE NAME BEEN SET?
	021305'	254000	021313'		JRST	OLF1		;yes
	021306'	200200	002321'		MOVE	V,IL+2		;NO. USE INPUT FILE NAME.
	021307'	200240	034320'		MOVE	U,[SIXBIT /CRF/]
	021310'	606700	000004		TRNN	F2,CRFLST
	021311'	200240	034321'		MOVE	U,[SIXBIT /LST/]
	021312'	124200	002275'		DMOVEM	V,LE
	021313'	403400	002277'	OLF1:	SETZB	W,LE+2
	021314'	332000	002273'		SKIPE	LEUSR		;was a user name given?
	021315'	551400	002273'		HRRZI	W,LEUSR		;yes. refer to it.
	021316'	202400	002300'		MOVEM	W,LE+3
	021317'	077440	002275'		ENTER	LCH,LE
	021320'	254000	021325'		JRST	OLFE
	021321'	065440	000010		OUTBUF	LCH,NLBF
	021322'	067440	000000		OUTPUT	LCH,
	021323'	620640	002000		TRZ	F,INCREF	;CLEAR IN CREF CODE FLAG
	021324'	263040	000000		RETURN
	021325'	035000	034322'	OLFE:	TYPE	<$Can't open listing file>
	021326'	254000	016772'		JRST	NADAB

	021327'	606700	000002	CLF:	TRNN	F2,MLTLST	;CLOSE LIST FILE UNLESS MULTI FILE LIST
	021330'	336000	002301'		SKIPN	LOH		;OR FILE NOT OPEN.
	021331'	263040	000000		RETURN
	021332'	067440	000000		OUTPUT	LCH,
	021333'	070440	000000		CLOSE	LCH,
	021334'	071440	000000		RELEAS	LCH,
	021335'	402000	002301'		SETZM	LOH
	021336'	602700	000004		TRNE	F2,CRFLST	;IS THIS A CREF LISTING?
	021337'	260040	021341'		PJS	CROSS		;YES. INFORM CROSS OF IT.
	021340'	263040	000000		RETURN

	021341'			CROSS:
				;	CONSTRUCT TMP FILE NAME INCASE NEED TO PUT CROSS REQUEST ON DISK.
				;	FILE NAME IS 'NNNCRE.TMP' WHERE NNN IS JOB NUMBER.
	021341'	201400	000764'		MOVEI	W,TE		;ADDRESS FILENAME WORD IN FILE SPEC
	021342'	505400	440600		HRLI	W,(POINT 6,0)	;CONSTRUCT BYTE POINTER TO IT
	021343'	047440	000030		PJOB	X,		;GET JOB NUMBER
	021344'	231440	000144		IDIVI	X,^D100		;CONVERT TO SIXBIT
	021345'	271440	000020		ADDI	X,'0'
	021346'	136440	000010		IDPB	X,W		;AND PUT IN FILE NAME
	021347'	200440	000012		MOVE	X,Y
	021350'	231440	000012		IDIVI	X,^D10
	021351'	271440	000020		ADDI	X,'0'
	021352'	136440	000010		IDPB	X,W
	021353'	271500	000020		ADDI	Y,'0'
	021354'	136500	000010		IDPB	Y,W
				;	FIRST CHECK IF THERE ALREADY IS A TMPCOR FILE OF CROSS
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 10-5
NAD01.R06	24-JUL-87 17:39		FILE HANDLER AND PAGE SWAPPER

				;	REQUESTS. TMPCOR FILE NAME IS 'CRE'. THIS IS DONE BY READING
				;	THE FILE WITH A ZERO LENGTH BUFFER. IF IT IS THERE, THE SIZE OF
				;	THE FILE WILL ALSO BE RETURNED.
	021355'	515440	436245		HRLZI	X,'CRE'		;MAKE TMPCOR COMMAND FROM 
	021356'	551500	000012		HRRZI	Y,Y		; REGISTER PAIR (X,Y)
	021357'	541400	000011		HRRI	W,X		;ADDRESS TMPCOR COMMAND
	021360'	505400	000001		HRLI	W,1		; AND DO A READ.
	021361'	047400	000044		TMPCOR	W,
	021362'	254000	021437'		JRST	CROSS6		;NO TMPCOR FILE. TRY DISK.
	021363'	260040	021470'		PJS	CRSBUF		;ALLOCATE CROSS BUFFER.
	021364'	541400	000011		HRRI	W,X		;ADDRESS TMPCOR COMMAND
	021365'	505400	000002		HRLI	W,2		;DO A READ AND DELETE.
	021366'	047400	000044		TMPCOR	W,
	021367'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
				;	AT THIS POINT, OLD REQUEST FILE IS IN MEMORY STARTING AT "YEND",
				;	THE BUFFER ALLOCATED HAS ROOM FOR TWO MORE WORDS FOR NEW REQUEST,
				;	THE OLD FILE HAS BEEN DELETED, "Y" CONTAINS AN IOWD
				;	WORD FOR OLD FILE(NOT INCLUDING TWO WORDS FOR NEW REQUEST)
				;	AND "L" CONTAINS ADDRESS OF END OF FULL BUFFER (INCLUDING THE TWO
				;	NEW WORDS) PLUS ONE. FIRST ADD NEW REQUEST AND THEN
				;	TRY TO WRITE A NEW TMPCOR FILE. IF THIS FAILS, WRITE BUFFER
				;	TO DISK.
	021370'	274500	034327'	CROSS1:	SUB	Y,[2,,0]	;HAVE "Y" REFERENCE FULL BUFFER.
	021371'	541403	777776		HRRI	W,-2(C)		;ADDRESS TWO WORDS FOR NEW REQUEST.
	021372'	402010	000000		SETZM	(W)		;SET NEW WORDS TO ALL NULLS.
	021373'	402010	000001		SETZM	1(W)
	021374'	505400	440700		HRLI	W,(POINT 7,0)	;CONSTRUCT BYTE POINTER TO NEW WORDS.
	021375'	201140	000137		MOVEI	C,"_"		;MAKE REQUEST "_FILENAME"
	021376'	136140	000010		IDPB	C,W
	021377'	201540	002275'		MOVEI	L,LE		;ADDRESS CREF FILE NAME
	021400'	505540	440600		HRLI	L,(POINT 6,0)	;CONSTRUCT BYTE POINTER TO FILE NAME
	021401'	134140	000013	CROSS2:	ILDB	C,L		;GET NEXT CHARACTER OF FILE NAME
	021402'	322140	021407'		JUMPE	C,CROSS3	;STOP AT BLANK
	021403'	271140	000040		ADDI	C,40		;CONVERT FROM SIXBIT TO ASCII
	021404'	136140	000010		IDPB	C,W		;PUT IN NEW REQUEST
	021405'	603540	770000		TLNE	L,770000	;END OF FILE NAME?
	021406'	254000	021401'		JRST	CROSS2		;NO
	021407'	201140	000015	CROSS3:	MOVEI	C,15		;END REQUEST WITH CARRIAGE RETURN
	021410'	136140	000010		IDPB	C,W
	021411'	201140	000012		MOVEI	C,12		; AND A LINEFEED.
	021412'	136140	000010		IDPB	C,W
	021413'	541400	000011		HRRI	W,X		;ADDRESS TMPCOR COMMAND
	021414'	505400	000003		HRLI	W,3		;DO A WRITE.
	021415'	047400	000044		TMPCOR	W,
	021416'	254000	021424'		JRST	CROSS5		;NO ROOM. GO TRY DISK FILE.
	021417'	200400	006605'	CROSS4:	MOVE	W,YEND		;GET OLD END OF MEMORY
	021420'	607400	777777		TLNN	W,777777	; Is request past end of memory
	021421'	047400	000011		CORE	W,		;AND RESET.
	021422'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	021423'	263040	000000		RETURN
	021424'	050600	000757'	CROSS5:	OPEN	TCH,TSPEC	;ASSIGN CHANNEL IN DUMP MODE
	021425'	254000	021466'		JRST	CROSSE
	021426'	403400	000766'		SETZB	W,TE+2		;CLEAR ENTER BLOCK
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 10-6
NAD01.R06	24-JUL-87 17:39		FILE HANDLER AND PAGE SWAPPER

	021427'	402000	000767'		SETZM	TE+3
	021430'	542400	000765'		HRRM	W,TE+1
	021431'	077600	000764'		ENTER	TCH,TE		;CREATE NEW FILE.
	021432'	254000	021466'		JRST	CROSSE
	021433'	400540	000000		SETZ	L,		;SET END OF DUMP COMMAND LIST
	021434'	067600	000012		OUTPUT	TCH,Y		;WRITE REQUESTS
	021435'	071600	000000		RELEASE	TCH,		;CLOSE FILE
	021436'	254000	021417'		JRST	CROSS4		;GO RELEASE BUFFER AND EXIT
				;	NO TMPCOR FILE. CHECK IF DISK FILE EXISTS. IF SO, READ IT IN 
				;	AND DELETE IT. IF NOT, JUST ALLOCATE BUFFER SPACE FOR NEW REQUEST.
	021437'	050600	000757'	CROSS6:	OPEN	TCH,TSPEC
	021440'	254000	021466'		JRST	CROSSE
	021441'	403400	000763'		SETZB	W,TL+1		;CLEAR ENTER BLOCK
	021442'	402000	000766'		SETZM	TL+4
	021443'	402000	000767'		SETZM	TL+5
	021444'	542400	000765'		HRRM	W,TL+3
	021445'	076600	000762'		LOOKUP	TCH,TL		;OPEN FOR INPUT
	021446'	254000	021463'		JRST	CROSS7		;NO TMPCOR OR DISK FILE.
	021447'	200400	000767'		MOVE	W,TLSIZE	;GET FILE SIZE IN WORDS.
	021450'	260040	021470'		PJS	CRSBUF		;ALLOCATE REQUEST BUFFER
	021451'	400540	000000		SETZ	L,		;SET END OF DUMP COMMAND LIST
	021452'	066600	000012		INPUT	TCH,Y		;READ OLD REQUEST FILE
	021453'	402000	000770'		SETZM	TR		;CLEAR RENAME BLOCK
	021454'	402000	000771'		SETZM	TR+1
	021455'	402000	000772'		SETZM	TR+2
	021456'	402000	000773'		SETZM	TR+3
	021457'	055600	000770'		RENAME	TCH,TR		;DELETE OLD FILE
	021460'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	021461'	071600	000000		RELEAS	TCH,
	021462'	254000	021370'		JRST	CROSS1		;GO CREATE NEW REQUEST FILE
	021463'	400400	000000	CROSS7:	SETZ	W,		;NO OLD REQUEST
	021464'	260040	021470'		PJS	CRSBUF		;ALLOCATE BUFFER
	021465'	254000	021370'		JRST	CROSS1		;AND GO WRITE NEW REQUEST.
	021466'	035000	034330'	CROSSE:	TYPE	<$Can't open CREF temp file>
	021467'	254000	016772'		JRST	NADAB

				;	USE SIZE RETURNED TO ALLOCATE A BUFFER FOR FILE. GET AN
				;	EXTRA TWO WORDS FOR NEW CROSS REQUEST. "Y" WILL CONTAIN AN IOWD
				;	WORD FOR BUFFER. THIS WILL BE USED BOTH TO READ TMPCOR FILE AND
				;	DISK FILE.
	021470'	210500	000010	CRSBUF:	MOVN	Y,W		;NEGATE FILE SIZE FOR IOWD WORD.
	021471'	504500	000012		HRL	Y,Y		;AND PUT IN LEFT HALF.
	021472'	540500	006605'		HRR	Y,YEND		;ADDRESS END OF MEMORY FOR BUFFER.
	021473'	275500	000001		SUBI	Y,1		;USE ADDRESS MINUS 1 FOR IOWD.
	021474'	270400	006605'		ADD	W,YEND		;ALLOCATE BUFFER FOR FILE
	021475'	271400	000002		ADDI	W,2		;PLUS TWO WORDS FOR NEW REQUEST.
	021476'	200140	000010		MOVE	C,W		;SAVE END OF BUFFER TO ADD NEW REQUEST.
	021477'	607400	777777		TLNN	W,777777	; Is request past end of memory?
	021500'	047400	000011		CORE	W,
	021501'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	021502'	263040	000000		RETURN

				;	SET UP NEW ID BLOCK FOR NIB FILE.
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 10-7
NAD01.R06	24-JUL-87 17:39		FILE HANDLER AND PAGE SWAPPER

	021503'	201400	002332'	IIDB:	MOVEI	W,IBID
	021504'	403200	000005		SETZB	V,U		;ZERO OUT BLOCK
	021505'	124210	000000	IID1:	DMOVEM	V,(W)
	021506'	271400	000002		ADDI	W,2
	021507'	307400	002531'		CAIG	W,IBIDC		;END OF BLOCK?
	021510'	254000	021505'		JRST	IID1		;NO, KEEP ZEROING
	021511'	201600	002332'		MOVEI	M,IBID
	021512'	200200	002750'		MOVE	V,BAD		;GET BLOCK ADDRESS
	021513'	137200	002734'		DPB	V,IBBADP	;PUT IN HEADER
	021514'	350000	002750'		AOS	BAD
	021515'	201200	000001		MOVEI	V,IDTYP
	021516'	137200	002733'		DPB	V,IBTYPP	;PUT TYPE IN HEADER
	021517'	474200	000000		SETO	V,
	021520'	202200	002333'		MOVEM	V,IBPSA		;SET UNDEFINED PROGRAM START ADDRESS
	021521'	047200	000014		DATE	V,
	021522'	202200	002334'		MOVEM	V,IBDATE	;SET UP DATE
	021523'	047200	000023		MSTIME	V,
	021524'	202200	002335'		MOVEM	V,IBTIME	;SET UP TIME
	021525'	120200	000744'		DMOVE	V,BL+2
	021526'	124200	002340'		DMOVEM	V,IBFILE	;SET UP FILENAME
	021527'	200200	034336'		MOVE	V,[-1,,.GTUNM]	;GET LOGGED IN USERNAME
	021530'	047200	000041		GETTAB	V,
	021531'	310000	000000		CAM			;IGNORE ERRORS
	021532'	200240	034337'		MOVE	U,[-1,,.GTUN1]	;SECOND HALF
	021533'	047240	000041		GETTAB	U,
	021534'	310000	000000		CAM			;IGNORE ERRORS
	021535'	124200	002342'		DMOVEM	V,IBAUTH	;SET UP AUTHOR
	021536'	201400	002344'		MOVEI	W,IBRIX
	021537'	202400	002745'		MOVEM	W,IBRIXP	;POINT TO START OF INDEX
	021540'	263040	000000		RETURN

				;	UPDATE IMAGE BINARY ID RECORD.
	021541'	200200	002745'	UBID:	MOVE	V,IBRIXP
	021542'	336000	002747'		SKIPN	BFSW		;CAN FILE BE UPDATED?
	021543'	307200	002344'		CAIG	V,IBRIX		;ANYTHING TO OUTPUT?
	021544'	263040	000000		RETURN			;NO
	021545'	201600	002332'		MOVEI	M,IBID
	021546'	135200	002734'		LDB	V,IBBADP	;GET BLOCK ADDRESS
	021547'	075544	000001		USETO	BCH,1(V)	;POSITION FILE
	021550'	067540	034340'		OUTPUT	BCH,[BYTE (18)-200,IBID-1,0,0]	;OUTPUT ID BLOCK
	021551'	263040	000000		RETURN

	021552'	261040	000004	SWAP:	BAR	<L,V,U,Y>	;PAGE REFERENCE MACRO CALLED SWAPPER. FETCH PAGE FROM DISC.
	021553'	261040	000005
	021554'	261040	000012
	021555'	261040	000013
	021556'	260040	021564'
	021557'	262040	000013
	021560'	262040	000012
	021561'	262040	000005
	021562'	262040	000004
	021563'	263040	000000
	021564'	350000	000774'		AOS	SWAPC
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 10-8
NAD01.R06	24-JUL-87 17:39		FILE HANDLER AND PAGE SWAPPER

	021565'	336000	002311'		SKIPN	JE
	021566'	260040	021261'		PJS	OJF		;OPEN OBJECT FILE IF UNOPENED
	021567'	200540	003155'		MOVE	L,SWRAN
	021570'	241540	000003		ROT	L,3
	021571'	202540	003155'		MOVEM	L,SWRAN
	021572'	405540	000003		ANDI	L,3
	021573'	211240	000200		MOVNI	U,NPGD
	021574'	200500	003246'		MOVE	Y,LPG
	021575'	200200	034123'		MOVE	V,[PJS SWAP]
	021576'	316205	013047'	SW1:	CAMN	V,PGT+NPGD(U)
	021577'	341240	021576'		AOJL	U,SW1
	021600'	302505	000200		CAIE	Y,NPGD(U)	;DONT SWAP OUT LAST PAGE REFERENCED
	021601'	361540	021603'		SOJL	L,.+2		;USE THIS PAGE
	021602'	344240	021576'		AOJA	U,SW1

	021603'	540545	013047'		HRR	L,PGT+NPGD(U)	;MEMORY ADRS OF BEGINNING OF PAGE
	021604'	211500	000020		MOVNI	Y,PGSIZ/200	;NUMBER OF PHYSICAL WRITES NECESSARY
	021605'	275540	000001		SUBI	L,1		;CP ADR MUST BE ONE LESS THAN MEMORY BLOCK
	021606'	542552	012646'	SW2:	HRRM	L,CP+PGSIZ/200(Y)	;MAKE A WORD IN CHANNEL PROGRAM
	021607'	271540	000200		ADDI	L,200
	021610'	341500	021606'		AOJL	Y,SW2

	021611'	201505	000200		MOVEI	Y,NPGD(U)	;NAD FILE PAGE NUMBER
	021612'	221500	000020		IMULI	Y,PGSIZ/200	;DEC DISC BLOCK INDEX
	021613'	075512	000001		USETO	JCH,1(Y)
	021614'	067500	012626'		OUTPUT	JCH,CP		;SWAP OUT A PAGE
	021615'	200500	000011		MOVE	Y,X
	021616'	221500	000020		IMULI	Y,PGSIZ/200
	021617'	074512	000001		USETI	JCH,1(Y)
	021620'	066500	012626'		INPUT	JCH,CP		;SWAP IN THE PAGE
	021621'	062500	000012		GETSTS	JCH,Y
	021622'	626500	640000		TRZN	Y,640000
	021623'	254000	021626'		JRST	SW3		;LOOK FOR ERRORS
	021624'	035000	034342'		TYPE	<$Bit 18,19,20, or 21 read by GETSTS UUO. Can't swap>
	021625'	254000	016772'		JRST	NADAB		;EXIT WHILE USER FINDS DEC DOCUMENT
	021626'	626500	020000	SW3:	TRZN	Y,20000
	021627'	254000	021641'		JRST	SW4
	021630'	060512	000000		SETSTS	JCH,(Y)		;EOF INDICATOR
	021631'	540500	012626'		HRR	Y,CP		;CLEAR OUT PAGE
	021632'	200540	000012		MOVE	L,Y
	021633'	271540	004000		ADDI	L,PGSIZ
	021634'	340500	000000		AOJ	Y,
	021635'	402012	000000		SETZM	(Y)
	021636'	504500	000012		HRL	Y,Y
	021637'	340500	000000		AOJ	Y,
	021640'	251513	000000		BLT	Y,(L)
	021641'	250205	013047'	SW4:	EXCH	V,PGT+NPGD(U)	;MARK OLD PAGE AS ON THE DISC
	021642'	202211	012647'		MOVEM	V,PGT(X)	;MARK NEW PAGE AS IN
	021643'	256011	012647'		XCT	PGT(X)		;EXECUTE THIS AS IF SWAP HAD NEVER BEEN CALLED.SEE CA MACRO.
	021644'	263040	000000		RETURN


				;;;	ITP - INPUT TRAP PROCESSOR.
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 10-9
NAD01.R06	24-JUL-87 17:39		FILE HANDLER AND PAGE SWAPPER

				;
				;	CALLED AS THE CIT UUO WHEN THE INPUT TRAP CHARACTER (NULL) IS 
				;	SEEN IN THE INPUT SIDE BUFFER.  IF THIS IS THE END OF THE SIDE BUFFER,
				;	GET NEXT SIDE BUFFER, ELSE, SKIP NULLS UNTIL NEXT VALID CHARACTER.

	021645'	540140	000040	ITP:	HRR	C,40
	021646'	542141	000000		HRRM	C,(S)		;INPUT TRAP RETURNS TO RETURN ARG OF CALLER
	021647'	551142	777600	IT0:	HRRZI	C,-200(I)
	021650'	316140	003242'		CAMN	C,PTB
	021651'	254000	021720'		JRST	IT8		;ADVANCE TO PAB, MOVING OUT OF TRAILING BFR.
	021652'	316140	003243'		CAMN	C,PAB		;END OF ACTIVE BUFFER?
	021653'	254000	021661'		JRST	IT1		;YES
	021654'	134140	000002		ILDB	C,I		;NO, GET NEXT BYTE
	021655'	306140	000000		CAIN	C,CHRIT		;IS THIS NULL CHARACTER?
	021656'	254000	021647'		JRST	IT0		;YES, SKIP IT
	021657'	270100	006336'		ADD	I,BACKUP	;BACKUP OVER GOOD CHARACTER
	021660'	263040	000000		RETURN
				;				ADVANCE ACTIVE BFR AND ITS TRAILING BFR
	021661'	606640	000003	IT1:	TRNN	F,SUPLST+ASONLY	;IS THE LISTER RUNNING
	021662'	260040	022727'		PJS	LSVLNE		;YES, SAVE BEGINNING OF LINE
	021663'	540140	003243'		HRR	C,PAB
	021664'	552140	003242'		HRRZM	C,PTB
	021665'	540143	000200		HRR	C,200(C)
	021666'	552140	003243'		HRRZM	C,PAB

	021667'	200120	002325'	IT2:	MOVE	I,@IH		;GET PTR TO BFR AFTER NXT BFR
	021670'	331002	000000		SKIPL	(I)		;SKIP IF INPUT ICH, WONT CAUSE A DISMISS
	021671'	254000	021701'		JRST	IT4		;BFR BEYOND NXT IS EMPTY. WE MIGHT DISMISS SOON TO GET DATA
	021672'	260040	021734'	IT3:	PJS	ITBLT		;MOVE A BFR TO SIDE BFR RING
	021673'	066400	000000		INPUT	ICH,		;RELEASE BFR AND POSSIBLY TRIGGER PHYSICAL IO
	021674'	200140	003244'		MOVE	C,PLB
	021675'	550143	000200		HRRZ	C,200(C)
	021676'	552140	003244'		HRRZM	C,PLB		;ADVANCE LEAD BFR
	021677'	312140	003242'		CAME	C,PTB		;DONT READ INTO WHAT WILL BE TRAILING BFR.(SEE IT8)
	021700'	254000	021667'		JRST	IT2		;FILL LEADING BFRS UNTIL IT2 NOTICES POSSIBLE DMS

	021701'	200140	003243'	IT4:	MOVE	C,PAB
	021702'	312140	003244'		CAME	C,PLB
	021703'	254000	021722'		JRST	IT9		;GOOD, WE HAVE DATA READY FOR A NEW ACTIVE BFR
	021704'	350000	000775'		AOS	DMSCTR		;TOO BAD, WE'LL SUFFER A DISMISS TO GET SOME DATA
	021705'	337020	002325'		SKIPG	@IH
	021706'	254000	021672'		JRST	IT3
	021707'	066400	000000		INPUT	ICH,
	021710'	047400	000010		WAIT	ICH,
	021711'	062400	000003		GETSTS	ICH,C
	021712'	602140	020000		TRNE	C,20000
	021713'	254000	021726'		JRST	ITEOF
	021714'	602140	750000		TRNE	C,750000
	021715'	254000	021732'		JRST	ITIOER
	021716'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	021717'	254000	021722'		JRST	IT9

	021720'	606640	000003	IT8:	TRNN	F,SUPLST+ASONLY	;IS LISTER RUNNING
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 10-10
NAD01.R06	24-JUL-87 17:39		FILE HANDLER AND PAGE SWAPPER

	021721'	260040	022727'		PJS	LSVLNE		;YES. SAVE BEGINNING OF LINE

	021722'	200100	003243'	IT9:	MOVE	I,PAB
	021723'	505100	440700		HRLI	I,(POINT 7,0)	;BYTE POINTER
	021724'	202100	006252'		MOVEM	I,LISTI		;SAVE POINTER TO REST OF LINE
	021725'	263040	000000		RETURN

	021726'	661640	010000	ITEOF:	TLO	F,EOFF		;SET END OF FILE FLAG
	021727'	260040	023674'		PJS	DEN
	021730'	200040	003247'		MOVE	S,GFS		;RETURN TO CALLER FOR THIS PASS
	021731'	263040	000000		RETURN

	021732'	035000	034355'	ITIOER:	TYPE	<$Disk I/O error>
	021733'	254000	016772'		JRST	NADAB

	021734'			ITBLT:				;COPY A BFR FROM INPUT RING TO SIDE RING
	021734'	200140	002325'		MOVE	C,IH		;BFR PTR
	021735'	505143	000002		HRLI	C,2(C)		;FIRST DATA WORD TO PICK UP
	021736'	540140	003244'		HRR	C,PLB		;FIRST WORD OF DESTINATION BFR
	021737'	551103	000177		HRRZI	I,177(C)	;LAST WORD DEPOSITED IN DESTINATION BFR
	021740'	251142	000000		BLT	C,(I)
	021741'	263040	000000		RETURN


	021742'	260040	021753'	FBT:	PJS	GCHR		;FLUSH BLANKS AND TABS
	021743'	302140	000040		CAIE	C," "
	021744'	306140	000011		CAIN	C,11
	021745'	254000	021742'		JRST	FBT		;FBT IF BLANK OR TAB
	021746'	270100	006336'		ADD	I,BACKUP	;DECREMENT BYTE POINTER BY ONE CHARACTER
	021747'	263040	000000		RETURN

	021750'	051700	000015	TYPEOL:	OUTCHI	15
	021751'	051700	000012		OUTCHI	12
	021752'	263040	000000		RETURN			;TYPE CARRIAGE RET. LINE FEED

	021753'	134140	000002	GCHR:	ILDB	C,I
	021754'	303140	000003		CAILE	C,3		;IS IT A TRAP CHARACTER
	021755'	263040	000000		RETURN			;NO. RETURN CHARACTER
	021756'	254003	021757'		JRST	.+1(C)		;YES. GO TO TRAP PROCESSOR
	021757'	030000	021753'		CIT	GCHR		;END OF INPUT FILE BUFFER
	021760'	033000	021753'		MARG	GCHR		;MACRO ARGUMENT
	021761'	034000	021753'		MAE	GCHR		;MACRO ARGUMENT END
	021762'	032000	021753'		MEND	GCHR		;MACRO END

	021763'			BL3:	REPEAT	3,<OUTCHI " ">
	021763'	051700	000040
	021764'	051700	000040
	021765'	051700	000040
	021766'	263040	000000		RETURN

	021767'	505400	440700	TYPEM:	HRLI	W,(POINT 7,0)	;Type message addressed in "W".
	021770'	134440	000010	TYPEM1:	ILDB	X,W
	021771'	322440	034240'		JUMPE	X,[RETURN]
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 10-11
NAD01.R06	24-JUL-87 17:39		FILE HANDLER AND PAGE SWAPPER

	021772'	306440	000044		CAIN	X,"$"		;CR-LF SEQUENCE?
	021773'	254000	021776'		JRST	TYPEM2		;YES. GO TYPE THEM
	021774'	051040	000011		OUTCHR	X
	021775'	254000	021770'		JRST	TYPEM1
	021776'	260040	021750'	TYPEM2:	PJS	TYPEOL
	021777'	254000	021770'		JRST	TYPEM1

	022000'	261040	000004	TYP6:	BAR	V		;TYPE OUT SIXBIT LABEL IN U AND LEAVE CHR COUNT IN V
	022001'	260040	022004'
	022002'	262040	000004
	022003'	263040	000000
	022004'	402000	000466'		SETZM	TYP6C
	022005'	400200	000000	TYP6A:	SETZ	V,
	022006'	246200	000006		LSHC	V,6
	022007'	271200	000040		ADDI	V,40		;MOVE A CHAR TO V
	022010'	256020	006456'		XCT	@P6		; "OUTCHR V"  OR  "IDPB V,DOS"
	022011'	350000	000466'		AOS	TYP6C
	022012'	326240	022005'		JUMPN	U,TYP6A
	022013'	263040	000000		RETURN

	022014'	261040	000005	TN0:	PUSH	S,U		;PUSH A REMAINDER
	022015'			TN:				;TYPE V IN RADIX Y
	022015'	621200	400000		TLZ	V,400000
	022016'	230200	000012		IDIV	V,Y
	022017'	327200	022014'		JUMPG	V,TN0		;LOOP IF STILL CREATING QUOTIENTS
	022020'	261040	000005		PUSH	S,U		;PUSH A REMAINDER
	022021'	200240	034361'		MOVE	U,[IDPB	U,DOS]
	022022'	332000	006431'		SKIPE	TNX
	022023'	200240	034362'		MOVE	U,[OUTCHR	U]
	022024'	202240	006431'		MOVEM	U,TNX		;SET OUTPUT DESTINATION TO TTY OR DOS
	022025'	402000	000466'		SETZM	TYP6C		;CLEAR COUNT OF CHARS TYPED
	022026'	262040	000005	TN1:	POP	S,U
	022027'	602240	777740		TRNE	U,777740	;Is this the return address?
	022030'	254005	000000		JRST	(U)		;Yes, exit procedure
	022031'	622500	777777		TRZE	Y,-1
	022032'	307240	000011		CAIG	U,11
	022033'	254000	022036'		JRST	.+3
	022034'	261040	000005		PUSH	S,U
	022035'	400240	000000		SETZ	U,		;LEAD ZERO
	022036'	200245	032572'		MOVE	U,HEX(U)
	022037'	256000	006431'		XCT	TNX		;OUTPUT A CHR
	022040'	350000	000466'		AOS	TYP6C		;INCREMENT COUNT OF CHARS TYPED
	022041'	254000	022026'		JRST	TN1

				;	Type a full word octal number in U. Uses registers W and V.

	022042'	201400	000014	TOCT:	MOVEI	W,^D12		;twelve octal bytes in 36 bit word
	022043'	400200	000000	TOCT1:	SETZ	V,		;clear to accept next byte
	022044'	246200	000003		LSHC	V,3		;get next byte from U
	022045'	271200	000060		ADDI	V,"0"		;convert to ASCII
	022046'	051040	000004		OUTCHR	V		;and type
	022047'	367400	022043'		SOJG	W,TOCT1		;check if anymore to type
	022050'	263040	000000		RETURN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 10-12
NAD01.R06	24-JUL-87 17:39		FILE HANDLER AND PAGE SWAPPER


				;
				;	Get command input from file or terminal.
				;
	022051'	261040	000011	CFINP:	PUSH	S,X		;save registers needed
	022052'	261040	000012		PUSH	S,Y
	022053'	200440	002255'		MOVE	X,CURCMD	;get index of current command file
	022054'	200511	002250'		MOVE	Y,CMDBFA(X)	;get address of buffer header
	022055'	375012	000002	CFINP1:	SOSGE	2(Y)		;buffer empty?
	022056'	254000	022074'		JRST	CFINP3		;yes. refill buffer.
	022057'	134412	000001		ILDB	W,1(Y)		;get next character
	022060'	322400	022055'		JUMPE	W,CFINP1	;ignore nulls
	022061'	331011	002257'		SKIPL	CMDECO(X)	;should it be echoed?
	022062'	051040	000010		OUTCHR	W		;yes
	022063'	306400	000015		CAIN	W,15		;carriage return?
	022064'	254000	022104'		JRST	CFINP6		;yes. go ignore linefeed
	022065'	306400	000026		CAIN	W,"V"-100	;control V?
	022066'	254000	022120'		JRST	CFINP8		;yes. go switch to terminal input
	022067'	306400	000004		CAIN	W,"D"-100	;control D?
	022070'	254000	022100'		JRST	CFINP4		;yes. end of file
	022071'	262040	000012	CFINP2:	POP	S,Y		;restore registers
	022072'	262040	000011		POP	S,X
	022073'	263040	000000		RETURN
	022074'	201411	000020	CFINP3:	MOVEI	W,CMDCHN(X)	;get channel for input
	022075'	505400	000014		HRLI	W,.CHIN
	022076'	043400	000000		CHANIO	W,		;read next buffer
	022077'	254000	022055'		JRST	CFINP1		;get next character from buffer
	022100'	260040	022145'	CFINP4:	PJS	CFCLS		;close command file on eof or error
	022101'	262040	000012	CFINP5:	POP	S,Y		;restore registers
	022102'	262040	000011		POP	S,X
	022103'	254020	002272'		JRST	@GCHI		;go to new input source
	022104'	375012	000002	CFINP6:	SOSGE	2(Y)		;get linefeen
	022105'	254000	022113'		JRST	CFINP7		;need another buffer
	022106'	133012	000001		IBP	1(Y)		;ignore linefeed
	022107'	331011	002257'		SKIPL	CMDECO(X)	;echo linefeed?
	022110'	051700	000012		OUTCHI	12		;yes
	022111'	201400	000015		MOVEI	W,15		;insure CR returned even if got next buffer
	022112'	254000	022071'		JRST	CFINP2		;and exit
	022113'	201411	000020	CFINP7:	MOVEI	W,CMDCHN(X)	;get channel
	022114'	505400	000014		HRLI	W,.CHIN
	022115'	043400	000000		CHANIO	W,		;get next buffer
	022116'	254000	022104'		JRST	CFINP6		;get linefeed
	022117'	254000	022100'		JRST	CFINP4		;eof
	022120'	200400	034363'	CFINP8:	MOVE	W,[PJS CTINP]	;switch to terminal input
	022121'	202411	002265'		MOVEM	W,CMDSRC(X)
	022122'	202400	002272'		MOVEM	W,GCHI
	022123'	254000	022101'		JRST	CFINP5

	022124'	607640	200000	CTINP:	TLNN	F,DCCF		;character wanted immediately?
	022125'	254000	022130'		JRST	CTINP1		;no
	022126'	051000	000010		INCHRW	W		;yes. break on all characters
	022127'	625640	200000		TLZA	F,DCCF		;only for one character
	022130'	051200	000010	CTINP1:	INCHWL	W		;break on punctuation
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 10-13
NAD01.R06	24-JUL-87 17:39		FILE HANDLER AND PAGE SWAPPER

	022131'	306400	000015		CAIN	W,15		;carriage return?
	022132'	051001	000001		INCHRW	1(S)		;discard linefeed
	022133'	331000	002255'		SKIPL	CURCMD		;command file active?
	022134'	302400	000004		CAIE	W,"D"-100	;and a control d?
	022135'	263040	000000		RETURN
	022136'	261040	000011		PUSH	S,X		;yes. restore command file input
	022137'	200440	002255'		MOVE	X,CURCMD	;current command file
	022140'	200400	034364'		MOVE	W,[PJS CFINP]	;input now from file
	022141'	202411	002265'		MOVEM	W,CMDSRC(X)
	022142'	202400	002272'		MOVEM	W,GCHI
	022143'	262040	000011		POP	S,X
	022144'	254000	022051'		JRST	CFINP		;go get next character from file
				;
				;	Close either current command file or all command files.
				;
	022145'	200400	002255'	CFCLS:	MOVE	W,CURCMD	;just close current command file
	022146'	374000	000010		SOSA	W		;set to new current command file
	022147'	474400	000000	CFACLS:	SETO	W,		;close all command files
	022150'	261040	000010		PUSH	S,W		;save to test end of loop
	022151'	335400	002255'		SKIPGE	W,CURCMD	;are any command files open?
	022152'	254000	022161'		JRST	CFCLS2		;no. do nothing
	022153'	201410	000020	CFCLS1:	MOVEI	W,CMDCHN(W)	;get channel
	022154'	505400	000000		HRLI	W,.CHREL
	022155'	043400	000000		CHANIO	W,		;release channel
	022156'	370400	002255'		SOS	W,CURCMD	;reduce current command number
	022157'	313401	000000		CAMLE	W,(S)		;check if over
	022160'	254000	022153'		JRST	CFCLS1		;more to do
	022161'	200410	002265'	CFCLS2:	MOVE	W,CMDSRC(W)	;get source of new current file
	022162'	202400	002272'		MOVEM	W,GCHI		;set as character get instruction
	022163'	262040	000010		POP	S,W		;adjust stack
	022164'	263040	000000		RETURN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 11
NAD01.R06	24-JUL-87 17:39		LISTER

					SUBTTL	LISTER
				;		**************************************************



				;	ASSEMBLE WITH A LISTING.
	022165'	202040	003247'	LST:	MOVEM	S,GFS		;SAVE FOR EOF EXIT.
	022166'	402000	003201'		SETZM	TRUTH		;INIT IF VALUE TO TRUE
	022167'	402000	002763'		SETZM	SAVCHR
	022170'	402000	003144'		SETZM	TXTOUT		;SET NO TEXT OUTPUT YET.
	022171'	402000	002765'		SETZM	LNLEFT		;START LISTING ON NEW PAGE
	022172'	602640	010000		TRNE	F,LSTTTL	;IS TITLE TO BE LISTED?
	022173'	660640	000020		TRO	F,NEWSEC	;YES. START FILE AT NEW SECTION
	022174'	620640	000101		TRZ	F,ASONLY+CREF 	;NOT JUST ASSEMBLING OR CREF.
	022175'	606700	000004		TRNN	F2,CRFLST	;UNLESS LISTING SWITCH SET
	022176'	254000	022210'		JRST	LS2		;NO CREF
	022177'	660640	000100		TRO	F,CREF		;CREF LISTING HAPPENING
	022200'	211400	000010		MOVNI	W,10		;DECREASE TEXT SIZE BY SIZE
	022201'	272400	002764'		ADDM	W,TXTSIZ	; OF CREF LINE NUMBERS
	022202'	260040	023020'		PJS	BEGCRF		;BEGIN CREF OUTPUT
	022203'	201400	000020		MOVEI	W,20		;MARK NEXT AS TITLE
	022204'	260040	022617'		PJS	LOCN
	022205'	260040	022523'		PJS	LOTTL		;OUTPUT CREF LISTING TITLE
	022206'	201440	000104		MOVEI	X,104		;END TITLE STRING
	022207'	260040	023027'		PJS	ENDCRF
	022210'	336000	013056'	LS2:	INCLC
	022211'	350000	006256'
	022212'	402000	013055'	LS2A:	SETZM	MACN		;CLEAR MACRO STACK COUNTER
	022213'	202100	006255'		MOVEM	I,LINEI		;SAVE START OF LINE FOR ERRORS
	022214'	202100	006252'	LS1:	MOVEM	I,LISTI
	022215'	620700	000100		TRZ	F2,CONDST	; Reset statement is conditional
	022216'	476000	006254'		SETOM	PCL		;INIT PC LISTING OFF
	022217'	602640	000002		TRNE	F,SUPLST	;IS LISTING BEING SUPPRESSED?
	022220'	254000	022225'		JRST	LS1A		;YES. DON'T CLEAR LISTING FLAGS.
	022221'	201400	017000		MOVEI	W,5*LSVSIZ	;NUMBER OF CHARACTERS IN LSTBUF
	022222'	202400	003250'		MOVEM	W,LSVCNT
	022223'	200400	022746'		MOVE	W,BLSVP		;INITIALIZE LISTER SAVE BUFFER POINTER
	022224'	202400	006251'		MOVEM	W,LSVP
	022225'	602640	000100	LS1A:	TRNE	F,CREF		;CREF LISTING?
	022226'	260040	023020'		PJS	BEGCRF		;YES. BEGING CREF CONTROL OUTPUT
	022227'	260040	016473'		PJS	GS
	022230'	623640	000200		TLZE	F,ENDRPT	;WAS STATEMENT NOT LAST END REPEAT?
	022231'	254000	022336'		JRST	LS5A		;YES. DO NOT LIST
	022232'	602640	000002		TRNE	F,SUPLST	;IS LISTING BEING SUPPRESSED?
	022233'	254000	022336'		JRST	LS5A		;YES.
	022234'	402000	003145'		SETZM	NORPT		;ALLOW LIST OF NOT FIRST REPEAT LOOP
	022235'	332000	000777'		SKIPE	LSTMSK		;PASS 1 LISTING?
	022236'	254000	022252'		JRST	LS8R		;YES.DON'T CHECK LIST SWITCHES
	022237'	607640	000040		TLNN	F,NOLIST
	022240'	254000	022245'		JRST	LS8F		;NOLIST IS NOT ACTIVE
	022241'	603640	100000		TLNE	F,LSL		;ARE NOLIST LINES TO BE LISTED
	022242'	254000	022336'		JRST	LS5A		;NO. DON'T LIST THIS LINE
	022243'	476000	006254'		SETOM	PCL		;IN ANY CASE, DON'T LIST MEMORY WORD
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 11-2
NAD01.R06	24-JUL-87 17:39		LISTER

	022244'	476000	003145'		SETOM	NORPT		; OR OTHER THAN FIRST TIME OF REPEAT
	022245'	200400	003202'	LS8F:	MOVE	W,IFC
	022246'	274400	003203'		SUB	W,IFT
	022247'	332000	003201'		SKIPE	TRUTH
					JUMPN	W,[TLNE  F,LSF	;ARE UNTRUE IF LINES TO BE LISTED
						   JRST  LS5A	;NO. DON'T LIST THIS LINE
						   SETOM PCL	;DON'T LIST MEMORY WORD
						   SETOM NORPT	;OR NONFIRST REPEAT LOOPS
	022250'	326400	034365'			   JRST  LS8R]
	022251'	202400	003201'	  	MOVEM	W,TRUTH
	022252'	602700	000100	LS8R:	TRNE	F2,CONDST	; Is current statement a conditional
	022253'	607640	000004		TLNN	F,LSI		; ... and should conditionals be listed?
	022254'	334000	000000		SKIPA			; Either not a conditional or should be listed
	022255'	254000	022336'		JRST	LS5A		; Do not list this conditional statement
	022256'	337400	003211'		SKIPG	W,RPPTR		;IS REPEAT BLOCK BEING LISTED
	022257'	254000	022267'		JRST	LS8		;NO
	022260'	332010	003211'		SKIPE	RPL-1(W)	;IS IT THE FIRST TIME THRU?
	022261'	254000	022267'		JRST	LS8		;YES. GO LIST
	022262'	332000	000777'		SKIPE	LSTMSK		;PASS 1 LISTING?
	022263'	254000	022336'		JRST	LS5A		;YES. LIST REPEAT ONLY ONCE
	022264'	607640	000400		TLNN	F,LSR		;SHOULD IT BE SKIPPED?
	022265'	332000	003145'		SKIPE	NORPT
	022266'	254000	022336'		JRST	LS5A		;YES. DON'T LIST IT
	022267'	476000	002762'	LS8:	SETOM	LSTLN		;NONE OF LINE LISTED YET
	022270'	260040	022364'		PJS	LSTART		;SIGNAL START OF LINE LIST
	022271'	332000	000777'		SKIPE	LSTMSK		;PASS 1 LISTING?
	022272'	254000	022324'		JRST	LS5F		;YES. DON'T LIST PC.
	022273'	474200	000000		SETO	V,
	022274'	250200	006254'		EXCH	V,PCL
	022275'	603200	377700		TLNE	V,377700
	022276'	254000	022324'		JRST	LS5F
	022277'	332000	003144'		SKIPE	TXTOUT		;IN MIDDLE OF TEXT LINE
	022300'	260040	022603'		PJS	LOEOL		;YES. FINISH LINE.

				;	OUTPUT PC, MAYBE SOME MEMORY DATA, AND COPY INPUT LINE
	022301'	200340	034372'		MOVE	OS,[POINT 4,V,11]	;HEX BYTE POINTER FOR PC
	022302'	134400	000007	LS3:	ILDB	W,OS		;GET A BYTE FROM PC
	022303'	540410	032572'		HRR	W,HEX(W)
	022304'	260040	022612'		PJS	LOC		;OUTPUT HEX DIGIT
	022305'	603340	770000		TLNE	OS,770000
	022306'	254000	022302'		JRST	LS3
	022307'	321200	022326'		JUMPL	V,LS5

	022310'	201400	000011	LS4B:	MOVEI	W,11		;TAB TO START OF HEX
	022311'	260040	022612'		PJS	LOC
	022312'	400300	000000		SETZ	VS,		;SET NO CHARACTERS LISTER FOR HEX
	022313'	200400	000004	LS4:	MOVE	W,V
	022314'	316400	000551'		CAMN	W,PC
	022315'	254000	022332'		JRST	LS5E
	022316'	303300	000015		CAILE	VS,HEXSIZ-3	;ABOUT TO OVERFLOW MARGIN?
					JRST	[PJS FILLHX
						 PJS LSCOPY	;YES. LIST TEXT
						 PJS LSTART	;START A NEW LINE
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 11-3
NAD01.R06	24-JUL-87 17:39		LISTER

	022317'	254000	034373'			 JRST LS4B]
	022320'	260040	025610'		CA
	022321'	135400	000010		LDB	W,W
	022322'	260040	022563'		PJS	LOBYTE
	022323'	344200	022313'		AOJA	V,LS4

	022324'	332000	003144'	LS5F:	SKIPE	TXTOUT		;ANY TEXT OUTPUT ALREADY?
	022325'	254000	022333'		JRST	LS5B		;YES. DON'T FILL IN HEX
	022326'	201400	000011	LS5:	MOVEI	W,11		;TAB OVER PC POSITIONS
	022327'	336000	000777'		SKIPN	LSTMSK		;IF PASS 1 LISTING, NO PC TO SKIP
	022330'	260040	022617'		PJS	LOCN
	022331'	400300	000000		SETZ	VS,		;SET COUNT OF HEX LISTED (I.E. NONE)
	022332'	260040	022625'	LS5E:	PJS	FILLHX		;FILL FOR HEX
	022333'	260040	022634'	LS5B:	PJS	LSCOPY
	022334'	337000	002762'		SKIPG	LSTLN		;ANYMORE OF LINE TO LIST?
					JRST	[PJS LSTART	;SIGNAL START OF NEW LINE
	022335'	254000	034377'			 JRST LS5]
	022336'	603640	000100	LS5A:	TLNE	F,ENDFND	;END OF FILE?
	022337'	254000	022353'		JRST	LS5C		;YES. EXIT
	022340'	603640	004000		TLNE	F,ABTASM	;was assembly aborted?
	022341'	254000	022355'		JRST	LS5G		;yes. go type message
	022342'	135140	000002		LDB	C,I		;GET END OF STATEMENT CHARACTER
	022343'	302140	000015		CAIE	C,15		;IF STATEMENT ENDED WITH CARRIAGE RETURN
	022344'	254000	022360'		JRST	LS5D		;NO
	022345'	260040	021753'		PJS	GCHR		;YES. REMOVE LINEFEED
	022346'	331000	000777'		SKIPL	LSTMSK		;IN PASS 2?
	022347'	402000	006257'		SETZM	LEC		;YES. IGNORE ERRORS.
	022350'	332000	006257'		SKIPE	LEC		;ARE THERE ANY ERRORS?
	022351'	260040	025264'		PJS	TLE
	022352'	254000	022210'		JRST	LS2
	022353'	331000	000777'	LS5C:	SKIPL	LSTMSK		;PASS 2?
	022354'	402000	006257'		SETZM	LEC		;YES. IGNORE LINE ERRORS
	022355'	332000	006257'	LS5G:	SKIPE	LEC		;ANY LINE ERRORS?
	022356'	260040	025264'		PJS	TLE		;YES. TYPE THEM OUT
	022357'	263040	000000		RETURN
	022360'	335000	013055'	LS5D:	SKIPGE	MACN		;IS MACRO STACK OK
	022361'	332000	006257'		SKIPE	LEC		;OR ARE THERE NO PENDING ERRORS?
	022362'	254000	022214'		JRST	LS1		;YES. CONTINUE
	022363'	254000	022212'		JRST	LS2A		;NO. CLEAR OLD LINE SAVE

	022364'	602640	000020	LSTART:	TRNE	F,NEWSEC	;NEW SECTION?
	022365'	402000	002765'		SETZM	LNLEFT		;YES. FORCE NEW PAGE
	022366'	333000	002765'		SKIPLE	LNLEFT		;ROOM FOR LINE ON THIS PAGE?
	022367'	254000	022506'		JRST	LSRT50		;YES
	022370'	335000	002762'		SKIPGE	LSTLN		;FIRST LINE OF TEXT?
	022371'	606640	000100		TRNN	F,CREF		;AND OUTPUTTING CREF?
	022372'	254000	022375'		JRST	LSRT0		;NO
	022373'	201440	000104		MOVEI	X,104		;END CREF INFO FOR TITLE
	022374'	260040	023027'		PJS	ENDCRF
	022375'	201400	000014	LSRT0:	MOVEI	W,14		;OUTPUT TOP OF FORM
	022376'	260040	022617'		PJS	LOCN
	022377'	200400	002761'		MOVE	W,LNPPG		;GET LINES PER PAGE
	022400'	606640	010000		TRNN	F,LSTTTL	;IS LISTING BEING TITLED AND PAGED?
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 11-4
NAD01.R06	24-JUL-87 17:39		LISTER

	022401'	525400	377777		HRLOI	W,377777	;NO. SET INFINITY PAGE SIZE.
	022402'	202400	002765'		MOVEM	W,LNLEFT	;SET AS LINES LEFT
	022403'	626640	000020		TRZN	F,NEWSEC	;DOES THIS PAGE START A NEW SECTION?
	022404'	254000	022407'		JRST	LSRT1		;NO
	022405'	350000	003142'		AOS	SECNUM		;GO TO NEXT SECTION NUMBER
	022406'	402000	003143'		SETZM	PAGNUM		;AND START AT PAGE ONE
	022407'	606640	010000	LSRT1:	TRNN	F,LSTTTL	;SHOULD TITLE BE LISTED?
	022410'	254000	022502'		JRST	LSRT5		;NO. DON'T PRINT HEADING
	022411'	350000	003143'		AOS	PAGNUM		;GO TO NEXT PAGE NUMBER
	022412'	201440	034401'		MOVEI	X,[ASCIZ "Page  "]	;OUTPUT TITLE
	022413'	260040	022546'		PJS	LOSTR		;OUTPUT "PAGE "
	022414'	200340	003142'		MOVE	OS,SECNUM
	022415'	260040	022536'		PJS	LONUM		;OUTPUT SECTION NUMBER
	022416'	201400	000055		MOVEI	W,"-"
	022417'	260040	022617'		PJS	LOCN		;OUTPUT "-"
	022420'	200340	003143'		MOVE	OS,PAGNUM
	022421'	260040	022536'		PJS	LONUM		;OUTPUT PAGE NUMBER
	022422'	201400	000011		MOVEI	W,11
	022423'	260040	022617'		PJS	LOCN		;TAB TO TITLE TEXT
	022424'	260040	022523'		PJS	LOTTL		;LIST TITLE
	022425'	260040	022603'		PJS	LOEOL		;END TITLE LINE
	022426'	400300	000000		SETZ	VS,		;COUNT SIZE OF FILE NAME
	022427'	336540	002315'		SKIPN	L,ILUSR		;WAS A USER NAME SPECIFIED?
	022430'	254000	022450'		JRST	LSRT4		;NO. GO PRINT FILE NAME.
	022431'	201400	000050		MOVEI	W,"("
	022432'	260040	022617'		PJS	LOCN
	022433'	260040	023036'		PJS	SYMSIZ		;SIZE OF FIRST WORD OF USER NAME.
	022434'	270300	000010		ADD	VS,W		;KEEP TRAK OF SIZE OF FILE NAME
	022435'	201440	000013		MOVEI	X,L
	022436'	260040	022553'		PJS	LOSTR6		;PRINT FIRST WORD OF USER NAME
	022437'	336540	002316'		SKIPN	L,ILUSR+1	;CHECK SECOND WORD OF USER NAME
	022440'	254000	022445'		JRST	LSRT3
	022441'	260040	023036'		PJS	SYMSIZ		;SIZE OF SECOND WORD
	022442'	270300	000010		ADD	VS,W
	022443'	201440	000013		MOVEI	X,L
	022444'	260040	022553'		PJS	LOSTR6		;PRINT SECOND WORD
	022445'	201400	000051	LSRT3:	MOVEI	W,")"
	022446'	260040	022617'		PJS	LOCN
	022447'	271300	000002		ADDI	VS,2
	022450'	200540	002321'	LSRT4:	MOVE	L,IL+2		;GET FILE NAME
	022451'	260040	023036'		PJS	SYMSIZ		;GET SIZE OF NAME
	022452'	270300	000010		ADD	VS,W
	022453'	201440	000013		MOVEI	X,L		;ADDRESS NAME
	022454'	260040	022553'		PJS	LOSTR6		;OUTPUT FILE NAME
	022455'	510540	002322'		HLLZ	L,IL+3		;GET EXTENSION
	022456'	322540	022465'		JUMPE	L,LSRT2		;CHECK IF THERE IS ONE.
	022457'	201400	000056		MOVEI	W,"."
	022460'	260040	022617'		PJS	LOCN		;OUTPUT "."
	022461'	260040	023036'		PJS	SYMSIZ		;GET SIZE OF EXTENSION
	022462'	271310	000001		ADDI	VS,1(W)		;SIZE OF EXTENSION AND DOT
	022463'	201440	000013		MOVEI	X,L
	022464'	260040	022553'		PJS	LOSTR6		;OUTPUT EXTENSION
	022465'	201400	000011	LSRT2:	MOVEI	W,11
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 11-5
NAD01.R06	24-JUL-87 17:39		LISTER

	022466'	305300	000010		CAIGE	VS,10		;CHECK IF 8 OR MORE CHARS IN FILE NAME
	022467'	260040	022617'		PJS	LOCN		;IF NOT, TAB TO 8 CHARS
	022470'	305300	000020		CAIGE	VS,20		;CHECK IF 16 OR MORE CHARS IN FILE NAME
	022471'	260040	022617'		PJS	LOCN		;IF NOT, TAB TO 16 CHARS
	022472'	305300	000030		CAIGE	VS,30		;CHECK IF 24 OR MORE CHARS IN FILE NAME
	022473'	260040	022617'		PJS	LOCN		;IF NOT, TAB TO 24 CHARS
	022474'	201400	000040		MOVEI	W," "
	022475'	260040	022617'		PJS	LOCN		;SKIP 1 MORE
	022476'	201440	003060'		MOVEI	X,STLBF
	022477'	260040	022546'		PJS	LOSTR		;OUTPUT SUBTITLE
	022500'	260040	022603'		PJS	LOEOL		;END SUBTITLE LINE
	022501'	260040	022603'		PJS	LOEOL		;BLANK LINE AFTER TITLE
	022502'	335000	002762'	LSRT5:	SKIPGE	LSTLN		;FIRST LINE OF TEXT?
	022503'	606640	000100		TRNN	F,CREF		;OUTPUTTING CREF?
	022504'	254000	022506'		JRST	LSRT50		;NO
	022505'	260040	023020'		PJS	BEGCRF
	022506'	606640	000100	LSRT50:	TRNN	F,CREF		;AND CREF LISTING?
	022507'	263040	000000		RETURN			;NO
	022510'	603640	020000		TLNE	F,LSCNF		;WILL THIS BE A NEW LINE?
	022511'	254000	022520'		JRST	LSRT51		;NO
	022512'	201440	000103		MOVEI	X,103		;OUTPUT AND INCREMENT CREF LINE NUMBER
	022513'	335000	002762'		SKIPGE	LSTLN		;FIRST LINE OF TEXT?
	022514'	260040	023027'		PJS	ENDCRF
	022515'	201400	000011		MOVEI	W,11		;TAB TO START OF LINE
	022516'	260040	022617'		PJS	LOCN
	022517'	263040	000000		RETURN
	022520'	201440	000104	LSRT51:	MOVEI	X,104		;JUST END CREF
	022521'	260040	023027'		PJS	ENDCRF
	022522'	263040	000000		RETURN

	022523'	336000	003010'	LOTTL:	SKIPN	TTLBF		;IS THERE A TITLE?
	022524'	254000	022532'		JRST	LOTTL1		;NO. DON'T PRINT IT
	022525'	201440	003010'		MOVEI	X,TTLBF	
	022526'	260040	022546'		PJS	LOSTR		;OUTPUT TITLE TEXT
	022527'	201400	000040		MOVEI	W," "
	022530'	260040	022612'		PJS	LOC
	022531'	260040	022612'		PJS	LOC
	022532'	201440	002766'	LOTTL1:	MOVEI	X,STDTTL
	022533'	260040	022546'		PJS	LOSTR		;OUTPUT STANDARD TITLE
	022534'	263040	000000		RETURN

	022535'	261040	000010	LONUM0:	PUSH	S,W		;OUTPUT DECIMAL NUMBER TO LISTING
	022536'	231340	000012	LONUM:	IDIVI	OS,^D10
	022537'	327340	022535'		JUMPG	OS,LONUM0	;CHECK IF MORE DIGITS
	022540'	271400	000060	LONUM1:	ADDI	W,"0"		;CONVERT TO ASCII
	022541'	260040	022617'		PJS	LOCN
	022542'	262040	000010		POP	S,W		;GET NEXT DIGIT OR RETURN
	022543'	606400	777740		TRNN	W,777740	;Is this the return address?
	022544'	254000	022540'		JRST	LONUM1		;NO. MUST BE DIGIT
	022545'	254010	000000		JRST	(W)		;YES. RETURN ADDRESS

	022546'	505440	440700	LOSTR:	HRLI	X,(POINT 7,0)	;OUTPUT ASCII STRING TO LISTING
	022547'	134400	000011	LOSTR1:	ILDB	W,X
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 11-6
NAD01.R06	24-JUL-87 17:39		LISTER

	022550'	322400	034240'		JUMPE	W,[RETURN]	;STRING ENDS WITH NULL
	022551'	260040	022617'		PJS	LOCN
	022552'	254000	022547'		JRST	LOSTR1

	022553'	505440	440600	LOSTR6:	HRLI	X,(POINT 6,0)	;OUTPUT SIXBIT WORD TO LISTING
	022554'	134400	000011	LSTR61:	ILDB	W,X
	022555'	322400	034240'		JUMPE	W,[RETURN]	;TERMINATE ON BLANK
	022556'	271400	000040		ADDI	W,40		;CONVERT TO ASCII
	022557'	260040	022617'		PJS	LOCN
	022560'	603440	770000		TLNE	X,770000	;END OF SIXBIT WORD
	022561'	254000	022554'		JRST	LSTR61		;NO
	022562'	263040	000000		RETURN			;TERMINATE ON SIX CHARACTERS

	022563'			LOBYTE:				;OUTPUT BYTE TO LISTING FILE IN HEX FORMAT.
	022563'	246400	777774		LSHC	W,-4		;LEFT BYTE TO RIGHT OF W
	022564'	301400	000012		CAIL	W,12
	022565'	271400	000007		ADDI	W,7
	022566'	271400	000060		ADDI	W,60		;CONVERT TO HEX
	022567'	260040	022612'		PJS	LOC
	022570'	400400	000000		SETZ	W,
	022571'	246400	000004		LSHC	W,4
	022572'	301400	000012		CAIL	W,12
	022573'	271400	000007		ADDI	W,7
	022574'	271400	000060		ADDI	W,60
	022575'	260040	022612'		PJS	LOC
	022576'	606200	000001		TRNN	V,1
	022577'	263040	000000		RETURN
	022600'	201400	000040		MOVEI	W," "
	022601'	260040	022612'		PJS	LOC		;BLANK AFTER HALFWORD
	022602'	263040	000000		RETURN

	022603'	201400	000015	LOEOL:	MOVEI	W,15		;OUTPUT <CR>
	022604'	260040	022617'		PJS	LOCN
	022605'	201400	000012		MOVEI	W,12		;OUTPUT <LF>
	022606'	260040	022617'		PJS	LOCN
	022607'	370000	002765'		SOS	LNLEFT		;DECREMENT LINES LEFT ON PAGE
	022610'	402000	003144'		SETZM	TXTOUT		;SET NO TEXT OUTPUT YET
	022611'	263040	000000		RETURN

	022612'	260040	022617'	LOC:	PJS	LOCN		;OUTPUT CHARACTER
	022613'	344300	034240'		AOJA	VS,[RETURN]	;AND COUNT IT

	022614'	057440	000000	LOC0:	OUT	LCH,
	022615'	254000	022617'		JRST	LOCN
	022616'	031000	034403'		PE	MSLFF,ABORT
				;
				;	The following check is a double check to insure that
				;	proprietary code cannot be listed. LOCN should never be called
				;	if LSLOCK is set.
				;
	022617'	602640	400000	LOCN:	TRNE	F,LSLOCK
	022620'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	022621'	375000	002303'		SOSGE	LOH+2
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 11-7
NAD01.R06	24-JUL-87 17:39		LISTER

	022622'	254000	022614'		JRST	LOC0
	022623'	136400	002302'		IDPB	W,LOH+1
	022624'	263040	000000		RETURN

	022625'	336000	000777'	FILLHX:	SKIPN	LSTMSK		;IF PASS 1 LISTING, NO HEX TO FILL
	022626'	301300	000020		CAIL	VS,HEXSIZ	;HEX POSITIONS FULL?
	022627'	263040	000000		RETURN
	022630'	201400	000011		MOVEI	W,11		;TAB THRU HEX POSITIONS
	022631'	260040	022612'		PJS	LOC
	022632'	271300	000007		ADDI	VS,7
	022633'	254000	022625'		JRST	FILLHX

	022634'	333000	002762'	LSCOPY:	SKIPLE	LSTLN		;ANYMORE OF LINE TO LIST?
	022635'	254000	022664'		JRST	LSC1A		;NO. JUST LIST NEW LINE.
	022636'	200300	003144'		MOVE	VS,TXTOUT	;GET COUNT OF TEXT OUTPUT SO FAR
	022637'	332000	002763'		SKIPE	SAVCHR		;CONTINUATION LINE?
					JRST	[MOVEI W,"*"	;YES. START LINE WITH "**"
						 PJS LOC
						 PJS LOC
	022640'	254000	034404'			 JRST LSC0]
	022641'	331000	002762'		SKIPL	LSTLN		;FIRST LINE?
	022642'	254000	022646'		JRST	LSC0		;NO. DON'T SETUP POINTERS AGAIN
	022643'	402000	002762'		SETZM	LSTLN		;SET PART OF LINE LISTED
	022644'	200140	022746'		MOVE	C,BLSVP		;SET TO POINT AT BEGINNING OF LINE
	022645'	250100	006252'		EXCH	I,LISTI
	022646'	260040	022714'	LSC0:	PJS	LSCHR		;GET FIRST CHARACTER OF LIST LINE
	022647'	306400	000040		CAIN	W," "		;IF IT IS A BLANK
	022650'	607640	001000		TLNN	F,LSCEOL	;AND LAST STATEMENT ENDED WITH A SEMICOLON
	022651'	254000	022654'		JRST	LSC1		;NOT THE CASE
	022652'	607640	020000		TLNN	F,LSCNF		;AND THIS IS NOT A NOLIST OR UNTRUE IF
	022653'	201400	000011		MOVEI	W,"I"-100	;THEN REPLACE LEADING BLANK WITH TAB
	022654'	322400	022672'	LSC1:	JUMPE	W,LSC3		;END OF STATEMENT. GO OUTPUT TERMINATOR
	022655'	306400	000015		CAIN	W,15		;CARRIAGE RETURN?
					JRST	[PJS LSCHR	;YES. IGNORE LINEFEED
	022656'	254000	034410'			 JRST LSC1A]
	022657'	306400	000011		CAIN	W,11		;TAB?
					JRST	[ANDCMI VS,7	;YES. MOVE TO NEXT TAB STOP
						 ADDI VS,7
	022660'	254000	034412'			 JRST LSC1B]
	022661'	315300	002764'	LSC1B:	CAMGE	VS,TXTSIZ	;ROOM FOR THIS CHARACTER?
	022662'	254000	022667'		JRST	LSC2		;YES
	022663'	202400	002763'		MOVEM	W,SAVCHR	;NO. SAVE FOR REST OF LISTING
	022664'	260040	022603'	LSC1A:	PJS	LOEOL		;GO TO NEW LINE
	022665'	621640	021000		TLZ	F,LSCEOL+LSCNF	;INDICATE NEW LINE
	022666'	263040	000000		RETURN
	022667'	260040	022612'	LSC2:	PJS	LOC		;OUTPUT CHARACTER TO LISTING FILE
	022670'	260040	022714'		PJS	LSCHR		;GET NEXT STATEMENT CHARACTER
	022671'	254000	022654'		JRST	LSC1

	022672'	350000	002762'	LSC3:	AOS	LSTLN		;NO MORE OF LINE TO LIST
	022673'	135400	000002		LDB	W,I		;GET STATEMENT TERMINATOR
	022674'	302400	000073		CAIE	W,";"		;WAS TERMINATOR SEMICOLON?
	022675'	254000	022702'		JRST	LSC4		;NO, WAS A <CR>
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 11-8
NAD01.R06	24-JUL-87 17:39		LISTER

	022676'	607640	000040		TLNN	F,NOLIST
	022677'	332000	003201'		SKIPE	TRUTH
	022700'	254000	022710'		JRST	LSC5		;UNTRUE IF BODY
	022701'	665640	001000		TLOA	F,LSCEOL
	022702'	621640	001000	LSC4:	TLZ	F,LSCEOL
	022703'	621640	020000		TLZ	F,LSCNF
	022704'	306400	000014		CAIN	W,14		;WAS LINE TERMINATED WITH <FF>?
					JRST	[SETZM LNLEFT	;FORCE TOP OF FORM AT "LSTART"
	022705'	254000	034415'			 RETURN]
	022706'	260040	022603'		PJS	LOEOL		;OUPUT <CR><LF>
	022707'	263040	000000		RETURN

	022710'	260040	022612'	LSC5:	PJS	LOC		;NOLIST OR UNTRUE IF BODY, LIST AS IS
	022711'	661640	021000		TLO	F,LSCEOL!LSCNF	;SET NOLIST/UNTRUE IF AND ; TERMINATOR
	022712'	202300	003144'		MOVEM	VS,TXTOUT	;SAVE TEXT OUTPUT SO FAR
	022713'	263040	000000		RETURN

				;GET CHARACTERS OF STATEMENT TO BE LISTED. STATEMENT WILL NORMALLY
				;BE POINTER TO BY "LISTI" AND TERMINATE AT "I". IF THE INPUT SOURCE
				;EVER CHANGED DUE TO END OF INPUT BUFFER OR A MACRO CALL, THEN
				;THE BEGINNING OF THE STATEMENT WILL BE POINTED TO BY "BLSVP" AND
				;WILL TERMINATE AT "LSVP".
	022714'	332400	002763'	LSCHR:	SKIPE	W,SAVCHR	;CHARACTER FROM PREVIOUS LINE?
					JRST	[SETZM SAVCHR	;YES. USE IT
	022715'	254000	034417'			 RETURN]
	022716'	316140	006251'		CAMN	C,LSVP		;ANYMORE TEXT IN SAVED BUFFER?
	022717'	254000	022722'		JRST	LSCHR1		;NO. GET REST OF TEXT FROM MAIN SOURCE
	022720'	134400	000003		ILDB	W,C		;GET NEXT CHARACTER FROM SAVED BUFFER
	022721'	263040	000000		RETURN
	022722'	134400	000002	LSCHR1:	ILDB	W,I		;GET NEXT MAIN BUFFER CHARACTER
	022723'	316100	006252'		CAMN	I,LISTI		;IS THIS THE STATEMENT TERMINATOR
	022724'	634400	000010		TDZA	W,W		;YES. RETURN NULL INSTEAD
	022725'	322400	022722'		JUMPE	W,LSCHR1	;IGNORE NULLS IN MAIN BUFFER
	022726'	263040	000000		RETURN

				;MOVE ALL THE TEXT (EXCLUDING NULLS) BETWEEN "LISTI" AND "I" TO
				;LIST SAVE BUFFER
	022727'	335000	003250'	LSVLNE:	SKIPGE	LSVCNT		;WAS BUFFER ALREADY FILLED?
	022730'	254000	022744'		JRST	LSVL3		;YES. DON'T TYPE ERROR MESSAGE AGAIN.
	022731'	134140	006252'	LSVL1:	ILDB	C,LISTI		;GET NEXT CHARACTER TO SAVE
	022732'	316100	006252'		CAMN	I,LISTI		;ANYMORE TEXT IN BUFFER
	022733'	263040	000000		RETURN			;NO. RETURN
	022734'	322140	022731'		JUMPE	C,LSVL1		;IGNORE NULLS
	022735'	375000	003250'		SOSGE	LSVCNT		;ANY ROOM IN BUFFER?
	022736'	254000	022741'		JRST	LSVL2		;NO
	022737'	136140	006251'		IDPB	C,LSVP		;PUT INTO LISTER SAVE BUFFER
	022740'	254000	022731'		JRST	LSVL1
	022741'	261040	000000	LSVL2:	PUSH	S,0		;SAVE TO TYPE ERROR
	022742'	035000	034421'		TYPE	<$STATEMENT TRUNCATED IN LISTING.>
	022743'	262040	000000		POP	S,0
	022744'	202100	006252'	LSVL3:	MOVEM	I,LISTI		;RESET FOR NEXT MOVE
	022745'	263040	000000		RETURN
	022746'	440700	003251'	BLSVP:	POINT	7,LSTBUF	;POINTER TO BEGINNING OF BUFFER
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 11-9
NAD01.R06	24-JUL-87 17:39		LISTER


				; PUT DATE AND TIME IN STANDARD TITLE.
	022747'	047400	000014	TTLDAT:	DATE	W,		;GET DATE FROM SYSTEM
	022750'	231400	000037		IDIVI	W,^D31		;W=(MONTH-1)+12*(YEAR-1964),X=DAY-1
	022751'	271440	000001		ADDI	X,1		;X=DAY
	022752'	200200	034430'		MOVE	V,[POINT 7,STDTTL+2,20]
	022753'	231440	000012		IDIVI	X,^D10
	022754'	271440	000060		ADDI	X,"0"
	022755'	306440	000060		CAIN	X,"0"
	022756'	201440	000040		MOVEI	X," "
	022757'	136440	000004		IDPB	X,V
	022760'	271500	000060		ADDI	Y,"0"
	022761'	136500	000004		IDPB	Y,V
	022762'	231400	000014		IDIVI	W,^D12		;W=YEAR-1964,X=MONTH-1
	022763'	200451	002774'		MOVE	X,MONTH(X)
	022764'	202440	002771'		MOVEM	X,STDTTL+3
	022765'	200200	034431'		MOVE	V,[POINT 7,STDTTL+4]
	022766'	271400	000100		ADDI	W,^D64		;W=YEAR-1900
	022767'	231400	000012		IDIVI	W,^D10
	022770'	271400	000060		ADDI	W,"0"
	022771'	136400	000004		IDPB	W,V
	022772'	271440	000060		ADDI	X,"0"
	022773'	136440	000004		IDPB	X,V
	022774'	047440	000023		MSTIME	X,		;GET TIME IN MILLISEC FROM SYSTEM
	022775'	231440	165140		IDIVI	X,^D1000*^D60	;CONVERT TO MINUTES
	022776'	231440	000074		IDIVI	X,^D60		;X=HOURS,Y=MINUTES
	022777'	133000	000004		IBP	V		;SKIP TO TIME FIELD
	023000'	200400	000011		MOVE	W,X
	023001'	231400	000012		IDIVI	W,^D10
	023002'	271400	000060		ADDI	W,"0"
	023003'	306400	000060		CAIN	W,"0"
	023004'	201400	000040		MOVEI	W," "
	023005'	136400	000004		IDPB	W,V
	023006'	271440	000060		ADDI	X,"0"
	023007'	136440	000004		IDPB	X,V
	023010'	133000	000004		IBP	V		;SKIP OVER ":"
	023011'	200440	000012		MOVE	X,Y		;GET MINUTES
	023012'	231440	000012		IDIVI	X,^D10
	023013'	271440	000060		ADDI	X,"0"
	023014'	136440	000004		IDPB	X,V
	023015'	271500	000060		ADDI	Y,"0"
	023016'	136500	000004		IDPB	Y,V
	023017'	263040	000000		RETURN

				;	OUTPUT BEGIN CREF LISTING CODE IF NOT ALREADY OUT?
	023020'	662640	002000	BEGCRF:	TROE	F,INCREF	;IS CODE ALREADY OUT?
	023021'	263040	000000		RETURN
	023022'	201400	000177		MOVEI	W,177		;OUTPUT BEGIN CREF CODE
	023023'	260040	022617'		PJS	LOCN
	023024'	201400	000102		MOVEI	W,102
	023025'	260040	022617'		PJS	LOCN
	023026'	263040	000000		RETURN

NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 11-10
NAD01.R06	24-JUL-87 17:39		LISTER

				;	OUTPUT END CREF LISTING CODE. END CODE IN "X".
	023027'	626640	002000	ENDCRF:	TRZN	F,INCREF
	023030'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	023031'	201400	000177		MOVEI	W,177
	023032'	260040	022617'		PJS	LOCN
	023033'	200400	000011		MOVE	W,X
	023034'	260040	022617'		PJS	LOCN
	023035'	263040	000000		RETURN

				;	COMPUTE NUMBER OF CHARACTERS IN SIXBIT SYMBOL IN "L".
				;	RETURN IN "W".
	023036'	201400	000006	SYMSIZ:	MOVEI	W,6		;ASSUME SIX CHARS IN LENGTH
	023037'	616550	023041'		TDNN	L,SIXMSK-1(W)
	023040'	367400	023037'		SOJG	W,.-1
	023041'	263040	000000		RETURN

	023042'	770000	000000	SIXMSK:	EXP	770000000000,7700000000,77000000,770000,7700,77
	023043'	007700	000000
	023044'	000077	000000
	023045'	000000	770000
	023046'	000000	007700
	023047'	000000	000077

				;	OUTPUT SIXBIT SYMBOL IN "L" TO CREF FILE PRECEDED BY CODE IN "W".
	023050'	260040	022617'	OUTSYM:	PJS	LOCN
	023051'	260040	023036'		PJS	SYMSIZ		;GET SYMBOL SIZE
	023052'	260040	022617'		PJS	LOCN		;AND OUTPUT IT
	023053'	201440	000013		MOVEI	X,L		;ADDRESS SYMBOL
	023054'	260040	022553'		PJS	LOSTR6		;AND OUTPUT IT
	023055'	263040	000000		RETURN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

					SUBTTL	DIRECTIVE PROCESSORS
				;		**************************************************

				;DEFINE MACRO
	023056'	336540	000462'	DMAC:	SKIPN	L,LABEL		;NAME MUST BE IN LABEL FIELD
	023057'	031000	034432'		PE	MSMLF,XPSBI	;ELSE ERROR
	023060'	525440	237777		HRLOI	X,237777	;SEE IF MACRO NAME IS USE OTHER
	023061'	202440	006326'		MOVEM	X,MM1		; THAN AS A MACRO OR OPCODE
	023062'	260040	020203'		PJS	FY
	023063'	332000	000014		SKIPE	M		;IS IT ALREADY IN USE
	023064'	031000	034433'		PE	MMNIU,XPSBI	;YES. ERROR
	023065'	525440	777757		HRLOI	X,-<NMACA+1>	;INITIALIZE AGRUMENT COUNT
	023066'	202440	013065'		MOVEM	X,NMARGS
	023067'	661640	000020		TLO	F,NOMACX	;DON'T ALLOW ARGS TO BE MACRO NAMES
	023070'	260040	021742'		PJS	FBT		;FLUSH BLANKS AND TABS
	023071'	260040	021753'		PJS	GCHR		;GET NEXT CHAR
	023072'	302140	000050		CAIE	C,"("		;ARGS MUST BE SURROUNDED BY PARENS
	023073'	254000	023120'		JRST	DMAC6		;NO ARGS
	023074'	260040	017525'	DMAC1:	PJS	GK
	023075'	200440	013065'		MOVE	X,NMARGS
	023076'	256005	023077'		XCT	DMAC7(U)	;FOR NOW, MUST BE SYMBOL
	023077'	031000	034434'	DMAC7:	PE	MSSE,XPSBI
	023100'	031000	034434'		PE	MSSE,XPSBI
	023101'	254000	023106'		JRST	DMAC0
	023102'	254000	023106'		JRST	DMAC0
	023103'	031000	034435'		PE	MSSE,[RETURN]
	023104'	031000	034435'		PE	MSSE,[RETURN]
	023105'	031000	034435'		PE	MSSE,[RETURN]
	023106'	252440	034437'	DMAC0:	AOBJP	X,[ PE MTMMA,[RETURN]]
	023107'	202551	013066'		MOVEM	L,MACARG(X)
	023110'	202440	013065'		MOVEM	X,NMARGS
	023111'	260040	017525'		PJS	GK
	023112'	316140	033016'		CAMN	C,CT+","	;MORE ARGS IF COMMA
	023113'	254000	023074'		JRST	DMAC1
	023114'	312140	033013'		CAME	C,CT+")"	;DONE IF RIGHT PAREN
	023115'	031000	034440'		PE	MSSE,XPSBI1	;ELSE ERROR
	023116'	660640	100000		TRO	F,MBSCAN	;set scanning macro body
	023117'	260040	021753'	DMAC2:	PJS	GCHR		;GET NEXT CHAR
	023120'	302140	000015	DMAC6:	CAIE	C,15		;SKIPPING OVER CARRIGE RETURN
	023121'	254000	023124'		JRST	DMAC61		;NO
	023122'	336000	013056'		INCLC	
	023123'	350000	006256'		;YES. INCREMENT LINE COUNTER
	023124'	302140	000133	DMAC61:	CAIE	C,"["		;SEARCH FOR MACRO BODY START
	023125'	254000	023117'		JRST	DMAC2
	023126'	350440	013065'		AOS	X,NMARGS	;ADD ONE TO ARGUMENT COUNT
	023127'	552440	013065'		HRRZM	X,NMARGS	;AND REMOVE BOUND CHECK
	023130'	201500	016761		MOVEI	Y,MBMAX*MBSIZ	; Number of characters in macro buffer
	023131'	202500	013053'		MOVEM	Y,MACCNT	; Save for character insertion
	023132'	201500	013106'		MOVEI	Y,MACBUF	; Byte pointer to start of macro buffer
	023133'	505500	440700		HRLI	Y,(POINT 7,0)
	023134'	400240	000000		SETZ	U,		;INIT BRACKET COUNT FOR DEFS WITHIN DEFS
	023135'	476000	013060'		SETOM	ALWARG		;ALLOW DUMMY ARGUMENT
	023136'	134140	000002	DMAC3:	ILDB	C,I
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-2
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	023137'	200203	032742'	DMAC5:	MOVE	V,CT(C)		;GET CHAR TYPE
	023140'	256004	023141'		XCT	DMAC4(V)	;Dispatch on character type

				;	DISPATCH TABLE.
	023141'	030000	023136'	DMAC4:	CIT	DMAC3		;GET MORE CHARACTERS
				;		 CRAP   DIGIT   A-F    a-f    G-Z    g-z
	023142'	254000	023170'		JV	<DMACST,DMACDG,DMACSY,DMACSY,DMACSY,DMACSY>
	023143'	254000	023173'
	023144'	254000	023204'
	023145'	254000	023204'
	023146'	254000	023204'
	023147'	254000	023204'
				;		   .      OPER  DELIM   |
	023150'	254000	023204'		JV	<DMACSY,DMACST,DMACEM,DMACST>
	023151'	254000	023170'
	023152'	254000	023160'
	023153'	254000	023170'
	023154'	032000	023136'		MEND	DMAC3		;MACRO END
	023155'	254000	023175'		JRST	DMACCA		;' (CONCATENATION OPERATOR)
	023156'	033000	023136'		MARG	DMAC3		;MACRO ARGUMENT
	023157'	034000	023136'		MAE	DMAC3		;MACRO ARG END

	023160'	306140	000135	DMACEM:	CAIN	C,"]"		;MAYBE END OF MACRO BODY
	023161'	361240	023264'		SOJL	U,DMACDN	;GO FINISH IF OUTER BRACKET
	023162'	306140	000133		CAIN	C,"["		;IS THIS START OF ANOTHER MACRO
	023163'	340240	000000		AOJ	U,		;YES. INCREMENT BRACKET COUNT
	023164'	302140	000015		CAIE	C,15		;SKIPPING OVER CARRIAGE RETURN
	023165'	254000	023170'		JRST	DMACST		;NO
	023166'	336000	013056'		INCLC	
	023167'	350000	006256'		;YES. INCREMENT LINE COUNTER
	023170'	476000	013060'	DMACST:	SETOM	ALWARG		;ALLOW DUMMY ARG AFTER BREAK CHAR
	023171'	260040	023311'	DMAST1:	PJS	PUTMCH		;STUFF CHAR INTO STRING STORAGE
	023172'	254000	023136'		JRST	DMAC3

	023173'	402000	013060'	DMACDG:	SETZM	ALWARG		;DO NOT ALLOW ARG AFTER DIGIT
	023174'	254000	023171'		JRST	DMAST1

				;CONCATENATION OPERATOR
	023175'	134140	000002	DMACCA:	ILDB	C,I		;GET NEXT CHAR
	023176'	306140	000135		CAIN	C,"]"		;END MACRO CHAR IS SPECIAL CASE - TAKE LITERALLY
	023177'	254000	023170'		JRST	DMACST
	023200'	306140	000140		CAIN	C,"`"
	023201'	254000	023170'		JRST	DMACST
	023202'	476000	013060'		SETOM	ALWARG		;ALLOW ARG AFTER CONCATENATION
	023203'	254000	023137'		JRST	DMAC5		;GET ARG STRING (MAYBE)

	023204'	336000	013060'	DMACSY:	SKIPN	ALWARG		;WAS PREVIOUS CHAR A BREAK?
	023205'	254000	023171'		JRST	DMAST1		;NO. DON'T SCAN FOR DUMMY ARG
	023206'	200600	034441'		MOVE	M,[POINT 7,MSYSAV]	;INIT BYTE POINTER TO SAVE ARG
	023207'	400540	000000		SETZ	L,		;BUILD SIXBIT SYMBOL NAME IN L
	023210'	200400	034247'		MOVE	W,[POINT 6,L]
	023211'	136140	000014	DMASY7:	IDPB	C,M		;STUFF CHAR INTO SAVE AREA
	023212'	256004	023221'		XCT	DMASY1(V)	;CONVERT TO SIXBIT OR FINISH UP
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-3
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	023213'	607400	770000		TLNN	W,770000	;SIX CHARS COLLECTED ALREADY?
	023214'	254000	023242'		JRST	DMASY4		;YES. DO NAT SAVE ANYMORE
	023215'	136140	000010		IDPB	C,W		;NO. PUT INTO NAME
	023216'	134140	000002	DMASY5:	ILDB	C,I		;GET NEXT CHARACTER
	023217'	200203	032742'		MOVE	V,CT(C)		;GET CHARACTER TYPE
	023220'	254000	023211'		JRST	DMASY7

				;	ANOTHER DISPATCH TABLE
	023221'	030000	023240'	DMASY1:	CIT	DMASY6		;GET MORE CHARACTERS
	023222'	254000	023243'		JRST	DMASY3		;GARBAGE CHARACTERS
	023223'	275140	000040		SUBI	C,40		;DIGIT
	023224'	275140	000040		SUBI	C,40		;A-F
	023225'	405140	000077		ANDI	C,77		;a-f
	023226'	275140	000040		SUBI	C,40		;G-Z
	023227'	405140	000077		ANDI	C,77		;g-z
	023230'	201140	000016		MOVEI	C,'.'		; .
				;		  OPR    DELIM   |
	023231'	254000	023243'		JV	<DMASY3,DMASY3,DMASY3>
	023232'	254000	023243'
	023233'	254000	023243'
	023234'	032000	023240'		MEND	DMASY6		;MACRO END
	023235'	254000	023243'		JRST	DMASY3		;' CONCATENATION OPERATOR
	023236'	033000	023240'		MARG	DMASY6		;MACRO ARGUMENT
	023237'	034000	023240'		MAE	DMASY6		;MACRO ARG END

	023240'	270600	006336'	DMASY6:	ADD	M,BACKUP	;BACKUP OVER TRAP CHARACTER
	023241'	254000	023216'		JRST	DMASY5

	023242'	402000	013060'	DMASY4:	SETZM	ALWARG		;IF ARG ENDED WITH ALPHA, DO NOT ALLOW ARG
	023243'	270100	006336'	DMASY3:	ADD	I,BACKUP	;BACK UP TEXT PTR
	023244'	200440	013065'		MOVE	X,NMARGS	;GET ARG COUNT
	023245'	361440	023255'	DMASY2:	SOJL	X,DMASY8	;SEE IF SYMBOL IS ARG
	023246'	312551	013066'		CAME	L,MACARG(X)
	023247'	254000	023245'		JRST	DMASY2
	023250'	201140	000001		MOVEI	C,1		;INSERT MACRO ARG CHAR
	023251'	260040	023311'		PJS	PUTMCH
	023252'	350140	000011		AOS	C,X		;ADJUST ARG INDEX TO RANGE 1-NMARGS
	023253'	260040	023311'		PJS	PUTMCH		;AND PUT IN MACRO BODY
	023254'	254000	023136'		JRST	DMAC3
	023255'	400140	000000	DMASY8:	SETZ	C,		;PUT NULL AT END OF SAVED TEXT
	023256'	137140	000014		DPB	C,M
	023257'	200600	034441'		MOVE	M,[POINT 7,MSYSAV]	;POINT TO BEGINNING
	023260'	134140	000014	DMASY9:	ILDB	C,M		;GET NEXT SAVED CHARACTER
	023261'	322140	023136'		JUMPE	C,DMAC3		;EXIT IF END
	023262'	260040	023311'		PJS	PUTMCH		;PUT INTO MACRO TEXT
	023263'	254000	023260'		JRST	DMASY9

	023264'	620640	100000	DMACDN:	TRZ	F,MBSCAN	;clear scanning for macro body
	023265'	201140	000003		MOVEI	C,"C"-100
	023266'	260040	023311'		PJS	PUTMCH		;STUFF MACRO END CHAR
	023267'	335000	013053'		SKIPGE	MACCNT		;is macro text too big?
	023270'	254000	023303'		JRST	DMACD1		;yes. don't define.
	023271'	260040	023361'		PJS	FMACD		; Move definition to free space
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-4
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	023272'	200300	013061'		MOVE	VS,MCHCNT	; Get number of blocks in definition
	023273'	242300	000011		LSH	VS,9		; BLOCK ADDRESS IN BITS 0-17, BLOCK SIZE
	023274'	270300	013065'		ADD	VS,NMARGS	; IN BITS 18-26 AND NUMBER OF ARGUMENTS
	023275'	504300	013064'		HRL	VS,MACTXT	; IN BITS 27-35.
	023276'	515240	000002		HRLZI	U,2		;SPECIFY MACRO MODULE
	023277'	400540	000000		SETZ	L,		;GET MACRO NAME TO L
	023300'	250540	000462'		EXCH	L,LABEL
	023301'	260040	020276'		PJS	DOM		;MAKE SYMTAB ENTRY
	023302'	263040	000000		RETURN
	023303'	035000	034442'	DMACD1:	TYPE	<Macro body for macro >
	023304'	200240	000462'		MOVE	U,LABEL
	023305'	260040	022000'		PJS	TYP6		;type name of macro
	023306'	035000	034447'		TYPE	< too big>
	023307'	402000	000462'		SETZM	LABEL		;insure label is not defined
	023310'	263040	000000		RETURN

				;	Put character in macro definition buffer. Insure that it will fit

	023311'	371000	013053'	PUTMCH:	SOSL	MACCNT		; Anymore room in buffer
	023312'	136140	000012		IDPB	C,Y		; Yes. Put in buffer
	023313'	263040	000000		RETURN

				;
				; Request a block of size specified by MCHCNT. Return address in MACTXT.
				; Get block from list, choosing largest block or if none large enough,
				; get new memory.
				;
	023314'	200440	013061'	GMACD:	MOVE	X,MCHCNT	; Number of cells needed
	023315'	302440	000001		CAIE	X,1		; Is only a single cell needed?
	023316'	254000	023324'		JRST	GMACD1		; No.
	023317'	336420	006600'		GFL	
	023320'	260040	020656'
	023321'	250400	006600'			; Get a single cell from free list
	023322'	552400	013064'		HRRZM	W,MACTXT	; Save address of single cell
	023323'	263040	000000		RETURN
	023324'	201400	013047'	GMACD1:	MOVEI	W,MACFRE	; Get list header
	023325'	540410	000000	GMACD2:	HRR	W,(W)		; Get next list entry
	023326'	315450	000001		CAMGE	X,1(W)		; Is largest block too big?
	023327'	254000	023325'		JRST	GMACD2		; Yes, go try next
	023330'	317450	000001		CAMG	X,1(W)		; Is block the same size as needed?
	023331'	254000	023347'		JRST	GMACD3		; Yes, go use it
	023332'	544410	000000		HLR	W,(W)		; Get previous block
	023333'	317450	000001		CAMG	X,1(W)		; Is it big enough?
	023334'	254000	023347'		JRST	GMACD3		; Yes. Use it
	023335'	550400	006605'		HRRZ	W,YEND		; Get block from new memory
	023336'	202400	013064'		MOVEM	W,MACTXT	; Save beginning of block
	023337'	270400	013053'		ADD	W,MACCNT	; Add size of block needed in words
	023340'	607400	777777		TLNN	W,777777	; Is request past end of memory
	023341'	047400	000011		CORE	W,		; Extend memory for new block
	023342'	260040	020711'		PJS	GME		; Out of memory
	023343'	200400	013064'		MOVE	W,MACTXT	; Get beginning of block
	023344'	270400	013053'		ADD	W,MACCNT	; Add size of block needed in words
	023345'	202400	006605'		MOVEM	W,YEND		; Save new end of memory
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-5
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	023346'	263040	000000		RETURN
	023347'	260040	020332'	GMACD3: PJS	REMBLK		; Remove block from free list
	023350'	552400	013064'		HRRZM	W,MACTXT	; Save address of start of block
	023351'	200210	000001		MOVE	V,1(W)		; Get size in cells of block to use
	023352'	274200	013061'		SUB	V,MCHCNT	; Compute number of cells not used
	023353'	322200	034240'		JUMPE	V,[RETURN]	; Perfect fit. Nothing more to do
	023354'	200500	013061'		MOVE	Y,MCHCNT	; Get number of blocks used
	023355'	221500	000003		IMULI	Y,3		; Convert to number of words
	023356'	270400	000012		ADD	W,Y		; Compute address of left over block
	023357'	260040	020337'		PJS	REMAC		; Return to free list
	023360'	263040	000000		RETURN

				;	Move MACBUF to free storage.

	023361'	200200	013053'	FMACD:	MOVE	V,MACCNT	; Get number of characters remaining
	023362'	231200	000017		IDIVI	V,MBSIZ		; Convert to blocks
	023363'	201400	000777		MOVEI	W,MBMAX		; Get total number of blocks allocated
	023364'	274400	000004		SUB	W,V		; Compute number of blocks used
	023365'	202400	013061'		MOVEM	W,MCHCNT	; Save number of blocks used
	023366'	221400	000003		IMULI	W,3		; Compute number of words used
	023367'	202400	013053'		MOVEM	W,MACCNT	; Save count of words in new block
	023370'	260040	023314'		PJS	GMACD		; Get portion of free storage
	023371'	505440	013106'		HRLI	X,MACBUF	; Source address for block move
	023372'	540440	013064'		HRR	X,MACTXT	; Destination address for block move
	023373'	551511	777777		HRRZI	Y,-1(X)		; Get destination address minus one
	023374'	270500	013053'		ADD	Y,MACCNT	; Address of last word in destination
	023375'	251452	000000		BLT	X,(Y)		; Move MACBUF to free storage
	023376'	263040	000000		RETURN

	023377'	307240	000003	XPSBI1:	CAIG	U,3		;DID LAST TOKEN CAUSE I TO BE BACKED UP
	023400'	133000	000002	XPSBI:	IBP	I		;YES. RESTORE IT FOR "GSF" BACKUP
	023401'	263040	000000		RETURN

				;DELETE SYMBOLS
	023402'	261040	000015	DKIL:	PUSH	S,F		;SAVE FLAG WORD DURING SCAN
	023403'	661640	000020		TLO	F,NOMACX	;SUPPRESS MACRO EXPANSIONS
	023404'	260040	017525'	DKIL0:	PJS	GK		;GET NEXT SYMBOL NAME
	023405'	254005	023406'		JV	<.+1(U),DKIL0,DKILE,DKIL1,DKIL1,DKILE,DKILE,DKILE>
	023406'	254000	023404'
	023407'	254000	023415'
	023410'	254000	023416'
	023411'	254000	023416'
	023412'	254000	023415'
	023413'	254000	023415'
	023414'	254000	023415'
	023415'	031000	034451'	DKILE:	PE	MSSE,DKIL2
	023416'	602640	000100	DKIL1:	TRNE	F,CREF		;CREF LISTING?
					PJS	[MOVEI W,1	;YES. RECORD SYMBOL REFERENCE
						 PJS   OUTSYM
	023417'	260040	034452'			 RETURN]
	023420'	260040	020147'		PJS	DELSYM
	023421'	260040	021753'		PJS	GCHR
	023422'	306140	000054		CAIN	C,","		;CONTINUE IF COMMA
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-6
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	023423'	254000	023404'		JRST	DKIL0
	023424'	262040	000015		POP	S,F		;RESTORE FLAG WORD
	023425'	263040	000000		RETURN
	023426'	262040	000015	DKIL2:	POP	S,F		;RESTORE FLAG WORD
	023427'	254000	023377'		JRST	XPSBI1

				;	Global directive.
				;
	023430'	260040	017525'	DGL:	PJS	GK		;GET LEADING BLANKS OR AN ASCI SYMBOL
	023431'	254005	023432'		JV	<.+1(U),DGL,DGLE,DGL2,DGL2,DGLE,DGLE,DGLE>
	023432'	254000	023430'
	023433'	254000	023441'
	023434'	254000	023442'
	023435'	254000	023442'
	023436'	254000	023441'
	023437'	254000	023441'
	023440'	254000	023441'
	023441'	031000	034440'	DGLE:	PE	MSSE,XPSBI1	;SYNTAX ERROR
	023442'	606640	000100	DGL2:	TRNN	F,CREF		;cross output needed?
	023443'	254000	023450'		JRST	DGL5		;no
	023444'	201400	000001		MOVEI	W,1		;symbol definition
	023445'	260040	023050'		PJS	OUTSYM
	023446'	201400	000017		MOVEI	W,17		;global symbol
	023447'	260040	022617'		PJS	LOCN
	023450'	515240	200000	DGL5:	HRLZI	U,200000	;module mask for only globals
	023451'	250240	006326'		EXCH	U,MM1		;set as mask for symbol search
	023452'	260040	020203'		PJS	FY		;is the symbol already global?
	023453'	250240	006326'		EXCH	U,MM1		;restore current module mask
	023454'	326600	023462'		JUMPN	M,DGL3		;if already global, nothing to do
	023455'	260040	020203'		PJS	FY		;symbol already defined?
	023456'	326600	023466'		JUMPN	M,DGL4		;yes, just change its module
	023457'	400200	000000		SETZ	V,		;set value zero (empty undefined chain)
	023460'	515240	400001		HRLZI	U,SYUNDF+1	;set undefined in module 1 (global module)
	023461'	260040	020364'		PJS	MY
	023462'	260040	021753'	DGL3:	PJS	GCHR
	023463'	306140	000054		CAIN	C,","
	023464'	254000	023430'		JRST	DGL		;CONTINUE IF COMMA
	023465'	263040	000000		RETURN
	023466'	606640	200000	DGL4:	TRNN	F,MKSHAD	;making shadow table?
	023467'	254000	023475'		JRST	DGL1		;no
	023470'	260040	020712'		PJS	SHOLD		;save old definition
	023471'	500240	000014		HLL	U,M		;get old flags
	023472'	621240	000077		TLZ	U,77		;change to module 1 for globals
	023473'	661240	000001		TLO	U,1
	023474'	260040	020717'		PJS	SHNEW
	023475'	621600	000077	DGL1:	TLZ	M,77		;CHANGE TO MODULE 1 (GLOBAL)
	023476'	661600	000001		TLO	M,1
	023477'	502614	000000		HLLM	M,(M)
	023500'	254000	023462'		JRST	DGL3

	023501'	621640	000040	DLIST:	TLZ	F,NOLIST	;TURN ON LISTING
	023502'	260040	021742'		PJS	FBT		;FLUSH BLANKS AND TABS TO OPERANDS
	023503'	302140	000073		CAIE	C,";"		;CHECK FOR NO OPTIONS
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-7
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	023504'	306140	000015		CAIN	C,15
	023505'	254000	023400'		JRST	XPSBI
	023506'	306140	000072		CAIN	C,":"
	023507'	254000	023400'		JRST	XPSBI
	023510'	474200	000000		SETO	V,		;SET NO OPTIONS FOUND SWITCH
	023511'	200400	034455'	LIS1:	MOVE	W,[ANDCM F,Y]	;ASSUME SWITCH BEING SET
	023512'	260040	021753'		PJS	GCHR		;GET NEXT OPTION CHARACTER
	023513'	306140	000055		CAIN	C,"-"		;IS SWITCH BEING RESET?
					PJS	[MOVE W,[IOR F,Y]	;YES.
						 PJS  GCHR	;GET NEXT OPTION CHARACTER
						 SETZ V,	;RESET NO OPTIONS FOUND SWITCH
	023514'	260040	034457'			 RETURN]
	023515'	211440	000005		MOVNI	X,NLSTOP	;NUMBER OF LIST OPTIONS
	023516'	550511	023545'	LIS2:	HRRZ	Y,LSTOP+NLSTOP(X) ;GET OPTION CHARACTER
	023517'	312140	000012		CAME	C,Y		;IS THERE A MATCH
	023520'	341440	023516'		AOJL	X,LIS2		;NO. TRY NEXT OPTION.
					JUMPE	X,[JUMPL V,LIS3	;OK IF NO OPTION FOUND
	023521'	322440	034464'			   PE MSILO,[RETURN]]
	023522'	400200	000000		SETZ	V,		;RESET NO OPTIONS FOUND SWITCH
	023523'	510511	023545'		HLLZ	Y,LSTOP+NLSTOP(X) ;GET BIT TO SET
	023524'	336000	001000'		SKIPN	DSW		;ONLY SET IF DIRECT STATEMENT
	023525'	331000	000777'		SKIPL	LSTMSK		;OR INDIRECT IN PASS 2
	023526'	256000	000010		XCT	W		;SET OR RESET IT
	023527'	260040	021753'		PJS	GCHR
	023530'	306140	000054		CAIN	C,","		;END OF OPTION LIST?
	023531'	254000	023511'		JRST	LIS1		;NO. GET ANOTHER OPTION
	023532'	336000	013056'	LIS3:	SKIPN	MACSTK		;IS A MACRO CALL?
	023533'	263040	000000		RETURN			;NO
	023534'	620640	000002		TRZ	F,SUPLST	;YES. SET SUPPRESS MACRO EXPANSION
	023535'	603640	002000		TLNE	F,LSX		;IF -X SWITCH IS NOW SET.
	023536'	660640	000002		TRO	F,SUPLST
	023537'	263040	000000		RETURN

	023540'	100000	000114	LSTOP:	XWD	LSL,"L"		; List nolist lines
	023541'	040000	000106		XWD	LSF,"F"		; List untrue if lines
	023542'	000400	000122		XWD	LSR,"R"		; List all of repeat loops
	023543'	002000	000130		XWD	LSX,"X"		; List macro expansions
	023544'	000004	000111		XWD	LSI,"I"		; List conditional stements
			000005	NLSTOP==.-LSTOP

	023545'	336000	001000'	DNLIST:	SKIPN	DSW		;SET SWITCHES IF DIRECT STATEMENT.
	023546'	331000	000777'		SKIPL	LSTMSK		;DON'T SET LIST FLAGS IF NOT LISTING
	023547'	661640	000040		TLO	F,NOLIST
	023550'	254000	023400'		JRST	XPSBI

				;"TITLE" DIRECTIVE
	023551'	200440	002760'	DTTL:	MOVE	X,CHPLN		;GET PAGE LENGTH
	023552'	275440	000056		SUBI	X,TTLMIN	;COMPUTE TITLE BOUND
	023553'	336000	001000'		SKIPN	DSW		;DIRECT STATEMENT
	023554'	254000	023560'		JRST	DTTL1		;NO
	023555'	660640	020000		TRO	F,LSTDTL	;SET DEFAULT TITLE TO BE LISTED.
	023556'	201400	003034'		MOVEI	W,DTTLBF	;PUT TEXT IN DEFAULT TITLE BUFFER
	023557'	254000	023567'		JRST	DTTL2
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-8
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	023560'	332000	000777'	DTTL1:	SKIPE	LSTMSK		;IS THIS PASS 2
	023561'	606640	000010		TRNN	F,LPASS2	;OR IS THERE NO PASS TWO LISTING?
	023562'	254000	023400'		JRST	XPSBI		;YES. IGNORE TITLE
	023563'	626640	000040		TRZN	F,TTLFND	;HAS A TITLE ALREADY BEEN FOUND?
	023564'	031000	034466'		PE	MSOTPF,XPSBI	;YES. ERROR
	023565'	660640	010000		TRO	F,LSTTTL	;SET TITLE TO BE LISTED.
	023566'	201400	003010'		MOVEI	W,TTLBF		;PUT TEXT IN TITLE BUFFER
	023567'	260040	023625'	DTTL2:	PJS	GETTXT
	023570'	402000	003142'		SETZM	SECNUM		;START A SECTION ONE
	023571'	254000	023400'		JRST	XPSBI

				;"SUBTTL" DIRECTIVE
	023572'	200440	002760'	DSTL:	MOVE	X,CHPLN		;GET LINE SIZE
	023573'	275440	000031		SUBI	X,STLMIN	;COMPUTE SUBTITLE BOUND
	023574'	602700	000004		TRNE	F2,CRFLST
	023575'	275440	000010		SUBI	X,10
	023576'	336000	001000'		SKIPN	DSW		;DIRECT STATEMENT
	023577'	254000	023603'		JRST	DSTL1		;NO
	023600'	201400	003111'		MOVEI	W,DSTLBF	;PUT SUBTITLE IN DEFAULT BUFFER
	023601'	260040	023625'		PJS	GETTXT
	023602'	254000	023400'		JRST	XPSBI
	023603'	201400	003060'	DSTL1:	MOVEI	W,STLBF		;PUT TEXT IN SUBTITLE BUFFER
	023604'	336000	000777'		SKIPN	LSTMSK		;PASS 1?
	023605'	254000	023617'		JRST	DSTL2		;NO. PASS 2
	023606'	606640	000014		TRNN	F,LPASS1+LPASS2	;WILL THERE BE A LISTING?
	023607'	254000	023400'		JRST	XPSBI		;NO. IGNORE SUBTITLE
	023610'	606640	000010		TRNN	F,LPASS2	;WILL LISTING BE IN PASS 2?
	023611'	664640	000020		TROA	F,NEWSEC	;NO. IN PASS 1. START NEW SECTION
	023612'	622640	000200		TRZE	F,FSBTTL	;PASS 2 LISTING. IS THIS FIRST SUBTITLE?
	023613'	260040	023625'		PJS	GETTXT
	023614'	606640	010000		TRNN	F,LSTTTL	;IS TITLE TO BE LISTED?
	023615'	620640	000020		TRZ	F,NEWSEC	;NO TITLE. NO NEW SECTION.
	023616'	254000	023400'		JRST	XPSBI
	023617'	602640	010000	DSTL2:	TRNE	F,LSTTTL	;IS TITLE TO BE LISTED?
	023620'	622640	000200		TRZE	F,FSBTTL	;FIRST SUBTITLE IN PASS 2?
	023621'	254000	023400'		JRST	XPSBI		;YES.IGNORE
	023622'	660640	000020		TRO	F,NEWSEC	;START NEW SECTION ON NEXT PAGE
	023623'	260040	023625'		PJS	GETTXT
	023624'	254000	023400'		JRST	XPSBI

	023625'	402010	000000	GETTXT:	SETZM	(W)		;INSURE FIRST WORD OF NULL TITLE =0
	023626'	505400	440700		HRLI	W,(POINT 7,0)	;CONSTRUCT BYTE POINTER
	023627'	260040	021753'		PJS	GCHR		;IGNORE LEADING BLANK OR TAB
	023630'	302140	000073		CAIE	C,";"		;CHECK IF END OF LINE
	023631'	306140	000015		CAIN	C,15
	023632'	254000	023642'		JRST	GTXT2
	023633'	260040	021753'	GTXT1:	PJS	GCHR
	023634'	302140	000073		CAIE	C,";"		;CHECK FOR END OF TITLE
	023635'	306140	000015		CAIN	C,15
	023636'	254000	023642'		JRST	GTXT2		;END OF TITLE
	023637'	363440	034470'		SOJLE	X,[PE MSTTL,GTXT2] ;CHECK FOR TITLE TOO LONG
	023640'	136140	000010		IDPB	C,W
	023641'	254000	023633'		JRST	GTXT1
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-9
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	023642'	400140	000000	GTXT2:	SETZ	C,		;END TITLE WITH NULL
	023643'	136140	000010		IDPB	C,W
	023644'	270100	006336'		ADD	I,BACKUP	;DECREMENT BYTE POINTER BY ONE CHARACTER
	023645'	263040	000000		RETURN

				;	"NOTTL" DIRECTIVE
	023646'	336000	001000'	DNOTTL:	SKIPN	DSW		;DIRECT STATEMENT?
	023647'	254000	023652'		JRST	DNTTL1		;NO
	023650'	620640	020000		TRZ	F,LSTDTL	;SET NOT TO LIST DEFAULT TITLE.
	023651'	254000	023400'		JRST	XPSBI
	023652'	332000	000777'	DNTTL1:	SKIPE	LSTMSK		;PASS 2?
	023653'	606640	000010		TRNN	F,LPASS2	;OR LISTING HAPPENING IN PASS 1?
	023654'	254000	023400'		JRST	XPSBI		;YES. IGNORE DIRECTIVE.
	023655'	620640	010000		TRZ	F,LSTTTL	;SET TO NOT LIST TITLE.
	023656'	254000	023400'		JRST	XPSBI

				;"SEG" DIRECTIVE
	023657'	260040	017071'	DSEG:	PJS	GE		;PICK UP ARG
	023660'	367240	034240'		SOJG	U,[RETURN]	;check for undefined or illegal expr
	023661'	301200	000000		CAIL	V,0		;CHECK RANGE
	023662'	303200	000017		CAILE	V,17
	023663'	031000	034471'		PE	MSSNOR,[RETURN]
	023664'	200400	000470'		MOVE	W,CURSEG	;SAVE CURRENT PC
	023665'	200440	000551'		MOVE	X,PC
	023666'	202450	000511'		MOVEM	X,SEGTAB(W)
	023667'	313450	000531'		CAMLE	X,SEGTOP(W)	;IS PC>MAX(PC)
	023670'	202450	000531'		MOVEM	X,SEGTOP(W)	;YES. SET MAX(PC)=PC
	023671'	202200	000470'		MOVEM	V,CURSEG	;UPDATE CURRENT SEGMENT
	023672'	200204	000511'		MOVE	V,SEGTAB(V)	;GET NEW PC
	023673'	254000	024234'		JRST	DORG1		;UPDATE PC, PROCESS LABEL

	023674'			DEN:;	END DIRECTIVE
	023674'	515400	400000		HRLZI	W,400000
	023675'	436400	006254'		IORM	W,PCL
	023676'	661640	000100		TLO	F,ENDFND	;SET END FOUND FLAG.
	023677'	603640	010000		TLNE	F,EOFF		;END OF FILE?
	023700'	263040	000000		RETURN
	023701'	254000	023400'		JRST	XPSBI

	023702'			DREM:	;REMARK DIRECTIVE. COPY REST OF STATEMENT TO CONTROLLING TTY.
	023702'	331000	000777'		SKIPL	LSTMSK
	023703'	254000	023400'		JRST	XPSBI		;PASS 1 ONLY
	023704'	260040	021753'		PJS	GCHR		;REMOVE LEADING BLANK
	023705'	302140	000073		CAIE	C,";"		;CHECK FOR END OF STATEMENT
	023706'	306140	000015		CAIN	C,15
	023707'	263040	000000		RETURN
	023710'	260040	021753'	DREM1:	PJS	GCHR
	023711'	302140	000073		CAIE	C,";"
	023712'	306140	000015		CAIN	C,15
	023713'	263040	000000		RETURN			;COPY TO STATEMENT DELIMITER
	023714'	606640	001000		TRNN	F,PRPTOK	;if remark started in non proprietary code
	023715'	606640	004000		TRNN	F,PRPCOD	;and now in proprietary code
	023716'	334000	000000		SKIPA
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-10
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	023717'	254000	023710'		JRST	DREM1		;then don't print proprietary remark
	023720'	306140	000045		CAIN	C,"%"
	023721'	254000	023724'		JRST	DREM2
	023722'	051040	000003		OUTCHR	C
	023723'	254000	023710'		JRST	DREM1
	023724'	260040	021750'	DREM2:	PJS	TYPEOL
	023725'	254000	023710'		JRST	DREM1		;OUTPUT % AS CAR.RET. L.F.

	023726'			DNUM:	;CONVERT NUMBER TO CURRENT RADIX AND TYPE IT ON CONTROLLING TTY
	023726'	260040	017071'		PJS	GE
	023727'	367240	034240'		SOJG	U,[RETURN]	;check for undefined or illegal expr
	023730'	200500	006333'		MOVE	Y,TRADIX
	023731'	335000	000777'		SKIPGE	LSTMSK
	023732'	260040	022015'		PJS	TN
	023733'	263040	000000		RETURN

	023734'			DLNO:	;Return the current line number as the value of the directive
	023734'	200200	006256'		MOVE	V,LC		;Get current line number
	023735'	254000	024250'		JRST	DEQ1		;Use as value to be EQuated to label

	023736'			DNADV:	;Return the NAD version as an octal number
	023736'	201200	000001		MOVEI	V,VERSION	;Get version
	023737'	221200	000400		IMULI	V,^D<16*16>	;Move left two hex digits
	023740'	271200	000006		ADDI	V,REVISION	;Add on revision
	023741'	254000	024250'		JRST	DEQ1		;Use as value to be EQuated to label

	023742'			DERRCT:	;Return the number of assembly errors encountered so far
	023742'	200200	003170'		MOVE	V,ERRCNT	;Get error count
	023743'	254000	024250'		JRST	DEQ1		;Use as value to be EQuated to label

	023744'			DUNCT:	;Return the number of undefined's currently in symbol table
	023744'	400200	000000		SETZ	V,		;Start with no undefined symbols
	023745'	211300	002007		MOVNI	VS,HASHSZ	;get size of table
	023746'	550346	010617'	DUNCT1:	HRRZ	OS,EYH(VS)	;Get next table entry;
	023747'	322340	023754'	DUNCT2:	JUMPE	OS,DUNCT3	;End of chain, go to next.
	023750'	335407	000000		SKIPGE	W,(OS)		;undefined
	023751'	340200	000000		AOJ	V,		;Yes
	023752'	550340	000010		HRRZ	OS,W		;Get next pointer in chain.
	023753'	254000	023747'		JRST	DUNCT2
	023754'	341300	023746'	DUNCT3:	AOJL	VS,DUNCT1
	023755'	254000	024250'		JRST	DEQ1

	023756'			DCGMT:	;Return the current time in network time, seconds since 1/1/74
	023756'	200200	003171'		MOVE	V,GMTVAL	;Get GMT saved at assembly start
	023757'	332000	001000'		SKIPE	DSW		;Is it direct?
	023760'	260040	023762'		PJS	GETGMT		;Yes, compute GMT
	023761'	254000	024250'		JRST	DEQ1		;Go equate to label

	023762'	047200	000014	GETGMT:	DATE	V,		;get current date in time zone
	023763'	202200	003172'		MOVEM	V,TIMFIX	;save for conversion
	023764'	047200	000022		TIMER	V,		;get time since midnight in jiffies
	023765'	202200	003173'		MOVEM	V,TIMFIX+1	;and also save
	023766'	200200	034472'		MOVE	V,[XWD 0,400020]
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-11
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	023767'	202200	003174'		MOVEM	V,TIMFIX+2
	023770'	201200	003172'		MOVEI	V,TIMFIX
	023771'	047200	777723		DATUUO	V,		;convert to GMT and days since 1/1/64
	023772'	255000	000000		JFCL
	023773'	200200	003172'		MOVE	V,TIMFIX	;get days since 1/1/64
	023774'	275200	007105		SUBI	V,^D<3653>	;convert to days since 1/1/74 for ISIS
	023775'	221200	250600		IMULI	V,^D<24*60*60>	;convert to seconds since 1/1/74
	023776'	250200	003173'		EXCH	V,TIMFIX+1	;get jiffies since midnight
	023777'	231200	000074		IDIVI	V,^D<60>	;convert to seconds since midnight
	024000'	270200	003173'		ADD	V,TIMFIX+1	;add seconds to midnight from 1/1/74
	024001'	263040	000000		RETURN
	
	024002'			DQUIT:	;Abort assembly. Clear command files and input buffer. If operand
					;is true, return to executive level. Otherwise return to NAD debug level.
	024002'	260040	017071'		PJS	GE		;Get operand
	024003'	367240	034240'		SOJG	U,[RETURN]	;Error if U = 2 or 3
	024004'	260040	022147'		PJS	CFACLS		;Close all command files.
	024005'	051440	000000		CLRBFI
	024006'	327200	016774'		JUMPG	V,NADEX		;If operand true (>0), exit NAD
	024007'	254000	016767'		JRST	ABORT		;Otherwise just abort the assembly.

	024010'			DRE:;	REPEAT DIRECTIVE
	024010'	332000	003211'		SKIPE	RPPTR		;IS THIS OUTER REPEAT BLOCK?
	024011'	254000	024016'		JRST	DRE1		;NO, DON'T SAVE PLACE
	024012'	200400	006256'		MOVE	W,LC		;STORE STATE INFORMATION
	024013'	202400	003206'		MOVEM	W,RELINE	;FOR ERROR HANDLING
	024014'	120400	000464'		DMOVE	W,LLABEL
	024015'	124400	003207'		DMOVEM	W,RELABL
	024016'	260040	017071'	DRE1:	PJS	GE
	024017'	200400	003211'		MOVE	W,RPPTR
	024020'	301400	000004		CAIL	W,RPMAX
	024021'	031000	034473'		PE	MSTMNR,DREE
	024022'	256005	024023'		XCT	.+1(U)
	024023'	254000	024031'		JRST	DRE0
	024024'	254000	024031'		JRST	DRE0
	024025'	254000	024027'		JRST	DREE
	024026'	031000	034474'		PE	MSEI,DREE
	024027'	476000	003205'	DREE:	SETOM	RPF		;MARK REPEAT FAULT. NULIFY FUTURE REPEAT FUNCTIONS.
	024030'	263040	000000		RETURN

	024031'	202210	003222'	DRE0:	MOVEM	V,RPC(W)	;STORE INITIAL REPEAT COUNTER
	024032'	621200	777700		TLZ	V,777700	;CONVERT VALUE TO ADDRESS CONSTANT
	024033'	661200	400000		TLO	V,400000	;SET TO ONLY LIST "PC"
	024034'	202200	006254'		MOVEM	V,PCL
	024035'	476010	003212'		SETOM	RPL(W)		;FLAG FOR LISTING
	024036'	336000	003211'		SKIPN	RPPTR
	024037'	254000	024042'		JRST	DRE2		;IF OUTER BLOCK
	024040'	336010	003211'		SKIPN	RPL-1(W)	;TEST BLOCK OUTSIDE THIS ONE
	024041'	402010	003212'		SETZM	RPL(W)		;IF NOT 1ST TIME THROUGH
	024042'	200440	006255'	DRE2:	MOVE	X,LINEI
	024043'	202450	003232'		MOVEM	X,RLINEI(W)
	024044'	135140	000002		LDB	C,I		;GET STATEMENT TERMINATION CHARACTER
	024045'	200143	032742'		MOVE	C,CT(C)		;GET CHARACTER TABLE ENTRY
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-12
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	024046'	260040	016646'		PJS	GSTS
	024047'	202110	003216'		MOVEM	I,RPI(W)	;MARK THE BEGINNING OF REPEAT RANGE
	024050'	200440	006256'		MOVE	X,LC
	024051'	202450	003226'		MOVEM	X,RPLC(W)
	024052'	200440	013052'		MOVE	X,MACCUR	;save current macro invocation number
	024053'	202450	003236'		MOVEM	X,RPMAC(W)
	024054'	350000	003211'		AOS	RPPTR
	024055'	263040	000000		RETURN

	024056'	260040	017071'	DER:	PJS	GE		;END REPEAT DIRECTIVE
	024057'	337400	003211'		SKIPG	W,RPPTR
	024060'	031000	034475'		PE	MSMES,DREE
	024061'	332000	013056'		SKIPE	MACSTK		;is repeat in a macro?
	024062'	254000	024072'		JRST	DER1		;yes. repeat loop all in memory. don't restrict loop size.
	024063'	550440	000002		HRRZ	X,I		;MAKE SURE REPEAT RANGE NOT LONGER THAN ONE SIDE BFR
	024064'	550510	003215'		HRRZ	Y,RPI-1(W)
	024065'	274440	000012		SUB	X,Y
	024066'	335000	000011		SKIPGE	X
	024067'	271440	002010		ADDI	X,NSB*201
	024070'	301440	000201		CAIL	X,201
	024071'	031000	034476'		PE	MSRRGT,DREE
	024072'	200440	013052'	DER1:	MOVE	X,MACCUR	;get current macro invocation number
	024073'	312450	003235'		CAME	X,RPMAC-1(W)	;has it changed?
	024074'	031000	034477'		PE	MSMEIR,DREE	;yes. error
	024075'	200440	000004		MOVE	X,V
	024076'	621440	777700		TLZ	X,777700	;CONVERT VALUE TO ADDRESS CONSTANT
	024077'	661440	400000		TLO	X,400000	;SET TO ONLY LIST "PC"
	024100'	202440	006254'		MOVEM	X,PCL
	024101'	332000	003205'		SKIPE	RPF
	024102'	263040	000000		RETURN
	024103'	402010	003211'		SETZM	RPL-1(W)	;CLEAR LISTING FLAG
	024104'	256005	024125'		XCT	DERX(U)
	024105'	374000	003211'		SOSA	RPPTR		;END OF REPEATING
	024106'	334440	006257'		SKIPA	X,LEC		;REPEAT SOME MORE
	024107'	263040	000000		RETURN
	024110'	322440	024114'		JUMPE	X,.+4
	024111'	261040	000010		PUSH	S,W
	024112'	260040	025264'		PJS	TLE
	024113'	262040	000010		POP	S,W
	024114'	200450	003231'		MOVE	X,RLINEI-1(W)
	024115'	202440	006255'		MOVEM	X,LINEI
	024116'	200110	003225'		MOVE	I,RPLC-1(W)
	024117'	202100	006256'		MOVEM	I,LC
	024120'	200110	003215'		MOVE	I,RPI-1(W)
	024121'	202100	006252'		MOVEM	I,LISTI		;ADJUST LISTER SAVE POINTER
	024122'	661640	000200		TLO	F,ENDRPT	;SET END REPEAT FOR LISTER
	024123'	402000	000464'		SETZM	LLABEL
	024124'	263040	000000		RETURN

	024125'	337000	000004	DERX:	SKIPG	V
	024126'	377010	003221'		SOSG	RPC-1(W)
	024127'	254000	024027'		JRST	DREE
	024130'	031000	034474'		PE	MSEI,DREE
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-13
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS


	024131'	332000	003202'	DIF:	SKIPE	IFC		;ONLY DO FOR OUTER IF
	024132'	254000	024137'		JRST	DIF1
	024133'	200400	006256'		MOVE	W,LC		;SAVE STATE INFORMATION
	024134'	202400	003176'		MOVEM	W,IFLINE	;IN CASE OF ERRORS
	024135'	120400	000464'		DMOVE	W,LLABEL
	024136'	124400	003177'		DMOVEM	W,IFLABL
	024137'	260040	017071'	DIF1:	PJS	GE		;GET ARG VALUE
	024140'	350400	003202'		AOS	W,IFC
	024141'	301400	000045		CAIL	W,45
	024142'	031000	034500'		PE	MSTMI,DEI1	;CHECK DEPTH
	024143'	200450	032631'		MOVE	X,LBIT-1(W)
	024144'	412440	003204'		ANDCAM	X,ELSESW	;CLEAR ELSE FLAG
	024145'	326240	024164'		JUMPN	U,DIFER		;ARG WAS UNDEFINED - REPORT ERROR
	024146'	323200	024153'		JUMPLE	V,DIF2		;FALSE ARG. DONT INCR IFT.
	024147'	603640	400000		TLNE	F,UTRUIF
	024150'	254000	024162'		JRST	DIF4		;DONT ASSEMBLE. DEEP INTO UNTRUE LEVELS.
	024151'	350000	003203'		AOS	IFT		;SET IFT=IFC
	024152'	436440	003204'		ORM	X,ELSESW	;MARK THIS LEVEL AS UNAVAILABLE TO TRUE ELSE
	024153'	621200	777700	DIF2:	TLZ	V,777700	;CONVERT VALUE TO ADDRESS CONSTANT
	024154'	661200	400000		TLO	V,400000	;SET TO ONLY LIST "PC"
	024155'	202200	006254'		MOVEM	V,PCL
	024156'	621640	400000	DIF3:	TLZ	F,UTRUIF
	024157'	200200	003202'		MOVE	V,IFC		;GET STATE OF IF. TRUE OR UNTRUE.
	024160'	312200	003203'		CAME	V,IFT
	024161'	661640	400000		TLO	F,UTRUIF
	024162'	660700	000100	DIF4:	TRO	F2,CONDST	; Indicate that this is conditional statement
	024163'	263040	000000		RETURN
	024164'	031000	034501'	DIFER:	PE	MSEI,DIF2

	024165'	260040	017071'	DELSE:	PJS	GE
	024166'	367240	024164'		SOJG	U,DIFER		;GET ASSEMBLE TRUE/FALSE ARG
	024167'	331000	000005		SKIPL	U
	024170'	201200	000001		MOVEI	V,1		;SET NULL ARG TO TRUE
	024171'	337400	003202'		SKIPG	W,IFC
	024172'	031000	034502'		PE	MSNEP,DIF4
	024173'	274400	003203'		SUB	W,IFT
	024174'	323400	024205'		JUMPLE	W,DELSE1	;THIS IF LEVEL HAS JUST RUN AS TRUE
	024175'	323200	024153'		JUMPLE	V,DIF2		;FALSE ELSE. DO NOTHING. HE MIGHT GIVE ANOTHER ELSE.
	024176'	367400	024153'		SOJG	W,DIF2		;IFC-IFT GREATER THAN 1. CANT ASSEMBLE.
	024177'	200400	003203'		MOVE	W,IFT
	024200'	200450	032632'		MOVE	X,LBIT(W)
	024201'	616440	003204'		TDNN	X,ELSESW
	024202'	350000	003203'		AOS	IFT		;TURN ON A ELSE RANGE
	024203'	436440	003204'		ORM	X,ELSESW	;BUT NOT AGAIN UNTIL THIS LEVEL HAS BEEN REGAINED IN
	024204'	254000	024153'		JRST	DIF2
	024205'	400200	000000	DELSE1:	SETZ	V,		;RETURN VALUE OF FALSE FOR LISTING
	024206'	370000	003203'		SOS	IFT
	024207'	254000	024153'		JRST	DIF2

	024210'	337400	003202'	DEI:	SKIPG	W,IFC
	024211'	031000	034503'		PE	MSNEP,XPSBI
	024212'	317400	003203'		CAMG	W,IFT
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-14
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	024213'	370000	003203'		SOS	IFT
	024214'	370000	003202'	DEI1:	SOS	IFC
	024215'	133000	000002		IBP	I
	024216'	254000	024156'		JRST	DIF3

	024217'			DBND:				;BOUND STATEMENT
				;FORCE PC TO (PC+(ARG-1))&-ARG
	024217'	260040	017071'		PJS	GE		;GET ARG VALUE
	024220'	367240	034240'		SOJG	U,[RETURN]	;check for undefined or illegal expr
	024221'	210240	000004		MOVN	U,V
	024222'	201204	777777		MOVEI	V,-1(V)
	024223'	200400	000004		MOVE	W,V		;CHECK THAT ARG IS A POWER OF 2
	024224'	404400	000005		AND	W,U
	024225'	332000	000010		SKIPE	W
	024226'	031000	034504'		PE	MAMBP2,[RETURN]
	024227'	270200	000551'		ADD	V,PC
	024230'	404200	000005		AND	V,U
	024231'	254000	024234'		JRST	DORG1

	024232'			DORG:				;ORIGIN STATEMENT
	024232'	260040	017071'		PJS	GE
	024233'	367240	034240'		SOJG	U,[RETURN]	;ERROR IF U = 2 OR 3
	024234'	311200	034505'	DORG1:	CAML	V,[1_24]	;IS PC A LEGAL ADDRESS?
	024235'	031000	034506'		PE	MSSPCO,[RETURN]
	024236'	202200	000551'		MOVEM	V,PC
	024237'	200400	000470'		MOVE	W,CURSEG	;REFERENCE CURRENT SEGMENT
	024240'	313210	000531'		CAMLE	V,SEGTOP(W)	;IS PC>MAX(PC)?
	024241'	202210	000531'		MOVEM	V,SEGTOP(W)	;YES. SET MAX(PC)=PC
	024242'	202200	006254'		MOVEM	V,PCL
	024243'	336000	000462'		SKIPN	LABEL
	024244'	263040	000000		RETURN
	024245'	254000	024250'		JRST	DEQ1

	024246'			DEQ:				;DEFINE LABEL FIELD ACCORDING TO OPERAND EXPRESSION
	024246'	260040	017071'		PJS	GE
	024247'	367240	034240'		SOJG	U,[RETURN]	;ERROR IF U = 2 OR 3
	024250'	200400	000004	DEQ1:	MOVE	W,V
	024251'	621400	377700		TLZ	W,377700
	024252'	661400	400000		TLO	W,400000
	024253'	202400	006254'		MOVEM	W,PCL
	024254'	200300	000004		MOVE	VS,V
	024255'	514240	006330'		HRLZ	U,MODULE
	024256'	400540	000000		SETZ	L,
	024257'	250540	000462'		EXCH	L,LABEL
	024260'	322540	034510'		JUMPE	L,[PE MSMLF,[RETURN]]	;ERROR EXIT IF NO LABEL FIELD
	024261'	260040	020401'		PJS	DY
	024262'	263040	000000		RETURN

	024263'	515400	400000	DBS:	HRLZI	W,400000
	024264'	436400	006254'		IORM	W,PCL		;DEFINE BYTE STORAGE
	024265'	260040	017071'		PJS	GE
	024266'	367240	034240'		SOJG	U,[RETURN]
	024267'	321200	034512'	DBS1:	JUMPL	V,[PE MSNRS,[RETURN]] ;CHECK FOR NEGATIVE
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-15
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	024270'	270200	000551'		ADD	V,PC		;GET NEW PC
	024271'	311200	034505'		CAML	V,[1_24]	;IS NEW PC TOO LARGE
	024272'	031000	034506'		PE	MSSPCO,[RETURN]	;YES
	024273'	202200	000551'		MOVEM	V,PC		;STORE NEW PC
	024274'	263040	000000		RETURN

	024275'			DHS:				;DEFINE HALFWORD STORAGE
	024275'	515400	400000		HRLZI	W,400000
	024276'	436400	006254'		IORM	W,PCL
	024277'	260040	017071'		PJS	GE
	024300'	367240	034240'		SOJG	U,[RETURN]
	024301'	242200	000001		LSH	V,1
	024302'	254000	024267'		JRST	DBS1

	024303'			DWS:				;DEFINE WORD STORAGE
	024303'	515400	400000		HRLZI	W,400000
	024304'	436400	006254'		IORM	W,PCL
	024305'	260040	017071'		PJS	GE
	024306'	367240	034240'		SOJG	U,[RETURN]
	024307'	242200	000002		LSH	V,2
	024310'	254000	024267'		JRST	DBS1

	024311'	202420	000467'	DBC:	MOVEM	W,@DOTP		;SAVE PC FOR MEMORY STORE
	024312'	260040	017071'		PJS	GE		;BYTE CONSTANT DIRECTIVE
	024313'	350000	000551'		AOS	PC
	024314'	367240	034240'		SOJG	U,[RETURN]	;check for undefined or illegal expr
	024315'	311200	034513'		CAML	V,[-400]
	024316'	301200	000400		CAIL	V,400
	024317'	031000	034514'		PE	MSOOR,.+1
	024320'	200420	000467'		MOVE	W,@DOTP
	024321'	260040	025610'		CA
	024322'	332000	000777'		CDPB	V,W
	024323'	137200	000010
	024324'	254000	024410'		JRST	DC9

	024325'			DHC:; PROCESS HALFWORD CONSTANT
	024325'	202420	000467'		MOVEM	W,@DOTP		;SAVE PC FOR MEMORY STORE
	024326'	201400	000002		MOVEI	W,2
	024327'	272400	000551'		ADDM	W,PC
	024330'	260060	006577'		PJS	@GECALL
	024331'	256005	024332'		XCT	.+1(U)		;DISPATCH ACCORDING TO GE RESULTS
	024332'	254000	024336'		JV	<DHC0,DHC0,DHC2>
	024333'	254000	024336'
	024334'	254000	024346'
	024335'	031000	034515'		PE	MSIE,[RETURN]

	024336'	311200	034260'	DHC0:	CAML	V,[-200000]
	024337'	301200	200000		CAIL	V,200000
	024340'	031000	034516'		PE	MSOOR,DC9
	024341'	200420	000467'		MOVE	W,@DOTP
	024342'	260040	025620'		CA	H
	024343'	332000	000777'		CDPB	V,W
	024344'	137200	000010
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-16
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	024345'	254000	024410'		JRST	DC9

	024346'	400240	000000	DHC2:	SETZ	U,		;HALFWORD IS CHAIN DATA TYPE 0
	024347'	400500	000000		SETZ	Y,
	024350'	250500	003156'		EXCH	Y,UCC		;UNDEFINED CHAIN IF ANY
	024351'	200300	000551'		MOVE	VS,PC
	024352'	274300	034517'		SUB	VS,[1_43+2]
	024353'	260040	020616'		PJS	SPLICE
	024354'	254000	024410'		JRST	DC9

	024355'	202420	000467'	DWC:	MOVEM	W,@DOTP		;SAVE PC TO STORE DATA
	024356'	201400	000004		MOVEI	W,4
	024357'	272400	000551'		ADDM	W,PC
	024360'	260060	006577'		PJS	@GECALL	;WORD CONSTANT DIRECTIVE
	024361'	256005	024362'		XCT	.+1(U)
	024362'	254000	024374'		JRST	DWC0
	024363'	254000	024374'		JRST	DWC0
	024364'	364240	024366'		SOJA	U,DWCU
	024365'	031000	034515'		PE	MSIE,[RETURN]
	024366'			DWCU:				;U=1 WHICH IS WORD CONSTANT DATA TYPE FOR CHAINING LOGIC
	024366'	400500	000000		SETZ	Y,
	024367'	250500	003156'		EXCH	Y,UCC
	024370'	200300	000551'		MOVE	VS,PC
	024371'	274300	034520'		SUB	VS,[1_43+4]
	024372'	260040	020616'		PJS	SPLICE
	024373'	254000	024410'		JRST	DC9

	024374'	311200	034256'	DWC0:	CAML	V,[-1_40]
	024375'	311200	034257'		CAML	V,[1_40]
	024376'	031000	034516'		PE	MSOOR,DC9
	024377'	200420	000467'		MOVE	W,@DOTP
	024400'	260040	025620'		CA	H
	024401'	241200	777760		ROT	V,-20
	024402'	332000	000777'		CDPB	V,W		;LEFT HALF
	024403'	137200	000010
	024404'	621400	220000		TLZ	W,220000	;MAKE BYTE PTR GO TO RIGHT HALF
	024405'	241200	000020		ROT	V,20
	024406'	332000	000777'		CDPB	V,W
	024407'	137200	000010
	024410'	554400	000003	DC9:	HLRZ	W,C		;SEE IF MORE CONSTANTS IN THIS STATEMENT
	024411'	302400	000002		CAIE	W,COM
	024412'	263040	000000		RETURN
	024413'	200400	000551'		MOVE	W,PC
	024414'	254000	000556'		JRST	PCV2

	024415'			DXC:				;DEFINE BYTE STRING FROM PAIRS OF HEX CHRS
	024415'	260040	021742'		PJS	FBT
	024416'	260040	021753'	DXC1:	PJS	GCHR
	024417'	200403	032742'		MOVE	W,CT(C)		;Lookup character type
	024420'	400200	000000		SETZ	V,
	024421'	256010	024430'		XCT	DXCX(W)		;Dispatch on character type
	024422'	242200	000004		LSH	V,4
	024423'	260040	021753'		PJS	GCHR
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-17
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	024424'	200403	032742'		MOVE	W,CT(C)		;Lookup character type
	024425'	256010	024430'		XCT	DXCX(W)		;Dispatch on character type
	024426'	260040	025500'		PJS	DPBV
	024427'	254000	024416'		JRST	DXC1
	024430'	030000	024416'	DXCX:	CIT	DXC1		;LOOK FOR MORE INPUT
	024431'	031000	034521'		PE	MSIH,[RETURN]
	024432'	435203	777720		IORI	V,-60(C)
	024433'	435203	777711		IORI	V,-67(C)
	024434'	435203	777651		IORI	V,-127(C)
					REPEAT	4,<PE	MSIH,[RETURN]>
	024435'	031000	034521'
	024436'	031000	034521'
	024437'	031000	034521'
	024440'	031000	034521'
	024441'	263040	000000		RETURN

				DSC:				;DEFINE STRING CONSTANT. LIKE AC WITH LEADING BYTE FOR STRING L
				ENGTH.
	024442'	476000	000555'		SETOM	PCV1
	024443'	350000	000551'		AOS	PC
	024444'	334000	000000		SKIPA
	024445'	402000	000555'	DAC:	SETZM	PCV1
	024446'	260040	021742'		PJS	FBT		;DEFINE ASC STRING
	024447'	260040	021753'		PJS	GCHR
	024450'	200500	000003		MOVE	Y,C		;STRING DELIMITER
	024451'	302500	000015		CAIE	Y,15
	024452'	306500	000073		CAIN	Y,";"
	024453'	263040	000000		RETURN			;IS IT A STATEMENT DELIMITER?
	024454'	260040	021753'	DAC1:	PJS	GCHR
	024455'	316140	000012		CAMN	C,Y
	024456'	254000	024471'		JRST	DAC2
	024457'	302140	000015		CAIE	C,15
	024460'	306140	000073		CAIN	C,";"
	024461'	031000	034522'		PE	MSANPT,[RETURN]
	024462'	306140	000000		CAIN	C,CHRIT
	024463'	030000	024454'		CIT	DAC1		;LOOK FOR MORE INPUT
	024464'	306140	000042		CAIN	C,42
	024465'	254000	024502'		JRST	DACX		;GET HEX IF CHR IS "
	024466'	201203	000200		MOVEI	V,200(C)	;PREPARE BYTE WITH PARITY ALWAYS ON
	024467'	260040	025500'		PJS	DPBV
	024470'	254000	024454'		JRST	DAC1
	024471'	336000	000555'	DAC2:	SKIPN	PCV1
	024472'	263040	000000		RETURN
	024473'	200420	000467'		MOVE	W,@DOTP
	024474'	200200	000551'		MOVE	V,PC
	024475'	275210	000001		SUBI	V,1(W)
	024476'	260040	025610'		CA
	024477'	332000	000777'		CDPB	V,W
	024500'	137200	000010
	024501'	263040	000000		RETURN

	024502'	134140	000002	DACX:	ILDB	C,I		;GET FIRST CHR OF HEX PAIR
	024503'	200403	032742'		MOVE	W,CT(C)		;Lookup character type
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-18
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	024504'	400200	000000		SETZ	V,
	024505'	256010	024514'		XCT	DACXX(W)	;Dispatch on character type
	024506'	242200	000004		LSH	V,4
	024507'	260040	021753'		PJS	GCHR
	024510'	200403	032742'		MOVE	W,CT(C)		;Lookup character type
	024511'	256010	024514'		XCT	DACXX(W)	;Dispatch on character type
	024512'	260040	025500'		PJS	DPBV
	024513'	254000	024454'		JRST	DAC1

	024514'	030000	024502'	DACXX:	CIT	DACX		;LOOK FOR MORE INPUT
	024515'	031000	034521'		PE	MSIH,[RETURN]
	024516'	435203	777720		IORI	V,-60(C)
	024517'	435203	777711		IORI	V,-67(C)
	024520'	435203	777651		IORI	V,-127(C)
					REPEAT	5,<PE	MSIH,[RETURN]>
	024521'	031000	034521'
	024522'	031000	034521'
	024523'	031000	034521'
	024524'	031000	034521'
	024525'	031000	034521'

	024526'			DMO:;		DEFINE MODULE
	024526'	260040	017071'		PJS	GE		;GET ORIGIN
	024527'	367240	034240'		SOJG	U,[RETURN]	;check for undefined or illegal expr
	024530'	316140	034523'		CAMN	C,[COM,,DE]
	024531'	331000	000005		SKIPL	U		;CHECK FOR NULL EXPR
	024532'	031000	034524'		PE	MSIORG,[RETURN]
	024533'	202200	000623'		MOVEM	V,MOORG		;SAVE ORIGIN TIL STATEMENT BEYOND ERROR TRAPS
	024534'	260040	017525'		PJS	GK
	024535'	256005	024654'		XCT	MNX(U)
	024536'	211400	000044		MOVNI	W,44
	024537'	400500	000000		SETZ	Y,		;FIND SLOT IN MODULE TABLE
	024540'	336450	000623'	DMO1A:	SKIPN	X,MOA+44(W)
	024541'	200500	000010		MOVE	Y,W		;REMEMBER UNUSED SLOT
	024542'	316540	000011		CAMN	L,X
	024543'	254000	024547'		JRST	DMO2
	024544'	341400	024540'		AOJL	W,DMO1A
	024545'	336400	000012		SKIPN	W,Y
	024546'	031000	034525'		PE	MS36MI,XPSBI
	024547'	201410	000044	DMO2:	MOVEI	W,44(W)		;MODULE INDEX
	024550'	202550	000557'		MOVEM	L,MOA(W)	;SAVE ASC
	024551'	200440	000623'		MOVE	X,MOORG
	024552'	202400	006330'	DMO3:	MOVEM	W,MODULE
	024553'	510200	006325'		HLLZ	V,MM
	024554'	621200	037777		TLZ	V,37777
	024555'	434210	032632'		IOR	V,LBIT(W)
	024556'	202200	006325'		MOVEM	V,MM
	024557'	202450	000623'		MOVEM	X,MOORG(W)
	024560'	202440	000551'		MOVEM	X,PC
	024561'	200400	000470'		MOVE	W,CURSEG	;REFERENCE CURRENT SEGMENT
	024562'	313450	000531'		CAMLE	X,SEGTOP(W)	;IS PC>MAX(PC)?
	024563'	202450	000531'		MOVEM	X,SEGTOP(W)	;YES. SET MAX(PC)=PC.
	024564'	254000	023400'		JRST	XPSBI
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-19
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS


	024565'			DEM:				;OUTPUT MODULE BOUNDS
	024565'	336000	000777'		SKIPN	LSTMSK
	024566'	254000	024606'		JRST	DEM1
	024567'	260040	021750'		PJS	TYPEOL
	024570'	200400	006330'		MOVE	W,MODULE
	024571'	200250	000557'		MOVE	U,MOA(W)
	024572'	260040	022000'		PJS	TYP6		;MODULE NAME
	024573'	051700	000040		OUTCHI	" "
	024574'	200210	000623'		MOVE	V,MOORG(W)
	024575'	201500	000020		MOVEI	Y,20
	024576'	260040	022015'		PJS	TN		;INITIAL PC
	024577'	051700	000040		OUTCHI	" "
	024600'	200200	000551'		MOVE	V,PC
	024601'	201500	000020		MOVEI	Y,20
	024602'	260040	022015'		PJS	TN		;ENDING PC
	024603'	200600	006330'		MOVE	M,MODULE
	024604'	200614	032632'		MOVE	M,LBIT(M)
	024605'	260040	025441'		PJS	TU		;TYPE UNDEFINEDS

	024606'	201400	000004	DEM1:	MOVEI	W,4
	024607'	200440	000551'		MOVE	X,PC
	024610'	254000	024552'		JRST	DMO3

	024611'	410400	006325'	DFO:	ANDCA	W,MM		;DEFINE MODULE AS FOREIGN.
	024612'	434400	006325'	DLO:	IOR	W,MM		;DEFINE MODULE AS LOCAL.
	024613'	552200	006327'		HRRZM	V,DFODLO	;SAVE PTR TO DFO OR DLO INSTRUCTION
	024614'	260040	017525'	DL1:	PJS	GK		;GET ASC STRING
	024615'	254005	024616'		JV	<.+1(U),DL1,MNX(U),DL2,DL2,MNX(U),MNX(U),MNX(U)>
	024616'	254000	024614'
	024617'	254005	024654'
	024620'	254000	024625'
	024621'	254000	024625'
	024622'	254005	024654'
	024623'	254005	024654'
	024624'	254005	024654'
	024625'	211400	000044	DL2:	MOVNI	W,44		;SCAN FOR ASC
	024626'	312550	000623'		CAME	L,MOA+44(W)
	024627'	341400	024626'		AOJL	W,.-1
	024630'	322400	024654'		JUMPE	W,MNX
	024631'	200410	032676'		MOVE	W,LBIT+44(W)
	024632'	256020	006327'		XCT	@DFODLO
	024633'	202400	006325'		MOVEM	W,MM
	024634'	254000	023400'		JRST	XPSBI

	024635'	260040	021742'	DUS:	PJS	FBT
	024636'	260040	017525'		PJS	GK		;GET MODULE NAME
	024637'	256005	024654'		XCT	MNX(U)
	024640'	211440	000044		MOVNI	X,44
	024641'	312551	000623'		CAME	L,MOA+44(X)
	024642'	341440	024641'		AOJL	X,.-1
	024643'	326440	024645'		JUMPN	X,.+2
	024644'	031000	034526'		PE	MSUE,XPSBI
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 12-20
NAD01.R06	24-JUL-87 17:39		DIRECTIVE PROCESSORS

	024645'	202440	003163'		MOVEM	X,FX2
	024646'	260040	025166'		PJS	GR
	024647'	200440	003163'		MOVE	X,FX2
	024650'	202211	000733'		MOVEM	V,MOUSE+44(X)
	024651'	200411	032676'		MOVE	W,LBIT+44(X)
	024652'	436400	006325'		IORM	W,MM
	024653'	263040	000000		RETURN

	024654'	031000	034527'	MNX:	PE	MSMNI,XPSBI	;BLANK OR TAB
	024655'	031000	034527'		PE	MSMNI,XPSBI	;NUMBER
	024656'	255000	000000		JFCL			;SYMBOL
	024657'	255000	000000		JFCL			;UNDEFINED SYMBOL
					REPEAT	3,<PE	MSMNI,[RETURN]>	;OPERATOR,DELIMITER,ILLEGAL
	024660'	031000	034530'
	024661'	031000	034530'
	024662'	031000	034530'

	024663'			DUN:				;TYPE OUT ALL UNDEFINED SYMBOLS. INHIBIT DEN FROM TYPING ANY.
	024663'	477600	003175'		SETOB	M,UNSW
	024664'	335000	000777'		SKIPGE	LSTMSK
	024665'	260040	025441'		PJS	TU
	024666'	254000	023400'		JRST	XPSBI

	024667'	260040	017071'	DRA:	PJS	GE		;GET RADIX
	024670'	367240	034240'		SOJG	U,[RETURN]	;check for undefined or illegal expr
	024671'	322240	024673'		JUMPE	U,DRAE		;CHECK FOR NULL EXPR
	024672'	303200	000020		CAILE	V,20
	024673'	031000	034531'	DRAE:	PE	MSRV,[RETURN]
	024674'	321200	024673'		JUMPL	V,DRAE
	024675'	336000	000004		SKIPN	V
	024676'	201200	000020		MOVEI	V,20
	024677'	202200	006334'		MOVEM	V,RADIX
	024700'	263040	000000		RETURN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 13
NAD01.R06	24-JUL-87 17:39		INSTRUCTION PROCESSORS

					SUBTTL	INSTRUCTION PROCESSORS
				;		**************************************************


	024701'	260040	025166'	LPSR:	PJS	GR
	024702'	322400	024711'		JUMPE	W,RR0		;2 OPERANDS - TREAT AS NORMAL RR FORMAT INSTRUCTION
	024703'	201244	000001		MOVEI	U,1(V)		;WEIRD FORMAT IF 1 OPERAND
	024704'	405240	000017		ANDI	U,17
	024705'	242240	000004		LSH	U,4
	024706'	436240	003160'		IORM	U,OPCODE
	024707'	254000	024717'		JRST	RR2

	024710'			RR:;		REGISTOR TO REGISTOR INSTRUCTION
			000001	SF:	SFV==RRV
	024710'	260040	025166'		PJS	GR		;BUILD RR INSTRUCTION
	024711'	242200	000004	RR0:	LSH	V,4
	024712'	436200	003160'		IORM	V,OPCODE
	024713'	326400	024717'		JUMPN	W,RR2		;NO MORE ARGUMENTS
	024714'	260040	025166'	RR1:	PJS	GR
	024715'	336000	000010		SKIPN	W		;CHECK FOR EXTRANEOUS OPERANDS
	024716'	031000	034532'		PE	MTMO,.+1
	024717'	434200	003160'	RR2:	IOR	V,OPCODE
	024720'	332000	000777'		CDPB	V,PCP
	024721'	137200	000552'
	024722'	263040	000000		RETURN

	024723'	260040	025166'	BF:	PJS	GR		;BACKWARD FORWARD. CREATE SPECIAL SF INSTRUCTION.
	024724'	326400	034534'		JUMPN	W,[PE MSMOF,[RETURN]]
	024725'	137200	034535'		DPB	V,[POINT 4,OPCODE,31]
	024726'	260060	006577'	BF1:	PJS	@GECALL
	024727'	363240	024755'		SOJLE	U,BF4		;DEFINED VALUE
	024730'	362240	024732'		SOJE	U,.+2
	024731'	031000	034515'		PE	MSIE,[RETURN]
				;		UNDEFINED SHORT FORMAT OPERAND
	024732'	336420	006600'		GFL
	024733'	260040	020656'
	024734'	250400	006600'
	024735'	201440	000014		MOVEI	X,BFO
	024736'	202450	000000		MOVEM	X,(W)		;SET COMPUTE CHAIN OPERATOR
	024737'	550200	003160'		HRRZ	V,OPCODE
	024740'	202210	000001		MOVEM	V,1(W)		;SAVE INSTRUCTION WITHOUT PC DIFF
	024741'	402010	000002		SETZM	2(W)
	024742'	200300	000551'		MOVE	VS,PC
	024743'	274300	034517'		SUB	VS,[1_43+2]
	024744'	400500	000000		SETZ	Y,
	024745'	250500	003156'		EXCH	Y,UCC
	024746'	322500	024751'		JUMPE	Y,BF2
	024747'	542412	000002		HRRM	W,2(Y)
	024750'	254000	024752'		JRST	BF3		;CONNECT COMPUTE CHAIN AND OPCODE CONSTANT
	024751'	504500	000010	BF2:	HRL	Y,W		;MAKE SIMPLE COMPUTE CHAIN INCLUDING OPCODE VALUE
	024752'	540500	000010	BF3:	HRR	Y,W		;END OF COMPUTE CHAIN
	024753'	260040	020616'		PJS	SPLICE
	024754'	263040	000000		RETURN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 13-2
NAD01.R06	24-JUL-87 17:39		INSTRUCTION PROCESSORS

	024755'	274220	000467'	BF4:	SUB	V,@DOTP
	024756'	200400	003160'		MOVE	W,OPCODE
	024757'	606400	000400		TRNN	W,400
	024760'	210200	000004		MOVN	V,V
	024761'	241200	777777		ROT	V,-1
	024762'	616200	034263'		TDNN	V,[-20]
	024763'	254000	024717'		JRST	RR2
	024764'	031000	034536'		PE	MSOOR,[RETURN]

	024765'	334200	032632'	RX0:	SKIPA	V,LBIT		;RX BUT R1 FIELD IS ALWAYS 0
	024766'	135200	034535'	RX:	LDB	V,[POINT 4,OPCODE,31]	;SEE IF R1 IS PART OF OPCODE
	024767'	260040	025057'		PJS	G3
	024770'	515200	777777		HRLZI	V,-1
	024771'	326400	024773'		JUMPN	W,.+2
	024772'	260040	025166'		PJS	GR
	024773'	202200	003164'		MOVEM	V,SX2
	024774'	332000	003167'		SKIPE	GSEC
	024775'	263040	000000		RETURN

				;	SET U=0 IF RX1,2/ U=1 IF RX3/U=2 IF RX1,2 UNDEFINED/ U=3 IF RX3 UNDEFINED
	024776'	400240	000000		SETZ	U,
	024777'	331000	003164'		SKIPL	SX2
	025000'	344240	025011'		AOJA	U,RXF0
	025001'	200200	003162'		MOVE	V,DISP
	025002'	616200	034261'		TDNN	V,[-1_16]
	025003'	254000	025011'		JRST	RXF0
				;	ATTEMPT RELATIVE TO P.
				;	DISPLACEMENT=[DISP-(INCREMENTED PC)]&77777+100000
	025004'	274200	000551'		SUB	V,PC		;PC WAS INCREMENTED IN PC22
	025005'	311200	034261'		CAML	V,[-40000]	;IS IT TOO FAR BEHIND CURRENT PC
	025006'	301200	040000		CAIL	V,40000		;IS IT TOO FAR BEYOND CURRENT PC
	025007'	031000	034536'		PE	MSOOR,[RETURN]	;ADRS OUT OF RANGE
	025010'	435200	100000		IORI	V,100000	;TELL CPU TO EXECUTE RX2 ADDRESSING
	025011'	332000	003166'	RXF0:	SKIPE	UDISP		;is expression undefined?
	025012'	271240	000002		ADDI	U,2
	025013'	254005	025014'		JV	<.+1(U),RX1,RX3,RX1U,RX3>
	025014'	254000	025020'
	025015'	254000	025023'
	025016'	254000	025051'
	025017'	254000	025023'

	025020'	332000	000777'	RX1:	CDPB	V,PCP1
	025021'	137200	000553'
	025022'	263040	000000		RETURN

	025023'	135200	034537'	RX3:	LDB	V,[POINT 8,DISP,19]
	025024'	241200	777770		ROT	V,-10
	025025'	540200	003164'		HRR	V,SX2
	025026'	435204	000100		IORI	V,100(V)
	025027'	241200	000010		ROT	V,10
	025030'	332000	000777'		CDPB	V,PCP1
	025031'	137200	000553'
	025032'	201400	000002		MOVEI	W,2
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 13-3
NAD01.R06	24-JUL-87 17:39		INSTRUCTION PROCESSORS

	025033'	273400	000551'		ADDB	W,PC
	025034'	275400	000002		SUBI	W,2
	025035'	200200	003162'		MOVE	V,DISP
	025036'	260040	025620'		CA	H
	025037'	332000	000777'		CDPB	V,W
	025040'	137200	000010
	025041'	302240	000003		CAIE	U,3
	025042'	263040	000000		RETURN
	025043'	400500	000000		SETZ	Y,		;UNDEFINED RX3 DISPLACEMENT
	025044'	250500	003156'		EXCH	Y,UCC
	025045'	200300	000551'		MOVE	VS,PC
	025046'	274300	034517'		SUB	VS,[1_43+2]
	025047'	260040	020616'		PJS	SPLICE
	025050'	263040	000000		RETURN

	025051'	400500	000000	RX1U:	SETZ	Y,
	025052'	250500	003156'		EXCH	Y,UCC
	025053'	200300	000551'		MOVE	VS,PC
	025054'	274300	034517'		SUB	VS,[1_43+2]
	025055'	260040	020616'		PJS	SPLICE
	025056'	263040	000000		RETURN

	025057'			G3:				;GET 3 OPERANDS:	R1,DISP, AND FX2
	025057'	402000	003162'		SETZM	DISP
	025060'	402000	003163'		SETZM	FX2
	025061'	402000	003166'		SETZM	UDISP
	025062'	542200	003161'		HRRM	V,R1
	025063'	326200	025067'		JUMPN	V,G3A		;R1 ALREADY KNOWN
	025064'	260040	025166'		PJS	GR		;NO
	025065'	202200	003161'		MOVEM	V,R1
	025066'	326400	025106'		JUMPN	W,G3B		;NO MORE ARGS
	025067'	402000	003165'	G3A:	SETZM	RUSING
	025070'	260060	006577'		PJS	@GECALL
	025071'	202200	003162'		MOVEM	V,DISP
	025072'	306240	000002		CAIN	U,2		;is value undefined?
	025073'	476000	003166'		SETOM	UDISP		;yes. record
	025074'	554400	000003		HLRZ	W,C
	025075'	275400	000002		SUBI	W,COM		;INDEX FIELD DELIMITED BY COMMA OR LEFT BRACKET
	025076'	322400	025101'		JUMPE	W,G3C
	025077'	275400	000005		SUBI	W,LBRAK-COM
	025100'	326400	025106'		JUMPN	W,G3B
	025101'	260040	025166'	G3C:	PJS	GR		;GET FIRST X2
	025102'	366240	025105'		SOJN	U,.+3
	025103'	135200	034254'		LDB	V,[POINT 6,(M),17]
	025104'	550204	000667'		HRRZ	V,MOUSE(V)
	025105'	202200	003163'		MOVEM	V,FX2
	025106'	200500	003161'	G3B:	MOVE	Y,R1
	025107'	241500	000004		ROT	Y,4
	025110'	434500	003163'		IOR	Y,FX2
	025111'	434500	003160'		IOR	Y,OPCODE
	025112'	332000	000777'		CDPB	Y,PCP		;STORE FIRST HALFWORD OF INSTRUCTION
	025113'	137500	000552'
	025114'	263040	000000		RETURN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 13-4
NAD01.R06	24-JUL-87 17:39		INSTRUCTION PROCESSORS


	025115'	400200	000000	RI:	SETZ	V,
	025116'	260040	025057'		PJS	G3
	025117'	332000	003167'		SKIPE	GSEC
	025120'	263040	000000		RETURN
	025121'	336000	000010		SKIPN	W
	025122'	031000	034540'		PE	MTMO,.+1
	025123'	332000	003166'		SKIPE	UDISP		;is it undefined?
	025124'	254000	025131'		JRST	RI1U
	025125'	200200	003162'		MOVE	V,DISP
	025126'	332000	000777'		CDPB	V,PCP1
	025127'	137200	000553'
	025130'	263040	000000		RETURN
	025131'	400240	000000	RI1U:	SETZ	U,
	025132'	400500	000000		SETZ	Y,
	025133'	250500	003156'		EXCH	Y,UCC
	025134'	200300	000551'		MOVE	VS,PC
	025135'	274300	034517'		SUB	VS,[1_43+2]
	025136'	260040	020616'		PJS	SPLICE
	025137'	263040	000000		RETURN

	025140'	400200	000000	RI2:	SETZ	V,
	025141'	260040	025057'		PJS	G3
	025142'	332000	003167'		SKIPE	GSEC
	025143'	263040	000000		RETURN
	025144'	336000	000010		SKIPN	W		;CHECK FOR EXTRANEOUS OPERANDS
	025145'	031000	034541'		PE	MTMO,.+1
	025146'	332000	003166'		SKIPE	UDISP		;is it undefined?
	025147'	254000	025157'		JRST	RI2U
	025150'	200400	003162'		MOVE	W,DISP
	025151'	332000	000777'		CDPB	W,PCP2
	025152'	137400	000554'
	025153'	242400	777760		LSH	W,-20
	025154'	332000	000777'		CDPB	W,PCP1
	025155'	137400	000553'
	025156'	263040	000000		RETURN
	025157'	400500	000000	RI2U:	SETZ	Y,
	025160'	250500	003156'		EXCH	Y,UCC
	025161'	200300	000551'		MOVE	VS,PC
	025162'	270300	034542'		ADD	VS,[1_43-4]
	025163'	201240	000001		MOVEI	U,1
	025164'	260040	020616'		PJS	SPLICE
	025165'	263040	000000		RETURN

	025166'	260040	017071'	GR:	PJS	GE		;GET REGISTER FIELD
	025167'	632200	034263'		TDZE	V,[-20]
	025170'	031000	034543'		PE	MSRNB,.+1	;MORE THAN FOUR BIT
	025171'	550400	000003		HRRZ	W,C
	025172'	302400	000011		CAIE	W,DE
	025173'	254000	025213'		JRST	GRIRF
	025174'	544400	000003		HLR	W,C
	025175'	551410	777776		HRRZI	W,-COM(W)	;W = 0 IF REGISTOR FOLLOWED BY A COMMA
	025176'	256010	025201'		XCT	.+1+COM(W)
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 13-5
NAD01.R06	24-JUL-87 17:39		INSTRUCTION PROCESSORS

	025177'	263040	000000		RETURN
	025200'	263040	000000		RETURN
	025201'	263040	000000		RETURN
	025202'	254000	025213'		JV	<GRIRF,GRIRF,GRIRF,GRIRF>
	025203'	254000	025213'
	025204'	254000	025213'
	025205'	254000	025213'
	025206'	263040	000000		RETURN
	025207'	263040	000000		RETURN
	025210'	263040	000000		RETURN
	025211'	263040	000000		RETURN
	025212'	263040	000000		RETURN
	025213'	262041	000001	GRIRF:	POP	S,1(S)		;SKIP BACK A LEVEL
	025214'	263040	000000		RETURN			;AND RETURN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 14
NAD01.R06	24-JUL-87 17:39		ERROR HANDLERS

					SUBTTL	ERROR HANDLERS
				;		**************************************************


	025215'	550000	000040	TYPEI:	HRRZ	0,40		;get address of message
	025216'	505000	440700		HRLI	0,(POINT 7,0)	;construct byte pointer
	025217'	202001	000002		MOVEM	0,2(S)		;save it
	025220'	134001	000002	TYPE1:	ILDB	0,2(S)		;get next character of ASCIZ message
	025221'	322000	034240'		JUMPE	0,[RETURN]	;end on null
	025222'	306000	000044		CAIN	0,"$"		;carriage return?
	025223'	254000	025226'		JRST	TYPE2		;yes
	025224'	051040	000000		OUTCHR	0
	025225'	254000	025220'		JRST	TYPE1
	025226'	260040	021750'	TYPE2:	PJS	TYPEOL
	025227'	254000	025220'		JRST	TYPE1

	025230'	202401	000000	QER1:	MOVEM	W,(S)		;THIS UUO DOES NOT RETURN TO CALLER PLUS 1
	025231'	200400	003202'		MOVE	W,IFC		;IGNORE ERRORS INSIDE UNTRUE IFS
	025232'	312400	003203'		CAME	W,IFT
	025233'	254000	025253'		JRST	PE1
	025234'	200400	006257'		MOVE	W,LEC
	025235'	301400	000020		CAIL	W,20
	025236'	254000	025253'		JRST	PE1		;LIMIT ERROR STACK TO 20
	025237'	261040	000011		PUSH	S,X
	025240'	500460	000040		HLL	X,@40
	025241'	556450	006260'		HLRZM	X,PET1(W)	;SAVE MSG ADRS
	025242'	200440	013054'		MOVE	X,MACI
	025243'	336000	013055'		SKIPN	MACN		;IS A MACRO EXPANSION HAPPENING?
	025244'	200440	000002		MOVE	X,I		;NO. USE "I". OTHERWISE USE "MACI"
	025245'	202450	006300'		MOVEM	X,PET2(W)	;CHARACTER POSITION WHERE ERROR WAS FOUND
	025246'	350000	006257'		AOS	LEC
	025247'	350000	003167'		AOS	GSEC
	025250'	336000	001000'		SKIPN	DSW		;is error in source file
	025251'	350000	003170'		AOS	ERRCNT		;yes, then count it for ERRCNT directive
	025252'	262040	000011		POP	S,X
	025253'	262040	000010	PE1:	POP	S,W		;DECREMENT STACK BEFORE NON POPJ RETURN
	025254'	550420	000040		HRRZ	W,@40		;PICK UP RETURN ADDRESS
	025255'	250401	000001		EXCH	W,1(S)		;RESTORE W
	025256'	254021	000001		JRST	@1(S)


	025257'	035000	034544'	PF:	TYPE	<$Assembler bug or program failure at location >
	025260'	550201	000000		HRRZ	V,(S)
	025261'	201500	000010		MOVEI	Y,10
	025262'	260040	022015'		PJS	TN
	025263'	254000	016772'		JRST	NADAB

	025264'			TLE:				;TYPE LINE ERRORS
	025264'	261040	000002		PUSH	S,I		;SAVE TEXT BYTE POINTER
	025265'	261040	000015		PUSH	S,F		;SAVE FLAGS WORD
	025266'	660640	000002		TRO	F,SUPLST	;DON'T DO ANY LISTING ACTION
	025267'	332000	001000'		SKIPE	DSW		;direct assembly
	025270'	254000	025422'		JRST	TLE7		;yes. just type message
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 14-2
NAD01.R06	24-JUL-87 17:39		ERROR HANDLERS

	025271'	260040	021750'		PJS	TYPEOL
	025272'	035000	034556'		TYPE	<***>
	025273'	200200	006256'		MOVE	V,LC
	025274'	201500	000012		MOVEI	Y,12
	025275'	260040	022015'		PJS	TN		;TYPE LINE NUMBER
	025276'	602640	400000		TRNE	F,LSLOCK	;if not listing
	025277'	254000	025422'		JRST	TLE7		;then don't list line even in error message
	025300'	336240	000464'		SKIPN	U,LLABEL
	025301'	254000	025312'		JRST	TLE0
	025302'	260040	021763'		PJS	BL3
	025303'	260040	022000'		PJS	TYP6		;TYPE OUT LAST LABEL
	025304'	200200	006256'		MOVE	V,LC
	025305'	274200	000465'		SUB	V,LLC		;LOCAL LINE COUNT FROM LAST LABEL
	025306'	322200	025312'		JUMPE	V,TLE0
	025307'	051700	000053		OUTCHI	"+"
	025310'	201500	000012		MOVEI	Y,12
	025311'	260040	022015'		PJS	TN
	025312'	260040	021750'	TLE0:	PJS	TYPEOL
				;	SKIPL	MACN		;NO LINE IF LEFT MACRO EXPANSION
				;	TLNE	F,EOFF		;DON'T COPY LINE IF IT DOESN'T EXIST
	025313'	335000	013055'		SKIPGE	MACN		;NO LINE IF LEFT MACRO EXPANSION
	025314'	254000	025422'		JRST	TLE7
	025315'	200500	013054'		MOVE	Y,MACI		;END AT "MACI" IF IN EXPANSION
	025316'	336000	013055'		SKIPN	MACN		;IN EXPANSION
	025317'	200500	000002		MOVE	Y,I
	025320'	200100	006255'		MOVE	I,LINEI		;SETUP TO COPY HIS LINE
	025321'	260040	021753'	TLE1:	PJS	GCHR
	025322'	051040	000003		OUTCHR	C
	025323'	200000	000003		MOVE	0,C
	025324'	316100	000012		CAMN	I,Y
	025325'	254000	025337'		JRST	TLE2
	025326'	607640	010000		TLNN	F,EOFF		;AT AN EOF, STOP AT NULL
	025327'	254000	025333'		JRST	TLE1A		;DON'T DO THE FOLLOWING IF NOT AT EOF
	025330'	134140	000002		ILDB	C,I		;PEEK AT NEXT CHAR
	025331'	322140	025337'		JUMPE	C,TLE2		;STOP AT NULL, SINCE LINK HAS BEEN DESTROYED
	025332'	270100	006336'		ADD	I,BACKUP	;DECREMENT BYTE POINTER BY ONE CHARACTER
	025333'	260040	021753'	TLE1A:	PJS	GCHR		;READ NEXT CHAR, SKIPPING OVER MACRO STUFF
	025334'	270100	006336'		ADD	I,BACKUP	;DECREMENT BYTE POINTER BY ONE CHARACTER
	025335'	312100	000012		CAME	I,Y		;CHECK FOR END OF ERROR LINE
	025336'	254000	025321'		JRST	TLE1
	025337'	302000	000012	TLE2:	CAIE	0,12
	025340'	260040	021750'		PJS	TYPEOL

	025341'	200100	006255'		MOVE	I,LINEI
	025342'	400400	000000		SETZ	W,
	025343'	211440	000002		MOVNI	X,2
	025344'	316110	006300'	TLE3:	CAMN	I,PET2(W)
	025345'	254000	025352'		JRST	TLE3A
	025346'	260040	021753'		PJS	GCHR
	025347'	270100	006336'		ADD	I,BACKUP	;DECREMENT BYTE POINTER BY ONE CHARACTER
	025350'	312110	006300'		CAME	I,PET2(W)
	025351'	254000	025357'		JRST	TLE3B
	025352'	201450	000101	TLE3A:	MOVEI	X,101(W)
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 14-3
NAD01.R06	24-JUL-87 17:39		ERROR HANDLERS

	025353'	051040	000011		OUTCHR	X
	025354'	316110	006301'		CAMN	I,PET2+1(W)
	025355'	344400	025354'		AOJA	W,.-1
	025356'	344400	025365'		AOJA	W,TLE3C
	025357'	302140	000011	TLE3B:	CAIE	C,11
	025360'	254000	025363'		JRST	TLE3B1
	025361'	051040	000003		OUTCHR	C
	025362'	344440	025365'		AOJA	X,TLE3C		;CHECK FOR TAB
	025363'	352000	000011	TLE3B1:	AOSE	X
	025364'	051700	000040		OUTCHI	" "
	025365'	315400	006257'	TLE3C:	CAMGE	W,LEC
					JRST	[PJS	GCHR
	025366'	254000	034557'			 JRST	TLE3]
	025367'	400400	000000		SETZ	W,
	025370'	551450	000101	TLE4:	HRRZI	X,101(W)
	025371'	260040	021750'	TLE4A:	PJS	TYPEOL
	025372'	051040	000011		OUTCHR	X
	025373'	260040	021763'		PJS	BL3
	025374'	051170	006260'		OUTSTR	@PET1(W)
	025375'	377000	006257'		SOSG	LEC
	025376'	254000	025403'		JRST	TLE9
	025377'	200210	006300'		MOVE	V,PET2(W)
	025400'	312210	006301'		CAME	V,PET2+1(W)
	025401'	344400	025370'		AOJA	W,TLE4
	025402'	344400	025371'		AOJA	W,TLE4A
	025403'	262040	000015	TLE9:	POP	S,F		;RESTORE FLAG WORD
	025404'	262040	000002		POP	S,I		;RESTORE TEXT POINTER
	025405'	337300	000224'		SKIPG	VS,UCERC	;ANY ADDRESS CHAIN FAILURES?
	025406'	263040	000000		RETURN
	025407'	403340	000224'		SETZB	OS,UCERC	;YES, TYPE OUT THE PC S WHERE THE ERROR WAS RECORDED
	025410'	260040	021750'	TLE9A:	PJS	TYPEOL
	025411'	051700	000011		OUTCHI	11
	025412'	051700	000011		OUTCHI	11		;CR, LF, TAB, TAB
	025413'	035000	034561'		TYPE	<Operand out of range at PC = >
	025414'	200207	000225'		MOVE	V,UCPCT(OS)
	025415'	201500	000020		MOVEI	Y,20
	025416'	260040	022015'		PJS	TN
	025417'	271340	000001		ADDI	OS,1
	025420'	367300	025410'		SOJG	VS,TLE9A
	025421'	263040	000000		RETURN

	025422'	400400	000000	TLE7:	SETZ	W,
	025423'	260040	021750'	TLE7A:	PJS	TYPEOL
	025424'	051170	006260'		OUTSTR	@PET1(W)
	025425'	373000	006257'		SOSLE	LEC
	025426'	344400	025423'		AOJA	W,TLE7A
	025427'	254000	025403'		JRST	TLE9

	025430'	261040	000010	QPC:	BAR	<W>		;PUT THE PROGRAM COUNTER IN REG. 0 ON THE ERROR QUE
	025431'	260040	025434'
	025432'	262040	000010
	025433'	263040	000000
	025434'	200400	000224'		MOVE	W,UCERC
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 14-4
NAD01.R06	24-JUL-87 17:39		ERROR HANDLERS

	025435'	305400	000010		CAIGE	W,UCERN
	025436'	350400	000224'		AOS	W,UCERC
	025437'	202010	000224'		MOVEM	0,UCPCT-1(W)
	025440'	263040	000000		RETURN

				;	TYPE UNDEFINED SYMBOLS FOR MODULE MASK M
				;	  EXIT WITH Y < 0 IF ANY UNDEFINEDS.
				;	  ENTER AT TUN TO CHECK UNDEFINEDS BUT DO NOT TYPE OUT
	025441'	474500	000000	TU:	SETO	Y,
	025442'	334000	000000		SKIPA
	025443'	561500	000000	TUN:	HRROI	Y,0		;LARGE MINUS NUMBER
	025444'	211300	002007		MOVNI	VS,HASHSZ
	025445'	332346	010617'	TU1:	SKIPE	OS,EYH(VS)
	025446'	254000	025452'		JRST	TU3		;BEGINNING OF SYMBOL CHAIN
	025447'	341300	025445'	TU2:	AOJL	VS,TU1
	025450'	450500	000000		SETCA	Y,
	025451'	263040	000000		RETURN
	025452'	335407	000000	TU3:	SKIPGE	W,(OS)
	025453'	254000	025457'		JRST	TU5		;UNDEFINED FLAG IS ON
	025454'	550340	000010	TU4:	HRRZ	OS,W
	025455'	322340	025447'		JUMPE	OS,TU2
	025456'	254000	025452'		JRST	TU3
	025457'	135440	034567'	TU5:	LDB	X,[POINT 6,W,17]
	025460'	616611	032632'		TDNN	M,LBIT(X)
	025461'	254000	025454'		JRST	TU4		;DONT TYPE OUT THIS UNDEFINED SYMBOL
	025462'	325500	025466'		JUMPGE	Y,TU5A
	025463'	355000	000012		AOSGE	Y
	025464'	263040	000000		RETURN			;FLAG UNDEFINEDS ONLY
	025465'	035000	034570'		TYPE	<$***Undefined symbols$>
	025466'	200247	000001	TU5A:	MOVE	U,1(OS)		;PICK UP SIXBIT
	025467'	606500	000100		TRNN	Y,100
	025470'	254000	025473'		JRST	.+3
	025471'	260040	021750'		PJS	TYPEOL
	025472'	400500	000000		SETZ	Y,
	025473'	260040	022000'		PJS	TYP6
	025474'	270500	000466'		ADD	Y,TYP6C
	025475'	051700	000040		OUTCHI	" "
	025476'	340500	000000		AOJ	Y,
	025477'	254000	025454'		JRST	TU4
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 15
NAD01.R06	24-JUL-87 17:39		MISCELLANY

					SUBTTL	MISCELLANY
				;		**************************************************


	025500'	350400	000551'	DPBV:	AOS	W,PC		;DEPOSIT BYTE AND ADVANCE PC
	025501'	275400	000001		SUBI	W,1
	025502'	260040	025610'		CA
	025503'	332000	000777'		CDPB	V,W
	025504'	137200	000010
	025505'	263040	000000		RETURN

	025506'	202401	000001	UUO:	MOVEM	W,1(S)
	025507'	135400	034575'		LDB	W,[POINT 5,40,8]
	025510'	200410	025463'		MOVE	W,UUOTAB-30(W)
	025511'	250401	000001		EXCH	W,1(S)
	025512'	256001	000001		XCT	1(S)
	025513'	254000	021645'	UUOTAB:	JV	<ITP,QER1,MACEND,MARG1,MAEND,TYPEI>
	025514'	254000	025230'
	025515'	254000	025521'
	025516'	254000	025563'
	025517'	254000	025577'
	025520'	254000	025215'

	025521'	540140	000040	MACEND:	HRR	C,40		;RETURNS TO ARG
	025522'	542141	000000		HRRM	C,(S)
	025523'	606640	000003		TRNN	F,SUPLST+ASONLY	;IS THE LISTER RUNNING
	025524'	260040	022727'		PJS	LSVLNE		;SAVE STATEMENT TEXT
	025525'	261040	000010		PUSH	S,W		;SAVE "W" AND "V" FOR CALL TO R"REMAC"
	025526'	261040	000004		PUSH	S,V
	025527'	336400	013056'		SKIPN	W,MACSTK	;IS THIS REALLY A MACRO END
	025530'	260040	025257'		CPF			;NO. ABORT
	025531'	550210	000000		HRRZ	V,(W)		;POP TOP BLOCK OFF STACK
	025532'	202200	013056'		MOVEM	V,MACSTK
	025533'	554210	000000		HLRZ	V,(W)		;GET SIZE OF BLOCK
	025534'	260040	020337'		PJS	REMAC		;RETURN MEMORY TO FREE STORAGE
	025535'	200200	013057'		MOVE	V,IPSTK		;pointer to current stack entry
	025536'	200204	000002		MOVE	V,2(V)		;get previous macro invocation number
	025537'	620640	004000		TRZ	F,PRPCOD	;clear setting of proprietary from macro	
	025540'	623200	400000		TLZE	V,400000	;was caller proprietary?
	025541'	660640	004000		TRO	F,PRPCOD	;yes, restore proprietary code indicator
	025542'	202200	013052'		MOVEM	V,MACCUR	;and make it current
	025543'	262040	000004		POP	S,V
	025544'	262040	000010		POP	S,W
	025545'	260040	025651'		PJS	RESIP		;RESTORE PREVIOUS TEXT POINTER
	025546'	336000	013055'		SKIPN	MACN		;DOES THIS END MACRO WHICH STARTED LINE
	025547'	202100	013054'		MOVEM	I,MACI		;YES. SAVE END OF MACRO
	025550'	370000	013055'		SOS	MACN		;REDUCE MACRO STACK COUNT
	025551'	606640	000003		TRNN	F,SUPLST+ASONLY
	025552'	375000	003250'		SOSGE	LSVCNT		;ANY ROOM IN BUFFER?
	025553'	254000	025556'		JRST	MACEN1		;NO
	025554'	201140	000135		MOVEI	C,"]"		;BRACKET END OF MACRO EXPANSION
	025555'	136140	006251'		IDPB	C,LSVP		;YES.
	025556'	202100	006252'	MACEN1:	MOVEM	I,LISTI		;AND SAVE FOR LISTING
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 15-2
NAD01.R06	24-JUL-87 17:39		MISCELLANY

	025557'	336000	013056'		SKIPN	MACSTK
	025560'	620640	000002		TRZ	F,SUPLST
	025561'	620700	000100		TRZ	F2,CONDST	; Forget that this is a conditional statement
	025562'	263040	000000		RETURN

	025563'	540140	000040	MARG1:	HRR	C,40		;RESTURNS TO ARG OF CALLER
	025564'	542141	000000		HRRM	C,(S)
	025565'	606640	000003		TRNN	F,SUPLST+ASONLY	;IS LISTER RUNNING
	025566'	260040	022727'		PJS	LSVLNE		;YES. SAVE STATEMENT TEXT FOR LISTER
	025567'	134140	000002		ILDB	C,I		;GET ARG INDEX
	025570'	260040	025640'		PJS	SAVIP		;SAVE PTR TO MACRO BODY
	025571'	336100	013056'		SKIPN	I,MACSTK	;ABORT IF NO MACRO
	025572'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	025573'	270140	000002		ADD	C,I		;COMPUTE ADDRESS OF ARG BYTE POINTER
	025574'	270103	000000		ADD	I,(C)		;GET ARG BYTE POINTER
	025575'	202100	006252'		MOVEM	I,LISTI		;SAVE TEXT POINTER FOR LISTER
	025576'	263040	000000		RETURN

	025577'	540140	000040	MAEND:	HRR	C,40		;MACRO ARG END
	025600'	542141	000000		HRRM	C,(S)		;RETURNS TO ARG
	025601'	336000	013056'		SKIPN	MACSTK		;MACRO IN PROGRESS?
	025602'	260040	025257'		CPF			;NO. ABORT
	025603'	606640	000003		TRNN	F,SUPLST+ASONLY	;IS LISTER RUNNING
	025604'	260040	022727'		PJS	LSVLNE		;YES. SAVE BEGINNING OF STATEMENT
	025605'	260040	025651'		PJS	RESIP		;RESTORE POINTER
	025606'	202100	006252'		MOVEM	I,LISTI		;YES. SAVE TEXT POINTER
	025607'	263040	000000		RETURN


	025610'	246400	777776	CASUB:	LSHC	W,-2		;W(RIGHT) = WORD ADDRESS
	025611'	135440	034576'		LDB	X,[POINT 2,X,1]	;X = BYTE COUNT
	025612'	500411	032556'		HLL	W,CATAB(X)	;W(LEFT) = BYTE ADDRESS
	025613'	135440	034577'		LDB	X,[POINT 7,W,24]	;X = PAGE
	025614'	620400	774000		TRZ	W,-4000		;W = BYTE ADDRESS WITHIN PAGE
	025615'	256011	012647'		XCT	PGT(X)
	025616'	202440	003246'		MOVEM	X,LPG
	025617'	263040	000000		RETURN
	025620'	246400	777776	CAHSUB:	LSHC	W,-2
	025621'	135440	034576'		LDB	X,[POINT 2,X,1]
	025622'	500411	032562'		HLL	W,CATABH(X)
	025623'	135440	034577'		LDB	X,[POINT 7,W,24]
	025624'	620400	774000		TRZ	W,-4000
	025625'	256011	012647'		XCT	PGT(X)
	025626'	202440	003246'		MOVEM	X,LPG
	025627'	263040	000000		RETURN
	025630'	246400	777776	CAKSUB:	LSHC	W,-2
	025631'	135440	034576'		LDB	X,[POINT 2,X,1]
	025632'	500411	032566'		HLL	W,CATABK(X)
	025633'	135440	034577'		LDB	X,[POINT 7,W,24]
	025634'	620400	774000		TRZ	W,-4000
	025635'	256011	012647'		XCT	PGT(X)
	025636'	202440	003246'		MOVEM	X,LPG
	025637'	263040	000000		RETURN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 15-3
NAD01.R06	24-JUL-87 17:39		MISCELLANY


				;	SAVE AND RESTORE INPUT TEXT POINTERS. USED BY MACRO CALLS TO SAVE
				;	BYTE POINTER TO PREVIOUS INPUT SOURCE. THE STACK CONSISTS OF
				;	BLOCKS FROM THE FREE LIST. THE FIRST WORD OF EACH BLOCK CONTAINS
				;	THE ADDRESS OF THE PREVIOUS STACK ENTRY OR ZERO IF THE
				;	BOTTOM ENTRY. THE SECOND WORD CONTAINS THE SAVED BYTE POINTER.
				;	THE CELL "IPSTK" CONTAINS THE ADDRESS OF THE TOP OF THE STACK OR
				;	ZERO IF THE STACK IS EMPTY. IF A RESTORE IS ATTEMPTED FROM
				;	AN EMPTY STACK, THE ASSEMLER ABORTS BY CALLING THE PROGRAM FAILURE
				;	ROUTINE

	025640'	261040	000010	SAVIP:	PUSH	S,W		;NEED ONE REGISTER
	025641'	336420	006600'		GFL	
	025642'	260040	020656'
	025643'	250400	006600'			;GET A WORD FROM FREE LIST
	025644'	202110	000001		MOVEM	I,1(W)		;STORE PREVIOUS INPUT POINTER
	025645'	250400	013057'		EXCH	W,IPSTK		;HAVE STACK POINT TO NEW ENTRY
	025646'	552420	013057'		HRRZM	W,@IPSTK	;HAVE NEW ENTRY POINT TO REST TO STACK
	025647'	262040	000010		POP	S,W
	025650'	263040	000000		RETURN

	025651'	261040	000010	RESIP:	PUSH	S,W		;NEED ONE REGISTER
	025652'	336400	013057'		SKIPN	W,IPSTK		;IS STACK EMPTY
	025653'	260040	025257'		CPF			;YES. SHOULD NOT HAPPEN. ABORT
	025654'	200110	000000		MOVE	I,(W)		;GET POINTER TO REST OF STACK
	025655'	202100	013057'		MOVEM	I,IPSTK		;HAVE STACK POINT TO REST
	025656'	200110	000001		MOVE	I,1(W)		;GET PREVIOUS INPUT TEXT POINTER
	025657'	250400	006600'		DFL	W		;RETURN TOP OF STACK TO FREE LIST
	025660'	552420	006600'
	025661'	262040	000010		POP	S,W
	025662'	263040	000000		RETURN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 16
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMAND INTERPRETER

					SUBTTL	DEBUGGER COMMAND INTERPRETER
				;		**************************************************


	025663'	202040	006377'	CRIZ:	MOVEM	S,CRS		;FIRST ENTRY SPOT TO DDT
	025664'			CRESC1:
	025664'	200400	034600'		MOVE	W,[-1,,.GTPRV]	;Get current frames privledges
	025665'	047400	000041		GETTAB	W,
	025666'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	025667'	620700	000020		TRZ	F2,TYMPRP	;Assume frame does not have Tymshare license
	025670'	612400	034601'		TDNE	W,[JP.TYM]	;and check if it does
	025671'	660700	000020		TRO	F2,TYMPRP	;and if so, remember that it does
	025672'	200400	034602'		MOVE	W,[-1,,.GTFPN]	;Get files PPN that NAD came from
	025673'	047400	000041		GETTAB	W,
	025674'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	025675'	202400	002330'		MOVEM	W,NADFPN	;Save it for proprietary check
	025676'	260040	026021'		PJS	INTSET		;REENTRY POINT
	025677'	201400	001000		MOVEI	W,1000		;BREAK-ON-PUNCTUATION BIT
	025700'	047400	777752		SETMOD	W,		;SET FILE STATUS BITS
	025701'	336000	002311'		SKIPN	JE		;WAS OBJECT FILE OPEN?
	025702'	254000	025715'		JRST	CRESC2		;NO
	025703'	050500	000734'		OPEN	JCH,JSPEC	;YES
	025704'	254000	021276'		JRST	OJFE
	025705'	402000	002313'		SETZM	JE+2
	025706'	402000	002314'		SETZM	JE+3
	025707'	076500	002311'		LOOKUP	JCH,JE
	025710'	254000	021276'		JRST	OJFE
	025711'	402000	002313'		SETZM	JE+2		;CLEAR LOOKUP BLOCK
	025712'	402000	002314'		SETZM	JE+3
	025713'	077500	002311'		ENTER	JCH,JE		;REOPEN THE FILE
	025714'	254000	021276'		JRST	OJFE
	025715'	561400	000016	CRESC2:	HRROI	W,16
	025716'	474440	000000		SETO	X,
	025717'	042400	000011		AUXCAL	W,X
	025720'	202440	006412'		MOVEM	X,OBR		;OUTPUT BAUD RATE
	025721'	476000	006410'		SETOM	CN		;RESET AUX CIRCUIT NUMBER

				;	POPULAR ENTRY POINTS TO COMMAND RECOGNITION
	025722'	260040	021750'	CR:	PJS	TYPEOL		;ENTER HERE TO TYPE <CR>,<LF> AND CLOSE MEMORY
	025723'	402000	006454'	CR1:	SETZM	OPEN		;HERE TO CLOSE MEMORY ONLY
	025724'	402000	006455'	CR2:	SETZM	CMACNT		;HERE TO DO NEITHER OF ABOVE
	025725'	476000	006571'		SETOM	ICCHR
	025726'	476000	006572'		SETOM	ICCTRM		;set ic command to output terminator
	025727'	476000	001000'		SETOM	DSW		;DIRECT STATEMENTS ASSEMBLED
	025730'	201400	031332'		MOVEI	W,IC2		;ENGINE command arg kludge
	025731'	202400	006573'		MOVEM	W,ICJMP
	025732'	620640	000100		TRZ	F,CREF		;INSURE DIRECT STATEMENTS DON'T CREF
	025733'	200100	034603'		MOVE	I,[POINT 7,CS]
	025734'	402000	006437'		SETZM	BC		;INITIALIZE COMMAND STRING POINTER

				;	BUILD COMMAND STRING. SCAN FOR COMMAND CHARACTER.
	025735'	200040	006377'	CR3:	MOVE	S,CRS		;INITIALIZE PUSHDOWN STACK POINTER
	025736'	402000	003167'		SETZM	GSEC		;CLEAR EROROR COUNT
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 16-2
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMAND INTERPRETER

	025737'	200400	000551'		MOVE	W,PC
	025740'	202420	000467'		MOVEM	W,@DOTP
	025741'	316100	034604'		CAMN	I,[POINT  7,LCS,35]	;IS BUFFER FULL?
	025742'	334400	034605'		SKIPA	W,[ASCII  "    ?"]	;YES, FLUSH WITH ?
	025743'	256000	002272'		XCT	GCHI
	025744'	661640	000001		TLO	F,ESCSW		;MARK CHR RECEIVED SINCE LAST ESCAPE
	025745'	301400	000141		CAIL	W,"a"		;MAP LOWER CASE TO UPPER
	025746'	303400	000172		CAILE	W,"z"
	025747'	334000	000000		SKIPA
	025750'	275400	000040		SUBI	W,40
	025751'	201240	033142'		MOVEI	U,CT0
	025752'	260040	026131'		PJS	CMLOOK		;CHECK FOR COMMAND CHR
	025753'	326200	025756'		JUMPN	V,CR4
	025754'	136400	000002		IDPB	W,I		;ORDINARY CHR. APPEND TO COMMAND STRING
	025755'	254000	025735'		JRST	CR3

	025756'	332200	006565'	CR4:	SKIPE	V,CMLADR
	025757'	254004	000000		JRST	(V)
	025760'	254000	026123'		JRST	DQUES

	025761'	051440	000000	ESC:	CLRBFI
	025762'	051500	000000		CLRBFO
	025763'	200440	006412'		MOVE	X,OBR		;RESET OUTPUT BAUD RATE
	025764'	561400	000016		HRROI	W,16
	025765'	042400	000011		AUXCAL	W,X
	025766'	620640	405000		TRZ	F,LSLOCK+PRPCOD+PRPTOK ;clear proprietary flags
	025767'	402000	002331'		SETZM	SYLOCK
	025770'	627640	000001		TLZN	F,ESCSW
	025771'	254000	016774'		JRST	NADEX		;EXIT IF TWO ESCAPES WITH NOTHING IN BETWEEN
	025772'	201000	026124'		MOVEI	0,DQUES3	;SEND THE PROGRAM BACK TO COMMAND HANDLER
	025773'	331000	006410'		SKIPL	CN		;aux circuit active?
	025774'	201000	025777'		MOVEI	0,ICESC		;go clear it up
	025775'	542000	006400'		HRRM	0,TIV
	025776'	047000	777755		DISMIS

	025777'	514400	006410'	ICESC:	HRLZ	W,CN
	026000'	541400	000007		HRRI	W,7		;CLEAR OUTPUT BUFFER TO AUX. CIRCUIT
	026001'	042400	000000		AUXCAL	W,
	026002'	510400	000010		HLLZ	W,W
	026003'	242400	000011		LSH	W,11		;shift port number to bits 0-8
	026004'	434400	034606'		IOR	W,[141,,5]	;WAIT 5 SECONDS FOR ORANGE BALL
	026005'	047400	000072		HIBER W,
	026006'	255000	000000		JFCL
	026007'	514400	006410'		HRLZ	W,CN
	026010'	541400	000006		HRRI	W,6
	026011'	042400	000000		AUXCAL	W,		;CLEAR INPUT BUFFER
	026012'	606700	000040		TRNN	F2,BINMOD	;and in binary mode?
	026013'	254000	026124'		JRST	DQUES3		;no
	026014'	514400	006410'		HRLZ	W,CN
	026015'	541400	000004		HRRI	W,4
	026016'	042400	000201		AUXCAL	W,201		;sent flush character
	026017'	260040	031615'		PJS	ICBCLR		;AND CLEAR BINARY MODE
	026020'	254000	026124'		JRST	DQUES3		;return to command processor
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 16-3
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMAND INTERPRETER


	026021'	515400	000004	INTSET:	HRLZI	W,IA.CLR
	026022'	047400	777745		INTADR	W,		;RESET INTERRUPTS
	026023'	255000	000000		JFCL
	026024'	200400	034607'		MOVE	W,[IA.REE,,TIV]
	026025'	047400	777745		INTADR	W,		;SET INTERRUPT VECTOR ADDRESS
	026026'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	026027'	200400	034610'		MOVE	W,[IOWD NIPD,IPDS]
	026030'	202400	000037'		MOVEM	W,INTS
	026031'	525400	000001		HRLOI	W,(<.IAESC>B8+<ESCCHN>B17) ;cmd port escape channel
	026032'	047400	777736		TINASS	W,
	026033'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	026034'	205400	600000		MOVSI	W,(1B0+1B<ESCCHN>)
	026035'	047400	777744		INTENB	W,		;Enable escape interrupt
	026036'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	026037'	263040	000000		RETURN

	026040'	035000	034611'	AUXZAP:	TYPE	<$Aux circuit lost>
	026041'	541400	026044'		HRRI	W,AXZAP2
	026042'	542400	006402'		HRRM	W,TIV+<2*<ZAPCHN-1>>
	026043'	047000	777755		DISMIS
	026044'	505400	005000	AXZAP2:	HRLI	W,(<.IALOS>B8)
	026045'	540400	006410'		HRR	W,CN
	026046'	047400	777736		TINASS	W,		;unassign character lost interrupt
	026047'	255000	000000		JFCL
	026050'	505400	007000		HRLI	W,(<.IAZAP>B8)
	026051'	540400	006410'		HRR	W,CN
	026052'	047400	777736		TINASS	W,		;unassign circuit zap interrupt
	026053'	255000	000000		JFCL
	026054'	622700	000040		TRZE	F2,BINMOD	;is it in binary mode?
	026055'	254000	026062'		JRST	AXZAP3		;yes. Character receive not set
	026056'	505400	001000		HRLI	W,(<.IACHR>B8)
	026057'	540400	006410'		HRR	W,CN
	026060'	047400	777736		TINASS	W,		;unassign character received interrupt
	026061'	255000	000000		JFCL
	026062'	476000	006410'	AXZAP3:	SETOM	CN		;set no aux circuit
	026063'	200440	006412'		MOVE	X,OBR		;reset output baud rate
	026064'	561400	000016		HRROI	W,16
	026065'	042400	000011		AUXCAL	W,X
	026066'	254000	026124'		JRST	DQUES3

				;	Input character lost from aux circuit. Type message and return

	026067'	261040	000000	AUXLOS:	PUSH	S,0		;Save register used by TYPE macro
	026070'	035000	034615'		TYPE	<$Data lost from aux circuit$>
	026071'	262040	000000		POP	S,0
	026072'	047000	777755		DISMIS

	026073'	250040	000037'	AUXINT:	EXCH	S,INTS
	026074'	260040	026077'		PJS	RIP
	026075'	250040	000037'		EXCH	S,INTS
	026076'	047000	777755		DISMIS

NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 16-4
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMAND INTERPRETER

	026077'	261040	000010	RIP:	BAR	<W,X>		;RELAY FROM ENGINE TO PDP COMMAND CIRCUIT OUT
	026100'	261040	000011
	026101'	260040	026105'
	026102'	262040	000011
	026103'	262040	000010
	026104'	263040	000000
	026105'	504440	006410'		HRL	X,CN
	026106'	541440	000010	RIP1:	HRRI	X,10
	026107'	042440	000000		AUXCAL	X,
	026110'	254000	026116'		JRST	RIP2
	026111'	541440	000001		HRRI	X,1
	026112'	042440	000010		AUXCAL	X,W
	026113'	254000	026116'		JRST	RIP2		;CHR TO RELAY IS IN W
	026114'	260040	032003'		PJS	ICOUT		;print it
	026115'	254000	026106'		JRST	RIP1
	026116'	541440	000011	RIP2:	HRRI	X,11		;DO LEVDEF ON AUX CIRCUIT
	026117'	042440	000000		AUXCAL	X,		;IN CASE YELLOW BALL WAITING
	026120'	263040	000000		RETURN

	026121'	035000	034623'	DQUES1:	TYPE	<   ? >
	026122'	254000	026124'		JRST	DQUES3
	026123'	035000	034625'	DQUES:	TYPE	<   ?>
	026124'	200440	002255'	DQUES3:	MOVE	X,CURCMD	;get current command file index
	026125'	200400	034363'		MOVE	W,[PJS CTINP]	;force input from terminal
	026126'	202411	002265'		MOVEM	W,CMDSRC(X)
	026127'	202400	002272'		MOVEM	W,GCHI
	026130'	254000	025722'		JRST	CR

	026131'			CMLOOK:				;LEAVE V>0 IF COMMAND CHR. V=0 IF ORDINARY CHR.
	026131'	402000	006565'		SETZM	CMLADR		;CLEAR FOR NOW. CMLADR MAY GET A DISPATCH ADR
	026132'	306400	000040		CAIN	W," "
	026133'	350000	006437'		AOS	BC		;BLANK COUNT
	026134'	200150	032742'		MOVE	C,CT(W)		;Lookup character type
	026135'	200143	032676'		MOVE	C,RBIT(C)

	026136'	135200	034626'	CML1:	LDB	V,[POINT 7,(U),17]	;PICK UP A CMND CHR FROM TABLE
	026137'	322200	034240'		JUMPE	V,[RETURN]	;W CHR NOT IN CMND TABLE
	026140'	312400	000004		CAME	W,V
	026141'	344240	034627'		AOJA	U,[AOJA	U,CML1]
	026142'	202400	006570'		MOVEM	W,CMLCHR

	026143'	200440	006455'		MOVE	X,CMACNT	;COMPUTE ARG COUNT FROM COMMA COUNT
	026144'	312100	034603'		CAME	I,[POINT 7,CS]
	026145'	350000	000011		AOS	X
	026146'	332000	006437'		SKIPE	BC
	026147'	201440	000001		MOVEI	X,1
	026150'	202440	006440'		MOVEM	X,ARGC
	026151'	202440	006441'		MOVEM	X,ARGC1
	026152'	541200	000073		HRRI	V,73
	026153'	136200	000002		IDPB	V,I		;APPEND A SEMICOLON TO CMND STRING
	026154'	552240	006567'		HRRZM	U,CMLU
	026155'	200245	000000		MOVE	U,(U)		;PICK UP CMND CONTROL BITS
	026156'	303440	000003		CAILE	X,3		;IF GREATER THAN 3 ARGS
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 16-5
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMAND INTERPRETER

	026157'	201440	000003		MOVEI	X,3		; USE 3 FOR 3 OR GREATER NUMBER OF ARGS
	026160'	616251	032632'		TDNN	U,LBIT(X)
	026161'	254000	026210'		JRST	CMLE		;IF NOT VALID NUMBER OF ARGS FOR THIS COMMAND
	026162'	332000	006441'		SKIPE	ARGC1
	026163'	607240	020000		TLNN	U,20000
	026164'	254000	026170'		JRST	CML3		;IF NO ARGS OR V SWITCH NOT SET
	026165'	260040	026541'		PJS	AA		;ASSEMBLE ARGUMENTS
	026166'	332000	003167'		SKIPE	GSEC
	026167'	254000	026210'		JRST	CMLE		;IF ERROR IN ARGUMENTS

	026170'	200240	006567'	CML3:	MOVE	U,CMLU
	026171'	200200	006440'		MOVE	V,ARGC
	026172'	303200	000003		CAILE	V,3		;> 3 ARGS
	026173'	201200	000003		MOVEI	V,3		;YES. USE 3 OR > ADDRESS
	026174'	256004	026204'		XCT	CMLX(V)
	026175'	552200	006565'		HRRZM	V,CMLADR	;GET COMMAND ADDRESS
	026176'	200305	000000		MOVE	VS,(U)
	026177'	242300	000007		LSH	VS,7
	026200'	240300	777740		ASH	VS,-40
	026201'	202300	006566'		MOVEM	VS,CMLDTA
	026202'	260040	026651'		PJS	IZDOS
	026203'	263040	000000		RETURN

	026204'	540205	000000	CMLX:	HRR	V,(U)		;COMMAND ADDRESS FOR 0 ARGS
	026205'	544205	000001		HLR	V,1(U)		;   "       "     "  1 ARG
	026206'	540205	000001		HRR	V,1(U)		;   "       "     "  2 ARGS
	026207'	540205	000001		HRR	V,1(U)		;   "       "     "  3 ARGS OR MORE
	026210'	540200	000001	CMLE:	HRR	V,S		;ERROR IN ARGUMENTS
	026211'	263040	000000		RETURN

				;	A VALUE VECTOR IS A DOUBLE WORD. IF WORD 1 IS 0, WORD 0 IS A BINARY
				;	VALUE WORD. OTHERWISE THE FIRST 2, 4, OR 6 BYTES ARE AN INSTRUCTION,
				;	WITH THE RIGHTMOST HALF OF WORD 1 BEING 1, 2, OR 3.

	026212'	124200	006423'	XVU:	DMOVEM	V,LVV		;TRANSLATE VALUE VECTOR V,U TO STRING DOS
	026213'	200400	006443'		MOVE	W,TOM
	026214'	200410	026220'		MOVE	W,XVJ(W)
	026215'	322250	000000		JUMPE	U,(W)
	026216'	544400	000010		HLR	W,W
	026217'	254010	000000		JRST	(W)
	026220'	026225'	026236'	XVJ:	XVER,,XM
	026221'	026225'	026233'		XVER,,XN
	026222'	026225'	026255'		XVER,,XASC
	026223'	026225'	026265'		XVER,,XS
	026224'	026277'	026225'		XI,,XVER
	026225'	350000	003167'	XVER:	AOS	GSEC
	026226'	263040	000000		RETURN

	026227'	260040	026643'	XVUB:	PJS	DOS3B
	026230'	260040	026212'		PJS	XVU
	026231'	260040	026643'		PJS	DOS3B
	026232'	263040	000000		RETURN

NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 16-6
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMAND INTERPRETER

	026233'	325200	026236'	XN:	JUMPGE	V,XM		;SIGNED NUMBER TO STRING DOS
	026234'	210200	000004		MOVN	V,V
	026235'	476000	006432'		SETOM	SWMIN
	026236'			XM:				;MAGNITUDE V TO DOS
	026236'	621200	740000		TLZ	V,740000
	026237'	135400	006462'	XM1:	LDB	W,DOS
	026240'	200410	032742'		MOVE	W,CT(W)		;Lookup character type
	026241'	200410	032676'		MOVE	W,RBIT(W)
	026242'	405400	000374		ANDI	W,1_DIG!1_UAF!1_LAF!1_UGZ!1_LGZ!1_PE	;W=0 IF PLU SGN UNNECESSARY
	026243'	332000	000010		SKIPE	W
	026244'	201400	000053		MOVEI	W,53
	026245'	357000	006432'		AOSG	SWMIN
	026246'	201400	000055		MOVEI	W,55
	026247'	332000	000010		SKIPE	W
	026250'	136400	006462'		IDPB	W,DOS		;OUTPUT "+" OR "-" OR NOTHING
	026251'	200500	006333'		MOVE	Y,TRADIX
	026252'	402000	006431'		SETZM	TNX
	026253'	260040	022015'		PJS	TN		;OUTPUT NUMERIC STRING
	026254'	263040	000000		RETURN

	026255'	400240	000000	XASC:	SETZ	U,
	026256'	332000	006444'		SKIPE	COS
	026257'	246200	777760		LSHC	V,-20
	026260'	246200	777760		LSHC	V,-20
	026261'	246200	000010		LSHC	V,10
	026262'	136200	006462'		IDPB	V,DOS
	026263'	326240	026261'		JUMPN	U,.-2
	026264'	263040	000000		RETURN

	026265'	200600	006325'	XS:	MOVE	M,MM
	026266'	260040	020222'		PJS	FCS
	026267'	321400	026275'		JUMPL	W,XA1
	026270'	261040	000005		PUSH	S,U
	026271'	200250	000001		MOVE	U,1(W)
	026272'	260040	026660'		PJS	DOS6		;OUTPUT SIXBIT SYMBOL
	026273'	262040	000004		POP	S,V
	026274'	322200	034240'		JUMPE	V,[RETURN]
	026275'	260040	026233'	XA1:	PJS	XN
	026276'	263040	000000		RETURN

	026277'			XI:				;TRANSLATE INSTRUCTION V,U TO STRING DOS
	026277'	541240	000001		HRRI	U,1
	026300'	124200	006425'		DMOVEM	V,XIVU		;NOTE USE OF NON ZERO U A FEW LINES BELOW
	026301'	200400	006462'		MOVE	W,DOS
	026302'	202400	006461'		MOVEM	W,DOSX
	026303'	515600	400000		HRLZI	M,400000
	026304'	135200	034630'		LDB	V,[POINT 16,XIVU,19]
	026305'	620200	000017		TRZ	V,17
	026306'	602200	000360		TRNE	V,360
	026307'	260040	020222'		PJS	FCS
	026310'	202240	006427'		MOVEM	U,XIU		;USING NON ZERO U SET ABOVE
	026311'	322240	026320'		JUMPE	U,XI1
	026312'	620200	000377		TRZ	V,377
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 16-7
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMAND INTERPRETER

	026313'	260040	020222'		PJS	FCS
	026314'	322240	026320'		JUMPE	U,XI1
	026315'	200240	034631'		MOVE	U,[SIXBIT	"OPFLOP"]
	026316'	260040	026660'		PJS	DOS6
	026317'	263040	000000		RETURN

	026320'	552400	006430'	XI1:	HRRZM	W,XIW		;SYM TAB PTR
	026321'	200250	000001		MOVE	U,1(W)
	026322'	260040	026660'		PJS	DOS6
	026323'	260040	026644'		PJS	DOS1B
	026324'	135200	034632'		LDB	V,[POINT 4,XIVU,15]	; R1 FIELD
	026325'	332000	006427'		SKIPE	XIU
	026326'	260040	026237'		PJS	XM1
	026327'	135400	034633'		LDB	W,[POINT 6,@XIW,11]	;INTRUCTION TYPE
	026330'	307400	000011		CAIG	W,EPC9D-PC9D
	026331'	327410	017036'		JUMPG	W,PC9D-1(W)
	026332'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR

	026333'	260040	026664'	XIBF:	PJS	XICMA
	026334'	135200	034634'		LDB	V,[POINT 4,XIVU,19]
	026335'	242200	000001		LSH	V,1		;R2. HALFWORD COUNT.
	026336'	515400	000100		HRLZI	W,100
	026337'	616400	006425'		TDNN	W,XIVU
	026340'	210200	000004		MOVN	V,V		;IS IT FORWARD OR BACKWARD?
	026341'	270200	000551'		ADD	V,PC		;COMPUTE EFFECTIVE ADDRESS OF JUMP
	026342'	254000	026265'		JRST	XS		;OUTPUT AND RETURN TO CALLER

	026343'	350000	006426'	XIRX:	AOS	XIVU+1		;INTRUCTION IS AT LEAST 2 HALFWORDS LONG
	026344'	135400	034635'		LDB	W,[POINT 2,XIVU,21]	;ADRS TYPE BITS
	026345'	254010	026346'		JV	<.+1(W),XIRX1,XIRX3,XIRX2,XIRX2>
	026346'	254000	026353'
	026347'	254000	026364'
	026350'	254000	026356'
	026351'	254000	026356'

	026352'	350000	006426'	XIRI1:	AOS	XIVU+1
	026353'	200200	006425'	XIRX1:	MOVE	V,XIVU
	026354'	405200	177777		ANDI	V,177777
	026355'	254000	026401'		JRST	XID

	026356'	200200	006425'	XIRX2:	MOVE	V,XIVU
	026357'	242200	000025		LSH	V,25
	026360'	240200	777753		ASH	V,-25		;DISPLACEMENT
	026361'	270200	000551'		ADD	V,PC
	026362'	271200	000004		ADDI	V,4		;EFFECTIVE ADRS
	026363'	254000	026401'		JRST	XID

	026364'	350000	006426'	XIRX3:	AOS	XIVU+1
	026365'	120200	006425'		DMOVE	V,XIVU
	026366'	246200	000020		LSHC	V,20
	026367'	621200	777700		TLZ	V,777700
	026370'	135400	034636'		LDB	W,[POINT 4,XIVU,27]
	026371'	202400	006417'		MOVEM	W,XIRX3R
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 16-8
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMAND INTERPRETER

	026372'	254000	026401'		JRST	XID

	026373'	120200	006425'	XIRI2:	DMOVE	V,XIVU
	026374'	271240	000002		ADDI	U,2
	026375'	202240	006426'		MOVEM	U,XIVU+1
	026376'	246200	000020		LSHC	V,20
	026377'	621200	740000		TLZ	V,740000
	026400'	254000	026401'		JRST	XID

	026401'			XID:				;OUTPUT DISPLACEMENT V TO DOS
	026401'	260040	026664'		PJS	XICMA
	026402'	260040	026265'		PJS	XS
	026403'	260040	026664'	XIRR:	PJS	XICMA
	026404'	135200	034634'		LDB	V,[POINT 4,XIVU,19]
	026405'	260040	026237'		PJS	XM1		;R2 FIELD
	026406'	335200	006417'		SKIPGE	V,XIRX3R
	026407'	263040	000000		RETURN
	026410'	476000	006417'		SETOM	XIRX3R
	026411'	260040	026664'		PJS	XICMA
	026412'	254000	026265'		JRST	XS		;SAME AS PJS XS	;PS

	026413'	261040	000012	MD:	BAR	<Y>		;MEMORY TO DOUBLE WORD
	026414'	260040	026417'
	026415'	262040	000012
	026416'	263040	000000
	026417'	200000	034637'		MOVE	0,[POINT 8,V,3]
	026420'	403200	000005		SETZB	V,U
	026421'	200400	000012	MD1:	MOVE	W,Y
	026422'	260040	025610'		CA
	026423'	135400	000010		LDB	W,W
	026424'	136400	000000		IDPB	W,0
	026425'	312000	034640'		CAME	0,[POINT 8,U,23]
	026426'	344500	026421'		AOJA	Y,MD1
	026427'	263040	000000		RETURN

	026430'	261040	000012	DM:	BAR	<Y>		;DOUBLE WORD TO MEMORY. Y IS PC.
	026431'	260040	026434'
	026432'	262040	000012
	026433'	263040	000000
	026434'	200000	034637'		MOVE	0,[POINT 8,V,3]
	026435'	200400	000012	DM1:	MOVE	W,Y
	026436'	260040	025610'		CA
	026437'	134440	000000		ILDB	X,0
	026440'	137440	000010		DPB	X,W
	026441'	312000	034640'		CAME	0,[POINT 8,U,23]
	026442'	344500	026435'		AOJA	Y,DM1
	026443'	263040	000000		RETURN

	026444'			MV:				;MEMORY TO VALUE VECTOR. Y=PC.
	026444'	260040	026413'		PJS	MD		;GET A DOUBLE WORD
	026445'	200400	006443'	MV0:	MOVE	W,TOM
	026446'	254010	026447'		JV	<.+1(W),MVM,MVN,MVM,MVM,MVI>
	026447'	254000	026461'
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 16-9
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMAND INTERPRETER

	026450'	254000	026454'
	026451'	254000	026461'
	026452'	254000	026461'
	026453'	254000	026467'
	026454'	242200	000004	MVN:	LSH	V,4
	026455'	336000	006444'		SKIPN	COS
	026456'	240200	777760		ASH	V,-20
	026457'	240200	777774		ASH	V,-4		;PRESERVE SIGN INFO
	026460'	254000	026465'		JRST	MVM1
	026461'	242200	000004	MVM:	LSH	V,4
	026462'	336000	006444'		SKIPN	COS
	026463'	242200	777760		LSH	V,-20
	026464'	242200	777774		LSH	V,-4
	026465'	400240	000000	MVM1:	SETZ	U,
	026466'	263040	000000		RETURN
	026467'	124200	006420'	MVI:	DMOVEM	V,MDPAIR
	026470'	260040	026277'		PJS	XI
	026471'	120200	006425'		DMOVE	V,XIVU
	026472'	200400	006461'		MOVE	W,DOSX
	026473'	202400	006462'		MOVEM	W,DOS
	026474'	263040	000000		RETURN

	026475'	326240	026511'	VM:	JUMPN	U,VMI		;IT IS AN INSTRUCTION VALUE VECTOR
	026476'	200000	034641'		MOVE	0,[POINT 16,V,3]
	026477'	336000	006444'		SKIPN	COS
	026500'	133000	000000		IBP	0
	026501'	200400	000012	VM1:	MOVE	W,Y
	026502'	271500	000002		ADDI	Y,2
	026503'	260040	025620'		PJS	CAHSUB
	026504'	134440	000000		ILDB	X,0
	026505'	137440	000010		DPB	X,W
	026506'	603000	770000		TLNE	0,770000
	026507'	254000	026501'		JRST	VM1
	026510'	263040	000000		RETURN
	026511'	550540	000005	VMI:	HRRZ	L,U
	026512'	246200	777760		LSHC	V,-20
	026513'	200400	000012	VMI1:	MOVE	W,Y
	026514'	271500	000002		ADDI	Y,2
	026515'	260040	025620'		PJS	CAHSUB
	026516'	137200	000010		DPB	V,W
	026517'	246200	000020		LSHC	V,20
	026520'	367540	026513'		SOJG	L,VMI1
	026521'	263040	000000		RETURN

	026522'	202200	000551'	FCCPC:	MOVEM	V,PC
	026523'			FCC:				;FULL CELL CONTENTS TO DOS
	026523'	200500	000004		MOVE	Y,V
	026524'	260040	026444'		PJS	MV
	026525'	124200	006423'		DMOVEM	V,LVV
	026526'	260040	026227'		PJS	XVUB
	026527'	263040	000000		RETURN

	026530'	261040	000004	FC:	PUSH	S,V		;FULL CELL AND ITS LABEL TO DOS. V=PC.
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 16-10
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMAND INTERPRETER

	026531'	260040	026651'		PJS	IZDOS
	026532'	260040	026265'		PJS	XS		;LABEL TO DOS
	026533'	201400	000134		MOVEI	W,134
	026534'	136400	006462'		IDPB	W,DOS		;OUTPUT A BACKSLASH
	026535'	262040	000004		POP	S,V
	026536'	260040	026522'		PJS	FCCPC
	026537'	260040	026654'		PJS	DOSOUT
	026540'	263040	000000		RETURN

	026541'			AA:				;ASSEMBLE ARGUMENTS
	026541'	541400	006525'		HRRI	W,VTAB
	026542'	552400	006524'		HRRZM	W,VTABP
	026543'	402000	003167'		SETZM	GSEC
	026544'	332000	006437'		SKIPE	BC
	026545'	254000	026601'		JRST	AAI
				;	ASSEMBLE ARGUMENT EXPRESSIONS
	026546'	200400	006441'		MOVE	W,ARGC1		;GET NUMBER OF ARGS TYPED
	026547'	303400	000020		CAILE	W,NCARGS	;ARE THERE TOO MANY
	026550'	254000	026566'		JRST	AAE		;YES. ERROR
	026551'	200100	034603'		MOVE	I,[POINT 7,CS]
	026552'	200400	006325'	AA1:	MOVE	W,MM
	026553'	202400	006326'		MOVEM	W,MM1
	026554'	260040	026573'		PJS	AAGS
	026555'	367240	026566'		SOJG	U,AAE		;ERROR IF NOT DEFINED OR NOT NULL
	026556'	201400	000002		MOVEI	W,2
	026557'	273400	006524'		ADDB	W,VTABP
	026560'	400240	000000		SETZ	U,
	026561'	124210	777776		DMOVEM	V,-2(W)
	026562'	124200	006423'		DMOVEM	V,LVV
	026563'	373000	006441'		SOSLE	ARGC1
	026564'	254000	026552'		JRST	AA1
	026565'	254000	026640'		JRST	AAEND
	026566'	350000	003167'	AAE:	AOS	GSEC
	026567'	541200	000077		HRRI	V,77
	026570'	136200	006462'		IDPB	V,DOS
	026571'	136200	006462'		IDPB	V,DOS		;2 QUESTION MARKS
	026572'	254000	026640'		JRST	AAEND

	026573'	202040	006321'	AAGS:	MOVEM	S,GSSTK		;save stack pointer for abort
	026574'	260040	017071'		PJS	GE		;assemble expersion
	026575'	332000	006257'		SKIPE	LEC		;any error messages?
	026576'	260040	025264'		PJS	TLE		;yes. type them
	026577'	263040	000000		RETURN

	026600'	334100	034603'	AAL:	SKIPA	I,[POINT 7,CS]
	026601'	200100	034642'	AAI:	MOVE	I,[POINT 7,CS0]	;ASSEMBLE INSTRUCTION
	026602'	541400	006525'		HRRI	W,VTAB
	026603'	552400	006524'		HRRZM	W,VTABP
	026604'	201400	000001		MOVEI	W,1
	026605'	202400	006440'		MOVEM	W,ARGC
	026606'	200500	000551'		MOVE	Y,PC
	026607'	202500	006422'		MOVEM	Y,AAPC
	026610'	260040	026413'		PJS	MD
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 16-11
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMAND INTERPRETER

	026611'	124200	006420'		DMOVEM	V,MDPAIR
	026612'	541400	017071'		HRRI	W,GE
	026613'	552400	006577'		HRRZM	W,GECALL
	026614'	660640	000001		TRO	F,ASONLY
	026615'	476000	000777'		SETOM	LSTMSK
	026616'	260040	016473'		PJS	GS
	026617'	332000	006257'		SKIPE	LEC		;type any error messages
	026620'	260040	025264'		PJS	TLE
	026621'	541400	000004		HRRI	W,4
	026622'	336000	003167'		SKIPN	GSEC
	026623'	552400	006443'		HRRZM	W,TOM
	026624'	200500	006422'		MOVE	Y,AAPC
	026625'	202500	000551'		MOVEM	Y,PC
	026626'	260040	026413'		PJS	MD
	026627'	250200	006420'		EXCH	V,MDPAIR
	026630'	250240	006421'		EXCH	U,MDPAIR+1
	026631'	260040	026430'		PJS	DM
	026632'	120200	006420'		DMOVE	V,MDPAIR
	026633'	260040	026445'		PJS	MV0
	026634'	200400	006461'		MOVE	W,DOSX
	026635'	202400	006462'		MOVEM	W,DOS
	026636'	124220	006524'		DMOVEM	V,@VTABP
	026637'	124200	006423'		DMOVEM	V,LVV
	026640'	623640	004000	AAEND:	TLZE	F,ABTASM	;was assembly aborted?
	026641'	254000	026124'		JRST	DQUES3		;yes. stop command file
	026642'	263040	000000		RETURN


	026643'	334400	034643'	DOS3B:	SKIPA	W,[40_16+40_7+40]	;3 BLANKS
	026644'	551400	000040	DOS1B:	HRRZI	W,40
	026645'	136400	006462'		IDPB	W,DOS
	026646'	242400	777771		LSH	W,-7
	026647'	326400	026645'		JUMPN	W,.-2
	026650'	263040	000000		RETURN

	026651'	200400	034644'	IZDOS:	MOVE	W,[POINT 7,DOS+1]
	026652'	202400	006462'		MOVEM	W,DOS
	026653'	263040	000000		RETURN
	026654'	400400	000000	DOSOUT:	SETZ	W,
	026655'	136400	006462'		IDPB	W,DOS
	026656'	051140	006463'		OUTSTR	DOS+1
	026657'	263040	000000		RETURN

	026660'	350000	006456'	DOS6:	AOS	P6
	026661'	260040	022000'		PJS	TYP6
	026662'	370000	006456'		SOS	P6
	026663'	263040	000000		RETURN

	026664'	135000	006462'	XICMA:	LDB	0,DOS		;OUTPUT COMMA TO DISASSEMBLY STRING IF ADVISEABLE
	026665'	201400	000054		MOVEI	W,","
	026666'	302000	000040		CAIE	0," "
	026667'	136400	006462'		IDPB	W,DOS
	026670'	263040	000000		RETURN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 16-12
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMAND INTERPRETER


	026671'	261040	000010	PBY:	BAR	<W>		;PUT BYTE V INTO MEMORY LOC W
	026672'	260040	026675'
	026673'	262040	000010
	026674'	263040	000000
	026675'	336000	006433'		SKIPN	LOCAL
	026676'	254000	026702'		JRST	PBY7
	026677'	260040	025610'		CA
	026700'	137200	000010		DPB	V,W
	026701'	263040	000000		RETURN

	026702'	260040	025257'	PBY7:	CPF			;REPORT ASSEMBLER INTERNAL ERROR

	026703'	350000	006455'	KCOMMA:	AOS	CMACNT
	026704'	201400	000054		MOVEI	W,","
	026705'	137400	000002		DPB	W,I
	026706'	254000	025735'		JRST	CR3
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

					SUBTTL	DEBUGGER COMMANDS
				;		**************************************************


	026707'	620640	000014	AF:	TRZ	F,LPASS1+LPASS2
	026710'	602700	000010		TRNE	F2,PS1LST	;Is a pass 1 listing desired?
	026711'	660640	000004		TRO	F,LPASS1	;Yes, request pass one listing.
	026712'	606700	000001		TRNN	F2,FRCLST	;Should a pass two listing be forced
	026713'	332000	000006		SKIPE	VS		;or is it being requested
	026714'	660640	000010		TRO	F,LPASS2	;yes, request pass two listing.
	026715'	602640	000010		TRNE	F,LPASS2	;If a pass two listing is requested,
	026716'	620640	000004		TRZ	F,LPASS1	;don't request a pass one listing
	026717'	260040	021763'		PJS	BL3
	026720'	260040	021115'		PJS	GFN		;Get input file name
	026721'	254000	026123'		JRST	DQUES		;not a well formed file name
	026722'	124540	002321'		DMOVEM	L,IL+2		;save file name and extension
	026723'	124440	002315'		DMOVEM	X,ILUSR		;save user name
	026724'	400400	000000		SETZ	W,		;assume listing buffer needed for listing
	026725'	606640	000010		TRNN	F,LPASS2	;unless listing in pass 2
	026726'	606640	000004		TRNN	F,LPASS1	;or no pass 1 listing
	026727'	201400	000010		MOVEI	W,NLBF		;then free listing buffers for input
	026730'	332000	002301'		SKIPE	LOH		;unless list file already open
	026731'	400400	000000		SETZ	W,		;then buffers not free for input
	026732'	202400	000776'		MOVEM	W,LSPACE	;list buffers free for input
	026733'	260040	021205'		PJS	OIF		;open input file
	026734'	322400	026123'		JUMPE	W,DQUES		;open error. abort
	026735'	620640	404000		TRZ	F,LSLOCK+PRPCOD
	026736'	200400	002320'		MOVE	W,IFPPN		;Get input files PPN
	026737'	316400	002330'		CAMN	W,NADFPN	;Is input file not from NAD's home directory
	026740'	602700	000020		TRNE	F2,TYMPRP	;or does frame have Tymshare license?
	026741'	254000	026744'		JRST	AF1		;Yes. Allow listings
	026742'	660640	404000		TRO	F,LSLOCK+PRPCOD	;No. Forbid listing of proprietary code
	026743'	620640	000014		TRZ	F,LPASS1+LPASS2
	026744'	402000	001000'	AF1:	SETZM	DSW		;assemble indirect statements
	026745'	260040	016230'		PJS	GF
	026746'	620640	405000		TRZ	F,LSLOCK+PRPCOD+PRPTOK
	026747'	402000	002331'		SETZM	SYLOCK
	026750'	623640	004000		TLZE	F,ABTASM	;assembly aborted?
	026751'	254000	026124'		JRST	DQUES3		;yes. stop command file
	026752'	254000	025722'		JRST	CR

	026753'			IBF:			;IMAGE BINARY FILE COMMANDS ;F AND %F
	026753'	260040	021541'		PJS	UBID		;UPDATE PREVIOUS (POSSIBLE) FILE
	026754'	202300	002747'		MOVEM	VS,BFSW		;FLAG NEW OR APPEND
	026755'	260040	021763'		PJS	BL3		;OUTPUT 3 BLANKS
	026756'	260040	021115'		PJS	GFN		;GET NEW FILENAME
	026757'	254000	027063'		JRST	IBER		;not a well formed file name.
	026760'	124540	000744'		DMOVEM	L,BL+2		;FILENAME and extension
	026761'	124440	002336'		DMOVEM	X,IBUNAM	;user name
	026762'	403400	000746'		SETZB	W,BL+4
	026763'	332000	002336'		SKIPE	IBUNAM		;SKIP IF NO USERNAME GIVEN
	026764'	551400	002336'		HRRZI	W,IBUNAM	;USERNAME IS IN IBUNAM
	026765'	202400	000743'		MOVEM	W,BL+1		;POINT TO USERNAME
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-2
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	026766'	402000	000753'		SETZM	BL+11		;INSURE INITIAL STORAGE VALUE = 0
	026767'	050540	000737'		OPEN	BCH,BSPEC	;CLOSE OLD FILE, OPEN NEW
	026770'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	026771'	076540	000742'		LOOKUP	BCH,BL		;CHECK FOR EXISTING FILE
	026772'	254000	027016'		JRST	IBF1		;CHECK ERRORS
	026773'	200400	000743'		MOVE	W,BL+1		;get PPN
	026774'	336000	002336'		SKIPN	IBUNAM		;was user name given?
	026775'	202400	002337'		MOVEM	W,IBUNAM+1	;no. save PPN
	026776'	336000	006440'		SKIPN	ARGC		;ANY ARGUMENTS?
	026777'	254000	027005'		JRST	IBF6		;NO
	027000'	336000	006423'		SKIPN	LVV		;ARG VALUE=0?
	027001'	254000	027005'		JRST	IBF6		;YES
	027002'	332000	002747'		SKIPE	BFSW		;SKIP IF 1;F
	027003'	254000	027030'		JRST	IBF3		;1%F, OK TO ENTER FILE
	027004'	254000	027025'		JRST	IBF2		;1;F, OK TO SUPERSEDE
	027005'	332000	002747'	IBF6:	SKIPE	BFSW		;SKIP IF ;F
	027006'	254000	027056'		JRST	IBF5		;0%F, INPUT EXISTING ID BLOCK
	027007'	035000	034645'		TYPE	<Supersede existing file? (Y or N): >
	027010'	661640	200000		TLO	F,DCCF		;GET CHARACTER IMEDIATELY
	027011'	256000	002272'		XCT	GCHI		;GET RESPONSE
	027012'	302400	000131		CAIE	W,"Y"
	027013'	306400	000171		CAIN	W,"y"
	027014'	254000	027025'		JRST	IBF2		;IF YES
	027015'	254000	027065'		JRST	IBEX		;IF NO

	027016'			IBF1:				;CHECK LOOKUP ERROR
	027016'	540200	000745'		HRR	V,BL+3		;ERROR CODE
	027017'	326200	027063'		JUMPN	V,IBER		;ABORT IF TYPE NOT "FILE NOT FOUND"
	027020'	336000	002747'		SKIPN	BFSW		;SKIP IF %F
	027021'	254000	027030'		JRST	IBF3		;NO FILE, OK FOR ;F
	027022'	035000	034655'		TYPE	<Creating new file.>
	027023'	402000	002747'		SETZM	BFSW		;FLAG NEW FILE
	027024'	254000	027030'		JRST	IBF3

	027025'			IBF2:				;SUPERSEDING EXISTING FILE
	027025'	070540	000000		CLOSE	BCH,		;RETURN OLD FILE
	027026'	402000	000747'		SETZM	BL+5		;CLEAR WORD SIZE
	027027'	402000	000753'		SETZM	BL+11		;CLEAR BLOCK SIZE
	027030'			IBF3:				;ENTER NEW OR UPDATE FILE
	027030'	400200	000000		SETZ	V,
	027031'	542200	000745'		HRRM	V,BL+3		;CLEAR ERROR CODE
	027032'	402000	000746'		SETZM	BL+4		;CLEAR DATE AND TIME FIELD
	027033'	077540	000742'		ENTER	BCH,BL
	027034'	254000	027063'		JRST	IBER		;ENTER ERROR
	027035'	200400	000743'		MOVE	W,BL+1		;get PPN
	027036'	336000	002336'		SKIPN	IBUNAM		;was user name given?
	027037'	202400	002337'		MOVEM	W,IBUNAM+1	;no. save PPN
	027040'	200200	002747'		MOVE	V,BFSW
	027041'	402000	002747'		SETZM	BFSW		;FLAG OUTPUT IS OK
	027042'	302200	000000		CAIE	V,0		;IS THIS NEW OR EXISTING FILE?
	027043'	254000	027056'		JRST	IBF5		;INPUT EXISTING ID BLOCK
	027044'	402000	002750'		SETZM	BAD
	027045'	260040	021503'		PJS	IIDB		;INITIALIZE NEW ID BLOCK
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-3
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	027046'	400200	000000	IBF4:	SETZ	V,
	027047'	542200	000745'		HRRM	V,BL+3		;CLEAR DATE FIELD
	027050'	402000	000746'		SETZM	BL+4		;CLEAR TIME FIELD
	027051'	474600	000000		SETO	M,
	027052'	260040	025443'		PJS	TUN		;TEST UNDEFINEDS
	027053'	325500	025722'		JUMPGE	Y,CR		;EXIT IF NONE
	027054'	035000	034661'		TYPE	<*** Undefined symbols, memory image not guaranteed$>
	027055'	254000	025722'		JRST	CR		;NOW EXIT

	027056'			IBF5:				;INPUT ID BLOCK, MARK INDEX AS FULL
	027056'	066540	034674'		IBINP	IBID
	027057'	201200	002530'		MOVEI	V,IBIDC-1
	027060'	202200	002745'		MOVEM	V,IBRIXP	;MARK AS FULL
	027061'	476000	002750'		SETOM	BAD		;FLAG UNKNOWN BLOCK ADDRESS
	027062'	254000	027046'		JRST	IBF4		;CHECK FOR UNDEFINED SYMBOLS

	027063'	476000	002747'	IBER:	SETOM	BFSW		;ERROR IN COMMAND, RESET FLAG
	027064'	254000	026123'		JRST	DQUES

	027065'	476000	002747'	IBEX:	SETOM	BFSW		;FORGET IT!
	027066'	254000	026124'		JRST	DQUES3


				;	PAD,VAD,CNT;G - GET NIB FILE INTO LOCAL IMAGE
	027067'	402000	002743'	GIB0:	SETZM	MIALL		;0 ARG. GET ENTIRE FILE
	027070'	254000	027107'		JRST	GI1
	027071'	200200	006525'	GIB1:	MOVE	V,VTAB		;1 ARG
	027072'	202200	006527'		MOVEM	V,VTAB+2	;SET COUNT IN ARG 2
	027073'	402000	006525'		SETZM	VTAB		;PAD = 0
	027074'	200200	006440'	GIB2:	MOVE	V,ARGC
	027075'	303200	000002		CAILE	V,2		;2 ARGS OR LESS?
	027076'	254000	027103'		JRST	GIB3		;3 ARGS
	027077'	200200	006527'		MOVE	V,VTAB+2	;2 ARGS
	027100'	202200	006531'		MOVEM	V,VTAB+4	;MOVE COUNT
	027101'	200200	006525'		MOVE	V,VTAB
	027102'	202200	006527'		MOVEM	V,VTAB+2	;COPY PAD TO VAD
	027103'	476000	002743'	GIB3:	SETOM	MIALL		;SET FLAG TO GET SELECTIVE
	027104'	200200	006525'		MOVE	V,VTAB		;GET PAD
	027105'	272200	006531'		ADDM	V,VTAB+4	;CHANGE BCNT TO LAD+1
	027106'	276200	006527'		SUBM	V,VTAB+2	;CHANGE VAD TO A BIAS
	027107'	335000	002747'	GI1:	SKIPGE	BFSW		;IS THERE A CURRENT FILE?
	027110'	254000	030100'		JRST	PSIBE2		;NO
	027111'	402000	002741'		SETZM	BRNGL		;SET RANGE LIST NULL
	027112'	400600	000000		SETZ	M,		;SET INDEX SCAN TO INITIALIZE
	027113'	260040	027424'	GI4:	PJS	IXSCAN		;GET NEXT INDEX ENTRY
	027114'	254000	027345'		JRST	GIT		;NO MORE. GO TEST FOR MISSING PEICES
	027115'	135200	002733'		LDB	V,IBTYPP	;GET RECORD TYPE
	027116'	302200	000002		CAIE	V,MITYP		;IS THIS A MEMORY IMAGE INDEX?
	027117'	254000	027113'		JRST	GI4		;NO
	027120'	331000	002743'		SKIPL	MIALL		;GETTING ENTIRE FILE?
	027121'	254000	027172'		JRST	GI2		;YES. GET THIS RECORD
	027122'	135200	002735'		LDB	V,IBPADP	;GET PAD FOR THIS RECORD
	027123'	311200	006531'		CAML	V,VTAB+4	;IS PAD < LAD+1?
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-4
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	027124'	254000	027113'		JRST	GI4		;NO
	027125'	135240	002736'		LDB	U,IBCNTP	;GET BYTE COUNT
	027126'	270240	000004		ADD	U,V		;PAD+BCNT
	027127'	317240	006525'		CAMG	U,VTAB		;IS (PAD+BCNT)>REQUESTED PAD?
	027130'	254000	027113'		JRST	GI4		;NO

	027131'	315200	006525'		CAMGE	V,VTAB		;GET FAD=MAX(PAD,REQUESTED PAD)
	027132'	200200	006525'		MOVE	V,VTAB
	027133'	313240	006531'		CAMLE	U,VTAB+4	;GET LAD+1=MIN(PAD+BCNT,REQUESTED LAD+1)
	027134'	200240	006531'		MOVE	U,VTAB+4
	027135'	336420	006600'	GI6:	GFL	
	027136'	260040	020656'
	027137'	250400	006600'			;GET ENTRY FOR RANGE LIST
	027140'	124210	000001		DMOVEM	V,1(W)		;SAVE FAD AND LAD+1
	027141'	201440	002741'		MOVEI	X,BRNGL		;SCAN LIST TO INSERT NEW ENTRY
	027142'	200500	000011	GI21:	MOVE	Y,X		;SAVE ADDRESS OF PREVIOUS ENTRY
	027143'	200452	000000		MOVE	X,(Y)		;ADDRESS NEXT ENTRY
	027144'	322440	027147'		JUMPE	X,GI22		;CHECK IF END OF LIST
	027145'	313211	000001		CAMLE	V,1(X)		;IS NEW FAD<=FAD OF THIS ENTRY?
	027146'	254000	027142'		JRST	GI21		;NO. GO GET NEXT ENTRY
	027147'	552450	000000	GI22:	HRRZM	X,(W)		;HAVE NEW POINT TO ENTRY FOUND
	027150'	552412	000000		HRRZM	W,(Y)		;HAVE PREVIOUS POINT TO NEW
	027151'	326440	027153'		JUMPN	X,.+2		;IS NEW ENTRY NEW LIST END?
	027152'	552400	002742'		HRRZM	W,ERNGL		;YES. SAVE ADDRESS OF LIST END
	027153'	135400	002734'		LDB	W,IBBADP	;GET BLOCK ADDRESS OF RECORD
	027154'	074550	000001		USETI	BCH,1(W)	;POSITION TO BLOCK
	027155'	201540	002534'		MOVEI	L,MIDATA
	027156'	135300	002735'		LDB	VS,IBPADP	;INIT CURRENT ADDRESS (CAD)
	027157'	066540	034676'	GI7:	IBINP	MIHDR		;GET NEXT DATA BLOCK
	027160'	335013	000000	GI8:	SKIPGE	(L)		;IS THIS A COMPRESSION WORD?
	027161'	254000	027204'		JRST	GI10		;YES, UNCOMPRESS IT
	027162'	271300	000004		ADDI	VS,4		;CAD=CAD+4
	027163'	313300	000004		CAMLE	VS,V		;IS CAD > FAD
	027164'	254000	027264'		JRST	GI14		;YES, COPY TO LOCAL MEMORY
	027165'	271540	000001	GI9:	ADDI	L,1		;NO, GET NEXT WORD
	027166'	305540	002732'		CAIGE	L,MIEND		;END OF BLOCK?
	027167'	254000	027160'		JRST	GI8		;NO, GET NEXT WORD
	027170'	201540	002532'		MOVEI	L,MIHDR		;YES, POSITION WORD POINTER TO START
	027171'	254000	027157'		JRST	GI7		;GET NEXT BLOCK
	027172'	135200	002740'	GI2:	LDB	V,IBVADP	;GET VAD
	027173'	135240	002737'		LDB	U,IBUVAP	;GET VAD DEFINED BIT.
	027174'	602240	000001		TRNE	U,1		;IS VAD DEFINED?
	027175'	135200	002735'		LDB	V,IBPADP	;NO. USE PAD.
	027176'	202200	006527'		MOVEM	V,VTAB+2	;SAVE FOR STORE
	027177'	135200	002735'		LDB	V,IBPADP	;GET PAD
	027200'	276200	006527'		SUBM	V,VTAB+2	;CHANGE VAD TO BIAS
	027201'	135240	002736'		LDB	U,IBCNTP	;GET BCNT
	027202'	270240	000004		ADD	U,V		;CONVERT TO LAD+1
	027203'	254000	027135'		JRST	GI6

	027204'	550513	000000	GI10:	HRRZ	Y,(L)		;GET REPEAT COUNT
	027205'	242500	000001		LSH	Y,1		;RC*2
	027206'	271500	000002		ADDI	Y,2		;BYTE COUNT = RC*2+2
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-5
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	027207'	270300	000012		ADD	VS,Y		;CAD=CAD+BYTE COUNT
	027210'	317300	000004		CAMG	VS,V		;IS CAD>FAD?
	027211'	254000	027165'		JRST	GI9		;NO, GET NEXT WORD
	027212'	200500	000006		MOVE	Y,VS
	027213'	274500	000004		SUB	Y,V		;BCNT=CAD-FAD
	027214'	135140	034700'		LDB	C,[POINT 8,(L),8]	;GET BYTE 1
	027215'	135340	034701'		LDB	OS,[POINT 8,(L),17]	;GET BYTE 2
	027216'	606500	000001		TRNN	Y,1		;IS COUNT EVEN?
	027217'	254000	027230'		JRST	GI11		;YES
	027220'	271500	000001		ADDI	Y,1		;MAKE IT EVEN
	027221'	200400	000004		DBYTE	OS		;DEPOSIT THE BYTE
	027222'	274400	006527'
	027223'	260040	025610'
	027224'	137340	000010
	027225'	271200	000001
	027226'	311200	000005		CAML	V,U		;FAD<LAD+1?
	027227'	254000	027336'		JRST	GI20		;NO, DONE
	027230'	200440	000004	GI11:	MOVE	X,V		;FAD
	027231'	270440	000012		ADD	X,Y		;FAD+BCNT
	027232'	315440	000005		CAMGE	X,U		;FAD+BCNT<LAD+1?
	027233'	254000	027236'		JRST	GI12		;YES
	027234'	200500	000005		MOVE	Y,U
	027235'	274500	000004		SUB	Y,V		;BCNT=LAD+1-FAD
	027236'	200400	000004	GI12:	DBYTE	C		;DEPOSIT BYTE 1
	027237'	274400	006527'
	027240'	260040	025610'
	027241'	137140	000010
	027242'	271200	000001
	027243'	200400	000004		DBYTE	OS		;DEPOSIT BYTE 2
	027244'	274400	006527'
	027245'	260040	025610'
	027246'	137340	000010
	027247'	271200	000001
	027250'	275500	000002		SUBI	Y,2		;BCNT=BCNT-2
	027251'	303500	000001		CAILE	Y,1		;MORE THAN 1 BYTE LEFT?
	027252'	254000	027236'		JRST	GI12		;YES
	027253'	322500	027261'		JUMPE	Y,GI13		;IF NO MORE LEFT
	027254'	200400	000004		DBYTE	C		;DEPOSIT LAST BYTE
	027255'	274400	006527'
	027256'	260040	025610'
	027257'	137140	000010
	027260'	271200	000001
	027261'	311200	000005	GI13:	CAML	V,U		;FAD<LAD+1?
	027262'	254000	027336'		JRST	GI20		;NO, DONE
	027263'	254000	027165'		JRST	GI9		;GET NEXT WORD

	027264'	200500	000006	GI14:	MOVE	Y,VS
	027265'	274500	000004		SUB	Y,V		;BCNT=CAD-FAD
	027266'	306500	000004		CAIN	Y,4		;HOW MANY BYTES?
	027267'	254000	027275'		JRST	GI15		;IF 4
	027270'	306500	000003		CAIN	Y,3
	027271'	254000	027305'		JRST	GI16		;IF 3
	027272'	306500	000002		CAIN	Y,2
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-6
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	027273'	254000	027315'		JRST	GI17		;IF 2
	027274'	254000	027325'		JRST	GI18		;IF 1

	027275'	135140	034700'	GI15:	LDB	C,[POINT 8,(L),8]
	027276'	200400	000004		DBYTE	C		;DEPOSIT BYTE 1
	027277'	274400	006527'
	027300'	260040	025610'
	027301'	137140	000010
	027302'	271200	000001
	027303'	311200	000005		CAML	V,U		;VAD<LAD+1?
	027304'	254000	027336'		JRST	GI20		;NO, DONE
	027305'	135140	034701'	GI16:	LDB	C,[POINT 8,(L),17]
	027306'	200400	000004		DBYTE	C		;BYTE 2
	027307'	274400	006527'
	027310'	260040	025610'
	027311'	137140	000010
	027312'	271200	000001
	027313'	311200	000005		CAML	V,U
	027314'	254000	027336'		JRST	GI20
	027315'	135140	034702'	GI17:	LDB	C,[POINT 8,(L),26]
	027316'	200400	000004		DBYTE	C		;BYTE 3
	027317'	274400	006527'
	027320'	260040	025610'
	027321'	137140	000010
	027322'	271200	000001
	027323'	311200	000005		CAML	V,U
	027324'	254000	027336'		JRST	GI20
	027325'	135140	034703'	GI18:	LDB	C,[POINT 8,(L),35]
	027326'	200400	000004		DBYTE	C		;BYTE 4
	027327'	274400	006527'
	027330'	260040	025610'
	027331'	137140	000010
	027332'	271200	000001
	027333'	311200	000005		CAML	V,U
	027334'	254000	027336'		JRST	GI20
	027335'	254000	027165'		JRST	GI9		;GET NEXT WORD

	027336'	274240	006527'	GI20:	SUB	U,VTAB+2	;CONVERT LAD+1 TO VIRTUAL
	027337'	135200	002735'		LDB	V,IBPADP	;GET FILE FAD
	027340'	274200	006527'		SUB	V,VTAB+2	;CONVERT TO VIRTUAL
	027341'	242200	777760		LSH	V,-20		;COMPUTE SEGMENT NUMBER
	027342'	313244	000531'		CAMLE	U,SEGTOP(V)	;HAS SEGMENT GOT LARGER?
	027343'	202244	000531'		MOVEM	U,SEGTOP(V)	;YES. SET NEW MAX.
	027344'	254000	027113'		JRST	GI4		;GO GET NEXT RECORD

	027345'			GIT:				;TEST FOR MISSING PIECES
	027345'	331000	002743'		SKIPL	MIALL		;WAS ENTIRE FILE READ?
	027346'	254000	027371'		JRST	GIT31		;YES. NO NEED TO CHECK MEMORY
	027347'	336500	002741'		SKIPN	Y,BRNGL		;WERE ANY RANGES READ?
	027350'	254000	027366'		JRST	GIT2		;NOPE
	027351'	200212	000001		MOVE	V,1(Y)		;GET LOWEST ADDRESS READ
	027352'	312200	006525'		CAME	V,VTAB		;IS IT = PAD?
	027353'	254000	027370'		JRST	GIT3		;NO. DATA NOT READ
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-7
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	027354'	200212	000002		MOVE	V,2(Y)		;SET HIGHEST LAD+1 READ
	027355'	316200	006531'	GIT1:	CAMN	V,VTAB+4	;IS HIGHEST READ+1=REQUESTED LAD+1
	027356'	254000	027417'		JRST	GIT4		;YES. ALL DATA READ
	027357'	200512	000000		MOVE	Y,(Y)		;GET NEXT ENTRY
	027360'	322500	027370'		JUMPE	Y,GIT3		;IF NO MORE ENTRIES, DATA MISSING
	027361'	315212	000001		CAMGE	V,1(Y)		;IS NEXT PAD TOO HIGH?
	027362'	254000	027370'		JRST	GIT3		;YES. DATA MISSING
	027363'	317212	000002		CAMG	V,2(Y)		;IS NEW LAD+1>OLD LAD+1
	027364'	200212	000002		MOVE	V,2(Y)		;YES. SET NEW TO HIGHEST LAD+1 READ
	027365'	254000	027355'		JRST	GIT1		;GO EXAMINE NEXT RANGE
	027366'	035000	034704'	GIT2:	TYPE	< *** File missing all of requested data>
	027367'	254000	025722'		JRST	CR
	027370'	035000	034714'	GIT3:	TYPE	< *** File missing some of requested data>
	027371'	035000	034725'	GIT31:	TYPE	<$Data ranges read:>
	027372'	200400	002741'		MOVE	W,BRNGL		;SCAN RANGE LIST
	027373'	260040	021750'	GIT32:	PJS	TYPEOL		;START A NEW LINE
	027374'	201440	000070		MOVEI	X,70		;SET CHARS/LINE COUNT
	027375'	322400	027415'	GIT33:	JUMPE	W,GIT34		;CHECK IF ANYMORE RANGES REMAINING
	027376'	200210	000001		MOVE	V,1(W)		;GET START OF RANGE
	027377'	201500	000020		MOVEI	Y,20		;SET RADIX TO HEX
	027400'	260040	022015'		PJS	TN		;TYPE IT OUT
	027401'	274440	000466'		SUB	X,TYP6C		;DECREMENT CHARS/LINE
	027402'	051700	000055		OUTCHI	"-"		;TYPE RANGE SEPARATOR
	027403'	275440	000001		SUBI	X,1
	027404'	200210	000002		MOVE	V,2(W)		;GET END OF RANGE
	027405'	275200	000001		SUBI	V,1		;CHANGE LAD+1 TO LAD
	027406'	201500	000020		MOVEI	Y,20		;SET RADIX TO HEX
	027407'	260040	022015'		PJS	TN		;AND TYPE IT OUT
	027410'	274440	000466'		SUB	X,TYP6C
	027411'	200410	000000		MOVE	W,(W)		;ADDRESS NEXT RANGE
	027412'	363440	027373'		SOJLE	X,GIT32		;CHECK IF END OF LINE
	027413'	051700	000040		OUTCHI	" "		;SEPARATE RANGES
	027414'	254000	027375'		JRST	GIT33		;GO TYPE OUT NEXT RANGE
	027415'	302440	000070	GIT34:	CAIE	X,70		;HAS A RANGE BEEN TYPED ON THIS LINE?
	027416'	260040	021750'		PJS	TYPEOL		;YES. TYPE <CR><LF>
	027417'	200500	002741'	GIT4:	MOVE	Y,BRNGL		;GET BEGIN OF RANGE LIST
	027420'	322500	025722'		JUMPE	Y,CR		;Exit if no range list
	027421'	250500	006600'		EXCH	Y,FL		;RETURN TO FREE LIST
	027422'	202520	002742'		MOVEM	Y,@ERNGL	;HAVE RANGE LIST POINT TO FREE LIST
	027423'	254000	025722'		JRST	CR

				;	SCAN NIB INDEX BLOCKS. SKIP IF INDEX ENTRY, NOSKIP AT END.
	027424'	326600	027447'	IXSCAN:	JUMPN	M,IXSC5		;CHECK IF FIRST TIME CALLED
	027425'	201600	002332'		MOVEI	M,IBID
	027426'	135200	002734'		LDB	V,IBBADP	;GET ID BLOCK ADDRESS
	027427'	306200	000000		CAIN	V,0		;FIRST BLOCK?
	027430'	254000	027437'		JRST	IXSC2		;YES
	027431'	260040	021541'		PJS	UBID		;NO, OUTPUT ID RECORD
	027432'	400200	000000		SETZ	V,		;GET FIRST BLOCK
	027433'	074544	000001	IXSC1:	IBINP	IBID,V		;GET NEXT ID RECORD BLOCK
	027434'	066540	034731'
	027435'	201200	002530'		MOVEI	V,IBIDC-1
	027436'	202200	002745'		MOVEM	V,IBRIXP	;MARK AS FULL
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-8
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	027437'	201600	002344'	IXSC2:	MOVEI	M,IBRIX		;POINT TO FIRST RECORD INDEX
	027440'	332014	000000	IXSC3:	SKIPE	(M)		;END OF THIS ID RECORD?
	027441'	254000	027445'		JRST	IXSC4		;NO
	027442'	336200	002531'		SKIPN	V,IBIDC		;END OF ID CHAIN?
	027443'	263040	000000		RETURN			;YES, EXIT
	027444'	254000	027433'		JRST	IXSC1		;GET NEXT ID RECORD
	027445'	350001	000000	IXSC4:	AOS	(S)		;SET SKIP RETURN
	027446'	263040	000000		RETURN
	027447'	271600	000002	IXSC5:	ADDI	M,2		;GET NEXT ENTRY
	027450'	254000	027440'		JRST	IXSC3		;TRY NEXT RECORD INDEX

				;	MACSET%Z - Put MAC set number to NIB file
	027451'	476000	006525'	MSIB0:	SETOM	VTAB		; If no argument given, use MAC set -1
	027452'	332000	002747'	MSIB1:	SKIPE	BFSW		; NIB file opened?
	027453'	254000	030100'		JRST	PSIBE2		; No, error, go inform user
	027454'	402000	002532'		SETZM	MSHDR		; Clear first word of header entry
	027455'	201600	002532'		MOVEI	M,MSHDR		; Address new ID block entry
	027456'	201200	000004		MOVEI	V,MSTYP		; Get MAC set entry type
	027457'	137200	002733'		DPB	V,IBTYPP	; Store in type field in new ID block entry
	027460'	201200	000001		MOVEI	V,MSMSTY	; Get MAC set subtype
	027461'	137200	002735'		DPB	V,IBMSTP	; Store in subtype field in new ID block entry
	027462'	200200	006525'		MOVE	V,VTAB		; Get MAC set number specified by user
	027463'	202200	002533'		MOVEM	V,MSHDR+1	; Store in second word of new ID block entry
	027464'	260040	030102'		PJS	IRHDR		; Store new entry in current ID block
	027465'	254000	025722'		JRST	CR		; That's it. Return to user for more commands

				;	PAD,VAD,CNT;P - PUT LOCAL IMAGE TO NIB FILE.
	027466'	476000	002743'	PIB0:	SETOM	MIALL		;SET TO WRITE ALL SEGMENTS
	027467'	350200	002743'	PIB4:	AOS	V,MIALL		;GO TO NEXT SEGMENT
	027470'	301200	000020		CAIL	V,20		;ARE THERE ANYMORE SEGMENTS?
	027471'	254000	025722'		JRST	CR		;NO. EXIT
	027472'	200400	000004		MOVE	W,V		;GET SEGMENT NUMBER
	027473'	242400	000020		LSH	W,20		;CONVERT TO FAD
	027474'	311404	000531'		CAML	W,SEGTOP(V)	;IS SEGMENT EMPTY?
	027475'	254000	027467'		JRST	PIB4		;YES. TRY NEXT SEGMENT
	027476'	202400	006525'		MOVEM	W,VTAB		;SET PAD FOR SEGMENT
	027477'	202400	006527'		MOVEM	W,VTAB+2	;SET VAD FOR SEGMENT
	027500'	200204	000531'		MOVE	V,SEGTOP(V)	;GET LAD+1
	027501'	274200	000010		SUB	V,W		;COMPUTE BCNT
	027502'	202200	006531'		MOVEM	V,VTAB+4
	027503'	254000	027522'		JRST	PIB3		;GO WRITE IT OUT
	027504'	331000	002743'	PIB5:	SKIPL	MIALL		;PUTTING ALL SEGMENTS
	027505'	254000	027467'		JRST	PIB4		;YES. GO GET NEXT ONE
	027506'	254000	025722'		JRST	CR		;NO. EXIT
	027507'	200200	006525'	PIB1:	MOVE	V,VTAB		;1 ARGUMENT
	027510'	202200	006527'		MOVEM	V,VTAB+2	;SET COUNT IN ARG 2
	027511'	402000	006525'		SETZM	VTAB		;SET PHYSICAL ADDRESS = 0
	027512'	476000	002743'	PIB2:	SETOM	MIALL		;SET TO PUT SELECTIVE MEMORY
	027513'	200200	006440'		MOVE	V,ARGC
	027514'	303200	000002		CAILE	V,2		;2 ARGS OR LESS?
	027515'	254000	027522'		JRST	PIB3		;3 ARGS
	027516'	200200	006527'		MOVE	V,VTAB+2	;2 ARGUMENTS
	027517'	202200	006531'		MOVEM	V,VTAB+4	;MOVE BCNT
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-9
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	027520'	200200	006525'		MOVE	V,VTAB
	027521'	202200	006527'		MOVEM	V,VTAB+2	;COPY PAD TO VAD
	027522'	332000	002747'	PIB3:	SKIPE	BFSW		;IS THERE A FILE DEFINED?
	027523'	254000	030100'		JRST	PSIBE2		;NOPE
	027524'	200200	006531'	PI0:	MOVE	V,VTAB+4
	027525'	307200	077776		CAIG	V,MIBMAX	;IS COUNT MORE THAN MAXIMUM ALLOWED?
	027526'	254000	027534'		JRST	PI1		;NO
	027527'	275200	077776		SUBI	V,MIBMAX
	027530'	202200	002746'		MOVEM	V,SCNT		;SAVE REMAINING COUNT
	027531'	201200	077776		MOVEI	V,MIBMAX
	027532'	202200	006531'		MOVEM	V,VTAB+4	;RESET COUNT
	027533'	334000	000000		SKIPA
	027534'	402000	002746'	PI1:	SETZM	SCNT		;SET REMAINDER TO 0
	027535'	402000	002532'		SETZM	MIHDR
	027536'	402000	002533'		SETZM	MIHDR+1
	027537'	201200	000002		MOVEI	V,MITYP
	027540'	201600	002532'		MOVEI	M,MIHDR
	027541'	137200	002733'		DPB	V,IBTYPP	;SET MEMORY IMAGE RECORD TYPE
	027542'	200200	006525'		MOVE	V,VTAB
	027543'	137200	002735'		DPB	V,IBPADP	;SET PHYSICAL ADDRESSS
	027544'	200200	006527'		MOVE	V,VTAB+2
	027545'	137200	002740'		DPB	V,IBVADP	;SET VIRTUAL ADDRESS
	027546'	200200	006531'		MOVE	V,VTAB+4
	027547'	137200	002736'		DPB	V,IBCNTP	;SET BYTE COUNT
	027550'	260040	030102'		PJS	IRHDR		;INITIALIZE RECORD HEADERS
	027551'	200200	034733'		MOVE	V,[POINT 9,MIDATA]
	027552'	202200	002744'		MOVEM	V,MIDAP		;POINT TO START OF DATA AREA
	027553'	200200	006531'		MOVE	V,VTAB+4	;GET COUNT
	027554'	272200	006525'		ADDM	V,VTAB		;UPDATE PAD FOR NEXT TIME
	027555'	200500	006527'		MOVE	Y,VTAB+2	;GET VIRTUAL ADDRESS
	027556'	272500	006531'		ADDM	Y,VTAB+4	;CHANGE COUNT TO LAST ADDRESS + 1 (LAD+1)
	027557'	315500	006531'	PI5:	CAMGE	Y,VTAB+4	;PASSED LAD?
	027560'	254000	027574'		JRST	PI6		;NO
	027561'	200200	002750'		IBOUT	MIHDR,V,BAD	;PUT NEXT DATA BLOCK
	027562'	075544	000001
	027563'	067540	034734'
	027564'	350000	002750'		AOS	BAD		;UPDATE BLOCK ADDRESS
	027565'	336000	002746'		SKIPN	SCNT		;IS SAVED COUNT = 0?
	027566'	254000	027504'		JRST	PIB5		;GO CHECK IF MORE SEGMENTS TO WRITE
	027567'	200200	006531'		MOVE	V,VTAB+4	;NO, PREPARE FOR MOVE
	027570'	202200	006527'		MOVEM	V,VTAB+2	;POINT VAD PAST CURRENT AREA
	027571'	200200	002746'		MOVE	V,SCNT
	027572'	202200	006531'		MOVEM	V,VTAB+4	;UPDATE COUNT
	027573'	254000	027524'		JRST	PI0		;STARTUP AGAIN

	027574'	200540	002744'	PI6:	MOVE	L,MIDAP
	027575'	312540	002732'		CAME	L,MIEND		;PAST END OF BLOCK?
	027576'	254000	027605'		JRST	PI7		;NO
	027577'	200200	002750'		IBOUT	MIHDR,V,BAD	;PUT LAST DATA BLOCK
	027600'	075544	000001
	027601'	067540	034736'
	027602'	350000	002750'		AOS	BAD		;COUNT THE BLOCK
	027603'	200540	034740'		MOVE	L,[POINT 9,MIHDR]
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-10
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	027604'	202540	002744'		MOVEM	L,MIDAP		;POINT TO START OF BLOCK
	027605'	200400	000012	PI7:	MOVE	W,Y		;NEXT ADDRESS
	027606'	260040	025610'		CA			;GET BYTE POINTER
	027607'	135200	000010		LDB	V,W		;GET BYTE 1
	027610'	200400	000012		MOVE	W,Y
	027611'	271400	000001		ADDI	W,1
	027612'	260040	025610'		CA
	027613'	135240	000010		LDB	U,W		;BYTE 2
	027614'	400600	000000		SETZ	M,		;INIT REPEAT COUNT
	027615'	271500	000002	PI8:	ADDI	Y,2		;INCREMENT VAD
	027616'	311500	006531'		CAML	Y,VTAB+4	;LAD REACHED?
	027617'	254000	027633'		JRST	PI9		;YES
	027620'	200400	000012		MOVE	W,Y
	027621'	260040	025610'		CA
	027622'	135300	000010		LDB	VS,W		;BYTE 3
	027623'	200400	000012		MOVE	W,Y
	027624'	271400	000001		ADDI	W,1
	027625'	260040	025610'		CA
	027626'	135340	000010		LDB	OS,W		;BYTE 4
	027627'	312300	000004		CAME	VS,V		;BYTE 3 = BYTE 1?
	027630'	254000	027633'		JRST	PI9		;NO
	027631'	316340	000005		CAMN	OS,U		;BYTE 4 = BYTE 2?
	027632'	344600	027615'		AOJA	M,PI8		;(3,4) = (1,2), UPDATE REPEAT COUNT

	027633'	302600	000000	PI9:	CAIE	M,0		;THIS IS NOT A REPEAT, WHERE THERE ANY?
	027634'	254000	027643'		JRST	PI10		;YES, OUTPUT COMPRESSION WORD
	027635'	136200	002744'		IDPB	V,MIDAP		;DEPOSIT BYTE 1
	027636'	136240	002744'		IDPB	U,MIDAP		;		2
	027637'	136300	002744'		IDPB	VS,MIDAP	;		3
	027640'	136340	002744'		IDPB	OS,MIDAP	;		4
	027641'	271500	000002		ADDI	Y,2		;INCREMENT VAD
	027642'	254000	027557'		JRST	PI5		;GO FOR MORE

	027643'	317500	006531'	PI10:	CAMG	Y,VTAB+4	;HAVE WE OVERRUN LAD?
	027644'	254000	027647'		JRST	PI11		;NO
	027645'	275600	000001		SUBI	M,1		;FIX REPEAT COUNT
	027646'	275500	000002		SUBI	Y,2		;LOOK AT THESE BYTES AGAIN LATER
	027647'	435200	000400	PI11:	IORI	V,400		;COMPRESSION FLAG
	027650'	136200	002744'		IDPB	V,MIDAP		;DEPOSIT BYTE	1
	027651'	136240	002744'		IDPB	U,MIDAP		;		2
	027652'	200540	000014		MOVE	L,M
	027653'	303600	777777		CAILE	M,777777	;IS IT > 18 BITS?
	027654'	201600	777777		MOVEI	M,777777	;YES
	027655'	241600	777767		ROT	M,-11		;LEFT HALF OF REPEAT COUNT
	027656'	136600	002744'		IDPB	M,MIDAP		;DEPOSIT LEFT HALF
	027657'	241600	000011		ROT	M,11
	027660'	136600	002744'		IDPB	M,MIDAP		;DEPOSIT RIGHT HALF OF REPEAT COUNT
	027661'	275540	777777		SUBI	L,777777
	027662'	323540	027557'		JUMPLE	L,PI5		;IF DONE WITH REPEAT
	027663'	200600	000013		MOVE	M,L		;NEW REPEAT COUNT
	027664'	200540	002744'		MOVE	L,MIDAP
	027665'	312540	002732'		CAME	L,MIEND		;PAST END OF BLOCK?
	027666'	254000	027647'		JRST	PI11		;NO, OUTPUT MORE REPEATS
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-11
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	027667'	200540	002750'		IBOUT	MIHDR,L,BAD	;PUT NEXT DATA BLOCK
	027670'	075553	000001
	027671'	067540	034741'
	027672'	350000	002750'		AOS	BAD		;COUNT THE BLOCK
	027673'	200540	034740'		MOVE	L,[POINT 9,MIHDR]
	027674'	202540	002744'		MOVEM	L,MIDAP		;POINT TO START OF BLOCK
	027675'	254000	027647'		JRST	PI11		;OUTPUT MORE REPEATS

				;	PAD;T - OUTPUT IMAGE BINARY TRANSFER ADDRESS.
	027676'	335000	002747'	TIB:	SKIPGE	BFSW		;IS THERE A CURRENT FILE?
	027677'	254000	030100'		JRST	PSIBE2		;NO
	027700'	201600	002332'		MOVEI	M,IBID
	027701'	135200	002734'		LDB	V,IBBADP	;GET ID BLOCK ADDRESS
	027702'	306200	000000		CAIN	V,0		;FIRST BLOCK?
	027703'	254000	027711'		JRST	TI1		;YES
	027704'	260040	021541'		PJS	UBID		;NO, OUTPUT ID RECORD
	027705'	074540	000001		USETI	BCH,1		;POSITION FILE TO FIRST BLOCK
	027706'	066540	034743'		IBINP	IBID
	027707'	201200	002530'		MOVEI	V,IBIDC-1
	027710'	202200	002745'		MOVEM	V,IBRIXP	;MARK AS FULL
	027711'	200200	006525'	TI1:	MOVE	V,VTAB
	027712'	202200	002333'		MOVEM	V,IBPSA
	027713'	254000	025722'		JRST	CR

				;	MODULE%P - OUTPUT SYMBOL TABLE TO IMAGE BINARY FILE
	027714'	200100	034603'	PSIB1:	MOVE	I,[POINT 7,CS]	;SCAN FOR MODULE NAME
	027715'	260040	030353'		PJS	SYMSIX		;CONVERT TO SIXBIT AND PUT IN "L"
	027716'	322540	030076'		JUMPE	L,PSIBE1	;CHECK IF NAME FOUND
	027717'	211400	000044		MOVNI	W,44		;SCAN MODULE TABLE FOR NAME
	027720'	312550	000623'		CAME	L,MOA+44(W)	;IS IT IN TABLE
	027721'	341400	027720'		AOJL	W,.-1		;NO. TRY ANOTHER
	027722'	322400	030076'		JUMPE	W,PSIBE1	;CHECK IF NOT IN TABLE
	027723'	200410	032676'		MOVE	W,LBIT+44(W)	;GET MODULE BIT
	027724'	254000	027727'		JRST	PSI0
	027725'	201540	000200	PSIB0:	MOVEI	L,NIBSW		;NUMBER OF STATE TABLE WORDS
	027726'	525400	377777		HRLOI	W,377777	;PUT ALL SYMBOLS BUT OPCODES
	027727'	202400	006326'	PSI0:	MOVEM	W,MM1		;SAVE MODULE MASK
	027730'	332000	002747'		SKIPE	BFSW		;IS THERE A FILE?
	027731'	254000	030100'		JRST	PSIBE2		;NO. EXIT
	027732'	402000	002746'		SETZM	SCNT		;ZERO COUNT OF SYMBOLS WRITTEN
	027733'	402000	002532'		SETZM	SYHDR		;CLEAR HEADER OF NEW RECORD
	027734'	202540	002533'		MOVEM	L,SYHDR+1	;PUT MODULE NAME IN HEADER
	027735'	201200	000003		MOVEI	V,SYTYP		;GET SYMBOL TABLE RECORD TYPE
	027736'	201600	002532'		MOVEI	M,SYHDR		;ADDRESS NEW RECORD HEADER
	027737'	137200	002733'		DPB	V,IBTYPP	;INSERT TYPE IN HEADER
	027740'	260040	030102'		PJS	IRHDR		;INITIALIZE INDEX AND RECORD HEADER
	027741'	200400	002750'		MOVE	W,BAD		;SAVE BLOCK ADDRESS OF FIRST BLOCK OF NEW RECORD
	027742'	202400	002751'		MOVEM	W,B1BAD		; TO STORE SYMBOL COUNT AFTER RECORD WRITTEN
	027743'	201540	002534'		MOVEI	L,SYDATA	;START STORING DATA AFTER HEADER
	027744'	200400	002533'		MOVE	W,SYHDR+1	;GET MODULE NAME FROM HEADER
	027745'	603400	777777		TLNE	W,777777	;IS IT NUMBER OF STATE TABLE WORDS
	027746'	254000	027777'		JRST	PSI13		;NO
	027747'	201400	002756'		OIBSW	IBSVER,1	;OUTPUT STATE TABLE WORDS. VERSION
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-12
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	027750'	201200	000001
	027751'	260040	030051'
	027752'	201400	000470'		OIBSW	CURSEG,1	;CURRENT SEGMENT
	027753'	201200	000001
	027754'	260040	030051'
	027755'	201400	000511'		OIBSW	SEGTAB,20	;SEGMENT TABLE
	027756'	201200	000020
	027757'	260040	030051'
	027760'	201400	006330'		OIBSW	MODULE,1	;CURRENT MODULE
	027761'	201200	000001
	027762'	260040	030051'
	027763'	201400	006325'		OIBSW	MM,1		;CURRENT MODULE MASK
	027764'	201200	000001
	027765'	260040	030051'
	027766'	201400	000557'		OIBSW	MOA,44		;MODULE NAME TABLE
	027767'	201200	000044
	027770'	260040	030051'
	027771'	201400	000623'		OIBSW	MOORG,44	;MODULE ORIGIN TABLE
	027772'	201200	000044
	027773'	260040	030051'
	027774'	201400	000667'		OIBSW	MOUSE,44	;MODULE FX2 TABLE
	027775'	201200	000044
	027776'	260040	030051'
	027777'	200300	034745'	PSI13:	MOVE	VS,[YHASHT-EYH,,0] ;SCAN SYMBOL TABLE FROM YHAST TO EYH
	030000'	200406	006610'	PSI1:	MOVE	W,YHASHT(VS)	;GET NEXT SYMBOL TABLE CHAIN
	030001'	322400	030021'		JUMPE	W,PSI4		;IF EMPTY(=0), GO GET NEXT ONE
	030002'	200610	000000	PSI2:	MOVE	M,(W)		;GET FIRST WORD OF SYMBOL TABLE ENTRY
	030003'	135440	034312'		LDB	X,[POINT 6,M,17] ;GET MODULE NUMBER
	030004'	200451	032632'		MOVE	X,LBIT(X)	;CONVERT TO MODULE BIT
	030005'	616440	006326'		TDNN	X,MM1		;IS IT IN MODULE(S) TO BE WRITTEN?
	030006'	254000	030017'		JRST	PSI3		;YES. DON'T PUT OUT TO FILE
	030007'	201200	000003		MOVEI	V,3		;SET SIZE OF ENTRY TO WRITE
	030010'	260040	030051'		PJS	OSYIB		;OUTPUT SYMBOL TABLE ENTRY TO FILE
	030011'	607440	100000		TLNN	X,100000	;IS IT A MACRO(MODULE=2)?
	030012'	254000	030017'		JRST	PSI3		;NO
	030013'	135200	034746'		LDB	V,[POINT 9,2(W),26] ;YES. GET SIZE OF MACRO TEXT
	030014'	221200	000003		IMULI	V,3		;Convert from blocks to words
	030015'	554410	000002		HLRZ	W,2(W)		;GET ADDRESS OF MACRO TEXT
	030016'	260040	030051'		PJS	OSYIB		;OUTPUT TEXT TO FILE
	030017'	550400	000014	PSI3:	HRRZ	W,M		;GET ADDRESS OF NEXT SYMBOL TABLE ENTRY
	030020'	326400	030002'		JUMPN	W,PSI2		;GO PROCESS IF NONZERO
	030021'	253300	030000'	PSI4:	AOBJN	VS,PSI1	;GO TO NEXT WORD IN SYMBOL TABLE
	030022'	200440	002750'		MOVE	X,BAD		;NO MORE ENTRIES. GET BLOCK ADDRESS OF LAST BLOCK
	030023'	316440	002751'		CAMN	X,B1BAD		;IS LAST EQUAL TO FIRST?
	030024'	254000	030035'		JRST	PSI11		;YES. GO SET SYMBOL TABLE COUNT
	030025'	306540	002532'		CAIN	L,SYHDR		;IS LAST BLOCK EMPTY?
	030026'	254000	030032'		JRST	PSI10		;YES. DON'T WRITE IT OUT.
	030027'	075551	000001		IBOUT	SYHDR,X		;OUTPUT LAST BLOCK
	030030'	067540	034747'
	030031'	350000	002750'		AOS	BAD		;UPDATE LAST BLOCK ADDRESS
	030032'	200440	002751'	PSI10:	IBINP	SYHDR,X,B1BAD	;GET FIRST BLOCK OF RECORD
	030033'	074551	000001
	030034'	066540	034751'
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-13
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	030035'	200200	002746'	PSI11:	MOVE	V,SCNT		;GET NUMBER OF DATA WORDS WRITTEN
	030036'	201600	002532'		MOVEI	M,SYHDR		;ADDRESS DATA BLOCK
	030037'	137200	002735'		DPB	V,IBSYCP	;STORE COUNT IN HEADER
	030040'	200440	002751'		IBOUT	SYHDR,X,B1BAD	;WRITE OUT FIRST BLOCK
	030041'	075551	000001
	030042'	067540	034753'
	030043'	311440	002750'		CAML	X,BAD		;IS THIS FIRST TIME BLOCK WRITTEN
	030044'	350000	002750'		AOS	BAD		;YES. UPDATE LAST BLOCK ADDRESS
	030045'	120200	002532'		DMOVE	V,SYHDR		;GET HEADER JUST WRITTEN
	030046'	200400	002745'		MOVE	W,IBRIXP	;ADDRESS INDEX IN ID RECORD
	030047'	124210	777776		DMOVEM	V,-2(W)		;RESTORE HEADER FOR RECORD
	030050'	254000	025722'		JRST	CR

	030051'	272200	002746'	OSYIB:	ADDM	V,SCNT		;UPDATE COUNT OF DATA WORDS WRITTEN
	030052'	200340	000010		MOVE	OS,W		;SAVE ADDRESS OF WORDS MOVED
	030053'	201140	002732'	OSYIB1:	MOVEI	C,SYEND		;COMPUTE NUMBER OF WORDS LEFT IN BLOCK
	030054'	274140	000013		SUB	C,L
	030055'	311140	000004		CAML	C,V		;IS THERE ROOM IN BLOCK FOR NEW DATA?
	030056'	200140	000004		MOVE	C,V		;YES
	030057'	274200	000003		SUB	V,C		;REDUCE NO OF WORDS TO WRITE
	030060'	504240	000007		HRL	U,OS		;PUT FROM ADDRESS IN BLT POINTER
	030061'	540240	000013		HRR	U,L		;PUT IN TO ADDRESS
	030062'	270340	000003		ADD	OS,C		;UPDATE FROM ADDRESS BY WORDS WRITTEN
	030063'	273540	000003		ADDB	L,C		;UPDATE TO ADDRESS ALSO
	030064'	251243	777777		BLT	U,-1(C)		;MOVE WORDS TO RECORD
	030065'	305540	002732'		CAIGE	L,SYEND		;IS THIS BLOCK FULL
	030066'	254000	030074'		JRST	OSYIB4		;NO
	030067'	200540	002750'		IBOUT	SYHDR,L,BAD	;YES.WRITE IT OUT
	030070'	075553	000001
	030071'	067540	034755'
	030072'	350000	002750'		AOS	BAD		;UPDATE LAST BLOCK WRITTEN ADDRESS
	030073'	201540	002532'		MOVEI	L,SYHDR		;SET TO ADDRESS
	030074'	327200	030053'	OSYIB4:	JUMPG	V,OSYIB1	;ANYMORE WORDS TO WRITE
	030075'	263040	000000		RETURN			;NO. EXIT

	030076'	035000	034757'	PSIBE1:	TYPE	<   Nonexistent module name>
	030077'	254000	026124'		JRST	DQUES3
	030100'	035000	034765'	PSIBE2:	TYPE	<   Image binary file not open>
	030101'	254000	026124'		JRST	DQUES3

	030102'	200400	002745'	IRHDR:	MOVE	W,IBRIXP
	030103'	305400	002530'		CAIGE	W,IBIDC-1	;INDEX FULL?
	030104'	254000	030123'		JRST	IRH3		;NO
	030105'	260040	021541'		PJS	UBID		;OUTPUT THIS ONE
	030106'	200200	002531'	IRH1:	MOVE	V,IBIDC		;GET CHAIN TO NEXT ID BLOCK
	030107'	306200	000000		CAIN	V,0		;END OF CHAIN?
	030110'	254000	030114'		JRST	IRH2		;YES
	030111'	074544	000001		IBINP	IBID,V		;GET NEW BLOCK OF ID RECORD
	030112'	066540	034773'
	030113'	254000	030106'		JRST	IRH1

	030114'	200200	000753'	IRH2:	MOVE	V,BL+11		;GET FILE BLOCK COUNT
	030115'	315200	002750'		CAMGE	V,BAD		;HAVE WE INCREASED IT?
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-14
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	030116'	200200	002750'		MOVE	V,BAD		;YES
	030117'	202200	002750'		MOVEM	V,BAD		;UPDATE BAD FOR NEW ID BLOCK
	030120'	202200	002531'		MOVEM	V,IBIDC		;UPDATE CHAIN
	030121'	260040	021541'		PJS	UBID		;REPLACE THIS ID RECORD
	030122'	260040	021503'		PJS	IIDB		;INITIALIZE NEW ID BLOCK
	030123'	201600	002532'	IRH3:	MOVEI	M,NRHDR
	030124'	200200	002750'		MOVE	V,BAD
	030125'	137200	002734'		DPB	V,IBBADP	;UPATE BLOCK ADDRESS
	030126'	120200	002532'		DMOVE	V,NRHDR
	030127'	200400	002745'		MOVE	W,IBRIXP
	030130'	124210	000000		DMOVEM	V,(W)		;COPY HEADER TO INDEX
	030131'	271400	000002		ADDI	W,2
	030132'	202400	002745'		MOVEM	W,IBRIXP		;POINT TO NEXT ENTRY
	030133'	263040	000000		RETURN

				;	MODULE%G - INPUT SYMBOL TABLE FROM IMAGE BINARY FILE
	030134'	200100	034603'	GSIB1:	MOVE	I,[POINT 7,CS]	;SCAN FOR MODULE NAME
	030135'	260040	030353'		PJS	SYMSIX		;CONVERT TO SIXBIT AND PUT IN "L"
	030136'	322540	030076'		JUMPE	L,PSIBE1	;CHECK IF NAME FOUND
	030137'	334000	000000		SKIPA
	030140'	201540	000200	GSIB0:	MOVEI	L,NIBSW		;GET ALL MODULES AND STATE INFO
	030141'	335000	002747'		SKIPGE	BFSW		;IS THERE A FILE?
	030142'	254000	030100'		JRST	PSIBE2		;NO.
	030143'	400440	000000		SETZ	X,		;SET RECORD NOT FOUND SWITCH
	030144'	400600	000000		SETZ	M,		;SET FIRST TIME THRU "IXSCAN"
	030145'	260040	027424'	GSI0:	PJS	IXSCAN		;GET NEXT INDEX ENTRY
	030146'	254000	030155'		JRST	GSI20		;DONE SCANNING INDEX
	030147'	135200	002733'		LDB	V,IBTYPP	;GET RECORD TYPE
	030150'	302200	000003		CAIE	V,SYTYP		;IS IT A SYMBOL TABLE RECORD
	030151'	254000	030145'		JRST	GSI0		;NO, TRY ANOTHER.
	030152'	316554	000001		CAMN	L,1(M)		;IS IT THE CORRECT MODULE?
	030153'	135440	002734'		LDB	X,IBBADP	;YES.SAVE BLOCK NUMBER
	030154'	254000	030145'		JRST	GSI0		;GO FIND LAST MATCH
	030155'	322440	030341'	GSI20:	JUMPE	X,GSIBE1	;RECORD NOT ON FILE
	030156'	202440	002750'		MOVEM	X,BAD		;SAVE BLOCK NUMBER
	030157'	074551	000001		IBINP	SYHDR,X		;READ FIRST BLOCK OF RECORD
	030160'	066540	034775'
	030161'	350000	002750'		AOS	BAD		;SET TO NEXT BLOCK OF RECORD
	030162'	201600	002532'		MOVEI	M,SYHDR		;ADDRESS RECORD HEADER
	030163'	135200	002735'		LDB	V,IBSYCP	;GET NUMBER OF WORDS OF SYMBOLS
	030164'	212200	002746'		MOVNM	V,SCNT		;SET COUNTER FOR READS
	030165'	201200	002534'		MOVEI	V,SYDATA	;ADDRESS FIRST WORD OF DATA
	030166'	202200	002744'		MOVEM	V,SYDAP		;SET FROM POINTER FOR "ISYIB"
	030167'	603540	777777		TLNE	L,777777	;IS THERE STATE INFO?
	030170'	254000	030235'		JRST	GSI1		;NO.
	030171'	201400	000006		IIBSW	VS,1		;READ STATE INFO VERSION
	030172'	201200	000001
	030173'	260040	030303'
	030174'	260040	025257'
	030175'	312300	002756'		CAME	VS,IBSVER	;IS IT CORRECT?
	030176'	254000	030277'		JRST	GSI2A		;NO
	030177'	201300	000003		MOVEI	VS,3		; Number of words/unit in macro size field
	030200'	202300	002757'	GSI21:	MOVEM	VS,IBMMUL	; Save for reading macro definitions
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-15
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	030201'	201400	000470'		IIBSW	CURSEG,1	;CURRENT SEGMENT
	030202'	201200	000001
	030203'	260040	030303'
	030204'	260040	025257'
	030205'	201400	000511'		IIBSW	SEGTAB,20	;SEGMENT TABLE
	030206'	201200	000020
	030207'	260040	030303'
	030210'	260040	025257'
	030211'	201400	006330'		IIBSW	MODULE,1	;CURRENT MODULE
	030212'	201200	000001
	030213'	260040	030303'
	030214'	260040	025257'
	030215'	201400	006325'		IIBSW	MM,1		;CURRENT MODULE MASK
	030216'	201200	000001
	030217'	260040	030303'
	030220'	260040	025257'
	030221'	201400	000557'		IIBSW	MOA,44		;MODULE NAME TABLE
	030222'	201200	000044
	030223'	260040	030303'
	030224'	260040	025257'
	030225'	201400	000623'		IIBSW	MOORG,44	;MODULE ORIGIN TABLE
	030226'	201200	000044
	030227'	260040	030303'
	030230'	260040	025257'
	030231'	201400	000667'		IIBSW	MOUSE,44	;MODULE FX2 TABLE
	030232'	201200	000044
	030233'	260040	030303'
	030234'	260040	025257'
	030235'	201400	002752'	GSI1:	MOVEI	W,SYBUFF	;FOR NEXT SYM TABLE ENTRY
	030236'	201200	000003		MOVEI	V,3		;GET THREE WORDS
	030237'	260040	030303'		PJS	ISYIB		;GO READ IN ENTRY
	030240'	254000	025722'		JRST	CR		;NO MORE ENTRIES. GO FINISH
	030241'	200450	000000		MOVE	X,(W)		;GET FIRST WORD OF ENTRY
	030242'	135440	034777'		LDB	X,[POINT 6,(W),17] ;GET MODULE NUMBER
	030243'	200451	032632'		MOVE	X,LBIT(X)	;GET MODULE MASK
	030244'	202440	006326'		MOVEM	X,MM1		;SAVE FOR SYMBOL DEFINING
	030245'	500250	000000		HLL	U,(W)		;GET MODULE NUMBER FOR DEFINING SYMBOL
	030246'	621240	637700		TLZ	U,777700-SYPRPM-SYPROP	;save module mask and proprietary
	030247'	602700	000020		TRNE	F2,TYMPRP	; Does user have Tymshare license?
	030250'	621240	140000		TLZ	U,SYPRPM+SYPROP	; Yes, clear proprietary bits
	030251'	200550	000001		MOVE	L,1(W)		;GET SYMBOL NAME
	030252'	200310	000002		MOVE	VS,2(W)		;GET SYMBOL VALUE
	030253'	335010	000000		SKIPGE	(W)		;IS SYMBOL UNDEFINED?
	030254'	400300	000000		SETZ	VS,		;YES. FORCE VALUE ZERO.
	030255'	603440	100000		TLNE	X,100000	;IS SYMBOL A MACRO
	030256'	254000	030261'		JRST	GSI2		;YES. GO GET TEXT AND DEFINE
	030257'	260040	020401'		PJS	DY		;DEFINE A NONMACRO DEFINED SYMBOL
	030260'	254000	030235'		JRST	GSI1		;GO GET NEXT SYMBOL FROM FILE

	030261'	135500	035000'	GSI2:	LDB	Y,[POINT 9,VS,26] ;GET NUMBER OF BLOCKS OF TEXT
	030262'	220500	002757'		IMUL	Y,IBMMUL	; Convert to number of words written
	030263'	504300	006605'		HRL	VS,YEND		;SET TEXT ADDRESS IN VALUE WORD
	030264'	273500	006605'		ADDB	Y,YEND		;ADJUST END OF MEMORY
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-16
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	030265'	607500	777777		TLNN	Y,777777	; Is request past end of memory?
	030266'	047500	000011		CORE	Y,		;GET MEMORY FOR MACRO TEXT
	030267'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	030270'	554400	000006		HLRZ	W,VS		;GET ADDRESS OF MACRO TEXT
	030271'	135200	035000'		LDB	V,[POINT 9,VS,26] ;GET NUMBER OF WORDS AGAIN.
	030272'	220200	002757'		IMUL	V,IBMMUL	; Convert to number of words written
	030273'	260040	030303'		PJS	ISYIB		;READ IN MACRO TEXT
					CPF			;REPORT ASSEMBLER INTERNAL ERROR			;IT BET
	030274'	260040	025257'	TER BE THERE!
	030275'	260040	020276'		PJS	DOM		;GO DEFINE MACRO
	030276'	254000	030235'		JRST	GSI1		;GO GET NEXT ENTRY

	030277'	312300	002755'	GSI2A:	CAME	VS,IBSOVR	; Is it old version which wrote 1/3 of macro
	030300'	254000	030343'		JRST	GSIBE2		; No, error
	030301'	201300	000001		MOVEI	VS,1		; Yes, set up macro size multiplier
	030302'	254000	030200'		JRST	GSI21

	030303'	272200	002746'	ISYIB:	ADDM	V,SCNT		;DECREMENT FILE WORD COUNT
	030304'	337000	002746'		SKIPG	SCNT		;ENOUGH WORDS IN FILE FOR REQUEST
	030305'	254000	030311'		JRST	ISYIB0		;YES
	030306'	312200	002746'		CAME	V,SCNT		;WAS "SCNT" ZERO WHEN CALLED
	030307'	260040	025257'		CPF			;NO. IT SHOULD HAVE BEEN
	030310'	263040	000000		RETURN			;YES. EXIT WITH NONSKIP FOR EOF
	030311'	350001	000000	ISYIB0:	AOS	(S)		;SET SKIP RETURN
	030312'	261040	000010		PUSH	S,W		;SAVE BUFFER ADDRESS
	030313'	200440	002744'		MOVE	X,SYDAP		;GET ADDRESS OF NEXT DATA WORD IN BUFFER
	030314'	305440	002732'	ISYIB1:	CAIGE	X,SYEND		;ANYMORE WORDS IN BUFFER?
	030315'	254000	030323'		JRST	ISYIB2		;YES
	030316'	200440	002750'		IBINP	SYHDR,X,BAD	;GET NEXT BLOCK FROM FILE
	030317'	074551	000001
	030320'	066540	035001'
	030321'	350000	002750'		AOS	BAD		;INCREMENT BLOCK NUMBER
	030322'	201440	002532'		MOVEI	X,SYHDR		;ADDRESS TOP OF BUFFER
	030323'	201140	002732'	ISYIB2:	MOVEI	C,SYEND		;ADDRESS END OF BUFFER
	030324'	274140	000011		SUB	C,X		;COMPUTE WORDS REMAINING IN BUFFER
	030325'	311140	000004		CAML	C,V		;ENOUGH FOR THIS REQUEST?
	030326'	200140	000004		MOVE	C,V		;YES. MOVE WHOLE REQUEST
	030327'	274200	000003		SUB	V,C		;DECR BY NUMBER TO BE MOVED
	030330'	504600	000011		HRL	M,X		;ADDRESS FROM BUFFER
	030331'	540600	000010		HRR	M,W		;ADDRESS TO BUFFER
	030332'	270440	000003		ADD	X,C		;INCREMENT FROM ADDRESS
	030333'	273400	000003		ADDB	W,C		;INCR TO ADDRESS AND ADDRESS END OF TO BUFFER
	030334'	251603	777777		BLT	M,-1(C)		;MOVE DATA
	030335'	327200	030314'		JUMPG	V,ISYIB1	;CHECK IF MORE DATA NEEDED
	030336'	202440	002744'		MOVEM	X,SYDAP		;SAVE FROM BUFFER POINTER
	030337'	262040	000010		POP	S,W		;RESTORE ADDRESS OF TO BUFFER
	030340'	263040	000000		RETURN

	030341'	035000	035003'	GSIBE1:	TYPE	<   Module not in file>
	030342'	254000	026124'		JRST	DQUES3
	030343'	035000	035010'	GSIBE2:	TYPE	<   Incorrect state info version>
	030344'	254000	026124'		JRST	DQUES3

NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-17
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

				;DELETE ONE SYMBOL
	030345'	200100	034603'	KILSYM:	MOVE	I,[POINT 7,CS]
	030346'	260040	030353'		PJS	SYMSIX
	030347'	200400	006325'		MOVE	W,MM
	030350'	202400	006326'		MOVEM	W,MM1
	030351'	260040	020147'		PJS	DELSYM
	030352'	254000	025722'		JRST	CR

				;	CONVERT ASCII SYMBOL POINTER TO BY "I" TO SIXBIT.
				;	RETURN SYMBOL IN "L".
	030353'	400540	000000	SYMSIX:	SETZ	L,		;CLEAR SYMBOL
	030354'	200400	034247'		MOVE	W,[POINT 6,L]
	030355'	134140	000002	SSIX1:	ILDB	C,I		;GET NEXT CHARCATER OF SYMBOL
	030356'	200203	032742'		MOVE	V,CT(C)		;GET CHARACTER TYPE
	030357'	256004	030364'		XCT	SIXTAB(V)	;CONVERT TO SIXBIT
	030360'	136140	000010		IDPB	C,W		;ADD TO SIXBIT SYMBOL
	030361'	603400	770000		TLNE	W,770000	;ANYMORE ROOM?
	030362'	254000	030355'		JRST	SSIX1		;YES. GET NEXT CHARACTER
	030363'	263040	000000		RETURN

	030364'			SIXTAB:	REPEAT	2,<RETURN>
	030364'	263040	000000
	030365'	263040	000000
	030366'	275140	000040		SUBI	C,40
	030367'	275140	000040		SUBI	C,40
	030370'	405140	000077		ANDI	C,77
	030371'	275140	000040		SUBI	C,40
	030372'	405140	000077		ANDI	C,77
	030373'	201140	000016		MOVEI	C,'.'
					REPEAT	7,<RETURN>
	030374'	263040	000000
	030375'	263040	000000
	030376'	263040	000000
	030377'	263040	000000
	030400'	263040	000000
	030401'	263040	000000
	030402'	263040	000000

				;	SET LINE AND PAGE SIZE FOR LISTER.
	030403'	201400	000170	SETLS0:	MOVEI	W,ICHPLN	;RESTORE INITIAL LINE SIZE
	030404'	202400	002760'		MOVEM	W,CHPLN
	030405'	201400	000070		MOVEI	W,ILNPPG	;RESTORE INITIAL PAGE SIZE
	030406'	202400	002761'		MOVEM	W,LNPPG
	030407'	254000	025722'		JRST	CR
	030410'	201400	000012	SETLS2:	MOVEI	W,^D10		;SET RADIX TO TEN
	030411'	202400	006333'		MOVEM	W,TRADIX
	030412'	332000	006437'		SKIPE	BC		;WAS A STATEMENT USED AS ARG
	030413'	254000	026123'		JRST	DQUES		;YES. ERROR
	030414'	260040	026541'		PJS	AA		;ASSEMBLE ARGS WITH RADIX OF 10
	030415'	332000	003167'		SKIPE	GSEC		;ANY ERRORS?
	030416'	254000	026123'		JRST	DQUES		;YES
	030417'	200400	006525'		MOVE	W,VTAB		;GET FIRST ARG
	030420'	200440	006440'		MOVE	X,ARGC		;GET WHETHER 1 OR 2 ARGS
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-18
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	030421'	302440	000002		CAIE	X,2
	030422'	254000	030430'		JRST	SETLS1		;1 ARG
	030423'	301400	000062		CAIL	W,CPLMIN	;CHECK LINE LENGTH FOR OUT OF BOUNDS
	030424'	303400	000221		CAILE	W,CPLMAX
	030425'	254000	030435'		JRST	SETLS4
	030426'	202400	002760'		MOVEM	W,CHPLN
	030427'	200400	006527'		MOVE	W,VTAB+2	;GET NEW PAGE SIZE
	030430'	301400	000004	SETLS1:	CAIL	W,LPPMIN	;CHECK PAGE LENGTH FOR OUT OF BOUNDS
	030431'	303400	777777		CAILE	W,LPPMAX
	030432'	254000	030437'		JRST	SETLS5
	030433'	202400	002761'		MOVEM	W,LNPPG
	030434'	254000	025722'		JRST	CR
	030435'	035000	035017'	SETLS4:	TYPE	<   Line length out of bounds>
	030436'	254000	026124'		JRST	DQUES3
	030437'	035000	035025'	SETLS5:	TYPE	<   Page length out of bounds>
	030440'	254000	026124'		JRST	DQUES3

				;	START CREF OR MULTILISTING.
	030441'	403540	006525'	BCREF0:	SETZB	L,VTAB		;TYPE=0,FILENAME=NULL
	030442'	403240	000011		SETZB	U,X		;no username or extension
	030443'	254000	030466'		JRST	BCREF
	030444'	402000	006525'	BCREF1:	SETZM	VTAB		;TYPE=0
	030445'	200100	034603'		MOVE	I,[POINT 7,CS]	;SCAN FOR FILE NAME
	030446'	254000	030453'		JRST	BCREF3
	030447'	370000	006441'	BCREF2:	SOS	ARGC1		;GET FIRST ARG AS TYPE
	030450'	260040	026541'		PJS	AA
	030451'	332000	003167'		SKIPE	GSEC		;ANY ERRORS?
	030452'	254000	026123'		JRST	DQUES		;YES
	030453'	134400	000002	BCREF3:	ILDB	W,I		;see if there is a file name
	030454'	302400	000073		CAIE	W,";"		;check for terminator
	030455'	254000	030461'		JRST	BCREF4		;not found
	030456'	400540	000000		SETZ	L,		;set no file name
	030457'	403240	000011		SETZB	U,X		;set no username or extension
	030460'	254000	030466'		JRST	BCREF
	030461'	270100	006336'	BCREF4:	ADD	I,BACKUP	;fix byte pointer to rescan first character
	030462'	200300	035033'		MOVE	VS,[ILDB W,I]	;get file name from CS via I
	030463'	201140	000073		MOVEI	C,";"		;terminate on a semicolon
	030464'	260040	021117'		PJS	GFNX		;get file name
	030465'	254000	026123'		JRST	DQUES		;not a well formed file name
	030466'	200400	006525'	BCREF:	MOVE	W,VTAB		;GET ARG
	030467'	301400	000000		CAIL	W,0		;MUST BE GREATER THAN OR EQUAL TO 0
	030470'	301400	000006		CAIL	W,6		;AND LESS THAN SIX
	030471'	254000	026123'		JRST	DQUES
	030472'	602700	000002		TRNE	F2,MLTLST	;HAS IT BEEN STARTED ALREADY?
	030473'	254000	026123'		JRST	DQUES		;YES.ERROR
	030474'	606400	000001		TRNN	W,1		;ARG=0,2 OR 4 FOR CREF
	030475'	660700	000004		TRO	F2,CRFLST
	030476'	606400	000006		TRNN	W,6		;ARG=0 OR 1 FOR PASS 1 LISTING
	030477'	660700	000010		TRO	F2,PS1LST
	030500'	602400	000004		TRNE	W,4		;ARG=4 OR 5 TO FORCE LISTINGS
	030501'	660700	000001		TRO	F2,FRCLST
	030502'	660700	000002		TRO	F2,MLTLST	;SET MULTILISTING.
	030503'	402000	002301'		SETZM	LOH		;SET LISTING FILE NOT OPEN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-19
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	030504'	124540	002275'		DMOVEM	L,LE		;SAVE FILE NAME and extension
	030505'	124440	002273'		DMOVEM	X,LEUSR		;save user name
	030506'	321240	025722'		JUMPL	U,CR		;extension specified. don't set one
	030507'	200600	034320'		MOVE	M,[SIXBIT /CRF/]
	030510'	606700	000004		TRNN	F2,CRFLST
	030511'	200600	034321'		MOVE	M,[SIXBIT /LST/]
	030512'	202600	002276'		MOVEM	M,LE+1		;set default extension
	030513'	254000	025722'		JRST	CR

				;	END CREF LISTING
	030514'	620700	000013	ECREF:	TRZ	F2,MLTLST+FRCLST+PS1LST
	030515'	260040	021327'		PJS	CLF		;CLOSE LISTING FILE.
	030516'	620700	000004		TRZ	F2,CRFLST
	030517'	402000	002275'		SETZM	LE		;CLEAR LIST FILE NAME
	030520'	254000	025722'		JRST	CR

				;
				;	Open command file for input.
				;	This is the ;X command. It takes one argument before the semicolon.
				;	It must either be zero or one. If no argument is given, zero is assumed.
				;	Zero means the command file input should be echoed.
				;	One means don't echo.
				;
	030521'	200400	002255'	SETCMD:	MOVE	W,CURCMD	;index of current command file
	030522'	301400	000004		CAIL	W,CMDLIM	;are all used up?
	030523'	254000	030571'		JRST	SCER1		;yes. error
	030524'	332400	006440'		SKIPE	W,ARGC		;are there no arguments?
	030525'	200400	006423'		MOVE	W,LVV		;no. get argument
	030526'	321400	030573'		JUMPL	W,SCER2		;cannot be less than zero
	030527'	303400	000001		CAILE	W,1		;nor greater than one
	030530'	254000	030573'		JRST	SCER2
	030531'	260040	021763'		PJS	BL3
	030532'	260040	021115'		PJS	GFN		;get file name
	030533'	254000	026123'		JRST	DQUES		;not a well formed file name
	030534'	124540	001006'		DMOVEM	L,CMDNAM	;save name and extension
	030535'	124440	001001'		DMOVEM	X,CMDUSR	;save user name
	030536'	403400	001010'		SETZB	W,CMDNAM+2
	030537'	332000	001001'		SKIPE	CMDUSR		;was a user name set
	030540'	551400	001001'		HRRZI	W,CMDUSR	;yes
	030541'	202400	001011'		MOVEM	W,CMDNAM+3	;refer to it in lookup block
	030542'	200440	002255'		MOVE	X,CURCMD	;get current command file index
	030543'	200511	002251'		MOVE	Y,CMDBFA+1(X)	;get address of next buffer
	030544'	202500	001005'		MOVEM	Y,CMDBLK+2	;store for init
	030545'	271500	000003		ADDI	Y,3		;address data buffer
	030546'	202500	021211*		MOVEM	Y,.JBFF		;store for buffer allocation
	030547'	201411	000021		MOVEI	W,CMDCHN+1(X)	;get next channel to use
	030550'	505400	000013		HRLI	W,.CHOPN	;set to do init on channel
	030551'	043400	001003'		CHANIO	W,CMDBLK
	030552'	254000	026123'		JRST	DQUES		;cannot init
	030553'	505400	000022		HRLI	W,.CHIBF	;set up to allocate buffers
	030554'	043400	000001		CHANIO	W,CMDNBF
	030555'	505400	000004		HRLI	W,.CHLK		;set up for lookup
	030556'	043400	001006'		CHANIO	W,CMDNAM
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-20
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	030557'	254000	026123'		JRST	DQUES		;cannot find file
	030560'	210400	006423'		MOVN	W,LVV		;get argument and convert to internal
	030561'	337000	006440'		SKIPG	ARGC		;was an argument specified?
	030562'	200411	002257'		MOVE	W,CMDECO(X)	;no. Use previous files echo flag
	030563'	202411	002260'		MOVEM	W,CMDECO+1(X)	;store as -1 or 0
	030564'	200400	034364'		MOVE	W,[PJS CFINP]	;set up as file input first
	030565'	202411	002266'		MOVEM	W,CMDSRC+1(X)
	030566'	202400	002272'		MOVEM	W,GCHI		;set character source instruction
	030567'	350000	002255'		AOS	CURCMD		;make new command file the current one
	030570'	254000	025722'		JRST	CR

	030571'	035000	035034'	SCER1:	TYPE	< Maximum number of command files open>
	030572'	254000	026124'		JRST	DQUES3
	030573'	035000	035044'	SCER2:	TYPE	< Argument must be 0 or 1>
	030574'	254000	026124'		JRST	DQUES3

				;
				;	Close one or more command files. If the argument is zero or not given
				;	close all the command files. Otherwise close the number specified.
				;
	030575'	332440	006440'	RSTCMD:	SKIPE	X,ARGC		;argument specified?
	030576'	200440	006423'		MOVE	X,LVV		;yes. get it
	030577'	321440	026123'		JUMPL	X,DQUES		;must be positive
	030600'	322440	030604'		JUMPE	X,RCMD1		;if zero, go close all files
	030601'	260040	022145'		PJS	CFCLS		;close most recently open file
	030602'	367440	030601'		SOJG	X,.-1		;close another if needed
	030603'	254000	025722'		JRST	CR
	030604'	260040	022147'	RCMD1:	PJS	CFACLS		;close all command files
	030605'	254000	025722'		JRST	CR
				;
				;	Print version, date, time and system information
				;
	030606'	260040	022747'	PRTVER:	PJS	TTLDAT		;get date and time into title
	030607'	051140	002766'		OUTSTR	STDTTL		;and print it
	030610'	051140	035051'		OUTSTR	[ASCIZ "  Sysno "]
	030611'	201440	000006		MOVEI	X,6		;get first 7 words of configuration info
	030612'	514500	000011	PVER1:	HRLZ	Y,X		;index of word to get
	030613'	541500	000011		HRRI	Y,.GTCNF	;configuration table
	030614'	047500	000041		GETTAB	Y,		;get word into Y
	030615'	254000	026123'		JRST	DQUES
	030616'	202511	003146'		MOVEM	Y,SYSNO(X)	;save it
	030617'	365440	030612'		SOJGE	X,PVER1		;get another
	030620'	051140	003146'		OUTSTR	SYSNO
	030621'	051700	000040		OUTCHI	" "
	030622'	051140	003153'		OUTSTR	SYSNO+5		;print system date
	030623'	254000	025722'		JRST	CR

	030624'	200200	006423'	SETFCS:	MOVE	V,LVV
	030625'	202200	006575'		MOVEM	V,FCSMIN
	030626'	254000	025722'		JRST	CR

				SETRLY:				;SET RELAY SWITCH FOR ENGINE CIRCUITS. SEE TEST IN RIP SUBROUTI
				NE.
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-21
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	030627'	200200	006423'		MOVE	V,LVV
	030630'	202200	006574'		MOVEM	V,ASCHEX
	030631'	254000	025722'		JRST	CR		;0 FOR NORMAL SETTING

	030632'			SCPC:				; ; : OR % COMMAND
	030632'	270100	006336'		ADD	I,BACKUP	;DECREMENT BYTE POINTER BY ONE CHARACTER
	030633'	661640	200000		TLO	F,DCCF		;FLAG ; : OR % SEEN
	030634'	256000	002272'		XCT	GCHI		;GET INPUT CHAR
	030635'	301400	000141		CAIL	W,"a"
	030636'	303400	000172		CAILE	W,"z"
	030637'	334000	000000		SKIPA
	030640'	275400	000040		SUBI	W,40
	030641'	201240	033245'		MOVEI	U,CT1
	030642'	332000	000006		SKIPE	VS
					PJS	[
					MOVEI	U,CT2
					CAIE	VS,1
					MOVEI	U,CT3
					RETURN
	030643'	260040	035053'		]
	030644'	260040	026131'		PJS	CMLOOK	;DO A DISPATCH FROM ALTERNATE COMMAND TABLE
	030645'	322200	026121'		JUMPE	V,DQUES1	;USER ERROR
	030646'	254000	025756'		JRST	CR4

	030647'			PCPO:				;PERCENT C OR PERCENT O COMMANDS.
	030647'	335000	006410'		AUXCHK
	030650'	254000	032337'
	030651'	504400	006410'		HRL	W,CN
	030652'	541400	000004		HRRI	W,4
	030653'	042406	000010		AUXCAL	W,10(VS)	;SEND CONTROL C OR O
	030654'	541400	000006		HRRI	W,6
	030655'	042400	000000		AUXCAL	W,		;CLEAR AUXILIARY INPUT
	030656'	561400	000007		HRROI	W,7
	030657'	042400	000000		AUXCAL	W,		;STOP COMMAND CIRCUIT OUTPUT FLOOD
	030660'	254000	025722'		JRST	CR

	030661'			PBS:				;PERCENT BACKSLASH COMMAND
	030661'	335000	006410'		AUXCHK
	030662'	254000	032337'
	030663'	504400	006410'		HRL	W,CN
	030664'	541400	000004		HRRI	W,4
	030665'	042400	000134		AUXCAL	W,"\"
	030666'	254000	025722'		JRST	CR

				;	COMMAND FILE COMMENTS. CAN ALSO COME FROM TERMINAL.
				;	IGNORES ALL CHARACTERS TO CARRIAGE RETURN AND THEN TREATS
				;	COMMAND AS THOUGH ONLY A CARRIAGE RETURN WAS TYPED.

	030667'	256000	002272'	CCOMNT:	XCT	GCHI		;GET NEXT COMMAND CHARACTER
	030670'	302400	000015		CAIE	W,15		;IS IT A CARRIAGE RETURN
	030671'	254000	030667'		JRST	CCOMNT		;NO. IGNORE
	030672'	200400	006440'		MOVE	W,ARGC		;GET NUMBER OF ARG
	030673'	322400	030677'		JUMPE	W,CRET0		;GO TO PROPER CARRIAGE RETURN COMMAND
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-22
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	030674'	305400	000002		CAIGE	W,2
	030675'	254000	030706'		JRST	CRET1
	030676'	254000	030717'		JRST	CRETP

	030677'	120400	006445'	CRET0:	DMOVE	W,DTOM
	030700'	124400	006443'		DMOVEM	W,TOM
	030701'	120400	006451'		DMOVE	W,DWCLM
	030702'	124400	006447'		DMOVEM	W,WCLM
	030703'	200400	006334'		MOVE	W,RADIX
	030704'	202400	006333'		MOVEM	W,TRADIX
	030705'	254000	025723'		JRST	CR1
	030706'	332000	003167'	CRET1:	SKIPE	GSEC
	030707'	254000	026123'		JRST	DQUES

	030710'	260060	006573'		PJS	@ICJMP
	030711'	336000	006454'		SKIPN	OPEN
	030712'	254000	030677'		JRST	CRET0
	030713'	120200	006525'		DMOVE	V,VTAB
	030714'	200500	000551'		MOVE	Y,PC
	030715'	260040	026475'		PJS	VM
	030716'	254000	030677'		JRST	CRET0
	030717'	260060	006573'	CRETP:	PJS	@ICJMP
	030720'	254000	025723'		JRST	CR1

	030721'	260040	026600'	COLONC:	PJS	AAL		;DEFINE LABEL
	030722'	332000	003167'		SKIPE	GSEC
	030723'	254000	026121'		JRST	DQUES1
	030724'	260040	021763'		PJS	BL3
	030725'	254000	025724'		JRST	CR2

	030726'	200200	006525'	QUOTE1:	MOVE	V,VTAB
	030727'	202200	000551'		MOVEM	V,PC
	030730'	201600	000113	QUOTE:	MOVEI	M,17*5		;QUOTE COMMAND. USED TO ENTER ASC INTO MEMORY.
	030731'	256000	002272'		XCT	GCHI
	030732'	200500	000010		MOVE	Y,W		;USER SPECIFIED STRING DELIMITER
	030733'	256000	002272'		XCT	GCHI
	030734'	136400	006462'		IDPB	W,DOS
	030735'	312400	000012		CAME	W,Y
	030736'	367600	030733'		SOJG	M,.-3		;BUILD STRING
	030737'	323600	026123'		JUMPLE	M,DQUES		;STRING TOO LONG
	030740'	256000	002272'		XCT	GCHI
	030741'	302400	000015		CAIE	W,15
	030742'	254000	026123'		JRST	DQUES		;CR MUST FOLLOW DELIMITER

	030743'	200400	000551'		MOVE	W,PC
	030744'	200100	034644'		MOVE	I,[POINT 7,DOS+1]	;COPY STRING TO MEMORY
	030745'	134200	000002		ILDB	V,I
	030746'	316200	000012		CAMN	V,Y
	030747'	254000	030752'		JRST	.+3
	030750'	260040	026671'		PJS	PBY
	030751'	344400	030745'		AOJA	W,.-4
	030752'	202400	000551'		MOVEM	W,PC
	030753'	254000	025723'		JRST	CR1
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-23
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS


	030754'	260060	006573'	LF1:	PJS	@ICJMP
	030755'	120200	006525'		DMOVE	V,VTAB
	030756'	200500	000551'		MOVE	Y,PC
	030757'	260040	026475'		PJS	VM
	030760'	200200	006566'	LF0:	MOVE	V,CMLDTA
	030761'	332000	006444'		SKIPE	COS
	030762'	240200	000001		ASH	V,1
	030763'	321200	031000'		JUMPL	V,LFA		;^ OR L.F ?
	030764'	051700	000015		OUTCHI	15
	030765'	200500	000551'		MOVE	Y,PC
	030766'	260040	026444'		PJS	MV
	030767'	550200	000005		HRRZ	V,U
	030770'	242200	000001		LSH	V,1
	030771'	327200	031001'		JUMPG	V,LFB		;U 1,2,3 TO V 2,4,6 FOR INSTRUCTIONS
	030772'	201200	000002		MOVEI	V,2
	030773'	332000	006444'		SKIPE	COS
	030774'	201200	000004		MOVEI	V,4		;BYTE COUNT FOR CONSTANT
	030775'	254000	031001'		JRST	LFB

	030776'	260060	006573'	LFP:	PJS	@ICJMP
	030777'	254000	026123'		JRST	DQUES

	031000'	260040	021750'	LFA:	PJS	TYPEOL
	031001'	270200	000551'	LFB:	ADD	V,PC
	031002'	260040	026530'		PJS	FC
	031003'	476000	006454'		SETOM	OPEN
	031004'	254000	025724'		JRST	CR2

	031005'	201400	026523'	SL0:	MOVEI	W,FCC		;SLASH COMMAND. NO ARGS.
	031006'	400440	000000		SETZ	X,
	031007'	254000	031012'		JRST	SL5		;DONT OPEN CELL UNLESS ALREADY OPENED
	031010'	474440	000000	SL1:	SETO	X,		;OPEN AND TYPE OUT
	031011'	201400	026522'		MOVEI	W,FCCPC
	031012'	120200	006423'	SL5:	DMOVE	V,LVV
	031013'	326240	026121'		JUMPN	U,DQUES1
	031014'	331000	000006		SKIPL	VS
	031015'	202300	006443'		MOVEM	VS,TOM
	031016'	436440	006454'		IORM	X,OPEN		;MAYBE OPEN A CELL
	031017'	260050	000000		PJS	(W)
	031020'	260040	026654'		PJS	DOSOUT		;FULL CELL CONTENTS TO TTY
	031021'	254000	025724'		JRST	CR2

	031022'	331000	000006	SL2:	SKIPL	VS
	031023'	202300	006443'		MOVEM	VS,TOM		;TYPE OUT A RANGE OF CELLS
	031024'	200200	006527'		MOVE	V,VTAB+2	;GET 2ND EXPRESSION
	031025'	313200	006525'		CAMLE	V,VTAB		;IS IT AN ADDRESS OR A LENGTH?
	031026'	254000	031032'		JRST	SL2A		;IF AN ADDRESS
	031027'	270200	006525'		ADD	V,VTAB		;A LENGTH, CHANGE TO AN ADDRESS
	031030'	370000	000004		SOS	V
	031031'	202200	006527'		MOVEM	V,VTAB+2	;SAVE ENDING ADDRESS
	031032'	200400	006450'	SL2A:	MOVE	W,NCLM		;GET CURRENT NUMBER OF COLUMNS
	031033'	202400	006453'		MOVEM	W,CLMCNT	;INIT COLUMN COUNT
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-24
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	031034'	260040	021750'		PJS	TYPEOL		;OUTPUT CRLF
	031035'	200200	006525'	SL2B:	MOVE	V,VTAB		;NEXT ADDRESS TO LIST
	031036'	313200	006527'		CAMLE	V,VTAB+2
	031037'	254000	025722'		JRST	CR		;DONE WITH TYPEOUT
	031040'	261040	000004		PUSH	S,V
	031041'	260040	026651'		PJS	IZDOS
	031042'	332000	006450'		SKIPE	NCLM
	031043'	254000	031047'		JRST	SL2C		;IF COLUMIZED OUTPUT
	031044'	260040	026265'		PJS	XS		;OUTPUT LABEL
	031045'	201400	000134		MOVEI	W,134
	031046'	136400	006462'		IDPB	W,DOS		;OUTPUT BACKSLASH
	031047'	262040	000004	SL2C:	POP	S,V
	031050'	202200	000551'		MOVEM	V,PC
	031051'	200500	000004		MOVE	Y,V
	031052'	260040	026444'		PJS	MV		;GET VECTOR VALUE
	031053'	124200	006423'		DMOVEM	V,LVV
	031054'	336000	006450'		SKIPN	NCLM
	031055'	260040	026643'		PJS	DOS3B		;OUTPUT 3 BLANKS IF NOT COLUMIZED
	031056'	260040	026212'		PJS	XVU		;TRANSLATE VALUE VECTOR TO STRING DOS
	031057'	336000	006450'		SKIPN	NCLM
	031060'	254000	031112'		JRST	SL2F		;IF NOT COLUMIZED OUTPUT
	031061'	550400	006462'		HRRZ	W,DOS		;CURRENT PTR (DOS+n)
	031062'	275400	006462'		SUBI	W,DOS		;n
	031063'	221400	000005		IMULI	W,5		;5*n
	031064'	554440	006462'		HLRZ	X,DOS		;GET p
	031065'	242440	777764		LSH	X,-14
	031066'	231440	000007		IDIVI	X,7		;p/7
	031067'	274400	000011		SUB	W,X		;5*n-p/7=LENGTH IN CHARACTERS
	031070'	200440	006447'		MOVE	X,WCLM		;WIDTH OF COLUMN
	031071'	274440	000010		SUB	X,W		;NUMBER OF PADDING BLANKS
	031072'	325440	031105'		JUMPGE	X,SL2E		;IF DATA LESSTHAN WIDTH
	031073'	400400	000000		SETZ	W,
	031074'	136400	006462'		IDPB	W,DOS		;MARK END OF STRING
	031075'	260040	026651'		PJS	IZDOS		;GO TO TOP AGAIN
	031076'	134400	006462'	SL2D:	ILDB	W,DOS
	031077'	350000	000011		AOS	X
	031100'	323440	031076'		JUMPLE	X,SL2D		;IF IGNORING CHARACTERS
	031101'	336000	000010		SKIPN	W
	031102'	254000	031114'		JRST	SL2H		;END OF STRING
	031103'	051040	000010		OUTCHR	W
	031104'	254000	031076'		JRST	SL2D
	031105'	337000	000011	SL2E:	SKIPG	X
	031106'	254000	031113'		JRST	SL2G		;NO MORE BLANKS
	031107'	051700	000040		OUTCHI	40
	031110'	370000	000011		SOS	X
	031111'	254000	031105'		JRST	SL2E

	031112'	260040	026643'	SL2F:	PJS	DOS3B		;OUTPUT 3 BLANKS
	031113'	260040	026654'	SL2G:	PJS	DOSOUT		;OUTPUT THE STRING
	031114'	550200	006424'	SL2H:	HRRZ	V,LVV+1
	031115'	326200	031121'		JUMPN	V,.+4
	031116'	201200	000001		MOVEI	V,1
	031117'	332000	006444'		SKIPE	COS
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-25
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	031120'	201200	000002		MOVEI	V,2
	031121'	242200	000001		LSH	V,1
	031122'	272200	006525'		ADDM	V,VTAB
	031123'	336000	006450'		SKIPN	NCLM
	031124'	254000	031032'		JRST	SL2A		;IF NOT COLUMIZING
	031125'	370400	006453'		SOS	W,CLMCNT	;# OF COLUMNS LEFT
	031126'	323400	031032'		JUMPLE	W,SL2A		;IF NO MORE LEFT
	031127'	051700	000040		OUTCHI	40
	031130'	254000	031035'		JRST	SL2B

	031131'	331000	000006	EQ01:	SKIPL	VS
	031132'	202300	006443'		MOVEM	VS,TOM
	031133'	120200	006423'		DMOVE	V,LVV
	031134'	306300	000003		CAIN	VS,3		;IS THIS THE "_" COMMAND?
	031135'	254000	031141'		JRST	EQ02		;YES
	031136'	260040	026227'		PJS	XVUB
	031137'	260040	026654'		PJS	DOSOUT
	031140'	254000	025724'		JRST	CR2
	031141'	261040	006576'	EQ02:	PUSH	S,FCSBND	;SAVE MAX SYMBOL DIFFERENCE
	031142'	525300	377777		HRLOI	VS,377777	;GET LARGEST ADDRESS DIFFERENCE
	031143'	202300	006576'		MOVEM	VS,FCSBND	;ALLOW ALL SYMBOLS TO BE USED
	031144'	260040	026227'		PJS	XVUB		;CALCULATE ADDRESS VALUE
	031145'	262040	006576'		POP	S,FCSBND	;RESTORE "FCSBND"
	031146'	260040	026654'		PJS	DOSOUT		;PRINT SYMBOL AND OFFSET
	031147'	254000	025724'		JRST	CR2

	031150'	334340	000001	LIBOOT:	SKIPA	OS,S		;NEGATE OS FOR BOOT LOAD
	031151'	400340	000000	LI:	SETZ	OS,		;LOAD ENGINE
	031152'	260040	021750'		PJS	TYPEOL
	031153'	201400	000004		MOVEI	W,4
	031154'	047400	000031		SLEEP	W,
	031155'	561500	000016		HRROI	Y,16
	031156'	042500	000006		AUXCAL	Y,VS		;SET OUTPUT BAUD RATE
	031157'	200240	006440'		MOVE	U,ARGC
	031160'	405240	000001		ANDI	U,1
	031161'	270240	000005		ADD	U,U		;U=0 IF 2 ARGS,U=2 IF 3 ARGS.
	031162'	200200	006525'		MOVE	V,VTAB
	031163'	202200	006442'		MOVEM	V,IPC
	031164'	200205	006525'		MOVE	V,VTAB(U)
	031165'	200245	006527'		MOVE	U,VTAB+2(U)
	031166'	260040	031201'		PJS	DB
	031167'	035000	035057'		TYPE	<$Loaded$>
	031170'	505400	000041		HRLI	W,41
	031171'	541400	020000		HRRI	W,20000
	031172'	047400	000072		HIBER	W,		;RUNOUT TTY OUTPUT
	031173'	474400	000000		SETO	W,		;ERR RETURN FROM HIBER
	031174'	561500	000016		HRROI	Y,16
	031175'	200300	006412'		MOVE	VS,OBR
	031176'	042500	000006		AUXCAL	Y,VS
	031177'	327400	025723'		JUMPG	W,CR1
	031200'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR

	031201'			DB:			;DUMP BLOCK
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-26
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

				;			V=PC
				;			IPC=ENGINE PC
				;			U=BYTE COUNT
				;			OS NEG. IF BOOT DUMP
				;			C IS CHECKSUM REGISTER
	031201'	476000	006434'		SETOM	DBLCHR
	031202'	400140	000000		SETZ	C,		;INITIALIZE LAST CHR SENT AND CHECKSUM
	031203'	321340	031221'		JUMPL	OS,DB1
	031204'	051640	035061'		IONEOU	[200]		;OUTPUT A RESET
	031205'	135400	035062'		LDB	W,[POINT 8,IPC,19]
	031206'	260040	031301'		PJS	DBCHR2
	031207'	135400	035063'		LDB	W,[POINT 8,IPC,27]
	031210'	260040	031301'		PJS	DBCHR2
	031211'	135400	035064'		LDB	W,[POINT 8,IPC,35]
	031212'	260040	031301'		PJS	DBCHR2
	031213'	135400	035065'		LDB	W,[POINT 8,U,19]
	031214'	260040	031301'		PJS	DBCHR2
	031215'	135400	035066'		LDB	W,[POINT 8,U,27]
	031216'	260040	031301'		PJS	DBCHR2
	031217'	135400	035067'		LDB	W,[POINT 8,U,35]
	031220'	260040	031301'		PJS	DBCHR2

	031221'	361240	031227'	DB1:	SOJL	U,DB2
	031222'	200400	000004		MOVE	W,V
	031223'	260040	025610'		CA
	031224'	135400	000010		LDB	W,W
	031225'	260040	031234'		PJS	DBCHR
	031226'	344200	031221'		AOJA	V,DB1
	031227'	210400	000003	DB2:	MOVN	W,C
	031230'	405400	000177		ANDI	W,177
	031231'	260040	031307'		PJS	DBCHR3	;SEND CHECKSUM
	031232'	541400	000202		HRRI	W,202
	031233'	254000	031307'		JRST	DBCHR3		;RESET ENGINE LOADER,POP BACK FROM DB

	031234'	321340	031307'	DBCHR:	JUMPL	OS,DBCHR3
	031235'	322240	031244'		JUMPE	U,DBF
	031236'	312400	006434'		CAME	W,DBLCHR
	031237'	254000	031244'		JRST	DBF
	031240'	200440	006435'		MOVE	X,DBC0
	031241'	434440	006436'		IOR	X,DBC1
	031242'	305440	000367		CAIGE	X,367
	031243'	254000	031270'		JRST	DBCHR1

	031244'			DBF:				;FLUSH ZEROS OR ONES PATTERN IF ANY ACCUMULATING.
	031244'	375440	006435'		SOSGE	X,DBC0
	031245'	254000	031255'		JRST	DBF1
	031246'	327440	031251'		JUMPG	X,.+3
	031247'	051640	034170'		IONEOU	[0]
	031250'	254000	031266'		JRST	DBF9
	031251'	051640	035070'		IONEOU	[203]
	031252'	271440	000211		ADDI	X,211
	031253'	051640	000011		IONEOU	X
	031254'	271151	000203		ADDI	C,203(X)
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-27
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	031255'	375440	006436'	DBF1:	SOSGE	X,DBC1
	031256'	254000	031266'		JRST	DBF9
	031257'	327440	031262'		JUMPG	X,.+3
	031260'	051640	035071'		IONEOU	[-1]
	031261'	364140	031266'		SOJA	C,DBF9
	031262'	051640	035072'		IONEOU	[204]
	031263'	271440	000211		ADDI	X,211
	031264'	051640	000011		IONEOU	X
	031265'	271151	000204		ADDI	C,204(X)
	031266'	402000	006435'	DBF9:	SETZM	DBC0
	031267'	402000	006436'		SETZM	DBC1

	031270'	202400	006434'	DBCHR1:	MOVEM	W,DBLCHR
	031271'	322240	031301'		JUMPE	U,DBCHR2
	031272'	326400	031275'		JUMPN	W,.+3
	031273'	350000	006435'		AOS	DBC0
	031274'	263040	000000		RETURN
	031275'	302400	000377		CAIE	W,377
	031276'	254000	031301'		JRST	.+3
	031277'	350000	006436'		AOS	DBC1
	031300'	263040	000000		RETURN

	031301'	307400	000204	DBCHR2:	CAIG	W,204
	031302'	307400	000177		CAIG	W,177
	031303'	254000	031307'		JRST	DBCHR3
	031304'	051640	035073'		IONEOU	[201]
	031305'	271140	000201		ADDI	C,201
	031306'	431400	000200		XORI	W,200
	031307'	051640	000010	DBCHR3:	IONEOU	W
	031310'	270140	000010		ADD	C,W
	031311'	263040	000000		RETURN

				;	HERE FOR CTL(N) = ENGINE "M" COMMAND.
	031312'	370000	006570'	ICM:	SOS	CMLCHR

				;	PROCESS ENGINE COMMAND CHARACTER.
	031313'	335000	006410'	IC:	AUXCHK
	031314'	254000	032337'
	031315'	550200	006570'		HRRZ	V,CMLCHR
	031316'	550400	006570'		HRRZ	W,CMLCHR
	031317'	435200	000300		IORI	V,300
	031320'	301400	000040		CAIL	W,40		;IS CHARACTER PRINTABLE?
	031321'	254000	031324'		JRST	IC6		;YES, DON'T ECHO IT THEN
	031322'	051040	000004		OUTCHR	V		;ECHO PRINTABLE CHR
	031323'	051700	000040		OUTCHI	" "
	031324'	202200	006571'	IC6:	MOVEM	V,ICCHR
	031325'	270100	006336'		ADD	I,BACKUP	;BACKUP TO BEGINNING OF CMND STRING
	031326'	200240	006567'		MOVE	U,CMLU
	031327'	204245	000001		MOVS	U,1(U)
	031330'	206240	006411'		MOVSM	U,ICX		;SAVE CMD WORD
	031331'	254005	000000		JRST	(U)
	031332'	335000	006571'	IC2:	SKIPGE	ICCHR
	031333'	263040	000000		RETURN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-28
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	031334'	262040	000010		POP	S,W		;THROW AWAY RETURN
				;	SEND COMMAND CHACACTER TO ENGINE.
	031335'	504400	006410'	IC3:	HRL	W,CN
	031336'	541400	000003		HRRI	W,3
	031337'	042400	006571'		AUXCAL	W,ICCHR
	031340'	541400	000004		HRRI	W,4		;send immediate character
	031341'	332000	006572'		SKIPE	ICCTRM		;should terminator be sent
	031342'	042400	000040		AUXCAL	W," "
	031343'	400100	000000		SETZ	I,
	031344'	540400	006411'		HRR	W,ICX
	031345'	254010	000000		JRST	(W)

				;	SEND THE ARGUMENTS TO THE ENGINE.
	031346'	375000	006440'	IC4:	SOSGE	ARGC
	031347'	254000	025723'		JRST	CR1
	031350'	260040	031662'		PJS	ICSA
	031351'	201200	000054		MOVEI	V,","
	031352'	260040	031763'		PJS	SDI		;ARG FOLLOWED BY COMMA
	031353'	254000	031346'		JRST	IC4


				;	RELAY UNKNOWN : CMD TO AUX CIRCUIT
	031354'	335000	006410'	ICRLY:	AUXCHK
	031355'	254000	032337'
	031356'	256000	002272'	ICRLY0:	XCT	GCHI		;GET NEXT CHAR
	031357'	200200	000010		MOVE	V,W
	031360'	306200	000040		CAIN	V," "
	031361'	254000	031372'		JRST	ICRL2		;IF END OF COMMAND
	031362'	306200	000054		CAIN	V,","
	031363'	254000	031372'		JRST	ICRL2		;IF END OF COMMAND
	031364'	306200	000015		CAIN	V,15
	031365'	254000	031370'		JRST	ICRL1		;IF CR, NO PARAMETERS FOR COMMAND
	031366'	260040	031763'		PJS	SDI		;SEND NEXT COMMAND CHARACTER
	031367'	254000	031356'		JRST	ICRLY0		;GET ANOTHER

	031370'	260040	031763'	ICRL1:	PJS	SDI		;sent terminator
	031371'	254000	025723'		JRST	CR1		;and exit. nothing more to do

	031372'	202200	006570'	ICRL2:	MOVEM	V,CMLCHR	;SAVE COMMAND TERMINATOR
	031373'	402000	006572'		SETZM	ICCTRM		;don't send terminator
	031374'	254000	031324'		JRST	IC6		;SET UP COMMAND


				;	:W OR :WR - SEE WHICH IT IS.
	031375'	335000	006410'	ICW:	AUXCHK
	031376'	254000	032337'
	031377'	256000	002272'		XCT	GCHI		;NEXT CHARACTER
	031400'	301400	000141		CAIL	W,"a"		;CONVERT lower to UPPER
	031401'	303400	000172		CAILE	W,"z"
	031402'	334000	000000		SKIPA
	031403'	275400	000040		SUBI	W,40
	031404'	306400	000122		CAIN	W,"R"		;IS THIS :WR COMMAND?
	031405'	254000	031741'		JRST	ICWR		;IF :WR
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-29
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	031406'	137400	000002		DPB	W,I		;INSERT 1ST ARG CHAR IN COMMAND LINE
	031407'	133000	000002		IBP	I		;INCREMENT FOR BACKUP.
	031410'	201200	035074'		MOVEI	V,[ EXP 0,CR3_22+ICW9]
	031411'	202200	006567'		MOVEM	V,CMLU		;SET UP FOR NEXT COMMAND ADDRESSES
	031412'	254000	031313'		JRST	IC		;SUCCESS. GO GET ARGS.
				;	RETURN HERE TO PROCESS ARGS.
	031413'	200200	006440'	ICW9:	MOVE	V,ARGC
	031414'	302200	000002		CAIE	V,2		;2 ARGUMENTS?
	031415'	254000	026123'		JRST	DQUES		;MUST BE 2 FOR NOW
	031416'	201400	000004		MOVEI	W,4		;send count of four bytes
	031417'	250400	006527'		EXCH	W,VTAB+2	;send as second argument
	031420'	202400	006531'		MOVEM	W,VTAB+4	;and make second arg the third arg
	031421'	350000	006440'		AOS	ARGC		;one arg added
	031422'	254000	031346'		JRST	IC4

				;	:W,ADR,VAL OR PHYADR,VIRADR,CNT:W - WRITE DATA.
				;	ALSO OLD CONTROL W GOES HERE.
	031423'			ICW1:				;CONTROL W. SEND MEMORY DATA.
	031423'	335000	006410'		AUXCHK
	031424'	254000	032337'
	031425'	332000	006440'		SKIPE	ARGC		;SKIP IF PHYAD,VIRAD,CNT:W FORM
	031426'	254000	031432'		JRST	ICW2		;GET ARGUMENTS
	031427'	201400	031432'		MOVEI	W,ICW2
	031430'	202400	006573'		MOVEM	W,ICJMP
	031431'	254000	031313'		JRST	IC
				;	SET UP ARGUMENTS.
	031432'	337000	006440'	ICW2:	SKIPG	ARGC
	031433'	254000	026123'		JRST	DQUES		;MUST BE AT LEAST 1 ARG
	031434'	260040	031521'		PJS	ICBBEG		;BEGIN BINARY MODE
	031435'	200200	006440'		MOVE	V,ARGC		;get argument count
	031436'	302200	000001		CAIE	V,1
	031437'	254000	031442'		JRST	ICW6
	031440'	201400	000004		MOVEI	W,4
	031441'	202400	006531'		MOVEM	W,VTAB+4	;IF ONLY ONE, ASSUME ONE WORD COUNT
	031442'	302200	000002	ICW6:	CAIE	V,2
	031443'	254000	031446'		JRST	ICW7
	031444'	200400	006527'		MOVE	W,VTAB+2	;MAKE SECOND ARG BE THIRD ARG
	031445'	202400	006531'		MOVEM	W,VTAB+4
	031446'	301200	000003	ICW7:	CAIL	V,3
	031447'	254000	031452'		JRST	ICW8
	031450'	200200	006525'		MOVE	V,VTAB		;IF TWO ARGS OR LESS
	031451'	202200	006527'		MOVEM	V,VTAB+2	;MAKE SOURCE AND DESTINATION ADDRS SAME

				;	SEND THE ADDRESS AND BYTE COUNT VALUES.
	031452'	201200	000327	ICW8:	MOVEI	V,TYMNET("W")
	031453'	260040	031763'		PJS	SDI		;SEND W CHARACTER
	031454'	261040	006527'		PUSH	S,VTAB+2	;save arguments in case of retry
	031455'	261040	006531'		PUSH	S,VTAB+4
	031456'	400200	000000		SETZ	V,		;SEND A ZERO BEFORE ARGS
	031457'	260040	031763'		PJS	SDI		;SEND A ZERO BEFORE ARGS
	031460'	200440	006525'		MOVE	X,VTAB		;SEND ADDRESS TO WRITE DATA
	031461'	260040	031646'		PJS	ICBARG
	031462'	200440	006531'		MOVE	X,VTAB+4	;SEND COUNT OF BYTES TO WRITE
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-30
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	031463'	260040	031646'		PJS	ICBARG
				;
				;	Send data from PDP memory to ISIS DDT
				;
	031464'	200400	006527'	ICW3:	MOVE	W,VTAB+2
	031465'	260040	025610'		CA
	031466'	135200	000010		LDB	V,W
	031467'	260040	031763'		PJS	SDI		;SEND DATA
	031470'	350000	006527'		AOS	VTAB+2
	031471'	373000	006531'		SOSLE	VTAB+4
	031472'	254000	031464'		JRST	ICW3

				;	SEE IF DATA WAS RECEIVED OK.
	031473'	262040	006531'		POP	S,VTAB+4		;restore arguments in case of retry
	031474'	262040	006527'		POP	S,VTAB+2
	031475'	035000	035076'		TYPE	< Data sent >
	031476'	514400	006410'		HRLZ	W,CN
	031477'	242400	000011		LSH	W,11		;port number to bits 0-8 for HIBER
	031500'	434400	035101'		IOR	W,[112,,^D2]	;wait 2 minutes for prompt to be typed
	031501'	047400	000072		HIBER	W,		;wait for output to be received
	031502'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	031503'	514400	006410'		HRLZ	W,CN
	031504'	541400	000010		HRRI	W,10
	031505'	042400	000000		AUXCAL	W,		;anything in input buffer?
	031506'	254000	031512'		JRST	ICW5		;no. DDT still waiting for more data. Data lost
	031507'	260040	031541'		PJS	ICBEND		;LEAVE BINARY MODE
	031510'	254000	026124'		JRST	DQUES3		;FAILED TO EXIT
	031511'	254000	025723'		JRST	CR1
	031512'	035000	035102'	ICW5:	TYPE	<***no response - retrying$>
	031513'	514400	006410'		HRLZ	W,CN
	031514'	541400	000004		HRRI	W,4
	031515'	042400	000201		AUXCAL	W,201		;send a flush character
	031516'	260040	031654'		PJS	RAC		;ignore prompt
	031517'	260040	031654'		PJS	RAC
	031520'	254000	031452'		JRST	ICW8

				;	START BINARY MODE.
	031521'	660700	000040	ICBBEG:	TRO	F2,BINMOD	;flag in binary mode
	031522'	505400	001000		HRLI	W,(<.IACHR>B8)
	031523'	540400	006410'		HRR	W,CN
	031524'	047400	777736		TINASS	W,		;unassign character receive interrupt
	031525'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	031526'	201200	000303		MOVEI	V,TYMNET("C")
	031527'	260040	031763'		PJS	SDI
	031530'	201200	000302		MOVEI	V,TYMNET("B")
	031531'	260040	031763'		PJS	SDI		;CONVERT CMD
	031532'	260040	031654'	ICBEG1:	PJS	RAC
	031533'	306400	000200		CAIN	W,200		;is it first character of prompt?
	031534'	254000	031537'		JRST	ICBEG2		;yes
	031535'	260040	032003'		PJS	ICOUT		;no. print it
	031536'	254000	031532'		JRST	ICBEG1		;and get another
	031537'	260040	031654'	ICBEG2:	PJS	RAC
	031540'	263040	000000		RETURN
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-31
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS


				;	END BINARY MODE. SKIP RETURN ON SUCCESS. NONSKIP ON FAILURE.
	031541'	260040	031654'	ICBEND:	PJS	RAC		;GET COMMAND RESPONSE
	031542'	302400	000200		CAIE	W,200		;CHECK FOR PROMPT X'8002
	031543'	254000	031555'		JRST	ICBE2		;NOT A PROMPT. GET FLUSH REQUEST
	031544'	260040	031654'		PJS	RAC		;GET SECOND PART OF PROMPT
	031545'	302400	000002		CAIE	W,2		;IS IT REST OF PROMPT?
	031546'	254000	031565'		JRST	ICBE5		;NO
	031547'	035000	035110'		TYPE	<and received$>
	031550'	350001	000000		AOS	(S)		;set skip return
	031551'	254000	031613'		JRST	ICBE20		;YES. SUCCESSFUL COMMAND. GO FINISH

				;	RELAY OUTPUT UNTIL FLUSH REQUEST.
	031552'	260040	031654'	ICBE1:	PJS	RAC		;GET NEXT CHARACTER
	031553'	306400	000200		CAIN	W,200		;IS IT AN ESCAPE CHARACTER?
	031554'	254000	031564'		JRST	ICBE4		;YES. GO GET SECOND HALF.
	031555'	306400	000201	ICBE2:	CAIN	W,201		;IS IT A FLUSH REQUEST.
	031556'	254000	031606'		JRST	ICBE10		;YES. RELAY FINISHED. GO FINISH COMMAND.
	031557'	241400	777774	ICBE3:	ROT	W,-4		;OUTPUT CHARACTER IN HEX.
	031560'	051050	032572'		OUTCHR	HEX(W)
	031561'	242400	777740		LSH	W,-40
	031562'	051050	032572'		OUTCHR	HEX(W)
	031563'	254000	031552'		JRST	ICBE1		;GET NEXT CHARACTER
	031564'	260040	031654'	ICBE4:	PJS	RAC		;GET SECOND HALF OF ESCAPE PAIR
	031565'	301400	000002	ICBE5:	CAIL	W,2		;IS IT A DATA CHARACTER?
	031566'	254000	031571'		JRST	ICBE6		;NO. GO TRANSLATE TO MESSAGE.
	031567'	435400	000200		IORI	W,200		;CONVERT TO DATA CHARACTER
	031570'	254000	031557'		JRST	ICBE3		;AND GO OUTPUT
	031571'	301400	000041	ICBE6:	CAIL	W,RIPXN		;Is it a known code?
	031572'	254000	031576'		JRST	ICBE7		;no
	031573'	200410	032012'		MOVE	W,RIPX-2(W)	;TYPE MESSAGE
	031574'	260040	021767'		PJS	TYPEM
	031575'	254000	031552'		JRST	ICBE1		;GET NEXT CHARACTER
	031576'	261040	000010	ICBE7:	PUSH	S,W		;save message code
	031577'	201400	035113'		MOVEI	W,[ASCIZ "$ISIS error code: "]
	031600'	260040	021767'		PJS	TYPEM
	031601'	262040	000004		POP	S,V		;restore error code
	031602'	201500	000016		MOVEI	Y,16		;type in hex
	031603'	260040	022015'		PJS	TN
	031604'	260040	021750'		PJS	TYPEOL
	031605'	254000	031552'		JRST	ICBE1
	031606'	504400	006410'	ICBE10:	HRL	W,CN		;HONOR FLUSH REQUEST
	031607'	541400	000004		HRRI	W,4
	031610'	042400	000201		AUXCAL	W,201
	031611'	260040	031654'		PJS	RAC		;IGNORE PROMPT
	031612'	260040	031654'		PJS	RAC

	031613'	260040	031615'	ICBE20:	PJS	ICBCLR		;clear binary mode
	031614'	263040	000000		RETURN

				;	Clear binary mode to aux circuit if there is a circuit and
				;	in binary mode.

NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-32
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	031615'	514400	006410'	ICBCLR:	HRLZ	W,CN		;send "CA" command
	031616'	541400	000004		HRRI	W,4
	031617'	042400	000303		AUXCAL	W,TYMNET("C")
	031620'	042400	000301		AUXCAL	W,TYMNET("A")
	031621'	260040	031654'	ICBCL1:	PJS	RAC		;get final prompt
	031622'	405400	000177		ANDI	W,177		;remove parity bit
	031623'	302400	000015		CAIE	W,15		;wait for carriage return, linefeed, *
	031624'	254000	031621'		JRST	ICBCL1
	031625'	051040	000010		OUTCHR	W		;and type it
	031626'	260040	031654'		PJS	RAC
	031627'	051040	000010		OUTCHR	W
	031630'	260040	031654'		PJS	RAC
	031631'	051040	000010		OUTCHR	W
	031632'	505400	001004		HRLI	W,(<.IACHR>B8+<CHRCHN>B17)
	031633'	540400	006410'		HRR	W,CN
	031634'	047400	777736		TINASS	W,		;reassign character received interrupt
	031635'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	031636'	205400	420000		MOVSI	W,(1B0+1B<CHRCHN>)
	031637'	047400	777744		INTENB	W,		;restore character receive interrupt
	031640'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	031641'	205400	420000		MOVSI	W,(1B0+1B<CHRCHN>)
	031642'	047400	777743		INTACT	W,
	031643'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	031644'	620700	000040		TRZ	F2,BINMOD	;FLAG ASCII MODE
	031645'	263040	000000		RETURN

				;	BINARY READ FROM AUX CURCUIT. RETURN CHAR IN REGISTER "W".
				;	IF DATA NOT READ, ABORT COMMAND BY ENTERING "ICBEND" AND
				;	THEN GOING TO "DQUES".
				;BRAC:	PJS	RAC		;READ NEXT AUX CHAR
				;	CAIE	W,200		;IS IT AN ESCAPE CHAR?
				;	JRST	BRAC1		;NO.
				;	PJS	RAC		;GET ESCAPED CHARACTER
				;	CAIL	W,2		;IS IT A DATA CHARACTER?
				;	JRST	BRAC2		;NO. GO ABORT
				;	IORI	W,200		;CONVERT TO DATA VALUE.
				;	RETURN
				;BRAC1:	CAIE	W,201		;IS IT A FLUSH REQUEST?
				;	RETURN
				;	PJS	ICBE10		;YES. GO TERMINATE BINARY MODE.
				;	JRST	DQUES		;AND ABORT
				;BRAC2:	PJS	ICBE5		;GO TERMINATE BINARY MODE.
				;	JRST	DQUES

				;	SEND ENGINE BINARY ARG. A ZERO BYTE MUST BE SENT BEFORE
				;	ARGS. SENDS THE LOWER FOUR BYTES OF REGISTER "X".
	031646'	200240	035117'	ICBARG:	MOVE	U,[POINT 8,X,3]	;SEND 4 BYTES OF ENGINE ADRS
	031647'	134200	000005	ICBA1:	ILDB	V,U
	031650'	260040	031763'		PJS	SDI
	031651'	603240	770000		TLNE	U,770000
	031652'	254000	031647'		JRST	ICBA1
	031653'	263040	000000		RETURN

NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-33
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	031654'	514400	006410'	RAC:	HRLZ	W,CN
	031655'	042400	000010		AUXCAL	W,W
	031656'	254000	031660'		JRST	.+2
	031657'	263040	000000		RETURN			;READ AUX. CIRCUIT
	031660'	035000	035120'		TYPE	<$*** Cannot input 8-bit character.>
	031661'	254000	032507'		JRST	CDQUES

	031662'			ICSA:				;SEND ARGUMENT TO ENGINE
	031662'	504400	006410'		HRL	W,CN
	031663'	541400	000003		HRRI	W,3
	031664'	200240	035127'		MOVE	U,[POINT 4,VTAB(I),3]
	031665'	134440	000005	ICSA1:	ILDB	X,U
	031666'	042411	032572'		AUXCAL	W,HEX(X)
	031667'	603240	770000		TLNE	U,770000	;ALL?
	031670'	254000	031665'		JRST	ICSA1
	031671'	271100	000002		ADDI	I,2
	031672'	263040	000000		RETURN

	031673'			ICN:	;"NEXT" COMMAND
	031673'	201200	000316		MOVEI	V,TYMNET("N")	;GET "N"
	031674'	202200	006570'		MOVEM	V,CMLCHR	;MAKE IT THE COMMAND CHAR
	031675'	254000	031313'		JRST	IC		;GO TO COMMAND SENDER AND ECHOER

				;	:R OR :RR - SEE WHICH.
	031676'	335000	006410'	ICR:	AUXCHK
	031677'	254000	032337'
	031700'	256000	002272'		XCT	GCHI		;NEXT CHARACTER
	031701'	301400	000141		CAIL	W,"a"		;MAP lower to UPPER CASE
	031702'	303400	000172		CAILE	W,"z"
	031703'	334000	000000		SKIPA
	031704'	275400	000040		SUBI	W,40
	031705'	306400	000122		CAIN	W,"R"		;IS THIS :RR COMMAND?
	031706'	254000	031712'		JRST	ICRR		;IF :RR

				;	:R COMMAND.
	031707'	137400	000002		DPB	W,I		;DEPOSIT ARGUMENT FIRST CHARACTER
	031710'	133000	000002		IBP	I		;INCREMENT FOR BACKUP
				;	MOVEI	V,[EXP 0,CR3_22+ICR2]
				;	MOVEM	V,CMLU		;SET COMMAND TRANSFER ADDRESSES.

				;	CONTROL-R COMMAND
				;ICR1:	PJS	ICBBEG		;ENTER BINARY MODE
	031711'	254000	031313'		JRST	IC		;PROCESS COMMAND, GET ARGUMENTS

				;	RETURN HERE WITH VALID ARGUMENTS.
				;ICR2:	MOVE	V,ARGC		;GET NUMBER OF ARGUMENTS
				;	CAIE	V,2		;MUST BE ONLY TWO ARGS.
				;	JRST	DQUES
				;	SKIPGE	VTAB+2		;CHECK COUNT OF BYTES TO READ
				;	JRST	DQUES		;MUST BE POSITIVE
				;	SETZ	V,		;START ARGS WITH A ZERO
				;	PJS	SDI
				;	MOVE	X,VTAB		;SEND ADDRESS TO READ FROM
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-34
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

				;	PJS	ICBARG
				;	MOVE	X,VTAB+2	;SEND NUMBER OF BYTES TO READ
				;	PJS	ICBARG
				;	SETZ	Y,		;INITIALIZE EMPTY LINE COUNT
				;	MOVE	X,VTAB		;GET FIRST ADDRESS TO READ
				;ICR4:	JUMPG	Y,ICR6		;ROOM FOR MORE ON LINE?
				;	MOVE	V,[POINT 4,X,15]	;NO. START NEW LINE
				;ICR5:	ILDB	W,V		;OUTPUT ADDRESS 
				;	OUTCHR	HEX(W)
				;	TLNE	V,770000
				;	JRST	ICR5
				;	MOVEI	Y,10		;ALLOW 8 HALFWORDS/LINE
				;	TRNE	X,1		;IF ODD ADDRESS
				;	OUTSTR	[ASCIZ /    /]	; SKIP FIRST BYTE.
				;ICR6:	TRNN	X,1		;IF NEXT BYTE ON EVEN ADDRESS
				;	OUTSTR	[ASCIZ /  /]	;THEN SEPARATE IT FROM LAST ONE
				;	PJS	BRAC		;GET NEXT BYTE
				;	ROT	W,-4		;GET FIRST HEX BYTE
				;	OUTCHR	HEX(W)		;AND PRINT
				;	LSH	W,-40		;GET SECOND BYTE
				;	OUTCHR	HEX(W)		;AND PRINT IT TOO.
				;	TRNN	X,1		;END OF HALFWORD?
				;	JRST	ICR7		;NO
				;	SOJG	Y,ICR7		;YES. END OF LINE?
				;	PJS	TYPEOL		;YES. TYPE CR-LF
				;ICR7:	AOJ	X,		;INCREMENT ADDRESS.
				;	SOSLE	VTAB+2	;ANYMORE BYTES TO READ?
				;	JRST	ICR4		;YES.
				;	SKIPE	Y		;ANYTHING ON LINE?
				;	PJS	TYPEOL		;YES. TYPE CR-LF
				;	SETZ	Y,		;NO TERMINATION MESSAGE.
				;	PJS	ICBEND		;END BINARY MORE.
				;	JRST	DQUES3		;FAILED
				;	JRST	CR1		;SUCCEEDED

				;	:RR COMMAND.
	031712'	201200	000322	ICRR:	MOVEI	V,TYMNET("R")
	031713'	202200	006570'		MOVEM	V,CMLCHR	;DEPOSIT R CHARACTER
	031714'	260040	031763'		PJS	SDI		;OUTPUT FIRST R TO ENGINE
	031715'	254000	031313'		JRST	IC		;OPUTPUT 2ND R AND ARGS

	031716'			ICE:				;READ REGISTORS COMMAND
	031716'	335000	006410'		AUXCHK
	031717'	254000	032337'
	031720'	201200	000322		MOVEI	V,TYMNET("R")
	031721'	202200	006570'		MOVEM	V,CMLCHR
	031722'	051040	000004		OUTCHR	V
	031723'	051040	000004		OUTCHR	V
	031724'	051700	000040		OUTCHI	" "
	031725'	260040	031763'		PJS	SDI		;SEND FIRST R TO ENGINE
	031726'	254000	031313'		JRST	IC		;GO SEND SECOND R AND ARGUMENTS

	031727'			ICF:				;WRITE A REG.
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-35
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	031727'	335000	006410'		AUXCHK
	031730'	254000	032337'
	031731'	201200	000327		MOVEI	V,TYMNET("W")
	031732'	051040	000004		OUTCHR	V
	031733'	260040	031763'		PJS	SDI		;SEND W TO ENGINE
	031734'	201200	000322		MOVEI	V,TYMNET("R")
	031735'	202200	006570'		MOVEM	V,CMLCHR
	031736'	051040	000004		OUTCHR	V		;TYPE "WR "
	031737'	051700	000040		OUTCHI	" "
	031740'	254000	031313'		JRST	IC		;GO SEND R AND ARGUMENTS

				;	:WR - WRITE A REGISTER.
	031741'	201200	000327	ICWR:	MOVEI	V,TYMNET("W")
	031742'	260040	031763'		PJS	SDI		;SEND W CHARACTER
	031743'	201200	000322		MOVEI	V,TYMNET("R")
	031744'	202200	006570'		MOVEM	V,CMLCHR	;SET UP R CHARACTER
	031745'	201200	035130'		MOVEI	V,[ EXP 0,CR3_22+ICWR1]
	031746'	202200	006567'		MOVEM	V,CMLU		;GO TO ICWR1 AFTER <CR> SEEN
	031747'	254000	031313'		JRST	IC		;PROCESS R AND ARGS

				;	RETURN HERE TO PROCESS :WR ARGUMENTS.
	031750'			ICWR1:				;WRITE ONE REGISTOR COMMAND.
	031750'	350400	006440'		AOS	W,ARGC
	031751'	302400	000003		CAIE	W,3
	031752'	254000	026123'		JRST	DQUES		;ARG COUNT MUST GO FROM 2 TO 3
	031753'	201400	000001		MOVEI	W,1
	031754'	250400	006527'		EXCH	W,VTAB+2
	031755'	202400	006531'		MOVEM	W,VTAB+4
	031756'	254000	031346'		JRST	IC4

				;	:Z command. Logout from ISIS DDT.Expects a Z as confirmation.
				;	Don't type command terminator.

	031757'	402000	006572'	ICZ:	SETZM	ICCTRM		;type type terminator
	031760'	254000	031313'		JRST	IC

	031761'	042400	035061'	SDI0:	AUXCAL	W,[200]
	031762'	431200	000100		XORI	V,100
	031763'	504400	006410'	SDI:	HRL	W,CN
	031764'	541400	000003		HRRI	W,3		;SEND DATA CHR TO ENGINE
	031765'	302200	000200		CAIE	V,200		; X'80
	031766'	306200	000201		CAIN	V,201		; X'81
	031767'	254000	031761'		JRST	SDI0
	031770'	302200	000204		CAIE	V,204		; X'84
	031771'	306200	000205		CAIN	V,205		; X'85
	031772'	254000	031761'		JRST	SDI0
	031773'	302200	000203		CAIE	V,203		; X'83
	031774'	306200	000217		CAIN	V,217		; X'8F
	031775'	254000	031761'		JRST	SDI0
	031776'	302200	000003		CAIE	V,003		; X'03
	031777'	306200	000017		CAIN	V,017		; X'0F
	032000'	254000	031761'		JRST	SDI0
	032001'	042400	000004		AUXCAL	W,V
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-36
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	032002'	263040	000000		RETURN

	032003'	332000	006574'	ICOUT:	SKIPE	ASCHEX		;print as two hex characters?
	032004'	254000	032007'		JRST	ICOUT1		;yes
	032005'	051040	000010		OUTCHR	W		;no. just print it
	032006'	263040	000000		RETURN
	032007'	241400	777774	ICOUT1:	ROT	W,-4
	032010'	051050	032572'		OUTCHR	HEX(W)		;print first four bits as hex character
	032011'	242400	777740		LSH	W,-40
	032012'	051050	032572'		OUTCHR	HEX(W)		;print second four bits
	032013'	263040	000000		RETURN

	032014'	000000	032056'	RIPX:	Z	IM02
	032015'	000000	032057'		Z	IM03
	032016'	000000	032063'		Z	IM04
	032017'	000000	032067'		Z	IM05
	032020'	000000	032072'		Z	IM06
	032021'	000000	032077'		Z	IM07
	032022'	000000	032106'		Z	IM08
	032023'	000000	032115'		Z	IM09
	032024'	000000	032122'		Z	IM0A
	032025'	000000	032126'		Z	IM0B
	032026'	000000	032131'		Z	IM0C
	032027'	000000	032135'		Z	IM0D
	032030'	000000	032141'		Z	IM0E
	032031'	000000	032145'		Z	IM0F
	032032'	000000	032152'		Z	IM10
	032033'	000000	032156'		Z	IM11
	032034'	000000	032163'		Z	IM12
	032035'	000000	032166'		Z	IM13
	032036'	000000	032174'		Z	IM14
	032037'	000000	032176'		Z	IM15
	032040'	000000	032202'		Z	IM16
	032041'	000000	032207'		Z	IM17
	032042'	000000	032217'		Z	IM18
	032043'	000000	032226'		Z	IM19
	032044'	000000	032232'		Z	IM1A
	032045'	000000	032236'		Z	IM1B
	032046'	000000	032246'		Z	IM1C
	032047'	000000	032256'		Z	IM1E
	032050'	000000	032260'		Z	IM1F
	032051'	000000	032266'		Z	IM20
	032052'	000000	032276'		Z	IM21
			000041	RIPXN==.-RIPX+2
				;	ENGINE MESSAGES

	032053'	723636	062500	IMFLUS:	ASCIZ	"type '%\'$"
	032054'	235133	423510
	032055'	000000	000000
	032056'	221240	000000	IM02:	ASCIZ	"$*"
	032057'	647315	462716	IM03:	ASCIZ	"illegal command$"
	032060'	607304	061736
	032061'	667334	167310
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-37
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	032062'	220000	000000
	032063'	647315	462716	IM04:	ASCIZ	"illegal inst. at "
	032064'	607304	064734
	032065'	717505	620302
	032066'	721000	000000
	032067'	371754	271312	IM05:	ASCIZ	">>breakpoint "
	032070'	607276	067722
	032071'	673504	000000
	032072'	607114	471312	IM06:	ASCIZ	"address out of range$"
	032073'	717464	067752
	032074'	721015	763100
	032075'	713035	663712
	032076'	220000	000000
	032077'	613454	560726	IM07:	ASCIZ	"breakpoint number out of range$"
	032100'	703375	167350
	032101'	203356	566704
	032102'	627444	067752
	032103'	721015	763100
	032104'	713035	663712
	032105'	220000	000000
	032106'	673364	061344	IM08:	ASCIZ	"no breakpoint to proceed from$"
	032107'	627035	370336
	032110'	647356	420350
	032111'	675016	071336
	032112'	617134	562100
	032113'	633455	766510
	032114'	000000	000000
	032115'	667135	567744	IM09:	ASCIZ	"memory out of bounds$"
	032116'	745015	772750
	032117'	203374	620304
	032120'	677535	662346
	032121'	220000	000000
	032122'	647315	427100	IM0A:	ASCIZ	"ill. reg. number$"
	032123'	713134	727100
	032124'	673535	561312
	032125'	711100	000000
	032126'	623236	365500	IM0B:	ASCIZ	"disk error -"
	032127'	627456	267744
	032130'	201320	000000
	032131'	647356	660730	IM0C:	ASCIZ	"invalid number$"
	032132'	647104	067352
	032133'	667054	571110
	032134'	000000	000000
	032135'	647354	367744	IM0D:	ASCIZ	"incorrect bounds$"
	032136'	713134	372100
	032137'	613376	567310
	032140'	715100	000000
	032141'	613034	420346	IM0E:	ASCIZ	"bad search length$"
	032142'	627036	261720
	032143'	203314	567316
	032144'	723204	400000
	032145'	613034	420346	IM0F:	ASCIZ	"bad search boundary$"
	032146'	627036	261720
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-38
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	032147'	203055	772734
	032150'	623036	274510
	032151'	000000	000000
	032152'	647315	420346	IM10:	ASCIZ	"ill svc executed$"
	032153'	733064	062760
	032154'	627076	572312
	032155'	621100	000000
	032156'	647315	420332	IM11:	ASCIZ	"ill mem ref by out svc$"
	032157'	627324	071312
	032160'	631014	274500
	032161'	677536	420346
	032162'	733064	400000
	032163'	703036	264750	IM12:	ASCIZ	"parity error$"
	032164'	745014	571344
	032165'	677444	400000
	032166'	647315	420332	IM13:	ASCIZ	"ill mem ref by user program$"
	032167'	627324	071312
	032170'	631014	274500
	032171'	727474	571100
	032172'	703455	763744
	032173'	607324	400000
	032174'	202654	170176	IM14:	ASCIZ	" Zap? "
	032175'	200000	000000
	032176'	653535	570100	IM15:	ASCIZ	"jump out of bounds$"
	032177'	677536	420336
	032200'	631014	267752
	032201'	673116	322000
	032202'	717315	772100	IM16:	ASCIZ	"slot already connected$"
	032203'	607316	262702
	032204'	623624	061736
	032205'	673354	561750
	032206'	627104	400000
	032207'	647315	462716	IM17:	ASCIZ	"illegal instruction in controlled code$"
	032210'	607304	064734
	032211'	717516	272706
	032212'	723235	767100
	032213'	647344	061736
	032214'	673516	267730
	032215'	663134	420306
	032216'	677114	522000
	032217'	613454	560726	IM18:	ASCIZ	"breakpoint already exists there$"
	032220'	703375	167350
	032221'	203035	471312
	032222'	607117	120312
	032223'	743236	372346
	032224'	203515	062744
	032225'	625100	000000
	032226'	422232	350202	IM19:	ASCIZ	"DISPATCHER crash$"
	032227'	522071	042644
	032230'	203076	260746
	032231'	641100	000000
	032232'	222054	162100	IM1A:	ASCIZ	"$Bad 'M' arguments"
	032233'	236324	720302
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-39
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	032234'	713176	566712
	032235'	673516	300000
	032236'	222574	520302	IM1B:	ASCIZ	"$We already have use of SPY...aborting"
	032237'	663454	560710
	032240'	745015	060754
	032241'	625016	571712
	032242'	203374	620246
	032243'	502625	627134
	032244'	607055	771350
	032245'	647354	700000
	032246'	221345	627302	IM1C:	ASCIZ	"$...aborting"
	032247'	613376	272322
	032250'	673160	000000
	032251'	647356	372714	IM1D:	ASCIZ	"insufficient licence$"
	032252'	633234	364712
	032253'	673504	066322
	032254'	617135	661712
	032255'	220000	000000
	032256'	432451	755212	IM1E:	ASCIZ	"FROZEN!$"
	032257'	471024	400000
	032260'	222330	141500	IM1F:	ASCIZ	"$MAC not set up correctly"
	032261'	673376	420346
	032262'	627504	072740
	032263'	203075	771344
	032264'	627076	466362
	032265'	000000	000000
	032266'	222030	247644	IM20:	ASCIZ	"$ABORTING--available space exceeded"
	032267'	522231	643532
	032270'	267036	660722
	032271'	663034	266312
	032272'	203476	060706
	032273'	625014	574306
	032274'	627134	462710
	032275'	000000	000000
	032276'	623236	361500	IM21:	ASCIZ	"disc area save protected$"
	032277'	607454	560500
	032300'	717036	662500
	032301'	703455	772312
	032302'	617514	562110
	032303'	000000	000000


	032304'			RELAY:				;SEND HEX TO ENGINE
	032304'	335000	006410'		AUXCHK
	032305'	254000	032337'
	032306'	260040	032316'	RELAY0:	PJS	RELAY1
	032307'	200240	000010		MOVE	U,W
	032310'	242240	000004		LSH	U,4
	032311'	260040	032316'		PJS	RELAY1
	032312'	435405	000400		IORI	W,400(U)
	032313'	200200	000010		MOVE	V,W
	032314'	260040	031763'		PJS	SDI
	032315'	254000	032306'		JRST	RELAY0
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-40
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS


	032316'	256000	002272'	RELAY1:	XCT	GCHI
	032317'	275400	000060		SUBI	W,60
	032320'	321400	025722'		JUMPL	W,CR
	032321'	307400	000011		CAIG	W,11
	032322'	263040	000000		RETURN
	032323'	275400	000007		SUBI	W,7
	032324'	307400	000017		CAIG	W,17
	032325'	307400	000011		CAIG	W,11
	032326'	254000	025722'		JRST	CR
	032327'	263040	000000		RETURN

	032330'			RELAYA:				;RELAY ASC FROM TERMINAL TO 732 UNTIL USER ESCAPES
	032330'	335000	006410'		AUXCHK
	032331'	254000	032337'
	032332'	661640	200000	RELAYB:	TLO	F,DCCF		;GET CHARACTERS WITHOUT LINE EDITTING
	032333'	256000	002272'		XCT	GCHI
	032334'	201210	000400		MOVEI	V,400(W)
	032335'	260040	031763'		PJS	SDI
	032336'	254000	032332'		JRST	RELAYB

	032337'	035000	035132'	NOAUX:	TYPE	<$No aux circuit>
	032340'	254000	026124'		JRST	DQUES3

				;	Build an aux circuit.
				;	The command takes two arguments. The first is the number of times
				;	to do the CREAUX before failing. The second is the number of seconds
				;	to wait after the CREAUX fails before executing it again.
				;	Both arguments must be greater than or equal to zero.
				;	If the first argument is zero, the command never stops trying
				;	until the CREAUX succeedds.
				;	If no arguments are, the values used are one try. In this
				;	case the delay time (second argument) is meaningless.
				;	If only one argument is given, thirty seconds is used
				;	for the second argument. If an argument is null, its value is zero.
				;
				;	Abreviated command		Expanded command
				;	__________________		________________
				;		a,;C			      a,0;C
				;		,b;C			      0,b;C
				;		 ,;C			      0,0;C
				;		 a;C			     a,30;C
				;		  ;C			      1,-;C
				;	
	032341'	201400	000001	EC:	MOVEI	W,1		;If no args, set first arg to 1
	032342'	202400	006525'		MOVEM	W,VTAB
	032343'	201400	000036	ECA:	MOVEI	W,^D30		;If no second arg, set it to 30
	032344'	202400	006527'		MOVEM	W,VTAB+2
	032345'	335000	006525'	ECAB:	SKIPGE	VTAB		;Don't allow negative first arg
	032346'	254000	026123'		JRST	DQUES
	032347'	335400	006527'		SKIPGE	W,VTAB+2	;Don't allow negative second arg either
	032350'	254000	026123'		JRST	DQUES
	032351'	322400	032356'		JUMPE	W,EC0		;If no delay, leave it as zero for check
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-41
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	032352'	303400	777777		CAILE	W,777777	;does time fit in right half
	032353'	201400	777777		MOVEI	W,777777	;No. Well make it
	032354'	505400	000001		HRLI	W,1		;Specify delay time is in seconds for HIBER
	032355'	202400	006527'		MOVEM	W,VTAB+2	;Put it back as second arg
	032356'	260040	021763'	EC0:	PJS	BL3		;ESTABLISH CIRCUIT
	032357'	200100	034603'		MOVE	I,[POINT 7,CS]	;READ STRING INTO CS
	032360'	256000	002272'	EC1:	XCT	GCHI
	032361'	306400	000015		CAIN	W,15
	032362'	254000	032373'		JRST	EC2
	032363'	306400	000077		CAIN	W,"?"
	032364'	254000	026123'		JRST	DQUES
	032365'	301400	000141		CAIL	W,"a"
	032366'	303400	000172		CAILE	W,"z"
	032367'	334000	000000		SKIPA
	032370'	275400	000040		SUBI	W,40
	032371'	136400	000002		IDPB	W,I
	032372'	254000	032360'		JRST	EC1
	032373'	620700	000040	EC2:	TRZ	F2,BINMOD	;set initially to ascii mode
	032374'	400400	000000		SETZ	W,
	032375'	136400	000002		IDPB	W,I
	032376'	335440	006410'		SKIPGE	X,CN		;is there another aux circuit?
	032377'	254000	032416'		JRST	EC6		;No
	032400'	476000	006410'		SETOM	CN		;Forget about it
	032401'	200400	000011		MOVE	W,X		;Get old port number
	032402'	505400	007000		HRLI	W,(<.IAZAP>B8)	; and deassign zapper interrupt
	032403'	047400	777736		TINASS	W,
	032404'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	032405'	200400	000011		MOVE	W,X		;Deassign character lost interrupt
	032406'	505400	005000		HRLI	W,(<.IALOS>B8)
	032407'	047400	777736		TINASS	W,
	032410'	260040	025257'		CPF
	032411'	200400	000011		MOVE	W,X		;Also deassign char recv interrupt
	032412'	505400	001000		HRLI	W,(<.IACHR>B8)	;(Assign cause and port to channel 0)
	032413'	047400	777736		TINASS	W,
	032414'	260040	025257'		CPF
	032415'	047440	777733		ZAPCIR	X,		;Zap old aux circuit
	032416'	035000	035136'	EC6:	TYPE	<Working>
	032417'	551400	006504'		HRRZI	W,CS
	032420'	047400	777734		CREAUX	W,
	032421'	254000	032446'		JRST	EC3
	032422'	202400	006410'		MOVEM	W,CN
	032423'	505400	007002		HRLI	W,(<.IAZAP>B8+<ZAPCHN>B17)
	032424'	047400	777736		TINASS	W,		;AUX CIRCUIT ZAPPER INT CHANNEL
	032425'	254000	032506'		JRST	EC5
	032426'	505400	005003		HRLI	W,(<.IALOS>B8+<LOSCHN>B17)	;Aux circuit char lost int
	032427'	540400	006410'		HRR	W,CN
	032430'	047400	777736		TINASS	W,
	032431'	254000	032506'		JRST	EC5
	032432'	505400	001004		HRLI	W,(<.IACHR>B8+<CHRCHN>B17)
	032433'	540400	006410'		HRR	W,CN
	032434'	047400	777736		TINASS	W,		;AUX CHAR RECEIVED INT CHANNEL
	032435'	254000	032506'		JRST	EC5
	032436'	035000	035140'		TYPE	<$Circuit ready>
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-42
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	032437'	205400	560000		MOVSI	W,(1B0+1B<ZAPCHN>+1B<LOSCHN>+1B<CHRCHN>)
	032440'	047400	777744		INTENB	W,		;ENABLE AUX INTERRUPTS
	032441'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	032442'	205400	420000		MOVSI	W,(1B0+1B<CHRCHN>)
	032443'	047400	777743		INTACT	W,		;FIRE UP CHAR RCVD INTERRUPT
	032444'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	032445'	254000	025722'		JRST	CR

	032446'	607400	777777	EC3:	TLNN	W,777777	;Supervisor error?
	032447'	254000	032452'		JRST	EC4		;Yes
	032450'	554400	000010		HLRZ	W,W		;System error. Get error code.
	032451'	271400	000007		ADDI	W,7
	032452'	301400	000017	EC4:	CAIL	W,17		;Is it a known error?
	032453'	400400	000000		SETZ	W,		;No.
	032454'	035000	035143'		TYPE	<*** >
	032455'	200410	032467'		MOVE	W,CAXERR(W)	;Get error message address.
	032456'	260040	021767'		PJS	TYPEM		;Type error message
	032457'	260040	021750'		PJS	TYPEOL
	032460'	376000	006525'		SOSN	VTAB		;Try again?
	032461'	254000	026124'		JRST	DQUES3		;No. Exit
	032462'	337400	006527'		SKIPG	W,VTAB+2	;Is there a delay before calling CREAUX again?
	032463'	254000	032416'		JRST	EC6		;No. Go do it
	032464'	047400	000072		HIBER	W,		;Sleep awile
	032465'	260040	025257'		CPF			;REPORT ASSEMBLER INTERNAL ERROR
	032466'	254000	032416'		JRST	EC6		;Now go try again

	032467'	000000	035144'	CAXERR:	[ASCIZ	"Unknown error"]				; ?,,?
	032470'	000000	035147'		[ASCIZ	"Bad name format"]				; 0,,1
	032471'	000000	035153'		[ASCIZ	"Name not in MUD"]				; 0,,2
	032472'	000000	035157'		[ASCIZ	"Bad MUD"]					; 0,,3
	032473'	000000	035161'		[ASCIZ	"System not available"]				; 0,,4
	032474'	000000	035166'		[ASCIZ	"Down line load or deal out request failure"]	; 0,,5
	032475'	000000	035177'		[ASCIZ	"Time out"]					; 0,,6
	032476'	000000	035201'		[ASCIZ	"Access not permitted"]				; 0,,7
	032477'	000000	035206'		[ASCIZ	"Too many curcuits"]				; 1,,?
	032500'	000000	035212'		[ASCIZ	"Bad user name"]				; 2,,?
	032501'	000000	035215'		[ASCIZ	"Out of channels"]				; 3,,?
	032502'	000000	035221'		[ASCIZ	"No response to request"]			; 4,,?
	032503'	000000	035226'		[ASCIZ	"No response to string"]			; 5,,?
	032504'	000000	035233'		[ASCIZ	"No curcuit established"]			; 6,,?
	032505'	000000	035240'		[ASCIZ	"Error response to request"]			; 7,,?

	032506'	035000	035246'	EC5:	TYPE	<*** Cannot assign interrupts to curcuit.>
	032507'	477400	006410'	CDQUES:	SETOB	W,CN		;HERE IF AUX CIRC SETUP BOMBS
	032510'	047400	777733		ZAPCIR	W,		;ZAP ALL AUX CIRCUITS
	032511'	035000	035257'		TYPE	< Curcuit zapped.$>
	032512'	254000	026124'		JRST	DQUES3

	032513'	202300	006445'	STDTOM:	MOVEM	VS,DTOM
	032514'	202300	006443'	STTOM:	MOVEM	VS,TOM
	032515'	260040	021763'	STTOM1:	PJS	BL3
	032516'	254000	025724'		JRST	CR2

NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 17-43
NAD01.R06	24-JUL-87 17:39		DEBUGGER COMMANDS

	032517'	202300	006446'	STDCOS:	MOVEM	VS,DCOS
	032520'	202300	006444'	STCOS:	MOVEM	VS,COS
	032521'	254000	032515'		JRST	STTOM1
	032522'	202300	006446'	STDC1:	MOVEM	VS,DCOS
	032523'	200200	006525'		MOVE	V,VTAB
	032524'	201400	000004		MOVEI	W,4
	032525'	332000	006444'		SKIPE	COS
	032526'	201400	000010		MOVEI	W,10
	032527'	202200	006452'		MOVEM	V,DNCLM
	032530'	202400	006451'		MOVEM	W,DWCLM
	032531'	254000	032536'		JRST	STC1A
	032532'	200200	006525'	STC1:	MOVE	V,VTAB
	032533'	201400	000004		MOVEI	W,4
	032534'	332000	006444'		SKIPE	COS
	032535'	201400	000010		MOVEI	W,10
	032536'	202300	006444'	STC1A:	MOVEM	VS,COS
	032537'	202200	006450'		MOVEM	V,NCLM
	032540'	202400	006447'		MOVEM	W,WCLM
	032541'	254000	032515'		JRST	STTOM1
	032542'	202300	006446'	STDC2:	MOVEM	VS,DCOS
	032543'	200400	006525'		MOVE	W,VTAB
	032544'	200200	006527'		MOVE	V,VTAB+2
	032545'	202200	006452'		MOVEM	V,DNCLM
	032546'	202400	006451'		MOVEM	W,DWCLM
	032547'	254000	032552'		JRST	STC2A
	032550'	200400	006525'	STC2:	MOVE	W,VTAB
	032551'	200200	006527'		MOVE	V,VTAB+2
	032552'	202300	006444'	STC2A:	MOVEM	VS,COS
	032553'	202200	006450'		MOVEM	V,NCLM
	032554'	202400	006447'		MOVEM	W,WCLM
	032555'	254000	032515'		JRST	STTOM1
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 18
NAD01.R06	24-JUL-87 17:39		COMMAND TABLES AND ERROR MESSAGES

					SUBTTL	COMMAND TABLES AND ERROR MESSAGES
				;		**************************************************


	032556'	321000	000000	CATAB:	POINT	8,0,9
	032557'	221000	000000		POINT	8,0,17
	032560'	101000	000000		POINT	8,0,27
	032561'	001000	000000		POINT	8,0,35
	032562'	222000	000000	CATABH:	POINT	16,0,17
	032563'	000000	000000		0
	032564'	002000	000000		POINT	16,0,35
	032565'	000000	000000		0
	032566'	222200	000000	CATABK:	POINT	18,0,17
	032567'	000000	000000		0
	032570'	002200	000000		POINT	18,0,35
	032571'	000000	000000		0

	032572'	000000	000060	HEX:	EXP	60,61,62,63,64,65,66,67,70,71,101,102,103,104,105,106
	032573'	000000	000061
	032574'	000000	000062
	032575'	000000	000063
	032576'	000000	000064
	032577'	000000	000065
	032600'	000000	000066
	032601'	000000	000067
	032602'	000000	000070
	032603'	000000	000071
	032604'	000000	000101
	032605'	000000	000102
	032606'	000000	000103
	032607'	000000	000104
	032610'	000000	000105
	032611'	000000	000106
	032612'	000000	000020	HEX6:	EXP	20,21,22,23,24,25,26,27,30,31,41,42,43,44,45,46
	032613'	000000	000021
	032614'	000000	000022
	032615'	000000	000023
	032616'	000000	000024
	032617'	000000	000025
	032620'	000000	000026
	032621'	000000	000027
	032622'	000000	000030
	032623'	000000	000031
	032624'	000000	000041
	032625'	000000	000042
	032626'	000000	000043
	032627'	000000	000044
	032630'	000000	000045
	032631'	000000	000046

			000044	XBITN==44
				LBIT:	REPEAT	44,<XBITN==XBITN-1
					EXP	1_XBITN>
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 18-2
NAD01.R06	24-JUL-87 17:39		COMMAND TABLES AND ERROR MESSAGES

	032632'	400000	000000
	032633'	200000	000000
	032634'	100000	000000
	032635'	040000	000000
	032636'	020000	000000
	032637'	010000	000000
	032640'	004000	000000
	032641'	002000	000000
	032642'	001000	000000
	032643'	000400	000000
	032644'	000200	000000
	032645'	000100	000000
	032646'	000040	000000
	032647'	000020	000000
	032650'	000010	000000
	032651'	000004	000000
	032652'	000002	000000
	032653'	000001	000000
	032654'	000000	400000
	032655'	000000	200000
	032656'	000000	100000
	032657'	000000	040000
	032660'	000000	020000
	032661'	000000	010000
	032662'	000000	004000
	032663'	000000	002000
	032664'	000000	001000
	032665'	000000	000400
	032666'	000000	000200
	032667'	000000	000100
	032670'	000000	000040
	032671'	000000	000020
	032672'	000000	000010
	032673'	000000	000004
	032674'	000000	000002
	032675'	000000	000001
				RBIT:	REPEAT	44,<EXP 1_XBITN
					XBITN==XBITN+1>
	032676'	000000	000001
	032677'	000000	000002
	032700'	000000	000004
	032701'	000000	000010
	032702'	000000	000020
	032703'	000000	000040
	032704'	000000	000100
	032705'	000000	000200
	032706'	000000	000400
	032707'	000000	001000
	032710'	000000	002000
	032711'	000000	004000
	032712'	000000	010000
	032713'	000000	020000
	032714'	000000	040000
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 18-3
NAD01.R06	24-JUL-87 17:39		COMMAND TABLES AND ERROR MESSAGES

	032715'	000000	100000
	032716'	000000	200000
	032717'	000000	400000
	032720'	000001	000000
	032721'	000002	000000
	032722'	000004	000000
	032723'	000010	000000
	032724'	000020	000000
	032725'	000040	000000
	032726'	000100	000000
	032727'	000200	000000
	032730'	000400	000000
	032731'	001000	000000
	032732'	002000	000000
	032733'	004000	000000
	032734'	010000	000000
	032735'	020000	000000
	032736'	040000	000000
	032737'	100000	000000
	032740'	200000	000000
	032741'	400000	000000

				;	CT - CHARACTER TYPE TABLE.


					DEFINE	NCW (NCWN,NCWA),<REPEAT	NCWN,<XWD	.-CT,NCWA>>
					DEFINE	CW (CWA),<IRP	CWA,<CX CWA>>
					DEFINE	CX (CXA),<CW2	CXA>
					DEFINE	CW2 (CW2R,CW2L),<XWD	CW2L,CW2R>

	032742'			CT:
	032742'	000000	000000		NCW	1,IT				;NULL (INPUT TRAP CHARACTER)
	032743'	000000	000015		CW	<<MA>,<AE>,<EM>>		;MACRO ARG, MACRO ARG END, MACRO END
	032744'	000000	000016
	032745'	000000	000013
	032746'	000004	000001		NCW	5,OH				; ^D - ^H
	032747'	000005	000001
	032750'	000006	000001
	032751'	000007	000001
	032752'	000010	000001
	032753'	000001	000011		CW	<<DE,TAB>,<DE,SEMIC>>		; ^I, ^J
	032754'	000012	000011
	032755'	000013	000001		NCW	1,OH				; ^K
	032756'	000013	000011		CW	<<DE,CAR>>			; ^L <FF>
	032757'	000013	000011		CW	<<DE,CAR>>			; ^M <CR>
	032760'	000016	000001		NCW	22,OH				; ^N - ^Z, ESC, FS, GS, RS, US
	032761'	000017	000001
	032762'	000020	000001
	032763'	000021	000001
	032764'	000022	000001
	032765'	000023	000001
	032766'	000024	000001
	032767'	000025	000001
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 18-4
NAD01.R06	24-JUL-87 17:39		COMMAND TABLES AND ERROR MESSAGES

	032770'	000026	000001
	032771'	000027	000001
	032772'	000030	000001
	032773'	000031	000001
	032774'	000032	000001
	032775'	000033	000001
	032776'	000034	000001
	032777'	000035	000001
	033000'	000036	000001
	033001'	000037	000001
	033002'	000000	000011		CW	<<DE,BLA>,<OP,EXCL>>		;BLANK, !
	033003'	000011	000010
	033004'	000042	000001		NCW	2,OH				; " #
	033005'	000043	000001
	033006'	000003	000011		CW	<<DE,DOL>,<OP,PERC>,<OP,AMP>>	; $ % &
	033007'	000012	000010
	033010'	000010	000010
	033011'	000047	000001		NCW	1,OH				; '
	033012'	000004	000011		CW	<<DE,LPAREN>,<DE,RPAREN>>	; ( )
	033013'	000005	000011
	033014'	000006	000010		CW	<<OP,STAR>,<OP,BPLU>,<DE,COM>> 	; * + ,
	033015'	000004	000010
	033016'	000002	000011
	033017'	000005	000010		CW	<<OP,BMIN>,<PE>,<OP,SLASH>> 	; - . /
	033020'	000000	000007
	033021'	000007	000010
	033022'	000060	000002		NCW	12,DIG				; 0 - 9
	033023'	000061	000002
	033024'	000062	000002
	033025'	000063	000002
	033026'	000064	000002
	033027'	000065	000002
	033030'	000066	000002
	033031'	000067	000002
	033032'	000070	000002
	033033'	000071	000002
	033034'	000011	000011		CW	<<DE,COLON>,<DE,SEMIC>>		; : ;
	033035'	000012	000011
	033036'	000074	000001		NCW	1,OH				; <
	033037'	000006	000011		CW	<<DE,EQSIGN>>			; =
	033040'	000076	000001		NCW	2,OH				; > ?
	033041'	000077	000001
	033042'	000000	000010		CW	<<OP,UAT>>			; @
	033043'	000101	000003		NCW	6,UAF				; A-F
	033044'	000102	000003
	033045'	000103	000003
	033046'	000104	000003
	033047'	000105	000003
	033050'	000106	000003
	033051'	000107	000005		NCW	24,UGZ				; G-Z
	033052'	000110	000005
	033053'	000111	000005
	033054'	000112	000005
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 18-5
NAD01.R06	24-JUL-87 17:39		COMMAND TABLES AND ERROR MESSAGES

	033055'	000113	000005
	033056'	000114	000005
	033057'	000115	000005
	033060'	000116	000005
	033061'	000117	000005
	033062'	000120	000005
	033063'	000121	000005
	033064'	000122	000005
	033065'	000123	000005
	033066'	000124	000005
	033067'	000125	000005
	033070'	000126	000005
	033071'	000127	000005
	033072'	000130	000005
	033073'	000131	000005
	033074'	000132	000005
	033075'	000007	000011		CW	<<DE,LBRAK>>			; [
	033076'	000001	000010		CW	<<OP,UBSLH>>			; \
	033077'	000010	000011		CW	<<DE,RBRAK>,<OP,UPAR>>		; ] ^
	033100'	000013	000010
	033101'	000137	000001		NCW	1,OH				; _
	033102'	000000	000014		CW	<<CO>>				; `
	033103'	000141	000004		NCW	6,LAF				; a-f
	033104'	000142	000004
	033105'	000143	000004
	033106'	000144	000004
	033107'	000145	000004
	033110'	000146	000004
	033111'	000147	000006		NCW	24,LGZ				; g-z
	033112'	000150	000006
	033113'	000151	000006
	033114'	000152	000006
	033115'	000153	000006
	033116'	000154	000006
	033117'	000155	000006
	033120'	000156	000006
	033121'	000157	000006
	033122'	000160	000006
	033123'	000161	000006
	033124'	000162	000006
	033125'	000163	000006
	033126'	000164	000006
	033127'	000165	000006
	033130'	000166	000006
	033131'	000167	000006
	033132'	000170	000006
	033133'	000171	000006
	033134'	000172	000006
	033135'	000173	000001		NCW	1,OH				; {
	033136'	000012	000012		CW	<<VB,VB>>			; |
	033137'	000175	000001		NCW	3,OH				; } ~ DEL
	033140'	000176	000001
	033141'	000177	000001
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 18-6
NAD01.R06	24-JUL-87 17:39		COMMAND TABLES AND ERROR MESSAGES


					PURGE	NCW,CW,CX,CW2


				;	CT0 - CT2  DEBUGGER COMMAND TABLES.
				;
				;	CM0 = 1 IF 0 ARGS ALLOWED
				;	CM1 = 1 IF 1 ARG  ALLOWED
				;	CM2 = 1 IF 2 ARGS ALLOWED
				;	CM3 = 1 IF >2 ARGS ALLOWED
				;	CMCHR = 7 BIT ASCII VALUE OF COMMAND CHARACTER
				;	CMVSW = 1 IF TO ASSEMBLE ARGUMENTS INTO NUMERIC VALUE
				;	CMDATA = VALUE TO PASS TO PROCESSOR IN REGISTER VS

					DEFINE	CM (CM0,CM1,CM2,CM3,CMCHR,CMVSW,CMDATA,CMADR0,CMADR1,CMADR2),<
					XWD	CM0_21+CM1_20+CM2_17+CM3_16+CMVSW_15+CMDATA_7&17_7+CMCHR,CMADR0
					XWD	CMADR1,CMADR2>

				;	CT0 - COMMAND TABLE, FIRST CHARACTER PROCESSING.

	033142'			CT0:
	033142'	740077	026121'		CM	1,1,1,1,77,0,0,DQUES1,DQUES1,DQUES1	;	?
	033143'	026121'	026121'
	033144'	760015	030677'		CM	1,1,1,1,15,1,0,CRET0,CRET1,CRETP	;	CAR.RET.
	033145'	030706'	030717'
	033146'	760012	030760'		CM	1,1,1,1,12,1,0,LF0,LF1,LFP		;	L.F.
	033147'	030754'	030776'
	033150'	740054	026703'		CM	1,1,1,1,54,0,0,KCOMMA,KCOMMA,KCOMMA	;	,
	033151'	026703'	026703'
	033152'	723734	031005'		CM	1,1,1,0,134,1,-1,SL0,SL1,SL2		;	\
	033153'	031010'	031022'
	033154'	720133	031005'		CM	1,1,1,0,133,1,0,SL0,SL1,SL2		;	[
	033155'	031010'	031022'
	033156'	721135	031005'		CM	1,1,1,0,135,1,4,SL0,SL1,SL2		;	]
	033157'	031010'	031022'
	033160'	623675	031131'		CM	1,1,0,0,75,1,-1,EQ01,EQ01,DQUES1	;	=
	033161'	031131'	026121'
	033162'	620043	031131'		CM	1,1,0,0,43,1,0,EQ01,EQ01,DQUES1		;	#
	033163'	031131'	026121'
	033164'	620737	031131'		CM	1,1,0,0,137,1,3,EQ01,EQ01,DQUES1	;	_
	033165'	031131'	026121'
	033166'	620042	030730'		CM	1,1,0,0,42,1,0,QUOTE,QUOTE1,DQUES1	;	"
	033167'	030726'	026121'
	033170'	740472	030632'		CM	1,1,1,1,72,0,2,SCPC,COLONC,SCPC		;	:
	033171'	030721'	030632'
	033172'	740073	030632'		CM	1,1,1,1,73,0,0,SCPC,SCPC,SCPC		;	;
	033173'	030632'	030632'
	033174'	740245	030632'		CM	1,1,1,1,45,0,1,SCPC,SCPC,SCPC		;	%
	033175'	030632'	030632'
	033176'	400001	031313'		CM	1,0,0,0,01,0,0,IC,IC3,CR1		;	CONTROL A (INIT MAC)
	033177'	031335'	025723'
	033200'	400002	031313'		CM	1,0,0,0,02,0,0,IC,CR3,IC4		;	CONTROL B (SET BP)
	033201'	025735'	031346'
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 18-7
NAD01.R06	24-JUL-87 17:39		COMMAND TABLES AND ERROR MESSAGES

	033202'	400005	031716'		CM	1,0,0,0,05,0,0,ICE,CR3,IC4		;	CONTROL E (RR CMND)
	033203'	025735'	031346'
	033204'	400006	031727'		CM	1,0,0,0,06,0,0,ICF,CR3,ICWR1		;	CONTROL F (WRITE 1 REG)
	033205'	025735'	031750'
	033206'	400007	031313'		CM	1,0,0,0,07,0,0,IC,CR3,IC4		;	CONTROL G
	033207'	025735'	031346'
	033210'	400010	031313'		CM	1,0,0,0,10,0,0,IC,IC3,CR1		;	CONTROL H
	033211'	031335'	025723'
	033212'	400011	031313'		CM	1,0,0,0,11,0,0,IC,IC3,CR1		;	CONTROL I
	033213'	031335'	025723'
	033214'	400013	031313'		CM	1,0,0,0,13,0,0,IC,CR3,IC4		;	CONTROL K
	033215'	025735'	031346'
	033216'	400014	031313'		CM	1,0,0,0,14,0,0,IC,CR3,IC4		;	CONTROL L
	033217'	025735'	031346'
	033220'	400016	031312'		CM	1,0,0,0,16,0,0,ICM,CR3,IC4		;	CONTROL N (USED FOR M CMND)
	033221'	025735'	031346'
	033222'	400020	031313'		CM	1,0,0,0,20,0,0,IC,IC3,CR1		;	CONTROL P
	033223'	031335'	025723'
	033224'	400021	031673'		CM	1,0,0,0,21,0,0,ICN,IC3,CR1		;	CONTROL Q (NEXT)
	033225'	031335'	025723'
	033226'	400022	031313'		CM	1,0,0,0,22,0,0,IC,CR3,IC4		;	CONTROL R
	033227'	025735'	031346'
	033230'	400023	031313'		CM	1,0,0,0,23,0,0,IC,CR3,IC4		;	CONTROL S
	033231'	025735'	031346'
	033232'	400024	031313'		CM	1,0,0,0,24,0,0,IC,IC3,CR1		;	CONTROL T
	033233'	031335'	025723'
	033234'	400025	031313'		CM	1,0,0,0,25,0,0,IC,CR3,IC4		;	CONTROL U
	033235'	025735'	031346'
	033236'	400027	031423'		CM	1,0,0,0,27,0,0,ICW1,CR3,ICW2		;	CONTROL W
	033237'	025735'	031432'
	033240'	400030	031313'		CM	1,0,0,0,30,0,0,IC,CR3,IC4		;	CONTROL X
	033241'	025735'	031346'
	033242'	400032	031757'		CM	1,0,0,0,32,0,0,ICZ,IC3,CR1		;	CONTROL Z
	033243'	031335'	025723'
	033244'	000000	000000		Z



				;	CT1 - COMMAND TABLE, SECOND CHARACTER, AFTER A ;.

	033245'	620101	026707'	CT1:	CM	1,1,0,0,101,1,0,AF,SETFCS,DQUES1	;	;A
	033246'	030624'	026121'
	033247'	720103	032341'		CM	1,1,1,0,103,1,0,EC,ECA,ECAB		;	;C
	033250'	032343'	032345'
	033251'	740113	026123'		CM	1,1,1,1,113,0,0,DQUES,KILSYM,DQUES	;	;K
	033252'	030345'	026123'
	033253'	400105	031313'		CM	1,0,0,0,105,0,0,IC,IC3,CR1		;	;E
	033254'	031335'	025723'
	033255'	620106	026753'		CM	1,1,0,0,106,1,0,IBF,IBF,DQUES		;	;F
	033256'	026753'	026123'
	033257'	760107	027067'		CM	1,1,1,1,107,1,0,GIB0,GIB1,GIB2		;	;G
	033260'	027071'	027074'
	033261'	620130	030521'		CM	1,1,0,0,130,1,0,SETCMD,SETCMD,DQUES1	;	;X
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 18-8
NAD01.R06	24-JUL-87 17:39		COMMAND TABLES AND ERROR MESSAGES

	033262'	030521'	026121'
	033263'	400115	032514'		CM	1,0,0,0,115,0,0,STTOM,DQUES1,DQUES1	;	;M
	033264'	026121'	026121'
	033265'	400316	032514'		CM	1,0,0,0,116,0,1,STTOM,DQUES1,DQUES1	;	;N
	033266'	026121'	026121'
	033267'	760120	027466'		CM	1,1,1,1,120,1,0,PIB0,PIB1,PIB2		;	;P
	033270'	027507'	027512'
	033271'	400442	032514'		CM	1,0,0,0,42,0,2,STTOM,DQUES1,DQUES1	;	;"
	033272'	026121'	026121'
	033273'	400723	032514'		CM	1,0,0,0,123,0,3,STTOM,DQUES1,DQUES1	;	;S
	033274'	026121'	026121'
	033275'	401111	032514'		CM	1,0,0,0,111,0,4,STTOM,DQUES1,DQUES1	;	;I
	033276'	026121'	026121'
	033277'	620122	032304'		CM	1,1,0,0,122,1,0,RELAY,SETRLY,DQUES	;	;R
	033300'	030627'	026123'
	033301'	220124	026123'		CM	0,1,0,0,124,1,0,DQUES,TIB,DQUES		;	;T
	033302'	027676'	026123'
	033303'	623536	030760'		CM	1,1,0,0,136,1,-2,LF0,LF1,DQUES1		;	;^
	033304'	030754'	026121'
	033305'	403734	031010'		CM	1,0,0,0,134,0,-1,SL1,DQUES1,DQUES1	;	;\
	033306'	026121'	026121'
	033307'	400133	031010'		CM	1,0,0,0,133,0,0,SL1,DQUES1,DQUES1	;	;[
	033310'	026121'	026121'
	033311'	401135	031010'		CM	1,0,0,0,135,0,4,SL1,DQUES1,DQUES1	;	;]
	033312'	026121'	026121'
	033313'	160467	026123'		CM	0,0,1,1,67,1,2,DQUES,DQUES,LI		;	;7
	033314'	026123'	031151'
	033315'	161270	026123'		CM	0,0,1,1,70,1,5,DQUES,DQUES,LI		;	;8
	033316'	026123'	031151'
	033317'	720062	032520'		CM	1,1,1,0,62,1,0,STCOS,STC1,STC2		;	;2
	033320'	032532'	032550'
	033321'	723664	032520'		CM	1,1,1,0,64,1,-1,STCOS,STC1,STC2		;	;4
	033322'	032532'	032550'
	033323'	620100	026707'		CM	1,1,0,0,100,1,0,AF,SETFCS,DQUES1	;	;@ (OLD FORM OF ;A)
	033324'	030624'	026121'
	033325'	700045	030403'		CM	1,1,1,0,45,0,0,SETLS0,SETLS2,SETLS2	;	;%
	033326'	030410'	030410'
	033327'	700050	030441'		CM	1,1,1,0,50,0,0,BCREF0,BCREF1,BCREF2	;	;(
	033330'	030444'	030447'
	033331'	420051	030514'		CM	1,0,0,0,51,1,0,ECREF,DQUES1,DQUES1	;	;)
	033332'	026121'	026121'
	033333'	760073	030667'		CM	1,1,1,1,73,1,0,CCOMNT,CCOMNT,CCOMNT	;	;;
	033334'	030667'	030667'
	033335'	000000	000000		Z


				;	CT2 - COMMAND TABLE, SECOND CHARACTER, AFTER A %.

	033336'	400301	026707'	CT2:	CM	1,0,0,0,101,0,1,AF,DQUES1,DQUES1	;	%A
	033337'	026121'	026121'
	033340'	620306	026753'		CM	1,1,0,0,106,1,1,IBF,IBF,DQUES		;	%F
	033341'	026753'	026123'
	033342'	400115	032513'		CM	1,0,0,0,115,0,0,STDTOM,DQUES1,DQUES1	;	%M
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 18-9
NAD01.R06	24-JUL-87 17:39		COMMAND TABLES AND ERROR MESSAGES

	033343'	026121'	026121'
	033344'	400316	032513'		CM	1,0,0,0,116,0,1,STDTOM,DQUES1,DQUES1	;	%N
	033345'	026121'	026121'
	033346'	400122	032330'		CM	1,0,0,0,122,0,0,RELAYA,DQUES1,DQUES1	;	%R
	033347'	026121'	026121'
	033350'	400442	032513'		CM	1,0,0,0,42,0,2,STDTOM,DQUES1,DQUES1	;	%"
	033351'	026121'	026121'
	033352'	400723	032513'		CM	1,0,0,0,123,0,3,STDTOM,DQUES1,DQUES1	;	%S
	033353'	026121'	026121'
	033354'	401111	032513'		CM	1,0,0,0,111,0,4,STDTOM,DQUES1,DQUES1	;	%I
	033355'	026121'	026121'
	033356'	160467	026123'		CM	0,0,1,1,67,1,2,DQUES,DQUES,LIBOOT	;	%7
	033357'	026123'	031150'
	033360'	161270	026123'		CM	0,0,1,1,70,1,5,DQUES,DQUES,LIBOOT	;	%8
	033361'	026123'	031150'
	033362'	720062	032517'		CM	1,1,1,0,62,1,0,STDCOS,STDC1,STDC2	;	%2
	033363'	032522'	032542'
	033364'	723664	032517'		CM	1,1,1,0,64,1,-1,STDCOS,STDC1,STDC2	;	%4
	033365'	032522'	032542'
	033366'	400300	026707'		CM	1,0,0,0,100,0,1,AF,DQUES1,DQUES1	;	%@ (OLD FORM OF %A)
	033367'	026121'	026121'
	033370'	740121	016774'		CM	1,1,1,1,121,0,0,NADEX,NADEX,NADEX	;	%Q
	033371'	016774'	016774'
	033372'	740134	030661'		CM	1,1,1,1,134,0,0,PBS,PBS,PBS		;	%\
	033373'	030661'	030661'
	033374'	742703	030647'		CM	1,1,1,1,103,0,-5,PCPO,PCPO,PCPO		;	%C
	033375'	030647'	030647'
	033376'	741717	030647'		CM	1,1,1,1,117,0,7,PCPO,PCPO,PCPO		;	%O
	033377'	030647'	030647'
	033400'	600107	030140'		CM	1,1,0,0,107,0,0,GSIB0,GSIB1,DQUES	;	%G
	033401'	030134'	026123'
	033402'	600120	027725'		CM	1,1,0,0,120,0,0,PSIB0,PSIB1,DQUES	;	%P
	033403'	027714'	026123'
	033404'	620130	030575'		CM	1,1,0,0,130,1,0,RSTCMD,RSTCMD,DQUES1	;	%X
	033405'	030575'	026121'
	033406'	400126	030606'		CM	1,0,0,0,126,0,0,PRTVER,DQUES1,DQUES1	;	%V
	033407'	026121'	026121'
	033410'	620132	027451'		CM	1,1,0,0,132,1,0,MSIB0,MSIB1,DQUES	;	%Z
	033411'	027452'	026123'
	033412'	000000	000000		Z


				;	CT3 - COMMAND TABLE, SECOND CHARACTER, AFTER A :.

	033413'	400101	031313'	CT3:	CM	1,0,0,0,101,0,0,IC,IC3,CR1		;	:A
	033414'	031335'	025723'
	033415'	400102	031313'		CM	1,0,0,0,102,0,0,IC,CR3,IC4		;	:B
	033416'	025735'	031346'
	033417'	400105	031313'		CM	1,0,0,0,105,0,0,IC,IC3,CR1		;	:E
	033420'	031335'	025723'
	033421'	400107	031313'		CM	1,0,0,0,107,0,0,IC,CR3,IC4		;	:G
	033422'	025735'	031346'
	033423'	400110	031313'		CM	1,0,0,0,110,0,0,IC,IC3,CR1		;	:H
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 18-10
NAD01.R06	24-JUL-87 17:39		COMMAND TABLES AND ERROR MESSAGES

	033424'	031335'	025723'
	033425'	400111	031313'		CM	1,0,0,0,111,0,0,IC,IC3,CR1		;	:I
	033426'	031335'	025723'
	033427'	400113	031313'		CM	1,0,0,0,113,0,0,IC,CR3,IC4		;	:K
	033430'	025735'	031346'
	033431'	400114	031313'		CM	1,0,0,0,114,0,0,IC,CR3,IC4		;	:L
	033432'	025735'	031346'
	033433'	400115	031313'		CM	1,0,0,0,115,0,0,IC,CR3,IC4		;	:M
	033434'	025735'	031346'
	033435'	400116	031313'		CM	1,0,0,0,116,0,0,IC,IC3,CR1		;	:N
	033436'	031335'	025723'
	033437'	400120	031313'		CM	1,0,0,0,120,0,0,IC,IC3,CR1		;	:P
	033440'	031335'	025723'
	033441'	400122	031676'		CM	1,0,0,0,122,0,0,ICR,CR3,IC4		;	:R OR :RR
	033442'	025735'	031346'
	033443'	400123	031313'		CM	1,0,0,0,123,0,0,IC,CR3,IC4		;	:S
	033444'	025735'	031346'
	033445'	400124	031313'		CM	1,0,0,0,124,0,0,IC,IC3,CR1		;	:T
	033446'	031335'	025723'
	033447'	400125	031313'		CM	1,0,0,0,125,0,0,IC,CR3,IC4		;	:U
	033450'	025735'	031346'
	033451'	400126	031313'		CM	1,0,0,0,126,0,0,IC,CR3,IC4		;	:V
	033452'	025735'	031346'
	033453'	760127	031375'		CM	1,1,1,1,127,1,0,ICW,ICW1,ICW1		;	:W OR :WR
	033454'	031423'	031423'
	033455'	400130	031313'		CM	1,0,0,0,130,0,0,IC,CR3,IC4		;	:X
	033456'	025735'	031346'
	033457'	400131	031313'		CM	1,0,0,0,131,0,0,IC,CR3,IC4		;	:Y
	033460'	025735'	031346'
	033461'	400132	031757'		CM	1,0,0,0,132,0,0,ICZ,IC3,CR1		;	:Z
	033462'	031335'	025723'
	033463'	400072	031354'		CM	1,0,0,0,072,0,0,ICRLY,CR3,IC4		;	::
	033464'	025735'	031346'
	033465'	740134	030661'		CM	1,1,1,1,134,0,0,PBS,PBS,PBS		;	:\
	033466'	030661'	030661'
	033467'	000000	000000		Z

					PURGE	CM



				;	ERROR MESSAGE TEXTS.
	033470'	523375	720332	MTMO:	ASCIZ	"Too many operands for opcode"
	033471'	607357	120336
	033472'	703136	260734
	033473'	623464	063336
	033474'	711015	770306
	033475'	677114	500000
	033476'	467034	371336	MMNIU:	ASCIZ	"Macro name in use"
	033477'	203354	166712
	033500'	203235	620352
	033501'	717120	000000
	033502'	523375	720332	MTMMA:	ASCIZ	"Too many arguments in macro definition"
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 18-11
NAD01.R06	24-JUL-87 17:39		COMMAND TABLES AND ERROR MESSAGES

	033503'	607357	120302
	033504'	713176	566712
	033505'	673516	320322
	033506'	671015	560706
	033507'	713364	062312
	033510'	633235	664750
	033511'	647375	600000
	033512'	517134	766712	MSSNOR:	ASCIZ	"Segment number out of range"
	033513'	673504	067352
	033514'	667054	571100
	033515'	677536	420336
	033516'	631016	260734
	033517'	637120	000000
	033520'	447356	660730	MSIORG:	ASCIZ	"Invalid origin field or origin not followed by a comma"
	033521'	647104	067744
	033522'	647175	167100
	033523'	633234	566310
	033524'	203376	220336
	033525'	713234	764734
	033526'	203355	772100
	033527'	633375	466336
	033530'	737134	420304
	033531'	745014	120306
	033532'	677335	560400
	033533'	517375	562500	MSSD:	ASCIZ	"Some displ. fld expressions using this label def. are out of range"
	033534'	623236	370330
	033535'	271014	666310
	033536'	203137	070344
	033537'	627476	364736
	033540'	673464	072746
	033541'	647354	720350
	033542'	643236	320330
	033543'	607054	566100
	033544'	623134	627100
	033545'	607454	520336
	033546'	727504	067714
	033547'	203454	167316
	033550'	624000	000000
	033551'	463236	372322	MSLFF:	ASCIZ	"Listing file failure"
	033552'	673164	063322
	033553'	663124	063302
	033554'	647316	571312
	033555'	000000	000000
	033556'	315544	066736	MS36MI:	ASCIZ	"36 modules in use. Limit exceeded"
	033557'	623535	462746
	033560'	203235	620352
	033561'	717125	620230
	033562'	647335	172100
	033563'	627614	362712
	033564'	623134	400000
	033565'	467374	472730	MSMNI:	ASCIZ	"Module name invalid"
	033566'	625015	660732
	033567'	625015	167354
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 18-12
NAD01.R06	24-JUL-87 17:39		COMMAND TABLES AND ERROR MESSAGES

	033570'	607315	162000
	033571'	406470	320334	MSANPT:	ASCIZ	"ASC not properly terminated"
	033572'	677504	070344
	033573'	677414	571330
	033574'	745016	462744
	033575'	667235	660750
	033576'	627100	000000
	033577'	447336	071336	MSIH:	ASCIZ	"Improper hex"
	033600'	703136	220320
	033601'	627600	000000
	033602'	477414	571302	MSOOR:	ASCIZ	"Operand out of range"
	033603'	673104	067752
	033604'	721015	763100
	033605'	713035	663712
	033606'	000000	000000
	033607'	467236	371722	MSMOF:	ASCIZ	"Missing operand field"
	033610'	673164	067740
	033611'	627454	167310
	033612'	203155	162730
	033613'	620000	000000
	033614'	407476	362732	MSAIUM:	ASCIZ	"Assembling into used memory"
	033615'	613315	167316
	033616'	203235	672336
	033617'	203536	362710
	033620'	203334	566736
	033621'	713620	000000
	033622'	473376	420312	MSNEP:	ASCIZ	"Not enough preceeding IF statements"
	033623'	673376	563720
	033624'	203416	262706
	033625'	627134	464734
	033626'	635011	143100
	033627'	717514	172312
	033630'	667135	672346
	033631'	000000	000000
	033632'	523375	720332	MSTMI:	ASCIZ	"Too many IFs. Nesting max = 36"
	033633'	607357	120222
	033634'	433465	620234
	033635'	627476	464734
	033636'	635015	560760
	033637'	201724	031554
	033640'	000000	000000
	033641'	467376	262500	MSMES:	ASCIZ	"More 'ER' statements than valid 'RE' statements"
	033642'	236132	223500
	033643'	717514	172312
	033644'	667135	672346
	033645'	203515	060734
	033646'	203554	166322
	033647'	621004	751212
	033650'	235016	372302
	033651'	723135	562734
	033652'	723460	000000
	033653'	513136	062702	MSRRGT:	ASCIZ	"Repeat range greater than 640 characters"
	033654'	721016	260734
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 18-13
NAD01.R06	24-JUL-87 17:39		COMMAND TABLES AND ERROR MESSAGES

	033655'	637124	063744
	033656'	627036	462744
	033657'	203515	060734
	033660'	201546	430100
	033661'	617214	171302
	033662'	617514	571346
	033663'	000000	000000
	033664'	467034	371336	MSMEIR:	ASCIZ	"Macro ends in repeat range."
	033665'	203135	662346
	033666'	203235	620344
	033667'	627414	560750
	033670'	203454	167316
	033671'	625340	000000
	033672'	523375	720332	MSTMNR:	ASCIZ	"Too many nested repeats. Max=4"
	033673'	607357	120334
	033674'	627476	462710
	033675'	203454	570312
	033676'	607516	327100
	033677'	467037	036550
	033700'	000000	000000
	033701'	513134	764746	MSRNB:	ASCIZ	"Register field not between 0 and F"
	033702'	723136	220314
	033703'	647135	462100
	033704'	673376	420304
	033705'	627516	762712
	033706'	671006	020302
	033707'	673104	043000
	033710'	447315	462716	MSIL:	ASCIZ	"Illegal literal"
	033711'	607304	066322
	033712'	723136	260730
	033713'	000000	000000
	033714'	467236	371722	MSMLF:	ASCIZ	"Missing label field"
	033715'	673164	066302
	033716'	613135	420314
	033717'	647135	462000
	033720'	527354	462714	MSUE:	ASCIZ	"Undefined expression"
	033721'	647354	562100
	033722'	627616	071312
	033723'	717475	167734
	033724'	000000	000000
	033725'	407454	720332	MAMBP2:	ASCIZ	"Arg must be a power of 2"
	033726'	727476	420304
	033727'	625014	120340
	033730'	677574	571100
	033731'	677144	031000
	033732'	447315	462716	MSIE:	ASCIZ	"Illegal expression"
	033733'	607304	062760
	033734'	703454	571746
	033735'	647375	600000
	033736'	447356	660730	MSIOC:	ASCIZ	"Invalid opcode"
	033737'	647104	067740
	033740'	617374	462400
	033741'	527354	462714	MSUOC:	ASCIZ	"Undefined opcode"
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 18-14
NAD01.R06	24-JUL-87 17:39		COMMAND TABLES AND ERROR MESSAGES

	033742'	647354	562100
	033743'	677414	367710
	033744'	624000	000000
	033745'	447315	462716	MSILT:	ASCIZ	"Illegal label terminator"
	033746'	607304	066302
	033747'	613135	420350
	033750'	627455	564734
	033751'	607515	771000
	033752'	527354	462714	MSUS:	ASCIZ	"Undefined not allowed"
	033753'	647354	562100
	033754'	673376	420302
	033755'	663315	773712
	033756'	620000	000000
	033757'	427616	071312	MSEI:	ASCIZ	"Expression incomplete or syntax error"
	033760'	717475	167734
	033761'	203235	661736
	033762'	667415	462750
	033763'	625015	771100
	033764'	717635	672302
	033765'	741014	571344
	033766'	677440	000000
	033767'	467236	370330	MSMUO:	ASCIZ	"Misplaced unary operator"
	033770'	607074	562100
	033771'	727354	171362
	033772'	203376	062744
	033773'	607515	771000
	033774'	517635	672302	MSESE:	ASCIZ	"Syntax error in expression"
	033775'	741014	571344
	033776'	677444	064734
	033777'	203137	070344
	034000'	627476	364736
	034001'	670000	000000
	034002'	517635	672302	MSSE:	ASCIZ	"Syntax error"
	034003'	741014	571344
	034004'	677440	000000
	034005'	513034	464760	MSRV:	ASCIZ	"Radix violation"
	034006'	203555	167730
	034007'	607515	167734
	034010'	000000	000000
	034011'	477414	571302	MSONU:	ASCIZ	"Operator not unary"
	034012'	723376	220334
	034013'	677504	072734
	034014'	607457	100000
	034015'	472030	420322	MSOOM:	ASCIZ	"NAD is out of memory"
	034016'	715015	772750
	034017'	203374	620332
	034020'	627335	771362
	034021'	000000	000000
	034022'	447315	462716	MSIC:	ASCIZ	"Illegal character"
	034023'	607304	061720
	034024'	607454	161750
	034025'	627440	000000
	034026'	433236	271750	MSFCI:	ASCIZ	"First character of statement illegal"
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 18-15
NAD01.R06	24-JUL-87 17:39		COMMAND TABLES AND ERROR MESSAGES

	034027'	203075	060744
	034030'	607076	462744
	034031'	203374	620346
	034032'	723036	462732
	034033'	627356	420322
	034034'	663314	563702
	034035'	660000	000000
	034036'	473134	760750	MSNRS:	ASCIZ	"Negative value in storage statement illegal"
	034037'	647554	520354
	034040'	607316	562500
	034041'	647344	071750
	034042'	677454	163712
	034043'	203476	460750
	034044'	627334	567350
	034045'	203235	466312
	034046'	637035	400000
	034047'	517514	172312	MSSPCO:	ASCIZ	"Statement sets pc out of bounds"
	034050'	667135	672100
	034051'	717136	471500
	034052'	703064	067752
	034053'	721015	763100
	034054'	613376	567310
	034055'	714000	000000
	034056'	447315	462716	MSILO:	ASCIZ	"Illegal list option"
	034057'	607304	066322
	034060'	717504	067740
	034061'	723235	767000
	034062'	477355	474500	MSOTPF:	ASCIZ	"Only one TITLE per file allowed"
	034063'	677354	520250
	034064'	446511	442500
	034065'	703136	220314
	034066'	647314	520302
	034067'	663315	773712
	034070'	620000	000000
	034071'	522232	446212	MSTTL:	ASCIZ	"TITLE too long. Truncated"
	034072'	203515	767500
	034073'	663375	663534
	034074'	202516	272734
	034075'	617036	462710
	034076'	000000	000000
	034077'	456231	446100	MSKILL:	ASCIZ	"KILL of undefined symbol with unresolved references" 
	034100'	677144	072734
	034101'	623134	664734
	034102'	627104	071762
	034103'	667055	766100
	034104'	737236	464100
	034105'	727356	262746
	034106'	677316	662710
	034107'	203454	563312
	034110'	713135	661712
	034111'	714000	000000
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 19
NAD01.R06	24-JUL-87 17:39		LITERALS

					SUBTTL	LITERALS
					XLIST	;don't list all the literals
					LIST
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 20
NAD01.R06	24-JUL-87 17:39		INITIALIZE SYMBOL TABLE

					SUBTTL	INITIALIZE SYMBOL TABLE
				;		*********************************************


	035373'			MEMBAS:			;THIS AREA (NPG BY PGSIZ) FOR NODE MEMORY IS BORROWED
							;BEFORE SYMBOL TABLE INITIALIZATION FOR THE OPCODES.


	035373'	211500	001171	IZY:	MOVNI	Y,EIZOP-IZOP	;INITIALIZE SYMBOL TABLE
	035374'	514252	036602'	IZY1:	HRLZ	U,EIZOP(Y)
	035375'	200552	036603'		MOVE	L,1+EIZOP(Y)
	035376'	200212	036604'		MOVE	V,2+EIZOP(Y)
	035377'	260040	020203'		PJS	FY		;prepare for MY
	035400'	326600	025257'		JUMPN	M,PF		;and check if already defined
	035401'	260040	020364'		PJS	MY
	035402'	271500	000003		ADDI	Y,3
	035403'	321500	035374'		JUMPL	Y,IZY1
	035404'	200540	036600'		MOVE	L,IZDOT+1
	035405'	260040	020203'		PJS	FY
	035406'	551614	000002		HRRZI	M,2(M)
	035407'	202600	000467'		MOVEM	M,DOTP
	035410'	263040	000000		RETURN

					ALS	0,<X0,X1,X2,X3,X4,X5,X6,X7,X8,X9,XA,XB,XC,XD,XE,XF>;	;HEX SYMBOLS

					DEFINE	XV(XVA,XVB),<XVV==0
					IRPC	XVA,<XVV==XVV*20+X'XVA>
					XWD	XVV,XVB>

					DEFINE	OPSET (OPSETA),<IRP OPSETA,<OPSET1 OPSETA>>
					DEFINE	OPSET1(OPSETB),<OPSET2 OPSETB>
					DEFINE	OPSET2 (OPASC,OPCOD,OPV2,OPV1),< EXP OPV2'V_6
					SIXBIT	/OPASC/
					XV	OPCOD,OPV1>

					DEFINE	DIRSET(DIRSX),<IRP DIRSX,<DSET1 DIRSX>>
					DEFINE	DSET1(DS1X),<DSET2 DS1X>
					DEFINE	DSET2(DSTXT,DSADR,DSCNT<0>),< 0
					SIXBIT	/DSTXT/
					DSCNT,,DSADR>

	035411'	000000	000000	IZOP:	DIRSET	<<MACRO,DMAC>,<REMARK,DREM>,<NUMBER,DNUM>,<RA,DRA>>
	035412'	554143	625700
	035413'	000000	023056'
	035414'	000000	000000
	035415'	624555	416253
	035416'	000000	023702'
	035417'	000000	000000
	035420'	566555	424562
	035421'	000000	023726'
	035422'	000000	000000
	035423'	624100	000000
	035424'	000000	024667'
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 20-2
NAD01.R06	24-JUL-87 17:39		INITIALIZE SYMBOL TABLE

	035425'	000000	000000		DIRSET	<<LINENO,DLNO>,<QUIT,DQUIT>,<NADVER,DNADV>,<ERRCNT,DERRCT>>
	035426'	545156	455657
	035427'	000000	023734'
	035430'	000000	000000
	035431'	616551	640000
	035432'	000000	024002'
	035433'	000000	000000
	035434'	564144	664562
	035435'	000000	023736'
	035436'	000000	000000
	035437'	456262	435664
	035440'	000000	023742'
	035441'	000000	000000		DIRSET	<<UNCNT,DUNCT>,<CURGMT,DCGMT>>
	035442'	655643	566400
	035443'	000000	023744'
	035444'	000000	000000
	035445'	436562	475564
	035446'	000000	023756'
	035447'	000000	000000		DIRSET	<<TITLE,DTTL>,<SUBTTL,DSTL>,<NOTTL,DNOTTL>,<KILL,DKIL>>
	035450'	645164	544500
	035451'	000000	023551'
	035452'	000000	000000
	035453'	636542	646454
	035454'	000000	023572'
	035455'	000000	000000
	035456'	565764	645400
	035457'	000000	023646'
	035460'	000000	000000
	035461'	535154	540000
	035462'	000000	023402'
	035463'	000000	000000		DIRSET	<<GL,DGL>,<LIST,DLIST>,<NOLIST,DNLIST>,<EQ,DEQ>>
	035464'	475400	000000
	035465'	000000	023430'
	035466'	000000	000000
	035467'	545163	640000
	035470'	000000	023501'
	035471'	000000	000000
	035472'	565754	516364
	035473'	000000	023545'
	035474'	000000	000000
	035475'	456100	000000
	035476'	000000	024246'
	035477'	000000	002400		OPSET	<<ORG,0,DORG,PC0>,<SEG,0,DSEG,PC0>,<BND,0,DBND,PC0>>
	035500'	576247	000000
	035501'	000000	016762'
	035502'	000000	002600
	035503'	634547	000000
	035504'	000000	016762'
	035505'	000000	002500
	035506'	425644	000000
	035507'	000000	016762'
	035510'	000000	001200		OPSET	<<BS,0,DBS,PC0>,<HS,0,DHS,PC02>,<WS,0,DWS,PC04>>
	035511'	426300	000000
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 20-3
NAD01.R06	24-JUL-87 17:39		INITIALIZE SYMBOL TABLE

	035512'	000000	016762'
	035513'	000000	001300
	035514'	506300	000000
	035515'	000000	016763'
	035516'	000000	001400
	035517'	676300	000000
	035520'	000000	016765'
	035521'	000000	002000		OPSET	<<AC,0,DAC,PC0>,<SC,0,DSC,PC0>,<XC,0,DXC,PC0>,<END,0,DEN,PC0>>
	035522'	414300	000000
	035523'	000000	016762'
	035524'	000000	002100
	035525'	634300	000000
	035526'	000000	016762'
	035527'	000000	002200
	035530'	704300	000000
	035531'	000000	016762'
	035532'	000000	002300
	035533'	455644	000000
	035534'	000000	016762'
	035535'	000000	001500		OPSET	<<BC,0,DBC,PC0>,<HC,0,DHC,PC02>,<WC,0,DWC,PC04>>
	035536'	424300	000000
	035537'	000000	016762'
	035540'	000000	001600
	035541'	504300	000000
	035542'	000000	016763'
	035543'	000000	001700
	035544'	674300	000000
	035545'	000000	016765'
	035546'	000000	000000		DIRSET	<<MO,DMO>,<EM,DEM>,<LO,DLO>>
	035547'	555700	000000
	035550'	000000	024526'
	035551'	000000	000000
	035552'	455500	000000
	035553'	000000	024565'
	035554'	000000	000000
	035555'	545700	000000
	035556'	000000	024612'
	035557'	000000	000000		DIRSET	<<FO,DFO>,<US,DUS>>
	035560'	465700	000000
	035561'	000000	024611'
	035562'	000000	000000
	035563'	656300	000000
	035564'	000000	024635'
	035565'	000000	000000		DIRSET	<<UN,DUN>,<RE,DRE>,<IF,DIF>>
	035566'	655600	000000
	035567'	000000	024663'
	035570'	000000	000000
	035571'	624500	000000
	035572'	000000	024010'
	035573'	000000	000000
	035574'	514600	000000
	035575'	000000	024131'
	035576'	000000	000000		DIRSET	<<ER,DER>,<ELSE,DELSE>,<EI,DEI>>
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 20-4
NAD01.R06	24-JUL-87 17:39		INITIALIZE SYMBOL TABLE

	035577'	456200	000000
	035600'	000000	024056'
	035601'	000000	000000
	035602'	455463	450000
	035603'	000000	024165'
	035604'	000000	000000
	035605'	455100	000000
	035606'	000000	024210'

	035607'	000000	001000		OPSET	<<L,5800,RX,PC22>,<LR,0800,RR,PC2>,<LI,F800,RI2,PC222>>
	035610'	540000	000000
	035611'	054000	016714'
	035612'	000000	000100
	035613'	546200	000000
	035614'	004000	016703'
	035615'	000000	000500
	035616'	545100	000000
	035617'	174000	016735'
	035620'	000000	000100		OPSET	<<LIS,2400,SF,PC2>,<LCS,2500,SF,PC2>>
	035621'	545163	000000
	035622'	022000	016703'
	035623'	000000	000100
	035624'	544363	000000
	035625'	022400	016703'
	035626'	000000	001000		OPSET	<<LH,4800,RX,PC22>,<LHI,C800,RI,PC22>>
	035627'	545000	000000
	035630'	044000	016714'
	035631'	000000	000400
	035632'	545051	000000
	035633'	144000	016714'
	035634'	000000	001000		OPSET	<<LA,E600,RX,PC22>,<LHL,7300,RX,PC22>>
	035635'	544100	000000
	035636'	163000	016714'
	035637'	000000	001000
	035640'	545054	000000
	035641'	071400	016714'
	035642'	000000	001000		OPSET	<<LM,D100,RX,PC22>,<LB,D300,RX,PC22>,<LBR,9300,RR,PC2>>
	035643'	545500	000000
	035644'	150400	016714'
	035645'	000000	001000
	035646'	544200	000000
	035647'	151400	016714'
	035650'	000000	000100
	035651'	544262	000000
	035652'	111400	016703'
	035653'	000000	000100		OPSET	<<EXHR,3400,RR,PC2>,<EXBR,9400,RR,PC2>>
	035654'	457050	620000
	035655'	032000	016703'
	035656'	000000	000100
	035657'	457042	620000
	035660'	112000	016703'
	035661'	000000	001000		OPSET	<<ST,5000,RX,PC22>,<STH,4000,RX,PC22>,<STM,D000,RX,PC22>>
	035662'	636400	000000
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 20-5
NAD01.R06	24-JUL-87 17:39		INITIALIZE SYMBOL TABLE

	035663'	050000	016714'
	035664'	000000	001000
	035665'	636450	000000
	035666'	040000	016714'
	035667'	000000	001000
	035670'	636455	000000
	035671'	150000	016714'
	035672'	000000	001000		OPSET	<<STB,D200,RX,PC22>,<STBR,9200,RR,PC2>>
	035673'	636442	000000
	035674'	151000	016714'
	035675'	000000	000100
	035676'	636442	620000
	035677'	111000	016703'
	035700'	000000	001000		OPSET	<<CL,5500,RX,PC22>,<CLR,0500,RR,PC2>,<CLI,F500,RI2,PC222>>
	035701'	435400	000000
	035702'	052400	016714'
	035703'	000000	000100
	035704'	435462	000000
	035705'	002400	016703'
	035706'	000000	000500
	035707'	435451	000000
	035710'	172400	016735'
	035711'	000000	001000		OPSET	<<CLH,4500,RX,PC22>,<CLHI,C500,RI,PC22>,<CLB,D400,RX,PC22>>
	035712'	435450	000000
	035713'	042400	016714'
	035714'	000000	000400
	035715'	435450	510000
	035716'	142400	016714'
	035717'	000000	001000
	035720'	435442	000000
	035721'	152000	016714'
	035722'	000000	001000		OPSET	<<N,5400,RX,PC22>,<NR,0400,RR,PC2>,<NI,F400,RI2,PC222>>
	035723'	560000	000000
	035724'	052000	016714'
	035725'	000000	000100
	035726'	566200	000000
	035727'	002000	016703'
	035730'	000000	000500
	035731'	565100	000000
	035732'	172000	016735'
	035733'	000000	001000		OPSET	<<NH,4400,RX,PC22>,<NHI,C400,RI,PC22>>
	035734'	565000	000000
	035735'	042000	016714'
	035736'	000000	000400
	035737'	565051	000000
	035740'	142000	016714'
	035741'	000000	001000		OPSET	<<O,5600,RX,PC22>,<OR,0600,RR,PC2>,<OI,F600,RI2,PC222>>
	035742'	570000	000000
	035743'	053000	016714'
	035744'	000000	000100
	035745'	576200	000000
	035746'	003000	016703'
	035747'	000000	000500
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 20-6
NAD01.R06	24-JUL-87 17:39		INITIALIZE SYMBOL TABLE

	035750'	575100	000000
	035751'	173000	016735'
	035752'	000000	001000		OPSET	<<OH,4600,RX,PC22>,<OHI,C600,RI,PC22>>
	035753'	575000	000000
	035754'	043000	016714'
	035755'	000000	000400
	035756'	575051	000000
	035757'	143000	016714'
	035760'	000000	001000		OPSET	<<X,5700,RX,PC22>,<XR,0700,RR,PC2>,<XI,F700,RI2,PC222>>
	035761'	700000	000000
	035762'	053400	016714'
	035763'	000000	000100
	035764'	706200	000000
	035765'	003400	016703'
	035766'	000000	000500
	035767'	705100	000000
	035770'	173400	016735'
	035771'	000000	001000		OPSET	<<XH,4700,RX,PC22>,<XHI,C700,RI,PC22>>
	035772'	705000	000000
	035773'	043400	016714'
	035774'	000000	000400
	035775'	705051	000000
	035776'	143400	016714'
	035777'	000000	000500		OPSET	<<TI,F300,RI2,PC222>,<THI,C300,RI,PC22>>
	036000'	645100	000000
	036001'	171400	016735'
	036002'	000000	000400
	036003'	645051	000000
	036004'	141400	016714'
	036005'	000000	000400		OPSET	<<SLL,ED00,RI,PC22>,<SLLS,1100,SF,PC2>>
	036006'	635454	000000
	036007'	166400	016714'
	036010'	000000	000100
	036011'	635454	630000
	036012'	010400	016703'
	036013'	000000	000400		OPSET	<<SRL,EC00,RI,PC22>,<SRLS,1000,SF,PC2>>
	036014'	636254	000000
	036015'	166000	016714'
	036016'	000000	000100
	036017'	636254	630000
	036020'	010000	016703'
	036021'	000000	000400		OPSET	<<SLHL,CD00,RI,PC22>,<SLHLS,9100,SF,PC2>>
	036022'	635450	540000
	036023'	146400	016714'
	036024'	000000	000100
	036025'	635450	546300
	036026'	110400	016703'
	036027'	000000	000400		OPSET	<<SRHL,CC00,RI,PC22>,<SRHLS,9000,SF,PC2>>
	036030'	636250	540000
	036031'	146000	016714'
	036032'	000000	000100
	036033'	636250	546300
	036034'	110000	016703'
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 20-7
NAD01.R06	24-JUL-87 17:39		INITIALIZE SYMBOL TABLE

	036035'	000000	000400		OPSET	<<RLL,EB00,RI,PC22>,<RRL,EA00,RI,PC22>>
	036036'	625454	000000
	036037'	165400	016714'
	036040'	000000	000400
	036041'	626254	000000
	036042'	165000	016714'
	036043'	000000	001000		OPSET	<<TBT,7400,RX,PC22>,<SBT,7500,RX,PC22>>
	036044'	644264	000000
	036045'	072000	016714'
	036046'	000000	001000
	036047'	634264	000000
	036050'	072400	016714'
	036051'	000000	001000		OPSET	<<CBT,7700,RX,PC22>,<RBT,7600,RX,PC22>,<TS,E000,RX0,PC22>>
	036052'	434264	000000
	036053'	073400	016714'
	036054'	000000	001000
	036055'	624264	000000
	036056'	073000	016714'
	036057'	000000	001100
	036060'	646300	000000
	036061'	160000	016714'
	036062'	000000	001000		OPSET	<<A,5A00,RX,PC22>,<AI,FA00,RI2,PC222>,<AIS,2600,SF,PC2>>
	036063'	410000	000000
	036064'	055000	016714'
	036065'	000000	000500
	036066'	415100	000000
	036067'	175000	016735'
	036070'	000000	000100
	036071'	415163	000000
	036072'	023000	016703'
	036073'	000000	000100		OPSET	<<AR,0A00,RR,PC2>,<AH,4A00,RX,PC22>,<AHI,CA00,RI,PC22>>
	036074'	416200	000000
	036075'	005000	016703'
	036076'	000000	001000
	036077'	415000	000000
	036100'	045000	016714'
	036101'	000000	000400
	036102'	415051	000000
	036103'	145000	016714'
	036104'	000000	001000		OPSET	<<AM,5100,RX,PC22>,<AHM,6100,RX,PC22>>
	036105'	415500	000000
	036106'	050400	016714'
	036107'	000000	001000
	036110'	415055	000000
	036111'	060400	016714'
	036112'	000000	001000		OPSET	<<S,5B00,RX,PC22>,<SR,0B00,RR,PC2>,<SI,FB00,RI2,PC222>>
	036113'	630000	000000
	036114'	055400	016714'
	036115'	000000	000100
	036116'	636200	000000
	036117'	005400	016703'
	036120'	000000	000500
	036121'	635100	000000
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 20-8
NAD01.R06	24-JUL-87 17:39		INITIALIZE SYMBOL TABLE

	036122'	175400	016735'
	036123'	000000	000100		OPSET	<<SIS,2700,SF,PC2>,<SH,4B00,RX,PC22>,<SHI,CB00,RI,PC22>>
	036124'	635163	000000
	036125'	023400	016703'
	036126'	000000	001000
	036127'	635000	000000
	036130'	045400	016714'
	036131'	000000	000400
	036132'	635051	000000
	036133'	145400	016714'
	036134'	000000	001000		OPSET	<<C,5900,RX,PC22>,<CR,0900,RR,PC2>,<CI,F900,RI2,PC222>>
	036135'	430000	000000
	036136'	054400	016714'
	036137'	000000	000100
	036140'	436200	000000
	036141'	004400	016703'
	036142'	000000	000500
	036143'	435100	000000
	036144'	174400	016735'
	036145'	000000	001000		OPSET	<<CH,4900,RX,PC22>,<CHI,C900,RI,PC22>>
	036146'	435000	000000
	036147'	044400	016714'
	036150'	000000	000400
	036151'	435051	000000
	036152'	144400	016714'
	036153'	000000	001000		OPSET	<<M,5C00,RX,PC22>,<MR,1C00,RR,PC2>>
	036154'	550000	000000
	036155'	056000	016714'
	036156'	000000	000100
	036157'	556200	000000
	036160'	016000	016703'
	036161'	000000	001000		OPSET	<<MH,4C00,RX,PC22>,<MHR,0C00,RR,PC2>>
	036162'	555000	000000
	036163'	046000	016714'
	036164'	000000	000100
	036165'	555062	000000
	036166'	006000	016703'
	036167'	000000	001000		OPSET	<<D,5D00,RX,PC22>,<DR,1D00,RR,PC2>>
	036170'	440000	000000
	036171'	056400	016714'
	036172'	000000	000100
	036173'	446200	000000
	036174'	016400	016703'
	036175'	000000	001000		OPSET	<<DH,4D00,RX,PC22>,<DHR,0D00,RR,PC2>>
	036176'	445000	000000
	036177'	046400	016714'
	036200'	000000	000100
	036201'	445062	000000
	036202'	006400	016703'
	036203'	000000	000400		OPSET	<<SRA,EE00,RI,PC22>,<SRHA,CE00,RI,PC22>,<CHVR,1200,RR,PC2>>
	036204'	636241	000000
	036205'	167000	016714'
	036206'	000000	000400
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 20-9
NAD01.R06	24-JUL-87 17:39		INITIALIZE SYMBOL TABLE

	036207'	636250	410000
	036210'	147000	016714'
	036211'	000000	000100
	036212'	435066	620000
	036213'	011000	016703'
	036214'	000000	000100		OPSET2	LHR,1200,RR,PC2
	036215'	545062	000000
	036216'	011000	016703'
	036217'	000000	001100		OPSET	<<LPSW,C200,RX0,PC22>,<LPSWR,1800,LPSR,PC2>,<EPSR,9500,RR,PC2>>
	036220'	546063	670000
	036221'	141000	016714'
	036222'	000000	000300
	036223'	546063	676200
	036224'	014000	016703'
	036225'	000000	000100
	036226'	456063	620000
	036227'	112400	016703'
	036230'	000000	000100		OPSET	<<SSR,9D00,RR,PC2>,<SVC,E100,RX,PC22>>
	036231'	636362	000000
	036232'	116400	016703'
	036233'	000000	001000
	036234'	636643	000000
	036235'	160400	016714'
	036236'	000000	001000		OPSET	<<OC,DE00,RX,PC22>,<OCR,9E00,RR,PC2>>
	036237'	574300	000000
	036240'	157000	016714'
	036241'	000000	000100
	036242'	574362	000000
	036243'	117000	016703'
	036244'	000000	000100		OPSET2	RDR,9B00,RR,PC2
	036245'	624462	000000
	036246'	115400	016703'
	036247'	000000	001000		OPSET	<<WD,DA00,RX,PC22>,<WDR,9A00,RR,PC2>>
	036250'	674400	000000
	036251'	155000	016714'
	036252'	000000	000100
	036253'	674462	000000
	036254'	115000	016703'
	036255'	000000	001000		OPSET2	WB,D600,RX,PC22
	036256'	674200	000000
	036257'	153000	016714'
	036260'	000000	001100		OPSET	<<UPSW,D500,RX0,PC22>,<CIO,9900,RR,PC2>>
	036261'	656063	670000
	036262'	152400	016714'
	036263'	000000	000100
	036264'	435157	000000
	036265'	114400	016703'

				;		JUMP SUNDRIES
	036266'	000000	001000		OPSET	<<JT,4200,RX,PC22>,<JTR,0200,RR,PC2>,<JTBS,2000,BF,PC2>>
	036267'	526400	000000
	036270'	041000	016714'
	036271'	000000	000100
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 20-10
NAD01.R06	24-JUL-87 17:39		INITIALIZE SYMBOL TABLE

	036272'	526462	000000
	036273'	001000	016703'
	036274'	000000	000600
	036275'	526442	630000
	036276'	020000	016703'
	036277'	000000	000600		OPSET	<<JTFS,2100,BF,PC2>,<JFFO,3100,BF,PC2>,<JFFOH,3300,BF,PC2>>
	036300'	526446	630000
	036301'	020400	016703'
	036302'	000000	000600
	036303'	524646	570000
	036304'	030400	016703'
	036305'	000000	000600
	036306'	524646	575000
	036307'	031400	016703'
	036310'	000000	001000		OPSET	<<JF,4300,RX,PC22>,<JFR,0300,RR,PC2>,<JFBS,2200,BF,PC2>>
	036311'	524600	000000
	036312'	041400	016714'
	036313'	000000	000100
	036314'	524662	000000
	036315'	001400	016703'
	036316'	000000	000600
	036317'	524642	630000
	036320'	021000	016703'
	036321'	000000	000600		OPSET2	JFFS,2300,BF,PC2
	036322'	524646	630000
	036323'	021400	016703'
	036324'	000000	001000		OPSET	<<JL,4210,RX,PC22>,<JLR,0210,RR1,PC2>,<JLBS,2010,BF1,PC2>>
	036325'	525400	000000
	036326'	041020	016714'
	036327'	000000	000200
	036330'	525462	000000
	036331'	001020	016703'
	036332'	000000	000700
	036333'	525442	630000
	036334'	020020	016703'
	036335'	000000	000700		OPSET2	JLFS,2110,BF1,PC2
	036336'	525446	630000
	036337'	020420	016703'
	036340'	000000	001000		OPSET	<<JLE,4320,RX,PC22>,<JLER,0320,RR1,PC2>,<JLEBS,2220,BF1,PC2>>
	036341'	525445	000000
	036342'	041440	016714'
	036343'	000000	000200
	036344'	525445	620000
	036345'	001440	016703'
	036346'	000000	000700
	036347'	525445	426300
	036350'	021040	016703'
	036351'	000000	000700		OPSET2	JLEFS,2320,BF1,PC2
	036352'	525445	466300
	036353'	021440	016703'
	036354'	000000	001000		OPSET	<<JE,4330,RX,PC22>,<JER,0330,RR1,PC2>,<JEBS,2230,BF1,PC2>>
	036355'	524500	000000
	036356'	041460	016714'
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 20-11
NAD01.R06	24-JUL-87 17:39		INITIALIZE SYMBOL TABLE

	036357'	000000	000200
	036360'	524562	000000
	036361'	001460	016703'
	036362'	000000	000700
	036363'	524542	630000
	036364'	021060	016703'
	036365'	000000	000700		OPSET2	JEFS,2330,BF1,PC2
	036366'	524546	630000
	036367'	021460	016703'
	036370'	000000	001000		OPSET	<<JN,4230,RX,PC22>,<JNR,0230,RR1,PC2>,<JNBS,2030,BF1,PC2>>
	036371'	525600	000000
	036372'	041060	016714'
	036373'	000000	000200
	036374'	525662	000000
	036375'	001060	016703'
	036376'	000000	000700
	036377'	525642	630000
	036400'	020060	016703'
	036401'	000000	000700		OPSET2	JNFS,2130,BF1,PC2
	036402'	525646	630000
	036403'	020460	016703'
	036404'	000000	001000		OPSET	<<JGE,4310,RX,PC22>,<JGER,0310,RR1,PC2>,<JGEBS,2210,BF1,PC2>>
	036405'	524745	000000
	036406'	041420	016714'
	036407'	000000	000200
	036410'	524745	620000
	036411'	001420	016703'
	036412'	000000	000700
	036413'	524745	426300
	036414'	021020	016703'
	036415'	000000	000700		OPSET2	JGEFS,2310,BF1,PC2
	036416'	524745	466300
	036417'	021420	016703'
	036420'	000000	001000		OPSET	<<JG,4220,RX,PC22>,<JGR,0220,RR1,PC2>,<JGBS,2020,BF1,PC2>>
	036421'	524700	000000
	036422'	041040	016714'
	036423'	000000	000200
	036424'	524762	000000
	036425'	001040	016703'
	036426'	000000	000700
	036427'	524742	630000
	036430'	020040	016703'
	036431'	000000	000700		OPSET2	JGFS,2120,BF1,PC2
	036432'	524746	630000
	036433'	020440	016703'
	036434'	000000	001000		OPSET	<<JO,4240,RX,PC22>,<JOR,0240,RR1,PC2>,<JOBS,2040,BF1,PC2>>
	036435'	525700	000000
	036436'	041100	016714'
	036437'	000000	000200
	036440'	525762	000000
	036441'	001100	016703'
	036442'	000000	000700
	036443'	525742	630000
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 20-12
NAD01.R06	24-JUL-87 17:39		INITIALIZE SYMBOL TABLE

	036444'	020100	016703'
	036445'	000000	000700		OPSET2	JOFS,2140,BF1,PC2
	036446'	525746	630000
	036447'	020500	016703'
	036450'	000000	001000		OPSET	<<JNO,4340,RX,PC22>,<JNOR,0340,RR1,PC2>,<JNOBS,2240,BF1,PC2>>
	036451'	525657	000000
	036452'	041500	016714'
	036453'	000000	000200
	036454'	525657	620000
	036455'	001500	016703'
	036456'	000000	000700
	036457'	525657	426300
	036460'	021100	016703'
	036461'	000000	000700		OPSET2	JNOFS,2340,BF1,PC2
	036462'	525657	466300
	036463'	021500	016703'
	036464'	000000	001000		OPSET	<<JC,4280,RX,PC22>,<JCR,0280,RR1,PC2>,<JCBS,2080,BF1,PC2>>
	036465'	524300	000000
	036466'	041200	016714'
	036467'	000000	000200
	036470'	524362	000000
	036471'	001200	016703'
	036472'	000000	000700
	036473'	524342	630000
	036474'	020200	016703'
	036475'	000000	000700		OPSET2	JCFS,2180,BF1,PC2
	036476'	524346	630000
	036477'	020600	016703'
	036500'	000000	001000		OPSET	<<JNC,4380,RX,PC22>,<JNCR,0380,RR1,PC2>,<JNCBS,2280,BF1,PC2>>
	036501'	525643	000000
	036502'	041600	016714'
	036503'	000000	000200
	036504'	525643	620000
	036505'	001600	016703'
	036506'	000000	000700
	036507'	525643	426300
	036510'	021200	016703'
	036511'	000000	000700		OPSET2	JNCFS,2380,BF1,PC2
	036512'	525643	466300
	036513'	021600	016703'
	036514'	000000	001100		OPSET	<<J,4300,RX0,PC22>,<JR,0300,RR1,PC2>,<JBS,2200,BF1,PC2>>
	036515'	520000	000000
	036516'	041400	016714'
	036517'	000000	000200
	036520'	526200	000000
	036521'	001400	016703'
	036522'	000000	000700
	036523'	524263	000000
	036524'	021000	016703'
	036525'	000000	000700		OPSET2	JFS,2300,BF1,PC2
	036526'	524663	000000
	036527'	021400	016703'
	036530'	000000	001000		OPSET	<<JAL,4100,RX,PC22>,<JALR,0100,RR,PC2>>
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 20-13
NAD01.R06	24-JUL-87 17:39		INITIALIZE SYMBOL TABLE

	036531'	524154	000000
	036532'	040400	016714'
	036533'	000000	000100
	036534'	524154	620000
	036535'	000400	016703'
	036536'	000000	001000		OPSET	<<NOP,4200,RX,PC22>,<NOPR,0200,RR,PC2>>
	036537'	565760	000000
	036540'	041000	016714'
	036541'	000000	000100
	036542'	565760	620000
	036543'	001000	016703'
	036544'	000000	000100		OPSET	<<COPY,3F00,RR,PC2>,<ARAND,3E00,RR,PC2>>
	036545'	435760	710000
	036546'	037400	016703'
	036547'	000000	000100
	036550'	416241	564400
	036551'	037000	016703'
	036552'	000000	000100		OPSET	<<SBOD,1300,RR,PC2>,<XMIT,1400,RR,PC2>>
	036553'	634257	440000
	036554'	011400	016703'
	036555'	000000	000100
	036556'	705551	640000
	036557'	012000	016703'
	036560'	000000	000100		OPSET	<<SPM,1500,RR,PC2>,<GCHAR,1600,RR,PC2>>
	036561'	636055	000000
	036562'	012400	016703'
	036563'	000000	000100
	036564'	474350	416200
	036565'	013000	016703'
	036566'	000000	000100		OPSET	<<SCAN,3500,RR,PC2>,<ALIGN,3600,RR,PC2>>
	036567'	634341	560000
	036570'	032400	016703'
	036571'	000000	000100
	036572'	415451	475600
	036573'	033000	016703'
	036574'	000000	000100		OPSET	<<CKSUM,3700,RR,PC2>>
	036575'	435363	655500
	036576'	033400	016703'
	036577'	000000	000001	IZDOT:	1
	036600'	160000	000000		16_36
	036601'	000000	000000		0			;P COUNTER
	036602'			EIZOP:	PURGE	XV,OPSET,OPSET1,OPSET2

	036602'				LIT

	036602'				BLOCK	NPG*PGSIZ+MEMBAS-.

	055373'			EMEM:

			016103'		END	IZ

NO ERRORS DETECTED
PROGRAM BREAK IS 055373
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 20-14
NAD01.R06	24-JUL-87 17:39		INITIALIZE SYMBOL TABLE

9K CORE USED
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 21
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE

AA		026541'		BF1V		000007	SPD	CMDBLK		001003'		CROSS6		021437'	
AA1		026552'		BF2		024751'		CMDBUF		001012'		CROSS7		021463'	
AAE		026566'		BF3		024752'		CMDCHN		000020	SPD	CROSSE		021466'	
AAEND		026640'		BF4		024755'		CMDECO		002257'		CRS		006377'	
AAGS		026573'		BFO		000014	SPD	CMDLIM		000004	SPD	CRSBUF		021470'	
AAI		026601'		BFSW		002747'		CMDMAX		000005	SPD	CS		006504'	
AAL		026600'		BFV		000006	SPD	CMDNAM		001006'		CS0		006503'	
AAPC		006422'		BINMOD		000040	SPD	CMDNBF		000001	SPD	CT		032742'	
ABORT		016767'		BL		000742'		CMDSBF		000206	SPD	CT0		033142'	
ABTASM		004000	SPD	BL3		021763'		CMDSRC		002265'		CT1		033245'	
AE		000016	SPD	BLA		000000	SPD	CMDUSR		001001'		CT2		033336'	
AF		026707'		BLSVP		022746'		CMDX		000005	SPD	CT3		033413'	
AF1		026744'		BMIN		000005	SPD	CML1		026136'		CTINP		022124'	
ALIGN2		017050'		BPLU		000004	SPD	CML3		026170'		CTINP1		022130'	
ALIGN4		017056'		BRNGL		002741'		CMLADR		006565'		CURCMD		002255'	
ALSB		000020	SPD	BSLP		000411'		CMLCHR		006570'		CURSEG		000470'	
ALWARG		013060'		BSLPS		000412'		CMLDTA		006566'		DAC		024445'	
AMM		006331'		BSPEC		000737'		CMLE		026210'		DAC1		024454'	
AMODUL		006332'		C		000003		CMLOOK		026131'		DAC2		024471'	
AMP		000010	SPD	CAHSUB		025620'		CMLU		006567'		DACV		000020	SPD
ARADIX		006335'		CAKSUB		025630'		CMLX		026204'		DACX		024502'	
ARGC		006440'		CAR		000013	SPD	CN		006410'		DACXX		024514'	
ARGC1		006441'		CASUB		025610'		CO		000014	SPD	DATE	047000	000014	
ASCHEX		006574'		CATAB		032556'		COLON		000011	SPD	DATUUO	047000	777723	
ASONLY		000001	SPD	CATABH		032562'		COLONC		030721'		DB		031201'	
ASSEM		016425'		CATABK		032566'		COM		000002	SPD	DB1		031221'	
ASSEM1		016430'		CAXERR		032467'		CONDST		000100	SPD	DB2		031227'	
ASSEM2		016434'		CCOMNT		030667'		CORE	047000	000011		DBC		024311'	
ASSEM3		016446'		CDQUES		032507'		COS		006444'		DBC0		006435'	
ASSEM4		016451'		CFACLS		022147'		CP		012626'		DBC1		006436'	
ASSEM5		016432'		CFCLS		022145'		CPF	260040	025257'		DBCHR		031234'	
AUXINT		026073'		CFCLS1		022153'		CPLMAX		000221	SPD	DBCHR1		031270'	
AUXLOS		026067'		CFCLS2		022161'		CPLMIN		000062	SPD	DBCHR2		031301'	
AUXZAP		026040'		CFINP		022051'		CR		025722'		DBCHR3		031307'	
AXZAP2		026044'		CFINP1		022055'		CR1		025723'		DBCV		000015	SPD
AXZAP3		026062'		CFINP2		022071'		CR2		025724'		DBF		031244'	
B1BAD		002751'		CFINP3		022074'		CR3		025735'		DBF1		031255'	
BACKUP		006336'		CFINP4		022100'		CR4		025756'		DBF9		031266'	
BAD		002750'		CFINP5		022101'		CREAUX	047000	777734		DBLCHR		006434'	
BARADR		026671'	SPD	CFINP6		022104'		CREF		000100	SPD	DBND		024217'	
BARM		000400	SPD	CFINP7		022113'		CRESC1		025664'		DBNDV		000025	SPD
BARN		000000	SPD	CFINP8		022120'		CRESC2		025715'		DBS		024263'	
BC		006437'		CHPLN		002760'		CRET0		030677'		DBS1		024267'	
BCH		000013	SPD	CHRCHN		000004	SPD	CRET1		030706'		DBSV		000012	SPD
BCREF		030466'		CHRIT		000000	SPD	CRETP		030717'		DC9		024410'	
BCREF0		030441'		CIF		021255'		CRFLST		000004	SPD	DCCF		200000	SPD
BCREF1		030444'		CIT	030000	000000		CRIZ		025663'		DCGMT		023756'	
BCREF2		030447'		CLF		021327'		CROSS		021341'		DCOS		006446'	
BCREF3		030453'		CLMCNT		006453'		CROSS1		021370'		DE		000011	SPD
BCREF4		030461'		CLRBFI	051440	000000		CROSS2		021401'		DEI		024210'	
BEGCRF		023020'		CLRBFO	051500	000000		CROSS3		021407'		DEI1		024214'	
BF		024723'		CMACNT		006455'		CROSS4		021417'		DELSE		024165'	
BF1		024726'		CMDBFA		002250'		CROSS5		021424'		DELSE1		024205'	
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 21-2
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE

DELSY1		020156'		DMAC4		023141'		DQUIT		024002'		ECA		032343'	
DELSYM		020147'		DMAC5		023137'		DRA		024667'		ECAB		032345'	
DEM		024565'		DMAC6		023120'		DRAE		024673'		ECREF		030514'	
DEM1		024606'		DMAC61		023124'		DRE		024010'		EIZOP		036602'	
DEN		023674'		DMAC7		023077'		DRE0		024031'		ELSESW		003204'	
DENV		000023	SPD	DMACCA		023175'		DRE1		024016'		EM		000013	SPD
DEQ		024246'		DMACD1		023303'		DRE2		024042'		EMEM		055373'	
DEQ1		024250'		DMACDG		023173'		DREE		024027'		ENDCRF		023027'	
DER		024056'		DMACDN		023264'		DREM		023702'		ENDFND		000100	SPD
DER1		024072'		DMACEM		023160'		DREM1		023710'		ENDRPT		000200	SPD
DERRCT		023742'		DMACST		023170'		DREM2		023724'		EOFF		010000	SPD
DERX		024125'		DMACSY		023204'		DSC		024442'		EPC9D		017050'	
DFO		024611'		DMAST1		023171'		DSCV		000021	SPD	EQ01		031131'	
DFODLO		006327'		DMASY1		023221'		DSEG		023657'		EQ02		031141'	
DGL		023430'		DMASY2		023245'		DSEGV		000026	SPD	EQSIGN		000006	SPD
DGL1		023475'		DMASY3		023243'		DSTL		023572'		ERNGL		002742'	
DGL2		023442'		DMASY4		023242'		DSTL1		023603'		ERRCNT		003170'	
DGL3		023462'		DMASY5		023216'		DSTL2		023617'		ESC		025761'	
DGL4		023466'		DMASY6		023240'		DSTLBF		003111'		ESCBLK		006413'	
DGL5		023450'		DMASY7		023211'		DSW		001000'		ESCCHN		000001	SPD
DGLE		023441'		DMASY8		023255'		DTOM		006445'		ESCSW		000001	SPD
DHC		024325'		DMASY9		023260'		DTTL		023551'		ESK		000162'	
DHC0		024336'		DMO		024526'		DTTL1		023560'		ESK1		000164'	
DHC2		024346'		DMO1A		024540'		DTTL2		023567'		ESK2		000204'	
DHCV		000016	SPD	DMO2		024547'		DTTLBF		003034'		ESKP		000160'	
DHS		024275'		DMO3		024552'		DUN		024663'		ESYH		012626'	
DHSV		000013	SPD	DMSCTR		000775'		DUNCT		023744'		EXCL		000011	SPD
DIF		024131'		DNADV		023736'		DUNCT1		023746'		EXIT	047000	000012	
DIF1		024137'		DNCLM		006452'		DUNCT2		023747'		EXPRIP		000010	SPD
DIF2		024153'		DNLIST		023545'		DUNCT3		023754'		EYH		010617'	
DIF3		024156'		DNOTTL		023646'		DUS		024635'		F		000015	
DIF4		024162'		DNTTL1		023652'		DWC		024355'		F2		000016	
DIFER		024164'		DNUM		023726'		DWC0		024374'		FBT		021742'	
DIG		000002	SPD	DOL		000003	SPD	DWCLM		006451'		FC		026530'	
DISMIS	047000	777755		DOM		020276'		DWCU		024366'		FC1		020245'	
DISP		003162'		DOM0		020302'		DWCV		000017	SPD	FC2		020271'	
DKIL		023402'		DOM1		020314'		DWS		024303'		FC3		020272'	
DKIL0		023404'		DOM2		020326'		DWSV		000014	SPD	FC4		020274'	
DKIL1		023416'		DOM3		020323'		DXC		024415'		FCC		026523'	
DKIL2		023426'		DORG		024232'		DXC1		024416'		FCCPC		026522'	
DKILE		023415'		DORG1		024234'		DXCV		000022	SPD	FCS		020222'	
DL1		024614'		DORGV		000024	SPD	DXCX		024430'		FCSBND		006576'	
DL2		024625'		DOS		006462'		DY		020401'		FCSMIN		006575'	
DLIST		023501'		DOS1B		026644'		DY0		020407'		FILLHX		022625'	
DLNO		023734'		DOS3B		026643'		DY1		020420'		FL		006600'	
DLO		024612'		DOS6		026660'		EC		032341'		FMACD		023361'	
DM		026430'		DOSOUT		026654'		EC0		032356'		FRCLST		000001	SPD
DM1		026435'		DOSX		006461'		EC1		032360'		FSBTTL		000200	SPD
DMAC		023056'		DOTP		000467'		EC2		032373'		FX2		003163'	
DMAC0		023106'		DPBV		025500'		EC3		032446'		FY		020203'	
DMAC1		023074'		DQUES		026123'		EC4		032452'		FY1		020206'	
DMAC2		023117'		DQUES1		026121'		EC5		032506'		FY2		020221'	
DMAC3		023136'		DQUES3		026124'		EC6		032416'		G3		025057'	
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 21-3
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE

G3A		025067'		GESX		017474'		GIT33		027375'		GS2F		016625'	
G3B		025106'		GETGMT		023762'		GIT34		027415'		GSD		016522'	
G3C		025101'		GETTAB	047000	000041		GIT4		027417'		GSEC		003167'	
GCHI		002272'		GETTXT		023625'		GK		017525'		GSF		016627'	
GCHR		021753'		GEUOK		006320'		GKD		017641'		GSFX		016630'	
GE		017071'		GF		016230'		GKD1		017645'		GSI0		030145'	
GE0		017112'		GF1		016242'		GKE		017550'		GSI1		030235'	
GE1		017120'		GF10		016416'		GKE1		017626'		GSI2		030261'	
GE1U		017066'		GF13		016423'		GKE2		017631'		GSI20		030155'	
GE2		017126'		GF2		016305'		GKE3		017636'		GSI21		030200'	
GE3		017134'		GF3		016306'		GKM		020023'		GSI2A		030277'	
GE4		017142'		GF30		016362'		GKM0		017760'		GSIB0		030140'	
GEA		017077'		GF4		016315'		GKM1		020027'		GSIB1		030134'	
GEBSL1		017375'		GF5		016320'		GKM2		020064'		GSIBE1		030341'	
GEBSL2		017402'		GFN		021115'		GKM3		020076'		GSIBE2		030343'	
GECALL		006577'		GFN1		021126'		GKM4		020143'		GSL		016540'	
GED		017221'		GFN2		021145'		GKM5		020103'		GSSTK		006321'	
GEDDOL		017306'		GFN3		021146'		GKM9		020017'		GST		016644'	
GEDLP		017262'		GFN4		021147'		GKMD		020046'		GSTS		016646'	
GEDOL1		017307'		GFN5		021167'		GKMD1		020056'		GSTX		016650'	
GEDRP		017274'		GFN6		021174'		GKMDUN		020074'		GSTXD		016667'	
GEDRPX		017300'		GFN7		021201'		GKMLIT		020061'		GTXT1		023633'	
GEDT		017241'		GFNX		021117'		GKN		017651'		GTXT2		023642'	
GEDT0		017240'		GFS		003247'		GKN1		017653'		HASHSZ		002007	SPD
GEDT1		017260'		GI1		027107'		GKN2		017664'		HEX		032572'	
GEDX1		017316'		GI10		027204'		GKN9		017706'		HEX6		032612'	
GEEQS		017335'		GI11		027230'		GKNN		017711'		HEXSIZ		000020	SPD
GEES		017341'		GI12		027236'		GKX		017531'		HIBER	047000	000072	
GEESE		017404'		GI13		027261'		GKY		017714'		I		000002	
GEF		017431'		GI14		027264'		GKY1		017723'		IA.CLR		000004	SPD
GEF0		017427'		GI15		027275'		GKY2		017724'		IA.DIS		000001	SPD
GEF9		017466'		GI16		027305'		GKY5		017751'		IA.REE		000002	SPD
GEFT		017452'		GI17		027315'		GKYX1		017732'		IBAUTH		002342'	
GEGO		017072'		GI18		027325'		GM		020656'		IBBADP		002734'	
GEMUL		017510'		GI2		027172'		GM1		020667'		IBCNTP		002736'	
GEOP1		017173'		GI20		027336'		GM2		020701'		IBDATE		002334'	
GEOP2		017163'		GI21		027142'		GM3		020702'		IBER		027063'	
GEOPNU		017166'		GI22		027147'		GMACD		023314'		IBEX		027065'	
GEOPU		017152'		GI4		027113'		GMACD1		023324'		IBF		026753'	
GEPV		017216'		GI6		027135'		GMACD2		023325'		IBF0		000733'	
GEPV0		017212'		GI7		027157'		GMACD3		023347'		IBF1		027016'	
GEPVU		017201'		GI8		027160'		GME		020711'		IBF2		027025'	
GEPVU0		017175'		GI9		027165'		GMTVAL		003171'		IBF3		027030'	
GEPVU1		017205'		GIB0		027067'		GR		025166'		IBF4		027046'	
GEPVU2		017210'		GIB1		027071'		GRIRF		025213'		IBF5		027056'	
GERC		017517'		GIB2		027074'		GS		016473'		IBF6		027005'	
GES1		017351'		GIB3		027103'		GS1E		016520'		IBFILE		002340'	
GES2		017372'		GIT		027345'		GS2		016555'		IBID		002332'	
GESE		017150'		GIT1		027355'		GS2A		016575'		IBIDC		002531'	
GESE0		017151'		GIT2		027366'		GS2B		016607'		IBMMUL		002757'	
GESF		003157'		GIT3		027370'		GS2C		016613'		IBMSTP		002735'	
GESUL		017406'		GIT31		027371'		GS2D		016570'		IBPADP		002735'	
GESUR		017410'		GIT32		027373'		GS2E		016521'		IBPSA		002333'	
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 21-4
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE

IBRIX		002344'		ICW		031375'		IM1B		032236'		IZDOS		026651'	
IBRIXP		002745'		ICW1		031423'		IM1C		032246'		IZDOT		036577'	
IBSLP		000410'		ICW2		031432'		IM1D		032251'		IZOP		035411'	
IBSOVR		002755'		ICW3		031464'		IM1E		032256'		IZPG		016213'	
IBSVER		002756'		ICW5		031512'		IM1F		032260'		IZY		035373'	
IBSYCP		002735'		ICW6		031442'		IM20		032266'		IZY1		035374'	
IBTIME		002335'		ICW7		031446'		IM21		032276'		JCH		000012	SPD
IBTYPP		002733'		ICW8		031452'		IMFLUS		032053'		JE		002311'	
IBUNAM		002336'		ICW9		031413'		INCHRW	051000	000000		JP.TYM		040000	SPD
IBUVAP		002737'		ICWR		031741'		INCHWL	051200	000000		JSPEC		000734'	
IBVADP		002740'		ICWR1		031750'		INCREF		002000	SPD	KCOMMA		026703'	
IC		031313'		ICX		006411'		INTACT	047000	777743		KILSYM		030345'	
IC2		031332'		ICZ		031757'		INTADR	047000	777745		L		000013	
IC3		031335'		IDTYP		000001	SPD	INTASM		016455'		LABEL		000462'	
IC4		031346'		IFC		003202'		INTENB	047000	777744		LABELP		000463'	
IC6		031324'		IFCHK		016367'		INTS		000037'		LAF		000004	SPD
ICBA1		031647'		IFLABL		003177'		INTSET		026021'		LBIT		032632'	
ICBARG		031646'		IFLINE		003176'		IONEOU	051640	000000		LBRAK		000007	SPD
ICBBEG		031521'		IFLOCL		003200'		IPC		006442'		LC		006256'	
ICBCL1		031621'		IFPPN		002320'		IPDS		000017'		LCH		000011	SPD
ICBCLR		031615'		IFT		003203'		IPSTK		013057'		LCS		006523'	
ICBE1		031552'		IH		002325'		IRCHK		016400'		LE		002275'	
ICBE10		031606'		IID1		021505'		IRH1		030106'		LEC		006257'	
ICBE2		031555'		IIDB		021503'		IRH2		030114'		LEUSR		002273'	
ICBE20		031613'		IINBUF		000030	SPD	IRH3		030123'		LF0		030760'	
ICBE3		031557'		IL		002317'		IRHDR		030102'		LF1		030754'	
ICBE4		031564'		ILNPPG		000070	SPD	ISPEC		002304'		LFA		031000'	
ICBE5		031565'		ILUSR		002315'		ISYIB		030303'		LFB		031001'	
ICBE6		031571'		IM02		032056'		ISYIB0		030311'		LFP		030776'	
ICBE7		031576'		IM03		032057'		ISYIB1		030314'		LGZ		000006	SPD
ICBEG1		031532'		IM04		032063'		ISYIB2		030323'		LI		031151'	
ICBEG2		031537'		IM05		032067'		IT		000000	SPD	LIBOOT		031150'	
ICBEND		031541'		IM06		032072'		IT0		021647'		LINEI		006255'	
ICCHR		006571'		IM07		032077'		IT1		021661'		LIS1		023511'	
ICCTRM		006572'		IM08		032106'		IT2		021667'		LIS2		023516'	
ICE		031716'		IM09		032115'		IT3		021672'		LIS3		023532'	
ICESC		025777'		IM0A		032122'		IT4		021701'		LISTI		006252'	
ICF		031727'		IM0B		032126'		IT8		021720'		LITS		034112'	
ICH		000010	SPD	IM0C		032131'		IT9		021722'		LLABEL		000464'	
ICHPLN		000170	SPD	IM0D		032135'		ITBLT		021734'		LLC		000465'	
ICJMP		006573'		IM0E		032141'		ITEOF		021726'		LNLEFT		002765'	
ICM		031312'		IM0F		032145'		ITIOER		021732'		LNPPG		002761'	
ICN		031673'		IM10		032152'		ITP		021645'		LOBYTE		022563'	
ICOUT		032003'		IM11		032156'		ITXTSZ		000150	SPD	LOC		022612'	
ICOUT1		032007'		IM12		032163'		IXSC1		027433'		LOC0		022614'	
ICR		031676'		IM13		032166'		IXSC2		027437'		LOCAL		006433'	
ICRL1		031370'		IM14		032174'		IXSC3		027440'		LOCN		022617'	
ICRL2		031372'		IM15		032176'		IXSC4		027445'		LOEOL		022603'	
ICRLY		031354'		IM16		032202'		IXSC5		027447'		LOH		002301'	
ICRLY0		031356'		IM17		032207'		IXSCAN		027424'		LONUM		022536'	
ICRR		031712'		IM18		032217'		IZ		016103'		LONUM0		022535'	
ICSA		031662'		IM19		032226'		IZ0		016143'		LONUM1		022540'	
ICSA1		031665'		IM1A		032232'		IZ2		016161'		LOSCHN		000003	SPD
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 21-5
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE

LOSTR		022546'		LSRT2		022465'		MD1		026421'		MSOTPF		034062'	
LOSTR1		022547'		LSRT3		022445'		MDPAIR		006420'		MSRNB		033701'	
LOSTR6		022553'		LSRT4		022450'		MEMBAS		035373'		MSRRGT		033653'	
LOTTL		022523'		LSRT5		022502'		MEND	032000	000000		MSRV		034005'	
LOTTL1		022532'		LSRT50		022506'		MIALL		002743'		MSSD		033533'	
LPAREN		000004	SPD	LSRT51		022520'		MIBMAX		077776	SPD	MSSE		034002'	
LPASS1		000004	SPD	LST		022165'		MIDAP		002744'		MSSNOR		033512'	
LPASS2		000010	SPD	LSTART		022364'		MIDATA		002534'		MSSPCO		034047'	
LPG		003246'		LSTBUF		003251'		MIEND		002732'		MSTIME	047000	000023	
LPPMAX		777777	SPD	LSTDTL		020000	SPD	MIHDR		002532'		MSTMI		033632'	
LPPMIN		000004	SPD	LSTLN		002762'		MITYP		000002	SPD	MSTMNR		033672'	
LPSR		024701'		LSTMSK		000777'		MKSHAD		200000	SPD	MSTTL		034071'	
LPSRV		000003	SPD	LSTOP		023540'		MLTLST		000002	SPD	MSTYP		000004	SPD
LS1		022214'		LSTR61		022554'		MM		006325'		MSUE		033720'	
LS1A		022225'		LSTTTL		010000	SPD	MM1		006326'		MSUOC		033741'	
LS2		022210'		LSVCNT		003250'		MMNIU		033476'		MSUS		033752'	
LS2A		022212'		LSVL1		022731'		MNX		024654'		MSYSAV		013062'	
LS3		022302'		LSVL2		022741'		MOA		000557'		MTMMA		033502'	
LS4		022313'		LSVL3		022744'		MODULE		006330'		MTMO		033470'	
LS4B		022310'		LSVLNE		022727'		MONTH		002774'		MV		026444'	
LS5		022326'		LSVP		006251'		MOORG		000623'		MV0		026445'	
LS5A		022336'		LSVSIZ		003000	SPD	MOUSE		000667'		MVI		026467'	
LS5B		022333'		LSX		002000	SPD	MS36MI		033556'		MVM		026461'	
LS5C		022353'		LTT		003245'		MSAIUM		033614'		MVM1		026465'	
LS5D		022360'		LVV		006423'		MSANPT		033571'		MVN		026454'	
LS5E		022332'		M		000014		MSEI		033757'		MWMAX		002775	SPD
LS5F		022324'		MA		000015	SPD	MSESE		033774'		MY		020364'	
LS5G		022355'		MACARG		013066'		MSFCI		034026'		NADAB		016772'	
LS8		022267'		MACBUF		013106'		MSHDR		002532'		NADEX		016774'	
LS8F		022245'		MACCNT		013053'		MSIB0		027451'		NADFPN		002330'	
LS8R		022252'		MACCUR		013052'		MSIB1		027452'		NAO		000014	SPD
LSC0		022646'		MACEN1		025556'		MSIC		034022'		NB		000002	SPD
LSC1		022654'		MACEND		025521'		MSIE		033732'		NCARGS		000020	SPD
LSC1A		022664'		MACFRE		013047'		MSIH		033577'		NCLM		006450'	
LSC1B		022661'		MACI		013054'		MSIL		033710'		NED		000011	SPD
LSC2		022667'		MACN		013055'		MSILO		034056'		NEWSEC		000020	SPD
LSC3		022672'		MACSET		017767'		MSILT		033745'		NIBSW		000200	SPD
LSC4		022702'		MACST0		017773'		MSIOC		033736'		NIPD		000020	SPD
LSC5		022710'		MACSTK		013056'		MSIORG		033520'		NLBF		000010	SPD
LSCEOL		001000	SPD	MACTXT		013064'		MSKILL		034077'		NLSTOP		000005	SPD
LSCHR		022714'		MACVER		013051'		MSLFF		033551'		NMACA		000020	SPD
LSCHR1		022722'		MAE	034000	000000		MSMEIR		033664'		NMARGS		013065'	
LSCNF		020000	SPD	MAEND		025577'		MSMES		033641'		NNEST		000002	SPD
LSCOPY		022634'		MAMBP2		033725'		MSMLF		033714'		NOAUX		032337'	
LSF		040000	SPD	MARG	033000	000000		MSMNI		033565'		NOLIST		000040	SPD
LSI		000004	SPD	MARG1		025563'		MSMOF		033607'		NOMACX		000020	SPD
LSL		100000	SPD	MASCAN		040000	SPD	MSMSTY		000001	SPD	NORPT		003145'	
LSLOCK		400000	SPD	MBMAX		000777	SPD	MSMUO		033767'		NOS		000024	SPD
LSPACE		000776'		MBSCAN		100000	SPD	MSNEP		033622'		NPDS		000120	SPD
LSPEC		000754'		MBSIZ		000017	SPD	MSNRS		034036'		NPG		000004	SPD
LSR		000400	SPD	MBSPNT		020331'		MSONU		034011'		NPGD		000200	SPD
LSRT0		022375'		MCHCNT		013061'		MSOOM		034015'		NRDATA		002534'	
LSRT1		022407'		MD		026413'		MSOOR		033602'		NREND		002732'	
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 21-6
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE

NRHDR		002532'		PCP1		000553'		QER1		025230'		RRV		000001	SPD
NSB		000010	SPD	PCP2		000554'		QPC		025430'		RSTCMD		030575'	
NSD		000003	SPD	PCPO		030647'		QUOTE		030730'		RUSING		003165'	
NU		000004	SPD	PCV1		000555'		QUOTE1		030726'		RX		024766'	
NVS		000020	SPD	PCV2		000556'		R1		003161'		RX0		024765'	
OBJNAM		002307'		PDS		000040'		RAC		031654'		RX0V		000011	SPD
OBJNM1		002310'		PE		000007	SPD	RADIX		006334'		RX1		025020'	
OBR		006412'		PE1		025253'		RBIT		032676'		RX1U		025051'	
OH		000001	SPD	PERC		000012	SPD	RBRAK		000010	SPD	RX3		025023'	
OIF		021205'		PET1		006260'		RCMD1		030604'		RXF0		025011'	
OIFE		021253'		PET2		006300'		RECHK		016373'		RXV		000010	SPD
OJF		021261'		PF		025257'		RELABL		003207'		RY		020157'	
OJF1		021264'		PGSIZ		004000	SPD	RELAY		032304'		RY1		020164'	
OJFE		021276'		PGT		012647'		RELAY0		032306'		RY2		020165'	
OLF		021300'		PI0		027524'		RELAY1		032316'		RY5		020173'	
OLF1		021313'		PI1		027534'		RELAYA		032330'		RY6		020201'	
OLFE		021325'		PI10		027643'		RELAYB		032332'		S		000001	
OLPAR		000015	SPD	PI11		027647'		RELINE		003206'		SAVCHR		002763'	
OP		000010	SPD	PI5		027557'		RELOCL		003210'		SAVIP		025640'	
OPCODE		003160'		PI6		027574'		REMAC		020337'		SC1		020632'	
OPEN		006454'		PI7		027605'		REMAC1		020345'		SC2		020645'	
OPS		000235'		PI8		027615'		REMAC2		020351'		SC3		020651'	
OPSS		000340'		PI9		027633'		REMBLK		020332'		SCER1		030571'	
ORPAR		000016	SPD	PIB0		027466'		RESET	047000	000000		SCER2		030573'	
OS		000007		PIB1		027507'		RESIP		025651'		SCNT		002746'	
OSYIB		030051'		PIB2		027512'		RETURN	263040	000000		SCP2		020654'	
OSYIB1		030053'		PIB3		027522'		REVISI		000006	SPD	SCPC		030632'	
OSYIB4		030074'		PIB4		027467'		RI		025115'		SDI		031763'	
OT		000017	SPD	PIB5		027504'		RI1U		025131'		SDI0		031761'	
OUTCHI	051700	000000		PJOB	047000	000030		RI2		025140'		SECNUM		003142'	
OUTCHR	051040	000000		PJS	260040	000000		RI2U		025157'		SEGSAV		000471'	
OUTSTR	051140	000000		PLB		003244'		RI2V		000005	SPD	SEGTAB		000511'	
OUTSYM		023050'		PREC		000000'		RIP		026077'		SEGTOP		000531'	
P6		006456'		PRPCOD		004000	SPD	RIP1		026106'		SEMIC		000012	SPD
PAB		003243'		PRPTOK		001000	SPD	RIP2		026116'		SETCMD		030521'	
PAGNUM		003143'		PRTVER		030606'		RIPX		032014'		SETFCS		030624'	
PBS		030661'		PS1LST		000010	SPD	RIPXN		000041	SPD	SETLS0		030403'	
PBY		026671'		PSI0		027727'		RIV		000004	SPD	SETLS1		030430'	
PBY7		026702'		PSI1		030000'		RLINEI		003232'		SETLS2		030410'	
PC		000551'		PSI10		030032'		RPAREN		000005	SPD	SETLS4		030435'	
PC0		016762'		PSI11		030035'		RPC		003222'		SETLS5		030437'	
PC02		016763'		PSI13		027777'		RPF		003205'		SETMOD	047000	777752	
PC04		016765'		PSI2		030002'		RPI		003216'		SETRLY		030627'	
PC2		016703'		PSI3		030017'		RPL		003212'		SF		024710'	
PC22		016714'		PSI4		030021'		RPLC		003226'		SFV		000001	SPD
PC222		016735'		PSIB0		027725'		RPMAC		003236'		SHAD1		020731'	
PC9CT		000027	SPD	PSIB1		027714'		RPMAX		000004	SPD	SHAD2		020743'	
PC9D		017037'		PSIBE1		030076'		RPPTR		003211'		SHADOW		020726'	
PC9V		017010'		PSIBE2		030100'		RR		024710'		SHASHT		010617'	
PCER		016732'		PTB		003242'		RR0		024711'		SHBEG		020753'	
PCL		006254'		PUTMCH		023311'		RR1		024714'		SHBUG		021074'	
PCORG		006253'		PVER1		030612'		RR1V		000002	SPD	SHBUG1		021106'	
PCP		000552'		QER	031000	000000		RR2		024717'		SHEND		021025'	
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 21-7
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE

SHEND1		021026'		SW3		021626'		TNX		006431'		UCRX		020476'	
SHEND2		021027'		SW4		021641'		TOCT		022042'		UCRX0		020467'	
SHEND3		021042'		SWAP		021552'		TOCT1		022043'		UCRX1		020506'	
SHEND4		021054'		SWAPC		000774'		TOM		006443'		UCRX3		020517'	
SHEND5		021056'		SWMIN		006432'		TP		006337'		UCRX30		020510'	
SHEND6		021062'		SWRAN		003155'		TR		000770'		UCW		020445'	
SHEND7		021065'		SX2		003164'		TRADIX		006333'		UCX		020567'	
SHEND8		021072'		SYBUFF		002752'		TRUTH		003201'		UCY		020537'	
SHMID		020762'		SYDAP		002744'		TSPEC		000757'		UCY2		020545'	
SHMID1		020764'		SYDATA		002534'		TTLBF		003010'		UDISP		003166'	
SHMID2		020765'		SYEND		002732'		TTLDAT		022747'		UGZ		000005	SPD
SHMID3		021010'		SYHDR		002532'		TTLFND		000040	SPD	UL		006323'	
SHMID4		021021'		SYLOCK		002331'		TTLMIN		000056	SPD	UM		006324'	
SHMID5		021023'		SYMSIX		030353'		TTLSIZ		000024	SPD	UMIN		000003	SPD
SHNEW		020717'		SYMSIZ		023036'		TU		025441'		UNSW		003175'	
SHOLD		020712'		SYPROP		100000	SPD	TU1		025445'		UPAR		000013	SPD
SIXMSK		023042'		SYPRPM		040000	SPD	TU2		025447'		UPLU		000002	SPD
SIXTAB		030364'		SYSHNU		200000	SPD	TU3		025452'		UTRUIF		400000	SPD
SL0		031005'		SYSNO		003146'		TU4		025454'		UUO		025506'	
SL1		031010'		SYTYP		000003	SPD	TU5		025457'		UUOTAB		025513'	
SL2		031022'		SYUNDF		400000	SPD	TU5A		025466'		UX		006322'	
SL2A		031032'		TAB		000001	SPD	TUN		025443'		V		000004	
SL2B		031035'		TCH		000014	SPD	TXTOUT		003144'		VALS		000236'	
SL2C		031047'		TE		000764'		TXTSIZ		002764'		VALSF		000237'	
SL2D		031076'		TI1		027711'		TYMPRP		000020	SPD	VALSFS		000300'	
SL2E		031105'		TIB		027676'		TYP6		022000'		VALSS		000240'	
SL2F		031112'		TIMER	047000	000022		TYP6A		022005'		VB		000012	SPD
SL2G		031113'		TIMFIX		003172'		TYP6C		000466'		VBSEEN		000002	SPD
SL2H		031114'		TINASS	047000	777736		TYPE1		025220'		VER		016212'	
SL5		031012'		TIV		006400'		TYPE2		025226'		VERSIO		000001	SPD
SLASH		000007	SPD	TL		000762'		TYPEI		025215'		VM		026475'	
SLEEP	047000	000031		TLE		025264'		TYPEM		021767'		VM1		026501'	
SPLICE		020616'		TLE0		025312'		TYPEM1		021770'		VMI		026511'	
SSIX1		030355'		TLE1		025321'		TYPEM2		021776'		VMI1		026513'	
STAR		000006	SPD	TLE1A		025333'		TYPEOL		021750'		VS		000006	
STC1		032532'		TLE2		025337'		U		000005		VTAB		006525'	
STC1A		032536'		TLE3		025344'		UAF		000003	SPD	VTABP		006524'	
STC2		032550'		TLE3A		025352'		UAT		000000	SPD	W		000010	
STC2A		032552'		TLE3B		025357'		UBID		021541'		WAIT	047000	000010	
STCOS		032520'		TLE3B1		025363'		UBSLH		000001	SPD	WCLM		006447'	
STDC1		032522'		TLE3C		025365'		UC		020424'		X		000011	
STDC2		032542'		TLE4		025370'		UC1		020431'		X0		000000	SPD
STDCOS		032517'		TLE4A		025371'		UC9		020613'		X1		000001	SPD
STDTOM		032513'		TLE7		025422'		UCBF		020552'		X2		000002	SPD
STDTTL		002766'		TLE7A		025423'		UCBF1		020565'		X3		000003	SPD
STLBF		003060'		TLE9		025403'		UCC		003156'		X4		000004	SPD
STLMIN		000031	SPD	TLE9A		025410'		UCER1		020530'		X5		000005	SPD
STLSIZ		000031	SPD	TLSIZE		000767'		UCERC		000224'		X6		000006	SPD
STTOM		032514'		TMES	035000	000000		UCERN		000010	SPD	X7		000007	SPD
STTOM1		032515'		TMPCOR	047000	000044		UCH		020460'		X8		000010	SPD
SUPLST		000002	SPD	TN		022015'		UCH1		020464'		X9		000011	SPD
SW1		021576'		TN0		022014'		UCMUL		020604'		XA		000012	SPD
SW2		021606'		TN1		022026'		UCPCT		000225'		XA1		026275'	
NAD   NODE ASSEMBLER AND DEBUGGER.	MACRO 12.5-46.0 10:20  5-SEP-87 PAGE 21-8
NAD01.R06	24-JUL-87 17:39		SYMBOL TABLE

XASC		026255'		.IACHR		000001	SPD	
XB		000013	SPD	.IAESC		000000	SPD	
XBITN		000044	SPD	.IALOS		000005	SPD	
XC		000014	SPD	.IAZAP		000007	SPD	
XD		000015	SPD	.JBFF		030546'	EXT	
XE		000016	SPD	.JBREN		016166'	EXT	
XF		000017	SPD	
XI		026277'		
XI1		026320'		
XIBF		026333'		
XICMA		026664'		
XID		026401'		
XIRI1		026352'		
XIRI2		026373'		
XIRR		026403'		
XIRX		026343'		
XIRX1		026353'		
XIRX2		026356'		
XIRX3		026364'		
XIRX3R		006417'		
XIU		006427'		
XIVU		006425'		
XIW		006430'		
XM		026236'		
XM1		026237'		
XN		026233'		
XPS		020710'		
XPSBI		023400'		
XPSBI1		023377'		
XS		026265'		
XVER		026225'		
XVJ		026220'		
XVU		026212'		
XVUB		026227'		
XVV		033400	SPD	
Y		000012		
YEND		006605'		
YEND1		006606'		
YENDSV		006604'		
YHASHT		006610'		
YSUM		006607'		
ZAPCHN		000002	SPD	
ZAPCIR	047000	777733		
.CHIBF		000022	SPD	
.CHIN		000014	SPD	
    j@U