		SUBTTL SYSTAT:  LOW SEGMENT CODE -- NONZERO INFORMATION
		IF1 <PRINTX SSLOW>
	MAINSW==0	;INDICATES NOT MAIN PROGRAM
	
	
		INTERN	NODIOWD,TRUIOWD,SYSPPN,QTAB,LQTAB
		INTERN	BL.TTY,BL.NOD,BL.DUL,BL.LUD
		INTERN	.DVIOS,.TIM,.TYM,.USRN1,.USRN2,.TTY,.TTYN
		INTERN	.STS,.SWP,.PPN,.PRV,.SGN,.PRG,.DEV,.SEGCT
		INTERN	FIRKU	;EXIT CODE FOR SYSTAT
		INTERN	TCKSEC,NSPMEM
	
	
	;ALL INFORMATION HERE IS NONZERO INFORMATION
	;IN THE LOW SEG.
	;ONLY INFORMATION WHICH IS NONZERO AND CHANGES SHOULD BE
	;PUT INTO THIS AREA
	
		RELOC 0
	
	; IOWD FOR THE DUMP IN OF THE NODE.SYS FILE
	NODIOWD:  IOWD	%NODSIZE,%NODBUFF
		Z
	TRUIOWD:  IOWD	%TRUSIZE,%TRUBUFF
		Z
	
	SYSPPN:	XWD	1,1		;PPN OF "SYS" (MODIFIED BY PGM)
	
	QTAB:	SIXBIT /RNWSTS/
		SIXBIT /STAUMQ/
		SIXBIT /DADTDC/
		SIXBIT /MTIOTT/
		SIXBIT /SLNL^C/
		SIXBIT /AABBCC/
		SIXBIT /DDEEFF/
		SIXBIT /GGHHII/
		SIXBIT /JJKKLL/
		SIXBIT /MMNNOO/
		SIXBIT /PPQQRR/
	LQTAB==QTAB-.
	
	; BLOCKS FOR LOOKUP DURING INITIALIZATION
	BL.TTY:	SIXBIT	/SYSTAT/	;ON ENTER OF SYSTAT: OR TTY:
		SIXBIT	/LST/		;USE THIS NAME
		Z
		Z
	
	BL.NOD:	SIXBIT	/NODES/		;NODES.MAP FILE
		SIXBIT	/MAP/
		Z
		XWD	21477,175251	;(TYMNET) PPN
	
	BL.DUL:	SIXBIT	/DUL/		;DUL.SYS FILE
		SIXBIT	/SYS/
		Z
		Z
		Z
	
	BL.LUD:	SIXBIT	/LUD/		;LUD.SYS FILE
		SIXBIT	/SYS/
		Z
		Z
		Z
	
	IFN FTTRUCTL,<
		INTERN	BL.TRU,BL.TUS
	BL.TRU:	SIXBIT	/LTCURT/		;LTCURT.DAT FILE
		SIXBIT	/DAT/
		Z
		XWD	0,BL.TUS
		Z
	BL.TUS:	SIXBIT	/PJ          /
	> ; ASSEMBLE ABOVE FOR TRU CONTROL STUFF
	
	.DVIOS:	XWD	J,0	;L
	.TIM:	XWD	J,0	;L	RUN TIME
	.TYM:	XWD	J,0	;L	TYMNET INFORMATION
	.USRN1:	XWD	J,0	;L	USER NAME PART ONE
	.USRN2:	XWD	J,0	;L	USER NAME PART TWO
	.TTY:	XWD	J,0	;L	TELETYPE LINE NAME
	.TTYN:	XWD	J,0	;L	TTY LINE NUMBERS
	IFN FTCONN,<
		INTERN	.CON
	.CON:	XWD	J,0	;L	CONNECT TIME>
	IFN FTFROM,<
		INTERN	.FRM
	.FRM:	XWD	J,0	;L	WHO OWNS THIS PROGRAM>
	IFN FTDSIO,<
		INTERN	.DSIO
	.DSIO:	XWD	J,0	;L	DSK IO COUNT>
	IFN FTCHIO,<
		INTERN	.CHIO
	.CHIO:	XWD	J,0	;L	CHARACTER IO COUNT>
	IFN FTUSIO,<
		INTERN	.USIO
	.USIO:	XWD	J,0	;L	USETI/USETO COUNT>
	.STS:	XWD	J,0	;L+H
	.SWP:	XWD	J,0	;L+H
	.PPN:	XWD	J,0	;L+H
	.PRV:	XWD	J,0	;L	JBTPRV NUMBER
	.SGN:	XWD	J,0	;L
	.PRG:	XWD	J,0	;L+H
	.DEV:	XWD	J,0	;L+H
	.SEGCT:	XWD	A,0	;H
	
	;CODE TO ZERO OUT SYSTAT TO SAVE SPACE ON SWAPPER
	;
	FIRKU: ; HERE IS WHERE THE EXIT CODE FOR SYSTAT LIVES
		RELEASE	NOD,		;RELEASE CHANNEL FOR NODES.MAP
	IFG FTZCOR,<MOVEI	A,FIRKIT
		HRLI	A,1		;A=   1,,FIRKIT
		CORE	A,		;MAKE NO HIGHSEG AND SMALL LOWSEG
		 JRST	NOCOR		;OUT OF CORE
		EXIT	1,
	>; ABOVE IF ZERO CORE BY HAND
	IFL FTZCOR,<
	PRINTX ERROR !! THERE IS NO CODE FOR FTZCOR = -1 (UUO CORE ZERO)
	PRINTX NORMAL EXIT UUO ENTERED.
		EXIT	1,
	>; ABOVE IF UUO CORE ZEROER
	IFE FTZCOR,<
		EXIT	1,
	>; ABOVE IF NORMAL NO-CORE EXIT
	FIRKIT:	JRST	.-1		;AND STAY OUT
	
	TCKSEC:	JIFSEC			;JIFFIES PER SECOND
	MEMNSP:	NSPMEM			;CORE SPEED
		SUBTTL	LOW SEGMENT CODE -- ZERO INFORMATION
	
		INTERN	PDL,%NODBUFF,LASPPN,LASPRI,LASPRV,TEMP,DDBTBL,EDDBTBL
		INTERN	SVJOB,JOBTBL,NOJSWT,LDVLST,SVFIL,SVEXT,SVPPN
		INTERN	SVMOD,TEMP1,FONE,SAVLIC,DBLOCK,SPEC,TISL,ACTUSE
		INTERN	LOWUSE,DULOPN,LUDOPN,UFDLCS,MESPC,HOMJOB,MYHOME
		INTERN	INTFLG,PSP1,PSP2,PSP3,SCNTIM,STWONM,PSPSW,TYOB
		INTERN	TTYBUF,SEGPTR,JOBN,SEGN,BOTH,CORMAX,CORUSE,NUMJOB
		INTERN	CURPOS,LINLOL,TYOFLG,TYOPTR,LINCTR,LASPTR,PTR1
		INTERN	PTR2,SAVPTR,FLGPOS,DSKUSE,DSKFRE,FREE,TMPDSK
		INTERN	ZERLOW,ZERHGH,DATE,STATES,ME,SHORTY,FRSHLF,OPR
		INTERN	TOTUSE,INMGAN,INMUUN,RUN,IO,TIO,SPC,DIO,DET,MYJOB
		INTERN	MYUUN,MYGAN,CORSAV,NOHEAD,LPTCSW,TROEXT,NOSPIT
		INTERN	CONSWT,DISPLA,LASJBF,SAVWD,RPGSW,SVIND,LASWT,NUMAT
		INTERN	SYSTAP,UNM1,FSFPPN,DLOC
		INTERN	CURFS,CURUN,CUINC,PRCCNT,UNIBLK,SYSUNI,SWPUNI
		INTERN	DSKBLK,DSKDDB,LOGNAM,NOW,MAXGTB,OFSGTB,PTYS
		INTERN	ONEJOB,SAVCHR,SEGFLG,BUF,LASBP1,LASBPA,TEMEND
		INTERN	TYOOFL,TYOBUF,MEMNSP,LOWEND
		INTERN	EVERSW,OLDSW,NORMSW,SVF,SVF1,SVNM1,SVNM2
		INTERN	SVFIEL,RESULT,%DAY,%MONTH,%YEAR,%KEY
		INTERN	KY.PRG,KY.PPN,KY.TTN,KY.USN,CN.TIM
	
	
	;ALL INFORMATION HERE IS ZERO INFORMATION
	;IN THE LOW SEG.
	;ONLY INFORMATION WHICH IS ZERO AND CHANGES SHOULD BE
	;PUT INTO THIS AREA (IE- BLOCK STATEMENTS)
	
	LOWEND:				;START OF ZEROED AREA
	
	PDL:	BLOCK	LN.PDL+1	;PUSH-DOWN LIST
	%NODBUFF: BLOCK	%NODSIZE	;THIS IS THE NODE TABLE
	IFN FTTRUCTL,<
		INTERN	%TRUBUFF
	%TRUBUFF: BLOCK %TRUSIZE	;THIS IS THE TRU FILE
	>
	LASPPN:	BLOCK	1		;LUDCHK PUTS PPN OF USER HERE
	LASPRV:	BLOCK	1		;LUDCHK PUTS LUD WORD 2 HERE
	LASPRI:	BLOCK	1		;LUDCHK PUTS LUD WORD 3 HERE
		BLOCK	2		;EXTRA WORDS
	
	TEMP:	BLOCK	1
	DDBTBL:	BLOCK	<4*NOFILES>+1	;/FILES - MAX NO. (4 WORDS/ENTRY)
	EDDBTBL==.-1	;END OF DDB TABLE
	SVJOB:	BLOCK	1	;OPEN FILE STATISTICS
	JOBTBL:	BLOCK	MX.JOB+1;ON SELECTIVE SEARCH **IF** -1 OK
	NOJSWT:	BLOCK	1	;USED DURING COMMAND SCANNER ON /NOJOB
	LDVLST:	BLOCK	1	;LAST CALL TO CALLI A,-24
	SVFIL:	BLOCK	1	;USE IN OPEN FILE STUFF
	SVEXT:	BLOCK	1	;DITTO
	SVPPN:	BLOCK	1	;DITTO
	SVMOD:	BLOCK	1	;SAVE OF DEVMOD
	TEMP1:	BLOCK	1
	FONE:	BLOCK	1	;FLAG FOR WHERE COMMAND
	SAVLIC:	BLOCK	1	;AT SYSTAT TIME: SAVE'S USERS LICENSE
	DBLOCK:	BLOCK	LN.UDB	;DEVICE DATA BLOCK FOR CALLI AC,-24 (SYSDVF)
	SPEC:	BLOCK	3	;FOR WHERE COMMAND OPEN SPEC
	
	TISL:	BLOCK	1	;WAIT STATE CODES FOR TI AND SL
	ACTUSE:	BLOCK	1	;ACTIVE VIRT CORE USED
	LOWUSE:	BLOCK	1	;TOTAL VIRT CORE IN LOW SEGS
	DULOPN:	BLOCK	1	;ONES IF DUL OPEN ON DUL CHANNEL
	LUDOPN:	BLOCK	1	;ONES IF LUD OPEN ON LUD CHANNEL
	UFDLCS:	BLOCK	1	;FOR UFD LOCATOR ON DUL SEARCH
	MESPC:	BLOCK	1	;SET ONES TO PRINT USERNAME AS 12 CHARS, ZERO TO TRUNCATE TRAILING SPACES
	HOMJOB:	BLOCK	1
	MYHOME:	BLOCK	1
	INTFLG:	BLOCK	1	;#0 INIT RUN ON GA (PJ/POPJ)
	PSP1:	BLOCK	1	;CONTAINS PHYSICAL PACK NAME
	PSP2:	BLOCK	1	;CONTAINS PACK I.D.
	PSP3:	BLOCK	1	;CONTAINS LOGICAL PACK NAME
	SCNTIM:	BLOCK	1	;SYS DISK: 0 IF 1ST TIME, -1 IF 2ND TIME
	STWONM:	BLOCK	1	;SYST DISK: -1 IF NULL STR, ELSE 0
	PSPSW:	BLOCK	1	;#0 IF PSP COMMAND
	TYOB:	BLOCK	3	;LISTING DEVICE OUTPUT BUFFER POINTERS
	TTYBUF:	BLOCK	220	;LISTING DEVICE OUTPUT BUFFER
	
	SEGPTR:	BLOCK	1	;LH=-# SEGS, RH=# JOBS
	JOBN:	BLOCK	1	;NUMBER OF JOBS IN SYSTEM
	SEGN:	BLOCK	1	;NUMBER OF SEGMENTS IN SYSTEM
	BOTH:	BLOCK	1	;JOBN + SEGN
	
	CORMAX:	BLOCK	1	;SIZE OF USER CORE
	CORUSE:	BLOCK	1	;TOTAL SWAP&CORE PAGES USED
	NUMJOB:	BLOCK	1	;NUMBER OF ACTIVE JOBS
	CURPOS:	BLOCK	1	;CURRENT POSITION ON TTY
	LINLOL:	BLOCK	1	;MAX. LOL FOR OUTPUT LINE (SEE TYO)
	TYOFLG:	BLOCK	1	;-1 IF TYO SET UP, ELSE 0 (NEEDS INIT)
	TYOPTR:	BLOCK	1	;BUFFER POINTER FOR TYO
	TYOBUF:	BLOCK	^D550/5	;TYO OUTPUT BUFFER
	TYOOFL:	BLOCK	1	;IF TYO SLIPS TO HERE, TTY OUTPUT OVERFLOW
	LINCTR:	BLOCK	1	;TYO LINE COUNTER
	LASPTR:	BLOCK	1	;TYO LAST-SPACE-SEEN-SAVED-PTR1
	PTR1:	BLOCK	1	;TYO SCANNER POINTER
	PTR2:	BLOCK	1	;TYO OUTPUT-LAST-FROM-HERE-POINTER
	SAVPTR:	BLOCK	1	;PCHV OF PTR1
	FLGPOS:	BLOCK	1	;POSITION OF END OF NEXT FIELD (:FIELD:)
	DSKUSE:	BLOCK	1	;SWAPPING SPACE USED
	DSKFRE:	BLOCK	1	;SWAPPING SPACE AVAILABLE(XK4SWP)
	
	FREE:	BLOCK	1	;TEMPORARY JOBFF
	TMPDSK:	BLOCK	1	;TEMP STORAGE FOR DSK ERR REPORTER
	ZERLOW:	BLOCK	1	;FIRST ADDRESS OF DYNAMIC TABLES
	ZERHGH:	BLOCK	1	;LAST ADDRESS OF DYNAMIC TABLES
	
	DATE:	BLOCK	1	;TODAY'S DATE
	STATES:	BLOCK	1	;SYSTEM STATES WORD
	ME:	BLOCK	1	;MY PPN
	SHORTY:	BLOCK	1		;IS 0 IS LONG, #0 IS SHORT
	FRSHLF:	BLOCK	1	;FIRST HALF USER NAME USER NAME SCAN
	SRCHLF:	BLOCK	1	;SECOND HALF USER NAME USER NAME SCAN
	OPR:	BLOCK	1	;NAME OF "OPR" DEVICE
	TOTUSE:	BLOCK	1	;TOTAL # USERS
	INMGAN:	BLOCK	1	;TOTAL # USERS IN MY GAN
	INMUUN:	BLOCK	1	;TOTAL # USERS IN ME !!
	RUN:	BLOCK	1	;USECMD: RUN QUEUE COUNT
	IO:	BLOCK	1	;USECMD: IO QUEUE
	TIO:	BLOCK	1	;USECMD: TTYIO QUEUE COUNT
	SPC:	BLOCK	1	;USECMD: SPECIAL QUEUE
	DIO:	BLOCK	1	;USECMD: DISK IO COUNT
	DET:	BLOCK	1	;USECMD: DET COUNT
	MYJOB:	BLOCK	1	;MY JOB NUMBER
	MYUUN:	BLOCK	1	;MY UNIVERSAL USER NUMBER
	MYGAN:	BLOCK	1	;MY GLOBAL ACCOUNT NUMBER
	CORSAV:	BLOCK	1	;VIRTUAL CORE SAVED BY SHARING
	NOHEAD:	BLOCK	1		;-1 IF NO HEADINGS
	LPTCSW:	BLOCK	1		;-1 IF /LPT SW ELSE 0
	TROEXT:	BLOCK	1		;-1 IF /EXTRA FLAGGED
	NOSPIT:	BLOCK	1	;/NOHEAD SET'S TO -1
	CONSWT:	BLOCK	1	;-1 IF DISPLAY HACK
	DISPLA:	BLOCK	1	;-1 IF IM A DISPLAY
	LASJBF:	BLOCK	1	;SAVE JOBFF ON GA:
	SAVWD:	BLOCK	1	;SAVES WD DURING SWITCH SEARCHED
	RPGSW:	BLOCK	1	;-1 IF CALL FROM RPG ELSE 0
	SVIND:	BLOCK	1	;SAVES INDEX DURING SWITCH LOOKUP
	LASWT:	BLOCK	1	;LAST SWITCH TYPED
	NUMAT:	BLOCK	1	;NUMBER OF PARTIAL MATCHES
	SYSTAP:	BLOCK	1	;NAME OF SYSTEM TAPE ("SYS:"), 0=DSK:
	UNM1:	BLOCK	1	;USER IN LICENSE PRINT ROUTINE
	FSFPPN:	BLOCK	1	;OPERATOR NUMBER
	DLOC:	BLOCK	20	;BLOCK FOR DSKCHRS
	CURFS:	BLOCK	1	;CURRENT FILESTRUCTURE
	CURUN:	BLOCK	1	;CURRENT UNIT
	CUINC:	BLOCK	1	;INCREMENT FOR CURRENT UNIT
	PRCCNT:	BLOCK	1	;SAVE COUNTER FOR PRDCBT(DISK ERROR) ROUTINE
	UNIBLK:	BLOCK	1
	SYSUNI:	BLOCK	1
	SWPUNI:	BLOCK	1
	DSKBLK:	BLOCK	DSKBKL		;DSKCHR UUO BLOCK
	DSKDDB:	BLOCK	1	;COUNT OF DISK DDB'S
	LOGNAM:	BLOCK	1	;LOGICAL NAME OF THIS DEVICE
	NOW:	BLOCK	1	;CURRENT TIME
	MAXGTB:	BLOCK	1	;LARGEST GETTAB TABLE #
	OFSGTB:	BLOCK	1	;START OF GETTAB TABLE POINTERS
	PTYS:	BLOCK	1	;COUNT OF PTY DRIVEN JOBS
	ONEJOB:	BLOCK	1	;NUMBER OF JOB IF SINGLE
	SAVCHR:	BLOCK	1	;CHARACTER TO RESCAN IF ANY
	SEGFLG:	BLOCK	1	;-1 IF SEGMENT PRINTING
	BUF:	BLOCK	LN.BUF	;BUFFER FOR READING THE DUL
	LASBP1:	BLOCK	1	;VALUE OF LAST DSKBP1 CALL
	LASBPA:	BLOCK	1	;ARGUMENT OF LAST DSKBP1 CALL
	
	;  SWITCHES FOR JOB PRINTOUTS (SYSTAT)
	
	EVERSW:	BLOCK	1
	OLDSW:	BLOCK	1
	NORMSW:	BLOCK	1
	SVF:	BLOCK	1
	SVF1:	BLOCK	1
	
	;  SAVES FOR SYSCOM
	
	SVNM1:	BLOCK	1
	SVNM2:	BLOCK	1
	
	;  SAVES FOR SSIO
	
	SVFIEL:	BLOCK	1
	%DAY:	BLOCK	1
	%MONTH:	BLOCK	1
	%YEAR:	BLOCK	1
	%KEY:	BLOCK	1
	RESULT:	BLOCK	1
	
	;  SAVES FOR SYSTAT (MAIN)
	
	KY.PRG:	BLOCK	1	;PROGRAM SEARCH KEY.
	KY.PPN:	BLOCK	1	;PPN SEARCH KEY.
	KY.TTN:	BLOCK	1	;TTY # SEARCH KEY.
        KY.USN:	BLOCK	2	;USER NAME SEARCH KEY.
        CN.TIM: BLOCK   1       ;TIME FOR CONTINUOUS.
	
	TEMEND==.-1
		END
  