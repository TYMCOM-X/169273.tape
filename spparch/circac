CIRCAC ** FICHE/FRAME BREAK *****
ACSO
C      /ACSO/-/BACSO/ PART OF ACPT2
C        SOLOUT
C
C   ROUTINE THAT OUTPUTS THE SOLUTIONS FROM 'LV', CAN BE NOM.,TEMP.,ETC.
C
      SUBROUTINE SOLOUT (KNT,NOSPID)
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
      DIMENSION LTBLN(15),LTBLD(35) ,IAM(3),IDB(3)
      EQUIVALENCE (JAB(201),LTBLN( 1)),(JAB(216),LTBLD( 1))
       EQUIVALENCE (JAB (151),KDBAP)
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
      EQUIVALENCE (JAB(179),KTBLN),(JAB(178),KTBLD) ,(JAB(177),NTBLN)
     1,(JAB(176),NTBLD)
C
      EQUIVALENCE (JAB( 20),JABZ),(JAB( 21),NFAB),(JAB( 22),INXI)
     1,(JAB( 23),ISDL),(JAB( 24),NPAR),(JAB( 25),NSTM),(JAB( 26),NCOM)
C
      EQUIVALENCE (JAB(276),NSEQ),(JAB(199),NSDE),(JAB(198),NUNK)
     1,(JAB(197),NDEQ),(JAB(196),NMDE)          ,(JAB(200),NSEQO)
      EQUIVALENCE (JAB(191),ITNO)
      EQUIVALENCE (JAB(190),LVR ),(JAB(189),LVI ),(JAB(188),LVA )
     1,(JAB(187),LVP )
      EQUIVALENCE (FAB( 13),FREQ),(FAB( 17),W  ),(FAB( 18),TP    )
C  .........          ..........          ..........          ..........
1     CONTINUE
       IAM(1)=3HAMP
       IAM(2)=3HLIT
       IAM(3)=3HUDE
       IDB(1)=3HDEC
       IDB(2)=3HIBE
       IDB(3)=3HLS
       DO 130 L=1,NUNK
       AR=F(LVR-L)
       AI=F(LVI-L)
       F(LVA-L)=SQRT(AR*AR+AI*AI)
       IF (KDBAP) 130,130,129
129    IF(F(LVA-L)-1.E-20) 142,143,143
142    F(LVA-L)= -.660066 E66
       GO TO 130
143    CONTINUE
       F(LVA-L) = ALOG(F(LVA-L))*8.6858896
130    F(LVP-L)=ATAN(AI,AR)*57.29578
C  NODE AND DEP. EQ. SOL. OUTPUT
       IF(KNT) 500,500,501
501    CONTINUE
       WRITE K94PO,100,(JAB(L),L=1,7)
500    CONTINUE
       WRITE K94PO,103,FREQ
      ITM1 = 1H 
       IF(KNT) 502,502,503
502    CONTINUE
550    FORMAT(/,2X,$#$,2X,$** NODES **$)
C     550    FORMAT (/,2X,A1/)
       GO TO 504
503    IF(KDBAP) 5032,5032,5031
5031  WRITE K94PO,102,ITM1,IDB
       GO TO 5033
5032  WRITE K94PO,102,ITM1,IAM
5033   WRITE K94PO,104
504    WRITE K94PO,99
       WRITE K94PO,550
       WRITE K94PO,99
C
C  KTBLN  CONTROL OUTPUT AND W.C. QUANTITY FOR NODES - KTBLD FOR DEP. EQ
C KTBLN 1=FULL W.C. W/ FULL OUT   2=FULL W.C. W/ CONTROLED OUT.
C KTBLN 3=CONT W.C. W/ FULL OUT   4=CONT W.C. W/ CONTROLED OUT.
         GO TO (300,301,300,301) KTBLN
301    L0=1
132    LEND=L0+3
       IF(LEND-NTBLN) 136,136,137
137    LEND=NTBLN
136   WRITE K94PO,105,(LTBLN(L),F(LVA-LTBLN(L)),L=L0,LEND)
       WRITE K94PO,99
      WRITE K94PO,135,(F(LVP-LTBLN(L)),L=L0,LEND)
       WRITE K94PO,99
       L0=L
       IF(LEND-NTBLN) 132,138,132
138    CONTINUE
      GO TO 302
300    L0=1
332    LEND=L0+3
       IF(LEND-NSEQO) 336,336,337
337    LEND=NSEQO
336   WRITE K94PO,105,(L,F(LVA-L),L=L0,LEND)
       WRITE K94PO,99
      WRITE K94PO,135,(F(LVP-L),L=L0,LEND)
       WRITE K94PO,99
       L0=L
       IF(LEND-NSEQO) 332,338,332
338    CONTINUE
302   ITM1 = 1H 
C  .........          ..........          ..........          ..........
      IF (NDEQ) 148,148,149
149   CONTINUE
       IF(KNT) 505,505,506
505    CONTINUE
209    FORMAT(/,7X,$CURRENT$/)
C      505    WRITE K94PO,550,ITM1
       GO TO 507
506    IF(KDBAP) 5062,5062,5061
5061  WRITE K94PO,102,ITM1,IDB
       GO TO 5063
5062  WRITE K94PO,102,ITM1,IAM
5063   WRITE K94PO,104
507   WRITE K94PO,99
       WRITE K94PO,209
        GO TO (305,306,305,306 ) KTBLD
306    L0=1
432    LEND=L0+3
       IF(LEND-NTBLD) 436,436,437
437    LEND=NTBLD
436   WRITE K94PO,105,(LTBLD(L),F(LVA-LTBLD(L)-NSEQ),L=L0,LEND)
       WRITE K94PO,99
      WRITE K94PO,135,(F(LVP-LTBLD(L)-NSEQ),L=L0,LEND)
       WRITE K94PO,99
       L0=L
       IF(LEND-NTBLD) 432,438,432
438    CONTINUE
      GO TO 148
C
305   NDOS = 1
       ITM3=0
      DO 150 NN=1,NSTM
       IELNUM=0
      ITM1 = JAB(79+NN)
      ITM2 = JAB(49+NN)
       ITM3 = ITM3 + (ITM1*ITM2)
       INCR = 1
      IF (ITM1*ITM2) 150,150,1511
1511   IF(ITM2-1) 200,151,200
151    INCR = 4
200    GO TO (2,3,4,5,8,8) NN
2      WRITE K94PO,202
       GO TO152
3      WRITE K94PO,203
       GO TO 152
4      WRITE K94PO,204
       GO TO 152
5      WRITE K94PO,205
       WRITE K94PO,206
       GO TO 152
8      WRITE K94PO,208,NN
208    FORMAT(//$FAILURE IN SOLOUT--NSTM=$,I2///)
202    FORMAT(/,2X,$#$,2X,$** RESISTORS **$,/)
203    FORMAT(/,2X,$#$,2X,$** INDUCTORS **$,/)
204    FORMAT(/,2X,$#$,2X,$** CAPACITORS **$,/)
205    FORMAT(/,2X,$#$,2X,$** TRANSISTORS **$,/)
206    FORMAT(9X,$IB$,16X,$IC$,16X,$IE$/)
152   DO 154 NNN = 1,ITM1  ,INCR
      NDOE = NDOS + ITM2 -1     +INCR -1
       IF(ITM3-NDOE) 1526,153,153
1526   NDOE = ITM3
153    IF(NN-4) 199,216,199
216    IELNUM=IELNUM+1
       WRITE K94PO,101,IELNUM,(F(LVA-L-NSEQ),L=NDOS,NDOE)
       WRITE K94PO,99
       GO TO 217
199    DO 7 L=NDOS,NDOE
       IELNUM=IELNUM+1
      WRITE K94PO,105,IELNUM,F(LVA-L-NSEQ)
7      CONTINUE
       WRITE K94PO,99
217    WRITE K94PO,135,(F(LVP-L-NSEQ),L=NDOS,NDOE)
       WRITE K94PO,99
154   NDOS = NDOE +1
150   CONTINUE
      IF(NDEQ - NDOS) 148,155,155
155    LO=NDOS
156    LEND=LO+3
       IF(LEND-NDEQ) 158,158,157
157    LEND=NDEQ
158   WRITE K94PO,101,(L,F(LVA-L-NSEQ),L=LO,LEND)
       WRITE K94PO,99
       WRITE K94PO,135,(F(LVP-L-NSEQ),L=LO,LEND)
       WRITE K94PO,99
       LO=L
       IF(LEND-NDEQ) 156,148,148
148   CONTINUE
      RETURN
C
C
99    FORMAT (/)
100   FORMAT  (//,2X,7A3,/ )
101   FORMAT   (I3,1X,E14.7,3E18.7)
102   FORMAT (/,2X,A1,4X,3A3/)
104   FORMAT (7X,$PHASE$/)
C  ..... 101 AND 102 CHANGED TOO -- SPACERS DN. BY 2
135   FORMAT   (4(E18.7)/)
103    FORMAT(/2X,$FREQ. =$,E15.7/)
105    FORMAT(4(I3,1X,E14.7))
      END
CIRCAC ** FICHE/FRAME BREAK *****
ACSO SYMSORT

SYM.  PG.LN. IDENT.

1       1 23 C       100     5 21 C       101     5 22 C       102     5 23 C       
103     5 27 C       104     5 24 C       105     5 28 C       129     1 35 C       
130     2  1 C       132     2 27 C       135     5 26 C       136     2 30 C       
137     2 29 C       138     2 36 C       142     1 36 C       143     1 38 C       
148     5 18 C       149     3 13 C       150     5  6 C       151     4 10 C       
1511    4  9 C       152     4 28 C       1526    4 31 C       153     4 32 C       
154     5  5 C       155     5  8 C       156     5  9 C       157     5 11 C       
158     5 12 C       199     4 37 C       2       4 12 C       200     4 11 C       
202     4 23 C       203     4 24 C       204     4 25 C       205     4 26 C       
206     4 27 C       208     4 22 C       209     3 16 C       216     4 33 C       
217     5  3 C       3       4 14 C       300     2 38 C       301     2 26 C       
302     3 10 C       306     3 27 C       332     2 39 C       336     3  3 C       
337     3  2 C       338     3  9 C       4       4 16 C       432     3 28 C       
436     3 31 C       437     3 30 C       438     3 37 C       5       4 18 C       
500     2  6 C       501     2  4 C       502     2 10 C       503     2 14 C       
5031    2 15 C       5032    2 17 C       5033    2 18 C       504     2 19 C       
505     3 15 C       506     3 19 C       5061    3 20 C       5062    3 22 C       
5063    3 23 C       507     3 24 C       550     2 11 C       7       5  1 C       
8       4 21 C       C       5 25 C       C       3 17 C       
C       3 11 C       C       2 24 C       C       2 23 C       C       2 12 C       
C       2  2 C       C       1 22 C       C       1  2 C       CM      1 16 C       
CM      1 14 C       CM      1  4 C       CM305   3 39 C       CMC     2 22 C       
CMC     1  3 C       CMCM99  5 20 C       
CIRCAC ** FICHE/FRAME BREAK *****
ACSVM
C      /ACSVM/-/BACSVM/  PART OF ACPT2
C        SOLVE
C
C  A ROUTINE TO DIRECT THE SOLUTION OF THE AC EQ.S
C
      SUBROUTINE SOLVE   (KNT)
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
      EQUIVALENCE (JAB( 30),MRES),(JAB( 40),KRES),(JAB( 50),NDQRES)
     1,(JAB( 60),NAMRES),(JAB( 70),MNPRES),(JAB( 80),NRES)
     2,(JAB( 90),IRES),(JAB(100),LRES),(JAB(110),JRES)
      EQUIVALENCE (FAB( 13),FREQ),(FAB( 17),W  ),(FAB( 18),TP    )
      EQUIVALENCE (FAB( 14),SFREQ),(FAB( 15),EFREQ),(FAB( 16),DELF  )
      EQUIVALENCE (FAB( 19),FREQK)
      EQUIVALENCE (JAB(276),NSEQ),(JAB(199),NSDE),(JAB(198),NUNK)
     1,(JAB(197),NDEQ),(JAB(196),NMDE)          ,(JAB(200),NSEQO)
      EQUIVALENCE (JAB(191),KOLPR),(JAB(192),KOPLP)
      EQUIVALENCE (JAB( 83),NXIS ),(JAB(93),IXIS),(JAB(43),KXIS)
      EQUIVALENCE (JAB(190),LVR ),(JAB(189),LVI ),(JAB(188),LVA )
     1,(JAB(187),LVP )
      EQUIVALENCE (JAB(  1),JAB1),(JAB(  2),JAB2),(JAB(  3),JAB3)
     1,(JAB(  4),JAB4),(JAB(  5),JAB5),(JAB(  6),JAB6),(JAB(  7),JAB7)
C  .........          ..........          ..........          ..........
C
       GO TO (1,2) KNT
2      IF(KOPLP) 80,1,82
80     IDR=-KOPLP
       L1=2
       L2=1
       GO TO 83
82     L1=1
       L2=2
       IDR=KOPLP
83     IRC=IRES-IDR*KRES
       IT1=J(IRC-L1)
       IT2=J(IRC-L2)
       KOPLP=1
       PRINT 99
99     FORMAT(4X$FREQ(OPEN LOOP)$/4X$GAIN(MAG)$9X$PHASE$13X$GAIN(DB)$/4X
     1  $ZL REAL$11X$ZL IMAG$/)
1      CONTINUE
       KNTSO=1
       FREQ=SFREQ
24     W=TP*FREQ
C  SET UP INTERNAL NODE OF TRANSISTORS
       NSEQ=NSEQO
       IF(NXIS)69,70,69
69     DO 70 N=1,NXIS
       NN=IXIS-N*KXIS
C  NO NODE FOR A DUMMY CONNECTION
       IF(J(NN)-5) 71,70,71
71     NSEQ=NSEQ+1
       J(NN-4)=NSEQ
70     CONTINUE
       GO TO (3,4) KNT
4      GO TO (31,32,3,3,31) KOPLP
31     NSEQ=NSEQ+2
       GO TO 3
32     NSEQ=NSEQ+1
3      CONTINUE
       CALL MEMS2
      CALL EQ(3,3)
       CALL OPLP (IDR,IT1,IT2   )
       KMSGT=-1
45     SLVCHK=EQTRNZ (NSEQ,F(LVR-2),KNT2,IARG1,IARG2,FARG1,FARG2,KMSGT)
       GO TO (41,42,42,44 ),KNT2
41     KMSGT = 0
       GO TO 40
42     KMSGT = 1
40     CALL MSGERR (KNT2,IARG1,IARG2,FARG1,FARG2)
       GO TO 45
44     CONTINUE
       DO 7 N=1,NSEQ
       F(LVA-N)=F(LVR-N*2)
7      F(LVP-N)=F(LVR-N*2+1)
       DO 8 N=1,NSEQ
       F(LVR-N)=F(LVA-N)
8      F(LVI-N)=F(LVP-N)
       CALL OPLP(IDR,IT1,IT2   )
       IF(KOPLP) 51,52,51
51     GO TO (24,24,24,52,24) KOPLP
52     CONTINUE
      CALL EQ (4,4)
       GO TO (60,61) KNT
61     IF(KOLPR-1) 62,63,62
63                      JAB1=3HOPE
                        JAB2=3HN
                        JAB3=3HLOO
                        JAB4=3HP
                        JAB5=3HSOL
                        JAB6=3HUTI
                        JAB7=3HON
       GO TO 10
60                      JAB1=3HNOM
                        JAB2=3HINA
                        JAB3=3HL
7112                    JAB4=3HSOL
                        JAB5=3HUTI
                        JAB6=3HONS
                        JAB7=3H
10    CALL SOLOUT (KNTSO,ITNO)
62     CONTINUE
       KNTSO=0
       IF(FREQ-EFREQ) 20,21,21
20     IF(FREQK) 22,22,23
22     FREQ=FREQ*DELF
       GO TO 24
23     FREQ=FREQ+DELF
       GO TO 24
21     CONTINUE
       IF(L1-1) 200,201,200
201    KOPLP = IDR
       GO TO 203
200    KOPLP = -IDR
203    CONTINUE
      RETURN
      END
C        MEMS2
C
C  A SUB. TO SET UP MEMORY - PART 2
C
      SUBROUTINE MEMS2
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
      EQUIVALENCE (JAB( 20),JABZ),(JAB( 21),NFAB),(JAB( 22),INXI)
     1,(JAB( 23),ISDL),(JAB( 24),NPAR),(JAB( 25),NSTM),(JAB( 26),NCOM)
      EQUIVALENCE (JAB( 27),INXIBU),(JAB( 28),KPOUT) ,(JAB( 29),NNPT )
C
      EQUIVALENCE (JAB(276),NSEQ),(JAB(199),NSDE),(JAB(198),NUNK)
     1,(JAB(197),NDEQ),(JAB(196),NMDE)
C  .........          ..........          ..........          ..........
      NUNK = NSEQ + NSDE + NMDE
      INXI = INXIBU
      DO 80 N=1,4
      ITSI = INXI + 1
      INXI = ITSI - 1 - NUNK
80    JAB(191 -N) = ITSI
      INXI = 2 * INXI -14
C  DELETED WITH A COMMENT      IPRT = INXI + MPRT
C        INXI = IPRT - MPRT -MPRT * NUNK
      NCOM = 12 + JABZ + 2*NFAB -   INXI
      RETURN
      END
CIRCAC ** FICHE/FRAME BREAK *****
ACSVM SYMSORT

SYM.  PG.LN. IDENT.

1       1 39 C       10      3 21 C       2       1 24 C       20      3 25 C       
200     3 34 C       201     3 32 C       203     3 35 C       21      3 30 C       
22      3 26 C       23      3 28 C       24      2  3 C       3       2 19 C       
31      2 16 C       32      2 18 C       4       2 15 C       40      2 29 C       
41      2 26 C       42      2 28 C       44      2 31 C       45      2 24 C       
51      3  1 C       52      3  2 C       60      3 14 C       61      3  5 C       
62      3 22 C       63      3  6 C       69      2  7 C       7       2 34 C       
70      2 13 C       71      2 11 C       7112    3 17 C       8       2 37 C       
80      4 16 C       80      1 25 C       82      1 29 C       83      1 32 C       
99      1 37 C       C       4 19 C       C       4 18 C       
C       4 10 C       C       3 38 C       C       2  9 C       C       2  4 C       
C       1 22 C       C       1  2 C       CM      4  8 C       CM      4  1 C       
CM      1 23 C       CM      1  4 C       CMC     3 39 C       CMC     1  3 C       

CIRCAC ** FICHE/FRAME BREAK *****
ACDMS
DMSUA  IDENT   12/18/68
XMP    OPD     140B5,1,1
EOADR  EQU     400B
XSD    OPD     10000000B,1,1
ONE    DATA    1B
EOSIZE EQU     404B
EOTAG  EQU     401B
EOIND  EQU     402B
XFA    OPD     11400000B,1,1
FFA    OPD     11500000B,1,1
XNA    OPD     11600000B,1,1
FNA    OPD     11700000B,1,1
FSD    OPD     10100000B,1,1
$DMSU  ZRO     LDMSU
       SBRM*   201B
       XSD     TMPA
       XSD     TMP2
       XSD     IA1
       XSD     IA2
       XSD     IA3
       FSD     FA1
       XSD     KMSGT
       SBRM*   202B
       SKN*    KMSGT
       BRU     RETMSG
       LDA*    TMPA
       STA     MZL
       LDA     TMPA
       SUB*    TMP2
       STA     ENL
       LDA     =24
       STA     EOSIZE
       LDA     EOADR
       ADD     =26
       STA     CNVT
       CLAB
       LDA     MZL
       XMP     =4
       ADD     CNVT
       STA     DAGR
       ADD     ONE
       STA     DAGC
       ADD     ONE
       STA     DAGF
       CLAB
       STA     NAL
       LDA     MZL
       XMP     =6
       ADD     DAGR
       STA     NXL
       LDA     ONE
       STA*    IA1
       LDA     NXL
       STA*    IA2
       LDA     ENL
       STA*    IA3
       LDA     FARG1
       STA*    FA1
       BRR     LDMSU
RETMSG CLAB
       LDA     MZL
       XMP     =10
       ADD     CNVT
       STA     TMPA
       LDA     CNVT
       STA     TMP2
       CLAB
       STA*    TMP2
       LDA     TMP2
       ADD     ONE
       SKG     TMPA
       BRU     *-6
       BRR     LDMSU
LDMSU  ZRO
MZL    ZRO
       END
CIRCAC ** FICHE/FRAME BREAK *****
ACDMS SYMSORT

SYM.  PG.LN. IDENT.

DMSU    1 14 DMSUA   EOADR   1  3 DMSUA   EOIND   1  8 DMSUA   
EOSIZE  1  6 DMSUA   EOTAG   1  7 DMSUA   FFA     1 10 DMSUA   FNA     1 12 DMSUA   
FSD     1 13 DMSUA   LDMSU   2 35 DMSUA   MZL     2 36 DMSUA   ONE     1  5 DMSUA   
RETMSG  2 21 DMSUA   XFA     1  9 DMSUA   XMP     1  2 DMSUA   XNA     1 11 DMSUA   
XSD     1  4 DMSUA   
CIRCAC ** FICHE/FRAME BREAK *****
ACDTS
DTSTA  IDENT   12/18/68
XFA    OPD     11400000B,1,1
XNA    OPD     11600000B,1,1
FNA    OPD     11700000B,1,1
XSD    OPD     10000000B,1,1
FSD    OPD     10100000B,1,1
XMP    OPD     14000000B,1,1
$DATTST ZRO    LDATTST
       SBRM*    201B
       XSD     LNSEQ
       XSD     LNCOMT
       XSD     IA1
       XSD     IA2
       XSD     IA3
       FSD     FA1
       SBRM*    202B
       LDA     LNSEQ
       SUB*    LNCOMT
       STA     ENLT
       LDA     400B
       SKG     ENLT
       BRR     LDATTST
       LDA     =4
       STA*    IA1
       LDA     ENLT
       STA*    IA2
       LDA     400B
       STA*    IA3
       LDA     LNCOMT
       STA*    FA1
       BRR     LDATTST
$IA1   BSS     2
$IA2   BSS     2
$IA3   BSS     2
$FA1   BSS     2
$KMSGT BSS     2
LDATTST ZRO
$DAMTST ZRO    LDAMTST
       SBRM*   201B
       XSD     IA1
       XSD     IA2
       XSD     IA3
       FSD     FA1
       SBRM*   202B
       LDA     =30                5 ELEM*6 PER ELEM
       XMP*    LNSEQ
       STA     LNCOMT+1
       LDA     ENLT
       SUB     LNCOMT+1
       STA     ENLT
       LDA     400B
       SKG     ENLT
       BRR     LDAMTST
       LDA     =5
       STA*    IA1
       LDA     ENLT
       STA*    IA2
       LDA     400B
       STA*    IA3
       LDA     LNCOMT
       STA*    FA1
       BRR     LDAMTST
ENLT   ZRO
LNSEQ  BSS     2
LNCOMT BSS     2
LDAMTST ZRO
       END
CIRCAC ** FICHE/FRAME BREAK *****
ACDTS SYMSORT

SYM.  PG.LN. IDENT.

DAMTST  1 38 DTSTA   DATTST  1  8 DTSTA   ENLT    2 24 DTSTA   
FA1     1 35 DTSTA   FNA     1  4 DTSTA   FSD     1  6 DTSTA   IA1     1 32 DTSTA   
IA2     1 33 DTSTA   IA3     1 34 DTSTA   KMSGT   1 36 DTSTA   LDAMTS  2 27 DTSTA   
LDATTS  1 37 DTSTA   LNCOMT  2 26 DTSTA   LNSEQ   2 25 DTSTA   XFA     1  2 DTSTA   
XMP     1  7 DTSTA   XNA     1  3 DTSTA   XSD     1  5 DTSTA   
CIRCAC ** FICHE/FRAME BREAK *****
ACEQT
EQTRA  IDENT   12/18/68
XMP    OPD     140B5,1,1
STC    OPD     176B5,1,1
LDC    OPD     177B5,1,1
FAC    OPD     175B5,1,1
FSC    OPD     174B5,1,1
FMC    OPD     173B5,1,1
FDC    OPD     172B5,1,1
FNC    OPD     171B5,2
TZC    OPD     170B5,2
XSD    OPD     10000000B,1,1
FSD    OPD     10100000B,1,1
STD    OPD     10700000B,1,1
LDP    OPD     12500000B,1,1
FLA    OPD     13100000B,1,1
FLS    OPD     13500000B,1,1
FLM    OPD     14100000B,1,1
FLD    OPD     14500000B,1,1
FLN    OPD     14700000B,2
XFA    OPD     11400000B,1,1
FFA    OPD     11500000B,1,1
XNA    OPD     11600000B,1,1
FNA    OPD     11700000B,1,1
ZERO   DATA    0B
ONE    DATA    1B
SIGN   DATA    40000000B
ONES   DATA    77777777B
ADRMSK DATA    37777B
$IA1   BSS     2
$IA2   BSS     2
$IA3   BSS     2
$FA1   BSS     2
$FA2   BSS     2
$KMSGT BSS     2
NZ ZRO    LEQTRNS
       SBRM*   201B
       XSD     TMPA
       FSD     ADV1
       XSD     IA1
       XSD     IA2
       XSD     IA3
       FSD     FA1
       FSD     FA2
       XSD     KMSGT
       SBRM*   202B
       SKN*    KMSGT
       BRU     *+2
       BRU     *+5
       LDA*    KMSGT
       SKG     ZERO
       BRU     RETM1
       BRU     RETM2
       LDA*    TMPA
       STA     MZ
       LDA     =3
       STA     KNTMER
       SBRM    DAGTST
       CLAB                         A,B =0
       STA     IC                  IC  COL TO WORK ON
LUP1   CLAB
       LDA     IC
       ADD     ONE
       STA     IC
       ADD     ONE
       SKG     MZ                  TEST TRI DONE
       BRU     *+2
       BRU     ANS
       SUB     =2                  CONTINUE TRI
       XMP     =6                   MUL X 4
       ADD     DAGC
       STA     SACBP
TSCN   LDA*    SACBP              TEST FOR COL END
       SKA     ADRMSK
       BRU     *+2                 ADR NOT ZERO
       BRU     LUP1                ADR IS ZERO
       STA     ARNBT
CNTC   SUB     ONE                 CONTINUE COL SEARCH
       STA     TMPA
       LDA*    TMPA
       SKG*    ARNBT
       BRU     MSTZ                BELOW DIAG
       LDA*    ARNBT              ABOVE DIAG
       SKA     ADRMSK
       BRU     *+2                 ADR NOT ZERO
       BRU     LUP1                ADR IS 0
       STA     ARNBT
       BRU     CNTC                CONTINUE COL SEARCH
MSTZ   LDA*    ARNBT              MUST ZERO
       RSH     15
       STA     IDRTZ
       XAB                         IDRTZ TO B=IDR       SET UP ARG
       LDA     ARNBT                                        =
       SUB     ONE                                          =
       STA     TMPA                =920                     =
       LDX     TMPA                  CAX     X=ATDL
       LDA     IC                            A=IDC
       SBRM    DLTE                DELETE TERM
       LDA     SACBP
       ADD     ONE
       STA     TMPA                USE FACT DIAG STORED AT ADR
       LDA     ARNBT
       ADD     ONE
       STA     TMP2
       LDC*    TMP2
       FDC*    TMPA
       FNC
       STC     RAT
       LDA     SACBP
       SUB     ONE
       STA     TMPA
       LDA*    TMPA
       SKG     ZERO                ALL NON DAG MAY BE 0
       BRU     CONP
SMRG   STA     ARTTM               START OF MERGING (ZEROING) A ROW
       ADD     =2
       STA     TMPA
       LDC*    TMPA
       FMC     RAT
       STC     TERM
       TZC
       SKA     ONES                WILL STOP SET UP OF ZERO ELEMENT
       BRU     *+2                 CONTINUE
       BRU     TSRN                NUM. = 0  NO ACTION NEEDED
       LDB     IDMSK
       LDA*    ARTTM
       SKM*    ARNBT
       BRU     RWSR                NOT DIAG TERM
       CLAB                         DIAG TERM
       LDA     IDRTZ
       SUB     ONE
       XMP     =6
       ADD     DAGF
       STA     TMPA
       LDC*    TMPA
       FAC     TERM
       STC*    TMPA
       BRU     TSRN                GO TO TEST FOR ROW END
RWSR   CLAB
       LDA     IDRTZ
       SUB     ONE
       XMP     =6
       ADD     DAGR
       STA     TMPA
       LDA*    TMPA
       SKG     ZERO                ROW MAY BE 0 MUST TEST POINTER
       BRU     GOSU
LUPR   STA     ARSR
       LDB     IDMSK
       LDA*    ARSR
       SKM*    ARTTM
       BRU     *+2                 ROW TERM NOT FOUND
       BRU     RTRF                         FOUND
       SKA     ADRMSK
       BRU     *+2                 ADR NOT 0
       BRU     *+3                 ADR 0   PREPARE FOR SET UP
       LDA*    ARSR               CONTINUE
       BRU     LUPR
GOSU   LDA*    ARTTM
       RSH     15                  A=IDC              =
       LDB     IDRTZ               B=IDR        ARG FOR SET-UP
       SBRM    SETUP                      GO TO SET-UP
       LDC     TERM                  LOAD TERM INTO
       STC*    TMPA                    ADR FOUND BY SET-UP
       BRU     TSRN
RTRF   LDA     ARSR                ROW TERM FOUND
       ADD     =2
       STA     TMPA
       LDC*    TMPA
       FAC     TERM
       STC*    TMPA
       TZC
       SKA     ONES
       BRU     TSRN                A NOT =0
       LDX     ARSR                               X=ATDL
       LDA*    ARSR
       RSH     15                                 A=IDC
       LDB     IDRTZ               A=0  NUM.=0    B=IDR
       SBRM    DLTE                DELTE TERM
TSRN   LDA*    ARTTM              TEST ROW END
       SKA     ADRMSK
       BRU     SMRG                ADR NOT 0  - GO TO MERGE START
CONP   CLAB                         ADR 0    DO CONSTANT PART
       LDA     IC
       SUB     ONE
       XMP     =4
       ADD     CNVT
       STA     TMPA
       LDC*    TMPA
       TZC
       SKA     ONES
       BRU     *+2
       BRU     TSCN                CON TERM IS 0
       LDA     IDRTZ
       SUB     ONE
       XMP     =4
       ADD     CNVT
       STA     TMP2
       LDC*    TMPA
       FMC     RAT
       FAC*    TMP2
       STC*    TMP2
       BRU     TSCN
ARTTM  ZRO
IC     ZRO
SACBP  ZRO
ARNBT  ZRO
IDRTZ  ZRO
RAT    BSS     4
TERM   BSS     4
ARSR   ZRO
IDMSK  DATA    077700000B
$MZ    ZRO
$ADV1  BSS     2
       PAGE
ANS    NOP
       LDA     =2
       STA     KNTMER
       SBRM    DAGTST
       CLAB
       LDA     MZ
LUPC   STA     MZT
       SUB     ONE
       STA     MZTMO
       XMP     =4                    X2
       ADD     CNVT
       STA     TMPA                CONSTANT ADR
       LDA     MZTMO
       XMP     =6                    X4
       ADD     DAGF
       STA     TMP2                DIAG ADR
       LDC*    TMPA               C[MZT]
       FDC*    TMP2               GET ANS I.E. /A[MZT,MZT]
       STC*    TMPA               STORE IN C[MZ]
       LDA     ONES
       SKA     MZTMO
       BRU     CNAN
       LDA     ONE                 SET UP ANS. IN VOLTAGE LV SLOTS
       STA     AOKT
AOLP   LDC*    CNVT
       STC*    ADV1
       LDA     CNVT
       ADD     =4
       STA     CNVT
       LDA     ADV1
       SUB     =4
       STA     ADV1
       LDA     AOKT
       ADD     ONE
       STA     AOKT
       SKG     MZ
       BRU     AOLP
       LDA     =4              TO CAUSE END OF 940
       STA*    IA1             EQTRNZ CALLS. 12-19-68
       LDA     ONES                A=ONES=-1 FOR O.K.
       BRR     LEQTRNZ             MZTMO=0 - SOL COMPLETE RETURN
LEQTRNZ ZRO
CNAN   CLAB                         REDUCE MATRIX SET UP
       LDA     MZTMO
       XMP     =6
       ADD     DAGC
       STA     AATTM
REDC   LDA*    AATTM
       SKA     ADRMSK
       BRU     *+3                 ADR NOT 0
       LDA     MZTMO               ADR IS 0
       BRU     LUPC                MERGE DONE - GET NEW ANS
       STA     AATTM
       LDA*    AATTM
       RSH     15                  CONTINUE REDUCE
       SUB     ONE
       STA     RTMMO
       LDA     AATTM
       ADD     ONE
       STA     TMPA
       CLAB
       LDA     RTMMO               DETERMINE C TERM TO MODIFY
       XMP     =4                   X2
       ADD     CNVT
       STA     TMP2
       LDA     MZTMO
       XMP     =4
       ADD     CNVT
       STA     TMP3
       LDC*    TMPA
       FMC*    TMP3
       FNC
       FAC*    TMP2
       STC*    TMP2
       CLAB
       BRU     REDC
MZT    ZRO
MZTMO  ZRO
RTMMO  ZRO
AATTM  ZRO
AOKT   ZRO
$DLTE  ZRO     LDLTE
       STX     DLADR
       STX     ADNAL               3-12-67
       STA     IDCT
       XAB
       LDB     ZERO
       SUB     ONE
       XMP     =6
       ADD     DAGR
LUPDL  STA     ARSRF
       LDA*    ARSRF
       STA     ARSRA
       LDB     ADRMSK
       SKM     DLADR
       BRU     *-5
       LDA*    ARSRF              = - TERM FOUND
       ETR     IDMSK
       STA     TMPA
       LDA*    ARSRA
       ETR     ADRMSK
       MRG     TMPA
       STA*    ARSRF
       LDA     DLADR
       SKG     ADNAL               3-12-63
       BRU     *+3                 3-12-67
       SBRM    SETNAL              3-12-67
       BRR     LDLTE
       ADD     ONE                 ROW DONE MUST DO COL.
       STA     DLADR               INCREMENTED DLADR WILL CAUSE RETUR
       CLAB
       LDA     IDCT
       SUB     ONE
       XMP     =6
       ADD     DAGC
       BRU     LUPDL
ADNAL  ZRO                         3-12-67
DLADR  ZRO
IDCT   ZRO
ARSRF  ZRO
ARSRA  ZRO
IDRT   ZRO
$NAL   ZRO
LDLTE  ZRO
       PAGE
$SETUP ZRO     LSETUP
       STA     IDCT
       STB     IDRT
       LSH     15
       STA     ISHC
       STB     ISHR
       LDA     NAL
       SKG     ZERO
       BRU     *+3                 3-12-67
       SBRM    USENAL              3-11-67
       BRU     STUP
       LDA     NXL
OK     STA     ATSU
       ADD     =6
       STA     NXL
STUP   CLAB
       LDA     IDRT
       SUB     ONE
       XMP     =6
       ADD     DAGR
       STA     TMPA                ROW ADR DIAG
       LDA     IDCT
       SUB     ONE
       XMP     =6
       ADD     DAGC
       STA     TMP2                COL ADR DIAG
       LDA*    TMPA
       MRG     ISHC
       STA*    ATSU               ROW HEADER SET UP
       LDA     ATSU
       ADD     ONE
       STA     TMP3
       LDA*    TMP2
       MRG     ISHR
       STA*    TMP3               COL HEADER SET UP
       LDA     ATSU
       STA*    TMPA               ROW POINTER SET UP - IN DIAG
       LDA     TMP3
       STA*    TMP2               COL POINTER SET UP - IN DIAG
       ADD     ONE
       STA     TMPA                ADR FOR FLT-G NUM. SET UP IN TMPA
       BRR     LSETUP
LSETUP ZRO
ATSU   ZRO
$NXL   ZRO
ISHC   ZRO
ISHR   ZRO
$ENL   ZRO
       PAGE
$FIND  ZRO     LFIND
       STA     IDRT
       LDB     ADRMSK
       SKM     TMP2
       BRU     NTDG                NOT DIAG
       SUB     ONE                 DIAG TERM
       XMP     =6                   MULX4
       ADD     DAGF
       STA     TMPA                SET ADDBSSS
       BRR     LFIND               RETURN
NTDG   SUB     ONE
       XMP     =6
       ADD     DAGR
       STA     TMPA
       LDA     TMP2
       LSH     15
       STA     TMP2
       LDB     IDMSK
       LDA*    TMPA
       SKG     ZERO
       BRU     NYSU
LUPF   STA     TMPA
       LDA*    TMPA
       SKM     TMP2
       BRU     ENTS
       LDA     TMPA
       ADD     =2
       STA     TMPA
       BRR     LFIND
ENTS   SKA     ADRMSK
       BRU     LUPF
NYSU   CLAB
       STA     TMPA
       BRR     LFIND
LFIND  ZRO
       PAGE
$DAGR  ZRO
$DAGC  ZRO
$DAGF  ZRO
$CNVT  ZRO
$TMPA  BSS     2
$TMP2  BSS     2
$TMP3  BSS     2
       PAGE
$SETNAL ZRO    LSETNAL
       LDA     NAL
       STA*    ADNAL
       LDA     ADNAL
       STA     NAL
       BRR     LSETNAL
LSETNAL ZRO
       PAGE
$USENAL ZRO    LUSENAL
       LDA     NAL
       ETR     ADRMSK
       STA     ATSU
       LDA*    NAL
       STA     NAL
       BRR     LUSENAL
LUSENAL ZRO
       PAGE
$DAGTST ZRO    LDAGTST
       LDA     ONE
       STA*    IA1
       LDA     NXL
       STA*    IA2
       LDA     ENL
       STA*    IA3
       LDA     FARG1
       STA*    FA1
       LDA     FARG1+2
       STA*    FA2
       BRR     LEQTRNS
RETM1  CLAB
       STA     MZT
LUPDTS CLAB
       LDA     MZT
       XMP     =6
       ADD     DAGF
       STA     TMPA
       LDC*    TMPA
       STC     FARG1
       LDA     MZT
       ADD     ONE
       SKG     MZ
       BRU     *+2
       BRR     LDAGTST
       STA     MZT
       LDA     KNTMER
       STA*    IA1
       LDA     MZT
       STA*    IA2
       LDA     CNVT
       STA*    IA3
       LDP     FARG1
       STD*    FA1
       LDP     FARG1+2
       STD*    FA2
       BRR     LEQTRNS
RETM2  BRU     LUPDTS
KNTMER ZRO
$FARG1 BSS     4
LDAGTST ZRO
       END
 
CIRCAC ** FICHE/FRAME BREAK *****
ACEQT SYMSORT

SYM.  PG.LN. IDENT.

AATTM   8 21 EQTRA   ADNAL   9 19 EQTRA   ADRMSK  1 28 EQTRA   
ADV1    6 18 EQTRA   ANS     6 20 EQTRA   AOKT    8 22 EQTRA   AOLP    7  5 EQTRA   
ARNBT   6 11 EQTRA   ARSR    6 15 EQTRA   ARSRA   9 23 EQTRA   ARSRF   9 22 EQTRA   
ARTTM   6  8 EQTRA   ATSU   10 32 EQTRA   CNAN    7 23 EQTRA   CNTC    2 38 EQTRA   
CNVT   11 38 EQTRA   CONP    5 26 EQTRA   DAGC   11 36 EQTRA   DAGF   11 37 EQTRA   
DAGR   11 35 EQTRA   DAGTST 12 21 EQTRA   DLADR   9 20 EQTRA   DLTE    8 23 EQTRA   
ENL    10 36 EQTRA   ENTS   11 28 EQTRA   EQTRNZ  1 35 EQTRA   FA1     1 32 EQTRA   
FA2     1 33 EQTRA   FAC     1  5 EQTRA   FARG1  13 22 EQTRA   FDC     1  8 EQTRA   
FFA     1 21 EQTRA   FIND   10 38 EQTRA   FLA     1 15 EQTRA   FLD     1 18 EQTRA   
FLM     1 17 EQTRA   FLN     1 19 EQTRA   FLS     1 16 EQTRA   FMC     1  7 EQTRA   
FNA     1 23 EQTRA   FNC     1  9 EQTRA   FSC     1  6 EQTRA   FSD     1 12 EQTRA   
GOSU    5  2 EQTRA   IA1     1 29 EQTRA   IA2     1 30 EQTRA   IA3     1 31 EQTRA   
IC      6  9 EQTRA   IDCT    9 21 EQTRA   IDMSK   6 16 EQTRA   IDRT    9 24 EQTRA   
IDRTZ   6 12 EQTRA   ISHC   10 34 EQTRA   ISHR   10 35 EQTRA   KMSGT   1 34 EQTRA   
KNTMER 13 21 EQTRA   LDAGTS 13 23 EQTRA   LDC     1  4 EQTRA   LDLTE   9 26 EQTRA   
LDP     1 14 EQTRA   LEQTRN  7 22 EQTRA   LFIND  11 33 EQTRA   LSETNA 12 10 EQTRA   
LSETUP 10 31 EQTRA   LUP1    2 21 EQTRA   LUPC    6 26 EQTRA   LUPDL   8 32 EQTRA   
LUPDTS 12 35 EQTRA   LUPF   11 20 EQTRA   LUPR    4 30 EQTRA   LUSENA 12 19 EQTRA   
MSTZ    3 10 EQTRA   MZ      6 17 EQTRA   MZT     8 18 EQTRA   MZTMO   8 19 EQTRA   
NAL     9 25 EQTRA   NTDG   11  9 EQTRA   NXL    10 33 EQTRA   NYSU   11 30 EQTRA   
OK     10  1 EQTRA   ONE     1 25 EQTRA   ONES    1 27 EQTRA   RAT     6 13 EQTRA   
REDC    7 28 EQTRA   RETM1  12 33 EQTRA   RETM2  13 20 EQTRA   RTMMO   8 20 EQTRA   
RTRF    5  9 EQTRA   RWSR    4 21 EQTRA   SACBP   6 10 EQTRA   SETNAL 12  4 EQTRA   
SETUP   9 28 EQTRA   SIGN    1 26 EQTRA   SMRG    3 36 EQTRA   STC     1  3 EQTRA   
STD     1 13 EQTRA   STUP   10  4 EQTRA   TERM    6 14 EQTRA   TMP2   12  1 EQTRA   
TMP3   12  2 EQTRA   TMPA   11 39 EQTRA   TSCN    2 33 EQTRA   TSRN    5 23 EQTRA   
TZC     1 10 EQTRA   USENAL 12 12 EQTRA   XFA     1 20 EQTRA   XMP     1  2 EQTRA   
XNA     1 22 EQTRA   XSD     1 11 EQTRA   ZERO    1 24 EQTRA   
CIRCAC ** FICHE/FRAME BREAK *****
ACPOP
POPS   IDENT
$POPLD BRU     0
STD    OPD     107B5,1,1
LDP    OPD     125B5,1,1
FLA    OPD     131B5,1,1
FLS    OPD     135B5,1,1
FLM    OPD     141B5,1,1
FLD    OPD     145B5,1,1
FLN    OPD     147B5,2
LDC    OPD     17700000B,1,1
STC    OPD     17600000B,1,1
FAC    OPD     17500000B,1,1
FSC    OPD     17400000B,1,1
FMC    OPD     17300000B,1,1
FDC    OPD     17200000B,1,1
FNC    OPD     17100000B,2
TZC    OPD     17000000B,2
$POPINI ZRO    POPLNK
       SBRM*   201B
       LDX     =-8
       LDA     POPTBL,2
       STA     200B,2
       BRX     *-2
       BRR     POPLNK
       BRU     TZCPOP
       BRU     FNCPOP
       BRU     FDCPOP
       BRU     FMCPOP
       BRU     FSCPOP
       BRU     FACPOP
       BRU     STCPOP
       BRU     LDCPOP
POPLNK BSS     1
POPTBL EQU     POPLNK
LDCPOP LDA     0
       STA     RLDC
       CLX
       EAX*    0
       STX     IR
       LDA     IR
       ADD     =2
       STA     II
       LDP*    IR
       STD     CAR
       LDP*    II
       STD     CAI
       BRR     RLDC
RLDC   ZRO
STCPOP LDA     0
       STA     RSTC
       CLX
       EAX*    0
       STX     IR
       LDA     IR
       ADD     =2
       STA     II
       LDP     CAR
       STD*    IR
       LDP     CAI
       STD*    II
       BRR     RSTC
RSTC   ZRO
FACPOP LDA     0
       STA     RFAC
       CLX
       EAX*    0
       STX     IR
       LDA     IR
       ADD     =2
       STA     II
       LDP*    IR
       SKA     ONES
       BRU     *+2
       BRU     IMAD
       LDP     CAR
       SKA     ONES
       BRU     *+4
       LDP*    IR
       STD     CAR
       BRU     IMAD
       FLA*    IR
       STD     CAR
IMAD   LDP*    II
       SKA     ONES
       BRU     *+2
       BRR     RFAC
       LDP     CAI
       SKA     ONES
       BRU     *+4
       LDP*    II
       STD     CAI
       BRR     RFAC
       FLA*    II
       STD     CAI
       BRR     RFAC
RFAC   ZRO
FSCPOP LDA     0
       STA     RFSC
       CLX
       EAX*    0
       STX     IR
       LDA     IR
       ADD     =2
       STA     II
       LDP*    IR
       FLN
       STD     CTR
       LDP*    II
       FLN
       STD     CTI
       FAC     CTR
       BRR     RFSC
RFSC   ZRO
FMCPOP LDA     0
       STA     RFMC
       CLX
       EAX*    0
       STX     IR
       LDA     IR
       ADD     =2
       STA     II
       LDP     CAI
       SKA     ONES
       BRU     S1
S2     LDP*    II
       SKA     ONES
       BRU     S4
S10    LDP*    IR
S10P   FLM     CAR
       STD     CAR
       BRR     RFMC
S4     LDP     CAR
       FLM*    II
       STD     CAI
       LDP*    IR
       SKA     ONES
       BRU     S10P
S20    CLAB
       STD     CAR
       BRR     RFMC
S1     LDP     CAR
       SKA     ONES
       BRU     S5
S6     LDP*    IR
       SKA     ONES
       BRU     S7
S8     CLAB
       STD     CAIT
S11    LDP*    II
S11P   FLM     CAI
       FLN
       STD     CAR
S21P   LDP     CAIT
       STD     CAI
       BRR     RFMC
S7     LDP     CAI
       FLM*    IR
       STD     CAIT
       LDP*    II
       SKA     ONES
       BRU     S11P
S21    BRU     S21P
S5     LDP*    II
       SKA     ONES
       BRU     S15
S16    LDP     CAI
       FLM*    IR
       STD     CAI
       BRU     S10
S15    LDP*    IR
       SKA     ONES
       BRU     S17
S18    LDP     CAR
       FLM*    II
       STD     CAIT
       BRU     S11
S17    LDP     CAI
       FLM*    II
       STD     TMP
       LDP     CAR
       FLM*    IR
       FLS     TMP
       STD     CART
       LDP     CAI
       FLM*    IR
       STD     TMP
       LDP     CAR
       FLM*    II
       FLA     TMP
       STD     CAI
       LDP     CART
       STD     CAR
       BRR     RFMC
RFMC   ZRO
FDCPOP LDA     0
       STA     RFDC
       CLX
       EAX*    0
       STX     IR
       LDA     IR
       ADD     =2
       STA     II
       LDP*    IR
       STD     CTR
       SKA     ONES
       BRU     *+2
       BRU     *+2
       FLM*    IR
       STD     TMP
       LDP*    II
       SKA     ONES
       BRU     *+5
       STD     CTI
       LDP     TMP
       STD     CCDD
       BRU     *+7
       FLM*    II
       FLA     TMP
       STD     CCDD
       LDP*    II
       FLN
       STD     CTI
       FMC     CTR
       LDP     CAR
       SKA     ONES
       BRU     *+2
       BRU     *+3
       FLD     CCDD
       STD     CAR
       LDP     CAI
       SKA     ONES
       BRU     *+2
       BRU     *+3
       FLD     CCDD
       STD     CAI
       BRR     RFDC
RFDC   ZRO
FNCPOP LDA     0
       STA     RFNC
       LDP     CAR
       FLN
       STD     CAR
       LDP     CAI
       FLN
       STD     CAI
       BRR     RFNC
RFNC   ZRO
TZCPOP LDA     0
       STA     RTZC
       LDP     CAR
       SKA     ONES
       BRU     NOTZ
       LDP     CAI
       SKA     ONES
       BRU     NOTZ
       LDA     =0
       BRR     RTZC
NOTZ   LDA     =1
       BRR     RTZC
RTZC   ZRO
ONES   DATA    77777777B
IR     ZRO
II     ZRO
CAR    BSS     2
CART   BSS     2
CAIT   BSS     2
CAI    BSS     2
TMP    BSS     2
CTR    BSS     2
CTI    BSS     2
CCDD   BSS     2
       END
CIRCAC ** FICHE/FRAME BREAK *****
ACPOP SYMSORT

SYM.  PG.LN. IDENT.

CAI     7 33 POPS    CAIT    7 32 POPS    CAR     7 30 POPS    
CART    7 31 POPS    CCDD    7 37 POPS    CTI     7 36 POPS    CTR     7 35 POPS    
FAC     1 12 POPS    FACPOP  2 24 POPS    FDC     1 15 POPS    FDCPOP  5 39 POPS    
FLA     1  5 POPS    FLD     1  8 POPS    FLM     1  7 POPS    FLN     1  9 POPS    
FLS     1  6 POPS    FMC     1 14 POPS    FMCPOP  3 36 POPS    FNC     1 16 POPS    
FNCPOP  7  4 POPS    FSC     1 13 POPS    FSCPOP  3 19 POPS    II      7 29 POPS    
IMAD    3  5 POPS    IR      7 28 POPS    LDC     1 10 POPS    LDCPOP  1 35 POPS    
LDP     1  4 POPS    NOTZ    7 24 POPS    ONES    7 27 POPS    POPINI  1 18 POPS    
POPLD   1  2 POPS    POPLNK  1 33 POPS    POPTBL  1 34 POPS    RFAC    3 18 POPS    
RFDC    7  3 POPS    RFMC    5 38 POPS    RFNC    7 13 POPS    RFSC    3 35 POPS    
RLDC    2  9 POPS    RSTC    2 23 POPS    RTZC    7 26 POPS    S1      4 24 POPS    
S10     4 11 POPS    S10P    4 12 POPS    S11     4 32 POPS    S11P    4 33 POPS    
S15     5 14 POPS    S16     5 10 POPS    S17     5 21 POPS    S18     5 17 POPS    
S2      4  8 POPS    S20     4 21 POPS    S21     5  6 POPS    S21P    4 36 POPS    
S4      4 15 POPS    S5      5  7 POPS    S6      4 27 POPS    S7      4 39 POPS    
S8      4 30 POPS    STC     1 11 POPS    STCPOP  2 10 POPS    STD     1  3 POPS    
TMP     7 34 POPS    TZC     1 17 POPS    TZCPOP  7 14 POPS    
CIRCAC ** FICHE/FRAME BREAK *****
ACESC
$ESCAPE ZRO RTN
START  LDA =2000000B
       BRS 78
       LDA =ESCPE
       STA 201B
       BRR RTN
ESCPE  ZRO
       BRS 147
       TCO =147B
       TCO =147B
       BRU START
RTN    BSS 1
       END
CIRCAC ** FICHE/FRAME BREAK *****
ACESC SYMSORT

SYM.  PG.LN. IDENT.

ESCPE   1  7 $ESCAPE RTN     1 12 $ESCAPE START   1  2 $ESCAPE 

CIRCAC ** FICHE/FRAME BREAK *****
ACL11
C      /ACL11/-/BACL11/  PART OF /ACNM/
C
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1),MOLLET(4)
      COMMON JAB,FAB,J,F
      CONTINUE
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
      EQUIVALENCE (JAB(254),KSKP2)
       EQUIVALENCE (JAB(180),KNT),(JAB(181),KCC1),(JAB(182),KCC2)
       IPAM=-1
       CALL ESCAPE
       IF(IPAM) 6969,6969,72801
72801  NART=10
       MOLLET(1)=3H(@6
       MOLLET(2)=3HLA)
       MOLLET(3)=3HACU
       MOLLET(4)=1HC
       CALL LINK(NART,MOLLET)
6969   IPAM=+1
      CALL EQ (6,6)
      IF(KSKP2 +4001782)300,301,300
300   KSKP2 = -4001782
       KNT     =1
       K94IO = 0
       K94PO = 1
       K94FO = 6
       CALL POPINI
C      KCC1=0  (LOCAL VERSION)
C      KCC1=1  (LIBRARY VERSION)
C      KCC1=2  (SPECIAL EQUATION VERSION)
       KCC1=1
301    CONTINUE
      CALL MAINPR
       END
C        MAINPR
C
C  ACTUAL MAIN PROG. - CALLED ALMOST IMMEDIATELY BY DUMMY MAIN PROG.
C
      SUBROUTINE MAINPR
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1),MOLLET(4)
      COMMON JAB,FAB,J,F
      CONTINUE
      DIMENSION LTBLN(15),LTBLD(35)
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
      EQUIVALENCE (JAB(201),LTBLN( 1)),(JAB(216),LTBLD( 1))
      EQUIVALENCE (JAB(179),KTBLN),(JAB(178),KTBLD) ,(JAB(177),NTBLN)
     1,(JAB(176),NTBLD)
      EQUIVALENCE (JAB(175),IOVM ) ,(JAB(174),IPOVM)
      EQUIVALENCE (JAB(172),KDLUK),(JAB(171),KDLIN)
C
      EQUIVALENCE (JAB( 20),JABZ),(JAB( 21),NFAB),(JAB( 22),INXI)
     1,(JAB( 23),ISDL),(JAB( 24),NPAR),(JAB( 25),NSTM),(JAB( 26),NCOM)
      EQUIVALENCE (JAB( 27),INXIBU),(JAB( 28),KPOUT) ,(JAB( 29),NNPT )
C
      EQUIVALENCE (JAB(276),NSEQ),(JAB(199),NSDE),(JAB(198),NUNK)
     1,(JAB(197),NDEQ),(JAB(196),NMDE)
      EQUIVALENCE (JAB(193),KNTGO),(JAB(192),KOPLP) ,(JAB(191),KOLPR)
      EQUIVALENCE (JAB(190),LVR ),(JAB(189),LVI ),(JAB(188),LVA )
     1,(JAB(187),LVP )
      EQUIVALENCE (JAB(186),LDER),(JAB(185),LDEI )
      EQUIVALENCE (JAB(184),LSDER),(JAB(183),LSDEI )
      EQUIVALENCE (JAB(159),LSUPP)
C
C
       EQUIVALENCE (JAB(180),KNT),(JAB(181),KCC1),(JAB(182),KCC2)
      EQUIVALENCE (JAB(  1),JAB1),(JAB(  2),JAB2),(JAB(  3),JAB3)
     1,(JAB(  4),JAB4),(JAB(  5),JAB5),(JAB(  6),JAB6),(JAB(  7),JAB7)
C
C  .........          ..........          ..........          ..........
        KSKP = 0
       IXYZ= 0
      GO TO (1000,1002,1005,6002,9480 ) KNT
1000  CONTINUE
      IF(KSKP2 +4001782)300,301,300
300   KSKP2 = -4001782
      KDLIN = 1
      KDLUK = 1
C   SET-UP SYSTEM CONTROL OF I/O OPERATIONS
301    CONTINUE
      IF(KDLUK) 9200,1002,9200
9200  CONTINUE
      KNTGO = 4
999       CONTINUE
C  CHECKS TO DETERMINE IF USRKNT IS STILL PRESENT
      IF(KDLUK) 7131,7130,7131
7131   IF(IXYZ-1) 6008,6006,6008
6006   KNT = 3
       IF(KNTGO-2) 6007,6206,6306
6206   KNTGO = 6
       GO TO 6007
6306   IF(KNTGO-5) 6007,6406,6007
6406   KNTGO = 7
       GO TO 6007
6008   KNT =4
6007   CONTINUE
72800  CONTINUE
72801  IF(KCC1) 72802,72802,72803
72802   NART=6
       MOLLET(1)=3H/AC
       MOLLET(2)=3HUC/
       CALL LINK(NART,MOLLET)
72803  NART=10
       MOLLET(1)=3H(@6
       MOLLET(2)=3HLA)
       MOLLET(3)=3HACU
       MOLLET(4)=1HC
       CALL LINK(NART,MOLLET)
C KNTGO 1(1005)=SOLVE FOR TEMPORARY SOLUTIONS-W/OUT PAR.S SET TO NOM.
C 2(1002)=SOLVE FOR NOM. SOL.S- SETS PAR.S TO NOM.
C 3(1004)=GO TO END
C 4(1001)=TAKE DATA IN
C 5(1003)=DO OPEN LOOP
C 6(1005)= PARAMETER ITERATION,NOMINAL
C 7(1003)= PARAMETER ITERATION,OPENLOOP
6002   IF(KNTGO-6) 7130,6004,6004
6004   IXYZ=1
7130  GO TO (1005,1002,1004,1001,1003,1005,1003  ) KNTGO
1001  CONTINUE
C TAKE IN THE DATA FOR A CIRCUIT
      IF (KDLIN )1002,1002,8500
8500  CONTINUE
       KNT     =5
73800  CONTINUE
73801  IF(KCC1) 73802,73802,73803
73802  NART=6
       MOLLET(1)=3H/AC
       MOLLET(2)=3HDI/
       CALL LINK(NART,MOLLET)
73803   NART=10
       MOLLET(1)=3H(@6
       MOLLET(2)=3HLA)
       MOLLET(3)=3HACD
       MOLLET(4)=1HI
       CALL LINK(NART,MOLLET)
9480   CONTINUE
      KNTGO = 2
      GO TO 999
1002  CONTINUE
C  DO NOM. SOL.S
1005  CONTINUE
C    DO SOL.S  -  NOM. OR TEMP. DEPENDING ON PAR. STATUS
      CALL SOLVE  (1)
C  SOLVE(1) USED TO DO FULL FREQ ITERATION WITH OUTPUT
C
       IF(KNTGO-6)998,999,999
998    KNTGO=3
      GO TO 999
1003   CONTINUE
       CALL SOLVE (2)
       GO TO 999
1004  CONTINUE
      END
  
CIRCAC ** FICHE/FRAME BREAK *****
ACL11 SYMSORT

SYM.  PG.LN. IDENT.

1000    2 25 C       1001    3 31 C       1002    4 12 C       1003    4 21 C       
1004    4 24 C       1005    4 14 C       300     2 27 C       300     1 20 C       
301     2 31 C       301     1 30 C       6002    3 28 C       6004    3 29 C       
6006    2 39 C       6007    3  8 C       6008    3  7 C       6206    3  2 C       
6306    3  4 C       6406    3  5 C       6969    1 17 C       7130    3 30 C       
7131    2 38 C       72800   3  9 C       72801   3 10 C       72801   1 11 C       
72802   3 11 C       72803   3 15 C       73800   3 36 C       73801   3 37 C       
73802   3 38 C       73803   4  3 C       8500    3 34 C       9200    2 33 C       
9480    4  9 C       998     4 19 C       999     2 35 C       
C       4 17 C       C       4 15 C       C       4 13 C       C       3 32 C       
C       3 27 C       C       3 26 C       C       3 25 C       C       3 24 C       
C       3 23 C       C       3 22 C       C       3 21 C       C       2 36 C       
C       2 30 C       C       1 33 C       C       1 28 C       C       1 27 C       
C       1 26 C       CM      4 18 C       CM      2 10 C       CM      2  7 C       
CM      1 35 C       CM      1  2 C       CMC     2 21 C       CMC     1 34 C       
CMCM    2 18 C       
CIRCAC ** FICHE/FRAME BREAK *****
ACL12
C      /ACL12/-/BACL12/ PART OF ACNM
C        EQ
C
C  EQ IS THE SUBPROGRAM STRUCTURED TO ALLOW A CIRC USER TO INTERFACE
C W/ CIRC IN AN EFFICIENT MANNER AND TO RETAIN ALL FORTRAN CABABILITIES
C
      SUBROUTINE EQ (KNTEQ,KNTMDL)
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
               EQUIVALENCE (JAB(26),NCOM)
C
      EQUIVALENCE (JAB(276),NSEQ),(JAB(199),NSDE),(JAB(198),NUNK)
     1,(JAB(197),NDEQ),(JAB(196),NMDE)
      EQUIVALENCE (JAB(190),LVR ),(JAB(189),LVI ),(JAB(188),LVA )
     1,(JAB(187),LVP )
      EQUIVALENCE (JAB(186),LDER),(JAB(185),LDEI )
      EQUIVALENCE (JAB(184),LSDER),(JAB(183),LSDEI )
      EQUIVALENCE (JAB(160),MSUP),(JAB(163),LSUPM),(JAB(166),NSUP)
      EQUIVALENCE (JAB(159),LSUPP)
C
      EQUIVALENCE (JAB( 30),MRES),(JAB( 40),KRES),(JAB( 50),NDQRES)
     1,(JAB( 60),NAMRES),(JAB( 70),MNPRES),(JAB( 80),NRES)
     2,(JAB( 90),IRES),(JAB(100),LRES),(JAB(110),JRES)
      EQUIVALENCE (JAB( 31),MIND),(JAB( 41),KIND),(JAB( 51),NDQIND)
     1,(JAB( 61),NAMIND),(JAB( 71),MNPIND),(JAB( 81),NIND)
     2,(JAB( 91),IIND),(JAB(101),LIND),(JAB(111),JIND)
      EQUIVALENCE (JAB( 32),MCAP),(JAB( 42),KCAP),(JAB( 52),NDQCAP)
     1,(JAB( 62),NAMCAP),(JAB( 72),MNPCAP),(JAB( 82),NCAP)
     2,(JAB( 92),ICAP),(JAB(102),LCAP),(JAB(112),JCAP)
      EQUIVALENCE (JAB( 35),MVZS),(JAB( 45),KVZS),(JAB( 55),NDQVZS)
     1,(JAB( 65),NAMVZS),(JAB( 75),MNPVZS),(JAB( 85),NVZS)
     2,(JAB( 95),IVZS),(JAB(105),LVTR),(JAB(115),JVZS),(JAB(150),LVTI)
      EQUIVALENCE (JAB(149),LZR ),(JAB(148),LZI )
      EQUIVALENCE (JAB( 34),MCYS),(JAB( 44),KCYS),(JAB( 54),NDQCYS)
     1,(JAB( 64),NAMCYS),(JAB( 74),MNPCYS),(JAB( 84),NCYS)
     2,(JAB( 94),ICYS),(JAB(104),LCTR),(JAB(114),JCYS)
      EQUIVALENCE (JAB(147),LCTI),(JAB(146),LYR ),(JAB(145),LYI  )
      EQUIVALENCE (JAB( 33),MXIS),(JAB( 43),KXIS),(JAB( 53),NDQXIS)
     1,(JAB( 63),NAMXIS),(JAB( 73),MNPXIS),(JAB( 83),NXIS)
     2,(JAB( 93),IXIS),(JAB(103),LIE ),(JAB(113),JXIS)
     3,(JAB(142),LBLF ),(JAB(141),LEPH )
      EQUIVALENCE (JAB(140),LFCO ),(JAB(139),LRB ),(JAB(138),LCTE)
     1,(JAB(137),LCC  ),(JAB(136),LRC  )
       EQUIVALENCE (FAB(13),FREQ),(FAB(17),W),(FAB(18),TP)
       EQUIVALENCE (FAB(14),SFREQ),(FAB(15),EFREQ),(FAB(16),DELF)
       EQUIVALENCE (FAB(19),FREQK)
C
       EQUIVALENCE (JAB(161),MNMP),(JAB(164),LNMP),(JAB(167),NNMP)
       EQUIVALENCE (JAB(162),MTMPAJ),(JAB(165),LTMPAJ),(JAB(168),NTMPAJ)
C
C  .........          ..........          ..........          ..........
      NDEQ = NSDE +NMDE
      NUNK = NSEQ + NDEQ
      LDER = LVR- NSEQ
      LSDER= LDER-NMDE
      LDEI = LVI- NSEQ
      LSDEI= LDEI-NMDE
C  .........          ..........          ..........          ..........
      GO TO (1,2,3,4,5,6) KNTEQ
C  .........          ..........          ..........          ..........
C
 1    GO TO 30
C  USED TO SUPPLY CIRC WITH MODEL INFO
C  .........          ..........          ..........          ..........
C
 2    CONTINUE
C  USED TO READ MODEL DATA
      GO TO 30
C
C  .........          ..........          ..........          ..........
C
 3    CONTINUE
C  .........          ..........          ..........          ..........
C.......................................................................
C  INSERT HERE ANY 'SPECIAL EQ.S'  THAT ARE USED
C  BEFORE CIRC WRITES ITS EQUATIONS
C
C.......................................................................
      GO TO 31
C
C  .........          ..........          ..........          ..........
C
 4    CONTINUE
C  USED TO GET SOLUTIONS TO MODEL DEPENDENT EQ.S
      GO TO 30
C
 5     CONTINUE
C  CARRY OVER FROM CIRC-DC
C
 6    CONTINUE
C  USED AT VERY BEGINNING OF EACH PROGRAM 'START OR RESTART'
      GO TO 8
C
C  .........          ..........          ..........          ..........
C
 7    CONTINUE
C  RETURN AFTER MODEL DEP. EQ. ARE DETERMINED
C
C  .........          ..........          ..........          ..........
C.......................................................................
C  INSERT 'SPECIAL DEPENDENT EQUATIONS' HERE
C
C.......................................................................
C  .........          ..........          ..........          ..........
      GO TO 8
C
C  .........          ..........          ..........          ..........
 31   CONTINUE
C     INITIALIZE STORAGE TO ACCEPT MATRIX SET UL.
       KMSGT = -1
      CALL DMSU (NSEQ,NCOM,KNT,IARG1,IARG2,FARG1,KMSGT)
       CALL MSGERR (KNT,IARG1,IARG2,FARG1,FARG2)
       KMSGT = 0
      CALL DMSU (NSEQ,NCOM,KNT,IARG1,IARG2,FARG1,KMSGT)
C     SET UP EACH MODEL'S CONTRIBUTION TO THE SYSTEM  MATRIX EQUATIONS
C
 30   CONTINUE
      IF (NRES) 11,11,10
10    CALL RES (KNTMDL)
11    CONTINUE
C
      IF(NIND) 13,13,12
12    CALL IND (KNTMDL)
13    CONTINUE
      IF(NCAP) 15,15,14
14    CALL CAP (KNTMDL)
15    CONTINUE
      IF(NXIS) 17,17,16
16    CALL XIS (KNTMDL)
17    CONTINUE
      IF(NCYS) 19,19,18
18    CALL CYS (KNTMDL)
19    CONTINUE
       IF(NVZS) 21,21,20
20     CALL VZS (KNTMDL)
21     CONTINUE
      GO TO (8,8,9,7,8) KNTEQ
 9    CONTINUE
C
C  .........          ..........          ..........          ..........
C.......................................................................
C  INSERT HERE ANY  EQ.S THAT MODIFY AND/OR SUPPLEMENT THE MODEL EQ.S
C
C.......................................................................
C  .........          ..........          ..........          ..........
C
C  .........          .........
C     RETURN AND SOLVE THE SYSTEM MATRIX EQUATIONS
8     RETURN
      END
C        FUNCTION P(N)
C
      FUNCTION P(N)
      DIMENSION JAB(276),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
      EQUIVALENCE (JAB(164),LNMP),(JAB(161),MNMP)
      P = F(LNMP-N*MNMP)
      RETURN
      END
C        RES
C
      SUBROUTINE  RES (KNT)
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
      EQUIVALENCE (JAB(186),LDER),(JAB(185),LDEI )
      EQUIVALENCE (JAB( 30),MRES),(JAB( 40),KRES),(JAB( 50),NDQRES)
     1,(JAB( 60),NAMRES),(JAB( 70),MNPRES),(JAB( 80),NRES)
     2,(JAB( 90),IRES),(JAB(100),LRES),(JAB(110),JRES)
C  .........          ..........          ..........          ..........
      GO TO (1,2,3,4     )KNT
1     CONTINUE
2     CALL MODELN (1,KNT)
      RETURN
3     DO 15 N=1,NRES
      ITM1=IRES-N*KRES
      IF(J(ITM1)-4) 6,15,15
6     ARG =1./F(LRES-N*MRES)
      CALL SMG (J(ITM1),J(ITM1-1),J(ITM1-2),ARG,1)
15    CONTINUE
      RETURN
4     DO 20 N =1,NRES
      ITM1 =IRES-N*KRES
      IF(J(ITM1)-4) 7,8,8
8     FAB(1) = 0.
      FAB(4) = 0.
      GO TO 9
7     ARG =1./F(LRES-N*MRES)
      CALL SMG (J(ITM1),J(ITM1-1),J(ITM1-2),ARG,2)
9     ITM1 =LDER+ JRES -N*NDQRES
      F(ITM1-1) =FAB(1)
       ITM1=LDEI+JRES-N*NDQRES
      F(ITM1-1) =FAB(4)
20     CONTINUE
      RETURN
      END
C        IND
C
      SUBROUTINE  IND (KNT)
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
      EQUIVALENCE (JAB(186),LDER),(JAB(185),LDEI )
      EQUIVALENCE (JAB( 31),MIND),(JAB( 41),KIND),(JAB( 51),NDQIND)
     1,(JAB( 61),NAMIND),(JAB( 71),MNPIND),(JAB( 81),NIND)
     1,(JAB( 91),IIND),(JAB(101),LIND),(JAB(111),JIND)
      EQUIVALENCE (FAB( 13),FREQ),(FAB( 17),W  ),(FAB( 18),TP    )
C  .........          ..........          ..........          ..........
      GO TO (1,2,3,4     )KNT
1     CONTINUE
2     CALL MODELN (2,KNT)
      RETURN
3     DO 15 N=1,NIND
      ITM1=IIND-N*KIND
      IF(J(ITM1)-4) 6,15,15
6     ARG = -1./ (F(LIND-N*MIND) * W )
      CALL SMB (J(ITM1),J(ITM1-1),J(ITM1-2),ARG,1)
15    CONTINUE
      RETURN
4     DO 20 N =1,NIND
      ITM1 =IIND-N*KIND
      IF(J(ITM1)-4) 7,8,8
8     FAB(1) = 0.
      FAB(4) = 0.
      GO TO 9
7     ARG = -1./ (F(LIND-N*MIND) * W )
      CALL SMB (J(ITM1),J(ITM1-1),J(ITM1-2),ARG,2)
9     ITM1 =LDER + JIND -N*NDQIND
      F(ITM1-1) =FAB(1)
       ITM1=LDEI+JIND-N*NDQIND
      F(ITM1-1) =FAB(4)
20     CONTINUE
      RETURN
      END
C        CAP
C
      SUBROUTINE  CAP (KNT)
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
      EQUIVALENCE (JAB(186),LDER),(JAB(185),LDEI )
      EQUIVALENCE (JAB( 32),MCAP),(JAB( 42),KCAP),(JAB( 52),NDQCAP)
     1,(JAB( 62),NAMCAP),(JAB( 72),MNPCAP),(JAB( 82),NCAP)
     2,(JAB( 92),ICAP),(JAB(102),LCAP),(JAB(112),JCAP)
      EQUIVALENCE (FAB( 13),FREQ),(FAB( 17),W  ),(FAB( 18),TP    )
C  .........          ..........          ..........          ..........
      GO TO (1,2,3,4     )KNT
1     CONTINUE
2     CALL MODELN (3,KNT)
      RETURN
3     DO 15 N=1,NCAP
      ITM1=ICAP-N*KCAP
      IF(J(ITM1)-4) 6,15,15
6     ARG =F(LCAP-N*MCAP) * W
      CALL SMB (J(ITM1),J(ITM1-1),J(ITM1-2),ARG,1)
15    CONTINUE
      RETURN
4     DO 20 N =1,NCAP
      ITM1 =ICAP-N*KCAP
      IF(J(ITM1)-4) 7,8,8
8     FAB(1) = 0.
      FAB(4) = 0.
      GO TO 9
7     ARG =F(LCAP-N*MCAP) *W
      CALL SMB (J(ITM1),J(ITM1-1),J(ITM1-2),ARG,2)
9     ITM1 =LDER + JCAP -N*NDQCAP
      F(ITM1-1) =FAB(1)
       ITM1=LDEI+JCAP-N*NDQCAP
      F(ITM1-1) =FAB(4)
20     CONTINUE
      RETURN
      END
C        SMG
C
      SUBROUTINE SMG(KTY,KT1,KT2,ARG,KNT )
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
      EQUIVALENCE (JAB(160),MSUP),(JAB(163),LSUPM),(JAB(166),NSUP)
      EQUIVALENCE (JAB(190),LVR ),(JAB(189),LVI ),(JAB(159),LSUPP)
C  .........          ..........          ..........          ..........
      GO TO (10,11) KNT
10    GO TO (1,2,3) KTY
1     A = AA(KT1,KT1, ARG)
      A = AA(KT1,KT2,-ARG)
      A = AA(KT2,KT2, ARG)
      A = AA(KT2,KT1,-ARG)
      GO TO 5
2      KS=KT2
       KN=KT1
       GO TO 130
3      KS=KT1
       KN=KT2
130    ASSIGN 134 TO KAGT
135    E =F(LSUPM-KS*MSUP)
       P =F(LSUPP-KS*MSUP)/57.29578
       IF( P) 132,131,132
131    EI=0
       ER=E
       GO TO 133
132    ER = E*COS(P)
       EI=E*SIN(P)
133    GO TO KAGT
134   A = AA(KN ,KN , ARG)
      C = CA(KN ,ARG*ER )
       D=DA(KN,ARG*EI)
5     RETURN
C
11    GO TO (6,7,8) KTY
6     VDFR=F(LVR-KT1)-F(LVR-KT2)
      VDFI=F(LVI-KT1)-F(LVI-KT2)
      GO TO 9
7      KS=KT2
       KN=KT1
       SIGN =1.
       GO TO 136
8      KS=KT1
       KN=KT2
       SIGN =-1.
136    ASSIGN 137 TO KAGT
       GO TO 135
137   VDFR=(F(LVR-KN )-ER )*SIGN
      VDFI=(F(LVI-KN )-EI )*SIGN
9     FAB(1)=VDFR*ARG
      FAB(3)=VDFR
      FAB(4)=VDFI*ARG
      FAB(6)=VDFI
      FAB(2)=FAB(1)*VDFR+FAB(4)*VDFI
      FAB(5)=-FAB(4)*VDFR+FAB(1)*VDFI
      RETURN
      END
C        SMB
C
      SUBROUTINE SMB(KTY,KT1,KT2,ARG,KNT )
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
      EQUIVALENCE (JAB(160),MSUP),(JAB(163),LSUPM),(JAB(166),NSUP)
      EQUIVALENCE (JAB(190),LVR ),(JAB(189),LVI ),(JAB(159),LSUPP)
C  .........          ..........          ..........          ..........
      GO TO (10,11) KNT
10    GO TO (1,2,3) KTY
1     A = BA(KT1,KT1, ARG)
      A = BA(KT1,KT2,-ARG)
      A = BA(KT2,KT2, ARG)
      A = BA(KT2,KT1,-ARG)
      GO TO 5
2      KS=KT2
       KN=KT1
       GO TO 130
3      KS=KT1
       KN=KT2
130    ASSIGN 134 TO KAGT
135    E =F(LSUPM-KS*MSUP)
       P =F(LSUPP-KS*MSUP)/57.29578
       IF( P) 132,131,132
131    EI=0
       ER=E
       GO TO 133
132    ER = E*COS(P)
       EI=E*SIN(P)
133    GO TO KAGT
134   A = BA(KN ,KN , ARG)
      C = CA(KN,-ARG*EI )
       D=DA(KN,ARG*ER)
5     RETURN
C
11    GO TO (6,7,8) KTY
6     VDFR=F(LVR-KT1)-F(LVR-KT2)
      VDFI=F(LVI-KT1)-F(LVI-KT2)
      GO TO 9
7      KS=KT2
       KN=KT1
       SIGN =1.
       GO TO 136
8      KS=KT1
       KN=KT2
       SIGN =-1.
136    ASSIGN 137 TO KAGT
       GO TO 135
137   VDFR=(F(LVR-KN )-ER )*SIGN
      VDFI=(F(LVI-KN )-EI )*SIGN
9     FAB(1)=-VDFI*ARG
      FAB(3)=VDFR
      FAB(4)=VDFR*ARG
      FAB(6)=VDFI
      FAB(2)=FAB(1)*VDFR+FAB(4)*VDFI
      FAB(5)=-FAB(4)*VDFR+FAB(1)*VDFI
      RETURN
      END
C      SMC
C
C        XIS
C
      SUBROUTINE XIS (KNT)
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
      EQUIVALENCE (JAB(162),MTMPAJ),(JAB(165),LTMPAJ),(JAB(168),NTMPAJ)
      EQUIVALENCE (JAB(186),LDER),(JAB(185),LDEI )
C
      EQUIVALENCE (JAB( 33),MXIS),(JAB( 43),KXIS),(JAB( 53),NDQXIS)
     1,(JAB( 63),NAMXIS),(JAB( 73),MNPXIS),(JAB( 83),NXIS)
     2,(JAB( 93),IXIS),(JAB(103),LIE ),(JAB(113),JXIS)
     3,(JAB(142),LBLF ),(JAB(141),LEPH )
      EQUIVALENCE (JAB(140),LFCO ),(JAB(139),LRB ),(JAB(138),LCTE)
     1,(JAB(137),LCC  ),(JAB(136),LRC  )
      EQUIVALENCE (FAB( 13),FREQ),(FAB( 17),W  ),(FAB( 18),TP    )
C
C  .........          ..........          ..........          ..........
      GO TO (1,2,3,4,3) KNT
1     CONTINUE
2     CALL MODELN (4,KNT)
      RETURN
3     DO  11 N =1,NXIS
       ASSIGN 50 TO IADR
      IF(J(IXIS-N*KXIS)-5) 5,11,11
5     CONTINUE
      TMPT =F(LTMPAJ -MTMPAJ)
       ITM1=LIE-N*MXIS
       FIE=F(ITM1)
       IF(FIE) 60,61,61
60     GE=-1./FIE
       GO TO 62
61     GE=11594.203*FIE    /(273.+TMPT)
62     BLF=F(ITM1-1)
       AO=BLF/(BLF+1.)
       FM=F(ITM1-2)
C  IF FM IS (-) IT IS K-THETA
       IF(FM)220,21,21
220    FM=-FM
       FM=-(FM-1.)/FM
       GO TO 22
21     CONTINUE
       FM=FM/57.295779513
22     FCO=F(ITM1-3)
       ITM2=IXIS-N*KXIS
       IF(J(ITM2-5)-1HA) 10,111,10
111    FACO=FCO
       GO TO 15
10     IF(FCO) 12,13,14
12     FACO=-FCO*(BLF+1.)*(1.+FM)
       GO TO 15
13     FACO=1.E30
       GO TO 15
14     FACO=FCO*(1.+FM)/AO
15     XM=FM
       XM3=XM*XM*XM
       XM5=XM3*XM*XM
       TM=XM+XM3/3.+2.*XM5/15.+17.*XM5*XM*XM/315.
C  TM=TAN(FM) ... TAN SERIES IS DIRECTLY DONE RIGHT ABOVE
       AT=1.-TM*((FREQ*FREQ)/(FACO*FACO))
       BT=(1.+TM)*(FREQ/FACO)
       DEN=AT*AT+BT*BT
       ALR=AO*AT/DEN
       ALI=-AO*BT/DEN
       CD=GE/(TP*FACO)
       KB=J(ITM2-1)
       KC=J(ITM2-2)
       KE=J(ITM2-3)
       KI=J(ITM2-4)
       KTYQ=J(ITM2)
       KIC=1
       KIE=1
       KBI=1
       GO TO (30,31,32,33) KTYQ
31     KIE=2
       GO TO 30
32     KIC=2
       GO TO 30
33     KBI=3
30     CONTINUE
       YEI=W*CD
       YETI=W*(CD+ F(ITM1-5))
       RC=F(ITM1-7)
       IF(RC) 41,40,41
40     YCR=0.
       GO TO 42
41     YCR=1./RC
42     YCI=W*F(ITM1-6)
       GB=1./F(ITM1-4)
       CALL SMG(KBI,KB,KI,GB,KNT-2)
       GO TO IADR
50     ASSIGN 51 TO IADR
76     CALL SMY(KIE,KI,KE,GE,YETI,KNT-2)
       GO TO IADR
51     ASSIGN 52 TO IADR
79     CALL SMY(KIC,KI,KC,YCR,YCI,KNT-2)
       GO TO IADR
52     CALL SMVC(KIE,KI,KE,GE,YEI,ALR,ALI,KIC,KI,KC,KNT-2)
11    CONTINUE
      RETURN
C
C   SOLVE THE DEP. EQ.S
4     DO 20 N=1,NXIS
      IF(J(IXIS-N*KXIS)-5) 6,7,7
7     ITM1 = LDER+JXIS-N*NDQXIS
      ITM2 = LDEI+JXIS-N*NDQXIS
      DO 8 L=1,NDQXIS
       F(ITM2-L) =0.
8      F(ITM1- L ) = 0.
      GO TO 20
6     ASSIGN 75  TO IADR
      GO TO 5
75     QBCR=FAB(1)
       QBCI=FAB(4)
       V1R=FAB(3)
       V1I=FAB(6)
      ASSIGN 77 TO IADR
      GO TO 76
77     QECR=FAB(1)
       QECI=FAB(4)
       V2R=FAB(3)
       V2I=FAB(6)
       ASSIGN 78 TO IADR
       GO TO 79
78     V3R=FAB(3)
       V3I=FAB(6)
       VBER=V1R+V2R
       VBEI=V1I+V2I
       VCER=-V3R+V2R
       VCEI=-V3I+V2I
       QCCR=QECR-QBCR
       QCCI=QECI-QBCI
      ITM1 =LDER+ JXIS -N*NDQXIS
      F(ITM1-1) = QBCR
      F(ITM1-2) = QCCR
      F(ITM1-3) = QECR
       ITM1=LDEI+JXIS-N*NDQXIS
      F(ITM1-1) = QBCI
      F(ITM1-2) = QCCI
      F(ITM1-3) = QECI
20    CONTINUE
      RETURN
      END
C      SMY
       SUBROUTINE SMY (K,K1,K2,G,B,KNT)
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
       CALL SMG (K,K1,K2,G,KNT)
       IF(KNT-2) 1,2,1
       DIMENSION TFAB(6)
2      DO 3 N=1,6
3      TFAB(N) = FAB(N)
1      CALL SMB (K,K1,K2,B,KNT)
       IF(KNT-2) 5,6,5
6      DO 7 N=1,2
       FAB(N)=FAB(N)+TFAB(N)
7      FAB(3+N) = FAB(3+N) + TFAB(3+N)
5      RETURN
       END
CIRCAC ** FICHE/FRAME BREAK *****
ACL12 SYMSORT

SYM.  PG.LN. IDENT.

1      14  4 C       1      10 27 C       1       9  2 C       1       7 22 C       
1       6 25 C       1       5 26 C       1       4 27 C       10     11 17 C       
10      9  1 C       10      7 21 C       10      3 18 C       11     12 28 C       
11      3 19 C       111    11 15 C       12     11 18 C       12      3 21 C       
13     11 20 C       13      3 22 C       130     9 12 C       130     7 32 C       
131     9 16 C       131     7 36 C       132     9 19 C       132     7 39 C       
133     9 21 C       133     8  2 C       134     9 22 C       134     8  3 C       
135     9 13 C       135     7 33 C       136     9 37 C       136     8 18 C       
137     9 39 C       137     8 20 C       14     11 22 C       14      3 24 C       
15     11 23 C       15      6 33 C       15      5 34 C       15      4 35 C       
15      3 25 C       16      3 27 C       17      3 28 C       18      3 30 C       
19      3 31 C       2      14  2 C       2      10 28 C       2       9  7 C       
2       7 27 C       2       6 26 C       2       5 27 C       2       4 28 C       
20     13 30 C       20      7  8 C       20      6  9 C       20      5 10 C       
20      3 33 C       21     11 10 C       21      3 34 C       22     11 12 C       
220    11  7 C       3      14  3 C       3      10 30 C       3       9 10 C       
3       7 30 C       3       6 28 C       3       5 29 C       3       4 30 C       
30     12  9 C       31     12  4 C       32     12  6 C       33     12  8 C       
4      12 31 C       4       6 35 C       4       5 36 C       4       4 37 C       
40     12 14 C       41     12 16 C       42     12 17 C       5      14  9 C       
5      10 33 C       5       9 25 C       5       8  6 C       50     12 21 C       
51     12 24 C       52     12 27 C       6      14  6 C       6      12 39 C       
6       9 27 C       6       8  8 C       6       6 31 C       6       5 32 C       
6       4 33 C       60     10 38 C       61     11  1 C       62     11  2 C       
7      14  8 C       7      12 33 C       7       9 30 C       7       8 11 C       
7       7  2 C       7       6  3 C       7       5  4 C       75     13  2 C       
76     12 22 C       77     13  8 C       78     13 14 C       79     12 25 C       
8      12 37 C       8       9 34 C       8       8 15 C       8       6 38 C       
8       5 39 C       8       5  1 C       8       4  3 C       9      10  2 C       
9       8 22 C       9       7  4 C       9       6  5 C       9       5  6 C       
C      13 33 C       C      11 27 C       C      11  5 C       
C      10 10 C       C       8 38 C       C       8 30 C       C       7 19 C       
C       7 11 C       C       6 23 C       C       6 12 C       C       5 24 C       
C       5 13 C       C       4 25 C       C       4 15 C       C       4  5 C       
C       4  2 C       C       3 15 C       C       3  9 C       C       3  2 C       
C       2 37 C       C       2 35 C       C       2 32 C       C       2 28 C       
C       2 26 C       C       2 22 C       C       2 20 C       C       2 19 C       
C       2 17 C       C       2 15 C       C       1  4 C       C       1  2 C       
CM     10 18 C       CM     10 12 C       CM      8 31 C       CM      7 12 C       
CM      6 13 C       CM      5 14 C       CM      4 16 C       CM      4  6 C       
CM      3 20 C       CM      3 16 C       CM      3  1 C       CM      2 36 C       
CM      2 34 C       CM      2 31 C       CM      2 25 C       CM      2 21 C       
CM      2 18 C       CM      2  6 C       CM      1 19 C       CM      1 11 C       
CM      1  5 C       CM11    9 26 C       CM11    8  7 C       CMC    12 30 C       
CMC    10 25 C       CMC    10 11 C       CMC     4  1 C       CMC     3 37 C       
CMC     3  7 C       CMC     3  3 C       CMC     2 39 C       CMC     2 30 C       
CMC     2 24 C       CMC     2  8 C       CMC     1  3 C       O.....  3 38 C       
O.....  3  4 C       O.....  2 27 C       OMC...  3 39 C       OMC...  3  5 C       
OMC...  2 29 C       
CIRCAC ** FICHE/FRAME BREAK *****
ACL21
C      /ACL21/-/BACL21/  PART OF  ACUC
C        USRKNT
C
C  ROUTINE THAT GIVES THE CIRC USER MANY DIFF. CONTROLS OVER THE PROG.
C
      DIMENSION JAB(  276 ),FAB(35),J(1),F(1),MOLLET(4),INP(72)
      COMMON JAB,FAB,J,F
      CONTINUE
      DIMENSION LTBLN(15),LTBLD(35)
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
       EQUIVALENCE (JAB(151),KDBAP)
      EQUIVALENCE (JAB(201),LTBLN( 1)),(JAB(216),LTBLD( 1))
      EQUIVALENCE (JAB(179),KTBLN),(JAB(178),KTBLD) ,(JAB(177),NTBLN)
     1,(JAB(176),NTBLD)
      EQUIVALENCE (JAB(175),IOVM) ,(JAB(174),IPOVM)
      EQUIVALENCE (JAB(172),KDLUK),(JAB(171),KDLIN)
      EQUIVALENCE (JAB( 20),JABZ),(JAB( 21),NFAB),(JAB( 22),INXI)
     1,(JAB( 23),ISDL),(JAB( 24),NPAR),(JAB( 25),NSTM),(JAB( 26),NCOM)
      EQUIVALENCE (JAB( 27),INXIBU),(JAB( 28),KPOUT) ,(JAB( 29),NNPT)
      EQUIVALENCE (JAB(276),NSEQ),(JAB(199),NSDE),(JAB(198),NUNK)
     1,(JAB(197),NDEQ),(JAB(196),NMDE),(JAB(195),MPRT),(JAB(194),IPRT)
      EQUIVALENCE (JAB(193),KNTGO),(JAB(192),KCNVO)
      EQUIVALENCE (JAB(191),ITNO)
      EQUIVALENCE (FAB( 13),FREQ),(FAB( 17),W ),(FAB( 18),TP   )
      EQUIVALENCE (FAB( 14),SFREQ),(FAB( 15),EFREQ),(FAB( 16),DELF )
      EQUIVALENCE (FAB( 19),FREQK)
C
       EQUIVALENCE (JAB(253),NCHNG),(JAB(255),KARTH(1)),(JAB(260)
     1 ,NOPR(1)), (JAB(265),NOIT(1)),(JAB(270),NOITDN(1))
     2 ,(FAB(24),VINC(1)),(FAB(31),SAVE(1))
C
      EQUIVALENCE (JAB(  1),JAB1),(JAB(  2),JAB2),(JAB(  3),JAB3)
     1,(JAB(  4),JAB4),(JAB(  5),JAB5),(JAB(  6),JAB6),(JAB(  7),JAB7)
      EQUIVALENCE (JAB(191),KOLPR),(JAB(192),KOPLP)
      EQUIVALENCE (JAB( 30),MRES),(JAB( 40),KRES),(JAB( 50),NDQRES)
     1,(JAB( 60),NAMRES),(JAB( 70),MNPRES),(JAB( 80),NRES)
     2,(JAB( 90),IRES),(JAB(100),LRES),(JAB(110),JRES)
C
C      EQUIVALENCES FOR CHAIN CONTROL
       EQUIVALENCE (JAB(181),KCC1),(JAB(182),KCC2)
       EQUIVALENCE (JAB(252),INDEL),(JAB(180),KNT)
C
C  .........          ..........          ..........          ..........
C
       ASSIGN 1501 TO LABEL
      IF(KSYKT+4001782) 1,2,1
1     KSYKT = -4001782
      KPCM = 1
      KDLCN = 1
2     CONTINUE
C
C  THIS ROUTINE IS USED ONLY IF B.P. 4 IS SET
       IF(KNTGO-6) 71,451,451
71     K94PO=1
       CLOSE
       K94IO=0
7                       CONTINUE
10    CONTINUE
      IF(KNTGO-4)  5,6,5
6     KNTGO = 2
C   GODI WILL BE DELETED IF AN OPER. ENDING W/*PROVID...* FOLLOWS GODI
5     CONTINUE
       CALL ALTMODE(1,IFLAG,LABEL)
1501  CONTINUE
1502   CLOSE(3)
      TYPE 90
9      CONTINUE
14     KNIO=1
18     ACCEPT 113,MSG11,MSG22
       IF(MSG11-3HHEL)19001,10001
19001  IF(MSG11-3HCAP)19002,10002
19002  IF(MSG11-3HINS)19003,10003
19003  IF(MSG11-3HVER)19004,20001
19004  IF(MSG11-3HCRE)19005,30001
19005  IF(MSG11-3HCHA)19006,40001
19006  IF(MSG11-3HRUN)22,35,22
10001  KNM=1
       GO TO 10150
10002  KNM=2
       GO TO 10150
10003  KNM=3
10150  OPEN(3,INPUT,SYMBOLIC,$(@7QC)ACHIC$)
       KKK=1
10161  FORMAT(1A1/)
10160  READ 3,10161,NEND
       IF(NEND-1H$)10160,10165,10160
10165  IF(KKK-KNM)10166,10170
10166  KKK=KKK+1
       GO TO 10160
10171  FORMAT(72A1/)
10170  READ 3,10171,INP
       IF(INP(1)-1H$)10175,1502
10175  ICOL=1
       I0=1
10176  IF(INP(ICOL)-1H )10180,10177,10180
10177  ICOL=ICOL+1
       IF(72-ICOL)10190,10176,10176
10180  I0=ICOL
       ICOL=ICOL+1
       GO TO 10176
10190  IF=I0
       DO 10195 I=1,IF
10195  TYPE 10171,INP(I)
       TYPE 10196
10196  FORMAT(/)
       GO TO 10170
20001  TYPE 20002
20002  FORMAT(/$VERSION 101$/)
       GO TO 1502
30001  TYPE 30002
30002  FORMAT(/$PROGRAM WRITTEN BY RICHARD MCNAIR, XDS.$/
$IMPLEMENTED BY TYMSHARE, INC.$/)
       GO TO 1502
40001  TYPE 40002
40002  FORMAT(/$NO PREMIUM CHARGES$/)
       GO TO 1502
22    CONTINUE
C  .........          ..........          ..........          ..........
C
C   SEARCH TO IDENTIFY THE MESSAGE THAT WAS INPUT
       CONTINUE
       IF (MSG11-3HREA ) 811,943,811
811    IF (MSG11-3HWRI ) 812,375,812
812    IF (MSG11-3HRUN ) 813,35,813
813    IF (MSG11-3HQUI ) 814,43,814
814    IF (MSG11-3HQ   ) 815,43,815
815    IF (MSG11-3HSWE ) 816,487,816
816     IF (MSG11-3HCOP ) 9001,9000,9001
9001   CONTINUE
       IF (MSG11-3HNOE ) 751,229,751
751    IF (MSG11-3HEXP ) 752,227,752
752    CONTINUE
       IF (MSG11-3HFIL ) 942,394,942
942   IF (MSG11-3HPOD ) 24,86,24
86     IF(MSG22-3HL  )706,25,714
706    IF(MSG22-3HB  )714,89,714
24    IF (MSG11-3HOUT ) 26,372,26
26    IF (MSG11 -3HRES ) 28,374,28
28    IF (MSG11 -3HDUM ) 30,375,30
30    IF (MSG11 -3HLOA ) 32,943,32
32    IF (MSG11 -3HEXI ) 34,35,34
34     IF(MSG11-3HFRE ) 36,37,36
36    IF (MSG11 -3HGON )  38,302,38
302    IF (MSG22-3HM   ) 303,39,714
303    IF (MSG22-3HD   ) 714,43,714
38     IF(MSG11-3HREP ) 40,41,40
40     CONTINUE
42    IF (MSG11 -3HGOD ) 44,45,44
44     IF(MSG11-3HGOO ) 76,47,76
76    IF (MSG11 -3HPPP ) 78,79,78
78     CONTINUE
80    IF (MSG11 -3HCPP ) 82,83,82
82     IF(MSG11-3HITP ) 84,487,84
84     CONTINUE
88     IF (MSG11-3HPOA ) 188,91,188
188    CONTINUE
       IF (MSG11 -3HPRI ) 190,191,190
190    IF (MSG11 -3HDUI ) 192,193,192
192    IF(MSG11 -3HCVE ) 194,195,194
194    CONTINUE
304   IF (MSG11 -3HTBL )  306,307,306
306   IF (MSG11 -3HTBL ) 308,370,308
370    IF (MSG22-3HD   ) 714,309,373
373    IF (MSG22-3HN   )714,307,714
308    CONTINUE
310    CONTINUE
312   IF (MSG11 -3HINN )  314,315,314
314   IF (MSG11 -3HIND )  316,317,316
316   CONTINUE
C
200   IF (MSG11 -3HCFA ) 202,203,202
202    CONTINUE
206    CONTINUE
214   IF (MSG11-3HPCO ) 216,9010,216
216   IF (MSG11-3HCCO )218,9010,218
218   IF (MSG11-3HNOD )220,9010,220
220    CONTINUE
       IF(MSG11-3HIND )226,227,226
226    IF(MSG11-3HINP )228,229,228
228    CONTINUE
C
C
C
708     CONTINUE
714   CONTINUE
      WRITE K94PO,92
      GO TO 7
C
C  .........          ..........          ..........          ..........
C      S A V E
372    CLOSE (5)
       PUNCH 379
379    FORMAT(4X,$TO FILE: $)
       OPEN (5,OUTPUT,//)
       K94POT=-1
       CONTINUE
       GO TO 1502
C
C
C      COPY    (COPY INPUT TO AN OUTPUT FILE [DATA ONLY] )
9000   CONTINUE
       ICOPY=1
       PUNCH 961
               CLOSE (6)
961    FORMAT(4X,$TO FILE NAME: $)
       OPEN (6,OUTPUT,//)
       K94FO=6
       GO TO 1502
C
C
C
C      R E S E T
374    CLOSE
       ICOPY=0
       K94PO=1
       K94IO=0
       CONTINUE
       GO TO 1502
C
C      D U M P CURRENT NOM.,MIN.,MAX. VALUES TO A FILE
375    CLOSE (8)
       IF (NSEQ) 821,821,822
821    PUNCH 823
823    FORMAT (//$ERROR---NO DATA TO BE DUMPED$//)
       GO TO  9
822    PUNCH 379
       OPEN (8,OUTPUT,//)
       CALL DUMP1(MSG22)
       CLOSE (8)
       CONTINUE
       GO TO 1501
C
C
C      L O A D                 GET INPUT FROM FILE           FILE
C   WHEN K94IOT=0  INPUT FROM TTY
C   WHEN K94IOT=-1 INPUT FROM FILE /#DCIN/
C 943    K94IOT=-1
943    CONTINUE
           PUNCH 391
       KNTGO=4
391    FORMAT (4X,$READ FROM FILE OR TELETYPE ? $)
       READ (0,392) IDEVNU
392    FORMAT (A1/)
       IF (IDEVNU-1HF ) 943,394,393
393    CONTINUE
       IF (IDEVNU-1HT ) 943,395,943
395    K94IO=0
       K94PO=1
       K94FO=6
       IF (ICOPY) 6774,6774,99
6774   CONTINUE
       CLOSE
       OPEN (6,OUTPUT,$NOTHING$)
       GO TO 99
394    CONTINUE
       KNTGO=4
       PUNCH 380
928    CONTINUE
       IF (ICOPY ) 963,963,962
963    CONTINUE
       CLOSE
       OPEN (6,OUTPUT,$NOTHING$)
962    CONTINUE
       CLOSE (4,5)
       OPEN (5,OUTPUT,$NOTHING$)
380    FORMAT(4X,$ENTER FILE NAME: $)
       OPEN (4,INPUT,//)
       OPEN (5,OUTPUT,$NOTHING$)
       K94PO=5
       K94FO=6
       K94IO=4
       CONTINUE
       IF (MSG11-3HFIL )99,9,99
C
C                             PRINT OUTPUT DELETE                   PODL
25     CLOSE (5,6)
       OPEN (5,OUTPUT,$NOTHING$)
       OPEN (6,OUTPUT,$NOTHING$)
       K94FO=6
       K94POT=-1
       GO TO 1502
C
C
C
C                             EXIT FROM USER CONTROL ROUTINE        EXIT
35    GO TO 99
C                              TAKE FREQ CHANGE                    FREQ
37     CONTINUE
       CALL INPUT (9,1,0,0)
       GO TO 7
C                             GO TO DO NOMINAL SOLUTIONS            GONM
39    KNTGO =2
       KOLPR=0
       KOPLP=0
      GO TO 1502
C                             RE-PRINT SOLUTION OUTPUT              REPR
41                      JAB1=3HREP
       JAB2=3HRIN
       JAB3=3HT
       JAB4=3H
       JAB5=3H
                        JAB6=3H
                        JAB7=3H
        CALL SOLOUT (1,ITNO)
        GO TO 7
C                             GO TO END (CALLS  *STOP*)             GOND
43     CALL EXIT
C                             GO TO DO DATA INPUT                   GODI
45    CONTINUE
       KNTGO=4
       CLOSE
       K94PO=1
       OPEN (6,OUTPUT,$NOTHING$)
       K94FO=6
      GO TO 1502
C                              SET UP TO DO OPEN LOOP             GOOL
47     IF(INDEL) 471,470,471
470    CONTINUE
       WRITE K94PO,93
       WRITE K94PO,8090
8090   FORMAT(4X,$NO. OF R TO OPEN,TERM. TO DRIVE,1 FOR FULL OUTPUT,$/)
471    CONTINUE
       CALL INPUT (1,3,0,0)
       KOLPR=JAB(3)
       IF(J(IRES-JAB(1)*KRES-1)-JAB(2) )8092,8093,8092
8093   KOPLP=JAB(1)
       GO TO 8094
8092   KOPLP=-JAB(1)
8094   CONTINUE
       IF(KNTGO-6) 8095,8096,8096
8095   KNTGO=5
       GO TO 7
8096   KNTGO = 7
       GO TO 7
C                             PRINT VALUE OF PRESENT PARAMETERS     PPPR
79    ITMP   = 1
       IF(INDEL) 791,790,791
790    CONTINUE
      WRITE K94PO,93
      WRITE K94PO,97
791    CONTINUE
      CALL INPUT (1,2,0,0)
      IF(JAB 2) 68,68,67
68    JAB 2  = NPAR    +NNPT
67    CONTINUE
      NN =      JAB(2)-JAB(1) +1
      DO 65,N=1,NN
      WRITE K94PO,98,JAB(1),(F((ISDL-1)-  JAB(1)-L),L=0,ITMP  -1)
C  (ISDL-1) IS REQ.D FORM FOR AC WHERE 1ST PAR. HAS TWO PARTS
65    JAB(1)=JAB(1)+1
      GO TO 7
C                             CHANGE VAL. OF PRESENT PARAMETER      CPPR
83     IF(INDEL) 831,830,831
830    CONTINUE
      WRITE K94PO,93
      WRITE K94PO,100
      WRITE K94PO,101
831    CONTINUE
253   CALL INPUT (1,2,0,0)
      ITMP  =JAB(1)
      IF(ITMP ) 250,250,261
261   CONTINUE
      CALL INPUT (7,5,0,0)
      CALL CONPER (3,0,1,ISDL)
      F((ISDL-1) -   ITMP) = FAB(1)
262   CONTINUE
      WRITE K94PO,96,ITMP,FAB(1)
49    F(ISDL )=0.
      GO TO 253
250   CONTINUE
      GO TO 7
C                              PARAMETER ITERATION                ITPR
487    IF(INDEL)518, 517,518
517    WRITE K94PO,93
       WRITE K94PO,494
518    CALL INPUT (1,1,0,0)
       NCHNG=JAB(1)
       DIMENSION NOPR(5),NOIT(5),KARTH(5),NOITDN(5),VINC(5),SAVE(5)
       DO 446 N=1,NCHNG
       CALL INPUT (1,2,0,0)
       NOPR(N)=JAB(1)
       NOIT(N)=JAB(2)
       NOITDN(N)=0
       READ K94IO,7775 ,FAB(1),JAB(1),FAB(2),JAB(2)
7775  FORMAT (F20.0,A1,F20.0,A1/)
448    IF (JAB(1)-1H,) 410,430,410
410    IF (JAB(1)-1HS) 415,412,415
412    PNEG=FAB(2)
       PPOS=FAB(2)
       GO TO 420
415    IF (JAB(1)-1HR) 420,416,420
416    FAB(2)=PPOS
420    FAB(2)=FAB(1)*FAB(2)*.01
430    KARTH(N)=JAB(2)
       ITMP=(ISDL-1)-NOPR(N)
       SAVE(N)=F(ITMP)
       F(ITMP)=FAB(1)
       VINC(N)=FAB(2)
446    CONTINUE
4460   IF(KNTGO-5) 4463,4461,4463
4461   KNTGO = 7
       GO TO 4468
4463   KNTGO = 6
4468   CONTINUE
       DO 480 N=1,NCHNG
480    WRITE K94PO,96,NOPR(N),F((ISDL-1)-  NOPR(N))
4250   CONTINUE
449    F(ISDL )=0
       GO TO 7
451    IF(KNT-3) 7,490,4255
490    KNT=4
       IF (NCHNG) 4255,4255,450
4255   KNTGO=3
       GO TO 7
450    CONTINUE
       KNTGO=-KNTGO
       WRITE K94PO,495
       DO 452 NN=1,NCHNG
       ITMP=(ISDL-1)-NOPR(NN)
       NOITDN(NN)=NOITDN(NN)+1
       IF (NOIT(NN)-NOITDN(NN)) 463,463,453
453    CONTINUE
       IF(KNTGO) 4532,4531,4531
4531   KNTGO=-KNTGO
4532   CONTINUE
       FTMP=F(ITMP)
       IF (KARTH(NN)-1HM   ) 456,455,456
456    IF (KARTH(NN)-1HD   ) 458,457,458
458    IF (KARTH(NN)-1HS   ) 460,459,460
460    FTMP=FTMP+VINC(NN)
       GO TO 462
459    FTMP=FTMP-VINC(NN)
       GO TO 462
457    FTMP=FTMP/VINC(NN)
       GO TO 462
455    FTMP=FTMP*VINC(NN)
462    F(ITMP)=FTMP
       GO TO 452
463    FTMP=F(ITMP)
452    CONTINUE
       IF (KNTGO) 461,472,472
461    KNTGO= -KNTGO
C  RESET AFTER ITERATION IS DONE
       DO 467 NN=1,NCHNG
       ITMP=((ISDL-1)-NOPR(NN))
       F(ITMP)=SAVE(NN)
467    WRITE K94PO,96,NOPR(NN),F(ITMP)
       NCHNG=0
       GO TO 7
472    DO 473 NN=1,NCHNG
       ITMP=((ISDL-1)-NOPR(NN))
473    WRITE K94PO,96,NOPR(NN),F(ITMP)
       GO TO 99
C              SETOUTPUT TO DB                                     PODB
89     KDBAP = 1
       GO TO 1502
C              SETOUTPUT TO AP                                     POAP
91     KDBAP = 0
       GO TO 1502
C
C              PARAMETER ID                                        PRID
C
191    JAB1= 1
       GO TO 970
C
C              DEPENDENT UNKNOWN ID                                DUDI
C
193    JAB1  =2
       GO TO 970
C
C      TO CHANGE VERSIONS OF PROGRAM WHILE RUNNING                CVER
195    CALL INPUT(1,1,0,0)
       KCC1=JAB(1)
      GO TO 7
C  KTBLN  CONTROL OUTPUT AND W.C. QUANTITY FOR NODES - KTBLD FOR DEP. EQ
C KTBLN 1=FULL W.C. W/ FULL OUT   2=FULL W.C. W/ CONTROLED OUT.
C KTBLN 3=CONT W.C. W/ FULL OUT   4=CONT W.C. W/ CONTROLED OUT.
C
C                  NODE       TABLE CONTROL(FOR W.C. AND OUTPUT)    TBLN
307    IF(INDEL) 3071,3070,3071
3070   CONTINUE
       WRITE K94PO,93
      WRITE K94PO,7135
3071   CONTINUE
      CALL INPUT(1,1,0,0)
1307   KTBLN = JAB1
       GO TO 7
C                  DEP. EQ.   TABLE CONTROL(FOR W=3= 1N4 OUTPUT)    TBLD
309    IF(INDEL) 3091,3090,3091
3090   CONTINUE
       WRITE K94PO,93
      WRITE K94PO,7135
3091   CONTINUE
      CALL INPUT(1,1,0,0)
1309   KTBLD = JAB1
       GO TO 7
C                             INPUT NODE CONTROL (W.C. OR OUT)TABLE INNT
315   L = 0
      GO TO 360
C                             INPUT DEP. EQ. CNTRL (WC/OUT) TABLE   INDT
317   L = 1
360    IF(INDEL) 3601,3600,3601
3600   CONTINUE
      WRITE K94PO,93
      WRITE K94PO,354
3601   CONTINUE
      NNN=0
355   CALL INPUT (1,12,0,0)
      DO 356 N=1,12
      NN = NNN +N
      IF(JAB(N)) 357,357,358
358   LTBLN(NN+L*15) = JAB(N)
356   CONTINUE
      NNN = NNN +12
      GO TO 355
357   JAB(177-L) = NN-1
       JAB1=2
      IF(L) 1307,1307,1309
C
C                             CHANGE FAB) ID NO. WILL CAUSE FAB(N) TO BE LISTED--(+)NO. FOR CHANGE
203   CALL INPUT (1,1,0,0)
      L = JAB(1)
      IF(L) 611,611,612
611   L = -L
614   WRITE K94PO,613 ,L,FAB(L)
      GO TO 7
612   CALL INPUT(7,5,0,0)
      FAB(L) = FAB(1)
      GO TO 614
C
C              DELETE PRINTED INSTRUCTIONS                   INDL
C
227    CONTINUE
       INDEL=1
C      WHEN INDEL=0, INSTRUCTIONS ARE PRINTED
C      WHEN INDEL=1, INSTRUCTIONS ARE DELETED
       GO TO 1502
C
C              PRINT INSTRUCTIONS                              INPR
C
229    CONTINUE
       INDEL=0
       GO TO 1502
C
C                CALL SUBROUTINE CONNOD WHICH............PCON,CCON,NODE
C
9010  CONTINUE
      CALL CONNOD ( MSG11)
      GO TO 7
99    CONTINUE
       IF (K94POT) 954,955,955
954    K94POT = 0
       K94PO  = 5
955    CONTINUE
72800  CONTINUE
72801  IF(KCC1) 72802,72802,72803
72802  NART=6
       MOLLET(1)=3H/AC
       MOLLET(2)=3HNM/
       CALL LINK(NART,MOLLET)
72803  GO TO (72811,72812,72813,72814   ),KCC1
72811     NART=10
       MOLLET(1)=3H(@6
       MOLLET(2)=3HLA)
       MOLLET(3)=3HACN
       MOLLET(4)=1HM
       CALL LINK(NART,MOLLET)
72812  GO TO 72802
72813  CONTINUE
72814  CONTINUE
       STOP
970    CONTINUE
73800  CONTINUE
73801  IF(KCC1) 73802,73802,73803
73802  NART=6
       MOLLET(1)=3H/AC
       MOLLET(2)=3HID/
       CALL LINK(NART,MOLLET)
73803  GO TO (73811,73812,73813,73814   ),KCC1
73811  CONTINUE
73812      NART=10
       MOLLET(1)=3H(@6
       MOLLET(2)=3HLA)
       MOLLET(3)=3HACI
       MOLLET(4)=1HD
       CALL LINK(NART,MOLLET)
73813  CONTINUE
73814  CONTINUE
       STOP
C
C
C
90    FORMAT (/$:$)
92    FORMAT (/,4X,$ILLEGAL  CONTROL MESSAGE:$/)
93     FORMAT(/,4X,$SPECIFY THE FOLLOWING:$/)
494    FORMAT (/,4X,$NO. OF PAR.S TO ITERATE (5 MAX)$,//,4X,$PAR. NO.,
     1 NO. OF ITERATIONS,$/,4X,$STARTING VAL.,INCR. INFO.,ARITH INFO,$/)
495    FORMAT (///)
96    FORMAT ( 12X,$PAR. NO. $,I3,$ = $,E15.8,/)
97    FORMAT (/,4X,$NO. OF FIRST PAR.,NO. OF LAST PAR. (0 FOR ALL PAR.),
     1$,/)
98    FORMAT (1X,I4,E16.8/)
100   FORMAT ( /,4X,$PAR. NO. (0 TO END),$/)
101   FORMAT (   4X,$PAR. VALUE,$/)
113   FORMAT (2A3/)
114   FORMAT (4X,A4/)
354   FORMAT (/,4X,$THE UNKNOWN NUMBERS, (0 ENDS ENTRIES)$,/,4X,$(LIMITS
     1- 12 ENTRIES PER LINE,15 NODES,35 DEP. EQ.S)$/)
613   FORMAT (I5,E16.8/)
7135   FORMAT ( /,4X,$1 FOR FULL OUTPUT, 2 FOR CONTROLLED OUTPUT$/)
       END
       SUBROUTINE DUMP1(MSG22)
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
               EQUIVALENCE (JAB(26),NCOM)
C
      EQUIVALENCE (JAB(276),NSEQ),(JAB(199),NSDE),(JAB(198),NUNK)
     1,(JAB(197),NDEQ),(JAB(196),NMDE)
      EQUIVALENCE (JAB(190),LVR ),(JAB(189),LVI ),(JAB(188),LVA )
     1,(JAB(187),LVP )
      EQUIVALENCE (JAB(186),LDER),(JAB(185),LDEI )
      EQUIVALENCE (JAB(184),LSDER),(JAB(183),LSDEI )
      EQUIVALENCE (JAB(160),MSUP),(JAB(163),LSUPM),(JAB(166),NSUP)
      EQUIVALENCE (JAB(159),LSUPP)
C
      EQUIVALENCE (JAB( 30),MRES),(JAB( 40),KRES),(JAB( 50),NDQRES)
     1,(JAB( 60),NAMRES),(JAB( 70),MNPRES),(JAB( 80),NRES)
     2,(JAB( 90),IRES),(JAB(100),LRES),(JAB(110),JRES)
      EQUIVALENCE (JAB( 31),MIND),(JAB( 41),KIND),(JAB( 51),NDQIND)
     1,(JAB( 61),NAMIND),(JAB( 71),MNPIND),(JAB( 81),NIND)
     2,(JAB( 91),IIND),(JAB(101),LIND),(JAB(111),JIND)
      EQUIVALENCE (JAB( 32),MCAP),(JAB( 42),KCAP),(JAB( 52),NDQCAP)
     1,(JAB( 62),NAMCAP),(JAB( 72),MNPCAP),(JAB( 82),NCAP)
     2,(JAB( 92),ICAP),(JAB(102),LCAP),(JAB(112),JCAP)
      EQUIVALENCE (JAB( 35),MVZS),(JAB( 45),KVZS),(JAB( 55),NDQVZS)
     1,(JAB( 65),NAMVZS),(JAB( 75),MNPVZS),(JAB( 85),NVZS)
     2,(JAB( 95),IVZS),(JAB(105),LVTR),(JAB(115),JVZS),(JAB(150),LVTI)
      EQUIVALENCE (JAB(149),LZR ),(JAB(148),LZI )
      EQUIVALENCE (JAB( 34),MCYS),(JAB( 44),KCYS),(JAB( 54),NDQCYS)
     1,(JAB( 64),NAMCYS),(JAB( 74),MNPCYS),(JAB( 84),NCYS)
     2,(JAB( 94),ICYS),(JAB(104),LCTR),(JAB(114),JCYS)
      EQUIVALENCE (JAB(147),LCTI),(JAB(146),LYR ),(JAB(145),LYI  )
      EQUIVALENCE (JAB( 33),MXIS),(JAB( 43),KXIS),(JAB( 53),NDQXIS)
     1,(JAB( 63),NAMXIS),(JAB( 73),MNPXIS),(JAB( 83),NXIS)
     2,(JAB( 93),IXIS),(JAB(103),LIE ),(JAB(113),JXIS)
     3,(JAB(142),LBLF ),(JAB(141),LEPH )
      EQUIVALENCE (JAB(140),LFCO ),(JAB(139),LRB ),(JAB(138),LCTE)
     1,(JAB(137),LCC  ),(JAB(136),LRC  )
C
C  .........          ..........          ..........          ..........
C
C
C
C
      EQUIVALENCE (JAB(161),MNMP),(JAB(164),LNMP),(JAB(167),NNMP)
      EQUIVALENCE (JAB(162),MTMPAJ),(JAB(165),LTMPAJ),(JAB(168),NTMPAJ)
C
      EQUIVALENCE (JAB(  1),JAB1),(JAB(  2),JAB2),(JAB(  3),JAB3)
     1,(JAB(  4),JAB4),(JAB(  5),JAB5),(JAB(  6),JAB6),(JAB(  7),JAB7)
      EQUIVALENCE (FAB( 13),FREQ),(FAB( 17),W  ),(FAB( 18),TP    )
      EQUIVALENCE (FAB( 14),SFREQ),(FAB( 15),EFREQ),(FAB( 16),DELF  )
      EQUIVALENCE (FAB( 19),FREQK)
111    CONTINUE
       IF (MSG22-3HP## ) 112,113,112
113    PUNCH 114
114    FORMAT (/$ENTER 'F' NUMBER: $)
       READ (0,115) JJNUM
       IF (JJNUM) 1000,1000,116
116    CONTINUE
115    FORMAT (I8/)
       WRITE (1,37) F(JJNUM)
       PUNCH 99
99     FORMAT (/)
       GO TO 114
112    CONTINUE
C      # OF NODES
       WRITE (8,33) JAB(200)
C      # OF VOLTAGE SUPPLIIES
       WRITE (8,33) NSUP
C      ARE SPEC. EQ. USED
       IF(KCC1-1)30,30
31     WRITE (8,32)
32     FORMAT ($YES$/)
C      # OF SPEC. DEPENDENT EQUATIONS
       WRITE (8,33) NSDE
33     FORMAT (I3,$,$/)
C      # OF NON-MODEL PARAMETERS
       WRITE (8,33) NNMP
       GO TO 42
30     WRITE (8,43)
43     FORMAT ($NO$/)
42     CONTINUE
C      # OF STANDARD ELEMENTS
C
C
       WRITE(8,34) (JAB(79+I),I=1,6)
34     FORMAT(6(I3,$,$)/)
C      TEST TO SEE IF SUPPLIES WERE USED
       IF (NSUP) 35,35,36
36     WRITE(8,37) (((F(LSUPM-N*MSUP),F(LSUPP-N*MSUP)),N=1,NSUP))
37     FORMAT(2(E15.8,$,$))
       WRITE(8,99)
35     IF (NSDE+NNMP) 38,38,39
C      NON-MODEL PARAMETER OUTPUT
39     WRITE(8,370)((F(LNMP-N*MNMP),N=1,NNMP))
370    FORMAT(E15.8,$,$)
       WRITE(8,99)
38     CONTINUE
C      TEMPERATURE
       WRITE(8,370)(F(LTMPAJ-1*MTMPAJ))
       WRITE(8,99)
C
C      OUTPUT OF ALL ELEMENT CONNECTIONS AND VALUES
C
       DO 1000 I=1,6
       IF (JAB(79+I))1000,1000,1
1      CONTINUE
       NSTMTY=I
       DO 1001 JI=1,JAB(79+I)
       NDEVIC=JI
       JAB1=1HN
       JAB2=1HN
       JAB3=1HN
       ITM1=JAB(89+NSTMTY)-NDEVIC*JAB(39+NSTMTY)
       GO TO ( 411,411,411,412,411,411) NSTMTY
411    GO TO (416,417,418,416) J(ITM1)
417    JAB2=1HS
       GO TO 416
418    JAB1=1HS
416    CONTINUE
       GO TO (900,900,900,901,901,901) NSTMTY
C
C      CYS-VZS CONNECTION DATA
901    CONTINUE
       WRITE(8,430) JAB1,J(ITM1-1),JAB2,J(ITM1-2),(J(ITM1-N),N=3,5)
       GO TO 911
900    CONTINUE
       WRITE(8,420)JAB1,J(ITM1-1),JAB2,J(ITM1-2)
       GO TO 911
C
C
911    CONTINUE
       GO TO (50,51,52,53,54,55) NSTMTY
C
412    GO TO (421,422,423,424,421) J(ITM1)
422    JAB3=1HS
       GO TO 421
423    JAB2=1HS
       GO TO 421
424    JAB1=1HS
421    CONTINUE
       WRITE(8,480) JAB1,J(ITM1-1),JAB2,J(ITM1-2),JAB3,J(ITM1-3),
     1 J(ITM1-5)
       GO TO 911
C      RESISTENCE VALUE DATA
50     CONTINUE
       WRITE(8,60) (F(LRES-JI*MRES))
       GO TO 1001
C
C      INDUCTOR VALUE DATA
51     CONTINUE
       WRITE(8,60) (F(LIND-JI*MIND))
       GO TO 1001
C
C      CAPACITOR VALUE DATA
52     CONTINUE
       WRITE(8,60) (F(LCAP-JI*MCAP))
       GO TO 1001
C
C
C      TRANSISTOR VALUE  DATA
53     CONTINUE
       WRITE(8,60) (F(LIE-JI*MXIS))
       WRITE(8,61) (F(LBLF-JI*MXIS),F(LEPH-JI*MXIS))
       WRITE(8,60) (F(LFCO-JI*MXIS))
       WRITE(8,60) (F(LRB -JI*MXIS))
       WRITE(8,60) (F(LCTE-JI*MXIS))
       WRITE(8,61) (F(LCC -JI*MXIS),F(LRC-JI*MXIS))
       GO TO 1001
C
C      VZS
55     CONTINUE
       WRITE(8,61)(F(LVTR-JI*MVZS),F(LVTI-JI*MVZS))
       WRITE(8,61)(F(LZR -JI*MVZS),F(LZI -JI*MVZS))
       GO TO 1001
C
C
C      CYS
54     CONTINUE
       WRITE(8,61) (F(LCTR-JI*MCYS),F(LCTI-JI*MCYS))
       WRITE(8,61) (F(LYR -JI*MCYS),F(LYI -JI*MCYS))
C
C
60     FORMAT(E15.8,$,$/)
61     FORMAT(2(E15.8,$,$)/)
420    FORMAT(2(A1,I3,$,$)/)
430    FORMAT(3(A1,I3,$,$),A1/)
480    FORMAT(3(A1,I3,$,$),$C0,$,A1/)
1001   CONTINUE
1000   CONTINUE
C
C      FREQUENCY DATA
       WRITE (8,60) SFREQ
       IF (FREQK) 70,70,71
70     CONTINUE
       WRITE (8,75)
75     FORMAT($M$/)
       GO TO 79
71     CONTINUE
       WRITE (8,76)
76     FORMAT($A$/)
79     CONTINUE
63     FORMAT(2(E15.8,$,$/))
       WRITE (8,63) DELF,EFREQ
       RETURN
       END
CIRCAC ** FICHE/FRAME BREAK *****
ACL21 SYMSORT

SYM.  PG.LN. IDENT.

1      18  2 C       1       2  1 C       10      2 11 C       100    15 15 C       
1000   19 33 C       10001   2 30 C       10002   2 32 C       10003   2 34 C       
1001   19 32 C       101    15 16 C       10150   2 35 C       10160   2 38 C       
10161   2 37 C       10165   3  1 C       10166   3  2 C       10170   3  5 C       
10171   3  4 C       10175   3  7 C       10176   3  9 C       10177   3 10 C       
10180   3 12 C       10190   3 15 C       10195   3 17 C       10196   3 19 C       
111    16 30 C       112    17  3 C       113    16 32 C       113    15 17 C       
114    16 33 C       114    15 18 C       115    16 37 C       116    16 36 C       
1307   12 25 C       1309   12 34 C       14      2 21 C       1501    2 17 C       
1502    2 18 C       18      2 22 C       188     4 30 C       190     4 32 C       
19001   2 24 C       19002   2 25 C       19003   2 26 C       19004   2 27 C       
19005   2 28 C       19006   2 29 C       192     4 33 C       194     4 34 C       
195    12 12 C       2       2  4 C       20001   3 21 C       20002   3 22 C       
202     5  6 C       203    13 20 C       206     5  7 C       214     5  8 C       
216     5  9 C       218     5 10 C       22      3 31 C       220     5 11 C       
226     5 13 C       228     5 14 C       24      4 11 C       25      7 19 C       
250     9 32 C       253     9 21 C       26      4 12 C       261     9 24 C       
262     9 28 C       28      4 13 C       30     17 18 C       30      4 14 C       
30001   3 24 C       30002   3 25 C       302     4 18 C       303     4 19 C       
304     4 35 C       306     4 36 C       307    12 19 C       3070   12 20 C       
3071   12 23 C       308     4 39 C       309    12 28 C       3090   12 29 C       
3091   12 32 C       31     17 10 C       310     5  1 C       312     5  2 C       
314     5  3 C       315    12 37 C       316     5  4 C       317    13  1 C       
32     17 11 C       32      4 15 C       33     17 14 C       34     17 23 C       
34      4 16 C       35     17 29 C       35      7 26 C       354    15 19 C       
355    13  8 C       356    13 13 C       357    13 16 C       358    13 12 C       
36     17 26 C       36      4 17 C       360    13  2 C       3600   13  3 C       
3601   13  6 C       37     17 27 C       37      7 28 C       370    17 32 C       
370     4 37 C       372     5 21 C       373     4 38 C       374     5 38 C       
375     6  6 C       379     5 23 C       38     17 34 C       38      4 20 C       
380     7 10 C       39     17 31 C       39      7 32 C       391     6 24 C       
392     6 26 C       393     6 28 C       394     6 38 C       395     6 30 C       
40      4 21 C       40001   3 28 C       40002   3 29 C       41      7 37 C       
410    10 10 C       411    18 11 C       412    10 11 C       415    10 14 C       
416    18 15 C       416    10 15 C       417    18 12 C       418    18 14 C       
42     17 20 C       42      4 22 C       420    19 29 C       420    10 16 C       
421    18 32 C       422    18 27 C       423    18 29 C       424    18 31 C       
4250   10 30 C       4255   10 36 C       43     17 19 C       43      8  8 C       
430    19 30 C       430    10 17 C       44      4 23 C       446    10 22 C       
4460   10 23 C       4461   10 24 C       4463   10 26 C       4468   10 27 C       
448    10  9 C       449    10 31 C       45      8 10 C       450    10 38 C       
451    10 33 C       452    11 24 C       453    11  6 C       4531   11  8 C       
4532   11  9 C       455    11 20 C       456    11 12 C       457    11 18 C       
458    11 13 C       459    11 16 C       460    11 14 C       461    11 26 C       
462    11 21 C       463    11 23 C       467    11 31 C       47      8 18 C       
470     8 19 C       471     8 23 C       472    11 34 C       473    11 36 C       
480    19 31 C       480    10 29 C       487     9 35 C       49      9 30 C       
490    10 34 C       494    15  8 C       495    15 10 C       5       2 15 C       
50     18 37 C       51     19  2 C       517     9 36 C       518     9 38 C       
52     19  6 C       53     19 10 C       54     19 24 C       55     19 19 C       
6       2 13 C       61     19 28 C       611    13 23 C       612    13 26 C       
613    15 21 C       614    13 24 C       63     20  6 C       65      9 12 C       
67      9  7 C       6774    6 34 C       68      9  6 C       7       2 10 C       
70     19 37 C       706     4 10 C       71     20  2 C       71      2  7 C       
7135   15 22 C       714     5 16 C       72800  14  9 C       72801  14 10 C       
72802  14 11 C       72803  14 15 C       72811  14 16 C       72812  14 22 C       
72813  14 23 C       72814  14 24 C       73800  14 27 C       73801  14 28 C       
73802  14 29 C       73803  14 33 C       73811  14 34 C       73812  14 35 C       
73813  15  2 C       73814  15  3 C       75     19 39 C       751     4  5 C       
752     4  6 C       76     20  4 C       76      4 24 C       7775   10  8 C       
78      4 25 C       79     20  5 C       79      8 37 C       790     8 39 C       
791     9  3 C       80      4 26 C       8090    8 22 C       8092    8 29 C       
8093    8 27 C       8094    8 30 C       8095    8 32 C       8096    8 34 C       
811     3 36 C       812     3 37 C       813     3 38 C       814     3 39 C       
815     4  1 C       816     4  2 C       82      4 27 C       821     6  8 C       
822     6 11 C       823     6  9 C       83      9 15 C       830     9 16 C       
831     9 20 C       84      4 28 C       86      4  9 C       88      4 29 C       
89     11 39 C       9       2 20 C       900    18 21 C       9000    5 29 C       
9001    4  3 C       901    18 18 C       91     12  3 C       92     15  6 C       
928     7  2 C       93     15  7 C       942     4  8 C       943     6 21 C       
954    14  6 C       955    14  8 C       96     15 11 C       961     5 33 C       
962     7  7 C       963     7  4 C       97     15 12 C       970    14 26 C       
98     15 14 C       99     17  1 C       99     14  4 C       
C      18 36 C       C      17 35 C       C      17 30 C       C      17 24 C       
C      17 21 C       C      17 15 C       C      17 12 C       C      17  8 C       
C      17  6 C       C      17  4 C       C      13 33 C       C      13 32 C       
C      12 39 C       C      12 36 C       C      12 27 C       C      12 17 C       
C      12 16 C       C      12 15 C       C      12  2 C       C      11 38 C       
C      11 27 C       C       9 34 C       C       9 14 C       C       9 11 C       
C       8 36 C       C       8 17 C       C       8  9 C       C       8  7 C       
C       7 36 C       C       7 31 C       C       7 27 C       C       6 20 C       
C       6 19 C       C       6 18 C       C       5 20 C       C       3 32 C       
C       2 14 C       C       1  2 C       CM     17 39 C       CM     16 25 C       
CM     15 38 C       CM     15 30 C       CM      1 38 C       CM      1 28 C       
CM      1 25 C       CM      1  4 C       CM191  12  6 C       CM193  12  9 C       
CM200   5  5 C       CM227  13 30 C       CM229  13 36 C       CM412  18 26 C       
CM9010 14  1 C       CMC    19 34 C       CMC    19 18 C       CMC    19  5 C       
CMC    19  1 C       CMC    18 17 C       CMC    17 38 C       CMC    16 22 C       
CMC    13 39 C       CMC    13 35 C       CMC    13 29 C       CMC    13 19 C       
CMC    12 18 C       CMC    12 11 C       CMC    12  8 C       CMC    12  5 C       
CMC     7 18 C       CMC     6  5 C       CMC     5 19 C       CMC     3 33 C       
CMC     2  5 C       CMC     1 37 C       CMC     1 34 C       CMC     1  3 C       
CMCM   17 22 C       CMCM60 19 27 C       CMCM91 18 24 C       CMCMC  19 23 C       
CMCMC  19  9 C       CMCMC   6 17 C       CMCMC   5 28 C       CMCMCM 16 23 C       
CMCMCM 15  5 C       CMCMCM  7 25 C       CMCMCM  5 37 C       [MCMCM  5 15 C       
]MPLEM  3 26 C       
CIRCAC ** FICHE/FRAME BREAK *****
ACAA
AAA    IDENT   12/18/68
ZERO   DATA    0B
XMP    OPD     14000000B,1,1
XSD    OPD     10000000B,1,1
FSD    OPD     10100000B,1,1
STD    OPD     10700000B,1,1
LDP    OPD     12500000B,1,1
FLA    OPD     13100000B,1,1
ONE    DATA    1B
$AA    ZRO     LAA
       SBRM*   201B
       XSD     ADR
       XSD     ADC
       FSD     ADV
       SBRM*   202B
       LDA*    ADC
       STA     TMP2
       LDA*    ADR
       SBRM    FIND
       LDA     TMPA
       SKG     ZERO
       BRU     *+5                 NOT FOUND
       LDP*    ADV
       FLA*    TMPA
       STD*    TMPA
       BRR     LAA
       LDA*    ADC
       LDB*    ADR
       SBRM    SETUP
       ADD     =2              NEW - TO 0 OTHER PART OF TERM
       STA     TMP2
       CLAB
       STD*    TMP2            END OF 4 NEW STATEMEJTS
       LDP*    ADV
       STD*    TMPA
       BRR     LAA
LAA    ZRO
ADR    BSS     2
ADC    BSS     2
ADV    BSS     2
       PAGE
$CA    ZRO     LCA
       SBRM*   201B
       XSD     ADR
       FSD     ADV
       SBRM*   202B
       CLAB
       LDA*    ADR
       SUB     ONE
       XMP     =4
       ADD     CNVT
       STA     TMPA
       LDP*    ADV
       FLA*    TMPA
       STD*    TMPA
       BRR     LCA
LCA    ZRO
       PAGE
$AS    ZRO     LAS
       SBRM    AA
       LDP*    ADV
       STD*    TMPA
       BRR     LAS
LAS    ZRO
$CS    ZRO     LCS
       SBRM    CA
       LDP*    ADV
       STD*    TMPA
       BRR     LCS
LCS    ZRO
$BA    ZRO     LBA
       SBRM*   201B
       XSD     ADR
       XSD     ADC
       FSD     ADV
       SBRM*   202B
       LDA*    ADC
       STA     TMP2
       LDA*    ADR
       SBRM    FIND
       LDA     TMPA
       SKG     ZERO
       BRU     *+7                 NOT FOUND
       ADD     =2
       STA     TMPA
       LDP*    ADV
       FLA*    TMPA
       STD*    TMPA
       BRR     LBA
       LDA*    ADC
       LDB*    ADR
       SBRM    SETUP
       ADD     =2
       STA     TMP2
       LDP*    ADV
       STD*    TMP2
       CLAB
       STD*    TMPA            THESE 2 COMMANDS 0 OTHER PART
       BRR     LBA
LBA    ZRO
       PAGE
$DA    ZRO     LDA
       SBRM*   201B
       XSD     ADR
       FSD     ADV
       SBRM*   202B
       CLAB
       LDA*    ADR
       SUB     ONE
       XMP     =4
       ADD     CNVT
       ADD     =2
       STA     TMPA
       LDP*    ADV
       FLA*    TMPA
       STD*    TMPA
       BRR     LDA
LDA    ZRO
       PAGE
$BS    ZRO     LBS
       SBRM    BA
       LDP*    ADV
       STD*    TMP2
       BRR     LBS
LBS    ZRO
$DS    ZRO     LDS
       SBRM    DA
       LDP*    ADV
       STD*    TMPA
       BRR     LDS
LDS    ZRO
       END
CIRCAC ** FICHE/FRAME BREAK *****
ACBUILD
FOS
ACGOSPB
ACLIB
;WCIRCACSPECIAL

;QFOS
ACGOB
ACLIB
;WCIRCAC

;QFOS
ACL11B
ACESCB
ACL12B
ACL13B
ACDMOB
ACSVMB
ACSOB
ACOPB
ACMSGB
ACDMSB
ACAAB
ACEQTB
ACPOPB
ACLIB
;LACNM

;QFOS
ACL21B
ACESCB
ACL22B
ACSOB
ACLIB
;LACUC

;QFOS
ACLDIB
ACESCB
ACDTSB
ACMSGB
ACLIB
;LACDI

;QFOS
ACLIDB
ACESCB
ACLIB
;LACID

;QDEL ACGOB ACGOSPB
COM TEL
CIRCAC ** FICHE/FRAME BREAK *****
ACCOMP
FTC
IACGO
OACGOB

C
Q
FTC
IACGOSP
OACGOSPB

C
Q
FTC
IACDMO
OACDMOB

C
Q
FTC
IACOP
OACOPB

C
Q
FTC
IACMSG
OACMSGB

C
Q
FTC
IACSO
OACSOB

C
Q
FTC
IACSVM
OACSVMB

C
Q
FTC
IACL22
OACL22B

C
Q
FTC
IACL11
OACL11B

C
Q
FTC
IACL12
OACL12B

C
Q
FTC
IACL21
OACL21B

C
Q
FTC
IACLID
OACLIDB

C
Q
FTC
IACLDI
OACLDIB

C
Q
ARPAS
ACDTS
ACDTSB


ARPAS
ACDMS
ACDMSB


ARPAS
ACAA
ACAAB


ARPAS
ACEQT
ACEQTB


ARPAS
ACPOP
ACPOPB


ARPAS
ACESC
ACESCB


COM TEL
CIRCAC ** FICHE/FRAME BREAK *****
ACDMO
C      DUMMY MODELN
       SUBROUTINE MODELN
       RETURN
       END
CIRCAC ** FICHE/FRAME BREAK *****
ACGO
       DIMENSION NAME(4)
       CALL CL10
       NAME(1)=3H(@6
       NAME(2)=3HLA)
       NAME(3)=3HACN
       NAME(4)=1HM
       NUM=10
       CALL LINK(NUM,NAME)
       END
CIRCAC ** FICHE/FRAME BREAK *****
ACGOSP
       OPEN(10,INPUT,$ACSP$)
       CALL EXIT
       END
CIRCAC ** FICHE/FRAME BREAK *****
ACHIC
$

HELP           REPRINTS THIS LIST
CAPABILITIES   DESCRIBES PROGRAM CAPABILITIES
INSTRUCTIONS   HOW TO EXECUTE THE PROGRAM
CREDITS        IMPLEMENTED BY TYMSHARE
CHARGES        NO ADDITIONAL CHARGES
VERSION        LATEST UPDATE
QUIT (OR) Q    QUITS TO EXEC

               CIRC AC COMMANDS

EXIT (OR RUN)  EXIT FROM USER CONTROL

PODL           PRINTED OUTPUT TO BE DELETED
PODB           PRINT OUTPUT IN DECIBELS AND PHASE
POAP           PRINT OUTPUT IN AMPLITUDE AND PHASE

READ (OR FILE) INPUT DATA IS TO COME FROM A FILE...READS A FILE
               CREATED WITH THE WRITE COMMAND
WRITE          WRITES INPUT DATA TO A FILE
OUTPUT         OUTPUT DATA WRITTEN ON A SYMBOLIC FILE

GODI           GO DO DATA INPUT
GONM           GO DO NOMINAL SOLUTIONS
GOOL           GO DO OPEN LOOP SOLUTIONS

FREQ           PROVIDE FREQUENCY INFORMATION
PPPR           PRINT PRESENT PARAMETER
CPPR           CHANGE PRESENT PARAMETER

PCON           PRINT ELEMENT CONNECTION DATA
CCON           CHANGE THE CONNECTION OF ANY OR ALL ELEMENTS
NODE           CHANGE NUMBER OF NODES

INNT           INPUT NODE TABLE
TBLN           ACTIVATE OR DEACTIVATE NODE TABLE
INDT           INPUT A DEPENDENT UNKNOWN CONTROL TABLE
TBLD           ACTIVATE OR DEACTIVATE DEPENDENT UNKNOWN TABLE

REPR           REPRINT SOLUTIONS

ANY OF THE ABOVE COMMANDS MAY BE SHORTENED TO THE FIRST 3 CHARACTERS

$

1)     ABILITY TO ANALIZE CIRCUITS OF OVER 50 NODES AND 100 
       COMPONENTS.
2)     CONVERSATIONAL, SO THAT THE USER DIRECTS PROGRAM CONTROL
       IN A QUESTION-ANSWER INTERFACE.
3)     SELECTIVE OUTPUT OF ANY NODE VOLTAGE OR COMPONENT CURRENT
       OR POWER.
4)     CIRCUIT TOPOLOGY AND/OR COMPONENT VALUES MAY BE EASILY
       MODIFIED FROM WITHIN THE PROGRAM.
5)     TRANSISTORS ARE SIMPLY DESCRIBED TO THE PROGRAM THROUGH
       THE USE OF 'DATA SHEET PARAMETERS'.
6)     SPECIAL 'NON-MODEL' COMPONENTS SUCH AS TEMPERATURE
       SENSITIVE RESISTORS MAY BE IMPLEMENTED WITH THE USE OF CIRC'S
       USER DEFINED SUBROUTINE FEATURE.
7)     SIX TYPES OF COMPONENTS ARE DIRECTLY AVAILABLE IN CIRCAC:
               A) RESISTORS
               B) INDUCTORS
               C) CAPACITORS
               D) TRANSISTORS
               E) CURRENT ADMITTANCE SOURCES (FIXED OR CONTROLLED)
               F) VOLTAGE IMPEDANCE SOURCES (FIXED OR CONTROLLED)

NOTE:  THE DIODE IS NOT A LEGAL COMPONENT WITHIN CIRCAC
       BECAUSE THIS IS A SMALL SIGNAL ANALYSIS AND ALL VOLTAGES
       AND CURRENTS ARE ASSUMED TO BE SINUSOIDAL.

8)     OPEN LOOP ANALYSIS IS AUTOMATICALLY PERFORMED.
9)     AUTOMATIC FREQUENCY SWEEP IN LOG. OR LINEAR INCREMENTS.
10)    SOLUTION OUTPUT OPTIONS:
               A) NODE VOLTAGES AND CURRENTS IN AMPLITUDE AND PHASE.
               B) NODE VOLTAGES AND CURRENTS IN DB. AND PHASE.
               C) OPEN LOOP OUTPUT IN AMPLITUDE, PHASE, DB, AND
                  LOAD IMPEDANCE (REAL AND IMAG.).
$

SEE THE MANUAL FOR INSTRUCTIONS.
$
 NTROLLED)
               F) VOLTAGE IMPEDANCE SOURCES (FIXED OR CONTROLLED)

NOTE:  THE DIODE IS NOT A LEGAL COMPONENT WITHIN CIRCAC
       BECAUSE THIS IS A SMALL SIGNAL ANALYSIS AND ALL VOLTAGES
       AND CURRENTS ARE ASSUMED TO BE SINUSOIDAL.

8)     OPEN LOOP ANALYSIS IS AUTOMATICALLY PERFORMED.
9)     AUTOMATIC FREQUENCY SWEEP IN LOG. OR LINEAR INCREMENTS.
10)    SOLUTION OUTPUT OPTIONS:
               A) NODE VOLTAGES AND CURRENTS IN AMPLITUDE AND PHASE.
               B) NODE VOLTAGES AND CURRENTS IN DB. AND PHASE.
               C) OPEN LOOP OUTPUT IN AMPLITUDE, PHASE, DB, AND
                  LOAD IMPEDANCE (REAL AND IMAG.).
$

SEE THE MANUAL FOR INSTRUCTIONS.
$
CIRCAC ** FICHE/FRAME BREAK *****
ACLDI
C      /ACLDI/-/BACLDI/ PART OF /ACDI/
C        MPDAIN
C
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1),MOLLET(4)
      COMMON JAB,FAB,J,F
      CONTINUE
      DIMENSION LTBLN(15),LTBLD(35)
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
C
       EQUIVALENCE (JAB(181),KCC1),(JAB(182),KCC2)
       EQUIVALENCE (JAB(151),KDBAP )
      EQUIVALENCE (JAB(201),LTBLN( 1)),(JAB(216),LTBLD( 1))
      EQUIVALENCE (JAB(179),KTBLN),(JAB(178),KTBLD) ,(JAB(177),NTBLN)
     1,(JAB(176),NTBLD)
      EQUIVALENCE (JAB(175),IOVM ) ,(JAB(174),IPOVM)
      EQUIVALENCE (JAB(172),KDLUK),(JAB(171),KDLIN)
C
      EQUIVALENCE (JAB( 20),JABZ),(JAB( 21),NFAB),(JAB( 22),INXI)
     1,(JAB( 23),ISDL),(JAB( 24),NPAR),(JAB( 25),NSTM),(JAB( 26),NCOM)
      EQUIVALENCE (JAB( 27),INXIBU),(JAB( 28),KPOUT) ,(JAB( 29),NNPT )
C
      EQUIVALENCE (JAB(276),NSEQ),(JAB(199),NSDE),(JAB(198),NUNK)
     1,(JAB(197),NDEQ),(JAB(196),NMDE)          ,(JAB(200),NSEQO)
      EQUIVALENCE (JAB(193),KNTGO),(JAB(192),KOPLP) ,(JAB(191),KOLPR)
      EQUIVALENCE (JAB(190),LVR ),(JAB(189),LVI ),(JAB(188),LVA )
     1,(JAB(187),LVP )
      EQUIVALENCE (JAB(186),LDER),(JAB(185),LDEI )
      EQUIVALENCE (JAB(184),LSDER),(JAB(183),LSDEI )
      EQUIVALENCE (JAB(160),MSUP),(JAB(163),LSUPM),(JAB(166),NSUP)
      EQUIVALENCE (JAB(159),LSUPP)
      EQUIVALENCE (JAB(161),MNMP),(JAB(164),LNMP),(JAB(167),NNMP)
      EQUIVALENCE (JAB(162),MTMPAJ),(JAB(165),LTMPAJ),(JAB(168),NTMPAJ)
C
      EQUIVALENCE (JAB(  1),JAB1),(JAB(  2),JAB2),(JAB(  3),JAB3)
     1,(JAB(  4),JAB4),(JAB(  5),JAB5),(JAB(  6),JAB6),(JAB(  7),JAB7)
      EQUIVALENCE (FAB( 13),FREQ),(FAB( 17),W  ),(FAB( 18),TP    )
      EQUIVALENCE (FAB( 14),SFREQ),(FAB( 15),EFREQ),(FAB( 16),DELF  )
      EQUIVALENCE (FAB( 19),FREQK)
C
C
C  .........          ..........          ..........          ..........
C
       IPAM=-1
       CALL ESCAPE
       IF(IPAM) 6969
       NART=10
       MOLLET(1)=3H(@6
       MOLLET(2)=3HLA)
       MOLLET(3)=3HACU
       MOLLET(4)=1HC
       CALL LINK(NART,MOLLET)
6969   IPAM=+1
C  .........          ..........          ..........          ..........
      JABZ = 276
      NFAB = 35
      NSTM = 6
      MSUP = 2
      MNMP = 1
      MTMPAJ = 1
C  .........          ..........          ..........          ..........
      IF(KSKP+4001782) 300,301,300
300   KSKP = -4001782
C
       TP=6.2831853072
301   CONTINUE
      WRITE K94PO,2002
C  .........          ..........          ..........          ..........
C
C     WILL ASSURE SET UP OF ALL NAMES ETC
      DO 3 N=1,NSTM
                        JAB(59+N)=3HNLD
3     JAB(79+N)=1
       KDBPA = 0
      NPAR = 0
      NNPT = 0
      KOLPR = 0
      KOPLP = 0
      IOVM = 1
      IPOVM = 1
      KTBLN = 1
      KTBLD = 1
      KPOUT = 2
      CALL EQINO (1,1)
      CALL INPUT (5,0,0,0)
      WRITE K94PO,10
      CALL INPUT (1,1,0,0)
      NSEQ =JAB(1)
       NSEQO=NSEQ
      WRITE K94PO,14
       CALL INPUT (1,1,0,0)
      NSUP =JAB(1)
      WRITE K94PO,15
       READ K94IO,7059,JAB(1)
7059   FORMAT(1A1/)
       IF(K94IO) 7058,7058
       WRITE K94PO,7059,JAB(1)
7058   WRITE K94FO,7059,JAB(1)
      NSDE=0
      NNMP=0
      IF(JAB(1)-1HY    ) 7,8,7
8     WRITE K94PO,17
      CALL INPUT (1,1,0,0)
       KCC1=2
      NSDE =JAB(1)
      WRITE K94PO,18
      CALL INPUT (1,1,0,0)
      NNMP =JAB(1)
7     CONTINUE
      WRITE K94PO,19,(JAB(59+L),L=1,NSTM)
      CALL INPUT (1,NSTM,0,0)
      DO 33 N=1,NSTM
33    JAB(79+N) =JAB(N)
      CALL MEMS1 (1)
      NCOMT = 12 + JABZ + 2*NFAB - INXI *2
       KNT = 0
      CALL DATTST (NSEQ,NCOMT,KNT,IARG1,IARG2,FARG1)
       IF(KNT) 1223,1223,1224
1224   CALL MSGERR  (KNT,IARG1,IARG2,FARG1,FARG2)
1223   CONTINUE
      IF(NSUP) 35,35,36
36    WRITE K94PO,20
      WRITE K94PO,130
      NAME =3HSUP
      DO 38 N=1,NSUP
      CALL INPUT (6,5,N,     NAME)
      CALL CONPER (4,N,MSUP,LSUPM)
38    CONTINUE
35    CONTINUE
      IF(NNMP)  52,52,51
51    WRITE K94PO,22
      WRITE K94PO,21
      NAME =3HNMP
      DO 50 N=1,NNMP
      CALL INPUT (4,5,N,     NAME)
      CALL CONPER (3,N,MNMP,LNMP )
50    CONTINUE
52    CONTINUE
      WRITE K94PO,23
      WRITE K94PO,21
      NAME =3HTMP
      CALL INPUT (4,5,1,     NAME)
      CALL CONPER (3,1,MTMPAJ,LTMPAJ)
      CALL EQINO(2,2)
      WRITE K94PO,2002
      CALL MEMS1 (2)
      CALL MEMS2
       KNT = 0
      CALL DAMTST (KNT,IARG1,IARG2,FARG1)
       IF(KNT) 1233,1233,1234
1234   CALL MSGERR  (KNT,IARG1,IARG2,FARG1,FARG2)
1233   CONTINUE
       CALL INPUT (9,1,0,0)
72800  CONTINUE
72801  IF(KCC1) 72802,72802,72803
72802  NART=6
       MOLLET(1)=3H/AC
       MOLLET(2)=3HNM/
       CALL LINK(NART,MOLLET)
72803  GO TO (72811,72812,72813,72814    ),KCC1
72811   NART=10
       MOLLET(1)=3H(@6
       MOLLET(2)=3HLA)
       MOLLET(3)=3HACN
       MOLLET(4)=1HM
       CALL LINK(NART,MOLLET)
72812  GO TO 72802
72813  CONTINUE
72814  CONTINUE
       STOP
C      TO RETURN BY LOAD OF EX CH AIN.
C
C
10    FORMAT(/,1X,$NUMBER OF NODES$/)
14    FORMAT(/,1X,$NUMBER OF VOLTAGE SUPPLIES$/)
15    FORMAT (/,1X,$ARE SPECIAL EQS USED$/)
17    FORMAT (/,1X,$NUMBER OF SPECIAL DEPENDENT EQS$/)
18    FORMAT (/,1X,$NUMBER OF NON-MODEL PARAMETERS$/)
19    FORMAT (//,1X,$SPECIFY THE QUANTITY OF THE FOLLOWING CIRC STND $,$
     1ELEMENTS THAT ARE USED$/1X, 6(A4,$,$)/)
20    FORMAT(//,1X,$VOLTAGE SUPPLIES$/)
21    FORMAT (1X,$SPECIFY THE FOLLOWING,$/,1X,$NOM VAL (FOR ALL PARAMETE
     1RS INDICATED)$/)
130   FORMAT (1X,$SPECIFY THE FOLLOWING,$/,1X,$NOM VAL(MAGNITUDE,ANGLE)
     1(FOR ALL PARAMETERS INDICATED)$/)
22    FORMAT (//,1X,$NON-MODEL PARAMETERS$/)
23    FORMAT (//,1X,$JUNCTION TEMPERATURE  (DEG. CENT.)$/)
100   FORMAT (4HPOTY,/,4HPAZ1,/)
2002  FORMAT (/////)
      END
C        CONPER
C
C   SUB. TO PROCESS CONNECTION DATA  AND TO GIVE PERCENT CAPABILITY
C
      SUBROUTINE CONPER (KNT,N,IGRZ,IPTR)
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
C
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
       EQUIVALENCE (JAB(151),KDBAP )
      EQUIVALENCE (JAB(200),NSEQO)
      EQUIVALENCE (JAB(  1),JAB1),(JAB(  2),JAB2),(JAB(  3),JAB3)
     1,(JAB(  4),JAB4),(JAB(  5),JAB5),(JAB(  6),JAB6),(JAB(  7),JAB7)
     2,(JAB(  8),JAB8),(JAB(  9),JAB9),(JAB(10),JAB10),(JAB(11),JAB11)
      EQUIVALENCE (FAB(  1),FAB1),(FAB(  2),FAB2),(FAB(  3),FAB3)
     1,(FAB(  4),FAB4),(FAB(  5),FAB5),(FAB(  6),FAB6),(FAB(  7),FAB7)
     2,(FAB(  8),FAB8),(FAB(  9),FAB9),(FAB(10),FAB10),(FAB(11),FAB11)
C  .........          ..........          ..........          ..........
      NN =IPTR -N*IGRZ
      GO TO (1,2,3,4,5,6,1     )KNT
C   SOME OF THES TRANSFERS COULD BE REMOVED
C    WRITE CONNECTION ENTRY DIRECTIONS
1     WRITE K94PO,100
      GO TO (11,12,13,14,15,16)  N
11    WRITE K94PO,101
      GO TO 22
12    WRITE K94PO,307
      GO TO 22
13    WRITE K94PO,308
      GO TO 22
14    WRITE K94PO,104
      GO TO 22
15    WRITE K94PO,108
       GO TO 22
16     WRITE K94PO,107
22    IF(KNT-7) 23,21,21
23    WRITE K94PO,102
21    RETURN
2     IF(JAB 2 +JAB 4 ) 31,31,32
31    J(NN) = 4
      GO TO 47
32    IF(JAB 2 ) 41,41,42
41    J(NN  ) = 3
      GO TO 47
42    IF(JAB 4 ) 43,43,44
43    J(NN  ) = 2
      GO TO 47
44    IF(JAB1-1HS   ) 35,41,35
35    IF(JAB3-1HS   ) 46,43,46
46    J(NN  ) = 1
47    J(NN  -1) = JAB 2
      J(NN  -2) = JAB 4
C   CONTROL INFO. REMOVED FROM MODEL INPUT-STORAGE LEFT
C     J(NN  -3) = JAB 6          CONTROL INFO. REMOVED
48    RETURN
3      CONTINUE
30     F(NN)=FAB1
       RETURN
5      J(NN-3)=JAB5
       J(NN-4)=JAB6
       J(NN-5)=JAB7
       GO TO 2
4      CONTINUE
       F(NN)=FAB1
       F(NN-1)=FAB2
       RETURN
6     IF(JAB 2 +JAB 4 +JAB 6 ) 63,63,64
63    J(NN) = 5
      GO TO 60
64    IF(JAB 6 ) 51,51,52
51    J(NN  ) = 2
      GO TO 60
52    IF(JAB 4 ) 53,53,54
53    J(NN  ) = 3
      GO TO 60
54    IF(JAB 2 ) 55,55,56
55    J(NN  ) = 4
      GO TO 60
56    IF(JAB5-1HS    ) 68,51,68
68    IF(JAB3-1HS    ) 62,53,62
62    IF(JAB1-1HS    ) 59,55,59
59    J(NN  ) = 1
60    J(NN -1) = JAB 2
      J(NN -2) = JAB 4
      J(NN -3) = JAB 6
C INTERNAL NODE IS STORED IN J(NN-4)  IT IS SET IN SOLVE
      J(NN -5) = JAB9
      RETURN
C
C
100   FORMAT   (/,1X,$SPECIFY THE FOLLOWING,$/)
101   FORMAT (1X,$R TERM 1 INFO,R TERM 2 INFO,$/)
307   FORMAT (1X,$L TERM 1 INFO,L TERM 2 INFO,$/)
308   FORMAT (1X,$C TERM 1 INFO,C TERM 2 INFO,$/)
102   FORMAT (1X,$NOM VAL (FOR ALL PARAMETERS INDICATED)$/)
104   FORMAT(1X,$BASE INFO,COLL. INFO,EMIT. INFO,COPY DATA INFO,A IF FAC
     1O$/)
107   FORMAT (1X,$POS TERM INFO,NEG TERM INFO,$
     1$ELEMENT INFO,V OR I CONTROL$/)
108   FORMAT (1X,$EXIT NODE INFO,RECV NODE INFO,$
     1$ELEMENT INFO,V OR I CONTROL$/)
302   FORMAT   (1X,A3,I3,$ = PARAMETERS$,I4,$ AND$,I4/)
      END
C
C   SPECIAL EQ JUST FOR LOADING---NOT LOADING NOT ALLOWED
C
       SUBROUTINE EQINO (KNT,KNT2)
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
       CONTINUE
       EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
       EQUIVALENCE (JAB(275),KINERR),(JAB( 25),NSTM)
C
C
C      INITIALIZATION OF CONCHK AND KINERR(OR) FOR LATER USE
C      KINERR=0 MEANS THAT AN ERROR HAS BEEN FOUNG OR DATA INPUT
C      HAS NEVER TAKEN PLACE. IT IS SET TO ONE HERE AND THE
C      SUBROUTINIE CONCHK CAN SET IT BACK TO ZERO FOR AN ERROR.
       KINERR=1
       NAME=3HCLR
       CALL CONCHK(0,0,0,NAME)
       DO 2 N=1,NSTM
       IF(JAB(79+N)) 2,2,7
7      CALL MODELN(N,KNT)
2      CONTINUE
C
C
C      CHECK FOR NO CONNECTIONS TO ANY OF THE NODES
C
       NAME=3HCHK
       IF(KNT-2) 1002,1003,1002
1003   CALL CONCHK (0,0,0,NAME)
1002   IF(KINERR) 1000,1000,1001
1000   PRINT 13
13     FORMAT(////4X,$ERRORS IN DATA INPUT SHOULD BE CHANGED ! ! !$///)
1001   RETURN
       END
C        MEMS2
C
C  A SUB. TO SET UP MEMORY - PART 2
C
      SUBROUTINE MEMS2
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
       EQUIVALENCE (JAB(151),KDBAP )
      EQUIVALENCE (JAB( 20),JABZ),(JAB( 21),NFAB),(JAB( 22),INXI)
     1,(JAB( 23),ISDL),(JAB( 24),NPAR),(JAB( 25),NSTM),(JAB( 26),NCOM)
      EQUIVALENCE (JAB( 27),INXIBU),(JAB( 28),KPOUT) ,(JAB( 29),NNPT )
C
      EQUIVALENCE (JAB(276),NSEQ),(JAB(199),NSDE),(JAB(198),NUNK)
     1,(JAB(197),NDEQ),(JAB(196),NMDE)
C  .........          ..........          ..........          ..........
      NUNK = NSEQ + NSDE + NMDE
      INXI = INXIBU
      DO 80 N=1,4
      ITSI = INXI + 1
      INXI = ITSI - 1 - NUNK
80    JAB(191 -N) = ITSI
      INXI = 2 * INXI -14
C  DELETED WITH A COMMENT      IPRT = INXI + MPRT
C        INXI = IPRT - MPRT -MPRT * NUNK
      NCOM = 12 + JABZ + 2*NFAB -   INXI
      RETURN
      END
C        MODELN
C
      SUBROUTINE MODELN (KNTM,KNTT)
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
       EQUIVALENCE (JAB(151),KDBAP )
      EQUIVALENCE (JAB( 20),JABZ),(JAB( 21),NFAB),(JAB( 22),INXI)
     1,(JAB( 23),ISDL),(JAB( 24),NPAR),(JAB( 25),NSTM),(JAB( 26),NCOM)
      EQUIVALENCE (JAB( 30),MRES),(JAB( 40),KRES),(JAB( 50),NDQRES)
     1,(JAB( 60),NAMRES),(JAB( 70),MNPRES),(JAB( 80),NRES)
     2,(JAB( 90),IRES),(JAB(100),LRES),(JAB(110),JRES)
      EQUIVALENCE (JAB( 31),MIND),(JAB( 41),KIND),(JAB( 51),NDQIND)
     1,(JAB( 61),NAMIND),(JAB( 71),MNPIND),(JAB( 81),NIND)
     2,(JAB( 91),IIND),(JAB(101),LIND),(JAB(111),JIND)
      EQUIVALENCE (JAB( 32),MCAP),(JAB( 42),KCAP),(JAB( 52),NDQCAP)
     1,(JAB( 62),NAMCAP),(JAB( 72),MNPCAP),(JAB( 82),NCAP)
     2,(JAB( 92),ICAP),(JAB(102),LCAP),(JAB(112),JCAP)
      EQUIVALENCE (JAB( 35),MVZS),(JAB( 45),KVZS),(JAB( 55),NDQVZS)
     1,(JAB( 65),NAMVZS),(JAB( 75),MNPVZS),(JAB( 85),NVZS)
     2,(JAB( 95),IVZS),(JAB(105),LVTR),(JAB(115),JVZS),(JAB(150),LVTI)
      EQUIVALENCE (JAB(149),LZR ),(JAB(148),LZI )
      EQUIVALENCE (JAB( 34),MCYS),(JAB( 44),KCYS),(JAB( 54),NDQCYS)
     1,(JAB( 64),NAMCYS),(JAB( 74),MNPCYS),(JAB( 84),NCYS)
     2,(JAB( 94),ICYS),(JAB(104),LCTR),(JAB(114),JCYS)
      EQUIVALENCE (JAB(147),LCTI),(JAB(146),LYR ),(JAB(145),LYI  )
      EQUIVALENCE (JAB( 33),MXIS),(JAB( 43),KXIS),(JAB( 53),NDQXIS)
     1,(JAB( 63),NAMXIS),(JAB( 73),MNPXIS),(JAB( 83),NXIS)
     2,(JAB( 93),IXIS),(JAB(103),LIE ),(JAB(113),JXIS)
     3,(JAB(142),LBLF ),(JAB(141),LEPH )
      EQUIVALENCE (JAB(140),LFCO ),(JAB(139),LRB ),(JAB(138),LCTE)
     1,(JAB(137),LCC  ),(JAB(136),LRC  )
C
C  .........          ..........          ..........          ..........
      GO TO (1,2 )   KNTT
1     GO TO (101,201,301,401,501,601) KNTM
101   MRES = 1
      KRES = 4
      NDQRES = 1
      NAMRES = 3HRES
      MNPRES = 0
      GO TO 999
201   MIND = 1
      KIND = 4
      NDQIND = 1
      NAMIND = 3HIND
      MNPIND = 0
      GO TO 999
301   MCAP = 1
      KCAP = 4
      NDQCAP = 1
      NAMCAP = 3HCAP
      MNPCAP = 0
      GO TO 999
601   MVZS = 4
      KVZS = 6
       NDQVZS = 0
      NAMVZS = 3HVZS
      MNPVZS = 0
      GO TO 999
501   MCYS = 4
      KCYS = 6
      NDQCYS =0
      NAMCYS =3HCYS
      MNPCYS = 0
      GO TO 999
401   MXIS = 8
      KXIS = 6
      NDQXIS = 3
      NAMXIS =3HTRN
      MNPXIS = 0
      GO TO 999
2     GO TO (102,202,302,402,502,602) KNTM
102   WRITE K94PO,1001
      CALL CONPER (1,1,0,0)
      DO 11 N=1,NRES
      CALL INPUT (2,4,  N,NAMRES)
      CALL CONCHK(2,4,  N,NAMRES)
      CALL CONPER (2,N,KRES,IRES)
      CALL INPUT (4,5,  N,NAMRES)
11    CALL CONPER (3,N,MRES,LRES)
      GO TO 999
202   WRITE K94PO,1002
      CALL CONPER (1,2,0,0)
      DO 21 N=1,NIND
      CALL INPUT (2,4,  N,NAMIND)
      CALL CONCHK(2,4,  N,NAMIND)
      CALL CONPER (2,N,KIND,IIND)
      CALL INPUT (4,5,  N,NAMIND)
21    CALL CONPER (3,N,MIND,LIND)
      GO TO 999
302   WRITE K94PO,1003
      CALL CONPER (1,3,0,0)
      DO 31 N=1,NCAP
      CALL INPUT (2,4,  N,NAMCAP)
      CALL CONCHK(2,4,  N,NAMCAP)
      CALL CONPER (2,N,KCAP,ICAP)
      CALL INPUT (4,5,  N,NAMCAP)
31    CALL CONPER (3,N,MCAP,LCAP)
      GO TO 999
602   WRITE K94PO,1006
      CALL CONPER(1,6,0,0)
      LVTI =LVTR -1
      LZR= LVTR-2
      LZI=LVTR-3
      DO 12 N=1,NVZS
      CALL INPUT (2,7,N,NAMVZS)
      CALL CONCHK(2,4,N,NAMVZS)
      CALL CONPER (5,N,KVZS,IVZS)
      NAME =3HVTR
       JAB(1)=3HVTI
      CALL INPUT (8,5,N,NAME)
      CALL CONPER(4,N,MVZS,LVTR        )
22    NAME =3HZR
       JAB(1)=3HZI
      CALL INPUT (8,5,N,NAME)
      CALL CONPER(4,N,MVZS,LZR       )
12    CONTINUE
      GO TO 999
502   WRITE K94PO,1005
      CALL CONPER (1,5,0,0)
      LCTI =LCTR -1
      LYR= LCTR-2
      LYI=LCTR-3
      DO 13 N=1,NCYS
      CALL INPUT (2,7,N,NAMCYS)
      CALL CONCHK(2,4,N,NAMCYS)
      CALL CONPER (5,N,KCYS,ICYS)
      NAME =3HCTR
       JAB(1)=3HCTI
      CALL INPUT (8,5,N,NAME)
      CALL CONPER(4,N,MCYS,LCTR        )
      NAME =3HYR
       JAB(1)=3HYI
      CALL INPUT (8,5,N,NAME)
      CALL CONPER(4,N,MCYS,LYR       )
13    CONTINUE
      GO TO 999
402   WRITE K94PO,1004
      CALL CONPER (1,4,0,0)
      DIMENSION NAMQPR(9)
      NAMQPR(1) = 3HIE
      NAMQPR(2) = 3HBLF
      NAMQPR(3) = 3HEPH
      NAMQPR(4) = 3HFTB
      NAMQPR(5) = 3HRB
      NAMQPR(6) = 3HCTE
      NAMQPR(7) = 3HCC
      NAMQPR(8) = 3HRC
      NAMQPR(9) = 3HFA
      LBLF  =LIE -1
      LEPH  =LIE -2
      LFCO  =LIE -3
      LRB   =LIE -4
      LCTE  =LIE -5
      LCC   =LIE -6
      LRC   =LIE -7
      DO 15 N =1,NXIS
      CALL INPUT (2, 9,N,NAMXIS)
      CALL CONCHK(3,6,N,NAMXIS)
      NORPT =JAB( 8)
      CALL CONPER (6,N,KXIS,IXIS)
      IF (NORPT) 1831,1831,1832
1831   DO 8 NN=1,MXIS-2
       IF(NN-2) 836,837,836
837    NN=3
       ASSIGN 8 TO KAGT
       GO TO 838
836    IF(NN-4) 900,901,900
900    NNN=NN
       GO TO 902
C TEST ALPHA CONTROL
901    IF(    J(IXIS-N*KXIS-5) -1HA) 900,981,900
981    NNN=9
902   CALL INPUT (4,5,N   ,NAMQPR(NNN))
      CALL CONPER(3,N,MXIS,LIE+(1-NN))
8      CONTINUE
       GO TO 840
838    JAB(1)=NAMQPR(NN)
       CALL INPUT (8,5,N,NAMQPR(NN-1))
       CALL CONPER (4,N,MXIS,LIE+(2-NN))
       GO TO KAGT
840    NN=8
       ASSIGN 839 TO KAGT
       GO TO 838
839    CONTINUE
       GO TO 875
1832   CALL INPUT (4,5,N,NAMQPR(1))
       CALL CONPER (3,N,MXIS,LIE)
      DO 16 NNN =2,MXIS
      ITM1  =  LIE +(1-NNN)
16    F(ITM1-N*MXIS) =F(ITM1-NORPT*MXIS)
      WRITE K94PO,1102,NORPT
      DO 20 K=2,MXIS
      NPAR =NPAR+1
C  SET ALPHA CONTROL TO BE PROPER
       NRPTAK=J(IXIS-NORPT*KXIS-5)
       IF(NRPTAK-1HA   ) 930,931,930
931    NNM=9
      J(IXIS-N*KXIS-5) =1HA
       GO TO 933
930    NNM=K
933    CONTINUE
20    WRITE K94PO,1103,NAMQPR(NNM),NPAR
C
C
1102  FORMAT(//,4X,$DATA FROM DEVICE$,I3,$ HAS BEEN USED FOR THIS DEVICE
     1$,/,4X,$PARAMETER ASSIGNMENTS ARE AS FOLLOWS$/)
1103  FORMAT(4X,A4,$ = PAR. NO. $,I3/)
875    CONTINUE
15    CONTINUE
999   RETURN
C
C
1001  FORMAT (//,1X,$RESISTORS$/)
1006  FORMAT (//,1X,$VOLTAGE-IMPEDANCE SOURCES$/)
1005  FORMAT (//,1X,$CURRENT-ADMITTANCE SOURCES$/)
1004  FORMAT (//,1X,$TRANSISTORS$/)
1002  FORMAT (//,1X,$INDUCTORS$/)
1003  FORMAT (//,1X,$CAPACITORS$/)
      END
C        MEMS1
C
      SUBROUTINE MEMS1(KNT)
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
C
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
       EQUIVALENCE (JAB(151),KDBAP )
      EQUIVALENCE (JAB( 20),JABZ),(JAB( 21),NFAB),(JAB( 22),INXI)
     1,(JAB( 23),ISDL),(JAB( 24),NPAR),(JAB( 25),NSTM),(JAB( 26),NCOM)
      EQUIVALENCE (JAB( 27),INXIBU),(JAB( 28),KPOUT) ,(JAB( 29),NNPT )
C
      EQUIVALENCE (JAB(276),NSEQ),(JAB(199),NSDE),(JAB(198),NUNK)
     1,(JAB(197),NDEQ),(JAB(196),NMDE)
      EQUIVALENCE (JAB(193),KNTGO),(JAB(192),KOPLP) ,(JAB(191),KOLPR)
      EQUIVALENCE (JAB(190),LVR ),(JAB(189),LVI ),(JAB(188),LVA )
     1,(JAB(187),LVP )
      EQUIVALENCE (JAB(160),MSUP),(JAB(163),LSUPM),(JAB(166),NSUP)
      EQUIVALENCE (JAB(159),LSUPP)
      EQUIVALENCE (JAB(161),MNMP),(JAB(164),LNMP),(JAB(167),NNMP)
      EQUIVALENCE (JAB(162),MTMPAJ),(JAB(165),LTMPAJ),(JAB(168),NTMPAJ)
C  .........          ..........          ..........          ..........
      GO TO (1,2      ) KNT
1     CONTINUE
      INXI = 0
      DO 10,N=1,NSTM
      NTGR=JAB( 79+N)
      IF(NTGR) 10,10,12
12    IGRZ = JAB(39+N)
22    ITSI=INXI+IGRZ
23    INXI=ITSI - IGRZ * NTGR -IGRZ
10    JAB(89+N) = ITSI
C
C     COMPLETES MODEL DYNAMIC INTERGER STORAGE INDICATOR SET-UP
C
      ISDL=(INXI+1)/2
C
C   SUPPLY ZERO IS ALWAYS SET-UP
C
      LSUPM = ISDL
       LSUPP = LSUPM-1
      INXI = ISDL -MSUP
      DO 25 N=0,MSUP-1
25    F(LSUPM-N) = 0.
      NTMPAJ = 1
      DO 50, N=1,3
C     SUP,NMP,TMP
      NTGR=JAB(165+N)
      IF(NTGR) 50,50,52
52    IGRZ = JAB(159+N)
      ITSI = INXI +IGRZ
      INXI = ITSI -IGRZ * NTGR -IGRZ
      JAB(162+N) = ITSI
50    CONTINUE
      DO 30, N=1,NSTM
C     MODEL PARAMETER DATA
      NTGR=JAB( 79+N)
      IF(NTGR) 30,30,32
32    IGRZ = JAB (29+N)
      ITSI = INXI +IGRZ
      INXI = ITSI -IGRZ * NTGR -IGRZ
30    JAB(99+N) = ITSI
C  CONSIDER REMOVING COMPLETELY
      DO 60 N=1,NSTM
C    MODEL *NON-PARAMETER* DATA
      NTGR = JAB (79+N)
      IF(NTGR) 60,60,62
62    IGRZ = JAB(69+N)
      IF(IGRZ) 60,60,63
63    ITSI = INXI + IGRZ
      INXI = ITSI -IGRZ * NTGR - IGRZ
      JAB(119+N) = ITSI
60    CONTINUE
      RETURN
2     CONTINUE
C   POINTERS FOR DEP. EQ.
      NMDE = 0
      IDEK = 0
      DO 70 N = 1,NSTM
      NTGR = JAB(79+N)
      IF (NTGR) 70,70,72
72    IGRZ = JAB(49+N)
      ITSI = IDEK + IGRZ
      IDEK = ITSI -IGRZ*NTGR -IGRZ
      JAB(109+N) = ITSI
      NMDE = NMDE + NTGR*IGRZ
70    CONTINUE
      INXIBU = INXI
      RETURN
      END
C      INPUT AND SOLOUT
C        INPUT
C
C  A SUB. TO TAKE IN DATA FROM UC SPEC. DEVICE AND OUTPUT FILE OF INPUT
C
      SUBROUTINE INPUT (KNT,IGRZ,N,NAME )
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1),ART(35)
      COMMON JAB,FAB,J,F
      CONTINUE
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
       EQUIVALENCE (JAB (151),KDBAP)
      EQUIVALENCE (JAB( 20),JABZ),(JAB( 21),NFAB),(JAB( 22),INXI)
     1,(JAB( 23),ISDL),(JAB( 24),NPAR),(JAB( 25),NSTM),(JAB( 26),NCOM)
      EQUIVALENCE (FAB( 13),FREQ),(FAB( 17),W  ),(FAB( 18),TP    )
      EQUIVALENCE (FAB( 14),SFREQ),(FAB( 15),EFREQ),(FAB( 16),DELF  )
      EQUIVALENCE (FAB( 19),FREQK)
C  .........          ..........          ..........          ..........
C
       ASSIGN 229 TO KAGT
      GO TO (10,10,10,10,20,10,10,10,10) KNT
C      INPUT MEANS SET IN USRKNT ON THE 940 CIRC
C
10    CONTINUE
17    GO TO (30,40,50,60,20,70,67,70,200) KNT
C
20    CONTINUE
29    GO TO KAGT
229   RETURN
C
C  TAKE IN INTEGER DATA        12I4
30    READ K94IO,113 ,(ART(L),L=1,IGRZ),ARTH
       DO 33 L=1,IGRZ
       JAB(L)=ART(L)
33     CONTINUE
      IF(K94IO)32,32,31
31    WRITE K94PO,114,(JAB(L),L=1,IGRZ)
       WRITE K94PO,99
99     FORMAT(/)
32    WRITE K94FO,213,(JAB(L),L=1,IGRZ)
       WRITE K94FO,99
      RETURN
C
C  TAKE IN ALPHA-INTEGER DATA    6(A1,I3)
40    WRITE K94PO,100,NAME,N
C
50    READ K94IO,116 ,(JAB(L),ART(L),L=1,IGRZ,2),ARTH
       DO 53  L=2,IGRZ,2
       JAB(L)=ART(L-1)
53     CONTINUE
      IF(K94IO)52,52,51
51    WRITE K94PO,111,(JAB(L),L=1,IGRZ)
       WRITE K94PO,99
52    WRITE K94FO,216,(JAB(L),L=1,IGRZ)
       WRITE K94FO,99
      GO TO 20
C
C USED TO TAKE IN TWO PAR.S (MAG.,ANG.)
70    NPAR =NPAR+2
       NPARMO=NPAR-1
C  USE JAB(1) TO GET 2ND NAME
       IF(KNT-8) 71,72,72
72     WRITE K94PO,372,NAME,N,JAB(1),N,NPARMO,NPAR
       GO TO 167
71    WRITE K94PO,302,NAME,N,NPARMO,NPAR
167    CONTINUE
       READ K94IO,324,FAB(1),FAB(2)
      IF(K94IO)163,163,162
162   WRITE K94PO,326,FAB(1),FAB(2)
163   WRITE K94FO,325,FAB(1),FAB(2)
       RETURN
C
C  PARAMETER INPUT
60    NPAR =NPAR+1
      WRITE K94PO,102,NAME,N,NPAR
67     CONTINUE
61    READ K94IO,125,FAB(1)
64    IF(K94IO)66,66,65
65    WRITE K94PO,126,FAB(1)
66     IF(FAB(1)-1.0)660,661,661
660    IF(FAB(1)+1.0)661,661,662
661    WRITE K94FO,126,FAB(1)
       GO TO 20
662   WRITE K94FO,126,FAB(1)
       GO TO 20
200   CONTINUE
       WRITE K94PO,135
135    FORMAT (//1X,$FREQ DATA$/1X,$START$/)
       ASSIGN 202 TO KAGT
       GO TO 67
202    SFREQ=FAB(1)
       WRITE K94PO,138
138    FORMAT (1X,$CONTROL(A,M,L)$/)
       ASSIGN 204 TO KAGT
       GO TO 50
204    KFREQ=JAB(1)
       WRITE K94PO,143
143    FORMAT (1X,$INCREMENT$/)
       ASSIGN 206 TO KAGT
       GO TO 67
206    DELF =FAB(1)
       WRITE K94PO,137
137    FORMAT (1X,$END$/)
       ASSIGN 208 TO KAGT
       GO TO 67
208    EFREQ=FAB(1)
       IF(KFREQ-1HL) 140,141,140
141    DELF=(10.)**(1./DELF)
       GO TO 142
140    IF(KFREQ-1HM) 145,142,145
142    FREQK=0.
       GO TO 146
145    FREQK=1.
146    CONTINUE
       RETURN
C
100   FORMAT (/, 1X,A3,I3/)
102   FORMAT   (1X,A3,I3,$ = PARAMETER NUMBER$,I4/)
111   FORMAT (6(A1,I3,5X))
113   FORMAT (12F20.0/)
114   FORMAT (12I5/)
116   FORMAT (6(A1,F20.0)/)
125   FORMAT (F20.0/)
126   FORMAT (1X,E15.8,$,$/)
213    FORMAT(12(I3,$,$))
216    FORMAT(6(A1,I3,$,$))
324    FORMAT (2(F20.0)/)
325   FORMAT (2(E16.8$,$)/)
326   FORMAT (1X,E15.8,2X,E15.8/)
302   FORMAT   (1X,A3,I3,$ = PARAMETERS$,I4,$ AND$,I4/)
372    FORMAT($ ($,A3,I3,$),($,A3,I3,$) = PAR.S $,I4,$ AND$I4/)
        END
C      CONCHK
C      SUBROUTINE THAT CHECKS TO SEE IF EVERY PART IS
C      CONNECTED TO AT LEAST ONE OR TWO NODES, AND NOT
C      BETWEEN SUPPLIES AND GROUND ONLY
       SUBROUTINE CONCHK (KNT,KNTN,N,NAME)
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
       CONTINUE
       EQUIVALENCE (JAB(275),KINERR)
      EQUIVALENCE (JAB(  1),JAB1),(JAB(  2),JAB2),(JAB(  3),JAB3)
     1,(JAB(  4),JAB4),(JAB(  5),JAB5),(JAB(  6),JAB6),(JAB(  7),JAB7)
     2,(JAB(  8),JAB8),(JAB(  9),JAB9),(JAB(10),JAB10),(JAB(11),JAB11)
       EQUIVALENCE (JAB(276),NSEQ)
C
C
       DIMENSION ICK(0/100)
       IN=1HN
       GO TO ( 90,100,100,99,100,100,100)KNT+1
90     IF(NAME-3HCLR) 93,91,93
91     NPCN=0
       K2=0
       DO 92 I=1,100
92     ICK(I)=0
       GO TO 999
93     IF(NAME-3HCHK) 999,94,999
94     DO 96 I=1,NSEQ
       IF(ICK(I))96,95,96
95     PRINT 11,I
11     FORMAT(4X,5($ X$),$ ERROR NODE$,I3$ HAS NO CONNECTION$
     1 ,5($ X$),/)
       KINERR=0
96     CONTINUE
       DO 98 I=NSEQ+1,100
       IF(ICK(I))98,98,97
97     PRINT 12,I
12     FORMAT(4X,5($ X$),$ ERROR NODE$,I3$ HAS A  CONNECTION$
     1 ,5($ X$),/)
98     CONTINUE
       GO TO 999
99     K2=2
       GO TO 101
100    K2=0
101    NPCN=0
       JABT=0
       NTN=KNTN/2
       DO 102 M=2,KNTN+K2,2
102    JABT=JABT+JAB(M)
       IF(JABT) 103,110,103
103    DO 105 M=2,KNTN,2
       IF(JAB(M-1)-IN) 105,104,105
104    ICK(JAB(M))=1
       NPCN=NPCN+1
105    CONTINUE
108    IF(NPCN-NTN+1) 109,110,110
109    PRINT 10,NAME,N
10     FORMAT(4X,5($ X$),$ ERROR IN CONNECTION ENTRY,$/
     1 ,15X,$IN $,A3,2X,I3,20X,5($ X$),/)
       KINERR=0
110    CONTINUE
       GO TO 999
999    RETURN
       END
CIRCAC ** FICHE/FRAME BREAK *****
ACLID
C      /ACLID/-/BACLID/ PART OF ACID
C      AC PARAM I.D.
C      EXTENDED USER CONTROL FOR MORE
C
C
C
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1),MOLLET(4)
      COMMON JAB,FAB,J,F
       CONTINUE
       EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
C
C
C      THESE EQUIV-S ARE NOT STOCK BUT THE GET THE JOB DONE.
       EQUIVALENCE (JAB(25),NSTM),(JAB( 1),JAB1),(JAB( 2),JAB2)
     1 ,(JAB(252),INDEL),(JAB(181),KCC1),(JAB(182),KCC2)
C
C
      EQUIVALENCE (JAB(160),MSUP),(JAB(163),LSUP),(JAB(166),NSUP)
      EQUIVALENCE (JAB(161),MNMP),(JAB(164),LNMP),(JAB(167),NNMP)
      EQUIVALENCE (JAB(162),MTMPAJ),(JAB(165),LTMPAJ),(JAB(168),NTMPAJ)
C
C
      EQUIVALENCE (JAB( 30),MRES),(JAB( 40),KRES),(JAB( 50),NDQRES)
     1,(JAB( 60),NAMRES),(JAB( 70),MNPRES),(JAB( 80),NRES)
     2,(JAB( 90),IRES),(JAB(100),LRES),(JAB(110),JRES)
      EQUIVALENCE (JAB( 31),MIND),(JAB( 41),KIND),(JAB( 51),NDQIND)
     1,(JAB( 61),NAMIND),(JAB( 71),MNPIND),(JAB( 81),NIND)
     2,(JAB( 91),IIND),(JAB(101),LIND),(JAB(111),JIND)
      EQUIVALENCE (JAB( 32),MCAP),(JAB( 42),KCAP),(JAB( 52),NDQCAP)
     1,(JAB( 62),NAMCAP),(JAB( 72),MNPCAP),(JAB( 82),NCAP)
     2,(JAB( 92),ICAP),(JAB(102),LCAP),(JAB(112),JCAP)
      EQUIVALENCE (JAB( 35),MVZS),(JAB( 45),KVZS),(JAB( 55),NDQVZS)
     1,(JAB( 65),NAMVZS),(JAB( 75),MNPVZS),(JAB( 85),NVZS)
     2,(JAB( 95),IVZS),(JAB(105),LVTR),(JAB(115),JVZS),(JAB(150),LVTI)
      EQUIVALENCE (JAB(149),LZR ),(JAB(148),LZI )
      EQUIVALENCE (JAB( 34),MCYS),(JAB( 44),KCYS),(JAB( 54),NDQCYS)
     1,(JAB( 64),NAMCYS),(JAB( 74),MNPCYS),(JAB( 84),NCYS)
     2,(JAB( 94),ICYS),(JAB(104),LCTR),(JAB(114),JCYS)
      EQUIVALENCE (JAB(147),LCTI),(JAB(146),LYR ),(JAB(145),LYI  )
      EQUIVALENCE (JAB( 33),MXIS),(JAB( 43),KXIS),(JAB( 53),NDQXIS)
     1,(JAB( 63),NAMXIS),(JAB( 73),MNPXIS),(JAB( 83),NXIS)
     2,(JAB( 93),IXIS),(JAB(103),LIE ),(JAB(113),JXIS)
     3,(JAB(142),LBLF ),(JAB(141),LEPH )
C
C
       EQUIVALENCE (IA ( 1),IA 1)
     1 ,(IA ( 2),IA 2),(IA ( 3),IA 3),(IA ( 4),IA 4),(IA ( 5),IA 5)
     2 ,(IA ( 6),IA 6),(IA ( 7),IA 7),(IA ( 8),IA 8),(IA ( 9),IA 9)
     3 ,(IA (10),IA10),(IA (11),IA11),(IA (12),IA12),(IA (13),IA13)
     4 ,(IA (14),IA14),(IA (15),IA15),(IA (16),IA16),(IA (17),IA17)
     5 ,(IA (18),IA18),(IA (19),IA19),(IA (20),IA20),(IA (21),IA21)
     6 ,(IA (22),IA22),(IA (23),IA23),(IA (24),IA24),(IA (25),IA25)
     7 ,(IA (26),IA26),(IA (27),IA27),(IA (28),IA28),(IA (29),IA29)
     8 ,(IA (30),IA30),(IA (31),IA31),(IA (32),IA32),(IA (33),IA33)
     9 ,(IA (34),IA34),(IA (35),IA35),(IA (36),IA36),(IA (37),IA37)
       EQUIVALENCE
     1  (IA (38),IA38),(IA (39),IA39),(IA (40),IA40),(IA (41),IA41)
     2 ,(IA (42),IA42),(IA (43),IA43),(IA (44),IA44),(IA (45),IA45)
     3 ,(IA (46),IA46),(IA (47),IA47),(IA (48),IA48),(IA (49),IA49)
     4 ,(IA (50),IA50),(IA (51),IA51),(IA (52),IA52),(IA (53),IA53)
     5 ,(IA (54),IA54),(IA (55),IA55),(IA (56),IA56),(IA (57),IA57)
     6 ,(IA (58),IA58),(IA (59),IA59),(IA (60),IA60),(IA (61),IA61)
     7 ,(IA (62),IA62),(IA (63),IA63),(IA (64),IA64)
C
C  .........          ..........          ..........          ..........
C      BETWEEN THESE LINES IS FOR TEST SETUP ONLY AND CAN BE DEL-D.
C  .........          ..........          ..........          ..........
C
C
C      SET UP OF IA (M), SUCH THAT M IS THE LOCATION IN THE
C      ARRAY AND THE DECIMAL VALUE OF THE ALPHANUMERIC CHARACTER
C      STORED IN THAT CELL. THIS M CONVERTED TO OCTAL, IS
C      REFERENCED IN THE DDT MANUAL(901113) PAGE 16, APPEN A.
C
C      THE APPROACH IS THIS, 65536=2**16, WHICH IS A LEFT SHIFT
C      16 PLACES. THIS LEFT JUSTIFIES THE CHARACTER IN THE WORD, AND
C      ALLOWS THE OUTPUT OF ANY ALPHANUMERIC CHARACTER GIVEN ITS
C      OCTAL OR DECIMAL INTERNAL VALUE. THE A1 FORMAT MUST BE USED .
C
C      THESE WILL BE USED LATER IN THE AUTO OUTPUT OF PARAMS, AND THE
C      IF STATEMENTS
C
C
       IPAM=-1
       CALL ESCAPE
       IF(IPAM) 6968,6968,90
6968   IPAM=+1
938    DIMENSION IA (64)
       DO 200 M=1,64
200    IA (M)=(M)*(65536)
940    DIMENSION LIN(80)
C
C
C      START OF LANK
C
C      JABS     ARE USED FOR CONTROL IN CHAINING.
C      JAB1 IS WHERE YOU ARE GOING IE PRID =1, DUID=2, IF THE
C      VALUE IS 0 IT WILL ASK FOR CONTROL MESSAGES. IT WILL
C      ONLY RECOGNIZE GOUC, TO GET BACK TO USRKNT, AND PRID OR DUID
C      TO REMAIN IN THIS LANK.
C      JAB1=-1 GETS YOU BACK TO THE OTHER LANK THEN KCC1 TAKES OVER
C      KCC1  WILL CONTROL WHERE IT IS GOING BACK TO,
C      IE THIS ONE SUPER LANK WILL SERVICE ALL VERSIONS OF CIRC-AC
C      KCC1=1 MEANS YOU CAME FROM LOCAL VERSION CHAINS TO /^ACUC/
C      KCC1=2 MEANS YOU CAME FROM 'AC-UC' ETC,
C      KCC1=3 MEANS YOU CAME FROM 'AC-UC'. BUT YOU HAVE SPECIAL
C      EQUATIONS AND WANT TO USE A LOCAL VERSION OF /^ACNM/
C
10     IF(JAB1)90,11,30
11     CONTINUE
       WRITE K94PO,12
12     FORMAT(/$:$)
13     CONTINUE
       ACCEPT 9,IANS
9      FORMAT(A1/)
14     IF(IANS-IA48)15,25,15
15     IF(IANS-IA36)16,26,16
16     IF(IANS-IA39)17,27,17
17     IF(IANS-IA63)18,69,18
18     CONTINUE
19     CONTINUE
20     WRITE K94PO,21
21     FORMAT(/$TO GET BACK TO USER CONTROL, TYPE:$/$GO$/)
22     GO TO 13
C      SETUP OF JAB 1 TO STAY HERE OR GO TO USRKNT
25     JAB1=1
       GO TO 10
26     JAB1=2
       GO TO 10
27     JAB1=-1
       GO TO 10
28     CONTINUE
29     CONTINUE
       GO TO 10
C      HERE IS WHERE IT PICKS OUT THE PLACE TO GO TO IN THIS LANK
30     GO TO (31,32,33,34,35,36       ),JAB1
31     CALL IPAR
       JAB1=0
       GO TO 10
32     CALL DPAR
       JAB1=0
       GO TO 10
33     CONTINUE
34     CONTINUE
35     CONTINUE
36     CONTINUE
       JAB1=0
       GO TO 10
C
C      THIS IS WHERE IT CHOOSES WHERE TO GO BACK TO
90     CONTINUE
       IF(KCC1) 91,91,92
91     NART=6
       MOLLET(1)=3H/AC
       MOLLET(2)=3HUC/
       CALL LINK(NART,MOLLET)
92      NART=10
       MOLLET(1)=3H(@6
       MOLLET(2)=3HLA)
       MOLLET(3)=3HACU
       MOLLET(4)=1HC
       CALL LINK(NART,MOLLET)
690    CONTINUE
69     CONTINUE
       FORMAT(I4/)
       ACCEPT 69,IANS
       IF(IANS)68,71,70
70     TYPE 71,JAB(IANS)
       GO TO 690
71     FORMAT(4X,I4/)
       GO TO 13
68     CONTINUE
       ACCEPT 69,IANS
       IF(IANS) 67,73,72
72     CONTINUE
       TYPE 73,JAB2
       GO TO 68
73     FORMAT(4X,O8/)
       GO TO 13
67     CONTINUE
       END
C      PARAMETER ID ROUTINE 2-29-69
C      CALCULATES THE PARAMETER NO FROM ALPH NAMES INPUT FROM USER
C      PARAMETER ID  (I)       2-29-69
C
C
       SUBROUTINE IPAR
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
       CONTINUE
       EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
C
       EQUIVALENCE (JAB(25),NSTM),(JAB( 252),INDEL)
C
C
      EQUIVALENCE (JAB(160),MSUP),(JAB(163),LSUP),(JAB(166),NSUP)
      EQUIVALENCE (JAB(161),MNMP),(JAB(164),LNMP),(JAB(167),NNMP)
      EQUIVALENCE (JAB(162),MTMPAJ),(JAB(165),LTMPAJ),(JAB(168),NTMPAJ)
C
C
C
      EQUIVALENCE (JAB( 30),MRES),(JAB( 40),KRES),(JAB( 50),NDQRES)
     1,(JAB( 60),NAMRES),(JAB( 70),MNPRES),(JAB( 80),NRES)
     2,(JAB( 90),IRES),(JAB(100),LRES),(JAB(110),JRES)
      EQUIVALENCE (JAB( 31),MIND),(JAB( 41),KIND),(JAB( 51),NDQIND)
     1,(JAB( 61),NAMIND),(JAB( 71),MNPIND),(JAB( 81),NIND)
     2,(JAB( 91),IIND),(JAB(101),LIND),(JAB(111),JIND)
      EQUIVALENCE (JAB( 32),MCAP),(JAB( 42),KCAP),(JAB( 52),NDQCAP)
     1,(JAB( 62),NAMCAP),(JAB( 72),MNPCAP),(JAB( 82),NCAP)
     2,(JAB( 92),ICAP),(JAB(102),LCAP),(JAB(112),JCAP)
      EQUIVALENCE (JAB( 35),MVZS),(JAB( 45),KVZS),(JAB( 55),NDQVZS)
     1,(JAB( 65),NAMVZS),(JAB( 75),MNPVZS),(JAB( 85),NVZS)
     2,(JAB( 95),IVZS),(JAB(105),LVTR),(JAB(115),JVZS),(JAB(150),LVTI)
      EQUIVALENCE (JAB(149),LZR ),(JAB(148),LZI )
      EQUIVALENCE (JAB( 34),MCYS),(JAB( 44),KCYS),(JAB( 54),NDQCYS)
     1,(JAB( 64),NAMCYS),(JAB( 74),MNPCYS),(JAB( 84),NCYS)
     2,(JAB( 94),ICYS),(JAB(104),LCTR),(JAB(114),JCYS)
      EQUIVALENCE (JAB(147),LCTI),(JAB(146),LYR ),(JAB(145),LYI  )
      EQUIVALENCE (JAB( 33),MXIS),(JAB( 43),KXIS),(JAB( 53),NDQXIS)
     1,(JAB( 63),NAMXIS),(JAB( 73),MNPXIS),(JAB( 83),NXIS)
     2,(JAB( 93),IXIS),(JAB(103),LIE ),(JAB(113),JXIS)
     3,(JAB(142),LBLF ),(JAB(141),LEPH )
C
C
       EQUIVALENCE (IA ( 1),IA 1)
     1 ,(IA ( 2),IA 2),(IA ( 3),IA 3),(IA ( 4),IA 4),(IA ( 5),IA 5)
     2 ,(IA ( 6),IA 6),(IA ( 7),IA 7),(IA ( 8),IA 8),(IA ( 9),IA 9)
     3 ,(IA (10),IA10),(IA (11),IA11),(IA (12),IA12),(IA (13),IA13)
     4 ,(IA (14),IA14),(IA (15),IA15),(IA (16),IA16),(IA (17),IA17)
     5 ,(IA (18),IA18),(IA (19),IA19),(IA (20),IA20),(IA (21),IA21)
     6 ,(IA (22),IA22),(IA (23),IA23),(IA (24),IA24),(IA (25),IA25)
     7 ,(IA (26),IA26),(IA (27),IA27),(IA (28),IA28),(IA (29),IA29)
     8 ,(IA (30),IA30),(IA (31),IA31),(IA (32),IA32),(IA (33),IA33)
     9 ,(IA (34),IA34),(IA (35),IA35),(IA (36),IA36),(IA (37),IA37)
       EQUIVALENCE
     1  (IA (38),IA38),(IA (39),IA39),(IA (40),IA40),(IA (41),IA41)
     2 ,(IA (42),IA42),(IA (43),IA43),(IA (44),IA44),(IA (45),IA45)
     3 ,(IA (46),IA46),(IA (47),IA47),(IA (48),IA48),(IA (49),IA49)
     4 ,(IA (50),IA50),(IA (51),IA51),(IA (52),IA52),(IA (53),IA53)
     5 ,(IA (54),IA54),(IA (55),IA55),(IA (56),IA56),(IA (57),IA57)
     6 ,(IA (58),IA58),(IA (59),IA59),(IA (60),IA60),(IA (61),IA61)
     7 ,(IA (62),IA62),(IA (63),IA63),(IA (64),IA64)
C
C  .........          ..........          ..........          ..........
C      BETWEEN THESE LINES IS FOR TEST SETUP ONLY AND CAN BE DEL-D.
C  .........          ..........          ..........          ..........
C
C
C      SET UP OF IA (M), SUCH THAT M IS THE LOCATION IN THE
C      ARRAY AND THE DECIMAL VALUE OF THE ALPHANUMERIC CHARACTER
C      STORED IN THAT CELL. THIS M CONVERTED TO OCTAL, IS
C      REFERENCED IN THE DDT MANUAL(901113) PAGE 16, APPEN A.
C
C      THE APPROACH IS THIS, 65536=2**16, WHICH IS A LEFT SHIFT
C      16 PLACES. THIS LEFT JUSTIFIES THE CHARACTER IN THE WORD, AND
C      ALLOWS THE OUTPUT OF ANY ALPHANUMERIC CHARACTER GIVEN ITS
C      OCTAL OR DECIMAL INTERNAL VALUE. THE A1 FORMAT MUST BE USED .
C
C      THESE WILL BE USED LATER IN THE AUTO OUTPUT OF PARAMS, AND THE
C      IF STATEMENTS
C
C
938    DIMENSION IA (64)
       DO 200 M=1,64
200    IA (M)=(M)*(65536)
940    DIMENSION LIN(80)
       NCOMMA=0
C      NSTNM IS THE NO OF STANDARD NON-MODELS
       NSTNM=3
C
C      ALL THE ASSIGNS ARE FOR (KOG)= AUTO LIST
C      ITM,ITMP BOTH ALLOW THE USER TO NOT END A LINE WITH A COMMA
C      THE PROGRAM TAKES IN THE LINE, THEN STARTING ON THE LEFT
C      MASKS FOR COMMAS, COUNTING THEM (94), IF THERE IS NO COMMA
C      AT THE END IT PUTS ONE IN. THEN IT STARTS ON THE RIGHT AND
C      MASKS FOR LETTERS AND WORDS. WORKING BETWEEN THE COMMAS.
C      THE COMMA HAS NO MEANING OTHER THAN A SEPARATOR. IT DOES
C      NOT TERNINATE INTEGER FIELDS AS ONE WOULD SEEM TO THINK,
C      AS (RES1,) = (1RES,) = (1R,) = (R1ES,) = (RE1S,)  ETC.
C      IN THE ABOVE LINE ONE CAN SEE THE THE PROGRAM ONLY REQUIRES
C      THE PARAMETER ID TO BE UNIQUELY DEFINED AND AFTER
C      THAT ALL TYPING IS NOT REQUIRED.
C      ANOTHER BUILT IN FEATURE IS THAT ONCE IT HAS THE
C      ALPHA STRING PROCESSED IT RETAINS THOSE AND ONLY CHANGES THE NO,
C      IE (RES1,RES2,RES3,) CAN BE REDUCED TO (R1,2,3,) ETC.
C      THIS DOES NOT HOWEVER WORK IN BOTH WAYS. THE NUMBER IS
C      RESET AT EACH PASS. SO (R1,C,L,) WILL NKT WORK.
       ASSIGN 451 TO KOG
       ASSIGN 90  TO ITM
       ASSIGN 943 TO ITMP
       IF(INDEL)88,87,88
87     CONTINUE
       WRITE K94PO,91
       WRITE K94PO,93
88     CONTINUE
91     FORMAT(4X,$SPECIFY THE FOLLOWING,$/)
93     FORMAT(4X,$PARAM ID,PARAM ID,ETC.$/)
       READ K94IO,941,LIN
941    FORMAT(80A1/)
C      FIND THE NO. OF COMMAS. WHICH IS USED IN A DO LOOP LATER,
C      IT ALSO SETS UP THE SECOND DO LOOP FOR THE WORD LENGTH
C      WITH L(AST)COMMA. WHICH IS THE LAST COMMA FROM R TO L.
C      IF THE FIRST CHARACTER IS NOTHING (SPACE OR RETURN), IT WILL
C      RETURN TO THE CALLING PROGRAM .  (/^ACID/ LANK)
       IF(LIN(1)) 94,9999,94
94     DO 945 L=80,1,-1
       IF(LIN(L)) 942,945 ,942
942    IF(LIN(L)-IA12) 89,943,89
89     GO TO ITM
90     LIN(L+1)=IA12
       ASSIGN 92  TO ITM
92     GO TO ITMP
943    ASSIGN 945 TO ITMP
       LCOMMA=L
944    NCOMMA=NCOMMA+1
945    CONTINUE
       ITM1=LCOMMA
       KNTPAT=0
       ITMP2=1
       NUM=0
       I=0
       DO 970 L=1,NCOMMA
       DO 960 K=ITMP2,ITM1  +1
       LANK=LIN(K)
       IF(LANK)946,960,946
946    IF(LANK-IA32) 950,961,955
950    IF(LANK-IA12)961,947,500
500    IF(LANK-IA15)961,955,501
C      MASKING FOR FINDING OF ALPH NUMBERS IN A STRING
501    LANK=LIN(K)
510    IF(LANK-IA16)961,520,512
512    IF(LANK-IA18)521,522,514
514    IF(LANK-IA20)523,524,516
516    IF(LANK-IA22)525,526,518
518    IF(LANK-IA24)527,528,519
519    IF(LANK-IA25)961,529,961
C      CALCULATION FROM ALPHA STRING TO INTEGER NO.
520    NUMT=0
       GO TO 530
521    NUMT=1
       GO TO 530
522    NUMT=2
       GO TO 530
523    NUMT=3
       GO TO 530
524    NUMT=4
       GO TO 530
525    NUMT=5
       GO TO 530
526    NUMT=6
       GO TO 530
527    NUMT=7
       GO TO 530
528    NUMT=8
       GO TO 530
529    NUMT=9
       GO TO 530
530    NUM=(10*NUM)+NUMT
       GO TO 960
955    IF(KNTPAT) 960,9000,960
9000   LANK=LIN(K)
9110   CONTINUE
       IF(LANK-IA33)9210,9120,9210
9120   CONTINUE
       GO TO 100
9210   CONTINUE
       IF(LANK-IA58)9310,9220,9310
9220   CONTINUE
       KJ=9
       K=K+1
       LANK=LIN(K)
       IF(LANK-IA50)9222,9221,9222
9221   KK=-1
       GO TO 958
9222   CONTINUE
       IF(LANK-IA41)957,9223,957
9223   KK= 0
       GO TO 958
9310   CONTINUE
       IF(LANK-IA46)9410,9320,9410
9320   CONTINUE
       K=K+1
       LANK=LIN(K)
       IF(LANK-IA45)957,9321,957
9321   CONTINUE
       KJ=2
       KK=0
       GO TO 958
9410   CONTINUE
       IF(LANK-IA34)9510,9420,9510
9420   CONTINUE
       KJ=7
       KK=-6
       GO TO 958
9510   CONTINUE
       IF(LANK-IA35)9610,9520,9610
9520   CONTINUE
       K=K+1
       LANK=LIN(K)
       IF(LANK-IA35)9522,9521,9522
9521   KJ=7
       KK=-1
       GO TO 958
9522   CONTINUE
       IF(LANK-IA26)9523,9524,9524
9523   CONTINUE
       K=K-1
       GO TO 9527
9524   CONTINUE
       IF(LANK-IA33)9528,9525,9528
9525   CONTINUE
       IF(LIN(K+1)-IA48)9528,9526,9528
9526   CONTINUE
       K=K+1
9527   CONTINUE
       KJ=6
       KK=0
       GO TO 958
9528   CONTINUE
       IF(LANK-IA52)957,9529,957
9529   CONTINUE
       K=K+1
       LANK=LIN(K)
       IF(LANK-IA37)9531,9530,9531
9530   CONTINUE
       KJ=7
       KK=-2
       GO TO 958
9531   IF(LANK-IA50)9534,9533,9534
9533   CONTINUE
       KJ=8
       KK=-3
       GO TO 958
9534   CONTINUE
       IF(LANK-IA41)957,9535,957
9535   CONTINUE
       KJ=8
       KK=-2
       GO TO 958
9610   CONTINUE
       IF(LANK-IA44)9710,9620,9710
9620   CONTINUE
       KJ=5
       KK=0
       GO TO 958
9710   CONTINUE
       IF(LANK-IA51)9810,9720,9810
9720   CONTINUE
       KJ=1
       KK=0
       GO TO 958
9810   CONTINUE
       IF(LANK-IA52)9910,9820,9910
9820   CONTINUE
       KJ=3
       KK=0
       GO TO 958
9910   CONTINUE
       IF(LANK-IA54)19110,9920,19110
9920   CONTINUE
       K=K+2
       LANK=LIN(K)
       IF(LANK-IA50)9922,9921,9922
9921   CONTINUE
       KJ=9
       KK=-3
       GO TO 958
9922   CONTINUE
       IF(LANK-IA41) 957,9923,957
9923   CONTINUE
       KJ=9
       KK=-2
       GO TO 958
19110  CONTINUE
       IF(LANK-IA57)19210,19120,19210
19120  CONTINUE
       K=K+1
       LANK=LIN(K)
       KJ=8
       IF(LANK-IA41)19122,19121,19122
19121  CONTINUE
       KK= 0
       GO TO 958
19122  CONTINUE
       IF(LANK-IA50)957,19123,957
19123  CONTINUE
       KK=-1
       GO TO 958
19210  CONTINUE
       IF(LANK-IA41)19310,19220,19310
19220  CONTINUE
       K=K+1
       LANK=LIN(K)
       IF (LANK-IA37) 19222,19221,19222
19221  CONTINUE
       KJ=7
       KK=-7
       GO TO 958
19222  CONTINUE
       IF (LANK-IA46) 957,19223,957
19223  CONTINUE
       GO TO 9620
19310  CONTINUE
       IF(LANK-IA50)19410,19320,19410
19320  CONTINUE
       K=K+1
       LANK=LIN(K)
       IF(LANK-IA34)19330,19321,19330
19321  CONTINUE
       KJ=7
       KK=-3
       GO TO 958
19330  CONTINUE
       IF(LANK-IA35)19340,19331,19340
19331  CONTINUE
       KJ=7
       KK=0
       GO TO 958
19340  CONTINUE
       IF(LANK-IA37)19350,19341,19350
19341  CONTINUE
       K=K+1
       LANK=LIN(K)
       IF(LANK-IA51) 957,19342,957
19342  CONTINUE
       KJ=4
       KK=0
       GO TO 958
19350  CONTINUE
       IF(LANK-IA26) 19351,957,957
19351  CONTINUE
       K=K-1
       GO TO 19342
19410  CONTINUE
       IF(LANK-IA37)19510,19420,19510
19420  CONTINUE
       KJ=7
       KK=-5
       GO TO 958
19510  CONTINUE
       IF (LANK-IA38) 19610,19520,19610
19520  CONTINUE
       KJ=7
       KK=-4
       GO TO 958
19610  CONTINUE
19710  CONTINUE
19810  CONTINUE
19910  CONTINUE
       GO TO 957
C      HAS ALL THE INFO TO GUESS AT THE PARAMETER NO.
947    CONTINUE
       IF(KJ-3) 303,302,303
302    NUM=1
303    CONTINUE
       IF(KJ-NSTNM)400,400,405
400    GO TO (401,402,403),KJ
401    NP=NUM*MSUP
       GO TO 404
402    NP=NUM+(MSUP)*(NSUP)
       GO TO 404
403    NP=NUM+((MSUP)*(NSUP)+(MNMP)*(NNMP))
404    GO TO 450
405    NP=    ((MSUP)*(NSUP)+(MTMPAJ)*(NTMPAJ)+(MNMP)*(NNMP))
406    NP=NP+KK
C
C      THE FOLLOWING CONTROLS ARE USED BECAUSE KJ CAN VARY FROM
C      1 TO 13( AT PRESENT). KKJ IS KJ SCALED BY -NSTNM. SO THAT ITS
C      RANGE IS 1 TO 11, BUT IF IF IT IS GREATER THAN NSTM NEW CONTROLS
C      ARE SET UP.(KKJ1 AND KKK). THIS INSURES THAT KKJ IS BETWEEN 1 AND
C      NSTM , OR IF GREATER THAN NSTM IT MAKES IT
C      =NST,. (BY KKK , THEN IN THE DO 415 LOOP THE UPPER LIMIT IS:
C      (KKJ-1+1-KKJ+NSTM)=(NSTM),BUT IF KKJ IS NSTM OR LESS, THEN IT IS
C      (KKJ-1+0) OR THE LOOP IS UNCHANGED. FOR EXAMPLE CONSIDER:
C      IF KJ=12, THEN 405 IS DONE ( FOR 1,3 ) THEN KKJ=9, SO IT IS
C      REDUCED BY KKK TO MAKE IT =NSTM (FOR 4,8)
C      THEN KKJ1=4  (FOR 9,12), AND 13 IS SKIPPED.
C      IF KJ=6 , THEN 405 IS DONE ( FOR 1,3 ) THEN KKJ=3 ( FOR 4,6 )
C      THEN KKJ1=0  THUS SKIPPING 7,13.
C      IF KJ=2, THEN 402 IS DONE AND KKJ=KKJ1=0, AND 3,13 ARE SKIPPED.
C      ALL THIS IS DONE TO CALC. THE NP (NO OF THE PARAM.) . IT
C      INSURES THAT ONLY THE MODELS THAT ARE NEEDED ARE
C      ADDED IN TO THE SUM. ALSO IT IS GENERAL SO THAT IF ANY
C      MODELS ARE ADDED, NOTHING HAS TO BE DONE HERE. IF NEW NOM-MODELS
C      ARE ADDED THEN NSTNM SHOULD BE CHANGED ONLY IN HERE. BUT
C      IN THE CASE OF ANY ADDITIONS THE MASKING MUST BE
C      CHANGED, AND THE KK MAY BE EFFECTED.
C              KKK IS A CONTROL THAT SCALES KKJ TO BE BETWEEN 1, NSTM
C      OR = NSTM. THUS THE IF STATEMENTS WILL ALWAYS BE 1,N FOR N LESS
C      THAN OR EQUAL TO NSTM.
C
C      IF THE READER THINKS THERE IS A PROBLEM HERE, GOOD LUCK.
C      IF HE IS TRYING TO UNDERSTAND IT,ALSO GOOD LUCK.
C      A GOOD REFERENCE TO THE TYPES OF APPROACHES USED IN THIS ROUTINE
C       WOULD BE THE TRAC PROGRAM.
C      TRYING TO DETERMINE THE METHOD FOR
407    KKJ1=0
       KKK=0
       KKJ=KJ-NSTNM
       IF(KKJ-NSTM)410,410,409
409    KKJ1=KKJ-NSTM
       KKK=NSTM+1-KKJ
410    IF(KKJ-1) 416,416,411
411    DO 415 M=1,KKJ-1   +KKK
415    NP=NP+(JAB(79+M)*JAB(29+M))
416    M=KKJ
417    IF(KKJ1)418,418,420
418    NP=NP+(NUM      *JAB(29+M))
       GO TO 450
420    IF(KKJ1-1) 426,426,421
421    DO 425 M=1,KKJ1-1
425    NP=NP+(JAB(79+M)*(          JAB(69+M)))
426    M=KKJ1
427    NP=NP+(NUM      *(          JAB(69+M)))
       GO TO 450
450    GO TO KOG
451    IF(KJ-1) 452,453,452
452    CONTINUE
       WRITE K94PO,1001,NP,IA29,(LIN(M),M=ITMP2,K-1)
       GO TO 454
453    NPL1=NP-1
       WRITE K94PO,1001,NPL1,IA29,IA45,(LIN(M),M=ITMP2,K-1)
       WRITE K94PO,1001,NP,IA29,IA33,(LIN(M),M=ITMP2,K-1)
454    CONTINUE
       NUM=0
1001   FORMAT(I6,1X,80A1/)
C      THIS SHOULD MAKE 960 LOOP FAIL AND GO TO 960+1
       ITM1=K-1
960    CONTINUE
       KNTPAT=0
       ITMP2=K
       ITM1=79
970    CONTINUE
9999   CONTINUE
       RETURN
961    CONTINUE
957    CONTINUE
       WRITE K94PO,1000,K
       GO TO 940
1000   FORMAT(4X,$SYNTAX ERROR IN CHARACTER #$,I4/)
       GO TO 961
C      HAS UNIQUE PATTERN
958    KNTPAT=1
       GO TO 960
100    CONTINUE
       LIN(10)=IA51
       LIN(11)=IA53
       LIN(12)=IA48
       LIN(13)=IA46
       LIN(14)=IA45
       LIN(15)=IA48
       LIN(18)=IA52
       LIN(19)=IA45
       LIN(20)=IA48
       KJ=0
204    DO 210 N1=1,NSTNM
       KJ=KJ+1
206    DO 210 NUM=1,(JAB(165+N1))
       KK=0
       ASSIGN 208 TO KOG
       GO TO 947
208    CONTINUE
       IF(JAB(165+N1)*JAB(159+N1))209,210,209
209    IF(N1-1)2090,2091,2090
2090   CONTINUE
       WRITE K94PO,1003,NP,IA29,(LIN(N2),N2=(9+N1*N1),(9+N1*N1)+
     1 NSTNM-1),NUM
       GO TO 2092
2091   NPL1=NP-1
       WRITE K94PO,1005,NPL1,IA29,(LIN(N2),N2=(9+N1*N1),(9+N1*N1)+
     1 NSTNM-1),IA45,NUM
     2 ,NP,IA29,(LIN(N2),N2=(9+N1*N1),(9+N1*N1)+
     3 NSTNM-1),IA33,NUM
2092   CONTINUE
1005   FORMAT(I6,1X,5A1,I3/)
1003   FORMAT (I6,1X,4A1,I3/)
210    CONTINUE
       LIN( 4)=NAMRES
       LIN( 5)=NAMIND
       LIN( 6)=NAMCAP
       LIN(49)=3HIE
       LIN(50)=3HBLF
       LIN(51)=3HEPH
       LIN(52)=3HFTB
       LIN(53)=3HRB
       LIN(54)=3HCTE
       LIN(55)=3HCC
       LIN(56)=3HRC
       LIN(29)=3HCTR
       LIN(30)=3HCTI
       LIN(31)=3HYR
       LIN(32)=3HYI
       LIN(33)=3HVTR
       LIN(34)=3HVTI
       LIN(35)=3HZR
       LIN(36)=3HZI
       DO 220 N1=1,NSTM
C
C      KJ AND KK ARE THE CONTROLS FOR THE PARAM CALC.
C      KJ IS THE PARAMETER TYPE NO, 1 FOR SUP,2 FOR  NMP, 3 FOR TMP,
C      4 FOR RES, ETC.
       KJ=N1+NSTNM
C      SETUP OF CONTROL OF WHICH PARAM OF THE MODEL YOU ARE ON
C      IF THE MODEL HAS MORE THAN ONE PARAM, THE PROG CALCULATES THE
C      VALUE OF KK AS FOLLOWS
C      KK= ( 1 - MRES )    1-1=0, OR FOR XIS 1-8=-7,ETC
       N3=1-(JAB(29+N1))
       DO 220 NUM=1,(JAB(79+N1))
       DO 220 KK=N3,0,+1
       ASSIGN 218 TO KOG
       GO TO 947
218    CONTINUE
       IF(JAB( 29+N1)*JAB( 79+N1))219,220,219
219    WRITE  K94PO,1004,NP,IA29,LIN(KK+((JAB(29+N1))*KJ)),NUM
1004   FORMAT(I6,1X,A1,A3,I3/)
220    CONTINUE
       GO TO 9999
       END
C      PARAMETER ID  (D)       2-29-69
C
C
       SUBROUTINE DPAR
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
       CONTINUE
       EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
C
       EQUIVALENCE (JAB(25),NSTM),(JAB( 252),INDEL)
C
C
      EQUIVALENCE (JAB(160),MSUP),(JAB(163),LSUP),(JAB(166),NSUP)
      EQUIVALENCE (JAB(161),MNMP),(JAB(164),LNMP),(JAB(167),NNMP)
      EQUIVALENCE (JAB(162),MTMPAJ),(JAB(165),LTMPAJ),(JAB(168),NTMPAJ)
C
C
      EQUIVALENCE (JAB( 30),MRES),(JAB( 40),KRES),(JAB( 50),NDQRES)
     1,(JAB( 60),NAMRES),(JAB( 70),MNPRES),(JAB( 80),NRES)
     2,(JAB( 90),IRES),(JAB(100),LRES),(JAB(110),JRES)
      EQUIVALENCE (JAB( 31),MIND),(JAB( 41),KIND),(JAB( 51),NDQIND)
     1,(JAB( 61),NAMIND),(JAB( 71),MNPIND),(JAB( 81),NIND)
     2,(JAB( 91),IIND),(JAB(101),LIND),(JAB(111),JIND)
      EQUIVALENCE (JAB( 32),MCAP),(JAB( 42),KCAP),(JAB( 52),NDQCAP)
     1,(JAB( 62),NAMCAP),(JAB( 72),MNPCAP),(JAB( 82),NCAP)
     2,(JAB( 92),ICAP),(JAB(102),LCAP),(JAB(112),JCAP)
      EQUIVALENCE (JAB( 35),MVZS),(JAB( 45),KVZS),(JAB( 55),NDQVZS)
     1,(JAB( 65),NAMVZS),(JAB( 75),MNPVZS),(JAB( 85),NVZS)
     2,(JAB( 95),IVZS),(JAB(105),LVTR),(JAB(115),JVZS),(JAB(150),LVTI)
      EQUIVALENCE (JAB(149),LZR ),(JAB(148),LZI )
      EQUIVALENCE (JAB( 34),MCYS),(JAB( 44),KCYS),(JAB( 54),NDQCYS)
     1,(JAB( 64),NAMCYS),(JAB( 74),MNPCYS),(JAB( 84),NCYS)
     2,(JAB( 94),ICYS),(JAB(104),LCTR),(JAB(114),JCYS)
      EQUIVALENCE (JAB(147),LCTI),(JAB(146),LYR ),(JAB(145),LYI  )
      EQUIVALENCE (JAB( 33),MXIS),(JAB( 43),KXIS),(JAB( 53),NDQXIS)
     1,(JAB( 63),NAMXIS),(JAB( 73),MNPXIS),(JAB( 83),NXIS)
     2,(JAB( 93),IXIS),(JAB(103),LIE ),(JAB(113),JXIS)
     3,(JAB(142),LBLF ),(JAB(141),LEPH )
C
C
       EQUIVALENCE (IA ( 1),IA 1)
     1 ,(IA ( 2),IA 2),(IA ( 3),IA 3),(IA ( 4),IA 4),(IA ( 5),IA 5)
     2 ,(IA ( 6),IA 6),(IA ( 7),IA 7),(IA ( 8),IA 8),(IA ( 9),IA 9)
     3 ,(IA (10),IA10),(IA (11),IA11),(IA (12),IA12),(IA (13),IA13)
     4 ,(IA (14),IA14),(IA (15),IA15),(IA (16),IA16),(IA (17),IA17)
     5 ,(IA (18),IA18),(IA (19),IA19),(IA (20),IA20),(IA (21),IA21)
     6 ,(IA (22),IA22),(IA (23),IA23),(IA (24),IA24),(IA (25),IA25)
     7 ,(IA (26),IA26),(IA (27),IA27),(IA (28),IA28),(IA (29),IA29)
     8 ,(IA (30),IA30),(IA (31),IA31),(IA (32),IA32),(IA (33),IA33)
     9 ,(IA (34),IA34),(IA (35),IA35),(IA (36),IA36),(IA (37),IA37)
       EQUIVALENCE
     1  (IA (38),IA38),(IA (39),IA39),(IA (40),IA40),(IA (41),IA41)
     2 ,(IA (42),IA42),(IA (43),IA43),(IA (44),IA44),(IA (45),IA45)
     3 ,(IA (46),IA46),(IA (47),IA47),(IA (48),IA48),(IA (49),IA49)
     4 ,(IA (50),IA50),(IA (51),IA51),(IA (52),IA52),(IA (53),IA53)
     5 ,(IA (54),IA54),(IA (55),IA55),(IA (56),IA56),(IA (57),IA57)
     6 ,(IA (58),IA58),(IA (59),IA59),(IA (60),IA60),(IA (61),IA61)
     7 ,(IA (62),IA62),(IA (63),IA63),(IA (64),IA64)
C
C  .........          ..........          ..........          ..........
C      BETWEEN THESE LINES IS FOR TEST SETUP ONLY AND CAN BE DEL-D.
C  .........          ..........          ..........          ..........
C
C
C      SET UP OF IA (M), SUCH THAT M IS THE LOCATION IN THE
C      ARRAY AND THE DECIMAL VALUE OF THE ALPHANUMERIC CHARACTER
C      STORED IN THAT CELL. THIS M CONVERTED TO OCTAL, IS
C      REFERENCED IN THE DDT MANUAL(901113) PAGE 16, APPEN A.
C
C      THE APPROACH IS THIS, 65536=2**16, WHICH IS A LEFT SHIFT
C      16 PLACES. THIS LEFT JUSTIFIES THE CHARACTER IN THE WORD, AND
C      ALLOWS THE OUTPUT OF ANY ALPHANUMERIC CHARACTER GIVEN ITS
C      OCTAL OR DECIMAL INTERNAL VALUE. THE A1 FORMAT MUST BE USED .
C
C      THESE WILL BE USED LATER IN THE AUTO OUTPUT OF PARAMS, AND THE
C      IF STATEMENTS
C
C
938    DIMENSION IA (64)
       DO 200 M=1,64
200    IA (M)=(M)*(65536)
940    DIMENSION LIN(80)
       NCOMMA=0
C      NSTNM IS THE NO OF STANDARD NON-MODELS
       NSTNM=3
       ASSIGN 451 TO KOG
       ASSIGN 90  TO ITM
       ASSIGN 943 TO ITMP
       IF(INDEL)88,87,88
87     CONTINUE
       WRITE K94PO,91
       WRITE K94PO,93
88     CONTINUE
91     FORMAT(4X,$SPECIFY THE FOLLOWING,$/)
93     FORMAT(4X,$DEP.UNK.,DEP.UNK.,ETC.$/)
       READ K94IO,941,LIN
941    FORMAT(80A1/)
C      FIND THE NO. OF COMMAS.
       IF(LIN(1)) 94,9999,94
94     DO 945 L=80,1,-1
       IF(LIN(L)) 942,945 ,942
942    IF(LIN(L)-IA12) 89,943,89
89     GO TO ITM
90     LIN(L+1)=IA12
       ASSIGN 92  TO ITM
92     GO TO ITMP
943    ASSIGN 945 TO ITMP
       LCOMMA=L
944    NCOMMA=NCOMMA+1
945    CONTINUE
       ITM1=LCOMMA
       KNTPAT=0
       ITMP2=1
       NUM=0
       I=0
       DO 970 L=1,NCOMMA
       DO 960 K=ITMP2,ITM1  +1
       LANK=LIN(K)
       IF(LANK)946,960,946
946    IF(LANK-IA32) 950,961,955
950    IF(LANK-IA12)961,947,500
500    IF(LANK-IA15)961,955,501
C      MASKING FOR FINDING OF ALPH NUMBERS IN A STRING
501    LANK=LIN(K)
510    IF(LANK-IA16)961,520,512
512    IF(LANK-IA18)521,522,514
514    IF(LANK-IA20)523,524,516
516    IF(LANK-IA22)525,526,518
518    IF(LANK-IA24)527,528,519
519    IF(LANK-IA25)961,529,961
C      CALCULATION FROM ALPHA STRING TO INTEGER NO.
520    NUMT=0
       GO TO 530
521    NUMT=1
       GO TO 530
522    NUMT=2
       GO TO 530
523    NUMT=3
       GO TO 530
524    NUMT=4
       GO TO 530
525    NUMT=5
       GO TO 530
526    NUMT=6
       GO TO 530
527    NUMT=7
       GO TO 530
528    NUMT=8
       GO TO 530
529    NUMT=9
       GO TO 530
530    NUM=(10*NUM)+NUMT
       GO TO 960
C
C      THIS IS THE START OF THE MASKING FOR THE ALPHA FIELD
C      KNTPAT IS THE CONTROL OVER THE PATTERN, IF IT HAS NOT YET
C      RECOGNIZED A PATTERN, KNTPAT=0, IF IT HAS KNTPAT=1.
C      AFTER MASKING IF IT IS A LEGAL PATTERN IT GOES TO 958
C      WHICH SETS KNTPAT=1, IF THE STRING IS NOT RECOGNIZED
C      IT GOES TO 957 AND PUTS OUT A ERROR MESSAGE. AFTER
C      THE 958 OR 957 TRANSFER, IT GOES TO 960 TO INCREMENT THE DO LOOP
C      IF THE NEXT CHARACTER IS A NUMBER (LESS THEN IA26) THEN
C      IT CALCULATES THE INTEGER VALUE OF IT. IF NOT THEN IT
C      ASSUMES ZERO AND OUTPUTS THE RESULTS.
955    IF(KNTPAT) 960,9000,960
9000   LANK=LIN(K)
9110   CONTINUE
       IF(LANK-IA33)9210,9120,9210
9120   CONTINUE
       GO TO 100
9210   CONTINUE
       IF(LANK-IA41)9310,9220,9310
9220   CONTINUE
       K=K+1
       LANK=LIN(K)
       IF(LANK-IA50)9222,9221,9222
9221   KK=0
       KJ=1
       GO TO 958
9222   CONTINUE
       IF(LANK-IA34)9224,9223,9224
9223   CONTINUE
       KJ=4
       KK=-2
       GO TO 958
9224   CONTINUE
       IF(LANK-IA35)9226,9225,9226
9225   CONTINUE
       IF(LIN(K+1)-IA26)  9230,9230,9231
9230   CONTINUE
       KJ=4
       KK=-1
       GO TO 958
9231   CONTINUE
       IF(LIN(K+1)-IA33)957,9232,957
9232   CONTINUE
       KJ=3
       KK=0
       GO TO 958
9226   CONTINUE
       IF(LANK-IA37) 9228,9227,9228
9227   CONTINUE
       KJ=4
       KK=0
       GO TO 958
9228   CONTINUE
       IF(LANK-IA44) 92291,92290,92291
92290  KJ=2
       KK=0
       GO TO 958
92291  CONTINUE
       IF(LANK-IA41) 9310,92290,9310
       GO TO 958
9310   CONTINUE
9410   CONTINUE
9510   CONTINUE
9610   CONTINUE
9710   CONTINUE
9810   CONTINUE
9910   CONTINUE
       GO TO 957
C      HAS ALL THE INFO TO GUESS AT THE PARAMETER NO.
947    CONTINUE
       NP=KK
410    IF(KJ-1) 416,416,411
411    DO 415 M=1,KJ-1
415    NP=NP+(JAB(79+M)*JAB(49+M))
416    M=KJ
418    NP=NP+(NUM      *JAB(49+M))
       GO TO 450
450    GO TO KOG
451    WRITE K94PO,1001,IA36,NP,IA29,(LIN(M),M=ITMP2,K-1)
       NUM=0
1001   FORMAT(A1,I5,1X,80A1/)
C      THIS SHOULD MAKE 960 LOOP FAIL AND GO TO 960+1
       ITM1=K-1
960    CONTINUE
       KNTPAT=0
       ITMP2=K
       ITM1=79
970    CONTINUE
9999   CONTINUE
       RETURN
961    CONTINUE
957    CONTINUE
       WRITE K94PO,1000,K
       GO TO 940
1000   FORMAT(4X,$SYNTAX ERROR IN CHARACTER #$,I4/)
       GO TO 961
C      HAS UNIQUE PATTERN
958    KNTPAT=1
       GO TO 960
100    CONTINUE
210    CONTINUE
       LIN( 8)=NAMRES
       LIN(16)=NAMIND
       LIN(24)=NAMCAP
       LIN(30)=IA34
       LIN(31)=IA35
       LIN(32)=IA37
       DO 220 KJ=1,NSTM
C      KK= ( 1 -NDQRES)    1-1=0, OR FOR XIS 1-3=-2,ETC
       N3=1-(JAB(49+KJ))
       DO 220 NUM=1,(JAB(79+KJ))
       DO 220 KK=N3,0,+1
       ASSIGN 218 TO KOG
       GO TO 947
218    CONTINUE
       KKK=((8*KJ)+KK)
       IF(JAB( 49+KJ)*JAB( 79+KJ))219,220,219
219    WRITE K94PO,1004,IA36,NP,IA29,IA41,LIN(KKK),NUM
1004   FORMAT(A1,I5,1X,A1,A1,A3,I3/)
220    CONTINUE
       ASSIGN 451 TO KOG
       GO TO 9999
       END
CIRCAC ** FICHE/FRAME BREAK *****
ACMSG
C      /ACMSG/-/BACMSG/ PART OF  ACPT2
C        MSGERR
C
      SUBROUTINE MSGERR (KNT,IARG1,IARG2,FARG1,FARG2)
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
      EQUIVALENCE (JAB(158),K94IO),(JAB(169),K94FO),(JAB(170),K94PO)
      EQUIVALENCE (JAB(172),KTPL),(JAB(171),KDLIN)
      EQUIVALENCE (JAB(175),IOVM ) ,(JAB(174),IPOVM),(JAB(173),KDLUK)
      EQUIVALENCE (JAB(276),NSEQ),(JAB(199),NSDE),(JAB(198),NUNK)
     1,(JAB(197),NDEQ),(JAB(196),NMDE),(JAB(195),MPRT),(JAB(194),IPRT)
      EQUIVALENCE (JAB(191),ITNO)
      EQUIVALENCE (JAB(190),LV  ),(JAB(189),LV1B),(JAB(188),LVM )
     1,(JAB(187),LVN ),(JAB(186),LVX )
C  .........          ..........          ..........          ..........
      GO TO (1,2,3,4,1000,500  )  KNT
C      NEW FOR RELEASED VERSION ONLY FOR I/O=6.
500    TYPE 501,IARG1,IARG2
501    FORMAT ($ ATTEMPTED CONTROL TYPE N.G. FOR $,A3,I3/)
       RETURN
1     NXL = IARG1
      IENL = IARG2
      RETURN
C
C  DO THE TEST FOR OVERRUN
C
2     IF(IARG1-1) 5,5,101
5     NOVRNZ = NXL-IENL
C  IOVRN  BEING (-) OR 0  INDICATES FAILURE OF MODE BEIGN TESTED
C   2 MATRIX HITS DATA-ABORT
C  3  SOME DATA HITS PROG. ABORT
      IOVRN2=  -NOVRNZ
      IOVRN3=  IENL -IARG2
      IF(IOVRN2)  13,13,14
13    IPOVM = 2
      NFOOV = IOVRN2
14    IF(IOVRN3) 20,20,55
20    IPOVM = 3
      NFOOV = IOVRN3
55       IF( IPOVM -IOVM) 101,101,51
51    GO TO (101,102,103                   ) IPOVM
102   CONTINUE
       WRITE K94PO,92
      GO TO 107
103   CONTINUE
       WRITE K94PO,93
107   CONTINUE
      WRITE K94PO,96
100   IOVM = IPOVM
       WRITE K94PO,90,NFOOV,IPOVM
      STOP
101   CONTINUE
C
C  DO AFTER  TRIANGULIZATION TEST
      IPLC =3HAFT
40    IF(ABSF(FARG1) - FAB(20)) 41,41,43
41     IF(ABSF(FARG2)-FAB(20))42,42,43
42    WRITE K94PO,120,IARG1,IPLC,FARG1,FARG2
43    CONTINUE
      RETURN
C
C  DO BEFORE TRIANGULIZATION TEST
3     IPLC = 3HBE4
      GO TO 40
4     IPOVM =9
      IOVM =9
      NFOOV = IARG1 - IARG2
      WRITE K94PO,98
      GO TO 100
1000  CONTINUE
      KDLIN = 0.
      NFOOV = IARG1-IARG2
      WRITE K94PO,160,NFOOV
160   FORMAT(/////,4X,$MATRIX MAY HIT DATA$,5X,I8,/////)
      RETURN
C
C
90    FORMAT (4X,$WILL REQUIRE MORE AVAILABLE MEMORY$,10X,I7,I7/)
92    FORMAT (/,4X,$DATA AREA OVERLAPS MATRIX$/)
93    FORMAT (/,4X,$DATA AREA HITS PROGRAM$/)
95    FORMAT (/,4X,$ANY USE OF NOM. UNK. VALUES (SUCH AS PARTIALS)$/)
96    FORMAT (/,4X,$ANY ANALYSIS WHATSOEVER OF THIS CIRCUIT$/)
98    FORMAT (/,4X,$ENTRY OF BASIC DATA$/)
120   FORMAT (//,4X,$DIAG. NO.$,I4,$ BAD $,A3,$ REDUCTION$/,4X,
     1 $REAL =$,E15.8,4X,$IMAG. =$E15.8/)
      END
CIRCAC ** FICHE/FRAME BREAK *****
ACOP
C      /ACOP/-/BACOP/ PART OF  ACPT2
C      OPEN LOOP
       SUBROUTINE OPLP (IDR,IRNI,IRNZ              )
      DIMENSION JAB(  276  ),FAB(35),J(1),F(1)
      COMMON JAB,FAB,J,F
      CONTINUE
       EQUIVALENCE (JAB(169),K94FO)
      EQUIVALENCE (JAB( 30),MRES),(JAB( 40),KRES),(JAB( 50),NDQRES)
     1,(JAB( 60),NAMRES),(JAB( 70),MNPRES),(JAB( 80),NRES)
     2,(JAB( 90),IRES),(JAB(100),LRES),(JAB(110),JRES)
      EQUIVALENCE (FAB( 13),FREQ),(FAB( 17),W  ),(FAB( 18),TP    )
      EQUIVALENCE (FAB( 14),SFREQ),(FAB( 15),EFREQ),(FAB( 16),DELF  )
      EQUIVALENCE (FAB( 19),FREQK)
      EQUIVALENCE (JAB(276),NSEQ),(JAB(199),NSDE),(JAB(198),NUNK)
     1,(JAB(197),NDEQ),(JAB(196),NMDE)          ,(JAB(200),NSEQO)
      EQUIVALENCE (JAB(191),KOLPR),(JAB(192),KOPLP)
      EQUIVALENCE (JAB(190),LVR ),(JAB(189),LVI ),(JAB(188),LVA )
     1,(JAB(187),LVP )
      EQUIVALENCE (JAB(  1),JAB1),(JAB(  2),JAB2),(JAB(  3),JAB3)
     1,(JAB(  4),JAB4),(JAB(  5),JAB5),(JAB(  6),JAB6),(JAB(  7),JAB7)
C  .........          ..........          ..........          ..........
       IF(KOPLP) 3,1,2
1      RETURN
2      GO TO (5,6,7,5,8) KOPLP
5      KOUNT =0
8      KOUNT =KOUNT +1
       KOPLP=-1
       ROPLP=F(LRES-IDR*MRES)
       ASSIGN 11 TO IGT
27      IT1=IRNI
       IT2=IRNZ
       G=-1./ROPLP
C  BEFORE ACTUALLY REMOVING R
C  REMOVE ALL VOLTAGE AND CURRENT SOURCES
       DO 77 N=1,NSEQ
       DF=DS(N,0.)
77     CF=CS(N,0.)
10     CALL SMG(1,IT1,IT2,G,1)
       GO TO IGT
11     NZ=NSEQ-1
       NI=NSEQ
       ASSIGN 12 TO IGT
       IT1=IRNI
       IT2=NI
       G=2./ROPLP
       GO TO 10
12      IT1=IRNZ
       IT2=NZ
       ASSIGN 13 TO IGT
       GO TO 10
13     CF=CA(NI,1.)
       IF(KOUNT-1) 15,15,16
16     AF=AA(NZ,NZ,GR)
       BF=BA(NZ,NZ,GI)
15     CONTINUE
       RETURN
3      GRO=GR
       GIO=GI
       VR=F(LVR-NI)
       VI=F(LVI-NI)
       DEN=VR*VR+VI*VI
       GR=VR/DEN
       GI=-VI/DEN
       IF(ABSF(GR+GI-(GRO+GIO))-ABSF(GR+GI)*.0001) 20,20,21
21     KOPLP=5
       RETURN
20     KOPLP=2
       RETURN
6      KOPLP=3
       NZ=NSEQ
       ASSIGN 25 TO IGT
       GO TO 27
25     IT1=IRNZ
       IT2=NZ
       G=2./ROPLP
       ASSIGN 26 TO IGT
       GO TO 10
26     AF=AA(NZ ,NZ ,GR)
       BF=BA(NZ ,NZ ,GI)
       IT1=IRNI
       AF=AA(IT1,IT1, G)
       CF=CA(IT1, G)
       RETURN
7      KOPLP=4
       VR=F(LVR-NZ)
       VI=F(LVI-NZ)
       AMP=SQRT(VR*VR+VI*VI)
       PH=ATAN(VI,VR)*57.29578
       DB=20.*ALOG(AMP)/2.30258509
       DEN = GR*GR+GI*GI
       ZR=GR/DEN
       ZI=-GI/DEN
       WRITE K94FO,940
       WRITE K94FO,100,FREQ
       WRITE K94FO,940
       WRITE K94FO,100,AMP,PH,DB,ZR,ZI
       WRITE K94FO,940
30     RETURN
100    FORMAT (E14.7,4X,E14.7,4X,E14.7)
940    FORMAT (/)
       END
CIRCAC ** FICHE/FRAME BREAK *****
ACSP
FTC
I/MYEQ/
O/BMYEQ/

C
Q
FOS
(@6LA)ACL11B
(@6LA)ACESCB
/BMYEQ/
(@6LA)ACL12B
(@6LA)ACL13B
(@6LA)ACDMOB
(@6LA)ACSVMB
(@6LA)ACSOB
(@6LA)ACOPB
(@6LA)ACMSGB
(@6LA)ACDMSB
(@6LA)ACAAB
(@6LA)ACEQTB
(@6LA)ACPOPB
(@6LA)ACLIB
;L/ACNM/

;QCIRCAC
COM TEL
    B 