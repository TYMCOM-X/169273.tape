BATCH ** FICHE/FRAME BREAK *****
BATCH31
BATCH  IDENT   03-09-78 NEW BATCH FORMAT
*VERS 30 IMPLEMENTS NEW BATCH FILE FORMAT

DEBUG  EQU     -1              1=> DEBUG -1=> PRODUCTION
       BRU RES1  BRS 10


       ASC 'R13.00'
       ASC 'BLOOD'

MSG    POPD    100B5,2
M      LDB TOUT; EAX* 0; COPY XA,BX; ETR =37777B; LDB =-1; BRS 34
       BRR 0
PMSG1  POPD    101B5,2
       LDB FNO1; BRU M+1
CARRET POPD    102B5,2
       EAX* 0; CXA; ETR =37777B; CNA; CAX; LDA =155B; CIO FNO1
       BRX *-1; BRR 0
SPACE  POPD    103B5,2
       EAX* 0; CXA; ETR =37777B; CNA; COPY AX,A; CIO FNO1
       BRX *-1; BRR 0
PRIV   DATA 516B5
TEMP   ZRO
BUF    BSS 64
SYSNO  ZRO
       ASC '/'
FNO1   ZRO
TYMSW  ZRO
DIST   ZRO
CIN    ZRO
TOUT   ZRO
CINSW  DATA -1
TOUTSW DATA -1
EYN    ZRO; SKN CINSW; BRR EYN
       MIN EYN; BRR EYN
TEL    ZRO; LDA HTOUT; XMA TOUT; STA HTOUT; BRR TEL
HTOUT  DATA 1



CALLER ZRO
FRSW   ZRO


X      ZRO; SKN CINSW; BRR X; SKN TOUTSW; BRR X; BRM TEL; BRR X
RES1   STP CIN; SKG =0; STA CINSW; CBA; SKG =1; STA TOUTSW
       LDX =-1; LDA =4B4; BRS 12 (SET ECHO TABLE TO LINE EDIT)
RESET  CLA
       STA ERFLG
GLTCH  SKN CINSW; BRU *+2; BRU IN1; BRM TEL
       LDA =155B; CIO TOUT; CIO TOUT; LDA =32B; CIO TOUT (PRINT COLON)
IN1    BRM X; CIO CIN
       SNE =155B; BRU IN1
       SNE =0; BRU IN1
       LRSH 8
IN2    CIO CIN; SNE =0; BRU IN2; SNE =155B
       BRU CHK  1 CHAR. SEE IF IT IS Q OR ?
       LRSH 8
IN3    CIO CIN; SNE =0; BRU IN3; SNE =155B
       BRU ERR  2 CHARS
       LRSH 8
IN4    CIO CIN; SKE =155B; BRU IN4 WAIT FOR CR
       LDX =CTBL-CTBLND
       CBA  MOVE COMMAND INTO 'A' REGISTER
       SKE CTBLND,2  SEARCH FOR COMMAND; BRX *-1
       BRU* BTBLND,2  FALL THRU BRX MEANS COMMAND NOT FOUND
CHK    CLA
       LSH 8
       SKE =61B  (Q)
       BRU *+2
       BRS 10  QUIT
       SKE =37B  (QUESTION MARK)
       BRU ERR  NOT Q OR ?
       BRU HEL
ERR    BRM TEL; LDA ERFLG
       SKE =0
       BRU ERR1
       MIN ERFLG
       MSG ERMSG  PRINT ? AND CR
       BRM TEL
       BRU GLTCH
ERR1   MSG ERMSG1
       BRM TEL
       BRU RESET
CTBL   ASC 'PAC'
       ASC 'SNI'
       ASC 'REV'
       ASC 'AHC'
       ASC 'ERC'
       ASC 'IUQ'
       ASC 'LEH'
       ASC 'NUR'
CTBLND DATA 0
       DATA CAP
       DATA INS
       DATA VER
       DATA CHA
       DATA CRE
       DATA QUI
       DATA HEL
       DATA RUN
BTBLND DATA ERR
CAP    MSG MSG1
       BRU RESET
INS    SKN TYMSW; BRU *+2; BRU INS1
       MSG MSG2
       BRU RESET
INS1   MSG MSG2A; BRU RESET
VER    MSG MSG3
       BRU RESET
CHA    MSG MSG4
       BRU RESET
CRE    MSG MSG5
       BRU RESET
QUI    BRS 10
HEL    MSG MSG6
       BRU RESET
ERMSG  ASC '$ ?$/'
ERMSG1 ASC '$FOR ASSISTANCE, TYPE  HELP.$/'
MSG1   ASC '$CAPABILITIES:'
       ASC '$$CREATES A REQUEST FOR BATCH PROCESSING IN A FILE ACCESSABLE'
       ASC '$BY COMPUTER CENTER PERSONNEL.  THE PROGRAM ASKS CERTAIN'
       ASC '$QUESTIONS, AND THEN ALLOWS THE USER TO DESCRIBE THE WORK'
       ASC '$TO BE DONE IN FREE FORM, AS WELL AS ALLOWING HIM TO ENTER'
       ASC '$DELIVERY INSTRUCTIONS IN FREE FORM.$/'
MSG2   ASC '$INSTRUCTIONS:'
       ASC '$$THE PROGRAM WILL TYPE THE COMPUTER NUMBER, DATE AND TIME,'
       ASC '$THE PROCESSING REQUEST NUMBER, AND THE ACCOUNT NUMBER AND'
       ASC '$USER NAME TO WHICH THE USER IS LOGGED IN.'
       ASC '$THE PROGRAM WILL THEN ASK THE FOLLOWING:'
       ASC '$$  QUESTION               REPLY               TERMINATING CHAR.'
       ASC '$REQUESTED BY           YOUR NAME               CARRIAGE RET.'
       ASC '$COMPANY NAME          YOUR COMPANY             CARRIAGE RET.'
       ASC '$PROJECT CODE       PROJECT CODE OR NONE        CARRIAGE RET.'
       ASC  '$TELEPHONE NO. EXT. YOUR TELEPHONE NUMBER       CARRIAGE RET.'
       ASC '$WORK TO BE DONE    FREE FORM DESCRIPTION'
       ASC '$                   OF WHAT YOU WISH TO'
       ASC '$                   HAVE DONE.                  CONTROL D'
       ASC '$DEL. INSTRUCTIONS  ADDRESS FOR DISPATCHING'
       ASC '$                   FINISHED WORK.  ENTRY IS'
       ASC '$                   IN FREE FORM.               CONTROL D'
       ASC '$$IF NECESSARY, THE REPLIES TO THE FIRST FOUR QUESTIONS ABOVE,'
       ASC '$MAY BE CONTINUED TO ANOTHER LINE BY TYPING A LINE FEED.'
       ASC '$A CONTROL A MAY BE USED TO DELETE CHARACTERS UP TO THE LAST'
       ASC '$CARRIAGE RETURN TYPED.$/'
MSG2A  ASC '$INSTRUCTIONS:'
       ASC '$$THESE INSTRUCTIONS ONLY APPLY IF YOU HAVE LOGGED INTO A'
       ASC '$TYMSHARE ACCOUNT.  CUSTOMERS RECEIVE A DIFFERENT SET OF'
       ASC '$INSTRUCTIONS.'
       ASC '$$THE PROGRAM WILL TYPE:'
       ASC '$INHOUSE? Y OR N'
       ASC '$REPLY WITH A Y IF THE REQUEST IS FOR YOUR OWN ACCOUNT.'
       ASC '$REPLY WITH A N IF YOU ARE TRANSMITING A REQUEST FOR A'
       ASC '$CUSTOMER.'
       ASC '$THE PROGRAM WILL THEN TYPE THE COMPUTER NUMBER, DATE AND'
       ASC '$TIME, THE PROCESSING REQUEST NUMBER, AND THE ACCOUNT NUMBER'
       ASC '$AND USER NAME YOU ARE LOGGED INTO.'
       ASC '$THE PROGRAM WILL THEN ASK THE FOLLOWING:'
       ASC '$$  QUESTION               REPLY               TERMINATING CHAR.'
       ASC '$FOR USER NAME **   ENTER USER NAME AS'
       ASC '$                   VALIDATED ON THIS'
       ASC '$                   SYSTEM.                     CARRIAGE RET'
       ASC '$REQUESTED BY       YOUR NAME IF FOR YOUR'
       ASC '$                   OWN ACCT. ELSE THE'
       ASC '$                   NAME OF THE INDIVIDUAL'
       ASC '$                   REQUESTING THE WORK.        CARRIAGE RET.'
       ASC '$COMPANY NAME  **   NAME OF THE COMPANY'
       ASC '$                   A LINE FEED MAY BE USED'
       ASC '$                   TO CONTINUE ON NEXT LINE.   CARRIAGE RET.'
       ASC '$PROJECT CODE       PROJECT CODE OR NONE        CARRIAGE RET.'
       ASC '$TELEPHONE NO. EXT. YOUR TELEPHONE NUMBER'
       ASC '$                   OR THE CUSTOMERS.           CARRIAGE RET.'
       ASC '$RECEIVED BY  **    YOUR NAME                   CARRIAGE RET.'
       ASC '$WORK TO BE DONE    FREE FORM DESCRIPTION'
       ASC '$                   OF WHAT IS TO BE DONE.      CONTROL D'
       ASC '$DEL. INSTRUCTIONS  ADDRESS FOR DISPATCHING'
       ASC '$                   FINISHED WORK.  ENTRY IS'
       ASC '$                   IN FREE FORM.               CONTROL D'
       ASC '$$NOTE:  QUESTIONS MARKED ** ARE ONLY ASKED IF YOUR REPLY'
       ASC '$TO THE INHOUSE? QUESTION WAS N.'
       ASC '$$A CONTROL A MAY BE USED TO DELETE CHARACTERS UP TO BUT NOT'
       ASC '$BEYOND THE LAST CARRIAGE RETURN TYPED.$/'
MSG3   ASC '$VERSION 31  APRIL 1978$/'
MSG4   ASC '$NO PREMIUM CHARGE$/'
MSG5   ASC '$WRITTEN BY TYMSHARE$/'
MSG6   ASC '$$LEGAL COMMANDS:'
       ASC '$$     HELP  (OR) ?   REPRINTS THIS LIST'
       ASC '$     CAPABILITIES   DESCRIBES PROGRAM CAPABILITIES'
       ASC '$     INSTRUCTIONS   HOW TO EXECUTE THE PROGRAM'
       ASC '$     CREDITS        THOSE RESPONSIBLE FOR THIS PROGRAM'
       ASC '$     CHARGES        ADDITIONAL COST (IF ANY)'
       ASC '$     VERSION        LATEST UPDATE'
       ASC '$     RUN            BEGINS EXECUTION'
       ASC '$     QUIT  (OR) Q   QUITS TO EXEC'
       ASC '$$     ANY OF THESE COMMANDS MAY BE SHORTENED TO THE'
       ASC '$     FIRST THREE LETTERS$/'
ERFLG  BSS 1

RUN    BRM SETUP
       SKN TYMSW; BRM NSPOOL; BRM SPOOL
       SKN TYMSW; BRU *+2; BRM IHOUSE; BRM TEL; MSG M1; MSG M2
       MSG SYSNO
       MSG M3; BRM GDATE; LDA =DASTG; LDB DATSIZ; LDX TOUT; BRS 34
       BRM NOREQ; MSG M4; LDA =CNAM; LDB NAMSIZ; LDX TOUT
       BRS 34; SKN SAMESW; BRU *+2; BRU RUN1
       MSG M4A; LDA =GFDNAM; LDB FNAMSI; LDX TOUT; BRS 34
RUN1   SKN TRANSW; BRU *+2; BRM GCUST
       SKN TRANSW; BRU RUN1B; MSG M5A; LDA *-1; SKN TOUTSW
       BRU RUN1C; BRM TANDT
RUN1B  MSG M5; LDA *-1; SKN TOUTSW; BRU RUN1C; BRM TANDT
RUN1C  LDP REQPTR; STP STGPTR; BRM GTSTG
       LDP STGPTR; STP REQPTR; LDA REQPTR+1; SUB REQPTR; STA REQSIZ
       SKN TYMSW; BRU RUN2; SKN TRANSW; BRU RUN3
RUN2   MSG M6; LDA *-1; SKN TOUTSW; BRU *+2; BRM TANDT
       LDP COPTR; STP STGPTR; BRM GTSTG
       LDP STGPTR; STP COPTR; LDA COPTR+1; SUB COPTR; STA COSIZE
RUN3   MSG M7; LDA *-1; SKN TOUTSW; BRU *+2; BRM TANDT
       LDP PROJPT; STP STGPTR; BRM GTSTG
       LDP STGPTR; STP PROJPT; LDA PROJPT+1; SUB PROJPT; STA PROJSI
       MSG M8; LDA *-1; SKN TOUTSW; BRU *+2; BRM TANDT
       LDP PHOPT; STP STGPTR; BRM GTSTG
       LDP STGPTR; STP PHOPT; LDA PHOPT+1; SUB PHOPT; STA PHOSIZ
       SKN TRANSW; BRU *+2; BRM GREC
       CLA; STA WORKSW
       MSG M9; LDA *-1; SKN TOUTSW; BRU *+2; BRM TANDT
       LDA =155B; CIO TOUT; CIO TOUT; LDP WORKPT; STP STGPTR
       BRM GTSTG; LDP STGPTR; STP WORKPT; LDA WORKPT+1; SUB WORKPT
       STA WORKSI
       MSG M10; LDA *-1; SKN TOUTSW; BRU *+2; BRM TANDT
       LDA =155B; CIO TOUT; CIO TOUT; LDP DELPT; STP STGPTR
       BRM GTSTG; LDP STGPTR; STP DELPT; LDA DELPT+1; SUB DELPT
       STA DELSIZ
       BRU RUN4
TANDT  ZRO; STA TANDT1; SKN CINSW; BRU *+2; BRR TANDT; BRM TEL
TANDT1 ZRO; BRM TEL; BRR TANDT
*CREATE @BA RECORD

RUN4   LDA BAFNO; STA FNO1; BRS 113
       PMSG1 M2; PMSG1 SYSNO; CARRET 2
       BRM WDAT
       PMSG1 NUMSG; LDA REQNO; BRM PDNUM; PMSG1 M11;  CARRET 1
       PMSG1 M4; LDX FNO1; LDA =CNAM; LDB NAMSIZ
       BRS 34; CARRET 1; SKN SAMESW; BRU *+2; BRU RUN4A
       PMSG1 M4A; LDB FNAMSI; LDX FNO1; LDA =GFDNAM
       BRS 34; CARRET 1
RUN4A  SKN TRANSW; BRU RUN5; BRM WCUST; SKN TRANSW; BRU RUN5
       PMSG1 M5; BRU RUN5+1
RUN5   PMSG1 M5; LDP REQPTR; LDX FNO1; BRS 35; CARRET 1
       SKN TYMSW; BRU RUN6; SKN TRANSW; BRU RUN7
RUN6   PMSG1 M6; LDP COPTR; LDX FNO1; BRS 35; CARRET 1
RUN7   PMSG1 M7; LDP PROJPT; LDX FNO1; BRS 35; CARRET 1
       PMSG1 M8; LDP PHOPT; LDX FNO1; BRS 35
       PMSG1 MDIST; LDX FNO1; LDA DIST; LDB =10; BRS 36; CARRET 1
       PMSG1 GANMSG; LDX FNO1; LDB =8; LDA CGAN; BRS 36; CARRET 1
       SKN TRANSW; BRU *+2; BRM WREC
       PMSG1 WKMSG; CARRET 2; LDP WORKPT; LDX FNO1; BRS 35
       PMSG1 DELMSG; CARRET 2; LDP DELPT; LDX FNO1; BRS 35; CARRET 2
       PMSG1 BAMSG

*A TEMP. MESSAGE ON OPERATORS COPY OF BATCH REQUEST TO REMIND TO
*USE 1BCHARGE TO ENTER BATCH CHARGES

       CARRET 3;*PMSG1 REMMSG
*      CARRET 6
       LDA BAFNO; BRS 2
       SKN FRSW; BRM MKREC

*CREATE @BAHOLD RECORD

       BRM OBAHOL
       LDA HOLFNO; SNE =-1; BRU RUN11 (FILE NEVER OPENED SO MUST SKIP)
       STA FNO1; CARRET 3
       LDA REQNO; BRM PDNUM; CARRET 1
       BRM WDAT
       SKN TYMSW; BRU RUN8; SKN TRANSW; BRU RUN9; LDP CUSTPT; LDX FNO1
       BRS 35
RUN8   LDP COPTR; LDX FNO1; BRS 35; CARRET 1
RUN9   LDA =CNAM; LDB NAMSIZ; LDX FNO1; BRS 34; SKN SAMESW
       BRU *+2; BRU RUN10; SPACE 1; LDA =GFDNAM; LDB FNAMSI; LDX FNO1; BRS 34
RUN10  CARRET 1; LDP PROJPT; LDX FNO1; BRS 35
       LDP REQPTR; XAB; SUB =1; XAB; LDX FNO1; BRS 35
       SPACE 2; LDP PHOPT; LDX FNO1; BRS 35
       LDP WORKPT; LDX FNO1; BRS 35; LDP DELPT; LDX FNO1; BRS 35
       CARRET 2; LDA HOLFNO; BRS 2
RUN11  BRS 147; BRS 114; BRM TEL; MSG THANKS; MSG EOJ; BRS 10

GDATE  ZRO; LDP DTPTR; BRS 91; STP DTPTR; BRR GDATE
DTPTR  DATA 3*DASTG-1,3*DASTG-1
DATSIZ DATA 12
DASTG  BSS 4
REQPTR DATA 3*REQSTG-1,3*REQSTG-1
REQSTG BSS 90
REQSIZ ZRO
STGPTR BSS 2
COPTR  DATA 3*COSTG-1,3*COSTG-1
COSTG  BSS 90
COSIZE ZRO
PROJPT DATA 3*PROJ-1,3*PROJ-1
PROJ   BSS 30
PROJSI ZRO
PHOPT  DATA 3*PHO-1,3*PHO-1
PHO    BSS 30
PHOSIZ ZRO
WORKPT DATA 3*WORK-1,3*WORK-1
WORK   BSS 600
WORKSI ZRO
DELPT  DATA 3*DEL-1,3*DEL-1
DEL    BSS 300
DELSIZ ZRO
WORKSW DATA 77777777B
GTSTG  ZRO; CLA; STA CHCNT; BRM CLBUF
GTSTG1 CIO CIN; BRM STGECH; SKE =155B; BRU GTSTG2
       WCI STGPTR; SKN WORKSW
       BRU *+2; BRR GTSTG
GTSTG6 CLA; STA CHCNT; BRU GTSTG1
GTSTG2 SKN WORKSW; BRU *+2; BRU GTSTG3; SKE =144B; BRU *+2
       BRR GTSTG
GTSTG3 SKE =152B; BRU GTSTG4; LDA =155B; WCI STGPTR
       SKN WORKSW; BRU GTSTG6; LDX =-25; CLA; WCI STGPTR; CIO TOUT
       BRX *-2; BRU GTSTG1
GTSTG4 SKE =141B; BRU GTSTG5; BRM CONTA; BRU GTSTG1
GTSTG5 WCI STGPTR; SKN WORKSW; BRU *+2; BRU GTSTG1
       MIN CHCNT; LDA CHCNT; SKG =70; BRU GTSTG1
       LDA =155B; WCI STGPTR; BRU GTSTG6
CHCNT  ZRO
STGECH ZRO; SKE =144B; BRU *+2; BRR STGECH
       SKN TOUTSW; BRU *+3; CIO TOUT; BRR STGECH
       SKN CINSW; BRR STGECH; CIO TOUT; BRR STGECH
CONTA  ZRO; GCD STGPTR; NOP; LDA =77B; CIO TOUT; BRU GTSTG1
NOREQ  ZRO; BRM OBNUM; LDA NUMFNO; SNE =-1; BRU NOREQ3 (FILE NEVER OPENED)
       WIO NUMFNO; SNE =0; BRU NOREQ2; SKG =999; BRU *+2; BRU NOREQ2
NOREQ1 STA REQNO; LDA =4B7; SCP NUMFNO; HLT 0; LDA REQNO; ADD =1
       SNE =1000; LDA =1; WIO NUMFNO; LDA NUMFNO; BRS 2; BRU NOREQ4
NOREQ2 BRS 42; ETR =77B; BRU NOREQ1
NOREQ3 BRS 42; ETR =77B; STA REQNO
NOREQ4 BRM MKNUM; STA REQNO; MSG NUMSG; LDA REQNO; BRM TDNUM; BRR NOREQ
TDNUM  ZRO; CAB; SKG =9999; BRU *+2; BRU TDNUM1; LDA =20B; CIO TOUT
TDNUM1 CBA; BRM TDNO; BRR TDNUM
PDNUM  ZRO; CAB; SKG =9999; BRU *+2; BRU PDNUM1; LDA =20B; CIO FNO1
PDNUM1 CBA; BRM PDNO; BRR PDNUM
MKNUM  ZRO; CLA; STA WKWORD; LDA NOSYS; LRSH 23; DIV =10
       STA WKWORD; CBA; XMA WKWORD; MUL =10; LSH 23; ADM WKWORD
       LDA REQNO; LRSH 23; DIV =10; STB T3; LRSH 23; DIV =10
       STB T2; XMA WKWORD; MUL =10; LSH 23; ADM WKWORD
       LDA T2; XMA WKWORD; MUL =10; LSH 23; ADM WKWORD
       LDA T3; XMA WKWORD; MUL =10; LSH 23; ADM WKWORD
       LDA WKWORD; BRR MKNUM
WKWORD ZRO
T2     ZRO
T3     ZRO
FRFIL  ASC '@FR'
TDNO   ZRO; LDB =10; LDX TOUT; BRS 36; BRR TDNO


M1     ASC '$$BATCH PROCESSING REQUEST/'
M2     ASC '$COMPUTER NO. /'
M3     ASC '$DATE AND TIME            /'
M4     ASC '$ENTERED BY               /'
M4A    ASC '$FROM THE DIRECTORY OF    /'
M4B    ASC '$FOR USER NAME            /'
M5     ASC '$REQUESTED BY             /'
M5A    ASC  'REQUESTED BY             /'
M6     ASC 'COMPANY NAME             /'
M7     ASC 'PROJECT CODE             /'
M8     ASC 'AREA-PHONE-EXT           /'
M9     ASC '$DESCRIBE WORK TO BE PERFORMED./'
M10    ASC '$TYPE DELIVERY INSTRUCTIONS./'
M11    ASC     '      CONTROL # ------  QA BY:-------/'
MDIST  ASC '$DISTRICT                 /'
NUMSG  ASC '$PROCESSING REQUEST NO.   /'
GANMSG ASC '$GAN                      /'
BAMSG  ASC '$$1.--------PAGES -------PARTS TO LISTING -------LISTINGS DECOLLATED'
       ASC '$$2.------------CARDS TO DISC   3.-------------DISC TO CARDS'
       ASC '$$4.------------FILES TAPE TO DISC'
       ASC '$$5.------------FILES DISC TO TAPE ------------TAPE PURCHASE'
       ASC '$$7.------------TAPE CONVERSION -----FILES ----TAPE PURCHASE'
 ASC '$$8.------------EUROPEAN STORE RESTORE -----TAPE PURCHASE -------CHARS'
 ASC '$$12.-----------TAPE PURCHASE ONLY  13.-------------POSTAGE CHARGE ONLY'
       ASC '$$----------------------COMPLETED BY  ------------DATE'
       ASC '$$--------------POSTAGE -------------ENTERED INTO ACCOUNTING/'
REMMSG ASC '$NOTE:  1BCHARGE MUST BE USED TO ENTER BATCH CHARGES FOR THIS'
       ASC '$REQUEST./'
WKMSG  ASC '$$DESCRIPTION OF WORK./'
DELMSG ASC '$$DELIVERY INSTRUCTIONS./'
THANKS ASC '$$THANK YOU./'
EOJ    ASC '$$END OF JOB/'
REQNO  ZRO
PDNO   ZRO; LDX FNO1; LDB =10; BRS 36; BRR PDNO
WDAT   ZRO; LDA =DASTG; LDB DATSIZ; LDX FNO1; BRS 34; CARRET 1
       BRR WDAT
CLBUF  ZRO; LDA =155B; CIT CIN; BRR CLBUF; BRU *-2
IHOUSE ZRO; BRM EYN; MSG IHMSG; BRM CLBUF; CIO CIN
       LRSH 8
       CIO CIN; SKG =77B; BRU *-2; CLA; LSH 8; SKE ='   Y'
       BRU *+2; BRR IHOUSE; SKE ='   N'; BRU IHOUSE+1
       SKR TRANSW; BRU *-1; BRR IHOUSE
GCUST  ZRO; MSG M4B; LDA *-1; SKN TOUTSW; BRU *+2; BRM TANDT
       LDP CUSTPT; STP STGPTR
       BRM GTSTG; LDP STGPTR
       STP CUSTPT; LDA CUSTPT+1; SUB CUSTPT; STA CUSTSI
       BRM VCUST; BRR GCUST; CLA; LDX =-30; STA CUST+30,2
       LDP HCUSTP; STP CUSTPT; BRU GCUST+1
GREC   ZRO; MSG M4C; LDA *-1; SKN TOUTSW; BRU *+2; BRM TANDT
       LDP RECPTR; STP STGPTR; BRM GTSTG; LDP STGPTR
       STP RECPTR; LDA RECPTR+1; SUB RECPTR; STA RECSIZ; BRR GREC
WCUST  ZRO; PMSG1 M4B; LDP CUSTPT; LDX FNO1; BRS 35; CARRET 1
       BRR WCUST
WREC   ZRO; CARRET 1; LDP RECPTR; LDX FNO1; BRS 35; BRR WREC
HCUSTP DATA 3*CUST-1,3*CUST-1
CUSTPT DATA 3*CUST-1,3*CUST-1
CUST   BSS 30
CUSTSI ZRO
RECPTR DATA 3*REC-1,3*REC-1
REC    BSS 90
RECSIZ ZRO
M4C    ASC '$RECEIVED BY              /'
IHMSG  ASC '$INHOUSE? Y OR N /'
TRANSW ZRO
VCUST  ZRO; GCD STGPTR; NOP; CLA; WCI STGPTR
       CLA; LDX =-4; ADD CUST+4,2; BRX *-1
       LRSH 23; DIV =887; STB BLNO; CBA; SKG =895; BRU *+2; HLT
VCUST1 LDA BLNO; LRSH 23; DIV =128; STB NTEMP; CLB; LSH 13
       ADD =320200B; ADD NTEMP; CAB; LDA =LBUF; LDX =100B
       BRS 124; EAX LBUF
VCUST2 LDA 0,2; SKE =0; BRU *+2; BRU VCUSTB
       SKE =-1; BRU *+3; MIN BLNO; BRU VCUST1
       SKE =-2; BRU *+2; BRU VCUST3
       SKE CUST; BRU VCUST3
       LDA 1,2; SKE CUST+1; BRU VCUST3
       LDA 2,2; SKE CUST+2; BRU VCUST3
       LDA 3,2; SKE CUST+3; BRU VCUST3
       LDA 6,2; ETR =1777777B; STA CGAN; LDA 8,2; RSH 2; ETR =377B
       STA DIST; LDA 7,2; ETR =377777B; STA CUSER
       BRR VCUST
VCUST3 EAX 9,2; BRU VCUST2
VCUSTB MSG BCUST; MIN VCUST; BRR VCUST
BCUST  ASC '$NOT A VALID USER ON THIS SYSTEM/'

*GET FILE DIRECTORY NUMBER OF *1BATCH

GBUN   ZRO; LDX =-4; LDA BNAME+4,2; STA NAME+4,2; BRX *-2
       BRM GDIR; STA BUNO; BRR GBUN

*GET FILE DIRECTORY NUMBER OF *4ACCT

GAUN   ZRO; LDX =-4; LDA ANAME+4,2; STA NAME+4,2; BRX *-2
       BRM GDIR; STA AUNO; BRR GAUN
GDIR   ZRO; LDX =-4; CLA; ADD NAME+4,2; BRX *-1; LRSH 23; DIV =887
       STB BLNO; BRM RBLK; BRU GDIR2
RBLK   ZRO; LDA BLNO; LRSH 23; DIV =128; STB TEMP; CLB; LSH 13
       ADD =320200B
       ADD TEMP; CAB; LDA =BUF; LDX =100B; BRS 124; EAX BUF; BRR RBLK
GDIR2  STX BLX; LDA 0,2; SKE =0; BRU *+2; BRU NOGOOD
       SKE =-1; BRU *+4; MIN BLNO; BRM RBLK; BRU GDIR2
       SKE =-2; BRU *+2; BRU GDIR3; SKE NAME; BRU GDIR3
       LDA 1,2; SKE NAME+1; BRU GDIR3; LDA 2,2; SKE NAME+2
       BRU GDIR3; LDA 3,2; SKE NAME+3; BRU GDIR3; LDA 4,2
       BRR GDIR
GDIR3  EAX 9,2; BRU GDIR2
       IF      DEBUG
       REM     DEBUSION
BNAME  ASC     'CCARTER     '
ANAME  ASC     'CCARTER     '
       ELSE
BNAME  ASC '*1BATCH     '
ANAME  ASC '*4ACCT      '
       ENDF
NAME   BSS 4
BUNO   ZRO
AUNO   ZRO
NOGOOD MSG NONO; BRS 10
NONO   ASC '$THIS PROGRAM CANNOT BE USED ON THIS SYSTEM$/'
NOSYS  ZRO

MLUDT  ZRO; LDA 30000B; CLA; STA BLNO; BRM RPAGE
MLUDT1 LDA BLNO; SKG =896; BRU *+2; BRM TRAP
       LRSH 23; DIV =128; STB NTEMP; CLB; LSH 13; ADD =320200B
       ADD NTEMP; SKG EDISC; BRU *+2; BRM RPAGE; LDX BLX
MLUDT2 LDA 0,2; SKE =0; BRU *+2; BRU NBLK; SKE =-2; BRU *+2
       BRU MLUDT3; SKE =-1; BRU *+2
       BRU NBLK; LDA 4,2; SKE CALLER; BRU MLUDT3; BRR MLUDT
MLUDT3 EAX 9,2; BRU MLUDT2
NBLK   LDA =64; ADM BLX; MIN BLNO; BRU MLUDT1

RPAGE  ZRO; LDA BLNO; LRSH 23; DIV =128; STB NTEMP; CLB; LSH 13
       ADD NTEMP; ADD =320200B; CAB; LDA =LBUF; LDX =4000B
       BRS 124; CBA; ADD =37B; STA EDISC; EAX BUF
       STX BLX; BRR RPAGE

LBUF   EQU 30000B
EDISC  ZRO
BLX    ZRO
NTEMP   ZRO
GTUSER ZRO; LDA =8; LDB =CALLER; LDX =1; BRS 67
       LDA =31; LDB =ACCT; LDX =2; BRS 67
       LDA BLNO; ETR =1777B; XMA BLNO; RSH 10; STA BADR
       BRM RBLK; LDX BADR; LDP 0,2; STP NAMBF; LDP 2,2; STP NAMBF+2
       LDA 4,2; SKE CALLER; BRU GTU1
       SKR SAMESW; BRU *-1; LDA CALLER; STA GFDNO; BRR GTUSER
GTU1   BRM MLUDT; XMA CALLER; STA GFDNO; LDP 0,2
       STP NAMBF1; LDP 2,2; STP NAMBF1+2; BRM GTUSER
ACCT   ZRO
BLNO   ZRO
BADR   ZRO
NAMBF  BSS 4
NAMBF1 BSS 4
SAMESW ZRO
GFDNO  ZRO
TRAP   ZRO
       MSG MTRAP; LDA TRAP; ETR =37777B; BRM TONO
       LDA =155B; CIO TOUT; MSG MTRAP1; BRS 10
MTRAP  ASC '$PROGRAM INSTRUCTION TRAP AT /'
MTRAP1 ASC '$NOTIFY YOU TYMSHARE REPRESENTATIVE$/'
TONO   ZRO; LDX TOUT; LDB =8; BRS 36; BRR TONO
GUSER  ZRO; LDA =8; LDX =1; LDB =CFDPT; BRS 67; LDA =31D
       LDX =3; LDB =GAN; BRS 67; LDA FDLUDL; SKE LUDL; BRU *+3
       SKR SAMESW; BRU *-1; LDA LUDL; ETR =1777B; STA BLNO
       LDA LUDL; LRSH 10; ADD =BUF; STA LUDL; BRM RBLK
       LDX LUDL; LDA 4,2; SKE CFDPT; BRM TRAP; LDP 0,2; STP CNAM
       LDP 2,2; STP CNAM+2; LDA 6,2; ETR =1777777B; SKE GAN
       BRM TRAP; STA CGAN; LDA 7,2; ETR =377777B; STA CUSER
       LDA =3; STA NCNT
NAMS   LDX NCNT; LDA CNAM,2; SKR NCNT; SKE =0
       BRU NAMS1; LDA =-3; ADM NAMSIZ; BRU NAMS
NAMS1  ABC; STA NCNT; LDX =-3; CLA; RCY 8; SKE =0; BRU *+3
       MIN NCNT; BRX *-5; LDA NCNT; CNA; ADM NAMSIZ
       SKN SAMESW; BRU *+2; BRU GUSER1
       LDA FDLUDL; ETR =1777B; STA BLNO; LDA FDLUDL; LRSH 10
       ADD =BUF; STA FDLUDL
       BRM RBLK; LDX FDLUDL; LDP 0,2; STP GFDNAM; LDP 2,2
       STP GFDNAM+2; LDA 4,2; STA GFDFDP; LDA 6,2; ETR =1777777B
       STA GFDGAN; LDA =3; STA NCNT
FNAMS  LDX NCNT; LDA GFDNAM,2; SKR NCNT; SKE =0
       BRU FNAMS1; LDA =-3; ADM FNAMSI; BRU FNAMS
FNAMS1 ABC; STA NCNT; LDX =-3; CLA; RCY 8; SKE =0; BRU *+3
       MIN NCNT; BRX *-5; LDA NCNT; CNA; ADM FNAMSI; BRR GUSER
       ADM FNAMSI; BRR GUSER
GUSER1 LDA =-1; STA GFDNAM; CLA; STA FNAMSI; BRR GUSER
CFDPT  ZRO
GAN    ZRO
FDLUDL ZRO
LUDL   ZRO
GFDNAM BSS 4
GFDFDP ZRO
GFDGAN ZRO
CNAM   BSS 4
FDPTC  EQU CFDPT
CGAN   ZRO
CUSER  ZRO
CPARW  ZRO
NAMSIZ DATA 12
FNAMSI DATA 12
NCNT   ZRO


*OPEN NECESSARY FILES EXCEPT BAHOLD TO PRECLUDE USE BY MORE THAN ONE USER
*ALSO SET UP PARAMETERS

SETUP  ZRO; BRS 39; STA CPARW; RSH 2; ETR =377B; STA DIST; SKN CPARW
       BRU *+3; SKR TYMSW; BRU *-1
       LDA =BUF; LDB =200B; LDX =100B; BRS 124
       LDA BUF+77B; STA SYSNO; LDA BUF+75B; LRSH 12; STA NOSYS
*      SNE =18;*BRU SET1;*SNE =11;*BRU SET1;*SKE =16;*BRU SET2
SET1 LDA DIST; SKG =79; SKG =69; BRU *+2; BRU SET1A; SKE =31; BRU *+2; BRU SET2
       SKG =39 (AREA 3 IS FRENCH EXCEPT 31 BELGIUM); SKG =29; BRU SET2
SET1A  LDA FRFIL; STA BA+3; STA BNUM+3; SKR FRSW; BRU *-1
SET2   BRM GAUN; BRM GBUN; BRM GUSER; LDA GAN; STA CGAN
       BRM OPENBA; BRR SETUP

*FILE OPENING ROUTINES

*GET INDEX BLOCK POINTER

GIP    ZRO; LDB =FILDAT; LDX =5; BRS 96; LDA FILDAT+4; BRR GIP
FILDAT BSS 10

*OPEN A FILE IN WRITE MODE EXPECT POINTERS IN FILPT AND BACKUP FILE
*POINTERS IN FILPT1 ALSO FILE DIR NUMBER IN FUNO, NO SKIP UNSUCESSFUL WITH
*ERROR NUMBER IN X, SKIP SUCESSFUL WITH FILE NUMBER IN A
*IF BACKUP FILE OPENED X WILL CONTAIN A MINUS ONE

OPFIL  ZRO; CLA; STA SECSW; STA BUSCNT; STA FBSW; STA BACKSW
OPFI4  LDP FILPT; BRS 48; BRU OPFI1 (NOT THERE MAKE IT)
       BRM GIP (GET INDEX BLOCK POINTER)
       LDB =42B (OUTPUT WRITE MODE)
       LDX FUNO; BRS 193; BRU OPFI2 (FILE OPENING ERROR)
       MIN OPFIL; BRR OPFIL
OPFI1  LDP FILPT; MRG PRIV; LDX FILTYP; BRS 65; BRU OPFI2 (OPEN ERROR)
       SKN BACKSW; BRU *+2; LDX =-1; MIN OPFIL; BRR OPFIL
OPFI2  CXA; SKE =1 (FILE BUSY); BRU *+3
OPFI3  BRM BUSY; BRU OPFI4; SNE =30 (GROUP BUSY); BRU OPFI3
       SKN SECSW; BRU *+2; BRR OPFIL (ALSO FAILED WITH BACKUP FILE - QUIT)
       SKR SECSW; BRU *-1; LDP FILPT1; SNE =-1; BRR OPFIL (NO BACKUP FILE)
       STP FILPT; SKR BACKSW; BRU *-1; BRU OPFI4 (OPEN BACKUP FILE)

*FILE BUSY ROUTINE IF PROGRAM CALLED FROM COMMANDS FILE KEEP TRYING
*UNTIL USER TYPES ALTMODE OR UNTIL SUCESSFUL IN OPENING FILE

BUSY   ZRO; SKN BUSYSW; BRU *+2; BRR OPFIL (NO RETRY ON BUSY)
       SKN FBSW; BRU 1BUSY
       LDA BUSCNT; SKG =5; BRU 2BUSY; BRM TEL
       MSG FBUSY1 (PROGRAM STILL BUSY - WAITING)
       CLA; STA BUSCNT
2BUSY  SKR FBSW; BRU *-1; MIN BUSCNT; LDA =10000; BRS 81
       BRR BUSY
1BUSY  BRM TEL; MSG FBUSY2; BRU 2BUSY
FBUSY1 ASC '$PROGRAM STILL BUSY - WAITING$/'
FBUSY2 ASC '$SOMEONE ELSE IS USING THE PROGRAM, WILL WAIT UNTIL'
       ASC '$IT BECOMES FREE UNLESS YOU TYPE ALTMODE$/'
BUSCNT ZRO
FBSW   ZRO
SECSW  ZRO
BUSYSW ZRO
FILTYP ZRO
BACKSW ZRO

*FILE POINTERS
       IF DEBUG
BA     ASC '(CCARTER)@BA'
BNUM   ASC '(CCARTER)@BATCHNUM1'
BAHOLD ASC '(CCARTER)/@BAHO'
       DATA 13022143B (LD&C)
       DATA 36007400B (&X/)
BAREC  ASC '(CCARTER)RECBATCHA'
BAPT   DATA 3*BA-1,3*BA-1+12
BNUMP  DATA 3*BNUM-1,3*BNUM-1+19
BAHOLP DATA 3*BAHOLD-1,3*BAHOLD-1+20
BRECP  DATA 3*BAREC-1,3*BAREC-1+17
BBRECP DATA 3*BAREC-1,3*BAREC-1+18
       ELSE

BA     ASC '(*1BATCH)@BA'
BNUM   ASC '(*1BATCH)@BATCHNUM1'
BAHOLD ASC '(OPER)/@BAHO'
       DATA 13022143B (LD&C)
       DATA 36007400B (&X/)
BAREC  ASC '(*4ACCT)RECBATCHA'
BAPT   DATA 3*BA-1,3*BA-1+12
BNUMP  DATA 3*BNUM-1,3*BNUM-1+19
BAHOLP DATA 3*BAHOLD-1,3*BAHOLD-1+17
BRECP  DATA 3*BAREC-1,3*BAREC-1+16
BBRECP DATA 3*BAREC-1,3*BAREC-1+17
       ENDF
FILPT  BSS 2
FILPT1 BSS 2
FUNO   ZRO

*OPEN (*1BATCH)@BA FOR US CUSTOMERS AND (*1BATCH)@FR FOR FRENCH CUSTOMERS

OPENBA ZRO; LDP BAPT; STP FILPT; LDA =-1; STA FILPT1; LDA BUNO; STA FUNO
       LDA =3; STA FILTYP
       BRM OPFIL; BRU OPBA1; STA BAFNO; RSP BAFNO; MRG =4B7
       SCP BAFNO; HLT 0; BRR OPENBA
BAFNO  ZRO
OPBA1  BRM TEL; MSG MOPBA; BRS 10
MOPBA  ASC '$UNABLE OPEN BATCH FILE - PLEASE NOTIFY TYMSHARE$/'

*OPEN (*1BATCH)@BATCHNUM 

OBNUM  ZRO
OBNUM4 SKR BUSYSW; BRU *-1
       LDP BNUMP; STP FILPT; LDA =-1; STA FILPT1 (NO BACKUP FILE)
       LDA BUNO; STA FUNO; LDA =2; STA FILTYP
       BRM OPFIL; BRU OBNUM1; STA NUMFNO; CLA; SCP NUMFNO; HLT 0
       BRR OBNUM
OBNUM1 CXA; SNE =1; BRU OBNUM3; SNE =30; BRU OBNUM3
OBNUM2 LDA =-1; STA NUMFNO (FLAG TO INDICATE WAS UNABLE OPEN NUMBER FILE)
       CLA; STA BUSYSW; BRR OBNUM
OBNUM3 MIN OBCNT; LDA OBCNT; SNE =10; BRU OBNUM2
       LDA =5000; BRS 81; BRU OBNUM4
OBCNT  ZRO
NUMFNO ZRO

*OPEN (OPER)/@BAHOLD&C&X/

OBAHOL ZRO; LDP BAHOLP; STP FILPT; LDA =-1; STA FILPT1 (NO BACKUP FILE)
       LDA =3; STA FILTYP; LDA =25B; STA FUNO
       SKR BUSYSW; BRU *-1 (SET TO NO BUSY RETRY)
       BRM OPFIL; BRU OBAH1 (FAILURE); STA HOLFNO
       RSP HOLFNO; MRG =4B7; SCP HOLFNO; HLT 0; BRR OBAHOL
OBAH1  LDA =-1; STA HOLFNO (SET TO INDICATE NO OPEN); BRR OBAHOL
HOLFNO ZRO

*OPEN (*4ACCT)BATCHREC

ORECF  ZRO; SKR BUSYSW; BRU *-1; LDP BRECP; STP FILPT; LDP BBRECP; STP FILPT1
       LDA =2; STA FILTYP; LDA AUNO; STA FUNO; BRM OPFIL
       BRU ORECF1 (FAILURE); STX RECFB; STA RECFNO
       RSP RECFNO; MRG =4B7; SCP RECFNO; HLT 0; CLA; STA BUSYSW; BRR ORECF
ORECF1 CXA; SNE =1; BRU ORECF3; SNE =30; BRU ORECF3
ORECF2 BRM TEL; MSG MOREC; BRS 10
ORECF3 MIN ORCNT; LDA ORCNT; SNE =30; BRU ORECF2; LDA =5000
       BRS 81; BRU ORECF+1
MOREC  ASC '$UNABLE OPEN BATCH RECORD FILE- PLEASE NOTIFY TYMSHARE$/'
ORCNT  ZRO
RECFNO ZRO
RECFB  ZRO

*MAKE A PARTIAL ACCOUNTING RECORD
**      FORMAT OF NEW BATCH ACCOUNTING FILE 3/7/78
**              (*4ACCT)SSSBATMM WHERE SSS=SYSTEM AND MM=MONTH
**      ALSO FORMAT OF (*4ACCT) RECBATCH AND RECREMOTE
**
**
*WORD   DESCRIPTION
* 
*0      BITS 0-11 TRANSACTION TYPE / BITS 12-23 JOB TYPE
*1      USERNAME     (12 CHAR MAX)
*2      USERNAME
*3      USERNAME
*4      USERNAME
*5      GAN
*6      UUN
*7      HOST
*8      DATE AND TIME OF REQUEST IN CUBS, CORRECTED TO GMT
*9      PROJECT CODE (12 CHAR MAX)
*10     PROJECT CODE
*11     PROJECT CODE
*12     PROJECT CODE
*13     REQUEST NUMBER
*14     REQUESTED BY (12 CHAR MAX)
*15     REQUESTED BY
*16     REQUESTED BY
*17     REQUESTED BY
**
**      WORDS 18 - 27 ARE ONLY USED WITH CERTAIN JOB TYPES
**
* 
*WORD   JOB TYPES               DESCRIPTION
* 
*18     8,10                    NUMBER OF CHARACTERS PROCESSED
*19     1,10                    NUMBER OF PAGES PRINTED
*20     1,10                    NUMBER OF PARTS OF PAPER
*21     2,3,4                   NUMBER OF CARDS PROCESSED
*21     5,7,10                  NUMBER OF FILES PROCESSED
*22     5,7,8,12                NUMBER OF TAPES PURCHASED
*23     7                       NUMBER OF TAPES CONVERTED
*24     1,10                    WERE LISTINGS DECOLATED? 1=NO 2=YES
*25     ALL                     TYPE OF CURRENCY USED (3 CHAR)
*26     ALL                     DELIVERY CHARGES IN HUNDREDTHS (CENTS)
*27     NONE                    SPARE WORD
MKREC  ZRO
       BRM     ORECF
       CLA; WIO RECFNO                      (JOB TYPE)
       LDA =CUST; SKN TRANSW; LDA =CNAM; STA POINT (USERNAME)
MKREC1 LDX =-4; LDA* POINT; MIN POINT; WIO RECFNO; BRX MKREC1+1
       LDA CGAN; WIO RECFNO                 (GAN)
       LDA CUSER;  WIO RECFNO               (UUN)
       LDA NOSYS;  WIO RECFNO               (HOST)
       LDA =-1; LDX =1200120B; BRS 176; WIO RECFNO    (DATE/TIME GMT)
       LDX =-4; LDA PROJ+4,2; BRM RCRET; WIO RECFNO; BRX *-3 (PJ CODE 4 WDS)
       LDA REQNO; WIO RECFNO                (REQUEST NUMBER)
       LDX =-4; LDA REQSTG+4,2; BRM RCRET; WIO RECFNO; BRX *-3 (REQ BY)
       LDX =-10; CLA; WIO RECFNO; BRX *-1         (10 WORDS ZERO)
       LDA RECFNO; BRS 2
       BRR     MKREC           (RETURN)

RCRET  ZRO; STX SAVX; STA SAVA; LDX =-3; LDA =155B; LDB =377B
RCRET1 SKM SAVA; BRU *+2; BRU RCRET3 (FOUND CRET)
       LCY 8; BRX RCRET1; LDA SAVA (NONE FOUND)
RCRET2 LDX SAVX; BRR RCRET
RCRET3 CBA; EOR =-1; STA SAVB; LDA SAVA; ETR SAVB; BRU RCRET2
POINT  ZRO


*GET CUSTOMER NUMBER AND DISTRICT

FCUST  ZRO; LDP AIDPT; BRS 64; BRU FCUST3; STA AIDFNI
       LDP AXPT; BRS 64; BRU FCUST4; STA AXFNI
       RSP AXFNI; STA CPTOP
FCUST1 RCP AXFNI; SNE CPTOP; BRU FCUST5
       WIO AXFNI; SKE CGAN; BRU FCUST2
       WIO AXFNI; SUB =1; MUL =3; LSH 23; SCP AIDFNI; BRU FCUST3
       LDA =40; LDX =ACTREC; BIO AIDFNI; NOP
       LDA AIDFNI; BRS 20; LDA AXFNI; BRS 20; LDA ACID; BRR FCUST
FCUST2 WIO AXFNI; BRU FCUST1
FCUST3 LDA =-1; BRR FCUST
FCUST4 LDA AIDFNI; BRS 20; BRU FCUST3
FCUST5 LDA AXFNI; BRS 20; BRU FCUST4
ACTREC BSS 40
ACID   EQU ACTREC+4
AX     ASC '(*4ACCT)/CAX/'
AID    ASC '(*4ACCT)/CAI&D/'
AXPT   DATA 3*AX-1,3*AX-1+13
AIDPT  DATA 3*AID-1,3*AID-1+15
AIDFNI ZRO
AXFNI  ZRO
CPTOP  ZRO
SAVA   ZRO
SAVB   ZRO
SAVX   ZRO
SPOOL  ZRO; MSG MSPOOL
SPOOL3 MSG MSPL1; BRM CLBUF; CIO CIN; SNE ='Y'
       BRU SPOOL1; SNE ='N'; BRU SPOOL2; LDX =-1; BRS 11; BRU SPOOL3
SPOOL1 CIO CIN; SKE =155B; BRU *-2; BRR SPOOL
SPOOL2 LDX =-1; BRS 11; BRS 10
MSPOOL ASC '$FOR PRINTER LISTINGS, PLEASE USE SPOOL./'
MSPL1  ASC '$DO YOU WISH TO CONTINUE? /'

NSPOOL ZRO
       MSG NSPMSG; MIN NSPOOL; BRR NSPOOL
NSPMSG ASC '$FOR PRINTER LISTINGS, IT IS SUGGESTED THAT YOU USE THE SPOOL PROGRAM$/'
       END
BATCH ** FICHE/FRAME BREAK *****
BATCH31 SYMSORT

SYM.  PG.LN. IDENT.

1BUSY  16 21 BATCH   2BUSY  16 19 BATCH   ACCT   13 34 BATCH   
ACID   21  1 BATCH   ACTREC 20 39 BATCH   AID    21  3 BATCH   AIDFNI 21  6 BATCH   
AIDPT  21  5 BATCH   ANAME  12 37 BATCH   ANAME  12 34 BATCH   AUNO   13  2 BATCH   
AX     21  2 BATCH   AXFNI  21  7 BATCH   AXPT   21  4 BATCH   BA     17  8 BATCH   
BA     16 34 BATCH   BACKSW 16 30 BATCH   BADR   13 36 BATCH   BAFNO  17 30 BATCH   
BAHOLD 17 10 BATCH   BAHOLD 16 36 BATCH   BAHOLP 17 16 BATCH   BAHOLP 17  3 BATCH   
BAMSG  10 21 BATCH   BAPT   17 14 BATCH   BAPT   17  1 BATCH   BAREC  17 13 BATCH   
BAREC  16 39 BATCH   BBRECP 17 18 BATCH   BBRECP 17  5 BATCH   BCUST  12  8 BATCH   
BLNO   13 35 BATCH   BLX    13 24 BATCH   BNAME  12 36 BATCH   BNAME  12 33 BATCH   
BNUM   17  9 BATCH   BNUM   16 35 BATCH   BNUMP  17 15 BATCH   BNUMP  17  2 BATCH   
BRECP  17 17 BATCH   BRECP  17  4 BATCH   BTBLND  3 24 BATCH   BUF     1 24 BATCH   
BUNO   13  1 BATCH   BUSCNT 16 25 BATCH   BUSY   16 14 BATCH   BUSYSW 16 28 BATCH   
CALLER  2  2 BATCH   CAP     3 25 BATCH   CARRET  1 16 BATCH   CFDPT  14 32 BATCH   
CGAN   15  2 BATCH   CHA     3 33 BATCH   CHCNT   9 13 BATCH   CHK     2 28 BATCH   
CIN     1 30 BATCH   CINSW   1 32 BATCH   CLBUF  11  1 BATCH   CNAM   14 39 BATCH   
CONTA   9 17 BATCH   COPTR   8 22 BATCH   COSIZE  8 24 BATCH   COSTG   8 23 BATCH   
CPARW  15  4 BATCH   CPTOP  21  8 BATCH   CRE     3 35 BATCH   CTBL    3  7 BATCH   
CTBLND  3 15 BATCH   CUSER  15  3 BATCH   CUST   11 21 BATCH   CUSTPT 11 20 BATCH   
CUSTSI 11 22 BATCH   DASTG   8 17 BATCH   DATSIZ  8 16 BATCH   DEBUG   1  4 BATCH   
DEL     8 35 BATCH   DELMSG 10 33 BATCH   DELPT   8 34 BATCH   DELSIZ  8 36 BATCH   
DIST    1 29 BATCH   DTPTR   8 15 BATCH   EDISC  13 23 BATCH   EOJ    10 35 BATCH   
ERFLG   6  2 BATCH   ERMSG   4  1 BATCH   ERMSG1  4  2 BATCH   ERR     2 36 BATCH   
ERR1    3  4 BATCH   EYN     1 34 BATCH   FBSW   16 26 BATCH   FBUSY1 16 22 BATCH   
FBUSY2 16 23 BATCH   FCUST  20 27 BATCH   FCUST1 20 30 BATCH   FCUST2 20 35 BATCH   
FCUST3 20 36 BATCH   FCUST4 20 37 BATCH   FCUST5 20 38 BATCH   FDLUDL 14 34 BATCH   
FDPTC  15  1 BATCH   FILDAT 15 29 BATCH   FILPT  17 20 BATCH   FILPT1 17 21 BATCH   
FILTYP 16 29 BATCH   FNAMS  14 26 BATCH   FNAMS1 14 28 BATCH   FNAMSI 15  6 BATCH   
FNO1    1 27 BATCH   FRFIL   9 39 BATCH   FRSW    2  3 BATCH   FUNO   17 22 BATCH   
GAN    14 33 BATCH   GANMSG 10 20 BATCH   GAUN   12 17 BATCH   GBUN   12 12 BATCH   
GCUST  11  7 BATCH   GDATE   8 14 BATCH   GDIR   12 19 BATCH   GDIR2  12 24 BATCH   
GDIR3  12 30 BATCH   GFDFDP 14 37 BATCH   GFDGAN 14 38 BATCH   GFDNAM 14 36 BATCH   
GFDNO  14  1 BATCH   GIP    15 28 BATCH   GLTCH   2 11 BATCH   GREC   11 13 BATCH   
GTSTG   8 38 BATCH   GTSTG1  8 39 BATCH   GTSTG2  9  4 BATCH   GTSTG3  9  6 BATCH   
GTSTG4  9  9 BATCH   GTSTG5  9 10 BATCH   GTSTG6  9  3 BATCH   GTU1   13 32 BATCH   
GTUSER 13 26 BATCH   GUSER  14  8 BATCH   GUSER1 14 31 BATCH   HCUSTP 11 19 BATCH   
HEL     3 38 BATCH   HOLFNO 18 19 BATCH   HTOUT   1 37 BATCH   IHMSG  11 27 BATCH   
IHOUSE 11  2 BATCH   IN1     2 13 BATCH   IN2     2 17 BATCH   IN3     2 20 BATCH   
IN4     2 23 BATCH   INS     3 27 BATCH   INS1    3 30 BATCH   LBUF   13 22 BATCH   
LUDL   14 35 BATCH   M       1 12 BATCH   M1     10  4 BATCH   M10    10 16 BATCH   
M11    10 17 BATCH   M2     10  5 BATCH   M3     10  6 BATCH   M4     10  7 BATCH   
M4A    10  8 BATCH   M4B    10  9 BATCH   M4C    11 26 BATCH   M5     10 10 BATCH   
M5A    10 11 BATCH   M6     10 12 BATCH   M7     10 13 BATCH   M8     10 14 BATCH   
M9     10 15 BATCH   MDIST  10 18 BATCH   MKNUM   9 29 BATCH   MKREC  20  1 BATCH   
MKREC1 20  5 BATCH   MLUDT  13  7 BATCH   MLUDT1 13  8 BATCH   MLUDT2 13 11 BATCH   
MLUDT3 13 14 BATCH   MOPBA  17 32 BATCH   MOREC  18 31 BATCH   MSG     1 11 BATCH   
MSG1    4  3 BATCH   MSG2    4  9 BATCH   MSG2A   4 29 BATCH   MSG3    5 27 BATCH   
MSG4    5 28 BATCH   MSG5    5 29 BATCH   MSG6    5 30 BATCH   MSPL1  21 18 BATCH   
MSPOOL 21 17 BATCH   MTRAP  14  5 BATCH   MTRAP1 14  6 BATCH   NAMBF  13 37 BATCH   
NAMBF1 13 38 BATCH   NAME   12 39 BATCH   NAMS   14 16 BATCH   NAMS1  14 18 BATCH   
NAMSIZ 15  5 BATCH   NBLK   13 15 BATCH   NCNT   15  7 BATCH   NOGOOD 13  3 BATCH   
NONO   13  4 BATCH   NOREQ   9 18 BATCH   NOREQ1  9 20 BATCH   NOREQ2  9 22 BATCH   
NOREQ3  9 23 BATCH   NOREQ4  9 24 BATCH   NOSYS  13  5 BATCH   NSPMSG 21 22 BATCH   
NSPOOL 21 20 BATCH   NTEMP  13 25 BATCH   NUMFNO 18  9 BATCH   NUMSG  10 19 BATCH   
OBAH1  18 18 BATCH   OBAHOL 18 13 BATCH   OBCNT  18  8 BATCH   OBNUM  17 36 BATCH   
OBNUM1 18  3 BATCH   OBNUM2 18  4 BATCH   OBNUM3 18  6 BATCH   OBNUM4 17 37 BATCH   
OPBA1  17 31 BATCH   OPENBA 17 26 BATCH   OPFI1  16  3 BATCH   OPFI2  16  5 BATCH   
OPFI3  16  6 BATCH   OPFI4  15 37 BATCH   OPFIL  15 36 BATCH   ORCNT  18 32 BATCH   
ORECF  18 23 BATCH   ORECF1 18 27 BATCH   ORECF2 18 28 BATCH   ORECF3 18 29 BATCH   
PDNO   10 37 BATCH   PDNUM   9 27 BATCH   PDNUM1  9 28 BATCH   PHO     8 29 BATCH   
PHOPT   8 28 BATCH   PHOSIZ  8 30 BATCH   PMSG1   1 14 BATCH   POINT  20 22 BATCH   
PRIV    1 22 BATCH   PROJ    8 26 BATCH   PROJPT  8 25 BATCH   PROJSI  8 27 BATCH   
QUI     3 37 BATCH   RBLK   12 21 BATCH   RCRET  20 17 BATCH   RCRET1 20 18 BATCH   
RCRET2 20 20 BATCH   RCRET3 20 21 BATCH   REC    11 24 BATCH   RECFB  18 34 BATCH   
RECFNO 18 33 BATCH   RECPTR 11 23 BATCH   RECSIZ 11 25 BATCH   REMMSG 10 30 BATCH   
REQNO  10 36 BATCH   REQPTR  8 18 BATCH   REQSIZ  8 20 BATCH   REQSTG  8 19 BATCH   
RES1    2  7 BATCH   RESET   2  9 BATCH   RPAGE  13 17 BATCH   RUN     6  4 BATCH   
RUN1    6 12 BATCH   RUN10   8  7 BATCH   RUN11   8 12 BATCH   RUN1B   6 15 BATCH   
RUN1C   6 16 BATCH   RUN2    6 19 BATCH   RUN3    6 22 BATCH   RUN4    7  4 BATCH   
RUN4A   7 12 BATCH   RUN5    7 14 BATCH   RUN6    7 16 BATCH   RUN7    7 17 BATCH   
RUN8    8  4 BATCH   RUN9    8  5 BATCH   SAMESW 13 39 BATCH   SAVA   21  9 BATCH   
SAVB   21 10 BATCH   SAVX   21 11 BATCH   SECSW  16 27 BATCH   SET1   15 18 BATCH   
SET1A  15 20 BATCH   SET2   15 21 BATCH   SETUP  15 13 BATCH   SPACE   1 19 BATCH   
SPOOL  21 12 BATCH   SPOOL1 21 15 BATCH   SPOOL2 21 16 BATCH   SPOOL3 21 13 BATCH   
STGECH  9 14 BATCH   STGPTR  8 21 BATCH   SYSNO   1 25 BATCH   T2      9 37 BATCH   
T3      9 38 BATCH   TANDT   6 39 BATCH   TANDT1  7  1 BATCH   TDNO   10  1 BATCH   
TDNUM   9 25 BATCH   TDNUM1  9 26 BATCH   TEL     1 36 BATCH   TEMP    1 23 BATCH   
THANKS 10 34 BATCH   TONO   14  7 BATCH   TOUT    1 31 BATCH   TOUTSW  1 33 BATCH   
TRANSW 11 28 BATCH   TRAP   14  2 BATCH   TYMSW   1 28 BATCH   VCUST  11 29 BATCH   
VCUST1 11 32 BATCH   VCUST2 11 35 BATCH   VCUST3 12  6 BATCH   VCUSTB 12  7 BATCH   
VER     3 31 BATCH   WCUST  11 16 BATCH   WDAT   10 38 BATCH   WKMSG  10 32 BATCH   
WKWORD  9 36 BATCH   WORK    8 32 BATCH   WORKPT  8 31 BATCH   WORKSI  8 33 BATCH   
WORKSW  8 37 BATCH   WREC   11 18 BATCH   X       2  6 BATCH   
BATCH ** FICHE/FRAME BREAK *****
BUILDBATCH
NARP
BATCH31
BBATCH31



RES
XDDT
;TBBATCH31
;U%F
SAVE 3 T 12000 ON GBATCH31

240
DUMP DUMPBATCH

"

     BATCH VERSION 31


THE GO FILE SHOULD BE DECLARED PROPRIETARY WITH
EXEC LICENSE

"
CHECKSUM
.
BATCH31-SYMBOLICS
GBATCH31-GO-FILE
BUILDBATCH-BUILD-FILE
.
"

"
COM TEL
r@+