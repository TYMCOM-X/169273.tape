PRINTER ** FICHE/FRAME BREAK *****
SNPRINTER18
BILLP  IDENT   3-6-75  BILLING PKG FOR PRINTER PROGRAM LOAD AT 30000B

MSG    OPD 177B5,2
CRET   OPD 175B5,2
PMSG   POPD 174B5,2
       BRM SAVE; EAX* 0; CXA; ETR =37777B; LDX FNO; LDB =-1
       BRS 34; BRM RES; BRR 0
PCRET  POPD 173B5,2
       BRM SAVE; EAX* 0; CXA; ETR =37777B; CNA; CAX; LDA =155B
       CIO FNO; BRX *-1; BRM RES; BRR 0
PSPACE POPD 172B5,2
       BRM SAVE; EAX* 0; CXA; ETR =37777B; CNA; CAX; CLA
       CIO FNO; BRX *-1; BRM RES; BRR 0

*GET ENTERED BY AND BILL TO USER AS WELL AS A JOB NO

BILLSW ZRO
$GBILLP CLA; STA BILLSW
        SKN SYSSW; BRM GSYSNO; BRM GENTBY; SKN EGAN; BRU GBILL2
GBILL3 MSG BM1 (BILL PRINTING TO USER)
       SKN 2780SW; BRU *+2; TCO =155B
       BRM GUNAM; BRU BADNAM (ERROR IN NAME STRING)
       LDA =NBUF
GBILL1 BRM GENTRY; BRU INVUSR (INVALID USER); BRM GPROJ; BRM GJNO
       BRU GBILLR
GBILL2 SKR BILLSW; BRU *-1; LDA =ENTBY; BRU GBILL1
BADNAM MSG BERR2; BRU INVUSR+1
INVUSR MSG BERR1; LDX =1; BRS 11; BRU GBILL3
GENTBY ZRO; LDA =32; LDB =FDLUD; LDX =2; BRS 67
       LDA FDLUD; LRSH 10; ADD =LUDBUF; STA FDLUD; CLA; LSH 10
       STA BLNO; BRM GE1; LDX FDLUD; LDA 4,2; ETR =3777B
       STA RTFD
       LDA LUDLOC; LRSH 10; ADD =LUDBUF; STA LUDLOC; CLA; LSH 10
       STA BLNO; BRM GE1; LDX =-9; LDA* LUDLOC; STA ENTBY+9,2
       MIN LUDLOC; BRX *-3; LDA ECPARW; LRSH 2; ETR =1777B; STA EDIST
       LRSH 23; DIV =10; STA EREG; BRR GENTBY
GE1    ZRO; LDA BLNO; LRSH 23; DIV =128; STB MTEMP; CLB; LSH 13
       ADD =320200B; ADD MTEMP; CAB; LDA =LUDBUF; LDX =100B
       BRS 124; EAX LUDBUF; BRR GE1
GENTRY ZRO; STA POINT; BRM MKPTR
       STP GEPTR; CLA; LDX =-4; ADD* POINT; MIN POINT; BRX *-2
       LRSH 23; DIV =887; STB BLNO; CBA; SKG =895; BRU *+2; HLT 0
       BRM GE1
GE2    STX BLX; LDA 0,2; SKE =0; BRU *+3; LDX =1; BRR GENTRY (NOT IN LUD)
       SKE =-1; BRU *+3; MIN BLNO; BRU GE2-1; SKE =-2; BRU *+2
       BRU GE3; CXA; BRM MKPTR
       SKSE GEPTR; BRU GE3; SKN GFDSW; BRU *+3; MIN GENTRY; BRR GENTRY
       LDA BLX; STA LUDLOC; LDX =-9
       LDA* LUDLOC; STA BILLTO+9,2; MIN LUDLOC; BRX *-3; MIN GENTRY
       LDA BCPARW; LRSH 2; ETR =1777B; STA BDIST; LRSH 23; DIV =10
       STA BREG; BRM CKF
       LDA EDIST; SKG =0
       BRR GENTRY; SKG =9; BRU *+2; BRU GE4; SKE BDIST; BRU *+2; BRR GENTRY
       MSG BERR3; BRU INVUSR+1
GE3    LDX BLX; EAX 9,2; BRU GE2
GE4    LDA EREG; SKE BREG; BRU *+2; BRR GENTRY; MSG BERR5; BRU INVUSR+1

*SET FRENCH SWITCH IF REGION 7 AND THIS IS NOT SYSTEM 14

CKF    ZRO; LDA NOSYS; SKE =14; BRU CKF2
CKF1   CLA; STA FRSW; BRR CKF
CKF2   LDA BREG; SKE =7; BRU CKF1; SKR FRSW; BRU *-1
       LDA BDIST; SKE =77; BRR CKF; BRU CKF1
FRSW   ZRO;*SWITCH TO FORCE BILLING RECORD TO MMFBATDD INSTEAD OF MMPBATDD

*GET SYSTEM NUMBER FOR BILLING RECORD

NOSYS  ZRO;*BINARY SYSTEM NUMBER
SYSSW  ZRO;*SWITCH TO ONLY GET SYSNO ONCE

GSYSNO ZRO; LDA =LUDBUF; LDB =200B; LDX =100B; BRS 124; LDA LUDBUF+75B
       LRSH 12; STA NOSYS; SKR SYSSW; BRU *-1; BRR GSYSNO


*GET JOB NO IF UNABLE OPEN JOBNO FILE SET UP RANDOM JOB NO

GJNO   ZRO; SKR GFDSW; BRU *-1; LDA =BATCH; BRM GENTRY
       BRU JNERR1 (UNABLE LOCATE *1BATCH)
       LDX BLX; LDA 4,2; ETR =3777B; LDX =1; BRS 141
       CLA; STA BUSYCT
GJNO1  LDP JNPTR; LDX =2; MRG =516B5; BRS 65; BRU JNERR
       STA FNO; CLA; SCP FNO; HLT 0
       WIO FNO; STA JOBNO; ETR =7777B; SKG =999; BRU *+3; LDA =999
       STA JOBNO; SNE =999; BRU *+3; ADD =1; BRU *+2; LDA =1; STA BT1
       LDA =4B7; SCP FNO; HLT 0; LDA BT1; WIO FNO; LDA FNO; BRS 20
       BRM MKJ
GJNO2  CLA; STA GFDSW; LDA RTFD; LDX =1; BRS 141; BRR GJNO
JNERR  CXA; SNE =1; BRU JNERR2
JNERR1 BRS 42; ETR =777B; STA JOBNO; BRM MKJ; BRU GJNO2
JNERR2 MIN BUSYCT; LDA BUSYCT; SNE =10; BRU JNERR1 (WAITED LONG ENUF)
       LDA =3000; BRS 81; BRU GJNO1
MKJ    ZRO; LDA NOSYS; MUL =1000; LSH 23; ADM JOBNO; BRR MKJ
BATCH  ASC '*1BATCH     '
JNFIL  ASC '@BATCHNUM1'
JNPTR  DATA 3*JNFIL-1,3*JNFIL-1+10
GUNAM  ZRO; LDX =-4; CLA; STA NBUF+4,2; BRX *-2; STA NAMCNT
       LDP HNAMPT; STP NAMPT; BRM CLBUF
GUNAM1 CIO CIN; BRM MAPLC; BRM TERMCH; SKE =141B
       BRU *+3; TCO =77B; BRU GUNAM1; SKG =0; BRU GUNAM1 (NO LEAD SP)
       SKE =16B; BRU *+2; BRU GUNAM1 (IGNORE LEADING PERIOD)
       SKG =77B; BRU *+2; BRU GUNAM1 (IGNORE CONTROL CHARS)
       BRM CKCHAR; WCI NAMPT; MIN NAMCNT
GUNAM2 CIO CIN; BRM MAPLC
       BRM TERMCH; SKE =141B; BRU GUNAM3; GCD NAMPT; NOP; TCO =77B
       LDA NAMCNT; SKG =0; BRU GUNAM1; SUB =1; STA NAMCNT; SKG =0
       BRU GUNAM1; BRU GUNAM2
GUNAM3 SKG =77B; BRU *+2; BRU GUNAM2 (IGNORE CONTROL CHARS)
       BRM CKCHAR; STA NAMTEM; LDA NAMCNT; SKE =12
       BRU *+2; BRU GUNAM5; LDA NAMTEM; WCI NAMPT; MIN NAMCNT; BRU GUNAM2
GUNAM5 CIO CIN; SKE =155B; BRU GUNAM5; LDX =2; BRR GUNAM
GUNAM4 LDA NAMCNT; SKE =0; BRU *+3; LDX =1; BRR GUNAM
       MIN GUNAM; BRR GUNAM
MAPLC  ZRO; SKG =100B; BRR MAPLC; SKG =132B; SUB =40B; BRR MAPLC
TERMCH ZRO; SKE =155B; BRU *+2; BRU GUNAM4; SKE =33B (SEMI COLON); BRR TERMCH
       BRU GUNAM4
CKCHAR ZRO; SKG =32B (COLON); BRU CKC1; SKG =72B (ZEE); SKG =37B (QMARK)
       BRU CKC2; BRR CKCHAR
CKC1   SKE =0; BRU *+2; BRR CKCHAR
       SKE =2; BRU *+2; BRR CKCHAR
       SKE =12B (STAR); BRU *+2; BRR CKCHAR
       SKG =13B (PLUS); BRU *+2; BRR CKCHAR
CKC2   LDA =4 (DOLLAR SIGN); BRR CKCHAR
GPROJ  ZRO; LDP HPPTR; STP PPTR; CLA; LDX =-5; STA CHCNT; STA PROBUF+5,2
       BRX *-1; MSG BM2 (PROJECT CODE); SKN 2780SW; BRU *+2; TCO =155B
       BRM CLBUF
GPROJ1 CIO CIN; SNE =155B; BRU GPROJ2; SNE =152B; BRU GPROJ2
       SNE =144B; BRU GPROJ2
       SNE =141B; BRU PCONTA; WCI PPTR; MIN CHCNT; LDA CHCNT
       SKG =12; BRU GPROJ1; MSG BERR4 (LIMIT 12 CHARS)
       LDX =-1; BRS 11; BRU GPROJ+1
GPROJ2 LDA =155B; CIO =1; BRR GPROJ
PCONTA GCD PPTR; NOP; TCO =77B; SKR CHCNT; BRU GPROJ1
       CLA; STA CHCNT; BRU GPROJ1
CLBUF  ZRO; LDA =377B; CIT CIN; SNE =37B; BRU INT1; SKE =155B
       BRR CLBUF; CIO CIN; BRU CLBUF+1
GTIME  ZRO; LDA =-1; LDX =1200120B; BRS 176; BRR GTIME
PROBUF BSS 5
HPPTR  DATA 3*PROBUF-1,3*PROBUF-1
PPTR   BSS 2
BERR1  ASC '$NOT VALID USER ON THIS SYSTEM/'
BERR2  ASC '$ERROR,'
       ASC '$TYPE USER NAME: /'
BERR3  ASC '$USER NOT IN YOUR DISTRICT/'
BERR4  ASC '$PROJECT CODE LIMITED TO MAX. OF 12 CHARS./'
BERR5  ASC '$USER NOT IN YOUR REGION/'
BERR19 ASC '$STARTING PAGE MUST BE GREATER THAN 1$/'
BERR21 ASC 'ERROR ON NAME: /'
BM1    ASC '$BILL USER: /'
BM2    ASC '$PROJECT CODE: /'
BM3    ASC 'EXTERNAL PRINTING/'
BM4    ASC '$ENTERED BY: /'
BM5    ASC '$BILLED TO: /'
BM6    ASC '$JOB NO. /'
BM7    ASC '$FILE: /'
ENTBY  BSS 4;*ENTERED BY USER NAME
EFDPT  BSS 1;*FILE DIRECTORY NUMBER OF ENTERING USER
EWD5   BSS 1;*LUD WORD FIVE OF ENTER USER
EGAN   BSS 1;*GAN OF ENTERING USER
EUUN   BSS 1;*UUN OF ENTERING USER
ECPARW BSS 1;*LICENSE AND DISTRICT OF ENTERING USER
BILLTO BSS 4;*BILL TO USER NAME
BFDPT  BSS 1;*FILE DIRECTORY NUMBER OF BILL TO USER
BWD5   BSS 1;*LUD WORD FIVE OF BILL TO USER
BGAN   BSS 1;*GAN OF BILL TO USER
BUUN   BSS 1;*UUN OF BILL TO USER
BCPARW BSS 1;*LICENSE AND DISTRICT OF BILL TO USER
EDIST  ZRO;*DISTRICT OF CALLING USER
EREG   ZRO;*REGION OF CALLING USER
BDIST  ZRO;*DISTRICT OF USER BILLED
BREG   ZRO;*REGION OF USER BILLED
CHCNT  ZRO;*COUNTER FOR PROJ CODE
BLNO   ZRO;*BLOCK NUMBER IN LUD
BLX    ZRO;*CURRENT LOCATION IN LUDBUF
GEPTR  BSS 2;*COMPARISON STRING POINTERS FOR LUD LOOKUP
HNAMPT DATA 3*NBUF-1,3*NBUF-1
FDLUD  ZRO;*FILE DIRECTORY LUD LOCATOR
LUDLOC ZRO;*LUD LOCATOR
$RTFD   ZRO;*FIL DIR THE USER CAME FROM
BPOINT ZRO
MTEMP  ZRO
NAMCNT ZRO
NAMPT  BSS 2
NAMTEM ZRO
NBUF   BSS 4;*TEMP USER NAME BUFFER
FNO    ZRO;*OUTPUT FILE NO
GFDSW  ZRO;*SWITCH TO MODIFY GENTRY ROUTINE
POINT  ZRO;*POINTER
RTRYCT ZRO;*COUNT FOR RETRYS ON FILE BUSY MMPBATDD
BFNO   ZRO;*FILE NUMBER OF BILLING FILE
RAWD   ZRO;*FILE DIRECTORY NUMBER OF *4RAW ACCT
LUDBUF BSS 100B;*BUFFER FOR READING LUD BLOCK
BILREC BSS 17;*BUFFER FOR SETTING UP BILLING RECORD 2 EXTRA CELLS
BILGAN EQU BILREC
BILUUN EQU BILREC+1
BILNAM EQU BILREC+2
BILPRO EQU BILREC+6
BILTIM EQU BILREC+10
BILJOB EQU BILREC+11
BILPGS EQU BILREC+12
BILCHS EQU BILREC+13

*WRITE BILLING RECORD INTO (*4RAW ACCT)MMPBATDD AND MAKE ENTRY INTO
*(OPER)/@EXTERNAL/
*IF UNABLE OPEN MMPBATDD FOR ANY REASON EXCEPT BUSY WRITE INTO
*MMPBATDDA, IF UNABLE GET FILE DIRECTORY OF *4RAW ACCT WRITE INTO
*DIRECTORY OF GBLOOD


*BILLING RECORD CONSTRUCTED AS FOLLOWS

*WORD  0       BITS 0-18 GLOBAL ACCT NO. BIT 23 IF ON MEANS NON-BILL
*      1       BITS 0-16 UNIV USER NO BITS 17-23 SYSNO
*      2-5     USER NAME
*      6-9     PROJECT CODE
*      10      DATE AND TIME (GMT)
*      11      BITS 0-5 USERS TIME ZONE, BITS 6-23 JOB NO
*      12      PAGES
*      13      CHARACTERS
*      14      SPARE

$BILLP BRM MKBREC; BRM OBATF; LDX =BILREC; LDA =15; BIO BFNO
       NOP; LDA BFNO; BRS 20
BILLP1 BRM WBA; BRU BILLR

*ADJ PAGE COUNT FOR CHARGING IF IN RECOVERY

PADJ   ZRO; SUB =1; STA BT1; XAB; SUB BT1; MIN PADJ; BRR PADJ

*WRITE ENTRY INTO (OPER)/@EXTERNAL/

WBA    ZRO; BRM OPENBA; PCRET 1; BRM DATE; PMSG BM3 (EXTERNAL PRINTING)
       PMSG BM6 (JOB NO); LDA JOBNO; BRM PDNO
       PMSG BM4 (ENTERED BY); LDA =ENTBY; BRM MKPTR; BRM WTSTG
       PMSG BM5 (BILLED TO); LDA =BILLTO; BRM MKPTR; BRM WTSTG; 
       PMSG BM7 (FILE); LDP PT; BRM WTSTG; PCRET 1
       LDA FNO; BRS 20; BRR WBA


BAFIL  ASC '/@EXTERNA'
       DATA 13061570B (L CONT C CONT X)
       DATA 3600000B  (SLASH)
BAPTR  DATA 3*BAFIL-1,3*BAFIL-1+13

*OPEN (OPER)/@EXTERNAL/

OPENBA ZRO; LDA =25B; LDX =1; BRS 141; CLA; STA BUSYCT
OBA1   LDP BAPTR; MRG =516B5; LDX =3; BRS 65; BRU BAERR
       STA FNO; RSP FNO; MRG =4B7; SCP FNO; HLT 0; BRR OPENBA
BAERR  CXA; SKE =1; BRU BILLR (CANT OPEN EXTERNAL NO ENTRY MADE)
       MIN BUSYCT; LDA BUSYCT; SKG =10; BRU *+2
       BRU BILLR (BUSY TOO LONG NO ENTRY MADE)
       LDA =5000; BRS 81; BRU OBA1
BUSYCT ZRO;*COUNT OF TIMES EXTERNAL BUSY
DATE   ZRO; LDA =LUDBUF; LDB =200B; LDX =100B; BRS 124
       LDA LUDBUF+74B; STA TIMEX; CLB; LSH 12; ADM TIMEX
       LDX TIMEX
        LDA =-1; BRS 176; STA BT1; LRSH 20; XMA BT1
       ETR =@74B6
       STA BT2; LRSH 16; ADD =1; STA MO
       LDA BT2; ETR =177777B; RSH 23; DIV =1440; STB BT2; ADD =1
       STA DAY
       LDA MO; PCRET 1; BRM PDNO; LDA ='/'; CIO FNO; LDA DAY
       BRM PDNO; LDA ='/'; CIO FNO; LDA BT1; ADD =72; BRM PDNO
       PSPACE 2; LDA BT2; RSH 23; DIV =60; STB BT2
       BRM PDNO; LDA =':'; CIO FNO; LDA BT2; SKG =9; BRM ZERO
       BRM PDNO; PCRET 1; BRR DATE
ZERO   ZRO; BRM SAVE; LDA =20B; CIO FNO; BRM RES; BRR ZERO
BT1    ZRO;*TEMP CELL
BT2    ZRO;*TEMP CELL
DAY    ZRO;*DAY
MO     ZRO;*MONTH
TIMEX  ZRO
WTSTG  ZRO; LDX FNO; BRS 35; BRR WTSTG
PDNO   ZRO; BRM SAVE; LDX FNO; LDB =10; BRS 36; BRM RES; BRR PDNO
MKPTR  ZRO; MUL =3; LSH 23; SUB =1; CAB; ADD =12; XAB; BRR MKPTR

*GET PAGE NUMBER TO START AT FOR RECOVERY

$GPNP   BRM RDNO; SKG =1; BRU GPN1; STA RPN
       LDA =-1; STA RECSW; BRU GPNR
GPN1   MSG BERR19 (START PG MUST BE > 1); BRU GPNR

*      GET FILE NAME TO START WITH FOR RECOVERY

$GFNP   LDA =-1; STA RECSW; LDA STFPT1; STA STFPT1+1
GFN1   CIO CIN; SKE =155B; BRU *+2; BRU GFNR
       SKE =141B; BRU GFN2; GCD STFPT1; NOP; BRM EXTOFF; TCO =77B (BACK ARROW)
       BRU GFN1
GFN2   WCI STFPT1; BRU GFN1
GFNR   LDP STFPT1; BRS 48; BRU GFNER; LDP STFPT1; BRM GIBP; STA SWIBP; BRU GPNR
GFNER  MSG BERR21 (ERR ON NAME); LDP STFPT1; LDX =1; BRS 35
       CRET 1; LDA CIN; SKG =0; BRU GPNR; BRS 10
STFPT1 DATA 3*STFILE-1,3*STFILE-1
STFILE BSS 25;*CONTAINS NAME OF FILE TO START AT IN RECOVERY
*MAKE UP BILLING RECORD TO WRITE INTO (*4RAW ACCT)MMPABTDD

MKBREC ZRO; LDX =-17; CLA; STA BILREC+17,2; BRX *-1
       CLB; LDA BGAN; LSH 5; SKN BGAN; BRU *+2; MRG =1; STA BILGAN
       LDA BUUN; LSH 7; MRG NOSYS; STA BILUUN
       LDX =-4; LDA BILLTO+4,2; STA BILNAM+4,2; BRX *-2
       LDA =PROBUF-1; STA PPTR; LDX =-4
MKBR1  MIN PPTR; LDA* PPTR; ETR =37777577B; STA BILPRO+4,2
       BRX MKBR1
       BRM GTIME; STA BILTIM
       CLB; LDA BWD5; LSH 2; ETR =77B6; MRG JOBNO
       STA BILJOB; LDA PC; ADD =1; CAB; LDA RPN; SKE =0; BRM PADJ
       XAB; CLB; STB RPN; STA BILPGS; LDA FCCNT; STA BILCHS; BRR MKBREC

*OPEN BILLING RECORD FILE

OBATF  ZRO; CLA; STA RTRYCT
OBATFR LDA RAWD; SKE =0; BRU OBATF2
       SKR GFDSW; BRU *-1; LDA =RAWACT; BRM GENTRY
       BRU OBERR1 (COULD NOT FIND *4RAW ACCT DIRECTORY)
       MIN GFDSW; LDX BLX; LDA 4,2; ETR =3777B; STA RAWD
OBATF2 LDA RAWD; LDX =1; BRS 141
       LDX =-3; LDA FBATF+3,2; SKN FRSW; LDA BATF+3,2; STA BATFIL+3,2
       BRX *-4
OBATF1 LDA BILTIM; LDX =1200320B; BRS 176; ABC; LSH 10
       CLA; LSH 4; ADD =1; STA MO; CLA; LSH 5; ADD =1; STA DAY
       LDA MO; BRM MKSYM; STA MO; LDA DAY; BRM MKSYM; STA DAY
       LDA BATFIL; ETR =377B; MRG MO; STA BATFIL
       LDA DAY; MRG ='A'; STA BATFIL+2
OBATF4 LDP NBATPT; SKN BILLSW; LDP BATPT
OBF4A  MRG =116B5; LDX =2; BRS 65; BRU OBERR2 (FILE OPEN ERROR)
       STA BFNO; CLA; SCP BFNO; BRU OBERR3 (SCP ERROR); RSP BFNO
       SKG =0; BRU OBATF3+1; SUB =3; SCP BFNO; BRU OBERR3 (SCP ERROR)
       WIO BFNO; SNE =-1; BRU OBERR3 (IF -1 THEN PROCESSED BY GASP)
OBATF3 RSP BFNO; MRG =4B7; SCP BFNO; BRU OBERR3 (SCP ERROR); BRR OBATF
BFIL   ASC '(*4RAW ACCT)'
BATFIL ASC '         '
BATF   ASC '  PBAT   '
FBATF  ASC '  FBAT   '
BATPT  DATA 3*BFIL-1,3*BFIL-1+20
BATPT1 DATA 3*BFIL-1,3*BFIL-1+21
NBATPT DATA 3*BFIL-1,3*BFIL-1+18
RAWACT ASC '*4RAW ACCT  '
MKSYM  ZRO; LRSH 23; DIV =10; CBX; CLB; ADD =20B; LSH 16; STA BT1
       CXA; ADD =20B; LSH 8; MRG BT1; BRR MKSYM
OBERR1 MIN GFDSW; LDA =3024B; BRU OBATF2+1
OBERR2 CXA; SNE =1; BRU RETRY; SNE =30; BRU RETRY; BRU OBERR3
RETRY  MIN RTRYCT; LDA RTRYCT; SKG =5; BRU *+2; BRU OBERR3; LDA =5000
       BRS 81; BRU OBATFR
OBERR3 SKN BILLSW; BRU *+2; BRU BILLP1; LDP BATPT1; BRU OBF4A
       NOLIST EXT
       END
PRINTER ** FICHE/FRAME BREAK *****
SNPRINTER18 SYMSORT

SYM.  PG.LN. IDENT.

BADNAM  1 27 BILLP   BAERR   7 15 BILLP   BAFIL   7  5 BILLP   
BAPTR   7  8 BILLP   BATCH   3 15 BILLP   BATF    9 20 BILLP   BATFIL  9 19 BILLP   
BATPT   9 22 BILLP   BATPT1  9 23 BILLP   BCPARW  5 10 BILLP   BDIST   5 13 BILLP   
BERR1   4 23 BILLP   BERR19  4 29 BILLP   BERR2   4 24 BILLP   BERR21  4 30 BILLP   
BERR3   4 26 BILLP   BERR4   4 27 BILLP   BERR5   4 28 BILLP   BFDPT   5  6 BILLP   
BFIL    9 18 BILLP   BFNO    5 33 BILLP   BGAN    5  8 BILLP   BILCHS  6  5 BILLP   
BILGAN  5 37 BILLP   BILJOB  6  3 BILLP   BILLP   6 26 BILLP   BILLP1  6 28 BILLP   
BILLSW  1 17 BILLP   BILLTO  5  5 BILLP   BILNAM  5 39 BILLP   BILPGS  6  4 BILLP   
BILPRO  6  1 BILLP   BILREC  5 36 BILLP   BILTIM  6  2 BILLP   BILUUN  5 38 BILLP   
BLNO    5 16 BILLP   BLX     5 17 BILLP   BM1     4 31 BILLP   BM2     4 32 BILLP   
BM3     4 33 BILLP   BM4     4 34 BILLP   BM5     4 35 BILLP   BM6     4 36 BILLP   
BM7     4 37 BILLP   BPOINT  5 23 BILLP   BREG    5 14 BILLP   BT1     7 34 BILLP   
BT2     7 35 BILLP   BUSYCT  7 19 BILLP   BUUN    5  9 BILLP   BWD5    5  7 BILLP   
CHCNT   5 15 BILLP   CKC1    4  1 BILLP   CKC2    4  5 BILLP   CKCHAR  3 38 BILLP   
CKF     2 21 BILLP   CKF1    2 22 BILLP   CKF2    2 23 BILLP   CLBUF   4 17 BILLP   
CRET    1  4 BILLP   DATE    7 20 BILLP   DAY     7 36 BILLP   ECPARW  5  4 BILLP   
EDIST   5 11 BILLP   EFDPT   4 39 BILLP   EGAN    5  2 BILLP   ENTBY   4 38 BILLP   
EREG    5 12 BILLP   EUUN    5  3 BILLP   EWD5    5  1 BILLP   FBATF   9 21 BILLP   
FDLUD   5 20 BILLP   FNO     5 29 BILLP   FRSW    2 25 BILLP   GBILL1  1 24 BILLP   
GBILL2  1 26 BILLP   GBILL3  1 20 BILLP   GBILLP  1 18 BILLP   GE1     1 37 BILLP   
GE2     2  5 BILLP   GE3     2 16 BILLP   GE4     2 17 BILLP   GENTBY  1 29 BILLP   
GENTRY  2  1 BILLP   GEPTR   5 18 BILLP   GFDSW   5 30 BILLP   GFN1    8 13 BILLP   
GFN2    8 16 BILLP   GFNER   8 18 BILLP   GFNP    8 12 BILLP   GFNR    8 17 BILLP   
GJNO    2 38 BILLP   GJNO1   3  3 BILLP   GJNO2   3  9 BILLP   GPN1    8  8 BILLP   
GPNP    8  6 BILLP   GPROJ   4  6 BILLP   GPROJ1  4  9 BILLP   GPROJ2  4 14 BILLP   
GSYSNO  2 32 BILLP   GTIME   4 19 BILLP   GUNAM   3 18 BILLP   GUNAM1  3 20 BILLP   
GUNAM2  3 25 BILLP   GUNAM3  3 29 BILLP   GUNAM4  3 33 BILLP   GUNAM5  3 32 BILLP   
HNAMPT  5 19 BILLP   HPPTR   4 21 BILLP   INVUSR  1 28 BILLP   JNERR   3 10 BILLP   
JNERR1  3 11 BILLP   JNERR2  3 12 BILLP   JNFIL   3 16 BILLP   JNPTR   3 17 BILLP   
LUDBUF  5 35 BILLP   LUDLOC  5 21 BILLP   MAPLC   3 35 BILLP   MKBR1   8 29 BILLP   
MKBREC  8 24 BILLP   MKJ     3 14 BILLP   MKPTR   8  2 BILLP   MKSYM   9 26 BILLP   
MO      7 37 BILLP   MSG     1  3 BILLP   MTEMP   5 24 BILLP   NAMCNT  5 25 BILLP   
NAMPT   5 26 BILLP   NAMTEM  5 27 BILLP   NBATPT  9 24 BILLP   NBUF    5 28 BILLP   
NOSYS   2 29 BILLP   OBA1    7 13 BILLP   OBATF   8 38 BILLP   OBATF1  9  7 BILLP   
OBATF2  9  4 BILLP   OBATF3  9 17 BILLP   OBATF4  9 12 BILLP   OBATFR  8 39 BILLP   
OBERR1  9 28 BILLP   OBERR2  9 29 BILLP   OBERR3  9 32 BILLP   OBF4A   9 13 BILLP   
OPENBA  7 12 BILLP   PADJ    6 32 BILLP   PCONTA  4 15 BILLP   PCRET   1  8 BILLP   
PDNO    8  1 BILLP   PMSG    1  5 BILLP   POINT   5 31 BILLP   PPTR    4 22 BILLP   
PROBUF  4 20 BILLP   PSPACE  1 11 BILLP   RAWACT  9 25 BILLP   RAWD    5 34 BILLP   
RETRY   9 30 BILLP   RTFD    5 22 BILLP   RTRYCT  5 32 BILLP   STFILE  8 21 BILLP   
STFPT1  8 20 BILLP   SYSSW   2 30 BILLP   TERMCH  3 36 BILLP   TIMEX   7 38 BILLP   
WBA     6 36 BILLP   WTSTG   7 39 BILLP   ZERO    7 33 BILLP   
PRINTER ** FICHE/FRAME BREAK *****
SNPRINTER803
PRINT  IDENT 11-19-76  VERSION 8.03


*      GENERAL PRINTER DRIVER PACKAGE
*      PRINTS FROM DISC FILES OR MAG TAPE TO THE FOLLOWING PRINTERS:
*      CONTROL DATA CORPORATION (CDC)
*      DATA PRODUCTS (DP)
*      SCIENTIFIC DATA SYSTEMS (XDS) - PROGRAM DEFAULT DEVICE
*      VOGUE
*      2780 TYPE DEVICES

*      BUFFER LOCATIONS

PBUFF  EQU 30000B;*PRINTER BUFFER
FDBUFF EQU 10000B;*FILE AND TAPE DATA BUFFER (SHOULD BE PAGE BOUNDARY)

*      POINTERS FOR TAPE DIRECTORY ROUTINES

TFLAG  EQU FDBUFF+2;*OLD OR NEW FORMAT FLAG
TSYS   EQU FDB;*TAPE SYSTEM NO.
PDEN   EQU FDBUFF+4;*TAPE DENSITY SELECT FROM TAPE
TPOS   EQU FDBUFF+2;*TAPE POSTION NO.
TGAN   EQU FDBUFF+9;*TAPE GLOBAL ACCOUNT NO.
OTGAN  EQU FDBUFF+3;*ACCOUNT AND USER NO. (OLD TAPE FORMAT)
TUUN   EQU FDBUFF+10;*TAPE UNIVERSAL USER NO.
TFDN   EQU FDBUFF+7;*TAPE FILE DIRECTORY NO.
TUN    EQU FDBUFF+3;*TAPE USER NAME
TDT    EQU FDBUFF+12;*DATE AND TIME TAPE WRITTEN
OTDT   EQU FDBUFF+4;*DATE AND TIME TAPE WRITTEN (OLD FORMAT)
TCD    EQU FDBUFF+13;*TAPE FILE CREATION DATE
OTCD   EQU FDBUFF+5;*TAPE FILE CREATION DATE (OLD FORMAT)
TFT    EQU FDBUFF+15;*TAPE FILE TYPE
OTFT   EQU FDBUFF+7;*TAPE FILE TYPE (OLD FORMAT)
TFS    EQU FDBUFF+17;*TAPE FILE SIZE (SPARE WORD)
OTFS   EQU FDBUFF+6;*TAPE FILE SIZE (OLD FORMAT)
TFN    EQU FDBUFF+18;*TAPE FILE NAME
OTFN   EQU FDBUFFF+8;*TAPE FILE NAME (OLD FORMAT)

*      ENTRY POINT

       BRU STARTM; BRS 10
VERMSG ASC '$VERSION 8.03$/'

*      MESSAGE DRIVER

MSG    POPD 177B5,2
       BRM SAVE; BRM EXTOFF; EAX* 0; CXA; ETR =37777B; LDX =1; LDB =-1
       BRS 34; BRM RES; BRR 0
PDIV   POPD 176B5,2
       CLA; LSH 1; DIV* 0; STB DIRX; LDX =-1; SKE =0; STX PFSW; SKN PFSW
       BRU *+2; ADD =20B; BRM SCPB; LDB DIRX; BRR 0
CRET   POPD 175B5,2
       BRM SAVE; BRM EXTOFF; EAX* 0; CXA; ETR =37777B; CNA; CAX
       LDA =155B; CIO =1; BRX *-1; BRM RES; BRR 0

*      START FORK, USE TO TURN OFF EXTERNAL PRINTER WHEN JOB TERMINATED
*      ALSO TO TELL WHICH BRS (IF ANY) CAUSED AN INSTRUCTION TRAP

STARTM STA CIN; BRS 43; STP BILREL; XAB; ETR =@7777B; XAB; BRS 44
       LDA =ENTRY; STA PACK; LDA =534B5+PACK; BRS 9; BRS 113
       BRM EXTOFF; LDX PACK+6; BRU *+1,2; BRU BRS9S; BRU BRS9I
       MSG ERR1 MEMORY TRAP AT); BRU BRS9E
BRS9I  CRET 1; LDA* PACK; ETR =777B5; SKE =573B5; BRU BRS9I1; MSG ERR28 (BRS)
       MSG ERR28 (BRS); LDA* PACK; ETR =37777B; BRM TDNO; TCO =0
BRS9I1 MSG ERR2 (INSTRUCTION TRAP AT)
BRS9E  LDA PACK; BRM TONO; CRET 2; BRM PART
BRS9S  BRS 147; SKN CLSW; BRU BRS9S2; SKN TSW; SKN EXTERN; BRU *+2; BRU BRS9S2+1
       BRS 104; CXA; SKE CHAN; BRU BRS9S2+1; BRS 101; BRU BRS9S2+1
BRS9S2 BRS 17; LDX =-1; BRS 14; BRS 114; BRS 10


*      RUN AUTO TAPE DIRECTORY IF LINE FEED IN INPUT BUFFER
*      ALSO READ TERMINAL CHARACTERISTICS

ENTRY  LDX =-1; BRS 132; STA TERM
       LDA =54; LDB =PORT; LDX =1; BRS 67; LDA PORT; ETR =177B
       SKG =1; STA EXPORT
       LDX =-1; LDA =5000; BRS 164
       LDX =-1; BRS 13; BRU *+2; BRU START4
       LDA =377B; CIT CIN; SKE =152B; BRU ENTRY1; CIO CIN
       LDA =38; STA LINES
       LDA =-1; STA AUTDIR; LDA =155B; STA TERCH; BRU TR (AUTO TAPE DIR)
ENTRY1 SKE ='2'; BRU START4; CIO CIN; SKG =77B; BRU *-2
       SKR SW2780; BRU *-1; BRM SET27; CLA; STA SW2780; BRU ST4A
SW2780 ZRO;*SWITCH IF NEG ALLOWS PRESETTING 2780 MODE


*      CHECK FOR OPER STATUS IF OUTPUTTING TO SDS PRINTER
*      OR READING FROM MAG TAPE

START  ZRO; BRS 39; SKA =1B7; BRU START1
       MSG ERR5 (MIN OF OPER STATUS REQ); BRS 10

*      CHECK IF W CHANNEL BUSY

START1 BRS 104; SNE =-1; BRU START2
       XXA; SNE CHAN; BRU START2
       STX DEV; STA CHAN; MSG ERR12 (CHANNEL); LDA CHAN; BRM TDNO
       MSG ERR13 (HAS); LDX DEV; BRU *+1,2; BRU DT; BRU DT; BRU D2
DT     MSG ERR14 (TAPE DRIVE); LDA DEV; BRM TONO; BRU D3
D2     MSG ERR15 (PTR.)
D3     MSG ERR16 (ASSIGNED); BRS 10

*      ASSIGN PRINTER

START2 LDA =2; LDX =-1; BRS 101; BRS 100; BRU START5
       BRS 104; STX CHAN; BRR START
START5 MSG ERR3 (CANNOT ASSIGN PTR.); BRS 10

*      ARM ALTMODE INTERRUPT

START4 CLA; STA PIP; STA CHGSW; STA 2780SW
ST4A   LDA =INT; STA 201B; LDA =2B6; BRS 78; BRS 114; BRU START3

*      PROCESS ALTMODES

INT    ZRO ESC
$INT1   BRS 113; CLA; LDX =SP-CNTR; STA CNTR,2; BRX *-1
       LDX =-1; BRS 11; BRS 29; LDA =5000; BRS 164
       BRS 17; BRM EXTOFF; CRET 1; LDA =147B; CIO =1
       SKN RELSW; BRU INT2; BRM GNREL
INT2   SKN EXTERN; BRU INT3
       LDA RTFD; LDX =1; BRS 141 (RETURN HIM TO HIS OWN DIRECTORY)
INT3   CLA; STA EXTERN
       SKN PIP; BRU START4; BRM PART; BRU START4
ESC    ZRO
*      TYPE NO. PAGES PRINTED - PARTIAL PRINTOUT

PART   ZRO; SKN CHGSW; BRU *+2; BRM BILL
       MSG ERR17 (PART. PRINTOUT); LDA PC; ADD =1; BRM TDNO
       MSG M1 (PAGES); BRM PFN; BRM TJOB; CLA; STA PC; STA PLC; BRR PART

*      GET NO. OF LINES PER PAGE
*      IF S THEN 39, IF B THEN 54, ELSE THE NO. ENTERED

START3 CLA; STA LCSW; MSG M2 (LINES); BRM RDNO; SKG =0; BRU DEFLT
       SKG =66; BRU *+2; BRM SLCNT
       SUB =1; STA LINES; CBA
DEFRTN SNE =155B; BRU DEFLT3; SKE =152B; BRU DEFLT2
DEFLT3 STA LTERCH; BRU NXTF
DEFLT  CBA; SKE ='S'; BRU *+3; LDA =38; BRU DEFLT1
       SKE ='Q'; BRU *+4; LDA =-1; STA CLSW; BRS 10
       SKE ='V'; BRU DEFLT4; CIO CIN; MSG VERMSG; BRU START3
DEFLT4 SKE ='B'; BRU DEFLT2; LDA =53
DEFLT1 STA LINES; CIO CIN; BRU DEFRTN
DEFLT2 LDX =-1; BRS 11; CRET 1; BRU START3

*CAUSE CHG FOR AT LEAST 1 PAGE PER 66 LINES

SLCNT  ZRO; SKR LCSW; BRU *-1; BRR SLCNT

*      INPUT THE NO. OF COPIES OF EACH JOB TO BE DONE

MULT   ZRO; BRM RDNO; SUB =1; STA MULF; LDP HPT; STP PT
       BRR MULT

*      NEXT FILE NAME OR HEADING

NXTF   BRM CFILBF; LDP HPT; STP PT; CLA; STA SPC; MSG M3 (FILE)
       SKN 2780SW; BRU *+2; TCO =155B

*      ACCEPT CHARACTER FROM TEL OR COM FILE
*      ALLOW USE OF CONTROL A

       SKN 2780SW; BRU GCI; LDA =377B; CIT CIN; SKE ='.'; BRU GCI
       CIO CIN; LDA =155B; STA TERCH; BRU RET
GCI    CIO CIN; SKE =0; BRU GCX; LDP FPT1; SKSE MU; BRU GCA
       BRM MULT; BRM CFILBF; CLA; BRU GCI
GCA    LDP FPT2; SKSE STNPT; BRU GCA1; BRU GPN
GCA1   LDP FPT3; SKSE STFPT; BRU GCA2; BRU GFN
GCA2   CLA
GCX    SKE =141B; BRU GCI1; GCD PT; BRU GCX1
       CLA; WCI PT; GCD PT; NOP; BRM EXTOFF; TCO =77B (BACK ARROW); BRU GCI
GCI1   SNE =155B; BRU GCI2; SNE =152B; BRU GCI2; SNE =105B; BRU GCI2
       WCI PT; BRU GCI
GCX1   BRM EXTOFF; TCO =147B (BELL); BRU GCI

*      CHECK POINTERS FOR OPTION DESIRED

GCI2   STA TERCH; SKN 2780SW; BRU GCI3; LDA =152B; STA TERCH
GCI3   LDP FPTUSE; SKSE USE; BRU *+2; BRU SETSW
       LDP TOPT1; SKSE TOPT; BRU *+2; BRU SETEXT
       SKN EXTERN; BRM START
       LDP FPT1; SKSE FROMPT; BRU *+2; BRU FF
       LDP PT; SKSE ALLPT; BRU *+2; BRU ALLF; BRM PF; SKR MULF; BRU *-2
       SKN FNP; BRU RET; CLA; STA FNP; BRU NXTF

*      FILE PRINTED, GET NEXT FILE OR END JOB

RET    BRS 147; LDA TERCH; SNE =155B; BRU EOJ
       CLA; STA ALL; STA FSW; STA TSW; STA DIRSW
       LDA LTERCH; SKE =155B; BRU *+2; BRU NXTF; SKE =105B; BRU START3
       BRU NXTF

*      FIND OUT WHICH OUTPUT DEVICE IS DESIRED

SETEXT LDP EXTPT; SKSE PRINTE; BRU *+2; BRU PRINTX
       SKSE VOGUE; BRU *+2; BRU SVOG (SET VOGUESWITCH)
       SKSE DP; BRU *+2; BRU SDPP (SET DPSWITCH)
       SKSE CDC; BRU *+2; BRU SCDC (SET C.D.C. SWITCH - N/A)
       SKSE P2780; BRU *+2; BRU S2780
       MSG ERR18 (QMARK); BRU NXTF


*      FIND OUT WHICH HEADING IS DESIRED

SETSW  CLX; STX HSW; STX CHSW; STX TLESW; LDP HDPT
       SKSE TLE; BRU *+2; BRU STLE (OUTPUT TITLE PAGE FOR KEITH)
       SKSE HD; BRU *+2; BRU SHD (LIKE 1HEAD)
       SKSE BHD; BRU *+2; BRU SBHD (LIKE 1BIGHEAD)
       SKSE CHD; BRU *+2; BRU SCHD (LIKE 1CHEAD)
       SKSE BCHD; BRU *+2; BRU SBCHD (LIKE 1 CHEAD ONLY FOR 11 X 14 PAPER)
       SKSE LCX; BRU *+2; BRU LCA  USE LOWER CASE FOR PRINTING
       SKSE NORMAL; BRU *+2; BRU NXTF (NO HEADING)
       MSG ERR18 (QMARK); BRU NXTF

*      SET SWITCHES FOR DESIRED HEADING

STLE   LDX =-1; STX TLESW; CLX; STX TLESW1; BRU NXTF
SHD    LDX =-1; STX HSW; STX BHSW; CLX; STX ONCE; BRU NXTF
SBHD   LDX =-1; STX HSW; CLX; STX BHSW; STX ONCE; BRU NXTF
SCHD   LDX =-1; STX HSW; STX CHSW; STX BHSW
       STX ONCE; CLX; STX CSW; BRU NXTF
SBCHD  LDX =-1; STX HSW; STX CHSW; STX ONCE
       CLX; STX BHSW; STX CSW; BRU NXTF

*      USER DIRECTS PRINTING TO SDS PRINTER

PRINTX BRM START; CLA; STA EXTERN; STA CHGSW; LDA NBLTT; STA CABIT; BRU NXTF
NBLTT  NOP

*      USER DIRECTS PRINTING TO VOGUE PRINTER

SVOG   LDA =EOLV; STA EOLX; LDA =TOFV; STA TOLF; LDA =-1; STA EXTERN
       BRU SWRET

*      USER DIRECTS PRINTING TO GO TO CDC PRINTER

SCDC   LDA =EOLC; STA EOLX; LDA =TOFC; STA TOLF; LDA =-1; STA EXTERN
       LDA BLTT; STA CABIT; BRU SWRET
BLTT   BRM BLIN; ZRO; ZRO

*      USER DIRECTS PRINTING TO GO TO DP PRINTER

SDPP   LDA =EOLD; STA EOLX
SDPP1  LDA =TOFD; STA TOLF; LDA =-1; STA EXTERN; BRU SWRET
       STA EXTERN; BRM WHERE; BRM GBILL; BRU NXTF

*USER DIRECTS PRINTER TO 2780 TYPE DEVICE

S2780  SKR 2780SW; BRU *-1; LDA =EOL27; STA EOLX
       LDA     TERM
       MRG     =7B3
       LDX     =-1
       BRS     160
       BRU     SDPP1

SWRET  SKN 2780SW; BRM WHERE; SKR CHGSW; BRU *-1; BRM GBILL
       SKN SW2780; BRU NXTF; BRR SET27

SET27  ZRO; BRU S2780

*GET BILLING RELABELING AND GET BILLING INFORMATION

GBILL  ZRO; BRM GBREL; BRU GBILLP
$GBILLR BRM GNREL; BRR GBILL

GBREL  ZRO; SKN RELSW; BRU *+2; BRR GBREL
       BRS 43; XAB; XMA BILREL+1; XAB; BRS 44; SKR RELSW
       BRU *-1; BRR GBREL
GNREL  ZRO; SKN RELSW; BRR GNREL
       BRS 43; XAB; XMA BILREL+1; XAB; BRS 44; CLA; STA RELSW
       BRR GNREL
*GET BILLING RELABELING AND WRITE ACCOUNTING RECORD

BILL   ZRO; BRM GBREL; BRU BILLP
$BILLR  LDA RTFD; LDX =1; BRS 141 (RETURN TO HIS FILE DIRECTORY)
       BRM GNREL; BRR BILL

RELSW  ZRO
BILREL BSS 2

*      SET LOWER CASE SWITCH

LCA    LDA =-1; STA LCI; BRU NXTF

*      WHERE CHECKS FOR PORT ZRO OF THE TYMSAT IN THE CASE OF EXTERNAL
*      PRINTING DEVICES.

WHERE  ZRO; SKN EXPORT; BRR WHERE
       MSG ERR4 (EXTERNAL ON 0 OR 1 ONLY); BRS 10

*      STRINGS AND STRING POINTERS FOR HEAD ROUTINES

USED   ASC 'USE '
TLESTR ASC 'TITLE   '
HEAD   ASC 'HEAD    '
BIGHD  ASC 'BIGHEAD '
CHEAD  ASC 'CHEAD   '
BIGCHD ASC 'BIGCHEAD'
NORM   ASC 'NORMAL  '
VOGU   ASC 'VOGUE   '
DDDP   ASC 'DP      '
CCDC   ASC 'CDC     '
2780S  ASC '2780    '
PRTR   ASC 'PTR. '
MULTI  ASC 'COPY '
LCX    DATA 3*LCY-1,3*LCY+7
LCY    ASC "LC      "
MU     DATA 3*MULTI-1,3*MULTI+4
USE    DATA 3*USED-1,3*USED+3
HDPT   DATA 3*FILE+3,3*FILE+11
EXTPT  DATA 3*FILE+2,3*FILE+10
TLE    DATA 3*TLESTR-1,3*TLESTR+7
HD     DATA 3*HEAD-1,3*HEAD+7
BHD    DATA 3*BIGHD-1,3*BIGHD+7
CHD    DATA 3*CHEAD-1,3*CHEAD+7
BCHD   DATA 3*BIGCHD-1,3*BIGCHD+7
NORMAL DATA 3*NORM-1,3*NORM+7
VOGUE  DATA 3*VOGU-1,3*VOGU+7
DP     DATA 3*DDDP-1,3*DDDP+7
CDC    DATA 3*CCDC-1,3*CCDC+7
P2780  DATA 3*2780S-1,3*2780S-1+8
PRINTE DATA 3*PRTR-1,3*PRTR-1+8

*      GET PAGE NO. TO START AT FOR RECOVERY

GPN    BRM GBREL; BRU GPNP
$GPNR  BRM GNREL; BRU NXTF

*GET FILE NAME TO START WITH FOR RECOVERY

GFN    BRM GBREL; BRU GFNP

*      GET INDEX BLOCK POINTER FOR FILE

$GIBP   ZRO; BRS 48; BRU GIBPER; LDB =BUFF96; LDX =5; BRS 96; LDA BUFF96+4
       BRR GIBP
GIBPER MSG ERR20 (ERROR AT GIBF); BRS 10

*      TAKE FILE NAMES FROM A FILE

FF     LDA FPT; LDB PT+1; SKSE TAPE; BRU *+2; BRU TR
       BRS 64; BRU *+2; BRU FF1
       BRM ERROR; LDA CIN; SKG =0; BRU NXTF; BRS 10
FF1    STA FROM; LDA =-1; STA FSW
FF3    LDP HPT; STP PT; BRM CFILBF; LDA MULF; STA FMULF
FF4    CIO FROM; SKG =77B; BRU FF5; SNE =155B
       BRU FF2; SNE =152;; BRU FF2; SNE =137B
       BRU PSPC; SKE =135B
       BRU FF5; CIO FROM; CNA; CAX; CLA; WCI PT; BRX *-1; BRU FF4
FF5    WCI PT; BRU FF4
FF2    SKN RECSW; BRU FF6; LDP PT; BRM GIBP; SKE SWIBP; BRU FF3
       CLA; STA RECSW
FF6    BRM PF; SKR FMULF; BRU *-2; BRU FF3

*      PRINT ALL FILES IN A DIRECTORY

ALLF   CLA; STA FX; LDA =-1; STA ALL; LDA NPT; STA NPT+1
       BRM CFILBF; SKN CHSW; BRU ALLF4; MSG M4 (ENTER NAME AS (NAME)
ALLF2  CIO CIN; SKE =141B; BRU ALLF3; GCD NPT; NOP; BRM EXTOFF
       TCO =77B (BACK ARROW); BRU ALLF2
ALLF3  SKE =155B; BRU *+2; BRU *+3; WCI NPT; BRU ALLF2
ALLF4  LDA =3*ALLFIL-1; CAB; STP ALLPT1; MIN FX; LDX FX; BRS 68; BRU PSPC
       LDA MULF; STA FMULF
       LDA ALLPT1; STP ALLPT1; LDP NPT; STP NPT1; LDP HPT; STP PT
       GCI NPT1; BRU *+3; WCI PT; BRU *-3
       GCI ALLPT1; BRU *+3; WCI PT; BRU *-3; SKN RECSW; BRU ALLF5
       LDP PT; BRM GIBP; SKE SWIBP; BRU ALLF4; CLA; STA RECSW
ALLF5  BRM PF; SKR FMULF; BRU *-2; BRM CFILBF; BRU ALLF4
ALLFIL BSS 25
NAMSTR BSS 5
NPT1   BSS 2
ALLPT1 DATA 3*ALLFIL-1,3*ALLFIL-1
NPT    DATA 3*NAMSTR-1,3*NAMSTR-1

*      TAPE READ ROUTINE

TR     BRM START; LDA =-1; STA TSW; LDP HPT; STP PT

*      ASSIGN TAPE AND TEST READY

TR8    BRM AT; BRS 110; BRU *+2; BRU TR1
       MSG ERR6 (PUT TP DRIVE IN READY); BRM TT

*      TYPE TAPE DENSITY SELECT

TR1    SKN AUTDIR; BRU *+2; BRU TR9
       BRS 108; CAX; LDA DTY,2; BRM TDNO; MSG M5 (BPI)

*      GET DESIRED TAPE POSITION-RANGE

TR9    LDA MULF; STA FMULF
       CLA; STA SP; STA DDIT; STA EP; SKN AUTDIR; BRU *+2; BRU AUTO
       LDA =-1; STA LCHR; MSG M6 (POS RANGE); BRM RONO
       SKE =0; BRU *+4; LDA =7777B; STA EP; LDA =1
       STA SP; STA SSP; CBA; SKE ='   D'; BRU TR9A
AUTO   LDA ='   D'; STA DDIT; LDA =7777B; STA EP; LDA =1; STA SP
       STA SSP; BRU TDIR
TR9A   SKE ='   -'; BRU TR6; BRM RONO; STA EP; CBA
TR6    SNE =155B; BRU TR6A; SNE =152B; BRU TR6A
       LDX =-1; BRS 11; BRU TR9
TR6A   STA TTERCH
       BRM AT; LDA =4; BRS 105

*      POSITION TAPE AT SELECTED TAPE POSITION

TR2    BRM POS; BRU TR3

*      SUBROUTINE TO POSTION TAPE AT SPECIFIED POSTION

POS    ZRO; BRM AT; LDA =4; BRS 105
POS2   LDA =-1; STA TCHR
       BRM READ; LDA FDBUFF+2; SNE SP; BRR POS; SKG SP; BRU POS1
       LDA FDBUFF+2; SUB SP; ADD =1; CNA; CAX; LDA =4; BRS 105
       BRX *-2; BRU POS2
POS1   LDA SP; SUB FDBUFF+2; CNA; CAX; LDA =3; BRS 105; BRX *-2; BRU POS2

*      TAPE IS POSITIONED, GET SYSNO, USER NAME, AND FILE NAME

TR3    LDA FDBUFF+3; ETR =37777777B; STA SYSNO
       BRM READ; LDA FDBUFF+17B; ETR =77B6; SNE =23B6; BRU TR12
       LDA EP; SKE =0; BRU TR10
       MSG ERR22 (WRONG FILE TYPE); BRU TR9
TR10   MIN SP; LDA SP; SKG EP; BRU *+2; BRU TR11; BRM AT; LDA =3; BRS 105
       BRU TR2
TR12   LDA FDBUFF+20B; STA TCHR
       LDP HPT; STP PT; BRM CFILBF; LDA ='('; WCI PT
       LDA =FDBUFF+2; STA FBPT; LDX =-4
TR4    STX TX; MIN FBPT; LDB* FBPT; LDX =-3; CLA; LSH 8; WCI PT; BRX *-3
       LDX TX; BRX TR4; GCD PT; NOP; SKG =0; BRU *-3; WCI PT
       LDA ='   )'; WCI PT; LDA =FDBUFF+21B; STA FBPT
TR5    MIN FBPT; LDX =-3; LDB* FBPT; CLA; LSH 8; SNE =136B
       BRU TR7; ETR =177B; WCI PT; BRX *-6; SKN* FBPT; BRU TR5

*      GET CHARACTER COUNT SET UP AND GO PRINT FILE

TR7    LDA FBPT; SUB =FDBUFF+1; STA TX; LDA FDBUFF+1
       SUB TX; STA WORDS; BRM PF; BRU TR11

*      IF MORE RANGES GO GET NEXT RANGE ELSE REWIND AND RETURN

TR12A  LDA SSP; STA SP; BRU TR6A+1
TR11   LDA TTERCH; SKR FMULF; BRU TR12A; SKE =155B; BRU TR9
       BRM AT; LDA =6; BRS 105

*      TYPE SUBTOTAL PAGE COUNT AND GO TO NEXT FILE

PSPC   CLA; STA MULF; STA FMULF
       LDA SPC; BRM TDNO; MSG M7 (PAGES, SUB TOT)
       SKN FSW; BRU PSPC1; MSG M8 (INPUT FILE OPT); BRU RET
PSPC1  SKN ALL; BRU PSPC2; MSG M9 (ALL FILE OPT); BRU RET
PSPC2  SKN TSW; BRU PSPC3; MSG M10 (TAPE OPT); BRU RET
PSPC3  CRET 1; BRU RET

*      INITIALIZE PRINTING ROUTINE

PF     ZRO; CLA; STA FCCNT
       SKN CHSW; BRU PF2; LDB FILE; CLA; LSH 8; SNE ='('
       BRU PF2
       MSG ERR27 (USER NAME WITH CHEAD); BRU PFR
PF2    BRM INIT; SKN TSW; BRU *+2; BRU NXTCHR
       LDP PT; BRS 64; BRU *+2; BRU PF1
       SKN FSW; BRU PFR; BRM ERROR
PFR    LDA =-1; STA FNP; BRR PF
PF1    STX TCHR; STA IN; CBA; SNE =3; BRU NXTCHR
       LDA IN; BRS 20; SKN ALL; BRU *+2; BRU PFR
       MSG ERR7 (WRONG FILE TYE); BRM PFN; BRU PFR

INIT   ZRO; LDA =1+4B7; STA PBUFF+1; LDA =PBUFF+1; STA PPTR
       LDA =-1; STA LCHR; CLA; STA RECPT; SKN EXTERN; BRU INIT1
       LDA =44; STA 33WORD; LDA =2; STA 4CHAR; BRU INIT2
INIT1  LDA =32; STA 33WORD; LDA =3; STA 4CHAR
INIT2  LDA LINES; STA LC
       LDA =59; STA PAGE; BRR INIT

*      PULL CHARACTER FROM TAPE OR FILE AND SEND TO PRINTER ROUTINE

NXTCHR SKN TLESW; BRU NXTCH2; SKN TLESW1; BRU *+2; BRU NXTCH2
       LDA =-1; STA TLESW1; BRM TITLE
NXTCH2 SKN CHSW; BRU NXTCH1; SKN CSW; BRU *+2; BRU NXTCH1
       LDA =-1; STA CSW; BRM CHR
NXTCH1 BRM GCF; BRM TEST; BRM SCPB; BRU NXTCH1

*      TAKE CARE OF RETURNS, LINE FEEDS, MULTIPLE BLANKS
*      TOP OF FORM, CONTROL CHARACTERS, AND LOWER CASE CHARACTERS

TEST   ZRO; SKG =132B; BRU *+2; BRU TES; SKN LCI; SKG =100B
       BRU TES; ETR =77B; ADD =40B
TES    NOP; BRU TEST1; LDA =-1; STA TCHR; BRU EOF
TEST1  STA LCHR; SKG =77B; BRR TEST; SNE =135B
       BRU MB; SNE =155B; BRU EOL; SNE =152B
       BRU EOL; SNE =134B; BRU TOF; SNE =154B; BRU TOF
       SKN LCI; CLA; BRR TEST

*      GET CHARACTER FROM INPUT FILE

GCF    ZRO
       SKR TCHR; BRU *+2; BRU EOF
       SKN TSW; BRU *+2; BRU GCT
       SKR CHRCNT; BRU *+2; BRU GWORD
GCF1   LDB WORD; CLA; LSH 8; STB WORD; MIN FCCNT; BRR GCF

*      GET NEXT WORD FROM FILE DATA BUFFER

GWORD  SKR WORDS; BRU *+2; BRU RF
GWORD1 MIN FBPT; LDA* FBPT; STA WORD; LDA =2; STA CHRCNT; BRU GCF1

*      READ IN ANOTHER BLOCK FROM THE INPUT DATA FILE

RF     LDA =PBUFF-FDBUFF; LDX =FDBUFF; BIO IN; BRU RF1
RF2    SUB =FDBUFF; STA WORDS; LDA =FDBUFF-1; STA FBPT; BRU GWORD
RF1    STA SA; LDA IN; ETR =776B5
       SKE EOFLG; BRU RF3
RF4    LDA SA; BRU RF2
RF3    MSG ERR8 (BIO ERR); LDP PT; LDX =1; BRS 35
       CRET 1; BRU RF4

*      GET NEXT CHARACTER FROM MAG TAPE

GCT    SKR CHRCNT; BRU *+2; BRU TWORD
GCT1   LDB WORD; CLA; LSH 8; STB WORD; BRR GCF
TWORD  SKR WORDS; BRU *+2; BRU RT
       MIN FBPT; LDA* FBPT; STA WORD; LDA =2; STA CHRCNT; BRU GCT1
RT     BRM READ; LDA =FDBUFF+1; STA FBPT; LDA FDBUFF+1; STA WORDS; BRU TWORD

*      READ ONE RECORD FROM MAG TAPE

READ   ZRO; CLA; STA TER
READ5  LDA =FDBUFF; LDB =4000B; LDX =1; BRM TT; BRM AT; BRS 102
       LDA FDBUFF+1; SKE =1; BRU READ8; LDA FDBUFF+2; SKE =-1; BRU READ8
       BRU READ2
READ8  LDA FDBUFF+1; SKE =17170000B; BRU READ9; BRU READ10
READ9  LDA FDBUFF; LRSH 15; SNE =5; BRR READ; SNE =6
       BRU READ2; SKE =2; BRU READ1
READ10 SKN DIRSW; BRU *+2; BRU READ5; SKN TCHR; BRU *+2; BRU READ5
       LDA =-1; STA TCHR; BRU EOF
READ2  LDA =6; BRS 105
       MSG M11 (END TAPE AT POS); LDA SP; SUB =1; BRM TONO
       CRET 1; LDA EP; STA SP; BRU EOF

*      FATAL TAPE ERROR CONDITIONS

READ1  SKE =7; BRU READ3; MSG ERR23 (TAPE OUT READY); BRS 10
READ3  SKE =10; BRU READ4; MSG ERR24 (TAPE NO LONGER ASSGN); BRS 10

*      READ ERROR - RETRY 10 TIMES

READ4  SKN TER; BRU *+2; BRU READ6; LDA =-1; STA TER; LDA =10; STA RTRY
READ6  SKR RTRY; BRU *+2; BRU READ7; LDA =2; BRS 105; BRU READ5
READ7  MSG ERR25 (READ ERROR AT POS); LDA SP; BRM TONO
       SKN DIRSW; BRS 10; CRET 1; CLA; STA TER; BRR READ

*      ASSIGN TAPE 0 IF NOT ALREADY ASSIGNED

AT     ZRO; STA ATA; STB ATB; STX ATX
       LDA DRIVE; LDX =-1; BRS 101; BRS 100; BRU AT1
       LDA ATA; LDB ATB; LDX ATX; BRR AT
AT1    MSG ERR11 (CANNOT ASGN TAPE DRIVE); LDA DRIVE; BRM TDNO; BRS 10

*      ASSIGN PRINTER

AP     ZRO; SKN EXTERN; BRU *+2; BRR AP; STA ATA; STB ATB; STX ATX
       BRS 104; SKE =2; BRU AP1; CXA; SKE CHAN; BRU AP1; BRU AP2
AP1    LDA =2; LDX =-1; BRS 101; BRS 100; BRU AP3
AP2    LDA ATA; LDB ATB; LDX ATX; BRR AP
AP3    MSG ERR3 (CANNOT ASGN PTR); BRS 10

*      WAIT UNITL TAPE IS READY

TT     ZRO; BRS 110; BRU *-1; BRR TT

*      MULTIPLE BLANKS

MB     BRM GCF; STA MBC
MB1    SKR MBC; BRU *+2; BRU NXTCHR; CLA; BRM SCPB; MIN FCCNT; BRU MB1

*      TOP OF FORM, RETURN, AND LINE FEEDS

TOF    LDA =-1; STA TOP
EOL    BRM EOLR; BRU NXTCHR

*      PUT CHARACTER INTO PRINTER BUFFER

SCPB   ZRO

*      CHARACTER INTO WORD

       CAX; CLB; STB EOLSW; SKN EXTERN; BRU *+3; CAB; LSH 16; LDA PWORD
       LSH 6
       SKN EXTERN; BRU *+2; LSH 2; SKN EXTERN; MRG TAB,2; STA PWORD
       SKR 4CHAR; BRR SCPB

*      WORD INTO LINE

       LDA PWORD; MIN PPTR; SKN RECSW; BRU *+2; MIN RECPT; STA* PPTR; CLA; STA PWORD
       LDA =2; SKN EXTERN; LDA =3; STA 4CHAR; SKR 33WORD; BRR SCPB

*      LINE INTO BUFFER

       LDA =44; SKN EXTERN; LDA =32; STA 33WORD
       LDA =-1; STA EOLSW; LDA =1; SKN TOP; BRU SL1; CLB
       STB TOP; BRU SL2

*      ISSUE TOP OF FORM IF END OF PAGE OR IF A TOP OF FORM CHARACTER
*      CAME IN

SL1    SKR LC; BRU SL6
SL2    CAB; LDA TCHR; SKG =0; BRU *+2; BRU SL4; CBA; BRU SL6
SL4    CBA; LDB LINES; STB LC; MIN PC; MRG =4B7
       SKN LCSW; BRU SL3; XMA PLC; CLA; XMA PLC

*      PRINT IF BUFFER HAS 60 LINES OR IF LAST PAGE OF FILE

SL3    MIN PPTR; STA* PPTR; SKN RECSW; BRU SL5; MIN RECPT; CLB
       SKA =4B7; BRU *+2; BRU SL5; LDA PC; ADD =1; SKE RPN
       BRU *+2; STB RECSW
SL5    SKR PAGE; BRR SCPB

*      IF HEADING, PUT IT IN BUFFER BEFORE PRINTING

PWL    SKN DIRSW; BRU *+2; BRU PWL1; SKN HSW; BRU *+2; BRM HR
PWL1   SKN RECSW; BRU *+2; BRU PWL3
       LDA PPTR; SUB =PBUFF; SUB RECPT; CAX; LDA =PBUFF; ADD RECPT
       SKR PIP; NOP; SKN EXTERN; BRU *+2; BRM BRS106; BRM APP; BRM RDYCK
PWL2   LDA =59; STA PAGE; CLA; STA RECPT
       LDA* PPTR; STA PBUFF+1; LDA =PBUFF+1; STA PPTR
       SKN ENDF; BRR SCPB; BRU PWLR
PWL3   CLA; STA FCCNT; BRU PWL2
APP    ZRO; BRM AP; BRS 106; BRR APP

SL6    SKN LCSW; BRU SL3; STA PT1; MIN PLC; LDA PLC
       SKG =65; BRU SL7; MIN PC; CLA; STA PLC
SL7    LDA PT1; BRU SL3

*      CHECK IF PRINTER OUT OF READY

RDYCK  ZRO; LDX RECPT; LDA PBUFF,2; LRSH 15; SNE =7; BRU NTRDY
       SNE =13B; BRU PNLA; BRR RDYCK
NTRDY  CLA; LDX RECPT; STA PBUFF,2; LDX =-1; BRS 11
       MSG ERR10 (PTR OUT OF READY); LDA PC; ADD =1; BRM TDNO
       MSG ERR26 (TYPE CR TO CONT); LDX =-1; BRS 14; BRS 11
       CIO =0; SKE =155B; BRS 10; BRU PWL1
PNLA   MSG ERR9 (PTR NO LONGER ASGN); BRM PART; BRS 10

*      END OF FILE, PRINT WHAT IS LEFT IN PRINTER BUFFER
*      AND SET UP FOR NEXT FILE OR GO TO END OF JOB

EOF    LDA =-1; STA ENDF; SKN DIRSW; BRU *+2; BRU EOF2; LDA LCHR
EOF1   SNE =155B; BRU EOF2; SNE =152B; BRU EOF2
       SNE =134B; BRU EOF2; SNE =154B; BRU EOF2
       SNE =-1; BRU PWLR; BRM EOLR
EOF2   LDA PPTR; SKE =PBUFF+1; BRU PWL; BRU PWL2

*      PRINTING DONE ON THIS FILE

PWLR   SKN DIRSW; BRU *+2; BRU PWLR2
       SKN HSW; BRU PWLR2; SKN PWLRS; BRU *+2; BRU PWLR2; LDA =-1; STA PWLRS
       LDA PC; SKE =0; BRU PWLR3; LDA LCHR; SNE =-1; BRU PWLR2
PWLR3  LDA PC; ADD =1; SKA =1; BRU *+2; BRU PWLR2; LDA =1; STA TCHR
       LDA =-1; STA TOP; BRM EOLR; BRM EOLR; BRU PWL1
PWLR2  CLA; STA PWLRS; SKN TSW; BRU *+2; BRU *+3; LDA IN; BRS 20; LDA PC
       SKE =0; BRU PWLR1; LDA LCHR; SKE =-1; BRU PWLR1; CLA; BRU *+3
PWLR1  SKN CHGSW; BRU *+2; BRM BILL
       SKN 2780SW; BRU PWLR4; BRM EXTON; TCO =214B
PWLR4  LDA PC; ADD =1; ADM TPC; ADM SPC; BRM TDNO
       MSG M1 (PAGES); BRM PFN; BRM TJOB; CLA; STA PC; STA PLC; STA PIP
       STA WORDS; STA EOFSW; STA TOP; STA CHRCNT; STA ENDF
       STA ONCE; STA CSW; STA TLESW1; STA HPC; STA EOLSW
       SKN DIRSW; BRU *+2; BRU TDIR1; SKN TSW; BRR PF
       LDA EP; SKG =0; BRR PF; MIN SP; LDA SP; SKG EP; BRU TR2; BRR PF

*      END OF JOB

EOJ    MSG M12 (PGS PRT); LDA TPC; BRM TDNO; CRET 1; BRM TJOB
       LDA =-1; STA CLSW; BRS 10

*      PRINT FILE NAME

PFN    ZRO; LDP PT; LDX =1; BRS 35; CRET 1; BRR PFN

*      ERROR MESSAGE

ERROR  ZRO; MSG ERR21 (ERROR NAME); BRM PFN; BRR ERROR

*      END OF LINE ROUTINE - FINISHES OUT CURRENT LINE WITH BLANKS

EOLR   ZRO; SKN EOLSW; BRU EOLR3
EOLR1  CLA; STA EOLSW; BRR EOLR
EOLR2  SKN EOLSW; BRU *+2; BRU EOLR1
EOLR3  CLA; BRM SCPB; BRU EOLR2

*      HEAD ROUTINE, GOES THROUGH PRINTER BUFFER AND PUTS IN
*      THE HEADING AND PAGE NUMBERS

HR     ZRO; SKN ONCE; BRU *+2; BRU HR1; LDA PBUFF+2; STA HWRD1
       LDA PBUFF+3; SKN EXTERN; ETR =7777B4; SKN EXTERN
       MRG =6060B; STA HWRD2; LDA =-1; STA ONCE
HR1    LDA =PBUFF-45; SKN EXTERN; LDA =PBUFF-33; STA HPTR
       LDA =59; SUB PAGE; STA HC
HR2    SKR HC; BRU *+2; BRR HR; LDA =46; SKN EXTERN
       LDA =34; ADM HPTR; SKN* HPTR
       BRU HR2; MIN HPC; LDA HPC; SKG =1; BRU HR5
       SKN CSW; BRU HR3; BRU HR4
HR5    SKN CSW; BRU *+2; BRU HR2; LDA HPTR; ADD =20
       SKN BHSW; BRU *+2; BRU *+5; ADD =7; SKN EXTERN; BRU *+2; ADD =2
       BRM OD; BRU HR4
HR3    LDA HPTR; ADD =22; SKN EXTERN; BRU *+2; ADD =7; SKN BHSW
       BRU *+2; BRU *+5; ADD =7; SKN EXTERN; BRU *+2; ADD =2; CAX
       LDA HWRD1; STA 0,2; EAX 1,2
       LDA HWRD2; STA 0,2
HR4    BRM OPN; BRU HR2

*      OUTPUT PAGE NO.

       DATA 20B,20B,20B,20B
DIGIT  EQU *
       DATA 1000,100,10,1
FACTOR EQU *
OPN    ZRO; LDA HPTR; ADD =25; SKN EXTERN; BRU *+2; ADD =8; SKN BHSW
       BRU *+2; BRU *+5; ADD =7; SKN EXTERN; BRU *+2; ADD =2; CAX
       LDA PGWRD; SKN EXTERN; BRU *+2; LDA PGEXT; STA 0,2; EAX 1,2
       STX HPTR1; LDX =-4; LDA HPC; SKN CSW; BRU *+2; SUB =1; CAB
       LSH 1; CLA; DIV FACTOR,2
       ADM DIGIT,2; BRX *-4; SKN EXTERN; BRU *+2; BRU OPNEXT; LDX =-4
OPN2   STX SX; LDX DIGIT,2; SKN EXTERN; BRU *+3; CXB; LSH 16
       LDA* HPTR1; SKN EXTERN; CLB; LSH 6; SKN EXTERN; BRU *+2; LSH 2
       SKN EXTERN
       MRG TAB,2; STA* HPTR1; LDX SX; BRX OPN2; LDA HPC; SKN CSW
       BRU *+2; SUB =1; SKG =999; MIN Z; SKG =99; MIN Z; SKG =9; MIN Z
       LDX Z; LDA* HPTR1; ETR Z1,2; MRG Z2,2; STA* HPTR1; CLA; STA Z
       LDX =-4; LDA =20B; STA DIGIT,2; BRX *-1; BRR OPN
Z1     DATA -1,777777B,7777B,77B
Z2     DATA 0,60B6,6060B4,606060B2
OPNEXT LDA DIGIT-4; SKG =20B; CLA
       ADD PGEXT+1; STA* HPTR1; MIN HPTR1; CLB; LDX =-3
OPNET  LDA DIGIT,2; SKE =20B; BRU ONET+2; BRX OPNET
OXET   STA* HPTR1; LDA =20B; LDX =-4; STA DIGIT,2; BRX *-1; BRR OPN
ONET   LSH 8; ADD DIGIT,2; BRX ONET; BRU OXET

*      OUTPUT DATE AND TIME AND YEAR

OD     ZRO; STA HPTR1; LDA DATE1; CAB; STP DATEPT; BRS 140
       LDP DATE1; STP DATEPT; CLA; STA ODWRD; LDX =-3; SKN EXTERN
       LDX =-4
OD1    STX SX; GCI DATEPT; BRR OD; SKN TLESW; BRU *+2; BRU *+3
       SKN CSW; BRU OD2; BRM SAVE; BRM SCPB; BRM RES; BRU OD3
OD2    CAX; SKN EXTERN; BRU *+3; CXB; LSH 16; LDA ODWRD; SKN EXTERN
       CLB; LSH 6; SKN EXTERN; BRU *+2; LSH 2
       SKN EXTERN; MRG TAB,2; STA ODWRD
OD3    LDX SX; BRX OD1; SKN TLESW; BRU *+2; BRU OD1-1
       SKN CSW; STA* HPTR1; MIN HPTR1; BRU OD1-3
DATE   BSS 6
DATE1  DATA 3*DATE-1,3*DATE+15
DATEPT DATA 3*DATE-1,3*DATE-1

*      MACRO TO PRINT STRINGS STARTING AT A SPECIFIED CHARACTER POSITION

LP     MACRO D,H,2
       LDA =D(1); BRM LPR1; BRU H(2)
H(1)   TEXT 'D(2)/'
H(2)   LDA =H(1); BRM LPR; ENDM

*      PUTS OUT CHEAD HEADING

CHR    ZRO; LDA =CNTR; LDX =11; BRS 7; LDB CNTR; LDX =-1; CLA; LSH 8
       SKG =0; BRU *+2; BRU *+4; LSH 8; CLX
       SNE ='C'; LDX =1
       SNE ='N'; LDX =2
       SNE ='V';  LDX =3
       SNE ='H'; LDX =4
       SNE ='P'; LDX =5
       STX NCO
       LP 47,(PRINTED AT); BRM EOLR; LDX NCO; BRU CTAB,2
CHR1A  LP 40,(NATIONAL COMPUTER CENTER); BRU CHR2
CHR1   LP 39,(NEW JERSEY COMPUTER CENTER); BRU CHR2
CHR1B  LP 38,(VALLEY FORGE COMPUTER CENTER); BRU CHR2
CHR1C  LP 40,(HOUSTON COMPUTER CENTER; BRU CHR2
CHR1D  LP 41,(PARIS COMPUTER CENTER)
CHR2   BRM EOLR; LP 45,(TYMSHARE, INC.); BRM EOLR; BRM EOLR
       LDX NCO; BRU CTAB1,2
CHR3A  LP 41,(CUPERTINO, CALIFORNIA); BRU CHR4
CHR3   LP 38,(ENGLEWOOD CLIFFS, NEW JERSEY); BRU CHR4
CHR3B  LP 39,(VALLEY FORGE, PENNSYLVANIA); BRU CHR4
CHR3C  LP 43,(HOUSTON, TEXAS); BRU CHR4
CHR3D  LP 43,(PARIS, FRANCE)
CHR4   BRM EOLR; BRM EOLR; LDA NCO; SKG =0; BRU CHR5
       LP 47,(SYSTEM ); BRM PSYSNO
CHR5   RPT 6; BRM EOLR; ENDR
       LP 0,(FROM THE DIRECTORY OF: ); BRM LPN
       RPT 3; BRM EOLR; ENDR; LP 0,(FILE NAME:    )
       BRM LPFN; RPT 5; BRM EOLR; ENDR
       LP 0,(DATE AND TIME:  ); BRM OD; BRM EOLR
       LDA =-1; STA TOP; BRM EOLR; BRR CHR
CTAB   BRU CHR2; BRU CHR1A; BRU CHR1; BRU CHR1B; BRU CHR1C; BRU CHR1D
CTAB1  BRU CHR4; BRU CHR3A; BRU CHR3; BRU CHR3B; BRU CHR3C; BRU CHR3D

*      SUBROUTINE, PART OF LP MACRO

LPR    ZRO; STA SA1
L1     LDX =-4; LDB* SA1; STB SB
L3     STX LPRX; LDB SB; CLA; LSH 6; SNE =17B; BRR LPR
       STB SB; BRM SCPB; MIN FCCNT; LDX LPRX; BRX L3
       MIN SA1; BRU L1

*      SUBROUTINE, PART OF LP MACRO

LPR1   ZRO; SKG =0; BRR LPR1; SKN BHSW; BRU *+2; BRU *+5; ADD =15
       SKN EXTERN; BRU *+2; ADD =5; CNA; CAX; STX LPX
       CLA; BRM SCPB; MIN FCCNT; LDX LPX; BRX *-5; BRR LPR1

*      PRINT SYSTEM NO.

PSYSNO ZRO; SKN TSW; BRU *+2; BRU SYS1-1
       LDA =SYSNO; LDX =11; BRS 7; LDX =-3
SYS1   STX SYSX; LDB SYSNO; CLA; LSH 8; STB SYSNO
       BRM SCPB; MIN FCCNT; LDX SYSX; BRX SYS1; BRR PSYSNO
SYSNO  ZRO;*SYSTEM NO.

*      LINE PRINT USER NAME

LPN    ZRO; LDA =FILE; STA LPT
LPN3   LDB* LPT; STB LPNB; LDX =-3
LPN2   STX LPNX; LDB LPNB; CLA; LSH 8; STB LPNB; SNE ='('
       BRU LPN1; SNE ='   )'; BRR LPN; BRM SCPB; MIN FCCNT
LPN1   LDX LPNX; BRX LPN2; MIN LPT; BRU LPN3

*      LINE PRINT FILE NAME

LPFN   ZRO; SKN TLESW; BRU LPFN6; LDA NOPINS; STA LPFN5
       LDA BRMINS; STA LPFN4; BRU LPFN7
LPFN6  LDA SKEINS; STA LPFN5; LDA NOPINS; STA LPFN4
LPFN7  LDA =74; STA LPFC; LDA =FILE; STA LPT
LPFN3  LDB* LPT; STB LPNB; LDX =-3
LPFN2  STX LPNX; LDB LPNB; CLA; LSH 8; STB LPNB
LPFN5  SKE ='   )'; BRU LPFN4; LDA LPFN4; STA LPFN5; LDA BRMINS
       STA LPFN4; BRU *+2
LPFN4  NOP; SKR LPFC; BRU *+2; BRR LPFN; LDX LPNX; BRX LPFN2
       MIN LPT; BRU LPFN3

*      CELLS USED BY CHEAD ROUTINES

ODWRD  ZRO;*USED BY DATE ROUTINE WHEN DOING CHEAD
LPX    ZRO;*X REG SAVE CELL
LPFC   ZRO;*COUNTDOWN FOR NO. OF CHARACTERS IN A FILE
SA1    ZRO;*A REG SAVE CELL
SB     ZRO;*B REG SAVE CELL
LPNB   ZRO;*SAME
LPNX   ZRO;*SAME
LPRX   ZRO;*SAME
SYSX   ZRO;*SAME
LPT    ZRO;*POINTER
NOPINS NOP
SKEINS SKE ='   )'
BRMINS BRM SCPB

*      OUTPUT TITLE PAGE

TITLE  ZRO
       LP 0,(FILE NAME:     ); BRM LPFN; BRM EOLR; BRM EOLR
       LP 0,(DATE AND TIME: ); BRM OD; BRM EOLR; BRM EOLR
       LP 0,(SYSTEM NUMBER: ); BRM PSYSNO; BRM EOLR
       LDA =-1; STA TOP; BRM EOLR; BRR TITLE

*      TAPE DIRECTORY ROUTINES

*      SET UP TO DO TAPE DIRECTORY

TDIR   CLA; STA DTERCH; SKN AUTDIR; BRU TDIR5
       BRM AT; BRM TT; LDA =6; BRS 105; BRU TDIR3
TDIR5  CIO CIN; SKE =155B; BRU TDIR4; BRM AT; LDA =6
       BRS 105; BRU TDIR3
TDIR4  SKE =152B; BRU TR9
TDIR2  MSG M13 (FROM POS); BRM RONO; STA SP; CBA
       SNE =155B; BRU *+3; SKE =152B; BRU TDIR2; STA DTERCH
       BRM POS; BRM AT; LDA =2; BRS 105
TDIR3  LDB =-1; STB BHSW; CLB; LDA LINES; SKG =50; BRU *+4; STB BHSW
       LDA =62; BRU *+2; LDA =34; STA MAX; LDA =-1; STA TCHR; STA DIRSW
       LDP DIRPT; STP PT; BRM READ; BRM READ; BRM ONFLAG; LDA OTDT
       SKN OTFLAG; LDA TDT; STA TAPE0; LDA =2; BRS 105; LDA =2; BRS 105
       BRU DIR

*      TAPE DIRECTORY PRINTED - GET NEXT OPTION

TDIR1  LDA =1; STA SP; LDA =7777B; STA EP
       LDX DRIVE; LDA DRIVEC,2; STA DRIVE; BRM AT; BRS 110; BRU TDIRE
       BRM READ; BRM READ; BRM ONFLAG; LDA OTDT; SKN OTFLAG; LDA TDT
       LDX DRIVE; XMA TAPE0,2; SNE TAPE0,2; BRU TDIRE
       LDA =2; BRS 105; LDA =2; BRS 105; BRU DIR
TDIRE  LDA DTERCH; SNE =152B; BRU TDIR2; LDA TTERCH; SNE =152B
       BRU TR9; BRM AT; BRS 110; BRU *+3; LDA =6; BRS 105
       SKR MULF; BRU DIR; BRU RET

*      SUBROUTINE TO PRINT TAPE DIRECTORY ON ONE LINE

DIR    BRM AT; BRM INIT; CLA; STA PVSYS; STA PVDEN; STA PDHSW
DIR1   BRM READ; BRM CKTPOS; BRM CHSD; BRM PDH; BRM PTP
       BRM READ; BRM ONFLAG; BRM PUN; BRM PGAN; BRM PUUN
       BRM PFDN; BRM PDT; BRM PCD; BRM PFT; BRM PFS; BRM PTFN
       BRM AT; LDA =3; BRS 105; LDA =155B; STA LCHR; STA TCHR; MIN SP; BRU DIR1

*      CHECK IF OLD OR NEW TAPE FORMAT

ONFLAG ZRO; LDA TFLAG; LDB =-1; SKE =55555555B; CLB; STB OTFLAG; BRR ONFLAG

*      CHECK IF VALID TAPE POSITION RECORD

CKTPOS ZRO; LDA FDBUFF+1; SNE =3; BRR CKTPOS
       LDA =3; BRS 105; BRU DIR1

*      CHECK IF SYSTEM NO. AND DENSITY STILL THE SAME
*      ALSO CHECK FOR END OF TAPE 

CHSD   ZRO; LDA TSYS; SKE PVSYS; BRM PSN; LDA PDEN; SKE PVDEN; BRM PSD; BRR CHSD

*      PRINT SYSTEM NO. FROM TAPE

PSN    ZRO; BRM EOLR; LP 26,(FOLLOWING FILES STORED FROM SYSTEM )
       LDA TSYS; STA PVSYS; ETR =37777777B; CAB; LDX =-3; CLA; LSH 8; STB DIRB
       STX DIRX; BRM SCPB; LDB DIRB; LDX DIRX; BRX *-7; BRM EOLR
       BRM EOLR; BRR PSN

*      PRINT TAPE DENSITY SELECT SETTING

PSD    ZRO; CLA; STA PFSW; LP 26,(FOLLOWING FILES STORED AT ); LDB PDEN; STB PVDEN
       PDIV =100; PDIV =10; CBA; ADD =20B; BRM SCPB
       LP 0,( BPI); BRM EOLR; BRM EOLR; BRR PSD

*      PRINT TAPE DIRECTORY HEADING

PDH    ZRO; SKN PDHSW; BRU *+2; BRR PDH; LDA =-1; STA PDHSW
 LP 0,(TAPE   TAPE        GLOBAL UNIVER FILE  DATE AND TIME CREATION FIL FILE); BRM EOLR
 LP 0,( POS USER NAME     ACT NO USR NO  DIR   TAPE WRITTEN   DATE   TYP SIZE FILE NAME AND COMMENT)
       BRM EOLR; BRM EOLR; BRR PDH

*      PRINT OCTAL NO.

PDRN   ZRO; CLA; LSH 3; SKE =0; BRU PDRN2; BRM PDRN1; BRX *-5; BRR PDRN
       CLA; LSH 3
PDRN2  ADD =20B; BRM PDRN1; BRX *-4; BRR PDRN
PDRN1  ZRO; STB DIRB; STX DIRX; BRM SCPB; LDB DIRB; LDX DIRX; BRR PDRN1

*      PRINT TAPE POSITION

PTP    ZRO; LDB TPOS; LSH 12; LDX =-4; BRM PDRN; BRR PTP

*      PRINT GLOBAL ACCOUNT NO.

PGAN   ZRO; SKN OTFLAG; BRU PGAN1; LDX =-5; BRM TSPACE; LDA OTGAN; ETR =377B4
       LRSH 12; ABC; LSH 1; DIV =8; STB DIRB; ADD =40B; BRM SCPB
       LDA DIRB; SKG =0; LDA =8; ADD =20B; BRM SCPB; BRR PGAN
PGAN1  CLA; BRM SCPB; LDA TGAN; ETR =1777777B; CAB; LSH 3; LDX =-7; BRM PDRN; BRR PGAN

*      PRINT UNIVERSAL USER NO.

PUUN   ZRO; SKN OTFLAG; BRU PUUN1; LP 0,(   N); LDA ='   /'; BRM SCPB
       LP 0,(A ); BRR PUUN
PUUN1  CLA; BRM SCPB
       LDA TUUN; ETR =377777B; CAB; LSH 6; LDX =-6; BRM PDRN; BRR PUUN

*      PRINT TAPE DATE AND TIME WRITTEN

PDT    ZRO; SKN OTFLAG; BRU PDTN; LDX =-2; BRM TSPACE
PDTN   CLA; BRM SCPB; LDA OTDT; SKN OTFLAG; LDA TDT; ETR =36B5; LRSH 16; ADD =1 (MONTH)
       BRM P2D; LDA ='   /'; BRM SCPB
       LDA OTDT; SKN OTFLAG; LDA TDT; ETR =177777B; ABC; LSH 1; DIV =1440; STB DIRBB (DAY)
       ADD =1; BRM P2D
       SKN OTFLAG; BRU PDT1; CLA; BRM SCPB; BRU PDT2
PDT1   LDA ='   /'; BRM SCPB; LDA TDT; LRSH 20; ADD =64; BRM P2D; CLA; BRM SCPB (YEAR)
PDT2   LDB DIRBB; CLA; LSH 1; DIV =60; STB DIRBB; BRM P2D (HOUR)
       LDA ='   :'; BRM SCPB; LDA DIRBB; BRM P2D; SKN OTFLAG; BRR PDT
       CLA; BRM SCPB; BRR PDT

*      PRINT TAPE FILE CREATION DATE

PCD    ZRO; SKN OTFLAG; BRU PCDN; CLA; BRM SCPB
PCDN   CLA; BRM SCPB; LDA OTCD; SKN OTFLAG; LDA TCD; ETR =740B; LRSH 5; ADD =1 (MONTH)
       BRM P2D; LDA ='   /'; BRM SCPB; LDA OTCD; SKN OTFLAG; LDA TCD; ETR =37B; ADD =1 (DAY)
       BRM P2D; SKN OTFLAG; BRU PCD1; LDX =-2; BRM TSPACE; BRR PCD
PCD1   LDA ='   /'; BRM SCPB
       LDA TCD; ETR =17B3; LRSH 9; ADD =64; BRM P2D; BRR PCD (YEAR)

*      PRINT 2 DECIMAL DIGITS

P2D    ZRO; ABC; LSH 1; DIV =10; STB DIRB; ADD =20B; BRM SCPB; LDA DIRB
       ADD =20B; BRM SCPB; BRR P2D

*      PRINT FILE SIZE (IN DBITS)

PFS    ZRO; CLA; STA PFSW; BRM SCPB; LDA OTFS; ETR =7777B; SKN OTFLAG; LDA TFS; CAB
       PDIV =1000; PDIV =100; PDIV =10; CBA; ADD =20B; BRM SCPB; BRR PFS

*      PRINT FILE DIRECTORY POINTER

PFDN   ZRO; CLA; BRM SCPB; SKN OTFLAG; BRU PFDN1; LDA OTGAN; ETR =3777B
       CAB; BRU PFDN1+1
PFDN1  LDB TFDN; LSH 12; LDX =-4; BRM PDRN; BRR PFDN

*      PRINT TAPE USER NAME

PUN    ZRO; SKN OTFLAG; BRU PUN3; LP 0,( (OLD FORMAT) ); BRR PUN
PUN3   CLA; BRM SCPB; LDA =TUN-1; STA TUNPT; LDX =-4
PUN1   STX DIRA; MIN TUNPT; LDB* TUNPT; LDX =-3
PUN2   CLA; LSH 8; STB DIRB; STX DIRX; BRM SCPB; LDB DIRB; LDX DIRX
       BRX PUN2; LDX DIRA; BRX PUN1; BRR PUN

*      PRINT FILE NAME

PTFN   ZRO; CLA; BRM SCPB; CLA; STA DIRW; LDA =OTFN-1; SKN OTFLAG; LDA =TFN-1; STA TUNPT; LDX =-24
PTFN1  STX DIRA; MIN TUNPT; LDA* TUNPT; ETR =37777777B; CAB; LDX =-3
PTFN2  CLA; LSH 8; SNE =136B; BRU PTFNR; STB DIRB; STX DIRX
       SKG =132B; SKG =100B; BRU *+3; ETR =77B; ADD =40B; SKG =77B
       BRU *+6; STA DIRA1; LDA =6; BRM PFNC; LDA DIRA1
       SUB =100B; BRM PFNC; LDB DIRB; LDX DIRX; BRX PTFN2; SKN* TUNPT
       BRU *+2; BRU PTFNR; LDX DIRA; BRX PTFN1
PTFNR  BRM EOLR; BRR PTFN

*      PRINT A FILE NAME CHARACTER - WRAP AROUND IF NECESSARY

PFNC   ZRO; STA DIRA3; MIN DIRW; LDA DIRW; SKE MAX; BRU PFNC1; BRM EOLR
       LDX =-71; CLA; STX DIRA2; BRM SCPB; LDX DIRA2; BRX *-4
       LDA =1; STA DIRW
PFNC1  LDA DIRA3; BRM SCPB; BRR PFNC

*      PRINT FILE TYPE

PFT    ZRO; CLA; BRM SCPB; LDA OTFT; SKN OTFLAG; LDA TFT; LRSH 18; ETR =7
       SKG =4; SKG =0; CLA; CAX; BRU* *+1,2; DATA PFT0,PFT1,PFT2,PFT3,PFT4
PFT0   LP 0,(BAD); BRR PFT
PFT1   LP 0,( GO); BRR PFT
PFT2   LP 0,(BIN); BRR PFT
PFT3   LP 0,(SYM); BRR PFT
PFT4   LP 0,(DUM); BRR PFT

*      PRINT SPACES AS SPECIFIED IN X (NEGATIVE)

TSPACE ZRO; STX DIRX; CLA; BRM SCPB; LDX DIRX; BRX *-4; BRR TSPACE

*      CELLS USED BY TAPE DIRECTORY ROUTINE

JSP    0;*NO. OF SPACES TO JUSTIFY FILE SIZE NO.
DIRA   0;*SAVE REGISTER
DIRA1  0;*SAVE REGISTER
DIRA2  0;*SAVE REGISTER
DIRA3  0;*SAVE REGISTER
DIRB   0;*SAME
DIRX   0;*SAME
DIRBB  0
TUNPT  0;*POINTER TO USER NAME AND FILE NAME
PVSYS  0;*PREVIOUS SYSTEM NO. (OF LAST FILE)
PVDEN  0;*PREVIOUS TAPE FILE DENSITY SELECT SETTING
PDHSW  0;*SWITCH TO ONLY PRINT TAPE DIRECTORY HEADING ONCE
PFSW   0;*HOLDS A SPACE - DIGIT DECISION
MAX    0;*MAXIMUM NO. OF WORDS OF FILE NAME BEFORE WRAP AROUND
DIRW   0;*COUNTER - PUT OUT ON NEXT LINE AFTER 10 WORDS OF FILE NAME
DTERCH 0;*MAY WANT ANOTHER TAPE DIRECTORY
OTFLAG 0;*-1 IF OLD TAPE FORMAT, 0 IF NEW FORMAT
DIRSW  0;*SWITCH ON IF IN TAPE DIRECTORY ROUTINE
DIRSTR ASC 'TAPE DIRECTORY'
DIRPT  DATA 3*DIRSTR-1,3*DIRSTR+13
AUTDIR 0;*AUTOMATIC TAPE DIRECTORY IF -1
DRIVE  0;*CURRENT DRIVE IN USE ZERO OR ONE
TAPE0  BSS 2;*DATE AND TIME TAPE ON THIS DRIVE WRITTEN
DRIVEC DATA 1,0;*USED TO CHANGE DRIVE TO POINT TO NEXT DRIVE

*      REMOTE PRINTER DRIVER SUBROUTINE
*      SAVES ALL REGISTERS

BRS106 ZRO; STA PREF; STB SB; STX PX; BRM EXTON; LDA PX; CNA; CAX
BRA    MIN PREF; BRX *+2; BRU BRR; CLA; STA SPACE; STA SPCS; LDA* PREF; SKA =4B7
       BRM* TOLF; LDB =-45; STB LB; MIN PREF; BRX *+2; BRU BRR
       
BRB    LDB* PREF; BRM CAS; MIN LB; SKN LB; BRU BRBB; MIN PREF; BRX BRB
BRBB   BRU* EOLX; ZRO; ZRO
BRR    LDA PREF; LDB SB; LDX PX; MIN BRS106; MIN BRS106; BRR BRS106

       BSS 5
PREF   DATA 0
PX     DATA 0
LB     DATA 0
SPACE  DATA 0

CX     ZRO
CAS    ZRO; STX CX; LDX =-3
CAB    CLA; LSH 8; ETR =177B; SKG =0; BRU BAC
       ADD =40B; MRG =200B
       
CABIT  NOP
       BRM SPCS; CIO =1; BRX CAB; LDX CX; BRR CAS

BAC    MIN SPACE; BRX CAB; LDX CX; BRR CAS

SPCS   ZRO; XMA SPACE; SKG =0; BRU SPCS3

SPCS1  SKG =37B; BRU SPCS2; SUB =37B; TCO =47B; BRU SPCS1

SPCS2  ADD =10B; CIO =1; CLA

SPCS3  XMA SPACE; BRR SPCS

SPX    DATA 0

*      SPEED BLANK OUTPUT ON CDC PRINTER
*      SPECIAL CODES:
*      200B= SKIP 0 LINES BEFORE PRINTING
*      201B= SKIP 1 LINE BEFORE PRINTING
*      202B= SKIP 2 LINES BEFORE PRINTING
*      207B= SKIP 3 LINES BEFORE PRINTING
*      NOTE: 203B= TURN PRINTER OFF.

BLIN   ZRO; SKN NBL; BRU *+2; BRU NBLN; STA A1; STB B1; STX X1
       LDA BLK
BL1    SKG =0; BRU BLR; SKG =1; BRU BL2
       SKN TOX; BRU *+2; BRU BL4; TCO =207B; SUB =3
BL5    SKG =0; BRU BL6; TCO =215B; BRU BL1
BL6    SKG =-1; BRU BLR; TCO =215B; TCO =201B; BRU BLR
BL4    TCO =202B; MIN TOX; SUB =3; BRU BL5
BL3    TCO =201B; MIN TOX; BRU BLR
BL2    SKN TOX; BRU *+2; BRU BL3; TCO =202B
BLR    CLA; STA BLK; LDA A1; LDB B1; LDX X1; MIN TOX; BRR BLIN

NBLN   STA A1; CLA; STA NBL; LDA BLK; SKG =0; BRU NBLN1; LDA A1
       BRU BLIN+1
NBLN1  SKN TOX; BRU *+4; TCO =200B; MIN TOX; BRU *+2
       TCO =201B; LDA A1; BRR BLIN

A1     DATA 0
B1     DATA 0
X1     DATA 0
       
NBL    DATA -1
BLK    DATA 0

EOLX   DATA 0  SWITCH FOR VOGUE,D.P. OR C.D.C. ETC. (END OF LINE).

EOL27  TCO =215B; BRU BRA     (2780)

EOLV   TCO =215B; TCO =200B; BRU BRA        ( VOGUE )

EOLD   TCO =212B; BRU BRA                     ( D.P. )

EOLC   MIN PREF; LDA* PREF; SKA =4B7; BRU BRA+1
       STA A1; LDA SPACE; SKG =134; BRU EOLC1; MIN BLK; MIN NBL; LDA A1; BRU BRA+1
EOLC1  TCO =215B;  LDA =-1; STA NBL; LDA A1; BRU BRA+1

TOLF   DATA 0  SWITCH FOR TOP OF FORM.

TOFV   ZRO; TCO =214B; BRR TOFV ( VOGUE )

TOFD   ZRO; TCO =214B; BRR TOFD           ( D.P. )

TOFC   ZRO; TCO =215B; TCO =240B ( C.D.C. - N/A)
       TCO =215B; STA A1; CLA; STA BLK; LDA =-1; STA NBL
       STA TOX
       LDA A1;  BRR TOFC
TOX    DATA 0
       BRR TOFC

*      TURN ON EXTERNAL PRINTER IF OFF, SET 8 LEVEL OUTPUT MODE

EXTON  ZRO; SKN ONOFF; BRU *+2; BRR EXTON
       LDA =-1; STA ONOFF; LDX =-1; BRS 168
       LDA     TERM
       ETR     =@16B4
       MRG =12B4; BRS 160; BRS 85; TCO =202B; BRR EXTON

*      TURN OFF EXTERNAL PRINTER IF ON, RESET 8 LEVEL OUTPUT MODE

$EXTOFF ZRO; SKN EXTERN; BRR EXTOFF; SKN ONOFF; BRR EXTOFF
       CLA; STA ONOFF; TCO =203B; LDX =-1; LDA TERM; BRS 160; BRS 86
       LDX =-1; BRS 169; BRR EXTOFF

*      TYPE OCTAL/DECIMAL NUMBERS

TONO    ZRO; STA TONOA; BRM EXTOFF; LDA TONOA; LDB =8; LDX =1; BRS 36; BRR TONO
TDNO    ZRO; STA TONOA; BRM EXTOFF; LDA TONOA; LDB =10; LDX =1; BRS 36; BRR TDNO
TJOB   ZRO; SKN CHGSW; BRR TJOB; MSG M14 (JOB NO); LDA JOBNO
       BRM TDNO; CRET 2; BRR TJOB

*      SAVE AND RESTORE REGISTERS

$SAVE   ZRO; STP SSA; STX SSX; BRR SAVE
$RES    ZRO; LDP SSA; LDX SSX; BRR RES

*      CLEAN OUT THE FILE NAME BUFFER OF CHARACTERS

CFILBF     ZRO; LDX =-25; CLA; STA FILE+25,2; BRX *-1; BRR CFILBF

*      6 BIT BCD CONVERSION TABLE

TAB    DATA 60B,71B,14B,17B,53B,57B,57B,14B
       DATA 74B,34B,54B,20B,73B,40B,33B,61B
       DATA 00B,01B,02B,03B,04B,05B,06B,07B
       DATA 10B,11B,15B,56B,36B,13B,16B,32B
       DATA 17B,21B,22B,23B,24B,25B,26B,27B
       DATA 30B,31B,41B,42B,43B,44B,45B,46B
       DATA 47B,50B,51B,62B,63B,64B,65B,66B
       DATA 67B,70B,71B,35B,76B,55B,57B,17B

*      CELLS USED BY PROGRAM

DTY    DATA 200,556,800
PGEXT  ASC 'PAGE'
PGWRD  DATA 47212725B;* THIS IS PAGE IN BCD
SSP    DATA 0 SAVE CELL FOR STARTING POS. FOR TAPE.

*      ALL CELLS FOLLOWING UP TO AND INCLUDING "CNTR" ARE ZEROED IN
*      THE PANIC ROUTINE INT.

SP     ZRO;*STARTING TAPE POSITION
DDIT   ZRO;*SET FOR REPETATIVE DIRECTORY LISTINGS.
EP     ZRO;*ENDING TAPE POSITION
TSW    ZRO;*DOING TAPE JOB IF -1
TTERCH ZRO;*TERMINATING CHARACTER AFTER TAPE POS.-RANGE
TX     ZRO;*SAVE X REG FOR TAPE ROUTINE
TER    ZRO;*TAPE READ ERROR RETRY IN PROGRESS IF -1
RTRY   ZRO;*RETRY 10 TIMES ON TAPE READ ERROR
SSA    ZRO;*SAVE A
SSB    ZRO
SSX    ZRO
Z      ZRO;*COUNTER FOR INSIGNIFICANT ZEROS
SX     ZRO;*X REG SAVE CELL
HPTR1  ZRO;*AUX HPTR
HPTR   ZRO;*USED BY HEAD ROUTINE TO POINT INTO PBUFF
ONCE   ZRO;*OUTPUT DATE AND TIME ONLY ONCE PER FILE
HWRD1  ZRO;*HEADING
HWRD2  ZRO;*HEADING
HC     ZRO;*HEAD PAGE COUNTDOWN
HPC    ZRO;*HEAD PAGE COUNTER
BHSW   ZRO;*BIGHEAD SWITCH
TLESW  ZRO;*TITLE SWITCH
TLESW1 ZRO;*-1 IF TITLE ALREADY OUTPUT
CHSW   ZRO;*-1 IF DOING CHEAD
CSW    ZRO;*-1 IF CHEAD ALREADY OUTPUT
HSW    ZRO;*-1 IF DOING HEAD
LCHR   ZRO;*LAST CHARACTER SENT DOWN THE PRINTER PIPE
ALL    ZRO;*ALL FILES BEING DONE
FSW    ZRO;*FROM FILE OPTION
FNP    ZRO;*FILE NOT PRINTED FOR SOME REASON
33WORD ZRO;*33OWRDS TO A LINE
4CHAR  ZRO;*4 CHARACTERS PER WORD FOR PRINTER
ENDF   ZRO;*END OF FILE ENCOUNTERED IN NEG
CHRCNT ZRO;*COUNTER
$CIN    ZRO;*COMMANDS INPUT FILE
EOFSW  ZRO;*END OF FILE IF ON
EOLSW  ZRO;*FILL OUT REST OF LINE IF NEG
FROM   ZRO;*FROM FILE NO.
FX     ZRO;*INDEX TO FD FOR BRS 68
IN     ZRO;*INPUT FILE
LCI    ZRO;*LOWER CASE FLAG -1= ON LC
LC     ZRO;*LINE COUNTDOWN
LINES  ZRO;*NO. OF LINES THIS SESSION
MBC    ZRO;*MULTIPLE BLANK COUNTDOWN
PAGE   ZRO;*60 LINES MAX COUNTDOWN
FBPT   ZRO;*POINTS INTO FILE DATA BUFFER
PPTR   ZRO;*POINTER INTO PRINTER BUFFER
PWORD  ZRO;*CURRENT WORD BEING BUILT FOR PRINTER BUFFER
SA     ZRO;*SAVE A REGISTER
TERCH  ZRO;*TERMINATING CHARACTER
LTERCH ZRO;*IF LINE FEED AFTER LINES THEN ASK AGAIN
TOP    ZRO;*TOP OF FORM SWITCH
SPC    ZRO;*SUBTOTAL PAGE COUNT
TPC    ZRO;*TOTAL PAGES PRINTED FOR ENTIRE SESSION
WORD   ZRO;*CURRENT WORD BEING PULLED OUT OF FILE DATA BUFFER
TCHR   ZRO;*TOTAL NO. OF CHARACTERS IN INPUT FILE
WORDS  ZRO;*WORDS LEFT TILL NEXT BIO
NCO    ZRO;*NEGATIVE IF NCO, POS IF NJ
PWLRS  ZRO;*SWITCH FOR USE WITH KICKING OUT EXTRA EVEN NUMBERED PAGE
RECPT  ZRO;*NO. OF WORDS IN BUFFER NOT TO BE PRINTED
$RECSW  ZRO;*-1 IF IN RECOVERY, ELSE ZERO
$RPN    ZRO;*PAGE NO. TO START PRINTING IN RECOVERY
$SWIBP  ZRO;*INDEX BLOCK POINTER OF START WITH FILE
BUFF96 BSS 5;*USED TO GET INDEX BLOCK POINTER
MULF   ZRO;*NO. OF COPIES -1
FMULF  ZRO;*NO. OF COPIES -1
ATA    ZRO;*SAVE REG CELL FOR ASSIGN TAPE AND PRINTER ROUTINES
ATB    ZRO;*SAVE REG CELL FOR ASSIGN TAPE AND PRINTER ROUTINES
ATX    ZRO;*SAVE REG CELL FOR ASSIGN TAPE AND PRINTER ROUTINES
TONOA   ZRO;*SAVE REG FOR PRINT NO. ROUTINES
CNTR   ZRO;*SYSTEM NO. FOR COMPUTER CENTER CALCULATION

*      END OF VOLITALE DATA STORAGE.

$2780SW ZRO;*IF NEG THEN 2780 TYPE DEVICE
EXPORT DATA -1;*IF NEG THAN NO CDC,VOGUE,DP
LCSW   ZRO;*SWITCH TO FORCE A PAGE COUNT AT LEAST EVERY 66 LINES
PLC    ZRO;*LINE COUNT TO CHG A PAGE FOR AT LEAST EVERY 66 LINES
PT1    ZRO;*TEMP CELL
$PC     ZRO;*NO. OF PAGES PUT INTO PRINTER BUFFER FOR CURRENT FILE
$FCCNT  ZRO;*NO. OF CHARACTERS PUT INTO PRINTER BUFFER FOR CURRENT FILE
TERM   ZRO;*TERMINAL CHARACTERISTICS
EXTERN ZRO;*NEG FOR EXTERNAL PRINT DESTINATION
PIP    ZRO;*IF-1 THEN SOME PRINTING HAS BEEN DONE, BUT NOT ALL YET
CHGSW  ZRO;* IF NEG THERE IS SOME UNCHARGED EXTERNAL DEVICE PRINTER DONE
PACK   BSS 7 PANIC TABLE FOR BRS 9
PORT   ZRO;*CONTAINS USERS PORT NO. OF THE NODE
CLSW   ZRO;*NEGATIVE IF NORMAL TERMINATION (BRS 101, BRS 147 AT END)
ONOFF  ZRO;*POSITIVE IF EXT PRINER OFF, NEGATIVE IF ON
CHAN   ZRO;*TELETYPE CHANNEL USING THE W CHANNEL
DEV    ZRO;*DEVICE ASSIGNED
$JOBNO ZRO;*JOB NO. FOR EXTERNAL PRINTING
EOFLG  DATA 402B5
ALLPT  DATA 3*AF-1,3*AF+8
AF     ASC 'ALL FILES'
FPT1   DATA 3*FILE-1,3*FILE+4
FPTUSE DATA 3*FILE-1,3*FILE+3
FROMPT DATA 3*FR-1,3*FR+4
FR     ASC 'FROM '
HPT    DATA 3*FILE-1,3*FILE-1
$PT     DATA 3*FILE-1,3*FILE-1
FPT    DATA 3*FILE+4
FILE   BSS 25;*FILE NAME BUFFER
TAPSTR ASC 'TAPE'
TAPE   DATA 3*TAPSTR-1,3*TAPSTR+3
TOSTR  ASC 'TO '
TOPT   DATA 3*TOSTR-1,3*TOSTR+2
TOPT1  DATA 3*FILE-1,3*FILE+2
STNSTR ASC 'START AT'
STNPT  DATA 3*STNSTR-1,3*STNSTR+7
FPT2   DATA 3*FILE-1,3*FILE+7
STFSTR ASC 'START WITH'
STFPT  DATA 3*STFSTR-1,3*STFSTR+9
FPT3   DATA 3*FILE-1,3*FILE+9
$RDNO   ZRO; LDX CIN; LDB =10; BRS 38; BRR RDNO
RONO   ZRO; LDX CIN; LDB =8; BRS 38; BRR RONO
ERR1   ASC '$MEMORY TRAP AT: /'
ERR2   ASC '$INSTRUCTION TRAP AT: /'
ERR3   ASC '$CANNOT ASSIGN PTR.$/'
ERR4   ASC '$EXTERNAL DEVICES PORTS 0 OR 1 ONLY$/'
ERR5   ASC '$MIN. OF OPER LIC. REQ.$/'
ERR6   ASC 'PUT TAPE DRIVE INTO READY$/'
ERR7   ASC 'WRONG FILE TYPE: /'
ERR8   ASC '$BIO ERROR READING /'
ERR9   ASC '$$PTR. NOT ASSIGNED$$/'
ERR10  ASC '$PTR. OUT OF READY AT APPX. PAGE /'
ERR11  ASC '$CANNOT ASSIGN TAPE DRIVE /'
ERR12  ASC '$CHANNEL /'
ERR13  ASC ' HAS/'
ERR14  ASC ' TAPE DRIVE /'
ERR15  ASC ' THE PTR./'
ERR16  ASC ' ASSIGNED$/'
ERR17  ASC 'PARTIAL PRINTOUT'
       ASC '$APPX. /'
ERR18  ASC '?$/'
ERR20  ASC '$PROGRAM ERROR AT GIBP$/'
ERR21  ASC 'ERROR ON NAME: /'
ERR22  ASC 'WRONG FILE TYPE$/'
ERR23  ASC 'TAPE DRIVE NOT READY$/'
ERR24  ASC 'TAPE DRIVE NOT ASSIGNED$/'
ERR25  ASC 'TAPE READ ERROR AT POS. /'
ERR26  ASC '$TYPE CR. TO CONTINUE: /'
ERR27  ASC 'MUST ENTER USER NAME WHEN USING CHEAD$/'
ERR28  ASC 'BRS /'
M1     ASC ' PAGES: /'
M2     ASC 'LINES:$/'
M3     ASC 'FILE: /'
M4     ASC 'ENTER USER NAME AS (NAME): /'
M5     ASC ' BPI-/'
M6     ASC 'POS-RNG: /'
M7     ASC ' PAGES: SUBTOTAL FROM /'
M8     ASC 'INPUT FILE OPTION$/'
M9     ASC 'ALL FILES OPTION$/'
M10    ASC 'TAPE OPTION$/'
M11    ASC 'END OF TAPE AT POS. /'
M12    ASC 'PAGES PRINTED: /'
M13    ASC 'FROM POS.: /'
M14    ASC 'JOB NO.: /'
       NOLIST EXT
       END
PRINTER ** FICHE/FRAME BREAK *****
SNPRINTER803 SYMSORT

SYM.  PG.LN. IDENT.

2780S   8 32 PRINT   2780SW 33 36 PRINT   33WORD 32 31 PRINT   4CHAR  32 32 PRINT   
A1     29 35 PRINT   AF     34 17 PRINT   ALL    32 28 PRINT   
ALLF   10  8 PRINT   ALLF2  10 10 PRINT   ALLF3  10 12 PRINT   ALLF4  10 13 PRINT   
ALLF5  10 19 PRINT   ALLFIL 10 20 PRINT   ALLPT  34 16 PRINT   ALLPT1 10 23 PRINT   
AP     15 17 PRINT   AP1    15 19 PRINT   AP2    15 20 PRINT   AP3    15 21 PRINT   
APP    17  6 PRINT   AT     15 10 PRINT   AT1    15 13 PRINT   ATA    33 28 PRINT   
ATB    33 29 PRINT   ATX    33 30 PRINT   AUTDIR 28  8 PRINT   AUTO   11  8 PRINT   
B1     29 36 PRINT   BAC    28 38 PRINT   BCHD    9  6 PRINT   BHD     9  4 PRINT   
BHSW   32 21 PRINT   BIGCHD  8 27 PRINT   BIGHD   8 25 PRINT   BILL    8  3 PRINT   
BILLR   8  4 PRINT   BILREL  8  8 PRINT   BL1    29 21 PRINT   BL2    29 27 PRINT   
BL3    29 26 PRINT   BL4    29 25 PRINT   BL5    29 23 PRINT   BL6    29 24 PRINT   
BLIN   29 19 PRINT   BLK    30  1 PRINT   BLR    29 28 PRINT   BLTT    7  7 PRINT   
BRA    28 17 PRINT   BRB    28 20 PRINT   BRBB   28 21 PRINT   BRMINS 22 36 PRINT   
BRR    28 22 PRINT   BRS106 28 16 PRINT   BRS9E   2 27 PRINT   BRS9I   2 24 PRINT   
BRS9I1  2 26 PRINT   BRS9S   2 28 PRINT   BRS9S2  2 30 PRINT   BUFF96 33 25 PRINT   
CAB    28 32 PRINT   CABIT  28 35 PRINT   CAS    28 31 PRINT   CCDC    8 31 PRINT   
CDC     9 10 PRINT   CFILBF 31 17 PRINT   CHAN   34 12 PRINT   CHD     9  5 PRINT   
CHEAD   8 26 PRINT   CHGSW  34  7 PRINT   CHR    20 25 PRINT   CHR1   20 35 PRINT   
CHR1A  20 34 PRINT   CHR1B  20 36 PRINT   CHR1C  20 37 PRINT   CHR1D  20 38 PRINT   
CHR2   20 39 PRINT   CHR3   21  3 PRINT   CHR3A  21  2 PRINT   CHR3B  21  4 PRINT   
CHR3C  21  5 PRINT   CHR3D  21  6 PRINT   CHR4   21  7 PRINT   CHR5   21  9 PRINT   
CHRCNT 32 34 PRINT   CHSD   24 17 PRINT   CHSW   32 24 PRINT   CIN    32 35 PRINT   
CKTPOS 24 11 PRINT   CLSW   34 10 PRINT   CNTR   33 32 PRINT   CRET    2 13 PRINT   
CSW    32 25 PRINT   CTAB   21 15 PRINT   CTAB1  21 16 PRINT   CX     28 30 PRINT   
D2      3 23 PRINT   D3      3 24 PRINT   DATE   20 12 PRINT   DATE1  20 13 PRINT   
DATEPT 20 14 PRINT   DDDP    8 30 PRINT   DDIT   32  2 PRINT   DEFLT   4 24 PRINT   
DEFLT1  4 28 PRINT   DEFLT2  4 29 PRINT   DEFLT3  4 23 PRINT   DEFLT4  4 27 PRINT   
DEFRTN  4 22 PRINT   DEV    34 13 PRINT   DIGIT  19 15 PRINT   DIR    23 38 PRINT   
DIR1   23 39 PRINT   DIRA   27 28 PRINT   DIRA1  27 29 PRINT   DIRA2  27 30 PRINT   
DIRA3  27 31 PRINT   DIRB   27 32 PRINT   DIRBB  27 34 PRINT   DIRPT  28  7 PRINT   
DIRSTR 28  6 PRINT   DIRSW  28  5 PRINT   DIRW   28  2 PRINT   DIRX   27 33 PRINT   
DP      9  9 PRINT   DRIVE  28  9 PRINT   DRIVEC 28 11 PRINT   DT      3 22 PRINT   
DTERCH 28  3 PRINT   DTY    31 32 PRINT   ENDF   32 33 PRINT   ENTRY   2 36 PRINT   
ENTRY1  3  5 PRINT   EOF    17 25 PRINT   EOF1   17 26 PRINT   EOF2   17 29 PRINT   
EOFLG  34 15 PRINT   EOFSW  32 36 PRINT   EOJ    18 12 PRINT   EOL    15 35 PRINT   
EOL27  30  5 PRINT   EOLC   30 11 PRINT   EOLC1  30 13 PRINT   EOLD   30  9 PRINT   
EOLR   18 25 PRINT   EOLR1  18 26 PRINT   EOLR2  18 27 PRINT   EOLR3  18 28 PRINT   
EOLSW  32 37 PRINT   EOLV   30  7 PRINT   EOLX   30  3 PRINT   EP     32  3 PRINT   
ERR1   34 39 PRINT   ERR10  35  9 PRINT   ERR11  35 10 PRINT   ERR12  35 11 PRINT   
ERR13  35 12 PRINT   ERR14  35 13 PRINT   ERR15  35 14 PRINT   ERR16  35 15 PRINT   
ERR17  35 16 PRINT   ERR18  35 18 PRINT   ERR2   35  1 PRINT   ERR20  35 19 PRINT   
ERR21  35 20 PRINT   ERR22  35 21 PRINT   ERR23  35 22 PRINT   ERR24  35 23 PRINT   
ERR25  35 24 PRINT   ERR26  35 25 PRINT   ERR27  35 26 PRINT   ERR28  35 27 PRINT   
ERR3   35  2 PRINT   ERR4   35  3 PRINT   ERR5   35  4 PRINT   ERR6   35  5 PRINT   
ERR7   35  6 PRINT   ERR8   35  7 PRINT   ERR9   35  8 PRINT   ERROR  18 21 PRINT   
ESC     4  9 PRINT   EXPORT 33 37 PRINT   EXTERN 34  5 PRINT   EXTOFF 30 38 PRINT   
EXTON  30 30 PRINT   EXTPT   9  1 PRINT   FACTOR 19 17 PRINT   FBPT   33  7 PRINT   
FCCNT  34  3 PRINT   FDBUFF  1 15 PRINT   FF      9 31 PRINT   FF1     9 34 PRINT   
FF2    10  2 PRINT   FF3     9 35 PRINT   FF4     9 36 PRINT   FF5    10  1 PRINT   
FF6    10  4 PRINT   FILE   34 25 PRINT   FMULF  33 27 PRINT   FNP    32 30 PRINT   
FPT    34 24 PRINT   FPT1   34 18 PRINT   FPT2   34 33 PRINT   FPT3   34 36 PRINT   
FPTUSE 34 19 PRINT   FR     34 21 PRINT   FROM   32 38 PRINT   FROMPT 34 20 PRINT   
FSW    32 29 PRINT   FX     32 39 PRINT   GBILL   7 31 PRINT   GBILLR  7 32 PRINT   
GBREL   7 34 PRINT   GCA     5 13 PRINT   GCA1    5 14 PRINT   GCA2    5 15 PRINT   
GCF    13 30 PRINT   GCF1   13 34 PRINT   GCI     5 11 PRINT   GCI1    5 18 PRINT   
GCI2    5 24 PRINT   GCI3    5 25 PRINT   GCT    14 14 PRINT   GCT1   14 15 PRINT   
GCX     5 16 PRINT   GCX1    5 20 PRINT   GFN     9 21 PRINT   GIBP    9 25 PRINT   
GIBPER  9 27 PRINT   GNREL   7 37 PRINT   GPN     9 16 PRINT   GPNR    9 17 PRINT   
GWORD  13 38 PRINT   GWORD1 13 39 PRINT   H(1)   20 20 PRINT   H(2)   20 21 PRINT   
HC     32 19 PRINT   HD      9  3 PRINT   HDPT    8 39 PRINT   HEAD    8 24 PRINT   
HPC    32 20 PRINT   HPT    34 22 PRINT   HPTR   32 15 PRINT   HPTR1  32 14 PRINT   
HR     18 33 PRINT   HR1    18 36 PRINT   HR2    18 38 PRINT   HR3    19  6 PRINT   
HR4    19 10 PRINT   HR5    19  3 PRINT   HSW    32 26 PRINT   HWRD1  32 17 PRINT   
HWRD2  32 18 PRINT   IN     33  1 PRINT   INIT   13  2 PRINT   INIT1  13  5 PRINT   
INIT2  13  6 PRINT   INT     3 39 PRINT   INT1    4  1 PRINT   INT2    4  5 PRINT   
INT3    4  7 PRINT   JOBNO  34 14 PRINT   JSP    27 27 PRINT   L1     21 21 PRINT   
L3     21 22 PRINT   LB     28 27 PRINT   LC     33  3 PRINT   LCA     8 12 PRINT   
LCHR   32 27 PRINT   LCI    33  2 PRINT   LCSW   33 38 PRINT   LCX     8 35 PRINT   
LCY     8 36 PRINT   LINES  33  4 PRINT   LP     20 18 PRINT   LPFC   22 26 PRINT   
LPFN   22 11 PRINT   LPFN2  22 16 PRINT   LPFN3  22 15 PRINT   LPFN4  22 19 PRINT   
LPFN5  22 17 PRINT   LPFN6  22 13 PRINT   LPFN7  22 14 PRINT   LPN    22  3 PRINT   
LPN1   22  7 PRINT   LPN2   22  5 PRINT   LPN3   22  4 PRINT   LPNB   22 29 PRINT   
LPNX   22 30 PRINT   LPR    21 20 PRINT   LPR1   21 28 PRINT   LPRX   22 31 PRINT   
LPT    22 33 PRINT   LPX    22 25 PRINT   LTERCH 33 12 PRINT   M1     35 28 PRINT   
M10    35 37 PRINT   M11    35 38 PRINT   M12    35 39 PRINT   M13    36  1 PRINT   
M14    36  2 PRINT   M2     35 29 PRINT   M3     35 30 PRINT   M4     35 31 PRINT   
M5     35 32 PRINT   M6     35 33 PRINT   M7     35 34 PRINT   M8     35 35 PRINT   
M9     35 36 PRINT   MAX    28  1 PRINT   MB     15 29 PRINT   MB1    15 30 PRINT   
MBC    33  5 PRINT   MSG     2  7 PRINT   MU      8 37 PRINT   MULF   33 26 PRINT   
MULT    4 37 PRINT   MULTI   8 34 PRINT   NAMSTR 10 21 PRINT   NBL    29 39 PRINT   
NBLN   29 30 PRINT   NBLN1  29 32 PRINT   NBLTT   6 35 PRINT   NCO    33 19 PRINT   
NOPINS 22 34 PRINT   NORM    8 28 PRINT   NORMAL  9  7 PRINT   NPT    10 24 PRINT   
NPT1   10 22 PRINT   NTRDY  17 16 PRINT   NXTCH1 13 15 PRINT   NXTCH2 13 13 PRINT   
NXTCHR 13 11 PRINT   NXTF    5  3 PRINT   OD     20  2 PRINT   OD1    20  5 PRINT   
OD2    20  7 PRINT   OD3    20 10 PRINT   ODWRD  22 24 PRINT   ONCE   32 16 PRINT   
ONET   19 37 PRINT   ONFLAG 24  7 PRINT   ONOFF  34 11 PRINT   OPN    19 18 PRINT   
OPN2   19 24 PRINT   OPNET  19 35 PRINT   OPNEXT 19 33 PRINT   OTCD    1 31 PRINT   
OTDT    1 29 PRINT   OTFLAG 28  4 PRINT   OTFN    1 37 PRINT   OTFS    1 35 PRINT   
OTFT    1 33 PRINT   OTGAN   1 24 PRINT   OXET   19 36 PRINT   P2780   9 11 PRINT   
P2D    26 10 PRINT   PACK   34  8 PRINT   PAGE   33  6 PRINT   PART    4 12 PRINT   
PBUFF   1 14 PRINT   PC     34  2 PRINT   PCD    26  1 PRINT   PCD1   26  5 PRINT   
PCDN   26  2 PRINT   PDEN    1 21 PRINT   PDH    24 34 PRINT   PDHSW  27 38 PRINT   
PDIV    2 10 PRINT   PDRN   25  2 PRINT   PDRN1  25  5 PRINT   PDRN2  25  4 PRINT   
PDT    25 27 PRINT   PDT1   25 33 PRINT   PDT2   25 34 PRINT   PDTN   25 28 PRINT   
PF     12 29 PRINT   PF1    12 37 PRINT   PF2    12 33 PRINT   PFDN   26 20 PRINT   
PFDN1  26 22 PRINT   PFN    18 17 PRINT   PFNC   27  6 PRINT   PFNC1  27  9 PRINT   
PFR    12 36 PRINT   PFS    26 15 PRINT   PFSW   27 39 PRINT   PFT    27 13 PRINT   
PFT0   27 15 PRINT   PFT1   27 16 PRINT   PFT2   27 17 PRINT   PFT3   27 18 PRINT   
PFT4   27 19 PRINT   PGAN   25 13 PRINT   PGAN1  25 16 PRINT   PGEXT  31 33 PRINT   
PGWRD  31 34 PRINT   PIP    34  6 PRINT   PLC    33 39 PRINT   PNLA   17 20 PRINT   
PORT   34  9 PRINT   POS    11 22 PRINT   POS1   11 27 PRINT   POS2   11 23 PRINT   
PPTR   33  8 PRINT   PREF   28 25 PRINT   PRINTE  9 12 PRINT   PRINTX  6 34 PRINT   
PRTR    8 33 PRINT   PSD    24 28 PRINT   PSN    24 21 PRINT   PSPC   12 20 PRINT   
PSPC1  12 23 PRINT   PSPC2  12 24 PRINT   PSPC3  12 25 PRINT   PSYSNO 21 34 PRINT   
PT     34 23 PRINT   PT1    34  1 PRINT   PTFN   26 34 PRINT   PTFN1  26 35 PRINT   
PTFN2  26 36 PRINT   PTFNR  27  2 PRINT   PTP    25  9 PRINT   PUN    26 26 PRINT   
PUN1   26 28 PRINT   PUN2   26 29 PRINT   PUN3   26 27 PRINT   PUUN   25 20 PRINT   
PUUN1  25 22 PRINT   PVDEN  27 37 PRINT   PVSYS  27 36 PRINT   PWL    16 37 PRINT   
PWL1   16 38 PRINT   PWL2   17  2 PRINT   PWL3   17  5 PRINT   PWLR   17 33 PRINT   
PWLR1  18  1 PRINT   PWLR2  17 38 PRINT   PWLR3  17 36 PRINT   PWLR4  18  3 PRINT   
PWLRS  33 20 PRINT   PWORD  33  9 PRINT   PX     28 26 PRINT   RDNO   34 37 PRINT   
RDYCK  17 14 PRINT   READ   14 22 PRINT   READ1  14 37 PRINT   READ10 14 29 PRINT   
READ2  14 31 PRINT   READ3  14 38 PRINT   READ4  15  3 PRINT   READ5  14 23 PRINT   
READ6  15  4 PRINT   READ7  15  5 PRINT   READ8  14 26 PRINT   READ9  14 27 PRINT   
RECPT  33 21 PRINT   RECSW  33 22 PRINT   RELSW   8  7 PRINT   RES    31 13 PRINT   
RET     5 34 PRINT   RF     14  4 PRINT   RF1    14  6 PRINT   RF2    14  5 PRINT   
RF3    14  9 PRINT   RF4    14  8 PRINT   RONO   34 38 PRINT   RPN    33 23 PRINT   
RT     14 18 PRINT   RTRY   32  8 PRINT   S2780   7 17 PRINT   SA     33 10 PRINT   
SA1    22 27 PRINT   SAVE   31 12 PRINT   SB     22 28 PRINT   SBCHD   6 29 PRINT   
SBHD    6 26 PRINT   SCDC    7  5 PRINT   SCHD    6 27 PRINT   SCPB   15 39 PRINT   
SDPP    7 11 PRINT   SDPP1   7 12 PRINT   SET27   7 27 PRINT   SETEXT  6  2 PRINT   
SETSW   6 12 PRINT   SHD     6 25 PRINT   SKEINS 22 35 PRINT   SL1    16 23 PRINT   
SL2    16 24 PRINT   SL3    16 30 PRINT   SL4    16 25 PRINT   SL5    16 33 PRINT   
SL6    17  8 PRINT   SL7    17 10 PRINT   SLCNT   4 33 PRINT   SP     32  1 PRINT   
SPACE  28 28 PRINT   SPC    33 14 PRINT   SPCS   29  1 PRINT   SPCS1  29  3 PRINT   
SPCS2  29  5 PRINT   SPCS3  29  7 PRINT   SPX    29  9 PRINT   SSA    32  9 PRINT   
SSB    32 10 PRINT   SSP    31 35 PRINT   SSX    32 11 PRINT   ST4A    3 35 PRINT   
START   3 13 PRINT   START1  3 18 PRINT   START2  3 28 PRINT   START3  4 19 PRINT   
START4  3 34 PRINT   START5  3 30 PRINT   STARTM  2 20 PRINT   STFPT  34 35 PRINT   
STFSTR 34 34 PRINT   STLE    6 24 PRINT   STNPT  34 32 PRINT   STNSTR 34 31 PRINT   
SVOG    6 39 PRINT   SW2780  3  7 PRINT   SWIBP  33 24 PRINT   SWRET   7 24 PRINT   
SX     32 13 PRINT   SYS1   21 36 PRINT   SYSNO  21 38 PRINT   SYSX   22 32 PRINT   
TAB    31 21 PRINT   TAPE   34 27 PRINT   TAPE0  28 10 PRINT   TAPSTR 34 26 PRINT   
TCD     1 30 PRINT   TCHR   33 17 PRINT   TDIR   23 11 PRINT   TDIR1  23 27 PRINT   
TDIR2  23 16 PRINT   TDIR3  23 19 PRINT   TDIR4  23 15 PRINT   TDIR5  23 13 PRINT   
TDIRE  23 32 PRINT   TDNO   31  6 PRINT   TDT     1 28 PRINT   TER    32  7 PRINT   
TERCH  33 11 PRINT   TERM   34  4 PRINT   TES    13 22 PRINT   TEST   13 20 PRINT   
TEST1  13 23 PRINT   TFDN    1 26 PRINT   TFLAG   1 19 PRINT   TFN     1 36 PRINT   
TFS     1 34 PRINT   TFT     1 32 PRINT   TGAN    1 23 PRINT   TITLE  23  1 PRINT   
TJOB   31  7 PRINT   TLE     9  2 PRINT   TLESTR  8 23 PRINT   TLESW  32 22 PRINT   
TLESW1 32 23 PRINT   TOF    15 34 PRINT   TOFC   30 21 PRINT   TOFD   30 19 PRINT   
TOFV   30 17 PRINT   TOLF   30 15 PRINT   TONO   31  5 PRINT   TONOA  33 31 PRINT   
TOP    33 13 PRINT   TOPT   34 29 PRINT   TOPT1  34 30 PRINT   TOSTR  34 28 PRINT   
TOX    30 25 PRINT   TPC    33 15 PRINT   TPOS    1 22 PRINT   TR     10 28 PRINT   
TR1    10 37 PRINT   TR10   11 35 PRINT   TR11   12 15 PRINT   TR12   11 37 PRINT   
TR12A  12 14 PRINT   TR2    11 18 PRINT   TR3    11 31 PRINT   TR4    12  1 PRINT   
TR5    12  4 PRINT   TR6    11 11 PRINT   TR6A   11 13 PRINT   TR7    12  9 PRINT   
TR8    10 32 PRINT   TR9    11  3 PRINT   TR9A   11 10 PRINT   TSPACE 27 23 PRINT   
TSW    32  4 PRINT   TSYS    1 20 PRINT   TT     15 25 PRINT   TTERCH 32  5 PRINT   
TUN     1 27 PRINT   TUNPT  27 35 PRINT   TUUN    1 25 PRINT   TWORD  14 16 PRINT   
TX     32  6 PRINT   USE     8 38 PRINT   USED    8 22 PRINT   VERMSG  2  3 PRINT   
VOGU    8 29 PRINT   VOGUE   9  8 PRINT   WHERE   8 17 PRINT   WORD   33 16 PRINT   
WORDS  33 18 PRINT   X1     29 37 PRINT   Z      32 12 PRINT   Z1     19 31 PRINT   
Z2     19 32 PRINT   
PRINTER ** FICHE/FRAME BREAK *****
BUILDPRINTER
NARP
SNPRINTER803
BPRINTER



NARP
SNPRINTER18
BPRINTERA


RES
XDDT
;TBPRINTER
30000;TBPRINTERA
;U%F
DUMP DUMPPRINTER

SAVE 3 TO 37777 ON PRINTER-GO-FILE

240
"

CHECKSUMS


CHECKSUM
.
SNPRINTER803
SNPRINTER18
BUILDPRINTER
PRINTER-GO-FILE
.
"


COM TEL
S_7%C