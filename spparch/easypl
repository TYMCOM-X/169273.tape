EASYPLOT ** FICHE/FRAME BREAK *****
EZPSYM1
CEZP1     EASYPLOT PART 1 OF 8
C         13 JULY 1972   THAD FLORYAN

       BLOCK DATA

C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,XREGTMP,YREGTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       DIMENSION YBCDLA(12),XBCDLA(12),LT(10),
     1 KXLEAD(10),KYLEAD(10),KXTRAIL(10),KYTRAIL(10),LENT(30),LSMB(21),
     2 IXGA(25),IYGA(25)

C  NEXT 2 LINES FOR PSCALE,CENTER,LOWER AND FIT'S COMMONS
      DIMENSION FILLER(8)
      COMMON FILLER

      DATA (LETTER(I),I=  1,  4)/ 3869008, 3026086, 3642186, 4602608/
      DATA (LETTER(I),I=  5,  8)/ 3000000, 2197581, 2195782, 3517308/
      DATA (LETTER(I),I=  9, 12)/ 3266208, 1219686, 3009008, 3987897/
      DATA (LETTER(I),I= 13, 16)/ 3791186, 3220086, 3466082, 3460082/
      DATA (LETTER(I),I= 17, 20)/ 3050082, 3400682, 3430086, 3446008/
      DATA (LETTER(I),I= 21, 24)/ 3650082, 3744180, 3442187, 3002286/
      DATA (LETTER(I),I= 25, 28)/ 3664208, 3644801, 3422086, 3644801/
      DATA (LETTER(I),I= 29, 32)/ 3240286, 3446080, 3062286, 3640082/
      DATA (LETTER(I),I= 33, 36)/ 3220068, 3026682, 3006682, 3172286/
      DATA (LETTER(I),I= 37, 40)/ 3772286, 3644180, 3442008, 3244780/
      DATA (LETTER(I),I= 41, 44)/ 3002286, 3420086, 3640082, 3006682/
      DATA (LETTER(I),I= 45, 48)/ 3116682, 3716682, 3537782, 3651782/
      DATA (LETTER(I),I= 49, 52)/ 3550082, 2466082, 2066481, 2466082/
      DATA (LETTER(I),I= 53, 56)/ 1196682, 2646082, 2046082, 2620682/
      DATA (LETTER(I),I= 57, 60)/ 2606481, 2224608, 2966082, 2664208/
      DATA (LETTER(I),I= 61, 64)/ 2422086, 2914608, 2224608, 2906480/
      DATA (LETTER(I),I= 65, 68)/ 2246681, 2064186, 2140286, 2602487/
      DATA (LETTER(I),I= 69, 72)/ 2026682, 1686982, 2686981, 2026682/
      DATA (LETTER(I),I= 73, 76)/ 1196682, 3260286, 2960286, 2924608/
      DATA (LETTER(I),I= 77, 80)/ 2642086, 2602487, 2090286, 2903086/
      DATA (LETTER(I),I= 81, 84)/ 2640682, 2092068, 2009168, 3927168/
      DATA (LETTER(I),I= 85, 88)/ 2184978, 2662068, 2190508, 1001944/
      DATA (LETTER(I),I= 89, 92)/ 1202442, 1124600, 1000902,       0/
      DATA (LETTER(I),I= 93, 96)/       0,       0, 1903715,      90/
      DATA (LETTER(I),I= 97,100)/       0,       0, 1782460,       0/
      DATA (LETTER(I),I=101,104)/ 1196644, 1001900, 1019005, 1019446/
      DATA (LETTER(I),I=105,108)/ 1019662, 1079002, 1007912,      19/
      DATA (LETTER(I),I=109,112)/ 1024460, 1009006, 1600446, 1094200/
      DATA (LETTER(I),I=113,116)/ 1019006, 1946600, 1900640, 1007900/
      DATA (LETTER(I),I=117,120)/ 1790022, 1196620, 1190046,      79/
      DATA (LETTER(I),I=121,124)/ 1019751,      19, 1001966, 1007922/
      DATA (LETTER(I),I=125,128)/ 1922006, 1001966, 1966002, 1970446/
      DATA (LETTER(I),I=129,132)/ 1790024, 1000196, 1007922,      79/
      DATA (LETTER(I),I=133,136)/ 1007922, 1007911,      19, 1001900/
      DATA (LETTER(I),I=137,140)/      19,      19, 1007922,       0/
      DATA (LETTER(I),I=141,144)/     190, 1001946,     196, 1000194/
      DATA (LETTER(I),I=145,148)/     790,       1, 1000920, 1000906/
      DATA (LETTER(I),I=149,152)/       0,      79,       1,      90/
      DATA (LETTER(I),I=153,156)/      19,      79, 1011946,     196/
      DATA (LETTER(I),I=157,160)/      19, 1011946, 1001974,       0/
      DATA (LETTER(I),I=161,164)/ 1001960,       1,       0, 1001196/
      DATA (LETTER(I),I=165,168)/ 1002196,       0,       0,     190/
      DATA (LETTER(I),I=169,172)/       0,       0,       0,       9/
      DATA (LETTER(I),I=173,176)/ 1001194,       0,  200000,  607906/
      DATA (LETTER(I),I=177,180)/  400079,       0,  300000,  600000/
      DATA (LETTER(I),I=181,184)/  700000,  300000,  900090,  600000/
      DATA (LETTER(I),I=185,188)/  500000,  600197,  600000,  400000/
      DATA (LETTER(I),I=189,192)/       0,  100000,  300000,  200000/
      DATA (LETTER(I),I=193,196)/  100000,  100000,  900000,  500009/
      DATA (LETTER(I),I=197,200)/  100000,  400019,  300000,  100000/
      DATA (LETTER(I),I=201,204)/  400001,  300001,       0,  200000/
      DATA (LETTER(I),I=205,208)/  200000,  200000,  800000,  100000/
      DATA (LETTER(I),I=209,212)/  800000,       0,       0,  300007/
      DATA (LETTER(I),I=213,216)/  200000,  300001,  300001,  200000/
      DATA (LETTER(I),I=217,220)/       0,       0,  800000,       0/
      DATA (LETTER(I),I=221,224)/       0,  900000,       0,  900000/
      DATA (LETTER(I),I=225,228)/  800000,  100000,  600000,  900000/
      DATA (LETTER(I),I=229,232)/  100000,  900000,       0,  900000/
      DATA (LETTER(I),I=233,236)/  700000,       0,       0,  700000/
      DATA (LETTER(I),I=237,240)/  900000,  700000,  900000,  800000/
      DATA (LETTER(I),I=241,244)/  800000,  100000,  900000,  800000/
      DATA (LETTER(I),I=245,248)/  100000,       0,  600000,       0/
      DATA (LETTER(I),I=249,252)/  700000,  800000,       0,       0/
      DATA (LETTER(I),I=253,256)/  600000,  700000,  900000,  600000/
      DATA (LETTER(I),I=257,260)/  500000,  700000,  800000,       0/
      DATA (LETTER(I),I=261,264)/  600000,       0,       0,       0/
      DATA (LETTER(I),I=265,268)/       0,       0,       0,       0/
      DATA (LETTER(I),I=269,270)/       0,       0/



       END
EASYPLOT ** FICHE/FRAME BREAK *****
EZPSYM1 SYMSORT

SYM.  PG.LN. IDENT.

C       1 23 CEZP1   C       1  2 CEZP1   C...    1 11 CEZP1   
C...    1  6 CEZP1   
EASYPLOT ** FICHE/FRAME BREAK *****
EZPSYM2
CEZP2     EASYPLOT PART 2 OF 8
C         25 OCTOBER 1972    THAD FLORYAN

C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,XREGTMP,YREGTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       DIMENSION LARMA(93),LARTI(4),LARPL(4),LARDA(2),LARSC(7),
     1 LARDE(17),LARAX(11)
       EQUIVALENCE (LARMA(49),LARTI(1)),(LARMA(53),LARPL(1))
       EQUIVALENCE (LARMA(57),LARDA(1)),(LARMA(59),LARSC(1))
       EQUIVALENCE (LARMA(66),LARDE(1)),(LARMA(83),LARAX(1))
       DIMENSION YBCDLA(12),XBCDLA(12),LT(10),
     1 KXLEAD(10),KYLEAD(10),KXTRAIL(10),KYTRAIL(10),LENT(30),LSMB(21),
     2 IXGA(25),IYGA(25)

C  NEXT 2 LINES FOR PSCALE,CENTER,LOWER AND FIT'S COMMONS
      DIMENSION FILLER(8)
      COMMON FILLER

      DATA IGOZ,IOLDXZ,IOLDYZ,IOZ,INTGZ,IERRZ/0,0,0,0,-1,1/
      DATA SIZEINC,ROTANG,ROTSIN,ROTCOS/10.,0.,0.,1./
      DATA JMESS,KFRDP,JYSCCHK,JXSCCHK,KP,KF,NCHKX/1,-1,0,0,0,0,1/
      DATA JUMP1/200S/
      DATA (LARMA(I),I= 1, 6)/ 3HQ! , 3HY A, 3HX A, 3HTIT, 3HPLO, 3HPAG/
      DATA (LARMA(I),I= 7,12)/ 3HDAT, 3HX S, 3HY S, 3HCLE, 3HSUP, 3HRES/
      DATA (LARMA(I),I=13,18)/ 3HEXE, 3HQUI, 3HEND, 3HDRA, 3HDEL, 3HTYP/
      DATA (LARMA(I),I=19,24)/ 3HPAU, 3HCON, 3HDSL, 3HSCA, 3HMOV, 3HPOS/
      DATA (LARMA(I),I=25,30)/ 3HOVE, 3HOPE, 3HRUN, 3HEXP, 3HPEN, 3HACC/
      DATA (LARMA(I),I=31,36)/ 3HQU!, 3HSUM, 3HROT, 3HX G, 3HY G, 3HREG/
      DATA (LARMA(I),I=37,42)/ 3HCAP, 3HINS, 3HVER, 3HCHA, 3HCRE, 3HHEL/
      DATA (LARMA(I),I=43,48)/ 3H?! , 3HDO , 3HDO!, 3HCOM, 3HPRO, 3HEDI/
      DATA (LARMA(I),I=49,54)/ 3HSIZ, 3HANG, 3HTEX, 3HLOC, 3HLIN, 3HSYM/
      DATA (LARMA(I),I=55,60)/ 3HSKI, 3HSIZ, 3HSTO, 3HNEX, 3HSTA, 3HINC/
      DATA (LARMA(I),I=61,66)/ 3HLEN, 3HREV, 3HLOG, 3HLIN, 3HINT, 3HY A/
      DATA (LARMA(I),I=67,72)/ 3HX A, 3HPLO, 3HPAG, 3HDAT, 3HX S, 3HY S/
      DATA (LARMA(I),I=73,78)/ 3HDRA, 3HDSL, 3HSCA, 3HOVE, 3HMES, 3HTIT/
      DATA (LARMA(I),I=79,84)/ 3HPEN, 3HX G, 3HY G, 3HREG, 3HLEN, 3HLAB/
      DATA (LARMA(I),I=85,90)/ 3HFOR, 3HMOV, 3HSPA, 3HFAC, 3HNSI, 3HLSI/
      DATA (LARMA(I),I=91,93)/ 3HNLO, 3HLLO, 3HTLE/



C  SPEED RETURNS A 4 FOR A 10 CPS TTY OUTPUT BAUD RATE
C                  3 FOR A 30 CPS TTY OUTPUT BAUD RATE
C                 -1 FOR ANYTHING ELSE
       CALL SPEED(LIMZ)
       IF (LIMZ .GT. 0) GO TO 1
C      'OUTPUT BAUD RATE NOT 10 OR 30 CPS'
       CALL MESPRT(51)
       GO TO 3
C      'EASYPLOT CANNOT OPEN SCRATCH FILE'
2      CALL MESPRT(52)
3      CALL CLZCOM(MODEZ,NDEVZ)
       QUIT

1      OPEN RANDIO,5,EASYPLOT'SCR':BINARY,ERROR GO TO 2
       CONNECT END FILE, GO TO 71
       CALL SETINT(79S,12000S)
C...  CHKCOM RETURNS (0 TEL, -1 FILE) FOR COMMAND FILE
       CALL CHKCOM(MODEZ,NDEVZ)


       IGNORE OVERFLOW

C... THE FOLLOWING WILL CAUSE INITIALIZATION OF PARAMETERS
C... FIRST TIME THROUGH:
C      JDSR:   0=DELETE
C      JDELJU: 0=ALL

50     JDSR=JDELJU=0

C... BEGIN CLEAR,DELETE,SUPPRESS, AND RESTORE INITIALIZATION
C... SECTION:

C... Y AXIS:
7010   JYAX=IJDSR(JYAX)
       IF (JDSR .NE. 0) GO TO 7014
       YAXLEN=8.
       NYCHLA=NYLEAD=NYTRAIL=0
       YTLEN=.05
       JYSCI=NYDEC=1
       YTSPA=YFACTOR=1.
       YNSPA=2.0
       YSEPLA=.6
       YSIZELA=.2
       YSEPNO=.25
       YSIZENO=.1
       NYPOINT=NYFR=3
       NYWH=2
       YMOVE=0.
7014   IF (JDELJU .LT. 0) GO TO 80

C... X AXIS:
7020   JXAX=IJDSR(JXAX)
       IF (JDSR .NE. 0) GO TO 7024
       XAXLEN=8.
       NXCHLA=NXLEAD=NXTRAIL=0
       XTLEN=.05
       XTSPA=XFACTOR=1.
       XNSPA=2.0
       XSEPLA=.6
       XSIZELA=.2
       XSEPNO=.25
       XSIZENO=.1
       JXSCI=NXDEC=1
       NXPOINT=NXFR=3
       NXWH=2
       XMOVE=0.
7024   IF (JDELJU .LT. 0) GO TO 80


C... PLOT:
7030   JPL=IJDSR(JPL)
       IF (JDSR .NE. 0) GO TO 7034
       JLI=JSY=0
       NLSMBT=NLSMB=LSKIP=1
       SYHT=.08
7034   IF (JDELJU .LT. 0) GO TO 80


C... PAGE:
7040   JMO=IJDSR(JMO)
       IF (JDSR .NE. 0) GO TO 7044
       XPA=10.
       YPA=0.
7044   IF (JDELJU .LT. 0) GO TO 80


C... DATA:
7050   JDA=IJDSR(JDA)
       IF (JDSR .NE. 0) GO TO 7054
       STOP=9999.
7054   IF (JDELJU .LT. 0) GO TO 80


C... X SCALE:
7060   JSCX=IJDSR(JSCX)
       IF (JDSR .NE. 0) GO TO 7064
       XSTART=XINC=0.
       XINT=1.
       JSXSET=JDXSET=JREVX=JXLGLN=0
7064   IF (JDELJU .LT. 0) GO TO 80


C... Y SCALE:
7070   JSCY=IJDSR(JSCY)
       IF (JDSR .NE. 0) GO TO 7074
       YSTART=YINC=0.
       YINT=1.0
       JSYSET=JDYSET=JREVY=JYLGLN=0
7074   IF (JDELJU .LT. 0) GO TO 80


C... DRAW:
7080   JDRA=IJDSR(JDRA)
       IF (JDELJU .LT. 0) GO TO 80


C... DSL:
7090   JDL=IJDSR(JDL)
       IF (JDSR .NE. 0) GO TO 7096
       NDSL=0
       DSLX=DSLY=0.
7096   IF (JDELJU .LT. 0) GO TO 80


C... SCAN TO:
7100   JSCAN=IJDSR(JSCAN)
       IF (JDSR .NE. 0) GO TO 7104
       JSCJU=NSCAX=0
       NSCAN=1
7104   IF (JDELJU .LT. 0) GO TO 80


C... OVERLAY:
7110   JOVR=IJDSR(JOVR)
       IF (JDSR .EQ. 0) NOVRST = 0
7114   IF (JDELJU .LT. 0) GO TO 80


C... X GRID:
7116   JXGRID=IJDSR(JXGRID)
       IF (JDELJU .LT. 0) GO TO 80


C... Y GRID:
7118   JYGRID=IJDSR(JYGRID)
       IF (JDELJU .LT. 0) GO TO 80


C... REGION:
7119   JREGSET=IJDSR(JREGSET)
       XREGION=YREGION=8.
       IF (JDELJU .LT. 0) GO TO 80

C...   TITLE

7140   N=J=1
       K=30
       GOTO 9160

C      ENTRY FROM DELETE,SUPPRESS,RESTORE DISPATCHER
C          IF NO NUMBER, APPLY TO ALL TITLES
C          ELSE, APPLY TO 'TITLE N'

7200   CALL VALUE(KX,0,DUMMY,IERROR)
       IF (IERROR .GT. 0) GOTO 7140
       J = K = N = DUMMY+1E-6
       IF ((N.LE.0) .OR. (N.GT.30)) CALL MESSAGE(32)
C      'TITLE NOT ASSIGNED'
       IF (LENT(N) .EQ. 0) CALL MESSAGE(11)
9160   POSITION (5,3001+(N-1)*32)
       TX = TY = TANG = DUM = 0.
       THT = .2
       DO 1970 I=J,K
       IF (JDSR .NE. 0) GOTO 1970
       WRITE (5) TX,TY,THT,TANG,(DUM,NFIPOS=1,12)
1970   LENT(I) = IJDSR(LENT(I))
       IF (JDELJU .LT. 0) GOTO 80


C...   PEN LOCATION
7130   XPENLOC = YPENLOC = 0.
       IF (JDSR .LE. 0) GOTO 80
C      'CANNOT RESTORE'
       CALL MESSAGE(38)


C...   MESSAGES:  SUPPRESS,DELETE,RESTORE EXPLANATION
7120   IF (JDSR .LE. 0) (JMESS=0; GOTO 80)
       JMESS = 1
       GOTO 80

C*****************  C O M M A N D   D I S P A T C H E R
C
C
C      TERMINATING EXECUTION ALTMODE COMES HERE:

12000  IF (JONOFF .NE. 0) CALL EPLOT
       KF = JONOFF = IOLDXZ = IOLDYZ = 0
C      'ABORTED'
       CALL MESPRT(53)
       CLOSE(3)

C      SFE ALTMODES COME HERE:

79     CALL CLZCOM(MODEZ,NDEVZ)
       CLOSE(2)
       KP = 0
       KFRDP = -1

C***** READ LINE FROM USER:

80     CALL ALTBRU(0)
       CALL RDP
       JFROM=1

C... INTERPRET MAJOR COMMAND:
100    GO TO (180,1400,210,310,410,610,810,910,1005,1055,50,1701,
     1 1702,1200,1400,1400,1600,1700,2000,2030,2040,2100,2120,2130,
     2 2200,2300,1500,1550,2500,2700,2750,1400,2800,2850,
     3 2900,2950,2970,6910,6920,6930,6940,6950,6960,6960,
     4 7710,7710,2041,2042,1450) LANG(LARMA,48)

C... Q  ,Y A,X A,TIT,PLO,PAG,DAT,X S,Y S,CLE,SUP,
C... RES,EXE,QUI,END,DRA,DEL,TYP,PAU,CON,DSL,SCA,MOV,
C... POS,OVE,OPE,RUN,EXP,PEN,ACC,QU ,SUM,ROT
C... X G,Y G,REG,CAP,INS,VER,CHA,CRE,HEL,QMARK
C... DO ,DO ,COM,PRO,EDI

180    CALL MESSAGE(9)

C... THIS COMPUTED GO TO RETURNS CONTROL BACK TO SECTION LAST
C... ENCOUNTERED. NEEDED IN CASE USER TYPES INCORRECT COMMANDS.

200    GO TO (80,210,310,420,615,820,910,1010,1060,2510)JFROM
C            SFE,Y A,X A,TIT,PLO,PAG,DAT,X SC,Y SC,EXPL

C... Y AXIS COMMAND DEFINITION
210    JYAX=1
       JFROM=2
       CALL AXINT(LARAX,YMOVE,YAXLEN,YTLEN,
     1 YTSPA,YNSPA,YSEPLA,YSIZELA,YBCDLA,NYCHLA,YSEPNO,YSIZENO,
     2 YFACTOR,JYSCI,NYPOINT,KYLEAD,NYLEAD,
     3 NYWH,NYDEC,NYFR,KYTRAIL,NYTRAIL)
       GO TO 100





C... X AXIS COMMAND DEFINITION
310    JXAX=1
       JFROM=3
       CALL AXINT(LARAX,XMOVE,XAXLEN,XTLEN,
     1 XTSPA,XNSPA,XSEPLA,XSIZELA,XBCDLA,NXCHLA,XSEPNO,XSIZENO,
     2 XFACTOR,JXSCI,NXPOINT,KXLEAD,NXLEAD,
     3 NXWH,NXDEC,NXFR,KXTRAIL,NXTRAIL)
       GO TO 100

C... "TITLE" COMMAND DEFINITION SECTION:
410    CALL VALUE(KX,0,XNT,IERROR)
       IF (IERROR .GT. 0) CALL MESSAGE(30)
       NT=XNT+1E-6
       IF ((NT .LE. 0) .OR. (NT .GT. 30)) CALL MESSAGE(30)
       NFIPOS=3001+(NT-1)*32
       POSITION (5,NFIPOS)
       READ (5) TX,TY,THT,TANG,(BCD(I),I=1,12)
420    CALL RDP
       JFROM=4
C... INTERPRET TITLE SUBCOMMAND:
       GO TO (502,510,520,550,560) LANG(LARTI,4)
C             BAD,SIZ,ANG,TEX,LOC
502    POSITION (5,NFIPOS)
       WRITE (5) TX,TY,THT,TANG,(BCD(I),I=1,12)
       GO TO 100
510    CALL VALUE1(THT)
       GO TO 420
520    CALL VALUE1(TANG)
       GO TO 420
550    CALL STRING
       CALL FLPACK
       LENT(NT)=NCHSCR
       GO TO 420
560    NPT=1
       CALL PAIR(NPT,TX,TY,IERROR)
       IF (IERROR .NE. 0) CALL MESSAGE(34)
       GO TO 420

C... "PLOT" COMMAND DEFINITION SECTION:
610    JFROM=5
C      'PLOT' COMMAND INVOKES X AND Y SCALING
       JPL = JSCX = JSCY = 1
615    CALL RDP
C... INTERPRET PLOT SUBCOMMAND:
       GO TO (100,650,660,670,680) LANG(LARPL,4)
C             BAD,LIN,SYM,SKI,SIZ
650    JLI=1
       GO TO 615
660    JSY=NPT=1
       DO 666 N=1,21
       CALL VALUE(KX,NPT,SYMB,IERROR)
       IF (IERROR .GT. 0) GO TO 664
666    LSMB(N)=SYMB+1E-6
       CALL MESSAGE(33)
664    NLSMBT=N-1
       GO TO 615
670    CALL VALUE1(SKIP)
       LSKIP=SKIP+1E-6
       GO TO 615
680    CALL VALUE1(SYHT)
       GO TO 615

C... PAGE COMMAND DEFINITION SECTION:
810    JMO=NPT=1
       CALL PAIR(NPT,XPA,YPA,IERROR)
       IF (IERROR .LE. 0) GO TO 80
820    CALL MESSAGE(37)




C      'DATA' COMMAND
C
C      CHECK IF A FILE NAME FOLLOWS 'DATA'  (IPTR2 > 0)
910    IF (IPTR2 .LE. 0) GOTO 915
       ASSIGN 911 TO JUMP
       GOTO 1501
C      IF FILE WAS OPENED, COMES HERE, SETS FREE-FORM DATA INPUT
911    JFREE = JFREES = KF = I
C      INDICATE THAT 'DATA' COMMAND WAS GIVEN
915    JDA=1
       CALL RDP
       JFROM=7
C... INTERPRET DATA SUBCOMMAND:
       GO TO (100,920,100) LANG(LARDA,2)
C             BAD,STO,NEX

920    CALL VALUE1(STOP)
       GO TO 80

C... "X SCALE COMMAND DEFINITION SECTION:
1005   JSCX=1
1010   CALL RDP
       JFROM=8
C... INTERPRET X SCALE SUBCOMMAND:
       GO TO (100,1030,1040,1045,1052,1053,1014,1042) LANG(LARSC,7)
C             BAD, STA, INC, LEN, REV, LOG, LIN, INT
1030   CALL VALUE1(XSTART)
       JSXSET=1
       GO TO 1010
1040   CALL VALUE1(XINC)
       JDXSET=1
       GO TO 1010
1042   CALL VALUE1(XINT)
       GO TO 1010
1045   CALL MESSAGE(48)
1052   JREVX=1
       GO TO 1010
1053   JXLGLN=1
       GO TO 1010
1014   JXLGLN=0
       GO TO 1010

C... "Y SCALE" COMMAND DEFINITION SECTION:
1055   JSCY=1
1060   CALL RDP
       JFROM=9
C... INTERPRET Y SCALE SUBCOMMAND:
       GO TO (100,1080,1090,1095,1097,1099,1064,1092) LANG(LARSC,7)
C             BAD, STA, INC, LEN, REV, LOG, LIN, INT
1080   CALL VALUE1(YSTART)
       JSYSET=1
       GO TO 1060
1090   CALL VALUE1(YINC)
       JDYSET=1
       GO TO 1060
1092   CALL VALUE1(YINT)
       GO TO 1060
1095   CALL MESSAGE(48)
1097   JREVY=1
       GO TO 1060
1099   JYLGLN=1
       GO TO 1060
1064   JYLGLN=0
       GO TO 1060

C      'QUIT' COMMAND
C      TURN PLOTTER OFF BEFORE LEAVING PROGRAM
1400   CALL POFF
       CLOSE
       CLOSE "EASYPLOT'SCR'"
       QUIT




C      'EDITOR' COMMAND
C      GO TO EDITOR
1450   CALL EDITOR
       GOTO 80




C      'DRAW' COMMAND
1600   JDRA = 1
       GOTO 80

C      FILE OPENING ROUTINES
C
C      'OPEN'  DATA FILE
C      N TRANSFER OF CONTROL AFTER OPEN
1500   ASSIGN 1520 TO JUMP
C      I WILL BE ALTERED BY OPEN
1501   I=3
       GO TO 1580
C      IF FILE WAS OPENED, CONTROL COMES HERE
1520   KF=I
       JFREE = JFREES = 0
       GO TO 80

C      'RUN'  PROGRAM FILE
1550   ASSIGN 1570 TO JUMP
       I=2
       GO TO 1580
1570   KP=1
       NDEVZ = 0
       GO TO 80

C      'DO'  COMMAND FILE
7710   ASSIGN 7711 TO JUMP
       I = -1
       MODEZ = 0
       CLOSE(-1)
       GO TO 1580
7711   CALL CHKCOM(MODEZ,NDEVZ)
       GO TO 80

C      FILE OPENING SUBPROGRAM
C      CHECK IF A NAME EXISTS, IF NOT THEN TYPE A MESSAGE
1580   IF (IPTR2 .LE. 0) CALL MESSAGE(16)
C      CALCULATE NUMBER OF CHARACTERS IN FILE NAME
       NCHSCR=NCHKX-IPTR2+1
C      TRANSFER FILE NAME TO KSCR
       (KSCR(J-IPTR2+1)=KX(J)),J=IPTR2,NCHKX
C      PACK INTO BCD  (3 CHARS PER WORD)
       CALL FLPACK
C      NOW OPEN THE FILE FOR INPUT
       CLOSE (I)
       OPEN INPUT,I:BCD,OVERRIDE,ERROR GO TO 1594
C      CHECK IF FILE IS SYMBOLIC, GO TO JUMP IF IT IS
       CALL CHKSYM(JUMP)
C      FILE IS NOT SYMBOLIC, GIVE USER AN ERROR MESSAGE
       CLOSE(I)
       I = -1
       CALL MESSAGE(14)
C      CANNOT OPEN/FIND FILE
1594   I = -1
       CALL MESSAGE(15)

C...   'DELETE' , 'SUPPRESS' , 'RESTORE'  COMMANDS
C
C          JDSR:     0=DELETE (RE-INIT TO DEFAULT VALUES)
C                   -1=SUPPRESS (SET TO NOT EXECUTE)
C                    1=RESTORE (SET TO EXECUTE)
C
C          JDELJU:   0=ALL
C                   -1=SELECTIVE
C
C      'DELETE' COMMAND
1700   JDSR=0
       GO TO 1704

C      'SUPPRESS' COMMAND
1701   JDSR=-1
       GO TO 1704

C      'RESTORE' COMMAND
1702   JDSR=1
1704   IF (IPTR2 .GT. 0) GOTO 1730
C      SET TO DO ALL (NOTHING FOLLOWED THE COMMAND)
1728   JDELJU=0
       GO TO 7010
C      SELECTIVE, LOOK AT REST OF THE COMMAND
1730   JDELJU=-1
       KB=KX(IPTR2)+KX(IPTR2+1)/256+KX(IPTR2+2)/65536
C      INTERPRET REMAINDER OF THE COMMAND
       GO TO (7002,7010,7020,7030,7040,7050,7060,7070,
     1 7080,7090,7100,7110,7120,7200,7130,7116,7118,
     2 7119) LANG(LARDE,17)
C... Y A,X A,PLO,PAG,DAT,X S,Y S,
C... DRA,DSL,SCA,OVE,EXP,TIT,PEN,X G,Y G
C... REG
C... ERROR MESSAGE: "THIS COMMAND NOT RECG. BY DEL, SUP, OR RES.
7002   CALL MESSAGE(39)

C... "TYPE" SECTION:
2000   CALL STRING
C... TURN PLOTTER OFF BEFORE PRINTING:
       CALL POFF
       TYPE 2006,(KSCR(I),I=1,NCHSCR)
2006   FORMAT(72A1)
       GO TO 80




C... "PAUSE" SECTION:
2030   IF (KFRDP .GE. 0) CALL MESSAGE(9)
       IF (NDEVZ .EQ. 0) KFRDP=0 .ELSE. KFRDP=1
       IF (KP .EQ. 1) KFRDP=KFRDP+2
       KP=NDEVZ=0
       GO TO 80




C... "CONTINUE" SECTION:
2040   IF (KFRDP .LT. 0) CALL MESSAGE(9)
       IF (KFRDP .LT. 2) KP=0 .ELSE. KP=1
       IF ((KFRDP.EQ.1).OR.(KFRDP.EQ.3)) NDEVZ=-1 .ELSE. NDEVZ=0
       KFRDP = -1
       GO TO 80

C      'COMMANDS' COMMAND
C      FORCES INPUT FROM COMMAND FILE
2041   NDEVZ = -1
2043   IF (KFRDP .LT. 0) GO TO 80
       IF (KFRDP .LT. 2) KP=0 .ELSE. KP=1
       KFRDP = -1
       GO TO 80



C      'PROGRAM' COMMAND
C      FORCES INPUT FROM PROGRAM ('RUN') FILE
2042   NDEVZ = 0
       GOTO 2043



C***************  END OF PROGRAM OR DATA FILE HANDLER
C      KEOF:  -1=COMMAND INPUT
C              0=DATA FILE
C              1=PROGRAM FILE

71     IF (KEOF) 72,74,73
72     CALL CLZCOM(MODEZ,NDEVZ)
       GO TO 80
73     KP=0
       CLOSE (2)
       NDEVZ = -1
C      'END OF INPUT PROGRAM'
       CALL MESSAGE(-17)
74     CLOSE (3)
       KF=0
C      IF NO DATA YET READ, READ FROM TERMINAL
       IF (I .LT. 3) GOTO 1211
C      DATA WAS READ, ASSUME 'STOP,0' FOR EOF
       WRITE (5) STOP,0.
       GOTO 9050

C... "DSL" DEFINITION SECTION:
2100   IF (NDSL .GE. 200) CALL MESSAGE(12)
C... ERROR MESSAGE: " MORE THAN 200 DSL'S"
       JDL=NPT=1
       NFIPOS=4201+NDSL*8
       CALL PAIR(NPT,X1,Y1,IERROR)
C... TYPE MESSAGE IF LESS THAN ONE PAIR:
       IF (IERROR .EQ. 0) GO TO 2104
2102   CALL MESSAGE(13)
2104   CALL PAIR(NPT,X2,Y2,IERROR)
C... TYPE MESSAGE IF MORE THAN ONE PAIR BUT LESS THAN TWO:
       IF (IERROR) 2102,2106,2108
C... TWO PAIRS GIVEN:
2106   POSITION (5,NFIPOS)
       WRITE (5) X1,Y1,X2,Y2
C... STORE FINAL PAIR:
       DSLX=X2
       DSLY=Y2
       GO TO 2109
C... ONLY ONE PAIR- USE OLD PAIR:
2108   POSITION (5,NFIPOS)
       WRITE (5) DSLX,DSLY,X1,Y1
C... STORE FINAL PAIR:
       DSLX=X1
       DSLY=Y1
2109   NDSL=NDSL+1
       GO TO 80

C... "SCAN TO" DEFINITION SECTION:
2120   JSCAN=1
       JSCJU=0
       CALL VALUE(KX,0,D1,IERROR)
       IF (IERROR .GT. 0) CALL MESSAGE(10)
       NSCAN=D1+1E-6
       NSCAX=0
       GO TO 80



C... "MOVE TO" SECTION:
2130   NPT=1
       CALL PAIR(NPT,X,Y,IERROR)
       IF (IERROR) 2138,2140,2132
2132   CALL MESSAGE(37)
2138   Y=0.
2140   IF (JSCAN .LE. 0) GO TO 2144
       IF (NSCAX .LT. NSCAN) GO TO 2146
2144   CALL PON
       CALL IPLOT(X,Y,-3)
       GO TO 80
2146   CALL PON
       CALL IPLOT(0.,Y,-3)
       GO TO 80

C... POSITION AT SECTION:
2200   CALL VALUE(KX,0,YPOS,IERROR)
       IF (IERROR .GT. 0) CALL MESSAGE(10)
       CALL PON
       CALL IPLOT(0.,-12.,-3)
       CALL IPLOT(0.,YPOS,-3)
       GO TO 80




C... OVERLAY SECTION
2300   CALL VALUE1(OVR)
       JOVR=OVR+1E-6
       GO TO 80




C... "EXPLAIN" SECTION:
2500   JMESS=JMESS+1
C... MUST SET JFROM SO THAT WE CAN RESET JMESS AFTER THE MESSAGE
C... IS TYPED - THE MESSAGE SUBR. RETURN DIRECTLY TO 200 AND
C... WITH JFROM=10, EXECUTION IS RETURNED TO 2510.
       JFROM=10
       CALL MESSAGE(MESSNO)
2510   JMESS=JMESS-1
       GO TO 80

C... PEN LOC SECTION:
2700   NPT=1
       CALL PAIR(NPT,X,Y,IERROR)
       IF (IERROR .GT. 0) CALL MESSAGE(37)
C      CALL IPLOT(X-XPENLOC,Y-YPENLOC,-3)
       XPENLOC=X
       YPENLOC=Y
       GO TO 80



C... ACCURACY SECTION
2750   CALL VALUE1(SIZEINC)
       I=SIZEINC*100.+1E-6
       SIZEINC=I/100
       IF (SIZEINC .LE. 0.) CALL MESSAGE(40) .ELSE. GOTO 80
C... ERROR MESSAGE: "ACCURACY SPECIFICATION NOT > 0"



C... SUMMARY SECTION:
2800   TYPE 2810,XMAX,XMIN,XSTATMP,XINCTMP,YMAX,YMIN,YSTATMP,YINCTMP
2810   FORMAT(//$X COORDINATE:$//$DATA MAX: $E12.6/$DATA MIN: $E12.6/
     1 $START:    $E12.6/$INCREMENT:$E12.6/
     2 /$Y COORDINATE:$//$DATA MAX: $E12.6/$DATA MIN: $E12.6/
     3 $START:    $E12.6/$INCREMENT:$E12.6//)
       GO TO 80

C... ROTATE SECTION:
2850   CALL VALUE1(ROTANG)
       I=ROTANG+1E-6
       IF (I) 2870,2860,2862
2860   ROTSIN=0.
       ROTCOS=1.
       GO TO 80
2862   IF (I .EQ. 270) (ROTSIN=-1.; ROTCOS=0.; GOTO 80)
C... ERROR MESSAGE: "ONLY 0 AND 270 DEGREES ALLOWED WITH ROTATE"
2870   CALL MESSAGE(41)



C... X GRID SECTION:
2900   CALL GRINT(JXGRID,XGREP,NXGA,IXGA)
       GO TO 80




C... Y GRID SECTION:
2950   CALL GRINT(JYGRID,YGREP,NYGA,IYGA)
       GO TO 80



C... REGION DEFINITION SECTION:
2970   N=1
       CALL PAIR(N,XREGION,YREGION,IERROR)
C      'THIS COMMAND REQUIRES TWO VALUES'
       IF (IERROR .GT. 0) CALL MESSAGE(49)
C... EVERYTHING OK:
2975   JREGSET=1
       GO TO 80

C...   VERSION
6930   CALL MESPRT(50)
       GOTO 80

C...   CHARGES 'NO PREMIUM CHARGE'
6940   CALL MESPRT(54)
       GOTO 80

C...   CREDITS 'DEVELOPED BY TYMSHARE'
6950   CALL MESPRT(55)
       GOTO 80

C...   HELP
6960   CALL MESSAGE(42)
       GOTO 80

C...   INSTRUCTIONS 'CONSULT THE TYMSHARE EASYPLOT REFERENCE MANUAL'
6920   CALL MESPRT(56)
       GOTO 80

C...   CAPABILITIES
6910   TYPE 6911
       GOTO 80
6911   FORMAT($EASYPLOT IS A GENERAL PURPOSE PLOTTING LANGUAGE
     1 THAT OPERATES$/
     1$THE ZETA PLOTTER AT 10 OR 30 CPS.  WITH EASYPLOT, YOU CAN$/
     1$QUICKLY AND EASILY MAKE REPORT QUALITY PLOTS WITH GRIDS,$/
     1$AXES,CURVES,TITLES,ETC.  THE SCALING CAPABILITY OF EASYPLOT$/
     1$ALLOWS LINEAR,SEMI-LOG OR LOG-LOG SCALES.  EASYPLOT CAN BE$/
     1$LEARNED IN ABOUT 2 HOURS BY READING THE EASYPLOT REFERENCE$/
     1$MANUAL AVAILABLE FROM TYMSHARE.  SEE YOUR REPRESENTATIVE FOR$/
     1$MORE INFORMATION.$/)

C****************** E X E C U T I O N    S E C T I O N
C
1200   CALL ALTBRU(-1)
       NOVRST=0
       NSCAX=NSCAX+1
       IF (JSCAN .LE. 0) GO TO 1205
       IF (NSCAX .GE. NSCAN) GO TO 1205
       TYPE 1203, NSCAX
1203   FORMAT(/$EXECUTE #$,I)
       JSCJU=1
       GO TO 1208
1205   JSCJU=0
1208   CONTINUE
4000   IF (JOVR .LE. 0) GO TO 4040
4010   IF (NOVRST .GT. 0) GO TO 4040
       JDL=IABS(JDL)
       JXAX=IABS(JXAX)
       JYAX=IABS(JYAX)
       JSCX=IABS(JSCX)
       JSCY=IABS(JSCY)
       JXGRID=IABS(JXGRID)
       JYGRID=IABS(JYGRID)
       (LENT(I)=IABS(LENT(I))),I=1,30
4040   NOVRST=NOVRST+1
C      IF 'DATA' NOT SPECIFIED, DON'T TRY TO READ A FILE
       IF (JDA .LE. 0) GO TO 1220
       IF (KF) 1207,1211,1219
C      'DATA FILE NOT OPEN'
1207   CALL MESSAGE(-31)
C      READ FROM TERMINAL IN FREE-FORM
1211   KFN=0
       JFREES = JFREE
       JFREE=1
       CALL POFF
       TYPE 1212
1212   FORMAT(/$ENTER DATA$)
       GO TO 1213
C      READ FROM DATA FILE
1219   KFN=3
       KEOF=0
1213   POSITION (5,6001)
       XMAX = YMAX = -1E70
       XMIN = YMIN = 1E70
       DO 4370 I=1,10000
C      JFREE:  0=OLD,FIXED-FORMAT   >0 = FREE-FORM, SET BY 'DATA FILENAME'
       IF (JFREE .EQ. 0) READ KFN,1214,X,Y .ELSE. READ KFN,1215,X,Y
1214   FORMAT(2E12.5)
1215   FORMAT(G,G)
       IF (X .EQ. STOP) GOTO 1218
1217   IF (X .GT. XMAX) XMAX = X
       IF (X .LT. XMIN) XMIN = X
       IF (Y .GT. YMAX) YMAX = Y
       IF (Y .LT. YMIN) YMIN = Y
       WRITE (5) X,Y
4370   CONTINUE
1218   I1=Y+1E-6
C      'NUMBER MUST BE STOP,[0,1,2]'
       IF ((I1 .LT. 0) .OR. (I1 .GT. 3)) CALL MESSAGE(-45)
       GOTO (9050,1216,9030,9022) I1+1
C            STOP,NEXT,TITL,----
9022   WRITE (5) STOP,Y
       GO TO 4370
1216   JNEX=1
       GO TO 9050
C      READ A TITLE SPECIFICATION [X,Y,SIZE,ANGLE,CHAR LENGTH,TEXT]
9030   READ KFN,9031,TX,TY,THT,TANG,L,(BCD(I),I=1,6)
9031   FORMAT(5G,6A6)
       CALL PON
       I=I-1
       CALL ITEXT(TX,TY,THT,BCD,TANG,L)
       IF (KFN .EQ. 0) CALL POFF
       GO TO 4370
C      ALL DONE WITH DATA ON THIS GO-AROUND
9050   NUM=I-1
       JFREE = JFREES
1220   CONTINUE

C... DETERMINE TEMPORARY PLOTTING REGION:
       IF (JREGSET .GT. 0) (XREGTMP=XREGION; YREGTMP=YREGION; GOTO 7530)
       XREGTMP = XAXLEN
       YREGTMP = YAXLEN
7530   CONTINUE



C... BEGIN Y SCALE EXECUTION SECTION:
       IF (JSCY .LE. 0) GO TO 1940
       JYSCCHK=1
       YSTATMP=YSTART
       YINCTMP=YINC
       SLEN=ABS(YREGTMP)
       CALL PSCALE(SLEN,YSTATMP,YINCTMP,YINT,JSYSET,JDYSET,
     1 JREVY,JYLGLN,YMAX,YMIN)




C... BEGIN X SCALE EXECUTION SECTION:
1940   IF (JSCX .LE. 0) GO TO 1240
       JXSCCHK=1
       XSTATMP=XSTART
       XINCTMP=XINC
       SLEN=ABS(XREGTMP)
       CALL PSCALE(SLEN,XSTATMP,XINCTMP,XINT,JSXSET,JDXSET,
     1  JREVX,JXLGLN,XMAX,XMIN)
1240   CONTINUE

C... PAGE Y COMPONENT IF SCAN IS ON AND JUMP OVER MAJOR 
C... EXECUTION SECTION:
       IF (JSCJU .LE. 0) GO TO 1955
       IF (JMO .LE. 0) GO TO 1351
       CALL PON
       CALL IPLOT(0.0,YPA,-3)
       GO TO 1351
1955   CONTINUE



C... BEGIN DRAW EXECUTION SECTION:
       IF (JDRA .LE. 0) GO TO 1965
       IF (NUM .LT. 2) GO TO 1965
       CALL PON
C... ZETA: SETS FAST MODE
       CALL CLINE
       POSITION (5,6001)
       READ (5) X,Y
       CALL IPLOT(X,Y,3)
       DO 1962 I=2,NUM
       READ (5) X,Y
       CALL IPLOT(X,Y,2)
1962   CONTINUE
1965   CONTINUE

C... BEGIN DSL EXECUTION SECTION:
       IF (JDL .LE. 0) GO TO 1244
       CALL PON
C... ZETA: SETS LINE MODE
       CALL SLINE
       POSITION (5,4201)
C THE FOLLOWING COMMENTED OUT LINES OF CODE KEEPS THE PEN DOWN
C FOR CONNECTED DSL'S, BUT THE LINES MAY OCCASIONALLY BE JERKY
C DUE TO NON-REINITIALIZATION...WORKS LIKE DRAW
C      READ(5)X,Y
C      READ(5)X2,Y2
C      CALL IPLOT(X,Y,3)
C      CALL IPLOT(X2,Y2,2)
C      DO 1242 I=2,NDSL
C      READ(5)X,Y
C      IF((X.EQ.X2).AND.(Y.EQ.Y2)) GOTO 1241
C      CALL IPLOT(X,Y,3)
C1241  READ(5)X2,Y2
C      CALL IPLOT(X2,Y2,2)
C1242  CONTINUE
       DO 1242 I=1,NDSL
       READ (5) X,Y
       CALL IPLOT(X,Y,3)
       READ (5) X,Y
       CALL IPLOT(X,Y,2)
1242   CONTINUE
1244   CONTINUE

C... X GRID EXECUTION SECTION:
       IF (JXGRID .LE. 0) GO TO 7420
       CALL PON
C... ZETA: SETS LINE MODE
       CALL SLINE
       CALL GRID(0,IXGA,NXGA,XGREP,XREGTMP,YREGTMP)
7420   CONTINUE




C... Y GRID EXECUTION SECTION:
       IF (JYGRID .LE. 0) GO TO 7470
       CALL PON
C... ZETA: SETS LINE MODE
       CALL SLINE
       CALL GRID(1,IYGA,NYGA,YGREP,YREGTMP,XREGTMP)
7470   CONTINUE

C... BEGIN Y AXIS EXECUTION SECTION:
       IF (JYAX .LE. 0) GO TO 1255
       IF (YSIZENO-1E-6 .LE. 0.) GO TO 1259
       IF (JYSCCHK .LE. 0) CALL MESSAGE(-20)
1259   CALL PON
C... ZETA: SETS LINE MODE
       CALL SLINE
       CALL AXIS(1,YMOVE,YAXLEN,YTLEN,YTSPA,YNSPA,YSEPLA,YSIZELA,
     1 YBCDLA,NYCHLA,YSEPNO,YSIZENO,JYLGLN,YSTATMP,YINCTMP,
     2 JYSCI,YFACTOR,NYPOINT,KYLEAD,NYLEAD,NYWH,NYDEC,NYFR,
     3 KYTRAIL,NYTRAIL)




C... BEGIN X AXIS EXECUTION SECTION:
1255   IF (JXAX .LE. 0) GO TO 1265
       IF (XSIZENO-1E-6 .LE. 0.) GO TO 1269
       IF (JXSCCHK .LE. 0) CALL MESSAGE(-20)
1269   CALL PON
C... ZETA: SETS LINE MODE:
       CALL SLINE
       CALL AXIS(0,XMOVE,XAXLEN,XTLEN,XTSPA,XNSPA,XSEPLA,XSIZELA,
     1 XBCDLA,NXCHLA,XSEPNO,XSIZENO,JXLGLN,XSTATMP,XINCTMP,
     2 JXSCI,XFACTOR,NXPOINT,KXLEAD,NXLEAD,NXWH,NXDEC,NXFR,
     3 KXTRAIL,NXTRAIL)
1265   CONTINUE

C... BEGIN PLOT EXECUTION SECTION:
       IF (JPL .LE. 0) GO TO 1281
       IF (JLI+JSY .LE. 0) CALL MESSAGE(-35)
       IF (JYSCCHK+JXSCCHK .LT. 2) CALL MESSAGE(-21)
       IF (NUM .LE. 0) CALL MESSAGE(-22)
       IF (JLI .LE. 0) GO TO 1279
       POSITION (5,6001)
       CALL PON
C... ZETA: SETS FAST MODE
       CALL CLINE
       XCOM1=STOP
       CALL LINES
1279   IF (JSY .LE. 0) GO TO 1281
       POSITION (5,6001)
       CALL PON
       ICOM2=LSMB(NLSMB)
       CALL CSYM
       NLSMB=NLSMB+1
       IF (NLSMB .LE. NLSMBT) GO TO 1281
       NLSMB=1
1281   CONTINUE

C... BEGIN TITLE EXECUTION SECTION:
       POSITION (5,3001)
       DO 1320 NZ=1,30
       READ (5) TX,TY,THT,TANG,(BCD(I),I=1,12)
       IF (LENT(NZ) .LE. 0) GO TO 1320
       CALL PON
       CALL ITEXT(TX,TY,THT,BCD,TANG,LENT(NZ))
1320   CONTINUE





C... BEGIN PAGE EXECUTION
1325   IF (JMO .LE. 0) GO TO 1350
       CALL PON
       CALL IPLOT(XPA,YPA,-3)
1350   CONTINUE

C... IF JNEX=1, SET JNEX TO 0 AND REPEAT EXECUTION:
1351   IF (JOVR .LE. 0) GO TO 4101
       IF (NOVRST .GT. 1) GO TO 4090
       JDL=-IABS(JDL)
       JXAX=-IABS(JXAX)
       JYAX=-IABS(JYAX)
       JSCX=-IABS(JSCX)
       JSCY=-IABS(JSCY)
       JXGRID=-IABS(JXGRID)
       JYGRID=-IABS(JYGRID)
       (LENT(I)=-IABS(LENT(I))),I=1,30
4090   IF (NOVRST .LT. JOVR) GO TO 4000
       NOVRST=0
C... TEST JNEXT SECTION:
4101   IF (JNEX .EQ. 0) GOTO 80
       JNEX=0
C... IF DATA IS FROM TEL, TURN PLOTTER OFF:
       IF (KF .EQ. 0) CALL POFF
C... BRANCH TO BEGINNING OF EXECUTION SECTION:
       GO TO 1200


       END
EASYPLOT ** FICHE/FRAME BREAK *****
EZPSYM2 SYMSORT

SYM.  PG.LN. IDENT.

1       2 27 CEZP2   100     7 30 CEZP2   1005   10 31 CEZP2   1010   10 32 CEZP2   
1014   11 11 CEZP2   1030   10 37 CEZP2   1040   11  1 CEZP2   1042   11  4 CEZP2   
1045   11  6 CEZP2   1052   11  7 CEZP2   1053   11  9 CEZP2   1055   11 14 CEZP2   
1060   11 15 CEZP2   1064   11 33 CEZP2   1080   11 20 CEZP2   1090   11 23 CEZP2   
1092   11 26 CEZP2   1095   11 28 CEZP2   1097   11 29 CEZP2   1099   11 31 CEZP2   
12000   7 10 CEZP2   1203   20 31 CEZP2   1205   20 34 CEZP2   1207   21 12 CEZP2   
1208   20 35 CEZP2   1211   21 14 CEZP2   1212   21 19 CEZP2   1213   21 24 CEZP2   
1214   21 30 CEZP2   1215   21 31 CEZP2   1216   22  7 CEZP2   1217   21 33 CEZP2   
1218   21 39 CEZP2   1219   21 22 CEZP2   1220   22 20 CEZP2   1240   23 10 CEZP2   
1242   24 22 CEZP2   1244   24 23 CEZP2   1255   25 19 CEZP2   1259   25  7 CEZP2   
1265   25 29 CEZP2   1269   25 22 CEZP2   1279   26  3 CEZP2   1281   26 11 CEZP2   
1320   26 19 CEZP2   1325   26 26 CEZP2   1350   26 29 CEZP2   1351   26 31 CEZP2   
1400   11 37 CEZP2   1450   12  8 CEZP2   1500   12 20 CEZP2   1501   12 22 CEZP2   
1520   12 25 CEZP2   1550   12 30 CEZP2   1570   12 33 CEZP2   1580   13  9 CEZP2   
1594   13 26 CEZP2   1600   12 15 CEZP2   1700   13 35 CEZP2   1701   13 39 CEZP2   
1702   14  4 CEZP2   1704   14  5 CEZP2   1728   14  7 CEZP2   1730   14 10 CEZP2   
180     8  3 CEZP2   1940   23  3 CEZP2   1955   23 18 CEZP2   1962   23 34 CEZP2   
1965   23 35 CEZP2   1970    6 31 CEZP2   2       2 23 CEZP2   200     8  8 CEZP2   
2000   14 22 CEZP2   2006   14 26 CEZP2   2030   14 33 CEZP2   2040   15  4 CEZP2   
2041   15 11 CEZP2   2042   15 21 CEZP2   2043   15 12 CEZP2   210     8 11 CEZP2   
2100   16  8 CEZP2   2102   16 15 CEZP2   2104   16 16 CEZP2   2106   16 20 CEZP2   
2108   16 27 CEZP2   2109   16 32 CEZP2   2120   16 35 CEZP2   2130   17  7 CEZP2   
2132   17 10 CEZP2   2138   17 11 CEZP2   2140   17 12 CEZP2   2144   17 14 CEZP2   
2146   17 17 CEZP2   2200   17 21 CEZP2   2300   17 32 CEZP2   2500   18  1 CEZP2   
2510   18  7 CEZP2   2700   18 10 CEZP2   2750   18 21 CEZP2   2800   18 30 CEZP2   
2810   18 31 CEZP2   2850   18 37 CEZP2   2860   19  1 CEZP2   2862   19  4 CEZP2   
2870   19  6 CEZP2   2900   19 11 CEZP2   2950   19 18 CEZP2   2970   19 24 CEZP2   
2975   19 29 CEZP2   3       2 24 CEZP2   310     8 24 CEZP2   4000   20 36 CEZP2   
4010   20 37 CEZP2   4040   21  7 CEZP2   4090   27  2 CEZP2   410     8 32 CEZP2   
4101   27  5 CEZP2   420     8 39 CEZP2   4370   21 38 CEZP2   50      3  1 CEZP2   
502     9  5 CEZP2   510     9  8 CEZP2   520     9 10 CEZP2   550     9 12 CEZP2   
560     9 16 CEZP2   610     9 21 CEZP2   615     9 24 CEZP2   650     9 28 CEZP2   
660     9 30 CEZP2   664     9 36 CEZP2   666     9 34 CEZP2   670     9 38 CEZP2   
680    10  2 CEZP2   6910   20 13 CEZP2   6911   20 15 CEZP2   6920   20  9 CEZP2   
6930   19 32 CEZP2   6940   19 36 CEZP2   6950   20  1 CEZP2   6960   20  5 CEZP2   
7002   14 20 CEZP2   7010    3  7 CEZP2   7014    3 22 CEZP2   7020    3 25 CEZP2   
7024    4  1 CEZP2   7030    4  5 CEZP2   7034    4 10 CEZP2   7040    4 14 CEZP2   
7044    4 18 CEZP2   7050    4 22 CEZP2   7054    4 25 CEZP2   7060    4 29 CEZP2   
7064    4 34 CEZP2   7070    4 38 CEZP2   7074    5  4 CEZP2   7080    5  8 CEZP2   
7090    5 13 CEZP2   7096    5 17 CEZP2   71     15 31 CEZP2   7100    5 21 CEZP2   
7104    5 25 CEZP2   7110    5 29 CEZP2   7114    5 31 CEZP2   7116    5 35 CEZP2   
7118    6  1 CEZP2   7119    6  6 CEZP2   7120    7  4 CEZP2   7130    6 36 CEZP2   
7140    6 11 CEZP2   72     15 32 CEZP2   7200    6 19 CEZP2   73     15 34 CEZP2   
74     15 39 CEZP2   7420   24 30 CEZP2   7470   25  2 CEZP2   7530   22 25 CEZP2   
7710   12 38 CEZP2   7711   13  4 CEZP2   79      7 18 CEZP2   80      7 25 CEZP2   
810    10  5 CEZP2   820    10  8 CEZP2   9022   22  5 CEZP2   9030   22 10 CEZP2   
9031   22 11 CEZP2   9050   22 18 CEZP2   910    10 15 CEZP2   911    10 19 CEZP2   
915    10 21 CEZP2   9160    6 25 CEZP2   920    10 28 CEZP2   
C      24 15 CEZP2   C      24 13 CEZP2   C      24 12 CEZP2   C      24 11 CEZP2   
C      24 10 CEZP2   C      24  9 CEZP2   C      24  8 CEZP2   C      24  7 CEZP2   
C      24  6 CEZP2   C      24  5 CEZP2   C      24  4 CEZP2   C      24  3 CEZP2   
C      22 17 CEZP2   C      22  9 CEZP2   C      22  4 CEZP2   C      22  1 CEZP2   
C      21 28 CEZP2   C      21 21 CEZP2   C      21 13 CEZP2   C      21 11 CEZP2   
C      21  8 CEZP2   C      19 26 CEZP2   C      18 13 CEZP2   C      16  4 CEZP2   
C      16  2 CEZP2   C      15 37 CEZP2   C      15 29 CEZP2   C      15 28 CEZP2   
C      15 27 CEZP2   C      15 20 CEZP2   C      15 19 CEZP2   C      15 10 CEZP2   
C      14 12 CEZP2   C      14  9 CEZP2   C      14  6 CEZP2   C      14  3 CEZP2   
C      13 38 CEZP2   C      13 33 CEZP2   C      13 31 CEZP2   C      13 30 CEZP2   
C      13 25 CEZP2   C      13 21 CEZP2   C      13 19 CEZP2   C      13 16 CEZP2   
C      13 14 CEZP2   C      13 12 CEZP2   C      13 10 CEZP2   C      13  8 CEZP2   
C      13  7 CEZP2   C      12 37 CEZP2   C      12 29 CEZP2   C      12 24 CEZP2   
C      12 21 CEZP2   C      12 19 CEZP2   C      12 14 CEZP2   C      12  7 CEZP2   
C      12  6 CEZP2   C      11 36 CEZP2   C      11 19 CEZP2   C      10 36 CEZP2   
C      10 26 CEZP2   C      10 20 CEZP2   C      10 18 CEZP2   C      10 13 CEZP2   
C       9 27 CEZP2   C       9 22 CEZP2   C       9  4 CEZP2   C       8  9 CEZP2   
C       7 16 CEZP2   C       7 12 CEZP2   C       6 38 CEZP2   C       6 23 CEZP2   
C       6 17 CEZP2   C       6 16 CEZP2   C       6 15 CEZP2   C       2 38 CEZP2   
C       2 37 CEZP2   C       2 22 CEZP2   C       2 19 CEZP2   C       2 16 CEZP2   
C       2 15 CEZP2   C       2 14 CEZP2   C       1 26 CEZP2   C       1  2 CEZP2   
C*****  7 23 CEZP2   C...   27  9 CEZP2   C...   27  7 CEZP2   C...   27  4 CEZP2   
C...   26 25 CEZP2   C...   25 38 CEZP2   C...   25 23 CEZP2   C...   25 18 CEZP2   
C...   25  8 CEZP2   C...   24 38 CEZP2   C...   24 35 CEZP2   C...   24 27 CEZP2   
C...   23 39 CEZP2   C...   23 26 CEZP2   C...   23 22 CEZP2   C...   23 12 CEZP2   
C...   23  2 CEZP2   C...   22 29 CEZP2   C...   20 12 CEZP2   C...   20  8 CEZP2   
C...   20  4 CEZP2   C...   19 39 CEZP2   C...   19 35 CEZP2   C...   19 28 CEZP2   
C...   19 23 CEZP2   C...   19 17 CEZP2   C...   19 10 CEZP2   C...   19  5 CEZP2   
C...   18 29 CEZP2   C...   18 25 CEZP2   C...   18 20 CEZP2   C...   18  4 CEZP2   
C...   18  3 CEZP2   C...   18  2 CEZP2   C...   17 39 CEZP2   C...   17 31 CEZP2   
C...   17  6 CEZP2   C...   16 29 CEZP2   C...   16 26 CEZP2   C...   16 22 CEZP2   
C...   16 19 CEZP2   C...   16 17 CEZP2   C...   16 13 CEZP2   C...   16  9 CEZP2   
C...   15  3 CEZP2   C...   14 32 CEZP2   C...   14 23 CEZP2   C...   14 19 CEZP2   
C...   14 18 CEZP2   C...   14 17 CEZP2   C...   14 16 CEZP2   C...   11 17 CEZP2   
C...   10 34 CEZP2   C...   10 24 CEZP2   C...    9 25 CEZP2   C...    9  2 CEZP2   
C...    8 23 CEZP2   C...    8  6 CEZP2   C...    8  5 CEZP2   C...    8  1 CEZP2   
C...    7 39 CEZP2   C...    7 38 CEZP2   C...    7 37 CEZP2   C...    7 36 CEZP2   
C...    7 29 CEZP2   C...    7  3 CEZP2   C...    6 35 CEZP2   C...    6  5 CEZP2   
C...    5 39 CEZP2   C...    5 34 CEZP2   C...    5 28 CEZP2   C...    5 20 CEZP2   
C...    5 12 CEZP2   C...    5  7 CEZP2   C...    4 37 CEZP2   C...    4 28 CEZP2   
C...    4 21 CEZP2   C...    4 13 CEZP2   C...    4  4 CEZP2   C...    3 24 CEZP2   
C...    3  6 CEZP2   C...    3  4 CEZP2   C...    3  3 CEZP2   C...    2 36 CEZP2   
C...    2 30 CEZP2   C...    1  9 CEZP2   C...    1  4 CEZP2   C1241  24 14 CEZP2   
C1242  24 16 CEZP2   CM1200 20 25 CEZP2   CMC    13 34 CEZP2   CMC    13 32 CEZP2   
CMC    13 29 CEZP2   CMC    12 18 CEZP2   CMC    10 14 CEZP2   CMCMC   7  8 CEZP2   
K***** 15 26 CEZP2   LMC    15  9 CEZP2   LMC    12 17 CEZP2   LMC    11 35 CEZP2   
LMC... 26 30 CEZP2   LMC... 26 12 CEZP2   LMC... 25 30 CEZP2   LMC... 25  3 CEZP2   
LMC... 24 24 CEZP2   LMC... 23 36 CEZP2   LMC... 23 11 CEZP2   LMC... 22 21 CEZP2   
LMC... 19 31 CEZP2   LMC... 18 36 CEZP2   LMC... 18  9 CEZP2   LMC... 17 20 CEZP2   
LMC... 16 34 CEZP2   LMC... 16  7 CEZP2   LMC... 14 21 CEZP2   LMC... 13 28 CEZP2   
LMC... 11 13 CEZP2   LMC... 10 30 CEZP2   LMC... 10  4 CEZP2   LMC...  9 20 CEZP2   
LMC...  8 31 CEZP2   LMC...  8 10 CEZP2   LMC...  6  9 CEZP2   LMC...  2 35 CEZP2   
NMC*** 20 24 CEZP2   NMC***  7  7 CEZP2   
EASYPLOT ** FICHE/FRAME BREAK *****
EZPSYM3
CEZP3     EASYPLOT PART 3 OF 8
C         25 OCTOBER 1972    THAD FLORYAN


       SUBROUTINE ITEXT(X1,Y1,THT,SBCD,ANG,LENT)
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       DIMENSION SBCD(1)
       IF (LENT .GT. 80) LENT = 80
       X1T=X1
       Y1T=Y1
       TANG=ANG+ROTANG
       IX=THT*100./SIZEINC+1E-5
       IF (IX .EQ. 0) IX = 1
       THTT=IX/(100./SIZEINC)
7      IANG=TANG/45.+1E-6
       IF (LENT) 10,30,8
8      TMOVE=THTT/2.
105    IGOTO=IANG/2+1
       IF (IGOTO .GT. 4) (IANG=IANG-8; GOTO 105)
       GO TO (110,120,130,140) IGOTO
110    Y1T=Y1T+TMOVE
       GO TO 160
120    X1T=X1T-TMOVE
       GO TO 160
130    Y1T=Y1T-TMOVE
       GO TO 160
140    X1T=X1T+TMOVE
160    CONTINUE
       N=(LENT-1)/6+1
       DO 9 I=1,N
9      BCD(I)=SBCD(I)
C... NCHSCR MUST BE SPECIFIED FOR SUBR. UNPACK:
       NCHSCR=LENT
       CALL UNPACK
       GO TO 20
10     LENT=1
       N=SBCD(1)+1E-6
       IF (N .LT. 0) GO TO 50
       IF (N .EQ. 14) Y1T = Y1T + THTT/2.222
       KSCR(1)=N*65536
       X1T=X1T-THTT/2.
20     CALL SLINE
       CALL IPLOT(X1T,Y1T,3)
       CALL ALPHA(LENT,IANG,IX,KSCR)
30     RETURN
50     SS=N
       SS=SS/200.
       SS1=Y1T+SS
       SS2=Y1T-SS
       CALL SLINE
       CALL IPLOT(X1T,SS1,3)
       CALL IPLOT(X1T,SS2,2)
       RETURN
       END
       SUBROUTINE IPLOT(X,Y,J)
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       X1=(ROTCOS*X-ROTSIN*Y)*1000./SIZEINC
       Y1=(ROTCOS*Y+ROTSIN*X)*1000./SIZEINC
       IF (J+2) 20,10,5
5      IF (J .GT. 2) GO TO 20
10     CALL PEN(-1)
       CALL CLINE
       GO TO 30
20     CALL PEN(0)
       CALL SLINE
30     IF (J .GE. 0) GO TO 34
32     CALL SLINE
34     CALL POINT(X1,Y1,IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,
     1 IOZ,INTGZ,IERRZ,LIMZ)
       IF (J .GE. 0) RETURN
40     IOLDXZ=IOLDYZ=0
50     RETURN
       END
       SUBROUTINE AXIS(JXY1,XMOVE,AXLEN,TLEN,XTSPA,XNSPA,SEPLA,SIZELA,
     1 BCDLA,NCHLA,SEPNO,SIZENO,JLGLN,START,XINC,JSCI,FACTOR,
     2 NPT,KL,NL,NWH,NDEC,NFR,KT,NT)
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       DIMENSION KL(1),KT(1),BCDLA(1)
C... NEEDED TO USE JXY1 SINCE JXY IS IN COMMON.
       IGOZ=-1
       XFACT=10./SIZEINC
       JXY=JXY1
C... PLOT AXIS LINE
C... CHECK IF FAST AXIS QUALIFIES:
C... IS SPEED=10?
       IF (LIMZ .LT. 4) GO TO 70
C... IS LENGTH EVEN UNITS OF .25 INCHES?
       L=AXLEN*XFACT*100.+1E-6
       IF (MOD(L,25) .NE. 0) GO TO 70
C... IS TIC SPACING EVEN UNITS OF .25 INCHES?
10     L=XTSPA*XFACT*100.+1E-6
       IF (MOD(L,25) .NE. 0) GO TO 70
C... IS TIC LENGTH = .05 INCHES?
20     L=TLEN*XFACT*100.+1E-6
       IF (L .NE. 5) GO TO 70
C... MUST CHECK JXY TO CONVERT XMOVE TO XLOC AND YLOC:
30     IF (JXY .GT. 0) GO TO 50
40     CALL ZAXIS(AXLEN*XFACT,XTSPA*XFACT,0.0,XMOVE*XFACT)
       GO TO 105
50     CALL ZAXIS(AXLEN*XFACT,XTSPA*XFACT,XMOVE*XFACT,0.0)
       GO TO 105
70     CALL AXPLOT(0.,XMOVE,3)
       CALL AXPLOT(AXLEN,XMOVE,2)
C... PLOT TICS:
       NTICS=AXLEN/XTSPA+1.
       DO 100 I=NTICS-1,0,-1
       DIST=I*XTSPA
       CALL AXPLOT(DIST,XMOVE,3)
       CALL AXPLOT(DIST,XMOVE-TLEN,2)
100    CONTINUE
C... ANNOTATION SECTION
105    IF (SIZENO-1E-6 .LE. 0.) GO TO 301
110    NNOS=AXLEN/XNSPA+1.
       DO 300 I=0,NNOS-1
       DIST=I*XNSPA
C... CALCULATE VALUE OF ANNOTATION
155    IF (JLGLN .LE. 0) GO TO 170
160    VALUE=(START*XINC**DIST)*FACTOR
       GO TO 190
170    VALUE=(DIST*XINC+START)*FACTOR
C... CREATE ANNOTATION STRING
190    CALL PLOTNUM(DIST,XMOVE-SEPNO-SIZENO,NPT,SIZENO,JSCI,KL,NL,
     1 NWH,NDEC,NFR,KT,NT,VALUE)
C... END LOOP
300    CONTINUE
301    CONTINUE
C... LABEL SECTION
C... CALCULATE LABEL LOCATION
       CALL CKLEN(BCDLA,NCHLA,ITPFL)
       XLENLA=ITPFL*(INT((SIZELA+1E-6)*10.)/10.)*1.5
       XBEGLA=(AXLEN-XLENLA)/2.
C... JUMP TO END IF NO LABEL
       IF (ITPFL .LE. 0) GO TO 500
C... PLOT LABEL
350    CALL AXTEXT(XBEGLA,XMOVE-SEPLA-SIZELA,SIZELA,BCDLA,0.,NCHLA)
500    JXY=0
       RETURN
       END
       SUBROUTINE PON
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       IF (JONOFF .GT. 0) RETURN
       JONOFF=1
       CALL BPLOT
       CALL IPLOT(0.,0.,-3)
       RETURN
       END
       SUBROUTINE POFF
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       IF (JONOFF .LE. 0) RETURN
       JONOFF=0
       CALL IPLOT(XPENLOC,YPENLOC,-3)
       CALL EPLOT
       RETURN
       END
       SUBROUTINE PLOTNUM(X,Y,NPOINT,SIZENO,JSCI,KL,NL,
     1 NWH,NDEC,NFR,KT,NT,VALUE)
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       DIMENSION KL(10),KT(10),KE(10)
C... ANGLE=0 FOR X AXIS, =1 FOR Y AXIS
       NWHT=NWH
       NPTEMP=NPOINT
       CALL FORNUM(NPTEMP,JSCI,NWHT,NDEC,NFR,VALUE,20,KX,KE,NEC,IERROR)
       IF (NWHT .GT. NWH) NWHT = NWH
16     NTOTNO=NWHT+NDEC+NFR
       NTOTCH=NL+NTOTNO+5*JSCI+NT
C... WIDTH OF ONE CHARACTER
       WIDTHL=SIZENO*(1.5-.5*JSCI)
C... IF NPOINT=0 THEN CENTER NUMBER ON TIC
       PTEMP=NPOINT
       IF (NPOINT .LE. 0) PTEMP = NTOTCH/2.+.5
C... CREATE COMPLETE STRING TO BE PLOTTED:
C... ADD LEADING TEXT:
32     CALL FSUBSTR(KL,1,NL,1,10,KSCR)
       NPT=NL+1
C... ADD THE NUMBER STRING:
       CALL FSUBSTR(KX,1,NTOTNO,NPT,20,KSCR)
       NPT=NPT+NTOTNO
C... IF SCIENTIFIC NOTATION, ADD EXPONENT:
       IF (JSCI .LE. 0) GO TO 60
C... ADD A QUOTE FOR LOWER CASE - AS INTERPRETED BY ZETA PLOTTER
50     KSCR(NPT)=1H@
       KSCR(NPT+1)=1HX
       KSCR(NPT+2)=1H1
       KSCR(NPT+3)=1H0
C... ADD A BACK ARROW TO SHIFT EXPONENT UP - AS INTERPRETED BY ZETA
       KSCR(NPT+4)=1H^
       NPT=NPT+5
C... ADD EXPONENT NUMBER STRING:
       CALL FSUBSTR(KE,1,NEC,NPT,5,KSCR)
       NPT=NPT+NEC
C... ADD A QUOTE TO SHIFT BACK TO UPPER CASE IN CASE THERE IS
C... TRAILING TEXT.:
       KSCR(NPT)=1H@
       NPT=NPT+1
C... ADD TRAILING TEXT:
60     CALL FSUBSTR(KT,1,NT,NPT,10,KSCR)
       NPT=NPT+NT
C... PACK 1 CHAR/WORD ARRAY INTO 3 CHAR/WORD ARRAY CALLED BCD:
       CALL PACK(KSCR,NPT-1)
C... TRANSFER INPUT LOCATIONS TO LOCAL VARIABLES SINCE SUBR. ROTATE
C... MAY CHANGE THEN DEPENDING WHETHER THE AXIS IS X OR Y.
       Y1=Y
C... SHIFT X LOC. ACCORDING TO NPOINT:
       X1=X-(PTEMP-.67)*WIDTHL
C... PLOT COMPLETE NUMBER STRING:
100    CALL AXTEXT(X1,Y1,SIZENO,BCD,0.0,NPT-1)
       RETURN
       END
       SUBROUTINE AXPLOT(X,Y,JCTL)
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       X1=X
       Y1=Y
       IF (JXY .EQ. 0) GO TO 20
10     X1=Y
       Y1=X
20     CALL IPLOT(X1,Y1,JCTL)
       RETURN
       END
       SUBROUTINE AXTEXT(X,Y,SIZE,SBCD,ANG,LEN)
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       DIMENSION SBCD(1)
       TANG=ANG
       X1=X
       Y1=Y
       IF (JXY .EQ. 0) GO TO 20
10     X1=Y+SIZE
       Y1=X
       TANG=TANG+90.
20     CALL ITEXT(X1,Y1,SIZE,SBCD,TANG,LEN)
       RETURN
       END
       SUBROUTINE FORNUM(NPT,JSCI,NWH,NDEC,NFR,X,NLIM,KX,KE,NEC,IERROR)
C... FORNUM - FORMATTED FLOATING TO ALPHA CONVERSION SUBPROGRAM
C...
C...
C... ACCEPTS A FLOATING POINT NUMBER AND CONVERTS IT ALPHA FORM
C... WHICH RESIDES IN TWO OUTPUT A1 ARRAYS: KX,KE. KX HOLDS
C... THE CONVERTED NUMBER WHILE KE HOLDS THE EXPONENT OF TEN IN
C... THE CASE OF SCIENTIFIC NOTATION.
C...
C... IF AN OVERFLOW OF THE FORMAT EXISTS, THEN NUMBER IS SHIFTED
C... TO THE RIGHT THE NECESSARY NO. OF PLACES. IN OTHER WORDS,
C... THE NUMBER WOULD BE LEFT-JUSTIFIED IN ITS FIELD. NOTE THAT
C... THIS CONDITION WILL NOT CHANGE THE FIELD LENGTH.
C...
C... THE ARRAY, KX, SHOULD BE DIMENSIONED AT LEAST 10 IN THEN
C... CALLING PROGRAM AND THE DIMENSION NO. IS TOLD TO THE SUBPROGRAM
C... BY NLIM.
C...
C... INPUT PARAMETERS:
C...
C...   JSCI=1 FOR SCIENTIFIC NOTATION
C...       =0 FOR REGULAR
C...   NWH=WHOLE PART FIELD LENGTH (CHARACTERS)
C...   NDEC=1 IF DECIMAL POINT IS DESIRED
C...       =0 FOR NO DECIMAL POINT
C...   NFR=FRACTIONAL PART FIELD LENGTH
C...   X=INPUT FLOATING POINT NUMBER TO BE CONVERTED
C...   NLIM=ARRAY SIZE LIMIT OF KX
C...
C... OUTPUT PARAMETERS:
C...
C...   KX=OUTPUT ALHPA ARRAY CONTAINING NUMBER
C...   KE=OUTPUT ALHPA ARRAY CONTAINING EXPONENT LEFT JUSTIFIED
C...   NEC=NUMBER OF CHARACTERS IN KE
C...   IERROR=0 FOR NO OVERFLOW
C...         =1 FOR MINUS SIGN ONLY OVERFLOW
C...         =2 FOR ONE CHARACTER (NOT MINUS SIGN) OVERFLOW
C...         =3 FOR MORE THAN ONE CHARACTER OVERFLOW
C...
C...
C... NOTE: IF NDEC=0 THEN NFR MUST=0. THE FIELD WIDTH IS CARRIED IN
C... THE WHOLE PART FIELD,NWH.
C...
C...
C...
       DIMENSION KX(1),KE(1)
       IERROR=0
C... TRANSFERING INPUT VALUES FOR THEIR PROTECTION
       NWHT=NWH
       NDECT=NDEC
       NRND=NFR
       DO 10 I=11,NLIM
10     KX(I)=1H0
C... SCIENTIFIC NOTATION?
       IF (JSCI .LE. 0) GOTO 30
C... CAUSE NO. TO FILL FORM WITH SPACE FOR SIGN
15     IF (NDECT .LE. 0) GOTO 25
20     NE=NWHT-1
       NRND=-(NRND+NWHT)
       GO TO 30
25     NRND=-(NWHT-1)
       NWHT=NDECT=1
       NE=0
C... BEGIN GENERAL SECTION
C... PULLING NORMALIZED DIGITS IN CHARACTER FORM
C... NEXP=EXPONENT
30     CALL FPULL(X,NRND,KX,NEXP)
C... FOR ZERO, LIMIT TO ONLY ONE ZERO:
       IF (KX(1) .NE. 1H0) GO TO 33
       IF (NFR .LE. 0) GO TO 33
       NEXP = 0
33     IF (JSCI .LE. 0) NE = NEXP
       IF (NDECT .LE. 0) GO TO 105
C... IF NO DEC. PT. THEN JUMP DIRECTLY TO PLACING MINUS SIGN
C... PLACING DECIMAL PT. SECTION:
50     IF (NE .GE. 0) GO TO 90
C... PLACING DEC. PT. FOR NEGATIVE EXP.(EG. 23000 TO .0023)
60     DO 70 I=NLIM,-NE+2,-1
70     KX(I)=KX(I+NE-1)
       KX(1)=1H.
       DO 80 I=2,-NE+1
80     KX(I)=1H0
       NACTWH=0
       GO TO 110
C... PLACING DEC. PT FOR POSITIVE EXPONENT
C... (EG. 23000 TO 2.3000)
90     DO 100 I=NLIM,NE+2,-1
100    KX(I)=KX(I-1)
       KX(NE+1)=1H.
105    NACTWH=NE
C... PLACING MINUS SIGN SECTION
110    IF (X .GE. 0.) GO TO 135
120    DO 130 I=NLIM,2,-1
130    KX(I)=KX(I-1)
       KX(1)=1H-
       NACTWH=NACTWH+1
C... IF NPT AND JSCI ARE BOTH NZEROE (THAT IS '%' FORMAT WITH
C... NO POINTER) THEN LEFT JUSTIFY FOR CENTERING LATER.
135    IF (NPT+JSCI .GT. 0) GO TO 138
136    NWH=NACTWH
       RETURN
C... CHECKING FO OVERFLOW
138    IF (NACTWH-NWHT) 190,215,136
C... SHIFTING TO JUSTIFY DECIMAL PT.
190    N=NWHT-NACTWH
       DO 200 I=NLIM,N+1,-1
200    KX(I)=KX(I-N)
       DO 210 I=1,N
210    KX(I)=0
C... SCIENTIFIC NOTATION SECTION
215    IF (JSCI .LE. 0) RETURN
C... CREATE EXPONENT STRING, KE
220    EXP=NEXP-NWHT+1
       CALL FPULL(EXP,2,KE,NEC)
       IF (EXP .GE. 0.) RETURN
C... PLACING MINUS IN EXPONENT STRING
230    KE(3)=KE(2)
       KE(2)=KE(1)
       KE(1)=1H-
       NEC=NEC+1
250    RETURN
       END
       SUBROUTINE FPULL(X,NROUND,KX,NEXP)
C... FPULL - FLOATING TO ALPHA CONVERSION SUBPROGRAM
C...
C...
C... ACCEPTS A FLOATING PT. NO. AND CONVERTS IT TO AN ALPHA
C... STRING REPRESENTING IT IN NORMALIZED FORM. (EG. .4567E23)
C... THE STRING CONTAINS NO LEADING SPACES, DECIMAL PT, OR "-".
C... THE NUMBER IS ROUNDED IN CONVERSION TO A SPECIFIED NO. 
C... OF DIGITS PAST THE DECIMAL POINT.
C...
C... NOTE: NROUND SHOULD USUALLY BE <10 . (10 WILL USUALLY WORK)
C...       IF X=0 THEN NEXP WILL =1
C...
C... INPUT PARAMETER LIST:
C...
C...   X=INPUT FLOATING PT NO. TO BE CONVERTED
C...   NROUND=INDICATES WHERE THE NO. WILL BE ROUNDED TO
C...
C... OUTPUT PARAMETER LIST:
C...
C...   KX=OUTPUT ALPHA, A1 ARRAY. (10 WORDS)
C...   NEXP=EXPONENT IN INTEGER FORM
C...
C... NOTE: KX SHOULD BE DIMENSIONED AT LEAST 10 IN CALLING PROGRAM.
C...
C...
       DIMENSION KX(10)
       DO 10 I=1,10
10     KX(I)=1H0
       XR=ABS(X)
       IF (X .EQ. 0) (NEXP =1; RETURN)
13     CALL PEXP(.1,1.,XR,X1,NEXP)
       IF (NROUND .LT. 0) (NR = -NROUND; GOTO 43)
42     NR=NEXP+NROUND
       IF (NR) 100,95,43
95     X1=X1+.5
       IF (X1 .LT. 1.) RETURN
97     NR=1
       GO TO 20
43     IF (NR .GT. 9) NR=9
44     XMUL=1.
       DO 18 M=1,NR
18     XMUL=XMUL/10.
       X1=X1+.5*XMUL
15     IF (X1 .LT. 1.) GOTO 30
20     X1=X1/10.
       NEXP=NEXP+1
       GO TO 15
30     DO 80 I=1,NR
       X1=X1*10.
       IASC=X1+1E-9
       KX(I)=(IASC+16)*65536
       X1=X1-IASC
80     CONTINUE
100    RETURN
       END
       SUBROUTINE PEXP(R1,R2,X,XCHA,NEXP)
C... PEXP - 10 MULTIPLIER CALCULATION SUBROUTINE
C...
C...
C... GIVEN A RANGE, THIS SUBPROGAM CALCULATES THE EXPONENT OF TEN
C... NEEDED TO PUT THE MANTISSA IN THE RANGE.
C...
C... INPUT PARAMETER LIST:
C...
C...   R1=LOWER RANGE LIMIT - MANTISSA WILL BE EQUAL TO OR GREATER
C...      THAN THIS LIMIT
C...   R2=UPPER RANGE LIMIT - MANTELLA WILL BE LESS THAN THIS
C...      LIMIT
C...   X=INPUT FLOATING PT. NUMBER TO BE EXAMINED
C...
C... OUTPUT PARAMETER LIST:
C...
C...   XCHA=ALTERED X, SO THAT XCHA TIMES 10 TO THE NEXP POWER =X
C...   NEXP=POWER OF TEN MENTIONED ABOVE
C...
C...
C...
       XCHA=ABS(X)
       IF (XCHA .GE. R2) GO TO 40
20     IF (XCHA .LT. R1) GO TO 70
30     NEXP=0
       GO TO 100
C... CALCULATING POSITIVE EXPONENT
40     DO 50 I=1,70
       XCHA=XCHA/10.
       IF (XCHA .LT. R2) GO TO 60
50     CONTINUE
60     NEXP=I
       GO TO 100
C... CALCULATING NEGATIVE EXPONENT
70     DO 80 I=1,70
       XCHA=XCHA*10.
       IF (XCHA .GE. R1) GO TO 90
80     CONTINUE
90     NEXP=-I
100    IF (X .LT. 0.) XCHA = -XCHA
120    RETURN
       END
       SUBROUTINE ZAXIS(XLEN,TINT,XLOC,YLOC)
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       XSP=4.+6.*(4-LIMZ)
       JINC=SIZEINC/4.99
       JXY2=2*JXY
       KINC=2/JINC
       IROTANG=ROTANG+1E-6
       IR=IROTANG/90
       N1 = MOD(7+2*IR-JXY2,8)
       N2 = MOD(3+2*IR-JXY2,8)
       N3 = MOD(2*IR+JXY2,8)
       N4 = MOD(N3+4,8)
       IGOZ=-1
       CALL IPLOT(XLOC,YLOC,3)
       NINT=XLEN/TINT+1E-6
       ITINT=XSP*TINT+1E-6
       IREM=(XLEN-NINT*TINT+1E-6)*XSP
C... DRAW AXIS
       CALL OUT873
       CALL OUT(5+JINC)
       CALL OUT8
       CALL OUT(N1)
       CALL OUT(N2)
       DO 20 I=1,NINT
       DO 10 J=1,ITINT*KINC
 10    CALL OUT(N3)
       CALL OUT(N1)
 20    CALL OUT(N2)
       IF (IREM .EQ. 0) GO TO 60
50     DO 40 I=1,IREM*KINC
 40    CALL OUT(N3)
60     CALL OUT9
       DO 30 I=1,ITINT*KINC*NINT+IREM*KINC
 30    CALL OUT(N4)
       CALL OUT9
       LZ=1
       IOLDDZ=0
       RETURN
       END
EASYPLOT ** FICHE/FRAME BREAK *****
EZPSYM3 SYMSORT

SYM.  PG.LN. IDENT.

10     12 26 CEZP3   10     10 16 CEZP3   10      9 10 CEZP3   10      8 25 CEZP3   
10      4 10 CEZP3   10      3  7 CEZP3   10      2  9 CEZP3   100    14  7 CEZP3   
100    13 13 CEZP3   100    11 12 CEZP3   100     8  5 CEZP3   100     4 29 CEZP3   
105    11 14 CEZP3   105     4 31 CEZP3   105     1 30 CEZP3   110    11 16 CEZP3   
110     4 32 CEZP3   110     1 33 CEZP3   120    14  8 CEZP3   120    11 17 CEZP3   
120     1 35 CEZP3   13     12 29 CEZP3   130    11 18 CEZP3   130     1 37 CEZP3   
135    11 23 CEZP3   136    11 24 CEZP3   138    11 27 CEZP3   140     1 39 CEZP3   
15     13  3 CEZP3   15     10 20 CEZP3   155     4 36 CEZP3   16      7  2 CEZP3   
160     4 37 CEZP3   160     2  1 CEZP3   170     4 39 CEZP3   18     13  1 CEZP3   
190    11 29 CEZP3   190     5  2 CEZP3   20     13 30 CEZP3   20     13  4 CEZP3   
20     10 21 CEZP3   20      9 13 CEZP3   20      8 27 CEZP3   20      4 13 CEZP3   
20      3 10 CEZP3   20      2 15 CEZP3   200    11 31 CEZP3   210    11 33 CEZP3   
215    11 35 CEZP3   220    11 37 CEZP3   230    12  2 CEZP3   25     10 24 CEZP3   
250    12  6 CEZP3   30     13 31 CEZP3   30     13  7 CEZP3   30     10 30 CEZP3   
30      4 16 CEZP3   30      3 12 CEZP3   30      2 18 CEZP3   300     5  5 CEZP3   
301     5  6 CEZP3   32      7 11 CEZP3   32      3 13 CEZP3   33     10 35 CEZP3   
34      3 14 CEZP3   350     5 15 CEZP3   40     13 34 CEZP3   40      4 17 CEZP3   
40      3 17 CEZP3   42     12 31 CEZP3   43     12 37 CEZP3   44     12 38 CEZP3   
5       3  6 CEZP3   50     15 12 CEZP3   50     13 37 CEZP3   50     10 39 CEZP3   
50      7 19 CEZP3   50      4 19 CEZP3   50      3 18 CEZP3   50      2 19 CEZP3   
500     5 16 CEZP3   60     15 14 CEZP3   60     13 38 CEZP3   60     11  2 CEZP3   
60      7 34 CEZP3   7       1 27 CEZP3   70     14  2 CEZP3   70     11  3 CEZP3   
70      4 21 CEZP3   8       1 29 CEZP3   80     14  5 CEZP3   80     13 12 CEZP3   
80     11  6 CEZP3   9       2  4 CEZP3   90     14  6 CEZP3   90     11 11 CEZP3   
95     12 33 CEZP3   97     12 35 CEZP3   C       1  2 CEZP3   
C...   14 39 CEZP3   C...   14 16 CEZP3   C...   14 11 CEZP3   C...   14  1 CEZP3   
C...   13 33 CEZP3   C...   13 27 CEZP3   C...   13 24 CEZP3   C...   13 23 CEZP3   
C...   13 22 CEZP3   C...   13 21 CEZP3   C...   13 18 CEZP3   C...   13 16 CEZP3   
C...   12 22 CEZP3   C...   12 19 CEZP3   C...   12 16 CEZP3   C...   12 14 CEZP3   
C...   12 13 CEZP3   C...   12 12 CEZP3   C...   12 11 CEZP3   C...   12  9 CEZP3   
C...   12  1 CEZP3   C...   11 36 CEZP3   C...   11 34 CEZP3   C...   11 28 CEZP3   
C...   11 26 CEZP3   C...   11 22 CEZP3   C...   11 21 CEZP3   C...   11 15 CEZP3   
C...   11 10 CEZP3   C...   11  9 CEZP3   C...   11  1 CEZP3   C...   10 38 CEZP3   
C...   10 37 CEZP3   C...   10 31 CEZP3   C...   10 29 CEZP3   C...   10 28 CEZP3   
C...   10 27 CEZP3   C...   10 19 CEZP3   C...   10 17 CEZP3   C...   10 11 CEZP3   
C...   10  8 CEZP3   C...   10  6 CEZP3   C...   10  5 CEZP3   C...   10  4 CEZP3   
C...   10  3 CEZP3   C...   10  2 CEZP3   C...   10  1 CEZP3   C...    9 37 CEZP3   
C...    9 36 CEZP3   C...    9 35 CEZP3   C...    9 34 CEZP3   C...    9 33 CEZP3   
C...    9 32 CEZP3   C...    9 31 CEZP3   C...    9 28 CEZP3   C...    9 27 CEZP3   
C...    9 25 CEZP3   C...    9 24 CEZP3   C...    9 23 CEZP3   C...    9 21 CEZP3   
C...    9 20 CEZP3   C...    9 19 CEZP3   C...    9 17 CEZP3   C...    8 36 CEZP3   
C...    8 31 CEZP3   C...    8 14 CEZP3   C...    8  9 CEZP3   C...    8  4 CEZP3   
C...    8  2 CEZP3   C...    7 39 CEZP3   C...    7 38 CEZP3   C...    7 36 CEZP3   
C...    7 33 CEZP3   C...    7 30 CEZP3   C...    7 29 CEZP3   C...    7 26 CEZP3   
C...    7 23 CEZP3   C...    7 18 CEZP3   C...    7 16 CEZP3   C...    7 13 CEZP3   
C...    7 10 CEZP3   C...    7  9 CEZP3   C...    7  6 CEZP3   C...    7  4 CEZP3   
C...    6 36 CEZP3   C...    6 27 CEZP3   C...    6 22 CEZP3   C...    6  6 CEZP3   
C...    6  1 CEZP3   C...    5 25 CEZP3   C...    5 20 CEZP3   C...    5 14 CEZP3   
C...    5 12 CEZP3   C...    5  8 CEZP3   C...    5  7 CEZP3   C...    5  4 CEZP3   
C...    5  1 CEZP3   C...    4 35 CEZP3   C...    4 30 CEZP3   C...    4 23 CEZP3   
C...    4 15 CEZP3   C...    4 12 CEZP3   C...    4  9 CEZP3   C...    4  6 CEZP3   
C...    4  4 CEZP3   C...    4  3 CEZP3   C...    4  2 CEZP3   C...    3 37 CEZP3   
C...    3 28 CEZP3   C...    3 23 CEZP3   C...    2 34 CEZP3   C...    2 29 CEZP3   
C...    2  5 CEZP3   C...    1 11 CEZP3   C...    1  6 CEZP3   L      14 10 CEZP3   
L      13 15 CEZP3   L      12  8 CEZP3   L       9 16 CEZP3   L       8 30 CEZP3   
L       8  8 CEZP3   L       6 20 CEZP3   L       5 39 CEZP3   L       5 19 CEZP3   
L       3 20 CEZP3   L       2 28 CEZP3   O...MC 13 28 CEZP3   O...MC 13 26 CEZP3   
O...MC 13 25 CEZP3   O...MC 13 20 CEZP3   O...MC 13 19 CEZP3   O...MC 13 17 CEZP3   
O...MC 12 24 CEZP3   O...MC 12 23 CEZP3   O...MC 12 21 CEZP3   O...MC 12 20 CEZP3   
O...MC 12 18 CEZP3   O...MC 12 17 CEZP3   O...MC 12 15 CEZP3   O...MC 12 10 CEZP3   
O...MC 10  9 CEZP3   O...MC 10  7 CEZP3   O...MC  9 39 CEZP3   O...MC  9 38 CEZP3   
O...MC  9 30 CEZP3   O...MC  9 29 CEZP3   O...MC  9 26 CEZP3   O...MC  9 22 CEZP3   
O...MC  9 18 CEZP3   
EASYPLOT ** FICHE/FRAME BREAK *****
EZPSYM4
CEZP4     EASYPLOT PART 4 OF 8
C         25 OCTOBER 1972    THAD FLORYAN

C... AXINT - SUBROUTINE FOR INPUTTING AXIS INFORMATION.
       SUBROUTINE AXINT(LARAX,XMOVE,AXLEN,
     1 TLEN,XTSPA,XNSPA,SEPLA,SIZELA,
     1 BCDLA,NCHLA,SEPNO,SIZENO,FACTOR,JSCI,NPT,KL,NL,NWH,NDEC,
     2 NFR,KT,NT)
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
C... THEY TAKE THE PLACE OF BCD (SCRATCH FLOATING MIMORY)
C... NOTE THAT KSCR IS SCRATCH INTERGER MEMORY.
       DIMENSION BCDLA(1),KLT(10),KTT(10),KL(1),KT(1),LARAX(11)

C      READ LINE FROM USER:
100    CALL RDP
C... INTERPRET AXIS SUBCOMMANDS:
99    GOTO(150,200,300,400,500,600,700,800,900,1000,1100,1200)LANG(LARAX,11)
C          BAD,LEN,LAB,FOR,MOV,SPA,FAC,NSI,LSI, NLO, LLO, TLE
150    RETURN

C      'LENGTH' OF AXIS IN INCHES
200    CALL VALUE1(AXLEN)
       GO TO 100

C      'LABEL'  (TEXT FOR LABELLING THE AXIS)
C      PULL LABEL STRING AND STORE IN FLOATING ARRAY
300    CALL STRING
360    CALL FLPACK
       NCHLA=NCHSCR
       DO 361 I=1,12
361    BCDLA(I)=BCD(I)
       GO TO 100

C      'FORMAT'  (SETS FORMAT FOR NUMBERS ALONG AXIS)
C      PULL STRING WITH FORMAT IN QUOTES
400    CALL STRING
C... PROCESS FORMAT NOW CONTAINED IN KSCR (SCRATCH INTEGER MEMORY)
       CALL FPROC(KSCR,NCHSCR,JSCIT,KLT,NLT,NWHT,NDECT,NFRT,NPTT,
     1 KTT,NTT,IERROR)
C... IF NO ERROR, TRANSFER SCRATCH VALUES TO PROPER STORAGE
       IF (IERROR .GT. 0) GO TO 420
412    DO 413 I=1,10
       KL(I)=KLT(I)
413    KT(I)=KTT(I)
       JSCI=JSCIT
       NL=NLT
       NWH=NWHT
       NDEC=NDECT
       NFR=NFRT
       NPT=NPTT
       NT=NTT
       GO TO 100
420    CALL MESSAGE(IERROR+2)
       GO TO 100

C      'MOVE AXIS='  (MOVES IT RELATIVE TO REFERENCE POINT
500    DO 510 I=1,72
       IF (KX(I) .EQ. 1H=) GO TO 520
510    CONTINUE
       GO TO 150
520    CALL VALUE1(XMOVE)
       GO TO 100

C      'SPACING TICS [,NUMBERS]'  (SPACING BETWEEN ALONG AXIS)
600    N=1
       CALL PAIR(N,XTSPA,XNSPA,IERROR)
       IF (IERROR) 602,100,601
C      'COMMAND REQUIRES 1 OR 2 VALUES'
601    CALL MESSAGE(37)
C      SET XNSPA TO DEFAULT OF 2. IF NUMBER SPACING NOT SPECIFIED
602    XNSPA=2.
       GO TO 100

C      'FACTOR'  (NUMERIC SCALING FACTOR)
700    CALL VALUE1(FACTOR)
       GO TO 100

C      'NSIZE'   (SIZE OF NUMBERS)
800    CALL VALUE1(SIZENO)
       GO TO 100

C      'LSIZE'   (SIZE OF AXIS LABEL (HEIGHT))
900    CALL VALUE1(SIZELA)
       GO TO 100

C      'NLOCATION'   (DIST. BETWEEN NUMBERS AND AXIS)
1000   CALL VALUE1(SEPNO)
       GO TO 100

C      'LLOCATION'   (INCHES BETWEEN LABEL AND AXIS)
1100   CALL VALUE1(SEPLA)
       GO TO 100

C      'TLENGTH'   (LENGTH OF TICS)
1200   CALL VALUE1(TLEN)
       GO TO 100
       END
       SUBROUTINE MESSAGE(MNO)
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY

C  IF JMESS = 1 THEN TYPE LONG MESSAGE
C           = 0 THEN TYPE SIMPLE MESSAGE
C  SAVE MESSAGE NUMBER FOR MAIN PROGRAM

       MESSNO = MNO
       CALL POFF

C  IF MESSNO < 0, DON'T TYPE INCORRECT LINE

       IF (MESSNO .LT. 0) GO TO 30

C  IF PROGRAM FROM TTY, DON'T TYPE INCORRECT LINE

10     IF (KP .LE. 0) GO TO 30

C  TYPE LAST LINE INPUTTED

20     TYPE 25,(KX(I),I=1,NCHKX)
25     FORMAT(/80A1)

C  IF JMESS = 0, USE SHORT MESSAGE

30     IF (JMESS .GT. 0) GO TO 50
C      MESPRT(57)='STATEMENT ERROR'
C      MESPRT(58)='EXECUTION ERROR'
40    IF(MNO.GT.0)CALL MESPRT(57) .ELSE. CALL MESPRT(58)
       GOTO 60
50     CALL MESPRT(MNO)
60     CALL CLZCOM(MODEZ,NDEVZ)
       KP = 0
       CLOSE(2)
       KFRDP = -1
       GOTO JUMP1
       END
       SUBROUTINE RDP
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
C... EASYPLOT PROGRAM LINE INPUT SUBPROGRAM
C... IPTR1=1ST WORD POINTER
C... IPTR2=2ND WORD POINTER
C... ":" GLITCH
       KLBR=1H:
C... IF NCHKX=0,SUPRESS "GLITCH"
       IF (NCHKX .EQ. 0) KLBR = -1
C... IF KP=1, ACCEPT LINE FROM FILE #2, ELSE FROM TEL
40     IF (NDEVZ .NE. -1) GO TO 60
       IGL = MODEZ
C... READ LINE FROM TEL - ONE TAB AT 3 SPACES:
C... TURN PLOTTER OFF BEFORE PRINTING "GLITCH".
50     CALL POFF
       KEOF = -1
       CALL RDLINE(KLBR,KX,NCHKX,IERROR,IGL)
C... IF IERROR>0, "LINE TOO LONG"
       IF (IERROR .GT. 0) CALL MESSAGE(19) .ELSE. GOTO 80
C... READ FROM FILE
60     IF (KP .NE. 1) (IGL = 0; GO TO 50)
       KEOF = 1
       READ 2,61,(KX(I),I=1,80)
61     FORMAT(80A1)
       NCHKX=80
C... NOTE: CANNOT TELL IS LINE IS TOO LING FOR FILE READ CASE.
C...       NCHKX WILL BE ALTERED WHEN TRAILING SPACES ARE TRIMMED.
C... PROCEED
C... TRIM TRAILING SPACES OFF.
80     IF (KX(1) .EQ. 1H*) GO TO 40
82     DO 85 I=NCHKX,1,-1
       IF (KX(I) .NE. 0) GO TO 86
85     CONTINUE
C... IF NO TEXT IN LINE, START OVER.
       GO TO 40
C... SET NCHKX = NO. CHAR. IN LINE AND PLACE A "!" AT END
86     NCHKX=I
       KX(I+1)=1H!
C... FIND 1ST WORD POINTER
       DO 90 I=1,NCHKX
       IF (KX(I) .NE. 0) GO TO 100
90     CONTINUE
100    IPTR1=I
C... FIND 2ND WORD POINTER
C... START 2 CHAR. OVER FROM IPTR1 BECAUSE OF
C... INTERNAL SPACES IN COMMANDS.
       DO 110 J=IPTR1+2,NCHKX
       IF (KX(J) .EQ. 0) GO TO 120
110    CONTINUE
C... NO SECOND WORD, SET IPTR2=0
       IPTR2=0
       GO TO 200
C... SCAN SPACES TO BEGINNING OF 2ND WORD.
120    DO 150 I=J,NCHKX
       IF (KX(I) .NE. 0) GO TO 160
150    CONTINUE
160    IPTR2=I
C... PACK 1ST 3 CHAR. OF LINE INTO KB
200    KB=KX(IPTR1)+KX(IPTR1+1)/256+KX(IPTR1+2)/65536
       RETURN
       END
       SUBROUTINE PSCALE(SLEN,START,XINC,XINT,JSSET,JDSET,
     1 JREV,JLGLN,XMAX,XMIN)
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
C... INTERNAL COMMON FOR PSCALE,LOWER,CENTER, AND FIT
       COMMON XMAXSC,XMINSC,XINCSC,STARTSC,SLENSC,XLOW,XHIGH,ABO
       IF (JSSET+JDSET-2 .NE. 0) GO TO 11
15     IF (JLGLN .LE. 0) (XINC = XINC/XINT; RETURN)
22     IF (START .GT. 0.) GO TO 17
C... ERROR: "NEGATIVE OR ZERO START OR INCR. NOT ALLOWED."
16     CALL MESSAGE(-36)
17     IF (XINC .LE. 0.) GO TO 16
630    XINC=XINC**(1./XINT)
       RETURN
11     IF (JLGLN .GT. 0) CALL MESSAGE(-23)
       IF (NUM .LE. 0) CALL MESSAGE(-24)
21     XMAXSC=XMAX
       XMINSC=XMIN
       XINCSC=XINC
       STARTSC=START
       SLENSC=SLEN/XINT
       IF (JSSET .LE. 0) GOTO 120
       IF (JDSET .LE. 0) GOTO 200 .ELSE. GOTO 600
120    IF (JDSET .LE. 0) GOTO 400 .ELSE. GOTO 500
C... CALCULATES XINCSC GIVEN STARTSC
200    XM=XMAXSC
       IF (JREV .LE. 0) GOTO 230
220    XM=XMINSC
230    XINCSC=ABS((XM-STARTSC)/SLENSC)
       IF (XINCSC .LT. 0.) CALL MESSAGE(-26)
235    CALL FIT
       XINCSC=ABO
       IF (JREV .LE. 0) GOTO 250
240    XINCSC=-ABO
250    CALL LOWER
       IF (XHIGH-SLENSC-1E-6 .LE. 0.) GOTO 600
260    XINCSC=ABS(1.1*XINCSC)
       GO TO 235
C... CALCULATES XINCSC AND STARTSC
400    XINCSC=(XMAXSC-XMINSC)/SLENSC
410    CALL FIT
       XINCSC=ABO
       CALL CENTER
       CALL LOWER
       IF (XHIGH-SLENSC-1E-6 .LE. 0.) GOTO 430
420    XINCSC=1.1*XINCSC
       GO TO 410
430    IF (JREV .LE. 0) GOTO 600
440    XINCSC=-XINCSC
       CALL CENTER
       GO TO 600
C... CALCULATES STARTSC GIVEN XINCSC
500    CALL CENTER
600    START=STARTSC
       XINC=XINCSC/XINT
650    RETURN
       END
       SUBROUTINE FIT
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
C... INTERNAL COMMON FOR PSCALE,LOWER,CENTER, AND FIT
       COMMON XMAXSC,XMINSC,XINCSC,STARTSC,SLENSC,XLOW,XHIGH,ABO
       EXACT=XINCSC
       XMUL=1E-3
       DO 80 I=1,100
       IF (EXACT-XMUL) 20,20,30
20     ABO=XMUL
       GO TO 100
30     IF (EXACT-2.*XMUL) 40,40,50
40     ABO=2.*XMUL
       GO TO 100
50     IF (EXACT-5.*XMUL) 60,60,70
60     ABO=5.*XMUL
       GO TO 100
70     XMUL=XMUL*10.
80     CONTINUE
100    CONTINUE
       RETURN
       END
       SUBROUTINE CENTER
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
C... INTERNAL COMMON FOR PSCALE,LOWER,CENTER, AND FIT
       COMMON XMAXSC,XMINSC,XINCSC,STARTSC,SLENSC,XLOW,XHIGH,ABO
       STARTSC=0.
       CALL LOWER
       DIFF=(SLENSC-XHIGH)-XLOW
       IF (DIFF-1E-6 .LE. 0.) GOTO 30
       NSH=DIFF/2.+.5
       STARTSC=-NSH*XINCSC
       GO TO 50
30     IF (DIFF .GT. -2.) GO TO 50
       NSH=(DIFF+2.)/2.-1E-6
       STARTSC=-(NSH-1.)*XINCSC
50     CALL LOWER
       IF (XLOW+1E-6 .GE. 0.) GOTO 70
60     STARTSC = STARTSC - XINCSC
       CALL LOWER
       IF (XLOW+1E-6 .LT. 0.) GOTO 60 .ELSE. RETURN
70     IF (XHIGH-SLENSC-1E-6 .LE. 0.) RETURN
       STARTSC = STARTSC + XINCSC
       CALL LOWER
       IF (XLOW+1E-6 .GE. 0.) GOTO 70
       STARTSC = STARTSC - XINCSC
       RETURN
       END
       SUBROUTINE LOWER
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
C... INTERNAL COMMON FOR PSCALE,LOWER,CENTER, AND FIT
       COMMON XMAXSC,XMINSC,XINCSC,STARTSC,SLENSC,XLOW,XHIGH,ABO

       XLOW=(XMINSC-STARTSC)/XINCSC
       XHIGH=(XMAXSC-STARTSC)/XINCSC
       IF (XLOW .LE. XHIGH) RETURN
       T=XLOW
       XLOW=XHIGH
       XHIGH=T
       RETURN
       END
       SUBROUTINE CSYM
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY

C      JXLGLN:  1 = LOG SCALE
C               0 = LINEAR SCALE
C      JYLGLN:  1 = LOG SCALE
C               0 = LINEAR SCALE
       IF (JXLGLN .GT. 0) XLOGFA = ALOG(XINCTMP)
       IF (JYLGLN .GT. 0) YLOGFA = ALOG(YINCTMP)
100    NCOUNT=0
115    NCOUNT=NCOUNT+1
       IF (NCOUNT .GT. NUM) RETURN
130    READ (5) X,Y
       M = MOD(NCOUNT,LSKIP)
       IF (M .NE. 0) GOTO 115
140    IF (JXLGLN .GT. 0) GOTO 160
150    XP=(X-XSTATMP)/XINCTMP
       GO TO 200
160    IF (X .LE. 0.) GOTO 115
       XP=ALOG(X/XSTATMP)/XLOGFA
200    IF (SCXTMP .LE. 0.) GOTO 240
       IF (XP+1E-6) 115,240,220
220    IF (XP-SCXTMP-1E-6 .GT. 0.) GOTO 115
240    IF (JYLGLN .GT. 0) GOTO 260
250    YP=(Y-YSTATMP)/YINCTMP
       GO TO 300
260    IF (Y .LE. 0.) GOTO 115
       YP=ALOG(Y/YSTATMP)/YLOGFA
300    IF (SCYTMP .LE. 0.) GOTO 340
       IF (YP+1E-6) 115,340,320
320    IF (YP-SCYTMP-1E-6 .GT. 0.) GOTO 115
340    FL=ICOM2
       ITPF = -1
       CALL ITEXT(XP,YP,SYHT,FL,0.0,ITPF)
       GO TO 115
       END
       SUBROUTINE LINES
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY

C      JXLGLN:  1 = LOG SCALE
C               0 = LINEAR SCALE
C      JYLGLN:  1 = LOG SCALE
C               0 = LINEAR SCALE
       IF (JXLGLN .GT. 0) XLOGFA = ALOG(XINCTMP)
       IF (JYLGLN .GT. 0) YLOGFA = ALOG(YINCTMP)
100    NCOUNT=0
110    JREP=0
       JUP=1
115    NCOUNT=NCOUNT+1
       IF (NCOUNT .GT. NUM) RETURN
130    READ (5) X,Y

C      XCOM1 = STOP VALUE
       IF (X .EQ. XCOM1) GOTO 110
       IF (JXLGLN .GT. 0) GOTO 160
150    XP2=(X-XSTATMP)/XINCTMP
       GO TO 210
160    IF (X .LE. 0.) GOTO 180
       XP2=ALOG(X/XSTATMP)/XLOGFA
       GO TO 210
180    IF (XINCTMP .LE. 1.) GOTO 200
       XP2=-1E10
       GO TO 210
200    XP2=1E10
210    IF (JYLGLN .GT. 0) GOTO 230
220    YP2=(Y-YSTATMP)/YINCTMP
       GO TO 280
230    IF (Y .LE. 0.) GOTO 250
       YP2=ALOG(Y/YSTATMP)/YLOGFA
       GO TO 280
250    IF (YINCTMP .LE. 1.) GOTO 270
       YP2=-1E10
       GO TO 280
270    YP2=1E10
280    IF (JREP .GT. 0) GOTO 300
290    XP1=XP2
       YP1=YP2
       JREP=1
       GO TO 115
C      AVOID ATTEMPTING TO PLOT SAME POINT TWICE
300    IF ((XP1 .EQ. XP2) .AND. (YP1 .EQ. YP2)) GOTO 115
       XP2SV=XP2
       YP2SV=YP2
       IF(XP1+1E-10 .LT. 0) GOTO 1200
       IF(SCXTMP-XP1+1E-10 .LT. 0) GOTO 1200
       IF(YP1+1E-10 .LT. 0) GOTO 1200
       IF(SCYTMP-YP1+1E-10 .LT. 0) GOTO 1200
       IF(XP2+1E-10 .LT. 0) GOTO 1200
       IF(SCXTMP-XP2+1E-10 .LT. 0) GOTO 1200
       IF(YP2+1E-10 .LT. 0) GOTO 1200
       IF(SCYTMP-YP2+1E-10 .LT. 0) GOTO 1200
       GOTO 510
1200   IF((XP1-XP2) .NE. 0.) GOTO 1300
       IF((YP1-YP2) .LT. 0.) SLOPE=1E5 .ELSE. SLOPE=-1E5
       GOTO 1301
1300   SLOPE=(YP1-YP2)/(XP1-XP2)
1301   CNST=YP1-SLOPE*XP1
       IF (ABS(SLOPE)-1E5) 304,301,301
301    CNST2=XP1-YP1/SLOPE
       SLOPE=1E5
       CNST=-SLOPE*CNST2
       XP1=(YP1-CNST)/SLOPE
       XP2=(YP2-CNST)/SLOPE
       GO TO 306
304    IF (ABS(SLOPE)-1E-5) 302,306,306
302    SLOPE=1E-5
306    IF (SCXTMP .LE. 0.) GOTO 405
       IF (XP1 .GE. 0.) GOTO 330
       XP1=0
       GO TO 345
330    IF (XP1 .LE. SCXTMP) GOTO 350
       XP1=SCXTMP
345    JUP=1
350    IF (XP2 .GE. 0.) GOTO 370
       XP2=0
       GO TO 400
370    IF (XP2 .GT. SCXTMP) XP2 = SCXTMP
400    YP1=SLOPE*XP1+CNST
       YP2=SLOPE*XP2+CNST
405    IF (SCYTMP .LE. 0.) GOTO 505
       IF (YP1 .GE. 0) GOTO 430
       YP1=0
       GO TO 445
430    IF (YP1 .LE. SCYTMP) GOTO 450
       YP1=SCYTMP
445    JUP=1
450    IF (YP2 .GE. 0.) GOTO 470
       YP2=0
       GO TO 500
470    IF (YP2 .GT. SCYTMP) YP2=SCYTMP
500    XP1=(YP1-CNST)/SLOPE
       XP2=(YP2-CNST)/SLOPE
505    IF (XP1 .NE. XP2) GOTO 510
       IF (YP1 .EQ. YP2) GOTO 535
510    IF (JUP .LE. 0) GOTO 530
       IGOZ=-1
       CALL IPLOT(XP1,YP1,3)
       IGOZ=0
530    CALL IPLOT(XP2,YP2,2)
       JUP=0
535    XP1=XP2SV
       YP1=YP2SV
       GO TO 115
       END
       SUBROUTINE GRID(JXY1,IGA,NGA,REP,XLEN,YLEN)
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       DIMENSION IGA(25)
C... I=GRID ARRAY POINTER, BEG=X POSITION OF CYCLE.
C... NOTE: THIS SUBROUTINE ONLY DESCRIBES GRIDS FOR THE X-CASE.
C... THIS IS ONLY NECESSARY BECAUSE SUBR. AXPLOT TAKES
C... CARE OF THE Y CASE. NOTE, HOWEVER, THAT XLEN MUST POINT
C... TO YLEN IN THE MAIN PROG. FOR THE Y CASE.(AND YLEN TO XLEN).
C... SET JXY=1 FOR Y AXIS:
       JXY=JXY1
       I=0
       BEG=0.
20     I=I+1
C... IF END OF ARRAY, START CYCLE OVER:
       IF (I .LE. NGA) GOTO 40
30     I=1
       BEG=BEG+REP
40     X=BEG+IGA(I)/1000.
C... RETURN IF GRIDS ARE FINISHED:
       IF (X .GT. XLEN) GOTO 100
       CALL AXPLOT(X,0.,3)
       CALL AXPLOT(X,YLEN,2)
C... WE NEED TWO PLOTTED LINES PER LOOP, SINCE FOR FAST PLOTTING,
C... THE PEN SHOULD GO UP ONE LINE, AND COME DOWN THE NEXT. NOTE THE
C... REVERSED TRAVEL DIRECTIONS IN THE AXPLOT CALLS.
       I=I+1
       IF (I .LE. NGA) GOTO 70
60     I=1
       BEG=BEG+REP
70     X=BEG+IGA(I)/1000.
       IF (X .GT. XLEN) GOTO 100
       CALL AXPLOT(X,YLEN,3)
       CALL AXPLOT(X,0.,2)
       GO TO 20
100    JXY=0
       RETURN
       END
       SUBROUTINE GRINT(JGRID,XGREP,NGA,IGA)
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       DIMENSION IGA(1)
       N=1
       CALL VALUE(KX,N,XGREP,IERROR)
       IF (IERROR .GT. 0) CALL MESSAGE(44)
C... ERROR MESSAGE: "THE GRID COMMANDS REQUIRE AT LEAST AN INTERVAL"
30     DO 50 I=1,25
       CALL VALUE(KX,N,X,IERROR)
       IF (IERROR .GT. 0) GOTO 70
40     IGA(I)=X*1000.+1E-6
50     CONTINUE
C... ERROR MESSAGE: "TO MANY GRID LINES"
       CALL MESSAGE(44)
C... IF ONLY THE INTERVAL IS SPECIFIED, THEN MAKE ONE LINE PER INT.
70     IF (I .NE. 1) GOTO 90
80     NGA=1
       IGA(1)=XGREP*1000+1E-6
       GO TO 100
90     NGA=I-1
100    JGRID = 1
       RETURN
       END
EASYPLOT ** FICHE/FRAME BREAK *****
EZPSYM4 SYMSORT

SYM.  PG.LN. IDENT.

10      4 21 CEZP4   100    17 21 CEZP4   100    16 25 CEZP4   100    12 36 CEZP4   
100    11 27 CEZP4   100     9 18 CEZP4   100     6 18 CEZP4   100     1 27 CEZP4   
1000    3 21 CEZP4   11      7 23 CEZP4   110    12 37 CEZP4   110     6 24 CEZP4   
1100    3 25 CEZP4   115    12 39 CEZP4   115    11 28 CEZP4   120     7 32 CEZP4   
120     6 29 CEZP4   1200   14  5 CEZP4   1200    3 29 CEZP4   130    13  2 CEZP4   
130    11 30 CEZP4   1300   14  8 CEZP4   1301   14  9 CEZP4   140    11 33 CEZP4   
15      7 16 CEZP4   150    13  7 CEZP4   150    11 34 CEZP4   150     6 31 CEZP4   
150     1 31 CEZP4   16      7 19 CEZP4   160    13  9 CEZP4   160    11 36 CEZP4   
160     6 32 CEZP4   17      7 20 CEZP4   180    13 12 CEZP4   20     16  3 CEZP4   
20      9  8 CEZP4   20      4 25 CEZP4   200    13 15 CEZP4   200    11 38 CEZP4   
200     7 34 CEZP4   200     6 34 CEZP4   200     1 34 CEZP4   21      7 25 CEZP4   
210    13 16 CEZP4   22      7 17 CEZP4   220    13 17 CEZP4   220    12  1 CEZP4   
220     7 36 CEZP4   230    13 19 CEZP4   230     7 37 CEZP4   235     7 39 CEZP4   
240    12  2 CEZP4   240     8  3 CEZP4   25      4 26 CEZP4   250    13 22 CEZP4   
250    12  3 CEZP4   250     8  4 CEZP4   260    12  5 CEZP4   260     8  6 CEZP4   
270    13 25 CEZP4   280    13 26 CEZP4   290    13 27 CEZP4   30     17  8 CEZP4   
30     16  6 CEZP4   30     10  5 CEZP4   30      9 10 CEZP4   30      4 30 CEZP4   
300    13 32 CEZP4   300    12  7 CEZP4   300     1 39 CEZP4   301    14 11 CEZP4   
302    14 18 CEZP4   304    14 17 CEZP4   306    14 19 CEZP4   320    12  9 CEZP4   
330    14 23 CEZP4   340    12 10 CEZP4   345    14 25 CEZP4   350    14 26 CEZP4   
360     2  1 CEZP4   361     2  4 CEZP4   370    14 29 CEZP4   40     17 11 CEZP4   
40     16  8 CEZP4   40      9 11 CEZP4   40      5 25 CEZP4   40      4 33 CEZP4   
400    14 30 CEZP4   400     8  9 CEZP4   400     2  9 CEZP4   405    14 32 CEZP4   
410     8 10 CEZP4   412     2 15 CEZP4   413     2 17 CEZP4   420     8 15 CEZP4   
420     2 26 CEZP4   430    14 36 CEZP4   430     8 17 CEZP4   440     8 18 CEZP4   
445    14 38 CEZP4   450    14 39 CEZP4   470    15  3 CEZP4   50     17 12 CEZP4   
50     10  8 CEZP4   50      9 13 CEZP4   50      5 29 CEZP4   50      4 35 CEZP4   
500    15  4 CEZP4   500     8 22 CEZP4   500     2 30 CEZP4   505    15  6 CEZP4   
510    15  8 CEZP4   510     2 32 CEZP4   520     2 34 CEZP4   530    15 12 CEZP4   
535    15 14 CEZP4   60     16 18 CEZP4   60     10 10 CEZP4   60      9 14 CEZP4   
60      5 35 CEZP4   60      4 36 CEZP4   600     8 23 CEZP4   600     2 38 CEZP4   
601     3  3 CEZP4   602     3  5 CEZP4   61      5 38 CEZP4   630     7 21 CEZP4   
650     8 25 CEZP4   70     17 16 CEZP4   70     16 20 CEZP4   70     10 13 CEZP4   
70      9 16 CEZP4   700     3  9 CEZP4   80     17 17 CEZP4   80      9 17 CEZP4   
80      6  5 CEZP4   800     3 13 CEZP4   82      6  6 CEZP4   85      6  8 CEZP4   
86      6 12 CEZP4   90     17 20 CEZP4   90      6 17 CEZP4   900     3 17 CEZP4   
99      1 29 CEZP4   C      13 31 CEZP4   C      13  4 CEZP4   
C      12 33 CEZP4   C      12 32 CEZP4   C      12 31 CEZP4   C      12 30 CEZP4   
C      11 24 CEZP4   C      11 23 CEZP4   C      11 22 CEZP4   C      11 21 CEZP4   
C       4 32 CEZP4   C       4 31 CEZP4   C       4 28 CEZP4   C       4 23 CEZP4   
C       4 19 CEZP4   C       4 15 CEZP4   C       4 10 CEZP4   C       4  9 CEZP4   
C       4  8 CEZP4   C       3 28 CEZP4   C       3 24 CEZP4   C       3 20 CEZP4   
C       3 16 CEZP4   C       3 12 CEZP4   C       3  8 CEZP4   C       3  4 CEZP4   
C       3  2 CEZP4   C       2 37 CEZP4   C       2 29 CEZP4   C       2  8 CEZP4   
C       2  7 CEZP4   C       1 38 CEZP4   C       1 37 CEZP4   C       1 33 CEZP4   
C       1 30 CEZP4   C       1 26 CEZP4   C       1  2 CEZP4   C...   17 15 CEZP4   
C...   17 13 CEZP4   C...   17  7 CEZP4   C...   16 34 CEZP4   C...   16 29 CEZP4   
C...   16 15 CEZP4   C...   16 14 CEZP4   C...   16 13 CEZP4   C...   16  9 CEZP4   
C...   16  4 CEZP4   C...   15 38 CEZP4   C...   15 37 CEZP4   C...   15 36 CEZP4   
C...   15 35 CEZP4   C...   15 34 CEZP4   C...   15 33 CEZP4   C...   15 24 CEZP4   
C...   15 19 CEZP4   C...   12 21 CEZP4   C...   12 16 CEZP4   C...   11 12 CEZP4   
C...   11  7 CEZP4   C...   10 34 CEZP4   C...   10 26 CEZP4   C...   10 21 CEZP4   
C...    9 35 CEZP4   C...    9 27 CEZP4   C...    9 22 CEZP4   C...    9  2 CEZP4   
C...    8 33 CEZP4   C...    8 28 CEZP4   C...    8 21 CEZP4   C...    8  8 CEZP4   
C...    7 33 CEZP4   C...    7 18 CEZP4   C...    7 13 CEZP4   C...    7  5 CEZP4   
C...    6 39 CEZP4   C...    6 33 CEZP4   C...    6 28 CEZP4   C...    6 25 CEZP4   
C...    6 21 CEZP4   C...    6 20 CEZP4   C...    6 19 CEZP4   C...    6 14 CEZP4   
C...    6 11 CEZP4   C...    6  9 CEZP4   C...    6  4 CEZP4   C...    6  3 CEZP4   
C...    6  2 CEZP4   C...    6  1 CEZP4   C...    5 34 CEZP4   C...    5 32 CEZP4   
C...    5 28 CEZP4   C...    5 27 CEZP4   C...    5 24 CEZP4   C...    5 22 CEZP4   
C...    5 20 CEZP4   C...    5 19 CEZP4   C...    5 18 CEZP4   C...    5 17 CEZP4   
C...    5  9 CEZP4   C...    5  4 CEZP4   C...    3 38 CEZP4   C...    3 33 CEZP4   
C...    2 13 CEZP4   C...    2 10 CEZP4   C...    1 28 CEZP4   C...    1 23 CEZP4   
C...    1 22 CEZP4   C...    1 14 CEZP4   C...    1  9 CEZP4   C...    1  4 CEZP4   
L      16 28 CEZP4   L      15 18 CEZP4   L      12 15 CEZP4   L      11  6 CEZP4   
L      10 20 CEZP4   L       9 21 CEZP4   L       8 27 CEZP4   L       6 37 CEZP4   
L       5  3 CEZP4   L       3 32 CEZP4   
EASYPLOT ** FICHE/FRAME BREAK *****
EZPSYM5
CEZP5     EASYPLOT PART 5 OF 8
C         13 JULY 1972    THAD FLORYAN

       SUBROUTINE FPROC(KF,NF,JSCI,KL,NL,NWH,NDEC,NFR,NPT,KT,NT,IERROR)
       DIMENSION KF(1),KL(1),KT(1)
       IERROR=0
       IF (NF .GT. 20) CALL MESSAGE(3)
C... ERROR MESSAGE: "ONLY 20 CHARS ALLOWED IN FORMAT"
100    NDEC=NWH=NFR=NL=NT=N1=NPT=0
C... CALC NPT AND REMOVE ALL !'S
       DO 150 I=1,NF
       IF (KF(I) .EQ. 1H!) GOTO 130
120    N1=N1+1
       KF(N1)=KF(I)
       GO TO 150
130    NPT=I-2
150    CONTINUE
       NF=N1
C... CALC BEGINNING OF %'S OR #'S
       DO 240 I=1,NF
       IF (KF(I) .NE. 1H#) GOTO 220
210    KFSYM=1H#
       JSCI=1
       NF=NF-5
       GO TO 250
220    IF (KF(I) .NE. 1H%) GOTO 240
230    KFSYM=1H%
       JSCI=0
       GO TO 250
240    CONTINUE
C... ERROR MESSAGE: "NO FIELD SPECIFICATION"
       CALL MESSAGE(5)
250    NBEG=I
C... CALC END OF %'S OR #'S
       DO 310 I=NF,NBEG,-1
       IF (KF(I) .EQ. KFSYM) GOTO 320
310    CONTINUE
C... IMPOSSIBLE TO FINISH LOOP
320    NEND=I
C... CALC LOCATION OF "."
       DO 350 I=1,NF
       IF (KF(I) .EQ. 1H.) GOTO 360
350    CONTINUE
C... NO "." FOUND:
       NDEC=NDEC1=0
       GO TO 400
C... "." FOUND:
360    IF (I-NBEG+1) 380,365,370
C... ERROR MESSAGE: "NEEDS A "%" BEFORE THE "." FOR THE SIGN"
365    CALL MESSAGE(8)
370    IF (I-NEND-1 .LE. 0) GOTO 390
C... ERROR MESSAGE: "DEC. PT. IS IN WRONG PLACE"
380    CALL MESSAGE(7)
390    NDEC1=I
       NDEC=1
C... ND1=1 IF DEC OS IN FIELD
C... ND2=1 IF DEC IS OUT OF FIELD (IE LAST CHAR OF FIELD)
400    ND1=NDEC
       ND2=0
       IF (NDEC1 .LT. NEND) GOTO 420
410    ND1=0
       ND2=1
420    NFR=(NEND-NDEC1)*ND1
       NWH=NEND-NBEG-ND1+1-NFR
       NL=NBEG-1
       NT=NF-NEND-ND2
C... PULL LEADING TEXT:
       IF (NL .LE. 0) GOTO 530
510    DO 520 I=1,NL
       KL(I)=KF(I)
520    CONTINUE
C... PULL TRAILING TEXT:
530    IF (NT .LE. 0) RETURN
540    DO 550 I=1,NT
       KT(I)=KF(NF-NT+I)
550    CONTINUE
560    RETURN
       END
       SUBROUTINE FSUBSTR(KIN,NPT1,NPT2,NPT3,NLIM,KOUT)
C... FSUBSTR - SUBSTRING ISOLATION SUBROUTINE
C...
C...
C... SELECTS SUBSTRING INDICATED BY CHAR. POSITION POINTERS AND
C... PLACES IT IN OUTPUT STRING. POSITION IN NEW STRING CAN BE
C... CHOSEN. ALSO CHECKS TO SEE IF SUBSTRING IS WITHIN SPECIFIED
C... LIMIT.
C...
C... INPUT PARAMETER LIST:
C...
C...   KIN=INPUT 1 CHAR./WORD LEFT JUSTIFIED ARRAY
C...   NPT1=FIRST POSITION POINTER IN INPUT ARRAY
C...   NPT2=SECOND POSITION POINTER IN INPUT ARRAY
C...   NPT3=POSITION POINTER IN OUTPUT STRING ARRAY
C...   NLIM=SUBSTRING SIZE LIMIT - ARRAY PROTECTION
C...
C... OUTPUT PARAMETER LIST:
C...
C...   KOUT=OUTPUT CHAR./WORD LEFT JUSTIFIED STRING ARRAY
C...
C...
C...
       DIMENSION KIN(1),KOUT(1)
       IERROR=0
       NCH=NPT2-NPT1+1
       IF (NCH .GT. NLIM) (IERROR = 1; RETURN)
90     DO 100 I=1,NCH
       KOUT(I+NPT3-1)=KIN(I+NPT1-1)
100    CONTINUE
       RETURN
       END
EASYPLOT ** FICHE/FRAME BREAK *****
EZPSYM5 SYMSORT

SYM.  PG.LN. IDENT.

100     3 21 CEZP5   100     1  9 CEZP5   120     1 13 CEZP5   130     1 16 CEZP5   
150     1 17 CEZP5   210     1 22 CEZP5   220     1 26 CEZP5   230     1 27 CEZP5   
240     1 30 CEZP5   250     1 33 CEZP5   310     1 37 CEZP5   320     1 39 CEZP5   
350     2  4 CEZP5   360     2  9 CEZP5   365     2 11 CEZP5   370     2 12 CEZP5   
380     2 14 CEZP5   390     2 15 CEZP5   400     2 19 CEZP5   410     2 22 CEZP5   
420     2 24 CEZP5   510     2 30 CEZP5   520     2 32 CEZP5   530     2 34 CEZP5   
540     2 35 CEZP5   550     2 37 CEZP5   560     2 38 CEZP5   90      3 19 CEZP5   
C       1  2 CEZP5   C...    3 12 CEZP5   C...    3 11 CEZP5   
C...    3 10 CEZP5   C...    3  9 CEZP5   C...    3  6 CEZP5   C...    3  5 CEZP5   
C...    3  4 CEZP5   C...    3  2 CEZP5   C...    2 33 CEZP5   C...    2 28 CEZP5   
C...    2 18 CEZP5   C...    2 17 CEZP5   C...    2 13 CEZP5   C...    2 10 CEZP5   
C...    2  8 CEZP5   C...    2  5 CEZP5   C...    2  1 CEZP5   C...    1 38 CEZP5   
C...    1 34 CEZP5   C...    1 31 CEZP5   C...    1 19 CEZP5   C...    1 10 CEZP5   
C...    1  8 CEZP5   O...MC  3 15 CEZP5   O...MC  3 14 CEZP5   O...MC  3 13 CEZP5   
O...MC  3  8 CEZP5   O...MC  3  7 CEZP5   O...MC  3  3 CEZP5   
EASYPLOT ** FICHE/FRAME BREAK *****
EZPSYM6
CEZP6     EASYPLOT PART 6 OF 8
C         16 JULY 1972    THAD FLORYAN

       SUBROUTINE PAIR(NPT,D1,D2,IERROR)
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IJKERR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       CALL VALUE(KX,NPT,D1,IERROR)
       IF (IERROR .LE. 0) GOTO 20
10     IERROR=1
       GO TO 50
20     CALL VALUE(KX,NPT,D2,IERROR)
       IF (IERROR .LE. 0) GOTO 50
30     D2=0
       IERROR=-1
50     IJKERR = IERROR
       RETURN
       END
       SUBROUTINE RDLINE(ISYM,KX,NCH,IERROR,IUNIT)
C... CONTROL A,Q, AND I MAY BE USED DURING INPUT.
C... CONTROL Q ABORTS INPUT LINE BUT DOES NOT LEAVE SUBROUTINE - IT
C... CAUSES ANOTHER "GLITCH" AND ACCEPTS A NEW LINE.
C...
C... INPUT PARAMETER LIST:
C...
C...   ISYM=SYMBOL OF GLITCH. IF NEGATIVE, NO GLITCH
C...
C... OUTPUT PARAMETER LIST:
C...
C...   KX=OUTPUT CHAR/WORD LEFT JUSTIFIED INTEGER ARRAY WITH A "!"
C...      TRAILING THE INPUT STRING.
C...
       DIMENSION KX(1)
       DATA IBPA/1H_/
       DATA IUPA/1H^/
       DATA ICTLG/6750208/
       IERROR=0
10     IF (IUNIT .LT. 0) GO TO 11
       IF (ISYM .GT. 0) TYPE 71,ISYM
11     DO 100 I=1,73
25     CALL CR(NM,IUNIT)
       IF (NM .EQ. -1) GOTO 50
30     IF (NM .EQ. 6881280) GOTO 60
35     IF (NM .EQ. 6356992) GOTO 70
40     IF (NM .EQ. 7405568) GOTO 80
45     IF (I .LE. 72) (KX(I)=NM; GOTO 100)
46     IERROR=IERROR+1
       I=I-1
       GO TO 100
50     DO 55 J=I,72
55     KX(J)=0
       KX(I)=1H!
       GO TO 150
60     IF (I .GT. 3) GOTO 75
       DO 65 J=I,3
       CALL OSPACE
65     KX(J)=0
       I=J
       GO TO 25
70     IF (I .GT. 1) GOTO 77
75     TYPE 71,ICTLG
       GO TO 25
77     I=I-1
       TYPE 71,IBPA
71     FORMAT(A1,Z)
       GO TO 25
80     TYPE 81,IUPA
81     FORMAT(A1)
       GO TO 10
100    CONTINUE
150    NCH=I-1
       RETURN
       END
       SUBROUTINE VALUE1(X)
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       NPT=1
       CALL VALUE(KX,NPT,X,IERROR)
       IF (IERROR .LE. 0) RETURN
70     CALL MESSAGE(10)
80     RETURN
       END
       SUBROUTINE VALUE(KX,NPT,DECTOT,IERROR)
       DIMENSION KX(1)
       IERROR=0
       DIV=1.
       DECWHO=DECFRA=0.
       IF (NPT .GT. 0) GOTO 5
4      N=0
       GO TO 6
5      N=NPT-1
6      SIGN=1.
10     IF (N .LT. 72) GOTO 12
11     IERROR=1
       RETURN
12     N=N+1
       IF (KX(N)-1H0) 17,22,15
15     IF (KX(N) .LE. 1H9) GOTO 22
17     IF (KX(N) .EQ. 1H.) GOTO 60
18     IF (KX(N) .NE. 1H-) GOTO 10
19     SIGN=-1
20     N=N+1
22     IF (KX(N)-1H0) 30,40,25
25     IF (KX(N) .LE. 1H9) GOTO 40
30     IF (KX(N) .EQ. 1H.) GOTO 60 .ELSE. GOTO 150
40     DEC=KX(N)/65536-16
       DECWHO=DECWHO*10.+DEC
       GO TO 20
60     N=N+1
       IF (KX(N)-1H0) 150,80,65
65     IF (KX(N) .GT. 1H9) GOTO 150
80     DEC=KX(N)/65536-16
       DIV=DIV*10.
       DECFRA=DECFRA+DEC/DIV
       GO TO 60
150    DECTOT=SIGN*(DECWHO+DECFRA)
       IF (NPT .LE. 0) RETURN
160    NPT=N+1
170    RETURN
       END
       SUBROUTINE PACK(KARRAY,NARRAY)
C... STRING PACKING SUBROUTINE
C...
C...
C... PACKS CHARACTERS STORED IN AN INTEGER ARRAY, ONE CHARACTER
C... LEFT JUSTIFIED PER WORD, INTO A FLOATING PT. ARRAY.
C...
C... STRING SIZE: 72 CHARACTERS MAXIMUM.
C...
C... PARAMETER LIST:
C...   KIN=INPUT (CHARACTER PER WORD) INTEGER ARRAY
C...   NCH=NO. OF CHARACTERS IN INPUT ARRAY - INPUT VARIABLE
C...   NDIM=DIMENSION NO. OF BCD IN CALLING PROGRAM
C...   BCD=12 ELEMENT OUTPUT FLOATING PT. PACKED ARRAY - THE
C...       REST OF THE ARRAY IS FILLED WITH BLANKS
C...
C...
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       DIMENSION KARRAY(1)
       DO 50 I=1,NARRAY
50     KSCR(I)=KARRAY(I)
       NCHSCR=NARRAY
       CALL FLPACK
       RETURN
       END
       SUBROUTINE FLPACK
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       DIMENSION IBCD(24)
       EQUIVALENCE (BCD(1),IBCD(1))
       DO 50 M=1,24
50     IBCD(M)=0
       DO 70 M=NCHSCR+1,80
70     KSCR(M)=0
       DO 100 M=1,24
       N=3*M-2
       IBCD(M)=KSCR(N)+KSCR(N+1)/256+KSCR(N+2)/65536
       IF (3*M-NCHSCR .GT. 0) RETURN
100    CONTINUE
110    RETURN
       END
       SUBROUTINE UNPACK
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       DIMENSION IBCD(24)
       EQUIVALENCE (BCD(1),IBCD(1))
       N=NCHSCR/3+1
       DO 100 I=1,N
       M=3*I-2
       K=IBCD(I)
       K1=K/256
       K2=K1/256
       KSCR(M)=K2*65536
       KSCR(M+1)=(K1-K2*256)*65536
       KSCR(M+2)=(K-K1*256)*65536
100    CONTINUE
       DO 150 I=NCHSCR+1,80
150    KSCR(I)=0
       RETURN
       END
       SUBROUTINE STRING
C... STRING - SUBROUTINE THAT SEPARATES TEXT IN KX SURROUNDED
C... BY QUOTES AND RETURNS IT IN KSCR. THE NO. OF CHARACTERS
C... IS RETURNED IN NCHSCR. THESE VARIABLES ARE IN COMMON
C... APPROPRIATE DIAGNOSTICS ARE TYPED BY THIS SUBROUTINE.
C... IN CASE OF ERROR, NO VALUES IN KSCR OF NCHSCR ARE CHANGED.
C...
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       DATA KHDQ/1H"/
       DATA KHSQ/1H'/
       IERROR=0
       DO 150 J1=1,NCHKX
       IF (KX(J1) .EQ. KHSQ) GOTO 300
110    IF (KX(J1) .EQ. KHDQ) GOTO 310
150    CONTINUE
       CALL MESSAGE(1)
300    KHQ=KHSQ
       GO TO 320
310    KHQ=KHDQ
320    DO 350 J2=J1+1,72
       IF (KX(J2) .EQ. KHQ) GOTO 400
350    CONTINUE
       CALL MESSAGE(2)
       DO 380 J2=J1+1,72
       IF (KX(J2) .EQ. 1H!) GOTO 400
380    CONTINUE
400    DO 410 I=1,J2-J1-1
410    KSCR(I)=KX(I+J1)
       NCHSCR=J2-J1-1
       RETURN
       END
       FUNCTION LANG(KARRAY,NCOMS)
C... LANGUAGE FUNCTION
C...
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
C... KARRAY CONTAINS LIST OF 3 CHAR. COMMANDS
C... NCOMS = NO. OF ELEMENTS IN KARRAY
C... WILL RETURN 1 FOR NO MATCH
C... WILL RETURN POSITION IN LIST +1 FOR MATCH
       DIMENSION KARRAY(1)
       DO 100 I=1,NCOMS
       IF (KB .EQ. KARRAY(I)) GOTO 200
100    CONTINUE
       LANG=1
       RETURN
200    LANG=I+1
       RETURN
       END
       FUNCTION IJDSR(I)
C... ZETA COMMON:
       COMMON IGOZ,IOLDXZ,IOLDYZ,IOLDDZ,LZ,IBINZ,IBOUTZ,ICHARZ,
     1 IPENUPZ,LETTERZ,MODEZ,ICOMZ,IOZ,INTGZ,IERRZ,LIMZ,NDEVZ,
     2 IDIVZ,FACTZ,XOFFZ,XFACTZ,YOFFZ,YFACTZ,NUMTABZ
       DIMENSION LETTERZ(270),NUMTABZ(10)
C... MAIN COMMON:
       COMMON KX,KSCR,BCD
       DIMENSION KX(80),KSCR(80),BCD(12)
       COMMON NCHKX,KP,KB,KEOF,NCHSCR,IERROR,JUMP1,IPTR1,
     1 IPTR2,JMESS,MESSNO,KFRDP,JDSR,ICOM1,ICOM2,ICOM3,XCOM1,
     2 NUM,XSTATMP,XINCTMP,YSTATMP,YINCTMP,SCXTMP,SCYTMP,
     3 JXLGLN,JYLGLN,LSKIP,SYHT,JONOFF,SIZEINC,XPENLOC,YPENLOC,
     4 ROTANG,ROTSIN,ROTCOS,JXY
       IF (JDSR) 20,30,40
20     IF (I .GT. 0) GOTO 23
21     IJDSR=I
       GO TO 50
23     IJDSR=-I
       GO TO 50
30     IJDSR=0
       GO TO 50
40     IJDSR=IABS(I)
50     RETURN
       END
      SUBROUTINE ALPHA(IBSIZE,LETDIR,LSIZE,MESBUF)
       DIMENSION LETTER(270),MESBUF(80)
       COMMON IGO,IOLDX,IOLDY,IOLDD,L,IBIN,IBOUT,ICHAR,IPENUP,
LETTER,MODE,ICOM
      CALL OUT8
      CALL OUT7
      LSI = LSIZE/2*2
      IF(LSIZE .EQ. LSI) GOTO 22
21    CALL OUT7
      LETTER(186) = 600197
      LSI = LSIZE
      GO TO 23
22    CALL OUT6
      LETTER(186) = 600196
      LSI = LSIZE/2
23    LETDIR = LETDIR/2*2
      IF(IPENUP .LT. 0) CALL OUT9
2     IPENUP = LCT = LYCT = NO = 0
      LCASE = -1
      DO 90 J=1,IBSIZE
      IF(MESBUF(J) .NE. 0) NO=J
90    CONTINUE
      IF(NO .EQ. 0) GOTO 101
92    DO 100 I = 1,NO
      ICH = MESBUF(I)
91    IF(ICH .NE. 1H@) GOTO 4
3     LCASE = -1 - LCASE
      GO TO 100
4     IF(ICH .NE. 1H^) GOTO 6
5     IQ = 2
      LI = 1
      LYCT = LYCT + 5
      GO TO 51
6     IF(ICH .NE. 1H_) GOTO 8
7     IQ = 6
      LI = 1
      LYCT = LYCT - 5
      GO TO 51
8     IF(ICH .NE. 1H=) GOTO 14
9     ICH = 1
      GO TO 50
14    ICH = ICH/65536-3
      IF(ICH .LE. 0) GOTO 30
15    IF(ICH-23)35,30,16
16    ICH = ICH - 29
      IF(ICH .LE. 0) GOTO 30
17    IF(ICH .LE. 26) GOTO 18
10    IF(ICH .NE. 29) GOTO 12
11    ICH = 50
      GO TO 50
12    IF(ICH .NE. 27) GOTO 30
13    ICH = 51
      GO TO 50
18    ICH = ICH +23
      GO TO 40
35    ICH = ICH + 1
40    IF(ICH-14)50,48,41
41    IF(ICH .GE. 50) GOTO 50
48    IF(LCASE .LT. 0) GOTO 50
49    ICH = ICH + 38
      GO TO 50
30    ICH = 5
50    IQ = LETTER(ICH)
      M = IQ/1000000
      LI=LETTER(ICH+87)/1000000*10+LETTER(ICH+174)/100000
      LCT = LCT+M
51    N=M=0
      DO 99 J=1,LI
      IF(IQ .EQ. 0) GOTO 62
60    ID=IQ/10
      ICOM =IQ-ID*10
      IQ=ID
      IF(ICH .EQ. 12) GOTO 76
61    IF(ICOM .LT. 8) GOTO 63 .ELSE. GOTO 80
62    ICOM = 0
63    ICOM=ICOM+LETDIR
      IF(ICOM .LT. 8) GOTO 70
64    ICOM=ICOM-8
70    DO 75 K=1,LSI
       CALL OUT(ICOM)
75    CONTINUE
      GO TO 81
76    IF(J .EQ. 1) GOTO 63
77    IF(J-LI+1 .GE. 0) GOTO 63
80    CALL OUT(ICOM)
81    M = M+1
      IF(M .LT. 6) GOTO 99
82    M=0
      N=N+87
      IQ=LETTER(ICH+N)
99    CONTINUE
100   CONTINUE
101   IF(LSIZE .LE. 0) LSIZE = 1
108   LCT=LCT*5*LSIZE
      LYCT=LYCT*LSIZE
      I=LETDIR/2+1
      CALL OUT9
      L=LEN=1
      IOLDD=0
      GO TO(102,103,104,105),I
102   IOLDX=IOLDX+LCT
      IOLDY=IOLDY+LYCT
      RETURN
103   IOLDY=IOLDY+LCT
      IOLDX=IOLDX-LYCT
      RETURN
104   IOLDX=IOLDX-LCT
      IOLDY=IOLDY-LYCT
      RETURN
105   IOLDY=IOLDY-LCT
      IOLDX=IOLDX+LYCT
      RETURN
      END
      SUBROUTINE PEN(I)
      COMMON IGO,IOLDX,IOLDY,IOLDD,L,IBIN,IBOUT,ICHAR,IPENUP
      IF(I .EQ. IPENUP) RETURN
40     CALL WRAPUP
      IF(L .NE. 1) GOTO 60
50     CALL OUT8
      L=2
60    CALL OUT7
      I1=8
      IF(I)150,130,70
70    I1=1
      IF(IPENUP .EQ. 0) GOTO 90
80    CALL OUT9
      CALL OUT7
90    IF(I-2)130,150,200
130   I1=I1+1
150   CALL OUT(I1)
200   IPENUP=I
300   RETURN
      END
      SUBROUTINE OUT(I)
       TYPE 252,I
      RETURN
252    FORMAT(I1,Z)
      END









      SUBROUTINE BPLOT
      COMMON IGO,IOLDX,IOLDY,IOLDD,L,IBIN,IBOUT,ICHAR,IPENUP
      IPENUP=IOLDD=IBIN=IBOUT=0
      L = 1
       CALL OUTPON
       RETURN
      END









      SUBROUTINE EPLOT
      CALL WRAPUP
       CALL OUTOFF
       RETURN
       END
      SUBROUTINE WRAPUP
       COMMON IGO,IOLDX,IOLDY,IOLDD,L,IBIN,IBOUT,ICHAR,
     1 IPENUP,LETTER,MODE,ICOM,IO,INTG,IERR,LIM,NDEV,
     2 IDIV,FACT,XOFF,XFACT,YOFF,YFACT,NUMTAB
       DIMENSION LETTER(270),NUMTAB(10)
      IGOSAV=IGO
      IGO=1
      CALL POINT(0.,0.,IGO,IOLDX,IOLDY,IOLDD,L,IBIN,IBOUT,IO,
     1 INTG,IERR,LIM)
      IGO=IGOSAV
      RETURN
      END

       SUBROUTINE CLINE
       COMMON IGO,IOLDX,IOLDY,IOLDD,L,IBIN,IBOUT,ICHAR,
     1 IPENUP,LETTER,MODE,ICOM,IO,INTG,IERR,LIM,NDEV,
     2 IDIV,FACT,XOFF,XFACT,YOFF,YFACT,NUMTAB
       DIMENSION LETTER(270),NUMTAB(10)
      IGO=0
      INTG=-1
      RETURN
      END


      SUBROUTINE SLINE
       COMMON IGO,IOLDX,IOLDY,IOLDD,L,IBIN,IBOUT,ICHAR,
     1 IPENUP,LETTER,MODE,ICOM,IO,INTG,IERR,LIM,NDEV,
     2 IDIV,FACT,XOFF,XFACT,YOFF,YFACT,NUMTAB
       DIMENSION LETTER(270),NUMTAB(10)
      IGO=-1
      INTG=0
      RETURN
      END
EASYPLOT ** FICHE/FRAME BREAK *****
EZPSYM6 SYMSORT

SYM.  PG.LN. IDENT.

10     10 15 CEZP6   10      3 31 CEZP6   10      2  4 CEZP6   10      1 20 CEZP6   
100    11 20 CEZP6   100     8 16 CEZP6   100     6 25 CEZP6   100     5 36 CEZP6   
100     2 36 CEZP6   101    11 21 CEZP6   102    11 29 CEZP6   103    11 32 CEZP6   
104    11 35 CEZP6   105    11 38 CEZP6   108    11 22 CEZP6   11     10 16 CEZP6   
11      3 32 CEZP6   11      2  6 CEZP6   110     7 15 CEZP6   110     5 37 CEZP6   
12     10 18 CEZP6   12      3 34 CEZP6   13     10 19 CEZP6   130    12 18 CEZP6   
14     10  9 CEZP6   15     10 11 CEZP6   15      3 36 CEZP6   150    12 19 CEZP6   
150     7 16 CEZP6   150     6 27 CEZP6   150     4 15 CEZP6   150     2 37 CEZP6   
16     10 12 CEZP6   160     4 17 CEZP6   17     10 14 CEZP6   17      3 37 CEZP6   
170     4 18 CEZP6   18     10 21 CEZP6   18      3 38 CEZP6   19      3 39 CEZP6   
2       9 24 CEZP6   20      8 37 CEZP6   20      4  1 CEZP6   20      1 22 CEZP6   
200    12 20 CEZP6   200     8 19 CEZP6   21      9 15 CEZP6   21      8 38 CEZP6   
22      9 19 CEZP6   22      4  2 CEZP6   23      9 22 CEZP6   23      9  1 CEZP6   
25      4  3 CEZP6   25      2  7 CEZP6   252    12 26 CEZP6   3       9 33 CEZP6   
30     10 29 CEZP6   30      9  3 CEZP6   30      4  4 CEZP6   30      2  9 CEZP6   
30      1 24 CEZP6   300    12 21 CEZP6   300     7 18 CEZP6   310     7 20 CEZP6   
320     7 21 CEZP6   35     10 23 CEZP6   35      2 10 CEZP6   350     7 23 CEZP6   
380     7 27 CEZP6   4       9 35 CEZP6   4       3 27 CEZP6   40     12  6 CEZP6   
40     10 24 CEZP6   40      9  5 CEZP6   40      4  5 CEZP6   40      2 11 CEZP6   
400     7 28 CEZP6   41     10 25 CEZP6   410     7 29 CEZP6   45      2 12 CEZP6   
46      2 13 CEZP6   48     10 26 CEZP6   49     10 27 CEZP6   5       9 36 CEZP6   
5       3 29 CEZP6   50     12  8 CEZP6   50     10 30 CEZP6   50      9  6 CEZP6   
50      5 29 CEZP6   50      5  7 CEZP6   50      2 16 CEZP6   50      1 26 CEZP6   
51     10 34 CEZP6   55      2 17 CEZP6   6      10  1 CEZP6   6       3 30 CEZP6   
60     12 10 CEZP6   60     10 37 CEZP6   60      4  8 CEZP6   60      2 20 CEZP6   
61     11  2 CEZP6   62     11  3 CEZP6   63     11  4 CEZP6   64     11  6 CEZP6   
65      4 10 CEZP6   65      2 23 CEZP6   7      10  2 CEZP6   70     12 13 CEZP6   
70     11  7 CEZP6   70      5 31 CEZP6   70      3 18 CEZP6   70      2 26 CEZP6   
71      2 31 CEZP6   75     11  9 CEZP6   75      2 27 CEZP6   76     11 11 CEZP6   
77     11 12 CEZP6   77      2 29 CEZP6   8      10  6 CEZP6   80     12 15 CEZP6   
80     11 13 CEZP6   80      4 11 CEZP6   80      3 19 CEZP6   80      2 33 CEZP6   
81     11 14 CEZP6   81      2 34 CEZP6   82     11 16 CEZP6   9      10  7 CEZP6   
90     12 17 CEZP6   90      9 28 CEZP6   91      9 32 CEZP6   92      9 30 CEZP6   
99     11 19 CEZP6   C       1  2 CEZP6   C...    8 28 CEZP6   
C...    8 23 CEZP6   C...    8 12 CEZP6   C...    8 11 CEZP6   C...    8 10 CEZP6   
C...    8  9 CEZP6   C...    8  1 CEZP6   C...    7 34 CEZP6   C...    7  2 CEZP6   
C...    6 35 CEZP6   C...    6 34 CEZP6   C...    6 33 CEZP6   C...    6 32 CEZP6   
C...    6 31 CEZP6   C...    6  6 CEZP6   C...    6  1 CEZP6   C...    5 18 CEZP6   
C...    5 13 CEZP6   C...    4 36 CEZP6   C...    4 30 CEZP6   C...    4 29 CEZP6   
C...    4 28 CEZP6   C...    4 27 CEZP6   C...    4 26 CEZP6   C...    4 23 CEZP6   
C...    4 21 CEZP6   C...    3  7 CEZP6   C...    3  2 CEZP6   C...    1 37 CEZP6   
C...    1 32 CEZP6   C...    1 31 CEZP6   C...    1 30 CEZP6   C...    1 10 CEZP6   
C...    1  5 CEZP6   C...M   1 38 CEZP6   L      13 19 CEZP6   L      12 23 CEZP6   
L      12  3 CEZP6   L       9  8 CEZP6   L       8 22 CEZP6   L       7 33 CEZP6   
L       6 30 CEZP6   L       5 39 CEZP6   L       5 12 CEZP6   L       4 20 CEZP6   
L       3 21 CEZP6   L       3  1 CEZP6   L       1 29 CEZP6   O...MC  7 35 CEZP6   
O...MC  6 36 CEZP6   O...MC  4 31 CEZP6   O...MC  4 25 CEZP6   O...MC  4 24 CEZP6   
O...MC  4 22 CEZP6   O...MC  1 36 CEZP6   O...MC  1 35 CEZP6   O...MC  1 34 CEZP6   
O...MC  1 33 CEZP6   OETTER  9 11 CEZP6   
EASYPLOT ** FICHE/FRAME BREAK *****
EZPSYM7
EZP7   IDENT   EASYPLOT PART 7 OF 8

       REM     UPD  25 OCTOBER 1972    THAD FLORYAN

       BEGPR

*  CALL CHKCOM(IF,ICFLG)
*      SETS ICFLG = -1
*           IF    = (0 TEL, -1 FILE) FOR COMINF
$CHKCOM HEADER SETP2,(WHO,INTG,0),(WHOZ,INTG,0)
       LDB     =-1
       STB*    WHOZ
       LDA     7CIF
       SKG     =0
       CLB
       STB*    WHO
       RETURN  CHKCOM

*  GETS CHAR FROM FILE
*      CALL CR(ICHAR,IUNIT)    IUNIT = (0 TEL, -1 FILE) FOR COMINF
$CR    HEADER  SETP2,(CHAR,INTG,0),(UNIT,INTG,0)
CRIN   SKN*    UNIT
       BRU     CRTEL
CRSPC  COPY    A
       SKR     MSCNT
       BRU     CRRET
CFIN   CIO     7CIF    EOF WILL TRIGGER INTERRUPT IN MAIN PROGRAM
       SKE     =135B
       BRU     CRTEL1
       CIO     7CIF
       STA     MSCNT
       BRU     CRSPC
CRTEL  CIO     =0
CRTEL1 SKE     =155B
       BRU     *+3
       LDA     =-1
       BRU     CRRET
       SKE     =152B
       BRU     *+2
       BRU     CRIN
       CLB
       LSH     16
CRRET  STA*    CHAR
       RETURN  CR
MSCNT  ZRO

*  CLOSES AND SETS COMMAND FILE TO TEL
$CLZCOM HEADER SETP2,(XXYY,INTG,0),(YYXX,INTG,0)
       CLA
       STA     7CIF
       STA*    XXYY
       STA*    YYXX
       BRS     151
       RETURN  CLZCOM

*  CALL CHKSYM(IGOOD)
*      IF LAST FILE OPENED IS SYMBOLIC, GOES TO IGOOD, ELSE RETURNS
$CHKSYM HEADER SETP1,(GOOD,INTG,0)
       LDA     6FTYPE          CONTAINS TYPE OF LAST FILE OPENED (1-4)
       SKE     =3
       RETURN  CHKSYM    NOT SYMBOLIC
       BRU*    GOOD


$OSPACE HEADER SETP0
       TCO     =0
       RETURN  OSPACE
*  THE FOLLOWING ROUTINE IS USED TO DETERMINE THE ACTUAL CHAR
*  SIZE OF AN AXIS LABEL SO AS TO BE ABLE TO CENTER IT PROPERLY.
*  IT IGNORES THE SPECIAL CONTROL CHARACTERS WHEN TALLYING UP
*  THE STRING LENGTH.
*
*  CALL:
*
*      CALL CKLEN ( REAL ARRAY , TOTAL LENGTH(INTEGER) , ACTUAL LENGTH)
*
*      REAL ARRAY = ARRAY CONTAINING THE STRING
*      TOTAL LENGTH IS STRING LENGTH INCLUDING CONTROLS
*      ACTUAL LENGTH (INTEGER) IS RETURNED AS A NUMBER OF CHARACTERS
*          EXCLUDING THE CONTROLS
$CKLEN HEADER  SETPN,3,(ALOC,REAL,0),(TTLSIZE,INTG,0),(ACTSIZE,INTG,0)
       LDA     ALOC
       ETR     =37777B
       MUL     =3
       LSH     23
       SUB     =1
       STA     PTR
       ADD*    TTLSIZE
       STA     PTR1
       CLA
       STA*    ACTSIZE
LOOP   GCI     PTR
       RETURN  CKLEN
       SKE     ="  ^"    UP-ARROW    ... SUPERSCRIPT
       BRU     *+2
       BRU     LOOP
       SKE     ="  _"    BACK-ARROW  ... SUBSCRIPT
       BRU     *+2
       BRU     LOOP
       SKE     ="  @"    AT-SIGN     ... CASE CHANGE
       MIN*    ACTSIZE
       BRU     LOOP
PTR    BSS     1
PTR1   BSS     1
*  PRINTS THE ERROR MESSAGE REQUESTED BY SUBROUTINE MESSAGE
*  CALL:
*
*      CALL MESPRT(NUMBER)

$MESPRT HEADER SETP1,(MSG,INTG,0)
       LDA*    MSG
       SKA     =4B7
       CNA
       CAX
       LDA     MTAB,2
       LDB     =-1
       LDX     =1
       BRS     34
       RETURN  MESPRT
MTAB   EQU     *-1
       DATA    M1,M2,M3,M4,M5,M6,M7,QM,QM,M10
       DATA    M11,M12,M13,M14,M15,M16,M17,QM,M19,M20
       DATA    M21,M22,M23,M24,QM,M26,QM,QM,QM,M30
       DATA    M31,QM,M33,M34,M35,M36,M37,M38,M39,M40
       DATA    M41,M42,QM,M44,M45,QM,QM,QM,M49,M50
       DATA    M51,M52,M53,M54,M55,M56,M57,M58

QM     ASC     \?$/\
M1     ASC     \MISSING QUOTATION MARKS$/\
M2     ASC     \MISSING TRAILING QUOTATION MARK$/\
M3     ASC     \> 20 CHARACTERS IN FORMAT STRING$/\
M4     ASC     \"!" SHOULD PRECEDE AND FOLLOW THE FIELD CHARACTER$/\
M5     ASC     \MISSING "#" OR "%" IN FORMAT STRING$/\
M6     ASC     \TOO MANY "." IN FORMAT STRING$/\
M7     ASC     \"." IN BAD POSITION$/\
M10    ASC     \MISSING A VALUE$/\
M11    ASC     \TITLE NOT ASSIGNED$/\
M12    ASC     \> 200 DSL'S$/\
M13 ASC \NEED 2 OR 4 VALUES,EG. "DSL 1,1 TO 2,3" OR "DSL TO 2,3"$/\
M14 ASC \FILE NOT SYMBOLIC$/\
M15 ASC \CANNOT FIND FILE$/\
M16 ASC \COMMAND MUST INCLUDE FILE NAME$/\
M17 ASC \END OF INPUT PROGRAM$/\
M19 ASC \COMMAND > 72 CHARACTERS$/\
M20 ASC \NEED A SCALE TO LABEL AN AXIS$/\
M21 ASC \NEED A SCALE TO PLOT THE DATA$/\
M22 ASC \NO DATA - USE THE "DATA" COMMAND$/\
M23 ASC \AUTOMATIC SCALING ILLEGAL FOR LOG SCALES$/\
M24 ASC \AUTOMATIC SCALING NEEDS DATA - USE "DATA" COMMAND$/\
M26 ASC \DATA MIN AND MAX < START, SPECIFY REVERSE SCALING$/\
M30 ASC \FOLLOW BY A NUMBER FROM 1 TO 30,EG. "TITLE 4"$/\
M31 ASC \OPEN YOUR DATA FILE,EG. "OPEN DATAFILE"$/\
M33 ASC \UP TO 20 SYMBOL NUMBERS MAY BE SPECIFIED IN THE LIST$/\
M34 ASC \COMMAND REQUIRES 2 VALUES$/\
M35 ASC \SPECIFY LINES,SYMBOLS,OR BOTH$/\
M36 ASC \START OR INCREMENT MUST BE >= 0 FOR LOG SCALES$/\
M37 ASC \COMMAND REQUIRES 1 OR 2 VALUES$/\
M38 ASC \ILLEGAL WITH "RESTORE"$/\
M39 ASC \NOT RECOGNIZED BY DELETE,SUPPRESS OR RESTORE$/\
M40 ASC \ILLEGAL "ACCURACY"$/\
M41 ASC \ROTATE ACCEPTS ONLY 0 OR 270 DEGREES$/\
M42    EQU     *               'HELP' COMMAND TEXT
       DATA    10627455B,13220456B,11031432B,33222444B,12232057B
       DATA    14456410B,11227064B,11231063B,00022444B,12232057B
       DATA    14466450B,11226060B,00004057B,14404400B,07656403B
       DATA    14422460B,14424456B,15031400B,15024051B,14600054B
       DATA    12231464B,33221441B,14020442B,12226051B,15024445B
       DATA    14656402B,11022463B,10631051B,10422463B,00022441B
       DATA    14634460B,13027464B,00021441B,14020442B,12226051B
       DATA    15024445B,14666451B,13431464B,14432443B,15024457B
       DATA    13431535B,00424057B,15600064B,13600065B,14622400B
       DATA    11220463B,16230054B,13632155B,10631045B,11024464B
       DATA    14656407B,11022466B,11226057B,14022444B,00021071B
       DATA    00032071B,13231450B,10231045B,33221450B,10231047B
       DATA    11231535B,01627057B,00030062B,11226451B,15226400B
       DATA    10624041B,14423445B,33233045B,14431451B,13627135B
       DATA    01626041B,15022463B,15000065B,14022041B,15022555B
       DATA    14232451B,15056412B,15022462B,13224456B,10232045B
       DATA    14600045B,10231471B,14026057B,15066444B,13656414B
       DATA    13630045B,13431400B,10200043B,13626455B,10227044B
       DATA    00023051B,13022555B,33207400B
M44 ASC \NEED A REPEAT INTERVAL AND <= 25 LINE SPECIFICATIONS$/\
M45 ASC \NUMBER MUST BE 9999.,[0.,1. OR 2.] FOR [STOP,NEXT OR TITLE]$/\
M49 ASC \REGION REQUIRES 2 VALUES GREATER THAN ZERO$/\
M50 ASC \7.02$/\
M51 ASC \OUTPUT BAUD RATE NOT 10 OR 30 CPS$/\
M52 ASC \EASYPLOT CANNOT OPEN SCRATCH FILE$/\
M53 ASC \ABORTED$/\
M54 ASC \NO PREMIUM CHARGE$/\
M55 ASC \DEVELOPED BY TYMSHARE$/\
M56 ASC \CONSULT THE TYMSHARE EASYPLOT REFERENCE MANUAL$/\
M57 ASC \STATEMENT ERROR$/\
M58 ASC \EXECUTION ERROR$/\
*  INTERRUPT HANDLING ROUTINES
*
*  THESE ARE SPECIAL BECAUSE OF THE FUNCTIONS THAT MUST BE PERFORMED.
*
*  FLOATING POINT OVERFLOW MUST BE "DISABLED" TO PREVENT ERROR
*  MESSAGES THAT SCREW THE PLOTTER WHEN ATTEMPTING TO PLOT A LINE
*  WITH INFINITE SLOPE (VERTICAL)
*
*  ALTMODES HAVE SEPARATE RETURNS FOR SFE AND EXECUTION...IT IS THE
*  SECOND ALTMODE DURING EXECUTION THAT FINISHES BY TURNING THE
*  PLOTTER OFF
*
*
*  CALL SETINT ( SFE ADR , EXECUTION ADR)
*
*      SETS SFE ALTMODE TRANSFER ADDRESS
*      SETS EXECUTION ALTMODE TRANSFER ADDRESS
*
*  CALL ALTBRU (0)
*
*      TELLS THE ALTMODE HANDLER THAT WE ARE IN THE SFE
*
*  CALL ALTBRU(-1)
*
*      TELLS THE ALTMODE HANDLER THAT WE ARE PLOTTING

$SETINT HEADER SETP2,(INTSFE,INTG,0),(INTEXE,INTG,0)
       LDA*    INTSFE
       STA     SFE
       LDA*    INTEXE
       STA     EXE
       LDA     =ALTHAN
       STA     201B
       BRS     49
       MRG     ALTBIT          ENABLE ALTMODES
       BRS     78
       RETURN  SETINT


$ALTBRU HEADER SETP1,(FLAG,INTG,0)
       LDA*    FLAG
       STA     ALTYPE    0=SFE, -1=EXECUTION
       LDA     =1
       STA     ALTCNT
       RETURN  ALTBRU

ALTHAN ZRO     WHERE
       STA     TEMP
       BRS     49
       MRG     ALTBIT          RE-ENABLE ALTMODES
       BRS     78
       SKN     ALTYPE
       BRU     ALT1    SFE ALTMODE
       SKR     ALTCNT
       BRU     RET     JUST THE FIRST ALTMODE DURING EXECUTION
ALT1   LDX     =-1
       BRS     11
       BRS     29
       SKN     ALTYPE
       BRU     RETSFE
       BRU*    EXE
RET    LDA     TEMP    RETURN FROM FIRST EXECUTION ALTMODE
       BRU*    WHERE
RETSFE TCO     =155B
       BRU*    SFE

SFE    BSS     1    SFE ALTMODE TRANSFER ADDRESS
EXE    BSS     1    EXECUTION ALTMODE TRANSFER ADDRESS
WHERE  BSS     1    ADDRESS OF ALTMODE INTERRUPT OCCURANCE
ALTCNT BSS     1    EXECUTION ALTMODE COUNTER
ALTYPE BSS     1    0=SFE, -1=EXECUTION ALTMODE OCCURANCE
TEMP   BSS     1    TEMP A-REGISTER
*  RETURNS A NUMBER USED BY POINT SUBROUTINE TO DRIVE A 10CPS OR 30CPS
*  PLOTTER.
*
*      CALL SPEED(ISPEED)
*
*  WHERE ISPEED GETS SET TO 4 FOR 10 CPS AND TO 3 FOR 30 CPS
*  AND TO -1 FOR ANYTHING ELSE

$SPEED HEADER  SETP1,(TMP,INTG,0)
       CLX
       BRS     132             READ TERMINAL CHARACTERISTICS
       LRSH    13
       ETR     =7              GET OUTPUT BAUD RATE CODE
       COPY    AX              (0=10 CPS, 1=15 CPS, 2=30 CPS, ETC)
       LDA     CODES,2
       STA*    TMP             RETURN 4 FOR 10CPS, 3 FOR 30CPS, ELSE -1
       RETURN  SPEED
CODES  DATA    4,-1,3,-1,-1,-1,-1,-1
*  BRINGS IN EDITOR  (REQUIRES SUBSYSTEM STATUS)
*
*  THIS SUBROUTINE MUST RESIDE SOMEWHERE IN PAGES 4-7
*
*
*  USE:        CALL EDITOR
*
*  EDITOR IS STARTED UP AS A LOWER PMT FORK BECAUSE ALL OCCURANCES
*  OF BRS 147 AND BRS 151 ARE MODIFIED TO TRAP BACK TO THIS
*  SUBROUTINE SO THAT CERTAIN EZPLOT FILES REMAIN OPEN AND SO THAT
*  WE WILL ALWAYS KNOW THE CURRENT COMMAND FILE NUMBER.

ECOMF  EQU     531B            EDITOR COMMAND FILE LOC
EOUTF  EQU     535B            EDITOR OUTPUT FILE LOC
EINF   EQU     1273B           EDITOR INPUT FILE LOC

$EDITOR HEADER SETP0
       LDX     =-1
       BRS     161             IGNORE ALTMODES AND CONTROL-SHIFT-OH'S
       BRS     70              GET NUMBER OF UNUSED PAGES
       CNA
       ADD     =100B
       STA     1STREL
       LDX     =-8
       STX     NEWCOM          INDICATE NO CHANGE IN COMMAND FILE
       LDA     IFORK,2
       STA     FORK,2          INITIALIZE FORKING INFO
       BRX     *-2
       BRS     43
       STP     EZPLT1
       LDA     =26000000B
       BRM     FIXSUB          MAKE A PMT COPY OF EDITOR
       MRG     =27000000B
       BRM     FIXSUB
       MRG     =30000000B
       BRM     FIXSUB
       XMA     FMAP2
       BRS     44
       LDA     7CIF
       STA     FAREG           SET COMMAND FILE FOR EDITOR
FORKIT LDA     =FLOC+734B5
       LDX     =-1
       BRS     162             RE-ENABLE ALTMODES AND CONTROL-SHIFT-OH
BRS9   BRS     9               START FORK
       BRS     161             IGNORE ALTMODES AND CONTROL-SHIFT-OH'S
       LDA     FSTAT           HOW DID FORK TERMINATE
       SKE     =1              1=OUR INSTRUCTION TRAP
       BRU     EFORK           NORMALLY
       LDA     FLOC
       ETR     =37777B
       CAX
       LDA     FMAP2
       ETR     =777777B
       LDB     EZPLT2
       BRS     44
       LDA     FMAP1
       ETR     =77000000B
       SKN     20000B,2
       BRU     FCOMIN          POS=BRS 151 I'TRAP LOCATION
       BRS     44              NEG=BRS 147 I'TRAP LOCATION
       LDA     =1
       XMA     EOUTF           EDITOR OUTPUT FILE NO.
       BRS     20              CLOSE IT
       CLA
       XMA     EINF            EDITOR INPUT FILE NO.
       BRS     20              CLOSE IT
FRTN   COPY    XA
       ADD     =100001B        FORM:  'BRU  ITRAP+1'
       STA     BRANCH
       LDA     =1
       STA     FLOC            RE-ENTER EDITOR AT BRS 78 BOOTSTRAP
       LDX     =-5
       LDA     BOOT,2          COPY BOOTSTRAP TO EDITOR
       STA     6,2
       BRX     *-2
       CLA
       LDB     EZPLT2
       BRS     44
       BRU     FORKIT          RE-ENTER EDITOR
FCOMIN BRS     44
       LDA     FAREG
       STA     NEWCOM          SAVE NEW COMMAND FILE NO.
BRS151 BRS     151
       BRU     FRTN
EFORK  SKE     =0
BRS10  BRS     10              WHO KNOWS WHAT HAPPENED
       LDP     EZPLT1
       BRS     44
       LDA     1STREL
EDITL  BRS     121             RELEASE ALL PAGES THAT EDITOR GRABBED
       ADD     =1
       SKG     =77B
       BRU     EDITL
       SKN     NEWCOM          WAS A NEW COMMAND FILE OPENED
       BRU     SETCOM          YES, SET OUR FLAGS
       LDX     =-1
       BRS     162             RE-ENABLE ALTMODES AND CONTROL-SHIFT-OH
       RETURN  EDITOR          NO, GO HOME
SETCOM LDA     NEWCOM
       STA     7CIF
       LDB     =-1
       SKG     =0
       CLB
       STB*    WHO             (IN 'CHKCOM' SUBROUTINE)
       LDX     =-1
       BRS     162             RE-ENABLE ALTMODES AND CONTROL-SHIFT-OH
       RETURN  EDITOR

FIXSUB ZRO
       BRS     44
       LDX     =-4000B
FIXSB1 LDA     4000B,2
       SKE     BRS147
       BRU     FIXSB3
       LDA     =-1
FIXSB2 STA*    CODPTR
       MIN     CODPTR
       BRX     FIXSB1
       BRS     43
       ETR     =777777B
       BRR     FIXSUB
FIXSB3 SKE     BRS151
       BRU     FIXSB4
       CLA
       BRU     FIXSB2
FIXSB4 SKE     BRS9
       BRU     FIXSB2
       LDA     BRS10           DIS-ALLOW CALLING FTC FROM EDITOR
       BRU     FIXSB2

1STREL BSS     1               1ST PAGE BYTE FOR EDITOR INTERACTION
EZPLT1 BSS     1               1ST EZPLOT RELABELLING WORD
EZPLT2 BSS     1               2ND EZPLOT RELABELLING WORD
NEWCOM BSS     1               NEW COMMAND FILE SET IN EDITOR IF POS

CODPTR BSS     1               PMT COPY POINTER
FLOC   BSS     1               PROGRAM LOCATION
FAREG  BSS     1               A-REGISTER
FBREG  BSS     1               B-REGISTER
FXREG  BSS     1               X-REGISTER
FMAP1  BSS     1               1ST RELABELLING WORD
FMAP2  BSS     1               2ND RELABELLING WORD
FSTAT  BSS     1               FORK STATUS
FORK   EQU     *

       DATA    4000B           INITIAL PMT COPY POINTER
       DATA    24000B          INITIAL EDITOR START ADR
       DATA    0               (A) COMMAND FILE
       DATA    1               (B) TOUT FILE
       DATA    3               (X) DO SAME AS EXEC DOES FOR X-REG
       DATA    0               1ST RELABELLING WORD
       DATA    0               2ND RELABELLING WORD
       DATA    0               FORK STATUS
IFORK  EQU     *

BRS147 BRS     147

       XMA     5
       BRS     78
       XMA     5
BRANCH BSS     1               BRANCH TO I'TRAP LOCATION + 1
ALTBIT DATA    2B6             MASK TO RE-ARM ALTMODE IN EDITOR
BOOT   EQU     *               BRS 78 BOOTSTRAP FOR LOCS 1 THRU 5
*  PLOTTER DRIVERS USING CONSTANTS
*
*  INSTEAD OF 'CALL OUT(8)', DO 'CALL OUT8'   (FOR EXAMPLE)
*
$OUTPON HEADER SETP0
       TCO     ="  \"          TURN PLOTTER ON
       TCO     ="  P"
       TCO     ="  \"
       RETURN  OUTPON
$OUTOFF HEADER SETP0
       TCO     ="  8"          TURN PLOTTER OFF
       TCO     ="  7"
       TCO     ="  0"
       TCO     =155B           EMIT A CARRIAGE RETURN
       RETURN  OUTOFF
$OUT873 HEADER SETP0
       TCO     ="  8"
       TCO     ="  7"
       TCO     ="  3"
       RETURN OUT873
$OUT9  HEADER  SETP0
       TCO     ="  9"
       RETURN  OUT9
$OUT8  HEADER  SETP0
       TCO     ="  8"
       RETURN  OUT8
$OUT7  HEADER  SETP0
       TCO     ="  7"
       RETURN  OUT7
$OUT6  HEADER  SETP0
       TCO     ="  6"
       RETURN  OUT6


       ENDPRG
       END
EASYPLOT ** FICHE/FRAME BREAK *****
EZPSYM7 SYMSORT

SYM.  PG.LN. IDENT.

1STREL 11 24 EZP7    ALT1    7 15 EZP7    ALTBIT 12 16 EZP7    
ALTBRU  6 38 EZP7    ALTCNT  7 29 EZP7    ALTHAN  7  6 EZP7    ALTYPE  7 30 EZP7    
BOOT   12 17 EZP7    BRANCH 12 15 EZP7    BRS10  10 18 EZP7    BRS147 12 10 EZP7    
BRS151 10 15 EZP7    BRS9    9 15 EZP7    CFIN    1 27 EZP7    CHKCOM  1 10 EZP7    
CHKSYM  2 19 EZP7    CKLEN   3  3 EZP7    CLZCOM  2  9 EZP7    CODES   8 10 EZP7    
CODPTR 11 29 EZP7    CR      1 21 EZP7    CRIN    1 22 EZP7    CRRET   2  4 EZP7    
CRSPC   1 24 EZP7    CRTEL   1 33 EZP7    CRTEL1  1 34 EZP7    ECOMF   8 23 EZP7    
EDITL  10 22 EZP7    EDITOR  8 27 EZP7    EFORK  10 17 EZP7    EINF    8 25 EZP7    
EOUTF   8 24 EZP7    EXE     7 27 EZP7    EZPLT1 11 25 EZP7    EZPLT2 11 26 EZP7    
FAREG  11 31 EZP7    FBREG  11 32 EZP7    FCOMIN 10 12 EZP7    FIXSB1 11  5 EZP7    
FIXSB2 11  9 EZP7    FIXSB3 11 15 EZP7    FIXSB4 11 19 EZP7    FIXSUB 11  2 EZP7    
FLOC   11 30 EZP7    FMAP1  11 34 EZP7    FMAP2  11 35 EZP7    FORK   11 37 EZP7    
FORKIT  9 12 EZP7    FRTN    9 38 EZP7    FSTAT  11 36 EZP7    FXREG  11 33 EZP7    
IFORK  12  8 EZP7    L*     12 18 EZP7    L*      8 11 EZP7    L*      7 32 EZP7    
L*      5 38 EZP7    L*      3 27 EZP7    L*      2 29 EZP7    LOOP    3 14 EZP7    
M1      4 12 EZP7    M10     4 19 EZP7    M11     4 20 EZP7    M12     4 21 EZP7    
M13     4 22 EZP7    M14     4 23 EZP7    M15     4 24 EZP7    M16     4 25 EZP7    
M17     4 26 EZP7    M19     4 27 EZP7    M2      4 13 EZP7    M20     4 28 EZP7    
M21     4 29 EZP7    M22     4 30 EZP7    M23     4 31 EZP7    M24     4 32 EZP7    
M26     4 33 EZP7    M3      4 14 EZP7    M30     4 34 EZP7    M31     4 35 EZP7    
M33     4 36 EZP7    M34     4 37 EZP7    M35     4 38 EZP7    M36     4 39 EZP7    
M37     5  1 EZP7    M38     5  2 EZP7    M39     5  3 EZP7    M4      4 15 EZP7    
M40     5  4 EZP7    M41     5  5 EZP7    M42     5  6 EZP7    M44     5 26 EZP7    
M45     5 27 EZP7    M49     5 28 EZP7    M5      4 16 EZP7    M50     5 29 EZP7    
M51     5 30 EZP7    M52     5 31 EZP7    M53     5 32 EZP7    M54     5 33 EZP7    
M55     5 34 EZP7    M56     5 35 EZP7    M57     5 36 EZP7    M58     5 37 EZP7    
M6      4 17 EZP7    M7      4 18 EZP7    MESPRT  3 32 EZP7    MSCNT   2  6 EZP7    
MTAB    4  3 EZP7    NEWCOM 11 27 EZP7    OSPACE  2 26 EZP7    OUT6   13  8 EZP7    
OUT7   13  5 EZP7    OUT8   13  2 EZP7    OUT873 12 33 EZP7    OUT9   12 38 EZP7    
OUTOFF 12 27 EZP7    OUTPON 12 22 EZP7    PTR     3 25 EZP7    PTR1    3 26 EZP7    
QM      4 11 EZP7    RET     7 21 EZP7    RETSFE  7 23 EZP7    SETCOM 10 31 EZP7    
SETINT  6 25 EZP7    SFE     7 26 EZP7    SPEED   8  1 EZP7    TEMP    7 31 EZP7    
WHERE   7 28 EZP7    
EASYPLOT ** FICHE/FRAME BREAK *****
EZPSYM8
EZP8   IDENT   EASYPLOT PART 8 OF 8

       REM     UPD  25 OCTOBER 1972    THAD FLORYAN


*  ODIR   =  IOLDD
*  LEN    =  L
*  INP    =  IBIN
*  OUTP   =  IBOUT
*  ERR    =  IERR

       BEGPR

$POINT HEADER  SETPN,13,(X1,REAL,0),(Y1,REAL,0),(IGO,INTG,0),
(IOLDX,INTG,0),(IOLDY,INTG,0),(ODIR,INTG,0),(LEN,INTG,0),(INP,INTG,0),
(OUTP,INTG,0),(IO,INTG,0),(INTG,INTG,0),(ERR,INTG,0),(LIM,INTG,0)

      LDP* X1
      BRM  FIX
      STA  XTEMP
      LDP* Y1
      BRM  FIX
      STA  YTEMP
      CLB
      LDA*  IOLDX
      LSH  7
      STA  OLDX
      LDA*  IOLDY
      LSH  7
      STA  OLDY
      LDA*  LIM
      SKE  PLIM
      BRU  LIMCK
BYP3  LDA*  ERR
      SKE  PERR
      BRU  ERRCK
BYP1  LDA*  IGO
      SKE  C1
      BRU  SCAN
      BRM  WRAP
BYP2  LDA  OLDX
      RSH  7
      STA*  IOLDX
      LDA  OLDY
      RSH  7
      STA*  IOLDY
       RETURN  POINT
SCAN  CLB
      STB  H
      LDA  XTEMP
      SUB  OLDX
      STA  DX
      LDA  YTEMP
      SUB  OLDY
      STA  DY
      SKA  POS
      CNA
      STA  ADY
      LDA  DX
      SKA  POS
      CNA
      STA  ADX
      SKG  ADY
      LDA  ADY
      STA  GR
      SKG  RND
      BRU  EX
      LDA*  INP
      SKE*  OUTP
      BRU  CHK
      BRU  CP1
EX    LDA*  INP
      SKE*  OUTP
      BRU  BAD
      BRU  BYP2
CHK   CAX
      LDA  XTEMP
      SUB  BUFFX,2
      SKA  POS
      CNA
      STA  TST
      LDA  YTEMP
      SUB  BUFFY,2
      SKA  POS
      CNA
      SKG  TST
      LDA  TST
      SKG  RND
      BRU  BYP2
      LDA  GR
      LSH  1
      STA  W
      CLB
      LDA  DY
      DIV  W
      STA  SN
      MUL  SN
      STA  SUM
      LDA  DX
      CLB
      DIV  W
      STA  CN
      MUL  CN
      ADD  SUM
      CAX
      MUL  W
      STA  W
      CXA
      RSH  9
       LDX   ERR    **********WAS  LSH*  ERR    IN FOS
       LSH   0,2    ***********
      STA  SUM
      LDX*  OUTP
LOOP  EAX  1,2
      CXA
      ETR  C63
      SKG  SW3
      BRU  *+2
      EAX  0
      LDA  BUFFX,2
      SUB  OLDX
      MUL  SN
      STA  TST
      LDA  BUFFY,2
      SUB  OLDY
      MUL  CN
      SUB  TST
      STA  TST
      MUL  TST
      XAB
      SKG  SUM
      SKB  ZRO
      BRU  BAD
      CXA
      ETR  C63
      SKE*  INP
      BRU  LOOP
      LDA  OLDY
      SUB  BUFFY,2
      MUL  SN
      STA  TST
      LDA  OLDX
      SUB  BUFFX,2
      MUL  CN
      ADD TST
      STA   TST
      CNA
      SKG  W
      SKN  TST
      BRU  BAD
      ADD*  ERR
      SKG  W
      BRU  CP1
      MIN  H
      LDA  XTEMP
      STA  XH
      LDA  YTEMP
      STA  YH
      BRU  BYP2
CP1    LDA  DX      GOOD
      STA  LDX
      LDA  DY
      STA  LDY
      LDA  GR
      ADD  RND
      RSH  7
      SKG  SW3
      BRU  BUFFIT
      LDX  SW
      BRM  GETDIR
      SKG  C6
      BRU  LONG3
BRA   BRM  BUFF
      BRM  BOXA
      LDA*  INP
      SUB  C1
      SKA  POS
      LDA  SW3
      STA*  INP
      BRU  SCAN
BAD   BRM  BOXA
      BRU  SCAN
BUFFIT  BRM  BUFF
      SKN*  IGO
      BRU  BYP2
      BRM  WRAP
      BRU  BYP2
BUFF  ZRO
      LDA*  INP
      ADD  C1
      SKG  SW3
      BRU  *+2
      CLA
      SKE*  OUTP
      BRU  *+2
      BRU  BAD
      STA*  INP
      CAX
      LDA  XTEMP
      STA  BUFFX,2
      LDA  YTEMP
      STA  BUFFY,2
      BRR  BUFF
BUFF2  LDA*  LIM
      BRM  NCOM
      BRU  SCAN
LONG3 LDA*  INP
      STA*  OUTP
      LDA  ADY
      LDB   ADX
      SKG  ADX
      XAB
      STB  W
      STA  GR
      ADM  GR
      ADD  RND
      RSH  7
      SKG  SW2
      BRU  BUFF2
      RSH  23
      DIV  SW1
      STA  N
      MUL  SW1
      LSH  30
      STA  WG
      DIV  GR
      MUL  W
      LSH  1
      STA  GR
      ADD  RND
      RSH  30
      DIV  N
      STB  REM
      LDA  ADX
      SUB  ADY
      EOR DX
      EOR  DY
      EAX  1
      SKA  POS
      BRU  *+2
      CLX
      LDA  REM
      LSH  1
      SKG  N
      BRU  LONG7
      LDA  REM
      STA  MAJ      REM >= N/2
      CNA
      ADD  N
      XXA
      EOR  C1
      XXA
      STA  MIN
      BRU  LONG8
LONG7 SKE  N
      BRU  LON7A
      LDA  C1
      STA  N
      BRU  LONG8
LON7A LDA  REM
      STA  MIN
      CNA
      ADD  N
      STA  MAJ
LONG8 STX  Q
      LDA  ADY
      SKG  ADX
      BRU  LONG8A
      LDA  WG
      LDB  GR
      BRU  LONG8B
LONG8A  LDB  WG
      LDA  GR
LONG8B  STA  ADY
      STB  ADX
      LDX  SW
      BRM  GETDIR
      SKG  C6
      BRU  *+2
      BRU  BRA
      LDA  C1
      STA   IH
      STA  ILAST
      LDA*  LIM
      BRM  NCOM
      LDA  C2
      STA  IHA
LONG10 SKG  N
      BRU  *+2
      BRU  SCAN
      LDA  N
      CLB
      LSH 10
      STA  W
      LDA  IH
      LSH 13
      STA  GR
      LDA  IHA
      MUL  MAJ
      LSH  23
      DIV  W
      SUB  GR
      RSH  12
      SKA  C2
      LDA  C1
      SKE  ILAST
      BRU  LONG11
      CLA
      STA  DEL
LONG12 LDA*  LIM
      BRM  NCOM
      LDA  ILAST
      ADD  IH
      STA  IH
      LDA  IHA
      ADD  C1
      STA  IHA
      BRU  LONG10
LONG11 STA  ILAST
     EOR  C1
      ADD  Q
      CAX
      LDA  LDEL,2
      STA  DEL
      BRU  LONG12
LDEL  DATA -1
      DATA 1
      DATA -1
SKIP  ZRO
      STX  TST
      LDA  CA,2
      STA  SQ
      SUB  C1
      STA  SQM1
      LDX*  OUTP
      STX  PINP
SKIP1 EAX  1,2
      CXA
      SKG  SW3
      BRU  *+2
      EAX  0
      LDA  BUFFX,2
      SUB  OLDX
      STA  LDX
      SKA  POS
      CNA
      STA  ADX
      LDA  BUFFY,2
      SUB  OLDY
      STA  LDY
      SKA  POS
      CNA
      STA  ADY
      SKG  ADX
      LDA  ADX
      ADD RND
      RSH  7
      SKG  SQ
      STX  PINP
      SKG  SQM1
      BRU  SKIP1
      LDX  TST
      BRR  SKIP
GETDIR ZRO
      STX  TST
      LDA*  ODIR
      ADD  CD,2
      RSH  23
      DIV  CB,2
      MUL  CB,2
      RSH  1
      STB  DEL
      LDA  ADY
      SKG  ADX
      BRU  GDIR1
      LDA  ADX
      MUL  C54
      DIV  ADY
      SKN  LDX
      EOR  ZRO
      SKN  LDY
      BRU  *+4
      EOR  ZRO
      ADD  C325
      BRU  NCOM1
      ADD  C109
      BRU  NCOM1
GDIR1  MUL  C54
      DIV  ADX
      SKN  LDY
      EOR  ZRO
      SKN  LDX
      BRU  *+3
      ADD C217
      BRU  NCOM1
      EOR  ZRO
      ADD  C1
      SKA  POS
      ADD  C432
NCOM1  RSH  1
      ADD  CH,2
      BRU*  LEN1,2
LEN1  ZRO  TNEW2
      ZRO  TNEW1
      ZRO  TNEW1
      ZRO  TNEW
TNEW  SUB*  ODIR
      BRU  TNEW3
TNEW1  SUB  DEL
TNEW2  RSH  23
      DIV  CB,2
TNEW3  SKG  CE,2
      ADD  CG,2
      SKG  CF,2
      BRU  *+2
      SUB  CG,2
      SUB  CG,2
      STA  DEL
      SKA  POS
      CNA
      LDX  TST
      BRR  GETDIR
NCOM  ZRO
      COPY AB,N
      ADD  C1
      STA  MIN
      BAC
      XMA*  LEN
      LSH  2
      ADD*  LEN
      AXC
      LDB  Z,2
      DIV  RND
      BRM  CHAR
      BRM  CHAR
      LDX  DEL
      LDA  C1
      SKE*  LEN
      BRU  ELEN2
      CLA
      STA  DEL
      CXB
      BRU  ELEN1
ELEN2 LDB  CODE,2
ELEN1 BRM  CHAR
      LDA*  LEN
      SUB  C1
      CAX
      LDA*  ODIR
      ADD  CD,2
      RSH  23
      DIV  CB,2
      ADD  DEL
      SKA  POS
      ADD  CG,2
      SKG  CC,2
      BRU  *+2
      SUB  CG,2
      STA  NDIR
      MUL  CB,2
      RSH  1
      STB*  ODIR
      LDA  NDIR
      RSH  23
      DIV  CA,2
      LDX  CA,2
      XXA
      STB  REM
      BRU* UPD,2
UPD   ZRO  EUPD
      ZRO  UPD1
      ZRO  UPD2
      ZRO  UPD3
      ZRO  UPD4
      ZRO  UPD5
      ZRO  UPD6
      ZRO  UPD7
UPD1  CAB
      SUB  REM
      BRU  EUPD
UPD2  XAB
      CNA
      BRU  EUPD
UPD3  CAB
      SUB  REM
      BRU  UPD2
UPD4  CNA
      XAB
      BRU  UPD6
UPD5  CAB
      SUB  REM
      CNA
      XAB
UPD6  CNA
      XAB
      BRU  EUPD
UPD7  CAB
      SUB  REM
      BRU  UPD6
EUPD  LSH  7
      ETR  N128
      ADM  OLDX
      CBA
      ADM  OLDY
      BRR  NCOM
CHAR  ZRO
      XAB
      SKG  C0
      BRR  CHAR
      STA  W
      LDX*  IO
TYP   TCO  W
      SKG  C25
      SKG  C23
NXT   BRX  RPT
      BRR  CHAR
RPT   SKN  MIN
      BRU  TYP
      TCO  CODE
      BRU  NXT
      ZRO  31   -6
      ZRO  30   -5
      ZRO  29   -4
      ZRO  22   -3
      ZRO  21   -2
      ZRO  20   -1
CODE  ZRO  19   0
      ZRO  18   1
      ZRO  17   2
C16   ZRO  16   3
      ZRO  28   4
      ZRO  27   5
      ZRO  26   6
C25   ZRO  25
CA    ZRO  1
C3    ZRO  3
C9    ZRO  9
CB    ZRO  27
      ZRO  9
      ZRO  3
      ZRO  1
CC    ZRO  7
C23   ZRO  23
      ZRO  71
      ZRO  215
CD    ZRO  13
C4    ZRO  4
C1    ZRO  1
C0    ZRO  0
CE    ZRO  8
      ZRO  13
      ZRO  37
C109  ZRO  109
CF    ZRO  15
      ZRO  36
      ZRO  108
      ZRO  324
CG    ZRO  8
      ZRO  24
      ZRO  72
Z     ZRO  216
CH    ZRO  229
      ZRO  220
C217  ZRO  217
      ZRO  216
      ZRO  0
      ZRO  3072
      ZRO  3200
      ZRO  3122
      ZRO  3200
      ZRO  0
      ZRO  3072
      ZRO  3120
      ZRO  3250
      ZRO  3200
      ZRO  0
      ZRO  3072
      ZRO  3248
      ZRO  3072
      ZRO  3200
      ZRO  0
BOXA  ZRO
      LDX*  INP
      LDA  BUFFX,2
      SUB  OLDX
      STA  LDX
      SKA  POS
      CNA
      STA  ADX
      LDA  BUFFY,2
      SUB  OLDY
      STA  LDY
      SKA  POS
      CNA
      STA  ADY
      SKG  ADX
      LDA  ADX
      ADD  RND
      RSH  7
      LDX  SW
      BRU*  BOXN,2
BOXN  ZRO  CLBUFF
      ZRO  TST3A
      ZRO  BOXA1
      ZRO  TST9A
TST9A SKG  CE
      BRU  BOXA1
      LDX  C2
      BRM  SKIP
      BRM  GETDIR
      SKG  C6
      BRU  BOXA2
      BRU  TST3
BOXA2 LDA  PINP
      STA*  OUTP
      BRX  0
      CXA
      BRM  NCOM
      BRR  BOXA
BOXA1 SKG  C2
      BRU  TST3A
TST3  LDX  C1
      BRM  SKIP
      BRM  GETDIR
      SKG  C6
      BRU  BOXA2
      BRU  TST3B
TST3A SKG  C0
      BRU  CLBUFF
TST3B CLX
      BRM  SKIP
      BRM  GETDIR
      LDA  DEL
      MUL  C27
      RSH  1
      STB*  ODIR
      LDA  C16
      ADM  DEL
      BRU  BOXA2
CLBUFF CLA
      STA*  INP
      STA*  OUTP
      STA  H
      BRR  BOXA
WRAP  ZRO
      CLA
      SKE  H
      BRU  CLR
      BRU  *+2
WRBOX BRM  BOXA
      LDA*  INP
      SKE*  OUTP
      BRU  WRBOX
      BRR  WRAP
CLR   STA  H
      LDX*  INP
      LDA  XH
      STA  BUFFX,2
      LDA  YH
      STA  BUFFY,2
      BRU  WRBOX
LIMCK BRM  WRAP
      LDA*  LIM
      SKG  C4
      SKG  C0
      BRU  SETLIM
SETSWS STA PLIM
      SUB  C1
      STA  SW
      CAX
      LDA  CA,2
      STA  SW1
      SUB  C1
      STA  SW3
      LSH  1
      ADD C1
      STA  SW2
      BRU  BYP3
SETLIM  LDA  C4
      STA*  LIM
      BRU  SETSWS
ERRCK BRM  WRAP
      LDA*  ERR
      SKG  C9
      SKG  C0
      BRU  *+3
SETERR STA PERR
      BRU  BYP1
      LDA  C3
      STA*  ERR
      BRU  SETERR
FIX   ZRO
      BRS  50
      LSH  7
      SKN*  INTG
      BRU  *+2
      BRR  FIX
      ADD  RND
      ETR  N128
      BRR  FIX
POS   DATA 4B7
N128  DATA 77777600B
ZRO   DATA  77777777B
PLIM  DATA  99
PERR  DATA  3
C63   ZRO  63
C325  ZRO  325
C432  ZRO  432
RND   DATA  64
C27   ZRO  27
C54   ZRO  54
C2    ZRO  2
C6    ZRO  6
DX    ZRO
DY    ZRO
SUM   ZRO
SN    ZRO
CN    ZRO
DEL   ZRO
ADX   ZRO
ADY   ZRO
LDX   ZRO
LDY   ZRO
REM   ZRO
N     ZRO
WG    ZRO
W     ZRO
MAJ   ZRO
MIN   ZRO
GR    ZRO
Q     ZRO
SQ    ZRO
PINP  ZRO
NDIR  ZRO
IH    ZRO
IHA   ZRO
ILAST ZRO
SW    ZRO
SW1   ZRO
SW2   ZRO
SW3   ZRO
TST   ZRO
SQM1  ZRO
OLDX  ZRO
OLDY  ZRO
BUFFX BSS  28
BUFFY BSS  28
H     ZRO
XH    ZRO
YH    ZRO
XTEMP  ZRO
YTEMP  ZRO
       ENDPRG
      END
EASYPLOT ** FICHE/FRAME BREAK *****
EZPSYM8 SYMSORT

SYM.  PG.LN. IDENT.

ADX    19 15 EZP8    ADY    19 16 EZP8    BAD     5 22 EZP8    
BOXA   15 33 EZP8    BOXA1  16 32 EZP8    BOXA2  16 26 EZP8    BOXN   16 14 EZP8    
BRA     5 14 EZP8    BUFF    5 29 EZP8    BUFF2   6  6 EZP8    BUFFIT  5 24 EZP8    
BUFFX  20  2 EZP8    BUFFY  20  3 EZP8    BYP1    1 34 EZP8    BYP2    1 38 EZP8    
BYP3    1 31 EZP8    C0     14 39 EZP8    C1     14 38 EZP8    C109   15  4 EZP8    
C16    14 20 EZP8    C2     19  7 EZP8    C217   15 15 EZP8    C23    14 33 EZP8    
C25    14 24 EZP8    C27    19  5 EZP8    C3     14 26 EZP8    C325   19  2 EZP8    
C4     14 37 EZP8    C432   19  3 EZP8    C54    19  6 EZP8    C6     19  8 EZP8    
C63    19  1 EZP8    C9     14 27 EZP8    CA     14 25 EZP8    CB     14 28 EZP8    
CC     14 32 EZP8    CD     14 36 EZP8    CE     15  1 EZP8    CF     15  5 EZP8    
CG     15  9 EZP8    CH     15 13 EZP8    CHAR   13 35 EZP8    CHK     2 34 EZP8    
CLBUFF 17 13 EZP8    CLR    17 28 EZP8    CN     19 13 EZP8    CODE   14 17 EZP8    
CP1     5  1 EZP8    DEL    19 14 EZP8    DX     19  9 EZP8    DY     19 10 EZP8    
ELEN1  12 13 EZP8    ELEN2  12 12 EZP8    ERRCK  18 16 EZP8    EUPD   13 29 EZP8    
EX      2 30 EZP8    FIX    18 26 EZP8    GDIR1  10 34 EZP8    GETDIR 10 10 EZP8    
GR     19 25 EZP8    H      20  4 EZP8    IH     19 30 EZP8    IHA    19 31 EZP8    
ILAST  19 32 EZP8    LDEL    9 11 EZP8    LDX    19 17 EZP8    LDY    19 18 EZP8    
LEN1   11 10 EZP8    LIMCK  17 35 EZP8    LON7A   7 23 EZP8    LONG10  8 12 EZP8    
LONG11  9  4 EZP8    LONG12  8 34 EZP8    LONG3   6  9 EZP8    LONG7   7 18 EZP8    
LONG8   7 28 EZP8    LONG8A  7 35 EZP8    LONG8B  7 37 EZP8    LOOP    3 33 EZP8    
MAJ    19 23 EZP8    MIN    19 24 EZP8    N      19 20 EZP8    N128   18 36 EZP8    
NCOM   11 30 EZP8    NCOM1  11  7 EZP8    NDIR   19 29 EZP8    NXT    14  5 EZP8    
OLDX   19 39 EZP8    OLDY   20  1 EZP8    PERR   18 39 EZP8    PINP   19 28 EZP8    
PLIM   18 38 EZP8    POINT   1 14 EZP8    POS    18 35 EZP8    Q      19 26 EZP8    
REM    19 19 EZP8    RND    19  4 EZP8    RPT    14  7 EZP8    SCAN    2  6 EZP8    
SETERR 18 21 EZP8    SETLIM 18 13 EZP8    SETSWS 18  1 EZP8    SKIP    9 14 EZP8    
SKIP1   9 22 EZP8    SN     19 12 EZP8    SQ     19 27 EZP8    SQM1   19 38 EZP8    
SUM    19 11 EZP8    SW     19 33 EZP8    SW1    19 34 EZP8    SW2    19 35 EZP8    
SW3    19 36 EZP8    TNEW   11 14 EZP8    TNEW1  11 16 EZP8    TNEW2  11 17 EZP8    
TNEW3  11 19 EZP8    TST    19 37 EZP8    TST3   16 34 EZP8    TST3A  17  1 EZP8    
TST3B  17  3 EZP8    TST9A  16 18 EZP8    TYP    14  2 EZP8    UPD    12 38 EZP8    
UPD1   13  7 EZP8    UPD2   13 10 EZP8    UPD3   13 13 EZP8    UPD4   13 16 EZP8    
UPD5   13 19 EZP8    UPD6   13 23 EZP8    UPD7   13 26 EZP8    W      19 22 EZP8    
WG     19 21 EZP8    WRAP   17 18 EZP8    WRBOX  17 23 EZP8    XH     20  5 EZP8    
XTEMP  20  7 EZP8    YH     20  6 EZP8    YTEMP  20  8 EZP8    Z      15 12 EZP8    
ZRO    18 37 EZP8    _O_^F[  1 15 EZP8    
EASYPLOT ** FICHE/FRAME BREAK *****
EZPBUILD
"
STARTING TO BUILD EASYPLOT


********** FILE: EZPSYM1
"
BFO
OFF ARG
COM EZPSYM1,BIN1

Q
"

********** FILE: EZPSYM2
"
BFO
OFF ARG
COM EZPSYM2,BIN2

Q
"

********** FILE: EZPSYM3
"
BFO
OFF ARG
COM EZPSYM3,BIN3

Q
"

********** FILE: EZPSYM4
"
BFO
OFF ARG
COM EZPSYM4,BIN4

Q
"

********** FILE: EZPSYM5
"
BFO
OFF ARG
COM EZPSYM5,BIN5

Q
"

********** FILE: EZPSYM6
"
BFO
OFF ARG
COM EZPSYM6,BIN6

Q
"

********** FILE: EZPSYM7
"
NARP
*BFMACRO
CON
EZPSYM7
BINNY


BFBED
POST
BINNY
BIN7

Q
"

********** FILE: EZPSYM8
"
NARP
*BFMACRO
CON
EZPSYM8
BINNY


BFBED
POST
BINNY
BIN8

Q
DEL BINNY
"



NOW STARTING TO LOAD BINARIES


"
BFO
LOA BIN1,BIN2,BIN3,BIN4,BIN5,BIN6,BIN7,BIN8
FIN
STO
WRI EZPLOT

REMOVE DEBUG
WRI EASYPLOT

Q
"

EASYPLOT (DEBUG INFO) IS FILE:  EZPLOT

EASYPLOT FOR TRANSMITTAL IS FILE:  EASYPLOT

APPLY SUBSYSTEM STATUS TO BOTH FILES


"
COM T
   , u