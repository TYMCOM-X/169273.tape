1BCHARGE ** FICHE/FRAME BREAK *****
BCHARGE1406
RCHG   EQU     -1              -1> BCHARGE 1=>RCHARGE
   IF RCHG
RCHARGE IDENT CLC
       REM  THIS IS RCHARGE
BCHG EQU -1             EQUIVALENT TO NEGATION OF RCHG
     ELSE
BCHARGE IDENT CLC
       REM THIS IS BCHARGE
BCHG EQU 1              EQUIVALENT TO NEGATION OF RCHG
     ENDF
DEBUG  EQU     -1              -1=> PRODUCTION 1=> DEBUG
  IF DEBUG
       REM  DEBUGGING VERSION
    ELSE
       REM PRODUCTION VERSION
  ENDF

RECLEN EQU     28              DEFINE LENGTH OF RECORDS
* 1406 ENABLES JOB TYPES 4 & 5 FOR AREA 7 (FRENCH) CUSTOMERS.  THE FCUST
*      ROUTINE AND OTHERS WHICH DEPEND ON IT WAS REMOVED.  IMPROVED HELP
*      MESSAGE AND MADE OTHER MINOR IMPROVEMENTS.  /MCH
*1400 USES NEW BATCH FORMAT
*1311 MAKES AREA 30 CHARGED FRENCH, EXCEPT FOR 31 WHICH IS BELGIUM
*1310  DOES NOT ALLOW TYPE 7 FOR FOREIGN USERS
*1310 MOVES BELGIUM FROM DIST 77 TO  AREA 3

MINPOS  EQU     12             MINIMUM POSTAGE CHARGE (IN CENTS)

SKNE    OPD     536B5,2
          BRU     BEGIN
        BRS     10
  IF RCHG
MVER   ASC     '$REMOTE SPOOL ENTRY PROGRAM VERSION 14.06$/'
    ELSE
MVER    ASC     '$BATCH ENTRY PROGRAM VERSION 14.06$/'
  ENDF
        ASC     'HINCKLEY '

*** MSG:  TAKES THE STARTING LOCATION OF AN ASC STRING TO BE PRINTED
***       ON THE TERMINAL (EXPECTS / AS THE STRING TERMINATOR)

MSG     POPD    100B5,2
        STP     SAVA
        STX     SAVX           SAVE THE REGISTERS
        EAX*    0
        CXA
        ETR     =37777B        A NOW HAS THE STARTING LOCATION OF THE STRING
        LDB     =-1
        LDX     =1
        BRS     34
        BRU     MSGP2

*** MSGP:      TAKES THE STARTING LOCATION OF AN ASC STRING AS ARGUMENT
***            AND PRINTS IT TO THE FILE STORED IN FNO
***            STRING MUST END WITH A /

MSGP    POPD    101B5,2
        STA     SAVA
        STX     SAVX
        EAX*    0
        CXA
        ETR     =37777B
        LDB     =-1
        LDX     FNO
        BRS     34
MSGP2   LDP     SAVA
        LDX     SAVX           RESTORE REGISTERS
        BRR     0              RETURN TO CALLER

*** SPACE:     TAKES AN INTEGER ARGUMENT AND PRINTS THAT MANY SPACES
***            TO THE FILE STORED IN FNO

SPACE   POPD    103B5,2
        STP     SAVA
        STX     SAVX           SAVE THE REGISTERS
        EAX*    0
        CXA
        ETR     =37777B
        CNA
        CAX                    X NOW HAS THE NEG OF THE COUNT GIVEN TO SPACE
        CLA
        CIO     FNO
        BRX     *-1
        BRU     MSGP2

*** CR:        LIKE SPACE ABOVE EXCEPT THAT IT PRINTS CARRIAGE-RETURNS

CR      POPD    104B5,2
        STP     SAVA
        STX     SAVX
        EAX*    0
        CXA
        ETR     =37777B
        CNA
        CAX
        LDA     =155B
        CIO     FNO
        BRX     *-1
        BRU     MSGP2
SAVX    ZRO
SAVA    ZRO
SAVB    ZRO
CINSW   DATA    -1
TERMCH  ZRO
SYSNO   ZRO
CZONE   ZRO
SYSNAM  ZRO
SYSXXX  ZRO
FSUR    DATA    88
BELSUR DATA    700
*FRENCH SURCHARGE ON CARD WORK CURRENTLY 88 FF


BEGIN   STP     CIN            LOAD PRIMARY INPUT FILE INTO CIN AND PRIMARY OUTPUT FILE INTO TOUT
        SKE     =0
        STA     CINSW          IF PRIMARY OUTPUT FILE IS NOT TERMINAL, STORE THE FILE NUM IN CINSW
        LDA     20000B
        BRS     71             SKIP IF USER HAS SET SYSTEM OR EXEC LICENSE
        BRU     *+2
        BRU     B1             HAS LICENSE, SO GO TO B1
        BRS     39             NO LICENSE SET, SO LOOK UP HIS STATUS
        SKA     =4B7           SKIP IF USER DOES NOT HAVE TYMSHARE LICENCE
  IF RCHG
          BRU B1
        BRU NOPE                STOP USER IF NO TYMSHARE LICENSE
    ELSE
          BRU     *+2
        BRU     NOPE           STOP USER IF NO TYMSHARE LICENSE
        RSH     2
        ETR     =1777B         A REGISTER NOW HAS DISTRICT NUMBER
        SNE     =2             IF USER IS IN DISTRICT 0 OR 2 GO TO B1
          BRU     B1               AND OTHERWISE GO TO NOPE
        SNE     =0
          BRU     B1
  ENDF

* PRINT A QUESTION MARK ON TERMINAL AND RETURN TO EXEC
NOPE    TCO     =0
        TCO     ='?'
        BRS     10

*  READ 100 OCTAL WORDS OF INFO FROM DISK INTO CORE 
*  DISK ADDR 200 BEGINS A SYSTEM TABLE.  READ INFO INTO BUF
B1      LDA     =BUF
        LDB     =200B
        LDX     =100B
        BRS     124            READ FROM DISK INTO CORE
        LDA     BUF+74B
        STA     CZONE          PICK UP LOCAL TIME ZONE (??)
        ADM     RDX
        LDA     BUF+75B
        LRSH    12
        STA     SYSNO          SAVE THE SYSTEM NUMBER
        LDA     BUF+77B
        STA     SYSNAM         SAVE SYSTEM NAME (BUT PROBABLY NOT USED)

*  MAKE THE BATCH FILE NAME BEGIN WITH THE (3-DIGIT) SYSTEM NUMBER
       LDA SYSNO
       CLB
       LRSH 23
       DIV =100
       ADD =20B
       WCI SYSPTR
       COPY BA,B
       LRSH 23
       DIV =10
       ADD =20B
       WCI SYSPTR
       COPY BA
       ADD =20B
       WCI SYSPTR

*  MAKE THE BATCH FILE NAME END WITH THE (2-DIGIT) MONTH NUMBER
       LDA =-1
       LDX =200020B
       BRS 176
       ABC
       LSH 4
       CLA
       LSH 4
       STA MO
       ADD =1
       CLB
       LRSH 23
       DIV =10
       ADD =20B
       WCI MONPTR
       CBA
       ADD =20B
       WCI MONPTR

    IF      RCHG
       BRM     GUSER           LOOK UP AND SAVE SOME INFO ABOUT THE USER
       BRM     VER
     ENDF
       MSG     MVER            (THE VERSION NUMBER)

*COMMAND DISPATCHER

RESET  CLA
       STA     TPUR
       STA     AGINSW          ASK AGIN?
       STA     HOLDSW
        STA     ERFLG
        STA     LSTSW
        STA     NUMSW
        STA     ALLSW
        STA     ORECSW
        STA     CORSW
        STA     NULLSW
        STA     CRESW
       STA SAWFRN
        LDA     =4B4
        LDX     =1
        BRS     12             ALLOW COMMAND EDITING AND ECHOING
        BRS     147            CLOSE ALL BUT THE COMMAND FILES
        BRS     114            ALLOW ESCAPES AGAIN
GLTCH   SKN     CINSW
        BRU     IN1            NO INPUT FROM TERMINAL SO NO PROMPT TO PRINT
        LDA     =155B
        CIO     =1
        CIO     =1             OUTPUT TWO CARRIAGE-RETURNS
    IF RCHG
        LDA ='*'                PROMPT FOR RCHARGE
      ELSE
        LDA     ='>'           PROMPT FOR BCHARGE
      ENDF
        CIO     =1
IN1     CIO     CIN            GET A CHARACTER FROM INPUT FILE
        SNE     =155B
          BRU     IN1          IT WAS A CARRIAGE-RETURN, SO IGNORE
        SNE     =0
          BRU     IN1          IT WAS A SPACE SO IGNORE & GET ANOTHER
        LRSH    8              GOT A CHARACTER SO SHIFT IT INTO B REGISTER
IN2     CIO     CIN
        SNE     =155B
          BRU     CHK          2ND CHAR WAS A CARRIAGE-RETURN SO CALL CHK
        SNE     =0
          BRU     CHK          2ND CHAR WAS A SPACE SO CALL CHK
        LRSH    8              SAVE SECOND CHARACTER IN B REGISTER
IN3     CIO     CIN            GET THE 3RD CHAR FROM INPUT FILE
        SNE     =155B
          BRU     ERR          OOPS--NOT A VALID COMMAND
        SNE     =0
          BRU     ERR
        LRSH    8              SHIFT THE 3RD CHAR INTO B REGISTER
IN4     CIO     CIN            GET A 4TH CHARACTER FROM INPUT FILE
        SNE     =155B
          BRU     IN5
        SKE     =0
          BRU     IN4          WE HAVEN'T SEEN A SPACE OR CR YET SO GET MORE
IN5     STA     TERMCH         SAVE THE CHARACTER THAT TERMINATED THE INPUT

*  NOW SEE IF WE CAN MATCH THE COMMAND (IF SO EXECUTE IT)
        LDX     =CTBL-CTBLND
        CBA
        SKE     CTBLND,2
          BRX     *-1
        BRU*    BTBLND,2

* CLEAR INPUT BUFFER AND A REGISTER.
* THEN SEE IF THE COMMAND WAS QUIT (IF SO, FINISH UP)
* OR A ? (IN WHICH CASE CALL THE HELP ROUTINE).
*  ANYTHING ELSE IS AN ERROR.
CHK     LDX     =-1
        BRS     11
        CLA
        LSH     8
        SNE     ='Q'
          BRU     THRU
        SNE     ='?'
          BRU     HEL
        BRU     ERR

* JUST PRINT A ? AND GO GET ANOTHER COMMAND ON FIRST ERROR.
* REMIND USER OF HELP COMMAND IF HE'S MADE MORE THAN ONE ERROR.
ERR     LDA     ERFLG
        SKE     =0
          BRU     ERR1
        MIN     ERFLG
        MSG     ERMSG           (PRINT ? AND CR)
        BRU     GLTCH
ERR1    MSG     ERMSG1
        BRU     RESET
ERFLG   ZRO
ERMSG   ASC     '$ ?$/'
ERMSG1  ASC     '$FOR ASSISTANCE, TYPE HELP$/'

    IF RCHG
CTBL     ASC 'SILRUPIOVAHCIUQLEHROC'
CTBLND  DATA 0,LIST,PURGE,VOID,CHG,THRU,HEL,COR
      ELSE
CTBL    ASC     'SILRUPIOVAHCIUQLEHSOPCERERCKAM'
CTBLND  DATA    0,LIST,PURGE,VOID,CHG,THRU,HEL,COR,NULL,CREATE,MAKE
      ENDF
BTBLND  DATA    ERR

CLBUF   ZRO
        LDA     =155B
        CIT     CIN
          BRR     CLBUF
        BRU     *-2

*TAKE DATE FROM TELETYPE AND MAKE STRING IN BATCH RECORD COMPLETION DATE
GTDATE ZRO
        MSG     M1              (COMPLETION DATE)
        BRM     CLBUF
        BRM     RDNO
        BRU     RESET
        SKG     =12
        SKG     =0
        BRU     GTDAT2          (ERROR)
        STA     MO
        BRM     RDNO
        BRU     RESET
        SKG     =31
        SKG     =0
        BRU     GTDAT2          (ERROR)
        STA     DAY
        BRM     RDNO
        BRU     RESET
        LRSH    23
        DIV     =1900
        CBA
        SKG     =79
        SKG     =74
        BRU     GTDAT2          (ERROR)
        STA     YR
        LDA     =DATE
        MUL     =3
        LSH     23
        SUB     =1
        CAB
        STP     DATEPT
        LDA     MO
        BRM     GTDAT1
        LDA     ='-'
        WCI     DATEPT
        LDA     DAY
        BRM     GTDAT1
        LDA     ='-'
        WCI     DATEPT
        LDA     YR
        BRM     GTDAT1
        LDA     =200B
        WCI     DATEPT
        BRR     GTDATE
GTDAT1  ZRO
        LRSH    23
        DIV     =10
        ADD     =20B
        WCI     DATEPT
        CBA
        ADD     =20B
        WCI     DATEPT
        BRR     GTDAT1
GTDAT2  MSG     M2              (CORRECT DATE FORMAT IS MM-DD-YY)
        LDX     =-1
        BRS     11
        BRU     GTDATE+1
MO      ZRO
DAY     ZRO
YR      ZRO

*BUFFER FOR READING A RECORD FROM THE BATCH RECORD FILE

ALLHOL DATA    0               -1=> ALLOW HOLD IN YN  , 0=> NO HOLD
HOLDSW DATA    0               -1=> HOLD ENTERED , 0=> NO HOLD
TWOFLG DATA    0               -1=> TWO REQ FOR SAME USER (USED IN WCHG)
AGINSW DATA    0               -1=> HOLD COMMING IN FROM FILE
RECBUF  BSS    RECLEN
TYPE    EQU             RECBUF
UNAME  EQU     RECBUF+1        USER NAME (MAX. 12 CHARS)
GAN    EQU     RECBUF+5        THE GAN (STORED IN DECIMAL)
UUN    EQU     RECBUF+6        THE UUN
HOST   EQU     RECBUF+7        THE HOST SYSTEM NUMBER
EDATE  EQU     RECBUF+8        THE DATE (IN CUBS)
PROJ   EQU     RECBUF+9        PROJECT CODE (MAX 12 CHARS)
JOB    EQU     RECBUF+13       THE REQUEST NUMBER (DECIMAL)
REQBY  EQU     RECBUF+14       NAME OF REQUESTOR (MAX 12 CHARS)
NCHR   EQU     RECBUF+18       NUMBER OF CHARACTERS PROCESSED (DECIMAL)
NPAG   EQU     RECBUF+19       NUMBER OF PAGES PROCESSED (DECIMAL)
PARTS  EQU     RECBUF+20       NUMBER OF PARTS OF PAPER (DECIMAL)
CARPRO EQU     RECBUF+21       NUMBER OF CARDS PROCESSED (DECIMAL)
FILPRO EQU     RECBUF+21       NUMBER OF FILES PROCESSED (DECIMAL)
TAPPUR EQU     RECBUF+22       NUMBER OF TAPES PURCHASED (DECIMAL)
TAPCON EQU     RECBUF+23       NUMBER OF TAPES CONVERTED (DECIMAL)
DECCOL EQU     RECBUF+24       LISTINGS DECOLLATED (1 = NO, 2 = YES)
CURREN EQU     RECBUF+25       TYPE OF CURRENCY (3 CHARACTER CODE)
POST   EQU     RECBUF+26       POSTAGE CHARGES (IN CENTS OR EQUIVALENT)
FLAG   EQU     RECBUF+27       SUPPOSEDLY SPARE, BUT USED FOR SOMETHING
        ZRO
HBUF    BSS     30
        ZRO
* CIN IS PRIMARY INPUT FILE AND TOUT IS PRIMARY OUTPUT FILE.
* THESE ARE USUALLY BOTH THE TELETYPE BUT MIGHT BE DIFFERENT
CIN     ZRO
TOUT    ZRO
FNO     ZRO
DATEPT  BSS     2

*MESSAGE STRINGS

CC1    ASC     'NUMBER OF TAPES CONVERTED: /'
ILLTYP ASC     '$ILLEGAL TYPE$/'
M1      ASC     '$COMPLETION DATE: /'
M2      ASC     '$CORRECT DATE FORMAT IS MM-DD-YY/'
M3      ASC     '$REQUEST NO: /'
M4      ASC     '$ENTER LIMITING MONTH-DATE-YEAR: /'
M5      ASC     '$OUTPUT TO: /'
M6      ASC     '$ERROR IN COMMAND FILE - ABORTING$/'
M7      ASC     '$ALL? /'
M8      ASC     '$PURGE COMPLETED$/'
M9      ASC     '$$OKAY? /'
M10     ASC     '$BATCH TYPE: /'
M11     ASC     '$PAGES: /'
M12     ASC     '$PARTS: /'
M13     ASC     '$WERE LISTINGS DECOLLATED? /'
M14     ASC     '$ANY POSTAGE OR OTHER TRANSPORTATION CHARGE? /'
M15     ASC     '$ENTER AMOUNT: /'
M16     ASC     '$ANOTHER BATCH TYPE FOR THIS REQUEST? /'
M17     ASC     '$ANOTHER REQUEST? /'
*M18     ASC     '$DISTRICT NO: /'
M19     ASC     '$ENTER POSTAGE OR TRANSPORTATION CHARGE: /'
M20     ASC     '$NUMBER OF CARDS: /'
M21     ASC     '$NUMBER OF FILES: /'
M22     ASC     '$ENTER NUMBER OF TAPES PURCHASED: '
M23     ASC     '$NUMBER OF CHARACTERS: /'
M24     ASC     '$RATE PER 100K CHARS.: /'
M25     ASC     '$NUMBER OF TAPES PURCHASED: /'
M26     ASC     '$ALL ENTRIES CORRECT? /'
M27     ASC     '$REENTER ALL DATA$/'
M28     ASC     '$NO RECORD OF THAT REQUEST$/'
M29     ASC     '$REQUEST VOIDED BY: /'
M30     ASC     '$ARE YOU SURE YOU WANT TO CHARGE /'
M31     ASC     '$MINIMUM POSTAGE CHARGE IS .13$/'
LHEAD   ASC     '$ REQ.   GAN  USER NAME    PROJECT CODE   REQUEST DATE/'
LHEADV  ASC     '$ REQ.   GAN  USER NAME    PROJECT CODE   REQUEST DATE'
       ASC     ' VOIDED BY /'
LHEAD1  ASC     '$ REQ.   GAN  USER NAME    PROJECT CODE   REQUEST DATE'
 ASC   '$TYPE CHARACTER   PAGES PRTS  CRD-FIL TAP-PUR TCNV  DEC  DELCHG CUR/'

*CONVERTS AN INTEGER IN A REGISTER TO THE FLOATING POINT NUMBER
*REPRESENTING THE NUMBER AS DOLLARS AND CENTS. INTEGER IN A MUST BE
*IN CENTS

CVT     ZRO
        BRS     51
        BRS     118
        FFDV    CVTDAT
        BRS     119
        BRR     CVT
RECVT   ZRO
        BRS     118
        FFMP    CVTDAT
        BRS     50
        SKB     =4B7
        ADD     =1
        BRR     RECVT
CVTDAT  DATA    31B6,7

*FIND AN UNPROCESSED RECORD IN (SPOOL)RECREMOTE OR RECREMOTEA.
*THE RECORD NUMBER MUST BE IN THE A REGISTER UPON ENTRY.
* TAKE A SKIP RETURN TO CALLER IF WE FIND A RECORD.

FNDREC  ZRO
        SKN     LSTSW
        BRM     ORECF          OPEN RECREMOTE IN WRITE MODE (BUT WILL READ ONLY)
FREC3   CLA
        SCP     RECFNO         SET CURSOR TO BEGIN OF FILE (NOW IN READ MODE)
          HLT     0              OOPS--AN ERROR SETTING CURSOR SO STOP
        RSP     RECFNO         LOOK UP SIZE OF FILE
        STA     CPTOP          AND SAVE IT IN CPTOP
FREC1   RCP     RECFNO         READ THE CURSOR POSITION IN FILE
        SNE     CPTOP
        BRU     FREC2          FILE IS EMPTY, SO CLOSE IT AND SEE IF MORE TO DO
        STA     RECCUR          (SAVE FOR POSSIBLE WRITE)
        LDX     =RECBUF
        LDA     =RECLEN
        BIO     RECFNO         READ A RECORD FROM RECREMOTE INTO RECBUF
        NOP

* FOR RCHARGE, IF JOB TYPE IS NOT 9, READ THE NEXT RECORD
       IF RCHG; LDA RECBUF; ETR =7777B; SKE =9; BRU FREC1; ENDF
        SKN     ALLSW          SKIP NEXT INSTR IF WE ARE LOOKING AT ALL RECS
        BRU     *+2
        BRU     FREC1C
        SKN     SPLSW
        BRU     *+3
FREC1C  RCP     RECFNO         READ OUR CURRENT POSITION IN RECORD FILE
        STA     ALLCUR         SAVE IT IN ALLCUR
        SKN     LSTSW
        BRU     *+2
        BRU     FREC4
        SKN     ALLSW
        BRU     *+2
        BRU     FREC1A
        SKN     SPLSW
        BRU     *+2
        BRU     FREC1A
        LDA     JOB
        SKE     FJOB           SKIP IF THE CURRENT REC IS THE ONE WE WANT
        BRU     FREC1          GO FIND NEXT RECORD

        SKN     ORECSW         SKIP IF WE FOUND THE REC IN RECREMOTEA
        BRU     *+2
        BRU     FREC5
FREC1A  SKN     FLAG
        BRU     *+2
        BRU     FREC1
FREC1B  LDA     RECFNO
        BRS     2              CLOSE THE FILE
        MIN     FNDREC
        BRR     FNDREC         AND TAKE THE SKIP RETURN
FREC2   LDA     RECFNO
        BRS     2
        SKN     RECFB          IF WE WERE NOT LOOKING AT RECREMOTEA GO LOOK
        BRU     *+2
        BRR     FNDREC          (BOTH FILES SEARCHED AND NOT FOUND)
        BRM     ORECFA
        BRU     FREC3          WE OPENED RECREMOTEA SO GO LOOK FOR A RECORD
FREC4   SKN     ORECSW
        BRU     *+2
        BRU     FREC5
        MIN     FNDREC
        BRR     FNDREC         TAKE THE SKIP RETURN TO CALLER--WE FOUND A REC
FREC5   LDA     FLAG
        SKE     =-2
        BRU     FREC1
        SKN     LSTSW
        BRU     FREC1B
        MIN     FNDREC
        BRR     FNDREC         TAKE THE SKIP RETURN TO CALLER
FJOB    ZRO
*  RECCUR WILL POINT TO THE LOCATION OF A RECORD IN ACCOUNTING FILE
RECCUR  ZRO
CPTOP   ZRO

*WRITE LAST RECORD READ

WREC    ZRO
        SKN     RECFB
        BRU     WREC1
        BRM     ORECFA
        BRU     WREC2
WREC1   BRM     ORECF
WREC2   LDA     RECCUR
        MRG     =4B7
        SCP     RECFNO
        HLT     0
        LDA    =RECLEN
        LDX     =RECBUF
        BIO     RECFNO
        NOP
        LDA     RECFNO
        BRS     2
        BRR     WREC

*FILE OPENING ROUTINES

*GET INDEX BLOCK POINTER

GIP     ZRO
        LDB     =FILDAT
        LDX     =5
        BRS     96
        LDA     FILDAT
        ETR     =3777B
        CAX                    X NOW HAS THE FILE DIRECTORY NUMBER
        LDA     FILDAT+4       LOAD INDEX BLOCK PTR INTO A
        BRR     GIP
FILDAT  BSS     10

*** OPFIL:  OPEN A FILE IN WRITE MODE
***         STRING POINTER TO FILE NAME IN FILPT
***         FILE TYPE (BINARY, SYMBOLIC, ETC.) IN FILTYP
***         NO SKIP RETURN:    FAILURE WITH ERR NUMBER IN X
***         SKIP RETURN:       SUCCESS WITH FILE NUMBER IN A
***         IF FILE DOT EXIST, MAKE IT
***         IF FILE IS BUSY, TELL USER, WAIT, AND TRY TO OPEN AGAIN

OPFIL   ZRO
        CLA
        STA     BUSCNT
OPFI4   LDP     FILPT
        BRS     48
          BRU     OPFI1           (NOT THERE MAKE IT)
        BRM     GIP             (GET INDEX BLOCK POINTER)
        LDB     =42B            (OUTPUT WRITE MODE)
        BRS     193
          BRU     OPFI2           (FILE OPENING ERROR)
        MIN     OPFIL
        BRR     OPFIL          TAKE THE SKIP RETURN
OPFI1   LDP     FILPT
        MRG     PRIV
        LDX     FILTYP
        BRS     65
          BRU     OPFI2           (OPEN ERROR)
        MIN     OPFIL
        BRR     OPFIL
OPFI2   CXA
        SKE     =1              FILE BUSY (RECALL THAT ERR NUM WAS IN X)
          BRU     *+3
OPFI3   BRM     BUSY
        BRU     OPFI4
        SNE     =30             (GROUP BUSY)
          BRU     OPFI3
        BRR     OPFIL           (FAILED)

*FILE BUSY ROUTINE
*UNTIL SUCESSFUL IN OPENING FILE

BUSY    ZRO
        LDA     BUSCNT
        SKG     =10
        BRU     2BUSY
        MSG     FBUSY1          (FILE BUSY - WAITING)
        CLA
        STA     BUSCNT
2BUSY   MIN     BUSCNT
        LDA     =10000
        BRS     81
        BRR     BUSY
FBUSY1  ASC     '$FILE BUSY - WAITING$/'
BUSCNT  ZRO
FILTYP  ZRO

  IF      RCHG
    IF      DEBUG

* FILE POINTERS FOR DEBUGGING RCHARGE
BAREC  ASC '(HINCKLEYM)RECREMOTEA'     (SPOOL) IN PRODUCTION VERSION
BMTD   ASC '(HINCKLEYM)XXXBATXX'       (*4ACCT) IN PRODUCTION VERSION
PURGF  ASC "(HINCKLEYM)BREC'TMP'"      (SPOOL) IN PRODUCTION VERSION
VOIDF  ASC '(HINCKLEYM)VOIDREM'        (SPOOL) IN PRODUCTION VERSION
BRECP  DATA 3*BAREC-1,3*BAREC-1+20
BBRECP DATA 3*BAREC-1,3*BAREC-1+21
BMTDPT DATA 3*BMTD-1,3*BMTD-1+19
PURPT  DATA 3*PURGF-1,3*PURGF-1+20
VOIDPT DATA 3*VOIDF-1,3*VOIDF-1+18
SYSPTR DATA    3*BMTD-1+11
       DATA    3*BMTD-1+11
MONPTR DATA    3*BMTD-1+17
       DATA    3*BMTD-1+17
      ELSE
* FILE POINTERS FOR PRODUCTION VERSION OF RCHARGE
BAREC  ASC '(SPOOL)RECREMOTEA'
BMTD   ASC '(*4ACCT)XXXBATXX'
PURGF  ASC "(SPOOL)BREC'TMP'"
VOIDF  ASC '(SPOOL)VOIDREM'
BRECP  DATA 3*BAREC-1,3*BAREC-1+16
BBRECP DATA 3*BAREC-1,3*BAREC-1+17
BMTDPT DATA 3*BMTD-1,3*BMTD-1+16
PURPT  DATA 3*PURGF-1,3*PURGF-1+16
VOIDPT DATA 3*VOIDF-1,3*VOIDF-1+14
SYSPTR DATA    3*BMTD-1+8
       DATA    3*BMTD-1+8
MONPTR DATA    3*BMTD-1+14
       DATA    3*BMTD-1+14
      ENDF
    ELSE
      IF      DEBUG
* FILE POINTERS FOR DEBUGGING VERSION OF BCHARGE
BAREC  ASC     '(HINCKLEYM)RECBATCHA'  (*4ACCT) IN PRODUCTION VERSION
BMTD   ASC     '(HINCKLEYM)KKKBATKK'   (*4ACCT) IN PRODUCTION VERSION
PURGF  ASC     "(HINCKLEYM)BREC'TMP'"  (*4ACCT) IN PRODUCTION VERSION
VOIDF  ASC     '(HINCKLEYM)VOIDBAT'    (*4ACCT) IN PRODUCTION VERSION
BRECP   DATA   3*BAREC-1,3*BAREC-1+19
BBRECP  DATA   3*BAREC-1,3*BAREC-1+20
BMTDPT  DATA   3*BMTD-1,3*BMTD-1+19
PURPT   DATA   3*PURGF-1,3*PURGF-1+20
VOIDPT  DATA   3*VOIDF-1,3*VOIDF-1+18
SYSPTR  DATA   3*BMTD-1+11
        DATA   3*BMTD-1+11
MONPTR  DATA   3*BMTD-1+17
        DATA   3*BMTD-1+17
      ELSE
* FILE POINTERS FOR PRODUCTION VERSION OF BCHARGE
BAREC   ASC    '(*4ACCT)RECBATCHA'
BMTD    ASC    '(*4ACCT)KKKBATKK'
PURGF   ASC    "(*4ACCT)BREC'TMP'"
VOIDF   ASC    '(*4ACCT)VOIDBAT'
BRECP   DATA   3*BAREC-1,3*BAREC-1+16
BBRECP  DATA   3*BAREC-1,3*BAREC-1+17
BMTDPT  DATA   3*BMTD-1,3*BMTD-1+16
PURPT   DATA   3*PURGF-1,3*PURGF-1+17
VOIDPT  DATA   3*VOIDF-1,3*VOIDF-1+15
SYSPTR DATA   3*BMTD-1+8
       DATA   3*BMTD-1+8
MONPTR DATA   3*BMTD-1+14
       DATA   3*BMTD-1+14
      ENDF
    ENDF

FILPT   BSS     2

*OPEN (SPOOL)RECREMOTE  IN WRITE MODE -- FILE NUMBER STORED IN RECFNO
ORECF   ZRO
        LDP     BRECP
        STP     FILPT
        LDA     =2
        STA     FILTYP         SAY IT IS A BINARY FILE
        BRM     OPFIL          OPEN THE FILE IN WRITE MODE (BUT WILL ONLY READ)
        BRU     ORECF1          (FAILURE)
        STA     RECFNO
        CLA
        STA     RECFB           (FLAG AS RECREMOTE AS LAST FILE OPENED)
        CLA
        SCP     RECFNO         POINT TO BEGIN OF FILE AND SET TO READ
        HLT     0
        BRR     ORECF
ORECF1  MSG     MOREC
        MSG     MNOTIF
        BRS     10
MOREC   ASC     '$UNABLE OPEN BATCH RECORD FILE/'
MNOTIF  ASC     '$NOTIFY ACCOUNTING GROUP$/'
RECFNO  ZRO
* RECFB IS 0 WHEN (SPOOL)RECREMOTE WAS LAST FILE OPENED AND IS -1 WHEN
* RECREMOTEA WAS THE LAST FILE OPENED
RECFB   ZRO

*OPEN (SPOOL)RECREMOTEA IN WRITE MODE  -- FILE NUMBER STORED IN RECFNO
ORECFA  ZRO
        LDP     BBRECP
        STP     FILPT
        LDA     =2
        STA     FILTYP         SAY IT IS A BINARY FILE
        BRM     OPFIL          OPEN IT IN WRITE MODE 
          BRU     ORF1A           (FAILURE)
        STA     RECFNO
        LDA     =-1
        STA     RECFB           (FLAG AS RECREMOTEA AS THE LAST FILE OPENED)
        CLA
        SCP     RECFNO         POINT TO BEGIN OF FILE FOR READING
          HLT     0
        BRR     ORECFA
ORF1A   MSG     MOREC
        MSG     MNOTIF
        BRS     10             RETURN TO EXEC

*OPEN (*4ACCT)NNN-BAT-MO FILE (NNN IS SYSTEM NUMBER, -MO IS CURRENT MONTH)

OBMTD   ZRO 0; SKN MTDOPN; BRU *+2; BRR OBMTD
        LDP     BMTDPT
        STP     FILPT
        LDA     =2
        STA     FILTYP
        BRM     OPFIL
        BRU     OBMTD1          (FAILURE)
        STA     MTDFNO
        CLA
        SCP     MTDFNO
        HLT     0
       RSP     MTDFNO
       SKG     =RECLEN
       BRM     MAKTT9
       BRM     READT9
       CLA
       SCP     MTDFNO
       HLT 0
       LDA     =-1; STA MTDOPN (MAKE IT OPEN)
        BRR     OBMTD
OBMTD1  MSG     BOBMTD
        MSG     MNOTIF
        BRS     10
BOBMTD  ASC     '$UNABLE OPEN BATCH ACCOUNTING FILE/'
MTDFNO  ZRO

*
*      THIS ROUTINE MAKES INITIAL TRANS TYPE 9 AT LOC 0 OF MTDFNO
*
ACCREC BSS     RECLEN
MAKTT9 ZRO
       LDX =-RECLEN
       CLA; STA ACCREC+RECLEN,2; BRX *-1    (ZERO RECORD)
       CLAB; LDA =9; LSH 12; STA ACCREC
       LDA =99999; STA ACCREC+13            (JOBNO =99999)
       BRS     74; STA ACCREC+8             (PUT INTO DAYS DATE)
       LDA =-1; STA  ACCREC+6
       CLA; MRG =4B7; SCP MTDFNO; HLT 0     (SET TO WRITE)
       LDA =RECLEN; LDX =ACCREC; BIO MTDFNO; NOP; MIN MAKTT9; BRR MAKTT9

*
*      READTT READS RECORD 0 FROM MTD
*

READT9 ZRO
       CLA; SCP MTDFNO; HLT 0; LDA =RECLEN; LDX =ACCREC; BIO MTDFNO; NOP
       BRR READT9
*OPEN (*4ACCT)BREC'TMP'

OPURF   ZRO
        LDP     PURPT
        BRS     48
        BRU     *+2
        BRM     DELETE
        LDP     PURPT
        STP     FILPT
        LDA     =2
        STA     FILTYP
        BRM     OPFIL
        BRU     OPURF1          (ERROR)
        STA     FNO
        BRR     OPURF
OPURF1  MSG     MOPURF
        BRU     THRU
MOPURF  ASC     "UNABLE OPEN (*4ACCT)BREC'TMP', DELETE IT AND TRY AGAIN$/"

DELETE  ZRO
        BRS     69
        NOP
        BRR     DELETE

*OPEN (*4ACCT)VOIDBAT

OVOID   ZRO
        LDP     VOIDPT
        STP     FILPT
        LDA     =2
        STA     FILTYP
        BRM     OPFIL
        BRU     OVOID1          (FAILURE)
        STA     FNO1
        RSP     FNO1
        MRG     =4B7
        SCP     FNO1
        HLT     0
        BRR     OVOID
OVOID1  MSG     MOVOID
        BRU     THRU
MOVOID  ASC     'UNABLE OPEN (*4ACCT)VOIDBAT, DELETE IT AND TRY AGAIN$/'
FNO1    ZRO

*GET FILE DIRECTORY NUMBER OF *4ACCT

GAUN    ZRO
        LDX     =-4
        LDA     ANAME+4,2
        STA     NAME+4,2
        BRX     *-2
        BRM     GDIR
        STA     AUNO
        BRR     GAUN
GDIR    ZRO
        LDX     =-4
        CLA
        ADD     NAME+4,2
        BRX     *-1
        LRSH    23
        DIV     =887
        STB     BLNO
        BRM     RBLK
        BRU     GDIR2
RBLK    ZRO
        LDA     BLNO
        LRSH    23
        DIV     =128
        STB     TEMP
        CLB
        LSH     13
        ADD     =320200B
        ADD     TEMP
        CAB
        LDA     =BUF
        LDX     =100B
        BRS     124
        EAX     BUF
        BRR     RBLK
GDIR2   STX     BLX
        LDA     0,2
        SKE     =0
        BRU     *+2
        BRU     NOGOOD
        SKE     =-1
        BRU     *+4
        MIN     BLNO
        BRM     RBLK
        BRU     GDIR2
        SKE     =-2
        BRU     *+2
        BRU     GDIR3
        SKE     NAME
        BRU     GDIR3
        LDA     1,2
        SKE     NAME+1
        BRU     GDIR3
        LDA     2,2
        SKE     NAME+2
        BRU     GDIR3
        LDA     3,2
        SKE     NAME+3
        BRU     GDIR3
        LDA     4,2
        BRR     GDIR
GDIR3   EAX     9,2
        BRU     GDIR2
       IF      DEBUG
ANAME  ASC     'HINCKLEYM     '
       ELSE
ANAME   ASC     '*4ACCT      '
       ENDF
NAME    BSS     4
AUNO    ZRO
NOGOOD  MSG     NONO
        BRS     10
NONO    ASC     '$THIS PROGRAM CANNOT BE USED ON THIS SYSTEM$/'
PRIV    DATA    516B5
BLNO    ZRO
BLX     ZRO
BUF     BSS     100B
TEMP    ZRO

* READ A DECIMAL NUMBER FROM THE INPUT FILE
* TAKES A SKIP RETURN IF WE GET A NUMBER AND RETURNS TO CALLER+1 IF NOT
RDNO    ZRO
        LDX     CIN
        LDB     =10
        BRS     38
        XAB
        SNE     ='?'
        BRR     RDNO
        XAB
        MIN     RDNO
        BRR     RDNO

* WRITE A DECIMAL NUMBER TO THE OUTPUT FILE
TDNO    ZRO
        LDX     TOUT
        LDB     =10
        BRS     36
        BRR     TDNO

* WRITE A DECIMAL NUMBER TO THE PRIMARY OUTPUT FILE
TONO    ZRO
        LDX     TOUT
        LDB     =8
        BRS     36
        BRR     TONO

* WRITE A DECIMAL NUMBER TO THE FILE WHOSE NUMBER IS STORED IN FNO
PDNO    ZRO
        LDX     FNO
        LDB     =10
        BRS     36
        BRR     PDNO

* WRITE AN OCTAL NUMBER TO THE FILE WHOSE NUMBER IS STORED IN FNO
PONO    ZRO
        LDX     FNO
        LDB     =8
        BRS     36
        BRR     PONO

*ROUTINE TO GET COMPACTED BINARY DATE OF 2359 HOURS OF DAY ENTERED
*USED FOR LIMIT DATE IN SEARCHING FOR REQUESTS ENTERED PRIOR TO
*A GIVEN DATE

NUMSW   ZRO
ENDAT   ZRO
        SKN     NUMSW
        MSG     M4              (ENTER MONTH-DATE-YEAR)
        BRM     RDNO
        BRU     RESET
        SKG     =12
        SKG     =0
        BRU     RSTART
        STA     MO
        CLB
        SUB     =1
        LSH     16
        STA     HDAY
        BRM     RDNO
        BRU     RESET
        XAB
        SKE     =155B
        BRU     *+2
        BRU     RSTART
        XAB
        SKG     =31
        SKG     =0
        BRU     RSTART
        STA     DAY
        BRM     RDNO
        BRU     RESET
        XAB
        SKE     =155B
        BRU     RSTART
        XAB
        LRSH    23
        DIV     =1900
        CBA
        SKG     =71
        BRU     RSTART
        STA     YR
        LDA     DAY
        SUB     =1
        CLB
        MUL     =720
        CBA
        ADM     HDAY
        LDA     =1439
        ADM     HDAY
        LDA     YR
        SUB     =72
        CLB
        LSH     20
        ADM     HDAY
        CLB
        LDA     CZONE
        LSH     12
        MRG     KTCB
        CAX
        LDA     HDAY
        BRS     176
        STA     HDAY
        BRM     CKDAY
        BRR     ENDAT
CKDAY   ZRO
CKDAY1  LDA     HDAY
        CLB
        LDX     CKDAYX
        BRS     176
        CLA
        LSH     6
        SKE     =59
        BRU     *+2
        BRR     CKDAY
        LDA     =1
        MUL     =7500000
        LSH     1
        ADM     HDAY
        BRU     CKDAY1
CKDAYX  DATA    1200320B
KTCB    DATA    120B
HDAY    ZRO
RSTART  LDX     =-1
        BRS     11
        TCO     ='?'
        BRU     ENDAT+1

*LIST SUB COMMAND DISPATCHER

LIST    LDA     TERMCH
        SKE     =0
        BRU     OPTLST          (GET OPTION)
LIST1   LDA     =377B
        CIT     CIN
        SKG     =31B
        SKG     =17B
        BRU     *+2
        BRU     NUMLST          (LIST A SPECIFIED REQUEST)
        SNE     ='P'
        BRU     COMLST          (LIST PROCESSED REQUESTS)
        SNE     ='U'
        BRU     UNCLST          (LIST UNPROCESSED REQUESTS)
        SNE     ='N'
        BRU     LSTNUM          (LIST A SPECIFIED REQUEST)
        SNE     ='V'
        BRU     LVOID           (LIST VOIDED REQUESTS)
        SKE     ='?'
        BRU     LERR
        CIO     CIN
        BRU     RESET
LERR    LDX     =-1
        BRS     11
OPTLST  MSG     LM1             (PROCESSED, UNPROCESSED OR NUMBER)
        BRM     CLBUF
        BRU     LIST1
LSTNUM  CIO     CIN
        SKE     =155B
        BRU     LSTNUM
        MSG     LM2             (ENTER REQUEST NO)
        BRM     CLBUF
        BRU     LIST1
NUMLST  BRM     RDNO
        BRU     RESET
        STA     FJOB
        LDA     TOUT
        STA     FNO
        BRM     FNDREC
        BRU     TRYCOM
        BRM     PUCREC
        BRU     RESET
ORECSW  ZRO
CORSW   ZRO
NULLSW  ZRO
CRESW   ZRO

TRYCOM  MSG     LM4             (NO UNPROCESSED BY THAT NUMBER WILL TRY PROCESSED)
        SKR     ORECSW
        BRU     *-1
        BRM     GETREC
        BRU     TRYC2           (NOT FOUND)
        MSGP    LHEAD1
        BRM     CPREC
TRYC1   LDA     =*+2
        STA     GETREC
        BRU     GREC1
        BRU     CLIST2
        BRU     TRYC1-1
TRYC2   LDA     MTDFNO
       BRM CLOMTD
        MSG     LM5
TRYC5   BRM     FNDREC
        BRU     TRYC4           (NOT FOUND IN BATCHREC OR BATCHRECA)
TRYC3   MSG     LHEADV
        BRM     PVREC
        BRU     RESET
TRYC4   BRM     GVREC
        BRU     *+2             (NOT FOUND)
        BRU     TRYC3
        MSG     LM3             (NO RECORD BY THAT NUMBER)
        BRU     RESET

*GET RECORD FROM (*4ACCT)VOIDBAT

GVREC   ZRO
        BRM     OVOID
        CLA
        SCP     FNO1
        HLT
        RSP     FNO1
        STA     CPTOP
GVREC1  RCP     FNO1
        SNE     CPTOP
        BRU     GVREC2          (EOF)
        STA     RECCUR
        LDX     =RECBUF
        LDA     =RECLEN
        BIO     FNO1
        NOP
        SKN     LSTSW
        BRU     *+2
        BRU     GVREC3
        LDA     JOB
        SKE     FJOB
        BRU     GVREC1
        MIN     GVREC
GVREC2  LDA     FNO1
        BRS     2
        BRR     GVREC
GVREC3  MIN     GVREC
        BRR     GVREC

*TYPE OR PRINT A VOIDED REQUEST

PVREC   ZRO
        LDA     =155B
        CIO     FNO
        LDA     JOB
        BRM     LEADZ
        BRM     PDNO
        SPACE   1
        LDA     GAN
        BRM     JONO
        BRM     PONO
        SPACE   1
        LDA     =UNAME
        LDX     FNO
        LDB     =12
        BRS     34
        SPACE   1
        LDA     =PROJ
        LDX     FNO
        LDB     =12
        BRS     34
        SPACE   1
       LDA EDATE
        BRM     REQDAT
       SPACE 4
        LDA     =NCHR
        LDX     FNO
        LDB     =12
        BRS     34
        BRR     PVREC



UNCLST  CIO     CIN
        SNE     =0
        BRU     UNCL1
        SKE     =155B
        BRU     UNCLST
        BRU     UNCLX
UNCL1   LDA     =377B
        CIT     CIN
        SKG     =31B
        SKG     =17B
        BRU     UNCLY           (NOT A DATE?)
        SKR     NUMSW
        BRU     *-1
        BRM     ENDAT
        CLA
        STA     NUMSW
UNCL2   BRM     ORECF
        BRM     OPOUT
        SKR     LSTSW
        BRU     *-1
        CLA
        STA     LHSW
UNCL3   BRM     FNDREC
        BRU     UNCL7           (EOF)
        SKN     FLAG
        BRU     *+2
        BRU     UNCL5
        SKN     HDAY
        BRU     *+2
        BRU     UNCL4
        LDA     EDATE
        SKG     HDAY
        BRU     UNCL4
        BRU     UNCL5
UNCL4   BRM     PUCREC
UNCL5   LDA     =*+2
        STA     FNDREC
        BRU     FREC1
        BRU     UNCL7           (EOF)
        SKN     FLAG
        BRU     *+2
        BRU     UNCL5
        SKN     HDAY
        BRU     *+2
        BRU     UNCL6
        LDA     EDATE
        SKG     HDAY
        BRU     UNCL6
        BRU     UNCL5
UNCL6   BRM     PUCREC
        BRU     UNCL5
UNCL7   LDA     MTDFNO
       BRM CLOMTD
        LDA     =155B
        CIO     FNO
        MSG     MEOF
        BRU     RESET
UNCLY   SNE     ='A'
        BRU     UNCLZ
        CIO     CIN
        SKE     =155B
        BRU     *-2
UNCLX   MSG     M7              (ALL?)
        BRM     YN
        BRU     UNCLX1
UNCLX2  LDA     =-1
        STA     HDAY
        BRU     UNCL2
UNCLX1  BRM     ENDAT
        BRU     UNCL2
UNCLZ   CIO     CIN
        SKE     =155B
        BRU     UNCLZ
        BRU     UNCLX2

LHSW    ZRO
PUCREC  ZRO
        SKN     LHSW
        BRU     *+2
        BRU     PUCR1
        MSGP    LHEAD
        SKR     LHSW
        BRU     *-1
PUCR1   LDA     =155B
        CIO     FNO
        LDA     JOB
        BRM     LEADZ
        BRM     PDNO
        SPACE   1
        LDA     GAN
        BRM     JONO
        BRM     PONO
        SPACE   1
        LDA     =UNAME
        LDX     FNO
        LDB     =12
        BRS     34
        SPACE   1
        LDA     =PROJ
        LDX     FNO
        LDB     =12
        BRS     34
        SPACE   1
       LDA     EDATE
       BRM     REQDAT
        LDA     FLAG
        SNE     =1
        BRU     SPMSG1
        SNE     =2
        BRU     SPMSG2
        SNE     =3
        BRU     SPMSG3
       SNE     =4
       BRU     HOLMSG
        BRR     PUCREC
HOLMSG MSG     HMSG
       BRR     PUCREC
SPMSG1  MSG     SPM1
        BRR     PUCREC
SPMSG2  MSG     SPM2
        BRR     PUCREC
SPMSG3  MSG     SPM1
        BRR     PUCREC
HMSG   ASC     '$RECORD AWAITING POSTAGE CHARGES/'
SPM1    ASC     '$SPOOL RECORD AWAITING POSTAGE CHARGES/'
SPM2    ASC     '$COMPLETE SPOOL RECORD/'
RDX     DATA    1200300B
REQDAT  ZRO
       SPACE 3
        LDX     RDX
        BRS     176
        ABC
        LSH     10
        ADD     =60
        STA     YR
        CLA
        LSH     4
        ADD     =1
        STA     MO
        CLA
        LSH     5
        ADD     =1
        STA     DAY
        LDA     MO
        LRSH    23
        DIV     =10
        ADD     =20B
        CIO     FNO
        CBA
        ADD     =20B
        CIO     FNO
        LDA     ='-'
        CIO     FNO
        LDA     DAY
        LRSH    23
        DIV     =10
        ADD     =20B
        CIO     FNO
        CBA
        ADD     =20B
        CIO     FNO
        LDA     ='-'
        CIO     FNO
        LDA     YR
        BRM     PDNO
        BRR     REQDAT
LM1     ASC     '$PROCESSED,UNPROCESSED,VOIDED, OR NUMBER? /'
LM2     ASC     '$ENTER REQUEST NO: /'
LM3     ASC     '$UNABLE LOCATE AN REQUEST BY THAT NUMBER$/'
LM4     ASC     '$NO UNPROCESSED REQUEST BY THAT NUMBER WILL TRY PROCESSED FILE$/'
LM5     ASC     '$NO PROCESSED REQUEST BY THAT NUMBER WILL LOOK FOR VOIDED RECORD$/'

*GET A RECORD FROM (*4ACCT)/BMTD/, REQUEST NO IN A REGISTER UPON ENTRY
*NO SKIP NOT FOUND, SKIP FOUND AND IN CRECBF

GETREC  ZRO
        SKN     LSTSW
        BRM     OBMTD
        CLA
        SCP     MTDFNO
        HLT     0
        RSP     MTDFNO
        STA     CPTOP
GREC1   SKN     CORSW
        BRU     *+2
        BRU     GREC1A
        LDX     =-RECLEN
        CLA
        STA     CRECBF+RECLEN,2
        BRX     *-1
GREC1A  RCP     MTDFNO
        SNE     CPTOP
        BRU     GREC2           (NOT FOUND)
        STA     CCUR            (SAVE FOR POSSIBLE WRITE)
       LDA     =RECLEN
       LDX     =CRECBF
       BIO     MTDFNO
       NOP
        LDA     CUUN
        SNE     =-1
        BRU     GREC1
        SKN     LSTSW
        BRU     *+3
        MIN     GETREC
        BRR     GETREC
        LDA     CJOB
        SKE     FJOB
        BRU     GREC1
        MIN     GETREC
        SKN     ORECSW
        BRU     *+2
        BRR     GETREC
GREC2   LDA     MTDFNO
       BRM CLOMTD
        BRR     GETREC

RSTG    ZRO
        WIO     MTDFNO
        STA*    POINT
        MIN     POINT
        BRM     B200
        BRR     RSTG
        BRU     RSTG+1
B200    ZRO
        STA     SAVA
        LDA     =200B
        LDB     =377B
        LDX     =-3
B200A   SKM     SAVA
        BRU     *+2
        BRR     B200
        LCY     8
        BRX     B200A
        MIN     B200
        BRR     B200
GRECER  ZRO
        SKN     MSGSW
        BRU     *+2
        BRR     GRECER
        SKR     MSGSW
        BRU     *-1
        MSG     MGREC
        MSG     MNOTIF
        BRR     GRECER
MSGSW   ZRO
MGREC   ASC     '$FILE FORMAT ERROR IN BATCH ACCOUNTING FILE/'

CRECBF  BSS    RECLEN
CRECST EQU     CRECBF
CUNAME EQU     CRECBF+1
CTYPE  EQU     CRECBF
CGAN   EQU     CRECBF+5
CUUN   EQU     CRECBF+6
CHOST  EQU     CRECBF+7
CDATE  EQU     CRECBF+8
CPROJ  EQU     CRECBF+9
CJOB   EQU     CRECBF+13
CREQBY EQU     CRECBF+14
CCHR   EQU     CRECBF+18
CPAGE  EQU     CRECBF+19
CPART  EQU     CRECBF+20
CCARPR EQU     CRECBF+21
CFILPR EQU     CRECBF+21
CTAPPU EQU     CRECBF+22
CTAPCO EQU     CRECBF+23
CDECCO EQU     CRECBF+24
CCUREN EQU     CRECBF+25
CDELCH EQU     CRECBF+26
CEMPTR EQU     CRECBF+27
POINT   ZRO
POINT1  ZRO
CCUR    ZRO

LSTSW   ZRO
COMLST  CIO     CIN
        SKE     =155B
        BRU     COMLST
        BRM     OBMTD
        SKR     LSTSW
        BRU     *-1
        BRM     OPOUT
        MSGP    LHEAD1
CLIST1  BRM     GETREC
        BRU     CLIST2
        BRM     CPREC
CLIST3  LDA     =*+2
        STA     GETREC
        BRU     GREC1
        BRU     CLIST2
        BRM     CPREC
        BRU     CLIST3
CLIST2  LDA     MTDFNO
       BRM CLOMTD
        LDA     =155B
        CIO     FNO
        MSG     MEOF
        BRU     RESET
MEOF    ASC     '$$END OF FILE$/'

CPREC   ZRO
       IF RCHG; LDA CTYPE; ETR =7777B;  SKE =9; BRR CPREC; ENDF
       BRM     PRIPRO
       BRR CPREC
PPART   ZRO
        LDA     ='-'
        CIO     FNO
        LDA     CPART
        BRM     PDNO
        BRR     PPART

PSTG    ZRO
PSTG1   LDB*    POINT
        MIN     POINT
        CLA
        LDX     =-3
PSTG2   LSH     8
        SNE     =200B
        BRR     PSTG
        MIN     BUSCNT
        CIO     FNO
        CLA
        BRX     PSTG2
        LDA     BUSCNT
        SKE     =12
        BRU     PSTG1
        BRR     PSTG

*OPEN OUTPUT FILE

OPOUT   ZRO
        LDX     =-1
        LDA     =4B4
        BRS     12
        MSG     M5              (OUTPUT TO)
        BRM     CLBUF
        LDA     CIN
        LDX     =3
        BRS     63
        BRU     OPOUT1
        STA     FNO
        BRR     OPOUT
OPOUT1  LDX     =-1
        BRS     11
        BRU     OPOUT+1

LEADZ   ZRO
        CAB
        SKG     =9999
        BRM     LZERO
        SKG     =999
        BRM     LZERO
        SKG     =99
        BRM     LZERO
        SKG     =9
        BRM     LZERO
        CBA
        BRR     LEADZ
LZERO   ZRO
        LDA     =20B
        CIO     FNO
        CBA
        BRR     LZERO
JONO    ZRO
        CAB
        SKG     =77777B
        SPACE   1
        SKG     =7777B
        SPACE   1
        SKG     =777B
        SPACE   1
        SKG     =77B
        SPACE   1
        SKG     =7
        SPACE   1
        CBA
        BRR     JONO
JDNO5   ZRO
        SKG     =9999
        SPACE   1
        SKG     =999
        SPACE   1
        SKG     =99
        SPACE   1
        SKG     =9
        SPACE   1
        BRR     JDNO5
JDNO4   ZRO
        SKG     =999
        SPACE   1
        SKG     =99
        SPACE   1
        SKG     =9
        SPACE   1
        BRR     JDNO4
JDNO2   ZRO
        SKG     =9
        SPACE   1
        BRR     JDNO2
PDOLS   ZRO
        LRSH    23
        DIV     =100
        STB     CENTS
        BRM     JDNO4
        BRM     PDNO
        LDA     ='.'
        CIO     FNO
        LDA     CENTS
        SKG     =9
        BRM     PZERO
        BRM     PDNO
        BRR     PDOLS
PZERO   ZRO
        CAB
        LDA     =20B
        CIO     FNO
        CBA
        BRR     PZERO
CENTS   ZRO

*YES NO ROUTINE CALLED AS MSG, BRM YN NO SKIP NO SKIP YES IF NEITHER
*REPEATS QUESTION

YN      ZRO
        BRM     CLBUF
        CIO     CIN
        CAB
        CIO     CIN
        SNE     =155B
        BRU     YN1
        SKE     =152B
        BRU     *-4
YN1     CBA
        SNE     ='?'
        BRU     RESET
        SNE     ='N'
        BRR     YN
        SKE     ='Y'
        BRU     *+3
        MIN     YN
        BRR     YN
       SKN     ALLHOL
       BRU     YN2
       SKE     ='H'
       BRU     YN2
       LDA     =-1
       STA     HOLDSW
       MIN     YN
       MIN     YN
       BRR     YN
YN2     SKN     CINSW
        BRU     YNERR
        LDA     YN
        SUB     =2
        STA     YN
        LDX     =-1
        BRS     11
        BRR     YN
YNERR   MSG     M6
        BRU     THRU
*LIST VOIDED REQUESTS

LVOID   CIO     CIN
        SNE     =0
        BRU     LVOID1
        SKE     =155B
        BRU     LVOID
        BRU     LVOIDX
LVOID1  LDA     =377B
        CIT     CIN
        SKG     =31B
        SKG     =17B
        BRU     LVOIDY          (NOT A NUMBER)
        BRM     RDNO
        BRU     RESET
        STA     FJOB
        BRU     *+2
LVOID2  BRM     GREQNO
        SKR     ORECSW
        BRU     *-1
        BRM     FNDREC
        BRU     *+2
        BRU     TRYC3
        BRU     TRYC4
LVOIDX  MSG     M7              (ALL)
        BRM     YN
        BRU     LVOID2
        SKR     LSTSW
        BRU     *-1
        SKR     ORECSW
        BRU     *-1
        BRM     ORECF
        BRM     OPOUT
        CLA
        STA     LHSW
        BRM     FNDREC
        BRU     LVOID4          (NOT IN PEND. FILE)
LVOID8  SKN     LHSW
        MSGP    LHEADV
        SKR     LHSW
        BRU     *-1
        BRM     PVREC
LVOID3  LDA     =*+2
        STA     FNDREC
        BRU     FREC1
        BRU     LVOID4          (EOF PENDING FILES)
        BRU     LVOID8
LVOID4  LDA     RECFNO
        BRS     2
        BRM     GVREC
        BRU     LVOID7          (EOF VOID FILE)
LVOID5  SKN     LHSW
        MSGP    LHEADV
        SKR     LHSW
        BRU     *-1
        BRM     PVREC
LVOID6  LDA     =*+2
        STA     GVREC
        BRU     GVREC1
        BRU     LVOID7          (EOF VOID FILE)
        BRU     LVOID5
LVOID7  LDA     FNO1
        BRS     2
        MSG     MEOF
        BRU     RESET
LVOIDY  CIO     CIN
        SKE     =155B
        BRU     LVOIDY
        BRU     LVOIDX


*PURGE PROCESSED AND VOIDED REQUESTS FROM BATCHREC AND BATCHRECA

PURGE   BRS     113
        BRM     ORECF
        BRM     OPURF
        LDA     =4B7
        SCP     FNO
        HLT     0
PURGE1  WIO     RECFNO
        SNE     =27657537B
        BRU     PURGE2
        WIO     FNO
        BRU     PURGE1
PURGE2  LDA     RECFNO
        BRS     2
        BRM     ORECFA
PURGE3  WIO     RECFNO
        SNE     =27657537B
        BRU     PURGE4
        WIO     FNO
        BRU     PURGE3
PURGE4  LDA     RECFNO
        BRS     2
        LDP     BRECP
        BRS     48
        HLT     0
        BRM     DELETE
        LDP     BBRECP
        BRS     48
        HLT     0
        BRM     DELETE
PURGE5  CLA
        SCP     FNO
        HLT     0
        BRM     OVOID
        BRM     ORECF
        LDA     =4B7
        SCP     RECFNO
        HLT     0
        RSP     FNO
        STA     CPTOP
PURGE6  RCP     FNO
        SNE     CPTOP
        BRU     PURGE7
        LDX     =RECBUF
        LDA     =RECLEN
        BIO     FNO
        NOP
        LDA     FLAG
        SNE     =0
        BRU     MOVE
        SNE     =1
        BRU     MOVE
       SNE     =4              4=> HOLD RECORD
       BRU     MOVE
        SKE     =-2
        BRU     PURGE6
        LDA     =RECLEN
        LDX     =RECBUF
        BIO     FNO1
        NOP
        BRU     PURGE6
MOVE    LDX     =RECBUF
        LDA     =RECLEN
        BIO     RECFNO
        NOP
        BRU     PURGE6
PURGE7  LDA     RECFNO
        BRS     2
        LDA     FNO1
        BRS     2
        LDA     FNO
        BRS     2
        MSG     M8              (PURGE COMPLETED)
        BRU     RESET

*GET PASSWORD NAME AND VERIFY

VER     ZRO
        SKN     VERSW
        BRR     VER
        BRS     71             SKIP IF USER HAS SET SYSTEM OR EXEC STATUS
        BRU     VER1A
        SKR     STASW
        BRU     *-1            NOTE THAT HE HAS SET STATUS
        BRU     VER1B
VER1A   LDP     SFPTR
        BRS     48
        BRU     ERV1
        LDB     =SFBUF
        LDX     =4
        BRS     96
        LDA     =4
        SKA     SFBUF+3
        BRU     *+2
        BRU     ERV2
        LDP     SFPTR
        BRS     64
        BRU     OPFER
        STA     SFIL
        CLA
        SCP     SFIL
        HLT     0
VER1B   MSG     VM1             (ENTER NAME)
        LDA     VPTR1
        STA     VPTR1+1
        LDA     =VPTR1
        LDB     =155B
        CLX
        BRS     33
        SKN     STASW          SYSTEM OR EXEC STATUS SET?
        BRU     *+4            NOPE--FORCE VALIDATION OF PASSWORD
        BRM     EDVER          STATUS IS SET--JUST GET HIS NAME
        MIN     VERSW
        BRR     VER
        LDA     VPTR1+1
        SUB     VPTR1
        STA     VT1
VER1    CIO     SFIL
        SKE     =137B
        BRU     *+2
        BRU     NONAME
        SKE     =155B
        BRU     VER1
        CIT     SFIL
        BRU     *+2
        BRU     NONAME
        LDA     VPTR2
        STA     VPTR2+1
        LDA     =VPTR2
        LDB     =155B
        LDX     SFIL
        BRS     33
        LDA     VPTR2+1
        SUB     VPTR2
        SKG     =0
        BRU     NONAME
        SKE     VT1
        BRU     VER1
        LDP     VPTR2
        SKSE    VPTR1
        BRU     VER1
        GCI     VPTR1
        HLT     0
        SKR     VPTR1
        NOP
        STA     VXT8
        BRM     FONO
        SKA     =40000B
        BRU     *+2
        BRU     ERV3
        SKA     =1B7
        BRU     *+2
        BRU     ERV3
        ETR     =377B
        STA     DIST
        BRM     FONO
        STA     VT1
        BRM     FONO
        STA     VT2
        LDA     SFIL
        BRS     20
        LDX     =-1
        LDA     =3
        BRS     12
        MSG     VM2             (ENTER YOUR PASSWORD PLEASE)
SGPS    LDP     TERMWD
        STP     VXT1
        STP     VXT3
        STB     VXT5
        CLA
        STA     TLV1
        LDA     VXT8
        ADM     VXT3
GPS     LDA     =20
        STA     TLV11
GPS1    LDX     TLV1
        LDA     VXT1,2
        MUL     =6065B
        DIV     =37777761B
        CBA
        ADD     VXT2,2
        CAB
        ETR     =3
        STA     TLV1
        LDA     VXT1,2
        XAB
        STP     VXT1,2
        LDA     VXT5
        XMA     VXT1
        STA     VXT5
        SKR     TLV11
        BRU     GPS1
        CIO     =0
        SKE     =155B
        BRU     *+2
        BRU     *+3
        ADM     VXT1
        BRU     GPS
        LDX     =-1
        LDA     =4B4
        BRS     12
        LDA     VXT1
        ADD     VXT2
        SKE     VT1
        BRU     NOPASS
        LDA     VXT3
        ADD     VXT4
        SKE     VT2
        BRU     NOPASS
        BRM     EDVER
        MIN     VERSW
        BRR     VER

* READ AN OCTAL NUMBER FROM SFIL
FONO    ZRO
        LDB     =8
        LDX     SFIL
        BRS     38
        BRR     FONO

TLV1    ZRO
TLV11   ZRO

VERSW   DATA    -1
STASW  DATA    0
DIST    ZRO
NOPASS  MSG     VME5
        LDX     =-1
        LDA     =3
        BRS     12
        BRU     SGPS

NONAME  MSG     VME6
        BRU     VERRET


TERMWD  DATA    27657537B,55555555B

SFPTR   DATA    3*SF-1,3*SF+5
SF      ASC     '()PSWD'
VPTR1   DATA    3*OPNAM-1,3*OPNAM-1
OPNAM   BSS     20
VPTR2   DATA    3*BUF2-1,3*BUF2-1
BUF2    BSS     20
SFBUF   BSS     20
VT1     ZRO
VT2     ZRO
VXT1    ZRO
VXT2    ZRO
VXT3    ZRO
VXT4    ZRO
VXT5    ZRO
VXT8    ZRO
SFIL    ZRO
ERV1    MSG     VME1
ERV     MSG     VME
        BRU     VERRET
ERV2    MSG     VME2
        BRU     ERV
OPFER   MSG     VME3
        BRU     VERRET
ERV3    MSG     VME4
        BRU     VERRET
VERRET  LDX     =-20
        CLA
        STA     OPNAM+20,2
        STA     BUF2+20,2
        STA     SFBUF+20,2
        BRX     *-3
        BRU     RESET

EDVER   ZRO
        LDP     VPTR1
        BRM     EDLIN
        STP     VPTR1
        BRR     EDVER
EDLIN   ZRO
        STP     EDPT
EDLIN2  GCD     EDPT
        BRU     EDLIN1
        SKE     =200B
        BRU     *+2
        BRU     EDLIN2
        SKE     =377B
        BRU     *+2
        BRU     EDLIN2
        SKG     =0
        BRU     EDLIN2
        MIN     EDPT+1
EDLIN1  LDP     EDPT
        BRR     EDLIN
EDPT    BSS     2
VME1    ASC     '$NO PASSWORD FILE/'
VME     ASC     '$NOTIFY DIVISION OPNS MGR AND SYS. GROUP TECH DIV/'
VME2    ASC     '$PASSWORD FILE STATUS LOST/'
VME3    ASC     '$PASSWORD FILE BUSY-TRY LATER$/'
VME4    ASC     '$UNVALIDATED NAME/'
VM1     ASC     '$YOUR NAME: /'
VM2     ASC     '$YOUR PASSWORD: /'
VME5    ASC     '$ERROR, TYPE PASSWORD /'
VME6    ASC     '$NAME DOES NOT APPEAR IN PASSWORD FILE$/'

*MAKE A CHARGE RECORD AND WRITE INTO (*4ACCT)/BMTD/

CHG     LDA     TERMCH
        SKE     =155B
        BRU     CHGOPT         GET THE OPTION (EITHER A NUMBER OR ALL)
CHG1   LDA     =-1
*      STA     VERSW           LETS FORCE VALIDATION
        BRM     VER            IF VERSW IS NEGATIVE, GET PASSWORD AND VERIFY
        BRM     CKSPL           (CHECK FOR COMPLETED SPOOL REC)
        LDA     =1
        STA     FNO
        SKN     ALLSW
        BRU     *+2
        BRU     CHGALL         WE ARE DOING ALL RECORDS, SO GO BACK TO CHGALL
        SKN     CNUMSW
CHG2    BRM     GREQNO         ASK FOR A REQUEST NUMBER (WILL BE STORED IN FJOB)
        CLA
        STA     CNUMSW
        STA     HTOTAL
        STA     ACCUM
        BRM     FNDREC         FIND THE REQUESTED RECORD
        BRU     ECHG1C          (COULD NOT FIND)
CHG22  LDP     TOTAL           COPY TOTAL INTO A REG AND VOL INTO B REG
       BRM     RECVT
       STA     HTOTAL
       STA     ACCUM
       SNE     =0
       BRU     CHG2B
       LDA     =-1
       STA     AGINSW
CHG2B   LDA     =HOLD
        STA     PTRB
CHG2C   BRM     PUCREC
        MSG     M9              (OKAY?)
        BRM     YN
        BRU     ECHG1A          (NOT THE ONE)
CHG2E  BRM GLDIST
       LDA TDIST               PUT DISTRICT IN A AND NOW CHECK IT
* SET FRENCSW, UKSW, GERSW, AND BELGSW IN ACCORD WITH CUSTOMER'S DISTRICT
*CHG2E   LDA     TDIST          LOOK UP THE DISTRICT
        SKG     =79
        SKG     =69
        BRU     *+3
CHG2A   BRM     FRENCH
        BRU     CHG3A
        SKG     =189
        SKG     =179
        BRU     *+3
        BRM     ENG
        BRU     CHG3A
       SKG     =199            GERMANY IS DIST 190-199
       SKG     =189
       BRU     *+3             EITHER US OR BELGIUM
       BRM     GERMAN
       BRU     CHG3A
       SKG     =39             CHECK FOR BELG
       SKG     =29             STILL CHECKING 30-39
       BRU     CHGUS           MUST BE US
       SKE     =31             IS THIS BELGIUM
       BRU     *+3
       BRM     BELGIU          THIS IS BELGIUM
       BRU     CHG3A           CHARGE IT
       BRM     FRENCH          EVERY ON ELSE IN AREA 30 IS FRENCH
       BRU     CHG3A           CHG IT
CHGUS   CLA                    THIS IS US
        STA     FRENSW
       STA     GERSW
       STA     BELGSW
        STA     UKSW
        BRU     CHG3A
BELGIU ZRO
       SKR     BELGSW
       BRU     *-1
       CLA
       STA     UKSW
       STA     FRENSW
       STA     GERSW
       BRR     BELGIU
* MAKE FRENCSW NEGATIVE AND CLEAR UKSW, GERSW, AND BELGSW
FRENCH ZRO
FR1    SKR     FRENSW
       BRU     *-1
       CLA
       STA     UKSW
       STA     GERSW
       STA     BELGSW
  IF BCHG
       LDA     SAWFRN
       SKE     =0              HAS USER BEEN TOLD THIS IS AN AREA 7 CUSTOMER?
         BRR     FRENCH        YES, SO RETURN
       LDA     =-1
       STA     SAWFRN          INDICATE THAT WE HAVE TOLD USER THIS ONE IS FREN
       MSG     FRNMSG          AND NOW TELL HIM
  ENDF
       BRR     FRENCH
* SAWFRN IS -1 WHEN PROGRAM USER HAS BEEN TOLD THIS IS AN AREA 7 USER
SAWFRN ZRO
FRNMSG ASC     '$THIS IS AN AREA 7 CHARGE.  EFFECTIVE SEPTEMBER 1, 1978:'
       ASC     '$USE JOB TYPES 4 AND 5 FOR STORE AND RESTORE.'
       ASC     '$USE JOB TYPE 8 FOR TAPE CONVERSION.$/'

ENG     ZRO
        SKR     UKSW
        BRU     *-1
        CLA
        STA     FRENSW
       STA     BELGSW
       STA     GERSW
        BRR     ENG
GERMAN ZRO
       SKR     GERSW
       BRU     *-1
       CLA
       STA     FRENSW
       STA     UKSW
       STA     BELGSW
       BRR     GERMAN
CHG3A   LDA     FLAG
       SNE     =4              RECORD AWAITING TRANS /POST CHG
       BRU     SPR2
        SKA     =1
        BRU     SPOREC          (SPOOLING RECORD)
        SNE     =3
        BRU     SPOREC          (ALSO A SPOOLING RECORD)
CHG3    MSG     M10            ASK FOR BATCH TYPE
        BRM     CLBUF          CLEAR INPUT BUFFER UP TO NEXT CARRIAGE-RETURN
        BRM     RDNO           GET A NUMBER FROM THE INPUT FILE
        BRU     RESET          DID NOT GET A NUMBER SO GO GET A FRESH COMMAND
        SKG     =13
        SKG     =0
        BRU     CHG4
        STA     TYPE           TYPE WILL BE >0 AND <14
        CAX
       MRG =10000B; STA TYPE   AND TYPE NOW HAS THE FULL TRANSACTION CODE
        BRU*    BRUTAB,2       ADDITIONAL PROCESSING FOR EACH TYPE
CHG4    LDX     =-1
        BRS     11             FLUSH INPUT BUFFER
        BRU     CHG3           ASK FOR BATCH TYPE AGAIN

BRUTAB  DATA    BADX,PRINT,RDCARD,PCARD,RTAPE,WTAPE,BADX,TAPEC,TAPEIO
       DATA    BADX,BADX,BADX,TAPBUY,ENDCHG

BADX   MSG     ILLTYP          ILLEGAL BATCH TYPE
       BRU     CHG3              SO ASK FOR IT AGAIN

PRINT   MSG     M11             (PAGES)
        BRM     CLBUF
        BRM     RDNO
        BRU     RESET
        STA     NPAG
PRINT1 LDA     =1              ASSUM NO DEC CHG
       STA     DECCOL
        MSG     M12             (NO. OF PARTS)
        BRM     CLBUF
        BRM     RDNO
        BRU     RESET
        SKG     =4             MAXIMUM OF 4-PART PAPER ALLOWED
        SKG     =0             NO 0-PART OR NEGATIVE-PART PAPER ALLOWED
        BRU     PRINT1
        STA     PARTS          NO. OF PARTS IS REASONABLE, SO STORE IT
        SNE     =1
        BRU     ANOTH
PRINT2  MSG     M13             (WERE LISTING DECOLLATED)
        BRM     YN
        BRU     ANOTH
        LDA     =2
       STA     DECCOL
       BRU     ANOTH
PRINT3 LDA =1
       STA DECCOL
ANOTH  SKN     AGINSW
       BRU     *+2
       BRU     ENDCHG
        MSG     M16             (ANOTHER BATCH TYPE FOR THIS REQUEST)
        BRM     YN
        BRU     ENDCHG          (NO)
        BRM     MOVREC
        CLAB
       STP     RECBUF+18
       STP     RECBUF+20
       STP     RECBUF+22
       STP     RECBUF+24
       STP     RECBUF+26
       LDA     =-1
       STA     TWOFLG
        BRU     CHG3
ENDCHG CLA
       SKN     NULLSW          DO NOT ALLOW ON REC
       LDA     =-1
       STA     ALLHOL          ALLOW HOLD COMMAND HERE ONLY!
       MSG     M14             (ANY TRANSPORTATION CHARGES)
        BRM     YN
        BRU     END2           NO ENTERED
       BRU     END1            YES ENTERED
       LDA     =4
       STA     FLAG
       BRU     END2
END1    MSG     M15             (ENTER AMOUNT)
END1A   BRM     RAMT
        BRM     CHECK

        SKG     =MINPOS
        SKG     =0
        BRU     *+2
        BRU     ECHG1B
END2    CLA
       STA     ALLHOL          DO NOT ALLOW HOLD TO BE ENTERED
ECHG1  NOP
        BRM     MOVREC
        MSG     M26             (ALL ENTRIES CORRECT
        BRM     YN
        BRU     AGAIN
       SKN     TWOFLG          -1=> WRITE SOME RECS TO /BMTD/
       SKN     HOLDSW          -1=> HOLD IT IN BREC,BRECA
        BRM     WCHG
        SKN     NULLSW
        BRU     *+2
        BRU     ECHG1A
       LDA     FLAG
       SKN     HOLDSW
        LDA     =-1
        STA     FLAG
        BRM     WREC
ECHG1A CLA; STA HOLDSW
        SKN     ALLSW
        BRU     *+2
        BRU     CHGA1
        SKN     NULLSW
        BRU     *+2
        BRU     NULL6
        SKN     CRESW
        BRU     *+2
        BRU     RESET
        MSG     M17             (ANOTHER REQUEST)
        BRM     YN
        BRU     RESET
       CLA; STA HOLDSW
        BRU     CHG2
ECHG1B  MSG     M31
        LDX     =-1
        BRS     11
        BRU     END1
T1      ZRO
ECHG1C  MSG     M28
        LDX     =-1
        BRS     11
        BRU     ECHG1A

AGAIN   SKN     NULLSW
        BRU     *+2
        BRU     NULL5
        SKN     CRESW
        BRU     *+2
        BRU     RESET
        MSG     M27             (REENTER ALL DATA)
        LDX     =-1
        BRS     11
        CLAB
       STP     RECBUF+18
       STP     RECBUF+20
       STP     RECBUF+22
       STP     RECBUF+24
       STP     RECBUF+26
        SKN     ALLSW
        BRU     CHG2
        LDA     =HOLD
        STA     PTRB
        BRU     CHG2C
PTRA    ZRO
PTRB    ZRO
CPTRA   ZRO
HOLD    EQU     20000B

* COPY THE CURRENT RECORD INTO CORE BEGINNING AT LOC SPECIFIED BY PTRB
MOVREC  ZRO
        LDA     =RECBUF
        STA     PTRA
        LDX     =-RECLEN
MR1     LDA*    PTRA
        STA*    PTRB
        MIN     PTRA
        MIN     PTRB
        BRX     MR1
        BRR     MOVREC

*SPECIAL HANDLING OF SPOOL RECORDS
*SPOOL RECORD FLAG VALUES
*1=SPOOL RECORD NEEDING POSTAGE ONLY
*2=COMPLETED SPOOL RECORD NEEDS MOVING TO PROCESSED FILE ONLY
*3=SPOOL RECORD RATES NOT ESTABLISHED

SPOREC  LDA     FLAG
        SNE     =3
        BRU     STCOLL
        LDA     PARTS
        ETR     =7777B
        SNE     =0
        BRU     SPR1
        MUL     =100
        LSH     23
        ADM     ACCUM
        ADM     HTOTAL
SPR1    LDA     PARTS
        LRSH    12
        BRM     ADJTYP
        CAX
        CLA     CHGBUF,2
        STA     HRATE
        BRM     CALC
        ADM     ACCUM
        ADM     HTOTAL
SPR2    MSG     M19             (ENTER POSTAGE OR TRANSPORTATION CHARGE:)
        BRU     END1A
STCOLL  LDA     PARTS
        LRSH    12
        SKG     =1
        BRU     SPR1
        LDA     =5
        BRM     ADJTYP
        CAX
        CLA     CHGBUF,2
        LRSH    23
        DIV     FACTOR
        ADM     ACCUM
        ADM     HTOTAL
        LRSH    23
        DIV     =100
        ADM     PARTS
        BRU     SPR1

*
*      US      => ADD          0
*      FRENCH  => ADD          50
*      UK      => ADD          100
*      BELGIUM => ADD          150
*      GERMANY => ADD          200
*
ADJTYP  ZRO
        SKN     FRENSW
        BRU     *+3
        ADD     =50
        BRR     ADJTYP
        SKN     UKSW
       BRU     *+3
        ADD     =100
        BRR     ADJTYP
       SKN     BELGSW
       BRU     *+3
       ADD     =150
       BRR     ADJTYP
       SKN     GERSW
       BRR     ADJTYP
       ADD     =200
       BRR     ADJTYP

FACTOR DATA    100             THIS IS FACTOR TO DIVIDE BY
CALC    ZRO
        LDA     VOL
        MUL     HRATE
        DIV    FACTOR
        BRR     CALC

WCHG    ZRO
       SKN     HOLDSW
       BRU     WCHG1
       LDA     PTRB
       SUB     =RECLEN
       STA     PTRB
       CLA
       STA     TWOFLG
WCHG1   BRM     OBMTD
        RSP     MTDFNO
        MRG     =4B7
        SCP     MTDFNO
        HLT     0
        LDA     PTRB
        SUB     =HOLD
        LDX     =HOLD
        BIO     MTDFNO
        NOP
        CLA
        SCP     MTDFNO
        HLT     0
       LDA =HOLD; STA PT1
WCHG2  LDB =ACCRC1; STB PT2
       BRM MOVACC              (MOVE 1 RECORD TO ACCRC1
       BRU     WCHG5           (NO MORE)
       BRM     ADDMTD
       BRU WCHG2
WCHG5  BRM WRACCT
        LDA     MTDFNO
       BRM CLOMTD
        BRR     WCHG

*
*      WRACC WRITES THE TRANSACTIONS TYPE 9 TO RECORD 1 OF THE FILE
WRACCT ZRO
       LDA =-1; STA ACCREC+6
       CLA; MRG =4B7; SCP MTDFNO; HLT 0; LDA =RECLEN; LDX =ACCREC; BIO MTDFNO
       NOP 0; CLA; SCP MTDFNO; NOP 0; BRR WRACCT

*
*
*      MOVACC CHECKS TO SEE IF PT1 IS EQUAL TO PTRB IF SO RET
*              ELSE SKIP AFTER MOVING RECLEN WDS TO ACCRC1
*

PT1    ZRO
PT2    ZRO
ACCRC1 BSS     RECLEN

MOVACC ZRO
       LDA PT1
       SNE PTRB
       BRR     MOVACC
       LDX =-RECLEN
       LDA*    PT1
       STA*    PT2
       MIN     PT1
       MIN     PT2
       BRX *-4
       MIN MOVACC
       BRR MOVACC

RAMT    ZRO
        BRM     CLBUF
        BRM     RDNO
        BRU     RESET
        STB     TERMCH
        MUL     =100
        LSH     23
        STA     WORK
        LDA     TERMCH
        SNE     ='.'
        BRU     RAMT1
        LDX     =-1
        BRS     11
        TCO     ='?'
        LDA     RAMT
        SUB     =2
        STA     RAMT
        BRR     RAMT
RAMT1   BRM     RDNO
        BRU     RESET
        ADD     WORK
       STA     POST
       BRM     WHACUR
        BRR     RAMT
WORK    ZRO
MINMUM  ZRO
HRATE   ZRO
HPARTS  ZRO
*CHARGE OF READING CARDS

RDCARD  MSG     M20             (NUMBER OF CARDS)
        BRM     CLBUF
        BRM     RDNO
        BRU     RESET
        STA     CARPRO
       BRU     ANOTH

*CHARGE OF PUNCHING CARDS

PCARD   BRU     RDCARD

*CHARGE FOR TAPE TO DISC WORK

RTAPE   SKN     UKSW
        BRU     *+2
        BRU     BADTYP
       SKN     BELGSW
       BRU     *+2
       BRU     BADTYP
       SKN     GERSW
       BRU     *+2
       BRU     BADTYP
        MSG     M21             (NUMBER OF FILES)
        BRM     CLBUF
        BRM     RDNO
        BRU     RESET
       STA     FILPRO
       BRU     ANOTH

*CHARGE OF DISC TO TAPE WORK

WTAPE  SKN     UKSW         CHECK TO SEE IF A NON-FRENCH EUROPEAN USER
         BRU   *+2
       BRU     BADTYP
       SKN     BELGSW
         BRU     *+2
       BRU     BADTYP
       SKN     GERSW
         BRU     *+2
       BRU     BADTYP
       BRM     TAPGOT
*WTAPE BRM     TAPGOT
       BRU     RTAPE

* TAPGOT ASKS ABOUT NUMBER OF TAPES

TAPGOT ZRO
       MSG     M25
       BRM CLBUF
       BRM RDNO
       BRU     RESET
       STA     TAPPUR
       BRR     TAPGOT
*TAPE CONVERSION CHARGE

TAPEC  SKN     BELGSW           BELGIUM USER TYPE 8
       BRU     *+2
       BRU     BADTYP
       SKN     FRENSW
       BRU     *+2
       BRU     BADTYP
       SKN     GERSW
       BRU     *+2
       BRU     BADTYP
       SKN     UKSW
       BRU     *+2
       BRU     BADTYP
       BRM     TAPGOT
       MSG     M21             (NUMBER OF FILES)
       BRM CLBUF
       BRM     RDNO
       BRU     RESET
       STA     FILPRO
       MSG     CC1
       BRM     CLBUF
       BRM     RDNO
       BRU     RESET
       STA     TAPCON
       BRU     ANOTH

*SPECIAL TAPE OR OTHER IO BASED ON INPUT RATE PER 100K CHARS

FACT1  DATA    100000
TAPEIO SKN     BELGSW           BELGIUM USER TYPE 8
       BRU     *+2
       BRU     TAPIO
       SKN     FRENSW
       BRU     *+2
       BRU     TAPIO
       SKN     GERSW
       BRU     *+2
       BRU     TAPIO
       SKN     UKSW
       BRU     *+2
       BRU     TAPIO
       BRU     BADUST
TAPIO  BRM TAPGOT
       STA     TPUR            SAVE HERE UNTIL END CHARGE
TAPE1   MSG     M23             (NUMBER OF CHARACTERS)
        BRM     CLBUF
       BRM     RDNO
       BRU     RESET
       STA     NCHR
        BRU     ANOTH
TPUR   ZRO
HVOL    ZRO

*TAPE PURCHASE

TAPBUY BRM     TAPGOT
       BRU     ANOTH

MDADUS ASC     'TYPE 8 ONLY USED FOR FOREIGN DISTRICT USERS$/'
BADUST MSG MDADUS
       BRU BADT1
MBADT  ASC     'FOREIGN REQUEST- USE TYPE 8$/'
BADTYP  MSG    MBADT
BADT1   LDX     =-1
        BRS     11
        BRU     CHG3

CHGOPT  LDA     =377B          THIS INSURES THAT THE CIT WILL NEVER SKIP
        CIT     CIN            COPY NEXT INPUT CHAR INTO THE A REGISTER
        SKG     =31B           SKIP IF INPUT CHAR IS ALPHABETIC OR CONTROL
        SKG     =17B           IF THIS TEST IS PERFORMED AND SKIPS FOUND A NO.
        BRU     *+2
        BRU     CHGNUM         WE FOUND A NUMBER
        CAB                    PUT THE (NON-NUMERIC) CHAR IN B REGISTER
        CIO     CIN            GET NEXT CHAR FROM INPUT FILE
        SKE     =155B          SKIP IF IT WAS A CARRIAGE-RETURN
        BRU     *-2            GET ANOTHER CHAR
        CBA                    PUT THE SAVED CHAR BACK IN A REGISTER
        SKE     ='A'           SKIP IF IT IS AN 'A'
        BRU     CHG1            (DONT KNOW WHAT HE WANTED LETS GO THE REGULAR ROUTE)
        SKR     ALLSW
        BRU     *-1            IF ALLSW WAS NON-NEGATIVE SET IT TO BE -1
        BRU     CHG1             AND RETURN TO (NEAR) TOP OF CHARGE ROUTINE
CHGNUM  BRM     RDNO           GET A DECIMAL NUMBER FROM THE INPUT FILE
        BRU     RESET          WE GOT NON-NUMERIC INPUT SO GET A NEW COMMAND
        STA     FJOB           STORE THE NUMBER IN FJOB
        SKR     CNUMSW
        BRU     *-1            IF CNUMSW WAS NON-NEGATIVE SET IT TO -1
        BRU     CHG1           RETURN TO (NEAR) TOP OF CHARGE ROUTINE

*ALL OPTION ON CHARGE PRESENT EACH RECORD TO SEE IF HE WANTS TO COMPLETE

ALLCUR  ZRO
CHGALL  CLA
        STA     HTOTAL         SET HTOTAL TO ZERO
        STA     ACCUM          LIKEWISE FOR ACCUM
        BRM     FNDREC         FIND UNPROCESSED RECS BEGINNING WITH 0
        BRU     CHGA2          DIDN'T FIND A RECORD
        BRU     CHG22          FOUND A RECORD, SO RETURN TO MAIN CHARGE ROUTINE
CHGA1   CLA
        STA     HTOTAL         SET HTOTAL TO 0
        STA     ACCUM          AND SET ACCUM TO 0
        SKN     RECFB          SKIP IF RECREMOTEA WAS LAST FILE OPENED
        BRM     CHGA3          WE WILL SKIP FROM HERE IF CAN'T OPEN RECREMOTE
        BRM     CHGA4          TRY TO OPEN RECREMOTEA
        LDA     ALLCUR         LOAD A WITH THE SAVED CURSOR POSITION
        ETR     =@4B7
        SCP     RECFNO         SET THE CURSOR POSITION IN RECORD FILE
        HLT     0
        LDA     =*+2
        STA     FNDREC         SET UP THE RETURN ADDRESS FROM FNDREC
        BRU     FREC1          START UP FNDREC AT FREC1 INSTEAD OF TOP
        BRU     CHGA2          GO TO CHGA2 IF WE COULDN'T FIND THE RECORD
        BRU     CHG2B          RECORD FOUND
CHGA2   MSG     MEOF           (END OF FILE)
        BRU     RESET          GO GET ANOTHER COMMAND
CHGA3   ZRO
        BRM     ORECF
        MIN     CHGA3
        BRR     CHGA3
CHGA4   ZRO
        BRM     ORECFA
        BRR     CHGA4


*ROUTINE TO VOID A SPECIFIED UNPROCESSED REQUEST, OPERATORS NAME
*IS PUT INTO CELLS NORMALLY RESERVED FOR POSTAGE AND TOTALS

VOID    LDA     TERMCH
        SKE     =155B
        BRU     VOIDNO
VOID1   BRM     VER
        SKN     CNUMSW
VOID2   BRM     GREQNO
        CLA
        STA     CNUMSW
        BRM     FNDREC
        BRU     VOIMIS
        LDX     =-4
        LDA     OPNAM+4,2
        STA    NCHR+4,2
        BRX     *-2
        LDA     =-2
        STA     FLAG
        BRM     WREC
        BRU     RESET
VOIDNO  LDA     =377B
        CIT     CIN
        SKG     =31B
        SKG     =17B
        BRU     VOIDN1          (NOT A NUMBER SO TAKE HIM REGULAR ROUTE)
        BRM     RDNO
        BRU     RESET
        STA     FJOB
        SKR     CNUMSW
        BRU     *-1
        BRU     VOID1
VOIDN1  CIO     CIN
        SKE     =155B
        BRU     VOIDN1
        BRU     VOID1
VOIMIS  MSG     MVOID
        BRU     RESET
MVOID   ASC     '$UNABLE LOCATE AN UNPROCESSED RECORD BY THAT NUMBER$/'

* ASK FOR A REQUEST NUMBER AND STORE IT IN FJOB (ABORT AND RETURN TO
* COMMAND LEVEL IF WE DON'T GET A NUMBER)
GREQNO  ZRO
        MSG     M3
        BRM     CLBUF
        BRM     RDNO
        BRU     RESET
        STA     FJOB
        BRR     GREQNO

HTOTAL  ZRO
ACCUM   ZRO
TDIST   ZRO
CNUMSW  ZRO
UKSW    ZRO
FRENSW  ZRO
BELGSW ZRO
GERSW  ZRO
ALLSW   ZRO
THRU    BRS     147
        BRS     114
        MSG     MTHRU
        BRS     10
MTHRU   ASC     '$$E.O.J.$/'

* PRINT THE HELP MESSAGE AND RETURN TO COMMAND DISPATCHER
HEL     MSG     MHELP
  IF BCHG
        LDA     SYSNO
        SNE     =14            OMIT HELP FOR MAKE COMMAND IF NOT SYSTEM 14
        MSG     MHELP1         WE ARE ON SYSTEM 14 SO GIVE HELP FOR MAKE CMD
  ENDF
        MSG     MHELP2
        BRU     RESET          GO GET ANOTHER COMMAND

MHELP   ASC     '$$VALID COMMANDS ARE:'
        ASC     '$$LIST #           -    LIST THE KNOWN INFORMATION FOR REQUEST #.'
        ASC     '$                      THE INFORMATION CAN BE PRINTED ON THE'
        ASC     '$                      TELETYPE OR TO A FILE.  (THIS APPLIES'
        ASC     '$                      TO THE OTHER LIST COMMANDS ALSO.)'
        ASC     '$$LIST PROCESSED   -    LIST THE KNOWN INFORMATION FOR ALL'
        ASC     '$                      PROCESSED REQUESTS.'
        ASC     '$$LIST UNPROCESSED -    *LIST THE KNOWN INFORMATION FOR ALL'
        ASC     '$                      UNPROCESSED REQUESTS.'
        ASC     '$$LIST VOID        -    LIST THE KNOWN INFORMATION FOR ALL'
        ASC     '$                      VOIDED REQUESTS.'
       IF      RCHG
        ASC     '$$CHARGE #         -    INPUT POSTAGE CHARGES FOR REQUEST #.'
        ASC     '$                      (UNPROCESSED REQUESTS ONLY.)'
        ASC     '$$CHARGE ALL       -    INPUT POSTAGE CHARGES FOR ALL'
        ASC     '$                      UNPROCESSED REQUESTS.'
        ASC     '$$CORRECT #        -    ADD OR CORRECT POSTAGE CHARGES FOR'
        ASC     '$                      AN ALREADY PROCESSED REQUEST.'
       ELSE
        ASC     '$$CHARGE #         -    PRESENT THE UNPROCESSED REQUEST # FOR'
        ASC     '$                      INPUT OF CHARGES.'
        ASC     '$$CHARGE ALL       -    PRESENT ALL UNPROCESSED REQUESTS'
        ASC     '$                      FOR INPUT OF CHARGES.'
        ASC     '$$RECHARGE #       -    RE-ENTER ALL DATA FOR A PROCESSED'
        ASC     '$                      REQUEST.  THE OLD RECORDS WILL BE'
        ASC     '$                      INVALIDATED.'
        ASC     '$$POSTAGE #        -    ADD OR CORRECT POSTAGE CHARGES'
        ASC     '$                      FOR PROCESSED REQUEST #.'
        ASC     '$$CREATE           -    CREATE A BATCH CHARGE FROM INFORMATION'
        ASC     '$                      THAT YOU GIVE THE PROGRAM.'
       ENDF
        ASC     '$$VOID #           -    VOID THE UNPROCESSED REQUEST #./'
  IF BCHG
MHELP1  ASC     '$$MAKE             -    CREATE A BATCH CHARGE (INCLUDING THE'
        ASC     '$                      REQUEST NUMBER) FROM INFORMATION'
        ASC     '$                      THAT YOU GIVE THE PROGRAM./'
  ENDF
MHELP2  ASC     '$$PURGE            -    PURGE ALL PROCESSED AND VOIDED REQUESTS'
        ASC     '$                      FROM THE RECORD FILE.'
        ASC     '$$QUIT OR Q        -    QUIT (RETURN) TO THE EXEC.'
        ASC     '$$HELP OR ?        -    REPRINT THIS LIST.'
        ASC     '$$COMMANDS MAY BE SHORTENED TO THE FIRST THREE CHARACTERS.'
        ASC     '$$* IF THIS COMMAND INCLUDES A DATE ONLY UNPROCESSED REQUESTS'
        ASC     '$  CREATED ON OR BEFORE THIS DATE WILL BE LISTED.$$/'

*CHECK FOR COMPLETED SPOOL RECORDS TEMPORARLY DEPOSITED INTO BATCHREC
*BECAUSE SPOOL PROGRAM COULD NOT GET TO /BMTD/

CKSPL   ZRO
        SKR     SPLSW
        BRU     *-1            SET SPLSW TO -1
        BRM     FNDREC         FIND THE RECORD
        BRU     CKSPL3          DIDN'T FIND A RECORD
        BRU     CKSPL2         GOT A RECORD
CKSPL1  SKN     RECFB          SKIP IF WE OPENED RECREMOTEA
        BRM     CHGA3
        BRM     CHGA4
*  ?? THE NEXT 8 INSTRUCTIONS CAN NEVER BE CALLED!! ??
        LDA     ALLCUR
        ETR     =@4B7
        SCP     RECFNO
        HLT     0
        LDA     =*+2
        STA     FNDREC
        BRU     FREC1
        BRU     CKSPL3          (THRU)
CKSPL2  LDA     FLAG
        SKE     =2
        BRU     CKSPL1         FLAG NOT= 2, SO GO BACK TO CHG (SPLSW STILL -1)
       LDB =HOLD; STB PTRB
        BRM     MOVREC         COPY RECBUF INTO LOCATION SPECIFIED BY HOLD
        BRM     WCHG           WRITE OUT AN ENTRY
        LDA     =-1
        STA     FLAG           SET FLAG TO -1
        BRM     WREC           WRITE THE LAST RECORD READ
        BRU     CKSPL1         RETURN TO CHG ROUTINE (SPLSW STILL IS -1)
CKSPL3  CLA
        STA     SPLSW          RESET SPLSW TO 0
        BRR     CKSPL
SPLSW   ZRO
*IF NEG CHECKING ON COMPLETED SPOOL RECORDS

*CHECK FOR AMOUNTS OVER 500.00 WHEN TAKING ABSOLUTE AMOUNTS FOR CHARGES

CHECK   ZRO
        SKG     =50000
        BRR     CHECK
        STA     CT1
CHECK1  MSG     M30             (ARE YOU SURE YOU WANT TO CHARGE)
        LDA     CT1
        BRM     PDOLS
        TCO     ='?'
        TCO     =0
        BRU     *+2
        BRU     CHECK1
        BRM     YN
        BRU     CHECK2
        LDA     CT1
        BRR     CHECK
CHECK2  LDA     CHECK
        SUB     =3
        STA     CHECK
        BRR     CHECK

*ALLOW CORRECTION OF PREVIOUSLY ENTERED TRANSPORTATION CHARGES

COR     LDA     TERMCH
        SNE     =155B
        BRU     COR1
        BRM     RDNO
        BRU     RESET
        STA     FJOB
        SKR     CNUMSW
        BRU     *-1
COR1   LDA     =-1
*      STA     VERSW
        BRM     VER
        LDA     =1
        STA     FNO
        SKN     CNUMSW
COR2    BRM     GREQNO
       BRM     FNDREC
       BRU     COR2AA
       LDA FLAG
       SKE =4
       BRU COR2AA
       BRU CORHOL
COR2AA  CLA
        STA     CNUMSW
        SKR     ORECSW
        BRU     *-1
        SKR     CORSW
        BRU     *-1
        BRM     GETREC
       BRU     CORNON
        BRM     MVREC
        LDA     CCUR
        STA     CORCUR
COR3    LDA     =*+2
        STA     GETREC
        BRU     GREC1
        BRU     COR3A
        BRU     COR3-3
COR3A   LDA     MTDFNO
       BRM CLOMTD
        BRM     RECMV
        MSGP    LHEAD1
        BRM     CPREC
        MSG     M9              (OKAY)
        BRM     YN
        BRU     CORNO1
COR4    LDP     TOTAL
        BRM     RECVT
        STA     ACCUM
        LDP     POST
       STA     CT1
        BRM     RECVT
        SKG     =0
        BRU     COR5
        STA     T1
        LDA     ACCUM
        SUB     T1
        STA     ACCUM
COR5    MSG     CORM1           (ENTER NEW TRANSPORTATION CHARGES)
        BRM     RAMT
        BRM     CHECK
        SKG     =MINPOS
        SKG     =0
        BRU     *+2
        BRU     COR5A
        MSG     M26             (ALL ENTRIES CORRECT)
        BRM     YN
        BRU     CORAGN
       BRM     OBMTD           LETS READ CURRENT STUFF
       LDA ACCREC+26; SUB CT1; ADD POST; STA ACCREC+26
        BRM     RWREC
        BRU     CORNO1
COR5A   MSG     M31
        LDX     =-1
        BRS     11
        BRU     COR5

CLC1   ASC     '$PLEASE USE THE CHARGE COMMAND$/'
CORHOL MSG CLC1
       BRU CORNO1
CORNON  MSG     LM3
CORNO1  LDA     MTDFNO
       BRM CLOMTD
        BRU     RESET

MVREC   ZRO
        LDX     =-RECLEN
        LDA    CRECST+RECLEN,2
        STA    TYPE+RECLEN,2
        BRX     *-2
        BRR     MVREC
RECMV   ZRO
        LDX     =-RECLEN
        LDA    TYPE+RECLEN,2
        STA    CRECST+RECLEN,2
        BRX     *-2
        BRR     RECMV

CORAGN  LDX     =-1
        BRS     11
        BRU     COR4
CORM1   ASC     '$ENTER NEW TRANSPORTATION CHARGES: /'
CORCUR  ZRO

*REWRITE A CORRECTED RECORD FROM RECBUF

RWREC   ZRO
        BRM     OBMTD
        LDA     CORCUR          (SAVED CURSOR POSITION)
        MRG     =4B7
        SCP     MTDFNO
        HLT     0
        LDX     =RECBUF
        LDA     =RECLEN
        BIO     MTDFNO
        NOP
        BRR     RWREC

*RECHARGE FIRST LOCATE ALL RECORDS FOR A REQUEST AND SAVE CURSOR POSITIONS
*USING A COPY SET UP IN RECBUF AND TAKE NEW CHARGES AND WRITE INTO /BMTD/
*THEN USING SAVE CURSOR POSITIONS INVALIDATE THE OLD RECORDS

NULL    SKR     NULLSW
        BRU     *-1
        LDA     TERMCH
        SNE     =155B
        BRU     NULL1
        BRM     RDNO
        BRU     RESET
        STA     FJOB
        SKR     CNUMSW
        BRU     *-1
NULL1  LDA     =-1             FORCE VALIDATION OF PSSWD
*      STA     VERSW
        BRM     VER
        LDA     =1
        STA     FNO
        SKN     CNUMSW
NULL2   BRM     GREQNO
        CLA
        STA     CNUMSW
        LDA     =CURBUF
        STA     CPTRA
        SKR     ORECSW
        BRU     *-1
        BRM     GETREC
        BRU     CORNON
        LDA     CCUR
        STA*    CPTRA
        MIN     CPTRA
        MSG     LHEAD1
        BRM     CPREC
        BRM     MVREC           (SAVE A COPY)
NULL3   LDA     =*+2
        STA     GETREC
        BRU     GREC1
        BRU     NULL4           (NO MORE)
        LDA     CCUR
        STA*    CPTRA
        MIN     CPTRA
        BRM     CPREC
        BRU     NULL3
NULL4   LDA     MTDFNO
       BRM CLOMTD
        LDA     =-1
        STA*    CPTRA
        MSG     M9              (OKAY)
        BRM     YN
        BRU     RESET           (NOT THE ONE HE WANTS)
NULL5   LDA     =HOLD
        STA     PTRB
        CLAB
       STP     RECBUF+18
       STP     RECBUF+20
       STP     RECBUF+22
       STP     RECBUF+24
       STP     RECBUF+26
        MSG     M27             (RE-ENTER ALL DATA)
        LDX     =-1
        BRS     11
        BRU     CHG2E
NULL6   BRM     GETREC
        HLT     0               (THERE MUST BE ONE)
        BRM     CKCUR
        BRU     NULL7
        BRM     BLANK
NULL7   LDA     =*+2
        STA     GETREC
        BRU     GREC1
        BRU     NULL8           (DONE)
        BRM     CKCUR
        BRU     NULL7
        BRM     BLANK
        BRU     NULL7

NULL8  BRM     CLOMTD
       MSG     NM1
       BRU     RESET
NM1     ASC     '$CORRECTIONS COMPLETED$/'
CKCUR   ZRO
        LDA     =CURBUF
        STA     CPTRA
CKCUR1  LDA*    CPTRA
        MIN     CPTRA
        SNE     =-1
        BRR     CKCUR
        SKE     CCUR
        BRU     CKCUR1
        STA     CORCUR
        MIN     CKCUR
        BRR     CKCUR
BLANK   ZRO
        BRM     MVREC
        LDA     =-1
        STA    UUN
        LDA     =*+2
        STA     RWREC
        BRU     RWREC+2
        RCP     MTDFNO
        ETR     =@4B7
        SCP     MTDFNO
        HLT     0
       BRM     SUBACC
       BRR     BLANK
ADDMTD ZRO
       CLA; STA ACCREC+25; STA ACCRC1+25    (ZERO CURRENCY USED)
       LDX =-8; LDA ACCRC1+27,2; ADM ACCREC+27,2; BRX *-2; BRR ADDMTD
        BRR     BLANK


*
*
SUBACC ZRO ; LDX =-8; CLA; STA ACCREC+25; STA RECBUF+25
SUB1 STX CT1; LDA ACCREC+27,2; SUB RECBUF+27,2; LDX CT1
       STA ACCREC+27,2; BRX SUB1; BRR SUBACC

CURBUF  BSS     50


*ALLOW USER TO CREATE A BATCH REQUEST CHARGE

CREATE  BRM     VER
        LDX     =-RECLEN
        CLA
        STA     RECBUF+RECLEN,2
        BRX     *-1
        SKR     CRESW
        BRU     *-1
        MSG     MCR1            (ENTER USER NAME TO BE CHARGED)
        BRM     GTNAME
        BRM     VCUST
        BRU     RESET           (NOT VALID)
        MSG     MCR2            (ENTER NAME OF REQUESTOR)
        BRM     GTREQB
        MSG     MCR3            (ENTER PROJECT CODE)
        BRM     GPROJ
        BRM     NOREQ
        STA     JOB
        MSG     MCR4            (ASSIGNED REQUEST NO)
        LDA     JOB
        BRM     TDNO
       BRS     74; STA EDATE
        LDA     =HOLD
        STA     PTRB
       LDA SYSNO
       STA HOST
        BRU     CHG2E

MCR1    ASC     '$ENTER USER NAME TO BE CHARGED: /'
MCR2    ASC     '$ENTER NAME OF THE REQUESTOR: /'
MCR3    ASC     '$ENTER PROJECT CODE: /'
MCR4    ASC     '$ASSIGNED REQUEST NO. /'
MCR5    ASC     '$ENTER REQUEST NUMBER: /'
MCR6    ASC     '$ENTER DISTRICT: /'
MCR7    ASC     '$ENTER CUSTOMER NUMBER: /'
MCR8    ASC     '$ENTER GAN: /'
MCR9    ASC     '$INVALID REQUEST NUMBER$/'

*MAKE AN ALL NEW REQUEST

MAKE    LDA     SYSNO
        SKE     =14
       BRU     ERR
        BRM     VER
       LDA     TOUT
       STA     FNO
        LDX     =-RECLEN
        CLA
        STA     RECBUF+RECLEN,2
        BRX     *-1
        SKR     CRESW
        BRU     *-1
MAKE3   MSG     MCR5            GET THE REQUEST NUMBER
        BRM     RDNO
        BRU     RESET
        STA     JOB
        LRSH    23
        DIV     =1000
        STB     T
        SKG     =26
        SKG     =0
        BRU     MAKERR
        LDA     T
        SKG     =999
        SKG     =0
        BRU     MAKERR
        MSG     MCR1            GET THE USER NAME
        BRM     GTNAME
        BRM     VCUST
        BRU     RESET
        MSG     MCR2            GET THE REQUESTOR NAME
        BRM     GTREQB
        MSG     MCR3            GET THE PROJECT CODE
        BRM     GPROJ
MAKE2  BRS 74; STA EDATE
        LDA     =HOLD
        STA     PTRB
        LDA    SYSNO
        STA     HOST
        BRU     CHG2E

MAKERR  MSG     MCR9            (INVALID REQUEST NUMBER)
        LDX     =-1
        BRS     11
        BRU     MAKE3
T       ZRO     0               TEMP CELL


MKNUM   ZRO
        CLA
        STA     WKWORD
        LDA     SYSNO
        LRSH    23
        DIV     =10
        STA     WKWORD
        CBA
        XMA     WKWORD
        MUL     =10
        LSH     23
        ADM     WKWORD
        LDA     REQNO
        LRSH    23
        DIV     =10
        STB     T3
        LRSH    23
        DIV     =10
        STB     T2
        XMA     WKWORD
        MUL     =10
        LSH     23
        ADM     WKWORD
        LDA     T2
        XMA     WKWORD
        MUL     =10
        LSH     23
        ADM     WKWORD
        LDA     T3
        XMA     WKWORD
        MUL     =10
        LSH     23
        ADM     WKWORD
        LDA     WKWORD
        BRR     MKNUM
WKWORD  ZRO
T2      ZRO
T3      ZRO

NOREQ   ZRO
        BRM     OBNUM
        LDA     NUMFNO
        SNE     =-1
        BRU     NOREQ3          (FILE NEVER OPENED)
        WIO     NUMFNO
        SNE     =0
        BRU     NOREQ2
        SKG     =999
        BRU     *+2
        BRU     NOREQ2
NOREQ1  STA     REQNO
        LDA     =4B7
        SCP     NUMFNO
        HLT     0
        LDA     REQNO
        ADD     =1
        SNE     =1000
        LDA     =1
        WIO     NUMFNO
        LDA     NUMFNO
        BRS     2
        BRU     NOREQ4
NOREQ2  BRS     42
        ETR     =77B
        BRU     NOREQ1
NOREQ3  BRS     42
        ETR     =77B
        STA     REQNO
NOREQ4  BRM     MKNUM
        BRR     NOREQ
REQNO   ZRO

VCUST   ZRO
        CLA
        LDX     =-4
        ADD     UNAME+4,2
        BRX     *-1
        LRSH    23
        DIV     =887
        STB     BLNO
        CBA
        SKG     =895
        BRU     *+2
        HLT
VCUST1  LDA     BLNO
        LRSH    23
        DIV     =128
        STB     NTEMP
        CLB
        LSH     13
        ADD     =320200B
        ADD     NTEMP
        CAB
        LDA     =LBUF
        LDX     =100B
        BRS     124            WE NOW HAVE THE DISK ADDRESS FOR THE
*                              CUSTOMER'S LUD, SO READ IN THE INFO
        EAX     LBUF
VCUST2  LDA     0,2
        SKE     =0
        BRU     *+2
        BRU     VCUSTB
        SKE     =-1
        BRU     *+3
        MIN     BLNO
        BRU     VCUST1
        SKE     =-2
        BRU     *+2
        BRU     VCUST3
        SKE     UNAME
        BRU     VCUST3
        LDA     1,2
        SKE     UNAME+1
        BRU     VCUST3
        LDA     2,2
        SKE     UNAME+2
        BRU     VCUST3
        LDA     3,2
        SKE     UNAME+3
        BRU     VCUST3
        LDA     6,2
        ETR     =1777777B
        STA     GAN            WE NOW HAVE THE GENERAL ACCT USER FOR CUSTOMER
       LDA 7,2; ETR =377777B; STA UUN   GET AND SAVE CUSTOMER'S UUN
        LDA 8,2; LRSH 2; ETR =3777B; STA TDIST   GET DISTRICT
        MIN     VCUST
        BRR     VCUST          TAKE THE SKIP RETURN TO CALLER
VCUST3  EAX     9,2
        BRU     VCUST2
NTEMP   ZRO
VCUSTB  MSG     BCUST
        BRR     VCUST
BCUST   ASC     '$NOT A VALID USER ON THIS SYSTEM/'
LBUF    BSS     100B
GTSTG   ZRO
        CLA
        STA     STGCNT
        LDX     =-4
        STA*    POINT
        MIN     POINT
        BRX     *-2
        BRM     CLBUF
GTSTG1  CIO     CIN
        SNE     =155B
        BRR     GTSTG
        SNE     =152B
        BRR     GTSTG
        WCI     WKPTR
        MIN     STGCNT
        LDA     STGCNT
        SKE     =12
        BRU     GTSTG1
GSTG2   CIO     CIN
        SNE     =155B
        BRR     GTSTG
        SNE     =152B
        BRR     GTSTG
        BRU     GSTG2
WKPTR   BSS     2
STGCNT  ZRO

GTNAME  ZRO
        LDA     =UNAME
        STA     POINT
        BRM     MKPTR
        STP     WKPTR
        BRM     GTSTG
        BRR     GTNAME

GTREQB  ZRO
        LDA     =REQBY
        STA     POINT
        BRM     MKPTR
        STP     WKPTR
        BRM     GTSTG
        BRR     GTREQB

GPROJ   ZRO
        LDA     =PROJ
        STA     POINT
        BRM     MKPTR
        STP     WKPTR
        BRM     GTSTG
        BRR     GPROJ

MKPTR   ZRO
        MUL     =3
        LSH     23
        SUB     =1
        CAB
        BRR     MKPTR

OBNUM   ZRO
        LDP     BNUMP
        STP     FILPT
        LDA     =2
        STA     FILTYP
        BRM     OPFIL
        BRU     OBNUM1
        STA     NUMFNO
        CLA
        SCP     NUMFNO
        HLT     0
        BRR     OBNUM
OBNUM1  LDA     =-1
        STA     NUMFNO          (FLAG TO INDICATE WAS UNABLE OPEN NUMBER FILE)
        BRR     OBNUM
NUMFNO  ZRO

  IF DEBUG
BNUM   ASC     '(HINCKLEYM)@BATCHNUM1'
BNUMP  DATA    3*BNUM-1,3*BNUM-1+21
    ELSE
BNUM    ASC     '(*1BATCH)@BATCHNUM1'
BNUMP   DATA    3*BNUM-1,3*BNUM-1+19
  ENDF

TOTAL  ZRO
VOL    ZRO
DATE   ZRO
*
*      THIS ROUTINE IS TO PRINT THE PROCESSED RECORD
*

PRIPRO ZRO
       LDA =155B; CIO FNO
       LDA CJOB; BRM LEADZ; BRM PDNO (REQ. NUM.); SPACE 1
       LDA CGAN; BRM JONO; BRM PONO; SPACE 1
       LDA =CUNAME; LDB =12; LDX FNO; BRS 34; SPACE 1
       LDA =CPROJ ; LDB =12; LDX FNO; BRS 34; SPACE 1
       LDA CDATE; BRM REQDAT
       LDA =155B; CIO FNO
       LDA CTYPE; ETR =7777B; LDB =4; BRM PFOR
       LDA CCHR; LDB =10; BRM PFOR; SPACE 1
PRI05  LDA CPAGE; LDB =7;  BRM PFOR; SPACE 1
PRI10  LDA CPART; LDB =3; BRM PFOR; SPACE 1
PRI20  LDA CCARPR; LDB =7; BRM PFOR; SPACE 1
PRI40  LDA CTAPPU; LDB =8; BRM PFOR; SPACE 1
PRI50  LDA CTAPCO; LDB =5; BRM PFOR; SPACE 1
PRI60  LDA CDECCO; LDB =4; BRM PFOR; SPACE 1
PRI70  LDA CDELCH; LDB =7; BRM PFOR; SPACE 1
PRI80  LDA CCUREN; LDX =-3; CIO FNO; RSH 8; BRX *-2
       BRR PRIPRO
CT1    ZRO
*
*      THIS ROUTINE FINDS OUT WHAT CURRENCY YOU WANT
*
CUR1   ASC     '$ CURRENCY: /'
CUR2   ASC     '$OPTION        DESCRIPTION$'
       ASC     '$USD           UNITED STATES DOLLAR'
       ASC     '$FFR           FRENCH FRANC'
       ASC     '$BFR           BELGIAN FRANC'
       ASC     '$UKL           UNITED KINGDOM POUND'
       ASC     '$YEN           JAPANESE YEN'
       ASC     '$DM            GERMAN MARK'
       ASC     '$DFL           HOLLAND$$/'

CURTAB ASC     'DSURFFRFBLKUNEY MDLFD'
CUREND ZRO
WHACUR ZRO
WHA1   MSG CUR1
WHAIN1     CIO     CIN
        SNE     =155B
        BRU     WHAERR
        SNE     =0
        BRU     WHAIN1
       SNE     ='?'
       BRU     WHAERR
        LRSH    8
WHAIN2     CIO     CIN
       SNE     =155B
       BRU     WHA1
       SNE     =0
       BRU     WHA1
       LRSH    8
WHAIN3     CIO     CIN
       SKE     =155B
       BRU     WHA2
       CLA; LRSH 8; LDA =155B; BRU WHAIN5
WHA2    LRSH    8
WHAIN4     CIO     CIN
        SNE     =155B
        BRU     WHAIN5
        SKE     =0
        BRU     WHAIN4
WHAIN5     STA     TERMCH
       LDX     =CURTAB-CUREND
       CBA
       SKE     CUREND,2
       BRX     *-1
       COPY AB,XA
       SNE     =0
       BRU WHAERR
       STB     CURREN
       BRR WHACUR
WHAERR MSG     CUR2
       BRU     WHA1
*
*      THIS ROUTINE WILL PRINT A FORMATED INTEGER TO FNO
*              ON CALL A REG MUST CONTAIN FIELD WIDTH
*              ON CALL B REGISTER MUST HAVE NUMBER TO BE PRINTED
*              ON CALL FNO MUST HAVE FILE NUMBER
*

PFOR   ZRO
       STA     T1              SAVE IT
       COPY BA,B
       LSH     9
       MRG     =1B7
       MRG FNO
       CAX
       LDA T1
       CLB
       BRS 53
       BRR PFOR
MTDOPN ZRO     0               -1=> MTD FILE OPEN 0=> IT IS CLOSED
*
*      CLOMTD WRITES ACCT AND CLOSES FILE
*

CLOMTD ZRO
       SKN     MTDOPN
       BRR     CLOMTD          ALREADY CLOSED
       BRM     WRACCT          OPEN SO LETS WRITE ACCOUNTING
       LDA     MTDFNO
       BRS     2               NOW IT IS CLOSED
       CLA
       STA MTDOPN
       BRR     CLOMTD

GUSER  ZRO
       LDA =8
       LDB =CALLER
       LDX =1
       BRS 67  LOOK UP USER NUMBER
       LDA =31
       LDB =USEGAN
       LDX =1
       BRS 67      LOOK UP USER'S ACCOUNT NO.
       LDA =33
       LDB =LUDLOC
       LDX =1
       BRS 67                  GET A POINTER INTO THE LUD
       BRM WHO
       BRR GUSER

WHO    ZRO; LDA LUDLOC; LRSH 10; ADD =LUDBUF; STA LUDLOC; CLA; LSH 10
       STA BLNO; BRM GE1; LDX =-4; LDA* LUDLOC; STA WHONAM+4,2
       MIN LUDLOC; BRX *-3; MIN LUDLOC; MIN LUDLOC; MIN LUDLOC
       LDA* LUDLOC; STA USEUUN
       LDP CPT; BRM EDLIN; STP CPT; BRR WHO
LUDLOC ZRO
WHONAM BSS 4
CPT    DATA 3*WHONAM-1,3*WHONAM-1+12
CALLER ZRO
USEGAN ZRO
USEUUN ZRO


LUDBUF BSS 100B
GE1    ZRO; LDA BLNO; LRSH 23; DIV =128; STB MTEMP; CLB; LSH 13
       ADD =320200B; ADD MTEMP; CAB; LDA =LUDBUF; LDX =100B
       BRS 124; EAX LUDBUF; BRR GE1

MTEMP  ZRO
GLDIST ZRO
       CLA; LDX =-4; ADD UNAME+4,2; BRX *-1
       LRSH 23; DIV =887; STB BLNO; CBA; SKG =895; BRU *+2; HLT
GLD1 BRM GE1
GLD2 LDA 0,2; SKE =0; BRU *+2; BRR GLDIST (NOT HERE ANY LONGER USE 0 DIST)
       SKE =-1; BRU *+3; MIN BLNO; BRM GE1
       SKE =-2; BRU *+2; BRU GLD3
       SKE UNAME; BRU GLD3
       LDA 1,2; SKE UNAME+1; BRU GLD3
       LDA 2,2; SKE UNAME+2; BRU GLD3
       LDA 3,2; SKE UNAME+3; BRU GLD3
       LDA 8,2; LRSH 2; ETR =1777B; STA TDIST BRR GLDIST
GLD3 EAX 9,2; BRU GLD2
       END
1BCHARGE ** FICHE/FRAME BREAK *****
BCHARGE1406 SYMSORT

SYM.  PG.LN. IDENT.

2BUSY  16 35 RCHG    ACCRC1 63  3 RCHG    ACCREC 20 31 RCHG    
ACCUM  70  5 RCHG    ADDMTD 79  7 RCHG    ADJTYP 61  9 RCHG    AGAIN  58 37 RCHG    
AGINSW 10 19 RCHG    ALLCUR 67 38 RCHG    ALLHOL 10 16 RCHG    ALLSW  70 12 RCHG    
ANAME  24  3 RCHG    ANAME  24  1 RCHG    ANOTH  56 37 RCHG    AUNO   24  6 RCHG    
B1      4 27 RCHG    B200   36 37 RCHG    B200A  37  3 RCHG    BADT1  67  9 RCHG    
BADTYP 67  8 RCHG    BADUST 67  5 RCHG    BADX   56  9 RCHG    BAREC  18 16 RCHG    
BAREC  18  1 RCHG    BAREC  17 23 RCHG    BAREC  17  8 RCHG    BBRECP 18 21 RCHG    
BBRECP 18  6 RCHG    BBRECP 17 28 RCHG    BBRECP 17 13 RCHG    BCHARG  1  7 RCHG    
BCHG    1  9 RCHG    BCHG    1  5 RCHG    BCUST  85  9 RCHG    BEGIN   3 36 RCHG    
BELGIU 54 15 RCHG    BELGSW 70 10 RCHG    BELSUR  3 32 RCHG    BLANK  78 33 RCHG    
BLNO   24 11 RCHG    BLX    24 12 RCHG    BMTD   18 17 RCHG    BMTD   18  2 RCHG    
BMTD   17 24 RCHG    BMTD   17  9 RCHG    BMTDPT 18 22 RCHG    BMTDPT 18  7 RCHG    
BMTDPT 17 29 RCHG    BMTDPT 17 14 RCHG    BNUM   87 12 RCHG    BNUM   87  9 RCHG    
BNUMP  87 13 RCHG    BNUMP  87 10 RCHG    BOBMTD 20 25 RCHG    BRECP  18 20 RCHG    
BRECP  18  5 RCHG    BRECP  17 27 RCHG    BRECP  17 12 RCHG    BRUTAB 56  6 RCHG    
BTBLND  8 23 RCHG    BUF    24 13 RCHG    BUF2   51  3 RCHG    BUSCNT 17  1 RCHG    
BUSY   16 28 RCHG    CALC   61 28 RCHG    CALLER 90 36 RCHG    CARPRO 10 33 RCHG    
CC1    11 14 RCHG    CCARPR 37 36 RCHG    CCHR   37 33 RCHG    CCUR   38  7 RCHG    
CCUREN 38  2 RCHG    CDATE  37 29 RCHG    CDECCO 38  1 RCHG    CDELCH 38  3 RCHG    
CEMPTR 38  4 RCHG    CENTS  41 36 RCHG    CFILPR 37 37 RCHG    CGAN   37 26 RCHG    
CHECK  72 35 RCHG    CHECK1 72 39 RCHG    CHECK2 73 11 RCHG    CHG    52 25 RCHG    
CHG1   52 28 RCHG    CHG2   52 38 RCHG    CHG22  53  6 RCHG    CHG2A  53 27 RCHG    
CHG2B  53 14 RCHG    CHG2C  53 16 RCHG    CHG2E  53 20 RCHG    CHG3   55 30 RCHG    
CHG3A  55 23 RCHG    CHG4   56  2 RCHG    CHGA1  68  6 RCHG    CHGA2  68 21 RCHG    
CHGA3  68 23 RCHG    CHGA4  68 27 RCHG    CHGALL 67 39 RCHG    CHGNUM 67 29 RCHG    
CHGOPT 67 13 RCHG    CHGUS  54  9 RCHG    CHK     7 31 RCHG    CHOST  37 28 RCHG    
CIN    11  7 RCHG    CINSW   3 25 RCHG    CJOB   37 31 RCHG    CKCUR  78 21 RCHG    
CKCUR1 78 24 RCHG    CKDAY  27  4 RCHG    CKDAY1 27  5 RCHG    CKDAYX 27 19 RCHG    
CKSPL  71 38 RCHG    CKSPL1 72  5 RCHG    CKSPL2 72 17 RCHG    CKSPL3 72 27 RCHG    
CLBUF   8 25 RCHG    CLC1   75 16 RCHG    CLIST1 38 18 RCHG    CLIST2 38 27 RCHG    
CLIST3 38 21 RCHG    CLOMTD 90  2 RCHG    CNUMSW 70  7 RCHG    COMLST 38 10 RCHG    
COR    73 18 RCHG    COR1   73 26 RCHG    COR2   73 32 RCHG    COR2AA 73 39 RCHG    
COR3   74 11 RCHG    COR3A  74 16 RCHG    COR4   74 24 RCHG    COR5   74 36 RCHG    
COR5A  75 11 RCHG    CORAGN 75 37 RCHG    CORCUR 76  2 RCHG    CORHOL 75 17 RCHG    
CORM1  76  1 RCHG    CORNO1 75 20 RCHG    CORNON 75 19 RCHG    CORSW  28 32 RCHG    
CPAGE  37 34 RCHG    CPART  37 35 RCHG    CPREC  38 35 RCHG    CPROJ  37 30 RCHG    
CPT    90 35 RCHG    CPTOP  14 30 RCHG    CPTRA  59 20 RCHG    CR      3 10 RCHG    
CREATE 79 24 RCHG    CRECBF 37 22 RCHG    CRECST 37 23 RCHG    CREQBY 37 32 RCHG    
CRESW  28 34 RCHG    CT1    88  3 RCHG    CTAPCO 37 39 RCHG    CTAPPU 37 38 RCHG    
CTBL    8 20 RCHG    CTBL    8 17 RCHG    CTBLND  8 21 RCHG    CTBLND  8 18 RCHG    
CTYPE  37 25 RCHG    CUNAME 37 24 RCHG    CUR1   88  7 RCHG    CUR2   88  8 RCHG    
CURBUF 79 19 RCHG    CUREND 88 18 RCHG    CURREN 10 38 RCHG    CURTAB 88 17 RCHG    
CUUN   37 27 RCHG    CVT    12 18 RCHG    CVTDAT 12 31 RCHG    CZONE   3 28 RCHG    
DATE   87 18 RCHG    DATEPT 11 10 RCHG    DAY    10 11 RCHG    DEBUG   1 11 RCHG    
DECCOL 10 37 RCHG    DELETE 21 29 RCHG    DIST   50 24 RCHG    ECHG1  57 35 RCHG    
ECHG1A 58 12 RCHG    ECHG1B 58 27 RCHG    ECHG1C 58 32 RCHG    EDATE  10 26 RCHG    
EDLIN  51 36 RCHG    EDLIN1 52 10 RCHG    EDLIN2 51 38 RCHG    EDPT   52 12 RCHG    
EDVER  51 31 RCHG    END1   57 25 RCHG    END1A  57 26 RCHG    END2   57 33 RCHG    
ENDAT  25 23 RCHG    ENDCHG 57 14 RCHG    ENG    55  7 RCHG    ERFLG   8 12 RCHG    
ERMSG   8 13 RCHG    ERMSG1  8 14 RCHG    ERR     8  4 RCHG    ERR1    8 10 RCHG    
ERV    51 15 RCHG    ERV1   51 14 RCHG    ERV2   51 17 RCHG    ERV3   51 21 RCHG    
FACT1  66 13 RCHG    FACTOR 61 27 RCHG    FBUSY1 16 39 RCHG    FILDAT 15 26 RCHG    
FILPRO 10 34 RCHG    FILPT  18 32 RCHG    FILTYP 17  2 RCHG    FJOB   14 27 RCHG    
FLAG   11  1 RCHG    FNDREC 12 37 RCHG    FNO    11  9 RCHG    FNO1   22 13 RCHG    
FONO   50 13 RCHG    FR1    54 25 RCHG    FREC1  13  6 RCHG    FREC1A 14  1 RCHG    
FREC1B 14  4 RCHG    FREC1C 13 22 RCHG    FREC2  14  8 RCHG    FREC3  13  1 RCHG    
FREC4  14 15 RCHG    FREC5  14 20 RCHG    FRENCH 54 24 RCHG    FRENSW 70  9 RCHG    
FRNMSG 55  3 RCHG    FSUR    3 31 RCHG    GAN    10 23 RCHG    GAUN   22 17 RCHG    
GDIR   22 25 RCHG    GDIR2  23 11 RCHG    GDIR3  23 37 RCHG    GE1    91  3 RCHG    
GERMAN 55 15 RCHG    GERSW  70 11 RCHG    GETREC 35 28 RCHG    GIP    15 17 RCHG    
GLD1   91 11 RCHG    GLD2   91 12 RCHG    GLD3   91 20 RCHG    GLDIST 91  8 RCHG    
GLTCH   6 23 RCHG    GPROJ  86 15 RCHG    GPS    49 11 RCHG    GPS1   49 13 RCHG    
GREC1  35 36 RCHG    GREC1A 36  4 RCHG    GREC2  36 26 RCHG    GRECER 37 10 RCHG    
GREQNO 69 35 RCHG    GSTG2  85 29 RCHG    GTDAT1  9 36 RCHG    GTDAT2 10  6 RCHG    
GTDATE  8 32 RCHG    GTNAME 85 38 RCHG    GTREQB 86  7 RCHG    GTSTG  85 11 RCHG    
GTSTG1 85 19 RCHG    GUSER  90 12 RCHG    GVREC  29 25 RCHG    GVREC1 29 32 RCHG    
GVREC2 30  8 RCHG    GVREC3 30 11 RCHG    HBUF   11  3 RCHG    HDAY   27 21 RCHG    
HEL    70 20 RCHG    HMSG   34 15 RCHG    HOLD   59 21 RCHG    HOLDSW 10 17 RCHG    
HOLMSG 34  7 RCHG    HOST   10 25 RCHG    HPARTS 64  6 RCHG    HRATE  64  5 RCHG    
HTOTAL 70  4 RCHG    HVOL   66 36 RCHG    ILLTYP 11 15 RCHG    IN1     6 34 RCHG    
IN2     7  1 RCHG    IN3     7  7 RCHG    IN4     7 13 RCHG    IN5     7 18 RCHG    
JDNO2  41 13 RCHG    JDNO4  41  5 RCHG    JDNO5  40 34 RCHG    JOB    10 28 RCHG    
JONO   40 20 RCHG    KTCB   27 20 RCHG    LBUF   85 10 RCHG    LEADZ  40  3 RCHG    
LERR   28 11 RCHG    LHEAD  12  8 RCHG    LHEAD1 12 11 RCHG    LHEADV 12  9 RCHG    
LHSW   33  6 RCHG    LIST   27 29 RCHG    LIST1  27 32 RCHG    LM1    35 19 RCHG    
LM2    35 20 RCHG    LM3    35 21 RCHG    LM4    35 22 RCHG    LM5    35 23 RCHG    
LSTNUM 28 16 RCHG    LSTSW  38  9 RCHG    LUDBUF 91  2 RCHG    LUDLOC 90 33 RCHG    
LVOID  43  2 RCHG    LVOID1 43  8 RCHG    LVOID2 43 17 RCHG    LVOID3 44  3 RCHG    
LVOID4 44  8 RCHG    LVOID5 44 12 RCHG    LVOID6 44 17 RCHG    LVOID7 44 22 RCHG    
LVOID8 43 37 RCHG    LVOIDX 43 24 RCHG    LVOIDY 44 26 RCHG    LZERO  40 15 RCHG    
M1     11 16 RCHG    M10    11 25 RCHG    M11    11 26 RCHG    M12    11 27 RCHG    
M13    11 28 RCHG    M14    11 29 RCHG    M15    11 30 RCHG    M16    11 31 RCHG    
M17    11 32 RCHG    M19    11 34 RCHG    M2     11 17 RCHG    M20    11 35 RCHG    
M21    11 36 RCHG    M22    11 37 RCHG    M23    11 38 RCHG    M24    11 39 RCHG    
M25    12  1 RCHG    M26    12  2 RCHG    M27    12  3 RCHG    M28    12  4 RCHG    
M29    12  5 RCHG    M3     11 18 RCHG    M30    12  6 RCHG    M31    12  7 RCHG    
M4     11 19 RCHG    M5     11 20 RCHG    M6     11 21 RCHG    M7     11 22 RCHG    
M8     11 23 RCHG    M9     11 24 RCHG    MAKE   80 24 RCHG    MAKE2  81 19 RCHG    
MAKE3  80 36 RCHG    MAKERR 81 26 RCHG    MAKTT9 20 32 RCHG    MBADT  67  7 RCHG    
MCR1   80 12 RCHG    MCR2   80 13 RCHG    MCR3   80 14 RCHG    MCR4   80 15 RCHG    
MCR5   80 16 RCHG    MCR6   80 17 RCHG    MCR7   80 18 RCHG    MCR8   80 19 RCHG    
MCR9   80 20 RCHG    MDADUS 67  4 RCHG    MEOF   38 33 RCHG    MGREC  37 20 RCHG    
MHELP  70 29 RCHG    MHELP1 71 23 RCHG    MHELP2 71 27 RCHG    MINMUM 64  4 RCHG    
MINPOS  1 27 RCHG    MKNUM  81 33 RCHG    MKPTR  86 23 RCHG    MNOTIF 19 14 RCHG    
MO     10 10 RCHG    MONPTR 18 27 RCHG    MONPTR 18 12 RCHG    MONPTR 17 34 RCHG    
MONPTR 17 19 RCHG    MOPURF 21 27 RCHG    MOREC  19 13 RCHG    MOVACC 63  5 RCHG    
MOVE   46 16 RCHG    MOVOID 22 12 RCHG    MOVREC 59 24 RCHG    MR1    59 28 RCHG    
MSG     2  3 RCHG    MSGP    2 18 RCHG    MSGP2   2 27 RCHG    MSGSW  37 19 RCHG    
MTDFNO 20 26 RCHG    MTDOPN 89 36 RCHG    MTEMP  91  7 RCHG    MTHRU  70 17 RCHG    
MVER    1 35 RCHG    MVER    1 33 RCHG    MVOID  69 31 RCHG    MVREC  75 24 RCHG    
NAME   24  5 RCHG    NCHR   10 30 RCHG    NM1    78 20 RCHG    NOGOOD 24  7 RCHG    
NONAME 50 31 RCHG    NONO   24  9 RCHG    NOPASS 50 25 RCHG    NOPE    4 21 RCHG    
NOREQ  82 33 RCHG    NOREQ1 83  5 RCHG    NOREQ2 83 17 RCHG    NOREQ3 83 20 RCHG    
NOREQ4 83 23 RCHG    NPAG   10 31 RCHG    NTEMP  85  6 RCHG    NULL   76 22 RCHG    
NULL1  76 32 RCHG    NULL2  76 38 RCHG    NULL3  77 14 RCHG    NULL4  77 23 RCHG    
NULL5  77 30 RCHG    NULL6  78  3 RCHG    NULL7  78  8 RCHG    NULL8  78 17 RCHG    
NULLSW 28 33 RCHG    NUMFNO 87  6 RCHG    NUMLST 28 22 RCHG    NUMSW  25 22 RCHG    
OBMTD  20  2 RCHG    OBMTD1 20 22 RCHG    OBNUM  86 30 RCHG    OBNUM1 87  3 RCHG    
OPFER  51 19 RCHG    OPFI1  16  9 RCHG    OPFI2  16 16 RCHG    OPFI3  16 19 RCHG    
OPFI4  15 39 RCHG    OPFIL  15 36 RCHG    OPNAM  51  1 RCHG    OPOUT  39 26 RCHG    
OPOUT1 39 38 RCHG    OPTLST 28 13 RCHG    OPURF  21 12 RCHG    OPURF1 21 25 RCHG    
ORECF  18 35 RCHG    ORECF1 19 10 RCHG    ORECFA 19 21 RCHG    ORECSW 28 31 RCHG    
ORF1A  19 35 RCHG    OVOID  21 36 RCHG    OVOID1 22 10 RCHG    PARTS  10 32 RCHG    
PCARD  64 18 RCHG    PDNO   25  5 RCHG    PDOLS  41 17 RCHG    PFOR   89 25 RCHG    
POINT  38  5 RCHG    POINT1 38  6 RCHG    PONO   25 12 RCHG    POST   10 39 RCHG    
PPART  38 39 RCHG    PRI05  87 33 RCHG    PRI10  87 34 RCHG    PRI20  87 35 RCHG    
PRI40  87 36 RCHG    PRI50  87 37 RCHG    PRI60  87 38 RCHG    PRI70  87 39 RCHG    
PRI80  88  1 RCHG    PRINT  56 12 RCHG    PRINT1 56 17 RCHG    PRINT2 56 29 RCHG    
PRINT3 56 35 RCHG    PRIPRO 87 23 RCHG    PRIV   24 10 RCHG    PROJ   10 27 RCHG    
PSTG   39  7 RCHG    PSTG1  39  8 RCHG    PSTG2  39 12 RCHG    PT1    63  1 RCHG    
PT2    63  2 RCHG    PTRA   59 18 RCHG    PTRB   59 19 RCHG    PUCR1  33 14 RCHG    
PUCREC 33  7 RCHG    PURGE  44 34 RCHG    PURGE1 45  1 RCHG    PURGE2 45  6 RCHG    
PURGE3 45  9 RCHG    PURGE4 45 14 RCHG    PURGE5 45 24 RCHG    PURGE6 45 34 RCHG    
PURGE7 46 21 RCHG    PURGF  18 18 RCHG    PURGF  18  3 RCHG    PURGF  17 25 RCHG    
PURGF  17 10 RCHG    PURPT  18 23 RCHG    PURPT  18  8 RCHG    PURPT  17 30 RCHG    
PURPT  17 15 RCHG    PVREC  30 16 RCHG    PZERO  41 30 RCHG    RAMT   63 18 RCHG    
RAMT1  63 36 RCHG    RBLK   22 35 RCHG    RCHARG  1  3 RCHG    RDCARD 64  9 RCHG    
RDNO   24 18 RCHG    RDX    34 18 RCHG    READT9 21  7 RCHG    RECBUF 10 20 RCHG    
RECCUR 14 29 RCHG    RECFB  19 18 RCHG    RECFNO 19 15 RCHG    RECLEN  1 18 RCHG    
RECMV  75 30 RCHG    RECVT  12 24 RCHG    REQBY  10 29 RCHG    REQDAT 34 19 RCHG    
REQNO  83 25 RCHG    RESET   6  5 RCHG    RSTART 27 22 RCHG    RSTG   36 30 RCHG    
RTAPE  64 22 RCHG    RWREC  76  6 RCHG    SAVA    3 23 RCHG    SAVB    3 24 RCHG    
SAVX    3 22 RCHG    SAWFRN 55  2 RCHG    SF     50 38 RCHG    SFBUF  51  4 RCHG    
SFIL   51 13 RCHG    SFPTR  50 37 RCHG    SGPS   49  3 RCHG    SKNE    1 29 RCHG    
SPACE   2 34 RCHG    SPLSW  72 30 RCHG    SPM1   34 16 RCHG    SPM2   34 17 RCHG    
SPMSG1 34  9 RCHG    SPMSG2 34 11 RCHG    SPMSG3 34 13 RCHG    SPOREC 60  2 RCHG    
SPR1   60 13 RCHG    SPR2   60 22 RCHG    STASW  50 23 RCHG    STCOLL 60 24 RCHG    
STGCNT 85 36 RCHG    SUB1   79 16 RCHG    SUBACC 79 15 RCHG    SYSNAM  3 29 RCHG    
SYSNO   3 27 RCHG    SYSPTR 18 25 RCHG    SYSPTR 18 10 RCHG    SYSPTR 17 32 RCHG    
SYSPTR 17 17 RCHG    SYSXXX  3 30 RCHG    T      81 30 RCHG    T1     58 31 RCHG    
T2     82 30 RCHG    T3     82 31 RCHG    TAPBUY 67  1 RCHG    TAPCON 10 36 RCHG    
TAPE1  66 29 RCHG    TAPEC  65 25 RCHG    TAPEIO 66 14 RCHG    TAPGOT 65 16 RCHG    
TAPIO  66 27 RCHG    TAPPUR 10 35 RCHG    TDIST  70  6 RCHG    TDNO   24 30 RCHG    
TEMP   24 14 RCHG    TERMCH  3 26 RCHG    TERMWD 50 35 RCHG    THRU   70 13 RCHG    
TLV1   50 19 RCHG    TLV11  50 20 RCHG    TONO   24 37 RCHG    TOTAL  87 16 RCHG    
TOUT   11  8 RCHG    TPUR   66 35 RCHG    TRYC1  29  4 RCHG    TRYC2  29  9 RCHG    
TRYC3  29 14 RCHG    TRYC4  29 17 RCHG    TRYC5  29 12 RCHG    TRYCOM 28 36 RCHG    
TWOFLG 10 18 RCHG    TYPE   10 21 RCHG    UKSW   70  8 RCHG    UNAME  10 22 RCHG    
UNCL1  31 15 RCHG    UNCL2  31 25 RCHG    UNCL3  31 31 RCHG    UNCL4  32  4 RCHG    
UNCL5  32  5 RCHG    UNCL6  32 19 RCHG    UNCL7  32 21 RCHG    UNCLST 31  9 RCHG    
UNCLX  32 32 RCHG    UNCLX1 32 38 RCHG    UNCLX2 32 35 RCHG    UNCLY  32 27 RCHG    
UNCLZ  33  1 RCHG    USEGAN 90 37 RCHG    USEUUN 90 38 RCHG    UUN    10 24 RCHG    
VCUST  83 27 RCHG    VCUST1 83 39 RCHG    VCUST2 84 14 RCHG    VCUST3 85  4 RCHG    
VCUSTB 85  7 RCHG    VER    46 32 RCHG    VER1   47 33 RCHG    VER1A  47  1 RCHG    
VER1B  47 18 RCHG    VERRET 51 23 RCHG    VERSW  50 22 RCHG    VM1    52 18 RCHG    
VM2    52 19 RCHG    VME    52 14 RCHG    VME1   52 13 RCHG    VME2   52 15 RCHG    
VME3   52 16 RCHG    VME4   52 17 RCHG    VME5   52 20 RCHG    VME6   52 21 RCHG    
VOID   68 35 RCHG    VOID1  68 38 RCHG    VOID2  69  1 RCHG    VOIDF  18 19 RCHG    
VOIDF  18  4 RCHG    VOIDF  17 26 RCHG    VOIDF  17 11 RCHG    VOIDN1 69 25 RCHG    
VOIDNO 69 14 RCHG    VOIDPT 18 24 RCHG    VOIDPT 18  9 RCHG    VOIDPT 17 31 RCHG    
VOIDPT 17 16 RCHG    VOIMIS 69 29 RCHG    VOL    87 17 RCHG    VPTR1  50 39 RCHG    
VPTR2  51  2 RCHG    VT1    51  5 RCHG    VT2    51  6 RCHG    VXT1   51  7 RCHG    
VXT2   51  8 RCHG    VXT3   51  9 RCHG    VXT4   51 10 RCHG    VXT5   51 11 RCHG    
VXT8   51 12 RCHG    WCHG   61 34 RCHG    WCHG1  62  3 RCHG    WCHG2  62 17 RCHG    
WCHG5  62 22 RCHG    WHA1   88 20 RCHG    WHA2   88 39 RCHG    WHACUR 88 19 RCHG    
WHAERR 89 16 RCHG    WHAIN1 88 21 RCHG    WHAIN2 88 29 RCHG    WHAIN3 88 35 RCHG    
WHAIN4 89  1 RCHG    WHAIN5 89  6 RCHG    WHO    90 28 RCHG    WHONAM 90 34 RCHG    
WKPTR  85 35 RCHG    WKWORD 82 29 RCHG    WORK   64  3 RCHG    WRACCT 62 29 RCHG    
WREC   14 34 RCHG    WREC1  14 39 RCHG    WREC2  15  1 RCHG    WTAPE  65  1 RCHG    
YN     42  2 RCHG    YN1    42 11 RCHG    YN2    42 29 RCHG    YNERR  42 37 RCHG    
YR     10 12 RCHG    
1BCHARGE ** FICHE/FRAME BREAK *****
BLDBCHG1406
NARP
BCHARGE1406
BCHARGEBIN


RES
XDDT
;TBCHARGEBIN
%QSAVE 3,14777 O 1BCHARGE

240

CON
1%L
%FDUMP DUMPBCHARGE



"CHECKSUM


CHECKSUM
.
BLDBCHG1406-BUILD-FILE
BCHARGE1406-SYMBOLICS
1BCHARGE-GO-FILE
.
COM T
1BCHARGE ** FICHE/FRAME BREAK *****
CHARGEFILES

               FILES USED IN 940 BCHARGE, RCHARGE & BATCH


                                   RCHARGE
                                   -------

(SPOOL)RECREMOTE   AND (SPOOL)RECREMOTEA
(*4ACCT)SSS-BAT-MM                     (SSS- IS THE 3-DIGIT SYSTEM NUMBER AND
                                        -MM IS THE 2-DIGIT MONTH NUMBER)
(SPOOL)BREC'TMP'
(SPOOL)VOIDREM
(*1BATCH)@BATCHNUM1


                                   BCHARGE
                                   -------

(*4ACCT)SSS-BAT-MM                     (SEE ABOVE FOR NAMING CONVENTION)
(*4ACCT)BREC'TMP'
(*4ACCT)RECBATCH AND (*4ACCT)RECBATCHA
(*4ACCT)VOIDBAT
(*1BATCH)@BATCHNUM1

       (BCHARGE ALSO READS SOME PASSWORD FILE, PROBABLY WITH THE NAME PSWP)


                                   BATCH
                                   -----

(*1BATCH)@BA
(*1BATCH)@BATCHNUM1
(OPER)/@BAHOLD                         (OR MAYBE /@BAHOLD&C&X/)
(*4ACCT)RECBATCH AND (*4ACCT)RECBATCHA
(*1BATCH)@FR                           (USED IN PLACE OF @BA FOR FRENCH
                                        CUSTOMERS)
1BCHARGE ** FICHE/FRAME BREAK *****
SCOMBCHG140605
08/16/78  19:31
1)=BCHARGE1406
2)=BCHARGE1405

1) BCHG EQU -1             EQUIVALENT TO NEGATION OF RCHG
1)      ELSE
****5
2)        ELSE
********5
1) BCHG EQU 1              EQUIVALENT TO NEGATION OF RCHG
1)      ENDF
****9
2)        ENDF
********8
1)   IF DEBUG
1)        REM  DEBUGGING VERSION
1)     ELSE
1)        REM PRODUCTION VERSION
1)   ENDF
1) 
1) RECLEN EQU     28              DEFINE LENGTH OF RECORDS
1) * 1406 ENABLES JOB TYPES 4 & 5 FOR AREA 7 (FRENCH) CUSTOMERS.  THE FCUST
1) *      ROUTINE AND OTHERS WHICH DEPEND ON IT WAS REMOVED.  IMPROVED HELP
1) *      MESSAGE AND MADE OTHER MINOR IMPROVEMENTS.  /MCH
1) *1400 USES NEW BATCH FORMAT
****12
2) RECLEN EQU     28              DEFINE LENGTH OF RECORDS
2) *1400 USES NEW BATCH FORMAT
********10
1) MINPOS  EQU     12             MINIMUM POSTAGE CHARGE (IN CENTS)
1) 
1) SKNE    OPD     536B5,2
****27
2) MINPOS  EQU     12
2) SKNE   OPD     536B5,2
2) 
********16
1) MVER   ASC     '$REMOTE SPOOL ENTRY PROGRAM VERSION 14.06$/'
1)     ELSE
1) MVER    ASC     '$BATCH ENTRY PROGRAM VERSION 14.06$/'
1)   ENDF
1)         ASC     'HINCKLEY '
1) 
1) *** MSG:  TAKES THE STARTING LOCATION OF AN ASC STRING TO BE PRINTED
1) ***       ON THE TERMINAL (EXPECTS / AS THE STRING TERMINATOR)
1) 
1) MSG     POPD    100B5,2
****33
2) MVER   ASC     '$REMOTE SPOOL ENTRY PROGRAM VERSION 14.05$/'
2)        ELSE
2) MVER    ASC     '$BATCH ENTRY PROGRAM VERSION 14.05$/'
2)        ENDF
2)         ASC     'GAVETTE '
2) 
2) MSG     POPD    100B5,2
********22
1)         STX     SAVX           SAVE THE REGISTERS
1)         EAX*    0
****44
2)         STX     SAVX
2)         EAX*    0
********30
1)         ETR     =37777B        A NOW HAS THE STARTING LOCATION OF THE STRING
1)         LDB     =-1
****47
2)         ETR     =37777B
2)         LDB     =-1
********33
1) *** MSGP:      TAKES THE STARTING LOCATION OF AN ASC STRING AS ARGUMENT
1) ***            AND PRINTS IT TO THE FILE STORED IN FNO
1) ***            STRING MUST END WITH A /
1) 
1) MSGP    POPD    101B5,2
****53
2) MSGP    POPD    101B5,2
********38
1)         LDX     SAVX           RESTORE REGISTERS
1)         BRR     0              RETURN TO CALLER
1) 
1) *** SPACE:     TAKES AN INTEGER ARGUMENT AND PRINTS THAT MANY SPACES
1) ***            TO THE FILE STORED IN FNO
1) 
1) SPACE   POPD    103B5,2
****67
2)         LDX     SAVX
2)         BRR     0
2) SPACE   POPD    103B5,2
********48
1)         STX     SAVX           SAVE THE REGISTERS
1)         EAX*    0
****75
2)         STX     SAVX
2)         EAX*    0
********52
1)         CAX                    X NOW HAS THE NEG OF THE COUNT GIVEN TO SPACE
1)         CLA
****80
2)         CAX
2)         CLA
********57
1) *** CR:        LIKE SPACE ABOVE EXCEPT THAT IT PRINTS CARRIAGE-RETURNS
1) 
1) CR      POPD    104B5,2
****86
2) CR      POPD    104B5,2
********62
1) BEGIN   STP     CIN            LOAD PRIMARY INPUT FILE INTO CIN AND PRIMARY OUTPUT FILE INTO TOUT
1)         SKE     =0
1)         STA     CINSW          IF PRIMARY OUTPUT FILE IS NOT TERMINAL, STORE THE FILE NUM IN CINSW
1)         LDA     20000B
1)         BRS     71             SKIP IF USER HAS SET SYSTEM OR EXEC LICENSE
1)         BRU     *+2
1)         BRU     B1             HAS LICENSE, SO GO TO B1
1)         BRS     39             NO LICENSE SET, SO LOOK UP HIS STATUS
1)         SKA     =4B7           SKIP IF USER DOES NOT HAVE TYMSHARE LICENCE
1)   IF RCHG
1)           BRU B1
1)         BRU NOPE                STOP USER IF NO TYMSHARE LICENSE
1)     ELSE
****114
2) BEGIN   STP     CIN
2)         SKE     =0
2)         STA     CINSW
2)         LDA     20000B
2)         BRS     71
2)         BRU     *+2
2)         BRU     B1
2)         BRS     39
2)         SKA     =4B7
2)        IF       RCHG
2)        BRU B1; BRU NOPE
2)        ELSE
********88
1)         BRU     NOPE           STOP USER IF NO TYMSHARE LICENSE
1)         RSH     2
1)         ETR     =1777B         A REGISTER NOW HAS DISTRICT NUMBER
1)         SNE     =2             IF USER IS IN DISTRICT 0 OR 2 GO TO B1
1)           BRU     B1               AND OTHERWISE GO TO NOPE
1)         SNE     =0
****128
2)         BRU     NOPE
2)         RSH     2
2)         ETR     =1777B
2)         SNE     =2
2)         BRU     B1
2)         SNE     =0
********101
1) * PRINT A QUESTION MARK ON TERMINAL AND RETURN TO EXEC
1) NOPE    TCO     =0
****137
2) NOPE    TCO     =0
********109
1) *  READ 100 OCTAL WORDS OF INFO FROM DISK INTO CORE 
1) *  DISK ADDR 200 BEGINS A SYSTEM TABLE.  READ INFO INTO BUF
1) B1      LDA     =BUF
****142
2) B1      LDA     =BUF
********112
1)         BRS     124            READ FROM DISK INTO CORE
1)         LDA     BUF+74B
1)         STA     CZONE          PICK UP LOCAL TIME ZONE (??)
1)         ADM     RDX
****147
2)         BRS     124
2)         LDA     BUF+74B
2)         STA     CZONE
2)         ADM     RDX
********115
1)         STA     SYSNO          SAVE THE SYSTEM NUMBER
1)         LDA     BUF+77B
1)         STA     SYSNAM         SAVE SYSTEM NAME (BUT PROBABLY NOT USED)
1) 
1) *  MAKE THE BATCH FILE NAME BEGIN WITH THE (3-DIGIT) SYSTEM NUMBER
1)        LDA SYSNO
1)        CLB
1)        LRSH 23
1)        DIV =100
1)        ADD =20B
1)        WCI SYSPTR
1)        COPY BA,B
1)        LRSH 23
1)        DIV =10
1)        ADD =20B
1)        WCI SYSPTR
1)        COPY BA
1)        ADD =20B
1)        WCI SYSPTR
1) 
1) *  MAKE THE BATCH FILE NAME END WITH THE (2-DIGIT) MONTH NUMBER
1)        LDA =-1
1)        LDX =200020B
1)        BRS 176
1)        ABC
1)        LSH 4
1)        CLA
1)        LSH 4
1)        STA MO
1)        ADD =1
1)        CLB
1)        LRSH 23
1)        DIV =10
1)        ADD =20B
1)        WCI MONPTR
1)        CBA
1)        ADD =20B
1)        WCI MONPTR
1) 
****153
2)         STA     SYSNO
2)         LDA     BUF+77B
2)         STA     SYSNAM
2) 
2)        LDA SYSNO; CLB; LRSH 23; DIV =100; ADD =20B; WCI SYSPTR
2)        COPY BA,B;  LRSH 23; DIV =10; ADD =20B; WCI SYSPTR
2)        COPY BA; ADD =20B; WCI SYSPTR
2)        LDA =-1; LDX =200020B; BRS 176; ABC; LSH 4; CLA; LSH 4; STA MO
2)        ADD =1; CLB; LRSH 23; DIV =10; ADD =20B; WCI MONPTR; CBA; ADD =20B
2)        WCI MONPTR
********121
1)        BRM     GUSER           LOOK UP AND SAVE SOME INFO ABOUT THE USER
1)        BRM     VER
****193
2)        BRM     GUSER
2)        BRM     VER
********132
1)        MSG     MVER            (THE VERSION NUMBER)
1) 
1) *COMMAND DISPATCHER
1) 
****196
2)         MSG     MVER
2) 
2) *COMMAND DISPATCHER
2) 
********135
1)        STA SAWFRN
1)         LDA     =4B4
****212
2)         LDA     =4B4
********151
1)         BRS     12             ALLOW COMMAND EDITING AND ECHOING
1)         BRS     147            CLOSE ALL BUT THE COMMAND FILES
1)         BRS     114            ALLOW ESCAPES AGAIN
****215
2)         BRS     12
2)         BRS     147
2)        BRS     114             ALLOW ESCAPES AGAIN
********153
1)         BRU     IN1            NO INPUT FROM TERMINAL SO NO PROMPT TO PRINT
1)         LDA     =155B
****219
2)         BRU     IN1
2)         LDA     =155B
********157
1)         CIO     =1             OUTPUT TWO CARRIAGE-RETURNS
1)     IF RCHG
1)         LDA ='*'                PROMPT FOR RCHARGE
1)       ELSE
1)         LDA     ='>'           PROMPT FOR BCHARGE
1)       ENDF
****222
2)         CIO     =1
2)        IF RCHG
2)        LDA ='*'
2)        ELSE
2)         LDA     ='>'
2)        ENDF
********160
1) IN1     CIO     CIN            GET A CHARACTER FROM INPUT FILE
1)         SNE     =155B
1)           BRU     IN1          IT WAS A CARRIAGE-RETURN, SO IGNORE
1)         SNE     =0
1)           BRU     IN1          IT WAS A SPACE SO IGNORE & GET ANOTHER
1)         LRSH    8              GOT A CHARACTER SO SHIFT IT INTO B REGISTER
1) IN2     CIO     CIN
****229
2) IN1     CIO     CIN
2)         SNE     =155B
2)         BRU     IN1
2)         SNE     =0
2)         BRU     IN1
2)         LRSH    8
2) IN2     CIO     CIN
********167
1)           BRU     CHK          2ND CHAR WAS A CARRIAGE-RETURN SO CALL CHK
1)         SNE     =0
1)           BRU     CHK          2ND CHAR WAS A SPACE SO CALL CHK
1)         LRSH    8              SAVE SECOND CHARACTER IN B REGISTER
1) IN3     CIO     CIN            GET THE 3RD CHAR FROM INPUT FILE
1)         SNE     =155B
1)           BRU     ERR          OOPS--NOT A VALID COMMAND
1)         SNE     =0
****237
2)         BRU     CHK
2)         SNE     =0
2)         BRU     CHK
2)         LRSH    8
2) IN3     CIO     CIN
2)         SNE     =155B
2)         BRU     ERR
2)         SNE     =0
********175
1)         LRSH    8              SHIFT THE 3RD CHAR INTO B REGISTER
1) IN4     CIO     CIN            GET A 4TH CHARACTER FROM INPUT FILE
1)         SNE     =155B
****246
2)         LRSH    8
2) IN4     CIO     CIN
2)         SNE     =155B
********184
1)           BRU     IN4          WE HAVEN'T SEEN A SPACE OR CR YET SO GET MORE
1) IN5     STA     TERMCH         SAVE THE CHARACTER THAT TERMINATED THE INPUT
1) 
1) *  NOW SEE IF WE CAN MATCH THE COMMAND (IF SO EXECUTE IT)
1)         LDX     =CTBL-CTBLND
****251
2)         BRU     IN4
2) IN5     STA     TERMCH
2)         LDX     =CTBL-CTBLND
********189
1) * CLEAR INPUT BUFFER AND A REGISTER.
1) * THEN SEE IF THE COMMAND WAS QUIT (IF SO, FINISH UP)
1) * OR A ? (IN WHICH CASE CALL THE HELP ROUTINE).
1) *  ANYTHING ELSE IS AN ERROR.
1) CHK     LDX     =-1
****261
2) CHK     LDX     =-1
********196
1) * JUST PRINT A ? AND GO GET ANOTHER COMMAND ON FIRST ERROR.
1) * REMIND USER OF HELP COMMAND IF HE'S MADE MORE THAN ONE ERROR.
1) ERR     LDA     ERFLG
****275
2) ERR     LDA     ERFLG
********205
1) UNAME  EQU     RECBUF+1        USER NAME (MAX. 12 CHARS)
1) GAN    EQU     RECBUF+5        THE GAN (STORED IN DECIMAL)
1) UUN    EQU     RECBUF+6        THE UUN
1) HOST   EQU     RECBUF+7        THE HOST SYSTEM NUMBER
1) EDATE  EQU     RECBUF+8        THE DATE (IN CUBS)
1) PROJ   EQU     RECBUF+9        PROJECT CODE (MAX 12 CHARS)
1) JOB    EQU     RECBUF+13       THE REQUEST NUMBER (DECIMAL)
1) REQBY  EQU     RECBUF+14       NAME OF REQUESTOR (MAX 12 CHARS)
1) NCHR   EQU     RECBUF+18       NUMBER OF CHARACTERS PROCESSED (DECIMAL)
1) NPAG   EQU     RECBUF+19       NUMBER OF PAGES PROCESSED (DECIMAL)
1) PARTS  EQU     RECBUF+20       NUMBER OF PARTS OF PAPER (DECIMAL)
1) CARPRO EQU     RECBUF+21       NUMBER OF CARDS PROCESSED (DECIMAL)
1) FILPRO EQU     RECBUF+21       NUMBER OF FILES PROCESSED (DECIMAL)
1) TAPPUR EQU     RECBUF+22       NUMBER OF TAPES PURCHASED (DECIMAL)
1) TAPCON EQU     RECBUF+23       NUMBER OF TAPES CONVERTED (DECIMAL)
1) DECCOL EQU     RECBUF+24       LISTINGS DECOLLATED (1 = NO, 2 = YES)
1) CURREN EQU     RECBUF+25       TYPE OF CURRENCY (3 CHARACTER CODE)
1) POST   EQU     RECBUF+26       POSTAGE CHARGES (IN CENTS OR EQUIVALENT)
1) FLAG   EQU     RECBUF+27       SUPPOSEDLY SPARE, BUT USED FOR SOMETHING
1)         ZRO
****373
2) UNAME  EQU     RECBUF+1
2) GAN    EQU     RECBUF+5
2) UUN    EQU     RECBUF+6
2) HOST   EQU     RECBUF+7
2) EDATE  EQU     RECBUF+8
2) PROJ   EQU     RECBUF+9
2) JOB    EQU     RECBUF+13
2) REQBY  EQU     RECBUF+14
2) NCHR   EQU     RECBUF+18
2) NPAG   EQU     RECBUF+19
2) PARTS  EQU     RECBUF+20
2) CARPRO EQU     RECBUF+21
2) FILPRO EQU     RECBUF+21
2) TAPPUR EQU     RECBUF+22
2) TAPCON EQU     RECBUF+23
2) DECCOL EQU     RECBUF+24
2) CURREN EQU     RECBUF+25
2) POST   EQU     RECBUF+26
2) FLAG   EQU     RECBUF+27
2)         ZRO
********300
1) * CIN IS PRIMARY INPUT FILE AND TOUT IS PRIMARY OUTPUT FILE.
1) * THESE ARE USUALLY BOTH THE TELETYPE BUT MIGHT BE DIFFERENT
1) CIN     ZRO
****395
2) CIN     ZRO
********322
1) *M18     ASC     '$DISTRICT NO: /'
1) M19     ASC     '$ENTER POSTAGE OR TRANSPORTATION CHARGE: /'
****423
2) M18     ASC     '$DISTRICT NO: /'
2) M19     ASC     '$ENTER POSTAGE OR TRANSPORTATION CHARGE: /'
********348
1) M25     ASC     '$NUMBER OF TAPES PURCHASED: /'
1) M26     ASC     '$ALL ENTRIES CORRECT? /'
****430
2) M25     ASC     '$NUMBER OF TAPE PURCHASED: /'
2) M26     ASC     '$ALL ENTRIES CORRECT? /'
********355
1) *FIND AN UNPROCESSED RECORD IN (SPOOL)RECREMOTE OR RECREMOTEA.
1) *THE RECORD NUMBER MUST BE IN THE A REGISTER UPON ENTRY.
1) * TAKE A SKIP RETURN TO CALLER IF WE FIND A RECORD.
1) 
1) FNDREC  ZRO
****462
2) *FIND A UNPROCESSED RECORD IN (*4ACCT)BATCHREC OR BATCHRECA.
2) *THE RECORD NUMBER MUST BE IN THE A REGISTER UPON ENTRY
2) *NO SKIP RECORD NOT FOUND, SKIP RECORD FOUND
2) 
2) FNDREC  ZRO
********387
1)         BRM     ORECF          OPEN RECREMOTE IN WRITE MODE (BUT WILL READ ONLY)
1) FREC3   CLA
1)         SCP     RECFNO         SET CURSOR TO BEGIN OF FILE (NOW IN READ MODE)
1)           HLT     0              OOPS--AN ERROR SETTING CURSOR SO STOP
1)         RSP     RECFNO         LOOK UP SIZE OF FILE
1)         STA     CPTOP          AND SAVE IT IN CPTOP
1) FREC1   RCP     RECFNO         READ THE CURSOR POSITION IN FILE
1)         SNE     CPTOP
1)         BRU     FREC2          FILE IS EMPTY, SO CLOSE IT AND SEE IF MORE TO DO
1)         STA     RECCUR          (SAVE FOR POSSIBLE WRITE)
****468
2)         BRM     ORECF
2) FREC3   CLA
2)         SCP     RECFNO
2)         HLT     0
2)         RSP     RECFNO
2)         STA     CPTOP
2) FREC1   RCP     RECFNO
2)         SNE     CPTOP
2)         BRU     FREC2
2)         STA     RECCUR          (SAVE FOR POSSIBLE WRITE)
********393
1)         BIO     RECFNO         READ A RECORD FROM RECREMOTE INTO RECBUF
1)         NOP
1) 
1) * FOR RCHARGE, IF JOB TYPE IS NOT 9, READ THE NEXT RECORD
1)        IF RCHG; LDA RECBUF; ETR =7777B; SKE =9; BRU FREC1; ENDF
1)         SKN     ALLSW          SKIP NEXT INSTR IF WE ARE LOOKING AT ALL RECS
1)         BRU     *+2
****480
2)         BIO     RECFNO
2)         NOP
2)        IF RCHG; LDA RECBUF; ETR =7777B; SKE =9; BRU FREC1; ENDF
2)         SKN     ALLSW
2)         BRU     *+2
********405
1) FREC1C  RCP     RECFNO         READ OUR CURRENT POSITION IN RECORD FILE
1)         STA     ALLCUR         SAVE IT IN ALLCUR
1)         SKN     LSTSW
****490
2) FREC1C  RCP     RECFNO
2)         STA     ALLCUR
2)         SKN     LSTSW
********413
1)         SKE     FJOB           SKIP IF THE CURRENT REC IS THE ONE WE WANT
1)         BRU     FREC1          GO FIND NEXT RECORD
1) 
1)         SKN     ORECSW         SKIP IF WE FOUND THE REC IN RECREMOTEA
1)         BRU     *+2
****502
2)         SKE     FJOB
2)         BRU     FREC1
2) 
2)         SKN     ORECSW
2)         BRU     *+2
********425
1)         BRS     2              CLOSE THE FILE
1)         MIN     FNDREC
1)         BRR     FNDREC         AND TAKE THE SKIP RETURN
1) FREC2   LDA     RECFNO
****512
2)         BRS     2
2)         MIN     FNDREC
2)         BRR     FNDREC
2) FREC2   LDA     RECFNO
********435
1)         SKN     RECFB          IF WE WERE NOT LOOKING AT RECREMOTEA GO LOOK
1)         BRU     *+2
****517
2)         SKN     RECFB
2)         BRU     *+2
********440
1)         BRU     FREC3          WE OPENED RECREMOTEA SO GO LOOK FOR A RECORD
1) FREC4   SKN     ORECSW
****521
2)         BRU     FREC3
2) FREC4   SKN     ORECSW
********444
1)         BRR     FNDREC         TAKE THE SKIP RETURN TO CALLER--WE FOUND A REC
1) FREC5   LDA     FLAG
****526
2)         BRR     FNDREC
2) FREC5   LDA     FLAG
********449
1)         BRR     FNDREC         TAKE THE SKIP RETURN TO CALLER
1) FJOB    ZRO
1) *  RECCUR WILL POINT TO THE LOCATION OF A RECORD IN ACCOUNTING FILE
1) RECCUR  ZRO
****533
2)         BRR     FNDREC
2) FJOB    ZRO
2) RECCUR  ZRO
********456
1)         CAX                    X NOW HAS THE FILE DIRECTORY NUMBER
1)         LDA     FILDAT+4       LOAD INDEX BLOCK PTR INTO A
1)         BRR     GIP
****569
2)         CAX
2)         LDA     FILDAT+4
2)         BRR     GIP
********491
1) *** OPFIL:  OPEN A FILE IN WRITE MODE
1) ***         STRING POINTER TO FILE NAME IN FILPT
1) ***         FILE TYPE (BINARY, SYMBOLIC, ETC.) IN FILTYP
1) ***         NO SKIP RETURN:    FAILURE WITH ERR NUMBER IN X
1) ***         SKIP RETURN:       SUCCESS WITH FILE NUMBER IN A
1) ***         IF FILE DOES NOT EXIST, MAKE IT
1) ***         IF FILE IS BUSY, TELL USER, WAIT, AND TRY TO OPEN AGAIN
1) 
1) OPFIL   ZRO
****574
2) *OPEN A FILE IN WRITE MODE EXPECT POINTERS IN FILPT
2) *NO SKIP UNSUCESSFUL WITH
2) *ERROR NUMBER IN X, SKIP SUCESSFUL WITH FILE NUMBER IN A
2) 
2) OPFIL   ZRO
********496
1)         BRR     OPFIL          TAKE THE SKIP RETURN
1) OPFI1   LDP     FILPT
****593
2)         BRR     OPFIL
2) OPFI1   LDP     FILPT
********511
1)         SKE     =1              FILE BUSY (RECALL THAT ERR NUM WAS IN X)
1)           BRU     *+3
****602
2)         SKE     =1              (FILE BUSY)
2)         BRU     *+3
********520
1)   IF      RCHG
****628
2) *FILE POINTERS
2) 
2)        IF      RCHG
********546
1) * FILE POINTERS FOR DEBUGGING RCHARGE
1) BAREC  ASC '(HINCKLEYM)RECREMOTEA'     (SPOOL) IN PRODUCTION VERSION
1) BMTD   ASC '(HINCKLEYM)XXXBATXX'       (*4ACCT) IN PRODUCTION VERSION
1) PURGF  ASC "(HINCKLEYM)BREC'TMP'"      (SPOOL) IN PRODUCTION VERSION
1) VOIDF  ASC '(HINCKLEYM)VOIDREM'        (SPOOL) IN PRODUCTION VERSION
1) BRECP  DATA 3*BAREC-1,3*BAREC-1+20
****631
2)        REM     DEBUG VERSION
2) *FILE POINTERS
2) 
2) BAREC  ASC '(HINCKLEYM)RECREMOTEA'
2) BMTD   ASC '(HINCKLEYM)XXXBATXX'
2) PURGF  ASC "(HINCKLEYM)BREC'TMP'"
2) VOIDF  ASC '(HINCKLEYM)VOIDREM'
2) ACT   ASC '(HINCKLEYM)/ACCOUNTING/'
2) BRECP  DATA 3*BAREC-1,3*BAREC-1+20
********550
1) SYSPTR DATA    3*BMTD-1+11
****641
2) ACTPTR DATA 3*ACT-1,3*ACT-1+23
2) SYSPTR DATA    3*BMTD-1+11
********563
1) * FILE POINTERS FOR PRODUCTION VERSION OF RCHARGE
1) BAREC  ASC '(SPOOL)RECREMOTEA'
1) BMTD   ASC '(*4ACCT)XXXBATXX'
1) PURGF  ASC "(SPOOL)BREC'TMP'"
1) VOIDF  ASC '(SPOOL)VOIDREM'
1) BRECP  DATA 3*BAREC-1,3*BAREC-1+16
****646
2)        REM     PRODUCTION VERSION
2) BAREC  ASC '(SPOOL)RECREMOTEA';*(SPOOL) IN FINAL VERSION
2) BMTD   ASC '(*4ACCT)XXXBATXX';*(*4ACCT) IN FINAL VERSION
2) PURGF  ASC "(SPOOL)BREC'TMP'";* (SPOOL) IN FINAL VERSION
2) VOIDF  ASC '(SPOOL)VOIDREM';* (SPOOL) IN FINAL VERSION
2) ACT   ASC '(*4PROG)/ACCOUNTING/';* (*4PROG) IN FINAL VERSION
2) BRECP  DATA 3*BAREC-1,3*BAREC-1+16
********570
1) SYSPTR DATA    3*BMTD-1+8
****656
2) ACTPTR DATA 3*ACT-1,3*ACT-1+20
2) SYSPTR DATA    3*BMTD-1+8
********581
1) * FILE POINTERS FOR DEBUGGING VERSION OF BCHARGE
1) BAREC  ASC     '(HINCKLEYM)RECBATCHA'  (*4ACCT) IN PRODUCTION VERSION
1) BMTD   ASC     '(HINCKLEYM)KKKBATKK'   (*4ACCT) IN PRODUCTION VERSION
1) PURGF  ASC     "(HINCKLEYM)BREC'TMP'"  (*4ACCT) IN PRODUCTION VERSION
1) VOIDF  ASC     '(HINCKLEYM)VOIDBAT'    (*4ACCT) IN PRODUCTION VERSION
1) BRECP   DATA   3*BAREC-1,3*BAREC-1+19
****663
2)        REM    'DEBUG VERSION '
2) BAREC   ASC     '(HINCKLEYM)RECBATCHA'
2) BMTD    ASC     '(HINCKLEYM)KKKBATKK'
2) PURGF   ASC     "(HINCKLEYM)BREC'TMP'"
2) VOIDF   ASC     '(HINCKLEYM)VOIDBAT'
2) ACT     ASC     '(HINCKLEYM)/ACCOUNTING/'
2) BRECP   DATA    3*BAREC-1,3*BAREC-1+19
********589
1)       ELSE
1) * FILE POINTERS FOR PRODUCTION VERSION OF BCHARGE
1) BAREC   ASC    '(*4ACCT)RECBATCHA'
1) BMTD    ASC    '(*4ACCT)KKKBATKK'
1) PURGF   ASC    "(*4ACCT)BREC'TMP'"
1) VOIDF   ASC    '(*4ACCT)VOIDBAT'
1) BRECP   DATA   3*BAREC-1,3*BAREC-1+16
****677
2) ACTPTR  DATA    3*ACT-1,3*ACT-1+22
2)        ELSE
2) BAREC   ASC     '(*4ACCT)RECBATCHA'
2) *(*4ACCT) IN FINAL VERSION
2) BMTD    ASC     '(*4ACCT)KKKBATKK'
2) *(*4ACCT) IN FINAL VERSION
2) PURGF   ASC     "(*4ACCT)BREC'TMP'"
2) * (*4ACCT) IN FINAL VERSION
2) VOIDF   ASC     '(*4ACCT)VOIDBAT'
2) * (*4ACCT) IN FINAL VERSION
2) ACT     ASC     '(*4PROG)/ACCOUNTING/'
2) * (*4PROG) IN FINAL VERSION
2) BRECP   DATA    3*BAREC-1,3*BAREC-1+16
********604
1) SYSPTR DATA   3*BMTD-1+8
****688
2) ACTPTR  DATA    3*ACT-1,3*ACT-1+20
2) SYSPTR DATA    3*BMTD-1+8
********621
1) *OPEN (SPOOL)RECREMOTE  IN WRITE MODE -- FILE NUMBER STORED IN RECFNO
1) ORECF   ZRO
****697
2) *OPEN (*4ACCT)BATCHREC
2) 
2) ORECF   ZRO
********630
1)         STA     FILTYP         SAY IT IS A BINARY FILE
1)         BRM     OPFIL          OPEN THE FILE IN WRITE MODE (BUT WILL ONLY READ)
1)         BRU     ORECF1          (FAILURE)
****702
2)         STA     FILTYP
2)         BRM     OPFIL
2)         BRU     ORECF1          (FAILURE)
********636
1)         STA     RECFB           (FLAG AS RECREMOTE AS LAST FILE OPENED)
1)         CLA
1)         SCP     RECFNO         POINT TO BEGIN OF FILE AND SET TO READ
1)         HLT     0
****707
2)         STA     RECFB           (FLAG AS BATCHREC LAST FILE OPENED)
2)         CLA
2)         SCP     RECFNO
2)         HLT     0
********641
1) * RECFB IS 0 WHEN (SPOOL)RECREMOTE WAS LAST FILE OPENED AND IS -1 WHEN
1) * RECREMOTEA WAS THE LAST FILE OPENED
1) RECFB   ZRO
1) 
1) *OPEN (SPOOL)RECREMOTEA IN WRITE MODE  -- FILE NUMBER STORED IN RECFNO
1) ORECFA  ZRO
****718
2) RECFB   ZRO
2) *OPEN (*4ACCT)BATCHRECA
2) 
2) ORECFA  ZRO
********652
1)         STA     FILTYP         SAY IT IS A BINARY FILE
1)         BRM     OPFIL          OPEN IT IN WRITE MODE 
1)           BRU     ORF1A           (FAILURE)
****727
2)         STA     FILTYP
2)         BRM     OPFIL
2)         BRU     ORF1A           (FAILURE)
********659
1)         STA     RECFB           (FLAG AS RECREMOTEA AS THE LAST FILE OPENED)
1)         CLA
1)         SCP     RECFNO         POINT TO BEGIN OF FILE FOR READING
1)           HLT     0
****732
2)         STA     RECFB           (FLAG AS BATCHRECA AS LAST FILE OPENED)
2)         CLA
2)         SCP     RECFNO
2)         HLT     0
********664
1)         BRS     10             RETURN TO EXEC
1) 
1) *OPEN (*4ACCT)NNN-BAT-MO FILE (NNN IS SYSTEM NUMBER, -MO IS CURRENT MONTH)
1) 
1) OBMTD   ZRO 0; SKN MTDOPN; BRU *+2; BRR OBMTD
1)         LDP     BMTDPT
1)         STP     FILPT
1)         LDA     =2
1)         STA     FILTYP
****739
2)         BRS     10
2) 
2) *OPEN (*4PROG)/ACCOUNTING/
2) 
2) OPNACT  ZRO
2)         LDP     ACTPTR
2)         STP     FILPT
2)         LDA     =3
2)         STA     FILTYP
********671
1)         BRU     OBMTD1          (FAILURE)
****749
2)         BRU     OPNA1
2)         STA     AFIL
2)         CLA
2)         SCP     AFIL
2)         HLT     0
2)         BRR     OPNACT
2) OPNA1   MSG     MOPNA
2)         MSG     MNOTIF
2)         BRU     THRU
2) MOPNA   ASC     '$UNABLE OPEN (*4PROG)SLASH ACCOUNTING SLASH/'
2) AFIL    ZRO
2) 
2) *OPEN (*4ACCT)/BMTD/
2) 
2) OBMTD   ZRO 0; SKN MTDOPN; BRU *+2; BRR OBMTD
2)         LDP     BMTDPT
2)         STP     FILPT
2)         LDA     =2
2)         STA     FILTYP
2)         BRM     OPFIL
2)         BRU     OBMTD1          (FAILURE)
********681
1) * READ A DECIMAL NUMBER FROM THE INPUT FILE
1) * TAKES A SKIP RETURN IF WE GET A NUMBER AND RETURNS TO CALLER+1 IF NOT
1) RDNO    ZRO
****913
2) * READ A DECIMAL NUMBER FROM THE FILE WHOSE NUMBER IS STORED IN CIN
2) RDNO    ZRO
********865
1) * WRITE A DECIMAL NUMBER TO THE OUTPUT FILE
1) TDNO    ZRO
****926
2) TDNO    ZRO
********876
1) * WRITE A DECIMAL NUMBER TO THE PRIMARY OUTPUT FILE
1) TONO    ZRO
****933
2) TONO    ZRO
********881
1) * WRITE A DECIMAL NUMBER TO THE FILE WHOSE NUMBER IS STORED IN FNO
1) PDNO    ZRO
****940
2) PDNO    ZRO
********886
1) * WRITE AN OCTAL NUMBER TO THE FILE WHOSE NUMBER IS STORED IN FNO
1) PONO    ZRO
****947
2) PONO    ZRO
********891
1)         BRS     71             SKIP IF USER HAS SET SYSTEM OR EXEC STATUS
1)         BRU     VER1A
****1790
2)         BRS     71
2)         BRU     VER1A
********1733
1)         BRU     *-1            NOTE THAT HE HAS SET STATUS
1)         BRU     VER1B
****1793
2)         BRU     *-1
2)         BRU     VER1B
********1736
1)         SKN     STASW          SYSTEM OR EXEC STATUS SET?
1)         BRU     *+4            NOPE--FORCE VALIDATION OF PASSWORD
1)         BRM     EDVER          STATUS IS SET--JUST GET HIS NAME
1)         MIN     VERSW
****1819
2)         SKN     STASW
2)         BRU     *+4
2)         BRM     EDVER
2)         MIN     VERSW
********1762
1) * READ AN OCTAL NUMBER FROM SFIL
1) FONO    ZRO
****1923
2) FONO    ZRO
********1866
1) *MAKE A CHARGE RECORD AND WRITE INTO (*4ACCT)/BMTD/
1) 
1) CHG     LDA     TERMCH
1)         SKE     =155B
1)         BRU     CHGOPT         GET THE OPTION (EITHER A NUMBER OR ALL)
1) CHG1   LDA     =-1
1) *      STA     VERSW           LETS FORCE VALIDATION
1)         BRM     VER            IF VERSW IS NEGATIVE, GET PASSWORD AND VERIFY
1)         BRM     CKSPL           (CHECK FOR COMPLETED SPOOL REC)
1)         LDA     =1
1)         STA     FNO
1)         SKN     ALLSW
1)         BRU     *+2
1)         BRU     CHGALL         WE ARE DOING ALL RECORDS, SO GO BACK TO CHGALL
1)         SKN     CNUMSW
1) CHG2    BRM     GREQNO         ASK FOR A REQUEST NUMBER (WILL BE STORED IN FJOB)
1)         CLA
1)         STA     CNUMSW
1)         STA     HTOTAL
1)         STA     ACCUM
1)         BRM     FNDREC         FIND THE REQUESTED RECORD
1)         BRU     ECHG1C          (COULD NOT FIND)
1) CHG22  LDP     TOTAL           COPY TOTAL INTO A REG AND VOL INTO B REG
1)        BRM     RECVT
1)        STA     HTOTAL
1)        STA     ACCUM
1)        SNE     =0
1)        BRU     CHG2B
1)        LDA     =-1
1)        STA     AGINSW
1) CHG2B   LDA     =HOLD
1)         STA     PTRB
1) CHG2C   BRM     PUCREC
1)         MSG     M9              (OKAY?)
1)         BRM     YN
1)         BRU     ECHG1A          (NOT THE ONE)
1) CHG2E  BRM GLDIST
1)        LDA TDIST               PUT DISTRICT IN A AND NOW CHECK IT
1) * SET FRENCSW, UKSW, GERSW, AND BELGSW IN ACCORD WITH CUSTOMER'S DISTRICT
1) *CHG2E   LDA     TDIST          LOOK UP THE DISTRICT
1)         SKG     =79
1)         SKG     =69
1)         BRU     *+3
1) CHG2A   BRM     FRENCH
1)         BRU     CHG3A
1)         SKG     =189
1)         SKG     =179
1)         BRU     *+3
1)         BRM     ENG
1)         BRU     CHG3A
1)        SKG     =199            GERMANY IS DIST 190-199
1)        SKG     =189
1)        BRU     *+3             EITHER US OR BELGIUM
1)        BRM     GERMAN
1)        BRU     CHG3A
1)        SKG     =39             CHECK FOR BELG
1)        SKG     =29             STILL CHECKING 30-39
1)        BRU     CHGUS           MUST BE US
1)        SKE     =31             IS THIS BELGIUM
1)        BRU     *+3
1)        BRM     BELGIU          THIS IS BELGIUM
1)        BRU     CHG3A           CHARGE IT
1)        BRM     FRENCH          EVERY ON ELSE IN AREA 30 IS FRENCH
1)        BRU     CHG3A           CHG IT
1) CHGUS   CLA                    THIS IS US
1)         STA     FRENSW
1)        STA     GERSW
1)        STA     BELGSW
1)         STA     UKSW
1)         BRU     CHG3A
1) BELGIU ZRO
1)        SKR     BELGSW
1)        BRU     *-1
1)        CLA
1)        STA     UKSW
1)        STA     FRENSW
1)        STA     GERSW
1)        BRR     BELGIU
1) * MAKE FRENCSW NEGATIVE AND CLEAR UKSW, GERSW, AND BELGSW
1) FRENCH ZRO
1) FR1    SKR     FRENSW
1)        BRU     *-1
1)        CLA
1)        STA     UKSW
1)        STA     GERSW
1)        STA     BELGSW
1)   IF BCHG
1)        LDA     SAWFRN
1)        SKE     =0              HAS USER BEEN TOLD THIS IS AN AREA 7 CUSTOMER?
1)          BRR     FRENCH        YES, SO RETURN
1)        LDA     =-1
1)        STA     SAWFRN          INDICATE THAT WE HAVE TOLD USER THIS ONE IS FREN
1)        MSG     FRNMSG          AND NOW TELL HIM
1)   ENDF
1)        BRR     FRENCH
1) * SAWFRN IS -1 WHEN PROGRAM USER HAS BEEN TOLD THIS IS AN AREA 7 USER
1) SAWFRN ZRO
1) FRNMSG ASC     '$THIS IS AN AREA 7 CHARGE.  EFFECTIVE SEPTEMBER 1, 1978:'
1)        ASC     '$USE JOB TYPES 4 AND 5 FOR STORE AND RESTORE.'
1)        ASC     '$USE JOB TYPE 8 FOR TAPE CONVERSION.$/'
1) 
1) ENG     ZRO
1)         SKR     UKSW
1)         BRU     *-1
1)         CLA
1)         STA     FRENSW
1)        STA     BELGSW
1)        STA     GERSW
1)         BRR     ENG
1) GERMAN ZRO
1)        SKR     GERSW
1)        BRU     *-1
1)        CLA
1)        STA     FRENSW
1)        STA     UKSW
1)        STA     BELGSW
1)        BRR     GERMAN
1) CHG3A   LDA     FLAG
1)        SNE     =4              RECORD AWAITING TRANS /POST CHG
1)        BRU     SPR2
1)         SKA     =1
1)         BRU     SPOREC          (SPOOLING RECORD)
1)         SNE     =3
1)         BRU     SPOREC          (ALSO A SPOOLING RECORD)
1) CHG3    MSG     M10            ASK FOR BATCH TYPE
1)         BRM     CLBUF          CLEAR INPUT BUFFER UP TO NEXT CARRIAGE-RETURN
1)         BRM     RDNO           GET A NUMBER FROM THE INPUT FILE
1)         BRU     RESET          DID NOT GET A NUMBER SO GO GET A FRESH COMMAND
1)         SKG     =13
1)         SKG     =0
1)         BRU     CHG4
1)         STA     TYPE           TYPE WILL BE >0 AND <14
1)         CAX
1)        MRG =10000B; STA TYPE   AND TYPE NOW HAS THE FULL TRANSACTION CODE
1)         BRU*    BRUTAB,2       ADDITIONAL PROCESSING FOR EACH TYPE
1) CHG4    LDX     =-1
1)         BRS     11             FLUSH INPUT BUFFER
1)         BRU     CHG3           ASK FOR BATCH TYPE AGAIN
1) 
1) BRUTAB  DATA    BADX,PRINT,RDCARD,PCARD,RTAPE,WTAPE,BADX,TAPEC,TAPEIO
1)        DATA    BADX,BADX,BADX,TAPBUY,ENDCHG
1) 
1) BADX   MSG     ILLTYP          ILLEGAL BATCH TYPE
1)        BRU     CHG3              SO ASK FOR IT AGAIN
1) 
1) PRINT   MSG     M11             (PAGES)
1)         BRM     CLBUF
1)         BRM     RDNO
1)         BRU     RESET
1)         STA     NPAG
1) PRINT1 LDA     =1              ASSUM NO DEC CHG
1)        STA     DECCOL
1)         MSG     M12             (NO. OF PARTS)
1)         BRM     CLBUF
****2012
2) CKACT   ZRO
2)         SKN     ABSW
2)         BRR     CKACT
2) *       BRM     ACTBUS
2) *       BRU     RESET
2)         BRR     CKACT
2) 
2) *CHECKS (*4PROG)/ACCOUNTING/ TO SEE IF BUSY BY SOME OTHER PROGRAM
2) *IF SO TAKES EXECPTION RETURN (NO SKIP)
2) *IF NOT BUSY MAKES IT BUSY BY PUTING THE "ACCOUNTING BUSY"
2) *MESSAGE IN IT AND TAKES NORMAL RETURN (SKIP)
2) 
2) ACTBUS  ZRO
2)        IF DEBUG; BRU ABUS2; ELSE; ENDF
2)         SKN     ABSW
2)         BRU     ABUS2
2)         BRM     OPNACT
2)         CIO     AFIL
2)         SKE     =2
2)         BRU     AB2
2)         CIO     AFIL
2)         SKE     =2
2)         BRU     *+2
2)         BRU     AB1
2)         CIO     =1
2)         BRU     *-5
2) AB1     TCO     =155B
2)         LDA     AFIL
2)         BRS     2
2)         BRR     ACTBUS
2) AB2     MIN     ABSW
2)         LDA     =4B7
2)         SCP     AFIL
2)         HLT     0
2)         LDA     AFIL
2)         XMA     FNO
2)         STA     AFIL
2)         MSGP    ABUS
2)         BRM     GDSTG
2)         LDP     STGPTR
2)         LDX     FNO
2)         BRS     35
2)         LDA     =155B
2)         CIO     FNO
2)         LDP     VPTR1
2)         LDX     FNO
2)         BRS     35
2)         LDA     ='   "'
2)         CIO     FNO
2)         CR      1
2)         MSGP    ABUS1
2)         CR      1
2)         LDA     AFIL
2)         XMA     FNO
2)         STA     AFIL
2)         BRS     2
2)         BRS     113
2)         BRU     ABUS2
2) ABUS    ASC     '"ACCOUNTING BUSY BATCH ENTRY STARTED /'
2) ABUS1   ASC     'COM TEL/'
2) ABUS2   MIN     ACTBUS
2)         BRR     ACTBUS
2) 
2) *RESETS (*4PROG)/ACCOUNTING/ TO UNBUSY
2) 
2) RESACT  ZRO
2)         SKN     ABSW
2)         BRU     *+2
2)         BRR     RESACT          (NOT BUSY)
2)         BRM     OPNACT
2)         LDA     =4B7
2)         SCP     AFIL
2)         HLT     0
2)         LDX     =-6
2)         LDA     ACTDAT,2
2)         WIO     AFIL
2)         BRX     *-2
2)         RSP     AFIL
2)         MRG     =4B7
2)         PCE     AFIL
2)         NOP
2)         LDA     AFIL
2)         BRS     2
2)         LDA     =-1
2)         STA     ABSW
2)         BRR     RESACT
2)         DATA    11627400B,2020024B,14031057B,11604417B,10221443B
2)         DATA    15007555B
2) ACTDAT  EQU     *
2) 
2) ABSW    DATA    -1
2) 
2) GDSTG   ZRO
2)         LDX     =-6
2)         CLA
2)         STA     DATBUF+6,2
2)         BRX     *-1
2)         LDP     HSTGPT
2)         BRS     140
2)         BRR     GDSTG
2) DATBUF  BSS     6
2) HSTGPT  DATA    3*DATBUF-1,3*DATBUF-1
2) STGPTR  DATA    3*DATBUF-1,3*DATBUF-1+15
2) 
2) *GET CUSTOMER NUMBER AND DISTRICT
2) 
2) FCUST   ZRO
2)          BRR     FCUST
2)         LDP     AIDPT
2)         BRS     64
2)         BRU     FCUST3
2)         STA     AIDFNI
2) FC1     LDP     AXPT
2)         BRS     64
2)         BRU     FCUST4
2)         STA     AXFNI
2)         RSP     AXFNI
2)         STA     CPTOP
2) FCUST1  RCP     AXFNI
2)         SNE     CPTOP
2)         BRU     FCUST5
2)         WIO     AXFNI
2)         SKE     GAN
2)         BRU     FCUST2
2)         WIO     AXFNI
2)         SUB     =1
2)         MUL     =3
2)         LSH     23
2)         SCP     AIDFNI
2)         BRU     FC3A
2)         LDA     =40
2)         LDX     =ACTREC
2)         BIO     AIDFNI
2)         NOP
2)         LDA     AIDFNI
2)         BRS     20
2)         LDA     AXFNI
2)         BRS     20
2)         LDA     ACID
2)         STA     CUST
2)         BRR     FCUST
2) FCUST2  WIO     AXFNI
2)         BRU     FCUST1
2) FCUST3  CXA
2)         SNE     =1
2)         BRU     FC3
2)         SNE     =30
2)         BRU     FC3
2) FC3A    MSG     MBAID
2)         MSG     MNOTIF
2)         BRU     THRU
2) FC3     BRM     BUSY
2)         BRU     FCUST+1
2) MBAID   ASC     '$UNABLE OPEN (*4ACCT)SLASH AI&D SLASH/'
2) FCUST4  CXA
2)         SNE     =1
2)         BRU     FC4
2)         SNE     =30
2)         BRU     FC4
2) FC4A    MSG     MBAX
2)         MSG     MNOTIF
2)         BRU     THRU
2) FC4     BRM     BUSY
2)         BRU     FC1
2) MBAX    ASC     '$UNABLE OPEN (*4ACCT)SLASH AX SLASH/'
2) FCUST5  LDA     AXFNI
2)         BRS     20
2)         LDA     AXFNI
2)         BRS     20
2)         LDA     =-1
2)         STA     CUST
2)         BRR     FCUST
2) ACTREC  BSS     40
2) ACID    EQU     ACTREC+4
2)        IF      DEBUG
2) AX     ASC     '(HINCKLEYM)/AX/'
2) AID    ASC     '(HINCKLEYM)/AI&D/'
2) AXPT   DATA    3*AX-1,3*AX-1+15
2) AIDPT  DATA    3*AID-1,3*AID-1+17
2)        ELSE
2) AX      ASC     '(*4ACCT)/AX/'
2) AID     ASC     '(*4ACCT)/AI&D/'
2) AXPT    DATA    3*AX-1,3*AX-1+12
2) AIDPT   DATA    3*AID-1,3*AID-1+14
2)        ENDF
2) AIDFNI  ZRO
2) AXFNI   ZRO
2) 
2) *GET DISTRICT NUMBER FOR PRICING IF DIST-CUST WORD -1
2) 
2) GTDIST  ZRO
2)         MSG     M18             (DISTRICT)
2)         BRM     CLBUF
********1954
1)         SKG     =4             MAXIMUM OF 4-PART PAPER ALLOWED
1)         SKG     =0             NO 0-PART OR NEGATIVE-PART PAPER ALLOWED
1)         BRU     PRINT1
1)         STA     PARTS          NO. OF PARTS IS REASONABLE, SO STORE IT
1)         SNE     =1
1)         BRU     ANOTH
1) PRINT2  MSG     M13             (WERE LISTING DECOLLATED)
1)         BRM     YN
1)         BRU     ANOTH
1)         LDA     =2
1)        STA     DECCOL
1)        BRU     ANOTH
1) PRINT3 LDA =1
1)        STA DECCOL
1) ANOTH  SKN     AGINSW
1)        BRU     *+2
1)        BRU     ENDCHG
1)         MSG     M16             (ANOTHER BATCH TYPE FOR THIS REQUEST)
1)         BRM     YN
1)         BRU     ENDCHG          (NO)
1)         BRM     MOVREC
1)         CLAB
1)        STP     RECBUF+18
1)        STP     RECBUF+20
1)        STP     RECBUF+22
1)        STP     RECBUF+24
1)        STP     RECBUF+26
1)        LDA     =-1
1)        STA     TWOFLG
1)         BRU     CHG3
1) ENDCHG CLA
1)        SKN     NULLSW          DO NOT ALLOW ON REC
1)        LDA     =-1
1)        STA     ALLHOL          ALLOW HOLD COMMAND HERE ONLY!
1)        MSG     M14             (ANY TRANSPORTATION CHARGES)
1)         BRM     YN
1)         BRU     END2           NO ENTERED
1)        BRU     END1            YES ENTERED
1)        LDA     =4
1)        STA     FLAG
1)        BRU     END2
1) END1    MSG     M15             (ENTER AMOUNT)
1) END1A   BRM     RAMT
1)         BRM     CHECK
1) 
1)         SKG     =MINPOS
1)         SKG     =0
1)         BRU     *+2
1)         BRU     ECHG1B
1) END2    CLA
1)        STA     ALLHOL          DO NOT ALLOW HOLD TO BE ENTERED
1) ECHG1  NOP
1)         BRM     MOVREC
1)         MSG     M26             (ALL ENTRIES CORRECT
1)         BRM     YN
1)         BRU     AGAIN
1)        SKN     TWOFLG          -1=> WRITE SOME RECS TO /BMTD/
1)        SKN     HOLDSW          -1=> HOLD IT IN BREC,BRECA
1)         BRM     WCHG
1)         SKN     NULLSW
1)         BRU     *+2
1)         BRU     ECHG1A
1)        LDA     FLAG
1)        SKN     HOLDSW
1)         LDA     =-1
1)         STA     FLAG
1)         BRM     WREC
1) ECHG1A CLA; STA HOLDSW
1)         SKN     ALLSW
****2168
2)         MIN     GTDIST
2)         BRR     GTDIST
2) 
2) *MAKE A CHARGE RECORD AND WRITE INTO (*4ACCT)/BMTD/
2) 
2) CHG     LDA     TERMCH
2)         SKE     =155B
2)         BRU     CHGOPT
2) CHG1   LDA     =-1
2) *      STA     VERSW           LETS FORCE VALIDATION
2)         BRM     VER
2) *       BRM     CKACT
2)         BRM     CKSPL           (CHECK FOR COMPLETED SPOOL REC)
2)         LDA     =1
2)         STA     FNO
2)         SKN     ALLSW
********2149
1)         BRU     CHGA1
1)         SKN     NULLSW
1)         BRU     *+2
1)         BRU     NULL6
1)         SKN     CRESW
1)         BRU     *+2
1)         BRU     RESET
1)         MSG     M17             (ANOTHER REQUEST)
1)         BRM     YN
1)         BRU     RESET
1)        CLA; STA HOLDSW
1)         BRU     CHG2
1) ECHG1B  MSG     M31
1)         LDX     =-1
1)         BRS     11
1)         BRU     END1
1) T1      ZRO
1) ECHG1C  MSG     M28
1)         LDX     =-1
1)         BRS     11
1)         BRU     ECHG1A
1) 
1) AGAIN   SKN     NULLSW
1)         BRU     *+2
1)         BRU     NULL5
1)         SKN     CRESW
1)         BRU     *+2
1)         BRU     RESET
1)         MSG     M27             (REENTER ALL DATA)
1)         LDX     =-1
1)         BRS     11
1)         CLAB
****2238
2)         BRU     CHGALL
2)         SKN     CNUMSW
2) CHG2    BRM     GREQNO
2)         CLA
2)         STA     CNUMSW
2)         STA     HTOTAL
2)         STA     ACCUM
2)         BRM     FNDREC
2)         BRU     ECHG1C          (COULD NOT FIND)
2) CHG22  LDP     TOTAL
2)        BRM     RECVT
2)        STA     HTOTAL
2)        STA     ACCUM
2)        SNE     =0
2)        BRU     CHG2B
2)        LDA     =-1
2)        STA     AGINSW
2) CHG2B   LDA     =HOLD
2)         STA     PTRB
2)         LDA     CUST
2)         SNE     =-1
2)         BRM     FCUST
2) CHG2C   BRM     PUCREC
2)         MSG     M9              (OKAY?)
2)         BRM     YN
2)         BRU     ECHG1A          (NOT THE ONE)
2)         LDA     FLAG
2)         SNE     =1
2)         BRU     CHG2D           (A SPOOLING RECORD)
2)         SNE     =3
2)         BRU     CHG2D           (ALSO A SPOOLING RECORD)
2)        SNE     =4              A HELD RECORD
2)        BRU     CHG2D
2) CHG2F  BRU CHG2E
2) CHG2D   LDA     CUST
2)         SNE     =-1
2)         BRM     GTDIST
2)         LRSH    15
2)         STA     TDIST
2) *CHG2E   LDA     SYSNO
2) *       SNE     =14
2) *       BRU     CHG2A
2) CHG2E   LDA     TDIST
2)         SKG     =79
2)         SKG     =69
2)         BRU     *+3
2) CHG2A   BRM     FRENCH
2)         BRU     CHG3A
2)         SKG     =189
2)         SKG     =179
2)         BRU     *+3
2)         BRM     ENG
2)         BRU     CHG3A
2)        SKG     =199            GERMANY IS DIST 190-199
2)        SKG     =189
2)        BRU     *+3             EITHER US OR BELGIUM
2)        BRM     GERMAN
2)        BRU     CHG3A
2)        SKG     =39             CHECK FOR BELG
2)        SKG     =29             STILL CHECKING 30-39
2)        BRU     CHGUS           MUST BE US
2)        SKE     =31             IS THIS BELGIUM
2)        BRU     *+3
2)        BRM     BELGIU          THIS IS BELGIUM
2)        BRU     CHG3A           CHARGE IT
2)        BRM     FRENCH          EVERY ON ELSE IN AREA 30 IS FRENCH
2)        BRU     CHG3A           CHG IT
2) CHGUS   CLA                    THIS IS US
2)         STA     FRENSW
2)        STA     GERSW
2)        STA     BELGSW
2)         STA     UKSW
2)         BRU     CHG3A
2) BELGIU ZRO
2)        SKR     BELGSW
2)        BRU     *-1
2)        CLA
2)        STA     UKSW
2)        STA     FRENSW
2)        STA     GERSW
2)        BRR     BELGIU
2) FRENCH ZRO
2) FR1     SKR     FRENSW
2)         BRU     *-1
2)         CLA
2)         STA     UKSW
2)        STA     GERSW
2)        STA     BELGSW
2)         BRR     FRENCH
2) ENG     ZRO
2)         SKR     UKSW
2)         BRU     *-1
2)         CLA
2)         STA     FRENSW
2)        STA     BELGSW
2)        STA     GERSW
2)         BRR     ENG
2) GERMAN ZRO
2)        SKR     GERSW
2)        BRU     *-1
2)        CLA
2)        STA     FRENSW
2)        STA     UKSW
2)        STA     BELGSW
2)        BRR     GERMAN
2) CHG3A   LDA     FLAG
2)        SNE     =4              RECORD AWAITING TRANS /POST CHG
2)        BRU     SPR2
2)         SKA     =1
2)         BRU     SPOREC          (SPOOLING RECORD)
2)         SNE     =3
2)         BRU     SPOREC          (ALSO A SPOOLING RECORD)
2) CHG3    MSG     M10
2)         BRM     CLBUF
2)         BRM     RDNO
2)         BRU     RESET
2)         SKG     =13
2)         SKG     =0
2)         BRU     CHG4
2)         STA     TYPE
2)         CAX
2)        MRG =10000B; STA TYPE (TRANSACTION CODE)
2)         BRU*    BRUTAB,2
2) CHG4    LDX     =-1
2)         BRS     11
2)         BRU     CHG3
2) 
2) BRUTAB  DATA    BADX,PRINT,RDCARD,PCARD,RTAPE,WTAPE,BADX,TAPEC,TAPEIO
2)        DATA    BADX,BADX,BADX,TAPBUY,ENDCHG
2) 
2) BADX   MSG     ILLTYP
2)        BRU     CHG3
2) 
2) PRINT   MSG     M11             (PAGES)
2)         BRM     CLBUF
2)         BRM     RDNO
2)         BRU     RESET
2)         STA     NPAG
2) PRINT1 LDA     =1              ASSUM NO DEC CHG
2)        STA     DECCOL
2)         MSG     M12             (NO. OF PARTS)
2)         BRM     CLBUF
2)         BRM     RDNO
2)         BRU     RESET
2)         SKG     =4
2)         SKG     =0
2)         BRU     PRINT1
2)         STA     PARTS
2)         SNE     =1
2)         BRU     ANOTH
2) PRINT2  MSG     M13             (WERE LISTING DECOLLATED)
2)         BRM     YN
2)         BRU     ANOTH
2)         LDA     =2
2)        STA     DECCOL
2)        BRU     ANOTH
2) PRINT3 LDA =1
2)        STA DECCOL
2) ANOTH  SKN     AGINSW
2)        BRU     *+2
2)        BRU     ENDCHG
2)         MSG     M16             (ANOTHER BATCH TYPE FOR THIS REQUEST)
2)         BRM     YN
2)         BRU     ENDCHG          (NO)
2)         BRM     MOVREC
2)         CLAB
********2166
1)         SKN     ALLSW
****2275
2)        LDA     =-1
2)        STA     TWOFLG
2)         BRU     CHG3
2) ENDCHG CLA
2)        SKN     NULLSW          DO NOT ALLOW ON REC
2)        LDA     =-1
2)        STA     ALLHOL          ALLOW HOLD COMMAND HERE ONLY!
2)        MSG     M14             (ANY TRANSPORTATION CHARGES)
2)         BRM     YN
2)         BRU     END2           NO ENTERED
2)        BRU     END1            YES ENTERED
2)        LDA     =4
2)        STA     FLAG
2)        BRU     END2
2) END1    MSG     M15             (ENTER AMOUNT)
2) END1A   BRM     RAMT
2)         BRM     CHECK
2) 
2)         SKG     =MINPOS
2)         SKG     =0
2)         BRU     *+2
2)         BRU     ECHG1B
2) END2    CLA
2)        STA     ALLHOL          DO NOT ALLOW HOLD TO BE ENTERED
2) ECHG1  NOP
2)         BRM     MOVREC
2)         MSG     M26             (ALL ENTRIES CORRECT
2)         BRM     YN
2)         BRU     AGAIN
2)        SKN     TWOFLG          -1=> WRITE SOME RECS TO /BMTD/
2)        SKN     HOLDSW          -1=> HOLD IT IN BREC,BRECA
2)         BRM     WCHG
2)         SKN     NULLSW
2)         BRU     *+2
2)         BRU     ECHG1A
2)        LDA     FLAG
2)        SKN     HOLDSW
2)         LDA     =-1
2)         STA     FLAG
2)         BRM     WREC
2) ECHG1A CLA; STA HOLDSW
2)         SKN     ALLSW
2)         BRU     *+2
2)         BRU     CHGA1
2)         SKN     NULLSW
2)         BRU     *+2
2)         BRU     NULL6
2)         SKN     CRESW
2)         BRU     *+2
2)         BRU     RESET
2)         MSG     M17             (ANOTHER REQUEST)
2)         BRM     YN
2)         BRU     RESET
2)        CLA; STA HOLDSW
2)         BRU     CHG2
2) ECHG1B  MSG     M31
2)         LDX     =-1
2)         BRS     11
2)         BRU     END1
2) T1      ZRO
2) ECHG1C  MSG     M28
2)         LDX     =-1
2)         BRS     11
2)         BRU     ECHG1A
2) 
2) AGAIN   SKN     NULLSW
2)         BRU     *+2
2)         BRU     NULL5
2)         SKN     CRESW
2)         BRU     *+2
2)         BRU     RESET
2)         MSG     M27             (REENTER ALL DATA)
2)         LDX     =-1
2)         BRS     11
2)         CLAB
2)        STP     RECBUF+18
2)        STP     RECBUF+20
2)        STP     RECBUF+22
2)        STP     RECBUF+24
2)        STP     RECBUF+26
2)         SKN     ALLSW
********2337
1) * COPY THE CURRENT RECORD INTO CORE BEGINNING AT LOC SPECIFIED BY PTRB
1) MOVREC  ZRO
****2285
2) MOVREC  ZRO
********2427
1) RTAPE   SKN     UKSW
1)         BRU     *+2
****2479
2) RTAPE   SKN     FRENSW
2)         BRU     *+2
********2620
1)        SKN     BELGSW
1)        BRU     *+2
****2482
2)         SKN     UKSW
2)         BRU     *+2
********2623
1)        SKN     GERSW
1)        BRU     *+2
****2485
2)        SKN     BELGSW
2)        BRU     *+2
********2626
1)         MSG     M21             (NUMBER OF FILES)
****2488
2)        SKN     GERSW
2)        BRU     *+2
2)        BRU     BADTYP
2)         MSG     M21             (NUMBER OF FILES)
********2629
1) WTAPE  SKN     UKSW         CHECK TO SEE IF A NON-FRENCH EUROPEAN USER
1)          BRU   *+2
1)        BRU     BADTYP
1)        SKN     BELGSW
1)          BRU     *+2
1)        BRU     BADTYP
1)        SKN     GERSW
1)          BRU     *+2
1)        BRU     BADTYP
1)        BRM     TAPGOT
1) *WTAPE BRM     TAPGOT
1)        BRU     RTAPE
1) 
****2497
2) WTAPE  BRM     TAPGOT
2)        BRU     RTAPE
2) 
********2641
1) CHGOPT  LDA     =377B          THIS INSURES THAT THE CIT WILL NEVER SKIP
1)         CIT     CIN            COPY NEXT INPUT CHAR INTO THE A REGISTER
1)         SKG     =31B           SKIP IF INPUT CHAR IS ALPHABETIC OR CONTROL
1)         SKG     =17B           IF THIS TEST IS PERFORMED AND SKIPS FOUND A NO.
1)         BRU     *+2
1)         BRU     CHGNUM         WE FOUND A NUMBER
1)         CAB                    PUT THE (NON-NUMERIC) CHAR IN B REGISTER
1)         CIO     CIN            GET NEXT CHAR FROM INPUT FILE
1)         SKE     =155B          SKIP IF IT WAS A CARRIAGE-RETURN
1)         BRU     *-2            GET ANOTHER CHAR
1)         CBA                    PUT THE SAVED CHAR BACK IN A REGISTER
1)         SKE     ='A'           SKIP IF IT IS AN 'A'
1)         BRU     CHG1            (DONT KNOW WHAT HE WANTED LETS GO THE REGULAR ROUTE)
****2587
2) CHGOPT  LDA     =377B
2)         CIT     CIN
2)         SKG     =31B
2)         SKG     =17B
2)         BRU     *+2
2)         BRU     CHGNUM
2)         CAB
2)         CIO     CIN
2)         SKE     =155B
2)         BRU     *-2
2)         CBA
2)         SKE     ='A'
2)         BRU     CHG1            (DONT KNOW WHAT HE WANTED LETS GO THE REGULAR ROUTE)
********2721
1)         BRU     *-1            IF ALLSW WAS NON-NEGATIVE SET IT TO BE -1
1)         BRU     CHG1             AND RETURN TO (NEAR) TOP OF CHARGE ROUTINE
1) CHGNUM  BRM     RDNO           GET A DECIMAL NUMBER FROM THE INPUT FILE
1)         BRU     RESET          WE GOT NON-NUMERIC INPUT SO GET A NEW COMMAND
1)         STA     FJOB           STORE THE NUMBER IN FJOB
1)         SKR     CNUMSW
1)         BRU     *-1            IF CNUMSW WAS NON-NEGATIVE SET IT TO -1
1)         BRU     CHG1           RETURN TO (NEAR) TOP OF CHARGE ROUTINE
1) 
1) *ALL OPTION ON CHARGE PRESENT EACH RECORD TO SEE IF HE WANTS TO COMPLETE
1) 
****2601
2)         BRU     *-1
2)         BRU     CHG1
2) CHGNUM  BRM     RDNO
2)         BRU     RESET
2)         STA     FJOB
2)         SKR     CNUMSW
2)         BRU     *-1
2)         BRU     CHG1
2) 
2) *ALL OPTION ON CHARGE PRESENT EACH RECORD TO SEE IF HE WANTS TO COMPLETE
2) 
********2735
1)         STA     HTOTAL         SET HTOTAL TO ZERO
1)         STA     ACCUM          LIKEWISE FOR ACCUM
1)         BRM     FNDREC         FIND UNPROCESSED RECS BEGINNING WITH 0
1)         BRU     CHGA2          DIDN'T FIND A RECORD
1)         BRU     CHG22          FOUND A RECORD, SO RETURN TO MAIN CHARGE ROUTINE
1) CHGA1   CLA
1)         STA     HTOTAL         SET HTOTAL TO 0
1)         STA     ACCUM          AND SET ACCUM TO 0
1)         SKN     RECFB          SKIP IF RECREMOTEA WAS LAST FILE OPENED
1)         BRM     CHGA3          WE WILL SKIP FROM HERE IF CAN'T OPEN RECREMOTE
1)         BRM     CHGA4          TRY TO OPEN RECREMOTEA
1)         LDA     ALLCUR         LOAD A WITH THE SAVED CURSOR POSITION
1)         ETR     =@4B7
1)         SCP     RECFNO         SET THE CURSOR POSITION IN RECORD FILE
1)         HLT     0
****2614
2)         STA     HTOTAL
2)         STA     ACCUM
2)         BRM     FNDREC
2)         BRU     CHGA2
2)         BRU     CHG22
2) CHGA1   CLA
2)         STA     HTOTAL
2)         STA     ACCUM
2)         SKN     RECFB
2)         BRM     CHGA3
2)         BRM     CHGA4
2)         LDA     ALLCUR
2)         ETR     =@4B7
2)         SCP     RECFNO
2)         HLT     0
********2748
1)         STA     FNDREC         SET UP THE RETURN ADDRESS FROM FNDREC
1)         BRU     FREC1          START UP FNDREC AT FREC1 INSTEAD OF TOP
1)         BRU     CHGA2          GO TO CHGA2 IF WE COULDN'T FIND THE RECORD
1)         BRU     CHG2B          RECORD FOUND
1) CHGA2   MSG     MEOF           (END OF FILE)
1)         BRU     RESET          GO GET ANOTHER COMMAND
1) CHGA3   ZRO
****2630
2)         STA     FNDREC
2)         BRU     FREC1
2)         BRU     CHGA2
2)         BRU     CHG2B
2) CHGA2   MSG     MEOF
2)         BRU     RESET
2) CHGA3   ZRO
********2764
1) * ASK FOR A REQUEST NUMBER AND STORE IT IN FJOB (ABORT AND RETURN TO
1) * COMMAND LEVEL IF WE DON'T GET A NUMBER)
1) GREQNO  ZRO
****2685
2) GREQNO  ZRO
********2819
1)         BRS     114
****2705
2) *       BRM     RESACT
2)         BRS     114
********2837
1) * PRINT THE HELP MESSAGE AND RETURN TO COMMAND DISPATCHER
1) HEL     MSG     MHELP
1)   IF BCHG
1)         LDA     SYSNO
1)         SNE     =14            OMIT HELP FOR MAKE COMMAND IF NOT SYSTEM 14
1)         MSG     MHELP1         WE ARE ON SYSTEM 14 SO GIVE HELP FOR MAKE CMD
1)   ENDF
1)         MSG     MHELP2
1)         BRU     RESET          GO GET ANOTHER COMMAND
1) 
1) MHELP   ASC     '$$VALID COMMANDS ARE:'
1)         ASC     '$$LIST #           -    LIST THE KNOWN INFORMATION FOR REQUEST #.'
1)         ASC     '$                      THE INFORMATION CAN BE PRINTED ON THE'
1)         ASC     '$                      TELETYPE OR TO A FILE.  (THIS APPLIES'
1)         ASC     '$                      TO THE OTHER LIST COMMANDS ALSO.)'
1)         ASC     '$$LIST PROCESSED   -    LIST THE KNOWN INFORMATION FOR ALL'
1)         ASC     '$                      PROCESSED REQUESTS.'
1)         ASC     '$$LIST UNPROCESSED -    *LIST THE KNOWN INFORMATION FOR ALL'
1)         ASC     '$                      UNPROCESSED REQUESTS.'
1)         ASC     '$$LIST VOID        -    LIST THE KNOWN INFORMATION FOR ALL'
1)         ASC     '$                      VOIDED REQUESTS.'
1)        IF      RCHG
1)         ASC     '$$CHARGE #         -    INPUT POSTAGE CHARGES FOR REQUEST #.'
1)         ASC     '$                      (UNPROCESSED REQUESTS ONLY.)'
1)         ASC     '$$CHARGE ALL       -    INPUT POSTAGE CHARGES FOR ALL'
1)         ASC     '$                      UNPROCESSED REQUESTS.'
1)         ASC     '$$CORRECT #        -    ADD OR CORRECT POSTAGE CHARGES FOR'
1)         ASC     '$                      AN ALREADY PROCESSED REQUEST.'
1)        ELSE
1)         ASC     '$$CHARGE #         -    PRESENT THE UNPROCESSED REQUEST # FOR'
1)         ASC     '$                      INPUT OF CHARGES.'
1)         ASC     '$$CHARGE ALL       -    PRESENT ALL UNPROCESSED REQUESTS'
1)         ASC     '$                      FOR INPUT OF CHARGES.'
1)         ASC     '$$RECHARGE #       -    RE-ENTER ALL DATA FOR A PROCESSED'
1)         ASC     '$                      REQUEST.  THE OLD RECORDS WILL BE'
1)         ASC     '$                      INVALIDATED.'
1)         ASC     '$$POSTAGE #        -    ADD OR CORRECT POSTAGE CHARGES'
1)         ASC     '$                      FOR PROCESSED REQUEST #.'
1)         ASC     '$$CREATE           -    CREATE A BATCH CHARGE FROM INFORMATION'
1)         ASC     '$                      THAT YOU GIVE THE PROGRAM.'
1)        ENDF
1)         ASC     '$$VOID #           -    VOID THE UNPROCESSED REQUEST #./'
1)   IF BCHG
1) MHELP1  ASC     '$$MAKE             -    CREATE A BATCH CHARGE (INCLUDING THE'
1)         ASC     '$                      REQUEST NUMBER) FROM INFORMATION'
1)         ASC     '$                      THAT YOU GIVE THE PROGRAM./'
1)   ENDF
1) MHELP2  ASC     '$$PURGE            -    PURGE ALL PROCESSED AND VOIDED REQUESTS'
1)         ASC     '$                      FROM THE RECORD FILE.'
1)         ASC     '$$QUIT OR Q        -    QUIT (RETURN) TO THE EXEC.'
1)         ASC     '$$HELP OR ?        -    REPRINT THIS LIST.'
1)         ASC     '$$COMMANDS MAY BE SHORTENED TO THE FIRST THREE CHARACTERS.'
1)         ASC     '$$* IF THIS COMMAND INCLUDES A DATE ONLY UNPROCESSED REQUESTS'
1)         ASC     '$  CREATED ON OR BEFORE THIS DATE WILL BE LISTED.$$/'
1) 
1) *CHECK FOR COMPLETED SPOOL RECORDS TEMPORARLY DEPOSITED INTO BATCHREC
****2710
2) HEL     MSG     MHELP
2)         LDA     SYSNO
2)         SNE     =14
2)         MSG     MHELP1
2)         MSG     MHELP2
2)         BRU     RESET
2) 
2) MHELP   ASC     '$$VALID COMMANDS ARE:'
2)         ASC     '$$LIST #           -        FOR REQUEST BEARING #'
2)         ASC     '$                          LIST ALL KNOW INFORMATION FOR'
2)         ASC     '$                          REQUEST #.'
2)         ASC     '$$LIST PROCESSED   -        OUTPUTS THE ABOVE INFORMATION TO THE'
2)         ASC     '$                          TELETYPE OR TO A FILE FOR ALL PROCESSED'
2)         ASC     '$                          REQUESTS.'
2)         ASC     '$$LIST UNPROCESSED -        *OUTPUTS THE ABOVE INFORMATION TO THE'
2)         ASC     '$                          TELETYPE OR TO A FILE FOR ALL UN-'
2)         ASC     '$                          PROCESSED REQUESTS.'
2)         ASC     '$$LIST VOID        -        OUTPUTS THE ABOVE INFORMATION TO THE'
2)         ASC     '$                          TELETYPE OR TO A FILE FOR ALL VOIDED'
2)        IF      RCHG
2)        ASC '$$CHARGE #         -        ACCEPTS POSTAGE CHARGES FOR REQUEST'
2)        ASC '$                          BEARING #'
2)        ASC '$$CHARGE ALL       -        PRESENTS ALL UNPROCESSED REQUESTS TO'
2)        ASC '$                          TO THE USER FOR INPUT OF POSTAGE'
2)        ASC '$                          CHARGES.'
2)        ASC '$$CORRECT #                 ALLOWS ADDING OR CORRECTING POSTAGE'
2)        ASC '$                          CHARGES.'
2)        ELSE
2)         ASC     '$                          REQUESTS.'
2)         ASC     '$$CHARGE #         -        INPUTS CHARGES FOR REQUEST BEARING #.'
2)         ASC     '$$CHARGE ALL       -        PRESENTS ALL UNPROCESSED REQUESTS TO'
2)         ASC     '$                          TO THE USER FOR INPUT OF CHARGES.'
2)         ASC     '$$RECHARGE #       -        ALLOWS RE-ENTERING ALL DATA FOR A'
2)         ASC     '$                          REQUEST, THEN INVALIDATES THE OLD'
2)         ASC     '$                          RECORDS'
2)         ASC     '$$POSTAGE #                 ALLOWS ADDING OR CORRECTING POSTAGE'
2)         ASC     '$                          CHARGES.'
2)         ASC     '$$CREATE           -        ALLOWS FOR CREATING A BATCH CHARGE'
2)         ASC     '$                          FROM INFORMATION SUPPLIED BY THE USER'
2)         ASC     '$                          PROGRAM.'
2)        ENDF
2)         ASC     '$$VOID #           -        VOIDS THE UNPROCESSED REQUEST'
2)         ASC     '$                          BEARING #./'
2) MHELP1  ASC     '$$MAKE             -        ALLOWS FOR CREATING A BATCH CHARGE'
2)         ASC     '$                          FROM INFORMATION SUPPLIED BY THE USER'
2)         ASC     '$                          PROGRAM INCLUDING REQUEST NUMBER./'
2) MHELP2  ASC     '$$PURGE            -        PURGES ALL PROCESSED AND VOIDED'
2)         ASC     '$                          REQUESTS FROM THE RECORD FILE.'
2)         ASC     '$$QUIT OR Q        -        QUITS TO THE EXEC.'
2)         ASC     '$$HELP OR ?        -        REPRINTS THIS LIST'
2)         ASC     '$$COMMANDS MAY BE SHORTENED TO THE FIRST THREE CHARACTERS'
2)         ASC     '$$* IF THIS COMMAND INCLUDES A DATE ONLY UNPROCESSED REQUESTS'
2)         ASC     '$CREATED ON OR BEFORE THIS DATE WILL BE LISTED$$/'
2) 
2) *CHECK FOR COMPLETED SPOOL RECORDS TEMPORARLY DEPOSITED INTO BATCHREC
********2842
1)         BRU     *-1            SET SPLSW TO -1
1)         BRM     FNDREC         FIND THE RECORD
1)         BRU     CKSPL3          DIDN'T FIND A RECORD
1)         BRU     CKSPL2         GOT A RECORD
1) CKSPL1  SKN     RECFB          SKIP IF WE OPENED RECREMOTEA
1)         BRM     CHGA3
****2770
2)         BRU     *-1
2)         BRM     FNDREC
2)         BRU     CKSPL3          (NONE)
2)         BRU     CKSPL2
2) CKSPL1  SKN     RECFB
2)         BRM     CHGA3
********2901
1) *  ?? THE NEXT 8 INSTRUCTIONS CAN NEVER BE CALLED!! ??
1)         LDA     ALLCUR
****2777
2)         LDA     ALLCUR
********2908
1)         BRU     CKSPL1         FLAG NOT= 2, SO GO BACK TO CHG (SPLSW STILL -1)
1)        LDB =HOLD; STB PTRB
1)         BRM     MOVREC         COPY RECBUF INTO LOCATION SPECIFIED BY HOLD
1)         BRM     WCHG           WRITE OUT AN ENTRY
1)         LDA     =-1
1)         STA     FLAG           SET FLAG TO -1
1)         BRM     WREC           WRITE THE LAST RECORD READ
1)         BRU     CKSPL1         RETURN TO CHG ROUTINE (SPLSW STILL IS -1)
1) CKSPL3  CLA
1)         STA     SPLSW          RESET SPLSW TO 0
1)         BRR     CKSPL
****2788
2)         BRU     CKSPL1
2)        LDB =HOLD; STB PTRB
2)         BRM     MOVREC
2)         BRM     WCHG
2)         LDA     =-1
2)         STA     FLAG
2)         BRM     WREC
2)         BRU     CKSPL1
2) CKSPL3  CLA
2)         STA     SPLSW
2)         BRR     CKSPL
********2918
1)         LDA     =1
****2837
2)         BRM     CKACT
2)         LDA     =1
********2967
1)         LDA     =1
****2960
2)         BRM     CKACT
2)         LDA     =1
********3091
1)         BRU     CHG2E
1) NULL6   BRM     GETREC
****3005
2)         BRU     CHG2F
2) NULL6   BRM     GETREC
********3137
1)         LDA     =*+2
****3040
2) *       CLAB
2) *       STP     TOTAL
2) *       STP     POST
2) *       STA     TYPE
2) *       STA     VOL
2) *       STA     PARTS
2)         LDA     =*+2
********3172
1)         LDX     =-RECLEN
****3067
2)         BRM     CKACT
2)         LDX     =-RECLEN
********3205
1)         MSG     MCR2            (ENTER NAME OF REQUESTOR)
****3077
2)         BRM     FCUST
2)         MSG     MCR2            (ENTER NAME OF REQUESTOR)
********3216
1)         BRU     CHG2E
1) 
1) MCR1    ASC     '$ENTER USER NAME TO BE CHARGED: /'
****3091
2)         BRU     CHG2F
2) 
2) MCR1    ASC     '$ENTER USER NAME TO BE CHARGED: /'
********3231
1)         LDX     =-RECLEN
****3111
2)         BRM     CKACT
2)         LDX     =-RECLEN
********3251
1) MAKE2  BRS 74; STA EDATE
****3139
2) *MAKE2   MSG     MCR8            GET THE GAN
2) *       LDB     =8
2) *       LDX     CIN
2) *       BRS     38
2) *       STA     GAN
2) MAKE2  BRS 74; STA EDATE
********3280
1)         BRU     CHG2E
1) 
1) MAKERR  MSG     MCR9            (INVALID REQUEST NUMBER)
****3144
2)         BRU     CHG2F
2) 
2) MAKERR  MSG     MCR9            (INVALID REQUEST NUMBER)
********3290
1)         BRS     124            WE NOW HAVE THE DISK ADDRESS FOR THE
1) *                              CUSTOMER'S LUD, SO READ IN THE INFO
1)         EAX     LBUF
****3248
2)         BRS     124
2)         EAX     LBUF
********3394
1)         STA     GAN            WE NOW HAVE THE GENERAL ACCT USER FOR CUSTOMER
1)        LDA 7,2; ETR =377777B; STA UUN   GET AND SAVE CUSTOMER'S UUN
1)         LDA 8,2; LRSH 2; ETR =3777B; STA TDIST   GET DISTRICT
1)         MIN     VCUST
1)         BRR     VCUST          TAKE THE SKIP RETURN TO CALLER
1) VCUST3  EAX     9,2
****3275
2)         STA     GAN
2)        LDA 7,2; ETR =377777B; STA UUN
2)         LDA 8,2; LRSH 2; ETR =17777B; STA TDIST   GET DISTRICT
2)         MIN     VCUST
2)         BRR     VCUST
2) VCUST3  EAX     9,2
********3420
1)   IF DEBUG
1) BNUM   ASC     '(HINCKLEYM)@BATCHNUM1'
1) BNUMP  DATA    3*BNUM-1,3*BNUM-1+21
1)     ELSE
1) BNUM    ASC     '(*1BATCH)@BATCHNUM1'
****3362
2) BNUM    ASC     '(*1BATCH)@BATCHNUM1'
********3507
1)   ENDF
1) 
1) TOTAL  ZRO
****3368
2) CCUST  ZRO
2) CPOST  ZRO
2) CTOTAL ZRO
2) CUST   ZRO
2) CVOL   ZRO
2) TOTAL  ZRO
********3510
1) GUSER  ZRO
1)        LDA =8
1)        LDB =CALLER
1)        LDX =1
1)        BRS 67  LOOK UP USER NUMBER
1)        LDA =31
1)        LDB =USEGAN
1)        LDX =1
1)        BRS 67      LOOK UP USER'S ACCOUNT NO.
1)        LDA =33
1)        LDB =LUDLOC
1)        LDX =1
1)        BRS 67                  GET A POINTER INTO THE LUD
1)        BRM WHO
1)        BRR GUSER
1) 
1) WHO    ZRO; LDA LUDLOC; LRSH 10; ADD =LUDBUF; STA LUDLOC; CLA; LSH 10
****3483
2)        IF      RCHG
2) GUSER  ZRO; LDA =8; LDB =CALLER; LDX =1; BRS 67
2)        LDA =31; LDB =USEGAN; LDX =1; BRS 67
2)        LDA =33; LDB =LUDLOC; LDX =1; BRS 67; BRM WHO; BRR GUSER
2) WHO    ZRO; LDA LUDLOC; LRSH 10; ADD =LUDBUF; STA LUDLOC; CLA; LSH 10
********3627
1)        SKE =-1; BRU *+3; MIN BLNO; BRM GE1
1)        SKE =-2; BRU *+2; BRU GLD3
****3523
2)        SKE =-1; BRU *+3; MIN BLNO; BRU GLD1-1
2)        SKE =-2; BRU *+2; BRU GLD3
********3655
1)        LDA 8,2; LRSH 2; ETR =1777B; STA TDIST BRR GLDIST
1) GLD3 EAX 9,2; BRU GLD2
1)        END
****3529
2)        LDA 8,2; LRSH 2; ETR =1777B; BRR GLDIST
2) GLD3 EAX 9,2; BRU GLD2
2)        ENDF
2)        END
********3661
1BCHARGE ** FICHE/FRAME BREAK *****
SYMBCHG1406

SYM.  PG.LN. IDENT.

2BUSY  16 35 RCHG    ACCRC1 63  3 RCHG    ACCREC 20 31 RCHG    
ACCUM  70  5 RCHG    ADDMTD 79  7 RCHG    ADJTYP 61  9 RCHG    AGAIN  58 37 RCHG    
AGINSW 10 19 RCHG    ALLCUR 67 38 RCHG    ALLHOL 10 16 RCHG    ALLSW  70 12 RCHG    
ANAME  24  3 RCHG    ANAME  24  1 RCHG    ANOTH  56 37 RCHG    AUNO   24  6 RCHG    
B1      4 27 RCHG    B200   36 37 RCHG    B200A  37  3 RCHG    BADT1  67  9 RCHG    
BADTYP 67  8 RCHG    BADUST 67  5 RCHG    BADX   56  9 RCHG    BAREC  18 16 RCHG    
BAREC  18  1 RCHG    BAREC  17 23 RCHG    BAREC  17  8 RCHG    BBRECP 18 21 RCHG    
BBRECP 18  6 RCHG    BBRECP 17 28 RCHG    BBRECP 17 13 RCHG    BCHARG  1  7 RCHG    
BCHG    1  9 RCHG    BCHG    1  5 RCHG    BCUST  85  9 RCHG    BEGIN   3 36 RCHG    
BELGIU 54 15 RCHG    BELGSW 70 10 RCHG    BELSUR  3 32 RCHG    BLANK  78 33 RCHG    
BLNO   24 11 RCHG    BLX    24 12 RCHG    BMTD   18 17 RCHG    BMTD   18  2 RCHG    
BMTD   17 24 RCHG    BMTD   17  9 RCHG    BMTDPT 18 22 RCHG    BMTDPT 18  7 RCHG    
BMTDPT 17 29 RCHG    BMTDPT 17 14 RCHG    BNUM   87 12 RCHG    BNUM   87  9 RCHG    
BNUMP  87 13 RCHG    BNUMP  87 10 RCHG    BOBMTD 20 25 RCHG    BRECP  18 20 RCHG    
BRECP  18  5 RCHG    BRECP  17 27 RCHG    BRECP  17 12 RCHG    BRUTAB 56  6 RCHG    
BTBLND  8 23 RCHG    BUF    24 13 RCHG    BUF2   51  3 RCHG    BUSCNT 17  1 RCHG    
BUSY   16 28 RCHG    CALC   61 28 RCHG    CALLER 90 36 RCHG    CARPRO 10 33 RCHG    
CC1    11 14 RCHG    CCARPR 37 36 RCHG    CCHR   37 33 RCHG    CCUR   38  7 RCHG    
CCUREN 38  2 RCHG    CDATE  37 29 RCHG    CDECCO 38  1 RCHG    CDELCH 38  3 RCHG    
CEMPTR 38  4 RCHG    CENTS  41 36 RCHG    CFILPR 37 37 RCHG    CGAN   37 26 RCHG    
CHECK  72 35 RCHG    CHECK1 72 39 RCHG    CHECK2 73 11 RCHG    CHG    52 25 RCHG    
CHG1   52 28 RCHG    CHG2   52 38 RCHG    CHG22  53  6 RCHG    CHG2A  53 27 RCHG    
CHG2B  53 14 RCHG    CHG2C  53 16 RCHG    CHG2E  53 20 RCHG    CHG3   55 30 RCHG    
CHG3A  55 23 RCHG    CHG4   56  2 RCHG    CHGA1  68  6 RCHG    CHGA2  68 21 RCHG    
CHGA3  68 23 RCHG    CHGA4  68 27 RCHG    CHGALL 67 39 RCHG    CHGNUM 67 29 RCHG    
CHGOPT 67 13 RCHG    CHGUS  54  9 RCHG    CHK     7 31 RCHG    CHOST  37 28 RCHG    
CIN    11  7 RCHG    CINSW   3 25 RCHG    CJOB   37 31 RCHG    CKCUR  78 21 RCHG    
CKCUR1 78 24 RCHG    CKDAY  27  4 RCHG    CKDAY1 27  5 RCHG    CKDAYX 27 19 RCHG    
CKSPL  71 38 RCHG    CKSPL1 72  5 RCHG    CKSPL2 72 17 RCHG    CKSPL3 72 27 RCHG    
CLBUF   8 25 RCHG    CLC1   75 16 RCHG    CLIST1 38 18 RCHG    CLIST2 38 27 RCHG    
CLIST3 38 21 RCHG    CLOMTD 90  2 RCHG    CNUMSW 70  7 RCHG    COMLST 38 10 RCHG    
COR    73 18 RCHG    COR1   73 26 RCHG    COR2   73 32 RCHG    COR2AA 73 39 RCHG    
COR3   74 11 RCHG    COR3A  74 16 RCHG    COR4   74 24 RCHG    COR5   74 36 RCHG    
COR5A  75 11 RCHG    CORAGN 75 37 RCHG    CORCUR 76  2 RCHG    CORHOL 75 17 RCHG    
CORM1  76  1 RCHG    CORNO1 75 20 RCHG    CORNON 75 19 RCHG    CORSW  28 32 RCHG    
CPAGE  37 34 RCHG    CPART  37 35 RCHG    CPREC  38 35 RCHG    CPROJ  37 30 RCHG    
CPT    90 35 RCHG    CPTOP  14 30 RCHG    CPTRA  59 20 RCHG    CR      3 10 RCHG    
CREATE 79 24 RCHG    CRECBF 37 22 RCHG    CRECST 37 23 RCHG    CREQBY 37 32 RCHG    
CRESW  28 34 RCHG    CT1    88  3 RCHG    CTAPCO 37 39 RCHG    CTAPPU 37 38 RCHG    
CTBL    8 20 RCHG    CTBL    8 17 RCHG    CTBLND  8 21 RCHG    CTBLND  8 18 RCHG    
CTYPE  37 25 RCHG    CUNAME 37 24 RCHG    CUR1   88  7 RCHG    CUR2   88  8 RCHG    
CURBUF 79 19 RCHG    CUREND 88 18 RCHG    CURREN 10 38 RCHG    CURTAB 88 17 RCHG    
CUUN   37 27 RCHG    CVT    12 18 RCHG    CVTDAT 12 31 RCHG    CZONE   3 28 RCHG    
DATE   87 18 RCHG    DATEPT 11 10 RCHG    DAY    10 11 RCHG    DEBUG   1 11 RCHG    
DECCOL 10 37 RCHG    DELETE 21 29 RCHG    DIST   50 24 RCHG    ECHG1  57 35 RCHG    
ECHG1A 58 12 RCHG    ECHG1B 58 27 RCHG    ECHG1C 58 32 RCHG    EDATE  10 26 RCHG    
EDLIN  51 36 RCHG    EDLIN1 52 10 RCHG    EDLIN2 51 38 RCHG    EDPT   52 12 RCHG    
EDVER  51 31 RCHG    END1   57 25 RCHG    END1A  57 26 RCHG    END2   57 33 RCHG    
ENDAT  25 23 RCHG    ENDCHG 57 14 RCHG    ENG    55  7 RCHG    ERFLG   8 12 RCHG    
ERMSG   8 13 RCHG    ERMSG1  8 14 RCHG    ERR     8  4 RCHG    ERR1    8 10 RCHG    
ERV    51 15 RCHG    ERV1   51 14 RCHG    ERV2   51 17 RCHG    ERV3   51 21 RCHG    
FACT1  66 13 RCHG    FACTOR 61 27 RCHG    FBUSY1 16 39 RCHG    FILDAT 15 26 RCHG    
FILPRO 10 34 RCHG    FILPT  18 32 RCHG    FILTYP 17  2 RCHG    FJOB   14 27 RCHG    
FLAG   11  1 RCHG    FNDREC 12 37 RCHG    FNO    11  9 RCHG    FNO1   22 13 RCHG    
FONO   50 13 RCHG    FR1    54 25 RCHG    FREC1  13  6 RCHG    FREC1A 14  1 RCHG    
FREC1B 14  4 RCHG    FREC1C 13 22 RCHG    FREC2  14  8 RCHG    FREC3  13  1 RCHG    
FREC4  14 15 RCHG    FREC5  14 20 RCHG    FRENCH 54 24 RCHG    FRENSW 70  9 RCHG    
FRNMSG 55  3 RCHG    FSUR    3 31 RCHG    GAN    10 23 RCHG    GAUN   22 17 RCHG    
GDIR   22 25 RCHG    GDIR2  23 11 RCHG    GDIR3  23 37 RCHG    GE1    91  3 RCHG    
GERMAN 55 15 RCHG    GERSW  70 11 RCHG    GETREC 35 28 RCHG    GIP    15 17 RCHG    
GLD1   91 11 RCHG    GLD2   91 12 RCHG    GLD3   91 20 RCHG    GLDIST 91  8 RCHG    
GLTCH   6 23 RCHG    GPROJ  86 15 RCHG    GPS    49 11 RCHG    GPS1   49 13 RCHG    
GREC1  35 36 RCHG    GREC1A 36  4 RCHG    GREC2  36 26 RCHG    GRECER 37 10 RCHG    
GREQNO 69 35 RCHG    GSTG2  85 29 RCHG    GTDAT1  9 36 RCHG    GTDAT2 10  6 RCHG    
GTDATE  8 32 RCHG    GTNAME 85 38 RCHG    GTREQB 86  7 RCHG    GTSTG  85 11 RCHG    
GTSTG1 85 19 RCHG    GUSER  90 12 RCHG    GVREC  29 25 RCHG    GVREC1 29 32 RCHG    
GVREC2 30  8 RCHG    GVREC3 30 11 RCHG    HBUF   11  3 RCHG    HDAY   27 21 RCHG    
HEL    70 20 RCHG    HMSG   34 15 RCHG    HOLD   59 21 RCHG    HOLDSW 10 17 RCHG    
HOLMSG 34  7 RCHG    HOST   10 25 RCHG    HPARTS 64  6 RCHG    HRATE  64  5 RCHG    
HTOTAL 70  4 RCHG    HVOL   66 36 RCHG    ILLTYP 11 15 RCHG    IN1     6 34 RCHG    
IN2     7  1 RCHG    IN3     7  7 RCHG    IN4     7 13 RCHG    IN5     7 18 RCHG    
JDNO2  41 13 RCHG    JDNO4  41  5 RCHG    JDNO5  40 34 RCHG    JOB    10 28 RCHG    
JONO   40 20 RCHG    KTCB   27 20 RCHG    LBUF   85 10 RCHG    LEADZ  40  3 RCHG    
LERR   28 11 RCHG    LHEAD  12  8 RCHG    LHEAD1 12 11 RCHG    LHEADV 12  9 RCHG    
LHSW   33  6 RCHG    LIST   27 29 RCHG    LIST1  27 32 RCHG    LM1    35 19 RCHG    
LM2    35 20 RCHG    LM3    35 21 RCHG    LM4    35 22 RCHG    LM5    35 23 RCHG    
LSTNUM 28 16 RCHG    LSTSW  38  9 RCHG    LUDBUF 91  2 RCHG    LUDLOC 90 33 RCHG    
LVOID  43  2 RCHG    LVOID1 43  8 RCHG    LVOID2 43 17 RCHG    LVOID3 44  3 RCHG    
LVOID4 44  8 RCHG    LVOID5 44 12 RCHG    LVOID6 44 17 RCHG    LVOID7 44 22 RCHG    
LVOID8 43 37 RCHG    LVOIDX 43 24 RCHG    LVOIDY 44 26 RCHG    LZERO  40 15 RCHG    
M1     11 16 RCHG    M10    11 25 RCHG    M11    11 26 RCHG    M12    11 27 RCHG    
M13    11 28 RCHG    M14    11 29 RCHG    M15    11 30 RCHG    M16    11 31 RCHG    
M17    11 32 RCHG    M19    11 34 RCHG    M2     11 17 RCHG    M20    11 35 RCHG    
M21    11 36 RCHG    M22    11 37 RCHG    M23    11 38 RCHG    M24    11 39 RCHG    
M25    12  1 RCHG    M26    12  2 RCHG    M27    12  3 RCHG    M28    12  4 RCHG    
M29    12  5 RCHG    M3     11 18 RCHG    M30    12  6 RCHG    M31    12  7 RCHG    
M4     11 19 RCHG    M5     11 20 RCHG    M6     11 21 RCHG    M7     11 22 RCHG    
M8     11 23 RCHG    M9     11 24 RCHG    MAKE   80 24 RCHG    MAKE2  81 19 RCHG    
MAKE3  80 36 RCHG    MAKERR 81 26 RCHG    MAKTT9 20 32 RCHG    MBADT  67  7 RCHG    
MCR1   80 12 RCHG    MCR2   80 13 RCHG    MCR3   80 14 RCHG    MCR4   80 15 RCHG    
MCR5   80 16 RCHG    MCR6   80 17 RCHG    MCR7   80 18 RCHG    MCR8   80 19 RCHG    
MCR9   80 20 RCHG    MDADUS 67  4 RCHG    MEOF   38 33 RCHG    MGREC  37 20 RCHG    
MHELP  70 29 RCHG    MHELP1 71 23 RCHG    MHELP2 71 27 RCHG    MINMUM 64  4 RCHG    
MINPOS  1 27 RCHG    MKNUM  81 33 RCHG    MKPTR  86 23 RCHG    MNOTIF 19 14 RCHG    
MO     10 10 RCHG    MONPTR 18 27 RCHG    MONPTR 18 12 RCHG    MONPTR 17 34 RCHG    
MONPTR 17 19 RCHG    MOPURF 21 27 RCHG    MOREC  19 13 RCHG    MOVACC 63  5 RCHG    
MOVE   46 16 RCHG    MOVOID 22 12 RCHG    MOVREC 59 24 RCHG    MR1    59 28 RCHG    
MSG     2  3 RCHG    MSGP    2 18 RCHG    MSGP2   2 27 RCHG    MSGSW  37 19 RCHG    
MTDFNO 20 26 RCHG    MTDOPN 89 36 RCHG    MTEMP  91  7 RCHG    MTHRU  70 17 RCHG    
MVER    1 35 RCHG    MVER    1 33 RCHG    MVOID  69 31 RCHG    MVREC  75 24 RCHG    
NAME   24  5 RCHG    NCHR   10 30 RCHG    NM1    78 20 RCHG    NOGOOD 24  7 RCHG    
NONAME 50 31 RCHG    NONO   24  9 RCHG    NOPASS 50 25 RCHG    NOPE    4 21 RCHG    
NOREQ  82 33 RCHG    NOREQ1 83  5 RCHG    NOREQ2 83 17 RCHG    NOREQ3 83 20 RCHG    
NOREQ4 83 23 RCHG    NPAG   10 31 RCHG    NTEMP  85  6 RCHG    NULL   76 22 RCHG    
NULL1  76 32 RCHG    NULL2  76 38 RCHG    NULL3  77 14 RCHG    NULL4  77 23 RCHG    
NULL5  77 30 RCHG    NULL6  78  3 RCHG    NULL7  78  8 RCHG    NULL8  78 17 RCHG    
NULLSW 28 33 RCHG    NUMFNO 87  6 RCHG    NUMLST 28 22 RCHG    NUMSW  25 22 RCHG    
OBMTD  20  2 RCHG    OBMTD1 20 22 RCHG    OBNUM  86 30 RCHG    OBNUM1 87  3 RCHG    
OPFER  51 19 RCHG    OPFI1  16  9 RCHG    OPFI2  16 16 RCHG    OPFI3  16 19 RCHG    
OPFI4  15 39 RCHG    OPFIL  15 36 RCHG    OPNAM  51  1 RCHG    OPOUT  39 26 RCHG    
OPOUT1 39 38 RCHG    OPTLST 28 13 RCHG    OPURF  21 12 RCHG    OPURF1 21 25 RCHG    
ORECF  18 35 RCHG    ORECF1 19 10 RCHG    ORECFA 19 21 RCHG    ORECSW 28 31 RCHG    
ORF1A  19 35 RCHG    OVOID  21 36 RCHG    OVOID1 22 10 RCHG    PARTS  10 32 RCHG    
PCARD  64 18 RCHG    PDNO   25  5 RCHG    PDOLS  41 17 RCHG    PFOR   89 25 RCHG    
POINT  38  5 RCHG    POINT1 38  6 RCHG    PONO   25 12 RCHG    POST   10 39 RCHG    
PPART  38 39 RCHG    PRI05  87 33 RCHG    PRI10  87 34 RCHG    PRI20  87 35 RCHG    
PRI40  87 36 RCHG    PRI50  87 37 RCHG    PRI60  87 38 RCHG    PRI70  87 39 RCHG    
PRI80  88  1 RCHG    PRINT  56 12 RCHG    PRINT1 56 17 RCHG    PRINT2 56 29 RCHG    
PRINT3 56 35 RCHG    PRIPRO 87 23 RCHG    PRIV   24 10 RCHG    PROJ   10 27 RCHG    
PSTG   39  7 RCHG    PSTG1  39  8 RCHG    PSTG2  39 12 RCHG    PT1    63  1 RCHG    
PT2    63  2 RCHG    PTRA   59 18 RCHG    PTRB   59 19 RCHG    PUCR1  33 14 RCHG    
PUCREC 33  7 RCHG    PURGE  44 34 RCHG    PURGE1 45  1 RCHG    PURGE2 45  6 RCHG    
PURGE3 45  9 RCHG    PURGE4 45 14 RCHG    PURGE5 45 24 RCHG    PURGE6 45 34 RCHG    
PURGE7 46 21 RCHG    PURGF  18 18 RCHG    PURGF  18  3 RCHG    PURGF  17 25 RCHG    
PURGF  17 10 RCHG    PURPT  18 23 RCHG    PURPT  18  8 RCHG    PURPT  17 30 RCHG    
PURPT  17 15 RCHG    PVREC  30 16 RCHG    PZERO  41 30 RCHG    RAMT   63 18 RCHG    
RAMT1  63 36 RCHG    RBLK   22 35 RCHG    RCHARG  1  3 RCHG    RDCARD 64  9 RCHG    
RDNO   24 18 RCHG    RDX    34 18 RCHG    READT9 21  7 RCHG    RECBUF 10 20 RCHG    
RECCUR 14 29 RCHG    RECFB  19 18 RCHG    RECFNO 19 15 RCHG    RECLEN  1 18 RCHG    
RECMV  75 30 RCHG    RECVT  12 24 RCHG    REQBY  10 29 RCHG    REQDAT 34 19 RCHG    
REQNO  83 25 RCHG    RESET   6  5 RCHG    RSTART 27 22 RCHG    RSTG   36 30 RCHG    
RTAPE  64 22 RCHG    RWREC  76  6 RCHG    SAVA    3 23 RCHG    SAVB    3 24 RCHG    
SAVX    3 22 RCHG    SAWFRN 55  2 RCHG    SF     50 38 RCHG    SFBUF  51  4 RCHG    
SFIL   51 13 RCHG    SFPTR  50 37 RCHG    SGPS   49  3 RCHG    SKNE    1 29 RCHG    
SPACE   2 34 RCHG    SPLSW  72 30 RCHG    SPM1   34 16 RCHG    SPM2   34 17 RCHG    
SPMSG1 34  9 RCHG    SPMSG2 34 11 RCHG    SPMSG3 34 13 RCHG    SPOREC 60  2 RCHG    
SPR1   60 13 RCHG    SPR2   60 22 RCHG    STASW  50 23 RCHG    STCOLL 60 24 RCHG    
STGCNT 85 36 RCHG    SUB1   79 16 RCHG    SUBACC 79 15 RCHG    SYSNAM  3 29 RCHG    
SYSNO   3 27 RCHG    SYSPTR 18 25 RCHG    SYSPTR 18 10 RCHG    SYSPTR 17 32 RCHG    
SYSPTR 17 17 RCHG    SYSXXX  3 30 RCHG    T      81 30 RCHG    T1     58 31 RCHG    
T2     82 30 RCHG    T3     82 31 RCHG    TAPBUY 67  1 RCHG    TAPCON 10 36 RCHG    
TAPE1  66 29 RCHG    TAPEC  65 25 RCHG    TAPEIO 66 14 RCHG    TAPGOT 65 16 RCHG    
TAPIO  66 27 RCHG    TAPPUR 10 35 RCHG    TDIST  70  6 RCHG    TDNO   24 30 RCHG    
TEMP   24 14 RCHG    TERMCH  3 26 RCHG    TERMWD 50 35 RCHG    THRU   70 13 RCHG    
TLV1   50 19 RCHG    TLV11  50 20 RCHG    TONO   24 37 RCHG    TOTAL  87 16 RCHG    
TOUT   11  8 RCHG    TPUR   66 35 RCHG    TRYC1  29  4 RCHG    TRYC2  29  9 RCHG    
TRYC3  29 14 RCHG    TRYC4  29 17 RCHG    TRYC5  29 12 RCHG    TRYCOM 28 36 RCHG    
TWOFLG 10 18 RCHG    TYPE   10 21 RCHG    UKSW   70  8 RCHG    UNAME  10 22 RCHG    
UNCL1  31 15 RCHG    UNCL2  31 25 RCHG    UNCL3  31 31 RCHG    UNCL4  32  4 RCHG    
UNCL5  32  5 RCHG    UNCL6  32 19 RCHG    UNCL7  32 21 RCHG    UNCLST 31  9 RCHG    
UNCLX  32 32 RCHG    UNCLX1 32 38 RCHG    UNCLX2 32 35 RCHG    UNCLY  32 27 RCHG    
UNCLZ  33  1 RCHG    USEGAN 90 37 RCHG    USEUUN 90 38 RCHG    UUN    10 24 RCHG    
VCUST  83 27 RCHG    VCUST1 83 39 RCHG    VCUST2 84 14 RCHG    VCUST3 85  4 RCHG    
VCUSTB 85  7 RCHG    VER    46 32 RCHG    VER1   47 33 RCHG    VER1A  47  1 RCHG    
VER1B  47 18 RCHG    VERRET 51 23 RCHG    VERSW  50 22 RCHG    VM1    52 18 RCHG    
VM2    52 19 RCHG    VME    52 14 RCHG    VME1   52 13 RCHG    VME2   52 15 RCHG    
VME3   52 16 RCHG    VME4   52 17 RCHG    VME5   52 20 RCHG    VME6   52 21 RCHG    
VOID   68 35 RCHG    VOID1  68 38 RCHG    VOID2  69  1 RCHG    VOIDF  18 19 RCHG    
VOIDF  18  4 RCHG    VOIDF  17 26 RCHG    VOIDF  17 11 RCHG    VOIDN1 69 25 RCHG    
VOIDNO 69 14 RCHG    VOIDPT 18 24 RCHG    VOIDPT 18  9 RCHG    VOIDPT 17 31 RCHG    
VOIDPT 17 16 RCHG    VOIMIS 69 29 RCHG    VOL    87 17 RCHG    VPTR1  50 39 RCHG    
VPTR2  51  2 RCHG    VT1    51  5 RCHG    VT2    51  6 RCHG    VXT1   51  7 RCHG    
VXT2   51  8 RCHG    VXT3   51  9 RCHG    VXT4   51 10 RCHG    VXT5   51 11 RCHG    
VXT8   51 12 RCHG    WCHG   61 34 RCHG    WCHG1  62  3 RCHG    WCHG2  62 17 RCHG    
WCHG5  62 22 RCHG    WHA1   88 20 RCHG    WHA2   88 39 RCHG    WHACUR 88 19 RCHG    
WHAERR 89 16 RCHG    WHAIN1 88 21 RCHG    WHAIN2 88 29 RCHG    WHAIN3 88 35 RCHG    
WHAIN4 89  1 RCHG    WHAIN5 89  6 RCHG    WHO    90 28 RCHG    WHONAM 90 34 RCHG    
WKPTR  85 35 RCHG    WKWORD 82 29 RCHG    WORK   64  3 RCHG    WRACCT 62 29 RCHG    
WREC   14 34 RCHG    WREC1  14 39 RCHG    WREC2  15  1 RCHG    WTAPE  65  1 RCHG    
YN     42  2 RCHG    YN1    42 11 RCHG    YN2    42 29 RCHG    YNERR  42 37 RCHG    
YR     10 12 RCHG    
1BCHARGE ** FICHE/FRAME BREAK *****
ACCOUNTFORMAT
       FORMAT OF NEW BATCH ACCOUNTING FILE 3/7/78
               (*4ACCT)SSSBATMM WHERE SSS=SYSTEM AND MM=MONTH
       ALSO FORMAT OF (*4ACCT) RECBATCH AND RECREMOTE

WORD   OCTAL   DESCRIPTION
____   _____   ___________
 0       0     BITS 0-11 TRANSACTION TYPE / BITS 12-23 JOB TYPE
 1       1     USER NAME
 2       2     USER NAME
 3       3     USER NAME
 4       4     USER NAME
 5       5     GAN
 6       6     UUN
 7       7     HOST
 8      10     DATE AND TIME OF REQUEST (IN CUBS), CORRECTED TO GMT
 9      11     PROJECT CODE (12 CHAR MAX)
10      12       PROJECT CODE
11      13       PROJECT CODE
12      14       PROJECT CODE
13      15     REQUEST NUMBER
14      16     REQUESTED BY (12 CHAR MAX)
15      17       REQUESTED BY
16      20       REQUESTED BY
17      21       REQUESTED BY     

     (WORDS 18-27 ARE ONLY USED WITH CERTAIN JOB TYPES)
               JOB TYPES        DESCRIPTION
               _________        ___________

18      22     8,10             NUMBER OF CHARACTERS PROCESSED
19      23     1,10             NUMBER OF PAGES PRINTED
20      24     1,10             NUMBER OF PARTS OF PAPER
21      25     2,3,4            NUMBER OF CARDS PROCESSED
                 5,7,10           NUMBER OF FILES PROCESSED
22      26     5,7,8,12         NUMBER OF TAPES PURCHASED
23      27     7                NUMBER OF TAPES CONVERTED
24      30     1,10             WERE LISTINGS DECOLLATED?  (1=NO 2=YES)
25      31     ALL              TYPE OF CURRENCY USED (3 CHARS)
26      32     ALL              DELIVERY CHARGES IN HUNDRETHS (CENTS)
27      33     NONE             SPARE WORD
   G s