DIM ** FICHE/FRAME BREAK *****
DIMDUALVER14
:      DIM     DISC MONITOR. DAVID GARDNER.

*      DIM  FILE LAYOUT
*              SYMBOLIC PARAMETERS
*              FIRM ABSOLUTE LOCATIONS 
*              INDIRECTS
*              LOW CORE VARIABLES
*              LITERALS
*              PURE E *        BEGINING OF READ ONLY CODE.
*              CRASHH AND CRASHV. HOST AND VARIAN CRASH CODES
*              CLOCKI          TIME KEEPER AND TYMNET CHARACTER HANDLER.
*              TASK MONITOR  (CALL DISC MANAGER, DDT, CHECK MEMORY, ETC)
*              DISC MANAGER
*              CHECK 540 UP AND RUNNING CODE
*              DDT
*              CHECK MEMORY CODE
*              LOW LEVEL SUBROUTINES
*              EPURE E *       END OF READ ONLY CODE THAT IS CHECKED BY CKM.
*              SUBROUTINE LINKAGE ROUTINES
*              HIGH CORE READ/WRITE AREA. CONTAINS BUFFERS AND SOME CODE.
*              620 LOADERS

MSIZE  E 20000
NBIT   E 15    NUMBER OF BITS IN DIM CORE LOCATION ADDRESSES
JAZBZ  E 1030  JUMP A AND B ZERO
JAPBZ  E 1022
JAPXZ  E 1042
JANBZ  E 1024
JANXZ  E 1044
CRLF   E 106612  CAR. RETURN LINE FEED PACKED IN 2 8 BIT ASC CHARACTERS


CSW    E 44    LOC. FOR THE SELECTOR CHANNEL STATUS WORD

*      CHANNEL STATUS WORD BITS 
CHE    E 4000  CHANNEL END
DEE    E 2000  DEVICE END
UCK    E 1000  UNIT CHECK

*      CHANNEL COMMAND WORD FLAGS
CNOP   E 1400  CHANNEL NOP
SK     E 3400  SEEK COMMAND
SH     E 15400   SEEK HEAD
SNS    E 2000  SENSE COMMAND
SFM    E 17400 SET FILE MASK COMMAND
WHA    E 14400   WRITE HOME ADDRESS
WR0    E 12400   WRITE RECORD ZERO
WCKD   E 16400   WRITE COUNT,KEY, AND DATA
RECAL  E 11400   RECALIBRATE. SEEK TO CYLINDER -1.
RD     E 3000  READ DATA CCW
WD     E 2400  WRITE DATA
IDE    E 30400 SEARCH IDENTIFIER EQUAL
CDF    E 200   CHAIN DATA 
CCF    E 100   CHAIN COMMANDS
SLI    E 40    SUPPRESS LENGTH
SKP    E 20    SKIP DATA
TIC    E 10    TRANSFER IN CHANNEL PROGRAM
F520   E 4     DATA TO 520 MEMORY

       R 0
       NOP;: FIRST INSTRUCTION IN 520 MEMORY
       JMP IZ  (JUMP TO INITILIZE);
       R 10; JMPM POFF; JMPM PON   POWER OFF-ON INTERRUPTS
       R 20; JMPM CLOCKI  (CLOCK INTERRUPTS 330 TIMES/SECOND);
       R 24; JMPM I24
       R 40; JMPM PI (POLLING STATUS INTERRUPT)
       JMPM  17663  USED BY LOADER. CHANGED TO JMPM TI IN IZ.
       R 70; JMP 0  SOMEDAY REMOVE THIS LINE AND HAVE IPL JMP 0
       R 73   POWER OFF INTERRUPT LOCATION
POFF   0; INR PFC; 0   HALT WITH P = 76
       R 76; 0 HALT REACHED FROM CRASHV; 0 RESERVED FOR CRASHV MARK LOC.

*      BEGINNING OF INDIRECTS   *******************************************************************
       R 100
CRV7   +CRASHV
CRVA   0
CRVB   0
CRVX   0
HPTR   +EPDS-1.
FT9    0
PET7   0; 0
RGP    20+RGTAB
ACP    0
SKBAD7 +SKBAD
VNUM7  +VNUM
COADR  +TBF
JAB9   0; 0
JAB8   0
JVG8   0
JT     0
JCL9   0
JCL91  0
JKM9   0
KADR   0
UPP    0
TP     +TL
JDOT   0
JVAL   0
T1     0
T2     0
T3     0
T4     0

*      END OF INDIRECTS  ************************************************************************

*      BEGINNING OF LOW CORE VARIABLES  *********************************************************

SRV    0
SEMIA  0
SEMIB  0
SEMIX  0
SEMI1  0
SEMI2  +MSIZE-1
SEMIM  -1

W1     0
W2     0
W3     0
W4     0
W5     0
W6     0
W7     0
W8     0
WP1    0
AL     0;:   BEGINNING OF ACTIVE LIST CHAIN. 
FL     +LIST   FREE LIST CHAIN
UP540  -2; -2
TIMEL  -1
TIMEH  -1
TIMEHH -1
CLOCKA 0
CLOCKB 0
BI9    0
BO9    0
CIB    0
CIORET 0
CICHR  0
WPAC   0
WCH    0
WREC   0
WCA    0
WCC    0
WMEM   0
WFLG   0
ERCT   0
UPH    0
PET    +BET
UPL    0
UPER   0
UPN540 0
N540   0
M540   0
INT203 EXC 30
LOK    0
NGN    -1
KEY    1
A540   0
B540   0
OUT540 0; 0
PFC    0
PNC    0
RC     0
MB     0
TIM540 0; 0
DRQ    0; 0
DRQU   0; 0
RQ1    0; 0;: POINTER TO NEXT FREE SPOT IN 940 DISC QUE.
RQ2A   0; 0;: POINTER TO NEXT 940 DISC QUE SPOT THAT DM3 SHOULD READ
RQ2    0; 0;: THIS POINTER CHASES RQ1. DIM MUST DO DISC WORK TO INCR RQ1
JVAL1  0
WSA    0
AVB    0
ACB    0
ISWTCH +BI1
OSWTCH +BO1
BIP1   0   POINTS TO NXT FREE SLOT FOR INPUT CHR IN TBF
BIP2   0   CHASES BIP1. USED BY CI TO PICK UP CHR BUFFERED IN TBF BY BI1
BOP1   0   NEXT FREE SLOT TO BUFFER AN OUTPUT CHR. USED BY CO.
BOP2   0   CHASES BOP1 UNTIL BUFFERED OUTPUT CHRS IN TBF ARE SENT TO TTY
ESCSW  -1
RG1    1
RG2    0
FT8    0
FT9A   0
MCADR  0
MC540  0
MCDATA 0; 0; 0
MC4    0
TY1    0
TY2    0
TY3    0
RTC    0
RANBIT 147250   8 OFF AND 8 ON BITS
RGTAB  3; 0; 7; 1; 23; 2; 51; 3; 103; 4; 153; 5; 227; 6; 301; 7
       -1 END OF RGTAB (RGTAB+20)
IOC    0
WSB    0
WS9    0
WS8    0
WS7    0
WS6    0
WS5    0
GSB    0
GS9    0
GS8    0
GS7    0
ASX    0
ASB    0
AS9    0; 0
AS8    0
ABA    0
SSB    0
SSX    0
SS9    0; 0
SS8    0; 0
SS7    0
SS6    0
SGA    0
SGX    0
SG9    0
VGX    0
VG9    0; 0; 0; 0; 0
NDA    0
NDB    0
NDX    0
ND9    0
SC9    0; 0
SCMASK 0
SC8    0
SCTOT  0
ICA    0; 0
ICX    0
IC9    0
EVTOT  0
EV9    0; 0
EVSIGN 0
EVFLG  0
EV7    0
SENBYT 0; 0; 0
SUBSTR 0; 0
RSB    0
RS9    0
CLA    0
FUA    0
FUB    0
EQ9    0
DCA    0
DC9    0
RSMASK 0
SW9    0

OPEN   0
TMODE  2
ISCSW  77777
VALB   0
VALB1  2
VALC   0
SW8    0
YCT    +CT1; +CT2
CSTR   E *; R *+40   DDT COMMAND STRING
TEMP   E *; R *+40   TEMPORARY STORAGE ARRAY
KL     0       LOW ORDER COUNTER FOR CALLS TO CKM
KH     0       
KC1    77777   POSITIVE WHEN NEXT CHECKSUM COMPUTATION MUST BE CORRECT
KC2    0
KTP1   +KAREA1
KTP2   +KAREA2
ECHO   1
PWTIME -3
PW5    0
KDOT   0

WTCP   E *     CHANNEL PROGRAM TO WRITE DISC FOR WT CODE
       +SFM+CCF+F520; +DBF; 1
WTSK   +SK+CCF+F520; +DBF; 6
WTIDE  +IDE+CCF+F520; +DBF+1; 5; +TIC+F520; +*-4; 0
       +WD+CCF+F520; +DBF; 1400
WTTIC  +TIC+F520; +WTSK; 0
WTNOP  +CNOP+F520; 0; 0
       123456   USED BY TDI

FCP    +SFM+CCF+F520; +DBF; +1   CHANNEL PROG. TO FORMAT THE DISC
FSK    +SK+CCF+F520; +DBF+7; 6
       +WHA+CCF+F520; +DBF+1; 5     WRITE HOME ADDRESS
       +WR0+CCF+F520; +DBF+4; 10     WRITE RECORD 0
       +WCKD+CCF+SLI+F520; +DBF+10; 10    WRITE RECORD 1
       +WCKD+CCF+SLI+F520; +DBF+14; 10    WRITE RECORD 2
       +WCKD+CCF+SLI+F520; +DBF+20; 10
       +WCKD+CCF+SLI+F520; +DBF+24; 10
       +WCKD+CCF+SLI+F520; +DBF+30; 10
       +WCKD+CCF+SLI+F520; +DBF+34; 10
       +WCKD+CCF+SLI+F520; +DBF+40; 10
       +WCKD+CCF+SLI+F520; +DBF+44; 10    WRITE RECORD 8
FTIC   +TIC+F520; +WTNOP; 0
       123456   USED BY TDI

*      END OF LOW CORE VARIABLES  ****************************************************************

PURE   E *     MEMORY FROM HERE TO EPURE IS READ ONLY

       L EBIT    LITERAL ASSIGNMENT
BIT    1; 2; 4; 10; 20; 40; 100; 200
       400; 1000; 2000; 4000; 10000; 20000; 40000; 100000
EBIT   E *
       R 300*  SPACE FOR LITERALS THAT ARE NOT BETWEEN BIT,EBIT
ELIT   E *-1


*              CRASH SUBROUTINES ***************************************
CRASHH 0;: CRASH ONE HOST IF IT IS UP.
       INR KC1   RECOMPUTE READ ONLY CODE CHECKSUMS
       STA CRHA; STB CRHB; STX CRHX
       LDB N540; LDA UP540,6; IAR; JAN CRH2; LDA =-2
STAUP6 STA UP540,6
       LRLB 12; STB T1
       LDA UP540; ADD UP540; ADD =3  IF BOTH DOWN, SYNCHRONIZE TIM540 SO
       JAP 4*; STA TIM540; STA TIM540+1  CKKEY BRINGS UP UPN540 FIRST.
       TZA; LDX =DBF   SAVE THE BIT LOOKERS
       OAR 65; CIB 65; STB 0,5; ADD =2000; IXR; JAZ 4*; JMP *-7
       LDA =74; OAR 36; LDA =100003; OAR 37; LDA =21; ORA T1
       OAR 35    STORE BRM 3 AT CLOCK INTERRUPT LOCATION
       LDA =12000; DAR; JAP *-1    WAIT FOR LAST 940 CLOCK TICK.
       LDA =27; OAR 36; OAR 37; OME 35,T1    DESTROY POINTER TO KEY
       LDX =100000-1
CRH1   INC X,ABX; OBR 36; LDB 0,6; OBR 37; OME 35,T1; SUB =120000-1
       JAN CRH1    COPY DIM STARTING AT 940 LOCATION 100000.
CRH2   LDA CRHA; LDB CRHB; LDX CRHX; JMP .CRASHH

CRASHV 0;: CRASH THE VARIAN.
       STA CRVA; STB CRVB; STX CRVX; LDA N540; STA CRV540
       TZA; STA N540; JMPM CRASHH; INR N540; JMPM CRASHH
       LDA CRV7,7; STA 77 (MOVE MARK TO HANDY PLACE);
       JMP 76    HALT THE VARIAN
CRHA   0
CRHB   0
CRHX   0
CRV540 0

CLOCK1 JS3M CRASHV    OPERATOR SENSE SWITCH CRASH
       STA CLOCKA; STB CLOCKB
       INR TIMEL; LDA TIMEL; JAZ 4*; JMP .ISWTCH
       INR TIMEH; LDA TIMEH; XAZ 4*; JMP .ISWTCH; INR TIMEHH

*      CHARACTER INPUT OUTPUT MODULES   **************************************************

BI1    E *     BOD INPUT ROUTINE
       CIA 60; ANA =1; DAR; JAP .OSWTCH  WAIT FOR START BAUD
       LDAI .BITAB; STA ISWTCH  SKIP 3 BUADS TO CENTER OF 1ST INFO BIT
       LDA =1777; STA BI9   (INITIALIZE CELL TO BUILD CHAR); JMP .OSWTCH
BI2    INR ISWTCH; JMP .OSWTCH    SKIP THIS INT
BI3    E *     PUSH BIT INTO LEFT END OF BI9
       LDB BI9; CIA 60; LLSR 1; TBA; ANA =1   (IF THE 1777 HAS BEEN
       JAZ BI4 SHIFTED AWAY,THEN BI9 LEFT CONTAINS A FULL CHR FOR TBF.)
       STB BI9; LDAI .BITAB+1; STA ISWTCH  COUNT 3 INTS TO NXT INFO BIT
       JMP .OSWTCH
BI4    LDA BIP1; ANA =77; ADD =TBF   ADDRESS OF NEXT SLOT IN TBF
       LLRL 20; LRLA 2; ORA =. (PARITY BIT);
       ERA 0,6; ANA =-400; ERA 0,6; STA 0,6   INSERT CHARACTER
       LDBI BI1; STB ISWTCH (WAIT FOR START BAUD); INR BIP1 NXT TBF SLOT
       LSRA 10; ERA =223 (CONTROL S); XAZ 4*; JMP .OSWTCH
       INR ESCSW    USER INTERRUPT DIM WITH A CONTROL S. SET SWITCH.
BITAB  +BI2; +BI2; +BI2; +BI3

*      BOD OUTPUT ROUTINE
BO4    LDAI BO1; STA OSWTCH   END OF THIS CHARACTER.
BO1    LDA BOP2; SUB BOP1; JAZ CLOCKX  (NOTHING IN TBF TO OUTPUT);
       LDA BOP2; INR BOP2; ANA =77; ADD =TBF; TAB (ADRS OF NXT CHR);
       LDA =1400; OAR 60 (START BAUD); ORA 0,6; ANA =1777
       JMP BO3A  (OUTPUT INFO BIT IN 9 MILISECONDS)
BO2    INR OSWTCH; JMP CLOCKX    (NO CHANGE IN TTY OUTPUT VOLTAGE YET);
BO3    LDA BO9; JAZ BO4 (INFO BAUDS AND 2 STOP BAUDS HAVE BEEN OUTPUT);
       OAR 60  (BAUD OUT); LSRA 1   (SET UP BO9 FOR NXT BAUD OUT);
BO3A   STA BO9; LDAI .BOTAB; STA OSWTCH (OAR DONE. PREPARE FOR NXT OAR);
       JMP CLOCKX
BOTAB  +BO2; +BO2; +BO3

CI     E *     GET CHR TO A FROM INPUT BFR. GIVE BUILT CHR TO CALLER.
       STB CIB; STA TP,7 (DISMISS PC); ADD =4; STA CIORET (EXIT PC);
       LDA TIMEHH; JAP CI1  (REAL 620, NOT 940 SIMULATOR);
       SEN 0201,4*; JMP DMS1; CIA 1 (SIMULATE CIO =0); STA CICHR
       LDB ECHO; JBZ CI3; OAR 1; JMP CI3
CI1    LDA ESCSW; JAP ESCAPE
       LDA BOP2; SUB BOP1; JAN DMS1  (OUTPUT IN PROGRESS,WAIT, ECHO LATER)
       LDA BIP2; SUB BIP1; ANA 21,7; ANA 41,7; ANA 43,7
       JAP DMS1  (DISMISS IF NO CHARACTERS OR DISC IS WAITING FOR SERVICE);
       LDA BIP2; ANA =77; ADD =TBF; TAB
       INR BIP2; LDA 0,6; LSRA 10; STA CICHR
       LDA =377; JMPM DIR; ANA 0,6; STA 0,6 (CLEAR POSSIBLE PSWRD CHRS);
       LDB ECHO; JBZ CI2A
       LDA BOP1; ANA =77; ADD =TBF; TAB
       LDA CICHR; ERA =215; JAZ CI4 (CAR. RET.)
       ERA =7; JAZ CI4 (L. FEED); LDA CICHR
CI2    ERA 0,6; ANA =377; ERA 0,6; STA 0,6; INR BOP1
CI2A   JMPM EIR; LDA CICHR
CI3    LDB CIB; JMP .CIORET
CI4    LDA 0,6; ANA =-400; ORA =215; STA 0,6; INR BOP1
       LDA BOP1; ANA =77; ADD =TBF; TAB; LDA =212; JMP CI2

CO     E *     DELIVER CHR IN X TO OUTPUT BAUD ROUTINE.
       STA TP,7; ADD =4; STA CIORET
       LDA TIMEHH; JAP CO1
       SEN 0101,4*; JMP DMS1; TXA; OAR 1; JMP .CIORET
CO1    LDA ESCSW; JAP ESCAPE
       LDA BOP1; SUB BOP2; SUB =100; ANA 21,7; ANA 41,7; ANA 43,7
       JAP DMS1
       LDA BOP1; ANA =77; ADD =TBF; STA COADR
       TXA; JMPM DIR
       ERA COADR,7; ANA =377; ERA COADR,7; STA COADR,7; INR BOP1
       JMPM EIR; JMP .CIORET

*      END OF CHARACTER INPUT OUTPUT MODULES   *************************************************

CLOCKX LDA CLOCKA; LDB CLOCKB; EXC 777 (EIR); JMP .CLOCKI

IZ     E *     DIM INITIALIZATION
       EXC 130     CLEAR THE MIC; EXC 254    CLEAR THE DISC
       LDA =TI; STA 43   POINTS TO TEMINATING STATUS INTERRUPT ROUTINE
       DEC ,A; STA NGN; STA ESCSW
       LDA =VERS; LDB =TL; STA TLDDT-TL,6; STB TP
       LDA =-2; STA UP540; STA UP540+1
       INR KC1
       LDB =LIST; STB FL    INITIALIZE LIST
       TBA; ADD =10; STA 0,6; TAB; SUB =ELIST-10; JAN *-5
       STA 0,6; STA AL; STA TIM540; STA TIM540+1    A=0
       STA BIP1; STA BIP2; STA BOP1; STA BOP2; STA LOK
       LDA =BI1; STA ISWTCH; LDA =BO1; STA OSWTCH
       JMPM EIR
       JMP ACT1 (START TASK MONITOR);

*      TASK MONITOR   ***********************************************************************

DMS    STA TP,7
DMS1   INR TP; STB TP,7; INR TP; STX TP,7; INR TP
       LDA 21,7; ANA 41,7; ANA 43,7; JAN ACT
ACT1   LDA =TL; STA TP
ACT    LDX TP; LDA 0,5; STA T1; LDB 1,5; LDX 2,5; JMP .T1

MAYDMS LDA ESCSW; JAP ESCAPE   DON'T RETURN TO CALLER IF USER ESCAPED
       LDA 21,7; ANA 41,7; ANA 43,7; JAN L (NO REAL TIME WORK TO DO);
       LDAI L; JMP DMS (DO SOME REAL TIME WORK, THEN RETURN TO CALLER);

*      END OF TASK MONITOR  ******************************************************************


DM     E *     DISC MANAGER.   ************************************************************
*              DM READS COMMANDS FROM THE 540 DISC QUE AND PUTS THEM ON THE
*              520 AL (ACTIVE LIST) WHERE A DISC COMMAND MOVES FROM 
*              STATE 0 (FIRST STATE) TO STATE 1 (SEEKING) TO
*              STATE 2 (SEEKING FINISHED) TO STATE 3 (TRANSFERRING).
*              AFTER STATE 3 THE AL ENTRY IS DELETED. THE RIGHT 3 BITS
*              OF THE FLG WORD CONTAIN THE STATE.

       DEC ,A; STA 41,7
       LDX =AL   HAVE ANY TRANSFERS STARTED
DM1A   LDX 0,5; JXZ DM2  (NO);
       LDA FLG,5; ANA =7; ERA =3; DAR; JAP DM1A
*      THE CHANNEL IS OR WAS TRANSFERRING
       LDA 43,7; JAN DM6 (STILL TRANSFERRING. DON'T DO DISC WORK YET);
INRFLG INR FLG,5; DEC ,A; STA 43,7
       LDA PAC,5; LSRA 3; STA N540
       LDA 44; ERA =6200; JAZ DM1C; INR ERCT
       ANA =1000; LLSR 23  (UNIT CHECK BIT);
       LDA FLG,5; ANA =50  (ERROR RETRY BIT AND R/W BIT);
       LRLA 12; JAN DM1C  (INHIBIT ERROR PROCESSING);
       LSRA 10; COP AB,A; ORA CH,5  (CYL,UNIT CHECK,R/W,HEAD INFO)
       LDB PET; STA 0,6  (SAVE COMPRESSED DISC INFO IN ERROR RECORD);
       LDA 44; STA 1,6; ANA =1000; JAZ DM1B (NO UNIT CHECK. 2 WORD REC.)
       LDA PAC,5; JMPM H; +SNSIO   DO A SENSE THEN RECALIBRATE
       LDA =CPRC; STA 14; LDA PAC,5; JMPM H; +GIO; INR RC; JMPM H; +WIO
       LDB PET   (MOVE 6 SENBYTES INTO LAST 3 OF 4 WORD ERROR RECORD);
       LDA SENBYT; STA 1,6; LDA SENBYT+1; STA 2,6; LDA SENBYT+2; STA 3,6
       IBR; IBR
DM1B  IBR; INC B,AB; SUB =EET+1; XAN STBPET
       JSS2 DM1TS3 (IS SS2 SET TO IGNORE BUSY DURING CONTROLLER DIAGNOSTICS)
DM1TS1 LDA FLG,5; ADD =20000; STA FLG,5; JAN DM1C (UNRECOVERABLE ERROR);
DM1TS2 ANA =-10; STA FLG,5; JMP DM2 (TRY AGAIN);
DM1TS3 LDA CSW; ERA BUSY; JAZ DM1TS4 (BUSY, IGNORE); JMP DM1TS1
BUSY 50200     BUSY MASK
DM1TS4 LDA FLG,5; JMP DM1TS2
DM1C   STX W1; LDA PP,5; STA W2; JMP W2. (CALL POST PROCESSING ROUTINE);
DM1D   LDX W1; JMPM H; +GIVEL

DM2    E *     LOOK FOR POLLING INTERRUPTS
       LDX =AL
DM2A   LDX 0,5; JXZ DM3
       LDA FLG,5; ANA =7; ERA =1; DAR; JAP DM2A
*      THIS ENTRY WAS SEEKING
       LDA =CPSNS; STA 14; LDA PAC,5
       JMPM H; +GIO; JMPM H; +WIO     DO A SENSE
       LDA 44; ANA =10000; XAZ INRFLG
*      DONT LOOP BACK. ADVANCE TO TRANSFER STATE IN ORDER OF DISC LIST.

DM3    E *   READ 540 REQUESTS FROM  THE 540 DISC QUE
       LDA LOK; JAN DM4  (SOME DIM ROUTINE WANTS TO LOCK OUT THE 940S);
       LDA RANBIT; LRLA 1; STA RANBIT; ANA =1; STA N540
DM3A   LDX N540; LDA UP540,5; JAN DM3D   (940 DOWN);
       LDX =32; JMPM H; +R540; +DM3D   READ DIM REQUEST POINTER
       LDX N540; STB RQ1,5
DM3B   LDA FL; JAZ DM4  (AL HAS GRABBED ALL AVAILABLE  STRING STORAGE);
       LDX N540; LDA RQ1,5; ERA RQ2A,5; JAZ DM3D  (940 NOT WAITING);
       LDX RQ2A,5; JMPM H; +R540; +DM3D; STA W1; STB W2  1ST DRQ WORD
       IXR; JMPM H; +R540; +DM3D; STA W3; STB W4         2ND DRQ WORD
       IXR; JMPM H; +R540; +DM3D; STA W5; STB W6         3RD DRQ WORD
       JBZ DM3C  ILLEGAL. CHR COUNT FIELD IS ZERO. TRAP THIS 940. MAYBE
*                 SOMEBODY CLEARED MEMORY.
       INC X,AB; LDX N540; SUB DRQU,5; XAP LDBDRQ; STB RQ2A,5
       LDA W1; ERA W2; ERA W3; ERA W4; ERA W5; ERA W6; STA W7
       LSRA 10; ERA W7; STA W7; LSRA 4; ERA W7; ANA =17
       DAR; JAP DM3C
       JMPM H; +GETL; +PF
       LDA W1; LLSR 5; LDA N540; LLRL 3; STA PAC,5
       LDA W1; LDB W2; LLRL 6; LSRB 3; LLSR 10; STB CH,5
       LDA W2; ANA =37; STA REC,5
       LDA W4; STA CA,5
       LDA W5; ANA =200; LSRA 4; STA FLG,5
       LDA W6; LRLA 11; JAP 3*; ANA =100000; LSRA 11; IAR; ANA =176
       STA CC,5   STORE EVEN CC SO I/O IS IN MULTIPLES OF 100 540 WORDS
       LDAI PP540; STA PP,5
       JMP DM3B
DM3C   JMPM CRASHH    FOLDED CHECKSUM IN 3 WORD DISC COMMAND WAS BAD
DM3D   LDA N540; ERA =1; STA N540; ERA RANBIT; LRLA 17; JAN DM3A

DM4    E *     START SEEK FOR EACH STATE 0 ENTRY THAT HAS UNBUSY PACK
       LDX =AL
XTZA   TZA
DM4A   STA W1
DM4B   LDX 0,5; JXZ DM4C
       LDA FLG,5; ANA =7; JAZ DM4B
       LDB PAC,5; LSRB 1; LDA W1
       ORA BIT,6     SET ONE OF 8 BUSY PACK BITS
       JMP DM4A
DM4C   LDX =AL
DM4D   LDX 0,5; JXZ DM5
       LDB PAC,5; LSRB 1; LDA W1; ANA BIT,6; LDB BIT,6; LLRL 20; ORA W1
       STA W1; LDA FLG,5; ANA =7; +JAZBZ; +3*; JMP DM4D
*      START A SEEK
       TZA; STA W4; LDA CH,5; LSRA 10; STA W5; LDA CH,5; ANA =377; STA W6
       LDA =CPSEK; STA 14; LDA PAC,5
       JMPM H; +GIO; INR FLG,5; JMPM H; +WIO   START A SEEK
       LDA 44; ERA =200+CHE+DEE; XAZ INRFLG
       JMP DM4D
LDBDRQ LDB DRQ,5

DM5    E *     FIND A 2 STATE (READY TO TRANSFER) THAT HAS NO EARLIER
*              ENTRY FOR THAT 540.
       LDX =AL; TZB
DM5A   LDX 0,5; JXZ DM6
       LDA FLG,5; ANA =7; ERA =2; JAZ DM5B
       LDA PAC,5; LSRA 3; IAR (A=1 OR 2,940 BIT); COP AB,B; JMP DM5A
DM5B   LDA PAC,5; LSRA 3; IAR; STB W1; ANA W1; DAR
       JAP DM5A  (THIS SEEK FINISHED QUICK,EARLIER 940 REQUEST ON LIST);
*      START A TRANSFER
  INR FLG,5; JMPM H; +BCP   BUILD CHANNEL PROGRAM
       LDA =CBF1; STA 14; LDA WPAC; JMPM H; +GIO   SIGNAL THE CHANNEL

DM6    DEC ,A; STA 21,7; JMP DMS1  DONT CALL DM FOR UP TO 3 MILISECONDS.


PP540  E *     POST PROCESS FOR 540 IO
       LDA FLG,5; JAP PP540A
       LDA =200; LDB CA,5; LDX N540; LDX RQ2,5; IXR
       JMPM H; +W540; 1*         TELL 540 ABOUT IO ERROR
PP540A LDX N540; LDA RQ2,5; ADD =3; TAB; SUB DRQU,5; XAP LDBDRQ; STB RQ2,5
       TZA; LDX =34; JMPM H; +W540; +PP540C   ( UPDATE DRQ POINTER)
       JMPM H; +R540; +PP540C   (READ BACK THE DISC POINTER JUST WRITTEN)
       LDX N540; LLRL 20; ERA RQ2,5    (CHECK IT FOR POSSIBLE MIC ERROR)
       +JAZBZ; +PP540D
PP540C JMPM CRASHH  (LAST DISC QUE POINTER FAILED TO WRITE RIGHT, MIC ER)
PP540D LDA N540; LRLA 7; ERA PP540B; STA INT203
       XEC INT203   RAISE 203 INTERRUPT ON ONE OF THE 2 940S
       JMP DM1D
PP540B EXC 230      RAISE A 203 INTERRUPT ON THE LOWER PACKS 940.

CPSNS  E *     CHANNEL PROGRAM TO DO A SENSE COMMAND
       +SNS+F520; +SENBYT; 6           SENSE DISC COMMAND
CPSEK  E *     CHANNEL PROGRAM TO DO A SEEK ACCORDING TO W4,W5,W6 DATA
       +SFM+F520+CCF; 16+BIT; 1       SET FILE MASK
       +SK+F520; +W4; 6                SEEK CYLINDER AND HEAD FROM W4,W5,W6

CPRC   E *     CHANNEL PROGRAM TO RECALIBRATE THE DISC ARM POSITION
       +RECAL+F520+CCF+SLI; 0; 0; +CNOP+F520

GIO    E *     SELECT SELECTOR CHANNEL ON IO BUSS. SEND PACK NUMBER.
       LRLA 10; ORA =30001; DEC ,B; STB 43,7 (RESET INT. MARK LOC.);
       OAR 54; INR IOC
       JMP L

WIO    E *     WAIT FOR INT. AT 42 WHICH SHOULD ARRIVE IN SHORT TIME
       LDA 43,7; JAN *-1; DEC ,A; STA 43,7; JMP L

SNSIO  E *     DO A SENSE FOR THE PAC IN A
       DEC ,B; STB SENBYT; STB SENBYT+1; STB SENBYT+2
       LDB =CPSNS; STB 14; JMPM H; +GIO; JMPM H; +WIO; JMP L

BCP    E *     BUILD CHANNEL PROGRAM. LIST POINTER IN X.
       LDA PAC,5; STA WPAC
       LDA CH,5; STA WCH; LDA CA,5; STA WCA
       LDA CC,5; STA WCC; LDA REC,5; STA WREC
       LDA FLG,5; STA WFLG; ANA =10 (READ/WRITE BIT); STA T4
       LDA WFLG; ANA =20; ORA WPAC; LSRA 2; ANA =6; STA WMEM
       LDA =123456; STA SKBAD7,7
       LDA =CBF1; STA T1; LDA =CBF2; STA T2

*      OUTPUT A SFM (SET FILE MASK)
       LDA =SFM+CCF+F520; LDB T2; INC ,X; JMPM H; +BCP3
       LDA WFLG; ANA =10; ERA =10; LRLA 13; STA T2,7; INR T2

*      OUTPUT A SEEK
BCP1   LDA =SK+CCF+F520; LDB T2; LDX =6; JMPM H; +BCP3
       TZA; STA T2,7; INR T2
       LDA WCH; LLSR 10; STA T2,7; INR T2; LSRB 10; STB T2,7; INR T2

BCP2   JMPM H; +BCPIDE       SEARCH ID EQUAL
       LDA WCC; SUB =10; JAN BCPCD  (CHAINED DATA);
BCPCC  E *     COMMAND CHAIN A SEQUENCE OF READS OR WRITES
       LDA WMEM; ORA =RD+CCF; LDB WCA
       LDX T4; JXZ 11*; ADD =WD-RD; LDX WP1; JXZ 5*
       SUB =WD-RD; ORA =F520+SKP; LDB SKBAD7
       LDX =1400; JMPM H; +BCP3
       LDA WCA; ADD =400; STA WCA
       LDA WCC; SUB =10; STA WCC; SUB =10; JAN BCPX
       LDA WREC; ADD =4; ANA =34; STA WREC; DAR; LDX T4
       +JAPXZ; +BCPCC   OUTPUT NEXT READ
       JAP BCP2    PRECEDE NEXT WRITE WITH A SEARCH ID
       INC ,AB      CHANGE HEAD AND MAYBE CHANGE CYLINDER
       ADD WCH; ANA =377; SUB =24; JAN 3*; LDB =400-23 (NXT CYL);
       TBA; ADD WCH; LLSR 10; SUB =310
       JAN 3*; LDA =4 (ILLEGAL PACK CROSSOVER, CAUSE ERROR);
       ADD =310; LLRL 10; STA WCH
       JMP BCP1 (GENERATE SEEK COMMAND);
BCPCD  E *     SMALL READ OR WRITE. USE CHAINED DATA COMMANDS.
       LDX T4    READ OR WRITE FLAG
       LDA WCC; LRLA 1; ADD WCC; LRLA 5; STA T4   CHR COUNT
       TZA; STA T3   COUNTS 0,1,2, AND 3 FOR EACH 100 WORD SEGMENT
       JXZ BCPCD3  (CHAINED READ);
       LDA =RD+CCF+F520; LDB =DBF; LDX =1400
       JMPM H; +BCP3    READ BEFORE WRITE
       JMPM H; +BCPIDE   ROTATE DISC BACK TO THE SAME RECORD
BCPCD1 LDA T3; SUB =4; JAP BCPX
       ERA WREC; ANA =3; JAZ BCPCD2
       LDA T3; ADD T3; ADD T3; LRLA 5; ADD =DBF; TAB; LDA =WD+CDF+F520
       LDX WP1; JXZ 4*; LDA =RD+CDF+F520+SKP; LDB SKBAD7; LDX =300
       JMPM H; +BCP3; INR T3
       JMP BCPCD1
BCPCD2 LDA WMEM; ORA =WD+CDF; LDB WCA
       LDX WP1; JXZ 4*; LDA =RD+CDF+F520+SKP; LDB SKBAD7; LDX T4
       JMPM H; +BCP3
       LDA WCC; LSRA 1; ADD T3; STA T3
       JMP BCPCD1
BCPCD3 LDA T3; SUB =4; JAP BCPX
       ERA WREC; ANA =3; JAZ BCPCD4
       LDA =RD+CDF+F520+SKP; LDB SKBAD7; LDX =300; JMPM H; +BCP3
       INR T3; JMP BCPCD3
BCPCD4 LDA WMEM; ORA =RD+CDF; LDB WCA
       LDX T4; JMPM H; +BCP3
       LDA WCC; LSRA 1; ADD T3; STA T3
       JMP BCPCD3
BCPX   E *     CHANNEL PROGRAM IS BUILT. REMOVE LAST CHAINING BIT.
       LDB T1; DEC B,X; DXR; DXR; LDA 0,5; ANA =-1-CCF-CDF; STA 0,5
       LDX =123456; STX 0,6
       LDB T2; STX 0,6
       JMP L

BCP3   STA T1,7; INR T1; STB T1,7; INR T1; STX T1,7; INR T1
       JMP L


BCPIDE E *     OUTPUT A SEARCH ID EQUAL COMMAND SEQUENCE
       LDA =IDE+CCF+F520; LDB T2; LDX =5; JMPM  H; +BCP3
       LDA WCH; LLSR 10; STA T2,7; INR T2; LSRB 10; STB T2,7; INR T2
       LDA WREC; ANA =34; LRLA 6; ADD =400; STA T2,7; INR T2
*      TIC. TRANSFER IN CHANNEL TO THE SEARCH ID EQUAL COMMAND
       LDA T1; SUB =3; TAB; LDA =TIC+F520; TZX; JMPM H; +BCP3
       JMP L

*      END OF DISC MANAGER  *****************************************************************
CKKEY  E *     CHECK TO SEE IF THE 540 IS UP OR DOWN. UPDATE UP540
*      WHICH WAS -2 IF 540 DOWN, -1 IF ONE GOOD READ OF KEY (COMING UP),
*      OR 0 IF 540 HAS HAD AT LEAST 2 CONSECUTIVE GOOD KEY READS.
*      CLOBBER KEY WHEN A GOOD KEY READ IS MADE. SET TIM540 (THE TIME
*      TO CHECK THE 540 LATER ON) AT CURRENT PLUS 8 SECONDS IF KEY READ
*      IS GOOD, OR AT THE CUURENT TIMEL PLUS 100 MILISECONDS IF THE
*      KEY READ IS BAD.
       LDB UPN540   LOOK FIRST AT 940 THAT LAST COMPLETED THE UP COMMAND
:      IF BOTH MICS SEE ONE 940 THEN CKKEY WIL BRING UP THE
:      RIGHT CHOICE OF 2 APPARENT MEMORIES.
CY1    TBA; STA N540; STA W1; ERA NGN
       JAZ CY4 (JUMP IF ONLY ONE 940 ON MIC);
       LDA TIMEL; SUB TIM540,6; JAN CY4
       LDA UP540,6; IAR; JAP CY2
*      UP540 IS -2, KEY IS AT DRQU. READ DRQ FROM 540 LOCATION 26.
       LDX =26; JMPM H; +R540; +CY3
       LDX N540; STB DRQ,5; STB RQ2A,5; STB RQ2,5  BEGINNING OF DISC QUE
       LDX =27; JMPM H; +R540; +CY3
       LDX N540; STB DRQU,5    END OF DISC QUE AND PLACE WHERE KEY IS.
       LLRL 4; DAR; JAP CY1A; JBZ CY1A (GO TO CY1A IF INVALID DRQU)
       LDA DRQU,5; SUB DRQ,5; TZB; LLRL 7
       DAR; +JAPBZ; +CY2
CY1A   DEC ,X; JMP CY3    BAD KEY

CY2    LDX N540; LDX DRQU,5; JMPM H; +R540; +CY1A
       ERA B540; DEC AB,X;:  (X=0 IF R540 DELIVERED 00200001);
       LDB N540; LDA UP540,6; ANA NGN
       +JANXZ; 3*; JMP CY3   (NO NEED TO SET NGN); 
*      A GOOD KEY READ WAS MADE FROM A DOWN 540 AND NGN (NOT GOOD N540)
*      HAS NEVER BEEN SET. SET IT IF THE OTHER 540 IS UP. SET TO 0 OR 1
*      IF WHAT LOOKS LIKE 2 540S IS REALLY ONE BECAUSE THE MIC IS
*      IGNORING THE 540 BIT. OR SET IT TO 2 IF THERE REALLY ARE 2 540S.
*      OR, LEAVE IT NEGATIVE AND FIGURE IT OUT LATER WHEN ONE 940 IS UP
*      AND AN APPARENT SECOND 540 IS TRYING TO COME UP.

       LDA N540; ERA =1; STA W2; TAB; LDA UP540,6; IAR
       JAN CY3   (OTHER 940 IS DOWN. DON'T COMPUTE NGN);
       LDX =200; JMPM H; +R540; +CY3; STB W3  HOST NUM FOR UPCOMING HOST
       LDA W2; STA N540; JMPM H; +R540; +CY3   NUMBER OF RUNNING HOST
       TBA; ERA W3   A=0 IF UPCOMING AND RUNNING HOST HAVE SAME NUM
       LDB W1; JAZ 4*; TZX; LDB =2
       STB NGN  0 OR 1 IF UPCOMING HOST A FAKE. 2 IF 2 LEGITIMATE HOSTS.
CY3    E *     X=0 IF KEY READ WAS GOOD.
       LDB W1; STB N540
       LDA UP540,6; IAR; ASRA 1 (-2 TO -1, -1 TO 0, 0 TO 0)
       XXZ STAUP6; JXZ 4*; JAPM CRASHH (940 DIDNT MAINTAIN KEY);
       LDA =5120 (8 SECONDS AT 330 TICKS PER SEC)
       JXZ 3*; LDA =41 (1/10 OF A SEC); ADD TIMEL; STA TIM540,6
       JXZ 4*; JMP CY4
       LDX DRQU,6; LDB =123456; JMPM H; +W540; +1*
CY4    LDA N540; ERA =1; TAB; ERA UPN540; JAZ DMS1; JMP CY1

*              DDT ****************************************************************************
*      BEGINNING OF GENERAL STRING PROCESSING SUBROUTINES **************
* (AV,AC,FULTYP AND OTHER STRING ROUTINES ARE TIED TO DDT CONVENTIONS)

WSI    E *
       STA WSA; STB WSB
       TBA; JAN LI; SUB =21; JAP LI    CHECK BIT COUNT
       LDA 1,5; ADD WSB; LRLA 4; JAN LI  STRING TOO LONG
       TZA; JMPM H; +ABP    FIND CURRENT END OF STR
       LSRA 14; ADD WSB; ADD WS9A; STA WS9    SHIFTS END OF STR
       COM A,A; ADD =41; ANA =37; ADD WS9A; STA WS8  UNSHIFTS END OF STR
       LDA WSB; ANA =17; ADD WS7A; STA WS7; COM ,A
       XEC WS7; STA WS6      CREATE MASK TO INSERT WSA IN STR
       LDB JAB9,7; LDA JAB8,7  LOAD WORD AT END OF STR AND THE NEXT WORD
       XEC WS9   POSITION TO INSERT CHR AT RIGHT HAND PART OF A
       STA WS5; ERA WSA; ANA WS6; ERA WS5   INSERT CHR
       XEC WS8     UNDO WS9 SHIFT
       STB JAB9,7; STA JAB8,7
       LDA 1,5; ADD WSB; STA 1,5
       JMP L1
WS9A   LLRL 0
WS7A   LSRA 0

GSI    E *   B =BIT COUNT,X=STR PAIR POINTER
       STB GSB; TBA
       JAN LI; SUB =21; JAP LI
       ADD GS9A; STA GS9     SHIFT FACTOR TO GET BITS FROM STR
       LDA 1,5; LSRA 14; ORA GS8A; STA GS8   SHIFT FAC TO POSITION STR
       LDB 0,5; LDA 1,6; LDB 0,6   PICK UP STR WORD AND STR WORD + 1
       XEC GS8    LEFT ADJUST CHR IN B 
       TZA; XEC GS9; STA GS7     PICK UP CHR
       LDA 1,5
XTZB   TZB; SUB GSB     DECR STR LENGTH
       LLRL 4; JAN LI      ERROR, STR TOO SHORT
       LLRL 20; ADD GSB       INCR BEGINNING OF STR
       LLSR 4      B=UPDATED SECOND WORD OF STR PAIR. A = 0 OR 1
       ADD 0,5; STA 0,5; STB 1,5
       LDA GS7; JMP L1
GS9A   LLRL 21
GS8A   LLRL 0

GSI8   E *     GET 8 BIT CHR FROM STR
       LDB =10; JMPM H; +GSI; +LI
       JMP L1

WSI8   E *     PUT 8 BIT CHR ON END OF STR
       LDB =10; JMPM H; +WSI; +PF
       JMP L

AS     E *     APPEND STR B TO STR X
       STX ASX; STB ASB
       LDA 0,6; STA AS9; LDA 1,6; STA AS9+1
AS1    LDA AS9+1; ANA =3777; JAZ L
       TAB; ANA =-20; JAZ *+3; LDB =20; STB AS8
       LDX YAS9; JMPM H; +GSI; +PF    GET UP TO 20 BITS
       LDX ASX; LDB AS8; JMPM H; +WSI; +PF
       JMP AS1
YAS9   +AS9


ABP    E *     ADD A REGISTOR TO BIT POINTER SPECIFIED IN X.CLOBBER A,B)
*      STORE RESULTANT BIT POINTER PAIR IN JAB9,JAB9+1
       STA ABA
       LDA 1,5; ANA =3777; STA JAB8    LENGTH OF STR
       LDA 0,5; LDB 1,5; LLRL 4   POSITION TO ADD BIT ADRS TO LENGTH+ABA
       ROF; ADD JAB8; ADD ABA; XOF AB1  COMPUTE BIT POINTER OF END OF STR
       LLRL 14; ANA =170000; STA JAB9+1; STB JAB9
AB1    STB JAB8; INR JAB8
       JMP L


SSE    E *     SKIP IF STR EQUAL. COMPARE STR B AGAINST STR X
       STB SSB; STX SSX
       LDA 1,5; ERA 1,6; ANA =3777; DAR
       JAP LI   (UNEQUAL STR LENGTHS);
       LDA 0,5; STA SS9; LDA 1,5; STA SS9+1
       LDA 0,6; STA SS8; LDA 1,6; STA SS8+1
SS3    LDA SS9+1; ANA =3777; JAZ L1   (NO NON-COMPARING BITS IN STRS);
       TAB; SUB =20; JAN *+3; LDB =20; STB SS7
       LDX YSS9; JMPM H; +GSI; +SS4
       STA SS6
       LDX YSS8; LDB SS7; JMPM H; +GSI; +SS4
       ERA SS6; JAZ SS3
SS4    LDB SSB; LDX SSX; JMP LI
YSS9   +SS9
YSS8   +SS8

SYG    E *     ADD SYMBOL THAT CORRESPONDS TO VALUE A TO STRING X
       STA W1; LDA 1,5; STA W7; LDB =ST; LDA =77777; STA W2
       LDA SRV; JAZ SG1   (SEMIR MODE. USE SYMBOL TABLE);
       LDB =EST-3    (SEMIV MODE. DON'T USE SYMBOL TABLE)
       LDA 2,6; ADD =40; STA W1   (THIS IS CLOSE TO SYMBOL ZZZZZZ, BUT
:                                      NOT CLOSE ENOUGH TO TYPE OUT
SG1    LDA 0,6; JAP 4*; STA W3; IBR
       LDA W1; SUB 1,6; JAN SG2; SUB W2; JAP SG2
       ADD W2; STA W2   (DIFFERNCE FROM W1 VALUE);
       LDA W3; STA W5; LDA 0,6; STA W6
       LDAI .SG5-1; STA W8
SG2    IBR; INC B,AB; SUB =EST; JAN SG1
XIBR   E SG2
       STA WSB     A=0
       LDA W5; LDB W6; ANA =77777; LRLB 1; LLSR 1
SG3    STA W4; ANA =777; LLRL 5; STA W5; STB W6
       LDA W4; LSRA 11; LDB WSB; +JAZBZ; +SG4
       SUB =6; JAN 3*; ADD =13; ADD =266
       JMPM H; +WSI8
SG4    LDA W5; LDB W6; INR W8; JMP .W8
SG5    +SG3; +SG3; +SG3; +SG3; +SG3; 1*
       LDA W7; LDB 1,5; STA 1,5; LDA W2; JMP L

VAG    E *
       LDA 0,5; STA W1; STA W3; LDA 1,5; STA W2; STA W4
       ANA =3777; SUB =10; JAN LI; SUB =51; JAP LI
       LDX =W3; JMPM H; +GSI8; +PF
       ERA =256  (PERIOD); TAB; LDA JDOT; JBZ L1
       COP ,AB; LDX =W1
VG1    STA W4; STB W3; JMPM H; +GSI8; +VG3
       ANA =177; SUB =60; JAN LI
       SUB =6; JAN VG2; SUB =13; JAN LI
       SUB =32; JAP LI; ADD =32
VG2    ADD =6; ORA W4; LDB W3; LLRL 5; JMP VG1
VG3    LDA W4; LDB W3; LLRL 14; LSRB 1; STA W3; STB W4
       LDX =ST-3
VG4    IXR
VG5    IXR; INC X,AX; SUB =EST; JAP LI
       LDA 0,5; JAP VG5
       ANA =77777; ERA W3; DAR; JAP VG4
VG6    LDA 1,5; JAN LI
       ERA W4; JAZ VG7
       IXR; INC X,AX; SUB =EST; JAN VG6; JMP LI
VG7    LDA 2,5; JMP L1

SIC    E *     CONVERT NUMERIC STR TO BINARY VALUE
       LDA 0,5; STA SC9; LDA 1,5; STA SC9+1
       LDA =BLA+CAR+LIN+PLU+MIN+NUM; STA SCMASK
       LDA SC8A; STA SC8; TZA; STA SCTOT
SC1    LDX YSC9; JMPM H; +GSI8; +SC3
       JMPM H; +DC; ANA SCMASK; JAZ LI
       ANA =BLA+CAR+LIN+PLU+MIN; JAZ SC2
       ANA =MIN; LDB SC8B; JAZ SC1; STB SC8; JMP SC1
SC2    LDA =NUM; STA SCMASK
       LDA DCA; SUB =260+10; JAP LI
       ADD =10; JAN LI
       LLSR 3; LDA SCTOT; LLRL 3; STA SCTOT
       JMP SC1
SC3    TZA; LDB YSCTOT; XEC SC8
       JMP L1
YSC9   +SC9
SC8A   ADD 0,6
SC8B   SUB 0,6
YSCTOT +SCTOT

ISC    E *     CONVERT A AND APPEND TO STR X
       STA ICA; STX ICX; JAZ IC3 OUTPUT A ZERO;
*      OUTPUT SIGN CHR IF LAST CHR IN STR ICX IS ALPHANUMERIC OR
*      IF [ISCSW IS SET AND ICA IS NEGATIVE]
       LDA ISCSW; ANA ICA; LDB =77777; STB ISCSW; JAN IC0
*      IS LAST CHR IN STR ALPHA OR NUMERIC
       LDA 1,5; LLSR 14; LSRB 7; JBZ IC1 (NO, STR LESS THAN 8 BITS);
       SUB =10    COMPUTE ADRS OF END OF STR MINUS ONE CHR
       ADD 1,5; ANA =7777; LLSR 4; ADD 0,5; LLRL 20 (WRD ADR OF LST CHR);
       LDB 0,6; JAP 3*; LRLB 10; LLRL 10; ANA =377
       JMPM H; +DC; ANA =ALP+NUM; JAZ IC1  (JMP IF NOT ALPHANUMERIC);
IC0    TZA; SUB ICA; LDB =253 (PLUS SIGN);
       JAN 4*; STA ICA; LDB =255 (MINUS SIGN);
       TBA; JMPM H; +WSI8
IC1    LDA ICA; LLSR 2; STA ICA; STB ICA+1
       LDA =-6; STA IC9; TZA; STA WSB
IC2    INR IC9
       LDA ICA; LDB ICA+1; LLSR 15; STB ICA
       LDB WSB; 1030 JUMP IF AB=0,TEST FOR LEADING ZERO; +IC4
IC3    LDX ICX; ADD =260; JMPM H; +WSI8; INR WSB
IC4    LDA IC9; JAN IC2
       JMP L1

RS     E *     READ CHR AND APPEND TO STR X.TERMINATOR MASK IN B
       STB RSB; TZA; STA RSMASK
RS1    LDAI *; JMP CI; STA RS9
       JMPM H; +DC
       ORA RSMASK; STA RSMASK; ANA RSB; TAB   B=0 IF NOT END OF STRING
       LDA 1,5; ANA =3777; SUB =360; +JANBZ; +RS2
       JMP L     END OF STRING OR STRING GETTING TOO LONG
RS2    LDA RS9; JMPM H; +WSI8; JMP RS1

WS     E *     WRITE STRING X
       LDA 0,5; STA WS9; LDA 1,5; STA WS9+1
WS1    LDX =WS9; JMPM H; +GSI8; +L
       TAX; LDAI *; JMP CO; JMP WS1

ROC    E *     READ OCTAL NUMBER FROM TTY TO BINARY VALUE IN A AND W1
       TZB
ROC1   LDAI *; JMP CI
       SUB =215; JAZ ROC2; SUB =270-215; JAP LI; ADD =10; JAN LI
       LRLB 3; COP AB,B; JMP ROC1
ROC2   TBA; JMP L1

*      END OF GENERAL STRING PROCESSING SUBROUTINES ***********************

*      *********** DDT CODE   *****************************************
*              DDT EXECUTION STARTS FROM ACT. SEE TL TABLE FOR START ADRS.


ESCAPE JMPM EIR;:              USER TYPED A CONTROL S.
       LDA BOP1; STA BOP2
       LDB ESCSW; TZA; STA ECHO; DEC ,A; STA ESCSW
ES1    LDA BIP2; SUB BIP1; JAP ES2
       LDAI *; JMP CI; ERA =223 (CONTROL S); DAR; JAP ES1
ES2    DEC B,AB; JAP ES1; INR ECHO

RST    JMPM H; +CRTYP
RST1   TZX; STX OPEN
RST2   TZX; STX VALC
CR     E *                                    COMMAND RECOGNITION
       LDA =.EPDS-1; STA HPTR
       LDA LOK; JAP 7*; LDX AL; STX LOK; JMPM H; +GIVEL
       LDB =CSTR; LDX =CSTR+2; STX 0,6; TZX; STX 1,6
CR1    E *
       LDAI *; JMP CI
       JMPM H; +DC
       ANA =COM+CAR+LIN+BLA+MIN+PLU+PER+ALP+NUM; JAZ QUES
       ANA =COM+CAR+LIN; JAZ CR2
       LDA DCA; LDX =CT0; JMPM H; +CMLOOK; +QUES
       LDX =CSTR; LDA 1,5; JAZ CR3 (NO ARGUMENTS.LEAVE JVAL ALONE);
       JMPM H; +EVAL; +QUES; STA JVAL
CR3    LDA JVAL; LDB JCL9,7; LSRB 10; STB VALB
       JMP JCL91.      GO TO DDT COMMAND
CR2    INR VALC
       LDA DCA; LDX =CSTR; JMPM H; +WSI8
       JMP CR1

*      LOW LEVEL DDT ROUTINES
CMLOOK E *     LOOK FOR A COMMAND
       STA CLA
CL1    LDA 0,5; JAZ LI (END OF COMMAND TABLE)
       ANA =377; ERA CLA; JAZ CL2
       TXA; ADD =4; TAX; JMP CL1
CL2    STX JCL9; LDA VALC
       JAZ *+3
XIXR   IXR; XAN XIXR
       LDA 1,5; ANA =MSIZE-1; STA JCL91  (DISPATCH ADRS);
       LDA TIMEH; SUB PWTIME; SUB =3
       JAP 6*  (JMP IF LACKING STATUS); LDA TIMEH; STA PWTIME; JMP L1
       LDA 1,5; JAP L1   (COMMAND DOESN'T REQUIRE STATUS);
CL3    JMPM MS; +CRLF; ASC 'SET STATUS/'; JMP RST

EVAL   E *     
       TZA; STA EVTOT; STA EVSIGN
       LDA 0,5; STA EV9; LDA 1,5; STA EV9+1
EV1    TZA; STA EVFLG
       LDA EV9; STA SUBSTR; LDA EV9+1; ANA =170000; STA SUBSTR+1
EV2    LDX YEV9; JMPM H; +GSI8; +EV3
       JMPM H; +DC;   ORA EVFLG; STA EVFLG
       LDA DC9; ANA =ALP+NUM+PER+BLA+PLU+MIN; JAZ LI (BAD CHR);
       ANA =ALP+NUM+PER; JAZ EV3   (END OF SUBSTRING);
       LDA SUBSTR+1; ADD =10; STA SUBSTR+1 (APPEND TO SUBSTR); JMP EV2
EV3    LDA EVFLG; ANA =ALP+PER
       LDB EV8A; JAZ *+3; LDB EV8B; STB JT
       LDA EVSIGN; ANA =MIN; STA EV7; LDA DC9; STA EVSIGN
       LDX YSUBST; JMPM H; +.JT; +LI
       LDB EV7; JBZ *+4; COM A,A; IAR; ADD EVTOT; STA EVTOT
       LDA EV9+1; ANA =3777; TAB; LDA EVTOT
       JBZ L1; JMP EV1
YSUBST +SUBSTR
YEV9   +EV9
EV8A   +SIC
EV8B   +VAG

TEMP2  LDX YTEMP2; STX TEMP; TZX; STX TEMP+1; LDX =TEMP; JMP L
YTEMP2 2+TEMP

CRTYP  LDX =215 (CAR RET); LDAI *; JMP CO
       LDX =212 (LIN FEED; LDAI *; JMP CO
       JMP L

BL3   E *     APPEND 3 BLANKS TO THE STR IN X
       LDB YBL9; JMPM H; +AS; JMP L
YBL9   1+*; 2+*; 30; 120000+240 (2 BLANKS); 120000 (A BLANK)

AV     E *     APPEND VALUE A IN MODE B TO STRING X
       STA AVB; TBA; ADD AVDISP; STA T1; LDA AVB; JMP .T1
AVDISP 1.*; +AV0; +AV1; +AV2; +AV3
AV1    INR ISCSW               OUTPUT SIGNED INTEGER
AV0    LDA AVB                  OUTPUT OCTAL
AV0A   JMPM H; +ISC; +PF; JMP L
AV2    LSRA 6; JAZ AV0; LDA AVB
       JMPM H; +SYG; SUB =40; JAP AV0
       STB 1,5; ADD =40; JAZ L; JMP AV0A
AV3    LDB =20; JMPM H; +WSI; +PF; JMP L

AC     E *     APPEND CELL POINTED TO BY A IN MODE B TO STRING X
       STA ACP; STB ACB; LDA ACP,7
       DBR; DBR; LSRA 6; DAR; ANA =100000; COP AB,B; LDA ACP,7
       JBZ AC2   OUTPUT SYMBOLIC IF ACB=2 AND VALUE NOT TOO SMALL
       LDB ACB; JMPM H; +AV; JMP L
AC2    JMPM H; +SYG; JAZ AC2E
       LDA ACP,7; ANA =170000; JAZ AC2A
       JMPM H; +SYG; JAZ AC2B
AC2A   LDA ACP,7; LDB =2; JMPM H; +AV; JMP L
AC2B   STB 1,5; LDA =240; JMPM H; +WSI8
       LDA ACP,7; LRLA 4; JAN AC2D
       LLSR 12; JAZ 11*; LLRL 6; JMPM H; +SYG; SUB =40; JAN AC2C
       LDA ACP,7; ANA =3777; TZB; JMPM H; +AV; JMP L
AC2C   STB 1,5; ADD =40; JAZ L; INC ,B; JMPM H; +AV; JMP L
AC2D   LDA ACP,7; ANA =777; LDB ACB; JMPM H; +AV
       LDA ACP,7; LRLA 7; ANA =7; ADD =126000+260 (,4 OR ,5 OR ,6 OR ,7);
       LDB =20; JMPM H; +WSI; +PF; JMP L
AC2E   STB 1,5; JMP L

TYP540 JMPM H; +TEMP2
T540A  JMPM H; +BL3
       LDA M540; ANA =1; STA N540; TZA; STA W3
       LDX KDOT; JMPM H; +R540; +QUES; LLRL 40-5
T540B  STA W1; STB W2; ANA =7; ADD =260  (ONE OF 8 OCTALS TO OUTPUT);
       LDX =TEMP; JMPM H; +WSI8
       INR W3; LDA W3; ANA =10; TAX
       LDA W1; LDB W2; LLRL 3; JXZ T540B
       LDX =TEMP; JMPM H; +WS; JMP L

FULTYP E *     LABEL AND TYPE THE MEMORY CELL POINTED TO BY A IN MODE B
       STA FUA; STB FUB
       JMPM H; +TEMP2
       LDA FUA; SUB =100; JAN FU1
       LDA FUA; JMPM H; +SYG; SUB =40; JAP FU1
       STB 1,5; ADD =40; JAZ FU3
       INC ,B; JMP FU2
FU1    LDA FUA; TZB
FU2    JMPM H; +ISC; +PF
FU3    LDA FUB; ADDI FU4; TAB; LDA 0,6  ([,$,], OR ");
       JMPM H; +WSI8; JMPM H; +BL3
       LDA FUA; LDB FUB; JMPM H; +AC
       JMPM H; +BL3; JMPM H; +WS
       JMP L
FU4    333  [; 244   ]; 335   ]   ; 242   "

ARG2   E *     TAKE AN EXPRESSION SEPERATED BY A COMMA AND MAKE ONE VALUE
*      IE, LDA 0,5 IS 15000   OR   LDX 2,7 IS 37002
       LDA JVAL; SUB =10; JAP QUES; ADD =4; JAN QUES (4,5,6 OR 7 IS LEGAL);
       LDA JVAL1; ANA =7000; DAR; JAP QUES
       LDA JVAL; LRLA 11; ORA JVAL1; STA JVAL; JMP L

PF     JMPM CRASHV  PROGRAM FAILURE. LI RETURN THAT SHOULD HAVE BEEN L1.

GPW    COP AX  GENERATE A PASSWORD IN PW5 AND PW5+1
       COM ,A; STA PW5; STA PW5+1
       LDX GPWM; JMPM H; +WS
GPW1   TZA; STA ECHO; LDAI *; JMP CI; INR ECHO
       SUB =215  (CAR. RET.); JAZ L  
       ERA PW5; LDB PW5+1; LLRL 11; SUB PW5
       ADD CICHR; LLRL 14; SUB CICHR
       ERA PW5+1
       STA PW5; STB PW5+1; JMP GPW1
GPWM   +1*; +2*; +220; +CRLF; ASC 'ENTER PASSWORD'; +CRLF

STAPWT STA PWTIME
STAT   COP AX  RESET STATUS IF ARG = 0. OTHERWISE, SET STATUS.
       LDB JVAL1; LDA TIMEH; SUB =3; XBZ STAPWT; JBZ RST
VPW    E *     VALIDATE PASSWORD
       JMPM H; +GPW
       LDX =PWT-1
VPW1   IXR; LDA 0,5; JAZ QUES (JMP IF NOT IN PASSWORD TABLE)
       ERA PW5; TAB; LDA PWU-PWT,5; ERA PW5+1
       1030  (JAZ JBZ); 3*    (JMP IF VALID PASSWORD); JMP VPW1
       LDX TIMEH; STX PWTIME
TYPEOK JMPM MS; ASC '$OK/'; JMP RST

PWT    E *     PWT CONTAINS THE 1ST 16 BITS OF 32 BIT CIPHERS
       34546                   DAVID GARDNER
       320                     PAT MISONER
       54734                   GUY BLOOD
       43062                   NORM HARDY
       37722                   ANN HARDY
       0
PWU    E *     SECOND HALF OF CIPHER
       17024                   DAVID GARDNER
       47004                   PAT MISONER
       163067                  GUY BLOOD
       5121                    NORM HARDY
       125354                  ANN HARDY
       0       


*      DDT COMMANDS

QUES   E *     QUESTION MARK
       LDX YQS9; JMPM H; +WS
       LDX OPEN; JXZ RST; JMP RST2
YQS9   1+*; 2+*; 30; ASC ' ? '

SETCM  E *     SEMICOLON OR PERCENT COMMAND. LOOK UP COMMAND.
       LDAI *; JMP CI
       LDX VALB; LDX YCT,5; JMPM H; +CMLOOK; +QUES
       LDA JVAL; LDB JCL9,7; LSRB 10; JMP .JCL91

CMA    STA JVAL1; LDA =100000; STA VALC; JMP CR

*      TYPE OUT A 940 CELL. IF 2 ARGUMENTS, ALSO SET M540.
SSLSH2 LDX JVAL1; STX M540
SSLSH1 STA KDOT
SSLSHA JMPM H; +TYP540; JMP RST

PS1    STA JVAL1 ENTER HERE TO STORE A CELL.(SIGN BIT OFF ON THIS INSTR.)
PW     SUB =0    940 WORD SEARCH COMMAND. (SIGN BIT OF THIS INSTR. ON).
PS2    JMPM MS  SIGN BIT OFF ON THIS INSTR.
       ASC ' OCTAL /'; TZA; STA OUT540; STA OUT540+1
PSA    LDAI *; JMP CI; ERA =215; JAZ PSB (OCTAL FULLY ENTERED);
       LDA OUT540+1; LDB OUT540; LLRL 3; ERA CICHR; ANA =-10; ERA CICHR
       STA OUT540+1; STB OUT540; JMP PSA
PSB    JMPM H; +MAYDMS; LDA M540; STA N540; LDX JVAL1
       LDA JCL91,7; JAN PSD (WORD SEARCH COMMAND);
       LDA OUT540; LDB OUT540+1; JMPM H; +W540; +QUES
       JMPM H; +PSR; +QUES
PSC    LDA JVAL1; ERA JVAL; JAZ RST; INR JVAL1; JMP PSB
PSD    JMPM H; +PSR; +PSC (NO COMPARE. DON'T TYPE OUT ADRS);
       JMPM H; +TEMP2; LDA JVAL1; JMPM H; +ISC; +PF; JMPM H; +WS
       JMPM H; +CRTYP; JMP PSC    940 ADDRESS IS TYPING
PSR    E *     READ 940 AND CHECK AGAINST OUT540,OUT540+1
       JMPM H; +R540; +QUES
       ERA OUT540; ANA =377; LLRL 20; ERA OUT540+1
       +JAZBZ; +L1; JMP LI

SLF0   E *     SEMI LINE FEED COMMAND. TYPE OUT THE NEXT 540 CELL.
       INR KDOT; LDA KDOT; STA JVAL1; STA JVAL
SLF2   E *     TYPE OUT A RANGE OF 540 CELLS FROM JVAL1 TO JVAL
       JMPM H; +TEMP2
       LDA JVAL1; STA KDOT; JMPM H; +ISC; +PF
       LDA =333 [LEFT BRACKET); JMPM H; +WSI8
       JMPM H; +T540A; JMPM H; +CRTYP
       LDA JVAL; ERA JVAL1; INR JVAL1; JAZ RST1; JMP SLF2

SLASH0 LDB TMODE; STB VALB; JMP LOOK0
SLASH1 LDB TMODE; STB VALB; JMP LOOK1
SLASH2 LDB TMODE; STB VALB; JMP LOOK2

LOOK0  LDX ACP; LDX 0,5; JMP LOOK1A
LOOK1  STB VALB1; INR OPEN; STA JDOT; TAX
LOOK1A LDA 0,5; JMP EQ1
LOOK2  E *     LIST COMMAND. A,B/ OR X,Y[ OR 2,50] OR 3,4$ OR DM,DM+7"
       ANA =MSIZE-1; STA JDOT; LDA JVAL1; ANA =MSIZE-1; STA JVAL1
       SUB JDOT; JAP QUES
L2A    LDA JDOT; SUB JVAL1; JAN RST
       JMPM H; +CRTYP
       LDA JVAL1; LDB VALB; JMPM H; +FULTYP; INR JVAL1
       JMP L2A

EQ2    JMPM H; +ARG2
EQ1    STA EQ9; LDA =EQ9; STA ACP
EQ0    JMPM H; +TEMP2; JMPM H; +BL3
       LDA ACP; LDB VALB; JMPM H; +AC
       JMPM H; +BL3; JMPM H; +WS
       JMP RST2

CRET2  JMPM H; +ARG2
CRET1  LDB OPEN; JBZ RST1; STA JDOT,7; INR KC1; JMP RST1

*      LINE FEED CMD (B=2) OR UP ARROW (B=0)
LF2    JMPM H; +ARG2
LF1    LDX OPEN; JXZ *+4; STA JDOT,7; INR KC1
LF0    DEC B,A; ADD JDOT; STA JDOT
       LDX =215; LDAI *; JMP CO
       LDX =212; LDAI *; JBZ CO
       INR OPEN; LDB VALB1
       LDA JDOT; JMPM H; +FULTYP; JMP RST2

SZ0    TZA     STORE ZEROS FROM SEMI1 TO SEMI2
SZ1    STA JVAL1; IBR      STORE ARGUMENT FROM SEMI1 TO SEMI2
SZ2    E *     SUBSTITUTE JVAL1 FOR OCCURANCES OF JVAL IF 2 ARGUMENTS.
       LDX SEMI1               B=1 IF 0 OR 1 ARG. B=0 IF 2 ARGS.
SZ2A   COM X,A; IAR; ADD SEMI2 (A=SEMI2-X); JAN RST
       LDA 0,5; ERA JVAL; JAZ 4*; JBZ 4*; LDA JVAL1; STA 0,5; IXR
       LDA 21,7; ANA 41,7; ANA 43,7; JAN SZ2A
       LDAI SZ2A; JMP DMS

SEMIW2 JMPM H; +ARG2
SEMIW  STB SW8 (SW8 DIFERRENTIATES WORD SEARCH FROM NOT WORD SEARCH)
       LDA SEMI1; STA SW9
SW2    LDB SW9; LDA 0,6; ERA JVAL; ANA SEMIM
       LDB SW8; XAZ XIBR; LLRL 40-1; JAP SW4
       LDBI SW5
SW2A   LDA SW9; ERA 0,6; JAZ SW4; INC B,AB; SUBI SW5A; JAN SW2A
       JMPM H; +CRTYP
       LDA SW9; STA JDOT; LDB TMODE; JMPM H; +FULTYP
SW4    LDA SW9; INR SW9; SUB SEMI2; JAN SW2
       JMPM H; +CRTYP; JMP RST
SW5    +EQ9; +JVAL; +W1; +SCTOT; +EVTOT
SW5A   E *
STMODE STB TMODE; JMP RST

SE0    E *     SET JVAL = SEMIA OR SEMIB OR SEMIX ETC.
       INR VALC; LDA SEMIA,6; STA JVAL; JMP CR
SE2    JMPM H; +ARG2
SE1    STA SEMIA,6; JMP RST

SEMIL  STA SEMI2; LDA JVAL1; STA SEMI1; JMP RST

SEMIRV E *     SEMIR AND SEMIV COMMANDS. SEMIV TURNS OF SYMBOL TABLE.
       STB SRV; JMP RST        SEMIR TURNS ON SYMBOL TABLE.

SEMIG  ANA =MSIZE-1; STA JVAL
       JMPM H; +CRTYP
       LDA JVAL,7; ERA VERS CMDS THAT BEGIN WITH COP AX DONT NEED STATUS
  JAZ 11*; LDA TIMEH; SUB =3; SUB PWTIME; JAP CL3; LDA TIMEH; STA PWTIME
       LDA SEMIA; LDB SEMIB; LDX SEMIX; JMPM H; +.JVAL
       STA SEMIA; STB SEMIB; STX SEMIX; JMP RST

VSTR   2*; 320; +CRLF; +CRLF; ASC 'DIM 06-20-77, VERSION '
VNUM   14      OCTAL VERSION NUMBER. KEEP ABOVE ASC AT SAME LENGTH.
VERS   E *     OPER COMMAND TO TYP THE DIM VERSION NUMBER 
       COP AX    FIRST INSTRUCTION OF AN OPERATOR COMMAND
       LDXI VSTR; JMPM H; +WS
       JMPM H; +TEMP2; LDA VNUM7,7; JMPM H; +ISC; +PF
       JMPM H; +WS; JMP RST

WP     COP AX  WRITE PROTECT THE DISC. SET WP1 NOT = 0.
       DEC ,A; JMP WE1
WE     COP AX; TZA             WRITE ENABLE THE DISC. SET WP1=0.
WE1    STA WP1; JMP RST

       COP AX  UP-1 CALLED BY OPERATOR TO INHIBIT CRASHSAVE
UP     COP AX;:    UP COMMAND
       LDA WP1; JAZ 15*; JMPM MS; ASC 'WRITE PROTECT/'; JMP QUES
       STA UPH; STA UPER
       LDXI UPMS1; JMPM H; +WS
       LDB =-4
UP1    E *     READ THE DECIMAL HOST NUMBER
       LDAI *; JMP CI
       SUB =215; JAZ UP2; SUB =260-215; JAN QUES; SUB =12; JAP QUES
       LDA UPH; LRLA 3; ADD UPH; ADD UPH; ADD CICHR; SUB =260; STA UPH
       INC B,AB; JAN UP1; JMP QUES
UP2    E *     READ AND CHECK THE SYSTEM NUMBER
       LDXI UPMS2; JMPM H; +WS
       JMPM H; +ROC; +QUES; STA UPL; LDXI UPMS3; JAN UPX
       LDA TIMEH; SUB PWTIME; SUB =3; LDB =37; JAN 3*; LSRB 1
       DEC B,A; SUB UPL; JAN UPX
       JMPM H; +GLOK   LOCK THE DISC FOR UP COMMAND
       DEC ,B
UP3    E *     READ HOST NUMBERS FROM PACK 0 AND PACK 10
       INC B,AB; STA N540
       ERA NGN; JAZ UP3A
       LDA N540; LRLA 3; STA PAC,5
       LDA =4; STA CH,5; TZA; STA REC,5
       LDB =DBF; STA 133,6; STA 134,6; STB CA,5
       LDA =20; STA FLG,5
       LDA =2; STA CC,5
       JMPM H; +IODMS
       LDA FLG,5; ORA UPER; STA UPER
       LDB =DBF
       LDA 133,6; LDB 134,6; LLRL 4; ANA =7777; ERA UPH; JAZ UP4
       LDB N540
UP3A   JBZ UP3; LDA UPER; JAN UPIOER; LDXI UPMS4; JMP UPX

UP4    E *     WRITE THE CRASH IF NECESSARY AND READ IN THE MONITOR
       STA UPER   RESET ERROR FLAG IF PROPER HOST FOUND
       LDB N540; LDA UP540,6; LDXI UPMS8; JAP UPX
       LDB =UPTAB; LDA UPL; STA 4,6; ADD =40001; STA 5,6
       LDA JVAL; SUB =UP; JAP 3*; LDB =UPTAB+4 (NO CRASHSAVE); STB UPP
UP4A   LDA UPP,7; JAZ UP4C
       ANA =37; LRLA 10    CONVERT LOC. NUMBER TO LOGICAL PAGE ADDRESS
:                              FOR THE BEGINNING OF THAT LOC.
       ADD =400-10    400 GOES TO BEGINNING OF NEXT LOC., SO 400-10 GOES
:                     TO THE END OF THIS LOC. MINUS 20 PAGES
       LDX AL; LDB N540; LRLB 3  (BASE PACK ADDRESS FOR THIS 540); DBR
:      THERE ARE 310 CYLINDERS PER PACK AND 24 HEADS PER CYL.
:  THERE ARE 310*24=7640 PAGES OR TRACKS PER PACK, COMPUTE PAC NUMBER IN B
       IBR; SUB =7640; JAP *-2; ADD =7640; STB PAC,5
       DEC ,B; IBR; SUB =24; JAP *-2; ADD =24; LRLB 10  CYL. IN B0-B7
       COP AB,A; STA CH,5   MERGE HEAD NUMBER AND STORE.
       LDA UPP,7; ANA =140000; STA CA,5; LDA =100; STA CC,5 (4000 WORDS);
       LDA UPP,7; ANA =100; LSRA 3; STA FLG,5  (SET READ OR WRITE BIT);
UP4B   LDA FLG,5; ANA =10; STA FLG,5
       JMPM H; +IODMS
       LDA =UPTAB+3; SUB UPP; ANA FLG,5; ORA UPER
       STA UPER  FLAG UPER IF ERROR ON LOADING MONITOR
       INC ,AB; ADD CH,5; ANA =377; SUB =24; JAN 3*; LDB =400-23
       TBA; ADD CH,5; STA CH,5   NEXT HEAD POSITION
       LDA CA,5; ADD =4000; STA CA,5; ANA =37777; DAR; JAP UP4B
       INR UPP; JMP UP4A

UP4C   LDB UPL;: A=0; LDX =2; JMPM H; +W540; +UP4D
       LDB UPH; LDX =200; JMPM H; +W540; +UP4D
       LDA N540; LRLA 7; LDB VNUM7,7; LDX =207; JMPM H; +W540; +UP4D
       LDA UPER; JAN UPIOER  (ERROR ON READ PART OF UPTAB COMMANDS)
       LDA N540; STA UPN540; LDXI UPMS5; JMP UPX
UP4D   LDXI UPMS7; JMP UPX

CPN    E *     CHECK FOR PAC NUMBER IN JVAL1
       LDA VALC; LDB JVAL1; LSRB 4; +JANBZ;
       +CPN1   (MAKE SURE HE SPECIFIED A 4 BIT PACK NUMBER).
CPN0   JMPM MS; ASC 'ER,SPECIFY PAC/'; JMP RST
CPN1   LDA UP540; ANA UP540+1; JAN L
CPN2   JMPM MS; ASC '940 UP/'; JMP RST

IODMS  LDA =PPIBR; STA PP,5
       TZB; LDAI *; JBZ DMS  (WAIT FOR PPIBR TO CHANGE B);
       LDA PAC,5; LSRA 3; STA N540; JMP L
PPIBR  LDX =TL; INR TLDDT-TL+1,5 (INCREMENT B TO ESCAPE A DDT DISMISS)
       JMP DM2                   LOOP WHEN THE I-O IS FINISHED)

UPIOER LDXI UPMS6
UPX    E *     EXIT FROM UP COMMAND.
       JMPM H; +WS    TYPE UP EXIT MESSAGE
       JMP RST

UPMS1  2*; 170; +CRLF; ASC 'HOST NUMBER? '
UPMS2  2*; 50; ASC 'LOC. '
UPMS3  2*; 310; ASC 'LOC. MUST BE LESS THAN 17'
UPMS4  2*; 170; ASC 'BAD HOST NUMBER'
UPMS5  2*; 140; 103607 (BELL,BLANK); ASC '940 LOADED'
UPMS6  2*; 50; ASC 'IO ER'
UPMS7  2*; 60; ASC 'MIC ER'
UPMS8  2*; 150; ASC 'ER,ALREADY UP'

RUN1   EXC 061; JMP RST
STOP   EXC 161; JMP RST
ONC    EXC 261; JMP RST
ONV    EXC 361; JMP RST
S1     EXC 461; JMP RST
S2     EXC 561; JMP RST
RESET  EXC 661; JMP RST
OFC    EXC 761; JMP RST
MRESET EXC 761; EXC 61; EXC 130; EXC 254; JMP RST

ERRORS COP AX  LIST ALL THE ERROR INFORMATION THAT HAS ACCUMULATED IN ET
       JMPM MS; ASC 'ERCT=/' ERROR COUNT
       JMPM H; +TEMP2   INITIALIZE A TYPE OUT STRING
       LDA ERCT; JMPM H; +ISC; +PF; JMPM H; +WS
       LDA =BET; STA PET7
E1     LDA PET7; SUB PET; JAP RST (NO MORE ERROR INFO TO TYPE);
       JMPM H; +TEMP2; LDA =CRLF; LDB =20; JMPM H; +WSI; +PF
       LDA =141640 (C FOR CYLINDER); LDB =20; JMPM H; +WSI; +PF
       LDA PET7,7; LSRA 10 (CYLINDER); JMPM H; +ISC; +PF
       JMPM H; +BL3
       LDA =144240 (H FOR HEAD); LDB =20; JMPM H; +WSI; +PF
       LDA PET7,7; ANA =37 (HEAD); JMPM H; +ISC; +PF
       JMPM H; +BL3
       LDA PET7,7; ANA =40 ZERO FOR READ, 40 FOR WRITE
       JAZ 3*; LDA =327-322 (W MINUS R); ADD =322 (R);
       JMPM H; +WSI8; JMPM H; +BL3
       JMPM H; +WS (TYPE OUT STRING); LDX =TEMP
       LDA PET7,7; INR PET7; ANA =100 (A=0 IF NO SENSE DATA); JAZ E3
       LDA =60; STA PET7+1
E2     LDX =PET7; INC ,B; JMPM H; +GSI; +E1; ORA =260
       TAX; LDAI *; JMP CO (TYPE A ZERO OR A ONE);
       LDA PET7+1; ANA =7; TAB; LDX =240; LDAI *; JBZ CO (TYPE BLANK);
       JMP E2
E3     JMPM MS; ASC 'CSW= /'; JMPM H; +TEMP2
       LDA PET7,7; INR PET7; JMPM H; +ISC; +PF; JMPM H; +WS
       JMP E1

RSTE   COP AX  (CLEAR ERROR BUFFER)
       TZA; STA ERCT; LDB =BET
STBPET STB PET; JMP RST

SNGN   COP AX   SET THE CELL NGN. SEE NGN COMMENTS IN CY2.
       LDA JVAL1; STA NGN; JMP RST

PC    COP AX PACK CPY.COPY PAC A, STARTING AT CYL B, HEAD X TO PACK JVAL1
       EXC 254    CLEAR THE DISC
       JMPM H; +CPN  MAKE SURE HE SPECIFIED A PACK TO WRITE ON
       LDA UP540; ANA UP540+1; JAN 12*; JMPM MS; ASC '940 UP/'; JMP RST
       JMPM H; +GLOK
       TZA; STA REC,5; LDA =DBF; STA CA,5; LDA =10; STA CC,5
PC1    LDA SEMIA; STA PAC,5
       LDA SEMIB; LRLA 10; ORA SEMIX; STA CH,5; LDA =20; STA FLG,5
       JMPM H; +PCIO
       LDA JVAL1; STA PAC,5; LDA =30; STA FLG,5
       JMPM H; +PCIO
       LDA REC,5; ADD =4; ANA =34; STA REC,5; DAR; JAP PC2
       INR SEMIX; LDA SEMIX; SUB =24; JAN PC2; STA SEMIX
       INR SEMIB; LDA SEMIB; SUB =310; JAN PC2; STA SEMIB
       INR SEMIA; INR JVAL1; INC ,A; ANA SEMIA; ANA JVAL1; JAZ TYPEOK
PC2    LDA ESCSW; JAN PC1; JMP RST

PCIO   JMPM H; +IODMS
       LDA FLG,5; JAP L; JMPM H; +TDI; JMP L

RB     JMPM H; +GLOK
       LDA JVAL1; STA PAC,5; LDA SEMIA; LRLA 10; ORA SEMIB; STA CH,5
       LDA SEMIX; STA REC,5; LDA =DBF; STA CA,5; LDA =10; STA CC,5
       LDA =20; STA FLG,5
       JMPM H; +IODMS
       JMP RST

RT     COP AX  READ TEST PACK. CHECK FOR VARIOUS ERRORS.
:      A17 IS 0 FOR 620 MEMORY ONLY READS. A16 IS 1 FOR ABBREVIATED
:      DIAGNOSTIC TYPE OUTS. A15 (000004) IS ON TO STOP RT AFTER ANY 
:                              TYPE OUTS.
       EXC 254   CLEAR THE DISC
       LDA VALC; JAP CPN0
       LDA JVAL1; LLSR 4; LSRB 17 (A=0,B=0 OR 1);
       STA RTC; ADD UP540,6; JAP CPN2
       JMPM H; +GLOK    GRAB THE DISC
RTA    E *     INITIALIZE FOR READ COMMAND ON LIST
       LDX AL; JMPM H; +RG; ANA =34; STA REC,5 (RANDOM RECORD);
       JMPM H; +RG; LSRA 1; LDB =24; JMPM H; +DV
       ERA CH,5; ANA =377; ERA CH,5
       STA CH,5     STORE NEW HEAD NUMBER
       LDA RTC; INR RTC; ANA =160000
       JAZ RTB   COMPUTE NEW CYL IF IN SEEK PHASE
       JMPM H; +RG; ANA =17; DAR; JAP RTD
RTB    JMPM H; +RG; ANA =77777; LDB =310; JMPM H; +DV  A= CYLINDER
       LDB CH,5; LRLB 10; LLSR 10
       STB CH,5   STORE A NEW CYLINDER VALUE
       JMPM H; +RG; ANA =1; ORA JVAL1; STA PAC,5
RTD    JMPM H; +RG; TAB; ANA SEMIA; ANA =1; ERA =3; LRLA 4
       STA FLG,5   (ERROR RETRY INHIBIT BIT AND POSSIBLY THE 940 BIT)
       JAZ 3*; LDB =DBF; STB CA,5 (RANDOM ADRS IF 940 MEMORY);
       LDA RG2; LSRA 15; ADD =RTE1; TAB
       LDA 0,6; LLSR 3; STA CC,5; TZA; LLRL 3; ADD REC,5; STA REC,5
       JMPM H; +IODMS
       LDA BOP2; SUB BOP1; JAN *-2   LET TTY OUTPUT TERMINATE
*      CHANGE JMP 12* BELOW TO JAZ 12* WHEN SKIP ON CHANNEL IS WORKING
       LDA SKBAD7,7; ERA =123456; JMP 12*; JMPM MS; ASC '$SKIP FAULT/';
       LDA 44; ERA =6200; JAZ 10*; JMPM MS; ASC '$IO ER/';
       LDX AL; LDA FLG,5; LRLA 13; JAN RTK (620 MEMORY);
       TZA; SUB CC,5; ASLA 4; STA T1; LDA =DBF; STA T2; LDX CA,5
RTG    E *     COPY 940 DATA TO DBF
       JMPM H; +R540; +RTGER; IXR; LLRL 10; STA T2,7; INR T2; STB T3
       JMPM H; +R540; +RTGER; IXR; ORA T3; STA T2,7; INR T2
       STB T2,7; INR T2; INR T1; LDA T1; JAN RTG
RTK    LDX AL; LDA REC,5; ANA =3; DAR; JAP RTK3
       LDB =DBF; LDA 1,6; LRLA 10; ADD 2,6; ERA CH,5
       LDB 3,6; LLRL 20; LSRA 6; SUB =4; ERA REC,5
       +JAZBZ; +RTK3  (CHECK CYL, HEAD, AND REC.);
RTK1   JMPM MS; ASC '$DATA INCORRECT/'; JMP RTR
RTGER  JMPM MS; ASC '$MIC ER/'; JMP RTR
RTK3   LDA REC,5; ANA =3; STA T1; ADD T1; ADD T1; LRLA 5 A=0,140,300,440
       SUB =DBF; STA T1
       COP ,AB; SUB CC,5; SUB CC,5; SUB CC,5; LLSR 14 (620 WORD COUNT);
       LDX =DBF
RTK4   TXA; ADD T1; ERA 0,5; JAZ RTK5
       TXA; SUB =DBF+4; JAP RTK1
RTK5   IXR; INC B,AB; JAN RTK4
RTR    LDA BOP2; SUB BOP1; JAP RTS
       LDA SEMIA; LRLA 16; JAP RTR1
       LDA =44; DEC ,B; JMPM H; +FT (SHORT ER TYPE OUT); JMP RTR2
RTR1   JMPM H; +TDI
RTR2   JMPM H; +CRTYP; LDA SEMIA; LRLA 15; JAN RST (ER STOP);
RTS    LDA ESCSW; JAN RTA; JMP RST
RTE1   100; 100; 100; 100; 61; 60; 23; 42

TDI    COP AX  TYPE DIAGNOSTIC INFORMATION (CHANNEL PROGRAM,14,44-51);
       LDA =14; DEC ,B; JMPM H; +FT
       LDA =44; LDB =-6; JMPM H; +FT
TD1    LDA 14; STA FT9   POINTER TO CHANNEL PROGRAM
TD2    LDA FT9,7; ERA =123456; JAZ TD3 (END OF CHANNEL PROG.);
       LDA FT9; LDB =-3; JMPM H; +FT (TYPE A 3 WORD CP ENTRY); JMP TD2
TD3    LDX 14; LDX 1,5; STX FT9    BEGINNING OF CP PARAMETERS
TD4    LDA FT9,7; ERA =123456; JAZ TD5
       LDA FT9; LDB =-10; JMPM H; +FT (TYPE SOME OF THE CP DATA; JMP TD4
TD5    LDA 44; ANA =UCK; JAZ L
       LDA 46; LSRA 10; ANA =17; JMPM H; +SNSIO
       LDA =SENBYT; LDB =-3; JMPM H; +FT; JMPM MS; ASC ' SENSE INFO/';
       JMP L

FT     E * FORMATTED TYPE OUT.TYPE STARTING AT ADRS A. B=NEGATIVE COUNT.
       STA FT9A (SEE XAZ FT); STA FT9; STB FT8
       JMPM H; +CRTYP; JMPM H; +TEMP2
       LDA FT9; INC ,B; JMPM H; +AV
FT1    LDA FT8; INR FT8; JAP FT2
FT1A   LDA FT9,7; ERA =123456; JAZ FT2
       LDA =120240; LDB =20; JMPM H; +WSI; +PF (2 BLANKS);
       LDA FT9; SUB FT9A; ERA =4; XAZ FT; JAZ FT1A
       LDA FT9,7; INR FT9; TZB; JMPM H; +AV; JMP FT1
FT2    JMPM H; +WS; JMP L

WT     COP AX  WRITE TEST PAC
       EXC 254   CLEAR THE DISC
       JMPM H; +CPN
WT1    E *     INITIALIZE DATA AND CHANNEL PROGRAM PARAMETERS
       LDX =DBF+600; LDB =577; DXR; STB 0,5; DEC B,AB; JAP *-3
       STB LOK  (B=-1,X=DBF)
       TZA; STA 1,5 (CYL); STA 2,5 (HEAD); LDA =400; STA 3,5 (REC);
       LDA =WTCP; STA 14; LDA JVAL1; JMPM H; +GIO

WT2    LDA ESCSW; JAP WT3 (TTY ESCAPE);
       LDA 43,7; JAP WT4 (CHANNEL INTERRUPT);
       JMPM H; +MBC; +WT2  (WAIT TIL CHANNEL WRITE DATA STARTS);
       LDB =WTIDE; LDX =DBF
       LDA 3,5; ADD =400; STA 3,5 (INCREMENT REC); SUB =4400; JAN WT2A
       LDA =400; STA 3,5; LDB =WTSK
       INR 2,5; LDA 2,5; SUB =24; JAN WT2A; STA 2,5 (HEAD =0);
       INR 1,5; LDA 1,5; SUB =310; JAN WT2A
       LDB =WTNOP  (END OF PAC);
WT2A   STB WTTIC+1
WT2B   LDA 43,7; JAP WT2
       JMPM H; +MBC; +WT2; JMP WT2B (MBC NEAR END OF RECORD);

WT3    LDA =WTNOP; STA WTTIC+1; LDB TIMEL   (WAIT FOR WTNOP TO CAUSE
       TBA; ADD =25; SUB TIMEL; JAP *-3    CHANNEL INTERRUPT)
       LDA 43,7; JANM CRASHV (CHANNEL PROG. SHOULD HAVE INTERRUPTED AT
*              (WTNOP+3. POSSIBLE BUG OR HARDWARE FAILURE);
       DEC ,A; STA 43,7; INR LOK; JMP RST
WT4    DEC ,A; STA 43,7; INR LOK; LDA 44; ERA =6200; JAZ WT4B
WT4A   JMPM MS; ASC 'IO ER/'; JMP RST
WT4B   LDB =DBF; LDA 1,5; SUB =310; JAN WT4A
       INR JVAL1; LDA JVAL1; LRLA 17; JAN WT1
WT4C   JMPM MS; ASC 'EOJ/'; JMP RST

MBC    E *     READ 2 BITS OF MAIN BYTE COUNTER. LI IF MBC L.T. 400.
       LDA =14000 (ADRS OF BIT 1000); OAR 65; IME 65,T1 GET COMP OF BIT
       LDA =16000  (ADRS OF BIT 400); OAR 65; CIA 65
       ANA T1; ANA =20; JAZ L1 (MBC BETWEEN 400,1400)
       JMP LI (MBC LESS THAN 400);

FORMAT COP AX
*      SEE FCP FOR FORMAT DISC CHANNEL PROGRAM.
*      DBF CONTAINS THE FILE MASK. DBF+1-DBF+3 IS THE HOME ADRS.
*      DBF+4-DBF+7 ARE THE R0 BYTES (CC,HH,00,00).
*      DBF+10-DBF+13 ARE THE R1 BYTES.
*      DBF+14-DBF+17 ARE THE R2 BYTES......
*      DBF+44-DBF+47 ARE THE R8 BYTES.
*      FCP DOES SEEKS FROM DBF+7
       EXC 254   CLEAR THE DISC
       JMPM H; +CPN; DEC ,A; STA LOK
FR0    TZB; LDX =DBF; STB 0,5; INC X,AX; SUB =DBF+50; JAN *-3
FR1A   LDX =DBF    INITIALIZE DATA FOR THE CHANNEL PROGRAM
       LDA =140000; STA 0,5     FILE MASK
       LDA =123456; STA 50,5    END OF CP PARAMETERS
FR1    LDA =1400; STA 13,5     DATA COUNT
       LDA =400; ADD 6,5; STA 12,5    RECORD NUMBER IN LEFT BYTE
       TXA; ADD =4; TAX; SUB =DBF+40; JAN FR1
       LDA =FCP; STA 14; LDA JVAL1; JMPM H; +GIO
FR2    LDA ESCSW; JAP WT3 (USER INTERRUPTED ON TTY);
       LDA 43,7; JAP FR7
       JMPM H; +RCPC; ERA =FTIC; JAZ 4*; JMP FR2 (WAIT  FOR RECORD 8,
*              THEN INCREMENT THE HEAD NUMBERS)
       LDX =DBF   UPDATE THE FCP DATA
       LDA 3,5; ADD =400; STA 3,5; SUB =12000 (HEAD 20D); JAN FR3A
       STA 3,5; LDA 2,5; ADD =400; STA 2,5 (NEXT CYL); ERA =144000
FR3A   LDB =FSK; JAZ 3*; STB FTIC+1 (KEEP FCP GOING IF NOT CYL 200D);
FR3    INR 5,5; LDA 5,5; SUB =24; JAN FR3B
       STA 5,5; INR 4,5 (WRAP AROUND TO HEAD 0, AND NEXT CYL);
FR3B   TXA; ADD =4; TAX; SUB =DBF+44; JAN FR3
FR4    JMPM H; +RCPC; ERA =FTIC; JAZ FR4 (WAIT FOR FCP TO GO TO FSK);
       LDA =WTNOP; STA FTIC+1; JMP FR2
FR7    DEC ,A; STA 43,7; INR LOK; LDA 44; ERA =6200; JAZ FR8; JMP WT4A
FR8    LDX =DBF; LDA 2,5; ERA =144000; JAZ FR9
       JMPM MS; ASC 'DIM BUG/'; JMP RST
FR9    INR JVAL1; INC ,A; ANA JVAL1; JAZ TYPEOK; JMP FR0

RCPC   E *     READ CHANNEL PROGRAM COUNTER
       LDA =-4; STA T1; STA T2
RCPC0  LDX =70; TZB
RCPC1  TXA; LRLA 12; OAR 65    ASK FOR 2 CPC BITS
       LRLB 1; CIA 65; LSRA 4; ANA =3; ADD =376; ANA =401; COP AB,B
       INC X,AX; SUB =100; JAN RCPC1
       TBA; ERA T1; STB T1; LLRL 20; JBZ L (2 SAME READINGS IN A ROW);
       LDA T2; INR T2; JAN RCPC0
       JMPM CRASHV  (RCPC BUG OR BAD BIT LOOKER HARDWARE);

MICT   COP AX  MIC TEST. PRESET B AND X TO INCLUSIVE RANGE IN 940.
*      A IS ALSO PRESET. BIT 15 ON FOR UPPER 940. BIT 14 (2) ON FOR
*      ALL ONES TEST. BIT 13 (4) FOR ZEROS TEST. BIT 12 (10) FOR 52525
*      TEST. BIT 11 (20) FOR ADDRESSING CHECK.
       STB MCADR; ANA =1; STA MC540; LLSR 20; STA MC4
       LDA UP540,6; JAP CPN2
MC1    JMPM H; +MAYDMS
       LDB MC540; STB N540
       LDA MC4; INR MC4; ANA =3; TAX; SUB =2; LDB MCADR
       XAZ MC6; XAN MC7
       LDA SEMIA; ANA BIT+1,5; JAZ MC2
       TBA; STA MCDATA; LDX MCADR; JMPM H; +W540; +MC3
       JMPM H; +R540; +MC3; STA MCDATA+1; STB MCDATA+2
       ERA MCDATA; ANA =377; LLRL 20; ERA MCDATA
       +JAZBZ; +MC2
       JMPM H; +CRTYP; JMPM H; +TEMP2; LDA MCADR; JMPM H; +ISC; +PF
       JMPM H; +WS
       LDA MCDATA; TAB; JMPM H; +TY8
       LDA MCDATA+1; LDB MCDATA+2; JMPM H; +TY8
MC2    LDA MC4; ANA =3; DAR; JAP MC1
       LDB SEMIB; LDA SEMIX; ERA MCADR; INR MCADR; XAZ MC2A; +1000 (JMP)
MC1A   +MC1
MC2A   STB MCADR
MC3    JMPM MS; ASC '$MIC UNREADY/'; JMP MC2
MC6    LDB =52525
MC7    INC A,B

TY8    E *     TYPE 8 OCTALS FOR 24 BIT VALUE
       LLRL 10; STB TY1; STA TY2; LDA =-13; STA TY3
       LDX =240; LDAI *; JMP CO; INR TY3; LDA TY3; ADD =10; JAN *-10
TY8A   LDA TY1; LDB TY2; LLRL 3; STA TY1; STB TY2
       ANA =7; ADD =260; TAX; LDAI *; JMP CO
       INR TY3; LDA TY3; JAN TY8A
       JMP L

BL     E *     BIT LOOKER COMMAND
       LDA =TEMP+12; STA TEMP+10; TZA; STA TEMP+11; LDB =-1-ALP-NUM
       LDX =TEMP+10; JMPM H; +RS     READ SYMBOLIC STRING INTO TEMP+12
       LDA TEMP+11  STR BIT LENGTH; STA W6; ANA =10
       JAZ 7*; LDA =240; JMPM H; +WSI8  ADD BLANK TO FILL OUT WORD
       LDA =BLST
BL4    STA T1; STA T2; TZA; STA T3
BL5    LDA T2,7; LSRA 11; ANA =37; COM A,A; IAR; ADD T3
       STA T3   NEGATIVE COUNT OF TOTAL NUMBER OF BITS FOR THIS ENTRY
       LDA T2,7; LSRA 16; INR T2
       JAZ BL5  (GET NEXT BIT LOOKER CONTROL VALUE FOR THIS ENTRY);
*      A=LENGTH OF ASC STRING IN WORDS; LRLA 4; STA W4 BIT LENGTH OF STR
       LSRA 4; ADD T2; STA W5  POINTS TO NEXT BLST ENTRY
       LDA T2; STA W3  W3,W4 ARE STRING POINTERS FOR THIS ENTRY
       LDB =W3; JMPM H; +SSE; +BL10  COMPARE USER STR WITH W3,W4 STR
       JMPM H; +TEMP2  T1 POINTS AT RIGHT ENTRY. INITIALIZE OUTPUT STR.
       LDA T3; TAB; ADD =3; JAN *-2;: OUTPUT IS IN GROUPS OF 3 BITS
       STB W3   W3 SAYS WHETHER 1ST GROUP IS 1,2 OR 3 BITS LONG
BL6    LDA =240; JMPM H; +WSI8
       LDA W6; ADD =10; STA W6; SUB =100
       JAN BL6   OUTPUT SEVERAL LEADING BLANKS
BL7    LDA T1,7; LRLA 7; STA T4   POSITION OAR BITS TO BITS 0-5
       ANA =37; COM A,A; IAR; STA T3      NEGATIVE COUNT
BL8    LDA T4; OAR 65   ASK CHANNEL FOR A BIT
       ADD =2000; STA T4    NEXT OAR WORD
       LDA W3; INR W3; JAN BL9
       LDA =-2; STA W3; LDA =240 (BLANK); JMPM H; +WSI8
BL9    LDA T1,7; LLSR 3; LSRB 15;:   B= MASK INDEX
       CIA 65; ANA BIT+4,6; JAZ 3*; INC ,A; ADD =260
       JMPM H; +WSI8    OUTPUT A 0 OR 1
       INR T3; LDA T3; JAN BL8  OAR NEXT HIGHER ADRS
       LDA T1,7; INR T1; LSRA 16; JAZ BL7 (MOVE TO NXT CONTROL VALUE);
       JMPM H; +WS; JMP RST
BL10   LDA W5; SUB =EBLST; JAP QUES
       LDA W5; JMP BL4

BLST   E *
*      BLST ENTRY FORMAT. (BITS ARE NUMBERED FROM LEFT TO RIGHT).
*      EACH BLST ENTRY HAS 1 OR MORE BIT LOOKER CONTROL VALUES FOLLOWED
*      BY AN ASC STRING. BITS 0 AND 1 (140000) OF A CONTROL VALUE WORD
*      ARE 0 IF THE NEXT WORD IS ANOTHER BIT LOOKER CONTROL VALUE.
*      IF BITS 0 AND 1 ARE 1,2 OR 3, THEN A 1,2 OR 3 WORD ASC STRING
*      FOLLOWS IN MEMORY. BITS 2-6 (37000) OF A CONTROL VALUE ARE A 
*      COUNT FIELD. BITS 7-12 (000770) ARE AN ADDRESS VALUE TO BE SENT
*      TO THE SELECTOR CHANNEL VIA THE OAR 65 INTRUCTION. BITS 13-15 OF
*      A CONTROL VALUE WORD ARE A MASK INDEX USED TO MASK OFF 15 BITS
*      AND KEEP 1 BIT THAT IS RECEIVED FROM THE CIA 65 INTRUCTION THAT
*      GETS BITS FROM THE CHANNEL. THE BIT LOOKER COMMAND IN DDT READS
*      BITS FROM THE ADDRESS, A, IN THE CONTROL VALUE WORD AND
*      FROM A+1, A+2, A+3 UP TO A+THE COUNT FIELD-1 AND TYPES OUT THESE
*      BITS IN A READABLE FORMAT.
       102243; ASC 'ADP '
       130400; ASC 'ADR '
       5602; 101035; ASC 'ADS '
       43652; ASC 'BC'
       10001; 41015; ASC 'BI'
       10601; 41005; ASC 'BO'
       104634; ASC 'CAWS'
       106473; ASC 'CFS '
       110501; ASC 'CHR '
       110101; ASC 'CIR '
       10701; 110700; ASC 'CPC '
       60405; ASC 'DA'
       120202; ASC 'DAR '
       143443; ASC 'DS620 '
       110702; ASC 'DTS '
       10703; 41764; ASC 'ES'
       110002; ASC 'FHR '
       110102; ASC 'FIR '
       110201; ASC 'IDAR'
       1173; 1163; 1153; 101143; ASC 'IPT '
       144674; ASC 'IS620 '
       144203; ASC 'MA940 '
       120105; ASC 'MABA'
       120505; ASC 'MASC'
       120200; ASC 'MBCI'
       120000; ASC 'MBCO'
       3355; 104445; ASC 'MLB '
       3755; 104405; ASC 'MLSC'
       14274; 41774; ASC 'MS'
       105305; ASC 'MSB '
       105705; ASC 'MSSC'
       104103; ASC 'OPT '
       103604; ASC 'PIT '
       06603; 41673; ASC 'PS'
       104403; ASC 'PSS '
       42003; ASC 'RC'
       106023; ASC 'RCNT'
       67004; ASC 'SS'
       6263; 1025; 101343; ASC 'STD '
       105434; ASC 'T360'
       106504; ASC 'TIN '
       103734; ASC 'TIS '
       3353; 1573; 1563; 1553; 101564; ASC 'TSS '
       110301; ASC 'UAR '
       110401; ASC 'USR '
EBLST  E *

*      *********** END OF DDT CODE
*      *********** DDT DISPATCH TABLES
CT0    E *     DISPATCHER FOR SINGLE CHR DDT COMMANDS
       202 (CONTROL B); +BL; +QUES; +QUES   BIT LOOKER COMMAND
       275+0;    +EQ0; +EQ1; +EQ2      EQUAL SIGN
       243+400;  +EQ0; +EQ1; +EQ2      POUND SIGN
       337+1000; +EQ0; +EQ1; +EQ2      LEFT ARROW
       247+1400; +EQ0; +EQ1; +EQ2      SINGLE QUOTE
       333+0;    +LOOK0; +LOOK1; +LOOK2    LEFT BRACKET
       244+400;  +LOOK0; +LOOK1; +LOOK2    DOLLAR SIGN
       335+1000; +LOOK0; +LOOK1; +LOOK2    RIGHT BRACKET
       242+1400; +LOOK0; +LOOK1; +LOOK2    FULL QUOTE
       257; +SLASH0; +SLASH1; +SLASH2
       254+100000 (COMMA); +QUES; +CMA; +QUES
       215 (CARRIAGE RET); +RST1; +CRET1.; +CRET2.
       212+1000 (LINE FEED); +LF0; +LF1.; +LF2.
       336 (UP ARROW) ; +LF0; +LF1.; +LF2.
       273+0 (SEMICOLON); +SETCM; +SETCM; +SETCM
       245+400 (PERCENT SIGN);  +SETCM; +SETCM; +SETCM
       0       END OF CT0
CT1    E *     COMMAND DISPATCHER FOR CHRS FOLLOWING SEMICOLON
       301+0;     +SE0; +SE1; +SE2    SEMIA
       302+400;   +SE0; +SE1; +SE2    SEMIB
       330+1000;  +SE0; +SE1; +SE2    SEMIX
       261+1400;  +SE0; +SE1; +SE2    SEMI1
       262+2000;  +SE0; +SE1; +SE2    SEMI2
       315+2400;  +SE0; +SE1; +SE2    SEMIM
       314; +QUES; +QUES; +SEMIL      SEMIL
       322; +SEMIRV; +QUES; +QUES     SEMIR
       326+400; +SEMIRV; +QUES; +QUES SEMIV
       257; +QUES; +SSLSH1; +SSLSH2
       212 (LINE FEED); +SLF0; +QUES; +SLF2
       327 (W); +SEMIW; +SEMIW; +SEMIW2
       243+400 (SEMI POUND SIGN); +SEMIW; +SEMIW; +SEMIW2
       332 (Z); +.SZ0; +.SZ1; +.SZ2    SEMIZ
       307  (SEMIG); +QUES; +SEMIG; +SEMIG
       333+0;    +STMODE; +QUES; +QUES   LEFT BRACKET
       244+400;  +STMODE; +QUES; +QUES   DOLLAR SIGN
       335+1000; +STMODE; +QUES; +QUES   RIGHT BRACKET
       242+1400; +STMODE; +QUES; +QUES   FULL QUOTE
       0       END OF CT1
CT2    E *     COMMAND DISPATCHER FOR CHRS FOLLOWING PERCENT SIGN
       257; +QUES; +PS1.; +PS2.
       327 (W); +QUES; +QUES; +PW
       0       END OF CT2



DC     E *     DECODE CHR. CATORGORIZE A CHR AS BEING IN ONE GROUP.
*      GROUP DEFINITIONS FOLLOW
COM    E 1     COMMAND CHARACTER
CAR    E 2     CARRIAGE RETURN
LIN    E 4     LINE FEED
BLA    E 10    BLANK
PLU    E 20    PLUS SIGN
MIN    E 40    MINUS SIGN
PER    E 100   PERIOD
ALP    E 200   ALPHABETIC CHR
NUM    E 400   NUMERIC
AST    E 1000  ASTERISK 
OTH    E 100000 OTHER THAN ABOVE

       STA DCA
       SUB =400; JAP DC1; ADD =200; JAN DC1
       ADD YCHRT; STA JT; LDA JT,7; JMP DC2
DC1    LDA =OTH
DC2    STA DC9; JMP L
YCHRT  +CHRT

CHRT   E * THE FRIRST CHR IN THIS TABLE IS A 200 AND THE LAST IS A 377
 +OTH; +OTH; +COM; +OTH; +OTH; +OTH; +OTH; +OTH; +OTH; +OTH
 +LIN    LINE FEED
 +OTH; +OTH
 +CAR    CARRIAGE RETURN
 R *+22
 +BLA    CHR CODE IS 240 FOR A BLANK
 +COM; +COM; +COM; +COM; +COM; +COM; +COM; +COM; +OTH
 +AST; +PLU; +COM; +MIN; +PER; +COM
 +NUM; +NUM; +NUM; +NUM; +NUM;   +NUM; +NUM; +NUM; +NUM; +NUM
 +COM ; +COM; +OTH; +COM; +OTH; +COM (?)
 +COM (AT SIGN)
 +ALP; +ALP; +ALP;   +ALP; +ALP; +ALP; +ALP
 +ALP; +ALP; +ALP;   +ALP; +ALP; +ALP
 +ALP; +ALP; +ALP;   +ALP; +ALP; +ALP; +ALP
 +ALP; +ALP; +ALP;   +ALP; +ALP; +ALP
 +COM; +COM; +COM; +COM; +COM (LEFT ARROW, CHR 377)


*      SYMBOLS USED TO BUILD SYMBOL TABLE FOLLOW
X0 E 0;X1 E 1;X2 E 2;X3 E 3;X4 E 4;X5 E 5;XA E 6;XB E 7;XC E 10;XD E 11
XE E 12;XF E 13;XG E 14;XH E 15;XI E 16;XJ E 17;XK E 20;XL E 21;XM E 22
XN E 23;XO E 24;XP E 25;XQ E 26;XR E 27;XS E 30;XT E 31;XU E 32;XV E 33
XW E 34;XX E 35;XY E 36;XZ E 37
Y0 E 0;Y1 E 40;Y2 E 100;Y3 E 140;Y4 E 200;Y5 E 240;YA E 300;YB E 340
YC E 400;YD E 440;YE E 500;YF E 540;YG E 600;YH E 640;YI E 700;YJ E 740
YK E 1000;YL E 1040;YM E 1100;YN E 1140;YO E 1200;YP E 1240;YQ E 1300
YR E 1340;YS E 1400;YT E 1440;YU E 1500;YV E 1540;YW E 1600;YX E 1640
YY E 1700;YZ E 1740
Z0 E 0;Z1 E 2000;Z2 E 4000;Z3 E 6000;Z4 E 10000;Z5 E 12000;ZA E 14000
ZB E 16000;ZC E 20000;ZD E 22000;ZE E 24000;ZF E 26000;ZG E 30000
ZH E 32000;ZI E 34000;ZJ E 36000;ZK E 40000;ZL E 42000;ZM E 44000
ZN E 46000;ZO E 50000;ZP E 52000;ZQ E 54000;ZR E 56000;ZS E 60000
ZT E 62000;ZU E 64000;ZV E 66000;ZW E 70000;ZX E 72000;ZY E 74000
ZZ E 76000

ST     E *
*      KEEP SYMBOL TABLE IN ALPHANUMERIC ORDER FOR EASY EYEBALL LOOKUPS
       100000    SYMBOLS OF LESS THAN 4 CHARACTERS FOLLOW
 +ZA+YD+XD; 120000; +ZA+YN+XA; 150000; +ZC+YI+XA; +102500; +ZC+YI+XB; 102600
 +ZC+YP+XA; 5211; +ZC+YP+XB; 5222; +ZC+YP+XX; 5244; +ZD+YA+XR; +5311
 +ZD+YB+XR; 5322; +ZD+YX+XR; 5344; +ZE+YR+XA; 130000; +ZE+YX+XC; 100000
 +ZI+YA+XR; 5111; +ZI+YB+XR; +5122; +ZI+YN+XR; 40000
 +ZI+YX+XR; +5144; +ZJ+YA+XN; 1004; +ZJ+YA+XP; +1002; +ZJ+YA+XZ; 1010
 +ZJ+YB+XZ; 1020; +ZJ+YM+XP; 1000; +ZJ+YX+XZ; +1040; +ZL+YD+XA; 10000
 +ZL+YD+XB; 20000; +ZL+YD+XX; 30000; +ZN+YO+XP; 5000; +ZO+YA+XR; 103100
 +ZO+YB+XR; 103200; +ZO+YM+XE; 103000; +ZI+YM+XE; 102000; +ZO+YR+XA; 110000
 +ZS+YE+XN; 101000; +ZS+YT+XA; 50000; +ZS+YT+XB; 60000; +ZS+YT+XX; 70000
 +ZS+YU+XB; 140000; +ZT+YA+XB; 5012; +ZT+YA+XX; 5014; +ZT+YB+XA; 5021
 +ZT+YB+XX; 5024; +ZT+YX+XA; 5041; +ZT+YX+XB; 5042; +ZT+YZ+XA; 5001
 +ZT+YZ+XB; 5002; +ZT+YZ+XX; 5004; +ZX+YA+XN; 3004; +ZX+YA+XP; 3002
 +ZX+YA+XZ; 3010; +ZX+YB+XZ; 3020; +ZX+YE+XC; 3000; +ZX+YX+XZ; 3040

 +ZA+YC+XT; +ACT; +ZB+YC+XP; +BCP; +YA+XL; +AL; +ZB+YI+X1; +BI1
 +ZB+YE+XT; +BET
 +ZB+YI+XT; +BIT; +YB+XL; +BL; +ZB+YO+X1; +BO1; +ZC+YH+XE; +CHE
 +YC+XA; +CA; +YC+XC; +CC; +ZC+YC+XF; +CCF; +YC+XH; +CH
 +YC+XI; +CI; +YC+XO; +CO; +YC+XR; +CR; +ZC+YR+X1; +CR1
 +ZD+YB+XF; +DBF; +ZC+YD+XF; +CDF
 +ZD+YI+XR; +DIR; +YD+XM; +DM; +ZD+YM+X2; +DM2; +ZD+YM+X3; +DM3
 +ZD+YM+X4; +DM4; +ZD+YM+X5; +DM5; +ZD+YM+XS; +DMS; +ZD+YR+XQ; +DRQ
 +YD+XV; +DV
 +ZE+YI+XR; +EIR; +ZE+YS+XT; +EST
 +YF+XL; +FL; +ZF+YL+XG; +FLG
 +ZG+YI+XO; +GIO; +ZG+YP+XW; +GPW; +XH; +H; +YH+X1; +H1
 +ZI+YO+XC; +IOC; +YI+XZ; +IZ; +YK+X1; +K1; +YK+XH; +KH; +YK+XL; +KL
 +XL; +L; +YL+X1; +L1; +YL+XI; +LI
 +YM+XB; +MB; +ZN+YG+XN; +NGN
 +ZO+YF+XC; +OFC;  +ZO+YN+XC; +ONC; +ZO+YN+XV; +ONV
 +ZP+YA+XC; +PAC; +YP+XC; +PC; +YP+XI; +PI; +YP+XP; +PP
 +ZP+YW+X5; +PW5; +ZP+YW+XT; +PWT; +ZP+YW+XU; +PWU
 +YR+XC; +RC; +YR+XG; +RG
 +YR+XB; +RB; +YR+XD; +RD; +ZR+YE+XC; +REC; +ZR+YQ+X1; +RQ1; +ZR+YQ+X2; +RQ2
 +YR+XS; +RS; +ZR+YS+XT; +RST; +YR+XT; +RT
 +YS+X1; +S1; +YS+X2; +S2
 +ZS+YF+XM; +SFM; +YS+XK; +SK; +ZS+YK+XP; +SKP; +YS+XT; +ST
 +ZS+YY+XG; +SYG
 +ZT+YD+XI; +TDI
 +YT+X1; +T1; +YT+XI; +TI; +YT+XL; +TL; +YT+XP; +TP; +YU+XP; +UP
 +ZV+YA+XG; +VAG; +ZV+YP+XW; +VPW
 +YW+X1; +W1; +YW+XD; +WD; +YW+XP; +WP; +YW+XE; +WE; +YW+XS; +WS
 +YW+XT; +WT; +ZW+YI+XO; +WIO
       +.XA  "A"     ; +Z5+Y4+X0; +A540; +ZN+YA+XI; 6150
       +ZD+YD+XI; 6120
       +.XB  "B"     ; +Z5+Y4+X0; +B540; +ZL+YS+XT; +BLST
       +.XC  "C"     ; +ZR+YH+XA; +CRHA; +ZS+YT+XR; +CSTR
                       +ZB+YF+X1; +CBF1; +ZB+YF+X2; +CBF2
       +.XE  "E"     ; +ZR+YA+XI; 6130; +ZL+YI+XT; +ELIT
                     ; +ZR+YC+XT; +ERCT
       +.XG  "G"     ; +ZE+YT+XL; +GETL
       +.XH  "H"     ; +ZP+YT+XR; +HPTR
       +.XJ               "J"
 +ZA+YN+XM; 2004; +ZA+YP+XM; 2002; +ZA+YZ+XM; 2010; +ZB+YZ+XM; 2020
 +ZM+YP+XM; 2000; +ZS+YS+X1; 1100; +ZS+YS+X2; 1200; +ZS+YS+X3; 1400
 +ZX+YZ+XM; 2040
       +.XL               "L"
 +ZD+YA+XI; 6010; +ZD+YB+XI; 6020; +ZD+YX+XI; 6030
 +ZI+YS+XT; +LIST
 +ZL+YR+XL; 4440 LLRL; +ZL+YS+XR; 4540 LLSR; +ZR+YL+XA; 4240 LRLA
 +ZR+YL+XB; 4040 LRLB; +ZS+YR+XA; 4340 LSRA; +ZS+YR+XB; 4140 LSRB
       +.XM  "M"     ; +Z5+Y4+X0; +M540; +ZI+YC+XT; +MICT
       +.XN  "N"     ; +Z5+Y4+X0; +N540
       +.XO  "O"      ; +ZR+YA+XI; 6110
       +.XP  "P"     ; +ZU+YR+XE; +PURE; +ZT+YC+XH; +PTCH
       +.XR  "R"     ; +Z5+Y4+X0; +R540; +ZU+YN+X1; +RUN1
                     ; +ZS+YT+XE; +RSTE
       +.XS  "S"   ; +ZU+YB+XI; 6140; +ZT+YO+XP; +STOP; +ZT+YA+XT; +STAT
               +ZN+YG+XN; +SNGN
       +.XT  "T"     ; +ZE+YM+XP; +TEMP
       +.XV   "V"         ; +ZE+YR+XS; +VERS
       +.XW  "W"     ; +Z5+Y4+X0; +W540
       +.YC+XK   "CK"   ; +ZK+YE+XY; +CKKEY
       +.YC+XP   "CP"     ; +ZS+YN+XS; +CPSNS; +ZS+YE+XK; +CPSEK
       +.YE+XP   "EP"   ; +ZU+YR+XE; +EPURE
       +.YG+XI   "GI"   ; +ZV+YE+XL; +GIVEL
       +.YR+XE  "RE"   ; +ZS+YE+XT; +RESET
       +.YU+XP  "UP"   ; +Z5+Y4+X0; +UP540
       +.YT+XI  "TI"    ; +ZM+YE+XH; +TIMEH; +ZM+YE+XL; +TIMEL
       +.ZC+YR+XA   "CRA"   ; +ZS+YH+XH; +CRASHH; +ZS+YH+XV; +CRASHV
       +.ZC+YL+XO   "CLO"   ; +ZC+YK+X1; +CLOCK1; 
                                 ; +ZC+YK+XX; +CLOCKX; +ZC+YK+XI; +CLOCKI
       +.ZE+YS+XC  "ESC"     ; +ZA+YP+XE; +ESCAPE
       +.ZE+YR+XR   "ERR"   ; +ZO+YR+XS; +ERRORS
       +.ZF+YO+XR   "FOR"   ; +ZM+YA+XT; +FORMAT
       +.ZM+YA+XY   "MAY"   ; +ZD+YM+XS; +MAYDMS
       +.ZM+YR+XE   "MRE"    ; +ZS+YE+XT; +MRESET
       +.ZO+YU+XT  "OUT"     ; +Z5+Y4+X0; +OUT540
       +.ZP+YW+XT     "PWT"   ; +ZI+YM+XE; +PWTIME
       +.ZS+YE+XN    "SEN"   ; +ZB+YY+XT; +SENBYT
       +.ZT+YI+XM    "TIM"   ; +ZE+YH+XH; +TIMEHH
       +.ZZ+YZ+XZ    "ZZZ"   ; +ZZ+YZ+XZ; +124367   DUMMY SYMBOL FOR
:              SEMIV COMMAND. SHOULD ALWAYS BE LAST SYMBOL IN TABLE.
EST    E *

*              END DDT **********************************************************************

*              MEMORY CHECKER  *************************************************************:
*      MEMORY CHECK CODE TO MAKE SURE THAT THE READ ONLY CODE FROM
*      PURE TO EPURE IS NOT CHANGED.
K0     INR KH
K1     INR KL; LDA KL; XAZ K0
       LDA TIMEHH; JAN DMS1
       LDX =KAREA1; TZB
K2     LDA 0,5; ERA KAREA2-KAREA1,5
       LRLB 1; JAZ 3*; IBR
       INC X,AX; SUB =KAREA2; JAN K2
       DEC B,A; ORA KC1; ORA KC2
       JAPM CRASHV   READ ONLY PART OF 620 MEMORY HAS CHANGED.B=BAD ADRS.
       LDA KC1; STA KC2; LDA =77777; STA KC1
       LDA KTP1; LDX KTP2; STA KTP2; STX KTP1
       LDA EBIT-NBIT-1
       STA 0,5; LRLA 1; IXR; JAP *-3
       LDA =PURE-1; STA KADR
K3     INR KADR; LDA KADR; TAB; SUB =EPURE; JAP K1
       LDA =100000; LLRL 20-NBIT; LDX KTP1; DXR
       LDA 21,7; ANA 41,7; ANA 43,7; JAN K4
       LDA K4A+1; JMP DMS
K4     TZA
       IXR; LLRL 1; JAZ *-2; JBZ K3
       LDA KADR,7; ERA 0,5; STA 0,5
K4A    JMP K4

*              END MEMORY CHECKER  *********************************************************
*      LOW LEVEL ROUTINES

*      LIST HANDLING ROUTINES
GETL   E * GET AN ENTRY FROM THE FREE LIST AND PUT IT ON THE ACTIVE LIST
*      FL IS THE FREE LIST. AL IS THE ACTIVE LIST.
       LDX FL; JXZ LI (NO MORE SPACE AVAILABLE);
       LDB 0,5; STB FL
       LDA =AL
       TAB; LDA 0,6; JAZ 4*; JMP *-4
       STX 0,6; STA 0,5
       JMP L1    EXIT WITH LIST POINTER IN X

GIVEL  LDB =AL
GIVEL1 LDA 0,6  (LOOK AT NEXT ENTRY ON ACTIVE LIST);
 JAZM CRASHV (POSSIBLE DIM BUG. TRIED TO RETURN AN ENTRY THAT WASNT ON AL);
       TXA; ERA 0,6; JAZ GIVEL2
       LDB 0,6; JMP GIVEL1
GIVEL2 LDA 0,5; STA 0,6
       LDA FL; STA 0,5; STX FL; JMP L

GLOK   E *     GRAB LOK  AND FREE THE DISC LIST.
       LDA LOK; JANM CRASHV (TRIED TO LOCK ALREADY LOCKED LIST.DIM BUG);
       DEC ,A; STA LOK SEE DM3. KEEP DM3 FROM GETTING MORE 940 REQUESTS.
       LDAI *; LDB AL; JBZ 4*; JMP DMS (LET DISC QUE DRAIN);
       JMPM H; +GETL; +PF
       JMP L

DV     E *     DIVIDE POSITIVE A BY POSITVE B. A=REMAINDER,  B=QUOTIENT.
STAW1  STA W1; STX W3
       TZX; STX W2; LRLB 17
       LRLB 1; DXR; DEC B,A; SUB W1; JAN *-4
DV1    IXR; JXZ DV2
       LSRB 1; COM B,A; IAR; ADD W1 (W1-B); XAP STAW1
       ORA =77777; IAR; ORA W2; LRLA 1; STA W2
       JMP DV1
DV2    LDA W1; LDB W2; LDX W3; JMP L

RG     E *     GENERATES ALL 16 BIT RANDOM VALUES IN A AND RG2
       LDA RG1; LRLA 11; ERA RG1; LRLA 2; ERA RG1; LRLA 1
       ANA =100000; ERA RG1; LRLA 1; STA RG1
       LDA RGP,7; JAP 5*; LDA =RGTAB; STA RGP; LDA RGP,7
       INR RGP; ADD RGP,7; STA RGP,7; INR RGP
       ADD RG1; STA RG2
       JMP L


*      SUBROUTINES TO READ OR WRITE A WORD IN THE 540 MEMORY
R540   E *     SET AB AND A540,B540 TO THE 24 BIT VALUE IN 540 LOCATION X.
       JMPM DIR; SEN 137,R540B
R540A  EXC 130 (CLEAR THE MIC); INR MB; JMPM EIR; JMP LI (ER RETURN)
R540B  TXA; OAR 36; LDA N540; LRLA 12
       ORA =1400 (READ BIT AND PRIORITY BIT); OAR 35
       LRLA 12 (STALL FOR ABOUT 6 MICROSECONDS);
       SEN 137,R540C; LLRL 20 (STALL); SEN 137,R540C
       JMP R540A (THE MIC TOOK UNREASONABLY LONG TO GET READY);
R540C  CIA 35; CIB 37; ANA =377; STA A540; STB B540
R540D  JMPM EIR; JMP L1

W540   E *     WRITE AB TO LOCATION X IN 540 
       JMPM DIR; ANA =377; STA A540
       SEN 137,4*; JMP R540A
       TXA; OAR 36; OBR 37; LDA N540; LRLA 12; ORA =1000
       ORA A540; OAR 35
       JMP R540D

MS1    LDA MS; STA WS9; LDA =2000; STA WS9+1   BORROW WS VARIABLES
MS2    LDX =WS9; JMPM H; +GSI8; +PF
       SUB =244; JAZ MS3 (DOLLAR SIGN); SUB =257-244; JAZ MSX (SLASH);
       LDX GS7; LDAI *; JMP CO; JMP MS2
MS3    JMPM H; +CRTYP; JMP MS2
MSX    LDA WS9+1; JAP 3*; INR WS9
       JMP .WS9    JUMP AROUND STR 

*              SUBROUTINE LINKAGES   **************************************************************
*              STANDARD SUBROUTINE CALL IS JMPM H, +SUB.
*              SUB RETURNS TO CALLER BY EXECUTING JMP L.
*              H IS MNEMONIC FOR PUSH, L FOR PULL.
*              JMPM H, +SUB, +ERROR CALLS SUBROUTINES THAT SKIP OR MAKE
*              AN ERROR EXIT BY JMP L1 (SKIP) OR JMP LI (PULL INDIRECT).

L1     STB HB; LDB HPTR; INR 1,6; LDB HB
L      INR HPTR; JMP .HPTR

LI     STA HA; STB HB; INR HPTR
       LDB HPTR; LDA 0,6; ORA =100000; STA H
       LDA HA; LDB HB; JMP .H

H1     STA HA; STB HB
       LDB HPTR; DBR; STB HPTR
       LDA H; IAR; STA 1,6; ADD =100000-1; STA H
       LDA HA; LDB HB
       JMP *
H      E *-1
EPURE  E H     END OF PURE CODE. BEGINNING OF HIGH CORE READ WRITE AREA.
       JMP H1
HA     0
HB     0
PDS    +*.; +*.; +*.; +*.; +*.; +*.; +*.; +*.; +*.; +*.; +*.; +*.; +*.
EPDS   E *     PUSH DOWN STACK. ADDRESSED THROUGH HPTR.

MS     0;: MESSAGE TYPE OUT. CALLED BY JMPM MS, ASC 'ABCDE/'
       JMP MS1    CONTROL IS RETURNED TO THE INSTRUCTION AFTER THE STR

*              END SUBROUTINE LINKAGES  *****************************************************:

DIR    0; EXC 77; JMP .DIR
EIR    0; EXC 777; JMP .EIR

PON    0;: POWER ON INTERRUPT. CRASH THE 940S AND RESTART DIM.
       INR PNC; TZA; STA N540; JMPM CRASHH; INR N540; JMPM CRASHH
       JMP IZ

CLOCKI -1; JMP CLOCK1   CLOCK INTERRUPT ROUTINE

I24    0; JMPM CRASHV  (CHANNEL INTERRUPT. PARITY FAILURE IN CHANNEL);

TI     -1; EXC 777 (EIR); JMP .TI   TERMINATING STATUS INTERRUPT

PI     -1; EXC 777; JMP .PI   POLLING INTERRUPT

KAREA1 E * AREA FOR HAMMING CODE CHECKSUMS. ONE AREA FOR LAST HAMMING
       R *+NBIT             CODE CHECKSUMS AND THE OTHER FOR A NEW SET OF
KAREA2 E *; R *+NBIT        HAMMING CHECKSUMS


TL     E *     TASK LIST. SEE TASK MONITOR
*      EACH 3 WORD ENTRY IS A P COUNTER FOLLOWED BY THE B AND X REQISTORS
*      FOR A PROBABLY DISMISSED TASK THAT WILL BE STARTED FROM :ACT:
       +DM; +0; +0             DISC MANAGER. TOP PRIORITY.
       +CKKEY; +0; +0          PERIODIC TASK TO RECORD UP/DOWN 540 STATES.
TLDDT  +VERS; 0; 0              DDT
       +K1; 0; 0               CHECK MEMORY CODE. BOTTOM PRIORITY.
       +ACT1; 0; 0             WRAP AROUND TASK LIST.

LIST   0; R LIST+200  8 WORD BUFFERLETS DISPENSED BY GIVEL AND GETL
ELIST  E *

*      THE DISC MANAGER USES THE 8 WORD LIST ENTRIES AS FOLLOWS.
*      WORD 0. THE LIST CHAIN POINTER
PAC    E 1     BIT 0-11 = 0. FOUR BIT PACK NUM IN BITS 12-15.
CH     E 2     8 BIT CYLINDER IN 0-7, 8 BIT HEAD IN 8-15.
REC    E 3     5 BIT RECORD. ONE RECORD IS 300 CHARACTERS..
CA     E 4     CORE ADDRESS FOR READ OR WRITE.
CC     E 5     CHARACTER COUNT (DIVEDED BY 140). IF CC IS 10 THEN 1400 CHRS.
FLG    E 6     BITS 0-2 COUNT NUMBER OF FAULTS. BIT 10 (40) IS THE 
:              INHIBIT AUTOMATIC ERROR RETRY BIT.BIT 11 (20) IS ON IF 620
:              MEMORY. BIT 12 (10) IS READ/WRITE BIT, AND BITS 13-15 (7) 
:              ARE THE IO PROGRESS STATE BITS.
PP     E 7     POST PROCESSING ADDRESS. WHERE TO GO WHEN IO IS COMPLETE.

UPTAB  E *     BIG BLOCKS OF TABLE DRIVEN I/O TO BRING UP THE 540.
*      BIT 0,1 FOR CORE ADRS, BIT 9 (100) FOR WRITE, BITS 10-15 FOR DISC
       100     WRITE 16K  FROM LOCATION 0 ON DISC 0
       40101   WRITE 16K  FROM LOCATION 40000 ONTO DISC 1
       100120  WRITE 16K  FROM LOCATION 100000 ONTO DISC 20
       140124  WRITE 16K  FROM LOCATION 140000 ONTO DISC 24
       0; 0    THESE 2 CELLS ARE SET UP BY THE UP COMMAND
       0       END OF UPTAB

TBF    E *     BOD IN AND OUT BUFFERS. BI PUTS CHARACTERS IN LEFT HALF OF 
*      THIS ARRAY FOR CI TO PICK UP AND CO PUTS CHARACTERS IN THE RIGHT 
*      HALF OF THIS RING BUFFER FOR BO1 TO FIND AND OUTPUT.
       R 100+*    64 WORD BUFFER

CBF1   0; R 140*       CHANNEL PROGRAM BUFFER
CBF2   0; R 40*       CHANNEL PROGRAM DATA BUFFER
ECBF2  E *
DBF    0; R 577*      DISC BUFFER FOR GENERAL USE
SKBAD  123456  DATA LANDS HERE ON FAILING DATA CHAINED SKIP COMMANDS
BET    0; R 177*  BEGINNING OF ERROR TABLE. FIRST WORD OF AN ERROR ENTRY
EET  0; 0; 0; 0  HAS CYL. LEFT IN BITS 0-7, BIT 8 IS UNUSED, BIT 9 (100)
*      IS ON IF UNIT CHECK, BIT 10 (40) IS RD/WRITE BIT, AND BITS 11-15
*      ARE THE HEAD. THEN FOLLOWS A CSW OR 3 WORDS OF SENSE INFO.
PTCH   0; R 177*               PATCH AREA

*              BEGINNING OF ABSOLUTE LOADERS  ****************************:
       R 17527; 0 THIS CELL USED BY KENNEDY TAPE WRITER TO FUDGE 0 CKSUM

*      COPIES FROM 940 (20000-37526) TO 620 (0-17526).
       LDBI 37527; CIA 37; STA 0,6; DEC B,AB; LRLA 2; JAP *
       OBR 36 ADR OF 940 WD; LDAI 1400 RD+PRIORITY BIT; OAR 35
       SEN 137,17532; JMP *-2

*      KENNEDY TAPE LOADER. DAVID GARDNER   2-7-70
*      LOADS 620I MEMORY FROM LOCATION 0 TO 17775B.
*      READS CONSECUTIVE 6 BIT BYTES OFF TAPE. BYTE FORMAT IS....
*         FIRST 4 BITS ARE CORE DATA, FIFTH BIT IS ON FOR EVERY FOURTH
*         BYTE, AND SIXTH BIT IS ALWAYS ON TO ENTER THE CKSUM TO DETECT
*         DROPPED OR PICKED UP BYTES.

TA     E 67    TAPE ADDRESS. KLUDGE ADDRESS FOR KENNEDY TAPE.

       R 17550
       COP ,AX   START STOREING AT LOCATION 0
       STA CKSUM
       OAR TA    START SLEWING
LL      CIA TA; JAP LL     WAIT FOR A TAPE CHARACTER
       STA LTEMP
       ADD CKSUM; STA CKSUM
       LDA LTEMP; LRLA 12; LLRL 4    PUSH 4 BITS OF CORE INFO INTO B
       JAP LL     GET NEXT BYTE OR....
       STB 0,5   STORE A FULLY BUILT WORD
       INC X,ABX
       SUBI 17550
       JAN LL   GET NEXT BYTE OR QUIT
       OBR TA   STOP SLEWING
       LDA CKSUM
KSTOP  0 STOP. LOW ORDER 6 BITS OF A SHOULD BE 0.

*      IPL LOADER
       R 17600
       14007; 24003; 60014; 103154; 100477; 17611; 1000
       17605; 30001; 1004; 17664; 340; 2

*      PART OF DIMLDR WHICH LOADS ON TOP OF ITSELF WHILE COPYING
*      DIM FROM THE 940 TO THE 620...
       R 17664
       40002; 16000; 120036; 56000; 5021; 120007
       5012; 4242; 1002; 17665; 5345; 1002; 25; 27011; 30037
       124026; 101137; 17710; 1000; 17704
       103136; 14017; 103135; 101137; 17717; 1000; 17713
       102537; 55000; 5345; 1002; 17703; 5021; 34003; 55000
       1000; 100007; 17614; 154000
CKSUM  0    LTEMP AND CKSUM ARE USE BY BOTH LOADERS
LTEMP   0
*              END OF LOADERS  *********************************************


*              END OF DIM FILE
DIM ** FICHE/FRAME BREAK *****
DIMDUALVER14 SYMSORT

SYM.  PG.LN. IDENT.

:      54 24 :       :      54 23 :       :      54 22 :       :      50  1 :       
:      37 10 :       :      37  9 :       :      37  8 :       :      34  4 :       
:      34  3 :       :      34  1 :       :      33 38 :       :      22  2 :       
:      18 23 :       :      18 22 :       A540    5  1 :       
AB1    21 16 :       ABA     6 16 :       ABP    21  9 :       AC     27  4 :       
AC2    27  9 :       AC2A   27 12 :       AC2B   27 13 :       AC2C   27 17 :       
AC2D   27 18 :       AC2E   27 21 :       ACB     5 17 :       ACP     3  5 :       
ACT    12  7 :       ACT1   12  6 :       AL      4  8 :       ALP    46 14 :       
ARG2   28 10 :       AS     20 37 :       AS1    21  1 :       AS8     6 15 :       
AS9     6 14 :       ASB     6 13 :       AST    46 16 :       ASX     6 12 :       
AV     26 32 :       AV0    26 36 :       AV0A   26 37 :       AV1    26 35 :       
AV2    26 38 :       AV3    27  2 :       AVB     5 16 :       AVDISP 26 34 :       
B540    5  2 :       BCP    16 10 :       BCP1   16 24 :       BCP2   16 28 :       
BCP3   18  1 :       BCPCC  16 30 :       BCPCD  17  7 :       BCPCD1 17 15 :       
BCPCD2 17 21 :       BCPCD3 17 26 :       BCPCD4 17 30 :       BCPIDE 18  5 :       
BCPX   17 34 :       BET    55  7 :       BI1     9 34 :       BI2     9 38 :       
BI3     9 39 :       BI4    10  5 :       BI9     4 16 :       BIP1    5 20 :       
BIP2    5 21 :       BIT     8 29 :       BITAB  10 11 :       BL     42 15 :       
BL10   43  9 :       BL3    26 28 :       BL4    42 21 :       BL5    42 22 :       
BL6    42 33 :       BL7    42 36 :       BL8    42 38 :       BL9    43  3 :       
BLA    46 10 :       BLST   43 12 :       BO1    10 15 :       BO2    10 19 :       
BO3    10 20 :       BO3A   10 22 :       BO4    10 14 :       BO9     4 17 :       
BOP1    5 22 :       BOP2    5 23 :       BOTAB  10 24 :       BUSY   13 10 :       
CA     54 19 :       CAR    46  8 :       CBF1   55  2 :       CBF2   55  3 :       
CC     54 20 :       CCF     2 15 :       CDF     2 14 :       CH     54 17 :       
CHE     1 36 :       CHRT   46 26 :       CI     10 26 :       CI1    10 31 :       
CI2    11  3 :       CI2A   11  4 :       CI3    11  5 :       CI4    11  6 :       
CIB     4 18 :       CICHR   4 20 :       CIORET  4 19 :       CKKEY  18 14 :       
CKSUM  56 22 :       CL1    25 26 :       CL2    25 29 :       CL3    25 36 :       
CLA     7  9 :       CLOCK1  9 27 :       CLOCKA  4 14 :       CLOCKB  4 15 :       
CLOCKI 53 28 :       CLOCKX 11 23 :       CMA    29 30 :       CMLOOK 25 24 :       
CNOP    2  2 :       CO     11  9 :       CO1    11 13 :       COADR   3  8 :       
COM    46  7 :       CPN    34 26 :       CPN0   34 29 :       CPN1   34 30 :       
CPN2   34 31 :       CPRC   15 34 :       CPSEK  15 30 :       CPSNS  15 28 :       
CR     25  5 :       CR1    25  9 :       CR2    25 19 :       CR3    25 17 :       
CRASHH  8 37 :       CRASHV  9 17 :       CRET1  31 11 :       CRET2  31 10 :       
CRH1    9 13 :       CRH2    9 15 :       CRHA    9 22 :       CRHB    9 23 :       
CRHX    9 24 :       CRLF    1 30 :       CRTYP  26 24 :       CRV540  9 25 :       
CRV7    2 36 :       CRVA    2 37 :       CRVB    2 38 :       CRVX    2 39 :       
CSTR    7 26 :       CSW     1 33 :       CT0    44 37 :       CT1    45 16 :       
CT2    45 37 :       CY1    18 24 :       CY1A   18 36 :       CY2    18 38 :       
CY3    19 17 :       CY4    19 25 :       DBF    55  5 :       DC     46  5 :       
DC1    46 22 :       DC2    46 23 :       DC9     7 14 :       DCA     7 13 :       
DEE     1 37 :       DIR    53 21 :       DM     12 16 :       DM1A   12 26 :       
DM1B   13  5 :       DM1C   13 12 :       DM1D   13 13 :       DM1TS1 13  7 :       
DM1TS2 13  8 :       DM1TS3 13  9 :       DM1TS4 13 11 :       DM2    13 15 :       
DM2A   13 17 :       DM3    13 25 :       DM3A   13 28 :       DM3B   13 31 :       
DM3C   14 13 :       DM3D   14 14 :       DM4    14 16 :       DM4A   14 19 :       
DM4B   14 20 :       DM4C   14 25 :       DM4D   14 26 :       DM5    14 37 :       
DM5A   15  1 :       DM5B   15  4 :       DM6    15 10 :       DMS    12  3 :       
DMS1   12  4 :       DRQ     5  9 :       DRQU    5 10 :       DV     51 21 :       
DV1    51 25 :       DV2    51 29 :       E1     35 29 :       E2     36  4 :       
E3     36  8 :       EBIT    8 31 :       EBLST  44 33 :       ECBF2  55  4 :       
ECHO    7 34 :       EET    55  8 :       EIR    53 22 :       ELIST  54 12 :       
ELIT    8 33 :       EPDS   53 14 :       EPURE  53  9 :       EQ0    31  5 :       
EQ1    31  4 :       EQ2    31  3 :       EQ9     7 12 :       ERCT    4 28 :       
ERRORS 35 24 :       ES1    24 37 :       ES2    24 39 :       ESCAPE 24 34 :       
ESCSW   5 24 :       EST    50  2 :       EV1    26  2 :       EV2    26  4 :       
EV3    26  9 :       EV7     7  4 :       EV8A   26 18 :       EV8B   26 19 :       
EV9     7  1 :       EVAL   25 38 :       EVFLG   7  3 :       EVSIGN  7  2 :       
EVTOT   6 39 :       F520    2 19 :       FCP     8  9 :       FL      4  9 :       
FLG    54 21 :       FORMAT 40 12 :       FR0    40 22 :       FR1    40 26 :       
FR1A   40 23 :       FR2    40 30 :       FR3    40 38 :       FR3A   40 37 :       
FR3B   41  1 :       FR4    41  2 :       FR7    41  4 :       FR8    41  5 :       
FR9    41  7 :       FSK     8 10 :       FT     39  1 :       FT1    39  5 :       
FT1A   39  6 :       FT2    39 10 :       FT8     5 27 :       FT9     3  2 :       
FT9A    5 28 :       FTIC    8 21 :       FU1    28  1 :       FU2    28  2 :       
FU3    28  3 :       FU4    28  8 :       FUA     7 10 :       FUB     7 11 :       
FULTYP 27 33 :       GETL   50 36 :       GIO    15 37 :       GIVEL  51  6 :       
GIVEL1 51  7 :       GIVEL2 51 11 :       GLOK   51 14 :       GPW    28 18 :       
GPW1   28 21 :       GPWM   28 27 :       GS7     6 11 :       GS8     6 10 :       
GS8A   20 27 :       GS9     6  9 :       GS9A   20 26 :       GSB     6  8 :       
GSI    20 11 :       GSI8   20 29 :       H      53  8 :       H1     53  3 :       
HA     53 11 :       HB     53 12 :       HPTR    3  1 :       I24    53 30 :       
IC0    23 34 :       IC1    23 37 :       IC2    23 39 :       IC3    24  3 :       
IC4    24  4 :       IC9     6 38 :       ICA     6 36 :       ICX     6 37 :       
IDE     2 13 :       INRFLG 12 30 :       INT203  4 36 :       IOC     6  1 :       
IODMS  34 33 :       ISC    23 23 :       ISCSW   7 20 :       ISWTCH  5 18 :       
IZ     11 25 :       JAB8    3 10 :       JAB9    3  9 :       JANBZ   1 28 :       
JANXZ   1 29 :       JAPBZ   1 26 :       JAPXZ   1 27 :       JAZBZ   1 25 :       
JCL9    3 13 :       JCL91   3 14 :       JDOT    3 19 :       JKM9    3 15 :       
JT      3 12 :       JVAL    3 20 :       JVAL1   5 14 :       JVG8    3 11 :       
K0     50  9 :       K1     50 10 :       K2     50 13 :       K3     50 23 :       
K4     50 27 :       K4A    50 30 :       KADR    3 16 :       KAREA1 53 36 :       
KAREA2 53 38 :       KC1     7 30 :       KC2     7 31 :       KDOT    7 37 :       
KEY     4 39 :       KH      7 29 :       KL      7 28 :       KSTOP  56  6 :       
KTP1    7 32 :       KTP2    7 33 :       L      52 36 :       L1     52 35 :       
L2A    30 37 :       LDBDRQ 14 35 :       LF0    31 16 :       LF1    31 15 :       
LF2    31 14 :       LI     52 38 :       LIN    46  9 :       LIST   54 11 :       
LL     55 34 :       LOK     4 37 :       LOOK0  30 31 :       LOOK1  30 32 :       
LOOK1A 30 33 :       LOOK2  30 34 :       LTEMP  56 23 :       M540    4 35 :       
MAYDMS 12  9 :       MB      5  7 :       MBC    40  6 :       MC1    41 25 :       
MC1A   42  1 :       MC2    41 38 :       MC2A   42  2 :       MC3    42  3 :       
MC4     5 32 :       MC540   5 30 :       MC6    42  4 :       MC7    42  5 :       
MCADR   5 29 :       MCDATA  5 31 :       MICT   41 19 :       MIN    46 12 :       
MRESET 35 22 :       MS     53 16 :       MS1    52 20 :       MS2    52 21 :       
MS3    52 24 :       MSIZE   1 23 :       MSX    52 25 :       N540    4 34 :       
NBIT    1 24 :       ND9     6 31 :       NDA     6 28 :       NDB     6 29 :       
NDX     6 30 :       NGN     4 38 :       NUM    46 15 :       OFC    35 21 :       
ONC    35 16 :       ONV    35 17 :       OPEN    7 18 :       OSWTCH  5 19 :       
OTH    46 17 :       OUT540  5  3 :       PAC    54 16 :       PC     36 19 :       
PC1    36 25 :       PC2    36 34 :       PCIO   36 36 :       PDS    53 13 :       
PER    46 13 :       PET     4 30 :       PET7    3  3 :       PF     28 16 :       
PFC     5  4 :       PI     53 34 :       PLU    46 11 :       PNC     5  5 :       
POFF    2 31 :       PON    53 24 :       PP     54 25 :       PP540  15 13 :       
PP540A 15 17 :       PP540B 15 26 :       PP540C 15 22 :       PP540D 15 23 :       
PPIBR  34 36 :       PS1    29 37 :       PS2    29 39 :       PSA    30  2 :       
PSB    30  5 :       PSC    30  9 :       PSD    30 10 :       PSR    30 13 :       
PTCH   55 11 :       PURE    8 26 :       PW     29 38 :       PW5     7 36 :       
PWT    29  2 :       PWTIME  7 35 :       PWU    29  9 :       QUES   29 20 :       
R540   52  2 :       R540A  52  4 :       R540B  52  5 :       R540C  52 10 :       
R540D  52 11 :       RANBIT  5 37 :       RB     36 39 :       RC      5  6 :       
RCPC   41  9 :       RCPC0  41 11 :       RCPC1  41 12 :       RD      2 11 :       
REC    54 18 :       RECAL   2 10 :       RESET  35 20 :       RG     51 31 :       
RG1     5 25 :       RG2     5 26 :       RGP     3  4 :       RGTAB   5 38 :       
ROC    24 21 :       ROC1   24 23 :       ROC2   24 26 :       RQ1     5 11 :       
RQ2     5 13 :       RQ2A    5 12 :       RS     24  7 :       RS1    24  9 :       
RS2    24 14 :       RS9     7  8 :       RSB     7  7 :       RSMASK  7 15 :       
RST    25  2 :       RST1   25  3 :       RST2   25  4 :       RSTE   36 12 :       
RT     37  7 :       RTA    37 16 :       RTB    37 24 :       RTC     5 36 :       
RTD    37 28 :       RTE1   38 24 :       RTG    38  1 :       RTGER  38 10 :       
RTK    38  5 :       RTK1   38  9 :       RTK3   38 11 :       RTK4   38 15 :       
RTK5   38 17 :       RTR    38 18 :       RTR1   38 21 :       RTR2   38 22 :       
RTS    38 23 :       RUN1   35 14 :       S1     35 18 :       S2     35 19 :       
SC1    23  7 :       SC2    23 11 :       SC3    23 16 :       SC8     6 34 :       
SC8A   23 19 :       SC8B   23 20 :       SC9     6 32 :       SCMASK  6 33 :       
SCTOT   6 35 :       SE0    32  7 :       SE1    32 10 :       SE2    32  9 :       
SEMI1   3 34 :       SEMI2   3 35 :       SEMIA   3 31 :       SEMIB   3 32 :       
SEMIG  32 17 :       SEMIL  32 12 :       SEMIM   3 36 :       SEMIRV 32 14 :       
SEMIW  31 32 :       SEMIW2 31 31 :       SEMIX   3 33 :       SENBYT  7  5 :       
SETCM  29 25 :       SFM     2  6 :       SG1    22  3 :       SG2    22  8 :       
SG3    22 12 :       SG4    22 16 :       SG5    22 17 :       SG9     6 25 :       
SGA     6 23 :       SGX     6 24 :       SH      2  4 :       SIC    23  3 :       
SK      2  3 :       SKBAD  55  6 :       SKBAD7  3  6 :       SKP     2 17 :       
SLASH0 30 27 :       SLASH1 30 28 :       SLASH2 30 29 :       SLF0   30 18 :       
SLF2   30 20 :       SLI     2 16 :       SNGN   36 16 :       SNS     2  5 :       
SNSIO  16  6 :       SRV     3 30 :       SS3    21 26 :       SS4    21 32 :       
SS6     6 22 :       SS7     6 21 :       SS8     6 20 :       SS9     6 19 :       
SSB     6 17 :       SSE    21 20 :       SSLSH1 29 34 :       SSLSH2 29 33 :       
SSLSHA 29 35 :       SSX     6 18 :       ST     47 23 :       STAPWT 28 29 :       
STAT   28 30 :       STAUP6  9  2 :       STAW1  51 22 :       STBPET 36 14 :       
STMODE 32  5 :       STOP   35 15 :       SUBSTR  7  6 :       SW2    31 34 :       
SW2A   31 37 :       SW4    32  1 :       SW5    32  3 :       SW5A   32  4 :       
SW8     7 24 :       SW9     7 16 :       SYG    21 36 :       SZ0    31 22 :       
SZ1    31 23 :       SZ2    31 24 :       SZ2A   31 26 :       T1      3 21 :       
T2      3 22 :       T3      3 23 :       T4      3 24 :       T540A  27 24 :       
T540B  27 27 :       TA     55 28 :       TBF    54 36 :       TD1    38 29 :       
TD2    38 30 :       TD3    38 32 :       TD4    38 33 :       TD5    38 35 :       
TDI    38 26 :       TEMP    7 27 :       TEMP2  26 21 :       TI     53 32 :       
TIC     2 18 :       TIM540  5  8 :       TIMEH   4 12 :       TIMEHH  4 13 :       
TIMEL   4 11 :       TL     54  2 :       TLDDT  54  7 :       TMODE   7 19 :       
TP      3 18 :       TY1     5 33 :       TY2     5 34 :       TY3     5 35 :       
TY8    42  7 :       TY8A   42 10 :       TYP540 27 23 :       TYPEOK 28 39 :       
UCK     1 38 :       UP     32 38 :       UP1    33  4 :       UP2    33  9 :       
UP3    33 16 :       UP3A   33 29 :       UP4    33 31 :       UP4A   33 36 :       
UP4B   34 10 :       UP4C   34 19 :       UP4D   34 24 :       UP540   4 10 :       
UPER    4 32 :       UPH     4 29 :       UPIOER 34 39 :       UPL     4 31 :       
UPMS1  35  5 :       UPMS2  35  6 :       UPMS3  35  7 :       UPMS4  35  8 :       
UPMS5  35  9 :       UPMS6  35 10 :       UPMS7  35 11 :       UPMS8  35 12 :       
UPN540  4 33 :       UPP     3 17 :       UPTAB  54 27 :       UPX    35  1 :       
VAG    22 20 :       VALB    7 21 :       VALB1   7 22 :       VALC    7 23 :       
VERS   32 26 :       VG1    22 26 :       VG2    22 30 :       VG3    22 31 :       
VG4    22 33 :       VG5    22 34 :       VG6    22 37 :       VG7    23  1 :       
VG9     6 27 :       VGX     6 26 :       VNUM   32 25 :       VNUM7   3  7 :       
VPW    28 32 :       VPW1   28 35 :       VSTR   32 24 :       W1      3 38 :       
W2      3 39 :       W3      4  1 :       W4      4  2 :       W5      4  3 :       
W540   52 13 :       W6      4  4 :       W7      4  5 :       W8      4  6 :       
WCA     4 24 :       WCC     4 25 :       WCH     4 22 :       WCKD    2  9 :       
WD      2 12 :       WE     32 34 :       WE1    32 35 :       WFLG    4 27 :       
WHA     2  7 :       WIO    16  3 :       WMEM    4 26 :       WP     32 32 :       
WP1     4  7 :       WPAC    4 21 :       WR0     2  8 :       WREC    4 23 :       
WS     24 16 :       WS1    24 18 :       WS5     6  7 :       WS6     6  6 :       
WS7     6  5 :       WS7A   20  9 :       WS8     6  4 :       WS9     6  3 :       
WS9A   20  8 :       WSA     5 15 :       WSB     6  2 :       WSI    19 31 :       
WSI8   20 33 :       WT     39 12 :       WT1    39 15 :       WT2    39 21 :       
WT2A   39 30 :       WT2B   39 31 :       WT3    39 34 :       WT4    39 39 :       
WT4A   40  1 :       WT4B   40  2 :       WT4C   40  4 :       WTCP    7 39 :       
WTIDE   8  3 :       WTNOP   8  6 :       WTSK    8  2 :       WTTIC   8  5 :       
X0     47  7 :       XE     47  8 :       XIBR   22  9 :       XIXR   25 31 :       
XN     47  9 :       XTZA   14 18 :       XTZB   20 20 :       XW     47 10 :       
Y0     47 11 :       YAS9   21  6 :       YBL9   26 30 :       YC     47 12 :       
YCHRT  46 24 :       YCT     7 25 :       YEV9   26 17 :       YK     47 13 :       
YQS9   29 23 :       YR     47 14 :       YSC9   23 18 :       YSCTOT 23 21 :       
YSS8   21 34 :       YSS9   21 33 :       YSUBST 26 16 :       YTEMP2 26 22 :       
YY     47 15 :       Z0     47 16 :       ZB     47 17 :       ZH     47 18 :       
ZN     47 19 :       ZT     47 20 :       ZZ     47 21 :       
DIM ** FICHE/FRAME BREAK *****
MAKEDIM
COP DIMDUALVER14,DIM

GO 6A8
DIM
 BDIM

RES
XDDT
0;TBDIM
%F
SAVE 0 TO 17777 ON CDIM

DUMP STNDIM

GO GDMPDIM
CDIM
DIM/DIM-14/

CHECKSUM
.
DIMDUALVER14-SOURCE-FILE
DIM/DIM-14/-GO-FILE
MAKEDIM-COMMANDS-FILE
.
COM TEL
   = ^