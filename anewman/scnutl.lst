SCAN -- A COMMAND SCANNER UTILITY MODULE.	MACRO %53B(1156)-1 10:57 24-Oct-83 Page 1
SCNUTL	MAC	10-Jun-72 17:54	

     1					00020	TITLE SCAN -- A COMMAND SCANNER UTILITY MODULE.
     2					00040	
     3			000017		00060	P==17
     4			000001		00080	T1==1
     5			000002		00100	T2==2
     6			000003		00120	T3==3
     7			000004		00140	T4==4
     8			000005		00160	T5==5
     9			000006		00180	C==6
    10			000016		00200	FL==16
    11			000012		00220	RADIX==^D10
    12					00240	INTERNAL CMDLP
    13					00260	EXTERNAL GORUN
    14	000000'				00280	CMDLP:	OUTSTR [ASCIZ /
    15	000000'	051 03 0 00 000174'	00300	*/]
    16	000001'	402 00 0 00 000172'	00320		SETZM SAVCHR#
    17	000002'	260 17 0 00 000024'	00340		PUSHJ P,SCAN
    18	000003'	606 16 0 00 000004 	00360		TRNN FL,IDENT
    19	000004'	254 00 0 00 000017'	00380		JRST TRMLOK
    20	000005'	200 04 0 00 000175'	00400		MOVE T4,[-CMDLEN,,CMDTAB]
    21	000006'	260 17 0 00 000101'	00420		PUSHJ P,CMDSRC
    22	000007'	254 00 0 00 000021'	00440		 JRST TYPHLP
    23	000010'	256 00 0 03 000127'	00460		XCT CMDDSP(T3)	;FOUND COMMAND
    24	000011'	260 17 0 00 000013'	00480	CMDDON:	PUSHJ P,WTLF
    25	000012'	254 00 0 00 000000'	00500		JRST CMDLP
    26					00520	
    27	000013'	306 06 0 00 000012 	00540	WTLF:	CAIN C,12
    28	000014'	263 17 0 00 000000 	00560		POPJ P,
    29	000015'	051 04 0 00 000006 	00580		INCHWL C
    30	000016'	254 00 0 00 000013'	00600		JRST WTLF
    31					00620	
    32	000017'	602 16 0 00 000002 	00640	TRMLOK:	TRNE FL,TERMF
    33	000020'	254 00 0 00 000011'	00660		JRST CMDDON
    34	000021'	260 17 0 00 000013'	00680	TYPHLP:	PUSHJ P,WTLF
    35	000022'	051 03 0 00 000176'	00700		OUTSTR [ASCIZ /TYPE HELP FOR HELP/]
    36	000023'	254 00 0 00 000000'	00720		JRST CMDLP
    37

SCAN -- A COMMAND SCANNER UTILITY MODULE.	MACRO %53B(1156)-1 10:57 24-Oct-83 Page 2
SCNUTL	MAC	10-Jun-72 17:54	

    38			000001		00020	NUMF==1
    39			000002		00040	TERMF==2
    40			000004		00060	IDENT==4
    41					00080	
    42	000024'	620 16 0 00 000007 	00100	SCAN:	TRZ FL,NUMF!TERMF!IDENT
    43	000025'	336 06 0 00 000172'	00120		SKIPN C,SAVCHR
    44	000026'	051 04 0 00 000006 	00140	SKPSP:	INCHWL C
    45	000027'	306 06 0 00 000040 	00160		CAIN C," "
    46	000030'	254 00 0 00 000026'	00180		JRST SKPSP
    47	000031'	307 06 0 00 000071 	00200		CAIG C,"9"
    48	000032'	305 06 0 00 000060 	00220		CAIGE C,"0"
    49	000033'	254 00 0 00 000047'	00240		JRST IDNCHK
    50	000034'	201 01 0 00 000000 	00260		MOVEI T1,0
    51	000035'	220 01 0 00 000012 	00280	NUMIN:	IMUL T1,RADIX
    52	000036'	271 01 0 06 777720 	00300		ADDI T1,-"0"(C)
    53	000037'	051 04 0 00 000006 	00320		INCHWL C
    54	000040'	307 06 0 00 000071 	00340		CAIG C,"9"
    55	000041'	305 06 0 00 000060 	00360		CAIGE C,"0"
    56	000042'	334 00 0 00 000000 	00380		SKIPA
    57	000043'	254 00 0 00 000035'	00400		JRST NUMIN
    58	000044'	202 06 0 00 000172'	00420		MOVEM C,SAVCHR
    59	000045'	660 16 0 00 000001 	00440		TRO FL,NUMF
    60	000046'	263 17 0 00 000000 	00460		POPJ P,
    61					00480	
    62	000047'	301 06 0 00 000140 	00500	IDNCHK:	CAIL C,140
    63	000050'	275 06 0 00 000040 	00520		SUBI C,40
    64	000051'	307 06 0 00 000132 	00540		CAIG C,"Z"
    65	000052'	305 06 0 00 000101 	00560		CAIGE C,"A"
    66	000053'	254 00 0 00 000075'	00580		JRST TRMCHK
    67	000054'	200 01 0 00 000202'	00600		MOVE T1,[POINT 6,ACCUM]
    68	000055'	402 00 0 00 000171'	00620		SETZM ACCUM#
    69	000056'	275 06 0 00 000040 	00640	LETIN:	SUBI C,40
    70	000057'	603 01 0 00 770000 	00660		TLNE T1,770000
    71	000060'	136 06 0 00 000001 	00680		IDPB C,T1
    72	000061'	051 04 0 00 000006 	00700		INCHWL C
    73	000062'	307 06 0 00 000132 	00720		CAIG C,"Z"
    74	000063'	305 06 0 00 000101 	00740		CAIGE C,"A"
    75	000064'	334 00 0 00 000000 	00760		SKIPA
    76	000065'	254 00 0 00 000056'	00780		JRST LETIN
    77	000066'	307 06 0 00 000071 	00800		CAIG C,"9"
    78	000067'	305 06 0 00 000060 	00820		CAIGE C,"0"
    79	000070'	334 00 0 00 000000 	00840		SKIPA
    80	000071'	254 00 0 00 000056'	00860		JRST LETIN
    81	000072'	202 06 0 00 000172'	00880		MOVEM C,SAVCHR
    82	000073'	660 16 0 00 000004 	00900		TRO FL,IDENT
    83	000074'	263 17 0 00 000000 	00920		POPJ P,
    84					00940	
    85	000075'	306 06 0 00 000015 	00960	TRMCHK:	CAIN C,15
    86	000076'	660 16 0 00 000002 	00980		TRO FL,TERMF
    87	000077'	402 00 0 00 000172'	01000		SETZM SAVCHR
    88	000100'	263 17 0 00 000000 	01020		POPJ P,
    89

SCAN -- A COMMAND SCANNER UTILITY MODULE.	MACRO %53B(1156)-1 10:57 24-Oct-83 Page 3
SCNUTL	MAC	10-Jun-72 17:54	

    90	000101'	200 01 0 00 000171'	00020	CMDSRC:	MOVE T1,ACCUM
    91	000102'	260 17 0 00 000161'	00040		PUSHJ P,MAKMSK
    92	000103'	510 03 0 00 000004 	00060	MSKDON:	HLLZ T3,T4
    93	000104'	505 04 0 00 000003 	00080		HRLI T4,T3
    94	000105'	202 04 0 00 000173'	00100		MOVEM T4,SRCPTR#
    95	000106'	201 04 0 00 000000 	00120		MOVEI T4,0
    96	000107'	316 01 1 00 000173'	00140	CMDSR0:	CAMN T1,@SRCPTR
    97	000110'	254 00 0 00 000122'	00160		JRST CPOPJ1
    98	000111'	200 05 1 00 000173'	00180		MOVE T5,@SRCPTR
    99	000112'	404 05 0 00 000002 	00200		AND T5,T2
   100	000113'	312 01 0 00 000005 	00220		CAME T1,T5
   101	000114'	254 00 0 00 000117'	00240		JRST CMDSR1
   102	000115'	326 04 0 00 000123'	00260		JUMPN T4,CPOPJ
   103	000116'	200 04 0 00 000003 	00280		MOVE T4,T3
   104	000117'	253 03 0 00 000107'	00300	CMDSR1:	AOBJN T3,CMDSR0
   105	000120'	322 04 0 00 000123'	00320		JUMPE T4,CPOPJ
   106	000121'	200 03 0 00 000004 	00340		MOVE T3,T4
   107	000122'	350 00 0 17 000000 	00360	CPOPJ1:	AOS (P)
   108	000123'	263 17 0 00 000000 	00380	CPOPJ:	POPJ P,
   109

SCAN -- A COMMAND SCANNER UTILITY MODULE.	MACRO %53B(1156)-1 10:57 24-Oct-83 Page 4
SCNUTL	MAC	10-Jun-72 17:54	

   110					00020		DEFINE CMDS
   111					00040	<	X HELP,<PUSHJ P,DOHLP>
   112					00060		X RUN,<JRST DORUN>
   113					00080		X QUIT,<JRST DOEXIT>
   114					00100	>
   115					00120	
   116					00140		DEFINE X (A,B)
   117					00160	<	<SIXBIT /A/>>
   118					00180	
   119	000124'	504554	600000		00200	CMDTAB:	CMDS^	X HELP,<PUSHJ P,DOHLP>^	<SIXBIT /HELP/>^
   120	000125'	626556	000000				X RUN,<JRST DORUN>^	<SIXBIT /RUN/>^
   121	000126'	616551	640000				X QUIT,<JRST DOEXIT>^	<SIXBIT /QUIT/>^
   122			000003		00220	CMDLEN==.-CMDTAB
   123					00240	
   124					00260		DEFINE X(A,B)
   125					00280	<	B>
   126					00300	
   127	000127'	260 17 0 00 000132'	00320	CMDDSP:	CMDS^	X HELP,<PUSHJ P,DOHLP>^	PUSHJ P,DOHLP^
   128	000130'	254 00 0 00 000136'			X RUN,<JRST DORUN>^	JRST DORUN^
   129	000131'	254 00 0 00 000140'			X QUIT,<JRST DOEXIT>^	JRST DOEXIT^
   130					00340	
   131	000132'	260 17 0 00 000013'	00360	DOHLP:	PUSHJ P,WTLF
   132	000133'	051 03 0 00 000142'	00380		OUTSTR HLPMS
   133	000134'	263 17 0 00 000000 	00400		POPJ P,
   134					00420	
   135	000135'	260 17 0 00 000013'	00440	DEV278:	PUSHJ P,WTLF
   136	000136'	260 17 0 00 000013'	00460	DORUN:	PUSHJ P,WTLF
   137	000137'	254 00 0 00 000000*	00480		JRST GORUN
   138					00500	
   139	000140'	260 17 0 00 000013'	00520	DOEXIT:	PUSHJ P,WTLF
   140	000141'	047 00 0 00 000012 	00540		EXIT
   141					00560	
   142	000142'				00580	HLPMS:	ASCIZ /
   143	000142'	015 012 103 117 115 	00600	COMMANDS ARE:
   144	000143'	115 101 116 104 123 
   145	000144'	040 101 122 105 072 
   146					00620	
   147	000145'	015 012 015 012 110 	00640	HELP	TYPES THIS LIST
   148	000146'	105 114 120 011 124 
   149	000147'	131 120 105 123 040 
   150	000150'	124 110 111 123 040 
   151	000151'	114 111 123 124 015 
   152	000152'	012 122 125 116 011 	00660	RUN	INITIATES INPUT
   153	000153'	111 116 111 124 111 
   154	000154'	101 124 105 123 040 
   155	000155'	111 116 120 125 124 
   156	000156'	015 012 121 125 111 	00680	QUIT	QUIT
   157	000157'	124 011 121 125 111 
   158	000160'	124 015 012 000 000 	00700	/
   159

SCAN -- A COMMAND SCANNER UTILITY MODULE.	MACRO %53B(1156)-1 10:57 24-Oct-83 Page 5
SCNUTL	MAC	10-Jun-72 17:54	

   160	000161'	201 02 0 00 000000 	00020	MAKMSK:	MOVEI T2,0
   161	000162'	205 03 0 00 770000 	00040		MOVSI T3,770000
   162	000163'	616 01 0 00 000003 	00060	MAKMS1:	TDNN T1,T3
   163	000164'	263 17 0 00 000000 	00080		POPJ P,	;DONE
   164	000165'	434 02 0 00 000003 	00100		IOR T2,T3
   165	000166'	242 03 0 00 777772 	00120		LSH T3,-6
   166	000167'	326 03 0 00 000163'	00140		JUMPN T3,MAKMS1
   167	000170'	263 17 0 00 000000 	00160		POPJ P,
   168					00180	
   169					00200	END

NO ERRORS DETECTED

PROGRAM BREAK IS 000203
CPU TIME USED 00:06.521

10P CORE USED
SCAN -- A COMMAND SCANNER UTILITY MODULE.	MACRO %53B(1156)-1 10:57 24-Oct-83 Page S-1
SCNUTL	MAC	10-Jun-72 17:54		SYMBOL TABLE

ACCUM		000171'		
C		000006	spd	
CMDDON		000011'		
CMDDSP		000127'		
CMDLEN		000003	spd	
CMDLP		000000'	int	
CMDSR0		000107'		
CMDSR1		000117'		
CMDSRC		000101'		
CMDTAB		000124'		
CPOPJ		000123'		
CPOPJ1		000122'		
DEV278		000135'		
DOEXIT		000140'		
DOHLP		000132'		
DORUN		000136'		
EXIT	047000	000012		
FL		000016	spd	
GORUN		000137'	ext	
HLPMS		000142'		
IDENT		000004	spd	
IDNCHK		000047'		
INCHWL	051200	000000		
LETIN		000056'		
MAKMS1		000163'		
MAKMSK		000161'		
MSKDON		000103'		
NUMF		000001	spd	
NUMIN		000035'		
OUTSTR	051140	000000		
P		000017	spd	
RADIX		000012	spd	
SAVCHR		000172'		
SCAN		000024'		
SKPSP		000026'		
SRCPTR		000173'		
T1		000001	spd	
T2		000002	spd	
T3		000003	spd	
T4		000004	spd	
T5		000005	spd	
TERMF		000002	spd	
TRMCHK		000075'		
TRMLOK		000017'		
TYPHLP		000021'		
WTLF		000013'		


SCAN -- A COMMAND SCANNER UTILITY MODULE.	MACRO %53B(1156)-1 10:57 24-Oct-83 Page 1
SCNUTL	MAC	10-Jun-72 17:54	


Symbol cross reference

ACCUM	    67	    68#	    68	    90
C	     9#	    27	    29	    43	    44	    45	    47	    48	    52	    53	    54	    55	    58	    62
	    63	    64	    65	    69	    71	    72	    73	    74	    77	    78	    81	    85
CMDDON	    24#	    33
CMDDSP	    23	   127#
CMDLEN	    20	   122#
CMDLP	    12	    14#	    25	    36
CMDSR0	    96#	   104
CMDSR1	   101	   104#
CMDSRC	    21	    90#
CMDTAB	    20	   119#	   122
CPOPJ	   102	   105	   108#
CPOPJ1	    97	   107#
DEV278	   135#
DOEXIT	   129	   139#
DOHLP	   127	   131#
DORUN	   128	   136#
FL	    10#	    18	    32	    42	    59	    82	    86
GORUN	    13#	   137
HLPMS	   132	   142#
IDENT	    18	    40#	    42	    82
IDNCHK	    49	    62#
LETIN	    69#	    76	    80
MAKMS1	   162#	   166
MAKMSK	    91	   160#
MSKDON	    92#
NUMF	    38#	    42	    59
NUMIN	    51#	    57
P	     3#	    17	    21	    24	    28	    34	    60	    83	    88	    91	   107	   108	   127	   131
	   133	   135	   136	   139	   163	   167
RADIX	    11#	    51
SAVCHR	    16#	    16	    43	    58	    81	    87
SCAN	    17	    42#
SKPSP	    44#	    46
SRCPTR	    94#	    94	    96	    98
T1	     4#	    50	    51	    52	    67	    70	    71	    90	    96	   100	   162
T2	     5#	    99	   160	   164
T3	     6#	    23	    92	    93	   103	   104	   106	   161	   162	   164	   165	   166
T4	     7#	    20	    92	    93	    94	    95	   102	   103	   105	   106
T5	     8#	    98	    99	   100
TERMF	    32	    39#	    42	    86
TRMCHK	    66	    85#
TRMLOK	    19	    32#
TYPHLP	    22	    34#
WTLF	    24	    27#	    30	    34	   131	   135	   136	   139
SCAN -- A COMMAND SCANNER UTILITY MODULE.	MACRO %53B(1156)-1 10:57 24-Oct-83 Page 1
SCNUTL	MAC	10-Jun-72 17:54	


Macro/Opdef cross reference

CMDS	   111#	   119	   127
EXIT	   140
INCHWL	    29	    44	    53	    72
OUTSTR	    14	    35	   132
X	   117#	   119	   120	   121	   125#	   127	   128	   129    