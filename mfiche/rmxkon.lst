RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 1
S.MAC	13-JAN-88 11:55		S.MAC - with system parameter file for P035/D, January 1988

     1				SUBTTL	S.MAC - with system parameter file for P035/D, January 1988
     2
     3				IF2,<IFNDEF LISTSN,<TAPE>>	;Skip to PASS2 in all but COMMON.LST
     4				;THIS MODULE ASSEMBLED WITH KS-10 PARAMETER FILE - KSSYM.MAC
     5
     6					IF2,<IFNDEF LISTSN,<		;LIST KSSYM.MAC IN COMMON ONLY
     7					.CREF
     8									TAPE>>
     9				; This file is PRINTF.MAC
    10				DEFINE PRINTF(A,B,C,D),<IF2,<;;Output message on MONKS build only
    11				PRINTX A B C D>>
    12
    13				SUBTTL KS-10 PARAMETER DEFINTIONS FOR PDP-10 MONITOR
    14				.XCREF
    15
    16				;THIS MODULE ASSEMBLED WITH KS-10 PARAMETER FILE - KSIORG.MAC
    17
    18					IF2,<IFNDEF LISTSN,<		;LIST KSIORG.MAC IN COMMON ONLY
    19					.CREF
    20									TAPE>>
    21				TITLE RMXKON - Driver for RM03 or RP06 disks on KS-2020
    22				SUBTTL RM03 DRIVER
    23
    24					STOPCD(,ENTRY,RMXKON)^
    25					ENTRY	RMXKON		;For library searches
    26	000000'	260040	000000*	RMXKON::PUSHJ	P,DIE		;**** Default stopcode for "RMXKON" ****
    27	000001'	625570	535756		SIXBIT	/RMXKON/  	;Title of module
    28	000002'	000000	000000		S$NONAME,,0		;?NONAME stopcode "RMXKON+nnn(nnnnnn)"
    29			000000'	S$NAME==RMXKON			;For STOPCDs with no arguments
    30					SALL>
    31				^
    32			000000		ND	FTDPAG,0	;Use UNIBLK instead of UNIPAG
    33
    34				;THIS HACK WRITTEN BY DANIEL S. BLOM
    35				;ASSEMBLE WITH KSSYM.MAC, WHICH SHOULD CONTAIN KS-10 I/O INSTRUCTION OPDEFS.
    36
    37				;DEPENDENCIES:
    38				;IN ORDER TO CLEAR THE RH11C CONTROLLER, A DRIVE WHICH DEFINATELY EXISTS
    39				; MUST BE SELECTED.  THIS CODE ASSUMES UNIT 0 ALWAYS EXIST.
    40
    41				EXTERN BITTBL,PIHIGH,PILOW,RMACB
    42				EXTERN UNIPPU,UNYPPY,UNYPUN,UNISVA,UNITWC,UNIOFS,UNIONC
    43				IFE FTDPAG,<EXTERN UNIBLK>		;Used to be UNIBLK
    44				IFN FTDPAG,<EXTERN UNIPAG>
    45				EXTERN UNYBPT,UNYBPY,UNICHR	;Blocks per track, blocks per cylinder
    46				EXTERN UNISBH,UNISB,UNISBS,SBSIZ
    47				EXTERN KCMOFL,%OFLER,%OFLRS,KONCUA
    48				EXTERN KCMDTA,KONPTR
    49				EXTERN KCMFUS,KCMERR,KCMRER
    50				EXTERN UNIRCT,UNPDEV,EPT,UNIDES,UNYUTP
    51				EXTERN UNYOCV,UNYRTO,UNYRCO,UNYOS,UNIRC1,UNISB
    52
    53				;BIT TABLE, LSB=INDEX 0
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 1
RMXKON.MAC	20-SEP-87 13:49		RM03 DRIVER

    54			000001	ZOT==1
    55	000003'			TIBTBL::
    56				REPEAT 44,<ZOT
    57				ZOT==ZOT+ZOT>
    58	000003'	000000	000001
    59	000004'	000000	000002
    60	000005'	000000	000004
    61	000006'	000000	000010
    62	000007'	000000	000020
    63	000010'	000000	000040
    64	000011'	000000	000100
    65	000012'	000000	000200
    66	000013'	000000	000400
    67	000014'	000000	001000
    68	000015'	000000	002000
    69	000016'	000000	004000
    70	000017'	000000	010000
    71	000020'	000000	020000
    72	000021'	000000	040000
    73	000022'	000000	100000
    74	000023'	000000	200000
    75	000024'	000000	400000
    76	000025'	000001	000000
    77	000026'	000002	000000
    78	000027'	000004	000000
    79	000030'	000010	000000
    80	000031'	000020	000000
    81	000032'	000040	000000
    82	000033'	000100	000000
    83	000034'	000200	000000
    84	000035'	000400	000000
    85	000036'	001000	000000
    86	000037'	002000	000000
    87	000040'	004000	000000
    88	000041'	010000	000000
    89	000042'	020000	000000
    90	000043'	040000	000000
    91	000044'	100000	000000
    92	000045'	200000	000000
    93	000046'	400000	000000
    94
    95				OPDEF CALL [PUSHJ P,]		;SUBROUTINE ENTRY/EXIT
    96				OPDEF RET [POPJ P,]
    97
    98				DEFINE FOO(BAR,ZORP,BAZ,S)
    99				<BAR'AD1: UA1,,BAR'ADR
   100				BAR'LOC=BAR'ADR
   101				>
   102
   103				;DEVICE REGISTER BIT ASSIGNMENTS.  SEE USER MANUAL FOR SEMANTICS.  NOTE
   104				; THAT THESE VALUES ARE ACTUALLY DEFINED IN KSSYM, REPEATED HERE FOR CLARITY.
   105	000047'	000001	776700	FOO (CS1,776700,<SC,TRE,MCPE,,DVA,PSEL,A17,A16,RDY,IE,F4,F3,F2,F1,F0,GO>)
   106				    ;FUNCTION CODES + GO BIT.
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 1-2
RMXKON.MAC	20-SEP-87 13:49		RM03 DRIVER

   107			000001		F.NO==   1	;No operation
   108					;        3	;Unload
   109			000005		F.SEEK== 5	;Seek
   110			000007		F.RECA== 7	;Recalibrate
   111			000011		F.DC==  11	;Drive clear
   112					;       13	;Release
   113			000015		F.OFFS==15	;Offset
   114					;       17	;Return to centerline
   115			000021		F.RIP== 21	;Read-in preset
   116			000023		F.PA==  23	;Pack acknowledge
   117					;       31	;Search
   118					;	51	;Write check data
   119					;	53	;Write check header and data
   120			000061		F.WD==  61	;Write data
   121					;	63	;Write header and data
   122			000071		F.RD==  71	;Read Data
   123					;	73	;Read header and data
   124	000050'	000001	776710	FOO (CS2,776710,<DLT,WOE,UPE,NED,NEM,PGE,MXF,MDPE,OR,IR,CLR,PAT,BAI,U2,U1,U0>)
   125	000051'	000001	776712	FOO (DS,776712,<ATA,ERR,PIP,MOL,WRL,LBT,PGM,DPR,DRY,VV,,,,,,OM>)
   126	000052'	000001	776702	FOO (WC,776702)
   127	000053'	000001	776716	FOO (AS,776716)
   128	000054'	000001	776714	FOO (ER1,776714,<DCK,UNS,OPI,DTE,WLE,IAE,AOE,HCRC,HCE,ECH,WCF,FER,PAR,RMR,ILR,ILF>)
   129	000055'	000001	776742	FOO (ER2,776742,<BSE,SKI,OPE,IVC,LSC,LBC,,,DVC,,,DPE>)
   130	000056'	000001	776744	FOO (EC1,776744)
   131	000057'	000001	776746	FOO (EC2,776746)
   132	000060'	000001	776704	FOO (BA,776704)
   133	000061'	000001	776732	FOO (OF,776732,<OFD>,200)
   134	000062'	000001	776720	FOO (LA,776720)
   135	000063'	000001	776706	FOO (DA,776706)
   136	000064'	000001	776734	FOO (DC,776734)
   137	000065'	000001	776726	FOO (DT,776726)
   138	000066'	000001	763000	FOO (PGR,763000,<REV,DIS,FST,VAL>,400000)
   139	000067'	000001	763100	UA1AD1:	UA1,,UBAADR
   140
   141				;DISK PARAMETER ARRAYS.  0=RM03, 1=RP06
   142	000070'	000000	000036	BPT:	EXP ^D30,	^D20		;BLOCKS PER TRACK
	000071'	000000	000024
   143	000072'	000000	000045	PPC:	EXP ^D37,	^D95		;PAGES PER CYLINDER
	000073'	000000	000137
   144	000074'	000000	073363	PPU:	EXP ^D37*^D823,	^D95*^D815	;PAGES PER UNIT
	000075'	000000	227161
   145			041624	USPR=^D17300	;MICROSECONDS PER REVOLUTION.
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 2
RMXKON.MAC	20-SEP-87 13:49		RM03 DRIVER

   146				;INTERFACE TO FILIO AND FRIENDS.
   147
   148				;INITIALIZE UNIT AND SET CAPACITY PARAMETERS IN UDB.
   149	000076'	205300	001000	RMXCPY::MOVSI	T1,(1B8)	;1 block per record
   150	000077'	202305	000000*		MOVEM	T1,UNICHR(U)	;Sign bit off = formatted in blocks
   151	000100'	712420	000065'		RDIO	T3,@DTAD1	;Get drive type
   152	000101'	405400	000002		ANDI	T3,2
   153	000102'	242400	777777		LSH	T3,-1
   154	000103'	137400	000000*		DPB	T3,UNYUTP	;0=RM03, 1=RP06
   155	000104'	200310	000072'		MOVE	T1,PPC(T3)
   156	000105'	137300	000000*		DPB	T1,UNYPPY	;Pages per cylinder
   157	000106'	200310	000074'		MOVE	T1,PPU(T3)
   158	000107'	202305	000000*		MOVEM	T1,UNIPPU(U)	;Pages per unit
   159	000110'	200310	000070'		MOVE	T1,BPT(T3)
   160	000111'	137300	000000*		DPB	T1,UNYBPT	;Blocks per track
   161	000112'	201440	000003		MOVEI	T4,3		;TRY TO GET DRIVE 3 TIMES
   162	000113'	201400	000040	CPY0:	MOVEI	T3,CS2CLR	;CLEAR CONTROLLER.  SELECTS UNIT 0.
   163	000114'	713420	000050'		WRIO	T3,@CS2AD1
   164	000115'	135300	000000*		LDB	T1,UNYPUN	;SELECT DRIVE
   165	000116'	713320	000050'		WRIO	T1,@CS2AD1
   166	000117'	712360	000051'		RDIO	T2,@DSAD1
   167	000120'	712320	000050'		RDIO	T1,@CS2AD1	;CHECK CONTROLLER
   168	000121'	201400	000040		MOVEI	T3,CS2CLR	;CLEAR CONTROLLER. NOTE SELECTS UNIT 0.
   169	000122'	713420	000050'		WRIO	T3,@CS2AD1
   170	000123'	606300	010000		TRNN	T1,CS2NED	;DRIVE THERE?
   171	000124'	254000	000132'		 JRST	CPY1		;YES
   172	000125'	334300	001001'		SKIPA	T1,[%OFLRS]	;Offline - no response
   173	000126'	201300	000000*	CPYERR:	 MOVEI	T1,%OFLER	;Offline - error
   174	000127'	202305	000000*		MOVEM	T1,UNIONC(U)	;Store %OFLRS or %OFLER
   175	000130'	205300	000000*	CPYER1:	MOVSI	T1,KCMOFL
   176	000131'	254000	000000*		JRST	FILINT##	;Tell FILIO drive is off line
   177
   178	000132'	606340	010000	CPY1:	TRNN	T2,DSMOL	;DRIVE ON LINE?
   179					 JRST	[SETZM UNIONC(U) ;Drive responds but is offline
   180	000133'	254000	001002'			 JRST  CPYER1]
   181	000134'	135300	000115*		LDB	T1,UNYPUN	;SELECT UNIT AGAIN.
   182	000135'	713320	000050'		WRIO	T1,@CS2AD1
   183	000136'	201300	000023		MOVEI	T1,F.PA		;TRY TO SET DSVV
   184	000137'	713320	000047'		WRIO	T1,@CS1AD1
   185	000140'	712360	000051'		RDIO	T2,@DSAD1
   186	000141'	602340	000100		TRNE	T2,DSVV		;VOLUME VALID?
   187	000142'	254000	000147'		 JRST	CPY2
   188	000143'	201300	000011		MOVEI	T1,F.DC		;DRIVE CLEAR
   189	000144'	713320	000047'		WRIO	T1,@CS1AD1
   190	000145'	367440	000113'		SOJG	T4,CPY0
   191	000146'	254000	000126'		JRST	CPYERR		;GIVE UP IF STILL BAD
   192
   193	000147'	205300	200000	CPY2:	MOVSI	T1,(1B1)
   194	000150'	602340	004000		TRNE	T2,DSWRL	;WRITE LOCKED?
   195	000151'	202305	000127*		 MOVEM	T1,UNIONC(U)	;YES, SET BIT
   196	000152'	602340	040000		TRNE	T2,DSERR	;ANY RANDOM ERRORS LEFT?
   197	000153'	254000	000126'		 JRST	CPYERR		;YES, SAY OFFLINE.
   198	000154'	135300	000134*		LDB	T1,UNYPUN
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 2-2
RMXKON.MAC	20-SEP-87 13:49		RM03 DRIVER

   199	000155'	200306	000000*		MOVE	T1,BITTBL(T1)
   200	000156'	254000	000131*		JRST	FILINT##	;Tell FILIO about interrupt done
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 3
RMXKON.MAC	20-SEP-87 13:49		RM03 DRIVER

   201				;SKIP IF CONTROLLER UP, SINGLE RETURN IF NOT.
   202	000157'	201300	000100	RMXUPA::MOVEI T1,UBAINI		;CLEAR UBA
   203	000160'	713320	000067'		WRIO T1,@UA1AD1
   204	000161'	201300	000000*		MOVEI T1,PIHIGH*10+PILOW	;RESET PIA.  SILLY HARDWARE CLEARS IT.
   205	000162'	713320	000067'		WRIO T1,@UA1AD1
   206	000163'	712320	000047'		RDIO T1,@CS1AD1
   207	000164'	350001	000000	CPOPJ1:	AOS (P)
   208	000165'	263040	000000	CPOPJ:	RET
   209
   210				;STOP HUNG CONTROLLER.  SINGLE RETURN IF OPERATION COULDN'T
   211				; BE RESTARTED, SKIP IF IT COULD.  CURRENTLY, ALWAYS SINGLE RETURNS.
   212	000166'	135300	000154*	RMXSTP::LDB T1,UNYPUN
   213	000167'	713320	000050'		WRIO T1,@CS2AD1
   214	000170'	201300	000111		MOVEI T1,F.DC+CS1IE
   215	000171'	713320	000047'		WRIO T1,@CS1AD1
   216	000172'	263040	000000		RET
   217
   218				;ISSUE RECALIBRATE (SAME EFFECT AS SEEK TO
   219				; CYLINDER 0, BUT DOESN'T USE SEEK CIRCUITRY).  SKIP IF COULD (ALWAYS SKIPS).
   220	000173'	135300	000166*	RMXRCL::LDB T1,UNYPUN
   221	000174'	713320	000050'		WRIO T1,@CS2AD1
   222	000175'	201300	000107		MOVEI T1,F.RECA+CS1IE
   223	000176'	713320	000047'		WRIO T1,@CS1AD1
   224	000177'	263040	000000		POPJ P,0			;JRST CPOPJ1 /GL 6-11-80
   225
   226				;Perform latency calculation for disk page number specified in T1.
   227				; The latency is the time required for the disk to rotate until the requested
   228				; page is under the heads.  The number of microseconds is returned in T1.
   229
   230	000200'			RMXLTM::
   231				IFN FTDPAG,<;T1 is page # to check for latency time
   232					LSH	T1,P2BLSH	;Convert page number to block number
   233				>
   234	000200'	474440	000000		SETO	T4,
   235	000201'	201400	000003		MOVEI	T3,3		;Try twice for constant
   236	000202'	200340	000011	LTM1:	MOVE	T2,T4
   237	000203'	712460	000062'		RDIO	T4,@LAAD1	;Read Look-Ahead register
   238	000204'	312340	000011		CAME	T2,T4
   239	000205'	367400	000202'		 SOJG	T3,LTM1
   240	000206'	242440	777772		LSH	T4,-6		;Keep only the block number
   241	000207'	135400	000000*		LDB	T3,UNYBPY
   242	000210'	230300	000010		IDIV	T1,T3		;Block within cylinder
   243	000211'	135300	000111*		LDB	T1,UNYBPT
   244	000212'	230340	000006		IDIV	T2,T1		;Block within track
   245	000213'	275411	000000		SUBI	T3,(T4)		;Delta blocks
   246	000214'	335000	000010		SKIPGE	T3
   247	000215'	270400	000006		 ADD	T3,T1		;Have to go around again
   248	000216'	221400	041624		IMULI	T3,USPR		;Microseconds per revolution
   249	000217'	200300	000010		MOVE	T1,T3
   250	000220'	263040	000000		RET			;Return time in T1
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 4
RMXKON.MAC	20-SEP-87 13:49		RM03 DRIVER

   251				;ENTER OFFSET MODE.  NOT YET IMPLEMENTED.
   252	000221'	400300	000000	RMXOFS::SETZ T1,		;ALWAYS CLEAR OFFSET MODE FOR NOW.
   253	000222'	254000	000233'		JRST RMXOF1
   254	000223'	135300	000173*		LDB T1,UNYPUN		;SELECT UNIT.
   255	000224'	713320	000050'		WRIO T1,@CS2AD1
   256	000225'	135300	000000*		LDB T1,UNYOCV
   257	000226'	322300	000233'		JUMPE T1,RMXOF1		;J-CLEAR OFFSET MODE.
   258	000227'	405300	000001		ANDI T1,1		;SET OFFSET DIRECTION.
   259	000230'	221300	000200		IMULI T1,OFOFD
   260	000231'	713320	000061'		WRIO T1,@OFAD1
   261	000232'	201300	000001		MOVEI T1,1		;SET OFFSET MODE.
   262	000233'	137300	000000*	RMXOF1:	DPB T1,UNYOS
   263	000234'	263040	000000		RET
   264
   265				;HERE FROM FILIO TO COPY REGISTERS INTO PERMANENT PLACE FOR HARD ERRORS
   266
   267	000235'	505305	000000*	RMXHRD::HRLI	T1,UNISB(U)	;GET SOURCE ADDRESS
   268	000236'	541305	000000*		HRRI	T1,UNISBH(U)	;GET WHERE THE REG DATA GOES
   269	000237'	251300	000000*		BLT	T1,UNISBH+SBSIZ-1 ;XFER THE DATA.
   270	000240'	263040	000000		POPJ	P,		;DONE.
   271
   272				;HERE TO COPY REGISTERS TO UNISBS FOR SOFT DATA, CALL FROM FILIO
   273	000241'	205345	000235*	RMXSFT::MOVSI	T2,UNISB(U)	;SOURCE
   274	000242'	541345	000000*		HRRI	T2,UNISBS(U)	;DEST
   275	000243'	251340	000000*		BLT	T2,UNISBS+SBSIZ-1 ;BLT THERE
   276	000244'	263040	000000		POPJ	P,		;AND RETURN.
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 5
RMXKON.MAC	20-SEP-87 13:49		RM03 DRIVER

   277				;THE NEXT THREE ROUTINES FORM THE BODY OF THE TRANSFER CODE.
   278				;RMXRED,RMXWRT INITIALIZE; RMXADD ATTEMPTS TO CONSOLIDATE MULTIPLE
   279				; TRANSFERS IN THE SAME DIRECTION TO OR FROM THE DISK;
   280				; RMXFIN STARTS THE TRANSFER UP.
   281				;THE TRANSFER WILL NOT CROSS A CYLINDER BOUNDARY.
   282				;THE ACS P1-P4 ARE PRESERVED BY FILIO OVER THE PSEUDO CO-ROUTINE CALLS,
   283				; AND ARE USED AS FOLLOWS:
   284				;   P1/ READ OR WRITE COMMAND AS APPROPRIATE
   285				;   P2/ RH: NUMBER OF PDP-10 WORDS ALREADY DECIDED TO TRANSFER.
   286				;           THIS IS USUALLY ALSO THE VIRTUAL ADDRESS OF THE START OF THE XFR.
   287				;       LH: PDP-10 PAGE OFFSET OF FIRST WORD TO BE TRANSFERRED. (USUALLY 0)
   288				;   P3/ NUMBER OF WORDS BEFORE END OF CYLINDER.
   289				;       THE ADD ROUTINE WILL NOT WRITE MORE THAN THIS NUMBER OF
   290				;       WORDS AT ONCE.
   291
   292	000245'	334600	001004'	RMXRED::SKIPA	P1,[F.RD+CS1IE]
   293	000246'	201600	000161	RMXWRT:: MOVEI	P1,F.WD+CS1IE	;WRITE instruction
   294	000247'	400640	000000		SETZ	P2,		;No offset from start of page
   295				IFE FTDPAG,<
   296	000250'	200305	000000*		MOVE	T1,UNIBLK(U)	;Disk block address for start of transfer
   297				>
   298				IFN FTDPAG,<
   299					MOVE	T1,UNIPAG(U)	;Disk page address for start of transfer
   300					LSH	T1,P2BLSH	;Convert to block number
   301				>
   302	000251'	135700	000207*		LDB	P3,UNYBPY	;Blocks per cylinder
   303	000252'	230300	000016		IDIV	T1,P3		;T1: CYLINDER, T2: FRACTION OF CYLINDER
   304	000253'	275707	000000		SUBI	P3,(T2)		;Blocks to end of cylinder
   305	000254'	242700	000007		LSH	P3,7		;P3: NUMBER OF WORDS TO END OF CYLINDER.
   306	000255'	303700	037000		CAILE	P3,37000	;31P MAX. BECAUSE OF WC REGISTER.
   307	000256'	201700	037000		 MOVEI	P3,37000
   308	000257'	135400	000223*		LDB	T3,UNYPUN	;UNIT USED FOR TRANSFER
   309	000260'	713420	000050'		WRIO	T3,@CS2AD1	;Select it
   310	000261'	135440	000211*		LDB	T4,UNYBPT	;Blocks per track
   311	000262'	230340	000011		IDIV	T2,T4		;T2: TRACK, T3: BLOCK
   312	000263'	137340	001005'		DPB	T2,[POINT 8,T3,27] ;8-bits track, 8-bits sector
   313	000264'	713420	000063'		WRIO	T3,@DAAD1	;Tell RH11 track and sector
   314	000265'	263040	000000		RET
   315
   316				;RMXADD can be called repeatedly to transfer contiguous disk pages to
   317				;scattered memory pages.  RMXFIN is called start this contiguous transfer
   318				;by giving the RH11 a single command.
   319
   320				;ADD TRANSFER OF T1 WORDS TO/FROM CORE ADDRESS IN T2.
   321				;TRANSFERS WHICH AREN'T EVEN MULTIPLES OF PAGES GOING TO
   322				; PAGE BOUNDARIES WILL BE DONE ONE AT A TIME.
   323				IFE FTDPAG,<;T1 and T2 both have words
   324	000266'	606300	000777	RMXADD::TRNN T1,777
   325	000267'	602340	000777		TRNE T2,777
   326	000270'	254000	000315'		 JRST ADDNPA		;NOT EVEN TRANSFER
   327				>
   328				IFN FTDPAG,<;Add transfer of T1 pages to/from memory page in T2.
   329				RMXADD::LSH	T1,P2WLSH	;# of words to transfer
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 5-2
RMXKON.MAC	20-SEP-87 13:49		RM03 DRIVER

   330				>
   331				;P2 has offset from start of page if not starting at a page boundry
   332	000271'	315700	000006	ADDEVN:	CAMGE	P3,T1		;More space than is actually left?
   333	000272'	334300	000016		 SKIPA	T1,P3		;No, only to end of cylinder
   334	000273'	350001	000000		  AOS	(P)		;Yes, set for skip return
   335	000274'	274700	000006		SUB	P3,T1		;Update # words to EOC
   336	000275'	135400	001006'		LDB	T3,[POINT 9,P2,26] ;Page number of offset (starts at 0)
   337	000276'	270640	000006		ADD	P2,T1		;Total words added so far
   338	000277'	242300	777767		LSH	T1,W2PLSH	;Convert back to # of pages to transfer
   339				IFE FTDPAG,<
   340	000300'	336000	000006		SKIPN	T1		;If ADDNPA is doing less than 1 page
   341	000301'	20100001		 MOVEI	T1,1		; map just that partial page
   342	000302'	200440	000007		MOVE	T4,T2		;PDP-10 ADR OF START OF THIS TRANSFER
   343	000303'	242340	777767		LSH	T2,W2PLSH	;KS10 physical memory page number
   344				>
   345				IFN FTDPAG,<
   346					MOVE	T4,T2		;PDP-10 ADR OF START OF THIS TRANSFER
   347					LSH	T4,P2WLSH	;Make word address (Why? T4 is not used)
   348				>
   349	000304'	213000	000006		MOVNS	T1		;Make AOBJN pointer
   350	000305'	504340	000006		HRL	T2,T1		; in T2
   351	000306'	270400	001007'		ADD	T3,[UA1,,PGRLOC];UNIBUS address of 1st paging RAM register
   352	000307'	201307	140000	ADDPLP:	MOVEI	T1,PGRFST+PGRVAL(T2)	;Set FAST+VALID+physical page #
   353	000310'	713320	000010		WRIO	T1,@T3		;So RH11 can address KS10 memory
   354	000311'	271400	000001		ADDI	T3,1		;Next paging RAM register
   355	000312'	271440	001000		ADDI	T4,1000
   356	000313'	253340	000307'		AOBJN	T2,ADDPLP
   357	000314'	263040	000000		RET			;Skip return if not at end of cylinder
   358
   359				IFE FTDPAG,<;Here if T1 or T2 is not at a page boundry
   360	000315'	200640	000007	ADDNPA:	MOVE	P2,T2		;Get the bits that will be lost via LSH -9
   361	000316'	405640	000777		ANDI	P2,777		; ...
   362	000317'	207000	000015		MOVSS	P2		;Put them in LH of P2
   363	000320'	260040	000271'		CALL	ADDEVN		;Do partial page transfer
   364	000321'	256000	000000'		 STOPCD			;End-of-Cylinder return - impossible
   365	000322'	263040	000000		RET			;Give non-skip return on partial page xfer
   366				>
   367
   368				;End of additions, start disk transfer
   369
   370	000323'	554300	000015	RMXFIN::HLRZ	T1,P2		;PDP-10 page offset of transfer (always 0)
   371	000324'	242300	000002		LSH	T1,2		;Convert to -11 offset
   372	000325'	405300	003777		ANDI	T1,3777		;Offset within -11 page (always 0)
   373	000326'	713320	000060'		WRIO	T1,@BAAD1	;Set base address
   374	000327'	202305	000000*		MOVEM	T1,UNISVA(U)	;Save starting virtual addr in case of error
   375	000330'	211655	000000		MOVNI	P2,(P2)		;Negative PDP-10 word count from RH of P2
   376	000331'	242640	000001		LSH	P2,1		;Negative PDP-11 word count (18-bit words)
   377	000332'	202645	000000*		MOVEM	P2,UNITWC(U)	;Save total word count in case of soft error
   378	000333'	713660	000052'		WRIO	P2,@WCAD1
   379	000334'	552242	000000*		HRRZM	U,KONCUA(J)	;Set UDB of transferring unit
   380	000335'	135340	000233*		LDB	T2,UNYOS	;Get bit for offset mode
   381	000336'	712320	000051'		RDIO	T1,@DSAD1
   382	000337'	660307	000000		TRO	T1,(T2)
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 5-3
RMXKON.MAC	20-SEP-87 13:49		RM03 DRIVER

   383	000340'	713320	000051'		WRIO	T1,@DSAD1	;Set or clear offset mode
   384	000341'	713620	000047'		WRIO	P1,@CS1AD1	;Start transfer (RD or WD)
   385	000342'	263040	000000		RET
   386
   387				;Position to cylinder
   388
   389	000343'	135300	000257*	RMXPOS::LDB	T1,UNYPUN	;Select unit
   390	000344'	713320	000050'		WRIO	T1,@CS2AD1
   391				IFE FTDPAG,<;FILIO gave us block #
   392	000345'	200305	000250*		MOVE	T1,UNIBLK(U)	;Disk block address
   393	000346'	135340	000251*		LDB	T2,UNYBPY	;Get blocks per cylinder
   394				>
   395				IFN FTDPAG,<;FILIO gave us page #
   396					MOVE	T1,UNIPAG(U)	;Disk page address
   397					LDB	T2,UNYPPY	;Get pages per cylinder
   398				>
   399	000347'	230300	000007		IDIV	T1,T2		;Get cylinder number
   400	000350'	713320	000064'		WRIO	T1,@DCAD1	;Set desired cylinder
   401	000351'	201300	000105		MOVEI	T1,F.SEEK+CS1IE
   402	000352'	713320	000047'		WRIO	T1,@CS1AD1	;Start seek
   403	000353'	263040	000000		RET
   404
   405				;INTERRUPT HANDLER.
   406				;ON ENTRY, ASSUMES J=KDB.  SETS U TO UDB OF TRANSFERRING
   407				; UNIT IF IT INTERRUPTED.
   408
   409				;ASSUMES:
   410				; INTR REQ <=> CS1.(SC & RDY) + (RDY 0-1 TRANSITION)
   411				; CS1.SC <=> CS1.(TRE + MCPE) + ATTN
   412				; CS1.TRE <=> ANY ERROR DURING TRANSFER
   413				; ATTN <=> (DS.ERR SET FOR ANY DRIVE) +
   414				;	 (POSITIONING DONE IN ANY DRIVE) +
   415				;	 (DS.MOL CHANGES STATE FOR ANY DRIVE)
   416				; DS.MOL STATE CHANGE <=> DS.VV=0
   417
   418	000354'			RM0INT::
   419	000354'	000000	000000	RMXINT::0			;JSR HERE ON DISK INTERRUPT
   420	000355'	702200	000676'		TBSAVE TBVRMX		;SAVE THE CURRENT VALUE OF THE TIME BASE
   421	000356'	202740	000717'		MOVEM 17,RMXSAV+17
   422	000357'	201740	000700'		MOVEI 17,RMXSAV
   423	000360'	251740	000716'		BLT 17,RMXSAV+16
   424	000361'	200040	000720'		MOVE P,RMXPDP
   425	000362'	201100	000000*		MOVEI J,RMACB
   426	000363'	403300	000017		SETZB T1,P4		;START WITH NO ERROR BITS SET IN T1
   427	000364'	336242	000334*		SKIPN U,KONCUA(J)
   428	000365'	474740	000000		 SETO P4,
   429	000366'	712460	000047'		RDIO T4,@CS1AD1
   430	000367'	602440	100000		TRNE T4,CS1SC		;SPECIAL CONDITION?
   431	000370'	260040	000420'		 CALL SCINT		;YES, PROCESS
   432	000371'	321740	000402'		JUMPL P4,INTDIS
   433				;HERE TO ACCOUNT FOR TRANSFER
   434	000372'	712460	000060'		RDIO T4,@BAAD1		;Unibus byte address
   435	000373'	274445	000327*		SUB T4,UNISVA(U)	;# of bytes transferred
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 5-4
RMXKON.MAC	20-SEP-87 13:49		RM03 DRIVER

   436				IFE FTDPAG,<;Tell FILINT number of blocks transfered
   437	000374'	622440	000777		TRZE T4,777		;Round up to 512 bytes (128 PDP-10 words)
   438	000375'	271440	001000		 ADDI T4,1000
   439	000376'	242440	777767		LSH T4,W2BLSH-2		;Convert bytes to blocks
   440				>
   441				IFN FTDPAG,<;Tell FILINT number of pages transfered
   442					TRZE T4,3777		;Round up to 2K bytes (512 PDP-10 words)
   443					 ADDI T4,4000
   444					LSH T4,W2PLSH-2		;Convert bytes to pages
   445				>
   446	000377'	541311	000000		HRRI T1,(T4)		;Set amount (block or page) in RH of T1
   447	000400'	641300	000000*		TLC T1,KCMDTA		;Tell FILINT this is a data transfer
   448	000401'	402002	000364*		SETZM KONCUA(J)		;REMEMBER CONTROLLER NO LONGER BUSY
   449	000402'	712460	000047'	INTDIS:	RDIO T4,@CS1AD1		;MAKE SURE IE SET AND ERRORS CLEAR
   450	000403'	400600	000000		SETZ P1,
   451	000404'	606440	000100		TRNN T4,CS1IE
   452	000405'	551600	000100		 HRRZI P1,CS1IE
   453	000406'	606440	060000		TRNN T4,CS1TRE+CS1MCPE
   454	000407'	435600	040000		 IORI P1,CS1TRE
   455	000410'	332000	000014		SKIPE P1
   456	000411'	713620	000047'		 WRIO P1,@CS1AD1
   457	000412'	332000	000006		SKIPE T1
   458	000413'	260040	000156*		 CALL FILINT##		;Tell FILIO how many pages transferred
   459	000414'	205740	000700'		MOVSI 17,RMXSAV
   460	000415'	251740	000017		BLT 17,17
   461	000416'	702600	000676'		TBSET TBVRMX		;RESET THE TIME BASE FOR CHARGING
   462	000417'	254520	000354'		JEN @RMXINT
   463
   464	000420'	606440	020000	SCINT:	TRNN T4,CS1MCPE
   465	000421'	602440	040000		 TRNE T4,CS1TRE
   466	000422'	260040	000477'		  CALL CONERR		;CONTROLLER OR TRANSFER ERROR
   467	000423'	400400	000000		SETZ T3,		;ATA BITS TO CLEAR
   468	000424'	712660	000053'		RDIO P2,@ASAD1
   469	000425'	322640	000446'	ATA1:	JUMPE P2,SCRET
   470	000426'	243640	000427'	ATA2:	JFFO P2,.+1
   471	000427'	211716	777735		MOVNI P3,-43(P3)	;RH=UNIT NUMBER
   472	000430'	336022	000000*		SKIPN @KONPTR(J)	;SYSTEM CONFIGURED TO HANDLE THIS UNIT?
   473	000431'	254000	000440'		 JRST ATADIS		;NO, SPURIOUS INTERRUPT
   474	000432'	713720	000050'		WRIO P3,@CS2AD1
   475	000433'	712620	000051'		RDIO P1,@DSAD1
   476	000434'	602600	040000		TRNE P1,DSERR		;DRIVE ERRORS?
   477	000435'	260040	000466'		 CALL DRVERR		;YES, JUST CLEAR THEM
   478	000436'	606600	000100		TRNN P1,DSVV		;DS.MOL STATE CHANGE?
   479	000437'	260040	000452'		 CALL CHKONL		;YES, CHECK ONLINE STATUS
   480	000440'	200616	000003'	ATADIS:	MOVE P1,TIBTBL(P3)
   481	000441'	626654	000000		TRZN P2,(P1)		;CLEAR ATA TOO
   482	000442'	254000	000445'		 JRST ATA3
   483	000443'	434400	000014		IOR T3,P1
   484	000444'	434416	000155*		IOR T3,BITTBL(P3)
   485	000445'	326640	000426'	ATA3:	JUMPN P2,ATA2
   486	000446'	713420	000053'	SCRET:	WRIO T3,@ASAD1
   487	000447'	557000	000010		HLRZS T3
   488	000450'	661310	000000		TLO T1,(T3)		;SEEK DONE, SET FLAG FOR FILINT
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 5-5
RMXKON.MAC	20-SEP-87 13:49		RM03 DRIVER

   489	000451'	263040	000000		RET
   490
   491	000452'	606600	010000	CHKONL:	TRNN P1,DSMOL		;ONLINE?
   492	000453'	254000	000462'		 JRST CHKON1		;NO
   493	000454'	201440	000021		MOVEI T4,F.RIP		;READ IN PRESET
   494	000455'	713460	000047'		WRIO T4,@CS1AD1
   495	000456'	201440	000011		MOVEI T4,F.DC		;DRIVE CLEAR
   496	000457'	713460	000047'		WRIO T4,@CS1AD1
   497	000460'	670316	000444*		TDO T1,BITTBL(P3)	;SET FILIO FLAG
   498	000461'	263040	000000		RET
   499
   500	000462'	326240	000465'	CHKON1:	JUMPN U,ONLRET		;FILIO INTERFACE LOSSAGE
   501	000463'	200262	000430*		MOVE U,@KONPTR(J)
   502	000464'	665300	000130*		TLOA T1,KCMOFL
   503	000465'	630616	000003'	ONLRET:	 TDZ P1,TIBTBL(P3)	;DON'T CLEAR BIT IF CAN'T REPORT
   504	000466'	332000	000005	DRVERR:	SKIPE U
   505	000467'	260040	000566'		 CALL SAVSTS		;READ RH11 AND DRIVE STATUS INTO UDB.
   506	000470'	712460	000054'		RDIO T4,@ER1AD1
   507	000471'	602440	040000		TRNE T4,ER1UNS		;FILE UNSAFE?
   508					 JRST [	JUMPN U,DERET
   509						MOVE U,@KONPTR(J)
   510						TLO T1,KCMFUS+KCMOFL
   511	000472'	254000	001010'			JRST .+1]
   512	000473'	201440	000011		MOVEI T4,F.DC		;CLEAR DRIVE ERRORS+ATA
   513	000474'	713460	000047'		WRIO T4,@CS1AD1
   514	000475'	630616	000003'	DERET:	TDZ P1,TIBTBL(P3)	;DON'T CLEAR ATA BIT
   515	000476'	263040	000000		RET
   516
   517				;CONTOLLER ERROR OR ERROR DURING TRANSFER
   518	000477'	260040	000566'	CONERR:	CALL SAVSTS		;SAVE RH11 AND DRIVE STATUS IN UDB.
   519	000500'	321740	000165'		JUMPL P4,CPOPJ		;RETURN IF NOT XFR
   520	000501'	135440	000343*		LDB T4,UNYPUN
   521	000502'	713460	000050'		WRIO T4,@CS2AD1
   522	000503'	201440	010000		MOVEI T4,DSMOL
   523	000504'	616445	000002*		TDNN T4,UNISB+2(U)
   524					 JRST [	TLO T1,KCMOFL+KCMDTA
   525	000505'	254000	001014'			JRST CONRET]
   526	000506'	205440	777771		MOVSI T4,-NERPAT
   527	000507'	200405	000241*	FNDERR:	MOVE T3,UNISB(U)
   528	000510'	200345	000001*		MOVE T2,UNISB+1(U)
   529	000511'	616351	000541'		TDNN T2,ERPAT(T4)
   530	000512'	612411	000532'		TDNE T3,CSPAT(T4)
   531	000513'	260071	000523'		 CALL @XFRDSP(T4)	;PROCESS ERROR (ROUTINE MUST SKIP RETURN)
   532	000514'	253440	000507'		  AOBJN T4,FNDERR
   533	000515'	641300	000000*		TLC T1,KCMERR
   534	000516'	201440	000011		MOVEI T4,F.DC		;CLEAR DRIVE
   535	000517'	713460	000047'		WRIO T4,@CS1AD1
   536	000520'	201440	040000	CONRET:	MOVEI T4,CS1TRE
   537	000521'	713460	000047'		WRIO T4,@CS1AD1
   538	000522'	263040	000000		RET
   539
   540				;ERROR PATTERNS
   541				;TYPE,DEVICE,RETRY BEFORE RECAL,RECAL,
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 5-6
RMXKON.MAC	20-SEP-87 13:49		RM03 DRIVER

   542				; RETRY AFTER RECAL,CS1,CS2,ER1,ER2,W,X,Y
   543				; HERE W= NUMBER OF OFFSET STATES TO CYCLE THROUGH AFTER RECALS FINISHED.
   544				;      X= NUMBER OF TIMES TO RETRY TRANSFER AFTER OFFSETING.
   545				;      Y= NUMBER OF TIMES TO RECAL IF RETIRES AFTER OFFSET FAIL.
   546				DEFINE ERRS <
   547				X DEV,1,12,0,0,,<DLT,NEM,MXF>,<WCF>,,4,3,1
   548				X PAR,0,12,0,0,<MCPE>,<MDPE,UPE>,<PAR>,<DPE>,0,0,0
   549				X FMT,0,12,12,12,,,<HCRC,HCE,FER,ECH,DTE>,<BSE>,4,3,1
   550				X PGM,1,1,0,0,,<PGE>,<WLE,RMR,IAE,AOE,ILR,ILF>,<IVC>,0,0,0
   551				X SEK,1,0,12,12,,,<OPI>,<SKI>,4,1,1
   552				X DAT,0,0,0,0,,,<DCK>,,0,0,0
   553				X UNS,0,0,0,0,,<NED>,,<LSC,LBC,DVC,OPE>,0,0,0
   554				>
   555
   556				;COMPLEXITY OF MACROS IS DUE TO THE LOSING ASSEMBLER BEING USED.
   557				DEFINE BAZ(A,B,C,D) <
   558				BAR A,<B>,ZZ
   559				BAR C,<D>,ZZ1
   560				ZZ,,ZZ1
   561				>
   562
   563				DEFINE BAR(Y,X,Z) <
   564				IFB <X>,<Z==0>
   565				IFNB <X>,<
   566				Z==0
   567				IRP X,<Z==Z+Y'X>
   568				>
   569				>
   570
   571				DEFINE X(A,R1,R2,R3,R4,B,C,D,E,W,X,Y) <
   572				A'ERR
   573				>
   574	000523'	000000	000660'	XFRDSP:	ERRS
   575	000524'	000000	000660'
   576	000525'	000000	000660'
   577	000526'	000000	000660'
   578	000527'	000000	000660'
   579	000530'	000000	000614'
   580	000531'	000000	000670'
   581			000007	NERPAT==.-XFRDSP
   582
   583				DEFINE X(A,R1,R2,R3,R4,B,C,D,E,W,X,Y) <
   584				BAZ CS1,<B>,CS2,<C>
   585				>
   586	000532'	000000	105000	CSPAT:	ERRS
   587	000533'	020000	020400
   588	000534'	000000	000000
   589	000535'	000000	002000
   590	000536'	000000	000000
   591	000537'	000000	000000
   592	000540'	000000	010000
   593
   594				DEFINE X(A,R1,R2,R3,R4,B,C,D,E,W,X,Y) <
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 5-7
RMXKON.MAC	20-SEP-87 13:49		RM03 DRIVER

   595				BAZ ER1,<D>,ER2,<E>
   596				>
   597	000541'	000040	000000	ERPAT:	ERRS
   598	000542'	000010	000020
   599	000543'	010720	100000
   600	000544'	007007	010000
   601	000545'	020000	040000
   602	000546'	100000	000000
   603	000547'	000000	026200
   604
   605				DEFINE X(A,R1,R2,R3,R4,B,C,D,E,W,X,Y) <
   606				R4+200000+UNPDEV*R1,,R3*1000+R2
   607				Y,,X*1000+W
   608				>
   609	000550'	000000*	000012	RCVPAT:	ERRS
   610	000551'	000001	003004
   611	000552'	000000*	000012
   612	000553'	000000	000000
   613	000554'	000000*	012012
   614	000555'	000001	003004
   615	000556'	000000*	000001
   616	000557'	000000	000000
   617	000560'	000000*	012000
   618	000561'	000001	001004
   619	000562'	000000*	000000
   620	000563'	000000	000000
   621	000564'	000000*	000000
   622	000565'	000000	000000
   623
   624				;READ ALL REGISTERS INTO UDB.
   625	000566'	261040	000010	SAVSTS:	PUSH P,T3
   626	000567'	135400	000103*		LDB T3,UNYUTP
   627	000570'	200450	000602'		MOVE T4,REGPTR(T3)
   628	000571'	200340	001016'		MOVE T2,[POINT 18,UNISB(U)]
   629	000572'	134400	000011	SAVST1:	ILDB T3,T4
   630	000573'	322400	000600'		JUMPE T3,PT3J
   631	000574'	270400	001017'		ADD T3,[UA1,,CS1ADR-1]
   632	000575'	712420	000010		RDIO T3,@T3
   633	000576'	136400	000007		IDPB T3,T2
   634	000577'	254000	000572'		JRST SAVST1
   635	000600'	262040	000010	PT3J:	POP P,T3
   636	000601'	263040	000000		RET
   637
   638	000602'	440600	000604'	REGPTR:	POINT 6,RM03RG
   639	000603'	440600	000610'		POINT 6,RP06RG
   640	000604'	011115	430313	RM03RG:	BYTE (6) 1,11,15,43,3,13
   641	000605'	051721	472527		BYTE (6) 5,17,21,47,25,27
   642	000606'	313335	410745		BYTE (6) 31,33,35,41,7,45
   643	000607'	000000	000000		0
   644	000610'	011115	430313	RP06RG:	BYTE (6) 1,11,15,43,3,13
   645	000611'	050717	212533		BYTE (6) 5,7,17,21,25,33
   646	000612'	313537	414547		BYTE (6) 31,35,37,41,45,47
   647	000613'	000000	000000		0
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 5-8
RMXKON.MAC	20-SEP-87 13:49		RM03 DRIVER

   648
   649				;HERE ON VARIOUS ERRORS WHICH OCCURRED DURING TRANSFER.
   650				; T2/ ER1,,ER2   T3/ CS1,,CS2
   651
   652				;RECOVERABLE DATA ERROR
   653	000614'	712660	000060'	DATERR:	RDIO P2,@BAAD1		;FIRST -11 ADR AFTER ERROR BLOCK.
   654	000615'	275640	001000		SUBI P2,200*4		;-11 ADR OF ERROR BLOCK.
   655	000616'	242640	777765		LSH P2,W2PLSH-2		;-11 PAGE NUMBER OF ERROR BLOCK.
   656	000617'	270640	000066'		ADD P2,PGRAD1
   657	000620'	712660	000015		RDIO P2,@P2		;-10 PAGE # OF ERROR BLOCK.
   658	000621'	135640	001020'		LDB P2,[POINT 11,P2,26]
   659	000622'	660640	500000		TRO P2,PGE.A+PGE.W
   660	000623'	137640	001021'		DPB P2,[EPTPGP(%ERR.N)]	;MAP %ERR TO PAGE CONTAINING ERROR BLOCK..
   661	000624'	701100	777000		CLRPT %ERR		;INVALIDATE THIS ENTRY IN THE PAGING CACHE.
   662	000625'	712660	000056'		RDIO P2,@EC1AD1		;BIT NUMBER OF BURST.
   663	000626'	303640	011000		CAILE P2,^D18*^D256
   664	000627'	254000	000656'		 JRST BADECC
   665	000630'	361640	000656'		SOJL P2,BADECC
   666	000631'	231640	000044		IDIVI P2,44
   667	000632'	712360	000052'		RDIO T2,@WCAD1		;-# 18. BIT WORDS LEFT IN TRANSFER.
   668	000633'	550405	000332*		HRRZ T3,UNITWC(U)	;-# 18. BIT WORDS SUPPOSED TO DO.
   669	000634'	276340	000010		SUBM T2,T3		;+# 18. BIT WORDS TRANSFERRED.
   670	000635'	242400	777777		LSH T3,-1		;+# 36. BIT WORDS TRANSFERRED.
   671								;Also relative offset within transfer
   672								; of first block after error block.
   673	000636'	322400	000656'		JUMPE	T3,BADECC	;Hdw is only supposed to report error
   674								; after >=1 physical transfer.
   675	000637'	275400	000200		SUBI	T3,200		;Relative offset of error block
   676	000640'	405400	000777		ANDI	T3,777		;Relative offset within error page
   677	000641'	602400	000177		TRNE T3,177		;DEVICE IS SUPPOSED TO INDICATE ECC TYPE ERRORS
   678	000642'	254000	000656'		 JRST BADECC		; ONLY ON A SECTOR BOUNDARY.
   679	000643'	271650	000000		ADDI P2,(T3)		;FIRST WORD IN ERROR.
   680	000644'	712360	000057'		RDIO T2,@EC2AD1		;ERROR BURST.
   681	000645'	400400	000000		SETZ T3,
   682	000646'	245356	000000		ROTC T2,(P3)
   683	000647'	207000	000007		MOVSS T2
   684	000650'	207000	000010		MOVSS T3
   685	000651'	640640	000177		TRC P2,177		;FIX SECOND WORD IF IN BLOCK.
   686	000652'	642640	000177		TRCE P2,177
   687	000653'	432415	777001		 XORM T3,%ERR+1(P2)
   688	000654'	432355	777000		XORM T2,%ERR(P2)
   689	000655'	645300	000000*		TLCA T1,KCMRER+KCMERR	;RECOVERABLE
   690	000656'	641300	000515*	BADECC:	 TLC T1,KCMERR
   691	000657'	263040	000000		RET
   692				;NOT A DATA ERROR, SET INITIAL ERROR RECOVERY VARIABLES AND PARAMETERS
   693				; IF NOT ALREADY IN THE MIDDLE OF AN E.R. PROCEDURE.
   694	000660'			DEVERR:PARERR:FMTERR:PGMERR:SEKERR:
   695	000660'	332005	000000*		SKIPE UNIRCT(U)
   696	000661'	263040	000000		 RET
   697	000662'	242440	000001		LSH T4,1
   698	000663'	120311	000550'		DMOVE T1,RCVPAT(T4)
   699	000664'	202305	000660*		MOVEM T1,UNIRCT(U)
   700	000665'	202345	000000*		MOVEM T2,UNIRC1(U)
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 5-9
RMXKON.MAC	20-SEP-87 13:49		RM03 DRIVER

   701	000666'	240440	777777		ASH T4,-1
   702	000667'	263040	000000		RET
   703
   704	000670'	402005	000664*	UNSERR:	SETZM UNIRCT(U)
   705	000671'	402005	000665*		SETZM UNIRC1(U)
   706	000672'	661300	000000*		TLO T1,KCMERR+KCMDTA+KCMOFL	;TAKE UNIT OFFLINE
   707	000673'	603340	040000		TLNE T2,ER1UNS		;UNSAFE?
   708	000674'	661300	000000*		 TLO T1,KCMFUS
   709	000675'	263040	000000		RET
   710
   711	000676'			TBVRMX:	BLOCK 2			;2 WORDS TO SAVE THE TIME BASE VALUE
   712	000700'			RMXSAV:	BLOCK 20
   713	000720'	777720	000720'	RMXPDP:	-60,,.
   714	000721'				BLOCK 60
   715
   716	001001'	000000	000000*		$END	(RMX)

   717	001002'	402005	000151*

   718	001003'	254000	000130'

   719	001004'	000000	000171

   720	001005'	101000	000010

   721	001006'	111100	000015

   722	001007'	000001	763000

   723	001010'	326240	000475'

   724	001011'	200262	000463*

   725	001012'	661300	000000*

   726	001013'	254000	000473'

   727	001014'	661300	000000*

   728	001015'	254000	000520'

   729	001016'	442205	000507*

   730	001017'	000001	776677

   731	001020'	111300	000015

   732	001021'	002200	000377*

   733						;End of RMXKON (RMXLIT: RMXEND:)
   734
NO ERRORS DETECTED
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 5-10
RMXKON.MAC	20-SEP-87 13:49		RM03 DRIVER

PROGRAM BREAK IS 001022
7K CORE USED
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 6
RMXKON.MAC	20-SEP-87 13:49		SYMBOL TABLE

ADDEVN		000271'		DCAD1		000064'		ER2SKI		040000	SPD	PT3J		000600'	
ADDNPA		000315'		DCADR		776734	SPD	ERPAT		000541'		RCVPAT		000550'	
ADDPLP		000307'		DCLOC		776734		F.DC		000011	SPD	RDIO	712000	000000	
ASAD1		000053'		DERET		000475'		F.NO		000001	SPD	RDTIME	702200	000000	
ASADR		776716	SPD	DEVERR		000660'		F.OFFS		000015	SPD	REGPTR		000602'	
ASLOC		776716		DIE		000000'	EXT	F.PA		000023	SPD	RET	263040	000000	
ATA1		000425'		DRVERR		000466'		F.RD		000071	SPD	RM03RG		000604'	
ATA2		000426'		DSAD1		000051'		F.RECA		000007	SPD	RM0INT		000354'	INT
ATA3		000445'		DSADR		776712	SPD	F.RIP		000021	SPD	RMACB		000362'	EXT
ATADIS		000440'		DSERR		040000	SPD	F.SEEK		000005	SPD	RMXADD		000266'	INT
BAAD1		000060'		DSLOC		776712		F.WD		000061	SPD	RMXCPY		000076'	INT
BAADR		776704	SPD	DSMOL		010000	SPD	FILINT		000413'	EXT	RMXEND		001021'	INT
BADECC		000656'		DSVV		000100	SPD	FMTERR		000660'		RMXFIN		000323'	INT
BALOC		776704		DSWRL		004000	SPD	FNDERR		000507'		RMXHRD		000235'	INT
BITTBL		000460'	EXT	DTAD1		000065'		FTDPAG		000000	SIN	RMXINT		000354'	INT
BPT		000070'		DTADR		776726	SPD	INTDIS		000402'		RMXKON		000000'	ENT
CALL	260040	000000		DTLOC		776726		J		000002	INT	RMXLIT		001001'	INT
CHKON1		000462'		EC1AD1		000056'		KCMDTA		000400'	EXT	RMXLTM		000200'	INT
CHKONL		000452'		EC1ADR		776744	SPD	KCMERR		000656'	EXT	RMXOF1		000233'	
CLRPT	701100	000000		EC1LOC		776744		KCMFUS		000674'	EXT	RMXOFS		000221'	INT
CONERR		000477'		EC2AD1		000057'		KCMOFL		000464'	EXT	RMXPDP		000720'	
CONRET		000520'		EC2ADR		776746	SPD	KCMRER		000000	EXT	RMXPOS		000343'	INT
CPOPJ		000165'		EC2LOC		776746		KONCUA		000401'	EXT	RMXRCL		000173'	INT
CPOPJ1		000164'		EPT		000000	EXT	KONPTR		001011'	EXT	RMXRED		000245'	INT
CPY0		000113'		EPTPG0		000200	SIN	LAAD1		000062'		RMXSAV		000700'	
CPY1		000132'		ER1AD1		000054'		LAADR		776720	SPD	RMXSFT		000241'	INT
CPY2		000147'		ER1ADR		776714	SPD	LALOC		776720		RMXSTP		000166'	INT
CPYER1		000130'		ER1AOE		001000	SPD	LTM1		000202'		RMXUPA		000157'	INT
CPYERR		000126'		ER1DCK		100000	SPD	NERPAT		000007	SPD	RMXWRT		000246'	INT
CS1AD1		000047'		ER1DTE		010000	SPD	NODIE		000000	EXT	RP06RG		000610'	
CS1ADR		776700	SPD	ER1ECH		000100	SPD	OFAD1		000061'		S$ENTR	777777	777775	SIN
CS1IE		000100	SPD	ER1FER		000020	SPD	OFADR		776732	SPD	S$HALT	777777	777777	SIN
CS1LOC		776700		ER1HCE		000200	SPD	OFLOC		776732		S$NAME		000000'	SPD
CS1MCP		020000	SPD	ER1HCR		000400	SPD	OFOFD		000200	SPD	S$NONA		000000	SIN
CS1SC		100000	SPD	ER1IAE		002000	SPD	ONLRET		000465'		S$TEMP		000000	SPD
CS1TRE		040000	SPD	ER1ILF		000001	SPD	P		000001	INT	S$XCT	777777	777776	SIN
CS2AD1		000050'		ER1ILR		000002	SPD	P1		000014	INT	SAVST1		000572'	
CS2ADR		776710	SPD	ER1LOC		776714		P2		000015	INT	SAVSTS		000566'	
CS2CLR		000040	SPD	ER1OPI		020000	SPD	P3		000016	INT	SBSIZ		000000	EXT
CS2DLT		100000	SPD	ER1PAR		000010	SPD	P4		000017	INT	SCINT		000420'	
CS2LOC		776710		ER1RMR		000004	SPD	PARERR		000660'		SCRET		000446'	
CS2MDP		000400	SPD	ER1UNS		040000	SPD	PGE.A		400000	SIN	SEKERR		000660'	
CS2MXF		001000	SPD	ER1WCF		000040	SPD	PGE.W		100000	SIN	T1		000006	INT
CS2NED		010000	SPD	ER1WLE		004000	SPD	PGMERR		000660'		T2		000007	INT
CS2NEM		004000	SPD	ER2AD1		000055'		PGRAD1		000066'		T3		000010	INT
CS2PGE		002000	SPD	ER2ADR		776742	SPD	PGRADR		763000	SPD	T4		000011	INT
CS2UPE		020000	SPD	ER2BSE		100000	SPD	PGRFST		100000	SPD	TBVRMX		000676'	
CSPAT		000532'		ER2DPE		000020	SPD	PGRLOC		763000		TIBTBL		000003'	INT
DAAD1		000063'		ER2DVC		000200	SPD	PGRVAL		040000	SPD	U		000005	INT
DAADR		776706	SPD	ER2IVC		010000	SPD	PIHIGH		000000	EXT	UA1		000001	SPD
DALOC		776706		ER2LBC		002000	SPD	PILOW		000000	EXT	UA1AD1		000067'	
DATERR		000614'		ER2LOC		776742		PPC		000072'		UBAADR		763100	SPD
DCAD1		000064'		ER2LSC		004000	SPD	PPU		000074'		UBAINI		000100	SPD
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88 PAGE 6-2
RMXKON.MAC	20-SEP-87 13:49		SYMBOL TABLE

UNIBLK		000345'	EXT	
UNICHR		000077'	EXT	
UNIDES		000000	EXT	
UNIOFS		000000	EXT	
UNIONC		001002'	EXT	
UNIPPU		000107'	EXT	
UNIRC1		000671'	EXT	
UNIRCT		000670'	EXT	
UNISB		001016'	EXT	
UNISBH		000236'	EXT	
UNISBS		000242'	EXT	
UNISVA		000373'	EXT	
UNITWC		000633'	EXT	
UNPDEV		000000	EXT	
UNSERR		000670'		
UNYBPT		000261'	EXT	
UNYBPY		000346'	EXT	
UNYOCV		000225'	EXT	
UNYOS		000335'	EXT	
UNYPPY		000105'	EXT	
UNYPUN		000501'	EXT	
UNYRCO		000000	EXT	
UNYRTO		000000	EXT	
UNYUTP		000567'	EXT	
USPR		041624		
W2BLSH	777777	777771	SPD	
W2PLSH	777777	777767	SPD	
WCAD1		000052'		
WCADR		776702	SPD	
WCLOC		776702		
WRIO	713000	000000		
WRTIME	702600	000000		
XFRDSP		000523'		
ZOT		000000	SPD	
ZZ		000000	SPD	
ZZ1		026200	SPD	
%ERR		777000	SIN	
%ERR.N		000777	SIN	
%OFLER		000126'	EXT	
%OFLRS		001001'	EXT	

RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88
RMXKON.MAC	20-SEP-87 13:49		Symbol cross reference

ADDEVN	   332#	   363
ADDNPA	   326	   360#
ADDPLP	   352#	   356
ASAD1	   127#	   468	   486
ASADR	   127	   128
ASLOC	   128#
ATA1	   469#
ATA2	   470#	   485
ATA3	   482	   485#
ATADIS	   473	   480#
BAAD1	   132#	   373	   434	   653
BAADR	   132	   133
BADECC	   664	   665	   673	   678	   690#
BALOC	   133#
BITTBL	    41%	   199	   484	   497
BPT	   142#	   159
CHKON1	   492	   500#
CHKONL	   479	   491#
CONERR	   466	   518#
CONRET	   525	   536#
CPOPJ	   208#	   519
CPOPJ1	   207#
CPY0	   162#	   190
CPY1	   171	   178#
CPY2	   187	   193#
CPYER1	   175#	   180
CPYERR	   173#	   191	   197
CS1AD1	   105#	   184	   189	   206	   215	   223	   384	   402	   429	   449	   456	   494	   496	   513
	   535	   537
CS1ADR	   105	   106	   631
CS1IE	   214	   222	   292	   293	   401	   451	   452
CS1LOC	   106#
CS1MCP	   453	   464	   587
CS1SC	   430
CS1TRE	   453	   454	   465	   536
CS2AD1	   124#	   163	   165	   167	   169	   182	   213	   221	   255	   309	   390	   474	   521
CS2ADR	   124	   125
CS2CLR	   162	   168
CS2DLT	   586
CS2LOC	   125#
CS2MDP	   587
CS2MXF	   586
CS2NED	   170	   592
CS2NEM	   586
CS2PGE	   589
CS2UPE	   587
CSPAT	   530	   586#
DAAD1	   135#	   313
DAADR	   135	   136
DALOC	   136#
DATERR	   579	   653#
DCAD1	   136#	   400
DCADR	   136	   137
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88
RMXKON.MAC	20-SEP-87 13:49		Symbol cross reference

DCLOC	   137#
DERET	   508	   514#
DEVERR	   574	   694#
DIE	    25	    25%	    26
DRVERR	   477	   504#
DSAD1	   125#	   166	   185	   381	   383	   475
DSADR	   125	   126
DSERR	   196	   476
DSLOC	   126#
DSMOL	   178	   491	   522
DSVV	   186	   478
DSWRL	   194
DTAD1	   137#	   151
DTADR	   137	   138
DTLOC	   138#
EC1AD1	   130#	   662
EC1ADR	   130	   131
EC1LOC	   131#
EC2AD1	   131#	   680
EC2ADR	   131	   132
EC2LOC	   132#
EPT	    50%	   660
EPTPG0	   660
ER1AD1	   128#	   506
ER1ADR	   128	   129
ER1AOE	   600
ER1DCK	   602
ER1DTE	   599
ER1ECH	   599
ER1FER	   599
ER1HCE	   599
ER1HCR	   599
ER1IAE	   600
ER1ILF	   600
ER1ILR	   600
ER1LOC	   129#
ER1OPI	   601
ER1PAR	   598
ER1RMR	   600
ER1UNS	   507	   707
ER1WCF	   597
ER1WLE	   600
ER2AD1	   129#
ER2ADR	   129	   130
ER2BSE	   599
ER2DPE	   598
ER2DVC	   603
ER2IVC	   600
ER2LBC	   603
ER2LOC	   130#
ER2LSC	   603
ER2OPE	   603
ER2SKI	   601
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88
RMXKON.MAC	20-SEP-87 13:49		Symbol cross reference

ERPAT	   529	   597#
F.DC	   111#	   188	   214	   495	   512	   534
F.NO	   107#
F.OFFS	   113#
F.PA	   116#	   183
F.RD	   122#	   292
F.RECA	   110#	   222
F.RIP	   115#	   493
F.SEEK	   109#	   401
F.WD	   120#	   293
FILINT	   176%	   176	   200%	   200	   458%	   458
FMTERR	   576	   694#
FNDERR	   527#	   532
FTDPAG	    32	    32#	    43	    44	   231	   295	   298	   323	   328	   339	   345	   359	   391	   395
	   436	   441
INTDIS	   432	   449#
J	   379	   425	   427	   448	   472	   501	   509
KCMDTA	    48%	   447	   524	   706
KCMERR	    49%	   533	   689	   690	   706
KCMFUS	    49%	   510	   708
KCMOFL	    47%	   175	   502	   510	   524	   706
KCMRER	    49%	   689
KONCUA	    47%	   379	   427	   448
KONPTR	    48%	   472	   501	   509
LAAD1	   134#	   237
LAADR	   134	   135
LALOC	   135#
LISTSN	     3	     6
LTM1	   236#	   239
NERPAT	   526	   581#
NODIE	    25%
OFAD1	   133#	   260
OFADR	   133	   134
OFLOC	   134#
OFOFD	   259
ONLRET	   500	   503#
P	    26	    95	    96	   207	   224	   270	   276	   334	   424	   625	   635
P1	   292	   293	   384	   450	   452	   454	   455	   456	   475	   476	   478	   480	   481	   483
	   491	   503	   514
P2	   294	   336	   337	   360	   361	   362	   370	   375	   376	   377	   378	   468	   469	   470
	   481	   485	   653	   654	   655	   656	   657	   658	   659	   660	   662	   663	   665	   666
	   679	   685	   686	   687	   688
P3	   302	   303	   304	   305	   306	   307	   332	   333	   335	   471	   474	   480	   484	   497
	   503	   514	   682
P4	   426	   428	   432	   519
PARERR	   575	   694#
PGE.A	   659
PGE.W	   659
PGMERR	   577	   694#
PGRAD1	   138#	   656
PGRADR	   138	   139
PGRFST	   352
PGRLOC	   139#	   351
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88
RMXKON.MAC	20-SEP-87 13:49		Symbol cross reference

PGRVAL	   352
PIHIGH	    41%	   204
PILOW	    41%	   204
PPC	   143#	   155
PPU	   144#	   157
PT3J	   630	   635#
RCVPAT	   609#	   698
REGPTR	   627	   638#
RM03RG	   638	   640#
RM0INT	   418#
RMACB	    41%	   425
RMXADD	   324#
RMXCPY	   149#
RMXEND	   733#
RMXFIN	   370#
RMXHRD	   267#
RMXINT	   419#	   462
RMXKON	    25	    26#	    29
RMXLIT	   716#
RMXLTM	   230#
RMXOF1	   253	   257	   262#
RMXOFS	   252#
RMXPDP	   424	   713#
RMXPOS	   389#
RMXRCL	   220#
RMXRED	   292#
RMXSAV	   421	   422	   423	   459	   712#
RMXSFT	   273#
RMXSTP	   212#
RMXUPA	   202#
RMXWRT	   293#
RP06RG	   639	   644#
S$ENTR	    25	    31	   364
S$HALT	    25	   364
S$NAME	    29#	   364
S$NONA	    28	    31	   364
S$TEMP	    25#	    25	   364#	   364
S$XCT	    31	   364
SAVST1	   629#	   634
SAVSTS	   505	   518	   625#
SBSIZ	    46%	   269	   275
SCINT	   431	   464#
SCRET	   469	   486#
SEKERR	   578	   694#
T1	   149	   150	   155	   156	   157	   158	   159	   160	   164	   165	   167	   170	   172	   173
	   174	   175	   181	   182	   183	   184	   188	   189	   193	   195	   198	   199	   202	   203
	   204	   205	   206	   212	   213	   214	   215	   220	   221	   222	   223	   242	   243	   244
	   247	   249	   252	   254	   255	   256	   257	   258	   259	   260	   261	   262	   267	   268
	   269	   296	   303	   324	   332	   333	   335	   337	   338	   340	   341	   349	   350	   352
	   353	   370	   371	   372	   373	   374	   381	   382	   383	   389	   390	   392	   399	   400
	   401	   402	   426	   446	   447	   457	   488	   497	   502	   510	   524	   533	   689	   690
	   698	   699	   706	   708
T2	   166	   178	   185	   186	   194	   196	   236	   238	   244	   273	   274	   275	   304	   311
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88
RMXKON.MAC	20-SEP-87 13:49		Symbol cross reference

	   312	   325	   342	   343	   350	   352	   356	   360	   380	   382	   393	   399	   528	   529	   628
	   633	   667	   669	   680	   682	   683	   688	   700	   707
T3	   151	   152	   153	   154	   155	   157	   159	   162	   163	   168	   169	   235	   239	   241
	   242	   245	   246	   247	   248	   249	   308	   309	   312	   313	   336	   351	   353	   354
	   467	   483	   484	   486	   487	   488	   527	   530	   625	   626	   627	   629	   630	   631
	   632	   633	   635	   668	   669	   670	   673	   675	   676	   677	   679	   681	   684	   687
T4	   161	   190	   234	   236	   237	   238	   240	   245	   310	   311	   342	   355	   429	   430
	   434	   435	   437	   438	   439	   446	   449	   451	   453	   464	   465	   493	   494	   495
	   496	   506	   507	   512	   513	   520	   521	   522	   523	   526	   529	   530	   531	   532
	   534	   535	   536	   537	   627	   629	   697	   698	   701
TBVRMX	   420	   461	   711#
TIBTBL	    55#	   480	   503	   514
U	   150	   158	   174	   179	   195	   267	   268	   273	   274	   296	   374	   377	   379	   392
	   427	   435	   500	   501	   504	   508	   509	   523	   527	   528	   628	   668	   695	   699
	   700	   704	   705
UA1	   105	   124	   125	   126	   127	   128	   129	   130	   131	   132	   133	   134	   135	   136
	   137	   138	   139	   351	   631
UA1AD1	   139#	   203	   205
UBAADR	   139
UBAINI	   202
UNIBLK	    43%	   296	   392
UNICHR	    45%	   150
UNIDES	    50%
UNIOFS	    42%
UNIONC	    42%	   174	   179	   195
UNIPPU	    42%	   158
UNIRC1	    51%	   700	   705
UNIRCT	    50%	   695	   699	   704
UNISB	    46%	    51%	   267	   273	   523	   527	   528	   628
UNISBH	    46%	   268	   269
UNISBS	    46%	   274	   275
UNISVA	    42%	   374	   435
UNITWC	    42%	   377	   668
UNPDEV	    50%	   609	   611	   613	   615	   617	   619	   621
UNSERR	   580	   704#
UNYBPT	    45%	   160	   243	   310
UNYBPY	    45%	   241	   302	   393
UNYOCV	    51%	   256
UNYOS	    51%	   262	   380
UNYPPY	    42%	   156
UNYPUN	    42%	   164	   181	   198	   212	   220	   254	   308	   389	   520
UNYRCO	    51%
UNYRTO	    51%
UNYUTP	    50%	   154	   626
USPR	   145#	   248
W2BLSH	   439
W2PLSH	   338	   343	   655
WCAD1	   126#	   378	   667
WCADR	   126	   127
WCLOC	   127#
XFRDSP	   531	   574#	   581
ZOT	    54#	    58	    59	    59#	    60	    60#	    61	    61#	    62	    62#	    63	    63#	    64	    64#
	    65	    65#	    66	    66#	    67	    67#	    68	    68#	    69	    69#	    70	    70#	    71	    71#
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88
RMXKON.MAC	20-SEP-87 13:49		Symbol cross reference

	    72	    72#	    73	    73#	    74	    74#	    75	    75#	    76	    76#	    77	    77#	    78	    78#	    79
	    79#	    80	    80#	    81	    81#	    82	    82#	    83	    83#	    84	    84#	    85	    85#	    86
	    86#	    87	    87#	    88	    88#	    89	    89#	    90	    90#	    91	    91#	    92	    92#	    93
	    93#	    94	    94#
ZZ	   586#	   586	   587#	   587	   588#	   588	   589#	   589	   590#	   590	   591#	   591	   592#	   592
	   597#	   597	   598#	   598	   599#	   599	   600#	   600	   601#	   601	   602#	   602	   603#	   603
ZZ1	   586#	   586	   587#	   587	   588#	   588	   589#	   589	   590#	   590	   591#	   591	   592#	   592
	   597#	   597	   598#	   598	   599#	   599	   600#	   600	   601#	   601	   602#	   602	   603#	   603
%ERR	   661	   687	   688
%ERR.N	   660
%OFLER	    47%	   173
%OFLRS	    47%	   172
RMXKON - Driver for RM03 or RP06 disks on KS-2020	MACRO 12.5-46.0 14:14 13-JAN-88
RMXKON.MAC	20-SEP-87 13:49		Macro/Opdef cross reference

BAR	   563#	   586	   587	   588	   589	   590	   591	   592	   597	   598	   599	   600	   601	   602
	   603
BAZ	   557#	   586	   587	   588	   589	   590	   591	   592	   597	   598	   599	   600	   601	   602
	   603
CALL	    95#	   363	   431	   458	   466	   477	   479	   505	   518	   531
CLRPT	   661
EPTPGP	   660
EPTPGS	   660
ERRS	   546#	   574	   586	   597	   609
FOO	    99#	   105	   124	   125	   126	   127	   128	   129	   130	   131	   132	   133	   134	   135
	   136	   137	   138
ND	    32
PRINTF	    10#
RDIO	   151	   166	   167	   185	   206	   237	   381	   429	   434	   449	   468	   475	   506	   632
	   653	   657	   662	   667	   680
RDTIME	   420
RET	    96#	   208	   216	   250	   263	   314	   357	   365	   385	   403	   489	   498	   515	   538
	   636	   691	   696	   702	   709
STOPCD	    24	   364
TBSAVE	   420
TBSET	   461
WRIO	   163	   165	   169	   182	   184	   189	   203	   205	   213	   215	   221	   223	   255	   260
	   309	   313	   353	   373	   378	   383	   384	   390	   400	   402	   456	   474	   486	   494
	   496	   513	   521	   535	   537
WRTIME	   461
X	   571#	   574	   575	   576	   577	   578	   579	   580	   583#	   586	   587	   588	   589	   590
	   591	   592	   594#	   597	   598	   599	   600	   601	   602	   603	   605#	   609	   611	   613
	   615	   617	   619	   621
$END	   716    Y@w