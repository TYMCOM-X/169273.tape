SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 1
S.MAC	13-JAN-88 11:55		S.MAC - with system parameter file for P035/D, January 1988

     1				SUBTTL	S.MAC - with system parameter file for P035/D, January 1988
     2
     3				IF2,<IFNDEF LISTSN,<TAPE>>	;Skip to PASS2 in all but COMMON.LST
     4				;THIS MODULE ASSEMBLED WITH KL-10 PARAMETER FILE - KLSYM.MAC
     5
     6					IF2,<IFNDEF LISTSN,<		;LIST KLSYM.MAC IN COMMON ONLY
     7								TAPE>>
     8				TITLE SCNSER - TYMNET VERSION OF SCNSER
     9
    10					STOPCD(,ENTRY,SCNSER)^
    11					ENTRY	SCNSER		;For library searches
    12	000000'	260040	000000*	SCNSER::PUSHJ	P,DIE		;**** Default stopcode for "SCNSER" ****
    13	000001'	634356	634562		SIXBIT	/SCNSER/  	;Title of module
    14	000002'	000000	000000		S$NONAME,,0		;?NONAME stopcode "SCNSER+nnn(nnnnnn)"
    15			000000'	S$NAME==SCNSER			;For STOPCDs with no arguments
    16					SALL>
    17				^
    18
    19			000001		SCNVER==1	;Version number reported to the base
    20			000000		SCNREL==0	;Release number reported to the base
    21
    22				;THE 620 AND PDP-10 SHARE CORE AS A MEANS OF COMMUNICATION.
    23				;THE 620 PUTS THINGS DESTINED FOR THE PDP-10 INTO A RING
    24				;BUFFER AND VICE VERSA. THE PDP-10 EXAMINES THE STATE OF THE
    25				;RING BUFFER EVERY CLOCK TICK. FOR OUTPUT, THE PDP-10 NEVER
    26				;PUTS OUT MORE THAN 30 (=%CHRMX) CHARACTERS ON A GIVEN LINE
    27				;WITHOUT CHECKING THE INPUT RINGS IN CASE THE 620 REQUESTS
    28				;THE PDP-10 TO STOP DOING OUTPUT ON THAT LINE.
    29
    30				;NOTE VERY CAREFULLY THAT THESE ROUTINES DEPEND ON THE FACT THAT
    31				;CLOCK LEVEL NEVER INTERRUPTS UUO LEVEL AND VICE VERSA.
    32				;FOR THIS REASON THERE ARE NO INTERLOCKS BETWEEN THE TWO
    33				;LEVELS. ANYONE WHO CHANGES THIS BEWARE!!!!!!!!!!
    34
    35				SUBTTL	TABLE OF CONTENTS
    36						;Insert table of contents here
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 2
SCNSER.MAC	25-NOV-87 19:52		DEFINITIONS

    37				SUBTTL	DEFINITIONS
    38
    39			000035	AUXSTM==:^D29		;MAX NUMBER OF CHRS ALLOWED IN AUX STRING
    40			000010	AUXSTL==1+<<AUXSTM+6>/5>;SIZE OF AUX STRING STORAGE BLOCK
    41
    42			000033	STDALT==33		;STANDARD ALTMODE
    43
    44			000004	TTCHKS==4		;SIZE OF TELETYPE BUFFERLETS
    45			000010	TT2CHK==TTCHKS*2
    46
    47			000002	IMGDIM==2		;TIME TO WAIT IN IMAGE AFTER FIRST CHR
    48			000012	IMGTIM==^D10		;TIME TO WAIT IN IMAGE MODE FOR FIRST CHR
    49			000003	TIRSVD==3		;Number of chunks reserved for emergencies
    50			000110	TIWKC==^D72		;# of input chars to wake job (72 or 132)
    51				IFG TIWKC-^D72,<PRINTX Setting TIWKC above 72 causes PTY backpressure problems
    52						TIWKC==^D72>
    53			000120	TILOW==TIWKC+^D8	;# of unread input chars to trigger backpressure
    54							;(TIWRNN set to TILOW.  TIHLTN based on IRING size)
    55			000024	OWTIM==^D20		;1/2 OF ORANGE-BALL-WAIT TIMEOUT ON ZAP
    56							;(SEE TTYZAP)
    57
    58			000120	CTY==120		;FOR SPECIAL TYPOUT ON PARITY ERR
    59
    60			000036	%CHRMX==^D30		;MAX NUMBER OF CHRS TO OUTPUT ON LINE WITHOUT
    61							;RETURNING TO INPUT RING CODE (THE EFFECT IS
    62							;THAT %CHRMX IS THE NUMBER OF CHARACTERS OF
    63							;"DELAY" IN GETTING BACKPRESSURE APPLIED
    64							;TO THE LINE)  Should be <4*N>-2 for efficiency
    65
    66			000017	%PBTIM==^D15		;PTY BLOCK INPUT TIMEOUT
    67
    68				;CONDITIONAL ASSEMBLY FLAGS
    69
    70			000000	YLBUG==0		;1 IF BASE TURNS ALL ORANGE BALLS INTO YELLOW
    71			000001	OPCRET==1		;1 IF PROGRAMS THINK TTCALLS IGNORE IMAGE
    72
    73				SUBTTL	THE EXTERNALS FOR SCNSER
    74
    75				;FROM COMMON
    76				EXTERNAL BITNTB,LINFLG,NMXFLG,ALR620,JBTABT,JBTUNM,JBTUN1
    77				EXTERNAL JBTCIN,JBTCOT,JBTBCS,JBTLIC,JBTAWQ,JBTBET,JBTBIO
    78				EXTERNAL IRING,ORING,ORPPDP,IRPPDP,ORP620,IRP620,MSKIRG,MSKORG
    79				EXTERNAL JOBN,HIGHJB,CONFIG,QUEPCB
    80
    81				;GENERAL EXTERNALS
    82				EXTERNAL TPOPJ,TPOPJ1,CPOPJ,CPOPJ1,IPOPJ,IPOPJ1
    83				EXTERNAL STTIOD,JBTSTS,LINTAB,JBTPRV
    84				EXTERNAL PJOBN,WSYNC,SETRUN,PEVEN8,JOB,REFLAG
    85				EXTERNAL TTYTAB,PUNIT,STATES,UPTIME,PVYMOD
    86				EXTERNAL DEVOPR,THSDAT,JFYSEC,TIME	;NAME OF OPER CONSOLE
    87				EXTERNAL GET4WD,GIV4WD,BIOCOR
    88
    89				;EXTERNALS USED BY MUUO ROUTINES
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 2-2
SCNSER.MAC	25-NOV-87 19:52		THE EXTERNALS FOR SCNSER

    90				EXTERNAL OUT,BUFCLR,ADRERR,ADVBFF,ADVBFE
    91				EXTERNAL GTCGSZ,RELEA6
    92				EXTERNAL CHKSEG,SETIO2
    93
    94				EXTERNAL TTVINI,TTVIN2		;BIT IN LINTAB (LH) TO SAY SHOULD RUN INITIA
    95
    96				;UUOCON ALSO USES TTYFND,LDLCOM,TTYU;STC,TTYFUW
    97				;AND DDBLDB,LDBDCH,LDBDDB
    98
    99				;FOR CLOCK1
   100				EXTERNAL AXAVAL,AXREQ,AXSWT,AXWAIT,MLOWQ,RNQ,WSCHED,CHGCLK
   101				EXTERNAL FCREQ,FCWAIT
   102				EXTERNAL BPAVAL,BPREQ,BPWAIT
   103
   104				;FILSER ALSO USES TTYFUW,TTYSTR
   105
   106				;PICON
   107				EXTERNAL ABTUUO,TAKTRJ,TAKNZJ,TAKOTJ,TSTKTJ,TSTKTP,TSTTRJ,JBTPIP,TAKTRP
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 3
SCNSER.MAC	25-NOV-87 19:52		TERMINAL CHARACTERISTICS DEFINITIONS

   108				SUBTTL	TERMINAL CHARACTERISTICS DEFINITIONS
   109
   110				;TERMINAL CHARACTERISTICS
   111
   112				DEFINE TCHARS <;;Define TCNxxx, also expanded at TCNDSP and TCVMAX
   113				Z(CRD,1,TYMTC,TMCCRD)
   114				Z(IR,17,TYMTC,TMCIR)
   115				Z(OR,17,TYMTC,TMCOR)
   116				Z(PAR,1,TYMTC,TMCPAR)
   117				Z(HDX,1,TYMTC,TMCHDX)
   118				Z(PA,7,TYMTC,TMCPA)
   119				Z(PB,7,TYMTC,TMCPB)
   120				Z(PC,17,TYMTC,TMCPC)
   121				Z(XON,1,TYMTC,TMCXON)
   122				Z(ECH,1,TYMTC,TMCECH)
   123				Z(RXE,1,TYMTC,TMCRXE)
   124				Z(PD,17,TYMTC,TMCPD)	;PARM D, was TCNTYP/TMCTYP
   125				Z(NXO,1,BYTTC,LDPNXO)
   126				Z(WID,377,ACWIDC,0)
   127				Z(FC1,3,BYTTC,LDPFC1)
   128				Z(FC2,3,BYTTC,LDPFC2)
   129				Z(BSP,1,ACBSPC,0)
   130				Z(ERA,1,ACERAC,0)
   131				Z(DEF,1,ACDEFC,0)
   132				Z(LCO,1,BYTTC,LDPLCO)
   133				Z(TAB,1,BYTTC,LDPTAB)
   134				Z(FRM,1,BYTTC,LDPFRM)
   135				Z(LCT,1,BYTTC,LDPLCT)
   136				Z(NFC,1,BYTTC,LDPNFC)
   137				Z(PTP,1,ACPTPC,0)
   138				Z(BSD,1,BYTTC,LDPBSD)
   139				Z(CLA,377777777777,ACTCLA,0)	;Class (was TMCTTP)
   140				Z(RTC,1,BYTTC,LDPRTC)
   141				Z(KAT,1,TYMTC,TMCKAT)		;KATAKANA (Japanese modes), was TMCTYP
   142				Z(TYP,377777777777,ACTTYP,0)
   143				>  ;Max of 36 fields, so that TYMNET or PTY can be notified
   144
   145			000000	ZZN==0
   146				DEFINE Z(NAME,MAXVAL,TYPE,ARG) = <
   147					TCN'NAME==ZZN
   148					ZZN==ZZN+1
   149				>
   150				TCHARS
   151			000036	TCNN==ZZN
   152				IFG <TCNN-^D36>,<
   153					PRINTX MORE THAN 36 TYMCOM-X TERMINAL CHARACTERISTICS
   154					QQQQQQ
   155				>
   156	000003'	777777	777700	TCBALL:	<-1 _ <^D36-TCNN>>
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 4
SCNSER.MAC	25-NOV-87 19:52		TYMNET TERMINAL CHARACTERISTICS

   157				SUBTTL TYMNET TERMINAL CHARACTERISTICS
   158
   159				;DEFINE NAMES AND FIELD WIDTHS
   160
   161				DEFINE TERCHR <;;Terminal characteristics that TYMNET-II responds to
   162				TC(ECO,1)	; 0. ECHO
   163				TC(CIE,1)	; 1. ECHO CONTROL-I
   164				TC(ELF,1)	; 2. ECHO LF AS LF/CR/DELAY
   165				TC(ECR,1)	; 3. ECHO CR AS CR/LF
   166				TC(CRD,1)	; 4. CR DELAY
   167				TC(IR,4)	; 5. INPUT BAUD RATE CODE
   168				TC(OR,4)	; 6. OUTPUT BAUD RATE CODE
   169				TC(PAR,1)	; 7. PARITY (EVEN OR NONE)
   170				TC(HDX,1)	; 8. HALF DUPLEX
   171				TC(PA,3)	; 9. PARAMETER A
   172				TC(PB,3)	;10. PARAMETER B
   173				TC(PC,4)	;11. PARAMETER C
   174				TC(XON,1)	;12. X-ENABLE FOR REMOTE
   175				TC(ECH,1)	;13. ECHO CONTROL-H
   176				TC(RXE,1)	;14. REVERSE X-ENABLE
   177				TC(PD,4)	;15. PARAMETER D to ISIS (TMCPD was TMCTYP)
   178				TC(KAT,1)	;16. KATAKANA MODE (See comments at TYMTC2)
   179				TC(TOB,1)	;17. TERMINATE OUTPUT ON BREAK
   180				TC(ESC,1)	;18. ECHO ESCAPE
   181				TC(QM,1)	;19. Q-MODE (echo } and ~, they are not ALTMODEs)
   182				;;(SPA,1)	;20. SPACE PARITY  (not in EBUS02.J01!!)
   183				>
   184
   185				;DEFINE TERMINAL CHARACTERISTICS CODES
   186
   187			000000	ZZN==0
   188				DEFINE TC(N,Z)  <TMC'N==ZZN
   189				ZZN==ZZN+1>
   190
   191				TERCHR
   192
   193			000077	TMCALL==77	;PROBE CODE TO GET ALL TERMINAL CHARACTERISTICS
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 5
SCNSER.MAC	25-NOV-87 19:52		DEFINE RECEIVED CHARACTERISTICS BYTE POINTERS

   194				SUBTTL	DEFINE RECEIVED CHARACTERISTICS BYTE POINTERS
   195
   196			000000	ZZWORD==0
   197		777777	777777	ZZPOS==-1
   198				DEFINE TC(N,W) <IFG <ZZPOS+W>-^D35,<ZZPOS==-1
   199				ZZWORD==ZZWORD+1>
   200				ZZPOS==ZZPOS+W
   201				LDP'N:	POINT W,LDBTMR+ZZWORD(U),ZZPOS>
   202
   203	000004'	430105	000044	TABTMR:	TERCHR
   204	000005'	420105	000044
   205	000006'	410105	000044
   206	000007'	400105	000044
   207	000010'	370105	000044
   208	000011'	330405	000044
   209	000012'	270405	000044
   210	000013'	260105	000044
   211	000014'	250105	000044
   212	000015'	220305	000044
   213	000016'	170305	000044
   214	000017'	130405	000044
   215	000020'	120105	000044
   216	000021'	110105	000044
   217	000022'	100105	000044
   218	000023'	040405	000044
   219	000024'	030105	000044
   220	000025'	020105	000044
   221	000026'	010105	000044
   222	000027'	000105	000044
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 6
SCNSER.MAC	25-NOV-87 19:52		DEFINE SENT CHARACTERISTICS BYTE POINTERS

   223				SUBTTL	DEFINE SENT CHARACTERISTICS BYTE POINTERS
   224
   225			000000	ZZWORD==0
   226		777777	777777	ZZPOS==-1
   227				DEFINE TC(N,W) <IFG <ZZPOS+W>-^D35,<ZZPOS==-1
   228				ZZWORD==ZZWORD+1>
   229				ZZPOS==ZZPOS+W
   230				LDS'N:	POINT W,LDBTMS+ZZWORD(U),ZZPOS>
   231
   232	000030'	430105	000045	TABTMS:	TERCHR
   233	000031'	420105	000045
   234	000032'	410105	000045
   235	000033'	400105	000045
   236	000034'	370105	000045
   237	000035'	330405	000045
   238	000036'	270405	000045
   239	000037'	260105	000045
   240	000040'	250105	000045
   241	000041'	220305	000045
   242	000042'	170305	000045
   243	000043'	130405	000045
   244	000044'	120105	000045
   245	000045'	110105	000045
   246	000046'	100105	000045
   247	000047'	040405	000045
   248	000050'	030105	000045
   249	000051'	020105	000045
   250	000052'	010105	000045
   251	000053'	000105	000045
   252				INTERN LDSRXE	;CTYSIM needs this pointer
   253
   254			000023	MAXTMC==.-TABTMS-1
   255			000025	TMCSLP==^D21	;IF MAXTMC .lt. TMC .ge. MAXTMC+TMCSLP, WE WILL
   256						;IGNORE TYMNET MESSAGES FOR THE <TMC> RATHER
   257						;THAN CRASHING (THIS LETS TYMNET GET AHEAD OF US)
   258			000001	TMCSIZ==ZZWORD+1
   259				IFG MAXTMC-^D35,<PRINTX MORE THAN 36 TERMINAL CHARACTERISTICS
   260				QQQQQQ>
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 7
SCNSER.MAC	25-NOV-87 19:52		OUTPUT REQUEST BITS

   261				SUBTTL OUTPUT REQUEST BITS
   262
   263				;WHEN A PORT WANTS SOMETHING SENT TO TYMNET, IT SETS ONE OF
   264				;THESE BITS IN ITS LDBOUT WORD. MESSAGES CORRESPONDING TO
   265				;HIGH-ORDER BITS ARE SENT FIRST.
   266
   267				DEFINE OUTBIT, <
   268				ZZZ(HSH)	;HUSH - SUPRESS MESSAGES FROM INITIALIZATION ROUTINE
   269				ZZZ(TRO)	;TERMINATE BLOCK OUTPUT
   270				ZZZ(CGB)	;CHARACTER GOBBLER
   271				ZZZ(BIN)	;BLOCK INPUT
   272				ZZZ(TRI)	;TERMINATE BLOCK INPUT
   273				ZZZ(BPN)	;BACKPRESSURE ON
   274				ZZZ(BPF)	;BACKPRESSURE OFF
   275				;-------messages above this line may be output on a backpressured port
   276				ZZZ(BOP)	;BLOCK OUTPUT IN PROGRESS (PTYS ONLY)
   277				ZZZ(SRD)	;RED BALL
   278				ZZZ(SEC)	;ECHO MODE
   279				ZZZ(STP)	;TERMINAL CHARACTERISTICS PROBE
   280				ZZZ(STC)	;SET TERMINAL CHARACTERISTICS
   281				ZZZ(SBL)	;SEND BELL (!)
   282				ZZZ(FIL)	;FILLER CHARACTERS
   283				ZZZ(RUB)	;RUBOUT CHARACTERS
   284				ZZZ(OUT)	;OUTPUT CHARACTERS
   285				ZZZ(BOT)	;BLOCK OUTPUT
   286				ZZZ(SYL)	;YELLOW BALL	(Set by TTYZAP if not a zap from Tymnet)
   287				ZZZ(HNG)	;SOFT ZAP	(Drop DTR to autodial modem, keep circuit)
   288				ZZZ(ZAP)	;HARD ZAP	(Wait for orange ball if host initiated)
   289				ZZZ(ECO)	;ECHO CHARACTERS
   290				ZZZ(SGR)	;GREEN BALL
   291				ZZZ(SOG)	;ORANGE BALL
   292				>
   293
   294			000000	ZZN==0
   295				DEFINE ZZZ(NAME), <
   296					IFE <ZZN-36>, <
   297						PRINTX MORE THAN 36 OUTPUT BITS
   298						QQQQQQ
   299					>
   300					LOP'NAME:POINT 1,LDBOUT(U),ZZN
   301					ZZN==ZZN+1
   302				>
   303	000054'	430105	000003	OUTBIT
   304	000055'	420105	000003
   305	000056'	410105	000003
   306	000057'	400105	000003
   307	000060'	370105	000003
   308	000061'	360105	000003
   309	000062'	350105	000003
   310	000063'	340105	000003
   311	000064'	330105	000003
   312	000065'	320105	000003
   313	000066'	310105	000003
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 7-2
SCNSER.MAC	25-NOV-87 19:52		OUTPUT REQUEST BITS

   314	000067'	300105	000003
   315	000070'	270105	000003
   316	000071'	260105	000003
   317	000072'	250105	000003
   318	000073'	240105	000003
   319	000074'	230105	000003
   320	000075'	220105	000003
   321	000076'	210105	000003
   322	000077'	200105	000003
   323	000100'	170105	000003
   324	000101'	160105	000003
   325	000102'	150105	000003
   326
   327			000006	BPOKBN==LOPBPF-LOPHSH	;BIT# OF LOWEST-PRIORITY MESSAGE
   328							;THAT CAN BE SENT ON A BACKPRESSURED PORT
   329			000024	NUMECO==LOPECO-LOPHSH	;BIT # OF ECHO
   330			000026	LAPBIT==LOPSOG-LOPHSH   ;LAST LEGAL PRIORITY BIT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 8
SCNSER.MAC	25-NOV-87 19:52		LINE DATA BLOCK

   331				SUBTTL LINE DATA BLOCK
   332
   333				;LINTAB:	ONE WORD PER PORT. RH = ADR OF LINE DATA BLOCK
   334				;		LH 13-17 =0 FOR @ LINTAB
   335
   336				;LDBDDB		ONE LINE DATA BLOCK PER PORT. LINK BETWEEN
   337				;		THE LINE DATA BLOCK AND THE TTY F IS THE
   338				;		THING MANIPULATED BY ATTACH AND DETACH.
   339
   340	000000			CTYLDB::PHASE	0	;TTY LDB PROTOTYPE
   341	000000			LDICLR:!
   342	000103'	000000	000000	LDBDDB::!0	;(RH)	ADDR OF ATTACHED DDB, IF ATTACHED
   343	000104'	000000	000000	LDBLIN:! 0	;27-35	Port number (LDPLNO, 9 bits)
   344						;18-26	9 unused bits
   345						; 2-17	Origination host number (LDPHST, 16 bits)
   346						; 1	1 unused bit
   347			400000	LNLZIN==400000	; 0	Zapper received from TYMNET & not echoed yet
   348	000105'	000000	000000	LDBOPB:! 0	;BYTE POINTER TO SET NEED-OUTPUT BIT
   349	000106'	000000	000000	LDBOUT:! 0	;BITS SPECIFYING WHAT WANTS TO BE OUTPUT
   350	000107'	000000	000000	LDBTCB:! 0	;(PTYS) BITS INDICATING CHANGED TERMINAL CHARACTERISTICS
   351
   352	000110'	000000	000000	LDBBIO:! 0	;(LH)	BLOCK OUTPUT BUFFER ADDR
   353						;(RH)	BLOCK INPUT BUFFER ADDR
   354
   355	000111'	000000	000000	LDBBKP:! 0	;^U POINTER, RESET TO HERE
   356	000112'	000000	000000	LDBBKI:! 0	;(RH)	# INPUT CHARACTERS SINCE LBBBKP
   357						;(LH)	# BREAK2 CHARACTERS SINCE LDBBKP
   358
   359	000113'	000000	000000	LDBTIP:! 0	;INPUT PUTTER
   360	000114'	000000	000000	LDBTIT:! 0	;INPUT TAKER
   361	000115'	000000	000000	LDBTIC:! 0	;# CHARACTERS IN INPUT BUFFER
   362	000116'	000000	000000	LDBECT:! 0	;ECHO TAKER
   363	000117'	000000	000000	LDBECC:! 0	;# CHARACTERS IN ECHO BUFFER
   364	000120'	000000	000000	LDBBKC:! 0	;(RH)	# BREAK CHARACTERS IN INPUT BUFFER
   365						;(LH)	# BREAK CHARACTERS IN ECHO BUFFER
   366	000121'	000000	000000	LDBBK2:! 0	;(RH)	# BREAK2 CHARACTERS IN INPUT BUFFER
   367						;(LH)	# BREAK2 CHARACTERS IN ECHO BUFFER
   368
   369	000122'	000000	000000	LDBTOP:! 0	;OUTPUT PUTTER
   370	000123'	000000	000000	LDBTOT:! 0	;OUTPUT TAKER
   371	000124'	000000	000000	LDBTOC:! 0	;# CHARACTERS IN OUTPUT BUFFER
   372
   373	000125'	000000	000000	LDBFLP:! 0	;OUTPUT FILLER POINTER (FOR HT/VT/FF PADDING)
   374
   375	000126'	000000	000000	LDBRBI:! 0	;RUBOUT ECHO PUTTER
   376	000127'	000000	000000	LDBRBO:! 0	;RUBOUT ECHO TAKER
   377	000130'	000000	000000	LDBRBC:! 0	;# RUBOUT ECHO CHARACTERS
   378	000131'	000000	000000	LDBLOG::!0	;TYMNET login data
   379						;< 0	logged-in, bits 4-35 hold data from supervisor
   380						;= 0	not in use
   381						;> 0	in the process of logging in
   382			200000	LLLZAP==200000	; 1	zapper received or HANG uuo done on port
   383			100000	LLLNLN==100000	; 2	no line, the base has given up on this port
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 8-2
SCNSER.MAC	25-NOV-87 19:52		LINE DATA BLOCK

   384						; 3     unused TYMCOM-X bit
   385						; 4-11  first byte from needle (bits 4&5 not used by EBUS)
   386			004000	LLLHDX==004000	; 6	terminal is half duplex (32.-63. decimal)
   387						; 7-11	terminal identifier code (0.-31. decimal)
   388						;14-19	originating node # (high-order 8 bits)
   389						;22-27	originating node # (low-order 6 bits) (20&21 unused)
   390						;29-35	originating port # (obsolete, not valid in ISIS CONSAT)
   391	000132'	000000	000000	LDBBYT:! 0	;RANDOM BYTES
   392
   393			400000	L2LOEX==400000	;0	(MUST BE SIGN BIT) OUTPUT SHOULD BE
   394						;	GIVEN MORE ROOM (TO KEEP FROM TRAPPING
   395						;	DURING AN OUTSTR)
   396			200000	L2LCCS==200000	;1	SEEN 1 ESCAPE/^C
   397			100000	L2LTBK==100000	;2	(LDPTBK) TABS ARE BREAKS (BREAKSET 2 MODE)
   398			040000	L2LBBP==040000	;3	(LDPBBP) BACKSPACE IS PUNCTATION, NOT A BREAK
   399			020000	L2LNTB==020000	;4	(LDPNTB) DON'T ECHO HT, VT, FF
   400			010000	L2LLDF==010000	;5	JOB WANTS TO LEAVE DEFERRED ECHO MODE
   401			004000	L2LDEL==004000	;6	DELETE IN PROGRESS (I.E., WE HAVE TYPED
   402						;	A SLASH AND ARE ECHOING DELETED CHARS)
   403			002000	L2LOWS==002000	;7	ONCE-IN-20-SECOND LOGIC HAS FOUND
   404						;	L2LOWT    405			001000	L2LBSP==001000	;8	(LDPBSP) SEND BACKSPACE FOR CHARACTER-DELETES
   406			000400	L2LOWT==000400	;9	LOGOUT LOGIC HAS SENT A YELLOW BALL AND
   407						;	IS WAITING FOR AN ORANGE BALL BACK
   408						;10-11	(LDPMOD) MONITOR MODE
   409						;12-13	(LDPFC2) FILLER CLASS 2 (HT)
   410						;14-21	(LDPWID) LINE WIDTH
   411						;22-23	(LDPFC1) FILLER CLASS 1 (VT FF)
   412						;24-27	(LDPTIM) IMAGE-INPUT-TIMEOUT TIMER
   413						;28-35	(LDPPOS) CURRENT LINE POSITION (0-511.)
   414	000133'	000000	000000	LDBMOD:! 0	;BYTES TO INDICATE THE MODE LINE IS IN
   415
   416			400000	LMLTBI==400000	;0	TRMI REQUESTED BUT TRMIHR NOT RECEIVED
   417			200000	LMLPSP==200000	;1	1 IF PORT STATUS RECEIVED BUT NOT READ
   418						;2-5	LAST PORT STATUS MESSAGE RECEIVED (see comment @ ACPSM)
   419			001000	LMLBIO==001000	;8	PORT ENABLED FOR BLOCK I/O
   420						;9-15	IMAGE COUNT FOR CHARGING
   421						;16-22	LINE MODE BITS FOR INPUT
   422						;16-18	ECHO MODE
   423						;19-22	INPUT MODE
   424						;23-31	IMAGE MODE BREAK CHARACTER
   425						;32-35	(UNUSED)
   426	000134'	000000	000000	LDBDCH::!0	;DEVICE CHARACTERISTICS
   427
   428				;BITS IN LH
   429
   430			400000	LDLNOP==400000	; *0	TYMNET REQUESTS NO MORE OUTPUT
   431						;	(MUST BE SIGN BIT)
   432			200000	LDLSOX==200000	;  1	SUPPRESS OUTPUT TRANSLATION
   433			100000	LDLECS==100000	; *2	EAT COMMAND SYNC
   434			040000	LDLPTY==040000	;  3	PSEUDO-TTY
   435			020000	LDLCOM==:20000	;! 4	IN COMMAND MODE
   436			010000	LDLBKA==010000	;! 5	SINGLE CHARACTER ACTIVATES
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 8-3
SCNSER.MAC	25-NOV-87 19:52		LINE DATA BLOCK

   437			004000	LDLBK2==004000	;! 6	IN BREAK2 MODE
   438			002000	LDLIMI==002000	;! 7	IN IMAGE MODE
   439			001000	LDLDEF==001000	;!*8	DEFERRED ECHO MODE
   440			000400	LDLOSU==000400	; *9	OUTPUT SUPRESS (^O)
   441			000200	LDLNFC==000200	; *10	NO FREE CRS ON LONG LINES
   442			000100	LDLNEC==000100	; *11	NO ECHO
   443			000040	LDLAUX==000040	; *12	AUX CIRCUIT
   444			000020	LDLLCT==000020	; *13	LOWER CASE TO UPPER CASE
   445			000010	LDLTAB==000010	; *14	TTY DOES TABS
   446			000004	LDLLCP==000004	; *15	LOCAL COPY (2741)
   447			000002	LDLPTP==000002	; *16	IN PAPER TAPE MODE
   448			000001	LDLFRM==000001	; *17	TTY DOES FORMS AND VTABS
   449
   450				;! -- REFERENCED THROUGH LDPMDF TO SET LINE MODE
   451				;* -- GIVEN TO USER IN SAME BIT POSITION BY GETLCH
   452
   453				;BITS IN RH
   454
   455			400000	LDRBPS==400000	;BACKPRESSURE HAS BEEN SENT
   456			200000	LDRXOS==200000	;XOFF HAS BEEN SENT
   457			100000	LDRNXO==100000	;(LDPNXO) DON'T SEND XON/XOFF
   458			040000	LDRDEM==040000	;STAY IN DEFERRED ECHO MODE
   459			020000	LDRFCS==020000	;FULL CHARACTER SET MODE
   460			010000	LDRBIP==010000	;PTY BLOCK INPUT IN PROGRESS
   461	000135'	000000	000000	LDBDCX:! 0	;DEVICE CHARACTERISTICS EXTENSION
   462
   463				;BITS IN LH
   464
   465			400000	LXL120==400000	;1 IF FAST LINE, 0 IF SLOW (MUST BE SIGN BIT)
   466				;LXLxx==200000	;(UNUSED 2-6-81)
   467			100000	LXLBSD==100000	;BACKSPACE == RUBOUT/^A (LPDBSD)
   468			040000	LXLERA==040000	;IF L2LBSP SET: SEND <BS><SP><BS> NOT JUST <BS>
   469						;FOR CHARACTER DELETE (LDPERA)
   470			020000	LXLDLR==020000	;SUPPRESS $ ECHO ON ALTMODES
   471			010000	LXLLCO==010000	;SET FOR CONV OF UPPER TO LOWER CASE ON OUTPUT (LDPLCO)
   472			004000	LXLOOK==004000	;OK TO SEND ORANGE BALL -- SET WHEN A YELLOW BALL
   473						;ARRIVES THAT THE MONITOR DIDN'T REFLECT (BECAUSE
   474						;THE USER WAS TRAPPING YELLOW BALLS)
   475			002000	LXLRTC==002000	;[Darren] Half-assed ^R/^T compatibility - says to
   476						; treat ^T as .USESTAT command if set.
   477
   478				;BITS IN RH -- SET WHEN EVENTS THAT COULD CAUSE INTERRUPTS
   479				;	       HAPPEN TO A PORT FOR LATER POLLING WITH
   480				;	       GETLCH OR THE POLPRT UUO (WHICH CLEAR
   481				;	       THE BITS READ)
   482
   483			400000	LXRESC==400000	;ESCAPE SEEN
   484			200000	LXROBS==200000	;ORANGE BALL SEEN
   485			100000	LXRPSS==100000	;PORT STATUS MESSAGE SEEN (see comment at ACPSM)
   486			040000	LXRICL==040000	;INPUT CHARACTERS LOST
   487			020000	LXROCL==020000	;OUTPUT CHARACTERS LOST
   488			010000	LXRCHR==010000	;CHARACTER SEEN
   489			004000	LXRBRK==004000	;BREAK CONDITION SEEN:
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 8-4
SCNSER.MAC	25-NOV-87 19:52		LINE DATA BLOCK

   490						;1) BREAK CHARACTER READ IN NORMAL STATE
   491						;2) IMAGE BREAK HAPPENED IN IMAGE STATE
   492						;3) BREAK2 CHARACTER READ WITH BK2 SET
   493						;4) BLOCK RECEIVED IN BLOCK INPUT MODE
   494			002000	LXRYBS==002000	;YELLOW BALL SEEN
   495			001000	LXRCGS==001000	;CHARACTER GOBBLER SEEN
   496			000400	LXRIOS==000400	;OUTPUT DONE
   497			000200	LXRTCC==000200	;TERMINAL CHARACTERISTIC CHANGED OR PORT JUST ATTACHED
   498
   499	000136'	000000	000000	LDBCLA:! 0	; [dws] Optional sixbit terminal class
   500			000033	LDBTYP==LDBCLA	;[JMS] TYPE same as CLASS for now
   501	000034			LDBSTR::!BLOCK AUXSTL	;SPACE FOR AUX CIRCUIT STRING (LH of CONFIG item 154)
   502	000044			LDBTMR:! BLOCK TMCSIZ	;TERMINAL CHARACTERISTICS RECEIVED
   503	000045			LDBTMS:! BLOCK TMCSIZ	;TERMINAL CHARACTERISTICS TO BE SENT
   504	000151'	000000	000000	LDBTMT:! 0		;BIT N=1 TO SEND T.C. N
   505
   506				;LDBTMT BIT DEFINITIONS
   507
   508			000000	ZZN==0
   509				DEFINE TC(N,Z) <LTS'N==1B<ZZN>
   510				ZZN==ZZN+1>
   511				;TTY LDB. THERE IS ONE OF THESE PER PORT.
   512				TERCHR
   513
   514			000046	LDICLE==.-1
   515	000152'			DEPHASE
   516			000047	LDBLEN==:.-CTYLDB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 9
SCNSER.MAC	25-NOV-87 19:52		RANDOM LDB BYTE POINTERS

   517				SUBTTL	RANDOM LDB BYTE POINTERS
   518
   519	000152'	300505	000026	TRMBYP:	POINT  5,LDBLOG(U),11	;Terminal ID code (see also LLLHDX)
   520
   521	000153'	001105	000001	LDPLNO::POINT  9,LDBLIN(U),35	;Port number (TTY0 thru TTY777)
   522	000154'	222005	000001	LDPHST:	POINT 16,LDBLIN(U),17	;Origination host number (new in EBUS 2.01)
   523
   524	000155'	410105	000027	LDPTBK:	POINT 1,LDBBYT(U),2	;TABS-AS-BREAKS
   525	000156'	400105	000027	LDPBBP:	POINT 1,LDBBYT(U),3	;BACKSPACE-AS-PUNCTUATION
   526	000157'	370105	000027	LDPNTB:	POINT 1,LDBBYT(U),4	;NO SPECIAL TAB HANDLING
   527	000160'	330105	000027	LDPBSP:	POINT 1,LDBBYT(U),8	;BS OR ERASE FOR CHAR DELETE
   528	000161'	300205	000027	LDPMOD:	POINT 2,LDBBYT(U),11	;MONITOR MODE
   529	000162'	260205	000027	LDPFC2:	POINT 2,LDBBYT(U),13	;FILLER CLASS 2
   530	000163'	260214	000027	LDPFA2:	POINT 2,LDBBYT(P1),13
   531	000164'	161005	000027	LDPWID:	POINT 8,LDBBYT(U),21	;LINE WIDTH
   532	000165'	161014	000027	LDPWDA:	POINT 8,LDBBYT(P1),21
   533	000166'	140205	000027	LDPFC1:	POINT 2,LDBBYT(U),23	;FILLER CLASS 1
   534	000167'	140214	000027	LDPFA1:	POINT 2,LDBBYT(P1),23
   535	000170'	100405	000027	LDPTIM:	POINT 4,LDBBYT(U),27	;IMAGE INPUT TIMEOUT TIMER
   536	000171'	001005	000027	LDPPOS:	POINT 8,LDBBYT(U),35	;ESTIMATED POSITION ON LINE
   537
   538	000172'	360405	000030	LDPPSM:	POINT 4,LDBMOD(U),5	;LAST PORT-STATUS MSG
   539	000173'	240705	000030	LDPCHG:	POINT 7,LDBMOD(U),15	;IMAGE COUNT FOR CHARGING
   540	000174'	150705	000030	LDPLMD:	POINT 7,LDBMOD(U),22	;ALL THE LINE MODE (INPUT AND ECHO)
   541	000175'	210305	000030	LDPMEC:	POINT 3,LDBMOD(U),18	;ECHO LINE MODE
   542	000176'	150405	000030	LDPMIN:	POINT 4,LDBMOD(U),22	;INPUT LINE MODE
   543	000177'	041105	000030	LDPIMB:	POINT 9,LDBMOD(U),31	;IMAGE MODE BREAK CHARACTER
   544	000200'	000405	000030	LDPMOU:	POINT 4,LDBMOD(U),35	;OUTPUT LINE MODE
   545
   546	000201'	420105	000031	LDPSOX:	POINT 1,LDBDCH(U),1	;SUPPRESS OUTPUT TRANSLATION
   547	000202'	370105	000031	LDPCOM:	POINT 1,LDBDCH(U),4	;COMMAND MODE BIT
   548	000203'	330505	000031	LDPMDF:	POINT 5,LDBDCH(U),8	;SOURCE OF LINE MODE INFO
   549	000204'	310105	000031	LDPNFC:	POINT 1,LDBDCH(U),10	;NO FREE CRLFS
   550	000205'	260105	000031	LDPLCT:	POINT 1,LDBDCH(U),13	;LOWER CASE TRANSLATION (TO UPPER)
   551	000206'	250105	000031	LDPTAB:	POINT 1,LDBDCH(U),14	;HARDWARE TABS
   552	000207'	230105	000031	LDPPTP:	POINT 1,LDBDCH(U),16	;PAPER TAPE MODE
   553	000210'	220105	000031	LDPFRM:	POINT 1,LDBDCH(U),17	;HARDWARE FF/VT
   554	000211'	170105	000031	LDPNXO:	POINT 1,LDBDCH(U),20	;DON'T SEND XON/XOFF
   555	000212'	160105	000031	LDPDEM:	POINT 1,LDBDCH(U),21	;PERPETUAL DEFERRED ECHO MODE
   556
   557	000213'	410105	000032	LDPBSD:	POINT 1,LDBDCX(U),2	;BACKSPACE == RUBOUT/^A
   558	000214'	400105	000032	LDPERA:	POINT 1,LDBDCX(U),3	;ERASE ON CHAR DEL
   559	000215'	360105	000032	LDPLCO:	POINT 1,LDBDCX(U),5	;LOWER CASE OUTPUT ONLY
   560	000216'	340105	000032	LDPRTC:	POINT 1,LDBDCX(U),7	;[Darren] special ^T mode
   561	000217'	004405	000033	LDPCLA:	POINT 36,LDBCLA(U),35	;Terminal CLASS
   562	000220'	004405	000033	LDPTYP:	POINT 36,LDBTYP(U),35	;Terminal TYPE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 10
SCNSER.MAC	25-NOV-87 19:52		DEVICE DATA BLOCK

   563				SUBTTL DEVICE DATA BLOCK
   564
   565				;TTY DDB INTERRUPT-TO-CHANNEL BYTE POINTERS
   566
   567			000000	ZZWORD==0
   568		777777	777777	ZZBIT==-1
   569				DEFINE ZZZ(N) = <IFG <ZZBIT+6>-^D35,<ZZBIT==-1
   570				ZZWORD==ZZWORD+1>
   571				ZZBIT==ZZBIT+6
   572				DDPT'N:	POINT 6,DDBTRP+ZZWORD(F),ZZBIT>
   573
   574	000221'			DDPTAB:
   575
   576	000221'	360604	000014	ZZZ(SC)	;ESCAPE/^C RECEIVED
   577	000222'	300604	000014	ZZZ(CH)	;CHARACTER RECEIVED
   578	000223'	220604	000014	ZZZ(LN)	;BREAK RECEIVED
   579	000224'	140604	000014	ZZZ(TI)	;I/O WAIT
   580	000225'	060604	000014	ZZZ(TS)	;I/O WAIT SATISFIED
   581	000226'	000604	000014	ZZZ(LC)	;LOST CHARACTERS
   582	000227'	360604	000015	ZZZ(OB)	;ORANGE BALL RECEIVED
   583	000230'	300604	000015	ZZZ(ZP)	;ZAPPER RECEIVED
   584	000231'	220604	000015	ZZZ(PS)	;PORT STATUS MESSAGE RECEIVED   (See comment at ACPSM)
   585	000232'	140604	000015	ZZZ(YB)	;YELLOW BALL RECEIVED
   586	000233'	060604	000015	ZZZ(CG)	;CHARACTER GOBBLER RECEIVED
   587	000234'	000604	000015	ZZZ(TC)	;TERMINAL CHARACTERISTIC CHANGED AT OTHER END OF PTY
   588
   589			000014	TRPLEN==.-DDPTAB
   590
   591				;TRAP NUMBER INTERNALS
   592
   593			000000	TTNESC==:DDPTSC-DDPTAB
   594			000001	TTNCHR==:DDPTCH-DDPTAB
   595			000002	TTNLIN==:DDPTLN-DDPTAB
   596			000006	TTNYLB==:DDPTOB-DDPTAB
   597
   598				;OTHER DDB BYTE POINTERS
   599
   600	000235'	430104	000012	DDPBBP:	POINT 1,DDBDCH(F),0	;BACKSPACE AS PUNCTUATION
   601	000236'	420104	000012	DDPTBK:	POINT 1,DDBDCH(F),1	;TABS ARE BREAKS
   602	000237'	410104	000012	DDPNTB:	POINT 1,DDBDCH(F),2	;NO SPECIAL TAB ACTION
   603	000240'	001104	000012	DDPIMB: POINT 9,DDBDCH(F),35	;IMAGE MODE BREAK CHARACTER
   604	000241'	000404	000002	DDPMOD: POINT 4,DEVIOS(F),35	;DATA MODE
   605	000242'	400104	000012	DDPCOM: POINT 1,DDBDCH(F),3	;SAVED STATE OF LDLCOM
   606	000243'	360104	000004	DDPNZP:	POINT 1,DEVMOD(F),5	;NO-ZAP BIT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 11
SCNSER.MAC	25-NOV-87 19:52		TTY DDB. ONCE CREATES ONE OF THESE PER JOB FOR TTYTAB TO POINT TO.

   607				SUBTTL	TTY DDB. ONCE CREATES ONE OF THESE PER JOB FOR TTYTAB TO POINT TO.
   608
   609	000244'			TTYLST:		;LABEL FOR FIRST TTY DDB IN CHAIN
   610	000000			SCNDDB::PHASE	0	;GLOBAL LABEL
   611	000244'	646471	200000		SIXBIT /TTY0/		;DEVNAM (PHYSICAL NAME)
   612	000245'	000000	000021		XWD 0,STTYBF+1		;DEVCHR. SIZE OF USER BUFFER
   613	000246'	000000	000000		0			;DEVIOS
   614	000247'	000000	006263'		XWD 0,SCNDSP		;DEVSER
   615	000250'	000013	014407		XWD DVTTY+DVIN+DVOUT,<<1_B>+<1_A>+<1_AL>+<1_I>+<1_IB>+<1_XA>>
   616								;DEVMOD
   617	000251'	000000	000000		0			;DEVLOG (LOGICAL NAME)
   618	000252'	000000	000000		0			;DEVBUF
   619	000253'	000000	000000		0			;DEVIAD
   620	000254'	000000	000000		0			;DEVOAD
   621	000255'	200000	000000	DEVCLS:! XWD 200000,0		;CLASS
   622	000256'	000000	000000	DDBDCH:! 0	;PROCESS-RELATED DEVICE CHARACTERISTICS NOT IN DEVIOS
   623			400000		DCLBBP==400000	;0	BACKSPACE IS PUNCTATION (DDPBBP)
   624			200000		DCLTBK==200000	;1	TABS ARE BREAKS (DDPTBK)
   625			100000		DCLNTB==100000	;2	DON'T ECHO HT/VT/FF (DDPNTB)
   626			040000		DCLCOM==040000	;3	SAVED STATE OF LDLCOM (DDPCOM)
   627							;27-35	IMAGE MODE BREAK CHARACTER (DDPIMB)
   628	000013			DDBBLK::!			;(LH) BACK LINK (PREVIOUS TTY DDB)
   629	000257'	000000	000000	DDBLDB::!0			;(RH) LDB ADDR
   630	000014			DDBTRP:! BLOCK <TRPLEN+5>/6	;INTERRUPT-TO-CHANNEL ASSIGNMENTS
   631
   632	000262'			DEPHASE
   633
   634			000016	SCNDDS==:.-SCNDDB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 12
SCNSER.MAC	25-NOV-87 19:52		TTY FILE STATUS BITS

   635				SUBTTL	TTY FILE STATUS BITS
   636
   637				;LEFT HALF
   638
   639			400000	TTYOUW==:400000	;0	TI MEANS OUTPUT WAIT, NOT INPUT WAIT
   640			200000	TWTSPC== 200000	;1	TI BECAUSE SYSTEM OUT OF BUFFERLETS
   641			100000	IOSBKA== 100000	;2	BREAK ON ALL CHARACTERS
   642			040000	TINFIO== 040000	;3	CAUSE AN OUTPUT-DONE INTERRUPT WHEN OUTPUT DONE
   643			020000	TIOUSE== 020000	;4	UUO IN PROGRESS, DON'T ZAP DDB
   644
   645				;RIGHT HALF
   646
   647			001000	BK2IOS== 001000	;26	BREAK ON PUNCTUATION
   648			000400	DLRSUP== 000400	;27	NO ESCAPE ECHO
   649			000200	NOECHO== 000200	;28	NO ECHO
   650			000100	FCS==    000100	;29	FULL CHARACTER SET
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 13
SCNSER.MAC	25-NOV-87 19:52		HOST TO BASE AND BASE TO HOST MESSAGE TYPES

   651				SUBTTL	HOST TO BASE AND BASE TO HOST MESSAGE TYPES
   652
   653				;Buffer ring message formats
   654
   655				;Each logical record in the buffer ring is some number of 8-bit bytes.
   656				;These start on a word boundry, the last 4 bits of each PDP-10 word are
   657				;ignored, and records currently do not wrap around in the buffer.
   658
   659				;The first byte of each logical record is the message type, the next 8 bits
   660				;is the port number.  If the high order bit is set in the message type, then
   661				;the remaining 7 bits in the first byte specify the number of characters that
   662				;follow.  Otherwise the first byte is a command code.
   663
   664				;BASE HOST    "{"=from host, "}"=to host, "#"=crash, "-"=ignore
   665				;00##00	UNUSED, ERROR
   666				;TYP.00,xxx,xxx,xxx
   667
   668				;01{-01	SYSTEM IS ANSWERED, IGNORED ON INPUT BY KI/KL/F3, CHECKED BY KS
   669			000001	TYPANS==01 ;xxx,xxx,xxx
   670
   671				;02{-01	SYSTEM IS SHUT, IGNORED ON INPUT
   672			000002	TYPSHT==02 ;xxx,xxx,xxx
   673
   674				;03{}03	RESET THE INTERFACE, QUIETLY ZAP ALL CIRCUITS (DR11 IS BAD ON KS)
   675			000003	TYPRES==03 ;DEBUGF,VER,REV      (used to be TYPCRS - sender has crashed)
   676
   677				;04#}04	RESET ACKNOWLEGE, TELL DEBUG STATUS, VERSION NUMBER, REVISION LEVEL
   678			000004	TYPRAK==04 ;DEBUGF,VER,REV      (used to be TYPDIE - recipient should crash)
   679
   680				;05#}05	THE NODE HAS BEEN TAKEN OVER BY A NEW SUPERVISOR
   681			000005	TYPNSP==05 ;000,xxx,xxx
   682
   683				;06#}06	EXTERNALLY INITIATED NEW CIRCUIT.  TREAT NEXT SET OF DATA BYTES SPECIAL
   684			000006	TYPLOG==06 ;PORT,xxx,xxx
   685
   686				;07#}07	SUPERVISOR RESPONSE TO ESTABLISHING AN AUX CIRCUIT
   687			000007	TYPAUX==07 ;NEWPORT,KEY,xxx
   688
   689				;08{}10	BACKPRESSURE ON
   690			000010	TYPNOP==10 ;PORT,xxx,xxx
   691
   692				;09{}11	BACKPRESSURE OFF
   693			000011	TYPOUP==11 ;PORT,xxx,xxx
   694
   695				;0A{}12	CHARACTER GOBBLER, IGNORED ON INPUT
   696			000012	TYPGOB==12 ;PORT,xxx,xxx
   697
   698				;0B{}13	CIRCUIT ZAPPER, RECIPIENT MUST ECHO ZAPPER ON SAME PORT
   699			000013	TYPZAP==13 ;PORT,xxx,xxx
   700
   701				;0C{}14	ENTER DEFERED ECHO MODE
   702			000014	TYPEDC==14 ;PORT,xxx,xxx
   703
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 13-2
SCNSER.MAC	25-NOV-87 19:52		HOST TO BASE AND BASE TO HOST MESSAGE TYPES

   704				;0D{}15	LEAVE DEFERRED ECHO MODE
   705			000015	TYPLDC==15 ;PORT,xxx,xxx
   706
   707				;0E{}16	GREEN BALL
   708			000016	TYPGRN==16 ;PORT,xxx,xxx
   709
   710				;0F{}17	RED BALL
   711			000017	TYPRED==17 ;PORT,xxx,xxx
   712
   713				;10{}20	YELLOW BALL
   714			000020	TYPYEL==20 ;PORT,xxx,xxx
   715
   716				;11{}21	ORANGE BALL
   717			000021	TYPORG==21 ;PORT,xxx,xxx
   718
   719				;12{-22	HANG CHARACTER (DROP DTR, DON'T ZAP CIRCUIT, IGNORED ON INPUT)
   720			000022	TYPHNG==22 ;PORT,xxx,xxx
   721
   722				;13{-23	ENTER 2741 TRANSPARENT MODE (IGNORED ON INPUT)
   723			000023	TYPETM==23 ;PORT,xxx,xxx
   724
   725				;14{-24	LEAVE 2741 TRANSPARENT MODE (IGNORED ON INPUT)
   726			000024	TYPLTM==24 ;PORT,xxx,xxx
   727
   728				;15#}25	LOST BALL.  BLACK BALL IF DATA=FF, GRAY BALL IF DATA=00
   729			000025	TYPLOS==25 ;PORT,DATA,xxx
   730
   731				;16{#26	REQUEST NEW PORT NUMBER FOR BUILDING AUX CIRCUIT (KEY RETURNED BY 07)
   732			000026	TYPSUP==26 ;KEY,000,xxx
   733
   734				;17#}27	SUPERVISOR RESPONSE, 3RD BYTE IS ERROR CODE
   735			000027	TYPSUR==27 ;KEY,ERRCODE,xxx
   736
   737				;18{#30	SUPERVISOR LOGIN CHARACTER IN 3RD BYTE
   738			000030	TYPAXC==30 ;KEY,CHAR,xxx
   739
   740				;19{#31	TEST PATTERN PROBE (32 BITS OF TEST DATA)
   741			000031	TYPTSP==31 ;PORT,DATA1,DATA2,  DATA3,DATA4,xxx,xxx
   742
   743				;1A#}32	TEST PATTERN RESPONSE
   744			000032	TYPTSR==32 ;PORT,DATA1,DATA2,  DATA3,DATA4,xxx,xxx
   745
   746				;1B{#33	HOST SAD, 32 UNHAPPY BITS
   747			000033	TYPSAD==33 ;000,DATA1,DATA2,  DATA3,DATA4
   748
   749				;1C{#34	ECHO ON
   750			000034	TYPECN==34 ;PORT,xxx,xxx
   751
   752				;1D{#35	ECHO OFF
   753			000035	TYPECF==35 ;PORT,xxx,xxx
   754
   755				;1E{#36	SET TERMINAL CHARACTERISTICS, NUMBER AND VALUE
   756			000036	TYPTCS==36 ;PORT,TCHNUM,VALUE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 13-3
SCNSER.MAC	25-NOV-87 19:52		HOST TO BASE AND BASE TO HOST MESSAGE TYPES

   757
   758				;1F{#37	TERMINAL CHARACTERISTICS PROBE, FOR A PARTICULAR TCHNUM
   759			000037	TYPTCP==37 ;PORT,TCHNUM,xxx
   760
   761				;20#}40	TERMINAL CHARACTERISTICS RESPONSE, ANSWER TO PROBE
   762			000040	TYPTCR==40 ;PORT,TCHNUM,VALUE
   763
   764				;21{#41	TELL SUPERVISOR NUMBER OF PORTS AND HOST NUMBER
   765			000041	TYPHSI==41 ;MAXPORT,HOST#,xxx
   766
   767				;22{#42	REQUEST FOR SUPERVISOR CLOCK INFO (BASE IGNORES THIS)
   768			000042	TYPCLP==42 ;xxx,xxx,xxx
   769
   770				;23#}43	RESPONSE WITH SUPERVISOR CLOCK INFO IN SECONDS SINCE 1-JAN-1974
   771			000043	TYPCLR==43 ;000,DATA1,DATA2,  DATA3,DATA4,xxx,xxx
   772
   773				;24{#44	INITIATE BLOCK OUTPUT
   774			000044	TYPBKO==44 ;PORT,COUNT1,COUNT2,  ADDR1,ADDR2,ADDR3,xxxx
   775
   776				;25#}45	BLOCK OUTPUT COMPLETE
   777			000045	TYPBOC==45 ;PORT,xxx,xxx
   778
   779				;26{#46	INITIATE BLOCK INPUT
   780			000046	TYPBIN==46 ;PORT,COUNT1,COUNT2,  ADDR1,ADDR2,ADDR3,xxxx
   781
   782				;27#}47	BLOCK INPUT TERMINATED - OUT OF BUFFER
   783			000047	TYPINB==47 ;PORT,COUNT1,COUNT2
   784
   785				;28#}50	BLOCK INPUT TERMINATED - END OF TRANSMISSION
   786			000050	TYPINE==50 ;PORT,COUNT1,COUNT2
   787
   788				;29#}51	BLOCK INPUT TERMINATED - TIMEOUT BY BASE
   789			000051	TYPINT==51 ;PORT,COUNT1,COUNT2
   790
   791				;2A{#52	REQUEST BLOCK INPUT TERMINATION
   792			000052	TYPIRQ==52 ;PORT,xxx,xxx
   793
   794				;2B#}53	BLOCK INPUT TERMINATED - BY HOST REQUEST
   795			000053	TYPIHR==53 ;PORT,COUNT1,COUNT2
   796
   797				;2C{#54	REQUEST BLOCK OUTPUT TERMINATION
   798			000054	TYPORQ==54 ;PORT,xxx,xxx
   799
   800				;2D#}55	BLOCK OUTPUT TERMINATED - BY HOST REQUEST
   801			000055	TYPOHR==55 ;PORT,xxx,xxx
   802
   803				;2E{}56	NEGOTIATE FOR NUMBER OF BLOCK I/O PORTS
   804			000056	TYPNEG==56 ;PORT,DATA,xxx
   805
   806				;2F#}57	BREAK RECIEVED
   807			000057	TYPBRK==57 ;PORT,xxx,xxx
   808
   809				;30#}60	PORT STATUS RECEIVED  (Obsolete, not in EBUS, see comment at ACPSM)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 13-4
SCNSER.MAC	25-NOV-87 19:52		HOST TO BASE AND BASE TO HOST MESSAGE TYPES

   810			000060	TYPPSR==60 ;PORT,DATA,xxx
   811
   812				;31{-61	ENTER ALTERNATE DEVICE MODE (TURN ON PRINTER), IGNORED ON INPUT
   813			000061	TYPEAD==61 ;PORT,xxx,xxx
   814
   815				;32{-62	LEAVE ALTERNATE DEVICE MODE (TURN OFF PRINTER), IGNORED ON INPUT
   816			000062	TYPLAD==62 ;PORT,xxx,xxx
   817
   818				;33{#63	SET KEEP-ALIVE-FAILURE TIMER
   819			000063	TYPKAF==63 ;000,DATA1,DATA2
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 14
SCNSER.MAC	25-NOV-87 19:52		Special KS2020 microcode for KMC

   820				SUBTTL	Special KS2020 microcode for KMC
   821
   822				IFKMC<
   823					BYP1==^D9	;RIGHTMOST BIT POSITION OF FIRST BYTE
   824					BYP2==^D17	;      SECOND BYTE OF A BUFFER RING WORD
   825					BYP3==^D27	;      THIRD BYTE
   826					BYP4==^D35	;      LAST BYTE POSITION IN A BUF RING WORD
   827					OPDEF	UUILDB	[101000,,0]	;KMC ILDB
   828					OPDEF	UUIDPB	[102000,,0]	;KMC IDPB
   829					OPDEF	EXTEND	[123000,,0]	;EXTENDED INSTRUCTION OPCODE
   830					OPDEF	MOVSLJ	[016000,,0]	;MOVE STRING LEFT JUSTIFIED
   831					DEFINE	TYPI(TYPE)		;FOR LOADING TYPES WITH A
   832					<TYPE_^D8>			;	MOVSI INSTR
   833					>;END IFKMC
   834				IFNKMC<
   835			000007		BYP1==^D7	;RIGHTMOST BIT POSITION OF FIRST BYTE
   836			000017		BYP2==^D15	;      SECOND BYTE OF A BUFFER RING WORD
   837			000027		BYP3==^D23	;      THIRD BYTE
   838			000037		BYP4==^D31	;      LAST BYTE POSITION IN A BUF RING WORD
   839					OPDEF	UUILDB	[ILDB 0]	;NORMAL ILDB
   840					OPDEF	UUIDPB	[IDPB 0]	;NORMAL IDPB
   841					DEFINE	TYPI(TYPE)		;FOR LOADING TYPES WITH A
   842					<TYPE_^D10>			;	MOVSI INSTR
   843					>;END IFNKMC
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 15
SCNSER.MAC	25-NOV-87 19:52		BUFFER RING BYTE POINTERS

   844				SUBTTL	BUFFER RING BYTE POINTERS
   845
   846	000262'	341017	000000*	INPTYP:	POINT 8,IRING(P4),BYP1	;TYPE
   847	000263'	241017	000262*	INPLIN:	POINT 8,IRING(P4),BYP2	;LINE NUMBER
   848	000264'	141017	000263*	INPCHR:	POINT 8,IRING(P4),BYP3	;CHARACTER
   849	000265'	041017	000264*	INPCH2:	POINT 8,IRING(P4),BYP4	;SECOND DATA CHARACTER
   850	000266'	242017	000265*	INPDL1:	POINT 16,IRING(P4),BYP2	;FIRST TWO CHRS
   851	000267'	042017	000266*	INPDL2:	POINT 16,IRING(P4),BYP4	;SECOND TWO CHRS
   852
   853				;POINTER FOR PUTTING THINGS IN THE OUTPUT RING
   854
   855	000270'	341017	000000*	OUPTYP:	POINT 8,ORING(P4),BYP1	;TYPE
   856	000271'	241017	000270*	OUPLIN:	POINT 8,ORING(P4),BYP2	;PORT NUMBER
   857
   858				;POINTERS FOR ASSEMBLING FULL WORDS FOR OUTPUT (IN P3)
   859
   860	000272'	241000	000016	WRPLIN:	POINT 8,P3,BYP2		;PORT NUMBER
   861	000273'	141000	000016	WRPCHR:	POINT 8,P3,BYP3		;DATA CHARACTER
   862	000274'	041000	000016	WRPCH2:	POINT 8,P3,BYP4		;SECOND DATA CHARACTER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 16
SCNSER.MAC	25-NOV-87 19:52		CHARACTER TABLES

   863				SUBTTL CHARACTER TABLES
   864
   865				;HERE IS THE CHARACTER TABLE. IT INCLUDES A CHARACTER MODE FOR
   866				;EACH OF INPUT, OUTPUT, ECHO, AND READ (BY PROGRAM). IT ALSO
   867				;INCLUDES A SPECIAL ACTION CODE FOR EACH OF THESE.
   868
   869				DEFINE CHRATR (INP,OUT,RED,ECH,SPAI,SPAO,SPAR,SPAE)
   870					<BYTE (2) INP,OUT (3) SPAO,RED,ECH,SPAR (5) SPAI (4) SPAE>
   871
   872	000275'	420200	000016	CHPINP:	POINT 2,P3,1	;POINTER TO THE INPUT FIELD
   873	000276'	400200	000016	CHPOUT:	POINT 2,P3,3	;POINTER TO THE OUTPUT FIELD
   874	000277'	350300	000016	CHPSPO:	POINT 3,P3,6	;POINTER TO THE OUTPUT SPECIAL ACTION FIELD
   875	000300'	320300	000016	CHPRED:	POINT 3,P3,9	;POINTER TO THE READ FIELD
   876	000301'	270300	000016	CHPECH:	POINT 3,P3,12	;POINTER TO THE ECHO FIELD
   877	000302'	240300	000016	CHPSPR:	POINT 3,P3,15	;POINTER TO THE READ SPECIAL ACTION FIELD
   878	000303'	170500	000016	CHPSPI:	POINT 5,P3,20	;POINTER TO THE INPUT SPECIAL ACTION FIELD
   879	000304'	130400	000016	CHPSPE:	POINT 4,P3,24	;POINTER TO THE ECHO SPECIAL ACTION FIELD
   880
   881				SALL
   882	000305'			CHRTAB:
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 17
SCNSER.MAC	25-NOV-87 19:52		CONTROL CHARACTERS

   883				SUBTTL	CONTROL CHARACTERS
   884
   885	000305'	101100	000000	CHRATR 0,2,2,2,0		;NULL
   886	000306'	101101	300000	CHRATR 0,2,2,2,13		;^A
   887	000307'	501100	000000	CHRATR 2,2,2,2			;^B
   888	000310'	100000	100000	CHRATR 0,2,0,0,1,0,0,0		;^C
   889				REPEAT 3,<
   890				CHRATR 2,2,2,2>			;^D,^E,^F
   891	000311'	501100	000000
   892	000312'	501100	000000
   893	000313'	501100	000000
   894	000314'	501140	000000	CHRATR 2,2,2,3			;^G
   895	000315'	020031	744000	CHRATR 0,0,0,0,17,4,6,11	;BACKSPACE
   896	000316'	004024	614000	CHRATR 0,0,0,0,6,1,5,3		;^I
   897	000317'	501140	000000	CHRATR 2,2,2,3			;LINE FEED
   898	000320'	411000	024000	CHRATR 2,0,2,0,0,2,0,5		;VERTICAL TAB
   899	000321'	415000	030000	CHRATR 2,0,2,0,0,3,0,6		;FORM FEED
   900	000322'	000400	204000	CHRATR 0,0,1,0,2,0,0,1		;RETURN
   901	000323'	501100	000000	CHRATR 2,2,2,2			;^N
   902	000324'	101100	300000	CHRATR 0,2,2,2,3		;^O
   903	000325'	501100	000000	CHRATR 2,2,2,2			;^P
   904	000326'	101100	400000	CHRATR 0,2,2,2,4		;^Q
   905				REPEAT 2,<
   906				CHRATR 2,2,2,2>			;^R,^S
   907	000327'	501100	000000
   908	000330'	501100	000000
   909	000331'	101102	000000	CHRATR 0,2,2,2,20		;^T
   910	000332'	101000	510000	CHRATR 0,2,2,0,5,0,0,2		;^U
   911				REPEAT 4,<
   912				CHRATR 2,2,2,2>			;^V,^W,^X,^Y
   913	000333'	501100	000000
   914	000334'	501100	000000
   915	000335'	501100	000000
   916	000336'	501100	000000
   917	000337'	500014	034000	CHRATR 2,2,0,0,0,0,3,7		;^Z
   918	000340'	100004	720000	CHRATR 0,2,0,0,7,0,1,4		;ESCAPE (33)
   919	000341'	101101	600000	CHRATR 0,2,2,2,16		;^\
   920	000342'	501100	000000	CHRATR 2,2,2,2			;^]
   921	000343'	101101	000000	CHRATR 0,2,2,2,10		;^^
   922	000344'	100111	100000	CHRATR 0,2,0,2,11,0,2,0		;^_
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 18
SCNSER.MAC	25-NOV-87 19:52		NUMBERS AND PUNCTUATION

   923				SUBTTL	NUMBERS AND PUNCTUATION
   924
   925				REPEAT 20,<
   926				CHRATR 3,1,3,4>			;PUNCTUATION
   927	000345'	641600	000000
   928	000346'	641600	000000
   929	000347'	641600	000000
   930	000350'	641600	000000
   931	000351'	641600	000000
   932	000352'	641600	000000
   933	000353'	641600	000000
   934	000354'	641600	000000
   935	000355'	641600	000000
   936	000356'	641600	000000
   937	000357'	641600	000000
   938	000360'	641600	000000
   939	000361'	641600	000000
   940	000362'	641600	000000
   941	000363'	641600	000000
   942	000364'	641600	000000
   943				REPEAT 12,<
   944				CHRATR 1,1,1,1>			;0-9
   945	000365'	240440	000000
   946	000366'	240440	000000
   947	000367'	240440	000000
   948	000370'	240440	000000
   949	000371'	240440	000000
   950	000372'	240440	000000
   951	000373'	240440	000000
   952	000374'	240440	000000
   953	000375'	240440	000000
   954	000376'	240440	000000
   955				REPEAT 7,<
   956				CHRATR 3,1,3,4>			;PUNCTUATION
   957	000377'	641600	000000
   958	000400'	641600	000000
   959	000401'	641600	000000
   960	000402'	641600	000000
   961	000403'	641600	000000
   962	000404'	641600	000000
   963	000405'	641600	000000
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 19
SCNSER.MAC	25-NOV-87 19:52		UPPER CASE

   964				SUBTTL	UPPER CASE
   965
   966				REPEAT 32,<
   967				CHRATR 1,3,1,1>			;A-Z
   968	000406'	340440	000000
   969	000407'	340440	000000
   970	000410'	340440	000000
   971	000411'	340440	000000
   972	000412'	340440	000000
   973	000413'	340440	000000
   974	000414'	340440	000000
   975	000415'	340440	000000
   976	000416'	340440	000000
   977	000417'	340440	000000
   978	000420'	340440	000000
   979	000421'	340440	000000
   980	000422'	340440	000000
   981	000423'	340440	000000
   982	000424'	340440	000000
   983	000425'	340440	000000
   984	000426'	340440	000000
   985	000427'	340440	000000
   986	000430'	340440	000000
   987	000431'	340440	000000
   988	000432'	340440	000000
   989	000433'	340440	000000
   990	000434'	340440	000000
   991	000435'	340440	000000
   992	000436'	340440	000000
   993	000437'	340440	000000
   994				REPEAT 4,<
   995				CHRATR 3,1,3,4>			;PUNCTUATION
   996	000440'	641600	000000
   997	000441'	641600	000000
   998	000442'	641600	000000
   999	000443'	641600	000000
  1000	000444'	041601	500000	CHRATR 0,1,3,4,15		;_ (FOR TYMEX2 MODE)
  1001	000445'	641600	000000	CHRATR 3,1,3,4			;^
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 20
SCNSER.MAC	25-NOV-87 19:52		LOWER CASE

  1002				SUBTTL	LOWER CASE
  1003
  1004				REPEAT 32,<
  1005				CHRATR 1,1,4,1>			;a-z
  1006	000446'	242040	000000
  1007	000447'	242040	000000
  1008	000450'	242040	000000
  1009	000451'	242040	000000
  1010	000452'	242040	000000
  1011	000453'	242040	000000
  1012	000454'	242040	000000
  1013	000455'	242040	000000
  1014	000456'	242040	000000
  1015	000457'	242040	000000
  1016	000460'	242040	000000
  1017	000461'	242040	000000
  1018	000462'	242040	000000
  1019	000463'	242040	000000
  1020	000464'	242040	000000
  1021	000465'	242040	000000
  1022	000466'	242040	000000
  1023	000467'	242040	000000
  1024	000470'	242040	000000
  1025	000471'	242040	000000
  1026	000472'	242040	000000
  1027	000473'	242040	000000
  1028	000474'	242040	000000
  1029	000475'	242040	000000
  1030	000476'	242040	000000
  1031	000477'	242040	000000
  1032				REPEAT 2,<
  1033				CHRATR 3,1,3,4>			;PUNCTUATION
  1034	000500'	641600	000000
  1035	000501'	641600	000000
  1036	000502'	040021	440000	CHRATR 0,1,0,0,14,0,4,10	;ALTMODE (175) OR }
  1037	000503'	040021	440000	CHRATR 0,1,0,0,14,0,4,10	;ALTMODE (176) OR ~
  1038	000504'	101101	200000	CHRATR 0,2,2,2,12		;RUBOUT (177)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 21
SCNSER.MAC	25-NOV-87 19:52		LOWER CASE

  1039				COMMENT ;
  1040				SUMMARY OF MEANING OF FIELDS
  1041
  1042				INPUT
  1043					0-SPECIAL ACTION
  1044					1-NORMAL CHARACTER
  1045					2-BREAK CHARACTER
  1046					3-CLASS 2 BREAK CHARACTER
  1047
  1048				OUTPUT
  1049					0-SPECIAL ACTION
  1050					1-OUTPUT AND COUNT FOR FREE RETURN
  1051					2-OUTPUT BUT DO NOT COUNT
  1052					3-UPPER CASE CHARACTER
  1053
  1054				REMOTE ECHO
  1055					0-SPECIAL ACTION
  1056					1-COUNT FOR FREE RETURN
  1057					2-DO NOT COUNT FOR FREE RETURN
  1058					3-SAME AS 2
  1059					4-SAME AS 1
  1060
  1061				DEFERED ECHO
  1062					0-SPECIAL ACTION
  1063					1-PRINT CHARACTER AND COUNT FOR FREE RETURN
  1064					2-BREAK CHARACTER, DO NOT PRINT, DO NOT COUNT
  1065					3-BREAK CHARACTER, PRINT, DO NOT COUNT
  1066					4-CLASS 2 BREAK CHARACTER, PRINT AND COUNT
  1067					5-IMAGE CHARACTER
  1068					6-BREAK CHARACTER, PRINT AND COUNT
  1069
  1070				READ
  1071					0-SPECIAL ACTION
  1072					1-NORMAL CHARACTER
  1073					2-BREAK CHARACTER
  1074					3-CLASS 2 BREAK CHARACTER
  1075					4-LOWER CASE CHARACTER
  1076				;
  1077
  1078				;DEFINE STOP CHARACTERS (ESCAPES) FOR VARIOUS MODES
  1079
  1080			000003	STOP10==3	;^C
  1081			000037	STOP9==37	;^_
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 22
SCNSER.MAC	25-NOV-87 19:52		Channel 1 interrupt processing

  1082				SUBTTL	Channel 1 interrupt processing
  1083
  1084	000505'	633751	506262	KEY10:	633751506262		;Magic value that TYMNET BASE wants to see
  1085
  1086				;UPDKEY - Update the KEY 60 times per second, at channel 1 level
  1087				;Called by JSP T1,UPDKEY    (T2 is scratch).
  1088
  1089	000506'	200340	000505'	UPDKEY::MOVE	T2,KEY10		;Set key for TYMNET
  1090	000507'	250340	000000*	KEYSET::EXCH	T2,KEY620##		;(JFCL if base is not being used)
  1091	000510'	336000	000007		SKIPN	T2			;If it was zero,
  1092	000511'	402000	000000*		 SETZM	KEYTIM##		; reset KEY620 timer
  1093	000512'	332000	000007		SKIPE	T2			;If zero,
  1094	000513'	316340	000505'		CAMN	T2,KEY10		; or the value we set,
  1095	000514'	334000	000000		 SKIPA				;OK
  1096	000515'	202340	016104'		  MOVEM	T2,BADKEY		;Remember bad key for later
  1097	000516'	200340	000000*		MOVE	T2,UPTIME##		;Get current system uptime
  1098	000517'	332000	000000*		SKIPE	DINITF##		;Is ONCE initializing the disks?
  1099	000520'	202340	000000*		 MOVEM	T2,THSTIM##		;Yes, make THSTIM look current
  1100	000521'	274340	000520*		SUB	T2,THSTIM##		;Check on how long since SCNTIC ran
  1101	000522'	311340	000000*		CAML	T2,JFYMIN##		;More than one minute?
  1102	000523'	256000	000000*	KAF1::	 STOPCD (,XCT,S..KAF)
  1103						;Keep alive failure
  1104	000524'	254006	000000		JRST	(T1)			;Return to PICON
  1105
  1106				;CHKBAS - Check if the nonzero value in 30 came from the base.
  1107				;Called by JSP T1,CHKBAS whenever CRSHWD is nonzero.
  1108				;T2 is scratch, stack is not set up.
  1109				;Error return of PDP-10 should crash, skip return to continue.
  1110
  1111	000525'	135340	016117'	CHKBAS::LDB	T2,[POINT 16,CRSHWD,15]	;Check if first 16 bits
  1112	000526'	312340	000000*		CAME	T2,ORP620		; match the base's ORING pointer
  1113	000527'	316340	016106'		CAMN	T2,ORPOLD
  1114	000530'	334000	000000		 SKIPA				;OK
  1115	000531'	254006	000000		  JRST	(T1)			;No match, don't blame it on base
  1116	000532'	135340	016120'		LDB	T2,[POINT 16,CRSHWD,31]	;Check if second 16 bits
  1117	000533'	312340	000000*		CAME	T2,IRP620		; match the base's IRING pointer
  1118	000534'	316340	016105'		CAMN	T2,IRPOLD
  1119	000535'	334000	000000		 SKIPA
  1120	000536'	254006	000000		  JRST	(T1)			;No match, don't blame it on base
  1121	000537'	476000	000000*		SETOM	BASDWN##		;Base problems.  Mark it as down
  1122	000540'	201340	035230		MOVEI	T2,^D15000		;Delay for about 1/60th of a second
  1123	000541'	367340	000541'		SOJG	T2,.			; for base to write into KEY620
  1124	000542'	200340	000507*		MOVE	T2,KEY620##		;Get the key
  1125	000543'	316340	000505'		CAMN	T2,KEY10		;If we overwrote it,
  1126	000544'	200340	016104'		 MOVE	T2,BADKEY		; get previous value
  1127	000545'	202340	000542*		MOVEM	T2,KEY620##		;Reset it if necessary
  1128	000546'	242340	777754		LSH	T2,^D<16-36>		;Get 16 bits of KEY620
  1129	000547'	202040	000557'		MOVEM	P,SCN1PD		;Need a stack for STOPCD
  1130	000550'	201040	000557'		MOVEI	P,SCN1PD
  1131	000551'	306340	000004		CAIN	T2,04			;Did base complain about a bad message?
  1132	000552'	256000	016121'		 STOPCD (.,STOP,BASE04,PRTCRS,<Bad message type from host>)
  1133	000553'	256000	016125'		 STOPCD (.+1,INFO,BASE,PRTCRS,<BASE has crashed - bad KEY620>)
  1134	000554'	200040	000557'		MOVE	P,SCN1PD		;Restore AC
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 22-2
SCNSER.MAC	25-NOV-87 19:52		Channel 1 interrupt processing

  1135	000555'	402000	000000*		SETZM	CRSHWD##		;Clear out location 30 to keep system up
  1136	000556'	254006	000001		JRST	1(T1)			;Skip return back to PICON
  1137
  1138	000557'			SCN1PD:	BLOCK	2			;Dummy stack for PUSHJ P,DIE
  1139
  1140				;Here from PRTIRP to output SAV30, ORP620, IRP620, and KEY620
  1141
  1142	000561'	260040	000000*	PRTCRS:	PUSHJ	P,INLMES##
  1143	000562'	476452	033144		 ASCIZ /ORP620: /
	000563'	301644	000000
  1144	000564'	200300	000526*		MOVE	T1,ORP620
  1145	000565'	260040	000000*		PUSHJ	P,PRTOCT##
  1146	000566'	260040	000561*		PUSHJ	P,INLMES##
  1147	000567'	201011	151240		 ASCIZ /  IRP620: /
	000570'	331446	035100
	000571'	000000	000000
  1148	000572'	200300	000533*		MOVE	T1,IRP620
  1149	000573'	260040	000565*		PUSHJ	P,PRTOCT##
  1150	000574'	260040	000566*		PUSHJ	P,INLMES##		;Called from STOPCD(BASE),STOPCD(BASE04)
  1151	000575'	201004	051602		 ASCIZ /   SAV30: /
	000576'	531466	035100
	000577'	000000	000000
  1152	000600'	200300	000000*		MOVE	T1,SAV30##		;Saved contents of CRSHWD
  1153	000601'	260040	000000*		PUSHJ	P,HWDPNT##
  1154	000602'	260040	000574*		PUSHJ	P,INLMES##
  1155	000603'	201724	000000		 ASCIZ / = /
  1156	000604'	135300	016131'		LDB	T1,[POINT 16,SAV30,15]	; Get Base ORING pointer field
  1157	000605'	260040	000573*		PUSHJ	P,PRTOCT##
  1158	000606'	260040	000000*		PUSHJ	P,PRCOM##		;Comma
  1159	000607'	135300	016132'		LDB	T1,[POINT 16,SAV30,31]	; Get Base IRING pointer field
  1160	000610'	260040	000605*		PUSHJ	P,PRTOCT##
  1161	000611'	260040	000602*	PRTKEY::PUSHJ	P,INLMES##		;Here from STOPCD(CRASH)
  1162	000612'	201004	045712		 ASCIZ /   Key: /
	000613'	745644	000000
  1163	000614'	200300	000545*		MOVE	T1,KEY620		;Get Key value
  1164	000615'	316300	000505'		CAMN	T1,KEY10
  1165					 JRST	[JSP T1,CONMES##
  1166						 ASCIZ /OK
  1167	000616'	254000	016133'	/]
  1168	000617'	242300	777754		LSH	T1,^D<16-36>		;Get high order 16 bits and
  1169	000620'	260040	000610*		PUSHJ	P,PRTOCT##		; print as an octal number.
  1170	000621'	324740	000000*		PJRST	CRLF##			;Finish the line.
  1171
  1172				COMMENT ~	Values stored in KEY620 when the Varian base goes down
  1173				* 00="Normal - host going down - key not refreshed.",
  1174				  01="Host crashing due to base crash.",
  1175				  02="MIC error or MIC reject tring to read key.",
  1176				* 03="Read bad key from host.",
  1177				* 04="Bad data type or port number from host.",  HOST MUST CRASH
  1178				  05="Illogical data type from host.",
  1179				  06="MIC busy trying to read host (IN10).",
  1180				  07="Input ring processing time-out.",
  1181				* 10="MIC time-out error (sen 337).",
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 22-3
SCNSER.MAC	25-NOV-87 19:52		Channel 1 interrupt processing

  1182				* 11="Parity error from MIC (sen 237).",
  1183				* 12="MIC busy for 232 cycles in addr portion of 'look'.",
  1184				  13="Host told base to crash...this is a no-no!!",
  1185				  14="MIC busy (look) from prior operation in 'look'.",
  1186				  15="Overran block i/o table.",
  1187				  16="Terminate block input req. is invalid.",
  1188				  17="Base crash...power failure.",
  1189				  20="Base crash...manual restart.",
  1190				  21="Base crash....",
  1191				**22="Base crash...GCI crash.", BASE CRASHES ITSELF
  1192				  23="Base crash...WCD crash.",
  1193				**24="Base crash...WCI crash.", BASE CRASHES ITSELF
  1194				* 25="Base crash...GCOL crash.",
  1195				  26="Base crash...speed crash.",
  1196				  27="Base crash...unidentified crash.",
  1197				  30="Base crash....",
  1198				  31="Base crash...WWI crash.",
  1199				  32="Base crash...empty crash.",
  1200				  33="Base crash...parity error.",
  1201				  34="Base crash...bad 201 interrupt.",
  1202				  35="Base crash....",
  1203				  36="Base crash....",
  1204				  37="Base crash....";
  1205				**120="Bad ISIS message.", BASE CRASHES ITSELF
  1206				**140="Bad stack usage.", BASE CRASHES ITSELF
  1207				**202="Buss Error.", BASE CRASHES ITSELF
  1208				**203="Address Error", BASE CRASHES ITSELF
  1209				**204="Illegal Instruction.", BASE CRASHES ITSELF
  1210				**354="Engine told 68K to crash.", BASE CRASHES ITSELF
  1211				**355="Split Char Pair.", BASE CRASHES ITSELF
  1212				~  ;End of COMMENT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 23
SCNSER.MAC	25-NOV-87 19:52		INPUT RING DISPATCHER

  1213				SUBTTL INPUT RING DISPATCHER
  1214
  1215				;HERE EVERY TICK FROM CHANNEL 7
  1216
  1217				    ;KEEP TRACK OF MAXIMUM INTER-CALL DELAY
  1218
  1219	000622'	200440	000516*	SCNINT::MOVE	T4,UPTIME	;Check on how long it has been since SCNSER
  1220	000623'	250440	000521*		EXCH	T4,THSTIM##	; last had a chance to run
  1221	000624'	321440	000634'		JUMPL	T4,SCNNT0	;Don't check on the very first tick
  1222	000625'	274440	000623*		SUB	T4,THSTIM##
  1223	000626'	213000	000011		MOVNS	T4
  1224	000627'	313440	000000*		CAMLE	T4,MXTIM##
  1225	000630'	202440	000627*		 MOVEM	T4,MXTIM##	;Save maximum so far
  1226	000631'	350000	000511*		AOS	KEYTIM##	;Increment # of ticks since key was reset
  1227	000632'	350000	000000*		AOS	IRPTIM##	;          # of ticks since last input message
  1228	000633'	350000	000000*		AOS	ORPTIM##	;          # of ticks since last output message
  1229
  1230				    ;CHECK FOR CTY OUTPUT
  1231
  1232	000634'	337000	000124'	SCNNT0:	SKIPG	CTYLDB+LDBTOC	;If there are characters for the CTY
  1233	000635'	335000	013507'		SKIPGE	CTYBLF		; or if someone wants to ding its bell,
  1234	000636'	260040	013511'		 PUSHJ	P,OPRCTY	; go do it
  1235	000637'	260040	000000*		PUSHJ	P,CTYINP##	;Check for input on the CTY
  1236	000640'	255000	000000		  JFCL			;No input (character in T3 if CTYINP skips)
  1237
  1238				    ;CHECK IF RING NEEDS TO BE RESET
  1239
  1240	000641'	336300	000537*		SKIPN	T1,BASDWN##	;Has base crashed or 10 in system restart?
  1241	000642'	254000	000701'		 JRST	SCNTIC		;No, rings are fine
  1242				;BASDWN=-1 means base has crashed or is not responding.
  1243				;BASDWN=+1 means system startup - ask for date/time from the supervisor.
  1244	000643'	337000	000006		SKIPG	T1		;Startup?
  1245	000644'	260040	012256'		 PUSHJ	P,DETALL	;No, detach all jobs when base dies
  1246	000645'	403340	000000*		SETZB	T2,IRPPDP
  1247	000646'	250340	000572*		EXCH	T2,IRP620	;Reset IRING pointers
  1248	000647'	332000	000007		SKIPE	T2
  1249	000650'	202340	016105'		 MOVEM	T2,IRPOLD	;Save old pointer for CHKBAS
  1250	000651'	403340	000000*		SETZB	T2,ORPPDP
  1251	000652'	250340	000564*		EXCH	T2,ORP620	;Reset ORING pointers
  1252	000653'	332000	000007		SKIPE	T2
  1253	000654'	202340	016106'		 MOVEM	T2,ORPOLD	;Save old pointer for CHKBAS
  1254				IFCPU (F3),<
  1255					PUSHJ	P,FNSYNC	;Synchronize with the PDP-11 base
  1256					  POPJ	P,		;Not ready yet, try again next time
  1257				>;END IFCPU F3
  1258	000655'	200740	000651*		MOVE	P4,ORPPDP	;Get current ORING pointer (starts at zero)
  1259	000656'	200700	016135'		MOVE	P3,[<TYPRAK>B<BYP1>+<SCNVER>B<BYP3>+<SCNREL>B<BYP4>]
  1260	000657'	331000	000641*		SKIPL	BASDWN		;Send reset-ack if base died, CLK at startup
  1261	000660'	200700	016136'		 MOVE	P3,[<TYPCLP>B<BYP1>+<SCNVER>B<BYP3>+<SCNREL>B<BYP4>]
  1262	000661'	335000	000000*		SKIPGE	DEBUGF##	;System being debugged?
  1263	000662'	661700	000004		 TLO	P3,(1B<BYP2>)	;Yes, set LSB of 2nd byte
  1264	000663'	202717	000271*		MOVEM	P3,ORING(P4)	;Put first message in ring
  1265	000664'	271740	000001		ADDI	P4,1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 23-2
SCNSER.MAC	25-NOV-87 19:52		INPUT RING DISPATCHER

  1266	000665'	205700	102000		MOVSI	P3,TYPI TYPHSI	;Message type 41
  1267	000666'	201300	000000*		MOVEI	T1,RPORTN##	;Number of real ports
  1268				IFKMC<	LPERDR==<^D16>*4	;ONE OF 64. 32. or 16. LINES PER DR
  1269					;LPERDR must match that defined in the KMC microcode
  1270					MAXDR==RPORTN##/LPERDR	;HIGHEST DR = # OF PORTS/LINES PER DR
  1271					TRZ	T1,3		;Must have a multiple of 4
  1272					CAIL	T1,LPERDR	;Determine lines on 1st node
  1273					 MOVEI	T1,<LPERDR-1>&74;Must be a multiple of 4 .LT. ^D64
  1274				>;END IFKMC
  1275	000667'	137300	000272'		DPB	T1,WRPLIN	;Highest port number we will accept
  1276	000670'	200300	000000*		MOVE	T1,SYSNUM##	;Our host number
  1277	000671'	137300	000273'		DPB	T1,WRPCHR	; in 3rd byte
  1278	000672'	202717	000663*		MOVEM	P3,ORING(P4)
  1279	000673'	271740	000001		ADDI	P4,1
  1280	000674'	202740	000655*		MOVEM	P4,ORPPDP	;Let base see those 2 messages
  1281				IFKMC<	MOVEI	T1,<4320000&<7777_<3*MAXDR>>>_-9
  1282						;T1/4320 or 320 or 20 or 0 (SEE DRFLAG:) SO AS TO PUT
  1283						;OUT 41 MESSAGES TO DRs 2,3 & 4 IF THEY ARE THERE
  1284					SETZ	W,		;INITIALIZE W FOR NON-PTY OUTPUT
  1285					MOVSI	P3,TYPI TYPHSI	;41 MESSAGES
  1286					PUSHJ	P,MDRMSG
  1287				>;END IFKMC
  1288	000675'	402000	000657*		SETZM	BASDWN##	;Flag that we think the base is up
  1289	000676'	402000	000000*		SETZM	BASVER##	;Zero version number for BASEOK message
  1290	000677'	402000	016104'		SETZM	BADKEY		;Reset saved bad key
  1291	000700'	263040	000000		POPJ	P,		;Come back next tick
  1292
  1293				    ;CHECK OTHER UNUSUAL OUTPUT REQUESTS
  1294
  1295	000701'	400500	000000	SCNTIC:	SETZ	W,		;LET OUTPUT CODE KNOW IT'S REAL NOT PTY OUTPUT
  1296	000702'	260040	004123'		PUSHJ	P,SETOUT
  1297	000703'	254000	000722'		  JRST	SCNIN		;NO ROOM FOR CHARACTERS
  1298	000704'	336700	015725'		SKIPN	P3,UPSHUT	;IS THERE A SHUT OR ANSWERED MESSAGE
  1299	000705'	254000	000713'		 JRST	SCNNT2
  1300	000706'	260040	004102'	IFNKMC<	PUSHJ	P,CLSCHR	;JUST FOR THE SAKE OF GOOD FORM
  1301	000707'	254000	000722'		  JRST	SCNIN		;DON'T UNDERSTAND HOW WE GOT HERE BUT OK
  1302	000710'	402000	015725'		SETZM	UPSHUT		;WILL SEND NOW, MARK NO MORE MSG
  1303	000711'	260040	004144'		PUSHJ	P,WRDOUT	;SEND IT
  1304	000712'	254000	000722'		  JRST	SCNIN		;THE LAST OF THE SPACE
  1305				>;END IFNKMC
  1306				IFKMC<	PUSHJ	P,MDRUP		;GET 3-BIT UP FLAGS
  1307					HLRZ	P3,P3
  1308					CAIN	P3,TYPI TYPSHT
  1309					 MOVEM	T1,DRMSHT
  1310					CAIN	P3,TYPI TYPANS
  1311					 MOVEM	T1,DRMANS
  1312					SETZM	UPSHUT>;END IFKMC
  1313	000713'	260040	014437'	SCNNT2:	PUSHJ	P,SNDSAD	;SEND A SAD MESSAGE IF APPROPRIATE
  1314	000714'	254000	000722'		  JRST	SCNIN
  1315				IFKMC<	PUSHJ	P,SNDHSI	;SEE IF ANY DRs NEED A TYPHSI MSG ETC.
  1316					  JRST	SCNIN>;END IFKMC
  1317	000715'	260040	011173'		PUSHJ	P,SNDAUX	;Check progress on AUX circuit builds
  1318	000716'	254000	000722'		  JRST	SCNIN		;OUT OF ROOM NOW
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 23-3
SCNSER.MAC	25-NOV-87 19:52		INPUT RING DISPATCHER

  1319				IFCPU (<KI,KL>), <	;TYMNET BASES REQUIRE BIO PORT NEGOTIATION,
  1320							; NEXILIS BASES DO NOT
  1321	000717'	335000	015776'		SKIPGE	BIOCNT+0	;ANY CHANGE IN THE NUMBER OF BIO PORTS?
  1322	000720'	260040	001372'		PUSHJ	P,SNDBIO	;REQUEST TO THE BASE.
  1323	000721'	254000	000722'		  JRST	SCNIN
  1324				> ;END IFCPU (<KI,KL>)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 24
SCNSER.MAC	25-NOV-87 19:52		HERE TO PROCESS ALL THE MESSAGES IN THE INPUT RING, THEN

  1325				SUBTTL	HERE TO PROCESS ALL THE MESSAGES IN THE INPUT RING, THEN
  1326				;JUMP TO OUTPUT CODE. FSCN GETS SET TO -1 IF ANY MESSAGES
  1327				;WERE PROCESSED.
  1328
  1329	000722'	200740	000645*	SCNIN:	MOVE	P4,IRPPDP
  1330	000723'	316740	000646*		CAMN	P4,IRP620	;Anything in the input ring?
  1331	000724'	254000	003164'		 JRST	SCNOUT		;No, try output ring
  1332	000725'	476000	015711'		SETOM	FSCN		;Yes, flag that we found something
  1333				IFCPU (<F3,KS>),<
  1334					SKIPGE	IRPTIM##	;Is this the first message after base went down?
  1335					 STOPCD (,XCT,BASEOK)	;Yes, output BASEOK message
  1336				>  ;End IFCPU(F3,KS)
  1337	000726'	402000	000632*		SETZM	IRPTIM##	;Reset IRING timer
  1338	000727'	200300	000723*		MOVE	T1,IRP620	;Remember current IRING pointer so that
  1339	000730'	202300	016103'		MOVEM	T1,IRPSTP	; we can tell when it is time to pause input
  1340								; and send backpressure on lines that need it
  1341	000731'	316740	016103'	SCNIN0:	CAMN	P4,IRPSTP	;Processed all data present at start of pass?
  1342	000732'	254000	003164'		 JRST	SCNOUT		;Yes, go do output
  1343				;;;;;;;;BEGIN KMC DEBUG CODE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  1344				IFKMC<
  1345					MOVE	P1,IRPMB2	;SAVE PREVIOUS BASE POINTER
  1346					MOVEM	P1,IRPMB3
  1347					MOVE	P1,IRPMB1	;SAVE PREVIOUS BASE POINTER
  1348					MOVEM	P1,IRPMB2
  1349					MOVE	P1,IRP620
  1350					MOVEM	P1,IRPMB1	;SAVE CURRENT BASE POINTER TOO
  1351				
  1352					MOVE	P1,IRPMP2	;SAVE PREVIOUS MESSAGE POINTER
  1353					MOVEM	P1,IRPMP3
  1354					MOVE	P1,IRPMP1	;SAVE PREVIOUS MESSAGE POINTER
  1355					MOVEM	P1,IRPMP2
  1356					MOVEM	P4,IRPMP1	;SAVE MESSAGE POINTER TOO
  1357				
  1358					MOVE	P1,IRPMS2	;SAVE PREVIOUS MESSAGE
  1359					MOVEM	P1,IRPMS3
  1360					MOVE	P1,IRPMSG	;SAVE PREVIOUS MESSAGE
  1361					MOVEM	P1,IRPMS2
  1362					MOVE	P1,IRING(P4)	;SAVE FIRST WORD OF MESSAGE IN IRPMSG
  1363					MOVEM	P1,IRPMSG
  1364				>;END IFKMC
  1365				;;;;;;;;END KMC DEBUG CODE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  1366	000733'	135600	000262'		LDB	P1,INPTYP	;P1/ MESSAGE TYPE
  1367	000734'	135240	000263'		LDB	U,INPLIN	;U/ PORT #
  1368	000735'	303240	000000*		CAILE	U,RMXLIN##
  1369	000736'	254000	000752'		 JRST	BADPRT		;BAD PORT
  1370	000737'	200245	000000*		MOVE	U,LINTAB(U)	;U/ PORT LDB
  1371	000740'	500245	000031	BADPR1:	HLL	U,LDBDCH(U)
  1372	000741'	622600	000200		TRZE	P1,200		;IF 200 BIT SET, IT'S DATA
  1373	000742'	254000	001542'		 JRST	CHRMLT		;P1 has count of characters to be input
  1374	000743'	303600	000063		CAILE	P1,MXTYP
  1375	000744'	256000	016137'	TTYBMT:: STOPCD (SCNIN1,INFO,TTYBMT,PRTIRG,<Bad Message Type from Base>);;CNTPRT-1
  1376	000745'	256014	001030'	CNTPRT:	XCT	TYPTRN(P1)	;DISPATCH TO IT
  1377	000746'	405740	000000*	SCNIN1:	ANDI	P4,MSKIRG	;MASK FOR WRAP AROUND
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 24-2
SCNSER.MAC	25-NOV-87 19:52		HERE TO PROCESS ALL THE MESSAGES IN THE INPUT RING, THEN

  1378	000747'	202740	000722*		MOVEM	P4,IRPPDP	;PUT IT AWAY FOR 620
  1379	000750'	254000	000731'		JRST	SCNIN0		;GO SEE IF MORE INPUT
  1380
  1381	000751'	344740	000746'	SCNIN2:	AOJA	P4,SCNIN1	;Ignore this word, go get next one
  1382
  1383	000752'	302600	000001	BADPRT:	CAIE	P1,TYPANS	;(1) Answered, port = 0
  1384	000753'	306600	000002		CAIN	P1,TYPSHT	;(2) Shut, port = 0
  1385	000754'	254000	000745'		 JRST	CNTPRT
  1386	000755'	302600	000003		CAIE	P1,TYPRES	;(3) Reset, port = flag bits (0,1,200,201)
  1387	000756'	306600	000004		CAIN	P1,TYPRAK	;(4) Reset ack, port = flag bits
  1388	000757'	254000	000745'		 JRST	CNTPRT
  1389	000760'	302600	000005		CAIE	P1,TYPNSP	;(5) New supervisor, port = 0
  1390	000761'	306600	000027		CAIN	P1,TYPSUR	;(27) Supervisor Response, port = key
  1391	000762'	254000	000745'		 JRST	CNTPRT
  1392	000763'	302600	000032		CAIE	P1,TYPTSR	;(32) Test pattern response, port = data
  1393	000764'	306600	000043		CAIN	P1,TYPCLR	;(43) Clock Response, port = 0
  1394	000765'	254000	000745'		 JRST	CNTPRT
  1395	000766'	201240	000000		MOVEI	U,0		;Use port 0 if out of range
  1396	000767'	256000	016143'		STOPCD (BADPR1,INFO,TTYBPN,PRTIRG,<Bad Port Number from Base>);;BADPRT+3
  1397				PRINTF([TTYBPN needs filter to skip multi-word IRING messages to continue])
  1398
  1399				;PRTIRG - Print PDP-10 ring pointers, and word at IRING+IRPPDP for STOPCD
  1400
  1401	000770'	260040	000611*	PRTIRG::PUSHJ	P,INLMES##	;Called from stopcodes TTYBMT,TTYBPN,CTYBMT
  1402	000771'	476452	050210		 ASCIZ /ORPPDP: /
	000772'	501644	000000
  1403	000773'	200300	000674*		MOVE	T1,ORPPDP
  1404	000774'	260040	000620*		PUSHJ	P,PRTOCT##
  1405	000775'	260040	000770*		PUSHJ	P,INLMES##
  1406	000776'	201011	151240		 ASCIZ /  IRPPDP: /
	000777'	502112	035100
	001000'	000000	000000
  1407	001001'	200300	000747*		MOVE	T1,IRPPDP
  1408	001002'	260040	000774*		PUSHJ	P,PRTOCT##
  1409	001003'	260040	000775*		PUSHJ	P,INLMES##	;Output word that IRPPDP points to
  1410	001004'	201004	044644		 ASCIZ /   IRING+/
	001005'	446350	725400
  1411	001006'	200740	001001*		MOVE	P4,IRPPDP	;In case called from CTYBMT in CTYSIM
  1412	001007'	550300	000017		HRRZ	T1,P4
  1413	001010'	260040	001002*		PUSHJ	P,PRTOCT##
  1414	001011'	260040	001003*		PUSHJ	P,INLMES##
  1415	001012'	275000	000000		 ASCIZ \/ \
  1416	001013'	135300	000262'		LDB	T1,INPTYP	;Message type
  1417	001014'	260040	001010*		PUSHJ	P,PRTOCT##
  1418	001015'	260040	000606*		PUSHJ	P,PRCOM##
  1419	001016'	135300	000263'		LDB	T1,INPLIN	;Get port number (U has LDB address)
  1420	001017'	260040	001014*		PUSHJ	P,PRTOCT##
  1421	001020'	260040	001015*		PUSHJ	P,PRCOM##
  1422	001021'	135300	000264'		LDB	T1,INPCHR	;Get first data byte
  1423	001022'	260040	001017*		PUSHJ	P,PRTOCT##
  1424	001023'	260040	001020*		PUSHJ	P,PRCOM##
  1425	001024'	135300	000265'		LDB	T1,INPCH2	;Get 2nd data byte
  1426	001025'	260040	001022*		PUSHJ	P,PRTOCT##
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 24-3
SCNSER.MAC	25-NOV-87 19:52		HERE TO PROCESS ALL THE MESSAGES IN THE INPUT RING, THEN

  1427	001026'	260040	000621*		PUSHJ	P,CRLF##
  1428	001027'	324740	000561'		PJRST	PRTCRS		;Output ORP620 and IRP620
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 25
SCNSER.MAC	25-NOV-87 19:52		IRING message type dispatch table

  1429				SUBTTL	IRING message type dispatch table
  1430
  1431	000000			TYPTRN:	PHASE	0		;Use XCT TYPTRN(P1)
  1432	001030'	256000	000744'	TYP.00:	 STOPCD (,XCT,TTYBMT)
  1433					; 0 ILLEGAL
  1434	001031'	254000	012273'	TYPANS:	JRST	RCVANS		; 1 KMC ANSWERED, IGNORED BY KL & KI
  1435	001032'	344740	000746'	TYPSHT:	AOJA	P4,SCNIN1	; 2 SHUT, IGNORE
  1436	001033'	254000	012242'	TYPRES:	JRST	RCVRES		; 3 BASE CRASHED AND RELOADED OR DR-11 DIED
  1437	001034'	254000	012222'	TYPRAK:	JRST	RCVRAK		; 4 BASE ACK TO MESSAGE TYPE 3
  1438	001035'	254000	011051'	TYPNSP:	JRST	RCVNSP		; 5 TAKEOVER OF BASE, RESET AUX CIRS
  1439	001036'	254000	001151'	TYPLOG:	JRST	LOGIN		; 6 START LOGIN PROCESS ON THIS PORT
  1440	001037'	254000	011131'	TYPAUX:	JRST	RCVAUX		; 7 AUX CIRCUIT PORT ESTABLISHED
  1441	001040'	260040	001134'	TYPNOP:	PUSHJ	P,NOOUT		;10 BACKPRESSURE ON
  1442	001041'	260040	001143'	TYPOUP:	PUSHJ	P,DOOUT		;11 BACKPRESSURE OFF
  1443	001042'	260040	001114'	TYPGOB:	PUSHJ	P,GOBCHR	;12 CHR. GOBBLER, CLEAR INPUT BUFFER
  1444	001043'	260040	001507'	TYPZAP:	PUSHJ	P,RCVZAP	;13 CIRCUIT ZAPPER
  1445	001044'	260040	001174'	TYPEDC:	PUSHJ	P,EDEC		;14 ENTER DEFFERED ECHO MODE
  1446	001045'	260040	001166'	TYPLDC:	PUSHJ	P,LDEC		;15 LEAVE DEFERRED ECHO MODE
  1447	001046'	254000	001200'	TYPGRN:	JRST	GREEN		;16 GREEN BALL
  1448	001047'	254000	001204'	TYPRED:	JRST	RED		;17 RED BALL
  1449	001050'	260040	001222'	TYPYEL:	PUSHJ	P,YELLOW	;20 YELLOW BALL
  1450	001051'	260040	001212'	TYPORG:	PUSHJ	P,ORANGE	;21 ORANGE BALL
  1451	001052'	344740	000746'	TYPHNG:	AOJA	P4,SCNIN1	;22 HANG, IGNORE
  1452	001053'	344740	000746'	TYPETM:	AOJA	P4,SCNIN1	;23 ENTER 2741 TRANSPARENT MODE
  1453	001054'	344740	000746'	TYPLTM:	AOJA	P4,SCNIN1	;24 LEAVE 2741 TRANSPARENT MODE
  1454	001055'	260040	001432'	TYPLOS:	PUSHJ	P,RCVLOS	;25 LOST BALL (CHARACTERS LOST ON INPT)
  1455	001056'	256000	000744'	TYPSUP:	 STOPCD (,XCT,TTYBMT)
  1456					;26 SUPERVISOR REQUEST
  1457	001057'	254000	011062'	TYPSUR:	JRST	RCVSUR		;27 SUPERVISOR RESPONSE
  1458	001060'	256000	000744'	TYPAXC:	 STOPCD (,XCT,TTYBMT)
  1459					;30 AUX CIRCUIT CHARACTER
  1460	001061'	256000	000744'	TYPTSP:	 STOPCD (,XCT,TTYBMT)
  1461					;31 TEST PROBE
  1462	001062'	344740	000746'	TYPTSR:	AOJA	P4,SCNIN1	;32 TEST RESPONSE, IGNORE
  1463	001063'	256000	000744'	TYPSAD:	 STOPCD (,XCT,TTYBMT)
  1464					;33 HOST SAD
  1465	001064'	256000	000744'	TYPECN:	 STOPCD (,XCT,TTYBMT)
  1466					;34 ECHO ON, SHOULD NOT COME IN
  1467	001065'	256000	000744'	TYPECF:	 STOPCD (,XCT,TTYBMT)
  1468					;35 ECHO OFF, SHOULD NOT COME IN
  1469	001066'	256000	000744'	TYPTCS:	 STOPCD (,XCT,TTYBMT)
  1470					;36 SEND TERMINAL CHRS. SHOULD NOT COME IN
  1471	001067'	256000	000744'	TYPTCP:	 STOPCD (,XCT,TTYBMT)
  1472					;37 TERM CHRS PROBE. SHOULD NOT COME IN
  1473	001070'	254000	001447'	TYPTCR:	JRST	RCVTMC		;40 TERM CHRS RESPONSE
  1474	001071'	256000	000744'	TYPHSI:	 STOPCD (,XCT,TTYBMT)
  1475					;41 PORT AND SYSTEM NUMBER
  1476	001072'	256000	000744'	TYPCLP:	 STOPCD (,XCT,TTYBMT)
  1477					;42 REQUEST FOR SUPERVISOR TIME
  1478	001073'	254000	001457'	TYPCLR:	JRST	CLKRSP		;43 CLOCK RESPONSE FROM SUP.
  1479	001074'	256000	000744'	TYPBKO:	 STOPCD (,XCT,TTYBMT)
  1480					;44 INITIATE BLOCK OUTPUT
  1481	001075'	260040	001353'	TYPBOC:	PUSHJ	P,BLKOHR	;45 BLOCK OUTPUT COMPLETE SAME AS TERMINATED
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 25-2
SCNSER.MAC	25-NOV-87 19:52		IRING message type dispatch table

  1482	001076'	256000	000744'	TYPBIN:	 STOPCD (,XCT,TTYBMT)
  1483					;46 INITIATE BLOCK INPUT
  1484	001077'	260040	001246'	TYPINB:	PUSHJ	P,BLKIBF	;47 BLOCK INPUT TERMINATED: OUT OF BUFFER
  1485	001100'	260040	001266'	TYPINE:	PUSHJ	P,BLKEOT	;50 BLOCK INPUT TERMINATED: END OF TRANSMISSION
  1486	001101'	260040	001304'	TYPINT:	PUSHJ	P,BLKITM	;51 BLOCK INPUT TERMINATED: TIMEOUT BY BASE
  1487	001102'	256000	000744'	TYPIRQ:	 STOPCD (,XCT,TTYBMT)
  1488					;52 REQUEST BLOCK INPUT TERMINATION
  1489	001103'	260040	001337'	TYPIHR:	PUSHJ	P,BLKIHR	;53 BLOCK INPUT TERMINATED: BY HOST REQUEST
  1490	001104'	256000	000744'	TYPORQ:	 STOPCD (,XCT,TTYBMT)
  1491					;54 REQUEST BLOCK OUTPUT TERMINATION.
  1492	001105'	260040	001353'	TYPOHR:	PUSHJ	P,BLKOHR	;55 BLOCK OUTPUT TERMINATED: BY HOST REQUEST
  1493	001106'	254000	001401'	TYPNEG:	JRST	BLKNEG		;56 NEGOTIATE FOR NUMBER OF BLOCK I/O PORTS
  1494	001107'	344740	000746'	TYPBRK:	AOJA	P4,SCNIN1	;57 BREAK, IGNORE FOR NOW
  1495	001110'	254000	001474'	TYPPSR:	JRST	RCVPS		;60 PORT STATUS RECEIVED (not used)
  1496	001111'	344740	000746'	TYPEAD:	AOJA	P4,SCNIN1	;61 ENTER ALTERNATE DEVICE MODE, IGNORE
  1497	001112'	344740	000746'	TYPLAD:	AOJA	P4,SCNIN1	;62 LEAVE ALTERNATE DEVICE MODE, IGNORE
  1498	001113'	256000	000744'	TYPKAF:	 STOPCD (,XCT,TTYBMT)
  1499					;63 SET KEEP-ALIVE FAILURE TIMER
  1500	001114'				DEPHASE
  1501
  1502			000063	MXTYP==.-TYPTRN-1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 26
SCNSER.MAC	25-NOV-87 19:52		NON-CHARACTER INPUT HANDLER ROUTINES

  1503				SUBTTL NON-CHARACTER INPUT HANDLER ROUTINES
  1504
  1505	001114'	550205	000000	GOBCHR:	HRRZ	F, LDBDDB(U)
  1506	001115'	322200	001514'		JUMPE	F, SIMRZP		;IF NO JOB, TREAT AS ZAPPER
  1507	001116'	135100	000000*		LDB	J, PJOBN
  1508	001117'	200342	000000*		MOVE	T2, JBTSTS(J)
  1509	001120'	607340	000004		TLNN	T2, JLOG		;IF NOT LOGGED-IN,
  1510	001121'	254000	001514'		 JRST	SIMRZP			;  TREAT AS ZAPPER
  1511	001122'	340740	001126'		AOJ	P4, GOBCH1
  1512	001123'	550205	000000	FRCCGB:	HRRZ	F, LDBDDB(U)
  1513	001124'	322200	001131'		JUMPE	F, GOBCH2		;IF IT'S ATTACHED
  1514	001125'	135100	001116*		LDB	J, PJOBN
  1515	001126'	135300	000233'	GOBCH1:	LDB	T1, DDPTCG
  1516	001127'	322300	001131'		JUMPE	T1, GOBCH2		;AND IT'S TRAPPING GOBBLERS,
  1517	001130'	260040	000000*		PUSHJ	P, TAKTRP		;  TAKE THE TRAP
  1518	001131'	201300	001000	GOBCH2:	MOVEI	T1, LXRCGS
  1519	001132'	436305	000032		IORM	T1, LDBDCX(U)		;SET CHARACTER-GOBBLER SEEN
  1520	001133'	324740	006203'		PJRST	TSETBI			;CLEAR THE INPUT BUFFERS
  1521
  1522	001134'	340740	000000	NOOUT:	AOJ	P4,
  1523	001135'	135300	000077'	FRCNOO:	LDB	T1, LOPZAP
  1524	001136'	326300	000000*		JUMPN	T1, CPOPJ		;IF ABOUT TO SEND ZAPPER, DO NOTHING
  1525	001137'	205300	400000		MOVSI	T1, LDLNOP
  1526	001140'	436305	000031		IORM	T1, LDBDCH(U)		;SET BACKPRESSURE FLAG
  1527	001141'	137305	000002		DPB	T1, LDBOPB(U)		;CLEAR NEED-OUTPUT
  1528	001142'	263040	000000		POPJ	P,
  1529
  1530	001143'	340740	000000	DOOUT:	AOJ	P4,
  1531	001144'	205300	400000	FRCDOO:	MOVSI	T1, LDLNOP
  1532	001145'	412305	000031		ANDCAM	T1, LDBDCH(U)		;CLEAR BACKPRESSURE FLAG
  1533	001146'	201300	000001		MOVEI	T1, 1
  1534	001147'	137305	000002		DPB	T1, LDBOPB(U)		;SET NEED-OUTPUT
  1535	001150'	263040	000000		POPJ	P,
  1536
  1537				;Here for message 06 - externally initiated login request
  1538
  1539	001151'	200305	000001	LOGIN:	MOVE	T1,LDBLIN(U)
  1540	001152'	603300	400000		TLNE	T1,LNLZIN		;IF THERE'S AN UNECHOED ZAPPER,
  1541					 JRST	[MOVEI	T1,NZAPLG
  1542						 PUSHJ	P,ZAPBUG	;NOTE IT
  1543	001153'	254000	016147'			 JRST	.+1	]
  1544	001154'	332005	000026		SKIPE	LDBLOG(U)		;IF LOGGED-IN OR LOGGING IN,
  1545									;  TREAT AS CIRCUIT ZAPPER
  1546					  JRST	[PUSHJ	P,ZAPLOG	;NOTE THE ZAP (increment P4)
  1547	001155'	254000	016152'			 JRST	SCNIN1]		;  Return to loop
  1548
  1549	001156'	201300	000010		MOVEI	T1,1B32			;This bit will be shifted to
  1550	001157'	202305	000026		MOVEM	T1,LDBLOG(U)		; 1B0 after reading 4 characters
  1551	001160'	135300	000267'		LDB	T1,INPDL2		;Get 3rd+4th byte of login message
  1552	001161'	135340	016154'		LDB	T2,[POINT 16,BASVER,31]	;Check version of base code
  1553	001162'	301340	001001		CAIL	T2,<02_^D8>+01		;If EBUS version 2.01 or later,
  1554	001163'	137300	000154'		 DPB	T1,LDPHST		; store originating host number
  1555	001164'	402005	000030		SETZM	LDBMOD(U)		;NOTHING SO FAR
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 26-2
SCNSER.MAC	25-NOV-87 19:52		NON-CHARACTER INPUT HANDLER ROUTINES

  1556	001165'	344740	000746'		AOJA	P4,SCNIN1
  1557
  1558				PRINTF (<[BUG at LDEC has not been completely fixed, causes TTYNNC]>)
  1559	001166'	332005	000014	LDEC:	SKIPE	LDBECC(U)		;ARE WE STILL ECHOING?
  1560	001167'	255000	001241'		 JFCL	ZAPDFR			;YES, TREAT AS CIRCUIT ZAPPER
  1561	001170'	205300	001000		MOVSI	T1,LDLDEF
  1562	001171'	607240	000040		TLNN	U,LDLAUX		;NOT FOR AUX CIRCUITS
  1563	001172'	412305	000031		 ANDCAM	T1,LDBDCH(U)		;RESET DEFERED ECHO FLAG
  1564	001173'	344740	007534'		AOJA	P4,SETLMD		;AND RESET LINE MODE
  1565
  1566	001174'	205300	001000	EDEC:	MOVSI	T1,LDLDEF
  1567	001175'	607240	000040		TLNN	U,LDLAUX
  1568	001176'	436305	000031		 IORM	T1,LDBDCH(U)		;ENTER DEFFERED ECHO MODE
  1569	001177'	344740	007534'		AOJA	P4,SETLMD
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 27
SCNSER.MAC	25-NOV-87 19:52		NON-CHARACTER INPUT HANDLER ROUTINES

  1570	001200'	201300	000001	GREEN:	MOVEI	T1, 1
  1571	001201'	137300	000101'		DPB	T1, LOPSGR	;SET SEND-GREEN-BALL FLAG
  1572	001202'	137305	000002		DPB	T1, LDBOPB(U)	;AND NEED-OUTPUT BIT
  1573	001203'	344740	000746'		AOJA	P4, SCNIN1
  1574
  1575	001204'	201300	000000	RED:	MOVEI	T1, 0
  1576	001205'	137300	000101'		DPB	T1, LOPSGR	;CLEAR SEND-GREEN-BALL FLAG
  1577	001206'	201300	000001		MOVEI	T1, 1
  1578	001207'	137300	000064'		DPB	T1, LOPSRD	;SET SEND-RED
  1579	001210'	137305	000002		DPB	T1, LDBOPB(U)	;AND WANNA-OUTPUT
  1580	001211'	344740	000746'		AOJA	P4, SCNIN1
  1581
  1582	001212'	340740	000000	ORANGE:	AOJ	P4,
  1583	001213'	260040	015307'	FRCORG:	PUSHJ	P, OBREC	;HANDLE INTERRUPT OR HIBER
  1584	001214'	255000	000000		  JFCL
  1585	001215'	205300	000400	OBFND:	MOVSI	T1, L2LOWT
  1586	001216'	412305	000027	OBFND1:	ANDCAM	T1, LDBBYT(U)	;CLEAR ORANGE-WAIT FLAG
  1587	001217'	201300	000001		MOVEI	T1, 1
  1588	001220'	137305	000002		DPB	T1, LDBOPB(U)	;SET NEED-OUTPUT (ZAP CODE MAY WAIT)
  1589	001221'	263040	000000		POPJ	P,
  1590
  1591	001222'	340740	000000	YELLOW:	AOJ	P4,
  1592				FRCYEL:	IFN YLBUG, <
  1593					PUSHJ	P, OBREC	;WAS JOB WAITING FOR AN ORANGE BALL?
  1594					  JRST	.+2		;NO
  1595					 JRST	OBFND		;YES, TREAT AS ORANGE BALL
  1596					MOVSI	T1, L2LOWT
  1597					TDNE	T1, LDBBYT(U)	;IS ZAP LOGIC WAITING FOR ORANGE?
  1598					 JRST	OBFND1		;YES, TREAT AS ORANGE
  1599					>
  1600	001223'	201300	002000		MOVEI	T1, LXRYBS
  1601	001224'	436305	000032		IORM	T1, LDBDCX(U)	;SET YELLOW-BALL-RECEIVED BIT
  1602	001225'	550205	000000		HRRZ	F, LDBDDB(U)
  1603	001226'	322200	001235'		JUMPE	F, YELLW1	;IF IT'S ATTACHED,
  1604	001227'	135300	000232'		LDB	T1, DDPTYB
  1605	001230'	322300	001235'		JUMPE	T1, YELLW1	;AND IT'S TRAPPING YELLOW BALLS,
  1606	001231'	260040	000000*		PUSHJ	P, TAKTRJ	;  TAKE THE TRAP
  1607	001232'	205300	004000		MOVSI	T1, LXLOOK
  1608	001233'	436305	000032		IORM	T1, LDBDCX(U)	;  AND ALLOW JOB TO SEND 1 ORANGE BALL
  1609	001234'	263040	000000		POPJ	P,		;OTHERWISE,
  1610	001235'	201300	000001	YELLW1:	MOVEI	T1, 1
  1611	001236'	137300	000102'		DPB	T1, LOPSOG	;  SET SEND-ORANGE
  1612	001237'	137305	000002		DPB	T1, LDBOPB(U)	;  AND NEED-OUTPUT
  1613	001240'	263040	000000		POPJ	P,
  1614
  1615	001241'	354000	016035'	ZAPDFR:	AOSA	DFRZAP		;RECORD NUMBER
  1616	001242'	350000	016033'	ZAPLOG:	AOS	LOGZAP		; NOTE THE ZAP
  1617	001243'	202240	016034'		MOVEM	U, ZAPLPT	; SAVE PORT LDB ADDRESS
  1618	001244'	256000	016155'		 STOPCD (.+1,INFO,TTYZNE,PRTIRG,<Zapper not echoed for port>)
  1619	001245'	324740	001514'		PJRST	SIMRZP		; Simulate/force a zap (increment P4)
  1620	
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 28
SCNSER.MAC	25-NOV-87 19:52		BLKIBF - HERE WHEN A TYPE 47 (INPUT BUFFER FULL) IS RECEIVED

  1621				SUBTTL	BLKIBF - HERE WHEN A TYPE 47 (INPUT BUFFER FULL) IS RECEIVED
  1622				;	   FROM THE BASE.
  1623
  1624	001246'	135440	000267'	BLKIBF:	LDB	T4, INPDL2	; T4/ COUNT
  1625	001247'	340740	000000		AOJ	P4,
  1626	001250'	260040	001330'	FRCIBF:	PUSHJ	P,BLKICK	; EVERYTHING OK?
  1627	001251'	256000	016161'	TTYBNP:: STOPCD (.+1,INFO,TTYBNP,,<Block mode io Not in Progress>)
  1628				 ;;FRCIBF+1
  1629	001252'	322200	001325'		JUMPE	F, FREBUF	; DETACHED: GIVE UP
  1630
  1631				    ;STORE THE CHARACTER COUNT INTO THE USER'S BUFFER
  1632
  1633	001253'	550305	000005	BLKIB1:	HRRZ	T1, LDBBIO(U)	; T1/ INPUT BUFFER ADDR
  1634	001254'	552446	000005		HRRZM	T4, BIOCHR(T1)	; STORE THE COUNT
  1635
  1636				    ;WAKE/INTERRUPT THE JOB
  1637
  1638	001255'	260040	005754'	BLKIB2:	PUSHJ	P, BIOWAK	; WAKE UP JOB
  1639	001256'	201300	004000		MOVEI	T1, LXRBRK
  1640	001257'	436305	000032		IORM	T1, LDBDCX(U)	; SET BIT FOR POLPRT
  1641	001260'	135300	000223'		LDB	T1, DDPTLN	; IF INTERRUPT-ON-BREAK ENABLED
  1642	001261'	260040	001231*		PUSHJ	P, TAKTRJ	; TAKE IT
  1643
  1644				    ;FREE THE BUFFER (AND, IF NO OUTPUT PENDING, THE BASE PORT)
  1645				    ;IF THE PORT HAS LEFT BLOCK MODE
  1646
  1647	001262'	205340	001000	BLKIB3:	MOVSI	T2, LMLBIO
  1648	001263'	616345	000030		TDNN	T2, LDBMOD(U)	; BLOCK I/O ENABLED?
  1649	001264'	324740	001325'		PJRST	FREBUF		; NO: FREE THE BUFFER
  1650	001265'	263040	000000		POPJ	P,
  1651
  1652				;BLKEOT - HERE WHEN A "INPUT TERMINATED - END OF TRANSMISSION"
  1653				; (TYPE 50) IS RECEIVED FROM THE BASE.
  1654
  1655	001266'	135440	000267'	BLKEOT:	LDB	T4, INPDL2	; T4/ COUNT
  1656	001267'	340740	000000		AOJ	P4,
  1657	001270'	260040	001330'	FRCEOT:	PUSHJ	P, BLKICK	; EVERYTHING OK?
  1658	001271'	256000	001251'		 STOPCD (,XCT,TTYBNP)
  1659					;Block mode io Not in Progress ;;FRCEOT+1
  1660	001272'	322200	001325'		PJUMPE	F, FREBUF	; DETACHED: GIVE UP
  1661	001273'	135300	000241'		LDB	T1, DDPMOD	; T1/ DATA MODE
  1662	001274'	306300	000014		CAIN	T1, B
  1663	001275'	254000	001253'		JRST	BLKIB1		; BINARY: JUST RETURN THE DATA
  1664	001276'	260040	012337'	IMGITM:	PUSHJ	P, BLKTRQ	; REQUEST INPUT TERMINATION
  1665	001277'	205000	000040	IMGIT2:	MOVSI	S, IOEND
  1666	001300'	437004	000002		IORB	S, DEVIOS(F)	; SET IOEND
  1667	001301'	326440	001253'		JUMPN	T4, BLKIB1	; COUNT .gt. 0: RETURN THE DATA
  1668	001302'	260040	012105'		PUSHJ	P, RELBI	; COUNT = 0: DONE WITH BLOCK INPUT
  1669	001303'	254000	001255'		JRST	BLKIB2		; WAKE THE JOB AND RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 29
SCNSER.MAC	25-NOV-87 19:52		BLKITM - HERE WHEN AN "INPUT TERMINATED - TIMEOUT BY BASE"

  1670				SUBTTL	BLKITM - HERE WHEN AN "INPUT TERMINATED - TIMEOUT BY BASE"
  1671				; (TYPE 51) MESSAGE IS RECEIVED FROM THE BASE.
  1672
  1673	001304'	135440	000267'	BLKITM:	LDB	T4,INPDL2	; T4/ COUNT
  1674	001305'	340740	000000		AOJ	P4,
  1675	001306'	260040	001330'	FRCITM:	PUSHJ	P,BLKICK	; EVERYTHING OK?
  1676	001307'	263040	000000		  POPJ	P,		; NO: IGNORE THE MESSAGE
  1677	001310'	322200	001325'		PJUMPE	F, FREBUF	; DETACHED: GIVE UP
  1678	001311'	201000	040000		MOVEI	S, IOBKTL
  1679	001312'	437004	000002		IORB	S, DEVIOS(F)	; SET IO.BKT
  1680	001313'	135300	000241'		LDB	T1, DDPMOD	; T1/ DATA MODE
  1681	001314'	306300	000010		CAIN	T1, I
  1682	001315'	254000	001276'		JRST	IMGITM		; IMAGE: REQ TRM, RETURN DATA
  1683	001316'	326440	001253'		JUMPN	T4, BLKIB1	; COUNT.gt.0: WAKE JOB, RETURN DATA
  1684
  1685				    ;HERE WHEN NOT IN IMAGE MODE, TO REPEAT THE REQUEST
  1686
  1687	001317'	200305	000030		MOVE	T1, LDBMOD(U)
  1688	001320'	603300	400000		TLNE	T1, LMLTBI	; TERMINATE PENDING?
  1689	001321'	263040	000000		 POPJ	P,		; YES: DON'T REREQUEST INPUT
  1690	001322'	550305	000005		HRRZ	T1, LDBBIO(U)	; T1/ INPUT BUFFER ADDRESS
  1691	001323'	550346	000005		HRRZ	T2, BIOCHR(T1)	; T2/ SAME COUNT AS BEFORE
  1692	001324'	324740	011751'		PJRST	BLKIRQ		; REQUEST INPUT
  1693
  1694				;FREBUF - CALLED WHEN A PORT WITH LMLBIO CLEAR RECEIVES
  1695				;	   A BLOCK INPUT TERMINATED MESSAGE
  1696
  1697	001325'	260040	012105'	FREBUF:	PUSHJ	P, RELBI	; DONE WITH BLOCK INPUT
  1698	001326'	326300	001136*		JUMPN	T1, CPOPJ	; IF NO PENDING OUTPUT,
  1699	001327'	324740	012046'		PJRST	DECBC		;   FLAG 1 FEWER BLOCK PORT
  1700
  1701				; BLKICK - COMMON SUBROUTINE FOR BLOCK-INPUT-TERMINATED
  1702				;	    MESSAGES.
  1703
  1704	001330'	550305	000005	BLKICK:	HRRZ	T1, LDBBIO(U)	; T1/ INPUT BUFFER ADDRESS
  1705	001331'	332000	000006		SKIPE	T1		; IF NO BUFFER
  1706	001332'	331006	000005		SKIPL	BIOCHR(T1)	; OR NO REQUEST PENDING
  1707	001333'	263040	000000		POPJ	P,		; FAIL-RETURN
  1708	001334'	550205	000000		HRRZ	F, LDBDDB(U)	; F/ DDB
  1709	001335'	350001	000000		AOS	(P)
  1710	001336'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 30
SCNSER.MAC	25-NOV-87 19:52		BLKIHR - HERE WHEN "INPUT TERMINATED - BY HOST REQUEST"

  1711				SUBTTL	BLKIHR - HERE WHEN "INPUT TERMINATED - BY HOST REQUEST"
  1712				; (TYPE 52)MESSAGE IS RECEIVED FROM THE BASE.
  1713
  1714	001337'	135440	000267'	BLKIHR:	LDB	T4, INPDL2	; T4/ COUNT
  1715	001340'	340740	000000		AOJ	P4,
  1716	001341'	205300	400000	FRCIHR:	MOVSI	T1, LMLTBI
  1717	001342'	412305	000030		ANDCAM	T1, LDBMOD(U)	; CLEAR TERMINATE-PENDING FLAG
  1718	001343'	550305	000005		HRRZ	T1, LDBBIO(U)	; T1/ INPUT BUFFER ADDRESS
  1719	001344'	336000	000006		SKIPN	T1		; IF THERE'S NONE THERE,
  1720	001345'	263040	000000		POPJ	P,		;   NOTHING MORE TO DO
  1721	001346'	200346	000005		MOVE	T2, BIOCHR(T1)	; T2/ IN-PROGRESS FLAG,,COUNT
  1722	001347'	325340	001262'		JUMPGE	T2, BLKIB3	; NO BLOCK INPUT IN PROGRESS
  1723	001350'	550205	000000		HRRZ	F, LDBDDB(U)	; F/ DDB
  1724	001351'	322200	001325'		PJUMPE	F, FREBUF	; DETACHED: FREE THE BUFFER
  1725	001352'	254000	001277'		JRST	IMGIT2		; SET IOEND, RETURN DATA
  1726
  1727				;BLKOHR - HERE WHEN AN "OUTPUT TERMINATED" (TYPE 52)
  1728				;	   OR AN "OUTPUT TERMINATED BY HOST REQUEST" (TYPE 53)
  1729				;	   MESSAGE IS RECEIVED FROM THE BASE
  1730
  1731	001353'	340740	000000	BLKOHR:	AOJ	P4,
  1732	001354'	205300	400000		MOVSI T1,LDLNOP
  1733	001355'	412305	000031		ANDCAM T1,LDBDCH(U)	;CLEAR OUTPUT BACKPRESSURE
  1734	001356'	201300	000001		MOVEI T1,1
  1735	001357'	137305	000002		DPB T1,LDBOPB(U)	;AND SET NEED-OUTPUT BIT
  1736	001360'	554305	000005	FRCOHR:	HLRZ T1,LDBBIO(U)	;T1/ OUTPUT BUFFER
  1737	001361'	322300	001367'		JUMPE T1,BLKOH1		;IF NONE, DO (ALMOST) NOTHING
  1738	001362'	260040	012111'		PUSHJ P,RELBO		;DONE WITH BLOCK OUTPUT
  1739	001363'	326300	001367'		JUMPN T1,BLKOH1		;IF NO ACTIVE BLOCK I/O
  1740	001364'	200345	000030		MOVE T2,LDBMOD(U)
  1741	001365'	607340	001000		TLNN T2,LMLBIO		;AND PORT WANTS OUT OF BLOCK MODE,
  1742	001366'	260040	012046'		PUSHJ P,DECBC		;  GET IT OUT
  1743	001367'	550205	000000	BLKOH1:	HRRZ F,LDBDDB(U)
  1744	001370'	322200	001326*		JUMPE F, CPOPJ		;IF ATTACHED,
  1745	001371'	324740	006070'		PJRST XMTWAK		;WAKE THE JOB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 31
SCNSER.MAC	25-NOV-87 19:52		BLKIHR - HERE WHEN "INPUT TERMINATED - BY HOST REQUEST"

  1746				IFNCPU (<KI,KL>), <
  1747				BLKNEG:	 STOPCD (,XCT,TTYBMT)	;56 NEGOTIATE FOR # BLOCK I/O PORTS NOT USED
  1748				>; END IFNCPU (<KI,KL>)
  1749
  1750				IFCPU (<KI,KL>), <
  1751				;SNDBIO - HERE AT CHANNEL 7 LEVEL FROM SCNINT WHEN THERE ARE
  1752				;ANY BLOCK I/O PORT REQUESTS (EITHER INCREASE OR DECREASE)
  1753				;PENDING.
  1754
  1755	001372'	260040	004102'	SNDBIO:	PUSHJ P,CLSCHR		;FINISH PREVIOUS MESSAGE AND
  1756	001373'	263040	000000		 POPJ P,		; RETURN IF NO MORE SPACE.
  1757	001374'	205700	134000		MOVSI P3,TYPI TYPNEG	;PORT REQUEST TYPE FOR
  1758				;Following code commented out since there are no KMC's on
  1759				; KI's and KL's.
  1760				;IFKMC<	PUSHJ P,MDRUP		;GET UP DRs
  1761				;	JUMPE T1,CPOPJ		;IF NO NODES ARE UP THEN GIVEUP
  1762				;	SKIPA			;Don't shift the first time
  1763				;SNDBI1: LSH	T1,-3
  1764				;	TRNN  T1,7		;NO SKIP IF LOW 3 BITS ARE ALL 0s
  1765				;	  JRST SNDBI1		;Go try the next one
  1766				;	SUBI	T1,1
  1767				;	ANDI	T1,3
  1768				;	LSH	T1,6
  1769				;	DPB	T1,WRPLIN	;STUFF THE UP DR NUMBER IN PORT
  1770				;>;IFKMC.END
  1771	001375'	553300	015776'		HRRZS T1,BIOCNT+0	;GET THE NEW REQUEST COUNT
  1772	001376'	137300	000273'		DPB T1,WRPCHR		;AND WRITE INTO 1ST DATA CHAR
  1773	001377'	350000	016006'		AOS BIOANS		;INC RESP COUNT EXPECTED OF BASE
  1774	001400'	254000	004144'		JRST WRDOUT		;SEND THE REQUEST AND SKIP RETURN.
  1775
  1776				;BLKNEG - AT SNDBIO, WE SENT A TYPE 54, ASKING FOR <BIOCNT+0>
  1777				;BLOCK I/O PORTS. WE GET HERE WHEN WE GET A TYPE 54 BACK FROM
  1778				;THE BASE, TELLING US HOW MANY WE CAN HAVE.
  1779
  1780	001401'	337000	016006'	BLKNEG:	SKIPG	BIOANS		;IF WE DIDN'T SEND A REQUEST
  1781					JRST	[
  1782						AOS ERRBNG
  1783						AOJA P4, SCNIN1	;  IGNORE THE "RESPONSE"
  1784	001402'	254000	016164'		]
  1785	001403'	377000	016006'		SOSG	BIOANS		;IF THERE'RE MORE RESPONSES COMING
  1786	001404'	335340	015776'		SKIPGE	T2, BIOCNT+0	;OR THERE'S ANOTHER REQUEST PENDING,
  1787	001405'	344740	000746'		AOJA	P4, SCNIN1	;  IGNORE THE RESPONSE
  1788	001406'	135440	000264'		LDB	T4, INPCHR	;T4/ # OF PORTS WE CAN HAVE
  1789	001407'	210300	000011		MOVN	T1, T4
  1790	001410'	270300	016000'		ADD	T1, BIOPRT	;T1/ #PORTS BEFORE - #PORTS NOW
  1791	001411'	322300	001423'		JUMPE	T1, BLKNG4
  1792	001412'	323300	001415'		JUMPLE	T1, BLKNG2
  1793	001413'	311340	016000'		CAML	T2, BIOPRT	;IF NOW .LT. BEFORE .LE. #JOBS
  1794	001414'	256000	000000'		 STOPCD 		;  SOMEONE'S GOING THE WRONG WAY
  1795	001415'	200340	000000*	BLKNG2:	MOVE	T2, BPREQ	;T2/ OLD BLOCK-PORT-REQ
  1796	001416'	272300	001415*		ADDM	T1, BPREQ	;UPDATE BPREQ
  1797	001417'	323340	001422'		JUMPLE	T2, BLKNG3	;IF SOMEONE WAS IN BLOCK-PORT WAIT
  1798	001420'	337000	000006		SKIPG	T1		;AND THERE'RE MORE PORTS NOW,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 31-2
SCNSER.MAC	25-NOV-87 19:52		BLKIHR - HERE WHEN "INPUT TERMINATED - BY HOST REQUEST"

  1799	001421'	476000	000000*		SETOM	BPAVAL		;  TELL THE SCHEDULER
  1800	001422'	202440	016000'	BLKNG3:	MOVEM	T4, BIOPRT	;SET THE NEW # OF PORTS
  1801	001423'	336100	015770'	BLKNG4:	SKIPN	J, BIOJOB	;IF THERE'S A JOB IN AX WAIT,
  1802	001424'	344740	000746'		AOJA	P4, SCNIN1
  1803	001425'	402000	015770'		SETZM	BIOJOB
  1804	001426'	201300	000000*		MOVEI	T1, RNQ
  1805	001427'	137300	000000*		DPB	T1, PJBSTS##
  1806	001430'	260040	000000*		PUSHJ	P, SETRUN	;  WAKE IT UP
  1807	001431'	344740	000746'		AOJA	P4, SCNIN1
  1808				> ;END IFCPU (<KI,KL>)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 32
SCNSER.MAC	25-NOV-87 19:52		HERE WHEN A "CHARACTERS LOST" MESSAGE (BUFFER ZAP) IS

  1809				SUBTTL	HERE WHEN A "CHARACTERS LOST" MESSAGE (BUFFER ZAP) IS
  1810				;RECEIVED: IF THE DATA BYTE IS 0, OUTPUT CHARACTERS WERE
  1811				;LOST; OTHERWISE, INPUT CHARACTERS WERE LOST
  1812
  1813	001432'	340740	000000	RCVLOS:	AOJ	P4,
  1814	001433'	350000	016031'		AOS	TTYLOS		;RECORD CHARACTER LOST BY TYMNET
  1815	001434'	135300	000264'		LDB	T1, INPCHR	;T1/ DIRECTION
  1816	001435'	336000	000006	FRCLOS:	SKIPN	T1
  1817	001436'	664300	020000		TROA	T1, LXROCL	; 0 = OUTPUT LOST
  1818	001437'	201300	040000		MOVEI	T1, LXRICL	; 1 = INPUT LOST
  1819	001440'	436305	000032		IORM	T1, LDBDCX(U)
  1820	001441'	550205	000000		HRRZ F,LDBDDB(U)
  1821	001442'	322200	001370*		JUMPE F,CPOPJ		;NOTHING TO DO IF NO DDB
  1822	001443'	201300	040000		MOVEI T1,IOBKTL
  1823	001444'	436304	000002		IORM T1,DEVIOS(F)	;SET ERROR FLAG
  1824	001445'	135300	000226'		LDB T1,DDPTLC
  1825	001446'	324740	001261*		PJRST TAKTRJ		;SET TO INTERRUPT
  1826
  1827				;HERE WHEN A TERMINAL CHARACTERISTICS VALUE IS RECEIVED
  1828
  1829	001447'	135300	000265'	RCVTMC:	LDB	T1,INPCH2	;VALUE
  1830	001450'	135340	000264'		LDB	T2,INPCHR	;AND TYPE NUMBER
  1831	001451'	303340	000023		CAILE	T2,MAXTMC	;CHECK RANGE
  1832	001452'	254000	001455'		 JRST	RCVTCX		;(BAD)
  1833	001453'	137307	000004'		DPB	T1,TABTMR(T2)
  1834	001454'	344740	000746'		AOJA	P4,SCNIN1	;FINISHED
  1835
  1836	001455'			RCVTCX:
  1837				;*;	CAILE	T2,<MAXTMC+TMCSLP>
  1838				;*;	 STOPCD			;AMAZINGLY BAD
  1839	001455'	350000	016044'		AOS	TMCOOR		;SLIGHTLY BAD - BUMP OUT-OF-RANGE COUNT
  1840	001456'	344740	000746'		AOJA	P4,SCNIN1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 33
SCNSER.MAC	25-NOV-87 19:52		HERE WHEN THE TIME AND DATE ARE RECEIVED

  1841				SUBTTL	HERE WHEN THE TIME AND DATE ARE RECEIVED
  1842
  1843	001457'	135340	000267'	CLKRSP:	LDB	T2,INPDL2	;GET HIGH ORDER BITS OF TIME
  1844	001460'	271740	000001		ADDI	P4,1
  1845	001461'	405740	000746*		ANDI	P4,MSKIRG
  1846	001462'	135300	000266'		LDB	T1,INPDL1	;GET LOW ORDER BITS
  1847	001463'	137340	016166'		DPB	T2,[POINT 16,T1,19]
  1848	001464'	231300	250600		IDIVI	T1,^D<24*60*60>	;DAYS IN T1, SEC IN T2
  1849	001465'	271300	007105		ADDI	T1,^D3653	;Convert 1-JAN-74 to 1-JAN-64
  1850	001466'	220340	000000*		IMUL	T2,JFYSEC
  1851	001467'	250300	000007		EXCH	T1,T2		;Time in T1, Date in T2
  1852	001470'	260040	000000*		PUSHJ	P,COMGMS##	;Set GMT time (in UUOCON)
  1853	001471'	200300	000000*		MOVE	T1,DATE##	;Remember the date/time of when
  1854	001472'	202300	000000*		MOVEM	T1,SUPTIM##	; the Supervisor saw us
  1855	001473'	344740	000746'		AOJA	P4,SCNIN1
  1856
  1857				;HERE WHEN A PORT STATUS MESSAGE IS RECEIVED (see comment at ACPSM)
  1858
  1859	001474'	135300	000264'	RCVPS:	LDB	T1,INPCHR	; GET THE 4 BITS
  1860	001475'	137300	000172'		DPB	T1,LDPPSM	; STORE PORT STATUS MSG
  1861	001476'	201300	100000		MOVEI	T1,LXRPSS
  1862	001477'	436305	000032		IORM	T1,LDBDCX(U)	; AND NOTE THAT IT'S BEEN SEEN
  1863	001500'	205300	200000		MOVSI	T1,LMLPSP
  1864	001501'	436305	000030		IORM	T1,LDBMOD(U)
  1865	001502'	550205	000000		HRRZ	F,LDBDDB(U)
  1866	001503'	322200	001506'		JUMPE	F,PSDONE	; NO TRAP IF NO DDB
  1867	001504'	135300	000231'		LDB	T1,DDPTPS
  1868	001505'	260040	001446*		PUSHJ	P,TAKTRJ	; SET TO INTERRUPT
  1869	001506'	344740	000746'	PSDONE:	AOJA	P4,SCNIN1	; DONE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 34
SCNSER.MAC	25-NOV-87 19:52		HERE WHEN A CIRCUIT ZAPPER IS RECEIVED

  1870				SUBTTL	HERE WHEN A CIRCUIT ZAPPER IS RECEIVED
  1871
  1872	001507'	350000	016036'	RCVZAP:	AOS	NZAPIN		;# REAL, TRUE ZAPPERS IN
  1873	001510'	200305	000001		MOVE	T1,LDBLIN(U)	;Mark as zapper coming from TYMNET
  1874	001511'	663300	400000		TLOE	T1,LNLZIN	;If there's one already in,
  1875					 JRST	[MOVEI	T1,NZAPN2
  1876						 PUSHJ	P,ZAPBUG  ;NOTE IT
  1877	001512'	254000	016167'			 JRST	SIMRZP	]
  1878	001513'	202305	000001		MOVEM	T1,LDBLIN(U)
  1879	001514'	271740	000001	SIMRZP:	ADDI	P4,1		;Skip past the zap command in IRING
  1880
  1881				;Enter at FRCZAP to pretend we received a zapper from the base
  1882
  1883	001515'	402005	000003	FRCZAP:	SETZM	LDBOUT(U)		;Cancel any pending output bits
  1884	001516'	205300	000400		MOVSI	T1,L2LOWT
  1885	001517'	412305	000027		ANDCAM	T1,LDBBYT(U)		;Cancel wait for orange ball
  1886	001520'	331005	000026		SKIPL	LDBLOG(U)		;If port's not logged-in,
  1887					 JRST	[SETZB	T1,LDBLOG(U)	; cancel "login in progress"
  1888						 DPB	T1,LDPHST	;Clear host number
  1889						 MOVEI	T1,1
  1890						 DPB	T1,LOPZAP	;Set send-zapper
  1891						 DPB	T1,LDBOPB(U)	; and need-output
  1892						 MOVSI	T1,LDLNOP
  1893						 ANDCAM	T1,LDBDCH(U)	;Ignore backpressure
  1894	001521'	254000	016172'			 POPJ	P,	]
  1895	001522'	205300	300000		MOVSI	T1,LLLNLN!LLLZAP	;Line not there (TYMNET has zapped it)
  1896	001523'	436305	000026		IORM	T1,LDBLOG(U)		;Mark port as externally zapped
  1897	001524'	200305	000030		MOVE	T1,LDBMOD(U)
  1898	001525'	607300	001000		TLNN	T1,LMLBIO		;IF BLOCK-MODE SET,
  1899	001526'	332005	000005		SKIPE	LDBBIO(U)		;OR BLOCK I/O'S STILL IN PROGRESS,
  1900	001527'	260040	011634'		 PUSHJ	P,BIOZAP		;  RELEASE BUFFERS & CLEAR BLOCK-MODE
  1901	001530'	603240	000040		TLNE	U,LDLAUX		;IF IT'S AN AUX PORT
  1902	001531'	324740	011024'		 PJRST	ZAPAUX
  1903	001532'	550205	000000		HRRZ	F,LDBDDB(U)
  1904	001533'	322200	001442*		JUMPE	F,CPOPJ
  1905	001534'	205300	020000		MOVSI	T1,TTYATC
  1906	001535'	616304	000004		TDNN	T1,DEVMOD(F)		;OR AT ANY RATE NOT A COMMAND PORT,
  1907	001536'	324740	011024'		 PJRST	ZAPAUX			;  DETACH & TRY TO FREE DDB
  1908
  1909				    ;HERE WHEN A ZAPPER IS RECEIVED ON A JOB'S COMMAND PORT
  1910
  1911	001537'	135100	001125*		LDB	J,PJOBN			;J/ DON't FORCE,,JOB#
  1912	001540'	260040	006572'		PUSHJ	P,HNGTTY		;Force hangup for job/frame
  1913	001541'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 35
SCNSER.MAC	25-NOV-87 19:52		INPUT CHARACTER HANDLER

  1914				SUBTTL INPUT CHARACTER HANDLER
  1915
  1916	001542'	336005	000026	CHRMLT:	SKIPN	LDBLOG(U)		;MIGHT BE LINE WE HAVE JUST
  1917	001543'	254000	001562'		 JRST	MLTNDB			; SENT ZAPPER ON, FIX INPUT RING
  1918	001544'	201317	000267*		MOVEI	T1,IRING(P4)
  1919	001545'	505300	241000		HRLI	T1,(POINT 8,0,BYP2)	;SET UP A BYTE POINTER
  1920	001546'	202300	015735'		MOVEM	T1,CHRRDP
  1921	001547'	134400	015735'	CHRML1:	UUILDB	T3,CHRRDP
  1922	001550'	260040	001576'		PUSHJ	P,MOVCHR
  1923	001551'	367600	001547'		 SOJG	P1,CHRML1		;CONTINUE
  1924	001552'	327600	001571'		JUMPG	P1,CHRML3		;HERE AT END OR DEF ECHO MODE
  1925	001553'			CLRMLT:
  1926				;;;;;;;; MORE KMC DEBUG CODE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  1927				IFKMC<	MOVE	P1,IRPMSG
  1928					CAME	P1,IRING(P4)
  1929					 STOPCD 		;CRASH ON KMC IRING OVERWRITE or bad P4
  1930				>;END_IFKMC
  1931				;;;;;;;; END KMC DEBUG CODE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  1932	001553'	135600	000262'		LDB	P1,INPTYP		;NOW CLEAR OUT THE INPUT RING
  1933	001554'	620600	000200		TRZ	P1,200			;GET COUNT BACK
  1934	001555'	550205	000000		HRRZ	F,LDBDDB(U)		;CHARGE
  1935	001556'	322200	001562'		JUMPE	F,MLTNDB
  1936	001557'	135300	001537*		LDB	T1,PJOBN
  1937	001560'	272606	000000*		ADDM	P1,JBTCIN(T1)
  1938	001561'	272600	001560*		ADDM	P1,JBTCIN
  1939	001562'	271600	000005	MLTNDB:	ADDI	P1,5	;GET NUMBER OF WORDS USED (2 BYTES FOR COUNT AND PORT)
  1940	001563'	242600	777776		LSH	P1,-2
  1941	001564'	270740	000014		ADD	P4,P1			;INCREMENT POINTER BY NUMBER USED
  1942	001565'	254000	000746'		JRST	SCNIN1
  1943
  1944	001566'	134400	015735'	CHRML2:	UUILDB	T3,CHRRDP
  1945	001567'	260040	001576'		PUSHJ	P,MOVCHR		;THIS IS THE DEFERED ECHO LOOP
  1946	001570'	255000	000000		 JFCL				;SHOULD NOT BE GETTING HERE
  1947	001571'	367600	001566'	CHRML3:	SOJG	P1,CHRML2
  1948	001572'	201300	000001		MOVEI	T1, 1
  1949	001573'	137300	000100'		DPB	T1, LOPECO		;SET SEND-ECHO
  1950	001574'	137305	000002		DPB	T1, LDBOPB(U)		;AND NEED-OUTPUT
  1951	001575'	254000	001553'		JRST	CLRMLT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 36
SCNSER.MAC	25-NOV-87 19:52		CALLED WITH CHARACTER IN T3. DISPATCH ON CHARACTER TYPE AND LINE MODE

  1952				SUBTTL	CALLED WITH CHARACTER IN T3. DISPATCH ON CHARACTER TYPE AND LINE MODE
  1953
  1954	001576'	135640	000176'	MOVCHR:	LDB	P2,LDPMIN	;Get the input mode
  1955	001577'	606400	000200		TRNN	T3,200
  1956	001600'	334710	000305'	MOVCH2:	SKIPA	P3,CHRTAB(T3)	;Get character bits
  1957	001601'	200710	000105'		MOVE	P3,CHRTAB-200(T3)
  1958	001602'	135340	000275'		LDB	T2,CHPINP	;GET INPUT TYPE
  1959	001603'	256015	001605'	MOVCH1:	XCT	CIMTAB(P2)	;DO THE RIGHT THING FOR THE LINE MODE
  1960	001604'	254006	000000		JRST	(T1)		;THIS WILL USUALLY LOAD AN ADDRESS IN T1
  1961
  1962				;LINE MODE DISPATCH TABLE
  1963
  1964	001605'	254000	001736'	CIMTAB:	JRST	LOGCHR		;LOGIN
  1965	001606'	254000	002112'		JRST	IMGDEF		;IMAGE,DEF ECHO
  1966	001607'	254000	002125'		JRST	IMGRMA		;IMAGE,REM ECHO,BKA=1
  1967	001610'	254000	002141'		JRST	IMGRMT		;IMAGE,REM ECHO,BKA=0
  1968	001611'	554307	001621'		HLRZ	T1,MD0405(T2)	;NORMAL,DEF ECHO,BK2=0
  1969	001612'	550307	001621'		HRRZ	T1,MD0405(T2)	;NORMAL,DEF ECHO,BK2=1
  1970	001613'	554307	001625'		HLRZ	T1,MD0607(T2)	;NORMAL,REM ECHO,BKA=1,BK2=0
  1971	001614'	550307	001625'		HRRZ	T1,MD0607(T2)	;NORMAL,REM ECHO,BKA=1,BK2=1
  1972	001615'	554307	001631'		HLRZ	T1,MD1011(T2)	;NORMAL,REM ECHO,BKA=0,BK2=1
  1973	001616'	550307	001631'		HRRZ	T1,MD1011(T2)	;NORMAL,REM ECHO,BKA=0,BK2=0
  1974	001617'	554307	001635'		HLRZ	T1,MD1213(T2)	;COMMAND,REM ECHO
  1975	001620'	550307	001635'		HRRZ	T1,MD1213(T2)	;COMMAND,DEF ECHO
  1976
  1977				;CHARACTER TYPE DISPATCH TABLES
  1978
  1979				; CHARACTER TYPES FOR INPUT
  1980				;
  1981				; 0 - SPECIAL ACTION
  1982				; 1 - NORMAL CHARACTER
  1983				; 2 - BREAK (CONTROL) CHARACTER
  1984				; 3 - BREAK2 (PUNCTUATION) CHARACTER
  1985
  1986	001621'	002506'	002506'	MD0405:	IACT0,,IACT0	; 0,, 0
  1987	001622'	002156'	002156'		IACT1,,IACT1	; 1,, 1
  1988	001623'	002161'	002161'		IACT2,,IACT2	; 2,, 2
  1989	001624'	002170'	002176'		IACT3,,IACT4	; 3,, 4
  1990
  1991	001625'	002506'	002506'	MD0607:	IACT0,,IACT0	; 0,, 0
  1992	001626'	002203'	002203'		IACT5,,IACT5	; 5,, 5
  1993	001627'	002210'	002210'		IACT6,,IACT6	; 6,, 6
  1994	001630'	002214'	002222'		IACT7,,IACT10	; 7,,10
  1995
  1996	001631'	002506'	002506'	MD1011:	IACT0,,IACT0	; 0,, 0
  1997	001632'	002230'	002230'		IACT11,,IACT11	;11,,11
  1998	001633'	002210'	002210'		IACT6,,IACT6	; 6,, 6
  1999	001634'	002222'	002437'		IACT10,,IACT12	;10,,12
  2000
  2001	001635'	002506'	002506'	MD1213:	IACT0,,IACT0	; 0,, 0
  2002	001636'	002445'	002474'		IACT13,,IACT21	;13,,21
  2003	001637'	002450'	002477'		IACT14,,IACT22	;14,,22
  2004	001640'	002456'	002466'		IACT15,,IACT17	;15,,17
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 37
SCNSER.MAC	25-NOV-87 19:52		THIS ROUTINE IS CALLED BY ALMOST EVERYONE TO PUT A CHR INTO

  2005				SUBTTL	THIS ROUTINE IS CALLED BY ALMOST EVERYONE TO PUT A CHR INTO
  2006				;THE INPUT BUFFER
  2007
  2008	001641'	200440	015712'	RCVCHR:	MOVE	T4,TTFREN
  2009	001642'	307440	000003		CAIG	T4,TIRSVD
  2010	001643'	254000	001721'		 JRST	RECHLT		;OUT OF BUFFERLETS. GIVE HIM BELL
  2011	001644'	200445	000012		MOVE	T4,LDBTIC(U)
  2012	001645'	270445	000014		ADD	T4,LDBECC(U)
  2013	001646'	311440	016014'		CAML	T4,TIWRNN	;OVER SMALL QUOTA?
  2014	001647'	254000	001707'		 JRST	RWARN		;TRY TO STOP HIS INPUT
  2015	001650'	260040	015237'	RCVCH1:	PUSHJ	P,CHRTRP	;TAKE A CHARACTER TRAP
  2016	001651'	336345	000010		SKIPN	T2,LDBTIP(U)
  2017	001652'	260040	001674'		 PUSHJ	P,RECVRG	;MUST SET UP THE INPUT POINTERS
  2018	001653'	260040	006135'		PUSHJ	P,TTPUTC	;PUT THE CHR IN THE BUFFER
  2019	001654'	202345	000010		MOVEM	T2,LDBTIP(U)
  2020	001655'	350005	000007		AOS	LDBBKI(U)
  2021	001656'	205300	004000		MOVSI	T1,L2LDEL	;SHOULD WE RESET THE \ FLAG?
  2022	001657'	616305	000027		TDNN	T1,LDBBYT(U)
  2023	001660'	254000	001670'		 JRST	RCVCH2		;NOT ON
  2024	001661'	261040	000007		PUSH	P,T2
  2025	001662'	201400	000134		MOVEI	T3,"\"
  2026	001663'	260040	002416'		PUSHJ	P,ENTRUB
  2027	001664'	201300	000001		MOVEI	T1,1
  2028	001665'	137300	000072'		DPB	T1,LOPRUB	;SET SEND-RUBOUT
  2029	001666'	137305	000002		DPB	T1,LDBOPB(U)	;AND NEED-OUTPUT
  2030	001667'	262040	000007		POP	P,T2
  2031	001670'	205300	204000	RCVCH2:	MOVSI	T1,L2LDEL!L2LCCS
  2032	001671'	412305	000027		ANDCAM	T1,LDBBYT(U)
  2033	001672'	350001	000000		AOS	(P)
  2034	001673'	263040	000000		POPJ	P,
  2035
  2036	001674'	260040	006173'	RECVRG:	PUSHJ	P,GETCHK
  2037	001675'	202345	000010		MOVEM	T2,LDBTIP(U)	;SET UP INPUT POINTERS
  2038	001676'	202345	000011		MOVEM	T2,LDBTIT(U)
  2039	001677'	202345	000013		MOVEM	T2,LDBECT(U)
  2040	001700'	402005	000007		SETZM	LDBBKI(U)
  2041	001701'	402005	000006		SETZM	LDBBKP(U)
  2042	001702'	402005	000012		SETZM	LDBTIC(U)
  2043	001703'	402005	000014		SETZM	LDBECC(U)
  2044	001704'	402005	000015		SETZM	LDBBKC(U)
  2045	001705'	402005	000016		SETZM	LDBBK2(U)
  2046	001706'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 38
SCNSER.MAC	25-NOV-87 19:52		THIS ROUTINE IS CALLED BY ALMOST EVERYONE TO PUT A CHR INTO

  2047	001707'	311440	016015'	RWARN:	CAML	T4,TIHLTN	;OVER LARGE QUOTA?
  2048	001710'	254000	001715'		 JRST	RWARN1		;YES: GO SEE HOW BADLY WE LOST
  2049	001711'	201300	000001		MOVEI	T1,1
  2050	001712'	137300	000061'		DPB	T1,LOPBPN	;NO: SET BACKPRESSURE-ON
  2051	001713'	137305	000002		DPB	T1,LDBOPB(U)	;    AND NEED-OUTPUT
  2052	001714'	254000	001650'		JRST	RCVCH1
  2053
  2054	001715'	135300	000061'	RWARN1:	LDB	T1,LOPBPN	;STILL WAITING TO SEND BACKPRESSURE?
  2055	001716'	332000	000006		SKIPE	T1
  2056	001717'	354000	016017'		 AOSA	LOSPDP		;YES: WE'RE TOO SLOW
  2057	001720'	350000	016020'		AOS	LOS620		;NO: BACKPRESSURE BROKEN
  2058					PFALL	RECHLT		;SEND BELL AND DROP CHARACTERS
  2059
  2060	001721'	350000	016016'	RECHLT:	AOS	TTYRHT		;RECORD CHARACTER LOST
  2061	001722'	201300	040000		MOVEI	T1,LXRICL
  2062	001723'	436305	000032		IORM	T1,LDBDCX(U)	;NOTE THE DIRECTION
  2063	001724'	550205	000000		HRRZ	F,LDBDDB(U)
  2064	001725'	322200	001732'		JUMPE	F,RECHT1
  2065	001726'	201300	040000		MOVEI	T1,IOBKTL	;SET IO.BKT
  2066	001727'	436304	000002		IORM	T1,DEVIOS(F)
  2067	001730'	135300	000226'		LDB	T1,DDPTLC	;IF CHARACTERS-LOST ENABLED
  2068	001731'	260040	001505*		PUSHJ	P,TAKTRJ	;TAKE IT
  2069	001732'	201300	000001	RECHT1:	MOVEI	T1,1
  2070	001733'	137300	000070'		DPB	T1,LOPSBL	;SET SEND-BELL
  2071	001734'	137305	000002		DPB	T1,LDBOPB(U)	;AND NEED-OUTPUT
  2072	001735'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 39
SCNSER.MAC	25-NOV-87 19:52		HERE ON A LOGIN CHARACTER (ONE OF FIRST 4 ON LINE)

  2073				SUBTTL	HERE ON A LOGIN CHARACTER (ONE OF FIRST 4 ON LINE)
  2074
  2075	001736'	337445	000026	LOGCHR:	SKIPG	T4,LDBLOG(U)	;Are we really logging him in?
  2076	001737'	263040	000000		 POPJ	P,		;No, return from MOVCHR
  2077	001740'	242440	000010		LSH	T4,^D8		;Put login char
  2078	001741'	434440	000010		IOR	T4,T3		; into
  2079	001742'	202445	000026		MOVEM	T4,LDBLOG(U)	;  LDBLOG
  2080	001743'	325440	001533*		JUMPGE	T4,CPOPJ	;More to come
  2081
  2082				;WE'VE RECEIVED THE 32 BITS OF LOGIN DATA FROM TYMNET - NOW LOG THE LINE IN
  2083
  2084	001744'	350000	015731'		AOS	INTERM		;COUNT 1 MORE LINE LOGGED-IN
  2085	001745'	135300	000152'		LDB	T1,TRMBYP	;T1/ TERMINAL ID CODE
  2086	001746'	200306	002052'		MOVE	T1,TRMTAB(T1)	;T1/ IBM,FAST,FC1,FC2,WIDTH CODES
  2087	001747'	607300	200000		TLNN	T1,200000	;FAST TERMINAL?
  2088	001750'	634400	000010		 TDZA	T3,T3		;NO
  2089	001751'	205400	400000		MOVSI	T3,LXL120	;YES
  2090	001752'	202405	000032		MOVEM	T3,LDBDCX(U)	;SET LDBDCX (0 EXCEPT FOR FAST BIT)
  2091	001753'	205400	021020		MOVSI	T3,LDLDEF!LDLLCT!LDLCOM
  2092	001754'	337000	000006		SKIPG	T1		;IS IT A 2741?
  2093	001755'	661400	000004		 TLO	T3,LDLLCP	;YES: SET LOCAL-COPY FLAG
  2094	001756'	402005	000027		SETZM	LDBBYT(U)	;MOST FIELDS ARE 0
  2095	001757'	137300	000166'		DPB	T1,LDPFC1	;SET FC1
  2096	001760'	242300	777776		LSH	T1,-2
  2097	001761'	137300	000162'		DPB	T1,LDPFC2	;AND FC2
  2098	001762'	242300	777776		LSH	T1,-2
  2099	001763'	137300	000164'		DPB	T1,LDPWID	;AND LINE WIDTH
  2100	001764'	205300	004000		MOVSI	T1,LLLHDX
  2101	001765'	616305	000026		TDNN	T1,LDBLOG(U)	;HALF-DUPLEX?
  2102	001766'	634300	000006		 TDZA	T1,T1		;NO
  2103	001767'	201300	000001		MOVEI	T1,1		;YES
  2104	001770'	137300	000014'		DPB	T1,LDPHDX	;SET THE CHARACTERISTIC
  2105	001771'	336000	000006		SKIPN	T1		;IF IT'S HALF DUPLEX
  2106	001772'	603400	000004		TLNE	T3,LDLLCP	;OR LOCAL-COPY (2741)
  2107	001773'	621400	001000		TLZ	T3,LDLDEF	;DON'T SET DEFERRED ECHO
  2108	001774'	202405	000031		MOVEM	T3,LDBDCH(U)
  2109	001775'	402005	000033		SETZM	LDBCLA(U)	;[dws] clear terminal type
  2110	001776'	205300	646471		MOVSI	T1,'TTY'
  2111	001777'	202305	000033		MOVEM	T1,LDBTYP(U)	;Terminal type
  2112	002000'	402005	000034		SETZM	LDBSTR(U)	;  CLEAR PREVIOUS CIRCUIT NAME
  2113	002001'	551305	000035		HRRZI	T1,LDBSTR+1(U)	;  GET ADDRESS
  2114	002002'	505306	777777		HRLI	T1,-1(T1)	;    STR,,STR+1
  2115	002003'	251305	000043		BLT	T1,LDBSTR+AUXSTL-1(U)
  2116
  2117	002004'	500240	000010		HLL	U,T3		;Make sure this matches LH<LDBDCH>
  2118								; or aux cir test on next page fails
  2119
  2120					;CLEAR RECEIVED CHARACTERISTICS
  2121
  2122			000000		ZZN==0
  2123					REPEAT TMCSIZ,<
  2124	002005'	402005	000044		SETZM	LDBTMR+ZZN(U)
  2125			000001		ZZN==ZZN+1>
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 40
SCNSER.MAC	25-NOV-87 19:52		HERE ON A LOGIN CHARACTER (ONE OF FIRST 4 ON LINE)

  2126					;SET TO ECHO CR AS CRLF, NOT ECHO CTRL-I,
  2127					;NOT ECHO LF AS CRLF
  2128
  2129	002006'	201300	000000		MOVEI	T1,0
  2130	002007'	137300	000032'		DPB	T1,LDSELF
  2131	002010'	137300	000031'		DPB	T1,LDSCIE
  2132	002011'	201300	000001		MOVEI	T1,1
  2133	002012'	137300	000033'		DPB	T1,LDSECR
  2134	002013'	200300	016202'		MOVE	T1,[LTSELF!LTSCIE!LTSECR]
  2135	002014'	202305	000046		MOVEM	T1,LDBTMT(U)
  2136
  2137	002015'	402005	000003		SETZM	LDBOUT(U)	;CLEAR ALL SEND BITS BUT...
  2138	002016'	201300	000001		MOVEI	T1,1
  2139	002017'	137300	000067'		DPB	T1,LOPSTC	;SET SEND-CHARACTERISTICS
  2140	002020'	137300	000066'		DPB	T1,LOPSTP	;AND SEND-PROBE
  2141	002021'	137305	000002		DPB	T1,LDBOPB(U)	;AND NEED-OUTPUT
  2142	002022'	553005	000000		HRRZS	LDBDDB(U)	;CLEAR KJOB ETC. BITS
  2143	002023'	201300	200000		MOVEI	T1,STSUPR	;200000
  2144	002024'	612300	000000*		TDNE	T1,STATES
  2145	002025'	254000	002031'		 JRST	LOGCH1		;System is super-shut, zap always
  2146	002026'	603240	000040		TLNE	U,LDLAUX	;Is this an AUX circuit ?
  2147	002027'	331000	002024*		SKIPL	STATES		;Yes, is system plain shut ?
  2148	002030'	254000	002034'		 JRST	LOGCH2		;No, o.k. to log in
  2149	002031'	202305	000026	LOGCH1:	MOVEM	T1,LDBLOG(U)	;Must be non-zero and non-negative
  2150	002032'	370000	015731'		SOS	INTERM		;Leave INTERM alone in case
  2151	002033'	254000	014622'		JRST	TTYZAP		; of Auto-Restart
  2152
  2153	002034'	260040	007534'	LOGCH2:	PUSHJ	P,SETLMD	;Set the line mode
  2154				;;
  2155				;; Here (finally!) to assign a frame for this port and initiate
  2156				;; LOGIN.
  2157				;;
  2158	002035'	400200	000000		SETZ	F,		;Indicate no DDB assigned yet
  2159	002036'	260040	000000*		PUSHJ	P,FRMASN##	;Assign a free frame number
  2160	002037'	254000	002044'		  JRST	NEWJER		;No free frames...
  2161	002040'	260040	014645'		PUSHJ	P,TTYATI	;Attach a TTY DDB to this LDB
  2162	002041'	254000	002047'		  JRST	NEWTER		;No free TTY DDB's
  2163	002042'	201300	000000*		MOVEI	T1,CMFCXN##	;Forced command index for LOGIN
  2164	002043'	324740	013276'		PJRST	TTFORC		;Force a LOGIN command on this port
  2165
  2166				NEWJER:	MOVEI	T1,[ASCIZ /
  2167				frame capacity exceeded
  2168	002044'	201300	016203'	/]
  2169	002045'	260040	000000*		PUSHJ	P,CONMES##	;Type out error message
  2170	002046'	324740	014622'		PJRST	TTYZAP		;Kill off TTY
  2171
  2172				NEWTER:	MOVEI	T1,[ASCIZ /
  2173				port capacity exceeded
  2174	002047'	201300	016211'	/]
  2175	002050'	260040	002045*		PUSHJ	P,CONMES##	;Type out error message
  2176	002051'	324740	000000*		PJRST	FRMKJF##	;Free up frame slot and kill off TTY
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 41
SCNSER.MAC	25-NOV-87 19:52		HERE ON A LOGIN CHARACTER (ONE OF FIRST 4 ON LINE)

  2177				;TERMINAL ID CODE = INITIAL TERMINAL CHARACTERISTICS TABLE
  2178
  2179				DEFINE TERCH (IBM,FAST,F1,F2,WIDTH)
  2180					<BYTE (1) IBM,FAST (22) 0 (8) WIDTH (2) F2,F1>
  2181
  2182	002052'	200000	002400	TRMTAB:	TERCH (0,1,0,0,^D80)	;0    AUX circuit
  2183	002053'	000000	002400		TERCH (0,0,0,0,^D80)	;1  A 300 baud
  2184	002054'	000000	003613		TERCH (0,0,3,2,^D120)	;2  C 300 baud printer, wide carriage, delay
  2185	002055'	000000	002205		TERCH (0,0,1,1,^D72)	;3  E 300 baud thermal printer, small delay
  2186	002056'	000000	003603		TERCH (0,0,3,0,^D120)	;4  G 300 baud belt printer (GE Terminet), delay
  2187	002057'	000000	002205		TERCH (0,0,1,1,^D72)	;5  B 150 baud Teletype 37, no parity
  2188	002060'	000000	003613		TERCH (0,0,3,2,^D120)	;6  F 150 in, 300 out, Syner-Data Beta terminal
  2189	002061'	000000	002205		TERCH (0,0,1,1,^D72)	;7  J 150 baud Teletype 37, even parity
  2190	002062'	000000	002205		TERCH (0,0,1,1,^D72)	;8 CR 300 baud IBM 3767 in 2471 mode 32.4 cps
  2191	002063'	400000	002406		TERCH (1,0,2,1,^D80)	;9 CR 134.5 baud IBM 2471 EBCDIC
  2192	002064'	000000	002205		TERCH (0,0,1,1,^D72)	;10 D 110 baud Teletype ASR-33
  2193	002065'	000000	002405		TERCH (0,0,1,1,^D80)	;11 I (was dot-matrix printer) SYNC - HSA
  2194	002066'	200000	002403		TERCH (0,1,3,0,^D80)	;12 A,G,I 1200 baud (GOUGING=1, 120 cps)
  2195	002067'	200000	002400		TERCH (0,1,0,0,^D80)	;13 Burroughs 1200 polled terminal
  2196	002070'	200000	002400		TERCH (0,1,0,0,^D80)	;14 AUX through gateway
  2197	002071'	000000	002200		TERCH (0,0,0,0,^D72)	;15 BAUDOT, 50 or 75 baud
  2198	002072'	200000	002403		TERCH (0,1,3,0,^D80)	;16 A,G,I 2400 baud (GOUGING=2, 240 cps)
  2199	002073'	200000	002400		TERCH (0,1,0,0,^D80)	;17   SYNC - Polled Terminals
  2200	002074'	200000	002400		TERCH (0,1,0,0,^D80)	;18   SYNC - Point-to-Point
  2201	002075'	200000	002403		TERCH (0,1,3,0,^D80)	;19 A,G,I 4800 baud (GOUGING=2, 240 cps)
  2202	002076'	200000	002403		TERCH (0,1,3,0,^D80)	;20 A,G,I 9600 baud (GOUGING=3, 960 cps)
  2203	002077'	200000	002403		TERCH (0,1,3,0,^D80)	;21 multiplexed PVC
  2204	002100'	200000	002403		TERCH (0,1,3,0,^D80)	;22 audio response on T-1 carrier (56000 bps)
  2205	002101'	200000	002403		TERCH (0,1,3,0,^D80)	;23 75 baud in 1200 out (VideoText)
  2206	002102'	200000	002403		TERCH (0,1,3,0,^D80)	;24   SYNC - SDLC
  2207	002103'	200000	002403		TERCH (0,1,3,0,^D80)	;25 Transaction Terminals
  2208	002104'	200000	002403		TERCH (0,1,3,0,^D80)	;26 Host originated
  2209	002105'	200000	002403		TERCH (0,1,3,0,^D80)	;27     unused
  2210	002106'	200000	002403		TERCH (0,1,3,0,^D80)	;28     unused
  2211	002107'	200000	002403		TERCH (0,1,3,0,^D80)	;29     unused
  2212	002110'	200000	002403		TERCH (0,1,3,0,^D80)	;30     unused
  2213	002111'	200000	002403		TERCH (0,1,3,0,^D80)	;31     unused
  2214								;32-63   HDX same as 0-31 but with Half Duplex
  2215
  2216			000000	TRMAUX==0	;CODE FOR AUX CIRCUIT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 42
SCNSER.MAC	25-NOV-87 19:52		HERE ON IMAGE MODE IN DEFERRED ECHO

  2217				SUBTTL	HERE ON IMAGE MODE IN DEFERRED ECHO
  2218
  2219	002112'	660400	000400	IMGDEF:	TRO T3,400	;FLAG AS IMAGE CHARACTER
  2220	002113'	201300	000002		MOVEI T1,IMGDIM
  2221	002114'	137300	000170'		DPB T1,LDPTIM	;RESET INPUT TIMER
  2222	002115'	260040	001641'		PUSHJ P,RCVCHR	;GET CHR INTO BUFFER
  2223	002116'	263040	000000		 POPJ P,
  2224	002117'	260040	006352'		PUSHJ P,IMGCNT	;COUNT. IF T3 = IMAGE BREAK, T4 := TIWKC
  2225	002120'	301440	000110	DEFCHR:	CAIL T4,TIWKC	;IF IT'S A LINE'S WORTH,
  2226	002121'	260040	015250'	DEFBRK:	PUSHJ P,LINTRP	;SET LINE TRAP BITS
  2227	002122'	350005	000014	DEFNBK:	AOS LDBECC(U)
  2228	002123'	350001	000000		AOS (P)
  2229	002124'	263040	000000		POPJ P,		;SKIP-RETURN TO START ECHOING
  2230
  2231				;HERE ON IMAGE MODE, REMOTE ECHO, BREAK ON ALL CHRS
  2232
  2233	002125'	660400	000400	IMGRMA:	TRO T3,400
  2234	002126'	201300	000002		MOVEI T1,IMGDIM
  2235	002127'	137300	000170'		DPB T1,LDPTIM
  2236	002130'	260040	001641'		PUSHJ P,RCVCHR
  2237	002131'	263040	000000		 POPJ P,
  2238	002132'	260040	006364'		PUSHJ P,IMGCHG	;CHARGE FOR AN IMAGE BREAK CHR
  2239	002133'	260040	005750'		PUSHJ P,USRWAK	;WAKE JOB IF ASLEEP
  2240	002134'	135300	000177'		LDB T1,LDPIMB
  2241	002135'	312300	000010		CAME T1,T3	;IF IT'S THE IMAGE BREAK CHARACTER,
  2242	002136'	301440	000110		CAIL T4,TIWKC	;OR IF THERE'S A LINEFULL,
  2243	002137'	260040	015250'		 PUSHJ P,LINTRP	;  SET TRAP BITS
  2244	002140'	254000	002153'		JRST IMGRM1
  2245
  2246				;HERE ON IMAGE MODE, REMOTE ECHO, NOT BREAK ON ALL
  2247
  2248	002141'	660400	000400	IMGRMT:	TRO T3,400
  2249	002142'	201300	000002		MOVEI T1,IMGDIM
  2250	002143'	137300	000170'		DPB T1,LDPTIM
  2251	002144'	260040	001641'		PUSHJ P,RCVCHR
  2252	002145'	263040	000000		 POPJ P,
  2253	002146'	260040	006352'		PUSHJ P,IMGCNT	;COUNT. IF T3 = IMAGE BREAK CHAR, T4 := TIWKC
  2254	002147'	305440	000110		CAIGE T4,TIWKC	;IF IMAGE BREAK OR A LINE'S WORTH,
  2255	002150'	254000	002153'		 JRST IMGRM1
  2256	002151'	260040	005750'		PUSHJ P,USRWAK	;  WAKE UP JOB IF ASLEEP
  2257	002152'	260040	015250'		PUSHJ P,LINTRP	;  SET TRAP BITS
  2258	002153'	202345	000013	IMGRM1:	MOVEM T2,LDBECT(U)	;FIX ECHO POINTER
  2259	002154'	350005	000012		AOS LDBTIC(U)
  2260	002155'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 43
SCNSER.MAC	25-NOV-87 19:52		NORMAL CHR DEF ECHO

  2261				SUBTTL	NORMAL CHR DEF ECHO
  2262
  2263	002156'	260040	001641'	IACT1:	PUSHJ P,RCVCHR
  2264	002157'	263040	000000		 POPJ P,
  2265	002160'	254000	002120'		JRST DEFCHR
  2266
  2267				;BREAK CHR DEF ECHO
  2268
  2269	002161'	260040	001641'	IACT2:	PUSHJ P,RCVCHR
  2270	002162'	263040	000000		 POPJ P,
  2271	002163'	205300	000001		MOVSI T1,1
  2272	002164'	272305	000015		ADDM T1,LDBBKC(U)	;RECODR BREAK CHR
  2273	002165'	402005	000007	IACT2A:	SETZM LDBBKI(U)		;RESET ^U POINTERS
  2274	002166'	202345	000006		MOVEM T2,LDBBKP(U)
  2275	002167'	254000	002121'		JRST DEFBRK
  2276
  2277				;BREAK2 CHR DEF ECHO, NOT BREAK2 MODE
  2278
  2279	002170'	260040	001641'	IACT3:	PUSHJ P,RCVCHR
  2280	002171'	263040	000000		 POPJ P,
  2281	002172'	205300	000001		MOVSI T1,1
  2282	002173'	272305	000007		ADDM T1,LDBBKI(U)
  2283	002174'	272305	000016		ADDM T1,LDBBK2(U)	;COUNT BREAK2 AND IN ^U INFO
  2284	002175'	254000	002120'		JRST DEFCHR
  2285
  2286				;BREAK2 CHR DEF ECHO, BREAK2 MODE OR BREAK ON ALL AND BREAK2
  2287
  2288	002176'	260040	001641'	IACT4:	PUSHJ P,RCVCHR
  2289	002177'	263040	000000		 POPJ P,
  2290	002200'	205300	000001		MOVSI T1,1
  2291	002201'	272305	000016		ADDM T1,LDBBK2(U)	;RECORD BREAK2
  2292	002202'	254000	002165'		JRST IACT2A		;GO RESET ^U POINTER
  2293
  2294				;NORMAL CHR, RMT ECHO, BREAK ON ALL
  2295
  2296	002203'	260040	001641'	IACT5:	PUSHJ P,RCVCHR
  2297	002204'	263040	000000		 POPJ P,
  2298	002205'	301440	000110	IACT5A:	CAIL T4,TIWKC
  2299	002206'	254000	002234'		 JRST IAC11B
  2300	002207'	254000	002235'		JRST IAC11C
  2301
  2302				;BREAK CHR, RMT ECHO, ANY BREAK MODE
  2303
  2304	002210'	260040	001641'	IACT6:	PUSHJ P,RCVCHR
  2305	002211'	263040	000000		 POPJ P,
  2306	002212'	350005	000015		AOS LDBBKC(U)	;COUNT BREAK
  2307	002213'	254000	002225'		JRST IAC10A
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 44
SCNSER.MAC	25-NOV-87 19:52		BREAK2 CHR, RMT ECHO, BREAK ON ALL, NOT BREAK2

  2308				SUBTTL	BREAK2 CHR, RMT ECHO, BREAK ON ALL, NOT BREAK2
  2309
  2310	002214'	260040	001641'	IACT7:	PUSHJ P,RCVCHR
  2311	002215'	263040	000000		 POPJ P,
  2312	002216'	350005	000016		AOS LDBBK2(U)	;COUNT BREAK2
  2313	002217'	205300	000001		MOVSI T1,1
  2314	002220'	272305	000007		ADDM T1,LDBBKI(U)	;AND IN ^U INFO
  2315	002221'	254000	002205'		JRST IACT5A
  2316
  2317				;BREAK2 CHR, RMT ECHO, BREAK2 OR BREAK ALL AND BREAK2
  2318
  2319	002222'	260040	001641'	IACT10:	PUSHJ P,RCVCHR
  2320	002223'	263040	000000		 POPJ P,
  2321	002224'	350005	000016		AOS LDBBK2(U)
  2322	002225'	402005	000007	IAC10A:	SETZM LDBBKI(U)
  2323	002226'	202345	000006		MOVEM T2,LDBBKP(U)
  2324	002227'	254000	002234'		JRST IAC11B
  2325
  2326				;BREAK CHR, RMT ECHO, BREAK OR BREAK2 MODE
  2327
  2328	002230'	260040	001641'	IACT11:	PUSHJ P,RCVCHR
  2329	002231'	263040	000000		 POPJ P,
  2330	002232'	305440	000110	IAC11A:	CAIGE T4,TIWKC	;COUNT BIG ENOUGH?
  2331	002233'	254000	002236'		 JRST IAC11D	;NO
  2332	002234'	260040	015250'	IAC11B:	PUSHJ P,LINTRP
  2333	002235'	260040	005750'	IAC11C:	PUSHJ P,USRWAK
  2334	002236'	202345	000013	IAC11D:	MOVEM T2,LDBECT(U)
  2335	002237'	350005	000012		AOS LDBTIC(U)
  2336	002240'	135300	000301'		LDB T1,CHPECH	;GET THE ECHO TYPE FIELD
  2337	002241'	256006	002257'		XCT RMTECT(T1)
  2338					PFALL RMTCNT	;NOW FALL INTO THE REMOTE ECHO CODE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 45
SCNSER.MAC	25-NOV-87 19:52		REMOTE ECHO CODE

  2339				SUBTTL	REMOTE ECHO CODE
  2340
  2341	002242'	271440	000001	RMTCNT:	ADDI T4,1	;SEVERAL JUST LDB T4,LDPPOS
  2342	002243'	606440	000400		TRNN T4,400	;TOO BIG?
  2343	002244'	137440	000171'		 DPB T4,LDPPOS	;NO RESET
  2344	002245'	603240	000006		TLNE U,LDLLCP!LDLPTP ;LOCAL COPY OR TAPE
  2345	002246'	263040	000000		 POPJ P,	;NEVER A FREE RETURN FOR THEM
  2346	002247'	135300	000164'		LDB T1,LDPWID
  2347	002250'	607240	000200		TLNN U,LDLNFC	;IF NO FREE RETURN WANTED
  2348	002251'	317440	000006		CAMG T4,T1	;OR NOT ENOUGH CHRS
  2349	002252'	263040	000000		 POPJ P,		;FINISHED
  2350	002253'	201300	000000	RMTECR:	MOVEI T1,0
  2351	002254'	137300	000171'		DPB T1,LDPPOS	;RESET POSITION TO 0
  2352	002255'	200440	005505'		MOVE T4,CRPTR
  2353	002256'	324740	002433'		PJRST RUBSTR	;PUT INTO "RUBOUT" STRING
  2354
  2355	002257'	254000	002264'	RMTECT:	JRST RMTSPA	;0 SPECIAL ACTION FOR THESE
  2356	002260'	135440	000171'		LDB T4,LDPPOS	;1 COUNT
  2357	002261'	263040	000000		POPJ P,		;2 DO NOT COUNT THIS ONE
  2358	002262'	263040	000000		POPJ P,		;3 "
  2359	002263'	135440	000171'		LDB T4,LDPPOS	;4 COUNT
  2360
  2361	002264'	135300	000161'	RMTSPA:	LDB T1,LDPMOD	;GET THE MODE WE ARE IN
  2362	002265'	135340	000304'		LDB T2,CHPSPE	;ECHO SPECIAL ACTION TYPE
  2363	002266'	256026	002267'		XCT @RMTSPT(T1)
  2364
  2365	002267'	256007	002273'	RMTSPT:	XCT RMTS10(T2)
  2366	002270'	256007	002305'		XCT RMTS94(T2)
  2367	002271'	256007	002305'		XCT RMTS94(T2)
  2368	002272'	256007	002273'		XCT RMTS10(T2)	;10 AND SUDS SAME
  2369
  2370	002273'	254000	002341'	RMTS10:	JRST RMTEXC	;^C ECHO ^C RETURN
  2371	002274'	254000	002336'		JRST RMTCR	;RETURN
  2372	002275'	254000	002345'		JRST RMTEXU	;^U  ECHO ^U
  2373	002276'	254000	002374'		JRST RMTTAB	;TAB
  2374	002277'	254000	002325'		JRST RMTALT	;ALTMODE POSSIBLE $ ECHO
  2375	002300'	254000	002360'		JRST RMTVT	;V. TAB
  2376	002301'	254000	002366'		JRST RMTFF	;FF
  2377	002302'	254000	002341'		JRST RMTEXC	;^Z  ECHO ^Z RETURN
  2378	002303'	254000	002323'		JRST RMTAL1	;175-176 POSSIBLE ALTMODE
  2379	002304'	254000	002415'		JRST RMTBSP	;BACKSPACE
  2380	002305'	263040	000000	RMTS94:	POPJ P,		;^C
  2381	002306'	254000	002336'		JRST RMTCR	;RETURN
  2382	002307'	263040	000000		POPJ P,		;^U
  2383	002310'	254000	002374'		JRST RMTTAB	;TAB
  2384	002311'	263040	000000		POPJ P,		;ALTMODE
  2385	002312'	254000	002360'		JRST RMTVT	;V. TAB
  2386	002313'	254000	002366'		JRST RMTFF	;F.F.
  2387	002314'	263040	000000		POPJ P,		;^Z
  2388	002315'	254000	002317'		JRST RMTPAT	;175-176 POSSIBLE ALTMODE
  2389	002316'	254000	002415'		JRST RMTBSP	;BACKSPACE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 46
SCNSER.MAC	25-NOV-87 19:52		REMOTE ECHO CODE

  2390	002317'	603240	000020	RMTPAT:	TLNE U,LDLLCT
  2391	002320'	263040	000000		POPJ P,		;ALTMODE, IGNORE
  2392	002321'	135440	000171'	RMTCN1:	LDB T4,LDPPOS
  2393	002322'	254000	002242'		JRST RMTCNT	;ASSUME PRINTING CHR
  2394
  2395	002323'	607240	000020	RMTAL1:	TLNN U,LDLLCT
  2396	002324'	254000	002321'		JRST RMTCN1	;ASSUME PRINTING CHR
  2397	002325'	603240	000006	RMTALT:	TLNE U,LDLPTP!LDLLCP	;NOTHING FOR THESE NUTS
  2398	002326'	263040	000000		POPJ P,
  2399	002327'	205400	020000		MOVSI T3,LXLDLR
  2400	002330'	612405	000032		TDNE T3,LDBDCX(U) ;IF USER SUPPRESSING $ ECHO
  2401	002331'	603240	020000		TLNE U,LDLCOM	;OR WE'RE AT COMMAND LEVEL
  2402	002332'	334000	000000		SKIPA		;ECHO A $
  2403	002333'	263040	000000		POPJ P,
  2404	002334'	201400	000044		MOVEI T3,"$"
  2405	002335'	254000	002353'		JRST RMTRUB	;PUT IN RBS STRING
  2406
  2407	002336'	201300	000000	RMTCR:	MOVEI T1,0
  2408	002337'	137300	000171'		DPB T1,LDPPOS
  2409	002340'	263040	000000		POPJ P,		;RETURN, JUST SET POSITION TO 0
  2410
  2411	002341'	603240	000006	RMTEXC:	TLNE U,LDLLCP!LDLPTP	;NOTHING FOR THESE NUTS
  2412	002342'	263040	000000		POPJ P,		;NOTHING WE CN DO
  2413	002343'	260040	002347'		PUSHJ P,RMTEU1	;ECHO THE ^X
  2414	002344'	254000	002253'		JRST RMTECR	;AND THE RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 47
SCNSER.MAC	25-NOV-87 19:52		REMOTE ECHO CODE

  2415	002345'	603240	000006	RMTEXU:	TLNE	U,LDLLCP!LDLPTP	;NOTHING FOR THESE NUTS
  2416	002346'	263040	000000		POPJ	P,
  2417	002347'	201400	000136	RMTEU1:	MOVEI	T3,"^"
  2418	002350'	260040	002416'		PUSHJ	P,ENTRUB
  2419	002351'	135405	000013		LDB	T3,LDBECT(U)	;GET BACK CHR
  2420	002352'	660400	000100		TRO	T3,100
  2421	002353'	260040	002416'	RMTRUB:	PUSHJ	P,ENTRUB
  2422	002354'	201300	000001		MOVEI	T1,1
  2423	002355'	137300	000072'		DPB	T1,LOPRUB	;SET SEND-RUBOUT-CHARACTERS
  2424	002356'	137305	000002		DPB	T1,LDBOPB(U)	;AND NEED-OUTPUT
  2425	002357'	263040	000000		POPJ	P,
  2426
  2427	002360'	205440	020000	RMTVT:	MOVSI	T4,L2LNTB
  2428	002361'	616445	000027		TDNN	T4,LDBBYT(U)		; NO VT ECHO??
  2429	002362'	603240	000007		TLNE	U,LDLLCP!LDLPTP!LDLFRM	; DONE BY TERMINAL?
  2430	002363'	263040	000000		POPJ	P,			; THEN NO FILLERS
  2431	002364'	200440	005523'		MOVE	T4,VTFLP
  2432	002365'	324740	002433'		PJRST	RUBSTR			;GO
  2433
  2434	002366'	205440	020000	RMTFF:	MOVSI	T4,L2LNTB
  2435	002367'	616445	000027		TDNN	T4,LDBBYT(U)		; NO FF ECHO??
  2436	002370'	603240	000007		TLNE	U,LDLLCP!LDLPTP!LDLFRM	; DONE BY TERMINAL?
  2437	002371'	263040	000000		 POPJ	P,			; THEN NO FILLERS
  2438	002372'	200440	005520'		MOVE	T4,FFFLP
  2439	002373'	324740	002433'		PJRST	RUBSTR
  2440
  2441	002374'	205440	020000	RMTTAB:	MOVSI	T4,L2LNTB	;SEE IF WE SHOULD JUST IGNORE
  2442	002375'	612445	000027		TDNE	T4,LDBBYT(U)
  2443	002376'	603240	020000		TLNE	U,LDLCOM
  2444	002377'	334000	000000		 SKIPA			;TABS AS USUAL IN COMMAND MODE
  2445	002400'	263040	000000		  POPJ	P,		;YES, DO NOTHING
  2446	002401'	135440	000171'		LDB	T4,LDPPOS
  2447	002402'	603240	000016		TLNE	U,LDLLCP!LDLTAB!LDLPTP
  2448	002403'	254000	002407'		 JRST	RMTTB1		;MUST ADJUST POSITION BUT NO SPACES
  2449	002404'	405440	000007		ANDI	T4,7
  2450	002405'	200451	005555'		MOVE	T4,TABPTR(T4)
  2451	002406'	324740	002433'		PJRST	RUBSTR		;OUT OF SPACES ADJUSTS POS
  2452
  2453	002407'	200300	000011	RMTTB1:	MOVE	T1,T4		;SAVE SIZE
  2454	002410'	660440	000007		TRO	T4,7
  2455	002411'	271440	000001		ADDI	T4,1
  2456	002412'	606440	000400		TRNN	T4,400
  2457	002413'	137440	000171'		 DPB	T4,LDPPOS	;PUT BACK IF NOT OUT OF RANGE
  2458	002414'	263040	000000		POPJ	P,		;FINISHED
  2459
  2460	002415'	324740	005452'	RMTBSP:	PJRST	SPOBSP	;UPDATE CHAR COLUMN COUNTER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 48
SCNSER.MAC	25-NOV-87 19:52		SOME ROUTINES TO HANDLE PUTTING THINGS IN THE RUBOUT STRING

  2461				SUBTTL	SOME ROUTINES TO HANDLE PUTTING THINGS IN THE RUBOUT STRING
  2462
  2463	002416'	336000	000000*	ENTRUB:	SKIPN	TTFREE##	;GIVE UP IF NO FREE BUFFERLETS
  2464	002417'	263040	000000		 POPJ	P,
  2465	002420'	336345	000023		SKIPN	T2,LDBRBI(U)
  2466	002421'	254000	002426'		 JRST	STRUB		;MUST SET THINGS UP
  2467	002422'	260040	006135'	STRUB1:	PUSHJ	P,TTPUTC
  2468	002423'	202345	000023		MOVEM	T2,LDBRBI(U)
  2469	002424'	350005	000025		AOS	LDBRBC(U)
  2470	002425'	263040	000000		POPJ	P,
  2471
  2472	002426'	260040	006173'	STRUB:	PUSHJ	P,GETCHK
  2473	002427'	202345	000023		MOVEM	T2,LDBRBI(U)
  2474	002430'	202345	000024		MOVEM	T2,LDBRBO(U)
  2475	002431'	402005	000025		SETZM	LDBRBC(U)
  2476	002432'	254000	002422'		JRST	STRUB1
  2477
  2478				;PUT IN A WHOLE STRING, BYTE POINTER IN T4
  2479
  2480	002433'	134400	000011	RUBSTR:	ILDB	T3,T4
  2481					JUMPE	T3, [		;IF WE'RE DONE WITH THE STRING,
  2482						MOVEI	T1,1
  2483						DPB	T1,LOPRUB	;SET SEND-RUBOUT-CHARACTERS
  2484						DPB	T1,LDBOPB(U)	;AND NEED-OUTPUT
  2485						POPJ	P,
  2486	002434'	322400	016217'		]
  2487	002435'	260040	002416'		PUSHJ	P,ENTRUB
  2488	002436'	254000	002433'		JRST	RUBSTR
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 49
SCNSER.MAC	25-NOV-87 19:52		BREAK2 CHR, RMT ECHO, BREAK MODE

  2489				SUBTTL	BREAK2 CHR, RMT ECHO, BREAK MODE
  2490
  2491	002437'	260040	001641'	IACT12:	PUSHJ P,RCVCHR
  2492	002440'	263040	000000		 POPJ P,
  2493	002441'	205300	000001		MOVSI T1,1
  2494	002442'	272305	000007		ADDM T1,LDBBKI(U)	;COUNT BREAK2
  2495	002443'	350005	000016		AOS LDBBK2(U)
  2496	002444'	254000	002232'		JRST IAC11A
  2497
  2498				;NORMAL CHARACTER, COMMAND MODE, REMOTE ECHO
  2499
  2500	002445'	260040	001641'	IACT13:	PUSHJ P,RCVCHR
  2501	002446'	263040	000000		 POPJ P,
  2502	002447'	254000	002463'		JRST IAC16B
  2503
  2504				;BREAK CHR, COMMAND MODE, REMOTE ECHO
  2505
  2506	002450'	260040	001641'	IACT14:	PUSHJ P,RCVCHR
  2507	002451'	263040	000000		 POPJ P,
  2508	002452'	350005	000015		AOS LDBBKC(U)
  2509	002453'	202345	000006		MOVEM T2,LDBBKP(U)
  2510	002454'	402005	000007		SETZM LDBBKI(U)	;RESET ^U POINTER
  2511	002455'	254000	002464'		JRST IAC16C
  2512
  2513				;BREAK2 CHR, COMMAND MODE, REMOTE ECHO, NOT BREAK2 MODE
  2514
  2515	002456'	260040	001641'	IACT15:	PUSHJ P,RCVCHR
  2516	002457'	263040	000000		 POPJ P,
  2517	002460'	205300	000001		MOVSI T1,1
  2518	002461'	272305	000007		ADDM T1,LDBBKI(U)
  2519	002462'	350005	000016		AOS LDBBK2(U)
  2520	002463'	301440	000110	IAC16B:	CAIL T4,TIWKC
  2521	002464'	260040	013265'	IAC16C:	 PUSHJ P,CMDWAK
  2522	002465'	254000	002236'		JRST IAC11D
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 50
SCNSER.MAC	25-NOV-87 19:52		BREAK2 CHR, COMMAND MODE, DEF ECHO, NOT BREAK2 MODE

  2523				SUBTTL	BREAK2 CHR, COMMAND MODE, DEF ECHO, NOT BREAK2 MODE
  2524
  2525	002466'	260040	001641'	IACT17:	PUSHJ P,RCVCHR
  2526	002467'	263040	000000		 POPJ P,
  2527	002470'	205300	000001		MOVSI T1,1
  2528	002471'	272305	000007		ADDM T1,LDBBKI(U)
  2529	002472'	272305	000016		ADDM T1,LDBBK2(U)	;COUNT BREAK2
  2530	002473'	254000	002122'		JRST DEFNBK
  2531
  2532				;BREAK2 CHR, COMMAND MODE, DEF ECHO, BREAK2 MODE
  2533
  2534
  2535				;NORMAL CHR, COMMAND MODE, DEF ECHO
  2536
  2537	002474'	260040	001641'	IACT21:	PUSHJ P,RCVCHR
  2538	002475'	263040	000000		 POPJ P,
  2539	002476'	254000	002122'		JRST DEFNBK
  2540
  2541				;BREAK CHR, COMMAND MODE, DEF ECHO
  2542
  2543	002477'	260040	001641'	IACT22:	PUSHJ P,RCVCHR
  2544	002500'	263040	000000		 POPJ P,
  2545	002501'	205300	000001		MOVSI T1,1
  2546	002502'	272305	000015		ADDM T1,LDBBKC(U)
  2547	002503'	402005	000007		SETZM LDBBKI(U)
  2548	002504'	202345	000006		MOVEM T2,LDBBKP(U)
  2549	002505'	254000	002122'		JRST DEFNBK
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 51
SCNSER.MAC	25-NOV-87 19:52		SPECIAL ACTION CHRACTER, ALMOST ANY MODE

  2550				SUBTTL	SPECIAL ACTION CHRACTER, ALMOST ANY MODE
  2551
  2552	002506'	135300	000161'	IACT0:	LDB T1,LDPMOD
  2553	002507'	135340	000303'		LDB T2,CHPSPI	;GET SPECIAL ACTION CODE
  2554	002510'	256026	002511'		XCT @INPACT(T1)
  2555
  2556	002511'	256007	002515'	INPACT:	XCT INPA10(T2)
  2557	002512'	256007	002536'		XCT INPA94(T2)
  2558	002513'	256007	002536'		XCT INPA94(T2)
  2559	002514'	256007	002515'		XCT INPA10(T2)
  2560
  2561	002515'	263040	000000	INPA10:	POPJ P,		;NULL, IGNORE
  2562	002516'	254000	003067'		JRST INPESC	;ESCAPE (^C)
  2563	002517'	254000	002603'		JRST INPRET	;RETURN
  2564	002520'	254000	002621'		JRST INPGOB	;OUTPUT SUPPRESS (^O)
  2565	002521'	254000	002557'		JRST INPBRK	;PUT IN AS A BREAK CHR (^Q)
  2566	002522'	254000	002635'		JRST INPDLN	;DELETE LINE (^U)
  2567	002523'	254000	002561'		JRST INPTAB	;TAB (DECIDE IF BREAK OR BREAK2)
  2568	002524'	254000	002557'		JRST INPBRK	;ALTMODE
  2569	002525'	254000	002557'		JRST INPBRK	;JUST A BREAK CHR ^^
  2570	002526'	254000	002557'		JRST INPBRK	;^_
  2571	002527'	254000	002710'		JRST INPRUB	;RUBOUT
  2572	002530'	254000	002557'		JRST INPBRK	;^A
  2573	002531'	254000	002557'		JRST INPBRK	;POSSIBLE ALTMODE
  2574	002532'	254000	002614'		JRST INPBK2	;_
  2575	002533'	254000	002557'		JRST INPBRK	;^\
  2576	002534'	254000	002566'		JRST INPBSP	;BACKSPACE
  2577	002535'	254000	003062'		JRST INPSTA	;^T
  2578
  2579	002536'	263040	000000	INPA94:	POPJ P,		;NULL, IGNORE
  2580	002537'	254000	002557'		JRST INPBRK	;^C
  2581	002540'	254000	002603'		JRST INPRET	;RETURN
  2582	002541'	254000	002557'		JRST INPBRK	;^O, BREAK CHR
  2583	002542'	254000	002635'		JRST INPDLN	;DELETE LINE (^Q)
  2584	002543'	254000	002557'		JRST INPBRK	;^U
  2585	002544'	254000	002561'		JRST INPTAB	;TAB
  2586	002545'	254000	003067'		JRST INPESC	;ALTMODE (ESCAPE CHR)
  2587	002546'	254000	002612'		JRST INPCLD	;CONVERT TO ^D (^^)
  2588	002547'	254000	003067'		JRST INPESC	;^_
  2589	002550'	263040	000000		POPJ P,		;RUBOUT, IGNORE
  2590	002551'	254000	002712'		JRST INPRB1	;^A, DELETE CHR
  2591	002552'	254000	002616'		JRST INPAL1	;POSSIBLE ALTMODE
  2592	002553'	254000	002614'		JRST INPBK2	;_
  2593	002554'	254000	002621'		JRST INPGOB	;^\
  2594	002555'	254000	002570'		JRST INPBS1	;BACKSPACE
  2595	002556'	254000	002557'		JRST INPBRK	;^T
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 52
SCNSER.MAC	25-NOV-87 19:52		JUST SET AS A BREAK CHARACTER (MODE 2) AND GO

  2596				SUBTTL	JUST SET AS A BREAK CHARACTER (MODE 2) AND GO
  2597
  2598	002557'	201340	000002	INPBRK:	MOVEI T2,2
  2599	002560'	254000	001603'		JRST MOVCH1	;P2 (LINE MODE) STILL SETUP
  2600
  2601				;DECIDE IF TAB IS A BREAK OR BREAK2 CHARACTER
  2602
  2603	002561'	201340	000003	INPTAB:	MOVEI T2,3	;NORMALLY BREAK2
  2604	002562'	205300	100000		MOVSI T1,L2LTBK
  2605	002563'	612305	000027		TDNE T1,LDBBYT(U)
  2606	002564'	201340	000002		MOVEI T2,2	;BIT IS ON, AS A BREAK CHARACTER
  2607	002565'	254000	001603'		JRST MOVCH1
  2608
  2609				;DECIDE IF BACKSPACE IS A BREAK OR BREAK2 CHARACTER
  2610
  2611	002566'	201340	002710'	INPBSP:	MOVEI T2,INPRUB
  2612	002567'	334000	000000		SKIPA
  2613	002570'	201340	002712'	INPBS1:	MOVEI T2,INPRB1
  2614	002571'	200305	000032		MOVE T1,LDBDCX(U)
  2615	002572'	603300	100000		TLNE T1,LXLBSD	;DELETE ON BACKSPACE?
  2616	002573'	254007	000000		  JRST	(T2)	; YES
  2617	002574'	201340	000002		MOVEI T2,2	;NORMALLY BREAK
  2618	002575'	205300	040000		MOVSI T1,L2LBBP
  2619	002576'	612305	000027		TDNE T1,LDBBYT(U)
  2620	002577'	201340	000003		MOVEI T2,3	;BIT IS ON, AS A BREAK2 CHARACTER
  2621	002600'	254000	001603'		JRST MOVCH1
  2622
  2623				;CONVERT ^A INTO _ FOR TYMEX2 MDDE
  2624
  2625	002601'	201400	000137	INPTCA:	MOVEI T3,"_"
  2626	002602'	254000	002614'		JRST INPBK2
  2627
  2628				;RETURN HANDLER
  2629
  2630	002603'	201340	000001	INPRET:	MOVEI T2,1	;GET SET TO TREAT AS TYPE 1(NORMAL) CHR
  2631	002604'	603240	000002		TLNE U,LDLPTP	;IF IN PAPER TAPE MODE
  2632	002605'	254000	001603'		JRST MOVCH1	;JUST PUT IN THE CHR
  2633	002606'	260040	001603'		PUSHJ P,MOVCH1	;ELSE PUT IT IN
  2634	002607'	255000	000000		 JFCL		;IGNORE SKIP-NON SKIP
  2635	002610'	201400	000012		MOVEI T3,12
  2636	002611'	254000	001576'		JRST MOVCHR	;AND THEN PUT IN A LINE FEED
  2637
  2638				;HANDLE ^^ IN 940 MODE (CONVERT TO ^D)
  2639
  2640	002612'	201400	000004	INPCLD:	MOVEI T3,4
  2641	002613'	254000	001600'		JRST MOVCH2
  2642
  2643	002614'	201340	000003	INPBK2:	MOVEI T2,3
  2644	002615'	254000	001603'		JRST MOVCH1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 53
SCNSER.MAC	25-NOV-87 19:52		POSSIBLE ALTMODE (175-176) IN 940 MODE

  2645				SUBTTL	POSSIBLE ALTMODE (175-176) IN 940 MODE
  2646
  2647	002616'	607240	000020	INPAL1:	TLNN U,LDLLCT
  2648	002617'	254000	002557'		JRST INPBRK	;IN LOWER CASE MODE, JUST CALL BREAK
  2649	002620'	254000	003067'		JRST INPESC
  2650
  2651				;^O IN PDP-10 MDDE
  2652
  2653	002621'	205300	000400	INPGOB:	MOVSI T1,LDLOSU
  2654	002622'	432305	000031		XORM T1,LDBDCH(U)	;CHANGE FLAG
  2655	002623'	260040	006234'		PUSHJ P,TSETBO		;CLEAR OUTPUT BUFFER, set flag to send TYPGOB
  2656	002624'	135440	000161'		LDB T4,LDPMOD
  2657	002625'	200471	002650'		MOVE T4,@IGOBEC(T4)
  2658	002626'	603240	000004	INPOTP:	TLNE U,LDLLCP
  2659	002627'	263040	000000		POPJ P,			;BUT NEVER ANYTHING TO 2741
  2660	002630'	205300	004000		MOVSI T1,L2LDEL
  2661	002631'	616305	000027		TDNN T1,LDBBYT(U)	;ALREADY IN \'S
  2662	002632'	133000	000011		IBP T4			;NO, SKIP \ IN OUTPUT STRING
  2663	002633'	412305	000027		ANDCAM T1,LDBBYT(U)	;NOT THERE NOW IN ANY CASE
  2664	002634'	324740	002433'		PJRST RUBSTR
  2665
  2666				;^U IN PDP-10 OR ^Q IN 940
  2667
  2668	002635'	260040	006022'	INPDLN:	PUSHJ P,FULLCQ		;COMMAND OR FULL CHARACTER SET?
  2669	002636'	254000	002557'		 JRST INPBRK		;YES, BREAK CHARACTER
  2670	002637'	260040	002654'		PUSHJ P,RIDLIN		;THIS DOES ALL THE WORK
  2671	002640'	263040	000000		 POPJ P,		;NOTHING TO ECHO
  2672	002641'	135300	000161'		LDB T1,LDPMOD		;GET MODE WE ARE IN
  2673	002642'	200466	002644'		MOVE T4,@IDLNEC(T1)	;AND GET APPROPRIATE ECHO STRING
  2674	002643'	324740	002626'		PJRST INPOTP
  2675
  2676	002644'	000000	005506'	IDLNEC:	CUPTR
  2677	002645'	000000	005511'		UPARPT
  2678	002646'	000000	005511'		UPARPT
  2679	002647'	000000	005506'		CUPTR
  2680
  2681	002650'	000000	005513'	IGOBEC:	COPTR
  2682	002651'	000000	005516'		FLLBSC
  2683	002652'	000000	005516'		FLLBSC
  2684	002653'	000000	005513'		COPTR
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 54
SCNSER.MAC	25-NOV-87 19:52		GET RID OF A LINE OF TEXT. ADJUST ALL POINTERS

  2685				SUBTTL	GET RID OF A LINE OF TEXT. ADJUST ALL POINTERS
  2686
  2687	002654'	336305	000006	RIDLIN:	SKIPN T1,LDBBKP(U)	;IS THERE A ^U POINTER
  2688	002655'	324740	002704'		PJRST RIDLN3		;NO, DELETE ALL FROM BUFFER
  2689	002656'	202305	000010		MOVEM T1,LDBTIP(U)
  2690	002657'	550345	000007		HRRZ T2,LDBBKI(U)	;NUMBER OF CHRS SINCE ^U POINTER
  2691	002660'	213000	000007		MOVNS T2
  2692	002661'	270345	000014		ADD T2,LDBECC(U)
  2693	002662'	325340	002667'		JUMPGE T2,RIDLN1	;NONE ECHOED
  2694	002663'	272345	000012		ADDM T2,LDBTIC(U)	;REMOVE SOME FROM INPUT
  2695	002664'	201340	000000		MOVEI T2,0
  2696	002665'	202305	000013		MOVEM T1,LDBECT(U)	;RESET ECHO POINTER
  2697	002666'	350001	000000		AOS (P)			;SKIP RETURN FOR ECHO ^U
  2698	002667'	202345	000014	RIDLN1:	MOVEM T2,LDBECC(U)
  2699	002670'	554345	000007		HLRZ T2,LDBBKI(U)	;GET NUMBER OF BREAK2 CHRS
  2700	002671'	402005	000007		SETZM LDBBKI(U)		;AND GET RID OF OLD COUNTS
  2701	002672'	213000	000007		MOVNS T2
  2702	002673'	517000	000007		HRLZS T2
  2703	002674'	270345	000016		ADD T2,LDBBK2(U)	;FIX NUMBER NOT ECHOED
  2704	002675'	325340	002702'		JUMPGE T2,RIDLN2	;ALL IN NOT ECHOED
  2705	002676'	567000	000007		HLROS T2
  2706	002677'	270345	000016		ADD T2,LDBBK2(U)	;FIX NUMBER ECHOED
  2707	002700'	552345	000016		HRRZM T2,LDBBK2(U)
  2708	002701'	263040	000000		POPJ P,
  2709
  2710	002702'	202345	000016	RIDLN2:	MOVEM T2,LDBBK2(U)
  2711	002703'	263040	000000		POPJ P,
  2712
  2713	002704'	332005	000014	RIDLN3:	SKIPE LDBECC(U)		;ALSO ECHO IF NOT CHRS AT ALL
  2714	002705'	332005	000012		SKIPE LDBTIC(U)		;ANY CHARACTERS ECHOED?
  2715	002706'	350001	000000		AOS (P)			;SET SKIP RETURN
  2716	002707'	324740	006203'		PJRST TSETBI
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 55
SCNSER.MAC	25-NOV-87 19:52		RUBOUT FROM PDP-10 MODE. 940 ^A JUST DOES NOT CHECK XON

  2717				SUBTTL	RUBOUT FROM PDP-10 MODE. 940 ^A JUST DOES NOT CHECK XON
  2718
  2719	002710'	603240	000002	INPRUB:	TLNE U,LDLPTP
  2720	002711'	263040	000000		POPJ P,			;IGNORE RUBOUTS IN XON MODE
  2721	002712'	260040	006022'	INPRB1:	PUSHJ P,FULLCQ
  2722	002713'	254000	002557'		 JRST INPBRK		;JUST CALL IT A BREAK CHR
  2723	002714'	260040	002765'		PUSHJ P,INPRBC		;COMMON RUBOUT ROUTINE
  2724	002715'	254000	003060'		 JRST INPRB2	;NO CHRS, GIVE RETURN
  2725	002716'	263040	000000		 POPJ P,		;NOT ECHOED
  2726	002717'	201400	000134		MOVEI T3,"\"
  2727	002720'	200445	000027		MOVE	T4, LDBBYT(U)
  2728	002721'	607440	001000		TLNN	T4, L2LBSP	;BACKSPACE FOR CHAR DELETE?
  2729	002722'	254000	002740'		JRST	INPRB7		;NO
  2730	002723'	200300	015713'		MOVE	T1,INPCH
  2731	002724'	302300	000010		CAIE	T1, 10		;IS IT BACKSPACE?
  2732	002725'	306300	000210		CAIN	T1, 210
  2733	002726'	254000	002747'		JRST	INPRB9		;YES
  2734	002727'	200445	000032		MOVE	T4, LDBDCX(U)
  2735	002730'	607440	040000		TLNN	T4, LXLERA	;<BS><SP><BS> OR JUST <BS>?
  2736	002731'	254000	002736'		JRST	INPRB6
  2737	002732'	201400	000010		MOVEI	T3, 10		;<BS>
  2738	002733'	260040	002416'		PUSHJ	P, ENTRUB
  2739	002734'	201400	000040		MOVEI	T3, 40		;<SP>
  2740	002735'	260040	002416'		PUSHJ	P, ENTRUB
  2741	002736'	201400	000010	INPRB6:	MOVEI	T3, 10		;<BS>
  2742	002737'	254000	002752'		JRST	INPRB8
  2743	002740'	667440	004000	INPRB7:	TLON T4,L2LDEL
  2744	002741'	260040	002416'		PUSHJ P,ENTRUB		;NO, ENTER
  2745	002742'	202445	000027		MOVEM T4,LDBBYT(U)	;AND MAKE SURE WE REMEMBER IT
  2746	002743'	200400	015713'		MOVE T3,INPCH
  2747	002744'	405400	000177		ANDI	T3, 177		;STRIP OFF PARITY BIT
  2748	002745'	302400	000010		CAIE	T3, 10		;IS IT BACKSPACE?
  2749	002746'	254000	002752'		JRST	INPRB8		;NO
  2750	002747'	201400	000040	INPRB9:	MOVEI	T3,40		;YES, SUBSTITUTE <SP> FOR <BS>
  2751	002750'	135300	000021'		LDB	T1, LDPECH
  2752	002751'	332000	000006		SKIPE	T1		;PRINT NOTHING IF NO REM BS ECHO
  2753	002752'	260040	002416'	INPRB8:	PUSHJ P,ENTRUB
  2754	002753'	201300	000001		MOVEI	T1,1
  2755	002754'	137300	000072'		DPB	T1,LOPRUB	;SET SEND-RUBOUT-CHARACTERS
  2756	002755'	137305	000002		DPB	T1,LDBOPB(U)	;AND NEED-OUTPUT
  2757	002756'	263040	000000		POPJ	P,
  2758
  2759				;HERE FROM _ IN TYMEX2 MODE
  2760
  2761	002757'	260040	006022'	INPRT2:	PUSHJ P,FULLCQ
  2762	002760'	254000	002614'		 JRST INPBK2	;JUST TREAT AS A CHR
  2763	002761'	260040	002765'		PUSHJ P,INPRBC
  2764	002762'	263040	000000		 POPJ P,
  2765	002763'	263040	000000		 POPJ P,
  2766	002764'	263040	000000		POPJ P,		;NEVER ANY ECHO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 56
SCNSER.MAC	25-NOV-87 19:52		RUBOUT FROM PDP-10 MODE. 940 ^A JUST DOES NOT CHECK XON

  2767	002765'	550305	000007	INPRBC:	HRRZ T1,LDBBKI(U)
  2768	002766'	322300	001743*		JUMPE T1,CPOPJ		;JUST GIVE RETURN
  2769	002767'	350001	000000		AOS (P)
  2770	002770'	135405	000010		LDB T3,LDBTIP(U)	;GET LAST CHARACTER INPUT
  2771	002771'	202400	015713'		MOVEM T3,INPCH	;AND SAVE
  2772	002772'	370005	000007		SOS LDBBKI(U)
  2773	002773'	370345	000010		SOS T2,LDBTIP(U)	;NOW REALLY BACK UP
  2774					REPEAT 2,<IBP T2>	;NOW GET READY TO ADVANCE ON PREV.
  2775	002774'	133000	000007
  2776	002775'	133000	000007
  2777	002776'	260040	006114'		PUSHJ P,TTGETC
  2778	002777'	255000	000000		 JFCL			;DO NOT CARE IF PASS OVER LINK
  2779	003000'	202345	000010		MOVEM T2,LDBTIP(U)	;THAT WAS JUST IN CASE WE BACKED OVER LINK
  2780	003001'	371005	000014		SOSL LDBECC(U)
  2781					JRST [MOVSI T4,-1	;WAITING TO BE ECHOED, FORGET IT
  2782	003002'	254000	016223'			JRST INPRB4]
  2783	003003'	402005	000014		SETZM LDBECC(U)
  2784	003004'	370005	000012		SOS LDBTIC(U)
  2785	003005'	202345	000013		MOVEM T2,LDBECT(U)	;RESET ECHO POINTER TO INPUT
  2786	003006'	607240	020000		TLNN U,LDLCOM	;IF AT COMMAND IGNORE ECHO
  2787	003007'	607240	000100		TLNN U,LDLNEC	;IF NOT ECHOING, NO ECHO
  2788	003010'	603240	000004		TLNE U,LDLLCP	;BUT NEVER ECHO LOCAL COPY
  2789	003011'	254000	003013'		JRST INPRB3		;DUMP CHR
  2790	003012'	350001	000000		AOS (P)
  2791	003013'	211440	000001	INPRB3:	MOVNI T4,1		;T4 WILL HAVE THING TO ADD TO BK2
  2792	003014'	200400	015713'	INPRB4:	MOVE T3,INPCH
  2793	003015'	620400	000200		TRZ T3,200
  2794	003016'	602400	000400		TRNE T3,400
  2795	003017'	263040	000000		POPJ P,		;IMAGE MODE CHRS NEVER COUNT
  2796	003020'	200710	000305'		MOVE P3,CHRTAB(T3)
  2797	003021'	135300	000275'		LDB T1,CHPINP
  2798	003022'	256006	003026'		XCT INPRTB(T1)		;WANT ONLY BREAK2 CHRS
  2799	003023'	205300	777777	INPRB5:	MOVSI T1,-1		;WILL HAV SOS'ED CORRECT HALF OF LDBBK2
  2800	003024'	272305	000007		ADDM T1,LDBBKI(U)
  2801	003025'	263040	000000		POPJ P,
  2802
  2803	003026'	254000	003032'	INPRTB:	JRST INPRAC	;MUST WORRY ABOUT TAB
  2804	003027'	263040	000000		POPJ P,		;NORMAL CHR
  2805	003030'	263040	000000		POPJ P,		;BREAK CHR
  2806	003031'	272445	000016		ADDM T4,LDBBK2(U) ;BREAK 2
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 57
SCNSER.MAC	25-NOV-87 19:52		RUBOUT FROM PDP-10 MODE. 940 ^A JUST DOES NOT CHECK XON

  2807	003032'	135300	000303'	INPRAC:	LDB T1,CHPSPI
  2808	003033'	256006	003040'		XCT INPRTA(T1)
  2809	003034'	612305	000027		TDNE T1,LDBBYT(U)	;HERE ONLY FOR TAB WITH T1=L2LTBK
  2810	003035'	263040	000000		POPJ P,			;TREAT AS BREAK
  2811	003036'	272445	000016	INPRA1:	ADDM T4,LDBBK2(U)
  2812	003037'	254000	003023'		JRST INPRB5
  2813
  2814	003040'			INPRTA:	REPEAT 6,<POPJ P,>
  2815	003040'	263040	000000
  2816	003041'	263040	000000
  2817	003042'	263040	000000
  2818	003043'	263040	000000
  2819	003044'	263040	000000
  2820	003045'	263040	000000
  2821	003046'	205300	100000		MOVSI T1,L2LTBK
  2822					REPEAT 6,<POPJ P,>
  2823	003047'	263040	000000
  2824	003050'	263040	000000
  2825	003051'	263040	000000
  2826	003052'	263040	000000
  2827	003053'	263040	000000
  2828	003054'	263040	000000
  2829	003055'	201300	000000		MOVEI T1,0	;_ ALWAYS BREAK2
  2830	003056'	263040	000000		POPJ P,		;^\
  2831					JRST	[MOVSI T1,L2LBBP
  2832						 TDNN T1,LDBBYT(U)	;TEST BACKSPACE BREAK FLAG
  2833						 POPJ P,		;TREAT AS BREAK
  2834	003057'	254000	016225'			 JRST INPRA1]		;TREAT AS BREAK2
  2835
  2836	003060'	200440	005516'	INPRB2:	MOVE T4,FLLBSC
  2837	003061'	254000	002626'		JRST INPOTP
  2838
  2839				;;
  2840				;; Here on ^T in PDP-10 mode, to see if it should be interpreted as
  2841				;; a .USESTAT command.
  2842				;;
  2843	003062'	205300	002000	INPSTA:	MOVSI	T1,LXLRTC
  2844	003063'	616305	000032		TDNN	T1,LDBDCX(U)	;Special ^T mode set?
  2845	003064'	254000	002557'		  JRST	INPBRK		;No, just treat as break
  2846	003065'	201300	000000*		MOVEI	T1,CMFSTA##	;Forced command code for .USESTAT
  2847	003066'	324740	013276'		PJRST	TTFORC
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 58
SCNSER.MAC	25-NOV-87 19:52		ESCAPE CHARACTER 940 IS ^_ OR POSSIBLY ALTMODE, PDP-10 IS ^C

  2848				SUBTTL	ESCAPE CHARACTER 940 IS ^_ OR POSSIBLY ALTMODE, PDP-10 IS ^C
  2849
  2850	003067'	260040	015262'	INPESC:	PUSHJ P,ESCTRP		;CHECK ESCAPE TRAP
  2851								;DOES DOUBLE RETURN
  2852								;(OUT OF INPESC) IF TRAP TAKEN
  2853	003070'	332005	000007		SKIPE LDBBKI(U)
  2854	003071'	260040	002654'		PUSHJ P,RIDLIN		;REMOVE LINE IF ANY
  2855	003072'	255000	000000		 JFCL			;NEVER ECHO ANYTHING
  2856	003073'	205300	200000		MOVSI T1,L2LCCS
  2857	003074'	616305	000027		TDNN T1,LDBBYT(U)	;SECOND?
  2858	003075'	254000	003116'		JRST INPES1		;NO, JUST STORE IT
  2859	003076'	260040	006027'		PUSHJ P,CNCCHK		;SEE IF CMD LEVEL, SLAVED, ETC.
  2860	003077'	254000	003114'		 JRST INPES0		;JUST STORE IT
  2861	003100'	260040	006203'		PUSHJ P,TSETBI		;CLEAR INPUT
  2862	003101'	260040	006234'		PUSHJ P,TSETBO		;AND OUTPUT BUFFERS (send TYPGOB)
  2863	003102'	205300	000400		MOVSI T1,LDLOSU	;SUPRESS OUTPUT (UNTIL WE HAVE HALTED)
  2864	003103'	436305	000031		IORM T1,LDBDCH(U)
  2865	003104'	500245	000031		HLL U,LDBDCH(U)	;MAKE SURE LINE KNOWS ABOUT IT
  2866	003105'	135300	000161'		LDB T1,LDPMOD
  2867	003106'	200466	003110'		MOVE T4,@INPEST(T1)	;GET CORRECT THING TO PRINT
  2868	003107'	324740	002626'		PJRST INPOTP
  2869
  2870	003110'	000000	005502'	INPEST:	CCPTR
  2871	003111'	000000	005516'		FLLBSC
  2872	003112'	000000	005516'		FLLBSC
  2873	003113'	000000	005502'		CCPTR
  2874
  2875	003114'	603240	020000	INPES0:	TLNE U,LDLCOM	;IF COMMAND MODE
  2876	003115'	260040	006234'		PUSHJ P,TSETBO	;CLEAR OUTPUT BUFFER
  2877	003116'	260040	002557'	INPES1:	PUSHJ P,INPBRK	;PUT IT IN AS A BREAK CHR
  2878	003117'	334000	000000		 SKIPA
  2879	003120'	350001	000000		AOS (P)		;TRANSFER SKIP RETURN TO US
  2880	003121'	205300	200000		MOVSI T1,L2LCCS
  2881	003122'	436305	000027		IORM T1,LDBBYT(U)	;SET FLAG
  2882	003123'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 59
SCNSER.MAC	25-NOV-87 19:52		MODE CONVERSION TABLE

  2883				SUBTTL MODE CONVERSION TABLE
  2884
  2885					DEFINE LMOD (ECH,INP)
  2886					<BYTE (29)0(3)ECH(4)INP>
  2887
  2888	003124'	000000	000051	MDFLMD:	LMOD 2,11
  2889	003125'	000000	000044		LMOD 2,4
  2890	003126'	000000	000043		LMOD 2,3
  2891	003127'	000000	000041		LMOD 2,1
  2892	003130'	000000	000070		LMOD 3,10
  2893	003131'	000000	000065		LMOD 3,5
  2894	003132'	000000	000063		LMOD 3,3
  2895	003133'	000000	000061		LMOD 3,1
  2896	003134'	000000	000026		LMOD 1,6
  2897	003135'	000000	000024		LMOD 1,4
  2898	003136'	000000	000022		LMOD 1,2
  2899	003137'	000000	000021		LMOD 1,1
  2900	003140'	000000	000027		LMOD 1,7
  2901	003141'	000000	000025		LMOD 1,5
  2902	003142'	000000	000022		LMOD 1,2
  2903	003143'	000000	000021		LMOD 1,1
  2904	003144'	000000	000012		LMOD 0,12
  2905	003145'	000000	000013		LMOD 0,13
  2906	003146'	000000	000012		LMOD 0,12
  2907	003147'	000000	000013		LMOD 0,13
  2908	003150'	000000	000012		LMOD 0,12
  2909	003151'	000000	000013		LMOD 0,13
  2910	003152'	000000	000012		LMOD 0,12
  2911	003153'	000000	000013		LMOD 0,13
  2912	003154'	000000	000012		LMOD 0,12
  2913	003155'	000000	000013		LMOD 0,13
  2914	003156'	000000	000012		LMOD 0,12
  2915	003157'	000000	000013		LMOD 0,13
  2916	003160'	000000	000012		LMOD 0,12
  2917	003161'	000000	000013		LMOD 0,13
  2918	003162'	000000	000012		LMOD 0,12
  2919	003163'	000000	000013		LMOD 0,13
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 60
SCNSER.MAC	25-NOV-87 19:52		OUTPUT DISPATCHER

  2920				SUBTTL OUTPUT DISPATCHER
  2921
  2922				;HERE AT CH7 TO SCAN LINTAB FOR PORTS NEEDING OUTPUT, SCAN
  2923				;LDBOUT FOR THOSE PORTS, AND DISPATCH TO THE APPROPRIATE
  2924				;OUTPUT ROUTINES
  2925
  2926	003164'	260040	004123'	SCNOUT:	PUSHJ	P,SETOUT	;PREPARE FOR TYMNET OUTPUT, skip if room
  2927	003165'	333000	015741'		  SKIPLE MULCNT+1	;ORING is full, how about PTYs
  2928	003166'	254000	003170'		 JRST	.+2		;Room in either ORING or PTY count
  2929	003167'	254000	003347'		JRST	FINOUT		;  DO NOTHING THIS CYCLE
  2930
  2931				    ;FIND THE NEXT PORT (IN A ROUND-ROBIN FASHION) THAT WANTS
  2932				    ;TO DO OUTPUT
  2933
  2934	003170'	331300	015714'		SKIPL	T1,LINPTR	;IF NO ROUND-ROBIN PTR EXISTS,
  2935	003171'	205300	000000*		 MOVSI	T1,NMXFLG	;  SET TO START AT PORT 0
  2936	003172'	202300	015714'	SCOLP1:	MOVEM	T1,LINPTR
  2937	003173'	336246	000000*		SKIPN	U,LINFLG(T1)	;IF NO NEED-OUTPUT BITS IN THIS WORD,
  2938	003174'	254000	003344'		 JRST	NOLIN2		;  GO ON TO THE NEXT ONE
  2939	003175'	200446	000000*		MOVE	T4,BITNTB(T1)	;T4/ PORT# CORRESPONDING TO BIT 0
  2940	003176'	243240	003200'	SCOLP:	JFFO	U,.+2		;T1/ BIT# OF FIRST. IF NONE,
  2941	003177'	254000	003344'		 JRST	NOLIN2		;  GO ON TO THE NEXT WORD
  2942	003200'	242246	000001		LSH	U,1(T1)		;GET RID OF THE BIT WE JUST FOUND
  2943	003201'	202240	015727'		MOVEM	U,LINFSV	;SAVE THE REST OF THE WORD
  2944	003202'	270300	000011		ADD	T1,T4		;T1/ PORT# FOR THE BIT WE JUST FOUND
  2945	003203'	202300	015726'		MOVEM	T1,LINPNM	;SAVE THAT TOO
  2946	003204'	200246	000737*		MOVE	U,LINTAB(T1)	;U/ LDB ADDR
  2947	003205'	500245	000031		HLL	U,LDBDCH(U)	;U/ DCH BITS,,LDB ADDR
  2948	003206'	305300	000666*		CAIGE	T1,RPORTN	;Is it one of the real ports?
  2949	003207'	254000	003242'		 JRST	SCORTY		;Yes
  2950					PFALL	SCOPTY		;No
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 61
SCNSER.MAC	25-NOV-87 19:52		OUTPUT DISPATCHER

  2951				   ;PREPARE TO DO OUTPUT ON A PSEUDO-PORT
  2952
  2953				;P035/C06 17-Nov-87 - Complain if LDLPTY is wrong and fix it.
  2954				;This bug is triggered by an incoming zap during login and prevented the
  2955				;outgoing zap from reaching the base, causing "slot out of ports".
  2956
  2957	003210'	667240	040000	SCOPTY:	TLON	U,LDLPTY	;P(SEUDO)TY OR R(EAL)TY?
  2958	003211'	256000	016231'		 STOPCD (.+1,INFO,TTYPTY,PRTUT1,<PTY bit wrong for TTY>)
  2959				 ;;SCOPTY+1
  2960	003212'	502245	000031		HLLM	U,LDBDCH(U)	;Reset it if LDLPTY was wrong
  2961	003213'	200300	015712'		MOVE	T1,TTFREN
  2962	003214'	303300	000003		CAILE	T1,TIRSVD	;IF NO SYSTEM BUFFERLETS
  2963	003215'	337000	015741'		SKIPG	MULCNT+1	;OR PTY "FLOW" QUOTA EXCEEDED,
  2964	003216'	254000	003341'		 JRST	NOLIN		;  MAYBE THE NEXT PORT'S A REAL TTY
  2965	003217'	260040	003431'		PUSHJ	P,SETPTL	;T1/ MAX CHARS TO XFER
  2966	003220'	201500	000001		MOVEI	W,1		;W = 1 = PTY
  2967	003221'	254000	003251'		JRST	SCOTTY
  2968
  2969				;Typeout routine for STOPCD(TTYPTY)
  2970	003222'	261040	000006	PRTUT1:	PUSH	P,T1		;Routine to output the contents of U and T1
  2971	003223'	261040	000005		PUSH	P,U
  2972	003224'	260040	001011*		PUSHJ	P,INLMES
  2973	003225'	413236	471530		 ASCIZ /Bits,,Line = /
	003226'	262315	167312
	003227'	201724	000000
  2974	003230'	262040	000006		POP	P,T1		;Contents of U
  2975	003231'	260040	000601*		PUSHJ	P,HWDPNT
  2976	003232'	260040	003224*		PUSHJ	P,INLMES
  2977	003233'	201010	367734		 ASCIZ /  Contents of T1 = /
	003234'	723135	672346
	003235'	203374	620250
	003236'	305007	520000
  2978	003237'	262040	000006		POP	P,T1		;Get saved value
  2979	003240'	260040	003231*		PUSHJ	P,HWDPNT	;Print as halfwords
  2980	003241'	324740	001026*		PJRST	CRLF##
  2981
  2982				    ;PREPARE TO DO OUTPUT ON A REAL PORT
  2983
  2984	003242'	623240	040000	SCORTY:	TLZE	U,LDLPTY	;P(SEUDO)TY OR R(EAL)TY?
  2985	003243'	256000	003211'		 STOPCD (,XCT,TTYPTY)
  2986				 ;;SCORTY+1
  2987	003244'	502245	000031		HLLM	U,LDBDCH(U)	;Reset it if LDLPTY was wrong
  2988	003245'	337000	015740'		SKIPG	MULCNT+0	;IF NO ROOM FOR REAL TTY OUTPUT,
  2989	003246'	254000	003341'		 JRST	NOLIN		;  MAYBE THE NEXT PORT'S A PTY
  2990	003247'	201300	000036		MOVEI	T1,%CHRMX	;T1/ MAX CHRS TO XMIT (EBUS02.J01 uses ^D30)
  2991	003250'	400500	000000		SETZ	W,		;W = 0 = REAL TTY
  2992					PFALL	SCOTTY
  2993
  2994				    ;LOOK FOR THE HIGHEST-PRIORITY OUTPUT REQUEST ON THE LINE
  2995
  2996	003251'	202300	015716'	SCOTTY:	MOVEM	T1,CHQTA
  2997	003252'	202300	015715'		MOVEM	T1,CHCNT
  2998	003253'	200305	000003		MOVE	T1,LDBOUT(U)	;T1/ OUTPUT BITS
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 61-2
SCNSER.MAC	25-NOV-87 19:52		OUTPUT DISPATCHER

  2999	003254'	243300	003256'		JFFO	T1,GOLIN
  3000	003255'	254000	003301'		 JRST	MORLN2		;NOTHING (THAT'S FUNNY...)
  3001	003256'	325240	003271'	GOLIN:	JUMPGE	U,GOLIN1	;IF PORT'S BACKPRESSURED
  3002	003257'	307340	000006		CAIG	T2,BPOKBN	; AND OUTPUT TYPE IS HIGH ENOUGH PRI
  3003	003260'	254000	003271'		 JRST	GOLIN1		; THEN OUTPUT IS OK
  3004	003261'	303340	000026		CAILE   T2,LAPBIT       ;BEYOND LAST LEGAL PRIORITY BIT?
  3005	003262'	254000	003301'		 JRST   MORLN2          ;YES.  ASSUME NO OUTPUT
  3006	003263'	135300	000100'		LDB	T1,LOPECO
  3007	003264'	326300	003270'		JUMPN	T1,GOLIN2	;ATTEMPT ECHO EVEN IF BACKPRESSURE ON
  3008	003265'	400300	000000	Golin3:	SETZ	T1,		;PORT IS BACKPRESSURED
  3009	003266'	137305	000002		DPB	T1,LDBOPB(U)	;  CLEAR NEED-OUTPUT
  3010	003267'	254000	003316'		JRST	FULLIN		;  AND SAY WE'RE THROUGH
  3011
  3012	003270'	201340	000024	GOLIN2:	MOVEI	T2,NUMECO	;ECHO BIT NUMBER
  3013	003271'	202340	015730'	GOLIN1:	MOVEM	T2,SVOJFF	;SAVE THE BIT NUMBER
  3014	003272'	322527	003353'		JUMPE	W,@OUTTRN(T2)	;REAL TTY DISPATCH
  3015	003273'	254027	003402'		JRST	@PTYTRN(T2)	;PSEUDO-TTY DISPATCH
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 62
SCNSER.MAC	25-NOV-87 19:52		OUTPUT DISPATCHER

  3016				    ;OUTPUT SUCCESSFUL, ROOM FOR MORE
  3017
  3018	003274'	210340	015730'	MORLIN:	MOVN	T2, SVOJFF	;T2/ -(BIT# WE DISPATCHED FOR)
  3019	003275'	205300	400000		MOVSI	T1, (1B0)
  3020	003276'	242307	000000		LSH	T1, (T2)	;T1/ BIT WE DISPATCHED FOR
  3021	003277'	413305	000003		ANDCAB	T1, LDBOUT(U)	;CLEAR IT AND PICK UP THE REST
  3022	003300'	243300	003256'		JFFO	T1, GOLIN	;IF THERE'S MORE TO DO, DO IT
  3023
  3024				    ;FINISHED WITH THE LAST OUTPUT REQUEST FOR THIS PORT
  3025
  3026	003301'	137305	000002	MORLN2:	DPB	T1, LDBOPB(U)	;CLEAR NEED-OUTPUT BIT
  3027	003302'	260040	006070'		PUSHJ	P, XMTWAK	;WAKE UP THE JOB FOR GOOD MEASURE
  3028	003303'	254000	003316'		JRST	FULLIN
  3029
  3030				    ;OUTPUT SUCCESSFUL, NO ROOM FOR MORE
  3031
  3032	003304'	210340	015730'	FINLIN:	MOVN	T2, SVOJFF
  3033	003305'	205300	400000		MOVSI	T1, (1B0)
  3034	003306'	242307	000000		LSH	T1, (T2)
  3035	003307'	413305	000003		ANDCAB	T1, LDBOUT(U)
  3036	003310'	322300	003301'		JUMPE	T1, MORLN2
  3037	003311'	254000	003316'		JRST	FULLIN
  3038
  3039				    ;OUTPUT NOT DONE BECAUSE WE'RE WAITING FOR SOMETHING
  3040				    ;(E.G., CAN'T OUTPUT ECHO CHARACTERS IF THE PORT'S NOT
  3041				    ;IN INPUT WAIT). CODE FOR "SOMETHING"S MUST TURN
  3042				    ;THE NEED-OUTPUT BIT BACK ON
  3043
  3044	003312'	201300	000000	WATLIN:	MOVEI	T1, 0
  3045	003313'	137305	000002		DPB	T1, LDBOPB(U)
  3046	003314'	260040	006070'		PUSHJ	P, XMTWAK
  3047	003315'	254000	003316'		JRST	FULLIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 63
SCNSER.MAC	25-NOV-87 19:52		OUTPUT DISPATCHER

  3048				    ;OUTPUT NOT DONE AND/OR FINISHED WITH THIS PORT
  3049
  3050	003316'	550205	000000	FULLIN:	HRRZ	F, LDBDDB(U)
  3051	003317'	322200	003325'		JUMPE	F, FULLN2
  3052	003320'	135300	001557*		LDB	T1, PJOBN
  3053	003321'	200440	015716'		MOVE	T4, CHQTA
  3054	003322'	274440	015715'		SUB	T4, CHCNT
  3055	003323'	273446	000000*		ADDB	T4, JBTCOT(T1)
  3056	003324'	202440	003323*		MOVEM	T4, JBTCOT
  3057	003325'	326500	003332'	FULLN2:	JUMPN	W, FULLN3
  3058
  3059				    ;DONE WITH A REAL TTY
  3060
  3061	003326'	260040	004102'		PUSHJ	P, CLSCHR	;FINISH CHARACTER-OUTPUT MESSAGE
  3062	003327'	333000	015741'		  SKIPLE MULCNT+1	;No room in ORING.  Any PTY room?
  3063	003330'	254000	003341'		 JRST	NOLIN		;Room in ORING or room for PTY I/O
  3064	003331'	254000	003347'		JRST	FINOUT		;  QUIT
  3065
  3066				    ;DONE WITH A PTY
  3067
  3068	003332'	302500	000001	FULLN3:	CAIE	W, 1
  3069	003333'	256000	000000'		 STOPCD
  3070	003334'	260040	003465'		PUSHJ	P, CLSPTL	;FINISH CHARACTER OUTPUT
  3071	003335'	337000	015740'		SKIPG	MULCNT+0	;IF THERE'S ROOM FOR REAL PORTS
  3072	003336'	333000	015741'		SKIPLE	MULCNT+1	;OR PTYS,
  3073	003337'	254000	003341'		 JRST	NOLIN		;  GO ON
  3074	003340'	254000	003347'		JRST	FINOUT		;ELSE QUIT
  3075
  3076				    ;GO ON TO THE NEXT PORT
  3077
  3078	003341'	350440	015726'	NOLIN:	AOS	T4, LINPNM
  3079	003342'	200240	015727'		MOVE	U, LINFSV
  3080	003343'	326240	003176'		JUMPN	U, SCOLP	;TRY TO FIND ANOTHER IN GROUP
  3081	003344'	200300	015714'	NOLIN2:	MOVE	T1, LINPTR
  3082	003345'	253300	003172'		AOBJN	T1, SCOLP1	;TRY ANOTHER GROUP
  3083	003346'	402000	015714'		SETZM	LINPTR		;(START FROM BEGINNING NEXT TIME)
  3084	003347'	357000	015711'	FINOUT:	AOSG	FSCN	;(IF IT WAS 0 (NOW 1), THERE WAS NO I/O)
  3085	003350'	254000	000722'		 JRST	SCNIN	;IF I/O DONE THIS CYCLE, GO CHECK INPUT AGAIN
  3086	003351'	402000	015711'		SETZM	FSCN	;OTHERWISE, CLEAR FSCN
  3087	003352'	263040	000000		POPJ	P,	;AND RETURN (FROM SCNINT) TO THE TICK LOGIC
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 64
SCNSER.MAC	25-NOV-87 19:52		OUTPUT DISPATCH TABLES

  3088				SUBTTL	OUTPUT DISPATCH TABLES
  3089
  3090				DEFINE ZZZ(NAME), <GO'NAME>
  3091	003353'	000000	004200'	OUTTRN:	OUTBIT
  3092	003354'	000000	004574'
  3093	003355'	000000	004234'
  3094	003356'	000000	004506'
  3095	003357'	000000	004602'
  3096	003360'	000000	004305'
  3097	003361'	000000	004271'
  3098	003362'	000000	004523'
  3099	003363'	000000	004232'
  3100	003364'	000000	004242'
  3101	003365'	000000	004236'
  3102	003366'	000000	004205'
  3103	003367'	000000	004257'
  3104	003370'	000000	005314'
  3105	003371'	000000	004604'
  3106	003372'	000000	004626'
  3107	003373'	000000	004524'
  3108	003374'	000000	004656'
  3109	003375'	000000	004247'
  3110	003376'	000000	004327'
  3111	003377'	000000	004712'
  3112	003400'	000000	004666'
  3113	003401'	000000	004670'
  3114
  3115				DEFINE ZZZ(NAME), <PG'NAME>
  3116	003402'	000000	004177'	PTYTRN:	OUTBIT
  3117	003403'	000000	004040'
  3118	003404'	000000	003565'
  3119	003405'	000000	003655'
  3120	003406'	000000	003637'
  3121	003407'	000000	003575'
  3122	003410'	000000	003603'
  3123	003411'	000000	004001'
  3124	003412'	000000	003554'
  3125	003413'	000000	003555'
  3126	003414'	000000	003555'
  3127	003415'	000000	003556'
  3128	003416'	000000	004067'
  3129	003417'	000000	005314'
  3130	003420'	000000	004604'
  3131	003421'	000000	004626'
  3132	003422'	000000	003725'
  3133	003423'	000000	003607'
  3134	003424'	000000	003555'
  3135	003425'	000000	004044'
  3136	003426'	000000	004712'
  3137	003427'	000000	003554'
  3138	003430'	000000	003567'
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 65
SCNSER.MAC	25-NOV-87 19:52		PTY "OUTPUT" ROUTINES

  3139				SUBTTL PTY "OUTPUT" ROUTINES
  3140
  3141			000170	PTBSIZ==^D120
  3142
  3143				;SETPTL - CALLED WITH U/ PTY LDB TO SET UP FOR OUTPUT THENCE
  3144				;	IF THE OTHER END IS IN BLOCK INPUT WAIT, IT SETS
  3145				;	CHRWRP+1 TO POINT TO THE NEXT FREE BYTE IN THE
  3146				;	BLOCK INPUT BUFFER
  3147				;	OTHERWISE, IT SETS CHRWRP+1 TO POINT TO THE
  3148				;	PTY BUFFER
  3149				;	SETS T1/ MAX # CHARS TO MOVE
  3150
  3151	003431'	402000	016076'	SETPTL:	SETZM	PBDISC		;CHARIO DISCOUNT FOR BLOCK OUTPUT
  3152	003432'	261040	000005		PUSH	P, U
  3153	003433'	260040	007675'		PUSHJ	P, PTYBUD
  3154	003434'	201300	010000		MOVEI	T1, LDRBIP
  3155	003435'	612305	000031		TDNE	T1, LDBDCH(U)	;IF BLOCK INPUT IS IN PROGRESS,
  3156	003436'	254000	003453'		 JRST	SETPTB		;  DO THINGS DIFFERENTLY
  3157
  3158				    ;HERE WHEN OTHER END IS NOT IN BLOCK INPUT WAIT
  3159
  3160	003437'	402000	016077'		SETZM	DIDPBI
  3161	003440'	200300	016235'		MOVE	T1, [POINT 8, PTYBUF]
  3162	003441'	202300	015737'		MOVEM	T1, CHRWRP+1
  3163	003442'	200300	016014'		MOVE	T1, TIWRNN	;T1/ # CHARS ALLOWED BEFORE BACKPRESSURE
  3164	003443'	274305	000012		SUB	T1, LDBTIC(U)
  3165	003444'	274305	000014		SUB	T1, LDBECC(U)	;T1/ # MORE CHARS THAT WILL FIT
  3166	003445'	335000	000006		SKIPGE	T1		;IF WE'LL BE BACKPRESSURED,
  3167	003446'	201300	000036		 MOVEI	T1,%CHRMX	;  T1/ NORMAL (REAL TTY) LIMIT
  3168	003447'	303300	000170		CAILE	T1, PTBSIZ
  3169	003450'	201300	000170		MOVEI	T1, PTBSIZ	;MUSTN'T BE .gt. THAN THE PTY BUFFER SIZE
  3170	003451'	262040	000005		POP	P, U
  3171	003452'	263040	000000		POPJ	P,
  3172
  3173				    ;HERE WHEN THE OTHER END IS IN BLOCK INPUT WAIT
  3174
  3175	003453'	476000	016077'	SETPTB:	SETOM	DIDPBI
  3176	003454'	550305	000005		HRRZ	T1, LDBBIO(U)	;T1/ BLOCK INPUT BUFFER ADDR
  3177	003455'	332000	000006		SKIPE	T1		;IF NONE,
  3178	003456'	331006	000005		SKIPL	BIOCHR(T1)	;OR IF NO INPUT PENDING,
  3179	003457'	256000	000000'		 STOPCD 		;  DIE
  3180	003460'	200346	000002		MOVE	T2, BIOPBP(T1)	;T2/ BLOCK IDPB POINTER
  3181	003461'	202340	015737'		MOVEM	T2, CHRWRP+1
  3182	003462'	200306	000003		MOVE	T1, BIOPBC(T1)	;T1/ # BYTES LEFT THERE
  3183	003463'	262040	000005		POP	P, U
  3184	003464'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 66
SCNSER.MAC	25-NOV-87 19:52		CLSPTL - CALLED WITH U/ PTY LDB TO FINISH UP OUTPUT THITHER

  3185				SUBTTL	CLSPTL - CALLED WITH U/ PTY LDB TO FINISH UP OUTPUT THITHER
  3186				;	IF OTHER END WAS DOING BLOCK INPUT, THE CHARACTERS ARE
  3187				;	ALREADY MOVED - WE JUST NEED TO UPDATE THE BUFFER
  3188				;	POINTER&COUNT AND SEE IF WE'VE FILLED IT YET
  3189				;	OTHERWISE WE NEED TO MOVE THE CHARACTERS TO THE
  3190				;	OTHER END
  3191
  3192	003465'	200300	016076'	CLSPTL:	MOVE	T1, PBDISC
  3193	003466'	272300	015715'		ADDM	T1, CHCNT	;ADJUST CHARIO COUNT FOR BLOCK OUTPUT
  3194	003467'	332000	016077'		SKIPE	DIDPBI		;IF OTHER END WAS DOING BLOCK INPUT,
  3195	003470'	254000	003517'		JRST	CLSPTB		;  HANDLE THINGS DIFFERENTLY
  3196
  3197	003471'	200300	015737'		MOVE	T1, CHRWRP+1	;T1/ BYTE POINTER
  3198	003472'	316300	016235'		CAMN	T1, [POINT 8, PTYBUF]
  3199	003473'	263040	000000		POPJ	P,		;(NOTHING TO OUTPUT)
  3200
  3201	003474'	261040	000005		PUSH	P, U
  3202	003475'	261040	016236'		PUSH	P, [0]
  3203	003476'	261040	000006		PUSH	P, T1
  3204	003477'	261040	016235'		PUSH	P, [POINT 8, PTYBUF]
  3205
  3206				    ;-2(P) = 0 IF REM. ECHO, -1 IF DEFERRED
  3207				    ;-1(P) IS ORIGINAL ENDING BYTE POINTER
  3208				    ;  (P) IS SOURCE BYTE POINTER
  3209
  3210	003500'	260040	007675'		PUSHJ	P, PTYBUD	;U/ BUDDY'S LDB
  3211	003501'	134401	000000	CLSLP1:	UUILDB	T3, (P)		;T3/ CHAR
  3212	003502'	260040	001576'		PUSHJ	P, MOVCHR	;DEPOSIT IT
  3213	003503'	254000	003505'		  JRST	.+2
  3214	003504'	476001	777776		SETOM	-2(P)		;(ENTERED DEFERRED ECHO MODE)
  3215	003505'	200301	000000		MOVE	T1, (P)
  3216	003506'	312301	777777		CAME	T1, -1(P)
  3217	003507'	254000	003501'		JRST	CLSLP1
  3218
  3219	003510'	336301	777776		SKIPN	T1, -2(P)	;IF IT ENTERED DEFERRED ECHO MODE,
  3220	003511'	254000	003514'		JRST	CLSLP2
  3221	003512'	137300	000100'		DPB	T1, LOPECO	;  SET NEED-ECHO
  3222	003513'	137305	000002		DPB	T1, LDBOPB(U)	;  AND NEED-OUTPUT
  3223	003514'	274040	016237'	CLSLP2:	SUB	P, [3,,3]	;DISCARD THE THREE LOCALS
  3224	003515'	262040	000005		POP	P, U		;RESTORE U
  3225	003516'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 67
SCNSER.MAC	25-NOV-87 19:52		CLSPTL - CALLED WITH U/ PTY LDB TO FINISH UP OUTPUT THITHER

  3226				    ;HERE WHEN THE OTHER END WAS DOING BLOCK INPUT
  3227
  3228	003517'	261040	000005	CLSPTB:	PUSH	P, U
  3229	003520'	260040	007675'		PUSHJ	P, PTYBUD
  3230	003521'	201300	010000		MOVEI	T1, LDRBIP
  3231	003522'	616305	000031		TDNN	T1, LDBDCH(U)	;IF BLKI NO LONGER IN PROGRESS,
  3232	003523'	254000	003541'		 JRST	UPOPJ		;  NOTHING TO DO
  3233	003524'	550305	000005		HRRZ	T1, LDBBIO(U)	;T1/ BLOCK INPUT BUFFER ADDRESS
  3234	003525'	336000	000006		SKIPN	T1
  3235	003526'	256000	000000'		 STOPCD
  3236	003527'	200400	015737'		MOVE	T3, CHRWRP+1
  3237	003530'	202406	000002		MOVEM	T3, BIOPBP(T1)	;UPDATE BYTE POINTER
  3238	003531'	200400	015715'		MOVE	T3, CHCNT
  3239	003532'	274400	015716'		SUB	T3, CHQTA	;T3/ - # OF CHARACTERS MOVED
  3240	003533'	273406	000003		ADDB	T3, BIOPBC(T1)	;UPDATE BYTES-LEFT COUNT
  3241	003534'	322400	003543'		JUMPE	T3, CLSPBF	;(BUFFER FILLED)
  3242
  3243				    ;HERE WHEN WE HAVEN'T FINISHED FILLING THE BUFFER YET
  3244
  3245	003535'	337000	000010		SKIPG	T3
  3246	003536'	256000	000000'		 STOPCD 		;(WENT TOO FAR)
  3247	003537'	201300	000017		MOVEI	T1, %PBTIM
  3248	003540'	137300	000170'		DPB	T1, LDPTIM	;RESET BLOCK-INPUT TIMER
  3249	003541'	262040	000005	UPOPJ:	POP	P,U
  3250	003542'	263040	000000		POPJ	P,
  3251
  3252				    ;HERE WHEN WE'VE JUST FILLED A BLOCK INPUT BUFFER
  3253
  3254	003543'	550446	000005	CLSPBF:	HRRZ	T4, BIOCHR(T1)	;T4/ (PRESUMABLY) # CHARS MOVED
  3255	003544'	260040	001250'		PUSHJ	P, FRCIBF	;SIMULATE BUFFER-FULL MESSAGE
  3256	003545'	400300	000000		SETZ	T1,
  3257	003546'	137300	000170'		DPB	T1, LDPTIM	;CLEAR BLOCK-INPUT TIMER
  3258	003547'	201300	010000		MOVEI	T1, LDRBIP
  3259	003550'	412305	000031		ANDCAM	T1, LDBDCH(U)	;CLEAR IN-PROGRESS FLAG
  3260	003551'	262040	000005		POP	P, U
  3261	003552'	260040	001135'		PUSHJ	P, FRCNOO	;BACKPRESSURE OURSELVES
  3262	003553'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 68
SCNSER.MAC	25-NOV-87 19:52		CLSPTL - CALLED WITH U/ PTY LDB TO FINISH UP OUTPUT THITHER

  3263				    ;IMPOSSIBLE OUTPUT BITS
  3264
  3265	003554'			PGSRD:	;RED BALL
  3266	003554'			PGSGR:	;GREEN BALL
  3267	003554'	256000	000000'		 STOPCD
  3268
  3269				    ;IGNORED OUTPUT BITS
  3270
  3271	003555'			PGSEC:	;SET ECHO MODE (SHOULD ALWAYS BE OFF)
  3272	003555'			PGSTP:	;TERMINAL CHARACTERISTICS PROBE
  3273	003555'			PGHNG:	;HANG UP DATA SET
  3274	003555'	254000	003274'		JRST	MORLIN
  3275
  3276				    ;NOT IMPLEMENTED YET - IGNORE
  3277
  3278	003556'			PGSTC:	;SET TERMINAL CHARACTERISTICS
  3279	003556'	254000	003274'		JRST	MORLIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 69
SCNSER.MAC	25-NOV-87 19:52		MSGSIM - SIMULATE INPUT-MESSAGE ARRIVAL

  3280				SUBTTL	MSGSIM - SIMULATE INPUT-MESSAGE ARRIVAL
  3281				;	CALLED WITH T1/ ADDR OF A FRC--- ROUTINE
  3282				;	CALLS <T1> WITH U/ THE CURRENT PTY'S "BUDDY"
  3283
  3284	003557'	261040	000005	MSGSIM:	PUSH	P, U		;SAVE U
  3285	003560'	260040	007675'		PUSHJ	P, PTYBUD	;U/ "BUDDY" LDB
  3286	003561'	500245	000031		HLL	U, LDBDCH(U)
  3287	003562'	260046	000000		PUSHJ	P, (T1)		;SIMULATE A <T1>-ARRIVAL
  3288	003563'	262040	000005		POP	P, U
  3289	003564'	254000	003274'		JRST	MORLIN
  3290
  3291				;CHARACTER GOBBLER
  3292
  3293	003565'	201300	001123'	PGCGB:	MOVEI	T1, FRCCGB
  3294	003566'	324740	003557'		PJRST	MSGSIM
  3295
  3296
  3297				;ORANGE BALL
  3298
  3299	003567'	205340	004000	PGSOG:	MOVSI	T2, L2LDEL
  3300	003570'	616345	000027		TDNN	T2, LDBBYT(U)	;IF WE'RE IN \...
  3301	003571'	260040	004676'		 PUSHJ	P, WTCHK	;OR WE'RE IN INPUT WAIT,
  3302	003572'	254000	003312'		  JRST	WATLIN		;  WAIT
  3303	003573'	201300	001213'		MOVEI	T1, FRCORG
  3304	003574'	324740	003557'		PJRST	MSGSIM
  3305
  3306				;BACKPRESSURE ON
  3307
  3308	003575'	201300	200000	PGBPN:	MOVEI	T1, LDRXOS
  3309	003576'	612305	000031		TDNE	T1, LDBDCH(U)	;IF WE'VE ALREADY SENT AN XOFF,
  3310	003577'	254000	003274'		 JRST	MORLIN		;  DON'T SEND ANOTHER
  3311	003600'	436305	000031		IORM	T1, LDBDCH(U)
  3312	003601'	201300	001135'		MOVEI	T1, FRCNOO
  3313	003602'	324740	003557'		PJRST	MSGSIM
  3314
  3315				;BACKPRESSURE OFF
  3316
  3317	003603'	201300	200000	PGBPF:	MOVEI	T1, LDRXOS
  3318	003604'	412305	000031		ANDCAM	T1, LDBDCH(U)	;CLEAR BACKPRESSURE-SEND FLAG
  3319	003605'	201300	001144'		MOVEI	T1, FRCDOO
  3320	003606'	324740	003557'		PJRST	MSGSIM
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 70
SCNSER.MAC	25-NOV-87 19:52		YELLOW BALL

  3321				SUBTTL	YELLOW BALL
  3322
  3323	003607'	261040	000005	PGSYL:	PUSH	P, U
  3324	003610'	260040	007675'		PUSHJ	P, PTYBUD
  3325	003611'	500245	000031		HLL	U, LDBDCH(U)
  3326	003612'	201300	010000		MOVEI	T1, LDRBIP
  3327	003613'	616305	000031		TDNN	T1, LDBDCH(U)	;IS OTHER END DOING BLOCK INPUT?
  3328	003614'	254000	003630'		 JRST	PGSYLN		;(NO)
  3329
  3330				    ;HERE WHEN THE OTHER END'S DOING BLOCK INPUT
  3331
  3332	003615'	412305	000031		ANDCAM	T1, LDBDCH(U)	;CLEAR IN-PROGRESS FLAG
  3333	003616'	550305	000005		HRRZ	T1, LDBBIO(U)
  3334	003617'	332000	000006		SKIPE	T1
  3335	003620'	331346	000005		SKIPL	T2, BIOCHR(T1)
  3336	003621'	256000	000000'		 STOPCD
  3337	003622'	550440	000007		HRRZ	T4, T2		;T4/ # CHARS TO TRANSFER
  3338	003623'	274446	000003		SUB	T4, BIOPBC(T1)	;T4/ # CHARS TRANSFERRED
  3339	003624'	260040	001270'		PUSHJ	P, FRCEOT	;FAKE A BLKI-EOT
  3340	003625'	262040	000005		POP	P, U
  3341	003626'	260040	001135'		PUSHJ	P, FRCNOO	;BACKPRESSURE OURSELVES
  3342	003627'	254000	003312'		JRST	WATLIN		;(SEND YLB WHEN BKP RELIEVED)
  3343
  3344				    ;HERE IN THE NORMAL CASE
  3345
  3346	003630'	205300	000400	PGSYLN:	MOVSI	T1, L2LOWT
  3347	003631'	436305	000027		IORM	T1, LDBBYT(U)	;SAY WE'RE WAITING
  3348	003632'	205300	002000		MOVSI	T1, L2LOWS
  3349	003633'	412305	000027		ANDCAM	T1, LDBBYT(U)	;AND THAT WE HAVEN'T SEEN ONE
  3350	003634'	260040	001223'		PUSHJ	P, FRCYEL
  3351	003635'	262040	000005		POP	P, U
  3352	003636'	254000	003274'		JRST	MORLIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 71
SCNSER.MAC	25-NOV-87 19:52		WHEN THE PTY OUTPUT CODE FILLS UP A BLOCK INPUT BUFFER, IT

  3353				SUBTTL	WHEN THE PTY OUTPUT CODE FILLS UP A BLOCK INPUT BUFFER, IT
  3354				;FORCES BACKPRESSURE ON THE LINE DOING THE OUTPUT - THE
  3355				;REQUEST-BLOCK-INPUT AND REQUEST-BLOCK-INPUT-TERMINATION
  3356				;OUTPUT ROUTINES CLEAR THE BACKPRESSURE
  3357
  3358				;TERMINATE BLOCK INPUT
  3359
  3360	003637'	201300	010000	PGTRI:	MOVEI	T1, LDRBIP
  3361	003640'	616305	000031		TDNN	T1, LDBDCH(U)	;IF BLOCK INPUT'S IN PROGRESS,
  3362	003641'	254000	003652'		 JRST	PGTRI1
  3363	003642'	412305	000031		ANDCAM	T1, LDBDCH(U)	;  CLEAR IN-PROGRESS FLAG
  3364	003643'	550305	000005		HRRZ	T1, LDBBIO(U)	;  T1/ BLOCK INPUT BUFFER ADDR
  3365	003644'	332000	000006		SKIPE	T1
  3366	003645'	331346	015776'		SKIPL	T2, BIOCNT(T1)
  3367	003646'	256000	003663'		 STOPCD (,XCT,TTYNPB)
  3368					;No PTY Buffer for block IO  ;;PGTRI+7
  3369	003647'	550440	000007		HRRZ	T4, T2		;  T4/ # OF CHARS TO TRANSFER
  3370	003650'	274446	000003		SUB	T4, BIOPBC(T1)	;  T4/ # OF CHARS TRANFERRED
  3371	003651'	254000	003653'		JRST	.+2		;OTHERWISE
  3372	003652'	400440	000000	PGTRI1:	SETZ	T4,		;  T4/ 0 CHARS
  3373	003653'	260040	001341'		PUSHJ	P, FRCIHR	;FAKE A TERMINATED-BY-REQUEST
  3374	003654'	254000	003671'		JRST	PGBIN1		;CLEAR BACKPRESSURE ON THE OTHER END
  3375
  3376				;REQUEST BLOCK INPUT
  3377
  3378	003655'	201300	010000	PGBIN:	MOVEI	T1, LDRBIP
  3379	003656'	436305	000031		IORM	T1, LDBDCH(U)	;MARK INPUT IN PROGRESS
  3380	003657'	201300	000017		MOVEI	T1, %PBTIM
  3381	003660'	137300	000170'		DPB	T1, LDPTIM	;SET BLOCK-INPUT TIMEOUT
  3382	003661'	550305	000005		HRRZ	T1, LDBBIO(U)	;T1/ INPUT BUFFER ADDRESS
  3383	003662'	336000	000006		SKIPN	T1
  3384	003663'	256000	016240'	TTYNPB:: STOPCD (.,JOB,TTYNPB,,<No PTY Buffer for block IO>)
  3385				 ;;PGBIN+6
  3386	003664'	550346	000005		HRRZ	T2, BIOCHR(T1)	;T2/ # CHARS TO TRANSFER
  3387	003665'	202346	000003		MOVEM	T2, BIOPBC(T1)	;STORE PTY COUNT
  3388	003666'	200340	016243'		MOVE	T2, [POINT 8,BIODAT]
  3389	003667'	270340	000006		ADD	T2, T1
  3390	003670'	202346	000002		MOVEM	T2, BIOPBP(T1)	;STORE PTY BYTE POINTER
  3391
  3392				    ;HERE FROM ABOVE AND FROM PGTRI TO CLEAR BACKPRESSURE
  3393
  3394	003671'	261040	000005	PGBIN1:	PUSH	P, U
  3395	003672'	260040	007675'		PUSHJ	P, PTYBUD
  3396	003673'	500245	000031		HLL	U, LDBDCH(U)
  3397	003674'	260040	001144'		PUSHJ	P, FRCDOO	;CLEAR BACKPRESSURE ON OTHER END
  3398	003675'	262040	000005		POP	P, U
  3399	003676'	254000	003274'		JRST	MORLIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 72
SCNSER.MAC	25-NOV-87 19:52		PBTIMO - CALLED BY SCNSEC WHEN A PORT DOING BLOCK INPUT

  3400				SUBTTL	PBTIMO - CALLED BY SCNSEC WHEN A PORT DOING BLOCK INPUT
  3401				;	   TIMES OUT.
  3402				;	   SAVES P1-P4.
  3403				;	   ASSUMES THAT FRCITM PRESERVES U AND F.
  3404
  3405	003677'	261040	000014	PBTIMO:	PUSH	P, P1
  3406	003700'	261040	000015		PUSH	P, P2
  3407	003701'	261040	000016		PUSH	P, P3
  3408	003702'	261040	000017		PUSH	P, P4
  3409
  3410	003703'	550305	000005		HRRZ	T1, LDBBIO(U)
  3411	003704'	332000	000006		SKIPE	T1
  3412	003705'	331446	000005		SKIPL	T4, BIOCHR(T1)
  3413	003706'	256000	000000'		 STOPCD 		;NO BUFFER OR NO INPUT PENDING
  3414	003707'	201340	010000		MOVEI	T2, LDRBIP
  3415	003710'	412345	000031		ANDCAM	T2, LDBDCH(U)	;CLEAR IN-PROGRESS FLAG
  3416	003711'	550440	000011		HRRZ	T4, T4		;T4/ # BYTES REQUESTED
  3417	003712'	274446	000003		SUB	T4, BIOPBC(T1)	;T4/ # BYTES TRANSFERRED
  3418	003713'	260040	001306'		PUSHJ	P, FRCITM	;FAKE A TIMEOUT MESSAGE
  3419	003714'	261040	000005		PUSH	P, U
  3420	003715'	260040	007675'		PUSHJ	P, PTYBUD
  3421	003716'	260040	001135'		PUSHJ	P, FRCNOO	;BACKPRESSURE OTHER END
  3422	003717'	262040	000005		POP	P, U
  3423
  3424	003720'	262040	000017		POP	P, P4
  3425	003721'	262040	000016		POP	P, P3
  3426	003722'	262040	000015		POP	P, P2
  3427	003723'	262040	000014		POP	P, P1
  3428	003724'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 73
SCNSER.MAC	25-NOV-87 19:52		BLOCK OUTPUT

  3429				SUBTTL	BLOCK OUTPUT
  3430
  3431	003725'	336000	016077'	PGBOT:	SKIPN	DIDPBI		;IF THE OTHER END WAS DOING BLOCK INPUT,
  3432	003726'	254000	003766'		 JRST	PGBOTC
  3433	003727'	200300	015715'		MOVE	T1, CHCNT
  3434	003730'	312300	015716'		CAME	T1, CHQTA	;AND IT HASN'T GOTTEN ANY CHARS YET,
  3435	003731'	254000	003766'		 JRST	PGBOTC
  3436	003732'	261040	000005		PUSH	P, U
  3437	003733'	260040	007675'		PUSHJ	P, PTYBUD
  3438	003734'	201300	010000		MOVEI	T1, LDRBIP
  3439	003735'	612305	000031		TDNE	T1, LDBDCH(U)	;AND IT'S STILL IN BLOCK INPUT WAIT,
  3440	003736'	254000	003741'		 JRST	PGBOT1
  3441	003737'	262040	000005		POP	P, U
  3442	003740'	254000	003766'		JRST	PGBOTC
  3443
  3444	003741'	550305	000005	PGBOT1:	HRRZ	T1, LDBBIO(U)	;  T1/ ITS BLOCK INPUT BUFFER
  3445	003742'	336000	000006		SKIPN	T1
  3446	003743'	256000	000000'		 STOPCD
  3447	003744'	550341	000000		HRRZ	T2, (P)		;  T2/ OUR LDB ADDR
  3448	003745'	554407	000005		HLRZ	T3, LDBBIO(T2)	;  T3/ OUR BLOCK OUTPUT BUFFER
  3449	003746'	336000	000010		SKIPN	T3
  3450	003747'	256000	000000'		 STOPCD
  3451	003750'	542405	000005		HRRM	T3, LDBBIO(U)	;  OUR OUTPUT = ITS INPUT
  3452	003751'	506307	000005		HRLM	T1, LDBBIO(T2)	;  ITS INPUT = OUR OUTPUT
  3453	003752'	200446	000004		MOVE	T4, BIOREQ(T1)
  3454	003753'	250450	000004		EXCH	T4, BIOREQ(T3)
  3455	003754'	202446	000004		MOVEM	T4, BIOREQ(T1)	;  BUT KEEP THE OLD BIOREQ'S
  3456	003755'	331306	000005		SKIPL	T1, BIOCHR(T1)	;  T1/ -1,,# CHARS "TRANSMITTED"
  3457	003756'	256000	000000'		 STOPCD
  3458	003757'	202310	000005		MOVEM	T1, BIOCHR(T3)	;  INPUT SIDE WANTS THE -1 FLAG
  3459	003760'	553006	000005		HRRZS	BIOCHR(T1)	;  OUTPUT SIDE DOESN'T
  3460	003761'	552300	016076'		HRRZM	T1, PBDISC	;  ALREADY CHARGED (JBTBIO), SO DISCOUNT
  3461	003762'	262040	000005		POP	P, U
  3462	003763'	402000	015715'		SETZM	CHCNT		;  WE'VE FILLED ITS BUFFER
  3463	003764'	260040	001360'		PUSHJ	P, FRCOHR	;  WE'VE DONE OUR BLOCK OUTPUT
  3464	003765'	254000	003304'		JRST	FINLIN		;  NO MORE THIS CYCLE
  3465
  3466				    ;HERE WHEN THE OTHER END'S NOT COOPERATING BY DOING BLOCK INPUT
  3467
  3468	003766'	554305	000005	PGBOTC:	HLRZ	T1, LDBBIO(U)	;T1/ BLOCK OUTPUT BUFFER
  3469	003767'	336000	000006		SKIPN	T1
  3470	003770'	256000	000000'		 STOPCD
  3471	003771'	550346	000005		HRRZ	T2, BIOCHR(T1)	;T2/ TOTAL CHARS TO TRANSFER
  3472	003772'	202346	000003		MOVEM	T2, BIOPBC(T1)	;STORE IT
  3473	003773'	200400	016243'		MOVE	T3, [POINT 8,BIODAT]
  3474	003774'	270400	000006		ADD	T3, T1		;T3/ BYTE POINTER
  3475	003775'	202406	000002		MOVEM	T3, BIOPBP(T1)	;STORE IT
  3476	003776'	201300	000001		MOVEI	T1, 1
  3477	003777'	137300	000063'		DPB	T1, LOPBOP	;SET BLOCK-OUTPUT-IN-PROGRESS
  3478	004000'	254000	003274'		JRST	MORLIN		;(DISPATCH WILL GO DO IT)
  3479				;BLOCK OUTPUT IN PROGRESS
  3480
  3481	004001'	554305	000005	PGBOP:	HLRZ	T1, LDBBIO(U)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 73-2
SCNSER.MAC	25-NOV-87 19:52		BLOCK OUTPUT

  3482	004002'	336000	000006		SKIPN	T1
  3483	004003'	256000	000000'		 STOPCD
  3484	004004'	200346	000003		MOVE	T2, BIOPBC(T1)	;T2/ COUNT
  3485	004005'	200406	000002		MOVE	T3, BIOPBP(T1)	;T3/ POINTER
  3486	004006'	200440	015741'		MOVE	T4, MULCNT+1
  3487	004007'	313440	015715'		CAMLE	T4, CHCNT
  3488	004010'	200440	015715'		MOVE	T4, CHCNT	;T4/ MIN(MULCNT+1,CHCNT)
  3489	004011'	261040	000011		PUSH	P, T4		;SAVE IT
  3490	004012'	313340	000011		CAMLE	T2, T4
  3491	004013'	200340	000011		MOVE 	T2, T4		;T4/ MIN(# TO XFER,# THAT'LL FIT)
  3492	004014'	261040	000007		PUSH	P, T2		;SAVE IT
  3493
  3494	004015'	322340	004021'		JUMPE	T2, PGBOP2
  3495	004016'	134440	000010	PGBOP1:	UUILDB	T4, T3
  3496	004017'	136440	015737'		UUIDPB	T4, CHRWRP+1
  3497	004020'	367340	004016'		SOJG	T2, PGBOP1
  3498
  3499	004021'	262040	000007	PGBOP2:	POP	P, T2
  3500	004022'	272340	016076'		ADDM	T2, PBDISC	;(TO BE DISCOUNTED FROM CHARIO CHARGE)
  3501	004023'	210440	000007		MOVN	T4, T2
  3502	004024'	272440	015741'		ADDM	T4, MULCNT+1	;DECREMENT MULCNT
  3503	004025'	272440	015715'		ADDM	T4, CHCNT	;AND CHCNT
  3504	004026'	272441	000000		ADDM	T4, (P)		;AND SAVED # THAT'LL FIT
  3505	004027'	273446	000003		ADDB	T4, BIOPBC(T1)	;AND BLOCK-BUFFER COUNT
  3506	004030'	327440	004035'		JUMPG	T4, PGBOP3	;IF WE'RE DONE
  3507	004031'	260040	001360'		PUSHJ	P, FRCOHR	;  FAKE AN OUTPUT-TERMINATED
  3508	004032'	262040	000006		POP	P, T1
  3509	004033'	323300	003304'		JUMPLE	T1, FINLIN
  3510	004034'	254000	003274'		JRST	MORLIN
  3511								;OTHERWISE,
  3512	004035'	202406	000002	PGBOP3:	MOVEM	T3, BIOPBP(T1)	;  UPDATE CHARACTER POINTER
  3513	004036'	262040	000006		POP	P, T1
  3514	004037'	254000	003316'		JRST	FULLIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 74
SCNSER.MAC	25-NOV-87 19:52		TERMINATE BLOCK OUTPUT

  3515				SUBTTL	TERMINATE BLOCK OUTPUT
  3516
  3517	004040'	400300	000000	PGTRO:	SETZ	T1,
  3518	004041'	137300	000063'		DPB	T1, LOPBOP	;CLEAR BLKO-IN-PROGRESS
  3519	004042'	260040	001360'		PUSHJ	P, FRCOHR	;FAKE AN OUTPUT-TERMINATED
  3520	004043'	254000	003274'		JRST	MORLIN
  3521
  3522
  3523				SUBTTL	CIRCUIT ZAPPER
  3524
  3525	004044'	205300	000400	PGZAP:	MOVSI	T1,L2LOWT	;ZAP PTY
  3526	004045'	616305	000027		TDNN	T1,LDBBYT(U)	;IF WAITING FOR ORANGE BALL,
  3527	004046'	332005	000005		SKIPE	LDBBIO(U)	;OR IF BLOCK I/O NEEDS CLEANING-UP,
  3528	004047'	254000	003312'		 JRST	WATLIN		;  WAIT
  3529	004050'	403305	000026		SETZB	T1,LDBLOG(U)	;MARK THIS PORT GONE
  3530	004051'	137300	000154'		DPB	T1,LDPHST	;Clear origination host
  3531	004052'	402005	000030		SETZM	LDBMOD(U)
  3532	004053'	260040	006234'		PUSHJ	P,TSETBO
  3533	004054'	260040	006203'		PUSHJ	P,TSETBI
  3534	004055'	400300	000000		SETZ	T1,
  3535	004056'	137305	000002		DPB	T1,LDBOPB(U)	;CLEAR NEED-OUTPUT
  3536	004057'	261040	000005		PUSH	P,U
  3537	004060'	260040	007675'		PUSHJ	P,PTYBUD	;U/ "BUDDY" LDB
  3538	004061'	336005	000026		SKIPN	LDBLOG(U)	;IF IT'S ALREADY GONE,
  3539	004062'	254000	004065'		 JRST	PGZAP1		;  THERE'S NOTHING MORE TO DO
  3540	004063'	500245	000031		HLL	U,LDBDCH(U)
  3541	004064'	260040	001515'		PUSHJ	P,FRCZAP	;FAKE A ZAPPER THERE
  3542	004065'	262040	000005	PGZAP1:	POP	P,U
  3543	004066'	254000	003304'		JRST	FINLIN
  3544
  3545				;BELL (SHOULDN'T REALLY HAPPEN) - SIMULATE BLACK BALLS
  3546
  3547	004067'	350000	016032'	PGSBL:	AOS	PTYLOS		;COUNT CHARACTER LOST BY US
  3548	004070'	201300	000001		MOVEI	T1, 1
  3549	004071'	260040	001435'		PUSHJ	P, FRCLOS	;"INPUT LOST" TO BELL SENDER
  3550	004072'	261040	000005		PUSH	P, U
  3551	004073'	260040	007675'		PUSHJ	P, PTYBUD
  3552	004074'	201300	000000		MOVEI	T1, 0
  3553	004075'	260040	001435'		PUSHJ	P, FRCLOS	;"OUTPUT LOST" TO OTHER END
  3554	004076'	262040	000005		POP	P, U
  3555	004077'	550205	000000		HRRZ	F,LDBDDB(U)	;Point to TTY DDB (for stopcode processor)
  3556	004100'	256000	016244'		 STOPCD	(.+1,INFO,PTYSBL,,<PTY saw a Black Ball>)
  3557				  ;;PGSBL+10
  3558	004101'	254000	003274'		JRST	MORLIN		;(Fixed in P035/C07 - was a POPJ)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 75
SCNSER.MAC	25-NOV-87 19:52		TYMNET OUTPUT ROUTINES

  3559				SUBTTL TYMNET OUTPUT ROUTINES
  3560
  3561				;THIS ROUTINE IS CALLED TO FINISH UP OUTPUT. IT NONSKIP-RETURNS
  3562				;IF THERE IS NO BUFFER SPACE NOW.
  3563
  3564	004102'	335300	015742'	CLSCHR:	SKIPGE	T1,MXMCNT
  3565	004103'	254000	004123'		 JRST	SETOUT		;WE REALLY DON'T THINK ANY CHRS THERE
  3566	004104'	274300	015740'		SUB	T1,MULCNT+0	;COMPUTE NUMBER OUTPUT
  3567	004105'	322300	000000*		JUMPE	T1,CPOPJ1	;NONE SO MUST STILL BE SPACE
  3568	004106'	337000	015740'		SKIPG	MULCNT+0	;DID WE RUN OUT OF ROOM IN RING
  3569	004107'	370000	015715'		 SOS	CHCNT+0		;YES, ACTUALLY 1 MORE CHR OUT
  3570	004110'	476000	015711'		SETOM	FSCN		;FLAG AS SOME OUTPUT
  3571	004111'	660300	000200		TRO	T1,200		;SET BIT TO FLAG AS DATA TYPE
  3572	004112'	137300	000270'		DPB	T1,OUPTYP	;SET IN TYPE FIELD
  3573	004113'	135400	000153'		LDB	T3,LDPLNO
  3574	004114'	137400	000271'		DPB	T3,OUPLIN	;AND THE PORT NUMBER
  3575	004115'	275300	000173		SUBI	T1,200-5	;COMPUT NUMBER OF WORDS USED
  3576	004116'	242300	777776		LSH	T1,-2
  3577	004117'	270740	000006		ADD	P4,T1
  3578	004120'	405740	000000*	ADVPTR:	ANDI	P4,MSKORG
  3579	004121'	202740	000773*		MOVEM	P4,ORPPDP	;SET FOR 620 TO FIND
  3580	004122'	402000	000633*		SETZM	ORPTIM##	;Reset ORING timer
  3581					PFALL	SETOUT		;AND FIND OUT ABOUT MORE SPACE
  3582
  3583
  3584				;THIS ROUTINE IS CALLED TO SET THINGS UP FOR CHARACTER
  3585				;OUTPUT. NON-SKIP RETURN MEANS NO ROOM IN OUTPUT BUFFER
  3586
  3587	004123'	476000	015742'	SETOUT:	SETOM	MXMCNT		;FLAG THAT NO ROOM THERE
  3588	004124'	476000	015740'		SETOM	MULCNT+0	;Flag that we've been here (no room?)
  3589	004125'	200740	000652*		MOVE	P4,ORP620
  3590	004126'	274740	004121*		SUB	P4,ORPPDP	;SIZE OF SPACE IN OUTPUT RING
  3591					SOJL	P4,[MOVEI P4,MSKORG+1
  3592						SKIPN	ORP620	  ;IF 620 AT 0 CAN NOT
  3593						 MOVEI	P4,MSKORG ;USE LAST WORD
  3594						SUB	P4,ORPPDP ;FIND SPACE TO END OF BUFFER
  3595						JUMPN	P4,.+2	  ;SOME REALLY THERE
  3596	004127'	361740	016247'			POPJ	P,]	  ;NOT REALLY ANY THERE
  3597	004130'	322740	002766*		JUMPE	P4,CPOPJ	;REALLY NO ROOM
  3598	004131'	242740	000002		LSH	P4,2		;CONVERT TO NUMBER OF CHARACTERS
  3599	004132'	275740	000002		SUBI	P4,2		;TAKES TWO FOR COUNT AND PORT
  3600	004133'	303740	000177		CAILE	P4,177		;COUNT MUST FIT IN BYTE SIZE-1
  3601	004134'	201740	000177		 MOVEI	P4,177
  3602	004135'	202740	015740'		MOVEM	P4,MULCNT+0	;SAVE COUNT
  3603	004136'	202740	015742'		MOVEM	P4,MXMCNT	;AND ORIGINAL (SO KNOW HOW MANY SENT)
  3604	004137'	200740	004126*		MOVE	P4,ORPPDP
  3605	004140'	201317	000672*		MOVEI	T1,ORING(P4)
  3606	004141'	505300	241000		HRLI	T1,(POINT 8,0,BYP2);SET TO PUT FIRST IN 3RD BYTE
  3607	004142'	202300	015736'		MOVEM	T1,CHRWRP+0	;SET BYTE POINTER
  3608	004143'	254000	004105*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 76
SCNSER.MAC	25-NOV-87 19:52		TYMNET OUTPUT ROUTINES

  3609				COMMENT !
  3610				TO OUTPUT A CHARACTER INTO THE RING (OR TO A PTY), USE THE CODE:
  3611					UUIDPB T3,CHRWRP(W)	;CHR. IN T3
  3612					SOSLE MULCNT(W)		;SEE IF OUT OF ROOM
  3613					SOSG CHCNT		;OR TIME TO STOP AND CHECK INPUT RING
  3614					 HERE IF WE SHOULD STOP
  3615					 HERE IF WE SHOULD NOT STOP
  3616				!
  3617
  3618				;OUTPUT A FULL WORD FOR SPECIAL TYPES
  3619
  3620	004144'	322500	004146'	WRDOUT:	JUMPE	W, .+2		;IF IT'S A PTY,
  3621	004145'	256000	000000'		 STOPCD 		;  THERE SHOULD BE ONLY CHAR. OUTPUT
  3622	004146'	202717	004140*		MOVEM	P3,ORING(P4)	;PUT THE WORD IN THE OUTPUT BUFFER
  3623	004147'	476000	015711'		SETOM	FSCN
  3624	004150'	211700	000004		MOVNI	P3,4
  3625	004151'	272700	015740'		ADDM	P3,MULCNT+0	;UPDATE REAMAINING COUNTS
  3626	004152'	273700	015742'		ADDB	P3,MXMCNT	;IN CASE WE GO TO CHR OUTPUT
  3627	004153'	321700	016255'		JUMPL	P3,[AOJA P4,ADVPTR]	;WILL GET TO SETOUT, NONSKIP RETURN
  3628	004154'	350000	015736'		AOS	CHRWRP+0
  3629	004155'	271740	000001		ADDI	P4,1		;JUST ADVANCE OUTPUT POINTER
  3630	004156'	405740	004120*		ANDI	P4,MSKORG
  3631	004157'	202740	004137*		MOVEM	P4,ORPPDP	;SET FOR 620 TO FIND
  3632	004160'	254000	004143*		JRST	CPOPJ1
  3633
  3634				;OUTPUT 2 WORDS FOR SPECIAL TYPES.
  3635
  3636	004161'	322500	004163'	WRDOT2:	JUMPE	W,.+2		;IF IT'S A PTY,
  3637	004162'	256000	000000'		 STOPCD 		;  THERE SHOULD BE ONLY CHARACTER OUTPUT
  3638	004163'	202717	004146*		MOVEM	P3,ORING(P4)	;PUT 2ND WORD IN THE OUTPUT BUFFER.
  3639	004164'	476000	015711'		SETOM	FSCN		;FLAG THAT THERE'S SOMETHING TO DO.
  3640	004165'	211700	000010		MOVNI	P3,8		;2 WDS (8 CHARS) TO OUTPUT.
  3641	004166'	272700	015740'		ADDM	P3,MULCNT+0	;UPDATE REMAINING COUNTS
  3642	004167'	273700	015742'		ADDB	P3,MXMCNT	;IN CASE WE GO TO CHR OUTPUT
  3643	004170'	321700	016255'		JUMPL	P3,[AOJA P4,ADVPTR]	;WILL GET TO SETOUT.
  3644	004171'	350000	015736'		AOS	CHRWRP+0	;INCREMENT CHAR BYTE POINTER.
  3645	004172'	350000	015736'		AOS	CHRWRP+0	;INCREMENT IT AGAIN (PAST 2 WORDS).
  3646	004173'	271740	000001		ADDI	P4,1		;INCREMENT ORING OFFSET
  3647	004174'	405740	004156*		ANDI	P4,MSKORG
  3648	004175'	202740	004157*		MOVEM	P4,ORPPDP	;AND INFORM THE BASE.
  3649	004176'	254000	004160*		JRST	CPOPJ1		;SKIP RETURN.
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 77
SCNSER.MAC	25-NOV-87 19:52		NON-CHARACTER OUTPUT MESSAGE HANDLERS

  3650				SUBTTL NON-CHARACTER OUTPUT MESSAGE HANDLERS
  3651
  3652				;DON'T SEND ANY MESSAGES FROM THIS LINE
  3653
  3654	004177'	256000	000000'	PGHSH:	 STOPCD			;HSH NOT USED ON PTYs
  3655	004200'	135300	000077'	GOHSH:	LDB	T1,LOPZAP	;SEE IF ZAP SET
  3656	004201'	336000	000006		SKIPN	T1
  3657					 JRST	[AOS BADGUY	;COUNT BADGUYS THAT TRY TO SEND MESSAGES
  3658	004202'	254000	016256'			JRST WATLIN]	; FROM THIS PORT
  3659	004203'	260040	004403'		PUSHJ	P,CLRTTY	;DO FALSE ZAP STUFF
  3660	004204'	254000	003304'		JRST	FINLIN
  3661
  3662				;SEND TERMINAL CHARACTERISTIC(S)
  3663
  3664	004205'	260040	004102'	GOSTC:	PUSHJ	P, CLSCHR
  3665	004206'	254000	003316'		  JRST	FULLIN		;NO ROOM
  3666	004207'	200405	000046	GOSTC1:	MOVE	T3, LDBTMT(U)	;T3/TRANSMIT BITS
  3667	004210'	243400	004212'		JFFO	T3, .+2		;T4/T.C # TO SEND THIS TIME
  3668	004211'	254000	003274'		JRST	MORLIN		;NONE OR NO MORE
  3669	004212'	205700	074000		MOVSI	P3, TYPI TYPTCS	;MESSAGE TYPE
  3670	004213'	137440	000273'		DPB	T4, WRPCHR	;CHARACTERISTIC NUMBER
  3671	004214'	135311	000030'		LDB	T1, TABTMS(T4)
  3672	004215'	137300	000274'		DPB	T1, WRPCH2	;CHARACTERISTIC VALUE
  3673	004216'	205300	400000		MOVSI	T1, (1B0)
  3674	004217'	213000	000011		MOVNS	T4
  3675	004220'	242311	000000		LSH	T1, (T4)
  3676	004221'	412305	000046		ANDCAM	T1, LDBTMT(U)	;CLEAR THE TRANSMIT BIT
  3677	004222'	135400	000153'		LDB T3,LDPLNO
  3678	004223'	137400	000272'		DPB T3,WRPLIN		;SET PORT NUMBER IN OUTPUT WORD
  3679	004224'	260040	004144'		PUSHJ P,WRDOUT		;SEND IT. IF THERE'S ROOM FOR MORE,
  3680	004225'	254000	004227'		  JRST .+2
  3681	004226'	254000	004207'		JRST GOSTC1		;  GO SEE IF THERE'S MORE TO SEND.
  3682	004227'	332005	000046		SKIPE LDBTMT(U)		;(NO ROOM) IF THERE WERE MORE TO DO,
  3683	004230'	254000	003316'		 JRST FULLIN		;  SAY WE'RE NOT DONE
  3684	004231'	254000	003304'		JRST FINLIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 78
SCNSER.MAC	25-NOV-87 19:52		SEND A RED BALL

  3685				SUBTTL	SEND A RED BALL
  3686
  3687	004232'	205700	036000	GOSRD:	MOVSI P3,TYPI TYPRED
  3688	004233'	254000	004250'		JRST FMTB
  3689
  3690				;SEND A CHARACTER GOBBLER
  3691
  3692	004234'	205700	024000	GOCGB:	MOVSI P3,TYPI TYPGOB
  3693	004235'	254000	004250'		JRST FMTB
  3694
  3695				;SEND A TERMINAL CHARACTERISTICS PROBE
  3696
  3697	004236'	205700	076000	GOSTP:	MOVSI P3,TYPI TYPTCP	;PROBE
  3698	004237'	201400	000077		MOVEI T3,TMCALL		;FOR ALL
  3699	004240'	137400	000273'		DPB T3,WRPCHR
  3700	004241'	254000	004250'		JRST FMTB
  3701
  3702				;SET ECHO MODE
  3703
  3704	004242'	205700	070000	GOSEC:	MOVSI P3,TYPI TYPECN	;ECHO ON
  3705	004243'	200305	000031		MOVE T1,LDBDCH(U)	;GET BOTH HALVES OF DCH
  3706	004244'	612300	016260'		TDNE T1,[LDLNEC,,LDRDEM];DO WE WANT IT OFF INSTEAD?
  3707	004245'	205700	072000		MOVSI P3,TYPI TYPECF	;(YES)
  3708	004246'	254000	004250'		JRST FMTB
  3709
  3710				;SEND SOFT ZAP (HANG UP PHONE, KEEP CIRCUIT)
  3711
  3712	004247'	205700	044000	GOHNG:	MOVSI	P3, TYPI TYPHNG
  3713					PFALL	FMTB
  3714
  3715				;FMTB -- CALLED WITH P3/ BYTE (8) TYPE, 0, XXX, XXX
  3716				;	 CLOSES CHARACTER MODE, RETURNING TO FULLIN IF NO ROOM,
  3717				;	 DEPOSITS PORT# INTO SECOND BYTE, TRANSMITS THE
  3718				;	 1-WORD MESSAGE, AND RETURNS TO THE OUTPUT DISPATCH
  3719				;FMTB1 -- ASSUMES CALLER HAS ALREADY DONE A CLSCHR
  3720
  3721	004250'	260040	004102'	FMTB:	PUSHJ	P, CLSCHR	;LEAVE CHARACTER MODE. IF NO MORE ROOM,
  3722	004251'	254000	003316'		  JRST	FULLIN		;  RETURN TO OUTPUT DISPATCH
  3723	004252'	135400	000153'	FMTB1:	LDB	T3, LDPLNO	;T3/ PORT #
  3724	004253'	137400	000272'		DPB	T3, WRPLIN	;DEPOSIT IT
  3725	004254'	260040	004144'		PUSHJ	P, WRDOUT	;SEND IT. ROOM FOR MORE?
  3726	004255'	254000	003304'		  JRST	FINLIN		;NO
  3727	004256'	254000	003274'		JRST	MORLIN		;YES
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 79
SCNSER.MAC	25-NOV-87 19:52		SEND BELL

  3728				SUBTTL	SEND BELL
  3729
  3730	004257'	200345	000031	GOSBL:	MOVE	T2, LDBDCH(U)
  3731	004260'	607240	002000		TLNN	U, LDLIMI	;IF IN IMAGE STATE,
  3732	004261'	602340	100000		TRNE	T2, LDRNXO	;OR USER SAYS NO XOFF/XON,
  3733	004262'	254000	003274'		JRST	MORLIN		;  AVOID SENDING BELLS
  3734	004263'	201400	000007		MOVEI	T3, 7		;T3/ ASCII BELL
  3735					PFALL	COMXON
  3736
  3737				;COMXON - CALLED WITH T3/ A CHARACTER AND THE PORT OPEN FOR
  3738				;	   CHARACTER OUTPUT. DEPOSIT THE CHARACTER IN THE BUFFER
  3739				;	   RING AND RETURN TO THE OUTPUT DISPATCH
  3740
  3741	004264'	136412	015736'	COMXON:	UUIDPB	T3, CHRWRP(W)	;DEPOSIT THE CHARACTER
  3742	004265'	373012	015740'		SOSLE	MULCNT(W)
  3743	004266'	377000	015715'		SOSG	CHCNT
  3744	004267'	254000	003304'		 JRST	FINLIN		;NO ROOM FOR MORE
  3745	004270'	254000	003274'		JRST	MORLIN		;ROOM FOR MORE
  3746
  3747				;BACKPRESSURE OFF
  3748
  3749	004271'	201340	200000	GOBPF:	MOVEI	T2, LDRXOS
  3750	004272'	612345	000031		TDNE	T2, LDBDCH(U)	;IF WE SENT AN XOFF,
  3751	004273'	254000	004302'		JRST	GOXON		;  GO SEND AN XON
  3752	004274'	260040	004102'		PUSHJ	P, CLSCHR
  3753	004275'	254000	003316'		  JRST	FULLIN		;NO ROOM FOR MESSAGE
  3754	004276'	201340	400000		MOVEI	T2, LDRBPS
  3755	004277'	412345	000031		ANDCAM	T2, LDBDCH(U)	;TURN OFF BACKPRESSURE-SENT FLAG
  3756	004300'	205700	022000		MOVSI	P3, TYPI TYPOUP	;P3/ MESSAGE TYPE
  3757	004301'	254000	004252'		JRST	FMTB1
  3758
  3759				    ;HERE TO SEND AN XON
  3760
  3761	004302'	412345	000031	GOXON:	ANDCAM	T2, LDBDCH(U)	;CLEAR BACKPRESSURE-SENT FLAG
  3762	004303'	201400	000021		MOVEI	T3, 21		;T3/ ASCII XON
  3763	004304'	254000	004264'		JRST	COMXON		;GO SEND IT
  3764
  3765				;BACKPRESSURE ON
  3766
  3767	004305'	135300	000152'	GOBPN:	LDB	T1, TRMBYP	;T1/ TERMINAL ID #
  3768	004306'	322300	004311'		JUMPE	T1, GOBPN1	;IF AUX CIRCUIT (0), BACKPRESSURE
  3769	004307'	607240	002000		TLNN	U, LDLIMI	;OTHERWISE, IF NOT IMAGE STATE,
  3770	004310'	254000	004317'		JRST	GOXOFF		;  SEND AN XOFF
  3771	004311'	260040	004102'	GOBPN1:	PUSHJ	P, CLSCHR
  3772	004312'	254000	003316'		  JRST	FULLIN		;NO ROOM FOR MESSAGE
  3773	004313'	201340	400000		MOVEI	T2, LDRBPS
  3774	004314'	436345	000031		IORM	T2, LDBDCH(U)	;SET BACKPRESSURE-SENT FLAG
  3775	004315'	205700	020000		MOVSI	P3, TYPI TYPNOP	;P3/ MESSAGE TYPE
  3776	004316'	254000	004252'		JRST	FMTB1
  3777
  3778				   ;HERE TO SEND AN XOFF
  3779
  3780	004317'	201300	100000	GOXOFF:	MOVEI	T1, LDRNXO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 79-2
SCNSER.MAC	25-NOV-87 19:52		SEND BELL

  3781	004320'	201400	200000		MOVEI	T3, LDRXOS
  3782	004321'	616405	000031		TDNN	T3, LDBDCH(U)	;IF WE'VE ALREADY SENT ONE XOFF
  3783	004322'	612305	000031		TDNE	T1, LDBDCH(U)	;OR IF WE MUSTN'T SEND ANY,
  3784	004323'	254000	003274'		JRST	MORLIN		;  JUST SAY WE'VE DONE IT
  3785	004324'	436405	000031		IORM	T3, LDBDCH(U)	;SET XOFF-SENT FLAG
  3786	004325'	201400	000023		MOVEI	T3, 23		;T3/ ASCII XOFF
  3787	004326'	254000	004264'		JRST	COMXON		;GO SEND IT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 80
SCNSER.MAC	25-NOV-87 19:52		SEND CIRCUIT ZAPPER

  3788				SUBTTL	SEND CIRCUIT ZAPPER
  3789
  3790	004327'	205300	000400	GOZAP:	MOVSI	T1,L2LOWT
  3791	004330'	616305	000027		TDNN	T1,LDBBYT(U)	;IF SOMEONE'S WAITING FOR ORANGE BALL
  3792	004331'	332005	000005		SKIPE	LDBBIO(U)	;OR IF BLOCK I/O NEEDS CLEANING-UP,
  3793	004332'	254000	003312'		 JRST	WATLIN		;  WAIT
  3794	004333'	260040	004102'		PUSHJ	P,CLSCHR	;LEAVE CHAR MODE. SKIP IF ROOM.
  3795	004334'	254000	003316'		  JRST	FULLIN		;  MUST WAIT OR NO ROOM
  3796	004335'	550300	000005		HRRZ	T1,U
  3797	004336'	312300	015724'		CAME	T1,OPRLDB	;Check if zapping OPR terminal
  3798	004337'	254000	004350'		 JRST	NOTOPR
  3799	004340'	402000	015724'		SETZM	OPRLDB
  3800	004341'	402000	000000*		SETZM	DEVOPR
  3801	004342'	260040	014170'		PUSHJ	P,OPRFRE	;No more OPR
  3802	004343'	201300	400000		MOVEI	T1,STSHUT	;400000
  3803	004344'	612300	002027*		TDNE	T1,STATES	;IS SYSTEM SHUT?
  3804	004345'	254000	004350'		 JRST	NOTOPR		;YES
  3805	004346'	201300	000132		MOVEI	T1,^D90
  3806	004347'	202300	015732'		MOVEM	T1,OPRTIM	;NO, SET TIMER FOR UNHAPPY MSG
  3807	004350'	607240	040040	NOTOPR:	TLNN	U,LDLAUX!LDLPTY	;THIS ONE WAS NOT COUNTED ANYWAY
  3808	004351'	331005	000026		SKIPL	LDBLOG(U)
  3809	004352'	254000	004360'		 JRST	NOTLIN		;NOT REALLY IN
  3810	004353'	201300	200000		MOVEI	T1,STSUPR	;200000
  3811	004354'	377000	015731'		SOSG	INTERM
  3812	004355'	332000	016010'		SKIPE	DWNFLG
  3813	004356'	334000	000000		 SKIPA			;DO NOT RESET IF COMING DOWN
  3814	004357'	412300	004344*		ANDCAM T1,STATES	;CAN'T BE SUPER SHUT WITH EVERYONE GONE
  3815	004360'			NOTLIN:
  3816					;Here to put ZAP message in the ORING
  3817
  3818	004360'	403305	000026		SETZB	T1,LDBLOG(U)	;CLEAR LOGGED IN INFO
  3819	004361'	137300	000154'		DPB	T1,LDPHST	;Clear origination host
  3820	004362'	402005	000030		SETZM	LDBMOD(U)	;RESET MODE TO LOGIN MODE
  3821	004363'	260040	006234'		PUSHJ	P,TSETBO	;Flush output buffer (free TTY chunks)
  3822	004364'	260040	006203'		PUSHJ	P,TSETBI	;ALSO CLEAR INPUT BUFFER
  3823	004365'	200305	000001		MOVE	T1,LDBLIN(U)
  3824	004366'	623300	400000		TLZE	T1,LNLZIN
  3825	004367'	350000	016043'		 AOS	NZAPOT		;AN IN-ZAP WAS RESPONDED TO
  3826	004370'	202305	000001		MOVEM	T1,LDBLIN(U)
  3827	004371'	403305	000003		SETZB	T1,LDBOUT(U)	;Cancel LOPCGB that was set by TSETBO
  3828	004372'	137305	000002		DPB	T1,LDBOPB(U)	;NOTHING MORE TO DO ON OUTPUT
  3829	004373'	205700	026000		MOVSI	P3,TYPI TYPZAP
  3830	004374'	135340	000153'		LDB	T2,LDPLNO
  3831	004375'	137340	000272'		DPB	T2,WRPLIN	;Port # in 2nd byte
  3832	004376'	303340	003206*		CAILE	T2,RPORTN##
  3833	004377'	256000	000000'		 STOPCD 		;CRASH- ZAPPING BEYOND HIGHEST REAL PORT
  3834	004400'	260040	004144'		PUSHJ	P,WRDOUT	;Store in ORING
  3835	004401'	255000	000000		  JFCL			;Don't care if ORING is now full
  3836	004402'	254000	003304'		JRST	FINLIN		;NOBODY LEFT TO TALK TO
  3837
  3838	004403'	550300	000005	CLRTTY:	HRRZ	T1,U		;FALSE ZAP STUFF FOR REAL TTYs
  3839	004404'	312300	015724'		CAME	T1,OPRLDB
  3840	004405'	254000	004416'		 JRST	NTTOPR
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 80-2
SCNSER.MAC	25-NOV-87 19:52		SEND CIRCUIT ZAPPER

  3841	004406'	402000	015724'		SETZM	OPRLDB		;OPR terminal has been zapped
  3842	004407'	402000	004341*		SETZM	DEVOPR
  3843	004410'	260040	014170'		PUSHJ	P,OPRFRE
  3844	004411'	201300	400000		MOVEI	T1,STSHUT	;400000
  3845	004412'	612300	004357*		TDNE	T1,STATES	;IS SYSTEM SHUT?
  3846	004413'	254000	004416'		 JRST	NTTOPR		;YES
  3847	004414'	201300	000132		MOVEI	T1,^D90
  3848	004415'	202300	015732'		MOVEM	T1,OPRTIM	;NO, SET TIMER FOR UNHAPPY MSG
  3849	004416'	607240	000040	NTTOPR:	TLNN	U,LDLAUX	;THIS ONE WAS NOT COUNTED ANYWAY
  3850	004417'	331005	000026		SKIPL	LDBLOG(U)
  3851	004420'	254000	004426'		 JRST	CLRPTY		;NOT REALLY IN
  3852	004421'	201300	200000		MOVEI	T1,STSUPR	;200000
  3853	004422'	377000	015731'		SOSG	INTERM
  3854	004423'	332000	016010'		SKIPE	DWNFLG
  3855	004424'	334000	000000		 SKIPA			;DO NOT RESET IF COMING DOWN
  3856	004425'	412300	004412*		  ANDCAM T1,STATES	;CAN'T BE SUPER SHUT WITH EVERYONE GONE
  3857	004426'			CLRPTY:				;FALSE ZAP ENTRY FOR PTYs
  3858	004426'	403305	000026		SETZB	T1,LDBLOG(U)	;CLEAR LOGGED IN INFO
  3859	004427'	137300	000154'		DPB	T1,LDPHST	;Clear origination host number
  3860	004430'	402005	000030		SETZM	LDBMOD(U)	;RESET MODE TO LOGIN MODE
  3861	004431'	260040	006234'		PUSHJ	P,TSETBO
  3862	004432'	260040	006203'		PUSHJ	P,TSETBI	;ALSO CLEAR INPUT
  3863	004433'	200305	000001		MOVE	T1,LDBLIN(U)
  3864	004434'	623300	400000		TLZE	T1,LNLZIN
  3865	004435'	350000	016043'		 AOS	NZAPOT		;AN IN-ZAP WAS RESPONDED TO
  3866	004436'	202305	000001		MOVEM	T1,LDBLIN(U)
  3867	004437'	403305	000003		SETZB	T1,LDBOUT(U)	;CLEAR 'SEND SPECIAL MESSAGE' FLAGS
  3868	004440'	137305	000002		DPB	T1,LDBOPB(U)	;NOTHING MORE TO DO ON OUTPUT
  3869	004441'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 81
SCNSER.MAC	25-NOV-87 19:52		HERE ON A DETECTED ZAPPER ANOMALY TO STORE STUFF ABOUT THE PORT

  3870				SUBTTL	HERE ON A DETECTED ZAPPER ANOMALY TO STORE STUFF ABOUT THE PORT
  3871
  3872	004442'	000000	000000	ZBGBUG:	0	;ADDRESS OF THE COUNT INCREMENTED
  3873
  3874	004443'	000000	000000	ZBGLIN:	0	;LDBLIN OF THE OFFENDING PORT
  3875	004444'	000000	000000	ZBGDCH:	0	;LDBDCH
  3876	004445'	000000	000000	ZBGDDB:	0	;LDBDDB
  3877	004446'	000000	000000	ZBGOUT:	0	;LDBOUT
  3878	004447'	000000	000000	ZBGBIT:	0	;OUTPUT BIT
  3879	004450'	000000	000000	ZBGBYT:	0	;LDBBYT
  3880	004451'	000000	000000	ZBGMOD:	0	;LDBMOD
  3881	004452'	000000	000000	ZBGDCX:	0	;LDBDCX
  3882	004453'	000000	000000	ZBGLOG:	0	;LDBLOG
  3883	004454'	000000	000000		0
  3884	004455'	000000	000000		0
  3885	004456'	000000	000000		0
  3886	004457'	000000	000000		0
  3887
  3888	004460'	256000	016261'	ZAPBUG:	 STOPCD (.+1,INFO,ZAPBUG,,<Port not Zapped - *BUG*>)
  3889	004461'	261040	000007		PUSH	P,T2
  3890	004462'	551340	004441'		HRRZI	T2,ZBGBUG-1	;(PDL POINTER)
  3891	004463'	261340	000006		PUSH	T2,T1		;STORE THE COUNTER'S ADDRESS
  3892	004464'	350006	000000		AOS	(T1)		;INCREMENT THE COUNTER
  3893	004465'	261345	000001		PUSH	T2,LDBLIN(U)
  3894	004466'	261345	000031		PUSH	T2,LDBDCH(U)
  3895	004467'	261345	000000		PUSH	T2,LDBDDB(U)
  3896	004470'	261345	000003		PUSH	T2,LDBOUT(U)
  3897	004471'	135305	000002		LDB	T1,LDBOPB(U)
  3898	004472'	261340	000006		PUSH	T2,T1
  3899	004473'	261345	000027		PUSH	T2,LDBBYT(U)
  3900	004474'	261345	000030		PUSH	T2,LDBMOD(U)
  3901	004475'	261345	000026		PUSH	T2,LDBLOG(U)
  3902	004476'	255000	000000	ZAPBG1:	JFCL
  3903	004477'	255000	000000		JFCL
  3904	004500'	255000	000000		JFCL
  3905	004501'	255000	000000		JFCL
  3906	004502'	255000	000000		JFCL
  3907	004503'	255000	000000		JFCL
  3908	004504'	262040	000007		POP	P,T2
  3909	004505'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 82
SCNSER.MAC	25-NOV-87 19:52		BLOCK I/O MESSAGE ROUTINES

  3910				SUBTTL BLOCK I/O MESSAGE ROUTINES
  3911
  3912				;BLOCK INPUT
  3913
  3914	004506'	260040	004550'	GOBIN:	PUSHJ	P, GOBIO1	;INITIAL SETUP
  3915	004507'	254000	003316'		  JRST	FULLIN		;NO ROOM
  3916	004510'	550405	000005		HRRZ	T3, LDBBIO(U)	;T3/ INPUT BUFFER ADDR
  3917				IFCPU (KL),<
  3918	004511'	200310	000001		MOVE	T1, BIOCSH(T3)	;T1/ SWEEP NUMBER
  3919	004512'	312300	000000*		CAME	T1, CSUCNT##	;UNLOAD ALREADY DONE?
  3920					JRST	[
  3921						AOS CSHSAV##	;PAT OURSELVES ON THE BACK
  3922						JRST GOBIN1
  3923	004513'	254000	016264'		]
  3924	004514'	260040	000000*		CSHUNL			;UNLOAD THE CACHE
  3925	004515'	316300	004512*		CAMN	T1, CSUCNT##
  3926	004516'	254000	004515'		 JRST	.-1		;WAIT 'TIL IT'S DONE
  3927	004517'			GOBIN1:>;END IFCPU (KL)
  3928				IFCPU (KS),<CSHIVL>		;INVALIDATE 2020 CACHE
  3929	004517'	205700	114000		MOVSI	P3, TYPI TYPBIN	;P3/ MESSAGE TYPE
  3930	004520'	260040	004560'		PUSHJ	P, GOBIO2	;OUTPUT THE MESSAGE
  3931	004521'	254000	003304'		  JRST	FINLIN		;(NO ROOM FOR MORE)
  3932	004522'	254000	003274'		JRST	MORLIN		;(ROOM FOR MORE)
  3933
  3934				;BLOCK OUTPUT
  3935
  3936	004523'	256000	000000'	GOBOP:	 STOPCD		;(PTYS ONLY)
  3937	004524'	260040	004550'	GOBOT:	PUSHJ	P, GOBIO1	;INITIAL SETUP
  3938	004525'	254000	003316'		  JRST	FULLIN		;NO ROOM
  3939				;"/Patch to check for prior circuit zap on BIO port before output/
  3940	004526'	554405	000005		HLRZ	T3, LDBBIO(U)	;T3/ OUTPUT BUFFER ADDR
  3941	004527'	326400	004534'		JUMPN	T3,GOBOT3	;Must be nonzero
  3942	004530'	205400	400000		MOVSI	T3,LNLZIN	;Has a zapper been seen in the IRING?
  3943	004531'	616405	000001		TDNN	T3,LDBLIN(U)	; ...
  3944	004532'	256000	016266'		 STOPCD (.+1,INFO,BIOZAD,,<Block I/O with Zero Address>);GOBOT+3
  3945	004533'	254000	003304'		JRST	FINLIN		;Say "no room", so zapper can be processed
  3946	004534'			GOBOT3:
  3947				IFCPU (KL),<
  3948	004534'	200310	000001		MOVE	T1, BIOCSH(T3)	;T1/ SWEEP NUMBER
  3949	004535'	312300	000000*		CAME	T1, CSVCNT##	;IF A SWEEP'S ALREADY BEEN DONE,
  3950					 JRST	[
  3951						AOS CSHSAV##	;PAT OURSELVES ON THE BACK
  3952						JRST GOBOT1
  3953	004536'	254000	016271'		]
  3954	004537'	260040	000000*		CSHVAL			;START VALIDATE
  3955	004540'	316300	004535*		CAMN	T1, CSVCNT##
  3956	004541'	254000	004540'		JRST	.-1		;AND WAIT 'TIL IT'S DONE
  3957	004542'			GOBOT1:>;END IFCPU (KL)
  3958	004542'	205300	400000		MOVSI	T1, LDLNOP
  3959	004543'	436305	000031		IORM	T1, LDBDCH(U)	;PREVENT FUTURE OUTPUT UNTIL
  3960								;BLOCK OUTPUT IS COMPLETE
  3961	004544'	205700	110000		MOVSI	P3, TYPI TYPBKO	;P3/ MESSAGE TYPE
  3962	004545'	260040	004560'		PUSHJ	P, GOBIO2	;OUTPUT THE MESSAGE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 82-2
SCNSER.MAC	25-NOV-87 19:52		BLOCK I/O MESSAGE ROUTINES

  3963	004546'	254000	003304'		  JRST	FINLIN		;(NO ROOM FOR MORE)
  3964	004547'	254000	003304'		JRST	FINLIN		;(ROOM FOR MORE BUT CLAIM THERE ISN'T)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 83
SCNSER.MAC	25-NOV-87 19:52		GOBIO1 - CLOSE CHARACTER OUTPUT, THEN SKIP IF THERE ARE

  3965				SUBTTL	GOBIO1 - CLOSE CHARACTER OUTPUT, THEN SKIP IF THERE ARE
  3966				;	   AT LEAST 2 FREE WORDS IN THE OUTPUT RING
  3967
  3968	004550'	260040	004102'	GOBIO1:	PUSHJ	P, CLSCHR	;CLOSE CHARACTER MODE
  3969	004551'	263040	000000		  POPJ	P,		;NO ROOM
  3970	004552'	200300	004175*		MOVE	T1, ORPPDP
  3971	004553'	271300	000002		ADDI	T1, 2
  3972	004554'	405300	004174*		ANDI	T1, MSKORG	;T1/ (PDP PTR + 2) MOD RING SIZE
  3973	004555'	312300	004125*		CAME	T1, ORP620
  3974	004556'	350001	000000		AOS	(P)		;ENOUGH ROOM
  3975	004557'	263040	000000		POPJ	P,
  3976
  3977				;GOBIO2 - CALLED WITH T3/ BUFFER ADDR
  3978				;		       P3/ BYTE (8) TYPE, 0, 0, 0
  3979				;	   DEPOSIT THE PORT# AND BUFFER ADDRESS APPROPRIATELY,
  3980				;	   OUTPUT THE BLOCK INPUT/OUTPUT MESSAGE,
  3981				;	   SKIP-RETURN IF THERE'S ROOM FOR MORE
  3982
  3983	004560'	135300	000153'	GOBIO2:	LDB	T1, LDPLNO	;T1/ PORT#
  3984	004561'	137300	000272'		DPB	T1, WRPLIN	;DEPOSIT IT
  3985	004562'	550310	000005		HRRZ	T1, BIOCHR(T3)	;T1/ CHARACTER COUNT
  3986	004563'	137300	016273'		DPB	T1, [POINT ^D16, P3, BYP4]
  3987	004564'	202717	004163*		MOVEM	P3, ORING(P4)
  3988	004565'	271740	000001		ADDI	P4, 1
  3989	004566'	405740	004554*		ANDI	P4, MSKORG
  3990	004567'	400700	000000		SETZ	P3,
  3991				IFKMC<
  3992					MOVEI	T1,(T3)		;T1/ BUFFER ADDRESS
  3993					PUSHJ	P,SCANBB	;FIND UBA PAGE MATCHING T1
  3994						 STOPCD		;THERE HAS TO BE ONE AT THIS POINT
  3995					ADDI	T2,UBABIO&77	;UBAPAG# + Low 6 BITS OF UBA ADDRESS
  3996					DPB	T2,[POINT 11,T1,26]	;PAGE # OVERLAYS HIGH 11 BITS
  3997					ADDI	T1,BIODAT		;Offset to first Char address
  3998					DPB	T1,[POINT 8,P3,BYP3]	;LOW 8 BITS TO 3RD BYTE POS.
  3999					LSH	T1,-8			;SHIFT TO HIGH 10 BITS
  4000					DPB	T1,[POINT 10,P3,BYP2]	;THE REST IN BYTES 1 & 2
  4001					>;END IFKMC
  4002				IFNKMC<
  4003	004570'	201310	000006		MOVEI	T1, BIODAT(T3)	;T1/ FIRST-CHARACTER ADDR
  4004	004571'	257306	000000	IFNCPU (KI),<MAP	T1,(T1)	;GET PHYSICAL ADDRESS
  4005	004572'	137300	016274'		DPB	T1,[POINT 18,P3,23] ;PUT IT IN
  4006				>;END IFNCPU (KI)
  4007				>;END IFNKMC
  4008				IFCPU (KI),<DPB	T1,[POINT 9,P3,23] ;PUT IN LOW 9 BITS, MAP SMASHES THEM
  4009					MAP	T1,(T1)		;GET PAGE NUMBER
  4010					DPB	T1,[POINT 9,P3,14] ;PUT IN HIGH 9 BITS.
  4011				>;END IFCPU (KI)
  4012	004573'	324740	004161'		PJRST	WRDOT2
  4013
  4014				;TERMINATE BLOCK OUTPUT
  4015
  4016	004574'	260040	004102'	GOTRO:	PUSHJ	P, CLSCHR	;LEAVE CHARACTER MODE. IF NO ROOM,
  4017	004575'	254000	003316'		JRST	FULLIN		;  RETURN TO OUTPUT DISPATCH
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 83-2
SCNSER.MAC	25-NOV-87 19:52		GOBIO1 - CLOSE CHARACTER OUTPUT, THEN SKIP IF THERE ARE

  4018	004576'	205300	400000		MOVSI	T1, LDLNOP
  4019	004577'	436305	000031		IORM	T1, LDBDCH(U)	;SET BACKPRESSURE
  4020	004600'	205700	130000		MOVSI	P3, TYPI TYPORQ	;SEND OUTPUT TERMINATION REQUEST
  4021	004601'	254000	004252'		JRST	FMTB1
  4022
  4023				;TERMINATE BLOCK INPUT
  4024
  4025	004602'	205700	124000	GOTRI:	MOVSI P3,TYPI TYPIRQ	;SET UP BLOCK TERMINATION REQ
  4026	004603'	254000	004250'		JRST	FMTB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 84
SCNSER.MAC	25-NOV-87 19:52		RUBOUT STRING/OUTPUT CHARACTER HANDLERS

  4027				SUBTTL RUBOUT STRING/OUTPUT CHARACTER HANDLERS
  4028
  4029				;SEND RUBOUT CHARACTERS
  4030
  4031	004604'			PGRUB:
  4032	004604'	336005	000025	GORUB:	SKIPN	LDBRBC(U)
  4033	004605'	254000	003274'		JRST	MORLIN		;NO RUBOUT CHARACTERS
  4034	004606'	634600	000014		TDZA	P1, P1		;P1 := -1 IF PRCOUT RUNS OUT OF ROOM
  4035	004607'	254000	003316'		JRST	FULLIN		;OUT OF ROOM
  4036	004610'	200345	000024	CNTRUB:	MOVE	T2, LDBRBO(U)
  4037	004611'	260040	006114'		PUSHJ	P, TTGETC	;GET A CHAR. IF DONE WITH THE CHUNK,
  4038	004612'	260040	006163'		PUSHJ	P, FRECHK	;  FREE IT
  4039	004613'	202345	000024		MOVEM	T2, LDBRBO(U)
  4040	004614'	260040	005324'		PUSHJ	P, PRCOUT	;PRINT THE CHARACTER
  4041					  JRST	[		;NO ROOM
  4042						ADDM	T3, LDBRBO(U)
  4043						JRST	FULLIN
  4044	004615'	254000	016275'		  ]
  4045	004616'	373005	000025		SOSLE	LDBRBC(U)	;IF THERE'RE MORE CHARACTERS,
  4046	004617'	254014	004610'		JRST	CNTRUB(P1)	;  KEEP GOING IF THERE'S ROOM
  4047
  4048				    ;HERE WHEN THERE'RE NO MORE RUBOUT CHARACTERS
  4049
  4050	004620'	402005	000023		SETZM	LDBRBI(U)
  4051	004621'	332345	000024		SKIPE	T2, LDBRBO(U)
  4052	004622'	260040	006047'		PUSHJ	P, FREUP
  4053	004623'	402005	000024		SETZM	LDBRBO(U)	;CLEAN UP THE BUFFERLETS
  4054	004624'	321600	003304'		JUMPL	P1, FINLIN	;NO ROOM
  4055	004625'	254000	003274'		JRST	MORLIN		;MORE ROOM
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 85
SCNSER.MAC	25-NOV-87 19:52		SEND OUTPUT CHARACTERS

  4056				SUBTTL	SEND OUTPUT CHARACTERS
  4057
  4058	004626'			PGOUT:
  4059	004626'	336005	000021	GOOUT:	SKIPN	LDBTOC(U)
  4060	004627'	254000	003274'		 JRST	MORLIN
  4061	004630'	634600	000014		TDZA	P1,P1		;P1 := -1 IF PRCOUT RUNS OUT OF ROOM
  4062	004631'	254000	004651'		 JRST	CLNOC
  4063	004632'	200345	000020	CNTOUT:	MOVE	T2,LDBTOT(U)
  4064	004633'	260040	006114'		PUSHJ	P,TTGETC	;GET A CHAR. IF DONE WITH BUFFERLET,
  4065	004634'	260040	006163'		  PUSHJ	P,FRECHK	;  FREE IT
  4066	004635'	202345	000020		MOVEM	T2,LDBTOT(U)
  4067	004636'	260040	005324'		PUSHJ	P,PRCOUT	;PRINT THE CHARACTER
  4068					 JRST	[		;OUT OF ROOM
  4069						ADDM T3,LDBTOT(U)
  4070						JRST CLNOCP
  4071	004637'	254000	016277'		 ]
  4072	004640'	373345	000021		SOSLE	T2,LDBTOC(U)	;IF THERE'RE MORE CHARACTERS,
  4073	004641'	254014	004632'		 JRST	CNTOUT(P1)	;  CONTINUE IF THERE'S ROOM
  4074
  4075				    ;HERE WHEN THERE'RE NO MORE OUTPUT CHARACTERS
  4076
  4077	004642'	260040	006070'		PUSHJ	P,XMTWAK	;WAKE THE JOB UP
  4078	004643'	550340	000005		HRRZ	T2,U
  4079	004644'	316340	015724'		CAMN	T2,OPRLDB	;IS THIS OPR?
  4080	004645'	260040	014170'		 PUSHJ	P,OPRFRE	;RESTART WAITERS FOR SETUUO
  4081	004646'	321600	003304'		JUMPL	P1,FINLIN	;NO MORE ROOM
  4082	004647'	254000	003274'		JRST	MORLIN		;MORE ROOM
  4083
  4084				    ;HERE WHEN CHARACTER OUTPUT RUNS OUT OF ROOM TO DECIDE
  4085				    ;WHETHER TO WAKE THE JOB UP NOW
  4086
  4087	004650'	200345	000021	CLNOCP:	MOVE	T2,LDBTOC(U)
  4088	004651'	335005	000032	CLNOC:	SKIPGE	LDBDCX(U)	;IF IT'S A FAST LINE,
  4089	004652'	311340	016024'		CAML	T2,OWK120	;AND UNDER THE FAST MINIMUM,
  4090	004653'	315340	016022'		CAMGE	T2,OWK30	;OR IF IT'S UNDER THE SLOW MINIMUM,
  4091	004654'	260040	006070'		 PUSHJ	P,XMTWAK	;  WAKE THE JOB UP
  4092	004655'	254000	003316'		JRST	FULLIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 86
SCNSER.MAC	25-NOV-87 19:52		ECHO LOGIC

  4093				SUBTTL ECHO LOGIC
  4094
  4095				;YELLOW BALL
  4096
  4097	004656'	260040	004102'	GOSYL:	PUSHJ	P,CLSCHR	;LEAVE CHARACTER MODE
  4098	004657'	254000	003316'		  JRST	FULLIN		;NO ROOM
  4099	004660'	205300	000400		MOVSI	T1,L2LOWT
  4100	004661'	436305	000027		IORM	T1,LDBBYT(U)	;SAY WE'RE WAITING
  4101	004662'	205300	002000		MOVSI	T1,L2LOWS
  4102	004663'	412305	000027		ANDCAM	T1,LDBBYT(U)	;AND THAT WE HAVEN'T SEEN ONE
  4103	004664'	205700	040000		MOVSI	P3,TYPI TYPYEL
  4104	004665'	254000	004252'		JRST	FMTB1
  4105
  4106				;GREEN (GOSGR) AND ORANGE (GOSOG) BALLS
  4107
  4108	004666'	205700	034000	GOSGR:	MOVSI	P3,TYPI TYPGRN
  4109	004667'	334000	000000		SKIPA
  4110	004670'	205700	042000	GOSOG:	MOVSI	P3,TYPI TYPORG
  4111	004671'	205340	004000		MOVSI	T2,L2LDEL
  4112	004672'	616345	000027		TDNN	T2,LDBBYT(U)	;IF WE'RE IN \...
  4113	004673'	260040	004676'		 PUSHJ	P,WTCHK		;OR IF WE'RE NOT IN INPUT WAIT,
  4114	004674'	254000	003312'		  JRST	WATLIN		;  WAIT
  4115	004675'	254000	004250'		JRST	FMTB		;GO SEND IT
  4116
  4117				;WTCHK - SKIP IF TTY IN INPUT WAIT
  4118
  4119	004676'	603240	020000	WTCHK:	TLNE	U,LDLCOM
  4120	004677'	254000	000000*		 JRST	CMDCKW##	;SPECIAL CHECK IF AT COMMAND LEVEL
  4121				;	HRRZ	T1,LDBBIO(U)
  4122				;	JUMPN	T1,CPOPJ
  4123	004700'	205200	010000		MOVSI	F,L2LLDF
  4124	004701'	612205	000027		TDNE	F,LDBBYT(U)	;IF LEAVE DEF ECHO BIT ON
  4125	004702'	254000	004176*		 JRST	CPOPJ1		;ALWAYS GET OUT
  4126	004703'	550205	000000		HRRZ	F,LDBDDB(U)
  4127	004704'	322200	004702*		JUMPE	F,CPOPJ1	;NO JOB, TAKE A CHANCE
  4128	004705'	200004	000002		MOVE	S,DEVIOS(F)
  4129	004706'	602000	010000		TRNE	S,IOACT
  4130	004707'	603000	400000		TLNE	S,TTYOUW
  4131	004710'	263040	000000		 POPJ	P,		;NOT IN WAIT OR IN OUTPUT WAIT
  4132	004711'	254000	004704*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 87
SCNSER.MAC	25-NOV-87 19:52		ECHO CHARACTER OUTPUT

  4133				SUBTTL	ECHO CHARACTER OUTPUT
  4134
  4135	004712'			PGECO:
  4136	004712'	336005	000014	GOECO:	SKIPN	LDBECC(U)
  4137	004713'	254000	003274'		 JRST	MORLIN		;NO CHARACTERS
  4138	004714'	260040	004676'		PUSHJ	P,WTCHK		;IF WE AREN'T IN INPUT WAIT,
  4139					  JRST	[JUMPL	U,GOLIN3	;Don't wake if backpressured
  4140	004715'	254000	016301'			 JRST WATLIN]		;  WAIT UNTIL WE ARE
  4141	004716'	634600	000014		TDZA	P1,P1		;THIS USED THE SAME TRICK AS OUTPUT
  4142	004717'	254000	003316'		 JRST	FULLIN		;WILL GET HERE WHEN OUT OF ROOM
  4143	004720'	200345	000013	CNTECO:	MOVE	T2,LDBECT(U)
  4144	004721'	260040	006114'		PUSHJ	P,TTGETC
  4145	004722'	255000	000000		 JFCL			;DON'T CARE ABOUT BOUNDARIES
  4146	004723'	202345	000013		MOVEM	T2,LDBECT(U)
  4147	004724'	602400	000400		TRNE	T3,400
  4148					 JRST	[MOVEI T1,5	;SET MODE 5 FOR IMAGE CHR
  4149	004725'	254000	016303'			JRST ECHRPT]
  4150	004726'	602400	000200		TRNE	T3,200
  4151	004727'	334710	000105'		 SKIPA	P3,CHRTAB-200(T3)
  4152	004730'	200710	000305'		MOVE	P3,CHRTAB(T3)
  4153	004731'	135300	000301'		LDB	T1,CHPECH	;GET ECHO TYPE
  4154	004732'	135340	000175'	ECHRPT:	LDB	T2,LDPMEC	;AND LINE MODE
  4155	004733'	256006	004744'		XCT	ECHTAB(T1)	;USUALLY LOADS T1 WITH ADDRESS
  4156	004734'	254006	000000		JRST	(T1)		;GO THERE
  4157
  4158				;HERE WHEN THERE'S NOT ENOUGH OUTPUT RING SPACE: BACK UP
  4159				;THE ECHO POINTER AND REPORT NON-COMPLETION TO THE DISPATCHER
  4160
  4161	004735'	272405	000013	ECHBAK:	ADDM	T3,LDBECT(U)	;BACK UP POINTER
  4162	004736'	254000	003316'		JRST	FULLIN
  4163
  4164				;HERE TO SEE IF THERE ARE MORE CHARACTERS TO BE ECHOED
  4165
  4166	004737'	373005	000014	ECHLST:	SOSLE	LDBECC(U)	;IF THERE ARE MORE TO ECHO,
  4167	004740'	254014	004720'		 JRST	CNTECO(P1)	;  CONTINUE
  4168	004741'	321600	003304'		JUMPL	P1,FINLIN	;OTHERWISE, IF THERE'S OUTPUT RING SPACE,
  4169	004742'	260040	013245'		PUSHJ	P,BPXOFF	;  CLEAR BACKPRESSURE (WHY NOW?)
  4170	004743'	254000	003274'		JRST	MORLIN		;  AND RETURN TO OUTPUT DISPATCH
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 88
SCNSER.MAC	25-NOV-87 19:52		ECHO DISPATCH TABLES

  4171				SUBTTL	ECHO DISPATCH TABLES
  4172
  4173	004744'	254000	005111'	ECHTAB:	JRST ECHSPA		; 0 - SPECIAL ACTION
  4174	004745'	554307	004754'		HLRZ T1,ECHT12(T2)	; 1 - NONBREAK: PRINT & COUNT
  4175	004746'	550307	004754'		HRRZ T1,ECHT12(T2)	; 2 - BREAK: NO PRINT, NO COUNT
  4176	004747'	554307	004760'		HLRZ T1,ECHT34(T2)	; 3 - BREAK: PRINT, NO COUNT
  4177	004750'	550307	004760'		HRRZ T1,ECHT34(T2)	; 4 - BREAK2: PRINT & COUNT
  4178	004751'	554307	004764'		HLRZ T1,ECHT56(T2)	; 5 - IMAGE MODE CHARACTER
  4179	004752'	550307	004764'		HRRZ T1,ECHT56(T2)	; 6 - BREAK: PRINT & COUNT
  4180	004753'	550307	004770'		HRRZ T1,ECHT7(T2)	; 7 - BREAK2: NO PRINT, NO COUNT
  4181
  4182	004754'	004774'	005006'	ECHT12:	EACT1,,EACT2	; 0 - COMMAND MODE
  4183	004755'	005036'	005064'		EACT6,,EACT12	; 1 - BREAK-ON-ALL
  4184	004756'	005024'	005064'		EACT10,,EACT12	; 2 - BREAK NORMALLY
  4185	004757'	005024'	005064'		EACT10,,EACT12	; 3 - BREAK-ON-PUNCTUATION
  4186
  4187	004760'	005012'	005014'	ECHT34:	EACT3,,EACT4
  4188	004761'	005067'	005073'		EACT13,,EACT14
  4189	004762'	005067'	005102'		EACT13,,EACT15
  4190	004763'	005067'	005073'		EACT13,,EACT14
  4191
  4192	004764'	005021'	005004'	ECHT56:	EACT5,,EACT16
  4193	004765'	005054'	005060'		EACT7,,EACT17
  4194	004766'	005044'	005060'		EACT11,,EACT17
  4195	004767'	005044'	005060'		EACT11,,EACT17
  4196
  4197	004770'	000000	005016'	ECHT7:	EAC4A
  4198	004771'	000000	005077'		EAC14A
  4199	004772'	000000	005106'		EAC15A
  4200	004773'	000000	005077'		EAC14A
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 89
SCNSER.MAC	25-NOV-87 19:52		COMMAND MODE

  4201				SUBTTL	COMMAND MODE
  4202
  4203				;NONBREAK: PRINT & COUNT
  4204
  4205	004774'	260040	005272'	EACT1:	PUSHJ P,EPCOUT	;DO THE NORMAL OUTPUT THING
  4206	004775'	254000	004735'		 JRST ECHBAK	;MUST BACK UP
  4207	004776'	350445	000012	EACT1B:	AOS T4,LDBTIC(U)
  4208	004777'	305440	000110		CAIGE T4,TIWKC	;ENOUGH TO WAKE UP
  4209	005000'	254000	004737'		 JRST ECHLST	;NO, CHECK MORE CHRS
  4210	005001'	260040	013265'	EACT1A:	PUSHJ P,CMDWAK	;WAKE COMMAND
  4211	005002'	370005	000014		SOS LDBECC(U)	;DECREASE COUNT
  4212	005003'	254000	003312'		JRST WATLIN	;NO MORE ECHO UNTIL WE'RE IN WAIT AGAIN
  4213
  4214				;BREAK: PRINT & COUNT
  4215
  4216	005004'	260040	005272'	EACT16:	PUSHJ P,EPCOUT
  4217	005005'	254000	004735'		 JRST ECHBAK
  4218
  4219				;BREAK: NO PRINT, NO COUNT
  4220
  4221	005006'	561300	000001	EACT2:	HRROI T1,1	;-1 FOR LEFT HALF 1 FOR RIGHT HALF
  4222	005007'	272305	000015		ADDM T1,LDBBKC(U)
  4223	005010'	350005	000012		AOS LDBTIC(U)
  4224	005011'	254000	005001'		JRST EACT1A	;GO WAKE UP
  4225
  4226				;BREAK: PRINT, NO COUNT
  4227
  4228	005012'	260040	005301'	EACT3:	PUSHJ	P,E1IDPB	;OUTPUT IF NOT BACKPRESSURED
  4229	005013'	254000	005006'		JRST EACT2
  4230
  4231				;(EACT4)  BREAK2: PRINT & COUNT
  4232				;(EACT4A) BREAK2: NO PRINT, NO COUNT
  4233
  4234	005014'	260040	005272'	EACT4:	PUSHJ P,EPCOUT
  4235	005015'	254000	004735'		 JRST ECHBAK
  4236	005016'	561300	000001	EAC4A:	HRROI T1,1
  4237	005017'	272305	000016		ADDM T1,LDBBK2(U)
  4238	005020'	254000	004776'		JRST EACT1B
  4239
  4240				;IMAGE
  4241
  4242	005021'	260040	005306'	EACT5:	PUSHJ	P,E2IDPB	;OUTPUT IF NOT BACKPRESSURED
  4243	005022'	211600	000001		MOVNI P1,1	;OUT OF ROOM
  4244	005023'	254000	004776'		JRST EACT1B
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 90
SCNSER.MAC	25-NOV-87 19:52		NONBREAK: PRINT & COUNT; NORMAL OR BREAK2 MODE

  4245				SUBTTL	NONBREAK: PRINT & COUNT; NORMAL OR BREAK2 MODE
  4246
  4247	005024'	603240	000100	EACT10:	TLNE U,LDLNEC		;WORRY ABOUT ECHO
  4248	005025'	254000	005030'		 JRST EAC10A		;NO ECHO
  4249	005026'	260040	005272'		PUSHJ P,EPCOUT
  4250	005027'	254000	004735'		  JRST ECHBAK
  4251	005030'	350445	000012	EAC10A:	AOS T4,LDBTIC(U)
  4252	005031'	307440	000110		CAIG T4,TIWKC
  4253	005032'	254000	004737'		 JRST ECHLST	;DO NOT WAKE UP
  4254	005033'	260040	005750'	EAC10B:	PUSHJ P,USRWAK
  4255	005034'	370005	000014		SOS LDBECC(U)
  4256	005035'	254000	003312'		JRST WATLIN	;NO MORE ECHO UNTIL WE'RE IN WAIT AGAIN
  4257
  4258				;NONBREAK: PRINT & COUNT; BREAK-ON-ALL MODE
  4259
  4260	005036'	603240	000100	EACT6:	TLNE U,LDLNEC
  4261	005037'	254000	005042'		JRST EACT6A
  4262	005040'	260040	005272'		PUSHJ P,EPCOUT
  4263	005041'	254000	004735'		 JRST ECHBAK
  4264	005042'	350005	000012	EACT6A:	AOS LDBTIC(U)
  4265	005043'	254000	005033'		JRST EAC10B
  4266
  4267				;IMAGE; NORMAL OR BREAK2 MODE
  4268
  4269	005044'	603240	000100	EACT11:	TLNE U,LDLNEC
  4270	005045'	254000	005050'		JRST EAC11A
  4271	005046'	260040	005306'		PUSHJ	P,E2IDPB	;OUTPUT IF NOT BACKPRESSURED
  4272	005047'	211600	000001		MOVNI P1,1
  4273	005050'	135300	000177'	EAC11A:	LDB T1,LDPIMB
  4274	005051'	312300	000010		CAME T1,T3
  4275	005052'	254000	005030'		JRST EAC10A	;WAK IF COUNT BIG ENOUGH
  4276	005053'	254000	005042'		JRST EACT6A	;SPECIAL BREAK, WAKE
  4277
  4278				;IMAGE; BREAK-ON-ALL MODE
  4279
  4280	005054'	603240	000100	EACT7:	TLNE U,LDLNEC
  4281	005055'	254000	005042'		JRST EACT6A
  4282	005056'	260040	005301'		PUSHJ	P,E1IDPB	;OUTPUT IF NOT BACKPRESSURED
  4283	005057'	254000	005042'		JRST EACT6A
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 91
SCNSER.MAC	25-NOV-87 19:52		BREAK: PRINT & COUNT; NOT COMMAND MODE

  4284				SUBTTL	BREAK: PRINT & COUNT; NOT COMMAND MODE
  4285
  4286	005060'	603240	000100	EACT17:	TLNE U,LDLNEC
  4287	005061'	254000	005064'		JRST EACT12	;DO NOT ECHO
  4288	005062'	260040	005272'		PUSHJ P,EPCOUT
  4289	005063'	254000	004735'		 JRST ECHBAK
  4290
  4291				;BREAK: NO PRINT, NO COUNT; NOT COMMAND MODE
  4292
  4293	005064'	561300	000001	EACT12:	HRROI T1,1
  4294	005065'	272305	000015		ADDM T1,LDBBKC(U)
  4295	005066'	254000	005042'		JRST EACT6A
  4296
  4297				;BREAK: PRINT, NO COUNT; NOT COMMAND MODE
  4298
  4299	005067'	603240	000100	EACT13:	TLNE U,LDLNEC
  4300	005070'	254000	005064'		JRST EACT12
  4301	005071'	260040	005301'		PUSHJ	P,E1IDPB	;OUTPUT IF NOT BACKPRESSURED
  4302	005072'	254000	005064'		JRST EACT12
  4303
  4304				;(EACT14)  BREAK2: PRINT & COUNT; BREAK-ON-ALL OR BREAK2 MODE
  4305				;(EACT14A) BREAK2: NO PRINT, NO COUNT; BREAK-ON-ALL OR BREAK2 MODE
  4306
  4307	005073'	603240	000100	EACT14:	TLNE U,LDLNEC
  4308	005074'	254000	005077'		JRST EAC14A
  4309	005075'	260040	005272'		PUSHJ P,EPCOUT
  4310	005076'	254000	004735'		 JRST ECHBAK
  4311	005077'	561300	000001	EAC14A:	HRROI T1,1
  4312	005100'	272305	000016		ADDM T1,LDBBK2(U)
  4313	005101'	254000	005042'		JRST EACT6A
  4314
  4315				;(EACT15)  BREAK2: PRINT & COUNT; NORMAL MODE
  4316				;(EACT15A) BREAK2: NO PRINT, NO COUNT; NORMAL MODE
  4317
  4318	005102'	603240	000100	EACT15:	TLNE U,LDLNEC
  4319	005103'	254000	005106'		JRST EAC15A
  4320	005104'	260040	005272'		PUSHJ P,EPCOUT
  4321	005105'	254000	004735'		JRST ECHBAK
  4322	005106'	561300	000001	EAC15A:	HRROI T1,1
  4323	005107'	272305	000016		ADDM T1,LDBBK2(U)
  4324	005110'	254000	005030'		JRST EAC10A
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 92
SCNSER.MAC	25-NOV-87 19:52		SPECIAL ACTION

  4325				SUBTTL	SPECIAL ACTION
  4326
  4327	005111'	135300	000161'	ECHSPA:	LDB T1,LDPMOD
  4328	005112'	135340	000304'		LDB T2,CHPSPE
  4329	005113'	256026	005114'		XCT @ECHSPT(T1)
  4330
  4331	005114'	256007	005120'	ECHSPT:	XCT SPEPDP(T2)
  4332	005115'	256007	005132'		XCT SPE940(T2)
  4333	005116'	256007	005132'		XCT SPE940(T2)
  4334	005117'	256007	005120'		XCT SPEPDP(T2)
  4335
  4336	005120'	254000	005231'	SPEPDP:	JRST SPEUXC	;ECHO ^X RETURN (^C)
  4337	005121'	254000	005144'		JRST SPECR	;RETURN
  4338	005122'	254000	005222'		JRST SPEUX	;ECHO ^X (^U)
  4339	005123'	254000	005170'		JRST SPETAB	;TAB
  4340	005124'	254000	005161'		JRST SPEALT	;33
  4341	005125'	254000	005203'		JRST SPEVM	;V. TAB
  4342	005126'	254000	005203'		JRST SPEVM	;FF
  4343	005127'	254000	005231'		JRST SPEUXC	;ECHO ^X RETURN (^Z)
  4344	005130'	254000	005157'		JRST SPEALP	;175-176
  4345	005131'	254000	005207'		JRST SPEBS	;BACKSPACE
  4346
  4347	005132'	254000	005146'	SPE940:	JRST SPEBRK	;TYPE 2
  4348	005133'	254000	005144'		JRST SPECR	;RETURN
  4349	005134'	254000	005146'		JRST SPEBRK
  4350	005135'	254000	005170'		JRST SPETAB	;TAB
  4351	005136'	254000	005146'		JRST SPEBRK	;33
  4352	005137'	254000	005203'		JRST SPEVM	;V. TAB
  4353	005140'	254000	005203'		JRST SPEVM	;FF
  4354	005141'	254000	005146'		JRST SPEBRK	;TYPE 2
  4355	005142'	254000	005154'		JRST SPEAP1	;175-176
  4356	005143'	254000	005207'		JRST SPEBS	;BACKSPACE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 93
SCNSER.MAC	25-NOV-87 19:52		TREAT AS NONBREAK: PRINT & COUNT

  4357				SUBTTL	TREAT AS NONBREAK: PRINT & COUNT
  4358
  4359	005144'	201300	000001	SPECR:	MOVEI T1,1
  4360	005145'	254000	004732'		JRST ECHRPT	;JUST TURN INTO TYPE 1
  4361
  4362				;TREAT AS BREAK: NO PRINT, NO COUNT
  4363
  4364	005146'	201300	000002	SPEBRK:	MOVEI T1,2
  4365	005147'	254000	004732'		JRST ECHRPT	;TYPE 2
  4366
  4367				;TREAT AS BREAK: PRINT, NO COUNT
  4368
  4369	005150'	201300	000003	SPEBK3:	MOVEI T1,3
  4370	005151'	254000	004732'		JRST ECHRPT	;TYPE 3
  4371
  4372				;TREAT AS BREAK: PRINT & COUNT
  4373
  4374	005152'	201300	000006	SPEBK6:	MOVEI T1,6
  4375	005153'	254000	004732'		JRST ECHRPT	;TYPE 6
  4376
  4377				;RIGHT BRACE OR TILDE IN 940 MODE
  4378
  4379	005154'	607240	000020	SPEAP1:	TLNN U,LDLLCT	;175-176
  4380	005155'	254000	005152'		JRST SPEBK6	;TTY LC, BREAK: PRINT & COUNT
  4381	005156'	254000	005146'		JRST SPEBRK	;TTY NO LC, BREAK: NO PRINT, NO COUNT
  4382
  4383				;RIGHT BRACE OR TILDE IN PDP10 MODE
  4384
  4385	005157'	607240	000020	SPEALP:	TLNN U,LDLLCT
  4386	005160'	254000	005152'		 JRST SPEBK6	;TTY LC, BREAK: PRINT & COUNT
  4387					PFALL SPEALT	;TTY NO LC, EQUIVALENT TO ESC
  4388
  4389				;ESCAPE IN PDP10 MODE
  4390
  4391	005161'	205400	020000	SPEALT:	MOVSI T3,LXLDLR
  4392	005162'	612405	000032		TDNE T3,LDBDCX(U) ;IF USER SUPPRESSING $ ECHO
  4393	005163'	603240	020000		TLNE U,LDLCOM	;OR WE'RE AT COMMAND LEVEL
  4394	005164'	334000	000000		SKIPA		;ECHO A $
  4395	005165'	254000	005146'		JRST SPEBRK
  4396	005166'	201400	000044		MOVEI T3,"$"
  4397	005167'	254000	005152'		JRST SPEBK6	;YES, SAY IT WAS A $
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 94
SCNSER.MAC	25-NOV-87 19:52		HORIZONTAL TAB

  4398				SUBTTL	HORIZONTAL TAB
  4399
  4400	005170'	200305	000027	SPETAB:	MOVE	T1, LDBBYT(U)
  4401	005171'	603300	020000		TLNE	T1, L2LNTB	; NO ECHO?
  4402	005172'	254000	005177'		JRST	SPETB1
  4403	005173'	603300	100000		TLNE	T1, L2LTBK	; BREAK ?
  4404	005174'	254000	005152'		JRST	SPEBK6		; BREAK & ECHO
  4405	005175'	201300	000004		MOVEI	T1, 4
  4406	005176'	254000	004732'		JRST	ECHRPT		; BREAK2 & ECHO
  4407
  4408	005177'	603300	100000	SPETB1:	TLNE	T1, L2LTBK	; BREAK ?
  4409	005200'	254000	005146'		JRST	SPEBRK		; BREAK & NO ECHO
  4410	005201'	201300	000007		MOVEI	T1, 7
  4411	005202'	254000	004732'		JRST	ECHRPT		; BREAK2 & NO ECHO
  4412
  4413				;VERTICAL TAB OR FORMFEED
  4414
  4415	005203'	205300	020000	SPEVM:	MOVSI	T1, L2LNTB
  4416	005204'	616305	000027		TDNN	T1, LDBBYT(U)	; ECHO?
  4417	005205'	254000	005152'		JRST	SPEBK6		; YES
  4418	005206'	254000	005146'		JRST	SPEBRK		; NO
  4419
  4420				;BACKSPACE
  4421
  4422	005207'	200305	000027	SPEBS:	MOVE	T1,LDBBYT(U)
  4423	005210'	135340	000021'		LDB	T2,LDPECH	;REMOTE BS ECHO SET
  4424	005211'	322340	005216'		JUMPE	T2,SPEBS1	;NO, DON'T ECHO
  4425	005212'	607300	040000		TLNN	T1,L2LBBP	;BREAK
  4426	005213'	254000	005152'		JRST	SPEBK6		;BREAK & ECHO
  4427	005214'	201300	000004		MOVEI	T1,4
  4428	005215'	254000	004732'		JRST	ECHRPT		;BREAK2 & ECHO
  4429
  4430	005216'	607300	040000	SPEBS1:	TLNN	T1,L2LBBP	;BREAK
  4431	005217'	254000	005146'		JRST	SPEBRK		;BREAK & NO ECHO
  4432	005220'	201300	000007		MOVEI	T1,7
  4433	005221'	254000	004732'		JRST	ECHRPT		;BREAK2 & NO ECHO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 95
SCNSER.MAC	25-NOV-87 19:52		ECHO <CONTROL CHAR> AS ^<CONTROL CHAR + 100>

  4434				SUBTTL	ECHO <CONTROL CHAR> AS ^<CONTROL CHAR + 100>
  4435
  4436	005222'	607240	020000	SPEUX:	TLNN U,LDLCOM
  4437	005223'	607240	000100		TLNN U,LDLNEC	;ALWAYS DO IT IN COMMAND MODE
  4438	005224'	334000	000000		SKIPA
  4439	005225'	254000	005146'		JRST SPEBRK	;OTHERWISE NOT IF NO ECHO
  4440	005226'	260040	005250'		PUSHJ P,SPEUCM	;COMMON ^X ECHO CODE
  4441	005227'	254000	004735'		 JRST ECHBAK
  4442	005230'	254000	005146'		JRST SPEBRK
  4443
  4444				;ECHO <CONTROL CHAR> AS ^<CONTROL CHAR + 100><CR><LF>
  4445
  4446	005231'	607240	020000	SPEUXC:	TLNN U,LDLCOM	;SAME AS SPEUX BUT ADD RETURN
  4447	005232'	607240	000100		TLNN U,LDLNEC
  4448	005233'	334000	000000		SKIPA
  4449	005234'	254000	005146'		JRST SPEBRK
  4450	005235'	260040	005250'		PUSHJ P,SPEUCM	;ECHO THE ^X
  4451	005236'	254000	004735'		 JRST ECHBAK	;DID NOT MAKE IT
  4452	005237'	200440	005505'		MOVE T4,CRPTR	;GET READY FOR THE RETURN LF
  4453	005240'	321600	005246'		JUMPL P1,SPEUX1	;OUT OF ROOM, MUST USE RUBOUT STRING
  4454	005241'	201400	000000		MOVEI T3,0
  4455	005242'	137400	000171'		DPB T3,LDPPOS	;RESET POSITION
  4456	005243'	260040	005463'		PUSHJ P,SPOFIL
  4457	005244'	254000	005146'		 JRST SPEBRK	;HAVE PUT OUT THE CRLF (OR TO FILLER)
  4458	005245'	254000	005146'		JRST SPEBRK	;SAME
  4459
  4460	005246'	260040	002433'	SPEUX1:	PUSHJ P,RUBSTR
  4461	005247'	254000	005146'		JRST SPEBRK
  4462
  4463				;COMMON CODE FOR SPEUX AND SPEUXC
  4464
  4465	005250'	321240	005273'	SPEUCM:	JUMPL	U,EPCOU1	;CAN'T OUTPUT NOW
  4466	005251'	135440	000171'		LDB T4,LDPPOS
  4467	005252'	271440	000002		ADDI T4,2	;MAKE SURE BOTH FIT ON SAME LINE
  4468	005253'	201400	000136		MOVEI T3,"^"	;THE ^
  4469	005254'	260040	005335'		PUSHJ P,PRCCR	;THIS WILL PUT IN A CRLF IF NEEDED
  4470	005255'	263040	000000		 POPJ P,	;^ NOT SENT, OUT OF ROOM, BACK UP
  4471	005256'	306440	000001		CAIN T4,1	;^ SEND, T4 IS LDPPOS, IF 1 CRLF SENT
  4472					AOJA T4,[DPB T4,LDPPOS	;MUST SET TO 2
  4473	005257'	344440	016305'			JRST .+1]
  4474	005260'	135405	000013		LDB T3,LDBECT(U)	;GET BACK CHARACTER
  4475	005261'	660400	000100		TRO T3,100
  4476	005262'	321600	005266'		JUMPL P1,SPEUC1	;ALREADY OUT OF ROOM, INTO RUBOUT STRING
  4477	005263'	260040	005306'		PUSHJ	P,E2IDPB	;OUTPUT IF NOT BACKPRESSURED
  4478	005264'	211600	000001		MOVNI P1,1
  4479	005265'	254000	004711*		JRST CPOPJ1	;FINISHED
  4480
  4481	005266'	260040	002416'	SPEUC1:	PUSHJ P,ENTRUB
  4482	005267'	201300	000001		MOVEI T1,1
  4483	005270'	137300	000072'		DPB T1,LOPRUB	;SET TO SEND RUBOUT STRING
  4484	005271'	254000	005265*		JRST CPOPJ1	;P1 IS NEG SO WILL FINISH
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 96
SCNSER.MAC	25-NOV-87 19:52		DON'T ECHO IF PORT BACKPRESSURED

  4485				SUBTTL	DON'T ECHO IF PORT BACKPRESSURED
  4486
  4487	005272'	325240	005324'	EPCOUT:	JUMPGE	U,PRCOUT	;DO OUTPUT IF NOT BACKPRESSURED
  4488	005273'	262040	000006	EPCOU1:	POP	P,T1		;FLUSH RETURN ADDR
  4489	005274'	400300	000000		SETZ	T1,
  4490	005275'	137305	000002		DPB	T1,LDBOPB(U)	;TURN OFF NEED OUTPUT
  4491	005276'	205400	110000		MOVSI	T3,110000
  4492	005277'	272405	000013		ADDM	T3,LDBECT(U)	;BACK UP BYTE POINTER
  4493	005300'	254000	003316'		JRST	FULLIN		;GO ON TO NEXT LINE
  4494
  4495	005301'	321240	005273'	E1IDPB:	JUMPL	U,EPCOU1	;CAN'T ECHO NOW
  4496	005302'	136412	015736'		UUIDPB	T3,CHRWRP(W)
  4497	005303'	373012	015740'		SOSLE	MULCNT(W)
  4498	005304'	370000	015715'		SOS	CHCNT
  4499	005305'	263040	000000		POPJ	P,
  4500
  4501	005306'	321240	005273'	E2IDPB:	JUMPL	U,EPCOU1	;CAN'T ECHO NOW
  4502	005307'	136412	015736'		UUIDPB	T3,CHRWRP(W)
  4503	005310'	373012	015740'		SOSLE	MULCNT(W)
  4504	005311'	377000	015715'		SOSG	CHCNT
  4505	005312'	263040	000000		POPJ	P,
  4506	005313'	254000	005271*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 97
SCNSER.MAC	25-NOV-87 19:52		OUTPUT FILLER LOGIC

  4507				SUBTTL OUTPUT FILLER LOGIC
  4508
  4509				;SEND FILLER CHARACTERS
  4510
  4511	005314'			PGFIL:
  4512	005314'	134405	000022	GOFIL:	ILDB	T3, LDBFLP(U)	;T3/ NEXT CHAR, OR 0 IF LDBFLP=0
  4513					JUMPE	T3, [		;IF NO (MORE) CHARACTERS,
  4514						SETZM	LDBFLP(U)	;CLEAR THE POINTER
  4515						JRST	MORLIN
  4516	005315'	322400	016307'		]
  4517	005316'	620400	000200		TRZ	T3, 200		;WHAT IS THIS FOR???
  4518	005317'	136412	015736'		UUIDPB	T3, CHRWRP(W)	;DEPOSIT THE CHARACTER
  4519	005320'	373012	015740'		SOSLE	MULCNT(W)
  4520	005321'	377000	015715'		SOSG	CHCNT
  4521	005322'	254000	003316'		JRST	FULLIN		;NO MORE ROOM
  4522	005323'	254000	005314'		JRST	GOFIL		;BACK FOR MORE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 98
SCNSER.MAC	25-NOV-87 19:52		PRCOUT - CALLED WITH T3/ THE CHARACTER TO PRINT,

  4523				SUBTTL	PRCOUT - CALLED WITH T3/ THE CHARACTER TO PRINT,
  4524				;	   PRINTS THE CHARACTER (MAPPING UPPER CASE TO LOWER
  4525				;	   CASE IF SO ENABLED), INSERTS FREE CRLFS AND
  4526				;	   HT/VT/FF PADDING/SIMULATION CHARACTERS IF NECESSARY.
  4527				;	   IF IT CAN'T PRINT THE CHARACTER, IT NONSKIP-RETURNS
  4528				;	   WITH T3/ 110000,,0 (WITH WHICH THE CALLER CAN BACK UP
  4529				;	   A BYTE POINTER). OTHERWISE, IT SKIP-RETURNS. IT MAY
  4530				;	   SET THE NEED-FILLER BIT, AND IT WILL SET P1 = -1 IF
  4531				;	   THERE'S NO CHARACTER SPACE LEFT.
  4532
  4533	005324'	606400	000400	PRCOUT:	TRNN	T3, 400		;IF IT'S AN IMAGE CHARACTER
  4534	005325'	603240	200000		TLNE	U, LDLSOX	;OR SUPPRESSING OUTPUT TRANSLATION,
  4535	005326'	254000	005364'		JRST	PRCOT3		;  JUST SEND IT
  4536	005327'	602400	000200		TRNE	T3, 200
  4537	005330'	334710	000105'		SKIPA	P3, CHRTAB-200(T3)
  4538	005331'	200710	000305'		MOVE	P3, CHRTAB(T3)	;P3/ CHARACTER-TYPE BITS
  4539	005332'	135300	000276'		LDB	T1, CHPOUT	;T1/ CHARACTER PRINT MODE
  4540					XCT	[
  4541						JRST PROACT	;0 SPECIAL ACTION
  4542						LDB T4, LDPPOS	;1 PRINT AND COUNT 1 CHARACTER-WIDTH
  4543						JRST PRCOT3	;2 PRINT BUT DON'T COUNT
  4544						JRST PROUCC	;3 UPPER CASE ACTION
  4545	005333'	256006	016311'		](T1)
  4546
  4547				    ;HERE ON 1-CHARACTER-WIDE CHARACTERS
  4548
  4549	005334'	340440	000000	PRCOCW:	AOJ	T4,		;T4/ POSITION ON LINE
  4550
  4551				    ;HERE WITH T4/ POSITION, FROM ABOVE AND FROM ECHO CODE,
  4552				    ;TO PRINT A FREE CR IF ONE IS NEEDED, THEN THE CHAR IN T3
  4553
  4554	005335'	135300	000164'	PRCCR:	LDB	T1,LDPWID	;T1/ LINE WIDTH
  4555	005336'	313440	000006		CAMLE	T4,T1		;IF THE LINE ISN'T FULL
  4556	005337'	603240	200200		TLNE	U,LDLNFC!LDLSOX	;OR THE USER DOESN'T WANT FREE CRLFS
  4557	005340'	254000	005362'		 JRST	PRCOT1		;  JUST PRINT THE CHARACTER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 99
SCNSER.MAC	25-NOV-87 19:52		PRCOUT - CALLED WITH T3/ THE CHARACTER TO PRINT,

  4558				    ;HERE TO PRINT A CRLF
  4559
  4560	005341'	200440	005505'		MOVE	T4, CRPTR
  4561	005342'	134340	000011	PRCFIL:	ILDB	T2, T4		;T2/ NEXT CHARACTER
  4562					JUMPE	T2, [		;IF WE'RE DONE,
  4563						MOVEI	T4, 1		;LINE POSITION WILL BE 1
  4564						JRST	PRCOT2		;GO PRINT THE CHARACTER
  4565	005343'	322340	016315'		]
  4566	005344'	136352	015736'		UUIDPB	T2, CHRWRP(W)	;DEPOSIT THE CHARACTER
  4567	005345'	373012	015740'		SOSLE	MULCNT(W)
  4568	005346'	377000	015715'		SOSG	CHCNT
  4569	005347'	254000	005351'		JRST	.+2		;(NO MORE ROOM)
  4570	005350'	254000	005342'		JRST	PRCFIL		;BACK FOR MORE
  4571	005351'	200400	000011		MOVE	T3, T4
  4572	005352'	134400	000010		ILDB	T3, T3		;T3/ THE NEXT CHAR
  4573	005353'	322400	005357'		JUMPE	T3, PRCFL1	;IF IT WASN'T THE TERMINATING NUL,
  4574	005354'	202445	000022		MOVEM	T4, LDBFLP(U)	;  SET THE REST AS FILLER
  4575	005355'	201440	000001		MOVEI	T4, 1
  4576	005356'	137440	000071'		DPB	T4, LOPFIL	;  SET THE NEED-FILLER BIT
  4577	005357'	205400	110000	PRCFL1:	MOVSI	T3, 110000	;(MAGIC SO CALLER CAN BACKUP BYTE PTR)
  4578	005360'	137400	000171'		DPB	T3, LDPPOS	;LINE POSITION := 0
  4579	005361'	263040	000000		POPJ	P,
  4580
  4581	005362'	307440	000377	PRCOT1:	CAIG	T4, 377
  4582	005363'	137440	000171'	PRCOT2:	DPB	T4, LDPPOS
  4583	005364'	136412	015736'	PRCOT3:	UUIDPB	T3, CHRWRP(W)
  4584	005365'	373012	015740'		SOSLE	MULCNT(W)
  4585	005366'	377000	015715'		SOSG	CHCNT
  4586	005367'	474600	000000		SETO	P1,
  4587	005370'	254000	005313*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 100
SCNSER.MAC	25-NOV-87 19:52		HERE ON SPECIAL-ACTION CHARACTERS

  4588				SUBTTL	HERE ON SPECIAL-ACTION CHARACTERS
  4589
  4590	005371'	135340	000277'	PROACT:	LDB T2,CHPSPO
  4591	005372'	256007	005373'		XCT SPOTBL(T2)	;DO CORRECT OUTPUT THING FOR CHR
  4592
  4593	005373'	254000	005400'	SPOTBL:	JRST SPOCR	;RETURN
  4594	005374'	254000	005402'		JRST SPOTAB	;TAB
  4595	005375'	254000	005441'		JRST SPOVT	;VERTICAL TAB
  4596	005376'	254000	005432'		JRST SPOFF	;FORM FEED
  4597	005377'	254000	005450'		JRST SPOBS2	;BACKSPACE
  4598
  4599				;CARRIAGE RETURN
  4600
  4601	005400'	201440	000000	SPOCR:	MOVEI T4,0
  4602	005401'	254000	005363'		JRST PRCOT2	;OUTPUT BUT SET POS TO 0
  4603
  4604				;HORIZONTAL TAB
  4605
  4606	005402'	135300	000171'	SPOTAB:	LDB T1,LDPPOS	;GET CURRENT POSITION
  4607	005403'	660300	000007		TRO T1,7
  4608	005404'	271300	000001		ADDI T1,1	;WHERE IT WILL BE
  4609	005405'	135440	000164'		LDB T4,LDPWID
  4610	005406'	607240	000200		TLNN U,LDLNFC
  4611	005407'	315300	000011		CAMGE T1,T4	;WILL WE OVERFLOW?
  4612	005410'	254000	005415'		 JRST SPOTB0	;NO OR NO CR WANTED
  4613	005411'	201300	000000		MOVEI T1,0
  4614	005412'	137300	000171'		DPB T1,LDPPOS	;SET TO 0 POSITION
  4615	005413'	200440	005505'		MOVE T4,CRPTR
  4616	005414'	254000	005463'		JRST SPOFIL
  4617
  4618	005415'	135440	000171'	SPOTB0:	LDB T4,LDPPOS	;NO CR, GET CURRENT POSITION
  4619	005416'	606300	000400		TRNN T1,400
  4620	005417'	137300	000171'		DPB T1,LDPPOS	;SAVE NEW
  4621	005420'	603240	000010		TLNE U,LDLTAB
  4622	005421'	254000	005425'		JRST SPOTB1	;TTY DOES TABS, JUST FILL
  4623	005422'	405440	000007		ANDI T4,7
  4624	005423'	200451	005555'		MOVE T4,TABPTR(T4)	;GET CORRECT NUMBER
  4625	005424'	254000	005463'		JRST SPOFIL	;AND SEND
  4626
  4627	005425'	135300	000162'	SPOTB1:	LDB T1,LDPFC2
  4628	005426'	606440	000004		TRNN T4,4
  4629	005427'	334446	005540'		SKIPA T4,TBFL2(T1)	;USE LONG FILL
  4630	005430'	200446	005534'		MOVE T4,TBFL(T1)	;OR SHORT FILL
  4631	005431'	254000	005465'		JRST SPOFL1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 101
SCNSER.MAC	25-NOV-87 19:52		FORM FEED

  4632				SUBTTL	FORM FEED
  4633
  4634	005432'	603240	000001	SPOFF:	TLNE U,LDLFRM	;IF TTY DOESN'T DO FORMS,
  4635	005433'	254000	005436'		JRST SPOFF1
  4636	005434'	200440	005520'		MOVE T4,FFFLP
  4637	005435'	254000	005463'		JRST SPOFIL	;  SEND LINEFEEDS
  4638	005436'	135300	000166'	SPOFF1:	LDB T1,LDPFC1	;IF IT DOES,
  4639	005437'	200446	005524'		MOVE T4,FLLFFS(T1)
  4640	005440'	254000	005465'		JRST SPOFL1	;  SEND PAD CHARACTERS
  4641
  4642				;VERTICAL TAB
  4643
  4644	005441'	603240	000001	SPOVT:	TLNE U,LDLFRM	;IF TTY DOESN'T DO VERTICAL TABS,
  4645	005442'	254000	005445'		JRST SPOVT1
  4646	005443'	200440	005523'		MOVE T4,VTFLP
  4647	005444'	254000	005463'		JRST SPOFIL	;  SEND LINEFEEDS
  4648	005445'	135300	000166'	SPOVT1:	LDB T1,LDPFC1	;IF IT DOES,
  4649	005446'	200446	005530'		MOVE T4,FLLVTS(T1)
  4650	005447'	254000	005465'		JRST SPOFL1	;  SEND PAD CHARACTERS
  4651
  4652				;BACKSPACE
  4653
  4654	005450'	260040	005452'	SPOBS2:	PUSHJ	P, SPOBSP	;UPDATE CHAR COLUMN COUNTER
  4655	005451'	254000	005364'		JRST	PRCOT3
  4656
  4657	005452'	205300	001000	SPOBSP:	MOVSI	T1, L2LBSP	;IF NEITHER BS FOR CHAR DELETE
  4658	005453'	612305	000027		TDNE	T1, LDBBYT(U)
  4659	005454'	254000	005457'		JRST	SPOBS1
  4660	005455'	135300	000021'		LDB	T1, LDPECH	;NOR REMOTE BS ECHO
  4661	005456'	322300	004130*		JUMPE	T1, CPOPJ	;THEN DON'T COUNT IT
  4662	005457'	135300	000171'	SPOBS1:	LDB	T1, LDPPOS
  4663	005460'	371000	000006		SOSL	T1
  4664	005461'	137300	000171'		DPB	T1, LDPPOS	;IF POS-1 .ge. 0, POS:=POS-1
  4665	005462'	263040	000000		POPJ	P,
  4666
  4667				;SPOFIL -- CALLED WITH T4/ FILL POINTER. OUTPUT THE FILL CHARACTERS.
  4668				;	   IF THERE'S NOT ENOUGH OUTPUT RING SPACE, SET UP LDPFLP
  4669				;	   TO POINT TO WHAT'S LEFT, SET P1 = -1, AND LET GOFIL
  4670				;	   DO THE REST. SKIP-RETURNS ALWAYS.
  4671				;SPOFL1 -- OUTPUT THE CHAR IN T3, THEN THE T4 STRING
  4672
  4673	005463'	134400	000011	SPOFIL:	ILDB	T3, T4		;T3/ NEXT CHAR
  4674	005464'	322400	005370*		JUMPE	T3, CPOPJ1	;DONE
  4675	005465'	136412	015736'	SPOFL1:	UUIDPB	T3, CHRWRP(W)	;DEPOSIT IT
  4676	005466'	373012	015740'		SOSLE	MULCNT(W)
  4677	005467'	377000	015715'		SOSG	CHCNT
  4678	005470'	254000	005472'		JRST	.+2		;(NO ROOM)
  4679	005471'	254000	005463'		JRST	SPOFIL		;BACK FOR MORE
  4680	005472'	474600	000000		SETO	P1,		;SET NO-MORE-ROOM FLAG
  4681	005473'	200400	000011		MOVE	T3, T4
  4682	005474'	134400	000010		ILDB	T3, T3		;T3/ NEXT CHAR
  4683	005475'	322400	005464*		JUMPE	T3, CPOPJ1	;IF IT WASN'T THE TERMINATING NUL,
  4684	005476'	202445	000022		MOVEM	T4, LDBFLP(U)	;  SET THE REST AS FILLER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 101-2
SCNSER.MAC	25-NOV-87 19:52		FORM FEED

  4685	005477'	201400	000001		MOVEI	T3, 1
  4686	005500'	137400	000071'		DPB	T3, LOPFIL	;  AND SET NEED-FILLER
  4687	005501'	254000	005475*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 102
SCNSER.MAC	25-NOV-87 19:52		FILLER	POINTERS AND VARIOUS ECHO POINTERS

  4688				SUBTTL	FILLER	POINTERS AND VARIOUS ECHO POINTERS
  4689
  4690	005502'	440700	005503'	CCPTR:	POINT 7,CCASC
  4691	005503'			CCASC:	ASCIZ /\^C
  4692	005503'	562750	306424	/
	005504'	000000	000000
  4693
  4694	005505'	170700	005503'	CRPTR:	POINT 7,CCASC,20	;JUST THE RETURN FROM ABOVE
  4695
  4696	005506'	440700	005507'	CUPTR:	POINT 7,CUASC
  4697	005507'			CUASC:	ASCIZ /\^U
  4698	005507'	562752	506424	/
	005510'	000000	000000
  4699
  4700	005511'	440700	005512'	UPARPT:	POINT 7,UPASC
  4701	005512'			UPASC:	ASCIZ /\^
  4702	005512'	562741	505000	/
  4703
  4704	005513'	440700	005514'	COPTR:	POINT 7,COASC
  4705	005514'			COASC:	ASCIZ /\^O
  4706	005514'	562751	706424	/
	005515'	000000	000000
  4707
  4708	005516'	440700	005517'	FLLBSC:	POINT 7,BSLASC
  4709	005517'			BSLASC:	ASCIZ /\
  4710	005517'	560321	200000	/
  4711
  4712	005520'	440700	005521'	FFFLP:	POINT 7,FFLP0		;FILLER FOR SIMULATING FORM FEED
  4713	005521'	050241	205024	FFLP0:	BYTE (7) 12,12,12,12,12,12,12,12,0
	005522'	050241	200000
  4714
  4715	005523'	100700	005521'	VTFLP:	POINT 7,FFLP0,27	;FILLER FOR SIMULATING VERTICAL TAB
  4716
  4717					DEFINE FILLP(N)
  4718				<IF1,<IFG N-FLMX,<FLMX==N>
  4719					0>
  4720				IF2,< XXXQ==<FLMX-N>/5
  4721				XXXR==FLMX-N-<XXXQ*5>
  4722				
  4723				IFE XXXR,<POINT 7,FILERS+XXXQ>
  4724				IFN XXXR,<POINT 7,FILERS+XXXQ,<7*XXXR>-1>>>
  4725
  4726				;THE ABOVE MACRO DEFINES POINTERS INTO A LIST OF FILLERS (377)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 103
SCNSER.MAC	25-NOV-87 19:52		FILLER	POINTERS AND VARIOUS ECHO POINTERS

  4727				IF1,<FLMX==0>
  4728
  4729	005524'	000000	000000	FLLFFS:	0
  4730	005525'	170700	005551'		FILLP ^D12
  4731	005526'	440700	005551'		FILLP ^D15
  4732	005527'	440700	005544'		FILLP ^D40
  4733
  4734	005530'	000000	000000	FLLVTS:	0
  4735	005531'	100700	005552'		FILLP 6
  4736	005532'	440700	005553'		FILLP 5
  4737	005533'	440700	005550'		FILLP ^D20
  4738
  4739	005534'	000000	000000	TBFL:	0
  4740	005535'	100700	005553'		FILLP 1
  4741	005536'	260700	005553'		FILLP 3
  4742	005537'	260700	005553'		FILLP 3
  4743
  4744	005540'	000000	000000	TBFL2:	0
  4745	005541'	170700	005553'		FILLP 2
  4746	005542'	440700	005553'		FILLP 5
  4747	005543'	440700	005553'		FILLP 5
  4748
  4749				;NOW GENERATE FILLERS
  4750
  4751					DEFINE GENFL(X)
  4752				<XXQ==X/5
  4753					REPEAT XXQ,<BYTE (7) 177,177,177,177,177>
  4754				XXQ==X-<XXQ*5>
  4755				IFE XXQ,<0>
  4756				IFE XXQ-1,<BYTE (7) 177>
  4757				IFE XXQ-2,<BYTE (7) 177,177>
  4758				IFE XXQ-3,<BYTE (7) 177,177,177>
  4759				IFE XXQ-4,<BYTE (7) 177,177,177,177>
  4760				>
  4761
  4762	005544'	777777	777776	FILERS:	GENFL (FLMX)
  4763	005545'	777777	777776
  4764	005546'	777777	777776
  4765	005547'	777777	777776
  4766	005550'	777777	777776
  4767	005551'	777777	777776
  4768	005552'	777777	777776
  4769	005553'	777777	777776
  4770	005554'	000000	000000
  4771
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 104
SCNSER.MAC	25-NOV-87 19:52		FILLER	POINTERS AND VARIOUS ECHO POINTERS

  4772	005555'	440700	005565'	TABPTR:	POINT 7,SSPT
  4773	005556'	350700	005565'		POINT 7,SSPT,6		;FILLERS TO SIMULATE TABS WITH SPACES
  4774	005557'	260700	005565'		POINT 7,SSPT,13
  4775	005560'	170700	005565'		POINT 7,SSPT,20
  4776	005561'	100700	005565'		POINT 7,SSPT,27
  4777	005562'	440700	005566'		POINT 7,SSPT+1
  4778	005563'	350700	005566'		POINT 7,SSPT+1,6
  4779	005564'	260700	005566'		POINT 7,SSPT+1,13
  4780
  4781	005565'	201004	020100	SSPT:	BYTE (7) 40,40,40,40,40,40,40,40,0
	005566'	201004	000000
  4782
  4783				;HERE IF CHARACTER IS UPPER CASE
  4784
  4785	005567'	554305	000032	PROUCC:	HLRZ	T1,LDBDCX(U)	;GET LEFT HALF OF DEV CHR EXT WORD
  4786	005570'	602300	010000		TRNE	T1,LXLLCO	;SKIP IF U TO L CASE CONV NOT DESIRED
  4787	005571'	271400	000040		ADDI	T3,40		;CONVERT CHAR TO LOWER CASE
  4788	005572'	135440	000171'		LDB	T4,LDPPOS
  4789	005573'	254000	005334'		JRST	PRCOCW		;PRINT AND COUNT 1 CHARACTER-WIDTH
  4790
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 105
SCNSER.MAC	25-NOV-87 19:52		ONCE A SECOND LOGIC

  4791				SUBTTL ONCE A SECOND LOGIC
  4792
  4793				;THIS ROUTINE IS CALLED EVERY SECOND TO WORRY ABOUT IMAGE MODE
  4794				;TIME OUTS AND TO MAKE SURE THAT SOMEONE WHO IS JUST WAITING
  4795				;FOR SOME SPACE TO FILL HIS OUTPUT BUFFER GETS RESTARTED
  4796
  4797	005574'	205400	000004	SCNSEC::MOVSI	T3,(BV.DBG)	;Get base version and debugging flag
  4798	005575'	616400	000676*		TDNN	T3,BASVER	;Is base being debugged?
  4799	005576'	332000	000000*		SKIPE	CTYDO##		; or running in CONSOLE mode?
  4800	005577'	254000	005634'		 JRST	SCNSC0		;Yes, ignore timeouts
  4801	005600'	200300	000631*		MOVE	T1,KEYTIM##	;Ticks since key was updated
  4802	005601'	200340	000726*		MOVE	T2,IRPTIM##	;Ticks since last input
  4803	005602'	311300	000007		CAML	T1,T2		;Get smaller in T1
  4804	005603'	200300	000007		 MOVE	T1,T2
  4805	005604'	230300	001466*		IDIV	T1,JFYSEC##	;Seconds since last input
  4806				IFCPU(KS),<ND BASTIM,777777>	;Wait a long time on the 2020
  4807			000132		   ND BASTIM,^D90	;1.5 minutes on KI, KL, F3
  4808	005605'	331000	005601*		SKIPL	IRPTIM##	;Only output this message once
  4809	005606'	305300	000132		CAIGE	T1,BASTIM	;Has it been too long?
  4810	005607'	254000	005634'		 JRST	SCNSC0		;No message
  4811	005610'	256000	016317'		 STOPCD (.+1,EVENT,NOBASE,PRTBTM,<No response from BASE>)
  4812	005611'	476000	000675*		SETOM	BASDWN##	;Set flag to mark base down
  4813	005612'	263040	000000		POPJ	P,		;Do something about it next tic
  4814
  4815	005613'	260040	003232*	PRTBTM:	PUSHJ	P,INLMES##	;Called from STOPCD(NOBASE)
  4816	005614'	473364	071312		 ASCIZ /No response from base.  Please reload it.  PDP-10 is still up.
	005615'	717415	767346
	005616'	625014	671336
	005617'	665014	260746
	005620'	625344	020240
	005621'	663134	171712
	005622'	203454	566336
	005623'	607104	064750
	005624'	271004	050210
	005625'	501326	130100
	005626'	647464	071750
	005627'	647315	420352
  4817	005630'	701341	505000	/
  4818	005631'	205300	400000		MOVSI	T1,(1B0)	;Set flag saying NOBASE message output done
  4819	005632'	436300	005605*		IORM	T1,IRPTIM##
  4820	005633'	263040	000000		POPJ	P,
  4821
  4822	005634'			SCNSC0:
  4823				IFKMC<	SKIPE	CRSHWD##	;If location 30 is nonzero,
  4824					 PUSHJ	P,HNGALL	; hang all jobs before halting 2020
  4825					MOVEI	P4,MXLIN##	;FOR EACH LINE
  4826					AOS	DRMTIM		;INC MESSAGE TIMER
  4827					SOSGE	TIMMIN		;KMC MINUTE COUNTER
  4828					 JRST 	[MOVEI T1,^D60
  4829						MOVEM T1,TIMMIN	;SET FOR ONE MINUTE
  4830						PUSHJ P,SCNMIN	;CALLED EVERY MINUTE
  4831						JRST	.+1]
  4832					SOSGE	TIMDRD		;COUNTER FOR SERVICING DOWN DRs
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 105-2
SCNSER.MAC	25-NOV-87 19:52		ONCE A SECOND LOGIC

  4833					 JRST 	[MOVEI T1,^D60
  4834						MOVEM T1,TIMDRD	;SET FOR ONE MINUTE
  4835						PUSHJ P,SCNDRD	;TIMING VARIES BUT IS USUALLY 60
  4836						JRST	.+1]
  4837				>;END IFKMC
  4838	005634'	200300	016045'		MOVE	T1,PTYFLO
  4839	005635'	202300	015741'		MOVEM	T1,MULCNT+1	;LET PTYS OUTPUT SOME MORE
  4840	005636'	333000	015732'		SKIPLE	OPRTIM
  4841	005637'	373000	015732'		SOSLE	OPRTIM		;IF OPER TIMEOUT HAS GONE OFF,
  4842	005640'	254000	005643'		 JRST	SCNSC1
  4843	005641'	201300	000020		MOVEI	T1,ALROPR
  4844	005642'	436300	000000*		IORM	T1,ALR620	;  SET THE ALARM CELL
  4845	005643'	371000	015743'	SCNSC1:	SOSL	TIMOW		;IF ORANGE-BALL-WAIT HAS GONE OFF,
  4846	005644'	254000	005647'		 JRST	SCNSC2
  4847	005645'	201300	000024		MOVEI	T1,OWTIM
  4848	005646'	202300	015743'		MOVEM	T1,TIMOW	;  RESET IT
  4849	005647'	201740	000000*	SCNSC2:	MOVEI	P4,MXLIN##	;(LOOP THROUGH ALL PORTS)
  4850
  4851	005650'	200257	003204*	SECLOP:	MOVE	U,LINTAB(P4)
  4852	005651'	500245	000031		HLL	U,LDBDCH(U)	;U/ DCH BITS,,LDB ADDR
  4853	005652'	550205	000000		HRRZ	F,LDBDDB(U)	;F/ DDB ADDR
  4854	005653'	200305	000030		MOVE	T1,LDBMOD(U)
  4855	005654'	603300	001000		TLNE	T1,LMLBIO	;IF PORT'S IN BLOCK MODE,
  4856					 JRST	[
  4857						PUSHJ	P,BIOCHG	;CHARGE FOR ELAPSED TIME
  4858						MOVEI	T1,LDRBIP	;CHECK TIMEOUT IF PTY BLKI
  4859						JRST	SECLP1
  4860	005655'	254000	016323'		]
  4861	005656'	205300	002000		MOVSI	T1,LDLIMI	;ELSE CHECK TIMEOUT IF IN IMAGE STATE
  4862	005657'	616305	000031	SECLP1:	TDNN	T1,LDBDCH(U)	;IF WE DON'T CARE ABOUT TIMEOUTS,
  4863	005660'	254000	005716'		 JRST	SECLP2		;  SKIP THIS STUFF
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 106
SCNSER.MAC	25-NOV-87 19:52		ONCE A SECOND LOGIC

  4864				    ;CODE TO CHECK THE PER-PORT TIMEOUT FIELD
  4865
  4866	005661'	135400	000170'		LDB	T3,LDPTIM	;T3/ SECONDS REMAINING, OR 0
  4867	005662'	371000	000010		SOSL	T3		;IF IT WASN'T 0,
  4868	005663'	137400	000170'		DPB	T3,LDPTIM	;  DECREMENT IT
  4869	005664'	326400	005716'		JUMPN	T3,SECLP2	;IF IT JUST RAN OUT,
  4870	005665'	201300	010000		MOVEI	T1,LDRBIP
  4871	005666'	616305	000031		TDNN	T1,LDBDCH(U)	;  IF PTY BLOCK INPUT IS IN PROGRESS,
  4872	005667'	254000	005672'		 JRST	SECTM1
  4873	005670'	260040	003677'		PUSHJ	P,PBTIMO	;    TIME IT OUT
  4874	005671'	254000	005716'		JRST	SECLP2
  4875
  4876	005672'	322200	005712'	SECTM1:	JUMPE	F,SECTM3	;  IF NO DDB, FORCE OUT OF IMAGE STATE
  4877	005673'	135300	000177'		LDB	T1,LDPIMB	;  T1/ 0, OR IMAGE BREAK CHAR
  4878	005674'	326300	005700'		JUMPN	T1,SECTM2	;  IF THERE'S NO BREAK CHAR,
  4879	005675'	260040	006364'		PUSHJ	P,IMGCHG	;    CHARGE FOR A WAKEUP
  4880	005676'	260040	015250'		PUSHJ	P,LINTRP	;    SIGNAL A BREAK
  4881	005677'	260040	005750'		PUSHJ	P,USRWAK	;    WAKE THE JOB
  4882	005700'	603240	000040	SECTM2:	TLNE	U,LDLAUX	;  IF IT'S NOT AN AUX CIRCUIT,
  4883	005701'	254000	005716'		 JRST	SECLP2
  4884	005702'	336005	000012		SKIPN	LDBTIC(U)
  4885	005703'	332005	000014		SKIPE	LDBECC(U)	;    IF THERE'RE NO CHARACTERS,
  4886	005704'	254000	005716'		 JRST	SECLP2
  4887	005705'	205000	000040		MOVSI	S,IOEND
  4888	005706'	437004	000002		IORB	S,DEVIOS(F)	;      SET EOF
  4889	005707'	602000	000010		TRNE	S,10
  4890	005710'	602000	000007		TRNE	S,7
  4891	005711'	254000	005716'		 JRST	SECLP2		;      IF IMAGE MODE,
  4892	005712'	205300	002000	SECTM3:	MOVSI	T1,LDLIMI
  4893	005713'	412305	000031		ANDCAM	T1,LDBDCH(U)	;        FORCE OUT OF IMAGE STATE
  4894	005714'	260040	013246'		PUSHJ	P,BPOFF		;        CLEAR BACKPRESSURE
  4895	005715'	260040	007534'		PUSHJ	P,SETLMD	;        FIX LINE MODE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 107
SCNSER.MAC	25-NOV-87 19:52		ONCE A SECOND LOGIC

  4896				    ;THE REST OF THE PER-PORT ONCE-A-SECOND CODE
  4897
  4898	005716'	205300	000400	SECLP2:	MOVSI	T1,L2LOWT
  4899	005717'	336000	015743'		SKIPN	TIMOW		;IF ORANGE-BALL-WAIT TIMER'S GONE OFF
  4900	005720'	616305	000027		TDNN	T1,LDBBYT(U)	;AND PORT'S WAITING FOR ORANGE BALL,
  4901	005721'	254000	005726'		 JRST	SECLP3
  4902	005722'	205300	002000		MOVSI	T1,L2LOWS
  4903	005723'	616305	000027		TDNN	T1,LDBBYT(U)	;  IF WE HAVEN'T BEEN HERE BEFORE,
  4904					 JRST	[
  4905						IORM	T1,LDBBYT(U)	;SET THE ONCE-BEFORE FLAG
  4906						JRST	SECLP3
  4907	005724'	254000	016326'		]
  4908	005725'	260040	001215'		PUSHJ	P,OBFND		;  IF WE HAVE, FAKE AN ORANGE BALL
  4909
  4910				;P035/C06 17-Nov-87 - Watch for lost zappers.
  4911			400000		..==LNLZIN		;CREF this reference to sign bit
  4912	005726'	335005	000001	SECLP3:	SKIPGE	LDBLIN(U)	;Is there an in-zap seen?
  4913					 JRST	[MOVEI  T1,1	    ;Yes
  4914						 LDB    T2,LDBOPB(U);See if it is scheduled to go out
  4915						 DPB    T1,LOPZAP   ;Make sure the "send zap" bit is on
  4916						 DPB    T1,LDBOPB(U); and "need output" is on
  4917						 MOVSI  T1,L2LOWT   ; and orange-ball wait
  4918						 ANDCAM T1,LDBBYT(U); is off
  4919						 SKIPN  T2          ;If it wasn't scheduled,
  4920						  AOS    NZAPRS	   ;Count number of zaps resent
  4921	005727'	254000	016330'			 JRST  .+1]
  4922	005730'	322200	005741'		JUMPE	F,SECLP4	;IF THERE'S A DDB
  4923	005731'	205000	200000		MOVSI	S,TWTSPC
  4924	005732'	616004	000002		TDNN	S,DEVIOS(F)	;AND IT'S WAITING FOR BUFFERLETS
  4925	005733'	254000	005741'		 JRST	SECLP4
  4926	005734'	200300	015712'		MOVE	T1,TTFREN
  4927	005735'	307300	000003		CAIG	T1,TIRSVD	;AND THERE'RE ENOUGH NOW,
  4928	005736'	254000	005741'		 JRST	SECLP4
  4929	005737'	412004	000002		ANDCAM	S,DEVIOS(F)	;  CLEAR BUFFERLET-WAIT BIT
  4930	005740'	260040	006070'		PUSHJ	P,XMTWAK	;  AND AWAKEN JOB
  4931	005741'	367740	005650'	SECLP4:	SOJG	P4,SECLOP	;(CONTINUE WITH NEXT PORT)
  4932	005742'	263040	000000		POPJ	P,
  4933
  4934
  4935	005743'	322200	005456*	BIOCHG:	JUMPE	F,CPOPJ		;CHECK FOR DETACHED JOB.
  4936	005744'	135300	003320*		LDB	T1,PJOBN	;PICK UP HIS JOB NUMBER.
  4937	005745'	350006	000000*		AOS	JBTBET(T1)	;INCREMENT HIS ELAPSED BIO TIME.
  4938	005746'	350000	005745*		AOS	JBTBET		;INCR TOTAL ELAPSED BIO TIME.
  4939	005747'	263040	000000		POPJ	P,		;AND RETURN.
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 108
SCNSER.MAC	25-NOV-87 19:52		MISC STUFF FOR INPUT AND OUTPUT

  4940				SUBTTL MISC STUFF FOR INPUT AND OUTPUT
  4941				;SUBROUTINE TO WAKE UP JOB IF IT IS IN TTY INPUT WAIT. CALL WITH
  4942				;U SET UP. IT WILL SET F AND S AS NEEDED.
  4943
  4944	005750'	550305	000005	USRWAK:	HRRZ	T1,LDBBIO(U)	; DOING BLOCK INPUT ?
  4945	005751'	322300	005775'		JUMPE	T1,USRWK1	; NO
  4946	005752'	335006	000005		SKIPGE	BIOCHR(T1)	; YES. REQUEST IN PROGRESS ?
  4947	005753'	263040	000000		 POPJ	P,		; YES. LEAVE IT ALONE.
  4948	005754'			BIOWAK:
  4949				IFCPU (KL),<
  4950	005754'	603000	000020		TLNE	S,IO		;IF BLOCK INPUT,
  4951	005755'	254000	005775'		 JRST	USRWK1		;(OUTPUT, FORGET IT)
  4952	005756'	550305	000005		HRRZ	T1,LDBBIO(U)	;THEN MUST MAKE SURE EDGES OF DATA NOT IN CACHE
  4953	005757'	322300	005775'		JUMPE	T1,USRWK1
  4954	005760'	271300	000006		ADDI	T1,BIODAT	;GET ADDRESS OF 1ST DATA WORD
  4955	005761'	405300	000777		CSHREF	
  4956	005762'	330020	000000*
  4957	005763'	330020	000001*
  4958	005764'	330020	000002*
  4959	005765'	330020	000003*
  4960						;TAKE THAT 4 WD CHUNK OUT OF THE CACHE
  4961	005766'	550305	000005		HRRZ	T1,LDBBIO(U)	;GET ADDRESS AGAIN
  4962	005767'	271300	000000*		ADDI	T1,BIOCOR*4-1	;ADDRESS OF LAST WORD
  4963	005770'	405300	000777		CSHREF	
  4964	005771'	330020	005762*
  4965	005772'	330020	000001*
  4966	005773'	330020	000002*
  4967	005774'	330020	000003*
  4968						;THAT TAKES CARE OF ADJACENT REFS DURING I/O
  4969				>;END IFCPU (KL)
  4970	005775'	205300	010000	USRWK1:	MOVSI	T1,L2LLDF
  4971	005776'	412305	000027		ANDCAM	T1,LDBBYT(U)	;TURN OFF WHEN USER IS AWAKENED
  4972	005777'	550205	000000		HRRZ	F,LDBDDB(U)	;GET ADDRESS OF ATTACHED F
  4973	006000'	322200	006016'		JUMPE	F,RCVWK1	;IF NONE,SKIP THIS CODE
  4974	006001'	200004	000002		MOVE	S,DEVIOS(F)	;GET STATUS OF TTY FROM F
  4975	006002'	602000	010000		TRNE	S,IOACT		;SINCE IOW MAY NOT BE SET YET
  4976	006003'	603000	400000		TLNE	S,TTYOUW	;YES. FOR INPUT WAIT?
  4977	006004'	254000	006016'		 JRST	RCVWK1		;NO. DONT WAKE JOB.
  4978	006005'	607000	000001	TIWAKE:	TLNN	S,IOW		;IS IOW REALLY SET
  4979	006006'	254000	006017'		 JRST	TIWAKN		;NO
  4980	006007'	200000	016341'		MOVE	S,[XWD IOW,IOACT];YES. CLEAR WAIT BITS
  4981	006010'	413004	000002		ANDCAB	S,DEVIOS(F)	;IN F FOR THIS JOB
  4982	006011'	261040	000006		PUSH	P,T1		;SAVE VOLATILE AC'S
  4983	006012'	261040	000007		PUSH	P,T2		; ..
  4984	006013'	260040	000000*		PUSHJ	P,STTIOD	;SET JOB TO TS STATE
  4985	006014'	262040	000007		POP	P,T2		;RESTORE AC'S
  4986	006015'	262040	000006		POP	P,T1		; ..
  4987	006016'	263040	000000	RCVWK1:	POPJ	P,0		;RETURN FROM RCVWAK
  4988
  4989	006017'	201000	010000	TIWAKN:	MOVEI	S,IOACT
  4990	006020'	413004	000002		ANDCAB	S,DEVIOS(F)	;JUST RESET IOACT
  4991	006021'	263040	000000		POPJ	P,
  4992
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 108-2
SCNSER.MAC	25-NOV-87 19:52		MISC STUFF FOR INPUT AND OUTPUT

  4993	006022'	200305	000031	FULLCQ:	MOVE	T1,LDBDCH(U)
  4994	006023'	607300	020000		TLNN	T1,LDLCOM	;IF NOT CMND MODE
  4995	006024'	616300	016342'		TDNN	T1,[LDLBKA,,LDRFCS];AND HE WANTS TO SEE EDIT CHARS,
  4996	006025'	350001	000000		 AOS	(P)
  4997	006026'	263040	000000		POPJ	P,		;  NONSKIP-RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 109
SCNSER.MAC	25-NOV-87 19:52		SUBROUTINE TO SEE IF A CONTROL C SHOULD BE ACTED ON OR STORED.

  4998				SUBTTL	SUBROUTINE TO SEE IF A CONTROL C SHOULD BE ACTED ON OR STORED.
  4999				;NON-SKIP MEANS STORE IT.
  5000				;SKIP MEANS DO IT.
  5001
  5002	006027'	603240	020000	CNCCHK:	TLNE	U,LDLCOM	;SHOULD ^C BE RETURNED?
  5003	006030'	263040	000000		 POPJ	P,0		;YES.
  5004	006031'	261040	000006		PUSH	P,T1		;MAYBE NOT. SAVE TAC.
  5005	006032'	550205	000000		HRRZ	F,LDBDDB(U)	;GET U'S JOB
  5006	006033'	322200	006043'		JUMPE	F,CNCCK1	;IF NO F ATTACHED, ASSUME SHOULD DO ^C
  5007	006034'	205300	020000		MOVSI	T1,TTYATC
  5008	006035'	616304	000004		TDNN	T1,DEVMOD(F)
  5009	006036'	254000	000000*		 JRST	TPOPJ		;THIS IS A SLAVED TTY
  5010	006037'	135300	005744*		LDB	T1,PJOBN	; ..
  5011	006040'	200306	001117*		MOVE	T1,JBTSTS(T1)	;GET JOB STATUS WORD
  5012	006041'	612300	016343'		TDNE	T1,[XWD JACCT,JACCT2] ;IS ^C LEGAL?
  5013	006042'	254000	006036*		 JRST	TPOPJ		;NO. GIVE IT TO CUSP
  5014	006043'	260040	013475'	CNCCK1:	PUSHJ	P,CNCMOD	;FORCE LINE TO BE AT COMMAND LEVEL
  5015	006044'	201300	000000*		MOVEI	T1,CMFCHT##
  5016	006045'	260040	013276'		PUSHJ	P,TTFORC	;FORCE HALT COMMAND
  5017	006046'	254000	000000*		JRST	TPOPJ1		;RESTORE T1, SKIP RETURN
  5018
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 110
SCNSER.MAC	25-NOV-87 19:52		THIS ROUTINE TRACES BACKWARDS DOWN A LINKED LIST TO THE START

  5019				SUBTTL	THIS ROUTINE TRACES BACKWARDS DOWN A LINKED LIST TO THE START
  5020				;AND THEN ADDS THE WHOLE LIST TO THE FREE LIST. IT IS USED
  5021				;TO KEEP 'UNUSED' CHUNKS FROM SITTING AROUND COLLECTING DUST
  5022				;AND DECREASING THE AMOUNT OF FREE STORAGE.
  5023
  5024	006047'	620340	000003	FREUP:	TRZ	T2,3		;GET BASE ADDRESS
  5025	006050'	554307	000000	FREST:	HLRZ	T1,(T2)		;LOOK FOR BACK LINKS
  5026	006051'	322300	006054'		JUMPE	T1,STLST	;FOUND START
  5027	006052'	200340	000006		MOVE	T2,T1		;TRY SOME MORE
  5028	006053'	254000	006050'		JRST	FREST
  5029
  5030				;JMS 7-May-86 - X95(KS) has a nasty habit of looping here.  Added TTYFLM.
  5031
  5032	006054'	200300	002416*	STLST:	MOVE	T1,TTFREE##	;Pointer to current free list
  5033	006055'	250307	000000		EXCH	T1,(T2)		;Make current chunk point to the old free list
  5034	006056'	552340	006054*		HRRZM	T2,TTFREE##	;Put current chunk at start of free list
  5035	006057'	350000	015712'		AOS	TTFREN		;Mark one more free
  5036	006060'	602300	777777		TRNE	T1,777777	;If there is a next pointer,
  5037	006061'	554346	000000		 HLRZ	T2,(T1)		; get its back pointer
  5038	006062'	621340	777777		TLZ	T2,777777	;Clear LH for compare
  5039	006063'	312340	006056*		CAME	T2,TTFREE##	;Does next point back to current?
  5040	006064'	256000	016344'		 STOPCD (CPOPJ,INFO,TTYFLM,,<TTY Free List Messed Up>)
  5041				 ;;STLST+7
  5042	006065'	550340	000006		HRRZ	T2,T1		;Did current chunk have a next one?
  5043	006066'	326340	006054'		JUMPN	T2,STLST	;Yes, continue until all are freed up
  5044	006067'	263040	000000		POPJ	P,		;All done
  5045
  5046	006070'	550205	000000	XMTWAK:	HRRZ	F,LDBDDB(U)
  5047	006071'	322200	005743*		JUMPE	F,CPOPJ		;NO JOB HOOKED TO IT
  5048	006072'	205000	000400		MOVSI	S,L2LOWT	;IF WAITING FOR ORANGE BALL
  5049	006073'	612005	000027		TDNE	S,LDBBYT(U)
  5050	006074'	263040	000000		 POPJ	P,		;DON'T WAKE UP OUTPUT
  5051	006075'	200004	000002		MOVE	S,DEVIOS(F)
  5052	006076'	607000	040000		TLNN	S,TINFIO
  5053	006077'	254000	006110'		 JRST	XMTWK1
  5054	006100'	135300	000225'		LDB	T1,DDPTTS	;NOW TRAP ON READY FOR MORE OUTPUT
  5055	006101'	261040	000002		PUSH	P,J
  5056	006102'	260040	001731*		PUSHJ	P,TAKTRJ
  5057	006103'	205000	040000		MOVSI	S,TINFIO
  5058	006104'	413004	000002		ANDCAB	S,DEVIOS(F)
  5059	006105'	201100	000400		MOVEI	J,LXRIOS
  5060	006106'	436105	000032		IORM	J,LDBDCX(U)
  5061	006107'	262040	000002		POP	P,J
  5062	006110'	602000	010000	XMTWK1:	TRNE	S,IOACT		;SINCE IOW MAY NOT BE SET YET
  5063	006111'	607000	400000		TLNN	S,TTYOUW
  5064	006112'	263040	000000		 POPJ	P,		;NOT WAITING SO DONE
  5065	006113'	324740	006005'		PJRST	TIWAKE		;WAKE HIM UP
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 111
SCNSER.MAC	25-NOV-87 19:52		CHUNK HANDLERS

  5066				SUBTTL CHUNK HANDLERS
  5067
  5068				;SUBROUTINE TO READ A CHARACTER FROM A TELETYPE BUFFER
  5069				;CALL WITH T2 CONTAINING A BYTE POINTER TO THE LIST
  5070				;THIS ROUTINE WILL IBP T2 WHICH MAY POINT IT INTO A LINK WORD
  5071				;ALSO WE MAY BE CALLED WITH THE POINTER DECREMENTED SO THAT
  5072				;IBP WILL POINT TO THE CURRENT CHUNKS LINK WORD
  5073				;THIS ROUTINE WILL CORRECTLY FOLLOW THE LINKS. THE ROUTINE
  5074				;WILL NORMALLY SKIP RETURN. THE NON-SKIP RETURN IS TAKEN IF
  5075				;IT WAS NECESSARY TO FOLLOW A LINK. IN THIS CASE, T1
  5076				;CONTAINS THE BASE ADDRESS OF THE NEW CHUNK.
  5077				;ON RETURN, T2 CONAINS THE BYTE POINTER TO THE CHARACTER
  5078				;JUST OBTAINED, AND T3 THE CHARACTER
  5079
  5080	006114'	134400	000007	TTGETC:	ILDB	T3,T2		;IF WE GET INTO A LINK WORD, T3 WILL NOT
  5081								;BE WHAT WE WANT BUT NOTHING WILL HAVE
  5082								;BEEN CLOBBERED
  5083	006115'	602340	000003		TRNE	T2,3		;ALL LINK WORDS ARE IN WORDS AT AN ADDRESS
  5084								;WHICH IS A MULTIPLE OF 4
  5085	006116'	254000	005501*		 JRST	CPOPJ1		;ALL OK, JUST RETURN
  5086	006117'	550307	777774		HRRZ	T1,-4(T2)	;THIS WILL BE THE FORWARD LINK TO NEXT CHUNK
  5087	006120'	607340	770000		TLNN	T2,770000	;IF WE ARE AT THE RIGHT END OF THE WORD
  5088								;WE MUST HAVE BACKED UP
  5089	006121'	554307	000000		 HLRZ	T1,(T2)		;SO GET BACK LINK (T2 POINTS TO FIRST WORD OF CHUNK)
  5090	006122'	322300	006131'		JUMPE	T1,TTGC1	;NO LINK THERE
  5091	006123'	540340	000006		HRR	T2,T1		;NOW POINT TO CORRECT WORD
  5092	006124'	603340	770000		TLNE	T2,770000
  5093	006125'	354000	000007		 AOSA	T2		;IF FORWARD, POINT TO FIRST CHR
  5094	006126'	271340	000003		ADDI	T2,3		;IF BACKWARD, TO LAST
  5095	006127'	135400	000007		LDB	T3,T2		;NOW GET THE CHARACTER
  5096	006130'	263040	000000		POPJ	P,		;AND RETURN SAYING PASSED A LINK
  5097
  5098				;Stop at TTYNNC may be related to ZAP (or nonzap) at LDEC
  5099
  5100	006131'	603340	770000	TTGC1:	TLNE	T2,770000	;IS THIS A BACKUP
  5101	006132'	256000	016347'		 STOPCD (FRCZAP,INFO,TTYNNC,,<TTY - No Next Chunk>)
  5102				 ;;TTGC1+1
  5103	006133'	201400	000000		MOVEI	T3,0		;GIVE BACK 0
  5104	006134'	254000	006116*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 112
SCNSER.MAC	25-NOV-87 19:52		SUBROUTINE TO PLACE A CHARACTER IN A BUFFER.

  5105				SUBTTL	SUBROUTINE TO PLACE A CHARACTER IN A BUFFER.
  5106				;CHARACTER IS IN T3. T2 CONTAINS A BYTE POINTER TO LAST
  5107				;CHARACTER PLACED IN BUFFER. WE WANT TO DO AN IDPB T3,T2 BUT
  5108				;MUST WATCH FOR LINKS. WILL FOLLOW A FORWARD LIST IF IT
  5109				;EXISTS OR GET A NEW CHUNK IF NECESSARY
  5110
  5111	006135'	133000	000007	TTPUTC:	IBP	T2		;MUST NOT IDPB SINCE MIGHT CLOBBER SOMETHING
  5112	006136'	602340	000003		TRNE	T2,3		;ARE WE IN A LINK?
  5113	006137'	254000	006161'		 JRST	TTPC1		;NO, ALL OK
  5114	006140'	550307	777774		HRRZ	T1,-4(T2)	;GET LINK
  5115	006141'	607340	770000		TLNN	T2,770000
  5116	006142'	256000	000000'		 STOPCD			;SOMEONE CALLED US AFTER BACKING UP
  5117	006143'	326300	006160'		JUMPN	T1,TTPC2	;HAVE A FORWARD LINK ALREADY
  5118	006144'	337300	006063*		SKIPG	T1,TTFREE##	;GET A NEW CHUNK
  5119	006145'	256000	000000'		 STOPCD			;NONE THERE. SHOULD HAVE BEEN CHECKED
  5120	006146'	261040	000014		PUSH	P,P1		;GET A REGISTER TO WORK WITH
  5121	006147'	550606	000000		HRRZ	P1,(T1)
  5122	006150'	552600	006144*		HRRZM	P1,TTFREE##	;UPDATE FREE POINNTER
  5123	006151'	332000	000014		SKIPE	P1
  5124	006152'	553014	000000		 HRRZS	(P1)		;MAKE SURE NO BACK LINE IF A CHUNK LEFT
  5125	006153'	370000	015712'		SOS	TTFREN		;COUNT CHUNK TAKEN
  5126	006154'	515607	777774		HRLZI	P1,-4(T2)	;GET A BACK LINK
  5127	006155'	202606	000000		MOVEM	P1,(T1)		;TO PUT IN NEW CHUNK
  5128	006156'	542307	777774		HRRM	T1,-4(T2)	;AND PUT IN FORWARD LINK
  5129	006157'	262040	000014		POP	P,P1
  5130	006160'	541346	000001	TTPC2:	HRRI	T2,1(T1)	;NOW RESET BYTE POINTER
  5131	006161'	137400	000007	TTPC1:	DPB	T3,T2		;STORE AWAY CHARACTER
  5132	006162'	263040	000000		POPJ	P,		;ALL DONE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 113
SCNSER.MAC	25-NOV-87 19:52		ROUTINE TO FREE UP A CHUNK OF THE CHARACTER LIST BY LINKING IT

  5133				SUBTTL	ROUTINE TO FREE UP A CHUNK OF THE CHARACTER LIST BY LINKING IT
  5134				;ONTO THE FRONT OF THE FREE-LIST. ASSUMES THAT TTGETC HAS JUST BEEN
  5135				;CALLED SO T1 CONTAINS THE ADDRESS OF THE CHUNK AFTER THE ONE
  5136				;AFTER THE ONE TO RETURN TO THE FREE LIST
  5137
  5138	006163'	261040	000007	FRECHK:	PUSH	P,T2
  5139	006164'	554346	000000		HLRZ	T2,(T1)		;RETRIEVE THE LINK TO THE ONE TO PUT BACK
  5140	006165'	553006	000000		HRRZS	(T1)		;NO BACK LINK IN THIS CHUNK NOW
  5141	006166'	250340	006150*		EXCH	T2,TTFREE##	;PUT OLD ON FREE LIST
  5142	006167'	552360	006166*		HRRZM	T2,@TTFREE##	;RELINK REST OF FREE LIST
  5143	006170'	350000	015712'		AOS	TTFREN
  5144	006171'	262040	000007		POP	P,T2
  5145	006172'	263040	000000		POPJ	P,
  5146
  5147				;ROUTINE TO GET A FREE CHUNK FROM THE FREELIST. SETS UP
  5148				;A BYTE POINTER IN T2. CLOBBERS T1
  5149
  5150	006173'	336340	006167*	GETCHK:	SKIPN	T2,TTFREE##
  5151	006174'	256000	000000'		 STOPCD			;NONE THERE, SHOULD HAVE BEEN CHECKED
  5152	006175'	550307	000000		HRRZ	T1,(T2)		;THE NEXT ELEMENT
  5153	006176'	202300	006173*		MOVEM	T1,TTFREE##	;RESET FREE LIST
  5154	006177'	402007	000000		SETZM	(T2)		;NO LINKS IN THIS ONE
  5155	006200'	505340	001100		HRLI	T2,(POINT 9,0,35) ;POINT SO THAT IBP POINT TO 1ST CHR
  5156	006201'	370000	015712'		SOS	TTFREN		;ONE LESS
  5157	006202'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 114
SCNSER.MAC	25-NOV-87 19:52		TSETBI - CLEAR INPUT BUFFER

  5158				SUBTTL	TSETBI - CLEAR INPUT BUFFER
  5159
  5160	006203'	205300	200000	TSETBI::MOVSI T1,LLLZAP
  5161	006204'	612305	000026		TDNE T1,LDBLOG(U)	;DO NOT ZAP IF TRYING TO GET RID OF HIM
  5162	006205'	263040	000000		 POPJ P,
  5163	006206'	332345	000010		SKIPE T2,LDBTIP(U)	;CLEAR THIS LIST
  5164	006207'	260040	006047'		 PUSHJ P,FREUP		;BUT ONLY IF ONE IS THERE
  5165	006210'	332345	000023		SKIPE T2,LDBRBI(U)	;AND THIS ONE TOO
  5166	006211'	260040	006047'		 PUSHJ P,FREUP
  5167	006212'	402005	000010		SETZM LDBTIP(U)
  5168	006213'	402005	000011		SETZM LDBTIT(U)
  5169	006214'	402005	000012		SETZM LDBTIC(U)
  5170	006215'	402005	000015		SETZM LDBBKC(U)
  5171	006216'	402005	000016		SETZM LDBBK2(U)
  5172	006217'	402005	000007		SETZM LDBBKI(U)
  5173	006220'	402005	000006		SETZM LDBBKP(U)
  5174	006221'	402005	000013		SETZM LDBECT(U)
  5175	006222'	402005	000014		SETZM LDBECC(U)
  5176	006223'	402005	000025		SETZM LDBRBC(U)
  5177	006224'	402005	000024		SETZM LDBRBO(U)
  5178	006225'	402005	000023		SETZM LDBRBI(U)
  5179	006226'	205340	100000		MOVSI T2,LDLECS
  5180	006227'	412345	000031		ANDCAM T2,LDBDCH(U)	;MUST CLEAR COMMAND SYNC BIT
  5181	006230'	500245	000031		HLL U,LDBDCH(U)		;LET PEOPLE KNOW ABOUT IT
  5182	006231'	205340	204000		MOVSI T2,L2LDEL!L2LCCS
  5183	006232'	412345	000027		ANDCAM T2,LDBBYT(U)
  5184	006233'	324740	013245'		PJRST BPXOFF		;GET OUT OF BACKPRESSURE OR XOFF
  5185
  5186				;TSETBO - CLEAR OUTPUT BUFFER
  5187
  5188	006234'	336345	000017	TSETBO:	SKIPN T2,LDBTOP(U)
  5189	006235'	254000	006241'		 JRST TSTBO1
  5190	006236'	606340	777776		TRNN T2,777776		;TO CATCH SPECIAL CASE OF SPARE LINE
  5191	006237'	263040	000000		 POPJ P,
  5192	006240'	260040	006047'		PUSHJ P,FREUP
  5193	006241'	402005	000017	TSTBO1:	SETZM LDBTOP(U)		;OUTPUT PUTTER
  5194	006242'	402005	000021		SETZM LDBTOC(U)		;OUTPUT COUNT
  5195	006243'	402005	000020		SETZM LDBTOT(U)		;OUTPUT TAKER
  5196	006244'	402005	000022		SETZM LDBFLP(U)		;AND FILLERS CURRENTLY GOING
  5197	006245'	550300	000005		HRRZ T1,U
  5198	006246'	316300	015724'		CAMN T1,OPRLDB		;IS THIS OPR
  5199	006247'	260040	014170'		 PUSHJ P,OPRFRE		;YES, MAY NEED TO RESTART JOBS
  5200	006250'	201340	000001		MOVEI T2,1
  5201	006251'	205300	000400		MOVSI T1,L2LOWT
  5202	006252'	616305	000027		TDNN T1,LDBBYT(U)	;IF WE'RE WAITING FOR AN ORANGE BALL,
  5203	006253'	254000	006256'		 JRST TSTBO2
  5204	006254'	412305	000027		ANDCAM T1,LDBBYT(U)	;  STOP WAITING
  5205	006255'	137340	000075'		DPB T2,LOPSYL		;  SEND YELLOW BALL
  5206	006256'	137340	000056'	TSTBO2:	DPB T2,LOPCGB		;SEND GOBBLER
  5207	006257'	205300	400000		MOVSI T1,LDLNOP		;SEND EVEN IF SAYS SHOULD NOT
  5208	006260'	412305	000031		ANDCAM T1,LDBDCH(U)
  5209	006261'	137345	000002		DPB T2,LDBOPB(U)
  5210	006262'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 115
SCNSER.MAC	25-NOV-87 19:52		BUFFERED I/O UUO-LEVEL ROUTINES

  5211				SUBTTL BUFFERED I/O UUO-LEVEL ROUTINES
  5212
  5213				;DISPATCH TABLE FOR MUUO'S AND INITIALIZATION
  5214
  5215	000000			SCNDSP:	PHASE 0
  5216	006263'	000000	000012	DDXZ:	DSPSIZ
  5217	006264'	263040	000000	DDINT:	POPJ P,
  5218	006265'	001000	001000	DBYT:	1000,,1000
  5219	006266'	201300	000016	DVSIZ:	MOVEI T1,SCNDDS
  5220	006267'	254000	015603'	DINI:	JRST TTYINI
  5221	006270'	254000	006134*	DHNG:	JRST CPOPJ1
  5222	006271'	263040	000000	DRL:	POPJ P,
  5223	006272'	254000	000000*	DCL:	JRST OUT
  5224	006273'	254000	006377'	DOU:	JRST TTYOUT
  5225	006274'	254000	006276'	DIN:	JRST TTYIN
  5226	006275'	254000	011032'	DZAP:	JRST AUXZAP
  5227			000012		DSPSIZ==.-1
  5228	006276'				DEPHASE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 116
SCNSER.MAC	25-NOV-87 19:52		INPUT UUO PROCESSOR - CALLED FROM UUOCON ON INPUT M, F SET UP

  5229				SUBTTL	INPUT UUO PROCESSOR - CALLED FROM UUOCON ON INPUT M, F SET UP
  5230
  5231	006276'	260040	012727'	TTYIN:	PUSHJ	P,CKATTI	;MAKE SURE ATTACHED. SET S.
  5232	006277'	254000	000000*		  JRST	ABTUUO		;WAITING FOR AN INTERRUPT. ABORT
  5233					JUMPE	U,[MOVSI S,IOEND
  5234	006300'	322240	016352'			JRST TTYINX]	;ZAPPED AUX CIRCUIT GIVE EOF
  5235	006301'	702600	400000*		NOCHARGE
  5236	006302'	260040	007507'		PUSHJ	P,FIXIMI	;SET IMAGE STATE FROM DATA MODE
  5237	006303'	260040	013051'		PUSHJ	P,TWAITL	;BECOME ATTACHED, WAIT FOR U
  5238								; OR FULL BUFFER CONDITION
  5239	006304'	607240	002000		TLNN	U,LDLIMI	;IMAGE HAS ALREADY CHARGED
  5240	006305'	260040	006343'		PUSHJ	P,SETBRK	;CHARGE FOR A BREAK CHR
  5241	006306'	550304	000007	TTYIN5:	HRRZ	T1,DEVIAD(F)		;PREPARE AND ADDR CHECK THE
  5242	006307'	260040	000000*		PUSHJ	P,BUFCLR		; USER'S BUFFER
  5243	006310'	254000	000000*		  JRST	ADRERR			;OUT OF BOUNDS. STOP JOB.
  5244	006311'	550604	000007		HRRZ	P1,DEVIAD(F)		;PREPARE BYTE POINTER TO STORE
  5245									; THE CHARACTERS IN HIS BUFFER
  5246	006312'	256040	016355'		XCTFU <LDB P2,[POINT 17,(P1),17]>	;BUFFER SIZE IN WORDS
  5247	006313'	275640	000001		SUBI	P2,1			;MINUS LINK
  5248	006314'	550244	000013		HRRZ	U,DDBLDB(F)		;RESTORE U, CLOBBERED IN UUOCON
  5249	006315'	500245	000031		HLL	U,LDBDCH(U)	;ALSO GET BITS
  5250	006316'	550304	000006		HRRZ	T1,DEVBUF(F)	;BUFFER POINTER FOR SIZE
  5251	006317'	260040	006371'		PUSHJ	P,TTYSZS		;SET SIZES
  5252									;FALL INTO MAIN PART OF ROUTINE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 117
SCNSER.MAC	25-NOV-87 19:52		INPUT UUO PROCESSOR - CALLED FROM UUOCON ON INPUT M, F SET UP

  5253
  5254	006320'	260040	012365'	TTYIN1:	PUSHJ	P,TYI			;GET A CHARACTER
  5255	006321'	254000	006326'		  JRST	TTYIN3			; END OF BUFFER.
  5256	006322'	405400	000377		ANDI	T3,377
  5257	006323'	256040	016356'		XCTFU <IDPB T3,P1>			;AND STORE IN USER AREA
  5258	006324'	302340	000002		CAIE	T2,%CHBRK		;A BREAK?
  5259	006325'	367640	006320'		SOJG	P2,TTYIN1			;NO. LOOP FOR MORE, IF ROOM.
  5260	006326'	200644	000007	TTYIN3:	MOVE	P2,DEVIAD(F)		;COMPUTE WORD COUNT FOR UUOCON
  5261	006327'	275615	000001		SUBI	P1,1(P2)			; TO PUT IN BUFFER HEADER.
  5262	006330'	256200	016357'		XCTFU <HRRM P1,1(P2)>			;STORE WITH THE DATA IN RING
  5263	006331'	260040	000000*		PUSHJ	P,ADVBFF			;ON TO NEXT BUFFER
  5264	006332'	334000	000000		  SKIPA				;NO MORE THERE.
  5265	006333'	254000	006337'		JRST	TTYIN6			;MORE TO GO. USE IF IMAGE.
  5266	006334'	205000	000004	TTYIN8:	MOVSI	S,IOFST			;SET VIRGIN BUFFER BIT
  5267	006335'	437004	000002	TTYINX:	IORB	S,DEVIOS(F)		;IN DEV S WORD IN F
  5268	006336'	324740	007103'		PJRST	NOCTRO			;CLEAR CONTROL O. END OF Muuo
  5269
  5270	006337'	602000	000010	TTYIN6:	TRNE	S,I			;IMAGE MODE?
  5271	006340'	337005	000012		SKIPG	LDBTIC(U)		;AND MORE CHARACTERS TO READ?
  5272	006341'	254000	006334'		 JRST	TTYIN8			;NO. QUIT.
  5273	006342'	254000	006306'		JRST	TTYIN5			;YES. GO PASS SOME MORE
  5274
  5275	006343'	603240	002000	SETBRK:	TLNE	U,LDLIMI
  5276	006344'	263040	000000		 POPJ	P,			;IMAGE IS ALREADY CHARGED FOR
  5277	006345'	135100	006037*		LDB	J,PJOBN
  5278	006346'	260040	000000*		PUSHJ	P,GTCGSZ	;GET THE JOB'S CHARGING SIZE.
  5279	006347'	272302	000000*		ADDM	T1,JBTBCS(J)	;ONE BREAK CHR
  5280	006350'	272300	006347*		ADDM	T1,JBTBCS
  5281	006351'	263040	000000		POPJ	P,
  5282
  5283	006352'	135300	000177'	IMGCNT:	LDB	T1,LDPIMB	;GET IMAGE BREAK CHR
  5284	006353'	316300	000010		CAMN	T1,T3	;IS IT THIS ONE?
  5285	006354'	254000	006363'		 JRST	IMGCH1	;YES, GO CHARGE
  5286	006355'	135300	000173'		LDB	T1,LDPCHG
  5287	006356'	271300	000001		ADDI	T1,1
  5288	006357'	301300	000110		CAIL	T1,TIWKC	;ENOUGH GONE BY TO CHARGE?
  5289	006360'	254000	006364'		 JRST	IMGCHG	;YES
  5290	006361'	137300	000173'		DPB	T1,LDPCHG	;NO, JUST RECORD
  5291	006362'	263040	000000		POPJ	P,
  5292
  5293	006363'	201440	000110	IMGCH1:	MOVEI	T4,TIWKC	;SO CALLER WILL THINK MANY CHRS
  5294	006364'	201300	000000	IMGCHG:	MOVEI	T1,0
  5295	006365'	137300	000173'		DPB	T1,LDPCHG	;SET CHARGE COUNTER TO 0
  5296	006366'	550205	000000		HRRZ	F,LDBDDB(U)
  5297	006367'	322200	006071*		JUMPE	F,CPOPJ	;NO LINE
  5298	006370'	254000	006343'		JRST	SETBRK	;GO CHARGE FOR 1 BCS
  5299
  5300	006371'	256040	016361'	TTYSZS:	XCTBU <LDB T2,[POINT 6,1(T1),11]>	;GET POINTER SIZE
  5301	006372'	137340	016362'		DPB	T2,[POINT 6,P1,11]	;SET IN P1 POINTER
  5302	006373'	201300	000044		MOVEI	T1,^D36
  5303	006374'	230300	000007		IDIV	T1,T2		;NUMBER OF CHRS/WORD
  5304	006375'	220640	000006		IMUL	P2,T1		;NUMBER OF CHRS IN BUFFER
  5305	006376'	344600	006367*		AOJA	P1,CPOPJ	;ADD 1 TO POINT TO FIRST DATA WORD
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 118
SCNSER.MAC	25-NOV-87 19:52		OUTPUT UUO

  5306				SUBTTL	OUTPUT UUO
  5307				;CALLED ON OUTPUT OR OUTPUT CLOSE, FROM UUOCON, WITH F SET UP.
  5308
  5309	006377'	260040	012762'	TTYOUT:	PUSHJ	P,CKATTO	;FIRST, MAKE SURE THERE'S A LINE
  5310	006400'	254000	006277*		  JRST	ABTUUO		;WAITING FOR AN INTERRUPT
  5311	006401'	322240	006461'		JUMPE	U,TTYOUS	;ZAPPED AUX CIRCUIT
  5312	006402'	260040	012662'		PUSHJ	P,CHKROM	;MAKE SURE ROOM FOR THIS CHR
  5313	006403'	254000	006377'		  JRST	TTYOUT		;NO ROOM.
  5314	006404'	702600	400000*		NOCHARGE
  5315	006405'	260040	007520'		PUSHJ	P,CLRIMI	;CLEAR IMAGE INPUT STATE
  5316	006406'	205000	000002		MOVSI	S,IOBEG		;IS THIS THE FIRST BUFFER AFTER INIT?
  5317	006407'	205300	000400		MOVSI	T1,LDLOSU	;IF SO, WILL KILL ^O ACTION
  5318	006410'	616004	000002		TDNN	S,DEVIOS(F)	;CHECK F
  5319	006411'	254000	006414'		 JRST	TTOUT1		;NO.
  5320	006412'	412004	000002		ANDCAM	S,DEVIOS(F)	;YES. CLEAR BEG BIT,
  5321	006413'	412305	000031		ANDCAM	T1,LDBDCH(U)	; AND CONTROL O BIT
  5322	006414'	612305	000031	TTOUT1:	TDNE	T1,LDBDCH(U)	;IS CONTROL O ON NOW?
  5323	006415'	254000	006442'		 JRST	TTOUT5		;YES. SKIP THIS WHOLE BUFFER.
  5324	006416'	205000	000024		MOVSI	S,IO+IOFST	;MARK OUTPUT, AND FIRST OF BUFFER
  5325	006417'	437004	000002		IORB	S,DEVIOS(F)	;IN DEVICE DATA BLOCK
  5326	006420'	550604	000010		HRRZ	P1,DEVOAD(F)	;CHECK ADDRESSES OF OUTPUT BLOCK
  5327	006421'	256200	016363'		XCTFU <HRRZ P2,1(P1)>	;GET WORD COUNT
  5328	006422'	554304	000006		HLRZ	T1,DEVBUF(F)	;GET POINTER TO BUFFER HEADER
  5329	006423'	260040	006371'		PUSHJ	P,TTYSZS
  5330	006424'	602640	000777	TTOUT2:	TRNE	P2,777		;TIME TO LET SOMEONE ELSE RUN?
  5331	006425'	254000	006432'		 JRST	TTOUT3		;NO
  5332	006426'	260040	000000*		PUSHJ	P,WSCHED	;YES -- RESCHEDULE
  5333	006427'	550244	000013		HRRZ	U,DDBLDB(F)	;STILL ATTACHED?
  5334	006430'	326240	006432'		JUMPN	U,TTOUT3	;YES -- GO AHEAD
  5335	006431'	260040	012652'		PUSHJ	P,CKATTF	;NO -- WAIT FOR REATTACH
  5336	006432'	256040	016364'	TTOUT3:	XCTFU <ILDB T3,P1>	;GET A USER'S CHARACTER
  5337	006433'	602000	000010		TRNE	S,I		;SEE IF IMAGE MODE
  5338	006434'	664400	000400		 TROA	T3,400		;YES. SET BIT FOR SUPPRESSING FILLERS
  5339	006435'	620400	000400		  TRZ	T3,400		;ELSE CLEAR IN CASE EXTENDED
  5340	006436'	322400	006441'		JUMPE	T3,TTOUT4	;DON'T OUTPUT NULLS
  5341	006437'	260040	012573'		PUSHJ	P,TYO		;OUTPUT THIS CHARACTER (WAIT IF NEEDED)
  5342	006440'	254000	006452'		  JRST	XPNOUT		;TYO WANTS AN INTERRUPT (SEE TYO)
  5343	006441'	367640	006424'	TTOUT4:	SOJG	P2,TTOUT2		;COUNT USER'S ITEMS.
  5344	006442'	260040	000000*	TTOUT5:	PUSHJ	P,ADVBFE		;ADVANCE HIS BUFFERS
  5345	006443'	255000	000000		  JFCL			;JUST SINGLE BUFFER FOR NOW
  5346	006444'	201000	010000		MOVEI	S,IOACT		;CLEAR ACTIVE BIT.
  5347	006445'	413004	000002		ANDCAB	S,DEVIOS(F)	;IN DEVICE DATA BLOCK FOR THE JOB
  5348	006446'	201300	000001		MOVEI	T1,1
  5349	006447'	137300	000073'		DPB	T1,LOPOUT
  5350	006450'	137305	000002		DPB	T1,LDBOPB(U)
  5351	006451'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 119
SCNSER.MAC	25-NOV-87 19:52		TYO GAVE ERROR RETURN - NO MORE ROOM IN TTY CHUNCKS

  5352				SUBTTL	TYO GAVE ERROR RETURN - NO MORE ROOM IN TTY CHUNCKS
  5353	006452'	260040	012652'	XPNOUT:	PUSHJ	P,CKATTF		;HE MUST BE ATTCHED
  5354	006453'	205300	400000		MOVSI	T1,L2LOEX
  5355	006454'	436305	000027		IORM	T1,LDBBYT(U)	;SET FOR EXPANDED OUTPUT
  5356	006455'	200305	000021		MOVE	T1,LDBTOC(U)
  5357	006456'	311300	016025'		CAML	T1,TOEMAX		;ALREADY TOO MANY FOR EXPANDED?
  5358	006457'	350001	000000		AOS	(P)			;YES SKIP RETURN (TO TYO)
  5359								;WILL GET US INTO OUTPUT WAIT
  5360	006460'	263040	000000		POPJ	P,			;NON-SKIP RETURN (TO TYO) GO NOW
  5361
  5362	006461'	260040	006442*	TTYOUS:	PUSHJ	P,ADVBFE	;SKIP THIS BUFFER
  5363	006462'	255000	000000		  JFCL
  5364	006463'	201000	010000		MOVEI	S,IOACT
  5365	006464'	413004	000002		ANDCAB	S,DEVIOS(F)	;JUST TO MAKE SURE
  5366	006465'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 120
SCNSER.MAC	25-NOV-87 19:52		DDT MODE CALLI'S

  5367				SUBTTL DDT MODE CALLI'S
  5368
  5369				;INPUT TO DDT	- CALL AC,[SIXBIT /DDTIN/]  WHERE AC/ ADDR
  5370				;ADDR GETS UP TO 21 WORDS OF ASCIZ, BREAKING ON ANY CHARACTER
  5371
  5372	006466'	260040	014002'	DDTIN::	PUSHJ	P,TTYFNU		;SET U AND F FOR THIS TTY
  5373	006467'	260040	012727'		PUSHJ	P,CKATTI		;CHECK FOR ATTACHED
  5374	006470'	254000	006400*		  JRST	ABTUUO			;INTERRUPT, GET OUT OF UUO
  5375	006471'	702600	400000*		NOCHARGE
  5376	006472'	256200	016365'		XCTFU <HRRZ P2,(M)>
  5377	006473'	505640	440700		HRLI	P2,440700		;SEVEN BIT BYTES, RELOCATED.
  5378	006474'	201600	000124		MOVEI	P1,<21*5>-1		;NUMBER OF BYTES ALLOWED
  5379	006475'	260040	013114'		PUSHJ	P,TWAITC		;GET AT LEAST ONE CHARACTER
  5380	006476'	260040	006343'		PUSHJ	P,SETBRK		;ONE BREAK CHR
  5381	006477'	337005	000012	DDTINL:	SKIPG	LDBTIC(U)		;ANY MORE TO COME?
  5382	006500'	254000	006506'		 JRST	DDTINX			;NO.
  5383	006501'	260040	012365'		PUSHJ	P,TYI			;YES. GO GET ONE
  5384	006502'	254000	006506'		  JRST	DDTINX			;WASNT ANY. I'M CONFUSED.
  5385	006503'	602400	000177		TRNE	T3,177			;NULL?
  5386	006504'	256040	016366'		XCTFU <IDPB T3,P2>		;NO. STORE IN USER AREA
  5387	006505'	367600	006477'		SOJG	P1,DDTINL		;IF MORE SPACE, GET ANOTHER CHARACTER
  5388	006506'	201400	000000	DDTINX:	MOVEI	T3,0			;FLAG END OF STRING
  5389	006507'	256040	016366'		XCTFU <IDPB T3,P2>		; IN USER AREA
  5390	006510'	324740	007103'		PJRST	NOCTRO			;AND RETURN TO USER, CLEARING ^O FLAG
  5391
  5392				;DDTOUT - CALL AC,[SIXBIT /DDTOUT/], AC/ ADDR, ADDR/ ASCIZ /XXX/
  5393
  5394	006511'	256200	016367'	DDTOUT::UMOVE	M,(M)	;GET ADDRESS
  5395	006512'	201500	000003		MOVEI	W,3
  5396	006513'	254000	006755'		JRST	TTYUUO	;HANDLE LIKE OUTSTR
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 121
SCNSER.MAC	25-NOV-87 19:52		HANG UUO

  5397				SUBTTL HANG UUO
  5398
  5399				COMMENT @
  5400
  5401				HANG UUO - HANG A PORT, A JOB, OR ALL JOBS
  5402
  5403					T1/	BITS,,PORT OR JOB #
  5404
  5405					<BITS>  = 1B13 SAME AS 1B16 EXCEPT DON'T DETACH CMD PORT (LET
  5406						       LOGOUT DO IT)
  5407						  1B14 TO HANG A PORT OSTENSIBLY NOT TIED TO
  5408						       A CIRCUIT
  5409						  1B15 TO HANG ALL JOBS THEN GO TO BOOTS LOADED
  5410						  1B16 TO FORCE A LOGOUT EVEN FOR JOBS WITH
  5411						       DETACH OR TIMEOUT SET
  5412						  1B17 IF SPECIFYING A JOB RATHER THAN A PORT
  5413				@
  5414
  5415	006514'	607300	000004	HNGUUO::TLNN	T1,(1B15)	;IF HANGING THE SYSTEM
  5416	006515'	607300	000001		TLNN	T1,(1B17)	;OR SPECIFYING A PORT,
  5417	006516'	254000	006531'		 JRST	HNGUUL		;  NEED LICENSE
  5418
  5419				    ;HANGING A SPECIFIC FRAME - CHECK ACCESS RIGHTS
  5420
  5421	006517'	540600	000002		HRR	P1,J		;SAVE CALLER JOB#
  5422	006520'	500600	000006		HLL	P1,T1		;SAVE <BITS>
  5423	006521'	550740	000006		HRRZ	P4,T1		;P4/ FRAME DESC
  5424	006522'	551700	000054		HRRZI	P3,.ARHNG	;P3/ HANG-FRAME ACCESS
  5425	006523'	260040	000000*		PUSHJ	P,FDRUPX##	;J/ TARGET JOB#
  5426	006524'	263040	000000		  POPJ	P,		;(NO JOB OR INSUFFICIENT ACCESS)
  5427	006525'	500300	000014		HLL	T1,P1		;T1/ <BITS>,,
  5428	006526'	540300	000002		HRR	T1,J		;T1/ <BITS>,,TARGET JOB#
  5429	006527'	550100	000014		HRRZ	J,P1		;J/ CALLER JOB#
  5430	006530'	254000	006534'		JRST	HNGMON
  5431
  5432				    ;HANGING A PORT OR HANGING SYSTEM - NEED WC LICENSE
  5433
  5434	006531'	205340	400000	HNGUUL:	MOVSI	T2,LICWCR
  5435	006532'	616342	000000*		TDNN	T2,JBTLIC(J)
  5436	006533'	263040	000000		 POPJ	P,
  5437
  5438				    ;HERE WHEN ACCESS IS OK, TO DO THE ACTUAL STUFF
  5439
  5440	006534'	550340	000006	HNGMON::HRRZ	T2,T1		;GET JOB OR PORT NUMBER
  5441	006535'	603300	000004		TLNE	T1,(1B15)
  5442	006536'	254000	006633'		 JRST	HNGALL		;HANG ALL JOBS
  5443	006537'	603300	000001		TLNE	T1,(1B17)
  5444	006540'	254000	006623'		 JRST	HNGJOB		;HANG A JOB
  5445	006541'	301340	004376*		CAIL	T2,RPORTN##
  5446	006542'	263040	000000		 POPJ	P,		;BAD PORT
  5447	006543'	540247	005650*		HRR	U,LINTAB(T2)
  5448
  5449	006544'	336005	000026		SKIPN	LDBLOG(U)	;THERE?
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 121-2
SCNSER.MAC	25-NOV-87 19:52		HANG UUO

  5450	006545'	643300	000010		 TLCE	T1,(1B14)	;SKIP IF DESIRE TO HANG ACTIVE PORTS
  5451	006546'	603300	000010		TLNE	T1,(1B14)	;SKIP IF WANT TO HANG INACTIVE PORTS
  5452	006547'	263040	000000		 POPJ	P,		;ERROR RETURN
  5453	006550'	350001	000000		AOS	(P)		;SET TO SKIP RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 122
SCNSER.MAC	25-NOV-87 19:52		HANG UUO

  5454				    ;HERE FROM ABOVE AND FROM ZAPCIR UUO
  5455				    ;U/ ---,,LDB ADDR
  5456				    ;T1/1B16 if ignoring continue-on-disconnect
  5457
  5458	006551'	261040	000006	HNGPRT:	PUSH	P,T1		;Save the "kill flag"
  5459	006552'	205340	001000		MOVSI	T2,LMLBIO
  5460	006553'	612345	000030		TDNE	T2,LDBMOD(U)
  5461	006554'	260040	011626'		 PUSHJ	P,BIOREL	;RESET BIO ON THIS PORT
  5462	006555'	262040	000006		POP	P,T1		;Restore "kill flag"
  5463
  5464				;HERE WITH U/ LDB ADDR TO HANG THAT PORT
  5465
  5466	006556'	500245	000031		HLL	U,LDBDCH(U)
  5467	006557'	205340	200000		MOVSI	T2,LLLZAP
  5468	006560'	436345	000026		IORM	T2,LDBLOG(U)	;MARK PORT INTERNALLY "ZAPPED"
  5469	006561'	603240	000040		TLNE	U,LDLAUX	;IS IT AN AUX CIRCUIT?
  5470	006562'	254000	011007'		 JRST	HNGAUX		;YES, SO IT'S NOT A COMMAND PORT
  5471	006563'	550205	000000		HRRZ	F,LDBDDB(U)	;F/ DDB ADDR
  5472	006564'	322200	014622'		JUMPE	F,TTYZAP	;Detached, just zap the port
  5473	006565'	205340	020000		MOVSI	T2,TTYATC
  5474	006566'	616344	000004		TDNN	T2,DEVMOD(F)	;IS IT A COMMAND PORT?
  5475	006567'	254000	011007'		 JRST	HNGAUX		;NO
  5476	006570'	135100	006345*		LDB	J,PJOBN		;Get number of controlling job/frame
  5477	006571'	500100	000006		HLL	J,T1		;Set up J for general hang code
  5478					PFALL	HNGTTY
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 123
SCNSER.MAC	25-NOV-87 19:52		Here from above or by PUSHJ.  At entry, F=DDB address, U=LDB

  5479				SUBTTL	 Here from above or by PUSHJ.  At entry, F=DDB address, U=LDB
  5480				; address (if any), J=job/frame # in RH, LH has bit 16 set if
  5481				; continue-on-disconnect is to be ignored.
  5482
  5483	006572'	603100	000020	HNGTTY:	TLNE	J,(1B13)	;WANT TO DETACH?
  5484	006573'	254000	006603'		 JRST	HNGTT1		;NO, LET LOGOUT HANDLE IT
  5485	006574'	513004	000013		HLLZS	DDBLDB(F)	;Clear DDB-to-LDB pointer
  5486	006575'	553004	000000		HRRZS	DEVNAM(F)	;Clear "TTY" from device name
  5487	006576'	322240	006603'		JUMPE	U,HNGTT1	;Skip port code if no port
  5488	006577'	513005	000000		HLLZS	LDBDDB(U)	;Clear LDB-to-DDB pointer
  5489	006600'	260040	014622'		PUSHJ	P,TTYZAP	;ZAP the port
  5490	006601'	135300	000202'		LDB	T1,LDPCOM	;Command mode from LDB
  5491	006602'	137300	000242'		DPB	T1,DDPCOM	;Copy into DDB
  5492
  5493				; Here job/frame is detached and TTY is gone
  5494
  5495	006603'	623100	000022	HNGTT1:	TLZE	J,(1B13!1B16)	;"Really kill"?
  5496	006604'	254000	006616'		 JRST	HNGTT2		;Yes, kill him good
  5497	006605'	135300	000000*		LDB	T1,PVYHNG##	;HANG/ZAP action field
  5498	006606'	302300	000002		CAIE	T1,.PVHCN	;Continue-on-disconnect?
  5499	006607'	254000	006617'		 JRST	HNGTT3		;No, go kill it dead
  5500
  5501				; Here for continue-on-disconnect
  5502
  5503	006610'	135300	000230'		LDB	T1,DDPTZP
  5504	006611'	260040	001130*		PUSHJ	P,TAKTRP	;Cause "TTY ZAP" interrupt (if enabled)
  5505	006612'	200004	000002		MOVE	S,DEVIOS(F)
  5506	006613'	603000	020000		TLNE	S,TIOUSE	;If the DDB is in use,
  5507	006614'	260040	006005'		 PUSHJ	P,TIWAKE	; wake the job
  5508	006615'	263040	000000		POPJ	P,
  5509
  5510				; Here to kill job dead
  5511
  5512	006616'	260040	000000*	HNGTT2:	PUSHJ	P,TTKJOB##	;"Really kill" (no questions)
  5513
  5514				; Here to stop on disconnect or logout on disconnect
  5515
  5516	006617'	205300	040000	HNGTT3:	MOVSI	T1,DCLCOM
  5517	006620'	436304	000012		IORM	T1,DDBDCH(F)	;In command mode at detach time
  5518	006621'	260040	000000*		PUSHJ	P,COMKJB##	;The MAGIC INVOCATION which kills jobs
  5519	006622'	263040	000000		POPJ	P,		;Less magical, returns to caller
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 124
SCNSER.MAC	25-NOV-87 19:52		HERE TO HANG A JOB

  5520				SUBTTL	HERE TO HANG A JOB
  5521				;T1/ BITS,,JOB#  T2/ 0,,JOB#
  5522
  5523	006623'	301340	000000*	HNGJOB:	CAIL	T2,JOBN
  5524	006624'	263040	000000		 POPJ	P,		;BAD JOB NUMBER
  5525	006625'	550207	000000*		HRRZ	F,TTYTAB(T2)
  5526	006626'	322200	006376*		JUMPE	F,CPOPJ		;NO JOB THERE
  5527	006627'	550244	000013		HRRZ	U,DDBLDB(F)
  5528	006630'	200100	000006		MOVE	J,T1		;Copy BITS,,JOB#
  5529	006631'	260040	006572'		PUSHJ	P,HNGTTY	;Force hang for this job/frame
  5530	006632'	254000	006270*		JRST	CPOPJ1
  5531
  5532				;HERE TO HANG EVERYONE AND BRING DOWN THE SYSTEM
  5533
  5534	006633'	402000	000555*	HNGALL::SETZM	CRSHWD##	; THIS KEEPS US FROM NESTING
  5535	006634'	476000	016010'		SETOM	DWNFLG
  5536	006635'	201300	600000		MOVEI	T1,600000
  5537	006636'	436300	004425*		IORM	T1,STATES	;SET SUPER SHUT
  5538	006637'	260040	014407'		PUSHJ	P,SETSHT	;LET SUPERVISOR KNOW
  5539	006640'	200300	000000*		MOVE	T1,HIGHJB
  5540	006641'	261040	000006		PUSH	P,T1
  5541	006642'	505300	000003	HNGAL1:	HRLI	T1,(1B16!1B17)	;HANG JOB AND FORCE LOGOUT
  5542	006643'	550340	000006		HRRZ	T2,T1		;Copy job #
  5543	006644'	260040	006623'		PUSHJ	P,HNGJOB
  5544	006645'	255000	000000		  JFCL
  5545	006646'	373301	000000		SOSLE	T1,(P)
  5546	006647'	254000	006642'		JRST	HNGAL1
  5547	006650'	254000	006046*		JRST	TPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 125
SCNSER.MAC	25-NOV-87 19:52		RESET UUO

  5548				SUBTTL RESET UUO
  5549
  5550	006651'	550202	006625*	TTYRES::HRRZ	F,TTYTAB(J)	;CALLED AT RESET TIME
  5551	006652'	322200	006626*		JUMPE	F,CPOPJ		;NO DDB
  5552	006653'	200000	016370'		MOVE	S,[XWD TWTSPC!IOSBKA,BK2IOS!DLRSUP!NOECHO!FCS!17]
  5553	006654'	413004	000002		ANDCAB	S,DEVIOS(F)	;RESET TTY TO NORMAL STATE
  5554	006655'	550244	000013		HRRZ	U,DDBLDB(F)
  5555	006656'	322240	006671'		JUMPE	U,TTYRS1	;NO LINE
  5556	006657'	200305	000030		MOVE	T1,LDBMOD(U)	;CHECK FOR BLOCK I/O MODE SET
  5557	006660'	603300	001000		TLNE	T1,LMLBIO	;FOR THE PORT AND RELEASE
  5558	006661'	260040	011626'		 PUSHJ	P,BIOREL	;BUFFERS AND RESET, IF SO.
  5559	006662'	205300	020000		MOVSI	T1,L2LNTB
  5560	006663'	412305	000027		ANDCAM	T1,LDBBYT(U)	;RESET THE NO TAB FUNCTION
  5561	006664'	551300	100000		HRRZI	T1,L2LTBK
  5562	006665'	260040	007540'		PUSHJ	P,SETTBK	;NOW MAKE SURE TABS ARE BREAK2
  5563	006666'	551300	040000		HRRZI	T1,L2LBBP
  5564	006667'	260040	007540'		PUSHJ	P,SETTBK	;MAKE SURE THAT BACKSPACES ARE BREAK
  5565	006670'	260040	013004'		PUSHJ	P,UUOLDB	;MAKE LINE AGREE WITH S
  5566	006671'	260040	015341'	TTYRS1:	PUSHJ	P,NXTTTY	;GET NEXT DDB
  5567	006672'	263040	000000		  POPJ	P,		;NONE
  5568	006673'	205340	010000		MOVSI	T2,DVNZP
  5569	006674'	612344	000004		TDNE	T2,DEVMOD(F)	;SHOULD WE ZAP ON RESET?
  5570	006675'	254000	006671'		 JRST	TTYRS1		;NO
  5571	006676'	201340	400000		MOVEI	T2,ASSCON
  5572	006677'	260040	000000*		PUSHJ	P,RELEA6	;YES
  5573	006700'	254000	006671'		JRST	TTYRS1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 126
SCNSER.MAC	25-NOV-87 19:52		.STTLK SETUUO FUNCTION

  5574				SUBTTL .STTLK SETUUO FUNCTION
  5575
  5576				COMMENT @
  5577
  5578				CALLED BY SETUUO TO DO THE .STTLK FUNCTION (TALK COMMAND CLONE):
  5579
  5580					MOVE	J,[TALKER JOB #]
  5581					MOVE	T1,[TALKEE JOB #] (0 for OPR+CTY, 400000 for CTY only)
  5582					MOVE	T2,[ILDB POINTER TO MESSAGE IN USER SPACE]
  5583					MOVE	T4,[BYTE COUNT, 0 IF MESSAGE IS ASCIZ]
  5584					PUSHJ	P, STTLK
  5585					  ERROR RETURN	;T1/ ERROR CODE (SEE DEFINITIONS BELOW)
  5586					NORMAL RETURN
  5587
  5588				ADVANCES T2 AS IT GOES, SO T2 IS CORRECTLY UPDATED IF THE MESSAGE
  5589				CAN ONLY BE PARTIALLY OUTPUT.  T4 updated if it started nonzero.
  5590
  5591				DESTROYS T1 T3.
  5592
  5593				@
  5594
  5595			000000	TKROM%==:0	;NO ROOM FOR MORE OUTPUT CHARACTERS
  5596			000001	TKEXS%==:1	;JOB DOESN'T EXIST
  5597			000002	TKATT%==:2	;JOB NOT ATTACHED
  5598			000003	TKBSY%==:3	;JOB BUSY (NO OPER LICENSE & NOT AT CMND LEVEL)
  5599
  5600				PRINTF(<[STTLK to job -1 does not SEND ALL]>)
  5601
  5602	006701'	602300	377777	STTLK::	TRNE	T1,377777	;Zero or 400000?
  5603	006702'	254000	006711'		 JRST	STTLK0		;No, T1 has job number
  5604	006703'	306300	400000		CAIN	T1,400000	;Is 1B18 and nothing else set?
  5605	006704'	644300	400001		 TRCA	T1,400001	;Yes, change T1 to 1 and output to CTY only
  5606	006705'	201300	000002		  MOVEI	T1,2		;No, change T1 to 2 for both OPR and CTY
  5607	006706'	260040	013561'		PUSHJ	P,OPROUT	;Set up to go to right LDB
  5608	006707'	201400	000103'		MOVEI	T3,CTYLDB	;Fake it
  5609	006710'	254000	006734'		JRST	STTLK1
  5610
  5611	006711'	205400	040000	STTLK0:	MOVSI	T3,JNA
  5612				;*;	JUMPL	T1,#SEND#ALL#	;***    NOT IMPLEMENTED   ****
  5613	006712'	305300	006623*		CAIGE	T1,JOBN		;IF BAD JOB #
  5614	006713'	616406	006040*		TDNN	T3,JBTSTS(T1)	;OR JOB NOT ASSIGNED,
  5615					 JRST	[MOVEI	T1,TKEXS%
  5616	006714'	254000	016371'			 POPJ	P,]	;Error return - non existant job
  5617	006715'	550406	006651*		HRRZ	T3,TTYTAB(T1)	;T3/ TALKEE DDB
  5618	006716'	336000	000010		SKIPN	T3
  5619	006717'	256000	000000'		 STOPCD
  5620	006720'	550410	000013		HRRZ	T3,DDBLDB(T3)	;T3/ TALKEE LDB
  5621					JUMPE	T3,[		;IF JOB NOT ATTACHED,
  5622						MOVEI	T1,TKATT%
  5623						POPJ	P,	;  ERROR-RETURN
  5624	006721'	322400	016373'		]
  5625
  5626	006722'	306400	015724'		CAIN	T3,OPRLDB	;No license required to send to OPR or CTY
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 126-2
SCNSER.MAC	25-NOV-87 19:52		.STTLK SETUUO FUNCTION

  5627	006723'	254000	006734'		 JRST	STTLK1
  5628	006724'	500442	006532*		HLL	T4,JBTLIC(J)	;Get caller's license
  5629	006725'	603440	100000		TLNE	T4,LICOPR	;OPER can talk to anyone
  5630	006726'	254000	006734'		 JRST	STTLK1
  5631	006727'	500450	000031		HLL	T4,LDBDCH(T3)	;Get talkee's status
  5632	006730'	603440	020000		TLNE	T4,LDLCOM	;Receive messages if port is at command level
  5633	006731'	254000	006734'		 JRST	STTLK1
  5634	006732'	201300	000003		MOVEI	T1,TKBSY%	;Port is busy
  5635	006733'	263040	000000		POPJ	P,		;Error return
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 127
SCNSER.MAC	25-NOV-87 19:52		.STTLK SETUUO FUNCTION

  5636				    ;HERE WITH T2/ ILDB POINTER, T3/ TALKEE LDB TO SEND A MESSAGE
  5637
  5638	006734'	621440	777777	STTLK1:	TLZ	T4,-1		;Keep only byte count
  5639	006735'	261040	000005		PUSH	P,U		;SAVE U
  5640	006736'	550240	000010		HRRZ	U,T3
  5641	006737'	621340	000037		TLZ	T2,37		;CLEAR INDEX AND INDIRECT FIELDS
  5642	006740'	261040	000007		PUSH	P,T2		;AND SAVE BYTE POINTER
  5643
  5644	006741'	260040	012713'	STTLK2:	PUSHJ	P,IFROOM	;Check for room in destination output buffer
  5645					 JRST	[
  5646						MOVEI	T1,TKROM%
  5647						POP	P,T2
  5648						POP	P,U
  5649						POPJ	P,	;  RESTORE T2 AND U AND ERROR-RETURN
  5650	006742'	254000	016375'		]
  5651	006743'	256040	016401'		XCTFU	<ILDB T3,(P)>	;GET NEXT BYTE OF MESSAGE
  5652	006744'	336000	000011		SKIPN	T4		;If count started at 0, then
  5653	006745'	322400	006752'		 JUMPE	T3,STTLK3	; end at null in ASCIZ
  5654	006746'	260040	013317'		PUSHJ	P,COMTYO	;PRINT THE CHARACTER
  5655	006747'	332000	000011		SKIPE	T4		;If byte count supplied,
  5656	006750'	362440	006752'		 SOJE	T4,STTLK3	; count it down
  5657	006751'	254000	006741'		JRST	STTLK2
  5658
  5659	006752'	262040	000007	STTLK3:	POP	P,T2
  5660	006753'	262040	000005		POP	P,U
  5661	006754'	254000	006632*		JRST	CPOPJ1		;RESTORE T2 AND U AND SUCCESS-RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 128
SCNSER.MAC	25-NOV-87 19:52		TTCALL UUO

  5662				SUBTTL TTCALL UUO
  5663				;TTCALL AC,E - VALUE OF AC DETERMINES ACTION OF UUO (051)
  5664
  5665	006755'	260040	014002'	TTYUUO::PUSHJ	P,TTYFNU	;SET F AND U
  5666	006756'	200412	007017'		MOVE	T3,TTUUOT(W)	;GET DIPACTH ADRS AND BITS
  5667	006757'	607400	200000		TLNN	T3,TUUATO	;DOES UUO NEED ATTACH FOR OUTPUT?
  5668	006760'	254000	006767'		 JRST	TTYUU1
  5669	006761'	260040	012762'		PUSHJ	P,CKATTO	;YES, CHECK IF ATTACHED FOR OUTPUT
  5670	006762'	254000	006470*		  JRST	ABTUUO		;ABORT THE UUO FOR INTERRUPT
  5671	006763'	326240	006767'		JUMPN	U,TTYUU1
  5672	006764'	260040	012770'		PUSHJ	P,CKATO2	;FORCE ATTACH EVEN IF "SPECIAL"
  5673	006765'	254000	006762*		  JRST	ABTUUO
  5674	006766'	322240	006764'		JUMPE	U,.-2		;JUST TO MAKE SURE
  5675	006767'	607400	400000	TTYUU1:	TLNN	T3, TUUATI	;ATTACH FOR INPUT ?
  5676	006770'	254000	006773'		 JRST	TTYUU2
  5677	006771'	260040	012727'		PUSHJ	P,CKATTI	;YES, CHECK IF ATTACHED
  5678	006772'	254000	006765*		  JRST	ABTUUO		;ABORT FOR INTERRUPT
  5679	006773'	603400	140000	TTYUU2:	TLNE  T3,TUUATR!TUUAIR	;RETURN IF DETACHED ?
  5680	006774'	322240	006652*		JUMPE	U,CPOPJ		;YES
  5681	006775'	607400	600000		TLNN	T3,TUUATO!TUUATI;IF DOING INPUT OR OUTPUT
  5682	006776'	260040	013004'		 PUSHJ	P,UUOLDB	;MUST GET THROUGH UUOLDB
  5683	006777'	607400	020000		TLNN	T3,TUUROM	;NEED ROOM FOR OUTPUT?
  5684	007000'	254000	007003'		 JRST	TTYUU3
  5685	007001'	260040	012662'		PUSHJ	P,CHKROM	;SEE IF WILL GO INTO IOW FOR INTERRUPT
  5686	007002'	254000	006755'		 JRST	TTYUUO
  5687	007003'	603400	040000	TTYUU3:	TLNE	T3,TUUAIR	;MUST IT BE AT USER LEVEL TOO?
  5688	007004'	607240	020000		TLNN	U,LDLCOM
  5689	007005'	334000	000000		 SKIPA			;NEED NOT BE OR IS
  5690	007006'	263040	000000		  POPJ	P,
  5691	007007'	603400	010000		TLNE	T3,TUUEAT	;EAT RESCAN BUFFER?
  5692	007010'	260040	012514'		 PUSHJ	P,TYIEAT	;MUST EAT COMMAND BEFORE INPUT
  5693				IFE OPCRET,<	; KLUDGE TIL OPERATIONS CAN WRITE 10 CODE
  5694					TLNE	T3,TUUFXI
  5695					 PUSHJ	P,FIXIMI	;SET IMAGE STATE FROM DATA MODE
  5696				>;OPCRET=1 IF PROGRAMS THINK TTCALLS IGNORE IMAGE
  5697	007011'	254010	000000		JRST	(T3)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 129
SCNSER.MAC	25-NOV-87 19:52		BITS FOR THE TTY UUOS

  5698				SUBTTL	BITS FOR THE TTY UUOS
  5699
  5700			400000	TUUATI==400000	;NEED TO BE ATTACHED - INPUT
  5701			200000	TUUATO==200000	;NEED TO BE ATTACHED - OUTPUT
  5702			100000	TUUATR==100000	;RETURN IF NOT ATTACHED
  5703			040000	TUUAIR==040000	;RETURN IF NOT AT USER LEVEL
  5704			020000	TUUROM==020000	;CHECK FOR ROOM FOR AT LEAST 1 CHR BEFORE OUTPUT
  5705			010000	TUUEAT==010000	;EAT COMMAND
  5706			004000	TUUFXI==004000	;SET IMAGE STATE FROM DATA MODE
  5707			002000	TUUIMI==002000	;TURN ON IMAGE STATE (REGARDLESS OF DATA MODE)
  5708
  5709				;THERE ARE SOME NEGATIVE DISPATCHES FAKED BY UUOCON
  5710
  5711	007012'	040000	007430'		XWD TUUAIR,LEVDEF		;-5 LEAVE DEFERED ECHO MODE
  5712	007013'	054000	007412'		XWD TUUAIR!TUUEAT!TUUFXI,RDNXT	;-4 READ NEXT CHR AND SKIP
  5713	007014'	000000	006774*		XWD 0,CPOPJ			;   NO LONGER IMPLEMENTED
  5714	007015'	000000	007437'		XWD 0,GETMC			;-2 GET LINE CHRS
  5715	007016'	414000	013114'		XWD TUUATI!TUUEAT!TUUFXI,TWAITC	;-1 WAIT FOR CHR
  5716	007017'	414000	007343'	TTUUOT:	XWD TUUATI!TUUEAT!TUUFXI,INCHRW	;00 INPUT CHR AND WAIT
  5717	007020'	220000	007040'		XWD TUUATO!TUUROM,ONEOUT	;01 OUTPUT 1 CHR
  5718	007021'	054000	007276'		XWD TUUAIR!TUUEAT!TUUFXI,INCHRS	;02 INPUT CHR AND SKIP
  5719	007022'	220000	007065'		XWD TUUATO!TUUROM,OUTSTR	;03 OUTPUT STRING
  5720	007023'	414000	007320'		XWD TUUATI!TUUEAT!TUUFXI,INCHWL	;04 INPUT CHR AND WAIT LINE MODE
  5721	007024'	054000	007307'		XWD TUUAIR!TUUEAT!TUUFXI,INCHSL	;05 INPUT CHR AND SKIP LINE MODE
  5722	007025'	000000	007212'		XWD 0,GETLIN			;06 GET LINE CHRS.
  5723	007026'	200000	007262'		XWD TUUATO,SETLIN		;07 SET LINE CHRS.
  5724	007027'	100000	007075'		XWD TUUATR,TRESCU		;10 INHIBIT COMMAND LINE EATING
  5725	007030'	100000	006203'		XWD TUUATR,TSETBI		;11 CLEAR INPUT BUFFER
  5726	007031'	100000	006234'		XWD TUUATR,TSETBO		;12 CLEAR OUTPUT BUFFER
  5727	007032'	054000	007100'		XWD TUUAIR!TUUEAT!TUUFXI,SKPINC	;13 SKIP IF CHR TO BE INPUT
  5728	007033'	054000	007110'		XWD TUUAIR!TUUEAT!TUUFXI,SKPINL	;14 SKIP IF LINE TO BE INPUT
  5729	007034'	220000	007057'		XWD TUUATO!TUUROM,IONEOU	;15 IMAGE ONE-CHAR OUTPUT
  5730	007035'	220000	007037'		XWD TUUATO!TUUROM,OUTCHI	;16 OUTPUT CHR IMMEDIATE
  5731	007036'	220000	007122'		XWD TUUATO!TUUROM,OUTPTR	;17 OUTPUT FROM POINTER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 130
SCNSER.MAC	25-NOV-87 19:52		SUBROUTINES FOR TTCALL

  5732				SUBTTL	SUBROUTINES FOR TTCALL
  5733
  5734				;ONEOUT OUTPUTS ONE CHARACTER FROM C(E)
  5735
  5736	007037'	334400	000013	OUTCHI:	SKIPA T3,M	;GET THE CHARACTER FROM ADDRESS FILED
  5737	007040'	256200	016402'	ONEOUT:	UMOVE T3,(M)	;GET CHR FROM ADDRESS
  5738	007041'	702600	400000*		NOCHARGE
  5739	007042'	260040	007520'		PUSHJ P,CLRIMI			;CLEAR IMAGE INPUT STATE
  5740	007043'	606000	000010		TRNN S,10		;IF MODES 10,13,14
  5741	007044'	606000	000002		TRNN S,2		;OR 0,1
  5742	007045'	624400	000600		TRZA T3,600		;SAME AS ANDI 177 SINCE TTGETC GETS 9 BIT BYTE
  5743	007046'	405400	000377		ANDI T3,377		;8 BITS IN MODE 2
  5744	007047'	322400	007014*		JUMPE T3,CPOPJ			;IF NOT NULL,
  5745	007050'	260040	012573'	ONEOU2:	PUSHJ P,TYO
  5746	007051'	254000	006452'		 JRST XPNOUT		;SET BIGGER OUTPUT AND GO TO TYO
  5747	007052'	201300	000001	ONEOU3:	MOVEI T1,1
  5748	007053'	137300	000073'		DPB T1,LOPOUT
  5749	007054'	137305	000002		DPB T1,LDBOPB(U)
  5750	007055'	263040	000000		POPJ P,
  5751
  5752				;IONEOU OUTPUTS ONE CHARACTER FROM LOW 8 BITS OF C(E)
  5753	007056'	334400	000013	ACOTCI:	SKIPA T3,M	;GET CHR IMMEDIATE (AUXCAL)
  5754	007057'	256200	016402'	IONEOU:	UMOVE T3,(M)	;GET CHR
  5755	007060'	702600	400000*		NOCHARGE
  5756	007061'	260040	007520'		PUSHJ P,CLRIMI			;NOT IN INPUT WAIT ANY MORE
  5757	007062'	322200	007040'		JUMPE F,ONEOUT		;IF NO F, SEND 7 BITS
  5758	007063'	660400	000400		TRO T3,400			;FLAG AS IMAGE CHARACTER (NO FILLER)
  5759	007064'	324740	007050'		PJRST ONEOU2		;OUTPUT CHARACTER
  5760
  5761				;OUTSTR OUTPUTS A STRING OF ASCIZ CHARACTERS
  5762
  5763
  5764	007065'	260040	007520'	OUTSTR:	PUSHJ P,CLRIMI			;CLEAR IMAGE INPUT STATE
  5765	007066'	702600	400000*		NOCHARGE
  5766	007067'	505540	440700		HRLI M,(POINT 7,0)			;POINT TO USER AREA
  5767	007070'	256040	016403'	OUTST1:	XCTFU <ILDB T3,M>	;GET CHR
  5768	007071'	322400	007052'		JUMPE T3,ONEOU3			;NULL MARKS END OF STRING, START PTY
  5769	007072'	260040	012573'		PUSHJ P,TYO			;TYPE OUT CHARACTER WITH PARITY
  5770	007073'	254000	006452'		 JRST XPNOUT		;TRY BIGGER OUTPUT BUFFER
  5771	007074'	254000	007070'		JRST OUTST1			;AND GO BACK FOR MORE.
  5772
  5773				;TRESCU IS FOR COMPIL TO READ COMMAND WHICH STARTED IT
  5774
  5775	007075'	205300	100000	TRESCU:	MOVSI T1,LDLECS		;CLEAR BIT IN LINE DATA BLOCK WHICH
  5776	007076'	412305	000031		ANDCAM T1,LDBDCH(U)		; WOULD CAUSE COMMAND TO BE SKIPPED
  5777	007077'	263040	000000		POPJ P,0			;AND RETURN TO USER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 131
SCNSER.MAC	25-NOV-87 19:52		SKPINC - SKIP IF INCHRW WOULDN'T WAIT (TOO LONG)

  5778				SUBTTL	SKPINC - SKIP IF INCHRW WOULDN'T WAIT (TOO LONG)
  5779
  5780	007100'	337005	000014	SKPINC:	SKIPG	LDBECC(U)	;If anything to be echoed
  5781	007101'	333005	000012		SKIPLE	LDBTIC(U)	;Or characters have been input
  5782	007102'	350001	000000		 AOS	(P)		;Skip return
  5783	007103'			TTYSET::		;OLD CLOCK1 FUNCTION
  5784	007103'	205300	010000	NOCTRO:	MOVSI	T1,L2LLDF
  5785	007104'	412305	000027		ANDCAM	T1,LDBBYT(U)	;TURN OFF LEVDEF FLAG TOO
  5786	007105'	205300	000400		MOVSI	T1,LDLOSU	;TURN OFF CONTROL O BIT
  5787	007106'	412305	000031		ANDCAM	T1,LDBDCH(U)
  5788	007107'	263040	000000		POPJ	P,
  5789
  5790				;SKPINL - SKIP IF INCHWL WOULDN'T WAIT
  5791
  5792	007110'	200305	000012	SKPINL:	MOVE	T1,LDBTIC(U)	;T1/ # READABLE CHARACTERS
  5793	007111'	603240	002000		TLNE	U,LDLIMI	;IF IMAGE MODE
  5794	007112'	337000	000006		 SKIPG	T1		;AND THERE'RE ANY,
  5795	007113'	301300	000110		CAIL	T1,TIWKC	;OR OF THERE'S A LINEFULL,
  5796	007114'	254000	007120'		 JRST	SKPIN1		;  SKIP
  5797	007115'	603240	004000		TLNE	U,LDLBK2	;IF BREAK-ON-PUNCTUATION
  5798	007116'	337005	000016		 SKIPG	LDBBK2(U)	;AND THERE'RE PUNCTUATION CHARS,
  5799	007117'	333005	000015		SKIPLE	LDBBKC(U)	;OR IF THERE'RE BREAK CHARACTERS,
  5800	007120'	350001	000000	SKPIN1:	 AOS (P)		;  SKIP
  5801	007121'	324740	007103'		PJRST	NOCTRO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 132
SCNSER.MAC	25-NOV-87 19:52		OUTPTR - OUTPUT FROM BYTE POINTER

  5802				SUBTTL	OUTPTR - OUTPUT FROM BYTE POINTER
  5803
  5804	007122'	260040	007520'	OUTPTR:	PUSHJ P,CLRIMI
  5805	007123'	702600	400000*		NOCHARGE
  5806	007124'	256200	016404'		XCTFU <MOVE W,(M)>	;GET BYTE POINTER
  5807	007125'	621500	000037		TLZ W,37		;GET RID OF INDEX AND INDIRECT
  5808	007126'	256040	016405'	OUTPT1:	XCTFU <ILDB T3,W>	;GET NEXT CHARACTER
  5809	007127'	322400	007052'		JUMPE T3,ONEOU3		;DONE - SET OUTPUT BITS&RETURN
  5810	007130'	260040	012573'		PUSHJ P,TYO
  5811	007131'	334000	000000		 SKIPA			;TYO WANTS TO TAKE INTERRUPT
  5812	007132'	254000	007126'		JRST OUTPT1		;TYO DONE, NEXT CHR
  5813	007133'	135400	016406'		LDB T3,[POINT 6,W,11]	;GET SIZE FIELD
  5814	007134'	241400	777772		ROT T3,-6		;MOVE TO POSITION FILED
  5815	007135'	272400	000012		ADDM T3,W		;BACK UP POINTER 1 POSITION
  5816	007136'	256200	016407'		XCTTU <MOVEM W,(M)>	;PUT IT BACK
  5817	007137'	201300	000001		MOVEI T1,1
  5818	007140'	137300	000073'		DPB T1,LOPOUT
  5819	007141'	137305	000002		DPB T1,LDBOPB(U)
  5820	007142'	254000	006772*		JRST ABTUUO		;AND DUMP THIS UUO
  5821
  5822				;OUTPTC - OUTPUT FROM BYTE POINTER + COUNT
  5823
  5824	007143'	260040	007520'	OUTPTC:	PUSHJ	P, CLRIMI
  5825	007144'	702600	400000*		NOCHARGE
  5826	007145'	256200	016410'		XCTFU	<HRRZ P1, 0(M)>	;P1/ COUNT
  5827	007146'	322600	007047*		JUMPE	P1, CPOPJ	;IF 0, DONE
  5828	007147'	256200	016411'		XCTFU	<MOVE W, 1(M)>	;W/ BYTE POINTER
  5829	007150'	621500	000037		TLZ	W, 37		;W/ BYTE POINTER - INDEX&INDIRECT BITS
  5830	007151'	256040	016405'	OUTPC1:	XCTFU	<ILDB T3, W>	;T3/ NEXT CHARACTER
  5831	007152'	260040	012573'		PUSHJ	P, TYO		;OUTPUT IT
  5832	007153'	254000	007156'		  JRST	OUTPC2		;(TYO WANTS AN INTERRUPT)
  5833	007154'	367600	007151'		SOJG	P1, OUTPC1	;IF MORE CHARACTERS, CONTINUE
  5834	007155'	324740	007163'		PJRST	OUTPCF		;FINISH UP
  5835
  5836	007156'	135400	016406'	OUTPC2:	LDB	T3, [POINT 6,W,11]
  5837	007157'	241400	777772		ROT	T3, -6		;POSITION FIELD := SIZE FIELD
  5838	007160'	272400	000012		ADDM	T3, W		;DECREMENT BYTE POINTER BY 1 BYTE
  5839	007161'	260040	007163'		PUSHJ	P, OUTPCF	;FINISH UP
  5840	007162'	254000	007142*		JRST	ABTUUO		;AND DUMP THIS UUO
  5841
  5842					;OUTPCF ALSO USED BY OUTSNW...BELOW
  5843	007163'	256200	016412'	OUTPCF:	XCTBU	<HRRM P1, 0(M)>	;STORE THE UPDATED COUNT
  5844	007164'	256200	016413'		XCTTU	<MOVEM W, 1(M)>	;AND BYTE POINTER
  5845	007165'	201300	000001		MOVEI	T1, 1
  5846	007166'	137300	000073'		DPB	T1, LOPOUT
  5847	007167'	137305	000002		DPB	T1, LDBOPB(U)
  5848	007170'	263040	000000		POPJ	P,
  5849
  5850				;OUTSNW - OUTPUT STRING, NEVER WAIT
  5851
  5852	007171'	260040	007520'	OUTSNW:	PUSHJ	P,CLRIMI
  5853	007172'	702600	400000*		NOCHARGE
  5854	007173'	554305	000005		HLRZ	T1,LDBBIO(U)	;BLOCK OUTPUT IN PROGRESS?
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 132-2
SCNSER.MAC	25-NOV-87 19:52		OUTPTR - OUTPUT FROM BYTE POINTER

  5855	007174'	326300	007146*		JUMPN	T1,CPOPJ	;IF SO, CAN'T DO ANYTHING
  5856	007175'	256200	016410'		XCTFU	<HRRZ P1,(M)>	;P1/ COUNT
  5857	007176'	322600	006754*		JUMPE	P1,CPOPJ1	;NOTHING TO DO
  5858	007177'	256200	016411'		XCTFU	<MOVE W,1(M)>	;W/ BYTE POINTER
  5859	007200'	621500	000037		TLZ	W,37		;W/ BYTE POINTER - INDEX & IND BITS
  5860	007201'	260040	012713'	OUTSN1:	PUSHJ	P,IFROOM	;IS THERE ROOM FOR A CHARACTER?
  5861	007202'	254000	007210'		 JRST	OUTSN2		;NO ROOM - SET FIO GO AWAY
  5862	007203'	256040	016405'		XCTFU	<ILDB T3,W>	;YES ROOM - GET CHARACTER
  5863	007204'	260040	012615'		PUSHJ	P,CMDTYO	;AND OUTPUT IT
  5864	007205'	367600	007201'		SOJG	P1,OUTSN1	;DO IT AGAIN, IF MORE
  5865	007206'	350001	000000		AOS	(P)		;RAN OUT - SKIP RETURN
  5866	007207'	254000	007163'		JRST	OUTPCF		;GO AWAY
  5867	007210'	260040	015536'	OUTSN2:	PUSHJ	P,SETFIO	;SO HE'LL GET ROOM AVAILABLE TRAP
  5868	007211'	254000	007163'		JRST	OUTPCF		;NO ROOM - GO AWAY
  5869
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 133
SCNSER.MAC	25-NOV-87 19:52		GETLCH - READ LINE CHARACTERISTICS

  5870				SUBTTL	GETLCH - READ LINE CHARACTERISTICS
  5871
  5872	007212'	256200	016414'	GETLIN:	XCTFU <MOVE T1,(M)>
  5873	007213'	260040	007356'		PUSHJ P,CHKLN2	;SEE IF THIS USER CAN HAVE THIS INFO
  5874	007214'	254000	007251'		 JRST GETLNZ	;NO
  5875	007215'	135300	000153'		LDB T1,LDPLNO		;GET NUMBER
  5876	007216'	500305	000031		HLL	T1,LDBDCH(U)	; GET BITS FROM LH WHICH ARE SAME
  5877	007217'	621300	276000		TLZ	T1,-1-GTLMSK	; CLEAR ALL BITS IN LH WHICH ARN'T
  5878	007220'	135400	000014'		LDB T3,LDPHDX	;GET HALF DUPLEX BIT FROM CHRS READ
  5879	007221'	332000	000010		SKIPE T3	;SEE IF ON
  5880	007222'	661300	010000		TLO T1,GTLHDX
  5881	007223'	200405	000032		MOVE	T3, LDBDCX(U)
  5882	007224'	622400	400000		TRZE	T3, LXRESC	;READ AND CLEAR "ESCAPE SEEN"
  5883	007225'	661300	004000		TLO	T1, GTLESC	;RETURN ITS OLD VALUE
  5884	007226'	622400	200000		TRZE	T3, LXROBS	;READ AND CLEAR "ORANGE BALL SEEN"
  5885	007227'	661300	020000		TLO	T1, GTLOBS	;RETURN ITS OLD VALUE
  5886	007230'	202405	000032		MOVEM	T3, LDBDCX(U)
  5887	007231'	205400	200000		MOVSI	T3, LMLPSP
  5888	007232'	612405	000030		TDNE	T3, LDBMOD(U)	;CHECK FOR UNREAD PORT-STATUS MSG
  5889	007233'	661300	040000		TLO	T1, GTLPSP	;AND SET IF THERE IS ONE
  5890	007234'	135400	000010'		LDB T3,LDPCRD	;GET RETURN DELAY BIT
  5891	007235'	332000	000010		SKIPE T3
  5892	007236'	661300	002000		TLO T1,GTLCRD
  5893	007237'	500245	000031		HLL U,LDBDCH(U)	;THE OTHERS FROM NORMAL BITS
  5894	007240'	200405	000015		MOVE T3,LDBBKC(U)	;GET BREAK COUNTER
  5895	007241'	603240	004000		TLNE U,LDLBK2	;IF IN BREAK 2 MODE
  5896	007242'	270405	000016		ADD T3,LDBBK2(U)	;ADD IN THESE
  5897	007243'	602400	777777		TRNE T3,-1
  5898	007244'	665300	000100		TLOA T1,GTLLRD		;SET LINE READY BIT
  5899	007245'	621300	000100		TLZ T1,GTLLRD		;OR TURN IT OFF
  5900	007246'	641300	000020		TLC T1,GTLLCT		;SENSE OF THIS BIT IS WRONG
  5901	007247'	256200	016415'		XCTTU <MOVEM T1,(M)>
  5902	007250'	263040	000000		POPJ P,
  5903
  5904	007251'	256200	016416'	GETLNZ:	XCTBU <SETZM (M)>
  5905	007252'	263040	000000		POPJ P,
  5906
  5907				; THE FOLLOWING BITS ARE IN THE SAME PLACE IN LDBDCH AS IN GETLCH...
  5908			501777	GTLMSK==LDLNOP!LDLDEF!LDLECS!LDLOSU!LDLNFC!LDLNEC!LDLAUX!LDLLCT!LDLTAB!LDLLCP!LDLPTP!LDLFRM
  5909
  5910			100000	GTLECS==100000	;EAT COMMAND SYNCH (CMD AVAIL FOR RESCAN)
  5911			040000	GTLPSP==40000	;PORT STATUS PENDING (UNREAD, see comment at ACPSM)
  5912			020000	GTLOBS==20000	;ORANGE BALL SEEN
  5913			010000	GTLHDX==10000	;HALF DUPLEX
  5914			004000	GTLESC==4000	;ESCAPE SEEN
  5915			002000	GTLCRD==2000	;CARRIAGE-RETURN(NOT LF) PADDING
  5916			001000	GTLDEF==1000	;DEFERRED ECHO MODE
  5917			000200	GTLNFC==200	;NO FREE CRLF (ON LONG LINES)
  5918			000100	GTLLRD==100	;LINE (BREAK) IN BUFFER
  5919			000020	GTLLCT==20	;NO CASE MAPPING
  5920			000010	GTLTAB==10	;HARDWARE HT
  5921			000002	GTLPTP==2	;PAPER TAPE MODE
  5922			000001	GTLFRM==1	;HARDWARE FF/VT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 134
SCNSER.MAC	25-NOV-87 19:52		SETLCH - SET LINE CHARACTERISTICS

  5923				SUBTTL	SETLCH - SET LINE CHARACTERISTICS
  5924
  5925	007253'	010000	000004	SLCTAB:	GTLHDX,,TCNHDX
  5926	007254'	002000	000000		GTLCRD,,TCNCRD
  5927	007255'	000200	000027		GTLNFC,,TCNNFC
  5928	007256'	000020	000026		GTLLCT,,TCNLCT
  5929	007257'	000010	000024		GTLTAB,,TCNTAB
  5930	007260'	000002	000030		GTLPTP,,TCNPTP
  5931	007261'	000001	000025		GTLFRM,,TCNFRM
  5932			000007	SLCTBN==.-SLCTAB
  5933
  5934	007262'	256200	016417'	SETLIN:	XCTFU	<HLRZ P1,(M)>	;P1/ 0,,USER BITS
  5935	007263'	640600	000020		TRC	P1, GTLLCT	;INVERT SENSE OF CASE-MAP BIT
  5936	007264'	200640	016420'		MOVE	P2, [-SLCTBN,,SLCTAB]
  5937	007265'	500415	000000	SETLN1:	HLL	T3, (P2)	;T3/ THE BIT
  5938	007266'	607414	000000		TLNN	T3, (P1)	;SET IT OR CLEAR IT?
  5939	007267'	634340	000007		TDZA	T2, T2		;(CLEAR)
  5940	007270'	201340	000001		MOVEI	T2, 1		;(SET)
  5941	007271'	550315	000000		HRRZ	T1, (P2)	;T1/ THE TC#
  5942	007272'	260040	010145'		PUSHJ	P, SETTCN
  5943	007273'	256000	000000'		 STOPCD 		;WHAT ERROR?
  5944	007274'	253640	007265'		AOBJN	P2, SETLN1
  5945	007275'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 135
SCNSER.MAC	25-NOV-87 19:52		CHARACTER INPUT TTCALLS

  5946				SUBTTL	CHARACTER INPUT TTCALLS
  5947
  5948	007276'	702600	400000*	INCHRS:	NOCHARGE
  5949	007277'	260040	007100'		PUSHJ P,SKPINC			;CAN I GET A CHARACTER (CLEAR ^O)
  5950	007300'	254000	007103'	ICS1:	  JRST NOCTRO			;NO. GIVE NON-SKIP RETURN
  5951	007301'	260040	013112'		PUSHJ P,TWAITS
  5952	007302'	263040	000000		  POPJ	P,			;DETACHED
  5953	007303'	260040	012365'		PUSHJ P,TYI			;GET A CHARACTER
  5954	007304'	254000	007300'		  JRST ICS1			;NONE THERE. SKPINC LIED?
  5955	007305'	350001	000000		AOS 0(P)			;GIVE SKIP RETURN
  5956	007306'	254000	007331'		JRST ICW1A			;AND RETURN THE CHARACTER
  5957	007307'	702600	400000*	INCHSL:	NOCHARGE
  5958	007310'	260040	007110'		PUSHJ P,SKPINL			;IS THERE A LINE AVAILABLE?
  5959	007311'	263040	000000		  POPJ P,0			;NO. NON-SKIP RETURN TO USER
  5960	007312'	260040	013051'		PUSHJ P,TWAITL
  5961	007313'	260040	012365'		PUSHJ P,TYI		;GET THE CRH.
  5962	007314'	254000	007300'		 JRST ICS1		;REALLY NONE THERE
  5963	007315'	350001	000000		AOS (P)			;SET FOR SKIP RETURN
  5964	007316'	254000	007330'		JRST ICW1B		;GO (REMEMBER TO CHARGE
  5965
  5966	007317'	350001	000000	I1CHWL:	AOS (P)		;FROM AUXCAL
  5967	007320'	702600	400000*	INCHWL:	NOCHARGE
  5968	007321'	603240	002000	INWL1:	TLNE U,LDLIMI	;CHECK IMAGE MODE
  5969	007322'	607000	000040		TLNN S,IOEND
  5970	007323'	334000	000000		SKIPA
  5971	007324'	254000	007340'		JRST ICH0		;SEND A 0 CHRACTER
  5972	007325'	260040	013051'		PUSHJ P,TWAITL			;WAIT FOR A LINE TO APPEAR
  5973	007326'	260040	012365'		PUSHJ P,TYI			;GO GET A CHARACTER
  5974	007327'	254000	007321'		  JRST INWL1			;IMPOSSIBLE. NO CHARACTERS.
  5975	007330'	306340	000002	ICW1B:	CAIN T2,%CHBRK		;A BREAK?
  5976	007331'	260040	006343'	ICW1A:	PUSHJ P,SETBRK		;YES, CHARGE
  5977	007332'	606000	000010	ICW1:	TRNN S,10		;IF MODES 10,13,14
  5978	007333'	606000	000002		TRNN S,2		;OR 0,1
  5979	007334'	624400	000600		TRZA T3,600		;SAME AS ANDI 177 SINCE TTGETC GETS 9 BIT BYTE
  5980	007335'	405400	000377		ANDI T3,377		;8 BITS IN MODE 2
  5981	007336'	256200	016421'		XCTTU <MOVEM T3,(M)>			;GIVE HIM THE CHARACTER
  5982	007337'	254000	007103'		JRST NOCTRO			;AND NON-SKIP RETURN
  5983
  5984	007340'	201400	000000	ICH0:	MOVEI T3,0
  5985	007341'	254000	007332'		JRST ICW1
  5986
  5987	007342'	350001	000000	I1CHRW:	AOS (P)		;FROM AUXCAL
  5988	007343'	702600	400000*	INCHRW:	NOCHARGE
  5989	007344'	260040	013114'	INRW1:	PUSHJ P,TWAITC			;WAIT FOR A CHARACTER TO APPEAR
  5990	007345'	260040	012365'		PUSHJ P,TYI			;GO GET THE CHARACTER
  5991	007346'	254000	007344'		  JRST INRW1			;IMPOSSIBLE. NONE THERE
  5992	007347'	254000	007331'		JRST ICW1A			;GIVE HIM T3 AND RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 136
SCNSER.MAC	25-NOV-87 19:52		CHARACTER INPUT TTCALLS

  5993				;Get LDBLOG for GETTAB uuo
  5994	007350'	260040	007357'	GETLOG::PUSHJ	P,CHKLIN	;GETTAB to return LDBLOG.  Check if OK
  5995	007351'	263040	000000		  POPJ	P,		;Error, can not have info
  5996	007352'	334305	000026		SKIPA	T1,LDBLOG(U)
  5997	007353'	201300	000000	RETZRO:	MOVEI	T1,0		;NO LINE THERE, RETURN 0
  5998	007354'	256200	016415'	STOTC1:	UMOVEM	T1,(M)		;RETURN ARGUMENT TO USER'S AREA.
  5999	007355'	254000	007176*		JRST	CPOPJ1		;AND SKIP RETURN.
  6000
  6001	007356'	334240	000006	CHKLN2:	SKIPA	U,T1		;Line # in RH
  6002	007357'	574240	000006	CHKLIN:	HLRE	U,T1		;Line # in LH
  6003	007360'	321240	007364'		JUMPL	U,CKLN1		;-1 for own line
  6004	007361'	303240	005647*		CAILE	U,MXLIN##
  6005	007362'	263040	000000		 POPJ	P,		;Illegal line number
  6006	007363'	334245	006543*		SKIPA	U,LINTAB(U)	;Get addr of LDB
  6007	007364'	260040	014002'	CKLN1:	 PUSHJ	P,TTYFNU	;Find LDB for job
  6008	007365'	322240	007174*		JUMPE	U,CPOPJ		;NO LINE NUMBER THERE
  6009	007366'	550205	000000		HRRZ	F,LDBDDB(U)	;GET THE DDB
  6010	007367'	322200	007365*		JUMPE	F,CPOPJ		;IF NONE, NO ONE CONNECTED
  6011	007370'	135100	006570*		LDB	J,PJOBN		;GET THE JOB NUMBER
  6012	007371'	254000	000000*		JRST	CHKSEG		;AND GO CHECK
  6013
  6014	007372'	260040	007357'	LINJOB::PUSHJ	P,CHKLIN	;Return job which owns a specific line
  6015	007373'	263040	000000		  POPJ	P,
  6016	007374'	550205	000000		HRRZ	F,LDBDDB(U)
  6017	007375'	322200	007353'		JUMPE	F,RETZRO
  6018	007376'	135300	007370*		LDB	T1,PJOBN	;GET THE JOB NUMBER
  6019	007377'	254000	007354'		JRST	STOTC1
  6020
  6021	007400'	260040	007357'	GETLPS::PUSHJ	P,CHKLIN	;Return horizontal position of line
  6022	007401'	263040	000000		  POPJ	P,
  6023	007402'	135300	000171'		LDB	T1,LDPPOS
  6024	007403'	254000	007354'		JRST	STOTC1
  6025
  6026	007404'	260040	007357'	GETMOD::PUSHJ	P,CHKLIN	;Return status (DEVIOS)
  6027	007405'	263040	000000		  POPJ	P,
  6028	007406'	550205	000000		HRRZ	F,LDBDDB(U)
  6029	007407'	322200	007353'		JUMPE	F,RETZRO
  6030	007410'	200304	000002		MOVE	T1,DEVIOS(F)
  6031	007411'	254000	007354'		JRST STOTC1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 137
SCNSER.MAC	25-NOV-87 19:52		CHARACTER INPUT TTCALLS

  6032	007412'	702600	400000*	RDNXT:	NOCHARGE
  6033	007413'	337005	000014		SKIPG LDBECC(U)	;MAKE SURE A CHR IS THERE
  6034	007414'	333005	000012		SKIPLE LDBTIC(U)
  6035	007415'	354001	000000		AOSA (P)
  6036	007416'	263040	000000		POPJ P,			;NO, RETURN
  6037	007417'	200345	000011		MOVE T2,LDBTIT(U)
  6038	007420'	260040	006114'		PUSHJ P,TTGETC
  6039	007421'	255000	000000		 JFCL
  6040	007422'	606000	000010		TRNN S,10		;IF MODES 10,13,14
  6041	007423'	606000	000002		TRNN S,2		;OR 0,1
  6042	007424'	624400	000600		TRZA T3,600		;SAME AS ANDI 177 SINCE TTGETC GETS 9 BIT BYTE
  6043	007425'	405400	000377		ANDI T3,377		;8 BITS IN MODE 2
  6044	007426'	256200	016421'		XCTTU <MOVEM T3,(M)>	;GIVE IT TO HIM
  6045	007427'	263040	000000		POPJ P,
  6046
  6047	007430'	205300	010000	LEVDEF:	MOVSI T1,L2LLDF
  6048	007431'	436305	000027		IORM T1,LDBBYT(U)
  6049	007432'	260040	013221'		PUSHJ P,BPLVD	;TURN OFF BACKPRESSURE IF APPROPRIATE
  6050	007433'	201300	000001		MOVEI T1,1
  6051	007434'	137300	000100'		DPB T1,LOPECO
  6052	007435'	137305	000002		DPB T1,LDBOPB(U)
  6053	007436'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 138
SCNSER.MAC	25-NOV-87 19:52		READ TERMINAL CHARACTERISTICS

  6054				SUBTTL	READ TERMINAL CHARACTERISTICS
  6055
  6056	007437'	256200	016414'	GETMC:	UMOVE T1,(M)	;GET THE LINE HE WANTS THESE FOR
  6057	007440'	260040	007356'		PUSHJ P,CHKLN2
  6058	007441'	254000	007251'		 JRST GETLNZ	;CAN NOT HAVE THEM
  6059	007442'	402000	000006		SETZM	T1	;MAKE UNFILLED FIELDS 0 (ARE THERE ANY?)
  6060	007443'	135400	000166'		LDB T3,LDPFC1	;FILLER CLASS 1
  6061	007444'	137400	007473'		DPB T3,GEPMC1
  6062	007445'	135400	000162'		LDB T3,LDPFC2	;FILLER CLASS 2
  6063	007446'	137400	007474'		DPB T3,GEPMC2
  6064	007447'	135400	000164'		LDB T3,LDPWID	;WIDTH
  6065	007450'	137400	007475'		DPB T3,GEPMC3
  6066	007451'	135400	007476'		LDB T3,GEPMC4	;NO XON, NO TAB, TAB AS BREAK BITS
  6067	007452'	137400	007477'		DPB T3,GEPMC5
  6068	007453'	135400	000011'		LDB T3,LDPIR
  6069	007454'	137400	007500'		DPB T3,GEPMC6
  6070	007455'	135400	000012'		LDB T3,LDPOR
  6071	007456'	137400	007501'		DPB T3,GEPMC7
  6072	007457'	135400	000013'		LDB T3,LDPPAR
  6073	007460'	137400	007502'		DPB T3,GEPMC8
  6074	007461'	135400	000015'		LDB T3,LDPPA
  6075	007462'	137400	007503'		DPB T3,GEPMC9
  6076	007463'	135400	000014'		LDB T3,LDPHDX
  6077	007464'	137400	007504'		DPB T3,GEPM10
  6078	007465'	135400	000016'		LDB T3,LDPPB
  6079	007466'	137400	007505'		DPB T3,GEPM11
  6080	007467'	135400	000017'		LDB T3,LDPPC
  6081	007470'	137400	007506'		DPB T3,GEPM12
  6082	007471'	256200	016415'		UMOVEM T1,(M)
  6083	007472'	263040	000000		POPJ P,
  6084
  6085	007473'	230200	000006	GEPMC1:	POINT 2,T1,16	;FILLER CLASS 1
  6086	007474'	250200	000006	GEPMC2:	POINT 2,T1,14	;FILLER CLASS 2
  6087	007475'	271000	000006	GEPMC3:	POINT 8,T1,12	;WIDTH
  6088	007476'	370305	000027	GEPMC4:	POINT 3,LDBBYT(U),4	;GET NO XON, NO TAB, TAB AS BRK
  6089	007477'	370300	000006	GEPMC5:	POINT 3,T1,4	;LOCATION OF ABOVE IN GETTMC WORD
  6090	007500'	200300	000006	GEPMC6:	POINT 3,T1,19	;IR
  6091	007501'	150300	000006	GEPMC7:	POINT 3,T1,22	;OR
  6092	007502'	140100	000006	GEPMC8:	POINT 1,T1,23	;PAR
  6093	007503'	110300	000006	GEPMC9:	POINT 3,T1,26	;PA
  6094	007504'	100100	000006	GEPM10:	POINT 1,T1,27	;HDX
  6095	007505'	050300	000006	GEPM11:	POINT 3,T1,30	;PB
  6096	007506'	000500	000006	GEPM12:	POINT 5,T1,35	;0 BIT + PC
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 139
SCNSER.MAC	25-NOV-87 19:52		FIXIMI CALLED ON INPUT UUOS OTHER THAN AUXCALS 0,1,2 TO SET

  6097				SUBTTL	FIXIMI CALLED ON INPUT UUOS OTHER THAN AUXCALS 0,1,2 TO SET
  6098				;IMAGE STATE FROM DATA MODE
  6099
  6100	007507'	200305	000031	FIXIMI:	MOVE	T1,LDBDCH(U)
  6101	007510'	607300	000040		TLNN	T1,LDLAUX	;AUX CIRCUIT?
  6102	007511'	602000	000010		TRNE	S,I		;OR DATA MODE = I, IB, B?
  6103	007512'	665300	002000		 TLOA	T1,LDLIMI	;YES: SET IMAGE STATE
  6104	007513'	621300	002000		TLZ	T1,LDLIMI	;NO: CLEAR IMAGE STATE
  6105	007514'	316305	000031		CAMN	T1,LDBDCH(U)	;DID IT CHANGE?
  6106	007515'	263040	000000		 POPJ	P,		;NO
  6107	007516'	202305	000031		MOVEM	T1,LDBDCH(U)	;YES
  6108	007517'	324740	007534'		PJRST	SETLMD
  6109
  6110				;CLRIMI CALLED ON OUTPUT UUOS TO CLEAR IMAGE STATE IF DATA
  6111				;MODE IS NOT IMAGE AND TO TURN OFF BACKPRESSURE (IN GENERAL,
  6112				;TO NOTE THAT THE LINE IS NO LONGER SIMPLY IN INPUT WAIT)
  6113
  6114	007520'	550205	000000	CLRIMI:	HRRZ	F,LDBDDB(U)		;GET ATTACHED JOB, IF ANY
  6115	007521'	322200	007525'		JUMPE	F,CLRIM1		;IF NONE, SKIP PART OF THIS
  6116	007522'	200004	000002		MOVE	S,DEVIOS(F)		;JOB'S IO STATUS FOR TTY
  6117	007523'	602000	000010		TRNE	S,I			;IS IT STILL IN IMAGE MODE?
  6118	007524'	263040	000000		 POPJ	P,0			;YES. FORGET IT.
  6119	007525'	205300	002000	CLRIM1:	MOVSI	T1,LDLIMI		;NO. CLEAR IMAGE BIT AND TIME
  6120	007526'	607240	000040		TLNN	U,LDLAUX		;AUX ALWAYS IN IMAGE MODE
  6121	007527'	616305	000031		TDNN	T1,LDBDCH(U)		;IS IT ON?
  6122	007530'	263040	000000		 POPJ	P,			;NO
  6123	007531'	412305	000031		ANDCAM	T1,LDBDCH(U)		; ..
  6124	007532'	260040	013257'		PUSHJ	P,BPTEST		;WANT TO TURN OFF BACKPRESSURE?
  6125	007533'	260040	013246'		  PUSHJ	P,BPOFF			;YES, NOW TURN OFF BACKPRESSURE
  6126					PFALL	SETLMD
  6127
  6128	007534'	135300	000203'	SETLMD:	LDB	T1,LDPMDF		;GET LINE MODE FLAGS
  6129	007535'	200306	003124'		MOVE	T1,MDFLMD(T1)		;DO TRANSLATION INTO MODE
  6130	007536'	137300	000174'		DPB	T1,LDPLMD		;AND SET INPUT AND ECHO MODES
  6131	007537'	263040	000000		POPJ	P,0			; AND RETURN
  6132	
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 140
SCNSER.MAC	25-NOV-87 19:52		SETTBK - SET TABS AS BREAK

  6133				SUBTTL	SETTBK - SET TABS AS BREAK
  6134				;SETTBK - CALLED WITH
  6135				;	T1/ L2LTBK,,L2LTBK	SET TAB-AS-BREAK
  6136				;	T1/	 0,,L2LTBK	SET TAB-AS-PUNCTUATION
  6137				;	T1/ L2LBBP,,L2LBBP	SET BS-AS-PUNCTUATION
  6138				;	T1/	 0,,L2LBBP	SET BS-AS-BREAK
  6139				;BREAKS T1-T4
  6140
  6141	007540'	200340	000006	SETTBK:	MOVE	T2, T1
  6142	007541'	430305	000027		XOR	T1, LDBBYT(U)
  6143	007542'	607307	000000		TLNN	T1, 0(T2)	;IF THE BIT DIDN'T CHANGE,
  6144	007543'	263040	000000		POPJ	P,		;  JUST RETURN
  6145	007544'	514300	000007		HRLZ	T1, T2
  6146	007545'	432305	000027		XORM	T1, LDBBYT(U)	;INVERT THE LDB BIT
  6147	007546'	201300	000011		MOVEI	T1, 11		;(ASSUME IT'S TAB-AS-BREAK)
  6148	007547'	606340	040000		TRNN	T2, L2LBBP	;IF IT'S BS-AS-PUNCTUATION,
  6149	007550'	254000	007553'		JRST	SETTB1
  6150	007551'	201300	000010		MOVEI	T1, 10		;  CHAR := 10
  6151	007552'	641340	040000		TLC	T2, L2LBBP	;  INVERT SENSE (TO BS-AS-BREAK)
  6152	007553'	603340	777777	SETTB1:	TLNE	T2, -1		;WHICH WAY?
  6153	007554'	324740	007563'		PJRST	PNTOBK		;(PUNCTUATION = BREAK)
  6154	007555'	324740	007556'		PJRST	BKTOPN		;(BREAK = PUNCTUATION)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 141
SCNSER.MAC	25-NOV-87 19:52		BKTOPN - CALLED WITH U/ LDB ADDR, T1/ <CHAR>

  6155				SUBTTL	BKTOPN - CALLED WITH U/ LDB ADDR, T1/ <CHAR>
  6156				;	   MAKE <CHAR> GO FROM A BREAK TO A PUNCTUATION CHARACTER
  6157				;	   BY ADJUSTING COUNTS
  6158				;	   DESTROYS T1 T2 T3 T4
  6159
  6160	007556'	260040	007574'	BKTOPN:	PUSHJ	P, CHRCNT	;T1/ #UNECHOED,,#ECHOED
  6161	007557'	272305	000016		ADDM	T1, LDBBK2(U)	;ADD TO PUNCTUATION COUNT
  6162	007560'	213000	000006		MOVNS	T1
  6163	007561'	272305	000015		ADDM	T1, LDBBKC(U)	;SUBTRACT FROM BREAK COUNT
  6164	007562'	263040	000000		POPJ	P,
  6165
  6166				;PNTOBK - CALLED WITH U/ LDB ADDR, T1/ <CHAR>
  6167				;	   MAKE <CHAR> GO FROM A PUNCTUATION TO A BREAK CHARACTER
  6168				;	   BY ADJUSTING COUNTS, LINE DELETE POINTER
  6169				;	   DESTROYS T1 T2 T3 T4
  6170
  6171	007563'	260040	007574'	PNTOBK:	PUSHJ	P, CHRCNT	;P2/ #UNECHOED,,#ECHOED
  6172	007564'	272305	000015		ADDM	T1, LDBBKC(U)	;ADD TO BREAK COUNT
  6173	007565'	213000	000006		MOVNS	T1
  6174	007566'	272305	000016		ADDM	T1, LDBBK2(U)	;SUBTRACT FROM PUNCTUATION COUNT
  6175	007567'	322300	007573'		JUMPE	T1, PNTOB1	;IF THERE ARE ANY NEW BREAK CHARACTERS,
  6176	007570'	200345	000010		MOVE	T2, LDBTIP(U)
  6177	007571'	202345	000006		MOVEM	T2, LDBBKP(U)	;  SET LINE-DELETE POINTER TO NOW
  6178	007572'	402005	000007		SETZM	LDBBKI(U)	;  (NO DELETABLE CHARACTERS)
  6179	007573'	263040	000000	PNTOB1:	POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 142
SCNSER.MAC	25-NOV-87 19:52		CHRCNT - CALLED WITH U/ LDB ADDR, T1/ CHAR

  6180				SUBTTL	CHRCNT - CALLED WITH U/ LDB ADDR, T1/ CHAR
  6181				;	   RETURNS T1/ #UNECHOED,,#ECHOED <CHAR>S IN THE INPUT BUFFER
  6182				;	   DESTROYS T1 T2 T3 T4
  6183
  6184	007574'	261040	000014	CHRCNT:	PUSH	P, P1
  6185	007575'	261040	000015		PUSH	P, P2
  6186	007576'	200600	000006		MOVE	P1, T1		;P1/ CHAR
  6187	007577'	400640	000000		SETZ	P2,		;P2/ COUNT
  6188	007600'	200345	000013		MOVE	T2, LDBECT(U)	;T2/ ECHO-TAKER BYTE POINTER
  6189	007601'	332445	000014		SKIPE	T4, LDBECC(U)	;T4/ #UNECHOED,UNREAD CHARACTERS
  6190	007602'	260040	007613'		PUSHJ	P, CNTCHR	;IF ANY, COUNT #<CHAR>S
  6191	007603'	517000	000015		HRLZS	P2		;P2/ UNECHOED,,ECHOED
  6192	007604'	200345	000011		MOVE	T2, LDBTIT(U)	;T2/ CHAR-TAKER BYTE POINTER
  6193	007605'	332445	000012		SKIPE	T4, LDBTIC(U)	;T4/ #ECHOED,UNREAD CHARACTERS
  6194	007606'	260040	007613'		PUSHJ	P, CNTCHR	;IF ANY, COUNT #<CHAR>S
  6195	007607'	200300	000015		MOVE	T1, P2		;T1/ COUNT
  6196	007610'	262040	000015		POP	P, P2
  6197	007611'	262040	000014		POP	P, P1
  6198	007612'	263040	000000		POPJ	P,
  6199
  6200				    ;T2/ BUFFERLET BYTE POINTER, T4/ COUNT
  6201				    ;P1/ <CHAR> TO LOOK FOR, P2/ COUNT TO INCREMENT
  6202
  6203	007613'	260040	006114'	CNTCHR:	PUSHJ	P, TTGETC	;T3/ NEXT CHAR
  6204	007614'	255000	000000		  JFCL			;(EH?)
  6205	007615'	405400	000177		ANDI	T3, 177		;T3/ ASCII PART OF THE CHAR
  6206	007616'	316400	000014		CAMN	T3, P1		;IF IT'S THE <CHAR>,
  6207	007617'	350000	000015		AOS	P2		;  COUNT IT
  6208	007620'	367440	007613'		SOJG	T4, CNTCHR
  6209	007621'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 143
SCNSER.MAC	25-NOV-87 19:52		SETPTP - SETS PAPER-TAPE-MODE BIT (SIMILAR CODE IN SETLIN)

  6210				SUBTTL	SETPTP - SETS PAPER-TAPE-MODE BIT (SIMILAR CODE IN SETLIN)
  6211				;	   T1/ 0 TO CLEAR PTP, LDLPTP,,0 TO SET PTP MODE
  6212				;	   (DESTROYS T1)
  6213
  6214	007622'	430305	000031	SETPTP:	XOR	T1, LDBDCH(U)
  6215	007623'	607300	000002		TLNN	T1, LDLPTP	;IF IT'S NOT CHANGING,
  6216	007624'	263040	000000		POPJ	P,		;  JUST RETURN
  6217	007625'	433305	000031		XORB	T1, LDBDCH(U)	;SET DCH BIT
  6218	007626'	603300	000002		TLNE	T1, LDLPTP	;IN PTP MODE?
  6219	007627'	634300	000006		TDZA	T1, T1		;YES: ECHO CR AS CR
  6220	007630'	201300	000001		MOVEI	T1, 1		;NO: ECHO CR AS CRLF
  6221	007631'	137300	000033'		DPB	T1, LDSECR
  6222	007632'	200300	016422'		MOVE	T1, [LTSECR]
  6223	007633'	436305	000046		IORM	T1, LDBTMT(U)
  6224	007634'	201300	000001		MOVEI	T1, 1
  6225	007635'	137300	000067'		DPB	T1, LOPSTC	;SET SEND-CHARACTERISTICS
  6226	007636'	137305	000002		DPB	T1, LDBOPB(U)	;SET WANT-OUTPUT
  6227	007637'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 144
SCNSER.MAC	25-NOV-87 19:52		PSEUDO-TTYS

  6228				SUBTTL PSEUDO-TTYS
  6229
  6230				;CREPTY UUO - CREATE A PTY
  6231				;
  6232				;	CREPTY	AC,
  6233				;	  ERROR RETURN	;AC/ ERROR CODE
  6234				;	NORMAL RETURN	;AC/ PORT1#,,PORT2#
  6235
  6236			000001	CPNPT%==1	;OUT OF PTYS (OR THERE NEVER WERE ANY)
  6237			000002	CPNRM%==2	;NO ROOM FOR PTYS (OUT OF DDBS)
  6238
  6239	007640'	260040	007662'	CREPTY::PUSHJ	P, GETPP	;GET A PORT# PAIR. T1/ EVEN SIDE #
  6240					  JRST	[MOVEI	T1,CPNPT%
  6241	007641'	254000	016423'			 JRST	CPERR	]
  6242	007642'	202300	000014		MOVEM	T1, P1
  6243	007643'	260040	007701'		PUSHJ	P, PTYLDB	;SET UP ITS LDB. U/ LDB ADDR
  6244	007644'	506240	000015		HRLM	U, P2		;P2/ EVEN-SIDE LDB,,---
  6245	007645'	260040	007734'		PUSHJ	P, PTYDDB	;SET UP ITS DDB. F/ DDB ADDR
  6246					  JRST	[MOVEI	T1, CPNRM%
  6247	007646'	254000	016425'			 JRST	CPERR	]
  6248	007647'	542200	000015		HRRM	F, P2		;P2/ EVEN-SIDE LDB,,DDB
  6249	007650'	201314	000001		MOVEI	T1, 1(P1)	;T1/ ODD-SIDE PORT#
  6250	007651'	260040	007701'		PUSHJ	P, PTYLDB	;SET UP ITS LDB. U/ LDB ADDR
  6251	007652'	260040	007734'		PUSHJ	P, PTYDDB	;SET UP ITS DDB. F/ DDB ADDR
  6252					  JRST	[HRRZ	F, P2
  6253						 PUSHJ	P, TTYKDB	;FREE EVEN DDB
  6254						 HLRZ	U, P2
  6255						 HLLZS	LDBDDB(U)	;DETACH EVEN LDB
  6256						 SETZM	LDBLOG(U)	;FREE EVEN LDB (leave LDPHST)
  6257						 MOVEI	T1,CPNRM%
  6258	007653'	254000	016427'			 JRST	CPERR	]
  6259	007654'	507000	000014		HRLS	P1		;P1/ EVEN PORT#,,EVEN PORT#
  6260	007655'	660600	000001		TRO	P1, 1		;P1/ EVEN PORT#,,ODD PORT#
  6261	007656'	256200	016436'		UMOVEM	P1, (M)		;GIVE USER THE PORT #S
  6262	007657'	254000	007355*		JRST	CPOPJ1		;SUCCESS!
  6263
  6264	007660'	256200	016415'	CPERR:	UMOVEM	T1, (M)		;GIVE USER THE ERROR CODE
  6265	007661'	263040	000000		POPJ	P,		;FAILURE!
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 145
SCNSER.MAC	25-NOV-87 19:52		GETPP - GET AN EVEN/ODD PTY PORT # PAIR

  6266				SUBTTL	GETPP - GET AN EVEN/ODD PTY PORT # PAIR
  6267				;	  NONSKIP-RETURN IF NONE
  6268				;	  SKIP-RETURN WITH T1/ THE EVEN # ON SUCCESS
  6269				;DESTROYS T2 U
  6270
  6271	007662'	334300	016437'	GETPP:	SKIPA	T1,[<<PORTN##-PPORTN##+1>&<-1-1>>]
  6272	007663'	271300	000002	GETPP1:	ADDI	T1,2		;GO ON TO THE NEXT PAIR
  6273	007664'	303300	777776*		CAILE	T1,PORTN##-2	;IF WE'RE PAST THE TOP PAIR,
  6274	007665'	263040	000000		 POPJ	P,		;  FAIL
  6275	007666'	550346	007363*		HRRZ	T2,LINTAB(T1)	;T2/ EVEN-SIDE LDB ADDR
  6276	007667'	332007	000026		SKIPE	LDBLOG(T2)	;IF IT'S LOGGED-IN,
  6277	007670'	254000	007663'		 JRST	GETPP1		;  TRY THE NEXT PAIR
  6278	007671'	550346	000001*		HRRZ	T2,LINTAB+1(T1)	;T2/ ODD-SIDE LDB ADDR
  6279	007672'	332007	000026		SKIPE	LDBLOG(T2)	;IF IT'S LOGGED-IN,
  6280	007673'	254000	007663'		 JRST	GETPP1		;  TRY THE NEXT PAIR
  6281	007674'	254000	007657*		JRST	CPOPJ1		;SUCCESS!
  6282
  6283				;PTYBUD - GET PTY BUDDY
  6284				;	CALLED WITH U/ PTY LDB
  6285				;	RETURNS U/ PTY LDB OF ITS OTHER END
  6286
  6287	007675'	135240	000153'	PTYBUD:	LDB	U,LDPLNO
  6288	007676'	640240	000001		TRC	U,1
  6289	007677'	550245	007666*		HRRZ	U,LINTAB(U)	;U/ "BUDDY" LDB ADDR
  6290	007700'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 146
SCNSER.MAC	25-NOV-87 19:52		PTYLDB - SET UP A PTY LDB

  6291				SUBTTL	PTYLDB - SET UP A PTY LDB
  6292				;	   CALLED WITH T1/ PTY PORT #
  6293				;	   RETURN WITH U/ THE LDB
  6294
  6295	007701'	550246	007677*	PTYLDB:	HRRZ	U,LINTAB(T1)	;U/ LDB ADDR
  6296	007702'	336000	000005		SKIPN	U
  6297	007703'	256000	000000'		 STOPCD
  6298	007704'	135340	000153'		LDB	T2,LDPLNO	;T2/ LDB'S IDEA OF ITS PORT #
  6299	007705'	312300	000007		CAME	T1,T2
  6300	007706'	256000	000000'		 STOPCD
  6301
  6302				    ;NOW THAT WE'VE GOT THE LDB, INITIALIZE IT
  6303				    ;THIS CODE SHOULD REMAIN ALMOST IDENTICAL WITH
  6304				    ;THE CODE AT AUXINP FOR NEW AUX CIRCUITS
  6305
  6306	007707'	205300	400000		MOVSI	T1,(1B0)	;"Logged-in" bit (term id of 0)
  6307	007710'	135340	000153'		LDB	T2,LDPLNO	;This line's number
  6308	007711'	640340	000001		TRC	T2,1		;Circuit came from its buddy
  6309	007712'	137340	016440'		DPB	T2,[POINT 8,T1,35] ;Origination line number
  6310	007713'	202305	000026		MOVEM	T1,LDBLOG(U)	;Node number gets set by LOGLDB routine
  6311	007714'	200300	000670*		MOVE	T1,SYSNUM##	;System number is
  6312	007715'	137300	000154'		DPB	T1,LDPHST	; origination host number for PTY
  6313	007716'	402005	000003		SETZM	LDBOUT(U)
  6314	007717'	402005	000027		SETZM	LDBBYT(U)
  6315	007720'	402005	000030		SETZM	LDBMOD(U)
  6316	007721'	201300	000120		MOVEI	T1,^D80		;"SET TTY WIDTH 80"
  6317	007722'	137300	000164'		DPB	T1,LDPWID
  6318	007723'	402005	000046		SETZM	LDBTMT(U)
  6319			000000		ZZN==0
  6320	007724'	402005	000044		REPEAT TMCSIZ, <SETZM LDBTMR+ZZN(U)
  6321			000001		ZZN==ZZN+1>
  6322	007725'	205300	041000		MOVSI	T1,LDLDEF!LDLPTY
  6323	007726'	202305	000031		MOVEM	T1,LDBDCH(U)	;DIFFERENT FROM AUX CIRCUITS!
  6324	007727'	205300	400000		MOVSI	T1,LXL120
  6325	007730'	202305	000032		MOVEM	T1,LDBDCX(U)	;BUFFER AS A FAST LINE
  6326	007731'	402005	000004		SETZM	LDBTCB(U)	;NO CHANGED TERMINAL CHARACTERISTICS
  6327	007732'	260040	007534'		PUSHJ	P,SETLMD	;SET THE LINE MODE
  6328	007733'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 147
SCNSER.MAC	25-NOV-87 19:52		PTYDDB - ALLOCATE, LINK IN, ATTACH, INITIALIZE A PTY DDB

  6329				SUBTTL	PTYDDB - ALLOCATE, LINK IN, ATTACH, INITIALIZE A PTY DDB
  6330				;	   CALLED WITH U/ LDB ADDRESS, J/ ATTACHEE JOB #
  6331				;	   NONSKIP-RETURNS IF THERE ARE NO FREE DDBS
  6332				;	   SKIP-RETURNS WITH F/ DDB ADDR ON SUCCESS
  6333
  6334	007734'	550302	006715*	PTYDDB:	HRRZ	T1, TTYTAB(J)	;T1/ CMND PORT DDB
  6335	007735'	336000	000006		SKIPN	T1
  6336	007736'	256000	000000'		 STOPCD 		;(THERE MUST BE ONE)
  6337	007737'	260040	015147'		PUSHJ	P, DDBSR1	;F/ NEW DDB, LINKED AFTER CMND PORT
  6338	007740'	263040	000000		  POPJ	P,		;FAIL-RETURN
  6339
  6340	007741'	137100	007376*		DPB	J, PJOBN	;SET JOB # OF OWNER
  6341	007742'	260040	015213'		PUSHJ	P, SCNNAM	;SET PHYSICAL NAME
  6342	007743'	201300	400000		MOVEI	T1, ASSCON
  6343	007744'	436304	000004		IORM	T1, DEVMOD(F)	;MARK IT ASSIGNED-BY-CONSOLE
  6344	007745'	201300	020000		MOVEI	T1, TTYATC
  6345	007746'	412304	000004		ANDCAM	T1, DEVMOD(F)	;AND NOT THE COMMAND PORT
  6346
  6347	007747'	350001	000000		AOS	(P)		;SET TO SKIP-RETURN
  6348	007750'	324740	015115'		PJRST	COMATT		;AND ATTACH IT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 148
SCNSER.MAC	25-NOV-87 19:52		AUXCAL UUO

  6349				SUBTTL AUXCAL UUO
  6350
  6351				;AUXCAL UUO
  6352
  6353	007751'	256200	016441'	AUXTUU::XCTFU	<HLRE F,(W)>	;F/ PORT DESCRIPTOR
  6354	007752'	200100	000000*		MOVE	J,JOB		;J/ JOB #
  6355	007753'	260040	015541'		PUSHJ	P,FNDPRT	;F := DDB ADDR.
  6356	007754'	263040	000000		  POPJ	P,		;(NO PORT OR NOT THIS JOB'S PORT)
  6357	007755'	550244	000013		HRRZ	U,DDBLDB(F)	;U/ LDB ADDR
  6358	007756'	322240	007367*		JUMPE	U,CPOPJ	;IF DETACHED, JUST RETURN
  6359	007757'	256200	016442'		XCTFU	<HRRZ T1,(W)>	;T1/ FUNCTION CODE
  6360	007760'	303300	000103		CAILE	T1,MAXAXC	;IF IT'S OUT OF RANGE,
  6361	007761'	263040	000000		 POPJ	P,		;  JUST RETURN
  6362	007762'	200406	010005'		MOVE	T3,AXCTAB(T1)
  6363	007763'	200004	000002		MOVE	S,DEVIOS(F)	;S/ FILE STATUS BITS
  6364	007764'	260040	013004'		PUSHJ	P,UUOLDB	;SET UP LDB
  6365	007765'	607400	020000		TLNN	T3,TUUROM
  6366	007766'	254000	007771'		 JRST	AUXTU0
  6367	007767'	260040	012662'		PUSHJ	P,CHKROM
  6368	007770'	254000	007751'		JRST	AUXTUU
  6369	007771'	603400	040000	AUXTU0:	TLNE	T3,TUUAIR
  6370	007772'	607240	020000		TLNN	U,LDLCOM	;INPUT NOT ALLOWED IF AT COMMAND LEVEL
  6371	007773'	334000	000000		 SKIPA
  6372	007774'	263040	000000		  POPJ	P,
  6373	007775'	603400	010000		TLNE	T3,TUUEAT
  6374	007776'	260040	012514'		 PUSHJ	P,TYIEAT
  6375				IFE OPCRET,<	; KLUDGE TIL OPERATIONS CAN WRITE 10 CODE
  6376					TLNE	T3,TUUFXI
  6377					PUSHJ	P,FIXIMI	;SET IMAGE STATE FROM DATA MODE
  6378				>;OPCRET=1 IF PROGRAMS THINK TTCALLS IGNORE IMAGE
  6379
  6380	007777'	607400	002000		TLNN	T3,TUUIMI
  6381	010000'	254000	010004'		 JRST	AUXTU1
  6382	010001'	205300	002000		MOVSI	T1,LDLIMI
  6383	010002'	436305	000031		IORM	T1,LDBDCH(U)	;SET IMAGE STATE ALWAYS
  6384	010003'	260040	007534'		PUSHJ	P,SETLMD
  6385	010004'	254010	000000	AUXTU1:	JRST	(T3)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 149
SCNSER.MAC	25-NOV-87 19:52		AUXCAL dispatch table

  6386				SUBTTL	AUXCAL dispatch table
  6387
  6388	010005'	052000	010544'	AXCTAB:	TUUAIR!TUUEAT!TUUIMI,,ACINWC	;0 INPUT CHRS AND WAIT
  6389	010006'	052000	010554'		TUUAIR!TUUEAT!TUUIMI,,ACINSC	;1 INPUT CHRS AND SKIP
  6390	010007'	052000	010566'		TUUAIR!TUUEAT!TUUIMI,,ACINWB	;2 INPUT CHRS ELSE AWAIT BREAK
  6391	010010'	020000	007057'			      TUUROM,,IONEOU	;3 OUTPUT CHARACTER
  6392	010011'	020000	007056'			      TUUROM,,ACOTCI	;4 OUTPUT CHARACTER IMMEDIATE
  6393	010012'	020000	007122'			      TUUROM,,OUTPTR	;5 OUTPUT FROM POINTER
  6394	010013'	000000	006203'				      TSETBI	;6 CLEAR INPUT BUFFER
  6395	010014'	000000	006234'				      TSETBO	;7 CLEAR OUTPUT BUFFER
  6396	010015'	054000	007100'		TUUAIR!TUUEAT!TUUFXI,,SKPINC	;10 SKIP IF CHRS PRESENT
  6397	010016'	004000	007430'			      TUUFXI,,LEVDEF	;11 LEAVE DEFERRED ECHO MODE
  6398	010017'	000000	010512'				      ACSYL	;12 SEND YELLOW BALL
  6399	010020'	000000	010536'				      ACBRKC	;13 SET BREAK CHARACTER
  6400	010021'	000000	010500'			      TCNCRD,,ACTMC	;14 CR DELAY (NOT LF)
  6401	010022'	000001	010500'			       TCNIR,,ACTMC	;15 INPUT RATE
  6402	010023'	000002	010500'			       TCNOR,,ACTMC	;16 OUTPUT RATE
  6403	010024'	000003	010500'			      TCNPAR,,ACTMC	;17 PARITY
  6404	010025'	000004	010500'			      TCNHDX,,ACTMC	;20 HALF DUPLEX
  6405	010026'	000005	010500'			       TCNPA,,ACTMC	;21 PARAMETER A
  6406	010027'	000006	010500'			       TCNPB,,ACTMC	;22 PARAMTER B
  6407	010030'	000007	010500'			       TCNPC,,ACTMC	;23 PARAMETER C
  6408	010031'	000014	010500'			      TCNNXO,,ACTMC	;24 SET NO XON-XOFF
  6409	010032'	000000	010432'				      ACNTB	;25 SET NO SPECIAL TAB HANDLING
  6410	010033'	000000	010440'				      ACTBK	;26 SET TABS AS BREAKS
  6411	010034'	000015	010500'			      TCNWID,,ACTMC	;27 SET WIDTH
  6412	010035'	000016	010500'			      TCNFC1,,ACTMC	;30 SET FILLER CLASS 1
  6413	010036'	000017	010500'			      TCNFC2,,ACTMC	;31 SET FILLER CLASS 2
  6414	010037'	000000	000000*				      SETIO2	;32 SET FILE STATUS, DON'T FIXIMI
  6415	010040'	000000	010573'				      FRCINP	;33 FORCE INPUT
  6416	010041'	000000	011554'				      BLKIO	;34 ENABLE BLOCK INPUT/OUTPUT
  6417	010042'	050000	011644'		       TUUAIR!TUUEAT,,BLKINP	;35 INPUT A BLOCK
  6418	010043'	050000	011660'		       TUUAIR!TUUEAT,,BLKINS	;36 INPUT BLOCK &SKIP IF DATA
  6419	010044'	000000	011763'				      BLKOUT	;37 OUTPUT A BLOCK
  6420	010045'	000000	012321'				      BLKXIN	;40 REQUEST BLOCK INPUT TERMINATION
  6421	010046'	000000	012347'				      BLKXOT	;41 REQUEST BLOCK OUTPUT TERMINATION.
  6422	010047'	000000	011601'				      BLKXIO	;42 TERMINATE BLOCK I/O MODE
  6423	010050'	000000	010736'				      MAKDET	;43 TURN COMMAND PORT TO "AUX"PORT
  6424	010051'	014000	007342'		       TUUEAT!TUUFXI,,I1CHRW	;44 INPUT CHRS AND WAIT
  6425	010052'	054000	007276'		TUUAIR!TUUEAT!TUUFXI,,INCHRS	;45 INPUT CHRS AND SKIP
  6426	010053'	014000	007317'		       TUUEAT!TUUFXI,,I1CHWL	;46 INPUT CHRS AND WAIT LINE
  6427	010054'	054000	007307'		TUUAIR!TUUEAT!TUUFXI,,INCHSL	;47 INPUT CHRS AND SKIP LINE
  6428	010055'	054000	007110'		TUUAIR!TUUEAT!TUUFXI,,SKPINL	;50 SKIP IF LINE PRESENT
  6429	010056'	020000	007037'			      TUUROM,,OUTCHI	;51 OUTPUT CHR IMMEDIATE (NOT IMAGE
  6430	010057'	020000	007065'			      TUUROM,,OUTSTR	;52 OUTPUT STRING
  6431	010060'	000010	010500'			      TCNXON,,ACTMC	;53 SET XON-XOFF PARAMETER
  6432	010061'	000011	010500'			      TCNECH,,ACTMC	;54 SET ECHO CONTROL H PARAMETER
  6433	010062'	000012	010500'			      TCNRXE,,ACTMC	;55 SET REVERSE XON-XOFF PARAMTER
  6434	010063'	000013	010500'			       TCNPD,,ACTMC	;56 SET PARM D (was TCNTYP/TCNKAT)
  6435	010064'	000020	010500'			      TCNBSP,,ACTMC	;57 SEND BACKSPACE FOR RUBOUT SEQ
  6436	010065'	000000	010526'				      ACHNG	;60 SEND HANGUP
  6437	010066'	000000	010531'				      ACPSM	;61 READ PORT STATUS MESSAGE
  6438	010067'	000021	010500'			      TCNERA,,ACTMC	;62 ERASE FOR CHAR DELETE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 149-2
SCNSER.MAC	25-NOV-87 19:52		AUXCAL dispatch table

  6439	010070'	000022	010500'			      TCNDEF,,ACTMC	;63 DEFERRED-ECHO MODE
  6440	010071'	000000	010506'				      ACSFS	;64 SET FILE STATUS, THEN FIXIMI
  6441	010072'	000023	010500'			      TCNLCO,,ACTMC	;65 SET/CLEAR LOWER CASE ONLY OUTPUT FLAG
  6442	010073'	000000	010450'				      ACBBP	;66 SET BACKSPACE AS BREAK2
  6443	010074'	020000	007143'			      TUUROM,,OUTPTC	;67 OUTPUT FROM POINTER+COUNT
  6444	010075'	000000	010515'				      ACSOB	;70 SEND ORANGE BALL
  6445	010076'	000000	010460'				      ACSOX	;71 SET/CLEAR SUPPRESS-OUTPUT-TRANSLATION
  6446	010077'	000000	010625'				      FRCRSC	;72 FORCE A RESCAN LINE (COUNT/POINTER
  6447	010100'	000000	010111'				      ACTCN	;73 SET TERMINAL CHARACTERISTIC BY NUMBER
  6448	010101'	000000	010120'				      ACTCP	;74 READ CHANGED TC #,,VAL FOR A PTY
  6449	010102'	000000	010473'				      ACNZP	;75 NO-ZAP-ON-RESET BIT
  6450	010103'	000000	007171'				      OUTSNW	;76 OUTPUT STRING, NEVER WAIT
  6451	010104'	000031	010500'			      TCNBSD,,ACTMC	;77 BACKSPACE == RUBOUT/^A
  6452	010105'	000032	010500'			      TCNCLA,,ACTMC	;100 Set/Read Terminal Class
  6453	010106'	000033	010500'			      TCNRTC,,ACTMC	;101 Set/Read LXLRTC (Special ^T Mode)
  6454	010107'	000034	010500'			      TCNKAT,,ACTMC	;102 Set/Read Katakana bit
  6455	010110'	000035	010500'			      TCNTYP,,ACTMC	;103 Set/Read Terminal Type
  6456			000103	MAXAXC==.-AXCTAB-1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 150
SCNSER.MAC	25-NOV-87 19:52		READ/SET TERMINAL CHARACTERISTICS BY NUMBER

  6457				SUBTTL	READ/SET TERMINAL CHARACTERISTICS BY NUMBER
  6458
  6459	010111'	256200	016443'	ACTCN:	XCTFU	<HLRZ T1,(M)>	;T1/ CHAR #
  6460	010112'	256200	016444'		XCTFU	<HRRE T2,(M)>	;T2/ NEW VALUE OR -1 TO READ
  6461	010113'	260040	010145'		PUSHJ	P,SETTCN	;TRY TO DO IT
  6462	010114'	263040	000000		  POPJ	P,		;(BAD TC# OR BAD NEW VALUE)
  6463	010115'	256200	016445'		XCTBU	<HRRM T3,(M)>	;GIVE USER THE OLD VALUE
  6464	010116'	350001	000000		AOS	(P)
  6465	010117'	263040	000000		POPJ	P,
  6466
  6467				;READ CHANGED TERMINAL CHARACTERISTIC FROM PTY
  6468
  6469	010120'	500245	000031	ACTCP:	HLL	U,LDBDCH(U)
  6470	010121'	607240	040000		TLNN	U,LDLPTY	;IF IT'S NOT A PTY,
  6471	010122'	263040	000000		 POPJ	P,		;  ERROR-RETURN
  6472	010123'	261040	000005		PUSH	P,U
  6473	010124'	260040	007675'		PUSHJ	P,PTYBUD
  6474	010125'	200305	000004		MOVE	T1,LDBTCB(U)	;T1/ CHANGED-TC BITS
  6475	010126'	243300	010131'		JFFO	T1,ACTCP1	;IF NONE,
  6476	010127'	256200	016446'		XCTTU	<SETOM (M)>	;  GIVE CALLER A -1 WORD
  6477	010130'	254000	010143'		JRST	ACTCP2
  6478	010131'	210300	000007	ACTCP1:	MOVN	T1,T2
  6479	010132'	205440	400000		MOVSI	T4,(1B0)
  6480	010133'	242446	000000		LSH	T4,(T1)
  6481	010134'	412445	000004		ANDCAM	T4,LDBTCB(U)	;CLEAR THE "UNREAD" BIT
  6482	010135'	200300	000007		MOVE	T1,T2		;T1/ TC#
  6483	010136'	256200	016447'		XCTBU	<HRLM T1,(M)>	;GIVE CALLER THE TC#
  6484	010137'	474340	000000		SETO	T2,		;-1 = READ TC
  6485	010140'	260040	010145'		PUSHJ	P,SETTCN
  6486	010141'	256000	000000'		 STOPCD
  6487	010142'	256200	016445'		XCTBU	<HRRM T3,(M)>	;GIVE CALLER THE TC VALUE
  6488	010143'	262040	000005	ACTCP2:	POP	P,U
  6489	010144'	254000	007674*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 151
SCNSER.MAC	25-NOV-87 19:52		SETTCN - READ/SET TERMINAL CHARACTERISTICS BY NUMBER

  6490				SUBTTL	SETTCN - READ/SET TERMINAL CHARACTERISTICS BY NUMBER
  6491				;	   CALLED WITH T1/ CHARACTERISTIC # (TCNxxx)
  6492				;		       T2/ NEW VALUE (-1 TO JUST READ)
  6493				;		       U/ LDB ADDR
  6494				;	   NONSKIP-RETURNS IF TC# OR NEW VALUE IS OUT OF BOUNDS
  6495				;	   SKIP-RETURNS WITH T3/ OLD VALUE OTHERWISE
  6496				;
  6497				;SETTC1 - ASSUMES TC# IS IN BOUNDS
  6498
  6499	010145'	305300	000036	SETTCN:	CAIGE	T1,TCNN		;IF TCNxxx OUT OF BOUNDS
  6500	010146'	313346	010245'	SETTC1:	CAMLE	T2,TCVMAX(T1)	;OR NEW VALUE TOO BIG,
  6501	010147'	263040	000000		 POPJ	P,		;  ERROR-RETURN
  6502	010150'	550406	010207'		HRRZ	T3,TCNDSP(T1)	;TYPE, one of TYMTC, BYTTC, or ACxxxC
  6503	010151'	261040	000006		PUSH	P,T1
  6504	010152'	506341	000000		HRLM	T2,(P)		;(P)/ (NEW VALUE OR -1),,TC#
  6505	010153'	260050	000000		PUSHJ	P,(T3)		;DISPATCH
  6506	010154'	254000	006042*		  JRST	TPOPJ		;  ERROR-RETURN
  6507	010155'	205300	040000		MOVSI	T1,LDLPTY
  6508	010156'	331001	000000		SKIPL	(P)		;IF WE WERE JUST READING
  6509	010157'	616305	000031		TDNN	T1,LDBDCH(U)	;OR IT'S NOT A PTY,
  6510	010160'	254000	006650*		 JRST	TPOPJ1		;  JUST SKIP-RETURN
  6511	010161'	550301	000000		HRRZ	T1,(P)
  6512	010162'	210300	000006		MOVN	T1,T1		;T1/ - TC#
  6513	010163'	205340	400000		MOVSI	T2,(1B0)
  6514	010164'	242346	000000		LSH	T2,(T1)		;T2/ LDBTCB BIT FOR THE TC
  6515	010165'	436345	000004		IORM	T2,LDBTCB(U)	;SET IT
  6516	010166'	202401	000000		MOVEM	T3,(P)
  6517	010167'	261040	000005		PUSH	P,U
  6518	010170'	261040	000004		PUSH	P,F
  6519	010171'	261040	000002		PUSH	P,J
  6520	010172'	260040	007675'		PUSHJ	P,PTYBUD	;U/ BUDDY LDB ADDR
  6521	010173'	201300	000200		MOVEI	T1,LXRTCC
  6522	010174'	436305	000032		IORM	T1,LDBDCX(U)	;NOTE THAT A TC WAS CHANGED
  6523	010175'	550205	000000		HRRZ	F,LDBDDB(U)
  6524	010176'	322200	010202'		JUMPE	F,SETTC2	;IF THE OTHER END IS ATTACHED
  6525	010177'	135300	000234'		LDB	T1,DDPTTC
  6526	010200'	322300	010202'		JUMPE	T1,SETTC2	;AND TRAPPING TC CHANGES
  6527	010201'	260040	006102*		PUSHJ	P,TAKTRJ	;  SIGNAL THE CHANGE
  6528	010202'	262040	000002	SETTC2:	POP	P,J
  6529	010203'	262040	000004		POP	P,F
  6530	010204'	262040	000005		POP	P,U
  6531	010205'	262040	000010		POP	P,T3
  6532	010206'	254000	010144*		JRST	CPOPJ1
  6533
  6534				;If TYPE=BYTTC, then ARG = name of byte pointer (LDPxxx)
  6535				;If TYPE=TYMTC, then ARG = name of host-to-base # (TMCxxx)
  6536
  6537				DEFINE Z(NAME,MAXVAL,TYPE,ARG) = <ARG,,TYPE>
  6538	010207'	000004	010310'	TCNDSP:	TCHARS
  6539	010210'	000005	010310'
  6540	010211'	000006	010310'
  6541	010212'	000007	010310'
  6542	010213'	000010	010310'
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 151-2
SCNSER.MAC	25-NOV-87 19:52		SETTCN - READ/SET TERMINAL CHARACTERISTICS BY NUMBER

  6543	010214'	000011	010310'
  6544	010215'	000012	010310'
  6545	010216'	000013	010310'
  6546	010217'	000014	010310'
  6547	010220'	000015	010310'
  6548	010221'	000016	010310'
  6549	010222'	000017	010310'
  6550	010223'	000211'	010303'
  6551	010224'	000000	010344'
  6552	010225'	000166'	010303'
  6553	010226'	000162'	010303'
  6554	010227'	000000	010353'
  6555	010230'	000000	010363'
  6556	010231'	000000	010370'
  6557	010232'	000215'	010303'
  6558	010233'	000206'	010303'
  6559	010234'	000210'	010303'
  6560	010235'	000205'	010303'
  6561	010236'	000204'	010303'
  6562	010237'	000000	010406'
  6563	010240'	000213'	010303'
  6564	010241'	000000	010426'
  6565	010242'	000216'	010303'
  6566	010243'	000020	010310'
  6567	010244'	000000	010420'
  6568
  6569				DEFINE Z(NAME,MAXVAL,TYPE,ARG) = <MAXVAL>
  6570	010245'	000000	000001	TCVMAX:	TCHARS
  6571	010246'	000000	000017
  6572	010247'	000000	000017
  6573	010250'	000000	000001
  6574	010251'	000000	000001
  6575	010252'	000000	000007
  6576	010253'	000000	000007
  6577	010254'	000000	000017
  6578	010255'	000000	000001
  6579	010256'	000000	000001
  6580	010257'	000000	000001
  6581	010260'	000000	000017
  6582	010261'	000000	000001
  6583	010262'	000000	000377
  6584	010263'	000000	000003
  6585	010264'	000000	000003
  6586	010265'	000000	000001
  6587	010266'	000000	000001
  6588	010267'	000000	000001
  6589	010270'	000000	000001
  6590	010271'	000000	000001
  6591	010272'	000000	000001
  6592	010273'	000000	000001
  6593	010274'	000000	000001
  6594	010275'	000000	000001
  6595	010276'	000000	000001
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 151-3
SCNSER.MAC	25-NOV-87 19:52		SETTCN - READ/SET TERMINAL CHARACTERISTICS BY NUMBER

  6596	010277'	377777	777777
  6597	010300'	000000	000001
  6598	010301'	000000	000001
  6599	010302'	377777	777777
  6600
  6601				;BYTTC - update byte in LDB, for things the TYMSAT does not do for us
  6602
  6603	010303'	554306	010207'	BYTTC:	HLRZ	T1,TCNDSP(T1)	;T1/ BYTE POINTER ADDR
  6604	010304'	135406	000000		LDB	T3,(T1)		;Get old value from LDB
  6605	010305'	331000	000007		SKIPL	T2		;If not -1, then
  6606	010306'	137346	000000		 DPB	T2,(T1)		; set new value in the LDB
  6607	010307'	254000	010206*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 152
SCNSER.MAC	25-NOV-87 19:52		SETTCN ROUTINES

  6608				SUBTTL	SETTCN ROUTINES
  6609
  6610				;TYMTC - READ/SET TYMNET TERMINAL CHARACTERISTICS
  6611				;	 CALLED WITH T1/ CHARACTERISTIC # (TCNxxx)
  6612				;		      T2/ -1 (TO JUST READ) OR NEW VALUE
  6613				;	  SKIP-RETURNS WITH T3/ THE OLD VALUE
  6614				;TYMTC1 - CALLED WITH T1/ TYMNET'S TC# (TMCxxx)
  6615
  6616	010310'	554306	010207'	TYMTC:	HLRZ	T1,TCNDSP(T1)	;USER TC# = TYMNET TC#
  6617	010311'	303300	000023	TYMTC1:	CAILE	T1,MAXTMC	;IF OUT-OF-RANGE,
  6618	010312'	256000	000000'		 STOPCD 		;  CRASH
  6619	010313'	135406	000004'		LDB	T3,TABTMR(T1)	;T3/ old received value
  6620	010314'	321340	010307*		JUMPL	T2,CPOPJ1	;IF JUST LOOKING, SUCCESS-RETURN
  6621	010315'	137346	000030'		DPB	T2,TABTMS(T1)	;Store new value to be sent to the TYMSAT
  6622				;Japanese customers use the command "TTY TYPE 1" and expect it to do both
  6623				;"SET TTY D 15" and "SET TTY KATAKANA".  MAGNUM expects Katakana terminals
  6624				;to have parameter D set to octal 17, ASCII terminals have D set to 0.
  6625				;NOTE: The old BASEs translated TYMNET terminal characteristic #15 (PARM-D)
  6626				;from to host to TYMNET terminal characteristic #16 (KATAKANA) before
  6627				;passing the command to the TYMSAT.  As an interim measure, set both when
  6628				;either is changed.
  6629	010316'	302300	000017		CAIE	T1,TMCPD	;"SET TTY D 1"?
  6630	010317'	306300	000020		CAIN	T1,TMCKAT	; or "SET TTY KATAKANA"?
  6631	010320'	334000	000000		 SKIPA			;Yes, set both
  6632	010321'	254000	010333'		  JRST	TYMTC2		;No
  6633				PRINTF	(<[EBUS02.J01 translates PARM-D(15.) to KATAKANA(16.) for ISIS]>)
  6634	010322'	137340	000050'		DPB	T2,TABTMS+TMCKAT;Set KATAKANA bit if parm D is odd
  6635	010323'	137340	000024'		DPB	T2,TABTMR+TMCKAT;EBUS02.J01 does not return KATAKANA bit to us
  6636	010324'	137340	000047'		DPB	T2,TABTMS+TMCPD	;Set parm D if KATAKANA bit is set
  6637	010325'	606340	000001		TRNN	T2,1		;Simulate TYMNET-I's one-bit field
  6638	010326'	634340	000007		TDZA	T2,T2		; Even = 0
  6639	010327'	201340	000017		 MOVEI	T2,17		; Odd = 17
  6640	010330'	137340	000023'		DPB	T2,TABTMR+TMCPD	;Store this value to be overwritten if the node
  6641								; does understand "parameter D"
  6642	010331'	200340	016450'		MOVE	T2,[1B<TMCPD>!1B<TMCKAT>]
  6643	010332'	436345	000046		IORM	T2,LDBTMT(U)	;Mark them both as being changed
  6644
  6645	010333'	213000	000006	TYMTC2:	MOVNS	T1		;Negative of TYMNET's TC
  6646	010334'	205340	400000		MOVSI	T2,(1B0)
  6647	010335'	242346	000000		LSH	T2,(T1)		;Position to bit (B0 thru B20)
  6648	010336'	436345	000046		IORM	T2,LDBTMT(U)	;SET TRANSMIT BIT
  6649	010337'	201300	000001		MOVEI	T1,1
  6650	010340'	137300	000067'		DPB	T1,LOPSTC	;SET SEND-CHARACTERISTICS
  6651	010341'	350001	000000		AOS	(P)		;skip return
  6652	010342'	137305	000002	SETOPB:	DPB	T1,LDBOPB(U)	;SET NEED-OUTPUT
  6653	010343'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 153
SCNSER.MAC	25-NOV-87 19:52		SETTCN ROUTINES

  6654				SUBTTL	SETTCN ROUTINES
  6655
  6656				;WIDTH
  6657
  6658	010344'	135400	000164'	ACWIDC:	LDB	T3,LDPWID
  6659	010345'	321340	010314*		JUMPL	T2,CPOPJ1
  6660	010346'	301340	000024		CAIL	T2,^D20		;IF IT'S TOO SMALL
  6661	010347'	303340	000307		CAILE	T2,^D199	;OR TOO LARGE,
  6662	010350'	263040	000000		 POPJ	P,		;  ERROR-RETURN
  6663	010351'	137340	000164'		DPB	T2,LDPWID	;ELSE SET IT
  6664	010352'	254000	010345*		JRST	CPOPJ1
  6665
  6666				;BACKSPACE FOR DELETE
  6667
  6668	010353'	135400	000214'	ACBSPC:	LDB	T3,LDPERA
  6669	010354'	626400	000001		TRZN	T3,1		;IF ERASE IS SET, SAY BS ISN'T
  6670	010355'	135400	000160'		 LDB	T3,LDPBSP
  6671	010356'	321340	010352*		JUMPL	T2,CPOPJ1
  6672	010357'	137340	000160'		DPB	T2,LDPBSP
  6673	010360'	400340	000000		SETZ	T2,
  6674	010361'	137340	000214'		DPB	T2,LDPERA	;ALWAYS CLEAR ERASE
  6675	010362'	254000	010356*		JRST	CPOPJ1
  6676
  6677				;ERASE FOR DELETE
  6678
  6679	010363'	135400	000214'	ACERAC:	LDB	T3,LDPERA
  6680	010364'	321340	010362*		JUMPL	T2,CPOPJ1
  6681	010365'	137340	000214'		DPB	T2,LDPERA
  6682	010366'	137340	000160'		DPB	T2,LDPBSP	;EITHER SET BOTH OR CLEAR BOTH
  6683	010367'	254000	010364*		JRST	CPOPJ1
  6684
  6685				;DEFERRED ECHO
  6686
  6687	010370'	135400	000212'	ACDEFC:	LDB	T3,LDPDEM
  6688	010371'	321340	010367*		JUMPL	T2,CPOPJ1
  6689	010372'	200305	000031		MOVE	T1,LDBDCH(U)
  6690	010373'	602340	000001		TRNE	T2,1
  6691	010374'	664300	040000		 TROA	T1,LDRDEM
  6692	010375'	620300	040000		  TRZ	T1,LDRDEM
  6693	010376'	250305	000031		EXCH	T1,LDBDCH(U)
  6694	010377'	312305	000031		CAME	T1,LDBDCH(U)	;IF THE BIT CHANGED
  6695	010400'	603300	000100		TLNE	T1,LDLNEC	;AND NO ECHO NOT SET,
  6696	010401'	254000	010371*		 JRST	CPOPJ1
  6697	010402'	201300	000001		MOVEI	T1,1
  6698	010403'	137300	000065'		DPB	T1,LOPSEC	;  SET SEND-ECHO
  6699	010404'	137305	000002		DPB	T1,LDBOPB(U)	;  AND NEED-OUTPUT
  6700	010405'	254000	010401*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 154
SCNSER.MAC	25-NOV-87 19:52		SETTCN ROUTINES

  6701				SUBTTL	SETTCN ROUTINES
  6702
  6703				;PAPER TAPE MODE
  6704
  6705	010406'	135400	000207'	ACPTPC:	LDB	T3,LDPPTP
  6706	010407'	321340	010405*		JUMPL	T2,CPOPJ1
  6707	010410'	137340	000207'		DPB	T2,LDPPTP	;SET PAPER-TAPE BIT TO USER VALUE
  6708	010411'	261040	000010		PUSH	P,T3
  6709	010412'	640340	000001		TRC	T2,1
  6710	010413'	201300	000003		MOVEI	T1,TMCECR
  6711	010414'	260040	010311'		PUSHJ	P,TYMTC1	;AND CR-AS-CRLF TO ITS COMPLEMENT
  6712	010415'	256000	000000'		 STOPCD
  6713	010416'	262040	000010		POP	P,T3
  6714	010417'	254000	010407*		JRST	CPOPJ1
  6715
  6716				;[JMS] Terminal Type - Must be a valid type
  6717
  6718	010420'	135400	000220'	ACTTYP:	LDB	T3,LDPTYP	;T3 := old value
  6719	010421'	316340	016451'		CAMN	T2,[-1]		;Setting or reading?
  6720	010422'	254000	010417*		 JRST	CPOPJ1		;Just reading
  6721	010423'	137340	000217'		DPB	T2,LDPCLA	;Set TTY CLASS to this value
  6722				;Need to verify that this type is valid (such as VT100, HP2621, TYM444, etc)
  6723	010424'	137340	000033		DPB	T2,LDBTYP	;Valid type, set it
  6724				PRINTF (<[Need to set WIDTH, ERASE, etc at ACTTYP]>)
  6725	010425'	254000	010422*		JRST	CPOPJ1
  6726
  6727				;[dws] Terminal Class - can be any SIXBIT value
  6728
  6729	010426'	135400	000217'	ACTCLA:	LDB	T3,LDPCLA	; T3 := old value
  6730	010427'	312340	016451'		CAME	T2,[-1]		; Don't store if only reading
  6731	010430'	137340	000217'		 DPB	T2,LDPCLA	;  new valued := T2
  6732	010431'	254000	010425*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 155
SCNSER.MAC	25-NOV-87 19:52		NO SPECIAL TAB HANDLING

  6733				SUBTTL	NO SPECIAL TAB HANDLING
  6734
  6735	010432'	135340	000157'	ACNTB:	LDB	T2, LDPNTB
  6736	010433'	256200	016452'		XCTBU	<EXCH T2,(M)>
  6737	010434'	321340	007756*		JUMPL	T2, CPOPJ
  6738	010435'	137340	000237'		DPB	T2, DDPNTB
  6739	010436'	137340	000157'		DPB	T2, LDPNTB
  6740	010437'	263040	000000		POPJ	P,
  6741
  6742				;TABS AS BREAKS
  6743
  6744	010440'	135340	000155'	ACTBK:	LDB	T2, LDPTBK
  6745	010441'	256200	016452'		XCTBU	<EXCH T2,(M)>
  6746	010442'	321340	010434*		JUMPL	T2, CPOPJ
  6747	010443'	137340	000236'		DPB	T2, DDPTBK
  6748	010444'	201300	100000		MOVEI	T1, L2LTBK
  6749	010445'	602340	000001		TRNE	T2, 1		;CHECK LOW ORDER BIT
  6750	010446'	505300	100000		HRLI	T1, L2LTBK
  6751	010447'	324740	007540'		PJRST	SETTBK		;GO SET IT
  6752
  6753				;BACKSPACE AS PUNCTUATION
  6754
  6755	010450'	135340	000156'	ACBBP:	LDB	T2, LDPBBP
  6756	010451'	256200	016452'		XCTBU	<EXCH T2,(M)>
  6757	010452'	321340	010442*		JUMPL	T2, CPOPJ
  6758	010453'	137340	000235'		DPB	T2, DDPBBP
  6759	010454'	201300	040000		MOVEI	T1, L2LBBP
  6760	010455'	602340	000001		TRNE	T2, 1		;CHECK LOW ORDER BIT
  6761	010456'	505300	040000		HRLI	T1, L2LBBP
  6762	010457'	324740	007540'		PJRST	SETTBK		;GO SET IT
  6763
  6764				;SUPPRESS-OUTPUT-TRANSLATION (FOR PTYS ONLY)
  6765
  6766	010460'	500245	000031	ACSOX:	HLL	U, LDBDCH(U)
  6767	010461'	607240	040000		TLNN	U, LDLPTY	;IF IT'S NOT A PTY,
  6768	010462'	263040	000000		POPJ	P,		;  JUST RETURN
  6769	010463'	261040	000005		PUSH	P, U
  6770	010464'	260040	007675'		PUSHJ	P, PTYBUD	;U/ "BUDDY" LDB ADDR
  6771	010465'	135300	000201'		LDB	T1, LDPSOX	;T1/ CURRENT SOX VALUE
  6772	010466'	256200	016453'		XCTBU	<EXCH T1,(M)>	;SWAP WITH ARGUMENT
  6773	010467'	321300	010471'		JUMPL	T1, .+2		;IF USER SUPPLIED A NEW VALUE,
  6774	010470'	137300	000201'		DPB	T1, LDPSOX	;  SET IT
  6775	010471'	262040	000005		POP	P, U
  6776	010472'	263040	000000		POPJ	P,
  6777
  6778				;READ/SET DVNZP BIT
  6779
  6780	010473'	135300	000243'	ACNZP:	LDB	T1, DDPNZP	;T1/ CURRENT VALUE
  6781	010474'	256200	016453'		XCTBU	<EXCH T1, (M)>	;SWAP WITH USER'S
  6782	010475'	321300	010452*		JUMPL	T1, CPOPJ	;(JUST READING)
  6783	010476'	137300	000243'		DPB	T1, DDPNZP	;SET IT
  6784	010477'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 156
SCNSER.MAC	25-NOV-87 19:52		OLD AUXCAL TERMINAL-CHARACTERISTICS DISPATCH

  6785				SUBTTL	OLD AUXCAL TERMINAL-CHARACTERISTICS DISPATCH
  6786
  6787	010500'	554300	000010	ACTMC:	HLRZ	T1,T3		;T1/ CHARACTERISTIC #  (TCNxxx)
  6788	010501'	256200	016454'		XCTFU	<MOVE T2,(M)>	;T2/ USER'S ARGUMENT
  6789	010502'	260040	010146'		PUSHJ	P,SETTC1	;T3 := OLD VALUE
  6790	010503'	255000	000000		  JFCL			;(NEW VALUE WAS BAD)
  6791	010504'	256200	016421'		XCTTU	<MOVEM T3,(M)>	;STORE IT
  6792	010505'	263040	000000		POPJ	P,
  6793
  6794				;SET FILE STATUS BITS, THEN FIX IMAGE STATE
  6795
  6796	010506'	260040	010037*	ACSFS:	PUSHJ	P,SETIO2
  6797	010507'	540244	000013		HRR	U,DDBLDB(F)
  6798	010510'	200004	000002		MOVE	S,DEVIOS(F)
  6799	010511'	324740	007507'		PJRST	FIXIMI
  6800
  6801				;SEND YELLOW BALL
  6802
  6803	010512'	201300	000001	ACSYL:	MOVEI T1,1
  6804	010513'	137300	000075'		DPB T1,LOPSYL		;SET SEND-YELLOW
  6805	010514'	324740	010342'		PJRST SETOPB
  6806
  6807				;SEND ORANGE BALL
  6808
  6809	010515'	200305	000032	ACSOB:	MOVE	T1, LDBDCX(U)
  6810	010516'	627300	004000		TLZN	T1, LXLOOK	;IF IT'S OK TO SEND 1,
  6811	010517'	263040	000000		  POPJ	P,
  6812	010520'	202305	000032		MOVEM	T1, LDBDCX(U)	;  (NOT 2, JUST 1)
  6813	010521'	205300	010000		MOVSI	T1, L2LLDF
  6814	010522'	436305	000027		IORM	T1, LDBBYT(U)	;  FAKE INPUT WAIT SO BALL'LL GO
  6815	010523'	201300	000001		MOVEI	T1, 1
  6816	010524'	137300	000102'		DPB	T1, LOPSOG	;  SET SEND-ORANGE
  6817	010525'	324740	010342'		PJRST	SETOPB
  6818
  6819				;SEND HANGUP (SOFT ZAPPER)
  6820
  6821	010526'	201300	000001	ACHNG:	MOVEI	T1, 1
  6822	010527'	137300	000076'		DPB	T1, LOPHNG	;SET SEND-HANG
  6823	010530'	324740	010342'		PJRST	SETOPB
  6824
  6825				;Read last PORT STATUS message (AUXCAL function .AXPSM=61)
  6826				;From the YAMM dated July 1980: "The port status returned is 4 bits for
  6827				;which there is no documentation.  This operation was implemented for the
  6828				;initial TYMNET-I Dial-Out facility."  The current code in the base,
  6829				;EBUS02.J01, does not have any code for passing this message to the PDP-10.
  6830
  6831	010531'	135300	000172'	ACPSM:	LDB	T1, LDPPSM	; GET LAST PORT STATUS MSG
  6832	010532'	256200	016415'		UMOVEM	T1, (M)		; GIVE IT TO HIM
  6833	010533'	205300	200000		MOVSI	T1, LMLPSP
  6834	010534'	412305	000030		ANDCAM	T1, LDBMOD(U)	; AND NOTE IT'S BEEN READ
  6835	010535'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 157
SCNSER.MAC	25-NOV-87 19:52		SET IMAGE BREAK CHARACTER

  6836				SUBTTL	SET IMAGE BREAK CHARACTER
  6837
  6838	010536'	256200	016414'	ACBRKC:	UMOVE	T1, (M)
  6839	010537'	606300	000400		TRNN	T1, 400		;IF IMAGE BIT NOT ON,
  6840	010540'	400300	000000		SETZ	T1,		;  CLEAR THE CHARACTER
  6841	010541'	137300	000177'		DPB	T1, LDPIMB
  6842	010542'	137300	000240'		DPB	T1, DDPIMB
  6843	010543'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 158
SCNSER.MAC	25-NOV-87 19:52		IMAGE-STATE INPUT AUXCALS

  6844				SUBTTL	IMAGE-STATE INPUT AUXCALS
  6845
  6846	010544'	702600	400000*	ACINWC:	NOCHARGE
  6847	010545'	260040	013114'	ACIN1:	PUSHJ P,TWAITC	;THIS WILL SET MODE TO IMAGE
  6848	010546'	260040	012365'		PUSHJ P,TYI
  6849	010547'	254000	010545'		 JRST ACIN1	;TRY AGAIN
  6850	010550'	405400	000377	ACIN2:	ANDI T3,377
  6851	010551'	256200	016421'		UMOVEM T3,(M)
  6852	010552'	350001	000000		AOS (P)		;SKIP RETURN (AS OPPOSED TO NO PORT)
  6853	010553'	254000	007103'		JRST NOCTRO
  6854
  6855	010554'	702600	400000*	ACINSC:	NOCHARGE
  6856	010555'	337005	000014		SKIPG LDBECC(U)	;ANY CHRS?
  6857	010556'	333005	000012		SKIPLE LDBTIC(U)
  6858	010557'	334000	000000		SKIPA		;YES
  6859	010560'	254000	007534'		JRST SETLMD	;NO, SET TO IMAGE ANYWAY
  6860	010561'	260040	013112'		PUSHJ P,TWAITS
  6861	010562'	263040	000000		  POPJ	P,	;DETACHED
  6862	010563'	260040	012365'		PUSHJ P,TYI
  6863	010564'	254000	007103'		 JRST NOCTRO	;NONE THERE
  6864	010565'	254000	010550'		JRST ACIN2	;GIVE IT TO HIM
  6865
  6866	010566'	702600	400000*	ACINWB:	NOCHARGE
  6867	010567'	260040	013051'		PUSHJ P,TWAITL	;WAIT FOR IMAGE-MODE BREAK CHARACTER OR TIMEOUT
  6868	010570'	260040	012365'		PUSHJ P,TYI
  6869	010571'	263040	000000		 POPJ P,	;PROBABLY END OF FILE SET
  6870	010572'	254000	010550'		JRST ACIN2	;GIVE HIM CHR
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 159
SCNSER.MAC	25-NOV-87 19:52		AUXCAL -- .AXSI=33 - Simulate input

  6871				SUBTTL	AUXCAL -- .AXSI=33 - Simulate input
  6872
  6873	010573'	256200	016367'	FRCINP:	UMOVE	M,(M)		;GET BYTE POINTER
  6874	010574'	621540	000037		TLZ	M,37		;GET RID OF INDEX AND INDIRECT
  6875	010575'	200300	000013		MOVE	T1,M		;Check the string before forcing input
  6876	010576'	201340	000000		MOVEI	T2,0
  6877	010577'	256040	016455'	FRCLP0:	XCTFU <ILDB T3,T1>	;Get char
  6878	010600'	405400	000377		ANDI	T3,377		;Watch out for strange byte sizes
  6879	010601'	332000	000010		SKIPE	T3
  6880	010602'	344340	010577'		 AOJA	T2,FRCLP0	;Loop until null
  6881	010603'	270345	000012		ADD	T2,LDBTIC(U)	;Add to count of chars already input
  6882	010604'	270345	000014		ADD	T2,LDBECC(U)	; and chars not yet echoed
  6883	010605'	311340	016015'		CAML	T2,TIHLTN	;If it would exceed the limit
  6884	010606'	263040	000000		 POPJ	P,		; then do nothing and give error return
  6885
  6886	010607'	256040	016403'	FRCLP1:	XCTFU <ILDB T3,M>
  6887	010610'	405400	000377		ANDI	T3,377		; USE ONLY THE RIGHT 8 BITS
  6888	010611'	322400	010431*		JUMPE	T3,CPOPJ1	;FINISHED
  6889	010612'	260040	001576'		PUSHJ	P,MOVCHR	;PUT CHR IN INPUT BUFFER
  6890	010613'	254000	010607'		  JRST	FRCLP1		;NO ECHO REQUIRED
  6891	010614'	201300	000001		MOVEI	T1,1		;LAST CHAR SWITCHED TO DEFERED ECHO
  6892	010615'	137300	000100'		DPB	T1,LOPECO	;SET NEED-ECHO
  6893	010616'	137305	000002		DPB	T1,LDBOPB(U)	;AND NEED-OUTPUT
  6894	010617'	256040	016403'	FRCLP2:	XCTFU <ILDB T3,M>	;LOOP HERE FOR DEFERED ECHO MODE
  6895	010620'	405400	000377		ANDI	T3,377		; USE ONLY THE RIGHT 8 BITS
  6896	010621'	322400	010611*		JUMPE	T3,CPOPJ1	;FINISHED
  6897	010622'	260040	001576'		PUSHJ	P,MOVCHR	;PUT CHAR IN OTHER INPUT BUFFER
  6898	010623'	255000	000000		  JFCL			;SHOULD ALWAYS SKIP NOW
  6899	010624'	254000	010617'		JRST	FRCLP2		;LOOP IN EITHER CASE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 160
SCNSER.MAC	25-NOV-87 19:52		FORCE A RESCAN LINE

  6900				SUBTTL	FORCE A RESCAN LINE
  6901
  6902			000000	%FROK==0	;NO ERROR
  6903			000001	%FRAUX==1	;PORT IS AN AUX CIRCUIT
  6904			000002	%FRBIG==2	;COMMAND STRING IS TOO BIG
  6905			000003	%FRCMD==3	;PORT IS IN COMMAND STATE
  6906			000004	%FRBRK==4	;BREAK BEFORE END OF COMMAND STRING (BYTE PTR UPDATED)
  6907			000005	%FRNBK==5	;NO BREAK ENCOUNTERED IN STRING
  6908			000006	%FRFUL==6	;RESCAN COMMAND ALREADY PRESENT
  6909
  6910	010625'	500245	000031	FRCRSC:	HLL	U, LDBDCH(U)
  6911	010626'	603240	000040		TLNE	U, LDLAUX	;IF PORT IS AN AUX CIRCUIT,
  6912					 JRST	[
  6913						MOVEI	P1, %FRAUX
  6914						JRST	FRCRSX	;  ERROR-RETURN
  6915	010627'	254000	016456'		]
  6916	010630'	603240	020000		TLNE	U, LDLCOM	;IF PORT IS IN COMMAND STATE,
  6917					 JRST	[
  6918						MOVEI	P1, %FRCMD
  6919						JRST	FRCRSX	;  ERROR-RETURN
  6920	010631'	254000	016460'		]
  6921	010632'	256200	016462'		XCTFU	<MOVE P1, 0(M)>	;P1/ COUNT
  6922	010633'	301600	000110		CAIL	P1, TIWKC	;IF IT'S TOO BIG,
  6923					 JRST	[
  6924						MOVEI	P1, %FRBIG
  6925						JRST	FRCRSX	;  ERROR-RETURN
  6926	010634'	254000	016463'		]
  6927	010635'	200300	000014	FRCRS1:	MOVE	T1, P1
  6928	010636'	271300	000013		ADDI	T1, <<<TTCHKS-1>*4>-1>
  6929	010637'	231300	000014		IDIVI	T1, <<TTCHKS-1>*4>	;T1/ # CHUNKS NEEDED
  6930	010640'	200340	015712'		MOVE	T2, TTFREN
  6931	010641'	275340	000003		SUBI	T2, TIRSVD	;T2/ # CHUNKS AVAILABLE
  6932	010642'	317300	000007		CAMG	T1, T2		;IF THERE AREN'T ENOUGH,
  6933	010643'	254000	010655'		 JRST	FRCRS2
  6934	010644'	205000	200000		MOVSI	S, TWTSPC
  6935	010645'	437004	000002		IORB	S, DEVIOS(F)	;  NOTE THAT WE NEED MORE ROOM
  6936	010646'	135300	000224'		LDB	T1, DDPTTI	;  T1/ IOW-INTERRUPT ASSIGNMENT
  6937	010647'	260040	000000*		PUSHJ	P, TSTKTJ	;  IF HE TRAPPED IT,
  6938					JRST	[
  6939						PUSHJ	P, SETFIO	;SET TO GIVE I/O DONE TRAP
  6940						PJRST	ABTUUO		;AND GET OUT
  6941	010650'	254000	016465'		]
  6942	010651'	261040	000014		PUSH	P, P1
  6943	010652'	260040	013166'		PUSHJ	P, TOWAT1	;  GO INTO OUTPUT WAIT
  6944	010653'	262040	000014		POP	P, P1
  6945	010654'	254000	010635'		JRST	FRCRS1		;  THEN TRY AGAIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 161
SCNSER.MAC	25-NOV-87 19:52		FORCE A RESCAN LINE

  6946	010655'	260040	006203'	FRCRS2:	PUSHJ	P, TSETBI	;CLEAR THE INPUT BUFFER (!)
  6947	010656'	500245	000031		HLL	U, LDBDCH(U)
  6948	010657'	332000	016100'		SKIPE	FRSFLG
  6949	010660'	256000	000000'		 STOPCD
  6950	010661'	476000	016100'		SETOM	FRSFLG		;SET FLAG FOR CMDPGAK
  6951	010662'	661240	020000		TLO	U, LDLCOM	;SET COMMAND STATE
  6952	010663'	402000	016101'		SETZM	FRSDEF
  6953	010664'	623240	001000		TLZE	U, LDLDEF	;CLEAR DEFERRED-ECHO
  6954	010665'	476000	016101'		SETOM	FRSDEF		;(REMEMBER PGHAT IT PGAS)
  6955	010666'	502245	000031		HLLM	U, LDBDCH(U)
  6956	010667'	260040	007534'		PUSHJ	P, SETLMD	;FIX LINE-MODE FIELD
  6957
  6958				    ;HERE TO ACTUALLY FORCE THE INPUT
  6959				    ;P1/ COUNT
  6960
  6961	010670'	256200	016467'		XCTFU	<MOVE PG, 1(M)>	;PG/ BYTE POINTER
  6962	010671'	621140	000037		TLZ	PG, 37		;CLEAR INDEX AND INDIRECT BITS
  6963	010672'	261040	000014		PUSH	P, P1		;0(P)/ COUNT
  6964
  6965	010673'	375001	000000	FRCRS3:	SOSGE	0(P)		;DONE?
  6966	010674'	254000	010710'		JRST	FRCRS4		;(YES)
  6967	010675'	256040	016470'		XCTFU	<ILDB T3, PG>	;T3/ NEXT CHARACTER
  6968	010676'	405400	000377		ANDI	T3, 377		;(ONLY 8 BITS)
  6969	010677'	260040	001576'		PUSHJ	P, MOVCHR	;DEPOSIT IT
  6970	010700'	254000	010701'		JRST	.+1		;(REMOTE-ECHO RETURN)
  6971	010701'	332000	016100'		SKIPE	FRSFLG		;IF CMDPGAK NOT CALLED YET,
  6972	010702'	254000	010673'		JRST	FRCRS3		;  TRY THE NEXT CHARACTER
  6973
  6974				    ;HERE WHEN A "COMMAND LINE" HAS BEEN FORCED
  6975
  6976	010703'	262040	000006		POP	P, T1		;T1/ COUNT LEFT
  6977	010704'	322300	010714'		JUMPE	T1, FRCRS5	;IF THERE'RE CHARS AFTER THE BREAK,
  6978	010705'	256200	016471'		XCTTU	<MOVEM PG, 1(M)>;  STORE BACK THE MODIFIED BYTE POINTER
  6979	010706'	201600	000004		MOVEI	P1, %FRBRK	;  ERROR-RETURN
  6980	010707'	254000	010715'		JRST	FRCRS6
  6981
  6982				    ;HERE WHEN WE RAN OUT OF CHARACTERS BEFORE A "COMMAND LINE"
  6983				    ;WAS FINISHED
  6984
  6985	010710'	262040	000006	FRCRS4:	POP	P, T1
  6986	010711'	402000	016100'		SETZM	FRSFLG		;CLEAR FLAG
  6987	010712'	201600	000005		MOVEI	P1, %FRNBK	;ERROR-RETURN
  6988	010713'	254000	010715'		JRST	FRCRS6
  6989
  6990				    ;HERE WHEN THINGS WERE JUST RIGHT
  6991
  6992	010714'	201600	000000	FRCRS5:	MOVEI	P1, %FROK
  6993					PFALL	FRCRS6
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 162
SCNSER.MAC	25-NOV-87 19:52		FORCE A RESCAN LINE

  6994				    ;CLEAN THINGS UP
  6995
  6996	010715'	336000	016101'	FRCRS6:	SKIPN	FRSDEF		;IF PORT WAS IN DEFERRED ECHO MODE,
  6997	010716'	254000	010721'		JRST	FRCRS7
  6998	010717'	205300	001000		MOVSI	T1, LDLDEF
  6999	010720'	436305	000031		IORM	T1, LDBDCH(U)	;  SET DEFERRED-ECHO AGAIN
  7000	010721'	205300	020000	FRCRS7:	MOVSI	T1, LDLCOM
  7001	010722'	412305	000031		ANDCAM	T1, LDBDCH(U)	;CLEAR COMMAND MODE
  7002	010723'	205300	100000		MOVSI	T1, LDLECS
  7003	010724'	436305	000031		IORM	T1, LDBDCH(U)	;SET EAT-COMMAND-SYNC
  7004	010725'	260040	007534'		PUSHJ	P, SETLMD	;FIX LINE-MODE FIELD
  7005
  7006	010726'	336000	000014	FRCRSX:	SKIPN	P1		;IF NO ERROR OCCURRED,
  7007	010727'	354001	000000		AOSA	(P)		;  PREPARE FOR SKIP-RETURN, ELSE
  7008	010730'	256200	016472'		XCTTU	<MOVEM P1, (W)>	;  USER AC := RETURN CODE
  7009	010731'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 163
SCNSER.MAC	25-NOV-87 19:52		AUXILIARY CIRCUITS

  7010				SUBTTL AUXILIARY CIRCUITS
  7011
  7012				;ONLY ONE AUXILIARY CIRCUIT IS IN THE PROCESS OF BEING BUILT
  7013				;AT ANY ONE TIME. JOBS WANTING TO BUILD AN AUX.
  7014				;CIRCUIT ARE QUEUED ON THE AX QUE. ONCE A CIRCUIT IS READY TO
  7015				;BE BUILT, THE COMMUNICATION WITH THE SUPERVISOR IS
  7016				;CONTROLED BY A STATE CELL (AUXSTA). THE FOLLOWING ARE THE STATES
  7017
  7018			000000	.ASIDL==0	;NOT BUILDING A CIRCUIT
  7019			000001	.ASRQ1==1	;READY TO SEND SUPERVISOR REQUEST
  7020			000002	.ASWR1==2	;WAITING FOR SUPERVISOR RESOPNSE
  7021			000003	.ASRQ2==3	;READY TO RE-SEND SUPERVISOR REQUEST
  7022						;(BECAUSE OF ERROR ON FIRST TRY - PROBABLY
  7023						;COMMUNICATION IS OUT OF SYNC)
  7024			000004	.ASWR2==4	;WAITING FOR SUPERVISOR RESPONSE TO RE-SEND
  7025			000005	.ASLOG==5	;SENDING LOGIN STRING TO SUPERVISOR
  7026			000006	.ASWPT==6	;WAITING FOR A PORT AND A SUPERVISOR RESPONSE
  7027			000007	.ASWTP==7	;RECEIVED AN AUX CIRCUIT (MSG TYPE 7) FOR A PORT PENDING A
  7028						; ZAPPER, SO NOW WAITING FOR SUPERVISOR RESPONSE SO WE CAN
  7029						; RE-SEND A SUPERVISOR REQUEST WITHOUT GETTING OUT OF SYNC
  7030						;( ** NOT SUPPOSED TO HAPPEN ** SEE TTYZNE & ZAPBUG ** )
  7031
  7032				;ERROR NUMBERS FROM THE PDP-10
  7033
  7034			000001	CX2AX%==1	;TOO MANY AUX CIRCUITS FOR THIS JOB AND NO AC LICENSE
  7035			000002	CXLOG%==2	;USER NAMES DO NOT MATCH AND NO AC LICENSE
  7036			000003	CXDCB%==3	;NO DDB'S AVAILABLE
  7037			000004	CXNRR%==4	;NO RESPONSE TO FIRST REQUEST
  7038			000005	CXNRL%==5	;NO RESPONSE AFTER STRING SENT
  7039			000006	CXNCH%==6	;NO PORT RECEIVED
  7040			000007	CXERR%==7	;ERROR FROM FIRST RESPONSE
  7041
  7042				;SPECIAL ROUTINE WHEN COMMING OUT OF IO WAIT FINDS
  7043				;AN AUX CIRCUIT ZAPPED
  7044
  7045	010732'	201300	600000	AUXRID:	MOVEI	T1,ASSCON!ASSPRG
  7046	010733'	616304	000004		TDNN	T1,DEVMOD(F)		;STILL ASSIGNED?
  7047	010734'	260040	014504'		 PUSHJ	P,TTYKDB		;NO, REMOVE DDB
  7048	010735'	254000	007162*		JRST	ABTUUO			;IN ANY CASE, ABORT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 164
SCNSER.MAC	25-NOV-87 19:52		TURN THE COMMAND PORT INTO SOMETHING LIKE AN "AUX" PORT

  7049				SUBTTL	TURN THE COMMAND PORT INTO SOMETHING LIKE AN "AUX" PORT
  7050
  7051	010736'	205300	020000	MAKDET:	MOVSI	T1,TTYATC	;MUST BE COMMAND PORT
  7052	010737'	616304	000004		TDNN	T1,DEVMOD(F)
  7053	010740'	263040	000000		 POPJ	P,
  7054	010741'	322240	010475*		JUMPE	U,CPOPJ		;DO NOT ALLOW IF NOT COMMAND OR DET
  7055	010742'	205300	200000		MOVSI	T1,LLLZAP
  7056	010743'	612305	000026		TDNE	T1,LDBLOG(U)
  7057	010744'	263040	000000		 POPJ	P,		;OR IF WAITING TO LOG OUT
  7058	010745'	205300	000400		MOVSI	T1,LICAC
  7059	010746'	612302	006724*		TDNE	T1,JBTLIC(J)
  7060	010747'	254000	010757'		 JRST	MAKDLC		;MUST HAVE LIC OR ONLY ONE OTHER PORT
  7061	010750'	260040	015337'		PUSHJ	P,FRSTTY
  7062	010751'	254000	010757'		  JRST	MAKDLC
  7063	010752'	260040	015341'		PUSHJ	P,NXTTTY
  7064	010753'	254000	010757'		  JRST	MAKDLC
  7065	010754'	260040	015341'		PUSHJ	P,NXTTTY
  7066	010755'	254000	010757'		  JRST	MAKDLC
  7067	010756'	263040	000000		POPJ	P,		;ERROR, ALREADY HAVE TWO PORTS
  7068	010757'	550202	007734*	MAKDLC:	HRRZ	F,TTYTAB(J)
  7069	010760'	554304	000013		HLRZ	T1,DDBBLK(F)
  7070	010761'	260040	015147'		PUSHJ	P,DDBSR1	;GET ONE AND LINK IT IN
  7071	010762'	263040	000000		  POPJ	P,		;CAN NOT
  7072	010763'	550342	010757*		HRRZ	T2,TTYTAB(J)
  7073	010764'	542202	010763*		HRRM	F,TTYTAB(J)	;MAKE A NEW COMMAND PORT
  7074	010765'	205300	010000		MOVSI	T1,DVNZP
  7075	010766'	436307	000004		IORM	T1,DEVMOD(T2)	;DO NOT ALLOW TTY TO BE ZAPPED
  7076	010767'	205300	020000		MOVSI	T1,TTYATC
  7077	010770'	412307	000004		ANDCAM	T1,DEVMOD(T2)	;NO LONGER THE COMMAND PORT
  7078	010771'	541300	400000		HRRI	T1,ASSCON
  7079	010772'	436304	000004		IORM	T1,DEVMOD(F)	;MARK AS ASSIGNED BY CONSOLE (FOR RESET)
  7080	010773'	137100	007741*		DPB	J,PJOBN
  7081	010774'	260040	015213'		PUSHJ	P,SCNNAM	;THAT SHOULD BE ENOUGH
  7082	010775'	553004	000000		  HRRZS	DEVNAM(F)	;SO LOOKS DETACHED
  7083	010776'	550200	000007		HRRZ	F,T2
  7084	010777'	200004	000002		MOVE	S,DEVIOS(F)
  7085	011000'	550244	000013		HRRZ	U,DDBLDB(F)
  7086	011001'	205340	020000		MOVSI	T2,LDLCOM
  7087	011002'	412345	000031		ANDCAM	T2,LDBDCH(U)
  7088	011003'	350001	000000		AOS	(P)
  7089	011004'	135300	000153'		LDB	T1,LDPLNO
  7090	011005'	256200	016415'		UMOVEM	T1,(M)
  7091	011006'	324740	013004'		PJRST	UUOLDB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 165
SCNSER.MAC	25-NOV-87 19:52		HERE FROM HANG UUO WHEN HANGING AN AUX CIRCUIT

  7092				SUBTTL	HERE FROM HANG UUO WHEN HANGING AN AUX CIRCUIT
  7093
  7094	011007'	550205	000000	HNGAUX:	HRRZ	F,LDBDDB(U)
  7095	011010'	322200	011015'		JUMPE	F,HNGAXD	;IF IT'S ATTACHED,
  7096	011011'	135300	000230'	HNGAX1:	LDB	T1,DDPTZP
  7097	011012'	260040	010201*		PUSHJ	P,TAKTRJ	;  INTERRUPT ITS OWNER
  7098	011013'	201340	400000		MOVEI	T2,ASSCON
  7099	011014'	324740	006677*		PJRST	RELEA6		;  AND CLEAR ASSIGNED-BY-CONSOLE
  7100
  7101				    ;HERE WHEN PORT IS ALREADY DETACHED
  7102
  7103	011015'	260040	014622'	HNGAXD:	PUSHJ	P,TTYZAP	;SET TO SEND A ZAPPER BACK
  7104	011016'	553000	000005		HRRZS	U		;CLEAR LDBDCH BITS
  7105	011017'	312240	015745'		CAME	U,AUXRCP	;IF IT'S THE RECEIVED AUX PORT,
  7106	011020'	254000	011023'		 JRST	HNGAX4
  7107	011021'	476000	015745'		SETOM	AUXRCP		;  SAY WE HAVEN'T RECEIVED ONE
  7108	011022'	350000	015767'		AOS	ZRPCNT		;  AND NOTE THAT WE DID SO
  7109	011023'	263040	000000	HNGAX4:	POPJ	P,
  7110
  7111				;HERE WHEN A ZAPPER IS RECEIVED ON AN AUX PORT
  7112
  7113	011024'	550205	000000	ZAPAUX:	HRRZ	F,LDBDDB(U)	;F/ DDB ADDR
  7114	011025'	322200	011015'		JUMPE	F,HNGAXD	;IF DETACHED, JUST CHECK "RECEIVED" PORT
  7115	011026'	260040	014622'		PUSHJ	P,TTYZAP	;SET TO SEND ZAPPER
  7116	011027'	513004	000013		HLLZS	DDBLDB(F)	;DETACH IT
  7117	011030'	513005	000000		HLLZS	LDBDDB(U)
  7118	011031'	254000	011011'		JRST	HNGAX1		;INTERRUPT JOB, CLEAR ASSCON
  7119
  7120				;HERE FROM RELEA6 WHEN BOTH ASSCON AND ASSPRG GO OFF
  7121
  7122	011032'	550244	000013	AUXZAP:	HRRZ	U,DDBLDB(F)
  7123	011033'	322240	011043'		JUMPE	U,AXZP1		;IF DDB HAS A PORT ATTACHED,
  7124	011034'	260040	014622'		PUSHJ	P,TTYZAP	;  SET TO SEND ZAPPER
  7125	011035'	513004	000013		HLLZS	DDBLDB(F)
  7126	011036'	513005	000000		HLLZS	LDBDDB(U)	;  DETACH IT
  7127	011037'	402005	000034		SETZM	LDBSTR(U)	;  CLEAR PREVIOUS CIRCUIT NAME
  7128	011040'	551305	000035		HRRZI	T1,LDBSTR+1(U)	;  GET ADDRESS
  7129	011041'	505306	777777		HRLI	T1,-1(T1)	;    STR,,STR+1
  7130	011042'	251305	000043		BLT	T1,LDBSTR+AUXSTL-1(U)
  7131	011043'	553004	000000	AXZP1:	HRRZS	DEVNAM(F)	;MARK NAME AS DETACHED
  7132	011044'	205300	020000		MOVSI	T1,TIOUSE
  7133	011045'	616304	000002		TDNN	T1,DEVIOS(F)	;IF NO UUO IS IN PROGRESS,
  7134	011046'	324740	014504'		 PJRST	TTYKDB		;  KILL THE DDB
  7135	011047'	200004	000002		MOVE	S,DEVIOS(F)	;OTHERWISE,
  7136	011050'	324740	006005'		PJRST	TIWAKE		;  JUST WAKE THE JOB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 166
SCNSER.MAC	25-NOV-87 19:52		ON RECEIPT OF A TAKEOVER MESSAGE, RESET AND TRY AGAIN

  7137				SUBTTL	ON RECEIPT OF A TAKEOVER MESSAGE, RESET AND TRY AGAIN
  7138
  7139	011051'	200300	001471*	RCVNSP:	MOVE	T1,DATE##	;Remember the date/time of when
  7140	011052'	202300	001472*		MOVEM	T1,SUPTIM##	; the new Supervisor took over
  7141	011053'	336000	015746'		SKIPN	AUXSTA
  7142	011054'	344740	000746'		 AOJA	P4,SCNIN1	;IN IDLE STATE, JUST IGNORE
  7143	011055'	331240	015745'		SKIPL	U,AUXRCP	;PORT RECEIVED?
  7144	011056'	260040	014622'		 PUSHJ	P,TTYZAP	;YES, ZAP IT
  7145	011057'	201300	000001		MOVEI	T1,.ASRQ1
  7146	011060'	202300	015746'		MOVEM	T1,AUXSTA
  7147	011061'	344740	000746'		AOJA	P4,SCNIN1	;READY TO SEND FIRST REQUEST
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 167
SCNSER.MAC	25-NOV-87 19:52		SUPERVISOR RESPONSE RECIVED

  7148				SUBTTL	SUPERVISOR RESPONSE RECIVED
  7149
  7150	011062'	200300	015746'	RCVSUR:	MOVE	T1,AUXSTA
  7151	011063'	256006	011064'		XCT	ARSTAB(T1)
  7152
  7153	011064'	344740	000746'	ARSTAB:	AOJA	P4,SCNIN1	;.ASIDL IGNORE
  7154	011065'	344740	000746'		AOJA	P4,SCNIN1	;.ASRQ1 IGNORE
  7155	011066'	254000	011074'		JRST	RCVS2		;.ASWR1 RESPONSE TO 1ST REQUEST
  7156	011067'	344740	000746'		AOJA	P4,SCNIN1	;.ASRQ2 IGNORE
  7157	011070'	254000	011103'		JRST	RCVS4		;.ASWR2 RESPONSE TO 2ND REQUEST
  7158	011071'	344740	000746'		AOJA	P4,SCNIN1	;.ASLOG IGNORE
  7159	011072'	254000	011110'		JRST	RCVS6		;.ASWPT RESPONSE TO LOGIN
  7160	011073'	254000	011114'		JRST	RCVSP		;.ASWTP RESPONSE TO LOGIN (BAD RCVAUX)
  7161
  7162				    ;SUPERVISOR RESPONSE TO FIRST REQUEST
  7163
  7164	011074'	135300	000264'	RCVS2:	LDB	T1,INPCHR	;GET ERROR CODE
  7165					JUMPN	T1,[AOS AUXSTA	;ON ERROR, STATE:=.AXRQ2 (RETRY)
  7166	011075'	326300	016473'			AOJA P4,SCNIN1]
  7167	011076'	200300	016475'	RCVS2A:	MOVE	T1,[POINT 7,AUXSTR]
  7168	011077'	202300	015760'		MOVEM	T1,AUXSTP
  7169	011100'	201300	000005		MOVEI	T1,.ASLOG
  7170	011101'	202300	015746'		MOVEM	T1,AUXSTA	;SUCCESSFUL RESPONSE: SEND LOGIN STRING
  7171	011102'	344740	000746'		AOJA	P4,SCNIN1
  7172
  7173				  ;SUPERVISOR RESPONSE TO RE-REQUEST
  7174
  7175	011103'	135300	000264'	RCVS4:	LDB	T1,INPCHR	;LIKE 1ST REQUEST BUT ERROR IS FATAL
  7176	011104'	322300	011076'		JUMPE	T1,RCVS2A	;NO ERROR
  7177	011105'	505300	000007		HRLI	T1,CXERR%	;SET ERROR TYPE
  7178	011106'	260040	011121'		PUSHJ	P,ERRXIT	;AND CLEAN UP
  7179	011107'	344740	000746'		AOJA	P4,SCNIN1
  7180
  7181				    ;SUPERVISOR RESPONSE TO LOGIN STRING
  7182
  7183	011110'	135300	000264'	RCVS6:	LDB	T1,INPCHR
  7184					JUMPN	T1,[PUSHJ P,ERRXIT	;ERROR, TELL USER
  7185	011111'	326300	016476'			AOJA P4,SCNIN1]	;AND CLEAN UP
  7186	011112'	260040	011124'		PUSHJ	P,AUXWAK	;WAKE UP THE USER
  7187	011113'	344740	000746'		AOJA	P4,SCNIN1
  7188
  7189	011114'	135300	000264'	RCVSP:	LDB	T1,INPCHR
  7190					JUMPN	T1,[PUSHJ P,ERRXIT	;ERROR, TELL USER
  7191	011115'	326300	016476'			AOJA P4,SCNIN1]	;AND CLEAN UP
  7192	011116'	201300	000001		MOVEI	T1,.ASRQ1	;SHOULDN'T GIVE ERROR TO USER,
  7193	011117'	202300	015746'		MOVEM	T1,AUXSTA	;SO SETUP FOR RETRY
  7194	011120'	344740	000746'		AOJA	P4,SCNIN1
  7195
  7196	011121'	202300	015761'	ERRXIT:	MOVEM	T1,AUXERR	;SAVE ERROR
  7197	011122'	331240	015745'		SKIPL	U,AUXRCP	;IS THERE A PORT
  7198	011123'	260040	014622'		 PUSHJ	P,TTYZAP	;YES, ZAP IT
  7199	011124'	402000	015746'	AUXWAK:	SETZM	AUXSTA		;STATE:=.ASIDL (IDLE)
  7200	011125'	200100	015762'		MOVE	J,AUXJOB	;JOB WAITING
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 167-2
SCNSER.MAC	25-NOV-87 19:52		SUPERVISOR RESPONSE RECIVED

  7201	011126'	201300	001426*		MOVEI	T1,RNQ
  7202	011127'	137300	001427*		DPB	T1,PJBSTS##
  7203	011130'	324740	001430*		PJRST	SETRUN		;RESTART HIM FOM MLOWQ
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 168
SCNSER.MAC	25-NOV-87 19:52		MESSAGE 7 - AN AUX CIRCUIT HAS BEEN BUILT TO <U> FOR

  7204				SUBTTL	 MESSAGE 7 - AN AUX CIRCUIT HAS BEEN BUILT TO <U> FOR
  7205				;	       THE JOB WHOSE COMMAND PORT IS <INPCHR>
  7206
  7207	011131'	200305	000001	RCVAUX:	MOVE	T1,LDBLIN(U)
  7208	011132'	603300	400000		TLNE	T1,LNLZIN		;IF THERE'S AN UNECHOED ZAPPER,
  7209					 JRST	[MOVEI	T1,NZAPAX
  7210						 PUSHJ	P,ZAPBUG	;NOTE IT
  7211	011133'	254000	016500'			 JRST	.+1]
  7212	011134'	332005	000026		SKIPE	LDBLOG(U)		; LOGGING OR LOGGED IN?
  7213									;  TREAT AS CIRCUIT ZAPPER
  7214					  JRST	[PUSHJ	P,ZAPLOG	; NOTE THE ZAP (increment P4)
  7215						 MOVE	T1,AUXSTA	; Make sure that we were
  7216						 CAIE	T1,.ASWPT	;  expecting a type 7 msg.
  7217						  SOJA	P4,AUXWST	; No? decrement & handle error
  7218						 AOS	AUXSTA		; Yes, State:= .ASWTP, keep waiting!
  7219	011135'	254000	016503'			 JRST	SCNIN1]		; Return to loop
  7220
  7221	011136'	200300	015746'		MOVE	T1,AUXSTA		; T1/ STATE
  7222	011137'	306300	000006		CAIN	T1,.ASWPT		; IF WE'RE NOT EXPECTING A TYPE 7,
  7223	011140'	254000	011147'		 JRST	AUXINP
  7224					PFALL	AUXWST			;   NOTE THE ERROR
  7225
  7226	011141'			AUXWST:	; MESSAGE RECEIVED IN WRONG STATE
  7227	011141'	350000	015763'		AOS	AUXWSC			; NOTE THE FACT
  7228	011142'	254000	011145'		JRST	AUXZPT			; TREAT MSG AS A ZAPPER
  7229
  7230	011143'			AUXWPN:	; MESSAGE RECEIVED BUT WITH THE WRONG PORT NUMBER
  7231	011143'	350000	015764'		AOS	AUXWPC			; NOTE THE FACT
  7232	011144'	202300	015765'		MOVEM	T1,AUXWPT		; SAVE THE (BAD) PORT'S LDB ADDR
  7233					PFALL	AUXZPT			; TREAT MSG AS A ZAPPER
  7234
  7235	011145'	260040	014622'	AUXZPT:	PUSHJ	P,TTYZAP		; ARRANGE TO SEND ZAPPER
  7236	011146'	344740	000746'		AOJA	P4,SCNIN1
  7237
  7238	011147'	135300	000264'	AUXINP:	LDB	T1,INPCHR		; T1/ CREATING JOB'S PORT #
  7239	011150'	312300	015771'		CAME	T1,AUXPRT		; IS IT CORRECT?
  7240	011151'	254000	011143'		 JRST	AUXWPN			; NO
  7241	011152'	552240	015745'		HRRZM	U,AUXRCP		; SAVE THE LINE POINTER
  7242	011153'	205300	400000		MOVSI	T1,(1B0)
  7243	011154'	202305	000026		MOVEM	T1,LDBLOG(U)		; SET LOGGED-IN BIT
  7244
  7245					; INITIALIZE THE LINE
  7246	011155'	402005	000003		SETZM	LDBOUT(U)
  7247	011156'	402005	000027		SETZM	LDBBYT(U)
  7248	011157'	402005	000030		SETZM	LDBMOD(U)
  7249	011160'	402005	000046		SETZM	LDBTMT(U)
  7250			000000		ZZN==0
  7251				REPEAT TMCSIZ,<
  7252	011161'	402005	000044		SETZM LDBTMR+ZZN(U)
  7253			000001		ZZN==ZZN+1
  7254				> ; End REPEAT TMCSIZ
  7255	011162'	205300	003340		MOVSI	T1,LDLDEF!LDLIMI!LDLAUX!LDLNEC!LDLNFC
  7256	011163'	202305	000031		MOVEM	T1,LDBDCH(U)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 168-2
SCNSER.MAC	25-NOV-87 19:52		MESSAGE 7 - AN AUX CIRCUIT HAS BEEN BUILT TO <U> FOR

  7257	011164'	205300	400000		MOVSI	T1,LXL120
  7258	011165'	202305	000032		MOVEM	T1,LDBDCX(U)
  7259	011166'	505300	015747'		HRLI	T1,AUXSTR		; Copy string sent to
  7260	011167'	541305	000034		HRRI	T1,LDBSTR(U)		;  supervisor for tracking
  7261	011170'	251305	000043		BLT	T1,LDBSTR+AUXSTL-1(U)
  7262
  7263	011171'	260040	007534'		PUSHJ	P,SETLMD		; SET THE INPUT MODE
  7264	011172'	344740	000746'		AOJA	P4,SCNIN1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 169
SCNSER.MAC	25-NOV-87 19:52		CALLED ONCE A TICK FROM SCNINT TO PROCESS AUX CIRCUIT BUILDS

  7265				SUBTTL	CALLED ONCE A TICK FROM SCNINT TO PROCESS AUX CIRCUIT BUILDS
  7266
  7267	011173'	200300	015746'	SNDAUX:	MOVE	T1,AUXSTA	;SEE WHAT WE SHOULD DO
  7268	011174'	256006	011177'		XCT	AXSNTB(T1)
  7269	011175'	254000	011256'		 JRST	AUXTOV		;TIME OUT
  7270	011176'	254000	010621*		JRST	CPOPJ1		;JUST RETURN
  7271
  7272	011177'	254000	011176*	AXSNTB:	JRST	CPOPJ1		;.ASIDL  DO NOTHING
  7273	011200'	254000	011211'		JRST	SNDSRQ		;.ASRQ1  SEND 1ST REQUEST
  7274	011201'	377000	015772'		SOSG	AUXTIM		;.ASWR1  TIME THE RESPONSE
  7275	011202'	254000	011211'		JRST	SNDSRQ		;.ASRQ2  SEND 2ND REQUEST
  7276	011203'	377000	015772'		SOSG	AUXTIM		;.ASWR2  TIME THE RESPONSE
  7277	011204'	254000	011222'		JRST	AUXCHR		;.ASLOG  SEND LOGIN STRING
  7278	011205'	377000	015772'		SOSG	AUXTIM		;.ASWPT  TIME THE RESPONSE
  7279	011206'	377000	015772'		SOSG	AUXTIM		;.ASWTP  TIME THE RESPONSE
  7280
  7281	011207'	000000	021450	AUXTMR:	^D150*^D60		;REQUEST RESPONSE TIMEOUT
  7282	011210'	000000	021450	AUXTMP:	^D150*^D60		;PORT RESPONSE TIMEOUT
  7283
  7284				    ;HERE TO SEND A SUPERVISOR REQUEST
  7285
  7286	011211'	260040	004102'	SNDSRQ:	PUSHJ	P,CLSCHR
  7287	011212'	263040	000000		  POPJ	P,		;NOT REALLY ANY ROOM
  7288	011213'	205700	054000		MOVSI	P3,TYPI TYPSUP	;SEND REQUEST
  7289	011214'	200300	015771'		MOVE	T1,AUXPRT	;GET THE PORT NUMBER
  7290	011215'	137300	000272'		DPB	T1,WRPLIN
  7291	011216'	200300	011207'		MOVE	T1,AUXTMR	;SET TIMER
  7292	011217'	202300	015772'		MOVEM	T1,AUXTIM
  7293	011220'	350000	015746'		AOS	AUXSTA		;ADVANCE STATE (.ASRQX = .ASWTX)
  7294	011221'	254000	004144'		JRST	WRDOUT		;AND SEND REQUEST
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 170
SCNSER.MAC	25-NOV-87 19:52		HERE TO SEND CHARACTERS FROM THE LOGIN STRING

  7295				SUBTTL	HERE TO SEND CHARACTERS FROM THE LOGIN STRING
  7296
  7297	011222'	260040	004102'	AUXCHR:	PUSHJ	P,CLSCHR
  7298	011223'	263040	000000		  POPJ	P,		;NO ROOM
  7299	011224'	205700	060000		MOVSI	P3,TYPI TYPAXC
  7300	011225'	200300	015771'		MOVE	T1,AUXPRT
  7301	011226'	137300	000272'		DPB	T1,WRPLIN	;SET UP TO SEND
  7302	011227'	200340	015742'	AXCLP1:	MOVE	T2,MXMCNT	;SPACE LEFT
  7303	011230'	271340	000002		ADDI	T2,2
  7304	011231'	242340	777776		LSH	T2,-2
  7305	011232'	134300	015760'	AUXCLP:	ILDB	T1,AUXSTP
  7306	011233'	322300	011251'		JUMPE	T1,AXCDON	;FINISHED
  7307	011234'	137300	000273'		DPB	T1,WRPCHR
  7308	011235'	202717	004564*		MOVEM	P3,ORING(P4)	;PUT IN RING
  7309	011236'	363340	011240'		SOJLE	T2,AXCLP2	;RAN OUT OF ROOM
  7310	011237'	344740	011232'		 AOJA	P4,AUXCLP	;ADVANCE POINTER AND CONTINUE
  7311
  7312	011240'	271740	000001	AXCLP2:	ADDI	P4,1		;ADVANCE POINTER
  7313	011241'	405740	004566*		ANDI	P4,MSKORG
  7314	011242'	200300	015760'		MOVE	T1,AUXSTP
  7315	011243'	134300	000006		ILDB	T1,T1		;GET NEXT CHARACTER
  7316	011244'	322300	011251'		JUMPE	T1,AXCDON	;HAVE REALLY SENT THEM ALL
  7317	011245'	202740	004552*		MOVEM	P4,ORPPDP	;SAVE POINTER FOR 620
  7318	011246'	260040	004123'		PUSHJ P,SETOUT
  7319	011247'	263040	000000		  POPJ	P,		;OUT OF ROOM
  7320	011250'	254000	011227'		JRST	AXCLP1		;MORE ROOM, SEND MORE
  7321
  7322	011251'	202740	011245*	AXCDON:	MOVEM	P4,ORPPDP
  7323	011252'	200300	011210'		MOVE	T1,AUXTMP
  7324	011253'	202300	015772'		MOVEM	T1,AUXTIM	;SET TIMER
  7325	011254'	350000	015746'		AOS	AUXSTA		;STATE:=.ASWPT (WAIT FOR PORT RESPONSE)
  7326	011255'	324740	004123'		PJRST	SETOUT		;RESET ROOM COUNTERS AND EXIT
  7327
  7328				;HERE ON ANY TIMEOUT
  7329
  7330	011256'	350001	000000	AUXTOV:	AOS	(P)		;SET FOR SKIP RETURN
  7331	011257'	200300	015746'		MOVE	T1,AUXSTA
  7332	011260'	256006	011261'		XCT	AXTOTB(T1)	;RESPOND ACCORDING TO WHAT GOT TIMED-OUT
  7333
  7334	011261'	256000	000000'	AXTOTB:	 STOPCD			;.ASIDL  CAN'T TIME OUT
  7335	011262'	256000	000000'		 STOPCD			;.ASRQ1  CAN'T TIME OUT
  7336	011263'	254000	011271'		JRST	AXNRR		;.ASWT1  1ST REQUEST TIMED OUT
  7337	011264'	256000	000000'		 STOPCD			;.ASRQ2  CAN'T TIME OUT
  7338	011265'	254000	011271'		JRST	AXNRR		;.ASWT2  2ND RESPONSE TIMED OUT
  7339	011266'	256000	000000'		 STOPCD			;.ASLOG  CAN'T TIME OUT
  7340	011267'	254000	011273'		JRST	AXNRL		;.ASWPT  PORT RESPONSE TIMED OUT
  7341	011270'	254000	011273'		JRST	AXNRL		;.ASWTP  PORT RESPONSE TIMED OUT (BAD RCVAUX)
  7342
  7343	011271'	205300	000004	AXNRR:	MOVSI	T1,CXNRR%	;SET ERROR CODE
  7344	011272'	324740	011121'		PJRST	ERRXIT
  7345
  7346	011273'	205300	000005	AXNRL:	MOVSI	T1,CXNRL%
  7347	011274'	324740	011121'		PJRST	ERRXIT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 171
SCNSER.MAC	25-NOV-87 19:52		CODE TO HANDLE THE CREAT AUX CIR UUO

  7348				SUBTTL	CODE TO HANDLE THE CREAT AUX CIR UUO
  7349
  7350			000000	IFCPU(<KI,KL>),<CXDTP==0>
  7351				IFCPU(<KS,F3>),<CXDTP==1>
  7352
  7353	011275'	352000	000000*	CREAUX::AOSE	AXREQ
  7354	011276'	260040	000000*		 PUSHJ	P,AXWAIT	;WAIT FOR RESOURCE
  7355	011277'	402000	000000*		SETZM	AXSWT
  7356	011300'	201340	011444'		MOVEI	T2,AXGIV
  7357	011301'	202342	000000*		MOVEM	T2,JBTABT(J)	;SET ERROR LOCATION
  7358	011302'	402000	015761'		SETZM	AUXERR		;NO ERROR YET
  7359	011303'	476000	015745'		SETOM	AUXRCP		;AND NO PORT
  7360	011304'	550202	010764*		HRRZ	F,TTYTAB(J)
  7361	011305'	322200	011315'		JUMPE	F,AUXDET	;IF NO JOB (!)
  7362	011306'	550244	000013		HRRZ	U,DDBLDB(F)
  7363	011307'	322240	011315'		JUMPE	U,AUXDET	;OR NOT ATTACHED
  7364	011310'	205340	040000		MOVSI	T2,LDLPTY
  7365	011311'	612345	000031		TDNE	T2,LDBDCH(U)	;OR CONTROLLED BY A PTY,
  7366	011312'	254000	011315'		 JRST	AUXDET
  7367				IFNKMC<
  7368	011313'	135240	000153'		LDB	U,LDPLNO	; Use CMD port as index!!
  7369	011314'	334000	000000		SKIPA			;  ** not done if KMC **
  7370				> ; End IFNKMC
  7371	011315'	201240	000000	AUXDET:	MOVEI	U,CXDTP		;  FAKE A PORT NUMBER
  7372	011316'	202240	015771'		MOVEM	U,AUXPRT	;Send to SUP on this port number
  7373	011317'	202100	015762'		MOVEM	J,AUXJOB	;SET JOB NUMBER
  7374	011320'	200600	000006		MOVE	P1,T1		;SAVE ARGUMENT
  7375	011321'	505300	440700		HRLI	T1,(POINT 7,0)	;GET POINTER TO THE STRING
  7376	011322'	200740	016475'		MOVE	P4,[POINT 7,AUXSTR]	;SET TO SAVE IT
  7377	011323'	201700	000035		MOVEI	P3,AUXSTM	;MAX WE CAN HAVE
  7378	011324'	200440	016511'		MOVE	T4,[POINT 6,AUXUNM]	;SET TO ACCUMULATE A USER NAME
  7379	011325'	201640	000014		MOVEI	P2,^D12		;MAX CHRS IN USER NAME
  7380	011326'	402000	015773'		SETZM	AUXUNM
  7381	011327'	402000	015774'		SETZM	AUXUNM+1
  7382	011330'	402000	015747'		SETZM	AUXSTR		;Clear out accumulated string
  7383	011331'	200340	016512'		MOVE	T2,[AUXSTR,,AUXSTR+1]
  7384	011332'	251340	015756'		BLT	T2,AUXSTR+AUXSTL-1
  7385
  7386	011333'	256040	016513'	AUXSLP:	XCTFU	<ILDB	T2,T1>	;GET 7-BIT CHAR FROM USER
  7387	011334'	322340	011350'		JUMPE	T2,AXSFN1	;END OF STRING
  7388	011335'	136340	000017		IDPB	T2,P4		;PUT IT AWAY
  7389	011336'	302340	000015		CAIE	T2,15
  7390	011337'	306340	000073		CAIN	T2,";"		;TERMINATE ON RETURN OR ;
  7391	011340'	254000	011352'		 JRST	AXSFIN
  7392	011341'	306340	000072		CAIN	T2,":"		;TERMINATE USER NAME ON :
  7393	011342'	400640	000000		 SETZ	P2,0		;BY ZAPPING COUNT
  7394	011343'	275340	000040		SUBI	T2,40		;CONVERT TO SIXBIT
  7395	011344'	321340	011347'		JUMPL	T2,AUXNSB	;Don't put control chars in username
  7396	011345'	361640	011347'		SOJL	P2,AUXNSB	;ALREADY TOO MANY CHRS IN USER NAME
  7397	011346'	136340	000011		IDPB	T2,T4		;AND SAVE IT
  7398	011347'	367700	011333'	AUXNSB:	SOJG	P3,AUXSLP	;SEE IF ROOM FOR MORE
  7399
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 172
SCNSER.MAC	25-NOV-87 19:52		CODE TO HANDLE THE CREAT AUX CIR UUO

  7400	011350'	201340	000015	AXSFN1:	MOVEI	T2,15
  7401	011351'	136340	000017		IDPB	T2,P4		;TOO MANY, FINISH WITH RETURN
  7402	011352'	201340	000000	AXSFIN:	MOVEI	T2,0
  7403	011353'	136340	000017		IDPB	T2,P4		;TERMINATE STRING WITH 0
  7404	011354'	552740	015757'		HRRZM   P4,AUXEND	;SAVE POINTER TO LAST WORD OF LOGIN STRING
  7405	011355'	550400	000017		HRRZ    T3,P4           ;ZERO OUT LAST WORD OF LOGIN
  7406	011356'	136340	000017		IDPB    T2,P4           ; STRING TO RIGHT OF NULL
  7407	011357'	306417	000000		CAIN    T3,(P4)         ; SO THAT CREAUX STREAM
  7408	011360'	254000	011356'		 JRST	.-2             ; RECORDS LOOK GOOD
  7409	011361'	205340	000400		MOVSI	T2,LICAC
  7410	011362'	612342	010746*		TDNE	T2,JBTLIC(J)	;SEE IF HE HAS LICENSE
  7411	011363'	254000	011401'		 JRST	AUXLIC		;YES
  7412	011364'	200340	015773'		MOVE	T2,AUXUNM
  7413	011365'	200400	015774'		MOVE	T3,AUXUNM+1
  7414	011366'	316342	000000*		CAMN	T2,JBTUNM(J)	;CHECK USER NAME MATCH
  7415	011367'	312402	000000*		CAME	T3,JBTUN1(J)
  7416					 JRST	[MOVSI T2,CXLOG%
  7417	011370'	254000	016514'			JRST AXERGV]	;ERROR
  7418	011371'	260040	015337'		PUSHJ	P,FRSTTY	;NOW SEE HOW MANY CIRCUITS
  7419	011372'	254000	011401'		  JRST	AUXLIC
  7420	011373'	260040	015341'		PUSHJ	P,NXTTTY
  7421	011374'	254000	011401'		  JRST	AUXLIC		;NONE
  7422	011375'	260040	015341'		PUSHJ	P,NXTTTY
  7423	011376'	254000	011401'		  JRST	AUXLIC		;ONE
  7424	011377'	205340	000001		MOVSI	T2,CX2AX%
  7425	011400'	254000	011434'		JRST	AXERGV		;ERROR, already have 2 circuits in use
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 173
SCNSER.MAC	25-NOV-87 19:52		CODE TO HANDLE THE CREAT AUX CIR UUO

  7426	011401'			AUXLIC:
  7427				IFKMC<
  7428					LDB	T3,[POINT 2,P1,2]	;GET TYMBASE NUMBER
  7429					PUSHJ	P,KMCGUP	;T1/ TYMBASE "UP" BITS
  7430					MOVSI	T2,^D8		;TYMBASE DOWN MESSAGE
  7431					XCT	TSTDRU(T3)	;SKIP IF IT'S UP
  7432					  JRST	AXERGV		;ELSE RETURN TYMBASE DOWN MESSAGE
  7433					JRST	AUXDRU
  7434				
  7435				TSTDRU:	TRZN	T1,DR1BIT
  7436					TRZN	T1,DR2BIT
  7437					TRZN	T1,DR3BIT
  7438					TRZN	T1,DR4BIT
  7439				
  7440				AUXDRU:	LSH	T3,6		;Request circuit on DR# * 64.
  7441					IORM	T3,AUXPRT
  7442				> ; END IFKMC
  7443	011401'	201300	000000*		MOVEI	T1,MLOWQ
  7444	011402'	137300	011127*		DPB	T1,PJBSTS##
  7445	011403'	350000	015746'		AOS	AUXSTA		;SET STATE TO 1
  7446	011404'	260040	006426*		PUSHJ	P,WSCHED	;AND RESCHEDULE
  7447	011405'	332340	015761'		SKIPE	T2,AUXERR	;ANY ERRORS
  7448	011406'	254000	011434'		 JRST	AXERGV
  7449	011407'	335000	015745'		SKIPGE	AUXRCP	;PORT THERE?
  7450					 JRST	[
  7451						AOS	NRPCNT	;BUMP COUNT
  7452						MOVSI	T2, CXNCH%
  7453						JRST	AXERGV	;ERROR-RETURN
  7454	011410'	254000	016516'		]
  7455	011411'	550302	011304*		HRRZ	T1,TTYTAB(J)	;WHERE TO LINK. REALLY SHOULD BE A DDB
  7456	011412'	332000	000006		SKIPE	T1
  7457	011413'	260040	015147'		 PUSHJ	P,DDBSR1
  7458					  JRST	[MOVSI T2,CXDCB%	;NO DDB SPACE
  7459	011414'	254000	016521'			JRST AXERGV]
  7460	011415'	137100	010773*		DPB	J,PJOBN
  7461	011416'	201300	400000		MOVEI	T1,ASSCON
  7462	011417'	603600	000001		TLNE	P1,1
  7463	011420'	661300	010000		 TLO	T1,DVNZP	;SET NO ZAP BIT
  7464	011421'	436304	000004		IORM	T1,DEVMOD(F)
  7465	011422'	200240	015745'		MOVE	U,AUXRCP
  7466	011423'	135300	000153'		LDB	T1,LDPLNO	;GET LINE NUMBER
  7467	011424'	256200	016523'		UMOVEM	T1,(W)
  7468	011425'	542244	000013		HRRM	U,DDBLDB(F)
  7469	011426'	542205	000000		HRRM	F,LDBDDB(U)
  7470	011427'	260040	015213'		PUSHJ	P,SCNNAM
  7471	011430'	201300	000022		MOVEI	T1,22		;WRITE CREAUX
  7472	011431'	260040	000000*		PUSHJ	P,ACTWRT##	; STREAM RECORD
  7473	011432'	350001	000000		AOS	(P)
  7474	011433'	254000	011446'		JRST	AUXGV1		;FINISHED
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 174
SCNSER.MAC	25-NOV-87 19:52		CODE TO HANDLE THE CREAT AUX CIR UUO

  7475	011434'	256200	016524'	AXERGV:	UMOVEM	T2,(W)
  7476	011435'	254000	011444'	AXELOG:	JRST	AXGIV		;JFCL IF WANT ACT REC FOR ERRS
  7477	011436'	202340	015761'		MOVEM	T2,AUXERR	;SAVE ERR TYPE FOR ACTSER
  7478	011437'	201300	000022		MOVEI	T1,22		;CREAUX REC TYPE
  7479	011440'	557000	000007		HLRZS	T2		;WRITE REC ONLY
  7480	011441'	332000	000007		SKIPE	T2		; FOR EXTRA
  7481	011442'	306340	000006		CAIN	T2,CXNCH%	; HOST ERRORS
  7482	011443'	260040	011431*		 PUSHJ	P,ACTWRT##
  7483	011444'	331240	015745'	AXGIV:	SKIPL	U,AUXRCP
  7484	011445'	260040	014622'		 PUSHJ	P,TTYZAP
  7485	011446'	402002	011301*	AUXGV1:	SETZM	JBTABT(J)
  7486	011447'	402000	015746'		SETZM	AUXSTA
  7487	011450'	371000	011275*		SOSL	AXREQ
  7488	011451'	476000	000000*		 SETOM	AXAVAL
  7489	011452'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 175
SCNSER.MAC	25-NOV-87 19:52		READ INFO ON PORTS IN USE

  7490				SUBTTL	READ INFO ON PORTS IN USE
  7491
  7492	011453'	201340	000000	AUXRED::MOVEI	T2,0		;NUMBER OF PORTS SO FAR
  7493					JUMPGE	T1,[XCTTU <SETOM (W)>
  7494	011454'	325300	016526'			POPJ P,]	;FLAG ERROR
  7495	011455'	253300	011456'		AOBJN	T1,.+1
  7496	011456'	260040	015337'		PUSHJ	P,FRSTTY	;THIS WILL GET COMMAND PORT
  7497	011457'	254000	011474'		  JRST	AUXRN1		;OH WELL
  7498	011460'	205440	000010		MOVSI	T4,DVTTY	;TO TEST FOR TTY
  7499	011461'	260040	015341'	AUXRL1:	PUSHJ	P,NXTTTY	;NEXT IN CHAIN
  7500	011462'	254000	011474'		   JRST	AUXRN1		;FINISHED
  7501	011463'	616444	000004		TDNN	T4,DEVMOD(F)
  7502	011464'	254000	011461'		 JRST	AUXRL1		;IGNORE ALL BUT TTYS
  7503	011465'	550244	000013		HRRZ	U,DDBLDB(F)	;GET LINE
  7504	011466'	322240	011461'		JUMPE	U,AUXRL1	;IGNORE IF NO LINE
  7505	011467'	325300	011473'		JUMPGE	T1,AUXRL2	;NO ROOM TO PUT IT
  7506	011470'	135400	000153'		LDB	T3,LDPLNO
  7507	011471'	256200	016530'		UMOVEM	T3,-1(T1)
  7508	011472'	253300	011473'		AOBJN	T1,.+1
  7509	011473'	344340	011461'	AUXRL2:	AOJA	T2,AUXRL1	;COUNT 1
  7510	011474'	256200	016531'	AUXRN1:	XCTTU	<SETOM -1(T1)>	;FLAG END OF LIST
  7511	011475'	256200	016524'		UMOVEM	T2,(W)
  7512	011476'	254000	011177*		JRST	CPOPJ1		;FINISHED
  7513
  7514				;ZAP AUX CIRCUITS
  7515
  7516	011477'	321300	011507'	ZAPCIR::JUMPL	T1,ZAPALL	;ALL OF THEM
  7517	011500'	200200	000006		MOVE	F,T1
  7518	011501'	260040	015541'		PUSHJ	P,FNDPRT	;FIND THE PORT
  7519	011502'	263040	000000		  POPJ	P,		;NOT THERE
  7520	011503'	550244	000013		HRRZ	U,DDBLDB(F)
  7521	011504'	322240	010741*		JUMPE	U,CPOPJ		;NO LINE, IGNORE
  7522	011505'	400300	000000		SETZ	T1,		;Don't cause any confusion
  7523	011506'	254000	006551'		JRST	HNGPRT		;GO HANG HIM
  7524
  7525	011507'	260040	015337'	ZAPALL:	PUSHJ	P,FRSTTY
  7526	011510'	263040	000000		  POPJ	P,		;NOT COMMAND
  7527	011511'	260040	015341'	ZAPAL1:	PUSHJ	P,NXTTTY
  7528	011512'	263040	000000		  POPJ	P,		;DONE
  7529	011513'	205300	000010		MOVSI	T1,DVTTY
  7530	011514'	616304	000004		TDNN	T1,DEVMOD(F)
  7531	011515'	254000	011511'		 JRST	ZAPAL1		;NOT A TTY
  7532	011516'	550244	000013		HRRZ	U,DDBLDB(F)
  7533	011517'	322240	011511'		JUMPE	U,ZAPAL1
  7534	011520'	400300	000000		SETZ	T1,
  7535	011521'	260040	006551'		PUSHJ	P,HNGPRT
  7536	011522'	254000	011511'		JRST	ZAPAL1		;ON TO NEXT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 176
SCNSER.MAC	25-NOV-87 19:52		POLL PORTS UUO

  7537				SUBTTL  POLL PORTS UUO
  7538
  7539				; POLPRT - POLL PORTS FOR INTERRUPT-CAUSING EVENTS
  7540				;
  7541				;	MOVE	AC, [BITS,,ADDR]
  7542				;	POLPRT	AC,
  7543				;	  ERROR RETURN (TABLE TOO SMALL)
  7544				;	NORMAL RETURN
  7545				;
  7546				;	(AC/ # OF PORTS RETURNED ON EITHER RETURN)
  7547				;
  7548				; ADDR:	WORD COUNT (# WORDS, INCLUDING THIS ONE)
  7549				;	BITS,,PORT (SET BY UUO)
  7550				;	...
  7551				;
  7552				; WHERE <BITS> IS A MASK FOR THE EVENT BITS IN RH(LDBDCX)
  7553
  7554	011523'	256200	016532'	POLPRT::XCTFU	<MOVN T2, (T1)>
  7555	011524'	207000	000007		MOVSS	T2
  7556	011525'	540340	000006		HRR	T2, T1		; T2/ AOBJN POINTER
  7557	011526'	400440	000000		SETZ	T4,		; T4/ COUNT OF PORTS RETURNED
  7558	011527'	260040	015337'		PUSHJ	P, FRSTTY
  7559	011530'	254000	011551'		  JRST POLPT4
  7560
  7561					; GOT A PORT
  7562	011531'	200404	000004	POLPT1:	MOVE	T3, DEVMOD(F)
  7563	011532'	603400	000010		TLNE	T3, DVTTY
  7564	011533'	336244	000013		SKIPN	U, DDBLDB(F)
  7565	011534'	254000	011546'		JRST	POLPT3		; NOT TTY OR NO LDB
  7566
  7567					; CHECK THE EVENTS FOR THIS PORT
  7568	011535'	554400	000006		HLRZ	T3, T1		; T3/ 0,,MASK BITS
  7569	011536'	404405	000032		AND	T3, LDBDCX(U)	; T3/ 0,,MASKED EVENTS
  7570	011537'	412405	000032		ANDCAM	T3, LDBDCX(U)	; TURN OFF WHAT WE'VE READ
  7571	011540'	322400	011546'		JUMPE	T3, POLPT3	; NOTHING HAPPENED: TRY NEXT PT
  7572	011541'	252340	011552'		AOBJP	T2, POLPT5	; NO ROOM: ERROR-RETURN
  7573	011542'	350000	000011		AOS	T4		; T4/ COUNT OF PORTS RETURNED
  7574	011543'	256200	016533'		XCTBU	<HRLM T3, (T2)>	; STORE THE EVENT BITS
  7575	011544'	135400	000153'		LDB	T3, LDPLNO
  7576	011545'	256200	016534'		XCTBU	<HRRM T3, (T2)>	; AND THE PORT NUMBER
  7577
  7578					; GET ANOTHER PORT
  7579	011546'	260040	015341'	POLPT3:	PUSHJ	P, NXTTTY
  7580	011547'	254000	011551'		  JRST POLPT4
  7581	011550'	254000	011531'		JRST	POLPT1
  7582	011551'	350001	000000	POLPT4:	AOS	(P)		; NORMAL RETURN: PORTS EXHAUSTED
  7583	011552'	256200	016535'	POLPT5:	UMOVEM	T4, (W)		; AC := COUNT OF PORTS RETURNED
  7584	011553'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 177
SCNSER.MAC	25-NOV-87 19:52		BLOCK INPUT/OUTPUT (BIO) ROUTINES

  7585				SUBTTL BLOCK INPUT/OUTPUT (BIO) ROUTINES
  7586
  7587				;THE FORMAT OF A BLOCK I/O BUFFER IS:
  7588
  7589			000000	BIOLNK==0	;PTR TO LINKED LIST OF BIO BUFFERS.
  7590			000001	BIOCSH==1	;CACHE SWEEP NUMBER AT TIME REQUEST WAS QUEUED.
  7591			000002	BIOPBP==2	;PTY BLOCK I/O: ILDB/IDPB POINTER FOR NEXT BYTE
  7592			000003	BIOPBC==3	;PTY BLOCK I/O: # BYTES LEFT TO TRANSFER
  7593			000004	BIOREQ==4	;CHAR COUNT OF LAST INPUT REQUEST BY THIS PORT.
  7594			000005	BIOCHR==5	;COUNT OF CHARACTERS TO TRANSFER. (IN OR OUT).
  7595			000006	BIODAT==6	;BEGINNING OF USER DATA.
  7596
  7597				;HERE FROM ENABLE BLOCK I/O AUXCAL
  7598
  7599	011554'	205300	001000	BLKIO:	MOVSI	T1,LMLBIO
  7600	011555'	612305	000030		TDNE	T1,LDBMOD(U)	;IF ALREADY IN BLOCK MODE,
  7601	011556'	263040	000000		 POPJ	P,		;  ERROR-RETURN
  7602	011557'	336405	000005		SKIPN	T3,LDBBIO(U)	;DOES THE BIO PORT HAVE ANY
  7603	011560'	254000	011573'		 JRST	BLKIO2		;ACTIVE BUFFERS?
  7604	011561'	554300	000010		HLRZ	T1,T3		;YES.  OUTPUT ACTIVE?
  7605	011562'	322300	011566'		JUMPE	T1,BLKIO1	;NO - GO CHECK FOR INPUT.
  7606	011563'	260040	012303'		PUSHJ	P,OQUEUE	;YES. QUEUE JOB UNTIL DONE.
  7607	011564'	263040	000000		  POPJ	P,		;LINE IS GONE.  HE LOSES.
  7608	011565'	254000	011554'		JRST BLKIO
  7609
  7610	011566'	550300	000010	BLKIO1:	HRRZ	T1,T3		;INPUT BUFFER ACTIVE?
  7611	011567'	332000	000006		SKIPE	T1		;
  7612	011570'	260040	012274'		 PUSHJ	P,IQUEUE	;YES. WAIT FOR CH7 TO RELEASE IT
  7613	011571'	263040	000000		  POPJ P,		;NO.  DON'T WORRY ABOUT IT.
  7614	011572'	254000	011554'		JRST BLKIO
  7615
  7616				;HERE IF NO ACTIVE BUFFERS
  7617	011573'	260040	012023'	BLKIO2:	PUSHJ	P,INCBC		;SET UP FOR 1 MORE JOB. IF CAN'T,
  7618	011574'	263040	000000		  POPJ	P,		;  NONSKIP-RETURN
  7619	011575'	205300	001000		MOVSI	T1,LMLBIO	;SET FLAG IN THE LDB INDICATING
  7620	011576'	436305	000030		IORM	T1,LDBMOD(U)	;PORT IS IN BIO MODE.
  7621	011577'	350001	000000		AOS	(P)		;MADE IT!  SKIP RETURN TO USER
  7622	011600'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 178
SCNSER.MAC	25-NOV-87 19:52		BLKXIO - HERE FROM THE LEAVE BLOCK MODE AUXCAL

  7623				SUBTTL	BLKXIO - HERE FROM THE LEAVE BLOCK MODE AUXCAL
  7624
  7625	011601'	200305	000030	BLKXIO:	MOVE	T1,LDBMOD(U)
  7626	011602'	607300	001000		TLNN	T1,LMLBIO	;IF PORT'S NOT IN BLOCK MODE,
  7627	011603'	263040	000000		 POPJ	P,		;  JUST RETURN
  7628	011604'	336405	000005		SKIPN	T3,LDBBIO(U)	;IF THERE'S NOTHING IN PROGRESS,
  7629	011605'	254000	011641'		 JRST	BIORES		;  GET OUT NOW
  7630	011606'	554300	000010		HLRZ	T1,T3
  7631	011607'	322300	011613'		JUMPE	T1,BLKX1	;IF THERE'S OUTPUT IN PROGRESS,
  7632	011610'	260040	012303'		PUSHJ	P,OQUEUE	;  WAIT FOR IT. IF ZAPPED,
  7633	011611'	263040	000000		  POPJ	P,		;    JUST RETURN
  7634	011612'	254000	011601'		JRST	BLKXIO
  7635
  7636				    ;HERE FROM BLKXIO AND BIOREL - TERMINATE/DISCARD CURRENT BLK INPUT
  7637
  7638	011613'	550300	000010	BLKX1:	HRRZ	T1,T3
  7639	011614'	322300	011621'		JUMPE	T1,BLKX2	;IF THERE'S INPUT IN PROGRESS,
  7640	011615'	260040	012321'		PUSHJ	P,BLKXIN	;  REQUEST INPUT TERMINATION
  7641	011616'	550305	000005		HRRZ	T1,LDBBIO(U)
  7642	011617'	331006	000005		SKIPL	BIOCHR(T1)	;  IF THE BASE IS DONE WITH THE BUFFER,
  7643	011620'	260040	012105'		 PUSHJ	P,RELBI		;    THROW IT AWAY NOW
  7644	011621'	336005	000005	BLKX2:	SKIPN	LDBBIO(U)	;IF NO BUFFERS,
  7645	011622'	324740	011641'		 PJRST	BIORES		;  GET OUT NOW
  7646	011623'	205300	001000		MOVSI	T1,LMLBIO
  7647	011624'	412305	000030		ANDCAM	T1,LDBMOD(U)	;ELSE, CLEAR THE BLOCK MODE BIT
  7648	011625'	263040	000000		POPJ	P,		;  CH7 WILL DO THE REST
  7649
  7650				;BIOREL - HERE FROM RESET UUO FOR EACH PORT IN BLOCK MODE
  7651				;	   TERMINATE BLOCK INPUT AND OUTPUT
  7652
  7653	011626'	336405	000005	BIOREL:	SKIPN	T3,LDBBIO(U)	;IF NO ACTIVE I OR O,
  7654	011627'	324740	011641'		 PJRST	BIORES		;  GET OUT NOW
  7655	011630'	554300	000010		HLRZ	T1,T3
  7656	011631'	322300	011613'		JUMPE	T1,BLKX1	;IF OUTPUT ACTIVE,
  7657	011632'	260040	012347'		PUSHJ	P,BLKXOT	;  REQUEST OUTPUT TERMINATION
  7658	011633'	254000	011613'		JRST	BLKX1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 179
SCNSER.MAC	25-NOV-87 19:52		BIOZAP - CALLED WHEN A CIRCUIT IN BLOCK MODE IS ZAPPED

  7659				SUBTTL	BIOZAP - CALLED WHEN A CIRCUIT IN BLOCK MODE IS ZAPPED
  7660
  7661	011634'	205300	400000	BIOZAP:	MOVSI	T1,LMLTBI
  7662	011635'	412305	000030		ANDCAM	T1,LDBMOD(U)	;CLEAR "TERMINATE PENDING" FLAG
  7663	011636'	137300	000063'		DPB	T1,LOPBOP	;Clear PTY "Block-output-in-progress"
  7664	011637'	260040	012105'		PUSHJ	P,RELBI		;MUST BE DONE WITH INPUT
  7665	011640'	260040	012111'		PUSHJ	P,RELBO		;MUST BE DONE WITH OUTPUT
  7666					PFALL	BIORES		;MUST BE DONE WITH BLOCK I/O
  7667
  7668				;BIORES - CLEAR BLKIO BIT AND FLAG NEGOTIATOR THAT WE'RE DONE
  7669
  7670	011641'	205300	001000	BIORES:	MOVSI	T1,LMLBIO	;TAKE PORT OUT OF BLKIO MODE
  7671	011642'	412305	000030		ANDCAM	T1,LDBMOD(U)	;
  7672	011643'	324740	012046'		PJRST	DECBC		;ONE FEWER PORT DOING BLOCK I/O
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 180
SCNSER.MAC	25-NOV-87 19:52		BLKINP - BLOCK INPUT-AND-WAIT AUXCAL

  7673				SUBTTL	 BLKINP - BLOCK INPUT-AND-WAIT AUXCAL
  7674
  7675	011644'	260040	011675'	BLKINP:	PUSHJ	P,BIOCHK	; EVERYTHING OK?
  7676	011645'	263040	000000		  POPJ	P,		; NO
  7677	011646'	550305	000005		HRRZ	T1,LDBBIO(U)	; T1/ INPUT BUFFER ADDRESS
  7678					JUMPE	T1,[		; NO INPUT BUFFER
  7679						TLNE	S,IOEND		; IOEND SET?
  7680						 JRST	BLKEOF		; RETURN EOF
  7681						MOVE	T2,LDBMOD(U)
  7682						TLNE	T2,LMLTBI	; TERMINATE PENDING?
  7683						 JRST	BLKIP1		; WAIT FOR IT
  7684						PUSHJ	P,REQBUF	; GET BUF & REQ. INPUT
  7685						  POPJ	P,		; FAILED (PORT ZAPPED)
  7686						JRST	BLKIP1		; MADE REQ.: NOW WAIT
  7687	011647'	322300	016536'		]
  7688	011650'	200346	000005		MOVE	T2,BIOCHR(T1)	; T2/ IN-PROGRESS FLAG,,COUNT
  7689	011651'	321340	011655'		JUMPL	T2,BLKIP1	; IN-PROGRESS: WAIT FOR IT
  7690	011652'	260040	011705'		PUSHJ	P,GOTBUF	; COMPLETE: TRANSFER DATA
  7691	011653'	255000	000000		  JFCL			; COUNT=0
  7692	011654'	254000	011476*		JRST	CPOPJ1		; OR COUNT .gt. 0: SKIP-RETURN
  7693
  7694				    ; HERE TO WAIT FOR "BLOCK INPUT TERMINATED" MESSAGE
  7695				    ; OF SOME SORT
  7696
  7697	011655'	260040	012274'	BLKIP1:	PUSHJ	P,IQUEUE
  7698	011656'	263040	000000		  POPJ	P,		; PORT GONE
  7699	011657'	254000	011644'		JRST	BLKINP		; RETRY
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 181
SCNSER.MAC	25-NOV-87 19:52		BLKINS - BLOCK INPUT-AND-SKIP AUXCAL

  7700				SUBTTL	 BLKINS - BLOCK INPUT-AND-SKIP AUXCAL
  7701
  7702	011660'	260040	011675'	BLKINS:	PUSHJ	P,BIOCHK	; EVERYTHING OK?
  7703	011661'	263040	000000		  POPJ	P,		; NO
  7704	011662'	550305	000005		HRRZ	T1,LDBBIO(U)	; T1/ INPUT BUFFER ADDRESS
  7705					JUMPE	T1,[		; NO INPUT BUFFER
  7706						TLNE	S,IOEND		; IOEND SET?
  7707						 JRST	BLKEOF		; RETURN EOF
  7708						MOVE	T2,LDBMOD(U)
  7709						TLNE	T2,LMLTBI	; TERMINATE PENDING?
  7710						 POPJ	P,		; NONSKIP-RETURN
  7711						PUSHJ	P,REQBUF	; GET BUF & REQ. INPUT
  7712						  POPJ	P,		; FAILED (PORT ZAPPED)
  7713						POPJ	P,		; MADE REQ.: NOW RETURN
  7714	011663'	322300	016546'		]
  7715	011664'	200346	000005		MOVE	T2,BIOCHR(T1)	; T2/ IN-PROGRESS FLAG,,COUNT
  7716	011665'	321340	011504*		JUMPL	T2,CPOPJ	; IN-PROGRESS: NONSKIP-RETURN
  7717	011666'	260040	011705'		PUSHJ	P,GOTBUF	; INPUT COMPLETE: TRANSFER DATA
  7718	011667'	263040	000000		  POPJ	P,		; COUNT=0: NONSKIP-RETURN
  7719	011670'	254000	011654*		JRST	CPOPJ1		; COUNT.gt.0: SKIP-RETURN
  7720
  7721				; BLKEOF - COMMON CODE TO SET IO.END
  7722				;	    FOR BLOCK INPUT AUXCALS
  7723
  7724	011671'	430000	016556'	BLKEOF:	XOR	S,[IOEND,,IODEND]
  7725	011672'	202004	000002		MOVEM	S,DEVIOS(F)	; SET IO.EOF, CLEAR IOEND
  7726	011673'	350001	000000		AOS	(P)
  7727	011674'	324740	012105'		PJRST	RELBI		; DONE WITH INPUT BUFFER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 182
SCNSER.MAC	25-NOV-87 19:52		BIOCHK - COMMON SETUP CODE FOR BLOCK INPUT AUXCALS

  7728				SUBTTL	 BIOCHK - COMMON SETUP CODE FOR BLOCK INPUT AUXCALS
  7729
  7730	011675'	200305	000030	BIOCHK:	MOVE	T1,LDBMOD(U)
  7731	011676'	607300	001000		TLNN	T1,LMLBIO	; BLOCK I/O ENABLED?
  7732	011677'	263040	000000		 POPJ	P,		; NO -- FAIL
  7733	011700'	602000	020000		TRNE	S,IODEND	; IO.EOF SET?
  7734	011701'	263040	000000		 POPJ	P,		; YES -- FAIL
  7735	011702'	260040	013245'		PUSHJ	P,BPXOFF	; IS THIS NECESSARY?
  7736	011703'	702600	400000*		NOCHARGE		; TURN OFF THE CLOCK
  7737	011704'	254000	011670*		JRST	CPOPJ1		; SUCCEED
  7738
  7739				; GOTBUF - COMMON BUFFER-TRANSFER CODE FOR BLOCK INPUT AUXCALS
  7740				;	    ENTER WITH T1/ INPUT BUFFER ADDRESS
  7741				;		       T2/ CHARACTER COUNT
  7742
  7743	011705'			GOTBUF:
  7744	011705'	261040	000014		PUSH	P,P1		;Needed in one irritating place
  7745	011706'	261040	000007		PUSH	P,T2		; SAVE CHARACTER COUNT
  7746	011707'	272342	000000*		ADDM	T2,JBTBIO(J)	; CHARGE JOB FOR CHARACTERS
  7747	011710'	272340	011707*		ADDM	T2,JBTBIO	; RECORD TOTAL CHARACTERS
  7748	011711'	271340	000003		ADDI	T2,3
  7749	011712'	242340	777776		LSH	T2,-2		; T2/ # OF WORDS
  7750	011713'	505406	000005		HRLI	T3,BIOCHR(T1)	; T3/ START OF MON DATA,,
  7751	011714'	540400	000013		HRR	T3,M		; T3/ ",,START OF USER BUFFER
  7752				IFNKMC<
  7753	011715'	271350	000000		ADDI	T2,(T3)		; T2/ STOP LOCATION
  7754	011716'	256200	016557'		XCTTU <BLT T3,(T2)>	; TRANSFER THE COUNT&DATA
  7755				>;END IFNKMC
  7756				IFKMC<
  7757					;T2/# OF WORDS
  7758					;T3/MONITOR BUFFER,,USER BUFFER
  7759					PUSH	P,T1		;SAVE T1
  7760					PUSH	P,T4		;TO HOLD DESTINATION BYTEPOINTER
  7761					LSH	T2,1		;T2/# OF HALF WORDS
  7762					HRRZ	T4,T3		;T4/0,,USER BUFFER
  7763					HLRZ	T3,T3		;T3/0,,MONITOR BUFFER
  7764					MOVE	T1,(T3)		;GET FIRST WORD FOR USER BUFFER
  7765					XCT 4,[MOVEM T1,(T4)]	;PUT IT IN USER BUF
  7766					ADDI	T4,1
  7767					ADDI	T3,1
  7768					HRLI	T3,(POINT 18,0)	;PACK HALFWORD BYTES INTO
  7769					HRLI	T4,(POINT 16,0)	;	FULLWORD BYTES
  7770				GBXLUP:	ILDB	T1,T3		;GET MONITOR HALF WORD
  7771					XCT	1,[IDPB T1,T4]	;PUT TWO BYTES IN USER BUF
  7772					SOJG	T2,GBXLUP
  7773					POP	P,T4		;RESTORE THEM REGISTERS
  7774					POP	P,T1		;RESTORE T1
  7775				>;END IFKMC
  7776	011717'	200345	000030		MOVE	T2,LDBMOD(U)
  7777	011720'	607340	400000		TLNN	T2,LMLTBI	; TERMINATE-INPUT PENDING?
  7778	011721'	603000	000040		TLNE	S,IOEND		; IOEND SET?
  7779					 JRST	[
  7780						PUSHJ	P,RELBI		; DONE WITH INPUT BUFFER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 182-2
SCNSER.MAC	25-NOV-87 19:52		BIOCHK - COMMON SETUP CODE FOR BLOCK INPUT AUXCALS

  7781						JRST	GOTBF1		; GO FINISH UP
  7782	011722'	254000	016560'		]
  7783	011723'	260040	012117'		PUSHJ	P,KEPBI		; IF SOMEONE ELSE WANTS A BUFFER,
  7784	011724'	334000	000000		  SKIPA			;By all means let 'em have it
  7785	011725'	254000	011733'		 JRST	GOTBF0		;No competition
  7786	011726'	200606	000004		MOVE	P1,BIOREQ(T1)	;Save count in a safe place (!)
  7787	011727'	260040	012105'		PUSHJ	P,RELBI		;Give up the buffer/port
  7788	011730'	260040	012075'		PUSHJ	P,GETBI		;Get a new one
  7789	011731'	254000	011735'		  JRST	GOTBF1		;Not needed...
  7790	011732'	202606	000004		MOVEM	P1,BIOREQ(T1)	;Set count in new buffer
  7791	011733'			GOTBF0:
  7792	011733'	200346	000004		MOVE	T2,BIOREQ(T1)	; T2/ OLD REQUEST COUNT
  7793	011734'	260040	011751'		PUSHJ	P,BLKIRQ	; REQUEST INPUT
  7794	011735'	262040	000006	GOTBF1:	POP	P,T1		; T1/ COUNT BLT'ED
  7795	011736'	262040	000014		POP	P,P1		;Remember him?
  7796	011737'	326300	011704*		JUMPN	T1,CPOPJ1	; SKIP IF .GT. 0
  7797	011740'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 183
SCNSER.MAC	25-NOV-87 19:52		REQBUF - ALLOCATE A BUFFER FOR BLOCK INPUT

  7798				SUBTTL	 REQBUF - ALLOCATE A BUFFER FOR BLOCK INPUT
  7799				;	    STORE ITS ADDRESS IN RH(LDBBIO(U))
  7800				;	    SAVE THE USER'S BYTE COUNT IN BIOREQ(RH(LDBBIO(U)))
  7801				;	    AND SEND AN INPUT REQUEST
  7802				;	    SKIP-RETURN NORMALLY
  7803				;	    NONSKIP-RETURN IF ZAPPED WHILE IN "EXTRA" WAIT
  7804
  7805	011741'	260040	012075'	REQBUF:	PUSHJ	P,GETBI		; SET UP FOR BLOCK INPUT
  7806	011742'	263040	000000		  POPJ	P,		; FAILED (ZAPPED)
  7807
  7808					; SUCCEEDED: T1/ INPUT BUFFER ADDRESS
  7809
  7810	011743'	256200	016562'		XCTFU <HRRZ T2, (M)>	; T2/ USER'S BYTE COUNT
  7811	011744'	303340	000620		CAILE	T2, ^D400
  7812	011745'	201340	000620		MOVEI	T2, ^D400	; T2/ USER'S COUNT .MIN. 400
  7813	011746'	202346	000004		MOVEM	T2, BIOREQ(T1)	; SAVE FOR READAHEAD CODE
  7814	011747'	350001	000000		AOS	(P)		; PREPARE FOR SKIP-RETURN
  7815	011750'	324740	011751'		PJRST	BLKIRQ		; REQUEST INPUT
  7816
  7817				; BLKIRQ - REQUEST BLOCK INPUT
  7818				;	    ENTER WITH T1/ BUFFER ADDRESS
  7819				;		       T2/ CHARACTER COUNT
  7820
  7821	011751'			BLKIRQ:
  7822				IFCPU (KL),<
  7823	011751'	200400	004515*		MOVE	T3,CSUCNT##	;WHEN I/O STARTS, SWEEP NUMBER
  7824								;MUST BE DIFFERENT THAN THIS.
  7825	011752'	202406	000001		MOVEM	T3,BIOCSH(T1)>
  7826	011753'	200405	000030		MOVE	T3,LDBMOD(U)
  7827	011754'	603400	400000		TLNE	T3,LMLTBI	; TERMINATE PENDING?
  7828	011755'	256000	000000'		 STOPCD			; IMPOSSIBLE!
  7829	011756'	562346	000005		HRROM	T2,BIOCHR(T1)	; IN-PROG := -1, COUNT := T2.RH
  7830	011757'	201300	000001		MOVEI	T1,1
  7831	011760'	137300	000057'		DPB	T1,LOPBIN	;SET BLOCK INPUT
  7832	011761'	137305	000002		DPB	T1,LDBOPB(U)	;AND NEED-OUTPUT
  7833	011762'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 184
SCNSER.MAC	25-NOV-87 19:52		BLKOUT - HERE FROM BLOCK OUTPUT AUXCAL.  SKIPS ON SUCCESS.

  7834				SUBTTL	BLKOUT - HERE FROM BLOCK OUTPUT AUXCAL.  SKIPS ON SUCCESS.
  7835
  7836	011763'	200305	000030	BLKOUT:	MOVE T1,LDBMOD(U)	;TEST TO SEE IF BLOCK I/O
  7837	011764'	607300	001000		TLNN T1,LMLBIO		;MODE HAS BEEN SET.
  7838	011765'	263040	000000		 POPJ P,		;ERROR RETURN IF NOT.
  7839	011766'	702600	400000*		NOCHARGE		;TURN OFF THE CLOCK.
  7840	011767'	554305	000005		HLRZ T1,LDBBIO(U)	;IS THERE A BLOCK OUTPUT
  7841	011770'	322300	011774'		JUMPE T1,BLKOT1		; ALREADY IN PROGRESS?
  7842	011771'	260040	012303'		PUSHJ P,OQUEUE		;I/O WAIT OR INTERRUPT
  7843	011772'	263040	000000		 POPJ P,		;NO.  ERROR RETURN TO THE USER.
  7844	011773'	254000	011763'		JRST BLKOUT		;MAKE SURE BUFFER WAS RELEASED.
  7845	011774'	260040	012101'	BLKOT1:	PUSHJ	P, GETBO	;SET UP FOR BLOCK OUTPUT
  7846	011775'	263040	000000		  POPJ	P,		;  ZAPPED
  7847	011776'	256200	016562'		XCTBU <HRRZ T2,(M)>	;GET USER'S WORD COUNT
  7848	011777'	307340	000620		CAIG	T2,^D400	;IF < 0 OR > 400
  7849	012000'	336000	000007		SKIPN	T2		;OR = 0
  7850	012001'	324740	012111'		 PJRST	RELBO		;  GET OUT AND ERROR-RETURN
  7851	012002'	303340	000120		CAILE T2,^D80		;MIN. NO. OF CHARS FOR CHARGING
  7852	012003'	334400	000007		 SKIPA T3,T2		;PURPOSES IS EIGHTY.
  7853	012004'	201400	000120		MOVEI T3,^D80
  7854	012005'	272402	011710*		ADDM T3,JBTBIO(J)	;ADD TO BIO CHRS XFER'D FOR JOB.
  7855	012006'	272400	012005*		ADDM T3,JBTBIO		;ADD TO TOTAL BIO CHARS XFERRED.
  7856	012007'	271340	000003		ADDI T2,3
  7857	012010'	242340	777776		LSH T2,-2
  7858	012011'	256200	016563'		XCTBU <MOVSI T3,(M)>	;GET ADDRESS OF USER BUFFER
  7859	012012'	541406	000005		HRRI T3,BIOCHR(T1)	;PREPARE FOR BLT TO MONITOR
  7860				IFNKMC<
  7861	012013'	271346	000005		ADDI T2,BIOCHR(T1)	;ADD IN BASE LOC FOR XFER
  7862	012014'	256040	016557'		XCTFU <BLT T3,(T2)>	;BUFFER.
  7863				IFCPU (KL),<
  7864	012015'	200340	004540*		MOVE	T2,CSVCNT##	;MUST DO ONE VALIDATE BEFORE CAN START
  7865	012016'	202346	000001		MOVEM	T2,BIOCSH(T1)>	;I/O.
  7866				>;END IFNKMC
  7867				IFKMC<
  7868					;T2/# OF WORDS
  7869					;T3/USER BUFFER,,MONITOR BUFFER
  7870					PUSH	P,T4		;TO HOLD DESTINATION BYTEPOINTER
  7871					LSH	T2,1		;T2/# OF HALF WORDS
  7872					HRRZ	T4,T3		;T4/0,,MONITOR BUFFER
  7873					HLRZ	T3,T3		;T3/0,,USER BUFFER
  7874					XCT	4,[MOVE T1,(T3)]	;GET FIRST WORD OF USER BUFFER
  7875					MOVEM	T1,(T4)		;PUT IT IN MON BUF
  7876					ADDI T4,1
  7877					ADDI T3,1
  7878					HRLI	T3,(POINT 16,0)	;UNPACK FULLWORD BYTES INTO
  7879					HRLI	T4,(POINT 18,0)	;		HALFWORD BYTES
  7880				XCTLUP:	XCT 1,[ILDB T1,T3]	;GET TW0 USER BYTES
  7881					IDPB	T1,T4
  7882					SOJG	T2,XCTLUP
  7883					POP	P,T4		;RESTORE THEM REGISTERS
  7884				>;END IFKMC
  7885	012017'	201300	000001		MOVEI T1,1
  7886	012020'	137300	000074'		DPB T1,LOPBOT		;SET BLOCK OUTPUT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 184-2
SCNSER.MAC	25-NOV-87 19:52		BLKOUT - HERE FROM BLOCK OUTPUT AUXCAL.  SKIPS ON SUCCESS.

  7887	012021'	137305	000002		DPB T1,LDBOPB(U)	;AND NEED-OUTPUT
  7888	012022'	254000	011737*		JRST CPOPJ1		;AND SUCCESS-RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 185
SCNSER.MAC	25-NOV-87 19:52		BLKOUT - HERE FROM BLOCK OUTPUT AUXCAL.  SKIPS ON SUCCESS.

  7889				COMMENT %
  7890
  7891				There are (presently) three block i/o mechanisms, one for
  7892				620 bases, one for PTYs, and one, as yet uncoded, for Nexilis
  7893				bases. For the sake of everyone's sanity, there must be a
  7894				level in the block i/o code at which the distinction between
  7895				these three becomes invisible.
  7896
  7897				In particular, the UUOs should use only the following routines,
  7898				which will acquire and release the appropriate resources
  7899				regardless of the mechanism being used:
  7900
  7901					GETBI	sets up a port to do block input
  7902					RELBI	called when a port's done with block input
  7903					KEPBI	skips if it's ok for this port to keep
  7904						its block-input resources; if it nonskips,
  7905						caller should do a RELBI/GETBI sequence
  7906					GETBO	sets up a port for block output
  7907					RELBO	called when a port's done with block output
  7908					INCBC	enables the block i/o mechanism for 1 more
  7909						job (1 more PDP10 port), and skip-returns
  7910						if 1 more is ok
  7911					DECBC	called when a port is disabled for block i/o
  7912
  7913				%
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 186
SCNSER.MAC	25-NOV-87 19:52		INCBC - CALLED WHEN 1 MORE PORT IS TO BE ENABLED FOR BLOCK I/O

  7914				SUBTTL	INCBC - CALLED WHEN 1 MORE PORT IS TO BE ENABLED FOR BLOCK I/O
  7915				;	  SKIP-RETURNS IF 1 MORE IS OK
  7916				;	  CALLED WITH U/ LDB ADDR, J/ JOB #
  7917
  7918	012023'	500245	000031	INCBC:	HLL	U, LDBDCH(U)
  7919	012024'	603240	040000		TLNE	U, LDLPTY	;IF IT'S A PTY,
  7920	012025'	254000	012044'		JRST	INCPBC		;  THINGS ARE SIMPLER
  7921
  7922				    ;HERE FOR REAL TTYS
  7923
  7924	012026'	702600	400000*		NOCHARGE		;TURN OFF THE CLOCK.
  7925				IFCPU (<KI,KL>), <
  7926	012027'	352000	011450*		AOSE AXREQ		;INC REQUEST COUNT FOR AUX QUEUE
  7927	012030'	260040	011276*		PUSHJ P,AXWAIT		;QUEUE JOB IF REQ IN PROGRESS
  7928	012031'	350000	015776'		AOS BIOCNT+0		;INCREMENT COUNT OF BIO JOBS
  7929	012032'	563000	015776'		HRROS BIOCNT+0		;FLAG FOR CH7 TO SEND REQUEST.
  7930	012033'	202100	015770'		MOVEM J,BIOJOB		;BIOJOB_JOB NO W REQ IN PROGRESS
  7931	012034'	201300	011401*		MOVEI T1,MLOWQ		;PLACE THIS JOB IN THE ML QUEUE
  7932	012035'	137300	011402*		DPB T1,PJBSTS##		;AND WAIT UNTIL AN ANSWER IS
  7933	012036'	260040	011404*		PUSHJ P,WSCHED		;RECEIVED FROM THE BASE.
  7934	012037'	333000	016000'		SKIPLE BIOPRT		;IF THERE7S AT LEAST ONE SLOT,
  7935	012040'	350001	000000		 AOS (P)		;  SET TO SKIP-RETURN
  7936	012041'	371000	012027*		SOSL AXREQ
  7937	012042'	476000	011451*		SETOM AXAVAL
  7938	012043'	263040	000000		POPJ P,
  7939				> ;END IFCPU (<KI,KL>)
  7940				IFNCPU (<KI,KL>), <
  7941					AOS	BIOCNT		;ONE MORE BIO JOB
  7942					SOSL	BPREQ		;AND ONE MORE BUFFER
  7943					SETOM	BPAVAL		;ACTIVATE JOB WAITING FOR A BUFFER
  7944					JRST	CPOPJ1
  7945				> ;END IFNCPU (<KI,KL>)
  7946
  7947				    ;HERE FOR PTYS
  7948
  7949	012044'	350000	015777'	INCPBC:	AOS	BIOCNT+1	;1 MORE BLOCK-MODE PTY
  7950	012045'	254000	012022*		JRST	CPOPJ1		;SKIP-RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 187
SCNSER.MAC	25-NOV-87 19:52		DECBC - CALLED WHEN A PORT HAS BEEN DISABLED FOR BLOCK I/O

  7951				SUBTTL	DECBC - CALLED WHEN A PORT HAS BEEN DISABLED FOR BLOCK I/O
  7952				;	  AND ALL BLOCK I/O ACTIVITY FOR IT HAS STOPPED
  7953				;	  CALLED WITH U/ LDB ADDR
  7954
  7955	012046'	500245	000031	DECBC:	HLL	U, LDBDCH(U)
  7956	012047'	603240	040000		TLNE	U, LDLPTY	;IF IT'S A PTY,
  7957	012050'	254000	012057'		JRST	DECPBC		;  THINGS ARE A BIT EASIER
  7958
  7959				    ;HERE FOR A REAL TTY
  7960
  7961	012051'	570300	015776'		HRRE	T1, BIOCNT+0	;T1/ REAL TTY BLOCK I/O USER COUNT
  7962	012052'	365300	012054'		SOJGE	T1, .+2
  7963	012053'	256000	000000'		 STOPCD
  7964				IFCPU (<KI,KL>), <
  7965	012054'	562300	015776'		HRROM	T1, BIOCNT+0	;BIOCNT+0/ "CHANGED",,NEW COUNT
  7966				> ;END IFCPU (<KI,KL>)
  7967				IFNCPU (<KI,KL>), <
  7968					MOVEM	T1,BIOCNT+0	;ONE LESS BIO JOB
  7969					AOS	BPREQ		;ONE LESS BUFFER
  7970				> ;END IFNCPU (<KI,KL>)
  7971	012055'	270300	015777'		ADD	T1, BIOCNT+1	;T1/ TOTAL BLOCK USER COUNT
  7972	012056'	254000	012063'		JRST	DECBC1
  7973
  7974				    ;HERE FOR A PTY
  7975
  7976	012057'	375300	015777'	DECPBC:	SOSGE	T1, BIOCNT+1	;T1/ PTY BLOCK USER COUNT
  7977	012060'	256000	000000'		 STOPCD
  7978	012061'	570340	015776'		HRRE	T2, BIOCNT+0
  7979	012062'	270300	000007		ADD	T1, T2		;T1/ TOTAL BLOCK USER COUNT
  7980					PFALL	DECBC1
  7981
  7982				    ;HERE FOR EITHER - FREE UP UNNECESSARY BUFFERS
  7983
  7984	012063'	240300	000001	DECBC1:	ASH	T1, 1		;T1/ MAX # OF BUFFERS NEEDED (2*PORTS)
  7985	012064'	274300	016001'		SUB	T1, BIOBUF	;T1/ -# OF UNNEEDED BUFFERS IN POOL
  7986	012065'	261040	000006		PUSH	P, T1
  7987	012066'	353001	000000	DECBC2:	AOSLE	(P)
  7988	012067'	254000	012073'		JRST	DECBC3
  7989	012070'	260040	012172'		PUSHJ	P, GETBBP	;GET A BUFFER FROM THE BLOCK I/O POOL
  7990	012071'	260040	012206'		PUSHJ	P, RELBBF	;RELEASE IT TO FREECORE
  7991	012072'	254000	012066'		JRST	DECBC2
  7992	012073'	262040	000006	DECBC3:	POP	P, T1
  7993	012074'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 188
SCNSER.MAC	25-NOV-87 19:52		GETBI - SET UP A PORT FOR BLOCK INPUT

  7994				SUBTTL	GETBI - SET UP A PORT FOR BLOCK INPUT
  7995				;	  NONSKIP IF LEFT BLOCK MODE
  7996				;	  ELSE SKIP WITH T1 AND LDBBIO(U).RH SET TO BUFFER
  7997
  7998	012075'	260040	012133'	GETBI:	PUSHJ	P, GETBIO
  7999	012076'	263040	000000		POPJ	P,
  8000	012077'	542305	000005		HRRM	T1, LDBBIO(U)
  8001	012100'	254000	012045*		JRST	CPOPJ1
  8002
  8003				;GETBO - SET UP A PORT FOR BLOCK OUTPUT
  8004
  8005	012101'	260040	012133'	GETBO:	PUSHJ	P, GETBIO
  8006	012102'	263040	000000		POPJ	P,
  8007	012103'	506305	000005		HRLM	T1, LDBBIO(U)
  8008	012104'	254000	012100*		JRST	CPOPJ1
  8009
  8010				;RELBI - CALLED WHEN A PORT'S DONE WITH BLOCK INPUT
  8011				;	  RETURNS T1/ LDBBIO(U)
  8012
  8013	012105'	550305	000005	RELBI:	HRRZ	T1, LDBBIO(U)
  8014	012106'	322300	012115'		JUMPE	T1, RELB0
  8015	012107'	513005	000005		HLLZS	LDBBIO(U)
  8016	012110'	324740	012150'		PJRST	RELBIO
  8017
  8018				;RELBO - CALLED WHEN A PORT'S DONE WITH BLOCK OUTPUT
  8019				;	  RETURNS T1/ LDBBIO(U)
  8020
  8021	012111'	554305	000005	RELBO:	HLRZ	T1, LDBBIO(U)
  8022	012112'	322300	012115'		JUMPE	T1, RELB0
  8023	012113'	553005	000005		HRRZS	LDBBIO(U)
  8024	012114'	324740	012150'		PJRST	RELBIO
  8025
  8026	012115'	200305	000005	RELB0:	MOVE	T1, LDBBIO(U)
  8027	012116'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 189
SCNSER.MAC	25-NOV-87 19:52		KEPBI - SKIP-RETURNS IF IT'S OK FOR THIS PORT (U/ LDB ADDRESS)

  8028				SUBTTL	KEPBI - SKIP-RETURNS IF IT'S OK FOR THIS PORT (U/ LDB ADDRESS)
  8029				;	  TO KEEP ITS BLOCK INPUT RESOURCES, NONSKIPS IF
  8030				;	  SOMEBODY ELSE WANTS THEM
  8031
  8032	012117'	261040	000006	KEPBI:	PUSH	P, T1
  8033	012120'	205300	040000		MOVSI	T1, LDLPTY
  8034	012121'	612305	000031		TDNE	T1, LDBDCH(U)	;IF IT'S NOT A PTY
  8035	012122'	254000	012126'		JRST	KEPBI1
  8036	012123'	200305	000005		MOVE	T1, LDBBIO(U)
  8037	012124'	333000	001416*		SKIPLE	BPREQ		;AND SOMEONE'S WAITING FOR PORTS
  8038	012125'	603300	777777		TLNE	T1, 777777	;AND WE CAN FREE ONE,
  8039	012126'	333000	000000*	KEPBI1:	SKIPLE	FCREQ		;OR IF SOMEONE'S WAITING FOR FREECORE,
  8040	012127'	254000	012131'		JRST	.+2		;  DON'T SKIP
  8041	012130'	350001	777777		AOS	-1(P)
  8042	012131'	262040	000006		POP	P, T1
  8043	012132'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 190
SCNSER.MAC	25-NOV-87 19:52		GETBIO - GET A BLOCK I/O BUFFER FOR U

  8044				SUBTTL	GETBIO - GET A BLOCK I/O BUFFER FOR U
  8045				;	   NONSKIP-RETURN IF PORT LEFT BIO MODE WHILE WAITING
  8046				;	   SKIP-RETURN WITH T1/ THE BUFFER ADDRESS OTHERWISE
  8047
  8048	012133'	205300	400000	GETBIO:	MOVSI	T1,LNLZIN	;Was a zapper seen on this line?
  8049	012134'	612305	000001		TDNE	T1,LDBLIN(U)	; ...
  8050	012135'	263040	000000		 POPJ	P,		;Pretend there are no more buffers for now
  8051	012136'	205300	040000		MOVSI	T1,LDLPTY
  8052	012137'	616305	000031		TDNN	T1,LDBDCH(U)	;IF IT'S NOT A PTY
  8053	012140'	332005	000005		SKIPE	LDBBIO(U)	;AND THERE'S NO BLOCK I/O IN PROGRESS,
  8054	012141'	254000	012144'		 JRST	GTBIO1
  8055	012142'	353000	012124*		AOSLE	BPREQ
  8056	012143'	260040	000000*		PUSHJ	P,BPWAIT	;  GET A BASE PORT
  8057	012144'	260040	012162'	GTBIO1:	PUSHJ	P,GETBB		;T1/ BUFFER ADDRESS
  8058	012145'	200345	000030		MOVE	T2,LDBMOD(U)
  8059	012146'	603340	001000		TLNE	T2,LMLBIO	;IF PORT'S STILL IN BLOCK MODE,
  8060	012147'	254000	012104*		 JRST	CPOPJ1		;  SKIP-RETURN
  8061					PFALL	RELBIO
  8062
  8063				;RELBIO - RELEASE A BLOCK I/O BUFFER FOR U
  8064				;	   CALLED WITH T1/ THE BUFFER ADDRESS
  8065				;	   FREES THE PORT IF NO BUFFERS REMAIN
  8066				;	   RETURNS T1/ LDBBIO(U)
  8067
  8068	012150'	260040	012204'	RELBIO:	PUSHJ	P,RELBB		;FREE THE BUFFER
  8069	012151'	205300	040000		MOVSI	T1,LDLPTY
  8070	012152'	612305	000031		TDNE	T1,LDBDCH(U)	;IF IT'S NOT A PTY
  8071	012153'	254000	012160'		 JRST	RLBIO1
  8072	012154'	336305	000005		SKIPN	T1,LDBBIO(U)	;AND NO BLOCK I OR O IN PROGRESS,
  8073	012155'	371000	012142*		SOSL	BPREQ		;  FREE THE BASE PORT
  8074	012156'	476000	001421*		 SETOM	BPAVAL
  8075	012157'	263040	000000		POPJ	P,
  8076
  8077	012160'	200305	000005	RLBIO1:	MOVE	T1, LDBBIO(U)	;T1/ LDBBIO
  8078	012161'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 191
SCNSER.MAC	25-NOV-87 19:52		GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1

  8079				SUBTTL	GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1
  8080				;GETBBP - GET ONE FROM THE POOL (NOT FREECORE) OR CRASH
  8081
  8082	012162'	332000	016002'	GETBB:	SKIPE	BBFREE		;IF NO FREE BLOCK BUFFERS,
  8083	012163'	254000	012174'		JRST	GETBB1
  8084	012164'	201340	000000*		MOVEI	T2, BIOCOR
  8085	012165'	335000	012126*		SKIPGE	FCREQ		;  GET ANOTHER. IF OTHER JOBS IN FC WAIT
  8086	012166'	260040	000000*		PUSHJ	P, GET4WD	;  OR NO FREE CORE,
  8087					JRST	[
  8088						AOS FCREQ
  8089						PUSHJ P,FCWAIT
  8090						SOS FCREQ
  8091						JRST GETBB	;    WAIT, THEN TRY AGAIN
  8092	012167'	254000	016564'		]
  8093				IFKMC<
  8094					EXTERNAL UBANXT,UBAEND	;OUR UBA SPACE IS BETWEEN THESE TWO
  8095					UBABIO==<763000!<<UBANXT+1>&776>>;START UBA's BLOCK I/O PAGING RAM
  8096					PUSH	P,T1		;SAVE UNMAPPED T1
  8097					PUSHJ	P,SCANBB	;RETURNS T2 WITH UBA PAGE # OF T1
  8098					  JRST [CAILE T2,UBAEND-<UBABIO&777> ;GUESS WE DIDN'T MATCH. ANY ROOM LEFT?
  8099						 STOPCD 	;GIVE UP IF NO ROOM.
  8100						HRLI T2,3	;T2/3,,AVAILABLE PAGE #
  8101						LSH T1,-9	;T1/HIGH 11 BITS OF MAPPED ADDRESS
  8102						TRO T1,1B21	;SET VALID BIT
  8103						WRIO T1,UBABIO(T2)
  8104						MOVEM T1,BBPAGE(T2)
  8105						ADDI T1,1	;ALSO INIT NEXT PAGE
  8106						WRIO T1,UBABIO+1(T2)
  8107						MOVEM T1,BBPAGE+1(T2)
  8108						HRRZ T2,T2	;T2/0,,PAGE #
  8109						AOS	BBCRE	;;;COUNT BIO BUFFERS CREATED
  8110						JRST .+1]	;CONTINUE
  8111					LSH	T2,-1		;T2/PAGE PAIR #
  8112					AOS	BBCNTS(T2)	;BUMP THE USE COUNT
  8113					POP	P,T1		;RESTORE UNMAPPED T1
  8114				>;END IFKMC
  8115	012170'	350000	016001'		AOS	BIOBUF		;  1 MORE BUFFER IN POOL
  8116	012171'	263040	000000		POPJ	P,		;  RETURN THE BUFFER
  8117
  8118				    ;HERE IF THERE ARE FREE BUFFERS IN THE BLOCK I/O POOL
  8119
  8120	012172'	336000	016002'	GETBBP:	SKIPN	BBFREE
  8121	012173'	256000	016570'	TTYNFB:: STOPCD (.,STOP,TTYNFB,,<No Free Buffrers>)
  8122				     ;;GETBBP+1
  8123	012174'	370000	016002'	GETBB1:	SOS	BBFREE
  8124	012175'	350000	016005'		AOS	BBPOOL		;COUNT USE OF FREE BIO BUFFERS
  8125	012176'	550300	015775'		HRRZ	T1, BUFLST
  8126	012177'	336000	000006		SKIPN	T1
  8127	012200'	256000	012173'		 STOPCD (,XCT,TTYNFB)
  8128				   ;No Free Buffers        ;;GETBB1+5
  8129	012201'	550346	000000		HRRZ	T2, (T1)
  8130	012202'	542340	015775'		HRRM	T2, BUFLST	;MAKE NEXT-LINK THE NEW HEADER
  8131	012203'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 191-2
SCNSER.MAC	25-NOV-87 19:52		GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1

  8132
  8133				;RELBB - RELEASE THE BLOCK I/O BUFFER POINTED TO BY T1
  8134				;RELBBF - ALWAYS RETURN IT TO FREECORE
  8135
  8136	012204'	335000	012165*	RELBB:	SKIPGE	FCREQ		;IF OTHER JOBS ARE WAITING FOR FREECORE,
  8137	012205'	254000	012213'		JRST	RELBB1
  8138	012206'	336340	000006	RELBBF:	SKIPN	T2, T1
  8139	012207'	256000	000000'		 STOPCD
  8140	012210'	370000	016001'		SOS	BIOBUF
  8141	012211'	201300	012164*		MOVEI	T1, BIOCOR
  8142				IFKMC<	PUSHJ P,RELKMC>		;RELEASE UBA SLOT
  8143	012212'	324740	000000*		PJRST	GIV4WD		;  JUST RELEASE THE BUFFER
  8144
  8145				    ;HERE TO ADD THE BUFFER TO THE BLOCK I/O POOL
  8146
  8147	012213'	336000	000006	RELBB1:	SKIPN	T1
  8148	012214'	256000	000000'		 STOPCD
  8149	012215'	550340	015775'		HRRZ	T2, BUFLST	;T2/ HEAD OF FREE CHAIN
  8150	012216'	202346	000000		MOVEM	T2, (T1)
  8151	012217'	202300	015775'		MOVEM	T1, BUFLST	;MAKE T1 THE NEW HEAD
  8152	012220'	350000	016002'		AOS	BBFREE
  8153	012221'	263040	000000		POPJ	P,
  8154
  8155				IFKMC<
  8156				RELKMC:	PUSH	P,T1		;SAVE T1
  8157					PUSH	P,T2		;SAVE UNMAPPED T2
  8158					MOVE	T1,T2		;T1/BUFFER ADDRESS
  8159					PUSHJ	P,SCANBB	;RETURNS T2 WITH UBA PAGE # OF T1
  8160					  STOPCD		;NO MATCH IS BAD NEWS!
  8161					LSH	T2,-1		;T2/PAGE PAIR NUMBER
  8162					SOSN	BBCNTS(T2)	;DEC PAGE PAIR USE COUNT
  8163					 JRST  [LSH T2,1	;;IF COUNT WENT TO 0 RESTORE T2 &
  8164						SETZ T1,	;;INVALIDATE THE PAGE PAIR
  8165						HRLI T2,3	;;UBA #3,,EVEN PAGE #
  8166						WRIO T1,UBABIO(T2)
  8167						WRIO T1,UBABIO+1(T2)
  8168						HRROS BBPAGE(T2)	;;;;DEBUG
  8169						HRROS BBPAGE+1(T2)	;;;;DEBUG CODE
  8170						AOS BBREL		;;;;INFO
  8171						JRST .+1]
  8172					POP	P,T2		;RESTORE UNMAPPED T2
  8173					POP	P,T1		;RESTORE T1
  8174					POPJ	P,		;RETURN
  8175				
  8176				
  8177				;RETURNS T1 MAPPED
  8178				;SKIP RETURNS WHEN T2/0,,MATCHED UBA PAGE
  8179				;NON-SKIP RETURNS WITH T2/0,,-1 OR T2/0,,AVAILABLE UBA PAGE #
  8180				SCANBB:	MAP	T1,(T1)
  8181					PUSH	P,T1		;SAVE MAPPED T1 FOR RETURN
  8182					PUSH	P,T3
  8183					PUSH	P,T4
  8184					AND	T1,[3777B26]	;MASK OUT ALL BUT HIGH 11 BITS
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 191-3
SCNSER.MAC	25-NOV-87 19:52		GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1

  8185					TLO	T1,(1B8)	;SET VALID BIT
  8186					MOVEI	T4,-1		;T4/0,,-1
  8187					HRLZI	T2,3		;T2/3,,0
  8188				SBBLUP:	RDIO	T3,UBABIO(T2)	;T3/EVEN PAGE # CONTENTS
  8189					AND T3,[<1B8!3777B26>]	;MASK OUT ALL BUT VALID BIT & HIGH 11
  8190					CAMN	T1,T3		;DOES IT MATCH?
  8191					 JRST  [POP P,T4	;IF IT DOES THEN SKIP RETURN
  8192						POP P,T3
  8193						POP P,T1	;RESTORE MAPPED T1
  8194						HRRZ T2,T2	;T2/0,,MATCHED PAGE #
  8195						JRST CPOPJ1	;DO SKIP RETURN
  8196						]
  8197					TLZN	T3,(1B8)	;IS THE VALID BIT ON?
  8198					 MOVEI	T4,(T2)		;T4/0,,LATEST AVAILABLE PAGE #
  8199					ADDI	T2,2		;T2/3,,NEXT PAGE PAIR
  8200					CAMGE	T2,[3,,UBAEND-<UBABIO&777>]	;ARE WE STILL LESS THAN 30?
  8201					 JRST	SBBLUP		;IF SO GO BACK TO SBB LOOP
  8202					MOVE	T2,T4		;T2/0,,-1 OR 0,,AVAILABLE SLOT NUMBER
  8203					POP	P,T4
  8204					POP	P,T3
  8205					POP	P,T1		;RESTORE MAPPED T1
  8206					POPJ	P,		;NON-SKIP RETURN
  8207				
  8208				
  8209				;MISC KMC RELATED ROUTINES
  8210				
  8211				
  8212				SCNMIN: PUSHJ	P,MDRUP		;T1/ FLAG DRs WE THINK ARE UP
  8213					MOVEM	T1,DRMBRK	;FLAG TO SEND DR PILLS
  8214					POPJ	P,
  8215				
  8216				SCNDRD:			;WILL SKIP A MINUTE WHEN KMCRES IS CALLED
  8217					SKIPE	T1,DRDOW
  8218					 JRST	SCNMI2		;SET DRMHSI ON 2ND MINUTE
  8219					PUSHJ	P,KMCRST##	;T1/ DOWN DR BITS
  8220					PUSHJ	P,DRFLAG	;T1/ 3-BIT DR NUMBERS NEEDING TYPHSI MSG
  8221					MOVEM	T1,DRDOW	;START DELAY FOR 41 TO NODE(S)
  8222					MOVEI	T1,^D60
  8223					MOVEM	T1,TIMDRD
  8224					POPJ	P,
  8225				SCNMI2:	MOVEM	T1,DRMHSI	;SET DRMHSI FLAG WITH DOWN DR NUMBERS
  8226					SETZM	DRDOW		;CLEAR DRDOW
  8227					POPJ	P,		;ACTUAL MESSAGES GET SENT FROM SNDHSI
  8228				
  8229				SNDHSI:	SKIPN	T1,DRMHSI	;T1/DOWN DR NUMBERS
  8230					 JRST	MDRSHT		;CHECK NEXT MULTI DR MESSAGE
  8231					SETZM	DRMHSI
  8232					MOVSI	P3,TYPI TYPHSI
  8233					PUSHJ	P,MDRMSG	;SEND TO ALL DR NUMs IN T1
  8234					JUMPN	T1,[		;IF NO ROOM IN THE RING TO FINISH THEN
  8235						MOVEM T1,DRMHSI ; SET DRMHSI TO DO THE REST NEXT TIME
  8236						POPJ	P,]   	; AND NON-SKIP RETURN
  8237				MDRSHT:	SKIPN	T1,DRMSHT	;T1/DRs THAT NEED A SHUT MESSAGE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 191-4
SCNSER.MAC	25-NOV-87 19:52		GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1

  8238					  JRST	MDRBRK		;CHECK NEXT MULTI DR MESSAGE
  8239					SETZM	DRMSHT
  8240					MOVSI	P3,TYPI TYPSHT
  8241					PUSHJ	P,MDRMSG
  8242					JUMPN	T1,[		;IF WE COULDN'T FINISH THEN
  8243						MOVEM T1,DRMSHT	; SET DRMSHT TO DO THE REST NEXT TIME
  8244						POPJ P,]	; AND NON-SKIP RETURN
  8245				MDRBRK:	SKIPN	T1,DRMBRK	;T1/DRs THAT NEED A 57 PILL
  8246					  JRST	MDRCLP		;CHECK NEXT MULTI DR MESSAGE
  8247					SETZM	DRMBRK
  8248					MOVSI	P3,TYPI TYPBRK	;WE USE A 51 "BRK" MSG FOR THE PILL
  8249					PUSHJ	P,MDRMSG
  8250					JUMPN	T1,[		;IF WE COULDN'T FINISH THEN
  8251						MOVEM T1,DRMBRK	; SET DRMBRK TO DO THE REST NEXT TIME
  8252						POPJ P,]	; AND NON-SKIP RETURN
  8253				MDRCLP:	SKIPN	T1,DRMCLP	;T1/DRs THAT NEED A CLOCK REQ MSG
  8254					  JRST	MDRANS		;CHECK NEXT MULTI DR MESSAGE
  8255					SETZM	DRMCLP
  8256					MOVSI	P3,TYPI TYPCLP
  8257					PUSHJ	P,MDRMSG
  8258					JUMPN	T1,[		;IF WE COULDN'T FINISH THEN
  8259						MOVEM T1,DRMCLP	; SET DRMCLP TO DO THE REST NEXT TIME
  8260						POPJ P,]	; AND NON-SKIP RETURN
  8261				MDRANS:	SKIPN	T1,DRMANS	;T1/DRs TO SEND AN ANSWERED MSG TO
  8262					  JRST	MDRNXT		;CHECK NEXT MULTI DR MESSAGE
  8263					SETZM	DRMANS
  8264					MOVSI	P3,TYPI TYPANS
  8265					PUSHJ	P,MDRMSG
  8266					JUMPN	T1,[		;IF WE COULDN'T FINISH THEN
  8267						MOVEM T1,DRMANS	; SET UP FOR NEXT TIME
  8268						POPJ P,]	; AND NON-SKIP RETURN
  8269				MDRNXT:	
  8270					MOVE	T1,DRMTIM	;;;;;;;START KMC DEBUG CODE
  8271					SUBI	T1,1
  8272					JUMPE	T1,CPOPJ1	;IGNORE FOR THE FIRST SECOND
  8273					PUSHJ	P,KMCGAV##
  8274					MOVE	T2,T1
  8275					ANDI	T2,377
  8276					LSH	T2,8
  8277					PUSHJ	P,KMCGAC##
  8278					ANDI	T1,377
  8279					IOR	T1,T2
  8280					CAMN	T1,KMCLAS	;SAME AS LAST TIME?
  8281					 JRST	CPOPJ1		;YES, BYE...
  8282					MOVEM	T1,KMCLAS
  8283					HRL	T1,DRMTIM
  8284					MOVE	T2,KMCPDP
  8285					MOVEM	T1,KMCFLG(T2)
  8286					ADDI	T2,1
  8287					ANDI	T2,77
  8288					MOVEM	T2,KMCPDP	;;;;;;;;END KMC DEBUG CODE
  8289					JRST	CPOPJ1	;END OF MDR CHAIN FOR NOW. SKIP RET
  8290				
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 191-5
SCNSER.MAC	25-NOV-87 19:52		GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1

  8291				MDRMSG:	;MSG TO ALL UP DRs	;P3/ MOVSI P3,TYPI TYPmsg
  8292					;T1/ 3-BIT UP DR NUMBERS;RET:T1/0 or DRs NOT SENT TO
  8293				;;;;;;;	MOVE	T2,SYSNUM##	;PUT THE SYSNUM IN THE MESSAGES JUST
  8294					MOVE	T2,DRMTIM	;USE UP TIME FOR NOW
  8295				;;;;;;;	ANDI	T2,377		;INCASE THE NODE WANTS IT IN THE FUTURE
  8296					ANDI	T2,1777		;SHOW 10 BITS FOR NOW
  8297					LSH	T2,8		; OFCOURSE WE CAN ONLY SEND 8 BITS OF IT
  8298					ANDCM	P3,[377,,-1]	;LEAVE ONLY MESSAGE TYPE IN BITS 2-9
  8299					IOR	T2,P3		;T2 HOLDS THE MESSAGE
  8300				MDRLUP:	SKIPN	P3,T1
  8301					 JRST	CPOPJ		;RETURN WHEN T1=0
  8302					ANDI	P3,3		;ISOLATE A DR NUMBER
  8303					JUMPE	P3,MDRL1	;IF IT'S 0 GO TRY THE NEXT ONE
  8304					SUBI	P3,1		;1-4 GOES TO 0-3
  8305					CAILE	P3,MAXDR	;P3 MUST BE .LE. PORTS/LINES PER DR
  8306					 JRST	MDRL1
  8307					LSH	P3,6		;MAKE IT A PORT NUMBER
  8308					IORI	P3,LPERDR&77	;P3/(DRNUM*100) ! LINES PER DR
  8309					CAILE	P3,<MAXDR*100>!<PORTN##-<MAXDR*LPERDR>>
  8310					 JRST	[ANDCMI P3,77
  8311						IORI	P3,PORTN##-<MAXDR*LPERDR>
  8312						JRST	.+1]
  8313					ANDCMI	P3,3		;MUST BE A MULTIPLE OF 4
  8314					HRL	P3,P3		;P3/MAX PORT NUM,,MAX PORT NUM
  8315					ANDCMI	P3,77		;P3/MAX PORT NUM,,DR NUM
  8316					HLRZ	T3,T2		;TEST FOR TYPHSI
  8317					CAIE	T3,TYPI TYPHSI	;TYPHSI USES MAX PORT,,DRNUM
  8318					 HRLZ	P3,P3		;TYPE A MESSAGES DON'T USE MAX PORT
  8319					IOR	P3,T2		;OR IN THE MESSAGE AND SYS NUMBER
  8320					PUSH	P,T1
  8321					PUSH	P,T2
  8322					PUSHJ	P,CLSCHR	;MAKE SURE THE RING IS READY
  8323					  JRST MDRRET		;IF NOT DO A NON-SKIP RETURN
  8324					PUSHJ	P,WRDOUT	;PUT THE MESSAGE IN THE RING
  8325					  JRST MDRRET		;THIS SHOULDN'T HAPPEN!
  8326					POP	P,T2
  8327					POP	P,T1
  8328					HLRZ	T3,T2		;TEST FOR TYPHSI
  8329					CAIE	T3,TYPI TYPHSI
  8330					 JRST	MDRL1		;IF NOT HSI THEN SKIP TO MDRL1
  8331					MOVE	T3,T1
  8332					ANDI	T3,3
  8333					SUBI	T3,1
  8334					SETOM	SENT41(T3)	;FLAG THAT WE SENT A 41 TO THAT DR
  8335				MDRL1:	LSH	T1,-3		;THROW OUT 3-BIT DR NUM JUST PROCESSED
  8336					JRST	MDRLUP		;GO DO THE NEXT ONE
  8337				MDRRET:	POP	P,T2
  8338					POP	P,T1
  8339					JRST	CPOPJ
  8340				
  8341				DR1BIT==1B35
  8342				DR2BIT==1B34
  8343				DR3BIT==1B31
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 191-6
SCNSER.MAC	25-NOV-87 19:52		GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1

  8344				DR4BIT==1B28
  8345				
  8346				MDRUP:	PUSHJ	P,KMCGUP##
  8347				DRFLAG: HRLZ	T1,T1		;MOVE FLAGS TO LEFT HALF
  8348					TLZE	T1,DR1BIT	;TEST AND CLEAR THE FIRST FLAG
  8349					 IORI	T1,0001		;IF A DRs FLAG IS SET PUT ONE PLUS IT'S
  8350					TLZE	T1,DR2BIT	;    NUMBER IN A 3-BIT OCTAL DIGIT SLOT
  8351					 IORI	T1,0020
  8352					TLZE	T1,DR3BIT
  8353					 IORI	T1,0300
  8354					TLZE	T1,DR4BIT
  8355					 IORI	T1,4000
  8356					HRRZ	T1,T1		;T1/ 0,,3-BIT DR NUMBERS FLAGGED
  8357					POPJ	P,		;RETURN
  8358				>;END IFKMC
  8359
  8360				;BASVER definitions: BYTE(8)TYPE,FLAGS,VERSION,RELEASE
  8361		000004	000000		BV.DBG==<BYTE(8)0,001,0,0>	;Debugging if lsb of 2nd byte
  8362		001000	000000		BV.HDN==<BYTE(8)0,200,0,0>	;EBUS says host was down (we went away)
  8363	012222'	200317	001544*	RCVRAK:	MOVE	T1,IRING(P4)	;TYPRAK=4 - Reset Acknowlege
  8364	012223'	202300	005575*		MOVEM	T1,BASVER##	;Store BYTE(8)CODE,DEBUG,VERSION,RELEASE
  8365	012224'	256000	016573'	BASEOK:: STOPCD (.+1,EVENT,BASEOK,PRTBVR,<Base is up>)
  8366	012225'	344740	000746'		AOJA	P4,SCNIN1
  8367
  8368				IFCPU (<KI,KL>),<
  8369	012226'	260040	005613*	PRTBVR:	PUSHJ	P,INLMES##	;Called from STOPCD(BASEOK)
  8370	012227'	417374	462500		 ASCIZ /Code in base is version /
	012230'	647344	061302
	012231'	717124	064746
	012232'	203554	571346
	012233'	647375	620000
  8371	012234'	135300	016577'		LDB	T1,[POINT 8,BASVER,23]
  8372	012235'	260040	000000*		PUSHJ	P,PRTDEC##
  8373	012236'	260040	000000*		PUSHJ	P,PRPER##	;Period
  8374	012237'	135300	016600'		LDB	T1,[POINT 8,BASVER,31]
  8375	012240'	260040	000000*		PUSHJ	P,PRT2##	;2 decimal digits
  8376				;	PUSHJ	P,INLMES##
  8377				;	 ASCIZ / - debug flag is /
  8378				;	MOVEI	T1,[ASCIZ /OFF/]
  8379				;	MOVSI	T2,(BV.DBG)
  8380				;	TDNE	T2,BASVER	;Is it set?
  8381				;	 MOVEI	T1,[ASCIZ /ON/]	;Yes
  8382				;	PUSHJ	P,CONMES##	;STOPCD processor will provide CRLF
  8383	012241'	263040	000000		POPJ	P,
  8384				>
  8385				IFNCPU(<KI,KL>),<PRTBVR==CPOPJ##> ;PDP-11 bases do not report version #
  8386
  8387				IFNKMC<				;TYPRES=3 - Reset interface
  8388	012242'	476000	005611*	RCVRES:	SETOM	BASDWN##	;Set flag to call DETALL and send TYPRAK
  8389	012243'	200317	012222*		MOVE	T1,IRING(P4)	;Get the message
  8390	012244'	250300	012223*		EXCH	T1,BASVER##	;Store BYTE(8)CODE,DEBUG,VERSION,RELEASE
  8391	012245'	312300	012244*		CAME	T1,BASVER##	;Don't mumble about 2 in a row
  8392	012246'	256000	012224'		 STOPCD	(,XCT,BASEOK)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 191-7
SCNSER.MAC	25-NOV-87 19:52		GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1

  8393					;Print "base is up" message
  8394	012247'	260040	012256'		PUSHJ	P,DETALL	;Detach all ports
  8395	012250'	135300	016154'		LDB	T1,[POINT 16,BASVER,31];Get 3rd and 4th bytes
  8396	012251'	303300	001000		CAILE	T1,<02_^D8>+00	;Is it version 02.00 ?
  8397	012252'	344740	000746'		 AOJA	P4,SCNIN1	;No, done
  8398	012253'	402000	001006*		SETZM	IRPPDP		;Yes, EBUS has set IRP620 to zero
  8399	012254'	402000	011251*		SETZM	ORPPDP		; and ORP620 to zero
  8400	012255'	263040	000000		POPJ	P,		;Return from SCNTIC - no more to do
  8401				>  ;End IFNKMC
  8402
  8403				IFKMC<		;Here when KMC detects problem with a DR11C
  8404				RCVRES:	SETZM	BASVER##	;Store BYTE(8)0,0,0,0 instead of EBUS version
  8405					MOVEI	T1,^D60
  8406					MOVEM	T1,TIMDRD	;RESET KMC CHECKUP TIMER
  8407					MOVE	T1,DRMTIM ;;;;;;;TEMP STUFF UP TIME IN IRING 3 MSG
  8408					DPB	T1,INPDL2 ;;;;;;;  "    "    "   "   "   "   "  "
  8409					LDB	U,INPLIN
  8410					ANDI	U,300		;U/FIRST PORT NUMBER OF FAILING DR
  8411					CAILE	U,PORTN##	;THIS TEST WORKS ONLY WHEN LPERDR=^D64
  8412					 AOJA	P4,SCNIN1	;IGNORE BAD PORT NUMBERS
  8413					MOVE	T1,U
  8414					LSH	T1,-6		;T1/DR NUMBER
  8415					SETZM	SENT41(T1)	;RESET "WAITING FOR RESPONSE TO 41"
  8416					PUSHJ	P,KMCCAC##	;CLEAR DR'S ACTIVE BIT & UP BIT
  8417				DRZAP:	PUSHJ	P,DETONE	;Detach one port on this particular DR11
  8418					ADDI	U,1
  8419					MOVE	T1,U
  8420					ANDI	T1,LPERDR-1	;ONE OF 77, 37, or 17
  8421					CAIG	U,PORTN##	;THIS TEST ONLY WORKS FOR LPERDR=64.
  8422					 JUMPN	T1,DRZAP	;GO DO THE NEXT PORT
  8423					AOJA	P4,SCNIN1	;EXIT
  8424				>;END IFKMC
  8425
  8426				;DETALL - Mark all lines as being detached
  8427
  8428	012256'	201240	006541*	DETALL:	MOVEI	U,RPORTN##	;Do all real ports (not PTY ports)
  8429	012257'	260040	012262'		PUSHJ	P,DETONE	;Detach one
  8430	012260'	367240	012257'		SOJG	U,.-1		;Loop for all
  8431	012261'	324740	014407'		PJRST	SETSHT		;Set UPSHUT to the right value
  8432
  8433				;DETONE - Mark one line as being detached, port number in U preserved
  8434
  8435	012262'	261040	000005	DETONE:	PUSH	P,U		;SAVE U
  8436	012263'	200245	007701*		MOVE	U,LINTAB(U)	;U/ PORT LDB
  8437	012264'	500245	000031		HLL	U,LDBDCH(U)	;U/DEVICE CHARARTERISTICS,,PORT LDB
  8438	012265'	331005	000026		SKIPL	LDBLOG(U)	;SKIP IF PORT NOT LOGGED IN
  8439	012266'	254000	012271'		 JRST	DETON1
  8440	012267'	260040	001515'		PUSHJ	P,FRCZAP	;ZAP THE PORT
  8441	012270'	260040	004403'		PUSHJ	P,CLRTTY	;CANCEL THE "SEND ZAPPER" FLAG
  8442	012271'	262040	000005	DETON1:	POP	P,U		;RESTORE PORT NUMBER
  8443	012272'	263040	000000		POPJ	P,
  8444
  8445	012273'			RCVANS:				;CALLED WHEN KMC/DR RESPONDS TO A 41 WE SENT IT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 191-8
SCNSER.MAC	25-NOV-87 19:52		GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1

  8446	012273'	344740	000746'	IFNKMC<	AOJA	P4,SCNIN1>	;IGNORE ANS MESSAGE ON KI/KL/F3
  8447				IFKMC<	MOVE	T1,DRMTIM ;;;;;;;TEMP PUT TIME IN IRING 1 MSG
  8448					DPB	T1,INPDL2 ;;;;;;;  "   "    "   "   "   "  "
  8449					LDB	T1,INPLIN	;T1/ PORT LDB
  8450					LSH	T1,-6		;T1/DR NUMBER
  8451					SKIPN	SENT41(T1)	;DON'T SET ANSWERED BIT UNLESS WE SENT 41
  8452					 AOJA	P4,SCNIN1
  8453					SETZM	SENT41(T1)	;RESET "WAITING FOR RESPONSE TO 41"
  8454					PUSH	P,T1
  8455					PUSHJ	P,KMCSUP##	;SET DR'S ANSWERED BIT
  8456					POP	P,T1
  8457					ANDI	T1,3
  8458					ADDI	T1,1
  8459					MOVE	T2,DRMCLP
  8460					LSH	T2,3
  8461					IOR	T2,T1
  8462					MOVEM	T2,DRMCLP
  8463					MOVEI	T2,STSHUT	;400000
  8464					TDNE	T2,STATES	;ARE WE SHUT?
  8465					 JRST	KMCSHT		;YES, GO SET UP DRMSHT
  8466					MOVE	T2,DRMANS	;NO, SET UP DRMANS INSTEAD
  8467					LSH	T2,3
  8468					IOR	T2,T1
  8469					MOVEM	T2,DRMANS
  8470					AOJA	P4,SCNIN1	;EXIT
  8471				KMCSHT:	MOVE	T2,DRMSHT
  8472					LSH	T2,3
  8473					IOR	T2,T1
  8474					MOVEM	T2,DRMSHT
  8475					AOJA	P4,SCNIN1
  8476				>;END IFKMC
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 192
SCNSER.MAC	25-NOV-87 19:52		IQUEUE - TAKES AN INPUT WAIT TRAP IF SET, OTHERWISE PLACES

  8477				SUBTTL	IQUEUE - TAKES AN INPUT WAIT TRAP IF SET, OTHERWISE PLACES
  8478				; THE JOB IN TTY INPUT WAIT.
  8479
  8480	012274'	135300	000224'	IQUEUE:	LDB T1,DDPTTI		;CHECK FOR TRAP WANTED.
  8481	012275'	260040	010647*		PUSHJ	P, TSTKTJ	;IF INPUT WAIT INTERRUPT WANTED
  8482	012276'	254000	010735*		 JRST ABTUUO		;YES, ABORT.
  8483	012277'	335002	000000*		SKIPGE	JBTAWQ(J)	;IF INTERRUPT PENDING
  8484	012300'	254000	012276*		 JRST ABTUUO		; ABORT
  8485	012301'	260040	013150'		PUSHJ P,TIWAIT		;NO.  QUEUE JOB FOR TIO WAIT.
  8486	012302'	324740	012311'		PJRST BIOATT
  8487
  8488				;OQUEUE - TAKES AN OUTPUT WAIT TRAP IF SET, OTHERWISE PLACES
  8489				; THE JOB IN TTY OUTPUT WAIT.
  8490
  8491	012303'	135300	000224'	OQUEUE:	LDB T1,DDPTTI		;CHECK FOR TRAP WANTED.
  8492	012304'	260040	012275*		PUSHJ P,TSTKTJ		;SEE IF INTERRUPT ON IOW
  8493	012305'	260040	015536'		 PUSHJ P,SETFIO		;NEEDS WAKUP LATER
  8494	012306'	335002	012277*		SKIPGE JBTAWQ(J)	;CHECK FOR TRAPS WAITING
  8495	012307'	254000	012300*		 JRST ABTUUO		;AND ABORT IF ANY.
  8496	012310'	260040	013166'		PUSHJ P,TOWAT1		;NO.  QUEUE JOB FOR TIO WAIT.
  8497
  8498				;HERE TO CHECK IF LINE FOR THIS PORT IS STILL ATTACHED.
  8499
  8500	012311'	332002	012306*	BIOATT:	SKIPE JBTAWQ(J)
  8501	012312'	254000	012307*		JRST ABTUUO
  8502	012313'	550244	000013		HRRZ U,DDBLDB(F)	;IS LINE STILL ATTACHED?
  8503	012314'	326240	012147*		JUMPN U,CPOPJ1		;YES.  HE WINS.
  8504	012315'	205300	020000		MOVSI T1,TTYATC		;IS THIS THE CONTROLLING TTY
  8505	012316'	616304	000004		TDNN T1,DEVMOD(F)	;OR AN AUXILIARY CIRCUIT?
  8506	012317'	254000	010732'		 JRST AUXRID		;AN AUXCIR ... HE LOSES.
  8507	012320'	263040	000000		POPJ P,			;CONTROLLING TTY: HE STILL LOSES
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 193
SCNSER.MAC	25-NOV-87 19:52		BLKXIN - TERMINATE BLOCK INPUT AUXCAL

  8508				SUBTTL	 BLKXIN - TERMINATE BLOCK INPUT AUXCAL
  8509
  8510	012321'	200305	000030	BLKXIN:	MOVE	T1,LDBMOD(U)
  8511	012322'	607300	001000		TLNN	T1,LMLBIO	; BLOCK I/O ENABLED?
  8512	012323'	263040	000000		 POPJ	P,
  8513	012324'	550305	000005		HRRZ	T1,LDBBIO(U)	; T1/ INPUT BUFFER ADDRESS
  8514	012325'	322300	012334'		JUMPE	T1,BLKXI1	; NO BUFFER
  8515	012326'	260040	012337'		PUSHJ	P,BLKTRQ	; REQUEST INPUT TERMINATION
  8516	012327'	550305	000005		HRRZ	T1,LDBBIO(U)
  8517	012330'	335006	000005		SKIPGE	BIOCHR(T1)	; CHECK IN-PROGRESS FLAG
  8518	012331'	263040	000000		 POPJ	P,		; IN-PROGRESS: DO NOTHING NOW
  8519	012332'	205000	000040		MOVSI	S,IOEND		; COMPLETE: SET IOEND
  8520	012333'	334000	000000		SKIPA
  8521	012334'	201000	020000	BLKXI1:	MOVEI	S,IODEND	; NO BUFFER: SET IO.EOF
  8522	012335'	437004	000002		IORB	S,DEVIOS(F)
  8523	012336'	263040	000000		POPJ	P,
  8524
  8525				; BLKTRQ - ROUTINE TO REQUEST BLOCK INPUT TERMINATION
  8526
  8527	012337'	205300	400000	BLKTRQ:	MOVSI	T1,LMLTBI
  8528	012340'	612305	000030		TDNE	T1,LDBMOD(U)	; TERMINATION PENDING?
  8529	012341'	263040	000000		 POPJ	P,		; YES: DO NOTHING
  8530	012342'	436305	000030		IORM	T1,LDBMOD(U)	; NO: SET THE FLAG
  8531	012343'	201300	000001		MOVEI	T1,1
  8532	012344'	137300	000060'		DPB	T1,LOPTRI	;    SET TERMINATE-INPUT
  8533	012345'	137305	000002		DPB	T1,LDBOPB(U)	;    AND NEED-OUTPUT
  8534	012346'	263040	000000		POPJ	P,
  8535
  8536				;BLKXOT - HERE TO TERMINATE BLOCK OUTPUT FOR A PORT IN BIO MODE
  8537
  8538	012347'	200305	000030	BLKXOT:	MOVE	T1,LDBMOD(U)
  8539	012350'	607300	001000		TLNN	T1,LMLBIO	;IF BLKIO NOT ENABLED,
  8540	012351'	263040	000000		 POPJ	P,		;  JUST RETURN
  8541	012352'	510305	000005		HLLZ	T1,LDBBIO(U)
  8542	012353'	322300	011665*		JUMPE	T1,CPOPJ	;IF NO BLK OUTPUT IN PROGRESS, RETURN
  8543	012354'	205300	400000		MOVSI	T1,LDLNOP
  8544	012355'	412305	000031		ANDCAM	T1,LDBDCH(U)	;IGNORE BACKPRESSURE
  8545	012356'	135300	000074'		LDB	T1,LOPBOT
  8546	012357'	361300	012362'		SOJL	T1,BLKXT1	;IF WE'RE ABOUT TO REQUEST BLK OUTPUT,
  8547	012360'	137300	000074'		DPB	T1,LOPBOT	;  FORGET IT (T1/ 0)
  8548	012361'	324740	001360'		PJRST	FRCOHR		;  BUT SIMULATE THE OUTPUT-COMPLETE
  8549								;ELSE
  8550	012362'	137300	000055'	BLKXT1:	DPB	T1,LOPTRO	;  SET TO SEND BLKO-TERMINATE (T1/ -1)
  8551	012363'	137305	000002		DPB	T1,LDBOPB(U)	;  AND NEED-OUTPUT
  8552	012364'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 194
SCNSER.MAC	25-NOV-87 19:52		INPUT AND OUTPUT SUBROUTINES

  8553				SUBTTL INPUT AND OUTPUT SUBROUTINES
  8554
  8555	012365'	260040	012514'	TYI:	PUSHJ	P,TYIEAT	;GET RID OF COMMAND LINE (CAN'T RESCAN ANYMORE)
  8556	012366'	375005	000012		SOSGE LDBTIC(U)	;ANY INPUT CHRS LEFT?
  8557					JRST	[SETZM LDBTIC(U)
  8558	012367'	254000	016601'			POPJ P,]	;NO, NON-SKIP RETURN
  8559	012370'	260040	013233'		PUSHJ P,BPFTYI		;RESET BACKPREASURE
  8560	012371'	200345	000011		MOVE T2,LDBTIT(U)
  8561	012372'	260040	006114'		PUSHJ P,TTGETC
  8562	012373'	260040	006163'		 PUSHJ P,FRECHK
  8563	012374'	202345	000011		MOVEM T2,LDBTIT(U)
  8564	012375'	336305	000006		SKIPN T1,LDBBKP(U)	;ANYTHING IN ^U POINTER
  8565	012376'	370005	000007		SOS LDBBKI(U)		;YES, 1 FEWER CHRS
  8566	012377'	316300	000007		CAMN T1,T2		;IS THIS THE POINTER NOW
  8567	012400'	402005	000006		SETZM LDBBKP(U)		;YES, NOTHING THERE NOW
  8568	012401'	602400	000400		TRNE T3,400
  8569	012402'	254000	012314*		JRST CPOPJ1		;IMAGE CHR
  8570	012403'	606400	000200		TRNN T3,200
  8571	012404'	334710	000305'		SKIPA P3,CHRTAB(T3)
  8572	012405'	200710	000105'		MOVE P3,CHRTAB-200(T3)	;GET INFORMATION BITS
  8573	012406'	135340	000300'		LDB T2,CHPRED	;GET READ CODE
  8574	012407'	256007	012412'	TYIRPT:	XCT TYIATB(T2)		;AND DO IT
  8575	012410'	275400	000040		SUBI T3,40		;HERE IN LOWER CASE, CONVERT TO UPPER
  8576	012411'	254000	012402*		JRST CPOPJ1		;DONE
  8577
  8578	000000			TYIATB:	PHASE 0
  8579	012412'	254000	012427'		JRST SPRTYI	;SPECIAL ACTION NEEDED
  8580	012413'	254000	012411*		JRST CPOPJ1	;NORMAL CHR
  8581	012414'	374005	000015	%CHBRK:! SOSA LDBBKC(U)	;BREAK, FLAGGED SO CALLERS KNOW
  8582	012415'	254000	012417'		JRST TYIC	;BREAK2
  8583	012416'	603240	000020		TLNE U,LDLLCT	;LOWER CASE, SHOULD WE CONVERT?
  8584	012417'				DEPHASE
  8585
  8586	012417'	603240	004000	TYIC:	TLNE U,LDLBK2	;IN BREAK2 MODE?
  8587	012420'	200340	000002		MOVE T2,%CHBRK	;YES, FLAG AS BREAK FOR CALLERS
  8588	012421'	350001	000000		AOS (P)
  8589	012422'	370005	000016	TYID:	SOS LDBBK2(U)
  8590	012423'	326300	012353*		JUMPN T1,CPOPJ	;DON'T WORRY IF NO ^U POINTER
  8591	012424'	205300	777777		MOVSI T1,-1
  8592	012425'	272305	000007		ADDM T1,LDBBKI(U)
  8593	012426'	263040	000000		POPJ P,
  8594
  8595	012427'	135340	000302'	SPRTYI:	LDB T2,CHPSPR	;GET ACTION CODE
  8596	012430'	135700	000161'		LDB P3,LDPMOD	;AND LINE MODE
  8597	012431'	256036	012432'		XCT @SPRTTB(P3)
  8598
  8599	012432'	256007	012436'	SPRTTB:	XCT TYIPDP(T2)
  8600	012433'	256007	012445'		XCT TYI940(T2)
  8601	012434'	256007	012445'		XCT TYI940(T2)
  8602	012435'	256007	012436'		XCT TYIPDP(T2)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 195
SCNSER.MAC	25-NOV-87 19:52		INPUT AND OUTPUT SUBROUTINES

  8603	012436'	254000	012502'	TYIPDP:	JRST TYICC	;^C
  8604	012437'	254000	012467'		JRST TYIALT	;33
  8605	012440'	254000	012457'		JRST TYIBRK	;^_
  8606	012441'	254000	012473'		JRST TYICZ	;^Z
  8607	012442'	254000	012465'		JRST TYIPAL	;175-176
  8608	012443'	254000	012454'		JRST TYITAB	;TAB
  8609	012444'	254000	012461'		JRST TYIBSP	;BACKSPACE
  8610
  8611	012445'	254000	012457'	TYI940:	JRST TYIBRK	;^C
  8612	012446'	254000	012502'		JRST TYICC	;33 POSSIBLE ESCAPE
  8613	012447'	254000	012502'		JRST TYICC	;^_
  8614	012450'	254000	012457'		JRST TYIBRK	;^Z
  8615	012451'	254000	012500'		JRST TYICCP	;175-176
  8616	012452'	254000	012454'		JRST TYITAB	;TAB
  8617	012453'	254000	012461'		JRST TYIBSP	;BACKSPACE
  8618
  8619	012454'	205340	100000	TYITAB:	MOVSI T2,L2LTBK
  8620	012455'	616345	000027		TDNN T2,LDBBYT(U)	;TREAT TAB AS BREAK?
  8621	012456'	254000	012417'		JRST TYIC	;NO AS BREAK2
  8622	012457'	201340	000002	TYIBRK:	MOVEI T2,%CHBRK	;YES, TREAT AS BREAK
  8623	012460'	254000	012407'		JRST TYIRPT
  8624
  8625	012461'	205340	040000	TYIBSP:	MOVSI T2,L2LBBP
  8626	012462'	612345	000027		TDNE T2,LDBBYT(U)	;TREAT BSP AS BREAK
  8627	012463'	254000	012417'		JRST TYIC	;NO, AS BREAK2
  8628	012464'	254000	012457'		JRST TYIBRK	;YES
  8629
  8630	012465'	607240	000020	TYIPAL:	TLNN U,LDLLCT	;IN TTY LC
  8631	012466'	254000	012457'		JRST TYIBRK	;YES, JUST A BREAK CHARACTER
  8632	012467'	201340	020000	TYIALT:	MOVEI T2,LDRFCS	;ALTMODE. IN FULL CHR SET MODE?
  8633	012470'	616345	000031		TDNN T2,LDBDCH(U)
  8634	012471'	201400	000033		MOVEI T3,STDALT	;NO, STANDARD
  8635	012472'	254000	012457'		JRST TYIBRK
  8636
  8637	012473'	550205	000000	TYICZ:	HRRZ F,LDBDDB(U)
  8638	012474'	322200	012457'		JUMPE F,TYIBRK	;NO DDB, JUST BREAK CHR
  8639	012475'	205440	000040		MOVSI T4,IOEND
  8640	012476'	436444	000002		IORM T4,DEVIOS(F)	;SET END OF FILE
  8641	012477'	254000	012457'		JRST TYIBRK
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 196
SCNSER.MAC	25-NOV-87 19:52		INPUT AND OUTPUT SUBROUTINES

  8642	012500'	607240	000020	TYICCP:	TLNN U,LDLLCT	;IN TTY LC
  8643	012501'	254000	012457'		JRST TYIBRK	;YES, TRAT AS BREAK
  8644	012502'	370005	000015	TYICC:	SOS LDBBKC(U)
  8645	012503'	200100	007752*		MOVE J,JOB	;ALSO FALL HERE FROM ABOVE
  8646	012504'	260040	015277'		PUSHJ P,ESCTR1	;TRY TRAPPING
  8647	012505'	260040	006027'		PUSHJ P,CNCCHK	;CHECK SPECAIL CONDITIONS
  8648					JRST [
  8649						LDB	P3, LDPMOD	; GET MONITOR MODE
  8650						MOVEI	T3, 3		; ^C FOR 10'S
  8651						CAIE	P3, 1		; GE MODE?
  8652						CAIN	P3, 2		; TYMEX MODE?
  8653						MOVEI	T3, 33		; ESC FOR 940'S
  8654						AOS	LDBBKC(U)	; SOS'D IN TYIBRK
  8655						JRST	TYIBRK		; PASS TO PROGRAM
  8656	012506'	254000	016603'		]
  8657	012507'	260040	013150'		PUSHJ P,TIWAIT	;HALT COMMAND ALREADY SET
  8658	012510'	260040	012727'		PUSHJ	P, CKATTI	;MAKE SURE IT'S STILL ATTACHED
  8659	012511'	254000	012312*		JRST	ABTUUO		;(S)HE WANTS AN INTERRUPT
  8660	012512'	326240	012365'		JUMPN	U, TYI		;TRY AGAIN (FOR CONTINUE)
  8661	012513'	256000	000000'		 STOPCD 		;HORRORS! NOT A COMMAND PORT!
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 197
SCNSER.MAC	25-NOV-87 19:52		GET RID OF COMMAND LINE

  8662				SUBTTL	GET RID OF COMMAND LINE
  8663
  8664	012514'	607240	100000	TYIEAT:	TLNN U,LDLECS	;ALREADY DONE THIS?
  8665	012515'	263040	000000		 POPJ P,		;YES
  8666	012516'	261040	000010		PUSH P,T3
  8667	012517'	261040	000016		PUSH P,P3	;ALSO SAVE THIS (TTYSTR AND FRIENDS)
  8668	012520'	375005	000012	TYIL:	SOSGE LDBTIC(U)
  8669					JRST [SETZM LDBTIC(U)
  8670	012521'	254000	016612'			JRST TYIET2]
  8671	012522'	200345	000011		MOVE T2,LDBTIT(U)
  8672	012523'	260040	006114'		PUSHJ P,TTGETC
  8673	012524'	260040	006163'		 PUSHJ P,FRECHK
  8674	012525'	202345	000011		MOVEM T2,LDBTIT(U)
  8675	012526'	336305	000006		SKIPN T1,LDBBKP(U)
  8676	012527'	370005	000007		SOS LDBBKI(U)	;SAME AS IN TYI
  8677	012530'	316300	000007		CAMN T1,T2
  8678	012531'	402005	000006		SETZM LDBBKP(U)
  8679	012532'	602400	000400		TRNE T3,400
  8680	012533'	254000	012520'		JRST TYIL	;IMAGE, TRY NEXT
  8681	012534'	606400	000200		TRNN T3,200
  8682	012535'	334710	000305'		SKIPA P3,CHRTAB(T3)
  8683	012536'	200710	000105'		MOVE P3,CHRTAB-200(T3)
  8684	012537'	135340	000300'		LDB T2,CHPRED
  8685	012540'	256007	012542'		XCT EATTAB(T2)
  8686	012541'	254000	012520'		JRST TYIL	;TRY NEXT
  8687
  8688	012542'	254000	012547'	EATTAB:	JRST SPREAT	;SPECIAL ACTION
  8689	012543'	254000	012520'		JRST TYIL	;NOMAL CHR
  8690	012544'	254000	012564'		JRST TYIET3	;BREAK CHR, FINISHED
  8691	012545'	260040	012422'		PUSHJ P,TYID	;BREAK2
  8692	012546'	254000	012520'		JRST TYIL	;LOWER CASE, JUST LIKE NORMAL
  8693
  8694	012547'	135340	000302'	SPREAT:	LDB T2,CHPSPR
  8695	012550'	256007	012555'		XCT SPRETB(T2)	;SAME IN ALL MODES
  8696					XCT -5+[TDNE T3,LDBBYT(U)	;FROM TAB
  8697	012551'	256007	016607'		        TDNN T3,LDBBYT(U)](T2)	;FROM BACKSPACE
  8698	012552'	254000	012564'		JRST TYIET3	;TREAT AS BREAK
  8699	012553'	260040	012422'		PUSHJ P,TYID	;TREAT AS BREAK2
  8700	012554'	254000	012520'		JRST TYIL
  8701
  8702	012555'	254000	012564'	SPRETB:	JRST TYIET3	;^C
  8703	012556'	254000	012564'		JRST TYIET3	;33
  8704	012557'	254000	012564'		JRST TYIET3	;^_
  8705	012560'	254000	012564'		JRST TYIET3	;^Z
  8706	012561'	254000	012564'		JRST TYIET3	;175-176
  8707	012562'	205400	100000		MOVSI T3,L2LTBK	;TAB, CHECK BREAK OR BREAK2
  8708	012563'	205400	040000		MOVSI T3,L2LBBP	;BACKSPACE, CHECK BREAK OR BREAK2
  8709
  8710	012564'	370005	000015	TYIET3:	SOS LDBBKC(U)	;A BREAK CHR FINISHED
  8711	012565'	205300	100000	TYIET2:	MOVSI T1,LDLECS	;FINISHED BECAUSE OUT OF CHRS
  8712	012566'	412305	000031		ANDCAM T1,LDBDCH(U)	;TURN OFF FLAG IN ANY CASE
  8713	012567'	262040	000016		POP P,P3
  8714	012570'	262040	000010		POP P,T3
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 197-2
SCNSER.MAC	25-NOV-87 19:52		GET RID OF COMMAND LINE

  8715	012571'	500245	000031		HLL U,LDBDCH(U)
  8716	012572'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 198
SCNSER.MAC	25-NOV-87 19:52		TYO, CMDTYO - Put characters in TTY output buffer

  8717				SUBTTL	TYO, CMDTYO - Put characters in TTY output buffer
  8718				COMMENT %
  8719				@@SUBROUTINE TYO, CMDTYO
  8720				@@PURPOSE TYO -- CHECK FOR SPACE, PLACE CHAR IN OUTPUT BUFFER
  8721					  CMDTYO -- ASSUME SPACE, PLACE CHAR IN OUTPUT BUFFER
  8722				@@ENTRY	T3/ CHAR, F/ DDB ADDR, U/ (NONZERO) LDB ADDR
  8723				@@ACCUM	T1-T2 DESTROYED
  8724				@@EXIT	ON A SKIP-RETURN, THE CHARACTER HAS BEEN DEPOSITED.
  8725				THE NONSKIP-RETURN IS NOT ACTUALLY A RETURN BUT RATHER A
  8726				PUSHJ TO ITS CALLER. IT IS TAKEN WHEN THERE IS NO ROOM FOR
  8727				THE CHARACTER AND THE JOB WANTS A TRAP. THE CALLER HAS
  8728				THREE CHOICES:
  8729					1) ABORT THE UUO, GIVING THE JOB ITS TRAP
  8730					2) MAKING ROOM FOR THE CHARACTER, THEN POPJ-ING,
  8731					   CAUSING TYO TO RETRY THE DEPOSIT
  8732					3) AOS (P) / POPJ -ING, CAUSING TYO TO GO INTO
  8733					   OUTPUT WAIT
  8734				%
  8735
  8736	012573'	200300	015712'	TYO:	MOVE	T1,TTFREN	;T1/ # FREE CHUNKS
  8737	012574'	301300	000003		CAIL	T1,TIRSVD	;IF #FREE .lt. #SAVED,
  8738	012575'	254000	012601'		 JRST	TYO1
  8739	012576'	205300	200000		MOVSI	T1,TWTSPC
  8740	012577'	436304	000002		IORM	T1,DEVIOS(F)	;  MARK NO-CHUNKS WAIT
  8741	012600'	254000	012640'		JRST	TYOW2		;  AND GO WAIT
  8742
  8743	012601'	200305	000021	TYO1:	MOVE	T1,LDBTOC(U)	;T1/ # CHARS LEFT TO OUTPUT
  8744	012602'	335005	000032		SKIPGE	LDBDCX(U)	;IF IT'S FAST
  8745	012603'	311300	016023'		CAML	T1,OMX120	;AND UNDER THE FAST MAXIMUM,
  8746	012604'	315300	016021'		CAMGE	T1,OMX30	;OR IF IT'S UNDER THE SLOW MAXIMUM,
  8747	012605'	254000	012611'		 JRST	TYO2		;  CONTINUE OUTPUT.
  8748	012606'	335005	000027		SKIPGE	LDBBYT(U)	;IF IT'S NOT EXTENDED-MODE
  8749	012607'	311300	016025'		CAML	T1,TOEMAX	;OR IT'S OVER THAT LIMIT,
  8750	012610'	254000	012627'		 JRST	TYOW		;  GO TRAP OR WAIT
  8751	012611'	350001	000000	TYO2:	AOS	(P)		;PREPARE FOR SKIP-RETURN
  8752	012612'	500245	000031		HLL	U,LDBDCH(U)
  8753	012613'	603240	000400		TLNE	U,LDLOSU	;IF SUPPRESSING OUTPUT,
  8754	012614'	263040	000000		 POPJ	P,		;  JUST (SKIP-)RETURN
  8755
  8756				;CMDTYO - put character in output chunk.  Caller must check for room
  8757
  8758	012615'	332345	000017	CMDTYO:	SKIPE	T2,LDBTOP(U)	;IF NO CHUNK ALLOCATED,
  8759	012616'	254000	012623'		 JRST	TYO3
  8760	012617'	260040	006173'		PUSHJ	P,GETCHK	;  T2/ CHUNK BYTE POINTER
  8761	012620'	202345	000017		MOVEM	T2,LDBTOP(U)	;  SET OUTPUT PUTTER
  8762	012621'	202345	000020		MOVEM	T2,LDBTOT(U)	;  SET OUTPUT TAKER
  8763	012622'	402005	000021		SETZM	LDBTOC(U)	;  SET OUTPUT COUNT
  8764	012623'	260040	006135'	TYO3:	PUSHJ	P,TTPUTC	;STORE CHAR.; T2 := NEW PUTTER
  8765	012624'	202345	000017		MOVEM	T2,LDBTOP(U)	;STORE NEW PUTTER
  8766	012625'	350005	000021		AOS	LDBTOC(U)	;UPDATE COUNT
  8767	012626'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 199
SCNSER.MAC	25-NOV-87 19:52		TYO, CMDTYO - Put characters in TTY output buffer

  8768	012627'	135300	000224'	TYOW:	LDB	T1,DDPTTI	;T1/ IOW TRAP CHANNEL
  8769	012630'	260040	012304*		PUSHJ	P,TSTKTJ	;SETUP TRAP IF ENABLED. IF IT WAS,
  8770	012631'	260040	015536'		  PUSHJ	P,SETFIO	;  MARK DDB FOR OUTPUT-DONE TRAP
  8771	012632'	135300	011415*		LDB	T1,PJOBN
  8772	012633'	331002	012311*		SKIPL	JBTAWQ(J)	;IF AWAITING A TRAP,
  8773	012634'	254000	012637'		 JRST	TYOW1
  8774	012635'	260061	000000		PUSHJ	P,@(P)		;  RETURN TO CALLER AS COROUTINE
  8775	012636'	254000	012573'		JRST	TYO		;  (NONSKIP FROM RECALLED CALLER)
  8776
  8777	012637'	322240	012643'	TYOW1:	JUMPE	U,TYOW3		;IF ATTACHED,
  8778	012640'	201300	000001	TYOW2:	MOVEI	T1,1
  8779	012641'	137300	000073'		DPB	T1,LOPOUT	;  SET CHARACTER-OUTPUT
  8780	012642'	137305	000002		DPB	T1,LDBOPB(U)	;  AND NEED-OUTPUT
  8781	012643'	260040	013166'	TYOW3:	PUSHJ	P,TOWAT1	;GO INTO OUTPUT WAIT
  8782	012644'	550244	000013	TYOW4:	HRRZ	U,DDBLDB(F)
  8783	012645'	326240	012573'		JUMPN	U,TYO		;IF STILL ATTACHED, TRY AGAIN
  8784	012646'	205300	020000		MOVSI	T1,TTYATC
  8785	012647'	616304	000004		TDNN	T1,DEVMOD(F)	;IF IT'S NOT THE COMMAND PORT,
  8786	012650'	324740	010732'		PJRST	AUXRID		;  DISCARD DDB AND ABORT UUO
  8787	012651'	254000	012627'		JRST	TYOW		;OTHERWISE, WAIT FOR ATTACH
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 200
SCNSER.MAC	25-NOV-87 19:52		MAKE SURE TTY IS ATTACHED, NO CHANCE FOR INTERRUPT

  8788				SUBTTL	MAKE SURE TTY IS ATTACHED, NO CHANCE FOR INTERRUPT
  8789
  8790	012652'	200004	000002	CKATTF:	MOVE	S,DEVIOS(F)
  8791	012653'	550244	000013		HRRZ	U,DDBLDB(F)
  8792	012654'	326240	013004'		JUMPN	U,UUOLDB
  8793	012655'	205300	020000		MOVSI	T1,TTYATC
  8794	012656'	616304	000004		TDNN	T1,DEVMOD(F)
  8795	012657'	254000	010732'		 JRST	AUXRID		;CAN GET RID OF DDB FOR AUX CIRCUIT
  8796	012660'	260040	014040'		PUSHJ	P,TOWATA
  8797	012661'	254000	012652'		JRST	CKATTF		;TRY AGAIN
  8798
  8799				;CHECK TO SEE THAT THERE IS ROOM FOR AT LEAST ONE CHARACTER TO BE OUTPUT
  8800
  8801	012662'	554305	000005	CHKROM:	HLRZ	T1,LDBBIO(U)	;BLOCK OUTPUT NOW IN PROGRESS?
  8802	012663'	326300	012674'		JUMPN	T1,CHKRM1	;YES. QUEUE JOB FOR OUTPUT WAIT.
  8803	012664'	200300	015712'		MOVE	T1,TTFREN
  8804	012665'	305300	000003		CAIGE	T1,TIRSVD	;IS THERE BUFFER SPACE?
  8805	012666'	254000	012705'		 JRST	CHKRM3
  8806	012667'	200305	000021		MOVE	T1,LDBTOC(U)	;NUMBER NOW IN OUTPUT BUFFER
  8807	012670'	335005	000032		SKIPGE	LDBDCX(U)	;IF IT'S FAST
  8808	012671'	311300	016023'		CAML	T1,OMX120	;AND UNDER THE FAST MAXIMUM,
  8809	012672'	315300	016021'		 CAMGE	T1,OMX30	;OR IF IT'S UNDER THE SLOW MAXIMUM,
  8810	012673'	254000	012413*		  JRST	CPOPJ1		;  SAY THERE'S ROOM
  8811	012674'	135100	012632*	CHKRM1:	LDB	J,PJOBN
  8812	012675'	335002	012633*		SKIPGE	JBTAWQ(J)	;ABORT UUO IF TRAP IS PENDING
  8813	012676'	254000	012511*		 JRST	ABTUUO
  8814	012677'	135300	000224'		LDB	T1,DDPTTI
  8815	012700'	260040	000000*		PUSHJ	P,TSTKTP	;SEE IF WE CAN TAKE AN INTERRUPT
  8816	012701'	334000	000000		  SKIPA			;YES, MUST MAKE SURE WE SET OUTPUT ROOM FLAG
  8817	012702'	254000	013166'		JRST	TOWAT1		;QUEUE JOB FOR OUTPUT WAIT.
  8818
  8819	012703'	260040	015536'	CHKRM2:	PUSHJ	P,SETFIO
  8820	012704'	254000	012676*		JRST	ABTUUO		;NOW GET OUT OF UUO
  8821
  8822				;HERE WHEN THERE'RE NO BUFFERLETS AVAILABLE FOR THE OUTPUT
  8823
  8824	012705'	135300	000224'	CHKRM3:	LDB	T1,DDPTTI
  8825	012706'	260040	012630*		PUSHJ	P,TSTKTJ	;DOES HE GET AN I/O WAIT TRAP?
  8826	012707'	254000	012703'		  JRST	CHKRM2		;YES: DO IT
  8827	012710'	205300	200000		MOVSI	T1,TWTSPC
  8828	012711'	436304	000002		IORM	T1,DEVIOS(F)	;NO: MARK REASON FOR WAIT
  8829	012712'	324740	013166'		PJRST	TOWAT1		;    AND DO IT
  8830
  8831
  8832				; CALL TO SEE IF ROOM FOR A CHARACTER
  8833				; U/LDB
  8834				; PUSHJ P,IFROOM
  8835				;  <NO ROOM>
  8836				; <ROOM>
  8837
  8838	012713'	200300	015712'	IFROOM:	MOVE	T1,TTFREN	;Number of buffer chunks
  8839	012714'	305300	000003		CAIGE	T1,TIRSVD	;Is there buffer space?
  8840	012715'	263040	000000		 POPJ	P,		;No, last 3 chunks reserved for emergencies
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 200-2
SCNSER.MAC	25-NOV-87 19:52		MAKE SURE TTY IS ATTACHED, NO CHANCE FOR INTERRUPT

  8841	012716'	550300	000005		HRRZ	T1,U		;Get LDB address
  8842	012717'	306300	000103'		CAIN	T1,CTYLDB	;Sending to the CTY?
  8843					 JRST	[MOVE	T1,TTFREN
  8844						 CAIL	T1,TIRSVD+5
  8845						  AOS	(P)	;CTY can use all but the last 10 chunks
  8846	012720'	254000	016616'			 POPJ	P,]	
  8847	012721'	200305	000021		MOVE	T1,LDBTOC(U)	;Number of characters currently in buffer
  8848	012722'	335005	000032		SKIPGE	LDBDCX(U)	;If it's fast
  8849	012723'	311300	016023'		CAML	T1,OMX120	; and under the fast maximum,
  8850	012724'	315300	016021'		 CAMGE	T1,OMX30	; or if it's under the slow maximum,
  8851	012725'	350001	000000		  AOS	(P)		;  say there's room
  8852	012726'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 201
SCNSER.MAC	25-NOV-87 19:52		SUBROUTINES TO SET UP LINE AND MAKE SURE ATTACHED.

  8853				SUBTTL	SUBROUTINES TO SET UP LINE AND MAKE SURE ATTACHED.
  8854				;CALL WITH F SET UP, FROM M LEVEL ONLY.
  8855				;RETURN WHEN ATTACHED AND AT USER LEVEL, WITH U SET UP.
  8856
  8857				;ONE ROUTINE FOR INPUT, ONE FOR OUTPUT.
  8858
  8859	012727'	200004	000002	CKATTI:	MOVE	S,DEVIOS(F)	;SET UP STATUS WORD
  8860	012730'	550244	000013		HRRZ	U,DDBLDB(F)	;GET LINE BLOCK ADDR
  8861	012731'	326240	012735'		JUMPN	U,CKATI2	;IF THERE, GO ON
  8862	012732'	205300	020000		MOVSI	T1,TTYATC
  8863	012733'	616304	000004		TDNN	T1,DEVMOD(F)
  8864	012734'	254000	012673*		 JRST	CPOPJ1		;AUX CIRCUIT, SPECIAL
  8865	012735'	135300	012674*	CKATI2:	LDB	T1,PJOBN	;NOW CHECK IF JOB WAITING FOR
  8866	012736'	335006	012675*		SKIPGE	JBTAWQ(T1)	;AN INTERRUPT
  8867	012737'	263040	000000		 POPJ	P,		;YES
  8868	012740'	326240	012754'		JUMPN	U,CKATI1
  8869	012741'	332000	016102'	CKATIW:	SKIPE	SKPFLG		;DON'T WAIT FOR ATTACH IF INC AND SKP AUXCAL
  8870	012742'	263040	000000		 POPJ	P,
  8871	012743'	135300	000224'		LDB	T1,DDPTTI
  8872	012744'	260040	012706*		PUSHJ	P,TSTKTJ	;IS THIS AN IOW INTERRUPT
  8873	012745'	263040	000000		 POPJ P,		;YES
  8874	012746'	205000	400020		MOVSI	S,IO+TTYOUW	;MUST WAIT FOR ATTACH
  8875	012747'	412004	000002		ANDCAM	S,DEVIOS(F)	;CLEAR DIRECTION BIT
  8876	012750'	201000	010000		MOVEI	S,IOACT		;AND SET WAIT BIT FOR INPUT
  8877	012751'	437004	000002		IORB	S,DEVIOS(F)	; ..
  8878	012752'	260040	013170'		PUSHJ	P,WSYNCS	;WAIT FOR ATTACH
  8879	012753'	254000	012727'		JRST	CKATTI		;GET U SET UP AND RETURN.
  8880
  8881	012754'	500245	000031	CKATI1:	HLL	U,LDBDCH(U)		;GET DEVICE BITS
  8882	012755'	603240	020000		TLNE	U,LDLCOM		;AT COMMAND LEVEL?
  8883	012756'	254000	012741'		 JRST	CKATIW			;YES. CAN'T1 DO INPUT.
  8884	012757'	260040	012514'		PUSHJ	P,TYIEAT		;NO. SKIP ANY COMMANDS
  8885	012760'	350001	000000		AOS	(P)
  8886	012761'	324740	013004'		PJRST	UUOLDB			;AND GO ADJUST LINE BITS.
  8887
  8888	012762'	200004	000002	CKATTO:	MOVE	S,DEVIOS(F)		;SET UP STATUS WORD
  8889	012763'	550244	000013		HRRZ	U,DDBLDB(F)		;GET LINE ADDR IF ANY
  8890	012764'	326240	012770'		JUMPN	U,CKATO2		;IF HAVE ONE, SEE IF TOP LEVEL
  8891	012765'	205300	020000		MOVSI	T1,TTYATC
  8892	012766'	616304	000004		TDNN	T1,DEVMOD(F)
  8893	012767'	254000	012734*		 JRST	CPOPJ1
  8894	012770'	135300	012735*	CKATO2:	LDB	T1,PJOBN
  8895	012771'	335006	012736*		SKIPGE	JBTAWQ(T1)
  8896	012772'	263040	000000		 POPJ	P,			;WAITING FOR INTERRUPT
  8897	012773'	326240	013001'		JUMPN	U,CKATO1
  8898	012774'	135300	000224'		LDB	T1,DDPTTI
  8899	012775'	260040	012744*		PUSHJ	P,TSTKTJ
  8900	012776'	324740	015536'		  PJRST	SETFIO			; INTERRUPT ON IOW
  8901	012777'	260040	014040'		PUSHJ	P,TOWATA		;WAIT FOR OUTPUT DONE. (WHICH
  8902									; IS FORCED ON ATTACH)
  8903	013000'	254000	012762'		JRST	CKATTO			;AND SET UP U, TO RETURN.
  8904	013001'	350001	000000	CKATO1:	AOS	(P)
  8905	013002'	205300	400000		MOVSI	T1,L2LOEX
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 201-2
SCNSER.MAC	25-NOV-87 19:52		SUBROUTINES TO SET UP LINE AND MAKE SURE ATTACHED.

  8906	013003'	412305	000027		ANDCAM	T1,LDBBYT(U)		;TURN OFF EXTENDED OUTPUT
  8907					PFALL	UUOLDB			;FALL INTO UUOLDB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 202
SCNSER.MAC	25-NOV-87 19:52		UUOLDB - MAKE LDB (ADDR IN U) AGREE WITH FILE STATUS BITS (IN S)

  8908				SUBTTL	UUOLDB - MAKE LDB (ADDR IN U) AGREE WITH FILE STATUS BITS (IN S)
  8909
  8910	013004'	322240	012423*	UUOLDB:	JUMPE	U,CPOPJ		;JUST IN CASE
  8911	013005'	500245	000031		HLL	U,LDBDCH(U)	;MAKE SURE LEFT HALF SET
  8912	013006'	603240	000040		TLNE	U,LDLAUX
  8913	013007'	263040	000000		 POPJ	P,		;DO NOTHING FOR AN AUX CIRCUIT
  8914
  8915				    ;SET MONITOR MODE BITS
  8916
  8917	013010'	261040	000002		PUSH	P,J
  8918	013011'	135100	012770*		LDB	J,PJOBN
  8919	013012'	135440	000000*		LDB	T4,PVYMOD
  8920	013013'	137440	000161'		DPB	T4,LDPMOD
  8921	013014'	262040	000002		POP	P,J		;SET MODE
  8922
  8923				    ;SET LDBDCX BITS
  8924
  8925	013015'	200305	000032		MOVE	T1,LDBDCX(U)
  8926	013016'	602000	000400		TRNE	S,DLRSUP
  8927	013017'	665300	020000		TLOA	T1,LXLDLR	;SUPPRESS-$
  8928	013020'	621300	020000		 TLZ	T1,LXLDLR	;DON'T SUPPRESS $
  8929	013021'	202305	000032		MOVEM	T1,LDBDCX(U)
  8930
  8931				    ;GET LDB BITS FROM FILE STATUS BITS
  8932
  8933	013022'	400300	000000		SETZ	T1,
  8934	013023'	602000	000100		TRNE	S,FCS
  8935	013024'	660300	020000		 TRO	T1,LDRFCS
  8936	013025'	602000	000200		TRNE	S,NOECHO
  8937	013026'	661300	000100		 TLO	T1,LDLNEC
  8938	013027'	603000	100000		TLNE	S,IOSBKA
  8939	013030'	661300	010000		 TLO	T1,LDLBKA
  8940	013031'	602000	001000		TRNE	S,BK2IOS
  8941	013032'	661300	004000		 TLO	T1,LDLBK2
  8942
  8943				    ;SET THE LDBDCH BITS
  8944
  8945	013033'	200440	000006		MOVE	T4,T1
  8946	013034'	430445	000031		XOR	T4,LDBDCH(U)	;T4/ THE BITS THAT CHANGED
  8947	013035'	436305	000031		IORM	T1,LDBDCH(U)
  8948	013036'	650300	016622'		TDC	T1,[LDLNEC!LDLBKA!LDLBK2,,LDRFCS]
  8949	013037'	413305	000031		ANDCAB	T1,LDBDCH(U)
  8950	013040'	500240	000006		HLL	U,T1		;UPDATE LH(U)
  8951
  8952				    ;FINISH UP
  8953
  8954	013041'	200004	000002		MOVE	S,DEVIOS(F)	;UPDATE S
  8955	013042'	603440	000100		TLNE	T4,LDLNEC	;IF WE'RE CHANGING ECHO MODE
  8956	013043'	602300	040000		TRNE	T1,LDRDEM	;AND LDRDEM NOT SET,
  8957	013044'	324740	007534'		 PJRST	SETLMD
  8958	013045'	201300	000001		MOVEI	T1,1		;  SET TO CHANGE ECHO MODE
  8959	013046'	137300	000065'		DPB	T1,LOPSEC
  8960	013047'	137305	000002		DPB	T1,LDBOPB(U)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 202-2
SCNSER.MAC	25-NOV-87 19:52		UUOLDB - MAKE LDB (ADDR IN U) AGREE WITH FILE STATUS BITS (IN S)

  8961	013050'	324740	007534'		PJRST	SETLMD		;AND GO SET LINE MODE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 203
SCNSER.MAC	25-NOV-87 19:52		UUOLDB - MAKE LDB (ADDR IN U) AGREE WITH FILE STATUS BITS (IN S)

  8962	013051'	205000	100000	TWAITL:	MOVSI S,IOSBKA
  8963	013052'	413004	000002		ANDCAB S,DEVIOS(F)
  8964	013053'	205300	010000		MOVSI T1,LDLBKA
  8965	013054'	412305	000031		ANDCAM T1,LDBDCH(U)	;SET FOR LINE MODE INPUT
  8966	013055'	260040	007534'		PUSHJ P,SETLMD
  8967	013056'	200305	000012		MOVE T1,LDBTIC(U)
  8968	013057'	500245	000031		HLL U,LDBDCH(U)	;MAKE SURE LINE IS OK
  8969	013060'	200445	000015		MOVE T4,LDBBKC(U)	;GET BREAK COUNT
  8970	013061'	603240	004000		TLNE U,LDLBK2	;IF IN BREAK2 MODE
  8971	013062'	270445	000016		 ADD T4,LDBBK2(U)	;NUMBER IS SUM
  8972	013063'	305300	000110		CAIGE T1,TIWKC
  8973	013064'	602440	777777		TRNE T4,-1		;IF A BREAK OR ENOUGH CHRS
  8974	013065'	263040	000000		 POPJ P,			;GO NOW
  8975	013066'	607240	002000		TLNN U,LDLIMI	;IN IMAGE MODE?
  8976	013067'	254000	013076'		 JRST TWTL1		;NO, MUST WAIT
  8977	013070'	336005	000012		SKIPN LDBTIC(U)	;YES, ANY CHRS?
  8978	013071'	603000	000040		TLNE S,IOEND		;OR END OF FILE SET
  8979	013072'	263040	000000		 POPJ P,			;IF END FLAGGED, THEN DONE
  8980	013073'	332005	000014		SKIPE LDBECC(U)	;ARE THERE ANY CHRS THERE AT ALL?
  8981	013074'	254000	013105'		 JRST TWTL2	;YES, I/O WAIT BUT NO TRAP
  8982	013075'	254000	013102'		JRST TWTL3	;NO, I/O WAIT WITH POSSIBLE TRAP
  8983	013076'	326440	013105'	TWTL1:	JUMPN T4,TWTL2	;IF UNECHOED BREAK CHRS, I/O WAIT NO TRAP
  8984	013077'	270305	000014		ADD T1,LDBECC(U)
  8985	013100'	301300	000110		CAIL T1,TIWKC	;OR POSSIBLEY TOO MANY TOTAL
  8986	013101'	254000	013105'		 JRST TWTL2	;I/O WAIT NO TRAP
  8987	013102'	135300	000224'	TWTL3:	LDB T1,DDPTTI	;CHECK FOR TRAP WANTED
  8988	013103'	260040	012775*		PUSHJ P,TSTKTJ		;SEE IF INTERRUPT ON IOW
  8989	013104'	254000	012704*		 JRST ABTUUO		;YES, ABORT
  8990	013105'	260040	013150'	TWTL2:	PUSHJ P,TIWAIT
  8991	013106'	260040	012727'		PUSHJ P,CKATTI
  8992	013107'	254000	013104*		 JRST ABTUUO
  8993	013110'	326240	013051'		JUMPN U,TWAITL
  8994	013111'	254000	010732'		JRST AUXRID	;ZAPPED AUX CIRCUIT
  8995
  8996	013112'			TWAITS:	;AOS	SKPFLG	;CALLED BY AN INPUT AND SKIP AUXCAL
  8997	013112'	255000	000000		JFCL		;FOR NOW UNTIL CAN FIND OUT WHY SKPFLG STAYS SET
  8998							;WHEN SHOULDN'T
  8999	013113'	350001	000000		AOS	(P)	;SET TO SKIP RETURN
  9000	013114'	205000	100000	TWAITC:	MOVSI S,IOSBKA
  9001	013115'	437004	000002		IORB S,DEVIOS(F)
  9002	013116'	205300	010000		MOVSI T1,LDLBKA
  9003	013117'	436305	000031		IORM T1,LDBDCH(U)
  9004	013120'	260040	007534'		PUSHJ P,SETLMD
  9005	013121'	500245	000031		HLL U,LDBDCH(U)	;MAKE SURE LINE OK FOR CALLERS
  9006	013122'	333005	000012		SKIPLE LDBTIC(U)	;ANY CHARACTERS PRESENT?
  9007	013123'	263040	000000		POPJ P,
  9008	013124'	332005	000014		SKIPE LDBECC(U)
  9009	013125'	254000	013131'		JRST TWTC1	;SOME CHRS SO NO I/O TRAP
  9010	013126'	135300	000224'		LDB T1,DDPTTI
  9011	013127'	260040	013103*		PUSHJ P,TSTKTJ		;CHECK IOW WAIT INTERRUPT
  9012	013130'	254000	013146'		 JRST 	TWABT		;GET OUT
  9013	013131'	260040	013150'	TWTC1:	PUSHJ P,TIWAIT
  9014	013132'	260040	012727'		PUSHJ P,CKATTI
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 203-2
SCNSER.MAC	25-NOV-87 19:52		UUOLDB - MAKE LDB (ADDR IN U) AGREE WITH FILE STATUS BITS (IN S)

  9015	013133'	254000	013146'		 JRST 	TWABT	;WAITING FOR INTERRUPT
  9016	013134'	200300	016102'		MOVE	T1,SKPFLG
  9017	013135'	402000	016102'		SETZM	SKPFLG
  9018	013136'	326240	013144'		JUMPN	U,TWTC2		;JUMP IF LINE ATTACHED
  9019	013137'	205300	020000		MOVSI	T1,TTYATC
  9020	013140'	616304	000004		TDNN	T1,DEVMOD(F)
  9021	013141'	254000	010732'		JRST	AUXRID		;ZAPPED AUX CIRCUIT
  9022	013142'	370001	000000		SOS	(P)		;ZAPPED CMD PORT FROM INC AND SKP AUXCAL
  9023	013143'	263040	000000		POPJ	P,
  9024	013144'	325300	013114'	TWTC2:	JUMPGE	T1,TWAITC	;GET ENOUGH INPUT CHARS?
  9025	013145'	263040	000000		POPJ	P,		;NO
  9026
  9027	013146'	402000	016102'	TWABT:	SETZM	SKPFLG
  9028	013147'	254000	013107*		JRST	ABTUUO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 204
SCNSER.MAC	25-NOV-87 19:52		UUOLDB - MAKE LDB (ADDR IN U) AGREE WITH FILE STATUS BITS (IN S)

  9029	013150'	205000	400020	TIWAIT:	MOVSI S,IO!TTYOUW
  9030	013151'	412004	000002		ANDCAM S,DEVIOS(F)	;SET DIRECTION
  9031	013152'	201000	010000		MOVEI S,IOACT
  9032	013153'	437004	000002		IORB S,DEVIOS(F)	;SET WAIT BIT
  9033	013154'	201300	000012		MOVEI T1,IMGTIM
  9034	013155'	603240	002000		TLNE U,LDLIMI
  9035	013156'	137300	000170'		DPB T1,LDPTIM		;SET TIMER IF IN IMAGE MODE
  9036	013157'	201300	000001		MOVEI T1,1
  9037	013160'	137300	000100'		DPB T1,LOPECO		;SET ECHO-NEEDED
  9038	013161'	137305	000002		DPB T1,LDBOPB(U)	;AND NEED-OUTPUT
  9039	013162'	254000	013170'		JRST WSYNCS
  9040
  9041				;ROUTINE TO WAIT FOR NEARLY EMPTY OUTPUT BUFFER. CALL ONLY AT UUO LEVEL
  9042	013163'	200305	000021	TOWAIT:	MOVE T1,LDBTOC(U)		;GET COUNT OF TYPE-OUT CHARACTERS WAITING.
  9043	013164'	305300	000010		CAIGE T1,10			;OVER 7?
  9044	013165'	263040	000000		POPJ P,0			;NO. JUST RETURN.
  9045	013166'	200000	016623'	TOWAT1:	MOVE S,[XWD TTYOUW+IO,IOACT]	;FLAG OUTPUT WAIT ACTIVITY
  9046	013167'	436004	000002		IORM S,DEVIOS(F)		;IN THE DEVICE DATA BLOCK
  9047	013170'	205000	020000	WSYNCS:	MOVSI S,TIOUSE
  9048	013171'	437004	000002		IORB S,DEVIOS(F)
  9049	013172'	261040	000014		PUSH P,P1			;HAVE TO SAVE AC'S TO WAIT
  9050	013173'	261040	000015		PUSH P,P2			; BECAUSE WSYNC USES THESE
  9051	013174'	261040	000010		PUSH P,T3
  9052	013175'	261040	000004		PUSH P,F
  9053	013176'	261040	000012		PUSH P,W
  9054	013177'	260040	000622'		PUSHJ P,SCNINT		;GIVE HIM A CHANCE TO ECHO BEFORE PUTTING HIM IN WAIT
  9055	013200'	262040	000012		POP P,W
  9056	013201'	262040	000004		POP P,F
  9057	013202'	262040	000010		POP P,T3
  9058	013203'	200004	000002		MOVE	S,DEVIOS(F)	
  9059	013204'	606000	010000		TRNN	S,IOACT		;DO WE NEED TO GO INTO WAIT?
  9060	013205'	254000	013214'		JRST	WSYNC1		;NO
  9061	013206'	336000	016102'		SKIPN	SKPFLG		;INPUT AND SKIP CALL IN PROGRESS?
  9062	013207'	254000	013213'		JRST	WSYNC2		;NO
  9063	013210'	476000	016102'		SETOM	SKPFLG		;COULDN'T GET ENOUGH INPUT CHARS
  9064	013211'	260040	006017'		PUSHJ	P,TIWAKN	;DON'T BLOCK
  9065	013212'	334000	000000		SKIPA
  9066	013213'	260040	000000*	WSYNC2:	PUSHJ P,WSYNC			;WAIT
  9067	013214'	262040	000015	WSYNC1:	POP P,P2			;RESTORE AC'S
  9068	013215'	262040	000014		POP P,P1			; ..
  9069	013216'	205000	020000		MOVSI S,TIOUSE
  9070	013217'	413004	000002		ANDCAB S,DEVIOS(F)
  9071	013220'	263040	000000		POPJ P,0			;AND RETURN FROM TOWAIT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 205
SCNSER.MAC	25-NOV-87 19:52		BACKPRESSURE ADJUSTERS

  9072				SUBTTL BACKPRESSURE ADJUSTERS
  9073
  9074				;BPLVD - CALLED BY LEVDEF UUO
  9075
  9076	013221'	201300	600000	BPLVD:	MOVEI	T1, LDRXOS!LDRBPS
  9077	013222'	612305	000031		TDNE	T1, LDBDCH(U)	;IF WE'VE SENT BACKPRESSURE OR AN XOFF
  9078	013223'	254000	013226'		 JRST	BPLVD1
  9079	013224'	135300	000061'		LDB	T1, LOPBPN
  9080	013225'	322300	013004*		JUMPE	T1, CPOPJ	;OR WE'RE PLANNING TO,
  9081	013226'	200305	000014	BPLVD1:	MOVE	T1, LDBECC(U)
  9082	013227'	270305	000012		ADD	T1, LDBTIC(U)
  9083	013230'	301300	000110		CAIL	T1, TIWKC	;AND WE DON'T HAVE GOBS OF CHARACTERS,
  9084	013231'	263040	000000		 POPJ	P,
  9085	013232'	254000	013253'		JRST	BPFCOM		;  SET TO CLEAR BACKPRESSURE
  9086
  9087				;BPFTYI - CALLED AT THE START OF TYI
  9088
  9089	013233'	201300	600000	BPFTYI:	MOVEI	T1, LDRXOS!LDRBPS
  9090	013234'	612305	000031		TDNE	T1, LDBDCH(U)	;IF WE'VE SENT BACKPRESSURE OR AN XOFF
  9091	013235'	254000	013240'		 JRST	.+3
  9092	013236'	135300	000061'		LDB	T1, LOPBPN
  9093	013237'	322300	013225*		JUMPE	T1, CPOPJ	;OR WE'RE PLANNING TO,
  9094	013240'	200305	000014		MOVE	T1, LDBECC(U)
  9095	013241'	270305	000012		ADD	T1, LDBTIC(U)
  9096	013242'	301300	000010		CAIL	T1, 10		;AND WE HAVE HARDLY ANY CHARACTERS,
  9097	013243'	263040	000000		 POPJ	P,
  9098	013244'	254000	013253'		JRST	BPFCOM		;  SET TO CLEAR BACKPRESSURE
  9099
  9100				;BPXOFF - CALLED WHEN DONE ECHOING, ON CLRBFI, BEFORE DOING
  9101				;	   BLOCK INPUT, AFTER READING COMMAND LINE
  9102				;BPOFF - CALLED WHEN ENTERING COMMAND LEVEL, WHEN FORCED
  9103				;	  OUT OF IMAGE STATE BY SCNSEC OR CLRIMI
  9104
  9105	013245'	334300	016624'	BPXOFF:	SKIPA	T1, [LDRBPS!LDRXOS]
  9106	013246'	201300	400000	BPOFF:	MOVEI	T1, LDRBPS
  9107	013247'	612305	000031		TDNE	T1, LDBDCH(U)	;IF WE'VE SEND BACKPRESSURE (OR XOFF)
  9108	013250'	254000	013253'		JRST	BPFCOM
  9109	013251'	135300	000061'		LDB	T1, LOPBPN	;OR WE'RE ABOUT TO,
  9110	013252'	322300	013237*		JUMPE	T1, CPOPJ
  9111					PFALL	BPFCOM		;  SET TO CLEAR BACKPRESSURE
  9112
  9113	013253'	201300	000001	BPFCOM:	MOVEI	T1, 1
  9114	013254'	137300	000062'		DPB	T1, LOPBPF	;SET BACKPRESSURE-OFF
  9115	013255'	137305	000002		DPB	T1, LDBOPB(U)	;AND NEED-OUTPUT
  9116	013256'	263040	000000		POPJ	P,
  9117
  9118				;ROUTINE TO CHECK TO SEE IF BACKPRESSURE SHOULD BE TURNED OFF.  SKIP RETURNS
  9119				;IF SHOULD NOT BE TURNED OFF ELSE NON-SKIP RETURNS
  9120				;
  9121	013257'	261040	000006	BPTEST:	PUSH	P,T1
  9122	013260'	200305	000012		MOVE	T1,LDBTIC(U)	;COMPUTE TOTAL NUMBER
  9123	013261'	270305	000014		ADD	T1,LDBECC(U)	; OF CHARACTERS WAITING
  9124	013262'	317300	016014'		CAMG	T1,TIWRNN	;GREATER THAN BACKPRESSURE ON THRESHOLD?
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 205-2
SCNSER.MAC	25-NOV-87 19:52		BACKPRESSURE ADJUSTERS

  9125	013263'	254000	010154*		 JRST	TPOPJ		;NO, TURN OFF BACKPRESSURE
  9126	013264'	254000	010160*		JRST	TPOPJ1		;YES, LEAVE BACKPRESSURE ON
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 206
SCNSER.MAC	25-NOV-87 19:52		COMMAND ROUTINES

  9127				SUBTTL COMMAND ROUTINES
  9128
  9129				;ROUTINE TO MAKE THIS TTY VISIBLE TO COMMAND DECODER, IF AT COM LEVEL
  9130				;CALL WITH U SET UP
  9131
  9132	013265'	336000	016100'	CMDWAK:	SKIPN	FRSFLG		;IF IT'S JUST THE RESCAN-STUFFER,
  9133	013266'	254000	013271'		 JRST	CMDWK1
  9134	013267'	402000	016100'		SETZM	FRSFLG		;  TELL IT WE GOT HERE
  9135	013270'	263040	000000		POPJ	P,
  9136	013271'	607240	020000	CMDWK1:	TLNN	U,LDLCOM	;IS LINE AT COMMAND LEVEL?
  9137	013272'	263040	000000		 POPJ	P,0		;NO. JUST RETURN
  9138	013273'	205300	010000		MOVSI	T1,L2LLDF
  9139	013274'	412305	000027		ANDCAM	T1,LDBBYT(U)	;RESET FLAG, USER AWAKE
  9140	013275'	400300	000000		SETZ	T1,		;Indicate to COMWCM that command comes
  9141								;from terminal
  9142				; Enter here with command index in T1 (or 0 if not forced command)
  9143	013276'	261040	000004	TTFORC:	PUSH	P,F		;Preserve
  9144	013277'	135200	000077'		LDB	F,LOPZAP	;If we're going to ZAP it,
  9145	013300'	326200	013310'		JUMPN	F,FPOPJ		; ignore the command
  9146	013301'	550205	000000		HRRZ	F,LDBDDB(U)	;Set up DDB pointer
  9147	013302'	322200	013310'		JUMPE	F,FPOPJ		;None there, just exit
  9148	013303'	261040	000002		PUSH	P,J
  9149	013304'	135100	013011*		LDB	J,PJOBN		;Find job/frame number
  9150	013305'	332000	000002		SKIPE	J		;None there...
  9151	013306'	260040	000000*		PUSHJ	P,COMWCM##	;Set command request for this job/frame
  9152	013307'	262040	000002		POP	P,J
  9153	013310'	262040	000004	FPOPJ:	POP	P,F
  9154	013311'	263040	000000		POPJ	P,
  9155
  9156				;;
  9157				;; Routine to set up command input pointer to accept command
  9158				;;  input from TTY.  Clobbers T2.
  9159				;;
  9160	013312'	200345	000011	TRESCN::MOVE	T2,LDBTIT(U)	;TTY input buffer pointer
  9161	013313'	202340	015721'		MOVEM	T2,TTCMCA	;Copy into command input pointer
  9162	013314'	201400	000040		MOVEI	T3,40		;Delimiter
  9163	013315'	202400	015720'		MOVEM	T3,TTCMCH
  9164	013316'	263040	000000		POPJ	P,
  9165
  9166				;COMTYO - Output character in T3, preserving T2, uses T1
  9167
  9168	013317'	261040	000007	COMTYO::PUSH	P,T2		;Save T2 as advertised
  9169	013320'	260060	015723'		PUSHJ	P,@COMTOA	;Call CCTYO or routine in ONCE
  9170	013321'	254000	000000*		JRST	T2POPJ##	;Restore T2 and return
  9171
  9172				;CCTYO - usual output routine for COMTOA
  9173
  9174	013322'	322240	013252*	CCTYO::	JUMPE	U,CPOPJ		;Ignore if line not set up
  9175	013323'	260040	012713'		PUSHJ	P,IFROOM	;Space in this guy's area?
  9176	013324'	263040	000000		  POPJ	P,		;No, ignore further attempts at output
  9177	013325'	260040	012615'		PUSHJ	P,CMDTYO	;Put character in output chunks
  9178	013326'	324740	007052'		PJRST	ONEOU3		;And start output
  9179
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 206-2
SCNSER.MAC	25-NOV-87 19:52		COMMAND ROUTINES

  9180
  9181	013327'	332340	015721'	CCTYI::	SKIPE T2,TTCMCA		;REAL INPUT ROUTINE FOR COMMAND
  9182	013330'	316345	000010		CAMN T2,LDBTIP(U)	;NOTHING OR AT END OF BUFFER
  9183	013331'	254000	013336'		 JRST CCTYI1		;GO FAKE A BREAK
  9184	013332'	260040	006114'		PUSHJ P,TTGETC
  9185	013333'	255000	000000		  JFCL
  9186	013334'	202340	015721'		MOVEM T2,TTCMCA
  9187	013335'	263040	000000		POPJ P,
  9188
  9189	013336'	201400	000012	CCTYI1:	MOVEI T3,12
  9190	013337'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 207
SCNSER.MAC	25-NOV-87 19:52		COMMAND INPUT ROUTINE

  9191				SUBTTL	COMMAND INPUT ROUTINE
  9192
  9193	013340'	260040	013343'	COMTYI::PUSHJ P,COMTYT	;FETCH A CHARACTER
  9194	013341'	275400	000040		 SUBI T3,40	;UPSHIFT LOWER CASE
  9195	013342'	263040	000000		POPJ P,
  9196
  9197	013343'	200400	015720'	COMTYT::MOVE T3,TTCMCH
  9198	013344'	302400	000003		CAIE T3,3
  9199	013345'	306400	000012		CAIN T3,12	;THESE ARE FINISHED FLAGS
  9200	013346'	254000	012767*		 JRST CPOPJ1	;DO NOT TRY TO READ FURTHER
  9201	013347'	261040	000007		PUSH P,T2
  9202	013350'	261040	000016		PUSH P,P3	;SAVE REGISTERS FOR CALLERS
  9203	013351'	500245	000031		HLL U,LDBDCH(U)
  9204	013352'	260060	015722'	COMTI1:	PUSHJ P,@COMTIA	;GET A CHR
  9205	013353'	405400	000177		ANDI T3,177	;NOT INTERESTED IN EXTRA BITS
  9206	013354'	200710	000305'		MOVE P3,CHRTAB(T3)
  9207	013355'	135300	000300'		LDB T1,CHPRED
  9208	013356'	256006	013365'		XCT COMATB(T1)
  9209	013357'	306400	000015		CAIN T3,15	;RETURN IS SPECAIL
  9210	013360'	254000	013352'		 JRST COMTI1	;GO GET LF AND SAY NOTHING ABOUT RETURN
  9211	013361'	202400	015720'	COMTI2:	MOVEM T3,TTCMCH	;REMEMBER CHR FOR REREAD
  9212	013362'	262040	000016		POP P,P3
  9213	013363'	262040	000007		POP P,T2
  9214	013364'	254000	013346*		JRST CPOPJ1
  9215
  9216	013365'	254000	013372'	COMATB:	JRST SPRCOM	;SPECIAL ACTION
  9217	013366'	255000	000000		JFCL		;NORMAL CHR
  9218	013367'	201400	000012		MOVEI T3,12	;TURN ALL BREAKS TO LINE FEEDS
  9219	013370'	255000	000000		JFCL		;BREAK2
  9220	013371'	370001	777776		SOS -2(P)	;NON-SKIP RETURN ON LOWER CASE CHAR
  9221
  9222	013372'	135300	000302'	SPRCOM:	LDB T1,CHPSPR	;GET CHR TYPE
  9223	013373'	135340	000161'		LDB T2,LDPMOD	;AND LINE MODE
  9224	013374'	256027	013376'		XCT @SPRCTB(T2)
  9225	013375'	254000	013361'		JRST COMTI2	;FINISH UP
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 208
SCNSER.MAC	25-NOV-87 19:52		COMMAND INPUT ROUTINE

  9226	013376'	256006	013402'	SPRCTB:	XCT COMPDP(T1)
  9227	013377'	256006	013411'		XCT COM940(T1)
  9228	013400'	256006	013411'		XCT COM940(T1)
  9229	013401'	256006	013402'		XCT COMPDP(T1)
  9230
  9231	013402'	201400	000003	COMPDP:	MOVEI T3,3	;^C
  9232	013403'	201400	000012		MOVEI T3,12	;33
  9233	013404'	201400	000012		MOVEI T3,12	;^_
  9234	013405'	201400	000012		MOVEI T3,12	;^Z
  9235	013406'	201400	000012		MOVEI T3,12	;175-176
  9236	013407'	254000	013420'		JRST COMTAB	;TAB
  9237	013410'	254000	013424'		JRST COMBSP	;BACKSPACE
  9238
  9239	013411'	201400	000012	COM940:	MOVEI T3,12	;^C
  9240	013412'	201400	000003		MOVEI T3,3	;33
  9241	013413'	201400	000003		MOVEI T3,3	;^_
  9242	013414'	201400	000012		MOVEI T3,12	;^Z
  9243	013415'	254000	013430'		JRST COMPA	;175-176
  9244	013416'	254000	013420'		JRST COMTAB	;TAB
  9245	013417'	254000	013424'		JRST COMBSP	;BACKSPACE
  9246
  9247	013420'	205300	100000	COMTAB:	MOVSI T1,L2LTBK
  9248	013421'	612305	000027		TDNE T1,LDBBYT(U)
  9249	013422'	201400	000012		MOVEI T3,12	;TREAT AS BREAK
  9250	013423'	254000	013361'		JRST COMTI2	;TREAT AS BREAK2
  9251
  9252	013424'	205300	040000	COMBSP:	MOVSI T1,L2LBBP
  9253	013425'	616305	000027		TDNN T1,LDBBYT(U)
  9254	013426'	201400	000012		MOVEI T3,12	;TREAT AS BREAK
  9255	013427'	254000	013361'		JRST COMTI2	;TREAT AS BREAK2
  9256
  9257	013430'	201400	000003	COMPA:	MOVEI T3,3
  9258	013431'	607240	000020		TLNN U,LDLLCT
  9259	013432'	201400	000012		MOVEI T3,12
  9260	013433'	254000	013361'		JRST COMTI2	;EITHER AN ESCAPE OR JUST A BREAK CHR
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 209
SCNSER.MAC	25-NOV-87 19:52		ROUTINE TO SWITCH TTY TO USER PROGRAM LEVEL AND START USER RUNNING

  9261				SUBTTL	ROUTINE TO SWITCH TTY TO USER PROGRAM LEVEL AND START USER RUNNING
  9262
  9263	013434'	634000	000000	TTYUSW::TDZA S,S			;DON'T1 CLEAR WAIT BITS
  9264	013435'	200000	016341'	TTYUSR:: MOVE S,[XWD IOW,IOACT]		;CLEAR WAIT BITS
  9265	013436'	260040	013441'		PUSHJ P,TTYUS0			;PUT TTY IN USER
  9266	013437'	324740	011130*		PJRST SETRUN			;MAKE HIM RUN AND RETURN
  9267
  9268				;CALL TTYUSM TO SIMPLY PUT TERM IN USER MODE
  9269
  9270	013440'	400000	000000	TTYUSM::SETZ S,				;DON'T CLEAR WAIT BITS
  9271	013441'	322240	013322*	TTYUS0:	JUMPE	U,CPOPJ			;Exit if no LDB
  9272	013442'	550205	000000		HRRZ F,LDBDDB(U)		;GET ATTACHED F IF ANY
  9273	013443'	322200	013446'		JUMPE F,TTYUS1			;JUMP IF NOT ATTACHED
  9274	013444'	413004	000002		ANDCAB S,DEVIOS(F)		; ..
  9275	013445'	260040	013004'		PUSHJ P,UUOLDB			;MAKE U AND DEVIOS AGREE
  9276	013446'	205300	020000	TTYUS1:	MOVSI T1,LDLCOM			;PUT TTY IN USER MODE
  9277	013447'	412305	000031		ANDCAM T1,LDBDCH(U)		;MAY BE DETACHED, BUT WILL WAIT
  9278									; AT UUO LEVEL IF NEEDED
  9279	013450'	260040	007534'		PUSHJ P,SETLMD
  9280	013451'	263040	000000		POPJ P,
  9281
  9282				;; Here when terminal-originated command has completed
  9283
  9284	013452'	205300	100000	TTYCMR::MOVSI	T1,LDLECS		;Set EAT-COMMAND-SYNC bit
  9285	013453'	436305	000031		IORM	T1,LDBDCH(U)		; in Line Data Block
  9286	013454'	263040	000000		POPJ	P,
  9287
  9288	013455'	322240	013441*	TTYSTC::JUMPE	U,CPOPJ
  9289	013456'	205300	002000		MOVSI	T1,LDLIMI		;FORCE OUT OF IMAGE MODE
  9290	013457'	260040	013476'		PUSHJ	P,CNCMD1		;WILL ALSO SET COMMAND BIT
  9291
  9292	013460'	322240	013455*	TTYSTR::JUMPE	U,CPOPJ			;Exit if no LDB
  9293	013461'	500245	000031		HLL	U,LDBDCH(U)
  9294	013462'	607240	020000		TLNN	U,LDLCOM		;AT COMMAND LEVEL?
  9295	013463'	324740	007103'		 PJRST	NOCTRO			;NO. JUST CLEAR ^O BIT
  9296	013464'	260040	012514'		PUSHJ	P,TYIEAT		;CLEAR THE COMMAND IN CASE MORE
  9297	013465'	550305	000015		HRRZ	T1,LDBBKC(U)		;NUMBER OF DEF ECHO BREAK CHARS
  9298	013466'	322300	013504'		JUMPE	T1,CKSXON		;NO BREAKS WAITING
  9299	013467'	260040	013265'		PUSHJ	P,CMDWAK		;SET FOR COMMAND
  9300	013470'	324740	007103'		PJRST	NOCTRO			;AND GO CLEAR BIT
  9301
  9302	013471'	505300	000003	MONHNG::HRLI	T1,3
  9303	013472'	260040	006534'		PUSHJ	P,HNGMON
  9304	013473'	255000	000000		  JFCL
  9305	013474'	263040	000000		POPJ	P,
  9306
  9307	013475'			TTYHLT::		;Global entry point to put TTY in cmd mode
  9308	013475'	205300	102000	CNCMOD:	MOVSI T1,LDLIMI!LDLECS
  9309	013476'	412305	000031	CNCMD1:	ANDCAM T1,LDBDCH(U)	;FORCE USER TO COMMAND LEVEL, RESET
  9310	013477'	260040	013257'		PUSHJ	P,BPTEST	;WANT TO TURN OFF BACKPRESSURE?
  9311	013500'	260040	013246'		  PUSHJ P,BPOFF		;YES, MAKE SURE BACKPRESSURE OFF
  9312	013501'	205300	020000		MOVSI T1,LDLCOM
  9313	013502'	436305	000031		IORM T1,LDBDCH(U)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 209-2
SCNSER.MAC	25-NOV-87 19:52		ROUTINE TO SWITCH TTY TO USER PROGRAM LEVEL AND START USER RUNNING

  9314	013503'	324740	007534'		PJRST SETLMD
  9315
  9316	013504'	260040	013257'	CKSXON:	PUSHJ	P,BPTEST	;WANT TO TURN BACKPRESSURE OFF?
  9317	013505'	260040	013245'		  PUSHJ P,BPXOFF	;YES
  9318	013506'	254000	007103'		JRST NOCTRO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 210
SCNSER.MAC	25-NOV-87 19:52		OPRCTY - Remove chars from CTY's LDB and send to CTY

  9319				SUBTTL	OPRCTY - Remove chars from CTY's LDB and send to CTY
  9320
  9321	013507'	000000	000000	CTYBLF::EXP 0	;0,,-1 to ding next minute, -1,,-1 to ding this tick
  9322	013510'	000000	000000	OPRTIC::EXP 0	;Number of ticks before OPRCTY is allowed to continue
  9323
  9324	013511'	201240	000103'	OPRCTY:	MOVEI	U,CTYLDB	;Called by once-per-tick code
  9325	013512'	335000	013510'		SKIPGE	OPRTIC		;If CTYSIM is not doing anything,
  9326	013513'	476000	013510'		 SETOM	OPRTIC		; make sure this doesn't overflow to positive
  9327	013514'	377000	013510'			SOSG  OPRTIC	;Don't output if CTYSIM output recently
  9328				IFCPU(<KI,F3>),<CONSZ TTY,TT.OB>;Skip if output is done
  9329				IFCPU (KS),<	SKIPE CTYOWD##>	;Skip if output is done
  9330	013515'	336000	000455*	IFCPU(KL),<	SKIPN EPT##+SPCMTD>; "     "         "
  9331	013516'	263040	000000			 POPJ P,	;Output in progress - try again later
  9332				;*;	MOVEI	T3,ALRCTY	;SET ALARM
  9333				;*;	IORM	T3,ALR620	;11 NODES DON'T CARE TO KNOW ABOUT ALRCTY
  9334	013517'	331000	013507'		SKIPL	CTYBLF		;AAA. IF -1 RING BELL THIS TIME
  9335	013520'	254000	013524'		 JRST	OPRCT2
  9336	013521'	553000	013507'		HRRZS	CTYBLF		;RESET TO 0,,-1
  9337	013522'	201400	000007		MOVEI	T3,7
  9338	013523'	324740	013647'		PJRST	CTYCHR		;RING BELL.
  9339
  9340	013524'	333000	016012'	OPRCT2:	SKIPLE	CTYFLN		;ARE THERE FILLS NEEDED
  9341	013525'	254000	013550'		 JRST	OPRFIL		;YES
  9342	013526'	200345	000020		MOVE	T2,LDBTOT(U)
  9343	013527'	260040	006114'		PUSHJ	P,TTGETC	;Get character from CTY's LDB
  9344	013530'	260040	006163'		  PUSHJ	P,FRECHK
  9345	013531'	202345	000020		MOVEM	T2,LDBTOT(U)
  9346	013532'	260040	013634'		PUSHJ	P,CTYLOG	;Log it in CTYBUF
  9347	013533'	260040	000000*		PUSHJ	P,PEVEN8	;Generate parity (smashes T1)
  9348	013534'	260040	013647'		PUSHJ	P,CTYCHR	;Send it to the CTY
  9349	013535'	405400	000177		ANDI	T3,177
  9350	013536'	302400	000014		CAIE	T3,14
  9351	013537'	306400	000013		CAIN	T3,13		;HANDLE FF AND VTB
  9352	013540'	254000	013546'		 JRST	CTYFRM
  9353	013541'	306400	000015		CAIN	T3,15
  9354	013542'	336400	016011'		SKIPN	T3,CTYFIL	;CR AND NEED FILLS?
  9355	013543'	254000	013554'		 JRST	CTYNFL		;NO
  9356	013544'	202400	016012'	CTYSFL:	MOVEM	T3,CTYFLN	;YES, SET COUNT (DO NOT DEC CHR CNT)
  9357	013545'	263040	000000		POPJ	P,
  9358
  9359	013546'	201400	000050	CTYFRM:	MOVEI	T3,^D40
  9360	013547'	254000	013544'		JRST	CTYSFL		;SET LARGE NUMBER OF FILLS
  9361
  9362	013550'	201400	000377	OPRFIL:	MOVEI	T3,377		;Filler is RUBOUT with even parity
  9363	013551'	260040	013647'		PUSHJ	P,CTYCHR	;Go to CTY (not CTYLOG)
  9364	013552'	373000	016012'		SOSLE	CTYFLN
  9365	013553'	263040	000000		 POPJ	P,		;Come back next tick
  9366	013554'	373005	000021	CTYNFL:	SOSLE	LDBTOC(U)
  9367	013555'	263040	000000		 POPJ	P,		;NOT ALL OUTPUT YET
  9368	013556'	260040	014170'		PUSHJ	P,OPRFRE	;RESTART SETUUO WAITERS
  9369	013557'	260040	006234'		PUSHJ	P,TSETBO	;RESET OUTPUT BUFFER
  9370	013560'	263040	000000		POPJ	P,		;DONE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 211
SCNSER.MAC	25-NOV-87 19:52		CTYTYP, CTYTYO - output character to the CTY (no interrupts)

  9371				SUBTTL	CTYTYP, CTYTYO - output character to the CTY (no interrupts)
  9372
  9373				;OPROUT - co-routine to set output to the CTY or the OPR terminal.
  9374				;Call with T1/0 = No LDB - Use CTYTYO to go directly to the CTY, no interrupts
  9375				;          T1/1 = One LDB - Use CTYLDB to put in the TTY chunks, CTY only
  9376				;          T1/2 = Two LDBs - Use both CTYLDB and OPRLDB, put in chunks
  9377
  9378	013561'	200306	016625'	OPROUT::MOVE	T1,[EXP OP0TYO,OP1TYO,OP2TYO](T1) ;Get new address
  9379	013562'	250300	015723'		EXCH	T1,COMTOA	;Set new typout address for COMTYO
  9380	013563'	250301	000000		EXCH	T1,(P)		;Save old address, get resume PC
  9381				;*;	PUSH	P,U
  9382				;*;	PUSH	P,T1	
  9383				;*;	MOVEI	U,CTYLDB	;Point to CTY LDB
  9384				;*;	LDB	T1,LDPPOS	;Check current position
  9385				;*;	CAIE	T1,0		;At left margin already?
  9386				;*;	 PUSHJ	P,CRLF		;No, put it there
  9387				;*;	POP	P,T1
  9388				;*;	POP	P,U
  9389	013564'	260046	000000		PUSHJ	P,(T1)		;Call caller as coroutine
  9390	013565'	370001	777777		  SOS	-1(P)		;Error return
  9391	013566'	262040	015723'		POP	P,COMTOA	;Restore typeout routine when caller POPJs
  9392	013567'	254000	013364*		JRST	CPOPJ1
  9393
  9394				;Here during INFO or EVENT stopcodes - use normal buffered output to OPR+CTY
  9395
  9396	013570'	506401	000000	OP2TYO:	HRLM	T3,(P)		;Save char
  9397	013571'	261040	000005		PUSH	P,U
  9398	013572'	332240	015724'		SKIPE	U,OPRLDB	;If there is an OPR terminal
  9399	013573'	260040	013322'		 PUSHJ	P,CCTYO		;Output to it
  9400	013574'	262040	000005		POP	P,U
  9401	013575'	554401	000000		HLRZ	T3,(P)		;Do same character to the CTY
  9402					PFALL	OP1TYO
  9403
  9404				;Here to output to the CTY's LDB only (buffer emptied at clock level)
  9405
  9406	013576'	261040	000005	OP1TYO:	PUSH	P,U		;Routine to output to the CTY's LDB
  9407	013577'	201240	000103'		MOVEI	U,CTYLDB	;Point to the CTY
  9408	013600'	260040	013322'		PUSHJ	P,CCTYO		;Put char in CTY's LDB
  9409	013601'	254000	003541'		JRST	UPOPJ	 	;Restore U and continue
  9410
  9411				;OP0TYO updates the key, then calls CTYTYO (called from continuable STOPCD).
  9412
  9413	013602'	261040	000006	OP0TYO::PUSH	P,T1		;Routine to output char in T3 to the CTY
  9414	013603'	200300	000505'		MOVE	T1,KEY10	;Magic number for the base
  9415	013604'	331000	000000*		SKIPL	.CPDWD##	;STOPCD in progress?
  9416	013605'	256000	000507'		 XCT	KEYSET		;Yes, update KEY620 if not in CONSOLE mode
  9417	013606'	262040	000006		POP	P,T1
  9418					PFALL	CTYTYO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 212
SCNSER.MAC	25-NOV-87 19:52		CTYTYP, CTYTYO - output character to the CTY (no interrupts)

  9419				;Output character directly to the CTY.  Called via PUSHJ P,@COMTYO from DIE.
  9420				;CTYTYO outputs to CTY, logs output, generates even parity, and does fillers.
  9421				;  This routine will wait in a loop if output is busy, which may mean a delay
  9422				;  of several milliseconds (more if CTYFIL is nonzero).
  9423				;Call with 7-bit character in T3 (8 data bits if 9th bit it set).
  9424				;Caller is expected to create free CRLF at column 80 (for now).
  9425
  9426	013607'	261040	000006	CTYTYO::PUSH	P,T1		;Called from ONCE, CTYSIM, ERRCON, etc
  9427	013610'	260040	013634'		PUSHJ	P,CTYLOG	;Log it in CTYBUF (T3 has 7-bit character)
  9428	013611'	626400	000400		TRZN	T3,400		;If image flag set, char is 8 bits
  9429	013612'	260040	013533*		 PUSHJ	P,PEVEN8	;Generate even parity (smashes T1)
  9430	013613'	260040	013647'		PUSHJ	P,CTYCHR	;Output it to the CTY, loop if busy
  9431				PRINTF(<[CTYTYO should to free CRLF at column 80]>)
  9432	013614'	302400	000015		CAIE	T3,015		;Carriage return?
  9433	013615'	306400	000215		CAIN	T3,215		;(with or without parity)
  9434	013616'	336000	016011'		 SKIPN	CTYFIL		;Yes, have to do fillers?
  9435	013617'	254000	013263*		  JRST	TPOPJ		;No, return
  9436	013620'	261040	000010		PUSH	P,T3		;Save the character
  9437	013621'	200300	016011'		MOVE	T1,CTYFIL	;Number of rubouts to do
  9438	013622'	201400	000377	CTYTY1:	MOVEI	T3,377		;Fill character is rubout
  9439	013623'	260040	013647'		PUSHJ	P,CTYCHR	;CTYCHR loops waiting for output done
  9440	013624'	367300	013622'		SOJG	T1,CTYTY1	;Do multiple fillers
  9441	013625'	262040	000010		POP	P,T3		;Get 8-bit character back
  9442	013626'	254000	013617*		JRST	TPOPJ		;End of CTYTYO
  9443
  9444
  9445				;Output string to CTY.  Called from ONCE and COMMON when loading BOOTS
  9446				;	MOVEI	P1,[ASCIZ /string/]
  9447				;	JSP	T1,CTYTYP
  9448				;	 <only return>
  9449
  9450	013627'	205700	440714	CTYTYP::MOVSI	P3,440700!P1	;POINTER FOR ASCIZ
  9451	013630'	134400	000016	CTYTYL:	ILDB	T3,P3		;GET CHARACTER
  9452	013631'	322406	000000		JUMPE	T3,(T1)		;RETURN
  9453	013632'	260040	013607'		PUSHJ	P,CTYTYO
  9454	013633'	254000	013630'		JRST	CTYTYL
  9455
  9456				;Routine to log all CTY output in CTYBUF.  Preserves all ACs
  9457
  9458	013634'	302400	000007	CTYLOG::CAIE	T3,007		;Ignore bells
  9459	013635'	306400	000207		CAIN	T3,207
  9460	013636'	263040	000000		 POPJ	P,
  9461	013637'	261040	000006		PUSH	P,T1
  9462	013640'	133000	000000*		IBP	CTYPTR##	;Increment byte pointer
  9463	013641'	200300	013640*		MOVE	T1,CTYPTR##	;Get it
  9464	013642'	620300	777000		TRZ	T1,777000	;Use only 9 bits of offset within CTYBUF
  9465	013643'	271300	000000*		ADDI	T1,CTYBUF##	;Full address
  9466	013644'	137400	000006		DPB	T3,T1		;Store all CTY output in CTYBUF
  9467	013645'	262040	000006		POP	P,T1
  9468	013646'	263040	000000		POPJ	P,
  9469
  9470				SUBTTL	CTYCHR - Output 8-bit character to the console teletype
  9471				;Caller is responsible for parity generation and free CRLF at column 80.
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 212-2
SCNSER.MAC	25-NOV-87 19:52		CTYCHR - Output 8-bit character to the console teletype

  9472				;Returns immediately if caller has waited for output-done to be true.
  9473				ENTRY	CTYCHR			;Called from CTYSIM
  9474
  9475				IFCPU (<KI,F3>),< ;Output to KI/F3 console
  9476				CTYCHR:	CONSZ	TTY,TT.OB	;Wait for Output Busy to go off
  9477					 JRST	.-1		;(no timeout for this hardware flag)
  9478					DATAO	TTY,T3		;Send character as it (all 8 bits)
  9479					POPJ	P,		;The DATAO sets TT.OB in hardware
  9480				
  9481				SVPPC::	POPJ	P,	;There is no other processor to do Keep-Alive on KI,F3
  9482				>;END IFCPU (<KI,F3>)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 213
SCNSER.MAC	25-NOV-87 19:52		CTYCHR - Output 8-bit character to the console teletype

  9483				PRINTF([Need to make SVPPC work on KS])
  9484
  9485				IFCPU (KS),<	;Output to the KS console via the 8080
  9486				CTYCHR:	HRLM	T3,(P)		;Save character in T3
  9487					MOVSI	T3,1		;Number of times to try
  9488					SKIPE	CTYOWD##	;Previous CTY output done?
  9489					 SOJG	T3,.-1		;No, wait for it
  9490					HLRZ	T3,(P)	
  9491					ANDI	T3,CTYOCH	;Get just the character
  9492					TRO	T3,CTYOVL	;Add the Output Valid flag
  9493					MOVEM	T3,CTYOWD##	;Store in location 33 in low memory
  9494					RDAPR	T3		;Get program states
  9495					ANDI	T3,LP.PIA	;Leave only the PIA
  9496					WRAPR	LP.SSF+LP.I8C(T3);Whap the 8080
  9497					HLRZ	T3,(P)		;Restore char in T3
  9498					POPJ	P,
  9499				
  9500				SVPPC::	JFCL			;Determine if Keep-Alive is active
  9501					PUSH	P,T1		;Save flag on stack
  9502					JFCL			;Disable Keep-Alive checking
  9503					PUSHJ	P,@-1(P)	;Return to caller (co-routine)
  9504					POP	P,T1		;Get flag back
  9505					JFCL			;Resume Keep-Alive if needed
  9506					POP	P,(P)		;Clean up stack
  9507					POPJ	P,		;End of SVPPC
  9508				>  ;End of IFCPU(KS)
  9509
  9510				IFCPU (KL),<	;Output to the KL console via the PDP-11 on the master DTE
  9511	013647'	506401	000000	CTYCHR:	HRLM	T3,(P)		;Save character in T3
  9512	013650'	205400	000001		MOVSI	T3,1		;Number of times to try
  9513	013651'	336000	000455*		SKIPN	EPT##+SPCMTD	;Previous CTY output done?
  9514	013652'	367400	013651'		 SOJG	T3,.-1		;No, wait for it
  9515	013653'	554401	000000		HLRZ	T3,(P)	
  9516	013654'	405400	000377		ANDI	T3,377		;Just 8 bits of character
  9517	013655'	201410	004000		MOVEI	T3,.DTCTO(T3)	;Make DTE command word
  9518	013656'	202400	000451*		MOVEM	T3,EPT##+SPCCMW	;Store in command word
  9519	013657'	402000	000455*		SETZM	EPT##+SPCMTD	;Zero to indicate output not done
  9520	013660'	720200	020000		CONO	DTE,TO11DB	;Ring doorbell
  9521	013661'	554401	000000		HLRZ	T3,(P)		;Restore char in T3
  9522	013662'	263040	000000		POPJ	P,		;SPCMTD will be set nonzero when output done
  9523
  9524				;Routine to save Primary Protocol Condition (See DTESER.703)
  9525				;Called by DIE when processing a STOPCODE.
  9526
  9527	013663'	255000	000000	SVPPC::	JFCL			;Determine if running primary or secondary protocol
  9528	013664'	261040	000006		PUSH	P,T1		;Save flag on stack
  9529				;*;	JSR	SPCINI		;Set to secondary protocol
  9530	013665'	260061	777777		PUSHJ	P,@-1(P)	;Return to caller (co-routine)
  9531	013666'	262040	000006		POP	P,T1		;Get flag back
  9532	013667'	255000	000000		JFCL			;Restart primary protocol if needed
  9533	013670'	262041	000000		POP	P,(P)		;Clean up stack
  9534	013671'	263040	000000		POPJ	P,		;End of SVPPC
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 214
SCNSER.MAC	25-NOV-87 19:52		CTYCHR - Output 8-bit character to the console teletype

  9535				;KL CTY output, continued
  9536
  9537	013672'	000000	000000	SPHNGI:	0	;INSTRUCTION TO XCT IF DTE HANGS UP
  9538	013673'	000000	000000	SPCST1:	0	;FOR SAVING T1
  9539	013674'	000000	000000	SPCTRY:	0	;# OF REMAINING TRIES
  9540			000010	SPCTRN==10	;# TO INIT SPCTRY TO
  9541
  9542	013675'	000000	000000	SPCINI::0			;ENTER SECONDARY PROTOCOL
  9543	013676'	202300	013673'		MOVEM	T1,SPCST1	;SAVE T1
  9544	013677'	200300	016630'		MOVE	T1,[EPT##+SPCDBG,,EPT##+SPCDBG+1]
  9545	013700'	402000	000444*		SETZM	EPT##+SPCDBG
  9546	013701'	251300	000457*		BLT	T1,EPT##+SPCDND	;INIT COMM AREA TO ZEROES
  9547	013702'	700640	013726'		RDPI	SPCCMD		;SAVE PI STATE
  9548	013703'	700600	000400		WRPI	LI.PIF
  9549	013704'	200300	016631'		MOVE	T1,[JSR DTEHLT]
  9550	013705'	202300	000142*		MOVEM	T1,EPT##+EPTDT0+DTEDII
  9551	013706'	202300	013672'		MOVEM	T1,SPHNGI
  9552	013707'	200300	016632'		MOVE	T1,[EPT##+EPTDT0+DTEEPW,,EPT##+EPTDT0+DTEEPW+1]
  9553	013710'	402000	000144*		SETZM	EPT##+EPTDT0+DTEEPW
  9554	013711'	251300	000147*		BLT	T1,EPT##+EPTDT0+DTEDRW
  9555	013712'	720200	001000		CONO	DTE,CL11PT	;CLEAR INTERRUPT JUST IN CASE
  9556	013713'	200300	013726'		MOVE	T1,SPCCMD	;RESTORE PI
  9557	013714'	602300	000200		TRNE	T1,LI.PIN
  9558	013715'	700600	000200		 WRPI	LI.PIN
  9559	013716'	201300	004400		MOVEI	T1,.DTESP
  9560	013717'	264000	013726'		JSR	SPCCMD
  9561	013720'	200300	013673'		MOVE	T1,SPCST1
  9562	013721'	254020	013675'		JRST	@SPCINI
  9563
  9564				;READ SWITCHES.
  9565	013722'	201300	001400	SPCGSW::MOVEI	T1,.DTRSW
  9566	013723'	264000	013726'		JSR	SPCCMD
  9567	013724'	200300	000450*		MOVE	T1,EPT##+SPCF11
  9568	013725'	263040	000000		POPJ	P,
  9569
  9570				;SEND SECONDARY PROTOCOL COMMAND
  9571	013726'	000000	000000	SPCCMD:	0			;JSR HERE
  9572	013727'	402000	000444*		SETZM	EPT##+SPCFLG	;CLEAR FLAG FIRST.
  9573	013730'	202300	000451*		MOVEM	T1,EPT##+SPCCMW	;STUFF COMMAND
  9574	013731'	201300	000010		MOVEI	T1,SPCTRN	;GET # OF TIMES TO TRY
  9575	013732'	202300	013674'		MOVEM	T1,SPCTRY
  9576	013733'	720200	020000	SPCCM1:	CONO	DTE,TO11DB	;RING DOORBELL
  9577	013734'	201300	040000		MOVEI	T1,40000
  9578	013735'	336000	000444*		SKIPN	EPT##+SPCFLG
  9579	013736'	367300	013735'		 SOJG	T1,.-1
  9580	013737'	327320	013726'		JUMPG	T1,@SPCCMD	;WORKED, RETURN.
  9581	013740'	371000	013674'		SOSL	SPCTRY
  9582	013741'	254000	013733'		JRST	SPCCM1
  9583	013742'	256000	013672'		XCT	SPHNGI
  9584
  9585	013743'	000000	000000	DTEHLT:	0
  9586	013744'	256000	000000'		 STOPCD		;;DTEHLT+1
  9587				>;END IFCPU (KL)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 215
SCNSER.MAC	25-NOV-87 19:52		SETUUO TO SET INITIA ON LINES MARKED

  9588				SUBTTL	SETUUO TO SET INITIA ON LINES MARKED
  9589
  9590	013745'	000000	000000	NOXEXE::0			;Set nonzero by ONCE to not run XEXEC
  9591
  9592	013746'	205300	000001	INISET::MOVSI	T1,(STAUTO)	;Enter here from UUOCON (DSKCLN does this)
  9593	013747'	616300	006636*		TDNN	T1,STATES	;Check if still in auto-restart mode
  9594	013750'	263040	000000		 POPJ	P,		;Don't do this more than once
  9595	013751'	201240	000103'		MOVEI	U,CTYLDB	;Output to the CTY
  9596	013752'	332000	013745'		SKIPE	NOXEXE		;If set to not run XEXEC,
  9597					 JRST	[MOVEI T1,STSUPR   ;Change super-shut (600000)
  9598						 ANDCAM T1,STATES  ; to shut (400000) so OPER can login
  9599						 SETZM NOXEXE	   ;Allow INITIA to be run later
  9600						 MOVEI T1,[ASCIZ /INITIALIZATION complete
  9601				please log in: /]
  9602	013753'	254000	016644'			 PJRST CONMES##]
  9603					MOVEI	T1,[ASCIZ /SETUUO forcing INITIA on TTY1,TTY2,TTY3,TTY4,TTY5
  9604	013754'	201300	016651'	/]
  9605	013755'	260040	002050*		PUSHJ	P,CONMES##	;TELL OPERATOR WHAT IS HAPPENING
  9606	013756'	205700	000000*		MOVSI	P3,-PORTN##	;CHECK ALL LINES
  9607	013757'	200256	012263*	INISLP:	MOVE	U,LINTAB(P3)
  9608	013760'	336005	000026		SKIPN	LDBLOG(U)	;NOT IF LOGGED IN
  9609	013761'	607240	000000*		TLNN	U,TTVIN2	;OR NOT MARKED
  9610	013762'	254000	014000'		 JRST	INISL2
  9611	013763'	200340	016664'		MOVE	T2,[LLLNLN,,LDLCOM]	;FOR LDBLOG AND LDBDCH
  9612	013764'	512345	000026		HLLZM	T2,LDBLOG(U)	;MARK IN (BUT UNKNOWN TO THE BASE)
  9613	013765'	516345	000031		HRLZM	T2,LDBDCH(U)	;AND COMMAND MODE
  9614	013766'	200300	007714*		MOVE	T1,SYSNUM##	;Our host number
  9615	013767'	137300	000154'		DPB	T1,LDPHST	; for job running INITIA part 2 (XEXEC)
  9616	013770'	402005	000032		SETZM	LDBDCX(U)	;NO EXTENDED BITS ON
  9617	013771'	260040	007534'		PUSHJ	P,SETLMD
  9618	013772'	260040	002036*		PUSHJ	P,FRMASN##	;Assign a frame slot
  9619	013773'	263040	000000		  POPJ	P,		;None there? Quit loop now, why bother?
  9620	013774'	260040	014645'		PUSHJ	P,TTYATI	;Attach TTY DDB to this LDB
  9621	013775'	324740	002051*		  PJRST	FRMKJF##	;No DDB's - free up frame slot,kill TTY
  9622	013776'	201300	000000*		MOVEI	T1,CMFCXI##
  9623	013777'	260040	013276'		PUSHJ	P,TTFORC	;MARK FORCED COMMAND
  9624	014000'	253700	013757'	INISL2:	AOBJN	P3,INISLP
  9625	014001'	254000	013567*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 216
SCNSER.MAC	25-NOV-87 19:52		SOME ROUTINES TO FIND TELETYPES FOR VARIOUS PURPOSES

  9626				SUBTTL	SOME ROUTINES TO FIND TELETYPES FOR VARIOUS PURPOSES
  9627
  9628				;SUBROUTINE TO FIND TTY FOR A JOB IN J (TTYFND) OR FOR
  9629				; CURRENT JOB (TTYFNU)
  9630				;RETURN WITH F AND U SET UP.
  9631				;GOES TO ERROR IF NO TTY F FOR THE JOB.
  9632
  9633	014002'	200100	012503*	TTYFNU::MOVE	J,JOB		;GET CURRENT UUO LEVEL JOB NUMBER
  9634	014003'	260040	014006'	TTYFND::PUSHJ	P,TTYSRC	;FIND THE JOB'S TTY F, ALSO U AND S
  9635	014004'	256000	000000'		 STOPCD 		;JOB ZERO, OR OTHERWISE NO DDB. COMPLAIN.
  9636	014005'	263040	000000		POPJ	P,0		;SUCCESS. RETURN.
  9637
  9638				;ROUTINE TO FIND A TTY F WHICH IS ATTACHED TO, I.E.
  9639				;CONTROLLING, A PARTICULAR JOB NUMBER.
  9640
  9641				;CALLED AT COMMAND LEVEL BY ATTACH COMMAND, AND AT M LEVEL
  9642				;BY REFERENCES TO DEVICE "TTY" OR TTCALLS, ETC.
  9643
  9644				;CALL:	MOVE J,JOB NUMBER DESIRED
  9645				;	PUSHJ P,TTYSRC
  9646				;	  ERROR RETURN.	;NOT FOUND. AC'S U,F,S NOT GUARANTEED
  9647				;	NORMAL RETURN	;U, S AND F SET UP. NOTE THAT THIS DOES
  9648				;			;!NOT! IMPLY THAT ANYONE IS ATTACHED. THAT IS,
  9649				;			; U MAY CONTAIN A ZERO
  9650
  9651
  9652	014006'	322100	013460*	TTYSRC::JUMPE	J,CPOPJ		;NOBODY CONTROLS JOB ZERO. YOU ARE CONFUSED.
  9653	014007'	550202	011411*		HRRZ	F,TTYTAB(J)	;REALLY MUST BE HERE
  9654	014010'	322200	014006*		JUMPE	F,CPOPJ
  9655	014011'	550244	000013		HRRZ	U,DDBLDB(F)
  9656	014012'	200004	000002		MOVE	S,DEVIOS(F)	;SET UP I/O STATUS AND LINE
  9657	014013'	254000	014001*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 217
SCNSER.MAC	25-NOV-87 19:52		SUBROUTINE TTYERP TO FIND TTY F FOR A MONITOR ERROR MSG

  9658				SUBTTL	SUBROUTINE TTYERP TO FIND TTY F FOR A MONITOR ERROR MSG
  9659				;CALL WITH J SET TO JOB NUMBER. IF JOB IS ZERO OR JOB
  9660				;IS DETACHED USER OPRLDB. IF NOT EVEN THAT IS THERE,
  9661				;GIVE RETURN. NORMAL RETURN IS SKIP
  9662
  9663	014014'	260040	014006'	TTYERP::PUSHJ	P,TTYSRC	;FIND F
  9664	014015'	254000	014017'		  JRST	GETOPR		;NO, USE OPER
  9665	014016'	326240	014013*		JUMPN	U,CPOPJ1	;RETURN IF ATTACHED
  9666
  9667				;GETOPR DESTROYS U,F, T1-T4. ALL OTHER ACS ARE SAVED.
  9668	014017'	550240	015724'	GETOPR::HRRZ	U,OPRLDB	;IS OPER THERE
  9669	014020'	326240	014031'		JUMPN	U,GETOP1	;YES, GET F SET UP
  9670
  9671				;GETCTY USED BY CHKPNT WATCHDOG TO FORCE MSG TO CTY
  9672				;GETOPR DESTROYS U,F, T1-T4. ALL OTHER ACS ARE SAVED.
  9673
  9674	014021'	201240	000103'	GETCTY::MOVEI	U,CTYLDB	;GET CTY'S LDB
  9675	014022'	261040	000006		PUSH	P,T1
  9676	014023'	261040	000007		PUSH	P,T2
  9677	014024'	200305	000021		MOVE	T1,LDBTOC(U)	;CHECK CURRENT COUNT
  9678	014025'	303300	000214		CAILE	T1,^D140
  9679	014026'	260040	006234'		 PUSHJ	P,TSETBO	;TOO BIG, CLEAR
  9680	014027'	262040	000007		POP	P,T2
  9681	014030'	262040	000006		POP	P,T1
  9682	014031'	550205	000000	GETOP1:	HRRZ	F,LDBDDB(U)
  9683	014032'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 218
SCNSER.MAC	25-NOV-87 19:52		FIND A USER AND WAIT FOR ATTACH OR OUTPUT WAIT TO FINISH

  9684				SUBTTL	FIND A USER AND WAIT FOR ATTACH OR OUTPUT WAIT TO FINISH
  9685
  9686	014033'	260040	014002'	TTYFUW::PUSHJ P,TTYFNU
  9687	014034'	260040	012652'	TTYFW1:	PUSHJ P,CKATTF		;WAIT FOR ATTACH
  9688	014035'	200305	000021		MOVE T1,LDBTOC(U)	;HAVE TO PUT IT IN HERE SO
  9689	014036'	307300	000010		CAIG T1,10		;DOES OT CALL SCNINT
  9690	014037'	263040	000000		POPJ P,
  9691	014040'	200000	016665'	TOWATA:	MOVE S,[XWD TTYOUW+IO+TIOUSE,IOACT]
  9692	014041'	437004	000002		IORB S,DEVIOS(F)
  9693	014042'	261040	000014		PUSH P,P1
  9694	014043'	261040	000015		PUSH P,P2
  9695	014044'	260040	013213*		PUSHJ P,WSYNC
  9696	014045'	262040	000015		POP P,P2
  9697	014046'	262040	000014		POP P,P1
  9698	014047'	205000	020000		MOVSI S,TIOUSE
  9699	014050'	413004	000002		ANDCAB S,DEVIOS(F)
  9700	014051'	263040	000000		POPJ P,
  9701
  9702	014052'	200000	016623'	TTYSOW::MOVE S,[XWD TTYOUW+IO,IOACT]
  9703	014053'	437004	000002		IORB S,DEVIOS(F)
  9704	014054'	263040	000000		POPJ P,
  9705
  9706				;AAA JAN 77 ROUTINE TO GET OPER TTY & SKIP RETURN WITH U,F.
  9707				; & RETURN NON-SKIP WITH CTY LDB DDB IN U,F IF NO OPR TTY EXISTS
  9708
  9709	014055'	260040	014017'	GTOPER::PUSHJ	P,GETOPR
  9710	014056'	302240	000103'		CAIE	U,CTYLDB
  9711	014057'	254000	014016*		 JRST	CPOPJ1	;SKIP, GOT OPR
  9712	014060'	263040	000000		POPJ	P,
  9713				;(GTOPER USED BY CHKPNT WATCHDOG TO SEND MSGS TO BOTH CTY & OPR)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 219
SCNSER.MAC	25-NOV-87 19:52		SUBROUTINE TO FIND LDB FOR A PHYSICAL NAME, IF ITS A TTY

  9714				SUBTTL	SUBROUTINE TO FIND LDB FOR A PHYSICAL NAME, IF ITS A TTY
  9715				;AND LOAD F WITH LINKED DATA BLOCK, IF ANY, BUT DONT MAKE ONE IF NONE YET
  9716				;SKIP RETURN IF ITS A TTY
  9717
  9718	014061'	316300	016666'	TTYPHY::CAMN	T1,[SIXBIT /OPR/]	;TALK TO OPERATOR?
  9719	014062'	200300	004407*		 MOVE	T1,DEVOPR		;YES. GET REAL DEVICE NAME
  9720	014063'	510240	000006		HLLZ	U,T1			;GET FIRST THREE CHARACTERS
  9721	014064'	316240	016667'		CAMN	U,[SIXBIT /TTY/]	;ARE THEY TTY?
  9722	014065'	606300	770000		TRNN	T1,770000		;AND ALSO IS FOURTH CHAR NON-BLANK?
  9723	014066'	263040	000000		 POPJ	P,			;NO. NOT A LEGAL NAME.
  9724	014067'	261040	000006		PUSH	P,T1			;YES. MAY BE LEGAL.
  9725	014070'	517001	000000		HRLZS	0(P)			;PUT THE RIGHT THREE CHARS ON STACK
  9726	014071'	261040	016670'		PUSH	P,[POINT 6,-1(P)]	;POINTER TO READ CHARS
  9727	014072'	201240	000000		MOVEI	U,0			;INITIALIZE U TO 0
  9728	014073'	134301	000000	TTYPH4:	ILDB	T1,0(P)			;GET A SIXBIT CHARACTER FROM NAME
  9729	014074'	322300	014105'		JUMPE	T1,TTYPH2		;JUMP IF END OF NAME.
  9730	014075'	640300	000020		TRC	T1,'0'			;CONVERT SIXBIT TO BINARY
  9731	014076'	303300	000007		CAILE	T1,7			;IS IT AN OCTAL DIGIT?
  9732	014077'	254000	014103'		 JRST	TTYPH3			;NO. BAD CHAR IN NAME
  9733	014100'	240240	000003		ASH	U,3			;MULTIPLY BY 8
  9734	014101'	271246	000000		ADDI	U,0(T1)			;ADD IN THIS DIGIT
  9735	014102'	254000	014073'		JRST	TTYPH4			;LOOP FOR MORE DIGITS
  9736
  9737	014103'	262040	000006	TTYPH3:	POP	P,T1			;HERE ON BAD CHAR. CLEAR OUT STACK
  9738	014104'	254000	013626*		JRST	TPOPJ			;AND RETURN TO ERR RET
  9739
  9740	014105'	262040	000006	TTYPH2:	POP	P,T1			;HAVE AN OCTAL NUMBER. DISCARD
  9741	014106'	262040	000006		POP	P,T1			; TWO ITEMS FROM STACK
  9742	014107'	301240	000000*		CAIL	U,PORTN##		;IS IT A LEGAL HARDWARE LINE #
  9743	014110'	263040	000000		 POPJ	P,			;NO. TOO BAD.
  9744	014111'	550245	013757*		HRRZ	U,LINTAB(U)		;GET LINE DATA BLOCK ADDRESS
  9745	014112'	550205	000000		HRRZ	F,LDBDDB(U)		;GET ATTACHED F, IF ANY.
  9746	014113'	254000	014057*		JRST	CPOPJ1			;GOOD RETURN
  9747
  9748				;ROUTINE TO GET A DDB. CALLED IN DEVSRCH ROUTINES
  9749
  9750	014114'	260040	014061'	GETDDB::PUSHJ	P,TTYPHY	;FIND THE TELETYPE BY NUMBER
  9751	014115'	263040	000000		  POPJ	P,		;NOT A REAL TTY
  9752	014116'	322200	014010*		JUMPE	F,CPOPJ		;NOT REALLY THERE YET
  9753	014117'	200304	000000		MOVE	T1,DEVNAM(F)	;IF SOMEONE ELSES WILL BE
  9754	014120'	254000	014113*		JRST	CPOPJ1		;ASSIGNED BY CONSOLE SO CAN'T HAVE IT ANYWAY
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 220
SCNSER.MAC	25-NOV-87 19:52		SUBROUTINE TO PUT PHYSICAL NAME INTO T2 FOR LINE WHOSE LDB IS IN U

  9755				SUBTTL	SUBROUTINE TO PUT PHYSICAL NAME INTO T2 FOR LINE WHOSE LDB IS IN U
  9756				;EVEN THOUGH THERE MAY BE NOTHING IN F OR LDBDDB
  9757
  9758	014121'	135300	000153'	TTYNAM::LDB	T1,LDPLNO		;GET LINE NUMBER
  9759	014122'	261040	016667'		PUSH	P,[SIXBIT /TTY/]	;PUT NAME ON STACK
  9760	014123'	201401	000000		MOVEI	T3,0(P)			;PREPARE ARG FOR SCNNMR
  9761	014124'	505400	220600		HRLI	T3,220600		;POINT 6,0,17
  9762	014125'	260040	014130'		PUSHJ	P,SCNNMR		;AND CALL SAME ROUTINE AS SCNNAM DOES
  9763	014126'	262040	000007		POP	P,T2			;PUT ANSWER IN T2
  9764	014127'	263040	000000		POPJ	P,			;AND RETURN FROM TTYNAM
  9765
  9766				;SUBSIDIARY ROUTINE TO DO RADIX PRINT TO CORE.
  9767
  9768	014130'	231300	000010	SCNNMR:	IDIVI	T1,10			;DEVICE NAMES ARE OCTAL
  9769	014131'	506341	000000		HRLM	T1+1,0(P)		;STORE A DIGIT ON STACK
  9770	014132'	332000	000006		SKIPE	T1			;NEED MORE DIGITS?
  9771	014133'	260040	014130'		 PUSHJ	P,SCNNMR		;YES. GO MAKE THEM.
  9772	014134'	554301	000000		HLRZ	T1,0(P)			;RETRIEVE A DIGIT FROM STACK
  9773	014135'	271300	000020		ADDI	T1,'0'			;CONVERT TO SIXBIT
  9774	014136'	136300	000010		IDPB	T1,T3			;STORE IN OBJECT WORD (DEVNAM)
  9775	014137'	263040	000000		POPJ	P,0			;POP UP TO SCNNMR OR BACK TO SCNNAM
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 221
SCNSER.MAC	25-NOV-87 19:52		SETUUO OUTPUT MESSAGE TO OPR TTY & CTY *BOTH*, IF POSSIBLE.

  9776				SUBTTL	SETUUO OUTPUT MESSAGE TO OPR TTY & CTY *BOTH*, IF POSSIBLE.
  9777				;OTHERWISE JUST TO CTY.
  9778
  9779	014140'	550540	000006	OPRSND::HRRZ	M,T1
  9780	014141'	505540	440700		HRLI	M,(POINT 7,0)
  9781	014142'	336240	015724'	OPRSN2:	SKIPN	U,OPRLDB	;GET OPR
  9782	014143'	201240	000103'		 MOVEI	U,CTYLDB	;NONE, GO TO CTY ONLY
  9783	014144'	200305	000021		MOVE	T1,LDBTOC(U)
  9784	014145'	434300	000124'		IOR	T1,CTYLDB+LDBTOC;WAIT IF EITHER OPR TTY OR CTY
  9785	014146'	326300	014161'		JUMPN	T1,OPRWAT	;IS BUSY (OUTPUT BUFF NOT-EMPTY)
  9786								;UNWAIT WHEN ONE OR THE OTHER
  9787								;BECOMES EMPTY
  9788	014147'	256040	016403'	OPSND1:	XCTFU	<ILDB T3,M>
  9789	014150'	322400	014120*		JUMPE	T3,CPOPJ1	;DONE
  9790	014151'	260040	013322'		PUSHJ	P,CCTYO		;SAME OUTPUT RESTRICTIONS AS COMMAND
  9791	014152'	336000	015724'		SKIPN	OPRLDB		;SKIP IF GOING TO BOTH
  9792	014153'	254000	014147'		 JRST	OPSND1		;JUST TO CTY, ALREADY DONE
  9793	014154'	201240	000103'		MOVEI	U,CTYLDB
  9794	014155'	256040	016671'		XCTFU	<LDB T3,M>	;GET SAME CHAR JUST SENT,
  9795	014156'	260040	013322'		PUSHJ	P,CCTYO		;& PUT IT ON CTY
  9796	014157'	200240	015724'		MOVE	U,OPRLDB	;RESTORE U
  9797	014160'	254000	014147'		JRST	OPSND1
  9798
  9799	014161'	201300	012034*	OPRWAT:	MOVEI	T1,MLOWQ	;WAIT FOR OPR BUFFER TO EMPTY
  9800	014162'	137300	012035*		DPB	T1,PJBSTS##	;SET TO MON WAIT QUE
  9801	014163'	550300	016013'		HRRZ	T1,OPRWJB	;GET WAITING JOB IF ANY
  9802	014164'	202302	000000*		MOVEM	T1,QUEPCB(J)	;PUT ON QUE
  9803	014165'	552100	016013'		HRRZM	J,OPRWJB	;AND SET CURRENT
  9804	014166'	260040	012036*		PUSHJ	P,WSCHED
  9805	014167'	254000	014142'		JRST	OPRSN2		;RESTARTED. ONE OF THEM JUST BECAME
  9806								;FREE. GO CHECK AGAIN MAKE SURE BOTH FREE.
  9807
  9808				;Here when the OPR terminal is free to do more output
  9809
  9810	014170'	336340	016013'	OPRFRE::SKIPN	T2,OPRWJB
  9811	014171'	263040	000000		 POPJ	P,		;NONE WAITING
  9812	014172'	402000	016013'		SETZM	OPRWJB		;RESTART ALL WAITERS
  9813	014173'	261040	000002		PUSH	P,J
  9814	014174'	200100	000007	OPRFR1:	MOVE	J,T2
  9815	014175'	201300	011126*		MOVEI	T1,RNQ
  9816	014176'	137300	014162*		DPB	T1,PJBSTS##
  9817	014177'	260040	013437*		PUSHJ	P,SETRUN
  9818	014200'	550342	014164*		HRRZ	T2,QUEPCB(J)
  9819	014201'	402002	014200*		SETZM	QUEPCB(J)	;ZERO OLD ENTRY
  9820	014202'	326340	014174'		JUMPN	T2,OPRFR1	;ANY MORE?
  9821	014203'	262040	000002		POP	P,J
  9822	014204'	263040	000000		POPJ	P,		;DONE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 222
SCNSER.MAC	25-NOV-87 19:52		SUBROUTINE FOR THE TTY COMMAND

  9823				SUBTTL	SUBROUTINE FOR THE TTY COMMAND
  9824
  9825				;ON ENTRY P1 HAS LDB TO DO THINGS FOR, T2 HAS COMMAND
  9826
  9827	014205'	205300	777743	SCNTCD::MOVSI	T1,-TTCWDN	;GET LENGTH OF COMMAND TABLE
  9828	014206'	312346	014213'		CAME	T2,TTCWDT(T1)
  9829	014207'	253300	014206'		 AOBJN	T1,.-1
  9830	014210'	327300	014150*		JUMPG	T1,CPOPJ1	;NOT FOUND, TAKE ERROR RETURN
  9831	014211'	550346	014250'		HRRZ	T2,TTCWDD(T1)	;GET DISPATCH
  9832	014212'	254007	000000		JRST	(T2)		;AND GO
  9833
  9834
  9835	014213'	565700	000000	TTCWDT:	SIXBIT /NO/
  9836	014214'	644142	000000	TTYTBL::SIXBIT /TAB/
  9837	014215'	465762	550000		SIXBIT /FORM/
  9838	014216'	544300	000000		SIXBIT /LC/
  9839	014217'	465154	540000		SIXBIT /FILL/
  9840	014220'	454350	570000		SIXBIT /ECHO/
  9841	014221'	436254	460000		SIXBIT /CRLF/
  9842	014222'	675144	645000		SIXBIT /WIDTH/
  9843	014223'	705756	000000		SIXBIT /XON/
  9844	014224'	644160	450000		SIXBIT /TAPE/
  9845	014225'	465154	542100		SIXBIT /FILL1/
  9846	014226'	465154	542200		SIXBIT /FILL2/
  9847	014227'	515600	000000		SIXBIT /IN/
  9848	014230'	576564	000000		SIXBIT /OUT/
  9849	014231'	410000	000000		SIXBIT /A/
  9850	014232'	420000	000000		SIXBIT /B/
  9851	014233'	430000	000000		SIXBIT /C/
  9852	014234'	440000	000000		SIXBIT /D/		;Was /TYPE/
  9853	014235'	424143	536360		<SIXBIT /BACKSPACE/>
  9854	014236'	456241	634500		SIXBIT /ERASE/
  9855	014237'	627045	000000		SIXBIT /RXE/
  9856	014240'	444546	000000		SIXBIT /DEF/
  9857	014241'	654357	000000		SIXBIT /UCO/
  9858	014242'	426344	000000		SIXBIT /BSD/
  9859	014243'	624263	000000		SIXBIT /RBS/
  9860	014244'	435441	636300		SIXBIT /CLASS/		; [dws]
  9861	014245'	626443	575560		SIXBIT /RTCOMP/		;[Darren]
  9862	014246'	534164	415341		SIXBIT /KATAKA/		;KATAKANA (JIS-8 ASCII) mode
  9863	014247'	647160	450000		SIXBIT /TYPE/		;Type of terminal
  9864			000035	TTCWDN==.-TTCWDT
  9865			033000	TTYMXL==:<TTCWDN-1-1>_^D9
  9866
  9867	014250'	000000	014305'	TTCWDD:	XWD 0,TTCNO		;LH MAY HAVE A BIT TO SET/RESET
  9868	014251'	000024	014310'		XWD TCNTAB,TTCSET
  9869	014252'	000025	014310'		XWD TCNFRM,TTCSET
  9870	014253'	000026	014307'		XWD TCNLCT,TTCCLR
  9871	014254'	000000	014372'		XWD 0,TTCFIL
  9872	014255'	000004	014307'		XWD TCNHDX,TTCCLR
  9873	014256'	000027	014307'		XWD TCNNFC,TTCCLR
  9874	014257'	000015	014323'		XWD TCNWID,TTCVAL
  9875	014260'	000030	014310'		XWD TCNPTP,TTCSET
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 222-2
SCNSER.MAC	25-NOV-87 19:52		SUBROUTINE FOR THE TTY COMMAND

  9876	014261'	000030	014310'		XWD TCNPTP,TTCSET
  9877	014262'	000016	014323'		XWD TCNFC1,TTCVAL
  9878	014263'	000017	014323'		XWD TCNFC2,TTCVAL
  9879	014264'	000001	014323'		XWD TCNIR,TTCVAL
  9880	014265'	000002	014323'		XWD TCNOR,TTCVAL
  9881	014266'	000005	014323'		XWD TCNPA,TTCVAL
  9882	014267'	000006	014323'		XWD TCNPB,TTCVAL
  9883	014270'	000007	014323'		XWD TCNPC,TTCVAL
  9884	014271'	000013	014323'		XWD TCNPD,TTCVAL	;Parameter D (formerly TCNTYP)
  9885	014272'	000020	014310'		XWD TCNBSP,TTCSET
  9886	014273'	000021	014310'		XWD TCNERA,TTCSET
  9887	014274'	000012	014310'		XWD TCNRXE,TTCSET
  9888	014275'	000022	014310'		XWD TCNDEF,TTCSET
  9889	014276'	000023	014307'		XWD TCNLCO,TTCCLR
  9890	014277'	000031	014310'		XWD TCNBSD,TTCSET
  9891	014300'	000011	014310'		XWD TCNECH,TTCSET
  9892	014301'	000032	014337'		XWD TCNCLA,TTCSIX	;Class
  9893	014302'	000033	014310'		XWD TCNRTC,TTCSET	;RTcompatibility
  9894	014303'	000034	014310'		XWD TCNKAT,TTCSET	;Katakana mode
  9895	014304'	000035	014345'		XWD TCNTYP,TTCTYP	;TYPE is a number or a sixbit value
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 223
SCNSER.MAC	25-NOV-87 19:52		SET TTY routines

  9896				SUBTTL	SET TTY routines
  9897
  9898	014305'	641600	777777	TTCNO:	TLC	P1, -1		;COMPLEMENT YES-NO FLAG
  9899	014306'	263040	000000		POPJ	P,
  9900
  9901				;BIT-VALUED CHARACTERISTICS
  9902
  9903	014307'	641600	777777	TTCCLR:	TLC	P1,-1		;OPPOSITE OF SET
  9904	014310'	554306	014250'	TTCSET:	HLRZ	T1,TTCWDD(T1)	;T1/ TC# FOR SETTCN
  9905	014311'	321600	014316'		JUMPL	P1,TTCDO1	;RESETTING THE BIT
  9906	014312'	201340	000001		MOVEI	T2,1
  9907	014313'	260040	014362'		PUSHJ	P,TTCGO
  9908	014314'	350001	000000		  AOS	(P)
  9909	014315'	263040	000000		POPJ	P,
  9910	014316'	400340	000000	TTCDO1:	SETZ	T2,
  9911	014317'	260040	014362'		PUSHJ	P,TTCGO
  9912	014320'	350001	000000		  AOS (P)
  9913	014321'	553000	000014	TTCFIN:	HRRZS	P1		;Clear "NO" flag
  9914	014322'	263040	000000		POPJ	P,
  9915
  9916				;DECIMAL-VALUED CHARACTERISTICS
  9917
  9918	014323'	261040	000006	TTCVAL:	PUSH	P,T1
  9919	014324'	321600	014331'		JUMPL	P1,TTCVL0	;"NO" = 0
  9920	014325'	260040	000000*		PUSHJ	P,DECIN1##	;T2 := DECIMAL NUMBER
  9921	014326'	254000	013264*		  JRST	TPOPJ1	
  9922	014327'	254000	014326*		  JRST	TPOPJ1		;NO NUMBER OR BAD NUMBER
  9923	014330'	254000	014332'		JRST	TTCVL1
  9924	014331'	400340	000000	TTCVL0:	SETZ	T2,
  9925	014332'	262040	000006	TTCVL1:	POP	P,T1		;T1/ VALUE FROM DISPATCH
  9926	014333'	554306	014250'	TTCVL2:	HLRZ	T1,TTCWDD(T1)	;T1/ TC# FOR SETTCN
  9927	014334'	260040	014362'	TTCVL3:	PUSHJ	P,TTCGO
  9928	014335'	350001	000000		  AOS	(P)
  9929	014336'	263040	000000		POPJ	P,
  9930
  9931				;[dws] Sixbit-valued characteristics
  9932
  9933	014337'	261040	000006	TTCSIX:	PUSH	P,T1		; save T1
  9934	014340'	335000	000014		SKIPGE	P1		; skip if "No" not seen
  9935	014341'	634340	000007		 TDZA	T2,T2		;  "No" = blanks
  9936	014342'	260040	000000*		PUSHJ	P,CTEXT1##	; T2 := sixbit text
  9937	014343'	262040	000006		POP	P,T1		; T1/ value from dispatch
  9938	014344'	254000	014333'		JRST	TTCVL2		; Go set it
  9939
  9940				;Treat SET TTY TYPE specially for Japanese customers
  9941
  9942	014345'	261040	000006	TTCTYP:	PUSH	P,T1		; save T1
  9943	014346'	335000	000014		SKIPGE	P1		; skip if "No" not seen
  9944	014347'	634340	000007		 TDZA	T2,T2		;  "No" = blanks
  9945	014350'	260040	014342*		PUSHJ	P,CTEXT1##	; T2 := sixbit text
  9946	014351'	262040	000006		POP	P,T1		; T1/ value from dispatch
  9947	014352'	312340	016672'		CAME	T2,[SIXBIT /0/]	;Old "TTY TYPE 0" command?
  9948	014353'	316340	016673'		CAMN	T2,[SIXBIT /1/]	;Old "TTY TYPE 1" command?
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 223-2
SCNSER.MAC	25-NOV-87 19:52		SET TTY routines

  9949	014354'	334000	000000		 SKIPA			;Yes
  9950	014355'	254000	014333'		  JRST	TTCVL2		;No, just store value
  9951	014356'	242340	777742		LSH	T2,^D<5-35>	;Yes, right justify number
  9952	014357'	405340	000007		ANDI	T2,7		;Keep as 0 or 1
  9953	014360'	201300	000013		MOVEI	T1,TCNPD	;Act like "SET TTY D 1" command
  9954	014361'	254000	014334'		JRST	TTCVL3		;Go set parameter "D" for KATAKANA
  9955
  9956	014362'	261040	000005	TTCGO:	PUSH	P,U		;T1/ TCNxxx (PDP-10 TC number)
  9957	014363'	540240	000014		HRR	U,P1		;U/ LDB ADDR
  9958	014364'	500245	000031		HLL	U,LDBDCH(U)
  9959	014365'	260040	010146'		PUSHJ	P,SETTC1	;GO SET THE TC
  9960	014366'	254000	014370'		  JRST	.+2
  9961	014367'	350001	777777		AOS	-1(P)		;TRANSFER THE SKIP-RETURN
  9962	014370'	262040	000005		POP	P,U
  9963	014371'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 224
SCNSER.MAC	25-NOV-87 19:52		FOR OLD TIME'S SAKE (SET FC1 AND FC2 FROM THE SAME VALUE)

  9964				SUBTTL	FOR OLD TIME'S SAKE (SET FC1 AND FC2 FROM THE SAME VALUE)
  9965
  9966	014372'	321600	014377'	TTCFIL:	JUMPL	P1,TTCFL0
  9967	014373'	260040	014325*		PUSHJ	P,DECIN1##
  9968	014374'	254000	014210*		  JRST	CPOPJ1
  9969	014375'	254000	014374*		  JRST	CPOPJ1
  9970	014376'	254000	014400'		JRST	TTCFL1
  9971	014377'	400340	000000	TTCFL0:	SETZ	T2,
  9972	014400'	201300	000016	TTCFL1:	MOVEI	T1, TCNFC1
  9973	014401'	260040	014362'		PUSHJ	P, TTCGO
  9974	014402'	254000	014375*		  JRST	CPOPJ1
  9975	014403'	201300	000017		MOVEI	T1, TCNFC2
  9976	014404'	260040	014362'		PUSHJ	P, TTCGO
  9977	014405'	350001	000000		  AOS	(P)
  9978	014406'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 225
SCNSER.MAC	25-NOV-87 19:52		CALLED FROM COMCON TO SET TO SEND SHUT OR ANSWERED MESSAGE

  9979				SUBTTL	CALLED FROM COMCON TO SET TO SEND SHUT OR ANSWERED MESSAGE
  9980
  9981	014407'	205300	004000	SETSHT::MOVSI	T1,TYPI TYPSHT	;SET TO SAY SHUT
  9982	014410'	201340	400000		MOVEI	T2,STSHUT	;400000
  9983	014411'	616340	013747*		TDNN	T2,STATES	;IS THAT THE STATE
  9984	014412'	205300	002000		 MOVSI	T1,TYPI TYPANS	;YES, SO SAY ANSWERED
  9985	014413'	202300	015725'		MOVEM	T1,UPSHUT
  9986	014414'	616340	014411*		TDNN	T2,STATES	;UP OR DOWN?
  9987	014415'	254000	014422'		 JRST	CKOPR		;UP, SEE IF DEVOPR SET
  9988	014416'	402000	015732'		SETZM	OPRTIM		;DOWN, TURN OFF TIMER
  9989	014417'	201340	000020		MOVEI	T2,ALROPR
  9990	014420'	412340	005642*		ANDCAM	T2,ALR620	;AND ALARM
  9991	014421'	263040	000000		POPJ	P,
  9992
  9993	014422'	332000	014062*	CKOPR:	SKIPE	DEVOPR
  9994	014423'	263040	000000		 POPJ	P,		;DEVOPR SET, ALL OK
  9995	014424'	201340	000132		MOVEI	T2,^D90		;SET FOR 90 SEC TILL ALARM
  9996	014425'	202340	015732'		MOVEM	T2,OPRTIM
  9997	014426'	263040	000000		POPJ	P,
  9998
  9999				;CALLED TO SEE IF WAITING FOR LOGOUT SO CAN NOT SET JACCT2
 10000
 10001	014427'	550202	014007*	CKLGO::	HRRZ F,TTYTAB(J)
 10002	014430'	322200	014402*		JUMPE F,CPOPJ1		;NO DDB, SAY OK TO SET
 10003	014431'	550244	000013		HRRZ U,DDBLDB(F)
 10004	014432'	322240	014430*		JUMPE U,CPOPJ1		;NO LINE, CAN NOT BE WAITING
 10005	014433'	205440	200000		MOVSI T4,LLLZAP
 10006	014434'	616445	000026		TDNN T4,LDBLOG(U)	;SEE IF ZAPPER RECEIVED FLAG SET
 10007	014435'	350001	000000		 AOS (P)		;NO, OK
 10008	014436'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 226
SCNSER.MAC	25-NOV-87 19:52		SEND A SAD MESSGE

 10009				SUBTTL	SEND A SAD MESSGE
 10010
 10011	014437'	200300	014420*	SNDSAD:	MOVE	T1,ALR620
 10012	014440'	316300	015744'		CAMN	T1,ALRSNT
 10013	014441'	254000	014432*		  JRST	CPOPJ1		;NOT SENT
 10014	014442'	261040	000006		PUSH	P,T1		;SAVE T1 FROM BEING CLOBBERED.
 10015	014443'	260040	004102'		PUSHJ	P,CLSCHR	;FINISH UP CHARACTER OUTPUT.
 10016	014444'	254000	014104*		 JRST	TPOPJ		;NO MORE ROOM.
 10017	014445'	200340	012254*		MOVE	T2,ORPPDP	;PICK UP THE OUTPUT RING POINTER.
 10018	014446'	271340	000002		ADDI	T2,2		;THIS OPERATION REQUIRES 2 WORDS.
 10019	014447'	405340	011241*		ANDI	T2,MSKORG	;MASK FOR WRAP AROUND.
 10020	014450'	316340	004555*		CAMN	T2,ORP620	;MAKE SURE THERE'S ROOM.
 10021	014451'	254000	014444*		  JRST	TPOPJ		;NO MORE ROOM.  FINISH SCANNING LINE.
 10022	014452'	262040	000006		POP	P,T1		;RESTORE T1
 10023	014453'	202300	015744'		MOVEM	T1,ALRSNT	;SAY WE SENT THAT ONE
 10024	014454'	205700	066000		MOVSI	P3,TYPI TYPSAD
 10025	014455'	135300	016674'		LDB	T1,[POINT 16,ALR620,15]
 10026	014456'	137300	016273'		DPB	T1,[POINT 16,P3,BYP4]
 10027	014457'	202717	011235*		MOVEM	P3,ORING(P4)
 10028	014460'	271740	000001		ADDI	P4,1
 10029	014461'	405740	014447*		ANDI	P4,MSKORG	;POINT TO CORRECT LOCATION (POSSIBLE WRAP)
 10030	014462'	135300	016675'		LDB	T1,[POINT 16,ALR620,31]
 10031	014463'	137300	016676'		DPB	T1,[POINT 16,P3,BYP2]
 10032	014464'	260040	004161'		PUSHJ	P,WRDOT2	;WRITE 2ND WORD AND CLEAN UP
 10033	014465'	263040	000000		  POPJ	P,		;NO MORE ROOM.  CALL FINOUT.
 10034	014466'	254000	014441*		JRST	CPOPJ1		;CONTINUE SCAN.
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 227
SCNSER.MAC	25-NOV-87 19:52		ATTACH/DETACH

 10035				SUBTTL ATTACH/DETACH
 10036
 10037				;TTYKIL - ACTUALLY TWO ROUTINES
 10038				;
 10039				;1)	CALLED WITH F/ 0, U/ LDB ADDR TO ZAP LINE WHENEVER A
 10040				;	COMMAND HAS JUST BEEN FORCED ON A NON-JOB (E.G.,
 10041				;	WHEN JOB CAPACITY IS EXCEEDED), AND, BY SOME QUIRK
 10042				;	OF FATE, AFTER EVERY DETACH COMMAND (BECAUSE COMCON
 10043				;	RELOADS F FROM LDBDDB(U) AND INCORRECTLY THINKS
 10044				;	F/ 0 = NO JOB)
 10045				;
 10046				;2)	CALLED WITH F/ DDB ADDR, U/ ANYTHING TO ZAP THE
 10047				;	ATTACHED PORT, IF ANY, AND FREE THE COMMAND PORT DDB
 10048				;	OF A JOB BEING KILLED.
 10049
 10050	014467'	322200	014622'	TTYKIL::JUMPE	F,TTYZAP	;IF THERE'S NO JOB (CASE 1): ZAP IT
 10051
 10052				;(CASE 2) FREE THE DDB, THEN ZAP THE CIRCUIT
 10053
 10054	014470'	402004	000000		SETZM	DEVNAM(F)
 10055	014471'	402004	000005		SETZM	DEVLOG(F)
 10056	014472'	135300	013304*		LDB	T1,PJOBN
 10057	014473'	332000	000006		SKIPE	T1
 10058	014474'	402006	014427*		SETZM	TTYTAB(T1)	;MAKE SURE MARKED AS NO DDB
 10059	014475'	205300	000004		MOVSI	T1,IOFST
 10060	014476'	202304	000002		MOVEM	T1,DEVIOS(F)
 10061	014477'	137300	014472*		DPB	T1,PJOBN	;THIS WILL SET TO JOB 0
 10062	014500'	550244	000013		HRRZ	U,DDBLDB(F)	;CHECK FOR A LINE ATTACHED
 10063	014501'	322240	014504'		JUMPE	U,TTYKDB	;DETACHED ALREADY?
 10064
 10065				    ; U/ 0,,LDB ADDR
 10066				    ;HERE WHEN WE'RE TTYKILLING AN ATTACHED DDB
 10067
 10068	014502'	513005	000000		HLLZS	LDBDDB(U)	;DISCONNECT LINE FROM F
 10069	014503'	260040	014622'		PUSHJ	P,TTYZAP	;ELSE ZAP THE CIRCUIT
 10070					PFALL	TTYKDB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 228
SCNSER.MAC	25-NOV-87 19:52		TTYKDB - CLEAR LDB PTR AND ASSIGNMENT & USE BITS FOR A TTY DDB

 10071				SUBTTL	TTYKDB - CLEAR LDB PTR AND ASSIGNMENT & USE BITS FOR A TTY DDB
 10072				;	   (ADDR IN F), AND RETURN IT TO THE FREE POOL
 10073
 10074	014504'	322200	014116*	TTYKDB:	JUMPE	F,CPOPJ
 10075	014505'	513004	000013		HLLZS	DDBLDB(F)	;NO F FROM U
 10076	014506'	200300	016677'		MOVE	T1,[XWD TTYATC,ASSCON!ASSPRG]
 10077	014507'	412304	000004		ANDCAM	T1,DEVMOD(F)	;CLEAR OUT ALL USE AND ASSIGN BITS
 10078	014510'	554344	000013		HLRZ	T2,DDBBLK(F)	;GET BACK LINK
 10079	014511'	554304	000003		HLRZ	T1,DEVSER(F)	;AND FORWARD LINK
 10080				;;Start of debug code;;
 10081	014512'	202200	014552'		MOVEM	F,XXCDDB	;Current DDB pointer
 10082	014513'	202300	014555'		MOVEM	T1,XXNDDB	;Next DDB pointer
 10083	014514'	202340	014560'		MOVEM	T2,XXPDDB	;Previous DDB pointer
 10084	014515'	261044	000003		PUSH	P,DEVSER(F)	;Current forward link
 10085	014516'	262040	014553'		POP	P,XXCSER
 10086	014517'	261044	000013		PUSH	P,DDBBLK(F)	;Current backward link
 10087	014520'	262040	014554'		POP	P,XXCBLK
 10088	014521'	261046	000003		PUSH	P,DEVSER(T1)	;Next forward link
 10089	014522'	262040	014556'		POP	P,XXNSER
 10090	014523'	261046	000013		PUSH	P,DDBBLK(T1)	;Next backward link
 10091	014524'	262040	014557'		POP	P,XXNBLK
 10092	014525'	261047	000003		PUSH	P,DEVSER(T2)	;Previous forward link
 10093	014526'	262040	014561'		POP	P,XXPSER
 10094	014527'	261047	000013		PUSH	P,DDBBLK(T2)	;Previous backward link
 10095	014530'	262040	014562'		POP	P,XXPBLK
 10096				;;End of debug code;;
 10097	014531'	506307	000003		HRLM	T1,DEVSER(T2)	;LINK AROUND DDB
 10098	014532'	261040	000010		PUSH	P,T3
 10099	014533'	200406	000004		MOVE	T3,DEVMOD(T1)	;IS NEW DEST. ALSO A TTY?
 10100	014534'	603400	004010		TLNE	T3,DVTTY!DVRMT
 10101	014535'	506346	000013		 HRLM	T2,DDBBLK(T1)	;YES, SET ITS BACK POINTER
 10102	014536'	262040	000010		POP	P,T3
 10103	014537'	200300	015733'		MOVE	T1,FRETTY
 10104	014540'	506304	000003		HRLM	T1,DEVSER(F)	;AND LINK INTO FREE POOL
 10105	014541'	552200	015733'		HRRZM	F,FRETTY
 10106	014542'	550200	000007		HRRZ	F,T2		;POINT TO PRED FOR LINKING
 10107				;Check that the DDB chain ends properly
 10108	014543'	554300	000000*		HLRZ	T1,DEVLST##	;Beginning of DDB chain
 10109	014544'	201340	023420		MOVEI	T2,^D10000	;Paranoid loop counter
 10110	014545'	322300	014504*	TTYKD1:	JUMPE	T1,CPOPJ	;Quit when end of chain is found
 10111	014546'	554306	000003		HLRZ	T1,DEVSER(T1)	;Point to next DDB
 10112	014547'	367340	014545'		SOJG	T2,TTYKD1	;Look for end
 10113	014550'	256000	016700'	DDBCNE:: STOPCD (.,STOP,DDBCNE,,<DDB chain has no end>)
 10114				 ;;TTYKDB+many
 10115	014551'	263040	000000		POPJ	P,
 10116
 10117	014552'	000000	000000	XXCDDB:	0			;Current DDB pointer
 10118	014553'	000000	000000	XXCSER:	0			;DEVSER word with forward pointer
 10119	014554'	000000	000000	XXCBLK:	0			;DDBBLK word with backward pointer
 10120	014555'	000000	000000	XXNDDB:	0
 10121	014556'	000000	000000	XXNSER:	0			;Ditto for next DDB
 10122	014557'	000000	000000	XXNBLK:	0
 10123	014560'	000000	000000	XXPDDB:	0
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 228-2
SCNSER.MAC	25-NOV-87 19:52		TTYKDB - CLEAR LDB PTR AND ASSIGNMENT & USE BITS FOR A TTY DDB

 10124	014561'	000000	000000	XXPSER:	0			;Ditto for previous DDB
 10125	014562'	000000	000000	XXPBLK:	0
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 229
SCNSER.MAC	25-NOV-87 19:52		TDTUUO - HERE FROM ATTACH UUO WHEN DETACHING THE COMMAND PORT

 10126				SUBTTL	TDTUUO - HERE FROM ATTACH UUO WHEN DETACHING THE COMMAND PORT
 10127				;	   (J/ JOB NUMBER)
 10128
 10129	014563'	260040	014006'	TDTUUO::PUSHJ	P,TTYSRC	;FIND F
 10130	014564'	263040	000000		 POPJ	P,		;NONE THERE
 10131	014565'	322240	014545*		JUMPE	U,CPOPJ		;MUST NOT BE WAITING FOR LOGOUT
 10132	014566'	205300	200000		MOVSI	T1,LLLZAP
 10133	014567'	612305	000026		TDNE	T1,LDBLOG(U)
 10134	014570'	263040	000000		 POPJ	P,
 10135					PFALL	TTYDET
 10136
 10137				;TTYDET - DETACH A TTY DDB (ADDR IN F)
 10138
 10139	014571'	550244	000013	TTYDET::HRRZ U,DDBLDB(F)	;GET LDB ADDR
 10140	014572'	513004	000013		HLLZS DDBLDB(F)		;AND CLEAR LINK
 10141	014573'	553004	000000		HRRZS DEVNAM(F)		;SAVE PORT # BUT CLEAR "TTY"
 10142								;SO DEVICE SEARCH DOESN'T FIND IT
 10143	014574'	201300	000001		MOVEI	T1, 1
 10144	014575'	137300	000242'		DPB	T1, DDPCOM	;SHOULD RE-ATTACH IN CMND MODE
 10145	014576'	322240	014565*		JUMPE U,CPOPJ		;NO LINE TO SEND ZAPPER ON
 10146	014577'	513005	000000		HLLZS LDBDDB(U)		;CLEAR LDB TO DDB LINK
 10147	014600'	324740	014622'		PJRST TTYZAP		;  SEND A ZAPPER ON IT
 10148
 10149				;TYCIOS - called by CLOCK1 to clear ALL tty's IOS
 10150
 10151	014601'	260040	015337'	TYCIOS::PUSHJ P,FRSTTY
 10152	014602'	263040	000000		  POPJ P,	
 10153	014603'	254000	014606'		JRST TYIOS2		;include command port
 10154
 10155	014604'	260040	015341'	TYIOS1:	PUSHJ P,NXTTTY	;THIS WILL BE AUX CIR OR RMT
 10156	014605'	263040	000000		  POPJ P,	;FINISHED, NONE THERE
 10157	014606'	205300	004000	TYIOS2:	MOVSI T1,DVRMT
 10158	014607'	612304	000004		TDNE T1,DEVMOD(F)
 10159					JRST	[MOVE S,[IOW,,IOACT]	;RESET BITS FOR RMT
 10160						ANDCAM S,DEVIOS(F)
 10161	014610'	254000	016703'			JRST TYIOS1]	;NEXT
 10162	014611'	200000	016706'		MOVE S,[IOW+TIOUSE,,IOACT]
 10163	014612'	412004	000002		ANDCAM S,DEVIOS(F)	;RESET ALL BITS INCLUDING USE
 10164	014613'	200300	016677'		MOVE T1,[TTYATC,,ASSCON+ASSPRG]
 10165	014614'	616304	000004		TDNN T1,DEVMOD(F)	;ANY REASON TO KEEP IT
 10166	014615'	260040	014504'		PUSHJ P,TTYKDB		;NO, GET RID OF IT
 10167	014616'	254000	014604'		JRST TYIOS1
 10168
 10169				;IFDET - CALLED FROM EXIT UUO: IF DETACHED, SKIP, ELSE DO A
 10170				;	  TTYFUW AND NONSKIP-RETURN
 10171
 10172	014617'	260040	014003'	IFDET::	PUSHJ P,TTYFND
 10173	014620'	322240	014466*		JUMPE U,CPOPJ1	;IS DETACHED
 10174	014621'	254000	014034'		JRST TTYFW1	;FINISH THE TTYFUW
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 230
SCNSER.MAC	25-NOV-87 19:52		TTYZAP - ZAP A CIRCUIT (U/ LDB ADDR).

 10175				SUBTTL	TTYZAP - ZAP A CIRCUIT (U/ LDB ADDR).
 10176
 10177	014622'	201340	000001	TTYZAP:	MOVEI	T2,1
 10178	014623'	205300	100000		MOVSI	T1,LLLNLN	;NLN set if base sent zap to us
 10179	014624'	616305	000026		TDNN	T1,LDBLOG(U)	;IF IT'S A HANGUP NOT AN INCOMING ZAP,
 10180	014625'	137340	000075'		 DPB	T2,LOPSYL	;  SET SEND-YELLOW-BALL
 10181	014626'	137340	000077'		DPB	T2,LOPZAP	;SET SEND-ZAPPER
 10182	014627'	137345	000002		DPB	T2,LDBOPB(U)	;SET NEED-OUTPUT
 10183	014630'	205300	400000		MOVSI	T1,LDLNOP
 10184	014631'	412305	000031		ANDCAM	T1,LDBDCH(U)	;IGNORE BACKPRESSURE
 10185	014632'	205300	001000		MOVSI	T1,LMLBIO
 10186	014633'	612305	000030		TDNE	T1,LDBMOD(U)	;IF IT'S IN BLOCK I/O MODE,
 10187	014634'	260040	011626'		 PUSHJ	P,BIOREL	;  GET IT OUT
 10188	014635'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 231
SCNSER.MAC	25-NOV-87 19:52		TTYATT - ATTACH LDB TO JOB

 10189				SUBTTL	TTYATT - ATTACH LDB TO JOB
 10190				;	   U/ LDB  J/ JOB#
 10191				;	   SKIP-RETURNS ON SUCCESS WITH F/ CMND PORT DDB
 10192				;	   NONSKIP-RETURNS ON FAILURE WITH F/ 0
 10193
 10194	014636'	261040	000005	TTYATT::PUSH	P,U
 10195	014637'	201200	000000		MOVEI	F,0		;RET 0 IN CASE DONT FIND TTY DDB
 10196	014640'	260040	014006'		PUSHJ	P,TTYSRC	;FIND THE F FOR THAT JOB
 10197	014641'	254000	014643'		  JRST	LPOPJ		;NONE, SHOULD NOT HAVE GOTTEN HERE
 10198	014642'	322240	014651'		JUMPE	U,TTYAT1	;WAS THERE ANYONE ATTACHED
 10199	014643'	262040	000005	LPOPJ:	POP	P,U		;YES, NOONE CAN DO THIS FOR NOW
 10200	014644'	263040	000000		POPJ	P,
 10201
 10202				COMMENT ! TTYATI - CALLED TO DO INITIAL ATTACH WHEN
 10203					PROCESSING LOGIN.
 10204				EXPECTS:  U/ LDB ON WHICH LOGIN APPEARED
 10205					  J/ JOB SLOT TO WHICH WE WANT TO ATTACH IT
 10206				CLOBBERS: T1 - T4
 10207				RETURNS: CPOPJ IF CANNOT ATTACH. F/0 IF NO TTYDDB'S, F/DDB IF
 10208						BECAUSE ALREADY ATTACHED
 10209					 CPOPJ1 IF SUCCESS, F/DDB
 10210				!
 10211
 10212
 10213	014645'	261040	000005	TTYATI:	PUSH P,U
 10214	014646'	260040	014006'		PUSHJ P,TTYSRC	;CHECK FOR A F FOR THIS JOB
 10215	014647'	260040	015146'		 PUSHJ P,DDBSRC	;NONE, FIND A FREE ONE
 10216	014650'	254000	014643'		  JRST LPOPJ	;NO FREE F OR JOB ALREADY HAS ONE, GIVE ERROR RETURN
 10217	014651'	200241	000000	TTYAT1:	MOVE U,0(P)	;RESTORE LINE USER IS NOW ON
 10218	014652'	261040	000004		PUSH P,F
 10219	014653'	550205	000000		HRRZ F,LDBDDB(U)	;DOES IT HAVE A F?
 10220	014654'	322200	014657'		JUMPE F,TTYAT2	;NO, JUST DO THE ATTACH
 10221	014655'	513004	000013		HLLZS DDBLDB(F)	;GET RID OF LINK TO LINE SO
 10222	014656'	553004	000000		HRRZS DEVNAM(F)	;MAKE SURE LEFT OF NAME ZEROED
 10223	014657'	262040	000004	TTYAT2:	POP P,F		;NOW RESTORE F HE GOES TO
 10224	014660'	262040	000005		POP P,U
 10225	014661'	200300	016707'		MOVE T1,[XWD TTYATC,ASSCON]	;ASSIGN IT
 10226	014662'	436304	000004		IORM T1,DEVMOD(F)
 10227	014663'	137100	014477*		DPB J,PJOBN		;SET JOB ASSIGNED TO
 10228	014664'	200300	000000*		MOVE T1,TIMRST##	;RESET ANY WAITING HANG
 10229	014665'	137100	000000*		DPB J,CLKJOB##		;WHICH MAY EXIST IN CLOCK QUEUE
 10230	014666'	260040	000000*		PUSHJ P,CHGCLK		;FOR PREVIOUS OWNERS OF THIS JOB SLOT
 10231	014667'	552202	014474*		HRRZM F,TTYTAB(J)	;SET TTYTAB UP
 10232	014670'	260040	015213'		PUSHJ P,SCNNAM		;FILL IN NAME OF TTY F
 10233	014671'	260040	015115'		PUSHJ	P, COMATT	;JOIN F AND U
 10234	014672'	254000	014620*		JRST CPOPJ1		;AND TAKE GOOD RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 232
SCNSER.MAC	25-NOV-87 19:52		HERE FROM THE ATTACH UUO IF IT'S ATTACHING

 10235				SUBTTL	 HERE FROM THE ATTACH UUO IF IT'S ATTACHING
 10236				; T1/ USERMODE,,JOB# WHERE USERMODE IS 1 TO
 10237				; ATTACH THE PORT IN USER MODE AND 0 TO ATTACH
 10238				; IT IN COMMAND MODE
 10239
 10240	014673'	261040	000006	TATUUO::PUSH	P,T1
 10241	014674'	260040	014006'		PUSHJ	P,TTYSRC	;FIND F FOR THIS JOB
 10242	014675'	254000	014451*		  JRST	TPOPJ		;CAN NOT ATTACH, NO F
 10243	014676'	550244	000013		HRRZ	U,DDBLDB(F)
 10244	014677'	322240	014675*		JUMPE	U,TPOPJ		;GIVE UP
 10245	014700'	205300	200000		MOVSI	T1,LLLZAP
 10246	014701'	612305	000026		TDNE	T1,LDBLOG(U)
 10247	014702'	254000	014677*		 JRST	TPOPJ		;DO NOT ALLOW IF WAITING FOR LOGUT
 10248	014703'	550101	000000		HRRZ	J,0(P)		; J/ 0,,TARGET JOB#
 10249	014704'	260040	014636'		PUSHJ	P,TTYATT	;Attach our old line to new job
 10250	014705'	254000	014702*		  JRST	TPOPJ		;CANNOT ATTACH
 10251	014706'	262040	000006		POP	P,T1		;T1/USERMODE,,TARGET JOB#
 10252	014707'	350001	000000		AOS	(P)
 10253	014710'	261040	000006		PUSH	P,T1
 10254	014711'	603300	000004		TLNE	T1,(1B15)	;does user want frame continued?
 10255	014712'	260040	014725'		 PUSHJ	P,RTCONT	;yes - do it
 10256	014713'	262040	000006		POP	P,T1
 10257	014714'	603300	000001		TLNE	T1,(1B17)	;WANTS USER MODE?
 10258	014715'	254000	014721'		 JRST	TATUU1		;YES.
 10259	014716'	260040	000000*		PUSHJ	P,PRPRMT##	;GIVE HIM A PERIOD OR HYPHEN
 10260	014717'	260040	013475'		PUSHJ	P,CNCMOD	;FORCE TO COMMAND LEVEL
 10261	014720'	254000	013455'		JRST	TTYSTC		;AND GO
 10262
 10263	014721'	205300	020000	TATUU1:	MOVSI	T1,LDLCOM
 10264	014722'	412305	000031		ANDCAM	T1,LDBDCH(U)	; PUT INTO USER MODE
 10265	014723'	260040	007534'		PUSHJ	P,SETLMD
 10266	014724'	263040	000000		POPJ	P,		; SKIP-RETURN ((P) AOS'D ABOVE)
 10267
 10268
 10269				; RTCONT - call here to make sure target frame is running.
 10270				; Called in response to user request by ATTACH UUO and RETACH UUO.
 10271				; Expects J/ target JOB #.
 10272				; Clobbers T1 alot.
 10273
 10274	014725'	335302	006713*	RTCONT:	SKIPGE	T1,JBTSTS(J)	;check if its already running
 10275	014726'	263040	000000		 POPJ	P,		;yep! nothing to do
 10276	014727'	603300	020000		TLNE	T1,JERR		;can't continue if JERR set
 10277	014730'	263040	000000		 POPJ	P,
 10278	014731'	324740	014177*		PJRST	SETRUN		;resume execution in target and return
 10279
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 233
SCNSER.MAC	25-NOV-87 19:52		HERE FROM THE ATTACH UUO IF IT'S ATTACHING

 10280				COMMENT @
 10281
 10282				RETACH UUO - MOVE A TTY SOMEWHERE ELSE
 10283
 10284					MOVEI	AC, [
 10285						SOURCE FRAME,,TARGET FRAME
 10286						BITS,,PORT
 10287					]
 10288					RETACH	AC,
 10289					  ERROR RETURN	;AC/ ERROR CODE
 10290					NORMAL RETURN	;AC/ PORT# OF PORT MOVED (FROM RH(DEVNAM))
 10291
 10292					<BITS> = 1B0 TO ATTACH AS AUX/SLAVE PORT RATHER THAN
 10293						     AS CMND PORT (MUST BE SIGN BIT)
 10294					       + 0B2 TO ATTACH ACCORDING TO SAVED CMND MODE STATE
 10295						 1B2 TO ATTACH IN CURRENT COMMAND MODE STATE
 10296						 2B2 TO FORCE COMMAND MODE
 10297						 3B2 TO FORCE USER MODE
 10298					       + 1B3 TO SIGNAL A HANGUP ON THE SOURCE FRAME
 10299
 10300					<ERROR CODE> = (SEE DEFINITIONS BELOW)
 10301				@
 10302
 10303			400000	RT.SLV==400000
 10304			300000	RT.MOD==300000
 10305				  DEFINE RTYMOD(X) = <[POINT 2,X,2]>
 10306			000000	  .RTMSV==0
 10307			000001	  .RTMCU==1
 10308			000002	  .RTMCO==2
 10309			000003	  .RTMUS==3
 10310			040000	RT.SIG==040000
 10311			020000	RT.CON==020000
 10312
 10313			000001	RTSAC%==1	;INSUFFICIENT ACCESS TO SOURCE FRAME
 10314			000002	RTSNX%==2	;SOURCE FRAME DOES NOT EXIST
 10315			000003	RTTAC%==3	;INSUFFICIENT ACCESS TO TARGET FRAME
 10316			000004	RTTNX%==4	;TARGET FRAME DOESN'T EXIST
 10317			000005	RTSNA%==5	;PORT NOT ATTACHED TO SOURCE FRAME
 10318			000006	RTTAT%==6	;PORT ALREADY ATTACHED TO TARGET FRAME
 10319			000007	RTSCP%==7	;FORCED COMMAND PENDING ON PORT
 10320			000010	RTAUX%==10	;ATTACHING AUX CIRCUIT AS CMND PORT
 10321			000011	RTNRM%==11	;NO ROOM FOR NEW DDB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 234
SCNSER.MAC	25-NOV-87 19:52		RETACH uuo

 10322				SUBTTL	RETACH uuo
 10323
 10324	014732'	256200	016710'	RETACH::XCTFU <MOVE P1,0(T1)>	;P1/ SOURCE,,TARGET
 10325	014733'	256200	016711'		XCTFU <MOVE P2,1(T1)>	;P2/ BITS,,PORT
 10326
 10327				    ;CHECK ACCESS TO SOURCE FRAME
 10328
 10329	014734'	554740	000014		HLRZ	P4, P1		;P4/ SOURCE FRAME DESC
 10330	014735'	551700	000010		HRRZI	P3, .ARDET
 10331	014736'	260040	000000*		PUSHJ	P, FARCHK##	;MAY WE DETACH FROM THE SOURCE?
 10332					  JRST	[
 10333						MOVEI	T1, RTSAC%
 10334						JRST	RTERR
 10335	014737'	254000	016712'		]
 10336	014740'	205300	040000		MOVSI	T1, JNA
 10337	014741'	616302	014725*		TDNN	T1, JBTSTS(J)	;IS THE SOURCE JOB THERE?
 10338					 JRST	[
 10339						MOVEI	T1, RTSNX%
 10340						JRST	RTERR
 10341	014742'	254000	016714'		]
 10342	014743'	506100	000014		HRLM	J, P1
 10343
 10344				    ;CHECK ACCESS TO TARGET FRAME
 10345
 10346	014744'	550740	000014		HRRZ	P4, P1		;P4/ TARGET FRAME DESC
 10347	014745'	551700	000007		HRRZI	P3, .ARATT
 10348	014746'	260040	014736*		PUSHJ	P, FARCHK##	;MAY WE ATTACH TO THE TARGET?
 10349					  JRST	[
 10350						MOVEI	T1, RTTAC%
 10351						JRST	RTERR
 10352	014747'	254000	016716'		]
 10353	014750'	205300	040000		MOVSI	T1, JNA
 10354	014751'	616302	014741*		TDNN	T1, JBTSTS(J)	;IS THE TARGET JOB THERE?
 10355					 JRST	[
 10356						MOVEI	T1, RTTNX%
 10357						JRST	RTERR
 10358	014752'	254000	016720'		]
 10359	014753'	542100	000014		HRRM	J, P1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 235
SCNSER.MAC	25-NOV-87 19:52		RETACH uuo

 10360				    ;SAVE THE CALLER'S JOB #
 10361
 10362	014754'	261040	000002		PUSH	P, J
 10363
 10364				    ;GET THE PORT BEING MOVED
 10365
 10366	014755'	554100	000014		HLRZ	J, P1		;J/ SOURCE FRAME #
 10367	014756'	570200	000015		HRRE	F, P2		;F/ SOURCE PORT DESCRIPTOR
 10368	014757'	260040	015541'		PUSHJ	P, FNDPRT	;SET F/ DDB ADDR. IF NO DDB
 10369	014760'	254000	014763'		  JRST	RETCH1
 10370	014761'	550244	000013		HRRZ	U, DDBLDB(F)
 10371	014762'	326240	014765'		JUMPN	U, RETCH2	;OR IF IT IS DETACHED
 10372	014763'	201300	000005	RETCH1:	MOVEI	T1, RTSNA%
 10373	014764'	254000	015112'		JRST	RTERJ		;  RESTORE J AND ERROR-RETURN
 10374
 10375				    ;J/ SOURCE FRAME#  F/ SOURCE DDB  U/ LDB
 10376
 10377	014765'	335005	000000	RETCH2:	SKIPGE	LDBDDB(U)	;IF LINE HAS PENDING COMMANDS,
 10378					 JRST	[
 10379						MOVEI	T1, RTSCP%
 10380						JRST	RTERJ	;  RESTORE J AND ERROR-RETURN
 10381	014766'	254000	016722'		]
 10382	014767'	135300	000202'		LDB	T1, LDPCOM
 10383	014770'	137300	000242'		DPB	T1, DDPCOM	;SAVE CMND MODE STATE
 10384	014771'	260040	015224'		PUSHJ	P, NAMSCN	;T1 := PORT # FROM RH(DEVNAM)
 10385	014772'	256200	016415'		UMOVEM	T1, (M)		;GIVE IT TO CALLER
 10386	014773'	550100	000014		HRRZ	J, P1		;J/ TARGET FRAME #
 10387	014774'	542200	000015		HRRM	F, P2		;P2/ BITS,,SOURCE DDB
 10388	014775'	321640	015037'		JUMPL	P2, RTATS	;Negative TO ATTACH AS AUX/SLAVE PORT
 10389				    ;HERE TO ATTACH AS TARGET'S COMMAND PORT
 10390				    ;J/ TARGET JOB #  U/ LDB ADDR
 10391
 10392	014776'	550100	000014	RTATC:	HRRZ	J, P1		;J/ TARGET FRAME #
 10393	014777'	550202	014667*		HRRZ	F, TTYTAB(J)	;F/ 0,,DDB ADDR
 10394	015000'	336000	000004		SKIPN	F		;IF THERE'S NO DDB,
 10395	015001'	256000	000000'		 STOPCD 		;  CRASH
 10396	015002'	500245	000031		HLL	U, LDBDCH(U)
 10397	015003'	603240	000040		TLNE	U, LDLAUX	;IF IT'S AN AUX CIRCUIT,
 10398					 JRST	[
 10399						MOVEI T1, RTAUX%
 10400						JRST RTERJ	;  RESTORE J AND ERROR-RETURN
 10401	015004'	254000	016724'		]
 10402	015005'	550304	000013		HRRZ	T1, DDBLDB(F)
 10403					JUMPN	T1, [		;IF JOB'S ATTACHED ALREADY,
 10404						MOVEI	T1, RTTAT%
 10405						JRST	RTERJ	;  RESTORE J AND ERROR-RETURN
 10406	015006'	326300	016726'		]
 10407
 10408	015007'	200300	014664*		MOVE	T1,TIMRST##
 10409	015010'	137100	014665*		DPB	J,CLKJOB##
 10410	015011'	260040	014666*		PUSHJ	P,CHGCLK	;RESET TIMEOUT-ON-DISCONNECT TIMER
 10411	015012'	260040	015213'		PUSHJ	P,SCNNAM	;DEVNAM(F) := "TTY" & CVOS(LINE#)
 10412	015013'	260040	000000*		PUSHJ	P,LOGLDB##	;Set LDBLOG from UPTLOG if LDBLOG is zero
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 235-2
SCNSER.MAC	25-NOV-87 19:52		RETACH uuo

 10413	015014'	260040	015115'		PUSHJ	P,COMATT	;JOIN F AND U
 10414
 10415	015015'	603640	020000		TLNE	P2,RT.CON	;User want us to force CONTINUE on target?
 10416	015016'	260040	014725'		 PUSHJ	P,RTCONT	;yes - go do it
 10417
 10418	015017'	135300	016730'		LDB	T1, RTYMOD<P2>	;T1/ LDLCOM "MODE"
 10419					JRST	@[
 10420						RTCSV		;0  .RTCSV  FORCE SAVED MODE
 10421						RTFIN		;1  .RTCCU  RETAIN CURRENT MODE
 10422						RTCCO		;2  .RTCCO  FORCE COMMAND MODE
 10423						RTCUS		;3  .RTCUS  FORCE USER MODE
 10424	015020'	254026	016731'		](T1)
 10425
 10426	015021'	205300	040000	RTCSV:	MOVSI	T1, DCLCOM
 10427	015022'	616304	000012		TDNN	T1, DDBDCH(F)	;CHECK SAVED LDLCOM SETTING
 10428	015023'	254000	015025'		JRST	RTCUS		;WAS 0 -- FORCE USER MODE
 10429	015024'	254000	015031'		JRST	RTCCO		;WAS 1 -- FORCE CMND MODE
 10430
 10431	015025'	205300	020000	RTCUS:	MOVSI	T1, LDLCOM
 10432	015026'	412305	000031		ANDCAM	T1, LDBDCH(U)	;CLEAR COMMAND MODE
 10433	015027'	260040	007534'		PUSHJ	P, SETLMD	;FIX LINE MODE FIELD
 10434	015030'	254000	015070'		JRST	RTFIN
 10435
 10436	015031'	205300	020000	RTCCO:	MOVSI	T1,LDLCOM
 10437	015032'	612305	000031		TDNE	T1,LDBDCH(U)	;IF NOT ALREADY AT CMND MODE,
 10438	015033'	254000	015070'		JRST	RTFIN
 10439	015034'	260040	014716*		PUSHJ	P,PRPRMT##	;  PRINT A PROMPT
 10440	015035'	260040	013475'		PUSHJ	P,CNCMOD	;  FORCE TO CMND MODE
 10441	015036'	254000	015070'		JRST	RTFIN
 10442
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 236
SCNSER.MAC	25-NOV-87 19:52		RETACH uuo

 10443				    ;HERE TO ATTACH AS A SLAVE PORT TO TARGET
 10444				    ;J/ TARGET JOB #  U/ LDB ADDR
 10445
 10446	015037'	135200	000153'	RTATS:	LDB	F, LDPLNO	;F/ PORT #
 10447	015040'	260040	015541'		PUSHJ	P, FNDPRT	;F/ DDB FOR PORT. IF THERE ISN'T ONE,
 10448	015041'	254000	015052'		JRST	RTATS1		;  GO ALLOCATE A DDB
 10449	015042'	550300	000015		HRRZ	T1, P2		;T1/ SOURCE DDB
 10450	015043'	306304	000000		CAIN	T1, (F)		;IF IT'S THE SAME AS THE TARGET,
 10451	015044'	254000	015052'		JRST	RTATS1		;  ALWAYS ALLOCATE A NEW ONE
 10452
 10453				    ;USING EXISTING DDB
 10454
 10455	015045'	550304	000013		HRRZ	T1, DDBLDB(F)
 10456					JUMPN	T1, [		;IF ALREADY ATTACHED,
 10457						MOVEI	T1, RTTAT%
 10458						JRST	RTERJ	;RESTORE J AND ERROR-RETURN
 10459	015046'	326300	016726'		]
 10460	015047'	201300	646471		MOVEI	T1, (SIXBIT/TTY/)
 10461	015050'	506304	000000		HRLM	T1, DEVNAM(F)
 10462	015051'	254000	015063'		JRST	RTATS2
 10463
 10464				    ;ALLOCATING NEW DDB
 10465
 10466	015052'	550302	014777*	RTATS1:	HRRZ	T1, TTYTAB(J)	;T1/ TARGET CMND PORT DDB
 10467	015053'	336000	000006		SKIPN	T1		;IF THERE IS NONE,
 10468	015054'	256000	000000'		 STOPCD 		;  CRASH
 10469	015055'	260040	015147'		PUSHJ	P, DDBSR1	;F/ NEW DDB, LINKED AFTER CMND PORT.
 10470					  JRST	[		;IF THERE'S NO ROOM FOR ONE,
 10471						MOVEI T1, RTNRM%
 10472						JRST RTERJ	;  RESTORE J AND ERROR-RETURN
 10473	015056'	254000	016735'		]
 10474	015057'	137100	014663*		DPB	J, PJOBN	;SET JOB #
 10475	015060'	260040	015213'		PUSHJ	P, SCNNAM	;AND PHYSICAL NAME
 10476	015061'	201300	400000		MOVEI	T1, ASSCON
 10477	015062'	436304	000004		IORM	T1, DEVMOD(F)	;MARK IT ASSIGNED-BY-CONSOLE
 10478
 10479				    ;ATTACH IT
 10480
 10481	015063'	205300	020000	RTATS2:	MOVSI	T1, LDLCOM
 10482	015064'	412305	000031		ANDCAM	T1, LDBDCH(U)	;MAKE SURE IT'S NOT IN COMMAND MODE
 10483	015065'	205300	020000		MOVSI	T1, TTYATC
 10484	015066'	412304	000004		ANDCAM	T1, DEVMOD(F)	;MARK IT AS A NONCOMMAND PORT
 10485	015067'	260040	015115'		PUSHJ	P, COMATT	;JOIN F AND U
 10486					PFALL	RTFIN
 10487				    ;DETACH THE SOURCE END
 10488
 10489	015070'	554100	000014	RTFIN:	HLRZ	J, P1		;J/ SOURCE FRAME #
 10490	015071'	550200	000015		HRRZ	F, P2		;F/ SOURCE DDB
 10491	015072'	513004	000013		HLLZS	DDBLDB(F)	;DETACH SOURCE
 10492	015073'	553004	000000		HRRZS	DEVNAM(F)	;MAKE IT LOOK DETACHED
 10493	015074'	205300	020000		MOVSI	T1, TTYATC
 10494	015075'	616304	000004		TDNN	T1, DEVMOD(F)	;WAS SOURCE A COMMAND OR A SLAVE PORT?
 10495	015076'	254000	015103'		 JRST	RTFIN1		;(AUX/SLAVE)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 236-2
SCNSER.MAC	25-NOV-87 19:52		RETACH uuo

 10496
 10497				    ;HERE WHEN WE'VE DETACHED SOURCE'S COMMAND PORT
 10498
 10499	015077'	607640	040000		TLNN	P2, RT.SIG	;IF WE'RE SIGNALLING A HANGUP,
 10500	015100'	254000	000000*		 JRST	IPOPJ1
 10501	015101'	260040	006572'		PUSHJ	P, HNGTTY	;  FORCE A DETACHED-JOB HANGUP
 10502								; J has job #
 10503	015102'	254000	015100*		JRST	IPOPJ1
 10504
 10505				    ;HERE WHEN WE'VE DETACHED AN AUX/SLAVE PORT
 10506
 10507	015103'	607640	040000	RTFIN1:	TLNN	P2, RT.SIG	;IF WE'RE SIGNALLING A HANGUP,
 10508	015104'	254000	015107'		 JRST	RTFIN2
 10509	015105'	135300	000230'		LDB	T1, DDPTZP
 10510	015106'	260040	011012*		PUSHJ	P, TAKTRJ	;  CAUSE A ZAPPED INTERRUPT
 10511	015107'	201340	400000	RTFIN2:	MOVEI	T2, ASSCON
 10512	015110'	260040	011014*		PUSHJ	P, RELEA6	;TRY TO FREE THE DDB
 10513	015111'	254000	015102*		JRST	IPOPJ1
 10514	
 10515				    ;ERROR-RETURNS
 10516
 10517	015112'	262040	000002	RTERJ:	POP	P, J		;RESTORE J
 10518	015113'	256200	016415'	RTERR:	UMOVEM	T1, (M)		;STORE ERROR CODE
 10519	015114'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 237
SCNSER.MAC	25-NOV-87 19:52		COMATT - PERFORMS THE FUNCTIONS COMMON TO ALL ATTACH FUNCTIONS:

 10520				SUBTTL	COMATT - PERFORMS THE FUNCTIONS COMMON TO ALL ATTACH FUNCTIONS:
 10521				;	     LINKS LDBDDB(U) AND DDBLDB(F)
 10522				;	     SETS NEED-OUTPUT BIT OF LDB SO ATTACHEE WILL BE AWAKENED
 10523				;	     SETS NON-DEVIOS LDB DEVICE CHARACTERISTIC BITS
 10524				;	     CALLS UUOLDB TO SET DEVIOS DEVICE CHARACTERISTIC BITS
 10525				;	   F/ DDB ADDR  U/ LDB ADDR
 10526				;	   DESTROYS T1-T4
 10527
 10528	015115'	602200	777777	COMATT:	TRNE	F, -1
 10529	015116'	606240	777777		TRNN	U, -1
 10530	015117'	256000	000000'		 STOPCD 		;MUST HAVE A DDB AND AN LDB
 10531	015120'	542244	000013		HRRM	U, DDBLDB(F)
 10532	015121'	542205	000000		HRRM	F, LDBDDB(U)	;DO THE ATTACH
 10533	015122'	201300	000001		MOVEI	T1, 1
 10534	015123'	137305	000002		DPB	T1, LDBOPB(U)	;SET NEED-OUTPUT
 10535	015124'	135300	000240'		LDB	T1, DDPIMB
 10536	015125'	137300	000177'		DPB	T1, LDPIMB	;SET IMAGE-MODE BREAK CHARACTER
 10537	015126'	200404	000012		MOVE	T3, DDBDCH(F)
 10538	015127'	200305	000027		MOVE	T1, LDBBYT(U)
 10539	015130'	607400	100000		TLNN	T3, DCLNTB	;NO HT/VT/FF ECHO
 10540	015131'	625300	020000		TLZA	T1, L2LNTB
 10541	015132'	661300	020000		TLO	T1, L2LNTB
 10542	015133'	202305	000027		MOVEM	T1, LDBBYT(U)
 10543	015134'	201300	100000		MOVEI	T1, L2LTBK	;TABS-AS-BREAKS
 10544	015135'	603400	200000		TLNE	T3, DCLTBK
 10545	015136'	505300	100000		HRLI	T1, L2LTBK
 10546	015137'	260040	007540'		PUSHJ	P, SETTBK
 10547	015140'	201300	040000		MOVEI	T1, L2LBBP	;BACKSPACE-AS-NONBREAK
 10548	015141'	603400	400000		TLNE	T3, DCLBBP
 10549	015142'	505300	040000		HRLI	T1, L2LBBP
 10550	015143'	260040	007540'		PUSHJ	P, SETTBK
 10551	015144'	200004	000002		MOVE	S, DEVIOS(F)
 10552	015145'	324740	013004'		PJRST	UUOLDB		;SET DEVIOS-DEPENDENT LDB BITS
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 238
SCNSER.MAC	25-NOV-87 19:52		ROUTINE TO FIND A FREE TTY DEVICE DATA BLOCK

 10553				SUBTTL	ROUTINE TO FIND A FREE TTY DEVICE DATA BLOCK
 10554
 10555				;CALL FROM CLOCK LEVEL TO DO AN ATTACH ON A NEW JOB, OR
 10556				;FROM UUO LEVEL ON AN INIT OF A NEW LINE.
 10557
 10558				;CALL:	NO ARGUMENTS
 10559				;	PUSHJ P,DDBSRC
 10560				;	  ERROR RETURN		;NONE AVAILABLE. F=0. T1 CLOBBERED
 10561				;	OK RETURN		;ADDRESS IN F, TTYUSE SET IN DEVMOD
 10562				;				;RESPECTS J,U,CH.
 10563				;				;IF YOU DECIDE NOT TO USE F, YOU BETTER
 10564				;				;FREE IT UP AGAIN.
 10565
 10566	015146'	200300	015734'	DDBSRC:	MOVE T1,TTYFLK	;WHERE TO LINK IN
 10567	015147'	550200	015733'	DDBSR1:	HRRZ F,FRETTY	;HERE IF TO LINK AT SPECIAL SPOT WITH T1 SET
 10568	015150'	322200	014576*		JUMPE F,CPOPJ		;NO DDB'S AVAILABLE
 10569	015151'	554204	000003		HLRZ F,DEVSER(F)	;GET NEXT FREE
 10570	015152'	250200	015733'		EXCH F,FRETTY		;RESTORE F AND UPDATE FREE LIST
 10571	015153'	261046	000003		PUSH P,DEVSER(T1)
 10572	015154'	506206	000003		HRLM F,DEVSER(T1)	;LINK INTO DDB CHAIN
 10573	015155'	506304	000013		HRLM T1,DDBBLK(F)	;PUT IN THE BACK LINK
 10574	015156'	262040	000006		POP P,T1
 10575	015157'	502304	000003		HLLM T1,DEVSER(F)	;NOW LINK IT IN
 10576	015160'	207000	000006		MOVSS T1
 10577	015161'	261040	000010		PUSH P,T3
 10578	015162'	200406	000004		MOVE T3,DEVMOD(T1)	;IS THE NEXT ONE DOWN
 10579	015163'	603400	000010		TLNE T3,DVTTY		;ALSO A TTY?
 10580	015164'	506206	000013		HRLM F,DDBBLK(T1)	;YES, RESET ITS BACK LINK
 10581	015165'	262040	000010		POP P,T3
 10582	015166'	200300	016677'		MOVE T1,[XWD TTYATC,ASSCON+ASSPRG]
 10583	015167'	412304	000004		ANDCAM T1,DEVMOD(F)	;TURN OFF USE BITS
 10584	015170'	402004	000005		SETZM DEVLOG(F)		;NO LOGICAL NAME
 10585
 10586			000000	ZZ0==0
 10587				REPEAT <TRPLEN+5>/6,<
 10588					SETZM	DDBTRP+ZZ0(F)
 10589				ZZ0==ZZ0+1>
 10590	015171'	402004	000014
 10591	015172'	402004	000015
 10592
 10593	015173'	205300	000004		MOVSI T1,IOFST
 10594	015174'	137300	015057*		DPB T1,PJOBN		;SET JOB TO 0 (GO FOR IT, BILL!)
 10595	015175'	202304	000002		MOVEM T1,DEVIOS(F)
 10596	015176'	402004	000012		SETZM	DDBDCH(F)	;CLEAR NONDEVIOS DEVICE CHARACTERISTICS
 10597	015177'	254000	014672*		JRST CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 239
SCNSER.MAC	25-NOV-87 19:52		TTYNFR - CALLED WITH J/ FRAME # TO ALLOCATE A NEW

 10598				SUBTTL	TTYNFR - CALLED WITH J/ FRAME # TO ALLOCATE A NEW
 10599				;	   (DETACHED) TTY DDB FOR THE FRAME AND STORE A
 10600				;	   POINTER TO IT IN TTYTAB(J)
 10601				;	   (DEVNAM WILL BE 0,,SIXBIT /TTY/)
 10602				;	   NONSKIP-RETURNS IF NO DDB FREECORE, OTHERWISE SKIP-RETURNS
 10603
 10604	015200'	260040	014006'	TTYNFR::PUSHJ	P, TTYSRC	;IF IT ALREADY HAS A COMMAND PORT DDB,
 10605	015201'	260040	015146'		  PUSHJ	P, DDBSRC	;OR THERE'S NO ROOM TO ALLOCATE ONE,
 10606	015202'	263040	000000		    POPJ P,		;  ERROR-RETURN
 10607	015203'	513004	000013		HLLZS	DDBLDB(F)	;MAKE SURE IT KNOWS IT'S DETACHED
 10608	015204'	201300	646471		MOVEI	T1, (SIXBIT /TTY/)
 10609	015205'	202304	000000		MOVEM	T1, DEVNAM(F)	;SET ITS NAME
 10610	015206'	200300	016707'		MOVE	T1, [TTYATC,,ASSCON]
 10611	015207'	436304	000004		IORM	T1, DEVMOD(F)	;MARK IT AS A COMMAND PORT
 10612	015210'	137100	015174*		DPB	J, PJOBN	;SET ITS OWNER
 10613	015211'	552202	015052*		HRRZM	F, TTYTAB(J)
 10614	015212'	254000	015177*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 240
SCNSER.MAC	25-NOV-87 19:52		SCNNAM - SET DEVNAM(F) TO "TTYNNN" WHERE NNN IS

 10615				SUBTTL	SCNNAM - SET DEVNAM(F) TO "TTYNNN" WHERE NNN IS
 10616				;	   LDPLNO (FETCHED THROUGH U) IN OCTAL
 10617				;	   BREAKS T1 T3
 10618
 10619	015213'	135300	000153'	SCNNAM:	LDB T1,LDPLNO
 10620	015214'	137300	000000*		DPB T1,PUNIT
 10621	015215'	205400	646471		MOVSI T3,(SIXBIT /TTY/)
 10622	015216'	202404	000000		MOVEM T3,DEVNAM(F)
 10623	015217'	200400	016737'		MOVE T3,[POINT 6,DEVNAM(F),17]
 10624	015220'	261040	000007		PUSH P,T2		;SCNNMR CLOBBERS THIS ONE
 10625	015221'	260040	014130'		PUSHJ P,SCNNMR		;RADIX PRINT TO CORE
 10626	015222'	262040	000007		POP P,T2
 10627	015223'	263040	000000		POPJ P,
 10628
 10629				;NAMSCN - CALLED WITH F/ TTY DDB
 10630				;	   RETURNS WITH T1/ PORT# FROM RH(DEVNAM)
 10631
 10632	015224'	261040	000007	NAMSCN:	PUSH	P, T2
 10633	015225'	400300	000000		SETZ	T1,
 10634	015226'	514344	000000		HRLZ	T2, DEVNAM(F)
 10635	015227'	311340	016672'	NAMSC1:	CAML	T2, [200000,,000000]
 10636	015230'	313340	016740'		CAMLE	T2, [272727,,000000]
 10637	015231'	254000	015235'		JRST	NAMSC2
 10638	015232'	242340	000003		LSH	T2, 3
 10639	015233'	246300	000003		LSHC	T1, 3
 10640	015234'	254000	015227'		JRST	NAMSC1
 10641	015235'	262040	000007	NAMSC2:	POP	P, T2
 10642	015236'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 241
SCNSER.MAC	25-NOV-87 19:52		TRAP CODE

 10643				SUBTTL TRAP CODE
 10644
 10645				;CHECK FOR CHARACTER TRAP
 10646
 10647	015237'	603240	020000	CHRTRP:	TLNE U,LDLCOM
 10648	015240'	263040	000000		POPJ P,		;NEVER AT COMMAND MODE
 10649	015241'	201300	010000		MOVEI T1,LXRCHR
 10650	015242'	436305	000032		IORM T1,LDBDCX(U)	;SET BIT FOR POLPRT
 10651	015243'	550205	000000		HRRZ F,LDBDDB(U)
 10652	015244'	322200	015150*		JUMPE F,CPOPJ	;NO TRAP IF NO DDB
 10653	015245'	135300	000222'		LDB T1,DDPTCH
 10654	015246'	201340	000400		MOVEI T2,FLGCHR	;AND SET THE FLAG IN CASE OLD TYPE
 10655	015247'	324740	000000*		PJRST TAKOTJ
 10656
 10657				;NOW FOR A LINE TRAP
 10658
 10659	015250'	550205	000000	LINTRP:	HRRZ F,LDBDDB(U)	;NEVER CALLED AT COMMAND LEVEL
 10660	015251'	322200	015244*		JUMPE F,CPOPJ
 10661	015252'	201300	004000		MOVEI T1,LXRBRK
 10662	015253'	436305	000032		IORM T1,LDBDCX(U)	;SET BIT FOR POLPRT
 10663	015254'	261040	000007		PUSH P,T2	;MUST PRESERVE T2
 10664	015255'	135300	000223'		LDB T1,DDPTLN
 10665	015256'	201340	004000		MOVEI T2,FLGLIN
 10666	015257'	260040	015247*		PUSHJ P,TAKOTJ
 10667	015260'	262040	000007		POP P,T2
 10668	015261'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 242
SCNSER.MAC	25-NOV-87 19:52		CALLED ON AN ESCAPE TO SEE IF WE SHOULD SET TRAP

 10669				SUBTTL	CALLED ON AN ESCAPE TO SEE IF WE SHOULD SET TRAP
 10670
 10671	015262'	603240	020000	ESCTRP:	TLNE U,LDLCOM
 10672	015263'	263040	000000		POPJ P,		;NEVER IN COMMAND MODE
 10673	015264'	201300	400000		MOVEI T1,LXRESC
 10674	015265'	436305	000032		IORM T1,LDBDCX(U)	;SET BIT FOR POLPRT
 10675	015266'	550205	000000		HRRZ F,LDBDDB(U)
 10676	015267'	322200	015251*		JUMPE F,CPOPJ
 10677	015270'	261040	000006		PUSH P,T1		;JUST LIKE CODE ABOVE
 10678	015271'	135300	000221'		LDB T1,DDPTSC
 10679	015272'	205340	000001		MOVSI T2,FLGESC
 10680	015273'	260040	000000*		PUSHJ P,TAKNZJ		;TAKE THIS TRAP IF REALLY ENABLED
 10681	015274'	254000	014705*		 JRST TPOPJ		;NOT ENABLED
 10682	015275'	262040	000006		POP P,T1		;ENABLED
 10683	015276'	254000	015274*		JRST TPOPJ		;RETURN UP A LEVEL TO IGNORE CHR
 10684
 10685				;CALLED FROM TYI WHEN AN ESCAPE IS READ TO CHECK ABOUT TRAPPING
 10686
 10687	015277'	261040	000006	ESCTR1:	PUSH P,T1		;FOUND ESCAPE READING CHRS
 10688	015300'	201300	400000		MOVEI T1,LXRESC
 10689	015301'	436305	000032		IORM T1,LDBDCX(U)	;SET BIT FOR POLPRT
 10690	015302'	135300	000221'		LDB T1,DDPTSC
 10691	015303'	205340	000001		MOVSI T2,FLGESC
 10692	015304'	260040	015273*		PUSHJ P,TAKNZJ		;TRY THE TRAP
 10693	015305'	254000	015276*		 JRST TPOPJ	;NOT ENEABLED
 10694	015306'	254000	013147*		JRST ABTUUO		;ABORT THE UUO. IF ALREADY IN
 10695							;HIGHER TRAP WE WILL JUST DO THE INPUT
 10696							;AGAIN
 10697
 10698				;CALLED WHEN AN ORANGE BALL IS RECEIVED TO CHECK ON TRAPS
 10699
 10700	015307'	201300	200000	OBREC:	MOVEI	T1, LXROBS
 10701	015310'	436305	000032		IORM	T1, LDBDCX(U)	; SET "ORANGE BALL SEEN" BIT
 10702	015311'	550205	000000		HRRZ F,LDBDDB(U)	;GOT AN ORANGE BALL. DDB THERE?
 10703	015312'	322200	015267*		JUMPE F,CPOPJ		;NO
 10704	015313'	135300	000227'		LDB T1,DDPTOB		;GET THE CHANNEL NUMBER
 10705	015314'	254000	015304*		JRST TAKNZJ		;AND SET UP TO TRAP
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 243
SCNSER.MAC	25-NOV-87 19:52		ROUTINE TO TAKE A JOB OUT OF TIOW FOR A TRAP

 10706				SUBTTL	ROUTINE TO TAKE A JOB OUT OF TIOW FOR A TRAP
 10707
 10708	015315'	261040	000004	TTYWAK::PUSH P,F
 10709	015316'	261040	000000		PUSH P,S
 10710	015317'	260040	015337'		PUSHJ P,FRSTTY	;FIND THE FIRST TTY FOR THIS JOB
 10711	015320'	254000	015334'		 JRST TTYWK1	;NONE THERE, MUST NOT RALLY BE IN IOW
 10712	015321'	200004	000002	TTYWK2:	MOVE S,DEVIOS(F)
 10713	015322'	260040	006005'		PUSHJ P,TIWAKE	;WAKE HIM UP IF IN IOW
 10714	015323'	261040	000005		PUSH P,U
 10715	015324'	550244	000013		HRRZ U,DDBLDB(F)
 10716	015325'	322240	015330'		JUMPE U,TTYWK3	;NOT ATTACHED, NOTHING WE CAN DO
 10717	015326'	205000	400000		MOVSI S,L2LOEX	;SET EXTENDED OUTPUT BUFFER ING SO
 10718	015327'	436005	000027		IORM S,LDBBYT(U)	;JOB CAN FINISH UUO
 10719	015330'	262040	000005	TTYWK3:	POP P,U
 10720	015331'	260040	015341'		PUSHJ P,NXTTTY
 10721	015332'	334000	000000		 SKIPA		;NEXT TTY NOT THERE
 10722	015333'	254000	015321'		JRST TTYWK2	;TRY THE NEXT ONE
 10723	015334'	262040	000000	TTYWK1:	POP P,S		;FINISHED
 10724	015335'	262040	000004		POP P,F
 10725	015336'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 244
SCNSER.MAC	25-NOV-87 19:52		ROUTINES TO FIND A JOB'S TTY DDBS

 10726				SUBTTL	ROUTINES TO FIND A JOB'S TTY DDBS
 10727
 10728	015337'	550202	015211*	FRSTTY:	HRRZ F,TTYTAB(J)	;FIRST ONE SHOULD BE THE CONTROLING TTY
 10729	015340'	334000	000000		SKIPA
 10730	015341'	554204	000003	NXTTTY:	HLRZ F,DEVSER(F)	;IF WANT THE NEXT, FOLLOW CHAIN
 10731	015342'	322200	015312*		JUMPE F,CPOPJ		;DONE
 10732	015343'	200004	000004		MOVE S,DEVMOD(F)
 10733	015344'	607000	004010		TLNN S,DVTTY!DVRMT	;IS IT STILL A TTY OR RMT
 10734	015345'	263040	000000		POPJ P,			;NO
 10735	015346'	135000	015210*		LDB S,PJOBN
 10736	015347'	316000	000002		CAMN S,J		;FOR THIS JOB?
 10737	015350'	350001	000000		AOS (P)		;YES, SKIP RETURN
 10738	015351'	263040	000000		POPJ P,			;NO, FOUND THEM ALL
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 245
SCNSER.MAC	25-NOV-87 19:52		ROUTINE TO CLEAR SLEEP CONDITIONS FOR ALL TTYS

 10739				SUBTTL	ROUTINE TO CLEAR SLEEP CONDITIONS FOR ALL TTYS
 10740
 10741	015352'	261040	000004	TTSCLR::PUSH	P,F
 10742	015353'	261040	000000		PUSH	P,S
 10743	015354'	201340	000000		MOVEI	T2,0
 10744	015355'	135000	000000*		LDB	S,JBYWAK##	;GET WAKE CHANNEL
 10745	015356'	306000	000044		CAIN	S,^D36		;HIBER CODE?
 10746	015357'	137340	015355*		 DPB	T2,JBYWAK##	;YES, CLEAR IT
 10747	015360'	135000	000000*		LDB	S,JBYEXC##	;GET EXIT IN CHILD CHANNEL
 10748	015361'	306000	000044		CAIN	S,^D36		;HIBER CODE?
 10749	015362'	137340	015360*		 DPB	T2,JBYEXC##	;YES, CLEAR IT
 10750	015363'	260040	015337'		PUSHJ	P,FRSTTY
 10751	015364'	254000	015334'		  JRST	TTYWK1		;ALL DONE, (NO TTYS)
 10752	015365'	205000	004000	TTSCL2:	MOVSI	S,DVRMT
 10753	015366'	612004	000004		TDNE	S,DEVMOD(F)
 10754	015367'	254000	015413'		 JRST	TTSCL3		;DO NOT CLEAR FOR RMTS
 10755	015370'	135000	000222'		LDB	S,DDPTCH
 10756	015371'	306000	000044		CAIN	S,^D36		;IS THIS A SLEEP CODE?
 10757	015372'	137340	000222'		 DPB	T2,DDPTCH	;YES, CLEAR IT
 10758	015373'	135000	000223'		LDB	S,DDPTLN
 10759	015374'	306000	000044		CAIN	S,^D36
 10760	015375'	137340	000223'		 DPB	T2,DDPTLN	;NOW FOR LINE
 10761	015376'	261040	000005		PUSH	P,U
 10762	015377'	550244	000013		HRRZ	U,DDBLDB(F)	;GET LINK TO LDB
 10763	015400'	322240	015412'		JUMPE	U,TTSCL1	;NONE THERE, FINISHED THIS TTY
 10764	015401'	135000	000227'		LDB	S,DDPTOB	;WAITING FOR ORANGE BALL
 10765	015402'	306000	000044		CAIN	S,^D36
 10766	015403'	137340	000227'		 DPB	T2,DDPTOB	;CCLEAR SLEEP
 10767	015404'	135000	000223'		LDB	S,DDPTLN	;LINE
 10768	015405'	306000	000044		CAIN	S,^D36
 10769	015406'	137340	000223'		 DPB	T2,DDPTLN
 10770	015407'	135000	000222'		LDB	S,DDPTCH	;CHARACTER
 10771	015410'	306000	000044		CAIN	S,^D36
 10772	015411'	137340	000222'		 DPB	T2,DDPTCH
 10773	015412'	262040	000005	TTSCL1:	POP	P,U
 10774	015413'	260040	015341'	TTSCL3:	PUSHJ	P,NXTTTY
 10775	015414'	254000	015334'		  JRST	TTYWK1		;FINISHED, GET F AND S BACK AND GO
 10776	015415'	254000	015365'		JRST	TTSCL2		;MORE TO CLEAR
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 246
SCNSER.MAC	25-NOV-87 19:52		ROUTINE TO CLEAR ALL TRAP CONDITIONS FOR ALL TTYS

 10777				SUBTTL	ROUTINE TO CLEAR ALL TRAP CONDITIONS FOR ALL TTYS
 10778
 10779	015416'	261040	000004	TTTCLR::PUSH P,F
 10780	015417'	261040	000000		PUSH P,S
 10781	015420'	260040	015337'		PUSHJ P,FRSTTY
 10782	015421'	254000	015334'		 JRST TTYWK1	;NO MORE TTYS THERE
 10783	015422'			TTTCL1:
 10784				;*;	MOVSI S,DVRMT
 10785				;*;	TDNE S,DEVMOD(F)
 10786				;*;	 JRST	[PUSHJ P,RMTRSI	;RESET FOR REMOTE
 10787				;*;		JRST TTTCL2]
 10788
 10789			000000	ZZ0==0
 10790				REPEAT <TRPLEN+5>/6,<
 10791					SETZM	DDBTRP+ZZ0(F)
 10792				ZZ0==ZZ0+1>
 10793	015422'	402004	000014
 10794	015423'	402004	000015
 10795
 10796	015424'	260040	015341'	TTTCL2:	PUSHJ P,NXTTTY		;FIND THE NEXT ONE FOR THIS JOB
 10797	015425'	254000	015334'		 JRST TTYWK1		;DONE
 10798	015426'	254000	015422'		JRST TTTCL1		;CLEAR IT ALSO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 247
SCNSER.MAC	25-NOV-87 19:52		THIS ROUTINE ASSIGNES TRAP CHANNELS TO TTY TRAP CONDS

 10799				SUBTTL	THIS ROUTINE ASSIGNES TRAP CHANNELS TO TTY TRAP CONDS
 10800				;CALLED WITH T3 CHANNEL NUMBER
 10801				;	T2 TRAP NUMBER
 10802				;	F TTY DDB
 10803				;	SKIP RETURN IF TRAP CONDITION NOW SATISFIED
 10804
 10805	015427'	135307	000221'	TINAS1::LDB T1,DDPTAB(T2)	;GET CURRENT
 10806	015430'	303400	000043		CAILE T3,^D35		;REAL INTERRUPT CHANNEL?
 10807	015431'	326300	015342*		 JUMPN T1,CPOPJ		;NO, SLEEP. DON'T CLEAR IF INT. THERE
 10808	015432'	137407	000221'		DPB T3,DDPTAB(T2)	;SET TRAP CONDITION IN DDB
 10809	015433'	322400	015431*		JUMPE T3,CPOPJ		;IF ENABLING, NOT DISABLING,
 10810	015434'	550244	000013		HRRZ U, DDBLDB(F)	;  GET LDB IF THERE IS ONE
 10811	015435'	256007	015437'		XCT INTSET(T2)		;  AND CHECK IF IT'S ALREADY TRUE
 10812	015436'	263040	000000		POPJ P,			;IN CASE WE DO NOT TRANSFER
 10813
 10814				;INTERRUPT TEST TABLE - MUST BE IN THE SAME ORDER AS DDPTAB
 10815
 10816	015437'	263040	000000	INTSET:	POPJ P,		;ESCAPE, WILL GET IT LATER
 10817	015440'	326240	015457'		JUMPN U,CHKCHR	;IF LINE PRESENT, CHECK FOR CHARACTERS
 10818	015441'	326240	015466'		JUMPN U,CKLNTR	;IF LINE PRESENT, CHECK FOR BREAKS
 10819	015442'	263040	000000		POPJ P,		;IOW, NEVER PRESET
 10820	015443'	263040	000000		POPJ P,		;FINISH IO
 10821	015444'	254000	015453'		JRST CHKLOS	;LOST CHARACTERS
 10822	015445'	263040	000000		POPJ P,		;ORANGE BALL, NEVER KNOW
 10823	015446'	263040	000000		POPJ P,		;CIRCUIT ZAPPED
 10824	015447'	326240	015502'		JUMPN U,CHKPSP	;IF LINE PRESENT, CHECK FOR UNREAD PORT-STATUS
 10825	015450'	326240	015517'		JUMPN U,CHKYEL	;YELLOW BALL, PERHAPS ONE IS PENDING
 10826	015451'	263040	000000		POPJ P,		;CHARACTER GOBBLER, NOT BUFFERED
 10827	015452'	326240	015506'		JUMPN U,CHKTCC	;IF LINE PRESENT, CHECK FOR CHANGED TC'S
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 248
SCNSER.MAC	25-NOV-87 19:52		ROUTINES TO CHECK IF TRAP CONDITION ALREADY SATISFIED

 10828				SUBTTL	ROUTINES TO CHECK IF TRAP CONDITION ALREADY SATISFIED
 10829
 10830				; CHECK IF CHARACTERS LOST (BY READING IO.BKT)
 10831
 10832	015453'	200004	000002	CHKLOS:	MOVE S,DEVIOS(F)
 10833	015454'	602000	040000		TRNE S,IOBKTL
 10834	015455'	350001	000000		AOS (P)		;BIT ALREADY SET CAN TRAP NOW
 10835	015456'	263040	000000		POPJ P,
 10836
 10837				; CHECK IF CHARACTERS PRESENT (BY READING LDB COUNTS)
 10838
 10839	015457'	500245	000031	CHKCHR:	HLL U,LDBDCH(U)
 10840	015460'	603240	020000		TLNE U,LDLCOM
 10841	015461'	263040	000000		POPJ P,		;NOT SAT AT INTERRUPT LEVEL
 10842	015462'	337005	000014		SKIPG LDBECC(U)	;CHRS TO BE ECHOED
 10843	015463'	333005	000012		SKIPLE LDBTIC(U)	;OR ALREDY ECHOED
 10844	015464'	350001	000000		AOS (P)		;YES
 10845	015465'	263040	000000		POPJ P,
 10846
 10847				; CHECK IF A BREAK CHARACTER IS PRESENT (BY READING LDB COUNTS)
 10848
 10849	015466'	500245	000031	CKLNTR:	HLL U,LDBDCH(U)
 10850	015467'	603240	020000		TLNE U,LDLCOM
 10851	015470'	263040	000000		 POPJ P,
 10852	015471'	200305	000012		MOVE T1,LDBTIC(U)
 10853	015472'	270305	000014		ADD T1,LDBECC(U)	;ENOUGH?
 10854	015473'	301300	000110		CAIL T1,TIWKC
 10855	015474'	254000	015212*		 JRST CPOPJ1		;YES
 10856	015475'	603240	004000		TLNE U,LDLBK2	;WHICH BREAK SET
 10857	015476'	337005	000016		 SKIPG LDBBK2(U)
 10858	015477'	333005	000015		SKIPLE LDBBKC(U)	;TEST CORRECT ONE(S)
 10859	015500'	350001	000000		 AOS (P)
 10860	015501'	263040	000000		POPJ P,
 10861
 10862				; CHECK IF A PORT STATUS MESSAGE IS WAITING TO BE READ
 10863				;See comment at ACPSM
 10864
 10865	015502'	205300	200000	CHKPSP:	MOVSI	T1, LMLPSP
 10866	015503'	603305	000030		TLNE	T1, LDBMOD(U)	; IS THERE A MESSAGE WAITING?
 10867	015504'	350001	000000		 AOS	(P)		; YES
 10868	015505'	263040	000000		POPJ	P,
 10869
 10870				; CHECK IF ANY TERMINAL CHARACTERISTICS HAVE CHANGED
 10871
 10872	015506'	500245	000031	CHKTCC:	HLL	U, LDBDCH(U)
 10873	015507'	616240	040000		TDNN	U, LDLPTY	;IF IT'S NOT A PTY,
 10874	015510'	263040	000000		 POPJ	P,		;  OF COURSE NOT
 10875	015511'	261040	000005		PUSH	P, U
 10876	015512'	260040	007675'		PUSHJ	P, PTYBUD
 10877	015513'	332005	000004		SKIPE	LDBTCB(U)	;ANY UNREAD CHANGES?
 10878	015514'	350001	777777		AOS	-1(P)		;(YES)
 10879	015515'	262040	000005		POP	P, U
 10880	015516'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 248-2
SCNSER.MAC	25-NOV-87 19:52		ROUTINES TO CHECK IF TRAP CONDITION ALREADY SATISFIED

 10881
 10882
 10883				; Test for Yellow ball interrupt condition satisfied:
 10884				;   Skip return if a Yellow ball has been received and no Orange ball
 10885				;   has yet been sent.  If an Orange ball is waiting to be output, it
 10886				;   must be due to a Yellow ball being received while the interrupt
 10887				;   was not enabled.  If the interrupt was enabled, the user will have
 10888				;   already taken the trap.
 10889
 10890	015517'	135300	000102'	CHKYEL:	LDB	T1,LOPSOG	;is OB waiting to be output?
 10891	015520'	626300	000001		TRZN	T1,1		;if so, recall it...
 10892	015521'	263040	000000		 POPJ	P,
 10893	015522'	137300	000102'		DPB	T1,LOPSOG	;its now the user's responsibility
 10894	015523'	205300	004000		MOVSI	T1,LXLOOK	
 10895	015524'	436305	000032		IORM	T1,LDBDCX(U)	;okay for user to send an orange ball
 10896	015525'	350001	000000		AOS	(P)		
 10897	015526'	263040	000000		POPJ	P,
 10898
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 249
SCNSER.MAC	25-NOV-87 19:52		SEND A YELLOW BALL

 10899				SUBTTL	SEND A YELLOW BALL
 10900
 10901	015527'	550244	000013	TTYYLS::HRRZ	U, DDBLDB(F)
 10902	015530'	322240	015433*		JUMPE	U, CPOPJ
 10903	015531'	261040	000006		PUSH	P, T1		;SAVE T1
 10904	015532'	201300	000001		MOVEI	T1, 1
 10905	015533'	137300	000075'		DPB	T1, LOPSYL	;SET SEND-YELLOW
 10906	015534'	137305	000002		DPB	T1, LDBOPB(U)	;AND NEED-OUTPUT
 10907	015535'	254000	015305*		JRST	TPOPJ		;RESTORE T1 AND RETURN
 10908
 10909	015536'	205000	040000	SETFIO:	MOVSI S,TINFIO
 10910	015537'	437004	000002		IORB S,DEVIOS(F)	;SET A FLAG SO WE KNOW WE TRAPPED
 10911								;INSTEAD OF GOING INTO IOW
 10912	015540'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 250
SCNSER.MAC	25-NOV-87 19:52		FNDPRT - CALLED WITH J/ JOB #, F/ -1 OR PORT #

 10913				SUBTTL	FNDPRT - CALLED WITH J/ JOB #, F/ -1 OR PORT #
 10914				;	   LOOKS FOR A DDB FOR THAT PORT/JOB (-1 IS CMND PORT)
 10915				;	   NONSKIP-RETURNS IF THERE IS NONE
 10916				;	   SKIP-RETURNS WITH F/ DDB ADDR IF THERE IS
 10917
 10918				FNDPRT::JUMPL	F,[HRRZ F,TTYTAB(J)	;COMMAND PORT
 10919	015541'	321200	016741'			   JRST FNDPT1]
 10920	015542'	301200	014107*		CAIL	F,PORTN##
 10921	015543'	263040	000000		 POPJ	P,		;MUST NOT BE THERE
 10922	015544'	200204	014111*		MOVE	F,LINTAB(F)
 10923	015545'	550204	000000		HRRZ	F,LDBDDB(F)
 10924	015546'	322200	015530*	FNDPT1:	JUMPE	F,CPOPJ		;NO DDB ATTACHED
 10925	015547'	261040	000006		PUSH	P,T1
 10926	015550'	135300	015346*		LDB	T1,PJOBN
 10927	015551'	312300	000002		CAME	T1,J		;THIS JOB?
 10928	015552'	254000	015535*		 JRST	TPOPJ		;NO
 10929	015553'	254000	014327*		JRST	TPOPJ1		;YES
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 251
SCNSER.MAC	25-NOV-87 19:52		TINASS UUO - ASSIGN TTY INTERRUPTS

 10930				SUBTTL	TINASS UUO - ASSIGN TTY INTERRUPTS
 10931				;(MOST OF THE WORK IS DONE IN TINAS1)
 10932
 10933	015554'	135400	016743'	TINASS::LDB T3,[POINT 9,T1,17]	;GET THE CHANNEL NUMBER
 10934	015555'	307400	000043		CAIG T3,^D35
 10935	015556'	335002	000000*		SKIPGE JBTPIP(J)	;IF TOO LARGE OR NO INTADR
 10936	015557'	263040	000000		POPJ P,			;TAKE ERROR RETURR
 10937	015560'	550202	015337*		HRRZ F,TTYTAB(J)
 10938	015561'	550204	000013		HRRZ F,DDBLDB(F)
 10939	015562'	322200	015566'		JUMPE F,TINDET		;DETACHED, OK
 10940	015563'	205340	200000		MOVSI T2,LLLZAP
 10941	015564'	612344	000026		TDNE T2,LDBLOG(F)
 10942	015565'	263040	000000		 POPJ P,		;CAN NOT SET IF WAITING FOR LOGUT
 10943	015566'	570200	000006	TINDET:	HRRE F,T1
 10944	015567'	260040	015541'		PUSHJ P,FNDPRT
 10945	015570'	263040	000000		 POPJ P,		;BAD PORT NUMBER
 10946	015571'	135340	016744'		LDB T2,[POINT 9,T1,8]	;GET INTERRUPT NUMBER
 10947	015572'	301340	000014		CAIL T2,TRPLEN		;TOO LARGE?
 10948	015573'	263040	000000		POPJ P,		;YES
 10949	015574'	260040	015427'		PUSHJ P,TINAS1		;GO ASSIGN
 10950	015575'	254000	007354'		 JRST STOTC1		;GOT IT, GIVE BACK OLD
 10951	015576'	261040	000006		PUSH P,T1		;CONDITION SAT, SAVE OLD CHANNEL
 10952	015577'	200300	000010		MOVE T1,T3
 10953	015600'	260040	006611*		PUSHJ P,TAKTRP	;TAKE THE TRAP
 10954	015601'	262040	000006		POP P,T1
 10955	015602'	254000	007354'		JRST STOTC1		;AND RETURN THE ANSWER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 252
SCNSER.MAC	25-NOV-87 19:52		INITIALIZE

 10956				SUBTTL	INITIALIZE
 10957				;INITIALIZE THE WORLD. THIS ROUTINE DOES NOT MAKE PROPER
 10958				;PROVISION FOR 140 RESTART SINCE THAT ABILITY IS NO LONGER
 10959				;OF ANY IMPORTANCE
 10960
 10961				;Beware, this routine (between TTYINI and TTIEND) is overwritten by
 10962				;hackers to patch running monitors on the assumption that the
 10963				;code is never reentered after system initialization.  Beware
 10964				;if this ever changes!  The CONFIG gettab points to TTYINI as
 10965				;the dynamic patch area.
 10966			015604'	PATCH2=:TTYINI+1	;Make it obvious
 10967
 10968	015603'	402000	015731'	TTYINI::SETZM	INTERM
 10969	015604'	402000	012155*		SETZM	BPREQ		;INITIALLY NO BLOCK PORTS
 10970	015605'	402000	015732'		SETZM	OPRTIM		;START WITH NO ALARM FLAGS SET
 10971	015606'	476000	000625*		SETOM	THSTIM##	;TIMER FLAGS
 10972	015607'	402000	000630*		SETZM	MXTIM##
 10973	015610'	201300	013327'		MOVEI	T1,CCTYI
 10974	015611'	202300	015722'		MOVEM	T1,COMTIA	;SET UP COMMAND READ AND WRITE
 10975	015612'	201300	013322'		MOVEI	T1,CCTYO
 10976	015613'	202300	015723'		MOVEM	T1,COMTOA
 10977	015614'	200600	016745'		MOVE	P1,[POINT 1,LINFLG]	;READY TO SET BYTE PTRS
 10978	015615'	205640	777777*		MOVSI	P2,NMXLIN##-1	;NOW ALL LINES
 10979	015616'	550255	015544*	TTINI2:	HRRZ	U,LINTAB(P2)	;POINT TO LDB
 10980	015617'	205305	000000		MOVSI	T1,LDICLR(U)	;CLEAR IT OUT
 10981	015620'	541305	000001		HRRI	T1,LDICLR+1(U)
 10982	015621'	402005	000000		SETZM	LDICLR(U)
 10983	015622'	251305	000046		BLT	T1,LDICLE(U)
 10984	015623'	137640	000153'		DPB	P2,LDPLNO	;RESTORE LINE NUMBER
 10985	015624'	133000	000014		IBP	P1		;TO POINT TO NEXT BIT
 10986	015625'	202605	000002		MOVEM	P1,LDBOPB(U)
 10987	015626'	402014	000000		SETZM	(P1)		;MAKE SURE FLAG WORD IS 0
 10988	015627'	200415	015616*		MOVE	T3,LINTAB(P2)	;CHECK INITIALIZE BITS
 10989	015630'	336000	000000*		SKIPN	REFLAG		;BUT NOT IF REFRESING
 10990	015631'	607400	000000*		TLNN	T3,TTVINI
 10991	015632'	254000	015660'		 JRST	TTINI3		;NOT RUN INITIA
 10992	015633'	205300	000001		MOVSI	T1,(STAUTO)
 10993	015634'	616300	014414*		TDNN	T1,STATES
 10994	015635'	254000	015660'		 JRST	TTINI3		;DO NOT RUN IF NOT AUTO-RESTART
 10995	015636'	200300	016664'		MOVE	T1,[LLLNLN,,LDLCOM]
 10996	015637'	512305	000026		HLLZM	T1,LDBLOG(U)	;MARK IN (BUT UNKNOWN TO TYMNET)
 10997	015640'	516305	000031		HRLZM	T1,LDBDCH(U)	;SET LOGGED IN AND COMMAND MODE
 10998	015641'	200300	013766*		MOVE	T1,SYSNUM##	;Our host number
 10999	015642'	137300	000154'		DPB	T1,LDPHST	; for job running INITIA (DSKCLN)
 11000	015643'	201300	000001		MOVEI	T1,1
 11001	015644'	137300	000054'		DPB	T1,LOPHSH	;SET HUSH BIT TO SUPRESS OUT MESSAGES
 11002	015645'	402005	000032		SETZM	LDBDCX(U)	;NO EXTENDED BITS ON
 11003	015646'	260040	007534'		PUSHJ	P,SETLMD
 11004	015647'	260040	013772*		PUSHJ	P,FRMASN##	;Assign a Job/frame slot
 11005	015650'	256000	000000'		 STOPCD			;Strictly Fatal
 11006				;;***NOTE*** Can't call TTYATI here since it calls DDBSRC, which
 11007				;;***NOTE*** uses TTYFLK, which points at DEVLST-DEVSER.  This
 11008				;;***NOTE*** in turn means that DEVLST gets smashed when DDB is
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 252-2
SCNSER.MAC	25-NOV-87 19:52		INITIALIZE

 11009				;;***NOTE*** allocated, thus causing TTYINI to get called twice.
 11010				;;***NOTE*** Go please the world.
 11011	015651'	201300	000244'		MOVEI	T1,TTYLST	;Start DDB search from here
 11012	015652'	260040	015147'		PUSHJ	P,DDBSR1	;Get a TTY DDB
 11013	015653'	256000	000000'		 STOPCD 		;No errors allowed here
 11014					PUSHJ	P,[PUSH P,U
 11015	015654'	260040	016746'			   JRST TTYAT1]	;IT'S NOT SUCH A BAD HACK...
 11016	015655'	256000	000000'		 STOPCD 		;Last chance for fatal error...
 11017	015656'	201300	013776*		MOVEI T1,CMFCXI##	;Forced command index for INITIA
 11018				IFKMC<
 11019					SKIPGE KMCDO##		;GREATER OR EQUAL 0 NOT KMC MANUAL MODE
 11020					 MOVEI T1,CMFCKM##	;DO FORCE KMC LOAD
 11021				>;END IFKMC
 11022	015657'	260040	013276'		PUSHJ P,TTFORC
 11023
 11024	015660'	253640	015616'	TTINI3:	AOBJN	P2,TTINI2
 11025	015661'	402000	014422*		SETZM	DEVOPR		;NO OPER YET
 11026	015662'	402000	015724'		SETZM	OPRLDB		;AND HAS NOLDB
 11027	015663'	550300	000000*		HRRZ	T1,TTCLST##	;SET UP FREE LIST
 11028	015664'	402006	000000		SETZM	(T1)		;ZERO OUT FREE LIST
 11029	015665'	201106	000004		MOVEI	J,TTCHKS(T1)	;SET FREE POINTER TO FIRST
 11030	015666'	202100	006176*		MOVEM	J,TTFREE##
 11031	015667'	201106	000001		MOVEI	J,1(T1)
 11032	015670'	504100	000006		HRL	J,T1
 11033	015671'	554400	015663*		HLRZ	T3,TTCLST##	;GET SIZE
 11034	015672'	202400	015712'		MOVEM	T3,TTFREN
 11035	015673'	370000	015712'		SOS	TTFREN		;ONE LESS SINCE NO CHUNCK 0
 11036	015674'	221400	000004		IMULI	T3,TTCHKS
 11037	015675'	271406	000000		ADDI	T3,(T1)
 11038	015676'	251110	777777		BLT	J,-1(T3)	;ZERO ALL OF IT
 11039	015677'	201406	000010		MOVEI	T3,TT2CHK(T1)	;NOW LINK UP
 11040	015700'	200100	015712'		MOVE	J,TTFREN	;NUMBER TO LINK
 11041	015701'	202406	000004	TTINI4:	MOVEM	T3,TTCHKS(T1)
 11042	015702'	271300	000004		ADDI	T1,TTCHKS	;MOVE FORWARD
 11043	015703'	505406	000000		HRLI	T3,(T1)		;SET BACK LINK
 11044	015704'	541406	000010		HRRI	T3,TT2CHK(T1)	;AND FORWARD
 11045	015705'	367100	015701'		SOJG	J,TTINI4	;STORE IF NOT DONE
 11046	015706'	513006	000000		HLLZS	(T1)		;ZERO FORWARD LINK OF LAST ONE
 11047	015707'	263040	000000		POPJ	P,
 11048
 11049			015707'	TTIEND=:.-1  ;end of area used for dynamic patches, see comment at TTYINI:
 11050
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 253
SCNSER.MAC	25-NOV-87 19:52		INITIALIZE

 11051				IFCPU(F3),<
 11052				;ROUTINE TO RESYNC WITH NEXILIS BASE.
 11053				; CALLED FROM AT SYSTEM STARTUP AND WHEN BASE CRASHES.
 11054				
 11055				INTEGER	MWAIT,MZEROS
 11056				
 11057				OPDEF TNCONO [744000,,0]
 11058				OPDEF TNOUT [745000,,0]
 11059				OPDEF TNIN [746000,,0]
 11060				
 11061					NZEROS==300		;Number of zeroes to send to PDP-11
 11062					NWAIT==^D60*^D24	;Number of clock ticks max per zero
 11063				
 11064				
 11065				FNSYNC:	SKIPE	CTYDO##		;If using CTYSIM instead of TYMNET,
 11066					 JRST	CPOPJ1		; say all done
 11067					SKIPG	MZEROS		;Waiting for acceptance?
 11068					 JRST	FNSYN0		; No, try this again -- reset
 11069					TNIN	T1		;Yes, read something
 11070					TLNE	T1,(1B5)	;Skip if not accepted
 11071					 JRST	FNSYN2		; Got a zero, go decrement counter
 11072					SOSLE	MWAIT		;Are we waiting for acceptance?
 11073					 POPJ	P,		;Yes, so wait another tick
 11074				;*;	MOVEI	P1,[BYTE(7)7,15,7,7,7	;CR, no LF because of INITIA
 11075				;*;		ASCIZ \Attempting to resync with network base
 11076				;*;\]
 11077				;*;	JSP	T1,CTYTYP	;Acceptance timeout -- type CTY message
 11078				FNSYN0:	TNCONO	0		;Reset the interface.
 11079								;Turn off input and output to the 11-base
 11080					MOVEI	T1,NZEROS	;Set number of zeroes to TRY to send.
 11081					MOVEM	T1,MZEROS	;Store in counter field
 11082				FNSYN1:	TNOUT	0		;Send a zero
 11083					MOVEI	T1,NWAIT	;Get timeout period in clock tics
 11084					MOVEM	T1,MWAIT	; and store in timeout counter
 11085					POPJ	P,		;Return and wait for another tick
 11086				
 11087				FNSYN2:	SOSLE	MZEROS		;Are we waiting for more zeroes?
 11088					 JRST	FNSYN1		;Yes, send one and read it next tick
 11089					TNCONO	1B34!1B35	;No, all here -- turn on PDP-11 interrupts
 11090					SETZM	BASVER##	;Clear base version number
 11091					JRST	CPOPJ1		; and skip return this time.
 11092				>;END IFCPU(F3)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 254
SCNSER.MAC	25-NOV-87 19:52		VARIABLES

 11093				SUBTTL	 VARIABLES
 11094
 11095				IFKMC<
 11096				BBCNTS:	EXP	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0	;16 WORDS
 11097				BBPAGE:	EXP	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
 11098				       	EXP	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0	;32 WORDS
 11099				TIMMIN:	EXP ^D60
 11100				TIMDRD:	EXP ^D60
 11101				DRMHSI:	0
 11102				DRMSHT:	0
 11103				DRMBRK:	0
 11104				DRMANS:	0
 11105				DRMCLP:	0
 11106				DRMTIM::0 ;SECONDS OF UP TIME
 11107				DRDOW:	0
 11108				SENT41:	EXP 0,0,0,0	;SET ON SENDING 41, RESET ON RECIEVING 3 OR 1
 11109				KMCLAS:	0	;LAST KMCGAV,KMCGAC
 11110				KMCPDP::	0
 11111				KMCFLG::	REPEAT ^D64,<EXP 0>;KMC ACTIVE FLAG HISTORY
 11112				IRPMSG::	0
 11113				IRPMS2::	0
 11114				IRPMS3::	0
 11115				IRPMP1::	0
 11116				IRPMP2::	0
 11117				IRPMP3::	0
 11118				IRPMB1::	0
 11119				IRPMB2::	0
 11120				IRPMB3::	0
 11121					>;END IFKMC
 11122	015710'	000000	000000	BADGUY:	0	;COUNTER INCREMENTED IN GOHSH:
 11123	015711'	000000	000000	FSCN:	0
 11124	015712'	000000	000000	TTFREN:	0	;NUMBER OF FREE CHUNKS LEFT
 11125	015713'	000000	000000	INPCH:	0
 11126	015714'	000000	000000	LINPTR:	0	;OUTPUT SCAN POINTER
 11127	015715'	000000	000000	CHCNT:	0	;# REMAINING CHARS TO OUTPUT AT A TIME ON A PORT
 11128	015716'	000000	000000	CHQTA:	0	;VALUE THAT CHCNT WAS SET TO AT START OF CYCLE
 11129	015717'	000000	000000	SVSPC:	0
 11130	015720'	000000	000000	TTCMCH::0	;HERE IS CHARACTER FOR COMMAND DECODER
 11131	015721'	000000	000000	TTCMCA::0	;INPUT POINTER FOR COMMAND BEING DECODED
 11132	015722'	000000	000000	COMTIA::0	;ADRESS OF COMMAND IN ROUTINE (CHANGED BY ONCE FOR ONCE DIALOGUE)
 11133	015723'	000000	000000	COMTOA::0	;SAME FOR OUTPUT
 11134	015724'	000000	000000	OPRLDB::0	;LDB FOR OPER CONSOLE FOR MSGS ETC
 11135	015725'	000000	000000	UPSHUT:	0	;PLACE FOR UP-SHUT COMMAND TO BE STORED
 11136
 11137	015726'	000000	000000	LINPNM:	0	;SAVE LINE NUMBER FROM JFFO
 11138	015727'	000000	000000	LINFSV:	0	;SAVE FLAG WORD
 11139	015730'	000000	000000	SVOJFF: 0	;SAVE OUTPUT BIT NO FROM LDBOUT
 11140	015731'	000000	000000	INTERM::0	;Count of active terminals
 11141	015732'	000000	000000	OPRTIM::0
 11142	015733'	000000	000000	FRETTY::0	;POINTER TO FREE TTY DDBS
 11143	015734'	000000	000000	TTYFLK::0	;POINTER TO WHERE TO LINK IN TTY BLOCKS
 11144	015735'	000000	000000	CHRRDP:	0	;BYTE POINTER TO INPUT RING FOR CHARACTER INPUT
 11145	015736'	000000	000000	CHRWRP:	0	;REAL TTY: BYTE POINTER TO OUTPUT RING
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 254-2
SCNSER.MAC	25-NOV-87 19:52		VARIABLES

 11146	015737'	000000	000000		0	;PTY: BYTE POINTER TO PTY BUFFER
 11147	015740'	000000	000000	MULCNT:	0	;REAL TTYS: # CHARS MORE WILL FIT IN OUTPUT RECORD
 11148	015741'	000000	000000		0	;PTYS: # CHARS MORE PTY OUTPUT THIS SECOND
 11149	015742'	000000	000000	MXMCNT:	0	;REAL TTYS: ORIGINAL VALUE OF MULCNT
 11150	015743'	000000	000000	TIMOW:	0	;TIMER FOR ORANGE-BALL WAIT ON CIRCUIT ZAPS
 11151	015744'	000000	000000	ALRSNT:	0
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255
SCNSER.MAC	25-NOV-87 19:52		VARIABLES

 11152	015745'	777777	777777	AUXRCP:: -1	;RECEIVED AUX PORT
 11153	015746'	000000	000000	AUXSTA:	0	;AUX CIRCUIT STATE
 11154	015747'			AUXSTR::BLOCK AUXSTL	;SPACE FOR STRING
 11155	015757'	000000	000000	AUXEND:: 0	;Pointer to last word used in AUXSTR
 11156	015760'	000000	000000	AUXSTP:	0	;STRING POINTER
 11157	015761'	000000	000000	AUXERR:: 0	;ERROR FROM AUX CIRCUIT BUILD
 11158	015762'	000000	000000	AUXJOB:	0	;JOB BUILDING AUX CIRCUIT
 11159	015763'	000000	000000	AUXWSC: 0	;# OF AUX-BUILTS RECEIVED IN WRONG STATE
 11160	015764'	000000	000000	AUXWPC: 0	;# OF AUX-BUILTS RECEIVED GIVING WRONG PORT
 11161	015765'	777777	777777	AUXWPT:	-1	;PORT LDB ADDRESS OF THE LAST ONE
 11162	015766'	000000	000000	NRPCNT: 0	;# TIMES WE GAVE "NO PORT RECEIVED" ERROR
 11163	015767'	000000	000000	ZRPCNT: 0	;# TIMES WE ZAPPED THE RECEIVED PORT
 11164	015770'	000000	000000	BIOJOB:	0	;JOB INITIATING BLOCK I/O FOR PORT.
 11165	015771'	000000	000000	AUXPRT:	0	;PORT BEING BUILT FROM
 11166	015772'	000000	000000	AUXTIM:	0	;AUX CIRCUIT TIMER
 11167	015773'			AUXUNM:	BLOCK 2	;SPACE TO BUILD UP A USER NAME
 11168	015775'	000000	000000	BUFLST:	0	;HEADER FOR LIST OF BLOCK INPUT/OUTPUT BUFFERS
 11169	015776'	000000	000000	BIOCNT:	0	;REAL TTYS: # OF JOBS ENABLED TO DO BLOCK I/O
 11170						;	    LH := -1 AS A FLAG TO BLKNEG CODE
 11171	015777'	000000	000000		0	;PTYS: # OF JOBS ENABLED TO DO PSEUDO-BLOCK I/O
 11172	016000'	000000	000000	BIOPRT: 0	;# OF BLOCK I/O PORTS, I.E., THE LAST RESPONSE
 11173						;FROM THE BASE TO A NEGOTIATE MESSAGE
 11174	016001'	000000	000000	BIOBUF: 0	;# OF MONITOR BLOCK I/O BUFFERS
 11175	016002'	000000	000000	BBFREE:	0	;# OF FREE MONITOR BLOCK I/O BUFFERS
 11176	016003'	000000	000000	BBCRE:	0	;# OF BIO BUFFERS CREATED SINCE MONITOR LOADED (KS ONLY)
 11177	016004'	000000	000000	BBREL:	0	;# OF BIO BUFFERS RELEASED (KS ONLY)
 11178	016005'	000000	000000	BBPOOL:	0	;COUNT OF BIO BUFFER RE-USE SINCE MONITOR LOADED
 11179	016006'	000000	000000	BIOANS: 0	;# OF BLOCK I/O NEGOTIATE MESSAGES SENT BUT NOT
 11180						;YET REPLIED-TO
 11181	016007'	000000	000000	ERRBNG: 0	;# OF UNSOLICITED BLOCK I/O NEGOTIATE MESSAGES
 11182	016010'	000000	000000	DWNFLG::0	;WANT TO TAKE SYSTEM DOWN
 11183	016011'	000000	000000	CTYFIL::0	;NUMBER OF FILLS NEEDED BY CTY
 11184	016012'	000000	000000	CTYFLN:	0	;COUNTER WHEN SENDING FILLS TO CTY
 11185	016013'	000000	000000	OPRWJB:	0	;JOB WAITING FOR SETUUO OPR MSG
 11186	016014'	000000	000120	TIWRNN: TILOW	;SMALL QUOTA FOR UNREAD INPUT CHARACTERS (^D80)
 11187						;(BACKPRESSURE WHEN IT'S EXCEEDED)
 11188	016015'			TIHLTN:		;LARGE QUOTA FOR UNREAD INPUT CHARACTERS
 11189						; MUST BE AT LEAST AS LARGE AS THE MAX NUMBER OF CHARS THE
 11190						; INPUT RING CAN HOLD * 2 + TIWRNN,
 11191						;  OTHERWISE CHARS COULD BE LOST
 11192				  IFDEF  SIZIRG, <<1_SIZIRG>*4*2+TILOW> ;^D1104 for normal sized rings
 11193	016015'	000000	002120	  IFNDEF SIZIRG, <^D512*2+TILOW>
 11194				  ;IFNKMC	<^D500>	;LARGE QUOTA FOR UNREAD INPUT CHARACTERS
 11195				  ;IFKMC	<^D2000>;(LOSE CHARACTERS WHEN IT'S EXCEEDED)
 11196	016016'	000000	000000	TTYRHT: 0	;# TIMES MONITOR OUT OF BUFFERLETS AT RCVCHR
 11197						;+ LOSPDP + LOS620
 11198	016017'	000000	000000	LOSPDP: 0	;# TIMES A PORT EXCEEDED ITS LARGE QUOTA
 11199						;BEFORE WE COULD GET BACKPRESSURE SENT
 11200	016020'	000000	000000	LOS620: 0	;# TIMES A PORT EXCEEDED ITS LARGE QUOTA
 11201						;AFTER WE HAD SENT BACKPRESSURE
 11202	016021'	000000	000170	OMX30:	^D120	;TTY OUTPUT HIGH-WATER MARK FOR SLOW DEVICES
 11203	016022'	000000	000074	OWK30:	^D60	;TTY OUTPUT LOW-WATER MARK FOR SLOW DEVICES
 11204	016023'	000000	000740	OMX120:	^D480	;TTY OUTPUT HIGH-WATER MARK FOR FAST DEVICES
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-2
SCNSER.MAC	25-NOV-87 19:52		VARIABLES

 11205	016024'	000000	000360	OWK120:	^D240	;TTY OUTPUT LOW-WATER MARK FOR FAST DEVICES
 11206	016025'	000000	000764	TOEMAX:	^D500	;EXPANDED-MODE TTY OUTPUT LIMIT
 11207	016026'	646471	545763		GTLNK (TTYLOS)
 11208	016027'	000001	000000
 11209	016030'	016031'	016026'
 11210					;.LINK for .GTLNK
 11211	016031'	000000	000000	TTYLOS: 0	;COUNT OF CHARACTERS LOST BY TYMNET
 11212						;(BLACK BALLS - BUFFER ZAPS)
 11213	016032'	000000	000000	PTYLOS:	0	;COUNT OF CHARACTERS LOST BY PTYS
 11214	016033'	000000	000000	LOGZAP:	0	;# OF LOGINS TO LOGGED-IN PORTS
 11215	016034'	777777	777777	ZAPLPT:	-1	;PORT LDB ADDRESS OF LAST LOGZAP OR DFRZAP
 11216	016035'	000000	000000	DFRZAP:	0	;# OF LDECS RECEIVED WHILE STILL ECHOING
 11217	016036'	000000	000000	NZAPIN: 0	;# ZAPPERS IN FROM TYMNET
 11218	016037'	000000	000000	NZAPN2: 0	;# TIMES WE GOT A ZAPPER ON A PORT W/ AN UNECHOED ZAP
 11219	016040'	000000	000000	NZAPLG: 0	;# TIMES WE GOT A LOGIN ON A PORT W/ AN UNECHOED ZAP
 11220	016041'	000000	000000	NZAPAX: 0	;# TIMES WE GOT AN AUX PORT FOR A PORT W/ AN UNECHOED ZAP
 11221	016042'	000000	000000	NZAPRS: 0	;# of times zapper had to be resent (based on LNLZIN)
 11222	016043'	000000	000000	NZAPOT: 0	;# ZAPPERS OUT IN RESPONSE TO ZAPPERS IN
 11223	016044'	000000	000000	TMCOOR: 0	;# OF UNKNOWN TERMINAL CHARACTERISTICS SET BY TYMNET
 11224	016045'	000000	001750	PTYFLO:	^D1000	;CHARS/SEC TOTAL MAXIMUM PTY FLOW
 11225	016046'			PTYBUF:	BLOCK	<PTBSIZ+4>/5
 11226	016076'	000000	000000	PBDISC:	0
 11227	016077'	000000	000000	DIDPBI:	0
 11228	016100'	000000	000000	FRSFLG:	0	;FLAG FOR CMDWAK (SO IT'LL KNOW IT'S NOT A REAL CMND)
 11229	016101'	000000	000000	FRSDEF:	0	;FLAG TO REMEMBER DEFERRED-ECHO STATE
 11230	016102'	000000	000000	SKPFLG:	0	;SET TO INDICATE INPUT AND SKIP AUXCAL IN PROGRESS
 11231	016103'	000000	000000	IRPSTP:	0	;Stopping place for SCNIN
 11232	016104'	000000	000000	BADKEY:	0	;Copy of KEY620 when base wants to crash us
 11233	016105'	000000	000000	IRPOLD:	0	;Old copy of IRP620 when base is declared down
 11234	016106'	000000	000000	ORPOLD:	0	;            ORP620
 11235
 11236	016107'	777777	777777	SCNPTR:: EXP	-1		;Pointer, AOSed before use
 11237	016110'			SCNBUF:: BLOCK	2		;Buffer for tracking IRING/ORING bugs
 11238			000003	SCNBLN==:.-SCNPTR		;Length for SYSDVF (includes SCNPTR)
 11239
 11240	016112'	777776	000000		SYDVF (<<SCNBUF,SCNBLN>,<SCNPTR,1>>)
 11241	016113'	634356	426546
 11242	016114'	000003	016110'
 11243	016115'	634356	606462
 11244	016116'	000001	016107'
 11245					;2 things for SYSDVF
 11246
 11247	016117'	242000	006633*		$END	(SCN)

 11248	016120'	042000	016117*

 11249	016121'	260040	000000*

 11250	016122'	424163	452024

 11251	016123'	400001	000000

 11252	016124'	000000	000561'
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-3
SCNSER.MAC	25-NOV-87 19:52		VARIABLES


 11253	016125'	260040	000000*

 11254	016126'	424163	450000

 11255	016127'	400005	000000

 11256	016130'	000000	000561'

 11257	016131'	242000	000600*

 11258	016132'	042000	016131*

 11259	016133'	265300	013755*

 11260	016134'	476261	505000

 11261	016135'	010000	010000

 11262	016136'	104000	010000

 11263	016137'	260040	016125*

 11264	016140'	646471	425564

 11265	016141'	400005	000746'

 11266	016142'	000000	000770'

 11267	016143'	260040	016137*

 11268	016144'	646471	426056

 11269	016145'	400005	000740'

 11270	016146'	000000	000770'

 11271	016147'	201300	016040'

 11272	016150'	260040	004460'

 11273	016151'	254000	001154'

 11274	016152'	260040	001242'

 11275	016153'	254000	000746'

 11276	016154'	042000	012245*

 11277	016155'	260040	016143*

 11278	016156'	646471	725645

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-4
SCNSER.MAC	25-NOV-87 19:52		VARIABLES

 11279	016157'	400005	000000

 11280	016160'	000000	000770'

 11281	016161'	260040	016155*

 11282	016162'	646471	425660

 11283	016163'	000005	000000

 11284	016164'	350000	016007'

 11285	016165'	344740	000746'

 11286	016166'	202000	000006

 11287	016167'	201300	016037'

 11288	016170'	260040	004460'

 11289	016171'	254000	001514'

 11290	016172'	403305	000026

 11291	016173'	137300	000154'

 11292	016174'	201300	000001

 11293	016175'	137300	000077'

 11294	016176'	137305	000002

 11295	016177'	205300	400000

 11296	016200'	412305	000031

 11297	016201'	263040	000000

 11298	016202'	340000	000000

 11299	016203'	064254	671302

 11300	016204'	667124	061702

 11301	016205'	703034	364750

 11302	016206'	745014	574306

 11303	016207'	627134	462710

 11304	016210'	064240	000000

 11305	016211'	064256	067744
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-5
SCNSER.MAC	25-NOV-87 19:52		VARIABLES


 11306	016212'	721014	360740

 11307	016213'	607075	172362

 11308	016214'	203137	061712

 11309	016215'	627114	562032

 11310	016216'	050000	000000

 11311	016217'	201300	000001

 11312	016220'	137300	000072'

 11313	016221'	137305	000002

 11314	016222'	263040	000000

 11315	016223'	205440	777777

 11316	016224'	254000	003014'

 11317	016225'	205300	040000

 11318	016226'	616305	000027

 11319	016227'	263040	000000

 11320	016230'	254000	003036'

 11321	016231'	260040	016161*

 11322	016232'	646471	606471

 11323	016233'	400005	000000

 11324	016234'	000000	003222'

 11325	016235'	441000	016046'

 11326	016236'	000000	000000

 11327	016237'	000003	000003

 11328	016240'	260040	016121*

 11329	016241'	646471	566042

 11330	016242'	000002	000000

 11331	016243'	441000	000006

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-6
SCNSER.MAC	25-NOV-87 19:52		VARIABLES

 11332	016244'	260040	016231*

 11333	016245'	606471	634254

 11334	016246'	000005	000000

 11335	016247'	201740	000001*

 11336	016250'	336000	014450*

 11337	016251'	201740	014461*

 11338	016252'	274740	014445*

 11339	016253'	326740	004131'

 11340	016254'	263040	000000

 11341	016255'	344740	004120'

 11342	016256'	350000	015710'

 11343	016257'	254000	003312'

 11344	016260'	000100	040000

 11345	016261'	260040	016244*

 11346	016262'	724160	426547

 11347	016263'	000005	000000

 11348	016264'	350000	000000*

 11349	016265'	254000	004517'

 11350	016266'	260040	016261*

 11351	016267'	425157	724144

 11352	016270'	000005	000000

 11353	016271'	350000	016264*

 11354	016272'	254000	004542'

 11355	016273'	042000	000016

 11356	016274'	142200	000016

 11357	016275'	272405	000024

 11358	016276'	254000	003316'
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-7
SCNSER.MAC	25-NOV-87 19:52		VARIABLES


 11359	016277'	272405	000020

 11360	016300'	254000	004650'

 11361	016301'	321240	003265'

 11362	016302'	254000	003312'

 11363	016303'	201300	000005

 11364	016304'	254000	004732'

 11365	016305'	137440	000171'

 11366	016306'	254000	005260'

 11367	016307'	402005	000022

 11368	016310'	254000	003274'

 11369	016311'	254000	005371'

 11370	016312'	135440	000171'

 11371	016313'	254000	005364'

 11372	016314'	254000	005567'

 11373	016315'	201440	000001

 11374	016316'	254000	005363'

 11375	016317'	260040	016266*

 11376	016320'	565742	416345

 11377	016321'	400006	000000

 11378	016322'	000000	005613'

 11379	016323'	260040	005743'

 11380	016324'	201300	010000

 11381	016325'	254000	005657'

 11382	016326'	436305	000027

 11383	016327'	254000	005726'

 11384	016330'	201300	000001

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-8
SCNSER.MAC	25-NOV-87 19:52		VARIABLES

 11385	016331'	135345	000002

 11386	016332'	137300	000077'

 11387	016333'	137305	000002

 11388	016334'	205300	000400

 11389	016335'	412305	000027

 11390	016336'	336000	000007

 11391	016337'	350000	016042'

 11392	016340'	254000	005730'

 11393	016341'	000001	010000

 11394	016342'	010000	020000

 11395	016343'	000001	100000

 11396	016344'	260040	016317*

 11397	016345'	646471	465455

 11398	016346'	000005	015546*

 11399	016347'	260040	016344*

 11400	016350'	646471	565643

 11401	016351'	000005	001515'

 11402	016352'	205000	000040

 11403	016353'	254000	006335'

 11404	016354'	222114	000000

 11405	016355'	135640	016354'

 11406	016356'	136400	000014

 11407	016357'	542615	000001

 11408	016360'	300606	000001

 11409	016361'	135340	016360'

 11410	016362'	300600	000014

 11411	016363'	550654	000001
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-9
SCNSER.MAC	25-NOV-87 19:52		VARIABLES


 11412	016364'	134400	000014

 11413	016365'	550653	000000

 11414	016366'	136400	000015

 11415	016367'	200553	000000

 11416	016370'	300000	001717

 11417	016371'	201300	000001

 11418	016372'	263040	000000

 11419	016373'	201300	000002

 11420	016374'	263040	000000

 11421	016375'	201300	000000

 11422	016376'	262040	000007

 11423	016377'	262040	000005

 11424	016400'	263040	000000

 11425	016401'	134401	000000

 11426	016402'	200413	000000

 11427	016403'	134400	000013

 11428	016404'	200513	000000

 11429	016405'	134400	000012

 11430	016406'	300600	000012

 11431	016407'	202513	000000

 11432	016410'	550613	000000

 11433	016411'	200513	000001

 11434	016412'	542613	000000

 11435	016413'	202513	000001

 11436	016414'	200313	000000

 11437	016415'	202313	000000

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-10
SCNSER.MAC	25-NOV-87 19:52		VARIABLES

 11438	016416'	402013	000000

 11439	016417'	554613	000000

 11440	016420'	777771	007253'

 11441	016421'	202413	000000

 11442	016422'	040000	000000

 11443	016423'	201300	000001

 11444	016424'	254000	007660'

 11445	016425'	201300	000002

 11446	016426'	254000	007660'

 11447	016427'	550200	000015

 11448	016430'	260040	014504'

 11449	016431'	554240	000015

 11450	016432'	513005	000000

 11451	016433'	402005	000026

 11452	016434'	201300	000002

 11453	016435'	254000	007660'

 11454	016436'	202613	000000

 11455	016437'	000000	000000*

 11456	016440'	001000	000006

 11457	016441'	574212	000000

 11458	016442'	550312	000000

 11459	016443'	554313	000000

 11460	016444'	570353	000000

 11461	016445'	542413	000000

 11462	016446'	476013	000000

 11463	016447'	506313	000000

 11464	016450'	000006	000000
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-11
SCNSER.MAC	25-NOV-87 19:52		VARIABLES


 11465	016451'	777777	777777

 11466	016452'	250353	000000

 11467	016453'	250313	000000

 11468	016454'	200353	000000

 11469	016455'	134400	000006

 11470	016456'	201600	000001

 11471	016457'	254000	010726'

 11472	016460'	201600	000003

 11473	016461'	254000	010726'

 11474	016462'	200613	000000

 11475	016463'	201600	000002

 11476	016464'	254000	010726'

 11477	016465'	260040	015536'

 11478	016466'	324740	015306*

 11479	016467'	200153	000001

 11480	016470'	134400	000003

 11481	016471'	202153	000001

 11482	016472'	202612	000000

 11483	016473'	350000	015746'

 11484	016474'	344740	000746'

 11485	016475'	440700	015747'

 11486	016476'	260040	011121'

 11487	016477'	344740	000746'

 11488	016500'	201300	016041'

 11489	016501'	260040	004460'

 11490	016502'	254000	011134'

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-12
SCNSER.MAC	25-NOV-87 19:52		VARIABLES

 11491	016503'	260040	001242'

 11492	016504'	200300	015746'

 11493	016505'	302300	000006

 11494	016506'	364740	011141'

 11495	016507'	350000	015746'

 11496	016510'	254000	000746'

 11497	016511'	440600	015773'

 11498	016512'	015747'	015750'

 11499	016513'	134340	000006

 11500	016514'	205340	000002

 11501	016515'	254000	011434'

 11502	016516'	350000	015766'

 11503	016517'	205340	000006

 11504	016520'	254000	011434'

 11505	016521'	205340	000003

 11506	016522'	254000	011434'

 11507	016523'	202312	000000

 11508	016524'	202352	000000

 11509	016525'	476012	000000

 11510	016526'	256200	016525'

 11511	016527'	263040	000000

 11512	016530'	202406	777777

 11513	016531'	476006	777777

 11514	016532'	210346	000000

 11515	016533'	506407	000000

 11516	016534'	542407	000000

 11517	016535'	202452	000000
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-13
SCNSER.MAC	25-NOV-87 19:52		VARIABLES


 11518	016536'	603000	000040

 11519	016537'	254000	011671'

 11520	016540'	200345	000030

 11521	016541'	603340	400000

 11522	016542'	254000	011655'

 11523	016543'	260040	011741'

 11524	016544'	263040	000000

 11525	016545'	254000	011655'

 11526	016546'	603000	000040

 11527	016547'	254000	011671'

 11528	016550'	200345	000030

 11529	016551'	603340	400000

 11530	016552'	263040	000000

 11531	016553'	260040	011741'

 11532	016554'	263040	000000

 11533	016555'	263040	000000

 11534	016556'	000040	020000

 11535	016557'	251407	000000

 11536	016560'	260040	012105'

 11537	016561'	254000	011735'

 11538	016562'	550353	000000

 11539	016563'	205413	000000

 11540	016564'	350000	012204*

 11541	016565'	260040	000000*

 11542	016566'	370000	016564*

 11543	016567'	254000	012162'

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-14
SCNSER.MAC	25-NOV-87 19:52		VARIABLES

 11544	016570'	260040	016240*

 11545	016571'	646471	564642

 11546	016572'	000001	000000

 11547	016573'	260040	016347*

 11548	016574'	424163	455753

 11549	016575'	400006	000000

 11550	016576'	000000	012226'

 11551	016577'	141000	016154*

 11552	016600'	041000	016577*

 11553	016601'	402005	000012

 11554	016602'	263040	000000

 11555	016603'	135700	000161'

 11556	016604'	201400	000003

 11557	016605'	302700	000001

 11558	016606'	306700	000002

 11559	016607'	201400	000033

 11560	016610'	350005	000015

 11561	016611'	254000	012457'

 11562	016612'	402005	000012

 11563	016613'	254000	012565'

 11564	016614'	612405	000027

 11565	016615'	616405	000027

 11566	016616'	200300	015712'

 11567	016617'	301300	000010

 11568	016620'	350001	000000

 11569	016621'	263040	000000

 11570	016622'	014100	020000
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-15
SCNSER.MAC	25-NOV-87 19:52		VARIABLES


 11571	016623'	400020	010000

 11572	016624'	000000	600000

 11573	016625'	000000	013602'

 11574	016626'	000000	013576'

 11575	016627'	000000	013570'

 11576	016630'	000444*	000445*

 11577	016631'	264000	013743'

 11578	016632'	000144*	000145*

 11579	016633'	446351	152222

 11580	016634'	406311	155202

 11581	016635'	522231	747100

 11582	016636'	617375	570330

 11583	016637'	627514	506424

 11584	016640'	703314	560746

 11585	016641'	625015	467716

 11586	016642'	203235	635100

 11587	016643'	000000	000000

 11588	016644'	201300	200000

 11589	016645'	412300	015634*

 11590	016646'	402000	013745'

 11591	016647'	201300	016633'

 11592	016650'	324740	016133*

 11593	016651'	516132	452652

 11594	016652'	475014	667744

 11595	016653'	617235	663500

 11596	016654'	446351	152222

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-16
SCNSER.MAC	25-NOV-87 19:52		VARIABLES

 11597	016655'	405015	767100

 11598	016656'	522513	130530

 11599	016657'	522513	131130

 11600	016660'	522513	131530

 11601	016661'	522513	132130

 11602	016662'	522513	132432

 11603	016663'	050000	000000

 11604	016664'	100000	020000

 11605	016665'	420020	010000

 11606	016666'	576062	000000

 11607	016667'	646471	000000

 11608	016670'	440601	777777

 11609	016671'	135400	000013

 11610	016672'	200000	000000

 11611	016673'	210000	000000

 11612	016674'	242000	014437*

 11613	016675'	042000	016674*

 11614	016676'	242000	000016

 11615	016677'	020000	600000

 11616	016700'	260040	016570*

 11617	016701'	444442	435645

 11618	016702'	000001	000000

 11619	016703'	200000	016341'

 11620	016704'	412004	000002

 11621	016705'	254000	014604'

 11622	016706'	020001	010000

 11623	016707'	020000	400000
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-17
SCNSER.MAC	25-NOV-87 19:52		VARIABLES


 11624	016710'	200606	000000

 11625	016711'	200646	000001

 11626	016712'	201300	000001

 11627	016713'	254000	015113'

 11628	016714'	201300	000002

 11629	016715'	254000	015113'

 11630	016716'	201300	000003

 11631	016717'	254000	015113'

 11632	016720'	201300	000004

 11633	016721'	254000	015113'

 11634	016722'	201300	000007

 11635	016723'	254000	015112'

 11636	016724'	201300	000010

 11637	016725'	254000	015112'

 11638	016726'	201300	000006

 11639	016727'	254000	015112'

 11640	016730'	410200	000015

 11641	016731'	000000	015021'

 11642	016732'	000000	015070'

 11643	016733'	000000	015031'

 11644	016734'	000000	015025'

 11645	016735'	201300	000011

 11646	016736'	254000	015112'

 11647	016737'	220604	000000

 11648	016740'	272727	000000

 11649	016741'	550202	015560*

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 255-18
SCNSER.MAC	25-NOV-87 19:52		VARIABLES

 11650	016742'	254000	015546'

 11651	016743'	221100	000006

 11652	016744'	331100	000006

 11653	016745'	440100	003173*

 11654	016746'	261040	000005

 11655	016747'	254000	014651'

 11656						;End of SCNSER (SCNLIT: SCNEND:)
 11657
NO ERRORS DETECTED
PROGRAM BREAK IS 016762
12K CORE USED
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 256
SCNSER.MAC	25-NOV-87 19:52		SYMBOL TABLE

A		000000	SIN	AUXPRT		015771'		BASE		000553'	INT	BLKOH1		001367'	
ABTUUO		016466'	EXT	AUXRCP		015745'	INT	BASE04		000552'	INT	BLKOHR		001353'	
ACBBP		010450'		AUXRED		011453'	INT	BASEOK		012224'	INT	BLKOT1		011774'	
ACBRKC		010536'		AUXRID		010732'		BASTIM		000132	SIN	BLKOUT		011763'	
ACBSPC		010353'		AUXRL1		011461'		BASVER		016600'	EXT	BLKTRQ		012337'	
ACDEFC		010370'		AUXRL2		011473'		BBCRE		016003'		BLKX1		011613'	
ACERAC		010363'		AUXRN1		011474'		BBFREE		016002'		BLKX2		011621'	
ACHNG		010526'		AUXSLP		011333'		BBPOOL		016005'		BLKXI1		012334'	
ACIN1		010545'		AUXSTA		015746'		BBREL		016004'		BLKXIN		012321'	
ACIN2		010550'		AUXSTL		000010	SPD	BIOANS		016006'		BLKXIO		011601'	
ACINSC		010554'		AUXSTM		000035	SIN	BIOATT		012311'		BLKXOT		012347'	
ACINWB		010566'		AUXSTP		015760'		BIOBUF		016001'		BLKXT1		012362'	
ACINWC		010544'		AUXSTR		015747'	INT	BIOCHG		005743'		BPAVAL		012156'	EXT
ACNTB		010432'		AUXTIM		015772'		BIOCHK		011675'		BPFCOM		013253'	
ACNZP		010473'		AUXTMP		011210'		BIOCHR		000005	SPD	BPFTYI		013233'	
ACOTCI		007056'		AUXTMR		011207'		BIOCNT		015776'		BPLVD		013221'	
ACPSM		010531'		AUXTOV		011256'		BIOCOR		012211'	EXT	BPLVD1		013226'	
ACPTPC		010406'		AUXTU0		007771'		BIOCSH		000001	SPD	BPOFF		013246'	
ACSFS		010506'		AUXTU1		010004'		BIODAT		000006	SPD	BPOKBN		000006	SPD
ACSOB		010515'		AUXTUU		007751'	INT	BIOJOB		015770'		BPREQ		015604'	EXT
ACSOX		010460'		AUXUNM		015773'		BIOLNK		000000	SPD	BPTEST		013257'	
ACSYL		010512'		AUXWAK		011124'		BIOPBC		000003	SPD	BPWAIT		012143'	EXT
ACTBK		010440'		AUXWPC		015764'		BIOPBP		000002	SPD	BPXOFF		013245'	
ACTCLA		010426'		AUXWPN		011143'		BIOPRT		016000'		BSLASC		005517'	
ACTCN		010111'		AUXWPT		015765'		BIOREL		011626'		BUFCLR		006307'	EXT
ACTCP		010120'		AUXWSC		015763'		BIOREQ		000004	SPD	BUFLST		015775'	
ACTCP1		010131'		AUXWST		011141'		BIORES		011641'		BV.DBG	000004	000000	SPD
ACTCP2		010143'		AUXZAP		011032'		BIOWAK		005754'		BV.HDN	001000	000000	SPD
ACTMC		010500'		AUXZPT		011145'		BIOZAD		004532'	INT	BYP1		000007	SPD
ACTTYP		010420'		AXAVAL		012042'	EXT	BIOZAP		011634'		BYP2		000017	SPD
ACTWRT		011443'	EXT	AXCDON		011251'		BITNTB		003175'	EXT	BYP3		000027	SPD
ACWIDC		010344'		AXCLP1		011227'		BK2IOS		001000	SPD	BYP4		000037	SPD
ADRERR		006310'	EXT	AXCLP2		011240'		BKTOPN		007556'		BYTTC		010303'	
ADVBFE		006461'	EXT	AXCTAB		010005'		BLKEOF		011671'		CCASC		005503'	
ADVBFF		006331'	EXT	AXELOG		011435'		BLKEOT		001266'		CCPTR		005502'	
ADVPTR		004120'		AXERGV		011434'		BLKIB1		001253'		CCTYI		013327'	INT
AL		000001	SIN	AXGIV		011444'		BLKIB2		001255'		CCTYI1		013336'	
ALR620		016675'	EXT	AXNRL		011273'		BLKIB3		001262'		CCTYO		013322'	INT
ALROPR		000020	SIN	AXNRR		011271'		BLKIBF		001246'		CHCNT		015715'	
ALRSNT		015744'		AXREQ		012041'	EXT	BLKICK		001330'		CHGCLK		015011'	EXT
ARSTAB		011064'		AXSFIN		011352'		BLKIHR		001337'		CHKBAS		000525'	INT
ASSCON		400000	SIN	AXSFN1		011350'		BLKINP		011644'		CHKCHR		015457'	
ASSPRG		200000	SIN	AXSNTB		011177'		BLKINS		011660'		CHKLIN		007357'	
AUXCHR		011222'		AXSWT		011277'	EXT	BLKIO		011554'		CHKLN2		007356'	
AUXCLP		011232'		AXTOTB		011261'		BLKIO1		011566'		CHKLOS		015453'	
AUXDET		011315'		AXWAIT		012030'	EXT	BLKIO2		011573'		CHKPSP		015502'	
AUXEND		015757'	INT	AXZP1		011043'		BLKIP1		011655'		CHKRM1		012674'	
AUXERR		015761'	INT	B		000014	SIN	BLKIRQ		011751'		CHKRM2		012703'	
AUXGV1		011446'		BADGUY		015710'		BLKITM		001304'		CHKRM3		012705'	
AUXINP		011147'		BADKEY		016104'		BLKNEG		001401'		CHKROM		012662'	
AUXJOB		015762'		BADPR1		000740'		BLKNG2		001415'		CHKSEG		007371'	EXT
AUXLIC		011401'		BADPRT		000752'		BLKNG3		001422'		CHKTCC		015506'	
AUXNSB		011347'		BASDWN		012242'	EXT	BLKNG4		001423'		CHKYEL		015517'	
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 256-2
SCNSER.MAC	25-NOV-87 19:52		SYMBOL TABLE

CHPECH		000301'		CMFCXI		015656'	EXT	CSUNL		004514'	EXT	DDPTAB		000221'	
CHPINP		000275'		CMFCXN		002042'	EXT	CSVAL		004537'	EXT	DDPTBK		000236'	
CHPOUT		000276'		CMFSTA		003065'	EXT	CSVCNT		012015'	EXT	DDPTCG		000233'	
CHPRED		000300'		CNCCHK		006027'		CTEXT1		014350'	EXT	DDPTCH		000222'	
CHPSPE		000304'		CNCCK1		006043'		CTY		000120	SPD	DDPTLC		000226'	
CHPSPI		000303'		CNCMD1		013476'		CTYBLF		013507'	INT	DDPTLN		000223'	
CHPSPO		000277'		CNCMOD		013475'		CTYBUF		013643'	EXT	DDPTOB		000227'	
CHPSPR		000302'		CNTCHR		007613'		CTYCHR		013647'	ENT	DDPTPS		000231'	
CHQTA		015716'		CNTECO		004720'		CTYDO		005576'	EXT	DDPTSC		000221'	
CHRCNT		007574'		CNTOUT		004632'		CTYFIL		016011'	INT	DDPTTC		000234'	
CHRML1		001547'		CNTPRT		000745'		CTYFLN		016012'		DDPTTI		000224'	
CHRML2		001566'		CNTRUB		004610'		CTYFRM		013546'		DDPTTS		000225'	
CHRML3		001571'		COASC		005514'		CTYINP		000637'	EXT	DDPTYB		000232'	
CHRMLT		001542'		COM940		013411'		CTYLDB		000103'	INT	DDPTZP		000230'	
CHRRDP		015735'		COMATB		013365'		CTYLOG		013634'	INT	DDTIN		006466'	INT
CHRTAB		000305'		COMATT		015115'		CTYNFL		013554'		DDTINL		006477'	
CHRTRP		015237'		COMBSP		013424'		CTYPTR		013641'	EXT	DDTINX		006506'	
CHRWRP		015736'		COMGMS		001470'	EXT	CTYSFL		013544'		DDTOUT		006511'	INT
CIMTAB		001605'		COMKJB		006621'	EXT	CTYTY1		013622'		DDXZ		000000	SIN
CKATI1		012754'		COMPA		013430'		CTYTYL		013630'		DEBUGF		000661'	EXT
CKATI2		012735'		COMPDP		013402'		CTYTYO		013607'	INT	DECBC		012046'	
CKATIW		012741'		COMTAB		013420'		CTYTYP		013627'	INT	DECBC1		012063'	
CKATO1		013001'		COMTI1		013352'		CUASC		005507'		DECBC2		012066'	
CKATO2		012770'		COMTI2		013361'		CUPTR		005506'		DECBC3		012073'	
CKATTF		012652'		COMTIA		015722'	INT	CX2AX%		000001	SPD	DECIN1		014373'	EXT
CKATTI		012727'		COMTOA		015723'	INT	CXDCB%		000003	SPD	DECPBC		012057'	
CKATTO		012762'		COMTYI		013340'	INT	CXDTP		000000	SPD	DEFBRK		002121'	
CKLGO		014427'	INT	COMTYO		013317'	INT	CXERR%		000007	SPD	DEFCHR		002120'	
CKLN1		007364'		COMTYT		013343'	INT	CXLOG%		000002	SPD	DEFNBK		002122'	
CKLNTR		015466'		COMWCM		013306'	EXT	CXNCH%		000006	SPD	DETALL		012256'	
CKOPR		014422'		COMXON		004264'		CXNRL%		000005	SPD	DETON1		012271'	
CKSXON		013504'		CONFIG		000000	EXT	CXNRR%		000004	SPD	DETONE		012262'	
CL11PT		001000	SPD	CONMES		016650'	EXT	DATE		011051'	EXT	DEVBUF		000006	SIN
CLKJOB		015010'	EXT	COPTR		005513'		DBYT		000002	SIN	DEVCLS		000011	SIN
CLKRSP		001457'		CPERR		007660'		DCL		000007	SIN	DEVIAD		000007	SIN
CLNOC		004651'		CPNPT%		000001	SPD	DCLBBP		400000	SPD	DEVIOS		000002	SIN
CLNOCP		004650'		CPNRM%		000002	SPD	DCLCOM		040000	SPD	DEVLOG		000005	SIN
CLRIM1		007525'		CPOPJ		016346'	EXT	DCLNTB		100000	SPD	DEVLST		014543'	EXT
CLRIMI		007520'		CPOPJ1		015474'	EXT	DCLTBK		200000	SPD	DEVMOD		000004	SIN
CLRMLT		001553'		CPUF3		000004	SPD	DDBBLK		000013	SIN	DEVNAM		000000	SIN
CLRPTY		004426'		CPUKI		000001	SPD	DDBCNE		014550'	INT	DEVOAD		000010	SIN
CLRTTY		004403'		CPUKL		000002	SPD	DDBDCH		000012	SPD	DEVOPR		015661'	EXT
CLSCHR		004102'		CPUKS		000003	SPD	DDBLDB		000013	SIN	DEVSER		000003	SIN
CLSLP1		003501'		CPUTYP		000002	SPD	DDBSR1		015147'		DFRZAP		016035'	
CLSLP2		003514'		CPZZ		000000	SPD	DDBSRC		015146'		DHNG		000005	SIN
CLSPBF		003543'		CREAUX		011275'	INT	DDBTRP		000014	SPD	DIDPBI		016077'	
CLSPTB		003517'		CREPTY		007640'	INT	DDINT		000001	SIN	DIE		016700'	EXT
CLSPTL		003465'		CRLF		003241'	EXT	DDPBBP		000235'		DIN		000011	SIN
CMDCKW		004677'	EXT	CRPTR		005505'		DDPCOM		000242'		DINI		000004	SIN
CMDTYO		012615'		CRSHWD		016120'	EXT	DDPIMB		000240'		DINITF		000517'	EXT
CMDWAK		013265'		CSHSAV		016271'	EXT	DDPMOD		000241'		DLRSUP		000400	SPD
CMDWK1		013271'		CSRTAB		005771'	EXT	DDPNTB		000237'		DOOUT		001143'	
CMFCHT		006044'	EXT	CSUCNT		011751'	EXT	DDPNZP		000243'		DOU		000010	SIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 256-3
SCNSER.MAC	25-NOV-87 19:52		SYMBOL TABLE

DRL		000006	SIN	ENTRUB		002416'		FRCRS7		010721'		GOBCH1		001126'	
DSPSIZ		000012	SPD	EPCOU1		005273'		FRCRSC		010625'		GOBCH2		001131'	
DTE		000200	SPD	EPCOUT		005272'		FRCRSX		010726'		GOBCHR		001114'	
DTEDII		000002	SIN	EPT		000000	EXT	FRCYEL		001223'		GOBIN		004506'	
DTEDRW		000007	SIN	EPTDT0		000140	SIN	FRCZAP		001515'		GOBIN1		004517'	
DTEEPW		000004	SIN	ERRBNG		016007'		FREBUF		001325'		GOBIO1		004550'	
DTEHLT		013743'		ERRXIT		011121'		FRECHK		006163'		GOBIO2		004560'	
DVIN		000002	SIN	ESCTR1		015277'		FREST		006050'		GOBOP		004523'	
DVNZP		010000	SIN	ESCTRP		015262'		FRETTY		015733'	INT	GOBOT		004524'	
DVOUT		000001	SIN	F		000004	INT	FREUP		006047'		GOBOT1		004542'	
DVRMT		004000	SIN	FARCHK		014746'	EXT	FRMASN		015647'	EXT	GOBOT3		004534'	
DVSIZ		000003	SIN	FCREQ		016566'	EXT	FRMKJF		013775'	EXT	GOBPF		004271'	
DVTTY		000010	SIN	FCS		000100	SPD	FRSDEF		016101'		GOBPN		004305'	
DWNFLG		016010'	INT	FCWAIT		016565'	EXT	FRSFLG		016100'		GOBPN1		004311'	
DZAP		000012	SIN	FDRUPX		006523'	EXT	FRSTTY		015337'		GOCGB		004234'	
E1IDPB		005301'		FFFLP		005520'		FSCN		015711'		GOECO		004712'	
E2IDPB		005306'		FFLP0		005521'		FULLCQ		006022'		GOFIL		005314'	
EAC10A		005030'		FILERS		005544'		FULLIN		003316'		GOHNG		004247'	
EAC10B		005033'		FINLIN		003304'		FULLN2		003325'		GOHSH		004200'	
EAC11A		005050'		FINOUT		003347'		FULLN3		003332'		GOLIN		003256'	
EAC14A		005077'		FIXIMI		007507'		GEPM10		007504'		GOLIN1		003271'	
EAC15A		005106'		FLGCHR		000400	SIN	GEPM11		007505'		GOLIN2		003270'	
EAC4A		005016'		FLGESC		000001	SIN	GEPM12		007506'		GOLIN3		003265'	
EACT1		004774'		FLGLIN		004000	SIN	GEPMC1		007473'		GOOUT		004626'	
EACT10		005024'		FLLBSC		005516'		GEPMC2		007474'		GORUB		004604'	
EACT11		005044'		FLLFFS		005524'		GEPMC3		007475'		GOSBL		004257'	
EACT12		005064'		FLLVTS		005530'		GEPMC4		007476'		GOSEC		004242'	
EACT13		005067'		FLMX		000050	SPD	GEPMC5		007477'		GOSGR		004666'	
EACT14		005073'		FMTB		004250'		GEPMC6		007500'		GOSOG		004670'	
EACT15		005102'		FMTB1		004252'		GEPMC7		007501'		GOSRD		004232'	
EACT16		005004'		FNDPRT		015541'	INT	GEPMC8		007502'		GOSTC		004205'	
EACT17		005060'		FNDPT1		015546'		GEPMC9		007503'		GOSTC1		004207'	
EACT1A		005001'		FPOPJ		013310'		GET4WD		012166'	EXT	GOSTP		004236'	
EACT1B		004776'		FRCCGB		001123'		GETBB		012162'		GOSYL		004656'	
EACT2		005006'		FRCDOO		001144'		GETBB1		012174'		GOTBF0		011733'	
EACT3		005012'		FRCEOT		001270'		GETBBP		012172'		GOTBF1		011735'	
EACT4		005014'		FRCIBF		001250'		GETBI		012075'		GOTBUF		011705'	
EACT5		005021'		FRCIHR		001341'		GETBIO		012133'		GOTRI		004602'	
EACT6		005036'		FRCINP		010573'		GETBO		012101'		GOTRO		004574'	
EACT6A		005042'		FRCITM		001306'		GETCHK		006173'		GOXOFF		004317'	
EACT7		005054'		FRCLOS		001435'		GETCTY		014021'	INT	GOXON		004302'	
EATTAB		012542'		FRCLP0		010577'		GETDDB		014114'	INT	GOZAP		004327'	
ECHBAK		004735'		FRCLP1		010607'		GETLIN		007212'		GREEN		001200'	
ECHLST		004737'		FRCLP2		010617'		GETLNZ		007251'		GTBIO1		012144'	
ECHRPT		004732'		FRCNOO		001135'		GETLOG		007350'	INT	GTCGSZ		006346'	EXT
ECHSPA		005111'		FRCOHR		001360'		GETLPS		007400'	INT	GTLCRD		002000	SPD
ECHSPT		005114'		FRCORG		001213'		GETMC		007437'		GTLDEF		001000	SPD
ECHT12		004754'		FRCRS1		010635'		GETMOD		007404'	INT	GTLECS		100000	SPD
ECHT34		004760'		FRCRS2		010655'		GETOP1		014031'		GTLESC		004000	SPD
ECHT56		004764'		FRCRS3		010673'		GETOPR		014017'	INT	GTLFRM		000001	SPD
ECHT7		004770'		FRCRS4		010710'		GETPP		007662'		GTLHDX		010000	SPD
ECHTAB		004744'		FRCRS5		010714'		GETPP1		007663'		GTLLCT		000020	SPD
EDEC		001174'		FRCRS6		010715'		GIV4WD		012212'	EXT	GTLLRD		000100	SPD
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 256-4
SCNSER.MAC	25-NOV-87 19:52		SYMBOL TABLE

GTLMSK		501777	SPD	IB		000013	SIN	INPRA1		003036'		JBTCIN		001561'	EXT
GTLNFC		000200	SPD	ICH0		007340'		INPRAC		003032'		JBTCOT		003324'	EXT
GTLOBS		020000	SPD	ICS1		007300'		INPRB1		002712'		JBTLIC		011362'	EXT
GTLPSP		040000	SPD	ICW1		007332'		INPRB2		003060'		JBTPIP		015556'	EXT
GTLPTP		000002	SPD	ICW1A		007331'		INPRB3		003013'		JBTPRV		000000	EXT
GTLTAB		000010	SPD	ICW1B		007330'		INPRB4		003014'		JBTSTS		014751'	EXT
GTOPER		014055'	INT	IDLNEC		002644'		INPRB5		003023'		JBTUN1		011367'	EXT
HIGHJB		006640'	EXT	IFDET		014617'	INT	INPRB6		002736'		JBTUNM		011366'	EXT
HNGAL1		006642'		IFROOM		012713'		INPRB7		002740'		JBYEXC		015362'	EXT
HNGALL		006633'	INT	IGOBEC		002650'		INPRB8		002752'		JBYWAK		015357'	EXT
HNGAUX		011007'		IMGCH1		006363'		INPRB9		002747'		JERR		020000	SIN
HNGAX1		011011'		IMGCHG		006364'		INPRBC		002765'		JFYMIN		000522'	EXT
HNGAX4		011023'		IMGCNT		006352'		INPRET		002603'		JFYSEC		005604'	EXT
HNGAXD		011015'		IMGDEF		002112'		INPRT2		002757'		JLOG		000004	SIN
HNGJOB		006623'		IMGDIM		000002	SPD	INPRTA		003040'		JNA		040000	SIN
HNGMON		006534'	INT	IMGIT2		001277'		INPRTB		003026'		JOB		014002'	EXT
HNGPRT		006551'		IMGITM		001276'		INPRUB		002710'		JOBN		006712'	EXT
HNGTT1		006603'		IMGRM1		002153'		INPSTA		003062'		KAF1		000523'	INT
HNGTT2		006616'		IMGRMA		002125'		INPTAB		002561'		KEPBI		012117'	
HNGTT3		006617'		IMGRMT		002141'		INPTCA		002601'		KEPBI1		012126'	
HNGTTY		006572'		IMGTIM		000012	SPD	INPTYP		000262'		KEY10		000505'	
HNGUUL		006531'		INCBC		012023'		INRW1		007344'		KEY620		000614'	EXT
HNGUUO		006514'	INT	INCHRS		007276'		INTERM		015731'	INT	KEYSET		000507'	INT
HWDPNT		003240'	EXT	INCHRW		007343'		INTSET		015437'		KEYTIM		005600'	EXT
I		000010	SIN	INCHSL		007307'		INWL1		007321'		L2LBBP		040000	SPD
I1CHRW		007342'		INCHWL		007320'		IO		000020	SIN	L2LBSP		001000	SPD
I1CHWL		007317'		INCPBC		012044'		IOACT		010000	SIN	L2LCCS		200000	SPD
IAC10A		002225'		INISET		013746'	INT	IOBEG		000002	SIN	L2LDEL		004000	SPD
IAC11A		002232'		INISL2		014000'		IOBKTL		040000	SIN	L2LLDF		010000	SPD
IAC11B		002234'		INISLP		013757'		IODEND		020000	SIN	L2LNTB		020000	SPD
IAC11C		002235'		INLMES		012226'	EXT	IOEND		000040	SIN	L2LOEX		400000	SPD
IAC11D		002236'		INPA10		002515'		IOFST		000004	SIN	L2LOWS		002000	SPD
IAC16B		002463'		INPA94		002536'		IONEOU		007057'		L2LOWT		000400	SPD
IAC16C		002464'		INPACT		002511'		IOSBKA		100000	SPD	L2LTBK		100000	SPD
IACT0		002506'		INPAL1		002616'		IOW		000001	SIN	LAPBIT		000026	SPD
IACT1		002156'		INPBK2		002614'		IPOPJ		000000	EXT	LDBBIO		000005	SPD
IACT10		002222'		INPBRK		002557'		IPOPJ1		015111'	EXT	LDBBK2		000016	SPD
IACT11		002230'		INPBS1		002570'		IQUEUE		012274'		LDBBKC		000015	SPD
IACT12		002437'		INPBSP		002566'		IRING		012243'	EXT	LDBBKI		000007	SPD
IACT13		002445'		INPCH		015713'		IRP620		000727'	EXT	LDBBKP		000006	SPD
IACT14		002450'		INPCH2		000265'		IRPOLD		016105'		LDBBYT		000027	SPD
IACT15		002456'		INPCHR		000264'		IRPPDP		012253'	EXT	LDBCLA		000033	SPD
IACT17		002466'		INPCLD		002612'		IRPSTP		016103'		LDBDCH		000031	SIN
IACT2		002161'		INPDL1		000266'		IRPTIM		005632'	EXT	LDBDCX		000032	SPD
IACT21		002474'		INPDL2		000267'		ITMCHN		000000	EXT	LDBDDB		000000	SIN
IACT22		002477'		INPDLN		002635'		J		000002	INT	LDBECC		000014	SPD
IACT2A		002165'		INPES0		003114'		JACCT		000001	SIN	LDBECT		000013	SPD
IACT3		002170'		INPES1		003116'		JACCT2		100000	SIN	LDBFLP		000022	SPD
IACT4		002176'		INPESC		003067'		JBTABT		011446'	EXT	LDBLEN		000047	SIN
IACT5		002203'		INPEST		003110'		JBTAWQ		012771'	EXT	LDBLIN		000001	SPD
IACT5A		002205'		INPGOB		002621'		JBTBCS		006350'	EXT	LDBLOG		000026	SIN
IACT6		002210'		INPLIN		000263'		JBTBET		005746'	EXT	LDBMOD		000030	SPD
IACT7		002214'		INPOTP		002626'		JBTBIO		012006'	EXT	LDBOPB		000002	SPD
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 256-5
SCNSER.MAC	25-NOV-87 19:52		SYMBOL TABLE

LDBOUT		000003	SPD	LDPFA2		000163'		LDSELF		000032'		LOPSBL		000070'	
LDBRBC		000025	SPD	LDPFC1		000166'		LDSESC		000052'		LOPSEC		000065'	
LDBRBI		000023	SPD	LDPFC2		000162'		LDSHDX		000040'		LOPSGR		000101'	
LDBRBO		000024	SPD	LDPFRM		000210'		LDSIR		000035'		LOPSOG		000102'	
LDBSTR		000034	SIN	LDPHDX		000014'		LDSKAT		000050'		LOPSRD		000064'	
LDBTCB		000004	SPD	LDPHST		000154'		LDSOR		000036'		LOPSTC		000067'	
LDBTIC		000012	SPD	LDPIMB		000177'		LDSPA		000041'		LOPSTP		000066'	
LDBTIP		000010	SPD	LDPIR		000011'		LDSPAR		000037'		LOPSYL		000075'	
LDBTIT		000011	SPD	LDPKAT		000024'		LDSPB		000042'		LOPTRI		000060'	
LDBTMR		000044	SPD	LDPLCO		000215'		LDSPC		000043'		LOPTRO		000055'	
LDBTMS		000045	SPD	LDPLCT		000205'		LDSPD		000047'		LOPZAP		000077'	
LDBTMT		000046	SPD	LDPLMD		000174'		LDSQM		000053'		LOS620		016020'	
LDBTOC		000021	SPD	LDPLNO		000153'	INT	LDSRXE		000046'	INT	LOSPDP		016017'	
LDBTOP		000017	SPD	LDPMDF		000203'		LDSTOB		000051'		LPOPJ		014643'	
LDBTOT		000020	SPD	LDPMEC		000175'		LDSXON		000044'		LTSCIE	200000	000000	SPD
LDBTYP		000033	SPD	LDPMIN		000176'		LEVDEF		007430'		LTSCRD	020000	000000	SPD
LDEC		001166'		LDPMOD		000161'		LI.PIF		000400	SPD	LTSECH	000020	000000	SPD
LDICLE		000046	SPD	LDPMOU		000200'		LI.PIN		000200	SPD	LTSECO	400000	000000	SPD
LDICLR		000000	SPD	LDPNFC		000204'		LICAC		000400	SIN	LTSECR	040000	000000	SPD
LDLAUX		000040	SPD	LDPNTB		000157'		LICOPR		100000	SIN	LTSELF	100000	000000	SPD
LDLBK2		004000	SPD	LDPNXO		000211'		LICWCR		400000	SIN	LTSESC		400000	SPD
LDLBKA		010000	SPD	LDPOR		000012'		LINFLG		016745'	EXT	LTSHDX	001000	000000	SPD
LDLCOM		020000	SIN	LDPPA		000015'		LINFSV		015727'		LTSIR	010000	000000	SPD
LDLDEF		001000	SPD	LDPPAR		000013'		LINJOB		007372'	INT	LTSKAT	000002	000000	SPD
LDLECS		100000	SPD	LDPPB		000016'		LINPNM		015726'		LTSOR	004000	000000	SPD
LDLFRM		000001	SPD	LDPPC		000017'		LINPTR		015714'		LTSPA	000400	000000	SPD
LDLIMI		002000	SPD	LDPPD		000023'		LINTAB		015627'	EXT	LTSPAR	002000	000000	SPD
LDLLCP		000004	SPD	LDPPOS		000171'		LINTRP		015250'		LTSPB	000200	000000	SPD
LDLLCT		000020	SPD	LDPPSM		000172'		LLLHDX		004000	SPD	LTSPC	000100	000000	SPD
LDLNEC		000100	SPD	LDPPTP		000207'		LLLNLN		100000	SPD	LTSPD	000004	000000	SPD
LDLNFC		000200	SPD	LDPQM		000027'		LLLZAP		200000	SPD	LTSQM		200000	SPD
LDLNOP		400000	SPD	LDPRTC		000216'		LMLBIO		001000	SPD	LTSRXE	000010	000000	SPD
LDLOSU		000400	SPD	LDPRXE		000022'		LMLPSP		200000	SPD	LTSTOB	000001	000000	SPD
LDLPTP		000002	SPD	LDPSOX		000201'		LMLTBI		400000	SPD	LTSXON	000040	000000	SPD
LDLPTY		040000	SPD	LDPTAB		000206'		LNLZIN		400000	SPD	LXL120		400000	SPD
LDLSOX		200000	SPD	LDPTBK		000155'		LOGCH1		002031'		LXLBSD		100000	SPD
LDLTAB		000010	SPD	LDPTIM		000170'		LOGCH2		002034'		LXLDLR		020000	SPD
LDPBBP		000156'		LDPTOB		000025'		LOGCHR		001736'		LXLERA		040000	SPD
LDPBSD		000213'		LDPTYP		000220'		LOGIN		001151'		LXLLCO		010000	SPD
LDPBSP		000160'		LDPWDA		000165'		LOGLDB		015013'	EXT	LXLOOK		004000	SPD
LDPCHG		000173'		LDPWID		000164'		LOGZAP		016033'		LXLRTC		002000	SPD
LDPCIE		000005'		LDPXON		000020'		LOPBIN		000057'		LXRBRK		004000	SPD
LDPCLA		000217'		LDRBIP		010000	SPD	LOPBOP		000063'		LXRCGS		001000	SPD
LDPCOM		000202'		LDRBPS		400000	SPD	LOPBOT		000074'		LXRCHR		010000	SPD
LDPCRD		000010'		LDRDEM		040000	SPD	LOPBPF		000062'		LXRESC		400000	SPD
LDPDEM		000212'		LDRFCS		020000	SPD	LOPBPN		000061'		LXRICL		040000	SPD
LDPECH		000021'		LDRNXO		100000	SPD	LOPCGB		000056'		LXRIOS		000400	SPD
LDPECO		000004'		LDRXOS		200000	SPD	LOPECO		000100'		LXROBS		200000	SPD
LDPECR		000007'		LDSCIE		000031'		LOPFIL		000071'		LXROCL		020000	SPD
LDPELF		000006'		LDSCRD		000034'		LOPHNG		000076'		LXRPSS		100000	SPD
LDPERA		000214'		LDSECH		000045'		LOPHSH		000054'		LXRTCC		000200	SPD
LDPESC		000026'		LDSECO		000030'		LOPOUT		000073'		LXRYBS		002000	SPD
LDPFA1		000167'		LDSECR		000033'		LOPRUB		000072'		M		000013	INT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 256-6
SCNSER.MAC	25-NOV-87 19:52		SYMBOL TABLE

MAKDET		010736'		NZAPRS		016042'		P		000001	INT	PORTN		015542'	EXT
MAKDLC		010757'		OBFND		001215'		P1		000014	INT	PPORTN		000000	EXT
MAXAXC		000103	SPD	OBFND1		001216'		P2		000015	INT	PRCCR		005335'	
MAXTMC		000023	SPD	OBREC		015307'		P3		000016	INT	PRCFIL		005342'	
MD0405		001621'		OMX120		016023'		P4		000017	INT	PRCFL1		005357'	
MD0607		001625'		OMX30		016021'		PATCH2		015604'	INT	PRCOCW		005334'	
MD1011		001631'		ONEOU2		007050'		PBDISC		016076'		PRCOM		001023'	EXT
MD1213		001635'		ONEOU3		007052'		PBTIMO		003677'		PRCOT1		005362'	
MDFLMD		003124'		ONEOUT		007040'		PEVEN8		013612'	EXT	PRCOT2		005363'	
MLOWQ		014161'	EXT	OP0TYO		013602'	INT	PG		000003	INT	PRCOT3		005364'	
MLTNDB		001562'		OP1TYO		013576'		PGBIN		003655'		PRCOUT		005324'	
MO.LAC		400000	SPD	OP2TYO		013570'		PGBIN1		003671'		PROACT		005371'	
MONHNG		013471'	INT	OPCRET		000001	SPD	PGBOP		004001'		PROUCC		005567'	
MORLIN		003274'		OPRCT2		013524'		PGBOP1		004016'		PRPER		012236'	EXT
MORLN2		003301'		OPRCTY		013511'		PGBOP2		004021'		PRPRMT		015034'	EXT
MOVCH1		001603'		OPRFIL		013550'		PGBOP3		004035'		PRT2		012240'	EXT
MOVCH2		001600'		OPRFR1		014174'		PGBOT		003725'		PRTBTM		005613'	
MOVCHR		001576'		OPRFRE		014170'	INT	PGBOT1		003741'		PRTBVR		012226'	
MSGSIM		003557'		OPRLDB		015724'	INT	PGBOTC		003766'		PRTCRS		000561'	
MSKIRG		001461'	EXT	OPROUT		013561'	INT	PGBPF		003603'		PRTDEC		012235'	EXT
MSKORG		016251'	EXT	OPRSN2		014142'		PGBPN		003575'		PRTIRG		000770'	INT
MTR		000024	SPD	OPRSND		014140'	INT	PGCGB		003565'		PRTKEY		000611'	INT
MULCNT		015740'		OPRTIC		013510'	INT	PGECO		004712'		PRTOCT		001025'	EXT
MXLIN		007361'	EXT	OPRTIM		015732'	INT	PGFIL		005314'		PRTUT1		003222'	
MXMCNT		015742'		OPRWAT		014161'		PGHNG		003555'		PSDONE		001506'	
MXTIM		015607'	EXT	OPRWJB		016013'		PGHSH		004177'		PTBSIZ		000170	SPD
MXTYP		000063	SPD	OPSND1		014147'		PGOUT		004626'		PTYBUD		007675'	
NAMSC1		015227'		OQUEUE		012303'		PGRUB		004604'		PTYBUF		016046'	
NAMSC2		015235'		ORANGE		001212'		PGSBL		004067'		PTYDDB		007734'	
NAMSCN		015224'		ORING		014457'	EXT	PGSEC		003555'		PTYFLO		016045'	
NEWJER		002044'		ORP620		016250'	EXT	PGSGR		003554'		PTYLDB		007701'	
NEWTER		002047'		ORPOLD		016106'		PGSOG		003567'		PTYLOS		016032'	
NMXFLG		003171'	EXT	ORPPDP		016252'	EXT	PGSRD		003554'		PTYSBL		004100'	INT
NMXLIN		000000	EXT	ORPTIM		004122'	EXT	PGSTC		003556'		PTYTRN		003402'	
NOBASE		005610'	INT	OUPLIN		000271'		PGSTP		003555'		PUNIT		015214'	EXT
NOCTRO		007103'		OUPTYP		000270'		PGSYL		003607'		PVYHNG		006605'	EXT
NODIE		016573'	EXT	OUT		006272'	EXT	PGSYLN		003630'		PVYMOD		013012'	EXT
NOECHO		000200	SPD	OUTCHI		007037'		PGTRI		003637'		PX.MEM		000004	SPD
NOLIN		003341'		OUTPC1		007151'		PGTRI1		003652'		PX.SRC		000001	SPD
NOLIN2		003344'		OUTPC2		007156'		PGTRO		004040'		PXCT	256000	000000	
NOOUT		001134'		OUTPCF		007163'		PGZAP		004044'		QUEPCB		014201'	EXT
NOTLIN		004360'		OUTPT1		007126'		PGZAP1		004065'		RCVANS		012273'	
NOTOPR		004350'		OUTPTC		007143'		PJBSTS		014176'	EXT	RCVAUX		011131'	
NOXEXE		013745'	INT	OUTPTR		007122'		PJOBN		015550'	EXT	RCVCH1		001650'	
NRPCNT		015766'		OUTSN1		007201'		PJRST	324740	000000		RCVCH2		001670'	
NTTOPR		004416'		OUTSN2		007210'		PJUMPE	322000	000000		RCVCHR		001641'	
NUMECO		000024	SPD	OUTSNW		007171'		PNTOB1		007573'		RCVLOS		001432'	
NXTTTY		015341'		OUTST1		007070'		PNTOBK		007563'		RCVNSP		011051'	
NZAPAX		016041'		OUTSTR		007065'		POLPRT		011523'	INT	RCVPS		001474'	
NZAPIN		016036'		OUTTRN		003353'		POLPT1		011531'		RCVRAK		012222'	
NZAPLG		016040'		OWK120		016024'		POLPT3		011546'		RCVRES		012242'	
NZAPN2		016037'		OWK30		016022'		POLPT4		011551'		RCVS2		011074'	
NZAPOT		016043'		OWTIM		000024	SPD	POLPT5		011552'		RCVS2A		011076'	
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 256-7
SCNSER.MAC	25-NOV-87 19:52		SYMBOL TABLE

RCVS4		011103'		RMTVT		002360'		SCNEND		016761'	INT	SIMRZP		001514'	
RCVS6		011110'		RMXLIN		000735'	EXT	SCNIN		000722'		SKPFLG		016102'	
RCVSP		011114'		RNQ		014175'	EXT	SCNIN0		000731'		SKPIN1		007120'	
RCVSUR		011062'		RPORTN		012256'	EXT	SCNIN1		000746'		SKPINC		007100'	
RCVTCX		001455'		RT.CON		020000	SPD	SCNIN2		000751'		SKPINL		007110'	
RCVTMC		001447'		RT.MOD		300000	SPD	SCNINT		000622'	INT	SLCTAB		007253'	
RCVWK1		006016'		RT.SIG		040000	SPD	SCNLIT		016117'	INT	SLCTBN		000007	SPD
RCVZAP		001507'		RT.SLV		400000	SPD	SCNNAM		015213'		SNDAUX		011173'	
RDNXT		007412'		RTATC		014776'		SCNNMR		014130'		SNDBIO		001372'	
RDPI	700640	000000		RTATS		015037'		SCNNT0		000634'		SNDSAD		014437'	
RECHLT		001721'		RTATS1		015052'		SCNNT2		000713'		SNDSRQ		011211'	
RECHT1		001732'		RTATS2		015063'		SCNOUT		003164'		SPCCM1		013733'	
RECVRG		001674'		RTAUX%		000010	SPD	SCNPTR		016107'	INT	SPCCMD		013726'	
RED		001204'		RTCCO		015031'		SCNREL		000000	SPD	SPCCMW		000451	SIN
REFLAG		015630'	EXT	RTCONT		014725'		SCNSC0		005634'		SPCDBG		000444	SIN
RELB0		012115'		RTCSV		015021'		SCNSC1		005643'		SPCDND		000457	SIN
RELBB		012204'		RTCUS		015025'		SCNSC2		005647'		SPCF11		000450	SIN
RELBB1		012213'		RTERJ		015112'		SCNSEC		005574'	INT	SPCFLG		000444	SIN
RELBBF		012206'		RTERR		015113'		SCNSER		000000'	ENT	SPCGSW		013722'	INT
RELBI		012105'		RTFIN		015070'		SCNTCD		014205'	INT	SPCINI		013675'	INT
RELBIO		012150'		RTFIN1		015103'		SCNTIC		000701'		SPCMTD		000455	SIN
RELBO		012111'		RTFIN2		015107'		SCNVER		000001	SPD	SPCST1		013673'	
RELEA6		015110'	EXT	RTNRM%		000011	SPD	SCOLP		003176'		SPCTRN		000010	SPD
REQBUF		011741'		RTSAC%		000001	SPD	SCOLP1		003172'		SPCTRY		013674'	
RETACH		014732'	INT	RTSCP%		000007	SPD	SCOPTY		003210'		SPE940		005132'	
RETCH1		014763'		RTSNA%		000005	SPD	SCORTY		003242'		SPEALP		005157'	
RETCH2		014765'		RTSNX%		000002	SPD	SCOTTY		003251'		SPEALT		005161'	
RETZRO		007353'		RTTAC%		000003	SPD	SECLOP		005650'		SPEAP1		005154'	
RIDLIN		002654'		RTTAT%		000006	SPD	SECLP1		005657'		SPEBK3		005150'	
RIDLN1		002667'		RTTNX%		000004	SPD	SECLP2		005716'		SPEBK6		005152'	
RIDLN2		002702'		RUBSTR		002433'		SECLP3		005726'		SPEBRK		005146'	
RIDLN3		002704'		RWARN		001707'		SECLP4		005741'		SPEBS		005207'	
RLBIO1		012160'		RWARN1		001715'		SECTM1		005672'		SPEBS1		005216'	
RMTAL1		002323'		S		000000	INT	SECTM2		005700'		SPECR		005144'	
RMTALT		002325'		S$ENTR	777777	777775	SIN	SECTM3		005712'		SPEPDP		005120'	
RMTBSP		002415'		S$EVEN		000006	SIN	SETBRK		006343'		SPETAB		005170'	
RMTCN1		002321'		S$HALT	777777	777777	SIN	SETFIO		015536'		SPETB1		005177'	
RMTCNT		002242'		S$INFO		000005	SIN	SETIO2		010506'	EXT	SPEUC1		005266'	
RMTCR		002336'		S$JOB		000002	SIN	SETLIN		007262'		SPEUCM		005250'	
RMTECR		002253'		S$NAME		000000'	SPD	SETLMD		007534'		SPEUX		005222'	
RMTECT		002257'		S$NONA		000000	SIN	SETLN1		007265'		SPEUX1		005246'	
RMTEU1		002347'		S$PATC		000007	SIN	SETOPB		010342'		SPEUXC		005231'	
RMTEXC		002341'		S$STOP		000001	SIN	SETOUT		004123'		SPEVM		005203'	
RMTEXU		002345'		S$TEMP		000000	SPD	SETPTB		003453'		SPHNGI		013672'	
RMTFF		002366'		S$XCT	777777	777776	SIN	SETPTL		003431'		SPOBS1		005457'	
RMTPAT		002317'		S..KAF		000523'	EXT	SETPTP		007622'		SPOBS2		005450'	
RMTRUB		002353'		SAV30		016132'	EXT	SETRUN		014731'	EXT	SPOBSP		005452'	
RMTS10		002273'		SCN1PD		000557'		SETSHT		014407'	INT	SPOCR		005400'	
RMTS94		002305'		SCNBLN		000003	SIN	SETTB1		007553'		SPOFF		005432'	
RMTSPA		002264'		SCNBUF		016110'	INT	SETTBK		007540'		SPOFF1		005436'	
RMTSPT		002267'		SCNDDB		000244'	INT	SETTC1		010146'		SPOFIL		005463'	
RMTTAB		002374'		SCNDDS		000016	SIN	SETTC2		010202'		SPOFL1		005465'	
RMTTB1		002407'		SCNDSP		006263'		SETTCN		010145'		SPOTAB		005402'	
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 256-8
SCNSER.MAC	25-NOV-87 19:52		SYMBOL TABLE

SPOTB0		005415'		TCNBSD		000031	SPD	TKEXS%		000001	SIN	TTCGO		014362'	
SPOTB1		005425'		TCNBSP		000020	SPD	TKROM%		000000	SIN	TTCHKS		000004	SPD
SPOTBL		005373'		TCNCLA		000032	SPD	TMCALL		000077	SPD	TTCLST		015671'	EXT
SPOVT		005441'		TCNCRD		000000	SPD	TMCCIE		000001	SPD	TTCMCA		015721'	INT
SPOVT1		005445'		TCNDEF		000022	SPD	TMCCRD		000004	SPD	TTCMCH		015720'	INT
SPRCOM		013372'		TCNDSP		010207'		TMCECH		000015	SPD	TTCNO		014305'	
SPRCTB		013376'		TCNECH		000011	SPD	TMCECO		000000	SPD	TTCSET		014310'	
SPREAT		012547'		TCNERA		000021	SPD	TMCECR		000003	SPD	TTCSIX		014337'	
SPRETB		012555'		TCNFC1		000016	SPD	TMCELF		000002	SPD	TTCTYP		014345'	
SPRTTB		012432'		TCNFC2		000017	SPD	TMCESC		000022	SPD	TTCVAL		014323'	
SPRTYI		012427'		TCNFRM		000025	SPD	TMCHDX		000010	SPD	TTCVL0		014331'	
SSPT		005565'		TCNHDX		000004	SPD	TMCIR		000005	SPD	TTCVL1		014332'	
STATES		016645'	EXT	TCNIR		000001	SPD	TMCKAT		000020	SPD	TTCVL2		014333'	
STAUTO	000001	000000	SIN	TCNKAT		000034	SPD	TMCOOR		016044'		TTCVL3		014334'	
STDALT		000033	SPD	TCNLCO		000023	SPD	TMCOR		000006	SPD	TTCWDD		014250'	
STLST		006054'		TCNLCT		000026	SPD	TMCPA		000011	SPD	TTCWDN		000035	SPD
STOP10		000003	SPD	TCNN		000036	SPD	TMCPAR		000007	SPD	TTCWDT		014213'	
STOP9		000037	SPD	TCNNFC		000027	SPD	TMCPB		000012	SPD	TTFORC		013276'	
STOTC1		007354'		TCNNXO		000014	SPD	TMCPC		000013	SPD	TTFREE		015666'	EXT
STRUB		002426'		TCNOR		000002	SPD	TMCPD		000017	SPD	TTFREN		015712'	
STRUB1		002422'		TCNPA		000005	SPD	TMCQM		000023	SPD	TTGC1		006131'	
STSHUT		400000	SIN	TCNPAR		000003	SPD	TMCRXE		000016	SPD	TTGETC		006114'	
STSUPR		200000	SIN	TCNPB		000006	SPD	TMCSIZ		000001	SPD	TTIEND		015707'	INT
STTIOD		006013'	EXT	TCNPC		000007	SPD	TMCSLP		000025	SPD	TTINI2		015616'	
STTLK		006701'	INT	TCNPD		000013	SPD	TMCTOB		000021	SPD	TTINI3		015660'	
STTLK0		006711'		TCNPTP		000030	SPD	TMCXON		000014	SPD	TTINI4		015701'	
STTLK1		006734'		TCNRTC		000033	SPD	TO11DB		020000	SPD	TTKJOB		006616'	EXT
STTLK2		006741'		TCNRXE		000012	SPD	TOEMAX		016025'		TTNCHR		000001	SIN
STTLK3		006752'		TCNTAB		000024	SPD	TOWAIT		013163'		TTNESC		000000	SIN
STTYBF		000020	SIN	TCNTYP		000035	SPD	TOWAT1		013166'		TTNLIN		000002	SIN
SUPTIM		011052'	EXT	TCNWID		000015	SPD	TOWATA		014040'		TTNYLB		000006	SIN
SVOJFF		015730'		TCNXON		000010	SPD	TPOPJ		015552'	EXT	TTOUT1		006414'	
SVPPC		013663'	INT	TCVMAX		010245'		TPOPJ1		015553'	EXT	TTOUT2		006424'	
SVSPC		015717'		TDTUUO		014563'	INT	TRESCN		013312'	INT	TTOUT3		006432'	
SYSNUM		015641'	EXT	THSDAT		000000	EXT	TRESCU		007075'		TTOUT4		006441'	
T1		000006	INT	THSTIM		015606'	EXT	TRMAUX		000000	SPD	TTOUT5		006442'	
T2		000007	INT	TIHLTN		016015'		TRMBYP		000152'		TTPC1		006161'	
T2POPJ		013321'	EXT	TILOW		000120	SPD	TRMTAB		002052'		TTPC2		006160'	
T3		000010	INT	TIME		000000	EXT	TRPLEN		000014	SPD	TTPUTC		006135'	
T4		000011	INT	TIMOW		015743'		TSETBI		006203'	INT	TTSCL1		015412'	
TABPTR		005555'		TIMRST		015007'	EXT	TSETBO		006234'		TTSCL2		015365'	
TABTMR		000004'		TINAS1		015427'	INT	TSTBO1		006241'		TTSCL3		015413'	
TABTMS		000030'		TINASS		015554'	INT	TSTBO2		006256'		TTSCLR		015352'	INT
TAKNZJ		015314'	EXT	TINDET		015566'		TSTKTJ		013127'	EXT	TTTCL1		015422'	
TAKOTJ		015257'	EXT	TINFIO		040000	SPD	TSTKTP		012700'	EXT	TTTCL2		015424'	
TAKTRJ		015106'	EXT	TIOUSE		020000	SPD	TSTTRJ		000000	EXT	TTTCLR		015416'	INT
TAKTRP		015600'	EXT	TIRSVD		000003	SPD	TT2CHK		000010	SPD	TTUUOT		007017'	
TATUU1		014721'		TIWAIT		013150'		TTCCLR		014307'		TTVIN2		013761'	EXT
TATUUO		014673'	INT	TIWAKE		006005'		TTCDO1		014316'		TTVINI		015631'	EXT
TBFL		005534'		TIWAKN		006017'		TTCFIL		014372'		TTYAT1		014651'	
TBFL2		005540'		TIWKC		000110	SPD	TTCFIN		014321'		TTYAT2		014657'	
TCBALL		000003'		TIWRNN		016014'		TTCFL0		014377'		TTYATC		020000	SIN
TCNBSD		000031	SPD	TKATT%		000002	SIN	TTCFL1		014400'		TTYATI		014645'	
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 256-9
SCNSER.MAC	25-NOV-87 19:52		SYMBOL TABLE

TTYATT		014636'	INT	TTYUS1		013446'		TYIRPT		012407'		TYPRED		000017	SPD
TTYBMT		000744'	INT	TTYUSM		013440'	INT	TYITAB		012454'		TYPRES		000003	SPD
TTYBNP		001251'	INT	TTYUSR		013435'	INT	TYMTC		010310'		TYPSAD		000033	SPD
TTYBPN		000767'	INT	TTYUSW		013434'	INT	TYMTC1		010311'		TYPSHT		000002	SPD
TTYCMR		013452'	INT	TTYUU1		006767'		TYMTC2		010333'		TYPSUP		000026	SPD
TTYDET		014571'	INT	TTYUU2		006773'		TYO		012573'		TYPSUR		000027	SPD
TTYERP		014014'	INT	TTYUU3		007003'		TYO1		012601'		TYPTCP		000037	SPD
TTYFLK		015734'	INT	TTYUUO		006755'	INT	TYO2		012611'		TYPTCR		000040	SPD
TTYFLM		006064'	INT	TTYWAK		015315'	INT	TYO3		012623'		TYPTCS		000036	SPD
TTYFND		014003'	INT	TTYWK1		015334'		TYOW		012627'		TYPTRN		001030'	
TTYFNU		014002'	INT	TTYWK2		015321'		TYOW1		012637'		TYPTSP		000031	SPD
TTYFUW		014033'	INT	TTYWK3		015330'		TYOW2		012640'		TYPTSR		000032	SPD
TTYFW1		014034'		TTYYLS		015527'	INT	TYOW3		012643'		TYPYEL		000020	SPD
TTYHLT		013475'	INT	TTYZAP		014622'		TYOW4		012644'		TYPZAP		000013	SPD
TTYIN		006276'		TTYZNE		001244'	INT	TYP.00		000000		U		000005	INT
TTYIN1		006320'		TUUAIR		040000	SPD	TYPANS		000001	SPD	UPARPT		005511'	
TTYIN3		006326'		TUUATI		400000	SPD	TYPAUX		000007	SPD	UPASC		005512'	
TTYIN5		006306'		TUUATO		200000	SPD	TYPAXC		000030	SPD	UPDKEY		000506'	INT
TTYIN6		006337'		TUUATR		100000	SPD	TYPBIN		000046	SPD	UPOPJ		003541'	
TTYIN8		006334'		TUUEAT		010000	SPD	TYPBKO		000044	SPD	UPSHUT		015725'	
TTYINI		015603'	INT	TUUFXI		004000	SPD	TYPBOC		000045	SPD	UPTIME		000622'	EXT
TTYINX		006335'		TUUIMI		002000	SPD	TYPBRK		000057	SPD	USRWAK		005750'	
TTYKD1		014545'		TUUROM		020000	SPD	TYPCLP		000042	SPD	USRWK1		005775'	
TTYKDB		014504'		TWABT		013146'		TYPCLR		000043	SPD	UUIDPB	136000	000000	
TTYKIL		014467'	INT	TWAITC		013114'		TYPEAD		000061	SPD	UUILDB	134000	000000	
TTYLOS		016031'		TWAITL		013051'		TYPECF		000035	SPD	UUOLDB		013004'	
TTYLST		000244'		TWAITS		013112'		TYPECN		000034	SPD	VTFLP		005523'	
TTYMXL		033000	SIN	TWTC1		013131'		TYPEDC		000014	SPD	W		000012	INT
TTYNAM		014121'	INT	TWTC2		013144'		TYPETM		000023	SPD	WATLIN		003312'	
TTYNFB		012173'	INT	TWTL1		013076'		TYPGOB		000012	SPD	WRDOT2		004161'	
TTYNFR		015200'	INT	TWTL2		013105'		TYPGRN		000016	SPD	WRDOUT		004144'	
TTYNNC		006132'	INT	TWTL3		013102'		TYPHNG		000022	SPD	WRPCH2		000274'	
TTYNPB		003663'	INT	TWTSPC		200000	SPD	TYPHSI		000041	SPD	WRPCHR		000273'	
TTYOUS		006461'		TYCIOS		014601'	INT	TYPIHR		000053	SPD	WRPI	700600	000000	
TTYOUT		006377'		TYI		012365'		TYPINB		000047	SPD	WRPLIN		000272'	
TTYOUW		400000	SIN	TYI940		012445'		TYPINE		000050	SPD	WSCHED		014166'	EXT
TTYPH2		014105'		TYIALT		012467'		TYPINT		000051	SPD	WSYNC		014044'	EXT
TTYPH3		014103'		TYIATB		012412'		TYPIRQ		000052	SPD	WSYNC1		013214'	
TTYPH4		014073'		TYIBRK		012457'		TYPKAF		000063	SPD	WSYNC2		013213'	
TTYPHY		014061'	INT	TYIBSP		012461'		TYPLAD		000062	SPD	WSYNCS		013170'	
TTYPTY		003211'	INT	TYIC		012417'		TYPLDC		000015	SPD	WTCHK		004676'	
TTYRES		006651'	INT	TYICC		012502'		TYPLOG		000006	SPD	XA		000002	SIN
TTYRHT		016016'		TYICCP		012500'		TYPLOS		000025	SPD	XMTWAK		006070'	
TTYRS1		006671'		TYICZ		012473'		TYPLTM		000024	SPD	XMTWK1		006110'	
TTYSET		007103'	INT	TYID		012422'		TYPNEG		000056	SPD	XPNOUT		006452'	
TTYSOW		014052'	INT	TYIEAT		012514'		TYPNOP		000010	SPD	XXCBLK		014554'	
TTYSRC		014006'	INT	TYIET2		012565'		TYPNSP		000005	SPD	XXCDDB		014552'	
TTYSTC		013455'	INT	TYIET3		012564'		TYPOHR		000055	SPD	XXCSER		014553'	
TTYSTR		013460'	INT	TYIL		012520'		TYPORG		000021	SPD	XXNBLK		014557'	
TTYSZS		006371'		TYIOS1		014604'		TYPORQ		000054	SPD	XXNDDB		014555'	
TTYTAB		016741'	EXT	TYIOS2		014606'		TYPOUP		000011	SPD	XXNSER		014556'	
TTYTBL		014214'	INT	TYIPAL		012465'		TYPPSR		000060	SPD	XXPBLK		014562'	
TTYUS0		013441'		TYIPDP		012436'		TYPRAK		000004	SPD	XXPDDB		014560'	
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88 PAGE 256-10
SCNSER.MAC	25-NOV-87 19:52		SYMBOL TABLE

XXPSER		014561'		.ASWTP		000007	SPD	
XXQ		000000	SPD	.CPDWD		013604'	EXT	
XXXQ		000007	SPD	.DTCTO		004000	SIN	
XXXR		000000	SPD	.DTESP		004400	SIN	
YELLOW		001222'		.DTRSW		001400	SIN	
YELLW1		001235'		.PVHCN		000002	SIN	
YLBUG		000000	SPD	.RTMCO		000002	SPD	
ZAPAL1		011511'		.RTMCU		000001	SPD	
ZAPALL		011507'		.RTMSV		000000	SPD	
ZAPAUX		011024'		.RTMUS		000003	SPD	
ZAPBG1		004476'		
ZAPBUG		004460'		
ZAPCIR		011477'	INT	
ZAPDFR		001241'		
ZAPLOG		001242'		
ZAPLPT		016034'		
ZBGBIT		004447'		
ZBGBUG		004442'		
ZBGBYT		004450'		
ZBGDCH		004444'		
ZBGDCX		004452'		
ZBGDDB		004445'		
ZBGLIN		004443'		
ZBGLOG		004453'		
ZBGMOD		004451'		
ZBGOUT		004446'		
ZRPCNT		015767'		
ZZ	005557	664555	SPD	
ZZ0		000002	SPD	
ZZBIT		000043	SPD	
ZZN		000001	SPD	
ZZPOS		000043	SPD	
ZZWORD		000001	SPD	
%CHBRK		000002	SPD	
%CHRMX		000036	SPD	
%FRAUX		000001	SPD	
%FRBIG		000002	SPD	
%FRBRK		000004	SPD	
%FRCMD		000003	SPD	
%FRFUL		000006	SPD	
%FRNBK		000005	SPD	
%FROK		000000	SPD	
%PBTIM		000017	SPD	
.ARATT		000007	SIN	
.ARDET		000010	SIN	
.ARHNG		000054	SIN	

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

A	   615
ABTUUO	   107%	  5232	  5310	  5374	  5670	  5673	  5678	  5820	  5840	  6940	  7048	  8482	  8484	  8495
	  8501	  8659	  8813	  8820	  8989	  8992	  9028	 10694
ACBBP	  6442	  6755#
ACBRKC	  6399	  6838#
ACBSPC	  6554	  6668#
ACDEFC	  6556	  6687#
ACERAC	  6555	  6679#
ACHNG	  6436	  6821#
ACIN1	  6847#	  6849
ACIN2	  6850#	  6864	  6870
ACINSC	  6389	  6855#
ACINWB	  6390	  6866#
ACINWC	  6388	  6846#
ACNTB	  6409	  6735#
ACNZP	  6449	  6780#
ACOTCI	  5753#	  6392
ACPSM	  6437	  6831#
ACPTPC	  6562	  6705#
ACSFS	  6440	  6796#
ACSOB	  6444	  6809#
ACSOX	  6445	  6766#
ACSYL	  6398	  6803#
ACTBK	  6410	  6744#
ACTCLA	  6564	  6729#
ACTCN	  6447	  6459#
ACTCP	  6448	  6469#
ACTCP1	  6475	  6478#
ACTCP2	  6477	  6488#
ACTMC	  6400	  6401	  6402	  6403	  6404	  6405	  6406	  6407	  6408	  6411	  6412	  6413	  6431	  6432
	  6433	  6434	  6435	  6438	  6439	  6441	  6451	  6452	  6453	  6454	  6455	  6787#
ACTTYP	  6567	  6718#
ACTWRT	  7472%	  7472	  7482%	  7482
ACWIDC	  6551	  6658#
ADRERR	    90%	  5243
ADVBFE	    90%	  5344	  5362
ADVBFF	    90%	  5263
ADVPTR	  3578#	  3627	  3643
AL	   615
ALR620	    76%	  4844	  9990	 10011	 10025	 10030
ALROPR	  4843	  9989
ALRSNT	 10012	 10023	 11151#
ARSTAB	  7151	  7153#
ASSCON	  5571	  6342	  7045	  7078	  7098	  7461	 10076	 10164	 10225	 10476	 10511	 10582	 10610
ASSPRG	  7045	 10076	 10164	 10582
AUXCHR	  7277	  7297#
AUXCLP	  7305#	  7310
AUXDET	  7361	  7363	  7366	  7371#
AUXEND	  7404	 11155#
AUXERR	  7196	  7358	  7447	  7477	 11157#
AUXGV1	  7474	  7485#
AUXINP	  7223	  7238#
AUXJOB	  7200	  7373	 11158#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

AUXLIC	  7411	  7419	  7421	  7423	  7426#
AUXNSB	  7395	  7396	  7398#
AUXPRT	  7239	  7289	  7300	  7372	 11165#
AUXRCP	  7105	  7107	  7143	  7197	  7241	  7359	  7449	  7465	  7483	 11152#
AUXRED	  7492#
AUXRID	  7045#	  8506	  8786	  8795	  8994	  9021
AUXRL1	  7499#	  7502	  7504	  7509
AUXRL2	  7505	  7509#
AUXRN1	  7497	  7500	  7510#
AUXSLP	  7386#	  7398
AUXSTA	  7141	  7146	  7150	  7165	  7170	  7193	  7199	  7215	  7218	  7221	  7267	  7293	  7325	  7331
	  7445	  7486	 11153#
AUXSTL	    40#	   501	  2115	  7130	  7261	  7384	 11154
AUXSTM	    39#	    40	  7377
AUXSTP	  7168	  7305	  7314	 11156#
AUXSTR	  7167	  7259	  7376	  7382	  7383	  7384	 11154#
AUXTIM	  7274	  7276	  7278	  7279	  7292	  7324	 11166#
AUXTMP	  7282#	  7323
AUXTMR	  7281#	  7291
AUXTOV	  7269	  7330#
AUXTU0	  6366	  6369#
AUXTU1	  6381	  6385#
AUXTUU	  6353#	  6368
AUXUNM	  7378	  7380	  7381	  7412	  7413	 11167#
AUXWAK	  7186	  7199#
AUXWPC	  7231	 11160#
AUXWPN	  7230#	  7240
AUXWPT	  7232	 11161#
AUXWSC	  7227	 11159#
AUXWST	  7217	  7224	  7226#
AUXZAP	  5226	  7122#
AUXZPT	  7228	  7233	  7235#
AXAVAL	   100%	  7488	  7937
AXCDON	  7306	  7316	  7322#
AXCLP1	  7302#	  7320
AXCLP2	  7309	  7312#
AXCTAB	  6362	  6388#	  6456
AXELOG	  7476#
AXERGV	  7417	  7425	  7448	  7453	  7459	  7475#
AXGIV	  7356	  7476	  7483#
AXNRL	  7340	  7341	  7346#
AXNRR	  7336	  7338	  7343#
AXREQ	   100%	  7353	  7487	  7926	  7936
AXSFIN	  7391	  7402#
AXSFN1	  7387	  7400#
AXSNTB	  7268	  7272#
AXSWT	   100%	  7355
AXTOTB	  7332	  7334#
AXWAIT	   100%	  7354	  7927
AXZP1	  7123	  7131#
B	   615	  1662
BADGUY	  3657	 11122#
BADKEY	  1096	  1126	  1290	 11232#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

BADPR1	  1371#	  1396
BADPRT	  1369	  1383#
BASDWN	  1121%	  1121	  1240%	  1240	  1260	  1288%	  1288	  4812%	  4812	  8388%	  8388
BASE	  1133#
BASE04	  1132#
BASEOK	  8365#	  8392
BASTIM	  4807	  4807#	  4809
BASVER	  1289%	  1289	  1552	  4798	  8364%	  8364	  8371	  8374	  8390%	  8390	  8391%	  8391	  8395
BBCRE	 11176#
BBFREE	  8082	  8120	  8123	  8152	 11175#
BBPOOL	  8124	 11178#
BBREL	 11177#
BIOANS	  1773	  1780	  1785	 11179#
BIOATT	  8486	  8500#
BIOBUF	  7985	  8115	  8140	 11174#
BIOCHG	  4857	  4935#
BIOCHK	  7675	  7702	  7730#
BIOCHR	  1634	  1691	  1706	  1721	  3178	  3254	  3335	  3386	  3412	  3456	  3458	  3459	  3471	  3985
	  4946	  7594#	  7642	  7688	  7715	  7750	  7829	  7859	  7861	  8517
BIOCNT	  1321	  1771	  1786	  3366	  7928	  7929	  7949	  7961	  7965	  7971	  7976	  7978	 11169#
BIOCOR	    87%	  4962	  8084	  8141
BIOCSH	  3918	  3948	  7590#	  7825	  7865
BIODAT	  3388	  3473	  4003	  4954	  7595#
BIOJOB	  1801	  1803	  7930	 11164#
BIOLNK	  7589#
BIOPBC	  3182	  3240	  3338	  3370	  3387	  3417	  3472	  3484	  3505	  7592#
BIOPBP	  3180	  3237	  3390	  3475	  3485	  3512	  7591#
BIOPRT	  1790	  1793	  1800	  7934	 11172#
BIOREL	  5461	  5558	  7653#	 10187
BIOREQ	  3453	  3454	  3455	  7593#	  7786	  7790	  7792	  7813
BIORES	  7629	  7645	  7654	  7666	  7670#
BIOWAK	  1638	  4948#
BIOZAD	  3944#
BIOZAP	  1900	  7661#
BITNTB	    76%	  2939
BK2IOS	   647#	  5552	  8940
BKTOPN	  6154	  6160#
BLKEOF	  7680	  7707	  7724#
BLKEOT	  1485	  1655#
BLKIB1	  1633#	  1663	  1667	  1683
BLKIB2	  1638#	  1669
BLKIB3	  1647#	  1722
BLKIBF	  1484	  1624#
BLKICK	  1626	  1657	  1675	  1704#
BLKIHR	  1489	  1714#
BLKINP	  6417	  7675#	  7699
BLKINS	  6418	  7702#
BLKIO	  6416	  7599#	  7608	  7614
BLKIO1	  7605	  7610#
BLKIO2	  7603	  7617#
BLKIP1	  7683	  7686	  7689	  7697#
BLKIRQ	  1692	  7793	  7815	  7821#
BLKITM	  1486	  1673#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

BLKNEG	  1493	  1780#
BLKNG2	  1792	  1795#
BLKNG3	  1797	  1800#
BLKNG4	  1791	  1801#
BLKOH1	  1737	  1739	  1743#
BLKOHR	  1481	  1492	  1731#
BLKOT1	  7841	  7845#
BLKOUT	  6419	  7836#	  7844
BLKTRQ	  1664	  8515	  8527#
BLKX1	  7631	  7638#	  7656	  7658
BLKX2	  7639	  7644#
BLKXI1	  8514	  8521#
BLKXIN	  6420	  7640	  8510#
BLKXIO	  6422	  7625#	  7634
BLKXOT	  6421	  7657	  8538#
BLKXT1	  8546	  8550#
BPAVAL	   102%	  1799	  8074
BPFCOM	  9085	  9098	  9108	  9111	  9113#
BPFTYI	  8559	  9089#
BPLVD	  6049	  9076#
BPLVD1	  9078	  9081#
BPOFF	  4894	  6125	  9106#	  9311
BPOKBN	   327#	  3002
BPREQ	   102%	  1795	  1796	  8037	  8055	  8073	 10969
BPTEST	  6124	  9121#	  9310	  9316
BPWAIT	   102%	  8056
BPXOFF	  4169	  5184	  7735	  9105#	  9317
BSLASC	  4708	  4709#
BUFCLR	    90%	  5242
BUFLST	  8125	  8130	  8149	  8151	 11168#
BV.DBG	  4797	  8361#
BV.HDN	  8362#
BYP1	   835#	   846	   855	  1259	  1261
BYP2	   836#	   847	   850	   856	   860	  1263	  1919	  3606	 10031
BYP3	   837#	   848	   861	  1259	  1261
BYP4	   838#	   849	   851	   862	  1259	  1261	  3986	 10026
BYTTC	  6550	  6552	  6553	  6557	  6558	  6559	  6560	  6561	  6563	  6565	  6603#
CCASC	  4690	  4691#	  4694
CCPTR	  2870	  2873	  4690#
CCTYI	  9181#	 10973
CCTYI1	  9183	  9189#
CCTYO	  9174#	  9399	  9408	  9790	  9795	 10975
CHCNT	  2997	  3054	  3193	  3238	  3433	  3462	  3487	  3488	  3503	  3569	  3743	  4498	  4504	  4520
	  4568	  4585	  4677	 11127#
CHGCLK	   100%	 10230	 10410
CHKBAS	  1111#
CHKCHR	 10817	 10839#
CHKLIN	  5994	  6002#	  6014	  6021	  6026
CHKLN2	  5873	  6001#	  6057
CHKLOS	 10821	 10832#
CHKPSP	 10824	 10865#
CHKRM1	  8802	  8811#
CHKRM2	  8819#	  8826
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

CHKRM3	  8805	  8824#
CHKROM	  5312	  5685	  6367	  8801#
CHKSEG	    92%	  6012
CHKTCC	 10827	 10872#
CHKYEL	 10825	 10890#
CHPECH	   876#	  2336	  4153
CHPINP	   872#	  1958	  2797
CHPOUT	   873#	  4539
CHPRED	   875#	  8573	  8684	  9207
CHPSPE	   879#	  2362	  4328
CHPSPI	   878#	  2553	  2807
CHPSPO	   874#	  4590
CHPSPR	   877#	  8595	  8694	  9222
CHQTA	  2996	  3053	  3239	  3434	 11128#
CHRCNT	  6160	  6171	  6184#
CHRML1	  1921#	  1923
CHRML2	  1944#	  1947
CHRML3	  1924	  1947#
CHRMLT	  1373	  1916#
CHRRDP	  1920	  1921	  1944	 11144#
CHRTAB	   882#	  1956	  1957	  2796	  4151	  4152	  4537	  4538	  8571	  8572	  8682	  8683	  9206
CHRTRP	  2015	 10647#
CHRWRP	  3162	  3181	  3197	  3236	  3496	  3607	  3628	  3644	  3645	  3741	  4496	  4502	  4518	  4566
	  4583	  4675	 11145#
CIMTAB	  1959	  1964#
CKATI1	  8868	  8881#
CKATI2	  8861	  8865#
CKATIW	  8869#	  8883
CKATO1	  8897	  8904#
CKATO2	  5672	  8890	  8894#
CKATTF	  5335	  5353	  8790#	  8797	  9687
CKATTI	  5231	  5373	  5677	  8658	  8859#	  8879	  8991	  9014
CKATTO	  5309	  5669	  8888#	  8903
CKLGO	 10001#
CKLN1	  6003	  6007#
CKLNTR	 10818	 10849#
CKOPR	  9987	  9993#
CKSXON	  9298	  9316#
CL11PT	  9555
CLKJOB	 10229%	 10229	 10409%	 10409
CLKRSP	  1478	  1843#
CLNOC	  4062	  4088#
CLNOCP	  4070	  4087#
CLRIM1	  6115	  6119#
CLRIMI	  5315	  5739	  5756	  5764	  5804	  5824	  5852	  6114#
CLRMLT	  1925#	  1951
CLRPTY	  3851	  3857#
CLRTTY	  3659	  3838#	  8441
CLSCHR	  1300	  1755	  3061	  3564#	  3664	  3721	  3752	  3771	  3794	  3968	  4016	  4097	  7286	  7297
	 10015
CLSLP1	  3211#	  3217
CLSLP2	  3220	  3223#
CLSPBF	  3241	  3254#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

CLSPTB	  3195	  3228#
CLSPTL	  3070	  3192#
CMDCKW	  4120%	  4120
CMDTYO	  5863	  8758#	  9177
CMDWAK	  2521	  4210	  9132#	  9299
CMDWK1	  9133	  9136#
CMFCHT	  5015%	  5015
CMFCXI	  9622%	  9622	 11017%	 11017
CMFCXN	  2163%	  2163
CMFSTA	  2846%	  2846
CNCCHK	  2859	  5002#	  8647
CNCCK1	  5006	  5014#
CNCMD1	  9290	  9309#
CNCMOD	  5014	  9308#	 10260	 10440
CNTCHR	  6190	  6194	  6203#	  6208
CNTECO	  4143#	  4167
CNTOUT	  4063#	  4073
CNTPRT	  1376#	  1385	  1388	  1391	  1394
CNTRUB	  4036#	  4046
COASC	  4704	  4705#
COM940	  9227	  9228	  9239#
COMATB	  9208	  9216#
COMATT	  6348	 10233	 10413	 10485	 10528#
COMBSP	  9237	  9245	  9252#
COMGMS	  1852%	  1852
COMKJB	  5518%	  5518
COMPA	  9243	  9257#
COMPDP	  9226	  9229	  9231#
COMTAB	  9236	  9244	  9247#
COMTI1	  9204#	  9210
COMTI2	  9211#	  9225	  9250	  9255	  9260
COMTIA	  9204	 10974	 11132#
COMTOA	  9169	  9379	  9391	 10976	 11133#
COMTYI	  9193#
COMTYO	  5654	  9168#
COMTYT	  9193	  9197#
COMWCM	  9151%	  9151
COMXON	  3735	  3741#	  3763	  3787
CONFIG	    79%
CONMES	  1165%	  1165	  2169%	  2169	  2175%	  2175	  9602%	  9602	  9605%	  9605
COPTR	  2681	  2684	  4704#
CPERR	  6241	  6247	  6258	  6264#
CPNPT%	  6236#	  6240
CPNRM%	  6237#	  6246	  6257
CPOPJ	    82%	  1524	  1698	  1744	  1821	  1904	  2080	  2768	  3597	  4661	  4935	  5040	  5047	  5297
	  5305	  5526	  5551	  5680	  5713	  5744	  5827	  5855	  6008	  6010	  6358	  6737	  6746	  6757
	  6782	  7054	  7521	  7716	  8542	  8590	  8910	  9080	  9093	  9110	  9174	  9271	  9288	  9292
	  9652	  9654	  9752	 10074	 10110	 10131	 10145	 10568	 10652	 10660	 10676	 10703	 10731	 10807
	 10809	 10902	 10924
CPOPJ1	    82%	  3567	  3608	  3632	  3649	  4125	  4127	  4132	  4479	  4484	  4506	  4587	  4674	  4683
	  4687	  5085	  5104	  5221	  5530	  5661	  5857	  5999	  6262	  6281	  6489	  6532	  6607	  6620
	  6659	  6664	  6671	  6675	  6680	  6683	  6688	  6696	  6700	  6706	  6714	  6720	  6725	  6732
	  6888	  6896	  7270	  7272	  7512	  7692	  7719	  7737	  7796	  7888	  7950	  8001	  8008	  8060
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

	  8503	  8569	  8576	  8580	  8810	  8864	  8893	  9200	  9214	  9392	  9625	  9657	  9665	  9711	  9746
	  9754	  9789	  9830	  9968	  9969	  9974	 10002	 10004	 10013	 10034	 10173	 10234	 10597	 10614
	 10855
CPUF3	  1254	  1333	  7351	  9328	  9475	 11051
CPUKI	  1319	  1746	  1750	  4004	  4008	  7350	  7925	  7940	  7964	  7967	  8368	  8385	  9328	  9475
CPUKL	  1319	  1746	  1750	  3917	  3947	  4949	  7350	  7822	  7863	  7925	  7940	  7964	  7967	  8368
	  8385	  9330	  9510
CPUKS	  1333	  3928	  4806	  7351	  9329	  9485
CPUTYP	  1254	  1319	  1333	  1746	  1750	  3917	  3928	  3947	  4004	  4008	  4806	  4949	  7350	  7351
	  7822	  7863	  7925	  7940	  7964	  7967	  8368	  8385	  9328	  9329	  9330	  9475	  9485	  9510
	 11051
CPZZ	  1254#	  1254	  1319#	  1319	  1333#	  1333	  1746#	  1746	  1750#	  1750	  3917#	  3917	  3928#	  3928
	  3947#	  3947	  4004#	  4004	  4008#	  4008	  4806#	  4806	  4949#	  4949	  7350#	  7350	  7351#	  7351
	  7822#	  7822	  7863#	  7863	  7925#	  7925	  7940#	  7940	  7964#	  7964	  7967#	  7967	  8368#	  8368
	  8385#	  8385	  9328#	  9328	  9329#	  9329	  9330#	  9330	  9475#	  9475	  9485#	  9485	  9510#	  9510
	 11051#	 11051
CREAUX	  7353#
CREPTY	  6239#
CRLF	  1170%	  1170	  1427%	  1427	  2980%	  2980
CRPTR	  2352	  4452	  4560	  4615	  4694#
CRSHWD	  1111	  1116	  1135%	  1135	  5534%	  5534
CSHSAV	  3921%	  3921	  3951%	  3951
CSRTAB	  4955	  4955%	  4956	  4957	  4958	  4959	  4963	  4964	  4965	  4966	  4967
CSUCNT	  3919%	  3919	  3925%	  3925	  7823%	  7823
CSUNL	  3924%	  3924
CSVAL	  3954%	  3954
CSVCNT	  3949%	  3949	  3955%	  3955	  7864%	  7864
CTEXT1	  9936%	  9936	  9945%	  9945
CTY	    58#
CTYBLF	  1233	  9321#	  9334	  9336
CTYBUF	  9465%	  9465
CTYCHR	  9338	  9348	  9363	  9430	  9439	  9473	  9511#
CTYDO	  4799%	  4799
CTYFIL	  9354	  9434	  9437	 11183#
CTYFLN	  9340	  9356	  9364	 11184#
CTYFRM	  9352	  9359#
CTYINP	  1235%	  1235
CTYLDB	   340#	   516	  1232	  5608	  8842	  9324	  9407	  9595	  9674	  9710	  9782	  9784	  9793
CTYLOG	  9346	  9427	  9458#
CTYNFL	  9355	  9366#
CTYPTR	  9462%	  9462	  9463%	  9463
CTYSFL	  9356#	  9360
CTYTY1	  9438#	  9440
CTYTYL	  9451#	  9454
CTYTYO	  9418	  9426#	  9453
CTYTYP	  9450#
CUASC	  4696	  4697#
CUPTR	  2676	  2679	  4696#
CX2AX%	  7034#	  7424
CXDCB%	  7036#	  7458
CXDTP	  7350#	  7371
CXERR%	  7040#	  7177
CXLOG%	  7035#	  7416
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

CXNCH%	  7039#	  7452	  7481
CXNRL%	  7038#	  7346
CXNRR%	  7037#	  7343
DATE	  1853%	  1853	  7139%	  7139
DBYT	  5218#
DCL	  5223#
DCLBBP	   623#	 10548
DCLCOM	   626#	  5516	 10426
DCLNTB	   625#	 10539
DCLTBK	   624#	 10544
DDBBLK	   628#	  7069	 10078	 10086	 10090	 10094	 10101	 10573	 10580
DDBCNE	 10113#
DDBDCH	   600	   601	   602	   603	   605	   622#	  5517	 10427	 10537	 10596
DDBLDB	   629#	  5248	  5333	  5485	  5527	  5554	  5620	  6357	  6797	  7085	  7116	  7122	  7125	  7362
	  7468	  7503	  7520	  7532	  7564	  8502	  8782	  8791	  8860	  8889	  9655	 10003	 10062	 10075
	 10139	 10140	 10221	 10243	 10370	 10402	 10455	 10491	 10531	 10607	 10715	 10762	 10810	 10901
	 10938
DDBSR1	  6337	  7070	  7457	 10469	 10567#	 11012
DDBSRC	 10215	 10566#	 10605
DDBTRP	   576	   577	   578	   579	   580	   581	   582	   583	   584	   585	   586	   587	   630#	 10590
	 10591	 10793	 10794
DDINT	  5217#
DDPBBP	   600#	  6758
DDPCOM	   605#	  5491	 10144	 10383
DDPIMB	   603#	  6842	 10535
DDPMOD	   604#	  1661	  1680
DDPNTB	   602#	  6738
DDPNZP	   606#	  6780	  6783
DDPTAB	   574#	   589	   593	   594	   595	   596	 10805	 10808
DDPTBK	   601#	  6747
DDPTCG	   586#	  1515
DDPTCH	   577#	   594	 10653	 10755	 10757	 10770	 10772
DDPTLC	   581#	  1824	  2067
DDPTLN	   578#	   595	  1641	 10664	 10758	 10760	 10767	 10769
DDPTOB	   582#	   596	 10704	 10764	 10766
DDPTPS	   584#	  1867
DDPTSC	   576#	   593	 10678	 10690
DDPTTC	   587#	  6525
DDPTTI	   579#	  6936	  8480	  8491	  8768	  8814	  8824	  8871	  8898	  8987	  9010
DDPTTS	   580#	  5054
DDPTYB	   585#	  1604
DDPTZP	   583#	  5503	  7096	 10509
DDTIN	  5372#
DDTINL	  5381#	  5387
DDTINX	  5382	  5384	  5388#
DDTOUT	  5394#
DDXZ	  5216#
DEBUGF	  1262%	  1262
DECBC	  1699	  1742	  7672	  7955#
DECBC1	  7972	  7980	  7984#
DECBC2	  7987#	  7991
DECBC3	  7988	  7992#
DECIN1	  9920%	  9920	  9967%	  9967
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

DECPBC	  7957	  7976#
DEFBRK	  2226#	  2275
DEFCHR	  2225#	  2265	  2284
DEFNBK	  2227#	  2530	  2539	  2549
DETALL	  1245	  8394	  8428#
DETON1	  8439	  8442#
DETONE	  8429	  8435#
DEVBUF	  5250	  5328
DEVCLS	   621#
DEVIAD	  5241	  5244	  5260
DEVIOS	   604	  1666	  1679	  1823	  2066	  4128	  4888	  4924	  4929	  4974	  4981	  4990	  5051	  5058
	  5267	  5318	  5320	  5325	  5347	  5365	  5505	  5553	  6030	  6116	  6363	  6798	  6935	  7084
	  7133	  7135	  7725	  8522	  8640	  8740	  8790	  8828	  8859	  8875	  8877	  8888	  8954	  8963
	  9001	  9030	  9032	  9046	  9048	  9058	  9070	  9274	  9656	  9692	  9699	  9703	 10060	 10160
	 10163	 10551	 10595	 10712	 10832	 10910
DEVLOG	 10055	 10584
DEVLST	 10108%	 10108
DEVMOD	   606	  1906	  5008	  5474	  5569	  6343	  6345	  7046	  7052	  7075	  7077	  7079	  7464	  7501
	  7530	  7562	  8505	  8785	  8794	  8863	  8892	  9020	 10077	 10099	 10158	 10165	 10226	 10477
	 10484	 10494	 10578	 10583	 10611	 10732	 10753
DEVNAM	  5486	  7082	  7131	  9753	 10054	 10141	 10222	 10461	 10492	 10609	 10622	 10623	 10634
DEVOAD	  5326
DEVOPR	    86%	  3800	  3842	  9719	  9993	 11025
DEVSER	 10079	 10084	 10088	 10092	 10097	 10104	 10111	 10569	 10571	 10572	 10575	 10730
DFRZAP	  1615	 11216#
DHNG	  5221#
DIDPBI	  3160	  3175	  3194	  3431	 11227#
DIE	    11	    11%	    12	  1132	  1133	  1375	  1396	  1618	  1627	  2958	  3384	  3556	  3888	  3944
	  4811	  5040	  5101	  8121	  8365	 10113
DIN	  5225#
DINI	  5220#
DINITF	  1098%	  1098
DLRSUP	   648#	  5552	  8926
DOOUT	  1442	  1530#
DOU	  5224#
DRL	  5222#
DSPSIZ	  5216	  5227#
DTE	  9520	  9555	  9576
DTEDII	  9550
DTEDRW	  9554
DTEEPW	  9552	  9553
DTEHLT	  9549	  9585#
DVIN	   615
DVNZP	  5568	  7074	  7463
DVOUT	   615
DVRMT	 10100	 10157	 10733	 10752
DVSIZ	  5219#
DVTTY	   615	  7498	  7529	  7563	 10100	 10579	 10733
DWNFLG	  3812	  3854	  5535	 11182#
DZAP	  5226#
E1IDPB	  4228	  4282	  4301	  4495#
E2IDPB	  4242	  4271	  4477	  4501#
EAC10A	  4248	  4251#	  4275	  4324
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

EAC10B	  4254#	  4265
EAC11A	  4270	  4273#
EAC14A	  4198	  4200	  4308	  4311#
EAC15A	  4199	  4319	  4322#
EAC4A	  4197	  4236#
EACT1	  4182	  4205#
EACT10	  4184	  4185	  4247#
EACT11	  4194	  4195	  4269#
EACT12	  4183	  4184	  4185	  4287	  4293#	  4300	  4302
EACT13	  4188	  4189	  4190	  4299#
EACT14	  4188	  4190	  4307#
EACT15	  4189	  4318#
EACT16	  4192	  4216#
EACT17	  4193	  4194	  4195	  4286#
EACT1A	  4210#	  4224
EACT1B	  4207#	  4238	  4244
EACT2	  4182	  4221#	  4229
EACT3	  4187	  4228#
EACT4	  4187	  4234#
EACT5	  4192	  4242#
EACT6	  4183	  4260#
EACT6A	  4261	  4264#	  4276	  4281	  4283	  4295	  4313
EACT7	  4193	  4280#
EATTAB	  8685	  8688#
ECHBAK	  4161#	  4206	  4217	  4235	  4250	  4263	  4289	  4310	  4321	  4441	  4451
ECHLST	  4166#	  4209	  4253
ECHRPT	  4149	  4154#	  4360	  4365	  4370	  4375	  4406	  4411	  4428	  4433
ECHSPA	  4173	  4327#
ECHSPT	  4329	  4331#
ECHT12	  4174	  4175	  4182#
ECHT34	  4176	  4177	  4187#
ECHT56	  4178	  4179	  4192#
ECHT7	  4180	  4197#
ECHTAB	  4155	  4173#
EDEC	  1445	  1566#
ENTRUB	  2026	  2418	  2421	  2463#	  2487	  2738	  2740	  2744	  2753	  4481
EPCOU1	  4465	  4488#	  4495	  4501
EPCOUT	  4205	  4216	  4234	  4249	  4262	  4288	  4309	  4320	  4487#
EPT	  9330%	  9330	  9513%	  9513	  9518%	  9518	  9519%	  9519	  9544%	  9544	  9545%	  9545	  9546%	  9546
	  9550%	  9550	  9552%	  9552	  9553%	  9553	  9554%	  9554	  9567%	  9567	  9572%	  9572	  9573%	  9573
	  9578%	  9578
EPTDT0	  9550	  9552	  9553	  9554
ERRBNG	  1782	 11181#
ERRXIT	  7178	  7184	  7190	  7196#	  7344	  7347
ESCTR1	  8646	 10687#
ESCTRP	  2850	 10671#
F	   576	   577	   578	   579	   580	   581	   582	   583	   584	   585	   586	   587	   600	   601
	   602	   603	   604	   605	   606	  1505	  1506	  1512	  1513	  1602	  1603	  1629	  1660	  1666
	  1677	  1679	  1708	  1723	  1724	  1743	  1744	  1820	  1821	  1823	  1865	  1866	  1903	  1904
	  1906	  1934	  1935	  2063	  2064	  2066	  2158	  3050	  3051	  3555	  4123	  4124	  4126	  4127
	  4128	  4853	  4876	  4888	  4922	  4924	  4929	  4935	  4972	  4973	  4974	  4981	  4990	  5005
	  5006	  5008	  5046	  5047	  5051	  5058	  5241	  5244	  5248	  5250	  5260	  5267	  5296	  5297
	  5318	  5320	  5325	  5326	  5328	  5333	  5347	  5365	  5471	  5472	  5474	  5485	  5486	  5505
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

	  5517	  5525	  5526	  5527	  5550	  5551	  5553	  5554	  5569	  5757	  6009	  6010	  6016	  6017	  6028
	  6029	  6030	  6114	  6115	  6116	  6248	  6252	  6343	  6345	  6353	  6357	  6363	  6518	  6523
	  6524	  6529	  6797	  6798	  6935	  7046	  7052	  7068	  7069	  7073	  7079	  7082	  7083	  7084
	  7085	  7094	  7095	  7113	  7114	  7116	  7122	  7125	  7131	  7133	  7135	  7360	  7361	  7362
	  7464	  7468	  7469	  7501	  7503	  7517	  7520	  7530	  7532	  7562	  7564	  7725	  8502	  8505
	  8522	  8637	  8638	  8640	  8740	  8782	  8785	  8790	  8791	  8794	  8828	  8859	  8860	  8863
	  8875	  8877	  8888	  8889	  8892	  8954	  8963	  9001	  9020	  9030	  9032	  9046	  9048	  9052
	  9056	  9058	  9070	  9143	  9144	  9145	  9146	  9147	  9153	  9272	  9273	  9274	  9653	  9654
	  9655	  9656	  9682	  9692	  9699	  9703	  9745	  9752	  9753	 10001	 10002	 10003	 10050	 10054
	 10055	 10060	 10062	 10074	 10075	 10077	 10078	 10079	 10081	 10084	 10086	 10104	 10105	 10106
	 10139	 10140	 10141	 10158	 10160	 10163	 10165	 10195	 10218	 10219	 10220	 10221	 10222	 10223
	 10226	 10231	 10243	 10367	 10370	 10387	 10393	 10394	 10402	 10427	 10446	 10450	 10455	 10461
	 10477	 10484	 10490	 10491	 10492	 10494	 10528	 10531	 10532	 10537	 10551	 10567	 10568	 10569
	 10570	 10572	 10573	 10575	 10580	 10583	 10584	 10590	 10591	 10595	 10596	 10607	 10609	 10611
	 10613	 10622	 10623	 10634	 10651	 10652	 10659	 10660	 10675	 10676	 10702	 10703	 10708	 10712
	 10715	 10724	 10728	 10730	 10731	 10732	 10741	 10753	 10762	 10779	 10793	 10794	 10810	 10832
	 10901	 10910	 10918	 10920	 10922	 10923	 10924	 10937	 10938	 10939	 10941	 10943
FARCHK	 10331%	 10331	 10348%	 10348
FCREQ	   101%	  8039	  8085	  8088	  8090	  8136
FCS	   650#	  5552	  8934
FCWAIT	   101%	  8089
FDRUPX	  5425%	  5425
FFFLP	  2438	  4636	  4712#
FFLP0	  4712	  4713#	  4715
FILERS	  4730	  4731	  4732	  4735	  4736	  4737	  4740	  4741	  4742	  4745	  4746	  4747	  4762#
FINLIN	  3032#	  3464	  3509	  3543	  3660	  3684	  3726	  3744	  3836	  3931	  3945	  3963	  3964	  4054
	  4081	  4168
FINOUT	  2929	  3064	  3074	  3084#
FIXIMI	  5236	  6100#	  6799
FLGCHR	 10654
FLGESC	 10679	 10691
FLGLIN	 10665
FLLBSC	  2682	  2683	  2836	  2871	  2872	  4708#
FLLFFS	  4639	  4729#
FLLVTS	  4649	  4734#
FLMX	  4730	  4731	  4732	  4735	  4736	  4737	  4740	  4741	  4742	  4745	  4746	  4747	  4762	  4770
FMTB	  3688	  3693	  3700	  3708	  3713	  3721#	  4026	  4115
FMTB1	  3723#	  3757	  3776	  4021	  4104
FNDPRT	  6355	  7518	 10368	 10447	 10918#	 10944
FNDPT1	 10919	 10924#
FPOPJ	  9145	  9147	  9153#
FRCCGB	  1512#	  3293
FRCDOO	  1531#	  3319	  3397
FRCEOT	  1657#	  3339
FRCIBF	  1626#	  3255
FRCIHR	  1716#	  3373
FRCINP	  6415	  6873#
FRCITM	  1675#	  3418
FRCLOS	  1816#	  3549	  3553
FRCLP0	  6877#	  6880
FRCLP1	  6886#	  6890
FRCLP2	  6894#	  6899
FRCNOO	  1523#	  3261	  3312	  3341	  3421
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

FRCOHR	  1736#	  3463	  3507	  3519	  8548
FRCORG	  1583#	  3303
FRCRS1	  6927#	  6945
FRCRS2	  6933	  6946#
FRCRS3	  6965#	  6972
FRCRS4	  6966	  6985#
FRCRS5	  6977	  6992#
FRCRS6	  6980	  6988	  6993	  6996#
FRCRS7	  6997	  7000#
FRCRSC	  6446	  6910#
FRCRSX	  6914	  6919	  6925	  7006#
FRCYEL	  1592#	  3350
FRCZAP	  1883#	  3541	  5101	  8440
FREBUF	  1629	  1649	  1660	  1677	  1697#	  1724
FRECHK	  4038	  4065	  5138#	  8562	  8673	  9344
FREST	  5025#	  5028
FRETTY	 10103	 10105	 10567	 10570	 11142#
FREUP	  4052	  5024#	  5164	  5166	  5192
FRMASN	  2159%	  2159	  9618%	  9618	 11004%	 11004
FRMKJF	  2176%	  2176	  9621%	  9621
FRSDEF	  6952	  6954	  6996	 11229#
FRSFLG	  6948	  6950	  6971	  6986	  9132	  9134	 11228#
FRSTTY	  7061	  7418	  7496	  7525	  7558	 10151	 10710	 10728#	 10750	 10781
FSCN	  1332	  3084	  3086	  3570	  3623	  3639	 11123#
FULLCQ	  2668	  2721	  2761	  4993#
FULLIN	  3010	  3028	  3037	  3047	  3050#	  3514	  3665	  3683	  3722	  3753	  3772	  3795	  3915	  3938
	  4017	  4035	  4043	  4092	  4098	  4142	  4162	  4493	  4521
FULLN2	  3051	  3057#
FULLN3	  3057	  3068#
GEPM10	  6077	  6094#
GEPM11	  6079	  6095#
GEPM12	  6081	  6096#
GEPMC1	  6061	  6085#
GEPMC2	  6063	  6086#
GEPMC3	  6065	  6087#
GEPMC4	  6066	  6088#
GEPMC5	  6067	  6089#
GEPMC6	  6069	  6090#
GEPMC7	  6071	  6091#
GEPMC8	  6073	  6092#
GEPMC9	  6075	  6093#
GET4WD	    87%	  8086
GETBB	  8057	  8082#	  8091
GETBB1	  8083	  8123#
GETBBP	  7989	  8120#
GETBI	  7788	  7805	  7998#
GETBIO	  7998	  8005	  8048#
GETBO	  7845	  8005#
GETCHK	  2036	  2472	  5150#	  8760
GETCTY	  9674#
GETDDB	  9750#
GETLIN	  5722	  5872#
GETLNZ	  5874	  5904#	  6058
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

GETLOG	  5994#
GETLPS	  6021#
GETMC	  5714	  6056#
GETMOD	  6026#
GETOP1	  9669	  9682#
GETOPR	  9664	  9668#	  9709
GETPP	  6239	  6271#
GETPP1	  6272#	  6277	  6280
GINST	  5246#	  5246	  5247	  5257#	  5257	  5258	  5262#	  5262	  5263	  5300#	  5300	  5301	  5327#	  5327
	  5328	  5336#	  5336	  5337	  5376#	  5376	  5377	  5386#	  5386	  5387	  5389#	  5389	  5390	  5394#
	  5394	  5395	  5651#	  5651	  5652	  5737#	  5737	  5738	  5754#	  5754	  5755	  5767#	  5767	  5768
	  5806#	  5806	  5807	  5808#	  5808	  5809	  5816#	  5816	  5817	  5826#	  5826	  5827	  5828#	  5828
	  5829	  5830#	  5830	  5831	  5843#	  5843	  5844	  5844#	  5845	  5856#	  5856	  5857	  5858#	  5858
	  5859	  5862#	  5862	  5863	  5872#	  5872	  5873	  5901#	  5901	  5902	  5904#	  5904	  5905	  5934#
	  5934	  5935	  5981#	  5981	  5982	  5998#	  5998	  5999	  6044#	  6044	  6045	  6056#	  6056	  6057
	  6082#	  6082	  6083	  6261#	  6261	  6262	  6264#	  6264	  6265	  6353#	  6353	  6354	  6359#	  6359
	  6360	  6459#	  6459	  6460	  6460#	  6461	  6463#	  6463	  6464	  6476#	  6476	  6477	  6483#	  6483
	  6484	  6487#	  6487	  6488	  6736#	  6736	  6737	  6745#	  6745	  6746	  6756#	  6756	  6757	  6772#
	  6772	  6773	  6781#	  6781	  6782	  6788#	  6788	  6789	  6791#	  6791	  6792	  6832#	  6832	  6833
	  6838#	  6838	  6839	  6851#	  6851	  6852	  6873#	  6873	  6874	  6877#	  6877	  6878	  6886#	  6886
	  6887	  6894#	  6894	  6895	  6921#	  6921	  6922	  6961#	  6961	  6962	  6967#	  6967	  6968	  6978#
	  6978	  6979	  7008#	  7008	  7009	  7090#	  7090	  7091	  7386#	  7386	  7387	  7467#	  7467	  7468
	  7475#	  7475	  7476	  7493#	  7493	  7507#	  7507	  7508	  7510#	  7510	  7511	  7511#	  7512	  7554#
	  7554	  7555	  7574#	  7574	  7575	  7576#	  7576	  7577	  7583#	  7583	  7584	  7754#	  7754	  7755
	  7810#	  7810	  7811	  7847#	  7847	  7848	  7858#	  7858	  7859	  7862#	  7862	  7863	  9788#	  9788
	  9789	  9794#	  9794	  9795	 10324#	 10324	 10325	 10325#	 10326	 10385#	 10385	 10386	 10518#	 10518
	 10519
GIV4WD	    87%	  8143
GOBCH1	  1511	  1515#
GOBCH2	  1513	  1516	  1518#
GOBCHR	  1443	  1505#
GOBIN	  3094	  3914#
GOBIN1	  3922	  3927#
GOBIO1	  3914	  3937	  3968#
GOBIO2	  3930	  3962	  3983#
GOBOP	  3098	  3936#
GOBOT	  3107	  3937#
GOBOT1	  3952	  3957#
GOBOT3	  3941	  3946#
GOBPF	  3097	  3749#
GOBPN	  3096	  3767#
GOBPN1	  3768	  3771#
GOCGB	  3093	  3692#
GOECO	  3111	  4136#
GOFIL	  3104	  4512#	  4522
GOHNG	  3109	  3712#
GOHSH	  3091	  3655#
GOLIN	  2999	  3001#	  3022
GOLIN1	  3001	  3003	  3013#
GOLIN2	  3007	  3012#
GOLIN3	  3008#	  4139
GOOUT	  3106	  4059#
GORUB	  3105	  4032#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

GOSBL	  3103	  3730#
GOSEC	  3100	  3704#
GOSGR	  3112	  4108#
GOSOG	  3113	  4110#
GOSRD	  3099	  3687#
GOSTC	  3102	  3664#
GOSTC1	  3666#	  3681
GOSTP	  3101	  3697#
GOSYL	  3108	  4097#
GOTBF0	  7785	  7791#
GOTBF1	  7781	  7789	  7794#
GOTBUF	  7690	  7717	  7743#
GOTRI	  3095	  4025#
GOTRO	  3092	  4016#
GOXOFF	  3770	  3780#
GOXON	  3751	  3761#
GOZAP	  3110	  3790#
GREEN	  1447	  1570#
GTBIO1	  8054	  8057#
GTCGSZ	    91%	  5278
GTLCRD	  5892	  5915#	  5926
GTLDEF	  5916#
GTLECS	  5910#
GTLESC	  5883	  5914#
GTLFRM	  5922#	  5931
GTLHDX	  5880	  5913#	  5925
GTLLCT	  5900	  5919#	  5928	  5935
GTLLRD	  5898	  5899	  5918#
GTLMSK	  5877	  5908#
GTLNFC	  5917#	  5927
GTLOBS	  5885	  5912#
GTLPSP	  5889	  5911#
GTLPTP	  5921#	  5930
GTLTAB	  5920#	  5929
GTOPER	  9709#
HIGHJB	    79%	  5539
HNGAL1	  5541#	  5546
HNGALL	  5442	  5534#
HNGAUX	  5470	  5475	  7094#
HNGAX1	  7096#	  7118
HNGAX4	  7106	  7109#
HNGAXD	  7095	  7103#	  7114
HNGJOB	  5444	  5523#	  5543
HNGMON	  5430	  5440#	  9303
HNGPRT	  5458#	  7523	  7535
HNGTT1	  5484	  5487	  5495#
HNGTT2	  5496	  5512#
HNGTT3	  5499	  5516#
HNGTTY	  1912	  5478	  5483#	  5529	 10501
HNGUUL	  5417	  5434#
HNGUUO	  5415#
HWDPNT	  1153%	  1153	  2975	  2979
I	   615	  1681	  5270	  5337	  6102	  6117
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

I1CHRW	  5987#	  6424
I1CHWL	  5966#	  6426
IAC10A	  2307	  2322#
IAC11A	  2330#	  2496
IAC11B	  2299	  2324	  2332#
IAC11C	  2300	  2333#
IAC11D	  2331	  2334#	  2522
IAC16B	  2502	  2520#
IAC16C	  2511	  2521#
IACT0	  1986	  1991	  1996	  2001	  2552#
IACT1	  1987	  2263#
IACT10	  1994	  1999	  2319#
IACT11	  1997	  2328#
IACT12	  1999	  2491#
IACT13	  2002	  2500#
IACT14	  2003	  2506#
IACT15	  2004	  2515#
IACT17	  2004	  2525#
IACT2	  1988	  2269#
IACT21	  2002	  2537#
IACT22	  2003	  2543#
IACT2A	  2273#	  2292
IACT3	  1989	  2279#
IACT4	  1989	  2288#
IACT5	  1992	  2296#
IACT5A	  2298#	  2315
IACT6	  1993	  1998	  2304#
IACT7	  1994	  2310#
IB	   615
ICH0	  5971	  5984#
ICS1	  5950#	  5954	  5962
ICW1	  5977#	  5985
ICW1A	  5956	  5976#	  5992
ICW1B	  5964	  5975#
IDLNEC	  2673	  2676#
IFDET	 10172#
IFROOM	  5644	  5860	  8838#	  9175
IGOBEC	  2657	  2681#
IMGCH1	  5285	  5293#
IMGCHG	  2238	  4879	  5289	  5294#
IMGCNT	  2224	  2253	  5283#
IMGDEF	  1965	  2219#
IMGDIM	    47#	  2220	  2234	  2249
IMGIT2	  1665#	  1725
IMGITM	  1664#	  1682
IMGRM1	  2244	  2255	  2258#
IMGRMA	  1966	  2233#
IMGRMT	  1967	  2248#
IMGTIM	    48#	  9033
INCBC	  7617	  7918#
INCHRS	  5718	  5948#	  6425
INCHRW	  5716	  5988#
INCHSL	  5721	  5957#	  6427
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

INCHWL	  5720	  5967#
INCPBC	  7920	  7949#
INISET	  9592#
INISL2	  9610	  9624#
INISLP	  9607#	  9624
INLMES	  1142%	  1142	  1146%	  1146	  1150%	  1150	  1154%	  1154	  1161%	  1161	  1401%	  1401	  1405%	  1405
	  1409%	  1409	  1414%	  1414	  2972	  2976	  4815%	  4815	  8369%	  8369
INPA10	  2556	  2559	  2561#
INPA94	  2557	  2558	  2579#
INPACT	  2554	  2556#
INPAL1	  2591	  2647#
INPBK2	  2574	  2592	  2626	  2643#	  2762
INPBRK	  2565	  2568	  2569	  2570	  2572	  2573	  2575	  2580	  2582	  2584	  2595	  2598#	  2648	  2669
	  2722	  2845	  2877
INPBS1	  2594	  2613#
INPBSP	  2576	  2611#
INPCH	  2730	  2746	  2771	  2792	 11125#
INPCH2	   849#	  1425	  1829
INPCHR	   848#	  1422	  1788	  1815	  1830	  1859	  7164	  7175	  7183	  7189	  7238
INPCLD	  2587	  2640#
INPDL1	   850#	  1846
INPDL2	   851#	  1551	  1624	  1655	  1673	  1714	  1843
INPDLN	  2566	  2583	  2668#
INPES0	  2860	  2875#
INPES1	  2858	  2877#
INPESC	  2562	  2586	  2588	  2649	  2850#
INPEST	  2867	  2870#
INPGOB	  2564	  2593	  2653#
INPLIN	   847#	  1367	  1419
INPOTP	  2658#	  2674	  2837	  2868
INPRA1	  2811#	  2834
INPRAC	  2803	  2807#
INPRB1	  2590	  2613	  2721#
INPRB2	  2724	  2836#
INPRB3	  2789	  2791#
INPRB4	  2782	  2792#
INPRB5	  2799#	  2812
INPRB6	  2736	  2741#
INPRB7	  2729	  2743#
INPRB8	  2742	  2749	  2753#
INPRB9	  2733	  2750#
INPRBC	  2723	  2763	  2767#
INPRET	  2563	  2581	  2630#
INPRT2	  2761#
INPRTA	  2808	  2814#
INPRTB	  2798	  2803#
INPRUB	  2571	  2611	  2719#
INPSTA	  2577	  2843#
INPTAB	  2567	  2585	  2603#
INPTCA	  2625#
INPTYP	   846#	  1366	  1416	  1932
INRW1	  5989#	  5991
INTERM	  2084	  2150	  3811	  3853	 10968	 11140#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

INTSET	 10811	 10816#
INWL1	  5968#	  5974
IO	  4950	  5324	  8874	  9029	  9045	  9691	  9702
IOACT	  4129	  4975	  4980	  4989	  5062	  5346	  5364	  8876	  9031	  9045	  9059	  9264	  9691	  9702
	 10159	 10162
IOBEG	  5316
IOBKTL	  1678	  1822	  2065	 10833
IODEND	  7724	  7733	  8521
IOEND	  1665	  4887	  5233	  5969	  7679	  7706	  7724	  7778	  8519	  8639	  8978
IOFST	  5266	  5324	 10059	 10593
IONEOU	  5729	  5754#	  6391
IOSBKA	   641#	  5552	  8938	  8962	  9000
IOW	  4978	  4980	  9264	 10159	 10162
IPOPJ	    82%
IPOPJ1	    82%	 10500	 10503	 10513
IQUEUE	  7612	  7697	  8480#
IRING	    78%	   846	   847	   848	   849	   850	   851	  1918	  8363	  8389
IRP620	    78%	  1117	  1148	  1247	  1330	  1338
IRPOLD	  1118	  1249	 11233#
IRPPDP	    78%	  1246	  1329	  1378	  1407	  1411	  8398
IRPSTP	  1339	  1341	 11231#
IRPTIM	  1227%	  1227	  1337%	  1337	  4802%	  4802	  4808%	  4808	  4819%	  4819
ITMCHN	  5235	  5235%	  5314	  5375	  5738	  5755	  5765	  5805	  5825	  5853	  5948	  5957	  5967	  5988
	  6032	  6846	  6855	  6866	  7736	  7839	  7924
J	  1507	  1508	  1514	  1801	  1911	  5055	  5059	  5060	  5061	  5277	  5279	  5421	  5428	  5429
	  5435	  5476	  5477	  5483	  5495	  5528	  5550	  5628	  6011	  6334	  6340	  6354	  6519	  6528
	  7059	  7068	  7072	  7073	  7080	  7200	  7357	  7360	  7373	  7410	  7414	  7415	  7455	  7460
	  7485	  7746	  7854	  7930	  8483	  8494	  8500	  8645	  8772	  8811	  8812	  8917	  8918	  8921
	  9148	  9149	  9150	  9152	  9633	  9652	  9653	  9802	  9803	  9813	  9814	  9818	  9819	  9821
	 10001	 10227	 10229	 10231	 10248	 10274	 10337	 10342	 10354	 10359	 10362	 10366	 10386	 10392
	 10393	 10409	 10466	 10474	 10489	 10517	 10612	 10613	 10728	 10736	 10918	 10927	 10935	 10937
	 11029	 11030	 11031	 11032	 11038	 11040	 11045
JACCT	  5012
JACCT2	  5012
JBTABT	    76%	  7357	  7485
JBTAWQ	    77%	  8483	  8494	  8500	  8772	  8812	  8866	  8895
JBTBCS	    77%	  5279	  5280
JBTBET	    77%	  4937	  4938
JBTBIO	    77%	  7746	  7747	  7854	  7855
JBTCIN	    77%	  1937	  1938
JBTCOT	    77%	  3055	  3056
JBTLIC	    77%	  5435	  5628	  7059	  7410
JBTPIP	   107%	 10935
JBTPRV	    83%
JBTSTS	    83%	  1508	  5011	  5614	 10274	 10337	 10354
JBTUN1	    76%	  7415
JBTUNM	    76%	  7414
JBYEXC	 10747%	 10747	 10749%	 10749
JBYWAK	 10744%	 10744	 10746%	 10746
JERR	 10276
JFYMIN	  1101%	  1101
JFYSEC	    86%	  1850	  4805%	  4805
JLOG	  1509
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

JNA	  5611	 10336	 10353
JOB	    84%	  6354	  8645	  9633
JOBN	    79%	  5523	  5613
KAF1	  1102#
KEPBI	  7783	  8032#
KEPBI1	  8035	  8039#
KEY10	  1084#	  1089	  1094	  1125	  1164	  9414
KEY620	  1090%	  1090	  1124%	  1124	  1127%	  1127	  1163
KEYSET	  1090#	  9416
KEYTIM	  1092%	  1092	  1226%	  1226	  4801%	  4801
L2LBBP	   398#	  2618	  2831	  4425	  4430	  5563	  6148	  6151	  6759	  6761	  8625	  8708	  9252	 10547
	 10549
L2LBSP	   405#	  2728	  4657
L2LCCS	   396#	  2031	  2856	  2880	  5182
L2LDEL	   401#	  2021	  2031	  2660	  2743	  3299	  4111	  5182
L2LLDF	   400#	  4123	  4970	  5784	  6047	  6813	  9138
L2LNTB	   399#	  2427	  2434	  2441	  4401	  4415	  5559	 10540	 10541
L2LOEX	   393#	  5354	  8905	 10717
L2LOWS	   403#	  3348	  4101	  4902
L2LOWT	   406#	  1585	  1884	  3346	  3525	  3790	  4099	  4898	  4917	  5048	  5201
L2LTBK	   397#	  2604	  2821	  4403	  4408	  5561	  6748	  6750	  8619	  8707	  9247	 10543	 10545
LAPBIT	   330#	  3004
LDBBIO	   352#	  1633	  1690	  1704	  1718	  1736	  1899	  3176	  3233	  3333	  3364	  3382	  3410	  3444
	  3448	  3451	  3452	  3468	  3481	  3527	  3792	  3916	  3940	  4944	  4952	  4961	  5854	  7602
	  7628	  7641	  7644	  7653	  7677	  7704	  7840	  8000	  8007	  8013	  8015	  8021	  8023	  8026
	  8036	  8053	  8072	  8077	  8513	  8516	  8541	  8801
LDBBK2	   366#	  2045	  2283	  2291	  2312	  2321	  2495	  2519	  2529	  2703	  2706	  2707	  2710	  2806
	  2811	  4237	  4312	  4323	  5171	  5798	  5896	  6161	  6174	  8589	  8971	 10857
LDBBKC	   364#	  2044	  2272	  2306	  2508	  2546	  4222	  4294	  5170	  5799	  5894	  6163	  6172	  8581
	  8644	  8654	  8710	  8969	  9297	 10858
LDBBKI	   356#	  2020	  2040	  2273	  2282	  2314	  2322	  2494	  2510	  2518	  2528	  2547	  2690	  2699
	  2700	  2767	  2772	  2800	  2853	  5172	  6178	  8565	  8592	  8676
LDBBKP	   355#	  2041	  2274	  2323	  2509	  2548	  2687	  5173	  6177	  8564	  8567	  8675	  8678
LDBBYT	   391#	   524	   525	   526	   527	   528	   529	   530	   531	   532	   533	   534	   535	   536
	  1586	  1885	  2022	  2032	  2094	  2428	  2435	  2442	  2605	  2619	  2661	  2663	  2727	  2745
	  2809	  2832	  2857	  2881	  3300	  3347	  3349	  3526	  3791	  3899	  4100	  4102	  4112	  4124
	  4400	  4416	  4422	  4658	  4900	  4903	  4905	  4918	  4971	  5049	  5183	  5202	  5204	  5355
	  5560	  5785	  6048	  6088	  6142	  6146	  6314	  6814	  7247	  8620	  8626	  8696	  8697	  8748
	  8906	  9139	  9248	  9253	 10538	 10542	 10718
LDBCLA	   499#	   500	   561	  2109
LDBDCH	   426#	   546	   547	   548	   549	   550	   551	   552	   553	   554	   555	  1371	  1526	  1532
	  1563	  1568	  1733	  1893	  2108	  2654	  2864	  2865	  2947	  2960	  2987	  3155	  3231	  3259
	  3286	  3309	  3311	  3318	  3325	  3327	  3332	  3361	  3363	  3379	  3396	  3415	  3439	  3540
	  3705	  3730	  3750	  3755	  3761	  3774	  3782	  3783	  3785	  3894	  3959	  4019	  4852	  4862
	  4871	  4893	  4993	  5180	  5181	  5208	  5249	  5321	  5322	  5466	  5631	  5776	  5787	  5876
	  5893	  6100	  6105	  6107	  6121	  6123	  6214	  6217	  6323	  6383	  6469	  6509	  6689	  6693
	  6694	  6766	  6910	  6947	  6955	  6999	  7001	  7003	  7087	  7256	  7365	  7918	  7955	  8034
	  8052	  8070	  8437	  8544	  8633	  8712	  8715	  8752	  8881	  8911	  8946	  8947	  8949	  8965
	  8968	  9003	  9005	  9077	  9090	  9107	  9203	  9277	  9285	  9293	  9309	  9313	  9613	  9958
	 10184	 10264	 10396	 10432	 10437	 10482	 10839	 10849	 10872	 10997
LDBDCX	   461#	   557	   558	   559	   560	  1519	  1601	  1608	  1640	  1819	  1862	  2062	  2090	  2400
	  2614	  2734	  2844	  4088	  4392	  4785	  5060	  5881	  5886	  6325	  6522	  6809	  6812	  7258
	  7569	  7570	  8744	  8807	  8848	  8925	  8929	  9616	 10650	 10662	 10674	 10689	 10701	 10895
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

	 11002
LDBDDB	   342#	  1505	  1512	  1602	  1708	  1723	  1743	  1820	  1865	  1903	  1934	  2063	  2142	  3050
	  3555	  3895	  4126	  4853	  4972	  5005	  5046	  5296	  5471	  5488	  6009	  6016	  6028	  6114
	  6255	  6523	  7094	  7113	  7117	  7126	  7469	  8637	  9146	  9272	  9682	  9745	 10068	 10146
	 10219	 10377	 10532	 10651	 10659	 10675	 10702	 10923
LDBECC	   363#	  1559	  2012	  2043	  2227	  2692	  2698	  2713	  2780	  2783	  3165	  4136	  4166	  4211
	  4255	  4885	  5175	  5780	  6033	  6189	  6856	  6882	  8980	  8984	  9008	  9081	  9094	  9123
	 10842	 10853
LDBECT	   362#	  2039	  2258	  2334	  2419	  2696	  2785	  4143	  4146	  4161	  4474	  4492	  5174	  6188
LDBFLP	   373#	  4512	  4514	  4574	  4684	  5196
LDBLEN	   516#
LDBLIN	   343#	   521	   522	  1539	  1873	  1878	  3823	  3826	  3863	  3866	  3893	  3943	  4912	  7207
	  8049
LDBLOG	   378#	   519	  1544	  1550	  1886	  1887	  1896	  1916	  2075	  2079	  2101	  2149	  3529	  3538
	  3808	  3818	  3850	  3858	  3901	  5161	  5449	  5468	  5996	  6256	  6276	  6279	  6310	  7056
	  7212	  7243	  8438	  9608	  9612	 10006	 10133	 10179	 10246	 10941	 10996
LDBMOD	   414#	   538	   539	   540	   541	   542	   543	   544	  1555	  1648	  1687	  1717	  1740	  1864
	  1897	  3531	  3820	  3860	  3900	  4854	  5460	  5556	  5888	  6315	  6834	  7248	  7600	  7620
	  7625	  7647	  7662	  7671	  7681	  7708	  7730	  7776	  7826	  7836	  8058	  8510	  8528	  8530
	  8538	 10186	 10866
LDBOPB	   348#	  1527	  1534	  1572	  1579	  1588	  1612	  1735	  1891	  1950	  2029	  2051	  2071	  2141
	  2424	  2484	  2756	  3009	  3026	  3045	  3222	  3535	  3828	  3868	  3897	  4490	  4914	  4916
	  5209	  5350	  5749	  5819	  5847	  6052	  6226	  6652	  6699	  6893	  7832	  7887	  8533	  8551
	  8780	  8960	  9038	  9115	 10182	 10534	 10906	 10986
LDBOUT	   303	   304	   305	   306	   307	   308	   309	   310	   311	   312	   313	   314	   315	   316
	   317	   318	   319	   320	   321	   322	   323	   324	   325	   349#	  1883	  2137	  2998	  3021
	  3035	  3827	  3867	  3896	  6313	  7246
LDBRBC	   377#	  2469	  2475	  4032	  4045	  5176
LDBRBI	   375#	  2465	  2468	  2473	  4050	  5165	  5178
LDBRBO	   376#	  2474	  4036	  4039	  4042	  4051	  4053	  5177
LDBSTR	   501#	  2112	  2113	  2115	  7127	  7128	  7130	  7260	  7261
LDBTCB	   350#	  6326	  6474	  6481	  6515	 10877
LDBTIC	   361#	  2011	  2042	  2259	  2335	  2694	  2714	  2784	  3164	  4207	  4223	  4251	  4264	  4884
	  5169	  5271	  5381	  5781	  5792	  6034	  6193	  6857	  6881	  8556	  8557	  8668	  8669	  8967
	  8977	  9006	  9082	  9095	  9122	 10843	 10852
LDBTIP	   359#	  2016	  2019	  2037	  2689	  2770	  2773	  2779	  5163	  5167	  6176	  9182
LDBTIT	   360#	  2038	  5168	  6037	  6192	  8560	  8563	  8671	  8674	  9160
LDBTMR	   203	   204	   205	   206	   207	   208	   209	   210	   211	   212	   213	   214	   215	   216
	   217	   218	   219	   220	   221	   222	   502#	  2124	  6320	  7252
LDBTMS	   232	   233	   234	   235	   236	   237	   238	   239	   240	   241	   242	   243	   244	   245
	   246	   247	   248	   249	   250	   251	   503#
LDBTMT	   504#	  2135	  3666	  3676	  3682	  6223	  6318	  6643	  6648	  7249
LDBTOC	   371#	  1232	  4059	  4072	  4087	  5194	  5356	  8743	  8763	  8766	  8806	  8847	  9042	  9366
	  9677	  9688	  9783	  9784
LDBTOP	   369#	  5188	  5193	  8758	  8761	  8765
LDBTOT	   370#	  4063	  4066	  4069	  5195	  8762	  9342	  9345
LDBTYP	   500#	   562	  2111	  6723
LDEC	  1446	  1559#
LDICLE	   514#	 10983
LDICLR	   341#	 10980	 10981	 10982
LDLAUX	   443#	  1562	  1567	  1901	  2146	  3807	  3849	  4882	  5469	  5908	  6101	  6120	  6911	  7255
	  8912	 10397
LDLBK2	   437#	  5797	  5895	  8586	  8941	  8948	  8970	 10856
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

LDLBKA	   436#	  4995	  8939	  8948	  8964	  9002
LDLCOM	   435#	  2091	  2401	  2443	  2786	  2875	  4119	  4393	  4436	  4446	  4994	  5002	  5632	  5688
	  6370	  6916	  6951	  7000	  7086	  8882	  9136	  9276	  9294	  9312	  9611	 10263	 10431	 10436
	 10481	 10647	 10671	 10840	 10850	 10995
LDLDEF	   439#	  1561	  1566	  2091	  2107	  5908	  6322	  6953	  6998	  7255
LDLECS	   433#	  5179	  5775	  5908	  7002	  8664	  8711	  9284	  9308
LDLFRM	   448#	  2429	  2436	  4634	  4644	  5908
LDLIMI	   438#	  3731	  3769	  4861	  4892	  5239	  5275	  5793	  5968	  6103	  6104	  6119	  6382	  7255
	  8975	  9034	  9289	  9308
LDLLCP	   446#	  2093	  2106	  2344	  2397	  2411	  2415	  2429	  2436	  2447	  2658	  2788	  5908
LDLLCT	   444#	  2091	  2390	  2395	  2647	  4379	  4385	  5908	  8583	  8630	  8642	  9258
LDLNEC	   442#	  2787	  3706	  4247	  4260	  4269	  4280	  4286	  4299	  4307	  4318	  4437	  4447	  5908
	  6695	  7255	  8937	  8948	  8955
LDLNFC	   441#	  2347	  4556	  4610	  5908	  7255
LDLNOP	   430#	  1525	  1531	  1732	  1892	  3958	  4018	  5207	  5908	  8543	 10183
LDLOSU	   440#	  2653	  2863	  5317	  5786	  5908	  8753
LDLPTP	   447#	  2344	  2397	  2411	  2415	  2429	  2436	  2447	  2631	  2719	  5908	  6215	  6218
LDLPTY	   434#	  2957	  2984	  3807	  6322	  6470	  6507	  6767	  7364	  7919	  7956	  8033	  8051	  8069
	 10873
LDLSOX	   432#	  4534	  4556
LDLTAB	   445#	  2447	  4621	  5908
LDPBBP	   525#	  6755
LDPBSD	   557#	  6563
LDPBSP	   527#	  6670	  6672	  6682
LDPCHG	   539#	  5286	  5290	  5295
LDPCIE	   204#
LDPCLA	   561#	  6721	  6729	  6731
LDPCOM	   547#	  5490	 10382
LDPCRD	   207#	  5890
LDPDEM	   555#	  6687
LDPECH	   216#	  2751	  4423	  4660
LDPECO	   203#
LDPECR	   206#
LDPELF	   205#
LDPERA	   558#	  6668	  6674	  6679	  6681
LDPESC	   221#
LDPFA1	   534#
LDPFA2	   530#
LDPFC1	   533#	  2095	  4638	  4648	  6060	  6552
LDPFC2	   529#	  2097	  4627	  6062	  6553
LDPFRM	   553#	  6559
LDPHDX	   211#	  2104	  5878	  6076
LDPHST	   522#	  1554	  1888	  3530	  3819	  3859	  6312	  9615	 10999
LDPIMB	   543#	  2240	  4273	  4877	  5283	  6841	 10536
LDPIR	   208#	  6068
LDPKAT	   219#
LDPLCO	   559#	  6557
LDPLCT	   550#	  6560
LDPLMD	   540#	  6130
LDPLNO	   521#	  3573	  3677	  3723	  3830	  3983	  5875	  6287	  6298	  6307	  7089	  7368	  7466	  7506
	  7575	  9758	 10446	 10619	 10984
LDPMDF	   548#	  6128
LDPMEC	   541#	  4154
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

LDPMIN	   542#	  1954
LDPMOD	   528#	  2361	  2552	  2656	  2672	  2866	  4327	  8596	  8649	  8920	  9223
LDPMOU	   544#
LDPNFC	   549#	  6561
LDPNTB	   526#	  6735	  6739
LDPNXO	   554#	  6550
LDPOR	   209#	  6070
LDPPA	   212#	  6074
LDPPAR	   210#	  6072
LDPPB	   213#	  6078
LDPPC	   214#	  6080
LDPPD	   218#
LDPPOS	   536#	  2343	  2351	  2356	  2359	  2392	  2408	  2446	  2457	  4455	  4466	  4472	  4542	  4578
	  4582	  4606	  4614	  4618	  4620	  4662	  4664	  4788	  6023
LDPPSM	   538#	  1860	  6831
LDPPTP	   552#	  6705	  6707
LDPQM	   222#
LDPRTC	   560#	  6565
LDPRXE	   217#
LDPSOX	   546#	  6771	  6774
LDPTAB	   551#	  6558
LDPTBK	   524#	  6744
LDPTIM	   535#	  2221	  2235	  2250	  3248	  3257	  3381	  4866	  4868	  9035
LDPTOB	   220#
LDPTYP	   562#	  6718
LDPWDA	   532#
LDPWID	   531#	  2099	  2346	  4554	  4609	  6064	  6317	  6658	  6663
LDPXON	   215#
LDRBIP	   460#	  3154	  3230	  3258	  3326	  3360	  3378	  3414	  3438	  4858	  4870
LDRBPS	   455#	  3754	  3773	  9076	  9089	  9105	  9106
LDRDEM	   458#	  3706	  6691	  6692	  8956
LDRFCS	   459#	  4995	  8632	  8935	  8948
LDRNXO	   457#	  3732	  3780
LDRXOS	   456#	  3308	  3317	  3749	  3781	  9076	  9089	  9105
LDSCIE	   233#	  2131
LDSCRD	   236#
LDSECH	   245#
LDSECO	   232#
LDSECR	   235#	  2133	  6221
LDSELF	   234#	  2130
LDSESC	   250#
LDSHDX	   240#
LDSIR	   237#
LDSKAT	   248#
LDSOR	   238#
LDSPA	   241#
LDSPAR	   239#
LDSPB	   242#
LDSPC	   243#
LDSPD	   247#
LDSQM	   251#
LDSRXE	   246#	   252
LDSTOB	   249#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

LDSXON	   244#
LEVDEF	  5711	  6047#	  6397
LI.PIF	  9548
LI.PIN	  9557	  9558
LICAC	  7058	  7409
LICOPR	  5629
LICWCR	  5434
LINFLG	    76%	  2937	 10977
LINFSV	  2943	  3079	 11138#
LINJOB	  6014#
LINPNM	  2945	  3078	 11137#
LINPTR	  2934	  2936	  3081	  3083	 11126#
LINTAB	    83%	  1370	  2946	  4851	  5447	  6006	  6275	  6278	  6289	  6295	  8436	  9607	  9744	 10922
	 10979	 10988
LINTRP	  2226	  2243	  2257	  2332	  4880	 10659#
LISTSN	     3	     6
LLLHDX	   386#	  2100
LLLNLN	   383#	  1895	  9611	 10178	 10995
LLLZAP	   382#	  1895	  5160	  5467	  7055	 10005	 10132	 10245	 10940
LMLBIO	   419#	  1647	  1741	  1898	  4855	  5459	  5557	  7599	  7619	  7626	  7646	  7670	  7731	  7837
	  8059	  8511	  8539	 10185
LMLPSP	   417#	  1863	  5887	  6833	 10865
LMLTBI	   416#	  1688	  1716	  7661	  7682	  7709	  7777	  7827	  8527
LNLZIN	   347#	  1540	  1874	  3824	  3864	  3942	  4911	  7208	  8048
LOGCH1	  2145	  2149#
LOGCH2	  2148	  2153#
LOGCHR	  1964	  2075#
LOGIN	  1439	  1539#
LOGLDB	 10412%	 10412
LOGZAP	  1616	 11214#
LOPBIN	   306#	  7831
LOPBOP	   310#	  3477	  3518	  7663
LOPBOT	   319#	  7886	  8545	  8547
LOPBPF	   309#	   327	  9114
LOPBPN	   308#	  2050	  2054	  9079	  9092	  9109
LOPCGB	   305#	  5206
LOPECO	   323#	   329	  1949	  3006	  3221	  6051	  6892	  9037
LOPFIL	   316#	  4576	  4686
LOPHNG	   321#	  6822
LOPHSH	   303#	   327	   329	   330	 11001
LOPOUT	   318#	  5349	  5748	  5818	  5846	  8779
LOPRUB	   317#	  2028	  2423	  2483	  2755	  4483
LOPSBL	   315#	  2070
LOPSEC	   312#	  6698	  8959
LOPSGR	   324#	  1571	  1576
LOPSOG	   325#	   330	  1611	  6816	 10890	 10893
LOPSRD	   311#	  1578
LOPSTC	   314#	  2139	  6225	  6650
LOPSTP	   313#	  2140
LOPSYL	   320#	  5205	  6804	 10180	 10905
LOPTRI	   307#	  8532
LOPTRO	   304#	  8550
LOPZAP	   322#	  1523	  1890	  3655	  4915	  9144	 10181
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

LOS620	  2057	 11200#
LOSPDP	  2056	 11198#
LPOPJ	 10197	 10199#	 10216
LTSCIE	   512#	  2134
LTSCRD	   512#
LTSECH	   512#
LTSECO	   512#
LTSECR	   512#	  2134	  6222
LTSELF	   512#	  2134
LTSESC	   512#
LTSHDX	   512#
LTSIR	   512#
LTSKAT	   512#
LTSOR	   512#
LTSPA	   512#
LTSPAR	   512#
LTSPB	   512#
LTSPC	   512#
LTSPD	   512#
LTSQM	   512#
LTSRXE	   512#
LTSTOB	   512#
LTSXON	   512#
LXL120	   465#	  2089	  6324	  7257
LXLBSD	   467#	  2615
LXLDLR	   470#	  2399	  4391	  8927	  8928
LXLERA	   468#	  2735
LXLLCO	   471#	  4786
LXLOOK	   472#	  1607	  6810	 10894
LXLRTC	   475#	  2843
LXRBRK	   489#	  1639	 10661
LXRCGS	   495#	  1518
LXRCHR	   488#	 10649
LXRESC	   483#	  5882	 10673	 10688
LXRICL	   486#	  1818	  2061
LXRIOS	   496#	  5059
LXROBS	   484#	  5884	 10700
LXROCL	   487#	  1817
LXRPSS	   485#	  1861
LXRTCC	   497#	  6521
LXRYBS	   494#	  1600
M	  5376	  5394	  5736	  5737	  5753	  5754	  5766	  5767	  5806	  5816	  5826	  5828	  5843	  5844
	  5856	  5858	  5872	  5901	  5904	  5934	  5981	  5998	  6044	  6056	  6082	  6261	  6264	  6459
	  6460	  6463	  6476	  6483	  6487	  6736	  6745	  6756	  6772	  6781	  6788	  6791	  6832	  6838
	  6851	  6873	  6874	  6875	  6886	  6894	  6921	  6961	  6978	  7090	  7751	  7810	  7847	  7858
	  9779	  9780	  9788	  9794	 10385	 10518
MAKDET	  6423	  7051#
MAKDLC	  7060	  7062	  7064	  7066	  7068#
MAXAXC	  6360	  6456#
MAXTMC	   254#	   259	  1831	  6617
MD0405	  1968	  1969	  1986#
MD0607	  1970	  1971	  1991#
MD1011	  1972	  1973	  1996#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

MD1213	  1974	  1975	  2001#
MDFLMD	  2888#	  6129
MLOWQ	   100%	  7443	  7931	  9799
MLTNDB	  1917	  1935	  1939#
MO.LAC	  5235	  5314	  5375	  5738	  5755	  5765	  5805	  5825	  5853	  5948	  5957	  5967	  5988	  6032
	  6846	  6855	  6866	  7736	  7839	  7924
MONHNG	  9302#
MORLIN	  3018#	  3274	  3279	  3289	  3310	  3352	  3399	  3478	  3510	  3520	  3558	  3668	  3727	  3733
	  3745	  3784	  3932	  4033	  4055	  4060	  4082	  4137	  4170	  4515
MORLN2	  3000	  3005	  3026#	  3036
MOVCH1	  1959#	  2599	  2607	  2621	  2632	  2633	  2644
MOVCH2	  1956#	  2641
MOVCHR	  1922	  1945	  1954#	  2636	  3212	  6889	  6897	  6969
MSGSIM	  3284#	  3294	  3304	  3313	  3320
MSKIRG	    78%	  1377	  1845
MSKORG	    78%	  3578	  3591	  3593	  3630	  3647	  3972	  3989	  7313	 10019	 10029
MTR	  5235	  5314	  5375	  5738	  5755	  5765	  5805	  5825	  5853	  5948	  5957	  5967	  5988	  6032
	  6846	  6855	  6866	  7736	  7839	  7924
MULCNT	  2927	  2963	  2988	  3062	  3071	  3072	  3486	  3502	  3566	  3568	  3588	  3602	  3625	  3641
	  3742	  4497	  4503	  4519	  4567	  4584	  4676	  4839	 11147#
MXLIN	  4849%	  4849	  6004%	  6004
MXMCNT	  3564	  3587	  3603	  3626	  3642	  7302	 11149#
MXTIM	  1224%	  1224	  1225%	  1225	 10972%	 10972
MXTYP	  1374	  1502#
NAMSC1	 10635#	 10640
NAMSC2	 10637	 10641#
NAMSCN	 10384	 10632#
NEWJER	  2160	  2166#
NEWTER	  2162	  2172#
NMXFLG	    76%	  2935
NMXLIN	 10978%	 10978
NOBASE	  4811#
NOCTRO	  5268	  5390	  5784#	  5801	  5950	  5982	  6853	  6863	  9295	  9300	  9318
NODIE	    11%	  1133	  1375	  1396	  1618	  1627	  2958	  3556	  3888	  3944	  4811	  5040	  5101	  8365
NOECHO	   649#	  5552	  8936
NOLIN	  2964	  2989	  3063	  3073	  3078#
NOLIN2	  2938	  2941	  3081#
NOOUT	  1441	  1522#
NOTLIN	  3809	  3815#
NOTOPR	  3798	  3804	  3807#
NOXEXE	  9590#	  9596	  9599
NRPCNT	  7451	 11162#
NTTOPR	  3840	  3846	  3849#
NUMECO	   329#	  3012
NXTTTY	  5566	  7063	  7065	  7420	  7422	  7499	  7527	  7579	 10155	 10720	 10730#	 10774	 10796
NZAPAX	  7209	 11220#
NZAPIN	  1872	 11217#
NZAPLG	  1541	 11219#
NZAPN2	  1875	 11218#
NZAPOT	  3825	  3865	 11222#
NZAPRS	  4920	 11221#
OBFND	  1585#	  4908
OBFND1	  1586#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

OBREC	  1583	 10700#
OMX120	  8745	  8808	  8849	 11204#
OMX30	  8746	  8809	  8850	 11202#
ONEOU2	  5745#	  5759
ONEOU3	  5747#	  5768	  5809	  9178
ONEOUT	  5717	  5737#	  5757
OP0TYO	  9378	  9413#
OP1TYO	  9378	  9402	  9406#
OP2TYO	  9378	  9396#
OPCRET	    71#	  5693	  6375
OPRCT2	  9335	  9340#
OPRCTY	  1234	  9324#
OPRFIL	  9341	  9362#
OPRFR1	  9814#	  9820
OPRFRE	  3801	  3843	  4080	  5199	  9368	  9810#
OPRLDB	  3797	  3799	  3839	  3841	  4079	  5198	  5626	  9398	  9668	  9781	  9791	  9796	 11026	 11134#
OPROUT	  5607	  9378#
OPRSN2	  9781#	  9805
OPRSND	  9779#
OPRTIC	  9322#	  9325	  9326	  9327
OPRTIM	  3806	  3848	  4840	  4841	  9988	  9996	 10970	 11141#
OPRWAT	  9785	  9799#
OPRWJB	  9801	  9803	  9810	  9812	 11185#
OPSND1	  9788#	  9792	  9797
OQUEUE	  7606	  7632	  7842	  8491#
ORANGE	  1450	  1582#
ORING	    78%	   855	   856	  1264	  1278	  3605	  3622	  3638	  3987	  7308	 10027
ORP620	    78%	  1112	  1144	  1251	  3589	  3592	  3973	 10020
ORPOLD	  1113	  1253	 11234#
ORPPDP	    78%	  1250	  1258	  1280	  1403	  3579	  3590	  3594	  3604	  3631	  3648	  3970	  7317	  7322
	  8399	 10017
ORPTIM	  1228%	  1228	  3580%	  3580
OUPLIN	   856#	  3574
OUPTYP	   855#	  3572
OUT	    90%	  5223
OUTCHI	  5730	  5736#	  6429
OUTPC1	  5830#	  5833
OUTPC2	  5832	  5836#
OUTPCF	  5834	  5839	  5843#	  5866	  5868
OUTPT1	  5808#	  5812
OUTPTC	  5824#	  6443
OUTPTR	  5731	  5804#	  6393
OUTSN1	  5860#	  5864
OUTSN2	  5861	  5867#
OUTSNW	  5852#	  6450
OUTST1	  5767#	  5771
OUTSTR	  5719	  5764#	  6430
OUTTRN	  3014	  3091#
OWK120	  4089	 11205#
OWK30	  4090	 11203#
OWTIM	    55#	  4847
P	    12	  1129	  1130	  1132	  1133	  1134	  1142	  1145	  1146	  1149	  1150	  1153	  1154	  1157
	  1158	  1160	  1161	  1169	  1234	  1235	  1245	  1291	  1296	  1300	  1303	  1313	  1317	  1322
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

	  1375	  1396	  1401	  1404	  1405	  1408	  1409	  1413	  1414	  1417	  1418	  1420	  1421	  1423	  1424
	  1426	  1427	  1441	  1442	  1443	  1444	  1445	  1446	  1449	  1450	  1454	  1481	  1484	  1485
	  1486	  1489	  1492	  1517	  1528	  1535	  1542	  1546	  1583	  1589	  1606	  1609	  1613	  1618
	  1626	  1627	  1638	  1642	  1650	  1657	  1664	  1668	  1675	  1676	  1689	  1697	  1707	  1709
	  1710	  1720	  1738	  1742	  1755	  1756	  1806	  1852	  1868	  1876	  1894	  1900	  1912	  1913
	  1922	  1945	  2015	  2017	  2018	  2024	  2026	  2030	  2033	  2034	  2036	  2046	  2068	  2072
	  2076	  2153	  2159	  2161	  2169	  2175	  2222	  2223	  2224	  2226	  2228	  2229	  2236	  2237
	  2238	  2239	  2243	  2251	  2252	  2253	  2256	  2257	  2260	  2263	  2264	  2269	  2270	  2279
	  2280	  2288	  2289	  2296	  2297	  2304	  2305	  2310	  2311	  2319	  2320	  2328	  2329	  2332
	  2333	  2345	  2349	  2357	  2358	  2380	  2382	  2384	  2387	  2391	  2398	  2403	  2409	  2412
	  2413	  2416	  2418	  2421	  2425	  2430	  2437	  2445	  2458	  2464	  2467	  2470	  2472	  2485
	  2487	  2491	  2492	  2500	  2501	  2506	  2507	  2515	  2516	  2521	  2525	  2526	  2537	  2538
	  2543	  2544	  2561	  2579	  2589	  2633	  2655	  2659	  2668	  2670	  2671	  2697	  2708	  2711
	  2715	  2720	  2721	  2723	  2725	  2738	  2740	  2744	  2753	  2757	  2761	  2763	  2764	  2765
	  2766	  2769	  2777	  2790	  2795	  2801	  2804	  2805	  2810	  2815	  2816	  2817	  2818	  2819
	  2820	  2823	  2824	  2825	  2826	  2827	  2828	  2830	  2833	  2850	  2854	  2859	  2861	  2862
	  2876	  2877	  2879	  2882	  2926	  2958	  2965	  2970	  2971	  2972	  2974	  2975	  2976	  2978
	  2979	  3027	  3046	  3061	  3070	  3087	  3152	  3153	  3170	  3171	  3183	  3184	  3199	  3201
	  3202	  3203	  3204	  3210	  3211	  3212	  3214	  3215	  3216	  3219	  3223	  3224	  3225	  3228
	  3229	  3249	  3250	  3255	  3260	  3261	  3262	  3284	  3285	  3287	  3288	  3301	  3323	  3324
	  3339	  3340	  3341	  3350	  3351	  3373	  3384	  3394	  3395	  3397	  3398	  3405	  3406	  3407
	  3408	  3418	  3419	  3420	  3421	  3422	  3424	  3425	  3426	  3427	  3428	  3436	  3437	  3441
	  3447	  3461	  3463	  3489	  3492	  3499	  3504	  3507	  3508	  3513	  3519	  3532	  3533	  3536
	  3537	  3541	  3542	  3549	  3550	  3551	  3553	  3554	  3556	  3596	  3659	  3664	  3679	  3721
	  3725	  3752	  3771	  3794	  3801	  3821	  3822	  3834	  3843	  3861	  3862	  3869	  3888	  3889
	  3908	  3909	  3914	  3924	  3930	  3937	  3944	  3954	  3962	  3968	  3969	  3974	  3975	  4016
	  4037	  4038	  4040	  4052	  4064	  4065	  4067	  4077	  4080	  4091	  4097	  4113	  4131	  4138
	  4144	  4169	  4205	  4210	  4216	  4228	  4234	  4242	  4249	  4254	  4262	  4271	  4282	  4288
	  4301	  4309	  4320	  4440	  4450	  4456	  4460	  4469	  4470	  4477	  4481	  4488	  4499	  4505
	  4579	  4654	  4665	  4811	  4813	  4815	  4820	  4857	  4873	  4879	  4880	  4881	  4894	  4895
	  4908	  4930	  4932	  4939	  4947	  4982	  4983	  4984	  4985	  4986	  4987	  4991	  4996	  4997
	  5003	  5004	  5014	  5016	  5040	  5044	  5050	  5055	  5056	  5061	  5064	  5096	  5101	  5120
	  5129	  5132	  5138	  5144	  5145	  5157	  5162	  5164	  5166	  5191	  5192	  5199	  5210	  5217
	  5222	  5231	  5236	  5237	  5240	  5242	  5251	  5254	  5263	  5276	  5278	  5281	  5291	  5309
	  5312	  5315	  5329	  5332	  5335	  5341	  5344	  5351	  5353	  5358	  5360	  5362	  5366	  5372
	  5373	  5379	  5380	  5383	  5425	  5426	  5436	  5446	  5452	  5453	  5458	  5461	  5462	  5489
	  5504	  5507	  5508	  5512	  5518	  5519	  5524	  5529	  5538	  5540	  5543	  5545	  5558	  5562
	  5564	  5565	  5566	  5567	  5572	  5607	  5616	  5623	  5635	  5639	  5642	  5644	  5647	  5648
	  5649	  5651	  5654	  5659	  5660	  5665	  5669	  5672	  5677	  5682	  5685	  5690	  5692	  5739
	  5745	  5750	  5756	  5764	  5769	  5777	  5782	  5788	  5800	  5804	  5810	  5824	  5831	  5839
	  5848	  5852	  5860	  5863	  5865	  5867	  5873	  5902	  5905	  5942	  5945	  5949	  5951	  5952
	  5953	  5955	  5958	  5959	  5960	  5961	  5963	  5966	  5972	  5973	  5976	  5987	  5989	  5990
	  5994	  5995	  6005	  6007	  6014	  6015	  6021	  6022	  6026	  6027	  6035	  6036	  6038	  6045
	  6049	  6053	  6057	  6083	  6106	  6118	  6122	  6124	  6125	  6131	  6144	  6160	  6164	  6171
	  6179	  6184	  6185	  6190	  6194	  6196	  6197	  6198	  6203	  6209	  6216	  6227	  6239	  6243
	  6245	  6250	  6251	  6253	  6265	  6274	  6290	  6327	  6328	  6337	  6338	  6341	  6347	  6355
	  6356	  6361	  6364	  6367	  6372	  6374	  6384	  6461	  6462	  6464	  6465	  6471	  6472	  6473
	  6485	  6488	  6501	  6503	  6504	  6505	  6508	  6511	  6516	  6517	  6518	  6519	  6520	  6527
	  6528	  6529	  6530	  6531	  6651	  6653	  6662	  6708	  6711	  6713	  6740	  6768	  6769	  6770
	  6775	  6776	  6784	  6789	  6792	  6796	  6811	  6835	  6843	  6847	  6848	  6852	  6860	  6861
	  6862	  6867	  6868	  6869	  6884	  6889	  6897	  6937	  6939	  6942	  6943	  6944	  6946	  6956
	  6963	  6965	  6969	  6976	  6985	  7004	  7007	  7009	  7047	  7053	  7057	  7061	  7063	  7065
	  7067	  7070	  7071	  7081	  7088	  7097	  7103	  7109	  7115	  7124	  7144	  7178	  7184	  7186
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

	  7190	  7198	  7210	  7214	  7235	  7263	  7286	  7287	  7297	  7298	  7318	  7319	  7330	  7354	  7418
	  7420	  7422	  7446	  7457	  7470	  7472	  7473	  7482	  7484	  7489	  7494	  7496	  7499	  7518
	  7519	  7525	  7526	  7527	  7528	  7535	  7558	  7579	  7582	  7584	  7601	  7606	  7607	  7612
	  7613	  7617	  7618	  7621	  7622	  7627	  7632	  7633	  7640	  7643	  7648	  7657	  7664	  7665
	  7675	  7676	  7684	  7685	  7690	  7697	  7698	  7702	  7703	  7710	  7711	  7712	  7713	  7717
	  7718	  7726	  7732	  7734	  7735	  7744	  7745	  7780	  7783	  7787	  7788	  7793	  7794	  7795
	  7797	  7805	  7806	  7814	  7833	  7838	  7842	  7843	  7845	  7846	  7927	  7933	  7935	  7938
	  7986	  7987	  7989	  7990	  7992	  7993	  7998	  7999	  8005	  8006	  8027	  8032	  8041	  8042
	  8043	  8050	  8056	  8057	  8068	  8075	  8078	  8086	  8089	  8116	  8121	  8131	  8153	  8365
	  8369	  8372	  8373	  8375	  8383	  8394	  8400	  8429	  8435	  8440	  8441	  8442	  8443	  8481
	  8485	  8492	  8493	  8496	  8507	  8512	  8515	  8518	  8523	  8529	  8534	  8540	  8552	  8555
	  8558	  8559	  8561	  8562	  8588	  8593	  8646	  8647	  8657	  8658	  8665	  8666	  8667	  8672
	  8673	  8691	  8699	  8713	  8714	  8716	  8751	  8754	  8760	  8764	  8767	  8769	  8770	  8774
	  8781	  8796	  8815	  8819	  8825	  8840	  8845	  8846	  8851	  8852	  8867	  8870	  8872	  8873
	  8878	  8884	  8885	  8896	  8899	  8901	  8904	  8913	  8917	  8921	  8966	  8974	  8979	  8988
	  8990	  8991	  8999	  9004	  9007	  9011	  9013	  9014	  9022	  9023	  9025	  9044	  9049	  9050
	  9051	  9052	  9053	  9054	  9055	  9056	  9057	  9064	  9066	  9067	  9068	  9071	  9084	  9097
	  9116	  9121	  9135	  9137	  9143	  9148	  9151	  9152	  9153	  9154	  9164	  9168	  9169	  9175
	  9176	  9177	  9184	  9187	  9190	  9193	  9195	  9201	  9202	  9204	  9212	  9213	  9220	  9265
	  9275	  9279	  9280	  9286	  9290	  9296	  9299	  9303	  9305	  9310	  9311	  9316	  9317	  9331
	  9343	  9344	  9346	  9347	  9348	  9357	  9363	  9365	  9367	  9368	  9369	  9370	  9380	  9389
	  9390	  9391	  9396	  9397	  9399	  9400	  9401	  9406	  9408	  9413	  9417	  9426	  9427	  9429
	  9430	  9436	  9439	  9441	  9453	  9460	  9461	  9467	  9468	  9511	  9515	  9521	  9522	  9528
	  9530	  9531	  9533	  9534	  9568	  9594	  9605	  9617	  9618	  9619	  9620	  9623	  9634	  9636
	  9663	  9675	  9676	  9679	  9680	  9681	  9683	  9686	  9687	  9690	  9693	  9694	  9695	  9696
	  9697	  9700	  9704	  9709	  9712	  9723	  9724	  9725	  9726	  9728	  9737	  9740	  9741	  9743
	  9750	  9751	  9759	  9760	  9762	  9763	  9764	  9769	  9771	  9772	  9775	  9790	  9795	  9804
	  9811	  9813	  9817	  9821	  9822	  9899	  9907	  9908	  9909	  9911	  9912	  9914	  9918	  9920
	  9925	  9927	  9928	  9929	  9933	  9936	  9937	  9942	  9945	  9946	  9956	  9959	  9961	  9962
	  9963	  9967	  9973	  9976	  9977	  9978	  9991	  9994	  9997	 10007	 10008	 10014	 10015	 10022
	 10032	 10033	 10069	 10084	 10085	 10086	 10087	 10088	 10089	 10090	 10091	 10092	 10093	 10094
	 10095	 10098	 10102	 10113	 10115	 10129	 10130	 10134	 10151	 10152	 10155	 10156	 10166	 10172
	 10187	 10188	 10194	 10196	 10199	 10200	 10213	 10214	 10215	 10217	 10218	 10223	 10224	 10230
	 10232	 10233	 10240	 10241	 10248	 10249	 10251	 10252	 10253	 10255	 10256	 10259	 10260	 10265
	 10266	 10275	 10277	 10331	 10348	 10362	 10368	 10384	 10410	 10411	 10412	 10413	 10416	 10433
	 10439	 10440	 10447	 10469	 10475	 10485	 10501	 10510	 10512	 10517	 10519	 10546	 10550	 10571
	 10574	 10577	 10581	 10604	 10605	 10606	 10624	 10625	 10626	 10627	 10632	 10641	 10642	 10648
	 10663	 10666	 10667	 10668	 10672	 10677	 10680	 10682	 10687	 10692	 10708	 10709	 10710	 10713
	 10714	 10719	 10720	 10723	 10724	 10725	 10734	 10737	 10738	 10741	 10742	 10750	 10761	 10773
	 10774	 10779	 10780	 10781	 10796	 10812	 10816	 10819	 10820	 10822	 10823	 10826	 10834	 10835
	 10841	 10844	 10845	 10851	 10859	 10860	 10867	 10868	 10874	 10875	 10876	 10878	 10879	 10880
	 10892	 10896	 10897	 10903	 10912	 10921	 10925	 10936	 10942	 10944	 10945	 10948	 10949	 10951
	 10953	 10954	 11003	 11004	 11012	 11014	 11022	 11047
P1	   530	   532	   534	  1366	  1372	  1374	  1376	  1383	  1384	  1386	  1387	  1389	  1390	  1392
	  1393	  1923	  1924	  1932	  1933	  1937	  1938	  1939	  1940	  1941	  1947	  3405	  3427	  4034
	  4046	  4054	  4061	  4073	  4081	  4141	  4167	  4168	  4243	  4272	  4453	  4476	  4478	  4586
	  4680	  5120	  5121	  5122	  5123	  5124	  5126	  5127	  5129	  5244	  5246	  5257	  5261	  5262
	  5301	  5305	  5326	  5327	  5336	  5378	  5387	  5421	  5422	  5427	  5429	  5826	  5827	  5833
	  5843	  5856	  5857	  5864	  5934	  5935	  5938	  6184	  6186	  6197	  6206	  6242	  6249	  6259
	  6260	  6261	  6913	  6918	  6921	  6922	  6924	  6927	  6942	  6944	  6963	  6979	  6987	  6992
	  7006	  7008	  7374	  7462	  7744	  7786	  7790	  7795	  9049	  9068	  9450	  9693	  9697	  9898
	  9903	  9905	  9913	  9919	  9934	  9943	  9957	  9966	 10324	 10329	 10342	 10346	 10359	 10366
	 10386	 10392	 10489	 10977	 10985	 10986	 10987
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

P2	  1954	  1959	  3406	  3426	  5246	  5247	  5259	  5260	  5261	  5262	  5304	  5327	  5330	  5343
	  5376	  5377	  5386	  5389	  5936	  5937	  5941	  5944	  6185	  6187	  6191	  6195	  6196	  6207
	  6244	  6248	  6252	  6254	  7379	  7393	  7396	  9050	  9067	  9694	  9696	 10325	 10367	 10387
	 10388	 10415	 10418	 10449	 10490	 10499	 10507	 10978	 10979	 10984	 10988	 11024
P3	   860	   861	   862	   872	   873	   874	   875	   876	   877	   878	   879	  1259	  1261	  1263
	  1264	  1266	  1278	  1298	  1757	  1956	  1957	  2796	  3407	  3425	  3622	  3624	  3625	  3626
	  3627	  3638	  3640	  3641	  3642	  3643	  3669	  3687	  3692	  3697	  3704	  3707	  3712	  3756
	  3775	  3829	  3929	  3961	  3986	  3987	  3990	  4005	  4020	  4025	  4103	  4108	  4110	  4151
	  4152	  4537	  4538	  5424	  7288	  7299	  7308	  7377	  7398	  8571	  8572	  8596	  8597	  8649
	  8651	  8652	  8667	  8682	  8683	  8713	  9202	  9206	  9212	  9450	  9451	  9606	  9607	  9624
	 10024	 10026	 10027	 10031	 10330	 10347
P4	   846	   847	   848	   849	   850	   851	   855	   856	  1258	  1264	  1265	  1278	  1279	  1280
	  1329	  1330	  1341	  1377	  1378	  1381	  1411	  1412	  1435	  1451	  1452	  1453	  1462	  1494
	  1496	  1497	  1511	  1522	  1530	  1556	  1564	  1569	  1573	  1580	  1582	  1591	  1625	  1656
	  1674	  1715	  1731	  1783	  1787	  1802	  1807	  1813	  1834	  1840	  1844	  1845	  1855	  1869
	  1879	  1918	  1941	  3408	  3424	  3577	  3578	  3579	  3589	  3590	  3591	  3593	  3594	  3595
	  3597	  3598	  3599	  3600	  3601	  3602	  3603	  3604	  3605	  3622	  3627	  3629	  3630	  3631
	  3638	  3643	  3646	  3647	  3648	  3987	  3988	  3989	  4849	  4851	  4931	  5423	  7142	  7147
	  7153	  7154	  7156	  7158	  7166	  7171	  7179	  7185	  7187	  7191	  7194	  7217	  7236	  7264
	  7308	  7310	  7312	  7313	  7317	  7322	  7376	  7388	  7401	  7403	  7404	  7405	  7406	  7407
	  8363	  8366	  8389	  8397	  8446	 10027	 10028	 10029	 10329	 10346
PATCH2	 10966#
PBDISC	  3151	  3192	  3460	  3500	 11226#
PBTIMO	  3405#	  4873
PEVEN8	    84%	  9347	  9429
PG	  6961	  6962	  6967	  6978
PGBIN	  3119	  3378#
PGBIN1	  3374	  3394#
PGBOP	  3123	  3481#
PGBOP1	  3495#	  3497
PGBOP2	  3494	  3499#
PGBOP3	  3506	  3512#
PGBOT	  3132	  3431#
PGBOT1	  3440	  3444#
PGBOTC	  3432	  3435	  3442	  3468#
PGBPF	  3122	  3317#
PGBPN	  3121	  3308#
PGCGB	  3118	  3293#
PGECO	  3136	  4135#
PGFIL	  3129	  4511#
PGHNG	  3134	  3273#
PGHSH	  3116	  3654#
PGOUT	  3131	  4058#
PGRUB	  3130	  4031#
PGSBL	  3128	  3547#
PGSEC	  3125	  3271#
PGSGR	  3137	  3266#
PGSOG	  3138	  3299#
PGSRD	  3124	  3265#
PGSTC	  3127	  3278#
PGSTP	  3126	  3272#
PGSYL	  3133	  3323#
PGSYLN	  3328	  3346#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

PGTRI	  3120	  3360#
PGTRI1	  3362	  3372#
PGTRO	  3117	  3517#
PGZAP	  3135	  3525#
PGZAP1	  3539	  3542#
PJBSTS	  1805%	  1805	  7202%	  7202	  7444%	  7444	  7932%	  7932	  9800%	  9800	  9816%	  9816
PJOBN	    84%	  1507	  1514	  1911	  1936	  3052	  4936	  5010	  5277	  5476	  6011	  6018	  6340	  7080
	  7460	  8771	  8811	  8865	  8894	  8918	  9149	 10056	 10061	 10227	 10474	 10594	 10612	 10735
	 10926
PNTOB1	  6175	  6179#
PNTOBK	  6153	  6171#
POLPRT	  7554#
POLPT1	  7562#	  7581
POLPT3	  7565	  7571	  7579#
POLPT4	  7559	  7580	  7582#
POLPT5	  7572	  7583#
PORTN	  6271%	  6271	  6273%	  6273	  9606%	  9606	  9742%	  9742	 10920%	 10920
PPORTN	  6271%	  6271
PRCCR	  4469	  4554#
PRCFIL	  4561#	  4570
PRCFL1	  4573	  4577#
PRCOCW	  4549#	  4789
PRCOM	  1158%	  1158	  1418%	  1418	  1421%	  1421	  1424%	  1424
PRCOT1	  4557	  4581#
PRCOT2	  4564	  4582#	  4602
PRCOT3	  4535	  4543	  4583#	  4655
PRCOUT	  4040	  4067	  4487	  4533#
PROACT	  4541	  4590#
PROUCC	  4544	  4785#
PRPER	  8373%	  8373
PRPRMT	 10259%	 10259	 10439%	 10439
PRT2	  8375%	  8375
PRTBTM	  4811	  4815#
PRTBVR	  8365	  8369#
PRTCRS	  1132	  1133	  1142#	  1428
PRTDEC	  8372%	  8372
PRTIRG	  1375	  1396	  1401#	  1618
PRTKEY	  1161#
PRTOCT	  1145%	  1145	  1149%	  1149	  1157%	  1157	  1160%	  1160	  1169%	  1169	  1404%	  1404	  1408%	  1408
	  1413%	  1413	  1417%	  1417	  1420%	  1420	  1423%	  1423	  1426%	  1426
PRTUT1	  2958	  2970#
PSDONE	  1866	  1869#
PTBSIZ	  3141#	  3168	  3169	 11225
PTYBUD	  3153	  3210	  3229	  3285	  3324	  3395	  3420	  3437	  3537	  3551	  6287#	  6473	  6520	  6770
	 10876
PTYBUF	  3161	  3198	  3204	 11225#
PTYDDB	  6245	  6251	  6334#
PTYFLO	  4838	 11224#
PTYLDB	  6243	  6250	  6295#
PTYLOS	  3547	 11213#
PTYSBL	  3556#
PTYTRN	  3015	  3116#
PUNIT	    85%	 10620
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

PVYHNG	  5497%	  5497
PVYMOD	    85%	  8919
PX.MEM	  5246	  5257	  5262	  5300	  5327	  5336	  5376	  5386	  5389	  5394	  5651	  5737	  5754	  5767
	  5806	  5808	  5816	  5826	  5828	  5830	  5843	  5844	  5856	  5858	  5862	  5872	  5901	  5904
	  5934	  5981	  5998	  6044	  6056	  6082	  6261	  6264	  6353	  6359	  6459	  6460	  6463	  6476
	  6483	  6487	  6736	  6745	  6756	  6772	  6781	  6788	  6791	  6832	  6838	  6851	  6873	  6877
	  6886	  6894	  6921	  6961	  6967	  6978	  7008	  7090	  7386	  7467	  7475	  7493	  7507	  7510
	  7511	  7554	  7574	  7576	  7583	  7754	  7810	  7847	  7858	  7862	  9788	  9794	 10324	 10325
	 10385	 10518
PX.SRC	  5246	  5257	  5300	  5336	  5386	  5389	  5651	  5767	  5808	  5830	  5862	  6877	  6886	  6894
	  6967	  7386	  7862	  9788	  9794
QUEPCB	    79%	  9802	  9818	  9819
RCVANS	  1434	  8445#
RCVAUX	  1440	  7207#
RCVCH1	  2015#	  2052
RCVCH2	  2023	  2031#
RCVCHR	  2008#	  2222	  2236	  2251	  2263	  2269	  2279	  2288	  2296	  2304	  2310	  2319	  2328	  2491
	  2500	  2506	  2515	  2525	  2537	  2543
RCVLOS	  1454	  1813#
RCVNSP	  1438	  7139#
RCVPS	  1495	  1859#
RCVRAK	  1437	  8363#
RCVRES	  1436	  8388#
RCVS2	  7155	  7164#
RCVS2A	  7167#	  7176
RCVS4	  7157	  7175#
RCVS6	  7159	  7183#
RCVSP	  7160	  7189#
RCVSUR	  1457	  7150#
RCVTCX	  1832	  1836#
RCVTMC	  1473	  1829#
RCVWK1	  4973	  4977	  4987#
RCVZAP	  1444	  1872#
RDNXT	  5712	  6032#
RECHLT	  2010	  2058	  2060#
RECHT1	  2064	  2069#
RECVRG	  2017	  2036#
RED	  1448	  1575#
REFLAG	    84%	 10989
RELB0	  8014	  8022	  8026#
RELBB	  8068	  8136#
RELBB1	  8137	  8147#
RELBBF	  7990	  8138#
RELBI	  1668	  1697	  7643	  7664	  7727	  7780	  7787	  8013#
RELBIO	  8016	  8024	  8061	  8068#
RELBO	  1738	  7665	  7850	  8021#
RELEA6	    91%	  5572	  7099	 10512
REQBUF	  7684	  7711	  7805#
RETACH	 10324#
RETCH1	 10369	 10372#
RETCH2	 10371	 10377#
RETZRO	  5997#	  6017	  6029
RIDLIN	  2670	  2687#	  2854
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

RIDLN1	  2693	  2698#
RIDLN2	  2704	  2710#
RIDLN3	  2688	  2713#
RLBIO1	  8071	  8077#
RMTAL1	  2378	  2395#
RMTALT	  2374	  2397#
RMTBSP	  2379	  2389	  2460#
RMTCN1	  2392#	  2396
RMTCNT	  2338	  2341#	  2393
RMTCR	  2371	  2381	  2407#
RMTECR	  2350#	  2414
RMTECT	  2337	  2355#
RMTEU1	  2413	  2417#
RMTEXC	  2370	  2377	  2411#
RMTEXU	  2372	  2415#
RMTFF	  2376	  2386	  2434#
RMTPAT	  2388	  2390#
RMTRUB	  2405	  2421#
RMTS10	  2365	  2368	  2370#
RMTS94	  2366	  2367	  2380#
RMTSPA	  2355	  2361#
RMTSPT	  2363	  2365#
RMTTAB	  2373	  2383	  2441#
RMTTB1	  2448	  2453#
RMTVT	  2375	  2385	  2427#
RMXLIN	  1368%	  1368
RNQ	   100%	  1804	  7201	  9815
RPORTN	  1267%	  1267	  2948	  3832%	  3832	  5445%	  5445	  8428%	  8428
RT.CON	 10311#	 10415
RT.MOD	 10304#
RT.SIG	 10310#	 10499	 10507
RT.SLV	 10303#
RTATC	 10392#
RTATS	 10388	 10446#
RTATS1	 10448	 10451	 10466#
RTATS2	 10462	 10481#
RTAUX%	 10320#	 10399
RTCCO	 10422	 10429	 10436#
RTCONT	 10255	 10274#	 10416
RTCSV	 10420	 10426#
RTCUS	 10423	 10428	 10431#
RTERJ	 10373	 10380	 10400	 10405	 10458	 10472	 10517#
RTERR	 10334	 10340	 10351	 10357	 10518#
RTFIN	 10421	 10434	 10438	 10441	 10486	 10489#
RTFIN1	 10495	 10507#
RTFIN2	 10508	 10511#
RTNRM%	 10321#	 10471
RTSAC%	 10313#	 10333
RTSCP%	 10319#	 10379
RTSNA%	 10317#	 10372
RTSNX%	 10314#	 10339
RTTAC%	 10315#	 10350
RTTAT%	 10318#	 10404	 10457
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

RTTNX%	 10316#	 10356
RUBSTR	  2353	  2432	  2439	  2451	  2480#	  2488	  2664	  4460
RWARN	  2014	  2047#
RWARN1	  2048	  2054#
S	  1665	  1666	  1678	  1679	  4128	  4129	  4130	  4887	  4888	  4889	  4890	  4923	  4924	  4929
	  4950	  4974	  4975	  4976	  4978	  4980	  4981	  4989	  4990	  5048	  5049	  5051	  5052	  5057
	  5058	  5062	  5063	  5233	  5266	  5267	  5270	  5316	  5318	  5320	  5324	  5325	  5337	  5346
	  5347	  5364	  5365	  5505	  5506	  5552	  5553	  5740	  5741	  5969	  5977	  5978	  6040	  6041
	  6102	  6116	  6117	  6363	  6798	  6934	  6935	  7084	  7135	  7679	  7706	  7724	  7725	  7733
	  7778	  8519	  8521	  8522	  8790	  8859	  8874	  8875	  8876	  8877	  8888	  8926	  8934	  8936
	  8938	  8940	  8954	  8962	  8963	  8978	  9000	  9001	  9029	  9030	  9031	  9032	  9045	  9046
	  9047	  9048	  9058	  9059	  9069	  9070	  9263	  9264	  9270	  9274	  9656	  9691	  9692	  9698
	  9699	  9702	  9703	 10159	 10160	 10162	 10163	 10551	 10709	 10712	 10717	 10718	 10723	 10732
	 10733	 10735	 10736	 10742	 10744	 10745	 10747	 10748	 10752	 10753	 10755	 10756	 10758	 10759
	 10764	 10765	 10767	 10768	 10770	 10771	 10780	 10832	 10833	 10909	 10910
S$ENTR	    11	    17	  1102	  1133	  1134	  1376	  1397	  1432	  1455	  1458	  1460	  1463	  1465	  1467
	  1469	  1471	  1474	  1476	  1479	  1482	  1487	  1490	  1498	  1619	  1628	  1658	  1794	  2959
	  2985	  3069	  3179	  3235	  3246	  3267	  3336	  3367	  3385	  3413	  3446	  3450	  3457	  3470
	  3483	  3557	  3621	  3637	  3654	  3833	  3889	  3936	  3945	  4812	  5041	  5102	  5116	  5119
	  5151	  5619	  5943	  6297	  6300	  6336	  6486	  6618	  6712	  6949	  7334	  7335	  7337	  7339
	  7828	  7963	  7977	  8122	  8127	  8139	  8148	  8366	  8392	  8661	  9586	  9635	 10114	 10395
	 10468	 10530	 11005	 11013	 11016
S$EVEN	  1132	  1133	  1375	  1396	  1618	  1627	  2958	  3384	  3556	  3888	  3944	  4811	  4812	  5040
	  5101	  8121	  8365	  8366	 10113
S$HALT	    11	  1102	  1132	  1133	  1375	  1396	  1432	  1455	  1458	  1460	  1463	  1465	  1467	  1469
	  1471	  1474	  1476	  1479	  1482	  1487	  1490	  1498	  1618	  1627	  1658	  1794	  2958	  2985
	  3069	  3179	  3235	  3246	  3267	  3336	  3367	  3384	  3413	  3446	  3450	  3457	  3470	  3483
	  3556	  3621	  3637	  3654	  3833	  3888	  3936	  3944	  4811	  5040	  5101	  5116	  5119	  5151
	  5619	  5943	  6297	  6300	  6336	  6486	  6618	  6712	  6949	  7334	  7335	  7337	  7339	  7828
	  7963	  7977	  8121	  8127	  8139	  8148	  8365	  8392	  8661	  9586	  9635	 10113	 10395	 10468
	 10530	 11005	 11013	 11016
S$INFO	  1132	  1133	  1134	  1375	  1376	  1396	  1397	  1618	  1619	  1627	  1628	  2958	  2959	  3384
	  3556	  3557	  3888	  3889	  3944	  3945	  4811	  5040	  5041	  5101	  5102	  8121	  8365	 10113
S$JOB	  3384	  3385
S$NAME	    15#	  1794	  3069	  3179	  3235	  3246	  3267	  3336	  3413	  3446	  3450	  3457	  3470	  3483
	  3621	  3637	  3654	  3833	  3936	  5116	  5119	  5151	  5619	  5943	  6297	  6300	  6336	  6486
	  6618	  6712	  6949	  7334	  7335	  7337	  7339	  7828	  7963	  7977	  8139	  8148	  8661	  9586
	  9635	 10395	 10468	 10530	 11005	 11013	 11016
S$NONA	    14	    17	  1103	  1133	  1134	  1376	  1397	  1433	  1456	  1459	  1461	  1464	  1466	  1468
	  1470	  1472	  1475	  1477	  1480	  1483	  1488	  1491	  1499	  1619	  1628	  1659	  1794	  2959
	  2986	  3069	  3179	  3235	  3246	  3267	  3336	  3368	  3385	  3413	  3446	  3450	  3457	  3470
	  3483	  3557	  3621	  3637	  3654	  3833	  3889	  3936	  3945	  4812	  5041	  5102	  5116	  5119
	  5151	  5619	  5943	  6297	  6300	  6336	  6486	  6618	  6712	  6949	  7334	  7335	  7337	  7339
	  7828	  7963	  7977	  8122	  8128	  8139	  8148	  8366	  8393	  8661	  9586	  9635	 10114	 10395
	 10468	 10530	 11005	 11013	 11016
S$PATC	  1132	  1133	  1375	  1396	  1618	  1627	  2958	  3384	  3556	  3888	  3944	  4811	  5040	  5101
	  8121	  8365	 10113
S$STOP	  1132	  1133	  8121	  8122	 10113	 10114
S$TEMP	    11#	    11	  1102#	  1102	  1132#	  1132	  1133#	  1133	  1375#	  1375	  1396#	  1396	  1432#	  1432
	  1455#	  1455	  1458#	  1458	  1460#	  1460	  1463#	  1463	  1465#	  1465	  1467#	  1467	  1469#	  1469
	  1471#	  1471	  1474#	  1474	  1476#	  1476	  1479#	  1479	  1482#	  1482	  1487#	  1487	  1490#	  1490
	  1498#	  1498	  1618#	  1618	  1627#	  1627	  1658#	  1658	  1794#	  1794	  2958#	  2958	  2985#	  2985
	  3069#	  3069	  3179#	  3179	  3235#	  3235	  3246#	  3246	  3267#	  3267	  3336#	  3336	  3367#	  3367
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

	  3384#	  3384	  3413#	  3413	  3446#	  3446	  3450#	  3450	  3457#	  3457	  3470#	  3470	  3483#	  3483	  3556#
	  3556	  3621#	  3621	  3637#	  3637	  3654#	  3654	  3833#	  3833	  3888#	  3888	  3936#	  3936	  3944#
	  3944	  4811#	  4811	  5040#	  5040	  5101#	  5101	  5116#	  5116	  5119#	  5119	  5151#	  5151	  5619#
	  5619	  5943#	  5943	  6297#	  6297	  6300#	  6300	  6336#	  6336	  6486#	  6486	  6618#	  6618	  6712#
	  6712	  6949#	  6949	  7334#	  7334	  7335#	  7335	  7337#	  7337	  7339#	  7339	  7828#	  7828	  7963#
	  7963	  7977#	  7977	  8121#	  8121	  8127#	  8127	  8139#	  8139	  8148#	  8148	  8365#	  8365	  8392#
	  8392	  8661#	  8661	  9586#	  9586	  9635#	  9635	 10113#	 10113	 10395#	 10395	 10468#	 10468	 10530#
	 10530	 11005#	 11005	 11013#	 11013	 11016#	 11016
S$XCT	    17	  1102	  1103	  1133	  1134	  1376	  1397	  1432	  1433	  1455	  1456	  1458	  1459	  1460
	  1461	  1463	  1464	  1465	  1466	  1467	  1468	  1469	  1470	  1471	  1472	  1474	  1475	  1476
	  1477	  1479	  1480	  1482	  1483	  1487	  1488	  1490	  1491	  1498	  1499	  1619	  1628	  1658
	  1659	  1794	  2959	  2985	  2986	  3069	  3179	  3235	  3246	  3267	  3336	  3367	  3368	  3385
	  3413	  3446	  3450	  3457	  3470	  3483	  3557	  3621	  3637	  3654	  3833	  3889	  3936	  3945
	  4812	  5041	  5102	  5116	  5119	  5151	  5619	  5943	  6297	  6300	  6336	  6486	  6618	  6712
	  6949	  7334	  7335	  7337	  7339	  7828	  7963	  7977	  8122	  8127	  8128	  8139	  8148	  8366
	  8392	  8393	  8661	  9586	  9635	 10114	 10395	 10468	 10530	 11005	 11013	 11016
S..KAF	  1102	  1102%
SAV30	  1152%	  1152	  1156	  1159
SCN1PD	  1129	  1130	  1134	  1138#
SCNBLN	 11238#	 11242
SCNBUF	 11237#	 11242
SCNDDB	   610#	   634
SCNDDS	   634#	  5219
SCNDSP	   614	  5215#
SCNEND	 11656#
SCNIN	  1297	  1301	  1304	  1314	  1318	  1323	  1329#	  3085
SCNIN0	  1341#	  1379
SCNIN1	  1375	  1377#	  1381	  1435	  1451	  1452	  1453	  1462	  1494	  1496	  1497	  1547	  1556	  1573
	  1580	  1783	  1787	  1802	  1807	  1834	  1840	  1855	  1869	  1942	  7142	  7147	  7153	  7154
	  7156	  7158	  7166	  7171	  7179	  7185	  7187	  7191	  7194	  7219	  7236	  7264	  8366	  8397
	  8446
SCNIN2	  1381#
SCNINT	  1219#	  9054
SCNLIT	 11247#
SCNNAM	  6341	  7081	  7470	 10232	 10411	 10475	 10619#
SCNNMR	  9762	  9768#	  9771	 10625
SCNNT0	  1221	  1232#
SCNNT2	  1299	  1313#
SCNOUT	  1331	  1342	  2926#
SCNPTR	 11236#	 11238	 11244
SCNREL	    20#	  1259	  1261
SCNSC0	  4800	  4810	  4822#
SCNSC1	  4842	  4845#
SCNSC2	  4846	  4849#
SCNSEC	  4797#
SCNSER	    11	    12#	    15
SCNTCD	  9827#
SCNTIC	  1241	  1295#
SCNVER	    19#	  1259	  1261
SCOLP	  2940#	  3080
SCOLP1	  2936#	  3082
SCOPTY	  2950	  2957#
SCORTY	  2949	  2984#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

SCOTTY	  2967	  2992	  2996#
SECLOP	  4851#	  4931
SECLP1	  4859	  4862#
SECLP2	  4863	  4869	  4874	  4883	  4886	  4891	  4898#
SECLP3	  4901	  4906	  4912#
SECLP4	  4922	  4925	  4928	  4931#
SECTM1	  4872	  4876#
SECTM2	  4878	  4882#
SECTM3	  4876	  4892#
SETBRK	  5240	  5275#	  5298	  5380	  5976
SETFIO	  5867	  6939	  8493	  8770	  8819	  8900	 10909#
SETIO2	    92%	  6414	  6796
SETLIN	  5723	  5934#
SETLMD	  1564	  1569	  2153	  4895	  6108	  6126	  6128#	  6327	  6384	  6859	  6956	  7004	  7263	  8957
	  8961	  8966	  9004	  9279	  9314	  9617	 10265	 10433	 11003
SETLN1	  5937#	  5944
SETOPB	  6652#	  6805	  6817	  6823
SETOUT	  1296	  2926	  3565	  3581	  3587#	  7318	  7326
SETPTB	  3156	  3175#
SETPTL	  2965	  3151#
SETPTP	  6214#
SETRUN	    84%	  1806	  7203	  9266	  9817	 10278
SETSHT	  5538	  8431	  9981#
SETTB1	  6149	  6152#
SETTBK	  5562	  5564	  6141#	  6751	  6762	 10546	 10550
SETTC1	  6500#	  6789	  9959
SETTC2	  6524	  6526	  6528#
SETTCN	  5942	  6461	  6485	  6499#
SIMRZP	  1506	  1510	  1619	  1877	  1879#
SIZIRG	 11192	 11193
SKPFLG	  8869	  9016	  9017	  9027	  9061	  9063	 11230#
SKPIN1	  5796	  5800#
SKPINC	  5727	  5780#	  5949	  6396
SKPINL	  5728	  5792#	  5958	  6428
SLCTAB	  5925#	  5932	  5936
SLCTBN	  5932#	  5936
SNDAUX	  1317	  7267#
SNDBIO	  1322	  1755#
SNDSAD	  1313	 10011#
SNDSRQ	  7273	  7275	  7286#
SPCCM1	  9576#	  9582
SPCCMD	  9547	  9556	  9560	  9566	  9571#	  9580
SPCCMW	  9518	  9573
SPCDBG	  9544	  9545
SPCDND	  9546
SPCF11	  9567
SPCFLG	  9572	  9578
SPCGSW	  9565#
SPCINI	  9542#	  9562
SPCMTD	  9330	  9513	  9519
SPCST1	  9538#	  9543	  9561
SPCTRN	  9540#	  9574
SPCTRY	  9539#	  9575	  9581
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

SPE940	  4332	  4333	  4347#
SPEALP	  4344	  4385#
SPEALT	  4340	  4387	  4391#
SPEAP1	  4355	  4379#
SPEBK3	  4369#
SPEBK6	  4374#	  4380	  4386	  4397	  4404	  4417	  4426
SPEBRK	  4347	  4349	  4351	  4354	  4364#	  4381	  4395	  4409	  4418	  4431	  4439	  4442	  4449	  4457
	  4458	  4461
SPEBS	  4345	  4356	  4422#
SPEBS1	  4424	  4430#
SPECR	  4337	  4348	  4359#
SPEPDP	  4331	  4334	  4336#
SPETAB	  4339	  4350	  4400#
SPETB1	  4402	  4408#
SPEUC1	  4476	  4481#
SPEUCM	  4440	  4450	  4465#
SPEUX	  4338	  4436#
SPEUX1	  4453	  4460#
SPEUXC	  4336	  4343	  4446#
SPEVM	  4341	  4342	  4352	  4353	  4415#
SPHNGI	  9537#	  9551	  9583
SPOBS1	  4659	  4662#
SPOBS2	  4597	  4654#
SPOBSP	  2460	  4654	  4657#
SPOCR	  4593	  4601#
SPOFF	  4596	  4634#
SPOFF1	  4635	  4638#
SPOFIL	  4456	  4616	  4625	  4637	  4647	  4673#	  4679
SPOFL1	  4631	  4640	  4650	  4675#
SPOTAB	  4594	  4606#
SPOTB0	  4612	  4618#
SPOTB1	  4622	  4627#
SPOTBL	  4591	  4593#
SPOVT	  4595	  4644#
SPOVT1	  4645	  4648#
SPRCOM	  9216	  9222#
SPRCTB	  9224	  9226#
SPREAT	  8688	  8694#
SPRETB	  8695	  8702#
SPRTTB	  8597	  8599#
SPRTYI	  8579	  8595#
SSPT	  4772	  4773	  4774	  4775	  4776	  4777	  4778	  4779	  4781#
STATES	    85%	  2144	  2147	  3803	  3814	  3845	  3856	  5537	  9593	  9598	  9983	  9986	 10993
STAUTO	  9592	 10992
STDALT	    42#	  8634
STLST	  5026	  5032#	  5043
STOP10	  1080#
STOP9	  1081#
STOTC1	  5998#	  6019	  6024	  6031	 10950	 10955
STRUB	  2466	  2472#
STRUB1	  2467#	  2476
STSHUT	  3802	  3844	  9982
STSUPR	  2143	  3810	  3852	  9597
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

STTIOD	    83%	  4984
STTLK	  5602#
STTLK0	  5603	  5611#
STTLK1	  5609	  5627	  5630	  5633	  5638#
STTLK2	  5644#	  5657
STTLK3	  5653	  5656	  5659#
STTYBF	   612
SUPTIM	  1854%	  1854	  7140%	  7140
SVOJFF	  3013	  3018	  3032	 11139#
SVPPC	  9527#
SVSPC	 11129#
SYSNUM	  1276%	  1276	  6311%	  6311	  9614%	  9614	 10998%	 10998
T1	  1104	  1115	  1120	  1136	  1144	  1148	  1152	  1156	  1159	  1163	  1164	  1165	  1168	  1240
	  1244	  1267	  1275	  1276	  1277	  1338	  1339	  1403	  1407	  1412	  1416	  1419	  1422	  1425
	  1515	  1516	  1518	  1519	  1523	  1524	  1525	  1526	  1527	  1531	  1532	  1533	  1534	  1539
	  1540	  1541	  1549	  1550	  1551	  1554	  1561	  1563	  1566	  1568	  1570	  1571	  1572	  1575
	  1576	  1577	  1578	  1579	  1585	  1586	  1587	  1588	  1600	  1601	  1604	  1605	  1607	  1608
	  1610	  1611	  1612	  1633	  1634	  1639	  1640	  1641	  1661	  1662	  1680	  1681	  1687	  1688
	  1690	  1691	  1698	  1704	  1705	  1706	  1716	  1717	  1718	  1719	  1721	  1732	  1733	  1734
	  1735	  1736	  1737	  1739	  1771	  1772	  1789	  1790	  1791	  1792	  1796	  1798	  1804	  1805
	  1815	  1816	  1817	  1818	  1819	  1822	  1823	  1824	  1829	  1833	  1846	  1847	  1848	  1849
	  1851	  1853	  1854	  1859	  1860	  1861	  1862	  1863	  1864	  1867	  1873	  1874	  1875	  1878
	  1884	  1885	  1887	  1888	  1889	  1890	  1891	  1892	  1893	  1895	  1896	  1897	  1898	  1905
	  1906	  1918	  1919	  1920	  1936	  1937	  1948	  1949	  1950	  1960	  1968	  1969	  1970	  1971
	  1972	  1973	  1974	  1975	  2021	  2022	  2027	  2028	  2029	  2031	  2032	  2049	  2050	  2051
	  2054	  2055	  2061	  2062	  2065	  2066	  2067	  2069	  2070	  2071	  2085	  2086	  2087	  2092
	  2095	  2096	  2097	  2098	  2099	  2100	  2101	  2102	  2103	  2104	  2105	  2110	  2111	  2113
	  2114	  2115	  2129	  2130	  2131	  2132	  2133	  2134	  2135	  2138	  2139	  2140	  2141	  2143
	  2144	  2149	  2163	  2166	  2172	  2220	  2221	  2234	  2235	  2240	  2241	  2249	  2250	  2271
	  2272	  2281	  2282	  2283	  2290	  2291	  2313	  2314	  2336	  2337	  2346	  2348	  2350	  2351
	  2361	  2363	  2407	  2408	  2422	  2423	  2424	  2453	  2482	  2483	  2484	  2493	  2494	  2517
	  2518	  2527	  2528	  2529	  2545	  2546	  2552	  2554	  2604	  2605	  2614	  2615	  2618	  2619
	  2653	  2654	  2660	  2661	  2663	  2672	  2673	  2687	  2689	  2696	  2730	  2731	  2732	  2751
	  2752	  2754	  2755	  2756	  2767	  2768	  2797	  2798	  2799	  2800	  2807	  2808	  2809	  2821
	  2829	  2831	  2832	  2843	  2844	  2846	  2856	  2857	  2863	  2864	  2866	  2867	  2880	  2881
	  2934	  2935	  2936	  2937	  2939	  2942	  2944	  2945	  2946	  2948	  2961	  2962	  2970	  2974
	  2978	  2990	  2996	  2997	  2998	  2999	  3006	  3007	  3008	  3009	  3019	  3020	  3021	  3022
	  3026	  3033	  3034	  3035	  3036	  3044	  3045	  3052	  3055	  3081	  3082	  3154	  3155	  3161
	  3162	  3163	  3164	  3165	  3166	  3167	  3168	  3169	  3176	  3177	  3178	  3180	  3182	  3192
	  3193	  3197	  3198	  3203	  3215	  3216	  3219	  3221	  3222	  3230	  3231	  3233	  3234	  3237
	  3240	  3247	  3248	  3254	  3256	  3257	  3258	  3259	  3287	  3293	  3303	  3308	  3309	  3311
	  3312	  3317	  3318	  3319	  3326	  3327	  3332	  3333	  3334	  3335	  3338	  3346	  3347	  3348
	  3349	  3360	  3361	  3363	  3364	  3365	  3366	  3370	  3378	  3379	  3380	  3381	  3382	  3383
	  3386	  3387	  3389	  3390	  3410	  3411	  3412	  3417	  3433	  3434	  3438	  3439	  3444	  3445
	  3452	  3453	  3455	  3456	  3458	  3459	  3460	  3468	  3469	  3471	  3472	  3474	  3475	  3476
	  3477	  3481	  3482	  3484	  3485	  3505	  3508	  3509	  3512	  3513	  3517	  3518	  3525	  3526
	  3529	  3530	  3534	  3535	  3548	  3552	  3564	  3566	  3567	  3571	  3572	  3575	  3576	  3577
	  3605	  3606	  3607	  3655	  3656	  3671	  3672	  3673	  3675	  3676	  3705	  3706	  3767	  3768
	  3780	  3783	  3790	  3791	  3796	  3797	  3802	  3803	  3805	  3806	  3810	  3814	  3818	  3819
	  3823	  3824	  3826	  3827	  3828	  3838	  3839	  3844	  3845	  3847	  3848	  3852	  3856	  3858
	  3859	  3863	  3864	  3866	  3867	  3868	  3891	  3892	  3897	  3898	  3918	  3919	  3925	  3948
	  3949	  3955	  3958	  3959	  3970	  3971	  3972	  3973	  3983	  3984	  3985	  3986	  4003	  4004
	  4005	  4018	  4019	  4099	  4100	  4101	  4102	  4148	  4153	  4155	  4156	  4174	  4175	  4176
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

	  4177	  4178	  4179	  4180	  4221	  4222	  4236	  4237	  4273	  4274	  4293	  4294	  4311	  4312	  4322
	  4323	  4327	  4329	  4359	  4364	  4369	  4374	  4400	  4401	  4403	  4405	  4408	  4410	  4415
	  4416	  4422	  4425	  4427	  4430	  4432	  4482	  4483	  4488	  4489	  4490	  4539	  4545	  4554
	  4555	  4606	  4607	  4608	  4611	  4613	  4614	  4619	  4620	  4627	  4629	  4630	  4638	  4639
	  4648	  4649	  4657	  4658	  4660	  4661	  4662	  4663	  4664	  4785	  4786	  4801	  4803	  4804
	  4805	  4809	  4818	  4819	  4838	  4839	  4843	  4844	  4847	  4848	  4854	  4855	  4858	  4861
	  4862	  4870	  4871	  4877	  4878	  4892	  4893	  4898	  4900	  4902	  4903	  4905	  4913	  4915
	  4916	  4917	  4918	  4926	  4927	  4936	  4937	  4944	  4945	  4946	  4952	  4953	  4954	  4955
	  4961	  4962	  4963	  4970	  4971	  4982	  4986	  4993	  4994	  4995	  5004	  5007	  5008	  5010
	  5011	  5012	  5015	  5025	  5026	  5027	  5032	  5033	  5036	  5037	  5042	  5054	  5086	  5089
	  5090	  5091	  5114	  5117	  5118	  5121	  5127	  5128	  5130	  5139	  5140	  5152	  5153	  5160
	  5161	  5197	  5198	  5201	  5202	  5204	  5207	  5208	  5219	  5241	  5250	  5279	  5280	  5283
	  5284	  5286	  5287	  5288	  5290	  5294	  5295	  5300	  5302	  5303	  5304	  5317	  5321	  5322
	  5328	  5348	  5349	  5350	  5354	  5355	  5356	  5357	  5415	  5416	  5422	  5423	  5427	  5428
	  5440	  5441	  5443	  5450	  5451	  5458	  5462	  5477	  5490	  5491	  5497	  5498	  5503	  5516
	  5517	  5528	  5536	  5537	  5539	  5540	  5541	  5542	  5545	  5556	  5557	  5559	  5560	  5561
	  5563	  5602	  5604	  5605	  5606	  5613	  5614	  5615	  5617	  5622	  5634	  5646	  5747	  5748
	  5749	  5775	  5776	  5784	  5785	  5786	  5787	  5792	  5794	  5795	  5817	  5818	  5819	  5845
	  5846	  5847	  5854	  5855	  5872	  5875	  5876	  5877	  5880	  5883	  5885	  5889	  5892	  5898
	  5899	  5900	  5901	  5941	  5996	  5997	  5998	  6001	  6002	  6018	  6023	  6030	  6047	  6048
	  6050	  6051	  6052	  6056	  6059	  6082	  6085	  6086	  6087	  6089	  6090	  6091	  6092	  6093
	  6094	  6095	  6096	  6100	  6101	  6103	  6104	  6105	  6107	  6119	  6121	  6123	  6128	  6129
	  6130	  6141	  6142	  6143	  6145	  6146	  6147	  6150	  6161	  6162	  6163	  6172	  6173	  6174
	  6175	  6186	  6195	  6214	  6215	  6217	  6218	  6219	  6220	  6221	  6222	  6223	  6224	  6225
	  6226	  6240	  6242	  6246	  6249	  6257	  6264	  6271	  6272	  6273	  6275	  6278	  6295	  6299
	  6306	  6309	  6310	  6311	  6312	  6316	  6317	  6322	  6323	  6324	  6325	  6334	  6335	  6342
	  6343	  6344	  6345	  6359	  6360	  6362	  6382	  6383	  6459	  6474	  6475	  6478	  6480	  6482
	  6483	  6499	  6500	  6502	  6503	  6507	  6509	  6511	  6512	  6514	  6521	  6522	  6525	  6526
	  6603	  6604	  6606	  6616	  6617	  6619	  6621	  6629	  6630	  6645	  6647	  6649	  6650	  6652
	  6689	  6691	  6692	  6693	  6694	  6695	  6697	  6698	  6699	  6710	  6748	  6750	  6759	  6761
	  6771	  6772	  6773	  6774	  6780	  6781	  6782	  6783	  6787	  6803	  6804	  6809	  6810	  6812
	  6813	  6814	  6815	  6816	  6821	  6822	  6831	  6832	  6833	  6834	  6838	  6839	  6840	  6841
	  6842	  6875	  6877	  6891	  6892	  6893	  6927	  6928	  6929	  6932	  6936	  6976	  6977	  6985
	  6998	  6999	  7000	  7001	  7002	  7003	  7045	  7046	  7051	  7052	  7055	  7056	  7058	  7059
	  7069	  7074	  7075	  7076	  7077	  7078	  7079	  7089	  7090	  7096	  7128	  7129	  7130	  7132
	  7133	  7139	  7140	  7145	  7146	  7150	  7151	  7164	  7165	  7167	  7168	  7169	  7170	  7175
	  7176	  7177	  7183	  7184	  7189	  7190	  7192	  7193	  7196	  7201	  7202	  7207	  7208	  7209
	  7215	  7216	  7221	  7222	  7232	  7238	  7239	  7242	  7243	  7255	  7256	  7257	  7258	  7259
	  7260	  7261	  7267	  7268	  7289	  7290	  7291	  7292	  7300	  7301	  7305	  7306	  7307	  7314
	  7315	  7316	  7323	  7324	  7331	  7332	  7343	  7346	  7374	  7375	  7386	  7443	  7444	  7455
	  7456	  7461	  7463	  7464	  7466	  7467	  7471	  7478	  7493	  7495	  7505	  7507	  7508	  7510
	  7516	  7517	  7522	  7529	  7530	  7534	  7554	  7556	  7568	  7599	  7600	  7604	  7605	  7610
	  7611	  7619	  7620	  7625	  7626	  7630	  7631	  7638	  7639	  7641	  7642	  7646	  7647	  7655
	  7656	  7661	  7662	  7663	  7670	  7671	  7677	  7678	  7688	  7704	  7705	  7715	  7730	  7731
	  7750	  7786	  7790	  7792	  7794	  7796	  7813	  7825	  7829	  7830	  7831	  7832	  7836	  7837
	  7840	  7841	  7859	  7861	  7865	  7885	  7886	  7887	  7931	  7932	  7961	  7962	  7965	  7971
	  7976	  7979	  7984	  7985	  7986	  7992	  8000	  8007	  8013	  8014	  8021	  8022	  8026	  8032
	  8033	  8034	  8036	  8038	  8042	  8048	  8049	  8051	  8052	  8069	  8070	  8072	  8077	  8125
	  8126	  8129	  8138	  8141	  8147	  8150	  8151	  8363	  8364	  8371	  8374	  8389	  8390	  8391
	  8395	  8396	  8480	  8491	  8504	  8505	  8510	  8511	  8513	  8514	  8516	  8517	  8527	  8528
	  8530	  8531	  8532	  8533	  8538	  8539	  8541	  8542	  8543	  8544	  8545	  8546	  8547	  8550
	  8551	  8564	  8566	  8590	  8591	  8592	  8675	  8677	  8711	  8712	  8736	  8737	  8739	  8740
	  8743	  8745	  8746	  8749	  8768	  8771	  8778	  8779	  8780	  8784	  8785	  8793	  8794	  8801
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

	  8802	  8803	  8804	  8806	  8808	  8809	  8814	  8824	  8827	  8828	  8838	  8839	  8841	  8842	  8843
	  8844	  8847	  8849	  8850	  8862	  8863	  8865	  8866	  8871	  8891	  8892	  8894	  8895	  8898
	  8905	  8906	  8925	  8927	  8928	  8929	  8933	  8935	  8937	  8939	  8941	  8945	  8947	  8948
	  8949	  8950	  8956	  8958	  8959	  8960	  8964	  8965	  8967	  8972	  8984	  8985	  8987	  9002
	  9003	  9010	  9016	  9019	  9020	  9024	  9033	  9035	  9036	  9037	  9038	  9042	  9043	  9076
	  9077	  9079	  9080	  9081	  9082	  9083	  9089	  9090	  9092	  9093	  9094	  9095	  9096	  9105
	  9106	  9107	  9109	  9110	  9113	  9114	  9115	  9121	  9122	  9123	  9124	  9138	  9139	  9140
	  9207	  9208	  9222	  9226	  9227	  9228	  9229	  9247	  9248	  9252	  9253	  9276	  9277	  9284
	  9285	  9289	  9297	  9298	  9302	  9308	  9309	  9312	  9313	  9378	  9379	  9380	  9389	  9413
	  9414	  9417	  9426	  9437	  9440	  9452	  9461	  9463	  9464	  9465	  9466	  9467	  9528	  9531
	  9543	  9544	  9546	  9549	  9550	  9551	  9552	  9554	  9556	  9557	  9559	  9561	  9565	  9567
	  9573	  9574	  9575	  9577	  9579	  9580	  9592	  9593	  9597	  9598	  9600	  9603	  9614	  9615
	  9622	  9675	  9677	  9678	  9681	  9688	  9689	  9718	  9719	  9720	  9722	  9724	  9728	  9729
	  9730	  9731	  9734	  9737	  9740	  9741	  9753	  9758	  9768	  9769	  9770	  9772	  9773	  9774
	  9779	  9783	  9784	  9785	  9799	  9800	  9801	  9802	  9815	  9816	  9827	  9828	  9829	  9830
	  9831	  9904	  9918	  9925	  9926	  9933	  9937	  9942	  9946	  9953	  9972	  9975	  9981	  9984
	  9985	 10011	 10012	 10014	 10022	 10023	 10025	 10026	 10030	 10031	 10056	 10057	 10058	 10059
	 10060	 10061	 10076	 10077	 10079	 10082	 10088	 10090	 10097	 10099	 10101	 10103	 10104	 10108
	 10110	 10111	 10132	 10133	 10143	 10144	 10157	 10158	 10164	 10165	 10178	 10179	 10183	 10184
	 10185	 10186	 10225	 10226	 10228	 10240	 10245	 10246	 10251	 10253	 10254	 10256	 10257	 10263
	 10264	 10274	 10276	 10324	 10325	 10333	 10336	 10337	 10339	 10350	 10353	 10354	 10356	 10372
	 10379	 10382	 10383	 10385	 10399	 10402	 10403	 10404	 10408	 10418	 10424	 10426	 10427	 10431
	 10432	 10436	 10437	 10449	 10450	 10455	 10456	 10457	 10460	 10461	 10466	 10467	 10471	 10476
	 10477	 10481	 10482	 10483	 10484	 10493	 10494	 10509	 10518	 10533	 10534	 10535	 10536	 10538
	 10540	 10541	 10542	 10543	 10545	 10547	 10549	 10566	 10571	 10572	 10573	 10574	 10575	 10576
	 10578	 10580	 10582	 10583	 10593	 10594	 10595	 10608	 10609	 10610	 10611	 10619	 10620	 10633
	 10639	 10649	 10650	 10653	 10661	 10662	 10664	 10673	 10674	 10677	 10678	 10682	 10687	 10688
	 10689	 10690	 10700	 10701	 10704	 10805	 10807	 10852	 10853	 10854	 10865	 10866	 10890	 10891
	 10893	 10894	 10895	 10903	 10904	 10905	 10906	 10925	 10926	 10927	 10933	 10943	 10946	 10951
	 10952	 10954	 10973	 10974	 10975	 10976	 10980	 10981	 10983	 10992	 10993	 10995	 10996	 10997
	 10998	 10999	 11000	 11001	 11011	 11017	 11027	 11028	 11029	 11031	 11032	 11037	 11039	 11041
	 11042	 11043	 11044	 11046
T2	  1089	  1090	  1091	  1093	  1094	  1096	  1097	  1099	  1100	  1101	  1111	  1112	  1113	  1116
	  1117	  1118	  1122	  1123	  1124	  1125	  1126	  1127	  1128	  1131	  1246	  1247	  1248	  1249
	  1250	  1251	  1252	  1253	  1508	  1509	  1552	  1553	  1647	  1648	  1691	  1721	  1722	  1740
	  1741	  1786	  1793	  1795	  1797	  1830	  1831	  1833	  1843	  1847	  1850	  1851	  1958	  1968
	  1969	  1970	  1971	  1972	  1973	  1974	  1975	  2016	  2019	  2024	  2030	  2037	  2038	  2039
	  2258	  2274	  2323	  2334	  2362	  2365	  2366	  2367	  2368	  2465	  2468	  2473	  2474	  2509
	  2548	  2553	  2556	  2557	  2558	  2559	  2598	  2603	  2606	  2611	  2613	  2616	  2617	  2620
	  2630	  2643	  2690	  2691	  2692	  2693	  2694	  2695	  2698	  2699	  2701	  2702	  2703	  2704
	  2705	  2706	  2707	  2710	  2773	  2775	  2776	  2779	  2785	  3002	  3004	  3012	  3013	  3014
	  3015	  3018	  3020	  3032	  3034	  3180	  3181	  3299	  3300	  3335	  3337	  3366	  3369	  3386
	  3387	  3388	  3389	  3390	  3414	  3415	  3447	  3448	  3452	  3471	  3472	  3484	  3490	  3491
	  3492	  3494	  3497	  3499	  3500	  3501	  3730	  3732	  3749	  3750	  3754	  3755	  3761	  3773
	  3774	  3830	  3831	  3832	  3889	  3890	  3891	  3893	  3894	  3895	  3896	  3898	  3899	  3900
	  3901	  3908	  4036	  4039	  4051	  4063	  4066	  4072	  4078	  4079	  4087	  4089	  4090	  4111
	  4112	  4143	  4146	  4154	  4174	  4175	  4176	  4177	  4178	  4179	  4180	  4328	  4331	  4332
	  4333	  4334	  4423	  4424	  4561	  4562	  4566	  4590	  4591	  4802	  4803	  4804	  4914	  4919
	  4983	  4985	  5024	  5025	  5027	  5033	  5034	  5037	  5038	  5039	  5042	  5043	  5080	  5083
	  5086	  5087	  5089	  5091	  5092	  5093	  5094	  5095	  5100	  5111	  5112	  5114	  5115	  5126
	  5128	  5130	  5131	  5138	  5139	  5141	  5142	  5144	  5150	  5152	  5154	  5155	  5163	  5165
	  5179	  5180	  5182	  5183	  5188	  5190	  5200	  5205	  5206	  5209	  5258	  5300	  5301	  5303
	  5434	  5435	  5440	  5445	  5447	  5459	  5460	  5467	  5468	  5473	  5474	  5523	  5525	  5542
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

	  5568	  5569	  5571	  5641	  5642	  5647	  5659	  5939	  5940	  5975	  6037	  6141	  6143	  6145	  6148
	  6151	  6152	  6176	  6177	  6188	  6192	  6275	  6276	  6278	  6279	  6298	  6299	  6307	  6308
	  6309	  6460	  6478	  6482	  6484	  6500	  6504	  6513	  6514	  6515	  6605	  6606	  6620	  6621
	  6634	  6635	  6636	  6637	  6638	  6639	  6640	  6642	  6643	  6646	  6647	  6648	  6659	  6660
	  6661	  6663	  6671	  6672	  6673	  6674	  6680	  6681	  6682	  6688	  6690	  6706	  6707	  6709
	  6719	  6721	  6723	  6730	  6731	  6735	  6736	  6737	  6738	  6739	  6744	  6745	  6746	  6747
	  6749	  6755	  6756	  6757	  6758	  6760	  6788	  6876	  6880	  6881	  6882	  6883	  6930	  6931
	  6932	  7072	  7075	  7077	  7083	  7086	  7087	  7098	  7302	  7303	  7304	  7309	  7356	  7357
	  7364	  7365	  7383	  7384	  7386	  7387	  7388	  7389	  7390	  7392	  7394	  7395	  7397	  7400
	  7401	  7402	  7403	  7406	  7409	  7410	  7412	  7414	  7416	  7424	  7447	  7452	  7458	  7475
	  7477	  7479	  7480	  7481	  7492	  7509	  7511	  7554	  7555	  7556	  7572	  7574	  7576	  7681
	  7682	  7688	  7689	  7708	  7709	  7715	  7716	  7745	  7746	  7747	  7748	  7749	  7753	  7754
	  7776	  7777	  7792	  7810	  7811	  7812	  7813	  7829	  7847	  7848	  7849	  7851	  7852	  7856
	  7857	  7861	  7862	  7864	  7865	  7978	  7979	  8058	  8059	  8084	  8129	  8130	  8138	  8149
	  8150	  8560	  8563	  8566	  8573	  8574	  8587	  8595	  8599	  8600	  8601	  8602	  8619	  8620
	  8622	  8625	  8626	  8632	  8633	  8671	  8674	  8677	  8684	  8685	  8694	  8695	  8697	  8758
	  8761	  8762	  8765	  9160	  9161	  9168	  9181	  9182	  9186	  9201	  9213	  9223	  9224	  9342
	  9345	  9611	  9612	  9613	  9676	  9680	  9763	  9810	  9814	  9818	  9820	  9828	  9831	  9832
	  9906	  9910	  9924	  9935	  9944	  9947	  9948	  9951	  9952	  9971	  9982	  9983	  9986	  9989
	  9990	  9995	  9996	 10017	 10018	 10019	 10020	 10078	 10083	 10092	 10094	 10097	 10101	 10106
	 10109	 10112	 10177	 10180	 10181	 10182	 10511	 10624	 10626	 10632	 10634	 10635	 10636	 10638
	 10641	 10654	 10663	 10665	 10667	 10679	 10691	 10743	 10746	 10749	 10757	 10760	 10766	 10769
	 10772	 10805	 10808	 10811	 10940	 10941	 10946	 10947
T2POPJ	  9170%	  9170
T3	  1921	  1944	  1955	  1956	  1957	  2025	  2078	  2088	  2089	  2090	  2091	  2093	  2106	  2107
	  2108	  2117	  2219	  2233	  2241	  2248	  2399	  2400	  2404	  2417	  2419	  2420	  2480	  2481
	  2625	  2635	  2640	  2726	  2737	  2739	  2741	  2746	  2747	  2748	  2750	  2770	  2771	  2792
	  2793	  2794	  2796	  3211	  3236	  3237	  3238	  3239	  3240	  3241	  3245	  3448	  3449	  3451
	  3454	  3458	  3473	  3474	  3475	  3485	  3495	  3512	  3573	  3574	  3666	  3667	  3677	  3678
	  3698	  3699	  3723	  3724	  3734	  3741	  3762	  3781	  3782	  3785	  3786	  3916	  3918	  3940
	  3941	  3942	  3943	  3948	  3985	  4003	  4042	  4069	  4147	  4150	  4151	  4152	  4161	  4274
	  4391	  4392	  4396	  4454	  4455	  4468	  4474	  4475	  4491	  4492	  4496	  4502	  4512	  4513
	  4517	  4518	  4533	  4536	  4537	  4538	  4571	  4572	  4573	  4577	  4578	  4583	  4673	  4674
	  4675	  4681	  4682	  4683	  4685	  4686	  4787	  4797	  4798	  4866	  4867	  4868	  4869	  5080
	  5095	  5103	  5131	  5256	  5257	  5284	  5336	  5338	  5339	  5340	  5385	  5386	  5388	  5389
	  5608	  5611	  5614	  5617	  5618	  5620	  5621	  5626	  5631	  5640	  5651	  5653	  5666	  5667
	  5675	  5679	  5681	  5683	  5687	  5691	  5697	  5736	  5737	  5742	  5743	  5744	  5753	  5754
	  5758	  5767	  5768	  5808	  5809	  5813	  5814	  5815	  5830	  5836	  5837	  5838	  5862	  5878
	  5879	  5881	  5882	  5884	  5886	  5887	  5888	  5890	  5891	  5894	  5896	  5897	  5937	  5938
	  5979	  5980	  5981	  5984	  6042	  6043	  6044	  6060	  6061	  6062	  6063	  6064	  6065	  6066
	  6067	  6068	  6069	  6070	  6071	  6072	  6073	  6074	  6075	  6076	  6077	  6078	  6079	  6080
	  6081	  6205	  6206	  6362	  6365	  6369	  6373	  6380	  6385	  6463	  6487	  6502	  6505	  6516
	  6531	  6604	  6619	  6658	  6668	  6669	  6670	  6679	  6687	  6705	  6708	  6713	  6718	  6729
	  6787	  6791	  6850	  6851	  6877	  6878	  6879	  6886	  6887	  6888	  6894	  6895	  6896	  6967
	  6968	  7405	  7407	  7413	  7415	  7506	  7507	  7562	  7563	  7568	  7569	  7570	  7571	  7574
	  7575	  7576	  7602	  7604	  7610	  7628	  7630	  7638	  7653	  7655	  7750	  7751	  7753	  7754
	  7823	  7825	  7826	  7827	  7852	  7853	  7854	  7855	  7858	  7859	  7862	  8568	  8570	  8571
	  8572	  8575	  8634	  8650	  8653	  8666	  8679	  8681	  8682	  8683	  8696	  8697	  8707	  8708
	  8714	  9051	  9057	  9162	  9163	  9189	  9194	  9197	  9198	  9199	  9205	  9206	  9209	  9211
	  9218	  9231	  9232	  9233	  9234	  9235	  9239	  9240	  9241	  9242	  9249	  9254	  9257	  9259
	  9337	  9349	  9350	  9351	  9353	  9354	  9356	  9359	  9362	  9396	  9401	  9428	  9432	  9433
	  9436	  9438	  9441	  9451	  9452	  9458	  9459	  9466	  9511	  9512	  9514	  9515	  9516	  9517
	  9518	  9521	  9760	  9761	  9774	  9788	  9789	  9794	 10098	 10099	 10100	 10102	 10537	 10539
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

	 10544	 10548	 10577	 10578	 10579	 10581	 10621	 10622	 10623	 10806	 10808	 10809	 10933	 10934	 10952
	 10988	 10990	 11033	 11034	 11036	 11037	 11038	 11039	 11041	 11043	 11044
T4	  1219	  1220	  1221	  1222	  1223	  1224	  1225	  1624	  1634	  1655	  1667	  1673	  1683	  1714
	  1788	  1789	  1800	  2008	  2009	  2011	  2012	  2013	  2047	  2075	  2077	  2078	  2079	  2080
	  2225	  2242	  2254	  2298	  2330	  2341	  2342	  2343	  2348	  2352	  2356	  2359	  2392	  2427
	  2428	  2431	  2434	  2435	  2438	  2441	  2442	  2446	  2449	  2450	  2453	  2454	  2455	  2456
	  2457	  2480	  2520	  2656	  2657	  2662	  2673	  2727	  2728	  2734	  2735	  2743	  2745	  2781
	  2791	  2806	  2811	  2836	  2867	  2939	  2944	  3053	  3054	  3055	  3056	  3078	  3254	  3337
	  3338	  3369	  3370	  3372	  3412	  3416	  3417	  3453	  3454	  3455	  3486	  3487	  3488	  3489
	  3490	  3491	  3495	  3496	  3501	  3502	  3503	  3504	  3505	  3506	  3670	  3671	  3674	  3675
	  4207	  4208	  4251	  4252	  4452	  4466	  4467	  4471	  4472	  4542	  4549	  4555	  4560	  4561
	  4563	  4571	  4574	  4575	  4576	  4581	  4582	  4601	  4609	  4611	  4615	  4618	  4623	  4624
	  4628	  4629	  4630	  4636	  4639	  4646	  4649	  4673	  4681	  4684	  4788	  5293	  5628	  5629
	  5631	  5632	  5638	  5652	  5655	  5656	  6189	  6193	  6208	  6479	  6480	  6481	  7378	  7397
	  7498	  7501	  7557	  7573	  7583	  8639	  8640	  8919	  8920	  8945	  8946	  8955	  8969	  8971
	  8973	  8983	 10005	 10006
TABPTR	  2450	  4624	  4772#
TABTMR	   203#	  1833	  6619	  6635	  6640
TABTMS	   232#	   254	  3671	  6621	  6634	  6636
TAKNZJ	   107%	 10680	 10692	 10705
TAKOTJ	   107%	 10655	 10666
TAKTRJ	   107%	  1606	  1642	  1825	  1868	  2068	  5056	  6527	  7097	 10510
TAKTRP	   107%	  1517	  5504	 10953
TATUU1	 10258	 10263#
TATUUO	 10240#
TBFL	  4630	  4739#
TBFL2	  4629	  4744#
TCBALL	   156#
TCNBSD	   150#	  6451	  9890
TCNBSP	   150#	  6435	  9885
TCNCLA	   150#	  6452	  9892
TCNCRD	   150#	  5926	  6400
TCNDEF	   150#	  6439	  9888
TCNDSP	  6502	  6538#	  6603	  6616
TCNECH	   150#	  6432	  9891
TCNERA	   150#	  6438	  9886
TCNFC1	   150#	  6412	  9877	  9972
TCNFC2	   150#	  6413	  9878	  9975
TCNFRM	   150#	  5931	  9869
TCNHDX	   150#	  5925	  6404	  9872
TCNIR	   150#	  6401	  9879
TCNKAT	   150#	  6454	  9894
TCNLCO	   150#	  6441	  9889
TCNLCT	   150#	  5928	  9870
TCNN	   151#	   152	   156	  6499
TCNNFC	   150#	  5927	  9873
TCNNXO	   150#	  6408
TCNOR	   150#	  6402	  9880
TCNPA	   150#	  6405	  9881
TCNPAR	   150#	  6403
TCNPB	   150#	  6406	  9882
TCNPC	   150#	  6407	  9883
TCNPD	   150#	  6434	  9884	  9953
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

TCNPTP	   150#	  5930	  9875	  9876
TCNRTC	   150#	  6453	  9893
TCNRXE	   150#	  6433	  9887
TCNTAB	   150#	  5929	  9868
TCNTYP	   150#	  6455	  9895
TCNWID	   150#	  6411	  9874
TCNXON	   150#	  6431
TCVMAX	  6500	  6570#
TDTUUO	 10129#
THSDAT	    86%
THSTIM	  1099%	  1099	  1100%	  1100	  1220%	  1220	  1222%	  1222	 10971%	 10971
TIHLTN	  2047	  6883	 11188#
TILOW	    53#	 11186	 11193
TIME	    86%
TIMOW	  4845	  4848	  4899	 11150#
TIMRST	 10228%	 10228	 10408%	 10408
TINAS1	 10805#	 10949
TINASS	 10933#
TINDET	 10939	 10943#
TINFIO	   642#	  5052	  5057	 10909
TIOUSE	   643#	  5506	  7132	  9047	  9069	  9691	  9698	 10162
TIRSVD	    49#	  2009	  2962	  4927	  6931	  8737	  8804	  8839	  8844
TIWAIT	  8485	  8657	  8990	  9013	  9029#
TIWAKE	  4978#	  5065	  5507	  7136	 10713
TIWAKN	  4979	  4989#	  9064
TIWKC	    50#	    51	    53	  2225	  2242	  2254	  2298	  2330	  2520	  4208	  4252	  5288	  5293	  5795
	  6922	  8972	  8985	  9083	 10854
TIWRNN	  2013	  3163	  9124	 11186#
TKATT%	  5597#	  5622
TKBSY%	  5598#	  5634
TKEXS%	  5596#	  5615
TKROM%	  5595#	  5646
TMCALL	   193#	  3698
TMCCIE	   191#
TMCCRD	   191#	  6538
TMCECH	   191#	  6547
TMCECO	   191#
TMCECR	   191#	  6710
TMCELF	   191#
TMCESC	   191#
TMCHDX	   191#	  6542
TMCIR	   191#	  6539
TMCKAT	   191#	  6566	  6630	  6634	  6635	  6642
TMCOOR	  1839	 11223#
TMCOR	   191#	  6540
TMCPA	   191#	  6543
TMCPAR	   191#	  6541
TMCPB	   191#	  6544
TMCPC	   191#	  6545
TMCPD	   191#	  6549	  6629	  6636	  6640	  6642
TMCQM	   191#
TMCRXE	   191#	  6548
TMCSIZ	   258#	   502	   503	  2123	  6320	  7251
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

TMCSLP	   255#
TMCTOB	   191#
TMCXON	   191#	  6546
TO11DB	  9520	  9576
TOEMAX	  5357	  8749	 11206#
TOWAIT	  9042#
TOWAT1	  6943	  8496	  8781	  8817	  8829	  9045#
TOWATA	  8796	  8901	  9691#
TPOPJ	    82%	  5009	  5013	  6506	  9125	  9435	  9442	  9738	 10016	 10021	 10242	 10244	 10247	 10250
	 10681	 10683	 10693	 10907	 10928
TPOPJ1	    82%	  5017	  5547	  6510	  9126	  9921	  9922	 10929
TRESCN	  9160#
TRESCU	  5724	  5775#
TRMAUX	  2216#
TRMBYP	   519#	  2085	  3767
TRMTAB	  2086	  2182#
TRPLEN	   589#	   630	 10587	 10790	 10947
TSETBI	  1520	  2716	  2861	  3533	  3822	  3862	  5160#	  5725	  6394	  6946
TSETBO	  2655	  2862	  2876	  3532	  3821	  3861	  5188#	  5726	  6395	  9369	  9679
TSTBO1	  5189	  5193#
TSTBO2	  5203	  5206#
TSTKTJ	   107%	  6937	  8481	  8492	  8769	  8825	  8872	  8899	  8988	  9011
TSTKTP	   107%	  8815
TSTTRJ	   107%
TT2CHK	    45#	 11039	 11044
TTCCLR	  9870	  9872	  9873	  9889	  9903#
TTCDO1	  9905	  9910#
TTCFIL	  9871	  9966#
TTCFIN	  9913#
TTCFL0	  9966	  9971#
TTCFL1	  9970	  9972#
TTCGO	  9907	  9911	  9927	  9956#	  9973	  9976
TTCHKS	    44#	    45	  6928	  6929	 11029	 11036	 11041	 11042
TTCLST	 11027%	 11027	 11033%	 11033
TTCMCA	  9161	  9181	  9186	 11131#
TTCMCH	  9163	  9197	  9211	 11130#
TTCNO	  9867	  9898#
TTCSET	  9868	  9869	  9875	  9876	  9885	  9886	  9887	  9888	  9890	  9891	  9893	  9894	  9904#
TTCSIX	  9892	  9933#
TTCTYP	  9895	  9942#
TTCVAL	  9874	  9877	  9878	  9879	  9880	  9881	  9882	  9883	  9884	  9918#
TTCVL0	  9919	  9924#
TTCVL1	  9923	  9925#
TTCVL2	  9926#	  9938	  9950
TTCVL3	  9927#	  9954
TTCWDD	  9831	  9867#	  9904	  9926
TTCWDN	  9827	  9864#	  9865
TTCWDT	  9828	  9835#	  9864
TTFORC	  2164	  2847	  5016	  9143#	  9623	 11022
TTFREE	  2463%	  2463	  5032%	  5032	  5034%	  5034	  5039%	  5039	  5118%	  5118	  5122%	  5122	  5141%	  5141
	  5142%	  5142	  5150%	  5150	  5153%	  5153	 11030%	 11030
TTFREN	  2008	  2961	  4926	  5035	  5125	  5143	  5156	  6930	  8736	  8803	  8838	  8843	 11034	 11035
	 11040	 11124#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

TTGC1	  5090	  5100#
TTGETC	  2777	  4037	  4064	  4144	  5080#	  6038	  6203	  8561	  8672	  9184	  9343
TTIEND	 11049#
TTINI2	 10979#	 11024
TTINI3	 10991	 10994	 11024#
TTINI4	 11041#	 11045
TTKJOB	  5512%	  5512
TTNCHR	   594#
TTNESC	   593#
TTNLIN	   595#
TTNYLB	   596#
TTOUT1	  5319	  5322#
TTOUT2	  5330#	  5343
TTOUT3	  5331	  5334	  5336#
TTOUT4	  5340	  5343#
TTOUT5	  5323	  5344#
TTPC1	  5113	  5131#
TTPC2	  5117	  5130#
TTPUTC	  2018	  2467	  5111#	  8764
TTSCL1	 10763	 10773#
TTSCL2	 10752#	 10776
TTSCL3	 10754	 10774#
TTSCLR	 10741#
TTTCL1	 10783#	 10798
TTTCL2	 10796#
TTTCLR	 10779#
TTUUOT	  5666	  5716#
TTVIN2	    94%	  9609
TTVINI	    94%	 10990
TTYAT1	 10198	 10217#	 11015
TTYAT2	 10220	 10223#
TTYATC	  1905	  5007	  5473	  6344	  7051	  7076	  8504	  8784	  8793	  8862	  8891	  9019	 10076	 10164
	 10225	 10483	 10493	 10582	 10610
TTYATI	  2161	  9620	 10213#
TTYATT	 10194#	 10249
TTYBMT	  1375#	  1432	  1455	  1458	  1460	  1463	  1465	  1467	  1469	  1471	  1474	  1476	  1479	  1482
	  1487	  1490	  1498
TTYBNP	  1627#	  1658
TTYBPN	  1396#
TTYCMR	  9284#
TTYDET	 10135	 10139#
TTYERP	  9663#
TTYFLK	 10566	 11143#
TTYFLM	  5040#
TTYFND	  9634#	 10172
TTYFNU	  5372	  5665	  6007	  9633#	  9686
TTYFUW	  9686#
TTYFW1	  9687#	 10174
TTYHLT	  9307#
TTYIN	  5225	  5231#
TTYIN1	  5254#	  5259
TTYIN3	  5255	  5260#
TTYIN5	  5241#	  5273
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

TTYIN6	  5265	  5270#
TTYIN8	  5266#	  5272
TTYINI	  5220	 10966	 10968#
TTYINX	  5234	  5267#
TTYKD1	 10110#	 10112
TTYKDB	  6253	  7047	  7134	 10063	 10070	 10074#	 10166
TTYKIL	 10050#
TTYLOS	  1814	 11209	 11211#
TTYLST	   609#	 11011
TTYMXL	  9865#
TTYNAM	  9758#
TTYNFB	  8121#	  8127
TTYNFR	 10604#
TTYNNC	  5101#
TTYNPB	  3367	  3384#
TTYOUS	  5311	  5362#
TTYOUT	  5224	  5309#	  5313
TTYOUW	   639#	  4130	  4976	  5063	  8874	  9029	  9045	  9691	  9702
TTYPH2	  9729	  9740#
TTYPH3	  9732	  9737#
TTYPH4	  9728#	  9735
TTYPHY	  9718#	  9750
TTYPTY	  2958#	  2985
TTYRES	  5550#
TTYRHT	  2060	 11196#
TTYRS1	  5555	  5566#	  5570	  5573
TTYSET	  5783#
TTYSOW	  9702#
TTYSRC	  9634	  9652#	  9663	 10129	 10196	 10214	 10241	 10604
TTYSTC	  9288#	 10261
TTYSTR	  9292#
TTYSZS	  5251	  5300#	  5329
TTYTAB	    85%	  5525	  5550	  5617	  6334	  7068	  7072	  7073	  7360	  7455	  9653	 10001	 10058	 10231
	 10393	 10466	 10613	 10728	 10918	 10937
TTYTBL	  9836#
TTYUS0	  9265	  9271#
TTYUS1	  9273	  9276#
TTYUSM	  9270#
TTYUSR	  9264#
TTYUSW	  9263#
TTYUU1	  5668	  5671	  5675#
TTYUU2	  5676	  5679#
TTYUU3	  5684	  5687#
TTYUUO	  5396	  5665#	  5686
TTYWAK	 10708#
TTYWK1	 10711	 10723#	 10751	 10775	 10782	 10797
TTYWK2	 10712#	 10722
TTYWK3	 10716	 10719#
TTYYLS	 10901#
TTYZAP	  2151	  2170	  5472	  5489	  7103	  7115	  7124	  7144	  7198	  7235	  7484	 10050	 10069	 10147
	 10177#
TTYZNE	  1618#
TUUAIR	  5679	  5687	  5703#	  5711	  5712	  5718	  5721	  5727	  5728	  6369	  6388	  6389	  6390	  6396
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

	  6417	  6418	  6425	  6427	  6428
TUUATI	  5675	  5681	  5700#	  5715	  5716	  5720
TUUATO	  5667	  5681	  5701#	  5717	  5719	  5723	  5729	  5730	  5731
TUUATR	  5679	  5702#	  5724	  5725	  5726
TUUEAT	  5691	  5705#	  5712	  5715	  5716	  5718	  5720	  5721	  5727	  5728	  6373	  6388	  6389	  6390
	  6396	  6417	  6418	  6424	  6425	  6426	  6427	  6428
TUUFXI	  5706#	  5712	  5715	  5716	  5718	  5720	  5721	  5727	  5728	  6396	  6397	  6424	  6425	  6426
	  6427	  6428
TUUIMI	  5707#	  6380	  6388	  6389	  6390
TUUROM	  5683	  5704#	  5717	  5719	  5729	  5730	  5731	  6365	  6391	  6392	  6393	  6429	  6430	  6443
TWABT	  9012	  9015	  9027#
TWAITC	  5379	  5715	  5989	  6847	  9000#	  9024
TWAITL	  5237	  5960	  5972	  6867	  8962#	  8993
TWAITS	  5951	  6860	  8996#
TWTC1	  9009	  9013#
TWTC2	  9018	  9024#
TWTL1	  8976	  8983#
TWTL2	  8981	  8983	  8986	  8990#
TWTL3	  8982	  8987#
TWTSPC	   640#	  4923	  5552	  6934	  8739	  8827
TYCIOS	 10151#
TYI	  5254	  5383	  5953	  5961	  5973	  5990	  6848	  6862	  6868	  8555#	  8660
TYI940	  8600	  8601	  8611#
TYIALT	  8604	  8632#
TYIATB	  8574	  8578#
TYIBRK	  8605	  8611	  8614	  8622#	  8628	  8631	  8635	  8638	  8641	  8643	  8655
TYIBSP	  8609	  8617	  8625#
TYIC	  8582	  8586#	  8621	  8627
TYICC	  8603	  8612	  8613	  8644#
TYICCP	  8615	  8642#
TYICZ	  8606	  8637#
TYID	  8589#	  8691	  8699
TYIEAT	  5692	  6374	  8555	  8664#	  8884	  9296
TYIET2	  8670	  8711#
TYIET3	  8690	  8698	  8702	  8703	  8704	  8705	  8706	  8710#
TYIL	  8668#	  8680	  8686	  8689	  8692	  8700
TYIOS1	 10155#	 10161	 10167
TYIOS2	 10153	 10157#
TYIPAL	  8607	  8630#
TYIPDP	  8599	  8602	  8603#
TYIRPT	  8574#	  8623
TYITAB	  8608	  8616	  8619#
TYMTC	  6538	  6539	  6540	  6541	  6542	  6543	  6544	  6545	  6546	  6547	  6548	  6549	  6566	  6616#
TYMTC1	  6617#	  6711
TYMTC2	  6632	  6645#
TYO	  5341	  5745	  5769	  5810	  5831	  8736#	  8775	  8783
TYO1	  8738	  8743#
TYO2	  8747	  8751#
TYO3	  8759	  8764#
TYOW	  8750	  8768#	  8787
TYOW1	  8773	  8777#
TYOW2	  8741	  8778#
TYOW3	  8777	  8781#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

TYOW4	  8782#
TYP.00	  1432#
TYPANS	   669#	  1383	  1434#	  9984
TYPAUX	   687#	  1440#
TYPAXC	   738#	  1458#	  7299
TYPBIN	   780#	  1482#	  3929
TYPBKO	   774#	  1479#	  3961
TYPBOC	   777#	  1481#
TYPBRK	   807#	  1494#
TYPCLP	   768#	  1261	  1476#
TYPCLR	   771#	  1393	  1478#
TYPEAD	   813#	  1496#
TYPECF	   753#	  1467#	  3707
TYPECN	   750#	  1465#	  3704
TYPEDC	   702#	  1445#
TYPETM	   723#	  1452#
TYPGOB	   696#	  1443#	  3692
TYPGRN	   708#	  1447#	  4108
TYPHNG	   720#	  1451#	  3712
TYPHSI	   765#	  1266	  1474#
TYPIHR	   795#	  1489#
TYPINB	   783#	  1484#
TYPINE	   786#	  1485#
TYPINT	   789#	  1486#
TYPIRQ	   792#	  1487#	  4025
TYPKAF	   819#	  1498#
TYPLAD	   816#	  1497#
TYPLDC	   705#	  1446#
TYPLOG	   684#	  1439#
TYPLOS	   729#	  1454#
TYPLTM	   726#	  1453#
TYPNEG	   804#	  1493#	  1757
TYPNOP	   690#	  1441#	  3775
TYPNSP	   681#	  1389	  1438#
TYPOHR	   801#	  1492#
TYPORG	   717#	  1450#	  4110
TYPORQ	   798#	  1490#	  4020
TYPOUP	   693#	  1442#	  3756
TYPPSR	   810#	  1495#
TYPRAK	   678#	  1259	  1387	  1437#
TYPRED	   711#	  1448#	  3687
TYPRES	   675#	  1386	  1436#
TYPSAD	   747#	  1463#	 10024
TYPSHT	   672#	  1384	  1435#	  9981
TYPSUP	   732#	  1455#	  7288
TYPSUR	   735#	  1390	  1457#
TYPTCP	   759#	  1471#	  3697
TYPTCR	   762#	  1473#
TYPTCS	   756#	  1469#	  3669
TYPTRN	  1376	  1431#	  1502
TYPTSP	   741#	  1460#
TYPTSR	   744#	  1392	  1462#
TYPYEL	   714#	  1449#	  4103
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

TYPZAP	   699#	  1444#	  3829
U	   203	   204	   205	   206	   207	   208	   209	   210	   211	   212	   213	   214	   215	   216
	   217	   218	   219	   220	   221	   222	   232	   233	   234	   235	   236	   237	   238	   239
	   240	   241	   242	   243	   244	   245	   246	   247	   248	   249	   250	   251	   303	   304
	   305	   306	   307	   308	   309	   310	   311	   312	   313	   314	   315	   316	   317	   318
	   319	   320	   321	   322	   323	   324	   325	   519	   521	   522	   524	   525	   526	   527
	   528	   529	   531	   533	   535	   536	   538	   539	   540	   541	   542	   543	   544	   546
	   547	   548	   549	   550	   551	   552	   553	   554	   555	   557	   558	   559	   560	   561
	   562	  1367	  1368	  1370	  1371	  1395	  1505	  1512	  1519	  1526	  1527	  1532	  1534	  1539
	  1544	  1550	  1555	  1559	  1562	  1563	  1567	  1568	  1572	  1579	  1586	  1588	  1601	  1602
	  1608	  1612	  1617	  1633	  1640	  1648	  1687	  1690	  1704	  1708	  1717	  1718	  1723	  1733
	  1735	  1736	  1740	  1743	  1819	  1820	  1862	  1864	  1865	  1873	  1878	  1883	  1885	  1886
	  1887	  1891	  1893	  1896	  1897	  1899	  1901	  1903	  1916	  1934	  1950	  2011	  2012	  2016
	  2019	  2020	  2022	  2029	  2032	  2037	  2038	  2039	  2040	  2041	  2042	  2043	  2044	  2045
	  2051	  2062	  2063	  2071	  2075	  2079	  2090	  2094	  2101	  2108	  2109	  2111	  2112	  2113
	  2115	  2117	  2124	  2135	  2137	  2141	  2142	  2146	  2149	  2227	  2258	  2259	  2272	  2273
	  2274	  2282	  2283	  2291	  2306	  2312	  2314	  2321	  2322	  2323	  2334	  2335	  2344	  2347
	  2390	  2395	  2397	  2400	  2401	  2411	  2415	  2419	  2424	  2428	  2429	  2435	  2436	  2442
	  2443	  2447	  2465	  2468	  2469	  2473	  2474	  2475	  2484	  2494	  2495	  2508	  2509	  2510
	  2518	  2519	  2528	  2529	  2546	  2547	  2548	  2605	  2614	  2619	  2631	  2647	  2654	  2658
	  2661	  2663	  2687	  2689	  2690	  2692	  2694	  2696	  2698	  2699	  2700	  2703	  2706	  2707
	  2710	  2713	  2714	  2719	  2727	  2734	  2745	  2756	  2767	  2770	  2772	  2773	  2779	  2780
	  2783	  2784	  2785	  2786	  2787	  2788	  2800	  2806	  2809	  2811	  2832	  2844	  2853	  2857
	  2864	  2865	  2875	  2881	  2937	  2940	  2942	  2943	  2946	  2947	  2957	  2960	  2971	  2984
	  2987	  2998	  3001	  3009	  3021	  3026	  3035	  3045	  3050	  3079	  3080	  3152	  3155	  3164
	  3165	  3170	  3176	  3183	  3201	  3222	  3224	  3228	  3231	  3233	  3249	  3259	  3260	  3284
	  3286	  3288	  3300	  3309	  3311	  3318	  3323	  3325	  3327	  3332	  3333	  3340	  3347	  3349
	  3351	  3361	  3363	  3364	  3379	  3382	  3394	  3396	  3398	  3410	  3415	  3419	  3422	  3436
	  3439	  3441	  3444	  3451	  3461	  3468	  3481	  3526	  3527	  3529	  3531	  3535	  3536	  3538
	  3540	  3542	  3550	  3554	  3555	  3666	  3676	  3682	  3705	  3730	  3731	  3750	  3755	  3761
	  3769	  3774	  3782	  3783	  3785	  3791	  3792	  3796	  3807	  3808	  3818	  3820	  3823	  3826
	  3827	  3828	  3838	  3849	  3850	  3858	  3860	  3863	  3866	  3867	  3868	  3893	  3894	  3895
	  3896	  3897	  3899	  3900	  3901	  3916	  3940	  3943	  3959	  4019	  4032	  4036	  4039	  4042
	  4045	  4050	  4051	  4053	  4059	  4063	  4066	  4069	  4072	  4078	  4087	  4088	  4100	  4102
	  4112	  4119	  4124	  4126	  4136	  4139	  4143	  4146	  4161	  4166	  4207	  4211	  4222	  4223
	  4237	  4247	  4251	  4255	  4260	  4264	  4269	  4280	  4286	  4294	  4299	  4307	  4312	  4318
	  4323	  4379	  4385	  4392	  4393	  4400	  4416	  4422	  4436	  4437	  4446	  4447	  4465	  4474
	  4487	  4490	  4492	  4495	  4501	  4512	  4514	  4534	  4556	  4574	  4610	  4621	  4634	  4644
	  4658	  4684	  4785	  4851	  4852	  4853	  4854	  4862	  4871	  4882	  4884	  4885	  4893	  4900
	  4903	  4905	  4912	  4914	  4916	  4918	  4944	  4952	  4961	  4971	  4972	  4993	  5002	  5005
	  5046	  5049	  5060	  5161	  5163	  5165	  5167	  5168	  5169	  5170	  5171	  5172	  5173	  5174
	  5175	  5176	  5177	  5178	  5180	  5181	  5183	  5188	  5193	  5194	  5195	  5196	  5197	  5202
	  5204	  5208	  5209	  5233	  5239	  5248	  5249	  5271	  5275	  5296	  5311	  5321	  5322	  5333
	  5334	  5350	  5355	  5356	  5381	  5447	  5449	  5460	  5466	  5468	  5469	  5471	  5487	  5488
	  5527	  5554	  5555	  5556	  5560	  5639	  5640	  5648	  5660	  5671	  5674	  5680	  5688	  5749
	  5776	  5780	  5781	  5785	  5787	  5792	  5793	  5797	  5798	  5799	  5819	  5847	  5854	  5876
	  5881	  5886	  5888	  5893	  5894	  5895	  5896	  5968	  5996	  6001	  6002	  6003	  6004	  6006
	  6008	  6009	  6016	  6028	  6033	  6034	  6037	  6048	  6052	  6088	  6100	  6105	  6107	  6114
	  6120	  6121	  6123	  6142	  6146	  6161	  6163	  6172	  6174	  6176	  6177	  6178	  6188	  6189
	  6192	  6193	  6214	  6217	  6223	  6226	  6244	  6254	  6255	  6256	  6287	  6288	  6289	  6295
	  6296	  6310	  6313	  6314	  6315	  6318	  6320	  6323	  6325	  6326	  6357	  6358	  6370	  6383
	  6469	  6470	  6472	  6474	  6481	  6488	  6509	  6515	  6517	  6522	  6523	  6530	  6643	  6648
	  6652	  6689	  6693	  6694	  6699	  6766	  6767	  6769	  6775	  6797	  6809	  6812	  6814	  6834
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

	  6856	  6857	  6881	  6882	  6893	  6910	  6911	  6916	  6947	  6951	  6953	  6955	  6999	  7001	  7003
	  7054	  7056	  7085	  7087	  7094	  7104	  7105	  7113	  7117	  7122	  7123	  7126	  7127	  7128
	  7130	  7143	  7197	  7207	  7212	  7241	  7243	  7246	  7247	  7248	  7249	  7252	  7256	  7258
	  7260	  7261	  7362	  7363	  7365	  7368	  7371	  7372	  7465	  7468	  7469	  7483	  7503	  7504
	  7520	  7521	  7532	  7533	  7564	  7569	  7570	  7600	  7602	  7620	  7625	  7628	  7641	  7644
	  7647	  7653	  7662	  7671	  7677	  7681	  7704	  7708	  7730	  7776	  7826	  7832	  7836	  7840
	  7887	  7918	  7919	  7955	  7956	  8000	  8007	  8013	  8015	  8021	  8023	  8026	  8034	  8036
	  8049	  8052	  8053	  8058	  8070	  8072	  8077	  8428	  8430	  8435	  8436	  8437	  8438	  8442
	  8502	  8503	  8510	  8513	  8516	  8528	  8530	  8533	  8538	  8541	  8544	  8551	  8556	  8557
	  8560	  8563	  8564	  8565	  8567	  8581	  8583	  8586	  8589	  8592	  8620	  8626	  8630	  8633
	  8637	  8642	  8644	  8654	  8660	  8664	  8668	  8669	  8671	  8674	  8675	  8676	  8678	  8696
	  8697	  8710	  8712	  8715	  8743	  8744	  8748	  8752	  8753	  8758	  8761	  8762	  8763	  8765
	  8766	  8777	  8780	  8782	  8783	  8791	  8792	  8801	  8806	  8807	  8841	  8847	  8848	  8860
	  8861	  8868	  8881	  8882	  8889	  8890	  8897	  8906	  8910	  8911	  8912	  8925	  8929	  8946
	  8947	  8949	  8950	  8960	  8965	  8967	  8968	  8969	  8970	  8971	  8975	  8977	  8980	  8984
	  8993	  9003	  9005	  9006	  9008	  9018	  9034	  9038	  9042	  9077	  9081	  9082	  9090	  9094
	  9095	  9107	  9115	  9122	  9123	  9136	  9139	  9146	  9160	  9174	  9182	  9203	  9248	  9253
	  9258	  9271	  9272	  9277	  9285	  9288	  9292	  9293	  9294	  9297	  9309	  9313	  9324	  9342
	  9345	  9366	  9397	  9398	  9400	  9406	  9407	  9595	  9607	  9608	  9609	  9612	  9613	  9616
	  9655	  9665	  9668	  9669	  9674	  9677	  9682	  9688	  9710	  9720	  9721	  9727	  9733	  9734
	  9742	  9744	  9745	  9781	  9782	  9783	  9793	  9796	  9956	  9957	  9958	  9962	 10003	 10004
	 10006	 10062	 10063	 10068	 10131	 10133	 10139	 10145	 10146	 10173	 10179	 10182	 10184	 10186
	 10194	 10198	 10199	 10213	 10217	 10219	 10224	 10243	 10244	 10246	 10264	 10370	 10371	 10377
	 10396	 10397	 10432	 10437	 10482	 10529	 10531	 10532	 10534	 10538	 10542	 10647	 10650	 10651
	 10659	 10662	 10671	 10674	 10675	 10689	 10701	 10702	 10714	 10715	 10716	 10718	 10719	 10761
	 10762	 10763	 10773	 10810	 10817	 10818	 10824	 10825	 10827	 10839	 10840	 10842	 10843	 10849
	 10850	 10852	 10853	 10856	 10857	 10858	 10866	 10872	 10873	 10875	 10877	 10879	 10895	 10901
	 10902	 10906	 10979	 10980	 10981	 10982	 10983	 10986	 10996	 10997	 11002	 11014
UPARPT	  2677	  2678	  4700#
UPASC	  4700	  4701#
UPDKEY	  1089#
UPOPJ	  3232	  3249#	  9409
UPSHUT	  1298	  1302	  9985	 11135#
UPTIME	    85%	  1097%	  1097	  1219
USRWAK	  2239	  2256	  2333	  4254	  4881	  4944#
USRWK1	  4945	  4951	  4953	  4970#
UUOLDB	  5565	  5682	  6364	  7091	  8792	  8886	  8907	  8910#	  9275	 10552
VTFLP	  2431	  4646	  4715#
W	  1295	  2966	  2991	  3014	  3057	  3068	  3620	  3636	  3741	  3742	  4496	  4497	  4502	  4503
	  4518	  4519	  4566	  4567	  4583	  4584	  4675	  4676	  5395	  5666	  5806	  5807	  5808	  5813
	  5815	  5816	  5828	  5829	  5830	  5836	  5838	  5844	  5858	  5859	  5862	  6353	  6359	  7008
	  7467	  7475	  7493	  7511	  7583	  9053	  9055
WATLIN	  3044#	  3302	  3342	  3528	  3658	  3793	  4114	  4140	  4212	  4256
WRDOT2	  3636#	  4012	 10032
WRDOUT	  1303	  1774	  3620#	  3679	  3725	  3834	  7294
WRPCH2	   862#	  3672
WRPCHR	   861#	  1277	  1772	  3670	  3699	  7307
WRPLIN	   860#	  1275	  3678	  3724	  3831	  3984	  7290	  7301
WSCHED	   100%	  5332	  7446	  7933	  9804
WSYNC	    84%	  9066	  9695
WSYNC1	  9060	  9067#
WSYNC2	  9062	  9066#
WSYNCS	  8878	  9039	  9047#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

WTCHK	  3301	  4113	  4119#	  4138
XA	   615
XMTWAK	  1745	  3027	  3046	  4077	  4091	  4930	  5046#
XMTWK1	  5053	  5062#
XPNOUT	  5342	  5353#	  5746	  5770
XXCBLK	 10087	 10119#
XXCDDB	 10081	 10117#
XXCSER	 10085	 10118#
XXNBLK	 10091	 10122#
XXNDDB	 10082	 10120#
XXNSER	 10089	 10121#
XXPBLK	 10095	 10125#
XXPDDB	 10083	 10123#
XXPSER	 10093	 10124#
XXQ	  4762#	  4762	  4770	  4770#	  4771
XXXQ	  4730#	  4730	  4731#	  4731	  4732#	  4732	  4735#	  4735	  4736#	  4736	  4737#	  4737	  4740#	  4740
	  4741#	  4741	  4742#	  4742	  4745#	  4745	  4746#	  4746	  4747#	  4747
XXXR	  4730#	  4730	  4731#	  4731	  4732	  4732#	  4733	  4735#	  4735	  4736#	  4736	  4737	  4737#	  4738
	  4740#	  4740	  4741#	  4741	  4742#	  4742	  4745#	  4745	  4746#	  4746	  4747	  4747#	  4748
YELLOW	  1449	  1591#
YELLW1	  1603	  1605	  1610#
YLBUG	    70#	  1592
ZAPAL1	  7527#	  7531	  7533	  7536
ZAPALL	  7516	  7525#
ZAPAUX	  1902	  1907	  7113#
ZAPBG1	  3902#
ZAPBUG	  1542	  1876	  3888#	  7210
ZAPCIR	  7516#
ZAPDFR	  1560	  1615#
ZAPLOG	  1546	  1616#	  7214
ZAPLPT	  1617	 11215#
ZBGBIT	  3878#
ZBGBUG	  3872#	  3890
ZBGBYT	  3879#
ZBGDCH	  3875#
ZBGDCX	  3881#
ZBGDDB	  3876#
ZBGLIN	  3874#
ZBGLOG	  3882#
ZBGMOD	  3880#
ZBGOUT	  3877#
ZRPCNT	  7108	 11163#
ZZ	  5246#	  5246	  5257#	  5257	  5262#	  5262	  5300#	  5300	  5327#	  5327	  5336#	  5336	  5376#	  5376
	  5386#	  5386	  5389#	  5389	  5394#	  5394	  5651#	  5651	  5737#	  5737	  5754#	  5754	  5767#	  5767
	  5806#	  5806	  5808#	  5808	  5816#	  5816	  5826#	  5826	  5828#	  5828	  5830#	  5830	  5843#	  5843
	  5844#	  5844	  5856#	  5856	  5858#	  5858	  5862#	  5862	  5872#	  5872	  5901#	  5901	  5904#	  5904
	  5934#	  5934	  5981#	  5981	  5998#	  5998	  6044#	  6044	  6056#	  6056	  6082#	  6082	  6261#	  6261
	  6264#	  6264	  6353#	  6353	  6359#	  6359	  6459#	  6459	  6460#	  6460	  6463#	  6463	  6476#	  6476
	  6483#	  6483	  6487#	  6487	  6736#	  6736	  6745#	  6745	  6756#	  6756	  6772#	  6772	  6781#	  6781
	  6788#	  6788	  6791#	  6791	  6832#	  6832	  6838#	  6838	  6851#	  6851	  6873#	  6873	  6877#	  6877
	  6886#	  6886	  6894#	  6894	  6921#	  6921	  6961#	  6961	  6967#	  6967	  6978#	  6978	  7008#	  7008
	  7090#	  7090	  7386#	  7386	  7467#	  7467	  7475#	  7475	  7493#	  7493	  7507#	  7507	  7510#	  7510
	  7511#	  7511	  7554#	  7554	  7574#	  7574	  7576#	  7576	  7583#	  7583	  7754#	  7754	  7810#	  7810
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

	  7847#	  7847	  7858#	  7858	  7862#	  7862	  9788#	  9788	  9794#	  9794	 10324#	 10324	 10325#	 10325	 10385#
	 10385	 10518#	 10518
ZZ0	 10586#	 10590	 10591	 10591#	 10592	 10592#	 10789#	 10793	 10794	 10794#	 10795	 10795#
ZZ1	  5246#	  5246	  5257#	  5257	  5262#	  5262	  5300#	  5300	  5327#	  5327	  5336#	  5336	  5376#	  5376
	  5386#	  5386	  5389#	  5389	  5394#	  5394	  5651#	  5651	  5737#	  5737	  5754#	  5754	  5767#	  5767
	  5806#	  5806	  5808#	  5808	  5816#	  5816	  5826#	  5826	  5828#	  5828	  5830#	  5830	  5843#	  5843
	  5844#	  5844	  5856#	  5856	  5858#	  5858	  5862#	  5862	  5872#	  5872	  5901#	  5901	  5904#	  5904
	  5934#	  5934	  5981#	  5981	  5998#	  5998	  6044#	  6044	  6056#	  6056	  6082#	  6082	  6261#	  6261
	  6264#	  6264	  6353#	  6353	  6359#	  6359	  6459#	  6459	  6460#	  6460	  6463#	  6463	  6476#	  6476
	  6483#	  6483	  6487#	  6487	  6736#	  6736	  6745#	  6745	  6756#	  6756	  6772#	  6772	  6781#	  6781
	  6788#	  6788	  6791#	  6791	  6832#	  6832	  6838#	  6838	  6851#	  6851	  6873#	  6873	  6877#	  6877
	  6886#	  6886	  6894#	  6894	  6921#	  6921	  6961#	  6961	  6967#	  6967	  6978#	  6978	  7008#	  7008
	  7090#	  7090	  7386#	  7386	  7467#	  7467	  7475#	  7475	  7493#	  7493	  7507#	  7507	  7510#	  7510
	  7511#	  7511	  7554#	  7554	  7574#	  7574	  7576#	  7576	  7583#	  7583	  7754#	  7754	  7810#	  7810
	  7847#	  7847	  7858#	  7858	  7862#	  7862	  9788#	  9788	  9794#	  9794	 10324#	 10324	 10325#	 10325
	 10385#	 10385	 10518#	 10518
ZZBIT	   568#	   576	   576#	   577	   577#	   578	   578#	   579	   579#	   580	   580#	   581	   581#	   582
	   582#	   583	   583#	   584	   584#	   585	   585#	   586	   586#	   587	   587#
ZZN	   145#	   150	   150#	   151	   187#	   191	   191#	   294#	   303	   304	   304#	   305	   305#	   306
	   306#	   307	   307#	   308	   308#	   309	   309#	   310	   310#	   311	   311#	   312	   312#	   313
	   313#	   314	   314#	   315	   315#	   316	   316#	   317	   317#	   318	   318#	   319	   319#	   320
	   320#	   321	   321#	   322	   322#	   323	   323#	   324	   324#	   325	   325#	   326	   326#	   508#
	   512	   512#	  2122#	  2124	  2125	  2125#	  6319#	  6320	  6321	  6321#	  7250#	  7252	  7253	  7253#
ZZPOS	   197#	   203	   203#	   204	   204#	   205	   205#	   206	   206#	   207	   207#	   208	   208#	   209
	   209#	   210	   210#	   211	   211#	   212	   212#	   213	   213#	   214	   214#	   215	   215#	   216
	   216#	   217	   217#	   218	   218#	   219	   219#	   220	   220#	   221	   221#	   222	   222#	   226#
	   232	   232#	   233	   233#	   234	   234#	   235	   235#	   236	   236#	   237	   237#	   238	   238#
	   239	   239#	   240	   240#	   241	   241#	   242	   242#	   243	   243#	   244	   244#	   245	   245#
	   246	   246#	   247	   247#	   248	   248#	   249	   249#	   250	   250#	   251	   251#
ZZWORD	   196#	   203	   204	   205	   206	   207	   208	   209	   210	   211	   212	   213	   214	   215
	   216	   217	   218	   219	   220	   221	   222	   225#	   232	   233	   234	   235	   236	   237
	   238	   239	   240	   241	   242	   243	   244	   245	   246	   247	   248	   249	   250	   251
	   258	   567#	   576	   577	   578	   579	   580	   581	   582	   582#	   583	   584	   585	   586
	   587
%CHBRK	  5258	  5975	  8581#	  8587	  8622
%CHRMX	    60#	  2990	  3167
%FRAUX	  6903#	  6913
%FRBIG	  6904#	  6924
%FRBRK	  6906#	  6979
%FRCMD	  6905#	  6918
%FRFUL	  6908#
%FRNBK	  6907#	  6987
%FROK	  6902#	  6992
%PBTIM	    66#	  3247	  3380
..	  4911#	 11207#	 11208	 11209	 11210	 11240#	 11240	 11245
.ARATT	 10347
.ARDET	 10330
.ARHNG	  5424
.ASIDL	  7018#
.ASLOG	  7025#	  7169
.ASRQ1	  7019#	  7145	  7192
.ASRQ2	  7021#
.ASWPT	  7026#	  7216	  7222
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Symbol cross reference

.ASWR1	  7020#
.ASWR2	  7024#
.ASWTP	  7027#
.CPDWD	  9415%	  9415
.DTCTO	  9517
.DTESP	  9559
.DTRSW	  9565
.PVHCN	  5498
.RTMCO	 10308#
.RTMCU	 10307#
.RTMSV	 10306#
.RTMUS	 10309#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Macro/Opdef cross reference

CHRATR	   870#	   885	   886	   887	   888	   891	   892	   893	   894	   895	   896	   897	   898	   899
	   900	   901	   902	   903	   904	   907	   908	   909	   910	   913	   914	   915	   916	   917
	   918	   919	   920	   921	   922	   927	   928	   929	   930	   931	   932	   933	   934	   935
	   936	   937	   938	   939	   940	   941	   942	   945	   946	   947	   948	   949	   950	   951
	   952	   953	   954	   957	   958	   959	   960	   961	   962	   963	   968	   969	   970	   971
	   972	   973	   974	   975	   976	   977	   978	   979	   980	   981	   982	   983	   984	   985
	   986	   987	   988	   989	   990	   991	   992	   993	   996	   997	   998	   999	  1000	  1001
	  1006	  1007	  1008	  1009	  1010	  1011	  1012	  1013	  1014	  1015	  1016	  1017	  1018	  1019
	  1020	  1021	  1022	  1023	  1024	  1025	  1026	  1027	  1028	  1029	  1030	  1031	  1034	  1035
	  1036	  1037	  1038
CSHREF	  4955	  4963
CSHUNL	  3924
CSHVAL	  3954
FILLP	  4718#	  4730	  4731	  4732	  4735	  4736	  4737	  4740	  4741	  4742	  4745	  4746	  4747
GENFL	  4752#	  4762
GTLNK	 11207
IFCPU	  1254	  1319	  1333	  1750	  3917	  3928	  3947	  4008	  4806	  4949	  7350	  7351	  7822	  7863
	  7925	  7964	  8368	  9328	  9329	  9330	  9475	  9485	  9510	 11051
IFKMC	   822	  1268	  1281	  1306	  1315	  1344	  1927	  3991	  4823	  7427	  7756	  7867	  8093	  8142
	  8155	  8403	  8447	 11018	 11095
IFNCPU	  1746	  4004	  7940	  7967	  8385
IFNKMC	   834	  1300	  4002	  7367	  7752	  7860	  8387	  8446
LMOD	  2886#	  2888	  2889	  2890	  2891	  2892	  2893	  2894	  2895	  2896	  2897	  2898	  2899	  2900
	  2901	  2902	  2903	  2904	  2905	  2906	  2907	  2908	  2909	  2910	  2911	  2912	  2913	  2914
	  2915	  2916	  2917	  2918	  2919
ND	  4807
NOCHAR	  5235	  5314	  5375	  5738	  5755	  5765	  5805	  5825	  5853	  5948	  5957	  5967	  5988	  6032
	  6846	  6855	  6866	  7736	  7839	  7924
OUTBIT	   267#	   303	  3091	  3116
PFALL	  2058	  2338	  2950	  2992	  3581	  3713	  3735	  4387	  5478	  6126	  6993	  7224	  7233	  7666
	  7980	  8061	  8907	  9111	  9402	  9418	 10070	 10135	 10486
PJRST	  1170	  1428	  1520	  1619	  1649	  1692	  1699	  1745	  1825	  1902	  1907	  2164	  2170	  2176
	  2353	  2432	  2439	  2451	  2460	  2664	  2674	  2688	  2716	  2847	  2868	  2980	  3294	  3304
	  3313	  3320	  4012	  5065	  5184	  5268	  5390	  5759	  5801	  5834	  6108	  6153	  6154	  6348
	  6751	  6762	  6799	  6805	  6817	  6823	  6940	  7091	  7099	  7134	  7136	  7203	  7326	  7344
	  7347	  7645	  7654	  7672	  7727	  7815	  7850	  8016	  8024	  8143	  8431	  8486	  8548	  8786
	  8829	  8886	  8900	  8957	  8961	  9178	  9266	  9295	  9300	  9314	  9338	  9602	  9621	 10147
	 10278	 10552	 10655
PJUMPE	  1660	  1677	  1724
PRINTF	  1397	  1558	  5600	  6633	  6724	  9431	  9483
PXCT	  5246	  5257	  5262	  5300	  5327	  5336	  5376	  5386	  5389	  5394	  5651	  5737	  5754	  5767
	  5806	  5808	  5816	  5826	  5828	  5830	  5843	  5844	  5856	  5858	  5862	  5872	  5901	  5904
	  5934	  5981	  5998	  6044	  6056	  6082	  6261	  6264	  6353	  6359	  6459	  6460	  6463	  6476
	  6483	  6487	  6736	  6745	  6756	  6772	  6781	  6788	  6791	  6832	  6838	  6851	  6873	  6877
	  6886	  6894	  6921	  6961	  6967	  6978	  7008	  7090	  7386	  7467	  7475	  7493	  7507	  7510
	  7511	  7554	  7574	  7576	  7583	  7754	  7810	  7847	  7858	  7862	  9788	  9794	 10324	 10325
	 10385	 10518
PXGEN	  5246	  5257	  5262	  5300	  5327	  5336	  5376	  5386	  5389	  5394	  5651	  5737	  5754	  5767
	  5806	  5808	  5816	  5826	  5828	  5830	  5843	  5844	  5856	  5858	  5862	  5872	  5901	  5904
	  5934	  5981	  5998	  6044	  6056	  6082	  6261	  6264	  6353	  6359	  6459	  6460	  6463	  6476
	  6483	  6487	  6736	  6745	  6756	  6772	  6781	  6788	  6791	  6832	  6838	  6851	  6873	  6877
	  6886	  6894	  6921	  6961	  6967	  6978	  7008	  7090	  7386	  7467	  7475	  7493	  7507	  7510
	  7511	  7554	  7574	  7576	  7583	  7754	  7810	  7847	  7858	  7862	  9788	  9794	 10324	 10325
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 14:36 13-JAN-88
SCNSER.MAC	25-NOV-87 19:52		Macro/Opdef cross reference

	 10385	 10518
RDPI	  9547
RTYMOD	 10305#	 10418
STOPCD	    10	  1102	  1132	  1133	  1375	  1396	  1432	  1455	  1458	  1460	  1463	  1465	  1467	  1469
	  1471	  1474	  1476	  1479	  1482	  1487	  1490	  1498	  1618	  1627	  1658	  1794	  2958	  2985
	  3069	  3179	  3235	  3246	  3267	  3336	  3367	  3384	  3413	  3446	  3450	  3457	  3470	  3483
	  3556	  3621	  3637	  3654	  3833	  3888	  3936	  3944	  4811	  5040	  5101	  5116	  5119	  5151
	  5619	  5943	  6297	  6300	  6336	  6486	  6618	  6712	  6949	  7334	  7335	  7337	  7339	  7828
	  7963	  7977	  8121	  8127	  8139	  8148	  8365	  8392	  8661	  9586	  9635	 10113	 10395	 10468
	 10530	 11005	 11013	 11016
SY$DV0	 11241#	 11241	 11243	 11245
SY$DV1	 11241#	 11241	 11243	 11245
SYDVF	 11240
TC	   188#	   191	   198#	   203	   204	   205	   206	   207	   208	   209	   210	   211	   212	   213
	   214	   215	   216	   217	   218	   219	   220	   221	   222	   227#	   232	   233	   234	   235
	   236	   237	   238	   239	   240	   241	   242	   243	   244	   245	   246	   247	   248	   249
	   250	   251	   509#	   512
TCHARS	   112#	   150	  6538	  6570
TERCH	  2180#	  2182	  2183	  2184	  2185	  2186	  2187	  2188	  2189	  2190	  2191	  2192	  2193	  2194
	  2195	  2196	  2197	  2198	  2199	  2200	  2201	  2202	  2203	  2204	  2205	  2206	  2207	  2208
	  2209	  2210	  2211	  2212	  2213
TERCHR	   161#	   191	   203	   232	   512
TYPI	   842#	  1266	  1757	  3669	  3687	  3692	  3697	  3704	  3707	  3712	  3756	  3775	  3829	  3929
	  3961	  4020	  4025	  4103	  4108	  4110	  7288	  7299	  9981	  9984	 10024
UMOVE	  5394	  5737	  5754	  6056	  6838	  6873
UMOVEM	  5998	  6082	  6261	  6264	  6832	  6851	  7090	  7467	  7475	  7507	  7511	  7583	 10385	 10518
UUIDPB	   840#	  3496	  3741	  4496	  4502	  4518	  4566	  4583	  4675
UUILDB	   839#	  1921	  1944	  3211	  3495
WRPI	  9548	  9558
XCTBU	  5300	  5843	  5904	  6463	  6483	  6487	  6736	  6745	  6756	  6772	  6781	  7574	  7576	  7847
	  7858
XCTFU	  5246	  5257	  5262	  5327	  5336	  5376	  5386	  5389	  5394	  5651	  5737	  5754	  5767	  5806
	  5808	  5826	  5828	  5830	  5856	  5858	  5862	  5872	  5934	  6056	  6353	  6359	  6459	  6460
	  6788	  6838	  6873	  6877	  6886	  6894	  6921	  6961	  6967	  7386	  7554	  7810	  7862	  9788
	  9794	 10324	 10325
XCTTU	  5816	  5844	  5901	  5981	  5998	  6044	  6082	  6261	  6264	  6476	  6791	  6832	  6851	  6978
	  7008	  7090	  7467	  7475	  7493	  7507	  7510	  7511	  7583	  7754	 10385	 10518
Z	   146#	   150	  6537#	  6538	  6539	  6540	  6541	  6542	  6543	  6544	  6545	  6546	  6547	  6548
	  6549	  6550	  6551	  6552	  6553	  6554	  6555	  6556	  6557	  6558	  6559	  6560	  6561	  6562
	  6563	  6564	  6565	  6566	  6567	  6569#	  6570	  6571	  6572	  6573	  6574	  6575	  6576	  6577
	  6578	  6579	  6580	  6581	  6582	  6583	  6584	  6585	  6586	  6587	  6588	  6589	  6590	  6591
	  6592	  6593	  6594	  6595	  6596	  6597	  6598	  6599
ZZZ	   295#	   303	   304	   305	   306	   307	   308	   309	   310	   311	   312	   313	   314	   315
	   316	   317	   318	   319	   320	   321	   322	   323	   324	   325	   569#	   576	   577	   578
	   579	   580	   581	   582	   583	   584	   585	   586	   587	  3090#	  3091	  3092	  3093	  3094
	  3095	  3096	  3097	  3098	  3099	  3100	  3101	  3102	  3103	  3104	  3105	  3106	  3107	  3108
	  3109	  3110	  3111	  3112	  3113	  3115#	  3116	  3117	  3118	  3119	  3120	  3121	  3122	  3123
	  3124	  3125	  3126	  3127	  3128	  3129	  3130	  3131	  3132	  3133	  3134	  3135	  3136	  3137
	  3138
$END	 11247 d@2