BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 1
S.MAC	13-JAN-88 11:55		S.MAC - with system parameter file for P035/D, January 1988

     1				SUBTTL	S.MAC - with system parameter file for P035/D, January 1988
     2
     3				IF2,<IFNDEF LISTSN,<TAPE>>	;Skip to PASS2 in all but COMMON.LST
     4				;THIS MODULE ASSEMBLED WITH KL-10 PARAMETER FILE - KLSYM.MAC
     5
     6					IF2,<IFNDEF LISTSN,<		;LIST KLSYM.MAC IN COMMON ONLY
     7								TAPE>>
     8				TITLE BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10
     9
    10					STOPCD(,ENTRY,BPXKON)^
    11					ENTRY	BPXKON		;For library searches
    12	000000'	260040	000000*	BPXKON::PUSHJ	P,DIE		;**** Default stopcode for "BPXKON" ****
    13	000001'	426070	535756		SIXBIT	/BPXKON/  	;Title of module
    14	000002'	000000	000000		S$NONAME,,0		;?NONAME stopcode "BPXKON+nnn(nnnnnn)"
    15			000000'	S$NAME==BPXKON			;For STOPCDs with no arguments
    16					SALL>
    17				^
    18			000000		ND FTDPAG,0	;Use UNIBLK instead of UNIPAG
    19
    20					INTERNAL BPXRED,BPXWRT,BPXRCL,BPXPOS,BPXLTM,BPXSTP
    21					INTERNAL BPXCPY,BPXUPA,BPXINT,BPXADD,BPXFIN
    22
    23				;GENERAL FILSER EXTERNALS
    24
    25					EXTERNAL KCMDTA,KCMERR,KCMOFL,KCMRER,KCMPOS
    26					EXTERNAL %OFLER,%OFLFM
    27
    28				;ENTERNALS IN KONTROLER DATA BLOCK AND DEV DEPENDENT KON DATA
    29
    30					EXTERNAL BPXCUB
    31					EXTERNAL KONBMX,KONBSU,KONPTR,KONCHN,KONCPY
    32
    33				;CHANNEL EXTERNALS
    34					EXTERNAL CHNGO,CHNSTB,CHNCLR,CHNBMX,CHNIIE,CHNACT,CHNMER
    35
    36				;UNIT EXTERNALS
    37					EXTERNAL UNICOM,UNPDEV,UNIONC,UNICYL,UNYBPT,UNYPPY
    38				IFE FTDPAG,<EXTERN UNIBLK>
    39				IFN FTDPAG,<EXTERN UNIPAG>
    40					EXTERNAL UNYPUN,UNIPPU,UNYUTP,UNISWC,UNIACT
    41					EXTERNAL UNICNA,UNICNC,UNICCC,UNIRCT
    42					EXTERNAL UNISNS,UNISND,UNISNC,UNISVC,UNISCM
    43
    44				;IN COMMON FOR PAGE DATA (WHEN FIXING ERRORS)
    45					EXTERNAL EPT.PN,EPT,CURUPT
    46
    47				;GENERAL EXTERNALS
    48					EXTERNAL CPOPJ,CPOPJ1
    49				;EXTERNAL FOR SWEEPING CACHE
    50
    51
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 2
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

    52				;ERROR BITS FOR THE CONI GENERATED
    53
    54			000040	ERRCMR==1B30	;COMMAND REJECT
    55			000100	ERRBOP==1B29	;BUS OUT PARITY
    56			000200	ERRBIP==1B28	;BUS IN PARITY
    57			000400	ERRPRT==1B27	;PROTECTION (SET FILE MASK) FAILURE
    58			001000	ERRUNK==1B26	;UNKNOWN ERROR (NO BITS CHECK BUT UNIT CHECK)
    59			002000	ERROVR==1B25	;OVERRUN
    60			004000	ERRNXM==1B24	;NXM
    61			010000	ERRPAR==1B23	;PARITY ERROR
    62			020000	ERRSRC==1B22	;SEARCH ERROR (NO RECORD FOUND)
    63			040000	ERRINV==1B21	;INVALID TRACK FORMAT
    64			100000	ERRRCV==1B20	;RECOVERABLE DATA CHECK
    65			200000	ERRDTA==1B19	;UNRECOVERABLE DATA CHECK
    66			400000	ERRCNT==1B18	;COUNT ERROR (CHANNEL TERMINATION)
    67			000001	ERRBSY==(1B17)	;BUSY
    68			000002	ERRATN==(1B16)	;ATTENTION FLAG
    69			000004	ERRUXC==(1B15)	;UNIT EXCEPTION
    70			000010	ERREQP==(1B14)	;PERMANENT EQUIPMENT CHECK
    71			000020	ERREQC==(1B13)	;EQUIPMENT CHECK
    72			000040	ERRLEN==(1B12)	;LENGTH ERROR
    73			000100	ERRCON==(1B11)	;CONTROL ERROR
    74			000200	ERRSEL==(1B10)	;SELECT ERROR
    75			000400	ERRWPT==(1B9)	;WRITE PROTECT ERROR (COMMAND REJECT ALSO ON)
    76
    77				;SA-10 ERROR BITS
    78
    79			100000	SELER==(1B2)	;SELECT ERROR
    80			040000	BUSIER==(1B3)	;BUS IN PARITY ERROR
    81			020000	CONERR==(1B4)	;CONTROL ERROR
    82			004000	LENERR==(1B6)	;LENGTH ERROR
    83
    84				;SA-10 REPORTED STATUS BITS
    85			001000	ATTEN==(1B8)	;ATTENTION
    86			000400	STSMOD==(1B9)	;STATUS MODIFIER
    87			000200	CUEND==(1B10)	;CONTROL UNIT END
    88			000100	BUSY==(1B11)	;BUSY
    89			000010	UCHK==(1B14)	;UNIT CHECK
    90			000004	UXCP==(1B15)	;UNIT EXCEPTION
    91			000020	DEVEND==(1B13)	;DEVICE END (COMES FROM PACK ON LINE)
    92
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 3
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

    93				;OPERATION CODES FOR 3330
    94
    95			000006	BPXRD==6	;READ
    96			000005	BPXWT==5	;WRITE
    97			000023	RECAL==23	;RECALIBRATE
    98			000007	SEEK==7	;SEEK
    99			000043	SETSEC==43	;SET SECTOR
   100			000061	SRCIDE==61	;SEARCH ID=
   101			000004	SENSE==4	;SENSE
   102			000013	SEEKCY==13	;SEEK CYLINER (USED FOR SEEK UUO)
   103			000244	RRBL==244	;READ AND RESET BUFFERED LOG
   104
   105				;SA-10 CONTROL BITS
   106
   107			000200	NOMEMT==200	;NO MEMORY TRANSFER (BYTE ORIENTATION FOR BITS
   108			000040	XCTCMD==40	;EXECUTE COMMAND
   109			000020	CHAIN==20	;CHAIN COMMAND
   110			000002	IGNLEN==2	;IGNORE LENGHT ERROR
   111			000001	OFFSET==1	;BYTE MODE OFFSET
   112			000000	TRWORD==0	;TRANSFER WORD MODE
   113			000010	TRBYTE==10	;TRANSFER BYTE MODE
   114			000100	TRBIT==100	;TRANSFER BIT STREAM MODE
   115			000110	TRTAP==110	;TRANSFER TAPE COMPATABILITY
   116
   117			000072	BYTMOD==TRBYTE+CHAIN+XCTCMD+IGNLEN
   118			000242	NOXFR==NOMEMT+XCTCMD+IGNLEN
   119			000073	STROFA==XCTCMD+CHAIN+TRBYTE+OFFSET+IGNLEN
   120			000160	WRDMOD==TRBIT+XCTCMD+CHAIN
   121
   122			200000	TICBIT==(1B1)	;BIT FOR TIC
   123
   124			000524	BPERT==^D<18*19>&777774
   125
   126					DEFINE XOR(A,B)
   127					<A!B-A&B>
   128
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 4
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   129				;INTERUPT HANDLER
   130
   131				;AT THIS POINT J POINTS TO THE KONTROLER DATA BLOCK
   132				;PG TO THE CHANNEL DATA BLOCK
   133				;AND M TO THE SA-10 DATA BLOCK
   134
   135	000003'	200323	000000*	BPXINT:	MOVE T1,@CHNSTB(PG)	;GET THE STATUS WORD
   136	000004'	135700	001427'		LDB P3,[POINT 4,T1,23]	;GET UNIT FIELD
   137	000005'	200262	000000*		MOVE U,@KONPTR(J)	;THIS PICKS UP THE UNIT DATA BLOCK ADRESS
   138	000006'	331003	000003*		SKIPL CHNSTB(PG)	;CHECK FOR MEMORY ERROR ALSO
   139	000007'	603300	165314		TLNE T1,ANYERR
   140	000010'	254000	000036'		 JRST ERRCHK	;CHECK FOR UNUSUAL CONDITION
   141	000011'	403600	000015		SETZB P1,P2	;NO ERROR, P1 HAS FAKE CONI P2 SYNDROM
   142	000012'	261040	000015		PUSH P,P2	;AND ON STACK IS FAKE DATAI
   143	000013'	322240	000030'	DATACK:	JUMPE U,DISMS1	;WE GET HERE AFTER STATUS READ
   144	000014'	200305	000000*		MOVE T1,UNICOM(U)	;GET POINTER TO CONTROL BLOCK
   145	000015'	135340	001430'		LDB T2,[POINT 8,(T1),15]	;AND GET FIRST COMMAND
   146	000016'	306340	000007		CAIN T2,SEEK	;IS IT A SEEK (HEAD AND CYL)
   147	000017'	254000	000347'		JRST DATA	;PG`THEN IT WAS A DATA TRANS
   148	000020'	302340	000023		CAIE T2,RECAL
   149	000021'	306340	000013		CAIN T2,SEEKCY
   150	000022'	254000	000127'		JRST POSINT	;RECAL OR SEEK CYL SEEK UUO OR ERROR
   151	000023'	306340	000244		CAIN T2,RRBL
   152	000024'	254000	000126'		JRST POSNTS	;TREAT AS POSITION INTERUPT EXCEPT IN SENCE COUNT FOR BUFF LOG
   153	000025'	336006	000000		SKIPN (T1)	;IS ENTIRE WORD 0?
   154	000026'	254000	000127'		JRST POSINT	;YES, MUST BE ON-LINE
   155	000027'	254000	000145'		JRST ERRSEN		;A TIC FOR THE SENSE
   156	000030'	262040	000006	DISMS1:	POP P,T1	;ADJUST STACK
   157	000031'	205300	700000	DISMIS:	MOVSI T1,7B20	;HALVES HAVE BEEN SWITCHED
   158	000032'	412303	000006*		ANDCAM T1,CHNSTB(PG)	;RESET MEMORY ERROR BITS
   159	000033'	256003	000000*		XCT CHNGO(PG)	;START THE SA-10 CHANNEL (IN CASE GO LOST)
   160	000034'	256003	000000*		XCT CHNCLR(PG)	;AND CLEAR STATUS FLAG
   161	000035'	263040	000000		POPJ P,		;ALL DONE
   162
   163			165314	ANYERR==UCHK!BUSY!CUEND!LENERR!CONERR!BUSIER!SELER!ATTEN!UXCP
   164
   165	000036'	603300	000010	ERRCHK:	TLNE T1,UCHK	;IS IT A UNIT CHECK
   166	000037'	254000	000045'		JRST RDSTS	;YES, WE MUST DO A READ STATUS
   167	000040'	603300	000100		TLNE T1,BUSY
   168	000041'	254000	000071'		JRST CHKBSY	;CHECK BUSY
   169	000042'	603300	000200		TLNE T1,CUEND
   170	000043'	254000	000100'		JRST KONENC	;IF SO, RESTART WAITING DEVICES
   171	000044'	254000	000474'		JRST ERROR	;ASSUME ERROR CONDITION
   172
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 5
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   173	000045'	332005	000000*	RDSTS:	SKIPE UNISVC(U)	;HAVE WE ALREADY SET UP THE SENSE?
   174					JRST	[MOVE T2,UNICOM(U)	;YES, MUST SET T2
   175	000046'	254000	001431'			JRST RDSTSS]	;AND GO
   176	000047'	200403	000032*		MOVE T3,CHNSTB(PG)	;HERE TO READ STATUS, SAVE SECOND
   177	000050'	200410	000001		MOVE T3,1(T3)	;OF STATUS STORED BY SA-10
   178	000051'	202405	000045*		MOVEM T3,UNISVC(U)	;HAS COUNT INFO
   179	000052'	201405	000000*		MOVEI T3,UNISNS(U)
   180	000053'	505400	200000		HRLI T3,TICBIT	;SET UP FOR TIC TO SENSE
   181	000054'	200345	000014*		MOVE T2,UNICOM(U)
   182	000055'	250407	000000		EXCH T3,(T2)	;SET IT AND GET OLD COMMAND
   183	000056'	202405	000000*		MOVEM T3,UNISCM(U)
   184	000057'	260040	000061'	RDSTSS:	PUSHJ P,STRTU	;GET UNIT READY TO START
   185	000060'	254000	000031'		JRST DISMIS	;AND GET OUT OF INTERUPT
   186
   187	000061'	200402	000000*	STRTU:	MOVE T3,KONBSU(J)
   188	000062'	270400	000016		ADD T3,P3	;GENERAT UNIT NUMBER
   189	000063'	505340	001500	STRTU1:	HRLI T2,(15B11)	;A START CODE
   190	000064'	137400	001433'		DPB T3,[POINT 8,T2,7]	;SET IT UP
   191	000065'	554402	000000*		HLRZ T3,KONBMX(J)
   192	000066'	270400	000016		ADD T3,P3	;SET TO POINT TO LIST
   193	000067'	202350	000000		MOVEM T2,(T3)
   194	000070'	263040	000000		POPJ P,		;ALL DONE WITH LIST SETUP
   195
   196				;HERE ON A BUSY INDICATION
   197
   198	000071'	607300	000400	CHKBSY:	TLNN T1,STSMOD	;IS IT BUSY AND STATUS MODIFIER
   199	000072'	254000	000117'		JRST DEVBSY	;NO, SOME TYPE OF DEVICE BUSY
   200	000073'	210340	000016	CUBSY:	MOVN T2,P3	;CONTROL UNIT BUSY
   201	000074'	205400	400000		MOVSI T3,(1B0)	;SET A MAST THAT UNIT NEEDS RESTART
   202	000075'	242407	000000		LSH T3,(T2)
   203	000076'	436402	000000*		IORM T3,BPXCUB(J)
   204	000077'	603300	000200		TLNE T1,CUEND	;CHECK FOR CONTROL UNIT END ALSO
   205	000100'	260040	000102'	KONENC:	PUSHJ P,KONEND	;YES, RESTART WAITERS
   206	000101'	254000	000031'		JRST DISMIS	;AND JUST DISMIS IF NOT
   207
   208	000102'	510302	000076*	KONEND:	HLLZ T1,BPXCUB(J)	;GET THE MASK OF UNIT BUSY FLAGS
   209	000103'	553002	000102*		HRRZS BPXCUB(J)	;MAKE SURE BITS ARE ZEROED
   210	000104'	201700	000000		MOVEI P3,0
   211	000105'	621300	000003		TLZ T1,3	;REMOVE EXTRA BITS
   212	000106'	243300	000110'	CRST:	JFFO T1,.+2
   213	000107'	263040	000000		POPJ P,		;ALL OUT OF BITS, ALL UNITS RESTARTED
   214	000110'	242307	000001		LSH T1,1(T2)	;GET RID OF EXTRA BIT
   215	000111'	270700	000007		ADD P3,T2	;UPDATE UNIT NUMBER
   216	000112'	336262	000005*		SKIPN U,@KONPTR(J)
   217	000113'	344700	000106'		AOJA P3,CRST	;NOT REALLY SUCH A UNIT, DO NOT START
   218	000114'	540345	000054*		HRR T2,UNICOM(U)
   219	000115'	260040	000061'		PUSHJ P,STRTU	;RESTART UNIT
   220	000116'	344700	000106'		AOJA P3,CRST	;AND CHECK FOR MORE
   221
   222	000117'	607300	000220	DEVBSY:	TLNN T1,CUEND!DEVEND	;IS IT CONTROL UNIT END OR DEV END AND BUSY
   223	000120'	254000	000474'		JRST ERROR	;NO, DEVICE BUSY IS ERROR
   224	000121'	350000	000123'		AOS BPSTRD	;COUNT NUMBER OF TIMES GO BUSY CUEND
   225	000122'	254000	000045'		JRST RDSTS	;BUSY CUEND, TREAT AS UNIT CHECK
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 5-2
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   226
   227	000123'	000000	000000	BPSTRD:	0
   228	000124'	000001	000000		1,,0
   229					.LINK 1,.-1
   230	000125'	000123'	001434'		BPSTRD,,[SIXBIT /BPSTRD/]
   231
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 6
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   232	000126'	350005	000000*	POSNTS:	AOS UNISNC(U)	;INCREMENT SNESE COUNT (READ AND RESET LOG)
   233	000127'	210340	000016	POSINT:	MOVN T2,P3	;GET SET TO GENERAT A BIT FOR DEVICE
   234	000130'	205300	400000		MOVSI T1,(1B0)
   235	000131'	242307	000000		LSH T1,(T2)
   236	000132'	612302	000000*		TDNE T1,KONCPY(J)
   237	000133'	254000	001310'		JRST BPXCNX	;THIS IS THE RESULT OF A CAPACITY TEST
   238	000134'	505300	000000*	POSDIS:	HRLI T1,KCMPOS
   239	000135'	403601	000000		SETZB P1,(P)	;NO CONI OR DATAI INFO
   240	000136'	262040	000010	FILDIS:	POP P,T3	;GET DATAI TO CORRECT PLACE
   241	000137'	200345	000114*	FILDS1:	MOVE T2,UNICOM(U)
   242	000140'	402007	000000		SETZM (T2)	;ZERO OUT COMMAND AREA SO RECOGNIZE ON-LINE
   243	000141'	200340	000014		MOVE T2,P1	;CONI
   244	000142'	256003	000033*		XCT CHNGO(PG)
   245	000143'	256003	000034*		XCT CHNCLR(PG)
   246	000144'	254000	000000*		JRST FILINT##	;Tell FILIO
   247
   248	000145'	200345	000056*	ERRSEN:	MOVE T2,UNISCM(U)
   249	000146'	350005	000126*		AOS UNISNC(U)	;COUNT AA SENSE DONE
   250	000147'	202346	000000		MOVEM T2,(T1)	;RESTORE THE FIRST COMMAND
   251	000150'	201300	000000		MOVEI T1,0		;ALSO ZERO UNISVC FOR NEXT SENSE
   252	000151'	250305	000051*		EXCH T1,UNISVC(U)	;AND THE COUNT INFO
   253	000152'	200343	000047*		MOVE T2,CHNSTB(PG)
   254	000153'	202307	000001		MOVEM T1,1(T2)
   255	000154'	261040	000005		PUSH P,U	;AT END OF SENSE, RESTART WAITERS
   256	000155'	261040	000016		PUSH P,P3	;THIS TAKES CARE OF BUSY, CUENDD
   257	000156'	260040	000102'		PUSHJ P,KONEND	;WHICH MUST WAIT FOR SNESE TO FINISH
   258	000157'	262040	000016		POP P,P3	;NORMALLY NO WAITERS SO MAKES LITTLE
   259	000160'	262040	000005		POP P,U		;OR NO DIFF IF NOT BUSY, CUEND
   260	000161'	326600	000013'		JUMPN P1,DATACK	;FORGET IT IF SOME OTHER ERROR DETECTED
   261	000162'	510345	000000*		HLLZ T2,UNISND(U)	;GET STATUS BITS
   262	000163'	621340	000003		TLZ T2,3
   263	000164'	243340	000170'		JFFO T2,BYT0	;CHECK FOR ANY ON
   264	000165'	540345	000137*		HRR T2,UNICOM(U)	;LOOKS LIKE ENVIRON DATA
   265	000166'	260040	000061'		PUSHJ P,STRTU
   266	000167'	254000	000030'		JRST DISMS1	;JUST RESTART UNIT
   267
   268	000170'	254030	000171'	BYT0:	JRST @BYT0T(T3)	;DISPATCH ON BIT
   269
   270	000171'	000000	000252'	BYT0T:	CMDRJC	;COMMAND REJECT BYTE 0 BIT 0
   271	000172'	000000	000224'		OFLIN	;OFF-LINE (INTERVENTION REQUIRED) BYTE 0 BIT 1
   272	000173'	000000	000221'		BUSOPA	;BUSS OUT PARITY ERROR BYTE 0 BIT 2
   273	000174'	000000	000235'		EQCHK	;EQUIPMENT CHECK BYTE 0 BIT 3
   274	000175'	000000	000264'		DTACHK	;DATA CHECK BYTE 0 BIT 4
   275	000176'	000000	000212'		OVRUN	;PERMANENT OVERRUN BYTE 0 BIT 5
   276	000177'	000000	000244'		UNKNO	;UNKNOWN, BIT UNUSED BYTE 0 BIT 6
   277	000200'	000000	000244'		UNKNO	;UNKNOWN, BIT UNUSED BYTE 0 BIT 7
   278
   279
   280	000201'	000000	000244'	BYT1T:	UNKNO	;UNKNNOWN PERMANENT ERROR OTHER SHOULD BE ON
   281						;BYTE 1 BIT 0
   282	000202'	000000	000247'		INVTRK	;INVALID TRACK BYTE 1 BIT 1
   283	000203'	000000	000244'		UNKNO	;UNKNOWN EOC BYYTE 1 BIT 2
   284	000204'	000000	000244'		UNKNO	;UNKNOWN UNUSED BYTE 1 BIT 3
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 6-2
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   285	000205'	000000	000246'		NOREC	;NO RECORD FOUND BYTE 1 BIT 4
   286	000206'	000000	000211'		PROTEC	;FILE PROTECTED BYTE 1 BIT 5
   287	000207'	000000	000244'		UNKNO	;WRITE INHIBITED CMD REJECT SHOULD BE ON BYTE 1 BIT 6
   288	000210'	000000	000244'		UNKNO	;OPERATION INCOMPLETE, OTHER SHOULD BE ON TOO BYTE 1 BIT 7
   289
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 7
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   290				;SENSE ERROR DATA
   291
   292	000211'	664600	000400	PROTEC:	TROA P1,ERRPRT	;PROTECT ERROR
   293	000212'	660600	002000	OVRUN:	TRO P1,ERROVR	;DATA OVERRUN
   294	000213'	200640	000260'	ERRNO:	MOVE P2,RTYZRO	;NO RETRYS
   295	000214'	200305	000001*	ERRCOM:	MOVE T1,UNISND+1(U)	;PHYSICAL DRIVE NUMBER IS HERE
   296	000215'	202301	000000		MOVEM T1,(P)
   297	000216'	336005	000000*	ERRCM1:	SKIPN UNIRCT(U)	;HAS RETRYPATTERN BEEN SET YET?
   298	000217'	202645	000216*		MOVEM P2,UNIRCT(U)	;NO, SET IT
   299	000220'	254000	000013'		JRST DATACK	;AND CHECK ON TRANSFER
   300
   301	000221'	660600	000100	BUSOPA:	TRO P1,ERRBOP
   302	000222'	200640	000261'	ERRONE:	MOVE P2,RTYONE	;ONE RETRY
   303	000223'	254000	000214'		JRST ERRCOM
   304
   305	000224'	200305	000001*	OFLIN:	MOVE T1,UNISND+1(U)
   306	000225'	202301	000000		MOVEM T1,(P)
   307	000226'	135340	000000*		LDB T2,UNYPUN
   308	000227'	213000	000007		MOVNS T2
   309	000230'	205300	400000		MOVSI T1,(1B0)
   310	000231'	242307	000000		LSH T1,(T2)
   311	000232'	412302	000132*	OFLIN2:	ANDCAM T1,KONCPY(J)	;TURN OFF CAPACITY TEST BIT IF OFF-LINE
   312	000233'	205300	000000*		MOVSI T1,KCMOFL
   313	000234'	254000	000136'		JRST FILDIS	;DISMISS INTERRUPT, CALL FILINT IN FILIO
   314
   315	000235'	205300	001000	EQCHK:	MOVSI T1,(1B8)
   316	000236'	616305	000162*		TDNN T1,UNISND(U)
   317	000237'	665600	000020		TLOA P1,ERREQC
   318	000240'	665600	000010		TLOA P1,ERREQP
   319	000241'	334640	000262'	ERRTEN:	SKIPA P2,RTYTEN
   320	000242'	254000	000213'		JRST ERRNO	;NO RETRY ON PERM ERROR
   321	000243'	254000	000214'		JRST ERRCOM	;10 RETRY ON CORRECTABLE ERROR
   322
   323	000244'	660600	001000	UNKNO:	TRO P1,ERRUNK	;UNKNOWN ERROR
   324	000245'	254000	000241'		JRST ERRTEN	;RETRY 10 TIMES
   325
   326	000246'	664600	020000	NOREC:	TROA P1,ERRSRC	;CALL IT A SEARCH ERROR
   327	000247'	660600	040000	INVTRK:	TRO P1,ERRINV
   328	000250'	200640	000263'	ERRDT0:	MOVE P2,RTYDT0	;DATA ERROR, 0 RETRYS
9	000251'	254000	000214'		JRST ERRCOM
   330
   331	000252'	660600	000040	CMDRJC:	TRO P1,ERRCMR
   332	000253'	205300	000010		MOVSI T1,(1B14)
   333	000254'	612305	000236*		TDNE T1,UNISND(U)
   334	000255'	661600	000400		TLO P1,ERRWPT	;WRITE PROTECT ERROR
   335	000256'	254000	000213'		JRST ERRNO
   336
   337					DEFINE SYND(RTY,RCL,RRT,MOD)
   338				<	XWD RRT+200000+UNPDEV*MOD,RCL_9+RTY>
   339
   340	000257'	000000*	000144	RTYCNT:	SYND (^D100,0,0,1)
   341	000260'	000000*	000000	RTYZRO:	SYND(0,0,0,1)
   342	000261'	000000*	000001	RTYONE:	SYND(1,0,0,1)
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 7-2
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   343	000262'	000000*	000012	RTYTEN:	SYND(^D10,0,0,1)
   344	000263'	000000*	000000	RTYDT0:	SYND(0,0,0,0)
   345
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 8
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   346	000264'	205300	000001	DTACHK:	MOVSI T1,(1B17)	;SEE IF CORRECTABLE
   347	000265'	616305	000254*		TDNN T1,UNISND(U)
   348	000266'	254000	000345'		JRST DTAUNC	;NO, NOT CORRECTABLE
   349	000267'	135700	001435'		LDB P3,[POINT 24,UNISND+5(U),23]	;GET SYNDROM BYTES
   350	000270'	242700	000014		LSH P3,^D12	;LEFT JUSTIFY
   351	000271'	201740	000000		MOVEI P4,0
   352	000272'	135600	001436'		LDB P1,[POINT 16,UNISND+4(U),15]
   353	000273'	135640	001437'		LDB P2,[POINT 8,UNISND+3(U),31]
   354	000274'	137640	001440'		DPB P2,[POINT 8,P1,19]	;HERE ISS THE RESTART DISP
   355	000275'	135640	001441'		LDB P2,[POINT 16,UNISND+4(U),31]	;HERE IS THE ERROR DISP
   356	000276'	274600	000015		SUB P1,P2	;NUMBER OF BYTES TO OFFSET FROM START
   357	000277'	242600	000003		LSH P1,3	;CONVERT P1 TO NUMBER OF BITS
   358	000300'	231600	000044		IDIVI P1,^D36	;NOW HAVE WORDS IN P1, BITS IN P2
   359	000301'	213000	000015		MOVNS P2
   360	000302'	246715	000000		LSHC P3,(P2)	;AND SHIFT SYNDROM TO DOUBLE WORD POSITION
   361	000303'	326700	000306'		JUMPN P3,GORCV	;SEE IF ANY LEFT IN P3
   362	000304'	271600	000001		ADDI P1,1	;NO, 1 EXTRA WORD
   363	000305'	250700	000017		EXCH P3,P4	;AND GET BITS TO P3
   364	000306'	550303	000152*	GORCV:	HRRZ T1,CHNSTB(PG)	;GET POINTER TO COMMAND CHAIN
   365	000307'	370646	000001		SOS P2,1(T1)	;POINTS TO FIRST DATA WORD OF RECORD
   366	000310'	331015	000000		SKIPL (P2)	;POINTER ALWAYS POINTS 1 AFTER 1ST DATA WD
   367	000311'	344640	000310'		AOJA P2,.-1	;GET IT TO POINT TO LAST
   368	000312'	271640	000002		ADDI P2,2	;IF LAST RECORD, NOW 1 AFTER HALT
   369	000313'	553000	000015		HRRZS P2	;AND GET RID OF COUNT. NOW LOOKS LIKE TO END OF RECORD
   370	000314'	250646	000001		EXCH P2,1(T1)	;GET THE OLD WORD PNTS TO 1ST TRANS
   371	000315'	135300	001442'	LOKRCV:	LDB T1,[POINT 11,(P2),11]	;GET COUNT
   372	000316'	213000	000006		MOVNS T1
   373	000317'	405300	003777		ANDI T1,3777
   374	000320'	313300	000014		CAMLE T1,P1	;IS IT LESS OR EQUAL TO OFFSET COUNT
   375	000321'	254000	000330'		JRST FNDRCV	;IF YES, WE HAVE FOUND THE TRANS WORD
   376	000322'	274600	000006		SUB P1,T1	;DECREMENT OFFSET REMAINING
   377	000323'	331015	000000		SKIPL (P2)	;AND IF MORE TRANSFER WORDS
   378	000324'	344640	000315'		AOJA P2,LOKRCV	;TRY NEXT BLOCK OF DATA
   379	000325'	201600	100000	FINRCV:	MOVEI P1,ERRRCV
   380	000326'	201640	000000		MOVEI P2,0	;ALL DONE, RECOVERABLE ERR AND NOT RETRY
   381	000327'	254000	000214'		JRST ERRCOM
   382
   383	000330'	135340	001443'	FNDRCV:	LDB T2,[POINT 24,(P2),35]
   384	000331'	322340	000341'		JUMPE T2,NOTRN	;NO TRANSFER IF ADDRESS IS 0
   385	000332'	270340	000014		ADD T2,P1	;ADD IN THE OFFSET
   386	000333'	135300	001444'		LDB T1,[POINT 13,T2,26]	;PAGE NUMBER
   387	000334'	405340	000777		ANDI T2,777	;AND DISP WITHIN PAGE
   388	000335'	660300	700000		TRO T1,PGE.A!PGE.W!PGE.P	;SET ACCESS
   389	000336'	137300	001445'		DPB T1,[EPTPGP (%ERR.N)]
   390	000337'	701100	777000		CLRPTO	%ERR		;CLEAR PAGE TABLE ENTRY FOR %ERR
   391	000340'	432707	777000		XORM P3,%ERR(T2)	;FIX UP THE ERROR
   392	000341'	322740	000325'	NOTRN:	JUMPE P4,FINRCV	;IF REST OF BYTES 0, DONE
   393	000342'	200700	000017		MOVE P3,P4
   394	000343'	201740	000000		MOVEI P4,0	;MOVE BYTES AND SET REMAINDER TO
   395	000344'	344600	000315'		AOJA P1,LOKRCV	;COUNT OF 1 MORE, LET COMMON CODE LOOK
   396
   397	000345'	660600	200000	DTAUNC:	TRO P1,ERRDTA	;UNRECOVERABLE
   398	000346'	254000	000213'		JRST ERRNO
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 8-2
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   399
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 9
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   400	000347'	200303	000306*	DATA:	MOVE T1,CHNSTB(PG)	;GET SET TO COUNT WORDS TRANS
   401	000350'	370306	000001		SOS T1,1(T1)	;THIS IS THE TERMINATE WORD
   402	000351'	550405	000000*		HRRZ T3,UNISWC(U)	;EXPECTED COUNT
   403	000352'	554345	000351*		HLRZ T2,UNISWC(U)	;EXPECTED END
   404	000353'	306346	000000		CAIN T2,(T1)	;ARE THEY THE SAME?
   405	000354'	254000	000423'		JRST DTADON	;YES, ALL OK
   406	000355'	553005	000352*		HRRZS UNISWC(U)	;FOR COUNT CHECKING
   407	000356'	550345	000165*		HRRZ T2,UNICOM(U)	;POINTER TO COMMAND LIST
   408	000357'	201400	000000		MOVEI T3,0	;COUNT SO FAR
   409	000360'	335447	000000	CNTLP:	SKIPGE T4,(T2)	;BIT 0 ONLY ON FOR HALT IN DATA TANS
   410	000361'	254000	000412'		JRST CNTDON	;IT IS A HALT
   411	000362'	306346	000000		CAIN T2,(T1)	;DO WE END NOW?
   412	000363'	254000	000412'		JRST CNTDON	;YES, FINISHED COUNTING
   413	000364'	607440	100000		TLNN T4,(1B2)	;THIS IS THE EXECUTE BIT
   414	000365'	344340	000360'		AOJA T2,CNTLP	;IF NOT ON, THIS MUST BE TIC
   415	000366'	607440	020000		TLNN T4,(1B4)	;CHECK BYTE MODE
   416	000367'	344340	000376'		AOJA T2,DTATRN	;NOT BYTE MODE, MUST BE DATA
   417	000370'	271340	000001		ADDI T2,1	;CHECK FOR TRANSFER
   418	000371'	306346	000000	BYTARG:	CAIN T2,(T1)
   419	000372'	254000	000412'		JRST CNTDON	;ENDED HERE
   420	000373'	335007	000000		SKIPGE (T2)
   421	000374'	344340	000360'		AOJA T2,CNTLP	;NEGATIVE IS LAST TRANS
   422	000375'	344340	000371'		AOJA T2,BYTARG	;ELSE MORE TRANSFER WORDS
   423
   424	000376'	135440	001446'	DTATRN:	LDB T4,[POINT 11,(T2),11]	;GET COUNT FIELD
   425	000377'	306346	000000		CAIN T2,(T1)
   426	000400'	254000	000406'		JRST LSTCNT	;IF TERMINATE HERE, THIS IS PARTIAL COUNT
   427	000401'	640440	003777		TRC T4,3777
   428	000402'	271411	000001		ADDI T3,1(T4)	;INCREMENT COUNT
   429	000403'	335007	000000		SKIPGE (T2)
   430	000404'	344340	000360'		AOJA T2,CNTLP	;NEGATIVE IS LASTTRANSFER
   431	000405'	344340	000376'		AOJA T2,DTATRN	;MORE DATA
   432
   433	000406'	135300	001447'	LSTCNT:	LDB T1,[POINT 11,T1,11]	;PARTIAL TRANS, GET REMAINING COUNT
   434	000407'	274300	000011		SUB T1,T4	;SUBTRACT ORIGINAL COUNT
   435	000410'	405300	003777		ANDI T1,3777	;JUST IN CASE ALL REALLY TRANS (T1=0)
   436	000411'	270400	000006		ADD T3,T1
   437	000412'	316405	000355*	CNTDON:	CAMN T3,UNISWC(U)	;IS IT THE SAME?
   438	000413'	254000	000423'		JRST DTADON	;YES, FINISHED
   439	000414'	660600	400000	CNTBAD:	TRO P1,ERRCNT	;SET COUNT ERROR FLAG
   440	000415'	332001	000000		SKIPE (P)	;IS THERE DATAI INFO
   441	000416'	254000	000423'		JRST DTADON	;YES, SOME OTHER ERROR ALSO
   442	000417'	476001	000000		SETOM (P)	;FLAG SOFT ERROR
   443	000420'	200640	000257'		MOVE P2,RTYCNT
   444	000421'	336005	000217*		SKIPN UNIRCT(U)
   445	000422'	202645	000421*		MOVEM P2,UNIRCT(U)	;SET TO RETRY
   446	000423'	336000	000010	DTADON:	SKIPN T3
   447	000424'	201400	000200		MOVEI T3,200	;SET AMOUNT TRANSFERED
   448	000425'	271400	000177		ADDI T3,177	;MUST BE EVEN NUMBER OF RECORDS
   449	000426'	242400	777771		LSH T3,-7	;AND AT LEAST ONE
   450	000427'	200300	000010		MOVE T1,T3
   451	000430'	270305	000000*		ADD T1,UNICCC(U)	;ADD IN COUNT SO FAR
   452				IFN FTDPAG,<
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 9-2
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   453					LSH T1,-2	;CONVERT TO PAGES
   454					SKIPN T1	;AT LEAST 1
   455					 MOVEI T1,1
   456				>
   457	000431'	505300	000000*		HRLI T1,KCMDTA	;DATA TRANS
   458	000432'	322600	000437'		JUMPE P1,FILFAK	;FINISHED, ANY ERRORS?
   459	000433'	606600	100000		TRNN P1,ERRRCV	;IS IT RECOVERABLE DATA?
   460	000434'	665300	000000*		TLOA T1,KCMERR
   461	000435'	661300	000000*		TLO T1,KCMRER	;YES, FLAG IT
   462	000436'	254000	000136'		JRST FILDIS	;DISMISS INTERRUPT, CALL FILINT IN FILIO
   463
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 10
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   464				;HERE TO REGENERATE COMMAND LIST WITHOUT CALLING FILIO
   465
   466	000437'	336005	000000*	FILFAK:	SKIPN UNICNA(U)
   467	000440'	254000	000136'		JRST FILDIS	;NO MORE TO REGEN
   468	000441'	272405	000430*		ADDM T3,UNICCC(U)	;INCREASE COUNT
   469	000442'	256003	000142*		XCT CHNGO(PG)
   470	000443'	256003	000143*		XCT CHNCLR(PG)	;RESTART SA-10
   471	000444'	262040	000017		POP P,P4	;GARBAGE WORD
   472
   473				COMMENT ; WE KNOW THAT THIS TRANSFER WILL BE ON RECORD 1 OF
   474				THE HEAD NUMBERED ONE HIGHER THAN THE FIRST TRANSFER THE
   475				LAST TIME. ALSO THE SEEK, SET SECTOR, SEARCH ID EQUAL, READ OR WRITE
   476				ARE ALREADY SET UP. ALL WE HAVE DO DO IS MODIFY THE ADDRESS OF
   477				THE SEEK AND SET SECTOR ANDD CALL THE ADD ROUTINE;
   478
   479	000445'	260040	000540'		PUSHJ P,BPXSET	;SET UP P1 AND P3
   480	000446'	201300	000001		MOVEI T1,1
   481	000447'	137300	001450'		DPB T1,[POINT 8,(P3),23]	;RECORD 1
   482	000450'	205300	000004		MOVSI T1,(BYTE (8) 0,1)	;NOW INCREMENT THE HEAD NUMBER
   483	000451'	273316	000000		ADDB T1,(P3)
   484	000452'	135300	001451'		LDB T1,[POINT 16,T1,15]	;NOW GET JUST THE HEAD
   485	000453'	201740	125000		MOVEI P4,BPERT*200	;SET UP TO EOC
   486	000454'	221300	004400		IMULI T1,^D18*200	;BLOCKS/TRACK
   487	000455'	274740	000006		SUB P4,T1	;THIS IS LEFT TO EOC
   488	000456'	201640	004400		MOVEI P2,^D18*200	;AND WE HAVE 1 TRACK WORTH NOW
   489	000457'	200300	000601'		MOVE T1,RECTBL
   490	000460'	202316	000001		MOVEM T1,1(P3)
   491	000461'	505614	000004		HRLI P1,4(P1)	;NOW SET UP FOR MORE ADDITIONS
   492	000462'	271600	000011		ADDI P1,11
   493	000463'	275700	000003		SUBI P3,3
   494	000464'	402005	000412*		SETZM UNISWC(U)
   495	000465'	504700	000577'		HRL P3,BPBRK1	;NOT IMMEDIATE IN CASE CHANGED FOR BREAKPOINTS
   496	000466'	200305	000000*		MOVE T1,UNICNC(U)
   497	000467'	200345	000437*		MOVE T2,UNICNA(U)
   498	000470'	402005	000467*		SETZM UNICNA(U)	;IN CASE THIS ONE FINISHES IT
   499	000471'	260040	000677'		PUSHJ P,BPXAD1
   500	000472'	255000	000000		 JFCL
   501	000473'	324740	001124'		PJRST BPXFIN	;AND GO
   502
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 11
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   503				;HERE ON AN SA-10 DETECTED ERROR
   504
   505	000474'	403600	000015	ERROR:	SETZB P1,P2
   506	000475'	261040	000014		PUSH P,P1	;SET DATAI AND CONI, RETRY INFO
   507	000476'	476001	000000		SETOM (P)	;FLAG AS CHANNEL IN DATAI WORD
   508	000477'	335003	000347*		SKIPGE CHNSTB(PG)
   509	000500'	254000	000524'		JRST MEMERR	;MEMORY ERROR
   510	000501'	603300	100000		TLNE T1,SELER
   511	000502'	254000	000521'		JRST SELERR	;SELECT ERROR TRY AGAIN
   512	000503'	200640	000257'		MOVE P2,RTYCNT	;SET FOR LOTS OF RETRYS
   513	000504'	603300	004000		TLNE T1,LENERR	;LENGTH ERROR
   514	000505'	661600	000040		TLO P1,ERRLEN
   515	000506'	603300	020000		TLNE T1,CONERR
   516	000507'	661600	000100		TLO P1,ERRCON
   517	000510'	603300	040000		TLNE T1,BUSIER
   518	000511'	660600	000200		TRO P1,ERRBIP
   519	000512'	603300	000100		TLNE T1,BUSY
   520	000513'	661600	000001		TLO P1,ERRBSY
   521	000514'	603300	001000		TLNE T1,ATTEN
   522	000515'	661600	000002		TLO P1,ERRATN
   523	000516'	603300	000004		TLNE T1,UXCP
   524	000517'	661600	000004		TLO P1,ERRUXC
   525	000520'	254000	000216'		JRST ERRCM1	;CHECK ON DATA NOW
   526
   527	000521'	661600	000200	SELERR:	TLO P1,ERRSEL
   528	000522'	200640	000261'		MOVE P2,RTYONE	;ONE RETRY
   529	000523'	254000	000216'		JRST ERRCM1
   530
   531	000524'	200640	000257'	MEMERR:	MOVE P2,RTYCNT	;LOST OF RETRYS
   532	000525'	200303	000000*		MOVE T1,CHNMER(PG)
   533	000526'	660300	000001		TRO T1,1	;FLAG NO STATUS INFORMATION BUT MEM DATA
   534	000527'	202301	000000		MOVEM T1,(P)
   535	000530'	200303	000477*		MOVE T1,CHNSTB(PG)
   536	000531'	603300	200000		TLNE T1,1B19	;HALVES HAVE BEEN SWITCHED
   537	000532'	660600	010000		TRO P1,ERRPAR
   538	000533'	603300	100000		TLNE T1,1B20
   539	000534'	660600	004000		TRO P1,ERRNXM
   540	000535'	205300	700000		MOVSI T1,7B20
   541	000536'	412303	000530*		ANDCAM T1,CHNSTB(PG)	;RESET ERROR BITS
   542	000537'	254000	000216'		JRST ERRCM1
   543
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 12
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   544				;READ AND WRITE ROUTINE
   545
   546				COMMENT ;
   547				THESE ROUTINES SET UP THE START OF THE COMMAND LIST FOR A
   548				READ OR WRITE. UNICOM(U) POINTS TO THE COMMAND LIST AREA.
   549				COMMANDS ARE BILT FROM THE FRONT (LOW ADDRESS) DOWN AND
   550				DATA (FOR SEEK SET SECTOR ETC) FROM THE BACK UP. AFTER
   551				BPXWRT OR BPXRED IS CALLED, THE DATA IS AS FOLLOWS
   552
   553					A SEEK COMMAND
   554					 THE DATA TRANSFER FOR THE SEEK
   555					A SET SECTOR COMMAND
   556					 THE DATA TRANSFER FOR THE SET SECTOR
   557				#1	A SEARCH ID =
   558					 THE DATA TRANSFER FOR THE SEARCH
   559					A TIC TO THE SEARCH
   560					THE READ OR WRITE COMMAND
   561				#2	...
   562					HALTS TO START OF DATA
   563					...
   564				#3	THE DATA FOR THE SEEK (AND SEARCH ID=)
   565					(2 WORDS)
   566					THE DATA FOR THE SET SECTOR COMMAND
   567
   568				REGISTERS P1, P2, P3, AND P4 ARE ALSO SET UP FOR BPXADD AND
   569				BPXFIN.
   570				P1 LEFT HALF POINTS TO THE SEARCH (#1)
   571				P1 RIGHT HALF POINTS TO THE FIRS FREE COMMAND LOCATION (#2+1)
   572
   573				P2 CONTAINS THE NUMBER OF WORDS LEFT TO END OF TRACK OR END OF
   574					CYLINDER WHICHEVER COMES FIRST
   575
   576				P3 LEFT HALF CONTAINS A DISPATCH ADDRESS FOR BPXADD
   577				P3 RIGHT HALF CONTAINS A POINTER TO THE NEXT PLACE TO PUT A
   578					SEARCH DATA LIST (#3-2)
   579
   580				P4 CONTAINS THE NUMBER OF WORDS LEFT TO END OF CYLINDER
   581					FOR TRANSFER CONTINUATION AT INTERUPT LEVEL
   582				;
   583
   584				;SET UP P1 AND P3
   585
   586	000540'	550605	000356*	BPXSET:	HRRZ P1,UNICOM(U)
   587	000541'	564705	000540*		HLRO P3,UNICOM(U)	;COUNT AREA
   588	000542'	213000	000016		MOVNS P3
   589	000543'	271714	777776		ADDI P3,-2(P1)
   590	000544'	402005	000151*		SETZM UNISVC(U)		;CLEAR SAVE COUNT IN CASE HUNG RESTART
   591	000545'	263040	000000		POPJ P,
   592
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 13
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   593	000546'	205340	340024	BPXWRT:	MOVSI T2,(BYTE (8) WRDMOD,BPXWT)
   594	000547'	254000	000551'		JRST BPXGO
   595	000550'	205340	340030	BPXRED:	MOVSI T2,(BYTE (8) WRDMOD,BPXRD)
   596	000551'	135400	000226*	BPXGO:	LDB T3,UNYPUN
   597	000552'	270402	000061*		ADD T3,KONBSU(J)
   598	000553'	137400	001452'		DPB T3,[POINT 8,T2,23]
   599	000554'	402005	000441*		SETZM UNICCC(U)	;O COUNT SO FAR
   600	000555'	402005	000470*		SETZM UNICNA(U)	;AND NO CONTINUATION ADDRESS
   601	000556'	260040	000540'	BPXGO1:	PUSHJ P,BPXSET	;SET UP ARGUMENT
   602	000557'	275700	000001		SUBI P3,1	;SAVE 1 WORD FOR SET SECTOR ARGUMENT
   603	000560'	202354	000007		MOVEM T2,7(P1)	;STORE THE COMMAND
   604	000561'	260040	000623'		PUSHJ P,BPXSSO	;SET UP THE SEARCH DATA
   605	000562'	200411	000600'		MOVE T3,RECTBL-1(T4)	;T4 IS LEFT WITH RECORD NUMBER
   606	000563'	202416	000004		MOVEM T3,4(P3)	;SET THE SECTOR ADDRESS
   607	000564'	260040	000646'		PUSHJ P,BPXSSC	;GENERATE SEEK DATA ALREADY SET
   608	000565'	641340	000220		TLC T2,(BYTE (8) 0,XOR (SETSEC,SEEK))	;CHANGE SEEK TO SET SECTOR
   609	000566'	202354	000000		MOVEM T2,(P1)
   610	000567'	201416	000004		MOVEI T3,4(P3)
   611	000570'	505400	777700		HRLI T3,(BYTE (12) -1)
   612	000571'	202414	000001		MOVEM T3,1(P1)	;NOW HAVE SET SECTOR COMMAND
   613	000572'	271600	000002		ADDI P1,2
   614	000573'	507000	000014		HRLS P1		;SAVE POINTER TO THE SEARCH ID
   615	000574'	260040	000656'		PUSHJ P,BPXSSR	;SET UP THE SEARCH ID=
   616	000575'	271600	000002		ADDI P1,2	;POINT AFTER WHERE TRANSFER WILL GO
   617	000576'	402005	000464*		SETZM UNISWC(U)	;NO SAVE WORD COUNT
   618	000577'	505700	000776'	BPBRK1:	HRLI P3,BPXAC2	;SET INITIAL ROUTINE FOR ADD
   619							;(USED TO BE BPXA1)
   620	000600'	263040	000000		POPJ P,		;FINISHED, P4 AND P2 SET IN BPXSSO
   621
   622				;THIS TABLE IS GENERATED ON THE BASIS OF DATA FROM READ SECTOR
   623
   624					DEFINE RECGEN (A)
   625				<IRP A <	BYTE (8) A>>
   626
   627	000601'	004000	000000	RECTBL:	RECGEN <2,11,17,26,35,44,52,61,70,77,105,114,123>
   628	000602'	022000	000000
   629	000603'	036000	000000
   630	000604'	054000	000000
   631	000605'	072000	000000
   632	000606'	110000	000000
   633	000607'	124000	000000
   634	000610'	142000	000000
   635	000611'	160000	000000
   636	000612'	176000	000000
   637	000613'	212000	000000
   638	000614'	230000	000000
   639	000615'	246000	000000
   640	000616'	264000	000000		RECGEN <132,140,147,156,165>
   641	000617'	300000	000000
   642	000620'	316000	000000
   643	000621'	334000	000000
   644	000622'	352000	000000
   645
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 13-2
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   646				COMMENT ;
   647				PLANTING BREAKPOINTS IS NOW A PROBLEM. CHANGE BPBRK1 TO
   648				HRLI P3,BPXAC2	SO UNIT IS NOT STARTED AND
   649				CHANGE BPBRK2 TO JFCL SO THAT BPXFIN STARTS UNIT
   650				;
   651
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 14
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   652				;SET UP SEARCH ADDRESS
   653				;RETURNS T4=RECORD NUMBER(+1)
   654				;	CALL BPXSSO FROM BPXRED, BPXWRT, BPXPOS
   655				;	 ALSO SETS UNICYL(U) P2=WORDS TO END OF TRACK
   656				;	 P4=WORDS TO END OF CYLINDER
   657
   658	000623'			BPXSSO:
   659				IFE FTDPAG,<
   660	000623'	200405	000000*		MOVE T3,UNIBLK(U)
   661				>
   662				IFN FTDPAG,<
   663					MOVE T3,UNIPAG(U)
   664					LSH T3,P2BLSH		;CONVERT TO BLOCKS
   665				>
   666	000624'	231400	000524		IDIVI T3,BPERT		;DIVIDE BY BLOCKS/CYLINDER
   667	000625'	202405	000000*		MOVEM T3,UNICYL(U)
   668	000626'	201740	000524		MOVEI P4,BPERT		;FIND BLOCKS TO EOC
   669	000627'	274740	000011		SUB P4,T4
   670	000630'	137400	001453'		DPB T3,[POINT 32,(P3),31]	;SET CYL AND 2 BYTES OF 0
   671	000631'	200400	000011		MOVE T3,T4
   672	000632'	231400	000022		IDIVI T3,^D18		;BLOCKS/TRACK
   673				IF2,<PRINTX [BPCMSZ in COMMOD must big enough for at least 18 blocks]>
   674				;*; XP BPCMSZ,^D<18*7+1+3+2+1>	;LOADER will complain if this does not match
   675				;*; ;Above line commented out - can be more than 18 as of P035/B06.
   676	000633'	201640	000022		MOVEI P2,^D18
   677	000634'	274640	000011		SUB P2,T4		;FIND BLOCKS TO END OF TRACK
   678	000635'	313640	000017		CAMLE P2,P4
   679	000636'	200640	000017		MOVE P2,P4	;LAST TRACK ON CYL HAS ONLY 16 BLOCKS
   680	000637'	242640	000007		LSH P2,B2WLSH
   681	000640'	242740	000007		LSH P4,B2WLSH
   682	000641'	271440	000001		ADDI T4,1	;INC RECORD NUMBER
   683	000642'	137400	001454'		DPB T3,[POINT 16,1(P3),15]	;SET HEAD NUMBER
   684	000643'	137440	001455'		DPB T4,[POINT 8,1(P3),23]	;AND RECORD NUMBER
   685	000644'	275700	000002		SUBI P3,2	;ADJUST DATA POINTER
   686	000645'	263040	000000		POPJ P,
   687
   688				;SET UP A SEEK COMMAND. SOME COMMAND (READ OR WRITE) IS IN
   689				;T2.  P3 POINTS TO THE SEEK ARG
   690
   691	000646'	621340	777774	BPXSSC:	TLZ T2,(BYTE (8) 377,377)	;LEAVE DEVICE NUMBER
   692	000647'	661340	164034		TLO T2,(BYTE (8) BYTMOD,SEEK)	;SET SEEK
   693	000650'	202354	000000	BPXSC1:	MOVEM T2,(P1)
   694	000651'	205400	777200		MOVSI T3,(BYTE (12) -6)
   695	000652'	541416	000002		HRRI T3,2(P3)
   696	000653'	202414	000001		MOVEM T3,1(P1)
   697	000654'	271600	000002		ADDI P1,2
   698	000655'	263040	000000		POPJ P,
   699
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 15
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   700				;SET UP A SEARCH ID= AND BRANCH; DATA AT 2(P3)
   701
   702	000656'	621340	777774	BPXSSR:	TLZ T2,(BYTE (8) 377,377)	;LEAVE DEVICE NUMBER
   703	000657'	661340	166304		TLO T2,(BYTE (8) STROFA,SRCIDE)	;SET SEARCH AND OFFSET
   704	000660'	202354	000000		MOVEM T2,(P1)
   705	000661'	505400	777300		HRLI T3,(BYTE (12) -5)
   706	000662'	541416	000002		HRRI T3,2(P3)
   707	000663'	202414	000001		MOVEM T3,1(P1)
   708	000664'	550400	000014		HRRZ T3,P1
   709	000665'	661400	200000		TLO T3,TICBIT	;GENERATE TIC TO SEARCH ID=
   710	000666'	202414	000002		MOVEM T3,2(P1)
   711	000667'	271600	000003		ADDI P1,3
   712	000670'	263040	000000		POPJ P,
   713
   714	000671'	135340	000551*	BPXSDA:	LDB T2,UNYPUN	;GET UNIT NUMBER
   715	000672'	270342	000552*		ADD T2,KONBSU(J)	;PLUS BASE UNIT ADDRESS
   716	000673'	405340	000377		ANDI T2,377
   717	000674'	242340	000014		LSH T2,^D12	;TO CORRECT POSITION
   718	000675'	263040	000000		POPJ P,
   719
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 16
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   720				COMMENT ;
   721				ADD SOMETHING TO THE REQUEST LIST. T2 HAS TRANSFER ADDRESS
   722				T1 HAS COUNT
   723				P1-P4 ARE SET AS DESCRIBED IN BPXRED, BPXWRT. THERE IS
   724				ALWAYS ENOUGHT COMMAND LIST TO TRANSFER THE COUNT LEFT IN P2
   725				THE DISPATCH ADDRESS IS ONE OF THE FOLLOWING
   726
   727				BPXA1	ADD A TRANSFER, UNLESS AN ODD NUMBER (NOT MULT OF 200)
   728					 WORDS, START UNIT
   729				BPXA4	ADD A TRANSFER BUT SET UP THE SEARCH ID= AND DATA
   730					 FOR THE SEARCH FIRST. DO NOT START UNIT
   731				BPXAP2	FINISH A PARTIAL WORD COUNT TRANSFER AND START UNIT
   732				BPXAP3	LIKE BPXAP2 BUT DO NOT START UNIT
   733				TRNHD1	NEED A SEEK HEAD (JUST SEEK) BEFORE STARTING
   734				;
   735
   736	000676'			BPXADD:
   737				IFN FTDPAG,<;FILIO gave us pages
   738					LSH T1,P2WLSH	;Word count
   739					LSH T2,P2WLSH	;Word address
   740				>
   741	000676'	271340	000001		ADDI T2,1	;INCREMENT TRANSFER ADDRESS (FOR SETCA ADD)
   742	000677'	261040	000007	BPXAD1:	PUSH P,T2	;HERE TO CONTINUE AT INTERUPT LEVEL
   743	000700'	554400	000016		HLRZ T3,P3
   744	000701'	254010	000000		JRST (T3)	;DISPATCH
   745
   746	000702'	201400	000200	BPXA1:	MOVEI T3,200	;MAX TRANSFER WE CAN DO NOW
   747	000703'	260040	000715'		PUSHJ P,SETXFR	;SET UP THE TRANSFER
   748	000704'	254000	001003'		 JRST BPXAP1	;NOT EVEN BLOCK
   749	000705'	202414	777777		MOVEM T3,-1(P1)	;STORE TRANSFER
   750	000706'	260040	000733'		PUSHJ P,STRTUP	;START THE TRANSFER GOING
   751	000707'	322640	001053'	BPXAC3:	JUMPE P2,TRNCNT	;RAN OUT OF COUNT TO EOT
   752	000710'	326300	000762'		JUMPN T1,BPXAC1	;NOT OUT OF COUNT, CONTINUE TRANSFER
   753	000711'	505700	000775'	BPXAC4:	HRLI P3,BPXA4	;SET NEW DISPATCH ADDRESS
   754	000712'	350001	777777	T2POP1:	AOS -1(P)
   755	000713'	262040	000007	T2POPJ:	POP P,T2
   756	000714'	263040	000000		POPJ P,
   757
   758	000715'	313400	000006	SETXFR:	CAMLE T3,T1	;CHECK WORD COUNT
   759	000716'	200400	000006		MOVE T3,T1	;USE SMALLER
   760	000717'	272405	000576*		ADDM T3,UNISWC(U)
   761	000720'	274640	000010		SUB P2,T3
   762	000721'	274740	000010		SUB P4,T3
   763	000722'	200341	777777		MOVE T2,-1(P)
   764	000723'	272401	777777		ADDM T3,-1(P)	;UPDATE TRANSFER ADDRESS
   765	000724'	274300	000010		SUB T1,T3	;ADJUST COUNT
   766	000725'	450400	000000		SETCA T3,
   767	000726'	241400	777764		ROT T3,-^D12
   768	000727'	270400	000007		ADD T3,T2	;T2 HAS HAD 1 ADDED TO IT
   769	000730'	606640	000177		TRNN P2,177	;SEE IF NOW EVEN
   770	000731'	350001	000000		AOS (P)		;IT IS, SKIP RETURN
   771	000732'	263040	000000		POPJ P,		;NON-SKIP IF NOT
   772
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 17
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   773	000733'	550345	000541*	STRTUP:	HRRZ T2,UNICOM(U)
   774	000734'	505340	001500		HRLI T2,(15B11)	;START STATUS
   775	000735'	135400	001456'		LDB T3,[POINT 8,(T2),23]	;GET UNIT NUMBER
   776	000736'	137400	001433'		DPB T3,[POINT 8,T2,7]	;STORE IN COMMAND
   777	000737'	554442	000065*		HLRZ T4,KONBMX(J)
   778	000740'	270400	000011		ADD T3,T4
   779	000741'	274402	000672*		SUB T3,KONBSU(J)	;SUBTRACT OFF START
   780	000742'	202350	000000		MOVEM T2,(T3)	;AND STORE
   781	000743'	550342	000000*		HRRZ T2,KONCHN(J)
   782	000744'	256007	000000*		XCT CHNIIE(T2)
   783	000745'	256007	000442*		XCT CHNGO(T2)
   784	000746'	263040	000000		POPJ P,
   785
   786				;HERE TO CONTINUE DOING A TRANSFER
   787
   788	000747'	120416	000002	SETCMD:	DMOVE T3,2(P3)	;GET SEARCH ARG
   789	000750'	271440	010000		ADDI T4,1B23	;INCREMENT RECORD (WILL NOT OVERFLOW SEE P2 COUNT)
   790	000751'	124416	000000		DMOVEM T3,(P3)
   791	000752'	200400	000014	SETCM1:	MOVE T3,P1
   792	000753'	251414	000004		BLT T3,4(P1)	;COPY SEARCH TRANS TIC READ TRANS
   793	000754'	542714	000001		HRRM P3,1(P1)	;UPDATE SEARCH POINTER
   794	000755'	542614	000002		HRRM P1,2(P1)	;AND TIC
   795	000756'	507000	000014		HRLS P1
   796	000757'	271600	000005		ADDI P1,5	;NOW P1 IS SET FOR NEXT TIME
   797	000760'	275700	000002		SUBI P3,2	;AND P3
   798	000761'	263040	000000		POPJ P,
   799
   800	000762'	260040	000747'	BPXAC1:	PUSHJ P,SETCMD
   801	000763'	305300	000200		CAIGE T1,200	;IS THERE ENOUGH FOR A RECORD
   802	000764'	254000	000776'		JRST BPXAC2	;NO, SET UP A TRANSFER ADDRESS
   803	000765'	201400	000200		MOVEI T3,200
   804	000766'	272405	000717*		ADDM T3,UNISWC(U)
   805	000767'	272401	000000		ADDM T3,(P)	;UPDATE TRANSFER ADDRESS
   806	000770'	272414	777777		ADDM T3,-1(P1)	;AND IN THE TRANSFER
   807	000771'	275300	000200		SUBI T1,200
   808	000772'	275640	000200		SUBI P2,200
   809	000773'	275740	000200		SUBI P4,200
   810	000774'	254000	000707'		JRST BPXAC3	;CONTINUE THE TRANSFER IF MORE CAN GO
   811
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 18
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   812	000775'	260040	000747'	BPXA4:	PUSHJ P,SETCMD
   813	000776'	201400	000200	BPXAC2:	MOVEI T3,200
   814	000777'	260040	000715'		PUSHJ P,SETXFR	;SET UP THE TRANSFER
   815	001000'	254000	001005'		 JRST BPXAP4	;LIKE BPXAP1 BUT NO STAT OF UNIT
   816	001001'	202414	777777		MOVEM T3,-1(P1)
   817	001002'	254000	000707'		JRST BPXAC3	;CONTINUE TRANSFER
   818
   819	001003'	505700	001011'	BPXAP1:	HRLI P3,BPXAP2	;BPXAP1 AND BPXAP4 SAME EXCETP
   820	001004'	334000	000000		SKIPA		;FOR DISPATCH ADDRESS
   821	001005'	505700	001021'	BPXAP4:	HRLI P3,BPXAP3
   822	001006'	621400	400000		TLZ T3,(1B0)	;SET BIT 0 TO SAY CHAINED TRANS
   823	001007'	202414	777777		MOVEM T3,-1(P1)
   824	001010'	254000	000712'		JRST T2POP1	;AND RETURN TO USER
   825
   826	001011'	200400	000015	BPXAP2:	MOVE T3,P2
   827	001012'	405400	000177		ANDI T3,177	;CAN FINISH THE BLOCK
   828	001013'	260040	000715'		PUSHJ P,SETXFR
   829	001014'	254000	001040'		 JRST BPXEP2	;NOT YET EVEN, MUST BE END OF REQUEST
   830	001015'	202414	000000		MOVEM T3,(P1)	;STORE TRANSFER WORD
   831	001016'	260040	000733'		PUSHJ P,STRTUP
   832	001017'	553000	000016		HRRZS P3	;SINCE STARTUP CALLED (FOR BPBRK2)
   833	001020'	254000	001026'		JRST BPXAP5	;COMMON CODE
   834
   835	001021'	200400	000015	BPXAP3:	MOVE T3,P2
   836	001022'	405400	000177		ANDI T3,177
   837	001023'	260040	000715'		PUSHJ P,SETXFR
   838	001024'	254000	001043'		 JRST BPXEP3	;NOT YET EVEN, MUST BE END OF REQUEST
   839	001025'	202414	000000		MOVEM T3,(P1)	;SAVE TRANSFER
   840	001026'	271600	000001	BPXAP5:	ADDI P1,1
   841	001027'	550400	000016		HRRZ T3,P3
   842	001030'	275414	000000		SUBI T3,(P1)	;NO SEE HOW MUCH MORE WILL FIT
   843	001031'	231400	000007		IDIVI T3,7	;SINCE WE USED AN EXTRA WORD
   844	001032'	242400	000007		LSH T3,B2WLSH
   845	001033'	315400	000015		CAMGE T3,P2
   846	001034'	200640	000010		MOVE P2,T3	;RESET IF SMALLER NOW
   847	001035'	322640	001053'		JUMPE P2,TRNCNT	;RAN OUT OF ROOM
   848	001036'	326300	000775'		JUMPN T1,BPXA4	;CONTINUE TRANSFER IF MORE REQUEST
   849	001037'	254000	000711'		JRST BPXAC4	;ELSE RESET DISPATCH AND RETURN
   850
   851	001040'	202414	000000	BPXEP2:	MOVEM T3,(P1)
   852	001041'	260040	000733'		PUSHJ P,STRTUP	;NOT STARTED YET
   853	001042'	334000	000000		SKIPA
   854	001043'	202414	000000	BPXEP3:	MOVEM T3,(P1)	;SAVE TRANSFER REQUEST
   855	001044'	271600	000001		ADDI P1,1
   856	001045'	505700	001052'		HRLI P3,BPXEP4	;SET TO HALT IF MORE REQUESTS
   857	001046'	201640	000000		MOVEI P2,0	;MAKE IT LOOK LIKE NOT A SHORT TRANSFER
   858	001047'	205400	004000		MOVSI T3,(BYTE (8) IGNLEN)
   859	001050'	436414	777775		IORM T3,-3(P1)	;SINCE THERE IS AN EXTRA TRANSFER WORD
   860	001051'	254000	000712'		JRST T2POP1	;AND RETURN
   861
   862	001052'	256000	000000'	BPXEP4:	STOPCD	;ERROR HALT FROM ABOVE
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 19
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   863				;Here from BPXADD if P2 has gone to zero, indicating end of track.
   864				;If P4 is also zero, we have hit the end of the cylinder and should stop.
   865				;If there are more words to transfer, we have to switch heads and
   866				;continue on the next track.
   867
   868	001053'	322740	001100'	TRNCNT:	JUMPE P4,T2POP0	;STOP AT END OF CYLINDER
   869	001054'	550400	000016		HRRZ T3,P3
   870	001055'	135640	001457'		LDB P2,[POINT 8,3(P3),23]	;GET LAST RECORD NUMBER
   871	001056'	302640	000022		CAIE P2,^D18	;WAS IT RECORD 18?
   872	001057'	254000	001100'		 JRST T2POP0	;NO, COMMAND LIST MUST BE FULL
   873	001060'	275414	000002		SUBI T3,2(P1)	;SEE HOW MUCH MORE WILL FIT
   874	001061'	231400	000007		IDIVI T3,7	;(7 command words to xfer 1 block)
   875				;Make sure we don't attempt to go past end of track if command list is set for
   876				;^D25 blocks.  Fixed in P035/B06
   877	001062'	303400	000022		CAILE	T3,^D18	;More than one track's worth left?
   878	001063'	201400	000022		 MOVEI	T3,^D18	;Yes, limit ourselves so as to notice end of track
   879	001064'	242400	000007		LSH T3,B2WLSH	;# of words that can be handled (assuming full blocks)
   880	001065'	622300	000177		TRZE T1,177	;GET RID OF PARTIAL REQUEST
   881	001066'	322300	001100'		 JUMPE T1,T2POP0;PARTIAL REQUEST AND NO MORE, GET LATER
   882	001067'	322300	001103'		JUMPE T1,TRNCN1	;NOTHING MORE REQUESTED THIS TIME
   883	001070'	315740	000006		CAMGE P4,T1
   884	001071'	334300	000017		 SKIPA T1,P4	;PICK SMALLER , DO NOT CROSS CYL
   885	001072'	200740	000006		MOVE P4,T1	;BUT MAKE SURE TRANSFER STOPS ON EVEN REC BOUNDARY
   886	001073'	317300	000010		CAMG T1,T3	;WILL REMAINDER OF TRANSFER FIT?
   887	001074'	254000	001106'		 JRST TRNHED	;YES
   888	001075'	262045	000555*		POP P,UNICNA(U)	;NO, SET TO CONTINUE AT INTERUPT LEVEL
   889	001076'	202305	000466*		MOVEM T1,UNICNC(U)
   890	001077'	334000	000000		SKIPA		;DO NOT NEED EXTRA POP (IN T2POP0)
   891	001100'	262040	000007	T2POP0:	 POP P,T2
   892	001101'	201640	000000		MOVEI P2,0	;SO IT DOES NOT THINK ITS A SHORT TRANS
   893	001102'	263040	000000		POPJ P,		;RETURN TO USER, NO MORE POSSIBLE THIS TIME
   894
   895	001103'	305400	001000	TRNCN1:	CAIGE T3,4_B2WLSH
   896	001104'	254000	001100'		 JRST T2POP0	;NOT VERY MUCH SPACE, SAY OUT OF ROOM
   897	001105'	505700	001112'		HRLI P3,TRNHD1	;SET NEW TRANSFER ADDRESS
   898	001106'	200640	000010	TRNHED:	MOVE P2,T3
   899	001107'	315740	000015		CAMGE P4,P2
   900	001110'	200640	000017		MOVE P2,P4	;NOW HAVE RESET END OF LIST POINTERS
   901	001111'	322300	000712'		JUMPE T1,T2POP1	;FROM TRNCN1 ABOVE
   902	001112'	120416	000002	TRNHD1:	DMOVE T3,2(P3)
   903	001113'	270440	001460'		ADD T4,[BYTE (8) 0,0,-^D17]	;INC HEAD, REC TO 1
   904	001114'	124416	000000		DMOVEM T3,(P3)
   905	001115'	275700	000002		SUBI P3,2
   906	001116'	554340	000014		HLRZ T2,P1
   907	001117'	200347	000003		MOVE T2,3(T2)	;GET SOME COMMAND
   908	001120'	260040	000646'		PUSHJ P,BPXSSC	;FOR SET SEEK
   909	001121'	271700	000002		ADDI P3,2	;NEED TO FOR SETCMD
   910	001122'	260040	000752'		PUSHJ P,SETCM1	;RESET COMMAND
   911	001123'	254000	000776'		JRST BPXAC2	;AND GO FINISH UP
   912
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 20
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   913				;FINISH UP THE COMMAND LIST
   914
   915	001124'	606640	000177	BPXFIN:	TRNN P2,177	;IS THIS TRANSFER EVEN?
   916	001125'	254000	001132'		JRST BPXFN1	;YES
   917	001126'	205400	004000		MOVSI T3,(BYTE (8) IGNLEN)	;SET TO IGNORE LENGTH ERR
   918	001127'	436414	777776		IORM T3,-2(P1)	;CAN ONLY BE 1 SHORT TRANSFER WORD
   919	001130'	205400	400000		MOVSI T3,(1B0)
   920	001131'	436414	777777		IORM T3,-1(P1)	;FINISH ON DATA CHAIN
   921	001132'	205400	400000	BPXFN1:	MOVSI T3,(BYTE (8) 200)
   922	001133'	202414	000000		MOVEM T3,(P1)	;SET HALT AND DO NOT WAIT FOR CLR STS
   923	001134'	506605	000766*		HRLM P1,UNISWC(U)	;SAVE END OF UNIT POINTER
   924	001135'	554340	000016		HLRZ T2,P3	;CHECK ON DISPATCH ADDRESS
   925	001136'			BPBRK2:;CAIN T2,BPXAP2	;ALWAYS START UP. (USED TO BE STARTED SOMETIMES.)
   926	001136'	324740	000733'		PJRST STRTUP	;HAVE NOT STARTED UNIT YET
   927	001137'	263040	000000		POPJ P,
   928
   929	001140'	135700	000671*	BPXFN2:	LDB P3,UNYPUN
   930	001141'	550345	000733*		HRRZ T2,UNICOM(U)	;BASE ADDRESS OF CMD LST
   931	001142'	260040	000061'		PUSHJ P,STRTU	;PUT THE START IN THE BLOCK MUX LIST
   932	001143'	550302	000743*		HRRZ T1,KONCHN(J)
   933	001144'	256006	000744*		XCT CHNIIE(T1)	;MAKEE SURE INTERUPT ENABLED
   934	001145'	256006	000745*		XCT CHNGO(T1)	;SET GO FLAG
   935	001146'	263040	000000		POPJ P,
   936
   937				;POSITION REQUEST
   938
   939	001147'	260040	000540'	BPXPOS:	PUSHJ P,BPXSET	;SET UP DATA ADDRESSES
   940	001150'	260040	000623'		PUSHJ P,BPXSSO	;SET UP SEAR ADDRESS
   941	001151'	260040	000671'		PUSHJ P,BPXSDA	;JUST LIKE BPXSSC BUT USE SEEKCY NOT SEEK
   942	001152'	661340	164054		TLO T2,(BYTE (8) BYTMOD,SEEKCY)	;SO CAN TELL AT INT. LEV.
   943	001153'	260040	000650'		PUSHJ P,BPXSC1	;SET THE SEEK
   944	001154'	505700	001011'		HRLI P3,BPXAP2	;TO FORCE STARTUP
   945	001155'	254000	001132'		JRST BPXFN1	;START DEVICE
   946
   947				;RECALIBRATE REQUEST
   948
   949	001156'	260040	000671'	BPXRCL:	PUSHJ P,BPXSDA	;SET DEVICE ADDRESS
   950	001157'	661340	504114		TLO T2,(BYTE (8) NOXFR,RECAL)
   951	001160'	200605	001141*		MOVE P1,UNICOM(U)
   952	001161'	202314	000000		MOVEM T1,(P1)	;STORE
   953	001162'	505700	001011'	BPXRCC:	HRLI P3,BPXAP2	;TO FORCE STARTUP
   954	001163'	344600	001132'		AOJA P1,BPXFN1	;AND START
   955
   956
   957	001164'	260040	000540'	BPXLTM:	PUSHJ P,BPXSET	;SET UP COMMAND POINTERS
   958	001165'	260040	000671'		PUSHJ P,BPXSDA	;SET THE DEVICE ADDRESS
   959	001166'	661340	165220		TLO T2,(BYTE (8) BYTMOD,RRBL)
   960	001167'	202354	000000		MOVEM T2,(P1)
   961	001170'	205400	775000		MOVSI T3,(BYTE (12) -^D24)
   962	001171'	541405	000265*		HRRI T3,UNISND(U)	;SENSE DATA HERE
   963	001172'	202414	000001		MOVEM T3,1(P1)
   964	001173'	344600	001162'		AOJA P1,BPXRCC	;THIS WILL INCREMENT ONCE MORE, SET STOP, START UNIT, AND EXIT
   965
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 21
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

   966	001174'	135340	001140*	BPXSTP:	LDB T2,UNYPUN	;GET THE UNIT NUMBER
   967	001175'	554402	000737*		HLRZ T3,KONBMX(J)	;AND THE BLOCK MUX ADDRESS
   968	001176'	270340	000010		ADD T2,T3
   969	001177'	135400	001461'		LDB T3,[POINT 4,(T2),11]	;GET THE CONTROL CODE
   970	001200'	306400	000017		CAIN T3,17	;AND SEE IF ITS STOP
   971	001201'	263040	000000		POPJ P,		;YES, FORCE UNIT RESTART
   972	001202'	550342	001143*		HRRZ T2,KONCHN(J)	;GET A POINTER TO CHANNEL
   973	001203'	200407	000000*		MOVE T3,CHNACT(T2)	;COUNT OF INTERUPTS THIS CHANNEL
   974	001204'	312405	000000*		CAME T3,UNIACT(U)	;SAME AS FOR UNIT
   975	001205'	254000	001212'		JRST BPXST2		;NO, MAYBE MISSED GO OR SOME OTHER
   976								;UNIT HAS DONE A SEL RESET OR JUST
   977								;WAITING FOR SOMEONE W`ELSE
   978	001206'	200407	001145*		MOVE T3,CHNGO(T2)	;AN APPROPRIATE COMMAND
   979	001207'	640400	000700		TRC T3,7B29		;CONVERT GO TO RESET (SELECTIVE)
   980	001210'	256000	000010		XCT T3			;ISSUE IT
   981	001211'	354007	001203*		AOSA CHNACT(T2)		;AND PREVENT ONES FROM OTHER UNITS
   982								;SEL RESET SHOULD CAUSE CONTROL CHECK ON HUNG UNIT
   983	001212'	202405	001204*	BPXST2:	MOVEM T3,UNIACT(U)	;SO WE KNOW NEXT TIME THROUGH
   984	001213'	256007	001144*		XCT CHNIIE(T2)		;ENABLE AND GO JUST IN CASE
   985	001214'	256007	001206*		XCT CHNGO(T2)	;WE MAY HAVE LOST A CONO BIT
   986	001215'	254000	000000*		JRST CPOPJ1		;FORCE NO RESTART IN DEV INDEP. CODE
   987
   988	001216'	550402	001202*	BPXUPA:	HRRZ T3,KONCHN(J)
   989	001217'	135340	001462'		LDB T2,[POINT 7,CHNGO(T3),9]	;GET DEVICE
   990	001220'	200300	001463'		MOVE T1,[CONI T1]
   991	001221'	137340	001464'		DPB T2,[POINT 7,T1,9]
   992	001222'	256000	000006		XCT T1
   993	001223'	322300	000000*		JUMPE T1,CPOPJ	;NONE, NO SA-10
   994	001224'	260040	001242'		PUSHJ P,RSTSA
   995	001225'	550342	000741*		HRRZ T2,KONBSU(J)
   996	001226'	201300	001240'		MOVEI T1,UPCHK
   997	001227'	260040	001246'		PUSHJ P,DOIT
   998	001230'	323300	001223*		JUMPLE T1,CPOPJ	;DID NOT, GIVE UP
   999	001231'	205300	100000		MOVSI T1,SELER
  1000	001232'	612311	000000		TDNE T1,(T4)	;IS IT SELECT ERROR?
  1001	001233'	263040	000000		POPJ P,		;YES, OFF-LINE
  1002	001234'	201310	000000*		MOVEI T1,CHNBMX(T3)
  1003	001235'	661300	600000		TLO T1,600000
  1004	001236'	202311	777777		MOVEM T1,-1(T4)	;RESET LIST BASE POINTER TO BLOCK MULTIPLEXER MODE
  1005	001237'	254000	001215*		JRST CPOPJ1
  1006
  1007	001240'	504014	000000	UPCHK:	BYTE (8) NOXFR,3	;NO-OP
  1008	001241'	000000	000000		0
  1009
  1010	001242'	200310	001214*	RSTSA:	MOVE T1,CHNGO(T3)
  1011	001243'	541300	600000		HRRI T1,1B18!1B19
  1012	001244'	256000	000006		XCT T1
  1013	001245'	263040	000000		POPJ P,
  1014
  1015	001246'	200450	000536*	DOIT:	MOVE T4,CHNSTB(T3)	;POINTER TO BASE ADR
  1016	001247'	137340	001465'		DPB T2,[POINT 8,(T1),23]	;SET DEVICE
  1017	001250'	661300	200000		TLO T1,(1B1)
  1018	001251'	250311	777777		EXCH T1,-1(T4)	;SET CMD
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 21-2
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

  1019	001252'	402011	000000		SETZM (T4)
  1020	001253'	261040	000006		PUSH P,T1
  1021				IFCPU (KL),<;IF KL, MUST SWEEP CACHE TO GET COMMAND TO MEMORY.
  1022	001254'	260040	000000*		CSHUNL			;START SWEEP, GET OLD NUMBER IN T1
  1023	001255'	316300	000000*		CAMN T1,CSUCNT##	;WAIT UNTIL NUMBER INCREMENTS
  1024	001256'	254000	001255'		 JRST	.-1		;BEFORE SETTING GO FLAG IN CHANNEL.
  1025				>;END IFCPU (KL)
  1026	001257'	200310	001242*		MOVE T1,CHNGO(T3)
  1027	001260'	620300	000007		TRZ T1,7
  1028	001261'	256000	000006		XCT T1
  1029	001262'	201300	141520		MOVEI T1,^D50000
  1030	001263'	336011	000000		SKIPN (T4)
  1031	001264'	367300	001263'		SOJG T1,.-1
  1032	001265'	262051	777777		POP P,-1(T4)
  1033	001266'	263040	000000		POPJ P,
  1034
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 22
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

  1035	001267'	135340	001174*	BPXCPY:	LDB T2,UNYPUN
  1036	001270'	210400	000007		MOVN T3,T2
  1037	001271'	205300	400000		MOVSI T1,(1B0)	;SET A BIT FLAG THAT UNIT IS IN TEST
  1038	001272'	242310	000000		LSH T1,(T3)
  1039	001273'	436302	000232*		IORM T1,KONCPY(J)
  1040	001274'	260040	000671'		PUSHJ P,BPXSDA	;SET CAPACITY FLAG
  1041	001275'	661340	164054		TLO T2,(BYTE (8) BYTMOD,SEEKCY)
  1042	001276'	200305	001160*		MOVE T1,UNICOM(U)
  1043	001277'	202346	000000		MOVEM T2,(T1)
  1044	001300'	200340	001351'		MOVE T2,SEK500	;A SEEK TO CYL 500
  1045	001301'	202346	000001		MOVEM T2,1(T1)
  1046	001302'	205340	400000		MOVSI T2,(BYTE (8) 200)
  1047	001303'	202346	000002		MOVEM T2,2(T1)
  1048	001304'	201300	000764		MOVEI T1,^D500
  1049	001305'	202305	000625*		MOVEM T1,UNICYL(U)
  1050	001306'	402005	000000*		SETZM UNIONC(U)		;SET MESSAGE -1 FOR OFF-LINE
  1051	001307'	254000	001140'		JRST BPXFN2	;AND START UP
  1052
  1053				;HERE WHEN WE GET AN INTERUPT FROM THE UNIT IN TEST
  1054
  1055	001310'	200345	001305*	BPXCNX:	MOVE T2,UNICYL(U)
  1056	001311'	302340	000764		CAIE T2,^D500
  1057	001312'	254000	001373'		JRST BPXCP2	;PASS 2 DATA
  1058	001313'	622600	000040		TRZE P1,ERRCMR	;IS COMMAND REJECT ON?
  1059	001314'	634400	000010		TDZA T3,T3	;YES, TYPE 0 MOD I
  1060	001315'	201400	000001		MOVEI T3,1	;NO, TYPE 1 MOD II
  1061	001316'	137400	000000*		DPB T3,UNYUTP
  1062	001317'	326600	001370'		JUMPN P1,ERROFL	;ANYTHING ELSE IS AN ERROR, CALL IT OFF-LINE
  1063	001320'	550345	001276*		HRRZ T2,UNICOM(U)
  1064	001321'	540300	000007		HRR T1,T2
  1065	001322'	505300	001354'		HRLI T1,WRT100	;NOW TRY TO WRITE ON RECORD 100
  1066	001323'	251307	000011		BLT T1,11(T2)	;PUT IN COMMAND LIST
  1067	001324'	272347	000006		ADDM T2,6(T2)	;ADJUST THE TIC
  1068	001325'	135300	001267*		LDB T1,UNYPUN
  1069	001326'	270302	001225*		ADD T1,KONBSU(J)	;GENERATE UNIT NUMBER
  1070	001327'	137300	001456'		DPB T1,[POINT 8,(T2),23]
  1071	001330'	271340	000002		ADDI T2,2
  1072	001331'	137300	001456'		DPB T1,[POINT 8,(T2),23]	;AND IN SEEK
  1073	001332'	271340	000002		ADDI T2,2
  1074	001333'	137300	001456'		DPB T1,[POINT 8,(T2),23]	;AND IN SEARCH ID =
  1075	001334'	271340	000003		ADDI T2,3
  1076	001335'	137300	001456'		DPB T1,[POINT 8,(T2),23]	;AND IN WRITE
  1077	001336'	550345	001320*		HRRZ T2,UNICOM(U)
  1078	001337'	262040	000006		POP P,T1	;CLEAR STACK
  1079	001340'	402005	001310*		SETZM UNICYL(U)
  1080	001341'	550402	001326*		HRRZ T3,KONBSU(J)	;GET BASE UNIT ADDRESS
  1081	001342'	270400	000016		ADD T3,P3
  1082	001343'	137400	001456'		DPB T3,[POINT 8,(T2),23]	;AND PUT UNIT NUMBER IN SENSE CMD
  1083	001344'	260040	000063'		PUSHJ P,STRTU1	;FILL IN BLOCK MX LIST
  1084	001345'	254000	000031'		JRST DISMIS	;AND GO
  1085
  1086				;BPXKON DOESN'T NEED TO DO ANYTHING SPECIAL FOR HARD OR SOFT ERRORS.
  1087
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 22-2
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

  1088	001346'	263040	000000	BPXHRD::POPJ	P,
  1089	001347'	263040	000000	BPXSFT::POPJ	P,
  1090	001350'	263040	000000	BPXOFS::POPJ	P,		;NO OFFSET RECOVERY FOR BP UNITS.
  1091
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 23
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

  1092	001351'	000000	000000*	SEK500:	BYTE (12) -6 (24) .+1
  1093	001352'	000000	017500		BYTE (16) 0,^D500,0
	001353'	000000	000000
  1094
  1095	001354'	164054	000000	WRT100:	BYTE (8) BYTMOD,SEEKCY
  1096	001355'	000000	000000*		BYTE (12) -6 (24) SEK0	;JUST SO IT LOOKS LIKE POSITION
  1097	001356'	164034	000000		BYTE (8) BYTMOD,SEEK
  1098	001357'	000000	000000*		BYTE (12) -6 (24) SEK0	;SO IT REALLY POSITIONS
  1099	001360'	166304	000000		BYTE (8) BYTMOD+OFFSET,SRCIDE
  1100	001361'	000000	000000*		BYTE (12) -5 (24) SEK0
  1101	001362'	200000	000004		TICBIT,,4
  1102	001363'	164024	000000		BYTE (8) BYTMOD,BPXWT
  1103	001364'	000000	000000*		BYTE (12) -1 (24) SEK0
  1104	001365'	400000	000000		BYTE (8) 200
  1105
  1106	001366'	000000	000000	SEK0:	BYTE (16) 0,0,0 (8) 100	;CYL 0 HEAD 0 REC 100
	001367'	000001	000000
  1107
  1108	001370'	201340	000000*	ERROFL:	MOVEI T2,%OFLER	;SAY OFF-LINE BECAUSE OF ERROR
  1109	001371'	202345	001306*	ERROF1:	MOVEM T2,UNIONC(U)
  1110	001372'	254000	000232'		JRST OFLIN2		;SEN OFF-LINE SIGNAL
  1111
  1112	001373'	201400	000000	BPXCP2:	MOVEI T3,0	;IN CASE WE CAN WRITE
  1113	001374'	322600	001403'		JUMPE P1,BPXCDN	;FINISHED, NO ERROR
  1114	001375'	201340	000000*		MOVEI T2,%OFLFM	;BAD FORMAT
  1115	001376'	602600	020000		TRNE P1,ERRSRC	;NO RECORD FOUND?
  1116	001377'	254000	001371'		JRST ERROF1
  1117	001400'	630600	001466'		TDZ P1,[ERRWPT,,ERRCMR]	;RESET WRITE PROTECT
  1118	001401'	326600	001370'		JUMPN P1,ERROFL	;IF ANY OTHERS, ITS AN ERROR
  1119	001402'	205400	200000		MOVSI T3,(1B1)	;SAY WRITE PROTECT
  1120	001403'	202405	001371*	BPXCDN:	MOVEM T3,UNIONC(U) ;STORE 1B1 FOR ONCDSK
  1121	001404'	205340	001000		MOVSI	T2,(0B0+1B8)	;1 block per record when formatted in blocks
  1122	001405'	202345	000000*		MOVEM	T2,UNICHR##(U)
  1123	001406'	135400	001316*		LDB T3,UNYUTP
  1124	001407'	135340	001422'		LDB T2,CPYBPT
  1125	001410'	137340	000000*		DPB T2,UNYBPT
  1126	001411'	135340	001423'		LDB T2,CPYBPY
  1127	001412'	242340	777776		LSH	T2,-2
  1128	001413'	137340	000000*		DPB T2,UNYPPY
  1129	001414'	135340	001424'		LDB T2,CPYBPU
  1130	001415'	242340	777776		LSH	T2,-2
  1131	001416'	202345	000000*		MOVEM T2,UNIPPU(U)
  1132	001417'	412302	001273*		ANDCAM T1,KONCPY(J)	;RESET TEST BIT
  1133	001420'	402005	000146*		SETZM UNISNC(U)	;ZERO SENSE COUNT
  1134	001421'	254000	000134'		JRST POSDIS	;AND GIVE INTERUPT TO FILSER
  1135
  1136	001422'	360610	001425'	CPYBPT:	POINT 6,CPYDAT(T3),5	;BLOCKS/TRACK
  1137	001423'	241210	001425'	CPYBPY:	POINT 10,CPYDAT(T3),15	;BLOCKS/CYLINDER
  1138	001424'	002410	001425'	CPYBPU:	POINT 20,CPYDAT(T3),35	;BLOCKS/UNIT
  1139
  1140					RADIX 10
  1141	001425'	222520	414220	CPYDAT:	BYTE (6) 18 (10) BPERT (20) BPERT*404
  1142	001426'	222521	030440		BYTE (6) 18 (10) BPERT (20) BPERT*808
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 23-2
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

  1143
  1144					RADIX 8
  1145
  1146	001427'	140400	000006		$END	(BPX)

  1147	001430'	241006	000000

  1148	001431'	200345	001336*

  1149	001432'	254000	000057'

  1150	001433'	341000	000007

  1151	001434'	426063	646244

  1152	001435'	143005	000005*

  1153	001436'	242005	000004*

  1154	001437'	041005	000003*

  1155	001440'	201000	000014

  1156	001441'	042005	000004*

  1157	001442'	301315	000000

  1158	001443'	003015	000000

  1159	001444'	111500	000007

  1160	001445'	002200	000377*

  1161	001446'	301307	000000

  1162	001447'	301300	000006

  1163	001450'	141016	000000

  1164	001451'	242000	000006

  1165	001452'	141000	000007

  1166	001453'	044016	000000

  1167	001454'	242016	000001

  1168	001455'	141016	000001

  1169	001456'	141007	000000

  1170	001457'	141016	000003

BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 23-3
BPXKON.MAC	17-SEP-87 16:40		S.MAC - with system parameter file for P035/D, January 1988

  1171	001460'	000003	570000

  1172	001461'	300407	000000

  1173	001462'	320710	001257*

  1174	001463'	700240	000006

  1175	001464'	320700	000006

  1176	001465'	141006	000000

  1177	001466'	000400	000040

  1178						;End of BPXKON (BPXLIT: BPXEND:)
  1179
NO ERRORS DETECTED
PROGRAM BREAK IS 001467
7K CORE USED
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 24
BPXKON.MAC	17-SEP-87 16:40		SYMBOL TABLE

ANYERR		165314	SPD	BPXSTP		001174'	INT	DTAUNC		000345'		KCMRER		000435'	EXT
ATTEN		001000	SPD	BPXUPA		001216'	INT	EPT		000000	EXT	KONBMX		001175'	EXT
B2WLSH		000007	SPD	BPXWRT		000546'	INT	EPT.PN		000000	EXT	KONBSU		001341'	EXT
BPBRK1		000577'		BPXWT		000005	SPD	EPTPG0		000200	SIN	KONCHN		001216'	EXT
BPBRK2		001136'		BUSIER		040000	SPD	EQCHK		000235'		KONCPY		001417'	EXT
BPERT		000524	SPD	BUSOPA		000221'		ERRATN		000002	SPD	KONENC		000100'	
BPSTRD		000123'		BUSY		000100	SPD	ERRBIP		000200	SPD	KONEND		000102'	
BPXA1		000702'		BYT0		000170'		ERRBOP		000100	SPD	KONPTR		000112'	EXT
BPXA4		000775'		BYT0T		000171'		ERRBSY		000001	SPD	LENERR		004000	SPD
BPXAC1		000762'		BYT1T		000201'		ERRCHK		000036'		LOKRCV		000315'	
BPXAC2		000776'		BYTARG		000371'		ERRCM1		000216'		LSTCNT		000406'	
BPXAC3		000707'		BYTMOD		000072	SPD	ERRCMR		000040	SPD	MEMERR		000524'	
BPXAC4		000711'		CHAIN		000020	SPD	ERRCNT		400000	SPD	NODIE		000000	EXT
BPXAD1		000677'		CHKBSY		000071'		ERRCOM		000214'		NOMEMT		000200	SPD
BPXADD		000676'	INT	CHNACT		001211'	EXT	ERRCON		000100	SPD	NOREC		000246'	
BPXAP1		001003'		CHNBMX		001234'	EXT	ERRDT0		000250'		NOTRN		000341'	
BPXAP2		001011'		CHNCLR		000443'	EXT	ERRDTA		200000	SPD	NOXFR		000242	SPD
BPXAP3		001021'		CHNGO		001462'	EXT	ERREQC		000020	SPD	OFFSET		000001	SPD
BPXAP4		001005'		CHNIIE		001213'	EXT	ERREQP		000010	SPD	OFLIN		000224'	
BPXAP5		001026'		CHNMER		000525'	EXT	ERRINV		040000	SPD	OFLIN2		000232'	
BPXCDN		001403'		CHNSTB		001246'	EXT	ERRLEN		000040	SPD	OVRUN		000212'	
BPXCNX		001310'		CLRPT	701100	000000		ERRNO		000213'		P		000001	INT
BPXCP2		001373'		CMDRJC		000252'		ERRNXM		004000	SPD	P1		000014	INT
BPXCPY		001267'	INT	CNTBAD		000414'		ERROF1		001371'		P2		000015	INT
BPXCUB		000103'	EXT	CNTDON		000412'		ERROFL		001370'		P3		000016	INT
BPXEND		001466'	INT	CNTLP		000360'		ERRONE		000222'		P4		000017	INT
BPXEP2		001040'		CONERR		020000	SPD	ERROR		000474'		PG		000003	INT
BPXEP3		001043'		CPOPJ		001230'	EXT	ERROVR		002000	SPD	PGE.A		400000	SIN
BPXEP4		001052'		CPOPJ1		001237'	EXT	ERRPAR		010000	SPD	PGE.P		200000	SIN
BPXFIN		001124'	INT	CPUKL		000002	SPD	ERRPRT		000400	SPD	PGE.W		100000	SIN
BPXFN1		001132'		CPUTYP		000002	SPD	ERRRCV		100000	SPD	PJRST	324740	000000	
BPXFN2		001140'		CPYBPT		001422'		ERRSEL		000200	SPD	POSDIS		000134'	
BPXGO		000551'		CPYBPU		001424'		ERRSEN		000145'		POSINT		000127'	
BPXGO1		000556'		CPYBPY		001423'		ERRSRC		020000	SPD	POSNTS		000126'	
BPXHRD		001346'	INT	CPYDAT		001425'		ERRTEN		000241'		PROTEC		000211'	
BPXINT		000003'	INT	CPZZ		000001	SPD	ERRUNK		001000	SPD	RDSTS		000045'	
BPXKON		000000'	ENT	CRST		000106'		ERRUXC		000004	SPD	RDSTSS		000057'	
BPXLIT		001427'	INT	CSUCNT		001255'	EXT	ERRWPT		000400	SPD	RECAL		000023	SPD
BPXLTM		001164'	INT	CSUNL		001254'	EXT	FILDIS		000136'		RECTBL		000601'	
BPXOFS		001350'	INT	CUBSY		000073'		FILDS1		000137'		RRBL		000244	SPD
BPXPOS		001147'	INT	CUEND		000200	SPD	FILFAK		000437'		RSTSA		001242'	
BPXRCC		001162'		CURUPT		000000	EXT	FILINT		000144'	EXT	RTYCNT		000257'	
BPXRCL		001156'	INT	DATA		000347'		FINRCV		000325'		RTYDT0		000263'	
BPXRD		000006	SPD	DATACK		000013'		FNDRCV		000330'		RTYONE		000261'	
BPXRED		000550'	INT	DEVBSY		000117'		FTDPAG		000000	SIN	RTYTEN		000262'	
BPXSC1		000650'		DEVEND		000020	SPD	GORCV		000306'		RTYZRO		000260'	
BPXSDA		000671'		DIE		000000'	EXT	IGNLEN		000002	SPD	S$ENTR	777777	777775	SIN
BPXSET		000540'		DISMIS		000031'		INVTRK		000247'		S$HALT	777777	777777	SIN
BPXSFT		001347'	INT	DISMS1		000030'		J		000002	INT	S$NAME		000000'	SPD
BPXSSC		000646'		DOIT		001246'		KCMDTA		000431'	EXT	S$NONA		000000	SIN
BPXSSO		000623'		DTACHK		000264'		KCMERR		000434'	EXT	S$TEMP		000000	SPD
BPXSSR		000656'		DTADON		000423'		KCMOFL		000233'	EXT	S$XCT	777777	777776	SIN
BPXST2		001212'		DTATRN		000376'		KCMPOS		000134'	EXT	SEEK		000007	SPD
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88 PAGE 24-2
BPXKON.MAC	17-SEP-87 16:40		SYMBOL TABLE

SEEKCY		000013	SPD	UNYBPT		001410'	EXT	
SEK0		001366'		UNYPPY		001413'	EXT	
SEK500		001351'		UNYPUN		001325'	EXT	
SELER		100000	SPD	UNYUTP		001406'	EXT	
SELERR		000521'		UPCHK		001240'		
SENSE		000004	SPD	UXCP		000004	SPD	
SETCM1		000752'		WRDMOD		000160	SPD	
SETCMD		000747'		WRT100		001354'		
SETSEC		000043	SPD	XCTCMD		000040	SPD	
SETXFR		000715'		%ERR		777000	SIN	
SRCIDE		000061	SPD	%ERR.N		000777	SIN	
STROFA		000073	SPD	%OFLER		001370'	EXT	
STRTU		000061'		%OFLFM		001375'	EXT	
STRTU1		000063'		
STRTUP		000733'		
STSMOD		000400	SPD	
T1		000006	INT	
T2		000007	INT	
T2POP0		001100'		
T2POP1		000712'		
T2POPJ		000713'		
T3		000010	INT	
T4		000011	INT	
TICBIT		200000	SPD	
TRBIT		000100	SPD	
TRBYTE		000010	SPD	
TRNCN1		001103'		
TRNCNT		001053'		
TRNHD1		001112'		
TRNHED		001106'		
TRTAP		000110	SPD	
TRWORD		000000	SPD	
U		000005	INT	
UCHK		000010	SPD	
UNIACT		001212'	EXT	
UNIBLK		000623'	EXT	
UNICCC		000554'	EXT	
UNICHR		001405'	EXT	
UNICNA		001075'	EXT	
UNICNC		001076'	EXT	
UNICOM		001431'	EXT	
UNICYL		001340'	EXT	
UNIONC		001403'	EXT	
UNIPPU		001416'	EXT	
UNIRCT		000422'	EXT	
UNISCM		000145'	EXT	
UNISNC		001420'	EXT	
UNISND		001171'	EXT	
UNISNS		000052'	EXT	
UNISVC		000544'	EXT	
UNISWC		001134'	EXT	

BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88
BPXKON.MAC	17-SEP-87 16:40		Symbol cross reference

ANYERR	   139	   163#
ATTEN	    85#	   163	   521
B2WLSH	   680	   681	   844	   879	   895
BPBRK1	   495	   618#
BPBRK2	   925#
BPERT	   124#	   485	   666	   668	  1141	  1142
BPSTRD	   224	   227#	   230
BPXA1	   746#
BPXA4	   753	   812#	   848
BPXAC1	   752	   800#
BPXAC2	   618	   802	   813#	   911
BPXAC3	   751#	   810	   817
BPXAC4	   753#	   849
BPXAD1	   499	   742#
BPXADD	    21	   736#
BPXAP1	   748	   819#
BPXAP2	   819	   826#	   944	   953
BPXAP3	   821	   835#
BPXAP4	   815	   821#
BPXAP5	   833	   840#
BPXCDN	  1113	  1120#
BPXCNX	   237	  1055#
BPXCP2	  1057	  1112#
BPXCPY	    21	  1035#
BPXCUB	    30%	   203	   208	   209
BPXEND	  1178#
BPXEP2	   829	   851#
BPXEP3	   838	   854#
BPXEP4	   856	   862#
BPXFIN	    21	   501	   915#
BPXFN1	   916	   921#	   945	   954
BPXFN2	   929#	  1051
BPXGO	   594	   596#
BPXGO1	   601#
BPXHRD	  1088#
BPXINT	    21	   135#
BPXKON	    11	    12#	    15
BPXLIT	  1146#
BPXLTM	    20	   957#
BPXOFS	  1090#
BPXPOS	    20	   939#
BPXRCC	   953#	   964
BPXRCL	    20	   949#
BPXRD	    95#	   595
BPXRED	    20	   595#
BPXSC1	   693#	   943
BPXSDA	   714#	   941	   949	   958	  1040
BPXSET	   479	   586#	   601	   939	   957
BPXSFT	  1089#
BPXSSC	   607	   691#	   908
BPXSSO	   604	   658#	   940
BPXSSR	   615	   702#
BPXST2	   975	   983#
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88
BPXKON.MAC	17-SEP-87 16:40		Symbol cross reference

BPXSTP	    20	   966#
BPXUPA	    21	   988#
BPXWRT	    20	   593#
BPXWT	    96#	   593	  1102
BUSIER	    80#	   163	   517
BUSOPA	   272	   301#
BUSY	    88#	   163	   167	   519
BYT0	   263	   268#
BYT0T	   268	   270#
BYT1T	   280#
BYTARG	   418#	   422
BYTMOD	   117#	   692	   942	   959	  1041	  1095	  1097	  1099	  1102
CHAIN	   109#	   117	   119	   120
CHKBSY	   168	   198#
CHNACT	    34%	   973	   981
CHNBMX	    34%	  1002
CHNCLR	    34%	   160	   245	   470
CHNGO	    34%	   159	   244	   469	   783	   934	   978	   985	   989	  1010	  1026
CHNIIE	    34%	   782	   933	   984
CHNMER	    34%	   532
CHNSTB	    34%	   135	   138	   158	   176	   253	   364	   400	   508	   535	   541	  1015
CMDRJC	   270	   331#
CNTBAD	   439#
CNTDON	   410	   412	   419	   437#
CNTLP	   409#	   414	   421	   430
CONERR	    81#	   163	   515
CPOPJ	    48%	   993	   998
CPOPJ1	    48%	   986	  1005
CPUKL	  1021
CPUTYP	  1021
CPYBPT	  1124	  1136#
CPYBPU	  1129	  1138#
CPYBPY	  1126	  1137#
CPYDAT	  1136	  1137	  1138	  1141#
CPZZ	  1021#	  1021
CRST	   212#	   217	   220
CSUCNT	  1023%	  1023
CSUNL	  1022%	  1022
CUBSY	   200#
CUEND	    87#	   163	   169	   204	   222
CURUPT	    45%
DATA	   147	   400#
DATACK	   143#	   260	   299
DEVBSY	   199	   222#
DEVEND	    91#	   222
DIE	    11	    11%	    12
DISMIS	   157#	   185	   206	  1084
DISMS1	   143	   156#	   266
DOIT	   997	  1015#
DTACHK	   274	   346#
DTADON	   405	   438	   441	   446#
DTATRN	   416	   424#	   431
DTAUNC	   348	   397#
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88
BPXKON.MAC	17-SEP-87 16:40		Symbol cross reference

EPT	    45%	   389
EPT.PN	    45%
EPTPG0	   389
EQCHK	   273	   315#
ERRATN	    68#	   522
ERRBIP	    56#	   518
ERRBOP	    55#	   301
ERRBSY	    67#	   520
ERRCHK	   140	   165#
ERRCM1	   297#	   525	   529	   542
ERRCMR	    54#	   331	  1058	  1117
ERRCNT	    66#	   439
ERRCOM	   295#	   303	   321	   329	   381
ERRCON	    73#	   516
ERRDT0	   328#
ERRDTA	    65#	   397
ERREQC	    71#	   317
ERREQP	    70#	   318
ERRINV	    63#	   327
ERRLEN	    72#	   514
ERRNO	   294#	   320	   335	   398
ERRNXM	    60#	   539
ERROF1	  1109#	  1116
ERROFL	  1062	  1108#	  1118
ERRONE	   302#
ERROR	   171	   223	   505#
ERROVR	    59#	   293
ERRPAR	    61#	   537
ERRPRT	    57#	   292
ERRRCV	    64#	   379	   459
ERRSEL	    74#	   527
ERRSEN	   155	   248#
ERRSRC	    62#	   326	  1115
ERRTEN	   319#	   324
ERRUNK	    58#	   323
ERRUXC	    69#	   524
ERRWPT	    75#	   334	  1117
FILDIS	   240#	   313	   462	   467
FILDS1	   241#
FILFAK	   458	   466#
FILINT	   246%	   246
FINRCV	   379#	   392
FNDRCV	   375	   383#
FTDPAG	    18	    18#	    38	    39	   452	   659	   662	   737
GORCV	   361	   364#
IGNLEN	   110#	   117	   118	   119	   858	   917
INVTRK	   282	   327#
J	   137	   187	   191	   203	   208	   209	   216	   236	   311	   597	   715	   777	   779	   781
	   932	   967	   972	   988	   995	  1039	  1069	  1080	  1132
KCMDTA	    25%	   457
KCMERR	    25%	   460
KCMOFL	    25%	   312
KCMPOS	    25%	   238
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88
BPXKON.MAC	17-SEP-87 16:40		Symbol cross reference

KCMRER	    25%	   461
KONBMX	    31%	   191	   777	   967
KONBSU	    31%	   187	   597	   715	   779	   995	  1069	  1080
KONCHN	    31%	   781	   932	   972	   988
KONCPY	    31%	   236	   311	  1039	  1132
KONENC	   170	   205#
KONEND	   205	   208#	   257
KONPTR	    31%	   137	   216
LENERR	    82#	   163	   513
LISTSN	     3	     6
LOKRCV	   371#	   378	   395
LSTCNT	   426	   433#
MEMERR	   509	   531#
NODIE	    11%
NOMEMT	   107#	   118
NOREC	   285	   326#
NOTRN	   384	   392#
NOXFR	   118#	   950	  1007
OFFSET	   111#	   119	  1099
OFLIN	   271	   305#
OFLIN2	   311#	  1110
OVRUN	   275	   293#
P	    12	   142	   156	   161	   184	   194	   205	   213	   219	   239	   240	   255	   256	   257
	   258	   259	   265	   296	   306	   440	   442	   471	   479	   499	   506	   507	   534	   591
	   601	   604	   607	   615	   620	   686	   698	   712	   718	   742	   747	   750	   754	   755
	   756	   763	   764	   770	   771	   784	   798	   800	   805	   812	   814	   828	   831	   837
	   852	   888	   891	   893	   908	   910	   927	   931	   935	   939	   940	   941	   943	   949
	   957	   958	   971	   994	   997	  1001	  1013	  1020	  1022	  1032	  1033	  1040	  1078	  1083
	  1088	  1089	  1090
P1	   141	   239	   243	   260	   292	   293	   301	   317	   318	   323	   326	   327	   331	   334
	   352	   354	   356	   357	   358	   362	   374	   376	   379	   385	   395	   397	   439	   458
	   459	   491	   492	   505	   506	   514	   516	   518	   520	   522	   524	   527	   537	   539
	   586	   589	   603	   609	   612	   613	   614	   616	   693	   696	   697	   704	   707	   708
	   710	   711	   749	   791	   792	   793	   794	   795	   796	   806	   816	   823	   830	   839
	   840	   842	   851	   854	   855	   859	   873	   906	   918	   920	   922	   923	   951	   952
	   954	   960	   963	   964	  1058	  1062	  1113	  1115	  1117	  1118
P2	   141	   142	   294	   298	   302	   319	   328	   353	   354	   355	   356	   359	   360	   365
	   366	   367	   368	   369	   370	   371	   377	   378	   380	   383	   443	   445	   488	   505
	   512	   528	   531	   676	   677	   678	   679	   680	   751	   761	   769	   808	   826	   835
	   845	   846	   847	   857	   870	   871	   892	   898	   899	   900	   915
P3	   136	   188	   192	   200	   210	   215	   217	   220	   233	   256	   258	   349	   350	   360
	   361	   363	   391	   393	   481	   483	   490	   493	   495	   587	   588	   589	   602	   606
	   610	   618	   670	   683	   684	   685	   695	   706	   743	   753	   788	   790	   793	   797
	   819	   821	   832	   841	   856	   869	   870	   897	   902	   904	   905	   909	   924	   929
	   944	   953	  1081
P4	   351	   363	   392	   393	   394	   471	   485	   487	   668	   669	   678	   679	   681	   762
	   809	   868	   883	   884	   885	   899	   900
PG	   135	   138	   158	   159	   160	   176	   244	   245	   253	   364	   400	   469	   470	   508
	   532	   535	   541
PGE.A	   388
PGE.P	   388
PGE.W	   388
POSDIS	   238#	  1134
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88
BPXKON.MAC	17-SEP-87 16:40		Symbol cross reference

POSINT	   150	   154	   233#
POSNTS	   152	   232#
PROTEC	   286	   292#
RDSTS	   166	   173#	   225
RDSTSS	   175	   184#
RECAL	    97#	   148	   950
RECTBL	   489	   605	   627#
RRBL	   103#	   151	   959
RSTSA	   994	  1010#
RTYCNT	   340#	   443	   512	   531
RTYDT0	   328	   344#
RTYONE	   302	   342#	   528
RTYTEN	   319	   343#
RTYZRO	   294	   341#
S$ENTR	    11	    17	   862
S$HALT	    11	   862
S$NAME	    15#	   862
S$NONA	    14	    17	   862
S$TEMP	    11#	    11	   862#	   862
S$XCT	    17	   862
SEEK	    98#	   146	   608	   692	  1097
SEEKCY	   102#	   149	   942	  1041	  1095
SEK0	  1096	  1098	  1100	  1103	  1106#
SEK500	  1044	  1092#
SELER	    79#	   163	   510	   999
SELERR	   511	   527#
SENSE	   101#
SETCM1	   791#	   910
SETCMD	   788#	   800	   812
SETSEC	    99#	   608
SETXFR	   747	   758#	   814	   828	   837
SRCIDE	   100#	   703	  1099
STROFA	   119#	   703
STRTU	   184	   187#	   219	   265	   931
STRTU1	   189#	  1083
STRTUP	   750	   773#	   831	   852	   926
STSMOD	    86#	   198
T1	   135	   136	   139	   144	   145	   153	   156	   157	   158	   165	   167	   169	   198	   204
	   208	   211	   212	   214	   222	   234	   235	   236	   238	   250	   251	   252	   254	   295
	   296	   305	   306	   309	   310	   311	   312	   315	   316	   332	   333	   346	   347	   364
	   365	   370	   371	   372	   373	   374	   376	   386	   388	   389	   400	   401	   404	   411
	   418	   425	   433	   434	   435	   436	   450	   451	   457	   460	   461	   480	   481	   482
	   483	   484	   486	   487	   489	   490	   496	   510	   513	   515	   517	   519	   521	   523
	   532	   533	   534	   535	   536	   538	   540	   541	   752	   758	   759	   765	   801	   807
	   848	   880	   881	   882	   883	   884	   885	   886	   889	   901	   932	   933	   934	   952
	   990	   991	   992	   993	   996	   998	   999	  1000	  1002	  1003	  1004	  1010	  1011	  1012
	  1016	  1017	  1018	  1020	  1023	  1026	  1027	  1028	  1029	  1031	  1037	  1038	  1039	  1042
	  1043	  1045	  1047	  1048	  1049	  1064	  1065	  1066	  1068	  1069	  1070	  1072	  1074	  1076
	  1078	  1132
T2	   145	   146	   148	   149	   151	   174	   181	   182	   189	   190	   193	   200	   202	   214
	   215	   218	   233	   235	   241	   242	   243	   248	   250	   253	   254	   261	   262	   263
	   264	   307	   308	   310	   383	   384	   385	   386	   387	   391	   403	   404	   407	   409
	   411	   414	   416	   417	   418	   420	   421	   422	   424	   425	   429	   430	   431	   497
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88
BPXKON.MAC	17-SEP-87 16:40		Symbol cross reference

	   593	   595	   598	   603	   608	   609	   691	   692	   693	   702	   703	   704	   714	   715	   716
	   717	   741	   742	   755	   763	   768	   773	   774	   775	   776	   780	   781	   782	   783
	   891	   906	   907	   924	   930	   942	   950	   959	   960	   966	   968	   969	   972	   973
	   978	   981	   984	   985	   989	   991	   995	  1016	  1035	  1036	  1041	  1043	  1044	  1045
	  1046	  1047	  1055	  1056	  1063	  1064	  1066	  1067	  1070	  1071	  1072	  1073	  1074	  1075
	  1076	  1077	  1082	  1108	  1109	  1114	  1121	  1122	  1124	  1125	  1126	  1127	  1128	  1129
	  1130	  1131
T2POP0	   868	   872	   881	   891#	   896
T2POP1	   754#	   824	   860	   901
T2POPJ	   755#
T3	   176	   177	   178	   179	   180	   182	   183	   187	   188	   190	   191	   192	   193	   201
	   202	   203	   240	   268	   402	   408	   428	   436	   437	   446	   447	   448	   449	   450
	   468	   596	   597	   598	   605	   606	   610	   611	   612	   660	   666	   667	   670	   671
	   672	   683	   694	   695	   696	   705	   706	   707	   708	   709	   710	   743	   744	   746
	   749	   758	   759	   760	   761	   762	   764	   765	   766	   767	   768	   775	   776	   778
	   779	   780	   788	   790	   791	   792	   803	   804	   805	   806	   813	   816	   822	   823
	   826	   827	   830	   835	   836	   839	   841	   842	   843	   844	   845	   846	   851	   854
	   858	   859	   869	   873	   874	   877	   878	   879	   886	   895	   898	   902	   904	   917
	   918	   919	   920	   921	   922	   961	   962	   963	   967	   968	   969	   970	   973	   974
	   978	   979	   980	   983	   988	   989	  1002	  1010	  1015	  1026	  1036	  1038	  1059	  1060
	  1061	  1080	  1081	  1082	  1112	  1119	  1120	  1123	  1136	  1137	  1138
T4	   409	   413	   415	   424	   427	   428	   434	   605	   669	   671	   677	   682	   684	   777
	   778	   789	   903	  1000	  1004	  1015	  1018	  1019	  1030	  1032
TICBIT	   122#	   180	   709	  1101
TRBIT	   114#	   120
TRBYTE	   113#	   117	   119
TRNCN1	   882	   895#
TRNCNT	   751	   847	   868#
TRNHD1	   897	   902#
TRNHED	   887	   898#
TRTAP	   115#
TRWORD	   112#
U	   137	   143	   144	   173	   174	   178	   179	   181	   183	   216	   218	   232	   241	   248
	   249	   252	   255	   259	   261	   264	   295	   297	   298	   305	   316	   333	   347	   349
	   352	   353	   355	   402	   403	   406	   407	   437	   444	   445	   451	   466	   468	   494
	   496	   497	   498	   586	   587	   590	   599	   600	   617	   660	   667	   760	   773	   804
	   888	   889	   923	   930	   951	   962	   974	   983	  1042	  1049	  1050	  1055	  1063	  1077
	  1079	  1109	  1120	  1122	  1131	  1133
UCHK	    89#	   163	   165
UNIACT	    40%	   974	   983
UNIBLK	    38%	   660
UNICCC	    41%	   451	   468	   599
UNICHR	  1122%	  1122
UNICNA	    41%	   466	   497	   498	   600	   888
UNICNC	    41%	   496	   889
UNICOM	    37%	   144	   174	   181	   218	   241	   264	   407	   586	   587	   773	   930	   951	  1042
	  1063	  1077
UNICYL	    37%	   667	  1049	  1055	  1079
UNIONC	    37%	  1050	  1109	  1120
UNIPPU	    40%	  1131
UNIRCT	    41%	   297	   298	   444	   445
UNISCM	    42%	   183	   248
UNISNC	    42%	   232	   249	  1133
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88
BPXKON.MAC	17-SEP-87 16:40		Symbol cross reference

UNISND	    42%	   261	   295	   305	   316	   333	   347	   349	   352	   353	   355	   962
UNISNS	    42%	   179
UNISVC	    42%	   173	   178	   252	   590
UNISWC	    40%	   402	   403	   406	   437	   494	   617	   760	   804	   923
UNKNO	   276	   277	   280	   283	   284	   287	   288	   323#
UNPDEV	    37%	   340	   341	   342	   343	   344
UNYBPT	    37%	  1125
UNYPPY	    37%	  1128
UNYPUN	    40%	   307	   596	   714	   929	   966	  1035	  1068
UNYUTP	    40%	  1061	  1123
UPCHK	   996	  1007#
UXCP	    90#	   163	   523
WRDMOD	   120#	   593	   595
WRT100	  1065	  1095#
XCTCMD	   108#	   117	   118	   119	   120
%ERR	   390	   391
%ERR.N	   389
%OFLER	    26%	  1108
%OFLFM	    26%	  1114
BPXKON - KONTROLER ROUTINE FOR 3330 ON 3803 ON SA-10	MACRO 12.5-46.0 14:30 13-JAN-88
BPXKON.MAC	17-SEP-87 16:40		Macro/Opdef cross reference

CLRPT	   390
CLRPTO	   390
CSHUNL	  1022
EPTPGP	   389
EPTPGS	   389
IFCPU	  1021
ND	    18
PJRST	   501	   926
RECGEN	   625#	   627	   640
STOPCD	    10	   862
SYND	   338#	   340	   341	   342	   343	   344
XOR	   127#	   608
$END	  1146    hT+