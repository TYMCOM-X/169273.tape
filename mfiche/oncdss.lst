ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 1
S.MAC	13-JAN-88 11:55		S.MAC - with system parameter file for P035/D, January 1988

     1				SUBTTL	S.MAC - with system parameter file for P035/D, January 1988
     2
     3				IF2,<IFNDEF LISTSN,<TAPE>>	;Skip to PASS2 in all but COMMON.LST
     4				;THIS MODULE ASSEMBLED WITH KS-10 PARAMETER FILE - KSSYM.MAC
     5
     6					IF2,<IFNDEF LISTSN,<		;LIST KSSYM.MAC IN COMMON ONLY
     7					.CREF
     8									TAPE>>
     9				; This file is PRINTF.MAC
    10				DEFINE PRINTF(A,B,C,D),<IF2,<;;Output message on MONKS build only
    11				PRINTX A B C D>>
    12
    13				TITLE	ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE
    14
    15				;*;	STOPCD(,ENTRY,ONCDSK)	;Macro is expanded after the PHASE statement
    16
    17				INTERN FILOPT,FILMAN,TYPONL,ONDSTT,ONDLNP,ONDLNR
    18				INTERN MIN,MAX,LNGMES,DECLOP,CMDSCN,CMDSCF,ASKQMM,OPAGIN,OPAGOT
    19				INTERN GETHOM,WTBOTH,GETBAT
    20
    21				;CONMES = output ASCIZ string, addr in T1
    22				;TYPDEC = output P1 as decimal
    23				;CRLF   = output CRLF
    24				;DECLOP = save ACs, message in T1, TYPDEC, CRFLOP
    25				;ASKQUE = save ACs, then YESNO
    26				;YESNO  = output string, get response, skip if "Y"
    27				;CONOUT = CONMES + CRLFOP
    28				;CRLFOP = CRLF + OPOUT
    29				;OPOUT  = output buffer, can be suppressed by ^O or ^C
    30				;OCONM  = cancel ^O suppression, then CONMES
    31
    32				EXTERN BATCNT,BATPAT,HOMSUF,PRT22A,UNICHR,UNYBPR,UNYBPT,UNYBPY
    33				EXTERN CONMES,CRLF,CTEXT,DECIN,GETLIN,OCONM,OCTIN,OPOUT,DSKDDB
    34				EXTERN CORZER,SCNBAT,STTPTR,UNTTBL,STTFPC,UNTLEN
    35				EXTERN STTLEN,SATCNT,UFDHSI
    36				EXTERN NMRBPC,CPOPJ,CPOPJ1,MFDRIB
    37				EXTERN %HOM.P,%BAT.P,%STR.P,%STA.P
    38				EXTERN COMTYO,BRMAX,INLMES,NMSTPC
    39				EXTERN CLRSND,PRNAME,RADX10,TPOPJ,CMPLOG
    40				EXTERN PAGIN,PAGOUT,PCISTS,PGYUNI,PGYPNO,STDREA,PGYERR,OHTNUM,OHTINI
    41				EXTERN PCBPAG,PAKREF,STDWRT,GETPEV
    42				EXTERN BATFIR,BATREG,BAYNBB,BATNBB,BATELB,PAGCOD,PAGNAM,PAGSLF
    43				EXTERN CODBAT,CODHOM,CODRIB,DDBLEN,DDSTAR,ONCDDB
    44				EXTERN ICPFAC,JFYSEC,KONDWN,KONUPA,KOPDWN,KONLTM,KONCPY
    45				EXTERN LPNHOM,LP2HOM,LPNBAT,LP2BAT,SYSUNI,SYSSIZ,EVASIZ
    46				EXTERN REFRSH,SAVE4,SETDDO,IOSEL,CCOD,CWCOD,CLRDDB,YESNO
    47
    48				EXTERN HOMEND,HOMDAT,HOMMFD,HOMHSH,HOMRAN
    49				EXTERN HOMHID,HOMP4C,HOMLOG,HOMLUN,HOMNXT,HOMOVR
    50				EXTERN HOMPRV,HOMREF,HOMSNM,HOMSPU,HOMSAT,HOMFEP
    51
    52				EXTERN RIBLST,RIBPFS,RIBNAM,RIBEXT,RBSPAR,RBREAL,RBINDX,RBMASK
    53				EXTERN RBYUNI,RBYPNO,RBYUN4,RBYUN1,RBLVPR,RBLVSP
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 1
ONCDSK.MAC	 4-DEC-87 15:51		S.MAC - with system parameter file for P035/D, January 1988

    54
    55				EXTERN STRDDB,STRLEN,SRPNDS
    56				EXTERN STRNAM,STRHSH,STRUNI,STRP4C,STRNXT,STRUNM,STRREF
    57				EXTERN STROVR,STRTAL,STRPPU,STRPID,STRBTS,STRSID
    58
    59				EXTERN UNIPPU,UNIDES,UNIERR,UNIHID,UNISYS,UNIFEP
    60				EXTERN UNINAM,UNISTT,UNISTR
    61				EXTERN UNITAL,UNPCHG,UNPHWP,UNPMSB,UNPOFL,UNVRSF
    62				EXTERN UNYLN1,UNYLUN,UNYSPU,UNIONC
    63				EXTERN UNIKON,UNILOG,UNICHN,UNPPRV,UNISTS
    64
    65				EXTERN DCN,STRPID,REPSID,RE.DCD,HOMDCT,HOMDCV
    66
    67				EXTERN CH7
    68				ENTRY ONCMOD
    69
    70	000000'			ONCMOD:
    71
    72	761000			ONDSTT:	PHASE %OND
    73					STOPCD(,ENTRY,ONCDSK)^
    74					ENTRY	ONCDSK		;For library searches
    75	000000'	260040	000000*	ONCDSK::PUSHJ	P,DIE		;**** Default stopcode for "ONCDSK" ****
    76	000001'	575643	446353		SIXBIT	/ONCDSK/  	;Title of module
    77	000002'	000000	000000		S$NONAME,,0		;?NONAME stopcode "ONCDSK+nnn(nnnnnn)"
    78			761000	S$NAME==ONCDSK			;For STOPCDs with no arguments
    79					SALL>
    80				^	;Default for NONAME stopcodes
    81		777777	017000'		%D==ONDSTT-ONCDSK	;To look at LABEL, use LABEL+%D
    82
    83				;MACRO TO DEFINE ONCE RESTART SYMBOLS AND BYTE POINTERS
    84				;
    85				DEFINE DCNDEF (DCD)<
    86				  INTERN  REONCE
    87					REONCE:	0
    88					DCNUM==0
    89					IRP DCD, <DCNUM==DCNUM+1>
    90					DCNTAB:
    91					DCXX==0
    92					IRP DCD, <DCN.'DCD==(1B<DCXX>)
    93						  DCNY'DCD: POINT DCSIZ,DCN,35-DCSIZ*<DCNUM-1-DCXX>
    94						  Intern DCN.'DCD,DCNY'DCD
    95						  DCXX==DCXX+1>
    96				>
    97			000003	DCSIZ==DC.SIZ			;(FROM S).
    98	000003'	000000	000000	DCNDEF (<OP,ON,UR,MN,HM,DF>)
    99	000004'	170300	000000*
   100	000005'	140300	000004*
   101	000006'	110300	000005*
   102	000007'	060300	000006*
   103	000010'	030300	000007*
   104	000011'	000300	000010*
   105					;DSKCLN TYPE CAN BE SPECIFIED BY:
   106								; 'OP' - OPER in ONCE (FULL COMMAND)
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 1-2
ONCDSK.MAC	 4-DEC-87 15:51		S.MAC - with system parameter file for P035/D, January 1988

   107								; 'ON' - OPER IN ONCDSK
   108								; 'UR' - USER PROG VIA .REST SETUUO
   109								; 'MN' - MONITOR IN CRASH CODE
   110								; 'HM' - HOME BLOCKS
   111								; 'DF' - DEFAULT
   112				INTERN DCNDFT			;IN THAT ORDER OF PRIORITY
   113			030000	DCNDFT==DCN.HM!DCN.DF		; SETUP DEFAULT TO HOME-BLOCKS ! DEFAULT
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   114				SUBTTL	FILMAN
   115
   116	000012'	476000	763743	FILMAN:	SETOM	BATMAN		;MANDATORY CODE.
   117	000013'	260040	762556		PUSHJ	P,RDHOME	;READ HOME PAGES OF ALL UNITS.
   118	000014'	254000	761027		  JRST	MANOK		;ALL OK.
   119	000015'	254000	761024		  JRST	MANQST		;MINOR ERRORS.
   120					MOVEI	T1,[ASCIZ /
   121	000016'	201300	765275	ERRORS which prevent bringing the system UP/]
   122	000017'	260040	000000*	MANCM1:	PUSHJ	P,CONMES
   123	000020'	260040	761312	MANCOM:	PUSHJ	P,FILOPT
   124	000021'	254000	761012		JRST	FILMAN
   125
   126				MANREF:	MOVEI	T1,[ASCIZ /
   127	000022'	201300	765307	File structure NEEDS refreshing/]
   128	000023'	254000	761017		JRST	MANCM1
   129
   130				MANQST:	MOVEI	T1,[ASCIZ /
   131	000024'	201300	765316	MINOR ERRORS - Bring system UP anyway? /]
   132	000025'	260040	763622		PUSHJ	P,ASKQUE
   133	000026'	254000	761020		  JRST	MANCOM		;NO.
   134	000027'	260040	763676	MANOK:	PUSHJ	P,REDBAT	;READ THE BAT PAGES OF ALL UNITS.
   135	000030'	510300	000000*		HLLZ	T1,STRREF+STRDDB
   136	000031'	326300	761022		JUMPN	T1,MANREF	;NEEDS REFRESH.
   137	000032'	201300	000000*		MOVEI	T1,SRPREF##
   138	000033'	616300	000000*		TDNN	T1,STRBTS+STRDDB;Was REFSTR called on this STR?
   139	000034'	402000	000000*		 SETZM	REFLAG##	;No, ignore setting REFLAG from DDT
   140
   141				;HERE TO REWRITE HOME PAGES, WITH INCREMENTED PACK SET ID.
   142
   143	000035'	554240	000000*		HLRZ	U,STRDDB+STRUNI	;Start with DSKB0
   144	000036'	350300	763230		AOS	T1,RANHOM	; Increment save'd copy of HOMRAN
   145	000037'	607300	777777		TLNN	T1,-1
   146	000040'	254000	761043		 JRST	MANOK1
   147	000041'	201300	434164		MOVEI	T1,(SIXBIT/CAT/)	;
   148	000042'	552300	763230		HRRZM	T1,RANHOM	; If zero - save sixbit CAT
   149	000043'	506300	000000*	MANOK1:	HRLM	T1,STRDDB+STRPID
   150	000044'	260040	764707		PUSHJ	P,UPDHOM	;
   151	000045'	554245	000000*		HLRZ	U,UNISTR(U)	;Update HOM pages on all units in STR
   152	000046'	326240	761044		JUMPN	U,.-2		;
   153	000047'	260040	764670		PUSHJ	P,SPCDKP	;GET CURRENT DC MODE AND PRIORITY
   154	000050'	302400	000005		CAIE	T3,^L<(DCN.DF)>	;IS MODE DEFAULT
   155	000051'	254000	761056		 JRST	MANOK2		;NO, DON'T QUERY OPER FOR MODE
   156	000052'	201700	000000*		MOVEI	P3,DCFAST##	;Default to FAST instead of asking OPR
   157	000053'	200300	000000*		MOVE	T1,STRDDB+STRBTS;DOES STR REQUIRE
   158	000054'	602300	000000*		TRNE	T1,SRPNDS	; DSKCLN TO BE RUN
   159				;*;	 PUSHJ	P,SPCDKN	;YES, ASK OPER TO SELECT MODE
   160	000055'	137700	761005		 DPB	P3,DCNYON	;Yes, do fast DSKCLN (trust HOM page for FULL)
   161	000056'	135300	761005	MANOK2:	LDB	T1,DCNYON	;GET MODE
   162	000057'	202300	000011*		MOVEM	T1,DCN		; AND SAVE IT FOR DSKCLN TO GETTAB
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 3
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   163				;HERE TO READ THE RIB FOR SAT.SYS AND SET UP THE STTPTR
   164				;ENTRIES IN STT.
   165
   166	000060'	554240	000000*		HLRZ	U,STRDDB+STRUNI	;GET THE PRIME (AND ONLY)
   167	000061'	260040	761177		PUSHJ	P,GETSRB	;RIB INTO %STR.
   168	000062'	256000	761000		 STOPCD
   169	000063'	135300	765327		LDB	T1,[POINT 14,%STR+RIBEXT,35] ;Access date of SAT.SYS
   170	000064'	550340	000000*		HRRZ	T2,THSDAT##	;Current date (if any)
   171	000065'	317300	000007		CAMG	T1,T2		;Get larger into T1
   172	000066'	200300	000007		 MOVE	T1,T2
   173	000067'	542300	000064*		HRRM	T1,THSDAT##	;Store so COPYCRASH had a reasonable date
   174	000070'	201740	000000*		MOVEI	P4,RIBPFS	;P4/ REL ADDR OF RETRIEVAL POINTERS.
   175	000071'	554240	000000*		HLRZ	U,STRDDB+STRUNI	;Start with DSKB0
   176
   177				      ;HERE FOR EACH UNIT.
   178	000072'	135440	000000*	RDRBS2:	LDB	T4,UNYLUN	;
   179	000073'	550645	000000*		HRRZ	P2,UNISTT(U)	;P2/ STT ENTRY ADDRESS.
   180	000074'	135700	000000*		LDB	P3,UNYSPU	;P3/ # SATS ON THE UNIT.
   181
   182				      ;HERE FOR EACH SAT.
   183	000075'	307740	000000*	RDRBS3:	CAIG	P4,RIBLST	;MUSTN'T RUN OUT OF RIB ROOM.
   184	000076'	336317	750000		SKIPN	T1,%STR(P4)	;NOT EXPECTING EOF HERE.
   185	000077'	256000	761000		 STOPCD
   186	000100'	607300	000000*		TLNN	T1,RBSPAR!RBINDX ;CHECK THAT THE POINTER IN T1
   187	000101'	607300	000000*		TLNN	T1,RBREAL	;IS A CORRECT POINTER.
   188	000102'	256000	761000		 STOPCD
   189	000103'	135400	000000*		LDB	T3,RBYUN1	;IS THIS THE UNIT
   190	000104'	312400	000011		CAME	T3,T4		;THAT WE EXPECT TO SEE?
   191	000105'	256000	761000		 STOPCD
   192	000106'	621300	000000*		TLZ	T1,RBMASK-RBREAL ;
   193	000107'	202315	000000*		MOVEM	T1,STTPTR(P2)	;YES.  SET STTPTR.
   194	000110'	271740	000001		ADDI	P4,1		;INC PNTR TO PNTRS.
   195	000111'	271640	000000*		ADDI	P2,STTLEN	;ADJUST P2 TO NEXT STT ENTRY.
   196	000112'	367700	761075		SOJG	P3,RDRBS3	;LOOP AGAIN IF MORE SATS ON THIS UNIT.
   197	000113'	402015	000107*		SETZM	STTPTR(P2)	;
   198
   199	000114'	554245	000045*		HLRZ	U,UNISTR(U)	;IS THERE ANOTHER
   200	000115'	326240	761072		JUMPN	U,RDRBS2	;UNIT?
   201	000116'	332017	750000		SKIPE	%STR(P4)	;NO.  CHECK THAT EOF IS PRESENT.
   202	000117'	256000	761000		 STOPCD
   203					PFALL	RDSATS
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 4
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   204				;NOW READ ALL THE SATS ON EACH UNIT IN THE STR, AND SET STTFPC
   205				;IN THE SATS.
   206
   207	000120'	402000	000000*	RDSATS:	SETZM	STRDDB+STRTAL	;CLEAR THE TOTAL COUNT FOR THE STR.
   208	000121'	554240	000000*		HLRZ	U,STRDDB+STRUNI	;
   209	000122'	550705	000073*	RDSTS1:	HRRZ	P3,UNISTT(U)	;P3/PNTR INTO STT FOR THIS UNIT.
   210	000123'	336356	000113*	RDSTS4:	SKIPN	T2,STTPTR(P3)	;OUT OF SATS ON THIS UNIT?
   211	000124'	254000	761153		 JRST	RDSTS5		;YES, GO TO NEXT UNIT.
   212	000125'	135440	000000*		LDB	T4,RBYPNO	;SAT
   213	000126'	201140	000000*		MOVEI	PG,%STA.P	;INTO
   214	000127'	260040	763520		PUSHJ	P,OPAGIN	;%STA.
   215	000130'	254000	761132		  JRST	.+2		;ERROR ON READ.
   216	000131'	254000	761135		 JRST	RDST45		;READ OKAY.
   217	000132'	402000	751000		SETZM	%STA		;PRETEND ALL F BITS IN USE,
   218	000133'	200300	765330		MOVE	T1,[XWD %STA,%STA+1] ;AND LET
   219	000134'	251300	751377		BLT	T1,%STA+377	;DSKCLN WORRY.
   220	000135'	476000	751400	RDST45:	SETOM	%STA+400	;SET ALL THE
   221	000136'	200300	765331		MOVE	T1,[XWD %STA+400,%STA+401] ;M BITS
   222	000137'	251300	751777		BLT	T1,%STA+777	;FREE.
   223	000140'	200300	765332		MOVE	T1,[XWD -400,%STA] ;AOBJN PNTR FOR SATCNT.
   224	000141'	260040	000000*		PUSHJ	P,SATCNT	;T4/ NO. FREE PAGES IN THIS SAT.
   225	000142'	202456	000000*		MOVEM	T4,STTFPC(P3)	;
   226	000143'	272445	000000*		ADDM	T4,UNITAL(U)	;
   227	000144'	200356	000123*		MOVE	T2,STTPTR(P3)	;WRITE  OUT THE SAT
   228	000145'	135440	000125*		LDB	T4,RBYPNO	;SO THE CLEARED M BITS
   229	000146'	201140	000126*		MOVEI	PG,%STA.P	;GET
   230	000147'	260040	763523		PUSHJ	P,OPAGOT	;OUT THERE.
   231	000150'	256000	761000		 STOPCD
   232	000151'	271700	000111*		ADDI	P3,STTLEN	;ADJUST PNTR TO STT.
   233	000152'	254000	761123		JRST	RDSTS4
   234
   235				    ;COMPUTE SAFETY FACTOR FOR UNIT AND ADJUST STRTAL.
   236	000153'	200305	000000*	RDSTS5:	MOVE	T1,UNIPPU(U)	;COMPUTE THE SAFETY FACTOR FOR
   237	000154'	231300	000000*		IDIVI	T1,UNVRSF	;THE UNIT.
   238	000155'	135340	000074*		LDB	T2,UNYSPU	;
   239	000156'	221307	000000		IMULI	T1,(T2)		;
   240	000157'	213000	000006		MOVNS	T1		;
   241	000160'	273305	000143*		ADDB	T1,UNITAL(U)	;ADD TO UNIT'S COUNT.
   242	000161'	325300	761164		JUMPGE	T1,.+3		;DO NOT ALLOW
   243	000162'	402005	000160*		SETZM	UNITAL(U)	;UNITAL TO GO
   244	000163'	254000	761165		JRST	RDSTS6		;NEGATIVE.
   245	000164'	272300	000000*		ADDM	T1,STRDDB+STRTAL ;ADJUST STRTAL.
   246
   247	000165'	554245	000114*	RDSTS6:	HLRZ	U,UNISTR(U)	;
   248	000166'	326240	761122		JUMPN	U,RDSTS1	;
   249
   250				;The calculation of PROT and PROT0 based on disk type is not valid in the                      
   251				                i
   252				;paging monitor.  The code that was deleted here produced garbage for PROT0
   253				;on the F3 as a result of dividing by zero.  The values are now set in COMMON
   254				;based on IFCPU(<KI,KL>),<PROT0:2> and IFNCPU(<KI,KL>),<PROT0:4>.
   255
   256	000167'	205300	000000*		MOVSI	T1,UNPCHG
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 4-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   257	000170'	554240	000000*		HLRZ	U,SYSUNI	;GET ADR. OF 1ST. UNIT DATA BLOCK IN SYSTEM
   258	000171'	412305	000000*		ANDCAM	T1,UNIDES(U)	;CLEAR CHANGE BIT
   259	000172'	554245	000000*		HLRZ	U,UNISYS(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN SYSTEM
   260	000173'	326240	761171		JUMPN	U,.-2		;REPEAT IF ANY LEFT
   261	000174'	332200	000000*		SKIPE	F,DDSTAR	;IF A DDB SETUP
   262	000175'	260040	000000*		PUSHJ	P,CLRDDB	;THEN CLEAR IT.
   263	000176'	263040	000000		POPJ	P,		;NO - RETURN
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 5
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   264				COMMENT #
   265				@@SUBROUTINE GETSRB
   266				@@PURPOSE
   267				SUBR TO READ THE RIB BLOCK FOR SAT.SYS INTO %STR.
   268				@@ENTRY
   269				EXPECTS U/ UNIT DB AND F/ DDB.
   270				@@ACCUM
   271				DESTROYS
   272				@@CALLS
   273				RDCHEK.
   274				@@EXIT
   275				SKIP RETURNS IF THE PAGE READ SUCCESSFULLY.
   276				@@ #
   277
   278
   279	000177'	260040	763354	GETSRB:	PUSHJ	P,GETHOM	;Read in HOM page for DSKB0
   280	000200'	263040	000000		  POPJ	P,		;Can't read it
   281	000201'	337440	753000*		SKIPG	T4,%HOM+HOMSAT	;Get logical page number for RIB for SAT.SYS
   282	000202'	263040	000000		 POPJ	P,		;Should be LPNSAT, not zero!
   283	000203'	201700	000000*		MOVEI	P3,CODRIB	;GET CODE WORD FOR RIB PAGES.
   284	000204'	205640	634164		MOVSI	P2,(SIXBIT .SAT.)
   285	000205'	201140	000000*		MOVEI	PG,%STR.P	;
   286	000206'	476000	763516		SETOM	WHICH		;INDICATE READING FIRST (AND
   287	000207'	402000	763517		SETZM	NOERH		;ONLY) PAGE.
   288	000210'	324740	763407		PJRST	RDCHEK		;READ & VERIFY RIB PAGES.
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 6
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   289				;SOME MACROS FOR COMMAND WORK
   290
   291					DEFINE SCAN (A,B) <
   292				IFB <B>,<
   293				PRINTX	SCANNER TABLE 'A' Has an undefined SETxM statement
   294				>
   295					MOVEI	P1,SCN'A		; Get address of Scan Table
   296					SET'B'M	CMDSCF			; Specify NO STR/UNIT stuff
   297					PUSHJ	P,CMDSCN		; Call Scanning routine
   298					  JRST	HLP'A			; No good!
   299					XCT DSP'A'(P3)			; Yes?
   300					JRST	A'CMD			; Return as if cr typed.
   301				
   302				A'HLP:	Move	P3,-2(P1)		; Setup AOBJN pointer for messages
   303				A'HL1:	Hrrz	T1,(P3)			; Get address of message
   304					Pushj	P,LNGMES		; Print a long message
   305					Aobjn	P3,A'HL1		; Next?
   306					Jrst	A'CMD			; Return.
   307				>
   308
   309				;MACRO TO MAKE SCAN TABLE
   310				;UNI IS PLACE TO JRST TO IF UNIT
   311				;STR IS PLACE TO JRST TO IF STR
   312				;NAM IS TABLE NAME  Generates SCN'NAM, DSP'NAM, TXT'NAM, SIZ'NAM
   313				; Assumes MK'NAM as the macro defining the X arguments
   314				; JRST to NUL'NAM on <CR> and HLP'NAM on error
   315				; Defines NAM'HLP for a standard typeout of help texts
   316
   317					Extern Ab.Ack,Ab.Nak,Ab.Ver,Ab.Tcv,Ab.Cvr ; Bits - See ONCE.MAC
   318					DEFINE SCNTB (UNI,STR,NAM) <
   319				
   320					DEFINE X(SYM,INS,BIT,TEXT,TEXT1,TEXT2,TEXT3) <
   321					INS>	;INSTRUCTION TO EXECUTE
   322				
   323					JRST UNI		;FOR -3 RETURN
   324					JRST STR		;FOR -2 RETURN
   325					JRST NUL'NAM		;FOR -1 RETURN
   326				DSP'NAM: MK'NAM			;GENERATE DISPATCH TABLE
   327					SIZ'NAM==.-DSP'NAM
   328					-SIZ'NAM,,TXT'NAM	;AOBJN POINTER TO HELP
   329					-SIZ'NAM,,SCN'NAM	;AOBJN POINTER TO NAMES
   330					DEFINE X (SYM,INS,BIT,TEXT,TEXT1,TEXT2,TEXT3)
   331				<	<SIXBIT /SYM/>>
   332				SCN'NAM: MK'NAM			; Define Table to read
   333				
   334					$XZ==0			; Need a counter
   335					define xz$(argh)<lit$'argh==.>
   336					DEFINE X (SYM,INS,BIT,TEXT,TEXT1,TEXT2,TEXT3)
   337				<	xz$(\$XZ)
   338				Ifnb <TEXT>,<ASCIZ \TEXT'TEXT1'TEXT2'TEXT3\>
   339					$XZ==$XZ+1>
   340					MK'NAM
   341				
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 6-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   342					$XZ==0
   343					define xz$(argh)<lit$'argh>
   344					DEFINE X (SYM,INS,BIT,TEXT,TEXT1,TEXT2,TEXT3) <
   345					<Xwd	Bit,xz$(\$XZ)>
   346					$XZ==$XZ+1>
   347				TXT'NAM: MK'NAM
   348				
  			>
   350
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 7
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   351				;P1 IS A POINTER TO THE NAMES TABLE
   352				;The command scanning routine - Copied and munged from ONCDSK
   353
   354	000211'	260040	764571	CMDSCN:	PUSHJ	P,SETRAN	; Start number generator on any question.
   355	000212'	260040	000000*		PUSHJ	P,CTEXT		; Get text (up to 6 chars) in T2
   356	000213'	260040	764574		PUSHJ	P,GETRAN	; Stop generator (KI,F3) and get number
   357					 JUMPE	T2,[CAIL T3,40	;  EOL?
   358						    POPJ P,	;NOT NULL LINE, SPC CHR
   359						    MOVNI P3,1	;RETURN P3=-1 FOR NULL STRING
   360	000214'	322340	765333			    JRST CPOPJ1]
   361	000215'	200300	000007		MOVE	T1,T2		;GET TEXT IN T1
   362	000216'	336000	761307		SKIPN	CMDSCF		; Skip IF we want to do UNI/STR stuff
   363	000217'	254000	761227		  Jrst	CMDSC1		; NO!  Don't Bother.
   364	000220'	202240	761311		MOVEM	U,SVU
   365	000221'	260040	763260		PUSHJ	P,FNDSTR	;IS IT A STR?
   366					JRST	[MOVNI P3,2	;-2 FOR STR WITH P2 TO STR BLOCK
   367	000222'	254000	765337			 JRST CPOPJ1]
   368	000223'	260040	763651		PUSHJ	P,FNDUNI	;CHECK ON UNIT
   369	000224'	334000	000000		  SKIPA			;NO
   370					JRST	[MOVNI P3,3	;-3 WITH U POINTING TO UNIT BLOCK
   371	000225'	254000	765341			 JRST CPOPJ1]
   372	000226'	200240	761311		MOVE	U,SVU
   373	000227'	200654	777776	CMDSC1:	MOVE	P2,-2(P1)	;GET AOBJN POINTER TO HELP TABLE
   374	000230'	200714	777777		MOVE	P3,-1(P1)	;GET AOBJN POINTER TO NAME TABLE
   375	000231'	201740	000000		MOVEI	P4,0		;NOTHING SEEN SO FAR
   376	000232'	205400	770000		MOVSI	T3,770000	;MAKE A MASK
   377	000233'	612300	000010	CMDSC2:	TDNE	T1,T3		; Did we type something?
   378	000234'	670300	000010		TDO	T1,T3		; If something there, set mask bits
   379	000235'	242400	777772		LSH	T3,-6		; Shift
   380	000236'	326400	761233		  JUMPN	T3,CMDSC2	; While we have more to check...
   381	000237'	316356	000000	CMDSC3:	CAMN	T2,(P3)		; Compare !
   382	000240'	254000	761256		  JRST	CMDSC5		; Exact match
   383	000241'	200415	000000		Move	T3,(P2)		; Get Bits,,Text-Adr
   384	000242'	603400	000000*		TLNE	T3,AB.NAK	; See if we can abbreviate it
   385	000243'	254000	761252		  JRST	CMDSC4		; No! -- Don't bother
   386	000244'	200416	000000		MOVE	T3,(P3)		;NO - CHECK MORE
   387	000245'	404400	000006		AND	T3,T1		;MASK OUT UN-TYPED STUFF
   388	000246'	312400	000007		CAME	T3,T2		;CHECK AFTER MASK
   389	000247'	254000	761252		  JRST	CMDSC4		;NO
   390					JUMPN	P4,[MOVEI P4,1	;SET POSITIVE FOR MULTI MATCH
   391	000250'	326740	765343			    JRST   CMDSC4]
   392	000251'	200740	000016		MOVE	P4,P3		;SAVE MATCH
   393	000252'	340640	000000	CMDSC4:	AOJ	P2,		; Increment text pointer
   394	000253'	253700	761237		AOBJN	P3,CMDSC3	; Loop through the table
   395	000254'	331700	000017		SKIPL	P3,P4		;ANY MASKED MATCHES
   396	000255'	263040	000000		  POPJ	P,		;NONE OR MORE THAN 1
   397	000256'	274700	000014	CMDSC5:	SUB	P3,P1		;CONVERT TO RELATIVE INDEX
   398	000257'	550654	777776		HRRZ	P2,-2(P1)	; Get AOBJN Pointer for
   399	000260'	270640	000016		ADD	P2,P3		; Add offset
   400	000261'	200655	000000		MOVE	P2,(P2)		; Get Bits,,Text-Addr
   401	000262'	332000	761306		SKIPE	CMDMSG		; See if debugging?
   402	000263'	254000	000000*		 JRST	CPOPJ1		;  Yes!  Don't bother to verify!
   403	000264'	607640	000000*		TLNN	P2,AB.VER	; Should we Verify?
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 7-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   404	000265'	254000	000263*		 JRST	CPOPJ1		; No! Just Return "SAFE"
   405	000266'	607640	000000*		TLNN	P2,AB.CVR	; Ignore verify for CONSOLE?
   406	000267'	304000	000000		 CAIA			; No.. Don't bother to check!
   407	000270'	336000	000000*		SKIPN	CTYDO##		;  Setup for CTY?
   408	000271'	304000	000000		 CAIA			; No.. Keep going!
   409	000272'	254000	000265*		  JRST	CPOPJ1		; YES! Don't verify.
   410	000273'	607640	000000*		TLNN	P2,AB.TCV	; Is it a TYPE/CHANGE item?
   411	000274'	304000	000000		 CAIA			; No.. Don't worry!
   412	000275'	331000	764112		SKIPL	TYPONL		;  Type ONLY?
   413	000276'	304000	000000		 CAIA			; No.. Keep going!
   414	000277'	254000	000272*		  JRST	CPOPJ1		; YES! Don't verify.
   415	000300'	550300	000015		HRRZ	T1,P2		; Get Text Address
   416	000301'	260040	762544		PUSHJ	P,LNGMES	; No -- Type it out.
   417					MOVEI	T1,[ASCIZ\
   418				
   419	000302'	201300	765345	Are you SURE you want to do this? \]
   420	000303'	260040	000000*		PUSHJ	P,YESNO		; A "Y" will skip, else assume NO.
   421	000304'	211700	000001		  MOVNI P3,1		; Set for null-command return
   422	000305'	254000	000277*		JRST	CPOPJ1		; Always skip return.
   423
   424
   425	000306'	000000	000000	CMDMSG:	0			; Debugging flag. 0=Type long messages.
   426	000307'	000000	000000	CMDSCF:	0			; Flag for checking UNI/STR Stuff
   427								; 0==No checking, -1==Check!
   428	000310'	000000	000000	SVP2:	0
   429	000311'	000000	000000	SVU:	0
   430
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 8
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   431				;Here from the FILES command in ONCE
   432				FILOPT:	MOVEI	T1,[ASCIZ /
   433				Entering the FILES dialogue...
   434	000312'	201300	765355	  Type "GO" to return to ONCE./]
   435	000313'	260040	763617		PUSHJ	P,CONOUT
   436	000314'	402000	763743		SETZM	BATMAN
   437	000315'	402000	000000*	        SETZM	EVASIZ		;ENSURE EVMINI GETS CALLED IN EVMALC
   438	000316'	260040	762556		PUSHJ	P,RDHOME
   439	000317'	255000	000000		 JFCL
   440	000320'	255000	000000		 JFCL
   441	000321'	260040	763676		PUSHJ	P,REDBAT	;READ BAT PAGES.
   442
   443				HLPFIL:	MOVEI T1,[ASCIZ /
   444				  Type "HELP" for a list of options.
   445	000322'	201300	765372	/]
   446	000323'	260040	000000*	HLPTY1:	PUSHJ P,OCONM
   447	000324'	260040	000000*		PUSHJ P,OPOUT
   448
   449	761325			TYPCMD:
   450	761325			CHGCMD:
   451	761325			SRPCMD:
   452	761325			NULFIL:
   453				FILCMD:	MOVEI T1,[ASCIZ /
   454	000325'	201300	765403	FILES* /]
   455	000326'	260040	000323*		PUSHJ P,OCONM
   456	000327'	260040	000324*		PUSHJ P,OPOUT
   457	000330'	476000	764115		SETOM KNOUNI
   458	000331'	476000	764110		SETOM DBLSTD
   459	000332'	260040	000000*		PUSHJ P,GETLIN
   460	000333'	254000	761325		 JRST FILCMD	;NOTHING THERE
   461	000334'	201600	761371		SCAN (FIL,Z)
   462	000335'	402000	761307
   463	000336'	260040	761211
   464	000337'	254000	761322
   465	000340'	256016	761352
   466	000341'	254000	761325
   467	000342'	200714	777776
   468	000343'	550316	000000
   469	000344'	260040	762544
   470	000345'	253700	761343
   471	000346'	254000	761325
   472
   473					DEFINE MKFIL <
   474					X DSKCLN,<PUSHJ P,SPCDKN>,Ab.Nak!Ab.Ver,<
   475				DSKCLN  Query or Select DSKCLN mode.
   476				        List the current mode and allow the operator to change it.>
   477					X TYPE,<JRST TYPIT>,Ab.Ack,<
   478				TYPE    List information about the structure.
   479				        Type "TYPE HELP" for a list of options.>
   480					X CHANGE,<JRST CHGIT>,Ab.Ack,<
   481				CHANGE  Change information about the structure.
   482				        Type "CHANGE HELP" for a list of options.>
   483					X ADD,<PUSHJ P,ADDUNI>,Ab.Nak!Ab.Ver,<
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 8-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   484				ADD     Add a unit to the structure.
   485				        Reconfigure the disk structure and add another pack.>
   486					X DISOLVE,<JRST BADDIS>,Ab.Nak,<.>
   487					X DISSOLVE,<PUSHJ P,STSDSL>,Ab.Nak!Ab.Ver,<
   488				DISSOLVE Dissolve the disk structure for DSKB.
   489				        Remove all units from the system structure.>
   490					X DEFINE,<PUSHJ P,STSDEF>,Ab.Nak!Ab.Ver,<
   491				DEFINE  Define a NEW structure for DSKB.
   492				        Create a completely new system structure.>
   493					X REFRESH,<PUSHJ P,STSREF>,Ab.Nak!Ab.Ver,<
   494				REFRESH Refresh the structure.
   495				        Delete all files on the system and start over
   496				        with a "FRESH" disk.>
   497					X DDT,<PUSHJ P,DDTX##>,AB.ACK!AB.VER,<
   498				DDT     Enter executive DDT.  To be used ONLY by software wizards
   499				        for emergency patching and examination of the monitor.>,<
   500				        UNDER NO CIRCUMSTANCES SHOULD YOU NORMALLY USE THIS COMMAND!>
   501					X TSTSUP,<PUSHJ P,TSTSUP##>,AB.ACK!AB.VER,<
   502				TSTSUP  Disk patching routine.  To be used ONLY by software wizards
   503				        for emergency patching of the disk structure.>,<
   504				        UNDER NO CIRCUMSTANCES SHOULD YOU NORMALLY USE THIS COMMAND!>
   505					X BOOTS,<JRST SYSBTS##>,AB.NAK!AB.VER,<
   506				BOOTS   Crash the system with "BOOTS LOADED" immediately.>
   507					X GO,<JRST FILGO>,Ab.Ack,<
   508				GO      Leave the FILES dialogue and return to the ONCE
   509				        dialogue.>
   510					X HELP,<JRST FILHLP>,Ab.Ack,<
   511				HELP    Type this message.
   512				>
   513				>
   514	000347'	254000	761322		SCNTB (HLPFIL,HLPFIL,FIL)
   515	000350'	254000	761322
   516	000351'	254000	761325
   517	000352'	260040	764603
   518	000353'	254000	762035
   519	000354'	254000	762220
   520	000355'	260040	764374
   521	000356'	254000	762033
   522	000357'	260040	764342
   523	000360'	260040	764221
   524	000361'	260040	764472
   525	000362'	260040	000000*
   526	000363'	260040	000000*
   527	000364'	254000	000000*
   528	000365'	254000	764675
   529	000366'	254000	761342
   530	000367'	777763	762016
   531	000370'	777763	761371
   532	000371'	446353	435456
   533	000372'	647160	450000
   534	000373'	435041	564745
   535	000374'	414444	000000
   536	000375'	445163	575466
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 8-3
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   537	000376'	445163	635754
   538	000377'	444546	515645
   539	000400'	624546	624563
   540	000401'	444464	000000
   541	000402'	646364	636560
   542	000403'	425757	646300
   543	000404'	475700	000000
   544	000405'	504554	600000
   545	000406'	064250	451626
	000407'	416311	620100
	000410'	507534	571362
	000411'	203376	220246
	000412'	627314	561750
	000413'	202112	345606
	000414'	462344	066736
   546	000415'	623125	606424
	000416'	201004	020100
	000417'	201004	046322
	000420'	717504	072320
	000421'	625014	372744
	000422'	713135	672100
	000423'	667374	462500
	000424'	607354	420302
	000425'	663315	773500
	000426'	723214	520336
	000427'	703136	260750
	000430'	677444	072336
	000431'	203075	060734
	000432'	637124	064750
	000433'	270000	000000
   547	000434'	064252	454640
	000435'	425004	020100
	000436'	463236	372100
	000437'	647354	667744
	000440'	667036	464736
	000441'	671014	161336
	000442'	727504	072320
	000443'	625016	372344
	000444'	727076	472744
   548	000445'	625341	505100
	000446'	201004	020100
	000447'	201012	474740
	000450'	625004	252262
	000451'	502124	044212
	000452'	462404	220314
	000453'	677444	060500
	000454'	663236	372100
	000455'	677144	067740
	000456'	723235	767346
	000457'	270000	000000
   549	000460'	064250	344202
	000461'	472170	520100
	000462'	417214	167316
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 8-4
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

	000463'	625015	167314
	000464'	677455	560750
	000465'	647375	620302
	000466'	613376	572100
	000467'	723214	520346
	000470'	723456	561750
	000471'	727454	527032
   550	000472'	051004	020100
	000473'	201004	020250
	000474'	747414	520104
	000475'	416210	147216
	000476'	425011	042630
	000477'	501044	063336
	000500'	711014	120330
	000501'	647476	420336
	000502'	631015	770350
	000503'	647375	671534
	000504'	000000	000000
   551	000505'	064250	142210
	000506'	201004	020100
	000507'	407114	420302
	000510'	203535	664750
	000511'	203515	720350
	000512'	643124	071750
	000513'	713534	372352
   552	000514'	713125	606424
	000515'	201004	020100
	000516'	201004	051312
	000517'	617375	663322
	000520'	637536	262500
	000521'	723214	520310
	000522'	647475	320346
	000523'	723456	561750
	000524'	727454	520302
	000525'	673104	060710
	000526'	621014	167336
	000527'	723214	571100
	000530'	703034	365534
	000531'	000000	000000
   553	000532'	270000	000000
   554	000533'	064250	444646
	000534'	516371	453212
	000535'	202115	171746
	000536'	677316	662500
	000537'	723214	520310
	000540'	647475	320346
	000541'	723456	561750
	000542'	727454	520314
	000543'	677444	042246
   555	000544'	456045	606424
	000545'	201004	020100
	000546'	201004	051312
	000547'	667376	662500
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 8-5
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

	000550'	607315	420352
	000551'	673236	471500
	000552'	633455	766500
	000553'	723214	520346
	000554'	747476	462732
	000555'	203476	471352
	000556'	617516	571312
	000557'	270000	000000
   556	000560'	064250	442614
	000561'	446350	520100
	000562'	423134	664734
	000563'	625014	120234
	000564'	426564	071750
	000565'	713534	372352
	000566'	713124	063336
	000567'	711010	451626
   557	000570'	411341	505100
	000571'	201004	020100
	000572'	201010	371312
	000573'	607514	520302
	000574'	203075	766740
	000575'	663136	462730
	000576'	745015	662756
	000577'	203477	171750
	000600'	627324	071750
	000601'	713534	372352
	000602'	713125	600000
   558	000603'	064252	242614
	000604'	512132	344100
	000605'	513134	671312
	000606'	717204	072320
	000607'	625016	372344
	000610'	727076	472744
   559	000611'	625341	505100
	000612'	201004	020100
	000613'	201010	462730
	000614'	627514	520302
	000615'	663304	063322
	000616'	663136	320336
	000617'	671016	464312
	000620'	203477	171750
	000621'	627324	060734
	000622'	621016	372302
	000623'	713504	067754
   560	000624'	627441	505100
	000625'	201004	020100
	000626'	201016	764750
	000627'	641014	120104
	000630'	432450	551620
	000631'	211014	464746
	000632'	655340	000000
   561	000633'	064250	442250
	000634'	201004	020100
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 8-6
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

	000635'	427356	462744
	000636'	203137	062706
	000637'	727515	173312
	000640'	202110	452134
	000641'	201012	467500
	000642'	613124	072746
	000643'	627104	047634
	000644'	462624	061362
	000645'	203475	763350
	000646'	737036	262500
	000647'	737237	260744
   562	000650'	623461	505100
	000651'	201004	020100
	000652'	201014	667744
	000653'	203135	562744
	000654'	637135	661762
	000655'	203414	172306
	000656'	643235	663500
	000657'	607354	420312
	000660'	743035	564734
	000661'	607515	167734
	000662'	203374	620350
	000663'	643124	066736
	000664'	673236	467744
   563	000665'	270321	220100
	000666'	201004	020100
	000667'	202531	642212
	000670'	511011	647500
	000671'	416232	241652
	000672'	466472	440634
	000673'	416132	320246
	000674'	442372	546210
	000675'	202631	752500
	000676'	472372	246602
	000677'	462313	120252
	000700'	516124	052220
	000701'	446464	041636
	000702'	466330	147210
	000703'	204000	000000
   564	000704'	064252	451650
	000705'	516532	020100
	000706'	423236	365500
	000707'	703036	461720
	000710'	647354	720344
	000711'	677536	464734
	000712'	625344	020250
	000713'	675014	262500
	000714'	727474	562100
	000715'	476351	454500
	000716'	613624	071736
	000717'	633516	760744
	000720'	625016	764764
	000721'	607454	471432
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 8-7
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   565	000722'	051004	020100
	000723'	201004	020314
	000724'	677444	062732
	000725'	627454	762734
	000726'	617624	070302
	000727'	723075	064734
	000730'	635015	763100
	000731'	723214	520310
	000732'	647475	320346
	000733'	723456	561750
	000734'	727454	527032
   566	000735'	051004	020100
	000736'	201004	020252
	000737'	472110	551100
	000740'	472364	041622
	000741'	512072	546646
	000742'	522031	641612
	000743'	515012	344236
	000744'	526310	420262
	000745'	476524	047236
	000746'	512330	146230
	000747'	545012	551612
	000750'	202511	044646
	000751'	202071	746632
	000752'	406350	420400
   567	000753'	064250	247636
	000754'	522464	020100
	000755'	417454	171720
	000756'	203515	062500
	000757'	717636	372312
	000760'	665016	764750
	000761'	641004	241236
	000762'	476512	320230
	000763'	476030	442610
	000764'	211015	166732
	000765'	627115	160750
	000766'	627317	127000
   568	000767'	064250	747500
	000770'	201004	020100
	000771'	463134	173312
	000772'	203515	062500
	000773'	432231	442646
	000774'	203115	160730
	000775'	677176	562500
	000776'	607354	420344
	000777'	627516	571334
	001000'	203515	720350
	001001'	643124	047634
   569	001002'	416121	505100
	001003'	201004	020100
	001004'	201014	464702
	001005'	663374	772712
	001006'	270000	000000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 8-8
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   570	001007'	064251	042630
	001010'	501004	020100
	001011'	523636	062500
	001012'	723215	171500
	001013'	667136	371702
   571	001014'	637125	606424
	001015'	000000	000000
   572	001016'	000000*	761406
   573	001017'	000000*	761434
   574	001020'	000000*	761460
   575	001021'	000000*	761505
   576	001022'	000000*	761532
   577	001023'	000000*	761533
   578	001024'	000000*	761560
   579	001025'	000000*	761603
   580	001026'	000000*	761633
   581	001027'	000000*	761704
   582	001030'	000000*	761753
   583	001031'	000000*	761767
   584	001032'	000000*	762007
   585
   586				BADDIS:	MOVEI	T1,[ASCIZ /  DISSOLVE is spelled with two "S"es.
   587	001033'	201300	765405	/]			;Here if typed "DISOLVE"
   588	001034'	254000	761323		JRST	HLPTY1
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 9
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   589	001035'	476000	764112	TYPIT:	SETOM TYPONL	;ONLY TYPEOUT
   590	001036'	201600	762067		SCAN (TYP,O)
   591	001037'	476000	761307
   592	001040'	260040	761211
   593	001041'	254000	762051
   594	001042'	256016	762056
   595	001043'	254000	761325
   596	001044'	200714	777776
   597	001045'	550316	000000
   598	001046'	260040	762544
   599	001047'	253700	762045
   600	001050'	254000	761325
   601
   602	762051			NULTYP:
   603				HLPTYP:	MOVEI T1,[ASCIZ /
   604				Type "TYPE HELP" for a list of options.
   605	001051'	201300	765415	/]
   606	001052'	254000	761323		JRST HLPTY1
   607
   608					DEFINE MKTYP <
   609					X STR,<PUSHJ P,TYPSTR>,Ab.Nak,<
   610				STR     Name of the STRUCTURE and UNITS on it.>
   611					X UNITS,<PUSHJ P,TYPUNS>,Ab.Nak,<
   612				UNITS   Names of all units NOT in a file structure.>
   613					X BAT,<PUSHJ P,TYPBAT>,Ab.Nak,<
   614				BAT     Number of BAD pages and regions for a unit.>
   615					X SATPCBS,<PUSHJ P,TYPSPC>,Ab.Nak,<
   616				SATPCBS Number of SAT PCBs.>
   617					X RIBPCBS,<PUSHJ P,TYPRPC>,Ab.Nak,<
   618				RIBPCBS Number of RIB PCBs.>
   619					X ALL,<JRST TYPALL>,Ab.Nak,<
   620				ALL     All of the above.>
   621					X HELP,<JRST TYPHLP>,Ab.Ack,<
   622				str-name  Type information about the structure.
   623				unit-name Type information about the unit.
   624				HELP    Type this message.
   625				>
   626				>
   627	001053'	254000	762343		SCNTB (TYPUIP,TYPSRP,TYP)
   628	001054'	254000	762420
   629	001055'	254000	762051
   630	001056'	260040	764002
   631	001057'	260040	763765
   632	001060'	260040	765037
   633	001061'	260040	764775
   634	001062'	260040	765012
   635	001063'	254000	764024
   636	001064'	254000	762044
   637	001065'	777771	762211
   638	001066'	777771	762067
   639	001067'	636462	000000
   640	001070'	655651	646300
   641	001071'	424164	000000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 9-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   642	001072'	634164	604342
   643	001073'	625142	604342
   644	001074'	415454	000000
   645	001075'	504554	600000
   646	001076'	064252	352244
	001077'	201004	020100
	001100'	473035	562500
	001101'	677144	072320
	001102'	625012	352244
	001103'	526072	452644
	001104'	425014	167310
	001105'	202531	644650
	001106'	515015	767100
	001107'	647505	600000
   647	001110'	064252	547222
	001111'	522464	020100
	001112'	473035	562746
	001113'	203374	620302
	001114'	663304	072734
	001115'	647516	320234
	001116'	476504	064734
	001117'	203024	063322
	001120'	663124	071750
	001121'	713534	372352
	001122'	713125	600000
   648	001123'	064250	240650
	001124'	201004	020100
	001125'	473535	561312
	001126'	711015	763100
	001127'	412030	420340
	001130'	607174	571500
	001131'	607354	420344
	001132'	627175	167734
	001133'	715014	667744
	001134'	203024	072734
	001135'	647505	600000
   649	001136'	064252	340650
	001137'	502070	251500
	001140'	473535	561312
	001141'	711015	763100
	001142'	516032	420240
	001143'	416056	327000
   650	001144'	064252	244604
	001145'	502070	251500
	001146'	473535	561312
	001147'	711015	763100
	001150'	512230	220240
	001151'	416056	327000
   651	001152'	064250	146230
	001153'	201004	020100
	001154'	407315	420336
	001155'	631016	464312
	001156'	203034	267754
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 9-3
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

	001157'	625340	000000
   652	001160'	064256	372344
	001161'	267354	166712
	001162'	201012	474740
	001163'	625015	167314
	001164'	677455	560750
	001165'	647375	620302
	001166'	613376	572100
	001167'	723214	520346
	001170'	723456	561750
	001171'	727454	527032
   653	001172'	053535	664750
	001173'	267354	166712
	001174'	202517	170312
	001175'	203235	663336
	001176'	713334	172322
	001177'	677344	060704
	001200'	677536	420350
	001201'	643124	072734
   654	001202'	647505	606424
	001203'	442131	450100
	001204'	201004	052362
	001205'	703124	072320
	001206'	647464	066712
	001207'	717474	163712
   655	001210'	270321	200000
   656	001211'	000000*	762076
   657	001212'	000000*	762110
   658	001213'	000000*	762123
   659	001214'	000000*	762136
   660	001215'	000000*	762144
   661	001216'	000000*	762152
   662	001217'	000000*	762160
   663
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 10
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   664	001220'	402000	764112	CHGIT:	SETZM TYPONL
   665	001221'	201600	762247		SCAN (CHG,O)
   666	001222'	476000	761307
   667	001223'	260040	761211
   668	001224'	254000	762234
   669	001225'	256016	762241
   670	001226'	254000	761325
   671	001227'	200714	777776
   672	001230'	550316	000000
   673	001231'	260040	762544
   674	001232'	253700	762230
   675	001233'	254000	761325
   676	762234			NULCHG:
   677				HLPCHG:	MOVEI T1,[ASCIZ /
   678				Type "CHANGE HELP" for a list of options.
   679	001234'	201300	765426	/]
   680	001235'	254000	761323		JRST HLPTY1
   681
   682					DEFINE MKCHG <
   683					X SATPCBS,<PUSHJ P,CHGSPC>,Ab.Nak!Ab.Ver,<
   684				SATPCBS   Change the number of SAT PCBs.>
   685					X RIBPCBS,<PUSHJ P,CHGRPC>,Ab.Nak!Ab.Ver,<
   686				RIBPCBS   Change the number of RIB PCBs.>
   687					X BAT,<PUSHJ P,CHGBAT>,Ab.Nak!Ab.Ver,<
   688				BAT       Refresh the BAT pages for a UNIT.>
   689					X HELP,<JRST CHGHLP>,Ab.Ack,<
   690				str-name  Change parameters for the structure
   691				unit-name Change parameters for a unit.
   692				HELP    Type this message.
   693				>
   694				>
   695	001236'	254000	762343		SCNTB (TYPUIP,TYPSRP,CHG)
   696	001237'	254000	762420
   697	001240'	254000	762234
   698	001241'	260040	765000
   699	001242'	260040	765015
   700	001243'	260040	765027
   701	001244'	254000	762227
   702	001245'	777774	762337
   703	001246'	777774	762247
   704	001247'	634164	604342
   705	001250'	625142	604342
   706	001251'	424164	000000
   707	001252'	504554	600000
   708	001253'	064252	340650
	001254'	502070	251500
	001255'	201010	364302
	001256'	673174	520350
	001257'	643124	067352
	001260'	667054	571100
	001261'	677144	051602
	001262'	521012	041604
	001263'	715340	000000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 10-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   709	001264'	064252	244604
	001265'	502070	251500
	001266'	201010	364302
	001267'	673174	520350
	001270'	643124	067352
	001271'	667054	571100
	001272'	677144	051222
	001273'	411012	041604
	001274'	715340	000000
   710	001275'	064250	240650
	001276'	201004	020100
	001277'	201012	262714
	001300'	713136	364100
	001301'	723214	520204
	001302'	406504	070302
	001303'	637136	320314
	001304'	677444	060500
	001305'	526351	152134
	001306'	000000	000000
   711	001307'	064256	372344
	001310'	267354	166712
	001311'	201010	364302
	001312'	673174	520340
	001313'	607454	166712
	001314'	723136	271500
	001315'	633376	220350
	001316'	643124	071750
	001317'	713534	372352
   712	001320'	713121	505352
	001321'	673236	426734
	001322'	607334	520206
	001323'	643035	663712
	001324'	203414	171302
	001325'	667136	462744
	001326'	715014	667744
	001327'	203024	072734
   713	001330'	647505	606424
	001331'	442131	450100
	001332'	201004	052362
	001333'	703124	072320
	001334'	647464	066712
	001335'	717474	163712
   714	001336'	270321	200000
   715	001337'	000000*	762253
   716	001340'	000000*	762264
   717	001341'	000000*	762275
   718	001342'	000000*	762307
   719
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 11
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   720	001343'	550645	000165*	TYPUIP:	HRRZ	P2,UNISTR(U)	;IN CASE IN FS
   721	001344'	202640	762354		MOVEM	P2,UIPSVU	;SAVE IT!
   722	001345'	201600	762375		MOVEI	P1,SCNUIP	; Get address of Scan Table
   723	001346'	476000	761307		SETOM	CMDSCF		; Specify STR/UNIT stuff
   724	001347'	260040	761211		PUSHJ	P,CMDSCN	; Call Scanning routine
   725	001350'	254000	762362		  JRST	HLPUIP		; No good!
   726	001351'	200640	762354		MOVE	P2,UIPSVU	;RESTORE in case needed.
   727	001352'	256016	762371		XCT	DSPUIP(P3)	; Yes?
   728	001353'	254000	761325		JRST	FILCMD		; Return as if cr typed.
   729	001354'	000000	000000	UIPSVU:	0
   730
   731	001355'	200714	777776	UIPHLP:	Move	P3,-2(P1)	; Setup AOBJN pointer for messages
   732	001356'	550316	000000	UIPHL1:	Hrrz	T1,(P3)		; Get address of message
   733	001357'	260040	762544		Pushj	P,LNGMES	; Print a long message
   734	001360'	253700	762356		Aobjn	P3,UIPHL1	; Next?
   735	001361'	254000	761325		Jrst	FILCMD		; Return.
   736	762362			NULUIP:
   737				HLPUIP:	MOVEI T1,[ASCIZ /
   738	001362'	201300	765440	Type "TYPE unit-name HELP" for a list of options./]
   739	001363'	331000	764112		SKIPL TYPONL
   740					MOVEI T1,[ASCIZ /
   741	001364'	201300	765453	Type "CHANGE unit-name HELP" for a list of options./]	;WAS A CHANGE
   742	001365'	254000	761323		JRST HLPTY1
   743
   744					DEFINE MKUIP <
   745					X ID,<PUSHJ P,UNITID>,Ab.Nak!Ab.Ver!Ab.Tcv,<
   746				... ID    Unit ID.>
   747					X HELP,<JRST UIPHLP>,Ab.Ack,<
   748				... HELP  Type this message.
   749				>
   750				>
   751	001366'	254000	762362		SCNTB (HLPUIP,HLPUIP,UIP)
   752	001367'	254000	762362
   753	001370'	254000	762362
   754	001371'	260040	764151
   755	001372'	254000	762355
   756	001373'	777776	762413
   757	001374'	777776	762375
   758	001375'	514400	000000
   759	001376'	504554	600000
   760	001377'	064245	627134
	001400'	202230	420100
	001401'	201012	567322
	001402'	721011	142134
	001403'	000000	000000
   761	001404'	064245	627134
	001405'	202210	546240
	001406'	201012	474740
	001407'	625016	464322
	001410'	715015	562746
	001411'	717034	762534
   762	001412'	064240	000000
   763	001413'	000000*	762377
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 11-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   764	001414'	000000*	762404
   765
   766	001415'	336005	000000*	UNCHKA:	SKIPN UNIHID(U)
   767	001416'	260040	764151		PUSHJ P,UNITID
   768	001417'	324740	764142		PJRST	UNITST
   769
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 12
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   770
   771	001420'	201600	762450	TYPSRP:	SCAN (SRP,O)
   772	001421'	476000	761307
   773	001422'	260040	761211
   774	001423'	254000	762433
   775	001424'	256016	762442
   776	001425'	254000	761325
   777	001426'	200714	777776
   778	001427'	550316	000000
   779	001430'	260040	762544
   780	001431'	253700	762427
   781	001432'	254000	761325
   782	762433			NULSRP:
   783				HLPSRP:	MOVEI T1,[ASCIZ /
   784	001433'	201300	765466	Type "TYPE str-name HELP" for a list of options./]
   785	001434'	331000	764112		SKIPL TYPONL
   786					MOVEI T1,[ASCIZ /
   787	001435'	201300	765501	Type "CHANGE str-name HELP" for a list of options./]
   788	001436'	254000	761323		JRST HLPTY1
   789
   790					DEFINE MKSRP <
   791					X OVERDRAW,<PUSHJ P,STRTOV>,Ab.Nak!Ab.Ver!Ab.Tcv,<
   792				... OVERDRAW  The number of pages for overdraw.>
   793					X CRASH,<PUSHJ P,STRTCH>,Ab.Nak!Ab.Ver!Ab.Tcv,<
   794				... CRASH     The number of pages for CRASH.SAV.>
   795					X ALL,<JRST STRTPA>,Ab.Nak!Ab.Ver!Ab.Tcv,<
   796				... ALL       All of the ABOVE.
   797				              The number of pages for Overdraw, for CRASH.SAV.>
   798					X HELP,<JRST SRPHLP>,Ab.Ack,<
   799				... HELP      Type this message.
   800				>
   801				>
   802	001437'	254000	762433		SCNTB (HLPSRP,HLPSRP,SRP)
   803	001440'	254000	762433
   804	001441'	254000	762433
   805	001442'	260040	764210
   806	001443'	260040	764174
   807	001444'	254000	762541
   808	001445'	254000	762426
   809	001446'	777774	762535
   810	001447'	777774	762450
   811	001450'	576645	624462
   812	001451'	436241	635000
   813	001452'	415454	000000
   814	001453'	504554	600000
   815	001454'	064245	627134
	001455'	202372	642644
	001456'	422450	153500
	001457'	202515	062500
	001460'	673535	561312
	001461'	711015	763100
	001462'	703034	762746
	001463'	203155	771100
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 12-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

	001464'	677554	571310
	001465'	713036	727000
   816	001466'	064245	627134
	001467'	202072	240646
	001470'	441004	020100
	001471'	202515	062500
	001472'	673535	561312
	001473'	711015	763100
	001474'	703034	762746
	001475'	203155	771100
	001476'	416450	151620
	001477'	272470	153134
	001500'	000000	000000
   817	001501'	064245	627134
	001502'	202031	446100
	001503'	201004	020100
	001504'	202035	466100
	001505'	677144	072320
	001506'	625010	141236
   818	001507'	532125	606424
	001510'	201004	020100
	001511'	201004	020100
	001512'	201004	020250
	001513'	643124	067352
	001514'	667054	571100
	001515'	677144	070302
	001516'	637136	320314
	001517'	677444	047754
	001520'	627454	471302
	001521'	735304	063336
	001522'	711010	351202
	001523'	516205	651602
	001524'	531340	000000
   819	001525'	064245	627134
	001526'	202210	546240
	001527'	201004	020100
	001530'	202517	170312
	001531'	203515	064746
	001532'	203334	571746
	001533'	607174	527032
   820	001534'	050000	000000
   821	001535'	000000*	762454
   822	001536'	000000*	762466
   823	001537'	000000*	762501
   824	001540'	000000*	762525
   825
   826	001541'	260040	764210	STRTPA:	PUSHJ P,STRTOV
   827	001542'	260040	764174		PUSHJ P,STRTCH
   828	001543'	254000	761325		JRST SRPCMD
   829
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 13
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   830				;HELP INFORMATION
   831
   832	001544'	505300	440700	LNGMES:	HRLI T1,(POINT 7,0)
   833	001545'	134400	000006	LNGMS1:	ILDB T3,T1
   834	001546'	322400	000000*		JUMPE T3,CPOPJ
   835	001547'	260040	000000*		PUSHJ P,COMTYO
   836	001550'	302400	000012		CAIE T3,12
   837	001551'	254000	762545		JRST LNGMS1
   838	001552'	261040	000006		PUSH P,T1
   839	001553'	260040	000327*		PUSHJ P,OPOUT
   840	001554'	262040	000006		POP P,T1
   841	001555'	254000	762545		JRST LNGMS1
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 14
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   842				COMMENT #
   843				@@SUBROUTINE RDHOME
   844				@@PURPOSE
   845				SUBR TO READ & VERIFY HOME PAGES FOR ALL UNITS AT SYSTEM
   846				INITIALIZATION.  BUILDS THE SYSTEM STR.
   847				SETS INFO IN THE STR DB AND IN THE UNIT DBS.
   848				@@CALLS
   849
   850				@@EXIT
   851				NON-SKIP RETURNS IF AN ERROR WAS DETECTED WHILE READING THE
   852				HOME PAGES OF 1 OR MORE UNITS AND/OR NO STR WAS CREATED
   853				AND/OR MORE THAN ONE STR WAS CREATED.
   854				SKIP RETURNS IF ALL HOME PAGES THAT WERE NOT DOWN READ OK.
   855				@@ #
   856
   857	001556'	260040	000000*	RDHOME:	PUSHJ	P,INLMES##
   858					 ASCIZ /
   859	001557'	064250	364312	Checking all units on disk controller - reading UNIT ID from HOME pages./
	001560'	617275	167316
	001561'	203035	466100
	001562'	727355	172346
	001563'	203375	620310
	001564'	647475	320306
	001565'	677356	471336
	001566'	663314	571100
	001567'	265016	262702
	001570'	623235	663500
	001571'	526351	152100
	001572'	446104	063344
	001573'	677324	044236
	001574'	466124	070302
	001575'	637136	327000
   860	001576'	476000	763117		SETOM	TYPUI0		;Force CRLF next output from TYPUID
   861	001577'	402000	000002*		SETZM	DSKDDB+DEVIOS	;
   862	001600'	700600	000200		WRPI	LI.PIN		;TURN PI SYSTEM ON FOR WAITS
   863	001601'	332200	000174*		SKIPE	F,DDSTAR	;IS THERE A DDB SETUP?
   864	001602'	260040	000175*		PUSHJ	P,CLRDDB	;YES, CLEAR IT
   865	001603'	200300	000000*		MOVE	T1,ONCDDB	;GET LOCATION OF ONCE ONLY DDB
   866	001604'	202300	001601*		MOVEM	T1,DDSTAR
   867	001605'	260040	000000*		PUSHJ	P,SETDDO	;CREATE A DDB FOR ONCE ONLY I/O
   868	001606'	256000	761000		 STOPCD .
   869	001607'	260040	764362		PUSHJ	P,CLRSTR	;INITIALLY THERE IS NO STR.
   870	001610'	402000	763230		SETZM	RANHOM		; Clear so pack-set id check works
   871	001611'	554240	000170*		HLRZ	U,SYSUNI	;GET ADR. OF 1ST UNIT DATA BLOCK IN SYSTEM.
   872	001612'	322240	762617		JUMPE	U,RDHOM2	;
   873	001613'	205400	000000*		MOVSI	T3,UNPPRV	;
   874	001614'	436405	000171*	RDHOM1:	IORM	T3,UNIDES(U)	;SET UNIT TO BE A PRIVATE PACK.
   875	001615'	554245	000172*		HLRZ	U,UNISYS(U)	;
   876	001616'	326240	762614		JUMPN	U,RDHOM1	;
   877	001617'	554240	001611*	RDHOM2:	HLRZ	U,SYSUNI	;
   878	001620'	402000	763226		SETZM	ERRHOM		;CLEAR ERROR(S) WHILE READING HOME PAGES FLAG
   879	001621'	402000	763227		SETZM	ERRHM2
   880	001622'	634300	000006		TDZA	T1,T1
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 14-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   881	001623'	200300	000002	SCNUNI:	 MOVE	T1,J		;SAVE OLD KON
   882	001624'	550105	000000*		HRRZ	J,UNIKON(U)	;GET ADR. OF KONTROLLER DATA PAGE FOR THIS UNIT
   883	001625'	335002	000000*		SKIPGE	KONUPA(J)	;HAS KONTROLLER BEEN FLAGGED AS DOWN?
   884	001626'	254000	762650		 JRST	FLGDWN		;YES - FLAG UNIT AS DOWN ALSO
   885	001627'	316300	000002		CAMN	T1,J		;IS IT THE SAME
   886	001630'	254000	762645		 JRST	KONTOK		;YES, DO NOT NEED TO TRY AGAIN
   887	001631'	260062	001625*	TRYKON:	PUSHJ	P,@KONUPA(J)	;SEE IF KONTROLLER IS UP
   888	001632'	334605	000000*		  SKIPA	P1,UNINAM(U)	;IT'S DOWN
   889	001633'	254000	762645		JRST	KONTOK		;NOW SEE IF UNIT IS OK
   890
   891				;HERE IF KONTROLLER IS DOWN.
   892	001634'	513000	000014		HLLZS	P1		;GET SIXBIT KONTROLLER NAME
   893					MOVEI	T3,[ASCIZ .DO YOU WANT IT TO BE 1)ON-LINE, OR 2)DOWN? (TYPE #)
   894	001635'	201400	765514	.]
   895	001636'	260040	763235		PUSHJ	P,MCKKON	;PRINT MSG & GET ANSWER
   896	001637'	254000	762631		  JRST	TRYKON		;ILLEGAL RESPONSE
   897	001640'	302340	000002		CAIE	T2,2		;WAS "2" TYPED?
   898	001641'	254000	762631		JRST	TRYKON		;NO - CHECK AGAIN IF "1" OR ANYTHING ELSE WAS TYPED
   899	001642'	205300	000000*		MOVSI	T1,KOPDWN	;KONTROLLER DOWN BIT(SIGN BIT)
   900	001643'	436302	000000*		IORM	T1,KONDWN(J)	;FLAG KONTROLLER AS DOWN
   901	001644'	254000	762650		JRST	FLGDWN		;FLAG UNIT DOWN AS WELL
   902
   903				;HERE IF KONTROLLER ON-LINE - TO CHECK IF UNIT OK
   904	762645			KONTOK:
   905				IFCPU (F3),<
   906					MOVSI	T1,UNPOFL
   907					TDNE	T1,UNIDES(U)	;IS UNIT OFF-LINE OR DOWN?
   908					 JRST	SCNUN1		;YES - CONTINUE SCAN ON NEXT UNIT
   909				>;END IFCPU (F3)
   910	001645'	260040	763554		PUSHJ	P,DSKCPY	;GET CAPACITY AND SEE IF UP
   911	001646'	331445	000000*		SKIPL	T4,UNIONC(U)	;1B0 set if off-line, 1B1 if write-protect
   912	001647'	254000	762702		 JRST	WCKUNI		;IF POSITIVE, UNIT IS UP
   913				;Use routine TYPUID instead of UNTDWN to report off-line units
   914
   915				;HERE TO FLAG UNIT AS DOWN & OFF-LINE.
   916	001650'	201340	000000*	FLGDWN:	MOVEI	T2,SYSUNI-UNISYS ;SYSUNI - UNISYS
   917	001651'	554307	001615*	FLGDN1:	HLRZ	T1,UNISYS(T2)	;NEXT UNIT IN SYSTEM
   918	001652'	316300	000005		CAMN	T1,U		;SKIP IF NOT FOUND DOWN UNIT
   919	001653'	254000	762657		 JRST	FLGDN2
   920	001654'	554347	001651*		HLRZ	T2,UNISYS(T2)	;NEXT UNIT IN SYSTEM
   921	001655'	326340	762651		JUMPN	T2,FLGDN1
   922	001656'	254000	762661		JRST	FLGDN3		;NOT THERE?
   923
   924	001657'	554306	001654*	FLGDN2:	HLRZ	T1,UNISYS(T1)	;LINK TO NEXT UNIT
   925	001660'	506307	001657*		HRLM	T1,UNISYS(T2)	;STORE IN PREVIOUS
   926	001661'	334340	000005	FLGDN3:	SKIPA	T2,U		;T2 = THIS UNIT
   927	001662'	554347	001624*	FLGDN4:	 HLRZ	T2,UNIKON(T2)	;NEXT UNIT IN KONTROLLER RING
   928	001663'	554307	001662*		HLRZ	T1,UNIKON(T2)	;NEXT BACK TO US?
   929	001664'	312300	000005		CAME	T1,U
   930	001665'	254000	762662		 JRST	FLGDN4		;NO
   931	001666'	554306	001663*		HLRZ	T1,UNIKON(T1)	;YES, LINK TO NEXT
   932	001667'	506307	001666*		HRLM	T1,UNIKON(T2)	;STORE IN PREVIOUS
   933	001670'	334340	000005		SKIPA	T2,U		;T2 = THIS
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 14-3
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   934	001671'	554347	000000*	FLGDN5:	 HLRZ	T2,UNICHN(T2)	;T2 = NEXT UNIT IN CHANNEL RING
   935	001672'	554307	001671*		HLRZ	T1,UNICHN(T2)
   936	001673'	312300	000005		CAME	T1,U		;BACK TO US?
   937	001674'	254000	762671		 JRST	FLGDN5		;NO
   938	001675'	554306	001672*		HLRZ	T1,UNICHN(T1)	;LINK TO NEXT
   939	001676'	506307	001675*		HRLM	T1,UNICHN(T2)	;STORE IN PREVIOUS
   940	001677'	205300	000000*		MOVSI	T1,UNPOFL	;OFF-LINE BIT
   941	001700'	436305	001614*		IORM	T1,UNIDES(U)	;SET BIT IN LH. OF UNIDES WORD
   942	001701'	254000	763071		JRST	SCNUN1		;CONTINUE SCAN ON NEXT UNIT
   943
   944				;HERE IF UNIT ON-LINE - TO CHECK IF UNIT WRITE ENABLED
   945	001702'	205300	000000*	WCKUNI:	MOVSI T1,UNPHWP
   946	001703'	616305	001700*		TDNN T1,UNIDES(U)
   947	001704'	607440	200000		TLNN T4,(1B1)		;IS IT WRITE PROTECTED?
   948	001705'	254000	762715		 JRST CHKHOM		;UNIT IS OK OR HAVE BEEN HERE BEFORE
   949					MOVEI	T3,[ASCIZ .DO YOU WANT IT TO BE 1)WRITE-ENABLED, OR 2)WRITE-PROTECTED? (TYPE #)
   950				
   951	001706'	201400	765527	.]
   952	001707'	260040	763231		PUSHJ	P,WRPUNM	;PRINT MSG & GET ANSWER
   953	001710'	254000	762631		  JRST	TRYKON		;ILLEGAL RESPONSE
   954	001711'	302340	000002		CAIE	T2,2		;WAS "2" TYPED?
   955	001712'	254000	762631		JRST	TRYKON		;NO - CHECK AGAIN IF "1" OR ANYTHING ELSE WAS TYPED
   956	001713'	205300	001702*		MOVSI	T1,UNPHWP	;HARDWARE WRITE-PROTECT BIT
   957	001714'	436305	001703*		IORM	T1,UNIDES(U)	;FLAG UNIT AS WRITE PROTECTED
   958					PFALL	CHKHOM
   959
   960				;HERE IF UNIT ON-LINE & LEGALLY WRITE PROTECTED OR ENABLED - CHECK ITS HOME PAGES
   961
   962	001715'	260040	763354	CHKHOM:	PUSHJ	P,GETHOM	;GET HOME PAGE INTO CORE.
   963	001716'	304000	000000		  CAIA			;ERROR(S) ON BOTH HOME PAGES - T3 RETURNED NON 0.
   964	001717'	254000	762727		JRST	HMBOK		;AT LEAST ONE HOME PAGE OK
   965								;FORCE TO BE A NULL PAGE, NO OPTIONS
   966	001720'	201300	753000		MOVEI	T1,%HOM		;
   967	001721'	260040	000000*		PUSHJ	P,CORZER	;
   968	001722'	202640	753000*		MOVEM	P2,%HOM+PAGNAM	;STORE SIXBIT "HOM"
   969	001723'	202700	753000*		MOVEM	P3,%HOM+PAGCOD	;STORE HOME PAGE CODE
   970	001724'	260040	763624		PUSHJ	P,SETCHG	;FLAG THAT THIS UNIT'S HOME PAGE MUST BE REWRITTEN
   971	001725'	260040	763265		PUSHJ	P,MOVUNI	;MOVE PARAMS FROM HOME PAGE TO UNIT DATA BLOCK.
   972	001726'	254000	763054		JRST	NTISTR		;
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 15
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   973				;HERE IF HOME PAGE(S) READ INTO CORE OK
   974				; GENERATE STR DB & LINK UNIT DBS CORRECTLY.
   975
   976	001727'	322400	762731	HMBOK:	JUMPE	T3,.+2		;ERR WHILE READING HOME PAGES?
   977	001730'	260040	763624		PUSHJ	P,SETCHG	;YES. FLAG THEY NEED REWRITING.
   978	001731'	260040	763265		PUSHJ	P,MOVUNI	;MOVE PARAMS FROM HOME PAGE TO UNIT DB
   979	001732'	201640	000000		MOVEI	P2,0		;SET STR DB ADR. = 0 IN CASE NO STR FOUND
   980	001733'	200300	753000*		MOVE	T1,%HOM+HOMSNM	;GET STR NAME FROM HOME PAGE.
   981	001734'	322300	763054		JUMPE	T1,NTISTR	;DON'T LOOK FOR OR CREATE A ZERO STR NAME.
   982	001735'	260040	763260	HMBOK2:	PUSHJ	P,FNDSTR	;DOES THIS STR EXIST?
   983	001736'	254000	762756		  JRST	NOTPRV		;YES. UNIT IS NOT A PRIVATE PACK.
   984	001737'	332015	000000*		SKIPE	STRNAM(P2)	;NO, DOES ANY STR EXIST?
   985	001740'	254000	763047		 JRST	NOSTR		;YES, ONLY ONE STR IS LEGAL. DIE.
   986								;NO, THIS IS THE SYSTEM STR.
   987	001741'	260040	763304		PUSHJ	P,MOVSTR	;MOVE PARAMS FROM HOME PAGE TO STR DB.
   988	001742'	200340	761003		MOVE	T2,REONCE	;GET ONCE COPY OF RESTRT WORD
   989	001743'	621340	140000		TLZ	T2,DCN.UR!DCN.MN	;IN CASE STR IS MODIFIED
   990	001744'	550300	753000*		HRRZ	T1,%HOM+HOMRAN	;GET PACK SET ID
   991	001745'	312300	000000*		CAME	T1,REPSID	;HAS NEW PACK SET BEEN MOUNTED?
   992	001746'	254000	762754		 JRST	HMBOK3		;YES: IGNORE RESTRT
   993	001747'	400300	000000		SETZ	T1,		;ZERO DSKCLN TYPE SPEC FLAG WORD
   994	001750'	602340	000000*		TRNE	T2,RE.DCD	;DID USER SELECT A DSKCLN TYPE?
   995	001751'	661300	100000		 TLO	T1,DCN.UR	;YES: SO INDICATE
   996	001752'	661300	040000		TLO	T1,DCN.MN	;IND MON SELECTED A DSKCLN TYPE
   997	001753'	436300	000057*		IORM	T1,DCN
   998	001754'	200300	753000*	HMBOK3:	MOVE	T1,%HOM+HOMDCT	;INITIALIZE FOR VERIFICATION OF
   999	001755'	137300	761010		DPB	T1,DCNYHM	; HOME BLOCK DSKCLN TYPE VALIDITY
  1000	001756'	260040	763631	NOTPRV:	PUSHJ	P,SETPUB	;SET THE UNIT PUBLIC.
  1001
  1002				    ;HERE WHEN STR UNIT BELONGS IN EXISTS
  1003	001757'	322640	763011	OLDSTR:	JUMPE	P2,OLDST8	;SKIP OVER RAN & HSH CHK IF NO STR.
  1004	001760'	135300	761010		LDB	T1,DCNYHM	;SET UP TO VERIFY THAT HOME
  1005	001761'	505300	000000*		HRLI	T1,HOMDCV	; DSKCLN TYPE IS VALID/CONSISTENT
  1006	001762'	515340	020000		HRLZI	T2,DCN.HM
  1007	001763'	312300	753000*		CAME	T1,%HOM+HOMDCT	;IS TYPE GOOD?
  1008	001764'	412340	001753*		 ANDCAM	T2,DCN		;NO: SO INDICATE
  1009	001765'	554300	753000*		HLRZ	T1,%HOM+HOMHSH	;T1/ UNIT'S HASH CONSTANT.
  1010	001766'	322300	762775		JUMPE	T1,OLDST1	;MUST BE NON-ZERO.
  1011	001767'	550355	000000*	OLDST2:	HRRZ	T2,STRHSH(P2)	;T2/ STR'S HASH CONSTANT SET
  1012	001770'	326340	762773		JUMPN	T2,OLDST0	;YET?
  1013	001771'	542315	001767*		HRRM	T1,STRHSH(P2)	;NO, JUST STORE FIRST FOUND.
  1014	001772'	254000	762777		JRST	OLDST4		;GO TO RAN LOOK.
  1015	001773'	306307	000000	OLDST0:	CAIN	T1,(T2)		;YES, BETTER MATCH OTHERS'.
  1016	001774'	254000	762777		 JRST	OLDST4		;OKAY.
  1017	001775'	201300	765546	OLDST1:	MOVEI	T1,[ASCIZ /MISSING OR INCONSISTENT HASH CONSTANT FOR UNIT /]
  1018	001776'	260040	763345		PUSHJ	P,MSGUNI	;
  1019	001777'	550300	753000*	OLDST4:	HRRZ	T1,%HOM+HOMRAN	;T1/ UNIT'S PACK SET ID.
  1020	002000'	322300	763007		JUMPE	T1,OLDST5	;CAN'T BE ZERO.
  1021	002001'	332340	763230	OLDST6:	SKIPE	T2,RANHOM	;ALREADY SEEN ID?
  1022	002002'	254000	763005		 JRST	STRFIX		;YES.
  1023	002003'	552300	763230		HRRZM	T1,RANHOM	;NO, JUST STORE FIRST FOUND.
  1024	002004'	254000	763011		 JRST	OLDST8		;
  1025	002005'	306307	000000	STRFIX::CAIN	T1,(T2)		;YES, BETTER MATCH OTHERS'.
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 15-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1026	002006'	254000	763011		 JRST	OLDST8		;OKAY.
  1027				 ;Label STRFIX to JFCL missing or inconsistant pack set it
  1028	002007'	201300	765560	OLDST5:	MOVEI	T1,[ASCIZ /MISSING OR INCONSISTENT PACK SET ID FOR UNIT /]
  1029	002010'	260040	763345		PUSHJ	P,MSGUNI	;
  1030	763011			OLDST8:	
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 16
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1031	002011'	322640	763054		JUMPE	P2,NTISTR	;IF UNIT NOT IN STR, JUMP OVER THIS.
  1032					MOVEI	T1,[ASCIZ .
  1033	002012'	201300	765572	DISK FORMAT DOES NOT MATCH EXPECTED FORMAT ON UNIT .]
  1034	002013'	336340	000000*		SKIPN	T2,DSKPPU##	;# of disk pages per unit we expect
  1035	002014'	200345	000153*		 MOVE	T2,UNIPPU(U)	;If zero, we can accept anything
  1036	002015'	312345	002014*		CAME	T2,UNIPPU(U)	;Match?
  1037	002016'	260040	763345		 PUSHJ	P,MSGUNI	;Error, don't let BPXKON destroy 3650 disk
  1038	002017'	135340	000072*		LDB	T2,UNYLUN	;GET LOGICAL UNIT # WITHIN STR
  1039	002020'	332000	753000*		SKIPE	%HOM+HOMNXT	;IS THIS LAST UNIT IN STR?
  1040	002021'	254000	763033		 JRST	NLSUNI		;NO - GO LINK UNIT DATA BLOCK INTO STR
  1041	002022'	550315	000000*		HRRZ	T1,STRUNM(P2)	;HAVE WE ALREADY SEEN A LAST UNIT FOR THIS STR?
  1042	002023'	322300	763030		JUMPE	T1,LSTUNI	;NO - NOW WE HAVE
  1043	002024'	261040	000007		PUSH	P,T2		;SAVE LOG. UNIT #
  1044					MOVEI	T1,[ASCIZ .
  1045	002025'	201300	765605	MORE THAN ONE LAST UNIT IN STR .]
  1046	002026'	260040	763336		PUSHJ	P,MSGSTR	;PRINT MSG FOLLOWED BY SIXBIT STR NAME
  1047	002027'	262040	000007		POP	P,T2		;RESTORE LOG. UNIT #
  1048
  1049				;HERE WHEN UNIT READ IS THE LAST IN A STR.
  1050
  1051	002030'	405340	000077	LSTUNI:	ANDI	T2,77		;MAX. OF 64 UNITS IN STR!!!!!!!
  1052	002031'	542355	002022*		HRRM	T2,STRUNM(P2)	;STORE LOG. # OF LAST UNIT IN STR
  1053	002032'	350015	002031*		AOS	STRUNM(P2)	;LEAVE T2 ALONE BUT MAKE MEMORY OK
  1054
  1055				;HERE WHEN UNIT READ ISN'T LAST IN THE STR
  1056				; LINK UNIT TO STR & OTHER UNITS IN STR
  1057
  1058	002033'	201455	000000*	NLSUNI:	MOVEI	T4,STRUNI(P2)	;GET ADR. OF LINK TO 1ST. UNIT DATA BLOCK IN STR
  1059	002034'	254000	763041		JRST	LINKT1
  1060
  1061	002035'	135400	000000*	LINKIT:	LDB	T3,UNYLN1	;YES - GET LOG. UNIT # OF NEXT UNIT
  1062	002036'	313400	000007		CAMLE	T3,T2		;IS IT GREATER THAN UNIT JUST READ?
  1063	002037'	254000	763043		 JRST	INSERT		;YES - INSERT UNIT DATA BLOCK HERE
  1064	002040'	201446	001343*		MOVEI	T4,UNISTR(T1)	;GET ADR. OF LINK TO NEXT UNIT
  1065	002041'	554311	000000	LINKT1:	HLRZ	T1,(T4)		;GET ADR. OF NEXT UNIT DATA BLOCK IN STR
  1066	002042'	326300	763035		JUMPN	T1,LINKIT	;MORE DATA BLOCKS?
  1067	002043'	506305	002040*	INSERT:	HRLM	T1,UNISTR(U)	;SAVE LINKS TO STR & NEXT UNIT DATA BLOCK
  1068	002044'	542645	002043*		HRRM	P2,UNISTR(U)	; IN THIS UNIT DATA BLOCK
  1069	002045'	506251	000000		HRLM	U,(T4)		;SAVE THIS UNIT ADR. IN PREVIOUS UNIT DATA BLOCK
  1070								; (OR STR DATA BLOCK)
  1071	002046'	254000	763055		JRST	CRESTT		;TRY & SETUP SAB RING & SPT TABLE FOR THIS UNIT
  1072
  1073				NOSTR:	MOVEI T1,[ASCIZ /
  1074	002047'	201300	765614	TOO MANY STR'S /]
  1075	002050'	260040	000326*		PUSHJ P,OCONM
  1076	002051'	200340	753000*		MOVE	T2,%HOM+HOMSNM
  1077	002052'	260040	763343		PUSHJ P,NAMFLO
  1078	002053'	256000	761000		STOPCD
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 17
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1079				;HERE TO CREATE STT TABLE FOR THIS UNIT.
  1080				;(EVEN IF NOT IN STR, MAY ADD TO STR LATER.).
  1081
  1082	002054'	402005	000000*	NTISTR:	SETZM	UNILOG(U)	;INDICATE UNIT NOT IN A STR.
  1083	002055'	260040	764134	CRESTT:	PUSHJ	P,SPUCLC	;CALC NO. SATS ON UNIT.
  1084	002056'	135700	000155*		LDB	P3,UNYSPU	;
  1085	002057'	221700	000151*		IMULI	P3,STTLEN	;COMPUTE LENGTH OF
  1086	002060'	271700	000001		ADDI	P3,1		;STT TABLE.
  1087	002061'	200340	000016		MOVE	T2,P3		;GET TOTAL NO. OF WORDS NEEDED
  1088	002062'	260040	000000*		PUSHJ	P,EVMALC##	;FOR STT
  1089	002063'	542305	000122*		HRRM	T1,UNISTT(U)	;STORE ADR OF STT IN UNIT DB.
  1090	002064'	402006	000000		SETZM	(T1)		;
  1091	002065'	515346	000000		HRLZI	T2,(T1)		;BUILD A
  1092	002066'	541346	000001		HRRI	T2,1(T1)	;BLT AC.
  1093	002067'	271316	777777		ADDI	T1,-1(P3)	;ADR OF LAST WORD IN STT TABLE.
  1094	002070'	251346	000000		BLT	T2,(T1)		;CLEAR THE STT.
  1095
  1096	002071'	260040	763120	SCNUN1:	PUSHJ	P,TYPUID	;Output physical name and HOM id
  1097	002072'	554245	001660*		HLRZ	U,UNISYS(U)	;GET NEXT UNIT DB ADR IN SYSTEM.
  1098	002073'	326240	762623		JUMPN	U,SCNUNI	;AROUND AGAIN IF ANY LEFT
  1099	002074'	260040	763620		PUSHJ	P,CRLFOP	;Finish off last disk report line
  1100	002075'	260040	763620		PUSHJ	P,CRLFOP	;Add a blank line
  1101
  1102					PRINTF(<[Need to define seperate UNTTBL for each STR]>)
  1103				    ;HERE TO CREATE UNTTBL.
  1104	002076'	402000	000000*		SETZM	UNTTBL		;CLEAR OUT
  1105	002077'	505300	002076*		HRLI	T1,UNTTBL	;ALL
  1106	002100'	541300	000001*		HRRI	T1,UNTTBL+1	;OF
  1107	002101'	251300	000000*		BLT	T1,UNTTBL+UNTLEN-1 ;UNTTBL.
  1108
  1109	002102'	554240	001617*		HLRZ U,SYSUNI		;GET SET TO GENERATE UNTTBL
  1110	002103'	201300	777777*		MOVEI T1,UNTLEN-1
  1111	002104'	322240	763154	SETUNT:	JUMPE U,SCNSTR	;DONE
  1112	002105'	332005	002054*		SKIPE UNILOG(U)		;IS IT IN A STR?
  1113	002106'	254000	763113		JRST SETUTS		;YES
  1114	002107'	202246	002077*		MOVEM U,UNTTBL(T1)
  1115	002110'	137300	002017*		DPB T1,UNYLUN
  1116	002111'	554245	002072*		HLRZ U,UNISYS(U)
  1117	002112'	364300	763104		SOJA T1,SETUNT		;AND GO
  1118
  1119	002113'	135340	002110*	SETUTS:	LDB T2,UNYLUN
  1120	002114'	202247	002107*		MOVEM U,UNTTBL(T2)
  1121	002115'	554245	002111*		HLRZ U,UNISYS(U)
  1122	002116'	254000	763104		JRST SETUNT
  1123
  1124	002117'	777777	777777	TYPUI0:	-1
  1125	002120'	265340	763660	TYPUID:	JSP	T2,SVOTAC	;Save ACs
  1126	002121'	350340	763117		AOS	T2,TYPUI0	;Formatting
  1127	002122'	606340	000003		TRNN	T2,3		;If multiple of 4,
  1128	002123'	260040	763620		 PUSHJ	P,CRLFOP	; start a new line
  1129	002124'	135340	000000*		LDB	T2,UNYPUN##	;Get physical unit number
  1130	002125'	307340	000007		CAIG	T2,7		;If single digit number
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 17-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1131	002126'	260040	000000*		 PUSHJ	P,PRSPC##	; output leading blank
  1132	002127'	200345	001632*		MOVE	T2,UNINAM(U)
  1133	002130'	260040	000000*		PUSHJ	P,PRNAME##	;Physical unit name
  1134	002131'	260040	000000*		PUSHJ	P,PRCOL##	;Colon
  1135	002132'	335305	001646*		SKIPGE	T1,UNIONC(U)	;Off line?
  1136	002133'	254000	763143		 JRST	TYPUI1		;Yes
  1137	002134'	200345	001415*		MOVE	T2,UNIHID(U)	;No, get UNIT-ID from HOM block
  1138	002135'	260040	000000*		PUSHJ	P,PRNAMF##	;Output 6 digits
  1139	002136'	332345	002105*		SKIPE	T2,UNILOG(U)	;Get name (such as 'DSKB17')
  1140	002137'	505340	000035		 HRLI	T2,'  ='	;If blank leave it blank, else
  1141	002140'	241340	000014		ROT	T2,^D12		; make it '=B17  '
  1142	002141'	260040	002135*		PUSHJ	P,PRNAMF##	;Output 6 characters (even if all blanks)
  1143	002142'	324740	001553*		PJRST	OPOUT		;Force out message now
  1144	002143'	200306	763146	TYPUI1:	MOVE	T1,OFLTAB(T1)	;Get addr of off-line message
  1145	002144'	260040	000017*		PUSHJ	P,CONMES##	;Output 12 ASCII characters
  1146	002145'	324740	002142*		PJRST	OPOUT
  1147
  1148			763146		%%ZZQ==.
  1149	000000			OFLTAB:	PHASE 0 ;123456789012;	;4 drive reports per line = 72 columns
  1150	002146'	000000	765620		 [ASCIZ /-offline-   /]	;Pack not spinning or no ID plug
  1151	002147'	000000	765623	%OFLER::![ASCIZ /unit error  /]	;Hardware indications on drive
  1152	002150'	000000	765626	%OFLFM::![ASCIZ /bad format  /]	;Incorrectly formatted pack on drive
  1153	002151'	000000	765631	%OFLMT::![ASCIZ /maintenance /]	;Drive is in MAINT. mode
  1154	002152'	000000	765634	%OFLRS::![ASCIZ /(no disk)   /]	;No response from drive (RM03 not plugged in)
  1155	002153'	000000	765637	%OFLIG::![ASCIZ /(ignored)   /]	;Wrong vol-set-ID (belongs to another system)
  1156	763154				PHASE .+%%ZZQ
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 18
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1157				;HERE WHEN ALL UNITS IN SYSTEM HAVE TRIED TO BE READ &
  1158				; THE STR DATA BLOCK HAS BEEN CREATED IF IT CAN BE.  NOW
  1159				; CHECK THAT ALL UNITS THAT SHOULD BE ARE PRESENT IN THE STR.
  1160
  1161	002154'	201640	000000*	SCNSTR:	MOVEI	P2,STRDDB	;GET ADR. OF STR DATA BLOCK.
  1162	002155'	336015	001737*		SKIPN	STRNAM(P2)	;IS THERE A STR?
  1163	002156'	254000	763217		 JRST	SCNSTD		;NO, NON-SKIP RETURN
  1164	002157'	550315	002032*		HRRZ	T1,STRUNM(P2)
  1165	002160'	326300	763173		JUMPN	T1,LSTRED	;WAS THE LAST UNIT IN THIS STR FOUND?
  1166					MOVEI	T1,[ASCIZ .
  1167	002161'	201300	765642	LAST UNIT WASN'T FOUND IN STR .]
  1168	002162'	260040	763336		PUSHJ	P,MSGSTR	;NO - PRINT MSG. FOLLOWED BY SIXBIT STR NAME
  1169	002163'	554255	002033*		HLRZ	U,STRUNI(P2)	;GET ADR. OF 1ST. UNIT DATA BLOCK IN STR
  1170	002164'	334000	000000		SKIPA			;
  1171	002165'	200240	000006	SCNST2:	MOVE	U,T1
  1172	002166'	554305	002044*		HLRZ	T1,UNISTR(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN STR
  1173	002167'	326300	763165		JUMPN	T1,SCNST2	;REPEAT UNTIL LAST ONE FOUND
  1174	002170'	135300	002113*		LDB	T1,UNYLUN	;GET ITS LOG. UNIT # IN STR
  1175	002171'	271300	000001		ADDI	T1,1		;MAKE INTO # UNITS IN STR
  1176	002172'	542315	002157*		HRRM	T1,STRUNM(P2)	; & STORE IT
  1177
  1178				;HERE TO CHECK FOR THE PRESENCE OF ALL UNITS BUT THE LAST IN A STR.
  1179
  1180	002173'	554255	002163*	LSTRED:	HLRZ	U,STRUNI(P2)	;GET ADR. OF 1ST. UNIT DATA BLOCK IN THIS STR
  1181	002174'	476000	000017		SETOM	P4		;SETUP FAKE PREVIOUS LOG. UNIT #
  1182	002175'	135600	002170*	CHKUNI:	LDB	P1,UNYLUN	;GET LOG. UNIT # OF THIS UNIT WITHIN STR
  1183	002176'	250600	000017		EXCH	P1,P4		;PUT THIS & PREVIOUS LOG. UNIT #'S IN PROPER ACS
  1184	002177'	312740	000014		CAME	P4,P1		;ARE LOG. UNIT #'S THE SAME?
  1185	002200'	254000	763205		 JRST	MISUNI		;NO - CHECK FOR MISSING UNITS
  1186					MOVEI	T3,[ASCIZ .
  1187	002201'	201400	765651	TWO LOGICAL UNIT .]
  1188	002202'	201300	765655		MOVEI	T1,[ASCIZ .'S FOUND IN STR .]
  1189	002203'	260040	763326		PUSHJ	P,MSGLNG	;PRINT MSGS FOLLOWED BY SIXBIT STR NAME
  1190	002204'	254000	763214		JRST	CHKUN1		;CHECK NEXT PAIR OF UNITS
  1191
  1192	002205'	306754	000001	MISUNI:	CAIN	P4,1(P1)	;IS THIS UNIT 1 GREATER THAN LAST ONE?
  1193	002206'	254000	763214		 JRST	CHKUN1		;YES - CHECK NEXT PAIR OF UNITS
  1194	002207'	271600	000001		ADDI	P1,1		;INCREMENT TO GET CORRECT MISSING LOG. UNIT #
  1195					MOVEI	T3,[ASCIZ .
  1196	002210'	201400	765661	LOGICAL UNIT .]
  1197	002211'	201300	765665		MOVEI	T1,[ASCIZ . MISSING FROM STR .]
  1198	002212'	260040	763326		PUSHJ	P,MSGLNG
  1199	002213'	254000	763205		JRST	MISUNI		;REPEAT UNTIL ALL MISSING ARE TYPED OUT
  1200
  1201	002214'	554245	002166*	CHKUN1:	HLRZ	U,UNISTR(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN STR
  1202	002215'	326240	763175		JUMPN	U,CHKUNI
  1203	002216'	254000	763221		JRST	SCNSD2
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 19
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1204				;HERE WHEN THROUGH CHECKING ALL UNITS WITHIN A STR.
  1205
  1206				SCNSTD:	MOVEI	T1,[ASCIZ .
  1207	002217'	201300	765671	?NO SYSTEM STRUCTURE.]
  1208	002220'	260040	763613		PUSHJ	P,SVMOT2	;NO, TYPE MESSAGE
  1209	002221'	332000	763226	SCNSD2:	SKIPE	ERRHOM		;ANY ERRORS?
  1210	002222'	350001	000000		AOS	(P)		;NO - SKIP RETURN
  1211	002223'	332000	763227		SKIPE ERRHM2
  1212	002224'	350001	000000		AOS (P)
  1213	002225'	263040	000000		POPJ	P,
  1214
  1215	002226'	000000	000000	ERRHOM:	0			;FLAG FOR ERRORS WHILE READING A HOME PAGE.
  1216	002227'	000000	000000	ERRHM2:	0			;"BAD" ERROR DETECTED.
  1217
  1218	002230'	000000	000000	RANHOM:	Z			; Holds PACK-SET ID info (random #)
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 20
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1219	002231'	201440	765676	WRPUNM:	MOVEI	T4,[ASCIZ . IS WRITE PROTECTED.]
  1220
  1221	002232'	200605	002127*		MOVE	P1,UNINAM(U)	;GET SIXBIT UNIT NAME
  1222					MOVEI	T1,[ASCIZ .
  1223	002233'	201300	765702	.]
  1224	002234'	324740	763237		PJRST	NASTYP		;TYPE MSGS. & GET USER'S RESPONSE
  1225
  1226				;SUBROUTINE TO PRINT "CONTROLLER" FOLLOWED BY A "NAME" FOLLOWED BY "IS OFF-LINE"
  1227				; FOLLOWED BY A MESSAGE ASKING WHAT STATE OF THE KONTROLLER IS DESIRED
  1228				; THEN IT WAITS FOR OPERATOR TO TYPE AN OCTAL NUMBER TERMINATED BY CRLF
  1229				;CALL	MOVE	P1,SIXBIT KONTROLLER NAME
  1230				;	MOVEI	T3,MSG. ADR.
  1231				;	PUSHJ	P,MCKKON
  1232				;	  ERROR RETURN	MSG. PRINTED BUT RESPONSE WASN'T AN OCTAL #
  1233				;	OK RETURN	 "      "    T2 CONTAINS OCTAL # TYPED
  1234
  1235				MCKKON:	MOVEI	T1,[ASCIZ .
  1236	002235'	201300	765702	.]
  1237	002236'	201440	765703		MOVEI	T4,[ASCIZ . IS OFF-LINE.]
  1238	002237'	265340	763660	NASTYP:	JSP	T2,SVOTAC	;SAVE P4,F,U & J
  1239	002240'	261040	000010		PUSH	P,T3		;SAVE 2ND. MSG ADR.
  1240	002241'	261040	000011		PUSH	P,T4		;SAVE 1ST. MSG. ADR.
  1241	002242'	260040	002050*		PUSHJ	P,OCONM		;PUT MSG IN BUFFER
  1242	002243'	200340	000014		MOVE	T2,P1		;GET UNIT/KONTROLLER SIXBIT NAME
  1243	002244'	260040	002130*		PUSHJ	P,PRNAME	;PUT IT IN BUFFER
  1244	002245'	262040	000006		POP	P,T1		;RESTORE 1ST. MSG. ADR.
  1245	002246'	260040	002144*		PUSHJ	P,CONMES	;PUT MSG. IN BUFFER
  1246	002247'	260040	763620		PUSHJ	P,CRLFOP	;ADD CRLF & O/P MSG.
  1247	002250'	262040	000006		POP	P,T1		;RESTORE 2ND. MSG ADR.
  1248	002251'	260040	763617		PUSHJ	P,CONOUT	;O/P MSG. & ADD CRLF
  1249	002252'	260040	000332*		PUSHJ	P,GETLIN	;GET USER'S RESPONSE
  1250	002253'	263040	000000		  POPJ	P,		;CR TYPED
  1251	002254'	260040	000000*		PUSHJ	P,OCTIN		;READ IT AS AN OCTAL NO.
  1252	002255'	263040	000000		  POPJ	P,		;NOTHING BUT A BREAK CH.
  1253	002256'	263040	000000		  POPJ	P,		;ILLEGAL CH.
  1254	002257'	254000	000305*		JRST	CPOPJ1		;OK RETURN WITH NO. IN T2
  1255
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 21
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1256				COMMENT #
  1257				@@SUBROUTINE FNDSTR
  1258				@@PURPOSE
  1259				SUBR TO SET UP THE STR DB ADDRESS IN P2 IF THE STR HAS THE
  1260				SIXBIT NAME IN T1.
  1261				@@ENTRY
  1262				EXPECTS SIXBIT STR NAME IN T1.
  1263				@@ACCUM
  1264				DESTROYS T1 AND P2.
  1265				@@EXIT
  1266				NON-SKIP RETURNS ONLY IF THE SYSTEM STR HAS BEEN SET UP AND IT
  1267				HAS THE NAME IN T1.  ELSE SKIP RETURNS.
  1268				@@ #
  1269
  1270	002260'	201640	002154*	FNDSTR:	MOVEI	P2,STRDDB	;GET ADDR OF STR DB TO P2.
  1271	002261'	620300	007777		TRZ	T1,7777		;STR NAMES ARE A MAX OF 4 CHARS.
  1272	002262'	312315	002155*		CAME	T1,STRNAM(P2)	;
  1273	002263'	350001	000000		AOS	(P)		;
  1274	002264'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 22
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1275				;SUBROUTINE TO MOVE PARAMETERS FROM HOME PAGE TO UNIT DATA BLOCK
  1276
  1277	002265'	200300	753000*	MOVUNI:	MOVE	T1,%HOM+HOMLOG	;05 Logical unit name (DSKB0-DSKB37)
  1278	002266'	202305	002136*		MOVEM	T1,UNILOG(U)	;01
  1279	002267'	200300	753000*		MOVE	T1,%HOM+HOMHID	;01 Unit ID (330000-330037)
  1280	002270'	202305	002134*		MOVEM	T1,UNIHID(U)	;02
  1281	002271'	200300	753000*		MOVE	T1,%HOM+HOMLUN	;06 Logical unit number (00-37)
  1282	002272'	137300	002175*		DPB	T1,UNYLUN	;03
  1283	002273'	200300	753000*		MOVE	T1,%HOM+HOMSPU	;15 Sats per unit (4 or 8)
  1284	002274'	137300	002056*		DPB	T1,UNYSPU	;43
  1285	002275'	205340	000000*		MOVSI	T2,UNPMSB	;400
  1286	002276'	412345	001714*		ANDCAM	T2,UNIDES(U)	;53
  1287	002277'	302300	000001		CAIE	T1,1		;If more than one SAT page
  1288	002300'	436345	002276*		 IORM	T2,UNIDES(U)	; then set Multiple Sat Blocks bit
  1289	002301'	200300	753000*		MOVE	T1,%HOM+HOMFEP	;14 Front-End Pointer (set on 2020 disks)
  1290	002302'	202305	000000*		MOVEM	T1,UNIFEP(U)	;07 (nonzero when BOOTS in pages 3-5 on KS)
  1291	002303'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 23
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1292				;SUBROUTINE TO MOVE PARAMETERS FROM HOME PAGE TO STR DB.
  1293
  1294	002304'	200300	753000*	MOVSTR:	MOVE	T1,%HOM+HOMSNM	;02 Structure name
  1295	002305'	202315	002262*		MOVEM	T1,STRNAM(P2)	;00
  1296	002306'	550300	753000*		HRRZ	T1,%HOM+HOMP4C	;26 Pages for CRASH.SAV
  1297	002307'	542315	000000*		HRRM	T1,STRP4C(P2)	;02
  1298	002310'	200300	753000*		MOVE	T1,%HOM+HOMSUF	;23 Page # of RIB to SYS on unit 0
  1299	002311'	661300	000101*		TLO	T1,RBREAL	;   Make it a real RIB pointer
  1300	002312'	202300	000000*		MOVEM	T1,SYSRIB##
  1301	002313'	200300	753000*		MOVE	T1,%HOM+HOMMFD	;25 Page # of RIB to MFD on unit 0
  1302	002314'	661300	002311*		TLO	T1,RBREAL	;   Make it a real RIB pointer
  1303	002315'	202300	000000*		MOVEM	T1,MFDRIB
  1304	002316'	200305	002015*		MOVE	T1,UNIPPU(U)	;41 Pages per unit
  1305	002317'	313315	000000*		CAMLE	T1,STRPPU(P2)	;06 If this one has more than any other in STR
  1306	002320'	202315	002317*		 MOVEM	T1,STRPPU(P2)	;06  then set this bogus value
  1307	002321'	200300	753000*		MOVE	T1,%HOM+HOMOVR
  1308	002322'	202315	000000*		MOVEM	T1,STROVR(P2)
  1309	002323'	200300	753000*		MOVE	T1,%HOM+HOMREF
  1310	002324'	502315	000000*		HLLM	T1,STRREF(P2)
  1311	002325'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 24
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1312				;Error messages
  1313	002326'	265340	763657	MSGLNG:	JSP	T2,REFSAV	;SAVE P4,T3,F,U & J AND INDICATE STR NEEDS REFRESHING
  1314	002327'	261040	000006		PUSH	P,T1		;SAVE 2ND. MSG ADR. IN T1
  1315	002330'	200300	000010		MOVE	T1,T3		;GET ADR OF 1ST. MSG
  1316	002331'	260040	000000*		PUSHJ P,CLRSND
  1317	002332'	260040	763605		PUSHJ	P,TYPDEC	;PUT MSG. & UNIT # IN BUFFER
  1318	002333'	260040	002145*		PUSHJ	P,OPOUT		;O/P BUFFER
  1319	002334'	262040	000006		POP	P,T1		;RESTORE 2ND. MSG ADR.
  1320	002335'	304000	000000		CAIA
  1321
  1322	002336'	265340	763657	MSGSTR:	JSP	T2,REFSAV	;SAVE P4,T3,F,U & J AND INDICATE STR NEEDS REFRESHING
  1323	002337'	260040	002242*		PUSHJ	P,OCONM		;PUT MSG. IN BUFFER
  1324	002340'	476000	763226		SETOM	ERRHOM		;INDICATE ERROR IN "RDHOME"
  1325	002341'	476000	763227		SETOM ERRHM2		;"BAD" ERROR
  1326	002342'	200355	002305*		MOVE	T2,STRNAM(P2)	;GET SIXBIT STR NAME
  1327	002343'	260040	002244*	NAMFLO:	PUSHJ	P,PRNAME	;PUT IT IN THE BUFFER FOLLOWED BY CRLF & START O/P
  1328	002344'	324740	763620		PJRST	CRLFOP
  1329
  1330
  1331	002345'	265340	763657	MSGUNI:	JSP	T2,REFSAV
  1332	002346'	261045	002232*		PUSH	P,UNINAM(U)
  1333	002347'	260040	002337*		PUSHJ	P,OCONM
  1334	002350'	476000	763226		SETOM	ERRHOM
  1335	002351'	476000	763227		SETOM	ERRHM2
  1336	002352'	262040	000007		POP	P,T2
  1337	002353'	324740	763343		PJRST	NAMFLO
  1338
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 25
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1339				COMMENT #
  1340				@@SUBROUTINE GETHOM
  1341				@@PURPOSE
  1342				SUBR TO TRY TO READ BOTH OF A UNIT'S HOME PAGES SUCCESSFULLY
  1343				INTO %HOM.
  1344				@@ENTRY
  1345				EXPECTS U/ UNIT DB AND F/ DDB.
  1346				PRINTS NO ERROR MESSAGES IF NOERH <> 0.
  1347				@@ACCUM
  1348				DESTROYS
  1349				@@EXIT
  1350				SKIP RETURNS IF AT LEAST ONE OF THE PAGES READ SUCCESSFULLY.
  1351				@@ #
  1352
  1353	002354'	205640	505755	GETHOM:	MOVSI	P2,(SIXBIT .HOM.)
  1354	002355'	201700	000000*		MOVEI	P3,CODHOM	;CODE WORD FOR HOME PAGES.
  1355	002356'	200740	765706		MOVE	P4,[XWD LPNHOM,LP2HOM]	;P4/ NO. 1ST PAGE,,2ND PAGE.
  1356	002357'	201140	000000*		MOVEI	PG,%HOM.P
  1357	002360'	324740	763370		PJRST	RDBOTH		;READ & VERIFY HOME PAGES.
  1358
  1359
  1360
  1361
  1362				COMMENT #
  1363				@@SUBROUTINE GETBAT
  1364				@@PURPOSE
  1365				SUBR TO TRY TO READ BOTH OF A UNIT'S BAT PAGES SUCCESSFULLY
  1366				INTO %BAT.
  1367				@@ENTRY
  1368				EXPECTS U/ UNIT DB AND F/ DDB.
  1369				PRINTS NO ERROR MESSAGES IF NOERH <> 0.
  1370				@@ACCUM
  1371				DESTROYS
  1372				@@EXIT
  1373				SKIP RETURNS IF AT LEAST ONE OF THE PAGES READ SUCCESSFULLY.
  1374				@@ #
  1375
  1376	002361'	260040	763363	GETBAT:	PUSHJ	P,SETBAT	;
  1377	002362'	324740	763370		PJRST	RDBOTH		;
  1378
  1379
  1380
  1381
  1382				COMMENT #
  1383				@@SUBROUTINE SETBAT
  1384				@@PURPOSE
  1385				LITTLE SUBR TO SET UP SOME PARAMETERS FOR HANDLING BAT PAGES.
  1386				@@ #
  1387
  1388	002363'	205640	424164	SETBAT:	MOVSI	P2,(SIXBIT .BAT.)
  1389	002364'	201700	000000*		MOVEI	P3,CODBAT
  1390	002365'	200740	765707		MOVE	P4,[XWD LPNBAT,LP2BAT]
  1391	002366'	201140	000000*		MOVEI	PG,%BAT.P	;
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 25-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1392	002367'	263040	000000		POPJ	P,
  1393
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 26
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1394				COMMENT #
  1395				@@SUBROUTINE RDBOTH
  1396				@@PURPOSE
  1397				SUBROUTINE TO READ SPECIAL REDUNDANT PAGES ON THE DISK (HOME
  1398				AND BAT) INTO CORE.
  1399				@@ENTRY
  1400				EXPECTS U/ UNIT DB, P2/ SIXBIT BAT, HOM, OR SAT, P3/ AP-
  1401				PROPRIATE CODE WORD FOR PAGES, P4/ PAGE NO. ON THE
  1402				DISK OF 1ST PAGE,, 2ND PAGE, AND PG/ PCB ADDRESS.
  1403				PRINTS NO ERROR MESSAGES IF NOERH <>0.
  1404				@@ACCUM
  1405				DESTROYS
  1406				@@CALLS
  1407				RDCHEK.
  1408				@@EXIT
  1409				NON-SKIP RETURNS ONLY IF BOTH PAGES ARE BAD.
  1410				T3/ 0 IF NO ERRORS, O'E LH(T3)<>0 IF ERROR ON 1ST PAGE AND
  1411				RH(T3)<>0 IF ERROR ON 2ND PAGE.
  1412				S=0 IF NO ERRORS, ELSE S HAS THE STANDARD RH ERROR BITS SET.
  1413				NOERH = 0 ON EXIT.
  1414				@@ #
  1415
  1416	002370'	200200	001604*	RDBOTH:	MOVE	F,DDSTAR	;F/ DDB.
  1417	002371'	402000	763515		SETZM	REDERR		;CLEAR ERR FLAG FOR BOTH PAGES.
  1418	002372'	476000	763516	FIROK:	SETOM	WHICH		;INDICATE READING 1ST PAGE.
  1419	002373'	554440	000017		HLRZ	T4,P4		;T4/ DISK PAGE NO.
  1420	002374'	260040	763407		PUSHJ	P,RDCHEK	;READ PAGE & CHECK FOR ERRORS.
  1421	002375'	254000	763377		  JRST	REDSEC		;ERR DETECTED - GO TRY 2ND PAGE.
  1422	002376'	327400	763404		JUMPG	T3,RDBSKP	;NO ERR. JUMP TO SUCCESS IF WE
  1423								;ARE HERE FROM A BAD 2ND PAGE.
  1424
  1425	002377'	402000	763516	REDSEC:	SETZM	WHICH		;INDICATE READING 2ND PAGE.
  1426	002400'	550440	000017		HRRZ	T4,P4		;T4/ DISK PAGE NUMBER.
  1427	002401'	260040	763407		PUSHJ	P,RDCHEK	;READ PAGE & CHECK FOR ERRORS.
  1428	002402'	321400	763405		  JUMPL	T3,RDBNON	;ERROR(S) DETECTED.  IF ON 1ST
  1429								;PAGE AS WELL, GIVES ERR RETURN.
  1430	002403'	327400	763372		JUMPG	T3,FIROK	;IF 2ND BAD 1ST OK GO RETRY 1ST.
  1431	002404'	350001	000000	RDBSKP:	AOS (P)			;SET FOR SKIP RETURN.
  1432	002405'	402000	763517	RDBNON:	SETZM NOERH		;CLR NO ERR MSG FLAG.
  1433	002406'	263040	000000		POPJ P,
  1434
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 27
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1435				COMMENT #
  1436				@@SUBROUTINE RDCHEK
  1437				@@PURPOSE
  1438				SUBR CALLED BY RDBOTH AND OTHERS TO READ A SPECIAL PAGE
  1439				INTO CORE AND CHECK FOR ERRORS.
  1440				@@ENTRY
  1441				EXPECTS  T4/ PAGE NO. ON UNIT, F/ FILE DB, PG/ PCB ADDRESS,
  1442				U/ UNIT DB, P2/ SIXBIT BAT, HOM, OR
  1443				SAT, AND P3/ CODE WORD FOR PAGES.
  1444				WHICH <>0 FOR FIRST PAGE, =0 FOR 2ND.
  1445				PRINTS NO ERROR MESSAGES IF NOERH <> 0.
  1446				@@CALLS
  1447				OPAGIN AND RDWMSG.
  1448				@@ACCUM
  1449				DESTROYS
  1450				@@EXIT
  1451				FOR 1ST PAGE, LH(T3)=0 UNLESS ERROR, IN WHICH CASE LH(T3)<>0.
  1452				FOR 2ND PAGE, RH(T3)=0 UNLESS ERROR, IN WHICH CASE RH(T3)<>0.
  1453				NON-SKIP RETURN IF ERROR, ELSE SKIP-RETURN.
  1454				IF NO ERROR, S=0 ELSE S HAS RH ERROR BITS SET.
  1455				@@ #
  1456
  1457	002407'	402000	763434	RDCHEK:	SETZM	CHKFLG		;CLR FLG FOR USE OF RDCHEK ONLY
  1458								;(NEEDED SINCE S ACCUMULATES.).
  1459	002410'	260040	763520		PUSHJ	P,OPAGIN	;READ THE PAGE.
  1460	002411'	334405	002346*		  SKIPA	T3,UNINAM(U)	;ERROR	- GET SIXBIT UNIT NAME.
  1461	002412'	254000	763416		JRST	CONCHK		;GO MAKE CONSISTANCY CHECKS.
  1462	002413'	201300	765710		MOVEI	T1,[ASCIZ . PAGE HARDWARE READ ERROR.]
  1463	002414'	260040	763465		PUSHJ	P,RDWMSG	;PRINT ERROR MSG. FOR PAGE TYPE.
  1464	002415'	476000	763434		SETOM	CHKFLG		;SAW ERROR ON THIS PAGE.
  1465	002416'	260040	000000*	CONCHK:	PUSHJ	P,GETPEV	;GET VIRTUAL ADDR FOR PCB IN PG IN T2
  1466	002417'	316640	765716		CAMN	P2,[SIXBIT /SAT/] ;READING SAT.SYS RIB PAGE?
  1467	002420'	312647	000000*		CAME	P2,RIBNAM(T2)	;YES. NAME IN RIB = 'SAT'?
  1468	002421'	316647	000000*		 CAMN	P2,PAGNAM(T2)	;NO - CHECK BLOCK NAME(THIS ALWAYS FAILS WITH RIB)
  1469	002422'	312707	000000*		CAME	P3,PAGCOD(T2)	;OK - CHECK CODE WORD
  1470	002423'	334405	002411*		 SKIPA	T3,UNINAM(U)	;NO CHECK - GET SIXBIT UNIT NAME
  1471	002424'	254000	763430		  JRST	TSTCHK		;EXIT CHECKING ERRORS ON THE WAY
  1472	002425'	201300	765717		MOVEI	T1,[ASCIZ . PAGE CONSISTENCY ERROR.]
  1473	002426'	260040	763465		PUSHJ	P,RDWMSG	;PRINT ERROR MSG. FOR PAGE TYPE
  1474	002427'	476000	763434		SETOM	CHKFLG		;SAW ERROR ON THIS PAGE.
  1475	002430'	200400	763515	TSTCHK:	MOVE	T3,REDERR	;ERR WRD FOR CHECKING BY CALLER.
  1476	002431'	336000	763434		SKIPN	CHKFLG		;SKIP RETURN IF
  1477	002432'	350001	000000		 AOS	(P)		;NO ERRORS.
  1478	002433'	263040	000000		POPJ	P,
  1479
  1480	002434'	000000	000000	CHKFLG: Z	;FLAG FOR USE BY RDCHEK ONLY.
  1481
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 28
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1482				COMMENT #
  1483				@@SUBROUTINE WTBOTH
  1484				@@PURPOSE
  1485				SUBR TO WRITE SPECIAL REDUNDANT PAGES TO THE DISK (HOM
  1486				AND BAT) FROM CORE.
  1487				@@ENTRY
  1488				EXPECTS F/ FILE DB, U/ UNIT DB, P4/ PAGE NO. ON
  1489				DISK OF 1ST PAGE,, 2ND PAGE, AND PG/ PCB ADDRESS.
  1490				PRINTS NO ERROR MESSAGES IF NOERH <> 0.
  1491				@@ACCUM
  1492				DESTROYS
  1493				@@CALLS
  1494				OPAGOT AND RDWMSG.
  1495				@@EXIT
  1496				RETURNS WITH S = 0 IF NO ERRORS. OTHERWISE S HAS STANDARD
  1497				RH ERROR BITS SET.
  1498				T3/ 0 IF NO ERRORS, OTHERWISE RH(T3)<>0 IF ERROR ON 2ND PAGE
  1499				AND LH(T3)<>0 IF ON 1ST PAGE.
  1500				@@ #
  1501
  1502	002435'	402000	763515	WTBOTH:	SETZM	REDERR		;CLR ERR SWITCH FOR BOTH PAGES.
  1503	002436'	476000	763516		SETOM	WHICH		;INDICATE WRITING 1ST PAGE.
  1504	002437'	260040	002416*		PUSHJ	P,GETPEV	;GET VIRTUAL ADDRESS OF DATA FROM C(PG)
  1505	002440'	200600	000007		MOVE	P1,T2		;GET IN MORE PERMANENT PLACE THAN T2
  1506
  1507	002441'	135300	002272*	WRTRN1:	LDB	T1,UNYLUN	;ALSO WORKS FOR ONES NOT IN STR
  1508	002442'	205340	002314*		MOVSI	T2,RBREAL	;
  1509	002443'	137300	000000*		DPB	T1,RBYUNI	;
  1510	002444'	554440	000017		HLRZ	T4,P4		;
  1511	002445'	137440	000145*		DPB	T4,RBYPNO	;
  1512	002446'	202354	000000*		MOVEM	T2,PAGSLF(P1)	;
  1513	002447'	517000	000017		HRLZS	P4		;SETUP P4 FOR PAGE #2.
  1514	002450'	260040	763456		PUSHJ	P,WTCHEK	;GO WRITE OUT PAGE.
  1515	002451'	402000	763516		SETZM	WHICH		;INDICATE WRITING 2ND PAGE.
  1516	002452'	326740	763441		JUMPN	P4,WRTRN1	;HAVE WE WRITTEN BOTH PAGES?
  1517	002453'	336400	763515		SKIPN	T3,REDERR	;ERR WRD FOR CHECKING BY CALLER.
  1518	002454'	350001	000000		 AOS	(P)		;SKIP RETURN IF NO ERRORS.
  1519	002455'	263040	000000		POPJ	P,		;
  1520
  1521	002456'	260040	763523	WTCHEK:	PUSHJ	P,OPAGOT	;TRY TO WRITE THE PAGE.
  1522	002457'	254000	763461		  JRST	.+2		;ERRORS.
  1523	002460'	263040	000000		POPJ	P,		;WON.
  1524	002461'	201300	765724		MOVEI	T1,[ASCIZ .HARDWARE WRITE ERROR.]
  1525	002462'	200405	002423*		MOVE	T3,UNINAM(U)	;PICK UP UNIT NAME AND PRINT
  1526	002463'	260040	763465		PUSHJ	P,RDWMSG	;ERROR MSG. FOR PAGE TYPE.
  1527	002464'	263040	000000		POPJ	P,
  1528
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 29
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1529				COMMENT #
  1530				@@SUBROUTINE RDWMSG
  1531				@@PURPOSE
  1532				SUBR TO PRINT ERROR MSG. FOR RDCHEK AND WTCHEK, AND TO SET
  1533				REDERR APPROPRIATELY.
  1534				(REDERR IS AN INTERNAL FLAG FOR RDBOTH AND WTBOTH.).
  1535				@@ENTRY
  1536				EXPECTS T1/ MSG. ADR. AND T3/ SIXBIT UNIT NAME.
  1537				IF NOERH <>0, DOES NOTHING AND RETURNS IMMEDIATELY.
  1538				@@ACCUM
  1539				DESTROYS
  1540				@@CALLS
  1541				SVOTAC, CLRSND, PRNAME, CONMES, AND CRLFOP.
  1542				@@EXIT
  1543				RETURNS LH. OR RH. OF REDERR = -1, DEPENDING ON WHETHER 1ST
  1544				OR 2ND PAGE, RESPECTIVELY, HAS ERROR.
  1545				@@ #
  1546
  1547	002465'	332000	763517	RDWMSG:	SKIPE	NOERH
  1548	002466'	263040	000000		 POPJ	P,		;DO NOT PRINT ERR MSG.
  1549	002467'	265340	763660		JSP	T2,SVOTAC	;SAVE T3,F,U & J
  1550	002470'	261040	000003		PUSH	P,PG		;SAVE PG.
  1551	002471'	261040	000006		PUSH	P,T1		;SAVE ADDR OF MESSAGE
  1552	002472'	260040	002331*		PUSHJ	P,CLRSND
  1553	002473'	200340	000010		MOVE	T2,T3		;SIXBIT UNIT NAME
  1554	002474'	260040	002343*		PUSHJ	P,PRNAME	;PUT NAME IN BUFFER
  1555	002475'	201300	765731		MOVEI	T1,[ASCIZ . FIRST .] ;PRESUME ERROR ON 1ST PAGE.
  1556	002476'	332000	763516		SKIPE	WHICH		;2ND. PAGE WAS READ?
  1557	002477'	254000	763502		 JRST	FSTERR		;NO - 1ST. PAGE.
  1558	002500'	523000	763515		HLLOS	REDERR		;INDICATE ERROR ON 2ND. PAGE.
  1559	002501'	334300	765735		SKIPA	T1,[[ASCIZ . SECOND .]]
  1560	002502'	563000	763515	FSTERR:	 HRROS	REDERR		;INDICATE ERROR ON 1ST. PAGE.
  1561	002503'	260040	002246*		PUSHJ	P,CONMES	;PUT MSG. IN BUFFER
  1562	002504'	200340	000015		MOVE	T2,P2		;GET SIXBIT PAGE TYPE(HOME OR "BAT")
  1563	002505'	316640	765716		CAMN	P2,[SIXBIT .SAT.] ;IF THIS WAS A RIB PAGE
  1564	002506'	541340	625142		 HRRI	T2,(SIXBIT .RIB.) ; TYPE "SATRIB"
  1565	002507'	260040	002474*		PUSHJ	P,PRNAME	;PUT IT IN BUFFER
  1566	002510'	262040	000006		POP	P,T1		;ADDR OF MESSAGE
  1567	002511'	260040	002503*		PUSHJ	P,CONMES	;PUT MSG. IN BUFFER
  1568	002512'	260040	763620		PUSHJ	P,CRLFOP	;CRLF AND TYPE MESSAGE
  1569	002513'	262040	000003		POP	P,PG		;RESTORE PG.
  1570	002514'	263040	000000		POPJ	P,
  1571
  1572	002515'	000000	000000	REDERR:	0			;ERR WORD FOR RDBOTH AND WTBOTH.
  1573								; RH=-1 IF ERROR ON 2ND. PAGE,
  1574								; LH "  "    "   "  1ST.   "
  1575	002516'	000000	000000	WHICH:	0			;FLAG TO INDICATE WHETHER 2ND
  1576								;OR 1ST PAGE BEING READ.
  1577
  1578	002517'	000000	000000	NOERH:	0			;FLAG TO NOT PRINT ERROR FROM UPDHOM.
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 30
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1579				COMMENT #
  1580				@@SUBROUTINE OPAGIN/OPAGOT
  1581				@@PURPOSE
  1582				ONCE-TIME SUBR TO READ OR WRITE A PAGE.
  1583				@@ENTRY
  1584				ENTRY POINT OPAGOT IS TO WRITE A PAGE, ENTRY POINT OPAGIN IS TO
  1585				READ A PAGE.
  1586				EXPECTS U/ UNIT DB, T4/ PAGE NUMBER ON THE UNIT,
  1587				PG/ ONCE-TIME PCB ADDRESS, AND F/ DDB.
  1588				@@ACCUM
  1589				DESTROYS T1-T4 AND S.
  1590				@@EXIT
  1591				SKIP RETURNS IF NO ERRORS, ELSE NON-SKIP RETURNS AND T3 HAS
  1592				THE PGYERR BITS.
  1593				@@ #
  1594
  1595				    ;HERE TO READ A PAGE.
  1596	002520'	201400	000000*	OPAGIN:	MOVEI	T3,PAGIN	;FILIO SUBR TO CALL.
  1597	002521'	201300	000000*		MOVEI	T1,STDREA
  1598	002522'	254000	763525		JRST	OPAGIO
  1599
  1600				    ;HERE TO WRITE A PAGE.
  1601	002523'	201400	000000*	OPAGOT:	MOVEI	T3,PAGOUT	;FILIO SUBR TO CALL.
  1602	002524'	201300	000000*		MOVEI	T1,STDWRT
  1603
  1604	002525'	261040	000003	OPAGIO:	PUSH	P,PG		;SAVE PG.
  1605	002526'	200340	000003		MOVE	T2,PG		;SET UP T2/ PCB ADDR AND
  1606	002527'	137300	000000*		DPB	T1,PCISTS	;SET FLAG FOR INTRPT LEVEL.
  1607	002530'	554147	000000*		HLRZ	PG,PCBPAG(T2)	;PG/ IN-CORE PAGE NUMBER.
  1608	002531'	400300	000000		SETZ	T1,		;CLEAR ANY
  1609	002532'	137300	000000*		DPB	T1,PGYERR	;ERROR BITS.
  1610	002533'	260040	000000*		PUSHJ	P,OHTINI	;CLEAR OUT ALL OUTPUT ERRORS (SHOULD BE 1 AT THE MOST.)
  1611	002534'	137440	000000*		DPB	T4,PGYPNO	;SET THE "UNIT NUMBER" AND
  1612	002535'	135300	002441*		LDB	T1,UNYLUN	;PAGE NUMBER IN PGYADR.
  1613	002536'	312246	002114*		CAME	U,UNTTBL(T1)	;STRANGE CROCK TO
  1614	002537'	202246	002536*		MOVEM	U,UNTTBL(T1)	;HELP SWPENQ AND FINPCB, WHICH
  1615	002540'	137300	000000*		DPB	T1,PGYUNI	;EXPECT UNTTBL TO BE SET UP.
  1616	002541'	261040	000007		PUSH	P,T2		;SAVE PCB ADDR.
  1617	002542'	260050	000000		PUSHJ	P,(T3)		;CALL PAGIN OR PAGOUT.
  1618	002543'	262040	000007		POP	P,T2		;RESTORE PCB ADDRESS.
  1619	002544'	135400	002527*		LDB	T3,PCISTS	;WAIT FOR
  1620	002545'	602400	000000*		TRNE	T3,STDWRT!STDREA ;THE INTRPT ON COMPLETION TO
  1621	002546'	254000	763544		 JRST	.-2		;HAPPEN.
  1622	002547'	135400	002532*		LDB	T3,PGYERR	;GET ERRORS.
  1623	002550'	262040	000003		POP	P,PG		;RESTORE PG/ PCB ADDR.
  1624	002551'	336000	000000*		SKIPN	OHTNUM		;SKIP IF GOT AN OUTPUT ERROR.
  1625	002552'	322400	002257*		 JUMPE	T3,CPOPJ1	;SKIP RETURN IF NO ERRORS
  1626	002553'	263040	000000		POPJ	P,		;
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 31
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1627				SUBTTL	CHECK ON DISK CAPACITY
  1628
  1629				DEFINE DSKOFF <WRPI DSKPIF##>
  1630				DEFINE DSKON  <WRPI DSKPIN##>
  1631
  1632				IFCPU(<KI,KL>),<
  1633				CPYMSG:	[ASCIZ	/IBM 3330-1/]	  ;0 3330-1  (100 MEGABYTE) IBM DISK ON SA10
  1634					[ASCIZ	/3330-II or 3675/];1 3330-11 (200 MEGABYTE) IBM DISK ON SA10
  1635					[ASCIZ	/3650 or 3652/]	  ;2 3650/52 (300 MEGABYTE) Memorex disk on SA10
  1636					[ASCIZ	/IBM compatible/] ;3 reserved for other IBM disk on SA10
  1637				CPYFLG:	-1			;Output geometry message first time thru
  1638				>  ;End IFCPU(<KI,KL>)
  1639
  1640	002554'	550105	001667*	DSKCPY:	HRRZ	J,UNIKON(U)	;Point to kontroller for this unit
  1641	002555'	700600	000000*		DSKOFF
  1642	002556'	332005	000000*		SKIPE	UNISTS(U)	;Unit must be idle before setting CWCOD
  1643					 JRST	[DSKON
  1644	002557'	254000	765736			 POPJ	P,]	;Should never get here
  1645	002560'	201300	000000*		MOVEI	T1,CWCOD	;Set unit to capacity-test wait
  1646	002561'	202305	002556*		MOVEM	T1,UNISTS(U)
  1647	002562'	700600	000000*		DSKON			;Turn on disk interrupts
  1648	002563'	260040	000000*		PUSHJ	P,IOSEL		;Start it going
  1649	002564'	205300	000100		MOVSI	T1,100		;Approx 16 seconds
  1650	002565'	332005	002561*	CPYWAT:	SKIPE	UNISTS(U)	;Done yet?
  1651	002566'	367300	763565		 SOJG	T1,CPYWAT	;Wait for unit to be idle
  1652
  1653				IFCPU(<KI,KL>),<;Output what type of disk was found
  1654					SKIPG	UNIONC(U)	;Is it on-line?
  1655					 POPJ	P,		;No
  1656					LDB	T2,UNYKTP##	;Get type of kontroller
  1657					CAIN	T2,4		;Is it "BP"?
  1658					AOSE	CPYFLG		;Yes, has message been output yet?
  1659					 POPJ	P,		;Don't mention it
  1660					LDB	T1,UNYUTP##	;Get unit type
  1661					MOVE	T1,CPYMSG(T1)	;Description
  1662					PUSHJ	P,CONMES
  1663					MOVEI	T1,[ASCIZ / unknown format/]
  1664					LDB	T2,UNYBPR##	;Get blocks per record
  1665					CAIN	T2,1		;Does each record = 1 block?
  1666					 MOVEI	T1,[ASCIZ / formatted in blocks/]
  1667					CAIN	T2,4		;Does each record = 4 blocks?
  1668					 MOVEI	T1,[ASCIZ / formatted in pages/]
  1669					JUMPE	T1,CPOPJ	;No message if unit is off-line
  1670					PUSHJ	P,CONOUT	;How formatted
  1671				>  ;End IFCPU(KI,KL)
  1672	002567'	263040	000000		POPJ	P,		;End of DSKCPY
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 32
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1673				;SUBROUTINE TO EXECUTE AN INSTRUCTION FOR ALL UNITS WITHIN A STR.
  1674				; USUALLY STORES A BYTE
  1675				;T1=INSTRUCTION TO BE EXECUTED, P1=ARG., P2=STR DATA BLOCK ADR.
  1676
  1677	002570'	554255	002173*	STOUNI:	HLRZ	U,STRUNI(P2)
  1678	002571'	261040	000006		PUSH	P,T1
  1679	002572'	256001	000000	STOUN1:	XCT	(P)		;EXECUTE INSTRUCTION SUPPLIED IN AC T1
  1680	002573'	554245	002214*		HLRZ	U,UNISTR(U)
  1681	002574'	326240	763572		JUMPN	U,STOUN1
  1682	002575'	254000	000000*		JRST	TPOPJ
  1683
  1684
  1685
  1686
  1687	002576'	265340	763660	DECLOP:	JSP	T2,SVOTAC	;Output string in T1 then number in P1
  1688	002577'	260040	763605		PUSHJ	P,TYPDEC
  1689	002600'	324740	763620		PJRST	CRLFOP
  1690
  1691	002601'	265340	763660	TYPMSN:	JSP	T2,SVOTAC	;SAVE P4,F,U & J
  1692	002602'	260040	002472*		PUSHJ P,CLRSND
  1693	002603'	260040	763605		PUSHJ	P,TYPDEC	;PUT MSG. IN THE BUFFER FOLLOWED BY DECIMAL #
  1694	002604'	324740	002333*		PJRST	OPOUT		;O/P THE BUFFER
  1695
  1696	002605'	260040	002511*	TYPDEC:	PUSHJ	P,CONMES	;Output message in T1
  1697	002606'	200300	000014		MOVE	T1,P1		;Then number in P1
  1698	002607'	324740	000000*		PJRST	RADX10
  1699
  1700
  1701
  1702
  1703	002610'	334355	002342*	SPSNAM:	SKIPA	T2,STRNAM(P2)
  1704	002611'	200345	002462*	SPUNAM:	MOVE	T2,UNINAM(U)
  1705	002612'	324740	002507*		PJRST PRNAME
  1706
  1707	002613'	476000	763227	SVMOT2:	SETOM ERRHM2
  1708	002614'	476000	763226	SVMOTE:	SETOM	ERRHOM
  1709	002615'	260040	002602*		PUSHJ P,CLRSND
  1710	002616'	265340	763660	SVMOUT:	JSP	T2,SVOTAC
  1711	002617'	260040	002605*	CONOUT:	PUSHJ	P,CONMES
  1712	002620'	260040	000000*	CRLFOP:	PUSHJ	P,CRLF
  1713	002621'	324740	002604*		PJRST	OPOUT
  1714
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 33
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1715	002622'	265340	763660	ASKQUE:	JSP	T2,SVOTAC	;SAVE P4,F,U & J
  1716	002623'	324740	000303*		PJRST	YESNO		;GET USER'S RESPONSE - SKIP RETURN IF 1ST.
  1717								;T3="Y" NON SKIP RETURN IF ANYTHING ELSE TYPED
  1718
  1719
  1720
  1721				;T2 & T3 ARE RESPECTED
  1722
  1723	002624'	205300	000167*	SETCHG:	MOVSI	T1,UNPCHG	;PREPARE TO FLAG HOME PAGES NEED REWRITING
  1724	002625'	205440	000000*		MOVSI	T4,UNPOFL!UNPHWP
  1725	002626'	616445	002300*		TDNN	T4,UNIDES(U)	;IS UNIT WRITE PROTECTED OR OFF-LINE?
  1726	002627'	436305	002626*		IORM	T1,UNIDES(U)	;SET UNPCHG FLAG
  1727	002630'	263040	000000		POPJ	P,		;RETURN
  1728
  1729
  1730
  1731				;SUBR TO MARK A UNIT AS A PRIVATE/PUBLIC PACK.
  1732	002631'	205400	001613*	SETPUB:	MOVSI	T3,UNPPRV	;
  1733	002632'	412405	002627*		ANDCAM	T3,UNIDES(U)	;
  1734	002633'	263040	000000		POPJ	P,		;
  1735
  1736	002634'	205400	002631*	SETPRV:	MOVSI	T3,UNPPRV	;
  1737	002635'	436405	002632*		IORM	T3,UNIDES(U)	;
  1738	002636'	263040	000000		POPJ	P,		;
  1739	
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 34
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1740				;Get name of physical unit
  1741	002637'	260040	002252*	GETUNI:	PUSHJ	P,GETLIN	;GET USER'S RESPONSE
  1742	002640'	263040	000000		  POPJ	P,		;JUST CR TYPED - NON SKIP RETURN
  1743	002641'	260040	000212*		PUSHJ	P,CTEXT		;GET SIXBIT UNIT NAME
  1744	002642'	402000	000005		SETZM	U		;ASSUME "ALL" WAS TYPED
  1745	002643'	554300	000007		HLRZ	T1,T2		;MAKE AC LOOK GOOD FOR COMPARE
  1746	002644'	260040	763651		PUSHJ	P,FNDUNI	;SEE IF UNIT EXISTS & RETURN WITH UNIT DATA BLOCK
  1747	002645'	334300	765746		  SKIPA	T1,[[ASCIZ .NOT A PHYSICAL UNIT-TRY AGAIN.]]
  1748	002646'	254000	002552*		 JRST	CPOPJ1		;UNIT EXISTS - SKIP RETURN
  1749	002647'	260040	763616		PUSHJ	P,SVMOUT	;ADD CRLF & O/P MSG.
  1750	002650'	254000	763637		JRST	GETUNI		;TRY AGAIN
  1751
  1752	002651'	554240	002102*	FNDUNI:	HLRZ	U,SYSUNI	;GET ADR. OF 1ST. UNIT DATA BLOCK IN SYSTEM
  1753	002652'	316345	002611*	FNDUN1:	CAMN	T2,UNINAM(U)	;MATCH?
  1754	002653'	254000	002646*		 JRST	CPOPJ1		;YES - SKIP RETURN
  1755	002654'	554245	002115*		HLRZ	U,UNISYS(U)	;GET NEXT UNIT DATA BLOCK ADR. IN SYSTEM
  1756	002655'	326240	763652		JUMPN	U,FNDUN1	;REPEAT IF THERE IS ONE
  1757	002656'	263040	000000		POPJ	P,		;NONE FOUND - NON SKIP RETURN
  1758
  1759				;SUBROUTINE TO PRESERVE AC'S P4,F,U & J
  1760
  1761	002657'	563015	002324*	REFSAV:	HRROS	STRREF(P2)	;INDICATE STR NEEDS REFRESHING
  1762	002660'	261040	000017	SVOTAC:	PUSH	P,P4
  1763	002661'	261040	000010		PUSH	P,T3
  1764	002662'	261040	000004		PUSH	P,F
  1765	002663'	261040	000005		PUSH	P,U
  1766	002664'	261040	000002		PUSH	P,J
  1767	002665'	260047	000000		PUSHJ	P,(T2)
  1768	002666'	304000	000000		  CAIA
  1769	002667'	350001	777773		AOS	-5(P)
  1770	002670'	262040	000002		POP	P,J
  1771	002671'	262040	000005		POP	P,U
  1772	002672'	262040	000004		POP	P,F
  1773	002673'	262040	000010		POP	P,T3
  1774	002674'	262040	000017		POP	P,P4
  1775	002675'	263040	000000		POPJ	P,
  1776
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 35
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1777				COMMENT #
  1778				@@SUBROUTINE REDBAT
  1779				@@PURPOSE
  1780				SUBR TO READ AND VERIFY THE BAT PAGES ON ALL UNITS IN THE SYSTEM.
  1781				@@ENTRY
  1782				EXPECTS
  1783				@@CALLS
  1784				CHKBAT AND SCNBAT.
  1785				@@ACCUM
  1786				DESTROYS
  1787				@@ #
  1788
  1789	002676'	554240	002651*	REDBAT:	HLRZ	U,SYSUNI	;GET ADR. OF 1ST UNIT DB IN THE SYSTEM.
  1790	002677'	205740	001677*		MOVSI	P4,UNPOFL
  1791	002700'	612745	002635*	RDBAT1:	TDNE	P4,UNIDES(U)	;UNIT OFF-LINE?
  1792	002701'	254000	763704		JRST	RDBAT6		;YES, GO READ NEXT BAT PAGE
  1793	002702'	260040	763707		PUSHJ	P,CHKBAT	;NO - GO CHECK "BAT" PAGES FOR THIS UNIT
  1794	002703'	255000	000000		  JFCL			;IGNORE ERRORS
  1795	002704'	554245	002654*	RDBAT6:	HLRZ	U,UNISYS(U)	;GET ADR. OF NEXT UNIT DATA PAGE IN SYSTEM
  1796	002705'	326240	763700		JUMPN	U,RDBAT1	;REPEAT IF THERE IS ONE
  1797	002706'	263040	000000		POPJ	P,		;NONE LEFT - EXIT
  1798
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 36
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1799				COMMENT #
  1800				@@SUBROUTINE CHKBAT/BATREF
  1801				@@PURPOSE
  1802				SUBR TO READ THE BAT PAGES AND ALLOW THE USER TO REINITIALIZE
  1803				THEM IF THEY ARE BAD.
  1804				@@ENTRY
  1805				THE ENTRY POINT CHKBAT READS THE BAT PAGES AND IF ERRORS ARE
  1806				FOUND, ASKS THE USER IF HE/SHE WISHES TO REINITIALIZE THE BAT
  1807				PAGES.  IF YES, IT FALLS INTO BATREF, WHICH DOES.
  1808				EXPECTS U/ UNIT DB AND F/ DDB.
  1809				@@ACCUM
  1810				DESTROYS
  1811				@@CALLS
  1812				SVOTAC, GETBAT, ASKQUE, CORZER, SETBAT, AND WTBOTH.
  1813				@@EXIT
  1814
  1815				@@ #
  1816
  1817	002707'	265340	763660	CHKBAT:	JSP	T2,SVOTAC	;SAVE P4,F,U & J.
  1818	002710'	402000	763742		SETZM	BATBAD		;CLEAR BAT PAGE BAD FLAG.
  1819	002711'	260040	763361		PUSHJ	P,GETBAT	;READ BOTH BAT PAGES & VERIFY THEM.
  1820	002712'	255000	000000		  JFCL			;ERROR(S)
  1821	002713'	336300	763515		SKIPN	T1,REDERR	;ANY ERRORS FOUND AT ALL IN EITHER BAT PAGE?
  1822	002714'	324740	763435		 PJRST	WTBOTH		;No, rewrite UNI field of self pointer
  1823	002715'	202300	763742		MOVEM	T1,BATBAD	;YES. BAD BAT PAGE.
  1824	002716'	332000	763743		SKIPE	BATMAN		;DO NOT GET TO REFRESH IF FORCED
  1825	002717'	263040	000000		 POPJ	P,		; (I.E. FROM FILMAN).
  1826					MOVEI	T1,[ASCIZ .
  1827				Do you want to initialize the BAT pages on this UNIT?
  1828	002720'	201300	765747	.]
  1829	002721'	205340	001713*		MOVSI	T2,UNPHWP
  1830	002722'	616345	002700*		TDNN	T2,UNIDES(U)	;DON'T INITIALIZE IF UNIT HARDWARE WRITE-PROTECT
  1831	002723'	260040	763622		 PUSHJ	P,ASKQUE	;TYPE QUESTION & GET USER'S RESPONSE
  1832	002724'	263040	000000		  POPJ	P,		;HE DOESN'T WANT TO
  1833					MOVEI	T1,[ASCIZ .
  1834				THIS is not normally done, are you SURE?
  1835	002725'	201300	765763	.]
  1836	002726'	260040	763622		PUSHJ	P,ASKQUE	;ASK AGAIN
  1837	002727'	263040	000000		  POPJ	P,		;HE SAVED HIMSELF SOME BOTHER
  1838	002730'	200400	000014		MOVE T3,P1		;GET CORE PNTR IN CORRECT AC.
  1839
  1840	002731'	201300	747000	BATREF:	MOVEI	T1,%BAT
  1841	002732'	260040	001721*		PUSHJ	P,CORZER	;
  1842	002733'	260040	763363		PUSHJ	P,SETBAT	;
  1843	002734'	202640	747000*		MOVEM	P2,%BAT+PAGNAM	;PUT SIXBIT 'BAT' IN THE PAGE.
  1844	002735'	205300	000000*		MOVSI	T1,-BRMAX	;SETUP AOBJN PTR. TO BE STORED IN PAGE
  1845	002736'	541300	000000*		HRRI	T1,BATREG
  1846	002737'	202300	747000*		MOVEM	T1,%BAT+BATFIR ;SAVE IT IN THE PAGE
  1847	002740'	202700	747000*		MOVEM	P3,%BAT+PAGCOD ;SAVE THE CODE FOR BAT PAGES IN THE PAGE
  1848	002741'	324740	763435		PJRST	WTBOTH		;
  1849
  1850	002742'	000000	000000	BATBAD:	0			;0 INDICATES VIRGIN BAT PAGES(INITIALIZED)
  1851								; LH = -1 INDICATES ERROR(S) DETECTED WHILE READING
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 36-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1852								; RH = # BAD REGIONS ON UNIT
  1853	002743'	000000	000000	BATMAN:	0			;0=OPTIONAL, -1=MANDATORY
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 37
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1854				;SUBROUTINE TO TYPE SIXBIT UNIT NAME FOLLOWED BY (ID)
  1855				; ENTER WITH U = UNIT DATA BLOCK ADR.
  1856
  1857	002744'	201600	765774	TYPUNI:	MOVEI	P1,[ASCIZ .,.]
  1858	002745'	200300	000014	TYPUN1:	MOVE	T1,P1		;GET MSG. ADR. INTO KOSHER AC
  1859	002746'	260040	002617*		PUSHJ	P,CONMES	;PUT "," OR MSG. IN BUFFER
  1860	002747'	322240	002621*		JUMPE	U,OPOUT	;JUST O/P MSG.
  1861	002750'	260040	763611		PUSHJ	P,SPUNAM	;PUT SIXBIT UNIT NAME IN BUFFER
  1862	002751'	201300	765775		MOVEI	T1,[ASCIZ .(.]
  1863	002752'	260040	002746*		PUSHJ	P,CONMES	;PUT "(" IN BUFFER
  1864	002753'	332345	002270*		SKIPE	T2,UNIHID(U)	;GET SIXBIT UNIT ID - IF ANY
  1865	002754'	260040	002612*		PUSHJ	P,PRNAME	;PUT IT IN THE BUFFER
  1866	002755'	201300	765776		MOVEI	T1,[ASCIZ .).]
  1867	002756'	260040	002752*		PUSHJ	P,CONMES	;PUT ")" IN THE BUFFER
  1868	002757'	324740	002747*		PJRST	OPOUT		;O/P BUFFER
  1869
  1870				;SUBROUTINE TO TYPE STR NAME IN "SYS" SEARCH LIST.
  1871
  1872				TYPSYS:	MOVEI	T1,[ASCIZ .
  1873	002760'	201300	765777	STR IN "SYS" SEARCH LIST:.]
  1874	002761'	260040	763617		PUSHJ	P,CONOUT
  1875	002762'	260040	763610		PUSHJ	P,SPSNAM	;PUT SIXBIT STR NAME IN BUFFER
  1876	002763'	324740	002757*		PJRST	OPOUT		;O/P BUFFER & EXIT
  1877	002764'	324740	763620	TYPSR1:	PJRST	CRLFOP		;O/P CRLF
  1878
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 38
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1879				;SUBROUTINE TO TYPE ALL UNITS IN SYSTEM THAT ARE NOT IN ANY STR
  1880				; RETURN WITH P1,P4,F,U & J DESTROYED
  1881
  1882				TYPUNS:	MOVEI	P1,[ASCIZ .
  1883				UNITS NOT IN A FILE STRUCTURE:
  1884	002765'	201600	766005	.]
  1885	002766'	554240	002676*		HLRZ	U,SYSUNI	;GET ADR. OF 1ST. UNIT DATA BLOCK IN SYSTEM
  1886	002767'	634740	000017		TDZA	P4,P4		;INDICATE UNIT ID TO BE TYPED IN TYPUNI
  1887	002770'	554245	002704*	TYPNS1:	HLRZ	U,UNISYS(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN SYSTEM
  1888	002771'	322240	001546*		JUMPE	U,CPOPJ		;EXIT IF NONE LEFT
  1889	002772'	332005	002266*		SKIPE	UNILOG(U)	;IS THIS UNIT IN A STR?
  1890	002773'	254000	763770		JRST	TYPNS1		;YES - CHECK NEXT UNIT
  1891	002774'	260040	763745		PUSHJ	P,TYPUN1	;NO - TYPE MSG., UNIT NAME & (ID)
  1892
  1893	002775'	554245	002770*	TYPNS2:	HLRZ	U,UNISYS(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN SYSTEM
  1894	002776'	322240	763764		JUMPE	U,TYPSR1	;O/P CRLF & EXIT IF NONE LEFT
  1895	002777'	336005	002772*		SKIPN	UNILOG(U)	;IS THIS UNIT IN A STR?
  1896	003000'	260040	763744		PUSHJ	P,TYPUNI	;YES - TYPE "," UNIT NAME & (ID)
  1897	003001'	254000	763775		JRST	TYPNS2		;REPEAT
  1898
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 39
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1899				;SUBROUTINE TO TYPE THE STR & ITS UNITS.
  1900				; RETURN WITH P1,P4,F,U & J DESTROYED
  1901
  1902	003002'	402000	000017	TYPSTR:	SETZM	P4		;INDICATE UNIT ID TO BE PRINTED IN TYPUNI
  1903	003003'	201640	002260*		MOVEI	P2,STRDDB	;ADR. OF STR DATA BLOCK.
  1904	003004'	336015	002610*		SKIPN	STRNAM(P2)	;ANY STR?
  1905	003005'	263040	000000		POPJ	P,		;NO.
  1906				    ;TYPE STR NAME & ALL ITS UNITS.
  1907
  1908	003006'	510355	002657*		HLLZ	T2,STRREF(P2)
  1909	003007'	322340	764012		JUMPE	T2,NOREF	;DOES STR NEED REFRESHING?
  1910	003010'	201300	766014		MOVEI	T1,[ASCIZ .NEEDS REFRESHING .]		;YES
  1911	003011'	260040	002756*		PUSHJ	P,CONMES	;PUT MSG IN BUFFER
  1912	003012'	260040	763610	NOREF:	PUSHJ	P,SPSNAM	;PUT SIXBIT STR NAME IN BUFFER
  1913	003013'	554255	002570*		HLRZ	U,STRUNI(P2)	;GET ADR. OF 1ST. UNIT IN STR
  1914	003014'	322240	763620		JUMPE	U,CRLFOP	;IF NO UNITS IN STR - O/P BUFFER WITH CRLF & EXIT
  1915	003015'	260040	002763*		PUSHJ	P,OPOUT	;O/P BUFFER
  1916	003016'	201600	766020		MOVEI	P1,[ASCIZ .:.]
  1917	003017'	260040	763745		PUSHJ	P,TYPUN1	;TYPE ":" UNIT NAME & (ID) [IST. TIME THRU]
  1918	003020'	554245	002573*	TYPST1:	HLRZ	U,UNISTR(U)	;GET NEXT UNIT DATA BLOCK IN STR
  1919	003021'	322240	763764		JUMPE	U,TYPSR1	;IF NO MORE UNITS - ADD CRLF & EXIT
  1920	003022'	260040	763744		PUSHJ	P,TYPUNI	;TYPE "," UNIT NAME & (ID)
  1921	003023'	254000	764020		JRST	TYPST1		;REPEAT UNTIL NO MORE UNITS IN STR
  1922
  1923	003024'	260040	764002	TYPALL:	PUSHJ P,TYPSTR
  1924	003025'	260040	763765		PUSHJ P,TYPUNS
  1925	003026'	260040	763760		PUSHJ P,TYPSYS
  1926	003027'	254000	761325		JRST FILCMD
  1927
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 40
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1928				;ROUTINE TO TYPE VALUE AND MESSAGE OR ASK FOR NEW
  1929				;VALUE USING MIN AND MAX
  1930				;ONLY TYPE IF TYPONL NON-0
  1931				;DBLSTD MAY HAVE 2 VALUES TO TRY WITHOUT ASKING
  1932				;VALUE IN P1, MSG IN T1, RESULT IN T2
  1933				;NON-SKIP RETURN IF UNCHANGED OR ONLY TYPING
  1934
  1935	003030'	335000	764112	ASKQMM:	SKIPGE TYPONL
  1936	003031'	254000	763576		 JRST DECLOP	;JUST TYPE IT
  1937	003032'	202300	764107		MOVEM T1,MSGSAV	;SAVE MESSAGE
  1938	003033'	202600	764111		MOVEM P1,VALSAV	;AND VALUE
  1939	003034'	200340	764114		MOVE T2,MIN
  1940	003035'	316340	764113		CAMN T2,MAX
  1941	003036'	254000	764066		JRST RETFIX	;ONLY ONE POSSIBLE VALUE
  1942	003037'	331000	764110	ASKRPT:	SKIPL DBLSTD
  1943	003040'	254000	764072		JRST QSTSTD	;TRY A STANDARD ANSWER
  1944	003041'	260040	764126		PUSHJ P,FTYUNI	;FORCED TYPE OF UNIT?
  1945	003042'	254000	764045		 JRST KNNUNI	;NO
  1946	003043'	200300	764107		MOVE T1,MSGSAV
  1947	003044'	200600	764111		MOVE P1,VALSAV	;MAKE SURE RESTORED
  1948	003045'	260040	763576	KNNUNI:	PUSHJ P,DECLOP	;TYPE VALUE AND MESSAGE
  1949	003046'	201300	766021		MOVEI T1,[ASCIZ /MIN = /]
  1950	003047'	200600	764114		MOVE P1,MIN
  1951	003050'	260040	763605		PUSHJ P,TYPDEC
  1952	003051'	201300	766023		MOVEI T1,[ASCIZ / MAX = /]
  1953	003052'	200600	764113		MOVE P1,MAX
  1954	003053'	260040	763576		PUSHJ P,DECLOP
  1955	003054'	260040	002637*		PUSHJ P,GETLIN
  1956	003055'	254000	764076		 JRST KEPSAM	;DOES NOT WANT IT CHANGED
  1957	003056'	260040	000000*		PUSHJ P,DECIN
  1958	003057'	255000	000000		 JFCL
  1959	003060'	254000	764104		 JRST ASKRP1	;ASK FOR IT AGAIN, WAS BAD
  1960	003061'	306400	000055		CAIN	T3,"-"	;IS HYPHEN TERMINATOR?
  1961	003062'	254000	764104		JRST	ASKRP1	;YES, NEGATIVE RESPONSE ILLEGAL
  1962	003063'	317340	764113	CHKANS:	CAMG T2,MAX
  1963	003064'	315340	764114		CAMGE T2,MIN
  1964	003065'	254000	764100		JRST ASKRPQ	;NOT IN RANGE
  1965	003066'	312340	764111	RETFIX:	CAME T2,VALSAV
  1966	003067'	350001	000000		AOS (P)
  1967	003070'	476000	764110		SETOM DBLSTD	;SO NOTHING THERE NEXT TIME
  1968	003071'	263040	000000		POPJ P,
  1969
  1970	003072'	554340	764110	QSTSTD:	HLRZ T2,DBLSTD	;GET FIRST TRY
  1971	003073'	306340	377777		CAIN T2,377777
  1972	003074'	200340	764113		MOVE T2,MAX	;FLAG FOR MAX
  1973	003075'	254000	764063		JRST CHKANS
  1974
  1975	003076'	200340	764111	KEPSAM:	MOVE T2,VALSAV
  1976	003077'	254000	764063		JRST CHKANS
  1977
  1978				ASKRPQ:	MOVEI T1,[ASCIZ /
  1979	003100'	201300	766025	VALUE NOT IN PERMITTED RANGE/]
  1980	003101'	335000	764110		SKIPGE DBLSTD	;NO ERROR IF STANDARD SETTING
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 40-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1981	003102'	260040	763617		PUSHJ P,CONOUT	;PUT OUT THE MESSAGE
  1982	003103'	527000	764110		HRLOS DBLSTD	;TRY SECOND STANDARD IF PRESENT
  1983	003104'	200300	764107	ASKRP1:	MOVE T1,MSGSAV
  1984	003105'	200600	764111		MOVE P1,VALSAV
  1985	003106'	254000	764037		JRST ASKRPT	;TRY AGAIN
  1986
  1987	003107'	000000	000000	MSGSAV:	0
  1988	003110'	000000	000000	DBLSTD:	0
  1989	003111'	000000	000000	VALSAV:	0
  1990	003112'	000000	000000	TYPONL:	0
  1991	003113'	000000	000000	MAX:	0
  1992	003114'	000000	000000	MIN:	0
  1993	003115'	000000	000000	KNOUNI:	0
  1994
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 41
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1995				COMMENT #
  1996				@@SUBROUTINE MAYREF
  1997				@@PURPOSE
  1998				SUBR TO TYPE WARNING THAT A CHANGE WILL CAUSE REFRESH.
  1999				@@ #
  2000
  2001	003116'	331000	764112	MAYREF:	SKIPL TYPONL
  2002	003117'	331000	764110		SKIPL DBLSTD
  2003	003120'	263040	000000		 POPJ P,		;ONLY TYPING, OR DOING STANDARD
  2004	003121'	322640	002771*		JUMPE P2,CPOPJ	;NO STR
  2005	003122'	510315	003006*		HLLZ T1,STRREF(P2)
  2006	003123'	326300	003121*		JUMPN T1,CPOPJ	;ALREADY SET FOR REFRESH
  2007					MOVEI T1,[ASCIZ /
  2008	003124'	201300	766034	CHANGE WILL CAUSE STR TO NEED REFRESHING/]
  2009	003125'	324740	763617		PJRST CONOUT
  2010
  2011
  2012
  2013
  2014				COMMENT #
  2015				@@SUBROUTINE FTYUNI
  2016				@@PURPOSE
  2017				LITTLE SUBR TO POSSIBLY TYPE A UNIT NAME.
  2018				@@ #
  2019
  2020	003126'	332000	764115	FTYUNI:	SKIPE KNOUNI	;KNOW WHAT UNIT?
  2021	003127'	263040	000000		 POPJ P,		;YES
  2022	003130'	260040	763611		PUSHJ P,SPUNAM
  2023	003131'	350001	000000		AOS (P)
  2024	003132'	476000	764115		SETOM KNOUNI
  2025	003133'	324740	763620		PJRST CRLFOP
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 42
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2026				COMMENT #
  2027				@@SUBROUTINE SPUCLC
  2028				@@PURPOSE
  2029				SUBR TO CALC THE NUMBER OF SATS FOR A UNIT, GIVEN THE NO. OF
  2030				PAGES ON THE UNIT.
  2031				@@ENTRY
  2032				EXPECTS U/ UNIT DB.
  2033				@@ACCUM
  2034				DESTROYS T2 AND T3.
  2035				@@EXIT
  2036				SETS UNYSPU.
  2037				@@ #
  2038
  2039	003134'	200345	002316*	SPUCLC:	MOVE	T2,UNIPPU(U)	;T2/ NO. OF PAGES ON THE UNIT.
  2040	003135'	275340	000001		SUBI	T2,1		;
  2041	003136'	231340	022000		IDIVI	T2,400*^D36	;DIVIDE BY NO. PAGES PER SAT.
  2042	003137'	271340	000001		ADDI	T2,1		;
  2043	003140'	137340	002274*		DPB	T2,UNYSPU	;SET ANSWER.
  2044	003141'	263040	000000		POPJ	P,
  2045
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 43
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2046				COMMENT #
  2047				@@SUBROUTINE UNITST
  2048				@@PURPOSE
  2049				SUBR TO CALC AND STORE THE NO. OF SATS ON A UNIT.  MAY FLAG
  2050				HOME PAGES NEED REWRITING.
  2051				@@ENTRY
  2052				EXPECTS U/ UNIT DB.
  2053				JUST RETURNS IF TYPONL IS < 0.
  2054				@@CALLS
  2055				SPUCLC AND SETCHG.
  2056				@@EXIT
  2057				STORES RESULT IN UNYSPU.
  2058				@@ #
  2059
  2060	003142'	335000	764112	UNITST:	SKIPGE	TYPONL
  2061	003143'	263040	000000		POPJ	P,
  2062	003144'	135400	003140*		LDB	T3,UNYSPU
  2063	003145'	260040	764134		PUSHJ	P,SPUCLC
  2064	003146'	312400	000007		CAME	T3,T2
  2065	003147'	324740	763624		PJRST	SETCHG
  2066	003150'	263040	000000		POPJ	P,
  2067
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 44
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2068				COMMENT #
  2069				@@SUBROUTINE UNITID
  2070				@@PURPOSE
  2071				SUBR TO SET THE UNIT ID.
  2072				@@ #
  2073
  2074	003151'	260040	764126	UNITID:	PUSHJ	P,FTYUNI
  2075	003152'	255000	000000		JFCL
  2076					MOVEI	T1,[ASCIZ /
  2077	003153'	201300	766045	UNIT ID IS /]
  2078	003154'	336605	002753*		SKIPN	P1,UNIHID(U)
  2079					MOVEI	T1,[ASCIZ /
  2080	003155'	201300	766050	ZERO UNIT ID - NEW ID NEEDED/]
  2081	003156'	260040	003011*		PUSHJ	P,CONMES
  2082	003157'	332340	000014		SKIPE	T2,P1		;PRINT IF NON-ZERO.
  2083	003160'	260040	002754*		PUSHJ	P,PRNAME
  2084	003161'	260040	763620		PUSHJ	P,CRLFOP
  2085	003162'	335000	764112		SKIPGE	TYPONL
  2086	003163'	263040	000000		POPJ	P,		;DONE IF ONLY PRINTING.
  2087	003164'	260040	003054*		PUSHJ	P,GETLIN
  2088	003165'	334345	003154*		  SKIPA	T2,UNIHID(U)	;NO CHANGE, GET BACK OLD.
  2089	003166'	260040	002641*		PUSHJ	P,CTEXT	;READ
  2090	003167'	322340	764151		JUMPE	T2,UNITID	;STILL 0, TRY AGAIN.
  2091	003170'	250345	003165*		EXCH	T2,UNIHID(U)
  2092	003171'	312345	003170*		CAME	T2,UNIHID(U)
  2093	003172'	324740	763624		PJRST	SETCHG		;CHANGED.
  2094	003173'	263040	000000		POPJ	P,		;NOT CHANGED
  2095
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 45
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2096				COMMENT #
  2097				@@SUBROUTINE STRTCH
  2098				@@PURPOSE
  2099				SUBR TO ALLOW THE REDEFINITION OF THE SIZE OF CRASH.SAV.
  2100				@@ #
  2101
  2102	003174'	402000	764114	STRTCH:	SETZM	MIN
  2103	003175'	200300	766057		MOVE	T1,[^D8192+2]	;(2**22)/512. (allow for EXE directory pages)
  2104	003176'	202300	764113		MOVEM	T1,MAX
  2105	003177'	260040	764116		PUSHJ	P,MAYREF
  2106	003200'	550615	002307*		HRRZ	P1,STRP4C(P2)
  2107	003201'	201300	766060		MOVEI	T1,[ASCIZ /PAGES FOR CRASH.SAV = /]
  2108	003202'	260040	764030		PUSHJ	P,ASKQMM
  2109	003203'	263040	000000		  POPJ	P,
  2110	003204'	542355	003200*		HRRM	T2,STRP4C(P2)
  2111	003205'	563015	003122*		HRROS	STRREF(P2)
  2112	003206'	200300	766065	CHGSTR:	MOVE	T1,[PUSHJ P,SETCHG]
  2113	003207'	324740	763570		PJRST	STOUNI
  2114
  2115
  2116
  2117				COMMENT #
  2118				@@SUBROUTINE
  2119				@@PURPOSE
  2120				SUBR TO ALLOW THE REDEFINITION OF THE NO. OF PAGES OF
  2121				OVERDRAW PER USER.
  2122				@@ #
  2123
  2124	003210'	402000	764114	STRTOV:	SETZM	MIN
  2125	003211'	200315	002320*		MOVE	T1,STRPPU(P2)
  2126	003212'	202300	764113		MOVEM	T1,MAX
  2127	003213'	201300	766066		MOVEI	T1,[ASCIZ /# OF PAGES ALLOWED FOR OVERDRAW PER USER = /]
  2128	003214'	214615	002322*		MOVM	P1,STROVR(P2)
  2129	003215'	260040	764030		PUSHJ	P,ASKQMM
  2130	003216'	263040	000000		POPJ	P,
  2131	003217'	212355	003214*		MOVNM	T2,STROVR(P2)
  2132	003220'	324740	764206		PJRST	CHGSTR
  2133
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 46
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2134				COMMENT #
  2135				@@SUBROUTINE STSDEF
  2136				@@PURPOSE
  2137				SUBR TO DEFINE A STR.
  2138				@@ENTRY
  2139				EXPECTS
  2140				@@ACCUM
  2141				DESTROYS
  2142				@@CALLS
  2143				CONOUT, GETLIN, CTEXT, FNDSTR, GETUNI, CMPLOG, SETCHG,
  2144				STRTOV, AND STRTCH.
  2145				(AND ITS INTERNAL SUBRS STSINS, UNICHK, AND UNICK1.).
  2146				@@ #
  2147
  2148	003221'	200300	766077	STSDEF:	MOVE	T1,[SIXBIT/DSKB/] ;ALL STR NAMES ARE DSKB.
  2149	003222'	260040	763260		PUSHJ	P,FNDSTR	;DOES THIS STR ALREADY EXIST?
  2150	003223'	334300	766104		  SKIPA	T1,[[ASCIZ /STR already exists/]] ;YES, THIS IS A NO-NO.
  2151	003224'	254000	764226		JRST	STSNEW		;NO, OKAY UNLESS ALREADY A STR.
  2152	003225'	324740	763617		PJRST	CONOUT
  2153
  2154	003226'	336015	003004*	STSNEW:	SKIPN	STRNAM(P2)	;DOES ANY STR EXIST?
  2155	003227'	254000	764232		 JRST	STSNE1		;NO, THIS IS IT.
  2156					MOVEI	T1,[ASCIZ /
  2157				Too many file structures!  Only one allowed!
  2158	003230'	201300	766105	/]
  2159	003231'	324740	763617		PJRST	CONOUT
  2160
  2161				    ;HERE WITH A GOOD STR NAME.
  2162	003232'	260040	764362	STSNE1:	PUSHJ	P,CLRSTR
  2163	003233'	202315	003226*		MOVEM	T1,STRNAM(P2)
  2164	003234'	563015	003205*		HRROS	STRREF(P2)	;NEED REFRESH.
  2165				    ;HERE TO PUT THE UNITS IN THE STR.
  2166	003235'	201300	766117	STSNE2:	MOVEI	T1,[ASCIZ /Type names of physical units in STR, extra CR when done/]
  2167	003236'	260040	763617		PUSHJ	P,CONOUT
  2168
  2169	003237'	201715	003013*		MOVEI	P3,STRUNI(P2)
  2170	003240'	400600	000000		SETZ	P1,
  2171	003241'	260040	763637	STSNXT:	PUSHJ	P,GETUNI	;GET A UNIT NAME
  2172					JRST	[CAIE P3,STRUNI(P2)  ;FINISHED GETTING UNIT NAMES.
  2173						  JRST STSFIN
  2174	003242'	254000	766133			 JRST STSNE2]
  2175	003243'	260040	764246		PUSHJ	P,STSINS	;INSERT UNIT.
  2176	003244'	254000	764241		  JRST	STSNXT		;ALREADY IN STR
  2177	003245'	254000	764241		JRST	STSNXT		;CONTINUE
  2178
  2179				    ;SUBR INTERNAL TO STSDEF TO INSERT A UNIT IN THE STR.
  2180	003246'	550305	003020*	STSINS:	HRRZ	T1,UNISTR(U)	;SEE IF THIS UNIT IS ALREADY IN A STR.
  2181	003247'	322300	764252		JUMPE	T1,STSUN2	;T1 = 0 IF IT ISN'T
  2182					MOVEI	T1,[ASCIZ .
  2183				Unit already in file structure
  2184	003250'	201300	766136	.]
  2185	003251'	324740	763617		PJRST	CONOUT		;TYPE MSG. & EXIT
  2186
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 46-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2187	003252'	506256	000000	STSUN2:	HRLM	U,(P3)		;LINK THIS UNIT DATA BLOCK TO PREVIOUS ONE
  2188	003253'	552645	003246*		HRRZM	P2,UNISTR(U)	;ATTACH THIS UNIT DATA BLOCK TO THIS STR
  2189	003254'	550315	002172*		HRRZ	T1,STRUNM(P2)	;GET LOGICAL UNIT # WITHIN STR
  2190	003255'	137300	002535*		DPB	T1,UNYLUN	;SAVE IT IN UNIT DATA BLOCK
  2191	003256'	260040	000000*		PUSHJ	P,CMPLOG	;COMPUTE SIXBIT LOGICAL UNIT NUM, STORE IN UNILOG
  2192	003257'	260040	763631		PUSHJ	P,SETPUB
  2193				PRINTF(<[All references to STRPPU should be eliminated]>)
  2194	003260'	200305	003134*		MOVE	T1,UNIPPU(U)
  2195	003261'	313315	003211*		CAMLE	T1,STRPPU(P2)
  2196	003262'	202315	003261*		 MOVEM	T1,STRPPU(P2)
  2197	003263'	302600	000000		CAIE P1,0
  2198	003264'	315314	003260*		 CAMGE	T1,UNIPPU(P1)	;COMPARE WITH SMALLEST SO FAR
  2199	003265'	200600	000005		MOVE	P1,U		;SAVE ADDR OF SMALLEST IN P1
  2200	003266'	350015	003254*		AOS	STRUNM(P2)	;INCREMENT # OF UNITS IN STR
  2201	003267'	260040	763624		PUSHJ	P,SETCHG	;FLAG THAT UNIT'S HOME PAGES MUST BE REWRITTEN
  2202	003270'	201705	003253*		MOVEI	P3,UNISTR(U)	;MAKE CURRENT UNIT PREDECESSOR
  2203	003271'	254000	002653*		JRST	CPOPJ1		;SKIP RETURN
  2204
  2205				    ;HERE TO FINISH UP.
  2206	003272'	554255	003237*	STSFIN:	HLRZ	U,STRUNI(P2)
  2207	003273'	554245	003270*		HLRZ	U,UNISTR(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN STR
  2208	003274'	326240	764273		JUMPN	U,.-1		;REPEAT IF ANY LEFT
  2209	003275'	402000	764112		SETZM	TYPONL		;JUST IN CASE.
  2210	003276'	200240	000014		MOVE	U,P1		;GET SMALLEST UNIT.
  2211	003277'	135600	000000*		LDB	P1,UNYKTP##	;Get Kontroller type
  2212	003300'	261040	000014		PUSH	P,P1		;SAVE IT.
  2213	003301'	200314	764322		MOVE	T1,OVRDEF(P1)
  2214	003302'	526300	764110		HRLOM	T1,DBLSTD
  2215	003303'	260040	764210		PUSHJ	P,STRTOV	;SET OVERDRAW.
  2216	003304'	200301	000000		MOVE	T1,(P)
  2217	003305'	200306	764332		MOVE	T1,P4CDEF(T1)	;Pages for CRASH.SAV based on kontroller type
  2218	003306'	526300	764110		HRLOM	T1,DBLSTD
  2219	003307'	260040	764174		PUSHJ	P,STRTCH	;SET DEFAULT SIZE OF CRASH.SAV.
  2220	003310'	262040	000014		POP	P,P1
  2221	003311'	200300	766145		MOVE	T1,[PUSHJ P,UNICK1]
  2222	003312'	260040	763570		PUSHJ	P,STOUNI	;CHECK SATS.
  2223	003313'	200300	766146		MOVE T1,[PUSHJ P,UNICHK]
  2224	003314'	324740	763570		PJRST STOUNI		;NOW DO ALL UNITS.
  2225
  2226				    ;A LITTLE INTERNAL STSDEF SUBR.
  2227	003315'	402000	764115	UNICHK:	SETZM KNOUNI		;DO NOT KNOW UNIT.
  2228	003316'	324740	762415		PJRST UNCHKA		;GO DO THE STANDARD STUFF.
  2229
  2230				    ;A LITTLE INTERNAL STSDEF SUBR.
  2231	003317'	402000	764115	UNICK1:	SETZM KNOUNI
  2232	003320'	402000	764112		SETZM TYPONL		;JUST TO MAKE SURE.
  2233	003321'	324740	764142		PJRST UNITST		;CHECK SATS.
  2234
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 47
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2235				;DEFAULT DEFS BY UNIT TYPE.
  2236
  2237				;Default overdraw in blocks
  2238	003322'	000000	000001	OVRDEF:	1	;0 DR (unused)
  2239	003323'	000000	000062		^D50	;1 FH (unused)
  2240	003324'	000000	000175		^D125	;2 DP (unused)
  2241	003325'	000000	000175		^D125	;3 MF (unused)
  2242	003326'	000000	000175		^D125	;4 3330
  2243	003327'	000000	000175		^D125	;5 RM03
  2244	003330'	000000	000175		^D125	;6 AP
  2245	003331'	000000	000175		^D125	;7    (unused)
  2246
  2247				;Default pages for CRASH.SAV
  2248	003332'	000000	000000	P4CDEF:	0	;0 DR (unused)
  2249	003333'	000000	000000		0	;1 FH (unused)
  2250	003334'	000000	001000		^D512	;2 DP (unused)
  2251	003335'	000000	001000		^D512	;3 MF (unused)
  2252	003336'	000000	020001		^D8192+1;4 3330 KI/KL with 4096K of memory = 8193 pages for CRASH.EXE
  2253	003337'	000000	001000		^D512	;5 RM03 KS-2020
  2254	003340'	000000	001000		^D512	;6 AP   Foonly
  2255	003341'	000000	001000		^D512	;7    (unused)
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 48
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2256				COMMENT #
  2257				@@SUBROUTINE STSDSL
  2258				@@PURPOSE
  2259				SUBR TO DISSOLVE A STR.
  2260				CLEARS UNILOG, UNISTR, AND STRNAM AND FLAGS THAT ALL THE
  2261				STR'S UNITS' HOME PAGES NEED REWRITING.
  2262				@@ENTRY
  2263				EXPECTS
  2264				@@ACCUM
  2265				DESTROYS
  2266				@@CALLS
  2267				SETCHG.
  2268				@@ #
  2269
  2270	003342'	261040	000007	STSDSL:	PUSH	P,T2		;SAVE T2 AND
  2271	003343'	261040	000006		PUSH	P,T1		;T1.
  2272	003344'	201640	003003*		MOVEI	P2,STRDDB
  2273	003345'	554255	003272*		HLRZ	U,STRUNI(P2)	;GET ADR. OF 1ST. UNIT DATA BLOCK IN STR.
  2274	003346'	322240	764356		JUMPE	U,DISST2	;JUST UNLINK STR IF IT HAS NO UNITS.
  2275	003347'	205300	002634*		MOVSI	T1,UNPPRV	;UNIT MAY BE GOING PRIVATE.
  2276	003350'	403405	002777*	DISST1:	SETZB	T3,UNILOG(U)	;CLEAR OUT NAME OF LOGICAL UNIT WITHIN STR.
  2277	003351'	250405	003273*		EXCH	T3,UNISTR(U)	;CLEAR OUT LINKS TO STR & NEXT UNIT DATA BLOCKS.
  2278	003352'	436300	002722*		IORM	T1,UNIDES	;UNIT IS NOW A PRIVATE PACK
  2279	003353'	260040	763624		PUSHJ	P,SETCHG	;FLAG THAT THIS UNIT'S HOME PAGE MUST BE REWRITTEN.
  2280	003354'	554240	000010		HLRZ	U,T3		;GET NEXT UNIT DATA BLOCK ADR.
  2281	003355'	326240	764350		JUMPN	U,DISST1	;REPEAT IF THERE IS ONE.
  2282	003356'	260040	764362	DISST2:	PUSHJ	P,CLRSTR	;INDICATE STR NO LONGER EXISTS.
  2283	003357'	262040	000006		POP	P,T1		;RESTORE T1 AND
  2284	003360'	262040	000007		POP	P,T2		;T2.
  2285	003361'	263040	000000		POPJ	P,		;RETURN - DON'T WORRY ABOUT RETURING CORE
  2286								; AS RDHOME MUST BE CALLED AGAIN.
  2287
  2288
  2289
  2290				COMMENT #
  2291				@@SUBROUTINE CLRSTR
  2292				@@PURPOSE
  2293				LITTLE SUBR TO CLEAR OUT THE STR DB (SETTING STRNAM TO
  2294				ZERO INDICATES THAT THERE IS NO STR.).
  2295				@@ACCUM
  2296				DESTROYS NO ACS.
  2297				@@ #
  2298
  2299	003362'	261040	000006	CLRSTR:	PUSH	P,T1
  2300	003363'	261040	000000*		PUSH	P,STRDDB+STRBTS
  2301	003364'	402000	003344*		SETZM	STRDDB	
  2302	003365'	505300	003364*		HRLI	T1,STRDDB
  2303	003366'	541300	000001*		HRRI	T1,STRDDB+1
  2304	003367'	251300	000000*		BLT	T1,STRDDB+STRLEN-1
  2305	003370'	262040	000006		POP	P,T1
  2306	003371'	552300	000000*		HRRZM	T1,STRDDB+STRBTS
  2307	003372'	262040	000006		POP	P,T1
  2308	003373'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 48-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2309
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 49
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2310				COMMENT #
  2311				@@SUBROUTINE ADDUNI
  2312				@@PURPOSE
  2313				SUBR TO ADD A UNIT TO THE SYSTEM STR.
  2314				@@ENTRY
  2315				EXPECTS
  2316				@@CALLS
  2317
  2318				@@ACCUM
  2319				DESTROYS
  2320				@@EXIT
  2321
  2322				@@ #
  2323
  2324	003374'	201640	003365*	ADDUNI:	MOVEI	P2,STRDDB	;P2/ ADDR OF STR DB.
  2325	003375'	336015	003233*		SKIPN	STRNAM(P2)	;HAS THE STR BEEN DEFINED?
  2326	003376'	254000	764465		 JRST	ADDNOT		;NO, ILLEGAL TO ADD TO IT.
  2327	003377'	201300	766147		MOVEI	T1,[ASCIZ .Enter unit name to add.]
  2328	003400'	260040	763617		PUSHJ	P,CONOUT	;BY NOW P2=STR DDB.
  2329	003401'	260040	763637		PUSHJ	P,GETUNI	;GET A UNIT NAME.
  2330	003402'	254000	764467		  JRST	CANTAD		;NOT A UNIT, CAN NOT ADD.
  2331	003403'	322240	764467		JUMPE	U,CANTAD	;CAN NOT ADD ALL EITHER.
  2332	003404'	550305	003351*		HRRZ	T1,UNISTR(U)	;IS THE UNIT IN A STR ALREADY?
  2333	003405'	322300	764410		JUMPE	T1,ADDUN2	;NO.
  2334	003406'	201300	766154		MOVEI	T1,[ASCIZ .THAT unit is already in a structure.]
  2335	003407'	254000	763617		JRST	CONOUT
  2336
  2337				    ;HERE WHEN WE HAVE A UNIT TO ADD, AND THE UNIT IS NOT
  2338				    ;ALREADY IN A STR.
  2339	003410'	200305	003264*	ADDUN2:	MOVE	T1,UNIPPU(U)
  2340	003411'	313315	003262*		CAMLE	T1,STRPPU(P2)	;MUST NOT WANT TO CHANGE STRPPU
  2341	003412'	254000	764467		 JRST	CANTAD
  2342	003413'	402000	764112		SETZM	TYPONL
  2343	003414'	260040	762415		PUSHJ	P,UNCHKA	;SET UNIT ID AND NO. OF SATS PER UNIT.
  2344	003415'	550315	003266*		HRRZ	T1,STRUNM(P2)
  2345	003416'	135340	003255*		LDB	T2,UNYLUN
  2346	003417'	137300	003416*		DPB	T1,UNYLUN	;CHANGE THIS UNIT NUMBER
  2347	003420'	402007	002537*		SETZM	UNTTBL(T2)	;ZERO OLD CELL
  2348	003421'	200300	000007		MOVE	T1,T2
  2349	003422'	332006	777777*		SKIPE	UNTTBL-1(T1)
  2350	003423'	364300	764422		 SOJA	T1,.-1		;LOOK FOR ZERO
  2351	003424'	316300	000007		CAMN	T1,T2
  2352	003425'	254000	764432		 JRST	ADUNT
  2353	003426'	250246	003420*		EXCH	U,UNTTBL(T1)	;GET THAT ONE
  2354	003427'	137340	003417*		DPB	T2,UNYLUN	;CHANGE ITS NUMBER
  2355	003430'	250247	003426*		EXCH	U,UNTTBL(T2)	;AND STOR IN NEW PLACE (SETS U=0)
  2356	003431'	250246	003430*		EXCH	U,UNTTBL(T1)	;GET OLD U BACK
  2357	003432'	135300	003427*	ADUNT:	LDB	T1,UNYLUN	;AND OLD UNIT NUMBER
  2358	003433'	202246	003431*		MOVEM	U,UNTTBL(T1)	;STORE IN NEW PLACE
  2359	003434'	510315	003234*		HLLZ	T1,STRREF(P2)	;IS IT MARKED FOR REFRESH
  2360	003435'	326300	764445		JUMPN	T1,ADDUN4	;YES, DO NOT NEED TO REFRESH PACK
  2361	003436'	261040	000015		PUSH	P,P2		;SAVE THE STR POINTER.
  2362	003437'	260040	764707		PUSHJ	P,UPDHOM	;WRITE HOME PAGES.
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 49-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2363	003440'	262040	000015		POP	P,P2		;RESTORE STR PTR.
  2364	003441'	205740	002624*		MOVSI	P4,UNPCHG
  2365	003442'	412745	003352*		ANDCAM	P4,UNIDES(U)	;PAKREF WILL READ HOME PAGES.
  2366	003443'	260040	000000*		PUSHJ	P,PAKREF	;REFRESH PACK.
  2367	003444'	254000	764467		  JRST	CANTAD		;COULD NOT DO IT.
  2368	003445'	350315	003415*	ADDUN4:	AOS	T1,STRUNM(P2)	;ONE MORE IN STR
  2369	003446'	275300	000001		SUBI	T1,1		;
  2370	003447'	552645	003404*		HRRZM	P2,UNISTR(U)	;LINK TO STR DDB
  2371	003450'	260040	003256*		PUSHJ	P,CMPLOG	;MAKE A LOGICAL UNIT NAME
  2372	003451'	554315	003345*		HLRZ	T1,STRUNI(P2)
  2373	003452'	554346	003447*	ADDUN5:	HLRZ	T2,UNISTR(T1)
  2374	003453'	322340	764456		JUMPE	T2,ADDUN7	;FIND END OF CURRENT LIST
  2375	003454'	200300	000007		MOVE	T1,T2
  2376	003455'	254000	764452		JRST	ADDUN5
  2377	003456'	261040	000006	ADDUN7:	PUSH	P,T1		;SAVE LAST UNIT.
  2378	003457'	506246	003452*		HRLM	U,UNISTR(T1)
  2379	003460'	260040	763624		PUSHJ	P,SETCHG	;MARK HOME PAGE CHANGED.
  2380	003461'	260040	763631		PUSHJ	P,SETPUB
  2381	003462'	262040	000005		POP	P,U		;WANT TO SET CHANGED HOME ON THIS ONE TOO.
  2382	003463'	260040	763624		PUSHJ	P,SETCHG
  2383	003464'	263040	000000		POPJ	P,
  2384
  2385	003465'	201300	766164	ADDNOT:	MOVEI T1,[ASCIZ .The SYSTEM structure has not been DEFINED yet.]
  2386	003466'	254000	763617		JRST CONOUT
  2387
  2388	003467'	513005	003457*	CANTAD:	HLLZS	UNISTR(U)	;
  2389	003470'	201300	766176		MOVEI	T1,[ASCIZ .Cannot add unit to structure.]
  2390	003471'	254000	763617		JRST	CONOUT
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 50
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2391				;SUBR TO REFRESH A STR.
  2392
  2393	003472'	260040	764516	STSREF:	PUSHJ	P,GETDAT	;Get date (so HOME.SYS doesn't say 2-JAN-64)
  2394	003473'	201300	000000*		MOVEI	T1,UFDHSI	; RANNO already setup!
  2395	003474'	542300	000000*		HRRM	T1,STRHSH+STRDDB
  2396	003475'	336000	763230		SKIPN	RANHOM		; Is this a virgin pack set?
  2397	003476'	350000	763230		 AOS	RANHOM		; If so, prevent RDHOME from complaining.
  2398	003477'	260040	764677		PUSHJ	P,RWRHOM	;WRITE HOME PAGES.
  2399	003500'	402000	763743		SETZM	BATMAN
  2400	003501'	260040	762556		PUSHJ	P,RDHOME	; Read & Verify HOM pages
  2401	003502'	255000	000000		  JFCL			; Ignore "all" errors
  2402	003503'	255000	000000		  JFCL
  2403	003504'	200200	002370*		MOVE	F,DDSTAR
  2404	003505'	260040	000000*		PUSHJ	P,REFRSH	;REFRESH THE STR.
  2405	003506'	254000	764513		  JRST	CNTADS		;LOST.
  2406	003507'	260040	762556		PUSHJ	P,RDHOME	; Read & Verify new HOM pages
  2407	003510'	255000	000000		  JFCL			; Just to make sure.
  2408	003511'	255000	000000		  JFCL
  2409	003512'	263040	000000		POPJ P,
  2410
  2411	003513'	563015	003434*	CNTADS:	HRROS	STRREF(P2)	;MARK WE STILL NEED REFRESHING.
  2412	003514'	201300	766204		MOVEI	T1,[ASCIZ /The structure WAS NOT successfully refreshed./]
  2413	003515'	324740	763617		PJRST	CONOUT
  2414
  2415	003516'	331000	000067*	GETDAT:	SKIPL	THSDAT##	;Do nothing if date is valid
  2416	003517'	263040	000000		 POPJ	P,
  2417	003520'	265440	000000*		JSP	T4,SAVE4	;Save P2 and P4
  2418	003521'	261040	000002		PUSH	P,J
  2419	003522'	201100	000000		MOVEI	J,0		;Job 0 is local time zone
  2420	003523'	201300	766216	GETDT1:	MOVEI	T1,[ASCIZ /Enter date as MM-DD-YYYY /]
  2421	003524'	260040	002347*		PUSHJ	P,OCONM
  2422	003525'	260040	003015*		PUSHJ	P,OPOUT
  2423	003526'	260040	003164*		PUSHJ	P,GETLIN	;Get response
  2424	003527'	254000	764523		  JRST	GETDT1
  2425	003530'	260040	003056*		PUSHJ	P,DECIN		;	MM
  2426	003531'	254000	764523		  JRST	GETDT1
  2427	003532'	254000	764523		  JRST	GETDT1
  2428	003533'	201647	777777		MOVEI	P2,-1(T2)
  2429	003534'	221640	000037		IMULI	P2,^D31
  2430	003535'	260040	003530*		PUSHJ	P,DECIN		;	    DD
  2431	003536'	254000	764523		  JRST	GETDT1
  2432	003537'	254000	764523		  JRST	GETDT1
  2433	003540'	271647	777777		ADDI	P2,-1(T2)
  2434	003541'	260040	003535*		PUSHJ	P,DECIN		;		YYYY
  2435	003542'	254000	764523		  JRST	GETDT1
  2436	003543'	254000	764523		  JRST	GETDT1
  2437	003544'	275340	003654		SUBI	T2,^D1964
  2438	003545'	221340	000564		IMULI	T2,^D31*^D12
  2439	003546'	270340	000015		ADD	T2,P2
  2440	003547'	260040	000000*		PUSHJ	P,COMDAS##
  2441	003550'	254000	764523		  JRST	GETDT1
  2442	003551'	201300	766224	GETDT2:	MOVEI	T1,[ASCIZ /Enter time as HHMM /]
  2443	003552'	260040	003524*		PUSHJ	P,OCONM
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 50-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2444	003553'	260040	003525*		PUSHJ	P,OPOUT
  2445	003554'	260040	003526*		PUSHJ	P,GETLIN	;Get response
  2446	003555'	254000	764551		  JRST	GETDT2
  2447	003556'	260040	003541*		PUSHJ	P,DECIN		;4 digit number
  2448	003557'	254000	764551		  JRST	GETDT2
  2449	003560'	254000	764551		  JRST	GETDT2
  2450	003561'	200300	000007		MOVE	T1,T2		;SET TIME ACCORDING TO ARGUMENT
  2451	003562'	231300	000144		IDIVI	T1,^D100	;Seperate HH from MM
  2452	003563'	221300	000074		IMULI	T1,^D60		;
  2453	003564'	270300	000007		ADD	T1,T2		;COMPUTE MINUTES
  2454	003565'	260040	000000*		PUSHJ	P,COMTMS##
  2455	003566'	254000	764551		  JRST	GETDT2
  2456	003567'	262040	000002		POP	P,J
  2457	003570'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 51
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2458				;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  2459				;;									;;
  2460				;;	Routine SETRAN - Start timer for pseudo-random number		;;
  2461				;;									;;
  2462				;;	Called by CMDSCN whenever it prompts the operator for		;;
  2463				;;	anything during ONCE and ONCDSK.  Needed in conjunction		;;
  2464				;;	with GETRAN which reads the current timer value for the		;;
  2465				;;	REFRESH command.						;;
  2466				;;									;;
  2467				;;	Clobbers T1, T2  - depending upon processor			;;
  2468				;;									;;
  2469				;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  2470
  2471	764571			SETRAN:			; Entry point to start timer for random number
  2472				IFCPU (<KL,KS>),<
  2473				IFCPU (<KL>),<
  2474					EXTERN EPT
  2475					SETZM	EPT+EPTLTB	; Clear EPT locations (KL)
  2476					CONO	MTR,MO.TON	; Turn on MTR clock
  2477				>; END IFCPU (KL)
  2478				IFCPU (KS),<
  2479	003571'	403300	000007		SETZB	T1,T2		; Set the Time Base
  2480	003572'	702600	000006		WRTIME	T1		; To Zero.
  2481				>;END IFCPU (KS)
  2482	003573'	263040	000000		POPJ	P,		; Return.
  2483				>;END IFCPU(<KL,KS>)
  2484
  2485				IFCPU (<KI,F3>),<
  2486					MOVE	T1,[JRST CLKLVL]; New Clock-routine
  2487					EXCH	T1,CH7+1	; Set New/Save Old Value
  2488					MOVEM	T1,CLKRAN	; Store for later
  2489					SETZM	CLKCNT		; Reset time base
  2490					WRPI	1B25!1B35	; TURN ON CHANNEL SEVEN.
  2491				IFCPU (KI),<WRAPR 1B25!1B26!7B35>
  2492				IFCPU (F3),<WRAPR LP.ESF+LP.CSF+LP.CLK+7B35>
  2493					POPJ	P,		; Return.
  2494				
  2495				CLKLVL:	AOS	CLKCNT		;
  2496				IFCPU (KI),<WRAPR 1B25!1B26!7B35>	;
  2497				IFCPU (F3),<WRAPR LP.ESF+LP.CSF+LP.CLK+7B35>
  2498					JEN	@CH7
  2499				
  2500				CLKRAN:	Z			; Holder for old CH7+1
  2501				CLKCNT: 0			; Timer value
  2502				>;END IFCPU (<KI,F3>)
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 52
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2503				;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  2504				;;									;;
  2505				;;	Routine GETRAN - Read the time-base or clock value		;;
  2506				;;									;;
  2507				;;	Called by CMDSCN in ONCE and ONCDSK each time the operator	;;
  2508				;;	is prompted for a response.  Updates RANNO## with a new		;;
  2509				;;	random seed used by REFSTR each time.				;;
  2510				;;									;;
  2511				;;	Clobbers T1.							;;
  2512				;;									;;
  2513				;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  2514
  2515				External RANNO			  ; Located in REFSTR, set here each cmd line
  2516
  2517	003574'	261040	000007	GETRAN:	PUSH	P,T2		  ; Save this register (T2)
  2518	003575'	702200	000006	IFCPU (<KL,KS>),<RDTIME	T1>	  ; Read time base setup earlier + counter
  2519				IFCPU (KL),<LSH T2,-^D12>	  ; Strip low order zero bits on KL
  2520				IFCPU (<KI,F3>),<
  2521					HRRZ T2,CLKCNT		  ; Read clock setup earlier + elapsed
  2522				IFCPU (KI),<WRAPR 1B24!7B35>	  ; Disable CLOCK now
  2523				IFCPU (F3),<WRAPR LP.CSF+LP.DSF+LP.CLK+7B35>
  2524					WRPI	1B26!1B35	  ; Turn OFF channel seven
  2525					MOVE	T1,CLKRAN	  ; Get previous channel 7
  2526					MOVEM	T1,CH7+1	  ; Reset
  2527				>;End IFCUP(<KI,F3>)
  2528	003576'	606340	777777		TRNN	T2,-1		  ; Make sure RH is neq 0
  2529	003577'	201340	434164		 MOVEI	T2,(SIXBIT /CAT/) ; If not, set to 'CAT'
  2530	003600'	552340	000000*		HRRZM	T2,RANNO	  ; Store for later
  2531	003601'	262040	000007		POP	P,T2		  ; Restore T2 from entry
  2532	003602'	263040	000000		POPJ	P,		  ; Return.
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 53
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2533				;SUBR TO ALLOW OPER TO QUERY/SELECT DSKCLN TYPE
  2534				;
  2535				SPCDKN:	MOVEI	T1,[ASCIZ /
  2536	003603'	201300	766230	DSKCLN mode is: /]
  2537	003604'	260040	003552*		PUSHJ	P,OCONM		;MOVE MSG TO OUTPUT BUF
  2538	003605'	260040	764670		PUSHJ	P,SPCDKP	;GET CURRENT DC MODE AND PRIORITY
  2539	003606'	205300	200000		MOVSI	T1,DCN.ON	;INDIC OPER HAS SEEN AND/OR
  2540	003607'	436300	001764*		IORM	T1,DCN		; SELECTED DSKCLN MODE
  2541	003610'	200347	764650		MOVE	T2,SCNDSK(T2)	;GET SIXBIT NAME OF CURRENT MODE
  2542	003611'	306400	000005		CAIN	T3,^L<(DCN.DF)>	;IS MODE DEFAULT?
  2543	003612'	200340	766234		 MOVE	T2,[SIXBIT /NULL/]	;YES, TELL THIS TO OPER
  2544	003613'	260040	003160*		PUSHJ	P,PRNAME	;BUFFER MODE NAME
  2545	003614'	260040	763620		PUSHJ	P,CRLFOP	;APPEND CRLF, DO CTY OUTPUT
  2546	003615'	201300	766235	SPCDK1:	MOVEI	T1,[ASCIZ /DSKCLN mode desired? /]
  2547	003616'	260040	003604*		PUSHJ	P,OCONM		;MOVE MSG TO OUTPUT BUF
  2548	003617'	260040	003553*		PUSHJ	P,OPOUT		;DO CTY OUTPUT
  2549	003620'	260040	003554*		PUSHJ	P,GETLIN	;GET OPER'S RESPONSE
  2550	003621'	263040	000000		 POPJ	P,		;NULL, NO CHANGE IN MODE
  2551	003622'	201600	764650		MOVEI	P1,SCNDSK	; Get address of Scan Table
  2552	003623'	402000	761307		SETZM	CMDSCF		; Specify NO STR/UNIT stuff
  2553	003624'	260040	761211		PUSHJ	P,CMDSCN	; Call Scanning routine
  2554	003625'	254000	764630		  JRST	SPDKHP		; No good!
  2555	003626'	137700	761005		DPB	P3,DCNYON	;SAVE IN DCN
  2556	003627'	263040	000000	NULDSK:	POPJ	P,		;RETURN
  2557
  2558				SPDKHP:	MOVEI	T1,[ASCIZ \
  2559				Bad entry: Type 'FULL', 'FAST', 'NONE'
  2560	003630'	201300	766242	 or just <Return> for default (NO CHANGE)\]
  2561	003631'	260040	763617		PUSHJ	P,CONOUT	;TYPE ERROR MSG ON CTY
  2562	003632'	254000	764615		JRST	SPCDK1		;LET OPER TRY AGAIN
  2563
  2564				;MODE-MNEMONIC CORRESPONDENCE TABLE
  2565				;
  2566					DEFINE	MKDSK <
  2567					X NONE,0,Ab.Nak,
  2568					X FAST,0,Ab.Nak,
  2569					X ,0,Ab.Nak,
  2570					X ,0,Ab.Nak,
  2571					X ,0,Ab.Nak,
  2572					X ,0,Ab.Nak,
  2573					X ,0,Ab.Nak,
  2574					X FULL,0,Ab.Nak,
  2575				>
  2576
  2577	003633'	254000	764630		SCNTB	(SPDKHP,SPDKHP,DSK)
  2578	003634'	254000	764630
  2579	003635'	254000	764627
  2580	003636'	000000	000000
  2581	003637'	000000	000000
  2582	003640'	000000	000000
  2583	003641'	000000	000000
  2584	003642'	000000	000000
  2585	003643'	000000	000000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 53-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2586	003644'	000000	000000
  2587	003645'	000000	000000
  2588	003646'	777770	764660
  2589	003647'	777770	764650
  2590	003650'	565756	450000
  2591	003651'	464163	640000
  2592	003652'	000000	000000
  2593	003653'	000000	000000
  2594	003654'	000000	000000
  2595	003655'	000000	000000
  2596	003656'	000000	000000
  2597	003657'	466554	540000
  2598	003660'	000000*	764660
  2599	003661'	000000*	764660
  2600	003662'	000000*	764660
  2601	003663'	000000*	764660
  2602	003664'	000000*	764660
  2603	003665'	000000*	764660
  2604	003666'	000000*	764660
  2605	003667'	000000*	764660
  2606
  2607				;ROUTINE TO GET/SET DSKCLN MODE AND DETERMINE WHO LAST SET IT
  2608				;
  2609	003670'	200340	003607*	SPCDKP:	MOVE	T2,DCN		;GET DSKCLN MODE WORD
  2610	003671'	243340	764672		JFFO	T2,.+1		;DETERMINE HIGHEST PRIORITY MODE
  2611	003672'	135350	761004		LDB	T2,DCNTAB(T3)	;FETCH IT
  2612	003673'	137340	761005		DPB	T2,DCNYON	;OPER HAS SEEN OR SELECTED THIS MODE
  2613	003674'	263040	000000		POPJ	P,		;RETURN
  2614
  2615				FILGO:	MOVEI T1,[Asciz\
  2616	003675'	201300	766263	Leaving the FILES dialogue...\]
  2617	003676'	260040	762544		PUSHJ P,LNGMES		; Let everyone know we're leaving!
  2618	003677'	205740	003441*	RWRHOM:	MOVSI P4,UNPCHG
  2619	003700'	554240	002766*		HLRZ U,SYSUNI		;FIRST UNIT
  2620	003701'	612745	003442*	CHGHOM:	TDNE P4,UNIDES(U)
  2621	003702'	260040	764707		PUSHJ P,UPDHOM		;REWRITE IF NEEDED.
  2622	003703'	412745	003701*		ANDCAM P4,UNIDES(U)
  2623	003704'	554245	002775*		HLRZ U,UNISYS(U)
  2624	003705'	326240	764701		JUMPN U,CHGHOM
  2625	003706'	263040	000000		POPJ P,
  2626
  2627
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 54
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2628				COMMENT #
  2629				@@SUBROUTINE UPDHOM
  2630				@@PURPOSE
  2631				SUBROUTINE TO READ A HOME PAGE, UPDATE IT FROM THE STR AND
  2632				UNIT DB, AND THEN WRITE IT OUT.
  2633				@@ENTRY
  2634				EXPECTS U/ UNIT DB AND F/ DDB.
  2635				@@ACCUM
  2636				DESTROYS
  2637				@@CALLS
  2638				SVOTAC, GETHOM, AND WTBOTH.
  2639				@@ #
  2640
  2641	003707'	265340	763660	UPDHOM:	JSP	T2,SVOTAC	;SAVE P4,F,U & J
  2642	003710'	476000	763517		SETOM	NOERH		;NO ERRORS PRINTED FOR HOME READ.
  2643	003711'	260040	763354		PUSHJ	P,GETHOM	;GET HOME PAGE INTO CORE.
  2644					  JRST	[MOVEI T1,%HOM
  2645						PUSHJ P,CORZER
  2646	003712'	254000	766272			JRST .+1]
  2647	003713'	202640	753000*		MOVEM	P2,%HOM+PAGNAM	;SAVE SIXBIT HOME PAGE IDENTIFIER
  2648	003714'	550645	003467*		HRRZ	P2,UNISTR(U)	;GET STR DATA BLOCK ADR.
  2649	003715'	200305	003171*		MOVE	T1,UNIHID(U)	;GET SIXBIT UNIT ID
  2650	003716'	202300	753000*		MOVEM	T1,%HOM+HOMHID	;SAVE IN HOME PAGE
  2651	003717'	554305	003714*		HLRZ	T1,UNISTR(U)	;GET NEXT UNIT DATA BLOCK ADR. IN STR
  2652	003720'	332000	000006		SKIPE	T1		;SAVE 0 IF LAST UNIT IN STR OR NOT IN A STR
  2653	003721'	200306	003715*		MOVE	T1,UNIHID(T1)	;GET ITS ID
  2654	003722'	202300	753000*		MOVEM	T1,%HOM+HOMNXT	;SAVE IN HOME PAGE
  2655	003723'	332300	000015		SKIPE	T1,P2		;SAVE 0 STR NAME IF UNIT NOT IN A STR
  2656	003724'	200315	003375*		MOVE	T1,STRNAM(P2)	;GET SIXBIT STR NAME
  2657	003725'	202300	753000*		MOVEM	T1,%HOM+HOMSNM	;SAVE IN HOME PAGE
  2658	003726'	322640	764751		JUMPE	P2,UPDHM3	;BYPASS ALL REFERENCES TO VALUES IN STR DATA BLOCK
  2659	003727'	554355	003451*		HLRZ	T2,STRUNI(P2)	;GET ADR. OF 1ST UNIT DATA BLOCK IN STR
  2660	003730'	200300	000007	UPDHM1:	MOVE	T1,T2		;CURRENT UNIT_NEXT UNIT
  2661	003731'	322300	764736		JUMPE	T1,UPDHM2	;IF NONE LEFT SAVE 0 IN HOMPRV
  2662	003732'	554346	003717*		HLRZ	T2,UNISTR(T1)	;GET ADR. OF NEXT UNIT DATA BLOCK IN STR
  2663	003733'	200306	003721*		MOVE	T1,UNIHID(T1)	;GET CURRENT UNIT'S SIXBIT ID
  2664	003734'	312340	000005		CAME	T2,U		;IS ADR. OF NEXT UNIT DATA BLOCK SAME AS THIS ONE?
  2665	003735'	254000	764730		JRST	UPDHM1		;YES - PUT SIXBIT ID INTO THIS UNIT'S HOME PAGE
  2666	003736'	202300	753000*	UPDHM2:	MOVEM	T1,%HOM+HOMPRV	;SAVE IN HOME PAGE
  2667								; 0 OR SIXBIT UNIT ID OF PREVIOUS UNIT IN STR
  2668	003737'	510315	003513*		HLLZ	T1,STRREF(P2)	;GET 'REFRESH' FLAG
  2669	003740'	502300	753000*		HLLM	T1,%HOM+HOMREF	;SAVE IN HOME PAGE
  2670	003741'	550300	000000*		HRRZ	T1,STRDDB+STRHSH ;
  2671	003742'	516300	753000*		HRLZM	T1,%HOM+HOMHSH	;
  2672	003743'	550300	763230		HRRZ	T1,RANHOM	;Use Remembered HOMRAN value
  2673	003744'	542300	753000*		HRRM	T1,%HOM+HOMRAN	;
  2674	003745'	200315	003217*		MOVE	T1,STROVR(P2)	;GET -VE # PAGES USER IS ALLOWED TO OVERDRAW
  2675	003746'	202300	753000*		MOVEM	T1,%HOM+HOMOVR	;SAVE IN HOME PAGE
  2676	003747'	550315	003204*		HRRZ	T1,STRP4C(P2)	;GET # PAGES FOR CRASH.SAV
  2677	003750'	202300	753000*		MOVEM	T1,%HOM+HOMP4C	;SAVE IN HOME PAGE
  2678
  2679	003751'	200305	003350*	UPDHM3:	MOVE	T1,UNILOG(U)	;GET SIXBIT LOGICAL UNIT WITHIN STR
  2680	003752'	202300	753000*		MOVEM	T1,%HOM+HOMLOG	;SAVE IN HOME PAGE
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 54-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2681	003753'	135300	003432*		LDB	T1,UNYLUN	;GET LOGICAL UNIT # WITHIN STR
  2682	003754'	202300	753000*		MOVEM	T1,%HOM+HOMLUN	;SAVE IN HOME PAGE
  2683	003755'	135300	003144*		LDB	T1,UNYSPU	;GET # SAT BLOCKS PER UNIT
  2684	003756'	202300	753000*		MOVEM	T1,%HOM+HOMSPU	;SAVE IN HOME PAGE
  2685	003757'	201300	753001*		MOVEI	T1,%HOM+HOMEND+1 ;FIRST WORD TO CLEAR.
  2686	003760'	303300	752777*		CAILE	T1,%HOM+HOMDAT-1 ;SKIP IF AT LEAST ONE WORD.
  2687	003761'	254000	764770		JRST	UPDHM4
  2688	003762'	402006	000000		SETZM	(T1)		;CLEAR THE FIRST WORD
  2689	003763'	306300	752777*		CAIN	T1,%HOM+HOMDAT-1	;SKIP IF MORE
  2690	003764'	254000	764770		JRST	UPDHM4
  2691	003765'	505300	753001*		HRLI	T1,%HOM+HOMEND+1
  2692	003766'	541300	753002*		HRRI	T1,%HOM+HOMEND+2
  2693	003767'	251300	752777*		BLT	T1,%HOM+HOMDAT-1	;CLEAR UNUSED WORDS
  2694				    ;HERE TO WRITE OUT.
  2695	003770'	202700	753000*	UPDHM4:	MOVEM	P3,%HOM+PAGCOD	;SAVE CODE WORD IN HOME PAGE.
  2696	003771'	205640	505755		MOVSI	P2,(SIXBIT .HOM.) ;RESTORE ARG.
  2697	003772'	260040	763435		PUSHJ	P,WTBOTH	;WRITE OUT BOTH HOME PAGES
  2698	003773'	256000	761000		STOPCD
  2699	003774'	263040	000000		POPJ	P,		;RETURN
  2700
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 55
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2701				;PRINT OR CHANGE SAT+RIB PCBS
  2702	003775'	200600	000000*	TYPSPC:	MOVE	P1,NMSTPC
  2703	003776'	201300	766275		MOVEI	T1,[ASCIZ /NUMBER OF SAT PCBS = /]
  2704	003777'	324740	763576		PJRST	DECLOP
  2705
  2706	004000'	201300	000005	CHGSPC:	MOVEI	T1,5
  2707	004001'	202300	764114		MOVEM	T1,MIN
  2708	004002'	201300	000050		MOVEI	T1,^D40		;%CTAMX=77  MAX PERMISSABLE VALUE IN PCBIO
  2709	004003'	202300	764113		MOVEM	T1,MAX
  2710	004004'	201300	766275		MOVEI	T1,[ASCIZ /NUMBER OF SAT PCBS = /]
  2711	004005'	200600	003775*		MOVE	P1,NMSTPC
  2712	004006'	260040	764030		PUSHJ	P,ASKQMM
  2713	004007'	263040	000000		 POPJ	P,
  2714	004010'	202340	004005*		MOVEM	T2,NMSTPC
  2715	004011'	263040	000000		POPJ	P,
  2716
  2717
  2718	004012'	200600	000000*	TYPRPC:	MOVE	P1,NMRBPC
  2719	004013'	201300	766302		MOVEI	T1,[ASCIZ /NUMBER OF RIB PCBS = /]
  2720	004014'	324740	763576		PJRST	DECLOP
  2721
  2722	004015'	201300	000005	CHGRPC:	MOVEI	T1,5
  2723	004016'	202300	764114		MOVEM	T1,MIN
  2724	004017'	201300	000024		MOVEI	T1,^D20		;%CTAMX=77  MAX PERMISSABLE VALUE IN PCBIO
  2725	004020'	202300	764113		MOVEM	T1,MAX
  2726	004021'	201300	766302		MOVEI	T1,[ASCIZ /NUMBER OF RIB PCBS = /]
  2727	004022'	200600	004012*		MOVE	P1,NMRBPC
  2728	004023'	260040	764030		PUSHJ	P,ASKQMM
  2729	004024'	263040	000000		  POPJ	P,
  2730	004025'	202340	004022*		MOVEM	T2,NMRBPC
  2731	004026'	263040	000000		POPJ	P,
  2732
  2733				;CHANGE BAT BLOCKS
  2734
  2735	004027'	201300	766307	CHGBAT:	MOVEI	T1,[ASCIZ /Type unit name to refresh BAT pages  /]
  2736	004030'	260040	003156*		PUSHJ	P,CONMES
  2737	004031'	260040	003617*		PUSHJ	P,OPOUT
  2738	004032'	260040	763637		PUSHJ	P,GETUNI
  2739	004033'	263040	000000		  POPJ	P,
  2740	004034'	260040	763731		PUSHJ	P,BATREF
  2741	004035'	263040	000000		  POPJ	P,
  2742	004036'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 56
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2743				;TYPE BAT
  2744
  2745	004037'	201300	766317	TYPBAT:	MOVEI	T1,[ASCIZ /Type unit name  /]
  2746	004040'	260040	004030*		PUSHJ	P,CONMES
  2747	004041'	260040	004031*		PUSHJ	P,OPOUT
  2748	004042'	260040	763637		PUSHJ	P,GETUNI
  2749	004043'	263040	000000		  POPJ	P,
  2750	004044'	402000	763743		SETZM	BATMAN
  2751	004045'	260040	763707		PUSHJ	P,CHKBAT
  2752	004046'	255000	000000		  JFCL			;IGNORE ERRORS.
  2753	004047'	200345	002652*		MOVE	T2,UNINAM(U)	;Physical unit name
  2754	004050'	260040	003613*		PUSHJ	P,PRNAME
  2755	004051'	201400	000050		MOVEI	T3,"("
  2756	004052'	260040	001547*		PUSHJ	P,COMTYO
  2757	004053'	200345	003751*		MOVE	T2,UNILOG(U)	;Logical name (such as DSKB1)
  2758	004054'	260040	004050*		PUSHJ	P,PRNAME
  2759	004055'	201400	000072		MOVEI	T3,":"
  2760	004056'	260040	004052*		PUSHJ	P,COMTYO
  2761	004057'	200345	003733*		MOVE	T2,UNIHID(U)	;Home block ID
  2762	004060'	260040	004054*		PUSHJ	P,PRNAME
  2763	004061'	201400	000051		MOVEI	T3,")"
  2764	004062'	260040	004056*		PUSHJ	P,COMTYO
  2765	004063'	200340	747000*		MOVE	T2,%BAT+BATFIR	;Get AOBJN pointer
  2766	004064'	271340	747000		ADDI	T2,%BAT
  2767	004065'	403700	000014		SETZB	P3,P1		;P1 IS PAGE COUNT, P3 REGION COUNT.
  2768	004066'	336007	000000*	TYPBT1:	SKIPN	BATNBB(T2)
  2769	004067'	254000	765075		 JRST	TYPBT2		;DONE.
  2770	004070'	271700	000001		ADDI	P3,1		;1 REGION.
  2771	004071'	135300	000000*		LDB	T1,BAYNBB	;(uses T2 as index reg)
  2772	004072'	271606	000001		ADDI	P1,1(T1)	;THIS MANY PAGES.
  2773	004073'	252340	765075		AOBJP	T2,TYPBT2
  2774	004074'	253340	765066		AOBJN	T2,TYPBT1
  2775	004075'	201300	766323	TYPBT2:	MOVEI	T1,[ASCIZ /  (counts do not agree)/]
  2776	004076'	316600	747000*		CAMN	P1,%BAT+BATPAT	;Page total
  2777	004077'	312700	747000*		CAME	P3,%BAT+BATCNT	;Count of regions
  2778	004100'	260040	004040*		 PUSHJ	P,CONMES
  2779	004101'	200300	000014		MOVE	T1,P1
  2780	004102'	260040	765260		PUSHJ	P,PR6DIG	;Output number in 6-character field
  2781	004103'	201300	766330		MOVEI	T1,[ASCIZ / bad pages in /]
  2782	004104'	260040	004100*		PUSHJ	P,CONMES
  2783	004105'	200300	000016		MOVE	T1,P3
  2784	004106'	260040	000000*		PUSHJ	P,PRTDIG
  2785	004107'	201300	766333		MOVEI	T1,[ASCIZ / distinct regions./]
  2786	004110'	260040	763620		PUSHJ	P,CRLFOP
  2787	004111'	322700	765212		JUMPE	P3,TYPBT9	;Just CRLF if none
  2788	004112'	201300	766337		MOVEI	T1,[ASCIZ /Do you want a list of bad spots? /]
  2789	004113'	260040	002623*		PUSHJ	P,YESNO		;Skip if "Y"
  2790	004114'	263040	000000		  POPJ	P,		;Done if "N" or no bad spots
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 57
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2791				;Output the bad spots
  2792
  2793	004115'	200640	747000*		MOVE	P2,%BAT+BATFIR	;Reset AOBJN pointer
  2794	004116'	271640	747000		ADDI	P2,%BAT
  2795	004117'	336015	004066*	TYPBT3:	SKIPN	BATNBB(P2)	;Zero marks end
  2796	004120'	254000	765212		 JRST	TYPBT9
  2797	004121'	200340	000015		MOVE	T2,P2		;Set up T2 for BAYNBB
  2798	004122'	135300	004071*		LDB	T1,BAYNBB	;Get repeat count
  2799	004123'	326300	765127		JUMPN	T1,TYPBT4	;Zero means single page
  2800	004124'	201300	766346		MOVEI	T1,[ASCIZ / 1 page  at /]
  2801	004125'	260040	004104*		PUSHJ	P,CONMES
  2802	004126'	254000	765133		JRST	TYPBT5
  2803
  2804	004127'	271300	000001	TYPBT4:	ADDI	T1,1		;Add 1 to repeat count
  2805	004130'	260040	765270		PUSHJ	P,PR2DIG	;Output leading blank if needed
  2806	004131'	201300	766351		MOVEI	T1,[ASCIZ / pages at /]
  2807	004132'	260040	004125*		PUSHJ	P,CONMES
  2808
  2809	004133'	200315	000000*	TYPBT5:	MOVE	T1,BATELB(P2)	;Get page address
  2810	004134'	260040	000000*		PUSHJ	P,PRT22A	;19-bit octal number
  2811	004135'	200315	004133*		MOVE	T1,BATELB(P2)	;Page address
  2812	004136'	242300	000002		LSH	T1,P2BLSH	;Convert to blocks
  2813	004137'	135340	000000*		LDB	T2,UNYBPY	;Blocks per cylinder
  2814	004140'	230300	000007		IDIV	T1,T2
  2815	004141'	135400	000000*		LDB	T3,UNYBPT	;Blocks per track
  2816	004142'	230340	000010		IDIV	T2,T3
  2817	004143'	135440	000000*		LDB	T4,UNYBPR	;Blocks per record
  2818	004144'	336000	000011		SKIPN	T4		;If old monitor,
  2819	004145'	201440	000001		 MOVEI	T4,1		; formatted in blocks
  2820	004146'	230400	000011		IDIV	T3,T4
  2821	004147'	271340	000001		ADDI	T2,1		;SYSTAT and ERRCHK number heads starting at 1
  2822	004150'	271400	000001		ADDI	T3,1		;Everyone numbers records starting at 1
  2823	004151'	261040	000010		PUSH	P,T3		;Record (T4 = block in record = 0)
  2824	004152'	261040	000007		PUSH	P,T2		;Head
  2825	004153'	261040	000006		PUSH	P,T1		;Cyl
  2826	004154'	201300	766354		MOVEI	T1,[ASCIZ / = cylinder/]
  2827	004155'	260040	004132*		PUSHJ	P,CONMES
  2828	004156'	262040	000006		POP	P,T1
  2829	004157'	260040	765264		PUSHJ	P,PR4DIG
  2830	004160'	201300	766357		MOVEI	T1,[ASCIZ /, head/]
  2831	004161'	260040	004155*		PUSHJ	P,CONMES
  2832	004162'	262040	000006		POP	P,T1
  2833	004163'	260040	765266		PUSHJ	P,PR3DIG
  2834	004164'	201300	766361		MOVEI	T1,[ASCIZ /, record/]	;Entire page is 1 record if in pages
  2835	004165'	331005	000000*		SKIPL	UNICHR(U)		;If formatted in blocks,
  2836	004166'	201300	766363		 MOVEI	T1,[ASCIZ /, records/]	; all 4 blocks are marked as unuseable
  2837	004167'	260040	004161*		PUSHJ	P,CONMES
  2838	004170'	200301	000000		MOVE	T1,(P)
  2839	004171'	260040	765266		PUSHJ	P,PR3DIG
  2840	004172'	262040	000006		POP	P,T1
  2841	004173'	335005	004165*		SKIPGE	UNICHR(U)	;Formatted in pages?
  2842	004174'	254000	765204		 JRST	TYPBT6		;Yes, done
  2843	004175'	201400	000055		MOVEI	T3,"-"		;No, output range of blocks
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 57-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2844	004176'	260040	004062*		PUSHJ	P,COMTYO
  2845	004177'	271300	000003		ADDI	T1,3		;4th block in page
  2846	004200'	135340	004141*		LDB	T2,UNYBPT
  2847	004201'	313300	000007		CAMLE	T1,T2		;If end block is past # of blocks per track
  2848	004202'	274300	000007		 SUB	T1,T2		; then it is on the next track
  2849	004203'	260040	765270		PUSHJ	P,PR2DIG	;Output ending block number
  2850	004204'	260040	765273	TYPBT6:	PUSHJ	P,SPACE3
  2851	004205'	550355	004117*		HRRZ	T2,BATNBB(P2)	;Get date
  2852	004206'	260040	765215		PUSHJ	P,TYPDAT	;Convert and output it
  2853	004207'	260040	002620*		PUSHJ	P,CRLF
  2854	004210'	252640	003123*		AOBJP	P2,CPOPJ	;Increment by 2
  2855	004211'	253640	765117		AOBJN	P2,TYPBT3	;Loop
  2856
  2857	004212'	332000	747000*	TYPBT9:	SKIPE	%BAT+BATCNT	;If any were found,
  2858	004213'	260040	004207*		 PUSHJ	P,CRLF		; output a blank link
  2859	004214'	263040	000000		POPJ	P,		;End of TYPBAT
  2860
  2861				;Routine to output the date
  2862
  2863	004215'	322340	765240	TYPDAT:	JUMPE	T2,NODATE	;Call with 14-bit TYMSHARE date in T2
  2864	004216'	201300	000000		MOVEI	T1,0		;No time-of-day
  2865	004217'	205740	400020		MOVSI	P4,400020	;Convert from TYM-GMT to DEC-local
  2866	004220'	260040	000000*		PUSHJ	P,DATCOM	;Returns 15-bit date in T2
  2867	004221'	263040	000000		  POPJ	P,		;Illegal date
  2868	004222'	231340	000564		IDIVI	T2,^D<31*12>	;T2/Year
  2869	004223'	271340	000100		ADDI	T2,^D64
  2870	004224'	261040	000007		PUSH	P,T2
  2871	004225'	231400	000037		IDIVI	T3,^D31		;T3/Month, T4/Day
  2872	004226'	261040	000010		PUSH	P,T3
  2873	004227'	201311	000001		MOVEI	T1,1(T4)
  2874	004230'	260040	765270		PUSHJ	P,PR2DIG	;Day (with leading blank if needed)
  2875	004231'	262040	000006		POP	P,T1
  2876	004232'	200306	765244		MOVE	T1,MONTAB(T1)	;"-Mmm-"
  2877	004233'	202300	765242		MOVEM	T1,DATBLK+0	;DATBLK+1 has 0 in bits 0-6
  2878	004234'	201300	765242		MOVEI	T1,DATBLK+0
  2879	004235'	260040	004167*		PUSHJ	P,CONMES	;Output month
  2880	004236'	262040	000006		POP	P,T1
  2881	004237'	324000	765270		PJRST	P,PR2DIG	;Year
  2882
  2883	004240'	201300	766365	NODATE:	MOVEI	T1,[ASCIZ /(no date)/]
  2884	004241'	324740	004235*		PJRST	CONMES
  2885
  2886	765242			DATBLK:	BLOCK	2
  2887					EXTERN	DATCOM
  2888	004244'	266254	167132	MONTAB:	ASCII/-Jan--Feb--Mar--Apr--May--Jun--Jul--Aug--Sep--Oct--Nov--Dec-/
	004245'	266154	561132
	004246'	266334	171132
	004247'	266036	071132
	004250'	266334	174532
	004251'	266256	567132
	004252'	266256	566132
	004253'	266036	563532
	004254'	266474	570132
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 57-3
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

	004255'	266374	372132
	004256'	266355	773132
	004257'	266114	561532
  2889
  2890				;Decimal output routines
  2891
  2892	004260'	305300	303240	PR6DIG:	CAIGE	T1,^D100000	;Output leading blanks if not 6 digits
  2893	004261'	260040	002126*		 PUSHJ	P,PRSPC
  2894	004262'	305300	023420	PR5DIG:	CAIGE	T1,^D10000
  2895	004263'	260040	004261*		 PUSHJ	P,PRSPC
  2896	004264'	305300	001750	PR4DIG:	CAIGE	T1,^D1000
  2897	004265'	260040	004263*		 PUSHJ	P,PRSPC
  2898	004266'	305300	000144	PR3DIG:	CAIGE	T1,^D100
  2899	004267'	260040	004265*		 PUSHJ	P,PRSPC
  2900	004270'	305300	000012	PR2DIG:	CAIGE	T1,^D10
  2901	004271'	260040	004267*		 PUSHJ	P,PRSPC##
  2902	004272'	254000	004106*		JRST	PRTDIG##
  2903
  2904	004273'	201300	766367	SPACE3:	MOVEI	T1,[ASCIZ /   /];3 blanks
  2905	004274'	324740	004241*		PJRST	CONMES
  2906
  2907	765275				VAR
  2908	765275			ONDLIT:	LIT
  2909	004275'	064250	551244
  2910	004276'	476452	320356
  2911	004277'	643234	364100
  2912	004300'	703454	573312
  2913	004301'	673504	061344
  2914	004302'	647354	764734
  2915	004303'	635016	464312
  2916	004304'	203477	171750
  2917	004305'	627324	052640
  2918	004306'	000000	000000
  2919	004307'	064250	664730
  2920	004310'	625016	372344
  2921	004311'	727076	472744
  2922	004312'	625011	642612
  2923	004313'	422464	071312
  2924	004314'	633454	571720
  2925	004315'	647354	700000
  2926	004316'	064251	544634
  2927	004317'	476444	042644
  2928	004320'	512372	251500
  2929	004321'	265010	271322
  2930	004322'	673164	071762
  2931	004323'	717514	566500
  2932	004324'	526404	060734
  2933	004325'	747574	174576
  2934	004326'	200000	000000
  2935	004327'	001600	750000*
  2936	004330'	751000	751001
  2937	004331'	751400	751401
  2938	004332'	777400	751000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 57-4
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2939	004333'	301400	000040
  2940	004334'	263040	000000
  2941	004335'	211700	000001
  2942	004336'	254000	003271*
  2943	004337'	211700	000002
  2944	004340'	254000	004336*
  2945	004341'	211700	000003
  2946	004342'	254000	004340*
  2947	004343'	201740	000001
  2948	004344'	254000	761252
  2949	004345'	064241	505202
  2950	004346'	713124	074736
  2951	004347'	725012	352644
  2952	004350'	425017	167752
  2953	004351'	203574	167350
  2954	004352'	203515	720310
  2955	004353'	675016	464322
  2956	004354'	715764	000000
  2957	004355'	064250	567350
  2958	004356'	627455	167316
  2959	004357'	203515	062500
  2960	004360'	432231	442646
  2961	004361'	203115	160730
  2962	004362'	677176	562534
  2963	004363'	271341	505100
  2964	004364'	202517	170312
  2965	004365'	201050	747504
  2966	004366'	203515	720344
  2967	004367'	627516	571334
  2968	004370'	203515	720236
  2969	004371'	472070	527000
  2970	004372'	064244	020250
  2971	004373'	747414	520104
  2972	004374'	442131	450104
  2973	004375'	203155	771100
  2974	004376'	605015	464746
  2975	004377'	721015	763100
  2976	004400'	677416	464736
  2977	004401'	673465	606424
  2978	004402'	000000	000000
  2979	004403'	064250	644630
  2980	004404'	426465	220000
  2981	004405'	201010	444646
  2982	004406'	516371	453212
  2983	004407'	203236	320346
  2984	004410'	703135	466312
  2985	004411'	621016	764750
  2986	004412'	641016	473736
  2987	004413'	201052	321312
  2988	004414'	715341	505000
  2989	004415'	064252	474740
  2990	004416'	625004	252262
  2991	004417'	502124	044212
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 57-5
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2992	004420'	462404	220314
  2993	004421'	677444	060500
  2994	004422'	663236	372100
  2995	004423'	677144	067740
  2996	004424'	723235	767346
  2997	004425'	270321	200000
  2998	004426'	064252	474740
  2999	004427'	625004	241620
  3000	004430'	406350	742500
  3001	004431'	442131	450104
  3002	004432'	203155	771100
  3003	004433'	605015	464746
  3004	004434'	721015	763100
  3005	004435'	677416	464736
  3006	004436'	673465	606424
  3007	004437'	000000	000000
  3008	004440'	064252	474740
  3009	004441'	625004	252262
  3010	004442'	502124	072734
  3011	004443'	647505	567302
  3012	004444'	667124	044212
  3013	004445'	462404	220314
  3014	004446'	677444	060500
  3015	004447'	663236	372100
  3016	004450'	677144	067740
  3017	004451'	723235	767346
  3018	004452'	270000	000000
  3019	004453'	064252	474740
  3020	004454'	625004	241620
  3021	004455'	406350	742500
  3022	004456'	727355	172132
  3023	004457'	673035	562500
  3024	004460'	442131	450104
  3025	004461'	203155	771100
  3026	004462'	605015	464746
  3027	004463'	721015	763100
  3028	004464'	677416	464736
  3029	004465'	673465	600000
  3030	004466'	064252	474740
  3031	004467'	625004	252262
  3032	004470'	502124	071750
  3033	004471'	711335	660732
  3034	004472'	625011	042630
  3035	004473'	501044	063336
  3036	004474'	711014	120330
  3037	004475'	647476	420336
  3038	004476'	631015	770350
  3039	004477'	647375	671534
  3040	004500'	000000	000000
  3041	004501'	064252	474740
  3042	004502'	625004	241620
  3043	004503'	406350	742500
  3044	004504'	717516	226734
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 57-6
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3045	004505'	607334	520220
  3046	004506'	426312	021100
  3047	004507'	633376	220302
  3048	004510'	203315	171750
  3049	004511'	203374	620336
  3050	004512'	703515	167734
  3051	004513'	715340	000000
  3052	004514'	422364	054636
  3053	004515'	525012	740634
  3054	004516'	521011	152100
  3055	004517'	522364	041212
  3056	004520'	201425	147634
  3057	004521'	266311	147212
  3058	004522'	261011	751100
  3059	004523'	311230	447656
  3060	004524'	471764	024250
  3061	004525'	546410	520106
  3062	004526'	244321	200000
  3063	004527'	422364	054636
  3064	004530'	525012	740634
  3065	004531'	521011	152100
  3066	004532'	522364	041212
  3067	004533'	201425	153644
  3068	004534'	446510	526612
  3069	004535'	472030	246212
  3070	004536'	421304	047644
  3071	004537'	201445	153644
  3072	004540'	446510	526640
  3073	004541'	512372	442606
  3074	004542'	522130	437500
  3075	004543'	242513	150212
  3076	004544'	201065	106424
  3077	004545'	000000	000000
  3078	004546'	466232	351622
  3079	004547'	472164	047644
  3080	004550'	202231	641636
  3081	004551'	472471	151650
  3082	004552'	426352	420220
  3083	004553'	406471	020206
  3084	004554'	476352	352202
  3085	004555'	472504	043236
  3086	004556'	511012	547222
  3087	004557'	521000	000000
  3088	004560'	466232	351622
  3089	004561'	472164	047644
  3090	004562'	202231	641636
  3091	004563'	472471	151650
  3092	004564'	426352	420240
  3093	004565'	406071	320246
  3094	004566'	426504	044610
  3095	004567'	202151	751100
  3096	004570'	526351	152100
  3097	004571'	000000	000000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 57-7
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3098	004572'	064250	444646
  3099	004573'	455010	647644
  3100	004574'	466032	420210
  3101	004575'	476132	320234
  3102	004576'	476504	046602
  3103	004577'	522071	020212
  3104	004600'	542410	541650
  3105	004601'	426104	043236
  3106	004602'	512330	152100
  3107	004603'	476344	052634
  3108	004604'	446504	000000
  3109	004605'	064251	547644
  3110	004606'	425012	444202
  3111	004607'	471011	747212
  3112	004610'	202310	151650
  3113	004611'	202531	644650
  3114	004612'	202231	620246
  3115	004613'	522444	000000
  3116	004614'	064252	447636
  3117	004615'	202330	147262
  3118	004616'	202472	451116
  3119	004617'	515000	000000
  3120	004620'	267374	663330
  3121	004621'	647354	526500
  3122	004622'	201000	000000
  3123	004623'	727355	172100
  3124	004624'	627456	267744
  3125	004625'	201000	000000
  3126	004626'	613034	420314
  3127	004627'	677455	560750
  3128	004630'	201000	000000
  3129	004631'	667035	167350
  3130	004632'	627354	167306
  3131	004633'	625000	000000
  3132	004634'	243355	720310
  3133	004635'	647475	324500
  3134	004636'	201000	000000
  3135	004637'	243234	767336
  3136	004640'	713134	424500
  3137	004641'	201000	000000
  3138	004642'	064251	440646
  3139	004643'	521012	547222
  3140	004644'	521012	740646
  3141	004645'	471172	420214
  3142	004646'	476531	642100
  3143	004647'	446344	051650
  3144	004650'	511000	000000
  3145	004651'	064252	453636
  3146	004652'	202311	743622
  3147	004653'	416031	420252
  3148	004654'	472232	420000
  3149	004655'	236464	043236
  3150	004656'	526350	420222
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 57-8
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3151	004657'	471012	352244
  3152	004660'	200000	000000
  3153	004661'	064251	447616
  3154	004662'	446070	146100
  3155	004663'	526351	152100
  3156	004664'	000000	000000
  3157	004665'	202331	151646
  3158	004666'	446350	720214
  3159	004667'	512371	520246
  3160	004670'	522444	000000
  3161	004671'	064247	747236
  3162	004672'	202473	151650
  3163	004673'	426324	051650
  3164	004674'	512530	352252
  3165	004675'	512120	000000
  3166	004676'	202232	320256
  3167	004677'	512232	442500
  3168	004700'	502451	752212
  3169	004701'	416510	542000
  3170	004702'	064240	000000
  3171	004703'	202232	320236
  3172	004704'	432145	546222
  3173	004705'	472120	000000
  3174	004706'	000000*	000000*
  3175	004707'	000000*	000000*
  3176	004710'	202410	143612
  3177	004711'	202210	151210
  3178	004712'	536032	242500
  3179	004713'	512130	142100
  3180	004714'	426452	247644
  3181	004715'	000000	000000
  3182	004716'	634164	000000
  3183	004717'	202410	143612
  3184	004720'	202071	747246
  3185	004721'	446472	442634
  3186	004722'	416624	042644
  3187	004723'	512372	200000
  3188	004724'	442032	242256
  3189	004725'	406450	520256
  3190	004726'	512232	442500
  3191	004727'	426452	247644
  3192	004730'	000000	000000
  3193	004731'	202151	151246
  3194	004732'	521000	000000
  3195	004733'	202470	541636
  3196	004734'	472104	000000
  3197	004735'	000000	765733
  3198	004736'	700600	002562*
  3199	004737'	263040	000000
  3200	004740'	472372	420202
  3201	004741'	202411	054646
  3202	004742'	446070	146100
  3203	004743'	526351	152132
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 57-9
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3204	004744'	522453	120202
  3205	004745'	436031	147000
  3206	004746'	000000	765740
  3207	004747'	064250	467500
  3208	004750'	747376	520356
  3209	004751'	607356	420350
  3210	004752'	675015	167322
  3211	004753'	723234	166322
  3212	004754'	753124	072320
  3213	004755'	625010	240650
  3214	004756'	203414	163712
  3215	004757'	715015	767100
  3216	004760'	723215	171500
  3217	004761'	526351	152176
  3218	004762'	064240	000000
  3219	004763'	064252	444222
  3220	004764'	515015	171500
  3221	004765'	673376	420334
  3222	004766'	677455	560730
  3223	004767'	663624	062336
  3224	004770'	673125	420302
  3225	004771'	713124	074736
  3226	004772'	725012	352644
  3227	004773'	425761	505000
  3228	004774'	260000	000000
  3229	004775'	240000	000000
  3230	004776'	244000	000000
  3231	004777'	064252	352244
  3232	005000'	202231	620104
  3233	005001'	516632	321100
  3234	005002'	516130	151206
  3235	005003'	441011	444646
  3236	005004'	521640	000000
  3237	005005'	064252	547222
  3238	005006'	522464	047236
  3239	005007'	521011	147100
  3240	005010'	405010	644630
  3241	005011'	425012	352244
  3242	005012'	526072	452644
  3243	005013'	425641	505000
  3244	005014'	472130	542246
  3245	005015'	202450	543244
  3246	005016'	426471	044634
  3247	005017'	435000	000000
  3248	005020'	350000	000000
  3249	005021'	466231	620172
  3250	005022'	200000	000000
  3251	005023'	202330	154100
  3252	005024'	365000	000000
  3253	005025'	064252	640630
  3254	005026'	526124	047236
  3255	005027'	521011	147100
  3256	005030'	502132	246622
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 57-10
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3257	005031'	522510	542100
  3258	005032'	512031	643612
  3259	005033'	000000	000000
  3260	005034'	064250	344202
  3261	005035'	472170	520256
  3262	005036'	446311	420206
  3263	005037'	406532	342500
  3264	005040'	516512	220250
  3265	005041'	475011	642612
  3266	005042'	421012	242614
  3267	005043'	512132	344222
  3268	005044'	472160	000000
  3269	005045'	064252	547222
  3270	005046'	521011	142100
  3271	005047'	446464	000000
  3272	005050'	064253	242644
  3273	005051'	475012	547222
  3274	005052'	521011	142100
  3275	005053'	265011	642656
  3276	005054'	202230	420234
  3277	005055'	426130	442610
  3278	005056'	000000	000000
  3279	005057'	000000	020002
  3280	005060'	502030	742646
  3281	005061'	202151	751100
  3282	005062'	416450	151620
  3283	005063'	272470	153100
  3284	005064'	365000	000000
  3285	005065'	260040	763624
  3286	005066'	215011	743100
  3287	005067'	502030	742646
  3288	005070'	202031	446236
  3289	005071'	536130	420214
  3290	005072'	476444	047654
  3291	005073'	426450	451202
  3292	005074'	535012	042644
  3293	005075'	202532	342644
  3294	005076'	201724	000000
  3295	005077'	446353	420000
  3296	005100'	516512	220302
  3297	005101'	663454	560710
  3298	005102'	745014	574322
  3299	005103'	717516	300000
  3300	005104'	000000	766100
  3301	005105'	064252	467736
  3302	005106'	203334	167362
  3303	005107'	203155	166312
  3304	005110'	203476	471352
  3305	005111'	617516	571312
  3306	005112'	715024	020236
  3307	005113'	673317	120336
  3308	005114'	673124	060730
  3309	005115'	663376	762710
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 57-11
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3310	005116'	204321	200000
  3311	005117'	523636	062500
  3312	005120'	673035	562746
  3313	005121'	203374	620340
  3314	005122'	643636	364706
  3315	005123'	607304	072734
  3316	005124'	647516	320322
  3317	005125'	671012	352244
  3318	005126'	261014	574350
  3319	005127'	713024	041644
  3320	005130'	203575	062734
  3321	005131'	203115	767312
  3322	005132'	000000	000000
  3323	005133'	302715	003727*
  3324	005134'	254000	764272
  3325	005135'	254000	764235
  3326	005136'	064252	567322
  3327	005137'	721014	166344
  3328	005140'	627034	474500
  3329	005141'	647344	063322
  3330	005142'	663124	071750
  3331	005143'	713534	372352
  3332	005144'	713121	505000
  3333	005145'	260040	764317
  3334	005146'	260040	764315
  3335	005147'	427356	462744
  3336	005150'	203535	664750
  3337	005151'	203354	166712
  3338	005152'	203515	720302
  3339	005153'	623100	000000
  3340	005154'	522210	152100
  3341	005155'	727355	172100
  3342	005156'	647464	060730
  3343	005157'	713134	162362
  3344	005160'	203235	620302
  3345	005161'	203476	471352
  3346	005162'	617516	571312
  3347	005163'	000000	000000
  3348	005164'	523214	520246
  3349	005165'	546472	442632
  3350	005166'	203476	471352
  3351	005167'	617516	571312
  3352	005170'	203214	171500
  3353	005171'	673376	420304
  3354	005172'	627135	620210
  3355	005173'	426151	147212
  3356	005174'	421017	162750
  3357	005175'	000000	000000
  3358	005176'	417035	667336
  3359	005177'	721014	162310
  3360	005200'	203535	664750
  3361	005201'	203515	720346
  3362	005202'	723456	561750
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 57-12
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3363	005203'	727454	500000
  3364	005204'	523214	520346
  3365	005205'	723456	561750
  3366	005206'	727454	520256
  3367	005207'	406464	047236
  3368	005210'	521016	372706
  3369	005211'	617136	371714
  3370	005212'	727315	474500
  3371	005213'	713134	671312
  3372	005214'	717214	562134
  3373	005215'	000000	000000
  3374	005216'	427356	462744
  3375	005217'	203114	172312
  3376	005220'	203036	320232
  3377	005221'	465330	442132
  3378	005222'	546633	154500
  3379	005223'	000000	000000
  3380	005224'	427356	462744
  3381	005225'	203515	166712
  3382	005226'	203036	320220
  3383	005227'	442331	520000
  3384	005230'	064250	451626
  3385	005231'	416311	620332
  3386	005232'	677114	520322
  3387	005233'	715644	000000
  3388	005234'	566554	540000
  3389	005235'	422471	341630
  3390	005236'	471015	567710
  3391	005237'	625014	462746
  3392	005240'	647454	562176
  3393	005241'	200000	000000
  3394	005242'	064250	260710
  3395	005243'	203135	672344
  3396	005244'	745644	052362
  3397	005245'	703124	023614
  3398	005246'	526311	423530
  3399	005247'	201170	640646
  3400	005250'	521165	420116
  3401	005251'	472371	642516
  3402	005252'	064244	067744
  3403	005253'	203256	571750
  3404	005254'	201712	262750
  3405	005255'	727455	637100
  3406	005256'	633376	220310
  3407	005257'	627154	172730
  3408	005260'	721005	047236
  3409	005261'	202071	040634
  3410	005262'	436125	100000
  3411	005263'	064251	462702
  3412	005264'	733235	663500
  3413	005265'	723214	520214
  3414	005266'	446310	551500
  3415	005267'	623234	166336
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 57-13
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3416	005270'	637534	527134
  3417	005271'	270000	000000
  3418	005272'	201300	753000
  3419	005273'	260040	002732*
  3420	005274'	254000	764713
  3421	005275'	472531	541212
  3422	005276'	511011	743100
  3423	005277'	516032	420240
  3424	005300'	416052	320172
  3425	005301'	200000	000000
  3426	005302'	472531	541212
  3427	005303'	511011	743100
  3428	005304'	512230	220240
  3429	005305'	416052	320172
  3430	005306'	200000	000000
  3431	005307'	523636	062500
  3432	005310'	727355	172100
  3433	005311'	673035	562500
  3434	005312'	723364	071312
  3435	005313'	633454	571720
  3436	005314'	202050	152100
  3437	005315'	703034	762746
  3438	005316'	201000	000000
  3439	005317'	523636	062500
  3440	005320'	727355	172100
  3441	005321'	673035	562500
  3442	005322'	200000	000000
  3443	005323'	201005	061736
  3444	005324'	727356	471500
  3445	005325'	623364	067336
  3446	005326'	721014	163744
  3447	005327'	627125	100000
  3448	005330'	203054	162100
  3449	005331'	703034	762746
  3450	005332'	203235	620000
  3451	005333'	203115	171750
  3452	005334'	647354	372100
  3453	005335'	713134	764736
  3454	005336'	673465	600000
  3455	005337'	423364	074736
  3456	005340'	725016	760734
  3457	005341'	721014	120330
  3458	005342'	647476	420336
  3459	005343'	631014	260710
  3460	005344'	203476	067750
  3461	005345'	715764	000000
  3462	005346'	201424	070302
  3463	005347'	637124	020302
  3464	005350'	721000	000000
  3465	005351'	203414	163712
  3466	005352'	715014	172100
  3467	005353'	000000	000000
  3468	005354'	201724	061762
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 57-14
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3469	005355'	663235	662312
  3470	005356'	710000	000000
  3471	005357'	261015	062702
  3472	005360'	620000	000000
  3473	005361'	261016	262706
  3474	005362'	677454	400000
  3475	005363'	261016	262706
  3476	005364'	677454	471400
  3477	005365'	243355	720310
  3478	005366'	607514	524400
  3479	005367'	201004	000000
  3480
  3481
  3482			005371	ONDLNR==.-%OND+1
  3483			006000	ONDLNP==<ONDLNR!777>+1
  3484
  3485				ONSZCK(ONCDSK,OND)	;CHECK TO SEE IF ENOUGH PAGES ALLOCATED
  3486
  3487	005370'			DEPHASE
  3488
  3489	005370'			ONDEND:	END		;Cannot use $END in PHASEd code
  3490
NO ERRORS DETECTED
PROGRAM BREAK IS 005370
11K CORE USED
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 58
ONCDSK.MAC	 4-DEC-87 15:51		SYMBOL TABLE

AB.ACK		000000	EXT	CMDSC3		761237		DCSIZ		000003	SPD	GETSRB		761177	
AB.CVR		000266'	EXT	CMDSC4		761252		DCXX		000006	SPD	GETUNI		763637	
AB.NAK		000242'	EXT	CMDSC5		761256		DDBLEN		000000	EXT	HLPCHG		762234	
AB.TCV		000273'	EXT	CMDSCF		761307	INT	DDSTAR		003504'	EXT	HLPFIL		761322	
AB.VER		000264'	EXT	CMDSCN		761211	INT	DDTX		000362'	EXT	HLPSRP		762433	
ADDNOT		764465		CMPLOG		003450'	EXT	DECIN		003556'	EXT	HLPTY1		761323	
ADDUN2		764410		CNTADS		764513		DECLOP		763576	INT	HLPTYP		762051	
ADDUN4		764445		CODBAT		002364'	EXT	DEVIOS		000002	SIN	HLPUIP		762362	
ADDUN5		764452		CODHOM		002355'	EXT	DIE		000000'	EXT	HMBOK		762727	
ADDUN7		764456		CODRIB		000203'	EXT	DISST1		764350		HMBOK2		762735	
ADDUNI		764374		COMDAS		003547'	EXT	DISST2		764356		HMBOK3		762754	
ADUNT		764432		COMTMS		003565'	EXT	DSKCPY		763554		HOMDAT		000000	EXT
ASKQMM		764030	INT	COMTYO		004176'	EXT	DSKDDB		000000	EXT	HOMDCT		000000	EXT
ASKQUE		763622		CONCHK		763416		DSKPIF		002555'	EXT	HOMDCV		001761'	EXT
ASKRP1		764104		CONMES		004274'	EXT	DSKPIN		004736'	EXT	HOMEND		000000	EXT
ASKRPQ		764100		CONOUT		763617		DSKPPU		002013'	EXT	HOMFEP		000000	EXT
ASKRPT		764037		CORZER		005273'	EXT	DSPCHG		762241		HOMHID		000000	EXT
BADDIS		762033		CPOPJ		004210'	EXT	DSPDSK		764636		HOMHSH		000000	EXT
BATBAD		763742		CPOPJ1		004342'	EXT	DSPFIL		761352		HOMLOG		000000	EXT
BATCNT		000000	EXT	CPUF3		000004	SPD	DSPSRP		762442		HOMLUN		000000	EXT
BATELB		004135'	EXT	CPUKI		000001	SPD	DSPTYP		762056		HOMMFD		000000	EXT
BATFIR		000000	EXT	CPUKL		000002	SPD	DSPUIP		762371		HOMNXT		000000	EXT
BATMAN		763743		CPUKS		000003	SPD	ERRHM2		763227		HOMOVR		000000	EXT
BATNBB		004205'	EXT	CPUTYP		000003	SPD	ERRHOM		763226		HOMP4C		000000	EXT
BATPAT		000000	EXT	CPYWAT		763565		EVASIZ		000315'	EXT	HOMPRV		000000	EXT
BATREF		763731		CPZZ		000000	SPD	EVMALC		002062'	EXT	HOMRAN		000000	EXT
BATREG		002736'	EXT	CRESTT		763055		F		000004	INT	HOMREF		000000	EXT
BAYNBB		004122'	EXT	CRLF		004213'	EXT	FILCMD		761325		HOMSAT		000000	EXT
BRMAX		000000	EXT	CRLFOP		763620		FILGO		764675		HOMSNM		000000	EXT
CANTAD		764467		CTEXT		003166'	EXT	FILHL1		761343		HOMSPU		000000	EXT
CCOD		000000	EXT	CTYDO		000270'	EXT	FILHLP		761342		HOMSUF		000000	EXT
CH7		000000	EXT	CWCOD		002560'	EXT	FILMAN		761012	INT	ICPFAC		000000	EXT
CHGBAT		765027		DATBLK		765242		FILOPT		761312	INT	INLMES		001556'	EXT
CHGCMD		761325		DATCOM		004220'	EXT	FIROK		763372		INSERT		763043	
CHGHL1		762230		DBLSTD		764110		FLGDN1		762651		IOSEL		002563'	EXT
CHGHLP		762227		DC.SIZ		000003	SIN	FLGDN2		762657		J		000002	INT
CHGHOM		764701		DCFAST		000052'	EXT	FLGDN3		762661		JFYSEC		000000	EXT
CHGIT		762220		DCN		003670'	EXT	FLGDN4		762662		KEPSAM		764076	
CHGRPC		765015		DCN.DF		010000	SIN	FLGDN5		762671		KNNUNI		764045	
CHGSPC		765000		DCN.HM		020000	SIN	FLGDWN		762650		KNOUNI		764115	
CHGSTR		764206		DCN.MN		040000	SIN	FNDSTR		763260		KONCPY		000000	EXT
CHKANS		764063		DCN.ON		200000	SIN	FNDUN1		763652		KONDWN		001643'	EXT
CHKBAT		763707		DCN.OP		400000	SIN	FNDUNI		763651		KONLTM		000000	EXT
CHKFLG		763434		DCN.UR		100000	SIN	FSTERR		763502		KONTOK		762645	
CHKHOM		762715		DCNDFT		030000	SIN	FTYUNI		764126		KONUPA		001631'	EXT
CHKUN1		763214		DCNTAB		761004		GETBAT		763361	INT	KOPDWN		001642'	EXT
CHKUNI		763175		DCNUM		000006	SPD	GETDAT		764516		LI.PIN		000200	SPD
CLRDDB		001602'	EXT	DCNYDF		761011	INT	GETDT1		764523		LINKIT		763035	
CLRSND		002615'	EXT	DCNYHM		761010	INT	GETDT2		764551		LINKT1		763041	
CLRSTR		764362		DCNYMN		761007	INT	GETHOM		763354	INT	LIT$0		764660	SPD
CMDMSG		761306		DCNYON		761005	INT	GETLIN		003620'	EXT	LIT$1		764660	SPD
CMDSC1		761227		DCNYOP		761004	INT	GETPEV		002437'	EXT	LIT$10		761633	SPD
CMDSC2		761233		DCNYUR		761006	INT	GETRAN		764574		LIT$11		761704	SPD
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 58-2
ONCDSK.MAC	 4-DEC-87 15:51		SYMBOL TABLE

LIT$12		761753	SPD	NULTYP		762051		PRCOL		002131'	EXT	RWRHOM		764677	
LIT$13		761767	SPD	NULUIP		762362		PRNAME		004060'	EXT	S$ENTR	777777	777775	SIN
LIT$14		762007	SPD	OCONM		003616'	EXT	PRNAMF		002141'	EXT	S$HALT	777777	777777	SIN
LIT$2		764660	SPD	OCTIN		002254'	EXT	PRSPC		004271'	EXT	S$NAME		761000	SPD
LIT$3		764660	SPD	OFLTAB		763146		PRT22A		004134'	EXT	S$NONA		000000	SIN
LIT$4		764660	SPD	OHTINI		002533'	EXT	PRTDIG		004272'	EXT	S$TEMP		000000	SPD
LIT$5		764660	SPD	OHTNUM		002551'	EXT	QSTSTD		764072		S$XCT	777777	777776	SIN
LIT$6		764660	SPD	OLDST0		762773		RADX10		002607'	EXT	SATCNT		000141'	EXT
LIT$7		764660	SPD	OLDST1		762775		RANHOM		763230		SAVE4		003520'	EXT
LNGMES		762544	INT	OLDST2		762767		RANNO		003600'	EXT	SCNBAT		000000	EXT
LNGMS1		762545		OLDST4		762777		RBINDX		000000	EXT	SCNCHG		762247	
LP2BAT		004707'	EXT	OLDST5		763007		RBLVPR		000000	EXT	SCNDSK		764650	
LP2HOM		004706'	EXT	OLDST6		763001		RBLVSP		000000	EXT	SCNFIL		761371	
LPNBAT		000000	EXT	OLDST8		763011		RBMASK		000000	EXT	SCNSD2		763221	
LPNHOM		000000	EXT	OLDSTR		762757		RBREAL		002442'	EXT	SCNSRP		762450	
LSTRED		763173		ONCDDB		001603'	EXT	RBSPAR		000000	EXT	SCNST2		763165	
LSTUNI		763030		ONCDSK		761000	ENT	RBYPNO		002445'	EXT	SCNSTD		763217	
MANCM1		761017		ONCMOD		000000'	ENT	RBYUN1		000103'	EXT	SCNSTR		763154	
MANCOM		761020		ONDEND		005370'		RBYUN4		000000	EXT	SCNTYP		762067	
MANOK		761027		ONDLIT		765275		RBYUNI		002443'	EXT	SCNUIP		762375	
MANOK1		761043		ONDLNP		006000	SIN	RDBAT1		763700		SCNUN1		763071	
MANOK2		761056		ONDLNR		005371	SIN	RDBAT6		763704		SCNUNI		762623	
MANQST		761024		ONDSTT		000000'	INT	RDBNON		763405		SETBAT		763363	
MANREF		761022		OPAGIN		763520	INT	RDBOTH		763370		SETCHG		763624	
MAX		764113	INT	OPAGIO		763525		RDBSKP		763404		SETDDO		001605'	EXT
MAYREF		764116		OPAGOT		763523	INT	RDCHEK		763407		SETPRV		763634	
MCKKON		763235		OPOUT		004041'	EXT	RDHOM1		762614		SETPUB		763631	
MFDRIB		002315'	EXT	OVRDEF		764322		RDHOM2		762617		SETRAN		764571	
MIN		764114	INT	P		000001	INT	RDHOME		762556		SETUNT		763104	
MISUNI		763205		P1		000014	INT	RDRBS2		761072		SETUTS		763113	
MONTAB		765244		P2		000015	INT	RDRBS3		761075		SIZCHG		000004	SPD
MOVSTR		763304		P2BLSH		000002	SPD	RDSATS		761120		SIZDSK		000010	SPD
MOVUNI		763265		P3		000016	INT	RDST45		761135		SIZFIL		000015	SPD
MSGLNG		763326		P4		000017	INT	RDSTS1		761122		SIZOND		000007	SIN
MSGSAV		764107		P4CDEF		764332		RDSTS4		761123		SIZSRP		000004	SPD
MSGSTR		763336		PAGCOD		002422'	EXT	RDSTS5		761153		SIZTYP		000007	SPD
MSGUNI		763345		PAGIN		002520'	EXT	RDSTS6		761165		SIZUIP		000002	SPD
NAMFLO		763343		PAGNAM		002421'	EXT	RDTIME	702200	000000		SPACE3		765273	
NASTYP		763237		PAGOUT		002523'	EXT	RDWMSG		763465		SPCDK1		764615	
NLSUNI		763033		PAGSLF		002446'	EXT	RE.DCD		001750'	EXT	SPCDKN		764603	
NMRBPC		004025'	EXT	PAKREF		003443'	EXT	REDBAT		763676		SPCDKP		764670	
NMSTPC		004010'	EXT	PCBPAG		002530'	EXT	REDERR		763515		SPDKHP		764630	
NODATE		765240		PCISTS		002544'	EXT	REDSEC		763377		SPSNAM		763610	
NODIE		000000	EXT	PG		000003	INT	REFLAG		000034'	EXT	SPUCLC		764134	
NOERH		763517		PGYERR		002547'	EXT	REFRSH		003505'	EXT	SPUNAM		763611	
NOREF		764012		PGYPNO		002534'	EXT	REFSAV		763657		SRPCMD		761325	
NOSTR		763047		PGYUNI		002540'	EXT	REONCE		761003	INT	SRPHL1		762427	
NOTPRV		762756		PJRST	324740	000000		REPSID		001745'	EXT	SRPHLP		762426	
NTISTR		763054		PR2DIG		765270		RETFIX		764066		SRPNDS		000054'	EXT
NULCHG		762234		PR3DIG		765266		RIBEXT		000000	EXT	SRPREF		000032'	EXT
NULDSK		764627		PR4DIG		765264		RIBLST		000075'	EXT	STDREA		002521'	EXT
NULFIL		761325		PR5DIG		765262		RIBNAM		002420'	EXT	STDWRT		002524'	EXT
NULSRP		762433		PR6DIG		765260		RIBPFS		000070'	EXT	STOUN1		763572	
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88 PAGE 58-3
ONCDSK.MAC	 4-DEC-87 15:51		SYMBOL TABLE

STOUNI		763570		TXTCHG		762337		UNILOG		004053'	EXT	%OFLRS		000004	SIN
STRBTS		000000	EXT	TXTDSK		764660		UNINAM		004047'	EXT	%OND		761000	SIN
STRDDB		003374'	EXT	TXTFIL		762016		UNIONC		002132'	EXT	%STA		751000	SIN
STRFIX		763005	INT	TXTSRP		762535		UNIPPU		003410'	EXT	%STA.P		000146'	EXT
STRHSH		001771'	EXT	TXTTYP		762211		UNISTR		003732'	EXT	%STR		750000	SIN
STRLEN		000000	EXT	TXTUIP		762413		UNISTS		002565'	EXT	%STR.P		000205'	EXT
STRNAM		003724'	EXT	TYPALL		764024		UNISTT		002063'	EXT	
STRNXT		000000	EXT	TYPBAT		765037		UNISYS		003704'	EXT	
STROVR		003745'	EXT	TYPBT1		765066		UNITAL		000162'	EXT	
STRP4C		003747'	EXT	TYPBT2		765075		UNITID		764151		
STRPID		000000	EXT	TYPBT3		765117		UNITST		764142		
STRPPU		003411'	EXT	TYPBT4		765127		UNPCHG		003677'	EXT	
STRREF		003737'	EXT	TYPBT5		765133		UNPHWP		002721'	EXT	
STRSID		000000	EXT	TYPBT6		765204		UNPMSB		002275'	EXT	
STRTAL		000000	EXT	TYPBT9		765212		UNPOFL		002677'	EXT	
STRTCH		764174		TYPCMD		761325		UNPPRV		003347'	EXT	
STRTOV		764210		TYPDAT		765215		UNTLEN		000000	EXT	
STRTPA		762541		TYPDEC		763605		UNTTBL		003433'	EXT	
STRUNI		005133'	EXT	TYPHL1		762045		UNVRSF		000154'	EXT	
STRUNM		003445'	EXT	TYPHLP		762044		UNYBPR		004143'	EXT	
STSDEF		764221		TYPIT		762035		UNYBPT		004200'	EXT	
STSDSL		764342		TYPMSN		763601		UNYBPY		004137'	EXT	
STSFIN		764272		TYPNS1		763770		UNYKTP		003277'	EXT	
STSINS		764246		TYPNS2		763775		UNYLN1		002035'	EXT	
STSNE1		764232		TYPONL		764112	INT	UNYLUN		003753'	EXT	
STSNE2		764235		TYPRPC		765012		UNYPUN		002124'	EXT	
STSNEW		764226		TYPSPC		764775		UNYSPU		003755'	EXT	
STSNXT		764241		TYPSR1		763764		UPDHM1		764730		
STSREF		764472		TYPSRP		762420		UPDHM2		764736		
STSUN2		764252		TYPST1		764020		UPDHM3		764751		
STTFPC		000142'	EXT	TYPSTR		764002		UPDHM4		764770		
STTLEN		002057'	EXT	TYPSYS		763760		UPDHOM		764707		
STTPTR		000144'	EXT	TYPUI0		763117		VALSAV		764111		
SVMOT2		763613		TYPUI1		763143		WCKUNI		762702		
SVMOTE		763614		TYPUID		763120		WHICH		763516		
SVMOUT		763616		TYPUIP		762343		WRPI	700600	000000		
SVOTAC		763660		TYPUN1		763745		WRPUNM		763231		
SVP2		761310		TYPUNI		763744		WRTIME	702600	000000		
SVU		761311		TYPUNS		763765		WRTRN1		763441		
SYSBTS		000364'	EXT	U		000005	INT	WTBOTH		763435	INT	
SYSRIB		002312'	EXT	UFDHSI		003473'	EXT	WTCHEK		763456		
SYSSIZ		000000	EXT	UIPHL1		762356		YESNO		004113'	EXT	
SYSUNI		003700'	EXT	UIPHLP		762355		$XZ		000010	SPD	
T1		000006	INT	UIPSVU		762354		%%ZZQ		763146	SPD	
T2		000007	INT	UNCHKA		762415		%BAT		747000	SIN	
T3		000010	INT	UNICHK		764315		%BAT.P		002366'	EXT	
T4		000011	INT	UNICHN		001676'	EXT	%D	777777	017000'	SPD	
THSDAT		003516'	EXT	UNICHR		004173'	EXT	%HOM		753000	SIN	
TPOPJ		002575'	EXT	UNICK1		764317		%HOM.P		002357'	EXT	
TRYKON		762631		UNIDES		003703'	EXT	%OFLER		000001	SIN	
TSTCHK		763430		UNIERR		000000	EXT	%OFLFM		000002	SIN	
TSTSUP		000363'	EXT	UNIFEP		002302'	EXT	%OFLIG		000005	SIN	
TXTCHG		762337		

ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

AB.ACK	   317%	   573	   574	   580	   581	   583	   584	   662	   718	   764	   824
AB.CVR	   317%	   405
AB.NAK	   317%	   384	   572	   575	   576	   577	   578	   579	   582	   656	   657	   658	   659	   660
	   661	   715	   716	   717	   763	   821	   822	   823	  2598	  2599	  2600	  2601	  2602	  2603
	  2604	  2605
AB.TCV	   317%	   410	   763	   821	   822	   823
AB.VER	   317%	   403	   572	   575	   577	   578	   579	   580	   581	   582	   715	   716	   717	   763
	   821	   822	   823
ADDNOT	  2326	  2385#
ADDUN2	  2333	  2339#
ADDUN4	  2360	  2368#
ADDUN5	  2373#	  2376
ADDUN7	  2374	  2377#
ADDUNI	   520	  2324#
ADUNT	  2352	  2357#
ASKQMM	    18	  1935#	  2108	  2129	  2712	  2728
ASKQUE	   132	  1715#	  1831	  1836
ASKRP1	  1959	  1961	  1983#
ASKRPQ	  1964	  1978#
ASKRPT	  1942#	  1985
BADDIS	   521	   586#
BATBAD	  1818	  1823	  1850#
BATCNT	    32%	  2777	  2857
BATELB	    42%	  2809	  2811
BATFIR	    42%	  1846	  2765	  2793
BATMAN	   116	   436	  1824	  1853#	  2399	  2750
BATNBB	    42%	  2768	  2795	  2851
BATPAT	    32%	  2776
BATREF	  1840#	  2740
BATREG	    42%	  1845
BAYNBB	    42%	  2771	  2798
BRMAX	    38%	  1844
CANTAD	  2330	  2331	  2341	  2367	  2388#
CCOD	    46%
CH7	    67%
CHGBAT	   700	  2735#
CHGCMD	   450#	   670	   675
CHGHL1	   672#	   674
CHGHLP	   671#	   701
CHGHOM	  2620#	  2624
CHGIT	   519	   664#
CHGRPC	   699	  2722#
CHGSPC	   698	  2706#
CHGSTR	  2112#	  2132
CHKANS	  1962#	  1973	  1976
CHKBAT	  1793	  1817#	  2751
CHKFLG	  1457	  1464	  1474	  1476	  1480#
CHKHOM	   948	   958	   962#
CHKUN1	  1190	  1193	  1201#
CHKUNI	  1182#	  1202
CLRDDB	    46%	   262	   864
CLRSND	    39%	  1316	  1552	  1692	  1709
CLRSTR	   869	  2162	  2282	  2299#
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

CMDMSG	   401	   425#
CMDSC1	   363	   373#
CMDSC2	   377#	   380
CMDSC3	   381#	   394
CMDSC4	   385	   389	   391	   393#
CMDSC5	   382	   397#
CMDSCF	    18	   362	   426#	   462	   591	   666	   723	   772	  2552
CMDSCN	    18	   354#	   463	   592	   667	   724	   773	  2553
CMPLOG	    39%	  2191	  2371
CNTADS	  2405	  2411#
CODBAT	    43%	  1389
CODHOM	    43%	  1354
CODRIB	    43%	   283
COMDAS	  2440%	  2440
COMTMS	  2454%	  2454
COMTYO	    38%	   835	  2756	  2760	  2764	  2844
CONCHK	  1461	  1465#
CONMES	    33%	   122	  1145%	  1145	  1245	  1561	  1567	  1696	  1711	  1859	  1863	  1867	  1911	  2081
	  2736	  2746	  2778	  2782	  2801	  2807	  2827	  2831	  2837	  2879	  2884	  2905
CONOUT	   435	  1248	  1711#	  1874	  1981	  2009	  2152	  2159	  2167	  2185	  2328	  2335	  2386	  2390
	  2413	  2561
CORZER	    34%	   967	  1841	  2645
CPOPJ	    36%	   834	  1888	  2004	  2006	  2854
CPOPJ1	    36%	   360	   367	   371	   402	   404	   409	   414	   422	  1254	  1625	  1748	  1754	  2203
CPUF3	   905	  2485	  2520
CPUKI	  1632	  1653	  2485	  2520
CPUKL	  1632	  1653	  2472	  2473	  2518	  2519
CPUKS	  2472	  2478	  2518
CPUTYP	   905	  1632	  1653	  2472	  2473	  2478	  2485	  2518	  2519	  2520
CPYWAT	  1650#	  1651
CPZZ	   905#	   905	  1632#	  1632	  1653#	  1653	  2472#	  2472	  2473#	  2473	  2478#	  2478	  2485#	  2485
	  2518#	  2518	  2519#	  2519	  2520#	  2520
CRESTT	  1071	  1083#
CRLF	    33%	  1712	  2853	  2858
CRLFOP	  1099	  1100	  1128	  1246	  1328	  1568	  1689	  1712#	  1877	  1914	  2025	  2084	  2545	  2786
CTEXT	    33%	   355	  1743	  2089
CTYDO	   407%	   407
CWCOD	    46%	  1645
DATBLK	  2877	  2878	  2886#
DATCOM	  2866	  2887%
DBLSTD	   458	  1942	  1967	  1970	  1980	  1982	  1988#	  2002	  2214	  2218
DC.SIZ	    97
DCFAST	   156%	   156
DCN	    65%	    99	   100	   101	   102	   103	   104	   162	   997	  1008	  2540	  2609
DCN.DF	   104#	   105	   113	   154	  2542
DCN.HM	   103#	   104	   113	  1006
DCN.MN	   102#	   103	   989	   996
DCN.ON	   100#	   101	  2539
DCN.OP	    99#	   100
DCN.UR	   101#	   102	   989	   995
DCNDFT	   112	   113#
DCNTAB	    99#	  2611
DCNUM	    99#	    99	   100	   101	   102	   103	   104
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

DCNYDF	   104#	   105
DCNYHM	   103#	   104	   999	  1004
DCNYMN	   102#	   103
DCNYON	   100#	   101	   160	   161	  2555	  2612
DCNYOP	    99#	   100
DCNYUR	   101#	   102
DCSIZ	    97#	    99	   100	   101	   102	   103	   104
DCXX	    99#	    99	   100	   100#	   101	   101#	   102	   102#	   103	   103#	   104	   104#	   105	   105#
DDBLEN	    43%
DDSTAR	    43%	   261	   863	   866	  1416	  2403
DDTX	   525%	   525
DECIN	    33%	  1957	  2425	  2430	  2434	  2447
DECLOP	    18	  1687#	  1936	  1948	  1954	  2704	  2720
DEVIOS	   861
DIE	    74	    74%	    75
DISST1	  2276#	  2281
DISST2	  2274	  2282#
DSKCPY	   910	  1640#
DSKDDB	    33%	   861
DSKPIF	  1641%	  1641
DSKPIN	  1643%	  1643	  1647%	  1647
DSKPPU	  1034%	  1034
DSPCHG	   669	   698#	   702
DSPDSK	  2580#	  2588
DSPFIL	   465	   517#	   530
DSPSRP	   775	   805#	   809
DSPTYP	   594	   630#	   637
DSPUIP	   727	   754#	   756
ERRHM2	   879	  1211	  1216#	  1325	  1335	  1707
ERRHOM	   878	  1209	  1215#	  1324	  1334	  1708
EVASIZ	    45%	   437
EVMALC	  1088%	  1088
F	   261	   863	  1416	  1764	  1772	  2403
FILCMD	   453#	   460	   466	   471	   728	   735	  1926
FILGO	   528	  2615#
FILHL1	   468#	   470
FILHLP	   467#	   529
FILMAN	    17	   116#	   124
FILOPT	    17	   123	   432#
FIROK	  1418#	  1430
FLGDN1	   917#	   921
FLGDN2	   919	   924#
FLGDN3	   922	   926#
FLGDN4	   927#	   930
FLGDN5	   934#	   937
FLGDWN	   884	   901	   916#
FNDSTR	   365	   982	  1270#	  2149
FNDUN1	  1753#	  1756
FNDUNI	   368	  1746	  1752#
FSTERR	  1557	  1560#
FTYUNI	  1944	  2020#	  2074
GETBAT	    19	  1376#	  1819
GETDAT	  2393	  2415#
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

GETDT1	  2420#	  2424	  2426	  2427	  2431	  2432	  2435	  2436	  2441
GETDT2	  2442#	  2446	  2448	  2449	  2455
GETHOM	    19	   279	   962	  1353#	  2643
GETLIN	    33%	   459	  1249	  1741	  1955	  2087	  2423	  2445	  2549
GETPEV	    41%	  1465	  1504
GETRAN	   356	  2517#
GETSRB	   167	   279#
GETUNI	  1741#	  1750	  2171	  2329	  2738	  2748
HLPCHG	   668	   677#
HLPFIL	   443#	   464	   514	   515
HLPSRP	   774	   783#	   802	   803
HLPTY1	   446#	   588	   606	   680	   742	   788
HLPTYP	   593	   603#
HLPUIP	   725	   737#	   751	   752
HMBOK	   964	   976#
HMBOK2	   982#
HMBOK3	   992	   998#
HOMDAT	    48%	  2686	  2689	  2693
HOMDCT	    65%	   998	  1007
HOMDCV	    65%	  1005
HOMEND	    48%	  2685	  2691	  2692
HOMFEP	    50%	  1289
HOMHID	    49%	  1279	  2650
HOMHSH	    48%	  1009	  2671
HOMLOG	    49%	  1277	  2680
HOMLUN	    49%	  1281	  2682
HOMMFD	    48%	  1301
HOMNXT	    49%	  1039	  2654
HOMOVR	    49%	  1307	  2675
HOMP4C	    49%	  1296	  2677
HOMPRV	    50%	  2666
HOMRAN	    48%	   990	  1019	  2673
HOMREF	    50%	  1309	  2669
HOMSAT	    50%	   281
HOMSNM	    50%	   980	  1076	  1294	  2657
HOMSPU	    50%	  1283	  2684
HOMSUF	    32%	  1298
ICPFAC	    44%
INLMES	    38%	   857%	   857
INSERT	  1063	  1067#
IOSEL	    46%	  1648
J	   881	   882	   883	   885	   887	   900	  1640	  1766	  1770	  2418	  2419	  2456
JFYSEC	    44%
KEPSAM	  1956	  1975#
KNNUNI	  1945	  1948#
KNOUNI	   457	  1993#	  2020	  2024	  2227	  2231
KONCPY	    44%
KONDWN	    44%	   900
KONLTM	    44%
KONTOK	   886	   889	   904#
KONUPA	    44%	   883	   887
KOPDWN	    44%	   899
LI.PIN	   862
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

LINKIT	  1061#	  1066
LINKT1	  1059	  1065#
LISTSN	     3	     6
LIT$0	   545#	   572	   646#	   656	   708#	   715	   760#	   763	   815#	   821	  2598#	  2598
LIT$1	   547#	   573	   647#	   657	   709#	   716	   761#	   764	   816#	   822	  2598#	  2599
LIT$10	   561#	   580
LIT$11	   564#	   581
LIT$12	   567#	   582
LIT$13	   568#	   583
LIT$14	   570#	   584
LIT$2	   549#	   574	   648#	   658	   710#	   717	   817#	   823	  2598#	  2600
LIT$3	   551#	   575	   649#	   659	   711#	   718	   819#	   824	  2598#	  2601
LIT$4	   553#	   576	   650#	   660	  2598#	  2602
LIT$5	   554#	   577	   651#	   661	  2598#	  2603
LIT$6	   556#	   578	   652#	   662	  2598#	  2604
LIT$7	   558#	   579	  2598#	  2605
LNGMES	    18	   416	   469	   598	   673	   733	   779	   832#	  2617
LNGMS1	   833#	   837	   841
LP2BAT	    45%	  1390
LP2HOM	    45%	  1355
LPNBAT	    45%	  1390
LPNHOM	    45%	  1355
LSTRED	  1165	  1180#
LSTUNI	  1042	  1051#
MANCM1	   122#	   128
MANCOM	   123#	   133
MANOK	   118	   134#
MANOK1	   146	   149#
MANOK2	   155	   161#
MANQST	   119	   130#
MANREF	   126#	   136
MAX	    18	  1940	  1953	  1962	  1972	  1991#	  2104	  2126	  2709	  2725
MAYREF	  2001#	  2105
MCKKON	   895	  1235#
MFDRIB	    36%	  1303
MIN	    18	  1939	  1950	  1963	  1992#	  2102	  2124	  2707	  2723
MISUNI	  1185	  1192#	  1199
MONTAB	  2876	  2888#
MOVSTR	   987	  1294#
MOVUNI	   971	   978	  1277#
MSGLNG	  1189	  1198	  1313#
MSGSAV	  1937	  1946	  1983	  1987#
MSGSTR	  1046	  1168	  1322#
MSGUNI	  1018	  1029	  1037	  1331#
NAMFLO	  1077	  1327#	  1337
NASTYP	  1224	  1238#
NLSUNI	  1040	  1058#
NMRBPC	    36%	  2718	  2727	  2730
NMSTPC	    38%	  2702	  2711	  2714
NODATE	  2863	  2883#
NODIE	    74%
NOERH	   287	  1432	  1547	  1578#	  2642
NOREF	  1909	  1912#
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

NOSTR	   985	  1073#
NOTPRV	   983	  1000#
NTISTR	   972	   981	  1031	  1082#
NULCHG	   676#	   697
NULDSK	  2556#	  2579
NULFIL	   452#	   516
NULSRP	   782#	   804
NULTYP	   602#	   629
NULUIP	   736#	   753
OCONM	    33%	   446	   455	  1075	  1241	  1323	  1333	  2421	  2443	  2537	  2547
OCTIN	    33%	  1251
OFLTAB	  1144	  1149#
OHTINI	    40%	  1610
OHTNUM	    40%	  1624
OLDST0	  1012	  1015#
OLDST1	  1010	  1017#
OLDST2	  1011#
OLDST4	  1014	  1016	  1019#
OLDST5	  1020	  1028#
OLDST6	  1021#
OLDST8	  1003	  1024	  1026	  1030#
OLDSTR	  1003#
ONCDDB	    43%	   865
ONCDSK	    74	    75#	    78	    81
ONCMOD	    68	    70#
ONDEND	  3489#
ONDLIT	  2908#
ONDLNP	    17	  3483#	  3485
ONDLNR	    17	  3482#	  3483
ONDSTT	    17	    72#	    81
OPAGIN	    18	   214	  1459	  1596#
OPAGIO	  1598	  1604#
OPAGOT	    18	   230	  1521	  1601#
OPOUT	    33%	   447	   456	   839	  1143	  1146	  1318	  1694	  1713	  1860	  1868	  1876	  1915	  2422
	  2444	  2548	  2737	  2747
OVRDEF	  2213	  2238#
P	    75	   117	   122	   123	   132	   134	   150	   153	   167	   214	   224	   230	   262	   263
	   279	   280	   282	   354	   355	   356	   358	   365	   368	   396	   416	   420	   435	   438
	   441	   446	   447	   455	   456	   459	   463	   469	   517	   520	   522	   523	   524	   525
	   526	   592	   598	   630	   631	   632	   633	   634	   667	   673	   698	   699	   700	   724
	   733	   754	   767	   773	   779	   805	   806	   826	   827	   835	   838	   839	   840	   857
	   864	   867	   869	   887	   895	   910	   952	   962	   967	   970	   971	   977	   978	   982
	   987	  1000	  1018	  1029	  1037	  1043	  1046	  1047	  1075	  1077	  1083	  1088	  1096	  1099
	  1100	  1128	  1131	  1133	  1134	  1138	  1142	  1145	  1168	  1189	  1198	  1208	  1210	  1212
	  1213	  1239	  1240	  1241	  1243	  1244	  1245	  1246	  1247	  1248	  1249	  1250	  1251	  1252
	  1253	  1273	  1274	  1291	  1311	  1314	  1316	  1317	  1318	  1319	  1323	  1327	  1332	  1333
	  1336	  1376	  1392	  1420	  1427	  1431	  1433	  1459	  1463	  1465	  1473	  1477	  1478	  1504
	  1514	  1518	  1519	  1521	  1523	  1526	  1527	  1548	  1550	  1551	  1552	  1554	  1561	  1565
	  1566	  1567	  1568	  1569	  1570	  1604	  1610	  1616	  1617	  1618	  1623	  1626	  1644	  1648
	  1672	  1678	  1679	  1688	  1692	  1693	  1696	  1709	  1711	  1712	  1727	  1734	  1738	  1741
	  1742	  1743	  1746	  1749	  1757	  1762	  1763	  1764	  1765	  1766	  1767	  1769	  1770	  1771
	  1772	  1773	  1774	  1775	  1793	  1797	  1819	  1825	  1831	  1832	  1836	  1837	  1841	  1842
	  1859	  1861	  1863	  1865	  1867	  1874	  1875	  1891	  1896	  1905	  1911	  1912	  1915	  1917
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

	  1920	  1923	  1924	  1925	  1944	  1948	  1951	  1954	  1955	  1957	  1966	  1968	  1981	  2003	  2021
	  2022	  2023	  2044	  2061	  2063	  2066	  2074	  2081	  2083	  2084	  2086	  2087	  2089	  2094
	  2105	  2108	  2109	  2112	  2129	  2130	  2149	  2162	  2167	  2171	  2175	  2191	  2192	  2201
	  2212	  2215	  2216	  2219	  2220	  2221	  2222	  2223	  2270	  2271	  2279	  2282	  2283	  2284
	  2285	  2299	  2300	  2305	  2307	  2308	  2328	  2329	  2343	  2361	  2362	  2363	  2366	  2371
	  2377	  2379	  2380	  2381	  2382	  2383	  2393	  2398	  2400	  2404	  2406	  2409	  2416	  2418
	  2421	  2422	  2423	  2425	  2430	  2434	  2440	  2443	  2444	  2445	  2447	  2454	  2456	  2457
	  2482	  2517	  2531	  2532	  2537	  2538	  2544	  2545	  2547	  2548	  2549	  2550	  2553	  2556
	  2561	  2613	  2617	  2621	  2625	  2643	  2645	  2697	  2699	  2712	  2713	  2715	  2728	  2729
	  2731	  2736	  2737	  2738	  2739	  2740	  2741	  2742	  2746	  2747	  2748	  2749	  2751	  2754
	  2756	  2758	  2760	  2762	  2764	  2778	  2780	  2782	  2784	  2786	  2789	  2790	  2801	  2805
	  2807	  2810	  2823	  2824	  2825	  2827	  2828	  2829	  2831	  2832	  2833	  2837	  2838	  2839
	  2840	  2844	  2849	  2850	  2852	  2853	  2858	  2859	  2866	  2867	  2870	  2872	  2874	  2875
	  2879	  2880	  2881	  2893	  2895	  2897	  2899	  2901
P1	   373	   374	   397	   398	   461	   467	   590	   596	   665	   671	   722	   731	   771	   777
	   888	   892	  1182	  1183	  1184	  1192	  1194	  1221	  1242	  1505	  1512	  1697	  1838	  1857
	  1858	  1882	  1916	  1938	  1947	  1950	  1953	  1984	  2078	  2082	  2106	  2128	  2170	  2197
	  2198	  2199	  2210	  2211	  2212	  2213	  2220	  2551	  2702	  2711	  2718	  2727	  2767	  2772
	  2776	  2779
P2	   179	   193	   195	   197	   284	   373	   383	   393	   398	   399	   400	   403	   405	   410
	   415	   720	   721	   726	   968	   979	   984	  1003	  1011	  1013	  1031	  1041	  1052	  1053
	  1058	  1068	  1161	  1162	  1164	  1169	  1176	  1180	  1270	  1272	  1295	  1297	  1305	  1306
	  1308	  1310	  1326	  1353	  1388	  1466	  1467	  1468	  1562	  1563	  1677	  1703	  1761	  1843
	  1903	  1904	  1908	  1913	  2004	  2005	  2106	  2110	  2111	  2125	  2128	  2131	  2154	  2163
	  2164	  2169	  2172	  2188	  2189	  2195	  2196	  2200	  2206	  2272	  2273	  2324	  2325	  2340
	  2344	  2359	  2361	  2363	  2368	  2370	  2372	  2411	  2428	  2429	  2433	  2439	  2647	  2648
	  2655	  2656	  2658	  2659	  2668	  2674	  2676	  2696	  2793	  2794	  2795	  2797	  2809	  2811
	  2851	  2854	  2855
P2BLSH	  2812
P3	   156	   160	   180	   196	   209	   210	   225	   227	   232	   283	   359	   366	   370	   374
	   381	   386	   392	   394	   395	   397	   399	   421	   465	   467	   468	   470	   594	   596
	   597	   599	   669	   671	   672	   674	   727	   731	   732	   734	   775	   777	   778	   780
	   969	  1084	  1085	  1086	  1087	  1093	  1354	  1389	  1469	  1847	  2169	  2172	  2187	  2202
	  2555	  2695	  2767	  2770	  2777	  2783	  2787
P4	   174	   183	   184	   194	   201	   375	   390	   392	   395	  1181	  1183	  1184	  1192	  1355
	  1390	  1419	  1426	  1510	  1513	  1516	  1762	  1774	  1790	  1791	  1886	  1902	  2364	  2365
	  2618	  2620	  2622	  2865
P4CDEF	  2217	  2248#
PAGCOD	    42%	   969	  1469	  1847	  2695
PAGIN	    40%	  1596
PAGNAM	    42%	   968	  1468	  1843	  2647
PAGOUT	    40%	  1601
PAGSLF	    42%	  1512
PAKREF	    41%	  2366
PCBPAG	    41%	  1607
PCISTS	    40%	  1606	  1619
PG	   213	   229	   285	  1356	  1391	  1550	  1569	  1604	  1605	  1607	  1623
PGYERR	    40%	  1609	  1622
PGYPNO	    40%	  1611
PGYUNI	    40%	  1615
PR2DIG	  2805	  2849	  2874	  2881	  2900#
PR3DIG	  2833	  2839	  2898#
PR4DIG	  2829	  2896#
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

PR5DIG	  2894#
PR6DIG	  2780	  2892#
PRCOL	  1134%	  1134
PRNAME	    39%	  1133%	  1133	  1243	  1327	  1554	  1565	  1705	  1865	  2083	  2544	  2754	  2758	  2762
PRNAMF	  1138%	  1138	  1142%	  1142
PRSPC	  1131%	  1131	  2893	  2895	  2897	  2899	  2901%	  2901
PRT22A	    32%	  2810
PRTDIG	  2784	  2902%	  2902
QSTSTD	  1943	  1970#
RADX10	    39%	  1698
RANHOM	   144	   148	   870	  1021	  1023	  1218#	  2396	  2397	  2672
RANNO	  2515%	  2530
RBINDX	    52%	   186
RBLVPR	    53%
RBLVSP	    53%
RBMASK	    52%	   192
RBREAL	    52%	   187	   192	  1299	  1302	  1508
RBSPAR	    52%	   186
RBYPNO	    53%	   212	   228	  1511
RBYUN1	    53%	   189
RBYUN4	    53%
RBYUNI	    53%	  1509
RDBAT1	  1791#	  1796
RDBAT6	  1792	  1795#
RDBNON	  1428	  1432#
RDBOTH	  1357	  1377	  1416#
RDBSKP	  1422	  1431#
RDCHEK	   288	  1420	  1427	  1457#
RDHOM1	   874#	   876
RDHOM2	   872	   877#
RDHOME	   117	   438	   857#	  2400	  2406
RDRBS2	   178#	   200
RDRBS3	   183#	   196
RDSATS	   203	   207#
RDST45	   216	   220#
RDSTS1	   209#	   248
RDSTS4	   210#	   233
RDSTS5	   211	   236#
RDSTS6	   244	   247#
RDWMSG	  1463	  1473	  1526	  1547#
RE.DCD	    65%	   994
REDBAT	   134	   441	  1789#
REDERR	  1417	  1475	  1502	  1517	  1558	  1560	  1572#	  1821
REDSEC	  1421	  1425#
REFLAG	   139%	   139
REFRSH	    46%	  2404
REFSAV	  1313	  1322	  1331	  1761#
REONCE	    98	    98#	   988
REPSID	    65%	   991
RETFIX	  1941	  1965#
RIBEXT	    52%	   169
RIBLST	    52%	   183
RIBNAM	    52%	  1467
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

RIBPFS	    52%	   174
RWRHOM	  2398	  2618#
S$ENTR	    74	    80	   168	   185	   188	   191	   202	   231	   868	  1078	  2698
S$HALT	    74	   168	   185	   188	   191	   202	   231	   868	  1078	  2698
S$NAME	    78#	   168	   185	   188	   191	   202	   231	   868	  1078	  2698
S$NONA	    77	    80	   168	   185	   188	   191	   202	   231	   868	  1078	  2698
S$TEMP	    74#	    74	   168#	   168	   185#	   185	   188#	   188	   191#	   191	   202#	   202	   231#	   231
	   868#	   868	  1078#	  1078	  2698#	  2698
S$XCT	    80	   168	   185	   188	   191	   202	   231	   868	  1078	  2698
SATCNT	    35%	   224
SAVE4	    46%	  2417
SCNBAT	    34%
SCNCHG	   665	   703	   704#
SCNDSK	  2541	  2551	  2589	  2590#
SCNFIL	   461	   531	   532#
SCNSD2	  1203	  1209#
SCNSRP	   771	   810	   811#
SCNST2	  1171#	  1173
SCNSTD	  1163	  1206#
SCNSTR	  1111	  1161#
SCNTYP	   590	   638	   639#
SCNUIP	   722	   757	   758#
SCNUN1	   942	  1096#
SCNUNI	   881#	  1098
SETBAT	  1376	  1388#	  1842
SETCHG	   970	   977	  1723#	  2065	  2093	  2112	  2201	  2279	  2379	  2382
SETDDO	    46%	   867
SETPRV	  1736#
SETPUB	  1000	  1732#	  2192	  2380
SETRAN	   354	  2471#
SETUNT	  1111#	  1117	  1122
SETUTS	  1113	  1119#
SIZCHG	   702#	   702	   703
SIZDSK	  2588#	  2588	  2589
SIZFIL	   530#	   530	   531
SIZOND	  3485
SIZSRP	   809#	   809	   810
SIZTYP	   637#	   637	   638
SIZUIP	   756#	   756	   757
SPACE3	  2850	  2904#
SPCDK1	  2546#	  2562
SPCDKN	   517	  2535#
SPCDKP	   153	  2538	  2609#
SPDKHP	  2554	  2558#	  2577	  2578
SPSNAM	  1703#	  1875	  1912
SPUCLC	  1083	  2039#	  2063
SPUNAM	  1704#	  1861	  2022
SRPCMD	   451#	   776	   781	   828
SRPHL1	   778#	   780
SRPHLP	   777#	   808
SRPNDS	    55%	   158
SRPREF	   137%	   137
STDREA	    40%	  1597	  1620
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

STDWRT	    41%	  1602	  1620
STOUN1	  1679#	  1681
STOUNI	  1677#	  2113	  2222	  2224
STRBTS	    57%	   138	   157	  2300	  2306
STRDDB	    55%	   135	   138	   143	   149	   157	   166	   175	   207	   208	   245	  1161	  1270	  1903
	  2272	  2300	  2301	  2302	  2303	  2304	  2306	  2324	  2395	  2670
STRFIX	  1022	  1025#
STRHSH	    56%	  1011	  1013	  2395	  2670
STRLEN	    55%	  2304
STRNAM	    56%	   984	  1162	  1272	  1295	  1326	  1703	  1904	  2154	  2163	  2325	  2656
STRNXT	    56%
STROVR	    57%	  1308	  2128	  2131	  2674
STRP4C	    56%	  1297	  2106	  2110	  2676
STRPID	    57%	    65%	   149
STRPPU	    57%	  1305	  1306	  2125	  2195	  2196	  2340
STRREF	    56%	   135	  1310	  1761	  1908	  2005	  2111	  2164	  2359	  2411	  2668
STRSID	    57%
STRTAL	    57%	   207	   245
STRTCH	   806	   827	  2102#	  2219
STRTOV	   805	   826	  2124#	  2215
STRTPA	   807	   826#
STRUNI	    56%	   143	   166	   175	   208	  1058	  1169	  1180	  1677	  1913	  2169	  2172	  2206	  2273
	  2372	  2659
STRUNM	    56%	  1041	  1052	  1053	  1164	  1176	  2189	  2200	  2344	  2368
STSDEF	   523	  2148#
STSDSL	   522	  2270#
STSFIN	  2173	  2206#
STSINS	  2175	  2180#
STSNE1	  2155	  2162#
STSNE2	  2166#	  2174
STSNEW	  2151	  2154#
STSNXT	  2171#	  2176	  2177
STSREF	   524	  2393#
STSUN2	  2181	  2187#
STTFPC	    34%	   225
STTLEN	    35%	   195	   232	  1085
STTPTR	    34%	   193	   197	   210	   227
SVMOT2	  1208	  1707#
SVMOTE	  1708#
SVMOUT	  1710#	  1749
SVOTAC	  1125	  1238	  1549	  1687	  1691	  1710	  1715	  1762#	  1817	  2641
SVP2	   428#
SVU	   364	   372	   429#
SYSBTS	   527%	   527
SYSRIB	  1300%	  1300
SYSSIZ	    45%
SYSUNI	    45%	   257	   871	   877	   916	  1109	  1752	  1789	  1885	  2619
T1	   120	   126	   130	   135	   136	   137	   138	   144	   145	   147	   148	   149	   157	   158
	   161	   162	   169	   171	   172	   173	   184	   186	   187	   192	   193	   218	   219	   221
	   222	   223	   236	   237	   239	   240	   241	   242	   245	   256	   258	   361	   377	   378
	   387	   415	   417	   432	   443	   453	   468	   586	   597	   603	   672	   677	   732	   737
	   740	   778	   783	   786	   832	   833	   838	   840	   865	   866	   880	   881	   885	   899
	   900	   917	   918	   924	   925	   928	   929	   931	   932	   935	   936	   938	   939	   940
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

	   941	   945	   946	   956	   957	   966	   980	   981	   990	   991	   993	   995	   996	   997	   998
	   999	  1004	  1005	  1007	  1009	  1010	  1013	  1015	  1017	  1019	  1020	  1023	  1025	  1028
	  1032	  1041	  1042	  1044	  1064	  1065	  1066	  1067	  1073	  1089	  1090	  1091	  1092	  1093
	  1094	  1105	  1106	  1107	  1110	  1114	  1115	  1117	  1135	  1144	  1164	  1165	  1166	  1171
	  1172	  1173	  1174	  1175	  1176	  1188	  1197	  1206	  1222	  1235	  1244	  1247	  1271	  1272
	  1277	  1278	  1279	  1280	  1281	  1282	  1283	  1284	  1287	  1289	  1290	  1294	  1295	  1296
	  1297	  1298	  1299	  1300	  1301	  1302	  1303	  1304	  1305	  1306	  1307	  1308	  1309	  1310
	  1314	  1315	  1319	  1462	  1472	  1507	  1509	  1524	  1551	  1555	  1559	  1566	  1597	  1602
	  1606	  1608	  1609	  1612	  1613	  1614	  1615	  1645	  1646	  1649	  1651	  1678	  1697	  1723
	  1726	  1745	  1747	  1821	  1823	  1826	  1833	  1840	  1844	  1845	  1846	  1858	  1862	  1866
	  1872	  1910	  1937	  1946	  1949	  1952	  1978	  1983	  2005	  2006	  2007	  2076	  2079	  2103
	  2104	  2107	  2112	  2125	  2126	  2127	  2148	  2150	  2156	  2163	  2166	  2180	  2181	  2182
	  2189	  2190	  2194	  2195	  2196	  2198	  2213	  2214	  2216	  2217	  2218	  2221	  2223	  2271
	  2275	  2278	  2283	  2299	  2302	  2303	  2304	  2305	  2306	  2307	  2327	  2332	  2333	  2334
	  2339	  2340	  2344	  2346	  2348	  2349	  2350	  2351	  2353	  2356	  2357	  2358	  2359	  2360
	  2368	  2369	  2372	  2373	  2375	  2377	  2378	  2385	  2389	  2394	  2395	  2412	  2420	  2442
	  2450	  2451	  2452	  2453	  2479	  2480	  2518	  2535	  2539	  2540	  2546	  2558	  2615	  2644
	  2649	  2650	  2651	  2652	  2653	  2654	  2655	  2656	  2657	  2660	  2661	  2662	  2663	  2666
	  2668	  2669	  2670	  2671	  2672	  2673	  2674	  2675	  2676	  2677	  2679	  2680	  2681	  2682
	  2683	  2684	  2685	  2686	  2688	  2689	  2691	  2692	  2693	  2703	  2706	  2707	  2708	  2709
	  2710	  2719	  2722	  2723	  2724	  2725	  2726	  2735	  2745	  2771	  2772	  2775	  2779	  2781
	  2783	  2785	  2788	  2798	  2799	  2800	  2804	  2806	  2809	  2811	  2812	  2814	  2825	  2826
	  2828	  2830	  2832	  2834	  2836	  2838	  2840	  2845	  2847	  2848	  2864	  2873	  2875	  2876
	  2877	  2878	  2880	  2883	  2892	  2894	  2896	  2898	  2900	  2904
T2	   170	   171	   172	   210	   227	   238	   239	   357	   361	   381	   388	   897	   916	   917
	   920	   921	   925	   926	   927	   928	   932	   933	   934	   935	   939	   954	   988	   989
	   994	  1006	  1008	  1011	  1012	  1015	  1021	  1025	  1034	  1035	  1036	  1038	  1043	  1047
	  1051	  1052	  1062	  1076	  1087	  1091	  1092	  1094	  1119	  1120	  1125	  1126	  1127	  1129
	  1130	  1132	  1137	  1139	  1140	  1141	  1238	  1242	  1285	  1286	  1288	  1313	  1322	  1326
	  1331	  1336	  1467	  1468	  1469	  1505	  1508	  1512	  1549	  1553	  1562	  1564	  1605	  1607
	  1616	  1618	  1687	  1691	  1703	  1704	  1710	  1715	  1745	  1753	  1767	  1817	  1829	  1830
	  1864	  1908	  1909	  1939	  1940	  1962	  1963	  1965	  1970	  1971	  1972	  1975	  2039	  2040
	  2041	  2042	  2043	  2064	  2082	  2088	  2090	  2091	  2092	  2110	  2131	  2270	  2284	  2345
	  2347	  2348	  2351	  2354	  2355	  2373	  2374	  2375	  2428	  2433	  2437	  2438	  2439	  2450
	  2453	  2479	  2517	  2528	  2529	  2530	  2531	  2541	  2543	  2609	  2610	  2611	  2612	  2641
	  2659	  2660	  2662	  2664	  2714	  2730	  2753	  2757	  2761	  2765	  2766	  2768	  2773	  2774
	  2797	  2813	  2814	  2816	  2821	  2824	  2846	  2847	  2848	  2851	  2863	  2868	  2869	  2870
T3	   154	   189	   190	   357	   376	   377	   378	   379	   380	   383	   384	   386	   387	   388
	   833	   834	   836	   873	   874	   893	   949	   976	  1061	  1062	  1186	  1195	  1239	  1315
	  1422	  1428	  1430	  1460	  1470	  1475	  1517	  1525	  1553	  1596	  1601	  1617	  1619	  1620
	  1622	  1625	  1732	  1733	  1736	  1737	  1763	  1773	  1838	  1960	  2062	  2064	  2276	  2277
	  2280	  2542	  2611	  2755	  2759	  2763	  2815	  2816	  2820	  2822	  2823	  2843	  2871	  2872
T4	   178	   190	   212	   225	   226	   228	   281	   911	   947	  1058	  1064	  1065	  1069	  1219
	  1237	  1240	  1419	  1426	  1510	  1511	  1611	  1724	  1725	  2417	  2817	  2818	  2819	  2820
	  2873
THSDAT	   170%	   170	   173%	   173	  2415%	  2415
TPOPJ	    39%	  1682
TRYKON	   887#	   896	   898	   953	   955
TSTCHK	  1471	  1475#
TSTSUP	   526%	   526
TXTCHG	   702	   715#
TXTDSK	  2588	  2598#
TXTFIL	   530	   572#
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

TXTSRP	   809	   821#
TXTTYP	   637	   656#
TXTUIP	   756	   763#
TYPALL	   635	  1923#
TYPBAT	   632	  2745#
TYPBT1	  2768#	  2774
TYPBT2	  2769	  2773	  2775#
TYPBT3	  2795#	  2855
TYPBT4	  2799	  2804#
TYPBT5	  2802	  2809#
TYPBT6	  2842	  2850#
TYPBT9	  2787	  2796	  2857#
TYPCMD	   449#	   595	   600
TYPDAT	  2852	  2863#
TYPDEC	  1317	  1688	  1693	  1696#	  1951
TYPHL1	   597#	   599
TYPHLP	   596#	   636
TYPIT	   518	   589#
TYPMSN	  1691#
TYPNS1	  1887#	  1890
TYPNS2	  1893#	  1897
TYPONL	    17	   412	   589	   664	   739	   785	  1935	  1990#	  2001	  2060	  2085	  2209	  2232	  2342
TYPRPC	   634	  2718#
TYPSPC	   633	  2702#
TYPSR1	  1877#	  1894	  1919
TYPSRP	   628	   696	   771#
TYPST1	  1918#	  1921
TYPSTR	   630	  1902#	  1923
TYPSYS	  1872#	  1925
TYPUI0	   860	  1124#	  1126
TYPUI1	  1136	  1144#
TYPUID	  1096	  1125#
TYPUIP	   627	   695	   720#
TYPUN1	  1858#	  1891	  1917
TYPUNI	  1857#	  1896	  1920
TYPUNS	   631	  1882#	  1924
U	   143	   151	   152	   166	   175	   179	   199	   200	   208	   209	   226	   236	   241	   243
	   247	   248	   257	   258	   259	   260	   364	   372	   720	   766	   871	   872	   874	   875
	   876	   877	   882	   888	   911	   918	   926	   929	   933	   936	   941	   946	   957	  1035
	  1036	  1067	  1068	  1069	  1082	  1089	  1097	  1098	  1109	  1111	  1112	  1114	  1116	  1120
	  1121	  1132	  1135	  1137	  1139	  1169	  1171	  1172	  1180	  1201	  1202	  1221	  1278	  1280
	  1286	  1288	  1290	  1304	  1332	  1460	  1470	  1525	  1613	  1614	  1640	  1642	  1646	  1650
	  1677	  1680	  1681	  1704	  1725	  1726	  1733	  1737	  1744	  1752	  1753	  1755	  1756	  1765
	  1771	  1789	  1791	  1795	  1796	  1830	  1860	  1864	  1885	  1887	  1888	  1889	  1893	  1894
	  1895	  1913	  1914	  1918	  1919	  2039	  2078	  2088	  2091	  2092	  2180	  2187	  2188	  2194
	  2199	  2202	  2206	  2207	  2208	  2210	  2273	  2274	  2276	  2277	  2280	  2281	  2331	  2332
	  2339	  2353	  2355	  2356	  2358	  2365	  2370	  2378	  2381	  2388	  2619	  2620	  2622	  2623
	  2624	  2648	  2649	  2651	  2664	  2679	  2753	  2757	  2761	  2835	  2841
UFDHSI	    35%	  2394
UIPHL1	   732#	   734
UIPHLP	   731#	   755
UIPSVU	   721	   726	   729#
UNCHKA	   766#	  2228	  2343
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

UNICHK	  2223	  2227#
UNICHN	    63%	   934	   935	   938	   939
UNICHR	    32%	  2835	  2841
UNICK1	  2221	  2231#
UNIDES	    59%	   258	   874	   941	   946	   957	  1286	  1288	  1725	  1726	  1733	  1737	  1791	  1830
	  2278	  2365	  2620	  2622
UNIERR	    59%
UNIFEP	    59%	  1290
UNIHID	    59%	   766	  1137	  1280	  1864	  2078	  2088	  2091	  2092	  2649	  2653	  2663	  2761
UNIKON	    63%	   882	   927	   928	   931	   932	  1640
UNILOG	    63%	  1082	  1112	  1139	  1278	  1889	  1895	  2276	  2679	  2757
UNINAM	    60%	   888	  1132	  1221	  1332	  1460	  1470	  1525	  1704	  1753	  2753
UNIONC	    62%	   911	  1135
UNIPPU	    59%	   236	  1035	  1036	  1304	  2039	  2194	  2198	  2339
UNISTR	    60%	   151	   199	   247	   720	  1064	  1067	  1068	  1172	  1201	  1680	  1918	  2180	  2188
	  2202	  2207	  2277	  2332	  2370	  2373	  2378	  2388	  2648	  2651	  2662
UNISTS	    63%	  1642	  1646	  1650
UNISTT	    60%	   179	   209	  1089
UNISYS	    59%	   259	   875	   916	   917	   920	   924	   925	  1097	  1116	  1121	  1755	  1795	  1887
	  1893	  2623
UNITAL	    61%	   226	   241	   243
UNITID	   754	   767	  2074#	  2090
UNITST	   768	  2060#	  2233
UNPCHG	    61%	   256	  1723	  2364	  2618
UNPHWP	    61%	   945	   956	  1724	  1829
UNPMSB	    61%	  1285
UNPOFL	    61%	   940	  1724	  1790
UNPPRV	    63%	   873	  1732	  1736	  2275
UNTLEN	    34%	  1107	  1110
UNTTBL	    34%	  1104	  1105	  1106	  1107	  1114	  1120	  1613	  1614	  2347	  2349	  2353	  2355	  2356
	  2358
UNVRSF	    61%	   237
UNYBPR	    32%	  2817
UNYBPT	    32%	  2815	  2846
UNYBPY	    32%	  2813
UNYKTP	  2211%	  2211
UNYLN1	    62%	  1061
UNYLUN	    62%	   178	  1038	  1115	  1119	  1174	  1182	  1282	  1507	  1612	  2190	  2345	  2346	  2354
	  2357	  2681
UNYPUN	  1129%	  1129
UNYSPU	    62%	   180	   238	  1084	  1284	  2043	  2062	  2683
UPDHM1	  2660#	  2665
UPDHM2	  2661	  2666#
UPDHM3	  2658	  2679#
UPDHM4	  2687	  2690	  2695#
UPDHOM	   150	  2362	  2621	  2641#
VALSAV	  1938	  1947	  1965	  1975	  1984	  1989#
WCKUNI	   912	   945#
WHICH	   286	  1418	  1425	  1503	  1515	  1556	  1575#
WRPUNM	   952	  1219#
WRTRN1	  1507#	  1516
WTBOTH	    19	  1502#	  1822	  1848	  2697
WTCHEK	  1514	  1521#
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

YESNO	    46%	   420	  1716	  2789
$XZ	   545#	   545	   547	   547#	   549	   549#	   551	   551#	   553	   553#	   554	   554#	   556	   556#
	   558	   558#	   561	   561#	   564	   564#	   567	   567#	   568	   568#	   570	   570#	   572	   572#
	   573	   573#	   574	   574#	   575	   575#	   576	   576#	   577	   577#	   578	   578#	   579	   579#
	   580	   580#	   581	   581#	   582	   582#	   583	   583#	   584	   584#	   585	   585#	   646#	   646
	   647	   647#	   648	   648#	   649	   649#	   650	   650#	   651	   651#	   652	   652#	   656	   656#
	   657	   657#	   658	   658#	   659	   659#	   660	   660#	   661	   661#	   662	   662#	   663	   663#
	   708#	   708	   709	   709#	   710	   710#	   711	   711#	   715	   715#	   716	   716#	   717	   717#
	   718	   718#	   719	   719#	   760#	   760	   761	   761#	   763	   763#	   764	   764#	   765	   765#
	   815#	   815	   816	   816#	   817	   817#	   819	   819#	   821	   821#	   822	   822#	   823	   823#
	   824	   824#	   825	   825#	  2598#	  2598	  2599	  2599#	  2600	  2600#	  2601	  2601#	  2602	  2602#
	  2603	  2603#	  2604	  2604#	  2605	  2605#	  2606	  2606#
%%ZZQ	  1148#	  1156
%BAT	  1840	  1843	  1846	  1847	  2765	  2766	  2776	  2777	  2793	  2794	  2857
%BAT.P	    37%	  1391
%D	    81#
%HOM	   281	   966	   968	   969	   980	   990	   998	  1007	  1009	  1019	  1039	  1076	  1277	  1279
	  1281	  1283	  1289	  1294	  1296	  1298	  1301	  1307	  1309	  2644	  2647	  2650	  2654	  2657
	  2666	  2669	  2671	  2673	  2675	  2677	  2680	  2682	  2684	  2685	  2686	  2689	  2691	  2692
	  2693	  2695
%HOM.P	    37%	  1356
%OFLER	  1151#
%OFLFM	  1152#
%OFLIG	  1155#
%OFLMT	  1153#
%OFLRS	  1154#
%OND	    72	  3482
%STA	   217	   218	   219	   220	   221	   222	   223
%STA.P	    37%	   213	   229
%STR	   169	   184	   201
%STR.P	    37%	   285
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:22 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Macro/Opdef cross reference

DCNDEF	    85#	    98
DSKOFF	  1629#	  1641
DSKON	  1630#	  1643	  1647
IFCPU	   905	  1632	  1653	  2472	  2473	  2478	  2485	  2518	  2519	  2520
MKCHG	   682#	   698	   704	   708	   715
MKDSK	  2566#	  2580	  2590	  2598
MKFIL	   473#	   517	   532	   545	   572
MKSRP	   790#	   805	   811	   815	   821
MKTYP	   608#	   630	   639	   646	   656
MKUIP	   744#	   754	   758	   760	   763
ONSZCK	  3485
PFALL	   203	   958
PJRST	   288	   768	  1143	  1146	  1224	  1328	  1337	  1357	  1377	  1689	  1694	  1698	  1705	  1713
	  1716	  1822	  1848	  1868	  1876	  1877	  2009	  2025	  2065	  2093	  2113	  2132	  2152	  2159
	  2185	  2224	  2228	  2233	  2413	  2704	  2720	  2881	  2884	  2905
PRINTF	    10#	  1102	  2193
RDTIME	  2518
SCAN	   291#	   461	   590	   665	   771
SCNTB	   318#	   514	   627	   695	   751	   802	  2577
STOPCD	    73	   168	   185	   188	   191	   202	   231	   868	  1078	  2698
WRPI	   862	  1641	  1643	  1647
WRTIME	  2480
X	   514#	   517	   518	   519	   520	   521	   522	   523	   524	   525	   526	   527	   528	   529
	   532#	   532	   533	   534	   535	   536	   537	   538	   539	   540	   541	   542	   543	   544
	   545#	   545	   547	   549	   551	   553	   554	   556	   558	   561	   564	   567	   568	   570
	   572#	   572	   573	   574	   575	   576	   577	   578	   579	   580	   581	   582	   583	   584
	   627#	   630	   631	   632	   633	   634	   635	   636	   639#	   639	   640	   641	   642	   643
	   644	   645	   646#	   646	   647	   648	   649	   650	   651	   652	   656#	   656	   657	   658
	   659	   660	   661	   662	   695#	   698	   699	   700	   701	   704#	   704	   705	   706	   707
	   708#	   708	   709	   710	   711	   715#	   715	   716	   717	   718	   751#	   754	   755	   758#
	   758	   759	   760#	   760	   761	   763#	   763	   764	   802#	   805	   806	   807	   808	   811#
	   811	   812	   813	   814	   815#	   815	   816	   817	   819	   821#	   821	   822	   823	   824
	  2577#	  2580	  2581	  2582	  2583	  2584	  2585	  2586	  2587	  2590#	  2590	  2591	  2592	  2593
	  2594	  2595	  2596	  2597	  2598#	  2598	  2599	  2600	  2601	  2602	  2603	  2604	  2605	  3485#
XZ$	   545#	   545	   547	   549	   551	   553	   554	   556	   558	   561	   564	   567	   568	   570
	   572#	   572	   573	   574	   575	   576	   577	   578	   579	   580	   581	   582	   583	   584
	   646#	   646	   647	   648	   649	   650	   651	   652	   656#	   656	   657	   658	   659	   660
	   661	   662	   708#	   708	   709	   710	   711	   715#	   715	   716	   717	   718	   760#	   760
	   761	   763#	   763	   764	   815#	   815	   816	   817	   819	   821#	   821	   822	   823	   824
	  2598#	  2598	  2599	  2600	  2601	  2602	  2603	  2604	  2605  #\:/P