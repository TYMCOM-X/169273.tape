PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 1
S.MAC	13-JAN-88 11:55		S.MAC - with system parameter file for P035/D, January 1988

     1				SUBTTL	S.MAC - with system parameter file for P035/D, January 1988
     2
     3				IF2,<IFNDEF LISTSN,<TAPE>>	;Skip to PASS2 in all but COMMON.LST
     4				;THIS MODULE ASSEMBLED WITH KL-10 PARAMETER FILE - KLSYM.MAC
     5
     6					IF2,<IFNDEF LISTSN,<		;LIST KLSYM.MAC IN COMMON ONLY
     7								TAPE>>
     8				TITLE	PCBIO	PCB HANDLERS
     9
    10					STOPCD(,ENTRY,PCBIO)^
    11					ENTRY	PCBIO		;For library searches
    12	000000'	260040	000000*	PCBIO::PUSHJ	P,DIE		;**** Default stopcode for "PCBIO" ****
    13	000001'	604342	515700		SIXBIT	/PCBIO/  	;Title of module
    14	000002'	000000	000000		S$NONAME,,0		;?NONAME stopcode "PCBIO+nnn(nnnnnn)"
    15			000000'	S$NAME==PCBIO			;For STOPCDs with no arguments
    16					SALL>
    17				^
    18
    19				EXTERN DEV1UN,DEVDRB
    20
    21				EXTERN RBREAL,RBSPAR,RBYPNO,RBYUNI,RBMASK
    22
    23				EXTERN UNIPPU,UNISTR,UNISTT,UNIMRC,UNIMWC
    24
    25				EXTERN STRDDB,STRUNI,STRBTS,SRPRPT
    26
    27				EXTERN PRAVAL,PSAVAL,PRQ,PSQ,PRREQ,PSREQ,PRWAIT,PSWAIT,PRSWT
    28				EXTERN PSSWT,RIAVAL,RIQ,RIREQ,RISWT,RIWAIT,MLOWQ,SIREQ,QUEPCB
    29				EXTERN FCAVAL,FCREQ,FCWAIT,M2AVAL,M2Q,M2REQ,M2SWT,M2WAIT,REQTAB
    30				EXTERN SIAVAL,SIQ,SISWT,SIWAIT,AVALTB
    31
    32				EXTERN JBTPCB,PJBSTS,TPOPJ,TPOPJ1
    33
    34				EXTERN PGYSIP,PGYSOP,PGYDRT,PGYADR,PGYERR,PGYUNI,PGYSIO,PGYLMA
    35
    36				EXTERN %UPT,UPTRIB,UPTRB2,UPTSAT
    37
    38				EXTERN STYINC,STTLEN,STTAOB,STTPTR,SATFUL,GSATST
    39				EXTERN STPCHK,STPINC,STTSTS,STPRPT,SATBAD,STPBAD,SATBRD
    40
    41				EXTERN DSKPIN,DSKPIF
    42
    43				EXTERN MINPCB,MAXPCB
    44
    45				EXTERN CPOPJ,CPOPJ1,SAVE4,JOB,CURUPT,PJOBN,TPOPJ
    46				EXTERN UNTTBL,NMSTPC,NMRBPC,TPOPJ,WSCHED,WAIT1,RNQ,SETRUN
    47				EXTERN GIV4WD,GET4WD,CBUSER,SWPENQ,PAGWAK,PAGWAT
    48
    49
    50				;SOME DEFINITIONS
    51
    52				DEFINE DSKOFF <WRPI DSKPIF>
    53				DEFINE DSKON <WRPI DSKPIN>
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

    54				;PCB'S ARE ALLOCATED FROM FREECORE AT ONCE TIME, NEVER MOVE
    55				;THEREAFTER. ONCE ALLOCATES NMRBPC+NMSTPC PCB'S. THESE PARAMS
    56				;LIVE IN LVDTBL IN COMMOD.
    57				;
    58				;STANDARD THROUGHOUT PCBIO: T2/ PCB ADDRESS
    59				;
    60				;THE FORM OF A PCB IS:
    61
    62	000000				PHASE 0
    63	000003'	000000	000000	PCBPTR::! 0	;RETRIEVAL POINTER OF PAGE CURRENTLY LIVING IN THIS PCB
    64	000001			PCBTIM::!
    65	000004'	000000	000000	PCBLKQ::! 0	;LH=CLOCK FOR CLOSE. RH=HEAD OF LOCK QUEUE IN QUEPCB
    66	000002			PCBSTS::!	;STATUS BITS (SEE PCUSTS,PCISTS BELOW)
    67	000002			PCBLCC::!	;LOCK COUNT, SEE PCYLCC
    68	000005'	000000	000000	PCBUSC::! 0	;RH=USE COUNT
    69	000003			PCBPAG::!	;PHYSICAL CORE PAGE NUMBER CONTROLLED BY THIS PCB
    70	000006'	000000	000000	PCBLNK::! 0	;RH=FORWARD LINK TO NEXT PCB OF SIMILAR TYPE
    71	000007'				DEPHASE
    72
    73	000007'	330407	000002	    PCUSTS: POINT 4,PCBSTS(T2),^D8 ;BITS OF PCBSTS NOT CHANGED
    74							;AT INTRPT LVL(MAY BE CHANGED BY FAULT).
    75	000010'	370507	000002	    PCISTS:: POINT 5,PCBSTS(T2),^D4 ;BITS OF PCBSTS THAT MAY BE
    76							;CHANGED BY AN INTERRUPT.
    77	000011'	221107	000002	    PCYLCC: POINT ^D9,PCBLCC(T2),^D17
    78			000777	    PCMLCC==:000777
    79				;STATUS BITS IN PCISTS.
    80			000020	STDDRF==20	;DIRTY MONITOR FLAG
    81			400000	  STPDRF==400000	;ITS THE SIGN BIT
    82			000010	STDPRE==10	;DATA PRESENT
    83			000004	STDREA==4	;DATA READ
    84			100000	  STPREA==100000
    85			000002	STDWRT==2	;DATA WRITE
    86			000001	STDWAG==1	;DATA WRITE AGAIN
    87
    88				;STATUS BITS IN PCUSTS.
    89			000004	STWRTL==4
    90			000002	STCMPL==2
    91			000001	STSNEW==1
    92
    93				;STATUS CODES IN THE %CTSTS FIELDS:
    94			000000	STARDU==0
    95			000001	STAWTU==1
    96			000002	STALOK==2 ;CODES ABOVE THIS ARE LOCKED.
    97			000002	STACML==2
    98			000003	STAWTL==3
    99			000004	STARDL==4
   100			000005	STAWLN==5
   101
   102				;STATUS FIELDS QUYPCS GET THE SAME VALUES AS %CTSTS, BUT IN ADDITION,
   103			001000	STQPCB==1000	;THIS BIT SET IN QUYPCS FLAGS THAT LEFT HALF OF
   104						;QUEPCB(J) IS A REAL PCB ADDRESS.
   105
   106
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 2-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   107	000012'	000000	000000	PCBTAB:: Z	;POINTER TO TABLE OF ADDRESSES OF PRIMARY PCBS,
   108						;SET UP BY ONCE CODE.
   109
   110				;A PCB IS IN ONE OF THE FOLLOWING STATES:
   111				;
   112				;	ONE COMPLETELY LOCKED ACCESSOR.
   113				;	ONE WRITE LOCKED ACCESSOR + PERHAPS SOME READ UNLOCKED
   114				;	    ACCESSORS + PERHAPS SOME WRITE UNLOCKED ACCESSORS.
   115				;	SOME READ LOCKED ACCESSORS + PERHAPS SOME READ UNLOCKED
   116				;	    ACCESSORS + PERHAPS SOME WRITE UNLOCKED ACCESSORS.
   117				;	PERHAPS SOME READ UNLOCKED ACCESSORS + PERHAPS SOME
   118				;		WRITE UNLOCKED ACCESSORS.
   119
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 3
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   120				;A CONTROL BLOCK IS:
   121
   122				DEFINE CTLBLK (CLASS,TYPE,POSN)
   123				<
   124				%'CLASS'.C::
   125				PHASE 0
   126				%CTBYP::!  EPTPGS(%'CLASS'.N,%UPT)	;;BYTE PNTR TO MAP SLOT.
   127				%CTLST::!  Z				;;RH=PNTR TO PCB CHAIN.
   128				%CTUPT::!  %UPT+UPT'CLASS		;;ADDR OF UPT ENTRY(UPTRIB...)
   129				%CTSTS::!  POINT 6,JBTPCB(T1),<<<POSN*6>-1>+18>
   130				%CTADR:!  POINT 6,JBTPCB(T1),<<POSN*6>-1>
   131				%CTLRU::!  Z				;;ADDR OF TOP OF FREE PCB LIST.
   132				%CTMRU::!  Z				;;ADDR+1 MRU ON FREE PCB LIST.
   133				%CTWRQ:! TYPE'REQ
   134				%CTWVL:! TYPE'AVAL
   135				DEPHASE >
   136
   137			000077	%CTAMX==000077	;MAX PERMISSABLE VALUE TO DPB %CTADR
   138
   139				;;GEN THE CONTROL BLOCKS.
   140	000013'	222200	000417*	CTLBLK(RIB,RI,1)
   141	000014'	000000	000000
   142	000015'	000000	000000*
   143	000016'	140606	000000*
   144	000017'	360606	000016*
   145	000020'	000000	000000
   146	000021'	000000	000000
   147	000022'	000000	000000*
   148	000023'	000000	000000*
   149	000024'	002200	000416*	CTLBLK(RB2,RI,2)
   150	000025'	000000	000000
   151	000026'	000000	000000*
   152	000027'	060606	000017*
   153	000030'	300606	000027*
   154	000031'	000000	000000
   155	000032'	000000	000000
   156	000033'	000000	000022*
   157	000034'	000000	000023*
   158	000035'	002200	000417*	CTLBLK(SAT,SI,3)
   159	000036'	000000	000000
   160	000037'	000000	000000*
   161	000040'	000606	000030*
   162	000041'	220606	000040*
   163	000042'	000000	000000
   164	000043'	000000	000000
   165	000044'	000000	000000*
   166	000045'	000000	000000*
   167
   168				;JBTPCB IS LAID OUT SO THAT, FOR T1/JOB, ALL %CTSTS FIELDS
   169				;ARE IN RH (MORE FREQ ACCESSED) AND %CTADR FIELDS IN LH.
   170
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 4
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   171				INTERN MAPRDL,MAPWTL,MAPRDU,MAPWTU,MAPCML,MAPWLN
   172				INTERN STDPRE,STDREA,STDWRT,STDWAG,STPREA
   173				INTERN STAWTU,STAWTL,STACML,STAWLN
   174
   175				;TABLE OF ENTRY POINTS, INDEXED BY STAXXX'S.
   176	000046'	000000	000077'	CODADR:	MAPRDU
   177	000047'	000000	000101'		MAPWTU
   178	000050'	000000	000073'		MAPCML
   179	000051'	000000	000071'		MAPWTL
   180	000052'	000000	000067'		MAPRDL
   181	000053'	000000	000075'		MAPWLN
   182
   183				;TABLE OF PCUSTS BITS, INDEXED BY STAXXX'S.
   184	000054'	000000	000000	CODBTS:	Z
   185	000055'	000000	000000		Z
   186	000056'	000000	000002		STCMPL
   187	000057'	000000	000004		STWRTL
   188	000060'	000000	000000		Z
   189	000061'	000000	000005		STWRTL!STSNEW
   190
   191	000062'	221002	000000*	QUYPCP: POINT ^D8,QUEPCB(J),^D17 ;NO. OF PREVIOUS JOB IN QUEUE.
   192	000063'	101202	000062*	QUYPCS: POINT ^D10,QUEPCB(J),^D27 ;STATUS BITS FOR THIS JOB.
   193	000064'	001002	000063*	QUYPCN: POINT ^D8,QUEPCB(J),^D35 ;NO. OF NEXT JOB IN THE QUEUE.
   194	000065'	000000	000000	PPCBWC:: EXP 0	;PRIM PCB WAIT COUNTER PERFORMANCE CHECKING
   195	000066'	000000	000000	SPCBWC:: EXP 0	;SECONDARY..
   196
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 5
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   197				COMMENT #
   198				@@SUBROUTINE MAPRDL/MAPWTL/MAPRDU/MAPWTU/MAPCML/MAPWLN
   199				@@PURPOSE
   200				SUBROUTINES TO GET A PCB.
   201				@@ENTRY
   202				ENTRY POINTS ARE:
   203					MAPRDL--READ LOCKED
   204					MAPWTL--WRITE LOCKED
   205					MAPRDU--READ UNLOCKED
   206					MAPWTU--WRITE UNLOCKED
   207					MAPCML--COMPLETELY LOCKED
   208					MAPWLN--WRITE LOCKED NEW
   209
   210				EXPECTS PG/ADDR OF CONTROL BLOCK, T1/DISK POINTER, AND F/ DDB.
   211				@@CALLS
   212				CALLS THE SUBRS GETLRU, RESLRU, RESMRU, SETPCB, GET4WD,
   213				FCWAIT, LINKPB, UNLNK2, CHKSTS, STUPLQ, AND ENLOKQ.
   214				@@ACCUM
   215				DESTROYS T1, T2, T3, AND T4.
   216				@@ #
   217				;SET UP T2 WITH VARIOUS STATUS BITS.
   218
   219
   220	000067'	201340	000004	MAPRDL:	MOVEI	T2,STARDL	;SET THE
   221	000070'	254000	000102'		JRST	MAPALL		;STATUS
   222	000071'	201340	000003	MAPWTL:	MOVEI	T2,STAWTL	;REQUESTED ON
   223	000072'	254000	000102'		JRST	MAPALL		;ENTRY SO WE
   224	000073'	201340	000002	MAPCML:	MOVEI	T2,STACML	;CAN
   225	000074'	254000	000102'		JRST	MAPALL		;USE IT
   226	000075'	201340	000005	MAPWLN:	MOVEI	T2,STAWLN	;BELOW.
   227	000076'	254000	000102'		JRST	MAPALL
   228
   229	000077'	201340	000000	MAPRDU:	MOVEI	T2,STARDU
   230	000100'	254000	000102'		JRST	MAPALL
   231	000101'	201340	000001	MAPWTU:	MOVEI	T2,STAWTU	;FALL INTO MAPALL.
   232
   233
   234	000102'	261040	000014	MAPALL:	PUSH	P,P1		;CARRY THE REQUEST STATUS IN
   235	000103'	550600	000007		HRRZ	P1,T2		;P1
   236	000104'	332000	000006		SKIPE	T1		;BE SURE RETR PTR IN
   237	000105'	607300	000000*		TLNN	T1,RBREAL	;T1 IS IN A CORRECT FORM
   238	000106'	256000	002477'		 STOPCD (.,STOP,MAPAL1,,<Bad Retreival Pointer detected at MAPALL+4>)
   239	000107'	621300	000000*		TLZ	T1,RBMASK-RBREAL ;
   240	000110'	205400	777775		MOVSI	T3,-3		;WE KNOW ABOUT 3 PCB CONTROL BLOCKS
   241	000111'	316150	000122'	MAPAL2:	CAMN	PG,MAPTBL(T3)	;CALLER MUST HAVE %RIB.C,ETC. IN PG
   242	000112'	254000	000115'		JRST	MAPAL3		;GOOD, CALLER KNOWS WHAT HE IS DOING
   243	000113'	253400	000111'		AOBJN	T3,MAPAL2
   244	000114'	256000	000000'		 STOPCD			;CALLER BLEW IT ;;MAPAL2+3
   245	000115'	135443	000000	MAPAL3:	LDB	T4,%CTBYP(PG)	;T4/MAP SLOT CONTENTS
   246	000116'	326440	000120'		JUMPN	T4,.+2		;SLOT AND
   247	000117'	332023	000002		SKIPE	@%CTUPT(PG)	;UPTXXX HAD BETTER BOTH BE ZERO
   248	000120'	256000	000000'		 STOPCD			;(CALLER SUPPOSEDLY DOESNT HAVE A PCB ;;MAPAL3+3
   249								; OF THIS TYPE !)
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 5-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   250	000121'	254030	000125'		JRST	@MAPTB1(T3)	;DISPATCH
   251
   252	000122'	000000	000035'	MAPTBL:	%SAT.C
   253	000123'	000000	000024'		%RB2.C
   254	000124'	000000	000013'		%RIB.C
   255
   256	000125'	000000	000131'	MAPTB1:	MAPSAT
   257	000126'	000000	000136'		MAPRB2
   258	000127'	000000	000130'		MAPRIB
   259
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 6
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   260	000130'	260040	000725'	MAPRIB:	PUSHJ	P,DMPSAT	;PREVENT DEADLOCKS.
   261	000131'	261040	000002	MAPSAT:	PUSH	P,J		;WE USE THIS
   262	000132'	200100	000000*		MOVE	J,JOB		;A LOT.
   263	000133'	261040	000015	MPALOT:	PUSH	P,P2		;FLAG TO RESTART FREE CORE
   264	000134'	400640	000000		SETZ	P2,		;WAITERS.
   265	000135'	254000	000177'		JRST	GETPCB
   266
   267	000136'	260040	000725'	MAPRB2:	PUSHJ	P,DMPSAT	;PREVENT DEADLOCKS.
   268	000137'	261040	000002		PUSH	P,J		;
   269	000140'	200100	000132*		MOVE	J,JOB		;
   270	000141'	135400	000013'		LDB	T3,%CTBYP+%RIB.C ;GET MAP SLOT FOR RIB.
   271	000142'	332020	000015'		SKIPE	@%CTUPT+%RIB.C	;SLOT AND UPTXXX HAD BETTER
   272	000143'	254000	000147'		 JRST	MAPR24		;BE BOTH 0 OR BOTH <>0.
   273	000144'	326400	000150'		JUMPN	T3,MAPDIE	;HERE ON 0, WE DON'T HAVE %RIB,
   274	000145'	260040	000173'		PUSHJ	P,GETM2		;SO JUST GET M2.
   275	000146'	254000	000133'		JRST	MPALOT		;
   276
   277				;HERE ON HAVE TO RELEASE %RIB, Q FOR M2, AND THEN GET %RIB AGAIN.
   278	000147'	326400	000151'	MAPR24:	JUMPN	T3,.+2		;
   279	000150'	256000	002502'	MAPDIE:	 STOPCD (.,STOP,MAPDIE,,<UPTRIB and %RIB slot disagreed>)
   280	000151'	261040	000006		PUSH	P,T1		;RETR PTR
   281	000152'	200300	000140*		MOVE	T1,JOB
   282	000153'	135400	000016'		LDB	T3,%CTSTS+%RIB.C ;SAVE THE STATUS OF
   283	000154'	261040	000010		PUSH	P,T3		;HOW WE GOT %RIB.
   284	000155'	550360	000015'		HRRZ	T2,@%CTUPT+%RIB.C ;T2/ PCB ADDRESS FOR %RIB.
   285	000156'	261047	000000		PUSH	P,PCBPTR(T2)	;SAVE %RIB'S DISK POINTER.
   286	000157'	201140	000013'		MOVEI	PG,%RIB.C	;RELEASE
   287	000160'	260040	000564'		PUSHJ	P,MAPRLS	;%RIB.
   288	000161'	353000	000000*		AOSLE	M2REQ		;GET
   289	000162'	260040	000000*		PUSHJ	P,M2WAIT	;M2.
   290	000163'	260040	002161'		PUSHJ	P,M2SRMV	;TAKE US OFF M2SWT.
   291	000164'	260040	002135'		PUSHJ	P,M2HSWT	;PUT US ON M2HAV.
   292	000165'	262040	000006		POP	P,T1		;T1/DISK POINTER.
   293	000166'	262040	000007		POP	P,T2		;RESTORE %RIB'S STATUS.
   294	000167'	260067	000046'		PUSHJ	P,@CODADR(T2)	;GET THE RIB AGAIN.
   295	000170'	262040	000006		POP	P,T1		;RESTORE %RB2'S DISK PNTR
   296	000171'	201140	000024'		MOVEI	PG,%RB2.C	;AND PG.
   297	000172'	254000	000133'		JRST	MPALOT
   298
   299
   300
   301				;TINY SUBR TO GET THE M2 RESOURCE.
   302				;MUST BE CALLED WITH J/ JOB NUMBER.
   303				;DESTROY NO ACS
   304	000173'	353000	000161*	GETM2::	AOSLE	M2REQ		;
   305	000174'	260040	000162*		PUSHJ	P,M2WAIT	;GET M2.
   306	000175'	260040	002161'		PUSHJ	P,M2SRMV	;TAKE US OFF M2SWT.
   307	000176'	324740	002135'		PJRST	M2HSWT		;PUT US ON M2HAV.
   308
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 7
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   309				    ;FIRST, LOOK FOR A PCB WITH THE DESIRED ADDRESS.
   310	000177'	550343	000001	GETPCB:	HRRZ	T2,%CTLST(PG)	;GET A POINTER TO THE PCBS.
   311	000200'	316307	000000	GETPC1:	CAMN	T1,PCBPTR(T2)	;FOUND THE ADDRESS WE WANT?
   312					JRST	[HLRZ T3,PCBPAG(T2) ;YES,  WE CAN USE THIS
   313						JUMPE T3,GTPCFN ;PCB IF (A) IT IS A
   314						HRRZ T4,PCBUSC(T2) ;SECONDARY, OR (B) IT
   315						JUMPN T4,GTPCFN ;IS A PRIMARY IN
   316						MOVE T4,PSREQ ;USE ALREADY, OR
   317						CAIE PG,%SAT.C ;(C) WE ARE ALLOWED
   318						MOVE T4,PRREQ ;TO GET A FREE PRIMARY.
   319						AOJLE T4,GTPCFN ;O'E, WE MUST WAIT IN A
   320	000201'	254000	002505'			JRST GTSPCB] ;SECONDARY PCB.
   321	000202'	550347	000003		HRRZ	T2,PCBLNK(T2)	;GET NEXT PCB.
   322	000203'	326340	000200'		JUMPN	T2,GETPC1	;JUMP IF THERE IS A NEXT ONE.
   323
   324				    ;NOT FOUND.  IS THERE A FREE PRIMARY PCB?
   325	000204'	200440	000000*		MOVE	T4,PSREQ	;ARE WE ALLOWED
   326	000205'	302140	000035'		CAIE	PG,%SAT.C	;TO GET A
   327	000206'	200440	000000*		MOVE	T4,PRREQ	;FREE PRIMARY
   328	000207'	347440	000261'		AOJG	T4,GTSPCB	;PCB?  JUMP ON NO.
   329	000210'	260040	001226'		PUSHJ	P,GETLRU	;TRY TO GET LRU TO T2.
   330	000211'	254000	000314'		JRST	GTWTIO		;JUMP IF ALL HAVE IO IN PROGRESS.
   331
   332				    ;HERE ON A FREE PRIMARY PCB.
   333	000212'	201400	000204*		MOVEI	T3,PSREQ	;TELL THE WORLD
   334	000213'	302140	000035'		CAIE	PG,%SAT.C	;WE HAVE OR WILL HAVE
   335	000214'	201400	000206*		MOVEI	T3,PRREQ	;A PRIMARY
   336	000215'	353010	000000		AOSLE	(T3)		;PCB.
   337	000216'	256000	000000'		 STOPCD                         ;;GETPC1+16
   338	000217'	322640	000221'		JUMPE	P2,.+2		;MAYBE FLAG TO RESTART THE
   339	000220'	476000	000000*		SETOM	FCAVAL		;FREE CORE WAITERS.
   340	000221'	202307	000000		MOVEM	T1,PCBPTR(T2)	;PUT DSK PNTR IN 1ST LOC OF PCB.
   341	000222'	260040	001407'		PUSHJ	P,SETPCB	;SET 2ND & 3RD LOCS IN PCB.
   342	000223'	542363	000002	GTDONE:	HRRM	T2,@%CTUPT(PG)	;SET UPTXXX.
   343	000224'	554407	000003		HLRZ	T3,PCBPAG(T2)	;SET THE MAP
   344	000225'	660400	020000		TRO	T3,PGE.C	;TURN ON CACHE BIT.
   345	000226'	137403	000000		DPB	T3,%CTBYP(PG)
   346	000227'	402002	000064*		SETZM	QUEPCB(J)
   347	000230'	550303	000001		HRRZ	T1,%CTLST(PG)	;CHAIN DOWN LIST OF PCB'S ON
   348	000231'	554406	000003	GTDON2:	HLRZ	T3,PCBPAG(T1)	;THIS %XXX.C, SKIPPING OVER
   349	000232'	326400	000236'		JUMPN	T3,GTDON3	;SECONDARY PCBS WHICH WE KEEP AT
   350	000233'	550306	000003		HRRZ	T1,PCBLNK(T1)	;THE FRONT OF THE LIST. (THEY HAVE PCBPAG/0)
   351	000234'	326300	000231'		JUMPN	T1,GTDON2	;HAVE PCBPAG/0 )
   352	000235'	256000	002516'	GTDON1:: STOPCD (.,JOB,GTDON1,,<PCB link zero at GTDONE+12 or GTDON4+4>)
   353	000236'	201440	000001	GTDON3:	MOVEI	T4,1		;NOW COUNT IN T4/POSITION ON
   354	000237'	306346	000000	GTDON4:	CAIN	T2,(T1)		;LIST OF OUR PCB
   355	000240'	254000	000244'		 JRST	GTDON6		
   356	000241'	550306	000003		HRRZ	T1,PCBLNK(T1)	
   357	000242'	322300	000235'		JUMPE	T1,GTDON1	;STOPCD at GTDON4+4
   358	000243'	344440	000237'		AOJA	T4,GTDON4	
   359	000244'			GTDON6:	;RECORD REQUEST STATUS %CTSTS AND PCB "ADDRESS" (REALLY
   360					;AN INDEX) IN %CTADR FOR THIS PCB FOR THIS JOB
   361	000244'	550300	000002		HRRZ	T1,J
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 7-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   362	000245'	620600	001000		TRZ	P1,STQPCB
   363	000246'	137603	000003		DPB	P1TS(PG)
   364	000247'	303440	000077		CAILE	T4,%CTAMX	;OVERFLOW %CTADR?
   365	000250'	256000	000000'		 STOPCD                         ;;GTDON6+4
   366	000251'	137443	000004		DPB	T4,%CTADR(PG)
   367	000252'	262040	000015		POP	P,P2		;RESTORE P2.
   368	000253'	262040	000002		POP	P,J		;
   369	000254'	262040	000014		POP	P,P1		;RESTORE P1.
   370	000255'	701100	376000		CLRPTO	%RIB	;CLEAR 3 POSSIBLE VIRTUAL ADDRESSES IT COULD BE
   371	000256'	701100	375000		CLRPTO	%RB2
   372	000257'	701100	377000		CLRPTO	%SAT	;(ON KI, WILL BE SLOWER).
   373	000260'	263040	000000		POPJ	P,
   374
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 8
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   375				    ;HERE ON MAYBE NO PCB WITH OUR DISK ADDRESS, BUT NO FREE PRIMARY
   376				    ;PCB.  MAKE A SECONDARY PCB AND THEN WAIT FOR A PRIMARY PCB.
   377
   378	000261'	260040	000543'	GTSPCB:	PUSHJ	P,GT2ND		;
   379	000262'	254000	000177'		JRST	GETPCB		;
   380
   381				      ;GET PRIMARY PCB.
   382	000263'	302140	000035'	GTSPC4:	CAIE	PG,%SAT.C	;DO
   383	000264'	254000	000271'		JRST	GTSPC5		;THIS
   384	000265'	353000	000212*		AOSLE	PSREQ		;OUT
   385	000266'	260040	000000*		PUSHJ	P,PSWAIT	;IN
   386	000267'	260040	002153'		PUSHJ	P,PSSRMV	;
   387	000270'	254000	000274'		JRST	GTSPC6		;LONGHAND,
   388	000271'	353000	000214*	GTSPC5:	AOSLE	PRREQ		;SINCE CLOCK1
   389	000272'	260040	000000*		PUSHJ	P,PRWAIT	;LOOKS AT THE AOSLE.
   390	000273'	260040	002156'		PUSHJ	P,PRSRMV	;
   391	000274'	261040	000007	GTSPC6:	PUSH	P,T2		;SAVE LOC OF 2NDARY PCB.
   392
   393				    ;IS THERE A PRIMARY PCB WITH OUR DISK PNTR ALREADY?
   394	000275'	550343	000001	GTSP65:	HRRZ	T2,%CTLST(PG)	;SKIP OVER THE
   395	000276'	554407	000003	GTSP6A:	HLRZ	T3,PCBPAG(T2)	;SECONDARY
   396	000277'	326400	000303'		JUMPN	T3,GTSPC7	;PCBS AT THE START
   397	000300'	550347	000003		HRRZ	T2,PCBLNK(T2)	;OF THE
   398	000301'	326340	000276'		JUMPN	T2,GTSP6A	;LIST.
   399	000302'	256000	000000'		 STOPCD                         ;;GTSP65+5
   400	000303'	200401	000000	GTSPC7:	MOVE	T3,(P)		;GET THE
   401	000304'	200410	000000		MOVE	T3,PCBPTR(T3)	;PNTR WE WANT.
   402	000305'	316407	000000		CAMN	T3,PCBPTR(T2)	;MATCH?
   403	000306'	254000	000410'		JRST	GTPRSC		;YES.
   404	000307'	550347	000003		HRRZ	T2,PCBLNK(T2)	;NO, CONTINUE LOOKING.
   405	000310'	326340	000303'		JUMPN	T2,GTSPC7	;
   406
   407				    ;HERE ON NO PRIMARY WITH OUR POINTER ALREADY.
   408	000311'	260040	001226'		PUSHJ	P,GETLRU	;GET A PRIM PCB AND CLR DATA PRESENT.
   409	000312'	254000	000324'		JRST	GTWTI4		;
   410	000313'	254000	000342'		JRST	GTSP80		;
   411
   412	000314'	260040	000543'	GTWTIO:	PUSHJ	P,GT2ND		;
   413	000315'	254000	000177'		JRST	GETPCB		;
   414	000316'	261040	000007		PUSH	P,T2		;SAVE LOC OF SECONDARY PCB.
   415	000317'	201400	000265*		MOVEI	T3,PSREQ	;TELL THE WORLD
   416	000320'	302140	000035'		CAIE	PG,%SAT.C	;WE HAVE OR WILL HAVE
   417	000321'	201400	000271*		MOVEI	T3,PRREQ	;A PRIMARY
   418	000322'	353010	000000		AOSLE	(T3)		;PCB.
   419	000323'	256000	000000'		 STOPCD                         ;;GTWTIO+7
   420	000324'	302140	000035'	GTWTI4:	CAIE	PG,%SAT.C	;
   421	000325'	254000	000334'		JRST	GTWTI6		;
   422	000326'	353000	000044*		AOSLE	SIREQ		;
   423	000327'	260040	000000*		PUSHJ	P,SIWAIT	;
   424	000330'	371000	000326*		SOSL	SIREQ		;
   425	000331'	370000	000045*		SOS	SIAVAL		;
   426	000332'	260040	002145'		PUSHJ	P,SISRMV	;
   427	000333'	254000	000275'		JRST	GTSP65		;
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 8-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   428	000334'	353000	000033*	GTWTI6:	AOSLE	RIREQ		;
   429	000335'	260040	000000*		PUSHJ	P,RIWAIT	;
   430	000336'	260040	002150'		PUSHJ	P,RISRMV	;
   431	000337'	371000	000334*		SOSL	RIREQ		;
   432	000340'	370000	000034*		SOS	RIAVAL		;
   433	000341'	254000	000275'		JRST	GTSP65		;
   434
   435				      ;SECONDARY TO PRIMARY.
   436	000342'	400400	000000	GTSP80:	SETZ	T3,		;
   437	000343'	137400	000010'		DPB	T3,PCISTS	;
   438	000344'	200301	000000	GTSPC8:	MOVE	T1,(P)		;T1/ LOC OF SECONDARY PCB.
   439	000345'	260040	001422'		PUSHJ	P,UNLNK2	;REMOVE 2NDARY FROM PCB LIST.
   440	000346'	261040	000007		PUSH	P,T2		;GIVE IT BACK
   441	000347'	200340	000006		MOVE	T2,T1		;TO THE FREE
   442	000350'	201300	000001		MOVEI	T1,1		;CORE POOL.
   443	000351'	260040	000000*		PUSHJ	P,GIV4WD	;
   444	000352'	262040	000007		POP	P,T2		;T2/ LOC OF PRIMARY PCB.
   445	000353'	262040	000006		POP	P,T1		;T1/ LOC OF 2NDARY PCB.
   446	000354'	550406	000001		HRRZ	T3,PCBLKQ(T1)	;PCB INFO TO
   447	000355'	542407	000001		HRRM	T3,PCBLKQ(T2)	;THE PRIMARY PCB EXCEPT
   448	000356'	200406	000000		MOVE	T3,PCBPTR(T1)	;COPY THE
   449	000357'	312407	000000		CAME	T3,PCBPTR(T2)	;
   450	000360'	254000	000370'		JRST	GTSPC9		;
   451	000361'	700600	000000*		DSKOFF			;
   452	000362'	135400	000010'		LDB	T3,PCISTS	;
   453	000363'	200446	000002		MOVE	T4,PCBUSC(T1)	;
   454	000364'	202447	000002		MOVEM	T4,PCBUSC(T2)	;
   455	000365'	137400	000010'		DPB	T3,PCISTS	;
   456	000366'	700600	000000*		DSKON			;
   457	000367'	254000	000373'		JRST	GTSP10		;
   458	000370'	202407	000000	GTSPC9:	MOVEM	T3,PCBPTR(T2)	;2NDARY
   459	000371'	200406	000002		MOVE	T3,PCBUSC(T1)	;FOR THE PAGE NO AND THE FORWARD
   460	000372'	202407	000002		MOVEM	T3,PCBUSC(T2)	;LINK.
   461
   462				    ;GO THRU THE LOCK QUEUE, RESTARTING THE JOBS THAT CAN RUN.
   463	000373'	135300	000064'	GTSP10:	LDB	T1,QUYPCN	;T1/ NO. OF NEXT JOB IN THE QUEUE.
   464	000374'	542307	000001		HRRM	T1,PCBLKQ(T2)	;REMOVE US FROM LOCK QUEUE.
   465	000375'	322300	000223'		JUMPE	T1,GTDONE	;JUMP IF NONE BUT US IN QUEUE.
   466	000376'	200100	000006		MOVE	J,T1		;
   467	000377'	506342	000227*		HRLM	T2,QUEPCB(J)	;
   468	000400'	135300	000063'		LDB	T1,QUYPCS	;
   469	000401'	660300	001000		TRO	T1,STQPCB	;
   470	000402'	137300	000063'		DPB	T1,QUYPCS	;
   471	000403'	135300	000007'		LDB	T1,PCUSTS	;T1/PCB UUO-LEVEL STATUS.
   472	000404'	135400	000011'		LDB	T3,PCYLCC	;T3/PCB LOCK COUNT.
   473	000405'	260040	001564'		PUSHJ	P,STUPLQ	;START UP SELECTED JOBS.
   474	000406'	200100	000152*	GTDON0:	MOVE	J,JOB		;RESTORE J.
   475	000407'	254000	000223'		JRST	GTDONE		;
   476
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 9
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   477				    ;HERE WITH A PRIMARY WHEN WE HAVE A SECONDARY WITH THE SAME ADDRESS.
   478	000410'	550307	000002	GTPRSC:	HRRZ	T1,PCBUSC(T2)	;IF THE PRIMARY'S USE COUNT =
   479	000411'	326300	000414'		JUMPN	T1,GTPRS2	;0, THEN GET IT OFF THE
   480	000412'	260040	001307'		PUSHJ	P,GETTRU	;LRU/MRU LIST AND TREAT IT
   481	000413'	254000	000344'		JRST	GTSPC8		;ALMOST LIKE A STRANGE PRIMARY.
   482
   483	000414'	200301	000000	GTPRS2:	MOVE	T1,(P)		;T1/ LOC OF SECONDARY PCB.
   484	000415'	260040	001422'		PUSHJ	P,UNLNK2	;REMOVE IT FROM THE PCB LIST.
   485	000416'	250341	000000		EXCH	T2,(P)		;GIVE IT
   486	000417'	201300	000001		MOVEI	T1,1		;BACK TO THE
   487	000420'	260040	000351*		PUSHJ	P,GIV4WD	;FREE CORE POOL.
   488	000421'	262040	000007		POP	P,T2		;RESTORE T2/ PRIMARY PCB ADDRESS.
   489	000422'	302140	000035'		CAIE	PG,%SAT.C	;SINCE THIS PRIMARY
   490	000423'	254000	000427'		JRST	GTPRS3		;IS ALREADY
   491	000424'	371000	000317*		SOSL	PSREQ		;IN USE, WE SHOULDN'T
   492	000425'	370000	000000*		SOS	PSAVAL		;COUNT
   493	000426'	254000	000431'		JRST	GTPRS4		;OUR TAKING IT
   494	000427'	371000	000321*	GTPRS3:	SOSL	PRREQ		;AS TAKING
   495	000430'	370000	000000*		SOS	PRAVAL		;A RESOURCE.
   496	000431'	620600	001000	GTPRS4:	TRZ	P1,STQPCB	;
   497	000432'	260040	000506'		PUSHJ	P,TAGONN	;CAN OUR REQUEST START?
   498	000433'	254000	000452'		JRST	GTPRS8		;YES.
   499
   500				      ;HERE WHEN OUR REQUEST CAN'T START.
   501	000434'	200100	000406*		MOVE	J,JOB		;ENLOKQ US AND
   502	000435'	260040	001450'		PUSHJ	P,ENLOKQ	;OUR FOLLOWERS, TOO.
   503	000436'	201300	000000*		MOVEI	T1,MLOWQ	;
   504	000437'	137300	000000*		DPB	T1,PJBSTS	;
   505	000440'	135300	000007'		LDB	T1,PCUSTS	;TRY TO
   506	000441'	135400	000011'		LDB	T3,PCYLCC	;START
   507	000442'	550107	000001		HRRZ	J,PCBLKQ(T2)	;ANYBODY WHO
   508	000443'	260040	001564'		PUSHJ	P,STUPLQ	;CAN.
   509	000444'	200100	000434*		MOVE	J,JOB		;HAVE WE
   510	000445'	135300	000437*		LDB	T1,PJBSTS	;STARTED? (DEBUGGING
   511	000446'	302300	000436*		CAIE	T1,MLOWQ	; CHECK.).
   512	000447'	256000	000000'		 STOPCD                         ;;GTPRS4+16
   513	000450'	260040	000000*		PUSHJ	P,WSCHED	;
   514	000451'	254000	000223'		JRST	GTDONE
   515
   516				      ;HERE WHEN OUR REQUEST CAN START.
   517	000452'	135100	000064'	GTPRS8:	LDB	J,QUYPCN	;DO WE HAVE FOLLOWERS?
   518	000453'	322100	000406'		JUMPE	J,GTDON0	;NO.
   519	000454'	260040	001450'		PUSHJ	P,ENLOKQ	;YES.  ENLOKQ THEM.
   520	000455'	135300	000007'		LDB	T1,PCUSTS	;
   521	000456'	135400	000011'		LDB	T3,PCYLCC	;
   522	000457'	550107	000001		HRRZ	J,PCBLKQ(T2)	;
   523	000460'	260040	001564'		PUSHJ	P,STUPLQ	;SEE IF ANY OF THEM CAN START.
   524	000461'	254000	000406'		JRST	GTDON0		;
   525
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 10
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   526				    ;HERE ON FOUND A PCB WITH OUR DISK POINTER.
   527	000462'	322640	000464'	GTPCFN:	JUMPE	P2,.+2		;
   528	000463'	476000	000220*		SETOM	FCAVAL		;
   529	000464'	322400	000471'		JUMPE	T3,GTFND6	;ONLY PRIM PCBS HAVE A PAGE NO.
   530
   531				    ;HERE ON FOUND A PRIMARY PCB.
   532	000465'	260040	000506'		PUSHJ	P,TAGONN	;SEE IF WE CAN START OUR REQ.
   533	000466'	254000	000406'		JRST	GTDON0		;YES, WE CAN.
   534	000467'	350000	000065'		AOS	PPCBWC		;PRIM PCB WAIT COUNTER
   535	000470'	634440	000011		TDZA	T4,T4		;CAN'T.  GO Q. (FLAG SAW PRIM.).
   536
   537				    ;HERE FOR FOUND A SECONDARY PCB.
   538	000471'	474440	000000	GTFND6:	SETO	T4,		;FLAG SAW SECONDARY.
   539	000472'	200100	000444*		MOVE	J,JOB		;RESTORE J.
   540	000473'	402002	000377*		SETZM	QUEPCB(J)	;
   541	000474'	260040	001450'		PUSHJ	P,ENLOKQ	;SINCE WE CAN'T START, PUT US
   542	000475'	201340	000446*		MOVEI	T2,MLOWQ	;AT THE END OF THE QUEUE, AND
   543	000476'	137340	000445*		DPB	T2,PJBSTS	;THEN
   544	000477'	260040	000450*		PUSHJ	P,WSCHED	;WAIT.
   545	000500'	554342	000473*		HLRZ	T2,QUEPCB(J)	;T2/ PCB ADDR.
   546	000501'	322440	000223'		JUMPE	T4,GTDONE	;JUMP IF ORIG SAW PRIM.
   547	000502'	350000	000066'		AOS	SPCBWC		;SECONDARY PCB WAIT COUNTER
   548	000503'	554407	000003		HLRZ	T3,PCBPAG(T2)	;ELSE, NOW HAVE A PRIMARY PCB?
   549	000504'	322400	000263'		JUMPE	T3,GTSPC4	;JUMP ON NO.
   550	000505'	254000	000223'		JRST	GTDONE		;
   551
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 11
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   552				COMMENT #
   553				@@SUBROUTINE TAGONN
   554				@@PURPOSE
   555				SUBR TO SEE IF WE CAN START A REQUEST FOR A PRIMARY PCB
   556				THAT MAY HAVE USERS ALREADY.
   557				@@ENTRY
   558				EXPECTS T2/ ADDR OF PCB, P1/ USUAL REQUEST STATUS, PG/ CNTL
   559				BLOCK ADDRESS.
   560				@@ACCUM
   561				DESTROYS T1 THRU T4 AND J.
   562				@@EXIT
   563				IF REQ CANNOT START, SKIP RETURN HAVING DONE NOTHING.  ELSE,
   564				NON-SKIP RETURN WITH REQ STATUS IN PCB, ETC., READY TO
   565				GO TO GTDON0.
   566				@@ #
   567
   568	000506'	135300	000007'	TAGONN:	LDB	T1,PCUSTS	;PCB
   569	000507'	602300	000002		TRNE	T1,STCMPL	;CMPL?
   570	000510'	254000	000000*		JRST	CPOPJ1		;YES, WE CAN'T START.
   571	000511'	550107	000001		HRRZ	J,PCBLKQ(T2)	;NO.  ANYBODY IN THE
   572	000512'	322100	000525'		JUMPE	J,TAGON2	;LOCK QUEUE?
   573				      ;HERE WHEN THERE IS A LOCK QUEUE.
   574	000513'	301600	000002		CAIL	P1,STALOK	;ARE WE A REQ TO LOCK?
   575	000514'	254000	000510*		JRST	CPOPJ1		;YES, CAN'T START.
   576				      ;HERE WHEN THERE IS A LOCK Q AND WE ARE AN UNLOKQ REQ.
   577				      ;WE CAN START PROVIDED THERE IS NOBODY IN THE LOCK QUEUE
   578				      ;WHO WANTS TO CMPL.
   579	000515'	135300	000063'	TAGON1:	LDB	T1,QUYPCS	;
   580	000516'	620300	001000		TRZ	T1,STQPCB	;
   581	000517'	306300	000002		CAIN	T1,STACML	;
   582	000520'	254000	000514*		JRST	CPOPJ1		;
   583	000521'	135100	000064'		LDB	J,QUYPCN	;
   584	000522'	326100	000515'		JUMPN	J,TAGON1	;
   585	000523'	350007	000002		AOS	PCBUSC(T2)	;OKAY, START
   586	000524'	263040	000000		POPJ	P,		;US.
   587				      ;HERE WHEN NOBODY WAS IN THE LOCK QUEUE.  TRY TO
   588				      ;START US UP.
   589	000525'	550307	000002	TAGON2:	HRRZ	T1,PCBUSC(T2)	;IS ANYBODY AT ALL USING
   590	000526'	326300	000535'		JUMPN	T1,TAGN25	;THIS PCB?
   591	000527'	260040	001307'		PUSHJ	P,GETTRU	;NO, MUST BE ON LRU/MRU LIST.
   592	000530'	201400	000424*		MOVEI	T3,PSREQ	;FLAG
   593	000531'	302140	000035'		CAIE	PG,%SAT.C	;THAT WE
   594	000532'	201400	000427*		MOVEI	T3,PRREQ	;HAVE TAKEN A
   595	000533'	353010	000000		AOSLE	(T3)		;PCB.
   596	000534'	256000	000000'		 STOPCD                         ;;TAGON2+7
   597	000535'	135300	000007'	TAGN25:	LDB	T1,PCUSTS	;TRY TO
   598	000536'	135400	000011'		LDB	T3,PCYLCC	;START
   599	000537'	201454	000000		MOVEI	T4,(P1)		;US UP.
   600	000540'	260040	001536'		PUSHJ	P,CHKST0	;
   601					JRST	[DPB T1,PCUSTS	;CAN.
   602						DPB T3,PCYLCC
   603	000541'	254000	002521'			POPJ P,]
   604	000542'	254000	000520*		JRST	CPOPJ1		;CAN'T.
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 11-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   605
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 12
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   606				COMMENT #
   607				@@SUBROUTINE GT2ND
   608				@@PURPOSE
   609				SUBR TO GET CORE FOR AND BUILD A SECONDARY PCB.
   610				@@ENTRY
   611				@ACCUM
   612				@@EXIT
   613				@@ #
   614
   615				    ;FIRST GET THE CORE FOR THE SECONDARY PCB.
   616	000543'	261040	000006	GT2ND:	PUSH	P,T1		;SAVE T1 FROM GET4WD.
   617	000544'	201340	000001		MOVEI	T2,1		;REQUEST ONE 4-WORD BLOCK.
   618	000545'	335000	000000*		SKIPGE	FCREQ		;ANY WAITERS FOR FREE CORE?
   619	000546'	260040	000000*		PUSHJ	P,GET4WD	;NO, TRY TO GET FREE CORE.
   620					JRST	[POP P,T1	;DIDN'T GET IT OR WAITERS.
   621						AOS FCREQ	;QUEUE UP
   622						PUSHJ P,FCWAIT	;FOR FREE CORE.
   623						SOSL FCREQ	;BACK.
   624						SETO	P2,	;FLAG TO RESTART WAITERS LATER.
   625	000547'	254000	002524'			POPJ P,]
   626				    ;SET UP SECONDARY PCB.
   627	000550'	200340	000006		MOVE	T2,T1		;LOC OF 2NDARY PCB TO T2.
   628	000551'	262047	000000		POP	P,PCBPTR(T2)	;PUT DSK PNTR IN 1ST PCB LOC.
   629	000552'	402007	000002		SETZM	PCBUSC(T2)	;CLR STATUS BECAUSE SETPCB ORS.
   630	000553'	553007	000001		HRRZS	PCBTIM(T2)	;SECONDARIES HAVE NO CLOCK.
   631	000554'	260040	001407'		PUSHJ	P,SETPCB	;SET 2ND & 3RD LOCS IN PCB.
   632	000555'	402007	000003		SETZM	PCBPAG(T2)	;0 PAGE # & LINK IN 4TH PCB WRD.
   633	000556'	542107	000001		HRRM	J,PCBLKQ(T2)	;POINT TO US IN THE QUEUE.
   634	000557'	516342	000500*		HRLZM	T2,QUEPCB(J)	;
   635	000560'	660600	001000		TRO	P1,STQPCB	;
   636	000561'	137600	000063'		DPB	P1,QUYPCS	;
   637	000562'	260040	001444'		PUSHJ	P,LINKPB	;LINK INTO THE PCB LIST.
   638	000563'	254000	000542*		JRST	CPOPJ1		;
   639
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 13
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   640				COMMENT #
   641				@@SUBROUTINE MAPRLS/MAPREL
   642				@@PURPOSE
   643				SUBRS TO RELEASE A PCB.  MAPREL DOES THE WORK.  MAPRLS
   644				SETS UP SOME ACS AND CALLS MAPREL.
   645				@@ENTRY
   646				MAPRLS AND MAPREL BOTH EXPECT PG/ADDR OF CONTROL BLOCK.
   647				MAPREL ALSO EXPECTS T4/ JOB'S STATUS AND T2/ PCB ADDRESS.
   648				@@CALLS
   649				PLPGET AND SWPEQ1.
   650				@@ACCUM
   651				DESTROYS T1, T2, T3, AND T4.
   652				@@ #
   653
   654
   655	000564'	200300	000472*	MAPRLS:: MOVE	T1,JOB
   656	000565'	135443	000003		LDB	T4,%CTSTS(PG)	;T4/REQUEST STATUS FOR MAPREL
   657	000566'	550363	000002		HRRZ	T2,@%CTUPT(PG)	;T2/ADDR OF PCB.
   658	000567'	326340	000571'		JUMPN	T2,.+2		;
   659	000570'	256000	000000'		 STOPCD                         ;;MAPRLS+4
   660	000571'	260040	000614'		PUSHJ	P,MAPREL	;
   661
   662				    ;FINISH UP.
   663	000572'	400440	000000	MAPRDN:	SETZ	T4,		;CLEAR THE MAP
   664	000573'	137443	000000		DPB	T4,%CTBYP(PG)	;SLOT AND
   665	000574'	402023	000002		SETZM	@%CTUPT(PG)	;UPTXXX.
   666	000575'	701100	376000		CLRPTO	%RIB		;QUICKER JUST TO CLEAR THESE OUT OF
   667	000576'	701100	375000		CLRPTO	%RB2		;PAGE TABLE THAN TO FIGURE OUT WHICH
   668	000577'	701100	377000		CLRPTO	%SAT		; ONE TO DO.
   669	000600'	200300	000564*		MOVE	T1,JOB		;
   670	000601'	137443	000004		DPB	T4,%CTADR(PG)	;ZERO THIS TOO
   671	000602'	306140	000024'		CAIN	PG,%RB2.C	;IF WE ARE RELEASING RB2,
   672	000603'	324740	000605'		PJRST	RELM2		;THEN GIVE BACK THE M2 RESOURCE.
   673	000604'	263040	000000		POPJ	P,		;
   674
   675
   676				;TINY SUBR TO RELEASE THE M2 RESOURCE.
   677				INTERN RELM2
   678	000605'	371000	000173*	RELM2:	SOSL	M2REQ		;GIVE
   679	000606'	370000	000000*		SOS	M2AVAL		;BACK M2Q.
   680	000607'	261040	000002		PUSH	P,J		;
   681	000610'	200100	000600*		MOVE	J,JOB		;
   682	000611'	260040	002171'		PUSHJ	P,M2HRMV	;REMOVE US FROM M2HAV LIST.
   683	000612'	262040	000002		POP	P,J		;
   684	000613'	263040	000000		POPJ	P,
   685
   686
   687	000614'	370007	000002	MAPREL:	SOS	PCBUSC(T2)	;DEC THE USE COUNT.
   688	000615'	135300	000007'		LDB	T1,PCUSTS	;T1/PCUSTS.
   689	000616'	135400	000011'		LDB	T3,PCYLCC	;T3/ LOCK COUNT.
   690	000617'	305440	000002		CAIGE	T4,STALOK	;LOCKED?
   691	000620'	254000	000625'		JRST	MAPRL2		;NO.
   692
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 13-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   693				    ;HERE WHEN WE ARE LOCKED.
   694	000621'	360400	000622'		SOJ	T3,.+1		;DEC THE
   695	000622'	137400	000011'		DPB	T3,PCYLCC	;LOCK COUNT.
   696	000623'	622300	000007		TRZE	T1,STWRTL!STCMPL!STSNEW ;IS THE PCB READ LOKED?
   697	000624'	137300	000007'		DPB	T1,PCUSTS	;NO, CLR WL OR CL OR NEW BITS.
   698
   699				    ;NEED TO RESTART SOME WAITERS?
   700	000625'	326400	000000*	MAPRL2:	JUMPN	T3,CPOPJ	;IF LOK CT IS 0 AND LOK Q
   701	000626'	550447	000001		HRRZ	T4,PCBLKQ(T2)	;<>0, THEN RESTART AS MANY
   702	000627'	322440	000634'		JUMPE	T4,MAPRL4	;AS WE CAN.
   703	000630'	261040	000002		PUSH	P,J		;SAVE J.
   704	000631'	201111	000000		MOVEI	J,(T4)		;J/ 1ST JOB NO. TO LOOK AT.
   705	000632'	260040	001564'		PUSHJ	P,STUPLQ	;RESTART SOME WAITERS.
   706	000633'	262040	000002		POP	P,J		;RESTORE J.
   707	000634'	550447	000002	MAPRL4:	HRRZ	T4,PCBUSC(T2)	;HAS THE USE COUNT GONE
   708	000635'	326440	000625*		JUMPN	T4,CPOPJ	;TO 0?
   709
   710				    ;HERE ON THE USE COUNT=0.
   711	000636'	302140	000035'		CAIE	PG,%SAT.C	;TAKE
   712	000637'	254000	000643'		JRST	MAPRL5		;A
   713	000640'	371000	000530*		SOSL	PSREQ		;JOB OUT
   714	000641'	370000	000425*		SOS	PSAVAL		;OF
   715	000642'	254000	000645'		JRST	.+3		;PS OR
   716	000643'	371000	000532*	MAPRL5:	SOSL	PRREQ		;PR
   717	000644'	370000	000430*		SOS	PRAVAL		;WAIT.
   718	000645'	700600	000361*		DSKOFF
   719	000646'	135300	000010'		LDB	T1,PCISTS	;
   720	000647'	602300	000010		TRNE	T1,STDPRE	;IS DATA PRESENT?
   721	000650'	254000	000660'		JRST	MAPRL6		;YES.
   722	000651'	602300	000004		TRNE	T1,STDREA	;READ IN PROGRESS (MAYBE SWAPPER REQ)?
   723	000652'	254000	000655'		JRST	.+3		;YES, FINPCB WILL ADJUST COUNT.
   724	000653'	371023	000007		SOSL	@%CTWRQ(PG)	;
   725	000654'	370023	000010		SOS	@%CTWVL(PG)	;
   726	000655'	260040	001361'		PUSHJ	P,RESLRU	;NO. PUT US BACK ON LIST AS LRU.
   727	000656'	700600	000366*		DSKON			;
   728	000657'	263040	000000		POPJ	P,		;
   729
   730				    ;HERE ON DATA PRESENT.
   731	000660'	260040	001405'	MAPRL6:	PUSHJ	P,RESMRU	;PUT US BACK ON THE LIST AS MRU.
   732	000661'	261040	000003		PUSH	P,PG		;SAVE PG.
   733	000662'	554147	000003		HLRZ	PG,PCBPAG(T2)	;HAS THE
   734	000663'	135440	000000*		LDB	T4,PGYDRT	;DATA BEEN
   735					JUMPE	T4,[POP P,PG	;MODIFIED?
   736						LDB	T1,PCISTS
   737						TRNE T1,STDWRT!STDWAG!STDREA
   738						JRST [DSKON
   739						     POPJ P,]
   740						SOSL @%CTWRQ(PG)
   741						SOS @%CTWVL(PG)
   742						DSKON
   743	000664'	322440	002534'			POPJ P,]
   744	000665'	200301	000000		MOVE	T1,(P)		;YES.
   745	000666'	302300	000035'		CAIE	T1,%SAT.C	;
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 13-3
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   746	000667'	254000	000675'		JRST	MAPRL7		;
   747	000670'	700600	000656*		DSKON
   748	000671'	262040	000003		POP	P,PG		;DON'T WRITE IF A SAT PCB.
   749	000672'	201300	000003		MOVEI	T1,3		;
   750	000673'	202300	002333'		MOVEM	T1,SATWRT	;
   751	000674'	263040	000000		POPJ	P,		;
   752				     ;THIS IS AN ENTRY POINT.
   753	000675'	700600	000645*	MAPRL7:	DSKOFF			;YES.
   754	000676'	135300	000010'		LDB	T1,PCISTS	;
   755	000677'	400440	000000		SETZ	T4,		;CLEAR DATA MODIFIED SINCE WE
   756	000700'	137440	000663*		DPB	T4,PGYDRT	;ARE ABOUT TO WRITE IT OUT.
   757	000701'	666300	000002		TRON	T1,STDWRT	;IS DATA WRITE ALSO SET?
   758	000702'	254000	000710'		JRST	MAPRL8		;NO.
   759	000703'	660300	000001		TRO	T1,STDWAG	;YES, SO SET DATA WRITE AGAIN.
   760	000704'	137300	000010'		DPB	T1,PCISTS
   761	000705'	700600	000670*		DSKON
   762	000706'	262040	000003		POP	P,PG		;RESTORE PG.
   763	000707'	263040	000000		POPJ	P,		;
   764
   765				    ;HERE TO REQUEST WRITE OUT.
   766	000710'	137300	000010'	MAPRL8:	DPB	T1,PCISTS	;
   767	000711'	700600	000705*		DSKON
   768	000712'	261040	000007		PUSH	P,T2		;T2.
   769	000713'	200447	000000		MOVE	T4,PCBPTR(T2)	;
   770	000714'	137440	000000*		DPB	T4,PGYADR	;
   771	000715'	260040	000757'		PUSHJ	P,PAGOUT	;START THE PAGE OUT.
   772	000716'	262040	000007		POP	P,T2		;RESTORE T2.
   773	000717'	262040	000003		POP	P,PG		;
   774	000720'	263040	000000		POPJ	P,
   775
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 14
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   776				COMMENT #
   777				@@SUBROUTINE RELSAT/DMPSAT
   778				@@PURPOSE
   779				THESE ROUTINES JUST RELEASE THE SAT IF WE HAVE ONE TO
   780				RELEASE.  DMPSAT SAVES ALL ACS.
   781				@@ACCUM
   782				RELSAT DESTROYS T1 THRU T4 AND PG.
   783				DMPSAT DESTROYS NO ACS.
   784				@@CALLS
   785				MAPRLS.
   786				@@ #
   787
   788				INTERN RELSAT
   789
   790	000721'	201140	000035'	RELSAT:	MOVEI	PG,%SAT.C	;
   791	000722'	332020	000037'		SKIPE	@%SAT.C+%CTUPT	;
   792	000723'	324740	000564'		PJRST	MAPRLS		;
   793	000724'	263040	000000		POPJ	P,		;
   794
   795
   796	000725'	336020	000037'	DMPSAT:	SKIPN	@%SAT.C+%CTUPT	;
   797	000726'	263040	000000		POPJ	P,		;
   798	000727'	261040	000006		PUSH	P,T1		;
   799	000730'	261040	000007		PUSH	P,T2		;
   800	000731'	261040	000010		PUSH	P,T3		;
   801	000732'	261040	000011		PUSH	P,T4		;
   802	000733'	261040	000003		PUSH	P,PG		;
   803	000734'	201140	000035'		MOVEI	PG,%SAT.C	;
   804	000735'	260040	000564'		PUSHJ	P,MAPRLS	;
   805	000736'	262040	000003		POP	P,PG		;
   806	000737'	262040	000011		POP	P,T4		;
   807	000740'	262040	000010		POP	P,T3		;
   808	000741'	262040	000007		POP	P,T2		;
   809	000742'	262040	000006		POP	P,T1		;
   810	000743'	263040	000000		POPJ	P,
   811
   812
   813
   814
   815				COMMENT #
   816				@@SUBROUTINE RELRIB
   817				@@PURPOSE
   818				THIS ROUTINE JUST RELEASES THE RIB IN %RIB IF WE HAVE ONE TO
   819				RELEASE.
   820				@@ACCUM
   821				DESTROYS T1 THRU T4 AND PG.
   822				@@CALLS
   823				MAPRLS.
   824				@@ #
   825
   826				INTERN RELRIB
   827
   828	000744'	201140	000013'	RELRIB:	MOVEI	PG,%RIB.C	;
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 14-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   829	000745'	332020	000015'		SKIPE	@%RIB.C+%CTUPT	;
   830	000746'	324740	000564'		PJRST	MAPRLS		;
   831	000747'	263040	000000		POPJ	P,		;
   832
   833
   834
   835				COMMENT #
   836				@@SUBROUTINE RELRB2
   837				@@PURPOSE
   838				THIS ROUTINE JUST RELEASES THE RIB IN %RB2 IF WE HAVE ONE TO
   839				RELEASE.
   840				@@ACCUM
   841				DESTROYS T1 THRU T4 AND PG.
   842				@@CALLS
   843				MAPRLS.
   844				@@ #
   845
   846				INTERN RELRB2
   847
   848	000750'	201140	000024'	RELRB2:	MOVEI	PG,%RB2.C	;
   849	000751'	332020	000026'		SKIPE	@%RB2.C+%CTUPT	;
   850	000752'	324740	000564'		PJRST	MAPRLS		;
   851	000753'	263040	000000		POPJ	P,
   852
   853
   854
   855
   856
   857
   858
   859				INTERN STRIOS
   860
   861	000754'	202004	000002	STRIOS:	MOVEM	S,DEVIOS(F)	;STORE S IN DDB (STOIOS CHANGES T1)
   862	000755'	263040	000000		POPJ	P,		;AND RETURN
   863
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 15
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   864				COMMENT #
   865				@@SUBROUTINE PAGOUT/PAGIN/PAGIMD
   866				@@PURPOSE
   867				SUBR TO WRITE A PAGE OUT TO OR READ A PAGE IN FROM THE DISK.
   868				@@ENTRY
   869				EXPECTS PG/ LOGICAL PAGE NO. AND T2/ PCB ADDRESS.
   870				PAGOUT AND PAGIN ALSO EXPECT F/ DDB ADDR.
   871				EXPECTS PGYADR TO BE SET UP ALREADY.
   872				ENTRY POINTS ARE PAGOUT (WRITE A PAGE), PAGIN (READ A PAGE), AND
   873				PAGIMD(START A READ OR WRITE WITH SOME STUFF ALREADY SET UP).
   874				@@ACCUM
   875				DESTROYS T1-T4.
   876				@@EXIT
   877				@@ #
   878
   879				INTERN PAGOUT,PAGIN
   880
   881	000756'	634440	000011	PAGIN:	TDZA	T4,T4		;COMING IN.
   882	000757'	201440	000001	PAGOUT:	MOVEI	T4,1		;GOING OUT.
   883	000760'	137440	000000*		DPB	T4,PGYSOP	;MARK
   884	000761'	640440	000001		TRC	T4,1		;THE
   885	000762'	137440	000000*		DPB	T4,PGYSIP	;DIRECTION.
   886					;PJRST	PAGIMD		;FALL THRU TO DO THE WORK
   887
   888	000763'	261040	000014	PAGIMD:	PUSH	P,P1		;SAVE
   889	000764'	261040	000005		PUSH	P,U		;
   890	000765'	261040	000015		PUSH	P,P2		;THESE
   891	000766'	261040	000016		PUSH	P,P3		;FROM
   892	000767'	261040	000017		PUSH	P,P4		;THE
   893	000770'	261040	000003		PUSH	P,PG		;CLUTCHES
   894	000771'	261040	000004		PUSH	P,F		;OF
   895	000772'	261040	000002		PUSH	P,J		;SWPENQ.
   896	000773'	317140	000000*		CAMG	PG,MAXPCB	;CHECK FOR PAGE NUMBER
   897	000774'	315140	000000*		CAMGE	PG,MINPCB	;IN CORRECT RANGE.
   898	000775'	256000	000000'		 STOPCD                         ;;PAGIMD+12
   899	000776'	137340	000000*		DPB	T2,PGYLMA	;SAVE REAL PCB ADDR FOR FINPCB
   900	000777'	261040	000000		PUSH	P,S		;
   901	001000'	260040	000000*		PUSHJ	P,SWPENQ	;
   902	001001'	262040	000000		POP	P,S		;
   903	001002'	262040	000002		POP	P,J		;
   904	001003'	262040	000004		POP	P,F		;
   905	001004'	262040	000003		POP	P,PG		;
   906	001005'	262040	000017		POP	P,P4		;
   907	001006'	262040	000016		POP	P,P3		;
   908	001007'	262040	000015		POP	P,P2		;
   909	001010'	262040	000005		POP	P,U		;
   910	001011'	262040	000014		POP	P,P1		;
   911	001012'	263040	000000		POPJ	P,
   912
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 16
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   913				COMMENT #
   914				@@SUBROUTINE PPCBIO
   915				@@PURPOSE
   916				SUBR TO SET UP ARGS FOR PAGIMD AND CALL IT TO READ OR WRITE
   917				A PCB.
   918				@@ENTRY
   919				EXPECTS T2/ PCB ADR AND T4/ 0 IF READ OR 1 IF WRITE..
   920				@@ACCUM
   921				DESTROYS T1, AND T3-T4.
   922				@@ #
   923
   924				INTERN PPCBIO
   925
   926	001013'	261040	000003	PPCBIO:	PUSH	P,PG		;PG, AND
   927	001014'	261040	000007		PUSH	P,T2		;T2.
   928	001015'	554147	000003		HLRZ	PG,PCBPAG(T2)	;SET UP PG/ CORE PAGE NUMBER.
   929	001016'	137440	000760*		DPB	T4,PGYSOP	;SET DIRECTION.
   930	001017'	640440	000001		TRC	T4,1		;
   931	001020'	137440	000762*		DPB	T4,PGYSIP	;
   932	001021'	322440	001024'		JUMPE	T4,PCBIO4	;DON'T RESET PGYADR IF WAG.
   933	001022'	200447	000000		MOVE	T4,PCBPTR(T2)	;SET
   934	001023'	137440	000714*		DPB	T4,PGYADR	;PGYADR.
   935	001024'	260040	000763'	PCBIO4:	PUSHJ	P,PAGIMD	;REQUEST THE TRANSFER.
   936	001025'	262040	000007		POP	P,T2		;RESTORE T2,
   937	001026'	262040	000003		POP	P,PG		;PG, AND
   938	001027'	263040	000000		POPJ	P,
   939
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 17
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   940				COMMENT #
   941				@@SUBROUTINE FINPCB
   942				@@PURPOSE
   943				SUBR TO CLEAN UP AFTER THE IO TRANSFER OF A PCB.
   944				@@ENTRY
   945				EXPECTS PG/ CORE PAGE NUMBER.
   946				@@ACCUM
   947				DESTROYS T1-T4.
   948				@@FUNCTION NOTE THAT IN SOME CASES A PCB WHICH HAS BEEN RELEASED
   949				BUT WHOSE PCBPTR IS STILL SETUP AND HAD A WRITE OUT IN PROGRESS
   950				CAN HAVE HAD A NEW ADDRESS STUCK INTO PCBPTR AND HAVE STDREA
   951				OR STDWAG SET ON IT FOR THE NEW DATA. THIS IS WHY THE CHECK IS
   952				MADE FOR STDREA OR STDWAG AFTER A WRITE COMPLETES.
   953				@@ #
   954
   955
   956	001030'	317140	000773*	FINPCB:: CAMG	PG,MAXPCB	;JUST IN
   957	001031'	315140	000774*		CAMGE	PG,MINPCB	;CASE, CHECK THE PAGE NUMBER.
   958	001032'	256000	000000'		 STOPCD                         ;;FINPCB+2
   959	001033'	135340	000776*		LDB	T2,PGYLMA	;T2/PCB ADDR
   960	001034'	135300	000000*		LDB	T1,PGYUNI	;
   961	001035'	200306	000000*		MOVE	T1,UNTTBL(T1)	;
   962	001036'	135400	000010'		LDB	T3,PCISTS	;T3/ STATUS.
   963	001037'	602400	000002		TRNE	T3,STDWRT	;DATA WRITE?
   964	001040'	254000	001063'		JRST	FNPCWT		;YES.
   965
   966				    ;HERE ON COMPLETION OF A PCB READ.
   967	001041'	350006	000000*		AOS	UNIMRC(T1)	;UPDATE STATISTICS.
   968	001042'	626400	000004		TRZN	T3,STDREA	;IF NOT DW, MUST BE DATA READ.
   969	001043'	256000	000000'		 STOPCD                         ;;FINPCB+13
   970	001044'	660400	000010		TRO	T3,STDPRE	;SET DATA PRESENT.
   971	001045'	137400	000010'		DPB	T3,PCISTS	;
   972	001046'	260040	001126'		PUSHJ	P,RSTWAI	;RESTART WAITERS.
   973	001047'	322440	000635*		JUMPE	T4,CPOPJ	;JUMP OVER THIS IF ONCE-TIME.
   974	001050'	261040	000003		PUSH	P,PG		;IF THIS IS A SAT PCB,
   975	001051'	260040	002105'		PUSHJ	P,CTLFND	;SET STYINC.  FIRST FIND PG.
   976	001052'	302140	000035'		CAIE	PG,%SAT.C	;PG=%SAT.C?
   977	001053'	254000	001124'		JRST	FNPCOT		;NO, NOT A SAT PCB.
   978				;	PUSH	P,T2		;SAVE PCB ADDRESS.*****PART 1 OF 2.
   979	001054'	261040	000005		PUSH	P,U		;YES.  FIND THE ADDRESS OF
   980	001055'	200347	000000		MOVE	T2,PCBPTR(T2)	;
   981	001056'	260040	000000*		PUSHJ	P,GSATST	;THE STT TABLE ENTRY.
   982	001057'	262040	000005		POP	P,U		;THEN SET
   983	001060'	201400	000001		MOVEI	T3,1		;1 IN
   984	001061'	137400	000000*		DPB	T3,STYINC	;STYINC FOR IT.
   985				;	POP	P,T2		;RESTORE T2/ PCB ADDRESS.****PART 2 OF 2.
   986	001062'	254000	001107'		JRST	FNPCRU		;FIX UP COUNT IF SWAPPER REQ.
   987
   988				    ;HERE ON COMPLETION OF A PCB WRITE.
   989				      ;EITHER WE HAVE TO WRITE IT AGAIN, OR READ IT, OR WE
   990				      ;ARE DONE.
   991	001063'	350006	000000*	FNPCWT:	AOS	UNIMWC(T1)	;UPDATE STATISTICS.
   992	001064'	554447	000001		HLRZ	T4,PCBTIM(T2)	;INCREMENT THE CLOCK,
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 17-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

   993	001065'	551451	000001		HRRZI	T4,1(T4)	;AUTOMATICALLY TURNING
   994	001066'	506447	000001		HRLM	T4,PCBTIM(T2)	;OVERFLOW AROUND.
   995	001067'	626400	000001		TRZN	T3,STDWAG	;DATA WRITE AGAIN SET?
   996	001070'	254000	001075'		JRST	FNPCW4		;NO.
   997				      ;HERE ON HAVE TO RE-WRITE IT.
   998	001071'	137400	000010'		DPB	T3,PCISTS	;YES, STORE THE STATUS.
   999	001072'	201440	000001		MOVEI	T4,1		;FLAG GOING OUT.
  1000	001073'	260040	001013'		PUSHJ	P,PPCBIO		;REQ TRANSFER (EXPECTS T2&T4).
  1001	001074'	263040	000000		POPJ	P,
  1002				      ;HERE ON HAVE TO READ IT, OR DONE.
  1003	001075'	620400	000002	FNPCW4:	TRZ	T3,STDWRT	;CLEAR DATA WRITE.
  1004	001076'	622400	000020		TRZE	T3,STDDRF	;CLEAR DIRTY MONITOR FLAG, AND IF IT WAS ON,
  1005	001077'	370000	002435'		SOS	PCDCNT		;DECREMENT THE COUNT.
  1006	001100'	137400	000010'		DPB	T3,PCISTS	;STORE THE STATUS.
  1007	001101'	602400	000004		TRNE	T3,STDREA	;IS DATA READ SET?
  1008					JRST	[SETZ	T4,
  1009	001102'	254000	002544'			PJRST PPCBIO]	;REQUEST THE TRANSFER.
  1010	001103'	260040	001126'		PUSHJ	P,RSTWAI 	;TAKE WAITERS OUT OF Q.
  1011	001104'	322440	001047*		JUMPE	T4,CPOPJ	;JUMP IF ONCE TIME.
  1012	001105'	261040	000003		PUSH	P,PG		;SAVE PG.
  1013	001106'	260040	002105'		PUSHJ	P,CTLFND	;SET UP PG/ CNTL BLK ADDR.
  1014	001107'	200303	000005	FNPCRU:	MOVE	T1,%CTLRU(PG)	;IS THIS
  1015	001110'	336006	000000	FNDCR0:	SKIPN	(T1)		;PCB ON
  1016	001111'	254000	001124'		 JRST	FNPCOT		;THE LRU
  1017	001112'	312346	000000		CAME	T2,(T1)		;MRU
  1018	001113'	344300	001110'		 AOJA	T1,FNDCR0	;LIST?
  1019	001114'	302140	000035'		CAIE	PG,%SAT.C	;YES, IS IT A SAT?
  1020	001115'	254000	001122'		 JRST	FNPC45		;NO.
  1021	001116'	200141	000000		MOVE	PG,(P)		;YES, IS IT
  1022	001117'	135300	000700*		LDB	T1,PGYDRT	;DIRTY?
  1023	001120'	326300	001124'		JUMPN	T1,FNPCOT	;JUMP ON YES (WILL NEED WRITING).
  1024	001121'	201140	000035'		MOVEI	PG,%SAT.C	;
  1025	001122'	371023	000007	FNPC45:	SOSL	@%CTWRQ(PG)	;YES, MARK IT
  1026	001123'	370023	000010		SOS	@%CTWVL(PG)	;AS A RESOURCE NOW.
  1027	001124'	262040	000003	FNPCOT:	POP	P,PG		;RESTORE PG.
  1028	001125'	263040	000000		POPJ	P,		;RETURN.
  1029
  1030
  1031
  1032
  1033				      ;LITTLE SUBR TO RESTART WAITERS.
  1034				      ;EXITS WITH T4<>0 IF THIS IS NOT ONCE-TIME.
  1035	001126'	336440	001141'	RSTWAI:	SKIPN	T4,ONCTIM	;ONCE TIME?
  1036	001127'	263040	000000		POPJ	P,		;YES, NOTHING ELSE TO DO.
  1037	001130'	261040	000007		PUSH	P,T2		;SAVE T2.
  1038	001131'	261040	000002		PUSH	P,J		;SAVE J FROM PAGWAK.
  1039	001132'	400340	000000		SETZ	T2,		;
  1040	001133'	137340	000000*		DPB	T2,PGYSIO	;
  1041	001134'	260040	000000*		PUSHJ	P,PAGWAK	;WAKE ALL WAITERS FOR THIS PAGE.
  1042	001135'	262040	000002		POP	P,J		;RESTORE J.
  1043	001136'	262040	000007		POP	P,T2		;RESTORE T2.
  1044	001137'	200440	001141'		MOVE	T4,ONCTIM	;RETURN T4/ SYSTEM TIME.
  1045	001140'	263040	000000		POPJ	P,
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 17-3
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1046
  1047				INTERN ONCTIM
  1048	001141'	000000	000000	ONCTIM:	Z			;FLAG FOR FINPCB, ITS ONCE TIME.
  1049
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 18
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1050				COMMENT #
  1051				@@SUBROUTINE WATPCB
  1052				@@PURPOSE
  1053				SUBR CALLED AT OUTPUT CLOSE, TO WAIT FOR ALL THE RIB PCBS WITH
  1054				WRITE IN PROGRESS TO FINISH UP, SO WE CAN BE SURE ALL THE RIBS,
  1055				ETC., HAVE BEEN WRITTEN.
  1056				@@ENTRY
  1057				EXPECTS F/ DDB.
  1058				@@ACCUM
  1059				DESTROYS T1-T4, AND PG.
  1060				@@#
  1061
  1062				INTERN WATPCB
  1063
  1064				    ;HERE TO FIND THE PCBS TO WAIT FOR.
  1065	001142'	400440	000000	WATPCB:	SETZ	T4,		;T4/ COUNT OF PCBS TO WAIT FOR.
  1066	001143'	201140	000013'		MOVEI	PG,%RIB.C	;GET T2/ ADDR OF
  1067	001144'	260040	001215'		PUSHJ	P,FNDPRM	;1ST PRIMARY PCB.
  1068	001145'	700600	000675*		DSKOFF
  1069	001146'	135300	000010'	WATPC2:	LDB	T1,PCISTS	;IS THIS PCB IN THE
  1070	001147'	606300	000003		TRNN	T1,STDWRT!STDWAG ;PROCESS OF WRITING OUT?
  1071	001150'	254000	001161'		JRST	WATPC4		;NO, IGNORE IT.
  1072	001151'	554407	000001		HLRZ	T3,PCBTIM(T2)	;YES, GET ITS CLOCK, AND
  1073	001152'	606300	000001		TRNN	T1,STDWAG	;ADJUST IT FOR THE NUMBER OF
  1074	001153'	344400	001155'		AOJA	T3,.+2		;WRITES WE HAVE TO WAIT FOR
  1075	001154'	271400	000002		ADDI	T3,2		;TO BE SURE OUR DATA IS OUT
  1076	001155'	551410	000000		HRRZI	T3,(T3)		;ON THE DISK.
  1077	001156'	261040	000010		PUSH	P,T3		;SAVE CLOCK.
  1078	001157'	261040	000007		PUSH	P,T2		;SAVE PCB ADDR.  COUNT THIS
  1079	001160'	344440	001161'		AOJA	T4,.+1		;PCB AND LOOK FOR MORE.
  1080	001161'	550347	000003	WATPC4:	HRRZ	T2,PCBLNK(T2)	;GET NEXT PCB.
  1081	001162'	326340	001146'		JUMPN	T2,WATPC2	;JUMP IF ANOTHER.
  1082	001163'	322440	001203'		JUMPE	T4,WATOUT	;DONE IF NONE OF INTEREST SEEN.
  1083
  1084				    ;HERE TO WAIT FOR THE PCBS.
  1085	001164'	700600	000711*	WATPC5:	DSKON
  1086	001165'	261040	000011		PUSH	P,T4		;SAVE COUNT.
  1087	001166'	200341	777777		MOVE	T2,-1(P)	;T2/ PCB ON TOP OF THE STACK.
  1088	001167'	261040	000003		PUSH	P,PG		;SAVE PG AND
  1089	001170'	261040	000002		PUSH	P,J		;J FROM PAGWAT.
  1090	001171'	554147	000003		HLRZ	PG,PCBPAG(T2)	;ARGS FOR
  1091	001172'	200100	000610*		MOVE	J,JOB		;PAGWAT.
  1092	001173'	260040	000000*		PUSHJ	P,PAGWAT	;WAIT FOR PCB ON TOP OF STACK.
  1093	001174'	262040	000002		POP	P,J		;RESTORE PG
  1094	001175'	262040	000003		POP	P,PG		;AND J.
  1095
  1096				    ;HERE TO SEE IF ANY PCBS LEFT TO WAIT FOR.
  1097	001176'	262040	000011		POP	P,T4		;RESTORE COUNT OF PCBS.
  1098	001177'	700600	001145*		DSKOFF
  1099	001200'	262040	000006	WATPC6:	POP	P,T1		;FORGET THIS
  1100	001201'	262040	000006		POP	P,T1		;PCB.
  1101	001202'	367440	001205'		SOJG	T4,WATPC7	;ANY PCBS LEFT TO WORRY ABOUT?
  1102	001203'	700600	001164*	WATOUT:	DSKON
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 18-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1103	001204'	263040	000000		POPJ	P,		;NO, DONE.
  1104	001205'	200341	000000	WATPC7:	MOVE	T2,(P)		;GET T2/ A PCB ADDR.
  1105	001206'	554307	000001		HLRZ	T1,PCBTIM(T2)	;GET
  1106	001207'	274301	777777		SUB	T1,-1(P)	;DIFFERENCE.
  1107	001210'	214400	000006		MOVM	T3,T1		;IF > "POSSIBLE", THEN ONE OF US
  1108	001211'	307400	400000		CAIG	T3,400000	;AT LEAST WENT AROUND TOP.
  1109	001212'	213000	000006		MOVNS	T1		;NO.
  1110	001213'	327300	001164'		JUMPG	T1,WATPC5	;YES, JUMP ON PCB STILL BEHIND.
  1111	001214'	254000	001200'		JRST	WATPC6		;JUMP ON THIS PCB DONE.
  1112
  1113
  1114
  1115
  1116				COMMENT #
  1117				@@SUBROUTINE FNDPRM
  1118				@@PURPOSE
  1119				SUBR TO FIND THE ADDRESS OF THE FIRST PRIMARY PCB.
  1120				@@ENTRY
  1121				EXPECTS PG/ CONTROL BLOCK ADDRESS.
  1122				@@ACCUM
  1123				DESTROYS T1 AND T2.
  1124				@@EXIT
  1125				RETURNS PCB ADDR IN T2.
  1126				@@ #
  1127
  1128	001215'	550343	000001	FNDPRM:	HRRZ	T2,%CTLST(PG)	;
  1129	001216'	554307	000003	FNDPR0:	HLRZ	T1,PCBPAG(T2)	;
  1130	001217'	326300	001104*		JUMPN	T1,CPOPJ	;
  1131	001220'	550347	000003		HRRZ	T2,PCBLNK(T2)	;
  1132	001221'	326340	001216'		JUMPN	T2,FNDPR0	;
  1133	001222'	256000	000000'		 STOPCD                         ;;FNDPRM+5
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 19
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1134				COMMENT #
  1135				@@SUBROUTINE GETLRU/GETLRS
  1136				@@PURPOSE
  1137				SUBROUTINE TO GET THE LRU FREE PRIMARY PCB WITH NO IO IN PROGRESS.
  1138				@@ENTRY
  1139				EXPECTS PG/ CONTROL BLOCK ADDR.
  1140				@@EXIT
  1141				IF NONE WITH NO IO IN PROGRESS, RETURNS.
  1142				IF SUCCESSFUL, SKIP RETURNS WITH T2/LRU AND CLEARS DATA PRESENT.
  1143				GETLRU ALSO REMOVES THE PCB FROM THE LIST OF FREE PRIMARY PCBS
  1144				ACCCORDING TO USE.
  1145				@@ACCUM
  1146				DESTROYS T2 AND T3.
  1147				@@ #
  1148
  1149				INTERN GETLRS
  1150	001223'	261040	000005	GETLRS:	PUSH	P,U		;SAVE U.
  1151	001224'	400240	000000		SETZ	U,		;FLAG THIS IS SWAPPER ASKING.
  1152	001225'	254000	001230'		JRST	.+3
  1153	001226'	261040	000005	GETLRU:	PUSH	P,U		;SAVE U.
  1154	001227'	474240	000000		SETO	U,		;FLAG THIS IS NORMAL.
  1155	001230'	336363	000005		SKIPN	T2,@%CTLRU(PG)	;BETTER BE A FREE PCB.
  1156	001231'	256000	000000'		 STOPCD                         ;;GETLRU+3
  1157	001232'	261040	000011		PUSH	P,T4		;SAVE T4.
  1158	001233'	200403	000005		MOVE	T3,%CTLRU(PG)	;T3/ ADDRESS INTO LIST.
  1159	001234'	336350	000000	GETLR1:	SKIPN	T2,(T3)		;T2/ NEXT LRU PCB.
  1160	001235'	256000	000000'		 STOPCD                         ;;GETLR1+1
  1161	001236'	135440	000010'		LDB	T4,PCISTS	;IS IO IN PROGRESS FOR THIS
  1162	001237'	606440	000007		TRNN	T4,STDWRT!STDWAG!STDREA ;PCB?
  1163	001240'	254000	001247'		JRST	GETLR2		;NO, MAYBE OKAY.
  1164	001241'	271400	000001	GETL15:	ADDI	T3,1		;YES, TRY NEXT.
  1165	001242'	315403	000006		CAMGE	T3,%CTMRU(PG)	;OUT OF LIST?
  1166	001243'	254000	001234'		JRST	GETLR1		;NO, CONTINUE.
  1167	001244'	262040	000011		POP	P,T4
  1168	001245'	262040	000005		POP	P,U		;
  1169	001246'	263040	000000		POPJ	P,
  1170
  1171	001247'	302140	000035'	GETLR2:	CAIE	PG,%SAT.C	;IF THIS IS A SAT,
  1172	001250'	254000	001265'		JRST	GETLR7		;IT MAY NEED
  1173	001251'	554147	000003		HLRZ	PG,PCBPAG(T2)	;WRITING
  1174	001252'	135440	001117*		LDB	T4,PGYDRT	;OUT.
  1175	001253'	322440	001264'		JUMPE	T4,GETLR6	;
  1176	001254'	261040	000010		PUSH	P,T3		;
  1177	001255'	261040	000006		PUSH	P,T1		;
  1178	001256'	261040	002546'		PUSH	P,[GETLR5]	;RETURN ADDRESS.
  1179	001257'	261040	002547'		PUSH	P,[%SAT.C]	;
  1180	001260'	254000	000675'		JRST	MAPRL7		;
  1181	001261'	262040	000006	GETLR5:	POP	P,T1		;
  1182	001262'	262040	000010		POP	P,T3		;
  1183	001263'	254000	001241'		JRST	GETL15		;
  1184
  1185				    ;HERE WITH A GOOD PCB.
  1186	001264'	201140	000035'	GETLR6:	MOVEI	PG,%SAT.C	;
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 19-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1187	001265'	261040	000010	GETLR7:	PUSH	P,T3		;SAVE LOC IN LRU LIST.
  1188	001266'	306140	000035'		CAIN	PG,%SAT.C	;
  1189	001267'	260040	001345'		PUSHJ	P,CLRYNC	;CLEAR STYINC.
  1190	001270'	357023	000007		AOSG	@%CTWRQ(PG)	;
  1191	001271'	254000	001274'		JRST	GETLR9		;
  1192	001272'	332023	000010		SKIPE	@%CTWVL(PG)	;
  1193	001273'	350023	000010		AOS	@%CTWVL(PG)	;
  1194	001274'	700600	001177*	GETLR9:	DSKOFF
  1195	001275'	135400	000010'		LDB	T3,PCISTS	;CLEAR
  1196	001276'	620400	000010		TRZ	T3,STDPRE	;DATA
  1197	001277'	137400	000010'		DPB	T3,PCISTS	;PRESENT.
  1198	001300'	250301	000000		EXCH	T1,(P)		;GET THIS PCB OFF THE
  1199	001301'	322240	001303'		JUMPE	U,.+2		;
  1200	001302'	260040	001332'		PUSHJ	P,GETTR2	;LRU LIST  AND
  1201	001303'	262040	000006		POP	P,T1		;ADJUST %CTMRU.
  1202	001304'	262040	000011		POP	P,T4		;RESTORE T4.
  1203	001305'	262040	000005		POP	P,U		;
  1204	001306'	254000	000563*		JRST	CPOPJ1
  1205
  1206
  1207
  1208				COMMENT #
  1209				@@SUBROUTINE GETTRU
  1210				@@PURPOSE
  1211				SUBROUTINE TO REMOVE A SPECIFIC PCB FROM THE LRU/MRU LIST.
  1212				@@ENTRY
  1213				EXPECTS T2/ PCB ADDRESS AND PG/ CONTROL BLOCK ADDRESS.
  1214				@@ACCUM
  1215				DESTROYS T1, T3, AND T4.
  1216				@@ #
  1217
  1218	001307'	700600	001274*	GETTRU:	DSKOFF
  1219	001310'	135300	000010'		LDB	T1,PCISTS	;
  1220	001311'	602300	000007		TRNE	T1,STDWRT!STDWAG!STDREA
  1221	001312'	254000	001325'		JRST	GETTR1		;
  1222	001313'	302140	000035'		CAIE	PG,%SAT.C	;
  1223	001314'	254000	001321'		JRST	GETTR0		;
  1224	001315'	554147	000003		HLRZ	PG,PCBPAG(T2)	;
  1225	001316'	135300	001252*		LDB	T1,PGYDRT	;
  1226	001317'	201140	000035'		MOVEI	PG,%SAT.C	;
  1227	001320'	326300	001325'		JUMPN	T1,GETTR1	;
  1228	001321'	357023	000007	GETTR0:	AOSG	@%CTWRQ(PG)	;
  1229	001322'	254000	001325'		JRST	GETTR1		;
  1230	001323'	332023	000010		SKIPE	@%CTWVL(PG)	;
  1231	001324'	350023	000010		AOS	@%CTWVL(PG)	;
  1232	001325'	200303	000005	GETTR1:	MOVE	T1,%CTLRU(PG)	;GET T1/ ADDR OF TOP OF LIST.
  1233	001326'	336006	000000	GETTRA:	SKIPN	(T1)		;FAIL IF EO LIST.
  1234	001327'	256000	002550'		 STOPCD (.,STOP,GETTR3,,<End of list detected at GETTR1+2>)
  1235	001330'	312346	000000		CAME	T2,(T1)		;FOUND IT?
  1236	001331'	344300	001326'		 AOJA	T1,GETTRA	;NO, CONTINUE.
  1237	001332'	200406	000001	GETTR2:	MOVE	T3,1(T1)	;YES,  MOVE UP THE REST
  1238	001333'	202406	000000		MOVEM	T3,(T1)		;OF THE
  1239	001334'	332006	000001		SKIPE	1(T1)		;
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 19-3
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1240	001335'	344300	001332'		AOJA	T1,GETTR2	;LIST.
  1241	001336'	370003	000006		SOS	%CTMRU(PG)	;DECREMENT
  1242	001337'	306140	000013'		CAIN	PG,%RIB.C	;%CTMRU.
  1243	001340'	370000	000032'		SOS	%CTMRU+%RB2.C	;
  1244	001341'	306140	000024'		CAIN	PG,%RB2.C	;
  1245	001342'	370000	000021'		SOS	%CTMRU+%RIB.C	;
  1246	001343'	700600	001203*		DSKON
  1247	001344'	263040	000000		POPJ	P,
  1248
  1249				    ;LITTLE SUBR CALLED BY GETLRU TO CLEAR STYINC.
  1250	001345'	261040	000007	CLRYNC:	PUSH	P,T2		;SAVE T2.
  1251	001346'	336347	000000		SKIPN	T2,PCBPTR(T2)	;CLR STYINC ONLY IF WAS IS CORE.
  1252	001347'	254000	001357'		JRST	CLROUT		;WASN'T.
  1253	001350'	261040	000006		PUSH	P,T1		;SAVE T1 FROM GSATST.
  1254	001351'	261040	000005		PUSH	P,U		;
  1255	001352'	260040	001056*		PUSHJ	P,GSATST	;GET T2/ STT ENTRY ADDRESS.
  1256	001353'	262040	000005		POP	P,U		;
  1257	001354'	262040	000006		POP	P,T1		;RESTORE T1.
  1258	001355'	515400	000000*		HRLZI	T3,STPINC!STPCHK ;CLEAR STPINC AND
  1259	001356'	412407	000000*		ANDCAM	T3,STTSTS(T2)	;STPCHK.
  1260	001357'	262040	000007	CLROUT:	POP	P,T2		;RESTORE T2.
  1261	001360'	263040	000000		POPJ	P,		;
  1262
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 20
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1263				COMMENT #
  1264				@@SUBROUTINE RESLRU
  1265				@@PURPOSE
  1266				SUBROUTINE TO PUT A PCB ON THE LIST AS THE LRU PCB.
  1267				@@ENTRY
  1268				EXPECTS PG/ CONTROL BLOCK ADDR AND T2/ PCB ADDRESS.
  1269				@@ACCUM
  1270				DESTROYS NO ACS.
  1271				@@ #
  1272
  1273	001361'	261040	000006	RESLRU:	PUSH	P,T1		;SAVE T1
  1274	001362'	261040	000010		PUSH	P,T3		;AND T3
  1275	001363'	261040	000011		PUSH	P,T4		;AND T4.
  1276	001364'	200403	000006		MOVE	T3,%CTMRU(PG)	;T3/ ADDR OF END OF LIST.
  1277	001365'	201310	000000		MOVEI	T1,(T3)		;T1/ NO. OF ITEMS-1
  1278	001366'	274303	000005		SUB	T1,%CTLRU(PG)	;ON THE LIST.
  1279	001367'	200450	000000	RESLR2:	MOVE	T4,(T3)		;MOVE FROM X
  1280	001370'	202450	000001		MOVEM	T4,1(T3)	;TO X+1.
  1281	001371'	360400	001372'		SOJ	T3,.+1		;BACK UP POINTER.
  1282	001372'	365300	001367'		SOJGE	T1,RESLR2	;DONE?
  1283	001373'	202350	000001		MOVEM	T2,1(T3)	;STORE LRU PCB.
  1284	001374'	262040	000011		POP	P,T4		;YES, RESTORE
  1285	001375'	262040	000010		POP	P,T3		;T4 AND T3
  1286	001376'	262040	000006		POP	P,T1		;AND T1.
  1287	001377'	350003	000006	INCMRU:	AOS	%CTMRU(PG)	;
  1288	001400'	306140	000013'		CAIN	PG,%RIB.C	;
  1289	001401'	350000	000032'		AOS	%CTMRU+%RB2.C	;
  1290	001402'	306140	000024'		CAIN	PG,%RB2.C	;
  1291	001403'	350000	000021'		AOS	%CTMRU+%RIB.C	;
  1292	001404'	263040	000000		POPJ	P,
  1293	
  1294
  1295
  1296				COMMENT #
  1297				@@SUBROUTINE RESMRU
  1298				@@PURPOSE
  1299				SUBROUTINE TO PUT A PCB ON THE LIST AS THE MRU PCB.
  1300				@@ENTRY
  1301				EXPECTS PG/ CONTROL BLOCK ADDRESS AND T2/ PCB ADDRESS.
  1302				@@ACCUM
  1303				DESTROYS NO ACS.
  1304				@@ #
  1305
  1306	001405'	202363	000006	RESMRU:	MOVEM	T2,@%CTMRU(PG)	;STORE THRU THE POINTER.
  1307	001406'	324740	001377'		PJRST	INCMRU		;
  1308
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 21
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1309				COMMENT #
  1310				@@SUBROUTINE SETPCB
  1311				@@PURPOSE
  1312				SUBROUTINE TO SET UP THE 2ND AND 3RD LOCS IN A PCB SPECIFIED BY
  1313				T2, USING THE STATUS SAVED IN P1.
  1314				N.B., ORS THE STATUS INTO THE PCB.
  1315				@@ENTRY
  1316				SEE PURPOSE.
  1317				@@ACCUM
  1318				DESTROYS T1 AND T3.
  1319				@@ #
  1320
  1321	001407'	513007	000001	SETPCB:	HLLZS	PCBLKQ(T2)	;LOCK QUEUE = 0.
  1322	001410'	201300	000001		MOVEI	T1,1		;ONE
  1323	001411'	542307	000002		HRRM	T1,PCBUSC(T2)	;USER.
  1324	001412'	305600	000002		CAIGE	P1,STALOK	;LOCKED?
  1325	001413'	634300	000006		TDZA	T1,T1		;NO, LOCK COUNT=0.
  1326	001414'	201300	000001		MOVEI	T1,1		;YES, LOCK COUNT=1.
  1327	001415'	137300	000011'		DPB	T1,PCYLCC	;SET LOCK COUNT TO 0 OR 1.
  1328	001416'	135400	000007'		LDB	T3,PCUSTS	;SET PCUSTS TO
  1329	001417'	434414	000054'		IOR	T3,CODBTS(P1)	;INCLUDE OUR
  1330	001420'	137400	000007'		DPB	T3,PCUSTS	;BITS.
  1331	001421'	263040	000000		POPJ	P,
  1332
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 22
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1333				COMMENT #
  1334				@@SUBROUTINE UNLNK2
  1335				@@PURPOSE
  1336				SUBROUTINE TO REMOVE A SECONDARY PCB FROM THE LIST OF
  1337				PCBS.
  1338				@@ENTRY
  1339				EXPECTS T1/ADDR OF 2NDARY PCB AND PG/CONTROL BLOCK ADDR.
  1340				@@ #
  1341
  1342	001422'	261040	000007	UNLNK2:	PUSH	P,T2		;SAVE T2
  1343	001423'	261040	000010		PUSH	P,T3		;AND T3.
  1344	001424'	400400	000000		SETZ	T3,		;T3 HAS PREVIOUS PCB TO OURS.
  1345	001425'	550343	000001		HRRZ	T2,%CTLST(PG)	;GET 1ST PCB IN LIST.
  1346	001426'	306346	000000	UNLNK3:	CAIN	T2,(T1)		;OURS?
  1347	001427'	254000	001434'		JRST	UNLNK5		;YES.
  1348	001430'	201407	000000		MOVEI	T3,(T2)		;NO.
  1349	001431'	550347	000003		HRRZ	T2,PCBLNK(T2)	;GET NEXT.
  1350	001432'	326340	001426'		JUMPN	T2,UNLNK3	;CONTINUE.
  1351	001433'	256000	000000'		 STOPCD                         ;;UNLNK3+5
  1352	001434'	550347	000003	UNLNK5:	HRRZ	T2,PCBLNK(T2)	;GET NEXT PCB IN LIST.
  1353	001435'	326400	001440'		JUMPN	T3,.+3		;JUMP IF IN MIDDLE OF LIST.
  1354	001436'	542343	000001		HRRM	T2,%CTLST(PG)	;OURS WAS FIRST IN LIST.
  1355	001437'	254000	001441'		JRST	.+2		;GO RETURN.
  1356	001440'	542350	000003		HRRM	T2,PCBLNK(T3)	;OURS WAS IN MIDDLE OF LIST.
  1357	001441'	262040	000010		POP	P,T3		;RESTORE T3
  1358	001442'	262040	000007		POP	P,T2		;AND T2.
  1359	001443'	263040	000000		POPJ	P,
  1360
  1361
  1362				COMMENT #
  1363				@@SUBROUTINE LINKPB
  1364				@@PURPOSE
  1365				SUBROUTINE TO LINK A SECONDARY PCB INTO THE LIST OF PCBS.
  1366				@@ENTRY;
  1367				EXPECTS T2/ADDR OF THE 2NDARY PCB AND PG/ADDR OF CONTROL BLK.
  1368				@@ACCUM
  1369				DESTROYS T1.
  1370				@@ #
  1371
  1372	001444'	550303	000001	LINKPB:	HRRZ	T1,%CTLST(PG)	;T1/ ADDR OF 1ST PCB IN LIST.
  1373	001445'	542307	000003		HRRM	T1,PCBLNK(T2)	;POINT US TO IT.
  1374	001446'	542343	000001		HRRM	T2,%CTLST(PG)	;POINT THE LIST HEADER TO US.
  1375	001447'	263040	000000		POPJ	P,
  1376
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 23
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1377				COMMENT #
  1378				@@SUBROUTINE ENLOKQ
  1379				@@PURPOSE
  1380				SUBR TO ADD A JOB(S) AT THE END OF THE LOCK QUEUE FOR THE PCB
  1381				SPECIFIED BY T2.
  1382				@@ENTRY
  1383				EXPECTS J/ NO. AND P1/ STATUS OF THE JOB TO ADD.
  1384				@@ACCUM
  1385				DESTROYS T3 AND T4. @@#
  1386
  1387	001450'	550447	000001	ENLOKQ:	HRRZ	T4,PCBLKQ(T2)	;ANY JOB IN THE
  1388	001451'	326440	001457'		JUMPN	T4,ENLOK2	;LOCK QUEUE YET?
  1389	001452'	542107	000001		HRRM	J,PCBLKQ(T2)	;NO, EASY TO
  1390	001453'	506342	000557*		HRLM	T2,QUEPCB(J)	;ADD US.
  1391	001454'	435600	001000		ORI	P1,STQPCB	;
  1392	001455'	137600	000063'		DPB	P1,QUYPCS	;
  1393	001456'	263040	000000		POPJ	P,
  1394
  1395	001457'	250440	000002	ENLOK2:	EXCH	T4,J		;YES, SEARCH AHEAD
  1396	001460'	135400	000064'	ENLOK3:	LDB	T3,QUYPCN	;AND
  1397	001461'	322400	001464'		JUMPE	T3,ENLOK4	;FIND
  1398	001462'	550100	000010		HRRZ	J,T3		;THE
  1399	001463'	254000	001460'		JRST	ENLOK3		;LAST JOB IN THE QUEUE.
  1400
  1401	001464'	137440	000064'	ENLOK4:	DPB	T4,QUYPCN	;POINT IT TO US.
  1402	001465'	250100	000011		EXCH	J,T4		;POINT US TO
  1403	001466'	135400	000064'		LDB	T3,QUYPCN	;
  1404	001467'	402002	001453*		SETZM	QUEPCB(J)	;
  1405	001470'	137440	000062'		DPB	T4,QUYPCP	;
  1406	001471'	137600	000063'		DPB	P1,QUYPCS	;
  1407	001472'	137400	000064'		DPB	T3,QUYPCN	;
  1408	001473'	263040	000000		POPJ	P,
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 24
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1409				COMMENT #
  1410				@@SUBROUTINE UNLOKQ
  1411				@@PURPOSE
  1412				SUBR TO REMOVE A JOB FROM A PCB LOCK QUEUE.
  1413				@@ENTRY
  1414				EXPECTS J/ JOB NO.
  1415				@@ACCUM
  1416				DESTROYS T4.  SETS T2 TO PCB ADDRESS.
  1417				@@ #
  1418
  1419	001474'	261040	000006	UNLOKQ:	PUSH	P,T1		;SAVE T1.
  1420	001475'	135300	000064'		LDB	T1,QUYPCN	;T1/ NO. OF NEXT JOB.
  1421	001476'	135440	000063'		LDB	T4,QUYPCS	;T4/ OUR REQ STATUS.
  1422	001477'	326300	001513'		JUMPN	T1,UNLOK2	;
  1423
  1424				    ;HERE ON NO NEXT JOB.
  1425	001500'	606440	001000		TRNN	T4,STQPCB	;IS OUR PREV THE PCB?
  1426	001501'	254000	001505'		JRST	UNLOK1		;NO.
  1427	001502'	554342	001467*		HLRZ	T2,QUEPCB(J)	;
  1428	001503'	513007	000001		HLLZS	PCBLKQ(T2)	;YES--JUST SET THE LOK Q TO 0.
  1429	001504'	254000	001511'		JRST	UNLKO2		;
  1430	001505'	135440	000062'	UNLOK1:	LDB	T4,QUYPCP	;T4/ NO. OF PREV JOB.
  1431	001506'	250100	000011		EXCH	J,T4		;POINT PREV
  1432	001507'	137300	000064'		DPB	T1,QUYPCN	;TO
  1433	001510'	200100	000011		MOVE	J,T4		;NEXT.
  1434	001511'	262040	000006	UNLKO2:	POP	P,T1		;
  1435	001512'	263040	000000		POPJ	P,
  1436
  1437				    ;HERE ON A NEXT JOB EXISTS.
  1438	001513'	606440	001000	UNLOK2:	TRNN	T4,STQPCB	;PREV "JOB" IS PCB?
  1439	001514'	254000	001526'		JRST	UNLOK4		;NO.
  1440	001515'	554342	001502*		HLRZ	T2,QUEPCB(J)	;
  1441	001516'	542307	000001		HRRM	T1,PCBLKQ(T2)	;YES. POINT PCB TO NEXT JOB.
  1442	001517'	250100	000006		EXCH	J,T1		;POINT
  1443	001520'	506342	001515*		HRLM	T2,QUEPCB(J)	;NEXT JOB
  1444	001521'	135440	000063'		LDB	T4,QUYPCS	;BACK
  1445	001522'	660440	001000		TRO	T4,STQPCB	;TO
  1446	001523'	137440	000063'		DPB	T4,QUYPCS	;THE
  1447	001524'	200100	000006		MOVE	J,T1		;PCB.
  1448	001525'	254000	001511'		JRST	UNLKO2		;
  1449	001526'	135440	000062'	UNLOK4:	LDB	T4,QUYPCP	;T4/ NO. OF PREV JOB.
  1450	001527'	261040	000002		PUSH	P,J		;POINT NEXT
  1451	001530'	200100	000006		MOVE	J,T1		;BACK TO
  1452	001531'	137440	000062'		DPB	T4,QUYPCP	;PREVIOUS, AND
  1453	001532'	200100	000011		MOVE	J,T4		;PREVIOUS AHEAD
  1454	001533'	137300	000064'		DPB	T1,QUYPCN	;TO
  1455	001534'	262040	000002		POP	P,J		;NEXT.
  1456	001535'	254000	001511'		JRST	UNLKO2		;
  1457
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 25
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1458				COMMENT #
  1459				@@SUBROUTINE CHKSTS/CHKST0
  1460				@@PURPOSE
  1461				SUBR CALLED BY THE PCB ROUTINES TO CHECK THE STATUS OF THE
  1462				REQUEST AGAINST THE STATUS OF THE PCB.  IF OKAY TO START THE
  1463				REQUEST, POSSIBLY THE LOCK COUNT IN T3 IS INCED, THE USE
  1464				COUNT IS INCED, AND THE PCB STATUS IN T1 IS UPDATED.
  1465				@@ENTRY
  1466				EXPECTS T1/PCUSTS, T2/PCB ADDRESS, T3/PCBLCC, AND T4/REQ
  1467				STATUS.
  1468				ENTRY POINT CHKSTS EXPECTS A LOCK REQUEST AND THE PCB TO NOT
  1469				BE CMPL.  ENTRY POINT CHKST0 DOES NOT HAVE THESE RESTRICTIONS.
  1470				@@ACCUM
  1471				DESTROYS T4.
  1472				@@EXIT
  1473				RETURNS CPOPJ1 IF CANNOT START REQUEST, ELSE CPOPJ.
  1474				@@ #
  1475
  1476	001536'	602300	000002	CHKST0:	TRNE	T1,STCMPL	;NO SENSE TRYING IF PCB IS
  1477	001537'	254000	001306*		JRST	CPOPJ1		;ALREADY COMPLETELY LOCKED.
  1478	001540'	305440	000002		CAIGE	T4,STALOK	;REQ TO LOCK?
  1479	001541'	254000	001562'		JRST	CHKNSK		;NO.
  1480
  1481	001542'	302440	000004	CHKSTS:	CAIE	T4,STARDL 	;YES, TO READ LOCKED?
  1482	001543'	254000	001547'		JRST	CHKST4		;NO.
  1483	001544'	602300	000004		TRNE	T1,STWRTL	;YES,  CAN WE?
  1484	001545'	254000	001537*		JRST	CPOPJ1		;NO.
  1485	001546'	344400	001562'		AOJA	T3,CHKNSK	;YES, INC LOCK COUNT.
  1486	001547'	302440	000003	CHKST4:	CAIE	T4,STAWTL	;WRITE LOCKED
  1487	001550'	306440	000005		CAIN	T4,STAWLN	;OR
  1488	001551'	254000	001553'		JRST	.+2		;WRITE LOCK NEW?
  1489	001552'	254000	001556'		JRST	CHKST5		;NO, MUST BE CML LOK.
  1490	001553'	326400	001545*		JUMPN	T3,CPOPJ1	;CAN'T W LOCK UNLESS LOC CT=0.
  1491	001554'	660300	000004		TRO	T1,STWRTL	;CAN, MARK IT.
  1492	001555'	344400	001562'		AOJA	T3,CHKNSK	;INC LOCK COUNT.
  1493	001556'	550447	000002	CHKST5:	HRRZ	T4,PCBUSC(T2)	;CML LOCKED.  USE COUNT=
  1494	001557'	326440	001553*		JUMPN	T4,CPOPJ1	;0?  IF NOT, CAN'T CM LOCK.
  1495	001560'	660300	000002		TRO	T1,STCMPL	;CAN, MARK IT.
  1496	001561'	340400	001562'		AOJ	T3,.+1		;INC THE LOCK COUNT.
  1497	001562'	350007	000002	CHKNSK:	AOS	PCBUSC(T2)	;INC THE USE COUNT.
  1498	001563'	263040	000000		POPJ	P,
  1499
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 26
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1500				COMMENT #
  1501				@@SUBROUTINE STUPLQ
  1502				@@PURPOSE
  1503				STARTS UP SOME JOBS WAITING IN THE LOCK QUEUE.
  1504				CANNOT START ANY JOB WHICH WOULD PREVENT A NON-STARTED JOB
  1505				AHEAD OF IT FROM RUNNING IF IT WANTED TO.
  1506				@@ENTRY
  1507				EXPECTS T1/PCUSTS, T2/PCB ADDRESS, T3/PCBLCC, AND J/NO. OF
  1508				FIRST JOB TO LOOK AT.
  1509				@@ACCUM
  1510				DESTROYS T4 AND J.
  1511				@@CALLS
  1512				CHKSTS, SETRUN, AND UNLOKQ.
  1513				@@ #
  1514
  1515	001564'	602300	000002	STUPLQ:	TRNE	T1,STCMPL	;NOTHING TO DO IF THE PCB IS
  1516	001565'	263040	000000		POPJ	P,		;COMPLETELY LOCKED.
  1517	001566'	261040	000015		PUSH	P,P2		;SAVE P2.  WILL BE FLAG THAT WE
  1518	001567'	400640	000000		SETZ	P2,		;HAVEN'T SEEN JOB WE
  1519	001570'	254000	001573'		JRST	STUPL3		;CAN'T START.
  1520	001571'	135100	000064'	STUPL2:	LDB	J,QUYPCN	;CONTINUE IF THERE IS ANOTHER
  1521	001572'	322100	001633'		JUMPE	J,STUPND	;JOB IN THE PCB'S LOK QUEUE.
  1522	001573'	135440	000063'	STUPL3:	LDB	T4,QUYPCS	;T4/ REQ STATUS.
  1523	001574'	620440	001000		TRZ	T4,STQPCB	;
  1524	001575'	305440	000002		CAIGE	T4,STALOK	;REQ LOCKED?
  1525	001576'	254000	001612'		JRST	STUPL6		;NO.
  1526	001577'	322640	001603'		JUMPE	P2,STUPL4	;REQ IS LOKED, CAN'T START IT IF
  1527	001600'	306600	000002		CAIN	P1,STACML	;ALREADY SEEN JOB WE CAN'T
  1528	001601'	254000	001633'		JRST	STUPND		;START.  GIVE UP IF
  1529	001602'	254000	001571'		JRST	STUPL2		;REQ IS CML SINCE NONE AFTER IT CAN START.
  1530	001603'	260040	001542'	STUPL4:	PUSHJ	P,CHKSTS	;CAN START THIS REQ?
  1531	001604'	254000	001613'		JRST	STUPL7		;YES.
  1532	001605'	542107	000001		HRRM	J,PCBLKQ(T2)	;NO, EITHER
  1533	001606'	135440	000063'		LDB	T4,QUYPCS	;FLAG THAT WE
  1534	001607'	306440	000002		CAIN	T4,STACML	;HAVE SEEN A CAN'T START
  1535	001610'	254000	001633'		JRST	STUPND		;OR IF CMPL, QUIT
  1536	001611'	344640	001571'		AOJA	P2,STUPL2	;ENTIRELY.
  1537	001612'	350007	000002	STUPL6:	AOS	PCBUSC(T2)	;START UNLOKED REQ.
  1538	001613'	260040	001474'	STUPL7:	PUSHJ	P,UNLOKQ	;REMOVE REQ FROM Q.
  1539	001614'	135440	000064'		LDB	T4,QUYPCN	;
  1540	001615'	261040	000011		PUSH	P,T4		;
  1541	001616'	135440	000063'		LDB	T4,QUYPCS	;
  1542	001617'	516342	001520*		HRLZM	T2,QUEPCB(J)	;
  1543	001620'	660440	001000		TRO	T4,STQPCB	;
  1544	001621'	137440	000063'		DPB	T4,QUYPCS	;
  1545	001622'	261040	000006		PUSH	P,T1		;SAVE T1 FROM US AND SETRUN.
  1546	001623'	201300	000000*		MOVEI	T1,RNQ		;FLAG THE
  1547	001624'	137300	000476*		DPB	T1,PJBSTS	;JOB TO
  1548	001625'	260040	000000*		PUSHJ	P,SETRUN	;BE
  1549	001626'	262040	000006		POP	P,T1		;RESTARTED.
  1550	001627'	262040	000002		POP	P,J		;
  1551	001630'	602300	000002		TRNE	T1,STCMPL	;GIVE UP IF WE JUST STARTED
  1552	001631'	254000	001633'		JRST	STUPND		;A CMPL REQL.
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 26-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1553	001632'	326100	001573'		JUMPN	J,STUPL3	;
  1554	001633'	137300	000007'	STUPND:	DPB	T1,PCUSTS	;FINISH
  1555	001634'	137400	000011'		DPB	T3,PCYLCC	;UP.
  1556	001635'	262040	000015		POP	P,P2		;
  1557	001636'	263040	000000		POPJ	P,		;
  1558
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 27
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1559				COMMENT #
  1560				@@SUBROUTINE PCBCLR
  1561				@@PURPOSE
  1562				SUBR FOR USE BY DSKCLN'S UUO, TO ZAP ALL THE SYSTEM PCBS.
  1563				@@ACCUM
  1564				DESTROYS T1 THRU T4.
  1565				@@EXIT
  1566				NON-SKIP RETURNS IF PCB IO IS IN PROGRESS.
  1567				1 SKIP RETURNS IF ERRORS.
  1568				2 SKIP RETURNS IF OKAY.
  1569				@@ #
  1570
  1571				    ;DOES ANYONE HAVE A PCB RESOURCE?
  1572	001637'	214300	000640*	PCBCLR::MOVM	T1,PSREQ	;
  1573	001640'	312300	000000*		CAME	T1,NMSTPC	;
  1574	001641'	254000	001557*		  JRST	CPOPJ1		;YES.
  1575	001642'	214300	000643*		MOVM	T1,PRREQ	;
  1576	001643'	312300	000000*		CAME	T1,NMRBPC	;
  1577	001644'	254000	001641*		  JRST	CPOPJ1		;YES.
  1578
  1579				    ;BE SURE NO PCB IO IS IN PROGRESS.
  1580	001645'	331000	002333'		SKIPL	SATWRT		;ANY SAT PCB IO TO GO?
  1581	001646'	263040	000000		  POPJ	P,		;YES.
  1582	001647'	261040	000003		PUSH	P,PG		;MAYBE.
  1583	001650'	201140	000013'		MOVEI	PG,%RIB.C	;
  1584	001651'	550343	000001	PCBCL2:	HRRZ	T2,%CTLST(PG)	;
  1585	001652'	135300	000010'	PCBC24:	LDB	T1,PCISTS	;IO IN PROGRESS
  1586	001653'	602300	000007		TRNE	T1,STDWRT!STDWAG!STDREA ;FOR THIS PCB?
  1587					  JRST	[POP  P,PG	;YES.
  1588	001654'	254000	002553'			 POPJ P,]	;
  1589	001655'	550347	000003		HRRZ	T2,PCBLNK(T2)	;NO.  GET NEXT PCB.
  1590	001656'	326340	001652'		JUMPN	T2,PCBC24	;
  1591	001657'	306140	000035'		CAIN	PG,%SAT.C	;DONE WITH PCBS?
  1592	001660'	254000	001663'		  JRST	PCBCL3		;YES.
  1593	001661'	201140	000035'		MOVEI	PG,%SAT.C	;NO, STILL SAT PCBS TO DO.
  1594	001662'	254000	001651'		JRST	PCBCL2		;
  1595
  1596				    ;CLEAR ALL THE STT TABLES.
  1597	001663'	515400	000000*	PCBCL3:	HRLZI	T3,STPBAD!STPINC!STPCHK!STPRPT ;
  1598				PRINTF(<[PCBCLR @PCBCL3+1 Clearing STT tables for one/all structures?]>)
  1599	001664'	201300	000000*		MOVEI	T1,STRDDB	;Get STRucture pointer
  1600	001665'	554306	000000*		HLRZ	T1,STRUNI(T1)	;T1/ UNIT DB.
  1601	001666'	550346	000000*	PCBCL4:	HRRZ	T2,UNISTT(T1)	;T2/ STT ENTRY ADDRESS.
  1602	001667'	336007	000000*	PCBC42:	SKIPN	STTPTR(T2)	;
  1603	001670'	254000	001675'		  JRST	PCBC44		;AT END OF THIS UNIT'S TABLE.
  1604	001671'	412407	001356*		ANDCAM	T3,STTSTS(T2)	;
  1605	001672'	402007	000000*		SETZM	STTAOB(T2)	;
  1606	001673'	271340	000000*		ADDI	T2,STTLEN	;
  1607	001674'	254000	001667'		JRST	PCBC42		;
  1608	001675'	554306	000000*	PCBC44:	HLRZ	T1,UNISTR(T1)	;NEXT UNIT?
  1609	001676'	326300	001666'		JUMPN	T1,PCBCL4	; YES.
  1610
  1611				    ;CLEAR THE PCBS AND ORDER THE LRU/MRU LISTS.
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 27-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1612	001677'	550343	000001	PCBCL6:	HRRZ	T2,%CTLST(PG)	;T2/ PCB ON LIST.
  1613	001700'	550403	000005		HRRZ	T3,%CTLRU(PG)	;T3/ ADDR INTO LRU-MRU LIST.
  1614	001701'	402007	000000	PCBC62:	SETZM	PCBPTR(T2)	;
  1615	001702'	402007	000001		SETZM	PCBTIM(T2)	;MAKES DEBUGGING EASIER.
  1616	001703'	402007	000002		SETZM	PCBSTS(T2)	;
  1617	001704'	202350	000000		MOVEM	T2,(T3)		;ORDER THE LRU/MRU
  1618	001705'	271400	000001		ADDI	T3,1		;LIST.
  1619	001706'	550347	000003		HRRZ	T2,PCBLNK(T2)	;JUMP ON ANOTHER PCB OF
  1620	001707'	326340	001701'		JUMPN	T2,PCBC62	;THIS TYPE TO DO.
  1621	001710'	402010	000000		SETZM	(T3)		;CLEAR LAST SLOT IN LRU/MRU.
  1622	001711'	542403	000006		HRRM	T3,%CTMRU(PG)	;
  1623	001712'	306140	000013'		CAIN	PG,%RIB.C	;
  1624	001713'	542400	000032'		  HRRM	T3,%RB2.C+%CTMRU
  1625	001714'	306140	000013'		CAIN	PG,%RIB.C	;
  1626	001715'	254000	001720'		  JRST	PCBCL8		;
  1627	001716'	201140	000013'		MOVEI	PG,%RIB.C	;
  1628	001717'	254000	001677'		JRST	PCBCL6		;
  1629
  1630	001720'	262040	000003	PCBCL8:	POP	P,PG		;
  1631
  1632	001721'	402000	000000*		SETZM	SATFUL		;
  1633
  1634				    ;CLEAR SOME INFO USED FOR BAD SATS.
  1635	001722'	402000	000000*		SETZM	SATBAD		;NO FIRST BAD SAT.
  1636	001723'	402000	000000*		SETZM	SATBRD		;
  1637				PRINTF(<[PCBCLR Called by DSKCLN UUO - should have STR setup as argument]>)
  1638	001724'	201340	001664*		MOVEI	T2,STRDDB	;WHICH STRucture?
  1639	001725'	551300	000000*		HRRZI	T1,SRPRPT	;CLEAR THE NEW
  1640	001726'	412307	000000*		ANDCAM	T1,STRBTS(T2)	;BAD SAT BIT.
  1641
  1642	001727'	350001	000000		AOS	(P)		;2 SKIP RETURN.
  1643	001730'	254000	001644*		JRST	CPOPJ1		;
  1644
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 28
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1645				COMMENT #
  1646				@@SUBROUTINE PCBSWN
  1647				@@PURPOSE
  1648				SUBR THAT FIXES UP PCB HANDLING WHEN A JOB GETS A SWAP IN ERROR.
  1649				@@ENTRY
  1650				EXPECTS J/ JOB NUMBER.
  1651				@@ACCUM
  1652				DESTROYS T1 THRU T4.
  1653				@@ #
  1654
  1655	001731'	261040	000003	PCBSWN::PUSH	P,PG		;SAVE PG.
  1656
  1657				    ;M2 HANDLING.
  1658	001732'	201300	000000*		MOVEI	T1,M2Q		;IF JOB HAS "JUST STARTED"
  1659	001733'	200340	000000*		MOVE	T2,M2SWT	;FROM M2 WAIT,
  1660	001734'	260040	002016'		PUSHJ	P,RMVJST	;REMOVE IT.
  1661					JRST	[HRRZ	T1,J	;WAS. ONLY OTHER THING OF INTEREST
  1662								;JOB CAN BE DOING IS
  1663						MOVEI PG,%SAT.C
  1664						SETZ T4,
  1665	001735'	254000	002555'			JRST PCBSW8]	;TO BE RUNNING WITH A SAT PCB.
  1666	001736'	200340	002201'		MOVE	T2,M2HAV	;IF THE JOB REALLY HAS M2, GIVE
  1667	001737'	260040	002016'		PUSHJ	P,RMVJST	;IT UP AND CONTINUE
  1668	001740'	254000	001741'		JRST	.+1		;HERE.
  1669
  1670				    ;PR AND PS HANDLING.
  1671	001741'	400140	000000		SETZ	PG,		;FLAG FOR %RIB.C OR %RB2.C.
  1672	001742'	201300	000000*		MOVEI	T1,PRQ		;IF JOB HAS JUST STARTED FROM
  1673	001743'	200340	000000*		MOVE	T2,PRSWT	;PRIMARY PCB WAIT IN SCHED1, DO
  1674	001744'	260040	002016'		PUSHJ	P,RMVJST	;THINGS TO THE PCB LOCK QUEUES.
  1675	001745'	254000	001764'		JRST	PCBSW2		;JUST STARTED FROM WAIT IN PR.
  1676	001746'	201300	000000*		MOVEI	T1,RIQ		;
  1677	001747'	200340	000000*		MOVE	T2,RISWT	;
  1678	001750'	260040	002016'		PUSHJ	P,RMVJST	;
  1679					JRST	[SOSL PRREQ	;
  1680						SOS PRAVAL	;
  1681	001751'	254000	002561'			JRST PCBSW2]
  1682	001752'	201140	000035'		MOVEI	PG,%SAT.C	;
  1683	001753'	201300	000000*		MOVEI	T1,PSQ		;
  1684	001754'	200340	000000*		MOVE	T2,PSSWT	;
  1685	001755'	260040	002016'		PUSHJ	P,RMVJST	;
  1686	001756'	254000	001764'		JRST	PCBSW2		;JUST STARTED FROM WAIT IN PS.
  1687	001757'	201300	000000*		MOVEI	T1,SIQ		;
  1688	001760'	200340	000000*		MOVE	T2,SISWT	;
  1689	001761'	260040	002016'		PUSHJ	P,RMVJST	;
  1690					JRST	[SOSL PSREQ	;
  1691						SOS PSAVAL	;
  1692	001762'	254000	002564'			JRST PCBSW2]	;
  1693	001763'	254000	001766'		JRST	PCBSW3		;FROM NEITHER MP QUEUE.
  1694	001764'	260040	002026'	PCBSW2:	PUSHJ	P,LOCADJ	;FROM ONE OF THE MP QUEUES.
  1695	001765'	254000	002005'		JRST	PCBSW6		;FIX UP THE PCB LOCK QUEUE.
  1696
  1697				    ;ANY REMAINING CONNECTION WITH THE PCBS, OTHER THAN
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 28-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1698				    ;RUNNING FREE WITH ONE?
  1699	001766'	336002	001617*	PCBSW3:	SKIPN	QUEPCB(J)	;
  1700	001767'	254000	002005'		JRST	PCBSW6		;NO.
  1701
  1702	001770'	135400	001624*		LDB	T3,PJBSTS	;YES.  IF WE ARE REALLY LOCKED,
  1703	001771'	306400	000475*		CAIN	T3,MLOWQ	;WE CAN'T HAVE BEEN SWPD IN.
  1704	001772'	254000	002004'		JRST	PCBSW5		;REALLY LOCKED.
  1705
  1706				    ;HERE ON 1ST JOB IN THE LOCK QUEUE FOR A SECONDARY OR JUST
  1707				    ;STARTED FROM LOCK QUEUE FOR A PRIMARY PCB.
  1708	001773'	554342	001766*		HLRZ	T2,QUEPCB(J)	;
  1709	001774'	260040	002105'		PUSHJ	P,CTLFND	;SET UP PG TO CTL BLK ADDR.
  1710	001775'	554407	000003		HLRZ	T3,PCBPAG(T2)	;JUMP IF JUST STARTED FOR
  1711	001776'	326400	002001'		JUMPN	T3,PCBS45	;A PRIMARY PCB.
  1712	001777'	260040	002026'		PUSHJ	P,LOCADJ	;1ST JOB IN LOK Q DYING HERE
  1713	002000'	254000	002004'		JRST	PCBSW5		;IS LIKE MP JOB DYING.
  1714	002001'	135440	000063'	PCBS45:	LDB	T4,QUYPCS	;SET UP T4
  1715	002002'	620440	001000		TRZ	T4,STQPCB	;FOR
  1716	002003'	260040	000614'		PUSHJ	P,MAPREL	;MAPREL, TO RELEASE THE PCB.
  1717	002004'	402002	001773*	PCBSW5:	SETZM	QUEPCB(J)	;
  1718
  1719				    ;HERE TO SEE IF WE ARE RUNNING WITH A PCB.
  1720				    ;(NOT EVERYBODY WHO GETS HERE CAN HAVE ALL THREE, BUT
  1721				    ;EASIER TO CHECK IF THEY DO THAN AVOID CHECKING.).
  1722	002005'	550300	000002	PCBSW6:	HRRZ	T1,J	;SET UP T1 FOR %CTSTS/%CTADR
  1723	002006'	201440	000003		MOVEI	T4,3		;T4/ INDEX FOR MAPTBL.
  1724	002007'	200151	000121'	PCBSW7:	MOVE	PG,MAPTBL-1(T4)	;PG/ CNTROL BLOCK ADDR.
  1725	002010'	135403	000004	PCBSW8:	LDB	T3,%CTADR(PG)	;DO WE HAVE A PCB OF
  1726	002011'	322400	002013'		JUMPE	T3,.+2		;THIS TYPE?
  1727	002012'	260040	002057'		PUSHJ	P,PERRLS	;YES, RELEASE IT.
  1728	002013'	367440	002007'		SOJG	T4,PCBSW7	;TRY NEXT PCB TYPE, IF ANY LEFT.
  1729
  1730	002014'	262040	000003		POP	P,PG		;RESTORE PG.
  1731	002015'	263040	000000		POPJ	P,		;DONE.
  1732
  1733
  1734
  1735
  1736				COMMENT #
  1737				@@SUBROUTINE RMVJST
  1738				@@PURPOSE
  1739				SUBR TO SEE IF A JOB HAS EITHER "JUST STARTED" WITH A CERTAIN
  1740				TYPE OF RESOURCE OR IF THE JOB IS RUNNING WITH M2, DEPENDING
  1741				ON THE TABLE ADDRESS WITH WHICH WE ARE CALLED, AND IF SO TO
  1742				FREE THE JOB UP.
  1743				@@ENTRY
  1744				EXPECTS J/ JOB NUMBER, T1/ QUEUE NUMBER,  AND T2/ ADDRESS OF
  1745				TABLE OF INTERESTING JOBS.
  1746				@@ACCUM
  1747				DESTROYS T2 AND T3.
  1748				@@EXIT
  1749				NORMAL RETURN IF FOUND AND SKIP RETURN IF NOT FOUND.
  1750				@@ #
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 28-3
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1751
  1752	002016'	316107	000000	RMVJST:	CAMN	J,(T2)		;IS THIS TABLE ENTRY OUR JOB?
  1753	002017'	254000	002022'		JRST	.+3		;YES.
  1754	002020'	253340	002016'		AOBJN	T2,.-2		;NO, MORE ENTRIES IN THE TABLE?
  1755	002021'	324740	001730*		PJRST	CPOPJ1		;NO, NOT FOUND.
  1756	002022'	402007	000000		SETZM	(T2)		;FOUND, REMOVE IT.
  1757	002023'	371006	000000*		SOSL	REQTAB(T1)	;
  1758	002024'	370006	000000*		SOS	AVALTB(T1)	;
  1759	002025'	263040	000000		POPJ	P,		;
  1760
  1761
  1762
  1763
  1764				COMMENT #
  1765				@@SUBROUTINE LOCADJ
  1766				@@PURPOSE
  1767				SUBR TO HANDLE REMOVING A JOB FROM AN MP QUEUE.
  1768				IF THERE IS NO FOLLOWING JOB IN THE PCB LOCK QUEUE, JUST
  1769				DISPOSE OF THE SECONDARY PCB.  ELSE, MAKE THE FOLLOWING
  1770				JOB THE FIRST JOB AND WAKE IT UP SO IT CAN QUEUE FOR MP.
  1771				@@ENTRY
  1772				EXPECTS J/ JOB NUMBER AND PG/ %SAT.C OR 0(MEANS %RIB.C OR %RB2.C
  1773				OR %SAT.C).
  1774				@@ACCUM
  1775				DESTROYS T1 THRU T4 AND PG.
  1776				@@ #
  1777
  1778	002026'	554342	002004*	LOCADJ:	HLRZ	T2,QUEPCB(J)	;T2/ PCB ADDR.
  1779	002027'	135300	000064'		LDB	T1,QUYPCN	;IS THERE A FOLLOWING JOB IN
  1780	002030'	322300	002051'		JUMPE	T1,LOCAD2	;THE PCB LOCK QUEUE?
  1781
  1782				    ;HERE WHEN THERE IS ANOTHER JOB IN THE LOCK QUEUE.
  1783	002031'	506346	002026*		HRLM	T2,QUEPCB(T1)	;YES.  MAKE THAT
  1784	002032'	261040	000002		PUSH	P,J		;JOB
  1785	002033'	200100	000006		MOVE	J,T1		;THE
  1786	002034'	261040	000014		PUSH	P,P1		;FIRST
  1787	002035'	135600	000063'		LDB	P1,QUYPCS	;JOB
  1788	002036'	660600	001000		TRO	P1,STQPCB	;IN THE
  1789	002037'	137600	000063'		DPB	P1,QUYPCS	;LOCK QUEUE,
  1790	002040'	402007	000002		SETZM	PCBUSC(T2)	;AND SET THAT
  1791	002041'	260040	001407'		PUSHJ	P,SETPCB	;JOB'S INFO
  1792	002042'	262040	000014		POP	P,P1		;IN THE
  1793	002043'	542107	000001		HRRM	J,PCBLKQ(T2)	;PCB.
  1794	002044'	201300	001623*		MOVEI	T1,RNQ		;WAKE
  1795	002045'	137300	001770*		DPB	T1,PJBSTS	;THAT
  1796	002046'	260040	001625*		PUSHJ	P,SETRUN	;JOB UP, SO IT CAN
  1797	002047'	262040	000002		POP	P,J		;QUEUE FOR MP.
  1798	002050'	263040	000000		POPJ	P,
  1799
  1800				    ;HERE WHEN THERE IS NO OTHER JOB IN THE LOCK QUEUE.
  1801	002051'	326140	002053'	LOCAD2:	JUMPN	PG,.+2		;IF NECESSARY, SET PG TO THE
  1802	002052'	260040	002105'		PUSHJ	P,CTLFND	;CORRECT CNTL BLK ADDR.
  1803	002053'	200300	000007		MOVE	T1,T2		;REMOVE PCB FROM CTL BLK
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 28-4
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1804	002054'	260040	001422'		PUSHJ	P,UNLNK2	;LINKED LIST.
  1805	002055'	201300	000001		MOVEI	T1,1		;GIVE BACK THE SECONDARY PCB
  1806	002056'	324740	000420*		PJRST	GIV4WD		;TO FREE CORE.
  1807
  1808
  1809
  1810
  1811
  1812
  1813				COMMENT #
  1814				@@SUBROUTINE PERRLS
  1815				@@PURPOSE
  1816				@@ENTRY
  1817				EXPECTS PG/ CNTL BLOCK ADDR, T3/ INDEX OF PCB FROM %CTADR,
  1818				J/ JOB NUMBER, AND T1 SET UP FOR %CTSTS/ADR
  1819				@@ACCUM
  1820				DESTROYS T3.
  1821				@@EXIT
  1822				@@ #
  1823
  1824
  1825	002057'	261040	000006	PERRLS:	PUSH	P,T1		;SAVE T1,
  1826	002060'	261040	000007		PUSH	P,T2		;T2, AND
  1827	002061'	261040	000011		PUSH	P,T4		;T4 FOR CALLER.
  1828	002062'	400440	000000		SETZ	T4,		;CLEAR %CTADR SO NEXT JOB WHICH LOGS
  1829	002063'	137443	000004		DPB	T4,%CTADR(PG)	;IN GETTING THIS JOB NO. ISNT SCREWED UP
  1830	002064'	135443	000003		LDB	T4,%CTSTS(PG)	;GET %CTSTS WHILE T1 STILL GOOD
  1831	002065'	260040	002073'		PUSHJ	P,ADRUNL	;GET T2/ PCB ADDRESS.
  1832	002066'	260040	000614'		PUSHJ	P,MAPREL	;RELEASE THE PCB.
  1833	002067'	262040	000011		POP	P,T4		;RESTORE T1,
  1834	002070'	262040	000007		POP	P,T2		;T2, AND
  1835	002071'	262040	000006		POP	P,T1		;T4 FOR CALLER.
  1836	002072'	263040	000000		POPJ	P,
  1837
  1838
  1839				COMMENT #
  1840				@@SUBROUTINE ADRUNL
  1841				@@PURPOSE
  1842				SUBR TO, GIVEN AN "INDEX" A LA %CTADR AND A CNTL BLK ADDR IN
  1843				PG, FIND THE PCB ADDRESS.
  1844				@@ENTRY
  1845				SEE PURPOSE;  EXPECTS INDEX IN T3.
  1846				@@ACCUM
  1847				DESTROYS T1, T2, AND T3.
  1848				@@EXIT
  1849				RETURNS T2/ PCB ADDRESS.
  1850				@@ #
  1851
  1852				INTERN ADRUNL
  1853
  1854	002073'	550343	000001	ADRUNL:	HRRZ	T2,%CTLST(PG)	;FIND THE PCB
  1855	002074'	554307	000003	ADRUN1:	HLRZ	T1,PCBPAG(T2)	;ADDRESS WE WANT, ACCORDING TO
  1856	002075'	326300	002101'		JUMPN	T1,ADRUN2	;THE NUMBER IN T3, BY
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 28-5
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1857	002076'	550347	000003		HRRZ	T2,PCBLNK(T2)	;SKIPPING OVER THE SECONDARY
  1858	002077'	326340	002074'		JUMPN	T2,ADRUN1	;PCBS AND THEN
  1859	002100'	256000	000000'		 STOPCD                         ;;ADRUNL+4
  1860	002101'	363400	001217*	ADRUN2:	SOJLE	T3,CPOPJ	;COUNTING
  1861	002102'	550347	000003		HRRZ	T2,PCBLNK(T2)	;THRU
  1862	002103'	326340	002101'		JUMPN	T2,ADRUN2	;THE PRIMARY PCBS.
  1863	002104'	256000	000000'		 STOPCD                         ;;ADRUN2+3
  1864
  1865
  1866				COMMENT #
  1867				@@SUBROUTINE CTLFND
  1868				@@PURPOSE
  1869				SUBR TO SET UP IN PG THE ADDR OF THE PCB CONTROL BLOCK WHICH
  1870				CONTROLS THE PCB WHOSE ADDR IS IN T2.
  1871				@@ENTRY
  1872				SEE PURPOSE.
  1873				@@ACCUM
  1874				DESTROYS T1, T3, AND PG.
  1875				@@EXIT
  1876				SEE PURPOSE.
  1877				@@ #
  1878
  1879				INTERN CTLFND
  1880	002105'	201400	000003	CTLFND:	MOVEI	T3,3		;T3/ INDEX FOR MAPTBL.
  1881	002106'	200150	000121'	CTLFN1:	MOVE	PG,MAPTBL-1(T3)	;TRY THIS CNTL BLOCK.
  1882	002107'	550303	000001		HRRZ	T1,%CTLST(PG)	;T1/ PCB ADDRESS.
  1883	002110'	306307	000000	CTLFN2:	CAIN	T1,(T2)		;IS IT OUR PCB?
  1884	002111'	263040	000000		 POPJ	P,		;YES, DONE.
  1885	002112'	550306	000003		HRRZ	T1,PCBLNK(T1)	;NO, GET NEXT PCB ADDRESS.
  1886	002113'	326300	002110'		JUMPN	T1,CTLFN2	;TRY AGAIN.
  1887	002114'	367400	002106'		SOJG	T3,CTLFN1	;OUT OF PCBS FOR THIS CNL BLOCK.
  1888	002115'	256000	002567'		 STOPCD (.,STOP,NOWRIT,,<All disks are write protected>)
  1889				 ;;CTLFN1+7
  1890
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 29
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1891				COMMENT #
  1892				@@SUBROUTINE PSSSWT/PRSSWT/M2SSWT/M2HSWT
  1893				@@PURPOSE
  1894				PSSSWT, PRSSWT, AND M2SSWT MARK JOBS AS WAITING TO SWAP IN
  1895				FOR THE PS, PR, AND M2 RESOURCES, RESPECTIVELY.  M2HSWT
  1896				MARKS JOBS AS HAVING THE M2 RESOURCE.
  1897				@@ENTRY
  1898				EXPECTS J/ JOB NO.
  1899				@@ACCUM
  1900				DESTROYS NO ACS.
  1901				@@ #
  1902
  1903	002116'	261040	000006	SISSWT::PUSH	P,T1
  1904	002117'	200300	001760*		MOVE	T1,SISWT
  1905	002120'	254000	002137'		JRST	PCBSWT
  1906
  1907	002121'	261040	000006	PSSSWT::PUSH	P,T1		;GET THE AOBJN
  1908	002122'	200300	001754*		MOVE	T1,PSSWT	;POINTER TO T1.
  1909	002123'	254000	002137'		JRST	PCBSWT		;
  1910
  1911	002124'	261040	000006	RISSWT::PUSH	P,T1
  1912	002125'	200300	001747*		MOVE	T1,RISWT
  1913	002126'	254000	002137'		JRST	PCBSWT
  1914
  1915	002127'	261040	000006	PRSSWT::PUSH	P,T1		;GET THE AOBJN
  1916	002130'	200300	001743*		MOVE	T1,PRSWT	;POINTER TO T1.
  1917	002131'	254000	002137'		JRST	PCBSWT		;
  1918
  1919	002132'	261040	000006	M2SSWT::PUSH	P,T1		;GET THE AOBJN
  1920	002133'	200300	001733*		MOVE	T1,M2SWT	;POINTER TO T1.
  1921	002134'	254000	002137'		JRST	PCBSWT		;
  1922
  1923	002135'	261040	000006	M2HSWT:	PUSH	P,T1		;GET THE AOBJN
  1924	002136'	200300	002201'		MOVE	T1,M2HAV	;POINTER TO T1.
  1925
  1926	002137'	332006	000000	PCBSWT:	SKIPE	(T1)		;IS THIS A FREE SLOT?
  1927	002140'	253300	002137'		AOBJN	T1,.-1		;NO, TRY TO GET NEXT.
  1928	002141'	321300	002143'		JUMPL	T1,.+2		;FREE SLOT, OR OUT OF ROOM?
  1929	002142'	256000	000000'		 STOPCD                         ;;PCBSWT+3
  1930	002143'	202106	000000		MOVEM	J,(T1)		;FREE SLOT, USE IT.
  1931	002144'	254000	000000*		JRST	TPOPJ		;EXIT, RESTORING T1 AS WE GO.
  1932
  1933
  1934
  1935
  1936				COMMENT #
  1937				@@SUBROUTINE PSSRMV/PRSRMV/M2SRMV/M2HRMV/RISRMV/SISRMV
  1938				@@PURPOSE
  1939				PSSRMV, PRSRMV, AND M2SRMV REMOVE JOBS FROM THE APPROPRIATE
  1940				WAITING TO SWAP IN LIST.  M2HRMV REMOVES JOBS FROM THE HAVE
  1941				M2 LIST.  ONLY M2HRMV DEMANDS THAT THE JOB BE ON THE LIST.
  1942				@@ENTRY
  1943				EXPECTS J/ JOB NO.
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 29-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1944				@@ACCUM
  1945				DESTROYS NO ACS.
  1946				@@ #
  1947
  1948	002145'	261040	000006	SISRMV:	PUSH	P,T1		;
  1949	002146'	200300	002117*		MOVE	T1,SISWT	;
  1950	002147'	254000	002163'		JRST	PCBRMV		;
  1951
  1952	002150'	261040	000006	RISRMV:	PUSH	P,T1		;
  1953	002151'	200300	002125*		MOVE	T1,RISWT	;
  1954	002152'	254000	002163'		JRST	PCBRMV		;
  1955
  1956	002153'	261040	000006	PSSRMV:	PUSH	P,T1		;GET THE AOBJN
  1957	002154'	200300	002122*		MOVE	T1,PSSWT	;POINTER TO T1.
  1958	002155'	254000	002163'		JRST	PCBRMV		;
  1959
  1960	002156'	261040	000006	PRSRMV:	PUSH	P,T1		;GET THE AOBJN
  1961	002157'	200300	002130*		MOVE	T1,PRSWT	;POINTER TO T1.
  1962	002160'	254000	002163'		JRST	PCBRMV		;
  1963
  1964	002161'	261040	000006	M2SRMV:	PUSH	P,T1		;GET THE AOBJN
  1965	002162'	200300	002133*		MOVE	T1,M2SWT	;POINTER TO T1.
  1966
  1967	002163'	316106	000000	PCBRMV:	CAMN	J,(T1)		;IS THIS OUR SLOT?
  1968	002164'	254000	002167'		JRST	.+3		;YES.
  1969	002165'	253300	002163'		AOBJN	T1,PCBRMV	;NO, LOOK AT NEXT SLOT.
  1970	002166'	254000	002144*		JRST	TPOPJ		;
  1971	002167'	402006	000000		SETZM	(T1)		;CLEAR OUR SLOT.
  1972	002170'	254000	002166*		JRST	TPOPJ		;EXIT, RESTORING T1 AS WE GO.
  1973
  1974
  1975	002171'	261040	000006	M2HRMV:	PUSH	P,T1		;GET THE AOBJN
  1976	002172'	200300	002201'		MOVE	T1,M2HAV	;POINTER TO T1.
  1977	002173'	316106	000000		CAMN	J,(T1)		;
  1978	002174'	254000	002177'		JRST	.+3		;
  1979	002175'	253300	002173'		AOBJN	T1,.-2		;
  1980	002176'	256000	000000'		 STOPCD                         ;;M2HRMV+5
  1981	002177'	402006	000000		SETZM	(T1)		;
  1982	002200'	254000	002170*		JRST	TPOPJ		;
  1983
  1984				INTERN M2HAV
  1985	002201'	000000	000000	M2HAV: Z
  1986
  1987
  1988				;TINY SUBR TO SEE IF WE HAVE THE M2 RESOURCE.
  1989				INTERN HAVM2
  1990	002202'	200340	001172*	HAVM2:	MOVE	T2,JOB		;
  1991	002203'	200300	002201'		MOVE	T1,M2HAV	;
  1992	002204'	316346	000000		CAMN	T2,(T1)		;
  1993	002205'	263040	000000		POPJ	P,		;YES, HAVE M2.
  1994	002206'	253300	002204'		AOBJN	T1,.-2		;
  1995	002207'	254000	002021*		JRST	CPOPJ1		;DO NOT HAVE M2.
  1996
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 30
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  1997				COMMENT #
  1998				@@SUBROUTINE MAPXCH
  1999				@@PURPOSE
  2000				SUBR TO INTERCHANGE THE INFO FOR
  2001				%RIB AND %RB2.  IF BOTH ARE ZERO, NO NEED TO DO ANYTHING.  IF
  2002				BOTH ARE <>0, JUST INTERCHANGE INFO. IF %RIB IS =0 AND %RB2 IS
  2003				<>0, THEN RELEASE M2. IF %RIB IS <>0 AND %RB2 IS =0, THEN
  2004				GET M2.
  2005				@@ACCUM
  2006				DESTROYS T1, T2, T3, AND T4.
  2007				@@ #
  2008
  2009				INTERN MAPXCH
  2010
  2011	002210'	336320	000015'	MAPXCH: SKIPN	T1,@%RIB.C+%CTUPT ;IF BOTH ARE
  2012	002211'	332020	000026'		SKIPE	@%RB2.C+%CTUPT ;=0, NO
  2013	002212'	254000	002214'		JRST	.+2		;NEED TO DO
  2014	002213'	263040	000000		POPJ	P,		;ANYTHING.
  2015	002214'	322300	002237'		JUMPE	T1,MAPXC4	;JUMP IF %RIB=0 AND %RB2 <>0.
  2016	002215'	332020	000026'		SKIPE	@%RB2.C+%CTUPT	;JUMP IF BOTH %RIB AND
  2017	002216'	254000	002246'		JRST	MAPXC7		;%RB2 <>0.
  2018
  2019				    ;HERE IF %RIB <>0 AND %RB2 =0.
  2020	002217'	261040	000003		PUSH	P,PG		;SAVE PG AND
  2021	002220'	261040	000002		PUSH	P,J		;J.
  2022	002221'	200300	002202*		MOVE	T1,JOB		;SAVE
  2023	002222'	135400	000016'		LDB	T3,%CTSTS+%RIB.C ;THE STATUS OF
  2024	002223'	261040	000010		PUSH	P,T3		;HOW WE GOT %RIB.
  2025	002224'	550360	000015'		HRRZ	T2,@%CTUPT+%RIB.C ;T2/ PCB ADDRESS FOR %RIB.
  2026	002225'	261047	000000		PUSH	P,PCBPTR(T2)	;SAVE %RIB'S DISK POINTER.
  2027	002226'	201140	000013'		MOVEI	PG,%RIB.C	;RELEASE
  2028	002227'	260040	000564'		PUSHJ	P,MAPRLS	;%RIB.
  2029	002230'	262040	000006		POP	P,T1		;T1/DISK POINTER.
  2030	002231'	262040	000007		POP	P,T2		;RESTORE %RIB'S STATUS.
  2031	002232'	201140	000024'		MOVEI	PG,%RB2.C	;THEN
  2032	002233'	260067	000046'		PUSHJ	P,@CODADR(T2)	;GET %RB2.
  2033	002234'	262040	000002		POP	P,J		;RESTORE J AND
  2034	002235'	262040	000003		POP	P,PG		;PG.
  2035	002236'	263040	000000		POPJ	P,
  2036
  2037				    ;HERE IF %RIB =0 AND %RB2 <>0.
  2038	002237'	371000	000605*	MAPXC4:	SOSL	M2REQ		;RELEASE AN
  2039	002240'	370000	000606*		SOS	M2AVAL		;M2 RESOURCE.
  2040	002241'	261040	000002		PUSH	P,J		;TAKE US OFF
  2041	002242'	200100	002221*		MOVE	J,JOB		;THE LIST OF
  2042	002243'	260040	002171'		PUSHJ	P,M2HRMV	;PEOPLE WHO HAVE
  2043	002244'	262040	000002		POP	P,J		;M2.
  2044
  2045	002245'	200320	000015'		MOVE	T1,@%RIB.C+%CTUPT ;
  2046	002246'	250320	000026'	MAPXC7:	EXCH	T1,@%RB2.C+%CTUPT ;
  2047	002247'	202320	000015'		MOVEM	T1,@%RIB.C+%CTUPT ;
  2048
  2049	002250'	135300	000013'		LDB	T1,%RIB.C+%CTBYP ;
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 30-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  2050	002251'	135340	000024'		LDB	T2,%RB2.C+%CTBYP ;
  2051	002252'	137340	000013'		DPB	T2,%RIB.C+%CTBYP ;
  2052	002253'	137300	000024'		DPB	T1,%RB2.C+%CTBYP ;
  2053
  2054
  2055	002254'	200300	002242*		MOVE	T1,JOB		;SETUP FOR %CTADR/STS
  2056
  2057	002255'	135400	000017'		LDB	T3,%RIB.C+%CTADR
  2058	002256'	135440	000030'		LDB	T4,%RB2.C+%CTADR
  2059	002257'	137440	000017'		DPB	T4,%RIB.C+%CTADR
  2060	002260'	137400	000030'		DPB	T3,%RB2.C+%CTADR
  2061
  2062	002261'	135400	000016'		LDB	T3,%RIB.C+%CTSTS
  2063	002262'	135440	000027'		LDB	T4,%RB2.C+%CTSTS
  2064	002263'	137440	000016'		DPB	T4,%RIB.C+%CTSTS
  2065	002264'	137400	000027'		DPB	T3,%RB2.C+%CTSTS
  2066	002265'	701100	376000		CLRPTO	%RIB	;CLEAR PAGE TABLE FOR %RIB AND
  2067	002266'	701100	375000		CLRPTO	%RB2	; %RB2.
  2068	002267'	263040	000000		POPJ	P,
  2069
  2070
  2071				COMMENT #
  2072				@@SUBROUTINE SMMPXC
  2073				@@PURPOSE
  2074				SIMPLE SUBR LIKE MAPXCH, BUT ASSUMES CALLER KNOWS WHAT IT IS
  2075				DOING, SO SMMPXC DOESN'T WORRY ABOUT M2.
  2076				@@ACCUM
  2077				DESTROYS T1, T2, T3, AND T4.
  2078				@@ #
  2079
  2080
  2081				INTERN SMMPXC
  2082
  2083	002270'	336320	000015'	SMMPXC: SKIPN	T1,@%RIB.C+%CTUPT ;IF BOTH ARE
  2084	002271'	332020	000026'		SKIPE	@%RB2.C+%CTUPT ;=0, NO NEED TO DO ANYTHING.
  2085	002272'	254000	002246'		JRST	MAPXC7		;
  2086	002273'	263040	000000		POPJ	P,		;
  2087
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 31
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  2088				COMMENT #
  2089				@@SUBROUTINE GETER1/GETER2
  2090				@@PURPOSE
  2091				SUBR TO RETURN IN T1 PGYERR FOR %RIB(GETER1) OR FOR
  2092				%SAT(GETER2).
  2093				@@ACCUM
  2094				DESTROYS T1.
  2095				@@EXIT
  2096				SEE PURPOSE
  2097				@@#
  2098
  2099				INTERN GETER1,GETER2
  2100				EXTERNAL OHTTAB,OHTDTE,OHTDER,OHTPAR,SRCOHT,OHTNUM
  2101
  2102	002274'	334300	002572'	GETER2:	SKIPA	T1,[XWD %SAT.C,%SAT]
  2103	002275'	200300	002573'	GETER1:	MOVE	T1,[XWD %RIB.C,%RIB]
  2104	002276'	261040	000003		PUSH	P,PG		;SAVE PG.
  2105	002277'	200146	000000		MOVE	PG,(T1)		;MAKE SURE READ HAS BEEN DONE.
  2106	002300'	207000	000006		MOVSS	T1		;
  2107	002301'	550166	000002		HRRZ	PG,@%CTUPT(T1)	;GET PG/ ADDR OF
  2108	002302'	554143	000003		HLRZ	PG,PCBPAG(PG)	;PAGE.
  2109	002303'	336000	000000*		SKIPN	OHTNUM		;ANY OUTPUT ERRORS?
  2110	002304'	254000	002324'		JRST	GETERA		;NO, JUST LOOK AT PGYERR
  2111	002305'	261040	000007		PUSH	P,T2
  2112	002306'	261040	000010		PUSH	P,T3
  2113	002307'	261040	000011		PUSH	P,T4
  2114	002310'	135340	001023*		LDB	T2,PGYADR	;GET ADDRESS TO SEARCH FOR INOHT
  2115	002311'	260040	000000*		PUSHJ	P,SRCOHT	;OUTPUT ERROR FOR THIS PAGE?
  2116	002312'	254000	002327'		  JRST	GETERB		;NO, POP ACS AND GET PGYERR IN T1.
  2117	002313'	135300	002574'		LDB	T1,[POINT 2,OHTTAB(T4),1] ;GET BITS IN RH(T1)
  2118	002314'	205340	000000*		MOVSI	T2,OHTPAR	;PARITY MAY BE ON IF READING LUD OR SOME USER FILE
  2119								; THRU PCBS
  2120	002315'	612351	000000*		TDNE	T2,OHTTAB(T4)	;IS IT ON?
  2121	002316'	660300	000002		TRO	T1,2		;YES, SET DEVICE ERROR BIT.
  2122	002317'	262040	000011		POP	P,T4
  2123	002320'	262040	000010		POP	P,T3
  2124	002321'	262040	000007		POP	P,T2
  2125	002322'	262040	000003		POP	P,PG
  2126	002323'	263040	000000		POPJ	P,		;RETURN WITH OUTPUT ERROR BITS.
  2127
  2128	002324'	135300	000000*	GETERA:	LDB	T1,PGYERR	;
  2129	002325'	262040	000003		POP	P,PG		;RESTORE PG.
  2130	002326'	263040	000000		POPJ	P,
  2131
  2132	002327'	262040	000011	GETERB:	POP	P,T4
  2133	002330'	262040	000010		POP	P,T3
  2134	002331'	262040	000007		POP	P,T2
  2135	002332'	254000	002324'		JRST	GETERA		;GET STUFF BACK AND CHECK FOR INPUT ERRORS.
  2136
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 32
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  2137				COMMENT #
  2138				@@SUBROUTINE SATONC
  2139				@@PURPOSE
  2140				SUBR CALLED BY ONCE A SECOND CODE TO SEE IF ANY SATS NEED TO BE
  2141				WRITTEN OUT.
  2142				@@ENTRY
  2143				@@ACCUM
  2144				DESTROYS T1, T2, T3, T4, AND PG.
  2145				@@EXIT
  2146				@@ #
  2147
  2148				INTERN SATWRT,SATONC
  2149	002333'	777777	777777	SATWRT:-1	;ON ENTRY TO SATONC, SATWRT MEANS:
  2150						;-1 MEANS NO SATS NEEDING TO BE WRITTEN OR
  2151						;ON THEIR WAY OUT.  >0 MEANS AT LEAST ONE SAT
  2152						;MAY NEED TO BE WRITTEN OUT.  0 MEANS THAT
  2153						;SOME SATS MAY BE ON THEIR WAY OUT, BUT NONE
  2154						;NEED TO BE STARTED OUT.
  2155
  2156	002334'	335300	002333'	SATONC: SKIPGE	T1,SATWRT	;ANYTHING TO DO?
  2157	002335'	263040	000000		POPJ	P,		;NO.
  2158	002336'	322300	002341'		JUMPE	T1,.+3		;JUMP IF JUST NEED TO CHECK IF THE SATS ARE FINISHED.
  2159	002337'	372000	002333'		SOSE	SATWRT		;ELSE, NOW LOOK AT SEE IF ANY
  2160	002340'	263040	000000		POPJ	P,		;NEED TO BE WRITTEN?
  2161
  2162
  2163				    ;FIND THE ADDRESS OF THE FIRST PRIMARY SAT PCB.
  2164	002341'	550340	000036'		HRRZ	T2,%SAT.C+%CTLST ;T2/ ADDR OF CURRENT SAT PCB.
  2165	002342'	554147	000003	SATON1:	HLRZ	PG,PCBPAG(T2)	;SKIP
  2166	002343'	326140	002347'		JUMPN	PG,SATON2	;OVER THE
  2167	002344'	550347	000003		HRRZ	T2,PCBLNK(T2)	;SECONDARY
  2168	002345'	326340	002342'		JUMPN	T2,SATON1	;PCBS.
  2169	002346'	256000	000000'		 STOPCD                         ;;SATONC+12
  2170
  2171	002347'	326300	002357'	SATON2:	JUMPN	T1,SATON4	;JUMP IF MAYBE NEED TO START SOME OUT.
  2172
  2173				    ;HERE TO SEE IF ALL SAT WRITE OUTS ARE FINISHED.
  2174	002350'	135400	000010'	SATON3:	LDB	T3,PCISTS	;WRITE IN PROGRESS FOR
  2175	002351'	602400	000003		TRNE	T3,STDWRT!STDWAG ;THIS SAT PCB?
  2176	002352'	263040	000000		POPJ	P,		;YES, NO NEED TO LOOK AT OTHERS.
  2177	002353'	550347	000003		HRRZ	T2,PCBLNK(T2)	;NO.  LOOK AT
  2178	002354'	326340	002350'		JUMPN	T2,SATON3	;THE NEXT ONE.
  2179	002355'	476000	002333'		SETOM	SATWRT		;FLAG NO SATS ON WAY OUT.
  2180	002356'	263040	000000		POPJ	P,
  2181
  2182				    ;HERE TO LOOK FOR SATS TO START OUT.
  2183	002357'	261040	000007	SATON4:	PUSH	P,T2		;SAVE ADDR OF 1ST PRIM PCB.
  2184	002360'	554147	000003	SATON5:	HLRZ	PG,PCBPAG(T2)	;
  2185	002361'	135400	001316*		LDB	T3,PGYDRT	;WAS THIS PCB
  2186	002362'	322400	002372'		JUMPE	T3,SATON8	;MODIFIED?
  2187	002363'	550407	000002		HRRZ	T3,PCBUSC(T2)	;YES, IS IT STILL
  2188	002364'	322400	002367'		JUMPE	T3,.+3		;IN USE?
  2189	002365'	350000	002333'		AOS	SATWRT		;YES.
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 32-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  2190	002366'	254000	002372'		JRST	SATON8		;
  2191	002367'	261040	002575'		PUSH	P,[SATON8]	;NO.  RETURN ADDRESS.
  2192	002370'	261040	002576'		PUSH	P,[0]
  2193	002371'	254000	000675'		JRST	MAPRL7		;
  2194
  2195				    ;LOOK AT NEXT PRIMARY PCB.
  2196	002372'	550347	000003	SATON8:	HRRZ	T2,PCBLNK(T2)	;ANOTHER ONE
  2197	002373'	326340	002360'		JUMPN	T2,SATON5	;LEFT?
  2198
  2199	002374'	262040	000007		POP	P,T2		;NO.  T2/ADDR OF 1ST PRIM PCB.
  2200	002375'	336000	002333'		SKIPN	SATWRT		;SAW ONE WE COULDN'T START?
  2201	002376'	254000	002350'		JRST	SATON3		;NO, CHK IF ALL SAT WRITING IS DONE.
  2202	002377'	201300	000001		MOVEI	T1,1		;YES, SAY
  2203	002400'	202300	002333'		MOVEM	T1,SATWRT		;SO.
  2204	002401'	263040	000000		POPJ	P,		;
  2205
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 33
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  2206				;ROUTINE TO HANDLE PCDTIM COUNTER.
  2207				; CALLED ONCE PER TICK IF PCDCNT IS ZERO.
  2208
  2209	002402'	350000	002434'	TIMPCD::AOS	PCDTIM		;OK, INCREMENT ANOTHER TIME.
  2210
  2211				;LOOP THRU ALL PCBS AND GET PCDCNT SETUP, PCPDRF SET ON DIRTY PCBS
  2212
  2213	002403'	210440	001643*		MOVN	T4,NMRBPC	;GET -VE NUMBER OF RIB PCBS
  2214	002404'	274440	001640*		SUB	T4,NMSTPC	;TOTAL -VE NUMBER
  2215	002405'	507000	000011		HRLS	T4
  2216	002406'	540440	000012'		HRR	T4,PCBTAB	;GET POINTER TO PCB ADDRESSES, BITS
  2217
  2218	002407'	200351	000000	PCDTM1:	MOVE	T2,(T4)		;GET PCB ADDRESS
  2219	002410'	554147	000003		HLRZ	PG,PCBPAG(T2)	;GET CORE PAGE
  2220	002411'	135300	002361*		LDB	T1,PGYDRT	;SEE IF ITS DIRTY
  2221	002412'	326300	002416'		JUMPN	T1,PCDTM2	;JUMP IF YES.
  2222	002413'	135300	000010'		LDB	T1,PCISTS	;NOT DIRTY, GET STATUS BYTE OF PCB
  2223	002414'	606300	000003		TRNN	T1,STDWRT!STDWAG ;ON ITS WAY OUT?
  2224	002415'	254000	002430'		JRST	PCDNX1		;NO, NOTHING TO WAIT FOR.
  2225	002416'	700600	001307*	PCDTM2:	DSKOFF			;DON'T LET FINPCB FOOL AROUND
  2226	002417'	135300	002411*		LDB	T1,PGYDRT	;MAKE SURE ITS STILL EITHER DIRTY OR GOING OUT
  2227	002420'	326300	002424'		JUMPN	T1,PCDTM3	;JUMP IF STILL DIRTY
  2228	002421'	135300	000010'		LDB	T1,PCISTS	;NOT DIRTY, MAKE SURE DIDN'T FINISH YET
  2229	002422'	606300	000003		TRNN	T1,STDWRT!STDWAG	;IF EITHER OF THESE STILL ON, IO STILL GOING
  2230	002423'	254000	002427'		JRST	PCDNXT		;ITS FINISHED NOW, NOTHING TO DO.
  2231	002424'	205300	400000	PCDTM3:	MOVSI	T1,STPDRF	;SET THE FLAG
  2232	002425'	436307	000002		IORM	T1,PCBSTS(T2)	;IN THE PCB
  2233	002426'	350000	002435'		AOS	PCDCNT		;INCREMENT COUNT, SAVE IT FOR IRP CHECK
  2234	002427'	700600	001343*	PCDNXT:	DSKON			;OK
  2235	002430'	253440	002407'	PCDNX1:	AOBJN	T4,PCDTM1	;LOOP THRU ALL PCBS
  2236	002431'	336000	002435'		SKIPN	PCDCNT		;IF COUNT WENT TO ZERO ALREADY,
  2237	002432'	350000	002434'		AOS	PCDTIM		;THEN INCREMENT THE CLOCK
  2238	002433'	263040	000000		POPJ	P,		;RETURN.
  2239
  2240	002434'	000000	000000	PCDTIM::0			;SYSTEM WIDE PCB DIRTY MONITOR CLOCK
  2241	002435'	000000	000000	PCDCNT::0			;NUMBER OF DIRTY PCBS FOR THIS CYCLE
  2242
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 34
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  2243				COMMENT #
  2244				@@SUBROUTINE HANGRB
  2245				@@PURPOSE
  2246				A LITTLE SUBR CALLED AT HANG TIME TO BE SURE THAT ALL THE
  2247				RIBS HAVE BEEN WRITTEN.
  2248				@@ACCUM
  2249				DESTROYS NO ACS.
  2250				@@EXIT
  2251				SKIP RETURNS IF OKAY, ELSE NON-SKIP RETURNS.
  2252				@@ #
  2253
  2254				INTERN HANGRB
  2255
  2256	002436'	261040	000006	HANGRB:	PUSH	P,T1		;SAVE T1 AND
  2257	002437'	261040	000007		PUSH	P,T2		;T2.
  2258	002440'	550340	000014'		HRRZ	T2,%RIB.C+%CTLST ;T2/ ADDR OF FIRST RIB PCB.
  2259	002441'	554307	000003		HLRZ	T1,PCBPAG(T2)	;BETTER BE
  2260	002442'	322300	002451'		JUMPE	T1,HANGOT	;A PRIMARY.
  2261	002443'	135300	000010'	HANGR3:	LDB	T1,PCISTS	;IO IN PROGRESS FOR THIS
  2262	002444'	602300	000007		TRNE	T1,STDWRT!STDREA!STDWAG ;PCB?
  2263	002445'	254000	002451'		JRST	HANGOT		;YES, TAKE THE WAIT RETURN.
  2264	002446'	550347	000003		HRRZ	T2,PCBLNK(T2)	;NO, IS THERE ANOTHER PCB?
  2265	002447'	326340	002443'		JUMPN	T2,HANGR3	;JUMP ON YES.
  2266	002450'	350001	777776		AOS	-2(P)		;NO, WIN.
  2267	002451'	262040	000007	HANGOT:	POP	P,T2		;RESTORE T2 AND
  2268	002452'	262040	000006		POP	P,T1		;T1.
  2269	002453'	263040	000000		POPJ	P,
  2270
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 35
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  2271				;SUBROUTINE TO CALL WAIT1
  2272				;THIS IS NEEDED SINCE WAIT1 CLOBBERS P1-P4
  2273
  2274				;THIS INSTRUCTION IS USED TO RESTORE PWAIT1 AFTER RESTART (SEE WTSATS)
  2275				INTERN PWAITZ
  2276	002454'	265440	000000*	PWAITZ:	JSP	T4,SAVE4
  2277
  2278				INTERN PWAIT1
  2279	002455'	265440	002454*	PWAIT1:	JSP	T4,SAVE4	;SAVE P1-P4
  2280	002456'	324740	000000*		PJRST	WAIT1		;GO TO WAIT1
  2281
  2282
  2283
  2284
  2285				COMMENT #
  2286				@@SUBROUTINE DRSCHK
  2287				@@PURPOSE
  2288				CALLED TO SEE IF A JOB HAS A SHARABLE DISK RESOURCE (CALLED BY
  2289				SCHEDULER TO GIVE JOB HIGHER PRIORITY.).
  2290				@@ENTRY
  2291				EXPECTS J/ JOB OF INTEREST.
  2292				@@ACCUM
  2293				DESTROYS NO ACS.
  2294				@@EXIT
  2295				SKIP RETURNS IF JOB DOES HAVE SHARABLE DISK RESOURCE, ELSE
  2296				NON-SKIP RETURNS.
  2297				@@ #
  2298
  2299				INTERN DRSCHK
  2300
  2301	002457'	316100	000000*	DRSCHK:	CAMN	J,CBUSER	;HAS CB RESOURCE?
  2302	002460'	254000	002207*		JRST	CPOPJ1		;YES, SKIP RETURN.
  2303	002461'	261040	000006		PUSH	P,T1		;SAVE T1.
  2304	002462'	332302	002031*		SKIPE	T1,QUEPCB(J)	;INVOLVED WITH THE PCBS?
  2305	002463'	254000	002470'		JRST	DRSCH2		;YES.
  2306	002464'	205300	777777		MOVSI	T1,-1		;SHORTHAND TRICK: CHECK ALL %CTADR
  2307	002465'	612302	000041*		TDNE	T1,JBTPCB(J)	;BYTES (KNOWN TO LIVE IN LH) AT ONCE
  2308	002466'	254000	000000*		JRST	TPOPJ1		;TO SEE IF HAS %RIB,RB2 OR SAT. YES,
  2309								;HAS AT LEAST ONE
  2310	002467'	254000	002200*		JRST	TPOPJ		;HAS NONE OF THEM
  2311	002470'	135300	000063'	DRSCH2:	LDB	T1,QUYPCS	;LH QUEPCB FLAGGED AS A
  2312	002471'	606300	001000		TRNN	T1,STQPCB	;PCB ADDR?
  2313	002472'	254000	002467*		JRST	TPOPJ		;NO, JUST QUEUED; NONSKIP RTN
  2314	002473'	135300	002045*		LDB	T1,PJBSTS	;YES, 1ST IN Q AND STATIONARY OR
  2315	002474'	306300	002044*		CAIN	T1,RNQ		;REALLY RUNNING OR ABOUT TO RUN?
  2316	002475'	254000	002466*		JRST	TPOPJ1		;REALLY RUNNING HAS SHARABLE RES.
  2317	002476'	254000	002472*		JRST	TPOPJ		;
  2318
  2319	002477'	260040	000000*		$END	(PCB)

  2320	002500'	554160	415421

  2321	002501'	000001	000000
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 35-2
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988


  2322	002502'	260040	002477*

  2323	002503'	554160	445145

  2324	002504'	000001	000000

  2325	002505'	554407	000003

  2326	002506'	322400	000462'

  2327	002507'	550447	000002

  2328	002510'	326440	000462'

  2329	002511'	200440	001637*

  2330	002512'	302140	000035'

  2331	002513'	200440	001642*

  2332	002514'	343440	000462'

  2333	002515'	254000	000261'

  2334	002516'	260040	002502*

  2335	002517'	476444	575621

  2336	002520'	000002	000000

  2337	002521'	137300	000007'

  2338	002522'	137400	000011'

  2339	002523'	263040	000000

  2340	002524'	262040	000006

  2341	002525'	350000	000545*

  2342	002526'	260040	000000*

  2343	002527'	371000	002525*

  2344	002530'	474640	000000

  2345	002531'	263040	000000

  2346	002532'	700600	002427*

  2347	002533'	263040	000000

PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 35-3
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988

  2348	002534'	262040	000003

  2349	002535'	135300	000010'

  2350	002536'	602300	000007

  2351	002537'	254000	002532'

  2352	002540'	371023	000007

  2353	002541'	370023	000010

  2354	002542'	700600	002532*

  2355	002543'	263040	000000

  2356	002544'	400440	000000

  2357	002545'	324740	001013'

  2358	002546'	000000	001261'

  2359	002547'	000000	000035'

  2360	002550'	260040	002516*

  2361	002551'	474564	646223

  2362	002552'	000001	000000

  2363	002553'	262040	000003

  2364	002554'	263040	000000

  2365	002555'	550300	000002

  2366	002556'	201140	000035'

  2367	002557'	400440	000000

  2368	002560'	254000	002010'

  2369	002561'	371000	002513*

  2370	002562'	370000	000644*

  2371	002563'	254000	001764'

  2372	002564'	371000	002511*

  2373	002565'	370000	000641*

  2374	002566'	254000	001764'
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 35-4
PCBIO.MAC	20-SEP-87 13:48		S.MAC - with system parameter file for P035/D, January 1988


  2375	002567'	260040	002550*

  2376	002570'	565767	625164

  2377	002571'	000001	000000

  2378	002572'	000035'	377000

  2379	002573'	000013'	376000

  2380	002574'	420211	002315*

  2381	002575'	000000	002372'

  2382	002576'	000000	000000

  2383						;End of PCBIO  (PCBLIT: PCBEND:)
  2384
NO ERRORS DETECTED
PROGRAM BREAK IS 002577
8K CORE USED
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 36
PCBIO.MAC	20-SEP-87 13:48		SYMBOL TABLE

ADRUN1		002074'		GETLR1		001234'		INCMRU		001377'		NOWRIT		002115'	INT
ADRUN2		002101'		GETLR2		001247'		J		000002	INT	OHTDER		000000	EXT
ADRUNL		002073'	INT	GETLR5		001261'		JBTPCB		002465'	EXT	OHTDTE		000000	EXT
AVALTB		002024'	EXT	GETLR6		001264'		JOB		002254'	EXT	OHTNUM		002303'	EXT
CBUSER		002457'	EXT	GETLR7		001265'		LINKPB		001444'		OHTPAR		002314'	EXT
CHKNSK		001562'		GETLR9		001274'		LOCAD2		002051'		OHTTAB		002574'	EXT
CHKST0		001536'		GETLRS		001223'	INT	LOCADJ		002026'		ONCTIM		001141'	INT
CHKST4		001547'		GETLRU		001226'		M2AVAL		002240'	EXT	P		000001	INT
CHKST5		001556'		GETM2		000173'	INT	M2HAV		002201'	INT	P1		000014	INT
CHKSTS		001542'		GETPC1		000200'		M2HRMV		002171'		P2		000015	INT
CLROUT		001357'		GETPCB		000177'		M2HSWT		002135'		P3		000016	INT
CLRPT	701100	000000		GETTR0		001321'		M2Q		001732'	EXT	P4		000017	INT
CLRYNC		001345'		GETTR1		001325'		M2REQ		002237'	EXT	PAGIMD		000763'	
CODADR		000046'		GETTR2		001332'		M2SRMV		002161'		PAGIN		000756'	INT
CODBTS		000054'		GETTR3		001327'	INT	M2SSWT		002132'	INT	PAGOUT		000757'	INT
CPOPJ		002101'	EXT	GETTRA		001326'		M2SWT		002162'	EXT	PAGWAK		001134'	EXT
CPOPJ1		002460'	EXT	GETTRU		001307'		M2WAIT		000174'	EXT	PAGWAT		001173'	EXT
CTLFN1		002106'		GIV4WD		002056'	EXT	MAPAL1		000106'	INT	PCBC24		001652'	
CTLFN2		002110'		GSATST		001352'	EXT	MAPAL2		000111'		PCBC42		001667'	
CTLFND		002105'	INT	GT2ND		000543'		MAPAL3		000115'		PCBC44		001675'	
CURUPT		000000	EXT	GTDON0		000406'		MAPALL		000102'		PCBC62		001701'	
DEV1UN		000000	EXT	GTDON1		000235'	INT	MAPCML		000073'	INT	PCBCL2		001651'	
DEVDRB		000000	EXT	GTDON2		000231'		MAPDIE		000150'		PCBCL3		001663'	
DEVIOS		000002	SIN	GTDON3		000236'		MAPR24		000147'		PCBCL4		001666'	
DIE		002567'	EXT	GTDON4		000237'		MAPRB2		000136'		PCBCL6		001677'	
DMPSAT		000725'		GTDON6		000244'		MAPRDL		000067'	INT	PCBCL8		001720'	
DRSCH2		002470'		GTDONE		000223'		MAPRDN		000572'		PCBCLR		001637'	INT
DRSCHK		002457'	INT	GTFND6		000471'		MAPRDU		000077'	INT	PCBEND		002576'	INT
DSKPIF		002416'	EXT	GTPCFN		000462'		MAPREL		000614'		PCBIO		000000'	ENT
DSKPIN		002542'	EXT	GTPRS2		000414'		MAPRIB		000130'		PCBIO4		001024'	
ENLOK2		001457'		GTPRS3		000427'		MAPRL2		000625'		PCBLCC		000002	SIN
ENLOK3		001460'		GTPRS4		000431'		MAPRL4		000634'		PCBLIT		002477'	INT
ENLOK4		001464'		GTPRS8		000452'		MAPRL5		000643'		PCBLKQ		000001	SIN
ENLOKQ		001450'		GTPRSC		000410'		MAPRL6		000660'		PCBLNK		000003	SIN
F		000004	INT	GTSP10		000373'		MAPRL7		000675'		PCBPAG		000003	SIN
FCAVAL		000463'	EXT	GTSP65		000275'		MAPRL8		000710'		PCBPTR		000000	SIN
FCREQ		002527'	EXT	GTSP6A		000276'		MAPRLS		000564'	INT	PCBRMV		002163'	
FCWAIT		002526'	EXT	GTSP80		000342'		MAPSAT		000131'		PCBS45		002001'	
FINPCB		001030'	INT	GTSPC4		000263'		MAPTB1		000125'		PCBSTS		000002	SIN
FNDCR0		001110'		GTSPC5		000271'		MAPTBL		000122'		PCBSW2		001764'	
FNDPR0		001216'		GTSPC6		000274'		MAPWLN		000075'	INT	PCBSW3		001766'	
FNDPRM		001215'		GTSPC7		000303'		MAPWTL		000071'	INT	PCBSW5		002004'	
FNPC45		001122'		GTSPC8		000344'		MAPWTU		000101'	INT	PCBSW6		002005'	
FNPCOT		001124'		GTSPC9		000370'		MAPXC4		002237'		PCBSW7		002007'	
FNPCRU		001107'		GTSPCB		000261'		MAPXC7		002246'		PCBSW8		002010'	
FNPCW4		001075'		GTWTI4		000324'		MAPXCH		002210'	INT	PCBSWN		001731'	INT
FNPCWT		001063'		GTWTI6		000334'		MAXPCB		001030'	EXT	PCBSWT		002137'	
GET4WD		000546'	EXT	GTWTIO		000314'		MINPCB		001031'	EXT	PCBTAB		000012'	INT
GETER1		002275'	INT	HANGOT		002451'		MLOWQ		001771'	EXT	PCBTIM		000001	SIN
GETER2		002274'	INT	HANGR3		002443'		MPALOT		000133'		PCBUSC		000002	SIN
GETERA		002324'		HANGRB		002436'	INT	NMRBPC		002403'	EXT	PCDCNT		002435'	INT
GETERB		002327'		HAVM2		002202'	INT	NMSTPC		002404'	EXT	PCDNX1		002430'	
GETL15		001241'		INCMRU		001377'		NODIE		000000	EXT	PCDNXT		002427'	
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88 PAGE 36-2
PCBIO.MAC	20-SEP-87 13:48		SYMBOL TABLE

PCDTIM		002434'	INT	REQTAB		002023'	EXT	STARDL		000004	SPD	UNISTT		001666'	EXT
PCDTM1		002407'		RESLR2		001367'		STARDU		000000	SPD	UNLKO2		001511'	
PCDTM2		002416'		RESLRU		001361'		STAWLN		000005	SIN	UNLNK2		001422'	
PCDTM3		002424'		RESMRU		001405'		STAWTL		000003	SIN	UNLNK3		001426'	
PCISTS		000010'	INT	RIAVAL		000340'	EXT	STAWTU		000001	SIN	UNLNK5		001434'	
PCMLCC		000777	SIN	RIQ		001746'	EXT	STCMPL		000002	SPD	UNLOK1		001505'	
PCUSTS		000007'		RIREQ		000337'	EXT	STDDRF		000020	SPD	UNLOK2		001513'	
PCYLCC		000011'		RISRMV		002150'		STDPRE		000010	SIN	UNLOK4		001526'	
PERRLS		002057'		RISSWT		002124'	INT	STDREA		000004	SIN	UNLOKQ		001474'	
PG		000003	INT	RISWT		002151'	EXT	STDWAG		000001	SIN	UNTTBL		001035'	EXT
PGE.C		020000	SIN	RIWAIT		000335'	EXT	STDWRT		000002	SIN	UPTEP0		000400	SIN
PGYADR		002310'	EXT	RMVJST		002016'		STPBAD		000000	EXT	UPTRB2		000000	EXT
PGYDRT		002417'	EXT	RNQ		002474'	EXT	STPCHK		000000	EXT	UPTRIB		000000	EXT
PGYERR		002324'	EXT	RSTWAI		001126'		STPDRF		400000	SPD	UPTSAT		000000	EXT
PGYLMA		001033'	EXT	S		000000	INT	STPINC		000000	EXT	WAIT1		002456'	EXT
PGYSIO		001133'	EXT	S$ENTR	777777	777775	SIN	STPREA		100000	SIN	WATOUT		001203'	
PGYSIP		001020'	EXT	S$EVEN		000006	SIN	STPRPT		000000	EXT	WATPC2		001146'	
PGYSOP		001016'	EXT	S$HALT	777777	777777	SIN	STQPCB		001000	SPD	WATPC4		001161'	
PGYUNI		001034'	EXT	S$INFO		000005	SIN	STRBTS		001726'	EXT	WATPC5		001164'	
PJBSTS		002473'	EXT	S$JOB		000002	SIN	STRDDB		001724'	EXT	WATPC6		001200'	
PJOBN		000000	EXT	S$NAME		000000'	SPD	STRIOS		000754'	INT	WATPC7		001205'	
PJRST	324740	000000		S$NONA		000000	SIN	STRUNI		001665'	EXT	WATPCB		001142'	INT
PPCBIO		001013'	INT	S$PATC		000007	SIN	STSNEW		000001	SPD	WRPI	700600	000000	
PPCBWC		000065'	INT	S$STOP		000001	SIN	STTAOB		001672'	EXT	WSCHED		000477'	EXT
PRAVAL		002562'	EXT	S$TEMP		000000	SPD	STTLEN		001673'	EXT	%CTADR		000004	SPD
PRQ		001742'	EXT	S$XCT	777777	777776	SIN	STTPTR		001667'	EXT	%CTAMX		000077	SPD
PRREQ		002561'	EXT	SATBAD		001722'	EXT	STTSTS		001671'	EXT	%CTBYP		000000	SIN
PRSRMV		002156'		SATBRD		001723'	EXT	STUPL2		001571'		%CTLRU		000005	SIN
PRSSWT		002127'	INT	SATFUL		001721'	EXT	STUPL3		001573'		%CTLST		000001	SIN
PRSWT		002157'	EXT	SATON1		002342'		STUPL4		001603'		%CTMRU		000006	SIN
PRWAIT		000272'	EXT	SATON2		002347'		STUPL6		001612'		%CTSTS		000003	SIN
PSAVAL		002565'	EXT	SATON3		002350'		STUPL7		001613'		%CTUPT		000002	SIN
PSQ		001753'	EXT	SATON4		002357'		STUPLQ		001564'		%CTWRQ		000007	SPD
PSREQ		002564'	EXT	SATON5		002360'		STUPND		001633'		%CTWVL		000010	SPD
PSSRMV		002153'		SATON8		002372'		STWRTL		000004	SPD	%RB2		375000	SIN
PSSSWT		002121'	INT	SATONC		002334'	INT	STYINC		001061'	EXT	%RB2.C		000024'	INT
PSSWT		002154'	EXT	SATWRT		002333'	INT	SWPENQ		001000'	EXT	%RB2.N		000375	SIN
PSWAIT		000266'	EXT	SAVE4		002455'	EXT	T1		000006	INT	%RIB		376000	SIN
PWAIT1		002455'	INT	SETPCB		001407'		T2		000007	INT	%RIB.C		000013'	INT
PWAITZ		002454'	INT	SETRUN		002046'	EXT	T3		000010	INT	%RIB.N		000376	SIN
QUEPCB		002462'	EXT	SIAVAL		000331'	EXT	T4		000011	INT	%SAT		377000	SIN
QUYPCN		000064'		SIQ		001757'	EXT	TAGN25		000535'		%SAT.C		000035'	INT
QUYPCP		000062'		SIREQ		000330'	EXT	TAGON1		000515'		%SAT.N		000377	SIN
QUYPCS		000063'		SISRMV		002145'		TAGON2		000525'		%UPT		000000	EXT
RBMASK		000000	EXT	SISSWT		002116'	INT	TAGONN		000506'		
RBREAL		000105'	EXT	SISWT		002146'	EXT	TIMPCD		002402'	INT	
RBSPAR		000000	EXT	SIWAIT		000327'	EXT	TPOPJ		002476'	EXT	
RBYPNO		000000	EXT	SMMPXC		002270'	INT	TPOPJ1		002475'	EXT	
RBYUNI		000000	EXT	SPCBWC		000066'	INT	U		000005	INT	
RELM2		000605'	INT	

PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88
PCBIO.MAC	20-SEP-87 13:48		Symbol cross reference

ADRUN1	  1855#	  1858
ADRUN2	  1856	  1860#	  1862
ADRUNL	  1831	  1852	  1854#
AVALTB	    30%	  1758
CBUSER	    47%	  2301
CHKNSK	  1479	  1485	  1492	  1497#
CHKST0	   600	  1476#
CHKST4	  1482	  1486#
CHKST5	  1489	  1493#
CHKSTS	  1481#	  1530
CLROUT	  1252	  1260#
CLRYNC	  1189	  1250#
CODADR	   176#	   294	  2032
CODBTS	   184#	  1329
CPOPJ	    45%	   700	   708	   973	  1011	  1130	  1860
CPOPJ1	    45%	   570	   575	   582	   604	   638	  1204	  1477	  1484	  1490	  1494	  1574	  1577	  1643
	  1755	  1995	  2302
CTLFN1	  1881#	  1887
CTLFN2	  1883#	  1886
CTLFND	   975	  1013	  1709	  1802	  1879	  1880#
CURUPT	    45%
DEV1UN	    19%
DEVDRB	    19%
DEVIOS	   861
DIE	    11	    11%	    12	   238	   279	   352	  1234	  1888
DMPSAT	   260	   267	   796#
DRSCH2	  2305	  2311#
DRSCHK	  2299	  2301#
DSKPIF	    41%	   451	   718	   753	  1068	  1098	  1194	  1218	  2225
DSKPIN	    41%	   456	   727	   738	   742	   747	   761	   767	  1085	  1102	  1246	  2234
ENLOK2	  1388	  1395#
ENLOK3	  1396#	  1399
ENLOK4	  1397	  1401#
ENLOKQ	   502	   519	   541	  1387#
F	   861	   894	   904
FCAVAL	    29%	   339	   528
FCREQ	    29%	   618	   621	   623
FCWAIT	    29%	   622
FINPCB	   956#
FNDCR0	  1015#	  1018
FNDPR0	  1129#	  1132
FNDPRM	  1067	  1128#
FNPC45	  1020	  1025#
FNPCOT	   977	  1016	  1023	  1027#
FNPCRU	   986	  1014#
FNPCW4	   996	  1003#
FNPCWT	   964	   991#
GET4WD	    47%	   619
GETER1	  2099	  2103#
GETER2	  2099	  2102#
GETERA	  2110	  2128#	  2135
GETERB	  2116	  2132#
GETL15	  1164#	  1183
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88
PCBIO.MAC	20-SEP-87 13:48		Symbol cross reference

GETLR1	  1159#	  1166
GETLR2	  1163	  1171#
GETLR5	  1178	  1181#
GETLR6	  1175	  1186#
GETLR7	  1172	  1187#
GETLR9	  1191	  1194#
GETLRS	  1149	  1150#
GETLRU	   329	   408	  1153#
GETM2	   274	   304#
GETPC1	   311#	   322
GETPCB	   265	   310#	   379	   413
GETTR0	  1223	  1228#
GETTR1	  1221	  1227	  1229	  1232#
GETTR2	  1200	  1237#	  1240
GETTR3	  1234#
GETTRA	  1233#	  1236
GETTRU	   480	   591	  1218#
GIV4WD	    47%	   443	   487	  1806
GSATST	    38%	   981	  1255
GT2ND	   378	   412	   616#
GTDON0	   474#	   518	   524	   533
GTDON1	   352#	   357
GTDON2	   348#	   351
GTDON3	   349	   353#
GTDON4	   354#	   358
GTDON6	   355	   359#
GTDONE	   342#	   465	   475	   514	   546	   550
GTFND6	   529	   538#
GTPCFN	   313	   315	   319	   527#
GTPRS2	   479	   483#
GTPRS3	   490	   494#
GTPRS4	   493	   496#
GTPRS8	   498	   517#
GTPRSC	   403	   478#
GTSP10	   457	   463#
GTSP65	   394#	   427	   433
GTSP6A	   395#	   398
GTSP80	   410	   436#
GTSPC4	   382#	   549
GTSPC5	   383	   388#
GTSPC6	   387	   391#
GTSPC7	   396	   400#	   405
GTSPC8	   438#	   481
GTSPC9	   450	   458#
GTSPCB	   320	   328	   378#
GTWTI4	   409	   420#
GTWTI6	   421	   428#
GTWTIO	   330	   412#
HANGOT	  2260	  2263	  2267#
HANGR3	  2261#	  2265
HANGRB	  2254	  2256#
HAVM2	  1989	  1990#
INCMRU	  1287#	  1307
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88
PCBIO.MAC	20-SEP-87 13:48		Symbol cross reference

J	   191	   192	   193	   261	   262	   268	   269	   346	   361	   368	   466	   467	   474	   501
	   507	   509	   517	   518	   522	   539	   540	   545	   571	   572	   583	   584	   633	   634
	   680	   681	   683	   703	   704	   706	   895	   903	  1038	  1042	  1089	  1091	  1093	  1389
	  1390	  1395	  1398	  1402	  1404	  1427	  1431	  1433	  1440	  1442	  1443	  1447	  1450	  1451
	  1453	  1455	  1520	  1521	  1532	  1542	  1550	  1553	  1661	  1699	  1708	  1717	  1722	  1752
	  1778	  1784	  1785	  1793	  1797	  1930	  1967	  1977	  2021	  2033	  2040	  2041	  2043	  2301
	  2304	  2307
JBTPCB	    32%	   143	   144	   152	   153	   161	   162	  2307
JOB	    45%	   262	   269	   281	   474	   501	   509	   539	   655	   669	   681	  1091	  1990	  2022
	  2041	  2055
LINKPB	   637	  1372#
LISTSN	     3	     6
LOCAD2	  1780	  1801#
LOCADJ	  1694	  1712	  1778#
M2AVAL	    29%	   679	  2039
M2HAV	  1666	  1924	  1976	  1984	  1985#	  1991
M2HRMV	   682	  1975#	  2042
M2HSWT	   291	   307	  1923#
M2Q	    29%	  1658
M2REQ	    29%	   288	   304	   678	  2038
M2SRMV	   290	   306	  1964#
M2SSWT	  1919#
M2SWT	    29%	  1659	  1920	  1965
M2WAIT	    29%	   289	   305
MAPAL1	   238#
MAPAL2	   241#	   243
MAPAL3	   242	   245#
MAPALL	   221	   223	   225	   227	   230	   234#
MAPCML	   171	   178	   224#
MAPDIE	   273	   279#
MAPR24	   272	   278#
MAPRB2	   257	   267#
MAPRDL	   171	   180	   220#
MAPRDN	   663#
MAPRDU	   171	   176	   229#
MAPREL	   660	   687#	  1716	  1832
MAPRIB	   258	   260#
MAPRL2	   691	   700#
MAPRL4	   702	   707#
MAPRL5	   712	   716#
MAPRL6	   721	   731#
MAPRL7	   746	   753#	  1180	  2193
MAPRL8	   758	   766#
MAPRLS	   287	   655#	   792	   804	   830	   850	  2028
MAPSAT	   256	   261#
MAPTB1	   250	   256#
MAPTBL	   241	   252#	  1724	  1881
MAPWLN	   171	   181	   226#
MAPWTL	   171	   179	   222#
MAPWTU	   171	   177	   231#
MAPXC4	  2015	  2038#
MAPXC7	  2017	  2046#	  2085
MAPXCH	  2009	  2011#
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88
PCBIO.MAC	20-SEP-87 13:48		Symbol cross reference

MAXPCB	    43%	   896	   956
MINPCB	    43%	   897	   957
MLOWQ	    28%	   503	   511	   542	  1703
MPALOT	   263#	   275	   297
NMRBPC	    46%	  1576	  2213
NMSTPC	    46%	  1573	  2214
NODIE	    11%
NOWRIT	  1888#
OHTDER	  2100%
OHTDTE	  2100%
OHTNUM	  2100%	  2109
OHTPAR	  2100%	  2118
OHTTAB	  2100%	  2117	  2120
ONCTIM	  1035	  1044	  1047	  1048#
P	    12	   234	   238	   260	   261	   263	   267	   268	   274	   279	   280	   283	   285	   287
	   289	   290	   291	   292	   293	   294	   295	   305	   306	   329	   341	   352	   367	   368
	   369	   373	   378	   385	   386	   389	   390	   391	   400	   408	   412	   414	   423	   426
	   429	   430	   438	   439	   440	   443	   444	   445	   473	   480	   483	   484	   485	   487
	   488	   497	   502	   508	   513	   519	   523	   532	   541	   544	   586	   591	   600	   603
	   616	   619	   620	   622	   625	   628	   631	   637	   660	   673	   680	   682	   683	   684
	   703	   705	   706	   726	   728	   731	   732	   735	   739	   743	   744	   748	   751	   762
	   763	   768	   771	   772	   773	   774	   793	   797	   798	   799	   800	   801	   802	   804
	   805	   806	   807	   808	   809	   810	   831	   851	   862	   888	   889	   890	   891	   892
	   893	   894	   895	   900	   901	   902	   903	   904	   905	   906	   907	   908	   909	   910
	   911	   926	   927	   935	   936	   937	   938	   972	   974	   975	   979	   981	   982	  1000
	  1001	  1010	  1012	  1013	  1021	  1027	  1028	  1036	  1037	  1038	  1041	  1042	  1043	  1045
	  1067	  1077	  1078	  1086	  1087	  1088	  1089	  1092	  1093	  1094	  1097	  1099	  1100	  1103
	  1104	  1106	  1150	  1153	  1157	  1167	  1168	  1169	  1176	  1177	  1178	  1179	  1181	  1182
	  1187	  1189	  1198	  1200	  1201	  1202	  1203	  1234	  1247	  1250	  1253	  1254	  1255	  1256
	  1257	  1260	  1261	  1273	  1274	  1275	  1284	  1285	  1286	  1292	  1331	  1342	  1343	  1357
	  1358	  1359	  1375	  1393	  1408	  1419	  1434	  1435	  1450	  1455	  1498	  1516	  1517	  1530
	  1538	  1540	  1545	  1548	  1549	  1550	  1556	  1557	  1581	  1582	  1587	  1588	  1630	  1642
	  1655	  1660	  1667	  1674	  1678	  1685	  1689	  1694	  1709	  1712	  1716	  1727	  1730	  1731
	  1759	  1784	  1786	  1791	  1792	  1796	  1797	  1798	  1802	  1804	  1825	  1826	  1827	  1831
	  1832	  1833	  1834	  1835	  1836	  1884	  1888	  1903	  1907	  1911	  1915	  1919	  1923	  1948
	  1952	  1956	  1960	  1964	  1975	  1993	  2014	  2020	  2021	  2024	  2026	  2028	  2029	  2030
	  2032	  2033	  2034	  2035	  2040	  2042	  2043	  2068	  2086	  2104	  2111	  2112	  2113	  2115
	  2122	  2123	  2124	  2125	  2126	  2129	  2130	  2132	  2133	  2134	  2157	  2160	  2176	  2180
	  2183	  2191	  2192	  2199	  2204	  2238	  2256	  2257	  2266	  2267	  2268	  2269	  2303
P1	   234	   235	   362	   363	   369	   496	   574	   599	   635	   636	   888	   910	  1324	  1329
	  1391	  1392	  1406	  1527	  1786	  1787	  1788	  1789	  1792
P2	   263	   264	   338	   367	   527	   624	   890	   908	  1517	  1518	  1526	  1536	  1556
P3	   891	   907
P4	   892	   906
PAGIMD	   888#	   935
PAGIN	   879	   881#
PAGOUT	   771	   879	   882#
PAGWAK	    47%	  1041
PAGWAT	    47%	  1092
PCBC24	  1585#	  1590
PCBC42	  1602#	  1607
PCBC44	  1603	  1608#
PCBC62	  1614#	  1620
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88
PCBIO.MAC	20-SEP-87 13:48		Symbol cross reference

PCBCL2	  1584#	  1594
PCBCL3	  1592	  1597#
PCBCL4	  1601#	  1609
PCBCL6	  1612#	  1628
PCBCL8	  1626	  1630#
PCBCLR	  1572#
PCBEND	  2383#
PCBIO	    11	    12#	    15
PCBIO4	   932	   935#
PCBLCC	    67#	    77
PCBLIT	  2319#
PCBLKQ	    65#	   446	   447	   464	   507	   522	   571	   633	   701	  1321	  1387	  1389	  1428	  1441
	  1532	  1793
PCBLNK	    70#	   321	   350	   356	   397	   404	  1080	  1131	  1349	  1352	  1356	  1373	  1589	  1619
	  1857	  1861	  1885	  2167	  2177	  2196	  2264
PCBPAG	    69#	   312	   343	   348	   395	   548	   632	   733	   928	  1090	  1129	  1173	  1224	  1710
	  1855	  2108	  2165	  2184	  2219	  2259
PCBPTR	    63#	   285	   311	   340	   401	   402	   448	   449	   458	   628	   769	   933	   980	  1251
	  1614	  2026
PCBRMV	  1950	  1954	  1958	  1962	  1967#	  1969
PCBS45	  1711	  1714#
PCBSTS	    66#	    73	    75	  1616	  2232
PCBSW2	  1675	  1681	  1686	  1692	  1694#
PCBSW3	  1693	  1699#
PCBSW5	  1704	  1713	  1717#
PCBSW6	  1695	  1700	  1722#
PCBSW7	  1724#	  1728
PCBSW8	  1665	  1725#
PCBSWN	  1655#
PCBSWT	  1905	  1909	  1913	  1917	  1921	  1926#
PCBTAB	   107#	  2216
PCBTIM	    64#	   630	   992	   994	  1072	  1105	  1615
PCBUSC	    68#	   314	   453	   454	   459	   460	   478	   585	   589	   629	   687	   707	  1323	  1493
	  1497	  1537	  1790	  2187
PCDCNT	  1005	  2233	  2236	  2241#
PCDNX1	  2224	  2235#
PCDNXT	  2230	  2234#
PCDTIM	  2209	  2237	  2240#
PCDTM1	  2218#	  2235
PCDTM2	  2221	  2225#
PCDTM3	  2227	  2231#
PCISTS	    75#	   437	   452	   455	   719	   736	   754	   760	   766	   962	   971	   998	  1006	  1069
	  1161	  1195	  1197	  1219	  1585	  2174	  2222	  2228	  2261
PCMLCC	    78#
PCUSTS	    73#	   471	   505	   520	   568	   597	   601	   688	   697	  1328	  1330	  1554
PCYLCC	    77#	   472	   506	   521	   598	   602	   689	   695	  1327	  1555
PERRLS	  1727	  1825#
PG	   241	   245	   247	   286	   296	   310	   317	   326	   334	   342	   345	   347	   363	   366
	   382	   394	   416	   420	   489	   593	   656	   657	   664	   665	   670	   671	   711	   724
	   725	   732	   733	   735	   740	   741	   748	   762	   773	   790	   802	   803	   805	   828
	   848	   893	   896	   897	   905	   926	   928	   937	   956	   957	   974	   976	  1012	  1014
	  1019	  1021	  1024	  1025	  1026	  1027	  1066	  1088	  1090	  1094	  1128	  1155	  1158	  1165
	  1171	  1173	  1186	  1188	  1190	  1192	  1193	  1222	  1224	  1226	  1228	  1230	  1231	  1232
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88
PCBIO.MAC	20-SEP-87 13:48		Symbol cross reference

	  1241	  1242	  1244	  1276	  1278	  1287	  1288	  1290	  1306	  1345	  1354	  1372	  1374	  1582	  1583
	  1584	  1587	  1591	  1593	  1612	  1613	  1622	  1623	  1625	  1627	  1630	  1655	  1663	  1671
	  1682	  1724	  1725	  1730	  1801	  1829	  1830	  1854	  1881	  1882	  2020	  2027	  2031	  2034
	  2104	  2105	  2107	  2108	  2125	  2129	  2165	  2166	  2184	  2219
PGE.C	   344
PGYADR	    34%	   770	   934	  2114
PGYDRT	    34%	   734	   756	  1022	  1174	  1225	  2185	  2220	  2226
PGYERR	    34%	  2128
PGYLMA	    34%	   899	   959
PGYSIO	    34%	  1040
PGYSIP	    34%	   885	   931
PGYSOP	    34%	   883	   929
PGYUNI	    34%	   960
PJBSTS	    32%	   504	   510	   543	  1547	  1702	  1795	  2314
PJOBN	    45%
PPCBIO	   924	   926#	  1000	  1009
PPCBWC	   194#	   534
PRAVAL	    27%	   495	   717	  1680
PRQ	    27%	  1672
PRREQ	    27%	   318	   327	   335	   388	   417	   494	   594	   716	  1575	  1679
PRSRMV	   390	  1960#
PRSSWT	  1915#
PRSWT	    27%	  1673	  1916	  1961
PRWAIT	    27%	   389
PSAVAL	    27%	   492	   714	  1691
PSQ	    27%	  1683
PSREQ	    27%	   316	   325	   333	   384	   415	   491	   592	   713	  1572	  1690
PSSRMV	   386	  1956#
PSSSWT	  1907#
PSSWT	    28%	  1684	  1908	  1957
PSWAIT	    27%	   385
PWAIT1	  2278	  2279#
PWAITZ	  2275	  2276#
QUEPCB	    28%	   191	   192	   193	   346	   467	   540	   545	   634	  1390	  1404	  1427	  1440	  1443
	  1542	  1699	  1708	  1717	  1778	  1783	  2304
QUYPCN	   193#	   463	   517	   583	  1396	  1401	  1403	  1407	  1420	  1432	  1454	  1520	  1539	  1779
QUYPCP	   191#	  1405	  1430	  1449	  1452
QUYPCS	   192#	   468	   470	   579	   636	  1392	  1406	  1421	  1444	  1446	  1522	  1533	  1541	  1544
	  1714	  1787	  1789	  2311
RBMASK	    21%	   239
RBREAL	    21%	   237	   239
RBSPAR	    21%
RBYPNO	    21%
RBYUNI	    21%
RELM2	   672	   677	   678#
RELRB2	   846	   848#
RELRIB	   826	   828#
RELSAT	   788	   790#
REQTAB	    29%	  1757
RESLR2	  1279#	  1282
RESLRU	   726	  1273#
RESMRU	   731	  1306#
RIAVAL	    28%	   148	   157	   432
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88
PCBIO.MAC	20-SEP-87 13:48		Symbol cross reference

RIQ	    28%	  1676
RIREQ	    28%	   147	   156	   428	   431
RISRMV	   430	  1952#
RISSWT	  1911#
RISWT	    28%	  1677	  1912	  1953
RIWAIT	    28%	   429
RMVJST	  1660	  1667	  1674	  1678	  1685	  1689	  1752#
RNQ	    46%	  1546	  1794	  2315
RSTWAI	   972	  1010	  1035#
S	   861	   900	   902
S$ENTR	    11	    17	   239	   244	   248	   280	   337	   353	   365	   399	   419	   512	   596	   659
	   898	   958	   969	  1133	  1156	  1160	  1235	  1351	  1859	  1863	  1889	  1929	  1980	  2169
S$EVEN	   238	   279	   352	  1234	  1888
S$HALT	    11	   238	   244	   248	   279	   337	   352	   365	   399	   419	   512	   596	   659	   898
	   958	   969	  1133	  1156	  1160	  1234	  1351	  1859	  1863	  1888	  1929	  1980	  2169
S$INFO	   238	   279	   352	  1234	  1888
S$JOB	   352	   353
S$NAME	    15#	   244	   248	   337	   365	   399	   419	   512	   596	   659	   898	   958	   969	  1133
	  1156	  1160	  1351	  1859	  1863	  1929	  1980	  2169
S$NONA	    14	    17	   239	   244	   248	   280	   337	   353	   365	   399	   419	   512	   596	   659
	   898	   958	   969	  1133	  1156	  1160	  1235	  1351	  1859	  1863	  1889	  1929	  1980	  2169
S$PATC	   238	   279	   352	  1234	  1888
S$STOP	   238	   239	   279	   280	  1234	  1235	  1888	  1889
S$TEMP	    11#	    11	   238#	   238	   244#	   244	   248#	   248	   279#	   279	   337#	   337	   352#	   352
	   365#	   365	   399#	   399	   419#	   419	   512#	   512	   596#	   596	   659#	   659	   898#	   898
	   958#	   958	   969#	   969	  1133#	  1133	  1156#	  1156	  1160#	  1160	  1234#	  1234	  1351#	  1351
	  1859#	  1859	  1863#	  1863	  1888#	  1888	  1929#	  1929	  1980#	  1980	  2169#	  2169
S$XCT	    17	   239	   244	   248	   280	   337	   353	   365	   399	   419	   512	   596	   659	   898
	   958	   969	  1133	  1156	  1160	  1235	  1351	  1859	  1863	  1889	  1929	  1980	  2169
SATBAD	    39%	  1635
SATBRD	    39%	  1636
SATFUL	    38%	  1632
SATON1	  2165#	  2168
SATON2	  2166	  2171#
SATON3	  2174#	  2178	  2201
SATON4	  2171	  2183#
SATON5	  2184#	  2197
SATON8	  2186	  2190	  2191	  2196#
SATONC	  2148	  2156#
SATWRT	   750	  1580	  2148	  2149#	  2156	  2159	  2179	  2189	  2200	  2203
SAVE4	    45%	  2276	  2279
SETPCB	   341	   631	  1321#	  1791
SETRUN	    46%	  1548	  1796
SIAVAL	    30%	   166	   425
SIQ	    30%	  1687
SIREQ	    28%	   165	   422	   424
SISRMV	   426	  1948#
SISSWT	  1903#
SISWT	    30%	  1688	  1904	  1949
SIWAIT	    30%	   423
SMMPXC	  2081	  2083#
SPCBWC	   195#	   547
SRCOHT	  2100%	  2115
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88
PCBIO.MAC	20-SEP-87 13:48		Symbol cross reference

SRPRPT	    25%	  1639
STACML	    97#	   173	   224	   581	  1527	  1534
STALOK	    96#	   574	   690	  1324	  1478	  1524
STARDL	    99#	   220	  1481
STARDU	    94#	   229
STAWLN	   100#	   173	   226	  1487
STAWTL	    98#	   173	   222	  1486
STAWTU	    95#	   173	   231
STCMPL	    90#	   186	   569	   696	  1476	  1495	  1515	  1551
STDDRF	    80#	  1004
STDPRE	    82#	   172	   720	   970	  1196
STDREA	    83#	   172	   722	   737	   968	  1007	  1162	  1220	  1586	  2262
STDWAG	    86#	   172	   737	   759	   995	  1070	  1073	  1162	  1220	  1586	  2175	  2223	  2229	  2262
STDWRT	    85#	   172	   737	   757	   963	  1003	  1070	  1162	  1220	  1586	  2175	  2223	  2229	  2262
STPBAD	    39%	  1597
STPCHK	    39%	  1258	  1597
STPDRF	    81#	  2231
STPINC	    39%	  1258	  1597
STPREA	    84#	   172
STPRPT	    39%	  1597
STQPCB	   103#	   362	   469	   496	   580	   635	  1391	  1425	  1438	  1445	  1523	  1543	  1715	  1788
	  2312
STRBTS	    25%	  1640
STRDDB	    25%	  1599	  1638
STRIOS	   859	   861#
STRUNI	    25%	  1600
STSNEW	    91#	   189	   696
STTAOB	    38%	  1605
STTLEN	    38%	  1606
STTPTR	    38%	  1602
STTSTS	    39%	  1259	  1604
STUPL2	  1520#	  1529	  1536
STUPL3	  1519	  1522#	  1553
STUPL4	  1526	  1530#
STUPL6	  1525	  1537#
STUPL7	  1531	  1538#
STUPLQ	   473	   508	   523	   705	  1515#
STUPND	  1521	  1528	  1535	  1552	  1554#
STWRTL	    89#	   187	   189	   696	  1483	  1491
STYINC	    38%	   984
SWPENQ	    47%	   901
T1	   143	   144	   152	   153	   161	   162	   236	   237	   239	   280	   281	   292	   295	   311
	   340	   347	   348	   350	   351	   354	   356	   357	   361	   438	   441	   442	   445	   446
	   448	   453	   459	   463	   464	   465	   466	   468	   469	   470	   471	   478	   479	   483
	   486	   503	   504	   505	   510	   511	   520	   568	   569	   579	   580	   581	   589	   590
	   597	   601	   616	   620	   627	   655	   669	   688	   696	   697	   719	   720	   722	   736
	   737	   744	   745	   749	   750	   754	   757	   759	   760	   766	   798	   809	   960	   961
	   967	   991	  1014	  1015	  1017	  1018	  1022	  1023	  1069	  1070	  1073	  1099	  1100	  1105
	  1106	  1107	  1109	  1110	  1129	  1130	  1177	  1181	  1198	  1201	  1219	  1220	  1225	  1227
	  1232	  1233	  1235	  1236	  1237	  1238	  1239	  1240	  1253	  1257	  1273	  1277	  1278	  1282
	  1286	  1322	  1323	  1325	  1326	  1327	  1346	  1372	  1373	  1419	  1420	  1422	  1432	  1434
	  1441	  1442	  1447	  1451	  1454	  1476	  1483	  1491	  1495	  1515	  1545	  1546	  1547	  1549
	  1551	  1554	  1572	  1573	  1575	  1576	  1585	  1586	  1599	  1600	  1601	  1608	  1609	  1639
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88
PCBIO.MAC	20-SEP-87 13:48		Symbol cross reference

	  1640	  1658	  1661	  1672	  1676	  1683	  1687	  1722	  1757	  1758	  1779	  1780	  1783	  1785	  1794
	  1795	  1803	  1805	  1825	  1835	  1855	  1856	  1882	  1883	  1885	  1886	  1903	  1904	  1907
	  1908	  1911	  1912	  1915	  1916	  1919	  1920	  1923	  1924	  1926	  1927	  1928	  1930	  1948
	  1949	  1952	  1953	  1956	  1957	  1960	  1961	  1964	  1965	  1967	  1969	  1971	  1975	  1976
	  1977	  1979	  1981	  1991	  1992	  1994	  2011	  2015	  2022	  2029	  2045	  2046	  2047	  2049
	  2052	  2055	  2083	  2102	  2103	  2105	  2106	  2107	  2117	  2121	  2128	  2156	  2158	  2171
	  2202	  2203	  2220	  2221	  2222	  2223	  2226	  2227	  2228	  2229	  2231	  2232	  2256	  2259
	  2260	  2261	  2262	  2268	  2303	  2304	  2306	  2307	  2311	  2312	  2314	  2315
T2	    73	    75	    77	   220	   222	   224	   226	   229	   231	   235	   284	   285	   293	   294
	   310	   311	   312	   314	   321	   322	   340	   342	   343	   354	   391	   394	   395	   397
	   398	   402	   404	   405	   414	   440	   441	   444	   447	   449	   454	   458	   460	   464
	   467	   478	   485	   488	   507	   522	   542	   543	   545	   548	   571	   585	   589	   617
	   627	   628	   629	   630	   632	   633	   634	   657	   658	   687	   701	   707	   733	   768
	   769	   772	   799	   808	   899	   927	   928	   933	   936	   959	   980	   992	   994	  1017
	  1037	  1039	  1040	  1043	  1072	  1078	  1080	  1081	  1087	  1090	  1104	  1105	  1128	  1129
	  1131	  1132	  1155	  1159	  1173	  1224	  1235	  1250	  1251	  1259	  1260	  1283	  1306	  1321
	  1323	  1342	  1345	  1346	  1348	  1349	  1350	  1352	  1354	  1356	  1358	  1373	  1374	  1387
	  1389	  1390	  1427	  1428	  1440	  1441	  1443	  1493	  1497	  1532	  1537	  1542	  1584	  1589
	  1590	  1601	  1602	  1604	  1605	  1606	  1612	  1614	  1615	  1616	  1617	  1619	  1620	  1638
	  1640	  1659	  1666	  1673	  1677	  1684	  1688	  1708	  1710	  1752	  1754	  1756	  1778	  1783
	  1790	  1793	  1803	  1826	  1834	  1854	  1855	  1857	  1858	  1861	  1862	  1883	  1990	  1992
	  2025	  2026	  2030	  2032	  2050	  2051	  2111	  2114	  2118	  2120	  2124	  2134	  2164	  2165
	  2167	  2168	  2177	  2178	  2183	  2184	  2187	  2196	  2197	  2199	  2218	  2219	  2232	  2257
	  2258	  2259	  2264	  2265	  2267
T3	   240	   241	   243	   250	   270	   273	   278	   282	   283	   312	   313	   333	   335	   336
	   343	   344	   345	   348	   349	   395	   396	   400	   401	   402	   415	   417	   418	   436
	   437	   446	   447	   448	   449	   452	   455	   458	   459	   460	   472	   506	   521	   529
	   548	   549	   592	   594	   595	   598	   602	   689	   694	   695	   700	   800	   807	   962
	   963	   968	   970	   971	   983	   984	   995	   998	  1003	  1004	  1006	  1007	  1072	  1074
	  1075	  1076	  1077	  1107	  1108	  1158	  1159	  1164	  1165	  1176	  1182	  1187	  1195	  1196
	  1197	  1237	  1238	  1258	  1259	  1274	  1276	  1277	  1279	  1280	  1281	  1283	  1285	  1328
	  1329	  1330	  1343	  1344	  1348	  1353	  1356	  1357	  1396	  1397	  1398	  1403	  1407	  1485
	  1490	  1492	  1496	  1555	  1597	  1604	  1613	  1617	  1618	  1621	  1622	  1624	  1702	  1703
	  1710	  1711	  1725	  1726	  1860	  1880	  1881	  1887	  2023	  2024	  2057	  2060	  2062	  2065
	  2112	  2123	  2133	  2174	  2175	  2185	  2186	  2187	  2188
T4	   245	   246	   314	   315	   316	   318	   319	   325	   327	   328	   353	   358	   364	   366
	   453	   454	   535	   538	   546	   599	   656	   663	   664	   670	   690	   701	   702	   704
	   707	   708	   734	   735	   755	   756	   769	   770	   801	   806	   881	   882	   883	   884
	   885	   929	   930	   931	   932	   933	   934	   973	   992	   993	   994	   999	  1008	  1011
	  1035	  1044	  1065	  1079	  1082	  1086	  1097	  1101	  1157	  1161	  1162	  1167	  1174	  1175
	  1202	  1275	  1279	  1280	  1284	  1387	  1388	  1395	  1401	  1402	  1405	  1421	  1425	  1430
	  1431	  1433	  1438	  1444	  1445	  1446	  1449	  1452	  1453	  1478	  1481	  1486	  1487	  1493
	  1494	  1522	  1523	  1524	  1533	  1534	  1539	  1540	  1541	  1543	  1544	  1664	  1714	  1715
	  1723	  1724	  1728	  1827	  1828	  1829	  1830	  1833	  2058	  2059	  2063	  2064	  2113	  2117
	  2120	  2122	  2132	  2213	  2214	  2215	  2216	  2218	  2235	  2276	  2279
TAGN25	   590	   597#
TAGON1	   579#	   584
TAGON2	   572	   589#
TAGONN	   497	   532	   568#
TIMPCD	  2209#
TPOPJ	    32%	    45%	    46%	  1931	  1970	  1972	  1982	  2310	  2313	  2317
TPOPJ1	    32%	  2308	  2316
U	   889	   909	   979	   982	  1150	  1151	  1153	  1154	  1168	  1199	  1203	  1254	  1256
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88
PCBIO.MAC	20-SEP-87 13:48		Symbol cross reference

UNIMRC	    23%	   967
UNIMWC	    23%	   991
UNIPPU	    23%
UNISTR	    23%	  1608
UNISTT	    23%	  1601
UNLKO2	  1429	  1434#	  1448	  1456
UNLNK2	   439	   484	  1342#	  1804
UNLNK3	  1346#	  1350
UNLNK5	  1347	  1352#
UNLOK1	  1426	  1430#
UNLOK2	  1422	  1438#
UNLOK4	  1439	  1449#
UNLOKQ	  1419#	  1538
UNTTBL	    46%	   961
UPTEP0	   140	   149	   158
UPTRB2	    36%	   151
UPTRIB	    36%	   142
UPTSAT	    36%	   160
WAIT1	    46%	  2280
WATOUT	  1082	  1102#
WATPC2	  1069#	  1081
WATPC4	  1071	  1080#
WATPC5	  1085#	  1110
WATPC6	  1099#	  1111
WATPC7	  1101	  1104#
WATPCB	  1062	  1065#
WSCHED	    46%	   513	   544
%CTADR	   144#	   153#	   162#	   366	   670	  1725	  1829	  2057	  2058	  2059	  2060
%CTAMX	   137#	   364
%CTBYP	   140#	   149#	   158#	   245	   270	   345	   664	  2049	  2050	  2051	  2052
%CTLRU	   145#	   154#	   163#	  1014	  1155	  1158	  1232	  1278	  1613
%CTLST	   141#	   150#	   159#	   310	   347	   394	  1128	  1345	  1354	  1372	  1374	  1584	  1612	  1854
	  1882	  2164	  2258
%CTMRU	   146#	   155#	   164#	  1165	  1241	  1243	  1245	  1276	  1287	  1289	  1291	  1306	  1622	  1624
%CTSTS	   143#	   152#	   161#	   282	   363	   656	  1830	  2023	  2062	  2063	  2064	  2065
%CTUPT	   142#	   151#	   160#	   247	   271	   284	   342	   657	   665	   791	   796	   829	   849	  2011
	  2012	  2016	  2025	  2045	  2046	  2047	  2083	  2084	  2107
%CTWRQ	   147#	   156#	   165#	   724	   740	  1025	  1190	  1228
%CTWVL	   148#	   157#	   166#	   725	   741	  1026	  1192	  1193	  1230	  1231
%RB2	   371	   667	  2067
%RB2.C	   149#	   253	   296	   671	   848	   849	  1243	  1244	  1289	  1290	  1624	  2012	  2016	  2031
	  2046	  2050	  2052	  2058	  2060	  2063	  2065	  2084
%RB2.N	   149	   150
%RIB	   370	   666	  2066	  2103
%RIB.C	   140#	   254	   270	   271	   282	   284	   286	   828	   829	  1066	  1242	  1245	  1288	  1291
	  1583	  1623	  1625	  1627	  2011	  2023	  2025	  2027	  2045	  2047	  2049	  2051	  2057	  2059
	  2062	  2064	  2083	  2103	  2258
%RIB.N	   140	   141
%SAT	   372	   668	  2102
%SAT.C	   158#	   252	   317	   326	   334	   382	   416	   420	   489	   593	   711	   745	   790	   791
	   796	   803	   976	  1019	  1024	  1171	  1179	  1186	  1188	  1222	  1226	  1591	  1593	  1663
	  1682	  2102	  2164
%SAT.N	   158	   159
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88
PCBIO.MAC	20-SEP-87 13:48		Symbol cross reference

%UPT	    36%	   140	   142	   149	   151	   158	   160
PCBIO	PCB HANDLERS	MACRO 12.5-46.0 14:28 13-JAN-88
PCBIO.MAC	20-SEP-87 13:48		Macro/Opdef cross reference

CLRPT	   370	   371	   372	   666	   667	   668	  2066	  2067
CLRPTO	   370	   371	   372	   666	   667	   668	  2066	  2067
CTLBLK	   123#	   140	   149	   158
DSKOFF	    52#	   451	   718	   753	  1068	  1098	  1194	  1218	  2225
DSKON	    53#	   456	   727	   738	   742	   747	   761	   767	  1085	  1102	  1246	  2234
EPTPGS	   140	   149	   158
PJRST	   307	   672	   792	   830	   850	  1009	  1307	  1755	  1806	  2280
PRINTF	  1598	  1637
STOPCD	    10	   238	   244	   248	   279	   337	   352	   365	   399	   419	   512	   596	   659	   898
	   958	   969	  1133	  1156	  1160	  1234	  1351	  1859	  1863	  1888	  1929	  1980	  2169
WRPI	   451	   456	   718	   727	   738	   742	   747	   753	   761	   767	  1068	  1085	  1098	  1102
	  1194	  1218	  1246	  2225	  2234
$END	  2319 P@$