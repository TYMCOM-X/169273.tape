UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 1
S.MAC	13-JAN-88 11:55		S.MAC - with system parameter file for P035/D, January 1988

     1				SUBTTL	S.MAC - with system parameter file for P035/D, January 1988
     2
     3				IF2,<IFNDEF LISTSN,<TAPE>>	;Skip to PASS2 in all but COMMON.LST
     4				;THIS MODULE ASSEMBLED WITH KL-10 PARAMETER FILE - KLSYM.MAC
     5
     6					IF2,<IFNDEF LISTSN,<		;LIST KLSYM.MAC IN COMMON ONLY
     7								TAPE>>
     8				TITLE	UUOCON - UUO HANDLER AND UUO ROUTINES
     9
    10					STOPCD(,ENTRY,UUOCON)^
    11					ENTRY	UUOCON		;For library searches
    12	000000'	260040	000000*	UUOCON::PUSHJ	P,DIE		;**** Default stopcode for "UUOCON" ****
    13	000001'	656557	435756		SIXBIT	/UUOCON/  	;Title of module
    14	000002'	000000	000000		S$NONAME,,0		;?NONAME stopcode "UUOCON+nnn(nnnnnn)"
    15			000000'	S$NAME==UUOCON			;For STOPCDs with no arguments
    16					SALL>
    17				^
    18
    19				IFNDEF .ELINK,<
    20				    IFDEF  .LNKEND,<SYN .LNKEND,.ELINK>
    21				PRINTF(% .ELINK needs to be changed to .LNKEND for macro %53B)
    22				> ;end IFDEF .ELINK
    23
    24				IFNDEF MAXCAL,<XP MAXCAL,56>
    25							;DEFINE HIGHEST CALLI UUO WHICH HAS
    26							; CORRESPONDING CALL MUUO
    27
    28				COMMENT ! UUOCON
    29				FUNCTION: PUBLIC NO-TRAP MUUO HANDLER AND CALL [SIXBIT /NAME/],
    30				 CALLI AC,INDEX HANDLER. THE USER'S UPT MUUO NEW PC WORD
    31				 CAUSES EXECUTION TO START HERE AT UUOPNT WHEN HE GIVES AN
    32				 MUUO. IF MUUO IS EXECUTED AS A RESULT OF A TRAP CONDITION,
    33				 THEN THE NEW PC WORD SELECTED POINTS AT UUOPTR.
    34
    35				RESTRICTION: UUOS CANNOT BE CALLED BY INTERRUPT SERVICE ROUTINES.
    36				 THE UUO HANDLER IS PURE OTHERWISE (ALL STORAGE IN CONTEXT
    37				 PAGES AND JBT TABLES, ETC.)
    38				!
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 2
UUOCON.MAC	 4-DEC-87 16:09		UUOPNT DISPATCH,CALLI'S & ETC.

    39				SUBTTL UUOPNT DISPATCH,CALLI'S & ETC.
    40
    41				INTERNAL NINTRP,NOUTRP,NWATRP,NERTRP,NEFTRP,NSPTRP
    42				EXTERNAL ERRCAL
    43				EXTERNAL UPTSTS,STRTAD,STRTCL,ERRNSA,EPT,PGYNXM,CURUPT,%UPT,%UPS,%UPX,EPYPSN
    44				EXTERNAL UPTNTV,UPTABK
    45				EXTERNAL UPSSWE,UPSABK,ERRABK
    46				EXTERN JOBOPC,TTYRES,CHGPPN,EPLLEN
    47				EXTERNAL JOBDDT
    48				IFCPU (KI),<EXTERNAL TIMCHN>
    49				EXTERNAL UPTPDL,UPTRNM,UPTRPN,UPTUUO
    50				EXTERNAL ERRPIO,UPTXEI
    51				EXTERNAL TTYFNU,JBTWCH
    52				EXTERN CORUUO,HOLD,ILLINS
    53				EXTERN ERRIUC,JOBKL
    54				EXTERN UGTSEG,URUN,USCHD1,LOGOFF
    55				EXTERN WSYNC
    56				EXTERNAL PUUOAC,UUOMNR
    57				EXTERNAL JOB,JBTSTS,TIMEF,JBTUPM
    58				EXTERNAL UPTACP,STKAC,KTRRET
    59				EXTERN JOBOPC,UPNPSR,UPSPSR
    60				EXTERNAL ADJMWS, AGEPAG
    61				EXTERNAL CPOPJ1,CPOPJ,TPOPJ,TPOPJ1,T2POPJ
    62				EXTERNAL CBLAMB,DEVLST,DVCNSG,STDRNG,TTYFND,TTYUUO,UUOTAB
    63				EXTERNAL CLKTRP
    64				EXTERNAL WRTACR
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 3
UUOCON.MAC	 4-DEC-87 16:09		UUOPNT - UUO from Public mode, No Trap (normal Monitor calls)

    65				SUBTTL	UUOPNT - UUO from Public mode, No Trap (normal Monitor calls)
    66		777777	777776		XP	PDNMUP,-2	;PDNMUP(P) IS WHERE UUO ROUTINES LOOK AT PC.
    67
    68	000003'	701140	004670'	UUOPNT::EXECAC			;SWITCH TO EXEC MODE ACS
    69	000004'	336000	000000*		SKIPN	JOB
    70	000005'	256000	004671'		 STOPCD (.,STOP,UUOJB0,,<UUO from Job 0>)
    71	000006'	200540	000424*		MOVE	M,%UPT+UPTMUU	;PICON jumps to UUOPN1 with UUO in M
    72	000007'	202540	000000*	UUOPN1::MOVEM	M,%UPT+UPTUUO	;Store top-level MUUO for debugging
    73	000010'	200100	000004*		MOVE	J,JOB		;J should already have job (from USRXIT)
    74	000011'	200200	000425*		MOVE	F,%UPT+UPTMUP	;Get PC, it is in user mode
    75	000012'	552202	000000*		HRRZM	F,JBTPC##(J)	;Store PC, clear saved DDB address
    76	000013'	201200	000000		MOVEI	F,0		;BECAUSE ERRCON LOOKS FOR ADDRESS CHECK ERROR
    77	000014'	200040	004674'		MOVE	P,[IOWD EPLLEN,%UPT+UPTPDL] ;SETUP STACK POINTER
    78	000015'	261040	000425*		PUSH	P,%UPT+UPTMUP	;PC OF UUO GOES ON FIRST.
    79	000016'	261040	004675'		PUSH	P,[0]		;DUMMY UP FAKE CHGSTS WORD
    80	000017'	260040	000050'		PUSHJ	P,UUODSP	;CALL THE DISPATCH ROUTINE
    81	000020'	254000	000023'		  JRST	UUOPN3		;NON-SKIP RETURN
    82	000021'	354001	777777	UUOPN2:	  AOSA	PDNMUP+1(P)	;SKIP RETURN
    83	000022'	254000	000025'		JRST	UUOPN4		;DOUBLE SKIP, A LITTLE SLOWER.
    84	000023'	262040	000006	UUOPN3:	POP	P,T1		;GET JUNK OFF STACK
    85	000024'	254000	000076'		JRST	USRXIT		;AND RETURN TO USER
    86
    87	000025'	350001	777777	UUOPN4:	AOS	PDNMUP+1(P)	;ONE MORE TIME FOR DOUBLE SKIP
    88	000026'	254000	000021'		JRST	UUOPN2		;AND GO BACK.
    89
    90
    91				;TYMCOM-X does not use Concealed mode.
    92
    93	000027'	256000	004676'	UUOCNT:: STOPCD (.,JOB,UUOCNT,,<UUO from Concealed mode, No Trap>)
    94
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 4
UUOCON.MAC	 4-DEC-87 16:09		UUOKNT - UUO from Kernel mode, No Trap (MUUO from the EXEC)

    95				SUBTTL	UUOKNT - UUO from Kernel mode, No Trap (MUUO from the EXEC)
    96
    97				;Here when monitor does a UUO on behalf of the user.
    98				;Note that a VREMOV uuo can be nested as a result of a CHANIO.
    99
   100				IFCPU (KI),<
   101				UUOKNT::MOVEM 17,@%UPT+UPTACP	;SAVE 17 FIRST
   102					JSP	17,STKAC	;PUSH THE REST ON THE AC STACK
   103				>;END IFCPU (KI)
   104				IFNCPU (KI),<
   105	000030'	202720	000000*	UUOKNT::MOVEM	16,@%UPT+UPTACP	;FOR KL, SAVE AC 16
   106	000031'	265700	000000*		JSP	16,STKAC
   107				>;END IFNCPU (KI)
   108
   109	000032'	200540	000424*		MOVE	M,%UPT+UPTMUU	;GET UUO INTO M FIRST IN CASE PDL OV
   110	000033'	261040	000425*		PUSH	P,%UPT+UPTMUP	;PUT PC ONTO STACK
   111					MOVEI	F,0		;NO PDL OV, SO CLEAR F FOR ILL MEM REF/ADDRESS CHECK DISTINCTIO
   112	000034'	201200	000000	N
   113	000035'	702640	000006		CHGSTS	T1		;GET STATE OF CHARGING CLOCK
   114	000036'	261040	000006		PUSH	P,T1		;SAVE THAT ON STACK
   115	000037'	260040	000050'		PUSHJ	P,UUODSP	;DO THE UUO
   116	000040'	334000	000000		  SKIPA			;NON-SKIP
   117	000041'	350001	777777		AOS	PDNMUP+1(P)	;SKIP
   118	000042'	262040	000006		POP	P,T1		;GET CLOCK STATE BACK
   119	000043'	602300	010000		TRNE	T1,CHGON	;IF CHARGING WAS ON,
   120	000044'	702600	432000*		 CHARGE			;THEN TURN IT BACK ON NOW.
   121	000045'	262040	000425*		POP	P,%UPT+UPTMUP	;GET PC BACK INTO MUP
   122	000046'	254000	000000*		JRST	KTRRET		;AND RETURN TO UUO CALLER.
   123
   124
   125				;TYMCOM-X does not use Supervisor mode
   126
   127	000047'	256000	004701'	UUOSNT:: STOPCD (.,CPU,UUOSNT,,<UUO from Supervisor mode, No Trap>)
   128
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 5
UUOCON.MAC	 4-DEC-87 16:09		UUOKNT - UUO from Kernel mode, No Trap (MUUO from the EXEC)

   129				COMMENT ~ CONVENTIONS FOR UUO AND CALLI SUBROUTINES
   130
   131				UUO ROUTINES:
   132
   133				CALL: UUO ROUTINES ARE CALLED WITH PUSHJ TYPE CALL.
   134
   135				ENTRY: M CONTAINS THE UUO, W CONTAINS AC NUMBER (CHANNEL NUMBER),
   136				PDNMUP(P) HAS PC OF UUO CALLER. J IS NOT SETUP. F SHOULD BE
   137				SET TO ZERO.
   138
   139				ACCUM: UUO SUBROUTINES CAN USE ALL ACS EXCEPT P.
   140
   141				EXIT: POPJ RETURN FOR NON-SKIP RETURN TO UUO CALLER, CPOPJ1
   142				TYPE RETURN FOR SKIP RETURN TO UUO CALLER, AND CPOPJ2 TYPE
   143				RETURN FOR DOUBLE SKIP RETURN. IF STATE OF CHARGING CLOCK
   144				WAS CHANGED, NO NEED TO RESTORE, UUO EXIT CODE RESTORES CLOCK
   145				TO BE ON.
   146
   147				CALLI ROUTINES:
   148
   149				CALL: CALLI ROUTINES ARE CALLED WITH PUSHJ TYPE CALL.
   150
   151				ENTRY: T1 CONTAINS CONTENTS OF USER AC, W AND RH(M) CONTAIN
   152				USER AC NUMBER (FOR STORING RETURN ARGS), J CONTAINS JOB NUMBER,
   153				LH(W) HAS 1B0 SET IF THE CALLI IS PHYSICAL ONLY (THOSE CALLIS
   154				IN WHICH 1B18 AND 1B19 ARE DIFFERENT ARE PHYSICAL ONLY).
   155				IF CHARGING CLOCK STATE WAS CHANGED, NO NEED TO RESTORE IT,
   156				UUO EXIT CODE WILL RESTORE.
   157
   158				ACCUM: CAN SMASH ALL ACS EXCEPT P
   159
   160				EXIT: POPJ FOR NON-SKIP, CPOPJ1 FOR SKIP, CPOPJ2 FOR DOUBLE
   161				SKIP. STATE OF CHARGING CLOCK NEED NOT BE RESTORED IF IT
   162				WAS CHANGED.
   163				~
   164
   165	000050'	135500	000000*	UUODSP:	LDB	W,PUUOAC	;GET USER'S CHANNEL/AC NUMBER
   166	000051'	607540	740000		TLNN	M,740000	;Opcodes 000 to 037?
   167	000052'	254000	000000*		 JRST	ILLINS##	;000 is always illegal, 001-037 never get here
   168	000053'	603540	700000		TLNE	M,700000	;Greater than 077?
   169	000054'	254000	000063'		 JRST	INSSIM		;Go to INStruction SIMulator
   170				;Here for opcodes 040 to 077 only
   171	000055'	510340	000013		HLLZ	T2,M		;GET LH OF UUO INTO LH OF T2
   172	000056'	241340	000010		ROT	T2,^D8		;SHIFT ALL BUT LO ORDER BIT INTO RH OF T2
   173	000057'	335000	000007		SKIPGE	T2		;IF UUO IS ODD,
   174	000060'	334247	777760*		  SKIPA	U,UUOTAB-20(T2)	;DISPATCH FROM RH ELSE
   175	000061'	204247	777760*		 MOVS	U,UUOTAB-20(T2)	; DISPATCH FROM LH
   176	000062'	254005	000000		JRST	(U)		;RETURN ADDRESS IS ON PDL.
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 6
UUOCON.MAC	 4-DEC-87 16:09		INSSIM - instruction simulator

   177				SUBTTL	INSSIM - instruction simulator
   178
   179				 PURGE ADJSP,ADJBP,DADD,DSUB,DMUL,DDIV	;Cancel definitions in KISYM.MAC
   180				;OPDEF	UJEN	[100B8]		;User-mode Jump and ENable PI system (TOPS10)
   181				;OPDEF		[101B8]		;unassigned (UMOVEI on TENEX)
   182				;OPDEF	GFAD	[102B8]		;G-floating ADD (new KL microcode only)
   183				;OPDEF	GFSB	[103B8]		;G-floating SUB (new KL microcode only)
   184				 OPDEF	JSYS	[104B8]		;TOPS-20 Jump to SYStem monitor call
   185				 OPDEF	ADJSP	[105B8]		;KL,KS Adjust Stack Pointer
   186				;OPDEF	GFMP	[106B8]		;G-floating MUL (new KL microcode only)
   187				;OPDEF	GFDV	[107B8]		;G-floating DIV (new KL microcode only)
   188				;110=DFAD, 111=DFSB, 112=DFMP, 113=DFDV, KI double-precision floating point
   189				 OPDEF	DADD	[114B8]		;KL,KS 71-bit integer ADD
   190				 OPDEF	DSUB	[115B8]		;KL,KS 71-bit integer SUB
   191				 OPDEF	DMUL	[116B8]		;KL,KS 141-bit integer MUL
   192				 OPDEF	DDIV	[117B8]		;KL,KS 141-bit integer DIV
   193				;120=DMOVE, 121=DMOVN, 124=DMOVEM, 125=DMOVNM, KI double-word moves
   194				 OPDEF	FIX	[122B8]		;KI convert floating point to integer
   195				 OPDEF	EXTEND	[123B8]		;KL,KS extended instructions
   196				 OPDEF	FIXR	[126B8]		;KI convert floating to integer rounding
   197				 OPDEF	FLTR	[127B8]		;KI convert integer to floating point rounding
   198				 OPDEF	UFA	[130B8]		;KA d.p. partial add  (not in new KL microcode)
   199				 OPDEF	DFN	[131B8]		;KA d.p. floating neg (not in new KL microcode)
   200				 OPDEF	FSC	[132B8]		;KA floating scale (works in KI,KL,KS,F3)
   201				 OPDEF	ADJBP	[133B8]		;KL,KS adjust byte pointer if AC field nonzero
   202				 OPDEF	FADL	[141B8]		;KA d.p. floating add (not in new KL microcode)
   203				 OPDEF	FSBL	[151B8]		;KA d.p. floating sub (not in new KL microcode)
   204				 OPDEF	FMPL	[161B8]		;KA d.p. floating mul (not in new KL microcode)
   205				 OPDEF	FDVL	[171B8]		;KA d.p. floating div (not in new KL microcode)
   206				 OPDEF	XJRSTF	[HALT 5,]	;KS jump&restore flags (also in extended KL)
   207
   208	000063'	135340	004704'	INSSIM:	LDB	T2,[POINT 9,M,8];Get opcode (000-777)
   209	000064'	205440	777777		MOVSI	T4,-SIMLEN	;AOBJN pointer
   210	000065'	135400	004705'	INSIM1:	LDB	T3,[POINT 9,SIMTBL(T4),8]
   211	000066'	316340	000010		CAMN	T2,T3		;Match?
   212	000067'	254031	000072'		 JRST	@SIMTBL(T4)	;Yes, go do it
   213	000070'	253440	000065'		AOBJN	T4,INSIM1	;Try all
   214	000071'	254000	000052*		JRST	ILLINS##	;Not in our list, illegal instruction
   215
   216	000072'	104000	000074'	SIMTBL:	JSYS	U.JSYS	;List of opcodes and address of routine
   217				IFCPU(F3),<
   218					FIXR	U.FIXR	;KI Floating to integer, with rounding
   219					FLTR	U.FLTR	;KI Integer to floating, with rounding
   220					DFAD	U.DFAD	;KI Double floating add
   221					DFSB	U.DFSB	;KI Double floating subtract
   222					DFMP	U.DFMP	;KI Double floating multiply
   223					DFDV	U.DFDV	;KI Double floating divide
   224							;KL DADD and DSUB appear to work on the F3
   225				;*;	ADJBP	U.ADBP	;KL Adjust byte pointer (needs microcode change)
   226				;*;	DMUL	U.DMUL	;KL Double integer multiply, quad-word result
   227				;*;	DDIV	U.DDIV	;KL Quad-word divide, double integer results
   228				;WARNING: (15-MAY-86) Bug in F3 microcode - DDIV halts microcode, dead!
   229				;The current F3 microcode ignores nonzero in AC field of IBP (ADJBP).
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 6-2
UUOCON.MAC	 4-DEC-87 16:09		INSSIM - instruction simulator

   230				IF2,<PRINTX [Can't emulate ADJBP and DDIV due to F3 microcode errors]>
   231				>  ;End IFCPU(F3)
   232				IFCPU(KI),<
   233					ADJSP	U.ADSP	;KL Adjust stack pointer
   234				;*;	ADJBP	U.ADBP	;KL Adjust byte pointer (needs ECO to work)
   235				;*;	DADD	U.DADD	;KL Double integer add
   236				;*;	DSUB	U.DSUB	;KL Double integer subtract
   237				;*;	DMUL	U.DMUL	;KL Double integer multiply, quad-word result
   238				;*;	DDIV	U.DDIV	;KL Quad-word divide, double integer results
   239				>  ;End IFCPU(KI)
   240			000001	SIMLEN=.-SIMTBL
   241
   242	000073'	000000	000000	N.JSYS::0			;Count of JSYS instructions seen
   243	000074'	350000	000073'	U.JSYS:	AOS	N.JSYS		;Count attempted execution of JSYS
   244	000075'	254000	000071*		JRST	ILLINS##	;Illegal for now
   245
   246				IFCPU(F3),<
   247				N.DFAD::0			;Count of DFAD instructions seen
   248				U.DFAD:	AOS	N.DFAD		;Count attempts at double floating add
   249					JRST	ILLINS##	;Illegal for now
   250				N.DFSB::0			;Count of DFSB instructions seen
   251				U.DFSB:	AOS	N.DFSB		;Count attempts at double floading subtract
   252					JRST	ILLINS##	;Illegal for now
   253				N.DFMP::0			;Count of DFMP instructions seen
   254				U.DFMP:	AOS	N.DFMP		;Count attempts at double floating multiply
   255					JRST	ILLINS##	;Illegal for now
   256				N.DFDV::0			;Count of DFDV instructions seen
   257				U.DFDV:	AOS	N.DFDV		;Count attempts at double floating divide
   258					JRST	ILLINS##	;Illegal for now
   259				
   260				U.FIXR:	UMOVE	T1,(M)			;get contents of eff addr
   261					HRLZI	T2,(0.5)		;Assume argument is positive
   262					SKIPGE	T2			;Still assuming...
   263					 MOVE	T2,[600000,,1]		;If negative, use -.49999999...
   264					FADR	T1,T2			;Round up or down, sign depending
   265					FIX	T1,T1			;Strip off fractional part
   266					UMOVEM	T1,(W)			;put into users AC
   267					POPJ	P,			;return
   268				
   269				U.FLTR: UMOVE	T1,(M)			;get contents of eff addr
   270					CAMN	T1,[xwd 400000,0]	;special case
   271					 JRST	[HRLZI	T2,533400
   272						 JRST	GOODGO]
   273					MOVM	T2,T1			;get absolute value
   274					TLNN	T2,777000		;will a FSC work?
   275					 JRST	[FSC	T2,233		;yup
   276						 JRST	SIGNGO]
   277					JFFO	T2,.+1			;drop leading zeros
   278					LSH	T2,(T3)
   279					MOVNI	T3,-244(T3)		;= 233 (ls=1) + 9 (handles ROT) - shifts
   280					ROTC	T2,-11			;put in exponent field, get LSBITS
   281					JUMPG	T3,SIGNGO		;if fraction less than 1/2 LSBIT ignore
   282					TLNN	T3,377			;if fraction is precisely 1/2 LSBIT
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 6-3
UUOCON.MAC	 4-DEC-87 16:09		INSSIM - instruction simulator

   283					 JUMPL	T1,SIGNGO		; then nothing on negatives
   284					HLRZ	T3,T2			;otherwise, create a 1/2 LSBIT
   285					SUBI	T3,033000
   286					TLZ	T3,000377		;only MSBIT used
   287					FADRI	T2,(T3)			;and add it in with rounding
   288				SIGNGO:	JUMPGE	T1,GOODGO
   289					 MOVN	T2,T2
   290				GOODGO:	UMOVEM	T2,(W)			;put into users AC
   291					POPJ	P,			;return
   292				>  ;End IFCPU(F3)
   293
   294				IFCPU(KI),<
   295				U.ADSP:	UMOVE	T1,(W)			;Get current stack pointer
   296					HRRES	M			;Get amount of adjustment
   297					JUMPL	M,ADJSPN		;Handle negative adjustments
   298					HRLS	M			;Put positive number in both halves
   299					JCRY	.+1			;Clear carry 0 and carry 1
   300					ADD	T1,M			;Adjust both halves
   301					JCRY0	ADJSPO			;Carry 0 set if negative LH now positive
   302					JRST	ADJSPX			;No overflow, or incremented 377777,,x
   303				
   304				ADJSPN:	MOVMS	M			;Get positive adjustment
   305					HRLS	M			; in both halves
   306					JCRY	.+1			;Clear carry 0 and carry 1
   307					SUB	T1,M			;Decrement stack pointer
   308					JCRY0	ADJSPX			;Carry 0 set unless positive LH now neg
   309				ADJSPO:	MOVSI	T2,(1B9)		;Set trap 2, PDL OV
   310					IORM	T2,PDNMUP(P)		;Set it in user PC flags
   311				ADJSPX:	UMOVEM	T1,(W)			;Return adjusted pointer to user's AC
   312					POPJ	P,
   313				>  ;End IFCPU(KI)
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 7
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

   314				SUBTTL	USRXIT - Exit from UUO, return to user mode
   315
   316	000076'	200100	000010*	USRXIT::MOVE	J,JOB			;CURRENT JOB NUMBER
   317	000077'	200300	000000*		MOVE	T1,%UPT+UPTJOB##	; *** DEBUGGING CHECK. ***
   318	000100'	312300	000000*		CAME	T1,%UPX+UPTLKJ##	; Going back to user without
   319	000101'	316300	000000*		CAMN	T1,%UPT+UPTLKJ##	;  giving up all context page locks?
   320	000102'	256000	004706'	UUOXWL:: STOPCD (.,JOB,UUOXWL,,<UUO eXit With context Locks active>)
   321				 ;;USRXIT+3
   322	000103'	550320	000000*		HRRZ	T1,@%RIB.C##+%CTUPT##	; Must not have PCBs still locked
   323	000104'	326300	000102'		JUMPN	T1,UUOXWL		;
   324	000105'	550320	000000*		HRRZ	T1,@%RB2.C##+%CTUPT##	;
   325	000106'	326300	000102'		JUMPN	T1,UUOXWL		;
   326	000107'	550320	000000*		HRRZ	T1,@%SAT.C##+T##	;
   327	000110'	326300	000102'		JUMPN	T1,UUOXWL		; *** End of DEBUGGING CHECK ***
   328
   329	000111'	200302	000000*		MOVE	T1,JBTSTS(J)		;STATUS WORD FOR CURRENT USER
   330	000112'	602300	040000		TRNE	T1,UTRP			;IS THERE A START,REEN OR DDT WAITING
   331					 JRST 	[LDB	T1,UPYPSR##	;PENDING STREAM RECORD TYPE
   332						PUSHJ	P,ACTWRT	;WRITE IT. CLOB T1-T4
   333						MOVE	T2,%UPT+UPTSTS
   334						TLZE	T2,UPSSWE	;GOT SWAP ERROR IN BAD PLACE?
   335						  JRST	USRSWE		;YES.
   336						TLZE	T2,UPSABK	;ADDRESS BREAK WAITING
   337						  JRST	UUOABK		;YES, GO DO IT.
   338						TLNN	T2,STRTAD	;ADDRESS OR INDIRECT?
   339						  UMOVE	T2,(T2)		;INDIRECT
   340						TLNE	T2,STRTCL	;WANTS CCL START ADDRESS?
   341						  AOS	T2		;YES, CCL IS ONE MORE THAN STANDARD
   342						TRNN	T2,-1		;NO ZERO STARTING ADDR ALLOWED
   343						  JRST	ERRNSA
   344						EXCH	T2,(P)		;GET JOB'S OLD PC, FORCE NEW PC
   345						HLLM	T2,(P)		;TO START ADDRESS, KEEP FLAGS FROM PDL,
   346						UMOVEM	T2,JOBOPC	;TELL USER WHERE TRAP WAS
   347						MOVEI	T1,UTRP		;RESET TRAP FLAG,
   348						ANDCAB	T1,JBTSTS(J)	;AND RESTORE T1
   349	000113'	254000	004713'			JRST	.+1]
   350	000114'	607300	200400		TLNN	T1,CMWB!CNTRLC		;IS MONITOR TRYING TO STOP THIS USERS
   351									; IO OR IS HE TRYING TO STOP HIS JOB
   352									; (BY TYPING ^C WHILE HE WAS IN MONITOR)?
   353	000115'	332000	000000*		SKIPE	TIMEF			;NO. HAS CLOCK TICKED WHILE IN MONITOR?
   354	000116'	260040	000000*		 PUSHJ	P,USCHD1		;YES, GO CALL SCHEDULER
   355									;STOPPING JOB IF CONTROL C TYPED IN EXEC
   356	000117'	262040	000010		POP	P,T3			;USER RETURN ADDRESS
   357	000120'	200100	000076*	USRXT7::MOVE	J,JOB			;MAKE SURE SET UP FOR CLKTRP
   358	000121'	260040	000000*		PUSHJ	P,CLKTRP		;SEE IF TRAPPING NEEDED
   359	000122'	202400	000425*		MOVEM	T3,%UPT+UPTMUP		;T3 CHANGED IF NEEDED
   360	000123'	322100	000126'		JUMPE	J,USRXT8
   361	000124'	336000	000000*		SKIPN	%UPT+UPTNTV		;IF PAGE-AGE QUANTUM HAS EXPIRED,
   362	000125'	260040	000000*		 PUSHJ	P,AGEPAG		;  INCREMENT PAGE AGES
   363	000126'	513002	000000*	USRXT8:	HLLZS	JBTINA##(J)		;RESET INACTIVITY COUNT
   364	000127'	702600	432000*		CHARGE				;TURN CHARGING CLOCK BACK ON
   365	000130'	701140	004736'		USERAC	
   366							;SWITCH BACK TO USER'S ACS IF KL
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 7-2
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

   367	000131'	254520	000425*		JEN	@%UPT+UPTMUP		;RESTORE FLAGS AND RETURN TO USER
   368									; DISMISS INTERRUPT ONLY ON TRPJEN MUUO
   369									; IN ALL OTHER CASES NO INTERRUPTS
   370									; ARE IN PROGRESS
   371
   372				EXTERNAL GETLMA,STOLMA,LMMERR,VPUMAX,%UPLMA
   373
   374	000132'	202340	000000*	USRSWE:	MOVEM	T2,%UPT+UPTSTS		;STORE THIS WITH UPSSWE OFF
   375	000133'	201300	040000		MOVEI	T1,UTRP
   376	000134'	412302	000111*		ANDCAM	T1,JBTSTS(J)		;TURN THIS OFF NOW
   377	000135'	201500	000000*		MOVEI	W,VPUMAX		;MUST TURN OFF "A" BITS
   378	000136'	205300	000000*		MOVSI	T1,LMMERR		; FOR PAGES WE IGNORED ERRORS ON
   379	000137'	616312	000000*		TDNN	T1,%UPLMA(W)		;ANY ERRORS?
   380	000140'	365500	000137'	USRSW1:	SOJGE	W,.-1			;NO, DO NEXT
   381	000141'	321500	000147'		JUMPL	W,USRSW2
   382
   383	000142'	260040	000000*		PUSHJ	P,GETLMA		;FOUND ONE, MUST FORCE FAULT
   384	000143'	620740	500000		TRZ	P4,PGE.A!PGE.W		;SO USER DOESN'T TOUCH PAGE
   385	000144'	260040	000000*		PUSHJ	P,STOLMA
   386	000145'	205300	000136*		MOVSI	T1,LMMERR		;SETUP MASK AGAIN
   387	000146'	254000	000140'		JRST	USRSW1			;AND CHECK FOR NEXT PAGE.
   388
   389	000147'	550540	000000*	USRSW2:	HRRZ	M,%UPT+UPTXEI		;GET PAGE GOT I/O ERROR ON (MAYBE LAST OF MANY)
   390	000150'	242540	000011		LSH	M,^D9			;MAKE INTO LOCATION
   391	000151'	324740	000000*		PJRST	ERRPIO			;WILL GO BACK THRU ABTUUO TO USRXIT.
   392
   393	000152'	202340	000000*	UUOABK:	MOVEM	T2,%UPT+UPTSTS		;STORE UPTSTS WITHOUT UPSABK ON
   394	000153'	201340	040000		MOVEI	T2,UTRP			;CLEAR UTRP
   395	000154'	412342	000134*		ANDCAM	T2,JBTSTS(J)		;FORGET ABOUT PENDING DDT, REE, ETC.
   396					HRRZ	M,%UPT+UPTABK		;SETUP M SO MESSAGE PRINTS OUT LOCATION OF ADDRESS BREA
   397	000155'	550540	000000*	K
   398	000156'	254000	000000*		JRST	ERRABK			;PRINT ADDRESS BREAK. RETURNS THRU USRXIT.
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 8
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

   399				; CALLING SEQUENCE
   400				;	CALL D,[SIXBIT/NAME/]
   401				; WHERE NAME IS THE NAME OF A SYSTEM ROUTINE.
   402				; IF NO SYSTEM ROUTINE WITH THE SPECIFIED NAME IF FOUND, THIS ROUTINE
   403				; EXITS TO UUOERR.
   404				; CONTENTS OF USER AC PLACED IN AC T1, M SET TO POINT TO USER AC.
   405				; J SET TO JOB NUMBER
   406
   407	000157'	256200	004737'	UCALL::	UMOVE	T1,(M)			;SET T1 FROM CONTENTS OF USER ADDRESS
   408	000160'	205340	777667		MOVSI	T2,-UCLLEN-CCLLEN-1	;-SUM OF LENGTHS OF SIXBIT TABLES,
   409									; -1 FOR THE CARRY TO LH IN AOBJN
   410	000161'	541340	777746		HRRI	T2,-CCLLEN		;- LENGTH OF CUSTOMER TABLE
   411	000162'	316307	000243'		CAMN	T1,UCLTAB(T2)		;SEARCH SYSTEM ROUTINE NAME TABLE
   412	000163'	254000	000166'		 JRST	UCALLF
   413	000164'	253340	000162'		AOBJN	T2,.-2
   414	000165'	254000	000000*		JRST	ERRCAL			;CALL ARGUMENT NOT FOUND
   415
   416	000166'	542340	000013	UCALLF:	HRRM	T2,M			;STORE INDEX IN M,
   417									; JUST AS IF USER HAD DONE CALLI MUUO
   418
   419				;CALLI MUUO	-	CALL IMMEDIATE
   420				;CALLI D,E
   421				;WHERE E IS RELATIVE INDEX IN CALL TABLE
   422
   423
   424	000167'	570340	000013	UCALLI::HRRE	T2,M		;GET CALLI NUMBER(POS.=DIGITAL,NEG.=CUSTOMER DEFINED)
   425	000170'	321340	000174'		JUMPL	T2,UCALL1	;IF NEG CALLI, TEST IS REVERSED
   426	000171'	622340	200000		TRZE	T2,UPHNLY	;TEST BIT TO SPECIFY PHYSICAL ONLY
   427	000172'	505500	400000		 HRLI	W,PHONLY	;AND REMEMBER IT IN LH OF W
   428	000173'	254000	000176'		JRST	UCALL2
   429	000174'	666340	200000	UCALL1:	TRON	T2,UPHNLY
   430	000175'	505500	400000		 HRLI	W,PHONLY
   431	000176'	311340	004740'	UCALL2:	CAML	T2,[-CCILEN]	;MORE NEGATIVE THAN MOST NEGATIVE CUSTOMER DEFINED M?
   432	000177'	301340	000112		CAIL	T2,UCILEN	;MORE POSITIVE THAT DIGITAL DEFINED CALLI?
   433	000200'	263040	000000		 POPJ	P,		;YES, RETURN TO USER TREAT AS NO-OP SO
   434								; PROGRAMS AHEAD OF MONITOR WILL STILL
   435								; RUN WITHOUT ERROR MESSAGE
   436	000201'	540540	000012		HRR	M,W		;AC FIELD FROM MUUO INSTRUCTION
   437	000202'	256200	004737'		UMOVE	T1,(M)		;PICK UP CONTENTS OF USER AC
   438	000203'	241340	777777		ROT	T2,-1		;DEVIDE BY 2 AND SAVE REMAINDER
   439	000204'	200100	000120*		MOVE	J,JOB		;SETUP CURRENT JOB NUMBER(IN CASE THIS IS CALLI)
   440	000205'	335000	000007		SKIPGE	T2		;IS CALLI ODD?
   441	000206'	334247	000406'		 SKIPA	U,UCLJMP(T2)	;YES, USE RH
   442	000207'	204247	000406'		   MOVS	U,UCLJMP(T2)	;NO, USE LH
   443	000210'	254005	000000		JRST	(U)		;DISPATCH.
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 9
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

   444
   445				;CALL MUUO DISPATCH TABLE
   446				;NEW MUUO'S MUST BE ADDED AT END SINCE CALLI DEPENDS ON
   447				;POSITION IN TABLE, CUSTOMERS SHOULD ADD MUUO'S IN CNAMES MACRO SO CALLI ADDRESS
   448				;WILL BE NEGATIVE.  IN THIS WAY BOTH DIGITAL AND ITS CUSTOMERS CAN ADD MUUO'S
   449				;WITHOUT CONFLICT, DIGITAL GOING POSITIVE, CUSTOMERS GOING NEGATIVE.
   450				; (ALSO, TOWARD TOP OF PAGE)
   451
   452				EXTERNAL DDTIN,DDTOUT,CPOPJ,DSKCLR,URUNHI,HNGUUO,AUXRED,ZAPCIR
   453				EXTERNAL INTADR,INTENB,INTACT,INTASS,SETTIM,SETTR1,SETTR2,TINASS
   454				EXTERNAL REDPIP,CREAUX
   455				EXTERNAL POLPRT,RDHIST,SNOOPU,EVICT,RETACH,CREPTY
   456				EXTERNAL UVALID,UPRERF,UWSCTL,URFBIT,UPROT,UPGSTS,UCREAT
   457				EXTERNAL UPFSTS,UPESTS,UPESET,UVDSKP,VPGFIL,SETPID
   458				EXTERNAL BLTPAG,UPISTS,UPRSTS,OTFSET,ABKUUO
   459				EXTERNAL UCBADD,UCBHNG,UCBINI,UCBINW,UCBLEV,UCBMEM,UCBRLI,UCBSTS,UCBWAK
   460				EXTERNAL VCLEAU,VFLCKU,VREMOU,VREPLU
   461				EXTERNAL MOVBUF,SETMOD,WAIT,UUOSK1,STVSET,SETMCY,FINASS
   462				IFCPU (<KS,F3>),<EXTERNAL CI.OPR>
   463			000000	IFCPU (<KI,KL>),<CI.OPR==CPOPJ>
   464
   465				DEFINE CNAMES <
   466					X FINASS,FINASS		; (-151) Frame interrupt assignment
   467					X SETLIM,SETLIM		; (-150) Set TRU limit
   468					X FLSTOP,FLSTOP		; (-147) Fail stop, continue allowed
   469					X SETINA,SETINA		; (-146) SET INACTIVITY TIMEOUT LIMIT
   470					X SETMAI,SETMAI		; (-145) Set (new) mail waiting bit
   471					X SETMCY,SETMCY		; (-144) Set micro-cycle timer
   472					X DAYTIM,DAYUUO		; (-143) RETURN DATE AND TIME
   473					X FLEXIT,FLEXIT		; (-142) Fail exit, no continue
   474					X CREPTY,CREPTY		; (-141) CREATE PTY
   475					X CIOPR,CI.OPR		; (-140) 2020/F3 COMMUNICATIONS UUO
   476					X SETSTV,STVSET		; (-137) SET START VECTOR
   477					X VPEEK,NPEEK		; (-136) PEEK WITH ERROR RETURN
   478					X RETACH,RETACH		; (-135) MOVE A TTY
   479					X EVICT,EVICT		; (-134) CAUSE NTQ SOFT. INT.
   480					X PGRSTS,UPRSTS		; (-133) GET REF BIT FAULT INFO
   481					X PGISTS,UPISTS		; (-132) GET ILL MEM REF/ADDR BREAK FAULT INFO
   482					X SETABK,ABKUUO		; (-131) SET ADDRESS BREAK
   483					X LOGOFF,LOGOFF		; (-130) RUN ALT. LOGOUT PROGRAM
   484					X SETALP,SETALP		; (-127) SET ALT. LOGOUT PROGRAM
   485					X SETOTF,OTFSET		; (-126) SET "OTHER" FRAME UUO FOR VUUOS
   486					X CONT,CONTUU		; (-125) PUT TERMINAL IN USER MODE
   487					X PUTROY,PUTROY		; (-124) PUT ROYALTY STREAM RECORD
   488					X BLTPAG,BLTPAG		; (-123) BLT DATA TO A LOCKED PAGE
   489					X PIDSET,SETPID		; (-122) SET PROGRAM'S PID
   490					X FOO,CPOPJ		; (-121) DEFUNCT GET PAGE FAULT WORD UUO
   491					X BITPOK,BITPOK		; (-120) POKE WITH MASK
   492					X RDHIST,RDHIST		; (-117) READ SNOOP HISTOGRAM
   493					X SNOOP,SNOOPU		; (-116) START/STOP SNOOP HISTOGRAM
   494					X POLPRT,POLPRT		; (-115) POLL PORTS
   495					X CLBADD,UCBADD		; (-114) ADD SELF TO CLUB.
   496					X CLBLEV,UCBLEV		; (-113) REMOVE SELF FROM CLUB.
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 9-2
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

   497					X CLBINW,UCBINW		; (-112) GET CLB INTRLK (WAIT).
   498					X CLBINI,UCBINI		; (-111) GET CLB INTRLK (IMMED).
   499					X CLBRLI,UCBRLI		; (-110) RELEASE CLB INTRLK.
   500					X CLBMEM,UCBMEM		; (-107) GET INFO ABOUT CLB MBR.
   501					X CLBSTS,UCBSTS		; (-106) GET STATUS OF CLB MBR.
   502					X CLBWAK,UCBWAK		; (-105) WAKE JOB IN SAME CLB.
   503					X CLBHNG,UCBHNG		; (-104) HANG JOB IN SAME CLUB.
   504					X VPGFIL,VPGFIL		; (-103) GET FILENAME ETC FOR VP
   505					X VDSKPT,UVDSKP		; (-102) GET DISK POINTER FOR VP
   506					X PGFSTS,UPFSTS		; (-101) GET AND CLEAR PAGE FAULT STATUS
   507					X PGESTS,UPESTS		; (-100) GET AND CLEAR PAGE ERROR STATUS
   508					X VFSTAT,VFLCKU		; (-77) SEE IF THE F BIT IS ON.
   509					X VALPAG,UVALID		; (-76) VALIDATE AND WAIT
   510					X PREREF,UPRERF		; (-75) PRE REFERENCE A VIRTUAL PAGE
   511					X WSCTL,UWSCTL		; (-74) WORKING SET CONTROL
   512					X REFBIT,URFBIT		; (-73) REFERENCE BIT CONTROL
   513					X PERSET,UPESET		; (-72) SET/CLEAR IGNORE ERROR BIT
   514					X PAGSTS,UPGSTS		; (-71) GET PAGE STATUS
   515					X VPROT,UPROT		; (-70) SET VM PAGE PROTECTION
   516					X VCREAT,UCREAT		; (-67) CREATE PRIVATE VM PAGE
   517					X VCLEAR,VCLEAU		; (-66) CLEAR VM PAGE.
   518					X VREMOV,VREMOU		; (-65) REMOVE VM PAGE.
   519					X VREPLC,VREPLU		; (-64) REPLICATE VM PAGE.
   520					X PUTLSA,LSAUUO		; (-63) GENERATE LOCAL STR ACCTG REC
   521					X PUTSAR,PUTSAR		; (-62) PUT STREAM ACCT'G RECORD
   522					X CHPRJ,CHPJC##		; (-61) CHANGE PROJ CODE
   523					X XCHARG,XCHARG		; (-60) SAVE (ETC) CHARGING
   524					X SETRCF,RECMFL		; (-57) DEFINE RESTRICTED COMMAND FILE AND PPN
   525					X TYMCHG,SOAKEM		; (-56) ADD TRU CHARGES
   526					X DATUUO,DATUUO		; (-55) CONVERT DATES AND TIMES
   527					X DDT620,CPOPJ		; (-54) INTERROGATE REMOTE 620
   528					X VALRMT,CPOPJ		; (-53) VALIDATE REMOTE PASSWORD
   529					X INTRMT,INTRMT		; (-52) SET REMOTE INTERRUPTS (CHKPNT & ACT:)
   530					X IDLRMT,CPOPJ		; (-51) SET REMOTE IDLE
   531					X ZAPRMT,CPOPJ		; (-50) ZAP REMOTE
   532					X CRERMT,CPOPJ		; (-47) CREATE REMOTE PORT
   533					X AUXRED,AUXRED		; (-46) READ AUX CIRCUIT INFO
   534					X ZAPCIR,ZAPCIR		; (-45) ZAP AUX CIR
   535					X CREAUX,CREAUX		; (-44) CREATE AUX CIR
   536					X REDPIP,REDPIP		; (-43) READ PI IN PROGRESS BITS
   537					X TINASS,TINASS		; (-42) ASSIGN TTY INTERRUPTS
   538					X SETTR2,SETTR2		; (-41) SET TRAP 2 INSTR (PDLOV)
   539					X SETTR1,SETTR1		; (-40) SET TRAP 1 INSTR (OVERFLOW)
   540					X SETTIM,SETTIM		; (-37) SET INTERRUPT TIMER
   541					X INTASS,INTASS		; (-36) ASSIGN APR INTERRUPTS
   542					X INTACT,INTACT		; (-35) CAUSE PSEUDO INTERRUPT
   543					X INTENB,INTENB		; (-34) ENABLE INTERUPT CHANNELS
   544					X INTADR,INTADR		; (-33) TURN ON NEW INTERRUPT SYSTEM
   545				SIXSTP==-1
   546					X HANG,HNGUUO		; (-32) HANG A JOB
   547					X CHKLIC,CHKLIC		; (-31) CHECK SETTABLE LICENSE
   548					X LEVDEF,LEVDEF		; (-30) LEAVE DEFERED ECHO MODE
   549					X MOVBUF,MOVBUF		; (-27) MOVE I/O BUFFER
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 9-3
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

   550					X SETMOD,SETMOD		; (-26) SET TTY MODE (SETSTS BUT NO INIT)
   551					X RUNSEG,URUNHI		; (-25) RUN A HIGH SEG
   552					X SYSDVF,SYSDVF		; (-24) GET DEVICE INFO
   553					X DISMIS,DISMIS		; (-23) DISMAISS TRAP
   554					X DSKCLR,DSKCLR		; (-22) CLEAR DSK CORE INFO
   555					X SETJAL,SETJAL		; (-21) SET JACCT, LOGIN
   556					X ONEJOB,ONEJOB		; (-20) SEE IF ONLY JOB ON SYSTEM
   557					X SETMAL,SETMAL		; (-17) SET MAIL WAITING
   558					X GETTMC,GETTMC		; (-16) GET TERM CHRS
   559					X SETTMC,UUOMNR		; (-15) SET TERM CHRS
   560					X REDNXT,REDNXT		; (-14) READ NEXT CHR
   561					X WAITCH,WAITCH		; (-13) WAIT FOR CHARACTER
   562					X POKE,POKE		; (-12) POKE MUUO
   563					X SETPRV,SETPRV		; (-11) MOVING SETPRV HERE
   564					X SETLIC,SETLIC		; (-10) SET JBTLIC
   565					X SETE,SETE		; (-7) SETE WITH SYS PASSWORD
   566					X ATTACH,ATTUUO		; (-6) ATTACH, DETACH MUUO
   567					X UUOERR,UUOMNR		; (-5) PLACE FOR CUSTOMERS TO PATCH UUOS
   568					X UUOERR,UUOMNR		; (-4)
   569					X UUOERR,UUOMNR		; (-3) SET BITS IN JBTPRV
   570					X 6WDBLK,UUOMNR		; (-2) FOR COMPATABILITY
   571					X LIGHTS,LIGHTS		; (-1) SET LIGHTS (EXAMPLE OF CUSTOMER DEFINED M)
   572				>  ;end DEFINE CNAMES
   573
   574				DEFINE NAMES,<
   575					X RESET,RESET		;  (0) RESET IO
   576					X DDTIN,DDTIN		;  (1) EXT-GET DDT CHAR.
   577					X SETDDT,SETDDT		;  (2) SETDDT LOC IN PROTECTED JOB DATA
   578					X DDTOUT,DDTOUT		;  (3) EXT:SEND DDT CHAR.
   579					X DEVCHR,DVCHR		;  (4) DEVICE CHARACTISTICS
   580					X DDTGT,CPOPJ		;  (5) GET DDT MODE
   581					X GETCHR,DVCHR		;  (6) DEVICE CHAR.(DIFF. NAME)
   582					X DDTRL,CPOPJ		;  (7) RELEASE DDT MODE
   583					X WAIT,WAIT		; (10) WAIT TILL DEVICE INACTIVE
   584					X CORE,CORUUO		; (11) CORE MUUO
   585					X EXIT,EXIT		; (12) EXIT
   586					X UTPCLR,CPOPJ		; (13) CLEAR DEC TAPE DIRECTORY
   587					X DATE,DATEU		; (14) GET DATE
   588					X LOGIN,LOGIN		; (15) LOGIN
   589					X APRENB,APRENB		; (16) ENABLE APR FOR TRAPPING
   590					X LOGOUT,LOGOUT		; (17) LOGOUT
   591					X SWITCH,SWITCH		; (20) RETURN DATA SWITCHES
   592					X REASSIGN,REASSIGN	; (21) REASSIGN DEVICE TO ANOTHER JOB
   593					X TIMER,TIMER		; (22) RETURN JIFFY CLOCK TIME
   594					X MSTIME,MSTIME		; (23) RETURN TIME OF DAY IN MS
   595					X GETPPN,GETPPN		; (24) RETURN PROJECT-PROGRAMMER NUMBER
   596					X TRPSET,UTRPST		; (25) SET USER-IOT
   597					X TRPJEN,UUOMNR		; (26) DISMISS INTERRUPT TO EXEC MODE(SUPERCEDED BY UJEN)
   598					X RUNTIM,JOBTIM		; (27) RETURN TOTAL JOB RUNNING TIME
   599					X PJOB,JOBNO		; (30) RETURN JOB NUMBER
   600					X SLEEP,SLEEP		; (31) SLEEP FOR N SECONDS, THEN RETURN TO USER
   601					X SETPOV,SETPOV		; (32) OLD SET PUSH DOWN OVERFLOW TRAP
   602					X PEEK,UPEEK		; (33) TO PEEK AT CERTAIN MONITOR PARAMETERS
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 9-4
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

   603					X GETLIN,GETLN		; (34) GET TTY UNE NUMBER
   604					X RUN,URUN		; (35) RUN DEV:FILE
   605					X SETUWP,SETUWP		; (36) SET OR CLEAR USER MODE WRITE PROTECT
   606					X REMAP,REMAP		; (37) REMAP TOP OF LOW SEGMENT INTO HIGH SEG
   607					X GETSEG,UGTSEG		; (40) GET SHARABLE HIGH SEG
   608					X GETTAB,GETTAB		; (41) GET EXEC ADDRESS OF A JOB TABLE
   609					X SPY,CPOPJ		; (42) MAP MONITOR LOWSEG TO USER'S HISEG
   610					X SETNAM,SETNAM		; (43) SET NAME OF THIS PROGRAM
   611					X TMPCOR,TMP.UU		; (44) TEMPORARY FILE STORAGE (CCL)
   612					X DSKCHR,DSKCHR		; (45) DISK CHARACTERISTICS
   613					X SYSSTR,SYSTUU		; (46) RETURN NEXT STR IN SYSTEM
   614					X JOBSTR,JOBSTR		; (47) RETURN NEXT STR IN JOB
   615					X STRUUO,STRUUO		; (50) VARIOUS FUNCTION FOR STRS
   616					X SYSPHY,SYSPHY		; (51) RETURN ALL PHYSICAL DEVS AND UNITS IN SYSTEM
   617					X FRECHN,CPOPJ		; (52) RETURN 1ST FREE USER CHAN IN AC, STARTING FROM C(AC)
   618					X DEVTYP,DEVTYP		; (53) EXTENDED DEVICE CHARACTERISTICS AND BUFFER SIZE
   619					X DEVSTS,DEVSTA		; (54) DEVICE STATUS
   620					X DEVPPN,DEVPPU		; (55) RETURN PPN FOR DEVICE
   621					X SEEK,UUOSK1		; (56) SEEK
   622					X RTTRP,CPOPJ		; (57) REAL TIME TRAP
   623					X LOCK,CPOPJ		; (60) LOCK JOB IN CORE
   624					X JOBSTS,JOBSTS		; (61) RETURN STATUS OF JOB AND ITS PTY
   625					X LOCATE,CPOPJ		; (62) SET DEFAULT FOR ANF-10 PRINTER
   626					X WHERE,CPOPJ		; (63) GET NODE NUMBER OF ANF-10 DEVICE
   627					X DEVNAM,UDEVNM		; (64) GET PHYSICAL DEVICE NAME
   628					X CTLJOB,CTLJOB		; (65) FIND CONTROLLER OF THIS JOB (IF BY PTY)
   629					X GOBSTR,GOBSTR		; (66) GENERALIZED JOBSTR (ANY JOB'S SEARCH LIST)
   630					X FOO,CALI67		; (67) RESERVED (ACTIVATE UUO NEVER IMPLEMENTED)
   631					X FOO,CALI70		; (70) RESERVED (DEACTIVATE UUO NEVER IN TOPS10)
   632					X HPQ,CPOPJ		; (71) SET HIGH PRIORITY QUE
   633					X HIBER,HIBER		; (72) HIBERNATE
   634					X WAKE,WAKUUO		; (73) WAKE SLEEPING JOB
   635					X CHGPPN,CHGPPN		; (74) CHANGE PPN
   636					X SETUUO,SETUUO		; (75) SET UUO
   637					X DEVGEN,CPOPJ		; (76) GENERIC NUMBER
   638					X OTHUSR,OTHUSR		; (77) SEE IF OTHER USER
   639					X CHKACC,CPOPJ		;(100) SEE IF ACCESS ALLOWED
   640					X DEVSIZ,DVSIZU		;(101) BUFFER SIZE AND NUMBER
   641				                                        ;Last CALLI in 5.02
   642					X DAEMON,CPOPJ		;(102) CALL DAEMON
   643					X JOBPEK,CPOPJ		;(103) READ/WRITE ANOTHER JOB'S CORE
   644					X ATTACH,UATTAC		;(104) ATTACH OR DETACH JOBS.
   645					X DAEFIN,CPOPJ		;(105) DAEMON FINISHED - RESTART USER JOB
   646					X FRCUUO,CPOPJ		;(106) FORCE COMMAND FOR JOB
   647					X DEVLNM,CPOPJ		;(107) SET DEVICE LOGICAL NAME
   648				                                        ;Last CALLI in 5.03
   649				
   650					X CPOPJ,CPOPJ		;2 SPARE MUUO'S FOR PATCHING - DIGITAL ONLY
   651					X CPOPJ,CPOPJ		;ALWAYS ADD NEW MUUO'S ABOVE THESE
   652								;  CUSTOMERS SHOULD ADD MUUO'S ABOVE
   653								; IN CNAMES MACRO RATHER THAN NAMES MACRO
   654								; SO THAT THEIR CALLI INDICES WILL BE NEGATIVE
   655				>  ;end DEFINE NAMES
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 9-5
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

   656				;;;;;	PATH.,PTHUUO##,UU.LEA	;(110) TEST/SET FULL PATHS FILES (SFD'S, LIB:)
   657				;;;;;	METER.,METER##,UU.LEA+UU.CP0 ;(111)PERFORMANCE METERING
   658				;;;;;	MTCHR.,MTACHR##,	;(112)GET MAGTAPE CHARACTERISTICS
   659				;;;;;	JBSET.,JBSET.##,UU.EA+2	;(113)SETUUO ON OTHE JOB
   660				;;;;;	POKE.,POKE,UU.EA+3	;(114)CHANGE MONITOR
   661				;;;;;	TRMNO.,TRMNO##,		;(115)TERMINAL NUMBER FOR JOB
   662				;;;;;	TRMOP.,TRMOP##,UU.LEA	;(116)TERMINAL OPERATIONS UUO
   663				;;;;;	RESDV.,RESDV,		;(117)RESET DEVICE OR CHANNEL
   664				;;;;;	UNLOK.,UNLOK.##,	;(120)UNLOCK A LOCKED JOB
   665				                                        ;Last CALLI in 5.04
   666				;;;;;	DISK.,DSKUUO##,UU.EA	;(121)RANDOM DISK FUNCTIONS
   667				;;;;;	DVRST.,DEVRST,		;(122)RESTRICT DEVICE TO OPER ONLY
   668				;;;;;	DVURS.,DEVURS,		;(123)UNRESTRICT DEVICE
   669				                                        ;Last CALLI in 5.05 & 5.06
   670				;;;;;	XTTSK.,XTUUO##,UU.LEA	;(124)DA28C DEPENDENT FUNCTIONS
   671				;;;;;	CAL11.,CALL11##,UU.LEA	;(125)MULTI-FUNCTION CALLI FOR THE PDP-11
   672				;;;;;	MTAID.,MTARID##,	;(126)FOR MTA ERROR REPORTING
   673				;;;;;	IONDX.,UIONDX,		;(127)RETURN IO DEVICE INDEX
   674				;;;;;	CNECT.,CONECT##,UU.EA+1	;(130)CONNECT A DEVICE TO AND MPX CHANNEL
   675				;;;;;	MVHDR.,MOVHDR,		;(131)MOVE BUFFER HEADER
   676				;;;;;	ERLST.,ERLST##,UU.EA+2	;(132)ERROR LIST
   677				;;;;;	SENSE.,SENSE##,UU.LEA	;(133)SENSE
   678				;;;;;	CLRST.,CLRST##,UU.LEA	;(134)CLEAR STATUS
   679				;;;;;	PIINI.,PIINI##,UU.EA	;(135)INITIALIZE SOFTWARE INTERRUPT SYSTEM
   680				;;;;;	PISYS.,PISYS##,		;(136)MANIPULATE SOFT. INTERRUPT SYSTEM
   681				;;;;;	DEBRK.,DEBRK##,		;(137)DISMISS A SOFTWARE INTERRUPT
   682				;;;;;	PISAV.,PISAVE##,UU.LEA	;(140)SAVE THE PI SYSTEM
   683				;;;;;	PIRST.,PIRST##,UU.EA+UU.CEA ;(141)RESTORE THE PI SYSTEM
   684				;;;;;	IPCFR.,UIPCFR##,	;(142) IPCF READ
   685				;;;;;	IPCFS.,UIPCFS##,	;(143) IPCF SEND
   686				;;;;;	IPCFQ.,UIPCFQ##,	;(144) IPCF QUERY
   687				;;;;;	PAGE.,UPAGE.##,		;(145) PAGING (REPLACES CORE UUO)
   688				;;;;;	SUSET.,USUSET##,	;(146) SUPER USETI/O
   689				;;;;;	COMPT.,CPOPJ##,		;(147) CALL TO COMPATABILITY PACKAGE PA1040
   690				                                        ;Last CALLI in 5.07/6.01
   691				;;;;;	SCHED.,SCHED.##,	;(150) SET SCHEDULING PARAMETERS
   692				;;;;;	ENQ.,ENQ##,		;(151) ENQUEUE
   693				;;;;;	DEQ.,DEQ##,		;(152) DEQUEUE
   694				;;;;;	ENQC.,ENQC##,		;(153) ENQ CONTROLLER
   695				;;;;;	TAPOP.,UTAPOP##,UU.LEA	;(154) TAPE OPERATIONS
   696				;;;;;	FILOP.,FILOP,UU.LEA	;(155) FILE OPERATIONS
   697				;;;;;	CAL78.,CALL78##,	;(156) FOR DAS78
   698				;;;;;	NODE.,NODE.U##,		;(157) ANF-10 NETWORK INFORMATION
   699				;;;;;	ERRPT.,ERRPT.##,	;(160) ERROR REPORTING, CALLS DAEMON
   700				;;;;;	ALLOC.,CPOPJ##,		;(161) OBSOLETE, ALLOC.
   701				;;;;;	PERF.,UPERF.,		;(162) KL10 PERFORMANCE ANALYSIS
   702				                                        ;Last CALLI in 6.02
   703				;;;;;	DIAG.,DIAUUO,		;(163) DIAGNOSTIC
   704				;;;;;	DVPHY.,DVPHY.,		;(164) RETURN PHYSICAL DEVICE NAME
   705				;;;;;	GTNTN.,GTNTN,		;(165) GET THE NETWORK TTY NUMBER
   706				;;;;;	GTXTN.,GTXTN,		;(166) GET THE -10 TTY NAME GIVEN NET TTY #
   707				;;;;;	ACCT.,ACCT,		;(167) READ/SET ACCOUNTING STRING
   708				;;;;;	DTE.,DTE.##,		;(170) DTE. UUO TO CONTROL CONSOLE-FRONT END
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 9-6
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

   709				;;;;;	DEVOP.,DEVOP,UU.LEA	;(171) GENERAL DEVICE OPERATIONS
   710				;;;;;	SPPRM.,SPPRM,UU.LEA	;(172) OBSOLETE, USE QUEUE. TO SET SPOOL PARMS
   711				                                        ;Last CALLI in 6.03
   712				;;;;;	MERGE.,UMERGE##,UU.EA+6	;(173) MERGE LOWSEG PAGES FROM EXE FILE
   713				;;;;;	UTRP.,UUTRP,UU.LER	;(174) SET USER-MODE TRAP INSTRUCTION IN UPT
   714				;;;;;	PIJBI.,PIJOB##,		;(175) CAUSE CROSS-JOB INTERRUPTS
   715				;;;;;	SNOOP.,SNOOP,		;(176) INSERT/DEL BREAKPOINTS IN RUNNING MONITOR
   716				;;;;;	TSK.,TSK.##,		;(177) TASK-TO-TASK LINKS
   717				;;;;;	KDP.,KDP.##,		;(200) LOAD/DUMP/START KMC-11
   718				                                        ;Last CALLI in 7.00
   719				;;;;;	QUEUE.,GLXINF##,	;(201) INTERFACE TO GALAXY
   720				;;;;;	RECON.,RECON,		;(202) SYSTEM RECONFIGURATION
   721				                                        ;Last CALLI in 7.01
   722				;;;;;	PITMR.,PITMR##,		;(203) PSI TIMER INTERRUPT
   723				;;;;;	ACCLG.,ACCLOG,		;(204) ACCESS CHECKING FOR LOGIN VIA ACTDAE
   724				;;;;;	NSP.,SCUUUO##,		;(205) DECNET-10 NETWORK SESSION PARAMETERS
   725				;;;;;	NTMAN.,NTMAN##,		;(206) DECNET NETWORK MANAGEMENT
   726				;;;;;	DNET.,DNET##,		;(207) DECNET INFORMATION
   727				;;;;;	SAVE.,USAVE##,UU.EA+6	;(210) SAVE CORE-IMAGE ON DISK
   728				;;;;;	CMAND.,CMAND,		;(211) USER DEFINABLE COMMANDS
   729				;;;;;	PIBLK.,PIBLK##,		;(212) DETERMINE ADDRESS OF PI VECTOR BLOCK
   730				                                        ;Last CALLI in 7.02
   731				                                ;CUSTOMERS SHOULD ADD UUO'S ABOVE
   732				                                ;IN CNAMES MACRO RATHER THAN NAMES MACRO
   733				                                ; SO THAT THEIR CALLI INDICES WILL
   734				                                ; BE NEGATIVE
   735					LIST
   736					SALL
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 10
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

   737				;GENERATE SIXBIT TABLE OF MUUO NAMES
   738
   739				DEFINE X (A,B) <
   740				IFN SIXSTP,<EXP SIXBIT /A/>
   741				>
   742
   743				;GENERATE CUSTOMER CALL/CALLI MUUO'S
   744			000000	SIXSTP==0
   745
   746	000211'	504156	470000	CCLTAB:	CNAMES
   747	000212'	435053	545143
   748	000213'	544566	444546
   749	000214'	555766	426546
   750	000215'	634564	555744
   751	000216'	626556	634547
   752	000217'	637163	446646
   753	000220'	445163	555163
   754	000221'	446353	435462
   755	000222'	634564	524154
   756	000223'	575645	525742
   757	000224'	634564	554154
   758	000225'	474564	645543
   759	000226'	634564	645543
   760	000227'	624544	567064
   761	000230'	674151	644350
   762	000231'	605753	450000
   763	000232'	634564	606266
   764	000233'	634564	545143
   765	000234'	634564	450000
   766	000235'	416464	414350
   767	000236'	656557	456262
   768	000237'	656557	456262
   769	000240'	656557	456262
   770	000241'	266744	425453
   771	000242'	545147	506463
   772			000032	CCLLEN==.-CCLTAB		;LENGTH OF CUSTOMER DEFINED CALL/CALLI MUUO'S
   773							;(MINIMUM CALLI NUMBER, TOO)
   774
   775				;GENERATE DIGITAL MUUO'S
   776
   777				DEFINE X (A,B)  <
   778					IFL .-UCLTAB-MAXCAL,<EXP SIXBIT /A/>
   779				>
   780
   781	000243'	624563	456400	UCLTAB:	NAMES
   782	000244'	444464	515600
   783	000245'	634564	444464
   784	000246'	444464	576564
   785	000247'	444566	435062
   786	000250'	444464	476400
   787	000251'	474564	435062
   788	000252'	444464	625400
   789	000253'	674151	640000
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 10-2
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

   790	000254'	435762	450000
   791	000255'	457051	640000
   792	000256'	656460	435462
   793	000257'	444164	450000
   794	000260'	545747	515600
   795	000261'	416062	455642
   796	000262'	545747	576564
   797	000263'	636751	644350
   798	000264'	624541	636351
   799	000265'	645155	456200
   800	000266'	556364	515545
   801	000267'	474564	606056
   802	000270'	646260	634564
   803	000271'	646260	524556
   804	000272'	626556	645155
   805	000273'	605257	420000
   806	000274'	635445	456000
   807	000275'	634564	605766
   808	000276'	604545	530000
   809	000277'	474564	545156
   810	000300'	626556	000000
   811	000301'	634564	656760
   812	000302'	624555	416000
   813	000303'	474564	634547
   814	000304'	474564	644142
   815	000305'	636071	000000
   816	000306'	634564	564155
   817	000307'	645560	435762
   818	000310'	446353	435062
   819	000311'	637163	636462
   820	000312'	525742	636462
   821	000313'	636462	656557
   822	000314'	637163	605071
   823	000315'	466245	435056
   824	000316'	444566	647160
   825	000317'	444566	636463
   826	000320'	444566	606056
   827			000056	UCLLEN==.-UCLTAB		;DEFINE LENGTH OF DIGITAL MUUO TABLE
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 11
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

   828				DEFINE X (A,B)
   829				<	ZZ==ZZ+1
   830					DEFINE XX (C)		;DEFINE XX IN CASE JOB NUMBER OF CUSTOMER MUUO'S
   831				<	XWD UUOERR,C
   832				>>
   833			000000	ZZ==0
   834				;COUNT NUMBER OF CUSTOMER DEFINED MUUO'S
   835					CNAMES
   836			000151	CCILEN==ZZ
   837
   838				;GENERATE HALF WORD MUUO DISPATCH TABLE
   839
   840				DEFINE X (A,B)
   841				<	IFE ZZ&1,
   842				<	DEFINE XX (C)
   843				<
   844					XWD B,C
   845				>>
   846					IFN ZZ&1,
   847				<
   848					XX B
   849				>
   850				ZZ==ZZ+1
   851				>  ;end DEFINE X
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 12
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

   852				;GENERATE CUSTOMER TABLE
   853
   854	000321'	000000*	000000*		CNAMES
   855	000322'	000572'	000510'
   856	000323'	000662'	001230'
   857	000324'	000000*	001725'
   858	000325'	000477'	000000*
   859	000326'	000000*	000000*
   860	000327'	001555'	000000*
   861	000330'	000000*	000000*
   862	000331'	000000*	000000*
   863	000332'	000000*	000701'
   864	000333'	000000*	000456'
   865	000334'	004640'	000000*
   866	000335'	000000*	000000*
   867	000336'	001646'	000000*
   868	000337'	000000*	000000*
   869	000340'	000000*	000000*
   870	000341'	000000*	000000*
   871	000342'	000000*	000000*
   872	000343'	000000*	000000*
   873	000344'	000000*	000000*
   874	000345'	000000*	000000*
   875	000346'	000000*	000000*
   876	000347'	000000*	000000*
   877	000350'	000000*	000000*
   878	000351'	000000*	000000*
   879	000352'	000000*	000000*
   880	000353'	000000*	000000*
   881	000354'	000000*	004661'
   882	000355'	004573'	000000*
   883	000356'	004172'	000630'
   884	000357'	002732'	001735'
   885	000360'	000000*	000335*
   886	000361'	000756'	000360*
   887	000362'	000000*	000361*
   888	000363'	000000*	000000*
   889	000364'	000000*	000000*
   890	000365'	000000*	000000*
   891	000366'	000000*	000000*
   892	000367'	000000*	000000*
   893	000370'	000000*	000000*
   894	000371'	000000*	001062'
   895	000372'	001226'	000000*
   896	000373'	000000*	000000*
   897	000374'	001275'	000000*
   898	000375'	000000*	002747'
   899	000376'	002770'	001246'
   900	000377'	001220'	000000*
   901	000400'	001224'	001216'
   902	000401'	001600'	000635'
   903	000402'	001017'	001107'
   904	000403'	000720'	000377*
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 12-2
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

   905	000404'	000000*	000403*
   906	000405'	000000*	002630'
   907
   908			000000	ZZ==0
   909
   910				;FIX UP SYMBOLS NOT IN UUOCON
   911
   912				EXTERNAL REASSIGN,WAKUUO
   913
   914				EXTERN TMP.UU
   915				EXTERN DSKCHR,SYSTUU,JOBSTR,STRUUO,SYSPHY,GOBSTR
   916				EXTERNAL APRENB,SETPOV,SLEEP,HIBER,DISMIS	;IN PICON
   917
   918				;GENERATE DIGITAL TABLE
   919
   920	000406'	000525'	000000*	UCLJMP:	NAMES
   921	000407'	003003'	000000*
   922	000410'	002643'	000362*
   923	000411'	002643'	000410*
   924	000412'	000000*	000000*
   925	000413'	000463'	000411*
   926	000414'	001707'	003022'
   927	000415'	000000*	003116'
   928	000416'	002631'	000000*
   929	000417'	001713'	001717'
   930	000420'	002656'	001670'
   931	000421'	000000*	001542'
   932	000422'	001540'	000000*
   933	000423'	000000*	001575'
   934	000424'	003016'	000000*
   935	000425'	002626'	002627'
   936	000426'	000000*	003240'
   937	000427'	000000*	003520'
   938	000430'	000000*	000000*
   939	000431'	000000*	000000*
   940	000432'	000000*	000000*
   941	000433'	000000*	002642'
   942	000434'	002742'	002666'
   943	000435'	000000*	000413*
   944	000436'	000000*	000455'
   945	000437'	000000*	000435*
   946	000440'	002725'	000454'
   947	000441'	000000*	002634'
   948	000442'	002637'	000437*
   949	000443'	000000*	000000*
   950	000444'	000000*	002341'
   951	000445'	000000*	000453'
   952	000446'	000000*	002675'
   953	000447'	000000*	000442*
   954	000450'	000715'	000447*
   955	000451'	000000*	000450*
   956	000452'	000000*	000451*
   957
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 12-3
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

   958					IFN ZZ&1,<XX CPOPJ>	;GEN. LAST WORD IF ODD NUMBER OF UUOS
   959			000112	UCILEN==<.-UCLJMP>*2	;MAX DIGITAL CALLI INDEX
   960
   961	000453'	263040	000000	OTHUSR:	POPJ	P,	;CALLI +77
   962	000454'	263040	000000	CTLJOB:	POPJ	P,	;CALLI +65
   963	000455'	263040	000000	JOBSTS:	POPJ	P,	;CALLI +61
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 13
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

   964
   965				;CONT UUO
   966				;CALLI -125
   967
   968				;	CONT
   969				;	  <NO-LICENSE or DETACHED>
   970				;	<NORMAL-RETURN>
   971
   972				EXTERN	TTYUSM				; ROUTINE IN SCNSER
   973				EXTERN	DDBLDB				; HOME OF LDB POINTER IN DDB
   974
   975	000456'	200202	000000*	CONTUU:	MOVE	F,TTYTAB(J)		; FIND THE DDB
   976	000457'	550244	000000*		HRRZ	U,DDBLDB(F)		; FIND THE LDB
   977	000460'	322240	000452*		JUMPE	U,CPOPJ			; ERROR IF DETACHED
   978	000461'	260040	000000*		PUSHJ	P,TTYUSM		; DO THE WORK
   979	000462'	254000	000000*		JRST	CPOPJ1
   980
   981
   982				;EXIT MUUO ROUTINE
   983				;CALL:	CALL FIELD, [SIXBIT/EXIT/]
   984				;IF FIELD - 0, PRINT EXIT ^C.  CONT WILL NOT WORK
   985				;IF FIELD NON-ZERO, JUST PRINT.  DO NOT RELEASE DEVICES
   986
   987				EXTERNAL ERREXI,ERREX1,IORELS
   988
   989	000463'	205300	000001	EXIT:	MOVSI	T1,JACCT	;CLEAR PRIVILEGED CUSP BIT ON EXIT FOR
   990								; BENEFIT OF PLEASE AND RECALL
   991	000464'	541300	100000		HRRI	T1,JACCT2	;ALSO USER SETTABLE ONE
   992	000465'	412302	000154*		ANDCAM	T1,JBTSTS(J)
   993	000466'	326500	000474'		JUMPN	W,EXIT1		;AC FIELD NON-ZERO?
   994	000467'	260040	000000*		PUSHJ	P,IORELS	;NO, RELEASE ALL DEVICES
   995	000470'	260040	000525'		PUSHJ	P,RESET		;AFTER CLOSING OUT FILES, RELEASE RT DEV
   996								;UNLOCK JOB, RESET APR
   997				 EXTERNAL ACTWRT
   998	000471'	201300	000001		MOVEI	T1,1
   999	000472'	260040	000000*		PUSHJ	P,ACTWRT	;WRITE TYPE 1 ACCOUNTING RECORD
  1000	000473'	324740	000000*		PJRST	ERREXI		;MOVE "EXIT" TO OUTPUT BUFFER
  1001								; AND STOP JOB, AND START TTY
  1002								; "CONTINUE" WILL NOT WORK
  1003	000474'	201300	000002	EXIT1:	MOVEI	T1,2
  1004	000475'	260040	000472*		PUSHJ	P,ACTWRT	;WRITE TYPE 2 ACCOUNTING RECORD
  1005	000476'	324740	000000*		PJRST	ERREX1
  1006
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 14
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

  1007
  1008				;Frame Exit Routine(s)
  1009				; Specified AC is stored into %UPT+UPTELC
  1010				;FLEXIT - Fail exit, not continuable
  1011				;FLSTOP - Fail stop, continuable
  1012
  1013				EXTERNAL ERRFEX,ERRFX1
  1014
  1015	000477'	205300	000001	FLEXIT:	MOVSI	T1,JACCT	;CLEAR PRIVILEGED CUSP BIT ON EXIT FOR
  1016								; BENEFIT OF PLEASE AND RECALL
  1017	000500'	541300	100000		HRRI	T1,JACCT2	;ALSO USER SETTABLE ONE
  1018	000501'	412302	000465*		ANDCAM	T1,JBTSTS(J)
  1019	000502'	260040	000467*		PUSHJ	P,IORELS	;NO, RELEASE ALL DEVICES
  1020	000503'	260040	000525'		PUSHJ	P,RESET		;AFTER CLOSING OUT FILES, RELEASE RT DEV
  1021								;UNLOCK JOB, RESET APR
  1022	000504'	201300	000001		MOVEI	T1,1
  1023	000505'	260040	000475*		PUSHJ	P,ACTWRT	;WRITE TYPE 1 ACCOUNTING RECORD
  1024	000506'	256200	004741'		UMOVE	T4,(W)		;Pick up arg from user's AC
  1025	000507'	324740	000000*		PJRST	ERRFEX		;MOVE "EXIT" TO OUTPUT BUFFER
  1026								; AND STOP JOB, START TTY, CONT WILL NOT WORK
  1027
  1028	000510'	205300	000001	FLSTOP:	MOVSI	T1,JACCT	;CLEAR PRIVILEGED CUSP BIT ON EXIT FOR
  1029								; BENEFIT OF PLEASE AND RECALL
  1030	000511'	541300	100000		HRRI	T1,JACCT2	;ALSO USER SETTABLE ONE
  1031	000512'	412302	000501*		ANDCAM	T1,JBTSTS(J)
  1032	000513'	201300	000002		MOVEI	T1,2
  1033	000514'	260040	000505*		PUSHJ	P,ACTWRT	;WRITE TYPE 2 ACCOUNTING RECORD
  1034	000515'	256200	004741'		UMOVE	T4,(W)		;Pick up arg from user's AC
  1035	000516'	324740	000000*		PJRST	ERRFX1
  1036
  1037				;
  1038				;  CODE TO HANDLE SOFTWARE I/O INTERRUPT UUO
  1039				;
  1040
  1041	000517'	360604	000016	NINTRP:	POINT 6,DEVINT(F),5		;INPUT INTERRUPT
  1042	000520'	300604	000016	NOUTRP:	POINT 6,DEVINT(F),11		;OUTPUT INTERRUPT
  1043	000521'	220604	000016	NWATRP:	POINT 6,DEVINT(F),17		;IO WAIT INTERRUPT
  1044	000522'	140604	000016	NERTRP:	POINT 6,DEVINT(F),23		;ERROR INTERRUPT
  1045	000523'	060604	000016	NEFTRP:	POINT 6,DEVINT(F),29		;EOF INTERRUPT
  1046	000524'	000604	000016	NSPTRP:	POINT 6,DEVINT(F),35		;SPECIAL INTERRUPT
  1047			000006	NUMINT==.-NINTRP
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 15
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

  1048				;; NEW VM SYSTEM RESET UUO KERNEL
  1049				;; FUNCTION:1) (NEW) GUARANTEE THAT PAGE 0 BECOMES PRIVATE-RDW
  1050				;;	    2) RESET CONTROLLING TTY
  1051				;;	    3) DIDDLE PC FLAGS
  1052				;;	    4) (NEW) SET USER WS LIMIT TO MAX
  1053				;;	    5) SET JWSADJ BIT FROM ADJMWS
  1054				;;	    6) (NEW) RESET TRU LIMIT FROM JBTSLM
  1055				;;	    7) RESET XCHARG "CHARGES SAVED IN UPT" BIT
  1056				;;	    8) RESET TRAP SYSTEM
  1057				;;
  1058				;; PRESERVES: M  ---  DESTROYS: PRACTICALLY ALL AC'S.
  1059				;; EXPECTS: J/JOB
  1060
  1061				EXTERN PS.CPR,PS.FIL,UPYUWL,UPYUWM,RESFRH,IOKILL,CHNCHK,CHNCK1
  1062
  1063	000525'	201140	000000	RESET::	MOVEI	PG,0
  1064	000526'	047140	777707		CALLI	PG,-71 		;GET PG/ PAGE STATUS, VP 0
  1065	000527'	255000	000000		  JFCL			;NOT SPOSED TO HAPPEN
  1066	000530'	606140	000000*		TRNN	PG,PS.FIL	;SKIP IF FILE PAGE
  1067	000531'	254000	000541'		  JRST	RSET1		;PRIVATE, MAY NEED TO MAKE RDW
  1068	000532'	205140	000001		MOVSI	PG,1		;PG/<CONTIG>,,VP#
  1069	000533'	047140	777713		CALLI	PG,-65		;REMOVE PAGE 0
  1070	000534'	255000	000000		  JFCL
  1071	000535'	205140	006001		MOVSI	PG,(<CPRRDW>B7+1B17)
  1072	000536'	047140	777711		CALLI	PG,-67		;CREAT NEW PAGE 0
  1073	000537'	255000	000000		  JFCL			;SIGH
  1074	000540'	254000	000547'		JRST RSET2
  1075	000541'			RSET1:	;PRIVATE PAGE, JUST MAKE SURE IT'S RDW
  1076	000541'	405140	000000*		ANDI	PG,PS.CPR
  1077	000542'	302140	000001		CAIE	PG,CPRRED	
  1078	000543'	254000	000547'		  JRST	RSET2		;NOT DO- MUST BE COW OR RDW
  1079	000544'	205140	006001		MOVSI	PG,(<CPRRDW>B7+1B17)
  1080	000545'	047140	777710		CALLI	PG,-70		;VPROT PG,
  1081	000546'	255000	000000		  JFCL			;SIGH
  1082	000547'	260040	000000*	RSET2:	PUSHJ	P,TTYRES	;RESET CONTROLLING TTY
  1083	000550'	260040	000000*		PUSHJ	P,IOKILL	;RELEASE ALL DEVICES
  1084	000551'	205300	765777		MOVSI	T1,777777-PC.USR-PC.PUB	;CLEAR ALL MUUO PC FLAGS IN LH, EXCEPT USER MODE
  1085	000552'	412300	000000*		ANDCAM	T1,%UPT+UPTPDL	;LEAVE USER MODE OFF TOO, IF EXEC DOING CALL RESET
  1086	000553'	205300	000000*		MOVSI	T1,SAVCHG
  1087	000554'	412300	000000*		ANDCAM	T1,%UPT+UPTSTS	;RESET "XCHARG DONE" FLAG
  1088	000555'	402002	000000*		SETZM	JBTSCA##(J)	;Reset TRU scaling factor
  1089	000556'	135300	000000*		LDB	T1,UPYUWM	;CONSOLE-SETTABLE WS MAXIMUM
  1090	000557'	137300	000000*		DPB	T1,UPYUWL	;PROGRAMMABLE LIMIT
  1091	000560'	200302	000512*		MOVE	T1,JBTSTS(J)
  1092	000561'	332000	000000*		SKIPE	ADJMWS
  1093	000562'	664300	400000		  TROA	T1,JWSADJ
  1094	000563'	620300	400000		 TRZ	T1,JWSADJ
  1095	000564'	202302	000560*		MOVEM	T1,JBTSTS(J)	;SET PER-JOB MWS ADJUST BIT FROM ADJMWS
  1096	000565'	260040	000000*		PUSHJ	P,RESFRH	;GET RID OF ALL FRAME HANDLES
  1097	000566'	200302	000000*		MOVE	T1,JBTSLM(J)	;Copy saved TRU limit (if any) into the
  1098	000567'	202302	000000*		MOVEM	T1,JBTLIM(J)	; current LIMIT (checked at clock level)
  1099	000570'	201300	000000		MOVEI	T1,0
  1100	000571'	324740	000000*		PJRST APRENB		;ALSO RESET INTERRUPTS
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 15-2
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

  1101
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 16
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

  1102
  1103				;; SETLIM - SET TRU LIMIT  (CALLI -150)
  1104				;;
  1105				;;  CALL:
  1106				;;	MOVE	AC,[ <funct>B8 + <tru-limit>B35 ]
  1107				;;	SETLIM	AC,
  1108				;;	  error return		; AC contains error code
  1109				;;	normal return
  1110				;;
  1111				;;  FUNCT:
  1112				;;	0  -  Set TRU limit to <tru-limit>, if 0 then reset limit
  1113				;;	1  -  Add <tru-limit> to current TRU limit
  1114				;;	2  -  Set TRU limit to current charges plus <tru-limit>
  1115				;;
  1116				;;  ERROR CODES:
  1117				;;	1  -  Illegal function code
  1118				;;	2  -  Illegal tru-limit (must be 0 to 3,435,973 TRUs)
  1119				;;	3  -  Limit exceeds maximum (set by console SET LIMIT)
  1120				;;
  1121				;;	
  1122			000000		XP .SLSET,0		; Set JBTLIM from C(AC), reset if C(AC)=0
  1123			000001		XP .SLEXT,1		; Extend JBTLIM by C(AC)
  1124			000002		XP .SLINC,2		; Increment current TRU by C(AC)
  1125
  1126	000572'	322300	000620'	SETLIM:	JUMPE	T1,SETLI2		; .SLSET, limit=0 :: reset
  1127	000573'	135340	004742'		LDB	T2,[POINT 9,T1,8]	; Copy function
  1128	000574'	621300	777000		TLZ	T1,777000		; Clear function bits
  1129	000575'	303340	000002		CAILE	T2,.SLINC		; Must be legal
  1130	000576'	254000	000623'		  JRST	SETLE1			; *** Error: Illegal function code
  1131	000577'	322340	000607'		JUMPE	T2,SETLI0		; .SLSET, check size and set limit
  1132	000600'	261040	000006		PUSH	P,T1			; Save increment
  1133	000601'	200302	000567*		MOVE	T1,JBTLIM(J)		; Default to extend current limit
  1134	000602'	302340	000001		CAIE	T2,.SLEXT		; Check if want to EXTEND limit
  1135	000603'	260040	003606'		  PUSHJ	P,CLKTRU		; No, get current TRUs instead
  1136	000604'	231300	023420		IDIVI	T1,^D10000		; Reduce to next smaller integer
  1137	000605'	270301	000000		ADD	T1,(P)			; Add in saved increment
  1138	000606'	262041	000000		POP	P,(P)			;   then fixup stack
  1139	000607'	313300	004743'	SETLI0:	CAMLE	T1,[^D3435973]		; Is it still in range?
  1140	000610'	254000	000624'		  JRST	SETLE2			; No, *** Error: Too large
  1141	000611'	221300	023420		IMULI	T1,^D10000		; Put limit in proper perspective
  1142	000612'	336002	000566*		SKIPN	JBTSLM(J)		; Was one set by console command?
  1143	000613'	254000	000616'		  JRST	SETLI1			; No, go set the limit
  1144	000614'	313302	000612*		CAMLE	T1,JBTSLM(J)		; Check against console value
  1145	000615'	254000	000626'		  JRST	SETLE3			; Sigh! *** Error: Exceeds maximum
  1146	000616'	202302	000601*	SETLI1:	MOVEM	T1,JBTLIM(J)		; All is OK, set the limit
  1147	000617'	254000	000462*		JRST	CPOPJ1			; Return
  1148
  1149	000620'	200302	000614*	SETLI2:	MOVE	T1,JBTSLM(J)		; Copy limit set by console
  1150	000621'	202302	000616*		MOVEM	T1,JBTLIM(J)		; All is OK, set the limit
  1151	000622'	254000	000617*		JRST	CPOPJ1			; Return
  1152
  1153	000623'	334340	004744'	SETLE1:	SKIPA	T2,[1]			; %1 Illegal function
  1154	000624'	201340	000002	SETLE2:	MOVEI	T2,2			; %2 Illegal limit large
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 16-2
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

  1155	000625'	254000	001015'		JRST	RETERR			;  return error to user
  1156	000626'	201340	000003	SETLE3:	MOVEI	T2,3			; %3 Limit larger than maximum
  1157	000627'	254000	001015'		JRST	RETERR
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 17
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

  1158				; RESTRICED COMMAND FILE AND PPN UUO
  1159				;
  1160	000630'	256200	004745'	RECMFL:	UMOVE T2,(T1)		;GET NAME
  1161	000631'	202340	000000*		MOVEM T2,%UPT+UPTRNM
  1162	000632'	256200	004746'		UMOVE T2,1(T1)		;GET PPN
  1163	000633'	202340	000000*		MOVEM T2,%UPT+UPTRPN
  1164	000634'	263040	000000		POPJ P,
  1165
  1166	000635'	200340	000700'	SETPRV:	MOVE	T2,PRVMSK	;get mask of legal bits
  1167	000636'	661340	400000		TLO	T2,PVLOS	;allow user to SET PVLOS LogoutOnStop
  1168	000637'	404300	000007		AND	T1,T2		;mask selected bits
  1169	000640'	200400	000006		MOVE	T3,T1
  1170	000641'	400340	000000		SETZ	T2,		;IF WANT TO RESET TIMEOUT
  1171	000642'	603400	000400		TLNE	T3,PVDINA	;SET OR RESET INACTIVITY TIMEOUT?
  1172	000643'	550340	000000*		  HRRZ	T2,INADEF##	;SET. DEFAULT TIMEOUT (15 MIN, SEE NSWTBL+7)
  1173	000644'	430402	000000*		XOR	T3,JBTPRV(J)
  1174	000645'	603400	000400		TLNE	T3,PVDINA	;HAS PVDINA CHANGED?
  1175	000646'	137340	000000*		  DPB	T2,JBYINA##	;YES, UPDATE
  1176	000647'	200340	000700'		MOVE	T2,PRVMSK
  1177	000650'	412342	000644*		ANDCAM	T2,JBTPRV(J)	;TURN OFF
  1178	000651'	436302	000650*		IORM	T1,JBTPRV(J)	;SET AS HE WANTED
  1179	000652'	135300	000000*		LDB	T1,PVYCRM	;GET MAX CORE HE CAN HAVE
  1180	000653'	135340	000000*		LDB	T2,PVYCOR	;AMOUNT HE JUST SET IT TO
  1181	000654'	313340	000006		CAMLE	T2,T1		;TOO MUCH?
  1182	000655'	200340	000006		  MOVE	T2,T1		;YES, RESET TO MAX
  1183	000656'	315340	000000*		CAMGE	T2,CORMXK
  1184	000657'	200340	000656*		  MOVE	T2,CORMXK
  1185	000660'	137340	000653*		DPB	T2,PVYCOR
  1186	000661'	263040	000000		POPJ	P,
  1187
  1188	000662'	461340	000000*	SETINA:	SETCMI	T2,JBLMSK##
  1189	000663'	612300	000007		TDNE	T1,T2		;LIMIT TOO BIG?
  1190	000664'	263040	000000		  POPJ	P,		;YES, ERROR RETURN
  1191	000665'	317300	000643*		CAMG	T1,INADEF##	;If limit is greater than default
  1192	000666'	307300	000000		CAIG	T1,0		;  or less than acceptable
  1193	000667'	260040	000000*		  PUSHJ	P,CHKASL##	;Check if we have appropriate privs
  1194	000670'	304000	000000		 CAIA			;Acceptable limit, sup or proper license
  1195	000671'	263040	000000		   POPJ	P,		; otherwise, error return
  1196	000672'	137300	000646*		DPB	T1,JBYINA##	;SET LIMIT
  1197	000673'	205340	000400		MOVSI	T2,PVDINA
  1198	000674'	436342	000651*		IORM	T2,JBTPRV(J)	;SET INACTIVITY TIMEOUT IN PRIVS
  1199	000675'	336000	000006		SKIPN	T1		;DID WE JUST SET THE LIMIT TO 0?
  1200	000676'	412342	000674*		 ANDCAM	T2,JBTPRV(J)	;YES, SO CLEAR THE BIT
  1201	000677'	254000	000622*		JRST	CPOPJ1
  1202
  1203	000700'	377777	701600	PRVMSK::XWD PVNMAI!PVNOAT!PVMTIM!PVMCOR!PVDINA!PVSCMD,PVMMOD!PVEXO!PVMHNG!PVRCMD
  1204
  1205				comment !	SETALP uuo
  1206
  1207					MOVEI	ac,	[sixbit "<device>"
  1208							 xwd <gan>,<uun>
  1209							 sixbit "<filename>"]
  1210					SETALP	ac,
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 17-2
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

  1211					  <error return>	; if already set, if logout in progress
  1212								; or if no PPN given
  1213					<ok return>
  1214				!
  1215	000701'	200342	000564*	SETALP:	MOVE	T2,JBTSTS(J)
  1216	000702'	602340	000100		TRNE	T2,KJP		; IF LOGOUT IN PROGRESS - ERROR
  1217	000703'	263040	000000		 POPJ	P,
  1218	000704'	332000	000000*		SKIPE	%UPT+UPTALN	; IF ONE ALREADY SET - ERROR
  1219					 JRST	[UMOVE	T2,0(T1)  ;Check if trying to set it to current value
  1220						 CAME	T2,%UPT+UPTALD##
  1221						  POPJ	P,	  ;Cannot change what is there
  1222						 UMOVE	T2,1(T1)
  1223						 UMOVE	T3,2(T1)
  1224						 CAMN	T2,%UPT+UPTALP##
  1225						 CAME	T3,%UPT+UPTALN##
  1226						  POPJ	P,
  1227	000705'	254000	004750'			 JRST	CPOPJ1	] ;Don't complain if setting to same
  1228	000706'	256200	004745'		UMOVE	T2,0(T1)	; GET DEVICE
  1229	000707'	202340	000000*		MOVEM	T2,%UPT+UPTALD##
  1230	000710'	256200	004746'		UMOVE	T2,1(T1)	; GET PPN
  1231	000711'	202340	000000*		MOVEM	T2,%UPT+UPTALP##
  1232	000712'	256200	004761'		UMOVE	T2,2(T1)	; GET NAME
  1233	000713'	202340	000000*		MOVEM	T2,%UPT+UPTALN##
  1234	000714'	324740	000677*		PJRST	CPOPJ1		; SKIP RETURN
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 18
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

  1235				;DEC's ATTACH uuo (CALLI +104) attaches a job to a TTY line.  That is, you
  1236				;cannot detach an arbitrary job, but you can detach an arbritrary line.
  1237				;The only function that works under TYMCOM-X is <-1,,0> to detach this job.
  1238
  1239	000715'	621300	600000	UATTAC:	TLZ	T1,(1B0+1B1)	;Ignore flag bits if specified
  1240	000716'	641300	177777		TLC	T1,177777	;Give error return if not now 177777,,0
  1241	000717'	326300	000460*		JUMPN	T1,CPOPJ	;Anything else should be done via RETACH uuo
  1242					PFALL	ATTUUO		;Detach command port from current line if so
  1243
  1244				;ATTACH UUO (CALLI -6) -  CALLED WITH ONE OF
  1245				;
  1246				;	T1/	NEGATIVE (EQUIVALENT TO T1/ 0)
  1247				;	T1/	BITS,,0  (DETACH TTY FROM CURRENT JOB)
  1248				;	T1/	BITS,,JOB # (DETACH FROM CURRENT, ATTACH TO SPEC.)
  1249				;
  1250				;	BITS = 1 TO SUPPRESS FORCING THE ATTACHEE INTO COMMAND MODE
  1251				;	     + 2 TO SUPPRESS FORCING AN EXIT FOR THE DETACHEE
  1252
  1253	000720'	335000	000006	ATTUUO:	SKIPGE	T1		;IF T1 .LT. 0,
  1254	000721'	400300	000000		 SETZ	T1,		;    T1 := 0
  1255	000722'	606300	777777		TRNN	T1,-1		;IF T1.RIGHT = 0,
  1256	000723'	254000	000000*		 JRST	TDTUUO		;    DO A DETACH
  1257	000724'	550400	000006		HRRZ	T3,T1		;T3/ JOB NUMBER
  1258	000725'	205340	040000		MOVSI	T2,JNA
  1259	000726'	305400	000000*		CAIGE	T3,JOBN
  1260	000727'	616350	000701*		TDNN	T2,JBTSTS(T3)
  1261	000730'	263040	000000		 POPJ	P,		;JOB DOES NOT EXIST
  1262	000731'	205340	000004		MOVSI	T2,JLOG
  1263	000732'	616342	000727*		TDNN	T2,JBTSTS(J)	;IF CALLER ISN'T LOGGED-IN,
  1264	000733'	254000	000742'		 JRST	TRYATT		;    ALLOW ATTACH TO ANY AUN
  1265	000734'	205340	001000		MOVSI	T2,LICJAL
  1266	000735'	612342	000000*		TDNE	T2,JBTLIC(J)	;IF CALLER HAS JL LICENSE,
  1267	000736'	254000	000742'		 JRST	TRYATT		;    ALLOW ATTACH TO ANY AUN
  1268	000737'	200342	000000*		MOVE	T2,JBTAUN(J)	;OTHERWISE,
  1269	000740'	312350	000737*		CAME	T2,JBTAUN(T3)	;    AUN'S MUST MATCH
  1270	000741'	263040	000000		 POPJ	P,
  1271
  1272	000742'	261040	000006	TRYATT:	PUSH	P,T1		;SAVE <BITS>
  1273	000743'	260040	000000*		PUSHJ	P,TATUUO	;CALL SCNSER'S ATTACH ROUTINE
  1274	000744'	254000	000000*		  JRST	TPOPJ		;(IT COULDN'T ATTACH)
  1275	000745'	262040	000006		POP	P,T1		;RESTORE <BITS>
  1276	000746'	603300	000002		TLNE	T1,2		;IF SUPRESS-EXIT BIT SET,
  1277	000747'	263040	000000		 POPJ	P,		;    JUST RETURN
  1278	000750'	200100	000204*		MOVE	J,JOB		;OTHERWISE, FORCE AN EXIT UUO
  1279	000751'	205300	000004		MOVSI	T1,JLOG
  1280	000752'	616302	000732*		TDNN	T1,JBTSTS(J)
  1281	000753'	254000	000000*		 JRST	JOBKL		;OR JUST KILL THE JOB IF NOT LOGGED-IN
  1282	000754'	201500	000000		MOVEI	W,0		;FORCE AN EXIT 0,
  1283	000755'	254000	000463'		JRST	EXIT
  1284
  1285				EXTERNAL TATUUO,TDTUUO,PVYCRM,PVYCOR,CORMXK
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 19
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

  1286				COMMENT !
  1287
  1288				INTRMT AC,0
  1289					ASSIGNS CERTAIN INTERRUPT CAUSING CONDITIONS TO PSEUDO-
  1290					INTERRUPT CHANNELS, USING THE NEW PSEUDO-INTERRUPT
  1291					SYSTEM. MUST BE PRECEDED BY INTADR UUO.
  1292
  1293					AC BITS 18-35 HAVE CHANEL NUMBER ON WHICH DEVICE IS INITED
  1294						AN INIT MUST HAVE BEEN DONE
  1295					AC BITS 9-17 HAVE THE INTERUPT CHANNEL NUMBER
  1296					AC BITS 0-8 HAVE THE REASON FOR THE INTERUPT
  1297
  1298						0  INPUT AVAILABLE
  1299						1  OUTPUT BUFFER AVAILABLE. MUST HAVE INTERUPTED
  1300						   FOR I/O WAIT
  1301						2  UUO WOULD PLACE JOB IN I/O WAIT
  1302						3  END OF FILE ON INPUT (NOT YET USED)
  1303						4  ERROR ON INPUT OR OUTPUT (NOT YET USED)
  1304						5  PORT ZAPPED
  1305
  1306					NOTE THAT THE ERROR RETURN IS ALWAYS TAKEN IF THE PORT IS
  1307					ALREADY ZAPPED
  1308
  1309					SKIP RETURN IF SUCCESSFUL. AC HAS PREVIOUS CHANNEL ASSIGNMENT.
  1310					NON-SKIP RETURN  IF NONSUCCESSFUL, ERROR CODE IN AC RIGHT
  1311						NOPORT = PORT NOT ASSIGNED TO THIS JOB
  1312						NXCOND = NON-EXISTENT CONDITION
  1313						NXCHAN = NON-EXISTENT CHANNEL
  1314						NOINT  = NOT PRECEDED BY INTADR
  1315				!
  1316
  1317
  1318
  1319				EXTERN JBTPIP
  1320				;T1 HAS USER AC CONTENTS
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 20
UUOCON.MAC	 4-DEC-87 16:09		USRXIT - Exit from UUO, return to user mode

  1321				EXTERNAL TAKTRP,CHNCK1
  1322				INTERNAL RETERR
  1323			000001	NXICHN==1		;INCORRECT CHANNEL NUMBER
  1324			000005	NXCOND==5		;NON EXISTENT INTERRUPT CONDITION
  1325			000006	NXCHAN==6		;NON EXISTENT INTERRUPT CHANNE
  1326			000007	NOINT==7		;INTADR UUO NOT CALLED
  1327	000756'	201340	000001	INTRMT::MOVEI	T2,NXICHN	;INCASE ERROR RETURN FROM CHNCK1
  1328	000757'	550500	000006		HRRZ	W,T1		;GET PROPOSED CHANNEL NUMBER
  1329	000760'	261040	000006		PUSH	P,T1
  1330	000761'	201300	000001		MOVEI	T1,DDINT
  1331	000762'	260040	000000*		PUSHJ	P,CHNCK1##	;SEE IF REAL CHANNEL
  1332	000763'	255000	000000		  JFCL			;BAD CHAN
  1333					  JRST	[POP P,T1	;NOT IN DISPATCH TABLE,UNWIND STK &
  1334	000764'	254000	004762'			JRST RETERR]	; RTN NXICHN ERR COD
  1335	000765'	262040	000006		POP	P,T1
  1336	000766'	335002	000000*		SKIPGE	JBTPIP(J)
  1337	000767'	254000	001010'		  JRST	INTER1		;NO INTADR DONE
  1338	000770'	135340	004742'		LDB	T2,[POINT 9,T1,8]
  1339	000771'	301340	000006		CAIL	T2,NUMINT	;LEGAL CONDITION?
  1340	000772'	254000	001012'		  JRST	INTER2		;NO
  1341	000773'	135300	004764'		LDB	T1,[POINT 9,T1,17]
  1342	000774'	303300	000043		CAILE	T1,^D35		;LEGAL CHANNEL?
  1343	000775'	254000	001014'		  JRST	INTER3
  1344	000776'	135407	000517'		LDB	T3,NINTRP(T2)	;GET OLD CHANNEL
  1345	000777'	256200	004765'		UMOVEM	T3,(W)		;AND RETURN
  1346	001000'	137307	000517'		DPB	T1,NINTRP(T2)
  1347	001001'	322300	000714*		JUMPE	T1,CPOPJ1	;IF 0, COULD NOT INTERUPT NOW
  1348	001002'	200600	000006		MOVE	P1,T1		;SAVE CHANNEL NUMBER
  1349	001003'	260051	000001		PUSHJ	P,DDINT(T4)	;CALL DEVICE DEPENDENT ROUTINE
  1350	001004'	254000	001014'		  JRST	INTER3		;ERROR RETURN
  1351	001005'	334000	000000		  SKIPA			;O.K. BUT NO TRAP NOW
  1352					JRST	[MOVE T1,P1	;TAKE TRAP. RECOVER CHANNEL NUMBER
  1353						 PUSHJ P,TAKTRP
  1354	001006'	254000	004766'			 JRST CPOPJ1]
  1355	001007'	254000	001001*		JRST	CPOPJ1
  1356
  1357
  1358	001010'	201340	000007	INTER1:	MOVEI	T2,NOINT
  1359	001011'	254000	001015'		JRST	RETERR
  1360	001012'	201340	000005	INTER2:	MOVEI	T2,NXCOND
  1361	001013'	254000	001015'		JRST	RETERR
  1362	001014'	201340	000006	INTER3:	MOVEI	T2,NXCHAN
  1363	001015'	256200	004771'	RETERR:	UMOVEM	T2,(M)		;T2 has error code, return it to user
  1364	001016'	263040	000000		POPJ	P,
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 21
UUOCON.MAC	 4-DEC-87 16:09		SETLIC (CALLI -10) - Set process and frame license

  1365				SUBTTL	SETLIC (CALLI -10) - Set process and frame license
  1366				EXTERNAL JBTLIC,MAXLIC,LICMSK,JBTSLC
  1367
  1368					;SETLIC UUO. SETS BOTH HALVES OF JBTLIC
  1369					;CHECKS TO SEE IF MAX OF CURRENT TWO HALVES ALLOWS
  1370					;DESIRED SETTING. IF NOT SETS AS MUCH AS IT CAN GET
  1371					;CALL
  1372					;	MOVE AC,DESIRED LICENSE
  1373					;	CALL AC,[SIXBIT /SETLIC/] OR CALLI AC,-10
  1374
  1375	001017'	200342	000735*	SETLIC:	MOVE	T2,JBTLIC(J)
  1376	001020'	500342	000000*		HLL	T2,JBTSLC(J)	;SAVED LIC ALWAYS .GE. JBTLIC L.H.
  1377	001021'	261040	000006		PUSH	P,T1		;LICENSE DESIRED
  1378	001022'	260040	001042'		PUSHJ	P,JOBLIC	;FIND WHAT CAN BE SET
  1379	001023'	200341	000000		MOVE	T2,(P)		; Get max of new
  1380	001024'	544342	001020*		HLR	T2,JBTSLC(J)	;  and old
  1381	001025'	260040	000000*		PUSHJ	P,MAXLIC	;  process lic
  1382	001026'	506342	001024*		HRLM	T2,JBTSLC(J)	; Save so can restore if reduced later
  1383	001027'	200341	000000		MOVE	T2,(P)		; Get max of new
  1384				;*;	TRNN	T2,-1		; ** HACK **		if 0 frame license
  1385				;*;	  JRST	SETLC1		; ** HACK **		don't check maximum
  1386	001030'	504342	001026*		HRL	T2,JBTSLC(J)	;  and old
  1387	001031'	260040	001025*		PUSHJ	P,MAXLIC	;  frame license
  1388	001032'	542342	001030*	SETLC1:	HRRM	T2,JBTSLC(J)	; Save for ENABLE and DISABLE (* possibly 0 *)
  1389	001033'	262040	000007		POP	P,T2		; GET LICENSE HE CAN GET OFF STACK
  1390	001034'	250342	001017*		EXCH	T2,JBTLIC(J)	; GIVE IT TO HIM
  1391	001035'	430342	001034*		XOR	T2,JBTLIC(J)	; SEE WHAT CHANGED
  1392	001036'	606340	777777		TRNN	T2,-1		; SEE IF HE CHANGED THE FRAME LICENSE
  1393	001037'	263040	000000		  POPJ	P,
  1394	001040'	201300	000014		MOVEI	T1,14		;RECORD THAT HE SET LICENSE
  1395	001041'	324740	000514*		PJRST	ACTWRT		;AND RETURN FROM UUO NOSKIP
  1396
  1397	001042'	261040	000007	JOBLIC:	PUSH	P,T2		;SAVE CURRENT LICENSE
  1398	001043'	207001	000000		MOVSS	(P)		;IN L.H. KEEP CUR. JOB LIC.
  1399	001044'	260040	001031*		PUSHJ	P,MAXLIC	;FIND MAX OF JOB AND PROCESS
  1400	001045'	542341	000000		HRRM	T2,(P)		;SAVE LICENSE JOB CAN GET
  1401	001046'	500341	777776		HLL	T2,-2(P)	;GET DESIRED PROCESS
  1402	001047'	260040	000000*		PUSHJ	P,LICMSK
  1403	001050'	506341	777776		HRLM	T2,-2(P)	;AND SAVE IT
  1404	001051'	262040	000007		POP	P,T2		;RESTORE MAX CAN HAVE
  1405	001052'	200302	001035*		MOVE	T1,JBTLIC(J)	;GET HIS CURRENT LICENSE
  1406	001053'	607300	400000		TLNN	T1,LICWCR	;IF HAS WC, LET HIM INCREASE JOB LIC
  1407	001054'	547000	000007		  HLRS	T2		; NO, CAN NOT INCREASE JOB LIC
  1408	001055'	504341	777777		HRL	T2,-1(P)	;DESIRED JOB LIC
  1409	001056'	260040	001047*		PUSHJ	P,LICMSK	;WHAT HE CAN HAVE
  1410	001057'	620340	002040		TRZ	T2,LICRMT!LICHR	;CAN NOT HAVE HF or HR IN JOB
  1411	001060'	542341	777777		HRRM	T2,-1(P)	;RETURN ALLOWED JOB LICENSE
  1412	001061'	263040	000000		POPJ	P,
  1413
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 22
UUOCON.MAC	 4-DEC-87 16:09		CHKLIC (CALLI -31) - Check license a job can set

  1414				SUBTTL	CHKLIC (CALLI -31) - Check license a job can set
  1415
  1416					;CHKLIC UUO. CHECKS ON LICENSE A JOB CAN SET
  1417					;CALL
  1418					;	MOVEI AC,LOC
  1419					;	MOVSI AC,BITS
  1420					;	CALL AC,[SIXBIT /CHKLIC/] OR CALLI AC,-31
  1421					;
  1422					;LOC:	DESIRED LICENSE
  1423					;	PRETEND THIS IS IN LICENSE WORD (SEE BITS)
  1424					;	XOR OF PPN OF USER AND FILE IF SET FOR FILE
  1425					;BITS 1=USE LOC+1 INSTEAD OF JBTLIC
  1426					;     2=SET TO FILE NOT CORE
  1427
  1428	001062'	261040	000013	CHKLIC:	PUSH	P,M
  1429	001063'	540540	000006		HRR	M,T1
  1430	001064'	200400	000006		MOVE	T3,T1		;SAVE LEFT HALF BITS
  1431	001065'	256200	004772'		XCTFU	<PUSH P,(M)>
  1432	001066'	607400	000001		TLNN	T3,1
  1433	001067'	334342	001052*		  SKIPA	T2,JBTLIC(J)
  1434	001070'	256200	004773'		 UMOVE	T2,1(M)
  1435	001071'	603400	000002		TLNE	T3,2		;TO FILE?
  1436	001072'	254000	001100'		  JRST	CKLCFL		;YES
  1437	001073'	260040	001042'		PUSHJ	P,JOBLIC
  1438	001074'	262040	000006		POP	P,T1
  1439	001075'	262040	000013		POP	P,M
  1440	001076'	256200	004774'		UMOVEM	T1,(M)		;STORE IT IN THE USER'S AREA.
  1441	001077'	263040	000000		POPJ	P,		;RETURN.
  1442
  1443
  1444	001100'	513000	000007	CKLCFL:	HLLZS	T2		;USE ONLY THE PROCESS LIC
  1445	001101'	256200	004775'		UMOVE	T3,2(M)		;GET THE XOR TO USE
  1446	001102'	262040	000006		POP	P,T1
  1447	001103'	260040	000000*		PUSHJ	P,FILLIC
  1448	001104'	262040	000013		  POP	P,M
  1449	001105'	256200	004774'		UMOVEM	T1,(M)		;STORE T1 IN USER'S AREA.
  1450	001106'	263040	000000		POPJ	P,		;RETURN.
  1451
  1452				EXTERNAL FILLIC
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 23
UUOCON.MAC	 4-DEC-87 16:09		SETE (CALLI -7) - Set license using system password

  1453				SUBTTL	SETE (CALLI -7) - Set license using system password
  1454
  1455					;SETE UUO. TAKES A 2 WORD SYSTEM PASSWORD AND
  1456					;HASHES IT. THEN COMPARES WITH THE NTH ENTRY OF A TABLE
  1457					;IF COMPARES, TABLES HAS WHAT LICENSE MAY BE SET
  1458					;CALL
  1459					;	MOVEI AC,BLOCK
  1460					;	CALL AC,[SIXBIT /SETE/] OR CALLI AC,-7
  1461					;	ERROR RETURN - INCORRECT PASSWORD
  1462					;	NORMAL RETURN
  1463
  1464					;BLOCK:	WORD 1 OF PASSWORD
  1465					;	WORD 2 OF PASSWORD
  1466					;	NUMBER OF SYSTEM PASSWORD
  1467					;	LICENSE DESIRED
  1468
  1469				EXTERNAL SETECD,SETENM,SETELV
  1470				;TABLES IN SETE##.MAC DEFINE NAMES,PASSWORDS
  1471
  1472	001107'	540540	000006	SETE:	HRR	M,T1			; Use address portion
  1473	001110'	256200	004776'		XCTFU <SKIPN T2,3(M)>		; If setting license to 0
  1474	001111'	254000	001174'		  JRST	ENDHOK			;  Yes, any hash/number ok
  1475	001112'	260040	001143'		PUSHJ	P,INIRDM		;INITIALIZE
  1476	001113'	256200	004777'		UMOVE	P1,1(M)			;ONE WORD OF USER HASH
  1477	001114'	200340	000013		MOVE	T2,M			; Copy M for -1 comparison (obviously)
  1478	001115'	261040	000013		PUSH	P,M
  1479	001116'	256200	005000'		UMOVE	M,(M)			;THE OTHER HASH WORD
  1480	001117'	256200	005001'		XCTFU	<SKIPGE 2(T2)>		; If password number -1
  1481	001120'	260040	001202'		  PUSHJ	P,MOHASH		; Minus One pre-HASHing
  1482	001121'	200400	005002'		MOVE	T3,[POINT 7,HNMAM]	;MORE CHRS TO HASH
  1483	001122'	134200	000010	HS3:	ILDB	F,T3
  1484	001123'	322200	001147'		JUMPE	F,ENDHSH
  1485	001124'	260040	001126'		PUSHJ	P,LOPRDM
  1486	001125'	254000	001122'		JRST	HS3
  1487
  1488	001126'	272200	000013	LOPRDM:	ADDM	F,M
  1489	001127'	272200	000016		ADDM	F,P3
  1490	001130'	201200	000012		MOVEI	F,12
  1491	001131'	200311	000013	HS2:	MOVE	T1,M(T4)
  1492	001132'	224300	005003'		MUL	T1,[5*5*5*5*5*5*5*5*5*5*5*5*5*5*5]
  1493	001133'	272351	000014		ADDM	T2,P1(T4)
  1494	001134'	302440	000003		CAIE	T4,3
  1495	001135'	344440	001141'		  AOJA	T4,HS1
  1496	001136'	200440	000017		MOVE	T4,P4
  1497	001137'	272440	000013		ADDM	T4,M
  1498	001140'	242440	777736		LSH	T4,-42		;GET HIGH 2 BITS FOR NEW INDEX
  1499	001141'	367200	001131'	HS1:	SOJG	F,HS2
  1500	001142'	263040	000000		POPJ	P,
  1501
  1502	001143'	200300	005004'	INIRDM:	MOVE	T1,[XINIT,,P2]
  1503	001144'	251300	000017		BLT	T1,P4
  1504	001145'	201440	000000		MOVEI	T4,0
  1505	001146'	263040	000000		POPJ	P,
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 23-2
UUOCON.MAC	 4-DEC-87 16:09		SETE (CALLI -7) - Set license using system password

  1506
  1507				INTERNAL INIRDM,LOPRDM
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 24
UUOCON.MAC	 4-DEC-87 16:09		SETE (CALLI -7) - Set license using system password

  1508	001147'	200740	000013	ENDHSH:	MOVE	P4,M		;SAVE HASH RESULT
  1509	001150'	262040	000013		POP	P,M
  1510	001151'	256200	005005'		XCTFU  <SKIPGE T1,2(M)>	;GET PASSWORD NUMBER, Skip if positive
  1511	001152'	474300	000000		  SETO	T1,		; Make any negative = -1
  1512	001153'	301300	000000*		CAIL	T1,SETENM
  1513	001154'	263040	000000		  POPJ	P,		;TOO BIG, ERROR RETURN
  1514	001155'	201340	000000*		MOVEI	T2,STRDDB##	;Check if the
  1515	001156'	200347	000000*		MOVE	T2,STRBTS##(T2)	; system structure
  1516	001157'	602340	000000*		TRNE	T2,SRPREF##	; has been refreshed
  1517	001160'	321300	001163'		 JUMPL	T1,ENDROK	;Yes, ignore hash check if SETE -1
  1518	001161'	312746	000000*		CAME	P4,SETECD(T1)	;GET PASSWORD
  1519	001162'	263040	000000		  POPJ	P,		;WRONG
  1520	001163'	200346	000000*	ENDROK:	MOVE	T2,SETELV(T1)	;MAX HE CAN HAVE
  1521	001164'	256200	005006'		XCTBU	<HRL T2,3(M)>
  1522	001165'	261040	000006		PUSH	P,T1		; Save for check later
  1523	001166'	260040	001056*		PUSHJ	P,LICMSK
  1524	001167'	262040	000006		POP	P,T1		; Restore saved password number
  1525	001170'	325300	001174'		JUMPGE	T1,ENDHOK	; SETE -1 for refresh recovery?
  1526	001171'	506342	001067*		  HRLM	T2,JBTLIC(J)	; Yes, make license process only
  1527	001172'	506342	001032*		  HRLM	T2,JBTSLC(J)
  1528	001173'	254000	001177'		  JRST	ENDAOK
  1529	001174'	620340	002040	ENDHOK:	TRZ	T2,LICRMT!LICHR	; Clear HF and HR in frame license
  1530	001175'	542342	001171*		HRRM	T2,JBTLIC(J)
  1531	001176'	542342	001172*		HRRM	T2,JBTSLC(J)	;Save as current max frame license
  1532	001177'	201300	000015	ENDAOK:	MOVEI	T1,15
  1533	001200'	260040	001041*		PUSHJ	P,ACTWRT
  1534	001201'	254000	001007*		JRST	CPOPJ1		;GOOD RETURN
  1535
  1536
  1537	001202'	430600	005007'	MOHASH:	XOR	P1,[SIXBIT/OPER/]	; Username OPER
  1538	001203'	430602	000000*		XOR	P1,JBTUNM(J)		; Undo user name
  1539	001204'	430602	000740*		XOR	P1,JBTAUN(J)		;  and logged-in ppn
  1540
  1541	001205'	430540	000000*		XOR	M,THSDAT##		; Today from CNFTBL(11)
  1542	001206'	430542	000000*		XOR	M,JBTUN1(J)		; Harmful to long user names
  1543	001207'	430542	000000*		XOR	M,JBTPPN(J)		;  must be GFD'd correctly
  1544	001210'	263040	000000		POPJ	P,
  1545
  1546
  1547	001211'	555555	555555	XINIT:	555555555555
  1548	001212'	361275	431652		361275431652
  1549	001213'	555555	555555		555555555555
  1550
  1551	001214'	522631	551620	HNMAM:	ASCIZ /TYMSHR/
	001215'	510000	000000
  1552
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 25
UUOCON.MAC	 4-DEC-87 16:09		SETMAI, SETMAL - Mail waiting

  1553				SUBTTL	SETMAI, SETMAL - Mail waiting
  1554
  1555	001216'	201500	777777	WAITCH:	MOVEI W,-1
  1556	001217'	324740	000000*		PJRST TTYUUO
  1557
  1558	001220'	201500	777776	GETTMC:	MOVEI W,-2
  1559	001221'	324740	001217*		PJRST TTYUUO
  1560
  1561	001222'	201500	777775	SETTMC:	MOVEI W,-3
  1562	001223'	324740	001221*		PJRST TTYUUO
  1563
  1564	001224'	201500	777774	REDNXT:	MOVEI W,-4
  1565	001225'	324740	001223*		PJRST TTYUUO
  1566
  1567	001226'	201500	777773	LEVDEF:	MOVEI W,-5
  1568	001227'	324740	001225*		PJRST TTYUUO
  1569
  1570	001230'	200302	001175*	SETMAI:	MOVE	T1,JBTLIC(J)
  1571	001231'	607300	100000		TLNN	T1,LICOPR	; require OP in process license
  1572	001232'	263040	000000		 POPJ	P,
  1573	001233'	256200	004737'		UMOVE	T1,(M)		; job number to set
  1574	001234'	333000	000006		SKIPLE	T1		; leq 0 illegal
  1575	001235'	301300	000726*		 CAIL	T1,JOBN		; geq JOBN illegal
  1576	001236'	263040	000000		  POPJ	P,
  1577	001237'	200346	000752*		MOVE	T2,JBTSTS(T1)
  1578	001240'	607340	000004		TLNN	T2,JLOG		; not logged in illegal
  1579	001241'	263040	000000		 POPJ	P,
  1580	001242'	515340	001000		HRLZI	T2,PVNMAI	; [new mail] bit in priv word
  1581	001243'	436346	000676*		IORM	T2,JBTPRV(T1)
  1582	001244'	350001	000000		AOS	(P)
  1583	001245'	263040	000000		POPJ	P,
  1584
  1585	001246'	200340	000000*	SETMAL:	MOVE T2,SYSPPN
  1586	001247'	201300	000000*		MOVEI T1,FNCDEL
  1587	001250'	201440	000077		MOVEI T4,077
  1588	001251'	260040	000000*		PUSHJ P,CHKPRJ		;SEE IF CAN WRITE ON THE MAILBOX
  1589	001252'	334000	000000		 SKIPA			;YES
  1590	001253'	263040	000000		  POPJ P,		;ERROR RETURN
  1591	001254'	256200	004737'		UMOVE T1,(M)		;GET ADDRESS FROM USER AREA.
  1592	001255'	540540	000006		HRR M,T1		;SET TO GET USER NAME
  1593	001256'	256200	004737'		UMOVE T1,(M)		;GET ARGUMENT FROM USER AREA.
  1594	001257'	200340	000006		MOVE T2,T1
  1595	001260'	541553	000001		HRRI M,1(M)		;INCREMENT POINTER TO USER AREA.
  1596	001261'	256200	004737'		UMOVE T1,(M)		;AND FETCH ARGUMENT.
  1597	001262'	200600	000000*		MOVE P1,HIGHJB
  1598	001263'	322340	001267'	NXMAL:	JUMPE T2,FNDMAL		;ALL USERS
  1599	001264'	316354	001203*		CAMN T2,JBTUNM(P1)
  1600	001265'	312314	001206*		CAME T1,JBTUN1(P1)
  1601	001266'	254000	001273'		JRST NOMAL		;NOT FOR HIM
  1602	001267'	261040	000006	FNDMAL:	PUSH P,T1
  1603	001270'	201300	010000		MOVEI T1,PVMAIL		; BIT TO SET IN PRIV WORD
  1604	001271'	436314	001243*		IORM T1,JBTPRV(P1)
  1605	001272'	262040	000006		POP P,T1
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 25-2
UUOCON.MAC	 4-DEC-87 16:09		SETMAI, SETMAL - Mail waiting

  1606	001273'	367600	001263'	NOMAL:	SOJG P1,NXMAL
  1607	001274'	263040	000000		POPJ P,
  1608
  1609				EXTERNAL FNCDEL,CHKPRJ
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 26
UUOCON.MAC	 4-DEC-87 16:09		SYSDVF (CALLI -24) - Get device info

  1610				SUBTTL	SYSDVF (CALLI -24) - Get device info
  1611
  1612				;Call:	MOVE	AC,[LEN,,ADR]
  1613				;	SYSDVF	AC,		;CALLI -24
  1614				;	  error return
  1615				;	success return
  1616				;ADR+0/	function (see SYDDSP)
  1617				;ADR+1/	previous device (zero to start at beginning of chain
  1618				;ADR+2/	BLOCK LEN-2	;DDB or buffer size is returned here
  1619				;ADR+3/			;First word of DDB or buffer is returned here
  1620
  1621	001275'	542300	000013	SYSDVF:	HRRM	T1,M		;RH of AC has address of block
  1622	001276'	554600	000006		HLRZ	P1,T1		;LH of AC has size of block
  1623	001277'	377000	000014		SOSG	P1		;Not counting function word
  1624	001300'	201600	000001		 MOVEI	P1,1		;Must be at least 2
  1625	001301'	256200	005010'		UMOVE	T3,(M)		;Get function code
  1626	001302'	550300	000010		HRRZ	T1,T3		;Watch out for sign bit set in code
  1627	001303'	301300	000011		CAIL	T1,SYDTBL	;Check if in range
  1628	001304'	263040	000000		 POPJ	P,
  1629	001305'	332006	001310'		SKIPE	SYDDSP(T1)	;Routing may be external
  1630	001306'	254026	001310'		 JRST	@SYDDSP(T1)
  1631	001307'	263040	000000		POPJ P,			;Function not implemented on this machine
  1632
  1633	001310'	000000	001321'	SYDDSP:	SYDNAM			;0  DDB by name (excluding TTY and DSK)
  1634	001311'	000000	001373'		SYDLOC			;1  DDB by location, all DDBs
  1635	001312'	000000	000000*		SYDUNI##		;2  Disk unit (in FILUUO)
  1636	001313'	000000	000000*		SYDSTR##		;3  Structure (in FILUUO)
  1637	001314'	000000	000000*		SYDFTA##		;4  FTA unit  (in FTASER on KI and KL)
  1638	001315'	000000	000000*		SYDTMX##		;5  MTA unit  (in MAGSER or F3TSER)
  1639	001316'	000000	001417'		SYDBUF			;6  Named buffer (new in P035/C04)
  1640	001317'	000000	001504'		SYDJBT			;7  GETTAB table (new in P035/C04)
  1641	001320'	000000	001522'		SYDSPY			;10 SPY/PEEK on block of memory (/C08)
  1642			000011	SYDTBL==.-SYDDSP
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 27
UUOCON.MAC	 4-DEC-87 16:09		SYSDVF (CALLI -24) - Get device info

  1643				;SYSDVF function 0 - DDB by name
  1644
  1645	001321'	541553	000001	SYDNAM:	HRRI	M,1(M)		;Increment pointer to user's area
  1646	001322'	256200	004737'		UMOVE	T1,(M)		;Pick up name of previous device
  1647	001323'	554240	000000*		HLRZ	U,DEVLST	;Start of DDB chain
  1648	001324'	205340	204010		MOVSI	T2,DVDSK!DVTTY!DVRMT	;Don't give info about these
  1649	001325'	322300	001340'		JUMPE	T1,SYDNM1	;Zero means asking for first device
  1650	001326'	616345	000004	SYDNM3:	TDNN	T2,DEVMOD(U)	;Excluded device?
  1651	001327'	312305	000000		CAME	T1,DEVNAM(U)	; or not there yet?
  1652	001330'	334000	000000		 SKIPA			;Yes, keep looking
  1653	001331'	254000	001335'		  JRST	SYDNM2		;Found where we left off last time
  1654	001332'	554245	000003		HLRZ	U,DEVSER(U)	;Point to next DDB
  1655	001333'	326240	001326'		JUMPN	U,SYDNM3	; if any
  1656	001334'	263040	000000		POPJ	P,		;Bad starting name, give error return
  1657
  1658	001335'	331000	000010	SYDNM2:	SKIPL	T3		;This device if 1B0 set
  1659	001336'	554245	000003		 HLRZ	U,DEVSER(U)	;First device after requested one
  1660	001337'	322240	001367'		JUMPE	U,SYDNM4	;Out of devices, store 0 and skip return
  1661	001340'	200345	000004	SYDNM1:	MOVE	T2,DEVMOD(U)	;Is is a good device?
  1662	001341'	603340	204010		TLNE	T2,DVTTY!DVDSK!DVRMT
  1663	001342'	254000	001335'		 JRST	SYDNM2		;No, skip it
  1664	001343'	250200	000005		EXCH	F,U		;For PJOBN
  1665	001344'	135100	000000*		LDB	J,PJOBN
  1666	001345'	250200	000005		EXCH	F,U
  1667	001346'	260040	003202'		PUSHJ	P,CHKSEG	;SEE IF CAN GET INFO ABOUT THIS JOB
  1668	001347'	254000	001335'		 JRST	SYDNM2		;NO, SAY NOTHING ABOUT DEVICE
  1669	001350'	200305	000000		MOVE	T1,DEVNAM(U)
  1670	001351'	256200	004774'		UMOVEM	T1,(M)		;Store name of device for next time
  1671	001352'	363600	001201*	SYDLC5:	SOJLE	P1,CPOPJ1	;DOES HE WANT ANY MORE?
  1672	001353'	541553	000001		HRRI	M,1(M)		;INCREMENT PTR TO USER'S AREA.
  1673	001354'	550305	000003		HRRZ	T1,DEVSER(U)
  1674	001355'	256006	000003		XCT	DVSIZ(T1)	;GET THE DDB SIZE
  1675					PFALL	SYDCOM		;Join common code
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 28
UUOCON.MAC	 4-DEC-87 16:09		SYSDVF (CALLI -24) - Get device info

  1676				;Here to return data to user.
  1677				;Source:      T1 has size of DDB, U has address of DDB
  1678				;Destination: P1 has # of words left, M has UADDR+2 (where count is returned)
  1679				;If P1 has 1, then only the count is stored.
  1680
  1681	001356'	256200	004774'	SYDCOM::UMOVEM	T1,(M)		;RETURN SIZE TO USER
  1682	001357'	303606	000001		CAILE	P1,1(T1)	;GET MIN OF REQUESTED AND AVAILABLE
  1683	001360'	201606	000001		 MOVEI	P1,1(T1)	;1(T1)SINCE WE SOJLE FIRST
  1684	001361'	363600	001352*	SYDNM5:	SOJLE	P1,CPOPJ1	;DONE
  1685	001362'	271540	000001		ADDI	M,1		;POINT TO FIRST WORD FOR DDB ETC
  1686	001363'	270600	000013		ADD	P1,M
  1687	001364'	504540	000005		HRL	M,U		;GET THE BLT SET UP
  1688	001365'	256200	005011'		XCTTU <BLT M,-1(P1)>	;GIVE TO USER
  1689	001366'	254000	001361*		JRST	CPOPJ1
  1690
  1691				;Here from SYDFTA,etc when at end of list
  1692
  1693	001367'	256200	005012'	SYDNM4::XCTBU  <SETZM (M)>	;End of DDB chain, zero to start over again
  1694	001370'	363600	001366*		SOJLE	P1,CPOPJ1	;Done if no room for data block
  1695	001371'	256200	005013'		XCTBU  <SETZM 1(M)>	;Zero first word (at ADR+3)
  1696	001372'	254000	001370*		JRST	CPOPJ1		;Skip return at end of chain
  1697
  1698				;SYSDVF function 1 - DDB by location, all DDBs
  1699
  1700	001373'	541553	000001	SYDLOC:	HRRI	M,1(M)		;INCREMENT PTR.
  1701	001374'	256200	004737'		UMOVE	T1,(M)		;AND GET NEXT ENTRY.
  1702	001375'	554240	001323*		HLRZ	U,DEVLST
  1703	001376'	322300	001407'		JUMPE	T1,SYDLC1
  1704	001377'	306305	000000	SYDLC3:	CAIN	T1,(U)
  1705	001400'	254000	001404'		 JRST	SYDLC2		;FOUND
  1706	001401'	554245	000003		HLRZ	U,DEVSER(U)
  1707	001402'	326240	001377'		JUMPN	U,SYDLC3
  1708	001403'	263040	000000		POPJ	P,		;NOT IN LIST (MAYBE DSK GONE AWAY)
  1709
  1710	001404'	331000	000010	SYDLC2:	SKIPL	T3		;This device if 1B0 set
  1711	001405'	554245	000003		 HLRZ	U,DEVSER(U)	;Else get next one
  1712	001406'	322240	001367'		JUMPE	U,SYDNM4
  1713	001407'	250200	000005	SYDLC1:	EXCH	F,U		;FOR PJOBN
  1714	001410'	135100	001344*		LDB	J,PJOBN
  1715	001411'	250200	000005		EXCH	F,U
  1716	001412'	260040	003202'		PUSHJ	P,CHKSEG
  1717	001413'	254000	001404'		  JRST	SYDLC2
  1718	001414'	256200	005014'		UMOVEM	U,(M)
  1719	001415'	254000	001352'		JRST	SYDLC5
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 29
UUOCON.MAC	 4-DEC-87 16:09		SYSDVF (CALLI -24) - Get device info

  1720				;SYSDVF function 6 - named buffer
  1721
  1722	001416'	000000	000000	SYDBF0:	0
  1723					.ELINK 2,SYDBF0		;Set up link (see SYDVF macro)
  1724				;The RH of SYDBF0 points to the start of a linked list.  The list format is:
  1725				;THIS: XWD -N,NEXT	;# of pairs, pointer to next
  1726				;      SIXBIT /NAME/	;Name of this part of the buffer
  1727				;      XWD SIZE,NAME	;Size and starting address
  1728				;      SIXBIT /NAM2/	;More pairs if buffer is in multiple parts
  1729				;      XWD SIZ2,NAM2	; ... (N in LH of THIS is count of pairs)
  1730
  1731	001417'	205300	240000	SYDBUF:	MOVSI	T1,LICSYS!LICSPY;Job must have SYSTAT license to see
  1732	001420'	616302	001230*		TDNN	T1,JBTLIC(J)	; any of these tables
  1733	001421'	263040	000000		  POPJ	P,		;Nope, give error return
  1734	001422'	541553	000001		HRRI	M,1(M)		;Increment pointer to user's area
  1735	001423'	256200	004737'		UMOVE	T1,(M)		;Pick up name of previous buffer
  1736	001424'	550240	001416'		HRRZ	U,SYDBF0	;Start of list
  1737	001425'	322240	001437'	SYDBF1:	JUMPE	U,SYDBF4	;Error return if name not found
  1738	001426'	510445	000000		HLLZ	T4,(U)		;Get minus number of pairs
  1739	001427'	541445	000001		HRRI	T4,1(U)		;Point to first
  1740	001430'	332000	000006	SYDBF2:	SKIPE	T1		;Zero matches first name
  1741	001431'	316311	000000		CAMN	T1,0(T4)	;Match name?
  1742	001432'	254000	001441'		 JRST	SYDBF5		;Found starting point
  1743	001433'	271440	000001	SYDBF3:	ADDI	T4,1		;No, skip SIZE,,ADDR
  1744	001434'	253440	001430'		AOBJN	T4,SYDBF2	;Try next name in this set
  1745	001435'	550245	000000		HRRZ	U,(U)		;Get pointer to next
  1746	001436'	254000	001425'		JRST	SYDBF1		;Try next set
  1747
  1748				;Here if current not found or no next one
  1749	001437'	322300	001367'	SYDBF4:	JUMPE	T1,SYDNM4	;Store zero if no next one
  1750	001440'	263040	000000		POPJ	P,		;Error return if this one not found
  1751
  1752	001441'	322300	001445'	SYDBF5:	JUMPE	T1,SYDBF6	;Use first one if user supplied zero
  1753	001442'	321400	001445'		JUMPL	T3,SYDBF6	;Use this one if 1B0 is set
  1754	001443'	201300	000000		MOVEI	T1,0		;Give us the next one
  1755	001444'	254000	001433'		JRST	SYDBF3		;Go find it
  1756
  1757	001445'	200311	000000	SYDBF6:	MOVE	T1,0(T4)	;Found it, get starting name
  1758	001446'	256200	004774'		UMOVEM	T1,(M)		;Store at UADDR+1
  1759	001447'	363600	001372*		SOJLE	P1,CPOPJ1	;Room for any more?
  1760	001450'	541553	000001		HRRI	M,1(M)		;Yes, point to UADDR+2
  1761	001451'	200240	000011		MOVE	U,T4		;Save pointer in U for SYDBF8
  1762	001452'	201400	000000		MOVEI	T3,0		;Accumulate count
  1763	001453'	554311	000001	SYDBF7:	HLRZ	T1,1(T4)	;Get size
  1764	001454'	271406	000002		ADDI	T3,2(T1)	;Include word for name and word for pointer
  1765	001455'	271440	000001		ADDI	T4,1
  1766	001456'	253440	001453'		AOBJN	T4,SYDBF7
  1767	001457'	256200	005015'		UMOVEM	T3,(M)		;Store total size in UADDR+2
  1768
  1769				;Loop thru and return all related buffers.  U has AOBJN pointer to descriptors
  1770				;P1 has # of words remaining, M points to previous returned word
  1771
  1772	001460'	363600	001447*	SYDBF8:	SOJLE	P1,CPOPJ1	;Room for any more?
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 29-2
UUOCON.MAC	 4-DEC-87 16:09		SYSDVF (CALLI -24) - Get device info

  1773	001461'	541553	000001		HRRI	M,1(M)		;Next word in
  1774	001462'	200305	000000		MOVE	T1,0(U)		; user's buffer
  1775	001463'	256200	004774'		UMOVEM	T1,(M)		; gets name
  1776	001464'	363600	001460*		SOJLE	P1,CPOPJ1
  1777	001465'	541553	000001		HRRI	M,1(M)		;Next word in
  1778	001466'	200305	000001		MOVE	T1,1(U)		; user's buffer
  1779	001467'	256200	004774'		UMOVEM	T1,(M)		; gets count,,addr
  1780	001470'	323600	001464*		JUMPLE	P1,CPOPJ1	;See if room for more
  1781	001471'	554305	000001		HLRZ	T1,1(U)		;Size of buffer
  1782	001472'	313300	000014		CAMLE	T1,P1		;Is user's argument block big enough?
  1783	001473'	200300	000014		 MOVE	T1,P1		;No, use smaller
  1784	001474'	514345	000001		HRLZ	T2,1(U)		;First source address
  1785	001475'	541353	000001		HRRI	T2,1(M)		;First destination address
  1786	001476'	270540	000006		ADD	M,T1		;Last destination address
  1787	001477'	256200	005016'		XCTTU <BLT T2,(M)>	;Copy to user
  1788	001500'	274600	000006		SUB	P1,T1		;Decrement word count
  1789	001501'	271240	000001		ADDI    U,1		;Go to next pair
  1790	001502'	253240	001460'		AOBJN	U,SYDBF8	; of descriptors
  1791	001503'	254000	001470*		JRST	CPOPJ1
  1792
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 30
UUOCON.MAC	 4-DEC-87 16:09		SYSDVF (CALLI -24) - Get device info

  1793				;SYSDVF function 7 - GETTAB table
  1794
  1795	001504'	205300	240000	SYDJBT:	MOVSI	T1,LICSYS!LICSPY;Job must have SYSTAT license to see
  1796	001505'	616302	001420*		TDNN	T1,JBTLIC(J)	; any of these tables
  1797	001506'	263040	000000		 POPJ	P,		;Nope, give error return
  1798	001507'	541553	000001		HRRI	M,1(M)		;Increment pointer to UADDR+1
  1799	001510'	256200	004737'		UMOVE	T1,(M)		;Pick up gettab table number
  1800	001511'	570340	000006		HRRE	T2,T1		;IN CASE NEGATIVE
  1801	001512'	271340	003345'		ADDI	T2,NUMTAB
  1802	001513'	307340	003517'		CAIG	T2,ENDGTB
  1803	001514'	305340	003266'		CAIGE	T2,MINTAB	;IS IT IN RANGE
  1804	001515'	263040	000000		 POPJ	P,		;YES. ERROR RETURN, AC UNCHANGED
  1805	001516'	200240	000007		MOVE	U,T2		;Get addr of table
  1806	001517'	363600	001503*		SOJLE	P1,CPOPJ1	;Continue if room to return count
  1807	001520'	541553	000001		HRRI	M,1(M)		;Point to UADDR+2
  1808				;	LDB	T1,SIZE.OF.TABLE  ;U has address
  1809				;	PJRST	SYDCOM
  1810				PRINTF (<[SYDJBT not fully implemented yet]>)
  1811	001521'	263040	000000		POPJ	P,		;Error return
  1812
  1813				;SYSDVF function 10 - GETTAB table
  1814
  1815	001522'	205300	200000	SYDSPY:	MOVSI	T1,LICSPY	;Job must have read-core license to see
  1816	001523'	616302	001505*		TDNN	T1,JBTLIC(J)	; any of these tables
  1817	001524'	263040	000000		 POPJ	P,		;Nope, give error return
  1818	001525'	541553	000001		HRRI	M,1(M)		;Increment pointer to UADDR+1
  1819	001526'	256200	005017'		UMOVE	U,(M)		;Get address (1B0 set for exec virtual address)
  1820	001527'	363600	001517*		SOJLE	P1,CPOPJ1	;Continue if room to return count
  1821	001530'	541553	000001		HRRI	M,1(M)		;Point to UADDR+2
  1822	001531'	550300	000014		HRRZ	T1,P1		;Size is what user asked for
  1823				;T1=size, U=mon.addr, P1=size, M=user.addr
  1824	001532'	321240	001356'		JUMPL	U,SYDCOM	;Return block if virtual address
  1825	001533'	201346	777777		MOVEI	T2,-1(T1)	;Physical address - calculate ending address
  1826	001534'	270340	000005		ADD	T2,U
  1827	001535'	305340	340000		CAIGE	T2,340000	;Is it part of the one-for-one area?
  1828	001536'	254000	001356'		 JRST	SYDCOM		;Yes, physical equals virtual
  1829				PRINTF (<[SYDSPY does not handle physical addresses above 340000]>)
  1830	001537'	254000	001356'		JRST	SYDCOM		;*HACK* (need to change map of %COW)
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 31
UUOCON.MAC	 4-DEC-87 16:09		SYSDVF (CALLI -24) - Get device info

  1831				;RETURN JOB NUMBER FOR THIS JOB
  1832
  1833	001540'	256200	005020'	JOBNO:	UMOVEM	J,(M)		;CALLI +30
  1834	001541'	263040	000000		POPJ	P,		;RETURN JOB NUMBER
  1835
  1836				;RETURN JOB RUNNING TIME IN MILLISECONDS
  1837
  1838	001542'	331000	000006	JOBTIM:	SKIPL	T1		;CALLI +27
  1839	001543'	303300	001235*		CAILE	T1,JOBN##
  1840	001544'	254000	002664'		 JRST	RTZER
  1841	001545'	336100	000006		SKIPN	J,T1		;GET JOB NUMBER DESIRED
  1842	001546'	200100	000750*		MOVE	J,JOB		;CURRENT JOB
  1843	001547'	260040	003202'		PUSHJ	P,CHKSEG	;SEE IF LEGAL
  1844	001550'	254000	002664'		 JRST	RTZER		;NO
  1845	001551'	260040	000000*		PUSHJ	P,TIMADJ	;READ CLOCK
  1846	001552'	260040	003606'		PUSHJ	P,CLKTRU	;GET TRU'S
  1847	001553'	256200	004774'		UMOVEM	T1,(M)		;MOVE INFO TO USER'S AREA.
  1848	001554'	263040	000000		POPJ	P,		;AND RETURN.
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 32
UUOCON.MAC	 4-DEC-87 16:09		SYSDVF (CALLI -24) - Get device info

  1849				;PEEK INTO MONITOR MUUO
  1850				;CALL	MOVEI	AC,<MONITOR ADDRESS>
  1851				;	CALL	AC,[SIXBIT .NPEEK.]
  1852				;IF AC BIT 0=1 DO VIRTUAL PEEK ELSE PHYSICAL
  1853
  1854					EXTERN MEMSIZ,UPSJOB
  1855
  1856	001555'	205340	200000	NPEEK:	MOVSI T2,LICSPY
  1857	001556'	616342	001523*		TDNN T2,JBTLIC(J)	;CAN HE DO IT?
  1858	001557'	263040	000000		POPJ P,			;NO. TAKE ERROR RETURN
  1859	001560'	321300	001566'		JUMPL T1,UPEEK1		;JUMP IF VIRTUAL PEEK DESIRED
  1860	001561'	260040	001616'		PUSHJ P,PEKCHK		;CHECK ADDRESS VALIDITY
  1861	001562'	263040	000000		 POPJ P,		;ADDRESS INVALID, ERROR RETURN
  1862	001563'	200306	000000*		MOVE	T1,%UPS(T1)
  1863	001564'	256200	004774'	UPEEK3:	UMOVEM T1,(M)		;MOVE TO USER'S AREA
  1864	001565'	254000	001527*		JRST CPOPJ1		;AND RETURN
  1865				IFCPU (KI),<
  1866				UPEEK1:	MAP T2,(T1)		;SEE IF ADDR IS READALBE WITHOUT FAULT
  1867					TRC T2,MAP.FL!MAP.M	;PG IS READABLE IF FL AND MUUO
  1868					TRNN T2,MAP.FL!MAP.M	;BOTH NOT SET
  1869					 POPJ P,		;PAGE NOT READABLE
  1870				>;END IFCPU (KI)
  1871				IFNCPU (KI),<
  1872	001566'	606300	777760	UPEEK1:	TRNN T1,-20		;CHECK IF ADDR POINTS TO AN AC
  1873	001567'	254000	001573'		 JRST UPEEK2		;AC POINTED TO, SO ADDR OK
  1874	001570'	257346	000000		MAP T2,(T1)		;SEE IF ADDR IS READABLE WITHOUT FAULT
  1875	001571'	607340	100000		TLNN T2,PFW.A		;READABLE IF PG IS ACCESSIBLE
  1876	001572'	263040	000000		 POPJ P,			;PAGE NOT READABLE
  1877				>;END IFNCPU (KI)
  1878	001573'	200306	000000	UPEEK2:	MOVE T1,(T1)		;FETCH REQUESTED WORD
  1879	001574'	254000	001564'		JRST UPEEK3		;FINISH UP
  1880
  1881				;OLD PEEK. SAME AS NPEEK EXCEPT RETURNS ZERO IF UNSUCCESSFUL
  1882				;AND HAS ONLY ONE RETURN POINT.
  1883
  1884	001575'	260040	001555'	UPEEK:	PUSHJ P,NPEEK		;ATTEMPT THE PEEK
  1885	001576'	254000	002664'		 JRST RTZER		;ERROR: RETURN 0
  1886	001577'	263040	000000		POPJ P,			;SUCCES
  1887
  1888				;POKE MUUO CALL
  1889				;MOVEI AC,D
  1890				;CAL AC,[SIXBIT /POKE/]
  1891				; D/  DATA TO STORE
  1892				; D+1/ LOC TO STORE INTO
  1893				;      WITH SIGN BIT=1 FOR VIRTUAL POKE, 0 FOR PHYSICAL
  1894
  1895	001600'	205340	400000	POKE:	MOVSI T2,LICWCR	;HAVE PRIV
  1896	001601'	616342	001556*		TDNN T2,JBTLIC(J)
  1897	001602'	263040	000000		 POPJ P,			;NO, ERROR RETURN
  1898	001603'	256200	005021'		UMOVE T4,(T1)		;GET VALUE TO POKE FROM USER
  1899	001604'	256200	005022'		UMOVE T1,1(T1)		;GET ADDRESS TO POKE AT
  1900	001605'	321300	001612'		JUMPL T1,POKE1		;JUMP IF VIRTUAL POKE DESIRED
  1901	001606'	260040	001616'		PUSHJ P,PEKCHK
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 32-2
UUOCON.MAC	 4-DEC-87 16:09		SYSDVF (CALLI -24) - Get device info

  1902	001607'	263040	000000		  POPJ P,
  1903	001610'	202446	001563*		MOVEM T4,%UPS(T1)
  1904	001611'	254000	001565*		JRST CPOPJ1
  1905
  1906	001612'	260040	001637'	POKE1:	PUSHJ P,POKCHK		;SEE IF VIRTUAL POKE LEGAL
  1907	001613'	263040	000000		  POPJ P,		;BAD ADDR, ERROR RETURN
  1908	001614'	202446	000000		MOVEM T4,(T1)		;POKE REQUESTED WORD
  1909	001615'	254000	001611*		JRST CPOPJ1		;AND RETURN
  1910
  1911	001616'	621300	400000	PEKCHK:	TLZ T1,400000	;CLEAR SIGN BIT
  1912	001617'	200140	000006		MOVE PG,T1	;GET ABSOLUTE ADDRESS
  1913	001620'	321140	000717*		JUMPL PG,CPOPJ	;BAD IF NEGATIVE
  1914	001621'	301140	000020		CAIL PG,20	;BAD IF IN AC'S (PHYSICAL ONLY)
  1915	001622'	311140	000000*		 CAML PG,MEMSIZ	;BAD IF NO MEMORY THERE
  1916	001623'	263040	000000		  POPJ P,	;ERROR RETURN - DON'T MAP IT
  1917	001624'	242140	777767		LSH PG,-11	;GET BLOCK NUMBER
  1918	001625'	135400	000000*		LDB T3,PGYNXM	;DOES BLOCK EXIST?
  1919	001626'	301140	000340		CAIL PG,340	;SKIP IF IN UNMAPPED AREA
  1920	001627'	326400	001620*		 JUMPN T3,CPOPJ	;NO. ERROR
  1921	001630'	660140	700000		TRO PG,PGE.P!PGE.A!PGE.W
  1922							;NO CACHE BIT, OR ELSE CAN DRAG AREA INTO CORE
  1923							;THAT SHOULD NOT BE CACHED!
  1924	001631'	200400	000000*		MOVE T3,EPYPSN	; From [EPTPTR(%UPS.N)]
  1925	001632'	137140	000010		DPB PG,T3
  1926	001633'	402000	000000*		SETZM UPSJOB		;NO REAL UPT MAPPED THRU HERE ANYMORE
  1927	001634'	701100	001610*		CLRPTO	%UPS		;SETUP UPS SLOT IN MAP TO POINT TO BLOCK
  1928	001635'	405300	000777		ANDI T1,777		;T1_OFFSET IN BLOCK
  1929	001636'	254000	001615*		JRST CPOPJ1	;EITHER WRITE OK OR READ OK
  1930
  1931				IFCPU (KI),<
  1932				POKCHK:	MAP T2,(T1)	;SEE IF ADDR IS WRITEABLE WITHOUT FAULT
  1933					TRNE T2,MAP.FL	;SKIP IF WRITEABLE
  1934					POPJ P,		;ERROR RETURN
  1935					JRST CPOPJ1	;SKIP RETURN
  1936				>;END IFCPU (KI)
  1937				IFNCPU (KI),<
  1938	001637'	606300	777760	POKCHK:	TRNN T1,-20	;CHECK IF ADDR POINTS TO AN AC
  1939	001640'	254000	001636*		JRST CPOPJ1	;AC POINTED TO, SO ADDR GOOD
  1940	001641'	257346	000000		MAP T2,(T1)	;SEE IF ADDR IS WRITEABLE WITHOUT FAULT
  1941	001642'	641340	140000		TLC T2,PFW.A!PFW.W	;PG IS WRITEABLE IF A & W BOTH NOT SET
  1942	001643'	603340	140000		TLNE T2,PFW.A!PFW.W	;SKIP IF WRITEALBE
  1943	001644'	263040	000000		POPJ P,		;ERROR RETURN
  1944	001645'	254000	001640*		JRST CPOPJ1	;SKIP RETURN
  1945				>;END IFNCPU (KI)
  1946				;BITPOK	UUO
  1947				;CALL:
  1948				;	MOVE AC,FOO
  1949				;	BITPOK AC,
  1950				;	  <ERROR>
  1951				;	<NORMAL>
  1952				;
  1953				;FOO:	<ADDRESS>
  1954				;	<ANDCAM WORD>
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 32-3
UUOCON.MAC	 4-DEC-87 16:09		SYSDVF (CALLI -24) - Get device info

  1955				;	<IORM WORD>
  1956				;
  1957				;WITH SIGN BIT OF <ADDRESS>=1 FOR VIRTUAL POKE, 0 FOR PHYSICAL
  1958
  1959				;ON SUCCESS, IF (RC) LICENSE, (AC):=OLD VALUE OF <ADDRESS>
  1960
  1961	001646'	205340	400000	BITPOK:	MOVSI T2,LICWCR		; CHECK FOR WC LICENSE
  1962	001647'	616342	001601*		TDNN T2,JBTLIC(J)
  1963	001650'	263040	000000		 POPJ P,
  1964	001651'	540440	000006		HRR T4,T1		; USER ADDRESS OF ARGUMENTS
  1965	001652'	256200	005023'		UMOVE T1,(T4)		; GET PHYS ADR FROM USER
  1966					JUMPL T1,[PUSHJ P,POKCHK	;SEE IF POKE LEGAL
  1967						   POPJ P,		;BAD ADDR, ERROR RETURN
  1968						  MOVE  T3,(T1)		;GET OLD VALUE TO RETURN
  1969	001653'	321300	005024'			  JRST  BITPK1]		;PROCEED
  1970	001654'	260040	001616'		PUSHJ P,PEKCHK		; SEE IF VALID
  1971	001655'	263040	000000		 POPJ P,		;  BAD ADR - ERROR RETURN
  1972	001656'	200406	001634*		MOVE T3,%UPS(T1)	; GET OLD VALUE TO RETURN
  1973	001657'	205340	200000	BITPK1:	MOVSI T2,LICSPY		; SEE IF WE SHOULD RETURN OLD VALUE
  1974	001660'	612342	001647*		TDNE T2,JBTLIC(J)
  1975	001661'	256200	005015'		 UMOVEM T3,(M)		;  RETURN OLD VALUE IN AC (IF RC LIC)
  1976	001662'	256200	005030'		UMOVE T2,1(T4)		; GET ANDCAM WORD FROM USER
  1977	001663'	256200	005031'		UMOVE T3,2(T4)		; GET IORM WORD FROM USER
  1978					JUMPL T1, [ANDCAM T2,(T1)	;CLEAR BITS AS NECESSARY
  1979						   IORM T3,(T1)		;SET BITS AS NECESSARY
  1980	001664'	321300	005032'			   JRST CPOPJ1]		;NORMAL RETURN
  1981	001665'	412346	001656*		ANDCAM T2,%UPS(T1)	; CLEAR BITS AS NECESSARY
  1982	001666'	436406	001665*		IORM T3,%UPS(T1)	; SET BITS AS NECESSARY
  1983	001667'	254000	001645*		JRST CPOPJ1
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 33
UUOCON.MAC	 4-DEC-87 16:09		SYSDVF (CALLI -24) - Get device info

  1984				;TRPSET UUO - SET USER IOT
  1985
  1986				;CALL	SETZ AC,	OR	SETO AC,
  1987				;	TRPSET AC,
  1988				;	  <NO WC LICENSE>
  1989				;	<OKAY>
  1990
  1991	001670'	205340	004000	UTRPST:	MOVSI T2,PC.UIO		; CLEAR IT ALWAYS
  1992	001671'	412341	777776		ANDCAM T2,PDNMUP(P)
  1993	001672'	205400	400000		MOVSI T3,LICWCR		; TEST WC LICENSE
  1994	001673'	616402	001660*		TDNN T3,JBTLIC(J)
  1995	001674'	263040	000000		  POPJ P,		; NO LIC - ERROR RETURN
  1996	001675'	322300	001667*		JUMPE T1,CPOPJ1		; WANTS IT OFF (ALREADY IS)
  1997	001676'	327300	001627*		JUMPG T1,CPOPJ		; CAN'T HAVE POSITIVE ARGUMENT
  1998	001677'	436341	777776		IORM T2,PDNMUP(P)	; SET U-IOT AND GO HOME
  1999	001700'	254000	001675*		JRST CPOPJ1
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 34
UUOCON.MAC	 4-DEC-87 16:09		Date/Time uuos

  2000				SUBTTL	Date/Time uuos
  2001
  2002				;Get universal date/time GMT
  2003				;	MOVE	ac,[%CNDTM]	;53,,11
  2004				;	GETTAB	ac,
  2005				;	  MOVEI	ac,0		;Always skips if after P034/P
  2006				;	MOVEM	ac,UDT		;Days since 18-Nov-1858,,fraction of a day
  2007				;				;Note: Day 0 (17-Nov-1858) was a Wednesday
  2008				;
  2009				;Get universal date/time local to the CTY
  2010				;	MOVE	ac,[%CNGMT]	;64,,11
  2011				;	GETTAB  ac,
  2012				;	  MOVEI	ac,0		;Always skips if after P034/P
  2013				;	ADD	ac,UDT		;Offset from GMT to CTY local time
  2014
  2015
  2016				;Return GMT in TYMSHARE format, T1/time, T2/date
  2017
  2018	001701'	200340	001205*	GETGMT::MOVE	T2,THSDAT##	;Day 0 was 1-Jan-1964
  2019	001702'	200300	000000*		MOVE	T1,TIME##	;Ticks since midnight
  2020	001703'	312340	001701*		CAME	T2,THSDAT##	;Watch out for midnight!
  2021	001704'	254000	001701'		 JRST	GETGMT
  2022	001705'	621300	400000		TLZ	T1,(1B0)	;Clear half-valid bit
  2023	001706'	263040	000000		POPJ	P,		;1B0 set in T2 if date has not been set
  2024
  2025				;Get the date in DEC format of (YEARS-1964)*12*31 + (MONTH-1)*31 + DAY-1
  2026				;	DATE	ac,		;CALLI +14
  2027				;	 <only return>
  2028
  2029	001707'	260040	001746'	DATEU:	PUSHJ	P,GETULT	;Get user local time and date in DEC format
  2030	001710'	403300	000007		  SETZB	T1,T2		;Date not set, return 1-Jan-1964
  2031	001711'	256200	004771'		UMOVEM	T2,(M)		;Days since 1-Jan-1964 in DEC format
  2032	001712'	263040	000000		POPJ	P,
  2033
  2034
  2035				;Get the time of day in jiffies since local midnight (60 jiffies per second)
  2036				;	TIMER	ac,		;CALLI +22
  2037				;	 <only return>
  2038
  2039	001713'	260040	001746'	TIMER:	PUSHJ	P,GETULT	;Get user local time and date in DEC format
  2040	001714'	403300	000007		  SETZB	T1,T2		;Date not set, return midnight
  2041	001715'	256200	004774'		UMOVEM	T1,(M)		;Jiffies since midnight local time
  2042	001716'	263040	000000		POPJ	P,
  2043
  2044
  2045				;Get the time of day in milliseconds since local midnight
  2046				;	MSTIME	ac,		;CALLI +23
  2047				;	 <only return>
  2048
  2049	001717'	260040	001746'	MSTIME:	PUSHJ	P,GETULT	;Get user local time and date in DEC format
  2050	001720'	403300	000007		  SETZB	T1,T2		;Date not set, return midnight
  2051	001721'	221300	001750		IMULI	T1,^D1000	;1000 milliseconds per second
  2052	001722'	230300	000000*		IDIV	T1,JFYSEC##	;Convert from JIFFIES*1000 to milliseconds
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 34-2
UUOCON.MAC	 4-DEC-87 16:09		Date/Time uuos

  2053	001723'	256200	004774'		UMOVEM	T1,(M)		;Milliseconds are correct for 50Hz and 60Hz
  2054	001724'	263040	000000		POPJ	P,
  2055
  2056
  2057				;Get elapsed time since 1/1/64 00:00 in seconds
  2058				;	MOVEI	ac,time-zone	;0 for user's local time zone
  2059				;	DAYTIM	ac,		;CALLI -143
  2060				;	 <only return>
  2061
  2062	001725'	260040	001701'	DAYUUO:	PUSHJ	P,GETGMT	;Get Tymshare date and time in T2 and T1
  2063	001726'	256200	005035'		UMOVE	P4,(M)		;Get desired time zone (6 bits)
  2064	001727'	660740	600000		TRO	P4,600000	;Request 1-word Tymshare seconds format
  2065	001730'	505740	400020		HRLI	P4,400020	; from GMT 2-word Tymshare format
  2066	001731'	260040	001751'		PUSHJ	P,DATCOM	;Convert the date
  2067	001732'	403300	000007		  SETZB	T1,T2		;Date not set
  2068	001733'	256200	004771'		UMOVEM	T2,(M)		;Return seconds since 1-Jan-1964 00:00
  2069	001734'	263040	000000		POPJ	P,
  2070
  2071				SUBTTL	DATUUO - Convert date formats
  2072
  2073				;	MOVEI	ac,LOC		;Point to 3-word block
  2074				;	DATUUO	ac,		;CALLI -55
  2075				;	  <error return>	;Negative dates not allowed
  2076				;	<success return>	;First 2 words of block modified
  2077				;
  2078				;LOC:	DATE		;Or SECONDS or DATE,,TIME or -1 for current time
  2079				;	TIME		;Jiffies since midnight (ignored on 1-word formats)
  2080				;	FROM,,TO	;See bits below
  2081
  2082
  2083	001735'	200540	000006	DATUUO:	MOVE	M,T1	;User's AC has address of 3-word block
  2084	001736'	256200	005036'		UMOVE	T1,1(M)	;Time
  2085	001737'	256200	005037'		UMOVE	T2,0(M)	;Date or date&time in 1 word
  2086	001740'	256200	005040'		UMOVE	P4,2(M)	;Use <400020,,0> to convert TYM-GMT to DEC-local
  2087	001741'	260040	001751'		PUSHJ	P,DATCOM
  2088	001742'	263040	000000		  POPJ	P,	;Negative dates other than -1 are not legal
  2089	001743'	256200	005041'		UMOVEM	T1,1(M)	;Time
  2090	001744'	256200	004771'		UMOVEM	T2,0(M)	;Date or date&time in 1 word
  2091	001745'	254000	001700*		JRST	CPOPJ1	;Success
  2092
  2093
  2094				;FROM and TO formats: 1B0=TYM format, 1B1=1-word/seconds, 1B2=1-word/halfwords
  2095				;	0000xx	DEC 2-word format;   (YR-64)*372+(MN-1)*31+(DY-1), tics
  2096				;	1000xx	DEC halfword format; days since 11/18/1858,,fraction of day
  2097				;	2000xx	DEC seconds format;  DECdays*86400 + seconds past midnight
  2098				;	4000xx	TYM 2-word format;   days since 1/1/64, tics since midnight
  2099				;	5000xx	TYM halfword format; days since 1/1/1964,,fraction of day
  2100				;	6000xx	TYM seconds format;  seconds since 1/1/64 00:00
  2101				;	    xx	Time zone code, 0 means user local time
  2102				;	    40	Subject to daylight savings, 50=PDT,51=MDT,52=CDT,53=EDT
  2103				;		20=GMT,21=Paris,31=Toyko,    10=PST,11=MST,12=CST,13=EST,14=AST
  2104
  2105				;Get user local time in T1 and date in DEC format in T2
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 34-3
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2106				;Error return if date has not been received from the supervisor yet
  2107
  2108	001746'	260040	001701'	GETULT::PUSHJ	P,GETGMT	;Get THSDAT and TIME
  2109	001747'	323340	001676*		JUMPLE	T2,CPOPJ	;Error return, date not set
  2110	001750'	205740	400020		MOVSI	P4,400020	;From GMT days to DEC format, user's time zone
  2111					PFALL	DATCOM		;Convert and skip return
  2112
  2113
  2114				;Subroutine DATCOM - convert date formats.
  2115				;  T1/time in tics since midnight GMT (2-word formats only)
  2116				;  T2/date or combined date and time
  2117				;  P4/conversion options
  2118				;  J/job number to get user's local time zone
  2119				;Uses T3 and T4
  2120
  2121
  2122	001751'	316340	005042'	DATCOM::CAMN	T2,[-1]		;If -1,
  2123	001752'	260040	001701'		 PUSHJ	P,GETGMT	; use current date/time
  2124	001753'	321340	001747*		JUMPL	T2,CPOPJ	;Other negative dates not legal
  2125	001754'	135400	000000*		LDB	T3,PVYTIM##	;Get user's time zone from JBTPRV(J)
  2126	001755'	336000	000010		SKIPN	T3
  2127	001756'	201400	000050		 MOVEI	T3,50		;If none, assume PDT
  2128	001757'	606740	000037		TRNN	P4,37
  2129	001760'	660750	000000		 TRO	P4,(T3)		;Set zones if not specified
  2130	001761'	607740	000037		TLNN	P4,37
  2131	001762'	661750	000000		 TLO	P4,(T3)
  2132
  2133	001763'	135400	005043'		LDB	T3,[POINT 3,P4,2] ;Get format code from LH
  2134	001764'	256010	002021'		XCT	DATCNV(T3)	;Convert to days in T2, ticks in T1
  2135
  2136				;1 day = 24 hours = 1440 minutes = 86400 seconds = 5184000 ticks (60 Hz)
  2137				;octal = 30       = 2640          250600          23615000 (23 bits)
  2138				;The date format in the RIB is 14 bits, from 1-Jan-1964 to 8-Nov-2008
  2139				; 2^14 = 16384 days = 44.85 years, 1964+44.85 = 2008.85 = 8-Nov-2008
  2140
  2141	001765'	261040	000007		PUSH	P,T2		;Save date on stack, jiffies in T1
  2142	001766'	230300	000000*		IDIV	T1,JFYHR##	;T1/hours, T2/ticks since start of hour
  2143	001767'	250341	000000		EXCH	T2,(P)		;T2/date, (P)/min-sec-jif
  2144	001770'	221340	000030		IMULI	T2,^D24		;Convert days to hours
  2145	001771'	270300	000007		ADD	T1,T2		;T1/hours since 1-Jan-1964
  2146	001772'	607740	000040		TLNN	P4,40		;"from" time subject to daylight savings?
  2147	001773'	254000	001776'		 JRST	NODST1		;No
  2148	001774'	260040	002177'		PUSHJ	P,DSTCHK	;Yes, was daylight savings in effect then?
  2149	001775'	275300	000001		  SUBI	T1,1		;Yes, convert "from" time to standard time
  2150	001776'	554340	000017	NODST1:	HLRZ	T2,P4
  2151	001777'	405340	000037		ANDI	T2,37		;Time zone of source
  2152	002000'	274300	000007		SUB	T1,T2		;Convert time to hours GMT
  2153	002001'	200340	000017		MOVE	T2,P4
  2154	002002'	405340	000037		ANDI	T2,37		;Time zone of destination
  2155	002003'	270300	000007		ADD	T1,T2		;Convert to new local standard time
  2156	002004'	606740	000040		TRNN	P4,40		;"to" time subject to daylight savings?
  2157	002005'	254000	002010'		 JRST	NODST2		;No
  2158	002006'	260040	002177'		PUSHJ	P,DSTCHK	;Yes, will daylight savings be in effect?
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 34-4
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2159	002007'	271300	000001		  ADDI	T1,1		;Yes
  2160	002010'	262040	000010	NODST2:	POP	P,T3		;T1/date, T3/tics
  2161	002011'	321300	001753*		JUMPL	T1,CPOPJ	;Error if negative hours
  2162	002012'	231300	000030		IDIVI	T1,^D24		;T1/days, T2/hours since midnight
  2163	002013'	220340	001766*		IMUL	T2,JFYHR##	;Convert hours to ticks
  2164	002014'	270340	000010		ADD	T2,T3		;Add ticks since start of hour
  2165	002015'	250300	000007		EXCH	T1,T2		;T1/tics, T2/date
  2166
  2167	002016'	135400	005044'		LDB	T3,[POINT 3,P4,18+2] ;Get format code from RH
  2168	002017'	256010	002102'		XCT	CNVDAT(T3)	;Convert from TYMSHARE format to other
  2169
  2170	002020'	254000	001745*		JRST	CPOPJ1		;Success
  2171
  2172				;Table to convert from input format to TYMSHARE format (T1/ticks, T2/days)
  2173
  2174	002021'	260040	002046'	DATCNV:	PUSHJ	P,DEC2YR	;0 Adjust T2, DEC 31*12 day year to 365 day year
  2175	002022'	260040	002035'		PUSHJ	P,UDT2YR	;1 Convert from UDT to TYM format
  2176	002023'	260040	002045'		PUSHJ	P,SEC2YR	;2 Divide by 86400 seconds and then DEC2YR
  2177	002024'	263040	000000		POPJ	P,		;3 Illegal
  2178	002025'	255000	000000		JFCL			;4 Already in TYM 2-word format
  2179	002026'	260040	002036'		PUSHJ	P,TDT2YR	;5 Convert from TDT to TYM format
  2180	002027'	260040	002031'		PUSHJ	P,SEC2JF	;6 Divide by 86400 seconds per day
  2181	002030'	263040	000000		POPJ	P,		;7 Illegal
  2182
  2183				;Convert to TYMSHARE format (date in T2, ticks in T1)
  2184
  2185	002031'	230340	005045'	SEC2JF:	IDIV	T2,[^D60*^D60*^D24];T2/date T3/secs
  2186	002032'	220400	001722*		IMUL	T3,JFYSEC##	;T2/date T3/tics
  2187	002033'	200300	000010		MOVE	T1,T3		;T1/tics T2/date
  2188	002034'	263040	000000		POPJ	P,
  2189
  2190	002035'	274340	000000*	UDT2YR:	SUB	T2,GMTUDT##	;Days since 1/1/64 in LH, fraction in RH
  2191	002036'	554300	000007	TDT2YR:	HLRZ	T1,T2		;Days in T1
  2192	002037'	550340	000007		HRRZ	T2,T2		;<fraction.of.day>*2^18 in T2
  2193	002040'	224340	000000*		MUL	T2,MIDNIT##	;T2&T3/tics*2^18
  2194	002041'	271400	400000		ADDI	T3,400000	;Round up to nearest tic
  2195	002042'	244340	000021		ASHC	T2,^D17		;T2/tics, T3/0  (only 17 bits in LH of T3)
  2196	002043'	250300	000007		EXCH	T1,T2		;T1/tics, T2/date
  2197	002044'	263040	000000		POPJ	P,
  2198
  2199	002045'	260040	002031'	SEC2YR:	PUSHJ	P,SEC2JF	;Split seconds in T2 to day in T2 and tic in T1
  2200	002046'	231340	000037	DEC2YR:	IDIVI	T2,^D31		;Convert DEC's 12*31 format to consecutive days
  2201	002047'	261040	000010		PUSH	P,T3		;T2/# of 31-day months, (P)/day-1
  2202	002050'	231340	000014		IDIVI	T2,^D12		;T2/year-1964, T3/month-1, (P)/day-1
  2203	002051'	200410	002065'		MOVE	T3,MONTB(T3)	;Day corresponding to the first of the month
  2204	002052'	602340	000003		TRNE	T2,3		;Is it a non-leap year?
  2205	002053'	305400	000074		CAIGE	T3,^D60		;And after Feb 28th?
  2206	002054'	334000	000000		 SKIPA			;No
  2207	002055'	275400	000001		  SUBI	T3,1		;Yes, compensate for missing Feb 29th
  2208	002056'	272401	000000		ADDM	T3,(P)		;(P)/days since start of year
  2209	002057'	201407	000003		MOVEI	T3,3(T2)	;Year (rounded up)
  2210	002060'	242400	777776		LSH	T3,-2		;Divide by 4 to get # of leap days since 1964
  2211	002061'	221340	000555		IMULI	T2,^D365	;Convert years to days
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 34-5
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2212	002062'	270340	000010		ADD	T2,T3		;Add in leap days
  2213	002063'	272341	000000		ADDM	T2,(P)		;Add in day of year
  2214	002064'	254000	000000*		JRST	T2POPJ		;T2 has consecutive days since 1-1-64, T1/ticks
  2215
  2216	002065'	000000	000000	MONTB:	DEC 0,31,60,91,121,152,182,213,244,274,305,335,366
	002066'	000000	000037
	002067'	000000	000074
	002070'	000000	000133
	002071'	000000	000171
	002072'	000000	000230
	002073'	000000	000266
	002074'	000000	000325
	002075'	000000	000364
	002076'	000000	000422
	002077'	000000	000461
	002100'	000000	000517
	002101'	000000	000556
  2217
  2218				;Table  to convert from TYMSHARE format (T1/ticks, T2/days) to desired format
  2219
  2220	002102'	260040	002154'	CNVDAT:	PUSHJ	P,YR2DEC	;0 Adjust T2, DEC 31*12 day year to 365 day year
  2221	002103'	260040	002112'		PUSHJ	P,YR2UDT	;1 Convert from TYM to UDT format
  2222	002104'	260040	002141'		PUSHJ	P,YR2SEC	;2 YR2DEC then multiply by 86400 seconds per day
  2223	002105'	263040	000000		POPJ	P,		;3 Illegal
  2224	002106'	255000	000000		JFCL			;4 User wants TYM 2-word format T2/date, T1/time
  2225	002107'	260040	002123'		PUSHJ	P,YR2TDT	;5 Convert from TYM to TDT format
  2226	002110'	260040	002142'		PUSHJ	P,JF2SEC	;6 Multiply by 86400 seconds per day
  2227	002111'	263040	000000		POPJ	P,		;7 Illegal
  2228
  2229				;Convert from TYMSHARE format (date in T2, ticks in T1)
  2230
  2231	002112'	260040	002123'	YR2UDT:	PUSHJ	P,YR2TDT	;First convert to UDT based on 1-Jan-1964
  2232	002113'	270340	002035*		ADD	T2,GMTUDT##	;Make LH days since 18-Nov-1858
  2233	002114'	263040	000000		POPJ	P,
  2234
  2235				;ADJUDT - Convert from TIME and THSDAT to universal date/time format
  2236
  2237	002115'	200300	001702*	ADJUDT::MOVE	T1,TIME##	;Get jiffies since midnite
  2238	002116'	200340	001703*		MOVE	T2,THSDAT##	;Days since 1-Jan-1964
  2239	002117'	260040	002123'		PUSHJ	P,YR2TDT	;Convert to days,,fraction (LSB=0.3296 seconds)
  2240	002120'	270340	002113*		ADD	T2,GMTUDT##	;Change reference date to 18-Nov-1858
  2241	002121'	202340	000000*		MOVEM	T2,DATE##	;Set UDT (GETTAB item 53 in table 11 = %CNDTM)
  2242	002122'	263040	000000		POPJ	P,		;Return with UDT in T2
  2243
  2244	002123'	400400	000000	YR2TDT:	SETZ	T3,		;Convert to UDT based on 1-Jan-1964
  2245	002124'	261040	000011		PUSH	P,T4		;T1/ticks, T2/TYM date, uses T3, preserves T4
  2246	002125'	200440	000006		MOVE	T4,T1		;Jiffies since midnight
  2247	002126'	244400	000022		ASHC	T3,^D18		;T3&T4/ jiffies * 2^18
  2248	002127'	200300	002040*		MOVE	T1,MIDNIT##	;Ticks per day
  2249	002130'	234400	000006		DIV	T3,T1		;T3/ fraction.of.a.day * 2^18, T4/remainder
  2250	002131'	242300	777777		LSH	T1,-1		;Half if a UDT increment
  2251	002132'	311440	000006		CAML	T4,T1		;More than halfway to next 0.32959 second?
  2252	002133'	271400	000001		 ADDI	T3,1		;Yes, round up
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 34-6
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2253	002134'	514340	000007		HRLZ	T2,T2		;Days since 1-JAN-1964 in LH
  2254	002135'	270340	000010		ADD	T2,T3		;T2/ days,,fraction
  2255	002136'	400300	000000		SETZ	T1,		;T1/ 0
  2256	002137'	262040	000011		POP	P,T4
  2257	002140'	263040	000000		POPJ	P,
  2258
  2259	002141'	260040	002154'	YR2SEC:	PUSHJ	P,YR2DEC	;First convert to DEC format
  2260	002142'	220340	005045'	JF2SEC:	IMUL	T2,[^D60*^D60*^D24];T2/seconds (for full days) T1/tics
  2261	002143'	261040	000007		PUSH	P,T2		;Save from IDIV
  2262	002144'	200400	002032*		MOVE	T3,JFYSEC##	;Jiffies per second
  2263	002145'	230300	000010		IDIV	T1,T3		;T1/secs T2/fraction.of.a.second
  2264	002146'	242400	777777		LSH	T3,-1		;Jiffies per half second
  2265	002147'	311340	000010		CAML	T2,T3		;More than half way into the next second?
  2266	002150'	271300	000001		 ADDI	T1,1		;Yes, round up
  2267	002151'	272301	000000		ADDM	T1,(P)		;seconds since 1/1/64 00:00
  2268	002152'	400300	000000		SETZ	T1,
  2269	002153'	254000	002064*		JRST	T2POPJ		;T2/seconds, T1/0
  2270
  2271	002154'	231340	002665	YR2DEC:	IDIVI	T2,^D<365*4+1>	;Convert to DEC's 12*31 format (ticks in T1)
  2272	002155'	221340	000004		IMULI	T2,4		;T2/years, T3/days into leap-year cycle
  2273	002156'	307400	000556		CAIG	T3,^D366	;In the leap year?
  2274	002157'	254000	002166'		 JRST	YR2DC1		;Yes, MONTB is correct, T2 has right year
  2275	002160'	275400	000001		SUBI	T3,1		;Account for day #59 being a leap day
  2276	002161'	231400	000555		IDIVI	T3,^D365	;T3/1..3, T4/day in year
  2277	002162'	270340	000010		ADD	T2,T3		;Combine years
  2278	002163'	301440	000073		CAIL	T4,^D59		;After 28-Feb?
  2279	002164'	271440	000001		 ADDI	T4,1		;Adjust since 29-Feb does not exist this year
  2280	002165'	200400	000011		MOVE	T3,T4		;Get day in year
  2281	002166'	201440	000001	YR2DC1:	MOVEI	T4,1		;T2/year, T3/day
  2282	002167'	311411	002065'		CAML	T3,MONTB(T4)	;Check month table
  2283	002170'	344440	002167'		 AOJA	T4,.-1
  2284	002171'	274411	002064'		SUB	T3,MONTB-1(T4)	;Days-1 in T3, months in T4
  2285	002172'	221340	000014		IMULI	T2,^D12		;Years-64*12
  2286	002173'	271351	777777		ADDI	T2,-1(T4)	;+months-1
  2287	002174'	221340	000037		IMULI	T2,^D31		;*31
  2288	002175'	270340	000010		ADD	T2,T3		;+days-1
  2289	002176'	263040	000000		POPJ	P,		;T2/day-1+<mon-1>*31+<year-1964>*31*12, T1/tics
  2290
  2291				;DSTCHK - CHECK TO SEE IF TIME IN DAYLIGHT SAVING RANGE
  2292				;CALL:
  2293				;	MOVEI T1,HOURS SINCE 1-JAN-64
  2294				;	PUSHJ P,DSTCHK		;Uses T3, preserves T2
  2295				;	 <YES-DST IN EFFECT>
  2296				;	<NO---DST NOT IN EFFECT>
  2297				;
  2298	002177'	205400	777723	DSTCHK::MOVSI	T3,-DLTLEN	;Search entire DAYLIGHT SAVINGS table
  2299	002200'	315310	002207'	DSTCK1:	CAMGE	T1,DLTTAB(T3)	;IS IT AFTER START TIME
  2300	002201'	254000	002020*		 JRST	CPOPJ1		;NO, NOT DAYLIGHT SAVINGS
  2301	002202'	315310	002210'		CAMGE	T1,DLTTAB+1(T3)	;AFTER END?
  2302	002203'	263040	000000		 POPJ	P,		;NO, IN CORRECT RANGE
  2303	002204'	271400	000001		ADDI	T3,1		;GET NEXT PAIR IN TABLE
  2304	002205'	253400	002200'		AOBJN	T3,DSTCK1
  2305	002206'	254000	002201*		JRST	CPOPJ1		;OUT OF TABLE, ASSUME NOT D.S.T
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 34-7
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2306
  2307				;TABLE FOR DAYLIGHT SAVINGS TIME. ENTRIES ARE IN PAIRS
  2308				;FIRST IS START, SECOND END. NUMBER IS HOURS SINCE JAN 1,1964
  2309				;Start is at 2:00am standard time (which jumps forward to 3:00am daylight time)
  2310				;  End is at 1:00am standard time (jumped back to from 2:00am daylight time)
  2311
  2312	002207'	000000	005342	DLTTAB:	OCT    5342,  15761	;APR 26-OCT 25 1964
	002210'	000000	015761
  2313	002211'	000000	026402		OCT   26402,  37271	;APR 25-OCT 31 1965
	002212'	000000	037271
  2314	002213'	000000	047442		OCT   47442,  60331	;APR 24-OCT 30 1966
	002214'	000000	060331
  2315	002215'	000000	070752		OCT   70752, 101371	;APR 30-OCT 29 1967
	002216'	000000	101371
  2316	002217'	000000	112012		OCT  112012, 122431	;APR 28-OCT 27 1968
	002220'	000000	122431
  2317	002221'	000000	133052		OCT  133052, 143471	;APR 27-OCT 26 1969
	002222'	000000	143471
  2318	002223'	000000	154112		OCT  154112, 164531	;APR 26-OCT 25 1970
	002224'	000000	164531
  2319	002225'	000000	175152		OCT  175152, 206041	;APR 25-OCT 31 1971
	002226'	000000	206041
  2320	002227'	000000	216462		OCT  216462, 227101	;APR 30-COT 29 1972
	002230'	000000	227101
  2321	002231'	000000	237522		OCT  237522, 250141	;APR 29-OCT 28 1973
	002232'	000000	250141
  2322	002233'	000000	253362		OCT  253362, 271201	;JAN  6-OCT 27 1974 (Started early in 74)
	002234'	000000	271201
  2323	002235'	000000	276652		OCT  276652, 312241	;FEB 23-OCT 26 1975
	002236'	000000	312241
  2324	002237'	000000	322662		OCT  322662, 333551	;APR 25-OCT 31 1976
	002240'	000000	333551
  2325	002241'	000000	343722		OCT  343722, 354611	;APR 24-OCT 30 1977
	002242'	000000	354611
  2326	002243'	000000	365232		OCT  365232, 375651	;APR 30-OCT 29 1978
	002244'	000000	375651
  2327	002245'	000000	406272		OCT  406272, 416711	;APR 29-OCT 28 1979
	002246'	000000	416711
  2328	002247'	000000	427332		OCT  427332, 437751	;APR 27-OCT 26 1980
	002250'	000000	437751
  2329	002251'	000000	450372		OCT  450372, 461011	;APR 26-OCT 25 1981
	002252'	000000	461011
  2330
  2331					;     United States; France (Central European Summer time)
  2332	002253'	000000	471432		OCT  471432, 502321;  470220, 500612	;APR 25-OCT 31 1982
	002254'	000000	502321
  2333	002255'	000000	512472		OCT  512472, 523361;  511231, 521653	;APR 24-OCT 30 1983
	002256'	000000	523361
  2334	002257'	000000	534002		OCT  534002, 544421;  532272, 542712	;APR 29-OCT 28 1984
	002260'	000000	544421
  2335	002261'	000000	555042		OCT  555042, 565461;  553603, 563752	;APR 28-OCT 27 1985
	002262'	000000	565461
  2336
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 34-8
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2337			000770		%3W=^D<3*7*24>	;# of hours in 3 weeks
  2338	002263'	000000	576102		OCT  576102, 606521	;APR 27-OCT 26 1986
	002264'	000000	606521
  2339	002265'	000000	616152		OCT  617142-%3W, 627561	;APR  5-OCT 25 1987 Congress redefined it
	002266'	000000	627561
  2340	002267'	000000	637212		OCT  640202-%3W, 651071	;APR  3-OCT 30 1988
	002270'	000000	651071
  2341	002271'	000000	660522		OCT  661512-%3W, 672131	;APR  9-OCT 29 1989
	002272'	000000	672131
  2342	002273'	000000	701562		OCT  702552-%3W, 713171	;APR  8-OCT 28 1990
	002274'	000000	713171
  2343	002275'	000000	722622		OCT  723612-%3W, 734231	;APR  7-OCT 27 1991
	002276'	000000	734231
  2344	002277'	000000	743662		OCT  744652-%3W, 755271	;APR  5-OCT 25 1992
	002300'	000000	755271
  2345	002301'	000000	764722		OCT  765712-%3W, 776601	;APR  4-OCT 31 1993
	002302'	000000	776601
  2346	002303'	000001	005762		OCT 1006752-%3W,1017641	;APR  3-OCT 30 1994
	002304'	000001	017641
  2347	002305'	000001	027272		OCT 1030262-%3W,1040701	;APR  9-OCT 29 1995
	002306'	000001	040701
  2348	002307'	000001	050332		OCT 1051322-%3W,1061741	;APR  7-OCT 27 1996
	002310'	000001	061741
  2349	002311'	000001	071372		OCT 1072362-%3W,1103001	;APR  6-OCT 26 1997
	002312'	000001	103001
  2350	002313'	000001	112432		OCT 1113422-%3W,1124041	;APR  5-OCT 25 1998
	002314'	000001	124041
  2351	002315'	000001	133472		OCT 1134462-%3W,1145351	;APR  4-OCT 31 1999
	002316'	000001	145351
  2352	002317'	000001	155002		OCT 1155772-%3W,1166411	;APR  9-OCT 29 2000
	002320'	000001	166411
  2353	002321'	000001	176042		OCT 1177032-%3W,1207451	;APR  8-OCT 28 2001
	002322'	000001	207451
  2354	002323'	000001	217102		OCT 1220072-%3W,1230511	;APR  7-OCT 27 2002
	002324'	000001	230511
  2355	002325'	000001	240142		OCT 1241132-%3W,1251551	;APR  6-OCT 26 2003
	002326'	000001	251551
  2356	002327'	000001	261202		OCT 1262172-%3W,1273061	;APR  4-OCT 31 2004
	002330'	000001	273061
  2357	002331'	000001	302242		OCT 1303232-%3W,1314121	;APR  3-OCT 30 2005
	002332'	000001	314121
  2358	002333'	000001	323552		OCT 1324542-%3W,1335161	;APR  9-OCT 29 2006
	002334'	000001	335161
  2359	002335'	000001	344612		OCT 1345602-%3W,1356221	;APR  8-OCT 28 2007
	002336'	000001	356221
  2360	002337'	000001	365652		OCT 1366642-%3W,1377261	;APR  6-OCT 26 2008 (Last DAYLIGHT SAVINGS time)
	002340'	000001	377261
  2361			000055	DLTLEN==<.-DLTTAB>/2		;1377777 = 8-Nov-2008
  2362
  2363				;NOTE: The field which counts the number of days since 1-Jan-1964 will exceed
  2364				;      14 bits on November 8th, 2008.  On that date, TYMCOM-X will die.
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 35
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2365				;SETUUO SET VARIOUS THINGS
  2366
  2367	002341'	554340	000006	SETUUO:	HLRZ	T2,T1		;Get argument number
  2368	002342'	301340	000015		CAIL	T2,SUUNUM	;(argument value is in RH of T1)
  2369	002343'	263040	000000		 POPJ	P,		;Too large
  2370	002344'	510407	002356'		HLLZ	T3,SUUTAB(T2)	;Get license needed to do this operation
  2371	002345'	322400	002354'		JUMPE	T3,SETUU1	;Jump if none required
  2372	002346'	612402	001673*		TDNE	T3,JBTLIC(J)	;If it has any of these licenses
  2373	002347'	254000	002354'		 JRST	SETUU1		;Go to it
  2374	002350'	326340	002011*		JUMPN	T2,CPOPJ	;Return if not OPRSND
  2375	002351'	200402	000000*		MOVE	T3,JBTFPN(J)	;Find program's source PPN
  2376	002352'	312400	001246*		CAME	T3,SYSPPN	;Always let SYS programs type on CTY
  2377	002353'	263040	000000		 POPJ	P,		;Not from (SYS), error out
  2378	002354'	550347	002356'	SETUU1:	HRRZ 	T2,SUUTAB(T2)	;Dispatch
  2379	002355'	254007	000000		JRST 	(T2)
  2380
  2381	002356'	100000	000000*	SUUTAB:	       LICOPR,,OPRSND##	;(0) SEND TO OPR/CTY
  2382	002357'	100000	002505'		       LICOPR,,SCHSET	;(1) SCHEDULE
  2383	002360'	000000	000000*			    0,,INISET##	;(2) INIT2 FUNCTION
  2384	002361'	101000	002410'		LICOPR!LICJAL,,TIMSET	;(3) SET TIME
  2385	002362'	101000	002373'		LICOPR!LICJAL,,DATSET	;(4) SET DATE
  2386	002363'	101000	002511'		LICOPR!LICJAL,,OPRSET	;(5) SET OPR
  2387	002364'	000000	002516'			    0,,SETWTC	;(6) SET WATCH
  2388	002365'	001000	002522'		       LICJAL,,SCSPRV	;(7) SET OR CLEAR SCHPRV
  2389	002366'	000000	002530'			    0,,SETTLK	;(10) TALK TO JOB'S CMND PORT
  2390	002367'	700000	002547'	 LICSPY!LICOPR!LICWCR,,BTCMD	;(11) READ/WRITE BOOTS CMND STRING
  2391	002370'	700000	002604'	 LICSPY!LICOPR!LICWCR,,REST	;(12) READ/WRITE RESTART BITS
  2392	002371'	100000	002615'		       LICOPR,,INASET	;(13) SET DEFAULT INACTIVITY LIMIT
  2393	002372'	100000	002624'		       LICOPR,,KSYSET	;(14) SET KSYS
  2394			000015	SUUNUM==.-SUUTAB
  2395
  2396				;SET DATE (SETUUO function 4) - do this immediately.
  2397				;Do not output message to CTY until the time has also been changed.
  2398
  2399	002373'	550340	000006	DATSET:	HRRZ	T2,T1		;Set date UUO
  2400	002374'	261040	000007	COMDAS::PUSH	P,T2		;SET DATE command
  2401	002375'	260040	001746'		PUSHJ	P,GETULT	;Get user local time and date in DEC format
  2402	002376'	201300	000000		  MOVEI	T1,0		;If date/time not set, use midnite local time
  2403	002377'	262040	000007		POP	P,T2		;Recover date (in DEC format)
  2404	002400'	201740	400020		MOVEI	P4,400020	;Convert from DEC to GMT days
  2405	002401'	260040	001751'		PUSHJ	P,DATCOM
  2406	002402'	263040	000000		  POPJ	P,		;Invalid date
  2407	002403'	337000	002116*		SKIPG	THSDAT##	;If date was not previously set,
  2408	002404'	661300	400000		 TLO	T1,(1B0)	; flag the time as being not valid
  2409	002405'	202300	002115*		MOVEM	T1,TIME##	;Update time
  2410	002406'	202340	002403*		MOVEM	T2,THSDAT##	;Set new date
  2411	002407'	254000	002206*		JRST	CPOPJ1		;Wait for LOGINN to set the time via UUO
  2412
  2413				;SET TIME (SETUUO function 3) - set DTMADJ and adjust clock gradually.
  2414				;Output message to CTY at start and at end of adjustment.
  2415
  2416	002410'	553000	000006	TIMSET:	HRRZS	T1		;Set time UUO
  2417	002411'	220300	000000*	COMTMS::IMUL	T1,JFYMIN##	;SET TIME command
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 35-2
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2418	002412'	261040	000006		PUSH	P,T1		;T1 has time in jiffies
  2419	002413'	260040	001746'		PUSHJ	P,GETULT	;Get user local time and date in DEC format
  2420	002414'	254000	000744*		  JRST	TPOPJ		;Must set date before time can be set
  2421	002415'	262040	000006		POP	P,T1		;T2 has date in DEC format, get new time
  2422	002416'	201740	400020		MOVEI	P4,400020	;From user to GMT ticks
  2423	002417'	260040	001751'		PUSHJ	P,DATCOM	;Convert, watching for daylight savings
  2424	002420'	263040	000000		  POPJ	P,		;Should not happen, GETULT checked already
  2425	002421'	350001	000000		AOS	(P)		;Set for skip return
  2426					PFALL	COMGMS		;Date in T2, new time in T1
  2427
  2428				;Here from SCNSER when we get GMT time from the supervisor
  2429				;T2 has days since 1-Jan-64, T1 has jiffies since midnight
  2430				;Uses T1-T4, preserves all others (SCNSER depends on P4)
  2431
  2432	002422'	402000	000000*	COMGMS::SETZM	DTMADJ##	;Cancel any previous fix-up
  2433	002423'	331000	002406*		SKIPL	THSDAT##	;If date has not been set yet
  2434	002424'	335000	002405*		SKIPGE	TIME##		; or date set but time has not
  2435	002425'	254000	002475'		 JRST	COMGM2		;Change it now, do not output TIMEOK
  2436	002426'	200400	000007		MOVE	T3,T2		;Copy date
  2437	002427'	274400	002423*		SUB	T3,THSDAT##	;# of days difference
  2438	002430'	221400	250600		IMULI	T3,^D<24*60*60>	;Days to seconds
  2439	002431'	270400	000006		ADD	T3,T1		;New ticks
  2440	002432'	274400	002424*		SUB	T3,TIME##	;# of ticks difference
  2441	002433'	202400	002422*		MOVEM	T3,DTMADJ##	;Tell CLOCK1 to speed up or slow down the clock
  2442	002434'	217000	000010		MOVMS	T3		;Get absolute value
  2443	002435'	230400	002411*		IDIV	T3,JFYMIN##	;Number of minutes (destroys T4)
  2444	002436'	303400	000074		CAILE	T3,^D60		;If more than one hour
  2445	002437'	254000	002465'		 JRST	COMGM1		; make the change immediately
  2446	002440'	332000	000010		SKIPE	T3		;No EVENT if less than 1 full minute
  2447	002441'	256000	005046'	TIMEOK:	 STOPCD (.,EVENT,TIMEOK,COMGM0,<Date/time has been changed>)
  2448	002442'	263040	000000		POPJ	P,		;CLOCK1 will call OPRDTM when DTMADJ goes to 0
  2449
  2450	002443'	260040	000000*	COMGM0:	PUSHJ	P,INLMES##	;The EVENT stopcode outputs the old time
  2451	002444'	523235	562500		 ASCIZ /Time of day is being adjusted by /
	002445'	677144	062302
	002446'	745015	171500
	002447'	613135	167316
	002450'	203034	465352
	002451'	717514	562100
	002452'	613624	000000
  2452	002453'	200300	002433*		MOVE	T1,DTMADJ##
  2453	002454'	230300	002144*		IDIV	T1,JFYSEC##
  2454	002455'	311300	005052'		CAML	T1,[-^D300]	;If more than 5 minutes
  2455	002456'	303300	000454		CAILE	T1,^D300
  2456					 JRST	[IDIVI	T1,^D60	  ;Report minutes
  2457						PUSHJ	P,PRTDEC##
  2458						PUSHJ	P,INLMES##
  2459						 ASCIZ / minutes./
  2460	002457'	254000	005053'			POPJ	P,]
  2461	002460'	260040	000000*		PUSHJ	P,PRTDEC##	;Output signed decimal number
  2462	002461'	260040	002443*		PUSHJ	P,INLMES##
  2463	002462'	203474	561736		 ASCIZ / seconds./	;CRLF provided by stopcode output
	002463'	673116	327000
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 35-3
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2464	002464'	263040	000000		POPJ	P,		;End of TIMEOK event stopcode
  2465
  2466
  2467				;Adjustment is more than 1 hour, do it now
  2468
  2469	002465'	202300	002432*	COMGM1:	MOVEM	T1,TIME##	;Set the new time now
  2470	002466'	202340	002427*		MOVEM	T2,THSDAT##	;and date
  2471	002467'	256000	002441'		 STOPCD (,XCT,TIMEOK)
  2472					;Tell OPR what the old date/time was
  2473	002470'	402000	002453*		SETZM	DTMADJ##	;Cancel slow adjustment
  2474	002471'	201300	400000		MOVEI	T1,400000
  2475	002472'	436300	000000*		IORM	T1,STATES##	;SHUT the system
  2476	002473'	476000	000000*		SETOM	CTYBLF##	;Ding the bell
  2477	002474'	254000	002502'		JRST	COMGM3		;Tell OPR what the new date/time is
  2478
  2479				;Here when date hasn't been set yet
  2480
  2481	002475'	202300	002465*	COMGM2:	MOVEM	T1,TIME##	;Set the new time now
  2482	002476'	202340	002466*		MOVEM	T2,THSDAT##	;and date
  2483	002477'	260040	002115'		PUSHJ	P,ADJUDT	;Set universal date/time, return it in T2
  2484	002500'	337000	000000*		SKIPG	SYSUDT##	;This starts at -1.  If not set yet,
  2485	002501'	202340	002500*		 MOVEM	T2,SYSUDT##	;Store UDT of when system came up
  2486	002502'	260040	000000*	COMGM3:	PUSHJ	P,FIXWEK##	;Set GMTDIF and LOCWEK
  2487	002503'	260040	000000*		PUSHJ	P,UDTFIX##	;Fix LOCSEC,LOCMIN,LOCHOR,LOCDAY,LOCMON,LOCYER
  2488	002504'	324740	000000*		PJRST	OPRDTM##	;Tell OPR about the new date/time
  2489
  2490
  2491				;SET SCHED (SETUUO function 1)
  2492
  2493	002505'	332000	000000*	SCHSET:	SKIPE	DWNFLG##
  2494	002506'	263040	000000		 POPJ	P,		;IN PROCESS OF HANGUP, CAN NOT SET
  2495	002507'	550340	000006		HRRZ	T2,T1
  2496	002510'	324740	000000*		PJRST	SKDCOM##
  2497
  2498				;SET OPR (SETUUO function 5)
  2499
  2500	002511'	260040	000000*	OPRSET:	PUSHJ	P,TTYFNU
  2501	002512'	322240	002350*		JUMPE	U,CPOPJ		;NO TTY
  2502	002513'	200300	000004		MOVE	T1,F
  2503	002514'	350001	000000		AOS	(P)		;GIVE SKIP RETURN
  2504	002515'	254000	000000*		JRST	COMSOP##	;COMMON SET OPR IN COMCON
  2505
  2506				;SET WATCH (SETUUO function 6)
  2507
  2508	002516'	405300	376000	SETWTC:	ANDI	T1,WCHALL
  2509	002517'	517000	000006		HRLZS	T1
  2510	002520'	436302	000000*		IORM	T1,JBTWCH(J)
  2511	002521'	254000	002407*		JRST	CPOPJ1
  2512
  2513				COMMENT ! FUNCTION 7: SET OR CLEAR SCHPRV
  2514				CALLED: MOVSI	AC,7
  2515					HRRI	AC,NONZERO TO SET SCHPRV, ELSE LEAVE 0 TO CLEAR
  2516					SETUUO	AC,
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 35-4
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2517					 ERROR, NOT LICENSED TO DO THIS
  2518					SUCCESS AC UNCHANGED
  2519				!
  2520
  2521				;SET SCHPRV (SETUUO function 7)
  2522
  2523	002522'	200342	001237*	SCSPRV:	MOVE	T2,JBTSTS(J)	;SET OR CLEAR SCHPRV
  2524	002523'	602300	777777		TRNE	T1,-1		;RH USER AC 0 IF WANTS CLEARED
  2525	002524'	664340	010000		 TROA	T2,SCHPRV
  2526	002525'	620340	010000		TRZ	T2,SCHPRV
  2527	002526'	202342	002522*		MOVEM	T2,JBTSTS(J)
  2528	002527'	254000	002521*		JRST	CPOPJ1
  2529
  2530				COMMENT	! .STTLK (10) -- TALK TO JOB'S COMMAND PORT
  2531
  2532					HRLI	AC, .STTLK
  2533					HRRI	AC, ADDR
  2534					SETUUO	AC,
  2535					  ERROR RETURN	;AC/ ERROR CODE (SEE SCNSER)
  2536					NORMAL RETURN	;COMPLETE MESSAGE SENT, AC UNCHANGED
  2537
  2538				ADDR:	COUNT,,JOB #		;JOB=0 TO TALK TO CTY
  2539					ILDB POINTER TO STRING, ASCIZ IF COUNT=0
  2540
  2541				!
  2542
  2543				;TALK (SETUUO function 10)
  2544
  2545	002530'	261040	000006	SETTLK:	PUSH	P,T1
  2546	002531'	256200	004746'		XCTFU	<MOVE T2,1(T1)>	;T2/ BYTE POINTER
  2547	002532'	256200	005061'		XCTFU	<MOVE T1,0(T1)>	;T1/ TALKEE JOB #
  2548	002533'	554440	000006		HLRZ	T4,T1		;T4/ Byte count, 0 means string is ASCIZ
  2549	002534'	553000	000006		HRRZS	T1		;Job number (zero for CTY)
  2550	002535'	260040	000000*		PUSHJ	P,STTLK##	;TRY TO TALK
  2551	002536'	254000	002540'		  JRST	.+2		;(FAILURE)
  2552	002537'	254000	000000*		 JRST	TPOPJ1		;(SUCCESS -- RESTORE ADDR)
  2553	002540'	262040	000010		POP	P,T3		;T3/ addr of two word block
  2554	002541'	256200	005062'		UMOVEM	T1,(W)		;Store error code in user's AC
  2555	002542'	302300	000000*		CAIE	T1,TKROM%##	;Error code for no room in TTY chunks?
  2556	002543'	263040	000000		 POPJ	P,		;No
  2557	002544'	256200	005063'		XCTTU	<MOVEM T2,1(T3)>;Update byte pointer
  2558	002545'	256200	005064'		XCTTU	<HRLM  T4,0(T3)>;Update byte count
  2559	002546'	263040	000000		POPJ	P,		;Error return from UUO
  2560
  2561				COMMENT !FUNCTION 11 (.BTSTR): READ/WRITE BOOTS COMMAND STRING
  2562
  2563					HRLI	AC,.BTSTR
  2564					HRRI	AC,<CONTROL WORD ADDR>
  2565					SETUUO	AC,
  2566					  ERROR RETURN		;LACKING LIC OR BAD STRING LENGTH
  2567					NORMAL RETURN
  2568
  2569				CONTROL WORD: BITS 18-35: ADDR OF SOURCE/DESTINATION ASCIZ STRING
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 35-5
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2570					      1B0=0 FOR READ -- REQUIRES RC, OP, OR WC
  2571					      1B0=1 FOR WRITE -- REQUIRES WC
  2572						    IF STRING IS TOO LONG IT WILL BE TRUNCATED
  2573						     AND THE ERROR RETURN TAKEN
  2574						    AN ADDR OF ZERO CLEARS COMMAND STRING
  2575					      IF CONTROL WORD ADDR IS ZERO NEITHER READ NOR WRITE
  2576
  2577				RETURN MAXIMUM STRING LENGTH IN CHARACTERS IN AC
  2578
  2579				!
  2580
  2581
  2582			400000	BC.RDW==(1B0)			;CONTROL WORD READ/WRITE BIT
  2583
  2584				;Read/Set BOOTS command string (SETUUO function 11)
  2585
  2586	002547'	550300	000006	BTCMD:	HRRZ	T1,T1		;ISOLATE CONTROL WORD ADDR
  2587	002550'	322300	002601'		JUMPE	T1,BTCMD1	;IF ZERO ONLY WANT BTSTLN
  2588	002551'	256200	005061'		UMOVE	T1,(T1)		;FETCH CONTROL WORD
  2589	002552'	200400	005065'		MOVE	T3,[POINT 7,BTSTR##]	;PREPARE BTSTR BYTE PTR
  2590	002553'	603300	400000		TLNE	T1,BC.RDW	;STRING READ DESIRED?
  2591	002554'	254000	002562'		 JRST	BTCMD2		;NO: GO WRITE CORE
  2592	002555'	505300	440700		HRLI	T1,(POINT 7,)	;PREPARE USER STRING BYTE PTR
  2593	002556'	134340	000010	BTCMD3:	ILDB	T2,T3		;GET CHAR FROM BTSTR
  2594	002557'	256040	005066'		XCTFU	<IDPB T2,T1>	;GIVE TO USER
  2595	002560'	322340	002601'		JUMPE	T2,BTCMD1	;DONE IF 'NULL'
  2596	002561'	254000	002556'		JRST	BTCMD3		;CONTINUE WITH NEXT CHAR
  2597	002562'	205340	400000	BTCMD2:	MOVSI	T2,LICWCR	;USER MUST HAVE WC LIC
  2598	002563'	616342	002346*		TDNN	T2,JBTLIC(J)	; TO MODIFY BOOTS CMD STRING
  2599	002564'	263040	000000		 POPJ	P,		;DOES NOT, ERRROR RETURN
  2600	002565'	550300	000006		HRRZ	T1,T1		;ISOLATE USER STRING ADDR
  2601	002566'	322300	002577'		JUMPE	T1,BTCMD5	;CLEAR STRING
  2602	002567'	505300	440700		HRLI	T1,(POINT 7,)	;PREPARE USER STRING BYTE PTR
  2603	002570'	201440	000000*		MOVEI	T4,BTSTLN##	;INIT CHAR COUNTER
  2604	002571'	256040	005067'	BTCMD4:	XCTFU	<ILDB T2,T1>	;GET A CHARACTER FROM USER
  2605	002572'	322340	002577'		JUMPE	T2,BTCMD5	;DONE IF 'NULL'
  2606	002573'	322440	002576'		JUMPE	T4,BTCMD6	;ERROR IF STRING TOO LONG
  2607	002574'	136340	000010		IDPB	T2,T3		;PLACE IN BTSTR
  2608	002575'	364440	002571'		SOJA	T4,BTCMD4	;CONTINUE IF ROOM IN STRING
  2609
  2610	002576'	370001	000000	BTCMD6:	SOS	(P)		;SET TO NON-SKIP RETURN
  2611	002577'	400340	000000	BTCMD5:	SETZ	T2,		;PUT 'NULL' TERMINATOR AT
  2612	002600'	136340	000010		IDPB	T2,T3		; END OF STRING
  2613	002601'	201300	002570*	BTCMD1:	MOVEI	T1,BTSTLN##	;GET MAX STRING LENGTH
  2614	002602'	256200	005062'		UMOVEM	T1,(W)		;GIVE TO USER
  2615	002603'	254000	002527*		JRST	CPOPJ1		;SKIP RETURN
  2616
  2617				COMMENT !FUNCTION 12 (.REST): READ/WRITE RESTART BITS
  2618
  2619					HRLI	AC,.REST
  2620					HRRI	AC,<BITS>
  2621					SETUUO	AC,
  2622					  ERROR RETURN		;MISSING LIC
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 35-6
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2623					SUCCESS RETURN
  2624
  2625				<BITS>:		1B18=0  READ RESTART BITS INTO AC
  2626						    =1  SWAP AC RESTART BITS WITH CURRENT RESTART BITS
  2627
  2628						1B19=0  WRITE DSKCLN TYPE TO DISK
  2629						    =1  DO NOT WRITE DSKCLN TYPE TO DISK
  2630
  2631						377B27  CRASH RESTART
  2632						377B35  HANG RESTART
  2633
  2634					THE FORMAT OF THE CRASH AND HANG RESTART FIELDS ARE IDENTICAL.
  2635					LET THE LEFT MOST BIT OF EITHER FIELD BE LABELED '0', THEN
  2636					THE FIELDS ARE INTERPRETED AS FOLLOWS:
  2637
  2638						7B2  DEFINITION STATE OF ACTIONS, 1=DEFINED,
  2639						     BITS CORRESSPOND LEFT TO RIGHT WITH THE
  2640						     THREE ACTIONS
  2641
  2642						1B3=0  STRING PASSED TO BOOTS
  2643						   =1  MANUAL BOOTS
  2644						1B4=0  AUTO ONCE
  2645						   =1  MANUAL ONCE
  2646						7B7  DSKCLN TYPE
  2647		
  2648
  2649				FOR READ OP, RC, OR WC IS NEEDED.  FOR SWAP WC IS REQUIRED.
  2650
  2651				!
  2652
  2653				;Read/Set RESTART bits (SETUUO function 12)
  2654
  2655	002604'	200340	000000*	REST:	MOVE	T2,REUSER##	;GET CURRENT RESTART BITS
  2656	002605'	256200	005070'		UMOVEM	T2,(W)		;PASS ALONG TO USER
  2657	002606'	606300	400000		TRNN	T1,1B18		;SWAP DESIRED?
  2658	002607'	254000	002603*		 JRST	CPOPJ1		;NO. SUCCESS RETURN
  2659	002610'	205340	400000		MOVSI	T2,LICWCR	;GET WC MASK
  2660	002611'	616342	002563*		TDNN	T2,JBTLIC(J)	;DOES USER HAVE WC SET?
  2661	002612'	263040	000000		 POPJ	P,		;NO. ERROR RETURN
  2662	002613'	542300	002604*		HRRM	T1,REUSER##	;SET RESTART BITS
  2663	002614'	254000	002607*		JRST	CPOPJ1		;SUCCESS RETURN
  2664
  2665
  2666				;SET DEFAULT INACTIVITY (SETUUO function 13)
  2667
  2668	002615'	461340	000662*	INASET:	SETCMI	T2,JBLMSK##	;ALLOW A REASONABLE VALUE
  2669	002616'	612340	000006		TDNE	T2,T1		;Limit too big?
  2670	002617'	263040	000000		 POPJ	P,		;Yes, error return
  2671	002620'	336000	000006		SKIPN	T1		;If no value given
  2672	002621'	201300	000000*		 MOVEI	T1,INADFL##	; then use the hard-coded default
  2673	002622'	202300	000665*		MOVEM	T1,INADEF##	;Store
  2674	002623'	254000	002614*		JRST	CPOPJ1		;  and return
  2675
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 35-7
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2676				;SET KSYS (SETUUO function 14) - set KSYS timer for N minutes
  2677
  2678	002624'	572300	000000*	KSYSET:	HRREM	T1,KSYS##	;Zero cancels, +5 if 5 minutes from now,
  2679	002625'	254000	002623*		JRST	CPOPJ1		;Negative if KSYS has expired, hang all
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 36
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2680				;SET OR CLEAR USER MODE WRITE PROTECT BIT IN HIGH SEG FOR THIS USER ONLY
  2681				;CALL:	MOVEI AC,0 OR 1
  2682				;	CALL AC,[SIXBIT /SETUWP/] OR CALLI AC,34
  2683				;	ERROR - MACHINE OR MONITOR CANNOT HANDLE TWO REG, OR TRYING TO CLEAR
  2684				;			;UWP OF A SHARABLE SEG(AC=1 ON RETURN)
  2685				;	OK RETURN - AC CONTAINS PREVIOUS SETTING( OR JOB HAS NO HIGH SEG)
  2686
  2687	002626'	254000	000000*	SETUWP:	JRST USTUWP##		;GO TO ROUTINE IN SEGCON
  2688
  2689				;M TO REMAP TOP PART OF LOW SEGMENT INTO HIGH SEGMENT
  2690				;PREVIOUS HIGH SEG(IF ANY) IS KILLED AND A NEW SEGMENT NUMBER IS ASSIGNED
  2691				;TO THIS JOB. REMAP IS USED BY LOADER AND GET
  2692				;CALL:	MOVEI AC,NEW HIGHEST USER ADR IN LOW SEG(EXEC ORS IN 1777)
  2693				;	CALL AC,[SIXBIT /REMAP/] OR CALLI AC,35
  2694				;	ERROR RETURN, MACHINE OR EXEC CANNOT HANDLE 2 REG OR DESIRED ADR
  2695				;			;GREATER THAN OLD LOW SEG
  2696				;	OK RETURN, LOW SEG ABOVE ARG NOW THE HIGH SEG
  2697
  2698	002627'	254000	000000*	REMAP:	JRST UREMAP##		;CORE1 MODULE IN SEGCON
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 37
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2699				;SET LIGHTS ON CONSOLE FROM USER PROGRAM
  2700				;CALL AC,[SIXBIT /LIGHTS/] OR CALLI AC,-1
  2701
  2702	002630'			LIGHTS::   ;THIS IS AN EXAMPLE OF A USER DEFINED MUUO WITH A NEGATIVE CALLI ARG.
  2703				IFCPU (<KI,F3>),<
  2704					DATAO	PI,T1>		;SENT USER'S AC TO CONSOLE LIGHTS
  2705	002630'	263040	000000		POPJ	P,		;END OF LIGHTS UUO
  2706
  2707	002631'			SWITCH::	;RETURN DATA SWITCHES
  2708				IFCPU (<KI,F3>),<DATAI T1>	;READ CONSOLE DATA SWITCHES DIRECTLY
  2709	002631'	260040	000000*	IFCPU (KL),<PUSHJ P,SPCGSW##>	;SECONDARY PROTOCOL - GET SWITCH VALUE
  2710				IFCPU (KS),<MOVE T1,KSSS4##>	;FAKE SENSE SWITCHES ON KS2020
  2711	002632'	256200	004774'		UMOVEM	T1,(M)		;MOVE TO USER'S AREA.
  2712	002633'	263040	000000		POPJ	P,		;END OF SWITCH UUO
  2713
  2714				;CALLI 67 - Cause a JOB stopcode if CALI67+0 is patched to a JFCL
  2715
  2716	002634'	263040	000000	CALI67::POPJ	P,		;Do nothing on an unpatched monitor
  2717	002635'	256000	005071'		 STOPCD (.,JOB,S..JOB,,<CALLI 67 requested JOB stopcode>)
  2718	002636'	263040	000000		POPJ	P,		;In case S..JOB changed to DEBUG/INFO/EVENT
  2719
  2720				;CALLI 70 - Cause a DEBUG stopcode if CALI70+0 is patched to a JFCL
  2721
  2722	002637'	263040	000000	CALI70::POPJ	P,		;Do nothing on an unpatched monitor
  2723	002640'	256000	005074'		 STOPCD (CPOPJ,DEBUG,S..CI7,,<CALLI 70 requested DEBUG stopcode>)
  2724	002641'	263040	000000		POPJ	P,		;In case S..CI7 is changed
  2725
  2726				;RETURN DEVICE CHARACTERISTICS
  2727
  2728				;DEVTYP = CALLI 53
  2729	002642'	350001	000000	DEVTYP:	AOS	(P)		;Skip return to indicate UUO is implemented
  2730					PFALL	DVCHR	;*HACK* This is good enough for (AUTOPATCH)COMPAR
  2731				PRINTF(<[DEVTYP uuo is not fully implemented]>)
  2732
  2733				;DEVCHR = CALLI 4
  2734	002643'	260040	000000*	DVCHR:	PUSHJ	P,DVCNSG	;SEARCH FOR DEVICE
  2735	002644'	634300	000006		  TDZA	T1,T1		;NOT A DEVICE, RETURN ZERO
  2736	002645'	334304	000004		SKIPA	T1,DEVMOD(F)	;DEVICE FOUND,RETURN DEVMOD
  2737	002646'	254000	002654'		 JRST	DVCHR1		;RETURN ZERO, DEVICE NOT FOUND.
  2738	002647'	621300	000040		TLZ	T1,DVAVAL	;THIS BIT USED FOR OTHER PURPOSES IN CORE
  2739	002650'	135340	001410*		LDB	T2,PJOBN##	;GET JOB NO.  USING DEVICE
  2740	002651'	312340	001546*		CAME	T2,JOB		;DOES CURRENT USER ALREADY HAVE IT?
  2741	002652'	606300	600000		TRNN	T1,ASSCON+ASSPRG;NO, IS IT ASSIGNED?
  2742	002653'	661300	000040		 TLO	T1,DVAVAL	;NO, BUT HE CAN GET IT.
  2743	002654'	256200	004774'	DVCHR1:	UMOVEM	T1,(M)		;MOVE TO USER'S AREA.
  2744	002655'	263040	000000		POPJ	P,		;AND RETURN.
  2745
  2746				;RETURN PROJECT-PROGRAMMER NUMBER IN AC
  2747
  2748	002656'	205300	000001	GETPPN:	MOVSI	T1,JACCT
  2749	002657'	612302	002526*		TDNE	T1,JBTSTS##(J)	;LOGIN OR LOGOUT CUSP RUNNING ?
  2750	002660'	254000	003005'		 JRST	GETPPL		;YES, SPECIAL PROJ,R NUMBER CHANGE.
  2751	002661'	200302	001207*		MOVE	T1,JBTPPN##(J)	;NO, RETURN PROJECT-PROGRAMMER NO. OF THIS JOB.
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 37-2
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2752	002662'	256200	004774'		UMOVEM	T1,(M)		;INFO TO USER'S AREA.
  2753	002663'	263040	000000		POPJ	P,		; AND RETURN.
  2754
  2755	002664'	256200	005012'	RTZER::	XCTBU <SETZM (M)>	;RETURN A ZERO TO THE USER AC.
  2756	002665'	263040	000000		POPJ	P,		;AND RETURN.
  2757
  2758	002666'	260040	002643*	DEVPPU:	PUSHJ	P,DVCNSG
  2759	002667'	254000	002664'		  JRST	RTZER		;NOT A DEVICE
  2760	002670'	603200	000100		TLNE	F,SYSDEV	;For device SYS:
  2761	002671'	334300	002352*		 SKIPA	T1,SYSPPN##	; return [1,4]
  2762	002672'	200302	002661*		MOVE	T1,JBTPPN##(J)	;Return GFD'd PPN for DSK:
  2763	002673'	256200	004774'		UMOVEM	T1,(M)		;MOVE PPN TO USER'S AREA.
  2764	002674'	254000	002625*		JRST	CPOPJ1		;AND SKIP RETURN.
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 38
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2765				;RETURN BUFFER SIZE, STANDARD NO OF BUFFERS
  2766				;CALL:	MOVE AC,LOC OF (2 WORRD) OPEN BLOCK
  2767				;CALLI AC,DVSIZ
  2768				;NOT IMPLEMENTED RETURN
  2769				;AC=XWD NO OF BUFS,BUF SIZE
  2770
  2771	002675'	261040	000013	DVSIZU:	PUSH	P,M		;SAVE UUO
  2772	002676'	540540	000006		HRR	M,T1		;GET LOC OF OPEN-BLOCK
  2773	002677'	256200	004737'		UMOVE T1,(M)		;PICK UP MODE FROM USER'S AREA.
  2774	002700'	200600	000006		MOVE	P1,T1		;SAVE IT
  2775	002701'	541553	000001		HRRI M,1(M)		;INCREMENT POINTER TO USER'S AREA.
  2776	002702'	256200	004737'		UMOVE T1,(M)		;AND GET THE DEVICE.
  2777	002703'	260040	002666*		PUSHJ	P,DVCNSG	;FIND ITS DDB
  2778	002704'	634300	000006		  TDZA	T1,T1		;NOT A DEVICE
  2779	002705'	334540	000014		SKIPA	M,P1		;FOUND - SET UUO=MODE
  2780	002706'	364300	002722'		SOJA	T1,SIZRET	;NOT A DEV - RETURN AC=-1
  2781	002707'	201340	000001		MOVEI	T2,1		;SET FOR MODE TEST
  2782	002710'	405600	000017		ANDI	P1,17		;GET MODE ALONE
  2783	002711'	242354	000000		LSH	T2,(P1)		;POSITION THE BIT
  2784	002712'	211300	000002		MOVNI	T1,2		;IF MODE IS ILLEGAL,
  2785	002713'	301600	000015		CAIL	P1,SD		;TEST FOR DUMP MODE
  2786	002714'	634300	000006		TDZA	T1,T1		;IT IS, RETURN AC=0
  2787	002715'	616344	000004		TDNN	T2,DEVMOD(F)	; RETURN AC=-2
  2788	002716'	324740	002722'		PJRST	SIZRET
  2789	002717'	135300	005077'		LDB T1,[POINT 12,DEVCHR(F),35]
  2790	002720'	505300	000000*		HRLI	T1,STDRNG	;T1/BUFF IN STD RING,,BUFF SIZE
  2791	002721'	271300	000002		ADDI	T1,2		;BUMP SIZE BY 2 HOUSEKEEPING WRDS
  2792	002722'	262040	000013	SIZRET:	POP	P,M		;RESTORE LOC OF AC
  2793	002723'	256200	004774'		UMOVEM T1,(M)		;MOVE T1 TO USER'S AREA.
  2794	002724'	254000	002674*		JRST CPOPJ1		;AND SKIP RETURN.
  2795
  2796	002725'	260040	002703*	UDEVNM:	PUSHJ P,DVCNSG		;FIND DEVICE OR CHANNEL
  2797	002726'	254000	002664'		 JRST RTZER		;NON-RETURN 0
  2798	002727'	200304	000000		MOVE T1,DEVNAM(F)	;GET REAL NAME
  2799	002730'	256200	004774'		UMOVEM T1,(M)		;MOVE T1 TO USER'S AREA.
  2800	002731'	254000	002724*		JRST CPOPJ1		;AND SKIP RETURN.
  2801
  2802					EXTERNAL JBTSOK
  2803
  2804	002732'	405300	000377	SOAKEM:	ANDI T1,377		;MAKE SURE IN RANGE 0-255
  2805	002733'	221300	001750		IMULI T1,^D1000
  2806	002734'	200340	000006		MOVE T2,T1		;A COPY
  2807	002735'	270302	000000*		ADD T1,JBTSOK(J)
  2808	002736'	323300	002731*		JUMPLE T1,CPOPJ1	;IGNORE IF OVERFLOW
  2809	002737'	202302	002735*		MOVEM T1,JBTSOK(J)
  2810	002740'	272340	002737*		ADDM T2,JBTSOK
  2811	002741'	254000	002736*		JRST CPOPJ1
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 39
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2812				;DEVICE STATUS CONI RETRIEVAL CALLI MUUO
  2813
  2814				;     CALL AC,[SIXBIT/DEVSTS/]
  2815				;                 OR
  2816				;    CALLI AC,54
  2817
  2818				;             WHERE AC CONTAINS THE CHANNEL NUMBER OF THE
  2819				;		INIT'ED DEVICE....
  2820				;		THE CONI STATUS WORD IN THE DDB (DEVSTS)
  2821				;		IS RETURNED IN AC
  2822
  2823	002742'	260040	002725*	DEVSTA:	PUSHJ P,DVCNSG		;FIND DEVICE OR CHANNEL
  2824	002743'	254000	002664'		 JRST RTZER
  2825	002744'	200304	000012		MOVE T1,DEVSTS(F)
  2826	002745'	256200	004774'		UMOVEM T1,(M)		;MOVE T1 TO USER'S AREA.
  2827	002746'	254000	002741*		JRST CPOPJ1		;AND SKIP RETURN.
  2828
  2829	002747'	205340	001000	SETJAL:	MOVSI T2,LICJAL
  2830	002750'	612342	002611*		TDNE T2,JBTLIC(J)	;CAN HE DO IT?
  2831	002751'	334340	002767'		SKIPA T2,JALMSK		;YES, ALL THINGS
  2832	002752'	201340	100000		MOVEI T2,JACCT2		;ONLY JACCT2 FOR NORMAL USER
  2833	002753'	260040	000000*		PUSHJ P,CKLGO		;SEE IF WAITING FOR LOGOUT
  2834	002754'	620340	100000		TRZ T2,JACCT2		;IF SO, CAN NOT SET THIS
  2835	002755'	261040	000006		PUSH P,T1
  2836	002756'	404300	000007		AND T1,T2		;THE BITS HE CAN SET
  2837	002757'	436302	002657*		IORM T1,JBTSTS(J)
  2838	002760'	430300	000007		XOR T1,T2
  2839	002761'	412302	002757*		ANDCAM T1,JBTSTS(J)
  2840	002762'	262040	000006		POP P,T1		;GET BACK REQUEST
  2841	002763'	430302	002761*		XOR T1,JBTSTS(J)
  2842	002764'	404300	002767'		AND T1,JALMSK
  2843	002765'	322300	002746*		JUMPE T1,CPOPJ1		;ALL SET, GOOD RETURN
  2844	002766'	263040	000000		POPJ P,			;SOME NOT SET, ERROR RETURN
  2845
  2846	002767'	000005	100100	JALMSK:	XWD JACCT+JLOG,JACCT2+KJP
  2847
  2848	002770'	200300	002472*	ONEJOB:	MOVE T1,STATES		;CHECK FOR SUPER SHUT
  2849	002771'	640300	600000		TRC T1,600000
  2850	002772'	642300	600000		TRCE T1,600000
  2851	002773'	263040	000000		POPJ P,			;NOT SUPER-SHUT
  2852	002774'	200300	001262*		MOVE T1,HIGHJB
  2853	002775'	363300	002765*		SOJLE T1,CPOPJ1	;IF HIGHEST IS JOB 1 MUST BE OK
  2854	002776'	205340	040000		MOVSI T2,JNA
  2855	002777'	612346	002763*		TDNE T2,JBTSTS(T1)	;JOB NUMBER ASSIGNED?
  2856	003000'	263040	000000		POPJ P,			;YES
  2857	003001'	367300	002777'		SOJG T1,.-2
  2858	003002'	254000	002775*		JRST CPOPJ1		;ONLY JOB AND SUPER-SHUT
  2859
  2860				EXTERNAL STATES,CKLGO
  2861
  2862	003003'	256200	005100'	SETDDT:	UMOVEM T1,JOBDDT	;SET JOBDDT IN JOB DATA AREA
  2863	003004'	263040	000000		POPJ P,		;RETURN TO USER
  2864
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 39-2
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2865				EXTERNAL	HIGHJB
  2866	003005'	200302	002672*	GETPPL:	MOVE T1,JBTPPN(J)	; AND GET OLD NUMBERS.
  2867	003006'	200340	002774*		MOVE T2,HIGHJB	;CHECK FOR OTHER USERS UNDER SAME PP NUMBER.
  2868	003007'	306342	000000	PPNLUP:	CAIN T2,(J)	;IS NEXT JOB TO BE LOOKED AT CURRENT JOB ?
  2869					SOJLE T2,[UMOVEM T1,(M)	;YES, FINISHED SCANNING ALL JOBS ?
  2870	003010'	363340	005101'			POPJ P,]	;IF SO, RETURN.
  2871	003011'	316307	003005*		CAMN T1,JBTPPN(T2)	;NO, ANOTHER USER UNDER SAME PROJ,R NUMBER ?
  2872	003012'	354001	000000		AOSA	(P)		;YES, SKIP RETURN TO USER (LOGIN OR LOGOUT)
  2873	003013'	367340	003007'		SOJG T2,PPNLUP	;NO, KEEP LOOKING
  2874	003014'	256200	004774'		UMOVEM T1,(M)		;MOVE T1 TO USER'S AREA.
  2875	003015'	263040	000000		POPJ P,			; AND RETURN.
  2876
  2877	003016'	260040	000000*	GETLN:	PUSHJ	P,TTYFND	;FIND USER'S TTY DATA BLOCK.
  2878	003017'	200304	000000		MOVE	T1,DEVNAM(F)	;GET DEVICE NAME IN SIXBIT
  2879	003020'	256200	004774'		UMOVEM T1,(M)		;MOVE IT TO USER'S AREA.
  2880	003021'	263040	000000		POPJ P,			; AND RETURN.
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 40
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2881				;LOGIN UUO USED ONLY BY LOGIN AND LOGOUT CUSPS
  2882				;CALL:	CALL AC,[SIXBIT /LOGIN/]
  2883				;WHERE AC CONTAINS XWD -NO. OF ENTRIES,LOCATION
  2884				;WHICH IS A LIST OF JOB STATISTICS TO BE STORED IN MONITOR
  2885				;RETURNS TO UUO +1 IF SUCCESSFUL AND THAT LOC DOES NOT CONTAIN A HALT
  2886
  2887	003022'	205340	000004	LOGIN:	MOVSI	T2,JLOG		;IS USER ALREADY LOGGED IN?
  2888	003023'	612342	002777*		TDNE	T2,JBTSTS(J)
  2889	003024'	254000	000000*		 JRST	UUOERR##	;YES, PRINT ILLEGAL UUO
  2890	003025'	574340	000006		HLRE	T2,T1		;User supplies negative word count in LH
  2891	003026'	214600	000007		MOVM	P1,T2		;Positive number of words
  2892	003027'	302600	000006		CAIE	P1,LOGTP1-LOGTAB ;Cannot have 1 word project code
  2893	003030'	306600	000007		CAIN	P1,LOGTP2-LOGTAB ;Cannot have 2 word project code
  2894	003031'	254000	003024*		 JRST	UUOERR##
  2895	003032'	201240	000000*		MOVEI	U,%UPT		;LDBLOG and project code go in %UPT
  2896	003033'	402002	000000*		SETZM	JBTNM1##(J)	;Invalidate GFD'd name
  2897	003034'	402002	000000*		SETZM	JBTNM2##(J)
  2898	003035'	540540	000006		HRR	M,T1		;FIRST REL. LOC.
  2899	003036'	205640	777767		MOVSI	P2,-LOGTOP	;SET FOR LOOP
  2900	003037'	357000	000007	LOGIN1:	AOSG	T2		;More arguments from the caller?
  2901	003040'	256200	005103'		 XCTBU <SKIPA P3,(M)>	;Yes, get next word
  2902	003041'	201700	000000		  MOVEI	P3,0		;No, default to zero
  2903	003042'	202735	003105'		MOVEM	P3,@LOGTAB(P2)	;Store in JBT or UPT
  2904	003043'	271540	000001		ADDI	M,1		;Point to next user argument
  2905	003044'	253640	003037'		AOBJN	P2,LOGIN1	;Do all in LOGTAB
  2906
  2907	003045'	260040	000000*		PUSHJ	P,CHGNAM##	;Make sure JBTNM1 and JBTNM2 match JBTPPN
  2908	003046'	201300	000040		MOVEI	T1,40		;LOGIN accounting record type
  2909	003047'	301600	000010		CAIL	P1,LOGTP3-LOGTAB;All three words of project code?
  2910	003050'	260040	000000*		 PUSHJ	P,WRTACR	;Yes, go write record
  2911	003051'	205340	000004		MOVSI	T2,JLOG		;Job is now logged in
  2912	003052'	436342	003023*		IORM	T2,JBTSTS(J)
  2913
  2914				;Copy originating port from LDB (if one exists)
  2915
  2916	003053'	336302	000456*		SKIPN	T1,TTYTAB(J)	;Address of TTY DDB
  2917	003054'	254000	003062'		 JRST	LOGIN3		;None there???
  2918	003055'	550306	000457*		HRRZ	T1,DDBLDB(T1)	;Address of Line Data Block
  2919	003056'	322300	003062'		JUMPE	T1,LOGIN3	;Skip if detached
  2920	003057'	200306	000000*		MOVE	T1,LDBLOG##(T1)	;Originating port from network
  2921	003060'	336000	000000*		SKIPN	%UPT+UPTLOG##	;If set by CREFRM, don't set again
  2922	003061'	202300	000000*		 MOVEM	T1,%UPT+UPTLOG## ;Set into UPT
  2923
  2924	003062'	135300	000660*	LOGIN3:	LDB	T1,PVYCOR	;JUST MAKE SURE NOT TOO MUCH CORE
  2925	003063'	135340	000652*		LDB	T2,PVYCRM
  2926	003064'	313300	000007		CAMLE	T1,T2
  2927	003065'	200300	000007		MOVE	T1,T2
  2928	003066'	315300	000657*		CAMGE	T1,CORMXK
  2929	003067'	200300	003066*		MOVE	T1,CORMXK
  2930	003070'	137300	003062*		DPB	T1,PVYCOR
  2931
  2932	003071'	205300	000400		MOVSI	T1,PVDINA	;SEE IF WE WANT TO SET THE
  2933	003072'	616302	001271*		TDNN	T1,JBTPRV(J)	;  DEFAULT INACTIVITY TIMEOUT?
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 40-2
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2934	003073'	634300	000006		 TDZA	T1,T1		; NO -- CLEAR THE FIELD
  2935	003074'	550300	002622*		HRRZ	T1,INADEF##	; YES-- USE DEFAULT FROM TABLE
  2936	003075'	137300	000672*		DPB	T1,JBYINA##	;UPDATE THE JBT TABLES
  2937
  2938	003076'	256200	005104'		UMOVE	T1,@PDNMUP(P)	;GET NEXT INSTR FROM USER AREA
  2939	003077'	242300	777750		LSH	T1,-30		;LOOK AT TOP 12 BITS
  2940	003100'	302300	002542		CAIE	T1,2542		;HALT?
  2941	003101'	263040	000000		 POPJ	P,0		;NO. RETURN TO USER.
  2942	003102'	260040	000502*		PUSHJ	P,IORELS	;RELEASE ALL DEVICES
  2943	003103'	260040	000000*		PUSHJ	P,TTYFUW##	;FIND TTY AND PRINT ^C
  2944	003104'	254000	000000*		JRST	HOLD
  2945
  2946				;Table of pointers to tables for use by MOVEM data,@LOGTAB(ac).
  2947				;To make LOGIN set more tables in the Monitor, just add table names at end.
  2948				;This table is also used by the CREFRM uuo.
  2949
  2950	003105'	000002	003011*	LOGTAB::XWD	J,JBTPPN##	;Project-Progremmer Number (GFD PPN)
  2951	003106'	000002	003072*		XWD	J,JBTPRV##	;Job privilege bits
  2952	003107'	000002	001204*		XWD	J,JBTAUN##	;Accounting User Number (LOGIN PPN)
  2953	003110'	000002	001264*		XWD	J,JBTUNM##	;Login user name (1st part)
  2954	003111'	000002	001265*		XWD	J,JBTUN1##	;Login user name (2nd part)
  2955	003112'	000005	000000*		XWD	U,UPTLOG##	;Tymnet supervisor information
  2956	003113'	000005	000000*	LOGTP1:	XWD	U,UPTPJC##	;Three word project code
  2957	003114'	000005	000000*	LOGTP2:	XWD	U,UPTPJ1##
  2958	003115'	000005	000000*	LOGTP3:	XWD	U,UPTPJ2##
  2959			000011	XP	LOGTOP,.-LOGTAB		;Number of tables to be set (for FRMSER too)
  2960
  2961
  2962
  2963				;LOGOUT MUUO
  2964
  2965	003116'	205300	000004	LOGOUT:	MOVSI	T1,JLOG
  2966	003117'	616302	003052*		TDNN	T1,JBTSTS(J)	;IS JOB ALREADY LOGGED OUT ?
  2967	003120'	254000	000753*		 JRST	JOBKL		;NO, GO COMPLETE WORK OF LOGOUT CUSP.
  2968	003121'	254000	000463'		JRST	EXIT		;YES, TREAT AS "EXIT"
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 41
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  2969				;HERE WITH FD IN J AND ACCESS RIGHTS NUMBER IN P3 TO SEE IF CALLER
  2970				; CAN GET INFORMATION. IF SO, GO TO FINTAB, IF NOT, POPJ AND GIVE ERROR RETURN.
  2971
  2972				EXTERNAL FARCHK
  2973
  2974	003122'	200740	000002	ACCWAY:	MOVE	P4,J		;GET FD INTO P4 WHERE IT BELONGS
  2975	003123'	261040	000006		PUSH	P,T1		;SVE TABLE ADDRESS
  2976	003124'	260040	000000*		PUSHJ	P,FARCHK	;CHECK THE FD, SEE IF CALLER HAS RIGHTS
  2977	003125'	254000	002414*		  JRST	TPOPJ		;NO, GIVE ERROR RETURN TO UUO CALLER
  2978	003126'	262040	000006		POP	P,T1		;OK, RESTORE T1 AND
  2979	003127'	254000	003263'		JRST	FINTAB		;GIVE HIM THE DATA.
  2980
  2981	003130'	200340	002651*	SYSWAY:	MOVE	T2,JOB
  2982	003131'	200347	002750*		MOVE	T2,JBTLIC(T2)
  2983	003132'	607340	240000		TLNN	T2,LICSYS!LICSPY
  2984	003133'	263040	000000		  POPJ	P,		;MUST HAVE SYSTAT
  2985	003134'	254000	003263'		JRST	FINTAB
  2986
  2987	003135'	334700	005105'	ACJWAY:	SKIPA	P3,[.ARRAD]	;NEED READ ACCT DATA FOR THIS
  2988	003136'	201700	000003	JLNWAY:	MOVEI	P3,.ARRDS	;NEED READ STATE TO GET FRAME'S TTY NAME
  2989	003137'	200740	000002		MOVE	P4,J		;GET FD IN P4 FOR FARCHK
  2990	003140'	261046	003345'		PUSH	P,NUMTAB(T1)	;SAVE ADDRESS TO GO TO ON STACK.
  2991	003141'	260040	003124*		PUSHJ	P,FARCHK	;MAKE SURE FD IS OK, CHECK ACCESS
  2992	003142'	254000	003125*		  JRST	TPOPJ		;NO GOOD, GIVE ERROR
  2993	003143'	263040	000000		POPJ	P,		;GET ROUTINE ADDRESS OFF STACK AND GO TO IT.
  2994
  2995	003144'	260040	001551*	TAJWAY:	PUSHJ	P,TIMADJ
  2996	003145'	201700	000004		MOVEI	P3,.ARRAD	;WAYTAJ IS USED TO READ ACCOUNTING DATA
  2997	003146'	254000	003122'		JRST	ACCWAY		;GO CHECK.
  2998
  2999	003147'	262040	000002	JPOPJ:	POP P,J
  3000	003150'	263040	000000		POPJ P,
  3001
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 42
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3002
  3003				DEFINE X(NAM,OK,DO)<
  3004				WAY'NAM==<.-WAYTAB>_5
  3005				IFGE <.-WAYTAB>-17,<PRINTX TOO MANY WAYS IN GETTAB
  3006				QQQQQQ>
  3007				IFNB <DO>,<DO>
  3008				IFB <DO>,<JRST [MOVEI P3,.AR'NAM
  3009						JRST ACCWAY]>
  3010				>;END X MACRO DEFINITION
  3011
  3012				DEFINE WAYS<
  3013				X(RPI)
  3014				X(RFI)
  3015				X(RUN)
  3016				X(RDS)
  3017				X(RAD)
  3018				X(JLN,<POPJ P,>,<JRST JLNWAY>)
  3019				X(ACJ,<POPJ P,>,<JRST ACJWAY>)
  3020				X(SYS,<JFCL>,<JRST SYSWAY>)
  3021				X(TAJ,<JFCL>,<JRST TAJWAY>)
  3022				X(JMP,<POPJ P,>,<JRST @NUMTAB(T1)>)
  3023				>;END WAYS MACRO DEFINITION
  3024
  3025				;GENERATE TABLE OF WAYS
  3026
  3027	003151'	255000	000000	WAYTAB:	JFCL				;IF NO WAY, DO NOTHING.
  3028	003152'	254000	005106'		WAYS
  3029	003153'	254000	005110'
  3030	003154'	254000	005112'
  3031	003155'	254000	005114'
  3032	003156'	254000	005116'
  3033	003157'	254000	003136'
  3034	003160'	254000	003135'
  3035	003161'	254000	003130'
  3036	003162'	254000	003144'
  3037	003163'	254026	003345'
  3038
  3039				DEFINE X(NAM,OK,DO)<
  3040				IFNB <OK>,<OK>
  3041				IFB <OK>,<JFCL>
  3042				>;END X MACRO DEFINITION
  3043
  3044	003164'	255000	000000	WAYTJB:	JFCL				;IF NO WAY, DO NOTHING
  3045	003165'	255000	000000		WAYS
  3046	003166'	255000	000000
  3047	003167'	255000	000000
  3048	003170'	255000	000000
  3049	003171'	255000	000000
  3050	003172'	263040	000000
  3051	003173'	263040	000000
  3052	003174'	255000	000000
  3053	003175'	255000	000000
  3054	003176'	263040	000000
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 42-2
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3055
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 43
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3056				;HERE FROM COMCON WITH C(T2) FRAME TRYING TO EXECUTE COMMAND,
  3057				; C(J) TARGET FRAME NUMBER
  3058
  3059				EXTERNAL JOBMAX
  3060
  3061
  3062	003177'	261040	000006	CHKSGJ:	PUSH	P,T1
  3063	003200'	201300	240000		MOVEI	T1,LICSYS!LICSPY
  3064	003201'	254000	003207'		JRST	CHKSJ1
  3065
  3066				;HERE WITH C(JOB) CURRENT FRAME NUMBER, FRAME NUMBER TO CHECK FOR IN
  3067				; C(J) (UNCHECKED)
  3068
  3069	003202'	200340	003130*	CHKSEG:	MOVE	T2,JOB
  3070	003203'	303100	000000*		CAILE	J,JOBMAX	;IN RANGE?
  3071	003204'	263040	000000		POPJ	P,		;NO, GIVE ERROR RETURN.
  3072	003205'	261040	000006		PUSH	P,T1
  3073	003206'	205300	240000		MOVSI	T1,LICSYS!LICSPY
  3074	003207'	612307	003131*	CHKSJ1:	TDNE	T1,JBTLIC(T2)
  3075	003210'	254000	002537*		  JRST	TPOPJ1		;HAS SYSTAT, GIVE IT TO HIM
  3076	003211'	200302	003107*		MOVE	T1,JBTAUN(J)
  3077	003212'	430307	003211*		XOR	T1,JBTAUN(T2)
  3078	003213'	322300	003210*		JUMPE	T1,TPOPJ1	;SAME AUN, OK TO HAVE IT
  3079	003214'	603300	777777		TLNE	T1,-1
  3080	003215'	254000	003142*		  JRST	TPOPJ		;NOT SAME PROJECT, NEVER CAN GET IT
  3081	003216'	201300	020000		MOVEI	T1,PVACTS	;CHECK ACCOUNT SUP
  3082	003217'	612307	003106*		TDNE	T1,JBTPRV(T2)
  3083	003220'	350001	777777		  AOS	-1(P)
  3084	003221'	254000	003215*		JRST	TPOPJ
  3085
  3086				;HERE TO DO NUMTAB - TAKE CARE OF NEGATIVE INDICES.
  3087
  3088	003222'	574100	000006	DONUMT:	HLRE	J,T1		;Incase LH is -1 (do NOT use current job number)
  3089	003223'	201342	003345'		MOVEI	T2,NUMTAB(J)	;GET ADDRESS HE WANTS
  3090	003224'	305340	003517'		CAIGE	T2,ENDGTB	;IF PAST END OR
  3091	003225'	305340	003266'		CAIGE	T2,MINTAB	;BEFORE THE BEGINNING
  3092	003226'	263040	000000		  POPJ	P,		;ERROR RETURN.
  3093	003227'	200400	003202*		MOVE	T3,JOB		;MUST HAVE SY
  3094	003230'	200410	003207*		MOVE	T3,JBTLIC(T3)
  3095	003231'	607400	240000		TLNN	T3,LICSYS!LICSPY;OR ELSE
  3096	003232'	263040	000000		  POPJ	P,		;GIVE HIM ERROR RETURN
  3097	003233'	306340	003370'		CAIN	T2,NUMTAB+.GTSLF;WANTS ADDRESS OF NUMTAB ITSELF?
  3098	003234'	334300	005120'		  SKIPA	T1,[NUMTAB]	;RETURN ADDRESS OF NUMTAB TO HIM.
  3099	003235'	200307	000000		MOVE	T1,(T2)		;GET THE DATA
  3100	003236'	256200	004774'		UMOVEM	T1,(M)
  3101	003237'	254000	003002*		JRST	CPOPJ1		;AND RETURN.
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 44
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3102				;GETTAB UUO
  3103				;UUO TO RETURN CONTENTS OF A MONITOR JOB TABLE ENTRY
  3104				;CALL:	HRROI AC, MONITOR JOB TABLE NUMBER
  3105				;	HRLI AC, JOB NUMBER (OPTIONAL) LH = -1 MEANS CURRENT JOB
  3106				;	CALL AC, [SIXBIT /GETTAB/] OR CALLI AC,41
  3107				;	  ERROR RETURN (AC PRESERVED) IF BAD TABLE OR INDEX, NOT PRIVILEGED
  3108				;	NORMAL RETURN - AC CONTAINS VALID DATA
  3109					EXTERN TTYTAB,JOBMXL,STSTBL,STSMXL
  3110					EXTERNAL GETLOG,TIMADJ,JBTCMP,JBTCPU,JBTBCS,JBTFPN
  3111					EXTERNAL JBTCNK,JBTELP,JBTCOT,JBTCIN,JBTSOT,JBTSIN
  3112					EXTERNAL JBTBET,JBTBIO
  3113					EXTERNAL JBTSER,JBTSLK,JBTDLK,LINJOB,JBTERN
  3114			777000	NOMXL==777000			;DEFINED TO FOOL OLD NUMTAB WATCHERS
  3115
  3116	003240'	554100	000006	GETTAB:	HLRZ	J,T1		;GET USER SUPPLIED JOB NUMBER
  3117	003241'	306100	777777		CAIN	J,-1		;If index is -1 and table indexed by job number,
  3118	003242'	200100	003227*		 MOVE	J,JOB		; use current job number
  3119	003243'	570340	000006		HRRE	T2,T1		;IN CASE NEGATIVE
  3120	003244'	271340	003345'		ADDI	T2,NUMTAB
  3121	003245'	307340	003517'		CAIG	T2,ENDGTB
  3122	003246'	305340	003266'		CAIGE	T2,MINTAB	;IS IT IN RANGE
  3123	003247'	263040	000000		  POPJ	P,		;YES. ERROR RETURN, AC UNCHANGED
  3124	003250'	306340	003370'		CAIN	T2,NUMTAB+.GTSLF;Table of GETTAB addresses is special
  3125	003251'	254000	003254'		 JRST	GETTB1		;It can have negative indices
  3126	003252'	602100	400000		TRNE	J,400000	;Any other negative index is not allowed
  3127	003253'	263040	000000		 POPJ	P,		;(including -2 = job's hiseg)
  3128	003254'	135340	005121'	GETTB1:	LDB	T2,[POINT 9,NUMTAB(T1),8]	;MAX LEGAL ARG.
  3129	003255'	306340	000777		CAIN	T2,NOMXL_-^D9	;IF SPECIAL CODE (777) THEN
  3130	003256'	254000	003261'		 JRST	GETTB2		;NO BOUNDS CHECK, SOMEONE ELSE WILL DO IT.
  3131	003257'	313100	000007		CAMLE	J,T2		;DOES HIS ARG EXCEED LEGAL ONE?
  3132	003260'	263040	000000		 POPJ	P,0		;YES. ERROR RETURN
  3133	003261'	135340	005122'	GETTB2:	LDB	T2,[POINT 4,NUMTAB(T1),12]	;GET ACTION TYPE
  3134	003262'	256007	003151'		XCT	WAYTAB(T2)	;DO IT
  3135	003263'	200326	003345'	FINTAB:	MOVE	T1,@NUMTAB(T1)	;GET CONTENTS OF MONITOR TABLE
  3136	003264'	256200	004774'		UMOVEM	T1,(M)		;MOVE T1 TO USER'S AREA.
  3137	003265'	254000	003237*		JRST	CPOPJ1		;AND SKIP RETURN.
  3138
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 45
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3139				;THE MONITOR JOB TABLE NUMBERS:
  3140				        INTERN NUMTAB
  3141					EXTERN LICTBL,LICMXL
  3142					EXTERN JBTNAM,NSWTBL,CNFTBL,NSWMXL,CNFMXL,JBTCP2
  3143					EXTERN JBTSLM,JBTLIM,GETLPS,GETMOD,JBTBET,JBTBIO
  3144					EXTERN JBTMPC,JBTPWS,JBTPWH,JBTPWL
  3145					EXTERN ODPMXL,ODPTBL,LVDMXL,LVDTBL,JBTWCT,JBTRCT
  3146					EXTERN SWPTBL,SWPMXL
  3147					EXTERN TTYTBL,TTYMXL,FETTBL,FETMXL,CRSDB,CRSMXL
  3148					EXTERN COMTAB,COMMXL,WATTAB,WATMXL,SETBL,SETMXL
  3149					EXTERN JBTKCT,JBTFTR,JBTUID,JBTPNO
  3150	003266'			MINTAB:
  3151	003266'	000002*	000000*		XWD LICMXL+J,LICTBL		;(-57)LICENSE POINTERS,NAMES,VALUES
  3152	003267'	777202	000620*		XWD NOMXL+WAYRDS+J,JBTSLM	;(-56)MAXIMUM TRU LIMIT
  3153	003270'	777042	000126*		XWD NOMXL+WAYRPI+J,JBTINA	;(-55)INACTIVITY TIMEOUT
  3154	003271'	777102	000000*		XWD NOMXL+WAYRFI+J,JBTFTR	;(-54)PARENT, BROTHER, CHILD
  3155	003272'	777102	000000*		XWD NOMXL+WAYRFI+J,JBTUID	;(-53)UNIVERSAL ID NUMBER FOR FRAME
  3156	003273'	777042	000000*		XWD NOMXL+WAYRPI+J,JBTPNO	;(-52)PROGRAM NUMBER FOR FRAME
  3157	003274'	777340	003567'		XWD NOMXL+WAYACJ,PWSGET		;(-51)DP PGS TO WS*SIZE.
  3158	003275'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTPWS	;(-50) NO. PAGES TO UWS.
  3159	003276'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTMPC	;(-47) NO. PAGES MAPPED.
  3160	003277'	777340	003557'		XWD NOMXL+WAYACJ,MCYGET		;(-46)GET D.P. MICROCYCLES
  3161	003300'	777340	003547'		XWD NOMXL+WAYACJ,KCTGET		;(-45)GET D.P. KILO-CORE-TICKS
  3162	003301'	777340	003540'		XWD NOMXL+WAYACJ,TRUGET		;(-44)GET D.P. TRU TO AC,AC+1
  3163	003302'	777340	003532'		XWD NOMXL+WAYACJ,TRUGN2		;(-43) HIGH PART OF TRU
  3164	003303'	777442	000000*		XWD NOMXL+WAYTAJ+J,JBTCP2	;(-42) HIGH PART OF MICRO-CYCLES
  3165	003304'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTBIO	;(-41) BIO CHAR CHARGE
  3166	003305'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTBET	;(-40) BIO TIME CHARGE
  3167	003306'	777242	002740*		XWD NOMXL+WAYRAD+J,JBTSOK	;(-37) SOAKEM ARG
  3168	003307'	777500	004144'		XWD NOMXL+WAYJMP,GETLNK		;(-36) LINKED GETTAB
  3169	003310'	777240	004675'		XWD NOMXL+WAYRAD,[0]		;(-35) RMT CHR CHARGE
  3170	003311'	777240	004675'		XWD NOMXL+WAYRAD,[0]		;(-34) RMT TIME CHARGE
  3171	003312'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTERN	;(-33) ENTERS+RENAMES
  3172	003313'	777500	000000*		XWD NOMXL+WAYJMP,GETLPS		;(-32) GET TTY LINE POS
  3173	003314'	777500	000000*		XWD NOMXL+WAYJMP,GETMOD		;(-31) GET TTY MODE
  3174	003315'	777202	000621*		XWD NOMXL+WAYRDS+J,JBTLIM	;(-30) TIME (TRU) LIMIT
  3175	003316'	777300	004135'		XWD NOMXL+WAYJLN,JOBLIN		;(-27) JOB TO LINE
  3176	003317'	777500	000000*		XWD NOMXL+WAYJMP,LINJOB		;(-26) LINE TO JOB
  3177	003320'	777042	002351*		XWD NOMXL+WAYRPI+J,JBTFPN	;(-25) JBTFPN
  3178	003321'	777500	000000*		XWD NOMXL+WAYJMP,GETLOG		;(-24) LDBLOG BY U NUMBER
  3179	003322'	777102	003212*		XWD NOMXL+WAYRFI+J,JBTAUN	;(-23) ACCOUNT USER NUM
  3180	003323'	777142	003110*		XWD NOMXL+WAYRUN+J,JBTUNM	;(-22) FIRST PART OF USER NAME
  3181	003324'	777142	003111*		XWD NOMXL+WAYRUN+J,JBTUN1	;(-21) SECOND PART
  3182					XWD NOMXL+WAYRPI+J,JBTLIC	;(-20) LICENSE (NEEDS READ PROCESS DATE TO PROTECT PROC
  3183	003325'	777042	003230*	ESS LICENSE)
  3184	003326'	000500	002512*		XWD WAYJMP,CPOPJ		;(-17)
  3185	003327'	000500	003326*		XWD WAYJMP,CPOPJ		;(-16)
  3186	003330'	777442	000000*		XWD NOMXL+WAYTAJ+J,JBTCMP	;(-15) CLOCK TIM
  3187	003331'	777442	000000*		XWD NOMXL+WAYTAJ+J,JBTCPU	;(-14) HIGH PART OF KCT
  3188	003332'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTBCS	;(-13) BREAK CHRS*SIZE
  3189	003333'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTCNK	;(-12) CONNECT TIME
  3190	003334'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTELP	;(-11) ELAPSED TIME*SIZE
  3191	003335'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTCOT	;(-10) CHRS OUT
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 45-2
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3192	003336'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTCIN	;(-7) CHRS IN
  3193	003337'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTSOT	;(-6) DISK BLOCKS OUT*SIZE
  3194	003340'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTSIN	;(-5) DISK BLOCKS IN*SIZE
  3195	003341'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTSER	;(-4) ENTER+RENAME*SIZE
  3196	003342'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTSLK	;(-3) LOOKUPS*SIZE
  3197	003343'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTDLK	;(-2) LOOKUPS
  3198	003344'	000500	003327*		XWD WAYJMP,CPOPJ		;(-1)
  3199	003345'	777142	003117*	NUMTAB:	XWD NOMXL+WAYRUN+J,JBTSTS	;(0) - JOB STATUS BITS
  3200	003346'	000040*	004675'		XWD JOBMXL+WAYRPI,[0]		;(1) - JOB SIZE -1 AND PAGE NO. OF UPT FORMERLY,
  3201									; NOW RETURN 0 FOR CHKPNT.
  3202
  3203	003347'	777102	003105*		XWD NOMXL+WAYRFI+J,JBTPPN	;(2) - PROJECT,PROGRAMMER NUMBER
  3204	003350'	777042	000000*		XWD NOMXL+WAYRPI+J,JBTNAM	;(3) - PROGRAM BEING RUN
  3205	003351'	777340	003524'		XWD NOMXL+WAYACJ,TRUGN		;(4) - TRU'S
  3206	003352'	777442	000000*		XWD NOMXL+WAYTAJ+J,JBTKCT	;(5) - KILO-CORE TICKS(JIFFIES*SIZE IN J)
  3207
  3208	003353'	777042	003217*		XWD NOMXL+WAYRPI+J,JBTPRV	;(6) - PRIVILEGE BITS SET BY LOGIN
  3209	003354'	777500	003576'		XWD NOMXL+WAYJMP,SIMJSW		;(7) - FAKE JBTSWP, TEMPORARY TILL SYSTAT FIXED.
  3210	003355'	777202	003053*		XWD NOMXL+WAYRDS+J,TTYTAB	;(10) - TTY TRANSLATOR TABLE (DDB ADDRESS)
  3211	003356'	000002*	000000*		XWD CNFMXL+J,CNFTBL		;(11) - CONFIGURATION DATA
  3212	003357'	000402*	000000*		XWD NSWMXL+WAYSYS+J,NSWTBL	;(12) - NON-SWAPPING DATA
  3213	003360'	000402*	000000*		XWD SWPMXL+WAYSYS+J,SWPTBL	;(13) - SWAPPER DATA
  3214
  3215	003361'	000500	003344*		XWD WAYJMP,CPOPJ	;JBTSGN	;(14) - OBSOLETE (OLD HISEG NUMBER)
  3216	003362'	000402*	000000*		XWD ODPMXL+WAYSYS+J,ODPTBL	;(15) - ONCE ONLY DISK PARAMETERS
  3217	003363'	000002*	000000*		XWD LVDMXL+J,LVDTBL		;(16) - LEVEL D DISK PARAMS
  3218	003364'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTRCT	;(17) - DISK BLOCKS READ BY JOB
  3219	003365'	777242	000000*		XWD NOMXL+WAYRAD+J,JBTWCT	;(20) - DISK BLOCKS WRITTEN BY JOB
  3220	003366'	000500	003361*		XWD WAYJMP,CPOPJ	;NONE	;(21) - ACC. DSK-BLOCK-SECONDS ALLOCATED BY JOB
  3221					XWD WAYJMP,CPOPJ	;NONE	;(22) - TIME OF DAY DSK BLOCKS LAST ALLOCATED+TOTAL BLO
  3222	003367'	000500	003366*	CKS ALLOCATED
  3223			000023	.GTSLF==.-NUMTAB			;.GTSLF=23 - Get self pointer
  3224					XWD NOMXL+WAYJMP,DONUMT		;(23) - THE GETTAB ADDRESSES THEMSELVES (GETTAB IMMEDIA
  3225	003370'	777500	003222'	TE)
  3226	003371'	000500	003367*		XWD WAYJMP,CPOPJ	;JBTDEV	;(24) - OBSOLETE (OLD DEVICE NAME FOR HISEGS)
  3227									; OF SHARABLE HIGH SEG
  3228	003372'	000002*	000000*		XWD STSMXL+J,STSTBL		;(25) - SIXBIT NAMES FOR JOB QUEUE CODES
  3229	003373'	000500	003371*		XWD WAYJMP,CPOPJ	;JBTLOC	;(26) - RESERVED FOR REMOTE COMMUNICATIONS
  3230	003374'	000500	003373*		XWD WAYJMP,CPOPJ	;NONE	;(27) - PHYSICAL CORE ALLOCATION TABLE
  3231	003375'	000402*	000000*		XWD COMMXL+WAYSYS+J,COMTAB	;(30) - SIXBIT Monitor Command Names
  3232	003376'	777142	003033*		XWD NOMXL+WAYRUN+J,JBTNM1##	;(31) - SIXBIT Username [1 for 6]
  3233	003377'	777142	003034*		XWD NOMXL+WAYRUN+J,JBTNM2##	;(32) - SIXBIT Username [7 for 6]
  3234	003400'	777242	003322*		XWD NOMXL+WAYRAD+J,JBTAUN	;(33) - DEC: Job charge number [AUN]
  3235	003401'	000500	003374*		XWD WAYJMP,CPOPJ	;NONE	;(34) - (Obsolete) Pointer to TMPCOR
  3236	003402'	777102	002520*		XWD NOMXL+WAYRFI+J,JBTWCH	;(35) - FRAME WATCH BITS
  3237	003403'	000500	003401*		XWD WAYJMP,CPOPJ	;JBTSPL	;(36) - DEC: Spooling control flags
  3238	003404'	000500	003403*		XWD WAYJMP,CPOPJ	;JBTRTD	;(37) - DEC: Real time status word
  3239	003405'	000500	003404*		XWD WAYJMP,CPOPJ	;JBTLIM	;(40) - DEC: JBTLIM and batch status
  3240	003406'	000500	003405*		XWD WAYJMP,CPOPJ	;NONE	;(41) - DEC: .GTQQQ Obsolete
  3241	003407'	000500	003406*		XWD WAYJMP,CPOPJ	;NONE	;(42) - DEC: .GTQJB Obsolete
  3242	003410'	000402*	000000*		XWD SETMXL+WAYSYS+J,SETBL	;(43) - SIXBIT SET Command Names
  3243	003411'	000402*	000000*		XWD CRSMXL+WAYSYS+J,.GTCRS##	;(44) - 3-word Crash data block
  3244	003412'	000500	003407*		XWD WAYJMP,CPOPJ	;ISCAN	;(45) - DEC:.GTISC spwinp scan list
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 45-3
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3245	003413'	000500	003412*		XWD WAYJMP,CPOPJ	;OSCAN	;(46) - DEC:.GTOSC swpout scan list
  3246	003414'	000500	003413*		XWD WAYJMP,CPOPJ	;SSCAN	;(47) - DEC:.GTSSC sched scan list
  3247	003415'	000500	003414*		XWD WAYJMP,CPOPJ	;JBTRSP	;(50) - DEC:.GTRSP Response counter
  3248	003416'	000402*	000000*		XWD SYSMXL##+WAYSYS+J,SYSTBL##	;(51) - System-wide ERROR data
  3249	003417'	000402*	000000*		XWD WHYMXL##+WAYSYS+J,CRSHAC##	;(52) - ASCIZ Reload string (CRSHAC)
  3250	003420'	000500	003415*		XWD WAYJMP,CPOPJ	;JBTRQT	;(53) - DEC: Total time in run queue
  3251	003421'	000500	003420*		XWD WAYJMP,CPOPJ	;JBTSPS	;(54) - DEC: Status word for CPUn(s)
  3252	003422'	000500	003421*		XWD WAYJMP,CPOPJ	;.C0CDB	;(55) - DEC:.GTC0C
  3253	003423'	000500	003422*		XWD WAYJMP,CPOPJ	;.C0VBG	;(56) - DEC:.GTC0V
  3254	003424'	000500	003423*		XWD WAYJMP,CPOPJ	;.C1CDB	;(57) - DEC:.GTC1C
  3255	003425'	000500	003424*		XWD WAYJMP,CPOPJ	;.C1VBG	;(60) - DEC:.GTC1V
  3256	003426'	000500	003425*		XWD WAYJMP,CPOPJ	;.C2CDB	;(61) - DEC:.GTC2C
  3257	003427'	000500	003426*		XWD WAYJMP,CPOPJ	;.C2VBG	;(62) - DEC:.GTC2V
  3258	003430'	000500	003427*		XWD WAYJMP,CPOPJ	;.C3CDB	;(63) - DEC:.GTC3C
  3259	003431'	000500	003430*		XWD WAYJMP,CPOPJ	;.C3VBG	;(64) - DEC:.GTC3V
  3260	003432'	000500	003431*		XWD WAYJMP,CPOPJ	;.C4CDB	;(65) - DEC:.GTC4C
  3261	003433'	000500	003432*		XWD WAYJMP,CPOPJ	;.C4VBG	;(66) - DEC:.GTC4V
  3262	003434'	000500	003433*		XWD WAYJMP,CPOPJ	;.C5CDB	;(67) - DEC:.GTC5C
  3263	003435'	000500	003434*		XWD WAYJMP,CPOPJ	;.C5VBG	;(70) - DEC:.GTC5V
  3264	003436'	000402*	000000*		XWD FETMXL+WAYSYS+J,FETTBL	;(71) - Feature test table
  3265	003437'	000500	003435*		XWD WAYJMP,CPOPJ	;SDVTBL	;(72) - DEC: Ersatz device table
  3266	003440'	000500	003437*		XWD WAYJMP,CPOPJ	;.GTSCN	;(73) - DEC: Scanner data
  3267	003441'	000500	003440*		XWD WAYJMP,CPOPJ	;SNDTMP	;(74) - DEC: ASCIZ Last SEND ALL
  3268	003442'	000402*	000000*		XWD TTYMXL+WAYSYS+J,TTYTBL	;(75) - SIXBIT Set TTY commands
  3269	003443'	000500	003441*		XWD WAYJMP,CPOPJ	;PIDTAB	;(76) - DEC: Process communications ID
  3270	003444'	000500	003443*		XWD WAYJMP,CPOPJ	;IPCTAB	;(77) - DEC: Misc IPCF data
  3271	003445'	777042	000000*		XWD NOMXL+WAYRPI+J,JBTUPM	;(100)- User pages,Physical UPT page#
  3272									;For hiseg, LH has start page number
  3273	003446'	000402*	000000*		XWD WATMXL+WAYSYS+J,WATTAB	;(101)- SIXBIT Set WATCH commands
  3274	003447'	000500	003444*		XWD WAYJMP,CPOPJ	;PDB	;(102)- DEC: Current Virt/Phys Limits
  3275	003450'	000500	003447*		XWD WAYJMP,CPOPJ	;PDB	;(103)- DEC: Maximum Virt/Phys Limits
  3276	003451'	000500	003450*		XWD WAYJMP,CPOPJ	;PDB	;(104)- DEC: .GTIPA IPCF statistics
  3277	003452'	000500	003451*		XWD WAYJMP,CPOPJ	;PDB	;(105)- DEC: .GTIPP IPCF pointers etc.
  3278	003453'	000500	003452*		XWD WAYJMP,CPOPJ	;PDB	;(106)- DEC: PID for Jobs [SYSTEM]INFO
  3279	003454'	000500	003453*		XWD WAYJMP,CPOPJ	;PDB	;(107)- DEC: .GTIPQ IPCF flags/quotas
  3280	003455'	000500	003454*		XWD WAYJMP,CPOPJ	;PDB	;(110)- DEC: Job logical name table
  3281	003456'	000500	003455*		XWD WAYJMP,CPOPJ	;PDB	;(111)- DEC: ADRBRK word for job
  3282	003457'	000500	003456*		XWD WAYJMP,CPOPJ	;NONE	;(112)- DEC: .GTCMP Obsolete
  3283	003460'	000500	003457*		XWD WAYJMP,CPOPJ	;.GTVM	;(113)- DEC: General VM Info by Item
  3284	003461'	000500	003460*		XWD WAYJMP,CPOPJ	;JBTVRT	;(114)- DEC: Paging rate for job
  3285	003462'	000500	003461*		XWD WAYJMP,CPOPJ	;.GTSST	;(115)- DEC: Scheduler statistics
  3286	003463'	000500	003462*		XWD WAYJMP,CPOPJ	;.GTDCF	;(116)- DEC: Desired use fract/chan
  3287	003464'	777142	000000*		XWD NOMXL+WAYRUN+J,JBTST2##	;(117)- Second job status word
  3288	003465'	000500	003463*		XWD WAYJMP,CPOPJ	;JBTSCD	;(120)- DEC: Job type/Scheduler Class
  3289	003466'	000500	003465*		XWD WAYJMP,CPOPJ	;CLSSTS	;(121)- DEC: Scheduler Class quotas
  3290	003467'	000500	003466*		XWD WAYJMP,CPOPJ	;NONE	;(122)- DEC: .GTCOJ Obsolete
  3291	003470'	000500	003467*		XWD WAYJMP,CPOPJ	;SIDOFS	;(123)- DEC: Class runtime since quota set
  3292	003471'	000500	003470*		XWD WAYJMP,CPOPJ	;NONE	;(124)- DEC: .GTSQH Obsolete
  3293	003472'	000500	003471*		XWD WAYJMP,CPOPJ	;NONE	;(125)- DEC: .GTSQ  Obsolete
  3294	003473'	000500	003472*		XWD WAYJMP,CPOPJ	;.GTSID	;(126)- DEC: .GTSID Special PID table
  3295	003474'	000500	003473*		XWD WAYJMP,CPOPJ	;.EQTAB	;(127)- DEC: .GTENQ ENQ/DEQ statistics
  3296	003475'	777042	003272*		XWD NOMXL+WAYRPI+J,JBTUID	;(130)- .GTJLT UDT at LOGIN (DEC:JBTJLT)
  3297	003476'	000500	003474*		XWD WAYJMP,CPOPJ	;PDB	;(131)- DEC: .GTEBT EBOX time/jiffies
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 45-4
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3298	003477'	000500	003476*		XWD WAYJMP,CPOPJ	;PDB	;(132)- DEC: .GTEBR EBOX jiffy remainder
  3299	003500'	000500	003477*		XWD WAYJMP,CPOPJ	;PDB	;(133)- DEC: .GTMBT MBOX time/jiffies
  3300	003501'	000500	003500*		XWD WAYJMP,CPOPJ	;PDB	;(134)- DEC: .GTMBR MBOX jiffy remainder
  3301	003502'	777040	005123'		XWD NOMXL+WAYRPI,['DSKB  ']	;(135)- .GTRDV program run device
  3302	003503'	777042	003320*		XWD NOMXL+WAYRPI+J,JBTFPN;PDB	;(136)- .GTRDI program run directory
  3303	003504'	777042	000000*		XWD NOMXL+WAYRPI+J,JBTPRG##	;(137)- .GTRFN program run filename
  3304	003505'	000500	003501*		XWD WAYJMP,CPOPJ;  JBTXXX;PDB	;(140)- .GTDFL User defaults for job
  3305	003506'	000500	003505*		XWD WAYJMP,CPOPJ	;NETGTT	;(141)- DEC: .GTNTP Network perf data
  3306	003507'	000500	003506*		XWD WAYJMP,CPOPJ	;SCDPER	;(142)- DEC: .GTSPA Scheduler perf data
  3307	003510'	000500	003507*		XWD WAYJMP,CPOPJ	;PDB	;(143)- DEC: .GTVKS Virtual KCT
  3308	003511'	000500	003510*		XWD WAYJMP,CPOPJ;  JBTXXX;PDB	;(144)- .GTUUC Monitor Calls XCT'd
  3309	003512'	000500	003511*		XWD WAYJMP,CPOPJ	;PDB	;(145)- DEC: .GTRS0
  3310	003513'	000500	003512*		XWD WAYJMP,CPOPJ	;PDB	;(146)- DEC: .GTRS1
  3311	003514'	000500	003513*		XWD WAYJMP,CPOPJ	;PDB	;(147)- DEC: .GTRS2
  3312	003515'	000500	003514*		XWD WAYJMP,CPOPJ	;PDB	;(150)- DEC: .GTRS3
  3313	003516'	000500	003515*		XWD WAYJMP,CPOPJ	;PDB	;(151)- DEC: .GTRS4
  3314	003517'	777102	000012*		XWD NOMXL+WAYRFI+J,JBTPC	;(152)- .GTPC I/O wait DDB/PC
  3315				;*; End of currently defined GETTAB tables
  3316				;	XWD NOMXL+WAYRFI+J,JBTPRV;PDB	;(153)- DEC: .GTCAP job capabilities
  3317				;					;Max possible privs, used by ENABLE command
  3318				;	XWD WAYJMP,CPOPJ	;RNGTAB	;(154)- DEC: .GTIDX min,max table range
  3319				;	XWD WAYJMP,CPOPJ	;NUMTAB	;(155)- DEC: .GTGTB gettab immediate
  3320				;	XWD XXXMXL+J,XXXTBL	;TTTWDT	;(156)- DEC: .GTTNM terminal type names
  3321				;	XWD WAYJMP,CPOPJ	;PDB	;(157)- DEC: .GTOBI WTO & Batch data
  3322				;	XWD WAYJMP,CPOPJ	;DVCSTS	;(160)- DEC: .GTDCD coni/datai for DSB
  3323				;	XWD WAYJMP,CPOPJ	;NDBTBL	;(161)- DEC: .GTNDB byt ptrs to NDB
  3324				;	XWD WAYJMP,CPOPJ	;JBTPDB	;(162)- DEC: .GTPDB PP pages, PDB addr
  3325				;	XWD WAYJMP,CPOPJ	;PDB	;(163)- DEC: .GTEQJ ENQ/DEQ queue header
  3326				;	XWD XXXMXL+WAYSYS+J,XXXTBL	;(164)- DEC: Set DEFAULT cmd args
  3327				;	XWD NOMXL+WAYRPI+J,JBTXXX;PDB	;(165)- DEC: .GTLBS disk buffer sizes
  3328				;	XWD WAYJMP,CPOPJ	;PDB	;(166)- DEC: .GTPTR program to run
  3329				;	XWD WAYJMP,CPOPJ	;PDB	;(167)- DEC: .GTSTM UDT of last RESET
  3330				;	XWD WAYJMP,CPOPJ	;DCNGTB	;(170)- DEC: .GTDNT decnet v3 q headers
  3331				;	XWD WAYJMP,CPOPJ	;PDB	;(171)- DEC: .GTSJB decnet session CB
  3332				;	XWD WAYJMP,CPOPJ	;NONE	;(172)- DEC: .GTNSP (DEC Reserved)
  3333				;	XWD WAYJMP,CPOPJ	;.GTNDA	;(173)- DEC: .GTNDA Node data blk addr
  3334				;	XWD WAYJMP,CPOPJ	;OJBTAB	;(174)- DEC: .GTAOT ANF10 Obj Translation	
  3335
  3336			003517'	ENDGTB==.-1
  3337			000153	GTTBLN==.-NUMTAB			;LENGTH OF TABLE
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 46
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3338				;MUUO TO SET CURRENT PROGRAM NAME
  3339				;	MOVE AC,[SIXBIT /NAME/]
  3340				;	ALWAYS RETURN
  3341
  3342	003520'	202302	003350*	SETNAM:	MOVEM	T1,JBTNAM(J)	;STORE PROGRAM NAME FOR SYSTAT AND SYSDPY
  3343	003521'	402002	003503*		SETZM	JBTFPN(J)	;ZERO THIS OUT FOR CHAIN FROM LOADER
  3344	003522'	201300	000003		MOVEI	T1,3		;Do NOT change accounting info in JBTPRG
  3345	003523'	324740	001200*		PJRST	ACTWRT		;WRITE TYPE 3 ACCOUNTING RECORD AND RETURN
  3346
  3347	003524'	260040	003144*	TRUGN:	PUSHJ	P,TIMADJ	;READ CLOCK AND UPDATE COUNTS
  3348	003525'	260040	003202'		PUSHJ	P,CHKSEG
  3349	003526'	263040	000000		  POPJ	P,		;CAN NOT GIVE HIM THIS INFO
  3350	003527'	260040	003606'		PUSHJ	P,CLKTRU	;CALCULATE TRU'S
  3351	003530'	256200	004774'		UMOVEM	T1,(M)		;MOVE T1 TO USER'S AREA.
  3352	003531'	254000	003265*		JRST	CPOPJ1		;AND SKIP RETURN.
  3353
  3354					INTERNAL CLKTRU,CHKSEG,CHKSGJ
  3355
  3356	003532'	260040	003524*	TRUGN2:	PUSHJ	P,TIMADJ
  3357	003533'	260040	003202'		PUSHJ	P,CHKSEG
  3358	003534'	263040	000000		 POPJ	P,		;JUST LIKE ABOVE
  3359	003535'	260040	003606'		PUSHJ	P,CLKTRU
  3360	003536'	256200	004771'		UMOVEM	T2,(M)		;BUT STORE HIGH PART
  3361	003537'	254000	003531*		JRST	CPOPJ1
  3362
  3363				;-THREE GETTABS WHICH RETURN DOUBLE-PRECISION QUANTITY
  3364				;	IN AC,AC+1 (NO WRAPAROUND).
  3365
  3366	003540'	260040	003532*	TRUGET:	PUSHJ	P,TIMADJ
  3367	003541'	260040	003202'		PUSHJ	P,CHKSEG
  3368	003542'	263040	000000		  POPJ	P,		;JUST LIKE ABOVE
  3369	003543'	260040	003606'		PUSHJ	P,CLKTRU
  3370	003544'	256200	005041'		UMOVEM	T1,1(M)		;LOW ORDER TO AC+1
  3371	003545'	256200	004771'		UMOVEM	T2,(M)		;HI TO AC
  3372	003546'	254000	003537*		JRST	CPOPJ1
  3373	003547'	260040	003540*	KCTGET:	PUSHJ	P,TIMADJ
  3374	003550'	260040	003202'		PUSHJ	P,CHKSEG
  3375	003551'	263040	000000		  POPJ	P,
  3376	003552'	200302	003331*		MOVE	T1,JBTCPU(J)
  3377	003553'	256200	004774'		UMOVEM	T1,(M)
  3378	003554'	200302	003352*		MOVE	T1,JBTKCT(J)
  3379	003555'	256200	005041'		UMOVEM	T1,1(M)
  3380	003556'	254000	003546*		JRST	CPOPJ1
  3381	003557'	260040	003547*	MCYGET:	PUSHJ	P,TIMADJ
  3382	003560'	260040	003202'		PUSHJ	P,CHKSEG
  3383	003561'	263040	000000		  POPJ	P,
  3384	003562'	200302	003303*		MOVE	T1,JBTCP2(J)
  3385	003563'	256200	004774'		UMOVEM	T1,(M)
  3386	003564'	200302	003330*		MOVE	T1,JBTCMP(J)
  3387	003565'	256200	005041'		UMOVEM	T1,1(M)
  3388	003566'	254000	003556*		JRST	CPOPJ1
  3389
  3390				;ROUTINE TO RETURN JBTPWH/JBTPWL.
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 46-2
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3391	003567'	260040	003202'	PWSGET:	PUSHJ	P,CHKSEG
  3392	003570'	263040	000000		  POPJ	P,
  3393	003571'	200302	000000*		MOVE	T1,JBTPWH(J)
  3394	003572'	256200	004774'		UMOVEM	T1,(M)
  3395	003573'	200302	000000*		MOVE	T1,JBTPWL(J)
  3396	003574'	256200	005041'		UMOVEM	T1,1(M)
  3397	003575'	254000	003566*		JRST	CPOPJ1
  3398
  3399				;TEMPORARY ROUTINE TO FAKE UP IMGIN AND IMGOUT IN JBTSWP
  3400
  3401	003576'	303100	003203*	SIMJSW:	CAILE	J,JOBMAX	;IN RANGE?
  3402	003577'	263040	000000		  POPJ	P,		;NO, FORGET IT.
  3403	003600'	554302	003445*		HLRZ	T1,JBTUPM(J)	;GET NUMBER OF EXISTENT PAGES
  3404	003601'	200340	000006		MOVE	T2,T1		;COPY INTO T2
  3405	003602'	242300	000011		LSH	T1,^D9		;SHIFT IT INTO OTHER PLACE
  3406	003603'	434300	000007		IOR	T1,T2		;GET INTO BOTH IMGIN AND IMGOUT
  3407	003604'	256200	004774'		UMOVEM	T1,(M)		;STORE RETURN VALUE
  3408	003605'	254000	003575*		JRST	CPOPJ1		;AND RETURN.
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 47
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3409					DEFINE SINGL1 (MULT,QUANT,%%X,%%Y),<IFG %%X+%%Y-5,<%%Z==1
  3410					REPEAT %%X+%%Y-5,<%%Z==%%Z*^D10>
  3411					PUSH	P,T2
  3412					OPSET	(IDIV,T1,%%Z)
  3413					EXCH	T1,(P)
  3414					EXCH	T1,T2
  3415					OPSET	(DIV,T1,%%Z)
  3416					MOVE	T2,T1
  3417					POP	P,T1>
  3418					ADD	T2,-1(P)
  3419					TLZE	T2,(1B0)
  3420					ADDI	T1,1
  3421					MOVEM	T2,-1(P)
  3422					ADDM	T1,(P)
  3423				>  ;end DEFINE SINGL1
  3424
  3425					DEFINE OPSET (OP,AC,ARG),<
  3426				 IFG ARG-777777,<OP AC,[ARG]>
  3427				IFLE ARG-777777,<OP'I AC,ARG>
  3428				>  ;end DEFINE OPSET
  3429
  3430					DEFINE SINGLE (MULT,QUANT),<
  3431				%%X==0
  3432				%%Y==0
  3433				IRPC MULT,<%%X==%%X+1>
  3434				IRPC QUANT,<%%Y==%%Y+1>
  3435				%%Z==1
  3436				REPEAT 5-%%X-%%Y,<%%Z==%%Z*^D10>
  3437					OPSET(MUL,T1,^D'MULT*%%Z)
  3438					SINGL1(MULT,QUANT,%%X,%%Y)
  3439				>  ;end DEFINE SINGLE
  3440
  3441					DEFINE SINGLL(VAL,MULT,QUANT),<
  3442					MOVE T1,JBT'VAL(J)
  3443					SINGLE(MULT,QUANT)
  3444				>  ;end DEFINE SINGLL
  3445
  3446					DEFINE DOUBLE(VAL1,VAL2,MULT,QUANT),<
  3447					MOVE T1,JBT'VAL1(J)
  3448					MOVE T2,JBT'VAL2(J)
  3449					OPSET(IMUL,T1,^D'MULT)
  3450					PUSH P,T1
  3451					MOVE T1,T2
  3452					OPSET(MUL,T1,^D'MULT)
  3453					ADDM T1,(P)
  3454					POP P,T1
  3455				%%X==0
  3456				%%Y==0
  3457				IRPC MULT,<%%X==%%X+1>
  3458				IRPC QUANT,<%%Y==%%Y+1>
  3459					SINGL1(MULT,QUANT,%%X,%%Y)
  3460				>  ;end DEFINE DOUBLE
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 48
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3461				COMMENT !  CLKTRU: CALCULATE DOUBLE-PRECISION TRU'S &
  3462					RETURN IN T1 (LOW), T2 (HI).
  3463
  3464					IN THE MACRO CALLS 'DOUBLE', 'SINGLE', & 'SINGLL'
  3465					THE CONSTANTS HAVE THESE MEANINGS:
  3466				  DOUBLE(V1,V2,RATE,QUANT)..THE D.P. ENTITY (V1,V2) CHARGES AT
  3467				  0.RATE TRU'S PER QUANTITY OF ENTITY..IE, 0.03371 TRU'S
  3468				   PER 100,000 [MICROCYCLES*SIZE]
  3469				 SINGLL(V,RATE,QUANT)..  0.RATE TRU'S PER QUANT OF V
  3470				 SINGLE(RATE,QUANT)..  0.RATE TRU'S PER QUANT OF ITEM IN T1
  3471
  3472				WHEN CHANGING THIS ALGORITHM, PLEASE CHANGE (MONDOC)TRUFRM.DOC
  3473				AND THE FORTRAN COST CALCULATION PROGRAM APPROPRIATELY, AND
  3474				SEND OUT A MEMO TO THE PEOPLE WHO NEED TO KNOW ABOUT THE CHANGE.
  3475				!
  3476				EXTERNAL JBSRCT,JBRIRD,JBYSC1,JBYSC2
  3477
  3478					SALL
  3479	003606'	261040	004675'	CLKTRU:	PUSH	P,[0]		;Double precision running total
  3480	003607'	261040	004675'		PUSH	P,[0]		; is accumulated on top of PDL
  3481
  3482				;; First, compute the size-independent components.
  3483
  3484	003610'	200302	003562*		DOUBLE (CP2,CMP,9004,100000)
  3485	003611'	200342	003564*
  3486	003612'	221300	021454
  3487	003613'	261040	000006
  3488	003614'	200300	000007
  3489	003615'	225300	021454
  3490	003616'	272301	000000
  3491	003617'	262040	000006
  3492	003620'	261040	000007
  3493	003621'	231300	303240
  3494	003622'	250301	000000
  3495	003623'	250300	000007
  3496	003624'	235300	303240
  3497	003625'	200340	000006
  3498	003626'	262040	000006
  3499	003627'	270341	777777
  3500	003630'	623340	400000
  3501	003631'	271300	000001
  3502	003632'	202341	777777
  3503	003633'	272301	000000
  3504				 ;Double-precision micro-cycles
  3505	003634'	200302	003306*		SINGLL(SOK,001,1)
  3506	003635'	225300	000012
  3507	003636'	270341	777777
  3508	003637'	623340	400000
  3509	003640'	271300	000001
  3510	003641'	202341	777777
  3511	003642'	272301	000000
  3512					;SOAKEM UUO charges
  3513
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 48-2
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3514	003643'	200302	003335*		MOVE	T1,JBTCOT(J)	;Characters out
  3515	003644'	270302	003336*		ADD	T1,JBTCIN(J)	;Characters in
  3516	003645'	225300	001530		SINGLE(856,1000)
  3517	003646'	261040	000007
  3518	003647'	231300	000144
  3519	003650'	250301	000000
  3520	003651'	250300	000007
  3521	003652'	235300	000144
  3522	003653'	200340	000006
  3523	003654'	262040	000006
  3524	003655'	270341	777777
  3525	003656'	623340	400000
  3526	003657'	271300	000001
  3527	003660'	202341	777777
  3528	003661'	272301	000000
  3529
  3530	003662'	200302	003305*		SINGLL(BET,004,1)
  3531	003663'	225300	000050
  3532	003664'	270341	777777
  3533	003665'	623340	400000
  3534	003666'	271300	000001
  3535	003667'	202341	777777
  3536	003670'	272301	000000
  3537					;Elapsed time in block i/o mode
  3538	003671'	200302	003304*		SINGLL(BIO,4,1000)
  3539	003672'	225300	000004
  3540	003673'	270341	777777
  3541	003674'	623340	400000
  3542	003675'	271300	000001
  3543	003676'	202341	777777
  3544	003677'	272301	000000
  3545					;Block i/o characters in+out
  3546	003700'	200302	003276*		SINGLL(MPC,000168,1)
  3547	003701'	225300	000250
  3548	003702'	261040	000007
  3549	003703'	231300	000144
  3550	003704'	250301	000000
  3551	003705'	250300	000007
  3552	003706'	235300	000144
  3553	003707'	200340	000006
  3554	003710'	262040	000006
  3555	003711'	270341	777777
  3556	003712'	623340	400000
  3557	003713'	271300	000001
  3558	003714'	202341	777777
  3559	003715'	272301	000000
  3560					;ONE-TENTH DISK READ FOR MAP.
  3561	003716'	200302	003275*		SINGLL(PWS,02696,1)
  3562	003717'	225300	005210
  3563	003720'	261040	000007
  3564	003721'	231300	000012
  3565	003722'	250301	000000
  3566	003723'	250300	000007
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 48-3
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3567	003724'	235300	000012
  3568	003725'	200340	000006
  3569	003726'	262040	000006
  3570	003727'	270341	777777
  3571	003730'	623340	400000
  3572	003731'	271300	000001
  3573	003732'	202341	777777
  3574	003733'	272301	000000
  3575					;# pages put into UWS
  3576
  3577	003734'	200302	003312*		MOVE	T1,JBTERN(J)	;Enters + renames
  3578	003735'	242300	000002		LSH	T1,2
  3579	003736'	270302	003343*		ADD	T1,JBTDLK(J)	;Lookups
  3580	003737'	221300	000003		IMULI	T1,3
  3581	003740'	200342	003364*		MOVE	T2,JBTRCT(J)	;Disk blocks read
  3582	003741'	270342	003365*		ADD	T2,JBTWCT(J)	;Disk blocks written
  3583	003742'	332000	000002		SKIPE	J		;NOT FOR JOB 0
  3584	003743'	621340	000000*		  TLZ	T2,JBRIRD_<JBSRCT-^D18> ;ONLY LOW ORDER 24 BITS
  3585	003744'	270300	000007		ADD	T1,T2
  3586	003745'	225300	001242		SINGLE (00674,1)
  3587	003746'	261040	000007
  3588	003747'	231300	000012
  3589	003750'	250301	000000
  3590	003751'	250300	000007
  3591	003752'	235300	000012
  3592	003753'	200340	000006
  3593	003754'	262040	000006
  3594	003755'	270341	777777
  3595	003756'	623340	400000
  3596	003757'	271300	000001
  3597	003760'	202341	777777
  3598	003761'	272301	000000
  3599
  3600				;; Before performing the kilocore-dependent calculations, see if
  3601				;; a kilocore-independent scale factor should be applied (from the
  3602				;; XCHARG TRU-scaling call) - any size-dependent TRU scaling is
  3603				;; done by adjusting the charging size in GTCGSZ.
  3604
  3605	003762'	135340	000000*		LDB	T2,JBYSC1	;Is there a scale factor numerator?
  3606	003763'	322340	004003'		JUMPE	T2,CLKTRX	;Jump around code if not
  3607	003764'	222341	000000		IMULM	T2,0(P)		;First, multiply high-order word
  3608	003765'	200301	777777		MOVE	T1,-1(P)	;Copy low-order word
  3609	003766'	224300	000007		MUL	T1,T2		;D.P. result clobbers T2
  3610	003767'	272301	000000		ADDM	T1,0(P)		;Sum up high-order partial products
  3611	003770'	202341	777777		MOVEM	T2,-1(P)	;Save new low-order word
  3612
  3613	003771'	135300	000000*		LDB	T1,JBYSC2	;Get divisor
  3614	003772'	250301	000000		EXCH	T1,0(P)		;Save divisor, get high-order product
  3615	003773'	230301	000000		IDIV	T1,0(P)		;T1 gets quotient, t2 gets remainder
  3616	003774'	250300	000007		EXCH	T1,T2		;T2  "      "    , T1  "       "
  3617	003775'	250341	777777		EXCH	T2,-1(P)	;-1(P) gets high-order quotient, T2
  3618								; gets low-order product
  3619	003776'	234301	000000		DIV	T1,0(P)		;T1 gets (T1,,T2)/0(P)
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 48-4
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3620	003777'	623300	400000		TLZE	T1,400000	;Correct for double precision
  3621	004000'	350001	777777		  AOS	-1(P)		;Carry into high-order word
  3622	004001'	250301	777777		EXCH	T1,-1(P)	;Swap low-order quot. with high-order
  3623	004002'	202301	000000		MOVEM	T1,0(P)		;Store high-order quotient
  3624
  3625				;; Now, calculate all the size-dependent components (i.e.,
  3626				;;   units*size.
  3627
  3628	004003'			CLKTRX:
  3629	004003'	200302	003552*		DOUBLE (CPU,KCT,03371,100000)
  3630	004004'	200342	003554*
  3631	004005'	221300	006453
  3632	004006'	261040	000006
  3633	004007'	200300	000007
  3634	004010'	225300	006453
  3635	004011'	272301	000000
  3636	004012'	262040	000006
  3637	004013'	261040	000007
  3638	004014'	230300	005124'
  3639	004015'	250301	000000
  3640	004016'	250300	000007
  3641	004017'	234300	005124'
  3642	004020'	200340	000006
  3643	004021'	262040	000006
  3644	004022'	270341	777777
  3645	004023'	623340	400000
  3646	004024'	271300	000001
  3647	004025'	202341	777777
  3648	004026'	272301	000000
  3649				 ;D.P. microcycles*size
  3650	004027'	200302	003571*		DOUBLE (PWH,PWL,00154,10000)
  3651	004030'	200342	003573*
  3652	004031'	221300	000232
  3653	004032'	261040	000006
  3654	004033'	200300	000007
  3655	004034'	225300	000232
  3656	004035'	272301	000000
  3657	004036'	262040	000006
  3658	004037'	261040	000007
  3659	004040'	231300	303240
  3660	004041'	250301	000000
  3661	004042'	250300	000007
  3662	004043'	235300	303240
  3663	004044'	200340	000006
  3664	004045'	262040	000006
  3665	004046'	270341	777777
  3666	004047'	623340	400000
  3667	004050'	271300	000001
  3668	004051'	202341	777777
  3669	004052'	272301	000000
  3670				 ;D.P. <pgs put in UWS>*size
  3671	004053'	200302	003334*		SINGLL(ELP,00016,1)
  3672	004054'	225300	000020
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 48-5
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3673	004055'	261040	000007
  3674	004056'	231300	000012
  3675	004057'	250301	000000
  3676	004060'	250300	000007
  3677	004061'	235300	000012
  3678	004062'	200340	000006
  3679	004063'	262040	000006
  3680	004064'	270341	777777
  3681	004065'	623340	400000
  3682	004066'	271300	000001
  3683	004067'	202341	777777
  3684	004070'	272301	000000
  3685					;<Elapsed time>*size
  3686	004071'	200302	003332*		SINGLL(BCS,00535,1)
  3687	004072'	225300	001027
  3688	004073'	261040	000007
  3689	004074'	231300	000012
  3690	004075'	250301	000000
  3691	004076'	250300	000007
  3692	004077'	235300	000012
  3693	004100'	200340	000006
  3694	004101'	262040	000006
  3695	004102'	270341	777777
  3696	004103'	623340	400000
  3697	004104'	271300	000001
  3698	004105'	202341	777777
  3699	004106'	272301	000000
  3700					;<Break chars seen>*size
  3701
  3702	004107'	200302	003341*		MOVE	T1,JBTSER(J)	;<Enters + Renames>*size
  3703	004110'	242300	000002		LSH	T1,2
  3704	004111'	270302	003342*		ADD	T1,JBTSLK(J)	;Lookups*size
  3705	004112'	221300	000003		IMULI	T1,3
  3706	004113'	270302	003340*		ADD	T1,JBTSIN(J)	;<Disk blocks read>*size
  3707	004114'	270302	003337*		ADD	T1,JBTSOT(J)	;<Disk blocks written>*size
  3708	004115'	225300	000115		SINGLE(00077,1)
  3709	004116'	261040	000007
  3710	004117'	231300	000012
  3711	004120'	250301	000000
  3712	004121'	250300	000007
  3713	004122'	235300	000012
  3714	004123'	200340	000006
  3715	004124'	262040	000006
  3716	004125'	270341	777777
  3717	004126'	623340	400000
  3718	004127'	271300	000001
  3719	004130'	202341	777777
  3720	004131'	272301	000000
  3721				;; Calculation complete, get double-precision result from PDL
  3722				;;   into T1 and T2.
  3723
  3724	004132'	262040	000007		POP	P,T2
  3725	004133'	262040	000006		POP	P,T1
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 48-6
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3726	004134'	263040	000000		POPJ	P,		;ALL CALCULATED T1 IS LOW PART T2 HIGH
  3727					XALL
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 49
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3728
  3729	004135'	260040	003202'	JOBLIN:	PUSHJ	P,CHKSEG		;CAN HE GET THIS INFO
  3730	004136'	263040	000000		  POPJ	P,			;NO
  3731	004137'	550302	003355*		HRRZ	T1,TTYTAB(J)		;IS THERE ONE THERE??
  3732					JUMPE	T1,[UMOVEM T1,(M)	^XCTTU	<MOVEM T1,(M)	>^SALL
  3733					GINST==<PXCT PX.MEM,[MOVEM T1,(M)	]>
  3734					PXGEN(<MOVEM T1,(M)	>,<LDB,ILDB,IDPB,DPB>,<QQQQQQ>)^
  3735					ZZ==0
  3736					IRPC 
  3737				
  3738					ZZ1==0
  3739					IFIDN < > <M>,<ZZ1==1>
  3740					IFIDN <	> <M>,<ZZ1==1>
  3741					IFN ZZ1,<STOPI>
  3742					IFE ZZ1,<
  3743					ZZ==ZZ_6
  3744					ZZ==ZZ+'M'
  3745				>;END IFE ZZ1
  3746				
  3747				
  3748				
  3749					ZZ1==0
  3750					IFIDN < > <O>,<ZZ1==1>
  3751					IFIDN <	> <O>,<ZZ1==1>
  3752					IFN ZZ1,<STOPI>
  3753					IFE ZZ1,<
  3754					ZZ==ZZ_6
  3755					ZZ==ZZ+'O'
  3756				>;END IFE ZZ1
  3757				
  3758				
  3759				
  3760					ZZ1==0
  3761					IFIDN < > <V>,<ZZ1==1>
  3762					IFIDN <	> <V>,<ZZ1==1>
  3763					IFN ZZ1,<STOPI>
  3764					IFE ZZ1,<
  3765					ZZ==ZZ_6
  3766					ZZ==ZZ+'V'
  3767				>;END IFE ZZ1
  3768				
  3769				
  3770				
  3771					ZZ1==0
  3772					IFIDN < > <E>,<ZZ1==1>
  3773					IFIDN <	> <E>,<ZZ1==1>
  3774					IFN ZZ1,<STOPI>
  3775					IFE ZZ1,<
  3776					ZZ==ZZ_6
  3777					ZZ==ZZ+'E'
  3778				>;END IFE ZZ1
  3779				
  3780				
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 49-2
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3781				
  3782					ZZ1==0
  3783					IFIDN < > <M>,<ZZ1==1>
  3784					IFIDN <	> <M>,<ZZ1==1>
  3785					IFN ZZ1,<STOPI>
  3786					IFE ZZ1,<
  3787					ZZ==ZZ_6
  3788					ZZ==ZZ+'M'
  3789				>;END IFE ZZ1
  3790				
  3791				
  3792				
  3793					ZZ1==0
  3794					IFIDN < > < >,<ZZ1==1>
  3795					IFIDN <	> < >,<ZZ1==1>
  3796					IFN ZZ1,<STOPI>
  3797					IFE ZZ1,<
  3798					ZZ==ZZ_6
  3799					ZZ==ZZ+' '
  3800				>;END IFE ZZ1
  3801				
  3802				
  3803				;END IRPC MOVEM T1,(M)	
  3804					IRP 
  3805				
  3806					IFE <ZZ-'LDB'>,<GINST==<PXCT QQQQQQ,[MOVEM T1,(M)	]>>
  3807				
  3808				
  3809				
  3810					IFE <ZZ-'ILDB'>,<GINST==<PXCT QQQQQQ,[MOVEM T1,(M)	]>>
  3811				
  3812				
  3813				
  3814					IFE <ZZ-'IDPB'>,<GINST==<PXCT QQQQQQ,[MOVEM T1,(M)	]>>
  3815				
  3816				
  3817				
  3818					IFE <ZZ-'DPB'>,<GINST==<PXCT QQQQQQ,[MOVEM T1,(M)	]>>
  3819				
  3820				
  3821				;END IRP LDB,ILDB,IDPB,DPB
  3822				
  3823					PURGE ZZ1
  3824				^	
  3825								
  3826					PXGEN(<MOVEM T1,(M)	>,<PUSH>,<PX.SRC>)^
  3827					ZZ==0
  3828					IRPC 
  3829				
  3830					ZZ1==0
  3831					IFIDN < > <M>,<ZZ1==1>
  3832					IFIDN <	> <M>,<ZZ1==1>
  3833					IFN ZZ1,<STOPI>
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 49-3
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3834					IFE ZZ1,<
  3835					ZZ==ZZ_6
  3836					ZZ==ZZ+'M'
  3837				>;END IFE ZZ1
  3838				
  3839				
  3840				
  3841					ZZ1==0
  3842					IFIDN < > <O>,<ZZ1==1>
  3843					IFIDN <	> <O>,<ZZ1==1>
  3844					IFN ZZ1,<STOPI>
  3845					IFE ZZ1,<
  3846					ZZ==ZZ_6
  3847					ZZ==ZZ+'O'
  3848				>;END IFE ZZ1
  3849				
  3850				
  3851				
  3852					ZZ1==0
  3853					IFIDN < > <V>,<ZZ1==1>
  3854					IFIDN <	> <V>,<ZZ1==1>
  3855					IFN ZZ1,<STOPI>
  3856					IFE ZZ1,<
  3857					ZZ==ZZ_6
  3858					ZZ==ZZ+'V'
  3859				>;END IFE ZZ1
  3860				
  3861				
  3862				
  3863					ZZ1==0
  3864					IFIDN < > <E>,<ZZ1==1>
  3865					IFIDN <	> <E>,<ZZ1==1>
  3866					IFN ZZ1,<STOPI>
  3867					IFE ZZ1,<
  3868					ZZ==ZZ_6
  3869					ZZ==ZZ+'E'
  3870				>;END IFE ZZ1
  3871				
  3872				
  3873				
  3874					ZZ1==0
  3875					IFIDN < > <M>,<ZZ1==1>
  3876					IFIDN <	> <M>,<ZZ1==1>
  3877					IFN ZZ1,<STOPI>
  3878					IFE ZZ1,<
  3879					ZZ==ZZ_6
  3880					ZZ==ZZ+'M'
  3881				>;END IFE ZZ1
  3882				
  3883				
  3884				
  3885					ZZ1==0
  3886					IFIDN < > < >,<ZZ1==1>
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 49-4
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3887					IFIDN <	> < >,<ZZ1==1>
  3888					IFN ZZ1,<STOPI>
  3889					IFE ZZ1,<
  3890					ZZ==ZZ_6
  3891					ZZ==ZZ+' '
  3892				>;END IFE ZZ1
  3893				
  3894				
  3895				;END IRPC MOVEM T1,(M)	
  3896					IRP 
  3897				
  3898					IFE <ZZ-'PUSH'>,<GINST==<PXCT PX.SRC,[MOVEM T1,(M)	]>>
  3899				
  3900				
  3901				;END IRP PUSH
  3902				
  3903					PURGE ZZ1
  3904				^
  3905					PXGEN(<MOVEM T1,(M)	>,<POP,BLT>,<PX.MEM>)^
  3906					ZZ==0
  3907					IRPC 
  3908				
  3909					ZZ1==0
  3910					IFIDN < > <M>,<ZZ1==1>
  3911					IFIDN <	> <M>,<ZZ1==1>
  3912					IFN ZZ1,<STOPI>
  3913					IFE ZZ1,<
  3914					ZZ==ZZ_6
  3915					ZZ==ZZ+'M'
  3916				>;END IFE ZZ1
  3917				
  3918				
  3919				
  3920					ZZ1==0
  3921					IFIDN < > <O>,<ZZ1==1>
  3922					IFIDN <	> <O>,<ZZ1==1>
  3923					IFN ZZ1,<STOPI>
  3924					IFE ZZ1,<
  3925					ZZ==ZZ_6
  3926					ZZ==ZZ+'O'
  3927				>;END IFE ZZ1
  3928				
  3929				
  3930				
  3931					ZZ1==0
  3932					IFIDN < > <V>,<ZZ1==1>
  3933					IFIDN <	> <V>,<ZZ1==1>
  3934					IFN ZZ1,<STOPI>
  3935					IFE ZZ1,<
  3936					ZZ==ZZ_6
  3937					ZZ==ZZ+'V'
  3938				>;END IFE ZZ1
  3939				
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 49-5
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3940				
  3941				
  3942					ZZ1==0
  3943					IFIDN < > <E>,<ZZ1==1>
  3944					IFIDN <	> <E>,<ZZ1==1>
  3945					IFN ZZ1,<STOPI>
  3946					IFE ZZ1,<
  3947					ZZ==ZZ_6
  3948					ZZ==ZZ+'E'
  3949				>;END IFE ZZ1
  3950				
  3951				
  3952				
  3953					ZZ1==0
  3954					IFIDN < > <M>,<ZZ1==1>
  3955					IFIDN <	> <M>,<ZZ1==1>
  3956					IFN ZZ1,<STOPI>
  3957					IFE ZZ1,<
  3958					ZZ==ZZ_6
  3959					ZZ==ZZ+'M'
  3960				>;END IFE ZZ1
  3961				
  3962				
  3963				
  3964					ZZ1==0
  3965					IFIDN < > < >,<ZZ1==1>
  3966					IFIDN <	> < >,<ZZ1==1>
  3967					IFN ZZ1,<STOPI>
  3968					IFE ZZ1,<
  3969					ZZ==ZZ_6
  3970					ZZ==ZZ+' '
  3971				>;END IFE ZZ1
  3972				
  3973				
  3974				;END IRPC MOVEM T1,(M)	
  3975					IRP 
  3976				
  3977					IFE <ZZ-'POP'>,<GINST==<PXCT PX.MEM,[MOVEM T1,(M)	]>>
  3978				
  3979				
  3980				
  3981					IFE <ZZ-'BLT'>,<GINST==<PXCT PX.MEM,[MOVEM T1,(M)	]>>
  3982				
  3983				
  3984				;END IRP POP,BLT
  3985				
  3986					PURGE ZZ1
  3987				^
  3988					GINST
  3989					PURGE GINST
  3990				^^;STORE IN USER'S AREA.
  3991	004140'	322300	005101'			    POPJ   P,]		;AND RETURN.
  3992	004141'	200306	000000		MOVE	T1,DEVNAM(T1)		;YES, GET NAME, (ELSE RET 0)
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 49-6
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  3993					UMOVEM	T1,(M)			;MOVE TO USER'S AREA.
  3994	004142'	256200	004774'
  3995	004143'	254000	003605*		JRST	CPOPJ1			;AND SKIP RETURN.
  3996
  3997				; GETLNK--FOR LINKED GETTAB. SCAN LIST STRUCTURE
  3998				;  & RETURN VALUES. USED FOR TEMP DEBUGGING TABLES
  3999				;  PUT IN MONITOR.  USED AS FOLLOWS:
  4000				;  MOVE AC,[EVEN'INDEX,,-36]
  4001				;  GETTAB AC,
  4002				;   OOPS
  4003				;  RETURN AC=SIXBIT TABLEE NAME.  DO  I WANT THIS TABLE?
  4004				;  NO..EVEN'INDEX:=EVEN'INDEX+2 & GETTAB AGAIN
  4005				;  YES..EVEN'INDEX:=EVEN'INDEX+1
  4006				;  GETTAB AC,
  4007				;   ..
  4008				;  RETURN AC=DATA FROM TABLE PREVIOUSLY NAMED
  4009
  4010				COMMENT !   DATA STRUCTURE:
  4011				1. A LINKED (IN RH) LIST OF 2-WD HEADER BLOCKS BEGINNING
  4012				  AT LNKHED, INITIALIZED BY LOADER.  LAST RH=0.  FORMAT OF
  4013				  HEADER BLOCK:
  4014				2. HEADER: XWD COUNT,NEXT'HEADER  (COUNT IS SIZE OF NAME & VALUE TABLES)
  4015					XWD NAME'TABLE,VALUE'TABLE
  4016				3. FORMAT OF NAME'TABLE:
  4017					NAME'TABLE: SIXBIT /NAME/	(I.E., /JBTXXX/, ETC.)
  4018					SIXBIT /NAME/
  4019					..
  4020					.. (TOTAL OF COUNT ENTRIES)
  4021				4. FORMAT OF VALUE TABLE ANALAGOUS
  4022				!
  4023	004144'	205300	240000	GETLNK:	MOVSI	T1,LICSYS!LICSPY
  4024	004145'	200340	003242*		MOVE	T2,JOB
  4025	004146'	616307	003325*		TDNN	T1,JBTLIC(T2)
  4026	004147'	263040	000000		  POPJ	P,		;NEED SYSTAT LIC
  4027	004150'	550340	004171'		HRRZ	T2,LNKHED	;GET POINTER TO LIST
  4028	004151'	322340	003516*	LNKLP:	JUMPE	T2,CPOPJ	;COUNT TOO BIG, NON-SKIP RETURN
  4029	004152'	554307	000000		HLRZ	T1,(T2)		;GET COUNT
  4030	004153'	242300	000001		LSH	T1,1		;*2 FOR NAMES
  4031	004154'	315100	000006		CAMGE	J,T1
  4032	004155'	254000	004161'		  JRST	LNKFND		;THIS IS THE RIGHT PLACE
  4033	004156'	274100	000006		SUB	J,T1		;DECREASE DESIRED COUNT
  4034	004157'	550347	000000		HRRZ	T2,(T2)
  4035	004160'	254000	004151'		JRST	LNKLP		;AND CONTINUE
  4036
  4037	004161'	241100	777777	LNKFND:	ROT	J,-1		;DIVIDE BY 2 AND REM TO HIGH BIT
  4038	004162'	331000	000002		SKIPL	J		;SEE IF EVEN OR ODD
  4039	004163'	334307	000001		  SKIPA	T1,1(T2)	;EVEN, NAME POINTER
  4040	004164'	554307	000001		 HLRZ	T1,1(T2)	;ODD, DATA POINTER
  4041	004165'	270300	000002		ADD	T1,J
  4042	004166'	200306	000000		MOVE	T1,(T1)
  4043	004167'	256200	004774'		UMOVEM	T1,(M)		;INFO TO USER'S AREA.
  4044	004170'	254000	004143*		JRST	CPOPJ1		;AND SKIP RETURN.
  4045
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 49-7
UUOCON.MAC	 4-DEC-87 16:09		DATUUO - Convert date formats

  4046	004171'	000000	000000	LNKHED:	0
  4047					.ELINK 1,LNKHED	;SET UP LINK
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 50
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4048				SUBTTL XCHARG
  4049
  4050				EXTERNAL SAVCHG,CHGSIZ,UPTCHG
  4051
  4052				COMMENT ! XCHARG UUO SEVERAL FUNCTIONS
  4053
  4054				CALL:	MOVE AC,[-COUNT,,ADDR]
  4055					XCHARG AC,
  4056					 ERROR RTN, AC/CODE FUNCTIONS 4 OR 5 ONLY
  4057					OK RTN, AC/UNCHANGED
  4058				LOC:	FUNCTION NUMBER
  4059					BITMASK,SOME FUNCTIONS
  4060					TABLE SPACE
  4061					.	.
  4062					.	.
  4063				LICENSE: SOME FUNCTIONS REQUIRE XC LICENSE
  4064
  4065				DESTROYS: PRACTICALLY ALL AC'S
  4066
  4067				!
  4068
  4069
  4070
  4071
  4072	004172'	256200	004745'	XCHARG:	UMOVE	T2,(T1)	;CODE
  4073	004173'	331000	000007		SKIPL	T2
  4074	004174'	301340	000010		CAIL	T2,XCHFUN	;SEE IF IN RANGE
  4075	004175'	263040	000000		  POPJ	P,
  4076	004176'	260040	003557*		PUSHJ	P,TIMADJ	;UPDATE CLOCK CHARGES BEFORE
  4077								;ANY READ,RESET,ETC.
  4078	004177'	256007	004200'		XCT	XCHFNT(T2)
  4079
  4080	004200'	254000	004236'	XCHFNT:	JRST	XCHSAV		;SAVE (0)
  4081	004201'	254000	004247'		JRST	XCHRED		;READ SAVED (1)
  4082	004202'	254000	004266'		JRST	XCHCRD		;READ CURRENT (2)
  4083	004203'	254000	004151*		JRST	CPOPJ		;NO-OP. WAS RESET CHARGES (3) JRST XCHRST
  4084	004204'	254000	004323'		JRST	XCHF4		;RESET & SAVE CHARGES (4). USE USER DATA
  4085	004205'	254000	004470'		JRST	XCHF5		;FN 5,TRANSACTION CHARGE RECORD
  4086	004206'	254000	004525'		JRST	XCHF6		;FN 6 TRU COMPONENT CHECKPOINT RECORD
  4087	004207'	254000	004560'		JRST	XCHSCA		;FN 7, TRU Scaling
  4088			000010	XCHFUN==.-XCHFNT
  4089
  4090	004210'	400002	004003*	XCHCTB:	400000,,JBTCPU(J)	;SIGN BIT SEZ "WORD 1 OF D.P. VALUE".
  4091	004211'	000002	004004*		JBTKCT(J)
  4092	004212'	400002	003610*		400000,,JBTCP2(J)	;MICROCYCLES NOW D.P. P031
  4093	004213'	000002	003611*		JBTCMP(J)
  4094	004214'	000002	004053*		JBTELP(J)
  4095	004215'	000002	004071*		JBTBCS(J)
  4096	004216'	000002	003644*		JBTCIN(J)
  4097	004217'	000002	003643*		JBTCOT(J)
  4098	004220'	000002	003662*		JBTBET(J)
  4099	004221'	000002	003671*		JBTBIO(J)
  4100	004222'	000002	004107*		JBTSER(J)
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 50-2
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4101	004223'	000002	004111*		JBTSLK(J)
  4102	004224'	000002	004113*		JBTSIN(J)
  4103	004225'	000002	004114*		JBTSOT(J)
  4104	004226'	000002	003734*		JBTERN(J)
  4105	004227'	000002	003736*		JBTDLK(J)
  4106	004230'	000002	003740*		JBTRCT(J)
  4107	004231'	000002	003741*		JBTWCT(J)
  4108	004232'	000002	003700*		JBTMPC(J)
  4109	004233'	000002	003716*		JBTPWS(J)
  4110	004234'	400002	004027*		400000,,JBTPWH(J)
  4111	004235'	000002	004030*		JBTPWL(J)
  4112
  4113			000026	XCHFLN==.-XCHCTB
  4114
  4115	004236'	205300	777752	XCHSAV:	MOVSI	T1,-XCHFLN	;NUMBER OF SOURCES
  4116	004237'	205340	000000*		MOVSI	T2,-CHGSIZ	;NUMBER OF SAVES
  4117	004240'	205400	000553*		MOVSI	T3,SAVCHG
  4118	004241'	436400	000000*		IORM	T3,%UPT+UPTSTS	;SAVE IN STATUS WORD
  4119	004242'	200426	004210'	XCHSV1:	MOVE	T3,@XCHCTB(T1)
  4120	004243'	202407	000000*		MOVEM	T3,%UPT+UPTCHG(T2)
  4121	004244'	252340	004170*		AOBJP	T2,CPOPJ1
  4122	004245'	253300	004242'		AOBJN	T1,XCHSV1
  4123	004246'	254000	004244*		JRST	CPOPJ1		;DON'T OVERRUN EITHER
  4124
  4125	004247'	252300	004203*	XCHRED:	AOBJP	T1,CPOPJ	;NUMBER REQUESTED
  4126	004250'	256200	004745'		UMOVE	T2,(T1)
  4127	004251'	205400	777752		MOVSI	T3,-XCHFLN
  4128	004252'	205440	004240*		MOVSI	T4,SAVCHG
  4129	004253'	616440	000000*		TDNN	T4,%UPT+UPTSTS
  4130	004254'	263040	000000		  POPJ	P,		;NOTHING SAVED
  4131	004255'	607340	400000	XCHRD1:	TLNN	T2,(1B0)
  4132	004256'	254000	004262'		  JRST	XCHRD2
  4133	004257'	200450	000000*		MOVE	T4,%UPT+UPTCHG(T3)
  4134	004260'	252300	004246*		AOBJP	T1,CPOPJ1
  4135	004261'	256200	005125'		UMOVEM	T4,(T1)
  4136	004262'	242340	000001	XCHRD2:	LSH	T2,1
  4137	004263'	322340	004260*		JUMPE	T2,CPOPJ1
  4138	004264'	253400	004255'		AOBJN	T3,XCHRD1
  4139	004265'	254000	004263*		JRST	CPOPJ1
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 51
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4140	004266'	252300	004247*	XCHCRD:	AOBJP	T1,CPOPJ	;GET BITS
  4141	004267'	256200	004745'		UMOVE	T2,(T1)
  4142	004270'	205400	777752		MOVSI	T3,-XCHFLN
  4143	004271'	607340	400000	XCHCR1:	TLNN	T2,(1B0)
  4144	004272'	254000	004276'		  JRST	XCHCR2
  4145	004273'	200470	004210'		MOVE	T4,@XCHCTB(T3)
  4146	004274'	252300	004265*		AOBJP	T1,CPOPJ1
  4147	004275'	256200	005125'		UMOVEM	T4,(T1)
  4148	004276'	242340	000001	XCHCR2:	LSH	T2,1
  4149	004277'	322340	004274*		JUMPE	T2,CPOPJ1
  4150	004300'	253400	004271'		AOBJN	T3,XCHCR1
  4151	004301'	254000	004277*		JRST	CPOPJ1
  4152
  4153				COMMENT ! ;-CHANGE SEPT 76 A.ATKINSON TO WRITE STREAM
  4154				XCHRST:	MOVSI	T2,LICXC	;CAN HE DO IT
  4155					TDNN	T2,JBTLIC(J)
  4156					  POPJ	P,		;NO
  4157					AOBJP	T1,CPOPJ	;NO BITS
  4158					UMOVE	T2,(T1)
  4159					MOVSI	T3,SAVCHG
  4160					TDNN	T3,%UPT+UPTSTS
  4161					  POPJ	P,		;CHARGES NOT SAVE SINCE LAST RESET
  4162					AOBJP	T1,XCHRS0
  4163					UMOVE	T3,(T1)		;GET SOAK CHARGE
  4164					MOVE	T1,T3		;GET A COPY
  4165					ADD	T3,JBTSOK(J)
  4166					JUMPLE	T3,XCHRS0
  4167					MOVEM	T3,JBTSOK(J)
  4168					ADDM	T1,JBTSOK
  4169				XCHRS0:	MOVSI	T1,-CHGSIZ
  4170					MOVSI	T3,-XCHFLN
  4171					TLNE	T2,(3B1)
  4172					  TLO	T2,(3B1)	;THESE MUST BOTH BE TOGETHER (DOUBLE PRECISION WORDS)
  4173				XCHRS1:	TLNN	T2,(1B0)
  4174					  JRST	XCHRS2
  4175					MOVE	T4,%UPT+UPTCHG(T1)
  4176					MOVEM	T4,@XCHCTB(T3)
  4177				XCHRS2:	AOBJP	T3,CPOPJ1
  4178					AOBJP	T1,CPOPJ1
  4179					LSH	T2,1
  4180					JUMPN	T2,XCHRS1
  4181					JRST	CPOPJ1
  4182				;-NOW FOLLOWS CODE TO DO ABOVE FUNCTION PLUS WRITE ACT REC
  4183				!
  4184				REPEAT 0,<	;REMOVE THIS FUNCTION. AAA 15 NOV
  4185				XCHRST:	MOVSI	T2,LICXC
  4186					TDNN	T2,JBTLIC(J)
  4187					  POPJ	P,
  4188					AOBJP	T1,CPOPJ
  4189					UMOVE	P2,(T1)	;-P2:=USER BITMASK
  4190					MOVSI	T3,SAVCHG
  4191					TDNN	T3,%UPT+UPTSTS
  4192					  POPJ	P,		;-DIDNT SAV CHGS
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 51-2
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4193					AOSE	ACREQ		;-IF ANYONE WAITING ON ACT DEVICE,
  4194					PUSHJ	P,ACWAIT	;-WE WAIT TOO
  4195					PUSH	P,T1		;-SAV FOR XCHRS0
  4196					MOVEI	P1,XCHARL	;SIZE REC WE'D LIKE TO WRITE
  4197					PUSHJ	P,BACTJB	;-MAY WE WRITE ACT?
  4198					 JRST	[SETO U,	;-NO. U:=FLAG NO ACT & GO
  4199						 JRST XCHRS0]	;-DO THE UUO WITHOUT ACT RECORD
  4200					 JRST	[JFCL ACREQ	;-CANT WRITE AT THE MOMENT,
  4201						 PUSHJ P,ACWAIT	;-WAIT TIL BUFF EMPTIED BY
  4202						 JRST .+1]	;-ACT OWNER, THEN CONTINUE
  4203				;-DOUBLE SKIP RTN, CAN WRITE IMMEDIATELY.
  4204					SETZ	U,		;-U:=FLAG "YES", DO UUO WITH ACT RECORD
  4205				XCHRS0:	POP	P,T1		;-USER ARG PTR
  4206					AOBJP	T1,XCHRS1	;-GO AHEAD IF NO SOAKEM VALUE
  4207					UMOVE	T3,(T1)		;-SOAKEM VALUE TO
  4208					ADD	T3,JBTSOK(J)	;-ADD TO SOAKEM
  4209					JUMPLE	T3,XCHRS1
  4210					MOVEM	T3,JBTSOK(J)
  4211					UMOVE	T3,(T1)
  4212					ADDM	T3,JBTSOK
  4213				;-WRITE 4-WD HEADER PART OF ACT RECORD
  4214				XCHRS1:	JUMPL	U,XCHRS2	;U=-1 IF NOT DOING ACT REC
  4215					PUSHJ	P,CBLAMB	;-T1:=LENGTH,T2:=LOC OF BUFFER SPACE
  4216					MOVEI	T3,XCHTAR	;-XCHARG REC TYPE
  4217					MOVEI	T4,XCHARL	;-&LENGTH
  4218					PUSHJ	P,WACRHW	;-WRITE  HEADER WORDS,RETURN T1,T2
  4219								;-FOR MORE WRITING IN ACTBUF
  4220					MOVE	T3,JBTNAM(J)	;-WHO IS GIVING AWAY TRU'S?
  4221					PUSHJ	P,PUTBUF	;-RECORD IT
  4222					MOVE	T3,JBTFPN(J)
  4223					PUSHJ	P,PUTBUF
  4224					MOVE	T3,JBTSOK(J)
  4225					PUSHJ	P,PUTBUF
  4226				XCHRS2:	MOVSI	P1,-CHGSIZ	;-SET UP LOOP CONTROL
  4227					MOVSI	P3,-XCHFLN
  4228				
  4229				;-IN THE FOLLOWING CODE, REGISTER ASSIGNMENTS ARE:
  4230				;-P1: AOBJN INDEX IN UPT ARRAY
  4231				;-P3: AOBJN INDEX IN XCHCBT ARRAY
  4232				;-T1: LENGTH OF REMAINING ACTBUF AREA, AS RET'D BY CBLAMB
  4233				;-T2: LOC OF THIS BLOCK,
  4234				;-T3: DATA VALUE PASSED TO PUTBUF TO STORE IN ACTBUF
  4235				;-T4: SECOND HALF OF DOUBLE-PREC. VALUES, FIRST IN T3.
  4236				;-U: FLAG -1 IF NO ACT WRITE,0 IF YES
  4237				;-P2: USER'S BITMASK OF VALUES TO BE RESET
  4238				
  4239				;-IF BITMASK VALUE IS 0 (RESET NOT DESIRED FOR THIS COMPONENT)
  4240				;-THEN JBT'S ARE RESET WITH THEMSELVES & 0 WRITTEN TO ACTBUF.
  4241				
  4242				XCHRS3:	SKIPG	XCHCTB(P3)	;SKIP IF SINGLE-PRECISION COMPONENT
  4243					  JRST	XCHRSD		;DOUBLE
  4244					TLNN	P2,(1B0)
  4245					  SKIPA	T4,@XCHCTB(P3)	;FORCE DIFF=0 & NO RESET
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 51-3
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4246					MOVE	T4,%UPT+UPTCHG(P1)
  4247					MOVE	T3,@XCHCTB(P3)
  4248					SUB	T3,T4
  4249					SKIPL	U		;ACT WRITE WANTED?
  4250					PUSHJ	P,PUTBUF	;YES.T3=DIFF OR ZERO TO ACTBUF
  4251					MOVEM	T4,@XCHCTB(P3)	;RESET OR RESTORE JBT
  4252				
  4253				;-LOOP TEST
  4254				XCHRLT:	AOBJP	P1,XCHRFA	;FINISH ACTBUF IF UPT DONE
  4255					LSH	P2,1		;NEXT BIT IN USER MASK
  4256					AOBJN	P3,XCHRS3	;LOOP WHILE XCHCTB VALUES REMAIN,THEN FALL THRU
  4257				;-FINISH ACT
  4258				XCHRFA:	JUMPL	U,CPOPJ1	;-IF NO ACT,DONE SKIP RTN
  4259					SETZ	T3,		;-0 TO FINISH OUT XCHARG RECORD
  4260				;-WHILE P3=XCHFLN INDEX NOT FINISHED,WRITE ZEROS TO
  4261				;-COMPLETE XCHARL- WORD RECORD
  4262				;-WHEN DONE, FINACB IN ACTSER CLEAN UP & UNINTERLOCK
  4263				XCHRF2:	AOBJP	P3,FINACB
  4264					PUSHJ	P,PUTBUF	;PUT 0
  4265					JRST	XCHRF2
  4266				
  4267				;-XCHRSD..DOUBLE PRECISION ROUTINE. VALUES D.P. IN XCHCTB
  4268				;-HAVE 1ST WORD FLAGGED IN XCHCBT SIGN BIT.
  4269				
  4270				XCHRSD:	TLNN	P2,(3B0)	;SKIP IF EITHER OF 2 WDS OF DP IS TO BE RESET
  4271					 JRST	[PUSH P,@XCHCTB(P3);PUT CURRENT VALUE INTO
  4272						 PUSH P,@XCHCTB+1(P3);-1(P) HIGH,(P) LOW ORDER,
  4273						 JRST XCHRD0]	;FORCE DIFF=0 & NO UPDATE
  4274					PUSH	P,%UPT+UPTCHG(P1)
  4275					PUSH	P,%UPT+UPTCHG+1(P1)	;SAVED INTO -1(P),(P)
  4276				XCHRD0:	MOVE	T3,@XCHCTB(P3)
  4277					MOVE	T4,@XCHCTB+1(P3)
  4278					SUB	T4,(P)		;LOW ORDER-LOW
  4279					SUB	T3,-1(P)	;HI - HI
  4280					TLZE	T4,(1B0)	;TEST/RESET CARRY,SKIP IF NONE
  4281					  SUBI	T3,1
  4282				;NOW T3/T4=D.P. DIFFERENCE (OR ZERO IF P2&3B0=0), -1(P)/(P)=
  4283				;RESET/RESTORE VALUE
  4284					JUMPL	U,XCHRD1	;WANT ACT WRITE,JUMP IF NO
  4285					PUSHJ	P,PUTBUF	;HI ORDER TO ACTBUF
  4286					MOVEM	T4,(T2)		;LOW ORDER TO BUF
  4287					PUSHJ	P,MORBUF	;ADVANCE PTR ONE
  4288				XCHRD1:	POP	P,@XCHCTB+1(P3)	;RESET/RESTORE LOW ORDER TO JBT'S
  4289					POP	P,@XCHCTB(P3)	;HI ORDER
  4290				;ADVANCE P1 P2 P3 ONE TO ACCOUNT FOR 2ND WORD OF DP PAIR
  4291					AOBJP	P1,.+1
  4292					AOBJP	P3,.+1
  4293					LSH	P2,1
  4294					JRST	XCHRLT		;NOW PERFORM LOOP TEST
  4295				>;END REPEAT 0 TO REMOVE XCHRST FN 3
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 52
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4296				;XCHF4..RESET CHARGES, USING VALUES FROM USER. PERFORM
  4297				;	SIMULTANEOUS SAVE OF NEW VALUES (IMPLICIT FN 0).
  4298				;	REQUIRE THAT CURRENT.GE. USER .GE. SAVED  FOR
  4299				;	EVERY COMPONENT TOUCHED. IF THIS IS UNTRUE, NO
  4300				;	CHANGE TO CURRENT OR SAVED FOR THAT COMPONENT.
  4301
  4302				;-EXTERNALS FROM ACTSER & SCHEDULER
  4303				EXTERNAL GETABS,FINACB,PUTBUF,MORBUF,WACRHW
  4304			000036	XCHARL==XCHFLN+^D8	;XCHARG REC LENG=
  4305				;	5 HEADER WRDS
  4306				;	1 JBTNAM
  4307				;	1 JBTFPN
  4308				;	1 JBTSOK
  4309				;  XCHFLN  DIFFERENCES
  4310
  4311
  4312				INTERNAL XCHARL ;REF'D IN ACTSER CODE
  4313			000010	XCHTAR==10		;XCHARG ACT REC TYPE
  4314
  4315				;ERROR RETURNS.
  4316	004302'	265740	004310'	XCF4NL:	JSP	P4,XC4FR	;NO LIC (0)
  4317	004303'	265740	004310'	XCF4NS:! JSP	P4,XC4FR	;NO PREVIOUS SAVE (1)
  4318	004304'	265740	004310'	XCF4NA:! JSP	P4,XC4FR	;NO ACCT'G (2) .. SYS UP FOR FREE
  4319	004305'			XCF4BC:!			;BAD COMPONENT (3) HANDLED SPECIALLY
  4320	004305'	265740	004310'	XCF7BC:! JSP	P4,XC4FR	;Except for fn 7
  4321	004306'	265740	004310'	XCF4BA:! JSP	P4,XC4FR	;BAD AC (4)
  4322	004307'	265740	004310'	XCF4BB:! JSP	P4,XC4FR	;BAD BITMASK (5)
  4323	004310'	275740	004303'	XC4FR:!	SUBI	P4,XCF4NL+1
  4324	004311'	256200	005126'		XCTBU	<HRRZM P4,(M)>	;MOVE ERR CODE RH P4 TO USER AC
  4325	004312'	263040	000000		POPJ	P,
  4326
  4327	004313'	000000	000000	UBMASK:	Z	;USERS BITMASK
  4328	004314'	000000	000000	XCBADC: Z	;FOR SAVE BAD COMPONENT BIT POSITIONS FOUND
  4329
  4330				DEFINE CURRENT(OFFSET<0>)<@XCHCTB+OFFSET(P3)>
  4331				DEFINE SAVVAL(OFFSET<0>)<%UPT+OFFSET+UPTCHG(P1)>
  4332				DEFINE HISAV <%UPT+UPTCHG(P1)>
  4333				DEFINE LOSAV <%UPT+UPTCHG+1(P1)>
  4334
  4335				;REGISTER ASSIGN IN LOOP WHICH DOES THE WORK:
  4336				; P4-TRAVELLING BIT FOR UBMASK TEST
  4337				; P3-XCHCTB AOBJN
  4338				; P2-USER AOBJN
  4339				; P1-UPT AOBJN
  4340
  4341				;T1-CBLAMB/PUTBUF/MORBUF BLOCK SIZE
  4342				;T2-BLOCK ADDRESS WITHIN ACTBUF
  4343				;T3-
  4344				;T4-WORKING STORAGE. T3 IS ARG TO PUTBUF
  4345				;M- USER AC #
  4346				;U-DATA FOR DP COMPARE
  4347				;PG- DATEA FOR DP COMPARE
  4348
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 52-2
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4349				;NAMES OF REGISTERS FOR HELP IN UNDERSTANDING CODE. NOTE U,PG
  4350			000010	HICUR==T3
  4351			000011	LOCUR==T4
  4352			000005	HIUSR==U
  4353			000003	LOUSR==PG	;U,PG ARE NOT  CONSECUTIVE
  4354
  4355				;HERE WHEN A SINGLE PRECISION COMPONENT IS BAD
  4356	004315'	436740	004314'	.XCBSP:	IORM	P4,XCBADC	;RECORD WHICH COMPONENT WAS BAD
  4357	004316'	403400	000011		SETZB	HICUR,LOCUR
  4358	004317'	254000	004412'		JRST	.XCACCT
  4359				;HERE IF BAD DP COMP
  4360	004320'	436740	004314'	.XCBDP:	IORM	P4,XCBADC
  4361	004321'	403400	000011		SETZB	HICUR,LOCUR
  4362	004322'	254000	004460'		JRST	.XCDACCT
  4363
  4364	004323'	205340	000200	XCHF4:	MOVSI	T2,LICXC
  4365	004324'	616342	004146*		TDNN	T2,JBTLIC(J)
  4366	004325'	254000	004302'		  JRST	XCF4NL		;ERR RTN 0
  4367	004326'	252300	004306'		AOBJP	T1,XCF4BA	;T1:= -(COUNT-1),,LOC+1
  4368	004327'	574340	000006		HLRE	T2,T1		;T2/-(COUNT-1)
  4369	004330'	213000	000007		MOVNS	T2
  4370	004331'	271346	777777		ADDI	T2,-1(T1)	;T2/ADDR LAST WD IN ARG BLK
  4371	004332'	256200	004711'		UMOVE	T2,(T2)		;MAKE SURE CAN READ IT
  4372	004333'	256200	004745'		UMOVE	T2,(T1)		;T2:=USER BITMASK
  4373	004334'	554400	000006		HLRZ	T3,T1		;BEGIN CHECKOUT COUNT,MASK
  4374	004335'	305400	777775		CAIGE	T3,-3		;T3=0,,7777XX E=0,,777775
  4375	004336'	307400	777750		CAIG	T3,-XCHFLN-2	;-(XCHFLN+1) .LE. COUNT .LE. -4
  4376	004337'	254000	004306'		  JRST	XCF4BA		;COUNT BAD
  4377	004340'	205440	400000		MOVSI	T4,(1B0)	
  4378	004341'	240450	000000		ASH	T4,(T3)
  4379	004342'	410440	000007		ANDCA	T4,T2
  4380	004343'	326440	004307'		JUMPN	T4,XCF4BB	;YES IF T4#0
  4381	004344'	205400	004252*		MOVSI	T3,SAVCHG	;CHECK IF PREVIOUS SAVE,
  4382	004345'	616400	000000*		TDNN	T3,%UPT+UPTSTS	;XCHARG FN 0
  4383	004346'	254000	004303'		  JRST	XCF4NS		;NO,COMPLAIN
  4384	004347'	261040	000006		PUSH	P,T1		;USER AOBJN,SAVE FROM GETACB
  4385	004350'	261040	000007		PUSH	P,T2		;USER BITMASK, SAVE
  4386	004351'	201600	000036		MOVEI	P1,XCHARL	;LENGTH OF XCHARG RECORD
  4387				;MAY WE WRITE THE RECORD FOR THIS XCHARG
  4388	004352'	260040	000000*	XCHBAJ:	PUSHJ	P,GETABS	;GET SPACE IN ACT BUFFER
  4389					  JRST	[POP  P,T2	;UNWIND
  4390						 POP  P,T1
  4391	004353'	254000	005127'			 JRST XCF4NA]	;STREAM DEAD, FRETURN
  4392				;NOW CAN WRITE
  4393	004354'	260040	000000*	XCHF4A:	PUSHJ	P,CBLAMB	;T1:=SIZE,T2:=LOC OF BLOCK IN ACTBUF
  4394	004355'	201400	000010		MOVEI	T3,XCHTAR	;REC TYPE
  4395	004356'	201440	000036		MOVEI	T4,XCHARL	;LENGTH
  4396	004357'	260040	000000*		PUSHJ	P,WACRHW	;WRITE HEADER WDS
  4397	004360'	200402	003520*		MOVE	T3,JBTNAM(J)
  4398	004361'	260040	000000*		PUSHJ	P,PUTBUF
  4399	004362'	200402	003521*		MOVE	T3,JBTFPN(J)
  4400	004363'	260040	004361*		PUSHJ	P,PUTBUF
  4401	004364'	200402	003634*		MOVE	T3,JBTSOK(J)
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 52-3
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4402	004365'	260040	004363*		PUSHJ	P,PUTBUF
  4403				;PREPARE LOOP. RETREIVE USER AOBJN,BITMASK,SET MONITOR AOBJN'S
  4404	004366'	262040	004313'		POP	P,UBMASK
  4405	004367'	262040	000015		POP	P,P2		;USER AOBJN,WAS IN T1 BEFORE
  4406	004370'	252640	004371'		AOBJP	P2,.+1		;NOW P2 PTS AT 1ST COMPONENT
  4407	004371'	402000	004314'		SETZM	XCBADC
  4408	004372'	205700	777752		MOVSI	P3,-XCHFLN
  4409	004373'	205600	000000*		MOVSI	P1,-CHGSIZ
  4410	004374'	205740	400000		MOVSI	P4,(1B0)	;TRAVELLING BIT FOR MASK TESTS
  4411				;LOOP TOP
  4412	004375'	337016	004210'	XCF4L0:	SKIPG	XCHCTB(P3)	;SKIP IF SINGLE PRECISION
  4413	004376'	254000	004432'		  JRST	XCF4DP		;DOUBLE
  4414	004377'	612740	004313'		TDNE	P4,UBMASK	;SKIP IF NO RESET DESIRED THIS COMP
  4415	004400'	256200	005132'		  XCTFU	<SKIPA LOUSR,(P2)>
  4416	004401'	200176	004210'		MOVE	LOUSR,CURRENT
  4417				;LOUSR:=EITHER CURRENT OR USER
  4418	004402'	200454	000000*		MOVE	T4,SAVVAL
  4419	004403'	200436	004210'		MOVE	T3,CURRENT
  4420	004404'	317140	000010		CAMG	LOUSR,T3
  4421	004405'	315140	000011		CAMGE	LOUSR,T4
  4422	004406'	254000	004315'		  JRST	.XCBSP		;OUT OF RANGE,FLAG BAD COMP
  4423	004407'	202176	004210'		MOVEM	LOUSR,CURRENT
  4424	004410'	202154	000000*		MOVEM	LOUSR,SAVVAL
  4425	004411'	274400	000003		SUB	T3,LOUSR
  4426	004412'			.XCACCT:
  4427	004412'	260040	004365*		PUSHJ	P,PUTBUF	;RECORD DIFFERENCE
  4428				;LOOP TEST,USED FOR BOTH S.P. AND D.P.
  4429	004413'	252600	004417'	XCF4L1:	AOBJP	P1,XCF4L2
  4430	004414'	242740	777777		LSH	P4,-1		;TRAVELLING BIT MOVES DOWN ONW
  4431	004415'	252640	004417'		AOBJP	P2,XCF4L2
  4432	004416'	253700	004375'		AOBJN	P3,XCF4L0	;NEXT COMPONENT
  4433				;LOOP END
  4434				;FINISH ACT RECORD WITH 0'S
  4435	004417'	400400	000000	XCF4L2:	SETZ	T3,
  4436	004420'	252700	004423'		AOBJP	P3,XCF4L3
  4437	004421'	260040	004412*		PUSHJ	P,PUTBUF
  4438	004422'	254000	004417'		JRST	XCF4L2
  4439				;CLEAN UP ACTBUF,RETURN FROM XCHARG UUO SKIP IF NO BAD COMP
  4440	004423'	260040	000000*	XCF4L3:	PUSHJ	P,FINACB	;UNINTERLOCK,FIX BUFF PTRS
  4441	004424'	255000	000000		  JFCL			;ALWAYS SKIPS, IGNORE
  4442	004425'	336300	004314'		SKIPN	T1,XCBADC	;SEE IF BAD COMPONENTS HIT,FRETURN IF SO
  4443	004426'	254000	004301*		  JRST	CPOPJ1
  4444	004427'	435300	000003		IORI	T1,XCF4BC-XCF4NL;RETURN BITS 0-32=BITMASK, 33-35=CODE
  4445	004430'	256200	004774'		UMOVEM	T1,(M)
  4446	004431'	263040	000000		POPJ	P,
  4447
  4448				;CODE FOR DOUBLE-PRECISION COMPONENTS
  4449				;	EXECUTED INSTEAD OF CODE BETWEEN XCF4L0+2,XCF4L2
  4450
  4451	004432'	616740	004313'	XCF4DP:	TDNN	P4,UBMASK
  4452					 JRST	[MOVE HIUSR,CURRENT	;<@XCHCTB+0(P3)>
  4453						 MOVE LOUSR,CURRENT(1)	;<@XCHCTB+1(P3)>
  4454	004433'	254000	005133'			 JRST XCF4DA]
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 52-4
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4455	004434'	256200	005136'		UMOVE	HIUSR,(P2)
  4456	004435'	256200	005137'		UMOVE	LOUSR,1(P2)
  4457	004436'	200436	004210'	XCF4DA:	MOVE	HICUR,CURRENT		;<@XCHCTB+0(P3)>
  4458	004437'	200476	004211'		MOVE	LOCUR,CURRENT(1)		;<@XCHCTB+1(P3)>
  4459				;(HIUSR,LOUSR) NOW = USER VALUE OR CURRENT IF NO RESET DESIRED
  4460				;TEST IF CURRENT .GE. USER .GE. SAVED IS TRUE
  4461	004440'	316240	000010		CAMN	HIUSR,HICUR
  4462	004441'	317140	000011		CAMG	LOUSR,LOCUR
  4463	004442'	313240	000010		CAMLE	HIUSR,HICUR
  4464	004443'	254000	004320'		  JRST	.XCBDP		;BAD,USER .GT. CURRENT
  4465	004444'	316254	000000*		CAMN	HIUSR,HISAV
  4466	004445'	311154	000000*		CAML	LOUSR,LOSAV
  4467	004446'	315254	000000*		CAMGE	HIUSR,HISAV
  4468	004447'	254000	004320'		  JRST	.XCBDP		;BAD,USER .LT. SAVED
  4469	004450'	202254	000000*		MOVEM	HIUSR,SAVVAL
  4470	004451'	202154	000000*		MOVEM	LOUSR,SAVVAL(1)
  4471	004452'	202276	004210'		MOVEM	HIUSR,CURRENT		;<@XCHCTB+0(P3)>
  4472	004453'	202176	004211'		MOVEM	LOUSR,CURRENT(1)	;<@XCHCTB+1(P3)>
  4473	004454'	274440	000003		SUB	LOCUR,LOUSR
  4474	004455'	274400	000005		SUB	HICUR,HIUSR
  4475	004456'	623440	400000		TLZE	LOCUR,(1B0)
  4476	004457'	275400	000001		  SUBI	HICUR,1
  4477	004460'			.XCDACCT:
  4478	004460'	260040	004421*		PUSHJ	P,PUTBUF	;SAVE HI-ORDER DIFF
  4479	004461'	202447	000000		MOVEM	LOCUR,(T2)	;AND LOW
  4480	004462'	260040	000000*		PUSHJ	P,MORBUF	;ADVANCE T1,T2
  4481	004463'	242740	777777		LSH	P4,-1		;ADVANCE BIT & ALL AOBJN'S
  4482	004464'	252600	004465'		AOBJP	P1,.+1
  4483	004465'	252640	004466'		AOBJP	P2,.+1		;TO ACCOUNT FOR EXTRA
  4484	004466'	252700	004413'		AOBJP	P3,XCF4L1	;WORD ALREADY PROCESSED
  4485	004467'	254000	004413'		JRST	XCF4L1
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 53
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4486				;XCHARG FUNCTION 5 -- TRANSACTION RECORD OUTPUT
  4487
  4488			000017	TRNTAR==:17	;TRANSACTION RECORD TYPE NUMBER SEE ACTSER
  4489			000036	TRNARL==:36	;TRANS. ACCTG REC LENGTH
  4490			000010	TRNNHW==10	;TRANS. NUMBER HEADER WORDS
  4491
  4492			004302'	XCF5NL==XCF4NL	;NO LICENSE ERROR
  4493			004306'	XCF5BA==XCF4BA	;BAD AC ERROR
  4494			004304'	XCF5NA==XCF4NA	;NO ACCOUNTING ERROR
  4495
  4496	004470'			XCHF5:	;EXPECTING T1/USER -COUNT,,ADDR
  4497	004470'	205340	000200		MOVSI	T2,LICXC
  4498	004471'	616342	004324*		TDNN	T2,JBTLIC(J)
  4499	004472'	254000	004302'		  JRST	XCF5NL		;NO LICENSE
  4500	004473'	574340	000006		HLRE	T2,T1
  4501	004474'	313340	005140'		CAMLE	T2,[-2]
  4502	004475'	254000	004306'		  JRST	XCF5BA		;MINIMUM 2 (FUNCTION NO, 1 WORD DATA)
  4503	004476'	261040	000006		PUSH	P,T1		;SAVE USER AOBJN
  4504	004477'	201600	000036		MOVEI	P1,TRNARL	;GET TRNARL WORDS IN ACCTG DEVICE
  4505	004500'	260040	004352*		PUSHJ	P,GETABS	;AND RETURN F/ACTDDB SKIPPING IF CAN
  4506					  JRST	[POP P,T1	;USER AOBJN. NO ACCTG ACTIVE
  4507	004501'	254000	005130'			JRST XCF5NA]	;GIVE ERROR CODE
  4508				;NOW HAVE ACT DEVICE LOCKED DOWN
  4509	004502'	260040	004354*		PUSHJ	P,CBLAMB	;GET T2/LOC T1/COUNT OF ACTBUF BLOCK
  4510	004503'	201400	000017		MOVEI	T3,TRNTAR
  4511	004504'	201440	000036		MOVEI	T4,TRNARL
  4512	004505'	260040	004357*		PUSHJ	P,WACRHW	;WRITE ACT HEADER WORDS:HDR,DATE,ETC.
  4513	004506'	200402	004360*		MOVE	T3,JBTNAM(J)
  4514	004507'	260040	004460*		PUSHJ	P,PUTBUF	;DEPOSIT T3 ACCORDING TO T2,T1
  4515	004510'	200402	004362*		MOVE	T3,JBTFPN(J)
  4516	004511'	260040	004507*		PUSHJ	P,PUTBUF
  4517	004512'	200402	004364*		MOVE	T3,JBTSOK(J)
  4518	004513'	260040	004511*		PUSHJ	P,PUTBUF
  4519	004514'	262040	000015		POP	P,P2		;USER AOBJN
  4520	004515'	201600	000026		MOVEI	P1,TRNARL-TRNNHW
  4521				;P1/MONITOR COUNTER, ITEMS LEFT TO GO IN RECORD
  4522				;P2/USER POINTER, AFTER AOBJN PTS AT DATA TO LOAD NEXT
  4523				;T2/LOC FOR PUTBUF TO WRITE IN ACTBUF
  4524				;T1/LENGTH CURRENT ACTBUF BLOCK, FOR PUTBUF
  4525				;T3/ARG TO PUTBUF, DATA
  4526				;T4/SPARE
  4527
  4528	004516'	253640	004520'	XCF5L1:	AOBJN	P2,.+2		;IF USER DATA RUNS OUT BEFORE RECORD LENGTH,
  4529	004517'	634400	000010		TDZA	T3,T3		;PAD REC W/ZEROS
  4530	004520'	256200	005141'		  UMOVE	T3,(P2)
  4531	004521'	260040	004513*		PUSHJ	P,PUTBUF
  4532	004522'	367600	004516'		SOJG	P1,XCF5L1	;CONTINUE FOR RECORD LENGTH
  4533	004523'	256200	005142'		UMOVEM	P2,(M)		;RETURN UPDATED AOBJN TO USER
  4534	004524'	324740	004423*		PJRST	FINACB		;RELEASE ACT,UPDATE BUFF PTRS,SKIP RTN
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 54
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4535				;XCHARG FUNCTION 6 -- TRU COMPONENT CHECKPOINT
  4536
  4537			000021	TCCTAR==:21	;TCC RECORD TYPE NUMBER SEE ACTSER
  4538			000010	TCCNHW==10	;NUMBER HEADER WORDS
  4539			000041	TCCARL==:TCCNHW+XCHFLN+3	;TCC REC LENGTH
  4540
  4541			004302'	XCF6NL==XCF4NL	;NO LICENSE ERROR
  4542			004304'	XCF6NA==XCF4NA	;NO ACCTG ERROR CODE
  4543
  4544				COMMENT ! XCHARG FUNCTION 6 PUTS A RECORD IN THE STREAM WHICH LOGS THE
  4545				EXACT VALUE OF EACH TRU COMPONENT AND OTHER CHARGING VARIABLES
  4546				[CONNECT TIME ETC];  THE PURPOSE IS TO BE ABLE LATER TO
  4547				SCAN STREAM FILES AND DETERMINE WHICH PROGRAMS USE WHICH RESOURCES
  4548				SO AS TO BE ABLE TO PREDICT EFFECT OF CHANGING TRU ALGORITHM
  4549				COEFFICIENTS OR XCHARGING POLICIES.
  4550
  4551				THIS UUO SHOULDN'T BE ISSUED MORE THAN ONCE BETWEEN ANY RUN/RUNSEG
  4552				AND EXIT.
  4553
  4554				XC LICENSE IS REQUIRED
  4555
  4556				!
  4557
  4558	004525'			XCHF6:	;EXPECTS M/USER AC, J/JOB
  4559	004525'	200342	004471*		MOVE	T2,JBTLIC(J)
  4560	004526'	607340	000200		TLNN	T2,LICXC
  4561	004527'	254000	004302'		  JRST	XCF6NL		;NO LICENSE,SLAP HIS HAND
  4562	004530'	201600	000041		MOVEI	P1,TCCARL
  4563	004531'	260040	004500*		PUSHJ	P,GETABS	;TRY TO GET SPACE ON ACT DEV
  4564	004532'	254000	004304'		  JRST	XCF6NA		;CANT GET IT; ACT MUST BE DOWN
  4565				;NOW ACT DEVICE LOCKED DOWN FOR US
  4566	004533'	260040	004502*		PUSHJ	P,CBLAMB	;GET T2/LOC T1/COUNT OF ACTBUF BLOCK
  4567	004534'	201400	000021		MOVEI	T3,TCCTAR
  4568	004535'	201440	000041		MOVEI	T4,TCCARL
  4569	004536'	260040	004505*		PUSHJ	P,WACRHW	;WRITE HEADER FOR OUR REC TYPE,LENGTH
  4570	004537'	200402	004506*		MOVE	T3,JBTNAM(J)
  4571	004540'	260040	004521*		PUSHJ	P,PUTBUF	;CONTINUE HEADER SECTION
  4572	004541'	200402	004510*		MOVE	T3,JBTFPN(J)
  4573	004542'	260040	004540*		PUSHJ	P,PUTBUF
  4574	004543'	200402	004512*		MOVE	T3,JBTSOK(J)
  4575	004544'	260040	004542*		PUSHJ	P,PUTBUF
  4576
  4577				;TRANSFER TRU COMPONENT VALUES TO RECORD. EXPECTS J/JOB
  4578	004545'	205700	777752		MOVSI	P3,-XCHFLN	;XCHCTB LENGTH
  4579	004546'	200436	004210'	XCF6L1:	MOVE	T3,@XCHCTB(P3)
  4580	004547'	260040	004544*		PUSHJ	P,PUTBUF
  4581	004550'	253700	004546'		AOBJN	P3,XCF6L1
  4582
  4583				;TRANSFER CONNECT & DISPATCH BASE CHARGING PARAMETERS (NOT ACTUALLY
  4584				;PART OF TRU COMPUTATION, BUT USED IN CHARGING USER ANYWAY.
  4585
  4586	004551'	200402	003333*		MOVE	T3,JBTCNK(J)
  4587	004552'	260040	004547*		PUSHJ	P,PUTBUF
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 54-2
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4588				;*;	MOVE	T3,JBTRMT(J)
  4589	004553'	400400	000000		SETZ	T3,
  4590	004554'	260040	004552*		PUSHJ	P,PUTBUF
  4591				;*;	MOVE	T3,JBTRMC(J)
  4592	004555'	400400	000000		SETZ	T3,
  4593	004556'	260040	004554*		PUSHJ	P,PUTBUF
  4594	004557'	324740	004524*		PJRST	FINACB		;RELEASE ACT AND SKIP RETURN
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 55
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4595				;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  4596				;;								;;
  4597				;;	XCHARG Function 7 - Scale TRU's				;;
  4598				;;								;;
  4599				;;	Calling sequence:					;;
  4600				;;		MOVE	AC,[-count,addr]			;;
  4601				;;		XCHARG	AC,					;;
  4602				;;		  <error> /AC=error code (0 or 3)		;;
  4603				;;		<success return> /old JBTSCA(J) stored into	;;
  4604				;;				 /addr+2			;;
  4605				;;								;;
  4606				;;	addr:	7	;function code				;;
  4607				;;		BYTE (9) SC1,SC2,SC3,SC4			;;
  4608				;;		previous scaling word (stored if successful)	;;
  4609				;;								;;
  4610				;;	Where:	SC1 & SC2 are the numerator & denominator of an	;;
  4611				;;	integer fraction scaling factor (SC1/SC2) to be applied	;;
  4612				;;	to the non-kilocore (size-independent) portion of the	;;
  4613				;;	TRU function, and SC3 & SC4 are the numerator &		;;
  4614				;;	denominator of the kilocore (size-dependent) portion,	;;
  4615				;;	with the special case of SC3.GT.0 and SC4=0 indicating	;;
  4616				;;	that the value in SC3 should be substituted for the	;;
  4617				;;	current charging size in K.				;;
  4618				;;	The value of "count" is ignored.			;;
  4619				;;	Error if job does not have XC license			;;
  4620				;;		or if SC1.GT.0 and SC2=0.			;;
  4621				;;								;;
  4622				;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  4623
  4624				EXTERNAL JBTSCA
  4625
  4626			004302'		XCF7NL=XCF4NL
  4627
  4628	004560'			XCHSCA:
  4629	004560'	205340	000200		MOVSI	T2,LICXC	;XC license
  4630	004561'	616342	004525*		TDNN	T2,JBTLIC(J)	;Does it have it?
  4631	004562'	254000	004302'		  JRST	XCF7NL		;No, give error
  4632	004563'	256200	004746'		UMOVE	T2,1(T1)	;Get new scaling word
  4633	004564'	135400	005143'		LDB	T3,[POINT 9,T2,8] ;Check for special case
  4634	004565'	322400	004570'		JUMPE	T3,XCHSC1	;SC1=0, no matter what SC2 is
  4635	004566'	135400	005144'		LDB	T3,[POINT 9,T2,17] ;Pick up SC2
  4636	004567'	322400	004305'		JUMPE	T3,XCF7BC	;Bad component
  4637	004570'			XCHSC1:
  4638	004570'	250342	000555*		EXCH	T2,JBTSCA(J)	;Store new, load old
  4639	004571'	256200	005145'		UMOVEM	T2,2(T1)	;Store old into user's arg block
  4640	004572'	324740	004426*		PJRST	CPOPJ1
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 56
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4641
  4642				;-PUTSAR     PUT STREAM ACCOUNTING RECORD UUO.
  4643				;	A.ATKINSON NEW SEPT 76 WITH P031 MONITOR
  4644				;-CALL:	MOVEI AC,RECORD
  4645				;	PUTSAR AC,
  4646				;	 ERROR: AC=ERR CODE
  4647				;	OK RTN,AC PRESERVED
  4648
  4649			000003	BADSRT==3 ;BAD STR REC TYPE
  4650			000001	SRNLIC==1 ;NO LICENSE TO WRITE THIS ONE
  4651			000002	SRSZW==2  ;SIZE WRONG
  4652			000000	SRNAO==0  ;NO ACT OWNER, BUFFER FULL, SYS UP FOR FREE
  4653
  4654				;-RECORD FORMAT:
  4655				; WORD 0:	HEADER WORD: TYPE,BIT 0-8; SIZE, BITS 30-35
  4656				; WORD 1:	DATE WORD: MONITOR WILL DATE STAMP HERE
  4657				; WORD 2:	AUN OR OTHER DATA
  4658				; WORD 3:	TRU'S OR OTHER DATA
  4659				; WORDS 4 THRU SIZE-1 : DATA ACCORDING TO TYPE
  4660
  4661				;EXTERNALS FROM ACTSER,ETC.
  4662				EXTERNAL ACYSIZ,ACRTAB,ACYTYP,ACTDDB
  4663				EXTERNAL ACUTAB ;-USER PART OF ACRTAB
  4664				EXTERNAL ACURTL ;-LENG OF USER PART
  4665				EXTERNAL ACYMIN ;MIN SIZE IF REC VAR LEN ELSE ZERO
  4666				EXTERNAL UPTPJC,UPTPJ1,UPTPJ2 ;FROM COMMON
  4667
  4668	004573'	256200	005146'	PUTSAR:	UMOVE	P2,(T1)		;P2:=USER HEADER WORD
  4669	004574'	135700	005147'		LDB	P3,[POINT 9,P2,8];  P3:=PROPOSED TYPE
  4670				;SEARCH ACRTAB (ACTSER) FOR DESCRIPTOR FOR THIS TYPE.
  4671				;IF NOT FOUND,OR LICENSE BAD, OR SIZE WRONG,FRETURN
  4672	004575'	200400	005150'		MOVE	T3,[XWD -ACURTL,ACUTAB]
  4673	004576'	135340	000000*		LDB	T2,ACYTYP
  4674	004577'	312340	000016		CAME	T2,P3
  4675	004600'	253400	004576'		  AOBJN	T3,.-2
  4676	004601'	201740	000003		MOVEI	P4,BADSRT	;IN CASE NOT FOUND
  4677	004602'	327400	004636'		JUMPG	T3,PTSRFX	;NOT FOUND
  4678	004603'	510450	000000*		HLLZ	T4,ACRTAB(T3)
  4679	004604'	201740	000001		MOVEI	P4,SRNLIC	;IN CASE NO LIC
  4680	004605'	616442	004561*		TDNN	T4,JBTLIC(J)
  4681	004606'	254000	004636'		  JRST	PTSRFX		;NOT LICENSED TO WRITE THIS ONE
  4682	004607'	135600	000000*		LDB	P1,ACYSIZ
  4683	004610'	135340	005151'		LDB	T2,[POINT 6,P2,35];USER SIZE FIELD
  4684	004611'	201740	000002		MOVEI	P4,SRSZW	;IN CASE
  4685	004612'	312340	000014		CAME	T2,P1
  4686				          JRST	[LDB    T4,ACYMIN
  4687				                 JUMPE  T4,PTSRFX       ;ERROR IF REC LEN FIXED
  4688				                 CAML   T2,T4           ;YES: TOO SMALL OR
  4689						 CAMLE	T2,P1		; TOO LARGE?
  4690						   JRST	PTSRFX		;YES, ERROR
  4691						 MOVE	P1,T2		;SET REC SIZE TO THAT WHICH USER SUP
  4692	004613'	254000	005152'			 JRST	.+1]	;CONTINUE
  4693	004614'	271346	777777		ADDI	T2,-1(T1)	;T2/ADDR LAST WRD OF RECORD
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 56-2
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4694	004615'	256200	004711'		UMOVE	T2,(T2)		;MAKE SURE CAN GET IT
  4695	004616'	256200	005161'		XCTBU	<MOVES 1(T1)>	;MAKE SURE CAN WRITE DATE WORD
  4696				;SEE IF OK TO WRITE THIS RECORD. SIZE IN P1
  4697	004617'	200640	000006		MOVE	P2,T1		;P2 POINT TO USER DATA FROM NOW ON
  4698	004620'	260040	004531*	PTSBAJ:	PUSHJ	P,GETABS	;GET C(P1) ACT BUFFER SPACE
  4699					  JRST	[MOVEI P4,SRNAO	;ERR CODE FAIL PUTSAR
  4700	004621'	254000	005162'			 JRST  PTSRFX]	;STREAM DEAD.
  4701				;DATE STAMP RECORD IN USER MEMORY
  4702	004622'	200400	002475*	PTSR1:	MOVE	T3,TIME##
  4703	004623'	230400	002454*		IDIV	T3,JFYSEC##
  4704	004624'	504400	002476*		HRL	T3,THSDAT
  4705	004625'	256200	005164'		UMOVEM	T3,1(P2)	;WORD 1 OF RECORD
  4706				;MOVE USER BLOCK TO ACTBUF. P2 POINTS TO USER BLOCK
  4707	004626'	201200	000000*		MOVEI	F,ACTDDB
  4708	004627'	260040	004533*		PUSHJ	P,CBLAMB	;T2=LOC,T1=LENG OF CONTIGUOUS ACTBUF BLOCK
  4709	004630'	213000	000014		MOVNS	P1		;P1:= -SIZE USER REC
  4710	004631'	504640	000014		HRL	P2,P1		;P2:= -SIZ,,USER LOC
  4711	004632'	256200	005141'	PTSR2:	UMOVE	T3,(P2)
  4712	004633'	260040	004556*		PUSHJ	P,PUTBUF	;CALLS CBLAMB IF WRAPAROUND
  4713	004634'	253640	004632'		AOBJN	P2,PTSR2
  4714				;CLEAN UP ACTBUF, UNINTERLOCK & EXIT SKIPPING
  4715	004635'	324740	004557*		PJRST	FINACB		;IN ACTSER
  4716				;RETURN ERROR CODE FROM P4 TO USER AC
  4717	004636'	256200	005165'	PTSRFX:	UMOVEM	P4,(M)
  4718	004637'	254000	004266*		JRST	CPOPJ
  4719
  4720
  4721				COMMENT ! PUT ROYALTY STREAM RECORD UUO
  4722				EXPECTS: T1/ CONTENTS OF USER AC, BYTE(1)FLAG BYTE(35)ROYALTY ID
  4723					J/JOB
  4724				RETURNS: SKIPPING ON SUCCESS, NO SKIP IF CANNOT GET
  4725					SPACE IN ACT DEVICE BUFFER.
  4726				!
  4727
  4728			000020	ROYTAR==:20	;ROYALTY TYPE ACT RECORD SEE ACTSER
  4729			000011	ROYARL==:11	;ROYALTY ACT RECORD LENGTH
  4730
  4731
  4732	004640'			PUTROY::
  4733	004640'	261040	000006		PUSH	P,T1		;SAVE FLAG & ROYALTY ID
  4734	004641'	201600	000011		MOVEI	P1,ROYARL	;SEE IF WE CAN GET SPACE
  4735	004642'	260040	004620*		PUSHJ	P,GETABS	;TO WRITE ROYARL WORDS
  4736	004643'	254000	003221*		  JRST	TPOPJ		;CANNOT, POP OUT T1 AND NOSKIP RETURN
  4737				;NOW HAVE ACT DEVICE LOCKED DOWN
  4738	004644'	260040	004627*		PUSHJ	P,CBLAMB	;GET T2/LOC T1/COUNT OF ACTBUF FREE BLOCK
  4739	004645'	201400	000020		MOVEI	T3,ROYTAR
  4740	004646'	201440	000011		MOVEI	T4,ROYARL
  4741	004647'	260040	004536*		PUSHJ	P,WACRHW	;WRITE HEADER WORDS: HDR,DATE,TIME,ETC.
  4742	004650'	200402	004537*		MOVE	T3,JBTNAM(J)
  4743	004651'	260040	004633*		PUSHJ	P,PUTBUF	;DEPOSIT JBTNAM IN BUF,UPDATE T1,T2
  4744	004652'	200402	004541*		MOVE	T3,JBTFPN(J)
  4745	004653'	260040	004651*		PUSHJ	P,PUTBUF	;AND FPN
  4746	004654'	200402	004543*		MOVE	T3,JBTSOK(J)
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 56-3
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4747	004655'	260040	004653*		PUSHJ	P,PUTBUF
  4748	004656'	262040	000010		POP	P,T3		;RECOVER SAVED FLAG & ROYALTY ID
  4749	004657'	260040	004655*		PUSHJ	P,PUTBUF
  4750	004660'	324740	004635*		PJRST	FINACB		;RELEASE ACT DEVICE,CLEANUP BUFFER, SKIP RTN
  4751
  4752				COMMENT ! LSAUUO KERNEL -- GENERATE LOCAL STREAM ACCOUNTING RECORD
  4753				PURPOSE: ALLOW PROGRAM RUN OUT OF OWN UFD TO BE TRACKED IN
  4754					THE STREAM.
  4755				FUNCTION: WRITE TYPE 13 STREAM RECORD UNLESS USER HAS
  4756					ALREADY ISSUED THIS UUO ONCE SINCE THE LAST
  4757					RUN UUO/RUN CMD.   NOTE THAT IF PROGRAM IS RUN OUT
  4758					OF ANOTHER UFD, ORDINARY TYPE 0 RUN RECORD IS WRITTEN,
  4759					BUT THIS UUO WILL ALLOW 1 MORE TO GO IN, WITH
  4760					SPECIAL SIXBIT /IDENTIFIER/.
  4761				CALL:	MOVE	AC,[SIXBIT /IDENTIFIER/] (ANY 36 BITS OK)
  4762					CALLI	AC,-63
  4763					ALWAYS RETURN HERE, AC PRESERVED
  4764				NOTE: THESE /IDENTIFIER/'S SHOW UP IN STREAM AS THE PROGRAM
  4765					NAME. THERE MUST BE AGREEMENT AMONG TECH DIVISION
  4766					GROUPS ABOUT WHO USES WHAT /IDENTIFIER/ FOR CONFLICTS
  4767					TO BE AVOIDED.
  4768				!
  4769
  4770	004661'			LSAUUO::	;EXPECTS J/JOB, T1/C(USER AC)
  4771	004661'	261042	004650*		PUSH	P,JBTNAM(J)
  4772	004662'	332000	000006		SKIPE	T1		;IF USER PASSES 0, USE JBTNAM(J)
  4773	004663'	202302	004661*		  MOVEM	T1,JBTNAM(J)	;ELSE TEMPORARILY JBTNAM_IDENTIFIER
  4774	004664'	201300	000013		MOVEI	T1,13
  4775	004665'	260040	003523*		PUSHJ	P,ACTWRT	;GO WRITE TYPE 13 USING JBTNAM(J)
  4776	004666'	262042	004663*		POP	P,JBTNAM(J)
  4777	004667'	263040	000000		POPJ	P,
  4778
  4779	004670'	401000	000000		$END	(UUO)

  4780	004671'	260040	000000*

  4781	004672'	656557	524220

  4782	004673'	000001	000000

  4783	004674'	000000*	000000*

  4784	004675'	000000	000000

  4785	004676'	260040	004671*

  4786	004677'	656557	435664

  4787	004700'	000002	000000

  4788	004701'	260040	004676*

  4789	004702'	656557	635664
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 56-4
UUOCON.MAC	 4-DEC-87 16:09		XCHARG


  4790	004703'	000004	000000

  4791	004704'	331100	000013

  4792	004705'	331111	000072'

  4793	004706'	260040	004701*

  4794	004707'	656557	706754

  4795	004710'	000002	000000

  4796	004711'	200347	000000

  4797	004712'	202340	000000*

  4798	004713'	135300	000000*

  4799	004714'	260040	004665*

  4800	004715'	200340	000000*

  4801	004716'	623340	000000*

  4802	004717'	254000	000132'

  4803	004720'	623340	000000*

  4804	004721'	254000	000152'

  4805	004722'	607340	000000*

  4806	004723'	256200	004711'

  4807	004724'	603340	000000*

  4808	004725'	350000	000007

  4809	004726'	606340	777777

  4810	004727'	254000	000000*

  4811	004730'	250341	000000

  4812	004731'	502341	000000

  4813	004732'	256200	004712'

  4814	004733'	201300	040000

  4815	004734'	413302	003345*

UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 56-5
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4816	004735'	254000	000114'

  4817	004736'	400000	000000

  4818	004737'	200313	000000

  4819	004740'	777777	777627

  4820	004741'	200452	000000

  4821	004742'	331100	000006

  4822	004743'	000015	066705

  4823	004744'	000000	000001

  4824	004745'	200346	000000

  4825	004746'	200346	000001

  4826	004747'	200406	000002

  4827	004750'	256200	004745'

  4828	004751'	312340	000000*

  4829	004752'	263040	000000

  4830	004753'	256200	004746'

  4831	004754'	256200	004747'

  4832	004755'	316340	000000*

  4833	004756'	312400	000000*

  4834	004757'	263040	000000

  4835	004760'	254000	004572*

  4836	004761'	200346	000002

  4837	004762'	262040	000006

  4838	004763'	254000	001015'

  4839	004764'	221100	000006

  4840	004765'	202412	000000

  4841	004766'	200300	000014

  4842	004767'	260040	000000*
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 56-6
UUOCON.MAC	 4-DEC-87 16:09		XCHARG


  4843	004770'	254000	004760*

  4844	004771'	202353	000000

  4845	004772'	261053	000000

  4846	004773'	200353	000001

  4847	004774'	202313	000000

  4848	004775'	200413	000002

  4849	004776'	336353	000003

  4850	004777'	200613	000001

  4851	005000'	200553	000000

  4852	005001'	335007	000002

  4853	005002'	440700	001214'

  4854	005003'	343277	244615

  4855	005004'	001211'	000015

  4856	005005'	335313	000002

  4857	005006'	504353	000003

  4858	005007'	576045	620000

  4859	005010'	200413	000000

  4860	005011'	251554	777777

  4861	005012'	402013	000000

  4862	005013'	402013	000001

  4863	005014'	202253	000000

  4864	005015'	202413	000000

  4865	005016'	251353	000000

  4866	005017'	200253	000000

  4867	005020'	202113	000000

  4868	005021'	200446	000000

UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 56-7
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4869	005022'	200306	000001

  4870	005023'	200311	000000

  4871	005024'	260040	001637'

  4872	005025'	263040	000000

  4873	005026'	200406	000000

  4874	005027'	254000	001657'

  4875	005030'	200351	000001

  4876	005031'	200411	000002

  4877	005032'	412346	000000

  4878	005033'	436406	000000

  4879	005034'	254000	004770*

  4880	005035'	200753	000000

  4881	005036'	200313	000001

  4882	005037'	200353	000000

  4883	005040'	200753	000002

  4884	005041'	202313	000001

  4885	005042'	777777	777777

  4886	005043'	410300	000017

  4887	005044'	170300	000017

  4888	005045'	000000	250600

  4889	005046'	260040	000000*

  4890	005047'	645155	455753

  4891	005050'	400006	000000

  4892	005051'	000000	002443'

  4893	005052'	777777	777324

  4894	005053'	231300	000074

  4895	005054'	260040	002460*
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 56-8
UUOCON.MAC	 4-DEC-87 16:09		XCHARG


  4896	005055'	260040	002461*

  4897	005056'	203335	167352

  4898	005057'	723136	327000

  4899	005060'	263040	000000

  4900	005061'	200306	000000

  4901	005062'	202312	000000

  4902	005063'	202350	000001

  4903	005064'	506450	000000

  4904	005065'	440700	000000*

  4905	005066'	136340	000006

  4906	005067'	134340	000006

  4907	005070'	202352	000000

  4908	005071'	260040	004706*

  4909	005072'	631616	525742

  4910	005073'	000002	000000

  4911	005074'	260040	005071*

  4912	005075'	631616	435127

  4913	005076'	000003	004637*

  4914	005077'	001404	000001

  4915	005100'	202300	000000*

  4916	005101'	256200	004774'

  4917	005102'	263040	000000

  4918	005103'	334713	000000

  4919	005104'	200321	777776

  4920	005105'	000000	000004

  4921	005106'	201700	000006

UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 56-9
UUOCON.MAC	 4-DEC-87 16:09		XCHARG

  4922	005107'	254000	003122'

  4923	005110'	201700	000005

  4924	005111'	254000	003122'

  4925	005112'	201700	000002

  4926	005113'	254000	003122'

  4927	005114'	201700	000003

  4928	005115'	254000	003122'

  4929	005116'	201700	000004

  4930	005117'	254000	003122'

  4931	005120'	000000	003345'

  4932	005121'	331106	003345'

  4933	005122'	270406	003345'

  4934	005123'	446353	420000

  4935	005124'	000003	641100

  4936	005125'	202446	000000

  4937	005126'	552753	000000

  4938	005127'	262040	000007

  4939	005130'	262040	000006

  4940	005131'	254000	004304'

  4941	005132'	334155	000000

  4942	005133'	200276	004210'

  4943	005134'	200176	004211'

  4944	005135'	254000	004436'

  4945	005136'	200255	000000

  4946	005137'	200155	000001

  4947	005140'	777777	777776

  4948	005141'	200415	000000
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 56-10
UUOCON.MAC	 4-DEC-87 16:09		XCHARG


  4949	005142'	202653	000000

  4950	005143'	331100	000007

  4951	005144'	221100	000007

  4952	005145'	202346	000002

  4953	005146'	200646	000000

  4954	005147'	331100	000015

  4955	005150'	000000*	000000*

  4956	005151'	000600	000015

  4957	005152'	135440	000000*

  4958	005153'	322440	004636'

  4959	005154'	311340	000011

  4960	005155'	313340	000014

  4961	005156'	254000	004636'

  4962	005157'	200600	000007

  4963	005160'	254000	004614'

  4964	005161'	203006	000001

  4965	005162'	201740	000000

  4966	005163'	254000	004636'

  4967	005164'	202415	000001

  4968	005165'	202753	000000

  4969						;End of UUOCON (UUOLIT: UUOEND:)
  4970
NO ERRORS DETECTED
PROGRAM BREAK IS 005167
12K CORE USED
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 57
UUOCON.MAC	 4-DEC-87 16:09		SYMBOL TABLE

ABKUUO		000331'	EXT	CHPJC		000355'	EXT	DDBLDB		003055'	EXT	ERRNSA		004727'	EXT
ACCWAY		003122'		CI.OPR		000000	SPD	DDINT		000001	SIN	ERRPIO		000151'	EXT
ACJWAY		003135'		CKLCFL		001100'		DDIV	117000	000000		EVICT		000000	EXT
ACRTAB		004603'	EXT	CKLGO		002753'	EXT	DDTIN		000406'	EXT	EX0ACB		000001	SIN
ACTDDB		004626'	EXT	CLKTRP		000121'	EXT	DDTOUT		000407'	EXT	EXIT		000463'	
ACTWRT		004714'	EXT	CLKTRU		003606'	INT	DEC2YR		002046'		EXIT1		000474'	
ACURTL		000000	EXT	CLKTRX		004003'		DEVCHR		000001	SIN	EXTEND	123000	000000	
ACUTAB		005150'	EXT	CLRPT	701100	000000		DEVINT		000016	SIN	F		000004	INT
ACYMIN		005152'	EXT	CMWB		200000	SIN	DEVLST		001375'	EXT	FADL	141000	000000	
ACYSIZ		004607'	EXT	CNFMXL		000000	EXT	DEVMOD		000004	SIN	FARCHK		003141'	EXT
ACYTYP		004576'	EXT	CNFTBL		003356'	EXT	DEVNAM		000000	SIN	FDVL	171000	000000	
ADJBP	133000	000000		CNTRLC		000400	SIN	DEVPPU		002666'		FETMXL		000000	EXT
ADJMWS		000561'	EXT	CNVDAT		002102'		DEVSER		000003	SIN	FETTBL		003436'	EXT
ADJSP	105000	000000		COMDAS		002374'	INT	DEVSTA		002742'		FILLIC		001103'	EXT
ADJUDT		002115'	INT	COMGM0		002443'		DEVSTS		000012	SIN	FINACB		004660'	EXT
AGEPAG		000125'	EXT	COMGM1		002465'		DEVTYP		002642'		FINASS		000321'	EXT
APRENB		000571'	EXT	COMGM2		002475'		DFN	131000	000000		FINTAB		003263'	
ASSCON		400000	SIN	COMGM3		002502'		DIE		005074'	EXT	FIX	122000	000000	
ASSPRG		200000	SIN	COMGMS		002422'	INT	DISMIS		000374'	EXT	FIXR	126000	000000	
ATTUUO		000720'		COMMXL		000000	EXT	DLTLEN		000055	SPD	FIXWEK		002502'	EXT
AUXRED		000000	EXT	COMSOP		002515'	EXT	DLTTAB		002207'		FLEXIT		000477'	
BADSRT		000003	SPD	COMTAB		003375'	EXT	DMUL	116000	000000		FLSTOP		000510'	
BC.RDW		400000	SPD	COMTMS		002411'	INT	DONUMT		003222'		FLTR	127000	000000	
BITPK1		001657'		CONTUU		000456'		DSKCHR		000430'	EXT	FMPL	161000	000000	
BITPOK		001646'		CORMXK		003067'	EXT	DSKCLR		000000	EXT	FNCDEL		001247'	EXT
BLTPAG		000334'	EXT	CORUUO		000412'	EXT	DSTCHK		002177'	INT	FNDMAL		001267'	
BTCMD		002547'		CPOPJ		005076'	EXT	DSTCK1		002200'		FSBL	151000	000000	
BTCMD1		002601'		CPOPJ1		005034'	EXT	DSUB	115000	000000		FSC	132000	000000	
BTCMD2		002562'		CPRRDW		000003	SIN	DTMADJ		002470'	EXT	GETABS		004642'	EXT
BTCMD3		002556'		CPRRED		000001	SIN	DVAVAL		000040	SIN	GETGMT		001701'	INT
BTCMD4		002571'		CPUF3		000004	SPD	DVCHR		002643'		GETLMA		000142'	EXT
BTCMD5		002577'		CPUKI		000001	SPD	DVCHR1		002654'		GETLN		003016'	
BTCMD6		002576'		CPUKL		000002	SPD	DVCNSG		002742'	EXT	GETLNK		004144'	
BTSTLN		002601'	EXT	CPUKS		000003	SPD	DVDSK		200000	SIN	GETLOG		003321'	EXT
BTSTR		005065'	EXT	CPUTYP		000002	SPD	DVRMT		004000	SIN	GETLPS		003313'	EXT
CALI67		002634'	INT	CPZZ		000000	SPD	DVSIZ		000003	SIN	GETMOD		003314'	EXT
CALI70		002637'	INT	CREAUX		000000	EXT	DVSIZU		002675'		GETPPL		003005'	
CBLAMB		004644'	EXT	CREPTY		000325'	EXT	DVTTY		000010	SIN	GETPPN		002656'	
CCILEN		000151	SPD	CRSDB		000000	EXT	DWNFLG		002505'	EXT	GETTAB		003240'	
CCLLEN		000032	SPD	CRSHAC		003417'	EXT	ENDAOK		001177'		GETTB1		003254'	
CCLTAB		000211'		CRSMXL		000000	EXT	ENDGTB		003517'	SPD	GETTB2		003261'	
CHGNAM		003045'	EXT	CTLJOB		000454'		ENDHOK		001174'		GETTMC		001220'	
CHGON		010000	SIN	CTYBLF		002473'	EXT	ENDHSH		001147'		GETULT		001746'	INT
CHGPPN		000000	EXT	CURUPT		000000	EXT	ENDROK		001163'		GMTUDT		002120'	EXT
CHGSIZ		000000	EXT	DADD	114000	000000		EPLLEN		000000	EXT	GOBSTR		000000	EXT
CHKASL		000667'	EXT	DATCNV		002021'		EPT		000000	EXT	GTTBLN		000153	SPD
CHKLIC		001062'		DATCOM		001751'	INT	EPYPSN		001631'	EXT	HIBER		000000	EXT
CHKPRJ		001251'	EXT	DATE		002121'	EXT	ERRABK		000156'	EXT	HICUR		000010	SPD
CHKSEG		003202'	INT	DATEU		001707'		ERRCAL		000165'	EXT	HIGHJB		003006'	EXT
CHKSGJ		003177'	INT	DATSET		002373'		ERREX1		000476'	EXT	HIUSR		000005	SPD
CHKSJ1		003207'		DATUUO		001735'		ERREXI		000473'	EXT	HNGUUO		000000	EXT
CHNCHK		000000	EXT	DAYUUO		001725'		ERRFEX		000507'	EXT	HNMAM		001214'	
CHNCK1		000762'	EXT	DDBLDB		003055'	EXT	ERRFX1		000516'	EXT	HOLD		003104'	EXT
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 57-2
UUOCON.MAC	 4-DEC-87 16:09		SYMBOL TABLE

HS1		001141'		JBTPC		003517'	EXT	KCTGET		003547'		MORBUF		004462'	EXT
HS2		001131'		JBTPIP		000766'	EXT	KJP		000100	SIN	MOVBUF		000372'	EXT
HS3		001122'		JBTPNO		003273'	EXT	KSYS		002624'	EXT	MSTIME		001717'	
ILLINS		000075'	EXT	JBTPPN		003347'	EXT	KSYSET		002624'		MTR		000024	SPD
INADEF		003074'	EXT	JBTPRG		003504'	EXT	KTRRET		000046'	EXT	N.JSYS		000073'	INT
INADFL		002621'	EXT	JBTPRV		003353'	EXT	LDBLOG		003057'	EXT	NEFTRP		000523'	INT
INASET		002615'		JBTPWH		004234'	EXT	LEVDEF		001226'		NERTRP		000522'	INT
INIRDM		001143'	INT	JBTPWL		004235'	EXT	LG.LAB	400000	000000	SPD	NINTRP		000517'	INT
INISET		002360'	EXT	JBTPWS		004233'	EXT	LICHR		000040	SIN	NODIE		005046'	EXT
INLMES		005055'	EXT	JBTRCT		004230'	EXT	LICJAL		001000	SIN	NODST1		001776'	
INSIM1		000065'		JBTSCA		004570'	EXT	LICMSK		001166'	EXT	NODST2		002010'	
INSSIM		000063'		JBTSER		004222'	EXT	LICMXL		000000	EXT	NOINT		000007	SPD
INTACT		000367'	EXT	JBTSIN		004224'	EXT	LICOPR		100000	SIN	NOMAL		001273'	
INTADR		000370'	EXT	JBTSLC		001176'	EXT	LICRMT		002000	SIN	NOMXL		777000	SPD
INTASS		000000	EXT	JBTSLK		004223'	EXT	LICSPY		200000	SIN	NOUTRP		000520'	INT
INTENB		000000	EXT	JBTSLM		003267'	EXT	LICSYS		040000	SIN	NPEEK		001555'	
INTER1		001010'		JBTSOK		004654'	EXT	LICTBL		003266'	EXT	NSPTRP		000524'	INT
INTER2		001012'		JBTSOT		004225'	EXT	LICWCR		400000	SIN	NSWMXL		000000	EXT
INTER3		001014'		JBTST2		003464'	EXT	LICXC		000200	SIN	NSWTBL		003357'	EXT
INTRMT		000756'	INT	JBTSTS		004734'	EXT	LIGHTS		002630'	INT	NUMINT		000006	SPD
IOKILL		000550'	EXT	JBTUID		003475'	EXT	LINJOB		003317'	EXT	NUMTAB		003345'	INT
IORELS		003102'	EXT	JBTUN1		003324'	EXT	LMMERR		000145'	EXT	NWATRP		000521'	INT
ITMCHN		000000	EXT	JBTUNM		003323'	EXT	LNKFND		004161'		NXCHAN		000006	SPD
J		000002	INT	JBTUPM		003600'	EXT	LNKHED		004171'		NXCOND		000005	SPD
JACCT		000001	SIN	JBTWCH		003402'	EXT	LNKLP		004151'		NXICHN		000001	SPD
JACCT2		100000	SIN	JBTWCT		004231'	EXT	LOCUR		000011	SPD	NXMAL		001263'	
JALMSK		002767'		JBYINA		003075'	EXT	LOGIN		003022'		ODPMXL		000000	EXT
JBLMSK		002615'	EXT	JBYSC1		003762'	EXT	LOGIN1		003037'		ODPTBL		003362'	EXT
JBRIRD		000000	EXT	JBYSC2		003771'	EXT	LOGIN3		003062'		ONEJOB		002770'	
JBSRCT		000000	EXT	JF2SEC		002142'		LOGOFF		000000	EXT	OPRDTM		002504'	EXT
JBTAUN		003400'	EXT	JFYHR		002013'	EXT	LOGOUT		003116'		OPRSET		002511'	
JBTBCS		004215'	EXT	JFYMIN		002435'	EXT	LOGTAB		003105'	INT	OPRSND		002356'	EXT
JBTBET		004220'	EXT	JFYSEC		004623'	EXT	LOGTOP		000011	SIN	OTFSET		000000	EXT
JBTBIO		004221'	EXT	JLNWAY		003136'		LOGTP1		003113'		OTHUSR		000453'	
JBTCIN		004216'	EXT	JLOG		000004	SIN	LOGTP2		003114'		P		000001	INT
JBTCMP		004213'	EXT	JNA		040000	SIN	LOGTP3		003115'		P1		000014	INT
JBTCNK		004551'	EXT	JOB		004145'	EXT	LOPRDM		001126'	INT	P2		000015	INT
JBTCOT		004217'	EXT	JOBDDT		005100'	EXT	LOUSR		000003	SPD	P3		000016	INT
JBTCP2		004212'	EXT	JOBKL		003120'	EXT	LSAUUO		004661'	INT	P4		000017	INT
JBTCPU		004210'	EXT	JOBLIC		001042'		LVDMXL		000000	EXT	PAG		000010	SPD
JBTDLK		004227'	EXT	JOBLIN		004135'		LVDTBL		003363'	EXT	PC.PUB		002000	SIN
JBTELP		004214'	EXT	JOBMAX		003576'	EXT	M		000013	INT	PC.UIO		004000	SIN
JBTERN		004226'	EXT	JOBMXL		000000	EXT	MAXCAL		000056	SIN	PC.USR		010000	SIN
JBTFPN		004652'	EXT	JOBN		001543'	EXT	MAXLIC		001044'	EXT	PDNMUP	777777	777776	SIN
JBTFTR		003271'	EXT	JOBNO		001540'		MCYGET		003557'		PEKCHK		001616'	
JBTINA		003270'	EXT	JOBOPC		004712'	EXT	MEMSIZ		001622'	EXT	PFW.A		100000	SIN
JBTKCT		004211'	EXT	JOBSTR		000431'	EXT	MIDNIT		002127'	EXT	PFW.W		040000	SIN
JBTLIC		004605'	EXT	JOBSTS		000455'		MINTAB		003266'		PG		000003	INT
JBTLIM		003315'	EXT	JOBTIM		001542'		MO.AEN		020000	SPD	PGE.A		400000	SIN
JBTMPC		004232'	EXT	JPOPJ		003147'		MO.AO		010000	SPD	PGE.P		200000	SIN
JBTNAM		004666'	EXT	JSYS	104000	000000		MO.LAC		400000	SPD	PGE.W		100000	SIN
JBTNM1		003376'	EXT	JWSADJ		400000	SIN	MO.TON		002000	SPD	PGYNXM		001625'	EXT
JBTNM2		003377'	EXT	KCTGET		003547'		MOHASH		001202'		PHONLY		400000	SIN
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 57-3
UUOCON.MAC	 4-DEC-87 16:09		SYMBOL TABLE

PJOBN		002650'	EXT	RSET1		000541'		SETTLK		002530'		SYDJBT		001504'	
PJRST	324740	000000		RSET2		000547'		SETTMC		001222'		SYDLC1		001407'	
POKCHK		001637'		RTZER		002664'	INT	SETTR1		000000	EXT	SYDLC2		001404'	
POKE		001600'		S$CPU		000004	SIN	SETTR2		000365'	EXT	SYDLC3		001377'	
POKE1		001612'		S$DEBU		000003	SIN	SETUU1		002354'		SYDLC5		001352'	
POLPRT		000337'	EXT	S$ENTR	777777	777775	SIN	SETUUO		002341'		SYDLOC		001373'	
PPNLUP		003007'		S$EVEN		000006	SIN	SETUWP		002626'		SYDNAM		001321'	
PRTDEC		005054'	EXT	S$HALT	777777	777777	SIN	SETWTC		002516'		SYDNM1		001340'	
PRVMSK		000700'	INT	S$INFO		000005	SIN	SIMJSW		003576'		SYDNM2		001335'	
PS.CPR		000541'	EXT	S$JOB		000002	SIN	SIMLEN		000001		SYDNM3		001326'	
PS.FIL		000530'	EXT	S$NAME		000000'	SPD	SIMTBL		000072'		SYDNM4		001367'	INT
PTSBAJ		004620'		S$NONA		000000	SIN	SIXSTP	777777	777777	SPD	SYDNM5		001361'	
PTSR1		004622'		S$PATC		000007	SIN	SIZRET		002722'		SYDSPY		001522'	
PTSR2		004632'		S$STOP		000001	SIN	SKDCOM		002510'	EXT	SYDSTR		001313'	EXT
PTSRFX		004636'		S$TEMP	000003	000000	SPD	SLEEP		000422'	EXT	SYDTBL		000011	SPD
PUTBUF		004657'	EXT	S$XCT	777777	777776	SIN	SNOOPU		000000	EXT	SYDTMX		001315'	EXT
PUTROY		004640'	INT	S..CI7		002640'	INT	SOAKEM		002732'		SYDUNI		001312'	EXT
PUTSAR		004573'		S..JOB		002635'	INT	SPCGSW		002631'	EXT	SYSDEV		000100	SIN
PUUOAC		000050'	EXT	SAVCHG		004344'	EXT	SRNAO		000000	SPD	SYSDVF		001275'	
PVACTS		020000	SIN	SCHPRV		010000	SIN	SRNLIC		000001	SPD	SYSMXL		000000	EXT
PVDINA		000400	SIN	SCHSET		002505'		SRPREF		001157'	EXT	SYSPHY		000432'	EXT
PVEXO		400000	SIN	SCSPRV		002522'		SRSZW		000002	SPD	SYSPPN		002671'	EXT
PVLOS		400000	SIN	SD		000015	SIN	STATES		002770'	EXT	SYSTBL		003416'	EXT
PVMAIL		010000	SIN	SEC2JF		002031'		STDRNG		002720'	EXT	SYSTUU		000000	EXT
PVMCOR		000177	SIN	SEC2YR		002045'		STKAC		000031'	EXT	SYSUDT		002501'	EXT
PVMHNG		300000	SIN	SETALP		000701'		STOLMA		000144'	EXT	SYSWAY		003130'	
PVMMOD		000600	SIN	SETBL		003410'	EXT	STRBTS		001156'	EXT	T1		000006	INT
PVMTIM		176000	SIN	SETDDT		003003'		STRDDB		001155'	EXT	T2		000007	INT
PVNMAI		001000	SIN	SETE		001107'		STRTAD		004722'	EXT	T2POPJ		002153'	EXT
PVNOAT		200000	SIN	SETECD		001161'	EXT	STRTCL		004724'	EXT	T3		000010	INT
PVRCMD		001000	SIN	SETELV		001163'	EXT	STRUUO		000000	EXT	T4		000011	INT
PVSCMD		000200	SIN	SETENM		001153'	EXT	STSMXL		000000	EXT	TAJWAY		003144'	
PVYCOR		003070'	EXT	SETINA		000662'		STSTBL		003372'	EXT	TAKTRP		004767'	EXT
PVYCRM		003063'	EXT	SETJAL		002747'		STTLK		002535'	EXT	TATUUO		000743'	EXT
PVYTIM		001754'	EXT	SETLC1		001032'		STVSET		000326'	EXT	TCCARL		000041	SIN
PWSGET		003567'		SETLE1		000623'		SUUNUM		000015	SPD	TCCNHW		000010	SPD
PX.MEM		000004	SPD	SETLE2		000624'		SUUTAB		002356'		TCCTAR		000021	SIN
PX.SRC		000001	SPD	SETLE3		000626'		SWITCH		002631'	INT	TDT2YR		002036'	
PXCT	256000	000000		SETLI0		000607'		SWPMXL		000000	EXT	TDTUUO		000723'	EXT
RDHIST		000336'	EXT	SETLI1		000616'		SWPTBL		003360'	EXT	THSDAT		004624'	EXT
REASSI		000416'	EXT	SETLI2		000620'		SYDBF0		001416'		TIMADJ		004176'	EXT
RECMFL		000630'		SETLIC		001017'		SYDBF1		001425'		TIME		004622'	EXT
REDNXT		001224'		SETLIM		000572'		SYDBF2		001430'		TIMEF		000115'	EXT
REDPIP		000364'	EXT	SETMAI		001230'		SYDBF3		001433'		TIMEOK		002441'	
REMAP		002627'		SETMAL		001246'		SYDBF4		001437'		TIMER		001713'	
RESET		000525'	INT	SETMCY		000000	EXT	SYDBF5		001441'		TIMSET		002410'	
RESFRH		000565'	EXT	SETMOD		000000	EXT	SYDBF6		001445'		TINASS		000000	EXT
REST		002604'		SETMXL		000000	EXT	SYDBF7		001453'		TKROM%		002542'	EXT
RETACH		000327'	EXT	SETNAM		003520'		SYDBF8		001460'		TMP.UU		000000	EXT
RETERR		001015'	INT	SETPID		000000	EXT	SYDBUF		001417'		TPOPJ		004643'	EXT
REUSER		002613'	EXT	SETPOV		000000	EXT	SYDCOM		001356'	INT	TPOPJ1		003213'	EXT
ROYARL		000011	SIN	SETPRV		000635'		SYDDSP		001310'		TRNARL		000036	SIN
ROYTAR		000020	SIN	SETTIM		000366'	EXT	SYDFTA		001314'	EXT	TRNNHW		000010	SPD
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 57-4
UUOCON.MAC	 4-DEC-87 16:09		SYMBOL TABLE

TRNTAR		000017	SIN	UPNPSR		000000	EXT	UUOKNT		000030'	INT	XCF4L2		004417'	
TRUGET		003540'		UPRERF		000347'	EXT	UUOLIT		004670'	INT	XCF4L3		004423'	
TRUGN		003524'		UPROT		000000	EXT	UUOMNR		000404'	EXT	XCF4NA		004304'	SPD
TRUGN2		003532'		UPRSTS		000330'	EXT	UUOPN1		000007'	INT	XCF4NL		004302'	
TRYATT		000742'		UPSABK		004720'	EXT	UUOPN2		000021'		XCF4NS		004303'	SPD
TTYFND		003016'	EXT	UPSJOB		001633'	EXT	UUOPN3		000023'		XCF5BA		004306'	SPD
TTYFNU		002511'	EXT	UPSPSR		000000	EXT	UUOPN4		000025'		XCF5L1		004516'	
TTYFUW		003103'	EXT	UPSSWE		004716'	EXT	UUOPNT		000003'	INT	XCF5NA		004304'	SPD
TTYMXL		000000	EXT	UPTABK		000000	EXT	UUOSK1		000000	EXT	XCF5NL		004302'	SPD
TTYRES		000547'	EXT	UPTACP		000000	EXT	UUOSNT		000047'	INT	XCF6L1		004546'	
TTYTAB		004137'	EXT	UPTALD		000000	EXT	UUOTAB		000000	EXT	XCF6NA		004304'	SPD
TTYTBL		003442'	EXT	UPTALN		000000	EXT	UUOXWL		000102'	INT	XCF6NL		004302'	SPD
TTYUSM		000461'	EXT	UPTALP		000000	EXT	UVALID		000000	EXT	XCF7BC		004305'	SPD
TTYUUO		001227'	EXT	UPTCHG		000000	EXT	UVDSKP		000000	EXT	XCF7NL		004302'	
U		000005	INT	UPTJOB		000000	EXT	UWSCTL		000000	EXT	XCHARG		004172'	
U.JSYS		000074'		UPTLKJ		000000	EXT	VCLEAU		000000	EXT	XCHARL		000036	SIN
UATTAC		000715'		UPTLOG		003112'	EXT	VFLCKU		000346'	EXT	XCHBAJ		004352'	
UBMASK		004313'		UPTMUP		000425	SIN	VPGFIL		000344'	EXT	XCHCR1		004271'	
UCALL		000157'	INT	UPTMUU		000424	SIN	VPUMAX		000135'	EXT	XCHCR2		004276'	
UCALL1		000174'		UPTNTV		000000	EXT	VREMOU		000353'	EXT	XCHCRD		004266'	
UCALL2		000176'		UPTPDL		000000	EXT	VREPLU		000000	EXT	XCHCTB		004210'	
UCALLF		000166'		UPTPJ1		003114'	EXT	W		000012	INT	XCHF4		004323'	
UCALLI		000167'	INT	UPTPJ2		003115'	EXT	WACRHW		004647'	EXT	XCHF4A		004354'	
UCBADD		000000	EXT	UPTPJC		003113'	EXT	WAIT		000000	EXT	XCHF5		004470'	
UCBHNG		000000	EXT	UPTRNM		000000	EXT	WAITCH		001216'		XCHF6		004525'	
UCBINI		000341'	EXT	UPTRPN		000000	EXT	WAKUUO		000443'	EXT	XCHFLN		000026	SPD
UCBINW		000000	EXT	UPTSTS		000000	EXT	WATMXL		000000	EXT	XCHFNT		004200'	
UCBLEV		000340'	EXT	UPTUUO		000000	EXT	WATTAB		003446'	EXT	XCHFUN		000010	SPD
UCBMEM		000342'	EXT	UPTXEI		000000	EXT	WAYACJ		000340	SPD	XCHRD1		004255'	
UCBRLI		000000	EXT	UPYPSR		004713'	EXT	WAYJLN		000300	SPD	XCHRD2		004262'	
UCBSTS		000000	EXT	UPYUWL		000557'	EXT	WAYJMP		000500	SPD	XCHRED		004247'	
UCBWAK		000343'	EXT	UPYUWM		000556'	EXT	WAYRAD		000240	SPD	XCHSAV		004236'	
UCILEN		000112	SPD	UREMAP		002627'	EXT	WAYRDS		000200	SPD	XCHSC1		004570'	
UCLJMP		000406'		URFBIT		000350'	EXT	WAYRFI		000100	SPD	XCHSCA		004560'	
UCLLEN		000056	SPD	URUN		000424'	EXT	WAYRPI		000040	SPD	XCHSV1		004242'	
UCLTAB		000243'		URUNHI		000373'	EXT	WAYRUN		000140	SPD	XCHTAR		000010	SPD
UCREAT		000352'	EXT	USCHD1		000116'	EXT	WAYSYS		000400	SPD	XINIT		001211'	
UDEVNM		002725'		USRACB		000000	SIN	WAYTAB		003151'		XJRSTF	254440	000000	
UDT2YR		002035'		USRSW1		000140'		WAYTAJ		000440	SPD	YR2DC1		002166'	
UDTFIX		002503'	EXT	USRSW2		000147'		WAYTJB		003164'		YR2DEC		002154'	
UFA	130000	000000		USRSWE		000132'		WCHALL		376000	SIN	YR2SEC		002141'	
UGTSEG		000000	EXT	USRXIT		000076'	INT	WHYMXL		000000	EXT	YR2TDT		002123'	
UPEEK		001575'		USRXT7		000120'	INT	WRTACR		003050'	EXT	YR2UDT		002112'	
UPEEK1		001566'		USRXT8		000126'		WSYNC		000000	EXT	ZAPCIR		000363'	EXT
UPEEK2		001573'		USTUWP		002626'	EXT	XC4FR		004310'	SPD	ZZ	005557	664555	SPD
UPEEK3		001564'		UTRP		040000	SIN	XCBADC		004314'		%%X		000005	SPD
UPESET		000000	EXT	UTRPST		001670'		XCF4BA		004306'	SPD	%%Y		000001	SPD
UPESTS		000000	EXT	UUOABK		000152'		XCF4BB		004307'	SPD	%%Z		000012	SPD
UPFSTS		000345'	EXT	UUOCNT		000027'	INT	XCF4BC		004305'	SPD	%3W		000770	
UPGSTS		000351'	EXT	UUOCON		000000'	ENT	XCF4DA		004436'		%CTUPT		000000	EXT
UPHNLY		200000	SIN	UUODSP		000050'		XCF4DP		004432'		%RB2.C		000000	EXT
UPISTS		000000	EXT	UUOEND		005166'	INT	XCF4L0		004375'		%RIB.C		000000	EXT
UPNPSR		000000	EXT	UUOERR		003031'	EXT	XCF4L1		004413'		%SAT.C		000000	EXT
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88 PAGE 57-5
UUOCON.MAC	 4-DEC-87 16:09		SYMBOL TABLE

%UPLMA		000137'	EXT	
%UPS		001666'	EXT	
%UPT		003032'	EXT	
%UPX		000000	EXT	
.ARRAD		000004	SIN	
.ARRDS		000003	SIN	
.ARRFI		000005	SIN	
.ARRPI		000006	SIN	
.ARRUN		000002	SIN	
.GTCRS		003411'	EXT	
.GTSLF		000023	SPD	
.SLEXT		000001	SIN	

UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

ABKUUO	   458%	   862
ACCWAY	  2974#	  2997	  3028	  3029	  3030	  3031	  3032
ACJWAY	  2987#	  3034
ACRTAB	  4662%	  4678
ACTDDB	  4662%	  4707
ACTWRT	   332	   997%	   999	  1004	  1023	  1033	  1395	  1533	  3345	  4775
ACURTL	  4664%	  4672
ACUTAB	  4663%	  4672
ACYMIN	  4665%	  4686
ACYSIZ	  4662%	  4682
ACYTYP	  4662%	  4673
ADJMWS	    60%	  1092
ADJUDT	  2237#	  2483
AGEPAG	    60%	   362
APRENB	   916%	   927	  1100
ASSCON	  2741
ASSPRG	  2741
ATTUUO	   904	  1242	  1253#
AUXRED	   452%	   888
BADSRT	  4649#	  4676
BC.RDW	  2582#	  2590
BITPK1	  1969	  1973#
BITPOK	   867	  1961#
BLTPAG	   458%	   865
BTCMD	  2390	  2586#
BTCMD1	  2587	  2595	  2613#
BTCMD2	  2591	  2597#
BTCMD3	  2593#	  2596
BTCMD4	  2604#	  2608
BTCMD5	  2601	  2605	  2611#
BTCMD6	  2606	  2610#
BTSTLN	  2603%	  2603	  2613%	  2613
BTSTR	  2589%	  2589
CALI67	   947	  2716#
CALI70	   948	  2722#
CBLAMB	    62%	  4393	  4509	  4566	  4708	  4738
CCILEN	   431	   836#
CCLLEN	   408	   410	   772#
CCLTAB	   746#	   772
CHGNAM	  2907%	  2907
CHGON	   119
CHGPPN	    46%	   950
CHGSIZ	  4050%	  4116	  4409
CHKASL	  1193%	  1193
CHKLIC	   894	  1428#
CHKPRJ	  1588	  1609%
CHKSEG	  1667	  1716	  1843	  3069#	  3348	  3354	  3357	  3367	  3374	  3382	  3391	  3729
CHKSGJ	  3062#	  3354
CHKSJ1	  3064	  3074#
CHNCHK	  1061%
CHNCK1	  1061%	  1321%	  1331%	  1331
CHPJC	   882%	   882
CI.OPR	   463#	   859
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

CKLCFL	  1436	  1444#
CKLGO	  2833	  2860%
CLKTRP	    63%	   358
CLKTRU	  1135	  1846	  3350	  3354	  3359	  3369	  3479#
CLKTRX	  3606	  3628#
CMWB	   350
CNFMXL	  3142%	  3211
CNFTBL	  3142%	  3211
CNTRLC	   350
CNVDAT	  2168	  2220#
COMDAS	  2400#
COMGM0	  2447	  2450#
COMGM1	  2445	  2469#
COMGM2	  2435	  2481#
COMGM3	  2477	  2486#
COMGMS	  2426	  2432#
COMMXL	  3148%	  3231
COMSOP	  2504%	  2504
COMTAB	  3148%	  3231
COMTMS	  2417#
CONTUU	   864	   975#
CORMXK	  1183	  1184	  1285%	  2928	  2929
CORUUO	    52%	   924
CPOPJ	    61%	   452%	   463	   866	   885	   886	   887	   922	   923	   925	   937	   941	   943	   944
	   945	   948	   951	   952	   953	   954	   955	   956	   977	  1241	  1913	  1920	  1997	  2109
	  2124	  2161	  2374	  2501	  2723	  3184	  3185	  3198	  3215	  3220	  3221	  3226	  3229	  3230
	  3235	  3237	  3238	  3239	  3240	  3241	  3244	  3245	  3246	  3247	  3250	  3251	  3252	  3253
	  3254	  3255	  3256	  3257	  3258	  3259	  3260	  3261	  3262	  3263	  3265	  3266	  3267	  3269
	  3270	  3274	  3275	  3276	  3277	  3278	  3279	  3280	  3281	  3282	  3283	  3284	  3285	  3286
	  3288	  3289	  3290	  3291	  3292	  3293	  3294	  3295	  3297	  3298	  3299	  3300	  3304	  3305
	  3306	  3307	  3308	  3309	  3310	  3311	  3312	  3313	  4028	  4083	  4125	  4140	  4718
CPOPJ1	    61%	   979	  1147	  1151	  1201	  1227	  1234	  1347	  1354	  1355	  1534	  1671	  1684	  1689
	  1694	  1696	  1759	  1772	  1776	  1780	  1791	  1806	  1820	  1864	  1904	  1909	  1929	  1939
	  1944	  1980	  1983	  1996	  1999	  2091	  2170	  2300	  2305	  2411	  2511	  2528	  2615	  2658
	  2663	  2674	  2679	  2764	  2794	  2800	  2808	  2811	  2827	  2843	  2853	  2858	  3101	  3137
	  3352	  3361	  3372	  3380	  3388	  3397	  3408	  3995	  4044	  4121	  4123	  4134	  4137	  4139
	  4146	  4149	  4151	  4443	  4640
CPRRDW	  1071	  1079
CPRRED	  1077
CPUF3	   217	   246	   462	  2703	  2708
CPUKI	    48	   100	   104	   232	   294	   463	  1865	  1871	  1931	  1937	  2703	  2708
CPUKL	   463	  2709
CPUKS	   462	  2710
CPUTYP	    48	   100	   104	   217	   232	   246	   294	   462	   463	  1865	  1871	  1931	  1937	  2703
	  2708	  2709	  2710
CPZZ	    48#	    48	   100#	   100	   104#	   104	   217#	   217	   232#	   232	   246#	   246	   294#	   294
	   462#	   462	   463#	   463	  1865#	  1865	  1871#	  1871	  1931#	  1931	  1937#	  1937	  2703#	  2703
	  2708#	  2708	  2709#	  2709	  2710#	  2710
CREAUX	   454%	   889
CREPTY	   455%	   858
CRSDB	  3147%
CRSHAC	  3249%	  3249
CRSMXL	  3147%	  3243
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

CTLJOB	   946	   962#
CTYBLF	  2476%	  2476
CURUPT	    43%
DATCNV	  2134	  2174#
DATCOM	  2066	  2087	  2111	  2122#	  2405	  2423
DATE	  2241%	  2241
DATEU	   926	  2029#
DATSET	  2385	  2399#
DATUUO	   884	  2083#
DAYUUO	   857	  2062#
DDBLDB	   973%	   976	  2918
DDINT	  1330	  1349
DDTIN	   452%	   920
DDTOUT	   452%	   921
DEC2YR	  2174	  2200#
DEVCHR	  2789
DEVINT	  1041	  1042	  1043	  1044	  1045	  1046
DEVLST	    62%	  1647	  1702
DEVMOD	  1650	  1661	  2736	  2787
DEVNAM	  1651	  1669	  2798	  2878	  3992
DEVPPU	   942	  2758#
DEVSER	  1654	  1659	  1673	  1706	  1711
DEVSTA	   942	  2823#
DEVSTS	  2825
DEVTYP	   941	  2729#
DIE	    11	    11%	    12	    70	    93	   127	   320	  2447	  2717	  2723
DISMIS	   897	   916%
DLTLEN	  2298	  2361#
DLTTAB	  2299	  2301	  2312#	  2361
DONUMT	  3088#	  3224
DSKCHR	   915%	   938
DSKCLR	   452%	   898
DSTCHK	  2148	  2158	  2298#
DSTCK1	  2299#	  2304
DTMADJ	  2432%	  2432	  2441%	  2441	  2452%	  2452	  2473%	  2473
DVAVAL	  2738	  2742
DVCHR	   922	   923	  2730	  2734#
DVCHR1	  2737	  2743#
DVCNSG	    62%	  2734	  2758	  2777	  2796	  2823
DVDSK	  1648	  1662
DVRMT	  1648	  1662
DVSIZ	  1674
DVSIZU	   952	  2771#
DVTTY	  1648	  1662
DWNFLG	  2493%	  2493
ENDAOK	  1528	  1532#
ENDGTB	  1802	  3090	  3121	  3336#
ENDHOK	  1474	  1525	  1529#
ENDHSH	  1484	  1508#
ENDROK	  1517	  1520#
EPLLEN	    46%	    77
EPT	    43%
EPYPSN	    43%	  1924
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

ERRABK	    45%	   398
ERRCAL	    42%	   414
ERREX1	   987%	  1005
ERREXI	   987%	  1000
ERRFEX	  1013%	  1025
ERRFX1	  1013%	  1035
ERRIUC	    53%
ERRNSA	    43%	   343
ERRPIO	    50%	   391
EVICT	   455%	   861
EX0ACB	    68
EXIT	   925	   989#	  1283	  2968
EXIT1	   993	  1003#
F	    74	    75	    76	   111	   975	   976	  1041	  1042	  1043	  1044	  1045	  1046	  1483	  1484
	  1488	  1489	  1490	  1499	  1664	  1666	  1713	  1715	  2502	  2736	  2760	  2787	  2789	  2798
	  2825	  2878	  4707
FARCHK	  2972%	  2976	  2991
FETMXL	  3147%	  3264
FETTBL	  3147%	  3264
FILLIC	  1447	  1452%
FINACB	  4303%	  4440	  4534	  4594	  4715	  4750
FINASS	   461%	   854
FINTAB	  2979	  2985	  3135#
FIXWEK	  2486%	  2486
FLEXIT	   858	  1015#
FLSTOP	   855	  1028#
FNCDEL	  1586	  1609%
FNDMAL	  1598	  1602#
GETABS	  4303%	  4388	  4505	  4563	  4698	  4735
GETGMT	  2018#	  2021	  2062	  2108	  2123
GETLMA	   372%	   383
GETLN	   934	  2877#
GETLNK	  3168	  4023#
GETLOG	  3110%	  3178
GETLPS	  3143%	  3172
GETMOD	  3143%	  3173
GETPPL	  2750	  2866#
GETPPN	   930	  2748#
GETTAB	   936	  3116#
GETTB1	  3125	  3128#
GETTB2	  3130	  3133#
GETTMC	   900	  1558#
GETULT	  2029	  2039	  2049	  2108#	  2401	  2419
GINST	   339#	   339	   346#	   346	   407#	   407	   408	   437#	   437	   438	  1024#	  1024	  1025	  1034#
	  1034	  1035	  1160#	  1160	  1161	  1162#	  1162	  1163	  1219#	  1219	  1222#	  1222	  1223#	  1223
	  1228#	  1228	  1229	  1230#	  1230	  1231	  1232#	  1232	  1233	  1345#	  1345	  1346	  1363#	  1363
	  1364	  1431#	  1431	  1432	  1434#	  1434	  1435	  1440#	  1440	  1441	  1445#	  1445	  1446	  1449#
	  1449	  1450	  1473#	  1473	  1474	  1476#	  1476	  1477	  1479#	  1479	  1480	  1480#	  1481	  1510#
	  1510	  1511	  1521#	  1521	  1522	  1573#	  1573	  1574	  1591#	  1591	  1592	  1593#	  1593	  1594
	  1596#	  1596	  1597	  1625#	  1625	  1626	  1646#	  1646	  1647	  1670#	  1670	  1671	  1681#	  1681
	  1682	  1688#	  1688	  1689	  1693#	  1693	  1694	  1695#	  1695	  1696	  1701#	  1701	  1702	  1718#
	  1718	  1719	  1735#	  1735	  1736	  1758#	  1758	  1759	  1767#	  1767	  1768	  1775#	  1775	  1776
	  1779#	  1779	  1780	  1787#	  1787	  1788	  1799#	  1799	  1800	  1819#	  1819	  1820	  1833#	  1833
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

	  1834	  1847#	  1847	  1848	  1863#	  1863	  1864	  1898#	  1898	  1899	  1899#	  1900	  1965#	  1965	  1966
	  1975#	  1975	  1976	  1976#	  1977	  1977#	  1978	  2031#	  2031	  2032	  2041#	  2041	  2042	  2053#
	  2053	  2054	  2063#	  2063	  2064	  2068#	  2068	  2069	  2084#	  2084	  2085	  2085#	  2086	  2086#
	  2087	  2089#	  2089	  2090	  2090#	  2091	  2546#	  2546	  2547	  2547#	  2548	  2554#	  2554	  2555
	  2557#	  2557	  2558	  2558#	  2559	  2588#	  2588	  2589	  2594#	  2594	  2595	  2604#	  2604	  2605
	  2614#	  2614	  2615	  2656#	  2656	  2657	  2711#	  2711	  2712	  2743#	  2743	  2744	  2752#	  2752
	  2753	  2755#	  2755	  2756	  2763#	  2763	  2764	  2773#	  2773	  2774	  2776#	  2776	  2777	  2793#
	  2793	  2794	  2799#	  2799	  2800	  2826#	  2826	  2827	  2862#	  2862	  2863	  2869#	  2869	  2874#
	  2874	  2875	  2879#	  2879	  2880	  2901#	  2901	  2902	  2938#	  2938	  2939	  3100#	  3100	  3101
	  3136#	  3136	  3137	  3351#	  3351	  3352	  3360#	  3360	  3361	  3370#	  3370	  3371	  3371#	  3372
	  3377#	  3377	  3378	  3379#	  3379	  3380	  3385#	  3385	  3386	  3387#	  3387	  3388	  3394#	  3394
	  3395	  3396#	  3396	  3397	  3407#	  3407	  3408	  3733#	  3988	  3989	  3994#	  3994	  3995	  4043#
	  4043	  4044	  4072#	  4072	  4073	  4126#	  4126	  4127	  4135#	  4135	  4136	  4141#	  4141	  4142
	  4147#	  4147	  4148	  4324#	  4324	  4325	  4371#	  4371	  4372	  4372#	  4373	  4415#	  4415	  4416
	  4445#	  4445	  4446	  4455#	  4455	  4456	  4456#	  4457	  4530#	  4530	  4531	  4533#	  4533	  4534
	  4632#	  4632	  4633	  4639#	  4639	  4640	  4668#	  4668	  4669	  4694#	  4694	  4695	  4695#	  4696
	  4705#	  4705	  4706	  4711#	  4711	  4712	  4717#	  4717	  4718
GMTUDT	  2190%	  2190	  2232%	  2232	  2240%	  2240
GOBSTR	   915%	   947
GTTBLN	  3337#
HIBER	   916%	   949
HICUR	  4350#	  4357	  4361	  4457	  4461	  4463	  4474	  4476
HIGHJB	  1597	  2852	  2865%	  2867
HIUSR	  4352#	  4452	  4455	  4461	  4463	  4465	  4467	  4469	  4471	  4474
HNGUUO	   452%	   894
HNMAM	  1482	  1551#
HOLD	    52%	  2944
HS1	  1495	  1499#
HS2	  1491#	  1499
HS3	  1483#	  1486
ILLINS	    52%	   167%	   167	   214%	   214	   244%	   244
INADEF	  1172%	  1172	  1191%	  1191	  2673%	  2673	  2935%	  2935
INADFL	  2672%	  2672
INASET	  2392	  2668#
INIRDM	  1475	  1502#	  1507
INISET	  2383%	  2383
INLMES	  2450%	  2450	  2458%	  2458	  2462%	  2462
INSIM1	   210#	   213
INSSIM	   169	   208#
INTACT	   453%	   892
INTADR	   453%	   893
INTASS	   453%	   892
INTENB	   453%	   893
INTER1	  1337	  1358#
INTER2	  1340	  1360#
INTER3	  1343	  1350	  1362#
INTRMT	   886	  1327#
IOKILL	  1061%	  1083
IORELS	   987%	   994	  1019	  2942
ITMCHN	   120	   120%	   364
J	    73	    75	   316	   329	   348	   357	   360	   363	   376	   395	   439	   975	   992	  1018
	  1031	  1088	  1091	  1095	  1097	  1098	  1133	  1142	  1144	  1146	  1149	  1150	  1173	  1177
	  1178	  1198	  1200	  1215	  1263	  1266	  1268	  1278	  1280	  1336	  1375	  1376	  1380	  1382
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

	  1386	  1388	  1390	  1391	  1405	  1433	  1526	  1527	  1530	  1531	  1538	  1539	  1542	  1543	  1570
	  1665	  1714	  1732	  1796	  1816	  1833	  1841	  1842	  1857	  1896	  1962	  1974	  1994	  2372
	  2375	  2510	  2523	  2527	  2598	  2660	  2749	  2751	  2762	  2807	  2809	  2830	  2837	  2839
	  2841	  2866	  2868	  2888	  2896	  2897	  2912	  2916	  2933	  2950	  2951	  2952	  2953	  2954
	  2966	  2974	  2989	  2999	  3070	  3076	  3088	  3089	  3116	  3117	  3118	  3126	  3131	  3151
	  3152	  3153	  3154	  3155	  3156	  3158	  3159	  3164	  3165	  3166	  3167	  3171	  3174	  3177
	  3179	  3180	  3181	  3182	  3186	  3187	  3188	  3189	  3190	  3191	  3192	  3193	  3194	  3195
	  3196	  3197	  3199	  3203	  3204	  3206	  3208	  3210	  3211	  3212	  3213	  3216	  3217	  3218
	  3219	  3228	  3231	  3232	  3233	  3234	  3236	  3242	  3243	  3248	  3249	  3264	  3268	  3271
	  3273	  3287	  3296	  3302	  3303	  3314	  3342	  3343	  3376	  3378	  3384	  3386	  3393	  3395
	  3401	  3403	  3484	  3485	  3505	  3514	  3515	  3530	  3538	  3546	  3561	  3577	  3579	  3581
	  3582	  3583	  3629	  3630	  3650	  3651	  3671	  3686	  3702	  3704	  3706	  3707	  3731	  4031
	  4033	  4037	  4038	  4041	  4090	  4091	  4092	  4093	  4094	  4095	  4096	  4097	  4098	  4099
	  4100	  4101	  4102	  4103	  4104	  4105	  4106	  4107	  4108	  4109	  4110	  4111	  4365	  4397
	  4399	  4401	  4498	  4513	  4515	  4517	  4559	  4570	  4572	  4574	  4586	  4630	  4638	  4680
	  4742	  4744	  4746	  4771	  4773	  4776
JACCT	   989	  1015	  1028	  2748	  2846
JACCT2	   991	  1017	  1030	  2832	  2834	  2846
JALMSK	  2831	  2842	  2846#
JBLMSK	  1188%	  1188	  2668%	  2668
JBRIRD	  3476%	  3584
JBSRCT	  3476%	  3584
JBTAUN	  1268	  1269	  1539	  2952%	  2952	  3076	  3077	  3179	  3234
JBTBCS	  3110%	  3188	  3686	  4095
JBTBET	  3112%	  3143%	  3166	  3530	  4098
JBTBIO	  3112%	  3143%	  3165	  3538	  4099
JBTCIN	  3111%	  3192	  3515	  4096
JBTCMP	  3110%	  3186	  3386	  3485	  4093
JBTCNK	  3111%	  3189	  4586
JBTCOT	  3111%	  3191	  3514	  4097
JBTCP2	  3142%	  3164	  3384	  3484	  4092
JBTCPU	  3110%	  3187	  3376	  3629	  4090
JBTDLK	  3113%	  3197	  3579	  4105
JBTELP	  3111%	  3190	  3671	  4094
JBTERN	  3113%	  3171	  3577	  4104
JBTFPN	  2375	  3110%	  3177	  3302	  3343	  4399	  4515	  4572	  4744
JBTFTR	  3149%	  3154
JBTINA	   363%	   363	  3153
JBTKCT	  3149%	  3206	  3378	  3630	  4091
JBTLIC	  1266	  1366%	  1375	  1390	  1391	  1405	  1433	  1526	  1530	  1570	  1732	  1796	  1816	  1857
	  1896	  1962	  1974	  1994	  2372	  2598	  2660	  2830	  2982	  3074	  3094	  3182	  4025	  4365
	  4498	  4559	  4630	  4680
JBTLIM	  1098	  1133	  1146	  1150	  3143%	  3174
JBTMPC	  3144%	  3159	  3546	  4108
JBTNAM	  3142%	  3204	  3342	  4397	  4513	  4570	  4742	  4771	  4773	  4776
JBTNM1	  2896%	  2896	  3232%	  3232
JBTNM2	  2897%	  2897	  3233%	  3233
JBTPC	    75%	    75	  3314
JBTPIP	  1319%	  1336
JBTPNO	  3149%	  3156
JBTPPN	  1543	  2751%	  2751	  2762%	  2762	  2866	  2871	  2950%	  2950	  3203
JBTPRG	  3303%	  3303
JBTPRV	  1173	  1177	  1178	  1198	  1200	  1581	  1604	  2933	  2951%	  2951	  3082	  3208
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

JBTPWH	  3144%	  3393	  3650	  4110
JBTPWL	  3144%	  3395	  3651	  4111
JBTPWS	  3144%	  3158	  3561	  4109
JBTRCT	  3145%	  3218	  3581	  4106
JBTSCA	  1088%	  1088	  4624%	  4638
JBTSER	  3113%	  3195	  3702	  4100
JBTSIN	  3111%	  3194	  3706	  4102
JBTSLC	  1366%	  1376	  1380	  1382	  1386	  1388	  1527	  1531
JBTSLK	  3113%	  3196	  3704	  4101
JBTSLM	  1097	  1142	  1144	  1149	  3143%	  3152
JBTSOK	  2802%	  2807	  2809	  2810	  3167	  3505	  4401	  4517	  4574	  4746
JBTSOT	  3111%	  3193	  3707	  4103
JBTST2	  3287%	  3287
JBTSTS	    57%	   329	   348	   376	   395	   992	  1018	  1031	  1091	  1095	  1215	  1260	  1263	  1280
	  1577	  2523	  2527	  2749%	  2749	  2837	  2839	  2841	  2855	  2888	  2912	  2966	  3199
JBTUID	  3149%	  3155	  3296
JBTUN1	  1542	  1600	  2954%	  2954	  3181
JBTUNM	  1538	  1599	  2953%	  2953	  3180
JBTUPM	    57%	  3271	  3403
JBTWCH	    51%	  2510	  3236
JBTWCT	  3145%	  3219	  3582	  4107
JBYINA	  1175%	  1175	  1196%	  1196	  2936%	  2936
JBYSC1	  3476%	  3605
JBYSC2	  3476%	  3613
JF2SEC	  2226	  2260#
JFYHR	  2142%	  2142	  2163%	  2163
JFYMIN	  2417%	  2417	  2443%	  2443
JFYSEC	  2052%	  2052	  2186%	  2186	  2262%	  2262	  2453%	  2453	  4703%	  4703
JLNWAY	  2988#	  3033
JLOG	  1262	  1279	  1578	  2846	  2887	  2911	  2965
JNA	  1258	  2854
JOB	    57%	    69	    73	   316	   357	   439	  1278	  1842	  2740	  2981	  3069	  3093	  3118	  4024
JOBDDT	    47%	  2862
JOBKL	    53%	  1281	  2967
JOBLIC	  1378	  1397#	  1437
JOBLIN	  3175	  3729#
JOBMAX	  3059%	  3070	  3401
JOBMXL	  3109%	  3200
JOBN	  1259	  1575	  1839%	  1839
JOBNO	   932	  1833#
JOBOPC	    46%	    59%	   346
JOBSTR	   915%	   939
JOBSTS	   944	   963#
JOBTIM	   931	  1838#
JPOPJ	  2999#
JWSADJ	  1093	  1094
KCTGET	  3161	  3373#
KJP	  1216	  2846
KSYS	  2678%	  2678
KSYSET	  2393	  2678#
KTRRET	    58%	   122
LDBLOG	  2920%	  2920
LEVDEF	   895	  1567#
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

LG.LAB	    68	   365
LICHR	  1410	  1529
LICJAL	  1265	  2384	  2385	  2386	  2388	  2829
LICMSK	  1366%	  1402	  1409	  1523
LICMXL	  3141%	  3151
LICOPR	  1571	  2381	  2382	  2384	  2385	  2386	  2390	  2391	  2392	  2393
LICRMT	  1410	  1529
LICSPY	  1731	  1795	  1815	  1856	  1973	  2390	  2391	  2983	  3063	  3073	  3095	  4023
LICSYS	  1731	  1795	  2983	  3063	  3073	  3095	  4023
LICTBL	  3141%	  3151
LICWCR	  1406	  1895	  1961	  1993	  2390	  2391	  2597	  2659
LICXC	  4364	  4497	  4560	  4629
LIGHTS	   906	  2702#
LINJOB	  3113%	  3176
LISTSN	     3	     6
LMMERR	   372%	   378	   386
LNKFND	  4032	  4037#
LNKHED	  4027	  4046#	  4047
LNKLP	  4028#	  4035
LOCUR	  4351#	  4357	  4361	  4458	  4462	  4473	  4475	  4479
LOGIN	   926	  2887#
LOGIN1	  2900#	  2905
LOGIN3	  2917	  2919	  2924#
LOGOFF	    54%	   863
LOGOUT	   927	  2965#
LOGTAB	  2892	  2893	  2903	  2909	  2950#	  2959
LOGTOP	  2899	  2959#
LOGTP1	  2892	  2956#
LOGTP2	  2893	  2957#
LOGTP3	  2909	  2958#
LOPRDM	  1485	  1488#	  1507
LOUSR	  4353#	  4415	  4416	  4420	  4421	  4423	  4424	  4425	  4453	  4456	  4462	  4466	  4470	  4472
	  4473
LSAUUO	   881	  4770#
LVDMXL	  3145%	  3217
LVDTBL	  3145%	  3217
M	    71	    72	   109	   166	   168	   171	   208	   389	   390	   396	   407	   416	   424	   436
	   437	  1363	  1428	  1429	  1431	  1434	  1439	  1440	  1445	  1448	  1449	  1472	  1473	  1476
	  1477	  1478	  1479	  1488	  1491	  1497	  1508	  1509	  1510	  1521	  1541	  1542	  1543	  1573
	  1591	  1592	  1593	  1595	  1596	  1621	  1625	  1645	  1646	  1670	  1672	  1681	  1685	  1686
	  1687	  1688	  1693	  1695	  1700	  1701	  1718	  1734	  1735	  1758	  1760	  1767	  1773	  1775
	  1777	  1779	  1785	  1786	  1787	  1798	  1799	  1807	  1818	  1819	  1821	  1833	  1847	  1863
	  1975	  2031	  2041	  2053	  2063	  2068	  2083	  2084	  2085	  2086	  2089	  2090	  2711	  2743
	  2752	  2755	  2763	  2771	  2772	  2773	  2775	  2776	  2779	  2792	  2793	  2799	  2826	  2869
	  2874	  2879	  2898	  2901	  2904	  3100	  3136	  3351	  3360	  3370	  3371	  3377	  3379	  3385
	  3387	  3394	  3396	  3407	  3733	  3994	  4043	  4324	  4445	  4533	  4717
MAXCAL	    24	   781	   782	   783	   784	   785	   786	   787	   788	   789	   790	   791	   792	   793
	   794	   795	   796	   797	   798	   799	   800	   801	   802	   803	   804	   805	   806	   807
	   808	   809	   810	   811	   812	   813	   814	   815	   816	   817	   818	   819	   820	   821
	   822	   823	   824	   825	   826	   827
MAXLIC	  1366%	  1381	  1387	  1399
MCYGET	  3160	  3381#
MEMSIZ	  1854%	  1915
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

MIDNIT	  2193%	  2193	  2248%	  2248
MINTAB	  1803	  3091	  3122	  3150#
MO.AEN	   120	   364
MO.AO	   120	   364
MO.LAC	   120	   364
MO.TON	   120	   364
MOHASH	  1481	  1537#
MONTB	  2203	  2216#	  2282	  2284
MORBUF	  4303%	  4480
MOVBUF	   461%	   895
MSTIME	   929	  2049#
MTR	   113	   120	   364
N.JSYS	   242#	   243
NEFTRP	    41	  1045#
NERTRP	    41	  1044#
NINTRP	    41	  1041#	  1047	  1344	  1346
NODIE	    11%	  2447
NODST1	  2147	  2150#
NODST2	  2157	  2160#
NOINT	  1326#	  1358
NOMAL	  1601	  1606#
NOMXL	  3114#	  3129	  3152	  3153	  3154	  3155	  3156	  3157	  3158	  3159	  3160	  3161	  3162	  3163
	  3164	  3165	  3166	  3167	  3168	  3169	  3170	  3171	  3172	  3173	  3174	  3175	  3176	  3177
	  3178	  3179	  3180	  3181	  3182	  3186	  3187	  3188	  3189	  3190	  3191	  3192	  3193	  3194
	  3195	  3196	  3197	  3199	  3203	  3204	  3205	  3206	  3208	  3209	  3210	  3218	  3219	  3224
	  3232	  3233	  3234	  3236	  3271	  3287	  3296	  3301	  3302	  3303	  3314
NOUTRP	    41	  1042#
NPEEK	   860	  1856#	  1884
NSPTRP	    41	  1046#
NSWMXL	  3142%	  3212
NSWTBL	  3142%	  3212
NUMINT	  1047#	  1339
NUMTAB	  1801	  2990	  3037	  3089	  3097	  3098	  3120	  3124	  3128	  3133	  3135	  3140	  3199#	  3223
	  3337
NWATRP	    41	  1043#
NXCHAN	  1325#	  1362
NXCOND	  1324#	  1360
NXICHN	  1323#	  1327
NXMAL	  1598#	  1606
ODPMXL	  3145%	  3216
ODPTBL	  3145%	  3216
ONEJOB	   899	  2848#
OPRDTM	  2488%	  2488
OPRSET	  2386	  2500#
OPRSND	  2381%	  2381
OTFSET	   458%	   864
OTHUSR	   951	   961#
P	    12	    70	    77	    78	    79	    80	    82	    84	    87	    93	   110	   114	   115	   117
	   118	   121	   127	   320	   332	   344	   345	   354	   356	   358	   362	   383	   385	   433
	   961	   962	   963	   978	   994	   995	   999	  1004	  1019	  1020	  1023	  1033	  1082	  1083
	  1096	  1132	  1135	  1137	  1138	  1164	  1186	  1190	  1193	  1195	  1217	  1221	  1226	  1261
	  1270	  1272	  1273	  1275	  1277	  1329	  1331	  1333	  1335	  1349	  1353	  1364	  1377	  1378
	  1379	  1381	  1383	  1387	  1389	  1393	  1397	  1398	  1399	  1400	  1401	  1402	  1403	  1404
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

	  1408	  1409	  1411	  1412	  1428	  1431	  1437	  1438	  1439	  1441	  1446	  1447	  1448	  1450	  1475
	  1478	  1481	  1485	  1500	  1505	  1509	  1513	  1519	  1522	  1523	  1524	  1533	  1544	  1572
	  1576	  1579	  1582	  1583	  1588	  1590	  1602	  1605	  1607	  1628	  1631	  1656	  1667	  1708
	  1716	  1733	  1750	  1797	  1804	  1811	  1817	  1834	  1843	  1845	  1846	  1848	  1858	  1860
	  1861	  1876	  1884	  1886	  1897	  1901	  1902	  1906	  1907	  1916	  1943	  1963	  1966	  1967
	  1970	  1971	  1992	  1995	  1998	  2023	  2029	  2032	  2039	  2042	  2049	  2054	  2062	  2066
	  2069	  2087	  2088	  2108	  2123	  2141	  2143	  2148	  2158	  2160	  2174	  2175	  2176	  2177
	  2179	  2180	  2181	  2188	  2197	  2199	  2201	  2208	  2213	  2220	  2221	  2222	  2223	  2225
	  2226	  2227	  2231	  2233	  2239	  2242	  2245	  2256	  2257	  2259	  2261	  2267	  2289	  2302
	  2369	  2377	  2400	  2401	  2403	  2405	  2406	  2418	  2419	  2421	  2423	  2424	  2425	  2447
	  2448	  2450	  2457	  2458	  2460	  2461	  2462	  2464	  2483	  2486	  2487	  2494	  2500	  2503
	  2545	  2550	  2553	  2556	  2559	  2599	  2610	  2661	  2670	  2705	  2709	  2712	  2716	  2717
	  2718	  2722	  2723	  2724	  2729	  2734	  2744	  2753	  2756	  2758	  2771	  2777	  2792	  2796
	  2823	  2833	  2835	  2840	  2844	  2851	  2856	  2863	  2870	  2872	  2875	  2877	  2880	  2907
	  2910	  2938	  2941	  2942	  2943	  2975	  2976	  2978	  2984	  2990	  2991	  2993	  2995	  2999
	  3000	  3050	  3051	  3054	  3062	  3071	  3072	  3083	  3092	  3096	  3123	  3127	  3132	  3347
	  3348	  3349	  3350	  3356	  3357	  3358	  3359	  3366	  3367	  3368	  3369	  3373	  3374	  3375
	  3381	  3382	  3383	  3391	  3392	  3402	  3479	  3480	  3487	  3490	  3491	  3492	  3494	  3498
	  3499	  3502	  3503	  3507	  3510	  3511	  3517	  3519	  3523	  3524	  3527	  3528	  3532	  3535
	  3536	  3540	  3543	  3544	  3548	  3550	  3554	  3555	  3558	  3559	  3563	  3565	  3569	  3570
	  3573	  3574	  3587	  3589	  3593	  3594	  3597	  3598	  3607	  3608	  3610	  3611	  3614	  3615
	  3617	  3619	  3621	  3622	  3623	  3632	  3635	  3636	  3637	  3639	  3643	  3644	  3647	  3648
	  3653	  3656	  3657	  3658	  3660	  3664	  3665	  3668	  3669	  3673	  3675	  3679	  3680	  3683
	  3684	  3688	  3690	  3694	  3695	  3698	  3699	  3709	  3711	  3715	  3716	  3719	  3720	  3724
	  3725	  3726	  3729	  3730	  3991	  4026	  4075	  4076	  4130	  4325	  4384	  4385	  4388	  4389
	  4390	  4393	  4396	  4398	  4400	  4402	  4404	  4405	  4427	  4437	  4440	  4446	  4478	  4480
	  4503	  4505	  4506	  4509	  4512	  4514	  4516	  4518	  4519	  4531	  4563	  4566	  4569	  4571
	  4573	  4575	  4580	  4587	  4590	  4593	  4698	  4708	  4712	  4733	  4735	  4738	  4741	  4743
	  4745	  4747	  4748	  4749	  4771	  4775	  4776	  4777
P1	  1348	  1352	  1476	  1493	  1537	  1538	  1539	  1597	  1599	  1600	  1604	  1606	  1622	  1623
	  1624	  1671	  1682	  1683	  1684	  1686	  1688	  1694	  1759	  1772	  1776	  1780	  1782	  1783
	  1788	  1806	  1820	  1822	  2774	  2779	  2782	  2783	  2785	  2891	  2892	  2893	  2909	  4386
	  4409	  4418	  4424	  4429	  4465	  4466	  4467	  4469	  4470	  4482	  4504	  4520	  4532	  4562
	  4682	  4685	  4689	  4691	  4709	  4710	  4734
P2	  1502	  2899	  2903	  2905	  4405	  4406	  4415	  4431	  4455	  4456	  4483	  4519	  4528	  4530
	  4533	  4668	  4669	  4683	  4697	  4705	  4710	  4711	  4713
P3	  1489	  2901	  2902	  2903	  2987	  2988	  2996	  3028	  3029	  3030	  3031	  3032	  4408	  4412
	  4416	  4419	  4423	  4432	  4436	  4452	  4453	  4457	  4458	  4471	  4472	  4484	  4578	  4579
	  4581	  4669	  4674
P4	   384	  1496	  1503	  1508	  1518	  2063	  2064	  2065	  2086	  2110	  2128	  2129	  2130	  2131
	  2133	  2146	  2150	  2153	  2156	  2167	  2404	  2422	  2974	  2989	  4316	  4317	  4318	  4320
	  4321	  4322	  4323	  4324	  4356	  4360	  4410	  4414	  4430	  4451	  4481	  4676	  4679	  4684
	  4699	  4717
PAG	    68	   365
PC.PUB	  1084
PC.UIO	  1991
PC.USR	  1084
PDNMUP	    66#	    82	    87	   117	  1992	  1998	  2938
PEKCHK	  1860	  1901	  1911#	  1970
PFW.A	  1875	  1941	  1942
PFW.W	  1941	  1942
PG	  1063	  1064	  1066	  1068	  1069	  1071	  1072	  1076	  1077	  1079	  1080	  1912	  1913	  1914
	  1915	  1917	  1919	  1921	  1925	  4353
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

PGE.A	   384	  1921
PGE.P	  1921
PGE.W	   384	  1921
PGYNXM	    43%	  1918
PHONLY	   427	   430
PJOBN	  1665	  1714	  2739%	  2739
POKCHK	  1906	  1938#	  1966
POKE	   902	  1895#
POKE1	  1900	  1906#
POLPRT	   455%	   868
PPNLUP	  2868#	  2873
PRTDEC	  2457%	  2457	  2461%	  2461
PRVMSK	  1166	  1176	  1203#
PS.CPR	  1061%	  1076
PS.FIL	  1061%	  1066
PTSBAJ	  4698#
PTSR1	  4702#
PTSR2	  4711#	  4713
PTSRFX	  4677	  4681	  4687	  4690	  4700	  4717#
PUTBUF	  4303%	  4398	  4400	  4402	  4427	  4437	  4478	  4514	  4516	  4518	  4531	  4571	  4573	  4575
	  4580	  4587	  4590	  4593	  4712	  4743	  4745	  4747	  4749
PUTROY	   865	  4732#
PUTSAR	   882	  4668#
PUUOAC	    56%	   165
PVACTS	  3081
PVDINA	  1171	  1174	  1197	  1203	  2932
PVEXO	  1203
PVLOS	  1167
PVMAIL	  1603
PVMCOR	  1203
PVMHNG	  1203
PVMMOD	  1203
PVMTIM	  1203
PVNMAI	  1203	  1580
PVNOAT	  1203
PVRCMD	  1203
PVSCMD	  1203
PVYCOR	  1180	  1185	  1285%	  2924	  2930
PVYCRM	  1179	  1285%	  2925
PVYTIM	  2125%	  2125
PWSGET	  3157	  3391#
PX.MEM	   339	   346	   407	   437	  1024	  1034	  1160	  1162	  1219	  1222	  1223	  1228	  1230	  1232
	  1345	  1363	  1431	  1434	  1440	  1445	  1449	  1473	  1476	  1479	  1480	  1510	  1521	  1573
	  1591	  1593	  1596	  1625	  1646	  1670	  1681	  1688	  1693	  1695	  1701	  1718	  1735	  1758
	  1767	  1775	  1779	  1787	  1799	  1819	  1833	  1847	  1863	  1898	  1899	  1965	  1975	  1976
	  1977	  2031	  2041	  2053	  2063	  2068	  2084	  2085	  2086	  2089	  2090	  2546	  2547	  2554
	  2557	  2558	  2588	  2594	  2604	  2614	  2656	  2711	  2743	  2752	  2755	  2763	  2773	  2776
	  2793	  2799	  2826	  2862	  2869	  2874	  2879	  2901	  2938	  3100	  3136	  3351	  3360	  3370
	  3371	  3377	  3379	  3385	  3387	  3394	  3396	  3407	  3733	  3994	  4043	  4072	  4126	  4135
	  4141	  4147	  4324	  4371	  4372	  4415	  4445	  4455	  4456	  4530	  4533	  4632	  4639	  4668
	  4694	  4695	  4705	  4711	  4717
PX.SRC	  2594	  2604
RDHIST	   455%	   867
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

REASSI	   912%	   928
RECMFL	   883	  1160#
REDNXT	   901	  1564#
REDPIP	   454%	   889
REMAP	   935	  2698#
RESET	   920	   995	  1020	  1063#
RESFRH	  1061%	  1096
REST	  2391	  2655#
RETACH	   455%	   860
RETERR	  1155	  1157	  1322	  1334	  1359	  1361	  1363#
REUSER	  2655%	  2655	  2662%	  2662
ROYARL	  4729#	  4734	  4740
ROYTAR	  4728#	  4739
RSET1	  1067	  1075#
RSET2	  1074	  1078	  1082#
RTZER	  1840	  1844	  1885	  2755#	  2759	  2797	  2824
S$CPU	   127	   128
S$DEBU	  2723	  2724
S$ENTR	    11	    17	    71	    94	   128	   321	  2448	  2471	  2718	  2724
S$EVEN	    70	    93	   127	   320	  2447	  2448	  2717	  2723
S$HALT	    11	    70	    93	   127	   320	  2447	  2471	  2717	  2723
S$INFO	    70	    93	   127	   320	  2447	  2717	  2723
S$JOB	    93	    94	   320	   321	  2717	  2718
S$NAME	    15#
S$NONA	    14	    17	    71	    94	   128	   321	  2448	  2472	  2718	  2724
S$PATC	    70	    93	   127	   320	  2447	  2717	  2723
S$STOP	    70	    71
S$TEMP	    11#	    11	    70#	    70	    93#	    93	   127#	   127	   320#	   320	  2447#	  2447	  2471#	  2471
	  2717#	  2717	  2723#	  2723
S$XCT	    17	    71	    94	   128	   321	  2448	  2471	  2472	  2718	  2724
S..CI7	  2723#
S..JOB	  2717#
SAVCHG	  1086	  4050%	  4117	  4128	  4381
SCHPRV	  2525	  2526
SCHSET	  2382	  2493#
SCSPRV	  2388	  2523#
SD	  2785
SEC2JF	  2180	  2185#	  2199
SEC2YR	  2176	  2199#
SETALP	   863	  1215#
SETBL	  3148%	  3242
SETDDT	   921	  2862#
SETE	   903	  1472#
SETECD	  1469%	  1518
SETELV	  1469%	  1520
SETENM	  1469%	  1512
SETINA	   856	  1188#
SETJAL	   898	  2829#
SETLC1	  1388#
SETLE1	  1130	  1153#
SETLE2	  1140	  1154#
SETLE3	  1145	  1156#
SETLI0	  1131	  1139#
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

SETLI1	  1143	  1146#
SETLI2	  1126	  1149#
SETLIC	   903	  1375#
SETLIM	   855	  1126#
SETMAI	   856	  1570#
SETMAL	   899	  1585#
SETMCY	   461%	   857
SETMOD	   461%	   896
SETMXL	  3148%	  3242
SETNAM	   937	  3342#
SETPID	   457%	   866
SETPOV	   916%	   933
SETPRV	   902	  1166#
SETTIM	   453%	   891
SETTLK	  2389	  2545#
SETTMC	  1561#
SETTR1	   453%	   891
SETTR2	   453%	   890
SETUU1	  2371	  2373	  2378#
SETUUO	   950	  2367#
SETUWP	   935	  2687#
SETWTC	  2387	  2508#
SIMJSW	  3209	  3401#
SIMLEN	   209	   240#
SIMTBL	   210	   212	   216#	   240
SIXSTP	   744#	   746	   746#	   747	   748	   749	   750	   751	   752	   753	   754	   755	   756	   757
	   758	   759	   760	   761	   762	   763	   764	   765	   766	   767	   768	   769	   770	   771
	   835#	   894#
SIZRET	  2780	  2788	  2792#
SKDCOM	  2496%	  2496
SLEEP	   916%	   932
SNOOPU	   455%	   868
SOAKEM	   884	  2804#
SPCGSW	  2709%	  2709
SRNAO	  4652#	  4699
SRNLIC	  4650#	  4679
SRPREF	  1516%	  1516
SRSZW	  4651#	  4684
STATES	  2475%	  2475	  2848	  2860%
STDRNG	    62%	  2790
STKAC	    58%	   106
STOLMA	   372%	   385
STRBTS	  1515%	  1515
STRDDB	  1514%	  1514
STRTAD	    43%	   338
STRTCL	    43%	   340
STRUUO	   915%	   940
STSMXL	  3109%	  3228
STSTBL	  3109%	  3228
STTLK	  2550%	  2550
STVSET	   461%	   859
SUUNUM	  2368	  2394#
SUUTAB	  2370	  2378	  2381#	  2394
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

SWITCH	   928	  2707#
SWPMXL	  3146%	  3213
SWPTBL	  3146%	  3213
SYDBF0	  1722#	  1723	  1736
SYDBF1	  1737#	  1746
SYDBF2	  1740#	  1744
SYDBF3	  1743#	  1755
SYDBF4	  1737	  1749#
SYDBF5	  1742	  1752#
SYDBF6	  1752	  1753	  1757#
SYDBF7	  1763#	  1766
SYDBF8	  1772#	  1790
SYDBUF	  1639	  1731#
SYDCOM	  1675	  1681#	  1824	  1828	  1830
SYDDSP	  1629	  1630	  1633#	  1642
SYDFTA	  1637%	  1637
SYDJBT	  1640	  1795#
SYDLC1	  1703	  1713#
SYDLC2	  1705	  1710#	  1717
SYDLC3	  1704#	  1707
SYDLC5	  1671#	  1719
SYDLOC	  1634	  1700#
SYDNAM	  1633	  1645#
SYDNM1	  1649	  1661#
SYDNM2	  1653	  1658#	  1663	  1668
SYDNM3	  1650#	  1655
SYDNM4	  1660	  1693#	  1712	  1749
SYDNM5	  1684#
SYDSPY	  1641	  1815#
SYDSTR	  1636%	  1636
SYDTBL	  1627	  1642#
SYDTMX	  1638%	  1638
SYDUNI	  1635%	  1635
SYSDEV	  2760
SYSDVF	   897	  1621#
SYSMXL	  3248%	  3248
SYSPHY	   915%	   940
SYSPPN	  1585	  2376	  2761%	  2761
SYSTBL	  3248%	  3248
SYSTUU	   915%	   939
SYSUDT	  2484%	  2484	  2485%	  2485
SYSWAY	  2981#	  3035
T1	    84	   113	   114	   118	   119	   317	   318	   319	   322	   323	   324	   325	   326	   327
	   329	   330	   331	   347	   348	   350	   375	   376	   378	   379	   386	   407	   411	   437
	   989	   991	   992	   998	  1003	  1015	  1017	  1018	  1022	  1028	  1030	  1031	  1032	  1084
	  1085	  1086	  1087	  1089	  1090	  1091	  1093	  1094	  1095	  1097	  1098	  1099	  1126	  1127
	  1128	  1132	  1133	  1136	  1137	  1139	  1141	  1144	  1146	  1149	  1150	  1160	  1162	  1168
	  1169	  1178	  1179	  1181	  1182	  1189	  1191	  1192	  1196	  1199	  1219	  1222	  1223	  1228
	  1230	  1232	  1239	  1240	  1241	  1253	  1254	  1255	  1257	  1272	  1275	  1276	  1279	  1280
	  1328	  1329	  1330	  1333	  1335	  1338	  1341	  1342	  1346	  1347	  1348	  1352	  1377	  1394
	  1405	  1406	  1429	  1430	  1438	  1440	  1446	  1449	  1472	  1491	  1492	  1502	  1503	  1510
	  1511	  1512	  1517	  1518	  1520	  1522	  1524	  1525	  1532	  1570	  1571	  1573	  1574	  1575
	  1577	  1581	  1586	  1591	  1592	  1593	  1594	  1596	  1600	  1602	  1603	  1604	  1605	  1621
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

	  1622	  1626	  1627	  1629	  1630	  1646	  1649	  1651	  1669	  1670	  1673	  1674	  1681	  1682	  1683
	  1701	  1703	  1704	  1731	  1732	  1735	  1740	  1741	  1749	  1752	  1754	  1757	  1758	  1763
	  1764	  1774	  1775	  1778	  1779	  1781	  1782	  1783	  1786	  1788	  1795	  1796	  1799	  1800
	  1815	  1816	  1822	  1825	  1838	  1839	  1841	  1847	  1859	  1862	  1863	  1872	  1874	  1878
	  1898	  1899	  1900	  1903	  1908	  1911	  1912	  1928	  1938	  1940	  1964	  1965	  1966	  1968
	  1972	  1978	  1979	  1981	  1982	  1996	  1997	  2019	  2022	  2030	  2040	  2041	  2050	  2051
	  2052	  2053	  2067	  2083	  2084	  2089	  2142	  2145	  2149	  2152	  2155	  2159	  2161	  2162
	  2165	  2187	  2191	  2196	  2237	  2246	  2248	  2249	  2250	  2251	  2255	  2263	  2266	  2267
	  2268	  2299	  2301	  2367	  2399	  2402	  2408	  2409	  2416	  2417	  2418	  2421	  2439	  2452
	  2453	  2454	  2455	  2456	  2469	  2474	  2475	  2481	  2495	  2502	  2508	  2509	  2510	  2524
	  2545	  2546	  2547	  2548	  2549	  2554	  2555	  2586	  2587	  2588	  2590	  2592	  2594	  2600
	  2601	  2602	  2604	  2613	  2614	  2657	  2662	  2669	  2671	  2672	  2673	  2678	  2711	  2735
	  2736	  2738	  2741	  2742	  2743	  2748	  2749	  2751	  2752	  2761	  2762	  2763	  2772	  2773
	  2774	  2776	  2778	  2780	  2784	  2786	  2789	  2790	  2791	  2793	  2798	  2799	  2804	  2805
	  2806	  2807	  2808	  2809	  2825	  2826	  2835	  2836	  2837	  2838	  2839	  2840	  2841	  2842
	  2843	  2848	  2849	  2850	  2852	  2853	  2855	  2857	  2862	  2866	  2869	  2871	  2874	  2878
	  2879	  2890	  2898	  2908	  2916	  2918	  2919	  2920	  2922	  2924	  2926	  2927	  2928	  2929
	  2930	  2932	  2933	  2934	  2935	  2936	  2938	  2939	  2940	  2965	  2966	  2975	  2978	  2990
	  3037	  3062	  3063	  3072	  3073	  3074	  3076	  3077	  3078	  3079	  3081	  3082	  3088	  3098
	  3099	  3100	  3116	  3119	  3128	  3133	  3135	  3136	  3342	  3344	  3351	  3370	  3376	  3377
	  3378	  3379	  3384	  3385	  3386	  3387	  3393	  3394	  3395	  3396	  3403	  3404	  3405	  3406
	  3407	  3484	  3486	  3487	  3488	  3489	  3490	  3491	  3493	  3494	  3495	  3496	  3497	  3498
	  3501	  3503	  3505	  3506	  3509	  3511	  3514	  3515	  3516	  3518	  3519	  3520	  3521	  3522
	  3523	  3526	  3528	  3530	  3531	  3534	  3536	  3538	  3539	  3542	  3544	  3546	  3547	  3549
	  3550	  3551	  3552	  3553	  3554	  3557	  3559	  3561	  3562	  3564	  3565	  3566	  3567	  3568
	  3569	  3572	  3574	  3577	  3578	  3579	  3580	  3585	  3586	  3588	  3589	  3590	  3591	  3592
	  3593	  3596	  3598	  3608	  3609	  3610	  3613	  3614	  3615	  3616	  3619	  3620	  3622	  3623
	  3629	  3631	  3632	  3633	  3634	  3635	  3636	  3638	  3639	  3640	  3641	  3642	  3643	  3646
	  3648	  3650	  3652	  3653	  3654	  3655	  3656	  3657	  3659	  3660	  3661	  3662	  3663	  3664
	  3667	  3669	  3671	  3672	  3674	  3675	  3676	  3677	  3678	  3679	  3682	  3684	  3686	  3687
	  3689	  3690	  3691	  3692	  3693	  3694	  3697	  3699	  3702	  3703	  3704	  3705	  3706	  3707
	  3708	  3710	  3711	  3712	  3713	  3714	  3715	  3718	  3720	  3725	  3731	  3732	  3733	  3992
	  3994	  4023	  4025	  4029	  4030	  4031	  4033	  4039	  4040	  4041	  4042	  4043	  4072	  4115
	  4119	  4122	  4125	  4126	  4134	  4135	  4140	  4141	  4146	  4147	  4367	  4368	  4370	  4372
	  4373	  4384	  4390	  4442	  4444	  4445	  4500	  4503	  4506	  4632	  4639	  4668	  4693	  4695
	  4697	  4733	  4772	  4773	  4774
T2	   171	   172	   173	   174	   175	   208	   211	   333	   334	   336	   338	   339	   340	   341
	   342	   344	   345	   346	   374	   393	   394	   395	   408	   410	   411	   413	   416	   424
	   425	   426	   429	   431	   432	   438	   440	   441	   442	  1127	  1129	  1131	  1134	  1153
	  1154	  1156	  1160	  1161	  1162	  1163	  1166	  1167	  1168	  1170	  1172	  1175	  1176	  1177
	  1180	  1181	  1182	  1183	  1184	  1185	  1188	  1189	  1197	  1198	  1200	  1215	  1216	  1219
	  1220	  1222	  1224	  1228	  1229	  1230	  1231	  1232	  1233	  1258	  1260	  1262	  1263	  1265
	  1266	  1268	  1269	  1327	  1338	  1339	  1344	  1346	  1358	  1360	  1362	  1363	  1375	  1376
	  1379	  1380	  1382	  1383	  1386	  1388	  1389	  1390	  1391	  1392	  1397	  1400	  1401	  1403
	  1404	  1407	  1408	  1410	  1411	  1433	  1434	  1444	  1473	  1477	  1480	  1493	  1514	  1515
	  1516	  1520	  1521	  1526	  1527	  1529	  1530	  1531	  1577	  1578	  1580	  1581	  1585	  1594
	  1598	  1599	  1648	  1650	  1661	  1662	  1784	  1785	  1787	  1800	  1801	  1802	  1803	  1805
	  1825	  1826	  1827	  1856	  1857	  1874	  1875	  1895	  1896	  1940	  1941	  1942	  1961	  1962
	  1973	  1974	  1976	  1978	  1981	  1991	  1992	  1998	  2018	  2020	  2030	  2031	  2040	  2050
	  2067	  2068	  2085	  2090	  2109	  2122	  2124	  2141	  2143	  2144	  2145	  2150	  2151	  2152
	  2153	  2154	  2155	  2163	  2164	  2165	  2185	  2190	  2191	  2192	  2193	  2195	  2196	  2200
	  2202	  2204	  2209	  2211	  2212	  2213	  2232	  2238	  2240	  2241	  2253	  2254	  2260	  2261
	  2265	  2271	  2272	  2277	  2285	  2286	  2287	  2288	  2367	  2368	  2370	  2374	  2378	  2379
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

	  2399	  2400	  2403	  2410	  2436	  2470	  2482	  2485	  2495	  2523	  2525	  2526	  2527	  2546	  2557
	  2593	  2594	  2595	  2597	  2598	  2604	  2605	  2607	  2611	  2612	  2655	  2656	  2659	  2660
	  2668	  2669	  2739	  2740	  2781	  2783	  2787	  2806	  2810	  2829	  2830	  2831	  2832	  2834
	  2836	  2838	  2854	  2855	  2867	  2868	  2869	  2871	  2873	  2887	  2888	  2890	  2891	  2900
	  2911	  2912	  2925	  2926	  2927	  2981	  2982	  2983	  3069	  3074	  3077	  3082	  3089	  3090
	  3091	  3097	  3099	  3119	  3120	  3121	  3122	  3124	  3128	  3129	  3131	  3133	  3134	  3360
	  3371	  3404	  3406	  3485	  3488	  3492	  3495	  3497	  3499	  3500	  3502	  3507	  3508	  3510
	  3517	  3520	  3522	  3524	  3525	  3527	  3532	  3533	  3535	  3540	  3541	  3543	  3548	  3551
	  3553	  3555	  3556	  3558	  3563	  3566	  3568	  3570	  3571	  3573	  3581	  3582	  3584	  3585
	  3587	  3590	  3592	  3594	  3595	  3597	  3605	  3606	  3607	  3609	  3611	  3616	  3617	  3630
	  3633	  3637	  3640	  3642	  3644	  3645	  3647	  3651	  3654	  3658	  3661	  3663	  3665	  3666
	  3668	  3673	  3676	  3678	  3680	  3681	  3683	  3688	  3691	  3693	  3695	  3696	  3698	  3709
	  3712	  3714	  3716	  3717	  3719	  3724	  4024	  4025	  4027	  4028	  4029	  4034	  4039	  4040
	  4072	  4073	  4074	  4078	  4116	  4120	  4121	  4126	  4131	  4136	  4137	  4141	  4143	  4148
	  4149	  4364	  4365	  4368	  4369	  4370	  4371	  4372	  4379	  4385	  4389	  4479	  4497	  4498
	  4500	  4501	  4559	  4560	  4629	  4630	  4632	  4633	  4635	  4638	  4639	  4673	  4674	  4683
	  4685	  4688	  4689	  4691	  4693	  4694
T2POPJ	    61%	  2214	  2269
T3	   210	   211	   356	   359	  1169	  1171	  1173	  1174	  1223	  1225	  1257	  1259	  1260	  1269
	  1344	  1345	  1430	  1432	  1435	  1445	  1482	  1483	  1625	  1626	  1658	  1710	  1753	  1762
	  1764	  1767	  1918	  1920	  1924	  1925	  1968	  1972	  1975	  1977	  1979	  1982	  1993	  1994
	  2125	  2126	  2127	  2129	  2131	  2133	  2134	  2160	  2164	  2167	  2168	  2186	  2187	  2194
	  2201	  2203	  2205	  2207	  2208	  2209	  2210	  2212	  2244	  2247	  2249	  2252	  2254	  2262
	  2263	  2264	  2265	  2273	  2275	  2276	  2277	  2280	  2282	  2284	  2288	  2298	  2299	  2301
	  2303	  2304	  2370	  2371	  2372	  2375	  2376	  2436	  2437	  2438	  2439	  2440	  2441	  2442
	  2443	  2444	  2446	  2553	  2557	  2558	  2589	  2593	  2607	  2612	  3093	  3094	  3095	  4117
	  4118	  4119	  4120	  4127	  4133	  4138	  4142	  4145	  4150	  4350	  4373	  4374	  4375	  4378
	  4381	  4382	  4394	  4397	  4399	  4401	  4419	  4420	  4425	  4435	  4510	  4513	  4515	  4517
	  4529	  4530	  4567	  4570	  4572	  4574	  4579	  4586	  4589	  4592	  4633	  4634	  4635	  4636
	  4672	  4675	  4677	  4678	  4702	  4703	  4704	  4705	  4711	  4739	  4742	  4744	  4746	  4748
T4	   209	   210	   212	   213	  1024	  1034	  1349	  1491	  1493	  1494	  1495	  1496	  1497	  1498
	  1504	  1587	  1738	  1739	  1741	  1743	  1744	  1757	  1761	  1763	  1765	  1766	  1898	  1903
	  1908	  1964	  1965	  1976	  1977	  2245	  2246	  2251	  2256	  2278	  2279	  2280	  2281	  2282
	  2283	  2284	  2286	  2548	  2558	  2603	  2606	  2608	  4128	  4129	  4133	  4135	  4145	  4147
	  4351	  4377	  4378	  4379	  4380	  4395	  4418	  4421	  4511	  4568	  4678	  4680	  4686	  4687
	  4688	  4740
TAJWAY	  2995#	  3036
TAKTRP	  1321%	  1353
TATUUO	  1273	  1285%
TCCARL	  4539#	  4562	  4568
TCCNHW	  4538#	  4539
TCCTAR	  4537#	  4567
TDT2YR	  2179	  2191#
TDTUUO	  1256	  1285%
THSDAT	  1541%	  1541	  2018%	  2018	  2020%	  2020	  2238%	  2238	  2407%	  2407	  2410%	  2410	  2433%	  2433
	  2437%	  2437	  2470%	  2470	  2482%	  2482	  4704
TIMADJ	  1845	  2995	  3110%	  3347	  3356	  3366	  3373	  3381	  4076
TIME	  2019%	  2019	  2237%	  2237	  2409%	  2409	  2434%	  2434	  2440%	  2440	  2469%	  2469	  2481%	  2481
	  4702%	  4702
TIMEF	    57%	   353
TIMEOK	  2447#	  2471
TIMER	   929	  2039#
TIMSET	  2384	  2416#
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

TINASS	   453%	   890
TKROM%	  2555%	  2555
TMP.UU	   914%	   938
TPOPJ	    61%	  1274	  2420	  2977	  2992	  3080	  3084	  4736
TPOPJ1	    61%	  2552	  3075	  3078
TRNARL	  4489#	  4504	  4511	  4520
TRNNHW	  4490#	  4520
TRNTAR	  4488#	  4510
TRUGET	  3162	  3366#
TRUGN	  3205	  3347#
TRUGN2	  3163	  3356#
TRYATT	  1264	  1267	  1272#
TTYFND	    62%	  2877
TTYFNU	    51%	  2500
TTYFUW	  2943%	  2943
TTYMXL	  3147%	  3268
TTYRES	    46%	  1082
TTYTAB	   975	  2916	  3109%	  3210	  3731
TTYTBL	  3147%	  3268
TTYUSM	   972%	   978
TTYUUO	    62%	  1556	  1559	  1562	  1565	  1568
U	   174	   175	   176	   441	   442	   443	   976	   977	  1647	  1650	  1651	  1654	  1655	  1659
	  1660	  1661	  1664	  1666	  1669	  1673	  1687	  1702	  1704	  1706	  1707	  1711	  1712	  1713
	  1715	  1718	  1736	  1737	  1738	  1739	  1745	  1761	  1774	  1778	  1781	  1784	  1789	  1790
	  1805	  1819	  1824	  1826	  2501	  2895	  2955	  2956	  2957	  2958	  4352
U.JSYS	   216	   243#
UATTAC	   954	  1239#
UBMASK	  4327#	  4404	  4414	  4451
UCALL	   407#
UCALL1	   425	   429#
UCALL2	   428	   431#
UCALLF	   412	   416#
UCALLI	   424#
UCBADD	   459%	   869
UCBHNG	   459%	   873
UCBINI	   459%	   870
UCBINW	   459%	   870
UCBLEV	   459%	   869
UCBMEM	   459%	   871
UCBRLI	   459%	   871
UCBSTS	   459%	   872
UCBWAK	   459%	   872
UCILEN	   432	   959#
UCLJMP	   441	   442	   920#	   959
UCLLEN	   408	   827#
UCLTAB	   411	   781#	   781	   782	   783	   784	   785	   786	   787	   788	   789	   790	   791	   792
	   793	   794	   795	   796	   797	   798	   799	   800	   801	   802	   803	   804	   805	   806
	   807	   808	   809	   810	   811	   812	   813	   814	   815	   816	   817	   818	   819	   820
	   821	   822	   823	   824	   825	   826	   827
UCREAT	   456%	   879
UDEVNM	   946	  2796#
UDT2YR	  2175	  2190#
UDTFIX	  2487%	  2487
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

UGTSEG	    54%	   936
UPEEK	   933	  1884#
UPEEK1	  1859	  1872#
UPEEK2	  1873	  1878#
UPEEK3	  1863#	  1879
UPESET	   457%	   878
UPESTS	   457%	   875
UPFSTS	   457%	   874
UPGSTS	   456%	   878
UPHNLY	   426	   429
UPISTS	   458%	   862
UPNPSR	    59%
UPRERF	   456%	   876
UPROT	   456%	   879
UPRSTS	   458%	   861
UPSABK	    45%	   336
UPSJOB	  1854%	  1926
UPSPSR	    59%
UPSSWE	    45%	   334
UPTABK	    44%	   396
UPTACP	    58%	   105
UPTALD	  1220%	  1220	  1229%	  1229
UPTALN	  1218	  1225%	  1225	  1233%	  1233
UPTALP	  1224%	  1224	  1231%	  1231
UPTCHG	  4050%	  4120	  4133	  4418	  4424	  4465	  4466	  4467	  4469	  4470
UPTJOB	   317%	   317
UPTLKJ	   318%	   318	   319%	   319
UPTLOG	  2921%	  2921	  2922%	  2922	  2955%	  2955
UPTMUP	    74	    78	   110	   121	   359	   367
UPTMUU	    71	   109
UPTNTV	    44%	   361
UPTPDL	    49%	    77	  1085
UPTPJ1	  2957%	  2957	  4666%
UPTPJ2	  2958%	  2958	  4666%
UPTPJC	  2956%	  2956	  4666%
UPTRNM	    49%	  1161
UPTRPN	    49%	  1163
UPTSTS	    43%	   333	   374	   393	  1087	  4118	  4129	  4382
UPTUUO	    49%	    72
UPTXEI	    50%	   389
UPYPSR	   331%	   331
UPYUWL	  1061%	  1090
UPYUWM	  1061%	  1089
UREMAP	  2698%	  2698
URFBIT	   456%	   877
URUN	    54%	   934
URUNHI	   452%	   896
USCHD1	    54%	   354
USRACB	    68	   365
USRSW1	   380#	   387
USRSW2	   381	   389#
USRSWE	   335	   374#
USRXIT	    85	   316#
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

USRXT7	   357#
USRXT8	   360	   363#
USTUWP	  2687%	  2687
UTRP	   330	   347	   375	   394
UTRPST	   930	  1991#
UUOABK	   337	   393#
UUOCNT	    93#
UUOCON	    11	    12#	    15
UUODSP	    80	   115	   165#
UUOEND	  4969#
UUOERR	   854	  2889%	  2889	  2894%	  2894
UUOJB0	    70#
UUOKNT	   105#
UUOLIT	  4779#
UUOMNR	    56%	   900	   904	   905	   906	   931
UUOPN1	    72#
UUOPN2	    82#	    88
UUOPN3	    81	    84#
UUOPN4	    83	    87#
UUOPNT	    68#
UUOSK1	   461%	   943
UUOSNT	   127#
UUOTAB	    62%	   174	   175
UUOXWL	   320#	   323	   325	   327
UVALID	   456%	   876
UVDSKP	   457%	   874
UWSCTL	   456%	   877
VCLEAU	   460%	   880
VFLCKU	   460%	   875
VPGFIL	   457%	   873
VPUMAX	   372%	   377
VREMOU	   460%	   880
VREPLU	   460%	   881
W	   165	   377	   379	   380	   381	   427	   430	   436	   993	  1024	  1034	  1282	  1328	  1345
	  1555	  1558	  1561	  1564	  1567	  2554	  2614	  2656
WACRHW	  4303%	  4396	  4512	  4569	  4741
WAIT	   461%	   924
WAITCH	   901	  1555#
WAKUUO	   912%	   949
WATMXL	  3148%	  3273
WATTAB	  3148%	  3273
WAYACJ	  3034#	  3157	  3160	  3161	  3162	  3163	  3205
WAYJLN	  3033#	  3175
WAYJMP	  3037#	  3168	  3172	  3173	  3176	  3178	  3184	  3185	  3198	  3209	  3215	  3220	  3221	  3224
	  3226	  3229	  3230	  3235	  3237	  3238	  3239	  3240	  3241	  3244	  3245	  3246	  3247	  3250
	  3251	  3252	  3253	  3254	  3255	  3256	  3257	  3258	  3259	  3260	  3261	  3262	  3263	  3265
	  3266	  3267	  3269	  3270	  3274	  3275	  3276	  3277	  3278	  3279	  3280	  3281	  3282	  3283
	  3284	  3285	  3286	  3288	  3289	  3290	  3291	  3292	  3293	  3294	  3295	  3297	  3298	  3299
	  3300	  3304	  3305	  3306	  3307	  3308	  3309	  3310	  3311	  3312	  3313
WAYRAD	  3032#	  3158	  3159	  3165	  3166	  3167	  3169	  3170	  3171	  3188	  3189	  3190	  3191	  3192
	  3193	  3194	  3195	  3196	  3197	  3218	  3219	  3234
WAYRDS	  3031#	  3152	  3174	  3210
WAYRFI	  3029#	  3154	  3155	  3179	  3203	  3236	  3314
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

WAYRPI	  3028#	  3153	  3156	  3177	  3182	  3200	  3204	  3208	  3271	  3296	  3301	  3302	  3303
WAYRUN	  3030#	  3180	  3181	  3199	  3232	  3233	  3287
WAYSYS	  3035#	  3212	  3213	  3216	  3231	  3242	  3243	  3248	  3249	  3264	  3268	  3273
WAYTAB	  3027#	  3028	  3029	  3030	  3031	  3032	  3033	  3034	  3035	  3036	  3037	  3134
WAYTAJ	  3036#	  3164	  3186	  3187	  3206
WAYTJB	  3044#
WCHALL	  2508
WHYMXL	  3249%	  3249
WRTACR	    64%	  2910
WSYNC	    55%
XC4FR	  4316	  4317	  4318	  4320	  4321	  4322	  4323#
XCBADC	  4328#	  4356	  4360	  4407	  4442
XCF4BA	  4321#	  4367	  4376	  4493
XCF4BB	  4322#	  4380
XCF4BC	  4319#	  4444
XCF4DA	  4454	  4457#
XCF4DP	  4413	  4451#
XCF4L0	  4412#	  4432
XCF4L1	  4429#	  4484	  4485
XCF4L2	  4429	  4431	  4435#	  4438
XCF4L3	  4436	  4440#
XCF4NA	  4318#	  4391	  4494	  4542
XCF4NL	  4316#	  4323	  4366	  4444	  4492	  4541	  4626
XCF4NS	  4317#	  4383
XCF5BA	  4493#	  4502
XCF5L1	  4528#	  4532
XCF5NA	  4494#	  4507
XCF5NL	  4492#	  4499
XCF6L1	  4579#	  4581
XCF6NA	  4542#	  4564
XCF6NL	  4541#	  4561
XCF7BC	  4320#	  4636
XCF7NL	  4626#	  4631
XCHARG	   883	  4072#
XCHARL	  4304#	  4312	  4386	  4395
XCHBAJ	  4388#
XCHCR1	  4143#	  4150
XCHCR2	  4144	  4148#
XCHCRD	  4082	  4140#
XCHCTB	  4090#	  4113	  4119	  4145	  4412	  4416	  4419	  4423	  4452	  4453	  4457	  4458	  4471	  4472
	  4579
XCHF4	  4084	  4364#
XCHF4A	  4393#
XCHF5	  4085	  4496#
XCHF6	  4086	  4558#
XCHFLN	  4113#	  4115	  4127	  4142	  4304	  4375	  4408	  4539	  4578
XCHFNT	  4078	  4080#	  4088
XCHFUN	  4074	  4088#
XCHRD1	  4131#	  4138
XCHRD2	  4132	  4136#
XCHRED	  4081	  4125#
XCHSAV	  4080	  4115#
XCHSC1	  4634	  4637#
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

XCHSCA	  4087	  4628#
XCHSV1	  4119#	  4122
XCHTAR	  4313#	  4394
XINIT	  1502	  1547#
YR2DC1	  2274	  2281#
YR2DEC	  2220	  2259	  2271#
YR2SEC	  2222	  2259#
YR2TDT	  2225	  2231	  2239	  2244#
YR2UDT	  2221	  2231#
ZAPCIR	   452%	   888
ZZ	   339#	   339	   346#	   346	   407#	   407	   437#	   437	   833#	   835	   835#	   836	   854	   855
	   855#	   856	   856#	   857	   857#	   858	   858#	   859	   859#	   860	   860#	   861	   861#	   862
	   862#	   863	   863#	   864	   864#	   865	   865#	   866	   866#	   867	   867#	   868	   868#	   869
	   869#	   870	   870#	   871	   871#	   872	   872#	   873	   873#	   874	   874#	   875	   875#	   876
	   876#	   877	   877#	   878	   878#	   879	   879#	   880	   880#	   881	   881#	   882	   882#	   883
	   883#	   884	   884#	   885	   885#	   886	   886#	   887	   887#	   888	   888#	   889	   889#	   890
	   890#	   891	   891#	   892	   892#	   893	   893#	   894	   894#	   895	   895#	   896	   896#	   897
	   897#	   898	   898#	   899	   899#	   900	   900#	   901	   901#	   902	   902#	   903	   903#	   904
	   904#	   905	   905#	   906	   906#	   907	   907#	   908#	   920	   920#	   921	   921#	   922	   922#
	   923	   923#	   924	   924#	   925	   925#	   926	   926#	   927	   927#	   928	   928#	   929	   929#
	   930	   930#	   931	   931#	   932	   932#	   933	   933#	   934	   934#	   935	   935#	   936	   936#
	   937	   937#	   938	   938#	   939	   939#	   940	   940#	   941	   941#	   942	   942#	   943	   943#
	   944	   944#	   945	   945#	   946	   946#	   947	   947#	   948	   948#	   949	   949#	   950	   950#
	   951	   951#	   952	   952#	   953	   953#	   954	   954#	   955	   955#	   956	   956#	   957	   957#
	   958	  1024#	  1024	  1034#	  1034	  1160#	  1160	  1162#	  1162	  1219#	  1219	  1222#	  1222	  1223#
	  1223	  1228#	  1228	  1230#	  1230	  1232#	  1232	  1345#	  1345	  1363#	  1363	  1431#	  1431	  1434#
	  1434	  1440#	  1440	  1445#	  1445	  1449#	  1449	  1473#	  1473	  1476#	  1476	  1479#	  1479	  1480#
	  1480	  1510#	  1510	  1521#	  1521	  1573#	  1573	  1591#	  1591	  1593#	  1593	  1596#	  1596	  1625#
	  1625	  1646#	  1646	  1670#	  1670	  1681#	  1681	  1688#	  1688	  1693#	  1693	  1695#	  1695	  1701#
	  1701	  1718#	  1718	  1735#	  1735	  1758#	  1758	  1767#	  1767	  1775#	  1775	  1779#	  1779	  1787#
	  1787	  1799#	  1799	  1819#	  1819	  1833#	  1833	  1847#	  1847	  1863#	  1863	  1898#	  1898	  1899#
	  1899	  1965#	  1965	  1975#	  1975	  1976#	  1976	  1977#	  1977	  2031#	  2031	  2041#	  2041	  2053#
	  2053	  2063#	  2063	  2068#	  2068	  2084#	  2084	  2085#	  2085	  2086#	  2086	  2089#	  2089	  2090#
	  2090	  2546#	  2546	  2547#	  2547	  2554#	  2554	  2557#	  2557	  2558#	  2558	  2588#	  2588	  2594#
	  2594	  2604#	  2604	  2614#	  2614	  2656#	  2656	  2711#	  2711	  2743#	  2743	  2752#	  2752	  2755#
	  2755	  2763#	  2763	  2773#	  2773	  2776#	  2776	  2793#	  2793	  2799#	  2799	  2826#	  2826	  2862#
	  2862	  2869#	  2869	  2874#	  2874	  2879#	  2879	  2901#	  2901	  2938#	  2938	  3100#	  3100	  3136#
	  3136	  3351#	  3351	  3360#	  3360	  3370#	  3370	  3371#	  3371	  3377#	  3377	  3379#	  3379	  3385#
	  3385	  3387#	  3387	  3394#	  3394	  3396#	  3396	  3407#	  3407	  3735#	  3743	  3743#	  3744	  3744#
	  3754	  3754#	  3755	  3755#	  3765	  3765#	  3766	  3766#	  3776	  3776#	  3777	  3777#	  3787	  3787#
	  3788	  3788#	  3806	  3810	  3814	  3818	  3827#	  3835	  3835#	  3836	  3836#	  3846	  3846#	  3847
	  3847#	  3857	  3857#	  3858	  3858#	  3868	  3868#	  3869	  3869#	  3879	  3879#	  3880	  3880#	  3898
	  3906#	  3914	  3914#	  3915	  3915#	  3925	  3925#	  3926	  3926#	  3936	  3936#	  3937	  3937#	  3947
	  3947#	  3948	  3948#	  3958	  3958#	  3959	  3959#	  3977	  3981	  3994#	  3994	  4043#	  4043	  4072#
	  4072	  4126#	  4126	  4135#	  4135	  4141#	  4141	  4147#	  4147	  4324#	  4324	  4371#	  4371	  4372#
	  4372	  4415#	  4415	  4445#	  4445	  4455#	  4455	  4456#	  4456	  4530#	  4530	  4533#	  4533	  4632#
	  4632	  4639#	  4639	  4668#	  4668	  4694#	  4694	  4695#	  4695	  4705#	  4705	  4711#	  4711	  4717#
	  4717
ZZ1	   339#	   339	   346#	   346	   407#	   407	   437#	   437	  1024#	  1024	  1034#	  1034	  1160#	  1160
	  1162#	  1162	  1219#	  1219	  1222#	  1222	  1223#	  1223	  1228#	  1228	  1230#	  1230	  1232#	  1232
	  1345#	  1345	  1363#	  1363	  1431#	  1431	  1434#	  1434	  1440#	  1440	  1445#	  1445	  1449#	  1449
	  1473#	  1473	  1476#	  1476	  1479#	  1479	  1480#	  1480	  1510#	  1510	  1521#	  1521	  1573#	  1573
	  1591#	  1591	  1593#	  1593	  1596#	  1596	  1625#	  1625	  1646#	  1646	  1670#	  1670	  1681#	  1681
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

	  1688#	  1688	  1693#	  1693	  1695#	  1695	  1701#	  1701	  1718#	  1718	  1735#	  1735	  1758#	  1758	  1767#
	  1767	  1775#	  1775	  1779#	  1779	  1787#	  1787	  1799#	  1799	  1819#	  1819	  1833#	  1833	  1847#
	  1847	  1863#	  1863	  1898#	  1898	  1899#	  1899	  1965#	  1965	  1975#	  1975	  1976#	  1976	  1977#
	  1977	  2031#	  2031	  2041#	  2041	  2053#	  2053	  2063#	  2063	  2068#	  2068	  2084#	  2084	  2085#
	  2085	  2086#	  2086	  2089#	  2089	  2090#	  2090	  2546#	  2546	  2547#	  2547	  2554#	  2554	  2557#
	  2557	  2558#	  2558	  2588#	  2588	  2594#	  2594	  2604#	  2604	  2614#	  2614	  2656#	  2656	  2711#
	  2711	  2743#	  2743	  2752#	  2752	  2755#	  2755	  2763#	  2763	  2773#	  2773	  2776#	  2776	  2793#
	  2793	  2799#	  2799	  2826#	  2826	  2862#	  2862	  2869#	  2869	  2874#	  2874	  2879#	  2879	  2901#
	  2901	  2938#	  2938	  3100#	  3100	  3136#	  3136	  3351#	  3351	  3360#	  3360	  3370#	  3370	  3371#
	  3371	  3377#	  3377	  3379#	  3379	  3385#	  3385	  3387#	  3387	  3394#	  3394	  3396#	  3396	  3407#
	  3407	  3738#	  3741	  3742	  3749#	  3752	  3753	  3760#	  3763	  3764	  3771#	  3774	  3775	  3782#
	  3785	  3786	  3793#	  3794#	  3796	  3797	  3823	  3830#	  3833	  3834	  3841#	  3844	  3845	  3852#
	  3855	  3856	  3863#	  3866	  3867	  3874#	  3877	  3878	  3885#	  3886#	  3888	  3889	  3903	  3909#
	  3912	  3913	  3920#	  3923	  3924	  3931#	  3934	  3935	  3942#	  3945	  3946	  3953#	  3956	  3957
	  3964#	  3965#	  3967	  3968	  3986	  3994#	  3994	  4043#	  4043	  4072#	  4072	  4126#	  4126	  4135#
	  4135	  4141#	  4141	  4147#	  4147	  4324#	  4324	  4371#	  4371	  4372#	  4372	  4415#	  4415	  4445#
	  4445	  4455#	  4455	  4456#	  4456	  4530#	  4530	  4533#	  4533	  4632#	  4632	  4639#	  4639	  4668#
	  4668	  4694#	  4694	  4695#	  4695	  4705#	  4705	  4711#	  4711	  4717#	  4717
%%X	  3492#	  3492	  3506#	  3506	  3507	  3516#	  3516	  3517	  3531#	  3531	  3532	  3539#	  3539	  3540
	  3547#	  3547	  3548	  3562#	  3562	  3563	  3586#	  3586	  3587	  3637#	  3637	  3658#	  3658	  3672#
	  3672	  3673	  3687#	  3687	  3688	  3708#	  3708	  3709
%%Y	  3492#	  3492	  3506#	  3506	  3507	  3516#	  3516	  3517	  3531#	  3531	  3532	  3539#	  3539	  3540
	  3547#	  3547	  3548	  3562#	  3562	  3563	  3586#	  3586	  3587	  3637#	  3637	  3658#	  3658	  3672#
	  3672	  3673	  3687#	  3687	  3688	  3708#	  3708	  3709
%%Z	  3492#	  3492	  3493	  3496	  3506#	  3506	  3516#	  3516	  3517#	  3517	  3518	  3521	  3531#	  3531
	  3539#	  3539	  3547#	  3547	  3548#	  3548	  3549	  3552	  3562#	  3562	  3563#	  3563	  3564	  3567
	  3586#	  3586	  3587#	  3587	  3588	  3591	  3637#	  3637	  3638	  3639	  3641	  3642	  3658#	  3658
	  3659	  3662	  3672#	  3672	  3673#	  3673	  3674	  3677	  3687#	  3687	  3688#	  3688	  3689	  3692
	  3708#	  3708	  3709#	  3709	  3710	  3713
%3W	  2337#	  2339	  2340	  2341	  2342	  2343	  2344	  2345	  2346	  2347	  2348	  2349	  2350	  2351
	  2352	  2353	  2354	  2355	  2356	  2357	  2358	  2359	  2360
%CTUPT	   322%	   322	   324%	   324	   326%	   326
%RB2.C	   324%	   324
%RIB.C	   322%	   322
%SAT.C	   326%	   326
%UPLMA	   372%	   379
%UPS	    43%	  1862	  1903	  1927	  1972	  1981	  1982
%UPT	    43%	    71	    72	    74	    77	    78	   105	   109	   110	   121	   317	   319	   333	   359
	   361	   367	   374	   389	   393	   396	  1085	  1087	  1161	  1163	  1218	  1220	  1224	  1225
	  1229	  1231	  1233	  2895	  2921	  2922	  4118	  4120	  4129	  4133	  4382	  4418	  4424	  4465
	  4466	  4467	  4469	  4470
%UPX	    43%	   318
.ARRAD	  2987	  2996	  3032
.ARRDS	  2988	  3031
.ARRFI	  3029
.ARRPI	  3028
.ARRUN	  3030
.ELINK	    19
.GTCRS	  3243%	  3243
.GTSLF	  3097	  3124	  3223#
.SLEXT	  1123#	  1134
.SLINC	  1124#	  1129
.SLSET	  1122#
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Symbol cross reference

.XCACC	  4358	  4426#
.XCBDP	  4360#	  4464	  4468
.XCBSP	  4356#	  4422
.XCDAC	  4362	  4477#
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Macro/Opdef cross reference

ADJBP	   179	   201#
ADJSP	   179	   185#
CHARGE	   120	   364
CHGSTS	   113
CLRPT	  1927
CLRPTO	  1927
CNAMES	   465#	   746	   835	   854
CURREN	  4330#	  4416	  4419	  4423	  4452	  4453	  4457	  4458	  4471	  4472
DADD	   179	   189#
DDIV	   179	   192#
DFN	   199#
DMUL	   179	   191#
DOUBLE	  3446#	  3484	  3629	  3650
DSUB	   179	   190#
EXECAC	    68
EXTEND	   195#
FADL	   202#
FDVL	   205#
FIX	   194#
FIXR	   196#
FLTR	   197#
FMPL	   204#
FSBL	   203#
FSC	   200#
HISAV	  4332#	  4465	  4467
IFCPU	    48	   100	   217	   232	   246	   294	   462	   463	  1865	  1931	  2703	  2708	  2709	  2710
IFNCPU	   104	  1871	  1937
JSYS	   184#	   216
LOSAV	  4333#	  4466
NAMES	   574#	   781	   920
OPSET	  3425#	  3486	  3489	  3493	  3496	  3506	  3516	  3518	  3521	  3531	  3539	  3547	  3549	  3552
	  3562	  3564	  3567	  3586	  3588	  3591	  3631	  3634	  3638	  3641	  3652	  3655	  3659	  3662
	  3672	  3674	  3677	  3687	  3689	  3692	  3708	  3710	  3713
PFALL	  1242	  1675	  2111	  2426	  2730
PJRST	   391	  1000	  1005	  1025	  1035	  1100	  1234	  1395	  1556	  1559	  1562	  1565	  1568	  2488
	  2496	  2788	  3345	  4534	  4594	  4640	  4715	  4750
PRINTF	  1810	  1829	  2731
PXCT	   339	   346	   407	   437	  1024	  1034	  1160	  1162	  1219	  1222	  1223	  1228	  1230	  1232
	  1345	  1363	  1431	  1434	  1440	  1445	  1449	  1473	  1476	  1479	  1480	  1510	  1521	  1573
	  1591	  1593	  1596	  1625	  1646	  1670	  1681	  1688	  1693	  1695	  1701	  1718	  1735	  1758
	  1767	  1775	  1779	  1787	  1799	  1819	  1833	  1847	  1863	  1898	  1899	  1965	  1975	  1976
	  1977	  2031	  2041	  2053	  2063	  2068	  2084	  2085	  2086	  2089	  2090	  2546	  2547	  2554
	  2557	  2558	  2588	  2594	  2604	  2614	  2656	  2711	  2743	  2752	  2755	  2763	  2773	  2776
	  2793	  2799	  2826	  2862	  2869	  2874	  2879	  2901	  2938	  3100	  3136	  3351	  3360	  3370
	  3371	  3377	  3379	  3385	  3387	  3394	  3396	  3407	  3733	  3994	  4043	  4072	  4126	  4135
	  4141	  4147	  4324	  4371	  4372	  4415	  4445	  4455	  4456	  4530	  4533	  4632	  4639	  4668
	  4694	  4695	  4705	  4711	  4717
PXGEN	   339	   346	   407	   437	  1024	  1034	  1160	  1162	  1219	  1222	  1223	  1228	  1230	  1232
	  1345	  1363	  1431	  1434	  1440	  1445	  1449	  1473	  1476	  1479	  1480	  1510	  1521	  1573
	  1591	  1593	  1596	  1625	  1646	  1670	  1681	  1688	  1693	  1695	  1701	  1718	  1735	  1758
	  1767	  1775	  1779	  1787	  1799	  1819	  1833	  1847	  1863	  1898	  1899	  1965	  1975	  1976
	  1977	  2031	  2041	  2053	  2063	  2068	  2084	  2085	  2086	  2089	  2090	  2546	  2547	  2554
	  2557	  2558	  2588	  2594	  2604	  2614	  2656	  2711	  2743	  2752	  2755	  2763	  2773	  2776
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Macro/Opdef cross reference

	  2793	  2799	  2826	  2862	  2869	  2874	  2879	  2901	  2938	  3100	  3136	  3351	  3360	  3370	  3371
	  3377	  3379	  3385	  3387	  3394	  3396	  3407	  3734	  3826	  3905	  3994	  4043	  4072	  4126
	  4135	  4141	  4147	  4324	  4371	  4372	  4415	  4445	  4455	  4456	  4530	  4533	  4632	  4639
	  4668	  4694	  4695	  4705	  4711	  4717
SAVVAL	  4331#	  4418	  4424	  4469	  4470
SINGL1	  3409#	  3492	  3507	  3517	  3532	  3540	  3548	  3563	  3587	  3637	  3658	  3673	  3688	  3709
SINGLE	  3430#	  3506	  3516	  3531	  3539	  3547	  3562	  3586	  3672	  3687	  3708
SINGLL	  3441#	  3505	  3530	  3538	  3546	  3561	  3671	  3686
STOPCD	    10	    70	    93	   127	   320	  2447	  2471	  2717	  2723
UFA	   198#
UMOVE	   339	   407	   437	  1024	  1034	  1160	  1162	  1219	  1222	  1223	  1228	  1230	  1232	  1434
	  1445	  1476	  1479	  1573	  1591	  1593	  1596	  1625	  1646	  1701	  1735	  1799	  1819	  1898
	  1899	  1965	  1976	  1977	  2063	  2084	  2085	  2086	  2588	  2773	  2776	  2938	  4072	  4126
	  4141	  4371	  4372	  4455	  4456	  4530	  4632	  4668	  4694	  4711
UMOVEM	   346	  1345	  1363	  1440	  1449	  1670	  1681	  1718	  1758	  1767	  1775	  1779	  1833	  1847
	  1863	  1975	  2031	  2041	  2053	  2068	  2089	  2090	  2554	  2614	  2656	  2711	  2743	  2752
	  2763	  2793	  2799	  2826	  2862	  2869	  2874	  2879	  3100	  3136	  3351	  3360	  3370	  3371
	  3377	  3379	  3385	  3387	  3394	  3396	  3407	  3732	  3993	  4043	  4135	  4147	  4445	  4533
	  4639	  4705	  4717
USERAC	   365
WAYS	  3012#	  3028	  3045
X	   739#	   746	   747	   748	   749	   750	   751	   752	   753	   754	   755	   756	   757	   758
	   759	   760	   761	   762	   763	   764	   765	   766	   767	   768	   769	   770	   771	   777#
	   781	   782	   783	   784	   785	   786	   787	   788	   789	   790	   791	   792	   793	   794
	   795	   796	   797	   798	   799	   800	   801	   802	   803	   804	   805	   806	   807	   808
	   809	   810	   811	   812	   813	   814	   815	   816	   817	   818	   819	   820	   821	   822
	   823	   824	   825	   826	   827	   829#	   835	   841#	   854	   855	   856	   857	   858	   859
	   860	   861	   862	   863	   864	   865	   866	   867	   868	   869	   870	   871	   872	   873
	   874	   875	   876	   877	   878	   879	   880	   881	   882	   883	   884	   885	   886	   887
	   888	   889	   890	   891	   892	   893	   894	   895	   896	   897	   898	   899	   900	   901
	   902	   903	   904	   905	   906	   920	   921	   922	   923	   924	   925	   926	   927	   928
	   929	   930	   931	   932	   933	   934	   935	   936	   937	   938	   939	   940	   941	   942
	   943	   944	   945	   946	   947	   948	   949	   950	   951	   952	   953	   954	   955	   956
	  3003#	  3028	  3029	  3030	  3031	  3032	  3033	  3034	  3035	  3036	  3037	  3039#	  3045	  3046
	  3047	  3048	  3049	  3050	  3051	  3052	  3053	  3054
XCTBU	  1521	  1693	  1695	  2755	  2901	  4324	  4695
XCTFU	   339	   407	   437	  1024	  1034	  1160	  1162	  1219	  1222	  1223	  1228	  1230	  1232	  1431
	  1434	  1445	  1473	  1476	  1479	  1480	  1510	  1573	  1591	  1593	  1596	  1625	  1646	  1701
	  1735	  1799	  1819	  1898	  1899	  1965	  1976	  1977	  2063	  2084	  2085	  2086	  2546	  2547
	  2588	  2594	  2604	  2773	  2776	  2938	  4072	  4126	  4141	  4371	  4372	  4415	  4455	  4456
	  4530	  4632	  4668	  4694	  4711
XCTTU	   346	  1345	  1363	  1440	  1449	  1670	  1681	  1688	  1718	  1758	  1767	  1775	  1779	  1787
	  1833	  1847	  1863	  1975	  2031	  2041	  2053	  2068	  2089	  2090	  2554	  2557	  2558	  2614
	  2656	  2711	  2743	  2752	  2763	  2793	  2799	  2826	  2862	  2869	  2874	  2879	  3100	  3136
	  3351	  3360	  3370	  3371	  3377	  3379	  3385	  3387	  3394	  3396	  3407	  3732	  3994	  4043
	  4135	  4147	  4445	  4533	  4639	  4705	  4717
XJRSTF	   206#
XP	    66	  1122	  1123	  1124	  2959
XX	   835#	   854	   855#	   855	   856#	   856	   857#	   857	   858#	   858	   859#	   859	   860#	   860
	   861#	   861	   862#	   862	   863#	   863	   864#	   864	   865#	   865	   866#	   866	   867#	   867
	   868#	   868	   869#	   869	   870#	   870	   871#	   871	   872#	   872	   873#	   873	   874#	   874
	   875#	   875	   876#	   876	   877#	   877	   878#	   878	   879#	   879	   880#	   880	   881#	   881
	   882#	   882	   883#	   883	   884#	   884	   885#	   885	   886#	   886	   887#	   887	   888#	   888
UUOCON - UUO HANDLER AND UUO ROUTINES	MACRO 12.5-46.0 14:39 13-JAN-88
UUOCON.MAC	 4-DEC-87 16:09		Macro/Opdef cross reference

	   889#	   889	   890#	   890	   891#	   891	   892#	   892	   893#	   893	   894#	   894	   895#	   895	   896#
	   896	   897#	   897	   898#	   898	   899#	   899	   900#	   900	   901#	   901	   902#	   902	   903#
	   903	   904#	   904	   905#	   905	   906#	   906	   920#	   920	   921#	   921	   922#	   922	   923#
	   923	   924#	   924	   925#	   925	   926#	   926	   927#	   927	   928#	   928	   929#	   929	   930#
	   930	   931#	   931	   932#	   932	   933#	   933	   934#	   934	   935#	   935	   936#	   936	   937#
	   937	   938#	   938	   939#	   939	   940#	   940	   941#	   941	   942#	   942	   943#	   943	   944#
	   944	   945#	   945	   946#	   946	   947#	   947	   948#	   948	   949#	   949	   950#	   950	   951#
	   951	   952#	   952	   953#	   953	   954#	   954	   955#	   955	   956#	   956
$END	  4779   +G1k