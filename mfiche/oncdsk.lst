ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 1
S.MAC	13-JAN-88 11:55		S.MAC - with system parameter file for P035/D, January 1988

     1				SUBTTL	S.MAC - with system parameter file for P035/D, January 1988
     2
     3				IF2,<IFNDEF LISTSN,<TAPE>>	;Skip to PASS2 in all but COMMON.LST
     4				;THIS MODULE ASSEMBLED WITH KL-10 PARAMETER FILE - KLSYM.MAC
     5
     6					IF2,<IFNDEF LISTSN,<		;LIST KLSYM.MAC IN COMMON ONLY
     7								TAPE>>
     8				TITLE	ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE
     9
    10				;*;	STOPCD(,ENTRY,ONCDSK)	;Macro is expanded after the PHASE statement
    11
    12				INTERN FILOPT,FILMAN,TYPONL,ONDSTT,ONDLNP,ONDLNR
    13				INTERN MIN,MAX,LNGMES,DECLOP,CMDSCN,CMDSCF,ASKQMM,OPAGIN,OPAGOT
    14				INTERN GETHOM,WTBOTH,GETBAT
    15
    16				;CONMES = output ASCIZ string, addr in T1
    17				;TYPDEC = output P1 as decimal
    18				;CRLF   = output CRLF
    19				;DECLOP = save ACs, message in T1, TYPDEC, CRFLOP
    20				;ASKQUE = save ACs, then YESNO
    21				;YESNO  = output string, get response, skip if "Y"
    22				;CONOUT = CONMES + CRLFOP
    23				;CRLFOP = CRLF + OPOUT
    24				;OPOUT  = output buffer, can be suppressed by ^O or ^C
    25				;OCONM  = cancel ^O suppression, then CONMES
    26
    27				EXTERN BATCNT,BATPAT,HOMSUF,PRT22A,UNICHR,UNYBPR,UNYBPT,UNYBPY
    28				EXTERN CONMES,CRLF,CTEXT,DECIN,GETLIN,OCONM,OCTIN,OPOUT,DSKDDB
    29				EXTERN CORZER,SCNBAT,STTPTR,UNTTBL,STTFPC,UNTLEN
    30				EXTERN STTLEN,SATCNT,UFDHSI
    31				EXTERN NMRBPC,CPOPJ,CPOPJ1,MFDRIB
    32				EXTERN %HOM.P,%BAT.P,%STR.P,%STA.P
    33				EXTERN COMTYO,BRMAX,INLMES,NMSTPC
    34				EXTERN CLRSND,PRNAME,RADX10,TPOPJ,CMPLOG
    35				EXTERN PAGIN,PAGOUT,PCISTS,PGYUNI,PGYPNO,STDREA,PGYERR,OHTNUM,OHTINI
    36				EXTERN PCBPAG,PAKREF,STDWRT,GETPEV
    37				EXTERN BATFIR,BATREG,BAYNBB,BATNBB,BATELB,PAGCOD,PAGNAM,PAGSLF
    38				EXTERN CODBAT,CODHOM,CODRIB,DDBLEN,DDSTAR,ONCDDB
    39				EXTERN ICPFAC,JFYSEC,KONDWN,KONUPA,KOPDWN,KONLTM,KONCPY
    40				EXTERN LPNHOM,LP2HOM,LPNBAT,LP2BAT,SYSUNI,SYSSIZ,EVASIZ
    41				EXTERN REFRSH,SAVE4,SETDDO,IOSEL,CCOD,CWCOD,CLRDDB,YESNO
    42
    43				EXTERN HOMEND,HOMDAT,HOMMFD,HOMHSH,HOMRAN
    44				EXTERN HOMHID,HOMP4C,HOMLOG,HOMLUN,HOMNXT,HOMOVR
    45				EXTERN HOMPRV,HOMREF,HOMSNM,HOMSPU,HOMSAT,HOMFEP
    46
    47				EXTERN RIBLST,RIBPFS,RIBNAM,RIBEXT,RBSPAR,RBREAL,RBINDX,RBMASK
    48				EXTERN RBYUNI,RBYPNO,RBYUN4,RBYUN1,RBLVPR,RBLVSP
    49
    50				EXTERN STRDDB,STRLEN,SRPNDS
    51				EXTERN STRNAM,STRHSH,STRUNI,STRP4C,STRNXT,STRUNM,STRREF
    52				EXTERN STROVR,STRTAL,STRPPU,STRPID,STRBTS,STRSID
    53
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 1
ONCDSK.MAC	 4-DEC-87 15:51		S.MAC - with system parameter file for P035/D, January 1988

    54				EXTERN UNIPPU,UNIDES,UNIERR,UNIHID,UNISYS,UNIFEP
    55				EXTERN UNINAM,UNISTT,UNISTR
    56				EXTERN UNITAL,UNPCHG,UNPHWP,UNPMSB,UNPOFL,UNVRSF
    57				EXTERN UNYLN1,UNYLUN,UNYSPU,UNIONC
    58				EXTERN UNIKON,UNILOG,UNICHN,UNPPRV,UNISTS
    59
    60				EXTERN DCN,STRPID,REPSID,RE.DCD,HOMDCT,HOMDCV
    61
    62				EXTERN CH7
    63				ENTRY ONCMOD
    64
    65	000000'			ONCMOD:
    66
    67	761000			ONDSTT:	PHASE %OND
    68					STOPCD(,ENTRY,ONCDSK)^
    69					ENTRY	ONCDSK		;For library searches
    70	000000'	260040	000000*	ONCDSK::PUSHJ	P,DIE		;**** Default stopcode for "ONCDSK" ****
    71	000001'	575643	446353		SIXBIT	/ONCDSK/  	;Title of module
    72	000002'	000000	000000		S$NONAME,,0		;?NONAME stopcode "ONCDSK+nnn(nnnnnn)"
    73			761000	S$NAME==ONCDSK			;For STOPCDs with no arguments
    74					SALL>
    75				^	;Default for NONAME stopcodes
    76		777777	017000'		%D==ONDSTT-ONCDSK	;To look at LABEL, use LABEL+%D
    77
    78				;MACRO TO DEFINE ONCE RESTART SYMBOLS AND BYTE POINTERS
    79				;
    80				DEFINE DCNDEF (DCD)<
    81				  INTERN  REONCE
    82					REONCE:	0
    83					DCNUM==0
    84					IRP DCD, <DCNUM==DCNUM+1>
    85					DCNTAB:
    86					DCXX==0
    87					IRP DCD, <DCN.'DCD==(1B<DCXX>)
    88						  DCNY'DCD: POINT DCSIZ,DCN,35-DCSIZ*<DCNUM-1-DCXX>
    89						  Intern DCN.'DCD,DCNY'DCD
    90						  DCXX==DCXX+1>
    91				>
    92			000003	DCSIZ==DC.SIZ			;(FROM S).
    93	000003'	000000	000000	DCNDEF (<OP,ON,UR,MN,HM,DF>)
    94	000004'	170300	000000*
    95	000005'	140300	000004*
    96	000006'	110300	000005*
    97	000007'	060300	000006*
    98	000010'	030300	000007*
    99	000011'	000300	000010*
   100					;DSKCLN TYPE CAN BE SPECIFIED BY:
   101								; 'OP' - OPER in ONCE (FULL COMMAND)
   102								; 'ON' - OPER IN ONCDSK
   103								; 'UR' - USER PROG VIA .REST SETUUO
   104								; 'MN' - MONITOR IN CRASH CODE
   105								; 'HM' - HOME BLOCKS
   106								; 'DF' - DEFAULT
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 1-2
ONCDSK.MAC	 4-DEC-87 15:51		S.MAC - with system parameter file for P035/D, January 1988

   107				INTERN DCNDFT			;IN THAT ORDER OF PRIORITY
   108			030000	DCNDFT==DCN.HM!DCN.DF		; SETUP DEFAULT TO HOME-BLOCKS ! DEFAULT
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   109				SUBTTL	FILMAN
   110
   111	000012'	476000	763771	FILMAN:	SETOM	BATMAN		;MANDATORY CODE.
   112	000013'	260040	762556		PUSHJ	P,RDHOME	;READ HOME PAGES OF ALL UNITS.
   113	000014'	254000	761027		  JRST	MANOK		;ALL OK.
   114	000015'	254000	761024		  JRST	MANQST		;MINOR ERRORS.
   115					MOVEI	T1,[ASCIZ /
   116	000016'	201300	765324	ERRORS which prevent bringing the system UP/]
   117	000017'	260040	000000*	MANCM1:	PUSHJ	P,CONMES
   118	000020'	260040	761312	MANCOM:	PUSHJ	P,FILOPT
   119	000021'	254000	761012		JRST	FILMAN
   120
   121				MANREF:	MOVEI	T1,[ASCIZ /
   122	000022'	201300	765336	File structure NEEDS refreshing/]
   123	000023'	254000	761017		JRST	MANCM1
   124
   125				MANQST:	MOVEI	T1,[ASCIZ /
   126	000024'	201300	765345	MINOR ERRORS - Bring system UP anyway? /]
   127	000025'	260040	763650		PUSHJ	P,ASKQUE
   128	000026'	254000	761020		  JRST	MANCOM		;NO.
   129	000027'	260040	763724	MANOK:	PUSHJ	P,REDBAT	;READ THE BAT PAGES OF ALL UNITS.
   130	000030'	510300	000000*		HLLZ	T1,STRREF+STRDDB
   131	000031'	326300	761022		JUMPN	T1,MANREF	;NEEDS REFRESH.
   132	000032'	201300	000000*		MOVEI	T1,SRPREF##
   133	000033'	616300	000000*		TDNN	T1,STRBTS+STRDDB;Was REFSTR called on this STR?
   134	000034'	402000	000000*		 SETZM	REFLAG##	;No, ignore setting REFLAG from DDT
   135
   136				;HERE TO REWRITE HOME PAGES, WITH INCREMENTED PACK SET ID.
   137
   138	000035'	554240	000000*		HLRZ	U,STRDDB+STRUNI	;Start with DSKB0
   139	000036'	350300	763230		AOS	T1,RANHOM	; Increment save'd copy of HOMRAN
   140	000037'	607300	777777		TLNN	T1,-1
   141	000040'	254000	761043		 JRST	MANOK1
   142	000041'	201300	434164		MOVEI	T1,(SIXBIT/CAT/)	;
   143	000042'	552300	763230		HRRZM	T1,RANHOM	; If zero - save sixbit CAT
   144	000043'	506300	000000*	MANOK1:	HRLM	T1,STRDDB+STRPID
   145	000044'	260040	764736		PUSHJ	P,UPDHOM	;
   146	000045'	554245	000000*		HLRZ	U,UNISTR(U)	;Update HOM pages on all units in STR
   147	000046'	326240	761044		JUMPN	U,.-2		;
   148	000047'	260040	764717		PUSHJ	P,SPCDKP	;GET CURRENT DC MODE AND PRIORITY
   149	000050'	302400	000005		CAIE	T3,^L<(DCN.DF)>	;IS MODE DEFAULT
   150	000051'	254000	761056		 JRST	MANOK2		;NO, DON'T QUERY OPER FOR MODE
   151	000052'	201700	000000*		MOVEI	P3,DCFAST##	;Default to FAST instead of asking OPR
   152	000053'	200300	000000*		MOVE	T1,STRDDB+STRBTS;DOES STR REQUIRE
   153	000054'	602300	000000*		TRNE	T1,SRPNDS	; DSKCLN TO BE RUN
   154				;*;	 PUSHJ	P,SPCDKN	;YES, ASK OPER TO SELECT MODE
   155	000055'	137700	761005		 DPB	P3,DCNYON	;Yes, do fast DSKCLN (trust HOM page for FULL)
   156	000056'	135300	761005	MANOK2:	LDB	T1,DCNYON	;GET MODE
   157	000057'	202300	000011*		MOVEM	T1,DCN		; AND SAVE IT FOR DSKCLN TO GETTAB
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 3
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   158				;HERE TO READ THE RIB FOR SAT.SYS AND SET UP THE STTPTR
   159				;ENTRIES IN STT.
   160
   161	000060'	554240	000000*		HLRZ	U,STRDDB+STRUNI	;GET THE PRIME (AND ONLY)
   162	000061'	260040	761177		PUSHJ	P,GETSRB	;RIB INTO %STR.
   163	000062'	256000	761000		 STOPCD
   164	000063'	135300	765356		LDB	T1,[POINT 14,%STR+RIBEXT,35] ;Access date of SAT.SYS
   165	000064'	550340	000000*		HRRZ	T2,THSDAT##	;Current date (if any)
   166	000065'	317300	000007		CAMG	T1,T2		;Get larger into T1
   167	000066'	200300	000007		 MOVE	T1,T2
   168	000067'	542300	000064*		HRRM	T1,THSDAT##	;Store so COPYCRASH had a reasonable date
   169	000070'	201740	000000*		MOVEI	P4,RIBPFS	;P4/ REL ADDR OF RETRIEVAL POINTERS.
   170	000071'	554240	000000*		HLRZ	U,STRDDB+STRUNI	;Start with DSKB0
   171
   172				      ;HERE FOR EACH UNIT.
   173	000072'	135440	000000*	RDRBS2:	LDB	T4,UNYLUN	;
   174	000073'	550645	000000*		HRRZ	P2,UNISTT(U)	;P2/ STT ENTRY ADDRESS.
   175	000074'	135700	000000*		LDB	P3,UNYSPU	;P3/ # SATS ON THE UNIT.
   176
   177				      ;HERE FOR EACH SAT.
   178	000075'	307740	000000*	RDRBS3:	CAIG	P4,RIBLST	;MUSTN'T RUN OUT OF RIB ROOM.
   179	000076'	336317	750000		SKIPN	T1,%STR(P4)	;NOT EXPECTING EOF HERE.
   180	000077'	256000	761000		 STOPCD
   181	000100'	607300	000000*		TLNN	T1,RBSPAR!RBINDX ;CHECK THAT THE POINTER IN T1
   182	000101'	607300	000000*		TLNN	T1,RBREAL	;IS A CORRECT POINTER.
   183	000102'	256000	761000		 STOPCD
   184	000103'	135400	000000*		LDB	T3,RBYUN1	;IS THIS THE UNIT
   185	000104'	312400	000011		CAME	T3,T4		;THAT WE EXPECT TO SEE?
   186	000105'	256000	761000		 STOPCD
   187	000106'	621300	000000*		TLZ	T1,RBMASK-RBREAL ;
   188	000107'	202315	000000*		MOVEM	T1,STTPTR(P2)	;YES.  SET STTPTR.
   189	000110'	271740	000001		ADDI	P4,1		;INC PNTR TO PNTRS.
   190	000111'	271640	000000*		ADDI	P2,STTLEN	;ADJUST P2 TO NEXT STT ENTRY.
   191	000112'	367700	761075		SOJG	P3,RDRBS3	;LOOP AGAIN IF MORE SATS ON THIS UNIT.
   192	000113'	402015	000107*		SETZM	STTPTR(P2)	;
   193
   194	000114'	554245	000045*		HLRZ	U,UNISTR(U)	;IS THERE ANOTHER
   195	000115'	326240	761072		JUMPN	U,RDRBS2	;UNIT?
   196	000116'	332017	750000		SKIPE	%STR(P4)	;NO.  CHECK THAT EOF IS PRESENT.
   197	000117'	256000	761000		 STOPCD
   198					PFALL	RDSATS
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 4
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   199				;NOW READ ALL THE SATS ON EACH UNIT IN THE STR, AND SET STTFPC
   200				;IN THE SATS.
   201
   202	000120'	402000	000000*	RDSATS:	SETZM	STRDDB+STRTAL	;CLEAR THE TOTAL COUNT FOR THE STR.
   203	000121'	554240	000000*		HLRZ	U,STRDDB+STRUNI	;
   204	000122'	550705	000073*	RDSTS1:	HRRZ	P3,UNISTT(U)	;P3/PNTR INTO STT FOR THIS UNIT.
   205	000123'	336356	000113*	RDSTS4:	SKIPN	T2,STTPTR(P3)	;OUT OF SATS ON THIS UNIT?
   206	000124'	254000	761153		 JRST	RDSTS5		;YES, GO TO NEXT UNIT.
   207	000125'	135440	000000*		LDB	T4,RBYPNO	;SAT
   208	000126'	201140	000000*		MOVEI	PG,%STA.P	;INTO
   209	000127'	260040	763520		PUSHJ	P,OPAGIN	;%STA.
   210	000130'	254000	761132		  JRST	.+2		;ERROR ON READ.
   211	000131'	254000	761135		 JRST	RDST45		;READ OKAY.
   212	000132'	402000	751000		SETZM	%STA		;PRETEND ALL F BITS IN USE,
   213	000133'	200300	765357		MOVE	T1,[XWD %STA,%STA+1] ;AND LET
   214	000134'	251300	751377		BLT	T1,%STA+377	;DSKCLN WORRY.
   215	000135'	476000	751400	RDST45:	SETOM	%STA+400	;SET ALL THE
   216	000136'	200300	765360		MOVE	T1,[XWD %STA+400,%STA+401] ;M BITS
   217	000137'	251300	751777		BLT	T1,%STA+777	;FREE.
   218	000140'	200300	765361		MOVE	T1,[XWD -400,%STA] ;AOBJN PNTR FOR SATCNT.
   219	000141'	260040	000000*		PUSHJ	P,SATCNT	;T4/ NO. FREE PAGES IN THIS SAT.
   220	000142'	202456	000000*		MOVEM	T4,STTFPC(P3)	;
   221	000143'	272445	000000*		ADDM	T4,UNITAL(U)	;
   222	000144'	200356	000123*		MOVE	T2,STTPTR(P3)	;WRITE  OUT THE SAT
   223	000145'	135440	000125*		LDB	T4,RBYPNO	;SO THE CLEARED M BITS
   224	000146'	201140	000126*		MOVEI	PG,%STA.P	;GET
   225	000147'	260040	763523		PUSHJ	P,OPAGOT	;OUT THERE.
   226	000150'	256000	761000		 STOPCD
   227	000151'	271700	000111*		ADDI	P3,STTLEN	;ADJUST PNTR TO STT.
   228	000152'	254000	761123		JRST	RDSTS4
   229
   230				    ;COMPUTE SAFETY FACTOR FOR UNIT AND ADJUST STRTAL.
   231	000153'	200305	000000*	RDSTS5:	MOVE	T1,UNIPPU(U)	;COMPUTE THE SAFETY FACTOR FOR
   232	000154'	231300	000000*		IDIVI	T1,UNVRSF	;THE UNIT.
   233	000155'	135340	000074*		LDB	T2,UNYSPU	;
   234	000156'	221307	000000		IMULI	T1,(T2)		;
   235	000157'	213000	000006		MOVNS	T1		;
   236	000160'	273305	000143*		ADDB	T1,UNITAL(U)	;ADD TO UNIT'S COUNT.
   237	000161'	325300	761164		JUMPGE	T1,.+3		;DO NOT ALLOW
   238	000162'	402005	000160*		SETZM	UNITAL(U)	;UNITAL TO GO
   239	000163'	254000	761165		JRST	RDSTS6		;NEGATIVE.
   240	000164'	272300	000000*		ADDM	T1,STRDDB+STRTAL ;ADJUST STRTAL.
   241
   242	000165'	554245	000114*	RDSTS6:	HLRZ	U,UNISTR(U)	;
   243	000166'	326240	761122		JUMPN	U,RDSTS1	;
   244
   245				;The calculation of PROT and PROT0 based on disk type is not valid in the                      
   246				                i
   247				;paging monitor.  The code that was deleted here produced garbage for PROT0
   248				;on the F3 as a result of dividing by zero.  The values are now set in COMMON
   249				;based on IFCPU(<KI,KL>),<PROT0:2> and IFNCPU(<KI,KL>),<PROT0:4>.
   250
   251	000167'	205300	000000*		MOVSI	T1,UNPCHG
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 4-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   252	000170'	554240	000000*		HLRZ	U,SYSUNI	;GET ADR. OF 1ST. UNIT DATA BLOCK IN SYSTEM
   253	000171'	412305	000000*		ANDCAM	T1,UNIDES(U)	;CLEAR CHANGE BIT
   254	000172'	554245	000000*		HLRZ	U,UNISYS(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN SYSTEM
   255	000173'	326240	761171		JUMPN	U,.-2		;REPEAT IF ANY LEFT
   256	000174'	332200	000000*		SKIPE	F,DDSTAR	;IF A DDB SETUP
   257	000175'	260040	000000*		PUSHJ	P,CLRDDB	;THEN CLEAR IT.
   258	000176'	263040	000000		POPJ	P,		;NO - RETURN
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 5
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   259				COMMENT #
   260				@@SUBROUTINE GETSRB
   261				@@PURPOSE
   262				SUBR TO READ THE RIB BLOCK FOR SAT.SYS INTO %STR.
   263				@@ENTRY
   264				EXPECTS U/ UNIT DB AND F/ DDB.
   265				@@ACCUM
   266				DESTROYS
   267				@@CALLS
   268				RDCHEK.
   269				@@EXIT
   270				SKIP RETURNS IF THE PAGE READ SUCCESSFULLY.
   271				@@ #
   272
   273
   274	000177'	260040	763354	GETSRB:	PUSHJ	P,GETHOM	;Read in HOM page for DSKB0
   275	000200'	263040	000000		  POPJ	P,		;Can't read it
   276	000201'	337440	753000*		SKIPG	T4,%HOM+HOMSAT	;Get logical page number for RIB for SAT.SYS
   277	000202'	263040	000000		 POPJ	P,		;Should be LPNSAT, not zero!
   278	000203'	201700	000000*		MOVEI	P3,CODRIB	;GET CODE WORD FOR RIB PAGES.
   279	000204'	205640	634164		MOVSI	P2,(SIXBIT .SAT.)
   280	000205'	201140	000000*		MOVEI	PG,%STR.P	;
   281	000206'	476000	763516		SETOM	WHICH		;INDICATE READING FIRST (AND
   282	000207'	402000	763517		SETZM	NOERH		;ONLY) PAGE.
   283	000210'	324740	763407		PJRST	RDCHEK		;READ & VERIFY RIB PAGES.
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 6
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   284				;SOME MACROS FOR COMMAND WORK
   285
   286					DEFINE SCAN (A,B) <
   287				IFB <B>,<
   288				PRINTX	SCANNER TABLE 'A' Has an undefined SETxM statement
   289				>
   290					MOVEI	P1,SCN'A		; Get address of Scan Table
   291					SET'B'M	CMDSCF			; Specify NO STR/UNIT stuff
   292					PUSHJ	P,CMDSCN		; Call Scanning routine
   293					  JRST	HLP'A			; No good!
   294					XCT DSP'A'(P3)			; Yes?
   295					JRST	A'CMD			; Return as if cr typed.
   296				
   297				A'HLP:	Move	P3,-2(P1)		; Setup AOBJN pointer for messages
   298				A'HL1:	Hrrz	T1,(P3)			; Get address of message
   299					Pushj	P,LNGMES		; Print a long message
   300					Aobjn	P3,A'HL1		; Next?
   301					Jrst	A'CMD			; Return.
   302				>
   303
   304				;MACRO TO MAKE SCAN TABLE
   305				;UNI IS PLACE TO JRST TO IF UNIT
   306				;STR IS PLACE TO JRST TO IF STR
   307				;NAM IS TABLE NAME  Generates SCN'NAM, DSP'NAM, TXT'NAM, SIZ'NAM
   308				; Assumes MK'NAM as the macro defining the X arguments
   309				; JRST to NUL'NAM on <CR> and HLP'NAM on error
   310				; Defines NAM'HLP for a standard typeout of help texts
   311
   312					Extern Ab.Ack,Ab.Nak,Ab.Ver,Ab.Tcv,Ab.Cvr ; Bits - See ONCE.MAC
   313					DEFINE SCNTB (UNI,STR,NAM) <
   314				
   315					DEFINE X(SYM,INS,BIT,TEXT,TEXT1,TEXT2,TEXT3) <
   316					INS>	;INSTRUCTION TO EXECUTE
   317				
   318					JRST UNI		;FOR -3 RETURN
   319					JRST STR		;FOR -2 RETURN
   320					JRST NUL'NAM		;FOR -1 RETURN
   321				DSP'NAM: MK'NAM			;GENERATE DISPATCH TABLE
   322					SIZ'NAM==.-DSP'NAM
   323					-SIZ'NAM,,TXT'NAM	;AOBJN POINTER TO HELP
   324					-SIZ'NAM,,SCN'NAM	;AOBJN POINTER TO NAMES
   325					DEFINE X (SYM,INS,BIT,TEXT,TEXT1,TEXT2,TEXT3)
   326				<	<SIXBIT /SYM/>>
   327				SCN'NAM: MK'NAM			; Define Table to read
   328				
   329					$XZ==0			; Need a counter
   330					define xz$(argh)<lit$'argh==.>
   331					DEFINE X (SYM,INS,BIT,TEXT,TEXT1,TEXT2,TEXT3)
   332				<	xz$(\$XZ)
   333				Ifnb <TEXT>,<ASCIZ \TEXT'TEXT1'TEXT2'TEXT3\>
   334					$XZ==$XZ+1>
   335					MK'NAM
   336				
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 6-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   337					$XZ==0
   338					define xz$(argh)<lit$'argh>
   339					DEFINE X (SYM,INS,BIT,TEXT,TEXT1,TEXT2,TEXT3) <
   340					<Xwd	Bit,xz$(\$XZ)>
   341					$XZ==$XZ+1>
   342				TXT'NAM: MK'NAM
   343				
   344				>
   345
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 7
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   346				;P1 IS A POINTER E NAMES TABLE
   347				;The command scanning routine - Copied and munged from ONCDSK
   348
   349	000211'	260040	764617	CMDSCN:	PUSHJ	P,SETRAN	; Start number generator on any question.
   350	000212'	260040	000000*		PUSHJ	P,CTEXT		; Get text (up to 6 chars) in T2
   351	000213'	260040	764622		PUSHJ	P,GETRAN	; Stop generator (KI,F3) and get number
   352					 JUMPE	T2,[CAIL T3,40	;  EOL?
   353						    POPJ P,	;NOT NULL LINE, SPC CHR
   354						    MOVNI P3,1	;RETURN P3=-1 FOR NULL STRING
   355	000214'	322340	765362			    JRST CPOPJ1]
   356	000215'	200300	000007		MOVE	T1,T2		;GET TEXT IN T1
   357	000216'	336000	761307		SKIPN	CMDSCF		; Skip IF we want to do UNI/STR stuff
   358	000217'	254000	761227		  Jrst	CMDSC1		; NO!  Don't Bother.
   359	000220'	202240	761311		MOVEM	U,SVU
   360	000221'	260040	763260		PUSHJ	P,FNDSTR	;IS IT A STR?
   361					JRST	[MOVNI P3,2	;-2 FOR STR WITH P2 TO STR BLOCK
   362	000222'	254000	765366			 JRST CPOPJ1]
   363	000223'	260040	763677		PUSHJ	P,FNDUNI	;CHECK ON UNIT
   364	000224'	334000	000000		  SKIPA			;NO
   365					JRST	[MOVNI P3,3	;-3 WITH U POINTING TO UNIT BLOCK
   366	000225'	254000	765370			 JRST CPOPJ1]
   367	000226'	200240	761311		MOVE	U,SVU
   368	000227'	200654	777776	CMDSC1:	MOVE	P2,-2(P1)	;GET AOBJN POINTER TO HELP TABLE
   369	000230'	200714	777777		MOVE	P3,-1(P1)	;GET AOBJN POINTER TO NAME TABLE
   370	000231'	201740	000000		MOVEI	P4,0		;NOTHING SEEN SO FAR
   371	000232'	205400	770000		MOVSI	T3,770000	;MAKE A MASK
   372	000233'	612300	000010	CMDSC2:	TDNE	T1,T3		; Did we type something?
   373	000234'	670300	000010		TDO	T1,T3		; If something there, set mask bits
   374	000235'	242400	777772		LSH	T3,-6		; Shift
   375	000236'	326400	761233		  JUMPN	T3,CMDSC2	; While we have more to check...
   376	000237'	316356	000000	CMDSC3:	CAMN	T2,(P3)		; Compare !
   377	000240'	254000	761256		  JRST	CMDSC5		; Exact match
   378	000241'	200415	000000		Move	T3,(P2)		; Get Bits,,Text-Adr
   379	000242'	603400	000000*		TLNE	T3,AB.NAK	; See if we can abbreviate it
   380	000243'	254000	761252		  JRST	CMDSC4		; No! -- Don't bother
   381	000244'	200416	000000		MOVE	T3,(P3)		;NO - CHECK MORE
   382	000245'	404400	000006		AND	T3,T1		;MASK OUT UN-TYPED STUFF
   383	000246'	312400	000007		CAME	T3,T2		;CHECK AFTER MASK
   384	000247'	254000	761252		  JRST	CMDSC4		;NO
   385					JUMPN	P4,[MOVEI P4,1	;SET POSITIVE FOR MULTI MATCH
   386	000250'	326740	765372			    JRST   CMDSC4]
   387	000251'	200740	000016		MOVE	P4,P3		;SAVE MATCH
   388	000252'	340640	000000	CMDSC4:	AOJ	P2,		; Increment text pointer
   389	000253'	253700	761237		AOBJN	P3,CMDSC3	; Loop through the table
   390	000254'	331700	000017		SKIPL	P3,P4		;ANY MASKED MATCHES
   391	000255'	263040	000000		  POPJ	P,		;NONE OR MORE THAN 1
   392	000256'	274700	000014	CMDSC5:	SUB	P3,P1		;CONVERT TO RELATIVE INDEX
   393	000257'	550654	777776		HRRZ	P2,-2(P1)	; Get AOBJN Pointer for
   394	000260'	270640	000016		ADD	P2,P3		; Add offset
   395	000261'	200655	000000		MOVE	P2,(P2)		; Get Bits,,Text-Addr
   396	000262'	332000	761306		SKIPE	CMDMSG		; See if debugging?
   397	000263'	254000	000000*		 JRST	CPOPJ1		;  Yes!  Don't bother to verify!
   398	000264'	607640	000000*		TLNN	P2,AB.VER	; Should we Verify?
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 7-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   399	000265'	254000	000263*		 JRST	CPOPJ1		; No! Just Return "SAFE"
   400	000266'	607640	000000*		TLNN	P2,AB.CVR	; Ignore verify for CONSOLE?
   401	000267'	304000	000000		 CAIA			; No.. Don't bother to check!
   402	000270'	336000	000000*		SKIPN	CTYDO##		;  Setup for CTY?
   403	000271'	304000	000000		 CAIA			; No.. Keep going!
   404	000272'	254000	000265*		  JRST	CPOPJ1		; YES! Don't verify.
   405	000273'	607640	000000*		TLNN	P2,AB.TCV	; Is it a TYPE/CHANGE item?
   406	000274'	304000	000000		 CAIA			; No.. Don't worry!
   407	000275'	331000	764140		SKIPL	TYPONL		;  Type ONLY?
   408	000276'	304000	000000		 CAIA			; No.. Keep going!
   409	000277'	254000	000272*		  JRST	CPOPJ1		; YES! Don't verify.
   410	000300'	550300	000015		HRRZ	T1,P2		; Get Text Address
   411	000301'	260040	762544		PUSHJ	P,LNGMES	; No -- Type it out.
   412					MOVEI	T1,[ASCIZ\
   413				
   414	000302'	201300	765374	Are you SURE you want to do this? \]
   415	000303'	260040	000000*		PUSHJ	P,YESNO		; A "Y" will skip, else assume NO.
   416	000304'	211700	000001		  MOVNI P3,1		; Set for null-command return
   417	000305'	254000	000277*		JRST	CPOPJ1		; Always skip return.
   418
   419
   420	000306'	000000	000000	CMDMSG:	0			; Debugging flag. 0=Type long messages.
   421	000307'	000000	000000	CMDSCF:	0			; Flag for checking UNI/STR Stuff
   422								; 0==No checking, -1==Check!
   423	000310'	000000	000000	SVP2:	0
   424	000311'	000000	000000	SVU:	0
   425
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 8
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   426				;Here from the FILES command in ONCE
   427				FILOPT:	MOVEI	T1,[ASCIZ /
   428				Entering the FILES dialogue...
   429	000312'	201300	765404	  Type "GO" to return to ONCE./]
   430	000313'	260040	763645		PUSHJ	P,CONOUT
   431	000314'	402000	763771		SETZM	BATMAN
   432	000315'	402000	000000*	        SETZM	EVASIZ		;ENSURE EVMINI GETS CALLED IN EVMALC
   433	000316'	260040	762556		PUSHJ	P,RDHOME
   434	000317'	255000	000000		 JFCL
   435	000320'	255000	000000		 JFCL
   436	000321'	260040	763724		PUSHJ	P,REDBAT	;READ BAT PAGES.
   437
   438				HLPFIL:	MOVEI T1,[ASCIZ /
   439				  Type "HELP" for a list of options.
   440	000322'	201300	765421	/]
   441	000323'	260040	000000*	HLPTY1:	PUSHJ P,OCONM
   442	000324'	260040	000000*		PUSHJ P,OPOUT
   443
   444	761325			TYPCMD:
   445	761325			CHGCMD:
   446	761325			SRPCMD:
   447	761325			NULFIL:
   448				FILCMD:	MOVEI T1,[ASCIZ /
   449	000325'	201300	765432	FILES* /]
   450	000326'	260040	000323*		PUSHJ P,OCONM
   451	000327'	260040	000324*		PUSHJ P,OPOUT
   452	000330'	476000	764143		SETOM KNOUNI
   453	000331'	476000	764136		SETOM DBLSTD
   454	000332'	260040	000000*		PUSHJ P,GETLIN
   455	000333'	254000	761325		 JRST FILCMD	;NOTHING THERE
   456	000334'	201600	761371		SCAN (FIL,Z)
   457	000335'	402000	761307
   458	000336'	260040	761211
   459	000337'	254000	761322
   460	000340'	256016	761352
   461	000341'	254000	761325
   462	000342'	200714	777776
   463	000343'	550316	000000
   464	000344'	260040	762544
   465	000345'	253700	761343
   466	000346'	254000	761325
   467
   468					DEFINE MKFIL <
   469					X DSKCLN,<PUSHJ P,SPCDKN>,Ab.Nak!Ab.Ver,<
   470				DSKCLN  Query or Select DSKCLN mode.
   471				        List the current mode and allow the operator to change it.>
   472					X TYPE,<JRST TYPIT>,Ab.Ack,<
   473				TYPE    List information about the structure.
   474				        Type "TYPE HELP" for a list of options.>
   475					X CHANGE,<JRST CHGIT>,Ab.Ack,<
   476				CHANGE  Change information about the structure.
   477				        Type "CHANGE HELP" for a list of options.>
   478					X ADD,<PUSHJ P,ADDUNI>,Ab.Nak!Ab.Ver,<
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 8-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   479				ADD     Add a unit to the structure.
   480				        Reconfigure the disk structure and add another pack.>
   481					X DISOLVE,<JRST BADDIS>,Ab.Nak,<.>
   482					X DISSOLVE,<PUSHJ P,STSDSL>,Ab.Nak!Ab.Ver,<
   483				DISSOLVE Dissolve the disk structure for DSKB.
   484				        Remove all units from the system structure.>
   485					X DEFINE,<PUSHJ P,STSDEF>,Ab.Nak!Ab.Ver,<
   486				DEFINE  Define a NEW structure for DSKB.
   487				        Create a completely new system structure.>
   488					X REFRESH,<PUSHJ P,STSREF>,Ab.Nak!Ab.Ver,<
   489				REFRESH Refresh the structure.
   490				        Delete all files on the system and start over
   491				        with a "FRESH" disk.>
   492					X DDT,<PUSHJ P,DDTX##>,AB.ACK!AB.VER,<
   493				DDT     Enter executive DDT.  To be used ONLY by software wizards
   494				        for emergency patching and examination of the monitor.>,<
   495				        UNDER NO CIRCUMSTANCES SHOULD YOU NORMALLY USE THIS COMMAND!>
   496					X TSTSUP,<PUSHJ P,TSTSUP##>,AB.ACK!AB.VER,<
   497				TSTSUP  Disk patching routine.  To be used ONLY by software wizards
   498				        for emergency patching of the disk structure.>,<
   499				        UNDER NO CIRCUMSTANCES SHOULD YOU NORMALLY USE THIS COMMAND!>
   500					X BOOTS,<JRST SYSBTS##>,AB.NAK!AB.VER,<
   501				BOOTS   Crash the system with "BOOTS LOADED" immediately.>
   502					X GO,<JRST FILGO>,Ab.Ack,<
   503				GO      Leave the FILES dialogue and return to the ONCE
   504				        dialogue.>
   505					X HELP,<JRST FILHLP>,Ab.Ack,<
   506				HELP    Type this message.
   507				>
   508				>
   509	000347'	254000	761322		SCNTB (HLPFIL,HLPFIL,FIL)
   510	000350'	254000	761322
   511	000351'	254000	761325
   512	000352'	260040	764632
   513	000353'	254000	762035
   514	000354'	254000	762220
   515	000355'	260040	764422
   516	000356'	254000	762033
   517	000357'	260040	764370
   518	000360'	260040	764247
   519	000361'	260040	764520
   520	000362'	260040	000000*
   521	000363'	260040	000000*
   522	000364'	254000	000000*
   523	000365'	254000	764724
   524	000366'	254000	761342
   525	000367'	777763	762016
   526	000370'	777763	761371
   527	000371'	446353	435456
   528	000372'	647160	450000
   529	000373'	435041	564745
   530	000374'	414444	000000
   531	000375'	445163	575466
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 8-3
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   532	000376'	445163	635754
   533	000377'	444546	515645
   534	000400'	624546	624563
   535	000401'	444464	000000
   536	000402'	646364	636560
   537	000403'	425757	646300
   538	000404'	475700	000000
   539	000405'	504554	600000
   540	000406'	064250	451626
	000407'	416311	620100
	000410'	507534	571362
	000411'	203376	220246
	000412'	627314	561750
	000413'	202112	345606
	000414'	462344	066736
   541	000415'	623125	606424
	000416'	201004	020100
	000417'	201004	046322
	000420'	717504	072320
	000421'	625014	372744
	000422'	713135	672100
	000423'	667374	462500
	000424'	607354	420302
	000425'	663315	773500
	000426'	723214	520336
	000427'	703136	260750
	000430'	677444	072336
	000431'	203075	060734
	000432'	637124	064750
	000433'	270000	000000
   542	000434'	064252	454640
	000435'	425004	020100
	000436'	463236	372100
	000437'	647354	667744
	000440'	667036	464736
	000441'	671014	161336
	000442'	727504	072320
	000443'	625016	372344
	000444'	727076	472744
   543	000445'	625341	505100
	000446'	201004	020100
	000447'	201012	474740
	000450'	625004	252262
	000451'	502124	044212
	000452'	462404	220314
	000453'	677444	060500
	000454'	663236	372100
	000455'	677144	067740
	000456'	723235	767346
	000457'	270000	000000
   544	000460'	064250	344202
	000461'	472170	520100
	000462'	417214	167316
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 8-4
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

	000463'	625015	167314
	000464'	677455	560750
	000465'	647375	620302
	000466'	613376	572100
	000467'	723214	520346
	000470'	723456	561750
	000471'	727454	527032
   545	000472'	051004	020100
	000473'	201004	020250
	000474'	747414	520104
	000475'	416210	147216
	000476'	425011	042630
	000477'	501044	063336
	000500'	711014	120330
	000501'	647476	420336
	000502'	631015	770350
	000503'	647375	671534
	000504'	000000	000000
   546	000505'	064250	142210
	000506'	201004	020100
	000507'	407114	420302
	000510'	203535	664750
	000511'	203515	720350
	000512'	643124	071750
	000513'	713534	372352
   547	000514'	713125	606424
	000515'	201004	020100
	000516'	201004	051312
	000517'	617375	663322
	000520'	637536	262500
	000521'	723214	520310
	000522'	647475	320346
	000523'	723456	561750
	000524'	727454	520302
	000525'	673104	060710
	000526'	621014	167336
	000527'	723214	571100
	000530'	703034	365534
	000531'	000000	000000
   548	000532'	270000	000000
   549	000533'	064250	444646
	000534'	516371	453212
	000535'	202115	171746
	000536'	677316	662500
	000537'	723214	520310
	000540'	647475	320346
	000541'	723456	561750
	000542'	727454	520314
	000543'	677444	042246
   550	000544'	456045	606424
	000545'	201004	020100
	000546'	201004	051312
	000547'	667376	662500
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 8-5
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

	000550'	607315	420352
	000551'	673236	471500
	000552'	633455	766500
	000553'	723214	520346
	000554'	747476	462732
	000555'	203476	471352
	000556'	617516	571312
	000557'	270000	000000
   551	000560'	064250	442614
	000561'	446350	520100
	000562'	423134	664734
	000563'	625014	120234
	000564'	426564	071750
	000565'	713534	372352
	000566'	713124	063336
	000567'	711010	451626
   552	000570'	411341	505100
	000571'	201004	020100
	000572'	201010	371312
	000573'	607514	520302
	000574'	203075	766740
	000575'	663136	462730
	000576'	745015	662756
	000577'	203477	171750
	000600'	627324	071750
	000601'	713534	372352
	000602'	713125	600000
   553	000603'	064252	242614
	000604'	512132	344100
	000605'	513134	671312
	000606'	717204	072320
	000607'	625016	372344
	000610'	727076	472744
   554	000611'	625341	505100
	000612'	201004	020100
	000613'	201010	462730
	000614'	627514	520302
	000615'	663304	063322
	000616'	663136	320336
	000617'	671016	464312
	000620'	203477	171750
	000621'	627324	060734
	000622'	621016	372302
	000623'	713504	067754
   555	000624'	627441	505100
	000625'	201004	020100
	000626'	201016	764750
	000627'	641014	120104
	000630'	432450	551620
	000631'	211014	464746
	000632'	655340	000000
   556	000633'	064250	442250
	000634'	201004	020100
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 8-6
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

	000635'	427356	462744
	000636'	203137	062706
	000637'	727515	173312
	000640'	202110	452134
	000641'	201012	467500
	000642'	613124	072746
	000643'	627104	047634
	000644'	462624	061362
	000645'	203475	763350
	000646'	737036	262500
	000647'	737237	260744
   557	000650'	623461	505100
	000651'	201004	020100
	000652'	201014	667744
	000653'	203135	562744
	000654'	637135	661762
	000655'	203414	172306
	000656'	643235	663500
	000657'	607354	420312
	000660'	743035	564734
	000661'	607515	167734
	000662'	203374	620350
	000663'	643124	066736
	000664'	673236	467744
   558	000665'	270321	220100
	000666'	201004	020100
	000667'	202531	642212
	000670'	511011	647500
	000671'	416232	241652
	000672'	466472	440634
	000673'	416132	320246
	000674'	442372	546210
	000675'	202631	752500
	000676'	472372	246602
	000677'	462313	120252
	000700'	516124	052220
	000701'	446464	041636
	000702'	466330	147210
	000703'	204000	000000
   559	000704'	064252	451650
	000705'	516532	020100
	000706'	423236	365500
	000707'	703036	461720
	000710'	647354	720344
	000711'	677536	464734
	000712'	625344	020250
	000713'	675014	262500
	000714'	727474	562100
	000715'	476351	454500
	000716'	613624	071736
	000717'	633516	760744
	000720'	625016	764764
	000721'	607454	471432
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 8-7
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   560	000722'	051004	020100
	000723'	201004	020314
	000724'	677444	062732
	000725'	627454	762734
	000726'	617624	070302
	000727'	723075	064734
	000730'	635015	763100
	000731'	723214	520310
	000732'	647475	320346
	000733'	723456	561750
	000734'	727454	527032
   561	000735'	051004	020100
	000736'	201004	020252
	000737'	472110	551100
	000740'	472364	041622
	000741'	512072	546646
	000742'	522031	641612
	000743'	515012	344236
	000744'	526310	420262
	000745'	476524	047236
	000746'	512330	146230
	000747'	545012	551612
	000750'	202511	044646
	000751'	202071	746632
	000752'	406350	420400
   562	000753'	064250	247636
	000754'	522464	020100
	000755'	417454	171720
	000756'	203515	062500
	000757'	717636	372312
	000760'	665016	764750
	000761'	641004	241236
	000762'	476512	320230
	000763'	476030	442610
	000764'	211015	166732
	000765'	627115	160750
	000766'	627317	127000
   563	000767'	064250	747500
	000770'	201004	020100
	000771'	463134	173312
	000772'	203515	062500
	000773'	432231	442646
	000774'	203115	160730
	000775'	677176	562500
	000776'	607354	420344
	000777'	627516	571334
	001000'	203515	720350
	001001'	643124	047634
   564	001002'	416121	505100
	001003'	201004	020100
	001004'	201014	464702
	001005'	663374	772712
	001006'	270000	000000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 8-8
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   565	001007'	064251	042630
	001010'	501004	020100
	001011'	523636	062500
	001012'	723215	171500
	001013'	667136	371702
   566	001014'	637125	606424
	001015'	000000	000000
   567	001016'	000000*	761406
   568	001017'	000000*	761434
   569	001020'	000000*	761460
   570	001021'	000000*	761505
   571	001022'	000000*	761532
   572	001023'	000000*	761533
   573	001024'	000000*	761560
   574	001025'	000000*	761603
   575	001026'	000000*	761633
   576	001027'	000000*	761704
   577	001030'	000000*	761753
   578	001031'	000000*	761767
   579	001032'	000000*	762007
   580
   581				BADDIS:	MOVEI	T1,[ASCIZ /  DISSOLVE is spelled with two "S"es.
   582	001033'	201300	765434	/]			;Here if typed "DISOLVE"
   583	001034'	254000	761323		JRST	HLPTY1
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 9
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   584	001035'	476000	764140	TYPIT:	SETOM TYPONL	;ONLY TYPEOUT
   585	001036'	201600	762067		SCAN (TYP,O)
   586	001037'	476000	761307
   587	001040'	260040	761211
   588	001041'	254000	762051
   589	001042'	256016	762056
   590	001043'	254000	761325
   591	001044'	200714	777776
   592	001045'	550316	000000
   593	001046'	260040	762544
   594	001047'	253700	762045
   595	001050'	254000	761325
   596
   597	762051			NULTYP:
   598				HLPTYP:	MOVEI T1,[ASCIZ /
   599				Type "TYPE HELP" for a list of options.
   600	001051'	201300	765444	/]
   601	001052'	254000	761323		JRST HLPTY1
   602
   603					DEFINE MKTYP <
   604					X STR,<PUSHJ P,TYPSTR>,Ab.Nak,<
   605				STR     Name of the STRUCTURE and UNITS on it.>
   606					X UNITS,<PUSHJ P,TYPUNS>,Ab.Nak,<
   607				UNITS   Names of all units NOT in a file structure.>
   608					X BAT,<PUSHJ P,TYPBAT>,Ab.Nak,<
   609				BAT     Number of BAD pages and regions for a unit.>
   610					X SATPCBS,<PUSHJ P,TYPSPC>,Ab.Nak,<
   611				SATPCBS Number of SAT PCBs.>
   612					X RIBPCBS,<PUSHJ P,TYPRPC>,Ab.Nak,<
   613				RIBPCBS Number of RIB PCBs.>
   614					X ALL,<JRST TYPALL>,Ab.Nak,<
   615				ALL     All of the above.>
   616					X HELP,<JRST TYPHLP>,Ab.Ack,<
   617				str-name  Type information about the structure.
   618				unit-name Type information about the unit.
   619				HELP    Type this message.
   620				>
   621				>
   622	001053'	254000	762343		SCNTB (TYPUIP,TYPSRP,TYP)
   623	001054'	254000	762420
   624	001055'	254000	762051
   625	001056'	260040	764030
   626	001057'	260040	764013
   627	001060'	260040	765066
   628	001061'	260040	765024
   629	001062'	260040	765041
   630	001063'	254000	764052
   631	001064'	254000	762044
   632	001065'	777771	762211
   633	001066'	777771	762067
   634	001067'	636462	000000
   635	001070'	655651	646300
   636	001071'	424164	000000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 9-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   637	001072'	634164	604342
   638	001073'	625142	604342
   639	001074'	415454	000000
   640	001075'	504554	600000
   641	001076'	064252	352244
	001077'	201004	020100
	001100'	473035	562500
	001101'	677144	072320
	001102'	625012	352244
	001103'	526072	452644
	001104'	425014	167310
	001105'	202531	644650
	001106'	515015	767100
	001107'	647505	600000
   642	001110'	064252	547222
	001111'	522464	020100
	001112'	473035	562746
	001113'	203374	620302
	001114'	663304	072734
	001115'	647516	320234
	001116'	476504	064734
	001117'	203024	063322
	001120'	663124	071750
	001121'	713534	372352
	001122'	713125	600000
   643	001123'	064250	240650
	001124'	201004	020100
	001125'	473535	561312
	001126'	711015	763100
	001127'	412030	420340
	001130'	607174	571500
	001131'	607354	420344
	001132'	627175	167734
	001133'	715014	667744
	001134'	203024	072734
	001135'	647505	600000
   644	001136'	064252	340650
	001137'	502070	251500
	001140'	473535	561312
	001141'	711015	763100
	001142'	516032	420240
	001143'	416056	327000
   645	001144'	064252	244604
	001145'	502070	251500
	001146'	473535	561312
	001147'	711015	763100
	001150'	512230	220240
	001151'	416056	327000
   646	001152'	064250	146230
	001153'	201004	020100
	001154'	407315	420336
	001155'	631016	464312
	001156'	203034	267754
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 9-3
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

	001157'	625340	000000
   647	001160'	064256	372344
	001161'	267354	166712
	001162'	201012	474740
	001163'	625015	167314
	001164'	677455	560750
	001165'	647375	620302
	001166'	613376	572100
	001167'	723214	520346
	001170'	723456	561750
	001171'	727454	527032
   648	001172'	053535	664750
	001173'	267354	166712
	001174'	202517	170312
	001175'	203235	663336
	001176'	713334	172322
	001177'	677344	060704
	001200'	677536	420350
	001201'	643124	072734
   649	001202'	647505	606424
	001203'	442131	450100
	001204'	201004	052362
	001205'	703124	072320
	001206'	647464	066712
	001207'	717474	163712
   650	001210'	270321	200000
   651	001211'	000000*	762076
   652	001212'	000000*	762110
   653	001213'	000000*	762123
   654	001214'	000000*	762136
   655	001215'	000000*	762144
   656	001216'	000000*	762152
   657	001217'	000000*	762160
   658
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 10
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   659	001220'	402000	764140	CHGIT:	SETZM TYPONL
   660	001221'	201600	762247		SCAN (CHG,O)
   661	001222'	476000	761307
   662	001223'	260040	761211
   663	001224'	254000	762234
   664	001225'	256016	762241
   665	001226'	254000	761325
   666	001227'	200714	777776
   667	001230'	550316	000000
   668	001231'	260040	762544
   669	001232'	253700	762230
   670	001233'	254000	761325
   671	762234			NULCHG:
   672				HLPCHG:	MOVEI T1,[ASCIZ /
   673				Type "CHANGE HELP" for a list of options.
   674	001234'	201300	765455	/]
   675	001235'	254000	761323		JRST HLPTY1
   676
   677					DEFINE MKCHG <
   678					X SATPCBS,<PUSHJ P,CHGSPC>,Ab.Nak!Ab.Ver,<
   679				SATPCBS   Change the number of SAT PCBs.>
   680					X RIBPCBS,<PUSHJ P,CHGRPC>,Ab.Nak!Ab.Ver,<
   681				RIBPCBS   Change the number of RIB PCBs.>
   682					X BAT,<PUSHJ P,CHGBAT>,Ab.Nak!Ab.Ver,<
   683				BAT       Refresh the BAT pages for a UNIT.>
   684					X HELP,<JRST CHGHLP>,Ab.Ack,<
   685				str-name  Change parameters for the structure
   686				unit-name Change parameters for a unit.
   687				HELP    Type this message.
   688				>
   689				>
   690	001236'	254000	762343		SCNTB (TYPUIP,TYPSRP,CHG)
   691	001237'	254000	762420
   692	001240'	254000	762234
   693	001241'	260040	765027
   694	001242'	260040	765044
   695	001243'	260040	765056
   696	001244'	254000	762227
   697	001245'	777774	762337
   698	001246'	777774	762247
   699	001247'	634164	604342
   700	001250'	625142	604342
   701	001251'	424164	000000
   702	001252'	504554	600000
   703	001253'	064252	340650
	001254'	502070	251500
	001255'	201010	364302
	001256'	673174	520350
	001257'	643124	067352
	001260'	667054	571100
	001261'	677144	051602
	001262'	521012	041604
	001263'	715340	000000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 10-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   704	001264'	064252	244604
	001265'	502070	251500
	001266'	201010	364302
	001267'	673174	520350
	001270'	643124	067352
	001271'	667054	571100
	001272'	677144	051222
	001273'	411012	041604
	001274'	715340	000000
   705	001275'	064250	240650
	001276'	201004	020100
	001277'	201012	262714
	001300'	713136	364100
	001301'	723214	520204
	001302'	406504	070302
	001303'	637136	320314
	001304'	677444	060500
	001305'	526351	152134
	001306'	000000	000000
   706	001307'	064256	372344
	001310'	267354	166712
	001311'	201010	364302
	001312'	673174	520340
	001313'	607454	166712
	001314'	723136	271500
	001315'	633376	220350
	001316'	643124	071750
	001317'	713534	372352
   707	001320'	713121	505352
	001321'	673236	426734
	001322'	607334	520206
	001323'	643035	663712
	001324'	203414	171302
	001325'	667136	462744
	001326'	715014	667744
	001327'	203024	072734
   708	001330'	647505	606424
	001331'	442131	450100
	001332'	201004	052362
	001333'	703124	072320
	001334'	647464	066712
	001335'	717474	163712
   709	001336'	270321	200000
   710	001337'	000000*	762253
   711	001340'	000000*	762264
   712	001341'	000000*	762275
   713	001342'	000000*	762307
   714
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 11
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   715	001343'	550645	000165*	TYPUIP:	HRRZ	P2,UNISTR(U)	;IN CASE IN FS
   716	001344'	202640	762354		MOVEM	P2,UIPSVU	;SAVE IT!
   717	001345'	201600	762375		MOVEI	P1,SCNUIP	; Get address of Scan Table
   718	001346'	476000	761307		SETOM	CMDSCF		; Specify STR/UNIT stuff
   719	001347'	260040	761211		PUSHJ	P,CMDSCN	; Call Scanning routine
   720	001350'	254000	762362		  JRST	HLPUIP		; No good!
   721	001351'	200640	762354		MOVE	P2,UIPSVU	;RESTORE in case needed.
   722	001352'	256016	762371		XCT	DSPUIP(P3)	; Yes?
   723	001353'	254000	761325		JRST	FILCMD		; Return as if cr typed.
   724	001354'	000000	000000	UIPSVU:	0
   725
   726	001355'	200714	777776	UIPHLP:	Move	P3,-2(P1)	; Setup AOBJN pointer for messages
   727	001356'	550316	000000	UIPHL1:	Hrrz	T1,(P3)		; Get address of message
   728	001357'	260040	762544		Pushj	P,LNGMES	; Print a long message
   729	001360'	253700	762356		Aobjn	P3,UIPHL1	; Next?
   730	001361'	254000	761325		Jrst	FILCMD		; Return.
   731	762362			NULUIP:
   732				HLPUIP:	MOVEI T1,[ASCIZ /
   733	001362'	201300	765467	Type "TYPE unit-name HELP" for a list of options./]
   734	001363'	331000	764140		SKIPL TYPONL
   735					MOVEI T1,[ASCIZ /
   736	001364'	201300	765502	Type "CHANGE unit-name HELP" for a list of options./]	;WAS A CHANGE
   737	001365'	254000	761323		JRST HLPTY1
   738
   739					DEFINE MKUIP <
   740					X ID,<PUSHJ P,UNITID>,Ab.Nak!Ab.Ver!Ab.Tcv,<
   741				... ID    Unit ID.>
   742					X HELP,<JRST UIPHLP>,Ab.Ack,<
   743				... HELP  Type this message.
   744				>
   745				>
   746	001366'	254000	762362		SCNTB (HLPUIP,HLPUIP,UIP)
   747	001367'	254000	762362
   748	001370'	254000	762362
   749	001371'	260040	764177
   750	001372'	254000	762355
   751	001373'	777776	762413
   752	001374'	777776	762375
   753	001375'	514400	000000
   754	001376'	504554	600000
   755	001377'	064245	627134
	001400'	202230	420100
	001401'	201012	567322
	001402'	721011	142134
	001403'	000000	000000
   756	001404'	064245	627134
	001405'	202210	546240
	001406'	201012	474740
	001407'	625016	464322
	001410'	715015	562746
	001411'	717034	762534
   757	001412'	064240	000000
   758	001413'	000000*	762377
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 11-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   759	001414'	000000*	762404
   760
   761	001415'	336005	000000*	UNCHKA:	SKIPN UNIHID(U)
   762	001416'	260040	764177		PUSHJ P,UNITID
   763	001417'	324740	764170		PJRST	UNITST
   764
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 12
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   765
   766	001420'	201600	762450	TYPSRP:	SCAN (SRP,O)
   767	001421'	476000	761307
   768	001422'	260040	761211
   769	001423'	254000	762433
   770	001424'	256016	762442
   771	001425'	254000	761325
   772	001426'	200714	777776
   773	001427'	550316	000000
   774	001430'	260040	762544
   775	001431'	253700	762427
   776	001432'	254000	761325
   777	762433			NULSRP:
   778				HLPSRP:	MOVEI T1,[ASCIZ /
   779	001433'	201300	765515	Type "TYPE str-name HELP" for a list of options./]
   780	001434'	331000	764140		SKIPL TYPONL
   781					MOVEI T1,[ASCIZ /
   782	001435'	201300	765530	Type "CHANGE str-name HELP" for a list of options./]
   783	001436'	254000	761323		JRST HLPTY1
   784
   785					DEFINE MKSRP <
   786					X OVERDRAW,<PUSHJ P,STRTOV>,Ab.Nak!Ab.Ver!Ab.Tcv,<
   787				... OVERDRAW  The number of pages for overdraw.>
   788					X CRASH,<PUSHJ P,STRTCH>,Ab.Nak!Ab.Ver!Ab.Tcv,<
   789				... CRASH     The number of pages for CRASH.SAV.>
   790					X ALL,<JRST STRTPA>,Ab.Nak!Ab.Ver!Ab.Tcv,<
   791				... ALL       All of the ABOVE.
   792				              The number of pages for Overdraw, for CRASH.SAV.>
   793					X HELP,<JRST SRPHLP>,Ab.Ack,<
   794				... HELP      Type this message.
   795				>
   796				>
   797	001437'	254000	762433		SCNTB (HLPSRP,HLPSRP,SRP)
   798	001440'	254000	762433
   799	001441'	254000	762433
   800	001442'	260040	764236
   801	001443'	260040	764222
   802	001444'	254000	762541
   803	001445'	254000	762426
   804	001446'	777774	762535
   805	001447'	777774	762450
   806	001450'	576645	624462
   807	001451'	436241	635000
   808	001452'	415454	000000
   809	001453'	504554	600000
   810	001454'	064245	627134
	001455'	202372	642644
	001456'	422450	153500
	001457'	202515	062500
	001460'	673535	561312
	001461'	711015	763100
	001462'	703034	762746
	001463'	203155	771100
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 12-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

	001464'	677554	571310
	001465'	713036	727000
   811	001466'	064245	627134
	001467'	202072	240646
	001470'	441004	020100
	001471'	202515	062500
	001472'	673535	561312
	001473'	711015	763100
	001474'	703034	762746
	001475'	203155	771100
	001476'	416450	151620
	001477'	272470	153134
	001500'	000000	000000
   812	001501'	064245	627134
	001502'	202031	446100
	001503'	201004	020100
	001504'	202035	466100
	001505'	677144	072320
	001506'	625010	141236
   813	001507'	532125	606424
	001510'	201004	020100
	001511'	201004	020100
	001512'	201004	020250
	001513'	643124	067352
	001514'	667054	571100
	001515'	677144	070302
	001516'	637136	320314
	001517'	677444	047754
	001520'	627454	471302
	001521'	735304	063336
	001522'	711010	351202
	001523'	516205	651602
	001524'	531340	000000
   814	001525'	064245	627134
	001526'	202210	546240
	001527'	201004	020100
	001530'	202517	170312
	001531'	203515	064746
	001532'	203334	571746
	001533'	607174	527032
   815	001534'	050000	000000
   816	001535'	000000*	762454
   817	001536'	000000*	762466
   818	001537'	000000*	762501
   819	001540'	000000*	762525
   820
   821	001541'	260040	764236	STRTPA:	PUSHJ P,STRTOV
   822	001542'	260040	764222		PUSHJ P,STRTCH
   823	001543'	254000	761325		JRST SRPCMD
   824
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 13
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   825				;HELP INFORMATION
   826
   827	001544'	505300	440700	LNGMES:	HRLI T1,(POINT 7,0)
   828	001545'	134400	000006	LNGMS1:	ILDB T3,T1
   829	001546'	322400	000000*		JUMPE T3,CPOPJ
   830	001547'	260040	000000*		PUSHJ P,COMTYO
   831	001550'	302400	000012		CAIE T3,12
   832	001551'	254000	762545		JRST LNGMS1
   833	001552'	261040	000006		PUSH P,T1
   834	001553'	260040	000327*		PUSHJ P,OPOUT
   835	001554'	262040	000006		POP P,T1
   836	001555'	254000	762545		JRST LNGMS1
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 14
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   837				COMMENT #
   838				@@SUBROUTINE RDHOME
   839				@@PURPOSE
   840				SUBR TO READ & VERIFY HOME PAGES FOR ALL UNITS AT SYSTEM
   841				INITIALIZATION.  BUILDS THE SYSTEM STR.
   842				SETS INFO IN THE STR DB AND IN THE UNIT DBS.
   843				@@CALLS
   844
   845				@@EXIT
   846				NON-SKIP RETURNS IF AN ERROR WAS DETECTED WHILE READING THE
   847				HOME PAGES OF 1 OR MORE UNITS AND/OR NO STR WAS CREATED
   848				AND/OR MORE THAN ONE STR WAS CREATED.
   849				SKIP RETURNS IF ALL HOME PAGES THAT WERE NOT DOWN READ OK.
   850				@@ #
   851
   852	001556'	260040	000000*	RDHOME:	PUSHJ	P,INLMES##
   853					 ASCIZ /
   854	001557'	064250	364312	Checking all units on disk controller - reading UNIT ID from HOME pages./
	001560'	617275	167316
	001561'	203035	466100
	001562'	727355	172346
	001563'	203375	620310
	001564'	647475	320306
	001565'	677356	471336
	001566'	663314	571100
	001567'	265016	262702
	001570'	623235	663500
	001571'	526351	152100
	001572'	446104	063344
	001573'	677324	044236
	001574'	466124	070302
	001575'	637136	327000
   855	001576'	476000	763117		SETOM	TYPUI0		;Force CRLF next output from TYPUID
   856	001577'	402000	000002*		SETZM	DSKDDB+DEVIOS	;
   857	001600'	700600	000200		WRPI	LI.PIN		;TURN PI SYSTEM ON FOR WAITS
   858	001601'	332200	000174*		SKIPE	F,DDSTAR	;IS THERE A DDB SETUP?
   859	001602'	260040	000175*		PUSHJ	P,CLRDDB	;YES, CLEAR IT
   860	001603'	200300	000000*		MOVE	T1,ONCDDB	;GET LOCATION OF ONCE ONLY DDB
   861	001604'	202300	001601*		MOVEM	T1,DDSTAR
   862	001605'	260040	000000*		PUSHJ	P,SETDDO	;CREATE A DDB FOR ONCE ONLY I/O
   863	001606'	256000	761000		 STOPCD .
   864	001607'	260040	764410		PUSHJ	P,CLRSTR	;INITIALLY THERE IS NO STR.
   865	001610'	402000	763230		SETZM	RANHOM		; Clear so pack-set id check works
   866	001611'	554240	000170*		HLRZ	U,SYSUNI	;GET ADR. OF 1ST UNIT DATA BLOCK IN SYSTEM.
   867	001612'	322240	762617		JUMPE	U,RDHOM2	;
   868	001613'	205400	000000*		MOVSI	T3,UNPPRV	;
   869	001614'	436405	000171*	RDHOM1:	IORM	T3,UNIDES(U)	;SET UNIT TO BE A PRIVATE PACK.
   870	001615'	554245	000172*		HLRZ	U,UNISYS(U)	;
   871	001616'	326240	762614		JUMPN	U,RDHOM1	;
   872	001617'	554240	001611*	RDHOM2:	HLRZ	U,SYSUNI	;
   873	001620'	402000	763226		SETZM	ERRHOM		;CLEAR ERROR(S) WHILE READING HOME PAGES FLAG
   874	001621'	402000	763227		SETZM	ERRHM2
   875	001622'	634300	000006		TDZA	T1,T1
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 14-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   876	001623'	200300	000002	SCNUNI:	 MOVE	T1,J		;SAVE OLD KON
   877	001624'	550105	000000*		HRRZ	J,UNIKON(U)	;GET ADR. OF KONTROLLER DATA PAGE FOR THIS UNIT
   878	001625'	335002	000000*		SKIPGE	KONUPA(J)	;HAS KONTROLLER BEEN FLAGGED AS DOWN?
   879	001626'	254000	762650		 JRST	FLGDWN		;YES - FLAG UNIT AS DOWN ALSO
   880	001627'	316300	000002		CAMN	T1,J		;IS IT THE SAME
   881	001630'	254000	762645		 JRST	KONTOK		;YES, DO NOT NEED TO TRY AGAIN
   882	001631'	260062	001625*	TRYKON:	PUSHJ	P,@KONUPA(J)	;SEE IF KONTROLLER IS UP
   883	001632'	334605	000000*		  SKIPA	P1,UNINAM(U)	;IT'S DOWN
   884	001633'	254000	762645		JRST	KONTOK		;NOW SEE IF UNIT IS OK
   885
   886				;HERE IF KONTROLLER IS DOWN.
   887	001634'	513000	000014		HLLZS	P1		;GET SIXBIT KONTROLLER NAME
   888					MOVEI	T3,[ASCIZ .DO YOU WANT IT TO BE 1)ON-LINE, OR 2)DOWN? (TYPE #)
   889	001635'	201400	765543	.]
   890	001636'	260040	763235		PUSHJ	P,MCKKON	;PRINT MSG & GET ANSWER
   891	001637'	254000	762631		  JRST	TRYKON		;ILLEGAL RESPONSE
   892	001640'	302340	000002		CAIE	T2,2		;WAS "2" TYPED?
   893	001641'	254000	762631		JRST	TRYKON		;NO - CHECK AGAIN IF "1" OR ANYTHING ELSE WAS TYPED
   894	001642'	205300	000000*		MOVSI	T1,KOPDWN	;KONTROLLER DOWN BIT(SIGN BIT)
   895	001643'	436302	000000*		IORM	T1,KONDWN(J)	;FLAG KONTROLLER AS DOWN
   896	001644'	254000	762650		JRST	FLGDWN		;FLAG UNIT DOWN AS WELL
   897
   898				;HERE IF KONTROLLER ON-LINE - TO CHECK IF UNIT OK
   899	762645			KONTOK:
   900				IFCPU (F3),<
   901					MOVSI	T1,UNPOFL
   902					TDNE	T1,UNIDES(U)	;IS UNIT OFF-LINE OR DOWN?
   903					 JRST	SCNUN1		;YES - CONTINUE SCAN ON NEXT UNIT
   904				>;END IFCPU (F3)
   905	001645'	260040	763561		PUSHJ	P,DSKCPY	;GET CAPACITY AND SEE IF UP
   906	001646'	331445	000000*		SKIPL	T4,UNIONC(U)	;1B0 set if off-line, 1B1 if write-protect
   907	001647'	254000	762702		 JRST	WCKUNI		;IF POSITIVE, UNIT IS UP
   908				;Use routine TYPUID instead of UNTDWN to report off-line units
   909
   910				;HERE TO FLAG UNIT AS DOWN & OFF-LINE.
   911	001650'	201340	000000*	FLGDWN:	MOVEI	T2,SYSUNI-UNISYS ;SYSUNI - UNISYS
   912	001651'	554307	001615*	FLGDN1:	HLRZ	T1,UNISYS(T2)	;NEXT UNIT IN SYSTEM
   913	001652'	316300	000005		CAMN	T1,U		;SKIP IF NOT FOUND DOWN UNIT
   914	001653'	254000	762657		 JRST	FLGDN2
   915	001654'	554347	001651*		HLRZ	T2,UNISYS(T2)	;NEXT UNIT IN SYSTEM
   916	001655'	326340	762651		JUMPN	T2,FLGDN1
   917	001656'	254000	762661		JRST	FLGDN3		;NOT THERE?
   918
   919	001657'	554306	001654*	FLGDN2:	HLRZ	T1,UNISYS(T1)	;LINK TO NEXT UNIT
   920	001660'	506307	001657*		HRLM	T1,UNISYS(T2)	;STORE IN PREVIOUS
   921	001661'	334340	000005	FLGDN3:	SKIPA	T2,U		;T2 = THIS UNIT
   922	001662'	554347	001624*	FLGDN4:	 HLRZ	T2,UNIKON(T2)	;NEXT UNIT IN KONTROLLER RING
   923	001663'	554307	001662*		HLRZ	T1,UNIKON(T2)	;NEXT BACK TO US?
   924	001664'	312300	000005		CAME	T1,U
   925	001665'	254000	762662		 JRST	FLGDN4		;NO
   926	001666'	554306	001663*		HLRZ	T1,UNIKON(T1)	;YES, LINK TO NEXT
   927	001667'	506307	001666*		HRLM	T1,UNIKON(T2)	;STORE IN PREVIOUS
   928	001670'	334340	000005		SKIPA	T2,U		;T2 = THIS
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 14-3
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   929	001671'	554347	000000*	FLGDN5:	 HLRZ	T2,UNICHN(T2)	;T2 = NEXT UNIT IN CHANNEL RING
   930	001672'	554307	001671*		HLRZ	T1,UNICHN(T2)
   931	001673'	312300	000005		CAME	T1,U		;BACK TO US?
   932	001674'	254000	762671		 JRST	FLGDN5		;NO
   933	001675'	554306	001672*		HLRZ	T1,UNICHN(T1)	;LINK TO NEXT
   934	001676'	506307	001675*		HRLM	T1,UNICHN(T2)	;STORE IN PREVIOUS
   935	001677'	205300	000000*		MOVSI	T1,UNPOFL	;OFF-LINE BIT
   936	001700'	436305	001614*		IORM	T1,UNIDES(U)	;SET BIT IN LH. OF UNIDES WORD
   937	001701'	254000	763071		JRST	SCNUN1		;CONTINUE SCAN ON NEXT UNIT
   938
   939				;HERE IF UNIT ON-LINE - TO CHECK IF UNIT WRITE ENABLED
   940	001702'	205300	000000*	WCKUNI:	MOVSI T1,UNPHWP
   941	001703'	616305	001700*		TDNN T1,UNIDES(U)
   942	001704'	607440	200000		TLNN T4,(1B1)		;IS IT WRITE PROTECTED?
   943	001705'	254000	762715		 JRST CHKHOM		;UNIT IS OK OR HAVE BEEN HERE BEFORE
   944					MOVEI	T3,[ASCIZ .DO YOU WANT IT TO BE 1)WRITE-ENABLED, OR 2)WRITE-PROTECTED? (TYPE #)
   945				
   946	001706'	201400	765556	.]
   947	001707'	260040	763231		PUSHJ	P,WRPUNM	;PRINT MSG & GET ANSWER
   948	001710'	254000	762631		  JRST	TRYKON		;ILLEGAL RESPONSE
   949	001711'	302340	000002		CAIE	T2,2		;WAS "2" TYPED?
   950	001712'	254000	762631		JRST	TRYKON		;NO - CHECK AGAIN IF "1" OR ANYTHING ELSE WAS TYPED
   951	001713'	205300	001702*		MOVSI	T1,UNPHWP	;HARDWARE WRITE-PROTECT BIT
   952	001714'	436305	001703*		IORM	T1,UNIDES(U)	;FLAG UNIT AS WRITE PROTECTED
   953					PFALL	CHKHOM
   954
   955				;HERE IF UNIT ON-LINE & LEGALLY WRITE PROTECTED OR ENABLED - CHECK ITS HOME PAGES
   956
   957	001715'	260040	763354	CHKHOM:	PUSHJ	P,GETHOM	;GET HOME PAGE INTO CORE.
   958	001716'	304000	000000		  CAIA			;ERROR(S) ON BOTH HOME PAGES - T3 RETURNED NON 0.
   959	001717'	254000	762727		JRST	HMBOK		;AT LEAST ONE HOME PAGE OK
   960								;FORCE TO BE A NULL PAGE, NO OPTIONS
   961	001720'	201300	753000		MOVEI	T1,%HOM		;
   962	001721'	260040	000000*		PUSHJ	P,CORZER	;
   963	001722'	202640	753000*		MOVEM	P2,%HOM+PAGNAM	;STORE SIXBIT "HOM"
   964	001723'	202700	753000*		MOVEM	P3,%HOM+PAGCOD	;STORE HOME PAGE CODE
   965	001724'	260040	763652		PUSHJ	P,SETCHG	;FLAG THAT THIS UNIT'S HOME PAGE MUST BE REWRITTEN
   966	001725'	260040	763265		PUSHJ	P,MOVUNI	;MOVE PARAMS FROM HOME PAGE TO UNIT DATA BLOCK.
   967	001726'	254000	763054		JRST	NTISTR		;
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 15
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

   968				;HERE IF HOME PAGE(S) READ INTO CORE OK
   969				; GENERATE STR DB & LINK UNIT DBS CORRECTLY.
   970
   971	001727'	322400	762731	HMBOK:	JUMPE	T3,.+2		;ERR WHILE READING HOME PAGES?
   972	001730'	260040	763652		PUSHJ	P,SETCHG	;YES. FLAG THEY NEED REWRITING.
   973	001731'	260040	763265		PUSHJ	P,MOVUNI	;MOVE PARAMS FROM HOME PAGE TO UNIT DB
   974	001732'	201640	000000		MOVEI	P2,0		;SET STR DB ADR. = 0 IN CASE NO STR FOUND
   975	001733'	200300	753000*		MOVE	T1,%HOM+HOMSNM	;GET STR NAME FROM HOME PAGE.
   976	001734'	322300	763054		JUMPE	T1,NTISTR	;DON'T LOOK FOR OR CREATE A ZERO STR NAME.
   977	001735'	260040	763260	HMBOK2:	PUSHJ	P,FNDSTR	;DOES THIS STR EXIST?
   978	001736'	254000	762756		  JRST	NOTPRV		;YES. UNIT IS NOT A PRIVATE PACK.
   979	001737'	332015	000000*		SKIPE	STRNAM(P2)	;NO, DOES ANY STR EXIST?
   980	001740'	254000	763047		 JRST	NOSTR		;YES, ONLY ONE STR IS LEGAL. DIE.
   981								;NO, THIS IS THE SYSTEM STR.
   982	001741'	260040	763304		PUSHJ	P,MOVSTR	;MOVE PARAMS FROM HOME PAGE TO STR DB.
   983	001742'	200340	761003		MOVE	T2,REONCE	;GET ONCE COPY OF RESTRT WORD
   984	001743'	621340	140000		TLZ	T2,DCN.UR!DCN.MN	;IN CASE STR IS MODIFIED
   985	001744'	550300	753000*		HRRZ	T1,%HOM+HOMRAN	;GET PACK SET ID
   986	001745'	312300	000000*		CAME	T1,REPSID	;HAS NEW PACK SET BEEN MOUNTED?
   987	001746'	254000	762754		 JRST	HMBOK3		;YES: IGNORE RESTRT
   988	001747'	400300	000000		SETZ	T1,		;ZERO DSKCLN TYPE SPEC FLAG WORD
   989	001750'	602340	000000*		TRNE	T2,RE.DCD	;DID USER SELECT A DSKCLN TYPE?
   990	001751'	661300	100000		 TLO	T1,DCN.UR	;YES: SO INDICATE
   991	001752'	661300	040000		TLO	T1,DCN.MN	;IND MON SELECTED A DSKCLN TYPE
   992	001753'	436300	000057*		IORM	T1,DCN
   993	001754'	200300	753000*	HMBOK3:	MOVE	T1,%HOM+HOMDCT	;INITIALIZE FOR VERIFICATION OF
   994	001755'	137300	761010		DPB	T1,DCNYHM	; HOME BLOCK DSKCLN TYPE VALIDITY
   995	001756'	260040	763657	NOTPRV:	PUSHJ	P,SETPUB	;SET THE UNIT PUBLIC.
   996
   997				    ;HERE WHEN STR UNIT BELONGS IN EXISTS
   998	001757'	322640	763011	OLDSTR:	JUMPE	P2,OLDST8	;SKIP OVER RAN & HSH CHK IF NO STR.
   999	001760'	135300	761010		LDB	T1,DCNYHM	;SET UP TO VERIFY THAT HOME
  1000	001761'	505300	000000*		HRLI	T1,HOMDCV	; DSKCLN TYPE IS VALID/CONSISTENT
  1001	001762'	515340	020000		HRLZI	T2,DCN.HM
  1002	001763'	312300	753000*		CAME	T1,%HOM+HOMDCT	;IS TYPE GOOD?
  1003	001764'	412340	001753*		 ANDCAM	T2,DCN		;NO: SO INDICATE
  1004	001765'	554300	753000*		HLRZ	T1,%HOM+HOMHSH	;T1/ UNIT'S HASH CONSTANT.
  1005	001766'	322300	762775		JUMPE	T1,OLDST1	;MUST BE NON-ZERO.
  1006	001767'	550355	000000*	OLDST2:	HRRZ	T2,STRHSH(P2)	;T2/ STR'S HASH CONSTANT SET
  1007	001770'	326340	762773		JUMPN	T2,OLDST0	;YET?
  1008	001771'	542315	001767*		HRRM	T1,STRHSH(P2)	;NO, JUST STORE FIRST FOUND.
  1009	001772'	254000	762777		JRST	OLDST4		;GO TO RAN LOOK.
  1010	001773'	306307	000000	OLDST0:	CAIN	T1,(T2)		;YES, BETTER MATCH OTHERS'.
  1011	001774'	254000	762777		 JRST	OLDST4		;OKAY.
  1012	001775'	201300	765575	OLDST1:	MOVEI	T1,[ASCIZ /MISSING OR INCONSISTENT HASH CONSTANT FOR UNIT /]
  1013	001776'	260040	763345		PUSHJ	P,MSGUNI	;
  1014	001777'	550300	753000*	OLDST4:	HRRZ	T1,%HOM+HOMRAN	;T1/ UNIT'S PACK SET ID.
  1015	002000'	322300	763007		JUMPE	T1,OLDST5	;CAN'T BE ZERO.
  1016	002001'	332340	763230	OLDST6:	SKIPE	T2,RANHOM	;ALREADY SEEN ID?
  1017	002002'	254000	763005		 JRST	STRFIX		;YES.
  1018	002003'	552300	763230		HRRZM	T1,RANHOM	;NO, JUST STORE FIRST FOUND.
  1019	002004'	254000	763011		 JRST	OLDST8		;
  1020	002005'	306307	000000	STRFIX::CAIN	T1,(T2)		;YES, BETTER MATCH OTHERS'.
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 15-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1021	002006'	254000	763011		 JRST	OLDST8		;OKAY.
  1022				 ;Label STRFIX to JFCL missing or inconsistant pack set it
  1023	002007'	201300	765607	OLDST5:	MOVEI	T1,[ASCIZ /MISSING OR INCONSISTENT PACK SET ID FOR UNIT /]
  1024	002010'	260040	763345		PUSHJ	P,MSGUNI	;
  1025	763011			OLDST8:	
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 16
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1026	002011'	322640	763054		JUMPE	P2,NTISTR	;IF UNIT NOT IN STR, JUMP OVER THIS.
  1027					MOVEI	T1,[ASCIZ .
  1028	002012'	201300	765621	DISK FORMAT DOES NOT MATCH EXPECTED FORMAT ON UNIT .]
  1029	002013'	336340	000000*		SKIPN	T2,DSKPPU##	;# of disk pages per unit we expect
  1030	002014'	200345	000153*		 MOVE	T2,UNIPPU(U)	;If zero, we can accept anything
  1031	002015'	312345	002014*		CAME	T2,UNIPPU(U)	;Match?
  1032	002016'	260040	763345		 PUSHJ	P,MSGUNI	;Error, don't let BPXKON destroy 3650 disk
  1033	002017'	135340	000072*		LDB	T2,UNYLUN	;GET LOGICAL UNIT # WITHIN STR
  1034	002020'	332000	753000*		SKIPE	%HOM+HOMNXT	;IS THIS LAST UNIT IN STR?
  1035	002021'	254000	763033		 JRST	NLSUNI		;NO - GO LINK UNIT DATA BLOCK INTO STR
  1036	002022'	550315	000000*		HRRZ	T1,STRUNM(P2)	;HAVE WE ALREADY SEEN A LAST UNIT FOR THIS STR?
  1037	002023'	322300	763030		JUMPE	T1,LSTUNI	;NO - NOW WE HAVE
  1038	002024'	261040	000007		PUSH	P,T2		;SAVE LOG. UNIT #
  1039					MOVEI	T1,[ASCIZ .
  1040	002025'	201300	765634	MORE THAN ONE LAST UNIT IN STR .]
  1041	002026'	260040	763336		PUSHJ	P,MSGSTR	;PRINT MSG FOLLOWED BY SIXBIT STR NAME
  1042	002027'	262040	000007		POP	P,T2		;RESTORE LOG. UNIT #
  1043
  1044				;HERE WHEN UNIT READ IS THE LAST IN A STR.
  1045
  1046	002030'	405340	000077	LSTUNI:	ANDI	T2,77		;MAX. OF 64 UNITS IN STR!!!!!!!
  1047	002031'	542355	002022*		HRRM	T2,STRUNM(P2)	;STORE LOG. # OF LAST UNIT IN STR
  1048	002032'	350015	002031*		AOS	STRUNM(P2)	;LEAVE T2 ALONE BUT MAKE MEMORY OK
  1049
  1050				;HERE WHEN UNIT READ ISN'T LAST IN THE STR
  1051				; LINK UNIT TO STR & OTHER UNITS IN STR
  1052
  1053	002033'	201455	000000*	NLSUNI:	MOVEI	T4,STRUNI(P2)	;GET ADR. OF LINK TO 1ST. UNIT DATA BLOCK IN STR
  1054	002034'	254000	763041		JRST	LINKT1
  1055
  1056	002035'	135400	000000*	LINKIT:	LDB	T3,UNYLN1	;YES - GET LOG. UNIT # OF NEXT UNIT
  1057	002036'	313400	000007		CAMLE	T3,T2		;IS IT GREATER THAN UNIT JUST READ?
  1058	002037'	254000	763043		 JRST	INSERT		;YES - INSERT UNIT DATA BLOCK HERE
  1059	002040'	201446	001343*		MOVEI	T4,UNISTR(T1)	;GET ADR. OF LINK TO NEXT UNIT
  1060	002041'	554311	000000	LINKT1:	HLRZ	T1,(T4)		;GET ADR. OF NEXT UNIT DATA BLOCK IN STR
  1061	002042'	326300	763035		JUMPN	T1,LINKIT	;MORE DATA BLOCKS?
  1062	002043'	506305	002040*	INSERT:	HRLM	T1,UNISTR(U)	;SAVE LINKS TO STR & NEXT UNIT DATA BLOCK
  1063	002044'	542645	002043*		HRRM	P2,UNISTR(U)	; IN THIS UNIT DATA BLOCK
  1064	002045'	506251	000000		HRLM	U,(T4)		;SAVE THIS UNIT ADR. IN PREVIOUS UNIT DATA BLOCK
  1065								; (OR STR DATA BLOCK)
  1066	002046'	254000	763055		JRST	CRESTT		;TRY & SETUP SAB RING & SPT TABLE FOR THIS UNIT
  1067
  1068				NOSTR:	MOVEI T1,[ASCIZ /
  1069	002047'	201300	765643	TOO MANY STR'S /]
  1070	002050'	260040	000326*		PUSHJ P,OCONM
  1071	002051'	200340	753000*		MOVE	T2,%HOM+HOMSNM
  1072	002052'	260040	763343		PUSHJ P,NAMFLO
  1073	002053'	256000	761000		STOPCD
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 17
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1074				;HERE TO CREATE STT TABLE FOR THIS UNIT.
  1075				;(EVEN IF NOT IN STR, MAY ADD TO STR LATER.).
  1076
  1077	002054'	402005	000000*	NTISTR:	SETZM	UNILOG(U)	;INDICATE UNIT NOT IN A STR.
  1078	002055'	260040	764162	CRESTT:	PUSHJ	P,SPUCLC	;CALC NO. SATS ON UNIT.
  1079	002056'	135700	000155*		LDB	P3,UNYSPU	;
  1080	002057'	221700	000151*		IMULI	P3,STTLEN	;COMPUTE LENGTH OF
  1081	002060'	271700	000001		ADDI	P3,1		;STT TABLE.
  1082	002061'	200340	000016		MOVE	T2,P3		;GET TOTAL NO. OF WORDS NEEDED
  1083	002062'	260040	000000*		PUSHJ	P,EVMALC##	;FOR STT
  1084	002063'	542305	000122*		HRRM	T1,UNISTT(U)	;STORE ADR OF STT IN UNIT DB.
  1085	002064'	402006	000000		SETZM	(T1)		;
  1086	002065'	515346	000000		HRLZI	T2,(T1)		;BUILD A
  1087	002066'	541346	000001		HRRI	T2,1(T1)	;BLT AC.
  1088	002067'	271316	777777		ADDI	T1,-1(P3)	;ADR OF LAST WORD IN STT TABLE.
  1089	002070'	251346	000000		BLT	T2,(T1)		;CLEAR THE STT.
  1090
  1091	002071'	260040	763120	SCNUN1:	PUSHJ	P,TYPUID	;Output physical name and HOM id
  1092	002072'	554245	001660*		HLRZ	U,UNISYS(U)	;GET NEXT UNIT DB ADR IN SYSTEM.
  1093	002073'	326240	762623		JUMPN	U,SCNUNI	;AROUND AGAIN IF ANY LEFT
  1094	002074'	260040	763646		PUSHJ	P,CRLFOP	;Finish off last disk report line
  1095	002075'	260040	763646		PUSHJ	P,CRLFOP	;Add a blank line
  1096
  1097					PRINTF(<[Need to define seperate UNTTBL for each STR]>)
  1098				    ;HERE TO CREATE UNTTBL.
  1099	002076'	402000	000000*		SETZM	UNTTBL		;CLEAR OUT
  1100	002077'	505300	002076*		HRLI	T1,UNTTBL	;ALL
  1101	002100'	541300	000001*		HRRI	T1,UNTTBL+1	;OF
  1102	002101'	251300	000000*		BLT	T1,UNTTBL+UNTLEN-1 ;UNTTBL.
  1103
  1104	002102'	554240	001617*		HLRZ U,SYSUNI		;GET SET TO GENERATE UNTTBL
  1105	002103'	201300	777777*		MOVEI T1,UNTLEN-1
  1106	002104'	322240	763154	SETUNT:	JUMPE U,SCNSTR	;DONE
  1107	002105'	332005	002054*		SKIPE UNILOG(U)		;IS IT IN A STR?
  1108	002106'	254000	763113		JRST SETUTS		;YES
  1109	002107'	202246	002077*		MOVEM U,UNTTBL(T1)
  1110	002110'	137300	002017*		DPB T1,UNYLUN
  1111	002111'	554245	002072*		HLRZ U,UNISYS(U)
  1112	002112'	364300	763104		SOJA T1,SETUNT		;AND GO
  1113
  1114	002113'	135340	002110*	SETUTS:	LDB T2,UNYLUN
  1115	002114'	202247	002107*		MOVEM U,UNTTBL(T2)
  1116	002115'	554245	002111*		HLRZ U,UNISYS(U)
  1117	002116'	254000	763104		JRST SETUNT
  1118
  1119	002117'	777777	777777	TYPUI0:	-1
  1120	002120'	265340	763706	TYPUID:	JSP	T2,SVOTAC	;Save ACs
  1121	002121'	350340	763117		AOS	T2,TYPUI0	;Formatting
  1122	002122'	606340	000003		TRNN	T2,3		;If multiple of 4,
  1123	002123'	260040	763646		 PUSHJ	P,CRLFOP	; start a new line
  1124	002124'	135340	000000*		LDB	T2,UNYPUN##	;Get physical unit number
  1125	002125'	307340	000007		CAIG	T2,7		;If single digit number
  1126	002126'	260040	000000*		 PUSHJ	P,PRSPC##	; output leading blank
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 17-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1127	002127'	200345	001632*		MOVE	T2,UNINAM(U)
  1128	002130'	260040	000000*		PUSHJ	P,PRNAME##	;Physical unit name
  1129	002131'	260040	000000*		PUSHJ	P,PRCOL##	;Colon
  1130	002132'	335305	001646*		SKIPGE	T1,UNIONC(U)	;Off line?
  1131	002133'	254000	763143		 JRST	TYPUI1		;Yes
  1132	002134'	200345	001415*		MOVE	T2,UNIHID(U)	;No, get UNIT-ID from HOM block
  1133	002135'	260040	000000*		PUSHJ	P,PRNAMF##	;Output 6 digits
  1134	002136'	332345	002105*		SKIPE	T2,UNILOG(U)	;Get name (such as 'DSKB17')
  1135	002137'	505340	000035		 HRLI	T2,'  ='	;If blank leave it blank, else
  1136	002140'	241340	000014		ROT	T2,^D12		; make it '=B17  '
  1137	002141'	260040	002135*		PUSHJ	P,PRNAMF##	;Output 6 characters (even if all blanks)
  1138	002142'	324740	001553*		PJRST	OPOUT		;Force out message now
  1139	002143'	200306	763146	TYPUI1:	MOVE	T1,OFLTAB(T1)	;Get addr of off-line message
  1140	002144'	260040	000017*		PUSHJ	P,CONMES##	;Output 12 ASCII characters
  1141	002145'	324740	002142*		PJRST	OPOUT
  1142
  1143			763146		%%ZZQ==.
  1144	000000			OFLTAB:	PHASE 0 ;123456789012;	;4 drive reports per line = 72 columns
  1145	002146'	000000	765647		 [ASCIZ /-offline-   /]	;Pack not spinning or no ID plug
  1146	002147'	000000	765652	%OFLER::![ASCIZ /unit error  /]	;Hardware indications on drive
  1147	002150'	000000	765655	%OFLFM::![ASCIZ /bad format  /]	;Incorrectly formatted pack on drive
  1148	002151'	000000	765660	%OFLMT::![ASCIZ /maintenance /]	;Drive is in MAINT. mode
  1149	002152'	000000	765663	%OFLRS::![ASCIZ /(no disk)   /]	;No response from drive (RM03 not plugged in)
  1150	002153'	000000	765666	%OFLIG::![ASCIZ /(ignored)   /]	;Wrong vol-set-ID (belongs to another system)
  1151	763154				PHASE .+%%ZZQ
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 18
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1152				;HERE WHEN ALL UNITS IN SYSTEM HAVE TRIED TO BE READ &
  1153				; THE STR DATA BLOCK HAS BEEN CREATED IF IT CAN BE.  NOW
  1154				; CHECK THAT ALL UNITS THAT SHOULD BE ARE PRESENT IN THE STR.
  1155
  1156	002154'	201640	000000*	SCNSTR:	MOVEI	P2,STRDDB	;GET ADR. OF STR DATA BLOCK.
  1157	002155'	336015	001737*		SKIPN	STRNAM(P2)	;IS THERE A STR?
  1158	002156'	254000	763217		 JRST	SCNSTD		;NO, NON-SKIP RETURN
  1159	002157'	550315	002032*		HRRZ	T1,STRUNM(P2)
  1160	002160'	326300	763173		JUMPN	T1,LSTRED	;WAS THE LAST UNIT IN THIS STR FOUND?
  1161					MOVEI	T1,[ASCIZ .
  1162	002161'	201300	765671	LAST UNIT WASN'T FOUND IN STR .]
  1163	002162'	260040	763336		PUSHJ	P,MSGSTR	;NO - PRINT MSG. FOLLOWED BY SIXBIT STR NAME
  1164	002163'	554255	002033*		HLRZ	U,STRUNI(P2)	;GET ADR. OF 1ST. UNIT DATA BLOCK IN STR
  1165	002164'	334000	000000		SKIPA			;
  1166	002165'	200240	000006	SCNST2:	MOVE	U,T1
  1167	002166'	554305	002044*		HLRZ	T1,UNISTR(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN STR
  1168	002167'	326300	763165		JUMPN	T1,SCNST2	;REPEAT UNTIL LAST ONE FOUND
  1169	002170'	135300	002113*		LDB	T1,UNYLUN	;GET ITS LOG. UNIT # IN STR
  1170	002171'	271300	000001		ADDI	T1,1		;MAKE INTO # UNITS IN STR
  1171	002172'	542315	002157*		HRRM	T1,STRUNM(P2)	; & STORE IT
  1172
  1173				;HERE TO CHECK FOR THE PRESENCE OF ALL UNITS BUT THE LAST IN A STR.
  1174
  1175	002173'	554255	002163*	LSTRED:	HLRZ	U,STRUNI(P2)	;GET ADR. OF 1ST. UNIT DATA BLOCK IN THIS STR
  1176	002174'	476000	000017		SETOM	P4		;SETUP FAKE PREVIOUS LOG. UNIT #
  1177	002175'	135600	002170*	CHKUNI:	LDB	P1,UNYLUN	;GET LOG. UNIT # OF THIS UNIT WITHIN STR
  1178	002176'	250600	000017		EXCH	P1,P4		;PUT THIS & PREVIOUS LOG. UNIT #'S IN PROPER ACS
  1179	002177'	312740	000014		CAME	P4,P1		;ARE LOG. UNIT #'S THE SAME?
  1180	002200'	254000	763205		 JRST	MISUNI		;NO - CHECK FOR MISSING UNITS
  1181					MOVEI	T3,[ASCIZ .
  1182	002201'	201400	765700	TWO LOGICAL UNIT .]
  1183	002202'	201300	765704		MOVEI	T1,[ASCIZ .'S FOUND IN STR .]
  1184	002203'	260040	763326		PUSHJ	P,MSGLNG	;PRINT MSGS FOLLOWED BY SIXBIT STR NAME
  1185	002204'	254000	763214		JRST	CHKUN1		;CHECK NEXT PAIR OF UNITS
  1186
  1187	002205'	306754	000001	MISUNI:	CAIN	P4,1(P1)	;IS THIS UNIT 1 GREATER THAN LAST ONE?
  1188	002206'	254000	763214		 JRST	CHKUN1		;YES - CHECK NEXT PAIR OF UNITS
  1189	002207'	271600	000001		ADDI	P1,1		;INCREMENT TO GET CORRECT MISSING LOG. UNIT #
  1190					MOVEI	T3,[ASCIZ .
  1191	002210'	201400	765710	LOGICAL UNIT .]
  1192	002211'	201300	765714		MOVEI	T1,[ASCIZ . MISSING FROM STR .]
  1193	002212'	260040	763326		PUSHJ	P,MSGLNG
  1194	002213'	254000	763205		JRST	MISUNI		;REPEAT UNTIL ALL MISSING ARE TYPED OUT
  1195
  1196	002214'	554245	002166*	CHKUN1:	HLRZ	U,UNISTR(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN STR
  1197	002215'	326240	763175		JUMPN	U,CHKUNI
  1198	002216'	254000	763221		JRST	SCNSD2
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 19
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1199				;HERE WHEN THROUGH CHECKING ALL UNITS WITHIN A STR.
  1200
  1201				SCNSTD:	MOVEI	T1,[ASCIZ .
  1202	002217'	201300	765720	?NO SYSTEM STRUCTURE.]
  1203	002220'	260040	763641		PUSHJ	P,SVMOT2	;NO, TYPE MESSAGE
  1204	002221'	332000	763226	SCNSD2:	SKIPE	ERRHOM		;ANY ERRORS?
  1205	002222'	350001	000000		AOS	(P)		;NO - SKIP RETURN
  1206	002223'	332000	763227		SKIPE ERRHM2
  1207	002224'	350001	000000		AOS (P)
  1208	002225'	263040	000000		POPJ	P,
  1209
  1210	002226'	000000	000000	ERRHOM:	0			;FLAG FOR ERRORS WHILE READING A HOME PAGE.
  1211	002227'	000000	000000	ERRHM2:	0			;"BAD" ERROR DETECTED.
  1212
  1213	002230'	000000	000000	RANHOM:	Z			; Holds PACK-SET ID info (random #)
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 20
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1214	002231'	201440	765725	WRPUNM:	MOVEI	T4,[ASCIZ . IS WRITE PROTECTED.]
  1215
  1216	002232'	200605	002127*		MOVE	P1,UNINAM(U)	;GET SIXBIT UNIT NAME
  1217					MOVEI	T1,[ASCIZ .
  1218	002233'	201300	765731	.]
  1219	002234'	324740	763237		PJRST	NASTYP		;TYPE MSGS. & GET USER'S RESPONSE
  1220
  1221				;SUBROUTINE TO PRINT "CONTROLLER" FOLLOWED BY A "NAME" FOLLOWED BY "IS OFF-LINE"
  1222				; FOLLOWED BY A MESSAGE ASKING WHAT STATE OF THE KONTROLLER IS DESIRED
  1223				; THEN IT WAITS FOR OPERATOR TO TYPE AN OCTAL NUMBER TERMINATED BY CRLF
  1224				;CALL	MOVE	P1,SIXBIT KONTROLLER NAME
  1225				;	MOVEI	T3,MSG. ADR.
  1226				;	PUSHJ	P,MCKKON
  1227				;	  ERROR RETURN	MSG. PRINTED BUT RESPONSE WASN'T AN OCTAL #
  1228				;	OK RETURN	 "      "    T2 CONTAINS OCTAL # TYPED
  1229
  1230				MCKKON:	MOVEI	T1,[ASCIZ .
  1231	002235'	201300	765731	.]
  1232	002236'	201440	765732		MOVEI	T4,[ASCIZ . IS OFF-LINE.]
  1233	002237'	265340	763706	NASTYP:	JSP	T2,SVOTAC	;SAVE P4,F,U & J
  1234	002240'	261040	000010		PUSH	P,T3		;SAVE 2ND. MSG ADR.
  1235	002241'	261040	000011		PUSH	P,T4		;SAVE 1ST. MSG. ADR.
  1236	002242'	260040	002050*		PUSHJ	P,OCONM		;PUT MSG IN BUFFER
  1237	002243'	200340	000014		MOVE	T2,P1		;GET UNIT/KONTROLLER SIXBIT NAME
  1238	002244'	260040	002130*		PUSHJ	P,PRNAME	;PUT IT IN BUFFER
  1239	002245'	262040	000006		POP	P,T1		;RESTORE 1ST. MSG. ADR.
  1240	002246'	260040	002144*		PUSHJ	P,CONMES	;PUT MSG. IN BUFFER
  1241	002247'	260040	763646		PUSHJ	P,CRLFOP	;ADD CRLF & O/P MSG.
  1242	002250'	262040	000006		POP	P,T1		;RESTORE 2ND. MSG ADR.
  1243	002251'	260040	763645		PUSHJ	P,CONOUT	;O/P MSG. & ADD CRLF
  1244	002252'	260040	000332*		PUSHJ	P,GETLIN	;GET USER'S RESPONSE
  1245	002253'	263040	000000		  POPJ	P,		;CR TYPED
  1246	002254'	260040	000000*		PUSHJ	P,OCTIN		;READ IT AS AN OCTAL NO.
  1247	002255'	263040	000000		  POPJ	P,		;NOTHING BUT A BREAK CH.
  1248	002256'	263040	000000		  POPJ	P,		;ILLEGAL CH.
  1249	002257'	254000	000305*		JRST	CPOPJ1		;OK RETURN WITH NO. IN T2
  1250
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 21
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1251				COMMENT #
  1252				@@SUBROUTINE FNDSTR
  1253				@@PURPOSE
  1254				SUBR TO SET UP THE STR DB ADDRESS IN P2 IF THE STR HAS THE
  1255				SIXBIT NAME IN T1.
  1256				@@ENTRY
  1257				EXPECTS SIXBIT STR NAME IN T1.
  1258				@@ACCUM
  1259				DESTROYS T1 AND P2.
  1260				@@EXIT
  1261				NON-SKIP RETURNS ONLY IF THE SYSTEM STR HAS BEEN SET UP AND IT
  1262				HAS THE NAME IN T1.  ELSE SKIP RETURNS.
  1263				@@ #
  1264
  1265	002260'	201640	002154*	FNDSTR:	MOVEI	P2,STRDDB	;GET ADDR OF STR DB TO P2.
  1266	002261'	620300	007777		TRZ	T1,7777		;STR NAMES ARE A MAX OF 4 CHARS.
  1267	002262'	312315	002155*		CAME	T1,STRNAM(P2)	;
  1268	002263'	350001	000000		AOS	(P)		;
  1269	002264'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 22
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1270				;SUBROUTINE TO MOVE PARAMETERS FROM HOME PAGE TO UNIT DATA BLOCK
  1271
  1272	002265'	200300	753000*	MOVUNI:	MOVE	T1,%HOM+HOMLOG	;05 Logical unit name (DSKB0-DSKB37)
  1273	002266'	202305	002136*		MOVEM	T1,UNILOG(U)	;01
  1274	002267'	200300	753000*		MOVE	T1,%HOM+HOMHID	;01 Unit ID (330000-330037)
  1275	002270'	202305	002134*		MOVEM	T1,UNIHID(U)	;02
  1276	002271'	200300	753000*		MOVE	T1,%HOM+HOMLUN	;06 Logical unit number (00-37)
  1277	002272'	137300	002175*		DPB	T1,UNYLUN	;03
  1278	002273'	200300	753000*		MOVE	T1,%HOM+HOMSPU	;15 Sats per unit (4 or 8)
  1279	002274'	137300	002056*		DPB	T1,UNYSPU	;43
  1280	002275'	205340	000000*		MOVSI	T2,UNPMSB	;400
  1281	002276'	412345	001714*		ANDCAM	T2,UNIDES(U)	;53
  1282	002277'	302300	000001		CAIE	T1,1		;If more than one SAT page
  1283	002300'	436345	002276*		 IORM	T2,UNIDES(U)	; then set Multiple Sat Blocks bit
  1284	002301'	200300	753000*		MOVE	T1,%HOM+HOMFEP	;14 Front-End Pointer (set on 2020 disks)
  1285	002302'	202305	000000*		MOVEM	T1,UNIFEP(U)	;07 (nonzero when BOOTS in pages 3-5 on KS)
  1286	002303'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 23
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1287				;SUBROUTINE TO MOVE PARAMETERS FROM HOME PAGE TO STR DB.
  1288
  1289	002304'	200300	753000*	MOVSTR:	MOVE	T1,%HOM+HOMSNM	;02 Structure name
  1290	002305'	202315	002262*		MOVEM	T1,STRNAM(P2)	;00
  1291	002306'	550300	753000*		HRRZ	T1,%HOM+HOMP4C	;26 Pages for CRASH.SAV
  1292	002307'	542315	000000*		HRRM	T1,STRP4C(P2)	;02
  1293	002310'	200300	753000*		MOVE	T1,%HOM+HOMSUF	;23 Page # of RIB to SYS on unit 0
  1294	002311'	661300	000101*		TLO	T1,RBREAL	;   Make it a real RIB pointer
  1295	002312'	202300	000000*		MOVEM	T1,SYSRIB##
  1296	002313'	200300	753000*		MOVE	T1,%HOM+HOMMFD	;25 Page # of RIB to MFD on unit 0
  1297	002314'	661300	002311*		TLO	T1,RBREAL	;   Make it a real RIB pointer
  1298	002315'	202300	000000*		MOVEM	T1,MFDRIB
  1299	002316'	200305	002015*		MOVE	T1,UNIPPU(U)	;41 Pages per unit
  1300	002317'	313315	000000*		CAMLE	T1,STRPPU(P2)	;06 If this one has more than any other in STR
  1301	002320'	202315	002317*		 MOVEM	T1,STRPPU(P2)	;06  then set this bogus value
  1302	002321'	200300	753000*		MOVE	T1,%HOM+HOMOVR
  1303	002322'	202315	000000*		MOVEM	T1,STROVR(P2)
  1304	002323'	200300	753000*		MOVE	T1,%HOM+HOMREF
  1305	002324'	502315	000000*		HLLM	T1,STRREF(P2)
  1306	002325'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 24
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1307				;Error messages
  1308	002326'	265340	763705	MSGLNG:	JSP	T2,REFSAV	;SAVE P4,T3,F,U & J AND INDICATE STR NEEDS REFRESHING
  1309	002327'	261040	000006		PUSH	P,T1		;SAVE 2ND. MSG ADR. IN T1
  1310	002330'	200300	000010		MOVE	T1,T3		;GET ADR OF 1ST. MSG
  1311	002331'	260040	000000*		PUSHJ P,CLRSND
  1312	002332'	260040	763633		PUSHJ	P,TYPDEC	;PUT MSG. & UNIT # IN BUFFER
  1313	002333'	260040	002145*		PUSHJ	P,OPOUT		;O/P BUFFER
  1314	002334'	262040	000006		POP	P,T1		;RESTORE 2ND. MSG ADR.
  1315	002335'	304000	000000		CAIA
  1316
  1317	002336'	265340	763705	MSGSTR:	JSP	T2,REFSAV	;SAVE P4,T3,F,U & J AND INDICATE STR NEEDS REFRESHING
  1318	002337'	260040	002242*		PUSHJ	P,OCONM		;PUT MSG. IN BUFFER
  1319	002340'	476000	763226		SETOM	ERRHOM		;INDICATE ERROR IN "RDHOME"
  1320	002341'	476000	763227		SETOM ERRHM2		;"BAD" ERROR
  1321	002342'	200355	002305*		MOVE	T2,STRNAM(P2)	;GET SIXBIT STR NAME
  1322	002343'	260040	002244*	NAMFLO:	PUSHJ	P,PRNAME	;PUT IT IN THE BUFFER FOLLOWED BY CRLF & START O/P
  1323	002344'	324740	763646		PJRST	CRLFOP
  1324
  1325
  1326	002345'	265340	763705	MSGUNI:	JSP	T2,REFSAV
  1327	002346'	261045	002232*		PUSH	P,UNINAM(U)
  1328	002347'	260040	002337*		PUSHJ	P,OCONM
  1329	002350'	476000	763226		SETOM	ERRHOM
  1330	002351'	476000	763227		SETOM	ERRHM2
  1331	002352'	262040	000007		POP	P,T2
  1332	002353'	324740	763343		PJRST	NAMFLO
  1333
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 25
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1334				COMMENT #
  1335				@@SUBROUTINE GETHOM
  1336				@@PURPOSE
  1337				SUBR TO TRY TO READ BOTH OF A UNIT'S HOME PAGES SUCCESSFULLY
  1338				INTO %HOM.
  1339				@@ENTRY
  1340				EXPECTS U/ UNIT DB AND F/ DDB.
  1341				PRINTS NO ERROR MESSAGES IF NOERH <> 0.
  1342				@@ACCUM
  1343				DESTROYS
  1344				@@EXIT
  1345				SKIP RETURNS IF AT LEAST ONE OF THE PAGES READ SUCCESSFULLY.
  1346				@@ #
  1347
  1348	002354'	205640	505755	GETHOM:	MOVSI	P2,(SIXBIT .HOM.)
  1349	002355'	201700	000000*		MOVEI	P3,CODHOM	;CODE WORD FOR HOME PAGES.
  1350	002356'	200740	765735		MOVE	P4,[XWD LPNHOM,LP2HOM]	;P4/ NO. 1ST PAGE,,2ND PAGE.
  1351	002357'	201140	000000*		MOVEI	PG,%HOM.P
  1352	002360'	324740	763370		PJRST	RDBOTH		;READ & VERIFY HOME PAGES.
  1353
  1354
  1355
  1356
  1357				COMMENT #
  1358				@@SUBROUTINE GETBAT
  1359				@@PURPOSE
  1360				SUBR TO TRY TO READ BOTH OF A UNIT'S BAT PAGES SUCCESSFULLY
  1361				INTO %BAT.
  1362				@@ENTRY
  1363				EXPECTS U/ UNIT DB AND F/ DDB.
  1364				PRINTS NO ERROR MESSAGES IF NOERH <> 0.
  1365				@@ACCUM
  1366				DESTROYS
  1367				@@EXIT
  1368				SKIP RETURNS IF AT LEAST ONE OF THE PAGES READ SUCCESSFULLY.
  1369				@@ #
  1370
  1371	002361'	260040	763363	GETBAT:	PUSHJ	P,SETBAT	;
  1372	002362'	324740	763370		PJRST	RDBOTH		;
  1373
  1374
  1375
  1376
  1377				COMMENT #
  1378				@@SUBROUTINE SETBAT
  1379				@@PURPOSE
  1380				LITTLE SUBR TO SET UP SOME PARAMETERS FOR HANDLING BAT PAGES.
  1381				@@ #
  1382
  1383	002363'	205640	424164	SETBAT:	MOVSI	P2,(SIXBIT .BAT.)
  1384	002364'	201700	000000*		MOVEI	P3,CODBAT
  1385	002365'	200740	765736		MOVE	P4,[XWD LPNBAT,LP2BAT]
  1386	002366'	201140	000000*		MOVEI	PG,%BAT.P	;
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 25-2
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1387	002367'	263040	000000		POPJ	P,
  1388
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 26
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1389				COMMENT #
  1390				@@SUBROUTINE RDBOTH
  1391				@@PURPOSE
  1392				SUBROUTINE TO READ SPECIAL REDUNDANT PAGES ON THE DISK (HOME
  1393				AND BAT) INTO CORE.
  1394				@@ENTRY
  1395				EXPECTS U/ UNIT DB, P2/ SIXBIT BAT, HOM, OR SAT, P3/ AP-
  1396				PROPRIATE CODE WORD FOR PAGES, P4/ PAGE NO. ON THE
  1397				DISK OF 1ST PAGE,, 2ND PAGE, AND PG/ PCB ADDRESS.
  1398				PRINTS NO ERROR MESSAGES IF NOERH <>0.
  1399				@@ACCUM
  1400				DESTROYS
  1401				@@CALLS
  1402				RDCHEK.
  1403				@@EXIT
  1404				NON-SKIP RETURNS ONLY IF BOTH PAGES ARE BAD.
  1405				T3/ 0 IF NO ERRORS, O'E LH(T3)<>0 IF ERROR ON 1ST PAGE AND
  1406				RH(T3)<>0 IF ERROR ON 2ND PAGE.
  1407				S=0 IF NO ERRORS, ELSE S HAS THE STANDARD RH ERROR BITS SET.
  1408				NOERH = 0 ON EXIT.
  1409				@@ #
  1410
  1411	002370'	200200	001604*	RDBOTH:	MOVE	F,DDSTAR	;F/ DDB.
  1412	002371'	402000	763515		SETZM	REDERR		;CLEAR ERR FLAG FOR BOTH PAGES.
  1413	002372'	476000	763516	FIROK:	SETOM	WHICH		;INDICATE READING 1ST PAGE.
  1414	002373'	554440	000017		HLRZ	T4,P4		;T4/ DISK PAGE NO.
  1415	002374'	260040	763407		PUSHJ	P,RDCHEK	;READ PAGE & CHECK FOR ERRORS.
  1416	002375'	254000	763377		  JRST	REDSEC		;ERR DETECTED - GO TRY 2ND PAGE.
  1417	002376'	327400	763404		JUMPG	T3,RDBSKP	;NO ERR. JUMP TO SUCCESS IF WE
  1418								;ARE HERE FROM A BAD 2ND PAGE.
  1419
  1420	002377'	402000	763516	REDSEC:	SETZM	WHICH		;INDICATE READING 2ND PAGE.
  1421	002400'	550440	000017		HRRZ	T4,P4		;T4/ DISK PAGE NUMBER.
  1422	002401'	260040	763407		PUSHJ	P,RDCHEK	;READ PAGE & CHECK FOR ERRORS.
  1423	002402'	321400	763405		  JUMPL	T3,RDBNON	;ERROR(S) DETECTED.  IF ON 1ST
  1424								;PAGE AS WELL, GIVES ERR RETURN.
  1425	002403'	327400	763372		JUMPG	T3,FIROK	;IF 2ND BAD 1ST OK GO RETRY 1ST.
  1426	002404'	350001	000000	RDBSKP:	AOS (P)			;SET FOR SKIP RETURN.
  1427	002405'	402000	763517	RDBNON:	SETZM NOERH		;CLR NO ERR MSG FLAG.
  1428	002406'	263040	000000		POPJ P,
  1429
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 27
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1430				COMMENT #
  1431				@@SUBROUTINE RDCHEK
  1432				@@PURPOSE
  1433				SUBR CALLED BY RDBOTH AND OTHERS TO READ A SPECIAL PAGE
  1434				INTO CORE AND CHECK FOR ERRORS.
  1435				@@ENTRY
  1436				EXPECTS  T4/ PAGE NO. ON UNIT, F/ FILE DB, PG/ PCB ADDRESS,
  1437				U/ UNIT DB, P2/ SIXBIT BAT, HOM, OR
  1438				SAT, AND P3/ CODE WORD FOR PAGES.
  1439				WHICH <>0 FOR FIRST PAGE, =0 FOR 2ND.
  1440				PRINTS NO ERROR MESSAGES IF NOERH <> 0.
  1441				@@CALLS
  1442				OPAGIN AND RDWMSG.
  1443				@@ACCUM
  1444				DESTROYS
  1445				@@EXIT
  1446				FOR 1ST PAGE, LH(T3)=0 UNLESS ERROR, IN WHICH CASE LH(T3)<>0.
  1447				FOR 2ND PAGE, RH(T3)=0 UNLESS ERROR, IN WHICH CASE RH(T3)<>0.
  1448				NON-SKIP RETURN IF ERROR, ELSE SKIP-RETURN.
  1449				IF NO ERROR, S=0 ELSE S HAS RH ERROR BITS SET.
  1450				@@ #
  1451
  1452	002407'	402000	763434	RDCHEK:	SETZM	CHKFLG		;CLR FLG FOR USE OF RDCHEK ONLY
  1453								;(NEEDED SINCE S ACCUMULATES.).
  1454	002410'	260040	763520		PUSHJ	P,OPAGIN	;READ THE PAGE.
  1455	002411'	334405	002346*		  SKIPA	T3,UNINAM(U)	;ERROR	- GET SIXBIT UNIT NAME.
  1456	002412'	254000	763416		JRST	CONCHK		;GO MAKE CONSISTANCY CHECKS.
  1457	002413'	201300	765737		MOVEI	T1,[ASCIZ . PAGE HARDWARE READ ERROR.]
  1458	002414'	260040	763465		PUSHJ	P,RDWMSG	;PRINT ERROR MSG. FOR PAGE TYPE.
  1459	002415'	476000	763434		SETOM	CHKFLG		;SAW ERROR ON THIS PAGE.
  1460	002416'	260040	000000*	CONCHK:	PUSHJ	P,GETPEV	;GET VIRTUAL ADDR FOR PCB IN PG IN T2
  1461	002417'	316640	765745		CAMN	P2,[SIXBIT /SAT/] ;READING SAT.SYS RIB PAGE?
  1462	002420'	312647	000000*		CAME	P2,RIBNAM(T2)	;YES. NAME IN RIB = 'SAT'?
  1463	002421'	316647	000000*		 CAMN	P2,PAGNAM(T2)	;NO - CHECK BLOCK NAME(THIS ALWAYS FAILS WITH RIB)
  1464	002422'	312707	000000*		CAME	P3,PAGCOD(T2)	;OK - CHECK CODE WORD
  1465	002423'	334405	002411*		 SKIPA	T3,UNINAM(U)	;NO CHECK - GET SIXBIT UNIT NAME
  1466	002424'	254000	763430		  JRST	TSTCHK		;EXIT CHECKING ERRORS ON THE WAY
  1467	002425'	201300	765746		MOVEI	T1,[ASCIZ . PAGE CONSISTENCY ERROR.]
  1468	002426'	260040	763465		PUSHJ	P,RDWMSG	;PRINT ERROR MSG. FOR PAGE TYPE
  1469	002427'	476000	763434		SETOM	CHKFLG		;SAW ERROR ON THIS PAGE.
  1470	002430'	200400	763515	TSTCHK:	MOVE	T3,REDERR	;ERR WRD FOR CHECKING BY CALLER.
  1471	002431'	336000	763434		SKIPN	CHKFLG		;SKIP RETURN IF
  1472	002432'	350001	000000		 AOS	(P)		;NO ERRORS.
  1473	002433'	263040	000000		POPJ	P,
  1474
  1475	002434'	000000	000000	CHKFLG: Z	;FLAG FOR USE BY RDCHEK ONLY.
  1476
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 28
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1477				COMMENT #
  1478				@@SUBROUTINE WTBOTH
  1479				@@PURPOSE
  1480				SUBR TO WRITE SPECIAL REDUNDANT PAGES TO THE DISK (HOM
  1481				AND BAT) FROM CORE.
  1482				@@ENTRY
  1483				EXPECTS F/ FILE DB, U/ UNIT DB, P4/ PAGE NO. ON
  1484				DISK OF 1ST PAGE,, 2ND PAGE, AND PG/ PCB ADDRESS.
  1485				PRINTS NO ERROR MESSAGES IF NOERH <> 0.
  1486				@@ACCUM
  1487				DESTROYS
  1488				@@CALLS
  1489				OPAGOT AND RDWMSG.
  1490				@@EXIT
  1491				RETURNS WITH S = 0 IF NO ERRORS. OTHERWISE S HAS STANDARD
  1492				RH ERROR BITS SET.
  1493				T3/ 0 IF NO ERRORS, OTHERWISE RH(T3)<>0 IF ERROR ON 2ND PAGE
  1494				AND LH(T3)<>0 IF ON 1ST PAGE.
  1495				@@ #
  1496
  1497	002435'	402000	763515	WTBOTH:	SETZM	REDERR		;CLR ERR SWITCH FOR BOTH PAGES.
  1498	002436'	476000	763516		SETOM	WHICH		;INDICATE WRITING 1ST PAGE.
  1499	002437'	260040	002416*		PUSHJ	P,GETPEV	;GET VIRTUAL ADDRESS OF DATA FROM C(PG)
  1500	002440'	200600	000007		MOVE	P1,T2		;GET IN MORE PERMANENT PLACE THAN T2
  1501
  1502	002441'	135300	002272*	WRTRN1:	LDB	T1,UNYLUN	;ALSO WORKS FOR ONES NOT IN STR
  1503	002442'	205340	002314*		MOVSI	T2,RBREAL	;
  1504	002443'	137300	000000*		DPB	T1,RBYUNI	;
  1505	002444'	554440	000017		HLRZ	T4,P4		;
  1506	002445'	137440	000145*		DPB	T4,RBYPNO	;
  1507	002446'	202354	000000*		MOVEM	T2,PAGSLF(P1)	;
  1508	002447'	517000	000017		HRLZS	P4		;SETUP P4 FOR PAGE #2.
  1509	002450'	260040	763456		PUSHJ	P,WTCHEK	;GO WRITE OUT PAGE.
  1510	002451'	402000	763516		SETZM	WHICH		;INDICATE WRITING 2ND PAGE.
  1511	002452'	326740	763441		JUMPN	P4,WRTRN1	;HAVE WE WRITTEN BOTH PAGES?
  1512	002453'	336400	763515		SKIPN	T3,REDERR	;ERR WRD FOR CHECKING BY CALLER.
  1513	002454'	350001	000000		 AOS	(P)		;SKIP RETURN IF NO ERRORS.
  1514	002455'	263040	000000		POPJ	P,		;
  1515
  1516	002456'	260040	763523	WTCHEK:	PUSHJ	P,OPAGOT	;TRY TO WRITE THE PAGE.
  1517	002457'	254000	763461		  JRST	.+2		;ERRORS.
  1518	002460'	263040	000000		POPJ	P,		;WON.
  1519	002461'	201300	765753		MOVEI	T1,[ASCIZ .HARDWARE WRITE ERROR.]
  1520	002462'	200405	002423*		MOVE	T3,UNINAM(U)	;PICK UP UNIT NAME AND PRINT
  1521	002463'	260040	763465		PUSHJ	P,RDWMSG	;ERROR MSG. FOR PAGE TYPE.
  1522	002464'	263040	000000		POPJ	P,
  1523
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 29
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1524				COMMENT #
  1525				@@SUBROUTINE RDWMSG
  1526				@@PURPOSE
  1527				SUBR TO PRINT ERROR MSG. FOR RDCHEK AND WTCHEK, AND TO SET
  1528				REDERR APPROPRIATELY.
  1529				(REDERR IS AN INTERNAL FLAG FOR RDBOTH AND WTBOTH.).
  1530				@@ENTRY
  1531				EXPECTS T1/ MSG. ADR. AND T3/ SIXBIT UNIT NAME.
  1532				IF NOERH <>0, DOES NOTHING AND RETURNS IMMEDIATELY.
  1533				@@ACCUM
  1534				DESTROYS
  1535				@@CALLS
  1536				SVOTAC, CLRSND, PRNAME, CONMES, AND CRLFOP.
  1537				@@EXIT
  1538				RETURNS LH. OR RH. OF REDERR = -1, DEPENDING ON WHETHER 1ST
  1539				OR 2ND PAGE, RESPECTIVELY, HAS ERROR.
  1540				@@ #
  1541
  1542	002465'	332000	763517	RDWMSG:	SKIPE	NOERH
  1543	002466'	263040	000000		 POPJ	P,		;DO NOT PRINT ERR MSG.
  1544	002467'	265340	763706		JSP	T2,SVOTAC	;SAVE T3,F,U & J
  1545	002470'	261040	000003		PUSH	P,PG		;SAVE PG.
  1546	002471'	261040	000006		PUSH	P,T1		;SAVE ADDR OF MESSAGE
  1547	002472'	260040	002331*		PUSHJ	P,CLRSND
  1548	002473'	200340	000010		MOVE	T2,T3		;SIXBIT UNIT NAME
  1549	002474'	260040	002343*		PUSHJ	P,PRNAME	;PUT NAME IN BUFFER
  1550	002475'	201300	765760		MOVEI	T1,[ASCIZ . FIRST .] ;PRESUME ERROR ON 1ST PAGE.
  1551	002476'	332000	763516		SKIPE	WHICH		;2ND. PAGE WAS READ?
  1552	002477'	254000	763502		 JRST	FSTERR		;NO - 1ST. PAGE.
  1553	002500'	523000	763515		HLLOS	REDERR		;INDICATE ERROR ON 2ND. PAGE.
  1554	002501'	334300	765764		SKIPA	T1,[[ASCIZ . SECOND .]]
  1555	002502'	563000	763515	FSTERR:	 HRROS	REDERR		;INDICATE ERROR ON 1ST. PAGE.
  1556	002503'	260040	002246*		PUSHJ	P,CONMES	;PUT MSG. IN BUFFER
  1557	002504'	200340	000015		MOVE	T2,P2		;GET SIXBIT PAGE TYPE(HOME OR "BAT")
  1558	002505'	316640	765745		CAMN	P2,[SIXBIT .SAT.] ;IF THIS WAS A RIB PAGE
  1559	002506'	541340	625142		 HRRI	T2,(SIXBIT .RIB.) ; TYPE "SATRIB"
  1560	002507'	260040	002474*		PUSHJ	P,PRNAME	;PUT IT IN BUFFER
  1561	002510'	262040	000006		POP	P,T1		;ADDR OF MESSAGE
  1562	002511'	260040	002503*		PUSHJ	P,CONMES	;PUT MSG. IN BUFFER
  1563	002512'	260040	763646		PUSHJ	P,CRLFOP	;CRLF AND TYPE MESSAGE
  1564	002513'	262040	000003		POP	P,PG		;RESTORE PG.
  1565	002514'	263040	000000		POPJ	P,
  1566
  1567	002515'	000000	000000	REDERR:	0			;ERR WORD FOR RDBOTH AND WTBOTH.
  1568								; RH=-1 IF ERROR ON 2ND. PAGE,
  1569								; LH "  "    "   "  1ST.   "
  1570	002516'	000000	000000	WHICH:	0			;FLAG TO INDICATE WHETHER 2ND
  1571								;OR 1ST PAGE BEING READ.
  1572
  1573	002517'	000000	000000	NOERH:	0			;FLAG TO NOT PRINT ERROR FROM UPDHOM.
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 30
ONCDSK.MAC	 4-DEC-87 15:51		FILMAN

  1574				COMMENT #
  1575				@@SUBROUTINE OPAGIN/OPAGOT
  1576				@@PURPOSE
  1577				ONCE-TIME SUBR TO READ OR WRITE A PAGE.
  1578				@@ENTRY
  1579				ENTRY POINT OPAGOT IS TO WRITE A PAGE, ENTRY POINT OPAGIN IS TO
  1580				READ A PAGE.
  1581				EXPECTS U/ UNIT DB, T4/ PAGE NUMBER ON THE UNIT,
  1582				PG/ ONCE-TIME PCB ADDRESS, AND F/ DDB.
  1583				@@ACCUM
  1584				DESTROYS T1-T4 AND S.
  1585				@@EXIT
  1586				SKIP RETURNS IF NO ERRORS, ELSE NON-SKIP RETURNS AND T3 HAS
  1587				THE PGYERR BITS.
  1588				@@ #
  1589
  1590				    ;HERE TO READ A PAGE.
  1591	002520'	201400	000000*	OPAGIN:	MOVEI	T3,PAGIN	;FILIO SUBR TO CALL.
  1592	002521'	201300	000000*		MOVEI	T1,STDREA
  1593	002522'	254000	763525		JRST	OPAGIO
  1594
  1595				    ;HERE TO WRITE A PAGE.
  1596	002523'	201400	000000*	OPAGOT:	MOVEI	T3,PAGOUT	;FILIO SUBR TO CALL.
  1597	002524'	201300	000000*		MOVEI	T1,STDWRT
  1598
  1599	002525'	261040	000003	OPAGIO:	PUSH	P,PG		;SAVE PG.
  1600	002526'	200340	000003		MOVE	T2,PG		;SET UP T2/ PCB ADDR AND
  1601	002527'	137300	000000*		DPB	T1,PCISTS	;SET FLAG FOR INTRPT LEVEL.
  1602	002530'	554147	000000*		HLRZ	PG,PCBPAG(T2)	;PG/ IN-CORE PAGE NUMBER.
  1603	002531'	400300	000000		SETZ	T1,		;CLEAR ANY
  1604	002532'	137300	000000*		DPB	T1,PGYERR	;ERROR BITS.
  1605	002533'	260040	000000*		PUSHJ	P,OHTINI	;CLEAR OUT ALL OUTPUT ERRORS (SHOULD BE 1 AT THE MOST.)
  1606	002534'	137440	000000*		DPB	T4,PGYPNO	;SET THE "UNIT NUMBER" AND
  1607	002535'	135300	002441*		LDB	T1,UNYLUN	;PAGE NUMBER IN PGYADR.
  1608	002536'	312246	002114*		CAME	U,UNTTBL(T1)	;STRANGE CROCK TO
  1609	002537'	202246	002536*		MOVEM	U,UNTTBL(T1)	;HELP SWPENQ AND FINPCB, WHICH
  1610	002540'	137300	000000*		DPB	T1,PGYUNI	;EXPECT UNTTBL TO BE SET UP.
  1611	002541'	261040	000007		PUSH	P,T2		;SAVE PCB ADDR.
  1612	002542'	260050	000000		PUSHJ	P,(T3)		;CALL PAGIN OR PAGOUT.
  1613	002543'	262040	000007		POP	P,T2		;RESTORE PCB ADDRESS.
  1614	002544'	135400	002527*		LDB	T3,PCISTS	;WAIT FOR
  1615	002545'	602400	000000*		TRNE	T3,STDWRT!STDREA ;THE INTRPT ON COMPLETION TO
  1616	002546'	254000	763544		 JRST	.-2		;HAPPEN.
  1617	002547'	135400	002532*		LDB	T3,PGYERR	;GET ERRORS.
  1618	002550'	262040	000003		POP	P,PG		;RESTORE PG/ PCB ADDR.
  1619	002551'	336000	000000*		SKIPN	OHTNUM		;SKIP IF GOT AN OUTPUT ERROR.
  1620	002552'	322400	002257*		 JUMPE	T3,CPOPJ1	;SKIP RETURN IF NO ERRORS
  1621	002553'	263040	000000		POPJ	P,		;
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 31
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1622				SUBTTL	CHECK ON DISK CAPACITY
  1623
  1624				DEFINE DSKOFF <WRPI DSKPIF##>
  1625				DEFINE DSKON  <WRPI DSKPIN##>
  1626
  1627				IFCPU(<KI,KL>),<
  1628	002554'	000000	765765	CPYMSG:	[ASCIZ	/IBM 3330-1/]	  ;0 3330-1  (100 MEGABYTE) IBM DISK ON SA10
  1629	002555'	000000	765770		[ASCIZ	/3330-II or 3675/];1 3330-11 (200 MEGABYTE) IBM DISK ON SA10
  1630	002556'	000000	765774		[ASCIZ	/3650 or 3652/]	  ;2 3650/52 (300 MEGABYTE) Memorex disk on SA10
  1631	002557'	000000	765777		[ASCIZ	/IBM compatible/] ;3 reserved for other IBM disk on SA10
  1632	002560'	777777	777777	CPYFLG:	-1			;Output geometry message first time thru
  1633				>  ;End IFCPU(<KI,KL>)
  1634
  1635	002561'	550105	001667*	DSKCPY:	HRRZ	J,UNIKON(U)	;Point to kontroller for this unit
  1636	002562'	700600	000000*		DSKOFF
  1637	002563'	332005	000000*		SKIPE	UNISTS(U)	;Unit must be idle before setting CWCOD
  1638					 JRST	[DSKON
  1639	002564'	254000	766002			 POPJ	P,]	;Should never get here
  1640	002565'	201300	000000*		MOVEI	T1,CWCOD	;Set unit to capacity-test wait
  1641	002566'	202305	002563*		MOVEM	T1,UNISTS(U)
  1642	002567'	700600	000000*		DSKON			;Turn on disk interrupts
  1643	002570'	260040	000000*		PUSHJ	P,IOSEL		;Start it going
  1644	002571'	205300	000100		MOVSI	T1,100		;Approx 16 seconds
  1645	002572'	332005	002566*	CPYWAT:	SKIPE	UNISTS(U)	;Done yet?
  1646	002573'	367300	763572		 SOJG	T1,CPYWAT	;Wait for unit to be idle
  1647
  1648				IFCPU(<KI,KL>),<;Output what type of disk was found
  1649	002574'	337005	002132*		SKIPG	UNIONC(U)	;Is it on-line?
  1650	002575'	263040	000000		 POPJ	P,		;No
  1651	002576'	135340	000000*		LDB	T2,UNYKTP##	;Get type of kontroller
  1652	002577'	306340	000004		CAIN	T2,4		;Is it "BP"?
  1653	002600'	352000	763560		AOSE	CPYFLG		;Yes, has message been output yet?
  1654	002601'	263040	000000		 POPJ	P,		;Don't mention it
  1655	002602'	135300	000000*		LDB	T1,UNYUTP##	;Get unit type
  1656	002603'	200306	763554		MOVE	T1,CPYMSG(T1)	;Description
  1657	002604'	260040	002511*		PUSHJ	P,CONMES
  1658	002605'	201300	766004		MOVEI	T1,[ASCIZ / unknown format/]
  1659	002606'	135340	000000*		LDB	T2,UNYBPR##	;Get blocks per record
  1660	002607'	306340	000001		CAIN	T2,1		;Does each record = 1 block?
  1661	002610'	201300	766010		 MOVEI	T1,[ASCIZ / formatted in blocks/]
  1662	002611'	306340	000004		CAIN	T2,4		;Does each record = 4 blocks?
  1663	002612'	201300	766015		 MOVEI	T1,[ASCIZ / formatted in pages/]
  1664	002613'	322300	001546*		JUMPE	T1,CPOPJ	;No message if unit is off-line
  1665	002614'	260040	763645		PUSHJ	P,CONOUT	;How formatted
  1666				>  ;End IFCPU(KI,KL)
  1667	002615'	263040	000000		POPJ	P,		;End of DSKCPY
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 32
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1668				;SUBROUTINE TO EXECUTE AN INSTRUCTION FOR ALL UNITS WITHIN A STR.
  1669				; USUALLY STORES A BYTE
  1670				;T1=INSTRUCTION TO BE EXECUTED, P1=ARG., P2=STR DATA BLOCK ADR.
  1671
  1672	002616'	554255	002173*	STOUNI:	HLRZ	U,STRUNI(P2)
  1673	002617'	261040	000006		PUSH	P,T1
  1674	002620'	256001	000000	STOUN1:	XCT	(P)		;EXECUTE INSTRUCTION SUPPLIED IN AC T1
  1675	002621'	554245	002214*		HLRZ	U,UNISTR(U)
  1676	002622'	326240	763620		JUMPN	U,STOUN1
  1677	002623'	254000	000000*		JRST	TPOPJ
  1678
  1679
  1680
  1681
  1682	002624'	265340	763706	DECLOP:	JSP	T2,SVOTAC	;Output string in T1 then number in P1
  1683	002625'	260040	763633		PUSHJ	P,TYPDEC
  1684	002626'	324740	763646		PJRST	CRLFOP
  1685
  1686	002627'	265340	763706	TYPMSN:	JSP	T2,SVOTAC	;SAVE P4,F,U & J
  1687	002630'	260040	002472*		PUSHJ P,CLRSND
  1688	002631'	260040	763633		PUSHJ	P,TYPDEC	;PUT MSG. IN THE BUFFER FOLLOWED BY DECIMAL #
  1689	002632'	324740	002333*		PJRST	OPOUT		;O/P THE BUFFER
  1690
  1691	002633'	260040	002604*	TYPDEC:	PUSHJ	P,CONMES	;Output message in T1
  1692	002634'	200300	000014		MOVE	T1,P1		;Then number in P1
  1693	002635'	324740	000000*		PJRST	RADX10
  1694
  1695
  1696
  1697
  1698	002636'	334355	002342*	SPSNAM:	SKIPA	T2,STRNAM(P2)
  1699	002637'	200345	002462*	SPUNAM:	MOVE	T2,UNINAM(U)
  1700	002640'	324740	002507*		PJRST PRNAME
  1701
  1702	002641'	476000	763227	SVMOT2:	SETOM ERRHM2
  1703	002642'	476000	763226	SVMOTE:	SETOM	ERRHOM
  1704	002643'	260040	002630*		PUSHJ P,CLRSND
  1705	002644'	265340	763706	SVMOUT:	JSP	T2,SVOTAC
  1706	002645'	260040	002633*	CONOUT:	PUSHJ	P,CONMES
  1707	002646'	260040	000000*	CRLFOP:	PUSHJ	P,CRLF
  1708	002647'	324740	002632*		PJRST	OPOUT
  1709
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 33
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1710	002650'	265340	763706	ASKQUE:	JSP	T2,SVOTAC	;SAVE P4,F,U & J
  1711	002651'	324740	000303*		PJRST	YESNO		;GET USER'S RESPONSE - SKIP RETURN IF 1ST.
  1712								;T3="Y" NON SKIP RETURN IF ANYTHING ELSE TYPED
  1713
  1714
  1715
  1716				;T2 & T3 ARE RESPECTED
  1717
  1718	002652'	205300	000167*	SETCHG:	MOVSI	T1,UNPCHG	;PREPARE TO FLAG HOME PAGES NEED REWRITING
  1719	002653'	205440	000000*		MOVSI	T4,UNPOFL!UNPHWP
  1720	002654'	616445	002300*		TDNN	T4,UNIDES(U)	;IS UNIT WRITE PROTECTED OR OFF-LINE?
  1721	002655'	436305	002654*		IORM	T1,UNIDES(U)	;SET UNPCHG FLAG
  1722	002656'	263040	000000		POPJ	P,		;RETURN
  1723
  1724
  1725
  1726				;SUBR TO MARK A UNIT AS A PRIVATE/PUBLIC PACK.
  1727	002657'	205400	001613*	SETPUB:	MOVSI	T3,UNPPRV	;
  1728	002660'	412405	002655*		ANDCAM	T3,UNIDES(U)	;
  1729	002661'	263040	000000		POPJ	P,		;
  1730
  1731	002662'	205400	002657*	SETPRV:	MOVSI	T3,UNPPRV	;
  1732	002663'	436405	002660*		IORM	T3,UNIDES(U)	;
  1733	002664'	263040	000000		POPJ	P,		;
  1734	
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 34
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1735				;Get name of physical unit
  1736	002665'	260040	002252*	GETUNI:	PUSHJ	P,GETLIN	;GET USER'S RESPONSE
  1737	002666'	263040	000000		  POPJ	P,		;JUST CR TYPED - NON SKIP RETURN
  1738	002667'	260040	000212*		PUSHJ	P,CTEXT		;GET SIXBIT UNIT NAME
  1739	002670'	402000	000005		SETZM	U		;ASSUME "ALL" WAS TYPED
  1740	002671'	554300	000007		HLRZ	T1,T2		;MAKE AC LOOK GOOD FOR COMPARE
  1741	002672'	260040	763677		PUSHJ	P,FNDUNI	;SEE IF UNIT EXISTS & RETURN WITH UNIT DATA BLOCK
  1742	002673'	334300	766027		  SKIPA	T1,[[ASCIZ .NOT A PHYSICAL UNIT-TRY AGAIN.]]
  1743	002674'	254000	002552*		 JRST	CPOPJ1		;UNIT EXISTS - SKIP RETURN
  1744	002675'	260040	763644		PUSHJ	P,SVMOUT	;ADD CRLF & O/P MSG.
  1745	002676'	254000	763665		JRST	GETUNI		;TRY AGAIN
  1746
  1747	002677'	554240	002102*	FNDUNI:	HLRZ	U,SYSUNI	;GET ADR. OF 1ST. UNIT DATA BLOCK IN SYSTEM
  1748	002700'	316345	002637*	FNDUN1:	CAMN	T2,UNINAM(U)	;MATCH?
  1749	002701'	254000	002674*		 JRST	CPOPJ1		;YES - SKIP RETURN
  1750	002702'	554245	002115*		HLRZ	U,UNISYS(U)	;GET NEXT UNIT DATA BLOCK ADR. IN SYSTEM
  1751	002703'	326240	763700		JUMPN	U,FNDUN1	;REPEAT IF THERE IS ONE
  1752	002704'	263040	000000		POPJ	P,		;NONE FOUND - NON SKIP RETURN
  1753
  1754				;SUBROUTINE TO PRESERVE AC'S P4,F,U & J
  1755
  1756	002705'	563015	002324*	REFSAV:	HRROS	STRREF(P2)	;INDICATE STR NEEDS REFRESHING
  1757	002706'	261040	000017	SVOTAC:	PUSH	P,P4
  1758	002707'	261040	000010		PUSH	P,T3
  1759	002710'	261040	000004		PUSH	P,F
  1760	002711'	261040	000005		PUSH	P,U
  1761	002712'	261040	000002		PUSH	P,J
  1762	002713'	260047	000000		PUSHJ	P,(T2)
  1763	002714'	304000	000000		  CAIA
  1764	002715'	350001	777773		AOS	-5(P)
  1765	002716'	262040	000002		POP	P,J
  1766	002717'	262040	000005		POP	P,U
  1767	002720'	262040	000004		POP	P,F
  1768	002721'	262040	000010		POP	P,T3
  1769	002722'	262040	000017		POP	P,P4
  1770	002723'	263040	000000		POPJ	P,
  1771
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 35
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1772				COMMENT #
  1773				@@SUBROUTINE REDBAT
  1774				@@PURPOSE
  1775				SUBR TO READ AND VERIFY THE BAT PAGES ON ALL UNITS IN THE SYSTEM.
  1776				@@ENTRY
  1777				EXPECTS
  1778				@@CALLS
  1779				CHKBAT AND SCNBAT.
  1780				@@ACCUM
  1781				DESTROYS
  1782				@@ #
  1783
  1784	002724'	554240	002677*	REDBAT:	HLRZ	U,SYSUNI	;GET ADR. OF 1ST UNIT DB IN THE SYSTEM.
  1785	002725'	205740	001677*		MOVSI	P4,UNPOFL
  1786	002726'	612745	002663*	RDBAT1:	TDNE	P4,UNIDES(U)	;UNIT OFF-LINE?
  1787	002727'	254000	763732		JRST	RDBAT6		;YES, GO READ NEXT BAT PAGE
  1788	002730'	260040	763735		PUSHJ	P,CHKBAT	;NO - GO CHECK "BAT" PAGES FOR THIS UNIT
  1789	002731'	255000	000000		  JFCL			;IGNORE ERRORS
  1790	002732'	554245	002702*	RDBAT6:	HLRZ	U,UNISYS(U)	;GET ADR. OF NEXT UNIT DATA PAGE IN SYSTEM
  1791	002733'	326240	763726		JUMPN	U,RDBAT1	;REPEAT IF THERE IS ONE
  1792	002734'	263040	000000		POPJ	P,		;NONE LEFT - EXIT
  1793
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 36
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1794				COMMENT #
  1795				@@SUBROUTINE CHKBAT/BATREF
  1796				@@PURPOSE
  1797				SUBR TO READ THE BAT PAGES AND ALLOW THE USER TO REINITIALIZE
  1798				THEM IF THEY ARE BAD.
  1799				@@ENTRY
  1800				THE ENTRY POINT CHKBAT READS THE BAT PAGES AND IF ERRORS ARE
  1801				FOUND, ASKS THE USER IF HE/SHE WISHES TO REINITIALIZE THE BAT
  1802				PAGES.  IF YES, IT FALLS INTO BATREF, WHICH DOES.
  1803				EXPECTS U/ UNIT DB AND F/ DDB.
  1804				@@ACCUM
  1805				DESTROYS
  1806				@@CALLS
  1807				SVOTAC, GETBAT, ASKQUE, CORZER, SETBAT, AND WTBOTH.
  1808				@@EXIT
  1809
  1810				@@ #
  1811
  1812	002735'	265340	763706	CHKBAT:	JSP	T2,SVOTAC	;SAVE P4,F,U & J.
  1813	002736'	402000	763770		SETZM	BATBAD		;CLEAR BAT PAGE BAD FLAG.
  1814	002737'	260040	763361		PUSHJ	P,GETBAT	;READ BOTH BAT PAGES & VERIFY THEM.
  1815	002740'	255000	000000		  JFCL			;ERROR(S)
  1816	002741'	336300	763515		SKIPN	T1,REDERR	;ANY ERRORS FOUND AT ALL IN EITHER BAT PAGE?
  1817	002742'	324740	763435		 PJRST	WTBOTH		;No, rewrite UNI field of self pointer
  1818	002743'	202300	763770		MOVEM	T1,BATBAD	;YES. BAD BAT PAGE.
  1819	002744'	332000	763771		SKIPE	BATMAN		;DO NOT GET TO REFRESH IF FORCED
  1820	002745'	263040	000000		 POPJ	P,		; (I.E. FROM FILMAN).
  1821					MOVEI	T1,[ASCIZ .
  1822				Do you want to initialize the BAT pages on this UNIT?
  1823	002746'	201300	766030	.]
  1824	002747'	205340	001713*		MOVSI	T2,UNPHWP
  1825	002750'	616345	002726*		TDNN	T2,UNIDES(U)	;DON'T INITIALIZE IF UNIT HARDWARE WRITE-PROTECT
  1826	002751'	260040	763650		 PUSHJ	P,ASKQUE	;TYPE QUESTION & GET USER'S RESPONSE
  1827	002752'	263040	000000		  POPJ	P,		;HE DOESN'T WANT TO
  1828					MOVEI	T1,[ASCIZ .
  1829				THIS is not normally done, are you SURE?
  1830	002753'	201300	766044	.]
  1831	002754'	260040	763650		PUSHJ	P,ASKQUE	;ASK AGAIN
  1832	002755'	263040	000000		  POPJ	P,		;HE SAVED HIMSELF SOME BOTHER
  1833	002756'	200400	000014		MOVE T3,P1		;GET CORE PNTR IN CORRECT AC.
  1834
  1835	002757'	201300	747000	BATREF:	MOVEI	T1,%BAT
  1836	002760'	260040	001721*		PUSHJ	P,CORZER	;
  1837	002761'	260040	763363		PUSHJ	P,SETBAT	;
  1838	002762'	202640	747000*		MOVEM	P2,%BAT+PAGNAM	;PUT SIXBIT 'BAT' IN THE PAGE.
  1839	002763'	205300	000000*		MOVSI	T1,-BRMAX	;SETUP AOBJN PTR. TO BE STORED IN PAGE
  1840	002764'	541300	000000*		HRRI	T1,BATREG
  1841	002765'	202300	747000*		MOVEM	T1,%BAT+BATFIR ;SAVE IT IN THE PAGE
  1842	002766'	202700	747000*		MOVEM	P3,%BAT+PAGCOD ;SAVE THE CODE FOR BAT PAGES IN THE PAGE
  1843	002767'	324740	763435		PJRST	WTBOTH		;
  1844
  1845	002770'	000000	000000	BATBAD:	0			;0 INDICATES VIRGIN BAT PAGES(INITIALIZED)
  1846								; LH = -1 INDICATES ERROR(S) DETECTED WHILE READING
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 36-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1847								; RH = # BAD REGIONS ON UNIT
  1848	002771'	000000	000000	BATMAN:	0			;0=OPTIONAL, -1=MANDATORY
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 37
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1849				;SUBROUTINE TO TYPE SIXBIT UNIT NAME FOLLOWED BY (ID)
  1850				; ENTER WITH U = UNIT DATA BLOCK ADR.
  1851
  1852	002772'	201600	766055	TYPUNI:	MOVEI	P1,[ASCIZ .,.]
  1853	002773'	200300	000014	TYPUN1:	MOVE	T1,P1		;GET MSG. ADR. INTO KOSHER AC
  1854	002774'	260040	002645*		PUSHJ	P,CONMES	;PUT "," OR MSG. IN BUFFER
  1855	002775'	322240	002647*		JUMPE	U,OPOUT	;JUST O/P MSG.
  1856	002776'	260040	763637		PUSHJ	P,SPUNAM	;PUT SIXBIT UNIT NAME IN BUFFER
  1857	002777'	201300	766056		MOVEI	T1,[ASCIZ .(.]
  1858	003000'	260040	002774*		PUSHJ	P,CONMES	;PUT "(" IN BUFFER
  1859	003001'	332345	002270*		SKIPE	T2,UNIHID(U)	;GET SIXBIT UNIT ID - IF ANY
  1860	003002'	260040	002640*		PUSHJ	P,PRNAME	;PUT IT IN THE BUFFER
  1861	003003'	201300	766057		MOVEI	T1,[ASCIZ .).]
  1862	003004'	260040	003000*		PUSHJ	P,CONMES	;PUT ")" IN THE BUFFER
  1863	003005'	324740	002775*		PJRST	OPOUT		;O/P BUFFER
  1864
  1865				;SUBROUTINE TO TYPE STR NAME IN "SYS" SEARCH LIST.
  1866
  1867				TYPSYS:	MOVEI	T1,[ASCIZ .
  1868	003006'	201300	766060	STR IN "SYS" SEARCH LIST:.]
  1869	003007'	260040	763645		PUSHJ	P,CONOUT
  1870	003010'	260040	763636		PUSHJ	P,SPSNAM	;PUT SIXBIT STR NAME IN BUFFER
  1871	003011'	324740	003005*		PJRST	OPOUT		;O/P BUFFER & EXIT
  1872	003012'	324740	763646	TYPSR1:	PJRST	CRLFOP		;O/P CRLF
  1873
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 38
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1874				;SUBROUTINE TO TYPE ALL UNITS IN SYSTEM THAT ARE NOT IN ANY STR
  1875				; RETURN WITH P1,P4,F,U & J DESTROYED
  1876
  1877				TYPUNS:	MOVEI	P1,[ASCIZ .
  1878				UNITS NOT IN A FILE STRUCTURE:
  1879	003013'	201600	766066	.]
  1880	003014'	554240	002724*		HLRZ	U,SYSUNI	;GET ADR. OF 1ST. UNIT DATA BLOCK IN SYSTEM
  1881	003015'	634740	000017		TDZA	P4,P4		;INDICATE UNIT ID TO BE TYPED IN TYPUNI
  1882	003016'	554245	002732*	TYPNS1:	HLRZ	U,UNISYS(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN SYSTEM
  1883	003017'	322240	002613*		JUMPE	U,CPOPJ		;EXIT IF NONE LEFT
  1884	003020'	332005	002266*		SKIPE	UNILOG(U)	;IS THIS UNIT IN A STR?
  1885	003021'	254000	764016		JRST	TYPNS1		;YES - CHECK NEXT UNIT
  1886	003022'	260040	763773		PUSHJ	P,TYPUN1	;NO - TYPE MSG., UNIT NAME & (ID)
  1887
  1888	003023'	554245	003016*	TYPNS2:	HLRZ	U,UNISYS(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN SYSTEM
  1889	003024'	322240	764012		JUMPE	U,TYPSR1	;O/P CRLF & EXIT IF NONE LEFT
  1890	003025'	336005	003020*		SKIPN	UNILOG(U)	;IS THIS UNIT IN A STR?
  1891	003026'	260040	763772		PUSHJ	P,TYPUNI	;YES - TYPE "," UNIT NAME & (ID)
  1892	003027'	254000	764023		JRST	TYPNS2		;REPEAT
  1893
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 39
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1894				;SUBROUTINE TO TYPE THE STR & ITS UNITS.
  1895				; RETURN WITH P1,P4,F,U & J DESTROYED
  1896
  1897	003030'	402000	000017	TYPSTR:	SETZM	P4		;INDICATE UNIT ID TO BE PRINTED IN TYPUNI
  1898	003031'	201640	002260*		MOVEI	P2,STRDDB	;ADR. OF STR DATA BLOCK.
  1899	003032'	336015	002636*		SKIPN	STRNAM(P2)	;ANY STR?
  1900	003033'	263040	000000		POPJ	P,		;NO.
  1901				    ;TYPE STR NAME & ALL ITS UNITS.
  1902
  1903	003034'	510355	002705*		HLLZ	T2,STRREF(P2)
  1904	003035'	322340	764040		JUMPE	T2,NOREF	;DOES STR NEED REFRESHING?
  1905	003036'	201300	766075		MOVEI	T1,[ASCIZ .NEEDS REFRESHING .]		;YES
  1906	003037'	260040	003004*		PUSHJ	P,CONMES	;PUT MSG IN BUFFER
  1907	003040'	260040	763636	NOREF:	PUSHJ	P,SPSNAM	;PUT SIXBIT STR NAME IN BUFFER
  1908	003041'	554255	002616*		HLRZ	U,STRUNI(P2)	;GET ADR. OF 1ST. UNIT IN STR
  1909	003042'	322240	763646		JUMPE	U,CRLFOP	;IF NO UNITS IN STR - O/P BUFFER WITH CRLF & EXIT
  1910	003043'	260040	003011*		PUSHJ	P,OPOUT	;O/P BUFFER
  1911	003044'	201600	766101		MOVEI	P1,[ASCIZ .:.]
  1912	003045'	260040	763773		PUSHJ	P,TYPUN1	;TYPE ":" UNIT NAME & (ID) [IST. TIME THRU]
  1913	003046'	554245	002621*	TYPST1:	HLRZ	U,UNISTR(U)	;GET NEXT UNIT DATA BLOCK IN STR
  1914	003047'	322240	764012		JUMPE	U,TYPSR1	;IF NO MORE UNITS - ADD CRLF & EXIT
  1915	003050'	260040	763772		PUSHJ	P,TYPUNI	;TYPE "," UNIT NAME & (ID)
  1916	003051'	254000	764046		JRST	TYPST1		;REPEAT UNTIL NO MORE UNITS IN STR
  1917
  1918	003052'	260040	764030	TYPALL:	PUSHJ P,TYPSTR
  1919	003053'	260040	764013		PUSHJ P,TYPUNS
  1920	003054'	260040	764006		PUSHJ P,TYPSYS
  1921	003055'	254000	761325		JRST FILCMD
  1922
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 40
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1923				;ROUTINE TO TYPE VALUE AND MESSAGE OR ASK FOR NEW
  1924				;VALUE USING MIN AND MAX
  1925				;ONLY TYPE IF TYPONL NON-0
  1926				;DBLSTD MAY HAVE 2 VALUES TO TRY WITHOUT ASKING
  1927				;VALUE IN P1, MSG IN T1, RESULT IN T2
  1928				;NON-SKIP RETURN IF UNCHANGED OR ONLY TYPING
  1929
  1930	003056'	335000	764140	ASKQMM:	SKIPGE TYPONL
  1931	003057'	254000	763624		 JRST DECLOP	;JUST TYPE IT
  1932	003060'	202300	764135		MOVEM T1,MSGSAV	;SAVE MESSAGE
  1933	003061'	202600	764137		MOVEM P1,VALSAV	;AND VALUE
  1934	003062'	200340	764142		MOVE T2,MIN
  1935	003063'	316340	764141		CAMN T2,MAX
  1936	003064'	254000	764114		JRST RETFIX	;ONLY ONE POSSIBLE VALUE
  1937	003065'	331000	764136	ASKRPT:	SKIPL DBLSTD
  1938	003066'	254000	764120		JRST QSTSTD	;TRY A STANDARD ANSWER
  1939	003067'	260040	764154		PUSHJ P,FTYUNI	;FORCED TYPE OF UNIT?
  1940	003070'	254000	764073		 JRST KNNUNI	;NO
  1941	003071'	200300	764135		MOVE T1,MSGSAV
  1942	003072'	200600	764137		MOVE P1,VALSAV	;MAKE SURE RESTORED
  1943	003073'	260040	763624	KNNUNI:	PUSHJ P,DECLOP	;TYPE VALUE AND MESSAGE
  1944	003074'	201300	766102		MOVEI T1,[ASCIZ /MIN = /]
  1945	003075'	200600	764142		MOVE P1,MIN
  1946	003076'	260040	763633		PUSHJ P,TYPDEC
  1947	003077'	201300	766104		MOVEI T1,[ASCIZ / MAX = /]
  1948	003100'	200600	764141		MOVE P1,MAX
  1949	003101'	260040	763624		PUSHJ P,DECLOP
  1950	003102'	260040	002665*		PUSHJ P,GETLIN
  1951	003103'	254000	764124		 JRST KEPSAM	;DOES NOT WANT IT CHANGED
  1952	003104'	260040	000000*		PUSHJ P,DECIN
  1953	003105'	255000	000000		 JFCL
  1954	003106'	254000	764132		 JRST ASKRP1	;ASK FOR IT AGAIN, WAS BAD
  1955	003107'	306400	000055		CAIN	T3,"-"	;IS HYPHEN TERMINATOR?
  1956	003110'	254000	764132		JRST	ASKRP1	;YES, NEGATIVE RESPONSE ILLEGAL
  1957	003111'	317340	764141	CHKANS:	CAMG T2,MAX
  1958	003112'	315340	764142		CAMGE T2,MIN
  1959	003113'	254000	764126		JRST ASKRPQ	;NOT IN RANGE
  1960	003114'	312340	764137	RETFIX:	CAME T2,VALSAV
  1961	003115'	350001	000000		AOS (P)
  1962	003116'	476000	764136		SETOM DBLSTD	;SO NOTHING THERE NEXT TIME
  1963	003117'	263040	000000		POPJ P,
  1964
  1965	003120'	554340	764136	QSTSTD:	HLRZ T2,DBLSTD	;GET FIRST TRY
  1966	003121'	306340	377777		CAIN T2,377777
  1967	003122'	200340	764141		MOVE T2,MAX	;FLAG FOR MAX
  1968	003123'	254000	764111		JRST CHKANS
  1969
  1970	003124'	200340	764137	KEPSAM:	MOVE T2,VALSAV
  1971	003125'	254000	764111		JRST CHKANS
  1972
  1973				ASKRPQ:	MOVEI T1,[ASCIZ /
  1974	003126'	201300	766106	VALUE NOT IN PERMITTED RANGE/]
  1975	003127'	335000	764136		SKIPGE DBLSTD	;NO ERROR IF STANDARD SETTING
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 40-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1976	003130'	260040	763645		PUSHJ P,CONOUT	;PUT OUT THE MESSAGE
  1977	003131'	527000	764136		HRLOS DBLSTD	;TRY SECOND STANDARD IF PRESENT
  1978	003132'	200300	764135	ASKRP1:	MOVE T1,MSGSAV
  1979	003133'	200600	764137		MOVE P1,VALSAV
  1980	003134'	254000	764065		JRST ASKRPT	;TRY AGAIN
  1981
  1982	003135'	000000	000000	MSGSAV:	0
  1983	003136'	000000	000000	DBLSTD:	0
  1984	003137'	000000	000000	VALSAV:	0
  1985	003140'	000000	000000	TYPONL:	0
  1986	003141'	000000	000000	MAX:	0
  1987	003142'	000000	000000	MIN:	0
  1988	003143'	000000	000000	KNOUNI:	0
  1989
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 41
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  1990				COMMENT #
  1991				@@SUBROUTINE MAYREF
  1992				@@PURPOSE
  1993				SUBR TO TYPE WARNING THAT A CHANGE WILL CAUSE REFRESH.
  1994				@@ #
  1995
  1996	003144'	331000	764140	MAYREF:	SKIPL TYPONL
  1997	003145'	331000	764136		SKIPL DBLSTD
  1998	003146'	263040	000000		 POPJ P,		;ONLY TYPING, OR DOING STANDARD
  1999	003147'	322640	003017*		JUMPE P2,CPOPJ	;NO STR
  2000	003150'	510315	003034*		HLLZ T1,STRREF(P2)
  2001	003151'	326300	003147*		JUMPN T1,CPOPJ	;ALREADY SET FOR REFRESH
  2002					MOVEI T1,[ASCIZ /
  2003	003152'	201300	766115	CHANGE WILL CAUSE STR TO NEED REFRESHING/]
  2004	003153'	324740	763645		PJRST CONOUT
  2005
  2006
  2007
  2008
  2009				COMMENT #
  2010				@@SUBROUTINE FTYUNI
  2011				@@PURPOSE
  2012				LITTLE SUBR TO POSSIBLY TYPE A UNIT NAME.
  2013				@@ #
  2014
  2015	003154'	332000	764143	FTYUNI:	SKIPE KNOUNI	;KNOW WHAT UNIT?
  2016	003155'	263040	000000		 POPJ P,		;YES
  2017	003156'	260040	763637		PUSHJ P,SPUNAM
  2018	003157'	350001	000000		AOS (P)
  2019	003160'	476000	764143		SETOM KNOUNI
  2020	003161'	324740	763646		PJRST CRLFOP
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 42
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2021				COMMENT #
  2022				@@SUBROUTINE SPUCLC
  2023				@@PURPOSE
  2024				SUBR TO CALC THE NUMBER OF SATS FOR A UNIT, GIVEN THE NO. OF
  2025				PAGES ON THE UNIT.
  2026				@@ENTRY
  2027				EXPECTS U/ UNIT DB.
  2028				@@ACCUM
  2029				DESTROYS T2 AND T3.
  2030				@@EXIT
  2031				SETS UNYSPU.
  2032				@@ #
  2033
  2034	003162'	200345	002316*	SPUCLC:	MOVE	T2,UNIPPU(U)	;T2/ NO. OF PAGES ON THE UNIT.
  2035	003163'	275340	000001		SUBI	T2,1		;
  2036	003164'	231340	022000		IDIVI	T2,400*^D36	;DIVIDE BY NO. PAGES PER SAT.
  2037	003165'	271340	000001		ADDI	T2,1		;
  2038	003166'	137340	002274*		DPB	T2,UNYSPU	;SET ANSWER.
  2039	003167'	263040	000000		POPJ	P,
  2040
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 43
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2041				COMMENT #
  2042				@@SUBROUTINE UNITST
  2043				@@PURPOSE
  2044				SUBR TO CALC AND STORE THE NO. OF SATS ON A UNIT.  MAY FLAG
  2045				HOME PAGES NEED REWRITING.
  2046				@@ENTRY
  2047				EXPECTS U/ UNIT DB.
  2048				JUST RETURNS IF TYPONL IS < 0.
  2049				@@CALLS
  2050				SPUCLC AND SETCHG.
  2051				@@EXIT
  2052				STORES RESULT IN UNYSPU.
  2053				@@ #
  2054
  2055	003170'	335000	764140	UNITST:	SKIPGE	TYPONL
  2056	003171'	263040	000000		POPJ	P,
  2057	003172'	135400	003166*		LDB	T3,UNYSPU
  2058	003173'	260040	764162		PUSHJ	P,SPUCLC
  2059	003174'	312400	000007		CAME	T3,T2
  2060	003175'	324740	763652		PJRST	SETCHG
  2061	003176'	263040	000000		POPJ	P,
  2062
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 44
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2063				COMMENT #
  2064				@@SUBROUTINE UNITID
  2065				@@PURPOSE
  2066				SUBR TO SET THE UNIT ID.
  2067				@@ #
  2068
  2069	003177'	260040	764154	UNITID:	PUSHJ	P,FTYUNI
  2070	003200'	255000	000000		JFCL
  2071					MOVEI	T1,[ASCIZ /
  2072	003201'	201300	766126	UNIT ID IS /]
  2073	003202'	336605	003001*		SKIPN	P1,UNIHID(U)
  2074					MOVEI	T1,[ASCIZ /
  2075	003203'	201300	766131	ZERO UNIT ID - NEW ID NEEDED/]
  2076	003204'	260040	003037*		PUSHJ	P,CONMES
  2077	003205'	332340	000014		SKIPE	T2,P1		;PRINT IF NON-ZERO.
  2078	003206'	260040	003002*		PUSHJ	P,PRNAME
  2079	003207'	260040	763646		PUSHJ	P,CRLFOP
  2080	003210'	335000	764140		SKIPGE	TYPONL
  2081	003211'	263040	000000		POPJ	P,		;DONE IF ONLY PRINTING.
  2082	003212'	260040	003102*		PUSHJ	P,GETLIN
  2083	003213'	334345	003202*		  SKIPA	T2,UNIHID(U)	;NO CHANGE, GET BACK OLD.
  2084	003214'	260040	002667*		PUSHJ	P,CTEXT	;READ
  2085	003215'	322340	764177		JUMPE	T2,UNITID	;STILL 0, TRY AGAIN.
  2086	003216'	250345	003213*		EXCH	T2,UNIHID(U)
  2087	003217'	312345	003216*		CAME	T2,UNIHID(U)
  2088	003220'	324740	763652		PJRST	SETCHG		;CHANGED.
  2089	003221'	263040	000000		POPJ	P,		;NOT CHANGED
  2090
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 45
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2091				COMMENT #
  2092				@@SUBROUTINE STRTCH
  2093				@@PURPOSE
  2094				SUBR TO ALLOW THE REDEFINITION OF THE SIZE OF CRASH.SAV.
  2095				@@ #
  2096
  2097	003222'	402000	764142	STRTCH:	SETZM	MIN
  2098	003223'	200300	766140		MOVE	T1,[^D8192+2]	;(2**22)/512. (allow for EXE directory pages)
  2099	003224'	202300	764141		MOVEM	T1,MAX
  2100	003225'	260040	764144		PUSHJ	P,MAYREF
  2101	003226'	550615	002307*		HRRZ	P1,STRP4C(P2)
  2102	003227'	201300	766141		MOVEI	T1,[ASCIZ /PAGES FOR CRASH.SAV = /]
  2103	003230'	260040	764056		PUSHJ	P,ASKQMM
  2104	003231'	263040	000000		  POPJ	P,
  2105	003232'	542355	003226*		HRRM	T2,STRP4C(P2)
  2106	003233'	563015	003150*		HRROS	STRREF(P2)
  2107	003234'	200300	766146	CHGSTR:	MOVE	T1,[PUSHJ P,SETCHG]
  2108	003235'	324740	763616		PJRST	STOUNI
  2109
  2110
  2111
  2112				COMMENT #
  2113				@@SUBROUTINE
  2114				@@PURPOSE
  2115				SUBR TO ALLOW THE REDEFINITION OF THE NO. OF PAGES OF
  2116				OVERDRAW PER USER.
  2117				@@ #
  2118
  2119	003236'	402000	764142	STRTOV:	SETZM	MIN
  2120	003237'	200315	002320*		MOVE	T1,STRPPU(P2)
  2121	003240'	202300	764141		MOVEM	T1,MAX
  2122	003241'	201300	766147		MOVEI	T1,[ASCIZ /# OF PAGES ALLOWED FOR OVERDRAW PER USER = /]
  2123	003242'	214615	002322*		MOVM	P1,STROVR(P2)
  2124	003243'	260040	764056		PUSHJ	P,ASKQMM
  2125	003244'	263040	000000		POPJ	P,
  2126	003245'	212355	003242*		MOVNM	T2,STROVR(P2)
  2127	003246'	324740	764234		PJRST	CHGSTR
  2128
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 46
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2129				COMMENT #
  2130				@@SUBROUTINE STSDEF
  2131				@@PURPOSE
  2132				SUBR TO DEFINE A STR.
  2133				@@ENTRY
  2134				EXPECTS
  2135				@@ACCUM
  2136				DESTROYS
  2137				@@CALLS
  2138				CONOUT, GETLIN, CTEXT, FNDSTR, GETUNI, CMPLOG, SETCHG,
  2139				STRTOV, AND STRTCH.
  2140				(AND ITS INTERNAL SUBRS STSINS, UNICHK, AND UNICK1.).
  2141				@@ #
  2142
  2143	003247'	200300	766160	STSDEF:	MOVE	T1,[SIXBIT/DSKB/] ;ALL STR NAMES ARE DSKB.
  2144	003250'	260040	763260		PUSHJ	P,FNDSTR	;DOES THIS STR ALREADY EXIST?
  2145	003251'	334300	766165		  SKIPA	T1,[[ASCIZ /STR already exists/]] ;YES, THIS IS A NO-NO.
  2146	003252'	254000	764254		JRST	STSNEW		;NO, OKAY UNLESS ALREADY A STR.
  2147	003253'	324740	763645		PJRST	CONOUT
  2148
  2149	003254'	336015	003032*	STSNEW:	SKIPN	STRNAM(P2)	;DOES ANY STR EXIST?
  2150	003255'	254000	764260		 JRST	STSNE1		;NO, THIS IS IT.
  2151					MOVEI	T1,[ASCIZ /
  2152				Too many file structures!  Only one allowed!
  2153	003256'	201300	766166	/]
  2154	003257'	324740	763645		PJRST	CONOUT
  2155
  2156				    ;HERE WITH A GOOD STR NAME.
  2157	003260'	260040	764410	STSNE1:	PUSHJ	P,CLRSTR
  2158	003261'	202315	003254*		MOVEM	T1,STRNAM(P2)
  2159	003262'	563015	003233*		HRROS	STRREF(P2)	;NEED REFRESH.
  2160				    ;HERE TO PUT THE UNITS IN THE STR.
  2161	003263'	201300	766200	STSNE2:	MOVEI	T1,[ASCIZ /Type names of physical units in STR, extra CR when done/]
  2162	003264'	260040	763645		PUSHJ	P,CONOUT
  2163
  2164	003265'	201715	003041*		MOVEI	P3,STRUNI(P2)
  2165	003266'	400600	000000		SETZ	P1,
  2166	003267'	260040	763665	STSNXT:	PUSHJ	P,GETUNI	;GET A UNIT NAME
  2167					JRST	[CAIE P3,STRUNI(P2)  ;FINISHED GETTING UNIT NAMES.
  2168						  JRST STSFIN
  2169	003270'	254000	766214			 JRST STSNE2]
  2170	003271'	260040	764274		PUSHJ	P,STSINS	;INSERT UNIT.
  2171	003272'	254000	764267		  JRST	STSNXT		;ALREADY IN STR
  2172	003273'	254000	764267		JRST	STSNXT		;CONTINUE
  2173
  2174				    ;SUBR INTERNAL TO STSDEF TO INSERT A UNIT IN THE STR.
  2175	003274'	550305	003046*	STSINS:	HRRZ	T1,UNISTR(U)	;SEE IF THIS UNIT IS ALREADY IN A STR.
  2176	003275'	322300	764300		JUMPE	T1,STSUN2	;T1 = 0 IF IT ISN'T
  2177					MOVEI	T1,[ASCIZ .
  2178				Unit already in file structure
  2179	003276'	201300	766217	.]
  2180	003277'	324740	763645		PJRST	CONOUT		;TYPE MSG. & EXIT
  2181
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 46-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2182	003300'	506256	000000	STSUN2:	HRLM	U,(P3)		;LINK THIS UNIT DATA BLOCK TO PREVIOUS ONE
  2183	003301'	552645	003274*		HRRZM	P2,UNISTR(U)	;ATTACH THIS UNIT DATA BLOCK TO THIS STR
  2184	003302'	550315	002172*		HRRZ	T1,STRUNM(P2)	;GET LOGICAL UNIT # WITHIN STR
  2185	003303'	137300	002535*		DPB	T1,UNYLUN	;SAVE IT IN UNIT DATA BLOCK
  2186	003304'	260040	000000*		PUSHJ	P,CMPLOG	;COMPUTE SIXBIT LOGICAL UNIT NUM, STORE IN UNILOG
  2187	003305'	260040	763657		PUSHJ	P,SETPUB
  2188				PRINTF(<[All references to STRPPU should be eliminated]>)
  2189	003306'	200305	003162*		MOVE	T1,UNIPPU(U)
  2190	003307'	313315	003237*		CAMLE	T1,STRPPU(P2)
  2191	003310'	202315	003307*		 MOVEM	T1,STRPPU(P2)
  2192	003311'	302600	000000		CAIE P1,0
  2193	003312'	315314	003306*		 CAMGE	T1,UNIPPU(P1)	;COMPARE WITH SMALLEST SO FAR
  2194	003313'	200600	000005		MOVE	P1,U		;SAVE ADDR OF SMALLEST IN P1
  2195	003314'	350015	003302*		AOS	STRUNM(P2)	;INCREMENT # OF UNITS IN STR
  2196	003315'	260040	763652		PUSHJ	P,SETCHG	;FLAG THAT UNIT'S HOME PAGES MUST BE REWRITTEN
  2197	003316'	201705	003301*		MOVEI	P3,UNISTR(U)	;MAKE CURRENT UNIT PREDECESSOR
  2198	003317'	254000	002701*		JRST	CPOPJ1		;SKIP RETURN
  2199
  2200				    ;HERE TO FINISH UP.
  2201	003320'	554255	003265*	STSFIN:	HLRZ	U,STRUNI(P2)
  2202	003321'	554245	003316*		HLRZ	U,UNISTR(U)	;GET ADR. OF NEXT UNIT DATA BLOCK IN STR
  2203	003322'	326240	764321		JUMPN	U,.-1		;REPEAT IF ANY LEFT
  2204	003323'	402000	764140		SETZM	TYPONL		;JUST IN CASE.
  2205	003324'	200240	000014		MOVE	U,P1		;GET SMALLEST UNIT.
  2206	003325'	135600	002576*		LDB	P1,UNYKTP##	;Get Kontroller type
  2207	003326'	261040	000014		PUSH	P,P1		;SAVE IT.
  2208	003327'	200314	764350		MOVE	T1,OVRDEF(P1)
  2209	003330'	526300	764136		HRLOM	T1,DBLSTD
  2210	003331'	260040	764236		PUSHJ	P,STRTOV	;SET OVERDRAW.
  2211	003332'	200301	000000		MOVE	T1,(P)
  2212	003333'	200306	764360		MOVE	T1,P4CDEF(T1)	;Pages for CRASH.SAV based on kontroller type
  2213	003334'	526300	764136		HRLOM	T1,DBLSTD
  2214	003335'	260040	764222		PUSHJ	P,STRTCH	;SET DEFAULT SIZE OF CRASH.SAV.
  2215	003336'	262040	000014		POP	P,P1
  2216	003337'	200300	766226		MOVE	T1,[PUSHJ P,UNICK1]
  2217	003340'	260040	763616		PUSHJ	P,STOUNI	;CHECK SATS.
  2218	003341'	200300	766227		MOVE T1,[PUSHJ P,UNICHK]
  2219	003342'	324740	763616		PJRST STOUNI		;NOW DO ALL UNITS.
  2220
  2221				    ;A LITTLE INTERNAL STSDEF SUBR.
  2222	003343'	402000	764143	UNICHK:	SETZM KNOUNI		;DO NOT KNOW UNIT.
  2223	003344'	324740	762415		PJRST UNCHKA		;GO DO THE STANDARD STUFF.
  2224
  2225				    ;A LITTLE INTERNAL STSDEF SUBR.
  2226	003345'	402000	764143	UNICK1:	SETZM KNOUNI
  2227	003346'	402000	764140		SETZM TYPONL		;JUST TO MAKE SURE.
  2228	003347'	324740	764170		PJRST UNITST		;CHECK SATS.
  2229
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 47
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2230				;DEFAULT DEFS BY UNIT TYPE.
  2231
  2232				;Default overdraw in blocks
  2233	003350'	000000	000001	OVRDEF:	1	;0 DR (unused)
  2234	003351'	000000	000062		^D50	;1 FH (unused)
  2235	003352'	000000	000175		^D125	;2 DP (unused)
  2236	003353'	000000	000175		^D125	;3 MF (unused)
  2237	003354'	000000	000175		^D125	;4 3330
  2238	003355'	000000	000175		^D125	;5 RM03
  2239	003356'	000000	000175		^D125	;6 AP
  2240	003357'	000000	000175		^D125	;7    (unused)
  2241
  2242				;Default pages for CRASH.SAV
  2243	003360'	000000	000000	P4CDEF:	0	;0 DR (unused)
  2244	003361'	000000	000000		0	;1 FH (unused)
  2245	003362'	000000	001000		^D512	;2 DP (unused)
  2246	003363'	000000	001000		^D512	;3 MF (unused)
  2247	003364'	000000	020001		^D8192+1;4 3330 KI/KL with 4096K of memory = 8193 pages for CRASH.EXE
  2248	003365'	000000	001000		^D512	;5 RM03 KS-2020
  2249	003366'	000000	001000		^D512	;6 AP   Foonly
  2250	003367'	000000	001000		^D512	;7    (unused)
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 48
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2251				COMMENT #
  2252				@@SUBROUTINE STSDSL
  2253				@@PURPOSE
  2254				SUBR TO DISSOLVE A STR.
  2255				CLEARS UNILOG, UNISTR, AND STRNAM AND FLAGS THAT ALL THE
  2256				STR'S UNITS' HOME PAGES NEED REWRITING.
  2257				@@ENTRY
  2258				EXPECTS
  2259				@@ACCUM
  2260				DESTROYS
  2261				@@CALLS
  2262				SETCHG.
  2263				@@ #
  2264
  2265	003370'	261040	000007	STSDSL:	PUSH	P,T2		;SAVE T2 AND
  2266	003371'	261040	000006		PUSH	P,T1		;T1.
  2267	003372'	201640	003031*		MOVEI	P2,STRDDB
  2268	003373'	554255	003320*		HLRZ	U,STRUNI(P2)	;GET ADR. OF 1ST. UNIT DATA BLOCK IN STR.
  2269	003374'	322240	764404		JUMPE	U,DISST2	;JUST UNLINK STR IF IT HAS NO UNITS.
  2270	003375'	205300	002662*		MOVSI	T1,UNPPRV	;UNIT MAY BE GOING PRIVATE.
  2271	003376'	403405	003025*	DISST1:	SETZB	T3,UNILOG(U)	;CLEAR OUT NAME OF LOGICAL UNIT WITHIN STR.
  2272	003377'	250405	003321*		EXCH	T3,UNISTR(U)	;CLEAR OUT LINKS TO STR & NEXT UNIT DATA BLOCKS.
  2273	003400'	436300	002750*		IORM	T1,UNIDES	;UNIT IS NOW A PRIVATE PACK
  2274	003401'	260040	763652		PUSHJ	P,SETCHG	;FLAG THAT THIS UNIT'S HOME PAGE MUST BE REWRITTEN.
  2275	003402'	554240	000010		HLRZ	U,T3		;GET NEXT UNIT DATA BLOCK ADR.
  2276	003403'	326240	764376		JUMPN	U,DISST1	;REPEAT IF THERE IS ONE.
  2277	003404'	260040	764410	DISST2:	PUSHJ	P,CLRSTR	;INDICATE STR NO LONGER EXISTS.
  2278	003405'	262040	000006		POP	P,T1		;RESTORE T1 AND
  2279	003406'	262040	000007		POP	P,T2		;T2.
  2280	003407'	263040	000000		POPJ	P,		;RETURN - DON'T WORRY ABOUT RETURING CORE
  2281								; AS RDHOME MUST BE CALLED AGAIN.
  2282
  2283
  2284
  2285				COMMENT #
  2286				@@SUBROUTINE CLRSTR
  2287				@@PURPOSE
  2288				LITTLE SUBR TO CLEAR OUT THE STR DB (SETTING STRNAM TO
  2289				ZERO INDICATES THAT THERE IS NO STR.).
  2290				@@ACCUM
  2291				DESTROYS NO ACS.
  2292				@@ #
  2293
  2294	003410'	261040	000006	CLRSTR:	PUSH	P,T1
  2295	003411'	261040	000000*		PUSH	P,STRDDB+STRBTS
  2296	003412'	402000	003372*		SETZM	STRDDB	
  2297	003413'	505300	003412*		HRLI	T1,STRDDB
  2298	003414'	541300	000001*		HRRI	T1,STRDDB+1
  2299	003415'	251300	000000*		BLT	T1,STRDDB+STRLEN-1
  2300	003416'	262040	000006		POP	P,T1
  2301	003417'	552300	000000*		HRRZM	T1,STRDDB+STRBTS
  2302	003420'	262040	000006		POP	P,T1
  2303	003421'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 48-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2304
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 49
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2305				COMMENT #
  2306				@@SUBROUTINE ADDUNI
  2307				@@PURPOSE
  2308				SUBR TO ADD A UNIT TO THE SYSTEM STR.
  2309				@@ENTRY
  2310				EXPECTS
  2311				@@CALLS
  2312
  2313				@@ACCUM
  2314				DESTROYS
  2315				@@EXIT
  2316
  2317				@@ #
  2318
  2319	003422'	201640	003413*	ADDUNI:	MOVEI	P2,STRDDB	;P2/ ADDR OF STR DB.
  2320	003423'	336015	003261*		SKIPN	STRNAM(P2)	;HAS THE STR BEEN DEFINED?
  2321	003424'	254000	764513		 JRST	ADDNOT		;NO, ILLEGAL TO ADD TO IT.
  2322	003425'	201300	766230		MOVEI	T1,[ASCIZ .Enter unit name to add.]
  2323	003426'	260040	763645		PUSHJ	P,CONOUT	;BY NOW P2=STR DDB.
  2324	003427'	260040	763665		PUSHJ	P,GETUNI	;GET A UNIT NAME.
  2325	003430'	254000	764515		  JRST	CANTAD		;NOT A UNIT, CAN NOT ADD.
  2326	003431'	322240	764515		JUMPE	U,CANTAD	;CAN NOT ADD ALL EITHER.
  2327	003432'	550305	003377*		HRRZ	T1,UNISTR(U)	;IS THE UNIT IN A STR ALREADY?
  2328	003433'	322300	764436		JUMPE	T1,ADDUN2	;NO.
  2329	003434'	201300	766235		MOVEI	T1,[ASCIZ .THAT unit is already in a structure.]
  2330	003435'	254000	763645		JRST	CONOUT
  2331
  2332				    ;HERE WHEN WE HAVE A UNIT TO ADD, AND THE UNIT IS NOT
  2333				    ;ALREADY IN A STR.
  2334	003436'	200305	003312*	ADDUN2:	MOVE	T1,UNIPPU(U)
  2335	003437'	313315	003310*		CAMLE	T1,STRPPU(P2)	;MUST NOT WANT TO CHANGE STRPPU
  2336	003440'	254000	764515		 JRST	CANTAD
  2337	003441'	402000	764140		SETZM	TYPONL
  2338	003442'	260040	762415		PUSHJ	P,UNCHKA	;SET UNIT ID AND NO. OF SATS PER UNIT.
  2339	003443'	550315	003314*		HRRZ	T1,STRUNM(P2)
  2340	003444'	135340	003303*		LDB	T2,UNYLUN
  2341	003445'	137300	003444*		DPB	T1,UNYLUN	;CHANGE THIS UNIT NUMBER
  2342	003446'	402007	002537*		SETZM	UNTTBL(T2)	;ZERO OLD CELL
  2343	003447'	200300	000007		MOVE	T1,T2
  2344	003450'	332006	777777*		SKIPE	UNTTBL-1(T1)
  2345	003451'	364300	764450		 SOJA	T1,.-1		;LOOK FOR ZERO
  2346	003452'	316300	000007		CAMN	T1,T2
  2347	003453'	254000	764460		 JRST	ADUNT
  2348	003454'	250246	003446*		EXCH	U,UNTTBL(T1)	;GET THAT ONE
  2349	003455'	137340	003445*		DPB	T2,UNYLUN	;CHANGE ITS NUMBER
  2350	003456'	250247	003454*		EXCH	U,UNTTBL(T2)	;AND STOR IN NEW PLACE (SETS U=0)
  2351	003457'	250246	003456*		EXCH	U,UNTTBL(T1)	;GET OLD U BACK
  2352	003460'	135300	003455*	ADUNT:	LDB	T1,UNYLUN	;AND OLD UNIT NUMBER
  2353	003461'	202246	003457*		MOVEM	U,UNTTBL(T1)	;STORE IN NEW PLACE
  2354	003462'	510315	003262*		HLLZ	T1,STRREF(P2)	;IS IT MARKED FOR REFRESH
  2355	003463'	326300	764473		JUMPN	T1,ADDUN4	;YES, DO NOT NEED TO REFRESH PACK
  2356	003464'	261040	000015		PUSH	P,P2		;SAVE THE STR POINTER.
  2357	003465'	260040	764736		PUSHJ	P,UPDHOM	;WRITE HOME PAGES.
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 49-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2358	003466'	262040	000015		POP	P,P2		;RESTORE STR PTR.
  2359	003467'	205740	002652*		MOVSI	P4,UNPCHG
  2360	003470'	412745	003400*		ANDCAM	P4,UNIDES(U)	;PAKREF WILL READ HOME PAGES.
  2361	003471'	260040	000000*		PUSHJ	P,PAKREF	;REFRESH PACK.
  2362	003472'	254000	764515		  JRST	CANTAD		;COULD NOT DO IT.
  2363	003473'	350315	003443*	ADDUN4:	AOS	T1,STRUNM(P2)	;ONE MORE IN STR
  2364	003474'	275300	000001		SUBI	T1,1		;
  2365	003475'	552645	003432*		HRRZM	P2,UNISTR(U)	;LINK TO STR DDB
  2366	003476'	260040	003304*		PUSHJ	P,CMPLOG	;MAKE A LOGICAL UNIT NAME
  2367	003477'	554315	003373*		HLRZ	T1,STRUNI(P2)
  2368	003500'	554346	003475*	ADDUN5:	HLRZ	T2,UNISTR(T1)
  2369	003501'	322340	764504		JUMPE	T2,ADDUN7	;FIND END OF CURRENT LIST
  2370	003502'	200300	000007		MOVE	T1,T2
  2371	003503'	254000	764500		JRST	ADDUN5
  2372	003504'	261040	000006	ADDUN7:	PUSH	P,T1		;SAVE LAST UNIT.
  2373	003505'	506246	003500*		HRLM	U,UNISTR(T1)
  2374	003506'	260040	763652		PUSHJ	P,SETCHG	;MARK HOME PAGE CHANGED.
  2375	003507'	260040	763657		PUSHJ	P,SETPUB
  2376	003510'	262040	000005		POP	P,U		;WANT TO SET CHANGED HOME ON THIS ONE TOO.
  2377	003511'	260040	763652		PUSHJ	P,SETCHG
  2378	003512'	263040	000000		POPJ	P,
  2379
  2380	003513'	201300	766245	ADDNOT:	MOVEI T1,[ASCIZ .The SYSTEM structure has not been DEFINED yet.]
  2381	003514'	254000	763645		JRST CONOUT
  2382
  2383	003515'	513005	003505*	CANTAD:	HLLZS	UNISTR(U)	;
  2384	003516'	201300	766257		MOVEI	T1,[ASCIZ .Cannot add unit to structure.]
  2385	003517'	254000	763645		JRST	CONOUT
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 50
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2386				;SUBR TO REFRESH A STR.
  2387
  2388	003520'	260040	764544	STSREF:	PUSHJ	P,GETDAT	;Get date (so HOME.SYS doesn't say 2-JAN-64)
  2389	003521'	201300	000000*		MOVEI	T1,UFDHSI	; RANNO already setup!
  2390	003522'	542300	000000*		HRRM	T1,STRHSH+STRDDB
  2391	003523'	336000	763230		SKIPN	RANHOM		; Is this a virgin pack set?
  2392	003524'	350000	763230		 AOS	RANHOM		; If so, prevent RDHOME from complaining.
  2393	003525'	260040	764726		PUSHJ	P,RWRHOM	;WRITE HOME PAGES.
  2394	003526'	402000	763771		SETZM	BATMAN
  2395	003527'	260040	762556		PUSHJ	P,RDHOME	; Read & Verify HOM pages
  2396	003530'	255000	000000		  JFCL			; Ignore "all" errors
  2397	003531'	255000	000000		  JFCL
  2398	003532'	200200	002370*		MOVE	F,DDSTAR
  2399	003533'	260040	000000*		PUSHJ	P,REFRSH	;REFRESH THE STR.
  2400	003534'	254000	764541		  JRST	CNTADS		;LOST.
  2401	003535'	260040	762556		PUSHJ	P,RDHOME	; Read & Verify new HOM pages
  2402	003536'	255000	000000		  JFCL			; Just to make sure.
  2403	003537'	255000	000000		  JFCL
  2404	003540'	263040	000000		POPJ P,
  2405
  2406	003541'	563015	003462*	CNTADS:	HRROS	STRREF(P2)	;MARK WE STILL NEED REFRESHING.
  2407	003542'	201300	766265		MOVEI	T1,[ASCIZ /The structure WAS NOT successfully refreshed./]
  2408	003543'	324740	763645		PJRST	CONOUT
  2409
  2410	003544'	331000	000067*	GETDAT:	SKIPL	THSDAT##	;Do nothing if date is valid
  2411	003545'	263040	000000		 POPJ	P,
  2412	003546'	265440	000000*		JSP	T4,SAVE4	;Save P2 and P4
  2413	003547'	261040	000002		PUSH	P,J
  2414	003550'	201100	000000		MOVEI	J,0		;Job 0 is local time zone
  2415	003551'	201300	766277	GETDT1:	MOVEI	T1,[ASCIZ /Enter date as MM-DD-YYYY /]
  2416	003552'	260040	002347*		PUSHJ	P,OCONM
  2417	003553'	260040	003043*		PUSHJ	P,OPOUT
  2418	003554'	260040	003212*		PUSHJ	P,GETLIN	;Get response
  2419	003555'	254000	764551		  JRST	GETDT1
  2420	003556'	260040	003104*		PUSHJ	P,DECIN		;	MM
  2421	003557'	254000	764551		  JRST	GETDT1
  2422	003560'	254000	764551		  JRST	GETDT1
  2423	003561'	201647	777777		MOVEI	P2,-1(T2)
  2424	003562'	221640	000037		IMULI	P2,^D31
  2425	003563'	260040	003556*		PUSHJ	P,DECIN		;	    DD
  2426	003564'	254000	764551		  JRST	GETDT1
  2427	003565'	254000	764551		  JRST	GETDT1
  2428	003566'	271647	777777		ADDI	P2,-1(T2)
  2429	003567'	260040	003563*		PUSHJ	P,DECIN		;		YYYY
  2430	003570'	254000	764551		  JRST	GETDT1
  2431	003571'	254000	764551		  JRST	GETDT1
  2432	003572'	275340	003654		SUBI	T2,^D1964
  2433	003573'	221340	000564		IMULI	T2,^D31*^D12
  2434	003574'	270340	000015		ADD	T2,P2
  2435	003575'	260040	000000*		PUSHJ	P,COMDAS##
  2436	003576'	254000	764551		  JRST	GETDT1
  2437	003577'	201300	766305	GETDT2:	MOVEI	T1,[ASCIZ /Enter time as HHMM /]
  2438	003600'	260040	003552*		PUSHJ	P,OCONM
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 50-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2439	003601'	260040	003553*		PUSHJ	P,OPOUT
  2440	003602'	260040	003554*		PUSHJ	P,GETLIN	;Get response
  2441	003603'	254000	764577		  JRST	GETDT2
  2442	003604'	260040	003567*		PUSHJ	P,DECIN		;4 digit number
  2443	003605'	254000	764577		  JRST	GETDT2
  2444	003606'	254000	764577		  JRST	GETDT2
  2445	003607'	200300	000007		MOVE	T1,T2		;SET TIME ACCORDING TO ARGUMENT
  2446	003610'	231300	000144		IDIVI	T1,^D100	;Seperate HH from MM
  2447	003611'	221300	000074		IMULI	T1,^D60		;
  2448	003612'	270300	000007		ADD	T1,T2		;COMPUTE MINUTES
  2449	003613'	260040	000000*		PUSHJ	P,COMTMS##
  2450	003614'	254000	764577		  JRST	GETDT2
  2451	003615'	262040	000002		POP	P,J
  2452	003616'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 51
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2453				;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  2454				;;									;;
  2455				;;	Routine SETRAN - Start timer for pseudo-random number		;;
  2456				;;									;;
  2457				;;	Called by CMDSCN whenever it prompts the operator for		;;
  2458				;;	anything during ONCE and ONCDSK.  Needed in conjunction		;;
  2459				;;	with GETRAN which reads the current timer value for the		;;
  2460				;;	REFRESH command.						;;
  2461				;;									;;
  2462				;;	Clobbers T1, T2  - depending upon processor			;;
  2463				;;									;;
  2464				;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  2465
  2466	764617			SETRAN:			; Entry point to start timer for random number
  2467				IFCPU (<KL,KS>),<
  2468				IFCPU (<KL>),<
  2469					EXTERN EPT
  2470	003617'	402000	000511*		SETZM	EPT+EPTLTB	; Clear EPT locations (KL)
  2471	003620'	702600	002000		CONO	MTR,MO.TON	; Turn on MTR clock
  2472				>; END IFCPU (KL)
  2473				IFCPU (KS),<
  2474					SETZB	T1,T2		; Set the Time Base
  2475					WRTIME	T1		; To Zero.
  2476				>;END IFCPU (KS)
  2477	003621'	263040	000000		POPJ	P,		; Return.
  2478				>;END IFCPU(<KL,KS>)
  2479
  2480				IFCPU (<KI,F3>),<
  2481					MOVE	T1,[JRST CLKLVL]; New Clock-routine
  2482					EXCH	T1,CH7+1	; Set New/Save Old Value
  2483					MOVEM	T1,CLKRAN	; Store for later
  2484					SETZM	CLKCNT		; Reset time base
  2485					WRPI	1B25!1B35	; TURN ON CHANNEL SEVEN.
  2486				IFCPU (KI),<WRAPR 1B25!1B26!7B35>
  2487				IFCPU (F3),<WRAPR LP.ESF+LP.CSF+LP.CLK+7B35>
  2488					POPJ	P,		; Return.
  2489				
  2490				CLKLVL:	AOS	CLKCNT		;
  2491				IFCPU (KI),<WRAPR 1B25!1B26!7B35>	;
  2492				IFCPU (F3),<WRAPR LP.ESF+LP.CSF+LP.CLK+7B35>
  2493					JEN	@CH7
  2494				
  2495				CLKRAN:	Z			; Holder for old CH7+1
  2496				CLKCNT: 0			; Timer value
  2497				>;END IFCPU (<KI,F3>)
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 52
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2498				;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  2499				;;									;;
  2500				;;	Routine GETRAN - Read the time-base or clock value		;;
  2501				;;									;;
  2502				;;	Called by CMDSCN in ONCE and ONCDSK each time the operator	;;
  2503				;;	is prompted for a response.  Updates RANNO## with a new		;;
  2504				;;	random seed used by REFSTR each time.				;;
  2505				;;									;;
  2506				;;	Clobbers T1.							;;
  2507				;;									;;
  2508				;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  2509
  2510				External RANNO			  ; Located in REFSTR, set here each cmd line
  2511
  2512	003622'	261040	000007	GETRAN:	PUSH	P,T2		  ; Save this register (T2)
  2513	003623'	702040	000006	IFCPU (<KL,KS>),<RDTIME	T1>	  ; Read time base setup earlier + counter
  2514	003624'	242340	777764	IFCPU (KL),<LSH T2,-^D12>	  ; Strip low order zero bits on KL
  2515				IFCPU (<KI,F3>),<
  2516					HRRZ T2,CLKCNT		  ; Read clock setup earlier + elapsed
  2517				IFCPU (KI),<WRAPR 1B24!7B35>	  ; Disable CLOCK now
  2518				IFCPU (F3),<WRAPR LP.CSF+LP.DSF+LP.CLK+7B35>
  2519					WRPI	1B26!1B35	  ; Turn OFF channel seven
  2520					MOVE	T1,CLKRAN	  ; Get previous channel 7
  2521					MOVEM	T1,CH7+1	  ; Reset
  2522				>;End IFCUP(<KI,F3>)
  2523	003625'	606340	777777		TRNN	T2,-1		  ; Make sure RH is neq 0
  2524	003626'	201340	434164		 MOVEI	T2,(SIXBIT /CAT/) ; If not, set to 'CAT'
  2525	003627'	552340	000000*		HRRZM	T2,RANNO	  ; Store for later
  2526	003630'	262040	000007		POP	P,T2		  ; Restore T2 from entry
  2527	003631'	263040	000000		POPJ	P,		  ; Return.
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 53
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2528				;SUBR TO ALLOW OPER TO QUERY/SELECT DSKCLN TYPE
  2529				;
  2530				SPCDKN:	MOVEI	T1,[ASCIZ /
  2531	003632'	201300	766311	DSKCLN mode is: /]
  2532	003633'	260040	003600*		PUSHJ	P,OCONM		;MOVE MSG TO OUTPUT BUF
  2533	003634'	260040	764717		PUSHJ	P,SPCDKP	;GET CURRENT DC MODE AND PRIORITY
  2534	003635'	205300	200000		MOVSI	T1,DCN.ON	;INDIC OPER HAS SEEN AND/OR
  2535	003636'	436300	001764*		IORM	T1,DCN		; SELECTED DSKCLN MODE
  2536	003637'	200347	764677		MOVE	T2,SCNDSK(T2)	;GET SIXBIT NAME OF CURRENT MODE
  2537	003640'	306400	000005		CAIN	T3,^L<(DCN.DF)>	;IS MODE DEFAULT?
  2538	003641'	200340	766315		 MOVE	T2,[SIXBIT /NULL/]	;YES, TELL THIS TO OPER
  2539	003642'	260040	003206*		PUSHJ	P,PRNAME	;BUFFER MODE NAME
  2540	003643'	260040	763646		PUSHJ	P,CRLFOP	;APPEND CRLF, DO CTY OUTPUT
  2541	003644'	201300	766316	SPCDK1:	MOVEI	T1,[ASCIZ /DSKCLN mode desired? /]
  2542	003645'	260040	003633*		PUSHJ	P,OCONM		;MOVE MSG TO OUTPUT BUF
  2543	003646'	260040	003601*		PUSHJ	P,OPOUT		;DO CTY OUTPUT
  2544	003647'	260040	003602*		PUSHJ	P,GETLIN	;GET OPER'S RESPONSE
  2545	003650'	263040	000000		 POPJ	P,		;NULL, NO CHANGE IN MODE
  2546	003651'	201600	764677		MOVEI	P1,SCNDSK	; Get address of Scan Table
  2547	003652'	402000	761307		SETZM	CMDSCF		; Specify NO STR/UNIT stuff
  2548	003653'	260040	761211		PUSHJ	P,CMDSCN	; Call Scanning routine
  2549	003654'	254000	764657		  JRST	SPDKHP		; No good!
  2550	003655'	137700	761005		DPB	P3,DCNYON	;SAVE IN DCN
  2551	003656'	263040	000000	NULDSK:	POPJ	P,		;RETURN
  2552
  2553				SPDKHP:	MOVEI	T1,[ASCIZ \
  2554				Bad entry: Type 'FULL', 'FAST', 'NONE'
  2555	003657'	201300	766323	 or just <Return> for default (NO CHANGE)\]
  2556	003660'	260040	763645		PUSHJ	P,CONOUT	;TYPE ERROR MSG ON CTY
  2557	003661'	254000	764644		JRST	SPCDK1		;LET OPER TRY AGAIN
  2558
  2559				;MODE-MNEMONIC CORRESPONDENCE TABLE
  2560				;
  2561					DEFINE	MKDSK <
  2562					X NONE,0,Ab.Nak,
  2563					X FAST,0,Ab.Nak,
  2564					X ,0,Ab.Nak,
  2565					X ,0,Ab.Nak,
  2566					X ,0,Ab.Nak,
  2567					X ,0,Ab.Nak,
  2568					X ,0,Ab.Nak,
  2569					X FULL,0,Ab.Nak,
  2570				>
  2571
  2572	003662'	254000	764657		SCNTB	(SPDKHP,SPDKHP,DSK)
  2573	003663'	254000	764657
  2574	003664'	254000	764656
  2575	003665'	000000	000000
  2576	003666'	000000	000000
  2577	003667'	000000	000000
  2578	003670'	000000	000000
  2579	003671'	000000	000000
  2580	003672'	000000	000000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 53-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2581	003673'	000000	000000
  2582	003674'	000000	000000
  2583	003675'	777770	764707
  2584	003676'	777770	764677
  2585	003677'	565756	450000
  2586	003700'	464163	640000
  2587	003701'	000000	000000
  2588	003702'	000000	000000
  2589	003703'	000000	000000
  2590	003704'	000000	000000
  2591	003705'	000000	000000
  2592	003706'	466554	540000
  2593	003707'	000000*	764707
  2594	003710'	000000*	764707
  2595	003711'	000000*	764707
  2596	003712'	000000*	764707
  2597	003713'	000000*	764707
  2598	003714'	000000*	764707
  2599	003715'	000000*	764707
  2600	003716'	000000*	764707
  2601
  2602				;ROUTINE TO GET/SET DSKCLN MODE AND DETERMINE WHO LAST SET IT
  2603				;
  2604	003717'	200340	003636*	SPCDKP:	MOVE	T2,DCN		;GET DSKCLN MODE WORD
  2605	003720'	243340	764721		JFFO	T2,.+1		;DETERMINE HIGHEST PRIORITY MODE
  2606	003721'	135350	761004		LDB	T2,DCNTAB(T3)	;FETCH IT
  2607	003722'	137340	761005		DPB	T2,DCNYON	;OPER HAS SEEN OR SELECTED THIS MODE
  2608	003723'	263040	000000		POPJ	P,		;RETURN
  2609
  2610				FILGO:	MOVEI T1,[Asciz\
  2611	003724'	201300	766344	Leaving the FILES dialogue...\]
  2612	003725'	260040	762544		PUSHJ P,LNGMES		; Let everyone know we're leaving!
  2613	003726'	205740	003467*	RWRHOM:	MOVSI P4,UNPCHG
  2614	003727'	554240	003014*		HLRZ U,SYSUNI		;FIRST UNIT
  2615	003730'	612745	003470*	CHGHOM:	TDNE P4,UNIDES(U)
  2616	003731'	260040	764736		PUSHJ P,UPDHOM		;REWRITE IF NEEDED.
  2617	003732'	412745	003730*		ANDCAM P4,UNIDES(U)
  2618	003733'	554245	003023*		HLRZ U,UNISYS(U)
  2619	003734'	326240	764730		JUMPN U,CHGHOM
  2620	003735'	263040	000000		POPJ P,
  2621
  2622
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 54
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2623				COMMENT #
  2624				@@SUBROUTINE UPDHOM
  2625				@@PURPOSE
  2626				SUBROUTINE TO READ A HOME PAGE, UPDATE IT FROM THE STR AND
  2627				UNIT DB, AND THEN WRITE IT OUT.
  2628				@@ENTRY
  2629				EXPECTS U/ UNIT DB AND F/ DDB.
  2630				@@ACCUM
  2631				DESTROYS
  2632				@@CALLS
  2633				SVOTAC, GETHOM, AND WTBOTH.
  2634				@@ #
  2635
  2636	003736'	265340	763706	UPDHOM:	JSP	T2,SVOTAC	;SAVE P4,F,U & J
  2637	003737'	476000	763517		SETOM	NOERH		;NO ERRORS PRINTED FOR HOME READ.
  2638	003740'	260040	763354		PUSHJ	P,GETHOM	;GET HOME PAGE INTO CORE.
  2639					  JRST	[MOVEI T1,%HOM
  2640						PUSHJ P,CORZER
  2641	003741'	254000	766353			JRST .+1]
  2642	003742'	202640	753000*		MOVEM	P2,%HOM+PAGNAM	;SAVE SIXBIT HOME PAGE IDENTIFIER
  2643	003743'	550645	003515*		HRRZ	P2,UNISTR(U)	;GET STR DATA BLOCK ADR.
  2644	003744'	200305	003217*		MOVE	T1,UNIHID(U)	;GET SIXBIT UNIT ID
  2645	003745'	202300	753000*		MOVEM	T1,%HOM+HOMHID	;SAVE IN HOME PAGE
  2646	003746'	554305	003743*		HLRZ	T1,UNISTR(U)	;GET NEXT UNIT DATA BLOCK ADR. IN STR
  2647	003747'	332000	000006		SKIPE	T1		;SAVE 0 IF LAST UNIT IN STR OR NOT IN A STR
  2648	003750'	200306	003744*		MOVE	T1,UNIHID(T1)	;GET ITS ID
  2649	003751'	202300	753000*		MOVEM	T1,%HOM+HOMNXT	;SAVE IN HOME PAGE
  2650	003752'	332300	000015		SKIPE	T1,P2		;SAVE 0 STR NAME IF UNIT NOT IN A STR
  2651	003753'	200315	003423*		MOVE	T1,STRNAM(P2)	;GET SIXBIT STR NAME
  2652	003754'	202300	753000*		MOVEM	T1,%HOM+HOMSNM	;SAVE IN HOME PAGE
  2653	003755'	322640	765000		JUMPE	P2,UPDHM3	;BYPASS ALL REFERENCES TO VALUES IN STR DATA BLOCK
  2654	003756'	554355	003477*		HLRZ	T2,STRUNI(P2)	;GET ADR. OF 1ST UNIT DATA BLOCK IN STR
  2655	003757'	200300	000007	UPDHM1:	MOVE	T1,T2		;CURRENT UNIT_NEXT UNIT
  2656	003760'	322300	764765		JUMPE	T1,UPDHM2	;IF NONE LEFT SAVE 0 IN HOMPRV
  2657	003761'	554346	003746*		HLRZ	T2,UNISTR(T1)	;GET ADR. OF NEXT UNIT DATA BLOCK IN STR
  2658	003762'	200306	003750*		MOVE	T1,UNIHID(T1)	;GET CURRENT UNIT'S SIXBIT ID
  2659	003763'	312340	000005		CAME	T2,U		;IS ADR. OF NEXT UNIT DATA BLOCK SAME AS THIS ONE?
  2660	003764'	254000	764757		JRST	UPDHM1		;YES - PUT SIXBIT ID INTO THIS UNIT'S HOME PAGE
  2661	003765'	202300	753000*	UPDHM2:	MOVEM	T1,%HOM+HOMPRV	;SAVE IN HOME PAGE
  2662								; 0 OR SIXBIT UNIT ID OF PREVIOUS UNIT IN STR
  2663	003766'	510315	003541*		HLLZ	T1,STRREF(P2)	;GET 'REFRESH' FLAG
  2664	003767'	502300	753000*		HLLM	T1,%HOM+HOMREF	;SAVE IN HOME PAGE
  2665	003770'	550300	000000*		HRRZ	T1,STRDDB+STRHSH ;
  2666	003771'	516300	753000*		HRLZM	T1,%HOM+HOMHSH	;
  2667	003772'	550300	763230		HRRZ	T1,RANHOM	;Use Remembered HOMRAN value
  2668	003773'	542300	753000*		HRRM	T1,%HOM+HOMRAN	;
  2669	003774'	200315	003245*		MOVE	T1,STROVR(P2)	;GET -VE # PAGES USER IS ALLOWED TO OVERDRAW
  2670	003775'	202300	753000*		MOVEM	T1,%HOM+HOMOVR	;SAVE IN HOME PAGE
  2671	003776'	550315	003232*		HRRZ	T1,STRP4C(P2)	;GET # PAGES FOR CRASH.SAV
  2672	003777'	202300	753000*		MOVEM	T1,%HOM+HOMP4C	;SAVE IN HOME PAGE
  2673
  2674	004000'	200305	003376*	UPDHM3:	MOVE	T1,UNILOG(U)	;GET SIXBIT LOGICAL UNIT WITHIN STR
  2675	004001'	202300	753000*		MOVEM	T1,%HOM+HOMLOG	;SAVE IN HOME PAGE
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 54-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2676	004002'	135300	003460*		LDB	T1,UNYLUN	;GET LOGICAL UNIT # WITHIN STR
  2677	004003'	202300	753000*		MOVEM	T1,%HOM+HOMLUN	;SAVE IN HOME PAGE
  2678	004004'	135300	003172*		LDB	T1,UNYSPU	;GET # SAT BLOCKS PER UNIT
  2679	004005'	202300	753000*		MOVEM	T1,%HOM+HOMSPU	;SAVE IN HOME PAGE
  2680	004006'	201300	753001*		MOVEI	T1,%HOM+HOMEND+1 ;FIRST WORD TO CLEAR.
  2681	004007'	303300	752777*		CAILE	T1,%HOM+HOMDAT-1 ;SKIP IF AT LEAST ONE WORD.
  2682	004010'	254000	765017		JRST	UPDHM4
  2683	004011'	402006	000000		SETZM	(T1)		;CLEAR THE FIRST WORD
  2684	004012'	306300	752777*		CAIN	T1,%HOM+HOMDAT-1	;SKIP IF MORE
  2685	004013'	254000	765017		JRST	UPDHM4
  2686	004014'	505300	753001*		HRLI	T1,%HOM+HOMEND+1
  2687	004015'	541300	753002*		HRRI	T1,%HOM+HOMEND+2
  2688	004016'	251300	752777*		BLT	T1,%HOM+HOMDAT-1	;CLEAR UNUSED WORDS
  2689				    ;HERE TO WRITE OUT.
  2690	004017'	202700	753000*	UPDHM4:	MOVEM	P3,%HOM+PAGCOD	;SAVE CODE WORD IN HOME PAGE.
  2691	004020'	205640	505755		MOVSI	P2,(SIXBIT .HOM.) ;RESTORE ARG.
  2692	004021'	260040	763435		PUSHJ	P,WTBOTH	;WRITE OUT BOTH HOME PAGES
  2693	004022'	256000	761000		STOPCD
  2694	004023'	263040	000000		POPJ	P,		;RETURN
  2695
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 55
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2696				;PRINT OR CHANGE SAT+RIB PCBS
  2697	004024'	200600	000000*	TYPSPC:	MOVE	P1,NMSTPC
  2698	004025'	201300	766356		MOVEI	T1,[ASCIZ /NUMBER OF SAT PCBS = /]
  2699	004026'	324740	763624		PJRST	DECLOP
  2700
  2701	004027'	201300	000005	CHGSPC:	MOVEI	T1,5
  2702	004030'	202300	764142		MOVEM	T1,MIN
  2703	004031'	201300	000050		MOVEI	T1,^D40		;%CTAMX=77  MAX PERMISSABLE VALUE IN PCBIO
  2704	004032'	202300	764141		MOVEM	T1,MAX
  2705	004033'	201300	766356		MOVEI	T1,[ASCIZ /NUMBER OF SAT PCBS = /]
  2706	004034'	200600	004024*		MOVE	P1,NMSTPC
  2707	004035'	260040	764056		PUSHJ	P,ASKQMM
  2708	004036'	263040	000000		 POPJ	P,
  2709	004037'	202340	004034*		MOVEM	T2,NMSTPC
  2710	004040'	263040	000000		POPJ	P,
  2711
  2712
  2713	004041'	200600	000000*	TYPRPC:	MOVE	P1,NMRBPC
  2714	004042'	201300	766363		MOVEI	T1,[ASCIZ /NUMBER OF RIB PCBS = /]
  2715	004043'	324740	763624		PJRST	DECLOP
  2716
  2717	004044'	201300	000005	CHGRPC:	MOVEI	T1,5
  2718	004045'	202300	764142		MOVEM	T1,MIN
  2719	004046'	201300	000024		MOVEI	T1,^D20		;%CTAMX=77  MAX PERMISSABLE VALUE IN PCBIO
  2720	004047'	202300	764141		MOVEM	T1,MAX
  2721	004050'	201300	766363		MOVEI	T1,[ASCIZ /NUMBER OF RIB PCBS = /]
  2722	004051'	200600	004041*		MOVE	P1,NMRBPC
  2723	004052'	260040	764056		PUSHJ	P,ASKQMM
  2724	004053'	263040	000000		  POPJ	P,
  2725	004054'	202340	004051*		MOVEM	T2,NMRBPC
  2726	004055'	263040	000000		POPJ	P,
  2727
  2728				;CHANGE BAT BLOCKS
  2729
  2730	004056'	201300	766370	CHGBAT:	MOVEI	T1,[ASCIZ /Type unit name to refresh BAT pages  /]
  2731	004057'	260040	003204*		PUSHJ	P,CONMES
  2732	004060'	260040	003646*		PUSHJ	P,OPOUT
  2733	004061'	260040	763665		PUSHJ	P,GETUNI
  2734	004062'	263040	000000		  POPJ	P,
  2735	004063'	260040	763757		PUSHJ	P,BATREF
  2736	004064'	263040	000000		  POPJ	P,
  2737	004065'	263040	000000		POPJ	P,
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 56
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2738				;TYPE BAT
  2739
  2740	004066'	201300	766400	TYPBAT:	MOVEI	T1,[ASCIZ /Type unit name  /]
  2741	004067'	260040	004057*		PUSHJ	P,CONMES
  2742	004070'	260040	004060*		PUSHJ	P,OPOUT
  2743	004071'	260040	763665		PUSHJ	P,GETUNI
  2744	004072'	263040	000000		  POPJ	P,
  2745	004073'	402000	763771		SETZM	BATMAN
  2746	004074'	260040	763735		PUSHJ	P,CHKBAT
  2747	004075'	255000	000000		  JFCL			;IGNORE ERRORS.
  2748	004076'	200345	002700*		MOVE	T2,UNINAM(U)	;Physical unit name
  2749	004077'	260040	003642*		PUSHJ	P,PRNAME
  2750	004100'	201400	000050		MOVEI	T3,"("
  2751	004101'	260040	001547*		PUSHJ	P,COMTYO
  2752	004102'	200345	004000*		MOVE	T2,UNILOG(U)	;Logical name (such as DSKB1)
  2753	004103'	260040	004077*		PUSHJ	P,PRNAME
  2754	004104'	201400	000072		MOVEI	T3,":"
  2755	004105'	260040	004101*		PUSHJ	P,COMTYO
  2756	004106'	200345	003762*		MOVE	T2,UNIHID(U)	;Home block ID
  2757	004107'	260040	004103*		PUSHJ	P,PRNAME
  2758	004110'	201400	000051		MOVEI	T3,")"
  2759	004111'	260040	004105*		PUSHJ	P,COMTYO
  2760	004112'	200340	747000*		MOVE	T2,%BAT+BATFIR	;Get AOBJN pointer
  2761	004113'	271340	747000		ADDI	T2,%BAT
  2762	004114'	403700	000014		SETZB	P3,P1		;P1 IS PAGE COUNT, P3 REGION COUNT.
  2763	004115'	336007	000000*	TYPBT1:	SKIPN	BATNBB(T2)
  2764	004116'	254000	765124		 JRST	TYPBT2		;DONE.
  2765	004117'	271700	000001		ADDI	P3,1		;1 REGION.
  2766	004120'	135300	000000*		LDB	T1,BAYNBB	;(uses T2 as index reg)
  2767	004121'	271606	000001		ADDI	P1,1(T1)	;THIS MANY PAGES.
  2768	004122'	252340	765124		AOBJP	T2,TYPBT2
  2769	004123'	253340	765115		AOBJN	T2,TYPBT1
  2770	004124'	201300	766404	TYPBT2:	MOVEI	T1,[ASCIZ /  (counts do not agree)/]
  2771	004125'	316600	747000*		CAMN	P1,%BAT+BATPAT	;Page total
  2772	004126'	312700	747000*		CAME	P3,%BAT+BATCNT	;Count of regions
  2773	004127'	260040	004067*		 PUSHJ	P,CONMES
  2774	004130'	200300	000014		MOVE	T1,P1
  2775	004131'	260040	765307		PUSHJ	P,PR6DIG	;Output number in 6-character field
  2776	004132'	201300	766411		MOVEI	T1,[ASCIZ / bad pages in /]
  2777	004133'	260040	004127*		PUSHJ	P,CONMES
  2778	004134'	200300	000016		MOVE	T1,P3
  2779	004135'	260040	000000*		PUSHJ	P,PRTDIG
  2780	004136'	201300	766414		MOVEI	T1,[ASCIZ / distinct regions./]
  2781	004137'	260040	763646		PUSHJ	P,CRLFOP
  2782	004140'	322700	765241		JUMPE	P3,TYPBT9	;Just CRLF if none
  2783	004141'	201300	766420		MOVEI	T1,[ASCIZ /Do you want a list of bad spots? /]
  2784	004142'	260040	002651*		PUSHJ	P,YESNO		;Skip if "Y"
  2785	004143'	263040	000000		  POPJ	P,		;Done if "N" or no bad spots
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 57
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2786				;Output the bad spots
  2787
  2788	004144'	200640	747000*		MOVE	P2,%BAT+BATFIR	;Reset AOBJN pointer
  2789	004145'	271640	747000		ADDI	P2,%BAT
  2790	004146'	336015	004115*	TYPBT3:	SKIPN	BATNBB(P2)	;Zero marks end
  2791	004147'	254000	765241		 JRST	TYPBT9
  2792	004150'	200340	000015		MOVE	T2,P2		;Set up T2 for BAYNBB
  2793	004151'	135300	004120*		LDB	T1,BAYNBB	;Get repeat count
  2794	004152'	326300	765156		JUMPN	T1,TYPBT4	;Zero means single page
  2795	004153'	201300	766427		MOVEI	T1,[ASCIZ / 1 page  at /]
  2796	004154'	260040	004133*		PUSHJ	P,CONMES
  2797	004155'	254000	765162		JRST	TYPBT5
  2798
  2799	004156'	271300	000001	TYPBT4:	ADDI	T1,1		;Add 1 to repeat count
  2800	004157'	260040	765317		PUSHJ	P,PR2DIG	;Output leading blank if needed
  2801	004160'	201300	766432		MOVEI	T1,[ASCIZ / pages at /]
  2802	004161'	260040	004154*		PUSHJ	P,CONMES
  2803
  2804	004162'	200315	000000*	TYPBT5:	MOVE	T1,BATELB(P2)	;Get page address
  2805	004163'	260040	000000*		PUSHJ	P,PRT22A	;19-bit octal number
  2806	004164'	200315	004162*		MOVE	T1,BATELB(P2)	;Page address
  2807	004165'	242300	000002		LSH	T1,P2BLSH	;Convert to blocks
  2808	004166'	135340	000000*		LDB	T2,UNYBPY	;Blocks per cylinder
  2809	004167'	230300	000007		IDIV	T1,T2
  2810	004170'	135400	000000*		LDB	T3,UNYBPT	;Blocks per track
  2811	004171'	230340	000010		IDIV	T2,T3
  2812	004172'	135440	002606*		LDB	T4,UNYBPR	;Blocks per record
  2813	004173'	336000	000011		SKIPN	T4		;If old monitor,
  2814	004174'	201440	000001		 MOVEI	T4,1		; formatted in blocks
  2815	004175'	230400	000011		IDIV	T3,T4
  2816	004176'	271340	000001		ADDI	T2,1		;SYSTAT and ERRCHK number heads starting at 1
  2817	004177'	271400	000001		ADDI	T3,1		;Everyone numbers records starting at 1
  2818	004200'	261040	000010		PUSH	P,T3		;Record (T4 = block in record = 0)
  2819	004201'	261040	000007		PUSH	P,T2		;Head
  2820	004202'	261040	000006		PUSH	P,T1		;Cyl
  2821	004203'	201300	766435		MOVEI	T1,[ASCIZ / = cylinder/]
  2822	004204'	260040	004161*		PUSHJ	P,CONMES
  2823	004205'	262040	000006		POP	P,T1
  2824	004206'	260040	765313		PUSHJ	P,PR4DIG
  2825	004207'	201300	766440		MOVEI	T1,[ASCIZ /, head/]
  2826	004210'	260040	004204*		PUSHJ	P,CONMES
  2827	004211'	262040	000006		POP	P,T1
  2828	004212'	260040	765315		PUSHJ	P,PR3DIG
  2829	004213'	201300	766442		MOVEI	T1,[ASCIZ /, record/]	;Entire page is 1 record if in pages
  2830	004214'	331005	000000*		SKIPL	UNICHR(U)		;If formatted in blocks,
  2831	004215'	201300	766444		 MOVEI	T1,[ASCIZ /, records/]	; all 4 blocks are marked as unuseable
  2832	004216'	260040	004210*		PUSHJ	P,CONMES
  2833	004217'	200301	000000		MOVE	T1,(P)
  2834	004220'	260040	765315		PUSHJ	P,PR3DIG
  2835	004221'	262040	000006		POP	P,T1
  2836	004222'	335005	004214*		SKIPGE	UNICHR(U)	;Formatted in pages?
  2837	004223'	254000	765233		 JRST	TYPBT6		;Yes, done
  2838	004224'	201400	000055		MOVEI	T3,"-"		;No, output range of blocks
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 57-2
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2839	004225'	260040	004111*		PUSHJ	P,COMTYO
  2840	004226'	271300	000003		ADDI	T1,3		;4th block in page
  2841	004227'	135340	004170*		LDB	T2,UNYBPT
  2842	004230'	313300	000007		CAMLE	T1,T2		;If end block is past # of blocks per track
  2843	004231'	274300	000007		 SUB	T1,T2		; then it is on the next track
  2844	004232'	260040	765317		PUSHJ	P,PR2DIG	;Output ending block number
  2845	004233'	260040	765322	TYPBT6:	PUSHJ	P,SPACE3
  2846	004234'	550355	004146*		HRRZ	T2,BATNBB(P2)	;Get date
  2847	004235'	260040	765244		PUSHJ	P,TYPDAT	;Convert and output it
  2848	004236'	260040	002646*		PUSHJ	P,CRLF
  2849	004237'	252640	003151*		AOBJP	P2,CPOPJ	;Increment by 2
  2850	004240'	253640	765146		AOBJN	P2,TYPBT3	;Loop
  2851
  2852	004241'	332000	747000*	TYPBT9:	SKIPE	%BAT+BATCNT	;If any were found,
  2853	004242'	260040	004236*		 PUSHJ	P,CRLF		; output a blank link
  2854	004243'	263040	000000		POPJ	P,		;End of TYPBAT
  2855
  2856				;Routine to output the date
  2857
  2858	004244'	322340	765267	TYPDAT:	JUMPE	T2,NODATE	;Call with 14-bit TYMSHARE date in T2
  2859	004245'	201300	000000		MOVEI	T1,0		;No time-of-day
  2860	004246'	205740	400020		MOVSI	P4,400020	;Convert from TYM-GMT to DEC-local
  2861	004247'	260040	000000*		PUSHJ	P,DATCOM	;Returns 15-bit date in T2
  2862	004250'	263040	000000		  POPJ	P,		;Illegal date
  2863	004251'	231340	000564		IDIVI	T2,^D<31*12>	;T2/Year
  2864	004252'	271340	000100		ADDI	T2,^D64
  2865	004253'	261040	000007		PUSH	P,T2
  2866	004254'	231400	000037		IDIVI	T3,^D31		;T3/Month, T4/Day
  2867	004255'	261040	000010		PUSH	P,T3
  2868	004256'	201311	000001		MOVEI	T1,1(T4)
  2869	004257'	260040	765317		PUSHJ	P,PR2DIG	;Day (with leading blank if needed)
  2870	004260'	262040	000006		POP	P,T1
  2871	004261'	200306	765273		MOVE	T1,MONTAB(T1)	;"-Mmm-"
  2872	004262'	202300	765271		MOVEM	T1,DATBLK+0	;DATBLK+1 has 0 in bits 0-6
  2873	004263'	201300	765271		MOVEI	T1,DATBLK+0
  2874	004264'	260040	004216*		PUSHJ	P,CONMES	;Output month
  2875	004265'	262040	000006		POP	P,T1
  2876	004266'	324000	765317		PJRST	P,PR2DIG	;Year
  2877
  2878	004267'	201300	766446	NODATE:	MOVEI	T1,[ASCIZ /(no date)/]
  2879	004270'	324740	004264*		PJRST	CONMES
  2880
  2881	765271			DATBLK:	BLOCK	2
  2882					EXTERN	DATCOM
  2883	004273'	266254	167132	MONTAB:	ASCII/-Jan--Feb--Mar--Apr--May--Jun--Jul--Aug--Sep--Oct--Nov--Dec-/
	004274'	266154	561132
	004275'	266334	171132
	004276'	266036	071132
	004277'	266334	174532
	004300'	266256	567132
	004301'	266256	566132
	004302'	266036	563532
	004303'	266474	570132
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 57-3
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

	004304'	266374	372132
	004305'	266355	773132
	004306'	266114	561532
  2884
  2885				;Decimal output routines
  2886
  2887	004307'	305300	303240	PR6DIG:	CAIGE	T1,^D100000	;Output leading blanks if not 6 digits
  2888	004310'	260040	002126*		 PUSHJ	P,PRSPC
  2889	004311'	305300	023420	PR5DIG:	CAIGE	T1,^D10000
  2890	004312'	260040	004310*		 PUSHJ	P,PRSPC
  2891	004313'	305300	001750	PR4DIG:	CAIGE	T1,^D1000
  2892	004314'	260040	004312*		 PUSHJ	P,PRSPC
  2893	004315'	305300	000144	PR3DIG:	CAIGE	T1,^D100
  2894	004316'	260040	004314*		 PUSHJ	P,PRSPC
  2895	004317'	305300	000012	PR2DIG:	CAIGE	T1,^D10
  2896	004320'	260040	004316*		 PUSHJ	P,PRSPC##
  2897	004321'	254000	004135*		JRST	PRTDIG##
  2898
  2899	004322'	201300	766450	SPACE3:	MOVEI	T1,[ASCIZ /   /];3 blanks
  2900	004323'	324740	004270*		PJRST	CONMES
  2901
  2902	765324				VAR
  2903	765324			ONDLIT:	LIT
  2904	004324'	064250	551244
  2905	004325'	476452	320356
  2906	004326'	643234	364100
  2907	004327'	703454	573312
  2908	004330'	673504	061344
  2909	004331'	647354	764734
  2910	004332'	635016	464312
  2911	004333'	203477	171750
  2912	004334'	627324	052640
  2913	004335'	000000	000000
  2914	004336'	064250	664730
  2915	004337'	625016	372344
  2916	004340'	727076	472744
  2917	004341'	625011	642612
  2918	004342'	422464	071312
  2919	004343'	633454	571720
  2920	004344'	647354	700000
  2921	004345'	064251	544634
  2922	004346'	476444	042644
  2923	004347'	512372	251500
  2924	004350'	265010	271322
  2925	004351'	673164	071762
  2926	004352'	717514	566500
  2927	004353'	526404	060734
  2928	004354'	747574	174576
  2929	004355'	200000	000000
  2930	004356'	001600	750000*
  2931	004357'	751000	751001
  2932	004360'	751400	751401
  2933	004361'	777400	751000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 57-4
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2934	004362'	301400	000040
  2935	004363'	263040	000000
  2936	004364'	211700	000001
  2937	004365'	254000	003317*
  2938	004366'	211700	000002
  2939	004367'	254000	004365*
  2940	004370'	211700	000003
  2941	004371'	254000	004367*
  2942	004372'	201740	000001
  2943	004373'	254000	761252
  2944	004374'	064241	505202
  2945	004375'	713124	074736
  2946	004376'	725012	352644
  2947	004377'	425017	167752
  2948	004400'	203574	167350
  2949	004401'	203515	720310
  2950	004402'	675016	464322
  2951	004403'	715764	000000
  2952	004404'	064250	567350
  2953	004405'	627455	167316
  2954	004406'	203515	062500
  2955	004407'	432231	442646
  2956	004410'	203115	160730
  2957	004411'	677176	562534
  2958	004412'	271341	505100
  2959	004413'	202517	170312
  2960	004414'	201050	747504
  2961	004415'	203515	720344
  2962	004416'	627516	571334
  2963	004417'	203515	720236
  2964	004420'	472070	527000
  2965	004421'	064244	020250
  2966	004422'	747414	520104
  2967	004423'	442131	450104
  2968	004424'	203155	771100
  2969	004425'	605015	464746
  2970	004426'	721015	763100
  2971	004427'	677416	464736
  2972	004430'	673465	606424
  2973	004431'	000000	000000
  2974	004432'	064250	644630
  2975	004433'	426465	220000
  2976	004434'	201010	444646
  2977	004435'	516371	453212
  2978	004436'	203236	320346
  2979	004437'	703135	466312
  2980	004440'	621016	764750
  2981	004441'	641016	473736
  2982	004442'	201052	321312
  2983	004443'	715341	505000
  2984	004444'	064252	474740
  2985	004445'	625004	252262
  2986	004446'	502124	044212
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 57-5
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  2987	004447'	462404	220314
  2988	004450'	677444	060500
  2989	004451'	663236	372100
  2990	004452'	677144	067740
  2991	004453'	723235	767346
  2992	004454'	270321	200000
  2993	004455'	064252	474740
  2994	004456'	625004	241620
  2995	004457'	406350	742500
  2996	004460'	442131	450104
  2997	004461'	203155	771100
  2998	004462'	605015	464746
  2999	004463'	721015	763100
  3000	004464'	677416	464736
  3001	004465'	673465	606424
  3002	004466'	000000	000000
  3003	004467'	064252	474740
  3004	004470'	625004	252262
  3005	004471'	502124	072734
  3006	004472'	647505	567302
  3007	004473'	667124	044212
  3008	004474'	462404	220314
  3009	004475'	677444	060500
  3010	004476'	663236	372100
  3011	004477'	677144	067740
  3012	004500'	723235	767346
  3013	004501'	270000	000000
  3014	004502'	064252	474740
  3015	004503'	625004	241620
  3016	004504'	406350	742500
  3017	004505'	727355	172132
  3018	004506'	673035	562500
  3019	004507'	442131	450104
  3020	004510'	203155	771100
  3021	004511'	605015	464746
  3022	004512'	721015	763100
  3023	004513'	677416	464736
  3024	004514'	673465	600000
  3025	004515'	064252	474740
  3026	004516'	625004	252262
  3027	004517'	502124	071750
  3028	004520'	711335	660732
  3029	004521'	625011	042630
  3030	004522'	501044	063336
  3031	004523'	711014	120330
  3032	004524'	647476	420336
  3033	004525'	631015	770350
  3034	004526'	647375	671534
  3035	004527'	000000	000000
  3036	004530'	064252	474740
  3037	004531'	625004	241620
  3038	004532'	406350	742500
  3039	004533'	717516	226734
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 57-6
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3040	004534'	607334	520220
  3041	004535'	426312	021100
  3042	004536'	633376	220302
  3043	004537'	203315	171750
  3044	004540'	203374	620336
  3045	004541'	703515	167734
  3046	004542'	715340	000000
  3047	004543'	422364	054636
  3048	004544'	525012	740634
  3049	004545'	521011	152100
  3050	004546'	522364	041212
  3051	004547'	201425	147634
  3052	004550'	266311	147212
  3053	004551'	261011	751100
  3054	004552'	311230	447656
  3055	004553'	471764	024250
  3056	004554'	546410	520106
  3057	004555'	244321	200000
  3058	004556'	422364	054636
  3059	004557'	525012	740634
  3060	004560'	521011	152100
  3061	004561'	522364	041212
  3062	004562'	201425	153644
  3063	004563'	446510	526612
  3064	004564'	472030	246212
  3065	004565'	421304	047644
  3066	004566'	201445	153644
  3067	004567'	446510	526640
  3068	004570'	512372	442606
  3069	004571'	522130	437500
  3070	004572'	242513	150212
  3071	004573'	201065	106424
  3072	004574'	000000	000000
  3073	004575'	466232	351622
  3074	004576'	472164	047644
  3075	004577'	202231	641636
  3076	004600'	472471	151650
  3077	004601'	426352	420220
  3078	004602'	406471	020206
  3079	004603'	476352	352202
  3080	004604'	472504	043236
  3081	004605'	511012	547222
  3082	004606'	521000	000000
  3083	004607'	466232	351622
  3084	004610'	472164	047644
  3085	004611'	202231	641636
  3086	004612'	472471	151650
  3087	004613'	426352	420240
  3088	004614'	406071	320246
  3089	004615'	426504	044610
  3090	004616'	202151	751100
  3091	004617'	526351	152100
  3092	004620'	000000	000000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 57-7
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3093	004621'	064250	444646
  3094	004622'	455010	647644
  3095	004623'	466032	420210
  3096	004624'	476132	320234
  3097	004625'	476504	046602
  3098	004626'	522071	020212
  3099	004627'	542410	541650
  3100	004630'	426104	043236
  3101	004631'	512330	152100
  3102	004632'	476344	052634
  3103	004633'	446504	000000
  3104	004634'	064251	547644
  3105	004635'	425012	444202
  3106	004636'	471011	747212
  3107	004637'	202310	151650
  3108	004640'	202531	644650
  3109	004641'	202231	620246
  3110	004642'	522444	000000
  3111	004643'	064252	447636
  3112	004644'	202330	147262
  3113	004645'	202472	451116
  3114	004646'	515000	000000
  3115	004647'	267374	663330
  3116	004650'	647354	526500
  3117	004651'	201000	000000
  3118	004652'	727355	172100
  3119	004653'	627456	267744
  3120	004654'	201000	000000
  3121	004655'	613034	420314
  3122	004656'	677455	560750
  3123	004657'	201000	000000
  3124	004660'	667035	167350
  3125	004661'	627354	167306
  3126	004662'	625000	000000
  3127	004663'	243355	720310
  3128	004664'	647475	324500
  3129	004665'	201000	000000
  3130	004666'	243234	767336
  3131	004667'	713134	424500
  3132	004670'	201000	000000
  3133	004671'	064251	440646
  3134	004672'	521012	547222
  3135	004673'	521012	740646
  3136	004674'	471172	420214
  3137	004675'	476531	642100
  3138	004676'	446344	051650
  3139	004677'	511000	000000
  3140	004700'	064252	453636
  3141	004701'	202311	743622
  3142	004702'	416031	420252
  3143	004703'	472232	420000
  3144	004704'	236464	043236
  3145	004705'	526350	420222
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 57-8
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3146	004706'	471012	352244
  3147	004707'	200000	000000
  3148	004710'	064251	447616
  3149	004711'	446070	146100
  3150	004712'	526351	152100
  3151	004713'	000000	000000
  3152	004714'	202331	151646
  3153	004715'	446350	720214
  3154	004716'	512371	520246
  3155	004717'	522444	000000
  3156	004720'	064247	747236
  3157	004721'	202473	151650
  3158	004722'	426324	051650
  3159	004723'	512530	352252
  3160	004724'	512120	000000
  3161	004725'	202232	320256
  3162	004726'	512232	442500
  3163	004727'	502451	752212
  3164	004730'	416510	542000
  3165	004731'	064240	000000
  3166	004732'	202232	320236
  3167	004733'	432145	546222
  3168	004734'	472120	000000
  3169	004735'	000000*	000000*
  3170	004736'	000000*	000000*
  3171	004737'	202410	143612
  3172	004740'	202210	151210
  3173	004741'	536032	242500
  3174	004742'	512130	142100
  3175	004743'	426452	247644
  3176	004744'	000000	000000
  3177	004745'	634164	000000
  3178	004746'	202410	143612
  3179	004747'	202071	747246
  3180	004750'	446472	442634
  3181	004751'	416624	042644
  3182	004752'	512372	200000
  3183	004753'	442032	242256
  3184	004754'	406450	520256
  3185	004755'	512232	442500
  3186	004756'	426452	247644
  3187	004757'	000000	000000
  3188	004760'	202151	151246
  3189	004761'	521000	000000
  3190	004762'	202470	541636
  3191	004763'	472104	000000
  3192	004764'	000000	765762
  3193	004765'	446051	520146
  3194	004766'	315466	026542
  3195	004767'	000000	000000
  3196	004770'	315466	330132
  3197	004771'	446224	067744
  3198	004772'	201466	633552
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 57-9
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3199	004773'	000000	000000
  3200	004774'	315546	530100
  3201	004775'	677444	031554
  3202	004776'	325440	000000
  3203	004777'	446051	520306
  3204	005000'	677336	060750
  3205	005001'	647055	462400
  3206	005002'	700600	002567*
  3207	005003'	263040	000000
  3208	005004'	203535	665734
  3209	005005'	677575	620314
  3210	005006'	677455	560750
  3211	005007'	000000	000000
  3212	005010'	203155	771332
  3213	005011'	607516	462710
  3214	005012'	203235	620304
  3215	005013'	663374	365746
  3216	005014'	000000	000000
  3217	005015'	203155	771332
  3218	005016'	607516	462710
  3219	005017'	203235	620340
  3220	005020'	607174	571400
  3221	005021'	472372	420202
  3222	005022'	202411	054646
  3223	005023'	446070	146100
  3224	005024'	526351	152132
  3225	005025'	522453	120202
  3226	005026'	436031	147000
  3227	005027'	000000	766021
  3228	005030'	064250	467500
  3229	005031'	747376	520356
  3230	005032'	607356	420350
  3231	005033'	675015	167322
  3232	005034'	723234	166322
  3233	005035'	753124	072320
  3234	005036'	625010	240650
  3235	005037'	203414	163712
  3236	005040'	715015	767100
  3237	005041'	723215	171500
  3238	005042'	526351	152176
  3239	005043'	064240	000000
  3240	005044'	064252	444222
  3241	005045'	515015	171500
  3242	005046'	673376	420334
  3243	005047'	677455	560730
  3244	005050'	663624	062336
  3245	005051'	673125	420302
  3246	005052'	713124	074736
  3247	005053'	725012	352644
  3248	005054'	425761	505000
  3249	005055'	260000	000000
  3250	005056'	240000	000000
  3251	005057'	244000	000000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 57-10
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3252	005060'	064252	352244
  3253	005061'	202231	620104
  3254	005062'	516632	321100
  3255	005063'	516130	151206
  3256	005064'	441011	444646
  3257	005065'	521640	000000
  3258	005066'	064252	547222
  3259	005067'	522464	047236
  3260	005070'	521011	147100
  3261	005071'	405010	644630
  3262	005072'	425012	352244
  3263	005073'	526072	452644
  3264	005074'	425641	505000
  3265	005075'	472130	542246
  3266	005076'	202450	543244
  3267	005077'	426471	044634
  3268	005100'	435000	000000
  3269	005101'	350000	000000
  3270	005102'	466231	620172
  3271	005103'	200000	000000
  3272	005104'	202330	154100
  3273	005105'	365000	000000
  3274	005106'	064252	640630
  3275	005107'	526124	047236
  3276	005110'	521011	147100
  3277	005111'	502132	246622
  3278	005112'	522510	542100
  3279	005113'	512031	643612
  3280	005114'	000000	000000
  3281	005115'	064250	344202
  3282	005116'	472170	520256
  3283	005117'	446311	420206
  3284	005120'	406532	342500
  3285	005121'	516512	220250
  3286	005122'	475011	642612
  3287	005123'	421012	242614
  3288	005124'	512132	344222
  3289	005125'	472160	000000
  3290	005126'	064252	547222
  3291	005127'	521011	142100
  3292	005130'	446464	000000
  3293	005131'	064253	242644
  3294	005132'	475012	547222
  3295	005133'	521011	142100
  3296	005134'	265011	642656
  3297	005135'	202230	420234
  3298	005136'	426130	442610
  3299	005137'	000000	000000
  3300	005140'	000000	020002
  3301	005141'	502030	742646
  3302	005142'	202151	751100
  3303	005143'	416450	151620
  3304	005144'	272470	153100
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 57-11
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3305	005145'	365000	000000
  3306	005146'	260040	763652
  3307	005147'	215011	743100
  3308	005150'	502030	742646
  3309	005151'	202031	446236
  3310	005152'	536130	420214
  3311	005153'	476444	047654
  3312	005154'	426450	451202
  3313	005155'	535012	042644
  3314	005156'	202532	342644
  3315	005157'	201724	000000
  3316	005160'	446353	420000
  3317	005161'	516512	220302
  3318	005162'	663454	560710
  3319	005163'	745014	574322
  3320	005164'	717516	300000
  3321	005165'	000000	766161
  3322	005166'	064252	467736
  3323	005167'	203334	167362
  3324	005170'	203155	166312
  3325	005171'	203476	471352
  3326	005172'	617516	571312
  3327	005173'	715024	020236
  3328	005174'	673317	120336
  3329	005175'	673124	060730
  3330	005176'	663376	762710
  3331	005177'	204321	200000
  3332	005200'	523636	062500
  3333	005201'	673035	562746
  3334	005202'	203374	620340
  3335	005203'	643636	364706
  3336	005204'	607304	072734
  3337	005205'	647516	320322
  3338	005206'	671012	352244
  3339	005207'	261014	574350
  3340	005210'	713024	041644
  3341	005211'	203575	062734
  3342	005212'	203115	767312
  3343	005213'	000000	000000
  3344	005214'	302715	003756*
  3345	005215'	254000	764320
  3346	005216'	254000	764263
  3347	005217'	064252	567322
  3348	005220'	721014	166344
  3349	005221'	627034	474500
  3350	005222'	647344	063322
  3351	005223'	663124	071750
  3352	005224'	713534	372352
  3353	005225'	713121	505000
  3354	005226'	260040	764345
  3355	005227'	260040	764343
  3356	005230'	427356	462744
  3357	005231'	203535	664750
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 57-12
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3358	005232'	203354	166712
  3359	005233'	203515	720302
  3360	005234'	623100	000000
  3361	005235'	522210	152100
  3362	005236'	727355	172100
  3363	005237'	647464	060730
  3364	005240'	713134	162362
  3365	005241'	203235	620302
  3366	005242'	203476	471352
  3367	005243'	617516	571312
  3368	005244'	000000	000000
  3369	005245'	523214	520246
  3370	005246'	546472	442632
  3371	005247'	203476	471352
  3372	005250'	617516	571312
  3373	005251'	203214	171500
  3374	005252'	673376	420304
  3375	005253'	627135	620210
  3376	005254'	426151	147212
  3377	005255'	421017	162750
  3378	005256'	000000	000000
  3379	005257'	417035	667336
  3380	005260'	721014	162310
  3381	005261'	203535	664750
  3382	005262'	203515	720346
  3383	005263'	723456	561750
  3384	005264'	727454	500000
  3385	005265'	523214	520346
  3386	005266'	723456	561750
  3387	005267'	727454	520256
  3388	005270'	406464	047236
  3389	005271'	521016	372706
  3390	005272'	617136	371714
  3391	005273'	727315	474500
  3392	005274'	713134	671312
  3393	005275'	717214	562134
  3394	005276'	000000	000000
  3395	005277'	427356	462744
  3396	005300'	203114	172312
  3397	005301'	203036	320232
  3398	005302'	465330	442132
  3399	005303'	546633	154500
  3400	005304'	000000	000000
  3401	005305'	427356	462744
  3402	005306'	203515	166712
  3403	005307'	203036	320220
  3404	005310'	442331	520000
  3405	005311'	064250	451626
  3406	005312'	416311	620332
  3407	005313'	677114	520322
  3408	005314'	715644	000000
  3409	005315'	566554	540000
  3410	005316'	422471	341630
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 57-13
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3411	005317'	471015	567710
  3412	005320'	625014	462746
  3413	005321'	647454	562176
  3414	005322'	200000	000000
  3415	005323'	064250	260710
  3416	005324'	203135	672344
  3417	005325'	745644	052362
  3418	005326'	703124	023614
  3419	005327'	526311	423530
  3420	005330'	201170	640646
  3421	005331'	521165	420116
  3422	005332'	472371	642516
  3423	005333'	064244	067744
  3424	005334'	203256	571750
  3425	005335'	201712	262750
  3426	005336'	727455	637100
  3427	005337'	633376	220310
  3428	005340'	627154	172730
  3429	005341'	721005	047236
  3430	005342'	202071	040634
  3431	005343'	436125	100000
  3432	005344'	064251	462702
  3433	005345'	733235	663500
  3434	005346'	723214	520214
  3435	005347'	446310	551500
  3436	005350'	623234	166336
  3437	005351'	637534	527134
  3438	005352'	270000	000000
  3439	005353'	201300	753000
  3440	005354'	260040	002760*
  3441	005355'	254000	764742
  3442	005356'	472531	541212
  3443	005357'	511011	743100
  3444	005360'	516032	420240
  3445	005361'	416052	320172
  3446	005362'	200000	000000
  3447	005363'	472531	541212
  3448	005364'	511011	743100
  3449	005365'	512230	220240
  3450	005366'	416052	320172
  3451	005367'	200000	000000
  3452	005370'	523636	062500
  3453	005371'	727355	172100
  3454	005372'	673035	562500
  3455	005373'	723364	071312
  3456	005374'	633454	571720
  3457	005375'	202050	152100
  3458	005376'	703034	762746
  3459	005377'	201000	000000
  3460	005400'	523636	062500
  3461	005401'	727355	172100
  3462	005402'	673035	562500
  3463	005403'	200000	000000
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 57-14
ONCDSK.MAC	 4-DEC-87 15:51		CHECK ON DISK CAPACITY

  3464	005404'	201005	061736
  3465	005405'	727356	471500
  3466	005406'	623364	067336
  3467	005407'	721014	163744
  3468	005410'	627125	100000
  3469	005411'	203054	162100
  3470	005412'	703034	762746
  3471	005413'	203235	620000
  3472	005414'	203115	171750
  3473	005415'	647354	372100
  3474	005416'	713134	764736
  3475	005417'	673465	600000
  3476	005420'	423364	074736
  3477	005421'	725016	760734
  3478	005422'	721014	120330
  3479	005423'	647476	420336
  3480	005424'	631014	260710
  3481	005425'	203476	067750
  3482	005426'	715764	000000
  3483	005427'	201424	070302
  3484	005430'	637124	020302
  3485	005431'	721000	000000
  3486	005432'	203414	163712
  3487	005433'	715014	172100
  3488	005434'	000000	000000
  3489	005435'	201724	061762
  3490	005436'	663235	662312
  3491	005437'	710000	000000
  3492	005440'	261015	062702
  3493	005441'	620000	000000
  3494	005442'	261016	262706
  3495	005443'	677454	400000
  3496	005444'	261016	262706
  3497	005445'	677454	471400
  3498	005446'	243355	720310
  3499	005447'	607514	524400
  3500	005450'	201004	000000
  3501
  3502
  3503			005452	ONDLNR==.-%OND+1
  3504			006000	ONDLNP==<ONDLNR!777>+1
  3505
  3506				ONSZCK(ONCDSK,OND)	;CHECK TO SEE IF ENOUGH PAGES ALLOCATED
  3507
  3508	005451'			DEPHASE
  3509
  3510	005451'			ONDEND:	END		;Cannot use $END in PHASEd code
  3511
NO ERRORS DETECTED
PROGRAM BREAK IS 005451
11K CORE USED
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 58
ONCDSK.MAC	 4-DEC-87 15:51		SYMBOL TABLE

AB.ACK		000000	EXT	CMDSC3		761237		DCNYOP		761004	INT	GETHOM		763354	INT
AB.CVR		000266'	EXT	CMDSC4		761252		DCNYUR		761006	INT	GETLIN		003647'	EXT
AB.NAK		000242'	EXT	CMDSC5		761256		DCSIZ		000003	SPD	GETPEV		002437'	EXT
AB.TCV		000273'	EXT	CMDSCF		761307	INT	DCXX		000006	SPD	GETRAN		764622	
AB.VER		000264'	EXT	CMDSCN		761211	INT	DDBLEN		000000	EXT	GETSRB		761177	
ADDNOT		764513		CMPLOG		003476'	EXT	DDSTAR		003532'	EXT	GETUNI		763665	
ADDUN2		764436		CNTADS		764541		DDTX		000362'	EXT	HLPCHG		762234	
ADDUN4		764473		CODBAT		002364'	EXT	DECIN		003604'	EXT	HLPFIL		761322	
ADDUN5		764500		CODHOM		002355'	EXT	DECLOP		763624	INT	HLPSRP		762433	
ADDUN7		764504		CODRIB		000203'	EXT	DEVIOS		000002	SIN	HLPTY1		761323	
ADDUNI		764422		COMDAS		003575'	EXT	DIE		000000'	EXT	HLPTYP		762051	
ADUNT		764460		COMTMS		003613'	EXT	DISST1		764376		HLPUIP		762362	
ASKQMM		764056	INT	COMTYO		004225'	EXT	DISST2		764404		HMBOK		762727	
ASKQUE		763650		CONCHK		763416		DSKCPY		763561		HMBOK2		762735	
ASKRP1		764132		CONMES		004323'	EXT	DSKDDB		000000	EXT	HMBOK3		762754	
ASKRPQ		764126		CONOUT		763645		DSKPIF		002562'	EXT	HOMDAT		000000	EXT
ASKRPT		764065		CORZER		005354'	EXT	DSKPIN		005002'	EXT	HOMDCT		000000	EXT
BADDIS		762033		CPOPJ		004237'	EXT	DSKPPU		002013'	EXT	HOMDCV		001761'	EXT
BATBAD		763770		CPOPJ1		004371'	EXT	DSPCHG		762241		HOMEND		000000	EXT
BATCNT		000000	EXT	CPUF3		000004	SPD	DSPDSK		764665		HOMFEP		000000	EXT
BATELB		004164'	EXT	CPUKI		000001	SPD	DSPFIL		761352		HOMHID		000000	EXT
BATFIR		000000	EXT	CPUKL		000002	SPD	DSPSRP		762442		HOMHSH		000000	EXT
BATMAN		763771		CPUKS		000003	SPD	DSPTYP		762056		HOMLOG		000000	EXT
BATNBB		004234'	EXT	CPUTYP		000002	SPD	DSPUIP		762371		HOMLUN		000000	EXT
BATPAT		000000	EXT	CPYFLG		763560		EPT		000000	EXT	HOMMFD		000000	EXT
BATREF		763757		CPYMSG		763554		EPTLTB		000511	SIN	HOMNXT		000000	EXT
BATREG		002764'	EXT	CPYWAT		763572		ERRHM2		763227		HOMOVR		000000	EXT
BAYNBB		004151'	EXT	CPZZ		000000	SPD	ERRHOM		763226		HOMP4C		000000	EXT
BRMAX		000000	EXT	CRESTT		763055		EVASIZ		000315'	EXT	HOMPRV		000000	EXT
CANTAD		764515		CRLF		004242'	EXT	EVMALC		002062'	EXT	HOMRAN		000000	EXT
CCOD		000000	EXT	CRLFOP		763646		F		000004	INT	HOMREF		000000	EXT
CH7		000000	EXT	CTEXT		003214'	EXT	FILCMD		761325		HOMSAT		000000	EXT
CHGBAT		765056		CTYDO		000270'	EXT	FILGO		764724		HOMSNM		000000	EXT
CHGCMD		761325		CWCOD		002565'	EXT	FILHL1		761343		HOMSPU		000000	EXT
CHGHL1		762230		DATBLK		765271		FILHLP		761342		HOMSUF		000000	EXT
CHGHLP		762227		DATCOM		004247'	EXT	FILMAN		761012	INT	ICPFAC		000000	EXT
CHGHOM		764730		DBLSTD		764136		FILOPT		761312	INT	INLMES		001556'	EXT
CHGIT		762220		DC.SIZ		000003	SIN	FIROK		763372		INSERT		763043	
CHGRPC		765044		DCFAST		000052'	EXT	FLGDN1		762651		IOSEL		002570'	EXT
CHGSPC		765027		DCN		003717'	EXT	FLGDN2		762657		J		000002	INT
CHGSTR		764234		DCN.DF		010000	SIN	FLGDN3		762661		JFYSEC		000000	EXT
CHKANS		764111		DCN.HM		020000	SIN	FLGDN4		762662		KEPSAM		764124	
CHKBAT		763735		DCN.MN		040000	SIN	FLGDN5		762671		KNNUNI		764073	
CHKFLG		763434		DCN.ON		200000	SIN	FLGDWN		762650		KNOUNI		764143	
CHKHOM		762715		DCN.OP		400000	SIN	FNDSTR		763260		KONCPY		000000	EXT
CHKUN1		763214		DCN.UR		100000	SIN	FNDUN1		763700		KONDWN		001643'	EXT
CHKUNI		763175		DCNDFT		030000	SIN	FNDUNI		763677		KONLTM		000000	EXT
CLRDDB		001602'	EXT	DCNTAB		761004		FSTERR		763502		KONTOK		762645	
CLRSND		002643'	EXT	DCNUM		000006	SPD	FTYUNI		764154		KONUPA		001631'	EXT
CLRSTR		764410		DCNYDF		761011	INT	GETBAT		763361	INT	KOPDWN		001642'	EXT
CMDMSG		761306		DCNYHM		761010	INT	GETDAT		764544		LI.PIN		000200	SPD
CMDSC1		761227		DCNYMN		761007	INT	GETDT1		764551		LINKIT		763035	
CMDSC2		761233		DCNYON		761005	INT	GETDT2		764577		LINKT1		763041	
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 58-2
ONCDSK.MAC	 4-DEC-87 15:51		SYMBOL TABLE

LIT$0		764707	SPD	NOSTR		763047		PJRST	324740	000000		REONCE		761003	INT
LIT$1		764707	SPD	NOTPRV		762756		PR2DIG		765317		REPSID		001745'	EXT
LIT$10		761633	SPD	NTISTR		763054		PR3DIG		765315		RETFIX		764114	
LIT$11		761704	SPD	NULCHG		762234		PR4DIG		765313		RIBEXT		000000	EXT
LIT$12		761753	SPD	NULDSK		764656		PR5DIG		765311		RIBLST		000075'	EXT
LIT$13		761767	SPD	NULFIL		761325		PR6DIG		765307		RIBNAM		002420'	EXT
LIT$14		762007	SPD	NULSRP		762433		PRCOL		002131'	EXT	RIBPFS		000070'	EXT
LIT$2		764707	SPD	NULTYP		762051		PRNAME		004107'	EXT	RWRHOM		764726	
LIT$3		764707	SPD	NULUIP		762362		PRNAMF		002141'	EXT	S$ENTR	777777	777775	SIN
LIT$4		764707	SPD	OCONM		003645'	EXT	PRSPC		004320'	EXT	S$HALT	777777	777777	SIN
LIT$5		764707	SPD	OCTIN		002254'	EXT	PRT22A		004163'	EXT	S$NAME		761000	SPD
LIT$6		764707	SPD	OFLTAB		763146		PRTDIG		004321'	EXT	S$NONA		000000	SIN
LIT$7		764707	SPD	OHTINI		002533'	EXT	QSTSTD		764120		S$TEMP		000000	SPD
LNGMES		762544	INT	OHTNUM		002551'	EXT	RADX10		002635'	EXT	S$XCT	777777	777776	SIN
LNGMS1		762545		OLDST0		762773		RANHOM		763230		SATCNT		000141'	EXT
LP2BAT		004736'	EXT	OLDST1		762775		RANNO		003627'	EXT	SAVE4		003546'	EXT
LP2HOM		004735'	EXT	OLDST2		762767		RBINDX		000000	EXT	SCNBAT		000000	EXT
LPNBAT		000000	EXT	OLDST4		762777		RBLVPR		000000	EXT	SCNCHG		762247	
LPNHOM		000000	EXT	OLDST5		763007		RBLVSP		000000	EXT	SCNDSK		764677	
LSTRED		763173		OLDST6		763001		RBMASK		000000	EXT	SCNFIL		761371	
LSTUNI		763030		OLDST8		763011		RBREAL		002442'	EXT	SCNSD2		763221	
MANCM1		761017		OLDSTR		762757		RBSPAR		000000	EXT	SCNSRP		762450	
MANCOM		761020		ONCDDB		001603'	EXT	RBYPNO		002445'	EXT	SCNST2		763165	
MANOK		761027		ONCDSK		761000	ENT	RBYUN1		000103'	EXT	SCNSTD		763217	
MANOK1		761043		ONCMOD		000000'	ENT	RBYUN4		000000	EXT	SCNSTR		763154	
MANOK2		761056		ONDEND		005451'		RBYUNI		002443'	EXT	SCNTYP		762067	
MANQST		761024		ONDLIT		765324		RDBAT1		763726		SCNUIP		762375	
MANREF		761022		ONDLNP		006000	SIN	RDBAT6		763732		SCNUN1		763071	
MAX		764141	INT	ONDLNR		005452	SIN	RDBNON		763405		SCNUNI		762623	
MAYREF		764144		ONDSTT		000000'	INT	RDBOTH		763370		SETBAT		763363	
MCKKON		763235		OPAGIN		763520	INT	RDBSKP		763404		SETCHG		763652	
MFDRIB		002315'	EXT	OPAGIO		763525		RDCHEK		763407		SETDDO		001605'	EXT
MIN		764142	INT	OPAGOT		763523	INT	RDHOM1		762614		SETPRV		763662	
MISUNI		763205		OPOUT		004070'	EXT	RDHOM2		762617		SETPUB		763657	
MO.TON		002000	SPD	OVRDEF		764350		RDHOME		762556		SETRAN		764617	
MONTAB		765273		P		000001	INT	RDRBS2		761072		SETUNT		763104	
MOVSTR		763304		P1		000014	INT	RDRBS3		761075		SETUTS		763113	
MOVUNI		763265		P2		000015	INT	RDSATS		761120		SIZCHG		000004	SPD
MSGLNG		763326		P2BLSH		000002	SPD	RDST45		761135		SIZDSK		000010	SPD
MSGSAV		764135		P3		000016	INT	RDSTS1		761122		SIZFIL		000015	SPD
MSGSTR		763336		P4		000017	INT	RDSTS4		761123		SIZOND		000007	SIN
MSGUNI		763345		P4CDEF		764360		RDSTS5		761153		SIZSRP		000004	SPD
MTR		000024	SPD	PAGCOD		002422'	EXT	RDSTS6		761165		SIZTYP		000007	SPD
NAMFLO		763343		PAGIN		002520'	EXT	RDTIME	702040	000000		SIZUIP		000002	SPD
NASTYP		763237		PAGNAM		002421'	EXT	RDWMSG		763465		SPACE3		765322	
NLSUNI		763033		PAGOUT		002523'	EXT	RE.DCD		001750'	EXT	SPCDK1		764644	
NMRBPC		004054'	EXT	PAGSLF		002446'	EXT	REDBAT		763724		SPCDKN		764632	
NMSTPC		004037'	EXT	PAKREF		003471'	EXT	REDERR		763515		SPCDKP		764717	
NODATE		765267		PCBPAG		002530'	EXT	REDSEC		763377		SPDKHP		764657	
NODIE		000000	EXT	PCISTS		002544'	EXT	REFLAG		000034'	EXT	SPSNAM		763636	
NOERH		763517		PG		000003	INT	REFRSH		003533'	EXT	SPUCLC		764162	
NOREF		764040		PGYERR		002547'	EXT	REFSAV		763705		SPUNAM		763637	
NOSTR		763047		PGYPNO		002534'	EXT	REONCE		761003	INT	SRPCMD		761325	
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88 PAGE 58-3
ONCDSK.MAC	 4-DEC-87 15:51		SYMBOL TABLE

SRPHL1		762427		T4		000011	INT	UNICHR		004222'	EXT	%BAT.P		002366'	EXT
SRPHLP		762426		THSDAT		003544'	EXT	UNICK1		764345		%D	777777	017000'	SPD
SRPNDS		000054'	EXT	TPOPJ		002623'	EXT	UNIDES		003732'	EXT	%HOM		753000	SIN
SRPREF		000032'	EXT	TRYKON		762631		UNIERR		000000	EXT	%HOM.P		002357'	EXT
STDREA		002521'	EXT	TSTCHK		763430		UNIFEP		002302'	EXT	%OFLER		000001	SIN
STDWRT		002524'	EXT	TSTSUP		000363'	EXT	UNIHID		004106'	EXT	%OFLFM		000002	SIN
STOUN1		763620		TXTCHG		762337		UNIKON		002561'	EXT	%OFLIG		000005	SIN
STOUNI		763616		TXTDSK		764707		UNILOG		004102'	EXT	%OFLMT		000003	SIN
STRBTS		000000	EXT	TXTFIL		762016		UNINAM		004076'	EXT	%OFLRS		000004	SIN
STRDDB		003422'	EXT	TXTSRP		762535		UNIONC		002574'	EXT	%OND		761000	SIN
STRFIX		763005	INT	TXTTYP		762211		UNIPPU		003436'	EXT	%STA		751000	SIN
STRHSH		001771'	EXT	TXTUIP		762413		UNISTR		003761'	EXT	%STA.P		000146'	EXT
STRLEN		000000	EXT	TYPALL		764052		UNISTS		002572'	EXT	%STR		750000	SIN
STRNAM		003753'	EXT	TYPBAT		765066		UNISTT		002063'	EXT	%STR.P		000205'	EXT
STRNXT		000000	EXT	TYPBT1		765115		UNISYS		003733'	EXT	
STROVR		003774'	EXT	TYPBT2		765124		UNITAL		000162'	EXT	
STRP4C		003776'	EXT	TYPBT3		765146		UNITID		764177		
STRPID		000000	EXT	TYPBT4		765156		UNITST		764170		
STRPPU		003437'	EXT	TYPBT5		765162		UNPCHG		003726'	EXT	
STRREF		003766'	EXT	TYPBT6		765233		UNPHWP		002747'	EXT	
STRSID		000000	EXT	TYPBT9		765241		UNPMSB		002275'	EXT	
STRTAL		000000	EXT	TYPCMD		761325		UNPOFL		002725'	EXT	
STRTCH		764222		TYPDAT		765244		UNPPRV		003375'	EXT	
STRTOV		764236		TYPDEC		763633		UNTLEN		000000	EXT	
STRTPA		762541		TYPHL1		762045		UNTTBL		003461'	EXT	
STRUNI		005214'	EXT	TYPHLP		762044		UNVRSF		000154'	EXT	
STRUNM		003473'	EXT	TYPIT		762035		UNYBPR		004172'	EXT	
STSDEF		764247		TYPMSN		763627		UNYBPT		004227'	EXT	
STSDSL		764370		TYPNS1		764016		UNYBPY		004166'	EXT	
STSFIN		764320		TYPNS2		764023		UNYKTP		003325'	EXT	
STSINS		764274		TYPONL		764140	INT	UNYLN1		002035'	EXT	
STSNE1		764260		TYPRPC		765041		UNYLUN		004002'	EXT	
STSNE2		764263		TYPSPC		765024		UNYPUN		002124'	EXT	
STSNEW		764254		TYPSR1		764012		UNYSPU		004004'	EXT	
STSNXT		764267		TYPSRP		762420		UNYUTP		002602'	EXT	
STSREF		764520		TYPST1		764046		UPDHM1		764757		
STSUN2		764300		TYPSTR		764030		UPDHM2		764765		
STTFPC		000142'	EXT	TYPSYS		764006		UPDHM3		765000		
STTLEN		002057'	EXT	TYPUI0		763117		UPDHM4		765017		
STTPTR		000144'	EXT	TYPUI1		763143		UPDHOM		764736		
SVMOT2		763641		TYPUID		763120		VALSAV		764137		
SVMOTE		763642		TYPUIP		762343		WCKUNI		762702		
SVMOUT		763644		TYPUN1		763773		WHICH		763516		
SVOTAC		763706		TYPUNI		763772		WRPI	700600	000000		
SVP2		761310		TYPUNS		764013		WRPUNM		763231		
SVU		761311		U		000005	INT	WRTRN1		763441		
SYSBTS		000364'	EXT	UFDHSI		003521'	EXT	WTBOTH		763435	INT	
SYSRIB		002312'	EXT	UIPHL1		762356		WTCHEK		763456		
SYSSIZ		000000	EXT	UIPHLP		762355		YESNO		004142'	EXT	
SYSUNI		003727'	EXT	UIPSVU		762354		$XZ		000010	SPD	
T1		000006	INT	UNCHKA		762415		%%ZZQ		763146	SPD	
T2		000007	INT	UNICHK		764343		%BAT		747000	SIN	

ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

AB.ACK	   312%	   568	   569	   575	   576	   578	   579	   657	   713	   759	   819
AB.CVR	   312%	   400
AB.NAK	   312%	   379	   567	   570	   571	   572	   573	   574	   577	   651	   652	   653	   654	   655
	   656	   710	   711	   712	   758	   816	   817	   818	  2593	  2594	  2595	  2596	  2597	  2598
	  2599	  2600
AB.TCV	   312%	   405	   758	   816	   817	   818
AB.VER	   312%	   398	   567	   570	   572	   573	   574	   575	   576	   577	   710	   711	   712	   758
	   816	   817	   818
ADDNOT	  2321	  2380#
ADDUN2	  2328	  2334#
ADDUN4	  2355	  2363#
ADDUN5	  2368#	  2371
ADDUN7	  2369	  2372#
ADDUNI	   515	  2319#
ADUNT	  2347	  2352#
ASKQMM	    13	  1930#	  2103	  2124	  2707	  2723
ASKQUE	   127	  1710#	  1826	  1831
ASKRP1	  1954	  1956	  1978#
ASKRPQ	  1959	  1973#
ASKRPT	  1937#	  1980
BADDIS	   516	   581#
BATBAD	  1813	  1818	  1845#
BATCNT	    27%	  2772	  2852
BATELB	    37%	  2804	  2806
BATFIR	    37%	  1841	  2760	  2788
BATMAN	   111	   431	  1819	  1848#	  2394	  2745
BATNBB	    37%	  2763	  2790	  2846
BATPAT	    27%	  2771
BATREF	  1835#	  2735
BATREG	    37%	  1840
BAYNBB	    37%	  2766	  2793
BRMAX	    33%	  1839
CANTAD	  2325	  2326	  2336	  2362	  2383#
CCOD	    41%
CH7	    62%
CHGBAT	   695	  2730#
CHGCMD	   445#	   665	   670
CHGHL1	   667#	   669
CHGHLP	   666#	   696
CHGHOM	  2615#	  2619
CHGIT	   514	   659#
CHGRPC	   694	  2717#
CHGSPC	   693	  2701#
CHGSTR	  2107#	  2127
CHKANS	  1957#	  1968	  1971
CHKBAT	  1788	  1812#	  2746
CHKFLG	  1452	  1459	  1469	  1471	  1475#
CHKHOM	   943	   953	   957#
CHKUN1	  1185	  1188	  1196#
CHKUNI	  1177#	  1197
CLRDDB	    41%	   257	   859
CLRSND	    34%	  1311	  1547	  1687	  1704
CLRSTR	   864	  2157	  2277	  2294#
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

CMDMSG	   396	   420#
CMDSC1	   358	   368#
CMDSC2	   372#	   375
CMDSC3	   376#	   389
CMDSC4	   380	   384	   386	   388#
CMDSC5	   377	   392#
CMDSCF	    13	   357	   421#	   457	   586	   661	   718	   767	  2547
CMDSCN	    13	   349#	   458	   587	   662	   719	   768	  2548
CMPLOG	    34%	  2186	  2366
CNTADS	  2400	  2406#
CODBAT	    38%	  1384
CODHOM	    38%	  1349
CODRIB	    38%	   278
COMDAS	  2435%	  2435
COMTMS	  2449%	  2449
COMTYO	    33%	   830	  2751	  2755	  2759	  2839
CONCHK	  1456	  1460#
CONMES	    28%	   117	  1140%	  1140	  1240	  1556	  1562	  1657	  1691	  1706	  1854	  1858	  1862	  1906
	  2076	  2731	  2741	  2773	  2777	  2796	  2802	  2822	  2826	  2832	  2874	  2879	  2900
CONOUT	   430	  1243	  1665	  1706#	  1869	  1976	  2004	  2147	  2154	  2162	  2180	  2323	  2330	  2381
	  2385	  2408	  2556
CORZER	    29%	   962	  1836	  2640
CPOPJ	    31%	   829	  1664	  1883	  1999	  2001	  2849
CPOPJ1	    31%	   355	   362	   366	   397	   399	   404	   409	   417	  1249	  1620	  1743	  1749	  2198
CPUF3	   900	  2480	  2515
CPUKI	  1627	  1648	  2480	  2515
CPUKL	  1627	  1648	  2467	  2468	  2513	  2514
CPUKS	  2467	  2473	  2513
CPUTYP	   900	  1627	  1648	  2467	  2468	  2473	  2480	  2513	  2514	  2515
CPYFLG	  1632#	  1653
CPYMSG	  1628#	  1656
CPYWAT	  1645#	  1646
CPZZ	   900#	   900	  1627#	  1627	  1648#	  1648	  2467#	  2467	  2468#	  2468	  2473#	  2473	  2480#	  2480
	  2513#	  2513	  2514#	  2514	  2515#	  2515
CRESTT	  1066	  1078#
CRLF	    28%	  1707	  2848	  2853
CRLFOP	  1094	  1095	  1123	  1241	  1323	  1563	  1684	  1707#	  1872	  1909	  2020	  2079	  2540	  2781
CTEXT	    28%	   350	  1738	  2084
CTYDO	   402%	   402
CWCOD	    41%	  1640
DATBLK	  2872	  2873	  2881#
DATCOM	  2861	  2882%
DBLSTD	   453	  1937	  1962	  1965	  1975	  1977	  1983#	  1997	  2209	  2213
DC.SIZ	    92
DCFAST	   151%	   151
DCN	    60%	    94	    95	    96	    97	    98	    99	   157	   992	  1003	  2535	  2604
DCN.DF	    99#	   100	   108	   149	  2537
DCN.HM	    98#	    99	   108	  1001
DCN.MN	    97#	    98	   984	   991
DCN.ON	    95#	    96	  2534
DCN.OP	    94#	    95
DCN.UR	    96#	    97	   984	   990
DCNDFT	   107	   108#
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

DCNTAB	    94#	  2606
DCNUM	    94#	    94	    95	    96	    97	    98	    99
DCNYDF	    99#	   100
DCNYHM	    98#	    99	   994	   999
DCNYMN	    97#	    98
DCNYON	    95#	    96	   155	   156	  2550	  2607
DCNYOP	    94#	    95
DCNYUR	    96#	    97
DCSIZ	    92#	    94	    95	    96	    97	    98	    99
DCXX	    94#	    94	    95	    95#	    96	    96#	    97	    97#	    98	    98#	    99	    99#	   100	   100#
DDBLEN	    38%
DDSTAR	    38%	   256	   858	   861	  1411	  2398
DDTX	   520%	   520
DECIN	    28%	  1952	  2420	  2425	  2429	  2442
DECLOP	    13	  1682#	  1931	  1943	  1949	  2699	  2715
DEVIOS	   856
DIE	    69	    69%	    70
DISST1	  2271#	  2276
DISST2	  2269	  2277#
DSKCPY	   905	  1635#
DSKDDB	    28%	   856
DSKPIF	  1636%	  1636
DSKPIN	  1638%	  1638	  1642%	  1642
DSKPPU	  1029%	  1029
DSPCHG	   664	   693#	   697
DSPDSK	  2575#	  2583
DSPFIL	   460	   512#	   525
DSPSRP	   770	   800#	   804
DSPTYP	   589	   625#	   632
DSPUIP	   722	   749#	   751
EPT	  2469%	  2470
EPTLTB	  2470
ERRHM2	   874	  1206	  1211#	  1320	  1330	  1702
ERRHOM	   873	  1204	  1210#	  1319	  1329	  1703
EVASIZ	    40%	   432
EVMALC	  1083%	  1083
F	   256	   858	  1411	  1759	  1767	  2398
FILCMD	   448#	   455	   461	   466	   723	   730	  1921
FILGO	   523	  2610#
FILHL1	   463#	   465
FILHLP	   462#	   524
FILMAN	    12	   111#	   119
FILOPT	    12	   118	   427#
FIROK	  1413#	  1425
FLGDN1	   912#	   916
FLGDN2	   914	   919#
FLGDN3	   917	   921#
FLGDN4	   922#	   925
FLGDN5	   929#	   932
FLGDWN	   879	   896	   911#
FNDSTR	   360	   977	  1265#	  2144
FNDUN1	  1748#	  1751
FNDUNI	   363	  1741	  1747#
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

FSTERR	  1552	  1555#
FTYUNI	  1939	  2015#	  2069
GETBAT	    14	  1371#	  1814
GETDAT	  2388	  2410#
GETDT1	  2415#	  2419	  2421	  2422	  2426	  2427	  2430	  2431	  2436
GETDT2	  2437#	  2441	  2443	  2444	  2450
GETHOM	    14	   274	   957	  1348#	  2638
GETLIN	    28%	   454	  1244	  1736	  1950	  2082	  2418	  2440	  2544
GETPEV	    36%	  1460	  1499
GETRAN	   351	  2512#
GETSRB	   162	   274#
GETUNI	  1736#	  1745	  2166	  2324	  2733	  2743
HLPCHG	   663	   672#
HLPFIL	   438#	   459	   509	   510
HLPSRP	   769	   778#	   797	   798
HLPTY1	   441#	   583	   601	   675	   737	   783
HLPTYP	   588	   598#
HLPUIP	   720	   732#	   746	   747
HMBOK	   959	   971#
HMBOK2	   977#
HMBOK3	   987	   993#
HOMDAT	    43%	  2681	  2684	  2688
HOMDCT	    60%	   993	  1002
HOMDCV	    60%	  1000
HOMEND	    43%	  2680	  2686	  2687
HOMFEP	    45%	  1284
HOMHID	    44%	  1274	  2645
HOMHSH	    43%	  1004	  2666
HOMLOG	    44%	  1272	  2675
HOMLUN	    44%	  1276	  2677
HOMMFD	    43%	  1296
HOMNXT	    44%	  1034	  2649
HOMOVR	    44%	  1302	  2670
HOMP4C	    44%	  1291	  2672
HOMPRV	    45%	  2661
HOMRAN	    43%	   985	  1014	  2668
HOMREF	    45%	  1304	  2664
HOMSAT	    45%	   276
HOMSNM	    45%	   975	  1071	  1289	  2652
HOMSPU	    45%	  1278	  2679
HOMSUF	    27%	  1293
ICPFAC	    39%
INLMES	    33%	   852%	   852
INSERT	  1058	  1062#
IOSEL	    41%	  1643
J	   876	   877	   878	   880	   882	   895	  1635	  1761	  1765	  2413	  2414	  2451
JFYSEC	    39%
KEPSAM	  1951	  1970#
KNNUNI	  1940	  1943#
KNOUNI	   452	  1988#	  2015	  2019	  2222	  2226
KONCPY	    39%
KONDWN	    39%	   895
KONLTM	    39%
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

KONTOK	   881	   884	   899#
KONUPA	    39%	   878	   882
KOPDWN	    39%	   894
LI.PIN	   857
LINKIT	  1056#	  1061
LINKT1	  1054	  1060#
LISTSN	     3	     6
LIT$0	   540#	   567	   641#	   651	   703#	   710	   755#	   758	   810#	   816	  2593#	  2593
LIT$1	   542#	   568	   642#	   652	   704#	   711	   756#	   759	   811#	   817	  2593#	  2594
LIT$10	   556#	   575
LIT$11	   559#	   576
LIT$12	   562#	   577
LIT$13	   563#	   578
LIT$14	   565#	   579
LIT$2	   544#	   569	   643#	   653	   705#	   712	   812#	   818	  2593#	  2595
LIT$3	   546#	   570	   644#	   654	   706#	   713	   814#	   819	  2593#	  2596
LIT$4	   548#	   571	   645#	   655	  2593#	  2597
LIT$5	   549#	   572	   646#	   656	  2593#	  2598
LIT$6	   551#	   573	   647#	   657	  2593#	  2599
LIT$7	   553#	   574	  2593#	  2600
LNGMES	    13	   411	   464	   593	   668	   728	   774	   827#	  2612
LNGMS1	   828#	   832	   836
LP2BAT	    40%	  1385
LP2HOM	    40%	  1350
LPNBAT	    40%	  1385
LPNHOM	    40%	  1350
LSTRED	  1160	  1175#
LSTUNI	  1037	  1046#
MANCM1	   117#	   123
MANCOM	   118#	   128
MANOK	   113	   129#
MANOK1	   141	   144#
MANOK2	   150	   156#
MANQST	   114	   125#
MANREF	   121#	   131
MAX	    13	  1935	  1948	  1957	  1967	  1986#	  2099	  2121	  2704	  2720
MAYREF	  1996#	  2100
MCKKON	   890	  1230#
MFDRIB	    31%	  1298
MIN	    13	  1934	  1945	  1958	  1987#	  2097	  2119	  2702	  2718
MISUNI	  1180	  1187#	  1194
MO.TON	  2471
MONTAB	  2871	  2883#
MOVSTR	   982	  1289#
MOVUNI	   966	   973	  1272#
MSGLNG	  1184	  1193	  1308#
MSGSAV	  1932	  1941	  1978	  1982#
MSGSTR	  1041	  1163	  1317#
MSGUNI	  1013	  1024	  1032	  1326#
MTR	  2471
NAMFLO	  1072	  1322#	  1332
NASTYP	  1219	  1233#
NLSUNI	  1035	  1053#
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

NMRBPC	    31%	  2713	  2722	  2725
NMSTPC	    33%	  2697	  2706	  2709
NODATE	  2858	  2878#
NODIE	    69%
NOERH	   282	  1427	  1542	  1573#	  2637
NOREF	  1904	  1907#
NOSTR	   980	  1068#
NOTPRV	   978	   995#
NTISTR	   967	   976	  1026	  1077#
NULCHG	   671#	   692
NULDSK	  2551#	  2574
NULFIL	   447#	   511
NULSRP	   777#	   799
NULTYP	   597#	   624
NULUIP	   731#	   748
OCONM	    28%	   441	   450	  1070	  1236	  1318	  1328	  2416	  2438	  2532	  2542
OCTIN	    28%	  1246
OFLTAB	  1139	  1144#
OHTINI	    35%	  1605
OHTNUM	    35%	  1619
OLDST0	  1007	  1010#
OLDST1	  1005	  1012#
OLDST2	  1006#
OLDST4	  1009	  1011	  1014#
OLDST5	  1015	  1023#
OLDST6	  1016#
OLDST8	   998	  1019	  1021	  1025#
OLDSTR	   998#
ONCDDB	    38%	   860
ONCDSK	    69	    70#	    73	    76
ONCMOD	    63	    65#
ONDEND	  3510#
ONDLIT	  2903#
ONDLNP	    12	  3504#	  3506
ONDLNR	    12	  3503#	  3504
ONDSTT	    12	    67#	    76
OPAGIN	    13	   209	  1454	  1591#
OPAGIO	  1593	  1599#
OPAGOT	    13	   225	  1516	  1596#
OPOUT	    28%	   442	   451	   834	  1138	  1141	  1313	  1689	  1708	  1855	  1863	  1871	  1910	  2417
	  2439	  2543	  2732	  2742
OVRDEF	  2208	  2233#
P	    70	   112	   117	   118	   127	   129	   145	   148	   162	   209	   219	   225	   257	   258
	   274	   275	   277	   349	   350	   351	   353	   360	   363	   391	   411	   415	   430	   433
	   436	   441	   442	   450	   451	   454	   458	   464	   512	   515	   517	   518	   519	   520
	   521	   587	   593	   625	   626	   627	   628	   629	   662	   668	   693	   694	   695	   719
	   728	   749	   762	   768	   774	   800	   801	   821	   822	   830	   833	   834	   835	   852
	   859	   862	   864	   882	   890	   905	   947	   957	   962	   965	   966	   972	   973	   977
	   982	   995	  1013	  1024	  1032	  1038	  1041	  1042	  1070	  1072	  1078	  1083	  1091	  1094
	  1095	  1123	  1126	  1128	  1129	  1133	  1137	  1140	  1163	  1184	  1193	  1203	  1205	  1207
	  1208	  1234	  1235	  1236	  1238	  1239	  1240	  1241	  1242	  1243	  1244	  1245	  1246	  1247
	  1248	  1268	  1269	  1286	  1306	  1309	  1311	  1312	  1313	  1314	  1318	  1322	  1327	  1328
	  1331	  1371	  1387	  1415	  1422	  1426	  1428	  1454	  1458	  1460	  1468	  1472	  1473	  1499
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

	  1509	  1513	  1514	  1516	  1518	  1521	  1522	  1543	  1545	  1546	  1547	  1549	  1556	  1560	  1561
	  1562	  1563	  1564	  1565	  1599	  1605	  1611	  1612	  1613	  1618	  1621	  1639	  1643	  1650
	  1654	  1657	  1665	  1667	  1673	  1674	  1683	  1687	  1688	  1691	  1704	  1706	  1707	  1722
	  1729	  1733	  1736	  1737	  1738	  1741	  1744	  1752	  1757	  1758	  1759	  1760	  1761	  1762
	  1764	  1765	  1766	  1767	  1768	  1769	  1770	  1788	  1792	  1814	  1820	  1826	  1827	  1831
	  1832	  1836	  1837	  1854	  1856	  1858	  1860	  1862	  1869	  1870	  1886	  1891	  1900	  1906
	  1907	  1910	  1912	  1915	  1918	  1919	  1920	  1939	  1943	  1946	  1949	  1950	  1952	  1961
	  1963	  1976	  1998	  2016	  2017	  2018	  2039	  2056	  2058	  2061	  2069	  2076	  2078	  2079
	  2081	  2082	  2084	  2089	  2100	  2103	  2104	  2107	  2124	  2125	  2144	  2157	  2162	  2166
	  2170	  2186	  2187	  2196	  2207	  2210	  2211	  2214	  2215	  2216	  2217	  2218	  2265	  2266
	  2274	  2277	  2278	  2279	  2280	  2294	  2295	  2300	  2302	  2303	  2323	  2324	  2338	  2356
	  2357	  2358	  2361	  2366	  2372	  2374	  2375	  2376	  2377	  2378	  2388	  2393	  2395	  2399
	  2401	  2404	  2411	  2413	  2416	  2417	  2418	  2420	  2425	  2429	  2435	  2438	  2439	  2440
	  2442	  2449	  2451	  2452	  2477	  2512	  2526	  2527	  2532	  2533	  2539	  2540	  2542	  2543
	  2544	  2545	  2548	  2551	  2556	  2608	  2612	  2616	  2620	  2638	  2640	  2692	  2694	  2707
	  2708	  2710	  2723	  2724	  2726	  2731	  2732	  2733	  2734	  2735	  2736	  2737	  2741	  2742
	  2743	  2744	  2746	  2749	  2751	  2753	  2755	  2757	  2759	  2773	  2775	  2777	  2779	  2781
	  2784	  2785	  2796	  2800	  2802	  2805	  2818	  2819	  2820	  2822	  2823	  2824	  2826	  2827
	  2828	  2832	  2833	  2834	  2835	  2839	  2844	  2845	  2847	  2848	  2853	  2854	  2861	  2862
	  2865	  2867	  2869	  2870	  2874	  2875	  2876	  2888	  2890	  2892	  2894	  2896
P1	   368	   369	   392	   393	   456	   462	   585	   591	   660	   666	   717	   726	   766	   772
	   883	   887	  1177	  1178	  1179	  1187	  1189	  1216	  1237	  1500	  1507	  1692	  1833	  1852
	  1853	  1877	  1911	  1933	  1942	  1945	  1948	  1979	  2073	  2077	  2101	  2123	  2165	  2192
	  2193	  2194	  2205	  2206	  2207	  2208	  2215	  2546	  2697	  2706	  2713	  2722	  2762	  2767
	  2771	  2774
P2	   174	   188	   190	   192	   279	   368	   378	   388	   393	   394	   395	   398	   400	   405
	   410	   715	   716	   721	   963	   974	   979	   998	  1006	  1008	  1026	  1036	  1047	  1048
	  1053	  1063	  1156	  1157	  1159	  1164	  1171	  1175	  1265	  1267	  1290	  1292	  1300	  1301
	  1303	  1305	  1321	  1348	  1383	  1461	  1462	  1463	  1557	  1558	  1672	  1698	  1756	  1838
	  1898	  1899	  1903	  1908	  1999	  2000	  2101	  2105	  2106	  2120	  2123	  2126	  2149	  2158
	  2159	  2164	  2167	  2183	  2184	  2190	  2191	  2195	  2201	  2267	  2268	  2319	  2320	  2335
	  2339	  2354	  2356	  2358	  2363	  2365	  2367	  2406	  2423	  2424	  2428	  2434	  2642	  2643
	  2650	  2651	  2653	  2654	  2663	  2669	  2671	  2691	  2788	  2789	  2790	  2792	  2804	  2806
	  2846	  2849	  2850
P2BLSH	  2807
P3	   151	   155	   175	   191	   204	   205	   220	   222	   227	   278	   354	   361	   365	   369
	   376	   381	   387	   389	   390	   392	   394	   416	   460	   462	   463	   465	   589	   591
	   592	   594	   664	   666	   667	   669	   722	   726	   727	   729	   770	   772	   773	   775
	   964	  1079	  1080	  1081	  1082	  1088	  1349	  1384	  1464	  1842	  2164	  2167	  2182	  2197
	  2550	  2690	  2762	  2765	  2772	  2778	  2782
P4	   169	   178	   179	   189	   196	   370	   385	   387	   390	  1176	  1178	  1179	  1187	  1350
	  1385	  1414	  1421	  1505	  1508	  1511	  1757	  1769	  1785	  1786	  1881	  1897	  2359	  2360
	  2613	  2615	  2617	  2860
P4CDEF	  2212	  2243#
PAGCOD	    37%	   964	  1464	  1842	  2690
PAGIN	    35%	  1591
PAGNAM	    37%	   963	  1463	  1838	  2642
PAGOUT	    35%	  1596
PAGSLF	    37%	  1507
PAKREF	    36%	  2361
PCBPAG	    36%	  1602
PCISTS	    35%	  1601	  1614
PG	   208	   224	   280	  1351	  1386	  1545	  1564	  1599	  1600	  1602	  1618
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

PGYERR	    35%	  1604	  1617
PGYPNO	    35%	  1606
PGYUNI	    35%	  1610
PR2DIG	  2800	  2844	  2869	  2876	  2895#
PR3DIG	  2828	  2834	  2893#
PR4DIG	  2824	  2891#
PR5DIG	  2889#
PR6DIG	  2775	  2887#
PRCOL	  1129%	  1129
PRNAME	    34%	  1128%	  1128	  1238	  1322	  1549	  1560	  1700	  1860	  2078	  2539	  2749	  2753	  2757
PRNAMF	  1133%	  1133	  1137%	  1137
PRSPC	  1126%	  1126	  2888	  2890	  2892	  2894	  2896%	  2896
PRT22A	    27%	  2805
PRTDIG	  2779	  2897%	  2897
QSTSTD	  1938	  1965#
RADX10	    34%	  1693
RANHOM	   139	   143	   865	  1016	  1018	  1213#	  2391	  2392	  2667
RANNO	  2510%	  2525
RBINDX	    47%	   181
RBLVPR	    48%
RBLVSP	    48%
RBMASK	    47%	   187
RBREAL	    47%	   182	   187	  1294	  1297	  1503
RBSPAR	    47%	   181
RBYPNO	    48%	   207	   223	  1506
RBYUN1	    48%	   184
RBYUN4	    48%
RBYUNI	    48%	  1504
RDBAT1	  1786#	  1791
RDBAT6	  1787	  1790#
RDBNON	  1423	  1427#
RDBOTH	  1352	  1372	  1411#
RDBSKP	  1417	  1426#
RDCHEK	   283	  1415	  1422	  1452#
RDHOM1	   869#	   871
RDHOM2	   867	   872#
RDHOME	   112	   433	   852#	  2395	  2401
RDRBS2	   173#	   195
RDRBS3	   178#	   191
RDSATS	   198	   202#
RDST45	   211	   215#
RDSTS1	   204#	   243
RDSTS4	   205#	   228
RDSTS5	   206	   231#
RDSTS6	   239	   242#
RDWMSG	  1458	  1468	  1521	  1542#
RE.DCD	    60%	   989
REDBAT	   129	   436	  1784#
REDERR	  1412	  1470	  1497	  1512	  1553	  1555	  1567#	  1816
REDSEC	  1416	  1420#
REFLAG	   134%	   134
REFRSH	    41%	  2399
REFSAV	  1308	  1317	  1326	  1756#
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

REONCE	    93	    93#	   983
REPSID	    60%	   986
RETFIX	  1936	  1960#
RIBEXT	    47%	   164
RIBLST	    47%	   178
RIBNAM	    47%	  1462
RIBPFS	    47%	   169
RWRHOM	  2393	  2613#
S$ENTR	    69	    75	   163	   180	   183	   186	   197	   226	   863	  1073	  2693
S$HALT	    69	   163	   180	   183	   186	   197	   226	   863	  1073	  2693
S$NAME	    73#	   163	   180	   183	   186	   197	   226	   863	  1073	  2693
S$NONA	    72	    75	   163	   180	   183	   186	   197	   226	   863	  1073	  2693
S$TEMP	    69#	    69	   163#	   163	   180#	   180	   183#	   183	   186#	   186	   197#	   197	   226#	   226
	   863#	   863	  1073#	  1073	  2693#	  2693
S$XCT	    75	   163	   180	   183	   186	   197	   226	   863	  1073	  2693
SATCNT	    30%	   219
SAVE4	    41%	  2412
SCNBAT	    29%
SCNCHG	   660	   698	   699#
SCNDSK	  2536	  2546	  2584	  2585#
SCNFIL	   456	   526	   527#
SCNSD2	  1198	  1204#
SCNSRP	   766	   805	   806#
SCNST2	  1166#	  1168
SCNSTD	  1158	  1201#
SCNSTR	  1106	  1156#
SCNTYP	   585	   633	   634#
SCNUIP	   717	   752	   753#
SCNUN1	   937	  1091#
SCNUNI	   876#	  1093
SETBAT	  1371	  1383#	  1837
SETCHG	   965	   972	  1718#	  2060	  2088	  2107	  2196	  2274	  2374	  2377
SETDDO	    41%	   862
SETPRV	  1731#
SETPUB	   995	  1727#	  2187	  2375
SETRAN	   349	  2466#
SETUNT	  1106#	  1112	  1117
SETUTS	  1108	  1114#
SIZCHG	   697#	   697	   698
SIZDSK	  2583#	  2583	  2584
SIZFIL	   525#	   525	   526
SIZOND	  3506
SIZSRP	   804#	   804	   805
SIZTYP	   632#	   632	   633
SIZUIP	   751#	   751	   752
SPACE3	  2845	  2899#
SPCDK1	  2541#	  2557
SPCDKN	   512	  2530#
SPCDKP	   148	  2533	  2604#
SPDKHP	  2549	  2553#	  2572	  2573
SPSNAM	  1698#	  1870	  1907
SPUCLC	  1078	  2034#	  2058
SPUNAM	  1699#	  1856	  2017
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

SRPCMD	   446#	   771	   776	   823
SRPHL1	   773#	   775
SRPHLP	   772#	   803
SRPNDS	    50%	   153
SRPREF	   132%	   132
STDREA	    35%	  1592	  1615
STDWRT	    36%	  1597	  1615
STOUN1	  1674#	  1676
STOUNI	  1672#	  2108	  2217	  2219
STRBTS	    52%	   133	   152	  2295	  2301
STRDDB	    50%	   130	   133	   138	   144	   152	   161	   170	   202	   203	   240	  1156	  1265	  1898
	  2267	  2295	  2296	  2297	  2298	  2299	  2301	  2319	  2390	  2665
STRFIX	  1017	  1020#
STRHSH	    51%	  1006	  1008	  2390	  2665
STRLEN	    50%	  2299
STRNAM	    51%	   979	  1157	  1267	  1290	  1321	  1698	  1899	  2149	  2158	  2320	  2651
STRNXT	    51%
STROVR	    52%	  1303	  2123	  2126	  2669
STRP4C	    51%	  1292	  2101	  2105	  2671
STRPID	    52%	    60%	   144
STRPPU	    52%	  1300	  1301	  2120	  2190	  2191	  2335
STRREF	    51%	   130	  1305	  1756	  1903	  2000	  2106	  2159	  2354	  2406	  2663
STRSID	    52%
STRTAL	    52%	   202	   240
STRTCH	   801	   822	  2097#	  2214
STRTOV	   800	   821	  2119#	  2210
STRTPA	   802	   821#
STRUNI	    51%	   138	   161	   170	   203	  1053	  1164	  1175	  1672	  1908	  2164	  2167	  2201	  2268
	  2367	  2654
STRUNM	    51%	  1036	  1047	  1048	  1159	  1171	  2184	  2195	  2339	  2363
STSDEF	   518	  2143#
STSDSL	   517	  2265#
STSFIN	  2168	  2201#
STSINS	  2170	  2175#
STSNE1	  2150	  2157#
STSNE2	  2161#	  2169
STSNEW	  2146	  2149#
STSNXT	  2166#	  2171	  2172
STSREF	   519	  2388#
STSUN2	  2176	  2182#
STTFPC	    29%	   220
STTLEN	    30%	   190	   227	  1080
STTPTR	    29%	   188	   192	   205	   222
SVMOT2	  1203	  1702#
SVMOTE	  1703#
SVMOUT	  1705#	  1744
SVOTAC	  1120	  1233	  1544	  1682	  1686	  1705	  1710	  1757#	  1812	  2636
SVP2	   423#
SVU	   359	   367	   424#
SYSBTS	   522%	   522
SYSRIB	  1295%	  1295
SYSSIZ	    40%
SYSUNI	    40%	   252	   866	   872	   911	  1104	  1747	  1784	  1880	  2614
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

T1	   115	   121	   125	   130	   131	   132	   133	   139	   140	   142	   143	   144	   152	   153
	   156	   157	   164	   166	   167	   168	   179	   181	   182	   187	   188	   213	   214	   216
	   217	   218	   231	   232	   234	   235	   236	   237	   240	   251	   253	   356	   372	   373
	   382	   410	   412	   427	   438	   448	   463	   581	   592	   598	   667	   672	   727	   732
	   735	   773	   778	   781	   827	   828	   833	   835	   860	   861	   875	   876	   880	   894
	   895	   912	   913	   919	   920	   923	   924	   926	   927	   930	   931	   933	   934	   935
	   936	   940	   941	   951	   952	   961	   975	   976	   985	   986	   988	   990	   991	   992
	   993	   994	   999	  1000	  1002	  1004	  1005	  1008	  1010	  1012	  1014	  1015	  1018	  1020
	  1023	  1027	  1036	  1037	  1039	  1059	  1060	  1061	  1062	  1068	  1084	  1085	  1086	  1087
	  1088	  1089	  1100	  1101	  1102	  1105	  1109	  1110	  1112	  1130	  1139	  1159	  1160	  1161
	  1166	  1167	  1168	  1169	  1170	  1171	  1183	  1192	  1201	  1217	  1230	  1239	  1242	  1266
	  1267	  1272	  1273	  1274	  1275	  1276	  1277	  1278	  1279	  1282	  1284	  1285	  1289	  1290
	  1291	  1292	  1293	  1294	  1295	  1296	  1297	  1298	  1299	  1300	  1301	  1302	  1303	  1304
	  1305	  1309	  1310	  1314	  1457	  1467	  1502	  1504	  1519	  1546	  1550	  1554	  1561	  1592
	  1597	  1601	  1603	  1604	  1607	  1608	  1609	  1610	  1640	  1641	  1644	  1646	  1655	  1656
	  1658	  1661	  1663	  1664	  1673	  1692	  1718	  1721	  1740	  1742	  1816	  1818	  1821	  1828
	  1835	  1839	  1840	  1841	  1853	  1857	  1861	  1867	  1905	  1932	  1941	  1944	  1947	  1973
	  1978	  2000	  2001	  2002	  2071	  2074	  2098	  2099	  2102	  2107	  2120	  2121	  2122	  2143
	  2145	  2151	  2158	  2161	  2175	  2176	  2177	  2184	  2185	  2189	  2190	  2191	  2193	  2208
	  2209	  2211	  2212	  2213	  2216	  2218	  2266	  2270	  2273	  2278	  2294	  2297	  2298	  2299
	  2300	  2301	  2302	  2322	  2327	  2328	  2329	  2334	  2335	  2339	  2341	  2343	  2344	  2345
	  2346	  2348	  2351	  2352	  2353	  2354	  2355	  2363	  2364	  2367	  2368	  2370	  2372	  2373
	  2380	  2384	  2389	  2390	  2407	  2415	  2437	  2445	  2446	  2447	  2448	  2513	  2530	  2534
	  2535	  2541	  2553	  2610	  2639	  2644	  2645	  2646	  2647	  2648	  2649	  2650	  2651	  2652
	  2655	  2656	  2657	  2658	  2661	  2663	  2664	  2665	  2666	  2667	  2668	  2669	  2670	  2671
	  2672	  2674	  2675	  2676	  2677	  2678	  2679	  2680	  2681	  2683	  2684	  2686	  2687	  2688
	  2698	  2701	  2702	  2703	  2704	  2705	  2714	  2717	  2718	  2719	  2720	  2721	  2730	  2740
	  2766	  2767	  2770	  2774	  2776	  2778	  2780	  2783	  2793	  2794	  2795	  2799	  2801	  2804
	  2806	  2807	  2809	  2820	  2821	  2823	  2825	  2827	  2829	  2831	  2833	  2835	  2840	  2842
	  2843	  2859	  2868	  2870	  2871	  2872	  2873	  2875	  2878	  2887	  2889	  2891	  2893	  2895
	  2899
T2	   165	   166	   167	   205	   222	   233	   234	   352	   356	   376	   383	   892	   911	   912
	   915	   916	   920	   921	   922	   923	   927	   928	   929	   930	   934	   949	   983	   984
	   989	  1001	  1003	  1006	  1007	  1010	  1016	  1020	  1029	  1030	  1031	  1033	  1038	  1042
	  1046	  1047	  1057	  1071	  1082	  1086	  1087	  1089	  1114	  1115	  1120	  1121	  1122	  1124
	  1125	  1127	  1132	  1134	  1135	  1136	  1233	  1237	  1280	  1281	  1283	  1308	  1317	  1321
	  1326	  1331	  1462	  1463	  1464	  1500	  1503	  1507	  1544	  1548	  1557	  1559	  1600	  1602
	  1611	  1613	  1651	  1652	  1659	  1660	  1662	  1682	  1686	  1698	  1699	  1705	  1710	  1740
	  1748	  1762	  1812	  1824	  1825	  1859	  1903	  1904	  1934	  1935	  1957	  1958	  1960	  1965
	  1966	  1967	  1970	  2034	  2035	  2036	  2037	  2038	  2059	  2077	  2083	  2085	  2086	  2087
	  2105	  2126	  2265	  2279	  2340	  2342	  2343	  2346	  2349	  2350	  2368	  2369	  2370	  2423
	  2428	  2432	  2433	  2434	  2445	  2448	  2512	  2514	  2523	  2524	  2525	  2526	  2536	  2538
	  2604	  2605	  2606	  2607	  2636	  2654	  2655	  2657	  2659	  2709	  2725	  2748	  2752	  2756
	  2760	  2761	  2763	  2768	  2769	  2792	  2808	  2809	  2811	  2816	  2819	  2841	  2842	  2843
	  2846	  2858	  2863	  2864	  2865
T3	   149	   184	   185	   352	   371	   372	   373	   374	   375	   378	   379	   381	   382	   383
	   828	   829	   831	   868	   869	   888	   944	   971	  1056	  1057	  1181	  1190	  1234	  1310
	  1417	  1423	  1425	  1455	  1465	  1470	  1512	  1520	  1548	  1591	  1596	  1612	  1614	  1615
	  1617	  1620	  1727	  1728	  1731	  1732	  1758	  1768	  1833	  1955	  2057	  2059	  2271	  2272
	  2275	  2537	  2606	  2750	  2754	  2758	  2810	  2811	  2815	  2817	  2818	  2838	  2866	  2867
T4	   173	   185	   207	   220	   221	   223	   276	   906	   942	  1053	  1059	  1060	  1064	  1214
	  1232	  1235	  1414	  1421	  1505	  1506	  1606	  1719	  1720	  2412	  2812	  2813	  2814	  2815
	  2868
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

THSDAT	   165%	   165	   168%	   168	  2410%	  2410
TPOPJ	    34%	  1677
TRYKON	   882#	   891	   893	   948	   950
TSTCHK	  1466	  1470#
TSTSUP	   521%	   521
TXTCHG	   697	   710#
TXTDSK	  2583	  2593#
TXTFIL	   525	   567#
TXTSRP	   804	   816#
TXTTYP	   632	   651#
TXTUIP	   751	   758#
TYPALL	   630	  1918#
TYPBAT	   627	  2740#
TYPBT1	  2763#	  2769
TYPBT2	  2764	  2768	  2770#
TYPBT3	  2790#	  2850
TYPBT4	  2794	  2799#
TYPBT5	  2797	  2804#
TYPBT6	  2837	  2845#
TYPBT9	  2782	  2791	  2852#
TYPCMD	   444#	   590	   595
TYPDAT	  2847	  2858#
TYPDEC	  1312	  1683	  1688	  1691#	  1946
TYPHL1	   592#	   594
TYPHLP	   591#	   631
TYPIT	   513	   584#
TYPMSN	  1686#
TYPNS1	  1882#	  1885
TYPNS2	  1888#	  1892
TYPONL	    12	   407	   584	   659	   734	   780	  1930	  1985#	  1996	  2055	  2080	  2204	  2227	  2337
TYPRPC	   629	  2713#
TYPSPC	   628	  2697#
TYPSR1	  1872#	  1889	  1914
TYPSRP	   623	   691	   766#
TYPST1	  1913#	  1916
TYPSTR	   625	  1897#	  1918
TYPSYS	  1867#	  1920
TYPUI0	   855	  1119#	  1121
TYPUI1	  1131	  1139#
TYPUID	  1091	  1120#
TYPUIP	   622	   690	   715#
TYPUN1	  1853#	  1886	  1912
TYPUNI	  1852#	  1891	  1915
TYPUNS	   626	  1877#	  1919
U	   138	   146	   147	   161	   170	   174	   194	   195	   203	   204	   221	   231	   236	   238
	   242	   243	   252	   253	   254	   255	   359	   367	   715	   761	   866	   867	   869	   870
	   871	   872	   877	   883	   906	   913	   921	   924	   928	   931	   936	   941	   952	  1030
	  1031	  1062	  1063	  1064	  1077	  1084	  1092	  1093	  1104	  1106	  1107	  1109	  1111	  1115
	  1116	  1127	  1130	  1132	  1134	  1164	  1166	  1167	  1175	  1196	  1197	  1216	  1273	  1275
	  1281	  1283	  1285	  1299	  1327	  1455	  1465	  1520	  1608	  1609	  1635	  1637	  1641	  1645
	  1649	  1672	  1675	  1676	  1699	  1720	  1721	  1728	  1732	  1739	  1747	  1748	  1750	  1751
	  1760	  1766	  1784	  1786	  1790	  1791	  1825	  1855	  1859	  1880	  1882	  1883	  1884	  1888
	  1889	  1890	  1908	  1909	  1913	  1914	  2034	  2073	  2083	  2086	  2087	  2175	  2182	  2183
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

	  2189	  2194	  2197	  2201	  2202	  2203	  2205	  2268	  2269	  2271	  2272	  2275	  2276	  2326	  2327
	  2334	  2348	  2350	  2351	  2353	  2360	  2365	  2373	  2376	  2383	  2614	  2615	  2617	  2618
	  2619	  2643	  2644	  2646	  2659	  2674	  2748	  2752	  2756	  2830	  2836
UFDHSI	    30%	  2389
UIPHL1	   727#	   729
UIPHLP	   726#	   750
UIPSVU	   716	   721	   724#
UNCHKA	   761#	  2223	  2338
UNICHK	  2218	  2222#
UNICHN	    58%	   929	   930	   933	   934
UNICHR	    27%	  2830	  2836
UNICK1	  2216	  2226#
UNIDES	    54%	   253	   869	   936	   941	   952	  1281	  1283	  1720	  1721	  1728	  1732	  1786	  1825
	  2273	  2360	  2615	  2617
UNIERR	    54%
UNIFEP	    54%	  1285
UNIHID	    54%	   761	  1132	  1275	  1859	  2073	  2083	  2086	  2087	  2644	  2648	  2658	  2756
UNIKON	    58%	   877	   922	   923	   926	   927	  1635
UNILOG	    58%	  1077	  1107	  1134	  1273	  1884	  1890	  2271	  2674	  2752
UNINAM	    55%	   883	  1127	  1216	  1327	  1455	  1465	  1520	  1699	  1748	  2748
UNIONC	    57%	   906	  1130	  1649
UNIPPU	    54%	   231	  1030	  1031	  1299	  2034	  2189	  2193	  2334
UNISTR	    55%	   146	   194	   242	   715	  1059	  1062	  1063	  1167	  1196	  1675	  1913	  2175	  2183
	  2197	  2202	  2272	  2327	  2365	  2368	  2373	  2383	  2643	  2646	  2657
UNISTS	    58%	  1637	  1641	  1645
UNISTT	    55%	   174	   204	  1084
UNISYS	    54%	   254	   870	   911	   912	   915	   919	   920	  1092	  1111	  1116	  1750	  1790	  1882
	  1888	  2618
UNITAL	    56%	   221	   236	   238
UNITID	   749	   762	  2069#	  2085
UNITST	   763	  2055#	  2228
UNPCHG	    56%	   251	  1718	  2359	  2613
UNPHWP	    56%	   940	   951	  1719	  1824
UNPMSB	    56%	  1280
UNPOFL	    56%	   935	  1719	  1785
UNPPRV	    58%	   868	  1727	  1731	  2270
UNTLEN	    29%	  1102	  1105
UNTTBL	    29%	  1099	  1100	  1101	  1102	  1109	  1115	  1608	  1609	  2342	  2344	  2348	  2350	  2351
	  2353
UNVRSF	    56%	   232
UNYBPR	    27%	  1659%	  1659	  2812
UNYBPT	    27%	  2810	  2841
UNYBPY	    27%	  2808
UNYKTP	  1651%	  1651	  2206%	  2206
UNYLN1	    57%	  1056
UNYLUN	    57%	   173	  1033	  1110	  1114	  1169	  1177	  1277	  1502	  1607	  2185	  2340	  2341	  2349
	  2352	  2676
UNYPUN	  1124%	  1124
UNYSPU	    57%	   175	   233	  1079	  1279	  2038	  2057	  2678
UNYUTP	  1655%	  1655
UPDHM1	  2655#	  2660
UPDHM2	  2656	  2661#
UPDHM3	  2653	  2674#
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Symbol cross reference

UPDHM4	  2682	  2685	  2690#
UPDHOM	   145	  2357	  2616	  2636#
VALSAV	  1933	  1942	  1960	  1970	  1979	  1984#
WCKUNI	   907	   940#
WHICH	   281	  1413	  1420	  1498	  1510	  1551	  1570#
WRPUNM	   947	  1214#
WRTRN1	  1502#	  1511
WTBOTH	    14	  1497#	  1817	  1843	  2692
WTCHEK	  1509	  1516#
YESNO	    41%	   415	  1711	  2784
$XZ	   540#	   540	   542	   542#	   544	   544#	   546	   546#	   548	   548#	   549	   549#	   551	   551#
	   553	   553#	   556	   556#	   559	   559#	   562	   562#	   563	   563#	   565	   565#	   567	   567#
	   568	   568#	   569	   569#	   570	   570#	   571	   571#	   572	   572#	   573	   573#	   574	   574#
	   575	   575#	   576	   576#	   577	   577#	   578	   578#	   579	   579#	   580	   580#	   641#	   641
	   642	   642#	   643	   643#	   644	   644#	   645	   645#	   646	   646#	   647	   647#	   651	   651#
	   652	   652#	   653	   653#	   654	   654#	   655	   655#	   656	   656#	   657	   657#	   658	   658#
	   703#	   703	   704	   704#	   705	   705#	   706	   706#	   710	   710#	   711	   711#	   712	   712#
	   713	   713#	   714	   714#	   755#	   755	   756	   756#	   758	   758#	   759	   759#	   760	   760#
	   810#	   810	   811	   811#	   812	   812#	   814	   814#	   816	   816#	   817	   817#	   818	   818#
	   819	   819#	   820	   820#	  2593#	  2593	  2594	  2594#	  2595	  2595#	  2596	  2596#	  2597	  2597#
	  2598	  2598#	  2599	  2599#	  2600	  2600#	  2601	  2601#
%%ZZQ	  1143#	  1151
%BAT	  1835	  1838	  1841	  1842	  2760	  2761	  2771	  2772	  2788	  2789	  2852
%BAT.P	    32%	  1386
%D	    76#
%HOM	   276	   961	   963	   964	   975	   985	   993	  1002	  1004	  1014	  1034	  1071	  1272	  1274
	  1276	  1278	  1284	  1289	  1291	  1293	  1296	  1302	  1304	  2639	  2642	  2645	  2649	  2652
	  2661	  2664	  2666	  2668	  2670	  2672	  2675	  2677	  2679	  2680	  2681	  2684	  2686	  2687
	  2688	  2690
%HOM.P	    32%	  1351
%OFLER	  1146#
%OFLFM	  1147#
%OFLIG	  1150#
%OFLMT	  1148#
%OFLRS	  1149#
%OND	    67	  3503
%STA	   212	   213	   214	   215	   216	   217	   218
%STA.P	    32%	   208	   224
%STR	   164	   179	   196
%STR.P	    32%	   280
ONCDSK	OPTIONAL & MANDATORY ONCE ONLY CODE	MACRO 12.5-46.0 14:41 13-JAN-88
ONCDSK.MAC	 4-DEC-87 15:51		Macro/Opdef cross reference

DCNDEF	    80#	    93
DSKOFF	  1624#	  1636
DSKON	  1625#	  1638	  1642
IFCPU	   900	  1627	  1648	  2467	  2468	  2473	  2480	  2513	  2514	  2515
MKCHG	   677#	   693	   699	   703	   710
MKDSK	  2561#	  2575	  2585	  2593
MKFIL	   468#	   512	   527	   540	   567
MKSRP	   785#	   800	   806	   810	   816
MKTYP	   603#	   625	   634	   641	   651
MKUIP	   739#	   749	   753	   755	   758
ONSZCK	  3506
PFALL	   198	   953
PJRST	   283	   763	  1138	  1141	  1219	  1323	  1332	  1352	  1372	  1684	  1689	  1693	  1700	  1708
	  1711	  1817	  1843	  1863	  1871	  1872	  2004	  2020	  2060	  2088	  2108	  2127	  2147	  2154
	  2180	  2219	  2223	  2228	  2408	  2699	  2715	  2876	  2879	  2900
PRINTF	  1097	  2188
RDTIME	  2513
SCAN	   286#	   456	   585	   660	   766
SCNTB	   313#	   509	   622	   690	   746	   797	  2572
STOPCD	    68	   163	   180	   183	   186	   197	   226	   863	  1073	  2693
WRPI	   857	  1636	  1638	  1642
X	   509#	   512	   513	   514	   515	   516	   517	   518	   519	   520	   521	   522	   523	   524
	   527#	   527	   528	   529	   530	   531	   532	   533	   534	   535	   536	   537	   538	   539
	   540#	   540	   542	   544	   546	   548	   549	   551	   553	   556	   559	   562	   563	   565
	   567#	   567	   568	   569	   570	   571	   572	   573	   574	   575	   576	   577	   578	   579
	   622#	   625	   626	   627	   628	   629	   630	   631	   634#	   634	   635	   636	   637	   638
	   639	   640	   641#	   641	   642	   643	   644	   645	   646	   647	   651#	   651	   652	   653
	   654	   655	   656	   657	   690#	   693	   694	   695	   696	   699#	   699	   700	   701	   702
	   703#	   703	   704	   705	   706	   710#	   710	   711	   712	   713	   746#	   749	   750	   753#
	   753	   754	   755#	   755	   756	   758#	   758	   759	   797#	   800	   801	   802	   803	   806#
	   806	   807	   808	   809	   810#	   810	   811	   812	   814	   816#	   816	   817	   818	   819
	  2572#	  2575	  2576	  2577	  2578	  2579	  2580	  2581	  2582	  2585#	  2585	  2586	  2587	  2588
	  2589	  2590	  2591	  2592	  2593#	  2593	  2594	  2595	  2596	  2597	  2598	  2599	  2600	  3506#
XZ$	   540#	   540	   542	   544	   546	   548	   549	   551	   553	   556	   559	   562	   563	   565
	   567#	   567	   568	   569	   570	   571	   572	   573	   574	   575	   576	   577	   578	   579
	   641#	   641	   642	   643	   644	   645	   646	   647	   651#	   651	   652	   653	   654	   655
	   656	   657	   703#	   703	   704	   705	   706	   710#	   710	   711	   712	   713	   755#	   755
	   756	   758#	   758	   759	   810#	   810	   811	   812	   814	   816#	   816	   817	   818	   819
	  2593#	  2593	  2594	  2595	  2596	  2597	  2598	  2599	  2600  + C