LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 1
LATSER	MAC	19-Aug-74 07:34	

     1					;DSKB:LATSER.MAC[10,6062,MCO] 13-Jan-86:11:18:00, Edit by APPELLOF
     2					; If operator has done a SET SCHED 10, reject LAT connections
     3					;  when processing the START slot.
     4					;DSKB:LATSER.MAC[10,6062,MCO] 21-Nov-85:08:55:00, Edit by APPELLOF
     5					; Record ethernet address of the guy who sent us a bad message just
     6					;  before a LATNSC BUGINF.
     7					;DSKB:LATSER.MAC[10,6062,MCO] 13-Nov-85:08:55:00, Edit by APPELLOF
     8					;  Fix problem of LAT output stalling on slow lines when input
     9					;  is typed.  In routine XSLDTA, don't mark the line inactive if
    10					;  we had no transmit credits this time around.
    11					;DSKB:LATSER.MAC[10,6062,MCO] 8-Nov-85:15:00:00, Edit by APPELLOF
    12					; Fix DEX, protocol error, etc. caused by disconnecting from host side.
    13					; Save J around call to NGVLDB
    14					;DSKT:LATSER.MAC[30,5653,CTERM] 17-Sep-1985:00:33:03, Edit by SPIDER
    15					; Fix NETDIL to do the right things with extended addressing
    16					;DSKT:LATSER.MAC[30,5653,CPYRIT] 6-Sep-1985:21:15:25, Edit by SPIDER
    17					; Insert copyright notice.
    18					;DSKC:LATSER.MAC[10,6062,LAT] 1985-09-06 12:20:00, Edit by APPELLOF
    19					; Add routine NETDIL to support NETOP. function to tell user
    20					; the node name and port name for a TTY.
    21					;DSKC:LATSER.MAC[10,6062,MCO] 1985-08-23 12:20:00, Edit by APPELLOF
    22					; Fix bug in RELSB0, check SB.FLG(SB) not SB.FLG(CB)
    23					;DSKB:LATSER.MAC[10,6026,KNISER] 1985-07-29 16:08:52, Edit by DAVENPORT
    24					; Changes to track renaming of UNSPI to UNSID in ETHSER.
    25					;DSKB:LATSER.MAC[10,6062,LAT] 1985-07-29 14:55:21, Edit by APPELLOF
    26					; Fix BLDSTM to use correct length for start message.
    27					;  There are ^d20 bytes of fixed info, not ^d12
    28					;DSKB:LATSER.MAC[10,6062,LAT] 1985-07-11 14:55:21, Edit by APPELLOF
    29					; Get "OBJ_SRVC" from start slot.  Also get "OBJECT_PORT_NAME" and
    30					; "SUBJECT_PORT_NAME" from the parameter list of the start slot in
    31					; case these are provided by the server.  When all servers provide
    32					; the "SUBJECT_PORT_NAME" then we can tell which port on a server
    33					; is connected to a particular "TTYnnn" on the host.
    34					;DSKB:LATSER.MAC[10,6062,LAT] 1985-07-11 14:55:21, Edit by APPELLOF
    35					; Don't scan for LDB's needing output until we are done with
    36					;  input processing.  This may make echo more responsive.
    37					;  Do this by moving the call to LATSCN to the start of LAMUX
    38					;DSKB:LATSER.MAC[10,6062,LAT] 1985-07-11 09:48:21, Edit by APPELLOF
    39					; In HRUNCB, range-check the CB index we get.
    40					; If it's bad (CB > CBMAXI or CB=0) go to ILLMS0, not ILLMES.
    41					;DSKB:LATSER.MAC[10,6062,LAT] 1985-07-02 08:48:21, Edit by APPELLOF
    42					; Replace zeros in dispatch tables SLTDSP and CBRDSP
    43					;  so we don't EUE if we get a bad dispatch code.
    44					;DSKC:LATSER.MAC[10,6062,LAT] 28-Jun-85 09:15:00, Edit by APPELLOF
    45					; Save some registers across call to RBPOST in LAINTR.
    46					; In HSSTOP, ignore a stop slot if the destination ID is 0.
    47					;  This is contrary to LAT archeticture, but avoids a LAT-11 bug in
    48					;   the same way VMS does.
    49					;DSKC:LATSER.MAC[10,6062,LAT] 7-Jun-85 10:17:00, Edit by APPELLOF
    50					; In LAINTR re-post receive buffers immediately if they have errors.
    51					; In LSDMUX, calculate byte pointer for next slot in message
    52					;DSKC:LATSER.MAC[10,6062,LAT] 1985-05-07 09:13:04, Edit by APPELLOF
    53					; Add routine CWHLAT to support TOPS10 WHERE command.
    54					;DSKT:LATSER.MAC[10,6026,KNISER] 1985-03-18 13:22:10, Edit by DAVENPORT
    55					; Search ETHPRM instead of NIPAR on TOPS-10.
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 1-1
LATSER	MAC	19-Aug-74 07:34	

    56					;DSKB:LAT.MAC[10,6062,LAT] 1985-03-14 11:05:40, Edit by APPELLOF
    57					; In SSERVC, set flag HNSVN to show we added a service.
    58					;DSKB:LAT.MAC[10,6062,LAT] 1985-03-11 10:59:47, Edit by APPELLOF
    59					; Don't croak LAT circuits when the NI goes down.  It will probably
    60					;  come up soon.  Just rely on normal time-out to bring things to a halt.
    61					;DSKB:LAT.MAC[10,6062,LAT] 1985-03-08 10:59:47, Edit by APPELLOF
    62					; Take argument value in milliseconds for LATOP function
    63					;  SET RETRANSMIT TIMER nnn
    64					;  This used to be "SET CIRCUIT-TIMER" but that's not what it really is.
    65					;  Take the user-supplied value and convert to scheduler ticks for use.
    66					;
    67					;DSKB:LAT.MAC[10,6062,LAT] 1985-02-22 10:59:47, Edit by APPELLOF
    68					; Change back to NOT conforming to LAT spec.  Only set RRF flag
    69					;  when we use the last buffer.  Setting it when we send a credit-
    70					;  consuming slot only seems to increase the ethernet traffic.
    71					;DSKB:LAT.MAC[10,6062,LAT] 1985-02-20 08:18:32, Edit by APPELLOF
    72					; Conform to the DNA LAT spec: Set the RRF flag whenever we send a message
    73					;  with credit-consuming slots. (We already set it if we use the last
    74					;  transmit buffer).
    75					; When we are in balanced mode and find we have no data to send after
    76					;  MXBALC scheduler cycles, wait another MXBALC cycles before trying again
    77					;  to send unsolicited data.
    78					; While we are in balanced mode, run a server keep alive timer:
    79					;  The timer is zeroed whenever we get a RUN message from the server.
    80					;  If the timer ticks MXBALC * SERVER_KEEP_ALIVE_TIMER seconds without
    81					;  getting zeroed, it probably means the server is dead since he is
    82					;  supposed to send us a keep-alive message every so often.  Kill the
    83					;  circuit at this point.
    84					; When terminating a circuit because there are no more slots left,
    85					;  send the correct circuit-stop reason.
    86					;BLKK:LATSER.MAC[7,7032] 1985-02-15 15:40:14, Edit by APPELLOF
    87					; Change CBRID to CBLID in HMSTOP.  We should verify stop message
    88					;  against our local ID.  This will make us pay attention to a
    89					;  STOP message received from the server.
    90					;BLKK:LATSER.MAC[7,7032] 1985-02-10 14:38:52, Edit by APPELLOF
    91					; When we recieve a STOP message, release all circuit resources
    92					;  instead of just putting the circuit on the inactive queue.
    93					;BLKK:LATSER.MAC[7,7032] 1985-02-10 14:05:52, Edit by APPELLOF
    94					; Zero NSLOTS just after LANXCB, not in BLDMSL.  That way, if there
    95					;  is no data to send, but we have to send a message anyway, the
    96					;  "number_of_slots" field will be correct in the message.
    97					; In MTTSTP, if CBRID is 0 in the circuit block (maybe because we
    98					;  have already de-activated the circuit), then just use MSGSID to
    99					;  send a stop message to the server.  This should work if we are just
   100					;  sending a stop message in response to an illegal message of some kind.
   101					;  Should fix problem of the host crashing DECSA servers
   102					;  If we ever call MTTSTP to send an unsolicited stop message, this
   103					;  scheme won't work (but it should never happen).
   104					;BLKK:LATSER.MAC[7,7032] 1985-02-07 12:41:52, Edit by APPELLOF
   105					; Fix bug in HMSTOP.  Don't SKIPA into ILLMES by mistake.
   106					;DSKC:LATSER.MAC[10,6062,LAT] 1985-02-01 10:04:41, Edit by APPELLOF
   107					; Add privilege checking for .LASET/CLR functions of LATOP.
   108					;DSKC:LATSER.MAC[10,6062,LAT] 1985-01-31 09:00:52, Edit by APPELLOF
   109					; Change the name of this module to an honest TOPS-10 name.
   110					; convert XMOVEI T2,CHKRFB/CALLRET GETCLP to JSP T2,GETCLP (saves XMOVEI)
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 1-2
LATSER	MAC	19-Aug-74 07:34	

   111					;DSKT:LATSRV.MAC[10,6026,DECNET] 29-Jan-85:08:13:00, Edit by DAVENPORT
   112					; Interlock interrupt level access to the NI queue.
   113					;DSKB:LATSRV.MAC[10,6016,CRECLP] 22-Jan-1985:13:23:00, Edit by DZIEDZIC
   114					; Change clock level buffer allocation to match new VMSER conventions.
   115					;BLKK:LATSRV.MAC[30,5653,CTERM] 27-Dec-1984:00:39:01, Edit by SPIDER
   116					; Add code to use the auto-disconnect feature of the TOPS-10 monitor to
   117					;  disconnect idle lines.
   118					;DSKC:LAT.MAC[10,6062,LAT] 1984-12-26 08:43:00, Edit by APPELLOF
   119					; Truncate CBTSQ (transmit sequence number) to 8 bits when incrementing it.
   120					; Eliminate LAPRBF stopcode.  Just give error to caller if we can't
   121					;  post a receive buffer (NI probably went down).
   122					; Make LATLSC routine set the multicast timer to 1 when NI comes up
   123					;  so that the multicast code (including GETRBF) will be called at next
   124					;  second.  This way, receive buffers will be posted soon after the NI
   125					;  comes up. This makes the code to call GETRBF at multicast time permanent.
   126
   127					;DSKC:LAT.MAC[10,6062,LAT] 1984-12-17 15:50:00, Edit by APPELLOF
   128					; Fix routine CBGNIX to wrap properly when we reach max circuit index.
   129					; Avoid entry 0 of the CB vector.
   130					;BLKK:LATSRV.MAC[1,2] 1984-12-17 12:50:00, Edit by APPELLOF
   131					; Put LAHNDB at the end of CNFTBL in COMMON so it will be
   132					; GETTABable.  Make it EXTERNAL in LATSRV.  Add UUOSYM symbol for
   133					; the GETTAB (%CNLHN)
   134					;DSKB:LATSRV.MAC[10,6026,KNISER] 1984-12-17 09:35:00, Edit by DAVENPORT
   135					; Change use of SYSPIF/SYSPIN and CONO PI,PI.OFF/PI.ON into uses
   136					;  of ETHLOK/ETHULK.
   137					;DSKC:LAT.MAC[10,6062,LAT] 1984-12-11 09:40:00, Edit by APPELLOF
   138					; Adjust LATREM to understand SCNSER's new conventions.
   139					; Make LTHNGU a subfunction which gets called through the ISRREM entry
   140					; pointer in the SCNSER dispatch vector.
   141					;DSKC:LAT.MAC[10,6062,LAT] 1984-12-03 12:30:00, Edit by APPELLOF
   142					; Fix another race (and IME).  In LATSCN, proceed only if there
   143					;  is a slot block address in LDBLAT(U)
   144					;DSKC:LAT.MAC[10,6062,LAT] 1984-11-29 15:55:00, Edit by APPELLOF
   145					;  In GETRBF, save buffer address in case RBPOST fails.
   146					;DSKC:LAT.MAC[10,6062,LAT] 1984-11-26 12:30:00, Edit by APPELLOF
   147					; Fix race.
   148					;  Change CHNON/OFF to CONO PI,KNIPIN/PIF. In MOVNIQ, need to use
   149					;  SYSPIN/PIF to get a system-wide interlock
   150					;DSKC:LATKS.MAC[10,6062,LAT] 1984-11-21 10:00:00, Edit by APPELLOF
   151					; Conditionalize enough under FTXMON so this will work on a KS10
   152					; Remove definitions of XBLTUX and XBLTXU.  They are defined in S
   153					;DSKC:LAT.MAC[10,6062,LAT] 1984-11-19 11:00:00, Edit by APPELLOF
   154					; In HMSTRT, if a circuit is in "running" state when we receive
   155					;  a START message, release all existing buffers before re-initializing
   156					;  the circuit.
   157					;DSKT:LATSRV.MAC[10,6026,KNISER] 1984-11-16 14:55:00, Edit by DAVENPORT
   158					; Change core allocation routines to use new GETEWZ/GETEWS/GIVEWS routines.
   159					;DSKC:LAT.MAC[10,6062,LAT] 1984-11-14 09:00:00, Edit by APPELLOF
   160					; Set HNRUN flag to indicate "NI not running" until we know for
   161					;  sure that it is running.  The NI will be marked running in one of
   162					;  two places: In LATINI right after the call to DLLUNI to OPEN a portal
   163					;  if the returned state of the NI is "running". Otherwise, it will be
   164					;  marked running in LATLSC when the NI finally comes on line.
   165					; Don't go very far in once-a-second code unless NI is running.
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 1-3
LATSER	MAC	19-Aug-74 07:34	

   166					;   This will make LATSRV behave ok if running on a machine which does
   167					;   not have an NI.
   168					;DSKC:LAT.MAC[10,6062,LAT] 1984-11-05 15:00:00, Edit by APPELLOF
   169					; Bit reverse each 8-bit byte of access codes when
   170					;  SETting/CLEARing/SHOWing them.
   171					;DSKC:LAT.MAC[10,6062,LAT] 1984-11-05 09:00:00, Edit by APPELLOF
   172					; In MDLXBF, if a buffer is no longer in DLL, free it.
   173					; At XMTMX0 + a few, if transmit fails, and don't have a CB, free the buffer.
   174					; Speed up XMTMS0 a little by eliminating IFSKP.
   175					; Speed up XMTDON a little: change LOAD, TLZ, STOR, to MOVX, ANDCAB
   176					;DSKC:LAT.MAC[10,6062,LAT] 1984-11-02 08:09:00, Edit by APPELLOF
   177					; Fix MTTSTP to behave correctly when the NI is not running.
   178					;   Always use temp xmit buffer.  Always send message with UNUID of 0.
   179					; Make MDLXBF loop through ALL buffers in ACK queue and unqueue them too.
   180					; Fix XMTDON not to reference CB variables if there is no CB.
   181					; Make RFXBFS return buffer header as well as buffer.
   182					; Add entry point XMTMSN to XMTMSG routine to send a message
   183					;   which will not be ACKed.
   184					;DSKC:LAT.MAC[10,6062,LAT] 1984-10-25 10:50:54, Edit by APPELLOF
   185					; At XSLDA2+??? Look at sign bit (LDLIDL) of LDBDCH to see
   186					; if a line is idle.  This fixes some LAT terminal hangs.
   187					;DSKB:LAT.MAC[10,6062,LAT] 1984-10-24 11:15:00, Edit by APPELLOF
   188					; Make LATIMT only a BUGINF, report message type.
   189					;DSKB:LAT.MAC[10,6062,LAT] 1984-10-18 10:47:00, Edit by APPELLOF
   190					; Fix TMRCHK to store retransmit timer value in circuit block
   191					; Fix MTTRUN to set RRF flag before building message header
   192					; Don't include location string in LASTC information
   193					; Make "SET STATE ON(OFF)" change multicast message header
   194					; Range check for max connects should be from 1 to NTTLAH
   195					;DSKB:LAT.MAC[10,6062,LAT] 1984-10-12 10:25:00, Edit by APPELLOF
   196					; Change UMVAZS for the fun of it.
   197					; Redefine XBLTUX and XBLTXU to make code easier to read
   198					; Remove SE1ENT at start of LATOP. (UUOCON already does it)
   199					;DSKB:LAT.MAC[10,6062,LAT] 1984-10-11 14:16:47, Edit by APPELLOF
   200					; Do away with MSDADR.  The address of the buffer is already
   201					; kept in the header MSD at MD.NXT+MDB.OF(XB)
   202					;DSKB:LAT.MAC[10,6062,LAT] 1984-10-10 15:08:55, Edit by APPELLOF
   203					; Make everything which does receive message processing end up by
   204					; releasing the receive buffer.  Fixes LAT hang.
   205					; Make all BEGSTR field lengts be defined by symbols
   206					; Check for last transmit buffer should be in MTTRUN, not BLDMSL
   207					;DSKB:LAT.MAC[10,6062,LAT] 1984-10-08 15:25:16, Edit by APPELLOF
   208					; Make everything which gets to INFSTP use a JSP T2, so we can tell
   209					;  which routine did it.
   210					;DSKB:LAT.MAC[10,6062,LAT] 1984-10-08 12:20:53, Edit by APPELLOF
   211					; Make BUFSIZ be equal to PAGSIZ so we never allocate buffers
   212					;  which cross page boundaries.
   213					; Preserve P1-P4 in LATOP. UUO
   214					; Don't address check a zero length show buffer.
   215					; Keep track of HNNCC (number of allocated CBs) for LASAS function.
   216					;DSKB:LAT.MAC[10,6062,LAT] 1984-10-05 13:15:23, Edit by APPELLOF
   217					; Fix various LATOP. bugs:
   218					;  Don't address check show buffer for .LAZCO
   219					;  When checking user buffer count, use only right half
   220					;  In LAZCO, when zeroing counters, XBLT (n-1) words
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 1-4
LATSER	MAC	19-Aug-74 07:34	

   221					;  At LASTCN, change -1(P) to (P)
   222					;  In LAS1C, can't use XMOVEI on user address, must use MOVE, ADDI
   223					;  
   224					;DSKB:LAT.MAC[10,6062,LAT] 1984-10-02 08:46:43, Edit by APPELLOF
   225					; Add code to do .LASTC for TOPS-10
   226					;DSKB:LAT.MAC[10,6062,LAT] 1984-10-01 10:53:55, Edit by APPELLOF
   227					; Use different ACs for Q1 and Q2 (TOPS10)
   228					; Fix pointer to node name in BMCRAT (was off-by-1 byte)
   229					; Make Node name and location 7-bit ASCII
   230					; If we get a RUN message without any circuit block, make it illegal message
   231					; Keep track of number of active connects in HNCON
   232					; 
   233					;DSKB:LAT.MAC[10,6062,LAT] 1984-09-28 10:32:05, Edit by APPELLOF
   234					; Move TMPBLK to data section to avoid IME
   235					; Make CLRCOD use mask to clear group codes
   236					; Define our own PXCT macros for use with XBLT
   237					;
   238					;DSKB:LAT.MAC[10,6062,LAT] 1984-09-26 09:29:25, Edit by APPELLOF
   239					; Don't release buffer in XMTDON, do it in NXTACK
   240					; Don't increment receive credits in CRECHK.  Do it in XSLDTA or DTB
   241					; after we know we have a buffer and can really use the credit.
   242					;
   243					;PIE0:LAT.MAC[10,6062] 1984-09-21 14:16:28, Edit by APPELLOF
   244					; Fix off-by-one bug in MMGTZW.
   245					; Zero LATRFB after acquiring more free core.
   246					;
   247					;DSKB:LAT.MAC[10,6062,LAT] 1984-09-17 00:36:16, Edit by APPELLOF
   248					; Put flag SBXNF in slot block. Remembers if we are doing XON/XOF.
   249					; Use "saved character" concept like NETMCR's LDPCHR/LRLTTO
   250					; This way, we don't get a xmit buffer unless there is data to send.
   251					;DSKB:LAT.MAC[10,6062,LAT] 1984-09-07 13:17:07, Edit by APPELLOF
   252					;start putting in our own core management
   253					;
   254					;DSKB:LATSRV.MAC[10,6062,LAT] 1984-08-31 14:42:58, Edit by APPELLOF,C
   255					; For now, call GETRBF when we do multicast. Just in case we lost a
   256					; buffer, we can poke HNNRB by hand, and will get another buffer to get
   257					; LAT running again.
   258					; Fix DATA_B slot generation to agree with VMS definition of fontrol.
   259					; At CMDACT, zero the remote ID (CBRID), not CBLID
   260					; In XBFGVC, always take non-skip.  Also call RELXBF to return buffer.
   261					; In LATINI, allocate <HC.LST+1> words, not <AC.LST+1> for HN block.
   262					;DSKB:LAT.MAC[10,6062,LAT] 1984-08-20 14:06:01, Edit by APPELLOF,C
   263					; In LATINI, stuff the host id string into the service id too.
   264					; Set up byte pointer to xmit buffer at SENDMC
   265					; Get rid of all the damn ..nnnn symbols at the end of assembly
   266					;  Latest merge of TOPS20.  Still without LATOP.
   267					; UPD ID= 731, SNARK:<6.1.MONITOR>LATSRV.MAC.17,   8-Aug-84 13:22:49 by WEISBACH
   268					;   In RELSB, don't call TTYDE0 if there is a controlling job for the 
   269					;    terminal otherwise JOBCOF code will do it again and cause a
   270					;    TTNAC7 BUGCHK.
   271					; UPD ID= 729, SNARK:<6.1.MONITOR>LATSRV.MAC.16,   6-Aug-84 17:35:23 by WEISBACH
   272					;   Clear the local slot block ID in routine XSLSTP before transmitting the
   273					;    stop slot.  Create a new routine RLSBID to do this.
   274					;   BUGCHK in LATCBR only for NISRV callback function codes which are out of
   275					;    range.
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 1-5
LATSER	MAC	19-Aug-74 07:34	

   276					;   In IGNSLT, set SLTCNT to zero so slot data is truly ignored.
   277					;   XSLDTA decrements the transmit credits too soon in the case of page
   278					;    stop.  Move the decrement to after the XSLDA1 loop.
   279					;   Fix incarnation count so random number used properly at initialization.
   280					;   Set description field length back to ^D64
   281					;DSKB:LATSRV.MAC[10,6062,LAT] 1984-08-03 10:13:12, Edit by APPELLOF,C
   282					; Fix XSLSTP so stop slot has 0 for local slot ID in message
   283					;DSKB:LATSRV.MAC[10,6062,LAT] 1984-08-03 07:57:35, Edit by APPELLOF,C
   284					; Merge latest and greatest stuff together.  Omit LATOP. for now
   285					; Fix IGNSLT to ignore correctly.  Fix LTSSDC to work if slot block
   286					; has disappeared. 
   287					;
   288					; UPD ID= 695, SNARK:<6.1.MONITOR>LATSRV.MAC.15,  19-Jul-84 18:13:30 by WEISBACH
   289					;   CC.LST, not CC.LEN, is the length to use when allocating storage for a CB!!
   290					; UPD ID= 694, SNARK:<6.1.MONITOR>LATSRV.MAC.14,  18-Jul-84 18:15:19 by WEISBACH
   291					;   Drop node description field length back to ^D16.
   292					; UPD ID= 690, SNARK:<6.1.MONITOR>LATSRV.MAC.13,  17-Jul-84 10:20:42 by WEISBACH
   293					;   Some LASCH and LASCO bug fixes.
   294					;   Add setting of change flags for service rating or description change.
   295					;     This must be done in SSERVC rather than in LASET.
   296					;   Length of GBHID field of GB BEGSTR should be 13., not 16.
   297					;   Raise node description field length maximum in multicast msg to ^D64
   298					;   Not enough memory requested for circuit blocks
   299					; UPD ID= 633, SNARK:<6.1.MONITOR>LATSRV.MAC.12,  19-Jun-84 05:56:03 by WEISBACH
   300					;   LTSOF must be global.
   301					; UPD ID= 631, SNARK:<6.1.MONITOR>LATSRV.MAC.11,  18-Jun-84 14:00:33 by WEISBACH
   302					;   Add LATOP% JSYS
   303					;   Halt all circuits when NI goes away.
   304					;   In CRECHK, force fork wakeup if the remote has used up all credits and
   305					;    we cannot give him more until he reads the input.
   306					;   In RELSB, release the TDB after doing the carrier loss action.
   307					;   After a slot session is rejected, release the slot.
   308					;   Save the circuit stop reason properly in MTTSTP.
   309					;   Save the circuit's remote ID properly for MTTSTP when a CB exists.
   310					;   In CBINIT, clear CBFLG and CBSDC.  Change to to a BLT for the clear.
   311					;   Fix RELSB to return right value in SB so that slot mux can continue
   312					;    properly.
   313					;   Clear TTPRM before calling NTYCOF so don't have to clobber W1 by using
   314					;    is as a save register.
   315					;   In BSLTHD, T2 cannot be used to save register because LAP2B0 clobbers it.
   316					;   In CBDACT, T2 is not preserved by LAUNQ so don't assume it.
   317					;   Fix CMNIAD. Its comparison of NI address never worked right.
   318					;   Terminate a circuit if the number of slots active goes to zero.
   319					;   In XSLSTP, release the slot (call RELSB).
   320					;   Make LAP2Bx preserve the caller's T1.
   321					;   Let LTHNGU do something -- kill the slot associated with the terminal.
   322					;   Add device dependent routine for specifying LAT terminals as high speed
   323					;    output terminal.
   324					;   Fix RANDOM.
   325					;DSKB:LATSRV.MAC[10,6062,LAT] 1984-07-20 13:04:49, Edit by APPELLOF,C
   326					; Fix CVTNOD. Make LATRTQ 2 words for 7.03. Store long system name too.
   327					;Still have problem with F being trashed by SCNSER.
   328					;(F is Frame pointer for TRVAR used in LARSCH)
   329					;
   330					;DSKB:LATSRV.MAC[10,6062,LAT] 1984-06-18 10:43:01, Edit by APPELLOF,C
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 1-6
LATSER	MAC	19-Aug-74 07:34	

   331					; Change once-a-tic and once-a-second code to only go on CPU0
   332					; Add standard once-a-tic name for TOPS-10 "LATSTO:"
   333					;
   334					;DSKB:LATSRV.MAC[10,6062,LAT] 1984-06-11 09:22:51, Edit by APPELLOF,C
   335					; Change the way TOPS-10 builds a DATA_A slot.  As ANF10 says:
   336					; "We don't really know if SCNSER has a character for us until we ask it."
   337					; Therefore, don't assume that we know how many characters we will output.
   338					;
   339					; UPD ID= 590, SNARK:<6.1.MONITOR>LATSRV.MAC.10,   1-Jun-84 18:02:02 by WEISBACH
   340					;   Turn off interrupts earlier in LTSSDC so that scheduler level does not
   341					;   take out the slot block from under process level if the LAT session
   342					;   gets disconnected with output in progress.
   343					; UPD ID= 588, SNARK:<6.1.MONITOR>LATSRV.MAC.9,   1-Jun-84 10:52:57 by WEISBACH
   344					;   Change maximum slot size MXSLSI to 40 decimal to correspond to 9600
   345					;    baud input assuming two credits.
   346					;   One too may bytes in START message. NBR_DL_BUFS entered twice.
   347					; UPD ID= 577, SNARK:<6.1.MONITOR>LATSRV.MAC.8,  29-May-84 14:52:19 by WEISBACH
   348					;If the output TTY buffer count (TTOCT) is zero, always clear TTOTP
   349					; when exiting routine XSLDTA.
   350					;Fix method of determining the start of next slot in a multi-slot message
   351					; when slot lengths not a multiple of 2.
   352					;Use the new host multicast address.
   353					; UPD ID= 564, SNARK:<6.1.MONITOR>LATSRV.MAC.7,  24-May-84 16:07:34 by WEISBACH
   354					;Fix transmissions - transmit loop never terminated.
   355					; UPD ID= 560, SNARK:<6.1.MONITOR>LATSRV.MAC.6,  24-May-84 15:03:25 by WEISBACH
   356					;Add fairness to slot block processing in routine BLDMSL.
   357					;On occurence of errors from NISRV, re-post receive buffers to NISRV in
   358					;scheduler cycle instead of at NI interrupt level.  Also save NISRV's T3.
   359					;DSKC:LATSRV.MAC[10,6062,LAT] 1984-05-25 12:26:46, Edit by APPELLOF,C
   360					; Get rid of register MD in scheduler cycle. Eliminate indexed byte pointer.
   361					;DSKC:LATSRV.MAC[10,6062,LAT] 1984-05-24 14:54:05, Edit by APPELLOF,C
   362					; add TOPS10 code and conditionals
   363					; UPD ID= 535, SNARK:<6.1.MONITOR>LATSRV.MAC.5,  21-May-84 14:04:19 by WEISBACH
   364					;Fix GTCSTR so that it will skip over a string properly is it is not be
   365					; be copied (count to move equals 0).
   366					;In the SBFLG word, reverse to order of SBOUT and SBFOU so that output is
   367					; always flushed before new data is sent.
   368					;Rearrange the CB BEGSTR, getting rid of the SM BEGSTR by incorporating it
   369					; directly into CB.
   370					; UPD ID= 524, SNARK:<6.1.MONITOR>LATSRV.MAC.4,  17-May-84 23:47:29 by WEISBACH
   371					;Clear RRF in LAMUX at start. Set RRF when transmitting last buffer.
   372					;Store back adjusted byte pointer in HSDATB and IGNSLT.
   373					;Fix in HDRDAT the skip around two instructions.
   374					;Ensure that slots start on an even byte boundary and make sure we expect
   375					; received slots to start on an even boundary.
   376					;Correct the size required for transmit and receive buffers.
   377					;In MMGTZW, call DNGWDZ, not DNGWDS.
   378					;In BMCFXD set the preferred server circuit timer to be 80 ms because of
   379					; a server bug which does not allow 0.
   380					;In routine HSDATA, TTCHI has a skip return; it also preserves T2 so take
   381					; setting of T2 outside the loop.
   382					;Change all jumps to R to be jumps to RTN for benefit of TOPS-10
   383					; UPD ID= 507, SNARK:<6.1.MONITOR>LATSRV.MAC.3,   7-May-84 14:10:04 by WEISBACH
   384					;First Version $$$$$
   385
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 1-7
LATSER	MAC	19-Aug-74 07:34	

   386
   387					;THIS SOFTWARE IS FURNISHED UNDER A LICENSE AND MAY ONLY BE USED
   388					;  OR COPIED IN ACCORDANCE WITH THE TERMS OF SUCH LICENSE.
   389					;
   390					;COPYRIGHT (c) 1985,1986 BY
   391					;DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.
   392					;ALL RIGHTS RESERVED.
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 2
LATSER	MAC	19-Aug-74 07:34	

   393					IFNDEF FTOPS20,<FTOPS20==0>
   394					IFNDEF FTOPS10,<FTOPS10==-1>
   395					IFN FTOPS20,<	SEARCH MACSYM,MONSYM,PROLOG,TTYDEF>
   396					IFN FTOPS10,<	SEARCH	F,S,D36PAR,MACSYM
   397
   398					.CPYRT<1985,1986>^
   399
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 3
LATSER	MAC	19-Aug-74 07:34		TOPS10 redefinitions of TOPS20 things

   400						SUBTTL  TOPS10 redefinitions of TOPS20 things
   401
   402		   600000  000000		OPDEF	NOP[TRN]
   403						DEFINE	RESCD	<$HIGH>	;TOPS-10 EQUIVALENT
   404						DEFINE	SWAPCD	<$HIGH>
   405						DEFINE	RESDT	<$LOW>
   406						DEFINE	NOSKD1	<>	;DON,T HAVE TO WORRY ABOUT THESE
   407						DEFINE	OKSKD1	<>	;  IN TOPS10
   408						DEFINE	MCENT	<>	; or this one either
   409						EXTERN	BITTBL
   410						DEFINE BITS,<BITTBL>
   411
   412					; XCTU is used for "normal" instructions which move data from User to eXec
   413					;	and eXec to User
   414					;
   415						DEFINE	XCTU	<PXCT 4,>	;For all "normal" instructions
   416						DEFINE	XCTBU	<PXCT 3,>	;To load from and deposit to user
   417										;with byte pointer in eXec
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 4
LATSER	MAC	19-Aug-74 07:34		Definitions - KS10 conditionals

   418						SUBTTL	Definitions - KS10 conditionals
   419					IFE FTXMON,<
   420					;
   421					; Redefine some stuff if we running non-extended (KS10 especially)
   422					;
   423						DEFINE OWGP. (SS,ADR,POS),<POINT SS,ADR,POS>
   424					
   425						DEFINE XBLT.(AC<T1>),<
   426					IFN <AC>-T1,<PRINTX ? CAN'T XBLT VIA AC, USE T1>
   427						PUSHJ P,XBLTA##
   428					>
   429					
   430					>; END IFN FTXMON
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 5
LATSER	MAC	19-Aug-74 07:34		Symbol purging macros

   431						SUBTTL Symbol purging macros
   432					;
   433					;	Define some macros which will help purge all symbols of
   434					;	the form ..nnnn at the end of assembly.  This will get rid
   435					;	of about 200 useless symbols generated by .IFSKP and friends
   436
   437						define	eq(a,b),<a==b>
   438
   439						define	highest(sym,%tg),< ;;Macro to find highest generated symbol
   440						....==sixbit/%tg/&000077777777 ;;Isolate the nnnn part of ..nnnn
   441						eq(sym,\'....)
   442						purge	....>
   443
   444						define	prgnum(n),<	;;Macro to purge symbol named ..nnnn
   445						....==sixbit/n/		;;given a number n
   446						ifl <n-1000>,<....==<..../100>!sixbit/0/> ;;make leading zero fill
   447						ifl <n-100>,<....==<..../100>!sixbit/0/>
   448						ifl <n-10>,<....==<..../100>!sixbit/0/>
   449						prgsym(..,\'....)
   450						purge	....>
   451
   452						define prgsym(sy1,sy2),<
   453						purge sy1'sy2
   454					>
   455
   456						define	prgall,<	;;End product: macro to purge all symbols
   457					if2,<				;;of the form ..nnnn
   458						highest XX		;;Use this just before END statement
   459						nn==XX
   460						repeat XX,<prgnum(\nn)
   461							nn==nn-1>
   462					
   463						nn==.npac
   464						repeat	.npac,<prgsym(.fpac,\nn)	;;get rid of .fpacN symbols
   465								nn==nn-1>
   466						purge	nn,XX,.npac>
   467					>
   468
   469					;
   470					;
   471					; Redefine TRVAR to allocate static storage on TOPS-10
   472					; This is so we don't have to have a frame pointer in TOPS-10
   473					; If we ever run into a TRVAR in code, we will die
   474					;
   475					DEFINE TRVAR(LIST),<
   476					IRP LIST,<
   477					LIST:	BLOCK	1
   478					>>
   479
   480					DEFINE ACDEF(N,AC),<.FPAC'N==AC>
   481
   482					DEFINE	FREEAC(AC),<
   483					.NPAC==0
   484					IRP AC,<
   485					ACDEF(\.NPAC,AC)
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 5-1
LATSER	MAC	19-Aug-74 07:34		Symbol purging macros

   486					.NPAC==.NPAC+1
   487					>>
   488
   489					FREEAC <W,M,P1,P2,P3,P4,J>	^
   490					^;These are all the ACs available for ACVAR
   491									;Explicitly do NOT use "U" since it is used
   492									;for the normal TOPS-10 function to point to
   493									;an LDB throughout the code
   494
   495					DEFINE ACVAR (LIST)<
   496						..NAC==0		;;INIT NUMBER OF ACS USED
   497						IRP LIST,<
   498						  .ACV1 (LIST,\..NAC)		;;PROCESS ITEMS
   499						..NAC==..NAC+1>
   500						SAVEAC (<LIST>)		;;SAVE ACS USED (QUICK AND DIRTY)
   501						DEFINE ENDAV.<.ENAV1 <LIST>>>
   502
   503					DEFINE .ACV1 (ITEM,N)<
   504						.ACV2 (ITEM,N)>		;;PEEL OFF ANGLEBRACKETS IF ANY
   505
   506					DEFINE .ACV2 (NAM,N)<
   507					   IFDEF NAM,<.IF NAM,SYMBOL,<PRINTX ACVAR NAM ALREADY DEFINED>>
   508						NAM==.FPAC'N	;;DEFINE VARIABLE
   509						$'NAM==NAM		;;FOR DDT
   510					>
   511
   512					DEFINE .ENAV1 (ARGS)<
   513						IRP ARGS,<
   514						  .ENAV2 (ARGS)>>
   515
   516					  DEFINE .ENAV2 (ARG)<
   517						.ENAV3 (ARG)>
   518
   519					  DEFINE .ENAV3 (NAM,SIZ)<
   520						PURGE NAM,NAM
   521					  >
   522		   	   000023		XOFFC=="S"-100		;XOFF CHARACTER
   523		   	   000021		XONC=="Q"-100		;XON CHARACTER
   524					>;end IFN FTOPS10
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 6
LATSER	MAC	19-Aug-74 07:34		Symbol purging macros

   525
   526					IFN FTOPS20,<	SEARCH	NIPAR>
   527					IFN FTOPS10,<	SEARCH	ETHPRM>
   528							SALL
   529
   530					IFN FTOPS20,<	TTITLE (LATSRV,,< -- LAT-20 Terminal Host>)>
   531					IFN FTOPS10,<	TITLE	LATSER -- LAT-10 Terminal Host
   532
   533						$RELOC
   534
   535					;THIS SOFTWARE IS FURNISHED UNDER A LICENSE AND MAY ONLY BE USED
   536					;  OR COPIED IN ACCORDANCE WITH THE TERMS OF SUCH LICENSE.
   537					;
   538
   539		   	   000001		XP	VLATSER,1	;PUT VERSION NUMBER IN STORAGE MAP AND GLOB
   540					>;end IFN FTOPS10
   541
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 7
LATSER	MAC	19-Aug-74 07:34		Definitions - Literals - Circuit Parameters

   542						SUBTTL	Definitions - Literals - Circuit Parameters
   543
   544					;
   545					;LAT Virtual Circuit Message Types
   546					;
   547		   	   000000		MT.RUN==0		;RUN message
   548		   	   000001		MT.STA==1		;START message
   549		   	   000002		MT.STP==2		;STOP message
   550		   	   000012		MT.MCA==^D10		;Multicast message
   551
   552
   553					;LAT Virtual Circuit States
   554					;
   555
   556		   	   000000		CS.HLT==0		;HALTED
   557		   	   000001		CS.STA==1		;STARTING
   558		   	   000002		CS.RUN==2		;RUNNING
   559		   777777  777777		CS.TRN==-1		;In transition between HALTED and STARTING
   560		   	   000010		CS.SPG==10		;STOPPING
   561
   562					;
   563					;Circuit STOP message reason codes
   564					;
   565
   566		   	   000001		CE.NSL==1		;No slots connected on circuit
   567		   	   000002		CE.ILL==2		;Illegal message or slot format
   568		   	   000003		CE.HLT==3		;Circuit halted by local system
   569		   	   000004		CE.NPM==4		;No progress being made
   570		   	   000005		CE.TIM==5		;Time limit expired
   571		   	   000006		CE.LIM==6		;Retransmit limit exceeded
   572		   	   000007		CE.RES==7		;Insufficient resources
   573		   	   000010		CE.STO==10		;Server circuit timer out of range
   574		   	   000011		CE.SKW==11		;Protocol version skew
   575		   	   000012		CE.INV==12		;Invalid Message
   576
   577					;Circuit STOP reason codes of local significance only
   578
   579		   	   000200		CE.NIH==200		;Local NI halted
   580
   581		   	   000010		MMHDSI==^D8		;Minimum Message Header Size
   582		   	   000020		MSTMSI==^D16		;Minimum START Message Size(excluding header)
   583
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 8
LATSER	MAC	19-Aug-74 07:34		Definitions - Literals - Slot Parameters

   584						SUBTTL	Definitions - Literals - Slot Parameters
   585
   586					;
   587					;LAT Slot Types
   588					;
   589
   590		   	   000000		ST.DTA==0		;DATA_A slot
   591		   	   000011		ST.STA==11		;START slot
   592		   	   000012		ST.DTB==12		;DATA_B slot
   593		   	   000013		ST.ATT==13		;ATTENTION slot
   594		   	   000014		ST.REJ==14		;REJECT slot
   595		   	   000015		ST.STP==15		;STOP slot
   596
   597					;
   598					;LAT Slot States
   599					;
   600
   601		   	   000000		SS.HLT==0		;Halted
   602		   	   000001		SS.RUN==1		;Running
   603
   604					;
   605					; SLOT Reject and Stop Reason Codes
   606					;
   607
   608		   	   000001		SE.USR==1		;User requested disconnect
   609		   	   000002		SE.SHU==2		;System shutdown in progress
   610		   	   000003		SE.ISR==3		;Invalid slot received
   611		   	   000004		SE.SER==4		;Invalid service class
   612		   	   000005		SE.RES==5		;Insufficient resources available
   613
   614					;
   615					; DATA_B Slot Control Flag Bit Definitions
   616					; Low order bit always set to enable "HOSTSYNC" flow control ala VAX
   617					; Other bits Enables/Disables "TTSYNC" in VAX terms.
   618
   619		   	   000005		SL.EXF==^B0101		;Enable XON/XOFF recognition in server
   620		   	   000011		SL.DXF==^B1001		;Disable XON/XOFF recognition in server
   621
   622					;
   623					; SLOT Size Definitions
   624					;
   625
   626		   	   000004		SLHDSI==4		;Slot header size
   627		   	   000004		ATTSIZ==SLHDSI		;ATTENTSION slot size
   628		   	   000011		DTBSIZ==SLHDSI+5	;DATA_B slot size
   629
   630					;
   631					;Miscellaneous Constants
   632					;
   633
   634		   	   000005		LAHPV==5		;Highest protocol version supported
   635		   	   000005		LALPV==5		;Lowest protocol version supported
   636		   	   000005		PROVER==5		;Our LAT protocol version
   637		   	   000000		PROECO==0		;Our LAT protocol ECO
   638		   	   000050		MXSLSI==^D40		;Maximum slot size we will receive
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 8-1
LATSER	MAC	19-Aug-74 07:34		Definitions - Literals - Slot Parameters

   639		   	   000100		MXSLTS==^D64		;Maximum slot sessions per circuit
   640		   	   002740		LMRFSI==^D1504		;Receive buffer size
   641		   	   000010		MXHSRV==10		;Maximum number of services offered
   642					IFN FTOPS20,<	LHPRID==6		;Product code type for TOPS-20 host>
   643		   	   000007	IFN FTOPS10,<	LHPRID==7		;Product code type for TOPS-10 host
   644
   645					>
   646		   	   000001		SCITTY==1		;Interactive terminal service class
   647		   	   000002		MAXXBF==2		;Maximum number of transmit buffers/circuit
   648		   	   000255		CBMAXI==255		;Absolute maximum circuit id
   649		   	   000024		MAXCIR==^D20		;Maximum number of simultaneous circuits
   650		   	   000004		SLHDSZ==4		;Slot header size (bytes)
   651		   	   000002		MAXCRE==2		;Maximum number of credits to extend to remote.
   652		   	   000006		MXBALC==6		;Number of ticks to wait before sending
   653									; unsolicited message to server
   654
   655		   	   400000		DLL.FL==400000		;"buffer-in-DLL" flag (in UNUID)
   656		   	   000000		LS.OFF==0		;LAT Access State OFF
   657		   	   000001		LS.ON==1		;LAT Access State ON
   658		   	   000002		LS.SHT==2		;LAT Access State SHUT
   659		   	   000056		MINXBF==^D46		;Minimum transmit buffer size
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 9
LATSER	MAC	19-Aug-74 07:34		MONSYM/UUOSYM Definitions

   660						SUBTTL	MONSYM/UUOSYM Definitions
   661
   662					;LATOP./LATOP% Function Code Definitions
   663
   664		   	   000000		.LASET==0	 ;Set
   665		   	   000001		.LACLR==1	 ;Clear
   666		   	   000002		.LASCH==2	 ;Show characteristics of host
   667		   	   000003		.LASTC==3	 ;Show terminal connects
   668		   	   000004		.LASAS==4	 ;Show adjacent servers
   669		   	   000005		.LASCO==5	 ;Show counters
   670		   	   000006		.LAZCO==6	 ;Zero counters
   671
   672		   	   000000		.LAACT==0	;Argument block count
   673		   	   000001		.LAFCN==1	;LATOP% function code
   674
   675		   	   000002		.LAPRM==2	;SET/CLEAR parameter number
   676		   	   000003		.LAVAL==3	;SET/CLEAR new parameter value
   677
   678		   	   000002		.LABCT==2	;Buffer count
   679		   	   000003		.LABFA==3	;Buffer Address
   680		   	   000004		.LAQUA==4	;Qualifier
   681		   	   000005		.LADSC==5	;
   682
   683		   400000  000000		LA%RAT==1B0
   684		   200000  000000		LA%DSC==1B1
   685
   686		   	   000001		.LPMAC==1
   687		   	   000002		.LPMCO==2
   688		   	   000003		.LPNUM==3
   689		   	   000004		.LPLAS==4
   690		   	   000005		.LPRLI==5
   691		   	   000006		.LPTIM==6
   692		   	   000007		.LPMTI==7
   693		   	   000010		.LPCOD==10
   694		   	   000011		.LPNNM==11
   695		   	   000012		.LPNID==12
   696		   	   000013		.LPSRV==13
   697		   	   000014		.LPLOC==14
   698
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 10
LATSER	MAC	19-Aug-74 07:34		MONSYM/UUOSYM Definitions

   699					IFN FTOPS10,<
   700					;
   701					; Allocate some ACs for use in LATOP. UUO
   702					; Use W, since we don't use it for anything else.
   703					; Use M, since it is W+1 for 7.03
   704					; We don't bother saving W, since it is useless.
   705					; We save M at start of LATOP. UUO and restore just before end
   706					;   because it contains the actual UUO and AC field to store to
   707					;
   708		   	   000006			Q1==W		;redefine some TOPS-20 ACs
   709		   	   000007			Q2==M		;( = W+1)
   710
   711					DEFINE ITERR (ERRCOD),<
   712					 IFB <ERRCOD>,<JRST ERRRTN>
   713					 IFNB <ERRCOD>,<JRST [MOVEI T1,ERRCOD
   714							    JRST ERRRTN]>>
   715
   716					DEFINE RETBAD (ERRCOD),<
   717					  IFB <ERRCOD>,<RET>
   718					  IFNB <ERRCOD>,<JRST [MOVEI T1,ERRCOD
   719							     RET]>>
   720
   721					DEFINE .ERRT (A,B,C,D) <
   722						B==A
   723						C==A>			;internal and external name
   724
   725		   	   000000	.ERRT (00,LATX01,LABTS%,<Buffer size too small for available data>)
   726		   	   000001	.ERRT (01,LATX02,LAVOR%,<LAT parameter value out of range>)
   727		   	   000002	.ERRT (02,LATX03,LALNO%,<LAT is not operational>)
   728		   	   000003	.ERRT (03,LATX04,LASVR%,<Invalid or unknown LAT server name>)
   729		   	   000004	.ERRT (04,LATX05,LAIPN%,<Invalid LAT parameter>)
   730		   	   000005	.ERRT (05,LATX06,LAIPV%,<Invalid LAT parameter value>)
   731		   	   000006	.ERRT (06,LATX07,LASVC%,<Invalid or unknown LAT service name>)
   732		   	   000007	.ERRT (07,LATX08,LAILR%,<Insufficient LAT Resources>)
   733		   	   000010	.ERRT (10,LATX09,LAHAS%,<LAT Host name already set>)
   734		   	   000011	.ERRT (11,ARGX02,LAIVF%,<Function code out of range>)
   735		   	   000012	.ERRT (12,ARGX04,LAABS%,<Argument list too small>)
   736		   	   000013	.ERRT (13,LATXAC,LAADC%,<Address check for argument list>)
   737		   	   000014	.ERRT (14,LATXPV,LAPRV%,<No privilege for attempted operation>)
   738
   739					>;END IFN FTOPS10
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 11
LATSER	MAC	19-Aug-74 07:34		External References

   740						SUBTTL	External References
   741
   742						EXT DLLUNI
   743
   744					IFN FTOPS20,<
   745						EXT DNGWDZ
   746						EXT DNFWDS
   747						EXT TTCHI
   748						EXT LATMCT	;CLK2TM table timer for multicast
   749					>
   750					IFN FTOPS10,<
   751
   752						EXTERN	LAHNDB
   753						EXTERN	GETEWZ,GIVEWS
   754						EXTERN	LDBPAG,SAVE4,GETWDU,GETWD1,RTZER,STOTAC
   755						EXTERN	RTN,SETCHP,NTTLAH,CONFIG,STANAM
   756						EXTERN	NSBWDS,NFRSBQ,.CPSK0,RECPTY,GETLDB,DETLDB,FRELDB
   757						EXTERN	LDRREM,LDBDCH,LDBISR,LDBQUH,LDBLAT
   758						EXTERN	LTLLAT,LDBTTW,APCLAT,LDPAPC,TTFGRT,APCUNK
   759						EXTERN	XMTCHR,TTIWRN,LDBTIC
   760						EXTERN	LDBECC,TOTAKE,L1RCHP,LDBBYT
   761						EXTERN	DATE,TPOPJ
   762						EXTERN	LDLIDL,M.LIDL,SCNADT
   763					>
   764
   765
   766
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 12
LATSER	MAC	19-Aug-74 07:34		External References

   767
   768
   769
   770					; UN Block Extension
   771
   772					BEGSTR	UE
   773	000000     777777  777777		WORD LW0		;Queue Link Word for linking buffers to CB Qs
   774	000001     777777  777777		WORD LW1		;Queue Link Word for linking buffers to NI Qs
   775	000000'01			ENDSTR
   776
   777					;
   778					; Buffer offsets
   779					;
   780
   781		   	   000002		UNB.OF==UE.LEN		;Start of UN block for all buffers
   782		   	   000025		MDB.OF==UE.LEN+UN.LEN	;Start of MD block
   783		   	   000033		XBF.OF==UE.LEN+UN.LEN+MD.LEN
   784		   	   000025		SBF.OF==UE.LEN+UN.LEN
   785
   786		   	   000044		SZMSTP==<XBF.OF+SZ.MHD+1>;STOP message size in words
   787		   	   000004		SZ.SHD==4		;Slot header size
   788		   	   000001		SZ.ATT==1		;Attention size
   789		   	   000000		SZ.REJ==0		;Reject slot size
   790		   	   000005		SZ.SDB==5		;DATA_B slot size
   791		   	   000000		SZ.SSP==0		;Stop slot size
   792		   	   000006		SZ.SST==6		;Start slot size
   793		   	   000567		SZ.XBF==<^D1500+3>/4
   794		   	   000012		SZ.MSP==^D10		;Start message size
   795		   	   000010		SZ.MHD==^D8		;Message header size
   796
   797		   	   000006		ML.NNM==6		;Max length of node name
   798		   	   000020		ML.SYS==^D16		;Max length of system name
   799		   	   000100		ML.LOC==^D64		;Max length of location field
   800		   	   000100		ML.DSC==^D64		;Max length of description field
   801		   	   000020		ML.SNM==^D16		;Max length of service name
   802		   	   000100		ML.SID==^D64		;Max length of service identification field
   803
   804		   	   000020		ML.SLN==^D16		;Max length of slot name
   805		   	   000020		ML.PNM==^D16		;Max length of port name
   806		   	   001373		ML.HMC==^D33+<1+ML.NNM>+<1+ML.DSC>+MXHSRV*<1+ML.SNM+1+ML.SID>+2
   807									;Host multicast message max length
   808		   	   000146		ML.HSM==^D12+<1+ML.NNM>+<1+ML.LOC>+<1+ML.SYS>+1
   809									;Host start message max length
   810		   	   000004		MW.SYS==<ML.SYS+4>/5	;Max length of system name in words
   811		   	   000015		MW.LOC==<ML.LOC+4>/5	;Max length of location field in words
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 13
LATSER	MAC	19-Aug-74 07:34		Definitions - Data Structures

   812					SUBTTL	Definitions - Data Structures
   813
   814					;
   815
   816					;Host Node Data Structures
   817					;
   818
   819					BEGSTR	GB			;SERVICE BLOCK
   820	000000     777777  777777		WORD RAT		;Service Rating.
   821	000001     777777  000000		HWORD NC		;Count of bytes in service name.
   822	000001     000000  777777		HWORD LC		;Count of bytes in service description
   823	000002     777777  777777		WORD NAM,<<ML.SNM+4>/5>	;Storage for up to 16 bytes of service name.
   824	000006     777777  777777		WORD HID,<<ML.SID+4>/5>	;Storage for up to 64 bytes of service id.
   825	000000'01			ENDSTR
   826
   827					BEGSTR	HN			;HOST NODE Data Base
   828	000000     777777  000000		FIELD FLG,^D18
   829	000000     400000  000000		 BIT RUN		;NI run state (must be sign bit)
   830	000000     200000  000000		 BIT ANY		;Reconstruct of START msg necessary
   831	000000     100000  000000		 BIT CIP		;Virtual circuit connect in progress
   832	000000     000000  777400		FILLER ^D10
   833	000000     000000  000377		FIELD CFL,^D8		;Multicast message change flags
   834	000000     000000  000200		 BIT OTH		;Something other than above changed
   835	000000     000000  000100		 BIT FIL
   836	000000     000000  000040		 BIT CLS		;A host service class changed
   837	000000     000000  000020		 BIT SVD		;A host service description changed
   838	000000     000000  000010		 BIT SVR		;A host service rating changed
   839	000000     000000  000004		 BIT SVN		;A host service name changed
   840	000000     000000  000002		 BIT NDD		;Host Node Description changed
   841	000000     000000  000001		 BIT ACS		;Access Codes changed
   842									;START OF PARAMETERS DISPLAYED BY  .LASCH 
   843	000001     777777  000000		HWORD MXC		;Maximum allocatable circuit blocks
   844	000001     000000  777777		HWORD NCC		;Number of currently allocated circuit blocks
   845	000002     777777  000000		HWORD MAC		;Maximum number of active circuits
   846	000002     000000  777777		HWORD NAC		;Number of currently active circuits
   847	000003     777777  000000		HWORD MCO		;Maximum number of simultaneous connects
   848	000003     000000  777777		HWORD CON		;Current number of active connects
   849	000004     777777  000000		HWORD NUM		;Host number
   850	000004     000000  777777		HWORD LAS		;LAT access state
   851	000005     777777  000000		HWORD RLI		;Virtual circuit message retransmit limit
   852	000005     000000  777777		HWORD TIM		;Virtual circuit retransmit timer (ms)
   853	000006     777777  000000		HWORD MTI		;Multicast timer initial value (sec)
   854									; END OF PARAMETERS DISPLAYED BY .LASCH 
   855	000006     000000  777777		HWORD PRG		;Host progress timer
   856	000007     777777  000000		HWORD NRB		;Number of receive buffers allocated
   857	000010     777777  777777		WORD HST		;Address of state table
   858	000011     777777  777777		WORD QAC,2		;Queue header for active circuit blocks
   859	000013     777777  777777		WORD QIC,2		;Queue header for inactive circuit blocks
   860	000015     777777  777777		WORD NIQ,2		;Interrupt level message queue
   861	000017     777777  777777		WORD SCQ,2		;Scheduler level message queue
   862	000021     777777  777777		WORD PID		;NI Portal ID
   863	000022     777777  000000		HWORD NXI		;Next circuit block index to assign
   864	000022     000000  777777		HWORD NSV		;Number of offered services
   865	000023     777777  777777		WORD LOK		;Lock for HN data base
   866	000024     777777  000000		HWORD NMC		;Host node name count
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 13-1
LATSER	MAC	19-Aug-74 07:34		Definitions - Data Structures

   867	000024     000000  777777		HWORD IDC		;Host identification string count
   868	000025     777777  777777		WORD NAM,2		;Host node name string
   869	000027     777777  777777		WORD ID,<<ML.DSC+4>/5>	;Host identification string
   870	000044     777777  777777		WORD SMT,<<<ML.HSM+3>/4>+SBF.OF>;Start message template
   871	000123     777777  777777		WORD MCM,<<ML.HMC+3>/4>	;Copy of the multicast message.
   872	000422     777777  777777		WORD SRV,<GB.LEN*MXHSRV>;Storage for service blocks
   873	000000'01			ENDSTR
   874
   875					BEGSTR	AC,HN.LST		;ACCESS CODES
   876	000652     777777  777777		WORD LNG		;Access code string length in bytes
   877	000653     777777  777777		WORD COD,^D32		;Storage for 256 bit bit-mask
   878	000000'01			ENDSTR
   879
   880					;LAT Circuit counters for all servers
   881
   882					BEGSTR	HC,AC.LST	
   883	000713     777777  777777		WORD RCV		;Messages received
   884	000714     777777  777777		WORD XMT		;Messages transmitted
   885	000715     777777  777777		WORD RTR		;Messages retransmitted
   886	000716     777777  777777		WORD SEQ		;Receive message sequence errors
   887	000717     777777  777777		WORD IMR		;Illegal messages received
   888	000720     777777  777777		WORD ISR		;Illegal slots received
   889	000721     777777  777777		WORD RES		;Resource errors
   890	000722     777777  777777		WORD MSK		;Illegal message error mask
   891	000000'01			ENDSTR
   892
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 14
LATSER	MAC	19-Aug-74 07:34		CIRCUIT BLOCK data structure definitions

   893						SUBTTL	CIRCUIT BLOCK data structure definitions
   894
   895					BEGSTR	CB			;CIRCUIT BLOCK
   896	000000     777777  777777		WORD LNK,2		;Queue Link words (must be first words)
   897	000002     777777  000000		HWORD RID		;Circuit handle assigned by the remote
   898	000002     000000  777777		HWORD LID		;Local circuit index
   899	000003     700000  000000		FIELD FLG,3		;Virtual circuit flags
   900	000003     400000  000000		 BIT RRF		;Reply requested flag
   901	000003     200000  000000		 BIT MRS		;Must reply soon flag
   902	000003     100000  000000		 BIT MRN		;Must reply now flag
   903	000003     000000  777777		HWORD CSB		;Count since balanced
   904	000004     777777  000000		HWORD SDC		;Number of slots with data waiting
   905	000004     000000  777777		HWORD TSQ		;Next transmit sequence number
   906	000005     777777  000000		HWORD RSQ		;Next expected receive sequence number
   907	000005     000000  777777		HWORD LRA		;Sequence number of last message ack'd by remote node.
   908	000006     777777  000000		HWORD TIM		;Current value of circuit timer.
   909	000006     000000  777777		HWORD RTC		;Current retransmit count
   910	000007     777777  000000		HWORD QUA		;Circuit quality
   911	000007     000000  777777		HWORD ERR		;Reason code for last time circuit stopped
   912	000010     777777  000000		HWORD DLL		;Number of transmit buffers in the DLL
   913	000011     777777  777777		WORD XBQ,2		;Queue of free transmit buffers
   914	000013     777777  777777		WORD AKQ,2		;Unacknowledged queue header
   915	000015     777777  777777		WORD SBQ,2		;Circuit slot queue
   916	000017     777777  777777		WORD DNI,2		;NI address of remote server
   917	000021     777777  000000		HWORD MTF		;Maximum transmit frame size for circuit
   918	000021     000000  777777		HWORD RPV		;Remote protocol version and ECO
   919	000022     777777  000000		HWORD MSL		;Maximum slots allowed by remote
   920	000022     000000  777777		HWORD NBF		;Additional transmit buffers allowed by remote
   921	000023     777777  000000		HWORD CTI		;Value of remote's circuit timer
   922	000023     000000  777777		HWORD KTI		;Value of remote's keep-alive timer
   923	000024     777777  000000		HWORD PTC		;Product type code for remote node
   924	000024     000000  777777		HWORD STA		;Virtual circuit state
   925	000025     777777  000000		HWORD NUM		;Remote's system number
   926	000025     000000  777777		HWORD RSC		;Remote's system name count
   927	000026     777777  000000		HWORD RLC		;Remote's location text count
   928	000027     777777  777777		WORD SNM,<<ML.SNM+4>/5>	;Remote's system name
   929	000033     777777  777777		WORD LOC,<<ML.LOC+4>/5>	;Remote's location string	
   930	000050     777777  777777		WORD KAF		;host keep-alive timer
   931									;<initial-value>,,<current value>
   932	000000'01			ENDSTR
   933					BEGSTR	CC,CB.LST		;CIRCUIT COUNTERS
   934	000051     777777  777777		WORD RCV		;Messages received
   935	000052     777777  777777		WORD XMT		;Messages transmitted
   936	000053     777777  777777		WORD RTR		;Messages retransmitted
   937	000054     777777  777777		WORD SEQ		;Receive message sequence errors
   938	000055     777777  777777		WORD IMR		;Illegal messages received
   939	000056     777777  777777		WORD ISR		;Illegal slots received
   940	000057     777777  777777		WORD RES		;Resource errors
   941	000060     777777  777777		WORD MSK		;Illegal message error mask
   942	000000'01			ENDSTR
   943
   944		   	   000615		RBFSIZ==<<LMRFSI+3>/4+UN.LEN+UE.LEN>;Receive buffer size
   945		   	   000575		XBFSIZ==<MD.LEN+SZ.XBF>;Transmit buffer length
   946		   	   000004		NBUFS==<1+<MAXXBF+1>>
   947
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 15
LATSER	MAC	19-Aug-74 07:34		CIRCUIT BLOCK data structure definitions

   948
   949
   950					;	Boundary definitions in the CB for CLEAR and SHOW
   951					;	LAT Control Program functions.
   952
   953		   	   000003		  CLRBEG==CB.FLG	;First clear field for .LACLR
   954		   	   000010		  CLREND==CB.DLL	;End of clear field for .LACLR
   955		   	   000017		  SASBEG==CB.DNI	;Start of .LASAS fields for single server
   956		   	   000024		  SASBG==CB.STA		;Start of .LASAS fields for multiple servers
   957		   	   000033		  SASEN==CB.SNM+<ML.SYS+4>/5 ;End of .LASAS fields for single server
   958		   	   000050		  SASEND==CB.LOC+<ML.LOC+4>/5 ;End of .LASAS fields for multiple servers
   959
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 16
LATSER	MAC	19-Aug-74 07:34		SLOT BLOCK data struction definitions

   960						SUBTTL	SLOT BLOCK data struction definitions
   961
   962					BEGSTR	SB
   963	000000     777777  777777		WORD LNK,2		;Queue link word (must be first)
   964	000002     777777  000000		FIELD FLG,^D18		;Flags
   965	000002     400000  000000		  BIT SDP		;Slot data present (must be sign bit)
   966	000002     200000  000000		  BIT REJ		;Send REJECT Slot
   967	000002     100000  000000		  BIT STR		;Send START Slot
   968	000002     040000  000000		  BIT FOU		;Flush output
   969	000002     020000  000000		  BIT OUT		;Output data available
   970	000002     010000  000000		  BIT FCC		;Flow control change
   971	000002     004000  000000		  BIT STO		;Send STOP Slot(Must be last)
   972	000002     000000  777777		HWORD ATS		;Maximum attention slot size
   973	000003     777777  000000		HWORD MDS		;Maximum slot data size
   974	000003     000000  777777		HWORD STA		;Slot state
   975	000004     777777  000000		HWORD RID		;Remote slot id
   976	000004     000000  777777		HWORD LID		;Local slot id
   977	000005     777777  000000		HWORD XCR		;Transmit credits available to us
   978	000005     000000  777777		HWORD RCR		;Receive credits still outstanding
   979	000006     777777  000000		HWORD REA		;Reason code for stop or reject
   980	000006     000000  777777		HWORD SNC		;Source slot name count
   981	000007     777777  000000		HWORD OPC		;Object port name count
   982	000007     000000  777777		HWORD SPC		;Subject port name count
   983	000010     777777  777777		WORD SNM,<<ML.SLN+4>/5>	;Source slot name (16 characters max)
   984	000014     777777  777777		WORD OPN,<<ML.PNM+4>/5>	;Object port name
   985	000020     777777  777777		WORD SPN,<<ML.PNM+4>/5>	;Subject port name
   986	000024     777777  777777		WORD TDB		;Terminal data block
   987	000025     777777  777777		WORD CBA		;Circuit block address for this slot
   988					IFN FTOPS10,<
   989	000026     777777  000000		FIELD REM,^D18		;More flags for TOPS-10
   990	000026     400000  000000		BIT TTO			;"Character in SBCHR" bit, must be sign bit
   991	000026     200000  000000		BIT XNF			;"XON/XOF processing enabled
   992	000026     000000  777777		HWORD CHR		;space to hold saved character
   993					>;end ifn FTOPS10
   994	000000'01			ENDSTR
   995
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 17
LATSER	MAC	19-Aug-74 07:34		Miscellaneous Structure Definitions

   996						SUBTTL Miscellaneous Structure Definitions
   997
   998					BEGSTR	QL			;Halfword Queue Link Word
   999	000000     777777  777777		WORD FWD		;Next forward queue element
  1000	000001     777777  777777		WORD BWD		;Previous backward queue element
  1001	000000'01			ENDSTR
  1002
  1003						asuppress
  1004
  1005
  1006						RESDT
  1007
  1008					IFN FTOPS10,<
  1009	000000'02			OURNAM:	BLOCK	2
  1010	000002'02			OURCNT:	BLOCK	1
  1011	000003'02  42 01 0 10 000000*	LDPXNF:	POINT	1,LDBPAG(U),1;POINTER TO XOFFON BIT
  1012					>;end IFN FTOPS10
  1013
  1014					IFN FTOPS20,<
  1015					LAHNDB:	BLOCK 1
  1016					> ;end IFN FTOPS20
  1017	000004'02			RTXTIM:	BLOCK	1		;Retransmit timer in ticks
  1018	000005'02			CBVECT: BLOCK 1
  1019	000006'02			SBVECT: BLOCK 1
  1020	000007'02  000000  000001	LASDEF:	EXP LS.ON		;LAT Access Default State
  1021	000010'02			NSLOTS:	BLOCK 1
  1022					IFN FTOPS10,<
  1023	000011'02			LATRTQ:	BLOCK	2		;QUEUE FOR LAT LDBS
  1024	000013'02			LATFRE:	BLOCK	QL.LEN		;QUEUE FOR LAT FREE CORE BLOCKS
  1025	000015'02			LATLOC:: BLOCK	1		;START OF LAT FREE CORE (SET UP AT ONCE TIME)
  1026	000016'02			LATMCT:	BLOCK	1		;Multicast timer (in seconds for TOPS-10)
  1027	000017'02			LATNFB:	BLOCK	1		;Number of free buffers in pool
  1028	000020'02			LATWFB:	BLOCK	1		;Number of free buffers wanted for new circuits
  1029	000021'02			LATRFB:	BLOCK	1		;Number of buffers requested on last cycle
  1030	000022'02			LASBAD::BLOCK	2		;Ethernet address of sender of last bad msg
  1031
  1032	000027'02			TRVAR <MSGDID,MSGSID,MSGACK,STPCOD> ;Message header variable storage
  1033	000034'02			TRVAR <SLTDID,SLTSID,SLTCNT,SLTTYP,SLTEPT>
  1034
  1035					>;end IFN FTOPS10
  1036
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 18
LATSER	MAC	19-Aug-74 07:34		Symbol Definitions -- Macros MIN.,MAX.,MAXENT

  1037						SUBTTL Symbol Definitions -- Macros MIN.,MAX.,MAXENT
  1038
  1039					;
  1040					; Macro MIN. (symbol,list) - Assigns minimum arithmetic value of list of items.
  1041					;
  1042
  1043					DEFINE MIN. (SYM,LIST),
  1044						<IRP LIST,<..X==LIST	;;Assign first value in list
  1045							   STOPI>
  1046						 IRP LIST,<IFL <LIST-..X>,<..X==LIST>> ;;Assign lowest in list
  1047						 SYM==:..X>		;;Generate value
  1048
  1049					;
  1050					; Macro MAX. (symbol,list) - Assigns maximum arithmetic value of list of items.
  1051					;
  1052
  1053					DEFINE MAX. (SYM,LIST),
  1054						<IRP LIST,<..X==LIST	;;Assign first value in list
  1055							   STOPI>
  1056						 IRP LIST,<IFG <LIST-..X>,<..X==LIST>> ;;Assign highest in list
  1057						SYM==:..X>		;;Generate value
  1058
  1059					DEFINE LHDSP. (TABLE,CODE,ROUTINE) <
  1060						.ORG <TABLE+CODE>
  1061						IFIW ROUTINE
  1062						.ORG>
  1063
  1064					DEFINE LSLDT. (DTBL,LTBL,CODE,ROUTINE,LNGTST,LNGADD) <
  1065						.ORG <DTBL+CODE>
  1066						IFIW ROUTINE
  1067						.ORG
  1068						.ORG <LTBL+CODE>
  1069						EXP <LNGTST,,LNGADD>
  1070						.ORG>
  1071
  1072					;
  1073					;	Temp storage block for LATOP.
  1074					;
  1075		   	   000100		MAX. (TMPLNG,<<GB.LEN+1>,ML.NNM,ML.DSC>)
  1076	000035'02			TMPBLK:	BLOCK TMPLNG
  1077		   	   000036'		TMPGB==TMPBLK+1
  1078
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 19
LATSER	MAC	19-Aug-74 07:34		Symbol Definitions -- Macros MIN.,MAX.,MAXENT

  1079
  1080						RESCD
  1081
  1082					IFN FTOPS10,<
  1083
  1084						SUBTTL LDBISR Dispatch Table
  1085
  1086	000000'01  263 01 0 00 000000 	LATDSP::RET		;( 0)ILLEGAL NOW.  DON'T USE!!
  1087	000001'01  263 01 0 00 000000 		RET		;( 1)MODEM CONTROL
  1088	000002'01  254 00 0 00 001310'		JRST	LATSEC	;( 2)ONCE A SECOND CALL (NOT PER TTY)
  1089	000003'01  263 01 0 00 000000 		RET		;( 3)INITIALIZE
  1090	000004'01  254 00 0 00 000000*		JRST	SETCHP	;( 4)CHANGE HARDWARE PARMS (let SCNSER do it)
  1091	000005'01  263 01 0 00 000000 		RET		;( 5)LINE PARM CONTROL
  1092	000006'01  263 01 0 00 000000 		RET		;( 6)SET TERMINAL ELEMENT
  1093	000007'01  254 00 0 00 004351'		JRST	LATREM	;( 7)STUFF FOR REMOTE TERMINALS
  1094	000010'01  254 00 0 00 000000*		RETSKP		;(10)IS LINE DEFINED ON STATION (YES)
  1095
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 20
LATSER	MAC	19-Aug-74 07:34		LDBISR Dispatch Table

  1096
  1097					DEFINE PARTB. (PRM,MAX,MIN,CLRVAL,INSTR,FLAGS) <
  1098					
  1099						.ORG <.LP'PRM+TBRNGE>
  1100						EXP <MAX,,MIN>
  1101						.ORG
  1102						.ORG <.LP'PRM+TBFLGS>
  1103						EXP <FLAGS!CLRVAL>
  1104						.ORG
  1105						.ORG <.LP'PRM+TBEXEC>
  1106					   IFB <INSTR>,<
  1107						STOR T2,HN'PRM,(Q2)
  1108					   >
  1109					   IFNB <INSTR>,<
  1110						INSTR
  1111					   >
  1112						.ORG
  1113					   >
  1114
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 21
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS 

  1115						SUBTTL	LATOP% JSYS 
  1116	
  1117		   200000  000000		LF%RNG==1B1		;Do range check on parameter value to set
  1118		   100000  000000		LF%LOK==1B2		;Lock the database before setting parameter
  1119		   040000  000000		LF%CLR==1B3		;Parameter may be cleared.
  1120
  1121					MAX. (MXSPAR,<.LPMAC,.LPMCO,.LPNUM,.LPLAS,.LPRLI,.LPTIM,.LPMTI,.LPCOD,.LPNNM,.LPNID,.LPSRV,.
  1122		   	   000014	LPLOC>)
  1123					MIN. (MNSPAR,<.LPMAC,.LPMCO,.LPNUM,.LPLAS,.LPRLI,.LPTIM,.LPMTI,.LPCOD,.LPNNM,.LPNID,.LPSRV,.
  1124		   	   000001	LPLOC>)
  1125
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 22
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS 

  1126
  1127
  1128						SWAPCD
  1129
  1130	000011'01			TBRNGE:	BLOCK <MXSPAR-MNSPAR+1>
  1131	000025'01			TBFLGS:	BLOCK <MXSPAR-MNSPAR+1>
  1132	000041'01			TBEXEC:	BLOCK <MXSPAR-MNSPAR+1>
  1133
  1134	000012'01  000377  000001		PARTB. (MAC,377,1,^D10,,LF%RNG!LF%CLR)
  1135	000026'01  240000  000012
  1136	000042'01  506 03 0 07 000002 
  1137	000013'01  000000000000#		PARTB. (MCO,NTTLAH,1,^D10,,LF%RNG!LF%CLR)
  1138	000027'01  240000  000012
  1139	000043'01  506 03 0 07 000003 
  1140	000014'01  177777  000000		PARTB. (NUM,177777,0,0,,LF%RNG!LF%CLR)
  1141	000030'01  240000  000000
  1142	000044'01  506 03 0 07 000004 
  1143	000015'01  000001  000000		PARTB. (LAS,LS.ON,LS.OFF,0,,LF%RNG!<HNOTH_^D18>)
  1144	000031'01  200200  000000
  1145	000045'01  542 03 0 07 000004 
  1146	000016'01  000100  000000		PARTB. (RLI,100,0,^D60,,LF%RNG!LF%CLR)
  1147	000032'01  240000  000074
  1148	000046'01  506 03 0 07 000005 
  1149	000017'01  303240  000144		PARTB. (TIM,^D100000,^D100,^D1000,<JRST SETRTX>,LF%RNG!LF%CLR)
  1150	000033'01  240000  001750
  1151	000047'01  254 00 0 00 000330'
  1152	000020'01  000060  000010		PARTB. (MTI,60,10,^D30,,LF%RNG!LF%CLR!<HNOTH_^D18>)
  1153	000034'01  240200  000036
  1154	000050'01  506 03 0 07 000006 
  1155	000021'01  000000  000000		PARTB. (COD,0,0,0,<JRST SETCOD>,LF%CLR!<HNACS_^D18>)
  1156	000035'01  040001  000000
  1157	000051'01  254 00 0 00 000377'
  1158	000022'01  000000  000000		PARTB. (NNM,0,0,0,<JRST SETNNM>,0)
  1159	000036'01  000000  000000
  1160	000052'01  254 00 0 00 000336'
  1161	000023'01  000000  000000		PARTB. (NID,0,0,0,<JRST SETNID>,LF%CLR!<HNNDD_^D18>)
  1162	000037'01  040002  000000
  1163	000053'01  254 00 0 00 000356'
  1164	000024'01  000000  000000		PARTB. (SRV,0,0,0,<JRST SSERVC>,LF%CLR)
  1165	000040'01  040000  000000
  1166	000054'01  254 00 0 00 000237'
  1167
  1168
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 23
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS 

  1169					IFN FTOPS10,<	SUBTTL	NETOP. FUNCTIONS
  1170
  1171
  1172					;NETDIL - tell user the node and port where his TTY is connected
  1173					;
  1174					;Call: (in section 1 already)
  1175					;
  1176					;	U/ LDB of LAT terminal
  1177					;	M/ Address of user's NETOP. arg list
  1178					;Return:
  1179					;	ECDX?	depending on error
  1180					;	RETSKP	node name stored in string block pointed to by user's arg list
  1181					;
  1182					;Uses P1,P2 (already saved by higher routine), T1-T4, M
  1183
  1184	000055'01  200 11 0 00 000007 	NETDIL::MOVE	P1,M		;SAVE ADDRESS OF ARG LIST
  1185	000056'01  256200  004520'		EXCTUX	<SKIPN M,5(P1)>	;POINT TO NODE NAME STRING BLOCK
  1186	000057'01  254 00 0 00 000070'		  JRST	NTDIL1		;NO STRING BLOCK FOR NAME
  1187	000060'01  260 01 0 00 000000*		PUSHJ	P,CHKSTB##	;CHECK STRING BLOCK FOR ADDRESSABILITY
  1188	000061'01  254 00 0 00 000000*		  JRST	NOPADC##	;ADDRESS CHECK
  1189	000062'01  200 04 0 10 000000*		MOVE	T3,LDBLAT##(U)	;GET ADDRESS OF SB BLOCK
  1190	000063'01  200 04 0 04 000025 		MOVE	T3,SB.CBA(T3)	;GET ADDRESS OF CORRESPONDING CB BLOCK
  1191	000064'01  550 02 0 04 000025 		LOAD	T1,CBRSC,(T3)	;GET BYTE COUNT FOR NAME
  1192	000065'01  415 04 0 04 000027 		XMOVEI	T3,CB.SNM(T3)	;GET ADDRESS OF NODE NAME
  1193	000066'01  260 01 0 00 000103'		PUSHJ	P,MOV7T8	;MOVE THE STRING
  1194	000067'01  254 00 0 00 000061*		  JRST	NOPADC##	;NOT ENOUGH ROOM
  1195	000070'01  256200  004521'	NTDIL1:	EXCTUX	<SKIPN	M,6(P1)>	;POINT TO PORT NAME STRING BLOCK
  1196	000071'01  254 00 0 00 000010*		  RETSKP		;BELIEVE IT OR NOT, WE'RE DONE
  1197	000072'01  260 01 0 00 000060*		PUSHJ	P,CHKSTB##	;CHECK THE STRING BLOCK
  1198	000073'01  254 00 0 00 000067*		  JRST	NOPADC##	;NOT THERE
  1199	000074'01  200 04 0 10 000062*		MOVE	T3,LDBLAT##(U)	;GET ADDRESS OF SB BLOCK AGAIN
  1200	000075'01  550 02 0 04 000007 		LOAD	T1,SBSPC,(T3)	;GET BYTE COUNT OF PORT NAME
  1201	000076'01  322 02 0 00 000000*		JUMPE	T1,RSKP		;Nothing to store
  1202	000077'01  415 04 0 04 000020 		XMOVEI	T3,SB.SPN(T3)	;GET ADDRESS OF PORT NAME
  1203	000100'01  260 01 0 00 000103'		PUSHJ	P,MOV7T8
  1204	000101'01  254 00 0 00 000073*		  JRST	NOPADC##	;NOT ENOUGH ROOM
  1205	000102'01  254 00 0 00 000071*		RETSKP
  1206					;
  1207					;MOV7T8 - ROUTINE TO MOVE A MONITOR 7 BIT STRING TO A USER 8 BIT STRING BLOCK
  1208					;
  1209					;CALL: M/ ADDRESS OF STRING BLOCK
  1210					;	T1/ COUNT OF SOURCE STRING
  1211					;	T3/ ADDRESS OF SOURCE STRING
  1212					;	T4/ COUNT OF DESTINATION STRING
  1213					;
  1214					;RETURN:	+1 ADDRESS CHECK
  1215					;		+2 SUCCESS
  1216					;
  1217					;	USES T1-T4
  1218					;
  1219	000103'01			MOV7T8:
  1220	000103'01  260 01 0 00 000000*	IFN FTXMON,<PUSHJ P,SSPCS##>	;PRESERVE PCS FOR CALLER
  1221	000104'01  261 01 0 00 000002 		PUSH	P,T1		;SAVE COUNT FOR A BIT
  1222	000105'01  200 02 0 00 000007 		MOVE	T1,M		;COPY POINTER TO STRING BLOCK
  1223	000106'01  260 01 0 00 000000*		PUSHJ	P,SXPCS##	;SETUP PCS
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 23-1
LATSER	MAC	19-Aug-74 07:34		NETOP. FUNCTIONS

  1224	000107'01  254 00 0 00 000000*		  JRST	TPOPJ##		;I THOUGHT WE KNEW IT WOULD FIT?
  1225	000110'01  262 01 0 00 000002 		POP	P,T1		;RESTORE BYTE COUNT
  1226	000111'01  256200  004522'		EXCTXU	<HRLM T1,(M)>	;STUFF BYTE COUNT INTO STRING BLOCK
  1227	000112'01  303 02 0 05 000000 		CAILE	T1,(T4)		;ENOUGH SPACE TO STORE?
  1228	000113'01  263 01 0 00 000000 		  RET			;NO
  1229	000114'01  205 03 0 00 440740 		MOVSI	T2,(<POINT 7,>!1B12)	;MAKE GLOBAL BYTE POINTER
  1230	000115'01  261 01 0 00 000006 		PUSH	P,T4+1		;SAVE A COUPLE OF ACS
  1231	000116'01  261 01 0 00 000007 		PUSH	P,T4+2		; T1 HAD BETTER BE LESS THAN 12
  1232	000117'01  205 06 0 00 441040 		MOVSI	T4+1,(<POINT 8,>!1B12)
  1233	000120'01  256200  004523'		EXCTUX	<XMOVEI T4+2,1(M)>	;GLOBAL ADDRESS OF DEST.
  1234						PXCT	11,[EXTEND	T1,[MOVSLJ
  1235	000121'01  256 11 0 00 004526'						0]]	;MOVE THE BYTES (I HOPE)
  1236	000122'01  255 00 0 00 000000 		  JFCL
  1237	000123'01  262 01 0 00 000007 		POP	P,T4+2
  1238	000124'01  262 01 0 00 000006 		POP	P,T4+1
  1239	000125'01  254 00 0 00 000102*		RETSKP
  1240					> ;END IFN FTOPS10
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 24
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS 

  1241						SUBTTL	LATOP% JSYS 
  1242
  1243	000126'01			.LATOP::
  1244					IFN FTOPS20,<
  1245						MCENT
  1246						UMOVE Q1,1		;Get the argument block address from user
  1247					>;END IFN FTOPS20
  1248					IFN FTOPS10,<
  1249	000126'01  260 01 0 00 000000*		CALL SAVE4		;Save P1-P4
  1250	000127'01  261 01 0 00 000006 		PUSH P,W		;Save the AC we use ( = Q1)
  1251	000130'01  200 06 0 00 000002 		MOVE Q1,T1		;Get the argument block address from user
  1252					;
  1253					; For TOPS10, we must address-check the arg list or else we might get
  1254					;	an IME
  1255					;
  1256	000131'01  261 01 0 00 000007 		PUSH P,M		;Save UUO for later store ( = Q2)
  1257	000132'01  200 15 0 00 000000*		MOVE J,.CPJOB##		;Also need job number
  1258	000133'01  200 07 0 00 000002 		MOVE M,T1		;Point to user's arg list
  1259	000134'01  260 01 0 00 000000*		CALL GETWRD##		;Get first word (arg count)
  1260	000135'01  254 00 0 00 004527'		  ITERR (LATXAC)	;Arg list is not addressable!
  1261	000136'01  200 11 0 00 000002 		MOVE P1,T1		;Save count of arg block
  1262	000137'01  200 02 0 00 000006 		MOVE T1,Q1		;Restore arg list address
  1263	000140'01  200 03 0 00 000011 		MOVE T2,P1		;Arg list is this long
  1264	000141'01  260 01 0 00 000000*		CALL ARNGE##		; so check it.
  1265	000142'01  600 00 0 00 000000 		  NOP			;Not addressable!
  1266	000143'01  254 00 0 00 004527'		  ITERR (LATXAC) ;Not writeable (error because must update .LABCT)
  1267					;
  1268					; From here on, we know the arg list is addressable
  1269					; so UMOVEs are no problem.
  1270					;
  1271					>;END IFN FTOPS10
  1272					IFN FTOPS20,<	UMOVE P1,.LAACT(Q1)	;Count of the argument block>
  1273	000144'01  256200  004531'		UMOVE P2,.LAFCN(Q1)	;LAT function code.
  1274	000145'01  336 07 0 00 000000*		SKIPN Q2,LAHNDB		;If there is no data base,
  1275	000146'01  254 00 0 00 004532'		ITERR (LATX03)		; then LAT is not operational
  1276	000147'01  301 12 0 00 000000 		CAIL P2,MNLFCN		;Range check the function code
  1277	000150'01  303 12 0 00 000006 		CAILE P2,MXLFCN		; ...
  1278	000151'01  254 00 0 00 004534'		ITERR (ARGX02)		;Function code out of range
  1279					IFN FTOPS10,<
  1280	000152'01  302 12 0 00 000000 		CAIE P2,.LASET		;Is the function .LASET?
  1281	000153'01  306 12 0 00 000001 		CAIN P2,.LACLR		; or .LACLR?
  1282	000154'01  254 00 0 00 000165'		  JRST DOFUN		;Yes, these do their own address checking
  1283	000155'01  306 12 0 00 000006 		CAIN P2,.LAZCO		;or is it .LAZCO?
  1284	000156'01  254 00 0 00 000165'		  JRST DOFUN		;Yes, no show buffer for that either
  1285					;
  1286					; Here, we can do some common address checking for all functions which
  1287					;  have a SHOW buffer
  1288	000157'01  256200  004536'		UMOVE T1,.LABFA(Q1)	;Get SHOW buffer address
  1289	000160'01  256 04 0 00 004537'		XCTU [HRRZ T2,.LABCT(Q1)] ; and buffer word count
  1290	000161'01  322 03 0 00 000165'		JUMPE T2,DOFUN		;0 length, don't bother to check.
  1291	000162'01  260 01 0 00 000141*		CALL ARNGE##		;See if all of it's addressable
  1292	000163'01  600 00 0 00 000000 		  NOP			;Not addressable
  1293	000164'01  254 00 0 00 004527'		  ITERR (LATXAC)	; or not writeable, give error
  1294	
  1295	000165'01			DOFUN:
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 24-1
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS 

  1296					>;END IFN FTOPS10
  1297	000165'01  260 01 1 12 000172'		CALL @LAFDSP-MNLFCN(P2)	;Dispatch to perform the function
  1298	000166'01  254 00 0 00 001051'		 ITERR ()		;Error already reported
  1299					IFN FTOPS20,<	MRETNG			;Return to user >
  1300
  1301					IFN FTOPS10,<
  1302	000167'01  262 01 0 00 000007 		POP	P,M		;RESTORE UUO
  1303	000170'01  262 01 0 00 000006 		POP	P,W		;AND SAVED AC
  1304	000171'01  254 00 0 00 000125*		RETSKP			;AND GIVE GOOD RETURN
  1305					>; END IFN FTOPS10
  1306
  1307		   	   000000		MIN. (MNLFCN,<.LASET,.LACLR,.LASCH,.LASTC,.LASAS,.LASCO,.LAZCO>)
  1308		   	   000006		MAX. (MXLFCN,<.LASET,.LACLR,.LASCH,.LASTC,.LASAS,.LASCO,.LAZCO>)
  1309
  1310	000172'01			LAFDSP:	BLOCK <MXLFCN-MNLFCN+1>
  1311	000172'01  400 00 0 00 000201'		LHDSP. (LAFDSP,.LASET-MNLFCN,LASET) ;Set
  1312	000173'01  400 00 0 00 000201'		LHDSP. (LAFDSP,.LACLR-MNLFCN,LACLR) ;Clear
  1313	000174'01  400 00 0 00 000472'		LHDSP. (LAFDSP,.LASCH-MNLFCN,LASCH) ;Show characteristics of host
  1314	000175'01  400 00 0 00 000533'		LHDSP. (LAFDSP,.LASTC-MNLFCN,LASTC) ;Show terminal connects
  1315	000176'01  400 00 0 00 000575'		LHDSP. (LAFDSP,.LASAS-MNLFCN,LASAS) ;Show adjacent servers
  1316	000177'01  400 00 0 00 000643'		LHDSP. (LAFDSP,.LASCO-MNLFCN,LASCO) ;Show counters
  1317	000200'01  400 00 0 00 000656'		LHDSP. (LAFDSP,.LAZCO-MNLFCN,LAZCO) ;Zero counters
  1318
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 25
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - SET/CLEAR Functions

  1319						SUBTTL	LATOP% JSYS - SET/CLEAR Functions
  1320
  1321					;LASET/LACLR - Set/Clear LAT Host parameters.
  1322					;Call:	Q1/ User's argument block address
  1323					;	Q2/ Host node data base address
  1324					;	P1/ User's argument block count
  1325					;	P2/ Function code
  1326
  1327	000201'01			LASET:	
  1328	000201'01			LACLR:
  1329					IFN FTOPS10,<
  1330	000201'01  205 02 0 00 020000 		MOVSI T1,JP.POK		;Check to see if the guy has POKE priv
  1331	000202'01  260 01 0 00 000000*		CALL PRVBIT##		; or [1,2] or JACCT
  1332	000203'01  254 00 0 00 000205'		  JRST LASET1		;Yup! non-skip means he's macho.
  1333	000204'01  254 00 0 00 004540'		RETBAD(LATXPV)		;He's a wimp, don't let him do anything.
  1334	000205'01			LASET1:
  1335					>
  1336	000205'01  256200  004542'		UMOVE T1,.LAPRM(Q1)	;Get the parameter number to set/clear.
  1337	000206'01  301 02 0 00 000001 		CAIL T1,MNSPAR		;Range check it
  1338	000207'01  303 02 0 00 000014 		CAILE T1,MXSPAR		; ...
  1339	000210'01  254 00 0 00 004543'		RETBAD (LATX06)		;Parameter number out of range
  1340	000211'01  302 12 0 00 000001 		CAIE P2,.LACLR
  1341	000212'01  254 00 0 00 000220'		IFSKP.
  1342	000213'01  205 04 0 00 040000 		  MOVX T3,LF%CLR	;Is this parameter clearable?
  1343	000214'01  616 04 0 02 000025'		  TDNN T3,TBFLGS(T1)	; ...
  1344	000215'01  254 00 0 00 004545'		  RETBAD (LATX07)	;No, return error
  1345	000216'01  550 03 0 02 000025'		  HRRZ T2,TBFLGS(T1)	;Get the value to clear to
  1346	000217'01  254 00 0 00 000232'		  JRST LASET0		; and go clear it.
  1347	000220'01				ENDIF.
  1348	000220'01  256200  004547'		UMOVE T2,.LAVAL(Q1)	;Get the new value to set
  1349	000221'01  205 04 0 00 200000 		MOVX T3,LF%RNG		;Check if this parameter value should
  1350	000222'01  616 04 0 02 000025'		TDNN T3,TBFLGS(T1)	; be range checked.
  1351	000223'01  254 00 0 00 000232'		IFSKP.			;Yes
  1352	000224'01  200 04 0 02 000011'		  MOVE T3,TBRNGE(T1)	;Get the upper and lower ranges.
  1353	000225'01  550 05 0 00 000004 		  HRRZ T4,T3		;Lower bound
  1354	000226'01  557 00 0 00 000004 		  HLRZS T3		;Upper bound
  1355	000227'01  311 03 0 00 000005 		  CAML T2,T4
  1356	000230'01  313 03 0 00 000004 		  CAMLE T2,T3
  1357	000231'01  254 00 0 00 004550'		  RETBAD (LATX02)
  1358	000232'01				ENDIF.
  1359	000232'01  554 04 0 02 000025'	LASET0:	HLRZ T3,TBFLGS(T1)	;Change flags to set.
  1360	000233'01  405 04 0 00 000377 		ANDI T3,377
  1361	000234'01  436 04 0 07 000000 		IORM T3,HN.FLG(Q2)	;Set them
  1362	000235'01  256 00 0 02 000041'		XCT TBEXEC(T1)		;Do the store.
  1363	000236'01  254 00 0 00 000171*		RETSKP
  1364
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 26
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - SET/CLEAR SERVICE

  1365						SUBTTL	LATOP% JSYS - SET/CLEAR SERVICE
  1366
  1367					;SSERVC - Set LAT Service
  1368
  1369					;Call:	Q1/ User's parameter buffer
  1370					;	Q2/ Host node data base address
  1371					;	P2/ LATOP% function code
  1372					;Return:
  1373					;	RET -	Error return
  1374					;	RETSKP - Sucess
  1375
  1376	000237'01  265 17 0 00 004552'	SSERVC:	SAVEAC <P3,P4>
  1377	000240'01  260 01 0 00 000703'		CALL FNDSRV		;(T1-T4/T1)Find the service to be set/cleared.
  1378	000241'01  263 01 0 00 000000 		 RETBAD ()
  1379	000242'01  202 02 0 00 000013 		MOVEM T1,P3		;Save the service block address
  1380	000243'01  306 12 0 00 000001 		CAIN P2,.LACLR		;Clearing rather than setting?
  1381	000244'01  254 00 0 00 000310'		JRST CSERVC		;Yes.
  1382	000245'01  400 14 0 00 000000 		SETZ P4,0		;P4 will be used to assemble the change flags
  1383	000246'01  256200  004562'		UMOVE T1,.LAQUA(Q1)	;Get the flags and rating
  1384	000247'01  607 02 0 00 400000 		TXNN T1,LA%RAT		;Set the rating?
  1385	000250'01  254 00 0 00 000261'		IFSKP.			;Yes.
  1386	000251'01  660 14 0 00 000010 		  TXO P4,HNSVR		;Set rating change flag	  
  1387	000252'01  570 03 0 00 000002 		  HRRE T2,T1
  1388	000253'01  200 04 0 00 000003 		  MOVE T3,T2
  1389	000254'01  350 00 0 00 000003 		  AOS T2
  1390	000255'01  301 03 0 00 000000 		  CAIL T2,0		;Range check the rating.
  1391	000256'01  303 03 0 00 000400 		  CAILE T2,^D256	; ...
  1392	000257'01  263 01 0 00 000000 		  RETBAD ()		;Out of range
  1393	000260'01  202 04 0 00 000000#		  STOR T3,GBRAT,+TMPGB	;Store the rating
  1394	000261'01				ENDIF.
  1395	000261'01  607 02 0 00 200000 		TXNN T1,LA%DSC		;Set the description?
  1396	000262'01  254 00 0 00 000274'		IFSKP.
  1397	000263'01  660 14 0 00 000020 		  TXO P4,HNSVD		;Description change flag
  1398	000264'01  256200  004563'		  UMOVE T1,.LADSC(Q1)	;Get the user's pointer to description string
  1399
  1400					IFN FTOPS10,<
  1401	000265'01  260 01 0 00 000000*		  CALL CKSTR##		;Check to see if ASCIZ string is addressable
  1402	000266'01  254 00 0 00 004564'		   RETBAD (LATXAC)	;Nope, lose
  1403					>;end ifn FTOPS10
  1404
  1405	000267'01  200 03 0 00 004566'		  MOVX T2,<POINT 7,GB.HID+TMPGB>;Where to put it.
  1406	000270'01  201 04 0 00 000100 		  MOVEI T3,ML.SID	;Maximum string count
  1407	000271'01  260 01 0 00 000447'		  CALL UMVAZS		;(T1-T3/T3)Move the string
  1408	000272'01  254 00 0 00 004543'		   RETBAD (LATX06)
  1409	000273'01  542 04 0 00 000000#		  STOR T3,GBLC,+TMPGB	;Store the description length
  1410	000274'01				ENDIF.
  1411	000274'01  336 00 0 00 000000#		SKIPN TMPBLK		;Did we add a new service?
  1412	000275'01  254 00 0 00 000302'		IFSKP.
  1413	000276'01  550 17 0 07 000022 		  OPSTRM <AOS>,HNNSV,(Q2);Yes.
  1414	000277'01  350 00 0 00 000017 
  1415	000300'01  542 17 0 07 000022 
  1416	000301'01  660 14 0 00 000004 		  TXO P4,HNSVN		;Flag that number of services changed.
  1417	000302'01				ENDIF.
  1418	000302'01  436 14 0 07 000000 		IORM P4,HN.FLG(Q2)	;Enter the assebled flags
  1419	000303'01  201 02 0 00 000023 		MOVEI T1,GB.LEN		;Move the new service
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 26-1
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - SET/CLEAR SERVICE

  1420	000304'01  415 03 0 00 000000#		XMOVEI T2,TMPGB		; to the service block
  1421	000305'01  200 04 0 00 000013 		MOVE T3,P3		; supplied by FNDSRV.
  1422	000306'01  123 02 0 00 004567'		XBLT. T1
  1423	000307'01  254 00 0 00 000236*		RETSKP
  1424
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 27
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - SET/CLEAR SERVICE

  1425
  1426
  1427					;CSERVC - Clear LAT Service
  1428
  1429					;Call:	Q1/ User's parameter buffer
  1430					;	Q2/ Host node data base address
  1431					;	T1/ Address of service block to clear
  1432					;RET -	Error return
  1433					;RETSKP - Sucess
  1434
  1435	000310'01  200 04 0 00 000002 	CSERVC:	MOVE T3,T1		;Start of overlay
  1436	000311'01  550 02 0 07 000022 		LOAD T1,HNNSV,(Q2)	;Number of services before clear
  1437	000312'01  221 02 0 00 000023 		IMULI T1,GB.LEN		;Total length of service blocks
  1438	000313'01  415 05 0 07 000422 		XMOVEI T4,HN.SRV(Q2)	;Service block start address
  1439	000314'01  270 02 0 00 000005 		ADD T1,T4		;Address of first word outside service block
  1440	000315'01  415 03 0 04 000023 		XMOVEI T2,GB.LEN(T3)	;First address to move down
  1441	000316'01  274 02 0 00 000003 		SUB T1,T2		;Number of words to move down
  1442	000317'01  337 00 0 00 000002 		SKIPG T1		;Is there a service block above?
  1443	000320'01  254 00 0 00 000322'		JRST CSRVC0		;No so nothing to move
  1444	000321'01  123 02 0 00 004567'		XBLT. T1		;Compress all blocks downward
  1445	000322'01  550 17 0 07 000022 	CSRVC0:	OPSTRM <SOS>,HNNSV,(Q2)	;One service less.	
  1446	000323'01  370 00 0 00 000017 
  1447	000324'01  542 17 0 07 000022 
  1448	000325'01  201 02 0 00 000074 		MOVEI T1,HNCLS!HNSVD!HNSVR!HNSVN
  1449	000326'01  436 02 0 07 000000 		IORM T1,HN.FLG(Q2)	;Indicate service changed.
  1450	000327'01  254 00 0 00 000307*		RETSKP
  1451
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 28
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - SET LAT RETRANSMIT TIMER

  1452						SUBTTL	LATOP% JSYS - SET LAT RETRANSMIT TIMER
  1453
  1454					;SETRTX - Set LAT retransmit timer
  1455					;
  1456					;Call:	Q1/ User's parameter buffer
  1457					;	Q2/ Host node data base address
  1458					;Return:	+2 always
  1459					;
  1460	000330'01  542 03 0 07 000005 	SETRTX:	STOR	T2,HNTIM,(Q2)		;Store millisecond value
  1461	000331'01  221 03 0 00 000000*		IMULI	T2,JIFSEC##		;Convert to ticks
  1462	000332'01  200 02 0 00 000003 		MOVE	T1,T2
  1463	000333'01  231 02 0 00 001750 		IDIVI	T1,^D1000
  1464	000334'01  202 02 0 00 000000#		MOVEM	T1,RTXTIM		;Save retransmit time in ticks
  1465	000335'01  254 00 0 00 000327*		RETSKP
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 29
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - SET LAT HOST NAME

  1466						SUBTTL	LATOP% JSYS - SET LAT HOST NAME
  1467
  1468					;SETNNM - Set LAT host name
  1469
  1470					;Call:	Q1/ User's parameter buffer
  1471					;	Q2/ Host node data base address
  1472					;RET -	Error return
  1473					;RETSKP - Sucess
  1474
  1475	000336'01  554 17 0 07 000024 	SETNNM:	OPSTR <SKIPE>,HNNMC,(Q2);Has one already been set?
  1476	000337'01  332 00 0 00 000017 
  1477	000340'01  254 00 0 00 004570'		RETBAD (LATX09)		;Yes, illegal to reset.
  1478	000341'01  256200  004536'		UMOVE T1,.LABFA(Q1)	;Node name string pointer from the user.
  1479
  1480					IFN FTOPS10,<
  1481	000342'01  260 01 0 00 000265*		CALL CKSTR##		;Check to see if ASCIZ string is addressable
  1482	000343'01  254 00 0 00 004564'		  RETBAD (LATXAC)	;Nope, lose
  1483					>;end ifn FTOPS10
  1484
  1485	000344'01  200 03 0 00 004572'		MOVX T2,<POINT 7,TMPBLK>;Pointer to where to build the string.
  1486	000345'01  201 04 0 00 000006 		MOVEI T3,ML.NNM		;Maximum node name count.
  1487	000346'01  260 01 0 00 000447'		CALL UMVAZS		;Move the ASCIZ string.
  1488	000347'01  254 00 0 00 004543'		  RETBAD (LATX06)
  1489	000350'01  506 04 0 07 000024 		STOR T3,HNNMC,(Q2)	;Store the actual string count
  1490	000351'01  201 02 0 00 000002 		MOVEI T1,<ML.NNM+4>/5	;Maximum number of words in the string
  1491	000352'01  415 03 0 00 000000#		XMOVEI T2,TMPBLK		;Move the string to
  1492	000353'01  415 04 0 07 000025 		XMOVEI T3,HN.NAM(Q2)	; the host node data base
  1493	000354'01  123 02 0 00 004567'		XBLT. T1		; ...
  1494	000355'01  254 00 0 00 000335*		RETSKP
  1495
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 30
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - SET/CLEAR HOST IDENTIFICATION STRING

  1496						SUBTTL	LATOP% JSYS - SET/CLEAR HOST IDENTIFICATION STRING
  1497
  1498					;SETNID/CLRNID - Set/Clear host identification string.
  1499
  1500					;Call:	Q1/ User's parameter buffer
  1501					;	Q2/ Host node data base address
  1502					;RET -	Error return
  1503					;RETSKP - Sucess
  1504
  1505	000356'01  306 12 0 00 000001 	SETNID:	CAIN P2,.LACLR		;Clearing rather than setting?
  1506	000357'01  254 00 0 00 000375'		JRST CLRNID		;Yes.
  1507	000360'01  256200  004536'		UMOVE T1,.LABFA(Q1)	;Node description string pointer from the user.
  1508
  1509					IFN FTOPS10,<
  1510	000361'01  260 01 0 00 000342*		CALL CKSTR##		;Check to see if ASCIZ string is addressable
  1511	000362'01  254 00 0 00 004564'		  RETBAD (LATXAC)	;Nope, lose
  1512					>;end ifn FTOPS10
  1513
  1514	000363'01  200 03 0 00 004573'		MOVX T2,<POINT 7,TMPBLK>;Pointer to where to build the string.
  1515	000364'01  201 04 0 00 000100 		MOVEI T3,ML.DSC		;Maximum node description count.
  1516	000365'01  260 01 0 00 000447'		CALL UMVAZS		;Move the ASCIZ string.
  1517	000366'01  254 00 0 00 004543'		  RETBAD (LATX06)
  1518	000367'01  542 04 0 07 000024 		STOR T3,HNIDC,(Q2)	;Store the actual string count
  1519	000370'01  201 02 0 00 000015 		MOVEI T1,<ML.DSC+4>/5	;Maximum number of words in the string
  1520	000371'01  415 03 0 00 000000#		XMOVEI T2,TMPBLK
  1521	000372'01  415 04 0 07 000027 		XMOVEI T3,HN.ID(Q2)
  1522	000373'01  123 02 0 00 004567'		XBLT. T1
  1523	000374'01  254 00 0 00 000355*		RETSKP
  1524
  1525	000375'01  513 00 0 07 000024 	CLRNID:	SETZRO HNIDC,(Q2)	;Clear the string count
  1526	000376'01  254 00 0 00 000374*		RETSKP
  1527
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 31
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - SET/CLEAR HOST GROUP CODES

  1528						SUBTTL	LATOP% JSYS - SET/CLEAR HOST GROUP CODES
  1529
  1530					; SETCOD/CLRCOD - Set/clear access codes
  1531					;Call:	Q1/ User's parameter buffer
  1532					;	Q2/ Host node data base address
  1533					;RETSKP - always, no errors.
  1534
  1535	000377'01			SETCOD:
  1536
  1537					IFN FTOPS10,<
  1538	000377'01  256200  004536'		UMOVE T1,.LABFA(Q1)	;Get address of string
  1539	000400'01  201 03 0 00 000010 		MOVEI T2,^D8		;and length
  1540	000401'01  260 01 0 00 000162*		CALL ARNGE##		;address check it
  1541	000402'01  254 00 0 00 004527'		  ITERR (LATXAC)	;not there
  1542	000403'01  600 00 0 00 000000 		  NOP			;not writeable (that's ok)
  1543					>;END IFN FTOPS10
  1544
  1545	000404'01  265 17 0 00 004574'		SAVEAC <P1>
  1546	000405'01  265 17 0 00 000000*		STKVAR <USRPTR,MSKPTR>
  1547	000406'01  000000  000002
  1548	000407'01  402 00 0 00 000000#		SETZM TMPBLK		;Zero out the storage where mask to be built.
  1549	000410'01  415 03 0 00 000000#		XMOVEI T2,TMPBLK	;Zero the first workd
  1550	000411'01  415 04 0 03 000001 		XMOVEI T3,1(T2)		;Address of second word
  1551	000412'01  201 02 0 00 000007 		MOVEI T1,^D7		;Number of words to zero.
  1552	000413'01  123 02 0 00 004567'		XBLT. T1		;
  1553	000414'01  256200  004536'		UMOVE T1,.LABFA(Q1)	;Group code address in user space.
  1554	000415'01  505 02 0 00 441000 		HRLI T1,441000		;Make an 8-bit byte pointer
  1555	000416'01  202 02 0 01 777776 		MOVEM T1,USRPTR		;Save it as pointer to user code string.
  1556	000417'01  200 02 0 00 004602'		MOVX T1,<POINT 8,TMPBLK>;Pointer to temporary storage for mask
  1557	000420'01  202 02 0 01 777775 		MOVEM T1,MSKPTR		;Save it too.
  1558	000421'01  201 11 0 00 000040 		MOVEI P1,^D32		;Number of bytes to do
  1559	000422'01				DO.
  1560	000422'01  256 03 0 00 004603'		  XCTBU [ILDB T1,USRPTR];Get a user group code byte
  1561	000423'01  260 01 0 00 000441'		  CALL BITSWP		;Swap the bits
  1562	000424'01  136 02 0 01 777775 		  IDPB T1,MSKPTR	;Put into mask words
  1563	000425'01  367 11 0 00 000422'		  SOJG P1,TOP.		;Continue for full count
  1564	000426'01				ENDDO.
  1565	000426'01  201 02 0 00 000010 		MOVEI T1,^D8		;32 bytes is 8 words
  1566	000427'01  415 03 0 07 000662 		XMOVEI T2,AC.COD+7(Q2)	;Address of last group code word in database
  1567	000430'01				DO.
  1568	000430'01  200 04 0 02 000000#		  MOVE T3,TMPBLK-1(T1)	;Get a mask word, going backwards
  1569	000431'01  306 12 0 00 000001 		  CAIN P2,.LACLR	;Clearing of Setting?
  1570	000432'01  254 00 0 00 000435'		  IFSKP.
  1571	000433'01  436 04 0 03 000000 		    IORM T3,(T2)	;Set the bits	    
  1572	000434'01  254 00 0 00 000436'		  ELSE.
  1573	000435'01  412 04 0 03 000000 		    ANDCAM T3,(T2)	;Clear the bits
  1574	000436'01				  ENDIF.
  1575	000436'01  370 00 0 00 000003 		  SOS T2
  1576	000437'01  367 02 0 00 000430'		  SOJG T1,TOP.
  1577	000440'01				ENDDO.
  1578	000440'01  254 00 0 00 000376*		RETSKP			;Return success.
  1579
  1580					;BITSWP - Swap all bits in an 8-bit byte
  1581					;	See Processor Reference Manual page 2-116 for algorithm
  1582					;
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 31-1
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - SET/CLEAR HOST GROUP CODES

  1583					;Call:	T1/ Byte to swap
  1584					;Returns:
  1585					;	T1/ Swapped byte
  1586
  1587	000441'01  224 02 0 00 004604'	BITSWP:	MUL T1,[100200401002]
  1588	000442'01  404 03 0 00 004605'		AND T2,[20420420020]
  1589	000443'01  405 02 0 00 000041 		ANDI T1,41
  1590	000444'01  235 02 0 00 001777 		DIVI T1,1777
  1591	000445'01  200 02 0 00 000003 		MOVE T1,T2		;put answer in T1
  1592	000446'01  263 01 0 00 000000 		RET
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 32
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - SET/CLEAR HOST GROUP CODES

  1593
  1594					;UMVAZS - Get User ASCIZ String
  1595					;Call:	T1/ User's ASCIZ Pointer
  1596					;	T2/ Destination Pointer
  1597					;	T3/ Maximum string count permitted
  1598					;RET -	Error, string longer than maximum
  1599					;RETSKP	Success
  1600					;	T3/ Actual string count
  1601
  1602						RESCD
  1603
  1604	000447'01  213 00 0 00 000004 	UMVAZS:	MOVNS T3		;Make an AOBJN word
  1605	000450'01  517 00 0 00 000004 		HRLZS T3		;to count up and down at the same time
  1606					IFN FTOPS20,<
  1607						TLC T1,-1		;Make an ASCII pointer to the
  1608						TLCN T1,-1		; user's buffer
  1609						HRLI T1,(<POINT 7,0>)	; if necessary.
  1610					>; END IFN FTOPS20
  1611	000451'01  256 03 0 00 004606'	UMVAZ0:	XCTBU [ILDB T4,T1]	;Get a character from his string.
  1612	000452'01  322 05 0 00 000456'		JUMPE T4,UMVAZ1		;Null found so string ended
  1613	000453'01  136 05 0 00 000003 		IDPB T4,T2		;Deposit character in temp storage.
  1614	000454'01  253 04 0 00 000451'		AOBJN T3,UMVAZ0		;If we are not at the maximum, read more.
  1615	000455'01  263 01 0 00 000000 		RET			;Hit max length without seeing a null.
  1616	000456'01  553 00 0 00 000004 	UMVAZ1:	HRRZS T3		;Return only the positive byte count
  1617	000457'01  254 00 0 00 000440*		RETSKP
  1618
  1619					;MMVAZS - Move ASCIZ string within monitor context
  1620					;Call:	T1/ Source ASCIZ Pointer
  1621					;	T2/ Destination Pointer
  1622					;	T3/ Maximum string count permitted
  1623					;RET -  If string longer than maximum, truncated.
  1624					;	T3/ Actual string count
  1625
  1626	000460'01  265 17 0 00 000405*	MMVAZS:	STKVAR <MAXCNT>
  1627	000461'01  000000  000001
  1628	000462'01  202 04 0 01 777776 		MOVEM T3,MAXCNT		;Save the maximum count
  1629	000463'01  400 04 0 00 000000 		SETZ T3,		;Clear the string count
  1630	000464'01  134 05 0 00 000002 	MMVAZ0:	ILDB T4,T1		;Get a character from his string.
  1631	000465'01  322 05 0 00 000000*		JUMPE T4,RTN		;Null found so string ended
  1632	000466'01  136 05 0 00 000003 		IDPB T4,T2		;Deposit character at destination
  1633	000467'01  311 04 0 01 777776 		CAML T3,MAXCNT		;If we are at the maximum, read no more.
  1634	000470'01  263 01 0 00 000000 		RET
  1635	000471'01  344 04 0 00 000464'		AOJA T3,MMVAZ0		;Increment string count
  1636
  1637						ENDSV.
  1638
  1639						SWAPCD
  1640
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 33
LATSER	MAC	19-Aug-74 07:34		LATOP% - SHOW CHARACTERISTIC HOST

  1641						SUBTTL	LATOP% - SHOW CHARACTERISTIC HOST
  1642
  1643
  1644					;LASCH - Show LAT Host Characteristics
  1645					;Call:	Q1/ User's parameter buffer
  1646					;	Q2/ Host node data base address
  1647					;Return:
  1648					;	RET - error
  1649					;	RETSKP - success
  1650
  1651	000472'01  256200  004607'	LASCH:	UMOVE T3,.LABFA(Q1)	;User buffer address
  1652
  1653					;Check to see if the user provided buffer is large enough for all the data
  1654
  1655	000473'01  201 02 0 00 000055 		MOVEI T1,<HN.MXC-HN.MTI+<ML.LOC+3>/4+<ML.DSC+3>/4+<ML.NNM+3>/4+^D16>
  1656	000474'01  550 05 0 07 000022 		LOAD T4,HNNSV,(Q2)
  1657	000475'01  221 05 0 00 000023 		IMULI T4,GB.LEN		;Number words for service blocks
  1658	000476'01  270 02 0 00 000005 		ADD T1,T4		;Total buffer size in words
  1659	000477'01  260 01 0 00 001044'		  CALL LABFCK		;Is his buffer big enough?
  1660	000500'01  263 01 0 00 000000 		    RETBAD()		;No
  1661					;Move fixed length dynamic parameters from the host node database (HN) to the 
  1662					;user's buffer.
  1663
  1664	000501'01  201 02 0 00 000006 		MOVEI T1,<HN.MTI-HN.MXC+1>;Number words to move
  1665	000502'01  415 03 0 07 000001 		XMOVEI T2,HN.MXC(Q2)	;Address of first HN parameter to move
  1666	000503'01  256 01 0 00 004610'		XBLTXU T1
  1667
  1668					;Move static parameters to the user's buffer.
  1669
  1670	000504'01  201 02 0 00 000005 		MOVEI T1,5		;Number of words to move
  1671						XMOVEI T2,[EXP <LAHPV,,LALPV>;Static parameter address
  1672							   EXP <PROECO,,PROVER>
  1673							   EXP <MXSLSI,,MXSLTS>
  1674							   EXP <LMRFSI,,MXHSRV>
  1675	000505'01  415 03 0 00 004611'			   EXP <LHPRID,,0>]
  1676	000506'01  256 01 0 00 004610'		XBLTXU T1
  1677
  1678					;Move the access code words
  1679	000507'01  201 13 0 00 000040 		MOVEI P3,^D32		;Number of bytes for the access codes
  1680	000510'01  415 12 0 07 000653 		XMOVEI P2,AC.COD(Q2)	;Address of the access codes
  1681	000511'01  661 12 0 00 540000 		TXO P2,<OWGP. 8,0>	;Make global pointer
  1682	000512'01  200 11 0 00 000004 		MOVE P1,T3		;Current address in user's buffer.
  1683	000513'01  661 11 0 00 540000 		TXO P1,<OWGP. 8,0>	;Make a byte pointer
  1684	000514'01				DO.
  1685	000514'01  134 02 0 00 000012 		  ILDB T1,P2		;Get a byte for group codes
  1686	000515'01  260 01 0 00 000441'		  CALL BITSWP		;Swap the bits
  1687	000516'01  256 03 0 00 004616'		  XCTBU [IDPB T1,P1]	;Deposit swapped byte into user buffer.
  1688	000517'01  367 13 0 00 000514'		  SOJG P3,TOP.		;Do all bytes
  1689	000520'01  551 04 0 11 000001 		HRRZI T3,1(P1)		;Make user pointer an address again.	  
  1690	000521'01				ENDDO.
  1691
  1692					;Move Host node name and host node description
  1693
  1694	000521'01  201 02 0 00 000020 		MOVEI T1,<<ML.NNM+4>/5+<ML.DSC+4>/5+1>
  1695	000522'01  415 03 0 07 000024 		XMOVEI T2,HN.NMC(Q2)	;Address of node name and description
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 33-1
LATSER	MAC	19-Aug-74 07:34		LATOP% - SHOW CHARACTERISTIC HOST

  1696	000523'01  256 01 0 00 004610'		XBLTXU T1
  1697						;...
  1698
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 34
LATSER	MAC	19-Aug-74 07:34		LATOP% - SHOW CHARACTERISTIC HOST

  1699
  1700
  1701						;...
  1702
  1703					;Move the service blocks
  1704
  1705	000524'01  550 02 0 07 000022 		LOAD T1,HNNSV,(Q2)	;Number of services currently defined
  1706	000525'01  256200  004617'		UMOVEM T1,(T3)		;Move to user buffer
  1707	000526'01  350 00 0 00 000004 		AOS T3			;Advance buffer address
  1708	000527'01  200 02 0 00 000005 		MOVE T1,T4		;Get back the total service block length
  1709	000530'01  415 03 0 07 000422 		XMOVEI T2,HN.SRV(Q2)	;Address of service blocks
  1710	000531'01  256 01 0 00 004610'		XBLTXU T1
  1711	000532'01  254 00 0 00 000457*		RETSKP
  1712
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 35
LATSER	MAC	19-Aug-74 07:34		LATOP JSYS - SHOW TERMINAL CONNECTS

  1713						SUBTTL 	LATOP JSYS - SHOW TERMINAL CONNECTS
  1714					;
  1715					; LASTC - SHOW TERMINAL CONNECTS
  1716					;
  1717					;Call:	Q1/ address of user's arg list
  1718					;	Q2/ Address of Host node database
  1719					;Return:
  1720					;	+1 error
  1721					;	+2 success
  1722					;
  1723	000533'01  550 02 0 07 000003 	LASTC:	LOAD T1,HNCON,(Q2)	;How many do we think are connected?
  1724	000534'01  200 05 0 00 000002 		MOVE T4,T1		;Save count
  1725	000535'01  221 02 0 00 000006 		IMULI T1,<2+MW.SYS>	; * size of returned block
  1726	000536'01  260 01 0 00 001044'		  CALL LABFCK		;Is his buffer big enough?
  1727	000537'01  263 01 0 00 000000 		    RETBAD()		;No
  1728	000540'01  201 02 0 00 000000*		MOVEI T1,NTTLAH		;Get size of SBvect
  1729	000541'01  261 01 0 00 000002 		PUSH P,T1		;Save as a counter
  1730	000542'01  256200  004620'		UMOVE P1,.LABFA(Q1)	;Get user's buffer address
  1731	000543'01  200 12 0 00 000000#		MOVE P2,SBVECT		;Point to table of SBs
  1732	000544'01  332 02 0 12 000000 	LASTCL:	SKIPE T1,(P2)		;Is there a slot block there?
  1733	000545'01  260 01 0 00 000557'		CALL LAS1C		;Yes, move data for it to user's buffer
  1734	000546'01  254 00 0 00 000550'		  JRST LASTCN		;No, go for next one
  1735	000547'01  363 05 0 00 000552'		SOJLE T4,LASTCD		;Have we given the user as many as we said?
  1736	000550'01  373 00 0 01 000000 	LASTCN:	SOSLE (P)		;Or have we exhausted SBVECT?
  1737	000551'01  344 12 0 00 000544'		AOJA P2,LASTCL		;No, just go for next data block
  1738	000552'01  105 01 0 00 777777 	LASTCD:	ADJSP P,-1		;Done, adjust stack
  1739	000553'01  256200  004536'		UMOVE T1,.LABFA(Q1)	;Get address of show buffer again
  1740	000554'01  274 11 0 00 000002 		SUB P1,T1		;Calculate number of words moved
  1741	000555'01  256 04 0 00 004621'		XCTU [HRLM P1,.LABCT(Q1)] ;and store it.
  1742	000556'01  254 00 0 00 000532*		RETSKP			;And give good return
  1743
  1744					;
  1745					;	Routine to move one connect block to user's show buffer
  1746					;Call:
  1747					;	T1/ Slot Block address
  1748					;	P1/ Next address in user's buffer
  1749					;
  1750					;Return: +1 no attached terminal or circuit block now
  1751					;	 +2 Success. Data moved to user's buffer
  1752					;
  1753					;	P1/ Updated next address to fill in user's buffer (in either case)
  1754					;
  1755	000557'01  332 10 0 02 000024 	LAS1C:	SKIPE U,SB.TDB(T1)	;Any LDB associated with slot?
  1756	000560'01  336 03 0 02 000025 		SKIPN T2,SB.CBA(T1)	;Any circuit block?
  1757	000561'01  263 01 0 00 000000 		  RET			;No, skip this one
  1758	000562'01  550 02 0 03 000025 		LOAD T1,CBRSC,(T2)	;Yes, get server name string count
  1759	000563'01  135 10 0 00 000000*		LDB U,LDPLNO##		;Yes, get TTY line number
  1760	000564'01  256200  004622'		UMOVEM U,(P1)		;Give to user
  1761	000565'01  256200  004623'		UMOVEM T1,1(P1)		;Store count
  1762	000566'01  415 03 0 03 000027 		XMOVEI T2,CB.SNM(T2)	;and point to name string
  1763	000567'01  201 02 0 00 000004 		MOVEI T1,<MW.SYS> 	;length of string
  1764	000570'01  200 04 0 00 000011 		MOVE T3,P1		;Get current user buffer address
  1765	000571'01  271 04 0 00 000002 		ADDI T3,2		; +2 for the words we have filled
  1766	000572'01  256 01 0 00 004610'		XBLTXU T1		;Fill in the user's buffer
  1767	000573'01  200 11 0 00 000004 		MOVE P1,T3		;Point P1 to the next free place in buffer
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 35-1
LATSER	MAC	19-Aug-74 07:34		LATOP JSYS - SHOW TERMINAL CONNECTS

  1768	000574'01  254 00 0 00 000556*		RETSKP			;and give good return
  1769
  1770
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 36
LATSER	MAC	19-Aug-74 07:34		LATOP JSYS - SHOW SERVERS

  1771						SUBTTL	LATOP JSYS - SHOW SERVERS
  1772
  1773					;LASAS - Show All Known Servers
  1774					;Call:	Q1/ User's parameter buffer
  1775					;	Q2/ Host node data base address
  1776					;Return:
  1777					;	RET - error
  1778					;	RETSKP - success
  1779
  1780	000575'01  305 11 0 00 000005 	LASAS:	CAIGE P1,5		;Is the user's arg block the right size?
  1781	000576'01  254 00 0 00 004624'		RETBAD (ARGX04)		;No
  1782					REPEAT 0,<
  1783						UMOVE T1,.LAQUA(Q1)	;User's pointer to server name
  1784						CAIN T1,-1		;Specific server wanted?
  1785					>
  1786	000577'01  256 04 0 00 004626'		XCTU [SKIPN T1,.LAQUA(Q1)]	;Specific server wanted?
  1787	000600'01  254 00 0 00 000615'		IFSKP.			;Yes.
  1788
  1789					IFN FTOPS10,<
  1790	000601'01  260 01 0 00 000361*		CALL CKSTR##		;Check to see if ASCIZ string is addressable
  1791	000602'01  254 00 0 00 004564'		  RETBAD (LATXAC)	;Nope, lose
  1792					>;end ifn FTOPS10
  1793
  1794					IFN FTOPS20,<CALL MAKPTR	;Make a valid ASCIZ pointer.>
  1795	000603'01  260 01 0 00 000762'		  CALL GTSRVR		;Find circuit block based on server name.
  1796	000604'01  263 01 0 00 000000 		   RETBAD ()		;Unknown server
  1797	000605'01  200 05 0 00 000002 		  MOVE T4,T1		;Save the circuit block address
  1798	000606'01  201 02 0 00 000031 		  MOVEI T1,<SASEND-SASBEG>;# words returned for single server
  1799	000607'01  260 01 0 00 001044'		  CALL LABFCK		;Is his buffer big enough?
  1800	000610'01  263 01 0 00 000000 		    RETBAD()		;No
  1801	000611'01  256200  004607'	 	  UMOVE T3,.LABFA(Q1)	;Get his buffer address 
  1802	000612'01  415 03 0 05 000017 		  XMOVEI T2,SASBEG(T4)	;Address of source
  1803	000613'01  256 01 0 00 004610'		  XBLTXU T1	;Move to user space
  1804	000614'01  254 00 0 00 000574*		  RETSKP		;Return successfully.
  1805	000615'01				ENDIF.
  1806	000615'01  550 02 0 07 000001 		LOAD T1,HNNCC,(Q2)	;Get the number of allocated circuit blocks
  1807	000616'01  221 02 0 00 000007 		IMULI T1,<1+MW.SYS+2>	;Compute space needed in user's buffer
  1808	000617'01  260 01 0 00 001044'		CALL LABFCK		;Is his buffer big enough
  1809	000620'01  263 01 0 00 000000 		  RETBAD()		;NO
  1810	000621'01  256200  004607'		UMOVE T3,.LABFA(Q1)	;Get user buffer address
  1811	000622'01  200 05 0 07 000011 		MOVE T4,HN.QAC(Q2)	;First element on the active queue
  1812	000623'01  260 01 0 00 000627'		CALL SASLP		;Get all those on the active queue
  1813	000624'01  200 05 0 07 000013 		MOVE T4,HN.QIC(Q2)	;Do the same for
  1814	000625'01  260 01 0 00 000627'		CALL SASLP		; the inactive queue.
  1815	000626'01  254 00 0 00 000614*		RETSKP			;Return successfully.
  1816
  1817	000627'01  322 05 0 00 000465*	SASLP:	JUMPE T4,RTN		;No more circuit blocks on this queue
  1818	000630'01  200 02 0 05 000025 		MOVE T1,CB.RSC(T4)	;get <number,,name count>
  1819	000631'01  256200  004617'		UMOVEM T1,(T3)		;Give it to user
  1820	000632'01  271 04 0 00 000001 		ADDI T3,1		;Bump destination address
  1821	000633'01  201 02 0 00 000004 		MOVEI T1,MW.SYS		;There are 4 words of name
  1822	000634'01  415 03 0 05 000027 		XMOVEI T2,CB.SNM(T4)	;Address of first to copy
  1823	000635'01  256 01 0 00 004610'		XBLTXU T1	;Copy to user's space
  1824	000636'01  120 02 0 05 000017 		DMOVE T1,CB.DNI(T4)	;Get Ethernet address
  1825	000637'01  256 04 0 00 004627'		XCTU [DMOVEM T1,(T3)]	;Give it to the user
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 36-1
LATSER	MAC	19-Aug-74 07:34		LATOP JSYS - SHOW SERVERS

  1826	000640'01  271 04 0 00 000002 		ADDI T3,2		;Account for those words
  1827	000641'01  200 05 0 05 000000 		LOAD T4,QLFWD,+CB.LNK(T4);Get the next CB
  1828	000642'01  254 00 0 00 000627'		JRST SASLP		;And continue looping thru queue
  1829
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 37
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - SHOW/ZERO COUNTERS

  1830						SUBTTL	LATOP% JSYS - SHOW/ZERO COUNTERS
  1831
  1832					;LASCO - Show LAT Counters
  1833					;CALL:	Q1/ User argument block address
  1834					;	Q2/ LAT host node data base address
  1835
  1836	000643'01  305 11 0 00 000005 	LASCO:	CAIGE P1,5		;Is the user's arg block the right size?
  1837	000644'01  254 00 0 00 004624'		RETBAD (ARGX04)		;No
  1838	000645'01  260 01 0 00 000667'		CALL GTLCOB		;Get the counter block based on server name.
  1839	000646'01  263 01 0 00 000000 		 RET			;Error, already reported
  1840	000647'01  256 04 0 00 004630'		XCTU [HRLM T1,.LABCT(Q1)];Tell user
  1841	000650'01  256 04 0 00 004631'		XCTU [HRRZ T3,.LABCT(Q1)];Get his buffer count.
  1842	000651'01  315 04 0 00 000002 		CAMGE T3,T1		;Has user allocated large enough buffer?
  1843	000652'01  254 00 0 00 004632'		RETBAD (LATX01)		;No
  1844	000653'01  256200  004607'		UMOVE T3,.LABFA(Q1)	;Get his buffer address 
  1845	000654'01  256 01 0 00 004610'		XBLTXU T1
  1846	000655'01  254 00 0 00 000626*		RETSKP
  1847
  1848					;LAZCO - Zero LAT Counters
  1849					;CALL:	Q1/ User argument block address
  1850					;	Q2/ LAT host node data base address
  1851
  1852	000656'01  305 11 0 00 000005 	LAZCO:	CAIGE P1,5		;Is the user's arg block the right size?
  1853	000657'01  254 00 0 00 004624'		RETBAD (ARGX04)		;No
  1854	000660'01  260 01 0 00 000667'		CALL GTLCOB		;Get the counter block bases on server name.
  1855	000661'01  263 01 0 00 000000 		 RET			;Error, already reported
  1856	000662'01  402 00 0 03 000000 		SETZM (T2)		;Zero the first counter
  1857	000663'01  415 04 0 03 000001 		XMOVEI T3,1(T2)		;
  1858	000664'01  373 00 0 00 000002 		SOSLE T1		;Account for the word we just zeroed
  1859	000665'01  123 02 0 00 004567'		XBLT. T1		;Zero the block if more than 1 word
  1860	000666'01  254 00 0 00 000655*		RETSKP			;Return successfully.
  1861
  1862					;GTLCOB - Get LAT Counter Block.  Get the length and address of the LAT
  1863					; counter block based on server number.
  1864					;
  1865					;CALL:	T1/ Pointer to server name or [0,,-1]
  1866					;RET:	Error - server unknown
  1867					;RETSKP:Success with
  1868					;	T1/ Counter block length in words
  1869					;	T2/ Counter block address
  1870
  1871	000667'01			GTLCOB:
  1872					REPEAT 0,<
  1873						CAIN T1,-1		;Zero local host counters?
  1874					>
  1875	000667'01  256 04 0 00 004626'		XCTU [SKIPN T1,.LAQUA(Q1)]	;Get server name requested
  1876	000670'01  254 00 0 00 000700'		IFSKP.			;Zero a particular server's counters
  1877
  1878					IFN FTOPS10,<
  1879	000671'01  260 01 0 00 000601*		CALL CKSTR##		;Check to see if ASCIZ string is addressable
  1880	000672'01  254 00 0 00 004564'		  RETBAD (LATXAC)	;Nope, lose
  1881					>;end ifn FTOPS10
  1882
  1883					IFN FTOPS20,<CALL MAKPTR	;Make a valid pointer>
  1884	000673'01  260 01 0 00 000762'		  CALL GTSRVR		;Find circuit block based on server name
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 37-1
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - SHOW/ZERO COUNTERS

  1885	000674'01  263 01 0 00 000000 		   RETBAD ()		;Unknown server
  1886	000675'01  415 03 0 02 000051 		  XMOVEI T2,CC.BEG(T1)	;Server counter block address
  1887	000676'01  201 02 0 00 000010 		  MOVEI T1,CC.LEN	;Server counter block length
  1888	000677'01  254 00 0 00 000702'		ELSE.			;Local host counters wanted
  1889	000700'01  201 02 0 00 000010 		  MOVEI T1,HC.LEN	;Host counter block length
  1890	000701'01  415 03 0 07 000713 		  XMOVEI T2,HC.BEG(Q2)	;Host counter block address
  1891	000702'01				ENDIF.
  1892	000702'01  254 00 0 00 000666*		RETSKP
  1893
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 38
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - Utility Routines - FNDSRV

  1894						SUBTTL	LATOP% JSYS - Utility Routines - FNDSRV
  1895
  1896					;FNDSRV - find the service block requested by the user based on the
  1897					; service name provided.
  1898
  1899					;Call:	no arguments
  1900					;Return:
  1901					;	RET - error
  1902					;	RETSKP - success, T1/ address of service block
  1903
  1904	000703'01  265 17 0 00 004634'	FNDSRV:	SAVEAC <P1,P2>
  1905	000704'01  201 02 0 00 000077 		MOVEI T1,TMPLNG-1	;Zero the storage for assembling user's
  1906	000705'01  415 03 0 00 000000#		XMOVEI T2,TMPBLK	; service name.
  1907	000706'01  415 04 0 00 000000#		XMOVEI T3,TMPBLK+1	; ...
  1908	000707'01  402 00 0 00 000000#		SETZM TMPBLK		; ...
  1909	000710'01  123 02 0 00 004567'		XBLT. T1		; ...
  1910
  1911					;Get the Service Name string from the user and put it into the service
  1912					;block build area.
  1913
  1914	000711'01  256200  004536'		UMOVE T1,.LABFA(Q1)	;Pointer to user's service name string
  1915
  1916					IFN FTOPS10,<
  1917	000712'01  260 01 0 00 000671*		CALL CKSTR##		;Check to see if ASCIZ string is addressable
  1918	000713'01  254 00 0 00 004564'		  RETBAD (LATXAC)	;Nope, lose
  1919					>;end ifn FTOPS10
  1920
  1921					IFN FTOPS20,<CALL MAKPTR	;Make a valid ASCIZ pointer>
  1922	000714'01  415 03 0 00 000000#		XMOVEI T2,TMPGB+GB.NAM	;Pointer of where to put it
  1923	000715'01  661 03 0 00 610000 		TXO T2,<OWGP. 7,0>	; ...
  1924	000716'01  201 04 0 00 000020 		MOVEI T3,<ML.SNM+4/5>	;Maximum length
  1925	000717'01  260 01 0 00 000447'		CALL UMVAZS		;Move the string to exec space
  1926	000720'01  254 00 0 00 004545'		 RETBAD (LATX07)		;Service name too long
  1927	000721'01  506 04 0 00 000000#		STOR T3,GBNC,+TMPGB	;Store the count of service name from user
  1928
  1929					;Loop through all service blocks looking for a name match.
  1930
  1931	000722'01  415 12 0 07 000422 		XMOVEI P2,HN.SRV(Q2)	;Address of start of service blocks
  1932	000723'01  550 17 0 07 000022 		OPSTR <SKIPN P1,>,HNNSV,(Q2);Number of currently defined services
  1933	000724'01  336 11 0 00 000017 
  1934	000725'01  254 00 0 00 000751'		JRST FSFALS		;There are none defined.
  1935	000726'01				DO.
  1936	000726'01  415 02 0 12 000002 		  XMOVEI T1,GB.NAM(P2)	;Address of service block's service name
  1937	000727'01  661 02 0 00 610000 		  TXO T1,<OWGP. 7,0>
  1938	000730'01  554 03 0 12 000001 		  LOAD T2,GBNC,(P2)	;Count of service block's service name
  1939	000731'01  415 04 0 00 000000#		  XMOVEI T3,TMPGB+GB.NAM;Address of user's service name
  1940	000732'01  661 04 0 00 610000 		  TXO T3,<OWGP. 7,0>
  1941	000733'01  554 05 0 00 000000#		  LOAD T4,GBNC,+TMPGB	;Count of user's service name
  1942	000734'01  260 01 0 00 001017'		  CALL SCMPAR		;Compare the strings
  1943	000735'01  254 00 0 00 000747'		  IFSKP.		;MATCH FOUND
  1944	000736'01  201 02 0 00 000000 		    MOVEI T1,.LASET	;If a SET...
  1945	000737'01  256 04 0 00 004644'		    XCTU [CAME T1,.LAFCN(Q1)]
  1946	000740'01  254 00 0 00 000745'		    IFSKP.
  1947	000741'01  201 02 0 00 000023 		      MOVEI T1,GB.LEN	; then copy entire service block to the
  1948	000742'01  415 03 0 12 000000 		      XMOVEI T2,(P2)	; temporary block so that new values
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 38-1
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - Utility Routines - FNDSRV

  1949	000743'01  415 04 0 00 000000#		      XMOVEI T3,TMPGB	; overlay the old.
  1950	000744'01  123 02 0 00 004567'	    	      XBLT. T1
  1951	000745'01				    ENDIF.
  1952	000745'01  200 02 0 00 000012 		    MOVE T1,P2		;In both cases (SET/CLEAR) return service
  1953	000746'01  254 00 0 00 000702*		    RETSKP		; block address.
  1954	000747'01				  ENDIF.
  1955	000747'01  271 12 0 00 000023 		  ADDI P2,GB.LEN	;No match here so
  1956	000750'01  367 11 0 00 000726'		  SOJG P1,TOP.		; advance to next service block
  1957	000751'01				ENDDO.
  1958
  1959					;Service block not found.  If function is SET, see if there is room for
  1960					;a new service.  If function is CLEAR, nothing further required.
  1961
  1962	000751'01  201 02 0 00 000000 	FSFALS:	MOVEI T1,.LASET		;If service name not found and the function
  1963	000752'01  256 04 0 00 004644'		XCTU [CAME T1,.LAFCN(Q1)]; request is not a SET,
  1964	000753'01  254 00 0 00 004545'		RETBAD (LATX07)		; then return an error. Otherwise,
  1965	000754'01  415 02 0 07 000652 		XMOVEI T1,<GB.LEN*MXHSRV+HN.SRV>(Q2); get end of service block address
  1966	000755'01  311 12 0 00 000002 		CAML P2,T1		; and compare with first free block address
  1967	000756'01  254 00 0 00 004645'		RETBAD (LATX08)		;There is no room for new service.
  1968	000757'01  476 00 0 00 000000#		SETOM TMPBLK		;There is room.  Flag to increment # services.
  1969	000760'01  200 02 0 00 000012 		MOVE T1,P2		;Return service block address for new entry.
  1970	000761'01  254 00 0 00 000746*		RETSKP
  1971
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 39
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - Utility Routines - GTSRVR

  1972						SUBTTL	LATOP% JSYS - Utility Routines - GTSRVR
  1973
  1974
  1975					;GTSRVR - Routine to get the circuit block address for a particular 
  1976					; server based on server name.
  1977					;
  1978					;CALL:	T1/ Pointer to server name supplied by user
  1979					;	Q2/ LAT host node data base address
  1980					;RET - 	Error, no circuit block with the requested server name
  1981					;RETSKP	Success,
  1982					;	T1/ Circuit block address for requested server
  1983
  1984	000762'01  265 17 0 00 004647'	GTSRVR:	SAVEAC Q1		;Get an AC for circuit block address.
  1985	000763'01  200 03 0 00 004655'		MOVX T2,<POINT 7,TMPBLK>;Pointer to where to move name string.
  1986	000764'01  201 04 0 00 000100 		MOVEI T3,ML.DSC		;Maximum server name string length.
  1987	000765'01  260 01 0 00 000447'		CALL UMVAZS		;(T1-T3/T3)Move the ASCIZ string.
  1988	000766'01  254 00 0 00 004656'		  RETBAD (LATX04)
  1989	000767'01  200 02 0 00 004660'		MOVX T1,<POINT 7,TMPBLK>;Pointer to user's name string in local storage
  1990	000770'01  200 03 0 00 000004 		MOVE T2,T3		;Length of the user's name string.
  1991	000771'01  200 06 0 07 000011 		LOAD Q1,HNQAC,(Q2)	;Get first CB on active queue
  1992	000772'01  260 01 0 00 001004'		CALL GCBNAM		;See if desired server there
  1993	000773'01  254 00 0 00 000776'		IFSKP.
  1994	000774'01  200 02 0 00 000006 		  MOVE T1,Q1		;Return the CB address on successful
  1995	000775'01  254 00 0 00 000761*		  RETSKP		; match.
  1996	000776'01				ENDIF.
  1997	000776'01  200 06 0 07 000013 		LOAD Q1,HNQIC,(Q2)	;Get first CB on inactive queue
  1998	000777'01  260 01 0 00 001004'		CALL GCBNAM
  1999	001000'01  254 00 0 00 001003'		IFSKP.
  2000	001001'01  200 02 0 00 000006 		  MOVE T1,Q1		;Return the CB address on successful
  2001	001002'01  254 00 0 00 000775*		  RETSKP		; match.
  2002	001003'01				ENDIF.
  2003	001003'01  254 00 0 00 004656'		RETBAD (LATX04)		;Not anywhere, return error.
  2004
  2005					;GCBNUM - searches a particular queue of circuit blocks looking for a match
  2006					; on the server name.
  2007
  2008	001004'01  265 17 0 00 004661'	GCBNAM: SAVEAC <T1,T2>		;Preserve string pointer and count.
  2009	001005'01  322 06 0 00 000627*		JUMPE Q1,RTN		;No more circuit blocks on this queue
  2010	001006'01				DO.
  2011	001006'01  415 04 0 06 000027 		  XMOVEI T3,CB.SNM(Q1)	;Address of server name
  2012	001007'01  661 04 0 00 610000 		  TXO T3,<OWGP. 7,0>	;Make a pointer
  2013	001010'01  550 05 0 06 000025 		  LOAD T4,CBRSC,(Q1)	;Count in name
  2014	001011'01  260 01 0 00 001017'		  CALL SCMPAR		;Do the compare
  2015	001012'01  334 00 0 00 000000 		   SKIPA		;No match
  2016	001013'01  254 00 0 00 001002*		  RETSKP		;Match
  2017	001014'01  336 06 0 06 000000 		  OPSTR <SKIPN Q1,>,QLFWD,+CB.LNK(Q1)
  2018	001015'01  263 01 0 00 000000 		  RET			;No match for any CBs on queue.
  2019	001016'01  254 00 0 00 001006'		  JRST TOP.		;Try next CB.
  2020	001017'01				ENDDO.
  2021
  2022
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 40
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - Utility Routines - SCMPAR String Compare

  2023						SUBTTL	LATOP% JSYS - Utility Routines - SCMPAR String Compare
  2024
  2025					;SCMPAR - String Compare
  2026					;Call:	T1/ First string byte pointer
  2027					;	T2/ First string count
  2028					;	T3/ Second string byte pointer
  2029					;	T4/ Second string count
  2030					;RET 	Mismatch
  2031					;RETSKP Match
  2032
  2033	001017'01  265 17 0 00 004671'	SCMPAR:	SAVEAC <T1,T2,T3,T4>	;Preserve the byte pointers.
  2034	001020'01  265 17 0 00 000460*		STKVAR <PTR1,PTR2>
  2035	001021'01  000000  000002
  2036	001022'01  312 03 0 00 000005 		CAME T2,T4		;If lengths don't match then obviously
  2037	001023'01  263 01 0 00 000000 		RET			; the strings don't either.
  2038	001024'01  202 02 0 01 777776 		MOVEM T1,PTR1		;Save the byte pointers
  2039	001025'01  202 04 0 01 777775 		MOVEM T3,PTR2		; to the strings.
  2040	001026'01				DO.
  2041	001026'01  134 02 0 01 777776 		  ILDB T1,PTR1		;Get next character from
  2042	001027'01  134 03 0 01 777775 		  ILDB T2,PTR2		; each string.
  2043	001030'01  260 01 0 00 001037'		  CALL UPPERC		;Uppercase one.
  2044	001031'01  250 02 0 00 000003 		  EXCH T1,T2
  2045	001032'01  260 01 0 00 001037'		  CALL UPPERC		;Uppercase the other.
  2046	001033'01  312 02 0 00 000003 		  CAME T1,T2		;Compare the result.
  2047	001034'01  263 01 0 00 000000 		  RET			;Different so return failure.
  2048	001035'01  367 05 0 00 001026'		  SOJG T4,TOP.		;Match, so continue with the next.
  2049	001036'01				ENDDO.
  2050	001036'01  254 00 0 00 001013*		RETSKP			;Full match, return success.
  2051
  2052						ENDSV.
  2053
  2054					;UPPERC - Uppercase a character
  2055					;Call:	T1/ Character
  2056					;RET	Always with T1/ uppercased character
  2057
  2058	001037'01  301 02 0 00 000141 	UPPERC:	CAIL T1,"a"
  2059	001040'01  303 02 0 00 000172 		CAILE T1,"z"
  2060	001041'01  334 00 0 00 000000 		SKIPA
  2061	001042'01  275 02 0 00 000040 		SUBI T1,40
  2062	001043'01  263 01 0 00 000000 		RET
  2063
  2064					;LABFCK - Check if the user's show buffer is big enough
  2065					;Call:	T1/ Needed size
  2066					;Return:
  2067					;	+1 Not big enough
  2068					;	   T1/ LATX01
  2069					;
  2070					;	+2 OK
  2071	001044'01  256 04 0 00 004630'	LABFCK:	XCTU [HRLM T1,.LABCT(Q1)];Tell user
  2072	001045'01  256 04 0 00 004537'		XCTU [HRRZ T2,.LABCT(Q1)];Get his buffer count.
  2073	001046'01  315 03 0 00 000002 		CAMGE T2,T1		;Has user allocated large enough buffer?
  2074	001047'01  254 00 0 00 004632'		RETBAD (LATX01)		;No
  2075	001050'01  254 00 0 00 001036*		RETSKP			;Yes
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 41
LATSER	MAC	19-Aug-74 07:34		LATOP% JSYS - Utility Routines - SCMPAR String Compare

  2076
  2077					IFN FTOPS20,<
  2078					;MAKPTR- Make a valid ASCIZ pointer if not already
  2079					
  2080					MAKPTR:	MOVE T2,T1		;Make a proper pointer in case the user
  2081						TLC T2,-1		; supplied one of the form
  2082						TLCN T2,-1		; -1,,address
  2083						HRLI T1,440700		; ...
  2084						RET
  2085					>;END IFN FTOPS20
  2086
  2087					IFN FTOPS10,<
  2088
  2089					;ERRRTN- Error return from LATOP. UUO
  2090					;	Must only be called at top level within UUO
  2091					;	i.e. the only thing on the stack is old value of M
  2092					;	Otherwise, use RETBAD and propagate error return
  2093					;
  2094	001051'01  262 01 0 00 000007 	ERRRTN:	POP P,M			;Restore original UUO
  2095	001052'01  262 01 0 00 000006 		POP P,W			;Restore saved AC
  2096	001053'01  254 00 0 00 000000*		JRST STOTAC##		;Store error code and return to user
  2097
  2098					;
  2099					;	Last thing in LATOP. UUO code
  2100					;
  2101						PURGE Q1,Q2		;undefine TOPS-20 ACs
  2102
  2103					>;end ifn FTOPS10
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 42
LATSER	MAC	19-Aug-74 07:34		LATINI - LAT Initialization

  2104						SUBTTL	LATINI - LAT Initialization
  2105
  2106					;LATINI - LAT Initialization
  2107					;
  2108					;Call:	CALL LATINI
  2109					;	  Error return - resource failure
  2110					;	Normal Return
  2111					;
  2112
  2113						ENTRY LATINI		;Keep LINK happy in library search mode
  2114
  2115	001054'01  260 01 0 00 000000*	LATINI:	SE1ENT
  2116	001055'01  265 17 0 00 004703'		ACVAR <HN,XB,W1,W2>	;Reserve AC for Host Node data base address
  2117	001056'01  201 02 0 00 000724 		MOVEI T1,HC.LST+1	;Get memory for the Host Node (HN) tables
  2118	001057'01  260 01 0 00 004471'		CALL MMGTZW		;Get zeroed memory
  2119	001060'01  254 00 0 00 001236'		 JRST INIRES		;Resource failure. Should not happen.
  2120	001061'01  200 06 0 00 000002 		MOVE HN,T1		;Base address for host node database references
  2121	001062'01  205 17 0 00 400000 		SETONE HNRUN,(HN)	;Set flag that says NI not running (yet).
  2122	001063'01  436 17 0 06 000000 
  2123	001064'01  202 02 0 00 000145*		MOVEM T1,LAHNDB		;Store the data base address
  2124	001065'01  201 02 0 00 000255 		MOVEI T1,CBMAXI		;Get storage for CBVECT
  2125	001066'01  260 01 0 00 004471'		CALL MMGTZW		;
  2126	001067'01  254 00 0 00 001236'		  JRST INIRES		;Resource failure.
  2127	001070'01  202 02 0 00 000000#		MOVEM T1,CBVECT		;Save the address
  2128	001071'01  201 02 0 00 000540*		MOVEI T1,NTTLAH		;Get storage for SBVECT
  2129	001072'01  260 01 0 00 004471'		CALL MMGTZW
  2130	001073'01  254 00 0 00 001236'		 JRST INIRES		;Resource failure.
  2131	001074'01  202 02 0 00 000000#		MOVEM T1,SBVECT		;Save the address
  2132					IFN FTOPS10,<
  2133					;
  2134					;	Now carve up the core we got at ONCE time
  2135					;	The free core pool will be turned into a
  2136					;	linked list of fixed length buffers from which we can allocate
  2137					;	transmit and receive buffers.
  2138					;
  2139	001075'01  402 00 0 00 000000#		SETZRO QLFWD,+LATFRE	;Clear out the queue
  2140	001076'01  402 00 0 00 000000#		SETZRO QLBWD,+LATFRE
  2141	001077'01  260 01 0 00 004401'		CALL LAGTCR		;find out how much memory we got at ONCE time
  2142	001100'01  231 02 0 00 000000*		IDIVI T1,BUFSIZ		;See how many buffers will fit
  2143	001101'01  200 05 0 00 000002 		MOVE T4,T1		;Put it where we need it later.
  2144	001102'01  202 05 0 00 000000#		MOVEM T4,LATNFB		;Remember how many we have at start
  2145	001103'01  200 03 0 00 000000#		MOVE T2,LATLOC		;Start of first one
  2146	001104'01  260 01 0 00 004424'		CALL ALCBUF		;Link them together
  2147
  2148	001105'01  200 02 0 00 000000*		MOVE T1,STANAM		;Get our node name
  2149	001106'01  260 01 0 00 004504'		CALL CVTNOD		;Convert to ASCII
  2150					>;end IFN FTOPS10
  2151	001107'01  120 02 0 00 000000#		DMOVE T1,OURNAM		;Get the local host name
  2152	001110'01  124 02 0 06 000025 		DMOVEM T1,HN.NAM(HN)	;Store in HN block
  2153	001111'01  200 02 0 00 000000#		MOVE T1,OURCNT		;Host name length in characters
  2154	001112'01  506 02 0 06 000024 		STOR T1,HNNMC,(HN)	;Store in HN block
  2155					IFN FTOPS20,<	MOVX T1,<POINT 7,SVN##>	;Pointer to MONNAM.TXT>
  2156	001113'01  200 02 0 00 004715'	IFN FTOPS10,<	MOVX T1,<POINT 7,CONFIG> ;Pointer to Monitor name>
  2157	001114'01  200 03 0 00 004716'		MOVX T2,<POINT 7,HN.ID(HN)>;Where to put it.
  2158	001115'01  201 04 0 00 000100 		MOVEI T3,ML.DSC		;Maximum length allowed
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 42-1
LATSER	MAC	19-Aug-74 07:34		LATINI - LAT Initialization

  2159	001116'01  260 01 0 00 000460'		CALL MMVAZS		;Move the string
  2160	001117'01  600 00 0 00 000000 		  TRN			;Don't care, take truncated string
  2161	001120'01  542 04 0 06 000024 		STOR T3,HNIDC,(HN)	;Store real count
  2162	001121'01  201 02 0 00 000074 		MOVEI T1,^D60		;Default Host message retransmit limit
  2163	001122'01  506 02 0 06 000005 		STOR T1,HNRLI,(HN)
  2164	001123'01  201 02 0 00 001750 		MOVEI T1,^D1000		;Default host virtual circuit timer(ticks)
  2165	001124'01  542 02 0 06 000005 		STOR T1,HNTIM,(HN)
  2166	001125'01  201 03 0 00 000036 		MOVEI T2,^D30		;Default host multicast timer (secs)
  2167	001126'01  506 03 0 06 000006 		STOR T2,HNMTI,(HN)
  2168	001127'01  200 02 0 00 000000#		MOVE T1,LASDEF		;Get the default LAT Access State
  2169	001130'01  542 02 0 06 000004 		STOR T1,HNLAS,(HN)	; and store it
  2170	001131'01  306 02 0 00 000000 		CAIN T1,LS.OFF		;If default state is on, start transmitting
  2171	001132'01  254 00 0 00 001134'		IFSKP.			; multicast messages immediately.
  2172					IFN FTOPS20,<
  2173					 	  IMULI T2,^D1000	;Multicast in millisecs
  2174					>;end IFN FTOPS20
  2175	001133'01  202 03 0 00 000000#		  MOVEM T2,LATMCT	;Initialize scheduler long timer word
  2176	001134'01				ENDIF.
  2177	001134'01  201 02 0 00 000024 		MOVEI T1,MAXCIR		;Default maximum allocatable circuit blocks
  2178	001135'01  506 02 0 06 000001 		STOR T1,HNMXC,(HN)
  2179						;...
  2180
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 43
LATSER	MAC	19-Aug-74 07:34		LATINI - LAT Initialization

  2181
  2182
  2183						;...
  2184	001136'01  506 02 0 06 000002 		STOR T1,HNMAC,(HN)	;And max active circuits
  2185	001137'01  201 02 0 00 000255 		MOVEI T1,CBMAXI		;Get a random number in the range or 1 to
  2186	001140'01  260 01 0 00 004370'		CALL RANDOM		; maximum value of circuit block index
  2187	001141'01  506 02 0 06 000022 		STOR T1,HNNXI,(HN)	;Store as next CB index to assign	
  2188	001142'01  201 02 0 00 001071*		MOVEI T1,NTTLAH		;Default max number of simultaneous connects
  2189	001143'01  506 02 0 06 000003 		STOR T1,HNMCO,(HN)
  2190	001144'01  201 02 0 00 000040 		MOVEI T1,^D32		;Number of access code bytes
  2191	001145'01  202 02 0 06 000652 		STOR T1,ACLNG,(HN)
  2192	001146'01  205 02 0 00 002000 		MOVSI T1,(1B7)		;Set group 0 on
  2193	001147'01  202 02 0 06 000653 		MOVEM T1,AC.COD(HN)	;Store as first byte of access codes
  2194	001150'01  201 02 0 00 000001 		MOVEI T1,1
  2195	001151'01  542 02 0 06 000022 		STOR T1,HNNSV,(HN)	;Default number of host services offered
  2196	001152'01  415 05 0 06 000422 		XMOVEI T4,HN.SRV(HN)	;Address of the host service blocks
  2197	001153'01  202 02 0 05 000000 		STOR T1,GBRAT,(T4)
  2198	001154'01  200 02 0 00 000000#		MOVE T1,OURCNT		;Default service name is node name so
  2199	001155'01  506 02 0 05 000001 		STOR T1,GBNC,(T4)	; store the count
  2200	001156'01  120 02 0 00 000000#		DMOVE T1,OURNAM		; and the name
  2201	001157'01  124 02 0 05 000002 		DMOVEM T1,GB.NAM(T4)
  2202
  2203					IFN FTOPS10,<
  2204	001160'01  550 02 0 06 000024 		LOAD T1,HNIDC,(HN)	;get Host node id count
  2205	001161'01  303 02 0 00 000100 		CAILE T1,ML.SID
  2206	001162'01  201 02 0 00 000100 		MOVEI T1,ML.SID		;Don't exceed what's allowed in this field
  2207	001163'01  542 02 0 05 000001 		STOR T1,GBLC,(T4)	;SAVE it
  2208	001164'01  231 02 0 00 000005 		IDIVI T1,5		;Convert to word count
  2209	001165'01  332 00 0 00 000003 		SKIPE T2		;if not an even multiple of 5
  2210	001166'01  271 02 0 00 000001 		ADDI T1,1		;Round up
  2211	001167'01  415 03 0 06 000027 		XMOVEI T2,HN.ID(HN)	;Get address of host descriptor
  2212	001170'01  415 04 0 05 000006 		XMOVEI T3,GB.HID(T4)	;And address of service descriptor
  2213	001171'01  123 02 0 00 004567'		XBLT. T1		;make service descriptor the same as host
  2214					>;END IFN FTOPS10
  2215
  2216	001172'01  415 07 0 06 000123 		XMOVEI XB,HN.MCM(HN)	;Address of the multicast message block
  2217	001173'01  200 02 0 00 004717'		MOVE T1,[BYTE (8)11,0,53,0,(4)0];Store multicast address
  2218	001174'01  200 03 0 00 004721'		MOVE T2,[BYTE (8)0,17,0,0]; ...
  2219	001175'01  124 02 0 07 000012 		OPSTRM <DMOVEM T1,>,UNDAD,+UNB.OF(XB);09-00-2B-00-00-0F
  2220	001176'01  474 02 0 00 000000 		SETO T1,0		;Use random number for incarnation count
  2221	001177'01  260 01 0 00 001375'		CALL BMCFXD		;Build the first (fixed) ^D12 bytes
  2222	001200'01  260 01 0 00 001435'		CALL BMCACS		;Enter the host access code string (fixed)
  2223	001201'01  260 01 0 00 001443'		CALL BMCNID		;Enter the host node name and description
  2224	001202'01  260 01 0 00 001454'		CALL BMCSRV		;Build the services
  2225	001203'01  476 00 0 06 000023 		SETONE HNLOK,(HN)	;Initialize database lock
  2226	001204'01  202 07 0 07 000004 		STOR XB,UNRID,+UNB.OF(XB);Store for xmit complete processing
  2227	001205'01  260 01 0 00 001535'		CALL BLDSTM		;Now build the START message template
  2228	001206'01  205 02 0 00 000000#		MOVSI T1,-NSBWDS	;Initialize free slot block words to
  2229	001207'01  476 00 0 02 000000*	INISBN:	SETOM NFRSBQ(T1)	; all slots free (all bits 1's)
  2230	001210'01  253 02 0 00 001207'		AOBJN T1,INISBN		; ...
  2231						;...
  2232
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 44
LATSER	MAC	19-Aug-74 07:34		LATINI - LAT Initialization

  2233
  2234
  2235						;...
  2236	001211'01  205 17 0 00 070000 		SETZRO UNCHN,+UNB.OF(XB);For now, later must read channel list
  2237	001212'01  412 17 0 07 000011 
  2238	001213'01  205 17 0 00 400000 		SETZRO UNPAD,+UNB.OF(XB);We use padding
  2239	001214'01  412 17 0 07 000011 
  2240	001215'01  201 02 0 00 060004 		MOVEI T1,^B0110000000000100;Protocol ID is 60-04
  2241	001216'01  542 02 0 07 000011 		STOR T1,UNPRO,+UNB.OF(XB);
  2242	001217'01  415 02 0 00 001604'		XMOVEI T1,LATCBR	;Callback routine address
  2243	001220'01  202 02 0 07 000010 		STOR T1,UNCBA,+UNB.OF(XB)
  2244	001221'01  201 02 0 00 000001 		MOVX T1,NU.OPN		;NISRV Open function
  2245	001222'01  415 03 0 07 000002 		XMOVEI T2,UNB.OF(XB)	;Use this for open as well
  2246	001223'01  260 01 0 00 000000*		CALL DLLUNI
  2247	001224'01  254 00 0 00 001235'		IFSKP.
  2248	001225'01  200 02 0 07 000002 		  LOAD T1,UNPID,+UNB.OF(XB);Get the PID return from the DLL
  2249	001226'01  202 02 0 06 000021 		  STOR T1,HNPID,(HN); and store for later calls to the DLL.
  2250	001227'01  331 00 0 07 000005 		  SKIPL UN.STA+UNB.OF(XB) ;Is returned state "running" ?
  2251	001230'01  254 00 0 00 001235'		  IFSKP.
  2252	001231'01  205 17 0 00 400000 		    SETZRO HNRUN,(HN)		;Yes, clear our flag (mark NI running)
  2253	001232'01  412 17 0 06 000000 
  2254	001233'01  260 01 0 00 004266'		    CALL GETRBF			;Get a buffer for receives
  2255	001234'01  600 00 0 00 000000 		     TRN			;Will have to get buffers later
  2256	001235'01				  ENDIF.
  2257	001235'01				ENDIF.
  2258	001235'01  263 01 0 00 000000 		RET
  2259
  2260	001236'01			INIRES:	
  2261	001236'01  256 00 0 00 004722'		BUG. (CHK,LATINE,LATSER,SOFT,<LATINI failed to initialize>,,<>)
  2262	001237'01  332 02 0 00 001064*		SKIPE T1,LAHNDB		;Start with a clean slate when we try
  2263	001240'01  260 01 0 00 004501'		CALL MMFREE		; to initialize later...
  2264	001241'01  332 02 0 00 000000#		SKIPE T1,CBVECT		; ...
  2265	001242'01  260 01 0 00 004501'		CALL MMFREE		; ...
  2266	001243'01  332 02 0 00 000000#		SKIPE T1,SBVECT		; ...
  2267	001244'01  260 01 0 00 004501'		CALL MMFREE		; ...
  2268	001245'01  263 01 0 00 000000 		RET
  2269
  2270						ENDAV.
  2271
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 45
LATSER	MAC	19-Aug-74 07:34		Subroutine -- CWHLAT - Type a server spec for WHERE command

  2272						SUBTTL	Subroutine -- CWHLAT - Type a server spec for WHERE command
  2273
  2274					;CWHLAT - Types a server spec given a LATSER-owned LDB.
  2275					;
  2276					; Call:
  2277					;	U/ Target LDB address
  2278					;	0(P)/ Command LDB address
  2279					;
  2280					; Return:
  2281					;	RET			;If success
  2282					;	via CWHNCN		;If line is not owned by LATSER
  2283					;
  2284					; Used: T1-T4
  2285
  2286					IFN FTOPS10,<
  2287	001246'01  262 01 0 00 000002 	CWHLAT::POP	P,T1		;Can't call SE1ENT with junk on stack!
  2288	001247'01  260 01 0 00 001054*		SE1ENT			;So we can access NZS data
  2289	001250'01  261 01 0 00 000002 		PUSH	P,T1		;RE-save LDB of command term
  2290	001251'01  336 02 0 10 000074*		SKIPN	T1,LDBLAT##(U)	;Get slot block associated with target TTY
  2291	001252'01  254 00 0 00 000000*		  PJRST	CWHNCN##	;Not connected now.
  2292	001253'01  262 01 0 00 000010 		POP	P,U		;Point to command terminal for typeout
  2293	001254'01  261 01 0 16 000000 		PUSH	P,DEVNAM(F)	;Save TTY name
  2294	001255'01  261 01 0 02 000025 		PUSH	P,SB.CBA(T1)	; and Circuit Block address.
  2295	001256'01  260 01 0 00 000000*		CALL	TTYKLQ##	;ZAP useless TTY DDB
  2296	001257'01  260 01 0 00 000000*		CALL	INLMES##	;Type out an intro
  2297	001260'01  114 101 124 011 000 		  ASCIZ	/LAT	/		; guess what!
  2298	001261'01  200 03 0 01 000000 		MOVE	T2,(P)		;Get LAT circuit block address
  2299	001262'01  550 02 0 03 000025 		LOAD	T1,CBRSC,(T2)	;Get server name count from it
  2300	001263'01  270 03 0 00 004725'		ADD	T2,[OWGP. 7,CB.SNM]	;Make byte pointer to name
  2301	001264'01  260 01 0 00 001300'		CALL	TCSTR		;Type a counted string
  2302	001265'01  201 04 0 00 000050 		MOVEI	T3,"("		;Separate it
  2303	001266'01  260 01 0 00 000000*		CALL	COMTYO##	; from location
  2304	001267'01  262 01 0 00 000003 		POP	P,T2		;Get CB address for last time
  2305	001270'01  554 02 0 03 000026 		LOAD	T1,CBRLC,(T2)	;Get server location count from it
  2306	001271'01  270 03 0 00 004726'		ADD	T2,[OWGP. 7,CB.LOC]	;Make byte pointer to location
  2307	001272'01  260 01 0 00 001300'		CALL	TCSTR		;Type a counted string
  2308	001273'01  260 01 0 00 001257*		CALL	INLMES##	;Close it off
  2309	001274'01  051 040 000 000 000 		  ASCIZ	/) /		;and separate it.
  2310	001275'01  262 01 0 00 000003 		POP	P,T2		;Get TTY name
  2311	001276'01  260 01 0 00 000000*		CALL	PRNAME##	; and type it.
  2312	001277'01  254 00 0 00 000000*		PJRST	PCRLF##		;and return
  2313
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 46
LATSER	MAC	19-Aug-74 07:34		Subroutine -- CWHLAT - Type a server spec for WHERE command

  2314					;
  2315					; Routine TCSTR - type a counted ASCII string
  2316					;
  2317					;Call:	T1/ byte count
  2318					;	T2/ byte pointer
  2319					;
  2320	001300'01  361 02 0 00 000000*	TCSTR:	SOJL	T1,CPOPJ##	;No chars to type
  2321	001301'01  261 01 0 00 000002 		PUSH	P,T1		;save the count in a safe place
  2322	001302'01  134 04 0 00 000003 	TCST1:	ILDB	T3,T2		;Get a character
  2323	001303'01  260 01 0 00 001266*		CALL	COMTYO##	; and type it
  2324	001304'01  371 00 0 01 000000 		SOSL	(P)		;Count them down
  2325	001305'01  254 00 0 00 001302'		JRST	TCST1		; and do them all
  2326	001306'01  262 01 0 00 000002 		POP	P,T1		;trim the stack
  2327	001307'01  263 01 0 00 000000 		RET			; and return
  2328					> ;end IFN FTOPS10
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 47
LATSER	MAC	19-Aug-74 07:34		Once a second code (TOPS10)

  2329						SUBTTL Once a second code (TOPS10)
  2330
  2331					IFN FTOPS10,<
  2332	001310'01			LATSEC::
  2333					IFN FTMP,<
  2334	001310'01  256 00 0 00 000000*		XCT .CPSK0		;SKIP IF WE'RE ON POLICY CPU
  2335	001311'01  263 01 0 00 000000 		RET			;NO, ONLY RUN ONCE A SECOND!
  2336					>
  2337	001312'01  333 00 0 00 000000#		SKIPLE LATMCT		;IS the timer non-zero?
  2338	001313'01  373 00 0 00 000000#		SOSLE LATMCT		;Count down the timer
  2339	001314'01  263 01 0 00 000000 		  RET			;Not time to do anything yet
  2340					;	CALLRET	LATXMC		;Fall into multicast transmit code
  2341					>;end IFN FTOPS10
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 48
LATSER	MAC	19-Aug-74 07:34		Multicast Transmitter

  2342						SUBTTL Multicast Transmitter
  2343
  2344					;
  2345					;LATXMC	- Transmit Multicast Message
  2346					;
  2347					;CALL:	CALL LATXMC
  2348					;	Normal Return
  2349	001315'01			LATXMC::
  2350	001315'01  260 01 0 00 001247*		SE1ENT
  2351	001316'01  265 17 0 00 004703'		ACVAR <HN,XB,W1,W2>
  2352	001317'01  336 06 0 00 001237*		SKIPN HN,LAHNDB		;Get the address of the HN data base
  2353	001320'01  263 01 0 00 000000 		RET			;LAT initialize not done yet.
  2354	001321'01  554 02 0 06 000006 		LOAD T1,HNMTI,(HN)	;Reset the
  2355					IFN FTOPS20,<
  2356						IMULI T1,^D1000		; multicast
  2357					>;end IFN FTOPS20
  2358	001322'01  202 02 0 00 000000#		MOVEM T1,LATMCT		; timer
  2359	001323'01  335 00 0 06 000000 		SKIPGE HN.RUN(HN)	;is the NI running?
  2360	001324'01  263 01 0 00 000000 		  RET			;No, go no further.
  2361	001325'01  260 01 0 00 004266'		CALL GETRBF		;Get another buffer if we need one
  2362	001326'01  600 00 0 00 000000 		 NOP			;Oh well!
  2363	001327'01  415 07 0 06 000123 		XMOVEI XB,HN.MCM(HN)	;Get the address of the multicast msg
  2364	001330'01  135 17 0 00 004727'		OPSTR <SKIPE W1,>,HNCFL,(HN);If nothing changed in HN database
  2365	001331'01  332 11 0 00 000017 
  2366	001332'01  331 00 0 06 000023 		OPSTR <SKIPL>,HNLOK,(HN); or something changed by db id locked
  2367	001333'01  254 00 0 00 001363'		JRST SNDMNC		; then send the old image of mc msg
  2368	001334'01  302 11 0 00 000010 		CAIE W1,HN%SVR		;Did only the ratings change?
  2369	001335'01  254 00 0 00 001340'		JRST LATXM0		;No, something else changed
  2370	001336'01  260 01 0 00 001511'		CALL BMCRAT		;Go update the ratings
  2371	001337'01  254 00 0 00 001352'		JRST LATXM2		; and send the mc msg
  2372	001340'01  400 02 0 00 000000 	LATXM0:	SETZ T1,0		;So BMCFXD will increment incarnation count
  2373	001341'01  602 11 0 00 000200 		TRNE W1,HN%OTH		;Did something in fixed part of mc change?
  2374	001342'01  260 01 0 00 001375'		CALL BMCFXD		;Yes, go rebuild fixed part of mc msg
  2375	001343'01  602 11 0 00 000001 		TRNE W1,HN%ACS		;Did any access codes change?
  2376	001344'01  260 01 0 00 001435'		CALL BMCACS		;Yes, go rebuild access code field
  2377	001345'01  602 11 0 00 000002 		TRNE W1,HN%NDD		;Did the host node description change?
  2378	001346'01  260 01 0 00 001443'		CALL BMCNID		;Rebuild the node description
  2379	001347'01  606 11 0 00 000002 		TRNN W1,HN%NDD		; and the service fields
  2380	001350'01  602 11 0 00 000034 	LATXM1:	TRNE W1,HN%SVN!HN%SVD!HN%SVR;Did anything in any service change?
  2381	001351'01  260 01 0 00 001454'		CALL BMCSRV		;Yes, reconstruct all service fields
  2382	001352'01  201 17 0 00 000377 	LATXM2:	SETZRO HNCFL,(HN)	;Clear data base change flags
  2383	001353'01  412 17 0 06 000000 
  2384	001354'01  200 02 0 00 004730'	SENDMC:	MOVX T1,<POINT 8,<SBF.OF+1>(XB),23>;Pointer msg change flags
  2385	001355'01  135 03 0 00 000002 		LDB T2,T1		;Message incarnation field
  2386	001356'01  350 00 0 00 000003 		AOS T2			;Add one
  2387	001357'01  137 03 0 00 000002 		DPB T2,T1		; and put back into msg
  2388	001360'01  134 03 0 00 000002 		ILDB T2,T1		;Load current change flag settings from msg
  2389	001361'01  650 03 0 00 000011 		TDC T2,W1		;Complement those bits which represent change
  2390	001362'01  137 03 0 00 000002 		DPB T2,T1		; and put back into msg
  2391	001363'01  415 02 0 07 000025 	SNDMNC:	XMOVEI T1,<SBF.OF>(XB) ;Set up one word global to buffer for
  2392	001364'01  661 02 0 00 540000 		TLO T1,(<OWGP. 8,0>)		; NISRV and
  2393	001365'01  202 02 0 07 000017 		STOR T1,UNBFA,+UNB.OF(XB); store in UN block
  2394	001366'01  200 02 0 06 000021 		LOAD T1,HNPID,(HN)	;Get the PID for the DLL
  2395	001367'01  202 02 0 07 000002 		STOR T1,UNPID,+UNB.OF(XB)
  2396	001370'01  201 02 0 00 000004 		MOVX T1,NU.XMT		;Set NI function to transmit
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 48-1
LATSER	MAC	19-Aug-74 07:34		Multicast Transmitter

  2397	001371'01  415 03 0 07 000002 		XMOVEI T2,UNB.OF(XB)	;Address of arguement block for NISRV
  2398	001372'01  260 01 0 00 001223*		CALL DLLUNI		;Call NI service
  2399	001373'01  600 00 0 00 000000 		 TRN			;Ignore error
  2400	001374'01  263 01 0 00 000000 		RET			;Return
  2401
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 49
LATSER	MAC	19-Aug-74 07:34		Routines to Build the Host Multicast Message - BMCFXD

  2402						SUBTTL	Routines to Build the Host Multicast Message - BMCFXD
  2403
  2404					;
  2405					;BMCFXD - Build fixed portion of the multicast message
  2406					;
  2407					;Call:	T1/ Incarnaction count flag
  2408					;	HN/ Host Node Data Base Address
  2409					;	XB/ Address of the multicast message block in HN
  2410					;	CALL BMCFXD
  2411					;
  2412					; This routine builds the first ^D12 bytes of the multicast message.  It is
  2413					; called either to build a new message or to update the fixed portion if any
  2414					; of the parameters in the fixed portion have changed since the last multicast
  2415					; message was transmitted.  This routine does not modify the message count.
  2416
  2417	001375'01  265 17 0 00 001020*	BMCFXD:	STKVAR <INCFLG>		;Save the incarnaction
  2418	001376'01  000000  000001
  2419	001377'01  202 02 0 01 777776 		MOVEM T1,INCFLG		; flag.
  2420	001400'01  200 02 0 00 004731'		MOVX T1,<POINT 8,<SBF.OF>(XB)> ;Byte pointer to start of msg
  2421	001401'01  202 02 0 07 000017 		STOR T1,UNBFA,+UNB.OF(XB); is needed to fill in the msg header
  2422	001402'01  201 02 0 00 000050 		MOVEI T1,MT.MCA_2	;Message type for multicast message
  2423	001403'01  136 02 0 07 000017 		OPSTRM <IDPB T1,>,UNBFA,+UNB.OF(XB)	
  2424	001404'01  201 02 0 00 000010 		MOVEI T1,^D8		;Set 80ms preferred server circuit timer
  2425	001405'01  136 02 0 07 000017 		OPSTRM <IDPB T1,>,UNBFA,+UNB.OF(XB)
  2426	001406'01  201 02 0 00 002405 		MOVEI T1,LALPV_^D8+LAHPV;Highest and lowest permitted protocol version
  2427	001407'01  260 01 0 00 002777'		CALL LAP2B0
  2428	001410'01  201 02 0 00 000005 		MOVEI T1,PROECO_^D8+PROVER ;Enter current protocol version and ECO
  2429	001411'01  260 01 0 00 002777'		CALL LAP2B0
  2430	001412'01  134 02 0 07 000017 		OPSTR <ILDB T1,>,UNBFA,+UNB.OF(XB);Get old incarnation count and assume
  2431	001413'01  350 00 0 00 000002 		AOS T1			; we just want to increment it.
  2432	001414'01  336 00 0 01 777776 		SKIPN INCFLG		;If this is initialization, we want a "random"
  2433	001415'01  254 00 0 00 001420'		IFSKP.			; incarnation count instead.
  2434	001416'01  201 02 0 00 000377 		  MOVEI T1,^D255	;Maximum value incarnation count can have.
  2435	001417'01  260 01 0 00 004370'		  CALL RANDOM		; the initial message incarnation count.
  2436	001420'01				ENDIF.
  2437	001420'01  137 02 0 07 000017 		OPSTRM <DPB T1,>,UNBFA,+UNB.OF(XB); and put back
  2438	001421'01  135 02 0 00 004727'		LOAD T1,HNCFL,(HN)	;Get the change flags
  2439	001422'01  136 02 0 07 000017 		OPSTRM <IDPB T1,>,UNBFA,+UNB.OF(XB)
  2440	001423'01  201 02 0 00 002756 		MOVEI T1,LMRFSI+^D14	;Receive buffer size (including E-net header)
  2441	001424'01  260 01 0 00 002777'		CALL LAP2B0
  2442	001425'01  554 02 0 06 000006 		LOAD T1,HNMTI,(HN)	;Get the multicast timer interval
  2443	001426'01  136 02 0 07 000017 		OPSTRM <IDPB T1,>,UNBFA,+UNB.OF(XB)
  2444	001427'01  201 02 0 00 000000 		MOVEI T1,0		;Set status indicating accepting new sessions.
  2445	001430'01  550 03 0 06 000004 		LOAD T2,HNLAS,(HN)	;Get the current LAT access state
  2446	001431'01  302 03 0 00 000001 		CAIE T2,LS.ON		;Is it on?
  2447	001432'01  201 02 0 00 000001 		MOVEI T1,1		;No, indicate not accepting new sessions.
  2448	001433'01  136 02 0 07 000017 		OPSTRM <IDPB T1,>,UNBFA,+UNB.OF(XB)
  2449	001434'01  263 01 0 00 000000 		RET
  2450
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 50
LATSER	MAC	19-Aug-74 07:34		Routines to Build the Host Multicast Message - BMCFXD

  2451						SUBTTL	Routines to Build the Host Multicast Message - BMCFXD
  2452
  2453					;
  2454					;BMCACS - Enter Access Codes into the Multicast Message - BMCACS
  2455					;
  2456					;Call:	HN/ Host Node Data Base Address
  2457					;	XB/ Address of the multicast message block in HN
  2458					;	CALL BMCACS
  2459					;	Normal Return
  2460					;
  2461					; This routine builds ^D32 bytes of host access codes.  It is called either to
  2462					; build a new message or to update the fixed length access code field if any of
  2463					; the access codes have changed since the last multicast message was
  2464					; transmitted.  This routine does not modify the message count.
  2465
  2466	001435'01			BMCACS:
  2467	001435'01  200 02 0 00 004732'		MOVX T1,<POINT 8,<SBF.OF+^D12/4>(XB)> ;ACs start at a fixed location
  2468	001436'01  202 02 0 07 000017 		STOR T1,UNBFA,+UNB.OF(XB);Store as byte pointer to message buffer
  2469	001437'01  200 02 0 06 000652 		LOAD T1,ACLNG,(HN)	;Count of the access code string
  2470	001440'01  200 03 0 00 004733'		MOVX T2,<POINT 8,AC.COD(HN)> ;Source string byte pointer
  2471	001441'01  260 01 0 00 003006'		CALL PTCST0		;Transfer the string to the message
  2472	001442'01  263 01 0 00 000000 		RET
  2473
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 51
LATSER	MAC	19-Aug-74 07:34		Routines to Build the Host Multicast Message - BMCNID

  2474						SUBTTL	Routines to Build the Host Multicast Message - BMCNID
  2475
  2476					;
  2477					;BMCNID - Enter Access Codes into the Multicast Message - BMCNID
  2478					;
  2479					;Call:	HN/ Host Node Data Base Address
  2480					;	XB/ Address of the multicast message block in HN
  2481					;	CALL BMCNID
  2482					;	Normal Return
  2483					;
  2484					; This routine enters the host node name and descriptor strings into the 
  2485					; multicast message block.  It is called either to build a new message or to
  2486					; update the fixed length access code field if the node name or descriptor 
  2487					; has changed since the last multicast message was transmitted.  If this
  2488					; routine is called, the rest of the multicast message must be rebuilt.  This
  2489					; routine does not modify the message count.
  2490
  2491	001443'01			BMCNID:
  2492	001443'01  200 02 0 00 004734'		MOVX T1,<POINT 8,<SBF.OF+^D12/4+^D32/4>(XB),7> ;Node name starts here
  2493	001444'01  202 02 0 07 000017 		STOR T1,UNBFA,+UNB.OF(XB);Store as byte pointer to message buffer
  2494	001445'01  554 02 0 06 000024 		LOAD T1,HNNMC,(HN)	;Host name count
  2495	001446'01  200 03 0 00 004735'		MOVX T2,<POINT 7,HN.NAM(HN)> ;Source string byte pointer
  2496	001447'01  260 01 0 00 003006'		CALL PTCST0		;Transfer the host node name to m.c.msg
  2497	001450'01  550 02 0 06 000024 		LOAD T1,HNIDC,(HN)	;Count of host node description string
  2498	001451'01  200 03 0 00 004716'		MOVX T2,<POINT 7,HN.ID(HN)> ;Move the host node id string to the
  2499	001452'01  260 01 0 00 003006'		CALL PTCST0		; m.c. message
  2500	001453'01  263 01 0 00 000000 		RET
  2501
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 52
LATSER	MAC	19-Aug-74 07:34		Routines to Build the Host Multicast Message - BMCSRV

  2502						SUBTTL	Routines to Build the Host Multicast Message - BMCSRV
  2503
  2504					;
  2505					;BMCSRV - Build the Available Host Services Data - BMCSRV
  2506					;
  2507					;Call:	HN/ Host Node Data Base Address
  2508					;	XB/ Address of the multicast message block in HN
  2509					;	CALL BMCSRV
  2510					;	Normal Return
  2511					;
  2512					; This routine enters all service blocks and the service classes into the
  2513					; multicast message block.  It is called either to build a new message or to
  2514					; update the message when any service name or description has changed since
  2515					; the last multicast message was transmitted.  This routine does modify the
  2516					; message count.
  2517
  2518	001454'01  265 17 0 00 004634'	BMCSRV:	SAVEAC <W1,W2>
  2519	001455'01  201 05 0 00 000056 		MOVEI T4,^D12+^D33+1	;Initialize msg count
  2520	001456'01  200 04 0 00 004734'		MOVX T3,<POINT 8,<SBF.OF+^D12/4+^D32/4>(XB),7>;Get pointer to node name
  2521	001457'01  134 02 0 00 000004 		ILDB T1,T3		;Get node name count
  2522	001460'01  271 05 0 02 000001 		ADDI T4,1(T1)		;Include in total msg count
  2523	001461'01  133 02 0 00 000004 		ADJBP T1,T3		;Adjust to node descriptor
  2524	001462'01  134 04 0 00 000002 		ILDB T3,T1		;Get the node description count
  2525	001463'01  271 05 0 04 000001 		ADDI T4,1(T3)		;Include in total msg count
  2526	001464'01  133 04 0 00 000002 		ADJBP T3,T1		;Adjust pointer to start of Service Block
  2527	001465'01  202 05 0 07 000016 		STOR T4,UNBSZ,+UNB.OF(XB);Store msg count so far
  2528	001466'01  202 04 0 07 000017 		STOR T3,UNBFA,+UNB.OF(XB);Current message byte pointer
  2529	001467'01  550 11 0 06 000022 		LOAD W1,HNNSV,(HN)	;Get the total number of offered services
  2530	001470'01  136 11 0 07 000017 		OPSTRM <IDPB W1,>,UNBFA,+UNB.OF(XB);Already counted
  2531	001471'01  415 12 0 06 000422 		XMOVEI W2,HN.SRV(HN)	;Address of start of service blocks
  2532	001472'01  335 02 0 12 000000 	SRVLP:	OPSTR <SKIPGE T1,>,GBRAT,(W2) ;Get the service rating
  2533	001473'01  260 01 0 00 004377'		CALL DYNRAT		;If negative, get the dynamic rating
  2534	001474'01  350 00 0 07 000016 		OPSTRM <AOS>,UNBSZ,+UNB.OF(XB);Account for rating in the byte count
  2535	001475'01  136 02 0 07 000017 		OPSTRM <IDPB T1,>,UNBFA,+UNB.OF(XB);Store in mc msg
  2536	001476'01  554 02 0 12 000001 		LOAD T1,GBNC,(W2)	;Get the service name count
  2537	001477'01  200 03 0 00 004736'		MOVX T2,<POINT 7,GB.NAM(W2)> ;Pointer to service name
  2538	001500'01  260 01 0 00 003004'		CALL PTCSTR		;Move name string to mc msg
  2539	001501'01  550 02 0 12 000001 		LOAD T1,GBLC,(W2)	;Get the service description count
  2540	001502'01  200 03 0 00 004737'		MOVX T2,<POINT 7,GB.HID(W2)>;Pointer to the service description string
  2541	001503'01  260 01 0 00 003004'		CALL PTCSTR		;Move to mc msg
  2542	001504'01  271 12 0 00 000023 		ADDI W2,GB.LEN		;Address of next block
  2543	001505'01  366 11 0 00 001472'		SOJN W1,SRVLP		;Loop through all services
  2544	001506'01  201 02 0 00 000401 		MOVEI T1,1_^D8+1	;Service class 1 only
  2545	001507'01  260 01 0 00 002775'		CALL LAP2BY
  2546	001510'01  263 01 0 00 000000 		RET
  2547
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 53
LATSER	MAC	19-Aug-74 07:34		Routines to Build the Host Multicast Message - BMCRAT

  2548						SUBTTL	Routines to Build the Host Multicast Message - BMCRAT
  2549
  2550					;
  2551					;BMCRAT - Build the Available Host Services Data - BMCRAT
  2552					;
  2553					;Call:	HN/ Host Node Data Base Address
  2554					;	XB/ Address of the multicast message block in HN
  2555					;	CALL BMCRAT
  2556					;	Normal Return
  2557					;
  2558					; This routine enters all service blocks and the service classes into the
  2559					; multicast message block.  It is called either to build a new message or to
  2560					; update the message when any service name or description has changed since
  2561					; the last multicast message was transmitted.  This routine does modify the
  2562					; message count.
  2563
  2564	001511'01  265 17 0 00 004634'	BMCRAT:	SAVEAC <W1,W2>
  2565	001512'01  200 04 0 00 004734'		MOVX T3,<POINT 8,<SBF.OF+^D12/4+^D32/4>(XB),7>;Get pointer to node name
  2566	001513'01  134 02 0 00 000004 		ILDB T1,T3		;Get node name count
  2567	001514'01  133 02 0 00 000004 		ADJBP T1,T3		;Adjust to node descriptor
  2568	001515'01  134 04 0 00 000002 		ILDB T3,T1		;Get the node description count
  2569	001516'01  133 04 0 00 000002 		ADJBP T3,T1		;Adjust pointer to start of Service Block
  2570	001517'01  134 11 0 00 000004 		ILDB W1,T3		;Get number of services from msg
  2571	001520'01  415 12 0 06 000422 		XMOVEI W2,HN.SRV(HN)	;Address of start of service blocks
  2572	001521'01  335 02 0 12 000000 	RATLP:	OPSTR <SKIPGE T1,>,GBRAT,(W2) ;Get the service rating
  2573	001522'01  260 01 0 00 004377'		CALL DYNRAT		;If negative, get the dynamic rating
  2574	001523'01  136 02 0 00 000004 		IDPB T1,T3		;Store updated rating in mc msg
  2575	001524'01  554 02 0 12 000001 		LOAD T1,GBNC,(W2)	;Get the service name count
  2576	001525'01  550 17 0 12 000001 		OPSTR <ADD T1,>,GBLC,(W2);Add the service description count
  2577	001526'01  270 02 0 00 000017 
  2578	001527'01  271 02 0 00 000002 		ADDI T1,2		;Account for the 2 count fields
  2579	001530'01  133 02 0 00 000004 		ADJBP T1,T3		;Adjust the pointer
  2580	001531'01  200 04 0 00 000002 		MOVE T3,T1		;Put adjusted pointer back where we want it
  2581	001532'01  271 12 0 00 000023 		ADDI W2,GB.LEN		;Address of next block
  2582	001533'01  366 11 0 00 001521'		SOJN W1,RATLP		;Loop through all services
  2583	001534'01  263 01 0 00 000000 		RET
  2584
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 54
LATSER	MAC	19-Aug-74 07:34		

  2585						SUBTTL
  2586
  2587					;BLDSTM - Build the START Message Template
  2588					;
  2589					;Call:	HN/ Address of the Host Node Data Base
  2590					;	CALL BLDSTM
  2591					;	Normal Return
  2592					;
  2593					; This routine builds the "static" portions of the start message:  those
  2594					; fields which do not change very frequently. Fields which change frequently
  2595					; are set up by the transmitting routines.  This routine also sets up the
  2596					; message size in UNBSZ of the NISRV UN block.
  2597
  2598	001535'01  265 17 0 00 004574'	BLDSTM:	SAVEAC <W1>
  2599	001536'01  415 07 0 06 000044 		XMOVEI XB,HN.SMT(HN)	;Address of START message template
  2600	001537'01  200 02 0 00 004740'		MOVX T1,<POINT 8,<SBF.OF+<SZ.MHD>/4>(XB)>;Point beyond the msg header
  2601	001540'01  202 02 0 07 000017 		STOR T1,UNBFA,+UNB.OF(XB); since it will change with each transmission.
  2602	001541'01  201 11 0 00 000024 		MOVEI W1,^D20		;Count of fixed fields (including count fields)
  2603	001542'01  201 02 0 00 002756 		MOVEI T1,LMRFSI+^D14	;Minimum receive buffer size
  2604	001543'01  260 01 0 00 002777'		CALL LAP2B0		;Store in msg
  2605	001544'01  201 02 0 00 000005 		MOVEI T1,PROECO_^D8+PROVER ;Enter current LAT protocol version
  2606	001545'01  260 01 0 00 002777'		CALL LAP2B0		; and ECO
  2607	001546'01  554 02 0 06 000003 		LOAD T1,HNMCO,(HN)	;System-wid maximum LAT connects allowed
  2608	001547'01  303 02 0 00 000100 		CAILE T1,MXSLTS		; compared to max slots per virtual circuit
  2609	001550'01  201 02 0 00 000100 		MOVEI T1,MXSLTS		;Get the smaller of the two
  2610	001551'01  260 01 0 00 002777'		CALL LAP2B0
  2611	001552'01  201 02 0 00 000000 		MOVEI T1,0		;Timers are non-zero when from server
  2612	001553'01  260 01 0 00 002777'		CALL LAP2B0		; only.
  2613	001554'01  554 02 0 06 000004 		LOAD T1,HNNUM,(HN)	;Get the host number
  2614	001555'01  260 01 0 00 002777'		CALL LAP2B0		; and store as 2 bytes in msg
  2615	001556'01  201 02 0 00 000007 		MOVEI T1,LHPRID		;LAT Host product ID is TOPS-20 Host
  2616	001557'01  260 01 0 00 002777'		CALL LAP2B0		; and store as 2 bytes in msg
  2617	001560'01  554 02 0 06 000024 		LOAD T1,HNNMC,(HN)	;Host Node Name count
  2618	001561'01  271 11 0 02 000001 		ADDI W1,1(T1)		;Add to the total message byte count
  2619	001562'01  200 03 0 00 004735'		MOVX T2,<POINT 7,HN.NAM(HN)>;Host node name source string
  2620	001563'01  260 01 0 00 003006'		CALL PTCST0		;Put into start message as NODE NAME
  2621	001564'01  554 02 0 06 000024 		LOAD T1,HNNMC,(HN)	;Host Node Name count
  2622	001565'01  271 11 0 02 000001 		ADDI W1,1(T1)		;Add to the total message byte count
  2623	001566'01  200 03 0 00 004735'		MOVX T2,<POINT 7,HN.NAM(HN)>;Host node name source string
  2624	001567'01  260 01 0 00 003006'		CALL PTCST0		;Put into start message as SYSTEM NAME
  2625	001570'01  550 02 0 06 000024 		LOAD T1,HNIDC,(HN)	;Count of description string
  2626	001571'01  271 11 0 02 000001 		ADDI W1,1(T1)		;Add to the total message byte count
  2627	001572'01  200 03 0 00 004716'		MOVX T2,<POINT 7,HN.ID(HN)>;Description string source pointer
  2628	001573'01  260 01 0 00 003006'		CALL PTCST0		;Put into start message
  2629	001574'01  201 02 0 00 000000 		MOVEI T1,0		;There are no parameters
  2630	001575'01  136 02 0 07 000017 		OPSTRM <IDPB T1,>,UNBFA,+UNB.OF(XB); is zero
  2631	001576'01  271 11 0 00 000001 		ADDI W1,1		;Include in total count
  2632	001577'01  307 11 0 00 000056 		CAIG W1,MINXBF		;Send at least the minimum 
  2633	001600'01  201 11 0 00 000056 		MOVEI W1,MINXBF		; size.
  2634	001601'01  202 11 0 07 000016 		STOR W1,UNBSZ,+UNB.OF(XB);Store message byte count
  2635	001602'01  202 07 0 07 000004 		STOR XB,UNRID,+UNB.OF(XB);Store buffer address for completion routines.
  2636	001603'01  263 01 0 00 000000 		RET
  2637
  2638						ENDAV.
  2639
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 55
LATSER	MAC	19-Aug-74 07:34		LAINTR - LAT DLL Callback Routinea

  2640						SUBTTL	LAINTR - LAT DLL Callback Routinea
  2641
  2642					;LATCBR - dispatch to routine to handle DLL callback
  2643					;
  2644					;Call:	T1/ NU.RCV
  2645					;	T2/UN block address
  2646					;	CALL LATCBR
  2647					;	Normal return
  2648					;
  2649
  2650	001604'01  265 17 0 00 004741'	LATCBR:	ACVAR <HN,XB,RB>	;Reserve some registers
  2651	001605'01  200 06 0 00 001317*		MOVE HN,LAHNDB		;Get the host node data base address
  2652	001606'01  200 05 0 00 000004 		MOVE T4,T3		;Save NISRV's error register
  2653	001607'01  301 02 0 00 000003 		CAIL T1,MINCBF		;Validate the callback function code
  2654	001610'01  307 02 0 00 000012 		CAIG T1,MAXCBF
  2655	001611'01  254 00 1 02 001611'		 CALLRET @CBRDSP-MINCBF(T1);Valid, call the proper routine
  2656						BUG. (CHK,LATICB,LATSER,SOFT,<LATCBR called from NISRV with illegal callback functio
  2657					n code>,<<T1,CODE>>,<
  2658					NISRV has called the LATSER callback routine with an invalid function code.
  2659	001612'01  256 00 0 00 004757'		>)
  2660	001613'01			ILLCBR:	
  2661	001613'01  263 01 0 00 000000 		RET
  2662
  2663		   	   000003		MIN. (MINCBF,<NU.XMT,NU.RCV,NU.RCI,NU.SCA,NU.RCC>) ;Minimum callback function
  2664		   	   000012		MAX. (MAXCBF,<NU.XMT,NU.RCV,NU.RCI,NU.SCA,NU.RCC>) ;Maximum callback function
  2665
  2666					CBRDSP:	REPEAT <MAXCBF-MINCBF+1>,<
  2667	001614'01  400 00 0 00 001613'		IFIW	ILLCBR>
  2668	001615'01  400 00 0 00 001613'
  2669	001616'01  400 00 0 00 001613'
  2670	001617'01  400 00 0 00 001613'
  2671	001620'01  400 00 0 00 001613'
  2672	001621'01  400 00 0 00 001613'
  2673	001622'01  400 00 0 00 001613'
  2674	001623'01  400 00 0 00 001613'				;Catch undefined call-back codes
  2675
  2676	001615'01  400 00 0 00 001641'		LHDSP. (CBRDSP,NU.XMT-MINCBF,LAINTX) ;Datagram transmit complete
  2677	001614'01  400 00 0 00 001624'		LHDSP. (CBRDSP,NU.RCV-MINCBF,LAINTR) ;Datagram received
  2678	001621'01  400 00 0 00 001772'		LHDSP. (CBRDSP,NU.RCI-MINCBF,LATLSC) ;Link state change
  2679	001623'01  400 00 0 00 001613'		LHDSP. (CBRDSP,NU.SCA-MINCBF,ILLCBR) ;Illegal callback, not used by LAT
  2680	001622'01  400 00 0 00 001613'		LHDSP. (CBRDSP,NU.RCC-MINCBF,ILLCBR) ;Illegal callback, not used by LAT
  2681
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 56
LATSER	MAC	19-Aug-74 07:34		LAINTR - Interrupt Level Virtual Circuit Message Receiver

  2682						SUBTTL	LAINTR - Interrupt Level Virtual Circuit Message Receiver
  2683
  2684					;LAINTR - Processes a circuit message at NI interrupt level
  2685					;
  2686					;Call:	T1/ NU.RCV
  2687					;	T2/UN block address
  2688					;	T4/NISRV's T3
  2689					;	CALL LAINTR
  2690					;	Normal return
  2691					;
  2692
  2693	001624'01  200 11 0 03 000002 	LAINTR:	LOAD RB,UNRID,(T2)	;Get address of message block
  2694	001625'01  322 05 0 00 001632'		JUMPE T4,LANTR1	;If error code is 0 proceed
  2695					;
  2696					; Here, there was an error on receive.  Don't wait for tick time
  2697					;  to turn the buffer around.
  2698					;
  2699	001626'01  200 02 0 00 000011 		MOVE T1,RB		;Get address of receive buffer
  2700	001627'01  260 01 0 00 003022'		CALL RBPOSS		;Repost it now (preserving T1-T4)
  2701	001630'01  254 00 0 00 001632'		  JRST LANTR1		;Couldn't re-post. Process it later.
  2702	001631'01  263 01 0 00 000000 		RET			;Buffer re-posted. That's all we need to do.
  2703	001632'01  201 02 0 00 000023 	LANTR1:	MOVEI T1,UN.LEN		;Length of the block to copy
  2704	001633'01  415 04 0 11 000002 		XMOVEI T3,UNB.OF(RB)	;Address of where to copy the UN block
  2705	001634'01  123 02 0 00 004567'		XBLT. T1		;Copy the UN block to buffer header
  2706	001635'01  201 02 0 00 000003 		MOVEI T1,NU.RCV		;Scheduler needs to know buffer type.
  2707	001636'01  200 03 0 00 000011 		MOVE T2,RB		;Address of element to put onto queue
  2708	001637'01  260 01 0 00 001660'		CALL LAINT0		;Do common actions
  2709	001640'01  263 01 0 00 000000 		RET			;And return to NISRV dismissing interrupt
  2710
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 57
LATSER	MAC	19-Aug-74 07:34		LAINTX - Interrupt Level Virtual Circuit Message Receiver

  2711						SUBTTL	LAINTX - Interrupt Level Virtual Circuit Message Receiver
  2712
  2713					;LAINTX - Processes a circuit message at NI interrupt level
  2714					;
  2715					;Call:	T1/ NU.XMT
  2716					;	T2/UN block address
  2717					;	T4/NISRV's T3
  2718					;	CALL LAINTX
  2719					;	Normal return
  2720					;
  2721
  2722	001641'01  200 07 0 03 000002 	LAINTX:	LOAD XB,UNRID,(T2)	;Get the buffer address
  2723	001642'01  200 04 0 07 000012 		LOAD T3,UNDAD,+UNB.OF(XB);Get first 4 bytes (low order) of NI address
  2724	001643'01  603 04 0 00 002000 		TXNE T3,1B7		;Is the multicast bit on?
  2725	001644'01  263 01 0 00 000000 		RET			;Yes, nothing to do
  2726	001645'01  200 04 0 00 004731'		MOVX T3,<POINT 8,<SBF.OF>(XB)>;Point to the msg header
  2727	001646'01  134 03 0 00 000004 		ILDB T2,T3		; and get the message type
  2728	001647'01  242 03 0 00 777776 		LSH T2,-2		;Shift off M and RRF bits
  2729	001650'01  302 03 0 00 000001 		CAIE T2,MT.STA		;If a START message,
  2730	001651'01  254 00 0 00 001655'		IFSKP.			; then release lock on the START message
  2731	001652'01  205 17 0 00 100000 		  SETZRO HNCIP,(HN)	; template and return.
  2732	001653'01  412 17 0 06 000000 
  2733	001654'01  263 01 0 00 000000 		  RET
  2734	001655'01				ENDIF.
  2735	001655'01  200 03 0 00 000007 		MOVE T2,XB
  2736	001656'01  260 01 0 00 001660'		CALL LAINT0		;Do common actions
  2737	001657'01  263 01 0 00 000000 		RET
  2738
  2739					; Routine to perform interrupt level actions common to both receive data and
  2740					; transmit complete.
  2741
  2742	001660'01  202 02 0 03 000010 	LAINT0:	STOR T1,UNCBA,+UNB.OF(T2);Store callback type for scheduler processing
  2743	001661'01  202 05 0 03 000003 		STOR T4,UNSID,+UNB.OF(T2);Save NISRV's error return
  2744	001662'01  260 01 0 00 000000*		ETHLOK			;Interlock queue access
  2745	001663'01  336 04 0 06 000016 		OPSTR <SKIPN T3,>,HNNIQ,+1(HN);Is the Q currently empty?
  2746	001664'01  254 00 0 00 001670'		IFSKP.			;NO
  2747	001665'01  202 03 0 04 000001 		  STOR T2,UELW1,(T3)	;New forward for old Q tail element
  2748	001666'01  402 00 0 03 000001 		  SETZRO UELW1,(T2)	;New tail's forward link is zero.
  2749	001667'01  254 00 0 00 001671'		ELSE.			;YES
  2750	001670'01  202 03 0 06 000015 		  STOR T2,HNNIQ,(HN)	;New queue header forward pointer
  2751	001671'01				ENDIF.
  2752	001671'01  202 03 0 06 000016 		STOR T2,HNNIQ,+1(HN)	;New queue header tail pointer
  2753	001672'01  260 01 0 00 000000*		ETHULK			;Release interlock
  2754	001673'01  263 01 0 00 000000 		RET
  2755
  2756						ENDAV.
  2757
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 58
LATSER	MAC	19-Aug-74 07:34		LARSCH - Scheduler Level Virtual Circuit Message Receiver

  2758						SUBTTL LARSCH - Scheduler Level Virtual Circuit Message Receiver
  2759
  2760					;LARSCH - Complete circuit message processing at scheduler level
  2761
  2762	001674'01			LARSCH::
  2763					IFN FTOPS10,<
  2764	001674'01			LATSTO::
  2765
  2766					IFN FTMP,<
  2767	001674'01  256 00 0 00 001310*		XCT .CPSK0		;SKIP IF WE'RE ON POLICY CPU
  2768	001675'01  263 01 0 00 000000 		RET			;NO, ONLY RUN ONCE A SECOND!
  2769					>
  2770					>; END FTOPS10
  2771	001676'01  260 01 0 00 001315*		SE1ENT
  2772	001677'01  265 17 0 00 004763'		ACVAR <HN,XB,RB,CB,SB,W1,W2>;Get a set of dedicated ACs
  2773					IFN FTOPS20,<
  2774						TRVAR <MSGDID,MSGSID,MSGACK,STPCOD> ;Message header variable storage
  2775					>; END FTOPS20
  2776	001700'01  336 06 0 00 001605*		SKIPN HN,LAHNDB		;Get the host node database address
  2777	001701'01  263 01 0 00 000000 		RET			;If none, not initialized yet.
  2778	001702'01  260 01 0 00 001756'		CALL MOVNIQ		;Move all messages from NI to Scheduler queue
  2779					IFN FTOPS10,<
  2780	001703'01  402 00 0 00 000000#		SETZM LATWFB		;Say we don't want more buffers yet
  2781					>;end IFN FTOPS10
  2782	001704'01  336 03 0 06 000017 	MSGNXT:	OPSTR <SKIPN T2,>,HNSCQ,(HN);Get first element on the scheduler Q
  2783	001705'01  254 00 0 00 003470'		CALLRET LAMUX		;No more so call the slot multiplexor
  2784	001706'01  336 04 0 03 000001 		OPSTR <SKIPN T3,>,UELW1,(T2);Get new head or queue if any
  2785	001707'01  202 04 0 06 000020 		STOR T3,HNSCQ,+1(HN)	;None, so clear the queue header tail pointer
  2786	001710'01  202 04 0 06 000017 		STOR T3,HNSCQ,(HN)	;Set new queue header forward pointer
  2787	001711'01  402 00 0 03 000001 		SETZRO UELW1,(T2)	;Clear link word
  2788	001712'01  200 02 0 03 000010 		LOAD T1,UNCBA,+UNB.OF(T2)	
  2789	001713'01  302 02 0 00 000004 		CAIE T1,NU.XMT		;Is this a transmit complete?
  2790	001714'01  254 00 0 00 001717'		IFSKP.			;Yes...
  2791	001715'01  260 01 0 00 002725'		  CALL XMTDON		;Go do scheduler level transmit done stuff
  2792	001716'01  254 00 0 00 001704'		  JRST MSGNXT		; and continue with next message
  2793	001717'01				ENDIF.
  2794	001717'01  200 11 0 00 000003 		MOVE RB,T2		;Message address obtained
  2795	001720'01  332 02 0 11 000003 		SKIPE T1,UN.SID+UNB.OF(RB);Was there an error?
  2796	001721'01  254 00 0 00 001751'		JRST MSGDON		;Re-post and ignore
  2797	001722'01  350 00 0 06 000713 		OPSTRM <AOS>,HCRCV,(HN)	;Increment count of received messages
  2798	001723'01  134 14 0 11 000017 		OPSTR <ILDB W1,>,UNBFA,+UNB.OF(RB);Get the message type from the buffer
  2799	001724'01  134 02 0 11 000017 		OPSTR <ILDB T1,>,UNBFA,+UNB.OF(RB);Get number of slots in message
  2800	001725'01  202 02 0 00 000000#		MOVEM T1,NSLOTS
  2801	001726'01  561 02 0 00 777776 		MOVX T1,-2		;Reduce the residual byte count by 2 for
  2802	001727'01  272 02 0 11 000016 		OPSTRM <ADDM T1,>,UNBSZ,+UNB.OF(RB); type and slots fields
  2803	001730'01  260 01 0 00 002736'		CALL LAG2BY		;Get the destination ID from msg (2 bytes)
  2804	001731'01  202 02 0 00 000000#		MOVEM T1,MSGDID
  2805	001732'01  260 01 0 00 002736'		CALL LAG2BY		;Get the source id from the msg
  2806	001733'01  202 02 0 00 000000#		MOVEM T1,MSGSID
  2807	001734'01  260 01 0 00 002736'		CALL LAG2BY		;Get the ACK/SEQ field from msg
  2808	001735'01  202 02 0 00 000000#		MOVEM T1,MSGACK
  2809	001736'01  200 02 0 00 000014 		MOVE T1,W1
  2810	001737'01  242 02 0 00 777776 		LSH T1,-2		;Shift off the M and RRF bits
  2811	001740'01  301 02 0 00 000000 		CAIL T1,MINMTY		;Range check message type
  2812	001741'01  303 02 0 00 000002 		CAILE T1,MAXMTY		;...
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 58-1
LATSER	MAC	19-Aug-74 07:34		LARSCH - Scheduler Level Virtual Circuit Message Receiver

  2813	001742'01  604 00 0 00 000000 		IFNSK.
  2814	001743'01  254 00 0 00 001746'
  2815						  BUG. (INF,LATIMT,LATSER,SOFT,<LAT Illegal Message Type>,<<T1,MSGID>>,<
  2816					
  2817					Cause:	LAT virtual circuit message received with message type out of range.
  2818					
  2819					Action:
  2820					
  2821	001744'01  256 00 0 00 005005'	>)
  2822	001745'01  254 00 0 00 001751'		ELSE.
  2823	001746'01  606 14 0 00 000002 		  TRNN W1,2		;Test the Master/Slave bit
  2824	001747'01  254 00 0 00 001751'		  JRST MSGDON		;This a message from a host. 
  2825	001750'01  260 01 1 02 001753'		  CALL @MSGDSP-MINMTY(T1) ;Dispatch to process the message
  2826	001751'01				ENDIF.
  2827	001751'01  260 01 0 00 004303'	MSGDON:	CALL RELRBF		;else ignore for now
  2828	001752'01  254 00 0 00 001704'		JRST MSGNXT
  2829
  2830
  2831		   	   000000		MIN. (MINMTY,<MT.RUN,MT.STA,MT.STP>) ;Minimum message type code
  2832		   	   000002		MAX. (MAXMTY,<MT.RUN,MT.STA,MT.STP>) ;Maximum message type code
  2833
  2834	001753'01			MSGDSP:	BLOCK <MAXMTY-MINMTY+1>
  2835	001753'01  400 00 0 00 002233'		LHDSP. (MSGDSP,MT.RUN-MINMTY,HMRUN) ;RUN message received
  2836	001754'01  400 00 0 00 002004'		LHDSP. (MSGDSP,MT.STA-MINMTY,HMSTRT) ;START message received
  2837	001755'01  400 00 0 00 002347'		LHDSP. (MSGDSP,MT.STP-MINMTY,HMSTOP) ;STOP message received
  2838
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 59
LATSER	MAC	19-Aug-74 07:34		LARSCH - Scheduler Level Virtual Circuit Message Receiver

  2839
  2840
  2841					;MOVNIQ - Move all messages on the NI queue to the Scheduler queue
  2842					;
  2843					;Call:	T1/ Pointer to head of NIQ 
  2844					;	T2/ Pointer to tail of NIQ
  2845					;	CALL MOVNIQ
  2846					;	Normal return
  2847					;
  2848					;Uses: T3,T4 
  2849
  2850	001756'01			MOVNIQ:	
  2851	001756'01  260 01 0 00 001662*		ETHLOK			;No interruptions, please!
  2852	001757'01  120 02 0 06 000015 		DMOVE T1,HN.NIQ(HN)	;Get the header contents
  2853	001760'01  402 00 0 06 000015 		SETZM HN.NIQ(HN)	;Clear the queue begin pointer
  2854	001761'01  402 00 0 06 000016 		SETZM HN.NIQ+1(HN)	;Clear the end pointer
  2855	001762'01  260 01 0 00 001672*		ETHULK			;Ok, interrupt me now
  2856	001763'01  336 04 0 06 000020 		OPSTR <SKIPN T3,>,HNSCQ,+1(HN);Is there anything on the queue?
  2857	001764'01  254 00 0 00 001767'		IFSKP.			;YES
  2858	001765'01  202 02 0 04 000001 		  STOR T1,UELW1,(T3)	;Add new elements at the queue tail.
  2859	001766'01  254 00 0 00 001770'		ELSE.			;NO
  2860	001767'01  202 02 0 06 000017 		  STOR T1,HNSCQ,(HN)	;New queue header forward pointer
  2861	001770'01				ENDIF.
  2862	001770'01  202 03 0 06 000020 		STOR T2,HNSCQ,+1(HN)	;New queue header tail pointer.
  2863	001771'01  263 01 0 00 000000 		RET
  2864
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 60
LATSER	MAC	19-Aug-74 07:34		LATLSC - Ethernet Link State Change Callback

  2865						SUBTTL	LATLSC - Ethernet Link State Change Callback
  2866
  2867					;LATLSC - Process an asynchronous link state change
  2868					;
  2869					;Call:	T1/ NU.RCI
  2870					;	T2/UN block address
  2871					;	Normal return
  2872					;
  2873
  2874	001772'01  205 04 0 00 400000 	LATLSC:	MOVX T3,HNRUN
  2875	001773'01  331 00 0 03 000003 		OPSTR <SKIPL>,UNSTA,(T2)	;Is NI running?
  2876	001774'01  254 00 0 00 002002'		IFSKP.
  2877	001775'01  412 04 0 06 000000 		  ANDCAM T3,HN.FLG(HN)	;NI is up
  2878	001776'01  201 02 0 00 000001 		  MOVEI T1,1		;So if multicast timer
  2879	001777'01  333 00 0 00 000000#		  SKIPLE LATMCT		; is running...
  2880	002000'01  202 02 0 00 000000#		  MOVEM T1,LATMCT	;  set it to ring soon.
  2881	002001'01  254 00 0 00 002003'		ELSE.
  2882	002002'01  436 04 0 06 000000 		IORM T3,HN.FLG(HN)	;NI went down.
  2883	002003'01				ENDIF.
  2884	002003'01  263 01 0 00 000000 		RET
  2885
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 61
LATSER	MAC	19-Aug-74 07:34		Message Receiver - HMSTRT

  2886						SUBTTL	Message Receiver - HMSTRT
  2887
  2888					;HMSTRT - Process a Received START Message
  2889					;
  2890					;Call:	RB/ Address of Message Block
  2891					;	CALL HMSTRT
  2892					;	 Error Return - error processing completed, message processing aborted.
  2893					;	Normal Return
  2894
  2895	002004'01  200 17 0 06 000000 	HMSTRT:	TMNN HNCIP,(HN)		;If the START message template is locked
  2896	002005'01  607 17 0 00 100000 
  2897	002006'01  336 00 0 00 000000#		SKIPN MSGSID		;or source's message handle is 0
  2898	002007'01  263 01 0 00 000000 		 RET			; ignore since server will persist.
  2899	002010'01  550 02 0 06 000004 		LOAD T1,HNLAS,(HN)	;If LAT access state is not ON, ignore the
  2900	002011'01  302 02 0 00 000001 		CAIE T1,LS.ON		; START message. 
  2901	002012'01  263 01 0 00 000000 		 RET			; ...
  2902	002013'01  550 02 0 06 000002 		LOAD T1,HNNAC,(HN)	;If the addition of this circuit brings total
  2903	002014'01  554 17 0 06 000002 		OPSTR <CAML T1,>,HNMAC,(HN); over the maximum number of active circuits
  2904	002015'01  311 02 0 00 000017 
  2905	002016'01  265 03 0 00 002367'		 JSP T2,NOCRES		; then reject it.
  2906	002017'01  260 01 0 00 002044'		CALL HSTRCB		;Find the CB associated with this circuit.
  2907	002020'01  263 01 0 00 000000 		 RET			;None.  Error action already taken.
  2908	002021'01  550 02 0 12 000024 		LOAD T1,CBSTA,(CB)	;Get the current circuit state
  2909	002022'01  302 02 0 00 000002 		CAIE T1,CS.RUN		;If the state is running, 
  2910	002023'01  254 00 0 00 002027'		IFSKP.
  2911	002024'01  260 01 0 00 003372'		  CALL RELSBS		; release all current slots before continuing
  2912	002025'01  260 01 0 00 004250'		  CALL RFXBFS		;Release all buffers on free queue.
  2913	002026'01  260 01 0 00 002465'		  CALL MDLXBF		;Mark all buffers on ACK queue for later release
  2914	002027'01				ENDIF.
  2915	002027'01  260 01 0 00 004172'		CALL GETXBH		;Get the necessary number of transmit buffer
  2916	002030'01  334 00 0 00 000000 		 SKIPA			; headers (+MSD pointers)
  2917	002031'01  260 01 0 00 004266'		CALL GETRBF		;Go see if we need more receive buffers
  2918	002032'01  265 03 0 00 002367'		 JSP T2,NOCRES		;Could not get the necessary buffer quota
  2919	002033'01  260 01 0 00 002112'		CALL CBINIT		;Initialize all host CB parameters
  2920	002034'01  263 01 0 00 000000 		 RET			;START message format bad. Error action done.
  2921	002035'01  260 01 0 00 002411'		CALL MTTSTR		;Send a START message
  2922	002036'01  201 02 0 00 000001 		MOVEI T1,CS.STA		;Put the circuit into the
  2923	002037'01  542 02 0 12 000024 		STOR T1,CBSTA,(CB)	; STARTING state.
  2924					IFN FTOPS20,<	RET		; and return. >
  2925					IFN FTOPS10,<
  2926	002040'01  201 02 0 00 000003 		MOVEI T1,MAXXBF+1	;New circuit, add some buffers
  2927	002041'01  313 02 0 00 000000#		CAMLE T1,LATNFB		;Are there already enough free buffers?
  2928	002042'01  272 02 0 00 000000#		  ADDM T1,LATWFB	;No, ask for some more
  2929	002043'01  263 01 0 00 000000 		RET
  2930					>;END IFN FTOPS10
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 62
LATSER	MAC	19-Aug-74 07:34		HSTRCB

  2931						SUBTTL 	HSTRCB
  2932
  2933					;HSTRCB - Find the circuit block for a received START msg on a LAT host.
  2934					;
  2935					;Call:	RB/ address of received message block
  2936					;	CALL HSTRCB
  2937					;	 Error Return - CB not found
  2938					;	Normal Return
  2939					;	CB/ Circuit Block address
  2940
  2941	002044'01  415 02 0 06 000013 	HSTRCB:	XMOVEI T1,HN.QIC(HN)	;Search the inactive CB queue first
  2942	002045'01  260 01 0 00 002173'		CALL CMNIAD		;Look for NI address match
  2943	002046'01  334 00 0 00 000000 		 SKIPA			;Not found on the inactive CB queue
  2944	002047'01  254 00 0 00 002074'		JRST CBIFND		;Correct CB found on inactive CB queue
  2945	002050'01  415 02 0 06 000011 	NFND1:	XMOVEI T1,HN.QAC(HN)	;Not on inactive Q, try active Q
  2946	002051'01  260 01 0 00 002173'		CALL CMNIAD		;Look for NI address match
  2947	002052'01  334 00 0 00 000000 		 SKIPA			;Not on active queue either
  2948	002053'01  254 00 0 00 002111'		JRST CBAFND		;Active CB has been found
  2949	002054'01  550 03 0 06 000002 	NFND2:	LOAD T2,HNNAC,(HN)	;Get number of currently active CBs
  2950	002055'01  554 17 0 06 000001 		OPSTR <CAML T2,>,HNMXC,(HN) ;Compare with maximum allowed
  2951	002056'01  311 03 0 00 000017 
  2952	002057'01  254 00 0 00 002072'		IFSKP.			;Not at maximum number of CBs allowed
  2953	002060'01  201 02 0 00 000061 		  MOVEI T1,CC.LST	;The number of words to get for a CB
  2954	002061'01  260 01 0 00 004471'		  CALL MMGTZW		;Go get them
  2955	002062'01  265 03 0 00 002367'		   JSP T2,NOCRES	;Failed
  2956	002063'01  200 12 0 00 000002 		  MOVE CB,T1		;This is the new CB address
  2957	002064'01  201 02 0 00 000000 		  MOVEI T1,CS.HLT	;Don't assume that the halted state
  2958	002065'01  542 02 0 12 000024 		  STOR T1,CBSTA,(CB)	; is zero.
  2959	002066'01  550 17 0 06 000001 		  OPSTRM <AOS>,HNNCC,(HN) ;Count number of allocated CBs 
  2960	002067'01  350 00 0 00 000017 
  2961	002070'01  542 17 0 06 000001 
  2962	002071'01  254 00 0 00 002076'		  JRST CBALNW		;Allocated new CB successfully
  2963	002072'01				ENDIF.
  2964	002072'01  336 12 0 06 000014 		OPSTR <SKIPN CB,>,QLBWD,+HN.QIC(HN);Check inactive Q for free CB
  2965	002073'01  265 03 0 00 002367'		JSP T2,NOCRES		;None, so can't reuse an inactive CB
  2966	002074'01  200 03 0 00 000012 	CBIFND:	MOVE T2,CB		;(T1)Remove from inactive CB queue
  2967	002075'01  260 01 0 00 004145'		CALL LAUNQ
  2968	002076'01  260 01 0 00 002206'	CBALNW:	CALL CBGNIX		;Get next assignable index for the CB
  2969	002077'01  415 02 0 06 000011 		XMOVEI T1,HN.QAC(HN)	;Put at the front of the active
  2970	002100'01  200 03 0 00 000012 		MOVE T2,CB		; CB
  2971	002101'01  260 01 0 00 004135'		CALL LAQUE		; queue
  2972	002102'01  550 17 0 06 000002 		OPSTRM <AOS>,HNNAC,(HN)	;New active circuit. Count it.
  2973	002103'01  350 00 0 00 000017 
  2974	002104'01  542 17 0 06 000002 
  2975	002105'01  523 00 0 12 000024 		SETONE CBSTA,(CB)	;Set state to non-HALTED since now active
  2976	002106'01  350 00 0 12 000051 		OPSTRM <AOS>,CCRCV,(CB)	;Increment per server count
  2977	002107'01  120 02 0 11 000014 		OPSTR <DMOVE T1,>,UNSAD,+UNB.OF(RB);Move the source NI address from
  2978	002110'01  124 02 0 12 000017 		OPSTRM <DMOVEM T1,>,CBDNI,(CB)  ; message to the CB
  2979	002111'01  254 00 0 00 001050*	CBAFND:	RETSKP			;Return success
  2980
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 63
LATSER	MAC	19-Aug-74 07:34		CBINIT - Circuit Block Initialization

  2981						SUBTTL	CBINIT - Circuit Block Initialization
  2982
  2983					;
  2984					;CBINIT - Initialize a Circuit Block from the Contents of a START Message
  2985					;
  2986					;Call:	CB/ Address of Circuit Block
  2987					;	RB/ Address of Message Block
  2988					;	CALL CBINIT
  2989					;	 Error Return - START Message content in error.
  2990					;	Normal Return
  2991
  2992	002112'01  201 02 0 00 000020 	CBINIT:	MOVEI T1,MSTMSI		;Check to see if the message is at least
  2993	002113'01  313 02 0 11 000016 		OPSTR <CAMLE T1,>,UNBSZ,+UNB.OF(RB); the minimum size for a START msg
  2994	002114'01  265 03 0 00 002361'		JSP T2,ILLMESS		;No, too short.
  2995	002115'01  402 00 0 12 000003 		SETZM CLRBEG(CB)	;Clear the region which must be initialized
  2996	002116'01  201 02 0 00 000005 		MOVEI T1,<CLREND-CLRBEG>; to zero when a circuit block is 
  2997	002117'01  415 03 0 12 000003 		XMOVEI T2,CLRBEG(CB)	; re-used.
  2998	002120'01  415 04 0 12 000004 		XMOVEI T3,CLRBEG+1(CB)	; ...
  2999	002121'01  123 02 0 00 004567'		XBLT. T1		; ...
  3000	002122'01  200 02 0 00 000000#		MOVE T1,MSGSID		;Move source's circuit ID from message
  3001	002123'01  506 02 0 12 000002 		STOR T1,CBRID,(CB)	; to circuit block
  3002	002124'01  260 01 0 00 002736'		CALL LAG2BY		;Get the maximum transmit frame size which
  3003	002125'01  506 02 0 12 000021 		STOR T1,CBMTF,(CB) ; the remote will allow
  3004	002126'01  134 02 0 11 000017 		OPSTR <ILDB T1,>,UNBFA,+UNB.OF(RB);LAT protocol version used by remote
  3005	002127'01  301 02 0 00 000005 		CAIL T1,LALPV		;Check if in the range of version supported
  3006	002130'01  303 02 0 00 000005 		CAILE T1,LAHPV		; by this node
  3007	002131'01  265 03 0 00 002365'		JSP T2,LVSKEW		;Out of range, return error
  3008	002132'01  134 03 0 11 000017 		OPSTR <ILDB T2,>,UNBFA,+UNB.OF(RB);Remote's protocol ECO level
  3009	002133'01  242 03 0 00 000011 		LSH T2,^D9		;Shift protocol version
  3010	002134'01  434 02 0 00 000003 		IOR T1,T2		;OR version and ECO level
  3011	002135'01  542 02 0 12 000021 		STOR T1,CBRPV,(CB) ;	; and store as single unit
  3012	002136'01  134 02 0 11 000017 		OPSTR <ILDB T1,>,UNBFA,+UNB.OF(RB);Maximum number of slots in VC message
  3013	002137'01  506 02 0 12 000022 		STOR T1,CBMSL,(CB)	; permitted by remote
  3014	002140'01  134 02 0 11 000017 		OPSTR <ILDB T1,>,UNBFA,+UNB.OF(RB);Number of additional receive buffers
  3015	002141'01  542 02 0 12 000022 		STOR T1,CBNBF,(CB)	; queued by remote for this circuit
  3016	002142'01  134 02 0 11 000017 		OPSTR <ILDB T1,>,UNBFA,+UNB.OF(RB);Remote's circuit timer value
  3017	002143'01  506 02 0 12 000023 		STOR T1,CBCTI,(CB)	;
  3018	002144'01  134 02 0 11 000017 		OPSTR <ILDB T1,>,UNBFA,+UNB.OF(RB);Remote's keep-alive timer value
  3019	002145'01  542 02 0 12 000023 		STOR T1,CBKTI,(CB) 	;Which is in seconds.
  3020	002146'01  221 02 0 00 000331*		IMULI T1,JIFSEC##	;CONVERT TO Jiffies
  3021	002147'01  516 02 0 12 000050 		HRLZM T1,CB.KAF(CB)
  3022	002150'01  561 02 0 00 777772 		MOVX T1,-^D6		;Decrement residual message count by what we
  3023	002151'01  272 02 0 11 000016 		OPSTRM <ADDM T1,>,UNBSZ,+UNB.OF(RB); have read so far.
  3024	002152'01  260 01 0 00 002736'		CALL LAG2BY		;Get the "facility number"
  3025	002153'01  506 02 0 12 000025 		STOR T1,CBNUM,(CB)
  3026	002154'01  260 01 0 00 002736'		CALL LAG2BY		;Get the product type code
  3027	002155'01  506 02 0 12 000024 		STOR T1,CBPTC,(CB)
  3028	002156'01  260 01 0 00 002745'		CALL IGCSTR		;Skip the circuit name
  3029	002157'01  265 03 0 00 002361'		 JSP T2,ILLMES		;Illegally formatted message
  3030	002160'01  201 02 0 00 000020 		MOVEI T1,ML.SYS		;Maximum length of system's name string
  3031	002161'01  200 03 0 00 005011'		MOVX T2,<POINT 7,<CB.SNM>(CB)> ;Copy the name string
  3032	002162'01  260 01 0 00 002746'		CALL GTCSTR
  3033	002163'01  265 03 0 00 002361'		 JSP T2,ILLMES		;Illegally formatted message
  3034	002164'01  542 02 0 12 000025 		STOR T1,CBRSC,(CB) ;Save the length of the name string
  3035	002165'01  201 02 0 00 000100 		MOVEI T1,ML.LOC		;Maximum length of the system's location string
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 63-1
LATSER	MAC	19-Aug-74 07:34		CBINIT - Circuit Block Initialization

  3036	002166'01  200 03 0 00 005012'		MOVX T2,<POINT 7,<CB.LOC>(CB)>;Copy the location string
  3037	002167'01  260 01 0 00 002746'		CALL GTCSTR
  3038	002170'01  265 03 0 00 002361'		 JSP T2,ILLMES		;Illegally formatted message
  3039	002171'01  506 02 0 12 000026 		STOR T1,CBRLC,(CB) 	;Save the length of the location string
  3040	002172'01  254 00 0 00 002111*		RETSKP
  3041
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 64
LATSER	MAC	19-Aug-74 07:34		CMNIAD - Find CB base on NI address

  3042						SUBTTL	CMNIAD - Find CB base on NI address
  3043
  3044					;CMNIAD - search the CBs on a CB queue looking for one which has the same
  3045					;	NI address as the source NI address in the incoming message.
  3046					;
  3047					;Call:	T1/ Queue header of CB queue to search
  3048					;	RB/ Address of the circuit message
  3049					;	CALL CMNIAD
  3050					;	 Not found return
  3051					;	Success return
  3052					;	T1/ unchanged
  3053					;	CB/ circuit block address if found, 0 otherwise
  3054
  3055	002173'01  200 12 0 02 000000 	CMNIAD:	LOAD CB,QLFWD,(T1)	;Get the first queue entry
  3056	002174'01  322 12 0 00 001005*	CMLOOP:	JUMPE CB,RTN		;Is this last entry?
  3057	002175'01  200 04 0 12 000017 		LOAD T3,CBDNI,(CB)	;First 4 bytes of remote NI address from CB
  3058	002176'01  200 05 0 12 000020 		LOAD T4,CBDNI,+1(CB)	;Last 2 bytes
  3059	002177'01  316 04 0 11 000014 		OPSTR <CAMN T3,>,UNSAD,+UNB.OF(RB);Compare with message destination adr
  3060	002200'01  312 05 0 11 000015 		OPSTR <CAME T4,>,UNSAD,+<UNB.OF+1>(RB) ;...
  3061	002201'01  604 00 0 00 000000 		IFNSK.
  3062	002202'01  254 00 0 00 002205'
  3063	002203'01  200 12 0 12 000000 		  LOAD CB,QLFWD,+CB.LNK(CB); Get next forward CB
  3064	002204'01  254 00 0 00 002174'		  JRST CMLOOP		;Try again
  3065	002205'01				ENDIF.
  3066	002205'01  254 00 0 00 002172*		RETSKP			;Return success
  3067		
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 65
LATSER	MAC	19-Aug-74 07:34		CMNIAD - Find CB base on NI address

  3068
  3069
  3070					;
  3071					;CBGNIX - Get the next assignable index for a CB
  3072					;
  3073					;Call:	CB/ address of circuit block
  3074					;	CALL CBGNIX
  3075					;	Normal Return
  3076					;
  3077					; This routine is called each time a CB is to be used for a new LAT
  3078					; virtual circuit.  The old index vector (CBVECT) pointer to the CB
  3079					; is deleted and a new index is generated.
  3080
  3081	002206'01  200 14 0 00 000000#	CBGNIX:	MOVE W1,CBVECT		;Get the address of the CB index vector
  3082	002207'01  550 17 0 12 000002 		OPSTR <SKIPN T2,>,CBLID,(CB);Get the old circuit index, if any.
  3083	002210'01  336 03 0 00 000017 
  3084	002211'01  254 00 0 00 002214'		IFSKP.
  3085	002212'01  270 03 0 00 000014 		  ADD T2,W1		;Get the address of the pointer to this CB
  3086	002213'01  402 00 0 03 000000 		  SETZM (T2)		; in the CB index vector and clear it.
  3087	002214'01				ENDIF.
  3088	002214'01  554 03 0 06 000022 		LOAD T2,HNNXI,(HN)	;Get the next available index to assign
  3089	002215'01  542 03 0 12 000002 		STOR T2,CBLID,(CB)	;Set the new index in the CB
  3090	002216'01  200 02 0 00 000014 		MOVE T1,W1		;Address of teh CB index vector
  3091	002217'01  270 02 0 00 000003 		ADD T1,T2		;Offset into this vector for new index
  3092	002220'01  202 12 0 02 000000 		MOVEM CB,(T1)		;Set the new pointer to point to new CB
  3093	002221'01  350 00 0 00 000003 	CBGNX0:	AOS T2			;Increment the next available index
  3094	002222'01  350 00 0 00 000002 		AOS T1			; and the corresponding index vector pointer
  3095	002223'01  307 03 0 00 000255 		CAIG T2,CBMAXI		;Time to wrap around?
  3096	002224'01  254 00 0 00 002227'		IFSKP.			;Yes
  3097	002225'01  201 03 0 00 000001 		  MOVEI T2,1		;Always start at 1
  3098	002226'01  415 02 0 14 000001 		  XMOVEI T1,1(W1)	;and vector+1
  3099	002227'01				ENDIF.
  3100	002227'01  332 00 0 02 000000 		SKIPE (T1)		;Is this vector entry free?
  3101	002230'01  254 00 0 00 002221'		JRST CBGNX0		;No, try next
  3102	002231'01  506 03 0 06 000022 		STOR T2,HNNXI,(HN)	;Store new "next assignable index"	
  3103	002232'01  263 01 0 00 000000 		RET
  3104
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 66
LATSER	MAC	19-Aug-74 07:34		-- HMRUN -- 

  3105						SUBTTL -- HMRUN -- 
  3106
  3107					;HMRUN - Process a Host RUN Message
  3108					;
  3109					;Call:	
  3110					;	CALL HMRUN
  3111					;	 Error return
  3112					;	Normal return
  3113
  3114	002233'01  260 01 0 00 002320'	HMRUN:	CALL HRUNCB		;Get the circuit block address
  3115	002234'01  263 01 0 00 000000 		 RET			;None, error action already comleted
  3116	002235'01  332 03 0 00 000000#		SKIPE T2,MSGDID		;Destination and source circuit IDs from
  3117	002236'01  336 02 0 00 000000#		SKIPN T1,MSGSID		; the message may not be zero
  3118	002237'01  265 03 0 00 002361'		JSP T2,ILLMES		;If so, it is illegal
  3119	002240'01  554 04 0 12 000002 		LOAD T3,CBRID,(CB)	;Get the remote's circuit index from the CB
  3120	002241'01  550 05 0 12 000002 		LOAD T4,CBLID,(CB)	; and our circuit index from the CB must match
  3121	002242'01  316 02 0 00 000004 		CAMN T1,T3		; the source id and
  3122	002243'01  312 03 0 00 000005 		CAME T2,T4		; the destination id from the msg.
  3123	002244'01  265 03 0 00 002401'		JSP T2,INVRUN		;Invalid RUN msg, go terminate the circuit.
  3124	002245'01  513 00 0 12 000050 		HLLZS CB.KAF(CB)	;Clear the host keep-alive timer.
  3125	002246'01  201 02 0 00 000002 		MOVEI T1,CS.RUN		;Put in RUNNING state if not there already
  3126	002247'01  542 02 0 12 000024 		STOR T1,CBSTA,(CB)	;Store state in CB
  3127	002250'01  200 02 0 00 000000#		MOVE T1,MSGACK		;Get the SEQ/ACK number
  3128	002251'01  200 14 0 00 000002 		MOVE W1,T1		;
  3129	002252'01  405 02 0 00 000377 		ANDI T1,377		;Received message sequence number
  3130	002253'01  242 14 0 00 777770 		LSH W1,-^D8		;Last message ack'd by remote
  3131	002254'01  554 04 0 12 000005 		LOAD T3,CBRSQ,(CB)	;Previous recv SEQ number
  3132	002255'01  350 00 0 00 000004 		AOS T3			;Increment
  3133	002256'01  405 04 0 00 000377 		ANDI T3,377		;Modulo 256
  3134	002257'01  312 02 0 00 000004 		CAME T1,T3		;Is is the expected sequence number
  3135	002260'01  254 00 0 00 002263'		IFSKP.
  3136	002261'01  506 02 0 12 000005 		  STOR T1,CBRSQ,(CB)	;Update expected sequence number for next time
  3137	002262'01  254 00 0 00 002266'		ELSE.
  3138	002263'01  402 00 0 00 000000#		  SETZM NSLOTS		;No, ignore any slots in this message
  3139	002264'01  350 00 0 06 000716 		  OPSTRM <AOS>,HCSEQ,(HN);Increment Host's count
  3140	002265'01  350 00 0 12 000054 		  OPSTRM <AOS>,CCSEQ,(CB);Increment per-server count
  3141	002266'01				ENDIF.
  3142	002266'01  550 04 0 12 000005 		LOAD T3,CBLRA,(CB)	;Previous "last ACK from remote"
  3143	002267'01  542 14 0 12 000005 		STOR W1,CBLRA,(CB)	;New "last ACK from remote"
  3144	002270'01  315 14 0 00 000004 		CAMGE W1,T3		;Is new ACK less than old ACK?
  3145	002271'01  271 14 0 00 000400 		ADDI W1,^D256		;Yes, new ACK has wrapped around
  3146	002272'01  274 14 0 00 000004 		SUB W1,T3		;Number of messages ACK'd by this msg
  3147	002273'01  303 14 0 00 000002 		CAILE W1,MAXXBF		;Range check it and if out of range
  3148	002274'01  265 03 0 00 002361'		JSP T2,ILLMES		; treat as an illegal message
  3149	002275'01  336 00 0 00 000014 		SKIPN W1		;If anything got ACK'd
  3150	002276'01  254 00 0 00 002300'		IFSKP.
  3151	002277'01  513 00 0 12 000006 		  SETZRO CBRTC,(CB)	
  3152	002300'01				ENDIF.
  3153	002300'01  322 14 0 00 002311'	NXTACK:	JUMPE W1,ACKDON		;No new messages ACK'd
  3154	002301'01  200 07 0 12 000013 		MOVE XB,CB.AKQ(CB)	;Get first buffer on ack queue
  3155	002302'01  260 01 0 00 004256'		CALL RELXBF		;Release buffer, since we got an ack
  3156	002303'01  415 02 0 12 000013 		XMOVEI T1,CB.AKQ(CB)	;Unqueue the now acknowledged buffers
  3157	002304'01  260 01 0 00 004164'		CALL UNQ1WF		; from the ACK wait queue
  3158	002305'01  265 03 0 00 002361'		  JSP T2,ILLMES	;Should not happen
  3159	002306'01  415 02 0 12 000011 		XMOVEI T1,CB.XBQ(CB)	;Queue  them back to the transmit buffer
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 66-1
LATSER	MAC	19-Aug-74 07:34		-- HMRUN -- 

  3160	002307'01  260 01 0 00 004156'		CALL QUE1WB		; queue.
  3161	002310'01  364 14 0 00 002300'		SOJA W1,NXTACK
  3162	002311'01  336 00 0 12 000013 	ACKDON:	OPSTR <SKIPN>,CBAKQ,(CB);If all messages ack'd
  3163	002312'01  553 00 0 12 000006 		SETZRO CBTIM,(CB)	; clear the circuit timer.
  3164	002313'01  205 17 0 00 200000 		SETONE CBMRS,(CB)	;Indicate we must respond to this msg "soon"
  3165	002314'01  436 17 0 12 000003 
  3166	002315'01  260 01 0 00 003040'		CALL LSDMUX		;Go process all slots in the RUN message
  3167	002316'01  260 01 0 00 002477'		  CALL MTTSTP		;Illegal slot, kill the circuit
  3168	002317'01  263 01 0 00 000000 		RET			;All slots processed, return.
  3169
  3170
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 67
LATSER	MAC	19-Aug-74 07:34		HSTRCB

  3171						SUBTTL 	HSTRCB
  3172
  3173					;
  3174					;HRUNCB - Find the circuit block for a received RUN/STOP msg on a LAT host.
  3175					;
  3176					;Call:	RB/ address of received message block
  3177					;	CALL HRUNCB
  3178					;	 Error Return - CB not found
  3179					;	Normal Return
  3180					;	CB/ Circuit Block address
  3181					;
  3182
  3183	002320'01  336 12 0 00 000000#	HRUNCB:	SKIPN CB,MSGDID		;Index to CB from received message
  3184	002321'01  265 03 0 00 002362'		JSP T2,ILLMS0		;Zero message destination index is illegal	
  3185	002322'01  307 12 0 00 000255 		CAIG CB,CBMAXI		;If CB index is greater than our max
  3186	002323'01  254 00 0 00 002326'		IFSKP.
  3187	002324'01  400 12 0 00 000000 		  SETZ	CB,		;it's also illegal, so flag no circuit
  3188	002325'01  265 03 0 00 002362'		  JSP	T2,ILLMS0	;and go send a stop message
  3189	002326'01				ENDIF.
  3190	002326'01  270 12 0 00 000000#		ADD CB,CBVECT		;Add address of vector of pointers to CBs
  3191	002327'01  336 12 0 12 000000 		SKIPN CB,(CB)		;The real circuit block address
  3192	002330'01  265 03 0 00 002401'		  JSP T2,INVRUN		;Circuit probably went away.
  3193	002331'01  120 04 0 12 000017 		OPSTR <DMOVE T3,>,CBDNI,(CB);All 6 bytes of remote NI address from CB
  3194	002332'01  316 04 0 11 000014 		OPSTR <CAMN T3,>,UNSAD,+UNB.OF(RB);Compare with message destination adr
  3195	002333'01  312 05 0 11 000015 		OPSTR <CAME T4,>,UNSAD,+<UNB.OF+1>(RB) ;...
  3196	002334'01  334 00 0 00 000000 		 SKIPA			;Not the right CB
  3197	002335'01  254 00 0 00 002345'		JRST HRNFND			;Found the CB	
  3198	002336'01  415 02 0 06 000011 		XMOVEI T1,HN.QAC(HN)	;Try searching the active Q
  3199	002337'01  260 01 0 00 002173'		CALL CMNIAD
  3200	002340'01  334 00 0 00 000000 		 SKIPA			;Not there either
  3201	002341'01  254 00 0 00 002345'		JRST HRNFND		;Found the CB
  3202	002342'01  415 02 0 06 000013 		XMOVEI T1,HN.QIC(HN)	;Try searching the inactive Q
  3203	002343'01  260 01 0 00 002173'		CALL CMNIAD
  3204	002344'01  265 03 0 00 002361'		 JSP T2,ILLMES		;Non-existent CB. Treat as illegal message.
  3205	002345'01  350 00 0 12 000051 	HRNFND:	OPSTRM <AOS>,CCRCV,(CB)	;Increment per-server count
  3206	002346'01  254 00 0 00 002205*		RETSKP			;Found the CB
  3207
  3208
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 68
LATSER	MAC	19-Aug-74 07:34		-- HMSTOP -- 

  3209						SUBTTL -- HMSTOP -- 
  3210
  3211	002347'01  260 01 0 00 002320'	HMSTOP:	CALL HRUNCB		;Get the CB for this STOPS message
  3212	002350'01  263 01 0 00 000000 		 RET			;None, error action already done
  3213	002351'01  332 00 0 00 000000#		SKIPE MSGSID		;Is the source ID in MSG non-zero?
  3214	002352'01  265 03 0 00 002361'		 JSP T2,ILLMES		;Yes, that's not legal
  3215	002353'01  550 02 0 12 000002 		LOAD T1,CBLID,(CB)	;Get our local ID for circuit. It must be
  3216	002354'01  550 03 0 12 000024 		LOAD T2,CBSTA,(CB)	;Current circuit state
  3217	002355'01  312 03 0 00 000000 		CAME T2,CS.HLT		;Is it halted or
  3218	002356'01  312 02 0 00 000000#		CAME T1,MSGDID		; an invalid STOP message?
  3219	002357'01  263 01 0 00 000000 		  RET			;Yes, just ignore it.
  3220	002360'01  254 00 0 00 002441'		CALLRET CBKILL		;Else, release all CB resources and
  3221									; put on inactive Q
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 69
LATSER	MAC	19-Aug-74 07:34		-- HMSTOP -- 

  3222
  3223
  3224					; Routines to terminate a circuit because of some error.  T1 contains
  3225					; the error to be entered into the STOP message.
  3226
  3227	002361'01  350 00 0 12 000055 	ILLMES: OPSTRM <AOS>,CCIMR,(CB)	;Increment per-server count
  3228	002362'01  350 00 0 06 000717 	ILLMS0:	OPSTRM <AOS>,HCIMR,(HN)	;Increment host count
  3229	002363'01  201 02 0 00 000002 		MOVEI T1,CE.ILL		;Illegally formatted message received
  3230	002364'01  254 00 0 00 002403'		JRST INFSTP		;Join common code to kill off circuit
  3231
  3232	002365'01  201 02 0 00 000011 	LVSKEW:	MOVEI T1,CE.SKW		;Version skew between server and host,
  3233	002366'01  254 00 0 00 002403'		JRST INFSTP		; cannot support connection.
  3234
  3235	002367'01  350 00 0 12 000055 	NOCRES: OPSTRM <AOS>,CCIMR,(CB)	;Increment per-server count
  3236	002370'01  350 00 0 06 000717 	NOCRE0:	OPSTRM <AOS>,HCIMR,(HN)	;Increment host count
  3237	002371'01  201 02 0 00 000007 		MOVEI T1,CE.RES		;Insufficient resources to support new circuit.
  3238	002372'01  254 00 0 00 002403'		JRST INFSTP
  3239
  3240	002373'01  201 02 0 00 000006 	XMTLIM: MOVEI T1,CE.LIM		;Retransmit limit exceeded. Server probably
  3241	002374'01  254 00 0 00 002403'		JRST INFSTP		; has gone away.
  3242
  3243	002375'01  201 02 0 00 000001 	IDLHLT:	MOVEI T1,CE.NSL		;Circuit halted because there are no more slots
  3244	002376'01  254 00 0 00 002477'		JRST MTTSTP
  3245
  3246	002377'01  201 02 0 00 000003 	LCLHLT: MOVEI T1,CE.HLT		;Circuit halted by local system. Either stopped
  3247	002400'01  254 00 0 00 002477'		JRST MTTSTP		; by operator or last slot has disconnected.
  3248
  3249					IFN FTOPS20,<
  3250					NIHALT:	MOVEI T1,CE.NIH		;NI halted
  3251						SETZ T2,0		;PC meaningless
  3252						JRST INFSTP
  3253					>; END IFN FTOPS20
  3254
  3255	002401'01  201 02 0 00 000012 	INVRUN:	MOVEI T1,CE.INV		;Invalid message
  3256	002402'01  254 00 0 00 002403'		JRST INFSTP
  3257
  3258	002403'01  261 01 0 00 000003 	INFSTP:	PUSH P,T2		;Save PC of error
  3259	002404'01  120 03 0 11 000014 		OPSTR <DMOVE T2,>,UNSAD,+UNB.OF(RB) ;Source NI address from recvd msg
  3260	002405'01  124 03 0 00 000000#		DMOVEM T2,LASBAD	;Save ethernet address of sender of bad msg
  3261	002406'01  262 01 0 00 000003 		POP P,T2		;Restore PC of caller for typeout
  3262						BUG. (INF,LATNSC,LATSER,SOFT,<LAT Host node stopped circuit>,<<T1,CODE>,<T2,PC>,<LAS
  3263					BAD,EADDR1>,<LASBAD+1,EADDR2>>,<
  3264					
  3265					Cause:	LAT Host node stopped the circuit.
  3266					
  3267					Action: Look at the Reason Code in T1 and the PC in T2, and the
  3268						Ethernet address in EADDR1 and EADDR2.  This error, if
  3269						relatively infrequent is nothing to be concerned about.  If it occurs
  3270						frequently, use the CODE and PC to determine further action.
  3271	002407'01  256 00 0 00 005025'	>)
  3272	002410'01  254 00 0 00 002477'		JRST MTTSTP
  3273
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 70
LATSER	MAC	19-Aug-74 07:34		Message Transmit Routines

  3274						SUBTTL	Message Transmit Routines
  3275
  3276					;MTTSTR - transmit a START message
  3277					; 
  3278					;Call:	CALL MTTSTR
  3279					;	Normal Return
  3280					;
  3281					; This routine builds the START message header in the template from the host
  3282					; node data base and transmits it. It sets the interlock so that the template
  3283					; cannot be changed at process level by the LATOP% JSYS.  The message count
  3284					; is not changed since it is already correct (hence LAP2B0 is called instead of
  3285					; LAP2BY).  Cannot fail after this point since sending a STOP will clobber
  3286					; the START msg template.
  3287
  3288	002411'01  205 17 0 00 100000 	MTTSTR:	SETONE HNCIP,(HN)	;Set interlock on the msg template
  3289	002412'01  436 17 0 06 000000 
  3290	002413'01  415 07 0 06 000044 		XMOVEI XB,HN.SMT(HN)	;Address of start message template
  3291	002414'01  200 02 0 00 004731'		MOVX T1,<POINT 8,<SBF.OF>(XB)>;Set pointer to the message header
  3292	002415'01  202 02 0 07 000017 		STOR T1,UNBFA,+UNB.OF(XB); for BMSGHD.
  3293	002416'01  201 02 0 00 000004 		MOVEI T1,<MT.STA_2>	;Build a START
  3294	002417'01  260 01 0 00 002643'		CALL BMSGHD		; message header
  3295	002420'01  415 02 0 07 000025 		XMOVEI T1,<SBF.OF>(XB)	;Build the one word global
  3296	002421'01  661 02 0 00 540000 		TLO T1,(<OWGP. 8,0>)	; byte pointer.
  3297	002422'01  202 02 0 07 000017 		STOR T1,UNBFA,+UNB.OF(XB);
  3298	002423'01  120 02 0 12 000017 		OPSTR <DMOVE T1,>,CBDNI,(CB);
  3299	002424'01  124 02 0 07 000012 		OPSTRM <DMOVEM T1,>,UNDAD,+UNB.OF(XB);
  3300	002425'01  200 02 0 06 000021 		LOAD T1,HNPID,(HN)	;Get the Portal ID for NISRV
  3301	002426'01  202 02 0 07 000002 		STOR T1,UNPID,+UNB.OF(XB)
  3302	002427'01  201 02 0 00 000004 		MOVX T1,NU.XMT		;Go transmit but don't
  3303	002430'01  415 03 0 07 000002 		XMOVEI T2,UNB.OF(XB)	; use the usual routine
  3304	002431'01  260 01 0 00 001372*		CALL DLLUNI		; ...
  3305	002432'01  254 00 0 00 002436'		IFSKP.
  3306	002433'01  350 00 0 06 000714 		  OPSTRM <AOS>,HCXMT,(HN);Increment host count
  3307	002434'01  350 00 0 12 000052 		  OPSTRM <AOS>,CCXMT,(CB);Increment per-server count
  3308	002435'01  254 00 0 00 002440'		ELSE.
  3309	002436'01  205 17 0 00 100000 		  SETZRO HNCIP,(HN)	;Release the lock
  3310	002437'01  412 17 0 06 000000 
  3311	002440'01				ENDIF.
  3312	002440'01  263 01 0 00 000000 		RET
  3313
  3314
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 71
LATSER	MAC	19-Aug-74 07:34		Message Transmit Routines

  3315
  3316
  3317					;CBKILL - Kill a circuit by releasing all slots and buffers
  3318					;
  3319					;Call:	CB/ address of the circuit block
  3320					;	CALL CBKILL
  3321					;	Normal return
  3322
  3323	002441'01  260 01 0 00 003372'	CBKILL:	CALL RELSBS		;Release all slots asssociated with this CB
  3324	002442'01  260 01 0 00 004250'		CALL RFXBFS		; Release all buffers on
  3325	002443'01  260 01 0 00 002465'		CALL MDLXBF		; free queue and mark all those in DLL
  3326					;	CALLRET CBDACT		;and move CB to the inactive queue
  3327
  3328					;CBDACT - Deactivate CB by moving to inactive queue
  3329					;
  3330					;Call:	CB/ address of the circuit block
  3331					;	CALL CBDACT
  3332					;	Normal return
  3333
  3334	002444'01  322 12 0 00 002174*	CBDACT:	JUMPE CB,RTN		;If there is no CB, don't do the following
  3335	002445'01  553 00 0 12 000002 		SETZRO CBRID,(CB)	;Clear remote circuit index
  3336	002446'01  201 02 0 00 000000 		MOVEI T1,CS.HLT		;If the current circuit state is not halted
  3337	002447'01  550 17 0 12 000024 		OPSTR <CAMN T1,>,CBSTA,(CB); move CB from active to inactive queue
  3338	002450'01  316 02 0 00 000017 
  3339	002451'01  263 01 0 00 000000 		RET			; otherwise CB is already on inactive queue
  3340	002452'01  542 02 0 12 000024 		STOR T1,CBSTA,(CB)	;Set the state to halted now
  3341	002453'01  415 02 0 06 000011 		XMOVEI T1,HN.QAC(HN)	;Remove 
  3342	002454'01  200 03 0 00 000012 		MOVE T2,CB		; the circuit block
  3343	002455'01  260 01 0 00 004145'		CALL LAUNQ		; from the active queue
  3344	002456'01  415 02 0 06 000013 		XMOVEI T1,HN.QIC(HN)	; and queue to 
  3345	002457'01  200 03 0 00 000012 		MOVE T2,CB		;Need the CB address again.
  3346	002460'01  260 01 0 00 004135'		CALL LAQUE		; the inactive queue
  3347	002461'01  550 17 0 06 000002 		OPSTRM <SOS>,HNNAC,(HN)	;Reduce the number of active circuits
  3348	002462'01  370 00 0 00 000017 
  3349	002463'01  542 17 0 06 000002 
  3350	002464'01  263 01 0 00 000000 		RET
  3351
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 72
LATSER	MAC	19-Aug-74 07:34		Message Transmit Routines

  3352
  3353					;MDLXBF - Remove all buffers from ACK Wait queue, and mark them
  3354					;		for deletion at transmit complete.
  3355					;
  3356					;Call:	CB/ circuit block address
  3357					;	CALL MDLXBF
  3358					;	Normal return
  3359					;
  3360
  3361	002465'01  553 00 0 12 000010 	MDLXBF:	SETZRO CBDLL,(CB)	;No buffers in DLL now
  3362	002466'01  415 02 0 12 000013 	MDLXB1:	XMOVEI T1,CB.AKQ(CB)	;Address of the ACK wait queue
  3363	002467'01  260 01 0 00 004164'		CALL UNQ1WF		;Unqueue next buffer on Q
  3364	002470'01  263 01 0 00 000000 		 RET			;Done
  3365	002471'01  201 02 0 00 000000 		MOVEI T1,0		;Mark buffer for freeing at xmit done
  3366	002472'01  250 02 0 03 000007 		EXCH T1,UN.UID+UNB.OF(T2) ;and get current "DLL" flag
  3367	002473'01  321 02 0 00 002466'		JUMPL T1,MDLXB1		;If in DLL, it will be freed at XMTDON
  3368	002474'01  200 07 0 00 000003 		MOVE XB,T2		; else we have to free it now.
  3369	002475'01  260 01 0 00 004262'		CALL RELXBH
  3370	002476'01  254 00 0 00 002466'		JRST MDLXB1
  3371
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 73
LATSER	MAC	19-Aug-74 07:34		Message Transmit Routines

  3372
  3373
  3374					;MTTSTP - transmit a STOP message ;
  3375					;Call:	T1/ stop reason code
  3376					;	XB/ address of transmit buffer
  3377					;	RB/ address of recieve buffer
  3378					;	CB/ address of circuit block (may be 0)
  3379					;	CALL MTTSTP
  3380					;	Normal return
  3381					;
  3382
  3383	002477'01  202 02 0 00 000000#	MTTSTP:	MOVEM T1,STPCOD		;Save the stop reason.
  3384	002500'01  322 12 0 00 002506'		JUMPE CB,MTTSP0		;If there is not CB, just send stop msg.
  3385	002501'01  542 02 0 12 000007 		STOR T1,CBERR,(CB)	;Store reason for the stop in the CB
  3386	002502'01  554 02 0 12 000002 		LOAD T1,CBRID,(CB)	;Get the id to which to send the STOP
  3387	002503'01  332 00 0 00 000002 		SKIPE T1	;If it is 0, assume MSGSID already contains correct ID
  3388								;This may prevent sending an illegal STOP with 0
  3389								;in the destination ID field.
  3390	002504'01  202 02 0 00 000000#		MOVEM T1,MSGSID		; and put where we want it below
  3391	002505'01  260 01 0 00 002441'		CALL CBKILL		;Free all circuit resources.
  3392					;
  3393					;	Here to actually send a stop message
  3394					;	Always get a temp xmit buffer.
  3395					;	Then send the message with a 0 in UNUID so that
  3396					;	XMTDON will always just release the buffer.
  3397					;
  3398	002506'01  335 00 0 06 000000 	MTTSP0:	SKIPGE HN.RUN(HN)	;If the NI is no longer running
  3399	002507'01  263 01 0 00 000000 		 RET			;We're done.
  3400	002510'01  201 02 0 00 000044 		MOVEI T1,SZMSTP		;There will be no buffers so get one
  3401	002511'01  260 01 0 00 004471'		CALL MMGTZW
  3402	002512'01  263 01 0 00 000000 		 RET			;Couldn't. Assume we did.
  3403	002513'01  200 07 0 00 000002 		MOVE XB,T1		;Transmit buffer for STOP message
  3404	002514'01  200 02 0 00 005031'		MOVX T1,<POINT 8,<XBF.OF>(XB)>;Byte pointer to start of msg
  3405	002515'01  202 02 0 07 000017 		STOR T1,UNBFA,+UNB.OF(XB);Store byte ptr to use building STOP msg
  3406	002516'01  201 02 0 00 000010 		MOVEI T1,MT.STP_2	;Message type (STOP) and number of slots (=0)
  3407	002517'01  260 01 0 00 002777'		CALL LAP2B0		; to message
  3408	002520'01  200 02 0 00 000000#		MOVE T1,MSGSID		;Get the source ID from the received message
  3409	002521'01  260 01 0 00 002777'		CALL LAP2B0		; and enter as destination ID to msg to send.
  3410	002522'01  201 02 0 00 000000 		MOVEI T1,0		;Get a 0 source ID
  3411	002523'01  260 01 0 00 002777'		CALL LAP2B0		; and enter into msg to send
  3412	002524'01  260 01 0 00 002777'		CALL LAP2B0		;Ack and sequence number must be zero also.
  3413	002525'01  200 02 0 00 000000#		MOVE T1,STPCOD		;Enter Disconnect reason and Reason text byte
  3414	002526'01  260 01 0 00 002777'		CALL LAP2B0		; (=0 since text field not used) to msg.
  3415	002527'01  415 02 0 07 000033 		XMOVEI T1,<XBF.OF>(XB)	;Set up 1 word global byte pointer
  3416	002530'01  661 02 0 00 540000 		TLO T1,(<OWGP. 8,0>)	; to the transmit data for NISRV
  3417	002531'01  202 02 0 07 000017 		STOR T1,UNBFA,+UNB.OF(XB); and store in UN block
  3418	002532'01  201 02 0 00 000056 		MOVEI T1,MINXBF		;Initialize to zero
  3419	002533'01  202 02 0 07 000016 		STOR T1,UNBSZ,+UNB.OF(XB); the message count
  3420	002534'01  254 00 0 00 002664'		CALLRET XMTMSN		;Go give the message to the DLL.
  3421									; It will be freed at XMTDON
  3422
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 74
LATSER	MAC	19-Aug-74 07:34		Message Transmit Routines

  3423
  3424
  3425					;MTTRUN - transmit a RUN message
  3426					;Call:	XB/ address of the transmit buffer
  3427					;	CALL MTTRUN
  3428					;	Normal return
  3429
  3430	002535'01  322 07 0 00 002444*	MTTRUN:	JUMPE XB,RTN		;No message to transmit
  3431	002536'01  415 02 0 12 000011 		XMOVEI T1,CB.XBQ(CB)	;Unqueue the transmit buffer
  3432	002537'01  260 01 0 00 004164'		CALL UNQ1WF		; from the free Q
  3433	002540'01  600 00 0 00 000000 		 NOP
  3434	002541'01  400 02 0 00 000000 		SETZ T1,		;No flag set yet
  3435	002542'01  336 00 0 12 000011 		SKIPN CB.XBQ(CB)	;Is this our last transmit buffer?
  3436	002543'01  205 02 0 00 400000 		  MOVX T1,CBRRF		;Yes, set flag
  3437	002544'01  437 02 0 12 000003 		IORB T1,CB.RRF(CB)	;Stuff flag and get result
  3438	002545'01  135 17 0 00 005032'		LOAD CX,RTXTIM		;Value for circuit timer
  3439	002546'01  603 02 0 00 400000 		TXNE T1,CBRRF		;Is flag set for any reason?
  3440	002547'01  506 17 0 12 000006 		  STOR CX,CBTIM,(CB)	;Yes, start circuit timer ticking.
  3441	002550'01  415 02 0 12 000013 		XMOVEI T1,CB.AKQ(CB)	; and queue to the end
  3442	002551'01  260 01 0 00 004156'		CALL QUE1WB		; of the ACK queue
  3443	002552'01  550 02 0 12 000004 		LOAD T1,CBTSQ,(CB)	;Get the transmit sequence number
  3444	002553'01  340 02 0 00 000000 		AOJ T1,			; and increment it by one before
  3445	002554'01  405 02 0 00 000377 		ANDI T1,377		;Counter is only 8 bits
  3446	002555'01  542 02 0 12 000004 		STOR T1,CBTSQ,(CB)	; using it in the next transmitted msg.
  3447	002556'01  200 02 0 00 005031'		MOVX T1,<POINT 8,<XBF.OF>(XB)>;Set message pointer to point to
  3448	002557'01  202 02 0 07 000017 		STOR T1,UNBFA,+UNB.OF(XB); the RUN message header.
  3449	002560'01  201 02 0 00 000000 		MOVEI T1,MT.RUN_2	;Message type for the header.
  3450	002561'01  260 01 0 00 002643'		CALL BMSGHD		;Build the message header
  3451	002562'01  201 02 0 00 000010 		MOVEI T1,SZ.MHD		;Store the message header length
  3452	002563'01  336 00 0 07 000025 		SKIPN MD.NXT+MDB.OF(XB); which if there is no slot data
  3453	002564'01  201 02 0 00 000056 		MOVEI T1,MINXBF		; must be the minimum NI datagram size.
  3454	002565'01  202 02 0 07 000030 		STOR T1,MDBYT,+MDB.OF(XB); in the appropriate place
  3455	002566'01  402 00 0 07 000016 		SETZRO UNBSZ,+UNB.OF(XB);MBZ for MSD type transmits
  3456	002567'01  415 02 0 07 000025 		XMOVEI T1,<MDB.OF>(XB)	;Address of the first MSD block
  3457	002570'01  202 02 0 07 000017 		STOR T1,UNBFA,+UNB.OF(XB);stored where usually byte pointer goes.
  3458	002571'01  260 01 0 00 002665'		CALL XMTMSG		;No, go transmit a single buffer XB
  3459	002572'01  263 01 0 00 000000 		RET
  3460
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 75
LATSER	MAC	19-Aug-74 07:34		Message Transmit Routines

  3461
  3462
  3463					;TMRCHK - Host circuit timer check routine.  This routine performs actions
  3464					; base on the state of the circuit timer.
  3465					;Call:	CB/ circuit block address
  3466					;Return:
  3467					;	RET - no further action required for this circuit
  3468					;	RESKSP - continue processing
  3469
  3470	002573'01  554 17 0 12 000006 	TMRCHK:	OPSTR <SKIPN T1,>,CBTIM,(CB);Is the circuit timer running?
  3471	002574'01  336 02 0 00 000017 
  3472	002575'01  254 00 0 00 002346*		RETSKP			;No, continue processing circuit
  3473	002576'01  372 00 0 00 000002 		SOSE T1			;Decrement the timer.
  3474	002577'01  254 00 0 00 002612'		IFSKP.			;Circuit timer has expired.
  3475	002600'01  554 02 0 06 000005 		  LOAD T1,HNRLI,(HN)	;Get the retransmit limit.
  3476	002601'01  550 17 0 12 000006 		  OPSTR <CAMG T1,>,CBRTC,(CB);Have we reached the limit?
  3477	002602'01  317 02 0 00 000017 
  3478	002603'01  254 00 0 00 002610'		  IFSKP.		;No, so
  3479	002604'01  260 01 0 00 002614'		    CALL XUNAKQ		; and retransmit the unack queue
  3480	002605'01  135 02 0 00 005032'		    LOAD T1,RTXTIM	; Reset the timer
  3481	002606'01  506 02 0 12 000006 		    STOR T1,CBTIM,(CB)	; in the circuit block
  3482	002607'01  254 00 0 00 002611'		  ELSE.
  3483	002610'01  265 03 0 00 002373'		    JSP T2,XMTLIM	; otherwise, terminate the circuit
  3484	002611'01				  ENDIF.		; cause communication broken with remote.
  3485	002611'01  263 01 0 00 000000 		  RET
  3486	002612'01				ENDIF.
  3487	002612'01  506 02 0 12 000006 		STOR T1,CBTIM,(CB)	;Restore decremented timer to CB
  3488	002613'01  254 00 0 00 002575*		RETSKP
  3489	
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 76
LATSER	MAC	19-Aug-74 07:34		Message Transmit Routines

  3490
  3491
  3492					;XUNAKQ - Transmit all messages on the unacknowledged queue
  3493
  3494	002614'01  554 17 0 12 000010 	XUNAKQ:	OPSTR <SKIPN>,CBDLL,(CB);Don't retransmit if already transmitting
  3495	002615'01  336 00 0 00 000017 
  3496	002616'01  336 07 0 12 000013 		OPSTR <SKIPN XB,>,QLFWD,+CB.AKQ(CB) ;First msg to retransmit
  3497	002617'01  263 01 0 00 000000 		RET			;Should be
  3498	002620'01  350 00 0 06 000715 		OPSTRM <AOS>,HCRTR,(HN)	;Increment host count
  3499	002621'01  350 00 0 12 000053 		OPSTRM <AOS>,CCRTR,(CB)	; and per-server count
  3500	002622'01  550 17 0 12 000006 		OPSTRM <AOS>,CBRTC,(CB)	;Increment retransmit count
  3501	002623'01  350 00 0 00 000017 
  3502	002624'01  542 17 0 12 000006 
  3503	002625'01  554 17 0 12 000010 	XMTALL:	OPSTRM <AOS>,CBDLL,(CB)	;Increment buffers in DLL
  3504	002626'01  350 00 0 00 000017 
  3505	002627'01  506 17 0 12 000010 
  3506	002630'01  201 02 0 00 000004 		MOVX T1,NU.XMT		;Transmit function
  3507	002631'01  415 03 0 07 000002 		XMOVEI T2,UNB.OF(XB)	;UN block
  3508	002632'01  260 01 0 00 002431*		CALL DLLUNI
  3509	002633'01  604 00 0 00 000000 		IFNSK.
  3510	002634'01  254 00 0 00 002640'
  3511	002635'01  554 17 0 12 000010 		  OPSTRM <SOS>,CBDLL,(CB)
  3512	002636'01  370 00 0 00 000017 
  3513	002637'01  506 17 0 12 000010 
  3514	002640'01				ENDIF.
  3515	002640'01  332 07 0 07 000000 		SKIPE XB,UE.LW0(XB)	;Next XB on queue to (re)transmit
  3516	002641'01  254 00 0 00 002625'		JRST XMTALL		;Still more, continue to give buffers to DLL
  3517	002642'01  263 01 0 00 000000 		RET
  3518
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 77
LATSER	MAC	19-Aug-74 07:34		Message Transmit Routines

  3519
  3520
  3521					; BMSGHD - Build a LAT Virtual Circuit Message Header
  3522
  3523					;Call:	T1/ <Message type>_2
  3524					;	XB/ Message buffer address
  3525					;	CB/ Address of the Circuit Block
  3526
  3527	002643'01  200 03 0 00 000000#	BMSGHD:	MOVE T2,NSLOTS		;Number of slots in message
  3528	002644'01  242 03 0 00 000010 		LSH T2,^D8		;Shift to left byte position
  3529	002645'01  434 02 0 00 000003 		IOR T1,T2		;Or in message type (shifted)
  3530	002646'01  135 17 0 00 005033'		OPSTR <SKIPE>,CBRRF,(CB);If the Reply Request Flag is set
  3531	002647'01  332 00 0 00 000017 
  3532	002650'01  435 02 0 00 000001 		IORI T1,1		; set it in message header
  3533	002651'01  260 01 0 00 002777'		CALL LAP2B0		;Enter as 1st 2 bytes of header
  3534	002652'01  554 02 0 12 000002 		LOAD T1,CBRID,(CB)	;Get the remote's circuit index
  3535	002653'01  260 01 0 00 002777'		CALL LAP2B0		; and enter as 2 byte field
  3536	002654'01  550 02 0 12 000002 		LOAD T1,CBLID,(CB)	;Get our circuit index
  3537	002655'01  260 01 0 00 002777'		CALL LAP2B0		; and enter as 2 byte field
  3538	002656'01  554 02 0 12 000005 		LOAD T1,CBRSQ,(CB)	;ACK number
  3539	002657'01  242 02 0 00 000010 		LSH T1,^D8		;Shift to left byte position
  3540	002660'01  550 03 0 12 000004 		LOAD T2,CBTSQ,(CB)	;Send Seq Number
  3541	002661'01  434 02 0 00 000003 		IOR T1,T2
  3542	002662'01  260 01 0 00 002777'		CALL LAP2B0
  3543	002663'01  263 01 0 00 000000 		RET	
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 78
LATSER	MAC	19-Aug-74 07:34		Message Transmitter - XMTMSG

  3544						SUBTTL	Message Transmitter - XMTMSG
  3545
  3546					;
  3547					;XMTMSG - Transmit a LAT Message
  3548					;
  3549					;Call:	CB/ 0 or Circuit Block Address
  3550					;	XB/ Address of the UN block/Transmit Buffer
  3551					;	RB/ Address of Receive Buffer if XB/0
  3552					;	UNBSZ/ Message byte count
  3553					;	CALL XMTMSG
  3554					;	Normal Return
  3555					;
  3556					; This routine sets up the UN block for NISRV and issues the transmit
  3557					; function.  Only UNBSZ must be set by the caller.  If there is no CB,
  3558					; the information is taken from the receive buffer, otherwise from the
  3559					; circuit block.
  3560					;
  3561					;If there is no possibility of an ACK (such as sending a STOP message),
  3562					; then call XMTMSN, which will set UNUID to 0 so that the buffer will
  3563					; just be returned to free memory after NISRV has sent it.
  3564					;
  3565
  3566	002664'01  634 02 0 00 000002 	XMTMSN:	TDZA T1,T1		;Enter here if you just want to free the buffer
  3567									;  when transmit is done.
  3568	002665'01  200 02 0 00 000012 	XMTMSG:	MOVE T1,CB
  3569	002666'01  661 02 0 00 400000 		TLO T1,DLL.FL		;set "buffer-in-DLL" flag
  3570	002667'01  202 02 0 07 000007 		STOR T1,UNUID,+UNB.OF(XB);Save the CB address for completion action
  3571	002670'01  322 12 0 00 002677'		JUMPE CB,XMNOCB		;Case with no assigned circuit block
  3572	002671'01  200 02 0 06 000021 		LOAD T1,HNPID,(HN)	;Portal ID
  3573	002672'01  120 03 0 12 000017 		OPSTR <DMOVE T2,>,CBDNI,(CB) ;Get destination NI adr from CB
  3574	002673'01  554 17 0 12 000010 		OPSTRM <AOS>,CBDLL,(CB) ;Increment # buffers in the DLL
  3575	002674'01  350 00 0 00 000017 
  3576	002675'01  506 17 0 12 000010 
  3577	002676'01  254 00 0 00 002701'		JRST XMTMS0		;Go do common code
  3578	002677'01  200 02 0 11 000002 	XMNOCB:	LOAD T1,UNPID,+UNB.OF(RB);Get the portal ID
  3579	002700'01  120 03 0 11 000014 		OPSTR <DMOVE T2,>,UNSAD,+UNB.OF(RB) ;Source NI address from recvd msg
  3580	002701'01  202 02 0 07 000002 	XMTMS0:	STOR T1,UNPID,+UNB.OF(XB);Store in xmit buffer
  3581	002702'01  124 03 0 07 000012 		OPSTRM <DMOVEM T2,>,UNDAD,+UNB.OF(XB) ; to the xmit buffer
  3582	002703'01  202 07 0 07 000004 		STOR XB,UNRID,+UNB.OF(XB);Remember the buffer address
  3583	002704'01  201 02 0 00 000000 		MOVEI T1,UNA.EV
  3584	002705'01  137 02 0 00 005034'		STOR T1,UNADS,+UNB.OF(XB);Tell NISRV we are using EXEC virtual memory
  3585	002706'01  201 02 0 00 000004 		MOVX T1,NU.XMT		;NI transmit function code
  3586	002707'01  415 03 0 07 000002 		XMOVEI T2,UNB.OF(XB)	;UN block address
  3587	002710'01  260 01 0 00 002632*		CALL DLLUNI
  3588	002711'01  254 00 0 00 002716'		 JRST XMTMS1		;Function failed, clean up
  3589	002712'01  350 00 0 06 000714 		OPSTRM <AOS>,HCXMT,(HN) ;Count total messages transmitted
  3590	002713'01  322 12 0 00 002535*		JUMPE CB,RTN		;and if there is a CB,
  3591	002714'01  350 00 0 12 000052 		OPSTRM <AOS>,CCXMT,(CB) ;count messages xmitted on that circuit
  3592	002715'01  263 01 0 00 000000 		RET
  3593	002716'01  205 02 0 00 400000 	XMTMS1:	MOVSI T1,DLL.FL	;get "buffer-in-DLL" flag
  3594	002717'01  413 02 0 07 000007 		ANDCAB T1,UN.UID+UNB.OF(XB) ;clear it in message
  3595	002720'01  322 02 0 00 004262'		JUMPE T1,RELXBH	;If no CB for this one, just return buffer
  3596	002721'01  554 17 0 12 000010 	 	OPSTRM <SOS>,CBDLL,(CB);Failed so put back count where is was
  3597	002722'01  370 00 0 00 000017 
  3598	002723'01  506 17 0 12 000010 
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 78-1
LATSER	MAC	19-Aug-74 07:34		Message Transmitter - XMTMSG

  3599	002724'01  263 01 0 00 000000 		RET
  3600
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 79
LATSER	MAC	19-Aug-74 07:34		Message Transmitter - XMTDON

  3601						SUBTTL	Message Transmitter - XMTDON
  3602
  3603					;XMTDON - Message Transmitter Transmit Done Scheduler Level Routine
  3604					;
  3605					;Call:	T1/ NU.XMT
  3606					;	T2/ UN block address
  3607					;	CALL XMTDON
  3608					;	Normal return
  3609					;
  3610					;  If the UNRID is zero, there is no longer a CB for this buffer because the
  3611					; circuit went away and we don't care what happens at transmit complete.  Just
  3612					; release the buffer.  If the CB state is stopping, complete the stopping of
  3613					; the circuit which could not be done earlier because all xmit buffers were in
  3614					; the DLL.
  3615
  3616	002725'01  265 17 0 00 005035'	XMTDON:	SAVEAC <CB>
  3617	002726'01  200 07 0 00 000003 		MOVE XB,T2		;Move transmit buffer adr to conventional AC.
  3618	002727'01  205 12 0 00 400000 		MOVSI CB,DLL.FL		;Get "buffer-in-DLL" flag
  3619	002730'01  413 12 0 03 000007 		ANDCAB CB,UN.UID+UNB.OF(T2) ;Clear it and load result
  3620	002731'01  322 12 0 00 004262'		JUMPE CB,RELXBH	;If there is no CB, release buffer and header and return
  3621	002732'01  554 17 0 12 000010 		OPSTRM <SOS>,CBDLL,(CB)	;One less buffer in the DLL
  3622	002733'01  370 00 0 00 000017 
  3623	002734'01  506 17 0 12 000010 
  3624	002735'01  263 01 0 00 000000 		RET
  3625
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 80
LATSER	MAC	19-Aug-74 07:34		- Receive Message Handling Routines

  3626						SUBTTL - Receive Message Handling Routines
  3627
  3628					;LAG2BY - obtains two bytes from the message which is assumed to be a 16-bit
  3629					; quantity.
  3630					;
  3631					;Call:	MA/ Message base address
  3632					;	CALL LAG2BY
  3633					;	Normal Return
  3634					;Changes T2
  3635					;	T1/ 16-bit quantity
  3636
  3637	002736'01  561 02 0 00 777776 	LAG2BY:	MOVX T1,-2		;Amount to decrement the count by
  3638	002737'01  272 02 0 11 000016 		OPSTR <ADDM T1,>,UNBSZ,+UNB.OF(RB);Update message count
  3639	002740'01  134 02 0 11 000017 		OPSTR <ILDB T1,>,UNBFA,+UNB.OF(RB);Get low order byte
  3640	002741'01  134 03 0 11 000017 		OPSTR <ILDB T2,>,UNBFA,+UNB.OF(RB);Get high order byte
  3641	002742'01  242 03 0 00 000010 		LSH	T2,^D8		;Shift high order byte left
  3642	002743'01  434 02 0 00 000003 		IOR	T1,T2		;Make a 16-bit quantity
  3643	002744'01  263 01 0 00 000000 		RET			;Return with result
  3644
  3645					;GTCSTR - Move Counted String from a Message
  3646					;
  3647					;Call:	T1/ Maximum count to move
  3648					;	T2/ Destination byte pointer for string
  3649					;	RB/ Message base address
  3650					;Changes T1,T2,T3,T4
  3651
  3652	002745'01  400 02 0 00 000000 	IGCSTR:	SETZ T1,		;Here to ignore a counted string
  3653	002746'01  265 17 0 00 005043'	GTCSTR:	SAVEAC <W1,W2>		;Get two work registers
  3654	002747'01  336 04 0 11 000016 		OPSTR <SKIPN T3,>,UNBSZ,+UNB.OF(RB);Byte count left in message
  3655	002750'01  263 01 0 00 000000 		RET			;Return error. Message unexpectedly truncated
  3656	002751'01  134 14 0 11 000017 		OPSTR <ILDB W1,>,UNBFA,+UNB.OF(RB);Count of the counted string
  3657	002752'01  275 04 0 14 000001 		SUBI T3,1(W1)		;Calculate new residual message count
  3658	002753'01  321 04 0 00 002713*		JUMPL T3,RTN		;Message truncated
  3659	002754'01  202 04 0 11 000016 		STOR T3,UNBSZ,+UNB.OF(RB);Store back into message header
  3660	002755'01  332 00 0 00 000014 		SKIPE W1		;A null string?
  3661	002756'01  254 00 0 00 002761'		IFSKP.
  3662	002757'01  201 02 0 00 000000 		  MOVEI T1,0		;Yes, return zero count
  3663	002760'01  254 00 0 00 002613*		  RETSKP		; successfully
  3664	002761'01				ENDIF.
  3665	002761'01  200 04 0 00 000014 		MOVE T3,W1		;Copy of the actual string count
  3666	002762'01  313 04 0 00 000002 		CAMLE T3,T1		;Get the minimum of (actual string count,
  3667	002763'01  200 04 0 00 000002 		MOVE T3,T1		; maximum string count) for copy loop index
  3668	002764'01  202 04 0 00 000002 		MOVEM T3,T1		; and store as actual count copied
  3669	002765'01  200 05 0 11 000017 		LOAD T4,UNBFA,+UNB.OF(RB);Save initial value of byte pointer
  3670	002766'01  322 02 0 00 002772'		JUMPE T1,GTCDON		;Skipping over this field
  3671	002767'01  134 15 0 11 000017 	GTCSLP: OPSTR <ILDB W2,>,UNBFA,+UNB.OF(RB);Fetch a source byte
  3672	002770'01  136 15 0 00 000003 		IDPB W2,T2		;Store as destination byte
  3673	002771'01  366 04 0 00 002767'		SOJN T3,GTCSLP		;Loop till all bytes copied
  3674	002772'01  133 14 0 00 000005 	GTCDON:	ADJBP W1,T4		;Adjust byte pointer properly in case less than
  3675	002773'01  202 14 0 11 000017 		STOR W1,UNBFA,+UNB.OF(RB); the full string was copied
  3676	002774'01  254 00 0 00 002760*		RETSKP			;Return success, T1/ count of string fetched
  3677
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 81
LATSER	MAC	19-Aug-74 07:34		- Transmit Message Handling Routines

  3678						SUBTTL - Transmit Message Handling Routines
  3679
  3680					;LAP2BY - Put 2 bytes to message
  3681					;
  3682					;Call:	XB/ Address of the transmit buffer
  3683					;	T1/ 16-bit quantity to ouput
  3684					;	CALL LAP2BY or CALL LAP2B0
  3685					;	Normal return
  3686					;T1 perserved, T2 used
  3687					;
  3688					; This routine enters a 16-bit quantity as two bytes from T1 into the transmit
  3689					; buffer with the least significant entered first.  It assumes that UNBFA is
  3690					; set up with the proper byte pointer to the message buffer. The alternate
  3691					; entry LAP2B0 differs from LAP2BY in that LAP2B0 does not increment the
  3692					; message byte count whereas LAP2BY does.
  3693
  3694	002775'01  201 03 0 00 000002 	LAP2BY:	MOVEI T2,2		;Amount to increment the message count by
  3695	002776'01  272 03 0 07 000016 		OPSTRM <ADDM T2,>,UNBSZ,+UNB.OF(XB);Update the count in message header
  3696	002777'01  200 03 0 00 000002 	LAP2B0:	MOVE T2,T1		;In order to return T1 preserved.
  3697	003000'01  136 03 0 07 000017 		OPSTR <IDPB T2,>,UNBFA,+UNB.OF(XB);Low order byte entered first
  3698	003001'01  242 03 0 00 777770 		LSH T2,-^D8		;Shift hi byte into position
  3699	003002'01  136 03 0 07 000017 		OPSTR <IDPB T2,>,UNBFA,+UNB.OF(XB);High order byte goes to b buffer
  3700	003003'01  263 01 0 00 000000 		RET
  3701
  3702					;
  3703					;PTCSTR - put counted string to message buffer
  3704					;
  3705					;Call:	XB/ Address of the transmit buffer
  3706					;	T1/ Count to enter into buffer
  3707					;	T2/ Source string byte pointer
  3708
  3709	003004'01  201 04 0 02 000001 	PTCSTR:	MOVEI T3,1(T1)		;Increment to include count byte
  3710	003005'01  272 04 0 07 000016 		OPSTRM <ADDM T3,>,UNBSZ,+UNB.OF(XB);Increment count in buffer
  3711	003006'01  136 02 0 07 000017 	PTCST0:	OPSTR <IDPB T1,>,UNBFA,+UNB.OF(XB);Put the string count to buffer
  3712	003007'01  200 04 0 00 000002 		MOVE T3,T1		;Save copy of count for decrementing
  3713	003010'01  322 04 0 00 002753*	PTCSTL:	JUMPE T3,RTN		;If count exhausted, done with copying
  3714	003011'01  134 05 0 00 000003 		ILDB T4,T2		;Get the next source string byte
  3715	003012'01  136 05 0 07 000017 		OPSTR <IDPB T4,>,UNBFA,+UNB.OF(XB);Put it to buffer
  3716	003013'01  364 04 0 00 003010'		SOJA T3,PTCSTL		;Continue til string count zero
  3717
  3718					;
  3719					;PTUSTR - put uncounted string to message buffer
  3720					;
  3721					;Call:	XB/ Address of the transmit buffer
  3722					;	T1/ Count to enter into buffer
  3723					;	T2/ Source string byte pointer
  3724
  3725	003014'01  272 02 0 07 000016 	PTUSTR:	OPSTRM <ADDM T1,>,UNBSZ,+UNB.OF(XB);Increment count in buffer
  3726	003015'01  200 04 0 00 000002 		MOVE T3,T1		;Save copy of count for decrementing
  3727	003016'01  322 04 0 00 003010*	PTUSTL:	JUMPE T3,RTN		;If count exhausted, done with copying
  3728	003017'01  134 05 0 00 000003 		ILDB T4,T2		;Get the next source string byte
  3729	003020'01  136 05 0 07 000017 		OPSTR <IDPB T4,>,UNBFA,+UNB.OF(XB);Put it to buffer
  3730	003021'01  364 04 0 00 003016'		SOJA T3,PTUSTL		;Continue til string count zero
  3731
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 82
LATSER	MAC	19-Aug-74 07:34		- Transmit Message Handling Routines

  3732
  3733
  3734					;RBPOST - Return Receive Buffer to DLL
  3735					;
  3736					;Call:	T1/ Message block address
  3737					;	CALL RBPOST
  3738					;	Normal Return
  3739					;
  3740					;Call at RBPOSS if you need to preserve T1-T4
  3741
  3742	003022'01  260 01 0 00 000000*	RBPOSS:	CALL SAVT##	;Preserve T1-T4
  3743	003023'01  201 03 0 00 002740 	RBPOST:	MOVEI T2,LMRFSI		;Size of the buffer
  3744	003024'01  202 03 0 02 000016 		STOR T2,UNBSZ,+UNB.OF(T1);Store in UN block for NISRV
  3745	003025'01  415 03 0 02 000025 		XMOVEI T2,<SBF.OF>(T1) ;Set up 1 word global byte pointer
  3746	003026'01  661 03 0 00 540000 		TLO T2,(<OWGP. 8,0>)	; to the transmit data for NISRV
  3747	003027'01  202 02 0 02 000004 		STOR T1,UNRID,+UNB.OF(T1);Store the buffer address for callback
  3748	003030'01  202 03 0 02 000017 		STOR T2,UNBFA,+UNB.OF(T1); and store in UN block
  3749	003031'01  200 03 0 06 000021 		LOAD T2,HNPID,(HN)	;Get the Portal ID for NISRV
  3750	003032'01  202 03 0 02 000002 		STOR T2,UNPID,+UNB.OF(T1)
  3751	003033'01  201 03 0 00 000000 		MOVEI T2,UNA.EV
  3752	003034'01  137 03 0 00 005053'		STOR T2,UNADS,+UNB.OF(T1);Tell NISRV we are using EXEC virtual memory
  3753	003035'01  415 03 0 02 000002 		XMOVEI T2,UNB.OF(T1)	;UN block address
  3754	003036'01  201 02 0 00 000003 		MOVX T1,NU.RCV		;Post receive buffer function code
  3755	003037'01  254 00 0 00 002710*		CALLRET DLLUNI		;Do it and return +1 or +2 to caller
  3756
  3757					repeat 0,<
  3758						IFNSK.
  3759						  BUG. (CHK,LAPRBF,LATSER,SOFT,<Specify Receive Buffer Failure>,<<T1,DLLERC>>,<
  3760					LATSER received an error from NISRV while attempting to post a receive buffer>)
  3761						  RET
  3762						ENDIF.
  3763						RETSKP
  3764					> ;end repeat 0
  3765
  3766
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 83
LATSER	MAC	19-Aug-74 07:34		Slot Demultiplexor - LSDMUX

  3767						SUBTTL	Slot Demultiplexor - LSDMUX
  3768
  3769					;
  3770					;LSDMUX - Process all slots in a received RUN message
  3771					;
  3772					;Call:	RB/ Address of RUN message
  3773					;	CALL LSDMUX
  3774					;	 Error return - illegal slot encountered
  3775					;	Normal return
  3776
  3777		   	   000000		MIN. (MINSTY,<ST.DTA,ST.STA,ST.STP,ST.DTB,ST.ATT,ST.REJ>) ;Minimum slot type code
  3778		   	   000015		MAX. (MAXSTY,<ST.DTA,ST.STA,ST.STP,ST.DTB,ST.ATT,ST.REJ>) ;Maximum slot type code
  3779
  3780	003040'01			LSDMUX:	
  3781					IFN FTOPS20,<
  3782						TRVAR <SLTDID,SLTSID,SLTCNT,SLTTYP,SLTEPT> ;Assign some variables on stack
  3783					>; END IFN FTOPS20
  3784	003040'01  336 02 0 00 000000#		SKIPN T1,NSLOTS		;Any slots left to process?
  3785	003041'01  254 00 0 00 002774*		RETSKP			;No, return successfully
  3786	003042'01  134 03 0 11 000017 	NXTSLT:	OPSTR <ILDB T2,>,UNBFA,+UNB.OF(RB);Get the destination id
  3787	003043'01  202 03 0 00 000000#		MOVEM T2,SLTDID
  3788	003044'01  134 03 0 11 000017 		OPSTR <ILDB T2,>,UNBFA,+UNB.OF(RB);Get the source id
  3789	003045'01  202 03 0 00 000000#		MOVEM T2,SLTSID
  3790	003046'01  134 03 0 11 000017 		OPSTR <ILDB T2,>,UNBFA,+UNB.OF(RB);Get the slot count
  3791	003047'01  202 03 0 00 000000#		MOVEM T2,SLTCNT
  3792	003050'01  200 04 0 11 000016 		LOAD T3,UNBSZ,+UNB.OF(RB);Get the current message count
  3793	003051'01  350 02 0 00 000003 		AOS T1,T2		;Round up to nearest even number
  3794	003052'01  620 02 0 00 000001 		TRZ T1,1		;Since there may be 1 pad byte in slot
  3795	003053'01  275 04 0 02 000004 		SUBI T3,SLHDSZ(T1)	;Subtract the total slot size
  3796	003054'01  202 04 0 11 000016 		STOR T3,UNBSZ,+UNB.OF(RB);Store back in msg header as updated msg count
  3797	003055'01  321 04 0 00 004132'		JUMPL T3,ILLSLT		;Error if message has ended prematurely
  3798	003056'01  134 03 0 11 000017 		OPSTR <ILDB T2,>,UNBFA,+UNB.OF(RB);Get the slot type/credits/reason
  3799	003057'01  202 03 0 00 000000#		MOVEM T2,SLTTYP		;and save it
  3800	003060'01  133 02 0 11 000017 		ADJBP T1,UN.BFA+UNB.OF(RB) ;Point to next slot
  3801	003061'01  202 02 0 00 000000#		MOVEM T1,SLTEPT		;In case we need to skip later
  3802	003062'01  242 03 0 00 777774 		LSH T2,-4		;Shift off the credits field
  3803	003063'01  301 03 0 00 000000 		CAIL T2,MINSTY		;Range check slot type
  3804	003064'01  303 03 0 00 000015 		CAILE T2,MAXSTY
  3805	003065'01  254 00 0 00 004132'		CALLRET ILLSLT		;Slot ID out of range, illegal slot
  3806	003066'01  260 01 1 03 003075'		CALL @SLTDSP-MINSTY(T2)	;Dispatch to proper routine
  3807	003067'01  254 00 0 00 004132'		 JRST ILLSLT
  3808	003070'01  377 00 0 00 000000#		SOSG NSLOTS		;Indicate one less slot to process
  3809	003071'01  254 00 0 00 003041*		RETSKP			;Count went to zero, so done.
  3810	003072'01  200 02 0 00 000000#		MOVE T1,SLTEPT		;Get pointer to next slot's data
  3811	003073'01  202 02 0 11 000017 		MOVEM T1,UN.BFA+UNB.OF(RB) ;and force pointer to there
  3812	003074'01  254 00 0 00 003042'		JRST NXTSLT		;Still some left, go do next
  3813
  3814					SLTDSP:	REPEAT <MAXSTY-MINSTY+1>,<
  3815	003075'01  400 00 0 00 004132'		IFIW	ILLSLT>
  3816	003076'01  400 00 0 00 004132'
  3817	003077'01  400 00 0 00 004132'
  3818	003100'01  400 00 0 00 004132'
  3819	003101'01  400 00 0 00 004132'
  3820	003102'01  400 00 0 00 004132'
  3821	003103'01  400 00 0 00 004132'
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 83-1
LATSER	MAC	19-Aug-74 07:34		Slot Demultiplexor - LSDMUX

  3822	003104'01  400 00 0 00 004132'
  3823	003105'01  400 00 0 00 004132'
  3824	003106'01  400 00 0 00 004132'
  3825	003107'01  400 00 0 00 004132'
  3826	003110'01  400 00 0 00 004132'
  3827	003111'01  400 00 0 00 004132'
  3828	003112'01  400 00 0 00 004132'			;Catch undefined slot types
  3829
  3830	003075'01  400 00 0 00 003233'		LHDSP. (SLTDSP,ST.DTA-MINSTY,HSDATA)
  3831	003107'01  400 00 0 00 003244'		LHDSP. (SLTDSP,ST.DTB-MINSTY,HSDATB)
  3832	003106'01  400 00 0 00 003113'		LHDSP. (SLTDSP,ST.STA-MINSTY,HSSTRT)
  3833	003110'01  400 00 0 00 004130'		LHDSP. (SLTDSP,ST.ATT-MINSTY,IGNSLT)
  3834	003111'01  400 00 0 00 004132'		LHDSP. (SLTDSP,ST.REJ-MINSTY,ILLSLT)
  3835	003112'01  400 00 0 00 003217'		LHDSP. (SLTDSP,ST.STP-MINSTY,HSSTOP)
  3836
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 84
LATSER	MAC	19-Aug-74 07:34		

  3837					 	SUBTTL
  3838
  3839					;HSSTRT  Process a received START slot
  3840					;
  3841					;Call:
  3842					;	CALL HSSTRT
  3843					;	 Error Return - Terminate slot loop
  3844					;	Normal Return - Continue to next slot
  3845					;
  3846
  3847	003113'01  332 00 0 00 000000#	HSSTRT:	SKIPE SLTSID		;Source ID 0 is illegal
  3848	003114'01  332 00 0 00 000000#		SKIPE SLTDID		;Destination ID of non-0 is illegal
  3849	003115'01  254 00 0 00 004132'		CALLRET ILLSLT		;Report an illegal slot received
  3850	003116'01  134 03 0 11 000017 		OPSTR <ILDB T2,>,UNBFA,+UNB.OF(RB);Get the service class requested
  3851	003117'01  302 03 0 00 000001 		CAIE T2,SCITTY		;Only interactive terminal class permitted
  3852	003120'01  254 00 0 00 004132'		CALLRET ILLSLT		;If not, slot is illegal.
  3853	003121'01  260 01 0 00 003303'		CALL SBALOC		;Allocate a slot block
  3854	003122'01  254 00 0 00 003071*		 RETSKP			;Ignore since server should persist and we
  3855									; assume we should almost always get an SB
  3856	003123'01  134 03 0 11 000017 		OPSTR <ILDB T2,>,UNBFA,+UNB.OF(RB);Attention slot size maximum
  3857	003124'01  542 03 0 13 000002 		STOR T2,SBATS,(SB)
  3858	003125'01  134 03 0 11 000017 		OPSTR <ILDB T2,>,UNBFA,+UNB.OF(RB);Data slot size maximum
  3859	003126'01  506 03 0 13 000003 		STOR T2,SBMDS,(SB)
  3860	003127'01  200 02 0 00 000000#		MOVE T1,SLTCNT		;Get slot data count
  3861	003130'01  275 02 0 00 000003 		SUBI T1,3		;Account for the 3 bytes already read
  3862	003131'01  250 02 0 11 000016 		EXCH T1,UN.BSZ+UNB.OF(RB) ;Put it where it's useful for GTCSTR
  3863	003132'01  261 01 0 00 000002 		PUSH P,T1		;and save real message byte count
  3864	003133'01  201 02 0 00 000020 		MOVEI T1,ML.SNM		;Max length of service name
  3865	003134'01  200 03 0 00 005054'		MOVX T2,<POINT 7,<SB.SNM>(SB)> ;Point to slot name string
  3866	003135'01  260 01 0 00 002746'		CALL GTCSTR		;Get a counted string
  3867	003136'01  400 02 0 00 000000 		  SETZ T1,		;Ran out of message
  3868	003137'01  542 02 0 13 000006 		STOR T1,SBSNC,(SB)	;Store actual length of name
  3869	003140'01  260 01 0 00 002745'		CALL IGCSTR		;Ignore the subject service name
  3870	003141'01  254 00 0 00 003152'		  JRST HSSTR3		;No more data in message
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 85
LATSER	MAC	19-Aug-74 07:34		

  3871
  3872					;
  3873					; Now we are into the variable parameter part of a START SLOT
  3874					; Loop and record whatever fields we think are important.
  3875					;
  3876	003142'01  371 02 0 11 000016 	HSSTR1:	SOSL T1,UN.BSZ+UNB.OF(RB)	;Count down bytes in slot
  3877	003143'01  134 02 0 11 000017 		ILDB T1,UN.BFA+UNB.OF(RB)	;Get Parameter number
  3878	003144'01  323 02 0 00 003152'		JUMPLE T1,HSSTR3	;Either ran out of bytes, or hit end of parms
  3879	003145'01  303 02 0 00 000005 		CAILE T1,SBPRMX		;Greater than max parm we know about?
  3880	003146'01  400 02 0 00 000000 		 SETZ T1,		;Yes, we will just ignore it.
  3881	003147'01  260 01 1 02 003173'		PUSHJ P,@SBPRTB(T1)	;Call routine to deal with parameter
  3882	003150'01  254 00 0 00 003152'		 JRST HSSTR3		;Ran out of message
  3883	003151'01  254 00 0 00 003142'		JRST HSSTR1		;Get next parameter from slot
  3884	003152'01  262 01 0 00 000002 	HSSTR3:	POP P,T1		;Restore real message byte count
  3885	003153'01  250 02 0 11 000016 		EXCH T1,UN.BSZ+UNB.OF(RB) ;to its rightful place
  3886	003154'01  202 02 0 00 000000#		MOVEM T1,SLTCNT		;And put new remaining slot count where it goes
  3887
  3888					IFN FTOPS10,<
  3889					;First, check to see if remote TTYs can connect
  3890
  3891	003155'01  200 02 0 00 000000*		MOVE T1,STATES##	;Get system states word
  3892	003156'01  602 02 0 00 000010 		TRNE T1,ST.NRT		;Are remote TTYs allowed?
  3893	003157'01  254 00 0 00 003165'		 JRST SLSHUT		;Nope, reject the connection
  3894					> ;end IFN FTOPS10
  3895	003160'01  260 01 0 00 003443'		CALL GETTDB		;Get a terminal data block and start a job
  3896	003161'01  254 00 0 00 003166'		 JRST SLRESF		;No terminal data blocks available
  3897	003162'01  205 02 0 00 110000 		MOVX T1,SBSTR!SBFCC	;Flag this slot as waiting to send a START
  3898	003163'01  260 01 0 00 003346'		CALL SSBDAV		; and a DATA_B slot when MUX runs.
  3899	003164'01  254 00 0 00 003122*		RETSKP			;Return success
  3900
  3901	003165'01  334 03 0 00 004755'	SLSHUT:	SKIPA T2,[SE.SHU]	;Reject reason is "Shut down"
  3902	003166'01  201 03 0 00 000005 	SLRESF:	MOVEI T2,SE.RES		;Indicate insufficient resource as reject code
  3903	003167'01  506 03 0 13 000006 		STOR T2,SBREA,(SB)	; and save for later when REJ slot built
  3904	003170'01  205 02 0 00 200000 		MOVX T1,SBREJ		;Flag this slot as waiting to send
  3905	003171'01  260 01 0 00 003346'		CALL SSBDAV		; a REJECT slot when MUX runs
  3906	003172'01  254 00 0 00 003164*		RETSKP			;Return success
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 86
LATSER	MAC	19-Aug-74 07:34		

  3907
  3908						SUBTTL	Process parameters from a received START slot
  3909					;
  3910					; Dispatch table of routines to deal with parameters from start slot
  3911					;
  3912	003173'01  400 00 0 00 002745'	SBPRTB:	IFIW	IGCSTR		;Ignore ones we don't know about
  3913	003174'01  400 00 0 00 002745'		IFIW	IGCSTR		;Parameter 1
  3914	003175'01  400 00 0 00 002745'		IFIW	IGCSTR		;2
  3915	003176'01  400 00 0 00 002745'		IFIW	IGCSTR		;3
  3916	003177'01  400 00 0 00 003201'		IFIW	GETOPN		;OBJECT_PORT_NAME
  3917	003200'01  400 00 0 00 003210'		IFIW	GETSPN		;SUBJECT_PORT_NAME
  3918		   	   000005	SBPRMX=.-SBPRTB-1
  3919
  3920	003201'01  200 03 0 00 005055'	GETOPN:	MOVE T2,[POINT 7,SB.OPN(SB)]	;Get object_port_name
  3921	003202'01  201 02 0 00 000020 		MOVEI T1,ML.PNM			;Set up max length of port name
  3922	003203'01  260 01 0 00 002746'		CALL GTCSTR			;Go get the string
  3923	003204'01  634 02 0 00 000002 		  TDZA T1,T1		;zero the count and give non-skip return
  3924	003205'01  350 00 0 01 000000 		AOS (P)			;PROPAGATE SKIP
  3925	003206'01  506 02 0 13 000007 		STOR T1,SBOPC,(SB)	;SAVE COUNT
  3926	003207'01  263 01 0 00 000000 		RET
  3927
  3928	003210'01  200 03 0 00 005056'	GETSPN:	MOVE T2,[POINT 7,SB.SPN(SB)]	;Get Subject_port_name
  3929	003211'01  201 02 0 00 000020 		MOVEI T1,ML.PNM			;Set up max length of port name
  3930	003212'01  260 01 0 00 002746'		CALL GTCSTR			;Go get the string
  3931	003213'01  634 02 0 00 000002 		  TDZA T1,T1		;zero the count and give non-skip return
  3932	003214'01  350 00 0 01 000000 		AOS (P)			;PROPAGATE SKIP
  3933	003215'01  542 02 0 13 000007 		STOR T1,SBSPC,(SB)	;SAVE COUNT
  3934	003216'01  263 01 0 00 000000 		RET
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 87
LATSER	MAC	19-Aug-74 07:34		Slot Processing Routines - STOP Slots

  3935						SUBTTL Slot Processing Routines - STOP Slots
  3936
  3937					;HSSTOP - Process a STOP Slot.
  3938					;
  3939					;Call:	SB/ Slot block address
  3940					;	CALL HSSTOP
  3941					;	 Error return - 
  3942					;	Normal return
  3943
  3944	003217'01  336 03 0 00 000000#	HSSTOP:	SKIPN T2,SLTDID		;Destination ID cannot be zero
  3945	003220'01  254 00 0 00 004130'		CALLRET IGNSLT		;  but if it is zero, just ignore it.
  3946	003221'01  336 00 0 00 000000#		SKIPN SLTSID		;Source ID must be zero
  3947	003222'01  303 03 0 00 001142*		CAILE T2,NTTLAH		;Is the SBVECT index in range?
  3948	003223'01  254 00 0 00 004132'		CALLRET ILLSLT		;No. Slot is illegal
  3949	003224'01  200 02 0 00 000000#		MOVE T1,SBVECT		;Get the slot block address from
  3950	003225'01  270 02 0 00 000003 		ADD T1,T2		; the destination slot id
  3951	003226'01  332 13 0 02 000000 		SKIPE SB,(T1)		;If the SB address is zero
  3952	003227'01  312 12 0 13 000025 		OPSTR <CAME CB,>,SBCBA,(SB); or CB address has changed then
  3953	003230'01  254 00 0 00 004130'		JRST IGNSLT		; ignore the slot since already gone.
  3954	003231'01  260 01 0 00 003400'		CALL RELSB		;Release all slot resources	
  3955	003232'01  254 00 0 00 003172*		RETSKP			;Return success
  3956
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 88
LATSER	MAC	19-Aug-74 07:34		Slot Processing Routines - DATA_A,DATA_B Slots

  3957						SUBTTL	Slot Processing Routines - DATA_A,DATA_B Slots
  3958
  3959					;HSDATA - Process a DATA_A Slot
  3960					;
  3961					;Call:  SB/ Slot block address
  3962					;	CALL HSDATA
  3963					;	 Error return - illegal slot
  3964					;	Normal return
  3965
  3966	003233'01  260 01 0 00 003244'	HSDATA:	CALL HDRDAT		;Go process data slot header
  3967	003234'01  263 01 0 00 000000 		 RET			;Illegal slot, error return
  3968	003235'01  336 14 0 00 000000#		SKIPN W1,SLTCNT		;Get the number of characters in the slot
  3969	003236'01  254 00 0 00 003232*		RETSKP			;None, return
  3970					IFN FTOPS10,<
  3971	003237'01  200 10 0 13 000024 		LOAD U,SBTDB,(SB)	;Get line data block address
  3972					>;end IFN FTOPS10
  3973					IFN FTOPS20,<
  3974						LOAD T2,SBTDB,(SB)	;Terminal dynamic data base
  3975						DYNST			;Get the line number
  3976					>;end IFN FTOPS20
  3977	003240'01			NXSLCH:
  3978					IFN FTOPS20,<
  3979						OPSTR <ILDB T1,>,UNBFA,+UNB.OF(RB);Get a character.
  3980						CALL TTCHI		;Call TTYSRV to enter into input buffer
  3981						 TRN			;Ignore error
  3982					>;end IFN FTOPS20
  3983					IFN FTOPS10,<
  3984	003240'01  134 04 0 11 000017 		OPSTR <ILDB T3,>,UNBFA,+UNB.OF(RB);Get a character.
  3985	003241'01  260 01 0 00 000000*		CALL RECPTY		;Call SCNSER to enter into input buffer
  3986					>;end IFN FTOPS10
  3987	003242'01  367 14 0 00 003240'		SOJG W1,NXSLCH		;If still more, continue
  3988	003243'01  254 00 0 00 003236*		RETSKP			;Otherwise return success
  3989
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 89
LATSER	MAC	19-Aug-74 07:34		Slot Processing Routines - DATA_A,DATA_B Slots

  3990
  3991	003244'01			HSDATB:				;Process received DATA_B slot (NOP)
  3992
  3993	003244'01  332 03 0 00 000000#	HDRDAT:	SKIPE T2,SLTDID		;Destination ID cannot be zero
  3994	003245'01  303 03 0 00 003222*		CAILE T2,NTTLAH		; or greater than maximum slot index
  3995	003246'01  254 00 0 00 004132'		CALLRET ILLSLT		;Illegal slot
  3996	003247'01  200 04 0 00 000000#		MOVE T3,SLTSID		;Source ID from the slot
  3997	003250'01  200 02 0 00 000000#		MOVE T1,SBVECT		;Get the address of the SB
  3998	003251'01  270 02 0 00 000003 		ADD T1,T2		; based on the remote slot id from 
  3999	003252'01  336 13 0 02 000000 		SKIPN SB,(T1)		; the message 
  4000	003253'01  254 00 0 00 004130'		CALLRET IGNSLT		;No slot block.
  4001	003254'01  554 17 0 13 000004 		OPSTR <CAME T3,>,SBRID,(SB) ;Is slot source ID equal to SB remote ID?
  4002	003255'01  312 04 0 00 000017 
  4003	003256'01  254 00 0 00 004130'		CALLRET IGNSLT		;No, ignore the slot
  4004	003257'01  550 04 0 13 000003 		LOAD T3,SBSTA,(SB)	;Get the slot state
  4005	003260'01  306 04 0 00 000001 		CAIN T3,SS.RUN		;If the slot state is not running or
  4006	003261'01  312 12 0 13 000025 		OPSTR <CAME CB,>,SBCBA,(SB) ; the circuit block address has changed
  4007	003262'01  254 00 0 00 004130'		CALLRET IGNSLT		; then slot disappeared already so ignore.
  4008	003263'01  200 04 0 00 000000#		MOVE T3,SLTTYP		;See if remote extended us any transmit
  4009	003264'01  405 04 0 00 000017 		ANDI T3,17		; credits. If so, add them to what we already
  4010	003265'01  554 17 0 13 000005 		OPSTRM <ADDM T3,>,SBXCR,(SB); have.
  4011	003266'01  272 04 0 00 000017 
  4012	003267'01  506 17 0 13 000005 
  4013	003270'01  336 00 0 00 000000#		SKIPN SLTCNT		;Do remote credit check only if there was
  4014	003271'01  254 00 0 00 003243*		RETSKP			; data in the slot.
  4015	003272'01  550 17 0 13 000005 		OPSTR <SOSGE T3,>,SBRCR,(SB) ;Decrement the receive credits
  4016	003273'01  375 04 0 00 000017 
  4017	003274'01  254 00 0 00 004132'		JRST ILLSLT		;Illegal, server sent data with no credits	
  4018	003275'01  542 04 0 13 000005 		STOR T3,SBRCR,(SB)	;Store back updated credits count
  4019	003276'01  332 00 0 00 000004 		SKIPE T3		;If receive credits have gone to zero,
  4020	003277'01  254 00 0 00 003302'		IFSKP.			; then indicate we need to grant more credits
  4021	003300'01  205 02 0 00 020000 		  MOVX T1,SBOUT		; by setting setting data available
  4022	003301'01  260 01 0 00 003346'		  CALL SSBDAV		; for MUX when it runs next time.
  4023	003302'01				ENDIF.
  4024	003302'01  254 00 0 00 003271*		RETSKP
  4025
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 90
LATSER	MAC	19-Aug-74 07:34		Slot Block Allocation and Deallocation Routines

  4026						SUBTTL	Slot Block Allocation and Deallocation Routines
  4027
  4028					;SBALOC - Slot Block Allocation Routine
  4029					;
  4030					;Call:	CB/ circuit block address
  4031					;	CALL SBALOC
  4032					;	 Error Return
  4033					;	Normal Return
  4034					;	SB/ Address of allocated slot block
  4035					;
  4036					; This routine allocates and initializes a new slot block.
  4037
  4038	003303'01  201 02 0 00 000027 	SBALOC:	MOVEI T1,SB.LEN		;Number of words to allocate for a slot blk
  4039	003304'01  260 01 0 00 004471'		CALL MMGTZW		;Try to get them
  4040	003305'01  263 01 0 00 000000 		  RET			;Can't
  4041	003306'01  200 13 0 00 000002 		MOVE SB,T1		;Put address in proper AC
  4042	003307'01  205 05 0 00 000000#		MOVSI T4,-NSBWDS	;Look for a free slot block index
  4043	003310'01  332 02 0 05 001207*	SBANXT:	SKIPE T1,NFRSBQ(T4)	; by examining the free slot block words
  4044	003311'01  243 02 0 00 003314'		JFFO T1,SBAGO		; for the first 1 bit.  This represents
  4045	003312'01  253 05 0 00 003310'		AOBJN T4,SBANXT		; the first free slot block index
  4046	003313'01  263 01 0 00 000000 		  RET			;No slot block available
  4047	003314'01  553 00 0 00 000005 	SBAGO:	HRRZS T4		;Clear out left half
  4048	003315'01  200 04 0 03 000000*		MOVE T3,BITS(T2)	;Clear the bit since the index is
  4049	003316'01  412 04 0 05 003310*		ANDCAM T3,NFRSBQ(T4)	; no longer free
  4050	003317'01  221 05 0 00 000044 		IMULI T4,^D36		;Compute the slot block index
  4051	003320'01  271 03 0 05 000001 		ADDI T2,1(T4)		;Cannot be zero
  4052	003321'01  542 03 0 13 000004 		STOR T2,SBLID,(SB)	;Store in SB as local slot index
  4053	003322'01  200 02 0 00 000000#		MOVE T1,SBVECT		;Now store the address of the slot block
  4054	003323'01  270 02 0 00 000003 		ADD T1,T2		; in the vector of slot block address, which
  4055	003324'01  202 13 0 02 000000 		MOVEM SB,(T1)		; is indexed by slot block index
  4056	003325'01  415 02 0 12 000015 		XMOVEI T1,CB.SBQ(CB)	;Queue the SB to the circuit block's 
  4057	003326'01  200 03 0 00 000013 		MOVE T2,SB		; queue of slot blocks.
  4058	003327'01  260 01 0 00 004135'		CALL LAQUE		;
  4059	003330'01  201 02 0 00 000001 		MOVEI T1,CS.STA		;Set the slot state
  4060	003331'01  542 02 0 13 000003 		STOR T1,SBSTA,(SB)	; to starting.
  4061	003332'01  202 12 0 13 000025 		STOR CB,SBCBA,(SB)	;Store the circuit block address in SB
  4062	003333'01  200 02 0 00 000000#		MOVE T1,SLTSID		;Get the remote's slot id
  4063	003334'01  506 02 0 13 000004 		STOR T1,SBRID,(SB)	;Store as our remote id
  4064	003335'01  200 02 0 00 000000#		MOVE T1,SLTTYP		;Get the Slot type/credits from recv's slot
  4065	003336'01  405 02 0 00 000017 		ANDI T1,17		;Keep only the number of credits extended to us
  4066	003337'01  506 02 0 13 000005 		STOR T1,SBXCR,(SB)	;Store is slot block as our transmit credits
  4067	003340'01  201 02 0 00 000002 		MOVEI T1,MAXCRE		;Maximum credits to extend to remote
  4068	003341'01  542 02 0 13 000005 		STOR T1,SBRCR,(SB)	; to current number of remote credits
  4069	003342'01  550 17 0 06 000003 		OPSTRM <AOS>,HNCON,(HN)	;Count one more active connect
  4070	003343'01  350 00 0 00 000017 
  4071	003344'01  542 17 0 06 000003 
  4072	003345'01  254 00 0 00 003302*		RETSKP			;Return successfully
  4073
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 91
LATSER	MAC	19-Aug-74 07:34		Slot Block Allocation and Deallocation Routines

  4074
  4075
  4076					;SSBDAV - Set Slot BLock Data Available
  4077					;
  4078					;Call:	T1/ Bit to set in SB.FLG
  4079					;	SB/ Slot block address
  4080					;	CALL SSBDAV
  4081					;	Normal Return
  4082
  4083	003346'01  335 03 0 13 000002 	SSBDAV:	SKIPGE T2,SB.FLG(SB)	;Is there already data available?
  4084	003347'01  254 00 0 00 003354'		IFSKP.			;No, so set it now
  4085	003350'01  554 17 0 12 000004 		  OPSTRM <AOS>,CBSDC,(CB);Increment number of slots waiting
  4086	003351'01  350 00 0 00 000017 
  4087	003352'01  506 17 0 12 000004 
  4088	003353'01  661 03 0 00 400000 		  TLO T2,400000		; and indicate this slot now waiting	 
  4089	003354'01				ENDIF.
  4090	003354'01  434 03 0 00 000002 		IOR T2,T1		;OR in new reason for waiting
  4091	003355'01  202 03 0 13 000002 		MOVEM T2,SB.FLG(SB)	; and store back
  4092	003356'01  263 01 0 00 000000 		RET			;Return
  4093
  4094					;CSBDAV - Clear Slot BLock Data Available
  4095					;
  4096					;Call:	T1/ Bit to clear in SB.FLG
  4097					;	SB/ Slot block address
  4098					;	CALL SSBDAV
  4099					;	Normal Return
  4100
  4101	003357'01  331 03 0 13 000002 	CSBDAV:	SKIPL T2,SB.FLG(SB)	;Is "data available" already clear?
  4102	003360'01  263 01 0 00 000000 		RET			;Yes
  4103	003361'01  420 03 0 00 000002 		ANDCM T2,T1		;Clear the desired bit
  4104	003362'01  603 03 0 00 377777 		TLNE T2,377777		;Are all bits off now?
  4105	003363'01  254 00 0 00 003370'		IFSKP.
  4106	003364'01  554 17 0 12 000004 		  OPSTRM <SOS>,CBSDC,(CB)
  4107	003365'01  370 00 0 00 000017 
  4108	003366'01  506 17 0 12 000004 
  4109	003367'01  201 03 0 00 000000 		  MOVEI T2,0
  4110	003370'01				ENDIF.
  4111	003370'01  502 03 0 13 000002 		HLLM T2,SB.FLG(SB)
  4112	003371'01  263 01 0 00 000000 		RET
  4113
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 92
LATSER	MAC	19-Aug-74 07:34		Slot Block Allocation and Deallocation Routines

  4114
  4115
  4116					;RELSBS - Release all Slot Blocks and their Resources for a virtual circuit
  4117					;
  4118					;Call:	CB/ Address of the circuit block
  4119					;	CALL RELSBS
  4120					;	Normal Return
  4121					;
  4122
  4123	003372'01  322 12 0 00 003016*	RELSBS:	JUMPE CB,RTN		;No slots to release if no circuit block
  4124	003373'01  336 13 0 12 000015 		OPSTR <SKIPN SB,>,QLFWD,+CB.SBQ(CB);Get the address of first SB on Q
  4125	003374'01  263 01 0 00 000000 		RET			;If zero, there are no more on the queue
  4126	003375'01  260 01 0 00 003400'		CALL RELSB		;Release the slot block
  4127	003376'01  254 00 0 00 003372'		JRST RELSBS		;Go do the next
  4128	003377'01  263 01 0 00 000000 		RET
  4129
  4130					;RELSB - Release a Slot Block and its Resources
  4131					;
  4132					;Call:	CB/ Address of the circuit block for slot
  4133					;	SB/ Address of the slot block to release
  4134					;	CALL RELSB
  4135					;	Normal Return
  4136					;	SB/ address of previous slot or listhead
  4137
  4138	003400'01			RELSB:
  4139					IFN FTOPS20,<	OPSTR <SKIPN T2,>,SBTDB,(SB) ;Is there a terminal data base
  4140						JRST RELSB0		;No, go just release the SB resources
  4141						SETZM TTDEV(T2)		;Clear the slot block address in the TDB.
  4142						SETZRO TTPRM,(T2)	;TDB no longer permanent
  4143						DYNST			;Get the static line number
  4144						CALL NTYCOF		;Go detach the job
  4145						LOAD T2,SBTDB,(SB)	;Get the TDB address again.
  4146						LOAD T1,TCJOB,(T2)	;If there is a controlling job, don't release
  4147						CAIE T1,-1		; the TDB since this will be done
  4148						JRST RELSB0		; later by JOBCOF.
  4149						DYNST			;No controlling job so we must release the
  4150						CALL TTYDE0		; the dynamic data base here.
  4151						  TRN			;TTYSRV already reports this.
  4152					>;end IFN FTOPS20
  4153					IFN FTOPS10,<
  4154	003400'01  336 10 0 13 000024 		OPSTR <SKIPN U,>,SBTDB,(SB) ;Is there a terminal data base
  4155	003401'01  254 00 0 00 003405'		JRST RELSB0		;No, go just release the SB resources
  4156	003402'01  261 01 0 00 000015 		PUSH P,J			;NGVLDB blows J (our W2)
  4157	003403'01  260 01 0 00 003464'		CALL NGVLDB		;Give the LDB back to SCNSER
  4158	003404'01  262 01 0 00 000015 		POP P,J				;Get our AC back
  4159					>;end IFN FTOPS10
  4160	003405'01  415 02 0 12 000015 	RELSB0:	OPSTR <XMOVEI T1,>,CBSBQ,(CB) ;Point to the CB SBQ header
  4161	003406'01  200 03 0 00 000013 		MOVE T2,SB		; and 
  4162	003407'01  260 01 0 00 004145'		CALL LAUNQ		; release the SB from this queue
  4163	003410'01  331 00 0 13 000002 		SKIPL SB.FLG(SB)	;Did this SB have any data waiting?
  4164	003411'01  254 00 0 00 003415'		IFSKP.			;Yes
  4165	003412'01  554 17 0 12 000004 		  OPSTRM <SOS>,CBSDC,(CB) ;Reduce number of slots with data waiting
  4166	003413'01  370 00 0 00 000017 
  4167	003414'01  506 17 0 12 000004 
  4168	003415'01				ENDIF.
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 92-1
LATSER	MAC	19-Aug-74 07:34		Slot Block Allocation and Deallocation Routines

  4169	003415'01  260 01 0 00 003426'		CALL RLSBID		;Release the SB local id.
  4170	003416'01  200 02 0 00 000013 		MOVE T1,SB
  4171	003417'01  336 13 0 13 000001 		OPSTR <SKIPN SB,>,QLBWD,(SB);Set up so the slot mux gets the correct
  4172	003420'01  415 13 0 12 000015 		XMOVEI SB,CB.SBQ(CB)	; next slot.
  4173	003421'01  260 01 0 00 004501'		CALL MMFREE		;Free the memory
  4174	003422'01  550 17 0 06 000003 		OPSTRM <SOS>,HNCON,(HN)	;One less connected session
  4175	003423'01  370 00 0 00 000017 
  4176	003424'01  542 17 0 06 000003 
  4177	003425'01  263 01 0 00 000000 		RET
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 93
LATSER	MAC	19-Aug-74 07:34		Slot Block Allocation and Deallocation Routines

  4178					;RLSBID - Release a Slot Block's local id.
  4179					;
  4180					;Call:	SB/ Address of the SB
  4181					;	CALL RLSBID
  4182					;	Normal Return
  4183					;
  4184
  4185	003426'01  550 17 0 13 000004 	RLSBID:	OPSTR <SKIPN T1,>,SBLID,(SB);Get the SB local index
  4186	003427'01  336 02 0 00 000017 
  4187	003430'01  263 01 0 00 000000 		RET			;Already zero. Nothing to do.
  4188	003431'01  200 03 0 00 000000#		MOVE T2,SBVECT		;Clear the pointer to SB
  4189	003432'01  270 03 0 00 000002 		ADD T2,T1		; in the vector of SB addresses
  4190	003433'01  402 00 0 03 000000 		SETZM (T2)		; ...
  4191	003434'01  370 00 0 00 000002 		SOS T1			;Normalize to zero
  4192	003435'01  231 02 0 00 000044 		IDIVI T1,^D36		;Now clear the bit to indicate that the
  4193	003436'01  200 04 0 03 003315*		MOVE T3,BITS(T2)	; slot block index is now free
  4194	003437'01  436 04 0 02 003316*		IORM T3,NFRSBQ(T1)	; ...
  4195	003440'01  400 02 0 00 000000 		SETZ T1,		;Clear the local
  4196	003441'01  542 02 0 13 000004 		STOR T1,SBLID,(SB)	; SB ID.
  4197	003442'01  263 01 0 00 000000 		RET
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 94
LATSER	MAC	19-Aug-74 07:34		Slot Block Allocation and Deallocation Routines

  4198
  4199
  4200					;GETTDB - get terminal dynamic data base
  4201					;
  4202					;Call:	SB/ slot block address
  4203					;	CALL GETTDB
  4204					;	 Error return
  4205					;	Normal return
  4206					;	
  4207
  4208
  4209	003443'01			GETTDB:
  4210					IFN FTOPS20,<
  4211						SAVEAC <W1,W2>
  4212						MOVE W1,TT1LIN+TT.LAH
  4213					GTTDB0:	LOAD T1,TTSTY,(W1)	;Get the line type
  4214						CAIE T1,TT.LAH
  4215						 RET
  4216						MOVE T2,W1
  4217						CALL STADYN
  4218						 JUMPE T2,GTTDB2
  4219					GTTDB1:	AOJA W1,GTTDB0		;Try next line
  4220					GTTDB2:	MOVE T2,W1
  4221						CALL TTYASC
  4222						 JRST GTTDB1
  4223						CALL STADYN
  4224						 JRST GTTDB1
  4225						STOR T2,SBTDB,(SB)
  4226						MOVEM SB,TTDEV(T2)
  4227						SETONE TCJOB,(T2)
  4228						SETONE TTPRM,(T2)
  4229						MOVEI T1,.CHCNC
  4230						MOVE T2,W1
  4231						CALL TTCHI
  4232						  NOP
  4233						RETSKP
  4234					>;end IFN FTOPS20
  4235
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 95
LATSER	MAC	19-Aug-74 07:34		Slot Block Allocation and Deallocation Routines

  4236					IFN FTOPS10,<
  4237
  4238					; Get a remote LDB and make it mine
  4239					;
  4240					;
  4241					; Return:
  4242					;	RET			;FAILED
  4243					;	RETSKP			;SUCCESS
  4244					;
  4245
  4246	003443'01  265 17 0 00 004647'		SAVEAC <W>		;SCNSER/NETSER WILL USE THIS
  4247
  4248					;Allocate an LDB
  4249
  4250	003444'01  205 02 0 00 000000*		MOVSI T1,LTLLAT		;FLAG A NEW LAT TERMINAL
  4251	003445'01  201 04 0 00 000000'		MOVEI T3,LATDSP		;LAT'S ISR DISPATCH TABLE
  4252	003446'01  260 01 0 00 000000*		CALL GETLDB		;GET A REMOTE TTY LDB, POINTER IN U
  4253	003447'01  263 01 0 00 000000 		 RET			;GO ANNOUNCE THE FAILURE
  4254
  4255					;Finish making this a LAT LDB
  4256
  4257	003450'01  201 02 0 00 000000#		MOVEI T1,LATRTQ		;GET POINTER TO OUTPUT Q HEADER
  4258	003451'01  516 02 0 10 000000*		HRLZM T1,LDBQUH(U)	;STORE FOR SCNSER (TOPOKE/TOTAKE)
  4259	003452'01  202 10 0 13 000024 		STOR U,SBTDB,(SB)	;REMEMBER OUR LDB
  4260	003453'01  202 13 0 10 001251*		MOVEM SB,LDBLAT(U)	;STORE SB PTR IN LDB TOO
  4261	003454'01  201 02 0 00 000000*		MOVEI T1,APCLAT		;GET LATSER CODE
  4262	003455'01  137 02 0 00 000000*		DPB T1,LDPAPC		;SET ASYNC PORT CHARACTERISTIC
  4263	003456'01  201 02 0 00 000000*		MOVEI T1,M.LIDL		;GET MAX. IDLE TIME FOR LAT LINES
  4264	003457'01  260 01 0 00 000000*		CALL SCNADT		;SET THE TIMER GOING
  4265	003460'01  135 02 0 00 000000#		LDB T1,LDPXNF		;Find out our XON/XOF setting
  4266	003461'01  137 02 0 00 005057'		STOR T1,SBXNF,(SB)	;And make LAT's setting agree (we will also
  4267									;send a DATA_B slot to inform LATbox).
  4268
  4269					;Initialize the TTY with .HELLO force command
  4270
  4271	003462'01  260 01 0 00 000000*		CALL TTFGRT		;GO FORCE .HELLO/.RESTART
  4272	003463'01  254 00 0 00 003345*		RETSKP 			;SUCCESS RETURN
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 96
LATSER	MAC	19-Aug-74 07:34		Subroutines -- NGVLDB - Give an LDB back to SCNSER

  4273						SUBTTL Subroutines -- NGVLDB - Give an LDB back to SCNSER
  4274
  4275					;NGVLDB - Give an LDB back to SCNSER
  4276					;
  4277					; Call:	U/ Pointer to LDB
  4278					;
  4279					; Return:
  4280					;	RET			;ALWAYS
  4281
  4282	003464'01  402 00 0 10 003453*	NGVLDB:	SETZM	LDBLAT(U)	;CLEAR OUT BY-NOW-STALE POINTER
  4283	003465'01  201 02 0 00 000020 		MOVEI	T1,IONND%	;"NODE DOWN" (PATH LOST/ETC) ERROR
  4284	003466'01  260 01 0 00 000000*		CALL	DETLDB		;DETACH THE LDB/DDB
  4285	003467'01  254 00 0 00 000000*		CALLRET	FRELDB		;RETURN LDB TO SCNSER FREE POOL
  4286					>;end IFN FTOPS10
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 97
LATSER	MAC	19-Aug-74 07:34		Slot Multiplexor - Main Loop

  4287						SUBTTL	Slot Multiplexor - Main Loop
  4288
  4289					;LAMUX Slot Multiplexor Main Loop
  4290					;
  4291					;Call:	CALL LAMUX
  4292					;	Normal return
  4293					;
  4294
  4295	003470'01			LAMUX:
  4296					IFN FTOPS10,<
  4297	003470'01  260 01 0 00 004321'		CALL LATSCN		;Scan active LDBs
  4298					>;end IFN FTOPS10
  4299	003471'01  200 12 0 06 000011 		LOAD CB,QLFWD,+HN.QAC(HN) ;Get the first CB on the active queue
  4300	003472'01			LANXCB:
  4301					IFN FTOPS20,<	JUMPE CB,RTN		;All CBs processed, return>
  4302	003472'01  322 12 0 00 004403'	IFN FTOPS10,<	JUMPE CB,CHKWFB	;All CBs processed, check if we need buffers>
  4303					IFN FTOPS20,<
  4304						SKIPL HN.RUN(HN)		;Is the NI still running?
  4305						IFSKP.
  4306						  CALL NIHALT		;No, so deallocate all resources
  4307						  JRST MXNXCB
  4308						ENDIF.
  4309					> ;END IFN FTOPS20
  4310	003473'01  402 00 0 00 000000#		SETZM NSLOTS		;Initialize number of slots in this msg
  4311	003474'01  550 02 0 12 000024 		LOAD T1,CBSTA,(CB)	;Consider only those circuits which are
  4312	003475'01  302 02 0 00 000002 		CAIE T1,CS.RUN		; in the running state
  4313	003476'01  254 00 0 00 003554'		JRST MXNXCB		; ...
  4314	003477'01  336 00 0 12 000015 		OPSTR <SKIPN>,CBSBQ,(CB);If there are no slots for this circuit or
  4315						  JRST [CALL IDLHLT
  4316	003500'01  254 00 0 00 005060'			JRST MXNXCB]	;Kill it and look at next one.
  4317	003501'01  550 02 0 06 000004 		LOAD T1,HNLAS,(HN)	;Get the current access state.
  4318	003502'01  306 02 0 00 000000 		CAIN T1,LS.OFF		;If the access state is now off,
  4319	003503'01  254 00 0 00 003563'		  JRST MXNXC2		;  kill this circuit and look at next.
  4320	003504'01  205 17 0 00 400000 		SETZRO CBRRF,(CB)	;No RRF set yet
  4321	003505'01  412 17 0 12 000003 
  4322	003506'01  260 01 0 00 002573'		CALL TMRCHK		;Check for circuit timer related functions.
  4323	003507'01  254 00 0 00 003554'		 JRST MXNXCB		;Continue with next circuit.
  4324	003510'01  200 17 0 12 000003 		TMNN CBMRN,(CB)		;Must we go balanced (reply to server) now?
  4325	003511'01  607 17 0 00 100000 
  4326	003512'01  254 00 0 00 003530'		JRST LMNMRN		;No
  4327
  4328					; We have received a message from the server and must respond message now.  If
  4329					; there is a free transmit buffer and there is slot data waiting to be sent,
  4330					; then build the slots in a large MSD transmit buffer and send it.  If the MSD
  4331					; buffer is not available or there is no slot data waiting, just send a RUN
  4332					; message header.  If there are no free transmit buffers, retransmit the queue
  4333					; of unacknowledged messages.
  4334
  4335	003513'01  205 02 0 00 700000 		MOVX T1,CBMRS!CBMRN!CBRRF;Clear all flags
  4336	003514'01  412 02 0 12 000003 		ANDCAM T1,CB.FLG(CB)	; since we will reply now.
  4337	003515'01  513 00 0 12 000003 		SETZRO CBCSB,(CB)	;Clear count since balanced
  4338	003516'01  336 07 0 12 000011 		SKIPN XB,CB.XBQ(CB)	;Is there a transmit buffer header free?
  4339	003517'01  254 00 0 00 003526'		JRST LMNOXB		;No, go transmit unACK'd Q
  4340	003520'01  554 17 0 12 000004 		OPSTR <SKIPE >,CBSDC,(CB);There is a buffer, is there data waiting?	
  4341	003521'01  332 00 0 00 000017 
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 97-1
LATSER	MAC	19-Aug-74 07:34		Slot Multiplexor - Main Loop

  4342	003522'01  260 01 0 00 003565'		CALL BLDMSL		;Everything there so build slots in buffer
  4343	003523'01  600 00 0 00 000000 		  NOP			;No slots, but don't care
  4344	003524'01  260 01 0 00 002535'		CALL MTTRUN		;Transmit either hdr only or full message
  4345	003525'01  254 00 0 00 003554'		JRST MXNXCB		;Go to next circuit block
  4346	003526'01  260 01 0 00 002614'	LMNOXB:	CALL XUNAKQ		;Transmit all messages on the unack'd Q
  4347	003527'01  254 00 0 00 003554'		JRST MXNXCB
  4348
  4349					; Check to see if we just received a message from the server.  If so,
  4350					; flag to force a reply at the next sheduler cycle.  We wait one cycle in
  4351					; case user programs are controlling echoing in the hopes that response
  4352					; will be smoother.
  4353
  4354	003530'01  200 17 0 12 000003 	LMNMRN:	TMNN CBMRS,(CB)		;Must reply soon?
  4355	003531'01  607 17 0 00 200000 
  4356	003532'01  254 00 0 00 003536'		JRST LMUNSL
  4357	003533'01  205 17 0 00 100000 		SETONE CBMRN,(CB)	;Yes, set to force reply on next cycle	
  4358	003534'01  436 17 0 12 000003 
  4359	003535'01  254 00 0 00 003554'		JRST MXNXCB
  4360
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 98
LATSER	MAC	19-Aug-74 07:34		Slot Multiplexor - Main Loop

  4361
  4362
  4363					; We are in balanced mode, i.e. the response to the latest server message
  4364					; has already been sent.  Check here to see if we ought to send an unsolicited
  4365					; message.  We are allowed one.  We wait at least MXBALC scheduler cycles since
  4366					; last going balanced.  If after that period there is slot data waiting, we
  4367					; send an unsolicited message to the server.
  4368					; If we have not data to send, wait another MXBALC cycles before trying again.
  4369
  4370	003536'01  550 02 0 12 000003 	LMUNSL:	LOAD T1,CBCSB,(CB)	;Number of cycles to wait before sending
  4371	003537'01  301 02 0 00 000006 		CAIL T1,MXBALC		;Have we waited long enough?
  4372	003540'01  254 00 0 00 003544'		IFSKP.			;No, so
  4373	003541'01  340 02 0 00 000000 		  AOJ T1,		; increment the count
  4374	003542'01  542 02 0 12 000003 		  STOR T1,CBCSB,(CB)	; and wait
  4375	003543'01  254 00 0 00 003554'		  JRST MXNXCB		; some more.
  4376	003544'01				ENDIF.
  4377
  4378					; We have waited long enough. If there is slot data waiting and resouces
  4379					; available, send an unsolicited message to the server
  4380
  4381	003544'01  336 07 0 12 000011 		SKIPN XB,CB.XBQ(CB)	;Is there a transmit buffer header free?
  4382	003545'01  254 00 0 00 003554'		JRST MXNXCB		;No, so don't send anything
  4383	003546'01  513 00 0 12 000003 		SETZRO CBCSB,(CB)	;We might send data, reset the ticker.
  4384	003547'01  554 17 0 12 000004 		OPSTR <SKIPE >,CBSDC,(CB);Is there slot data waiting?
  4385	003550'01  332 00 0 00 000017 
  4386	003551'01  260 01 0 00 003565'		CALL BLDMSL		;Build a message full of slots
  4387	003552'01  254 00 0 00 003557'		  JRST MXNXC1		; If no slots, do keep-alive timing.
  4388	003553'01  260 01 0 00 002535'		CALL MTTRUN		;There are slots in the message so send it.
  4389	003554'01  200 12 0 12 000000 	MXNXCB:	LOAD CB,QLFWD,(CB)	;Index of the next CB on active queue
  4390	003555'01  254 00 0 00 003472'		JRST LANXCB		;Continue looping
  4391	003556'01  263 01 0 00 000000 		RET
  4392					;
  4393					; We don't have any unsolicited data to send, check if we have heard
  4394					; from the server within the last few SERVER_KEEP_ALIVE_TIMER seconds.
  4395					; If not, we will assume the server died, and we will kill the circuit.
  4396
  4397	003557'01  350 02 0 12 000050 	MXNXC1:	AOS T1,CB.KAF(CB)	;Count keep-alive timer
  4398	003560'01  554 03 0 00 000002 		HLRZ T2,T1		;Get limit value of timer
  4399	003561'01  553 00 0 00 000002 		HRRZS T1		; and isolate timer part
  4400	003562'01  311 02 0 00 000003 		CAML T1,T2		;Have we hit limit yet?
  4401	003563'01  260 01 0 00 002377'	MXNXC2:	CALL LCLHLT		;Yes, we have not heard from the server
  4402	003564'01  254 00 0 00 003554'		JRST MXNXCB		;in a long time, so kill the circuit.
  4403
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 99
LATSER	MAC	19-Aug-74 07:34		

  4404						SUBTTL 
  4405					;BLDMSL - Build RUN Message Slots
  4406					;
  4407					;Call:	CB/ Address of Circuit Block
  4408					;	CALL BLDMSL
  4409					;	Normal return
  4410					;
  4411					; This routine scans through all slots associated with a LAT virtual circuit
  4412					; and builds RUN message slots for those which have data waiting to be sent 
  4413					; to the remote node.  SBFLGS contains a bits mask which indicates which
  4414					; type of slot must be built for the slot block. More than one bit may be set.
  4415
  4416	003565'01  336 13 0 12 000015 	BLDMSL:	OPSTR <SKIPN SB,>,QLFWD,+CB.SBQ(CB);Get addr of first slot for this CB
  4417	003566'01  263 01 0 00 000000 		RET			;There are none
  4418	003567'01  402 00 0 07 000016 		SETZRO UNBSZ,+UNB.OF(XB); and message count
  4419	003570'01  402 00 0 07 000025 		SETZM MD.NXT+MDB.OF(XB)		;No transmit buffer yet.
  4420	003571'01  331 14 0 13 000002 	BLSLOP:	SKIPL W1,SB.FLG(SB)	;Does this slot have data waiting?
  4421	003572'01  254 00 0 00 003576'		JRST MXNXSL		;No, loop to next slot
  4422	003573'01  513 00 0 00 000014 		HLLZS W1		;Clear all but flags
  4423	003574'01  621 14 0 00 400000 		TLZ W1,400000
  4424	003575'01  243 14 0 00 003625'	BLNXSL:	JFFO W1,BLSDSP		;Find first flags bit which is lit.
  4425	003576'01  332 13 0 13 000000 	MXNXSL:	OPSTR<SKIPE SB,>,QLFWD,(SB);Get next slot's index and
  4426	003577'01  254 00 0 00 003571'		JRST BLSLOP		; continue with the next slot
  4427	003600'01  336 00 0 00 000000#	BLSLCP:	SKIPN NSLOTS		;Check to see if any slots entered at all
  4428	003601'01  263 01 0 00 000000 		RET			;None.
  4429
  4430					;If we couldn't get through all slots, rotate this circuit's slot queue so
  4431					;that we resume next time with the slot we did not complete this time.
  4432
  4433	003602'01  336 00 0 00 000013 		SKIPN SB		;Did we get through the whole queue?
  4434	003603'01  254 00 0 00 003617'		IFSKP.			;NO
  4435	003604'01  316 13 0 12 000015 		  OPSTR <CAMN SB,>,QLFWD,+CB.SBQ(CB);Is slot already at the Q head?
  4436	003605'01  254 00 0 00 003617'		  IFSKP.		;NO
  4437	003606'01  200 04 0 12 000015 		    LOAD T3,QLFWD,+CB.SBQ(CB);Get old queue head
  4438	003607'01  200 05 0 12 000016 		    LOAD T4,QLBWD,+CB.SBQ(CB);Get old queue tail
  4439	003610'01  202 04 0 05 000000 		    STOR T3,QLFWD,(T4)	;Joint them together
  4440	003611'01  202 05 0 04 000001 		    STOR T4,QLBWD,(T3)	; ...
  4441	003612'01  200 04 0 13 000001 		    LOAD T3,QLBWD,(SB)	;Get new Q tail from new Q head
  4442	003613'01  402 00 0 04 000000 		    SETZRO QLFWD,(T3)	;Clear new tail's forward ptr
  4443	003614'01  402 00 0 13 000001 		    SETZRO QLBWD,(SB)	;Clear new head's backward ptr
  4444	003615'01  202 13 0 12 000015 		    STOR SB,QLFWD,+CB.SBQ(CB);New head
  4445	003616'01  202 04 0 12 000016 		    STOR T3,QLBWD,+CB.SBQ(CB);New tail
  4446	003617'01				  ENDIF.
  4447	003617'01				ENDIF.
  4448
  4449					;Compute final byte count padding to minimum NI datagram size if necessary.
  4450
  4451	003617'01  200 02 0 07 000016 		LOAD T1,UNBSZ,+UNB.OF(XB);Store the larger of the final real message
  4452	003620'01  307 02 0 00 000046 		CAIG T1,MINXBF-MMHDSI	; count and the minimum count as the message
  4453	003621'01  201 02 0 00 000046 		MOVEI T1,MINXBF-MMHDSI	; count.
  4454	003622'01  200 04 0 07 000025 		MOVE T3,MD.NXT+MDB.OF(XB)		;Get MSD address
  4455	003623'01  202 02 0 04 000003 		STOR T1,MDBYT,(T3)	;and store count in MSD
  4456	003624'01  254 00 0 00 003463*		RETSKP
  4457
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 100
LATSER	MAC	19-Aug-74 07:34		

  4458
  4459
  4460					; Check first to see if adding a new slot causes the number of slots in a
  4461					; message to exceed the maximum permitted by remote.
  4462
  4463	003625'01  554 04 0 12 000022 	BLSDSP:	LOAD T3,CBMSL,(CB)	;Get the maximum permitted by remote
  4464	003626'01  317 04 0 00 000000#		CAMG T3,NSLOTS		; and compare with number of slots so far.
  4465	003627'01  254 00 0 00 003600'		JRST BLSLCP		;At maximum, stop processing this circuit.
  4466
  4467					; Check to see if there is enough room remaining in the transmit buffer to
  4468					; include this slot.
  4469
  4470	003630'01  554 02 0 15 003657'		HLRZ T1,SLLNTB-1(W2)	;Minimum bytes required for this slot type.
  4471	003631'01  200 04 0 07 000016 		LOAD T3,UNBSZ,+UNB.OF(XB);Current number of bytes in the buffer.
  4472	003632'01  270 02 0 00 000004 		ADD T1,T3		;Count if we include this new slot.
  4473	003633'01  303 02 0 00 000567 		CAILE T1,SZ.XBF		;Compare with total transmit buffer capacity.
  4474	003634'01  254 00 0 00 003600'		JRST BLSLCP		;Will not fit so stop processing this circuit.
  4475
  4476					; Call the routine to build the slot.  It may or may not be entered into the
  4477					; message. At this point however it is always marked as having been processed.
  4478
  4479	003635'01  200 02 0 15 003436*		MOVE T1,BITS(W2)	;Get the mask for the bit
  4480	003636'01  420 14 0 00 000002 		ANDCM W1,T1		;Indicate that this slot has been processed.
  4481	003637'01  260 01 1 15 003651'		CALL @SLBDSP-1(W2)	;Build the slot.
  4482	003640'01  254 00 0 00 003575'		  JRST BLNXSL		;Slot not entered. Try next.
  4483
  4484					; Slot successfully entered into the transmit buffer. Update the buffer counts.
  4485					; Terminal character count has already been added.
  4486
  4487	003641'01  550 02 0 15 003657'		HRRZ T1,SLLNTB-1(W2)	;Get the count for the slot header.	
  4488	003642'01  270 02 0 07 000016 		OPSTR <ADD T1,>,UNBSZ,+UNB.OF(XB);Get the message count so far
  4489	003643'01  606 02 0 00 000001 		TRNN T1,1		;Is the count even?
  4490	003644'01  254 00 0 00 003647'		IFSKP.			;No, must pad to even number
  4491	003645'01  136 02 0 07 000017 		  OPSTR <IDPB T1,>,UNBFA,+UNB.OF(XB);Put fill byte into message
  4492	003646'01  350 00 0 00 000002 		  AOS T1		;Increment total in message
  4493	003647'01				ENDIF.
  4494	003647'01  202 02 0 07 000016 		STOR T1,UNBSZ,+UNB.OF(XB);
  4495	003650'01  350 00 0 00 000000#		AOS NSLOTS		;Increment number of slots in the message.
  4496	003651'01  254 00 0 00 003575'		JRST BLNXSL		;Get next slot request.
  4497
  4498		   	   000001		MIN. (MINSFL,<^L<SBREJ>,^L<SBSTR>,^L<SBSTO>,^L<SBOUT>,^L<SBFOU>,^L<SBFCC>>)
  4499		   	   000006		MAX. (MAXSFL,<^L<SBREJ>,^L<SBSTR>,^L<SBSTO>,^L<SBOUT>,^L<SBFOU>,^L<SBFCC>>)
  4500
  4501
  4502	003652'01			SLBDSP:	BLOCK <MAXSFL-MINSFL+1>
  4503	003660'01			SLLNTB:	BLOCK <MAXSFL-MINSFL+1>
  4504	003652'01  400 00 0 00 003707'		LSLDT. (SLBDSP,SLLNTB,^L<SBREJ>-1,XSLREJ,<SZ.SHD+SZ.REJ>,<SZ.SHD+SZ.REJ>)
  4505	003660'01  000004  000004
  4506	003653'01  400 00 0 00 003666'		LSLDT. (SLBDSP,SLLNTB,^L<SBSTR>-1,XSLSTA,<SZ.SHD+SZ.SST>,<SZ.SHD+SZ.SST>)
  4507	003661'01  000012  000012
  4508	003657'01  400 00 0 00 003721'		LSLDT. (SLBDSP,SLLNTB,^L<SBSTO>-1,XSLSTP,<SZ.SHD+SZ.SSP>,<SZ.SHD+SZ.SSP>)
  4509	003665'01  000004  000004
  4510	003655'01  400 00 0 00 003745'		LSLDT. (SLBDSP,SLLNTB,^L<SBOUT>-1,XSLDTA,<SZ.SHD>,<SZ.SHD>)
  4511	003663'01  000004  000004
  4512	003654'01  400 00 0 00 003734'		LSLDT. (SLBDSP,SLLNTB,^L<SBFOU>-1,XSLATT,<SZ.SHD+SZ.ATT>,<SZ.SHD+SZ.ATT>)
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 100-1
LATSER	MAC	19-Aug-74 07:34		

  4513	003662'01  000005  000005
  4514	003656'01  400 00 0 00 004051'		LSLDT. (SLBDSP,SLLNTB,^L<SBFCC>-1,XSLDTB,<SZ.SHD+SZ.SDB>,<SZ.SHD+SZ.SDB>)
  4515	003664'01  000011  000011
  4516
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 101
LATSER	MAC	19-Aug-74 07:34		Slot Formatting Routines

  4517						SUBTTL	Slot Formatting Routines
  4518
  4519					;XSLSTA - Format a START Slot in the Transmit Buffer
  4520					;
  4521					;Call:	SB/ Slot Block Address
  4522					;	CB/ Circuit Block Address
  4523					;	XB/ Transmit Buffer Address
  4524					;	CALL XSLSTA
  4525					;	Normal Return
  4526					;
  4527
  4528	003666'01  260 01 0 00 004240'	XSLSTA:	CALL XBFCHK		;Do we have a transmit buffer yet?
  4529	003667'01  263 01 0 00 000000 		  RET			;No, and can't get any.
  4530	003670'01  201 02 0 00 000001 		MOVEI T1,SS.RUN		;Put the slot in the
  4531	003671'01  542 02 0 13 000003 		STOR T1,SBSTA,(SB)	; RUNNING state.
  4532	003672'01  201 02 0 00 111006 		MOVEI T1,<<ST.STA_^D12>!<MAXCRE_^D8>!SZ.SST>;COUNT/TYPE/CREDITS fields
  4533	003673'01  260 01 0 00 004102'		CALL BSLTHD		;Build the slot header	
  4534	003674'01  201 02 0 00 000001 		MOVEI T1,SCITTY		;Only available service class currently
  4535	003675'01  136 02 0 07 000017 		OPSTR <IDPB T1,>,UNBFA,+UNB.OF(XB)
  4536	003676'01  201 02 0 00 000050 		MOVEI T1,MXSLSI		;Maximum slot size for all slot types
  4537	003677'01  136 02 0 07 000017 		OPSTR <IDPB T1,>,UNBFA,+UNB.OF(XB);As maximum attention slot size
  4538	003700'01  136 02 0 07 000017 		OPSTR <IDPB T1,>,UNBFA,+UNB.OF(XB);As maximum data slot size
  4539	003701'01  201 02 0 00 000000 		MOVEI T1,0
  4540	003702'01  260 01 0 00 002777'		CALL LAP2B0		;Zero slot names
  4541	003703'01  136 02 0 07 000017 		OPSTR <IDPB T1,>,UNBFA,+UNB.OF(XB);No parameters either
  4542	003704'01  205 02 0 00 100000 		MOVX T1,SBSTR		;Indicate that this slot request successfully
  4543	003705'01  260 01 0 00 003357'		CALL CSBDAV		; and entirely completed.
  4544	003706'01  254 00 0 00 003624*		RETSKP
  4545
  4546					;XSLREJ - Format a REJECT Slot in the Transmit Buffer
  4547					;
  4548					;Call:	SB/ Slot Block Address
  4549					;	CB/ Circuit Block Address
  4550					;	XB/ Transmit Buffer Address
  4551					;	CALL XSLREJ
  4552					;	Normal Return
  4553					;
  4554
  4555	003707'01  260 01 0 00 004240'	XSLREJ:	CALL XBFCHK		;Do we have a transmit buffer yet?
  4556	003710'01  263 01 0 00 000000 		  RET			;No, and can't get any.
  4557	003711'01  554 02 0 13 000006 		LOAD T1,SBREA,(SB)	;Get the reject reason code
  4558	003712'01  242 02 0 00 000010 		LSH T1,^D8
  4559	003713'01  201 02 0 02 140000 		MOVEI T1,<ST.REJ_^D12!SZ.REJ>(T1) ;COUNT/TYPE/REASON fields
  4560	003714'01  260 01 0 00 004102'		CALL BSLTHD		;Go build the slot header
  4561	003715'01  205 02 0 00 200000 		MOVX T1,SBREJ		;Indicate that this slot request successfully
  4562	003716'01  260 01 0 00 003357'		CALL CSBDAV		; and entirely completed.
  4563	003717'01  260 01 0 00 003400'		CALL RELSB		;Release the slot.
  4564	003720'01  254 00 0 00 003706*		RETSKP			;That's all there is to a REJECT slot.
  4565
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 102
LATSER	MAC	19-Aug-74 07:34		Slot Formatting Routines

  4566						SUBTTL	Slot Formatting Routines
  4567
  4568					;XSLSTP - Format a STOP Slot in the Transmit Buffer
  4569					;
  4570					;Call:	SB/ Slot Block Address
  4571					;	CB/ Circuit Block Address
  4572					;	XB/ Transmit Buffer Address
  4573					;	CALL XSLSTP
  4574					;	Normal Return
  4575					;
  4576
  4577	003721'01  260 01 0 00 004240'	XSLSTP:	CALL XBFCHK		;Do we have a transmit buffer yet?
  4578	003722'01  263 01 0 00 000000 		  RET			;No, and can't get any.
  4579	003723'01  260 01 0 00 003426'		CALL RLSBID		;Release the local slot block ID.
  4580	003724'01  554 02 0 13 000006 		LOAD T1,SBREA,(SB)	;Get the stop reason code
  4581	003725'01  242 02 0 00 000010 		LSH T1,^D8
  4582	003726'01  201 02 0 02 150000 		MOVEI T1,<ST.STP_^D12!SZ.SSP>(T1) ;COUNT/TYPE/REASON fields
  4583	003727'01  260 01 0 00 004102'		CALL BSLTHD		;Go build the slot header
  4584	003730'01  205 02 0 00 004000 		MOVX T1,SBSTO		;Indicate that this slot request successfully
  4585	003731'01  260 01 0 00 003357'		CALL CSBDAV		; and entirely completed.
  4586	003732'01  260 01 0 00 003400'		CALL RELSB		;Now go release the slot
  4587	003733'01  254 00 0 00 003720*		RETSKP
  4588
  4589					;XSLATT - Format a ATTENTION Slot in the Transmit Buffer
  4590					;
  4591					;Call:	SB/ Slot Block Address
  4592					;	CB/ Circuit Block Address
  4593					;	XB/ Transmit Buffer Address
  4594					;	CALL XSLATT
  4595					;	Normal Return
  4596					;
  4597
  4598	003734'01  260 01 0 00 004240'	XSLATT:	CALL XBFCHK		;Do we have a transmit buffer yet?
  4599	003735'01  263 01 0 00 000000 		  RET			;No, and can't get any.
  4600	003736'01  201 02 0 00 130001 		MOVEI T1,<ST.ATT_^D12!SZ.ATT>;COUNT/TYPE fields
  4601	003737'01  260 01 0 00 004102'		CALL BSLTHD		;Go build the slot header
  4602	003740'01  201 02 0 00 000040 		MOVEI T1,1B30
  4603	003741'01  136 02 0 07 000017 		OPSTRM <IDPB T1,>,UNBFA,+UNB.OF(XB);Deposit control flags
  4604	003742'01  205 02 0 00 040000 		MOVX T1,SBFOU		;Indicate that this slot request successfully
  4605	003743'01  260 01 0 00 003357'		CALL CSBDAV		; and entirely completed.
  4606	003744'01  254 00 0 00 003733*		RETSKP
  4607
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 103
LATSER	MAC	19-Aug-74 07:34		Slot Formatting Routines

  4608						SUBTTL	Slot Formatting Routines
  4609
  4610					;XSLDTA - Format a DATA_A Slot in the Transmit Buffer
  4611					;
  4612					;Call:	W1/ Slot Block Flags
  4613					;	SB/ Slot Block Address
  4614					;	CB/ Circuit Block Address
  4615					;	XB/ Transmit Buffer Address
  4616					;	CALL XSLDTA
  4617					;	Normal Return
  4618
  4619					; If we have transmit credit available, compute the maximum number of terminal
  4620					; output characters which may be entered into the slot.  If we no longer have
  4621					; credit, set the character count to zero.
  4622
  4623	003745'01  265 17 0 00 005043'	XSLDTA:	SAVEAC <W1,W2>
  4624					IFN FTOPS10,<
  4625	003746'01  200 10 0 13 000024 		LOAD	U,SBTDB,(SB)	;Get address of LDB.
  4626									;We will carry this in U for a while
  4627					>;end IFN FTOPS10
  4628	003747'01  554 17 0 13 000005 		OPSTR <SKIPN>,SBXCR,(SB);Do we still have any transmit credit?
  4629	003750'01  336 00 0 00 000017 
  4630	003751'01  254 00 0 00 003760'		IFSKP.
  4631	003752'01  201 14 0 00 000563 		  MOVEI W1,SZ.XBF-SZ.SHD;Get the residual buffer (minus slot header)
  4632	003753'01  274 14 0 07 000016 		  OPSTR <SUB W1,>,UNBSZ,+UNB.OF(XB); count.
  4633					IFN FTOPS20,<
  4634						  LOAD T2,SBTDB,(SB)	;Get address of TDB
  4635						  CAMLE W1,TTOCT(T2)	;Smaller of residual count - 4 and TTOCT
  4636						  MOVE W1,TTOCT(T2)	;TTOCT was smaller
  4637					>;end IFN FTOPS20
  4638	003754'01  554 17 0 13 000003 		  OPSTR <CAMLE W1,>,SBMDS,(SB) ;Compare with maximum DATA_A slot size
  4639	003755'01  313 14 0 00 000017 
  4640	003756'01  554 14 0 13 000003 		  LOAD W1,SBMDS,(SB)	;Maximum allowed by remote is less.
  4641	003757'01  254 00 0 00 003761'		ELSE.
  4642	003760'01  201 14 0 00 000000 		  MOVEI W1,0		;No transmit credits so can't send data.
  4643	003761'01				ENDIF.
  4644
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 104
LATSER	MAC	19-Aug-74 07:34		Slot Formatting Routines

  4645
  4646					IFN FTOPS20,<
  4647					
  4648					; Determine if the remote needs more credits and if we can give him any.  If
  4649					; he doesn't or we can't and there is no terminal output data to be sent(count
  4650					; from above is 0) , exit without building the slot since there is no need to
  4651					; send one.  Otherwise at least a DATA_A slot header will be sent.  If it is 
  4652					; extending credit, there may or may not be output data.
  4653					
  4654						CALL CRECHK		;Check if we can grant more credit remote
  4655						 SKIPE W1		;Can't or don't need to so if there is no data
  4656						SKIPA			; either, no need to send a slot. Otherwise,
  4657						JRST XSLDA3		; send at least empty slot granting new credit.
  4658						MOVE W2,T1		;Save CRECHK result
  4659						CALL XBFCHK		;Do we have a transmit buffer yet?
  4660						  JRST XSLDA3		;No, and can't get any.
  4661						MOVE T1,W2		;Retrieve CHECHK results
  4662						IORI T1,<ST.DTA_^D12>(W1);Fill in the rest of last 2 slot header bytes.
  4663						CALL BSLTHD		;Go build the slot header
  4664						JUMPE W1,XSLDA2		;No slot data and no credits used.
  4665						OPSTRM <ADDM W1,>,UNBSZ,+UNB.OF(XB);Update the total message count.
  4666						JRST XSLDA1		;Enter output data into slot if there is any. 
  4667					XSLDA0:	LOAD T2,SBTDB,(SB)	;Dynamic TT data base
  4668						CALL TTSND		;Get a character from the buffer
  4669						  RET			;Probably PAGE STOP
  4670						OPSTR <IDPB T1,>,UNBFA,+UNB.OF(XB);Enter character into buffer
  4671					XSLDA1:	SOJGE W1,XSLDA0		;Continue if more characters
  4672						LOAD T1,SBXCR,(SB)	;Get our transmit credit count
  4673						SOS T1			;Decrement since we may consume one credit now.
  4674						STOR T1,SBXCR,(SB)	; send data so store decremented credit count.
  4675					
  4676					; Determine whether to slot request was FULLY completed.  If not, don't
  4677					; clear the request bit since it will have to be completed next time around.
  4678					
  4679					XSLDA2:	LOAD T2,SBTDB,(SB)	;Get the TDB address back
  4680						SKIPE TTOCT(T2)		;If there is more data to output, return
  4681						RETSKP			; successfully. Do not clear request bit.
  4682						SETZRO TTOTP,(T2)	;Clear TTY output active if not more data.
  4683						OPSTR <SKIPN>,SBRCR,(SB);If remote has zero credit for transmits 
  4684						RETSKP			; return successfully without clearint request.
  4685						MOVX T1,SBOUT		; Otherwise mark this request as complete.
  4686						CALL CSBDAV
  4687						RETSKP
  4688					
  4689					XSLDA3:	LOAD T2,SBTDB,(SB)	;Get the TDB address
  4690						SKIPE TTOCT(T2)		;If there is no terminal output, clear
  4691						RET			; the TTOTP bit.
  4692						SETZRO TTOTP,(T2)	; ...
  4693						RET			; ...
  4694					
  4695					>;end ifn ftops20
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 105
LATSER	MAC	19-Aug-74 07:34		Slot Formatting Routines

  4696
  4697					IFN FTOPS10,<
  4698					; Determine if the remote needs more credits and if we can give him any.
  4699					; If he doesn't or we can't and there is no terminal output data to be
  4700					; sent, exit without building the slot since there is no need to send
  4701					; one. Otherwise at least a DATA_A slot header will be sent. If it is
  4702					; extending credit, there may or may not be output data. We don't know
  4703					; at this point how many characters SCNSER has for us to send, so just
  4704					; keep trying to get chars until we fill the slot or run out of
  4705					; characters
  4706					;
  4707					;	at this point:
  4708					;	W1/ max characters we can send
  4709					;
  4710	003761'01  213 00 0 00 000014 		MOVNS W1		;Make into
  4711	003762'01  517 00 0 00 000014 		HRLZS W1		;AOBJN word
  4712					;
  4713					;	now:
  4714					;	W1/ -max,,0
  4715					;
  4716	003763'01  322 14 0 00 003774'		JUMPE W1,NOCHR		;We don't have credit to send. Don't get a char
  4717	003764'01  335 00 0 13 000026 		SKIPGE SB.TTO(SB)	;Is there saved character? (SBTTO is sign bit)
  4718	003765'01  254 00 0 00 003773'		  JRST GOTCHR		;Yes
  4719	003766'01  260 01 0 00 000000*		CALL XMTCHR		;No, try to get a character from SCNSER
  4720	003767'01  254 00 0 00 003774'		  JRST NOCHR		;SCNSER doesn't have any for us.
  4721	003770'01  205 17 0 00 400000 		SETONE SBTTO,(SB)	;SCNSER does have one, remember we got it
  4722	003771'01  436 17 0 13 000026 
  4723	003772'01  542 04 0 13 000026 		STOR T3,SBCHR,(SB)	;and save it away
  4724	003773'01  253 14 0 00 003774'	GOTCHR:	AOBJN W1,.+1		;Got a char, count it
  4725	003774'01  260 01 0 00 004113'	NOCHR:	CALL CRECHK		;Check if we can grant more credit remote
  4726	003775'01  602 14 0 00 777777 		  TRNE W1,777777	;Can't or don't need to. See if any data?
  4727	003776'01  334 00 0 00 000000 		SKIPA			;Got data or can grant credit, send a slot
  4728	003777'01  263 01 0 00 000000 		  RET			;No slot to send, just return
  4729	004000'01  200 15 0 00 000002 		MOVE W2,T1		;Save CRECHK result
  4730	004001'01  260 01 0 00 004240'		CALL XBFCHK		;Do we have a transmit buffer yet?
  4731	004002'01  263 01 0 00 000000 		  RET			;No, and can't get any.
  4732	004003'01  554 02 0 13 000005 		LOAD T1,SBXCR,(SB)	;Get our transmit credit count
  4733	004004'01  370 00 0 00 000002 		SOS T1			;Decrement since we may consume one credit now
  4734	004005'01  602 14 0 00 777777 		TRNE W1,777777		;If data count is not zero, we will definitely
  4735	004006'01  506 02 0 13 000005 		  STOR T1,SBXCR,(SB)	;Store updated credit count
  4736					;
  4737					;Can't build slot header yet, since we don't know how many characters
  4738					; we will send.  Save a pointer to the slot character count, and
  4739					; call BSLTHD anyway.  We will stuff the char count later.
  4740					;
  4741					;At this point, the slot byte pointer points to the DST_SLOT_ID
  4742					;
  4743	004007'01  201 02 0 00 000003 		MOVEI T1,3		;the byte count is the 3rd byte of the slot
  4744	004010'01  133 02 0 07 000017 		OPSTR <ADJBP T1,>,UNBFA,+UNB.OF(XB) ;so make a DPB pointer to it
  4745	004011'01  261 01 0 00 000002 		PUSH P,T1		;save first word of byte pointer
  4746	004012'01  261 01 0 00 000003 		PUSH P,T2		;and possible second word
  4747					;
  4748					;Now build the slot header
  4749					;
  4750	004013'01  200 02 0 00 000015 		MOVE T1,W2		;get CRECHK results
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 105-1
LATSER	MAC	19-Aug-74 07:34		Slot Formatting Routines

  4751	004014'01  242 02 0 00 000010 		LSH T1,^D8		;Shift to proper position
  4752	004015'01  435 02 0 00 000000 		IORI T1,<ST.DTA_^D12>	;fill in the flag
  4753	004016'01  260 01 0 00 004102'		CALL BSLTHD		;build the slot header (with bad char count)
  4754	004017'01  606 14 0 00 777777 		TRNN W1,777777		;Is there some data?
  4755	004020'01  254 00 0 00 004032'		  JRST XSLDA2		;No, no characters to move
  4756	004021'01  550 04 0 13 000026 		LOAD T3,SBCHR,(SB)	;Yes, get saved character.
  4757	004022'01  205 17 0 00 400000 		SETZRO SBTTO,(SB)	;And remember we got it.
  4758	004023'01  412 17 0 13 000026 
  4759	004024'01  136 04 0 07 000017 		OPSTR <IDPB T3,>,UNBFA,+UNB.OF(XB) ;Stuff first character into buffer
  4760	004025'01  325 14 0 00 004032'		JUMPGE W1,XSLDA2	;if (heaven help us) there was only space for
  4761									;one character, stop now.
  4762	004026'01  260 01 0 00 003766*	XSLDA0:	CALL XMTCHR		;Get a character from SCNSER
  4763	004027'01  254 00 0 00 004032'		  JRST XSLDA2		;None left
  4764	004030'01  136 04 0 07 000017 		OPSTR <IDPB T3,>,UNBFA,+UNB.OF(XB) ;Stuff a character into buffer
  4765	004031'01  253 14 0 00 004026'		AOBJN W1,XSLDA0		;Count characters done
  4766					;
  4767					; Here we have either filled up the slot or run out of characters.
  4768					; Stuff the actual character count into the slot header.
  4769					;
  4770	004032'01  262 01 0 00 000003 	XSLDA2:	POP P,T2		;retrieve pointer to slot header
  4771	004033'01  262 01 0 00 000002 		POP P,T1		; byte count
  4772	004034'01  137 14 0 00 000002 		DPB W1,T1		;and stuff actual character count
  4773	004035'01  550 02 0 00 000014 		HRRZ T1,W1		;get character count by itself
  4774	004036'01  272 02 0 07 000016 		OPSTRM <ADDM T1,>,UNBSZ,+UNB.OF(XB) ;and update total message count.
  4775	004037'01  550 17 0 13 000005 		OPSTRM <ADDB W2,>,SBRCR,(SB) ;Update his credit count. (remember total)
  4776	004040'01  273 15 0 00 000017 
  4777	004041'01  542 17 0 13 000005 
  4778	004042'01  322 14 0 00 000076*		JUMPE W1,RSKP		;If we don't have any transmit credits, or
  4779	004043'01  332 00 0 00 000015 		SKIPE W2		;If the remote has zero credits for transmits
  4780	004044'01  331 00 0 10 000000*		SKIPL LDBDCH(U)		;Or if SCNSER doesn't think line is idle
  4781							.CREF LDLIDL	;(really checking this bit)
  4782	004045'01  254 00 0 00 003744*		  RETSKP		;Return successfully without clearing request
  4783	004046'01  205 02 0 00 020000 		MOVX T1,SBOUT		;Otherwise, mark this request as complete.
  4784	004047'01  260 01 0 00 003357'		CALL CSBDAV
  4785	004050'01  254 00 0 00 004045*		RETSKP
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 106
LATSER	MAC	19-Aug-74 07:34		Slot Formatting Routines

  4786						SUBTTL	Slot Formatting Routines
  4787
  4788					;XSLDTB - Format a DATA_B Slot in the Transmit Buffer
  4789					;
  4790					;Call:	SB/ Slot Block Address
  4791					;	CB/ Circuit Block Address
  4792					;	XB/ Transmit Buffer Address
  4793					;	CALL XSLDTB
  4794					;	Normal Return
  4795					;
  4796
  4797	004051'01  554 17 0 13 000005 	XSLDTB:	OPSTR <SKIPE>,SBXCR,(SB);Do we still have any transmit credit?
  4798	004052'01  332 00 0 00 000017 
  4799	004053'01  260 01 0 00 004240'		CALL XBFCHK		;Check if we have a transmit buffer yet.
  4800	004054'01  263 01 0 00 000000 		 RET			; Didn't and can't get one.
  4801	004055'01  554 02 0 13 000005 		LOAD T1,SBXCR,(SB)	;Current number of transmit credits available
  4802	004056'01  370 00 0 00 000002 		SOS T1			;Decrement since this slot will consume one.
  4803	004057'01  506 02 0 13 000005 		STOR T1,SBXCR,(SB)	;Store updated credit count
  4804					IFN FTOPS10,<
  4805	004060'01  200 10 0 13 000024 		LOAD	U,SBTDB,(SB)	;Point to LDB
  4806					>;end IFN FTOPS10
  4807	004061'01  260 01 0 00 004113'		CALL CRECHK		;Does remote need credits?
  4808	004062'01  600 00 0 00 000000 		 NOP			;Dont't care if he did and we can't provide
  4809	004063'01  242 02 0 00 000010 		LSH T1,^D8		;Shift to proper position.
  4810	004064'01  435 02 0 00 120005 		IORI T1,<ST.DTB_^D12>!SZ.SDB;Fill in rest of last 2 header bytes.
  4811	004065'01  260 01 0 00 004102'		CALL BSLTHD		;Go build the slot header
  4812	004066'01  201 02 0 00 000011 		MOVEI T1,SL.DXF		 ;Assume disabling XOFF recognition	
  4813					IFN FTOPS20,<
  4814						LOAD T2,SBTDB,(SB)	;Get the terminal data base address
  4815						TMNE TT%PGM,TTFLGS(T2)	
  4816					>;end IFN FTOPS20
  4817					IFN FTOPS10,<
  4818	004067'01  200 10 0 13 000024 		LOAD U,SBTDB,(SB)	;Get LDB address
  4819	004070'01  135 03 0 00 000000#		LDB T2,LDPXNF		;Get XON/XOF flag
  4820	004071'01  332 00 0 00 000003 		SKIPE T2		;disabling XON/XOF recognition?
  4821					>;end IFN FTOPS10
  4822	004072'01  201 02 0 00 000005 		MOVEI T1,SL.EXF		 ;No, enabling	
  4823	004073'01  136 02 0 07 000017 		OPSTR <IDPB T1,>,UNBFA,+UNB.OF(XB);Enter control flags to buffer	
  4824	004074'01  201 02 0 00 010423 		MOVEI T1,<XONC_^D8!XOFFC> ;XON and XOFF characters
  4825	004075'01  260 01 0 00 002777'		CALL LAP2B0		;Enter them into buffer
  4826	004076'01  260 01 0 00 002777'		CALL LAP2B0		;Also input XON/XOFF characters
  4827	004077'01  205 02 0 00 010000 		MOVX T1,SBFCC
  4828	004100'01  260 01 0 00 003357'		CALL CSBDAV
  4829	004101'01  254 00 0 00 004050*		RETSKP
  4830
  4831	004102'01  200 04 0 00 000002 	BSLTHD:	MOVE T3,T1		;Save input arg
  4832	004103'01  550 02 0 13 000004 		LOAD T1,SBLID,(SB)	;Remote slot ID
  4833	004104'01  242 02 0 00 000010 		LSH T1,^D8		;Shift to second byte
  4834	004105'01  554 17 0 13 000004 		OPSTR <IOR T1,>,SBRID,(SB) ;Local slot ID into first byte
  4835	004106'01  434 02 0 00 000017 
  4836	004107'01  260 01 0 00 002777'		CALL LAP2B0		;(Clobbers T2 only.)
  4837	004110'01  200 02 0 00 000004 		MOVE T1,T3		;Get original argument back
  4838	004111'01  260 01 0 00 002777'		CALL LAP2B0		;Enter count/slot type/credits
  4839	004112'01  263 01 0 00 000000 		RET
  4840
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 107
LATSER	MAC	19-Aug-74 07:34		Slot Formatting Routines

  4841
  4842
  4843					;CRECHK - Remote Credit Check Routine
  4844					;
  4845					;Call:	SB/ Slot Block Address
  4846					;	CALL CRECHK
  4847					;	 No-Grant return
  4848					;	Grant return
  4849					;	T1/ <Number to grant>
  4850
  4851					; If the remote has less than the maximum number of transmit credits, try to
  4852					; compute the number of additional credits to grant him and return in T1, 
  4853					;  We can only grant credit
  4854					; if there is room for a non-zero integral number of full slot buffers (of
  4855					; length MXSLSI).
  4856
  4857	004113'01  201 02 0 00 000002 	CRECHK:	MOVEI T1,MAXCRE		;Maximum number of credits remote may have.
  4858	004114'01  550 17 0 13 000005 		OPSTR <SUB T1,>,SBRCR,(SB);His deficiency.
  4859	004115'01  274 02 0 00 000017 
  4860	004116'01  322 02 0 00 003372*		JUMPE T1,RTN		;Can't grant him more-- he already has limit.
  4861	004117'01  200 04 0 00 000002 		MOVE T3,T1		;Save remote's credit deficiency.
  4862					IFN FTOPS20,<
  4863						LOAD T4,SBTDB,(SB)	;Get the terminal dynamic pointer
  4864						LOAD T1,TIMAX,(T4)	;Maximum that will fit in an input buffer
  4865						SUB T1,TTICT(T4)	;Subtract current input count to get whats left
  4866					>;end IFN FTOPS20
  4867					IFN FTOPS10,<
  4868	004120'01  201 02 0 00 000000*		MOVEI T1,TTIWRN		;Get max characters for an input buffer
  4869	004121'01  274 02 0 10 000000*		SUB T1,LDBTIC(U)	;Minus number that have been echoed
  4870	004122'01  274 02 0 10 000000*		SUB T1,LDBECC(U)	;Also minus number that have not yet echoed
  4871					>;end IFN FTOPS10
  4872	004123'01  231 02 0 00 000050 		IDIVI T1,MXSLSI		;Compute number of slot buffer that would fit
  4873					IFN FTOPS10,<
  4874	004124'01  322 02 0 00 004116*		JUMPE T1,RTN	 	;None, so can't grant more.
  4875					>;end IFN FTOPS10
  4876					IFN FTOPS20,<
  4877						JUMPE T1,[SETONE TTFWK,(T4);None, so can't grant more so force
  4878							  JRST RTN]	; the process to wake.
  4879					>;end IFN FTOPS20
  4880	004125'01  313 02 0 00 000004 		CAMLE T1,T3		;Make sure he never gets a total of more than
  4881	004126'01  200 02 0 00 000004 		MOVE T1,T3		; the maximum allowed.
  4882	004127'01  254 00 0 00 004101*		RETSKP
  4883
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 108
LATSER	MAC	19-Aug-74 07:34		Slot Formatting Routines

  4884
  4885
  4886	004130'01  402 00 0 00 000000#	IGNSLT:	SETZM SLTCNT		;Force data to be ignored.
  4887	004131'01  254 00 0 00 004127*		RETSKP			;This is a good return.
  4888
  4889	004132'01  350 00 0 06 000720 	ILLSLT:	OPSTRM <AOS>,HCISR,(HN)	;Increment host count
  4890	004133'01  350 00 0 12 000056 		OPSTRM <AOS>,CCISR,(CB)	; and the per-server count
  4891	004134'01  263 01 0 00 000000 		RET			;Give a bad return
  4892
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 109
LATSER	MAC	19-Aug-74 07:34		-  Queue Handling Routines

  4893						SUBTTL -  Queue Handling Routines
  4894
  4895					;LAQUE - Add an element to the front of a queue
  4896					;
  4897					;Call:	T1/ Address of Queue Header
  4898					;	T2/ Address of Element to Add
  4899					;	CALL LAQUE
  4900					;	Normal Return
  4901					; This routine is used to queue either CBs or SBs.  The queue headers
  4902					; and link words are always two words, and are described by the BEGSTR QL.
  4903					; All elements are linked in both forward and backward directions.
  4904
  4905	004135'01  200 05 0 00 000002 	LAQUE:	MOVE T4,T1		;Save queue header address
  4906	004136'01  332 04 0 02 000000 		OPSTR <SKIPE T3,>,QLFWD,(T1)	;Get old first queue element if any.
  4907	004137'01  200 02 0 00 000004 		MOVE T1,T3		; Old first element or Q header backward
  4908	004140'01  202 03 0 02 000001 		STOR T2,QLBWD,(T1)	; pointer points to new element
  4909	004141'01  202 03 0 05 000000 		STOR T2,QLFWD,(T4)	;Store new first queue element
  4910	004142'01  402 00 0 03 000001 		SETZRO QLBWD,(T2)	;Zero its backward pointer
  4911	004143'01  202 04 0 03 000000 		STOR T3,QLFWD,(T2)	;Set up its forward pointer
  4912	004144'01  263 01 0 00 000000 		RET
  4913
  4914					;LAUNQ - Dequeue a queue element
  4915					;
  4916					;Call:	T1/ Address of queue header
  4917					;	T2/ Address of queue element to be unqueued
  4918					;	CALL LAUNQ
  4919					;	Normal return
  4920					;
  4921					;Uses:	T3,T4
  4922
  4923	004145'01  200 04 0 03 000001 	LAUNQ:	LOAD T3,QLBWD,(T2)	;Get elements backward pointer
  4924	004146'01  200 05 0 03 000000 		LOAD T4,QLFWD,(T2)	;Get its forward ptr also.
  4925	004147'01  336 03 0 00 000005 		SKIPN T2,T4		;Remove the element from the backward list
  4926	004150'01  415 03 0 02 000000 		XMOVEI T2,QL.FWD(T1)	; by updating the backward
  4927	004151'01  202 04 0 03 000001 		STOR T3,QLBWD,(T2)	; ptr of either next Q element or Q head
  4928	004152'01  332 00 0 00 000004 		SKIPE T3		;If backward ptr 0 update Q head forward ptr
  4929	004153'01  415 02 0 04 000000 		XMOVEI T1,QL.FWD(T3)	; otherwise  update that of the previous Q
  4930	004154'01  202 05 0 02 000000 		STOR T4,QLFWD,(T1)	; element
  4931	004155'01  263 01 0 00 000000 		RET
  4932
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 110
LATSER	MAC	19-Aug-74 07:34		-  Queue Handling Routines

  4933	
  4934
  4935					;QUE1WB - Routine to queue and element to the back of a 1 directional queue.
  4936					;
  4937					;Call:	T1/ address of Q header block
  4938					;	T2/ address of queue element to add to queue
  4939					;	CALL QUE1WB
  4940					;	Normal return
  4941
  4942	004156'01  336 04 0 02 000001 	QUE1WB:	OPSTR <SKIPN T3,>,QLBWD,(T1);Address of first element on Q
  4943	004157'01  200 04 0 00 000002 		MOVE T3,T1		;Zero, Q header fwd ptr points to new element
  4944	004160'01  202 03 0 04 000000 		STOR T2,QLFWD,(T3)	;Update forward ptr of Q hdr or old Q tail
  4945	004161'01  402 00 0 03 000000 		SETZRO QLFWD,(T2)	;Zero new elements forward ptr
  4946	004162'01  202 03 0 02 000001 		STOR T2,QLBWD,(T1)	;New tail ptr
  4947	004163'01  263 01 0 00 000000 		RET
  4948
  4949					;UNQ1WF - Routine to remove an element from the front of a 1 directional queue.
  4950					;
  4951					;Call:	T1/ address of the Q header block
  4952					;	CALL UNQ1WF
  4953					;	 Error return - queue emtpy	
  4954					;	Normal return
  4955					;	T2/ address of element
  4956
  4957	004164'01  336 03 0 02 000000 	UNQ1WF:	OPSTR <SKIPN T2,>,QLFWD,(T1);Address of first element on Q
  4958	004165'01  263 01 0 00 000000 		RET			;Zero, so queue is empty
  4959	004166'01  336 04 0 03 000000 		OPSTR <SKIPN T3,>,QLFWD,(T2);If only 1 element on Q then update
  4960	004167'01  202 04 0 02 000001 		STOR T3,QLBWD,(T1)	; the Q headers tail ptr (set to 0)
  4961	004170'01  202 04 0 02 000000 		STOR T3,QLFWD,(T1)	;There is a new head of the Q (or 0)
  4962	004171'01  254 00 0 00 004131*		RETSKP			;Return with the Q element in T2
  4963
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 111
LATSER	MAC	19-Aug-74 07:34		- Buffer Handling Routines - Transmit Buffers

  4964						SUBTTL - Buffer Handling Routines - Transmit Buffers
  4965
  4966					;GETXBH - Get the necessary number of transmit buffer headers
  4967					;
  4968					;Call:	CB/ Address of the circuit block
  4969					;	CALL GETXBH
  4970					;	  Error return - insufficient resources
  4971					;	Normal return
  4972
  4973	004172'01  205 14 0 00 777776 	GETXBH:	MOVSI W1,-MAXXBF	;Number of buffers to get
  4974	004173'01  201 02 0 00 000047 	GTXNXT:	MOVEI T1,<<MINXBF+3>/4+XBF.OF>;Buffer length to get
  4975	004174'01  260 01 0 00 004471'		CALL MMGTZW		;Go get the storage
  4976	004175'01  254 00 0 00 004213'		 JRST GTXFL		;Failed to get all that are needed
  4977	004176'01  205 03 0 00 441000 		MOVX T2,<POINT 8,0>
  4978	004177'01  202 03 0 02 000027 		STOR T2, MDAUX,+MDB.OF(T1);
  4979	004200'01  201 03 0 00 000010 		MOVEI T2,SZ.MHD		;The message header always has 
  4980	004201'01  202 03 0 02 000030 		STOR T2,MDBYT,+MDB.OF(T1); 8 bytes.
  4981	004202'01  201 03 0 00 000000 		MOVEI T2,VMC.XC		;Always use exec virtual paging
  4982	004203'01  137 03 0 00 005062'		STOR T2,MDVMC,+MDB.OF(T1)		; ...
  4983	004204'01  415 03 0 02 000033 		XMOVEI T2,<XBF.OF>(T1)	;
  4984	004205'01  202 03 0 02 000032 		STOR T2,MDALA,+MDB.OF(T1);Address of start of header
  4985	004206'01  200 03 0 00 000002 		MOVE T2,T1		;Now queue to circuit blocks queue of free
  4986	004207'01  415 02 0 12 000011 		XMOVEI T1,CB.XBQ(CB)	; transmit buffers
  4987	004210'01  260 01 0 00 004156'		CALL QUE1WB		; ...
  4988	004211'01  253 14 0 00 004173'		AOBJN W1,GTXNXT		;Get as many as required
  4989	004212'01  254 00 0 00 004171*		RETSKP
  4990
  4991					; Failed to get the nececessary number of buffers. Must free those
  4992					; which we did get.
  4993
  4994	004213'01  415 02 0 12 000011 	GTXFL:	XMOVEI T1,CB.XBQ(CB)	;Unqueu each from the transmit free Q
  4995	004214'01  260 01 0 00 004164'		CALL UNQ1WF		; ...
  4996	004215'01  263 01 0 00 000000 		 RET			;No more there so return with error
  4997	004216'01  200 02 0 00 000003 		MOVE T1,T2		;Give back the buffer to the memory
  4998	004217'01  260 01 0 00 004501'		CALL MMFREE		; manager
  4999	004220'01  254 00 0 00 004213'		JRST GTXFL		; and continue looping til all returned
  5000
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 112
LATSER	MAC	19-Aug-74 07:34		- Buffer Handling Routines - Transmit Buffers

  5001
  5002
  5003					;GETXBF - Get one long transmit buffer for real data
  5004					;
  5005					;Call:	CB/ Address of the circuit block
  5006					;	XB/ Address of the 1st MSD (header)	
  5007					;	CALL GETXBH
  5008					;	  Error return - insufficient resources
  5009					;	Normal return
  5010					;	T3/ MSD address (also saved in MD.NXT+MDB.OF(XB))
  5011
  5012	004221'01  201 02 0 00 000575 	GETXBF:	MOVEI T1,XBFSIZ		;Buffer length to get
  5013					IFN FTOPS20,<CALL MMGTZW>
  5014	004222'01  260 01 0 00 004431'	IFN FTOPS10,<CALL GETZBF>	;Go get the storage
  5015	004223'01  263 01 0 00 000000 		  RET			;No luck!
  5016	004224'01  200 04 0 00 000002 		MOVE T3,T1
  5017	004225'01  400 02 0 00 000000 		SETZ T1,
  5018	004226'01  205 03 0 00 441000 		MOVX T2,<POINT 8,0>
  5019	004227'01  202 03 0 04 000002 		STOR T2,MDAUX,(T3);Byte pointer to message
  5020	004230'01  201 02 0 00 000567 		MOVEI T1,SZ.XBF
  5021	004231'01  202 02 0 04 000003 		STOR T1,MDBYT,(T3);Zero length
  5022	004232'01  201 02 0 00 000000 		MOVEI T1,VMC.XC		;Always use exec virtual paging
  5023	004233'01  137 02 0 00 005063'		STOR T1,MDVMC,(T3); ...
  5024	004234'01  415 02 0 04 000006 		XMOVEI T1,<MD.LEN>(T3)	;
  5025	004235'01  202 04 0 07 000025 		MOVEM T3,MD.NXT+MDB.OF(XB) ;Link header MSD to this
  5026	004236'01  202 02 0 04 000005 		STOR T1,MDALA,(T3)	;Message address
  5027	004237'01  254 00 0 00 004212*		RETSKP
  5028
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 113
LATSER	MAC	19-Aug-74 07:34		- Buffer Handling Routines - Transmit Buffers

  5029
  5030
  5031					;XBFCHK - Check for Transmit buffer
  5032					;
  5033					;Call:	XB/
  5034					;	CALL XBFCHK
  5035					;	 Error Return
  5036					;	Normal Return
  5037
  5038	004240'01  332 04 0 07 000025 	XBFCHK:	SKIPE T3,MD.NXT+MDB.OF(XB)		;If we already have one,
  5039	004241'01  254 00 0 00 004237*		  RETSKP		;return
  5040	004242'01  260 01 0 00 004221'		CALL GETXBF		;Get an MSD transmit buffer
  5041	004243'01  263 01 0 00 000000 	  	  RET			;None available, return failure
  5042	004244'01  415 02 0 04 000006 		XMOVEI T1,<MD.LEN>(T3)	;Make a one word 8 bit
  5043	004245'01  661 02 0 00 540000 		TLO T1,(<OWGP. 8,0>)		;Global byte pointer and save as
  5044	004246'01  202 02 0 07 000017 		STOR T1,UNBFA,+UNB.OF(XB); message byte pointer.
  5045	004247'01  254 00 0 00 004241*		RETSKP
  5046
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 114
LATSER	MAC	19-Aug-74 07:34		- Buffer Handling Routines - Transmit Buffers

  5047
  5048
  5049					;RFXBFS - Release all free transmit buffers
  5050					;
  5051					;Call:	CB/ circuit block address
  5052					;	CALL RFXBFS
  5053					;	Normal return
  5054					;
  5055
  5056	004250'01  415 02 0 12 000011 	RFXBFS:	XMOVEI T1,CB.XBQ(CB)	;Address of the free xmit buffer queue
  5057	004251'01  260 01 0 00 004164'		CALL UNQ1WF		;Unqueue the head of the Q
  5058	004252'01  263 01 0 00 000000 		 RET
  5059	004253'01  200 07 0 00 000003 		MOVE XB,T2		;Put buffer address where RELXBH wants it
  5060	004254'01  260 01 0 00 004262'		CALL RELXBH		;Go release it
  5061	004255'01  254 00 0 00 004250'		JRST RFXBFS		;Get next
  5062
  5063					;RELXBF - Release Transmit Buffer
  5064					;
  5065					;Call:	XB/ Address of buffer header
  5066					;	CALL RELXBF
  5067					;	Normal return
  5068
  5069	004256'01  201 02 0 00 000000 	RELXBF:	MOVEI T1,0
  5070	004257'01  250 02 0 07 000025 		EXCH T1,MD.NXT+MDB.OF(XB);If there is no MSD style buffer
  5071	004260'01  322 02 0 00 004124*		JUMPE T1,RTN			; then just return
  5072					IFN FTOPS20,<CALLRET MMFREE>
  5073	004261'01  254 00 0 00 004455'	IFN FTOPS10,<CALLRET GIVBF>	; and free the MSD's storage.
  5074
  5075					;RELXBH - Release Transmit Buffer Header and Buffer
  5076					;
  5077					;Call:	XB/ Address of buffer header
  5078					;	CALL RELXBH
  5079					;	Normal return
  5080
  5081	004262'01  260 01 0 00 004256'	RELXBH:	CALL RELXBF		;Release the buffer first
  5082	004263'01  200 02 0 00 000007 		MOVE T1,XB		;Now the header
  5083	004264'01  260 01 0 00 004501'		CALL MMFREE
  5084	004265'01  263 01 0 00 000000 		RET
  5085
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 115
LATSER	MAC	19-Aug-74 07:34		- Buffer Handling Routines - Receive Buffers

  5086						SUBTTL - Buffer Handling Routines - Receive Buffers
  5087
  5088					;GETRBF - Get a Receive buffer
  5089					;
  5090					;Call:	CALL GETRBF
  5091					;	 Error return - no receive buffers
  5092					;	Normal Return
  5093					;
  5094					; This routine checks to see if enough receive buffers have been posted
  5095					; to the NI DLL to support the number of currently active circuits plus
  5096					; a new one.  If  buffers are needed and can be obtained, they are posted
  5097					; directly to the NI DLL.  If some are needed, and cannot be obtained,
  5098					; the error return is taken.
  5099
  5100	004266'01  554 02 0 06 000007 	GETRBF:	LOAD T1,HNNRB,(HN)	;Do check to see if we need more buffers.
  5101	004267'01  550 03 0 06 000002 		LOAD T2,HNNAC,(HN)
  5102	004270'01  301 02 0 03 000001 		CAIL T1,1(T2)
  5103	004271'01  254 00 0 00 004247*		  RETSKP		;No additional are needed. Return success.
  5104	004272'01  201 02 0 00 000615 		MOVEI T1,RBFSIZ		;Receive buffer size
  5105					IFN FTOPS20,<CALL MMGTZW>
  5106	004273'01  260 01 0 00 004431'	IFN FTOPS10,<CALL GETZBF>	;Get the number of required buffers
  5107	004274'01  263 01 0 00 000000 		  RET			;Can't, return error.
  5108	004275'01  260 01 0 00 003022'		CALL RBPOSS		;Post the receive buffer to NISRV
  5109	004276'01  254 00 0 00 004455'	IFN FTOPS10,<CALLRET GIVBF>
  5110					IFN FTOPS20,<CALLRET MMFREE>	;Couldn't post it so free it.
  5111	004277'01  554 17 0 06 000007 		OPSTRM <AOS>,HNNRB,(HN);Increment the number of receive buffers
  5112	004300'01  350 00 0 00 000017 
  5113	004301'01  506 17 0 06 000007 
  5114	004302'01  254 00 0 00 004271*		RETSKP		;Return success
  5115
  5116					;RELRBF - Release a Receive buffer
  5117					;
  5118					;Call:	RB/ Address of the buffer to release
  5119					;	CALL RELRBF
  5120					;	Normal Return
  5121					;
  5122					; This routine frees a receive buffer if there is already a sufficient number
  5123					; posted to the NI DLL otherwise the buffer is re-posted to the NI DLL.
  5124
  5125	004303'01  554 02 0 06 000007 	RELRBF:	LOAD T1,HNNRB,(HN)	;Do we still need this buffer?
  5126	004304'01  550 03 0 06 000002 		LOAD T2,HNNAC,(HN)
  5127	004305'01  303 02 0 03 000001 		CAILE T1,1(T2)
  5128	004306'01  254 00 0 00 004313'		 JRST RELRB0		;No, so free it
  5129	004307'01  200 02 0 00 000011 		MOVE T1,RB		;Yes, so
  5130	004310'01  260 01 0 00 003023'		CALL RBPOST		; re-post it to NISRV
  5131	004311'01  254 00 0 00 004313'		 JRST RELRB0		;NISRV could not accept it?! Release it.
  5132	004312'01  263 01 0 00 000000 		RET			;Successfully re-posted. Return.
  5133	004313'01  200 02 0 00 000011 	RELRB0:	MOVE T1,RB		;Here to free the buffer.
  5134	004314'01  260 01 0 00 004455'	IFN FTOPS10,<CALL GIVBF>
  5135					IFN FTOPS20,<CALL MMFREE>
  5136	004315'01  554 17 0 06 000007 		OPSTRM <SOS>,HNNRB,(HN)	;Reduce the number of receive buffers
  5137	004316'01  370 00 0 00 000017 
  5138	004317'01  506 17 0 06 000007 
  5139	004320'01  263 01 0 00 000000 		RET
  5140
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 116
LATSER	MAC	19-Aug-74 07:34		- Buffer Handling Routines - Receive Buffers

  5141					IFN FTOPS10,<
  5142						SUBTTL	SCNSER DEVICE DEPENDANT ROUTINES
  5143					;
  5144					;	TOPS10 does not call a device dependant routine for each output
  5145					;	  character. Nor does it call a routine to change TTY PAGE.
  5146					;	At each scheduler interval, we scan all LDBs in LATSER's queue
  5147					;	to see what must be done with each one.
  5148					;
  5149	004321'01  201 02 0 00 000000#	LATSCN:	MOVEI T1,LATRTQ			;Get SCNSER's queue header
  5150	004322'01  260 01 0 00 000000*		CALL TOTAKE			;Get next active LDB on the chain
  5151	004323'01  263 01 0 00 000000 		  RET				;None. Just return.
  5152	004324'01  336 13 0 10 003464*		SKIPN SB,LDBLAT(U)		;Get slot block address
  5153	004325'01  263 01 0 00 000000 		  RET				;None. This guy's a loser so punt.
  5154	004326'01  201 02 0 00 000000 		MOVEI T1,0			;T1 will get Slot flags
  5155	004327'01  201 04 0 00 000000*		MOVEI T3,L1RCHP
  5156	004330'01  612 04 0 10 000000*		TDNE T3,LDBBYT(U)		;Need to change parameters?
  5157	004331'01  260 01 0 00 004336'		  PUSHJ P,LATCHP		;Yes. See what needs change and set T1
  5158	004332'01  661 02 0 00 020000 		TXO T1,SBOUT		;Always set flag for output. Check later anyway
  5159					;
  5160					; Here if we MIGHT have characters to output, or need to change TTY PAGE
  5161					;
  5162	004333'01  200 12 0 13 000025 		MOVE CB,SB.CBA(SB)	;And associated circuit block address
  5163	004334'01  260 01 0 00 003346'		CALL SSBDAV		;And set this slot's flags
  5164	004335'01  254 00 0 00 004321'		JRST LATSCN		;Look at next LDB in the queue
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 117
LATSER	MAC	19-Aug-74 07:34		SCNSER DEVICE DEPENDANT ROUTINES

  5165
  5166					;
  5167					;Routine to see if we need to change recognition of XON/XOFF
  5168					;
  5169					;Call:	U/ LDB address
  5170					;
  5171					;Return:	Flag SBFCC set in T1 if we need to change
  5172					;
  5173	004336'01  412 04 0 10 004330*	LATCHP:	ANDCAM T3,LDBBYT(U)	;Turn off CHP bit to show we checked
  5174	004337'01  135 03 0 00 000000#		LDB T2,LDPXNF		;Get TTY PAGE bit
  5175	004340'01  135 04 0 00 005057'		LOAD T3,SBXNF,(SB)	;Get bit that says what the LAT knows
  5176	004341'01  316 03 0 00 000004 		CAMN T2,T3		;Are they already the same?
  5177	004342'01  263 01 0 00 000000 		 RET			;Yes, no need to send a message, then
  5178	004343'01  661 02 0 00 010000 		TXO T1,SBFCC		;Different. Need to send a message
  5179	004344'01  137 03 0 00 005057'		STOR T2,SBXNF,(SB)	;AND remember what we are now.
  5180	004345'01  263 01 0 00 000000 		RET
  5181					>;end IFN FTOPS10
  5182						ENDAV.
  5183
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 118
LATSER	MAC	19-Aug-74 07:34		SCNSER DEVICE DEPENDANT ROUTINES

  5184					IFN FTOPS20,<
  5185						SUBTTL	TTYSRV DEVICE DEPENDENT ROUTINES
  5186					
  5187					LTSTRO::MOVX T1,SBOUT
  5188						SETONE TTOTP,(T2)	;Set output active
  5189						JRST LTSSDC
  5190					LTCOBF::MOVX T1,SBFOU
  5191						JRST LTSSDC
  5192					LTEXF::	MOVX T1,SBFCC
  5193					LTSSDC:	ACVAR <HN,XB,RB,CB,SB,W1,W2>
  5194						NOSKD1
  5195						CHNOFF DLSCHN
  5196						SKIPN SB,TTDEV(T2)	;Get the slot data base from TDB if not 0
  5197						JRST LTSSD0
  5198						MOVE CB,SB.CBA(SB)	;Get the circuit data base from slot block.
  5199						SAVEAC <T2>		;TTYSRV needs T2 returned intact
  5200						CALL SSBDAV
  5201					LTSSD0:	CHNON DLSCHN
  5202						OKSKD1
  5203						RET
  5204					
  5205					; TTYSRV Device Dependent Routine to see if SENDAL should be done on this
  5206					; line.  
  5207					; Call:	T2/ Line Number
  5208					;	Non-skip Return/ Skip SENDALL to this Line
  5209					;	Skip Return    / Do SENDALL to this Line
  5210					
  5211					LTSALL::SKIPG TTACTL(T2)	;Is line fully active?
  5212						RET			;No, don't do SENDALL
  5213						RETSKP			;Yes, do the SENDALL
  5214					
  5215					; TTYSRV device dependent routine to perform hang-up action
  5216					;
  5217					;Call:	T2/ Line Number
  5218					
  5219					LTHNGU::SAVEAC <T2>		;Caller wants this back intact
  5220						CALL STADYN		;Get the dynamic data base
  5221						 RET			;There is none
  5222						MOVX T1,SBSTO		;Mark to send STOP slot if necessary
  5223						CALL LTSSDC		;(CALLRET won't work here)
  5224						RET
  5225					
  5226					; TTYSRV device dependent routine to see if output is possible on a line
  5227					;
  5228					; Call:	T2/ TDB Address
  5229					;	Non-skip Return/ Output not possible
  5230					;	Skip Return    / Output possible
  5231					
  5232					LTTCOU::RETSKP
  5233					
  5234					; TTYSRV device dependent routine to set LAT Host terminal lines as 
  5235					; high speed lines.
  5236					;
  5237					;RETSKP always with:
  5238					;	T3/ ^D9600 to simulate high speed output
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 118-1
LATSER	MAC	19-Aug-74 07:34		SCNSER DEVICE DEPENDANT ROUTINES

  5239					;	T4/ IBFRC1 the high speed terminal characteristics word
  5240					
  5241					LTSOF::	MOVEI T3,^D9600		;Fake 9600 baud
  5242						MOVE T4,IBFRC1		;High speed buffer word
  5243						RETSKP			;Always
  5244					>;end IFN FTOPS20
  5245
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 119
LATSER	MAC	19-Aug-74 07:34		SCNSER DEVICE DEPENDANT ROUTINES

  5246					IFN FTOPS10,<
  5247						SUBTTL  More SCNSER device dependant routines
  5248
  5249					;Routine LTHNGU - LAT "disconnect" function
  5250					;Called by SCNSER thru ISRREM entry point in dispatch vector with
  5251					; a function code if IRRDSC in T3
  5252					;
  5253					;	U/ LDB address
  5254					;	T3/IRRDSC
  5255					;	CALL LTHNGU
  5256					;	Returns +2 always (note: there is no "error" return)
  5257					;
  5258	004346'01  205 02 0 00 004000 	LTHNGU:	MOVX T1,SBSTO		;Yes, we want to stop this slot
  5259	004347'01  260 01 0 00 004360'		CALL LTSSDC		;SO do it
  5260	004350'01  254 00 0 00 004302*		RETSKP			;And indicate success to SCNSER
  5261					;
  5262					;Routine LATREM
  5263					;Called from SCNSER through dispatch vector element ISRREM (7)
  5264					;
  5265					;	U/ LDB address
  5266					;	T3/ Function code
  5267					;		Possible values are:
  5268					;		(1) Input buffer low (ignored)
  5269					;		(2) Input character not stored (ignored)
  5270					;		(IRRSCG) Eat all output characters
  5271					;		(IRRDSC) Disconnect LAT terminal
  5272					;		(IRRTMO) Disconnect idle terminal
  5273					;
  5274	004351'01  306 04 0 00 000005 	LATREM:	CAIN T3,IRRDSC		;Is the the "disconnect" function?
  5275	004352'01  254 00 0 00 004346'		  CALLRET LTHNGU	;Yes, do it.
  5276	004353'01  306 04 0 00 000007 		CAIN T3,IRRTMO		;Is it the "timeout" function?
  5277	004354'01  254 00 0 00 004346'		  CALLRET LTHNGU	;Yes, do it.
  5278	004355'01  302 04 0 00 000003 		CAIE T3,IRRSCG		;Is it "send character gobbler"?
  5279	004356'01  263 01 0 00 000000 		  RET			;No, those are all we know about
  5280	004357'01  205 02 0 00 040000 	LTCOBF:	MOVX T1,SBFOU		;User hit ^O, tell remote to gobble output
  5281	004360'01  265 17 0 00 004763'	LTSSDC:	ACVAR <HN,XB,RB,CB,SB,W1,W2>
  5282	004361'01  260 01 0 00 001756*		ETHLOK			;Interlock against races
  5283	004362'01  336 13 0 10 004324*		SKIPN SB,LDBLAT(U)	;Get slot data base from LDB
  5284	004363'01  254 00 0 00 004366'		  JRST LTSSD0		;Not there any more, ignore
  5285	004364'01  200 12 0 13 000025 		MOVE CB,SB.CBA(SB)	;Get circuit data base from slot block.
  5286	004365'01  260 01 0 00 003346'		CALL SSBDAV
  5287	004366'01  260 01 0 00 001762*	LTSSD0:	ETHULK			;Release interlock
  5288	004367'01  263 01 0 00 000000 		RET
  5289					>;end IFN FTOPS10
  5290				
  5291
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 120
LATSER	MAC	19-Aug-74 07:34		General Untility Routines

  5292						SUBTTL	General Untility Routines
  5293
  5294					;
  5295					;RANDOM - get a "random" number
  5296					;
  5297					;Call:	T1/ Maximum number allowed
  5298					;	CALL RANDOM
  5299					;	Normal Return
  5300					;	T1/ Random Number
  5301
  5302	004370'01  200 05 0 00 000002 	RANDOM:	MOVE T4,T1		;Save for modulo
  5303					IFN FTOPS20,<
  5304						CALL LGTAD		;Get internal time and date
  5305					>;end IFN FTOPS20
  5306					IFN FTOPS10,<
  5307	004371'01  200 02 0 00 000000*		MOVE T1,DATE		;get TOPS-10 time and date
  5308					>;end IFN FTOPS10
  5309	004372'01  405 02 0 00 777777 		ANDI T1,777777		;Time only
  5310	004373'01  230 02 0 00 000005 		IDIV T1,T4		;MODULO max, (which is the remainder in T2)
  5311	004374'01  336 02 0 00 000003 		SKIPN T1,T2		;GET remainder
  5312	004375'01  201 02 0 00 000001 		MOVEI T1,1		;But if it's zero, make it 1
  5313	004376'01  263 01 0 00 000000 		RET
  5314
  5315						ENDAV.
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 121
LATSER	MAC	19-Aug-74 07:34		General Untility Routines

  5316
  5317
  5318	004377'01			DYNRAT:
  5319					IFN FTOPS20,<	FIXR T1,RJAV+2		;15 minute load average>
  5320	004377'01  201 02 0 00 000001 	IFN FTOPS10,<	MOVEI	T1,1		;FOO>
  5321	004400'01  263 01 0 00 000000 		RET
  5322
  5323
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 122
LATSER	MAC	19-Aug-74 07:34		General Untility Routines

  5324
  5325						SUBTTL	LAGTCR - LAT memory management routines
  5326
  5327					;
  5328					;	Subroutine to tell COMMON how much core LAT needs at ONCE time
  5329					;
  5330					;Call:	CALL LAGTCR
  5331					;
  5332					;Return: +1 always with T1/ size of memory LAT needs, which is:
  5333					;
  5334					;		Space for 1 outstanding receive buffer +
  5335					;		 for each possible open circuit: MAXXBF transmit buffers
  5336					;		  + 1 receive buffer
  5337
  5338					;	MAX.(BUFSIZ,<RBFSIZ,XBFSIZ>)	;BUFSIZ is size of largest buffer
  5339					;	BUFSIZ==BUFSIZ+QL.LEN		;we need + 2 words for linking list
  5340		   	   000000*		BUFSIZ==PAGSIZ##	;Oh, the hell with it! receive buffers have
  5341									;to be contiguous, so don't bother to
  5342									;split a buffer across a page boundary.
  5343									;Luckily, the actual size of a buffer
  5344									;is slightly smaller than a page.
  5345					;
  5346
  5347
  5348	004401'01			LAGTCR::
  5349	004401'01  201 02 0 00 000000#		MOVEI T1,<BUFSIZ*NBUFS>
  5350	004402'01  263 01 0 00 000000 		RET
  5351
  5352					;
  5353					;	Routine to ask for more memory from user free core
  5354					;	We should get it a tick or two later.
  5355					;
  5356	004403'01  332 02 0 00 000000#	CHKWFB:	SKIPE T1,LATWFB		;Do we want any more buffers?
  5357	004404'01  332 00 0 00 000000#		SKIPE LATRFB		;And have we not yet aksed for them?
  5358	004405'01  263 01 0 00 000000 		  RET			;No to either, don't get memory now.
  5359					;
  5360					;	Here we have finally decided it's our turn to ask for some memory
  5361					;
  5362	004406'01  221 02 0 00 001100*		IMULI T1,BUFSIZ		;Calculate how many words
  5363	004407'01  622 02 0 00 000000*		TRZE T1,PG.BDY##	;Round up to page bound
  5364	004410'01  271 02 0 00 004406*		ADDI T1,PAGSIZ##
  5365	004411'01  202 02 0 00 000000#		MOVEM T1,LATRFB		;Remember how many words we asked for.
  5366	004412'01  242 02 0 00 000000*		LSH T1,W2PLSH##		;Convert to pages
  5367	004413'01  505 02 0 00 000005 		HRLI T1,(MS.SCA)	;Section to allocate from
  5368	004414'01  265 03 0 00 000000*		JSP T2,GETCLP##		;Ask for the space and wait for it
  5369									;T2 contains callback routine address
  5370					;
  5371					;	CHKRFB - Routine called when VMSER gave us memory
  5372					;		If so, link it into free buffer list
  5373					;
  5374	004415'01  200 05 0 00 000002 	CHKRFB:	MOVE T4,T1		;Get address of start
  5375	004416'01  400 02 0 00 000000 		SETZ T1,		;Get a zero
  5376	004417'01  250 02 0 00 000000#		EXCH T1,LATRFB		;Get number of pages we wanted (and clear it)
  5377	004420'01  231 02 0 00 004410*		IDIVI T1,BUFSIZ		;Convert to number of buffers
  5378	004421'01  272 02 0 00 000000#		ADDM T1,LATNFB		;Indicate that we've got more
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 122-1
LATSER	MAC	19-Aug-74 07:34		LAGTCR - LAT memory management routines

  5379	004422'01  200 03 0 00 000005 		MOVE T2,T4		;Get address of first buffer
  5380	004423'01  200 05 0 00 000002 		MOVE T4,T1		;save buffer count
  5381	004424'01  201 02 0 00 000000#	ALCBUF:	MOVEI T1,LATFRE		;QUEUE header for LAT free core
  5382	004425'01  260 01 0 00 004156'		CALL QUE1WB		;Link this buffer to the list.
  5383	004426'01  271 03 0 00 004420*		ADDI T2,BUFSIZ		;Point to next one.
  5384	004427'01  367 05 0 00 004424'		SOJG T4,ALCBUF		;Until all buffers have been allocated.
  5385	004430'01  263 01 0 00 000000 		RET
  5386					;
  5387					;	GETZBF - Routine to get a receive or transmit buffer and zero it.
  5388					;
  5389					;Call:	T1/ required size
  5390					;Return: +1 failure
  5391					;	 +2 success T1/ address of buffer
  5392					;
  5393	004431'01  261 01 0 00 000002 	GETZBF:	PUSH P,T1		;Save size wanted
  5394	004432'01  201 02 0 00 000000#		MOVEI T1,LATFRE		;Address of queue header for free pool
  5395	004433'01  260 01 0 00 004164'		CALL UNQ1WF		;Get a buffer
  5396	004434'01  254 00 0 00 000107*		  JRST TPOPJ		;Couldn't, restore T1 and return.
  5397	004435'01  370 00 0 00 000000#		SOS LATNFB		;One less free buffer
  5398	004436'01  261 01 0 00 000003 		PUSH P,T2		;SAVE ADDRESS OF BUFFER
  5399	004437'01  415 04 0 03 000001 		XMOVEI T3,1(T2)		;POINT TO SECOND WORD
  5400	004440'01  402 00 0 03 000000 		SETZM (T2)		;ZERO FIRST WORD
  5401	004441'01  201 02 0 00 000000#		MOVEI T1,BUFSIZ-1	;SET UP TO ZERO THE WHOLE BLOCK
  5402	004442'01  123 02 0 00 004567'		XBLT. T1		;DO IT
  5403	004443'01  262 01 0 00 000003 		POP P,T2		;RESTORE ADDRESS
  5404	004444'01  262 01 0 00 000002 		POP P,T1		;Restore size
  5405	004445'01  505 02 0 00 544164 		HRLI T1,'LAT'		;check word
  5406	004446'01  202 02 0 03 000000 		MOVEM T1,(T2)		;save <'LAT',,size> as first word
  5407	004447'01  550 04 0 00 000002 		HRRZ T3,T1		;Isolate size
  5408	004450'01  270 04 0 00 000003 		ADD T3,T2		;Point to end of buffer
  5409	004451'01  505 02 0 00 455644 		HRLI T1,'END'
  5410	004452'01  202 02 0 04 000001 		MOVEM T1,1(T3)
  5411	004453'01  415 02 0 03 000001 		XMOVEI T1,1(T2)		;POINT to address of data portion
  5412	004454'01  254 00 0 00 004350*		RETSKP
  5413
  5414					;
  5415					;	GIVBF - Routine to give back a buffer to free pool
  5416					;
  5417					;Call:	T1/ address of data portion of buffer
  5418					;Return: +1 always
  5419					;
  5420	004455'01  275 02 0 00 000001 	GIVBF:	SUBI T1,1		;Point to size word
  5421	004456'01  554 03 0 02 000000 		HLRZ T2,(T1)		;Get check code
  5422	004457'01  550 04 0 02 000000 		HRRZ T3,(T1)		;Get size
  5423	004460'01  270 04 0 00 000002 		ADD T3,T1		;Point to near end of buffer
  5424	004461'01  554 04 0 04 000001 		HLRZ T3,1(T3)		;Get ending check code
  5425	004462'01  306 04 0 00 455644 		CAIN T3,'END'		;See if either end has been wiped out
  5426	004463'01  302 03 0 00 544164 		CAIE T2,'LAT'		;Is it still there?
  5427						  BUG. (CHK,LATMEM,LATSER,SOFT,<LAT buffer overwritten>,<<T1,ADDRESS>>,<
  5428	004464'01  256 00 0 00 005070'	While trying to return a buffer, LATSER discovered it had been overwritten.>)
  5429	004465'01  200 03 0 00 000002 		MOVE T2,T1		;Now return the buffer
  5430	004466'01  201 02 0 00 000000#		MOVEI T1,LATFRE		;To the queue of free buffers
  5431	004467'01  350 00 0 00 000000#		AOS LATNFB		;Count one more buffer available
  5432	004470'01  254 00 0 00 004156'		CALLRET QUE1WB		;For re-use
  5433
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 122-2
LATSER	MAC	19-Aug-74 07:34		LAGTCR - LAT memory management routines

  5434	004471'01			MMGTZW:
  5435					IFN FTOPS20,<
  5436						CALL DNGWDZ
  5437						  RET
  5438						RETSKP
  5439					>;END IFN FTOPS20
  5440					IFN FTOPS10,<
  5441	004471'01  201 03 0 02 000001 		MOVEI T2,1(T1)		;Going to ask for 1 more word for check
  5442	004472'01  261 01 0 00 000003 		PUSH P,T2		;save requested size
  5443	004473'01  260 01 0 00 000000*		CALL GETEWZ		;Get zeroed core from ethernet free pool
  5444	004474'01  254 00 0 00 004434*		  JRST TPOPJ		;No luck
  5445	004475'01  262 01 0 00 000003 		POP P,T2		;Get back requested size
  5446	004476'01  271 02 0 00 000001 		ADDI T1,1		;Point to data portion of block
  5447	004477'01  202 03 0 02 777777 		MOVEM T2,-1(T1)		;save length as first word of block
  5448	004500'01  254 00 0 00 004454*		RETSKP			;And return it to caller
  5449
  5450	004501'01			MMFREE:
  5451					IFN FTOPS20,<
  5452						CALL DNFWDS
  5453						RET	
  5454					>
  5455					IFN FTOPS10,<
  5456	004501'01  415 03 0 02 777777 		XMOVEI T2,-1(T1)	;Point to block-1
  5457	004502'01  550 02 0 03 000000 		HRRZ T1,(T2)		;Which contains length of block
  5458	004503'01  254 00 0 00 000000*		CALLRET GIVEWS		;and give it back to ethernet free pool.
  5459					;
  5460					;	Subroutine to convert SIXBIT nodename to ASCII
  5461					;
  5462					;Call:	T1/ SIXBIT node name
  5463					;
  5464					;Return: +1 always with ASCII in OURNAM, OURNAM+1
  5465					;	and character in OURCNT
  5466					;
  5467	004504'01  402 00 0 00 000000#	CVTNOD:	SETZM OURCNT		;No characters yet
  5468	004505'01  402 00 0 00 000000#		SETZM OURNAM		;Or name
  5469	004506'01  402 00 0 00 000000#		SETZM OURNAM+1		; ...
  5470	004507'01  322 02 0 00 004260*		JUMPE T1,RTN		;Done if no characters left
  5471	004510'01  200 04 0 00 005074'		MOVE T3,[POINT 7,OURNAM]	;Where to put node name
  5472	004511'01  400 03 0 00 000000 	CVTNO1:	SETZ T2,		;Zap the temp AC
  5473	004512'01  245 02 0 00 000006 		ROTC T1,6		;Get next character into T2
  5474	004513'01  271 03 0 00 000040 		ADDI T2,40		;Convert to ASCII
  5475	004514'01  350 00 0 00 000000#		AOS OURCNT		;Count characters done
  5476	004515'01  136 03 0 00 000004 		IDPB T2,T3		;Put the character into the name
  5477	004516'01  326 02 0 00 004511'		JUMPN T1,CVTNO1		;Continue
  5478	004517'01  263 01 0 00 000000 		RET			;Done
  5479
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page 123
LATSER	MAC	19-Aug-74 07:34		LAGTCR - LAT memory management routines

  5480						XLIST
  5481
NO ERRORS DETECTED

PROGRAM BREAK IS 000000
PSECT 1 BREAK IS 005113 FOR  HIGH  
PSECT 2 BREAK IS 000135 FOR  .LOW. 
CPU TIME USED 18:33.078

116P CORE USED
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page S-1
LATSER	MAC	19-Aug-74 07:34		SYMBOL TABLE

ADJBP	133000	000000	spd	UN.LEN		000023	spd	
ADJSP	105000	000000		UN.SID		000001	spd	
CALL	260040	000000	spd	UN.STA		000003	spd	
CALLRE	254000	000000	spd	UN.UID		000005	spd	
CX		000017		UNA.EV		000000	spd	
DEVNAM		000000	sin	UNADS	060000	000000	spd	
F		000016	int	UNBFA	777777	777777	spd	
FTMP	777777	777777	sin	UNBSZ	777777	777777	spd	
FTOPS1	777777	777777	spd	UNCBA	777777	777777	spd	
FTOPS2		000000	spd	UNCHN	070000	000000	spd	
FTXMON	777777	777777	sin	UNDAD	777777	777777	spd	
HIGH		360000	spd	UNPAD	400000	000000	spd	
IFIW	400000	000000	spd	UNPID	777777	777777	spd	
IONND%		000020	spd	UNPRO		777777	spd	
IRRDSC		000005	sin	UNRID	777777	777777	spd	
IRRSCG		000003	sin	UNSAD	777777	777777	spd	
IRRTMO		000007	sin	UNSID	777777	777777	spd	
J		000015	int	UNSTA	777777	777777	spd	
JP.POK		020000	sin	UNUID	777777	777777	spd	
M		000007	int	VMC.XC		000000	sin	
MD.LEN		000006	spd	W		000006	int	
MD.NXT		000000	spd	XMOVEI	415000	000000		
MDALA	777777	777777	spd	XOFFC		000023	spd	
MDAUX	777777	777777	spd	XONC		000021	spd	
MDBYT	777777	777777	spd	.%1044	540000	000000	sin	
MDVMC	700000	000000	spd	.%744	610000	000000	sin	
MS.SCA	000005	000000	sin	.A16		000017		
NOP	600000	000000		.FPAC0		000006	spd	
NU.OPN		000001	spd	.LOW.	777777	777777	spd	
NU.RCC		000011	spd	
NU.RCI		000010	spd	
NU.RCV		000003	spd	
NU.SCA		000012	spd	
NU.XMT		000004	spd	
P		000001	int	
P1		000011	int	
P2		000012	int	
P3		000013	int	
P4		000014	int	
PJRST	254000	000000	spd	
PSECT.		360000	spd	
PX.MEM		000004	spd	
PX.SRC		000001	spd	
PXCT	256000	000000	spd	
RET	263040	000000	spd	
S$DEBU		000003	sin	
S$EVEN		000006	sin	
ST.NRT		000010	spd	
T1		000002	int	
T2		000003	int	
T3		000004	int	
T4		000005	int	
U		000010	int	
UN.BFA		000015	spd	
UN.BSZ		000014	spd	
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page S-2
LATSER	MAC	19-Aug-74 07:34		SYMBOL TABLE FOR PSECT   HIGH  

AC.COD		000653	spd	CBMRS	200000	000000	spd	CVTNO1		004511'		HMSTRT		002004'		
ACKDON		002311'		CBMSL	777777	000000	spd	CVTNOD		004504'		HN%ACS		000001	spd	
ACLNG	777777	777777	spd	CBMTF	777777	000000	spd	CWHLAT		001246'	int	HN%NDD		000002	spd	
ALCBUF		004424'		CBNBF		777777	spd	CWHNCN		001252'	ext	HN%OTH		000200	spd	
APCLAT		003454'	ext	CBNUM	777777	000000	spd	DATE		004371'	ext	HN%SVD		000020	spd	
ARGX02		000011	spd	CBPTC	777777	000000	spd	DETLDB		003466'	ext	HN%SVN		000004	spd	
ARGX04		000012	spd	CBRDSP		001614'		DIE		005070'	ext	HN%SVR		000010	spd	
ARNGE		000401'	ext	CBRID	777777	000000	spd	DLL.FL		400000	spd	HN.FLG		000000	spd	
BGCTYP		005064'	ext	CBRLC	777777	000000	spd	DLLUNI		003037'	ext	HN.ID		000027	spd	
BITSWP		000441'		CBRPV		777777	spd	DOFUN		000165'		HN.MCM		000123	spd	
BITTBL		003635'	ext	CBRRF	400000	000000	spd	DYNRAT		004377'		HN.MTI		000006	spd	
BLDMSL		003565'		CBRSC		777777	spd	ERRRTN		001051'		HN.MXC		000001	spd	
BLDSTM		001535'		CBRSQ	777777	000000	spd	FNDSRV		000703'		HN.NAM		000025	spd	
BLNXSL		003575'		CBRTC		777777	spd	FRELDB		003467'	ext	HN.NIQ		000015	spd	
BLSDSP		003625'		CBSBQ	777777	777777	spd	FSFALS		000751'		HN.NMC		000024	spd	
BLSLCP		003600'		CBSDC	777777	000000	spd	GB.HID		000006	spd	HN.QAC		000011	spd	
BLSLOP		003571'		CBSTA		777777	spd	GB.LEN		000023	spd	HN.QIC		000013	spd	
BMCACS		001435'		CBTIM	777777	000000	spd	GB.NAM		000002	spd	HN.RUN		000000	spd	
BMCFXD		001375'		CBTSQ		777777	spd	GBLC		777777	spd	HN.SMT		000044	spd	
BMCNID		001443'		CC.BEG		000051	spd	GBNC	777777	000000	spd	HN.SRV		000422	spd	
BMCRAT		001511'		CC.LEN		000010	spd	GBRAT	777777	777777	spd	HNACS		000001	spd	
BMCSRV		001454'		CC.LST		000061	spd	GCBNAM		001004'		HNCFL		000377	spd	
BMSGHD		002643'		CCIMR	777777	777777	spd	GETCLP		004414'	ext	HNCIP	100000	000000	spd	
BSLTHD		004102'		CCISR	777777	777777	spd	GETEWZ		004473'	ext	HNCLS		000040	spd	
BUFSIZ		000000*	spd	CCRCV	777777	777777	spd	GETLDB		003446'	ext	HNCON		777777	spd	
CB.AKQ		000013	spd	CCRTR	777777	777777	spd	GETOPN		003201'		HNIDC		777777	spd	
CB.DNI		000017	spd	CCSEQ	777777	777777	spd	GETRBF		004266'		HNLAS		777777	spd	
CB.FLG		000003	spd	CCXMT	777777	777777	spd	GETSPN		003210'		HNLOK	777777	777777	spd	
CB.KAF		000050	spd	CE.HLT		000003	spd	GETTDB		003443'		HNMAC	777777	000000	spd	
CB.LNK		000000	spd	CE.ILL		000002	spd	GETWRD		000134'	ext	HNMCO	777777	000000	spd	
CB.LOC		000033	spd	CE.INV		000012	spd	GETXBF		004221'		HNMTI	777777	000000	spd	
CB.RRF		000003	spd	CE.LIM		000006	spd	GETXBH		004172'		HNMXC	777777	000000	spd	
CB.RSC		000025	spd	CE.NSL		000001	spd	GETZBF		004431'		HNNAC		777777	spd	
CB.SBQ		000015	spd	CE.RES		000007	spd	GIVBF		004455'		HNNCC		777777	spd	
CB.SNM		000027	spd	CE.SKW		000011	spd	GIVEWS		004503'	ext	HNNDD		000002	spd	
CB.XBQ		000011	spd	CHKRFB		004415'		GOTCHR		003773'		HNNIQ	777777	777777	spd	
CBAFND		002111'		CHKSTB		000072'	ext	GTCDON		002772'		HNNMC	777777	000000	spd	
CBAKQ	777777	777777	spd	CHKWFB		004403'		GTCSLP		002767'		HNNRB	777777	000000	spd	
CBALNW		002076'		CKSTR		000712'	ext	GTCSTR		002746'		HNNSV		777777	spd	
CBCSB		777777	spd	CLRBEG		000003	spd	GTLCOB		000667'		HNNUM	777777	000000	spd	
CBCTI	777777	000000	spd	CLREND		000010	spd	GTSRVR		000762'		HNNXI	777777	000000	spd	
CBDACT		002444'		CLRNID		000375'		GTXFL		004213'		HNOTH		000200	spd	
CBDLL	777777	000000	spd	CMLOOP		002174'		GTXNXT		004173'		HNPID	777777	777777	spd	
CBDNI	777777	777777	spd	CMNIAD		002173'		HC.BEG		000713	spd	HNQAC	777777	777777	spd	
CBERR		777777	spd	COMTYO		001303'	ext	HC.LEN		000010	spd	HNQIC	777777	777777	spd	
CBGNIX		002206'		CONFIG		004715'	ext	HC.LST		000723	spd	HNRLI	777777	000000	spd	
CBGNX0		002221'		CPOPJ		001300'	ext	HCIMR	777777	777777	spd	HNRUN	400000	000000	spd	
CBIFND		002074'		CPOPJ1		004500'	ext	HCISR	777777	777777	spd	HNSCQ	777777	777777	spd	
CBINIT		002112'		CRECHK		004113'		HCRCV	777777	777777	spd	HNSVD		000020	spd	
CBKILL		002441'		CS.HLT		000000	spd	HCRTR	777777	777777	spd	HNSVN		000004	spd	
CBKTI		777777	spd	CS.RUN		000002	spd	HCSEQ	777777	777777	spd	HNSVR		000010	spd	
CBLID		777777	spd	CS.STA		000001	spd	HCXMT	777777	777777	spd	HNTIM		777777	spd	
CBLRA		777777	spd	CSBDAV		003357'		HDRDAT		003244'		HRNFND		002345'		
CBMAXI		000255	spd	CSERVC		000310'		HMRUN		002233'		HRUNCB		002320'		
CBMRN	100000	000000	spd	CSRVC0		000322'		HMSTOP		002347'		HSDATA		003233'		
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page S-3
LATSER	MAC	19-Aug-74 07:34		SYMBOL TABLE FOR PSECT   HIGH  

HSDATB		003244'		LATIMT		005005'	int	MAXCBF		000012	sin	NETDIL		000055'	int	
HSSTOP		003217'		LATINE		004722'	int	MAXCIR		000024	spd	NFND1		002050'		
HSSTR1		003142'		LATINI		001054'	ent	MAXCRE		000002	spd	NFND2		002054'		
HSSTR3		003152'		LATLSC		001772'		MAXMTY		000002	sin	NFRSBQ		003437'	ext	
HSSTRT		003113'		LATMEM		005070'	int	MAXSFL		000006	sin	NGVLDB		003464'		
HSTRCB		002044'		LATNSC		005025'	int	MAXSTY		000015	sin	NOCHR		003774'		
IDLHLT		002375'		LATREM		004351'		MAXXBF		000002	spd	NOCRE0		002370'		
IGCSTR		002745'		LATSCN		004321'		MDB.OF		000025	spd	NOCRES		002367'		
IGNSLT		004130'		LATSEC		001310'	int	MDLXB1		002466'		NOPADC		000101'	ext	
ILLCBR		001613'		LATSTO		001674'	int	MDLXBF		002465'		NSBWDS		000000	ext	
ILLMES		002361'		LATX01		000000	spd	MINCBF		000003	sin	NTDIL1		000070'		
ILLMS0		002362'		LATX02		000001	spd	MINMTY		000000	sin	NTTLAH		003245'	ext	
ILLSLT		004132'		LATX03		000002	spd	MINSFL		000001	sin	NXSLCH		003240'		
INFSTP		002403'		LATX04		000003	spd	MINSTY		000000	sin	NXTACK		002300'		
INIRES		001236'		LATX06		000005	spd	MINXBF		000056	spd	NXTSLT		003042'		
INISBN		001207'		LATX07		000006	spd	ML.DSC		000100	spd	PAGSIZ		004426'	ext	
INLMES		001273'	ext	LATX08		000007	spd	ML.LOC		000100	spd	PCRLF		001277'	ext	
INVRUN		002401'		LATX09		000010	spd	ML.NNM		000006	spd	PG.BDY		004407'	ext	
JIFSEC		002146'	ext	LATXAC		000013	spd	ML.PNM		000020	spd	PRNAME		001276'	ext	
L1RCHP		004327'	ext	LATXM0		001340'		ML.SID		000100	spd	PROECO		000000	spd	
LA%DSC	200000	000000	spd	LATXM1		001350'		ML.SNM		000020	spd	PROVER		000005	spd	
LA%RAT	400000	000000	spd	LATXM2		001352'		ML.SYS		000020	spd	PRVBIT		000202'	ext	
LABFCK		001044'		LATXMC		001315'	int	MMFREE		004501'		PTCST0		003006'		
LACLR		000201'		LATXPV		000014	spd	MMGTZW		004471'		PTCSTL		003010'		
LAFDSP		000172'		LAUNQ		004145'		MMHDSI		000010	spd	PTCSTR		003004'		
LAG2BY		002736'		LAZCO		000656'		MMVAZ0		000464'		PTUSTL		003016'		
LAGTCR		004401'	int	LCLHLT		002377'		MMVAZS		000460'		PTUSTR		003014'		
LAHNDB		001700'	ext	LDBBYT		004336'	ext	MNLFCN		000000	sin	QL.FWD		000000	spd	
LAHPV		000005	spd	LDBDCH		004044'	ext	MNSPAR		000001	sin	QL.LEN		000002	spd	
LAINT0		001660'		LDBECC		004122'	ext	MOV7T8		000103'		QLBWD	777777	777777	spd	
LAINTR		001624'		LDBLAT		004362'	ext	MOVNIQ		001756'		QLFWD	777777	777777	spd	
LAINTX		001641'		LDBQUH		003451'	ext	MSGDON		001751'		QUE1WB		004156'		
LALPV		000005	spd	LDBTIC		004121'	ext	MSGDSP		001753'		RANDOM		004370'		
LAMUX		003470'		LDLIDL		000000	ext	MSGNXT		001704'		RATLP		001521'		
LANTR1		001632'		LDPAPC		003455'	ext	MSTMSI		000020	spd	RBFSIZ		000615	spd	
LANXCB		003472'		LDPLNO		000563'	ext	MT.MCA		000012	spd	RBPOSS		003022'		
LAP2B0		002777'		LF%CLR	040000	000000	spd	MT.RUN		000000	spd	RBPOST		003023'		
LAP2BY		002775'		LF%LOK	100000	000000	spd	MT.STA		000001	spd	RECPTY		003241'	ext	
LAQUE		004135'		LF%RNG	200000	000000	spd	MT.STP		000002	spd	RELRB0		004313'		
LARSCH		001674'	int	LHPRID		000007	spd	MTTRUN		002535'		RELRBF		004303'		
LAS1C		000557'		LMNMRN		003530'		MTTSP0		002506'		RELSB		003400'		
LASAS		000575'		LMNOXB		003526'		MTTSTP		002477'		RELSB0		003405'		
LASCH		000472'		LMRFSI		002740	spd	MTTSTR		002411'		RELSBS		003372'		
LASCO		000643'		LMUNSL		003536'		MW.SYS		000004	spd	RELXBF		004256'		
LASET		000201'		LOKETH		004361'	ext	MXBALC		000006	spd	RELXBH		004262'		
LASET0		000232'		LS.OFF		000000	spd	MXHSRV		000010	spd	RFXBFS		004250'		
LASET1		000205'		LS.ON		000001	spd	MXLFCN		000006	sin	RLSBID		003426'		
LASTC		000533'		LSDMUX		003040'		MXNXC1		003557'		RSKP		004042'	ext	
LASTCD		000552'		LTCOBF		004357'		MXNXC2		003563'		RTN		004507'	ext	
LASTCL		000544'		LTHNGU		004346'		MXNXCB		003554'		SASBEG		000017	spd	
LASTCN		000550'		LTLLAT		003444'	ext	MXNXSL		003576'		SASEND		000050	spd	
LATCBR		001604'		LTSSD0		004366'		MXSLSI		000050	spd	SASLP		000627'		
LATCHP		004336'		LTSSDC		004360'		MXSLTS		000100	spd	SAVE4		000126'	ext	
LATDSP		000000'	int	LVSKEW		002365'		MXSPAR		000014	sin	SAVT		003022'	ext	
LATICB		004757'	int	M.LIDL		003456'	ext	NBUFS		000004	spd	SB.CBA		000025	spd	
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page S-4
LATSER	MAC	19-Aug-74 07:34		SYMBOL TABLE FOR PSECT   HIGH  

SB.FLG		000002	spd	SRVLP		001472'		XMTMS1		002716'		$HCRTR		000715	spd	
SB.LEN		000027	spd	SS.RUN		000001	spd	XMTMSG		002665'		$HCSEQ		000716	spd	
SB.OPN		000014	spd	SSBDAV		003346'		XMTMSN		002664'		$HCXMT		000714	spd	
SB.SNM		000010	spd	SSEC1		001676'	ext	XSLATT		003734'		$HN		000006	spd	
SB.SPN		000020	spd	SSERVC		000237'		XSLDA0		004026'		$HNCFL		000000	spd	
SB.TDB		000024	spd	SSPCS		000103'	ext	XSLDA2		004032'		$HNCIP		000000	spd	
SB.TTO		000026	spd	ST.ATT		000013	spd	XSLDTA		003745'		$HNCON		000003	spd	
SBAGO		003314'		ST.DTA		000000	spd	XSLDTB		004051'		$HNIDC		000024	spd	
SBALOC		003303'		ST.DTB		000012	spd	XSLREJ		003707'		$HNLAS		000004	spd	
SBANXT		003310'		ST.REJ		000014	spd	XSLSTA		003666'		$HNLOK		000023	spd	
SBATS		777777	spd	ST.STA		000011	spd	XSLSTP		003721'		$HNMAC		000002	spd	
SBCBA	777777	777777	spd	ST.STP		000015	spd	XUNAKQ		002614'		$HNMCO		000003	spd	
SBCHR		777777	spd	STANAM		001105'	ext	ZZ	000055	576645	spd	$HNMTI		000006	spd	
SBF.OF		000025	spd	STATES		003155'	ext	$ACLNG		000652	spd	$HNMXC		000001	spd	
SBFCC	010000	000000	spd	STOTAC		001053'	ext	$CB		000012	spd	$HNNAC		000002	spd	
SBFOU	040000	000000	spd	SXPCS		000106'	ext	$CBAKQ		000013	spd	$HNNCC		000001	spd	
SBLID		777777	spd	SZ.ATT		000001	spd	$CBCSB		000003	spd	$HNNIQ		000015	spd	
SBMDS	777777	000000	spd	SZ.MHD		000010	spd	$CBCTI		000023	spd	$HNNMC		000024	spd	
SBOPC	777777	000000	spd	SZ.REJ		000000	spd	$CBDLL		000010	spd	$HNNRB		000007	spd	
SBOUT	020000	000000	spd	SZ.SDB		000005	spd	$CBDNI		000017	spd	$HNNSV		000022	spd	
SBPRMX		000005		SZ.SHD		000004	spd	$CBERR		000007	spd	$HNNUM		000004	spd	
SBPRTB		003173'		SZ.SSP		000000	spd	$CBKTI		000023	spd	$HNNXI		000022	spd	
SBRCR		777777	spd	SZ.SST		000006	spd	$CBLID		000002	spd	$HNPID		000021	spd	
SBREA	777777	000000	spd	SZ.XBF		000567	spd	$CBLRA		000005	spd	$HNQAC		000011	spd	
SBREJ	200000	000000	spd	SZMSTP		000044	spd	$CBMRN		000003	spd	$HNQIC		000013	spd	
SBRID	777777	000000	spd	TBEXEC		000041'		$CBMRS		000003	spd	$HNRLI		000005	spd	
SBSNC		777777	spd	TBFLGS		000025'		$CBMSL		000022	spd	$HNRUN		000000	spd	
SBSPC		777777	spd	TBRNGE		000011'		$CBMTF		000021	spd	$HNSCQ		000017	spd	
SBSTA		777777	spd	TCST1		001302'		$CBNBF		000022	spd	$HNTIM		000005	spd	
SBSTO	004000	000000	spd	TCSTR		001300'		$CBNUM		000025	spd	$INCFL	000001	777776	spd	
SBSTR	100000	000000	spd	TMRCHK		002573'		$CBPTC		000024	spd	$MAXCN	000001	777776	spd	
SBTDB	777777	777777	spd	TOTAKE		004322'	ext	$CBRID		000002	spd	$MDALA		000005	spd	
SBTTO	400000	000000	spd	TPOPJ		004474'	ext	$CBRLC		000026	spd	$MDAUX		000002	spd	
SBXCR	777777	000000	spd	TTFGRT		003462'	ext	$CBRPV		000021	spd	$MDBYT		000003	spd	
SBXNF	200000	000000	spd	TTIWRN		004120'	ext	$CBRRF		000003	spd	$MDVMC		000004	spd	
SCITTY		000001	spd	TTYKLQ		001256'	ext	$CBRSC		000025	spd	$MSKPT	000001	777775	spd	
SCMPAR		001017'		UE.LW0		000000	spd	$CBRSQ		000005	spd	$PTR1	000001	777776	spd	
SCNADT		003457'	ext	UELW1	777777	777777	spd	$CBRTC		000006	spd	$PTR2	000001	777775	spd	
SE.RES		000005	spd	UMVAZ0		000451'		$CBSBQ		000015	spd	$QLBWD		000001	spd	
SE.SHU		000002	spd	UMVAZ1		000456'		$CBSDC		000004	spd	$QLFWD		000000	spd	
SENDMC		001354'		UMVAZS		000447'		$CBSTA		000024	spd	$RB		000011	spd	
SETCHP		000004'	ext	UNB.OF		000002	spd	$CBTIM		000006	spd	$SB		000013	spd	
SETCOD		000377'		UNLETH		004366'	ext	$CBTSQ		000004	spd	$SBATS		000002	spd	
SETNID		000356'		UNQ1WF		004164'		$CCIMR		000055	spd	$SBCBA		000025	spd	
SETNNM		000336'		UPPERC		001037'		$CCISR		000056	spd	$SBCHR		000026	spd	
SETRTX		000330'		W2PLSH		004412'	ext	$CCRCV		000051	spd	$SBLID		000004	spd	
SL.DXF		000011	spd	XBF.OF		000033	spd	$CCRTR		000053	spd	$SBMDS		000003	spd	
SL.EXF		000005	spd	XBFCHK		004240'		$CCSEQ		000054	spd	$SBOPC		000007	spd	
SLBDSP		003652'		XBFSIZ		000575	spd	$CCXMT		000052	spd	$SBRCR		000005	spd	
SLHDSZ		000004	spd	XMNOCB		002677'		$GBLC		000001	spd	$SBREA		000006	spd	
SLLNTB		003660'		XMTALL		002625'		$GBNC		000001	spd	$SBRID		000004	spd	
SLRESF		003166'		XMTCHR		004026'	ext	$GBRAT		000000	spd	$SBSNC		000006	spd	
SLSHUT		003165'		XMTDON		002725'		$HCIMR		000717	spd	$SBSPC		000007	spd	
SLTDSP		003075'		XMTLIM		002373'		$HCISR		000720	spd	$SBSTA		000003	spd	
SNDMNC		001363'		XMTMS0		002701'		$HCRCV		000713	spd	$SBTDB		000024	spd	
LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page S-5
LATSER	MAC	19-Aug-74 07:34		SYMBOL TABLE FOR PSECT   HIGH  

$SBTTO		000026	spd	
$SBXCR		000005	spd	
$SBXNF		000026	spd	
$UELW1		000001	spd	
$UNADS		000003	spd	
$UNBFA		000015	spd	
$UNBSZ		000014	spd	
$UNCBA		000006	spd	
$UNCHN		000007	spd	
$UNDAD		000010	spd	
$UNPAD		000007	spd	
$UNPID		000000	spd	
$UNPRO		000007	spd	
$UNRID		000002	spd	
$UNSAD		000012	spd	
$UNSID		000001	spd	
$UNSTA		000003	spd	
$UNUID		000005	spd	
$USRPT	000001	777776	spd	
$W1		000014	spd	
$W2		000015	spd	
$XB		000007	spd	
..X		000006	spd	
.CPJOB		000132'	ext	
.CPSK0		001674'	ext	
.LABCT		000002	spd	
.LABFA		000003	spd	
.LACLR		000001	spd	
.LADSC		000005	spd	
.LAFCN		000001	spd	
.LAPRM		000002	spd	
.LAQUA		000004	spd	
.LASAS		000004	spd	
.LASCH		000002	spd	
.LASCO		000005	spd	
.LASET		000000	spd	
.LASTC		000003	spd	
.LATOP		000126'	int	
.LAVAL		000003	spd	
.LAZCO		000006	spd	
.LPCOD		000010	spd	
.LPLAS		000004	spd	
.LPLOC		000014	spd	
.LPMAC		000001	spd	
.LPMCO		000002	spd	
.LPMTI		000007	spd	
.LPNID		000012	spd	
.LPNNM		000011	spd	
.LPNUM		000003	spd	
.LPRLI		000005	spd	
.LPSRV		000013	spd	
.LPTIM		000006	spd	
.XSTKS		001375'	ext	

LATSER -- LAT-10 Terminal Host	MACRO %53B(1155)-2 17:40 11-Aug-87 Page S-6
LATSER	MAC	19-Aug-74 07:34		SYMBOL TABLE FOR PSECT   .LOW. 

CBVECT		000005'		
LASBAD		000022'	int	
LASDEF		000007'		
LATFRE		000013'		
LATLOC		000015'	int	
LATMCT		000016'		
LATNFB		000017'		
LATRFB		000021'		
LATRTQ		000011'		
LATWFB		000020'		
LDBPAG		000003'	ext	
LDPXNF		000003'		
MSGACK		000026'		
MSGDID		000024'		
MSGSID		000025'		
NSLOTS		000010'		
OURCNT		000002'		
OURNAM		000000'		
RTXTIM		000004'		
SBVECT		000006'		
SLTCNT		000032'		
SLTDID		000030'		
SLTEPT		000034'		
SLTSID		000031'		
SLTTYP		000033'		
STPCOD		000027'		
TMPBLK		000035'		
TMPGB		000036'	spd	
TMPLNG		000100	sin	


Symbol cross reference

ABSLOC	   533#
AC.BEG	   875#
AC.COD	   877#	   877	  1566	  1680	  2193	  2470
AC.LEN	   878#
AC.LNG	   876#	   876
AC.LST	   878#	   882	   891
ACCOD	   877#	   877
ACKDON	  3153	  3162#
ACLNG	   876#	   876	  2191	  2469
ACTTYP	  2261#	  2261	  2262	  2659#	  2659	  2660	  2821#	  2821	  2822	  3271#	  3271	  3272	  5428#	  5428
	  5429
ALCBUF	  2146	  5381#	  5384
APCLAT	   758#	  4261
APCUNK	   758#
ARGX02	   734#	  1278
ARGX04	   735#	  1781	  1837	  1853
ARNGE	  1264	  1291	  1540
ATTSIZ	   627#
BGCTYP	  2659	  2659#	  2821	  3271	  5428
BITSWP	  1561	  1587#	  1686
BITTBL	   409#	   409	  4048	  4193	  4479
BLDMSL	  4342	  4386	  4416#
BLDSTM	  2227	  2598#
BLNXSL	  4424#	  4482	  4496
BLSDSP	  4424	  4463#
BLSLCP	  4427#	  4465	  4474
BLSLOP	  4420#	  4426
BMCACS	  2222	  2376	  2466#
BMCFXD	  2221	  2374	  2417#
BMCNID	  2223	  2378	  2491#
BMCRAT	  2370	  2564#
BMCSRV	  2224	  2381	  2518#
BMSGHD	  3294	  3450	  3527#
BSLTHD	  4533	  4560	  4583	  4601	  4753	  4811	  4831#
BUFSIZ	  2142	  5340#	  5349	  5362	  5377	  5383	  5401
CB	  2772	  2772#	  2908	  2923	  2956	  2958	  2964	  2966	  2970	  2975	  2976	  2978	  2995	  2997
	  2998	  3001	  3003	  3011	  3013	  3015	  3017	  3019	  3021	  3025	  3027	  3031	  3034	  3036
	  3039	  3055	  3056	  3057	  3058	  3063	  3082	  3089	  3092	  3119	  3120	  3124	  3126	  3131
	  3136	  3140	  3142	  3143	  3151	  3154	  3156	  3159	  3162	  3163	  3164	  3165	  3183	  3185
	  3187	  3190	  3191	  3193	  3205	  3215	  3216	  3227	  3235	  3298	  3307	  3334	  3335	  3337
	  3340	  3342	  3345	  3361	  3362	  3384	  3385	  3386	  3431	  3435	  3437	  3440	  3441	  3443
	  3446	  3470	  3476	  3481	  3487	  3494	  3496	  3499	  3500	  3502	  3503	  3505	  3511	  3513
	  3530	  3534	  3536	  3538	  3540	  3568	  3571	  3573	  3574	  3576	  3590	  3591	  3596	  3598
	  3616	  3618	  3619	  3620	  3621	  3623	  3952	  4006	  4056	  4061	  4085	  4087	  4106	  4108
	  4123	  4124	  4160	  4165	  4167	  4172	  4299	  4302	  4311	  4314	  4320	  4321	  4324	  4336
	  4337	  4338	  4340	  4354	  4357	  4358	  4370	  4374	  4381	  4383	  4384	  4389	  4397	  4416
	  4435	  4437	  4438	  4444	  4445	  4463	  4890	  4986	  4994	  5056	  5162	  5182	  5281	  5281#
	  5285	  5315
CB%MRN	   902#
CB%MRS	   901#
CB%RRF	   900#
CB.AKQ	   914#	   914	  3154	  3156	  3362	  3441	  3496
CB.BEG	   895#
CB.CSB	   903#	   903
Symbol cross reference

CB.CTI	   921#	   921
CB.DLL	   912#	   912	   954
CB.DNI	   916#	   916	   955	  1824
CB.ERR	   911#	   911
CB.FLG	   899#	   899	   953	  4336
CB.KAF	   930#	   930	  3021	  3124	  4397
CB.KTI	   922#	   922
CB.LEN	   932#
CB.LID	   898#	   898
CB.LNK	   896#	   896	  1827	  2017	  3063
CB.LOC	   929#	   929	   958	  2306	  3036
CB.LRA	   907#	   907
CB.LST	   932#	   933	   942
CB.MRN	   902#
CB.MRS	   901#
CB.MSL	   919#	   919
CB.MTF	   917#	   917
CB.NBF	   920#	   920
CB.NUM	   925#	   925
CB.PTC	   923#	   923
CB.QUA	   910#	   910
CB.RID	   897#	   897
CB.RLC	   927#	   927
CB.RPV	   918#	   918
CB.RRF	   900#	  3437
CB.RSC	   926#	   926	  1818
CB.RSQ	   906#	   906
CB.RTC	   909#	   909
CB.SBQ	   915#	   915	  4056	  4124	  4172	  4416	  4435	  4437	  4438	  4444	  4445
CB.SDC	   904#	   904
CB.SNM	   928#	   928	   957	  1192	  1762	  1822	  2011	  2300	  3031
CB.STA	   924#	   924	   956
CB.TIM	   908#	   908
CB.TSQ	   905#	   905
CB.XBQ	   913#	   913	  3159	  3431	  3435	  4338	  4381	  4986	  4994	  5056
CBAFND	  2948	  2979#
CBAKQ	   914#	   914	  3162
CBALNW	  2962	  2968#
CBCSB	   903#	   903	  4337	  4370	  4374	  4383
CBCTI	   921#	   921	  3017
CBDACT	  3334#
CBDLL	   912#	   912	  3361	  3494	  3503	  3505	  3511	  3513	  3574	  3576	  3596	  3598	  3621	  3623
CBDNI	   916#	   916	  2978	  3057	  3058	  3193	  3298	  3573
CBERR	   911#	   911	  3385
CBFLG	   899#	   899
CBGNIX	  2968	  3081#
CBGNX0	  3093#	  3101
CBIFND	  2944	  2966#
CBINIT	  2919	  2992#
CBKAF	   930#	   930
CBKILL	  3220	  3323#	  3391
CBKTI	   922#	   922	  3019
CBLID	   898#	   898	  3082	  3089	  3120	  3215	  3536
CBLNK	   896#	   896
Symbol cross reference

CBLOC	   929#	   929
CBLRA	   907#	   907	  3142	  3143
CBMAXI	   648#	  2124	  2185	  3095	  3185
CBMRN	   902#	   902	  4324	  4325	  4335	  4357
CBMRS	   901#	   901	  3164	  4335	  4354	  4355
CBMSL	   919#	   919	  3013	  4463
CBMTF	   917#	   917	  3003
CBNBF	   920#	   920	  3015
CBNUM	   925#	   925	  3025
CBPTC	   923#	   923	  3027
CBQUA	   910#	   910
CBRDSP	  2655	  2666#	  2676	  2677	  2678	  2679	  2680
CBRID	   897#	   897	  3001	  3119	  3335	  3386	  3534
CBRLC	   927#	   927	  2305	  3039
CBRPV	   918#	   918	  3011
CBRRF	   900#	   900	  3436	  3439	  3530	  4320	  4335
CBRSC	   926#	   926	  1191	  1758	  2013	  2299	  3034
CBRSQ	   906#	   906	  3131	  3136	  3538
CBRTC	   909#	   909	  3151	  3476	  3500	  3502
CBSBQ	   915#	   915	  4160	  4314
CBSDC	   904#	   904	  4085	  4087	  4106	  4108	  4165	  4167	  4340	  4384
CBSNM	   928#	   928
CBSTA	   924#	   924	  2908	  2923	  2958	  2975	  3126	  3216	  3337	  3340	  4311
CBTIM	   908#	   908	  3163	  3440	  3470	  3481	  3487
CBTSQ	   905#	   905	  3443	  3446	  3540
CBVECT	  1018#	  2127	  2264	  3081	  3190
CBXBQ	   913#	   913
CC.BEG	   933#	  1886
CC.IMR	   938#	   938
CC.ISR	   939#	   939
CC.LEN	   942#	  1887
CC.LST	   942#	  2953
CC.MSK	   941#	   941
CC.RCV	   934#	   934
CC.RES	   940#	   940
CC.RTR	   936#	   936
CC.SEQ	   937#	   937
CC.XMT	   935#	   935
CCIMR	   938#	   938	  3227	  3235
CCISR	   939#	   939	  4890
CCMSK	   941#	   941
CCRCV	   934#	   934	  2976	  3205
CCRES	   940#	   940
CCRTR	   936#	   936	  3499
CCSEQ	   937#	   937	  3140
CCXMT	   935#	   935	  3307	  3591
CE.HLT	   568#	  3246
CE.ILL	   567#	  3229
CE.INV	   575#	  3255
CE.LIM	   571#	  3240
CE.NIH	   579#
CE.NPM	   569#
CE.NSL	   566#	  3243
CE.RES	   572#	  3237
Symbol cross reference

CE.SKW	   574#	  3232
CE.STO	   573#
CE.TIM	   570#
CHKRFB	  5374#
CHKSTB	  1187	  1197
CHKWFB	  4302	  5356#
CKSTR	  1401	  1481	  1510	  1790	  1879	  1917
CLRBEG	   953#	  2995	  2996	  2997	  2998
CLREND	   954#	  2996
CLRNID	  1506	  1525#
CMLOOP	  3056#	  3064
CMNIAD	  2942	  2946	  3055#	  3199	  3203
COMTYO	  2303	  2323
CONFIG	   755#	  2156
CPOPJ	  2320
CPOPJ1	  1094	  1196	  1205	  1239	  1304	  1363	  1423	  1450	  1465	  1494	  1523	  1526	  1578	  1617
	  1711	  1742	  1768	  1804	  1815	  1846	  1860	  1892	  1953	  1970	  1995	  2001	  2016	  2050
	  2075	  2979	  3040	  3066	  3206	  3472	  3488	  3663	  3676	  3785	  3809	  3854	  3899	  3906
	  3955	  3969	  3988	  4014	  4024	  4072	  4272	  4456	  4544	  4564	  4587	  4606	  4782	  4785
	  4829	  4882	  4887	  4962	  4989	  5027	  5039	  5045	  5103	  5114	  5260	  5412	  5448
CPYRT.	   399#	   399
CRECHK	  4725	  4807	  4857#
CS.HLT	   556#	  2957	  3217	  3336
CS.RUN	   558#	  2909	  3125	  4312
CS.SPG	   560#
CS.STA	   557#	  2922	  4059
CS.TRN	   559#
CSBDAV	  4101#	  4543	  4562	  4585	  4605	  4784	  4828
CSERVC	  1381	  1435#
CSRVC0	  1443	  1445#
CVTNO1	  5472#	  5477
CVTNOD	  2149	  5467#
CWHLAT	  2287#
CWHNCN	  2291
CX	  3438	  3440
DATE	   761#	  5307
DETLDB	   756#	  4284
DEVNAM	  2293
DIE	  2261	  2261#	  2659	  2821	  3271	  5428
DLL.FL	   655#	  3569	  3593	  3618
DLLUNI	   742	   742#	  2246	  2398	  3304	  3508	  3587	  3755
DOFUN	  1282	  1284	  1290	  1295#
DTBSIZ	   628#
DYNRAT	  2533	  2573	  5318#
ERRRTN	  1260	  1266	  1275	  1278	  1293	  1298	  1541	  2094#
F	  2293
FNDSRV	  1377	  1904#
FRELDB	   756#	  4285
FSFALS	  1934	  1962#
FTMP	  2333	  2744	  2753	  2766	  2851	  2855	  5282	  5287
FTOPS1	   394	   396	   527	   531	   643	   699	   750	   988	  1008	  1022	  1082	  1169	  1248	  1279
	  1301	  1329	  1400	  1480	  1509	  1537	  1789	  1878	  1916	  2087	  2132	  2156	  2203	  2286
	  2331	  2763	  2779	  2925	  3888	  3970	  3983	  4153	  4236	  4296	  4302	  4624	  4697	  4804
	  4817	  4867	  4873	  5014	  5073	  5106	  5109	  5134	  5141	  5246	  5306	  5320	  5440	  5455
Symbol cross reference

FTOPS2	   393	   395	   526	   530	   642	   744	  1014	  1244	  1272	  1299	  1606	  1794	  1883	  1921
	  2077	  2155	  2172	  2355	  2773	  2924	  3249	  3781	  3973	  3978	  4139	  4210	  4301	  4303
	  4633	  4646	  4813	  4862	  4876	  5013	  5072	  5105	  5110	  5135	  5184	  5303	  5319	  5435
	  5451
FTSHOW	   772	   773	   774	   775	   819	   820	   821	   822	   823	   824	   825	   827	   828	   829
	   830	   831	   832	   833	   834	   835	   836	   837	   838	   839	   840	   841	   843	   844
	   845	   846	   847	   848	   849	   850	   851	   852	   853	   855	   856	   857	   858	   859
	   860	   861	   862	   863	   864	   865	   866	   867	   868	   869	   870	   871	   872	   873
	   875	   876	   877	   878	   882	   883	   884	   885	   886	   887	   888	   889	   890	   891
	   895	   896	   897	   898	   899	   900	   901	   902	   903	   904	   905	   906	   907	   908
	   909	   910	   911	   912	   913	   914	   915	   916	   917	   918	   919	   920	   921	   922
	   923	   924	   925	   926	   927	   928	   929	   930	   932	   933	   934	   935	   936	   937
	   938	   939	   940	   941	   942	   962	   963	   964	   965	   966	   967	   968	   969	   970
	   971	   972	   973	   974	   975	   976	   977	   978	   979	   980	   981	   982	   983	   984
	   985	   986	   987	   989	   990	   991	   992	   994	   998	   999	  1000	  1001
FTXMON	   419	  1080	  1220
GB.BEG	   819#
GB.HID	   824#	   824	  1405	  2212	  2540
GB.LC	   822#	   822
GB.LEN	   825#	   873	  1075	  1419	  1437	  1440	  1657	  1947	  1955	  1965	  2542	  2581
GB.LST	   825#
GB.NAM	   823#	   823	  1922	  1936	  1939	  2201	  2537
GB.NC	   821#	   821
GB.RAT	   820#	   820
GBHID	   824#	   824
GBLC	   822#	   822	  1409	  2207	  2539	  2576
GBNAM	   823#	   823
GBNC	   821#	   821	  1927	  1938	  1941	  2199	  2536	  2575
GBRAT	   820#	   820	  1393	  2197	  2532	  2572
GCBNAM	  1992	  1998	  2008#
GETCLP	  5368
GETEWZ	   753#	  5443
GETLDB	   756#	  4252
GETOPN	  3916	  3920#
GETRBF	  2254	  2361	  2917	  5100#
GETSPN	  3917	  3928#
GETTDB	  3895	  4209#
GETWD1	   754#
GETWDU	   754#
GETWRD	  1259
GETXBF	  5012#	  5040
GETXBH	  2915	  4973#
GETZBF	  5014	  5106	  5393#
GINST	  1185#	  1185	  1186	  1195#	  1195	  1196	  1226#	  1226	  1227	  1233#	  1233	  1234	  1273#	  1273
	  1274	  1288#	  1288	  1289	  1336#	  1336	  1337	  1348#	  1348	  1349	  1383#	  1383	  1384	  1398#
	  1398	  1399	  1478#	  1478	  1479	  1507#	  1507	  1508	  1538#	  1538	  1539	  1553#	  1553	  1554
	  1651#	  1651	  1652	  1706#	  1706	  1707	  1730#	  1730	  1731	  1739#	  1739	  1740	  1760#	  1760
	  1761	  1761#	  1762	  1801#	  1801	  1802	  1810#	  1810	  1811	  1819#	  1819	  1820	  1844#	  1844
	  1845	  1914#	  1914	  1915
GIVBF	  5073	  5109	  5134	  5420#
GIVEWS	   753#	  5458
GOTCHR	  4718	  4724#
GTCDON	  3670	  3674#
GTCSLP	  3671#	  3673
Symbol cross reference

GTCSTR	  3032	  3037	  3653#	  3866	  3922	  3930
GTLCOB	  1838	  1854	  1871#
GTSRVR	  1795	  1884	  1984#
GTXFL	  4976	  4994#	  4999
GTXNXT	  4974#	  4988
HC.BEG	   882#	  1890
HC.IMR	   887#	   887
HC.ISR	   888#	   888
HC.LEN	   891#	  1889
HC.LST	   891#	  2117
HC.MSK	   890#	   890
HC.RCV	   883#	   883
HC.RES	   889#	   889
HC.RTR	   885#	   885
HC.SEQ	   886#	   886
HC.XMT	   884#	   884
HCIMR	   887#	   887	  3228	  3236
HCISR	   888#	   888	  4889
HCMSK	   890#	   890
HCRCV	   883#	   883	  2797
HCRES	   889#	   889
HCRTR	   885#	   885	  3498
HCSEQ	   886#	   886	  3139
HCXMT	   884#	   884	  3306	  3589
HDRDAT	  3966	  3993#
HIGH	   533	  1080	  1128	  1602	  1639
HMRUN	  2835	  3114#
HMSTOP	  2837	  3211#
HMSTRT	  2836	  2895#
HN	  2116	  2116#	  2120	  2121	  2122	  2152	  2154	  2157	  2161	  2163	  2165	  2167	  2169	  2178
	  2184	  2187	  2189	  2191	  2193	  2195	  2196	  2204	  2211	  2216	  2225	  2249	  2252	  2253
	  2270	  2351	  2351#	  2352	  2354	  2359	  2363	  2364	  2366	  2382	  2383	  2394	  2438	  2442
	  2445	  2469	  2470	  2494	  2495	  2497	  2498	  2529	  2531	  2571	  2599	  2607	  2613	  2617
	  2619	  2621	  2623	  2625	  2627	  2638	  2650	  2650#	  2651	  2731	  2732	  2745	  2750	  2752
	  2756	  2772	  2772#	  2776	  2782	  2785	  2786	  2797	  2852	  2853	  2854	  2856	  2860	  2862
	  2877	  2882	  2895	  2899	  2902	  2903	  2941	  2945	  2949	  2950	  2959	  2961	  2964	  2969
	  2972	  2974	  3088	  3102	  3139	  3198	  3202	  3228	  3236	  3288	  3289	  3290	  3300	  3306
	  3309	  3310	  3341	  3344	  3347	  3349	  3398	  3475	  3498	  3572	  3589	  3749	  4069	  4071
	  4174	  4176	  4299	  4317	  4889	  5100	  5101	  5111	  5113	  5125	  5126	  5136	  5138	  5182
	  5281	  5281#	  5315
HN%ACS	   841#	  2375
HN%ANY	   830#
HN%CIP	   831#
HN%CLS	   836#
HN%FIL	   835#
HN%NDD	   840#	  2377	  2379
HN%OTH	   834#	  2373
HN%RUN	   829#
HN%SVD	   837#	  2380
HN%SVN	   839#	  2380
HN%SVR	   838#	  2368	  2380
HN.ACS	   841#
HN.ANY	   830#
HN.BEG	   827#
Symbol cross reference

HN.CFL	   833#	   833
HN.CIP	   831#
HN.CLS	   836#
HN.CON	   848#	   848
HN.FIL	   835#
HN.FLG	   828#	   828	  1361	  1418	  1449	  2877	  2882
HN.HST	   857#	   857
HN.ID	   869#	   869	  1521	  2157	  2211	  2498	  2627
HN.IDC	   867#	   867
HN.LAS	   850#	   850
HN.LEN	   873#
HN.LOK	   865#	   865
HN.LST	   873#	   875	   878
HN.MAC	   845#	   845
HN.MCM	   871#	   871	  2216	  2363
HN.MCO	   847#	   847
HN.MTI	   853#	   853	  1655	  1664
HN.MXC	   843#	   843	  1655	  1664	  1665
HN.NAC	   846#	   846
HN.NAM	   868#	   868	  1492	  2152	  2495	  2619	  2623
HN.NCC	   844#	   844
HN.NDD	   840#
HN.NIQ	   860#	   860	  2852	  2853	  2854
HN.NMC	   866#	   866	  1695
HN.NRB	   856#	   856
HN.NSV	   864#	   864
HN.NUM	   849#	   849
HN.NXI	   863#	   863
HN.OTH	   834#
HN.PID	   862#	   862
HN.PRG	   855#	   855
HN.QAC	   858#	   858	  1811	  2945	  2969	  3198	  3341	  4299
HN.QIC	   859#	   859	  1813	  2941	  2964	  3202	  3344
HN.RLI	   851#	   851
HN.RUN	   829#	  2359	  3398
HN.SCQ	   861#	   861
HN.SMT	   870#	   870	  2599	  3290
HN.SRV	   872#	   872	  1438	  1709	  1931	  1965	  2196	  2531	  2571
HN.SVD	   837#
HN.SVN	   839#
HN.SVR	   838#
HN.TIM	   852#	   852
HNACS	   841#	   841	  1156
HNANY	   830#	   830
HNCFL	   833#	   833	  2364	  2382	  2438
HNCIP	   831#	   831	  2731	  2895	  2896	  3288	  3309
HNCLS	   836#	   836	  1448
HNCON	   848#	   848	  1723	  4069	  4071	  4174	  4176
HNFIL	   835#	   835
HNFLG	   828#	   828
HNHST	   857#	   857
HNID	   869#	   869
HNIDC	   867#	   867	  1518	  1525	  2161	  2204	  2497	  2625
HNLAS	   850#	   850	  1145	  2169	  2445	  2899	  4317
Symbol cross reference

HNLOK	   865#	   865	  2225	  2366
HNMAC	   845#	   845	  1136	  2184	  2903
HNMCM	   871#	   871
HNMCO	   847#	   847	  1139	  2189	  2607
HNMTI	   853#	   853	  1154	  2167	  2354	  2442
HNMXC	   843#	   843	  2178	  2950
HNNAC	   846#	   846	  2902	  2949	  2972	  2974	  3347	  3349	  5101	  5126
HNNAM	   868#	   868
HNNCC	   844#	   844	  1806	  2959	  2961
HNNDD	   840#	   840	  1162
HNNIQ	   860#	   860	  2745	  2750	  2752
HNNMC	   866#	   866	  1475	  1489	  2154	  2494	  2617	  2621
HNNRB	   856#	   856	  5100	  5111	  5113	  5125	  5136	  5138
HNNSV	   864#	   864	  1413	  1415	  1436	  1445	  1447	  1656	  1705	  1932	  2195	  2529
HNNUM	   849#	   849	  1142	  2613
HNNXI	   863#	   863	  2187	  3088	  3102
HNOTH	   834#	   834	  1144	  1153
HNPID	   862#	   862	  2249	  2394	  3300	  3572	  3749
HNPRG	   855#	   855
HNQAC	   858#	   858	  1991
HNQIC	   859#	   859	  1997
HNRLI	   851#	   851	  1148	  2163	  3475
HNRUN	   829#	   829	  2121	  2252	  2874
HNSCQ	   861#	   861	  2782	  2785	  2786	  2856	  2860	  2862
HNSMT	   870#	   870
HNSRV	   872#	   872
HNSVD	   837#	   837	  1397	  1448
HNSVN	   839#	   839	  1416	  1448
HNSVR	   838#	   838	  1386	  1448
HNTIM	   852#	   852	  1460	  2165
HRNFND	  3197	  3201	  3205#
HRUNCB	  3114	  3183#	  3211
HSDATA	  3830	  3966#
HSDATB	  3831	  3991#
HSSTOP	  3835	  3944#
HSSTR1	  3876#	  3883
HSSTR3	  3870	  3878	  3882	  3884#
HSSTRT	  3832	  3847#
HSTRCB	  2906	  2941#
IDLHLT	  3243#	  4315
IGCSTR	  3028	  3652#	  3869	  3912	  3913	  3914	  3915
IGNSLT	  3833	  3945	  3953	  4000	  4003	  4007	  4886#
ILLCBR	  2660#	  2667	  2668	  2669	  2670	  2671	  2672	  2673	  2674	  2679	  2680
ILLMES	  2994	  3029	  3033	  3038	  3118	  3148	  3158	  3204	  3214	  3227#
ILLMS0	  3184	  3188	  3228#
ILLSLT	  3797	  3805	  3807	  3815	  3816	  3817	  3818	  3819	  3820	  3821	  3822	  3823	  3824	  3825
	  3826	  3827	  3828	  3834	  3849	  3852	  3948	  3995	  4017	  4889#
INCFLG	  2417
INFSTP	  3230	  3233	  3238	  3241	  3256	  3258#
INIRES	  2119	  2126	  2130	  2260#
INISBN	  2229#	  2230
INLMES	  2296	  2308
INVRUN	  3123	  3192	  3255#
IONND%	  4283
Symbol cross reference

IRRDSC	  5274
IRRSCG	  5278
IRRTMO	  5276
J	   490	  1257	  4156	  4158
JIFSEC	  1461	  3020
JP.POK	  1330
L1RCHP	   760#	  5155
LA%DSC	   684#	  1395
LA%RAT	   683#	  1384
LAABS%	   735#
LAADC%	   736#
LABFCK	  1659	  1726	  1799	  1808	  2071#
LABTS%	   725#
LACLR	  1312	  1328#
LAFDSP	  1297	  1310#	  1311	  1312	  1313	  1314	  1315	  1316	  1317
LAG2BY	  2803	  2805	  2807	  3002	  3024	  3026	  3637#
LAGTCR	  2141	  5348#
LAHAS%	   733#
LAHNDB	   752#	  1274	  2123	  2262	  2352	  2651	  2776
LAHPV	   634#	  1671	  2426	  3006
LAILR%	   732#
LAINT0	  2708	  2736	  2742#
LAINTR	  2677	  2693#
LAINTX	  2676	  2722#
LAIPN%	   729#
LAIPV%	   730#
LAIVF%	   734#
LALNO%	   727#
LALPV	   635#	  1671	  2426	  3005
LAMUX	  2783	  4295#
LANTR1	  2694	  2701	  2703#
LANXCB	  4300#	  4390
LAP2B0	  2427	  2429	  2441	  2604	  2606	  2610	  2612	  2614	  2616	  3407	  3409	  3411	  3412	  3414
	  3533	  3535	  3537	  3542	  3696#	  4540	  4825	  4826	  4836	  4838
LAP2BY	  2545	  3694#
LAPRV%	   737#
LAQUE	  2971	  3346	  4058	  4905#
LARSCH	  2762#
LAS1C	  1733	  1755#
LASAS	  1315	  1780#
LASBAD	  1030#	  3260	  3271
LASCH	  1313	  1651#
LASCO	  1316	  1836#
LASDEF	  1020#	  2168
LASET	  1311	  1327#
LASET0	  1346	  1359#
LASET1	  1332	  1334#
LASTC	  1314	  1723#
LASTCD	  1735	  1738#
LASTCL	  1732#	  1737
LASTCN	  1734	  1736#
LASVC%	   731#
LASVR%	   728#
LATCBR	  2242	  2650#
Symbol cross reference

LATCHP	  5157	  5173#
LATDSP	  1086#	  4251
LATFRE	  1024#	  2139	  2140	  5381	  5394	  5430
LATICB	  2659#	  2659
LATIMT	  2821#	  2821
LATINE	  2261#	  2261
LATINI	  2113	  2115#
LATLOC	  1025#	  2145
LATLSC	  2678	  2874#
LATMCT	  1026#	  2175	  2337	  2338	  2358	  2879	  2880
LATMEM	  5428#	  5428
LATNFB	  1027#	  2144	  2927	  5378	  5397	  5431
LATNSC	  3271#	  3271
LATREM	  1093	  5274#
LATRFB	  1029#	  5357	  5365	  5376
LATRTQ	  1023#	  4257	  5149
LATSCN	  4297	  5149#	  5164
LATSEC	  1088	  2332#
LATSTO	  2764#
LATWFB	  1028#	  2780	  2928	  5356
LATX01	   725#	  1843	  2074
LATX02	   726#	  1357
LATX03	   727#	  1275
LATX04	   728#	  1988	  2003
LATX05	   729#
LATX06	   730#	  1339	  1408	  1488	  1517
LATX07	   731#	  1344	  1926	  1964
LATX08	   732#	  1967
LATX09	   733#	  1477
LATXAC	   736#	  1260	  1266	  1293	  1402	  1482	  1511	  1541	  1791	  1880	  1918
LATXM0	  2369	  2372#
LATXM1	  2380#
LATXM2	  2371	  2382#
LATXMC	  2349#
LATXPV	   737#	  1333
LAUNQ	  2967	  3343	  4162	  4923#
LAVOR%	   726#
LAZCO	  1317	  1852#
LCLHLT	  3246#	  4401
LDBBYT	   760#	  5156	  5173
LDBDCH	   757#	  4780
LDBECC	   760#	  4870
LDBISR	   757#
LDBLAT	   757#	  1189	  1199	  2290	  4260	  4282	  5152	  5283
LDBPAG	   754#	   754	  1011
LDBQUH	   757#	  4258
LDBTIC	   759#	  4869
LDBTTW	   758#
LDLIDL	   762#
LDPAPC	   758#	  4262
LDPLNO	  1759
LDPXNF	  1011#	  4265	  4819	  5174
LDRREM	   757#
LF%CLR	  1119#	  1135	  1138	  1141	  1147	  1150	  1153	  1156	  1162	  1165	  1342
Symbol cross reference

LF%LOK	  1118#
LF%RNG	  1117#	  1135	  1138	  1141	  1144	  1147	  1150	  1153	  1349
LHPRID	   643#	  1675	  2615
LMNMRN	  4326	  4354#
LMNOXB	  4339	  4346#
LMRFSI	   640#	   944	  1674	  2440	  2603	  3743
LMUNSL	  4356	  4370#
LOKETH	  2744	  2851	  5282
LS.OFF	   656#	  1143	  2170	  4318
LS.ON	   657#	  1020	  1143	  2446	  2900
LS.SHT	   658#
LSDMUX	  3166	  3780#
LTCOBF	  5280#
LTHNGU	  5258#	  5275	  5277
LTLLAT	   758#	  4250
LTSSD0	  5284	  5287#
LTSSDC	  5259	  5281#
LVSKEW	  3007	  3232#
M	   490	   709	  1184	  1185	  1195	  1222	  1226	  1233	  1256	  1258	  1302	  2094
M.LIDL	   762#	  4263
MAXCBF	  2654	  2664#	  2666
MAXCIR	   649#	  2177
MAXCNT	  1626
MAXCRE	   651#	  4067	  4532	  4857
MAXMTY	  2812	  2832#	  2834
MAXSFL	  4499#	  4502	  4503
MAXSTY	  3778#	  3804	  3814
MAXXBF	   647#	   946	  2926	  3147	  4973
MD.LEN	   783	   945	  5024	  5042
MD.NXT	  3452	  4419	  4454	  5025	  5038	  5070
MDALA	  4984	  5026
MDAUX	  4978	  5019
MDB.OF	   782#	  3452	  3454	  3456	  4419	  4454	  4978	  4980	  4982	  4984	  5025	  5038	  5070
MDBYT	  3454	  4455	  4980	  5021
MDLXB1	  3362#	  3367	  3370
MDLXBF	  2913	  3325	  3361#
MDVMC	  4982	  5023
MINCBF	  2653	  2655	  2663#	  2666	  2676	  2677	  2678	  2679	  2680
MINMTY	  2811	  2825	  2831#	  2834	  2835	  2836	  2837
MINSFL	  4498#	  4502	  4503
MINSTY	  3777#	  3803	  3806	  3814	  3830	  3831	  3832	  3833	  3834	  3835
MINXBF	   659#	  2632	  2633	  3418	  3453	  4452	  4453	  4974
ML.DSC	   800#	   806	   870	  1075	  1515	  1519	  1655	  1694	  1986	  2158
ML.HMC	   806#	   872
ML.HSM	   808#	   871
ML.LOC	   799#	   808	   811	   930	   958	  1655	  3035
ML.NNM	   797#	   806	   808	  1075	  1486	  1490	  1655	  1694
ML.PNM	   805#	   985	   986	  3921	  3929
ML.SID	   802#	   806	   825	  1406	  2205	  2206
ML.SLN	   804#	   984
ML.SNM	   801#	   806	   824	   929	  1924	  3864
ML.SYS	   798#	   808	   810	   957	  3030
MMFREE	  2263	  2265	  2267	  4173	  4998	  5083	  5450#
MMGTZW	  2118	  2125	  2129	  2954	  3401	  4039	  4975	  5434#
Symbol cross reference

MMHDSI	   581#	  4452	  4453
MMVAZ0	  1630#	  1635
MMVAZS	  1626#	  2159
MNLFCN	  1276	  1297	  1307#	  1310	  1311	  1312	  1313	  1314	  1315	  1316	  1317
MNSPAR	  1124#	  1130	  1131	  1132	  1337
MOV7T8	  1193	  1203	  1219#
MOVNIQ	  2778	  2850#
MS.SCA	  5367
MSGACK	  1032#	  2808	  3127
MSGDID	  1032#	  2804	  3116	  3183	  3218
MSGDON	  2796	  2824	  2827#
MSGDSP	  2825	  2834#	  2835	  2836	  2837
MSGNXT	  2782#	  2792	  2828
MSGSID	  1032#	  2806	  2897	  3000	  3117	  3213	  3390	  3408
MSKPTR	  1546
MSTMSI	   582#	  2992
MT.MCA	   550#	  2422
MT.RUN	   547#	  2831	  2832	  2835	  3449
MT.STA	   548#	  2729	  2831	  2832	  2836	  3293
MT.STP	   549#	  2831	  2832	  2837	  3406
MTTRUN	  3430#	  4344	  4388
MTTSP0	  3384	  3398#
MTTSTP	  3167	  3244	  3247	  3272	  3383#
MTTSTR	  2921	  3288#
MW.LOC	   811#
MW.SYS	   810#	  1725	  1763	  1807	  1821
MXBALC	   652#	  4371
MXHSRV	   641#	   806	   873	  1674	  1965
MXLFCN	  1277	  1308#	  1310
MXNXC1	  4387	  4397#
MXNXC2	  4319	  4401#
MXNXCB	  4313	  4316	  4323	  4345	  4347	  4359	  4375	  4382	  4389#	  4402
MXNXSL	  4421	  4425#
MXSLSI	   638#	  1673	  4536	  4872
MXSLTS	   639#	  1673	  2608	  2609
MXSPAR	  1122#	  1130	  1131	  1132	  1338
NBUFS	   946#	  5349
NETDIL	  1184#
NFND1	  2945#
NFND2	  2949#
NFRSBQ	   756#	  2229	  4043	  4049	  4194
NGVLDB	  4157	  4282#
NN	  5481#	  5481
NOCHR	  4716	  4720	  4725#
NOCRE0	  3236#
NOCRES	  2905	  2918	  2955	  2965	  3235#
NOPADC	  1188	  1194	  1198	  1204
NSBWDS	   756#	  2228	  4042
NSLOTS	  1021#	  2800	  3138	  3527	  3784	  3808	  4310	  4427	  4464	  4495
NTDIL1	  1186	  1195#
NTTLAH	   755#	  1137	  1728	  2128	  2188	  3947	  3994
NU.OPN	  2244
NU.RCC	  2663	  2664	  2680
NU.RCI	  2663	  2664	  2678
Symbol cross reference

NU.RCV	  2663	  2664	  2677	  2706	  3754
NU.SCA	  2663	  2664	  2679
NU.XMT	  2396	  2663	  2664	  2676	  2789	  3302	  3506	  3585
NXSLCH	  3977#	  3987
NXTACK	  3153#	  3161
NXTSLT	  3786#	  3812
OURCNT	  1010#	  2153	  2198	  5467	  5475
OURNAM	  1009#	  2151	  2200	  5468	  5469	  5471
P	  1187	  1193	  1197	  1203	  1220	  1221	  1223	  1225	  1230	  1231	  1237	  1238	  1250	  1256
	  1302	  1303	  1376	  1545	  1546	  1555	  1557	  1560	  1562	  1626	  1628	  1633	  1729	  1736
	  1738	  1904	  1984	  2008	  2033	  2034	  2038	  2039	  2041	  2042	  2094	  2095	  2115	  2116
	  2261	  2287	  2288	  2289	  2292	  2293	  2294	  2298	  2304	  2310	  2321	  2324	  2326	  2350
	  2351	  2417	  2419	  2432	  2518	  2564	  2598	  2650	  2659	  2744	  2753	  2771	  2772	  2821
	  2851	  2855	  3258	  3261	  3271	  3616	  3653	  3863	  3881	  3884	  3924	  3932	  4156	  4158
	  4246	  4623	  4745	  4746	  4770	  4771	  5157	  5281	  5282	  5287	  5393	  5398	  5403	  5404
	  5428	  5442	  5445
P1	   490	  1184	  1185	  1195	  1261	  1263	  1545	  1558	  1563	  1682	  1683	  1687	  1689	  1730
	  1740	  1741	  1760	  1761	  1764	  1767	  1780	  1836	  1852	  1904	  1933	  1956
P2	   490	  1273	  1276	  1277	  1280	  1281	  1283	  1297	  1340	  1380	  1505	  1569	  1680	  1681
	  1685	  1731	  1732	  1737	  1904	  1931	  1936	  1938	  1948	  1952	  1955	  1966	  1969
P3	   490	  1376	  1379	  1421	  1679	  1688
P4	   490	  1376	  1382	  1386	  1397	  1416	  1418
PAGSIZ	  5340	  5364
PCRLF	  2312
PG.BDY	  5363
PRNAME	  2311
PROECO	   637#	  1672	  2428	  2605
PROVER	   636#	  1672	  2428	  2605
PRVBIT	  1331
PSECT.	   533#	  1006	  1006#	  1080	  1080#	  1128	  1602	  1639
PTCST0	  2471	  2496	  2499	  2620	  2624	  2628	  3711#
PTCSTL	  3713#	  3716
PTCSTR	  2538	  2541	  3709#
PTR1	  2034
PTR2	  2034
PTUSTL	  3727#	  3730
PTUSTR	  3725#
PX.MEM	  1185	  1195	  1226	  1233	  1273	  1288	  1336	  1348	  1383	  1398	  1478	  1507	  1538	  1553
	  1651	  1706	  1730	  1739	  1760	  1761	  1801	  1810	  1819	  1844	  1914
PX.SRC	  1666	  1676	  1696	  1710	  1766	  1803	  1823	  1845
Q1	   708#	  1251	  1262	  1273	  1288	  1289	  1336	  1348	  1383	  1398	  1478	  1507	  1538	  1553
	  1651	  1730	  1739	  1741	  1786	  1801	  1810	  1840	  1841	  1844	  1875	  1914	  1945	  1963
	  1984	  1991	  1994	  1997	  2000	  2009	  2011	  2013	  2017	  2071	  2072	  2101
Q2	   709#	  1136	  1139	  1142	  1145	  1148	  1154	  1274	  1361	  1413	  1415	  1418	  1436	  1438
	  1445	  1447	  1449	  1460	  1475	  1489	  1492	  1518	  1521	  1525	  1566	  1656	  1665	  1680
	  1695	  1705	  1709	  1723	  1806	  1811	  1813	  1890	  1931	  1932	  1965	  1991	  1997	  2101
QL.BEG	   998#
QL.BWD	  1000#	  1000
QL.FWD	   999#	   999	  4926	  4929
QL.LEN	  1001#	  1024
QL.LST	  1001#
QLBWD	  1000#	  1000	  2140	  2964	  4171	  4438	  4440	  4441	  4443	  4445	  4908	  4910	  4923	  4927
	  4942	  4946	  4960
QLFWD	   999#	   999	  1827	  2017	  2139	  3055	  3063	  3496	  4124	  4299	  4389	  4416	  4425	  4435
Symbol cross reference

	  4437	  4439	  4442	  4444	  4906	  4909	  4911	  4924	  4930	  4944	  4945	  4957	  4959	  4961
QUE1WB	  3160	  3442	  4942#	  4987	  5382	  5432
RANDOM	  2186	  2435	  5302#
RATLP	  2572#	  2582
RB	  2650	  2650#	  2693	  2699	  2704	  2707	  2756	  2772	  2772#	  2794	  2795	  2798	  2799	  2802
	  2977	  2993	  3004	  3008	  3012	  3014	  3016	  3018	  3023	  3059	  3060	  3194	  3195	  3259
	  3578	  3579	  3638	  3639	  3640	  3654	  3656	  3659	  3669	  3671	  3675	  3786	  3788	  3790
	  3792	  3796	  3798	  3800	  3811	  3850	  3856	  3858	  3862	  3876	  3877	  3885	  3984	  5129
	  5133	  5182	  5281	  5281#	  5315
RBFSIZ	   944#	  5104
RBPOSS	  2700	  3742#	  5108
RBPOST	  3743#	  5130
RECPTY	   756#	  3985
RELRB0	  5128	  5131	  5133#
RELRBF	  2827	  5125#
RELSB	  3954	  4126	  4138#	  4563	  4586
RELSB0	  4155	  4160#
RELSBS	  2911	  3323	  4123#	  4127
RELXBF	  3155	  5069#	  5081
RELXBH	  3369	  3595	  3620	  5060	  5081#
RFXBFS	  2912	  3324	  5056#	  5061
RLSBID	  4169	  4185#	  4579
RSKP	  1201	  4778
RTN	   755#	  1631	  1817	  2009	  3056	  3334	  3430	  3590	  3658	  3713	  3727	  4123	  4860	  4874
	  5071	  5470
RTXTIM	  1017#	  1464	  3438	  3480
RTZER	   754#
S$DEBU	  2261	  2659	  5428
S$EVEN	  2821	  3271
SASBEG	   955#	  1798	  1802
SASBG	   956#
SASEN	   957#
SASEND	   958#	  1798
SASLP	  1812	  1814	  1817#	  1828
SAVE4	   754#	  1249
SAVT	  3742
SB	  2772	  2772#	  3857	  3859	  3865	  3868	  3903	  3920	  3925	  3928	  3933	  3951	  3952	  3971
	  3999	  4001	  4004	  4006	  4010	  4012	  4015	  4018	  4041	  4052	  4055	  4057	  4060	  4061
	  4063	  4066	  4068	  4083	  4091	  4101	  4111	  4124	  4154	  4161	  4163	  4170	  4171	  4172
	  4185	  4196	  4259	  4260	  4266	  4416	  4420	  4425	  4433	  4435	  4441	  4443	  4444	  4531
	  4557	  4580	  4625	  4628	  4638	  4640	  4717	  4721	  4722	  4723	  4732	  4735	  4756	  4757
	  4758	  4775	  4777	  4797	  4801	  4803	  4805	  4818	  4832	  4834	  4858	  5152	  5162	  5175
	  5179	  5182	  5281	  5281#	  5283	  5285	  5315
SB%FCC	   970#
SB%FOU	   968#
SB%OUT	   969#
SB%REJ	   966#
SB%SDP	   965#
SB%STO	   971#
SB%STR	   967#
SB%TTO	   990#
SB%XNF	   991#
SB.ATS	   972#	   972
SB.BEG	   962#
Symbol cross reference

SB.CBA	   987#	   987	  1190	  1756	  2294	  5162	  5285
SB.CHR	   992#	   992
SB.FCC	   970#
SB.FLG	   964#	   964	  4083	  4091	  4101	  4111	  4163	  4420
SB.FOU	   968#
SB.LEN	   994#	  4038
SB.LID	   976#	   976
SB.LNK	   963#	   963
SB.LST	   994#
SB.MDS	   973#	   973
SB.OPC	   981#	   981
SB.OPN	   984#	   984	  3920
SB.OUT	   969#
SB.RCR	   978#	   978
SB.REA	   979#	   979
SB.REJ	   966#
SB.REM	   989#	   989
SB.RID	   975#	   975
SB.SDP	   965#
SB.SNC	   980#	   980
SB.SNM	   983#	   983	  3865
SB.SPC	   982#	   982
SB.SPN	   985#	   985	  1202	  3928
SB.STA	   974#	   974
SB.STO	   971#
SB.STR	   967#
SB.TDB	   986#	   986	  1755
SB.TTO	   990#	  4717
SB.XCR	   977#	   977
SB.XNF	   991#
SBAGO	  4044	  4047#
SBALOC	  3853	  4038#
SBANXT	  4043#	  4045
SBATS	   972#	   972	  3857
SBCBA	   987#	   987	  3952	  4006	  4061
SBCHR	   992#	   992	  4723	  4756
SBF.OF	   784#	   871	  2384	  2391	  2420	  2467	  2492	  2520	  2565	  2600	  2726	  3291	  3295	  3745
SBFCC	   970#	   970	  3897	  4498	  4499	  4514	  4515	  4827	  5178
SBFLG	   964#	   964
SBFOU	   968#	   968	  4498	  4499	  4512	  4513	  4604	  5280
SBLID	   976#	   976	  4052	  4185	  4196	  4832
SBLNK	   963#	   963
SBMDS	   973#	   973	  3859	  4638	  4640
SBOPC	   981#	   981	  3925
SBOPN	   984#	   984
SBOUT	   969#	   969	  4021	  4498	  4499	  4510	  4511	  4783	  5158
SBPRMX	  3879	  3918#
SBPRTB	  3881	  3912#	  3918
SBRCR	   978#	   978	  4015	  4018	  4068	  4775	  4777	  4858
SBREA	   979#	   979	  3903	  4557	  4580
SBREJ	   966#	   966	  3904	  4498	  4499	  4504	  4505	  4561
SBREM	   989#	   989
SBRID	   975#	   975	  4001	  4063	  4834
SBSDP	   965#	   965
Symbol cross reference

SBSNC	   980#	   980	  3868
SBSNM	   983#	   983
SBSPC	   982#	   982	  1200	  3933
SBSPN	   985#	   985
SBSTA	   974#	   974	  4004	  4060	  4531
SBSTO	   971#	   971	  4498	  4499	  4508	  4509	  4584	  5258
SBSTR	   967#	   967	  3897	  4498	  4499	  4506	  4507	  4542
SBTDB	   986#	   986	  3971	  4154	  4259	  4625	  4805	  4818
SBTTO	   990#	   990	  4721	  4757
SBVECT	  1019#	  1731	  2131	  2266	  3949	  3997	  4053	  4188
SBXCR	   977#	   977	  4010	  4012	  4066	  4628	  4732	  4735	  4797	  4801	  4803
SBXNF	   991#	   991	  4266	  5175	  5179
SCITTY	   646#	  3851	  4534
SCMPAR	  1942	  2014	  2033#
SCNADT	   762#	  4264
SE.ISR	   610#
SE.RES	   612#	  3902
SE.SER	   611#
SE.SHU	   609#	  3901
SE.USR	   608#
SENDMC	  2384#
SETCHP	   755#	  1090
SETCOD	  1157	  1535#
SETNID	  1163	  1505#
SETNNM	  1160	  1475#
SETRTX	  1151	  1460#
SL.DXF	   620#	  4812
SL.EXF	   619#	  4822
SLBDSP	  4481	  4502#	  4504	  4506	  4508	  4510	  4512	  4514
SLHDSI	   626#	   627	   628
SLHDSZ	   650#	  3795
SLLNTB	  4470	  4487	  4503#	  4505	  4507	  4509	  4511	  4513	  4515
SLRESF	  3896	  3902#
SLSHUT	  3893	  3901#
SLTCNT	  1033#	  3791	  3860	  3886	  3968	  4013	  4886
SLTDID	  1033#	  3787	  3848	  3944	  3993
SLTDSP	  3806	  3814#	  3830	  3831	  3832	  3833	  3834	  3835
SLTEPT	  1033#	  3801	  3810
SLTSID	  1033#	  3789	  3847	  3946	  3996	  4062
SLTTYP	  1033#	  3799	  4008	  4064
SNDMNC	  2367	  2391#
SRVLP	  2532#	  2543
SS.HLT	   601#
SS.RUN	   602#	  4005	  4530
SSBDAV	  3898	  3905	  4022	  4083#	  5163	  5286
SSEC1	  2115	  2288	  2350	  2771
SSERVC	  1166	  1376#
SSPCS	  1220
ST.ATT	   593#	  3777	  3778	  3833	  4600
ST.DTA	   590#	  3777	  3778	  3830	  4752
ST.DTB	   592#	  3777	  3778	  3831	  4810
ST.NRT	  3892
ST.REJ	   594#	  3777	  3778	  3834	  4559
ST.STA	   591#	  3777	  3778	  3832	  4532
Symbol cross reference

ST.STP	   595#	  3777	  3778	  3835	  4582
STANAM	   755#	  2148
STATES	  3891
STOTAC	   754#	  2096
STPCOD	  1032#	  3383	  3413
SXPCS	  1223
SZ.ATT	   788#	  4513	  4600
SZ.MHD	   786	   795#	  2600	  3451	  4979
SZ.MSP	   794#
SZ.REJ	   789#	  4505	  4559
SZ.SDB	   790#	  4515	  4810
SZ.SHD	   787#	  4505	  4507	  4509	  4511	  4513	  4515	  4631
SZ.SSP	   791#	  4509	  4582
SZ.SST	   792#	  4507	  4532
SZ.XBF	   793#	   945	  4473	  4631	  5020
SZMSTP	   786#	  3400
T1	  1191	  1200	  1201	  1221	  1222	  1225	  1226	  1227	  1234	  1251	  1258	  1260	  1261	  1262
	  1266	  1275	  1278	  1288	  1293	  1330	  1333	  1336	  1337	  1338	  1339	  1343	  1344	  1345
	  1350	  1352	  1357	  1359	  1362	  1379	  1383	  1384	  1387	  1395	  1398	  1402	  1408	  1419
	  1422	  1435	  1436	  1437	  1439	  1441	  1442	  1444	  1448	  1449	  1462	  1463	  1464	  1477
	  1478	  1482	  1488	  1490	  1493	  1507	  1511	  1517	  1519	  1522	  1538	  1541	  1551	  1552
	  1553	  1554	  1555	  1556	  1557	  1560	  1562	  1565	  1568	  1576	  1587	  1589	  1590	  1591
	  1611	  1630	  1655	  1658	  1664	  1666	  1670	  1676	  1685	  1687	  1694	  1696	  1705	  1706
	  1708	  1710	  1723	  1724	  1725	  1728	  1729	  1732	  1739	  1740	  1755	  1756	  1758	  1761
	  1763	  1766	  1781	  1786	  1791	  1797	  1798	  1803	  1806	  1807	  1818	  1819	  1821	  1823
	  1824	  1825	  1837	  1840	  1842	  1843	  1845	  1853	  1858	  1859	  1875	  1880	  1886	  1887
	  1889	  1905	  1909	  1914	  1918	  1926	  1936	  1937	  1944	  1945	  1947	  1950	  1952	  1962
	  1963	  1964	  1965	  1966	  1967	  1969	  1988	  1989	  1994	  2000	  2003	  2008	  2033	  2038
	  2041	  2044	  2046	  2058	  2059	  2061	  2071	  2073	  2074	  2117	  2120	  2123	  2124	  2127
	  2128	  2131	  2142	  2143	  2148	  2151	  2152	  2153	  2154	  2156	  2162	  2163	  2164	  2165
	  2168	  2169	  2170	  2177	  2178	  2184	  2185	  2187	  2188	  2189	  2190	  2191	  2192	  2193
	  2194	  2195	  2197	  2198	  2199	  2200	  2201	  2204	  2205	  2206	  2207	  2208	  2210	  2213
	  2217	  2219	  2220	  2228	  2229	  2230	  2240	  2241	  2242	  2243	  2244	  2248	  2249	  2262
	  2264	  2266	  2287	  2289	  2290	  2294	  2299	  2305	  2320	  2321	  2326	  2354	  2358	  2372
	  2384	  2385	  2387	  2388	  2390	  2391	  2392	  2393	  2394	  2395	  2396	  2419	  2420	  2421
	  2422	  2423	  2424	  2425	  2426	  2428	  2430	  2431	  2434	  2437	  2438	  2439	  2440	  2442
	  2443	  2444	  2447	  2448	  2467	  2468	  2469	  2492	  2493	  2494	  2497	  2521	  2522	  2523
	  2524	  2526	  2532	  2535	  2536	  2539	  2544	  2566	  2567	  2568	  2569	  2572	  2574	  2575
	  2577	  2578	  2579	  2580	  2600	  2601	  2603	  2605	  2607	  2608	  2609	  2611	  2613	  2615
	  2617	  2618	  2621	  2622	  2625	  2626	  2629	  2630	  2653	  2654	  2655	  2659	  2699	  2703
	  2705	  2706	  2742	  2788	  2789	  2795	  2799	  2800	  2801	  2802	  2804	  2806	  2808	  2809
	  2810	  2811	  2812	  2821	  2825	  2852	  2858	  2860	  2878	  2880	  2899	  2900	  2902	  2904
	  2908	  2909	  2922	  2923	  2926	  2927	  2928	  2941	  2945	  2953	  2956	  2957	  2958	  2969
	  2977	  2978	  2992	  2993	  2996	  2999	  3000	  3001	  3003	  3004	  3005	  3006	  3010	  3011
	  3012	  3013	  3014	  3015	  3016	  3017	  3018	  3019	  3020	  3021	  3022	  3023	  3025	  3027
	  3030	  3034	  3035	  3039	  3055	  3090	  3091	  3092	  3094	  3098	  3100	  3117	  3121	  3125
	  3126	  3127	  3128	  3129	  3134	  3136	  3156	  3159	  3198	  3202	  3215	  3218	  3229	  3232
	  3237	  3240	  3243	  3246	  3255	  3271	  3291	  3292	  3293	  3295	  3296	  3297	  3298	  3299
	  3300	  3301	  3302	  3336	  3338	  3340	  3341	  3344	  3362	  3365	  3366	  3367	  3383	  3385
	  3386	  3387	  3390	  3400	  3403	  3404	  3405	  3406	  3408	  3410	  3413	  3415	  3416	  3417
	  3418	  3419	  3431	  3434	  3436	  3437	  3439	  3441	  3443	  3444	  3445	  3446	  3447	  3448
	  3449	  3451	  3453	  3454	  3456	  3457	  3471	  3473	  3475	  3477	  3480	  3481	  3487	  3506
	  3529	  3532	  3534	  3536	  3538	  3539	  3541	  3566	  3568	  3569	  3570	  3572	  3578	  3580
	  3583	  3584	  3585	  3593	  3594	  3595	  3637	  3638	  3639	  3642	  3652	  3662	  3666	  3667
Symbol cross reference

	  3668	  3670	  3696	  3709	  3711	  3712	  3725	  3726	  3744	  3745	  3747	  3748	  3750	  3752	  3753
	  3754	  3784	  3793	  3794	  3795	  3800	  3801	  3810	  3811	  3860	  3861	  3862	  3863	  3864
	  3867	  3868	  3876	  3877	  3878	  3879	  3880	  3881	  3884	  3885	  3886	  3891	  3892	  3897
	  3904	  3921	  3923	  3925	  3929	  3931	  3933	  3949	  3950	  3951	  3997	  3998	  3999	  4021
	  4038	  4041	  4043	  4044	  4053	  4054	  4055	  4056	  4059	  4060	  4062	  4063	  4064	  4065
	  4066	  4067	  4068	  4090	  4103	  4160	  4170	  4186	  4189	  4191	  4192	  4194	  4195	  4196
	  4250	  4257	  4258	  4261	  4262	  4263	  4265	  4266	  4283	  4311	  4312	  4317	  4318	  4335
	  4336	  4370	  4371	  4373	  4374	  4397	  4398	  4399	  4400	  4451	  4452	  4453	  4455	  4470
	  4472	  4473	  4479	  4480	  4487	  4488	  4489	  4491	  4492	  4494	  4530	  4531	  4532	  4534
	  4535	  4536	  4537	  4538	  4539	  4541	  4542	  4557	  4558	  4559	  4561	  4580	  4581	  4582
	  4584	  4600	  4602	  4603	  4604	  4729	  4732	  4733	  4735	  4743	  4744	  4745	  4750	  4751
	  4752	  4771	  4772	  4773	  4774	  4783	  4801	  4802	  4803	  4809	  4810	  4812	  4822	  4823
	  4824	  4827	  4831	  4832	  4833	  4835	  4837	  4857	  4859	  4860	  4861	  4868	  4869	  4870
	  4872	  4874	  4880	  4881	  4905	  4906	  4907	  4908	  4926	  4929	  4930	  4942	  4943	  4946
	  4957	  4960	  4961	  4974	  4978	  4980	  4982	  4983	  4984	  4985	  4986	  4994	  4997	  5012
	  5016	  5017	  5020	  5021	  5022	  5023	  5024	  5026	  5042	  5043	  5044	  5056	  5069	  5070
	  5071	  5082	  5100	  5102	  5104	  5125	  5127	  5129	  5133	  5149	  5154	  5158	  5178	  5258
	  5280	  5302	  5307	  5309	  5310	  5311	  5312	  5320	  5349	  5356	  5362	  5363	  5364	  5365
	  5366	  5367	  5374	  5375	  5376	  5377	  5378	  5380	  5381	  5393	  5394	  5401	  5402	  5404
	  5405	  5406	  5407	  5409	  5410	  5411	  5420	  5421	  5422	  5423	  5428	  5429	  5430	  5441
	  5446	  5447	  5456	  5457	  5470	  5473	  5477
T2	  1136	  1139	  1142	  1145	  1148	  1154	  1229	  1263	  1289	  1290	  1345	  1348	  1355	  1356
	  1387	  1388	  1389	  1390	  1391	  1405	  1420	  1440	  1441	  1460	  1461	  1462	  1485	  1491
	  1514	  1520	  1539	  1549	  1550	  1566	  1571	  1573	  1575	  1588	  1591	  1613	  1632	  1665
	  1671	  1695	  1709	  1756	  1758	  1762	  1802	  1822	  1856	  1857	  1886	  1890	  1906	  1922
	  1923	  1938	  1948	  1985	  1990	  2008	  2033	  2036	  2042	  2044	  2046	  2072	  2073	  2145
	  2157	  2166	  2167	  2175	  2209	  2211	  2218	  2245	  2298	  2299	  2300	  2304	  2305	  2306
	  2310	  2322	  2385	  2386	  2387	  2388	  2389	  2390	  2397	  2445	  2446	  2470	  2495	  2498
	  2537	  2540	  2619	  2623	  2627	  2693	  2707	  2722	  2727	  2728	  2729	  2735	  2742	  2743
	  2747	  2748	  2750	  2752	  2782	  2784	  2787	  2788	  2794	  2862	  2875	  2905	  2918	  2949
	  2951	  2955	  2965	  2966	  2970	  2994	  2997	  3007	  3008	  3009	  3010	  3029	  3031	  3033
	  3036	  3038	  3083	  3085	  3086	  3088	  3089	  3091	  3093	  3095	  3097	  3102	  3116	  3118
	  3122	  3123	  3148	  3158	  3184	  3188	  3192	  3204	  3214	  3216	  3217	  3258	  3259	  3260
	  3261	  3271	  3303	  3342	  3345	  3366	  3368	  3483	  3507	  3527	  3528	  3529	  3540	  3541
	  3573	  3579	  3581	  3586	  3617	  3619	  3640	  3641	  3642	  3672	  3694	  3695	  3696	  3697
	  3698	  3699	  3714	  3728	  3743	  3744	  3745	  3746	  3748	  3749	  3750	  3751	  3752	  3753
	  3786	  3787	  3788	  3789	  3790	  3791	  3793	  3798	  3799	  3802	  3803	  3804	  3806	  3850
	  3851	  3856	  3857	  3858	  3859	  3865	  3901	  3902	  3903	  3920	  3928	  3944	  3947	  3950
	  3993	  3994	  3998	  4048	  4051	  4052	  4054	  4057	  4083	  4088	  4090	  4091	  4101	  4103
	  4104	  4109	  4111	  4161	  4188	  4189	  4190	  4193	  4398	  4400	  4746	  4770	  4819	  4820
	  4908	  4909	  4910	  4911	  4923	  4924	  4925	  4926	  4927	  4944	  4945	  4946	  4957	  4959
	  4977	  4978	  4979	  4980	  4981	  4982	  4983	  4984	  4985	  4997	  5018	  5019	  5059	  5101
	  5102	  5126	  5127	  5174	  5176	  5179	  5311	  5368	  5379	  5383	  5398	  5399	  5400	  5403
	  5406	  5408	  5411	  5421	  5426	  5429	  5441	  5442	  5445	  5447	  5456	  5457	  5472	  5474
	  5476
T3	  1189	  1190	  1191	  1192	  1199	  1200	  1202	  1342	  1343	  1349	  1350	  1352	  1353	  1354
	  1356	  1359	  1360	  1361	  1388	  1393	  1406	  1409	  1421	  1435	  1440	  1486	  1489	  1492
	  1515	  1518	  1521	  1550	  1568	  1571	  1573	  1604	  1605	  1614	  1616	  1628	  1629	  1633
	  1635	  1651	  1682	  1689	  1706	  1707	  1764	  1765	  1767	  1801	  1810	  1819	  1820	  1825
	  1826	  1841	  1842	  1844	  1857	  1907	  1924	  1927	  1939	  1940	  1949	  1986	  1990	  2011
	  2012	  2033	  2039	  2158	  2161	  2212	  2302	  2322	  2520	  2521	  2523	  2524	  2525	  2526
	  2528	  2565	  2566	  2567	  2568	  2569	  2570	  2574	  2579	  2580	  2652	  2704	  2723	  2724
	  2726	  2727	  2745	  2747	  2784	  2785	  2786	  2856	  2858	  2874	  2877	  2882	  2998	  3057
	  3059	  3119	  3121	  3131	  3132	  3133	  3134	  3142	  3144	  3146	  3193	  3194	  3654	  3657
Symbol cross reference

	  3658	  3659	  3665	  3666	  3667	  3668	  3673	  3709	  3710	  3712	  3713	  3716	  3726	  3727	  3730
	  3792	  3795	  3796	  3797	  3984	  3996	  4002	  4004	  4005	  4008	  4009	  4011	  4016	  4018
	  4019	  4048	  4049	  4193	  4194	  4251	  4437	  4439	  4440	  4441	  4442	  4445	  4454	  4455
	  4463	  4464	  4471	  4472	  4723	  4756	  4759	  4764	  4831	  4837	  4861	  4880	  4881	  4906
	  4907	  4911	  4923	  4927	  4928	  4929	  4942	  4943	  4944	  4959	  4960	  4961	  5016	  5019
	  5021	  5023	  5024	  5025	  5026	  5038	  5042	  5155	  5156	  5173	  5175	  5176	  5274	  5276
	  5278	  5399	  5407	  5408	  5410	  5422	  5423	  5424	  5425	  5471	  5476
T4	  1227	  1230	  1231	  1232	  1233	  1237	  1238	  1353	  1355	  1438	  1439	  1611	  1612	  1613
	  1630	  1631	  1632	  1656	  1657	  1658	  1708	  1724	  1735	  1797	  1802	  1811	  1813	  1817
	  1818	  1822	  1824	  1827	  1941	  2013	  2033	  2036	  2048	  2143	  2144	  2196	  2197	  2199
	  2201	  2207	  2212	  2519	  2522	  2525	  2527	  2652	  2694	  2743	  3058	  3060	  3120	  3122
	  3195	  3669	  3674	  3714	  3715	  3728	  3729	  4042	  4043	  4045	  4047	  4049	  4050	  4051
	  4438	  4439	  4440	  4905	  4909	  4924	  4925	  4930	  5302	  5310	  5374	  5379	  5380	  5384
TBEXEC	  1132#	  1136	  1139	  1142	  1145	  1148	  1151	  1154	  1157	  1160	  1163	  1166	  1362
TBFLGS	  1131#	  1135	  1138	  1141	  1144	  1147	  1150	  1153	  1156	  1159	  1162	  1165	  1343	  1345
	  1350	  1359
TBRNGE	  1130#	  1134	  1137	  1140	  1143	  1146	  1149	  1152	  1155	  1158	  1161	  1164	  1352
TCST1	  2322#	  2325
TCSTR	  2301	  2307	  2320#
TMPBLK	  1076#	  1077	  1411	  1485	  1491	  1514	  1520	  1548	  1549	  1556	  1568	  1906	  1907	  1908
	  1968	  1985	  1989
TMPGB	  1077#	  1393	  1405	  1409	  1420	  1922	  1927	  1939	  1941	  1949
TMPLNG	  1075#	  1076	  1905
TMRCHK	  3470#	  4322
TOTAKE	   760#	  5150
TPOPJ	   761#	  1224	  5396	  5444
TTFGRT	   758#	  4271
TTIWRN	   759#	  4868
TTYKLQ	  2295
U	  1011	  1189	  1199	  1755	  1759	  1760	  2290	  2292	  3971	  4154	  4258	  4259	  4260	  4282
	  4625	  4780	  4805	  4818	  4869	  4870	  5152	  5156	  5173	  5283
UE.BEG	   772#
UE.LEN	   775#	   781	   782	   783	   784	   944
UE.LST	   775#
UE.LW0	   773#	   773	  3515
UE.LW1	   774#	   774
UELW0	   773#	   773
UELW1	   774#	   774	  2747	  2748	  2784	  2787	  2858
UMVAZ0	  1611#	  1614
UMVAZ1	  1612	  1616#
UMVAZS	  1407	  1487	  1516	  1604#	  1925	  1987
UN.BFA	  3800	  3811	  3877
UN.BSZ	  3862	  3876	  3885
UN.LEN	   782	   783	   784	   944	  2703
UN.SID	  2795
UN.STA	  2250
UN.UID	  3366	  3594	  3619
UNA.EV	  3583	  3751
UNADS	  3584	  3752
UNB.OF	   781#	  2219	  2226	  2236	  2237	  2238	  2239	  2241	  2243	  2245	  2248	  2250	  2393	  2395
	  2397	  2421	  2423	  2425	  2430	  2437	  2439	  2443	  2448	  2468	  2493	  2527	  2528	  2530
	  2534	  2535	  2601	  2630	  2634	  2635	  2704	  2723	  2742	  2743	  2788	  2795	  2798	  2799
	  2802	  2977	  2993	  3004	  3008	  3012	  3014	  3016	  3018	  3023	  3059	  3060	  3194	  3195
	  3259	  3292	  3297	  3299	  3301	  3303	  3366	  3405	  3417	  3419	  3448	  3455	  3457	  3507
Symbol cross reference

	  3570	  3578	  3579	  3580	  3581	  3582	  3584	  3586	  3594	  3619	  3638	  3639	  3640	  3654	  3656
	  3659	  3669	  3671	  3675	  3695	  3697	  3699	  3710	  3711	  3715	  3725	  3729	  3744	  3747
	  3748	  3750	  3752	  3753	  3786	  3788	  3790	  3792	  3796	  3798	  3800	  3811	  3850	  3856
	  3858	  3862	  3876	  3877	  3885	  3984	  4418	  4451	  4471	  4488	  4491	  4494	  4535	  4537
	  4538	  4541	  4603	  4632	  4744	  4759	  4764	  4774	  4823	  5044
UNBFA	  2393	  2421	  2423	  2425	  2430	  2437	  2439	  2443	  2448	  2468	  2493	  2528	  2530	  2535
	  2601	  2630	  2798	  2799	  3004	  3008	  3012	  3014	  3016	  3018	  3292	  3297	  3405	  3417
	  3448	  3457	  3639	  3640	  3656	  3669	  3671	  3675	  3697	  3699	  3711	  3715	  3729	  3748
	  3786	  3788	  3790	  3798	  3850	  3856	  3858	  3984	  4491	  4535	  4537	  4538	  4541	  4603
	  4744	  4759	  4764	  4823	  5044
UNBSZ	  2527	  2534	  2634	  2802	  2993	  3023	  3419	  3455	  3638	  3654	  3659	  3695	  3710	  3725
	  3744	  3792	  3796	  4418	  4451	  4471	  4488	  4494	  4632	  4774
UNCBA	  2243	  2742	  2788
UNCHN	  2236
UNDAD	  2219	  2723	  3299	  3581
UNLETH	  2753	  2855	  5287
UNPAD	  2238
UNPID	  2248	  2395	  3301	  3578	  3580	  3750
UNPRO	  2241
UNQ1WF	  3157	  3363	  3432	  4957#	  4995	  5057	  5395
UNRID	  2226	  2635	  2693	  2722	  3582	  3747
UNSAD	  2977	  3059	  3060	  3194	  3195	  3259	  3579
UNSID	  2743
UNSTA	  2875
UNUID	  3570
UPPERC	  2043	  2045	  2058#
USRPTR	  1546
VLATSE	   539#
VMC.XC	  4981	  5022
W	   490	   708	  1250	  1303	  2095	  4246
W1	  2116	  2116#	  2270	  2351	  2351#	  2365	  2368	  2373	  2375	  2377	  2379	  2380	  2389	  2518
	  2529	  2530	  2543	  2564	  2570	  2582	  2598	  2602	  2618	  2622	  2626	  2631	  2632	  2633
	  2634	  2638	  2772	  2772#	  2798	  2809	  2823	  3081	  3085	  3090	  3098	  3128	  3130	  3143
	  3144	  3145	  3146	  3147	  3149	  3153	  3161	  3653	  3656	  3657	  3660	  3665	  3674	  3675
	  3968	  3987	  4420	  4422	  4423	  4424	  4480	  4623	  4631	  4632	  4639	  4640	  4642	  4710
	  4711	  4716	  4724	  4726	  4734	  4754	  4760	  4765	  4772	  4773	  4778	  4973	  4988	  5182
	  5281	  5281#	  5315
W2	  2116	  2116#	  2270	  2351	  2351#	  2518	  2531	  2532	  2536	  2537	  2539	  2540	  2542	  2564
	  2571	  2572	  2575	  2576	  2581	  2638	  2772	  2772#	  3653	  3671	  3672	  4470	  4479	  4481
	  4487	  4623	  4729	  4750	  4776	  4779	  5182	  5281	  5281#	  5315
W2PLSH	  5366
XB	  2116	  2116#	  2216	  2219	  2226	  2236	  2237	  2238	  2239	  2241	  2243	  2245	  2248	  2250
	  2270	  2351	  2351#	  2363	  2384	  2391	  2393	  2395	  2397	  2420	  2421	  2423	  2425	  2430
	  2437	  2439	  2443	  2448	  2467	  2468	  2492	  2493	  2520	  2527	  2528	  2530	  2534	  2535
	  2565	  2599	  2600	  2601	  2630	  2634	  2635	  2638	  2650	  2650#	  2722	  2723	  2726	  2735
	  2756	  2772	  2772#	  3154	  3290	  3291	  3292	  3295	  3297	  3299	  3301	  3303	  3368	  3403
	  3404	  3405	  3415	  3417	  3419	  3430	  3447	  3448	  3452	  3454	  3455	  3456	  3457	  3496
	  3507	  3515	  3570	  3580	  3581	  3582	  3584	  3586	  3594	  3617	  3695	  3697	  3699	  3710
	  3711	  3715	  3725	  3729	  4338	  4381	  4418	  4419	  4451	  4454	  4471	  4488	  4491	  4494
	  4535	  4537	  4538	  4541	  4603	  4632	  4744	  4759	  4764	  4774	  4823	  5025	  5038	  5044
	  5059	  5070	  5082	  5182	  5281	  5281#	  5315
XBF.OF	   783#	   786	  3404	  3415	  3447	  4974	  4983
XBFCHK	  4528	  4555	  4577	  4598	  4730	  4799	  5038#
XBFSIZ	   945#	  5012
Symbol cross reference

XMNOCB	  3571	  3578#
XMTALL	  3503#	  3516
XMTCHR	   759#	  4719	  4762
XMTDON	  2791	  3616#
XMTLIM	  3240#	  3483
XMTMS0	  3577	  3580#
XMTMS1	  3588	  3593#
XMTMSG	  3458	  3568#
XMTMSN	  3420	  3566#
XOFFC	   522#	  4824
XONC	   523#	  4824
XSLATT	  4512	  4598#
XSLDA0	  4762#	  4765
XSLDA2	  4755	  4760	  4763	  4770#
XSLDTA	  4510	  4623#
XSLDTB	  4514	  4797#
XSLREJ	  4504	  4555#
XSLSTA	  4506	  4528#
XSLSTP	  4508	  4577#
XUNAKQ	  3479	  3494#	  4346
XX	  5481#	  5481
ZZ	  1185#	  1185	  1195#	  1195	  1226#	  1226	  1233#	  1233	  1273#	  1273	  1288#	  1288	  1336#	  1336
	  1348#	  1348	  1383#	  1383	  1398#	  1398	  1478#	  1478	  1507#	  1507	  1538#	  1538	  1553#	  1553
	  1651#	  1651	  1706#	  1706	  1730#	  1730	  1739#	  1739	  1760#	  1760	  1761#	  1761	  1801#	  1801
	  1810#	  1810	  1819#	  1819	  1844#	  1844	  1914#	  1914
$ACLNG	  2191#	  2469#
$CB	  2772#	  5281#
$CBAKQ	  3162#
$CBCSB	  4337#	  4370#	  4374#	  4383#
$CBCTI	  3017#
$CBDLL	  3361#	  3494#	  3503#	  3511#	  3574#	  3596#	  3621#
$CBDNI	  2978#	  3057#	  3058#	  3193#	  3298#	  3573#
$CBERR	  3385#
$CBKTI	  3019#
$CBLID	  3082#	  3089#	  3120#	  3215#	  3536#
$CBLRA	  3142#	  3143#
$CBMRN	  4324#	  4357#
$CBMRS	  3164#	  4354#
$CBMSL	  3013#	  4463#
$CBMTF	  3003#
$CBNBF	  3015#
$CBNUM	  3025#
$CBPTC	  3027#
$CBRID	  3001#	  3119#	  3335#	  3386#	  3534#
$CBRLC	  2305#	  3039#
$CBRPV	  3011#
$CBRRF	  3530#	  4320#
$CBRSC	  1191#	  1758#	  2013#	  2299#	  3034#
$CBRSQ	  3131#	  3136#	  3538#
$CBRTC	  3151#	  3476#	  3500#
$CBSBQ	  4160#	  4314#
$CBSDC	  4085#	  4106#	  4165#	  4340#	  4384#
$CBSTA	  2908#	  2923#	  2958#	  2975#	  3126#	  3216#	  3337#	  3340#	  4311#
$CBTIM	  3163#	  3440#	  3470#	  3481#	  3487#
Symbol cross reference

$CBTSQ	  3443#	  3446#	  3540#
$CCIMR	  3227#	  3235#
$CCISR	  4890#
$CCRCV	  2976#	  3205#
$CCRTR	  3499#
$CCSEQ	  3140#
$CCXMT	  3307#	  3591#
$GBLC	  1409#	  2207#	  2539#	  2576#
$GBNC	  1927#	  1938#	  1941#	  2199#	  2536#	  2575#
$GBRAT	  1393#	  2197#	  2532#	  2572#
$HCIMR	  3228#	  3236#
$HCISR	  4889#
$HCRCV	  2797#
$HCRTR	  3498#
$HCSEQ	  3139#
$HCXMT	  3306#	  3589#
$HN	  2116#	  2351#	  2650#	  2772#	  5281#
$HNCFL	  2364#	  2382#	  2438#
$HNCIP	  2731#	  2895#	  3288#	  3309#
$HNCON	  1723#	  4069#	  4174#
$HNIDC	  1518#	  1525#	  2161#	  2204#	  2497#	  2625#
$HNLAS	  1145#	  2169#	  2445#	  2899#	  4317#
$HNLOK	  2225#	  2366#
$HNMAC	  1136#	  2184#	  2903#
$HNMCO	  1139#	  2189#	  2607#
$HNMTI	  1154#	  2167#	  2354#	  2442#
$HNMXC	  2178#	  2950#
$HNNAC	  2902#	  2949#	  2972#	  3347#	  5101#	  5126#
$HNNCC	  1806#	  2959#
$HNNIQ	  2745#	  2750#	  2752#
$HNNMC	  1475#	  1489#	  2154#	  2494#	  2617#	  2621#
$HNNRB	  5100#	  5111#	  5125#	  5136#
$HNNSV	  1413#	  1436#	  1445#	  1656#	  1705#	  1932#	  2195#	  2529#
$HNNUM	  1142#	  2613#
$HNNXI	  2187#	  3088#	  3102#
$HNPID	  2249#	  2394#	  3300#	  3572#	  3749#
$HNQAC	  1991#
$HNQIC	  1997#
$HNRLI	  1148#	  2163#	  3475#
$HNRUN	  2121#	  2252#
$HNSCQ	  2782#	  2785#	  2786#	  2856#	  2860#	  2862#
$HNTIM	  1460#	  2165#
$INCFL	  2417#
$MAXCN	  1626#
$MDALA	  4984#	  5026#
$MDAUX	  4978#	  5019#
$MDBYT	  3454#	  4455#	  4980#	  5021#
$MDVMC	  4982#	  5023#
$MSKPT	  1546#
$PTR1	  2034#
$PTR2	  2034#
$QLBWD	  2140#	  2964#	  4171#	  4438#	  4440#	  4441#	  4443#	  4445#	  4908#	  4910#	  4923#	  4927#	  4942#	  4946#
	  4960#
$QLFWD	  1827#	  2017#	  2139#	  3055#	  3063#	  3496#	  4124#	  4299#	  4389#	  4416#	  4425#	  4435#	  4437#	  4439#
Symbol cross reference

	  4442#	  4444#	  4906#	  4909#	  4911#	  4924#	  4930#	  4944#	  4945#	  4957#	  4959#	  4961#
$RB	  2650#	  2772#	  5281#
$SB	  2772#	  5281#
$SBATS	  3857#
$SBCBA	  3952#	  4006#	  4061#
$SBCHR	  4723#	  4756#
$SBLID	  4052#	  4185#	  4196#	  4832#
$SBMDS	  3859#	  4638#	  4640#
$SBOPC	  3925#
$SBRCR	  4015#	  4018#	  4068#	  4775#	  4858#
$SBREA	  3903#	  4557#	  4580#
$SBRID	  4001#	  4063#	  4834#
$SBSNC	  3868#
$SBSPC	  1200#	  3933#
$SBSTA	  4004#	  4060#	  4531#
$SBTDB	  3971#	  4154#	  4259#	  4625#	  4805#	  4818#
$SBTTO	  4721#	  4757#
$SBXCR	  4010#	  4066#	  4628#	  4732#	  4735#	  4797#	  4801#	  4803#
$SBXNF	  4266#	  5175#	  5179#
$UELW1	  2747#	  2748#	  2784#	  2787#	  2858#
$UNADS	  3584#	  3752#
$UNBFA	  2393#	  2421#	  2423#	  2425#	  2430#	  2437#	  2439#	  2443#	  2448#	  2468#	  2493#	  2528#	  2530#	  2535#
	  2601#	  2630#	  2798#	  2799#	  3004#	  3008#	  3012#	  3014#	  3016#	  3018#	  3292#	  3297#	  3405#	  3417#
	  3448#	  3457#	  3639#	  3640#	  3656#	  3669#	  3671#	  3675#	  3697#	  3699#	  3711#	  3715#	  3729#	  3748#
	  3786#	  3788#	  3790#	  3798#	  3850#	  3856#	  3858#	  3984#	  4491#	  4535#	  4537#	  4538#	  4541#	  4603#
	  4744#	  4759#	  4764#	  4823#	  5044#
$UNBSZ	  2527#	  2534#	  2634#	  2802#	  2993#	  3023#	  3419#	  3455#	  3638#	  3654#	  3659#	  3695#	  3710#	  3725#
	  3744#	  3792#	  3796#	  4418#	  4451#	  4471#	  4488#	  4494#	  4632#	  4774#
$UNCBA	  2243#	  2742#	  2788#
$UNCHN	  2236#
$UNDAD	  2219#	  2723#	  3299#	  3581#
$UNPAD	  2238#
$UNPID	  2248#	  2395#	  3301#	  3578#	  3580#	  3750#
$UNPRO	  2241#
$UNRID	  2226#	  2635#	  2693#	  2722#	  3582#	  3747#
$UNSAD	  2977#	  3059#	  3060#	  3194#	  3195#	  3259#	  3579#
$UNSID	  2743#
$UNSTA	  2875#
$UNUID	  3570#
$USRPT	  1546#
$W1	  2116#	  2351#	  2772#	  5281#
$W2	  2116#	  2351#	  2772#	  5281#
$XB	  2116#	  2351#	  2650#	  2772#	  5281#
%ACLNG	  2191	  2469
%CBAKQ	  3162
%CBCSB	  4337	  4370	  4374	  4383
%CBCTI	  3017
%CBDLL	  3361	  3494	  3503	  3511	  3574	  3596	  3621
%CBDNI	  2978	  3057	  3058	  3193	  3298	  3573
%CBERR	  3385
%CBKTI	  3019
%CBLID	  3082	  3089	  3120	  3215	  3536
%CBLRA	  3142	  3143
%CBMRN	  4324	  4357
Symbol cross reference

%CBMRS	  3164	  4354
%CBMSL	  3013	  4463
%CBMTF	  3003
%CBNBF	  3015
%CBNUM	  3025
%CBPTC	  3027
%CBRID	  3001	  3119	  3335	  3386	  3534
%CBRLC	  2305	  3039
%CBRPV	  3011
%CBRRF	  3530	  4320
%CBRSC	  1191	  1758	  2013	  2299	  3034
%CBRSQ	  3131	  3136	  3538
%CBRTC	  3151	  3476	  3500
%CBSBQ	  4160	  4314
%CBSDC	  4085	  4106	  4165	  4340	  4384
%CBSTA	  2908	  2923	  2958	  2975	  3126	  3216	  3337	  3340	  4311
%CBTIM	  3163	  3440	  3470	  3481	  3487
%CBTSQ	  3443	  3446	  3540
%CCIMR	  3227	  3235
%CCISR	  4890
%CCRCV	  2976	  3205
%CCRTR	  3499
%CCSEQ	  3140
%CCXMT	  3307	  3591
%GBLC	  1409	  2207	  2539	  2576
%GBNC	  1927	  1938	  1941	  2199	  2536	  2575
%GBRAT	  1393	  2197	  2532	  2572
%HCIMR	  3228	  3236
%HCISR	  4889
%HCRCV	  2797
%HCRTR	  3498
%HCSEQ	  3139
%HCXMT	  3306	  3589
%HNCFL	  2364	  2382	  2438
%HNCIP	  2731	  2895	  3288	  3309
%HNCON	  1723	  4069	  4174
%HNIDC	  1518	  1525	  2161	  2204	  2497	  2625
%HNLAS	  1145	  2169	  2445	  2899	  4317
%HNLOK	  2225	  2366
%HNMAC	  1136	  2184	  2903
%HNMCO	  1139	  2189	  2607
%HNMTI	  1154	  2167	  2354	  2442
%HNMXC	  2178	  2950
%HNNAC	  2902	  2949	  2972	  3347	  5101	  5126
%HNNCC	  1806	  2959
%HNNIQ	  2745	  2750	  2752
%HNNMC	  1475	  1489	  2154	  2494	  2617	  2621
%HNNRB	  5100	  5111	  5125	  5136
%HNNSV	  1413	  1436	  1445	  1656	  1705	  1932	  2195	  2529
%HNNUM	  1142	  2613
%HNNXI	  2187	  3088	  3102
%HNPID	  2249	  2394	  3300	  3572	  3749
%HNQAC	  1991
%HNQIC	  1997
Symbol cross reference

%HNRLI	  1148	  2163	  3475
%HNRUN	  2121	  2252
%HNSCQ	  2782	  2785	  2786	  2856	  2860	  2862
%HNTIM	  1460	  2165
%MDALA	  4984	  5026
%MDAUX	  4978	  5019
%MDBYT	  3454	  4455	  4980	  5021
%MDVMC	  4982	  5023
%QLBWD	  2140	  2964	  4171	  4438	  4440	  4441	  4443	  4445	  4908	  4910	  4923	  4927	  4942	  4946
	  4960
%QLFWD	  1827	  2017	  2139	  3055	  3063	  3496	  4124	  4299	  4389	  4416	  4425	  4435	  4437	  4439
	  4442	  4444	  4906	  4909	  4911	  4924	  4930	  4944	  4945	  4957	  4959	  4961
%RTXTI	  3438	  3439	  3480	  3481
%SBATS	  3857
%SBCBA	  3952	  4006	  4061
%SBCHR	  4723	  4756
%SBLID	  4052	  4185	  4196	  4832
%SBMDS	  3859	  4638	  4640
%SBOPC	  3925
%SBRCR	  4015	  4018	  4068	  4775	  4858
%SBREA	  3903	  4557	  4580
%SBRID	  4001	  4063	  4834
%SBSNC	  3868
%SBSPC	  1200	  3933
%SBSTA	  4004	  4060	  4531
%SBTDB	  3971	  4154	  4259	  4625	  4805	  4818
%SBTTO	  4721	  4757
%SBXCR	  4010	  4066	  4628	  4732	  4735	  4797	  4801	  4803
%SBXNF	  4266	  5175	  5179
%UELW1	  2747	  2748	  2784	  2787	  2858
%UNADS	  3584	  3752
%UNBFA	  2393	  2421	  2423	  2425	  2430	  2437	  2439	  2443	  2448	  2468	  2493	  2528	  2530	  2535
	  2601	  2630	  2798	  2799	  3004	  3008	  3012	  3014	  3016	  3018	  3292	  3297	  3405	  3417
	  3448	  3457	  3639	  3640	  3656	  3669	  3671	  3675	  3697	  3699	  3711	  3715	  3729	  3748
	  3786	  3788	  3790	  3798	  3850	  3856	  3858	  3984	  4491	  4535	  4537	  4538	  4541	  4603
	  4744	  4759	  4764	  4823	  5044
%UNBSZ	  2527	  2534	  2634	  2802	  2993	  3023	  3419	  3455	  3638	  3654	  3659	  3695	  3710	  3725
	  3744	  3792	  3796	  4418	  4451	  4471	  4488	  4494	  4632	  4774
%UNCBA	  2243	  2742	  2788
%UNCHN	  2236
%UNDAD	  2219	  2723	  3299	  3581
%UNPAD	  2238
%UNPID	  2248	  2395	  3301	  3578	  3580	  3750
%UNPRO	  2241
%UNRID	  2226	  2635	  2693	  2722	  3582	  3747
%UNSAD	  2977	  3059	  3060	  3194	  3195	  3259	  3579
%UNSID	  2743
%UNSTA	  2875
%UNUID	  3570
.%1044	  1681	  1683	  2392	  3296	  3416	  3746	  5043
.%744	  1923	  1937	  1940	  2012	  2300	  2306
....	  5481#	  5481
..0005	  1341	  1347#	  5481
..0013	  1351	  1358#	  5481
Symbol cross reference

..0021	  1385	  1394#	  5481
..0027	  1396	  1410#	  5481
..0035	  1412	  1417#	  5481
..0044	  1559#	  1563	  5481
..0045	  1564#	  5481
..0053	  1567#	  1576	  5481
..0054	  1577#	  5481
..0061	  1570	  1573#	  5481
..0062	  1572	  1574#	  5481
..0070	  1684#	  1688	  5481
..0071	  1690#	  5481
..0076	  1787	  1805#	  5481
..0104	  1876	  1889#	  5481
..0105	  1888	  1891#	  5481
..0113	  1935#	  1956	  5481
..0114	  1957#	  5481
..0121	  1943	  1954#	  5481
..0127	  1946	  1951#	  5481
..0135	  1993	  1996#	  5481
..0143	  1999	  2002#	  5481
..0152	  2010#	  2019	  5481
..0153	  2020#	  5481
..0161	  2040#	  2048	  5481
..0162	  2049#	  5481
..0167	  2171	  2176#	  5481
..0175	  2247	  2257#	  5481
..0203	  2251	  2256#	  5481
..0211	  2433	  2436#	  5481
..0217	  2730	  2734#	  5481
..0225	  2746	  2750#	  5481
..0226	  2749	  2751#	  5481
..0233	  2790	  2793#	  5481
..0241	  2814	  2823#	  5481
..0242	  2822	  2826#	  5481
..0247	  2857	  2860#	  5481
..0250	  2859	  2861#	  5481
..0255	  2876	  2882#	  5481
..0256	  2881	  2883#	  5481
..0263	  2910	  2914#	  5481
..0271	  2952	  2963#	  5481
..0277	  3062	  3065#	  5481
..0305	  3084	  3087#	  5481
..0313	  3096	  3099#	  5481
..0321	  3135	  3138#	  5481
..0322	  3137	  3141#	  5481
..0327	  3150	  3152#	  5481
..0335	  3186	  3189#	  5481
..0343	  3305	  3309#	  5481
..0344	  3308	  3311#	  5481
..0351	  3474	  3486#	  5481
..0357	  3478	  3483#	  5481
..0360	  3482	  3484#	  5481
..0365	  3510	  3514#	  5481
..0373	  3661	  3664#	  5481
Symbol cross reference

..0401	  4020	  4023#	  5481
..0407	  4084	  4089#	  5481
..0415	  4105	  4110#	  5481
..0423	  4164	  4168#	  5481
..0431	  4372	  4376#	  5481
..0437	  4434	  4447#	  5481
..0445	  4436	  4446#	  5481
..0453	  4490	  4493#	  5481
..0461	  4630	  4642#	  5481
..0462	  4641	  4643#	  5481
..ACT	  2121#	  2121	  2236#	  2236	  2238#	  2238	  2252#	  2252	  2382#	  2382	  2731#	  2731	  2895#	  2895
	  3164#	  3164	  3288#	  3288	  3309#	  3309	  4320#	  4320	  4324#	  4324	  4354#	  4354	  4357#	  4357
	  4721#	  4721	  4757#	  4757
..ARGN	  2261#	  2261	  2262	  2659#	  2659	  2660	  2821#	  2821	  2822	  3271#	  3271	  3272	  5428#	  5428
	  5429
..CSC	  1136#	  1136	  1137	  1137#	  1139#	  1139	  1140	  1140#	  1142#	  1142	  1143	  1143#	  1145#	  1145
	  1146	  1146#	  1148#	  1148	  1149	  1149#	  1154#	  1154	  1155	  1155#	  1191#	  1191	  1192	  1192#
	  1200#	  1200	  1201	  1201#	  1393#	  1393	  1394	  1394#	  1409#	  1409	  1410	  1410#	  1413#	  1413
	  1414	  1414#	  1415#	  1415	  1416	  1416#	  1436#	  1436	  1437	  1437#	  1445#	  1445	  1446	  1446#
	  1447#	  1447	  1448	  1448#	  1460#	  1460	  1461	  1461#	  1475#	  1475	  1476	  1476#	  1489#	  1489
	  1490	  1490#	  1518#	  1518	  1519	  1519#	  1525#	  1525	  1526	  1526#	  1656#	  1656	  1657	  1657#
	  1705#	  1705	  1706	  1706#	  1723#	  1723	  1724	  1724#	  1758#	  1758	  1759	  1759#	  1806#	  1806
	  1807	  1807#	  1827#	  1827	  1828	  1828#	  1927#	  1927	  1928	  1928#	  1932#	  1932	  1933	  1933#
	  1938#	  1938	  1939	  1939#	  1941#	  1941	  1942	  1942#	  1991#	  1991	  1992	  1992#	  1997#	  1997
	  1998	  1998#	  2013#	  2013	  2014	  2014#	  2121#	  2121	  2123	  2123#	  2139#	  2139	  2140	  2140#
	  2141	  2141#	  2154#	  2154	  2155	  2155#	  2161#	  2161	  2162	  2162#	  2163#	  2163	  2164	  2164#
	  2165#	  2165	  2166	  2166#	  2167#	  2167	  2168	  2168#	  2169#	  2169	  2170	  2170#	  2178#	  2178
	  2179	  2179#	  2184#	  2184	  2185	  2185#	  2187#	  2187	  2188	  2188#	  2189#	  2189	  2190	  2190#
	  2191#	  2191	  2192	  2192#	  2195#	  2195	  2196	  2196#	  2197#	  2197	  2198	  2198#	  2199#	  2199
	  2200	  2200#	  2204#	  2204	  2205	  2205#	  2207#	  2207	  2208	  2208#	  2225#	  2225	  2226	  2226#
	  2227	  2227#	  2236#	  2236	  2238	  2238#	  2240	  2240#	  2241#	  2241	  2242	  2242#	  2243#	  2243
	  2244	  2244#	  2248#	  2248	  2249	  2249#	  2250	  2250#	  2252#	  2252	  2254	  2254#	  2299#	  2299
	  2300	  2300#	  2305#	  2305	  2306	  2306#	  2354#	  2354	  2355	  2355#	  2364#	  2364	  2365	  2365#
	  2382#	  2382	  2384	  2384#	  2393#	  2393	  2394	  2394#	  2395	  2395#	  2396	  2396#	  2421#	  2421
	  2422	  2422#	  2438#	  2438	  2439	  2439#	  2442#	  2442	  2443	  2443#	  2445#	  2445	  2446	  2446#
	  2468#	  2468	  2469	  2469#	  2470	  2470#	  2493#	  2493	  2494	  2494#	  2495	  2495#	  2497#	  2497
	  2498	  2498#	  2527#	  2527	  2528	  2528#	  2529	  2529#	  2530	  2530#	  2536#	  2536	  2537	  2537#
	  2539#	  2539	  2540	  2540#	  2575#	  2575	  2576	  2576#	  2577	  2577#	  2601#	  2601	  2602	  2602#
	  2607#	  2607	  2608	  2608#	  2613#	  2613	  2614	  2614#	  2617#	  2617	  2618	  2618#	  2621#	  2621
	  2622	  2622#	  2625#	  2625	  2626	  2626#	  2634#	  2634	  2635	  2635#	  2636	  2636#	  2693#	  2693
	  2694	  2694#	  2722#	  2722	  2723	  2723#	  2724	  2724#	  2731#	  2731	  2733	  2733#	  2742#	  2742
	  2743	  2743#	  2744	  2744#	  2747#	  2747	  2748	  2748#	  2749	  2749#	  2750#	  2750	  2751	  2751#
	  2752#	  2752	  2753	  2753#	  2785#	  2785	  2786	  2786#	  2787	  2787#	  2788	  2788#	  2789	  2789#
	  2858#	  2858	  2859	  2859#	  2860#	  2860	  2861	  2861#	  2862#	  2862	  2863	  2863#	  2899#	  2899
	  2900	  2900#	  2902#	  2902	  2903	  2903#	  2904	  2904#	  2908#	  2908	  2909	  2909#	  2923#	  2923
	  2924	  2924#	  2949#	  2949	  2950	  2950#	  2951	  2951#	  2958#	  2958	  2959	  2959#	  2960	  2960#
	  2961#	  2961	  2962	  2962#	  2972#	  2972	  2973	  2973#	  2974#	  2974	  2975	  2975#	  2976	  2976#
	  3001#	  3001	  3002	  3002#	  3003#	  3003	  3004	  3004#	  3011#	  3011	  3012	  3012#	  3013#	  3013
	  3014	  3014#	  3015#	  3015	  3016	  3016#	  3017#	  3017	  3018	  3018#	  3019#	  3019	  3020	  3020#
	  3025#	  3025	  3026	  3026#	  3027#	  3027	  3028	  3028#	  3034#	  3034	  3035	  3035#	  3039#	  3039
	  3040	  3040#	  3055#	  3055	  3056	  3056#	  3057#	  3057	  3058	  3058#	  3059	  3059#	  3063#	  3063
	  3064	  3064#	  3082#	  3082	  3083	  3083#	  3088#	  3088	  3089	  3089#	  3090	  3090#	  3102#	  3102
	  3103	  3103#	  3119#	  3119	  3120	  3120#	  3121	  3121#	  3126#	  3126	  3127	  3127#	  3131#	  3131
	  3132	  3132#	  3136#	  3136	  3137	  3137#	  3142#	  3142	  3143	  3143#	  3144	  3144#	  3151#	  3151
Symbol cross reference

	  3152	  3152#	  3163#	  3163	  3164	  3164#	  3166	  3166#	  3215#	  3215	  3216	  3216#	  3217	  3217#	  3288#
	  3288	  3290	  3290#	  3292#	  3292	  3293	  3293#	  3297#	  3297	  3298	  3298#	  3300#	  3300	  3301
	  3301#	  3302	  3302#	  3309#	  3309	  3311	  3311#	  3335#	  3335	  3336	  3336#	  3337#	  3337	  3338
	  3338#	  3340#	  3340	  3341	  3341#	  3347#	  3347	  3348	  3348#	  3349#	  3349	  3350	  3350#	  3361#
	  3361	  3362	  3362#	  3385#	  3385	  3386	  3386#	  3387	  3387#	  3405#	  3405	  3406	  3406#	  3417#
	  3417	  3418	  3418#	  3419#	  3419	  3420	  3420#	  3438#	  3438	  3439	  3439#	  3440#	  3440	  3441
	  3441#	  3443#	  3443	  3444	  3444#	  3446#	  3446	  3447	  3447#	  3448#	  3448	  3449	  3449#	  3454#
	  3454	  3455	  3455#	  3456	  3456#	  3457#	  3457	  3458	  3458#	  3470#	  3470	  3471	  3471#	  3475#
	  3475	  3476	  3476#	  3477	  3477#	  3480#	  3480	  3481	  3481#	  3482	  3482#	  3487#	  3487	  3488
	  3488#	  3494#	  3494	  3495	  3495#	  3500#	  3500	  3501	  3501#	  3502#	  3502	  3503	  3503#	  3504
	  3504#	  3505#	  3505	  3506	  3506#	  3511#	  3511	  3512	  3512#	  3513#	  3513	  3514	  3514#	  3530#
	  3530	  3531	  3531#	  3534#	  3534	  3535	  3535#	  3536#	  3536	  3537	  3537#	  3538#	  3538	  3539
	  3539#	  3540#	  3540	  3541	  3541#	  3570#	  3570	  3571	  3571#	  3572#	  3572	  3573	  3573#	  3574#
	  3574	  3575	  3575#	  3576#	  3576	  3577	  3577#	  3578#	  3578	  3579	  3579#	  3580#	  3580	  3581
	  3581#	  3582#	  3582	  3583	  3583#	  3584#	  3584	  3585	  3585#	  3596#	  3596	  3597	  3597#	  3598#
	  3598	  3599	  3599#	  3621#	  3621	  3622	  3622#	  3623#	  3623	  3624	  3624#	  3659#	  3659	  3660
	  3660#	  3669#	  3669	  3670	  3670#	  3675#	  3675	  3676	  3676#	  3744#	  3744	  3745	  3745#	  3747#
	  3747	  3748	  3748#	  3749	  3749#	  3750	  3750#	  3751	  3751#	  3752#	  3752	  3753	  3753#	  3792#
	  3792	  3793	  3793#	  3796#	  3796	  3797	  3797#	  3857#	  3857	  3858	  3858#	  3859#	  3859	  3860
	  3860#	  3868#	  3868	  3869	  3869#	  3903#	  3903	  3904	  3904#	  3925#	  3925	  3926	  3926#	  3933#
	  3933	  3934	  3934#	  3971#	  3971	  3972	  3972#	  4001#	  4001	  4002	  4002#	  4004#	  4004	  4005
	  4005#	  4010#	  4010	  4011	  4011#	  4012#	  4012	  4013	  4013#	  4015#	  4015	  4016	  4016#	  4018#
	  4018	  4019	  4019#	  4052#	  4052	  4053	  4053#	  4060#	  4060	  4061	  4061#	  4062	  4062#	  4063#
	  4063	  4064	  4064#	  4066#	  4066	  4067	  4067#	  4068#	  4068	  4069	  4069#	  4070	  4070#	  4071#
	  4071	  4072	  4072#	  4085#	  4085	  4086	  4086#	  4087#	  4087	  4088	  4088#	  4106#	  4106	  4107
	  4107#	  4108#	  4108	  4109	  4109#	  4165#	  4165	  4166	  4166#	  4167#	  4167	  4168	  4168#	  4174#
	  4174	  4175	  4175#	  4176#	  4176	  4177	  4177#	  4185#	  4185	  4186	  4186#	  4196#	  4196	  4197
	  4197#	  4259#	  4259	  4260	  4260#	  4266#	  4266	  4267	  4267#	  4299#	  4299	  4300	  4300#	  4311#
	  4311	  4312	  4312#	  4317#	  4317	  4318	  4318#	  4320#	  4320	  4322	  4322#	  4337#	  4337	  4338
	  4338#	  4340#	  4340	  4341	  4341#	  4357#	  4357	  4359	  4359#	  4370#	  4370	  4371	  4371#	  4374#
	  4374	  4375	  4375#	  4383#	  4383	  4384	  4384#	  4385	  4385#	  4389#	  4389	  4390	  4390#	  4418#
	  4418	  4419	  4419#	  4437#	  4437	  4438	  4438#	  4439	  4439#	  4440	  4440#	  4441	  4441#	  4442
	  4442#	  4443	  4443#	  4444	  4444#	  4445	  4445#	  4446	  4446#	  4451#	  4451	  4452	  4452#	  4455#
	  4455	  4456	  4456#	  4463#	  4463	  4464	  4464#	  4471#	  4471	  4472	  4472#	  4494#	  4494	  4495
	  4495#	  4531#	  4531	  4532	  4532#	  4557#	  4557	  4558	  4558#	  4580#	  4580	  4581	  4581#	  4625#
	  4625	  4626	  4626#	  4628#	  4628	  4629	  4629#	  4638#	  4638	  4639	  4639#	  4640#	  4640	  4641
	  4641#	  4721#	  4721	  4723	  4723#	  4724	  4724#	  4732#	  4732	  4733	  4733#	  4735#	  4735	  4736
	  4736#	  4756#	  4756	  4757	  4757#	  4759	  4759#	  4775#	  4775	  4776	  4776#	  4777#	  4777	  4778
	  4778#	  4797#	  4797	  4798	  4798#	  4801#	  4801	  4802	  4802#	  4803#	  4803	  4804	  4804#	  4805#
	  4805	  4806	  4806#	  4818#	  4818	  4819	  4819#	  4832#	  4832	  4833	  4833#	  4834#	  4834	  4835
	  4835#	  4858#	  4858	  4859	  4859#	  4908#	  4908	  4909	  4909#	  4910	  4910#	  4911	  4911#	  4912
	  4912#	  4923#	  4923	  4924	  4924#	  4925	  4925#	  4927#	  4927	  4928	  4928#	  4930#	  4930	  4931
	  4931#	  4944#	  4944	  4945	  4945#	  4946	  4946#	  4947	  4947#	  4960#	  4960	  4961	  4961#	  4962
	  4962#	  4978#	  4978	  4979	  4979#	  4980#	  4980	  4981	  4981#	  4982#	  4982	  4983	  4983#	  4984#
	  4984	  4985	  4985#	  5019#	  5019	  5020	  5020#	  5021#	  5021	  5022	  5022#	  5023#	  5023	  5024
	  5024#	  5026#	  5026	  5027	  5027#	  5044#	  5044	  5045	  5045#	  5100#	  5100	  5101	  5101#	  5102
	  5102#	  5111#	  5111	  5112	  5112#	  5113#	  5113	  5114	  5114#	  5125#	  5125	  5126	  5126#	  5127
	  5127#	  5136#	  5136	  5137	  5137#	  5138#	  5138	  5139	  5139#	  5175#	  5175	  5176	  5176#	  5179#
	  5179	  5180	  5180#
..CSN	  1136#	  1136	  1139#	  1139	  1142#	  1142	  1145#	  1145	  1148#	  1148	  1154#	  1154	  1191#	  1191
	  1200#	  1200	  1393#	  1393	  1409#	  1409	  1413#	  1413	  1415#	  1415	  1436#	  1436	  1445#	  1445
	  1447#	  1447	  1460#	  1460	  1475#	  1475	  1489#	  1489	  1518#	  1518	  1525#	  1525	  1656#	  1656
	  1705#	  1705	  1723#	  1723	  1758#	  1758	  1806#	  1806	  1827#	  1827	  1927#	  1927	  1932#	  1932
	  1938#	  1938	  1941#	  1941	  1991#	  1991	  1997#	  1997	  2013#	  2013	  2121#	  2121	  2139#	  2139
Symbol cross reference

	  2140#	  2140	  2154#	  2154	  2161#	  2161	  2163#	  2163	  2165#	  2165	  2167#	  2167	  2169#	  2169	  2178#
	  2178	  2184#	  2184	  2187#	  2187	  2189#	  2189	  2191#	  2191	  2195#	  2195	  2197#	  2197	  2199#
	  2199	  2204#	  2204	  2207#	  2207	  2225#	  2225	  2226#	  2226	  2236#	  2236	  2238#	  2238	  2241#
	  2241	  2243#	  2243	  2248#	  2248	  2249#	  2249	  2252#	  2252	  2299#	  2299	  2305#	  2305	  2354#
	  2354	  2364#	  2364	  2382#	  2382	  2393#	  2393	  2394#	  2394	  2395#	  2395	  2421#	  2421	  2438#
	  2438	  2442#	  2442	  2445#	  2445	  2468#	  2468	  2469#	  2469	  2493#	  2493	  2494#	  2494	  2497#
	  2497	  2527#	  2527	  2528#	  2528	  2529#	  2529	  2536#	  2536	  2539#	  2539	  2575#	  2575	  2576#
	  2576	  2601#	  2601	  2607#	  2607	  2613#	  2613	  2617#	  2617	  2621#	  2621	  2625#	  2625	  2634#
	  2634	  2635#	  2635	  2693#	  2693	  2722#	  2722	  2723#	  2723	  2731#	  2731	  2742#	  2742	  2743#
	  2743	  2747#	  2747	  2748#	  2748	  2750#	  2750	  2752#	  2752	  2785#	  2785	  2786#	  2786	  2787#
	  2787	  2788#	  2788	  2858#	  2858	  2860#	  2860	  2862#	  2862	  2899#	  2899	  2902#	  2902	  2903#
	  2903	  2908#	  2908	  2923#	  2923	  2949#	  2949	  2950#	  2950	  2958#	  2958	  2959#	  2959	  2961#
	  2961	  2972#	  2972	  2974#	  2974	  2975#	  2975	  3001#	  3001	  3003#	  3003	  3011#	  3011	  3013#
	  3013	  3015#	  3015	  3017#	  3017	  3019#	  3019	  3025#	  3025	  3027#	  3027	  3034#	  3034	  3039#
	  3039	  3055#	  3055	  3057#	  3057	  3058#	  3058	  3063#	  3063	  3082#	  3082	  3088#	  3088	  3089#
	  3089	  3102#	  3102	  3119#	  3119	  3120#	  3120	  3126#	  3126	  3131#	  3131	  3136#	  3136	  3142#
	  3142	  3143#	  3143	  3151#	  3151	  3163#	  3163	  3164#	  3164	  3215#	  3215	  3216#	  3216	  3288#
	  3288	  3292#	  3292	  3297#	  3297	  3300#	  3300	  3301#	  3301	  3309#	  3309	  3335#	  3335	  3337#
	  3337	  3340#	  3340	  3347#	  3347	  3349#	  3349	  3361#	  3361	  3385#	  3385	  3386#	  3386	  3405#
	  3405	  3417#	  3417	  3419#	  3419	  3438#	  3438	  3440#	  3440	  3443#	  3443	  3446#	  3446	  3448#
	  3448	  3454#	  3454	  3455#	  3455	  3457#	  3457	  3470#	  3470	  3475#	  3475	  3476#	  3476	  3480#
	  3480	  3481#	  3481	  3487#	  3487	  3494#	  3494	  3500#	  3500	  3502#	  3502	  3503#	  3503	  3505#
	  3505	  3511#	  3511	  3513#	  3513	  3530#	  3530	  3534#	  3534	  3536#	  3536	  3538#	  3538	  3540#
	  3540	  3570#	  3570	  3572#	  3572	  3574#	  3574	  3576#	  3576	  3578#	  3578	  3580#	  3580	  3582#
	  3582	  3584#	  3584	  3596#	  3596	  3598#	  3598	  3621#	  3621	  3623#	  3623	  3659#	  3659	  3669#
	  3669	  3675#	  3675	  3744#	  3744	  3747#	  3747	  3748#	  3748	  3749#	  3749	  3750#	  3750	  3752#
	  3752	  3792#	  3792	  3796#	  3796	  3857#	  3857	  3859#	  3859	  3868#	  3868	  3903#	  3903	  3925#
	  3925	  3933#	  3933	  3971#	  3971	  4001#	  4001	  4004#	  4004	  4010#	  4010	  4012#	  4012	  4015#
	  4015	  4018#	  4018	  4052#	  4052	  4060#	  4060	  4061#	  4061	  4063#	  4063	  4066#	  4066	  4068#
	  4068	  4069#	  4069	  4071#	  4071	  4085#	  4085	  4087#	  4087	  4106#	  4106	  4108#	  4108	  4165#
	  4165	  4167#	  4167	  4174#	  4174	  4176#	  4176	  4185#	  4185	  4196#	  4196	  4259#	  4259	  4266#
	  4266	  4299#	  4299	  4311#	  4311	  4317#	  4317	  4320#	  4320	  4337#	  4337	  4340#	  4340	  4357#
	  4357	  4370#	  4370	  4374#	  4374	  4383#	  4383	  4384#	  4384	  4389#	  4389	  4418#	  4418	  4437#
	  4437	  4438#	  4438	  4439#	  4439	  4440#	  4440	  4441#	  4441	  4442#	  4442	  4443#	  4443	  4444#
	  4444	  4445#	  4445	  4451#	  4451	  4455#	  4455	  4463#	  4463	  4471#	  4471	  4494#	  4494	  4531#
	  4531	  4557#	  4557	  4580#	  4580	  4625#	  4625	  4628#	  4628	  4638#	  4638	  4640#	  4640	  4721#
	  4721	  4723#	  4723	  4732#	  4732	  4735#	  4735	  4756#	  4756	  4757#	  4757	  4775#	  4775	  4777#
	  4777	  4797#	  4797	  4801#	  4801	  4803#	  4803	  4805#	  4805	  4818#	  4818	  4832#	  4832	  4834#
	  4834	  4858#	  4858	  4908#	  4908	  4909#	  4909	  4910#	  4910	  4911#	  4911	  4923#	  4923	  4924#
	  4924	  4927#	  4927	  4930#	  4930	  4944#	  4944	  4945#	  4945	  4946#	  4946	  4960#	  4960	  4961#
	  4961	  4978#	  4978	  4980#	  4980	  4982#	  4982	  4984#	  4984	  5019#	  5019	  5021#	  5021	  5023#
	  5023	  5026#	  5026	  5044#	  5044	  5100#	  5100	  5101#	  5101	  5111#	  5111	  5113#	  5113	  5125#
	  5125	  5126#	  5126	  5136#	  5136	  5138#	  5138	  5175#	  5175	  5179#	  5179
..DONE	  1376#	  1376	  1377	  1545#	  1545	  1546	  1904#	  1904	  1905	  1984#	  1984	  1985	  2008#	  2008
	  2009	  2033#	  2033	  2034	  2116#	  2116	  2117	  2351#	  2351	  2352	  2518#	  2518	  2519	  2564#
	  2564	  2565	  2598#	  2598	  2599	  2650#	  2650	  2651	  2772#	  2772	  2773	  3616#	  3616	  3617
	  3653#	  3653	  3654	  4246#	  4246	  4247	  4623#	  4623	  4624	  5281#	  5281	  5282
..IFT	  1413#	  1413	  1445#	  1445	  1475#	  1475	  1932#	  1932	  2017#	  2017	  2018#	  2018	  2121#	  2121
	  2123#	  2123	  2219#	  2219	  2220#	  2220	  2236#	  2236	  2238#	  2238	  2240#	  2240	  2252#	  2252
	  2254#	  2254	  2364#	  2364	  2366#	  2366	  2367#	  2367	  2382#	  2382	  2384#	  2384	  2423#	  2423
	  2424#	  2424	  2425#	  2425	  2426#	  2426	  2430#	  2430	  2431#	  2431	  2437#	  2437	  2438#	  2438
	  2439#	  2439	  2440#	  2440	  2443#	  2443	  2444#	  2444	  2448#	  2448	  2449#	  2449	  2530#	  2530
	  2531#	  2531	  2532#	  2532	  2533#	  2533	  2534#	  2534	  2535#	  2535	  2536#	  2536	  2572#	  2572
	  2573#	  2573	  2576#	  2576	  2630#	  2630	  2631#	  2631	  2731#	  2731	  2733#	  2733	  2745#	  2745
Symbol cross reference

	  2746#	  2746	  2782#	  2782	  2783#	  2783	  2784#	  2784	  2785#	  2785	  2797#	  2797	  2798#	  2798	  2799#
	  2799	  2800#	  2800	  2802#	  2802	  2803#	  2803	  2856#	  2856	  2857#	  2857	  2875#	  2875	  2876#
	  2876	  2895#	  2895	  2897#	  2897	  2903#	  2903	  2950#	  2950	  2959#	  2959	  2964#	  2964	  2965#
	  2965	  2972#	  2972	  2976#	  2976	  2977#	  2977	  2978#	  2978	  2979#	  2979	  2993#	  2993	  2994#
	  2994	  3004#	  3004	  3005#	  3005	  3008#	  3008	  3009#	  3009	  3012#	  3012	  3013#	  3013	  3014#
	  3014	  3015#	  3015	  3016#	  3016	  3017#	  3017	  3018#	  3018	  3019#	  3019	  3023#	  3023	  3024#
	  3024	  3059#	  3059	  3060#	  3060	  3061#	  3061	  3082#	  3082	  3139#	  3139	  3140#	  3140	  3141#
	  3141	  3162#	  3162	  3163#	  3163	  3164#	  3164	  3166#	  3166	  3193#	  3193	  3194#	  3194	  3195#
	  3195	  3196#	  3196	  3205#	  3205	  3206#	  3206	  3227#	  3227	  3228#	  3228	  3229#	  3229	  3235#
	  3235	  3236#	  3236	  3237#	  3237	  3259#	  3259	  3260#	  3260	  3288#	  3288	  3290#	  3290	  3298#
	  3298	  3299#	  3299	  3300#	  3300	  3306#	  3306	  3307#	  3307	  3308#	  3308	  3309#	  3309	  3311#
	  3311	  3337#	  3337	  3347#	  3347	  3470#	  3470	  3476#	  3476	  3494#	  3494	  3496#	  3496	  3497#
	  3497	  3498#	  3498	  3499#	  3499	  3500#	  3500	  3503#	  3503	  3511#	  3511	  3530#	  3530	  3573#
	  3573	  3574#	  3574	  3579#	  3579	  3580#	  3580	  3581#	  3581	  3582#	  3582	  3589#	  3589	  3590#
	  3590	  3591#	  3591	  3592#	  3592	  3596#	  3596	  3621#	  3621	  3638#	  3638	  3639#	  3639	  3640#
	  3640	  3641#	  3641	  3654#	  3654	  3655#	  3655	  3656#	  3656	  3657#	  3657	  3671#	  3671	  3672#
	  3672	  3695#	  3695	  3696#	  3696	  3697#	  3697	  3698#	  3698	  3699#	  3699	  3700#	  3700	  3710#
	  3710	  3711#	  3711	  3712#	  3712	  3715#	  3715	  3716#	  3716	  3725#	  3725	  3726#	  3726	  3729#
	  3729	  3730#	  3730	  3786#	  3786	  3787#	  3787	  3788#	  3788	  3789#	  3789	  3790#	  3790	  3791#
	  3791	  3798#	  3798	  3799#	  3799	  3850#	  3850	  3851#	  3851	  3856#	  3856	  3857#	  3857	  3858#
	  3858	  3859#	  3859	  3952#	  3952	  3953#	  3953	  3984#	  3984	  3985#	  3985	  4001#	  4001	  4006#
	  4006	  4007#	  4007	  4010#	  4010	  4015#	  4015	  4069#	  4069	  4085#	  4085	  4106#	  4106	  4124#
	  4124	  4125#	  4125	  4154#	  4154	  4155#	  4155	  4160#	  4160	  4161#	  4161	  4165#	  4165	  4171#
	  4171	  4172#	  4172	  4174#	  4174	  4185#	  4185	  4314#	  4314	  4315#	  4315	  4320#	  4320	  4322#
	  4322	  4324#	  4324	  4326#	  4326	  4340#	  4340	  4354#	  4354	  4356#	  4356	  4357#	  4357	  4359#
	  4359	  4384#	  4384	  4416#	  4416	  4417#	  4417	  4425#	  4425	  4426#	  4426	  4435#	  4435	  4436#
	  4436	  4488#	  4488	  4489#	  4489	  4491#	  4491	  4492#	  4492	  4535#	  4535	  4536#	  4536	  4537#
	  4537	  4538#	  4538	  4539#	  4539	  4541#	  4541	  4542#	  4542	  4603#	  4603	  4604#	  4604	  4628#
	  4628	  4632#	  4632	  4633#	  4633	  4638#	  4638	  4721#	  4721	  4723#	  4723	  4744#	  4744	  4745#
	  4745	  4757#	  4757	  4759#	  4759	  4760#	  4760	  4764#	  4764	  4765#	  4765	  4774#	  4774	  4775#
	  4775	  4797#	  4797	  4823#	  4823	  4824#	  4824	  4834#	  4834	  4858#	  4858	  4889#	  4889	  4890#
	  4890	  4891#	  4891	  4906#	  4906	  4907#	  4907	  4942#	  4942	  4943#	  4943	  4957#	  4957	  4958#
	  4958	  4959#	  4959	  4960#	  4960	  5111#	  5111	  5136#	  5136
..JX1	  2895#	  2895	  4324#	  4324	  4354#	  4354
..LOC	   772#	   775	   819#	   825	   827#	   873	   875#	   878	   882#	   891	   895#	   932	   933#	   942
	   962#	   994	   998#	  1001
..MASK	  1376#	  1376	  1377	  1545#	  1545	  1546	  1904#	  1904	  1905	  1984#	  1984	  1985	  2008#	  2008
	  2009	  2033#	  2033	  2034	  2116#	  2116	  2117	  2351#	  2351	  2352	  2518#	  2518	  2519	  2564#
	  2564	  2565	  2598#	  2598	  2599	  2650#	  2650	  2651	  2772#	  2772	  2773	  3616#	  3616	  3617
	  3653#	  3653	  3654	  4246#	  4246	  4247	  4623#	  4623	  4624	  5281#	  5281	  5282
..MSK	   772#	   773	   773#	   774#	   774	   775#	   775	   819#	   820	   820#	   821#	   821	   822	   822#
	   823	   823#	   824#	   824	   825#	   825	   827#	   828	   828#	   832	   833	   833#	   843	   843#
	   844	   844#	   845	   845#	   846	   846#	   847	   847#	   848	   848#	   849	   849#	   850	   850#
	   851	   851#	   852	   852#	   853	   853#	   855	   855#	   856	   856#	   857	   857#	   858#	   858
	   859#	   859	   860#	   860	   861#	   861	   862#	   862	   863#	   863	   864	   864#	   865	   865#
	   866#	   866	   867	   867#	   868	   868#	   869#	   869	   870#	   870	   871#	   871	   872#	   872
	   873#	   873	   875#	   876	   876#	   877#	   877	   878#	   878	   882#	   883	   883#	   884#	   884
	   885#	   885	   886#	   886	   887#	   887	   888#	   888	   889#	   889	   890#	   890	   891#	   891
	   895#	   896	   896#	   897#	   897	   898	   898#	   899	   899#	   903	   903#	   904	   904#	   905
	   905#	   906	   906#	   907	   907#	   908	   908#	   909	   909#	   910	   910#	   911	   911#	   912
	   912#	   913	   913#	   914#	   914	   915#	   915	   916#	   916	   917#	   917	   918	   918#	   919
	   919#	   920	   920#	   921	   921#	   922	   922#	   923	   923#	   924	   924#	   925	   925#	   926
	   926#	   927	   927#	   928	   928#	   929#	   929	   930#	   930	   931#	   932	   933#	   934	   934#
	   935#	   935	   936#	   936	   937#	   937	   938#	   938	   939#	   939	   940#	   940	   941#	   941
Symbol cross reference

	   942#	   942	   962#	   963	   963#	   964#	   964	   972	   972#	   973	   973#	   974	   974#	   975	   975#
	   976	   976#	   977	   977#	   978	   978#	   979	   979#	   980	   980#	   981	   981#	   982	   982#
	   983	   983#	   984#	   984	   985#	   985	   986#	   986	   987#	   987	   988#	   989	   989#	   992
	   992#	   994	   998#	   999	   999#	  1000#	  1000	  1001#	  1001
..MX1	  1342#	  1342	  1349#	  1349	  1405#	  1485#	  1514#	  1556#	  1985#	  1989#	  2121#	  2121	  2156#	  2157#
	  2157	  2236#	  2236	  2238#	  2238	  2244#	  2244	  2252#	  2252	  2382#	  2382	  2384#	  2384	  2396#
	  2396	  2420#	  2420	  2467#	  2467	  2470#	  2470	  2492#	  2492	  2495#	  2495	  2498#	  2498	  2520#
	  2520	  2537#	  2537	  2540#	  2540	  2565#	  2565	  2600#	  2600	  2619#	  2619	  2623#	  2623	  2627#
	  2627	  2726#	  2726	  2731#	  2731	  2801#	  2801	  2874#	  2874	  3022#	  3022	  3031#	  3031	  3036#
	  3036	  3164#	  3164	  3288#	  3288	  3291#	  3291	  3302#	  3302	  3309#	  3309	  3404#	  3404	  3436#
	  3436	  3447#	  3447	  3506#	  3506	  3585#	  3585	  3637#	  3637	  3754#	  3754	  3865#	  3865	  3897#
	  3897	  3904#	  3904	  4021#	  4021	  4320#	  4320	  4335#	  4335	  4357#	  4357	  4542#	  4542	  4561#
	  4561	  4584#	  4584	  4604#	  4604	  4721#	  4721	  4757#	  4757	  4783#	  4783	  4827#	  4827	  4977#
	  4977	  5018#	  5018	  5258#	  5258	  5280#	  5280
..MX2	  1342#	  1342	  1343	  1349#	  1349	  1350	  2121#	  2121	  2122	  2157#	  2157	  2236#	  2236	  2237
	  2238#	  2238	  2239	  2244#	  2245	  2252#	  2252	  2253	  2382#	  2383	  2384#	  2384	  2396#	  2397
	  2420#	  2420	  2467#	  2467	  2470#	  2470	  2492#	  2492	  2495#	  2495	  2498#	  2498	  2520#	  2520
	  2537#	  2537	  2540#	  2540	  2565#	  2565	  2600#	  2600	  2619#	  2619	  2623#	  2623	  2627#	  2627
	  2726#	  2726	  2731#	  2731	  2732	  2801#	  2801	  2802	  2874#	  2874	  2875	  3022#	  3022	  3023
	  3031#	  3031	  3036#	  3036	  3164#	  3164	  3165	  3288#	  3288	  3289	  3291#	  3291	  3302#	  3303
	  3309#	  3309	  3310	  3404#	  3404	  3436#	  3436	  3437	  3447#	  3447	  3506#	  3507	  3585#	  3586
	  3637#	  3637	  3638	  3754#	  3755	  3865#	  3865	  3897#	  3897	  3898	  3904#	  3904	  3905	  4021#
	  4021	  4022	  4320#	  4320	  4321	  4335#	  4335	  4336	  4357#	  4357	  4358	  4542#	  4542	  4543
	  4561#	  4561	  4562	  4584#	  4584	  4585	  4604#	  4604	  4605	  4721#	  4721	  4722	  4757#	  4757
	  4758	  4783#	  4783	  4784	  4827#	  4827	  4828	  4977#	  4977	  4978	  5018#	  5018	  5019	  5258#
	  5258	  5259	  5280#	  5280	  5281
..NAC	  1376#	  1376	  1377	  1545#	  1545	  1546	  1904#	  1904	  1905	  1984#	  1984	  1985	  2008#	  2008
	  2009	  2033#	  2033	  2034	  2116#	  2116	  2117	  2351#	  2351	  2352	  2518#	  2518	  2519	  2564#
	  2564	  2565	  2598#	  2598	  2599	  2650#	  2650	  2651	  2772#	  2772	  2773	  3616#	  3616	  3617
	  3653#	  3653	  3654	  4246#	  4246	  4247	  4623#	  4623	  4624	  5281#	  5281	  5282
..NS	  1525#	  1525	  1526	  2121#	  2121	  2123	  2139#	  2139	  2140	  2140#	  2141	  2225#	  2225	  2226
	  2236#	  2236	  2238	  2238#	  2240	  2252#	  2252	  2254	  2382#	  2382	  2384	  2731#	  2731	  2733
	  2748#	  2748	  2749	  2787#	  2787	  2788	  2895#	  2895	  2897	  2975#	  2975	  2976	  3151#	  3151
	  3152	  3163#	  3163	  3164	  3164#	  3166	  3288#	  3288	  3290	  3309#	  3309	  3311	  3335#	  3335
	  3336	  3361#	  3361	  3362	  3455#	  3455	  3456	  4320#	  4320	  4322	  4324#	  4324	  4326	  4337#
	  4337	  4338	  4354#	  4354	  4356	  4357#	  4357	  4359	  4383#	  4383	  4384	  4418#	  4418	  4419
	  4442#	  4442	  4443	  4443#	  4444	  4721#	  4721	  4723	  4757#	  4757	  4759	  4910#	  4910	  4911
	  4945#	  4945	  4946
..NUM	  1376#	  1376	  1377	  1545#	  1545	  1546	  1904#	  1904	  1905	  1984#	  1984	  1985	  2008#	  2008
	  2009	  2033#	  2033	  2034	  2116#	  2116	  2117	  2351#	  2351	  2352	  2518#	  2518	  2519	  2564#
	  2564	  2565	  2598#	  2598	  2599	  2650#	  2650	  2651	  2772#	  2772	  2773	  3616#	  3616	  3617
	  3653#	  3653	  3654	  4246#	  4246	  4247	  4623#	  4623	  4624	  5281#	  5281	  5282
..OFF	   772#	   773	   774	   774#	   775	   775#	   819#	   820	   821	   821#	   822	   823	   823#	   824
	   824#	   825	   825#	   827#	   828	   829	   830	   831	   832	   833	   834	   835	   836	   837
	   838	   839	   840	   841	   843	   843#	   844	   845	   845#	   846	   847	   847#	   848	   849
	   849#	   850	   851	   851#	   852	   853	   853#	   855	   856	   856#	   857	   857#	   858	   858#
	   859	   859#	   860	   860#	   861	   861#	   862	   862#	   863	   863#	   864	   865	   865#	   866
	   866#	   867	   868	   868#	   869	   869#	   870	   870#	   871	   871#	   872	   872#	   873	   873#
	   875#	   876	   877	   877#	   878	   878#	   882#	   883	   884	   884#	   885	   885#	   886	   886#
	   887	   887#	   888	   888#	   889	   889#	   890	   890#	   891	   891#	   895#	   896	   897	   897#
	   898	   899	   899#	   900	   901	   902	   903	   904	   904#	   905	   906	   906#	   907	   908
	   908#	   909	   910	   910#	   911	   912	   912#	   913	   913#	   914	   914#	   915	   915#	   916
	   916#	   917	   917#	   918	   919	   919#	   920	   921	   921#	   922	   923	   923#	   924	   925
	   925#	   926	   927	   927#	   928	   928#	   929	   929#	   930	   930#	   931	   931#	   932	   933#
Symbol cross reference

	   934	   935	   935#	   936	   936#	   937	   937#	   938	   938#	   939	   939#	   940	   940#	   941	   941#
	   942	   942#	   962#	   963	   964	   964#	   965	   966	   967	   968	   969	   970	   971	   972
	   973	   973#	   974	   975	   975#	   976	   977	   977#	   978	   979	   979#	   980	   981	   981#
	   982	   983	   983#	   984	   984#	   985	   985#	   986	   986#	   987	   987#	   988	   988#	   989
	   990	   991	   992	   994	   994#	   998#	   999	  1000	  1000#	  1001	  1001#
..PST	  1136#	  1136	  1139#	  1139	  1142#	  1142	  1145#	  1145	  1148#	  1148	  1154#	  1154	  1191#	  1191
	  1200#	  1200	  1393#	  1393	  1409#	  1409	  1413#	  1413	  1415#	  1415	  1436#	  1436	  1445#	  1445
	  1447#	  1447	  1460#	  1460	  1475#	  1475	  1489#	  1489	  1518#	  1518	  1525#	  1525	  1656#	  1656
	  1705#	  1705	  1723#	  1723	  1758#	  1758	  1806#	  1806	  1827#	  1827	  1927#	  1927	  1932#	  1932
	  1938#	  1938	  1941#	  1941	  1991#	  1991	  1997#	  1997	  2013#	  2013	  2017#	  2017	  2121#	  2121
	  2139#	  2139	  2140#	  2140	  2154#	  2154	  2161#	  2161	  2163#	  2163	  2165#	  2165	  2167#	  2167
	  2169#	  2169	  2178#	  2178	  2184#	  2184	  2187#	  2187	  2189#	  2189	  2191#	  2191	  2195#	  2195
	  2197#	  2197	  2199#	  2199	  2204#	  2204	  2207#	  2207	  2219#	  2219	  2225#	  2225	  2226#	  2226
	  2236#	  2236	  2238#	  2238	  2241#	  2241	  2243#	  2243	  2248#	  2248	  2249#	  2249	  2252#	  2252
	  2299#	  2299	  2305#	  2305	  2354#	  2354	  2364#	  2364	  2366#	  2366	  2382#	  2382	  2393#	  2393
	  2394#	  2394	  2395#	  2395	  2421#	  2421	  2423#	  2423	  2425#	  2425	  2430#	  2430	  2437#	  2437
	  2438#	  2438	  2439#	  2439	  2442#	  2442	  2443#	  2443	  2445#	  2445	  2448#	  2448	  2468#	  2468
	  2469#	  2469	  2493#	  2493	  2494#	  2494	  2497#	  2497	  2527#	  2527	  2528#	  2528	  2529#	  2529
	  2530#	  2530	  2532#	  2532	  2534#	  2534	  2535#	  2535	  2536#	  2536	  2539#	  2539	  2572#	  2572
	  2575#	  2575	  2576#	  2576	  2601#	  2601	  2607#	  2607	  2613#	  2613	  2617#	  2617	  2621#	  2621
	  2625#	  2625	  2630#	  2630	  2634#	  2634	  2635#	  2635	  2693#	  2693	  2722#	  2722	  2723#	  2723
	  2731#	  2731	  2742#	  2742	  2743#	  2743	  2745#	  2745	  2747#	  2747	  2748#	  2748	  2750#	  2750
	  2752#	  2752	  2782#	  2782	  2784#	  2784	  2785#	  2785	  2786#	  2786	  2787#	  2787	  2788#	  2788
	  2797#	  2797	  2798#	  2798	  2799#	  2799	  2802#	  2802	  2856#	  2856	  2858#	  2858	  2860#	  2860
	  2862#	  2862	  2875#	  2875	  2899#	  2899	  2902#	  2902	  2903#	  2903	  2908#	  2908	  2923#	  2923
	  2949#	  2949	  2950#	  2950	  2958#	  2958	  2959#	  2959	  2961#	  2961	  2964#	  2964	  2972#	  2972
	  2974#	  2974	  2975#	  2975	  2976#	  2976	  2977#	  2977	  2978#	  2978	  2993#	  2993	  3001#	  3001
	  3003#	  3003	  3004#	  3004	  3008#	  3008	  3011#	  3011	  3012#	  3012	  3013#	  3013	  3014#	  3014
	  3015#	  3015	  3016#	  3016	  3017#	  3017	  3018#	  3018	  3019#	  3019	  3023#	  3023	  3025#	  3025
	  3027#	  3027	  3034#	  3034	  3039#	  3039	  3055#	  3055	  3057#	  3057	  3058#	  3058	  3059#	  3059
	  3060#	  3060	  3063#	  3063	  3082#	  3082	  3088#	  3088	  3089#	  3089	  3102#	  3102	  3119#	  3119
	  3120#	  3120	  3126#	  3126	  3131#	  3131	  3136#	  3136	  3139#	  3139	  3140#	  3140	  3142#	  3142
	  3143#	  3143	  3151#	  3151	  3162#	  3162	  3163#	  3163	  3164#	  3164	  3193#	  3193	  3194#	  3194
	  3195#	  3195	  3205#	  3205	  3215#	  3215	  3216#	  3216	  3227#	  3227	  3228#	  3228	  3235#	  3235
	  3236#	  3236	  3259#	  3259	  3288#	  3288	  3292#	  3292	  3297#	  3297	  3298#	  3298	  3299#	  3299
	  3300#	  3300	  3301#	  3301	  3306#	  3306	  3307#	  3307	  3309#	  3309	  3335#	  3335	  3337#	  3337
	  3340#	  3340	  3347#	  3347	  3349#	  3349	  3361#	  3361	  3385#	  3385	  3386#	  3386	  3405#	  3405
	  3417#	  3417	  3419#	  3419	  3438#	  3438	  3440#	  3440	  3443#	  3443	  3446#	  3446	  3448#	  3448
	  3454#	  3454	  3455#	  3455	  3457#	  3457	  3470#	  3470	  3475#	  3475	  3476#	  3476	  3480#	  3480
	  3481#	  3481	  3487#	  3487	  3494#	  3494	  3496#	  3496	  3498#	  3498	  3499#	  3499	  3500#	  3500
	  3502#	  3502	  3503#	  3503	  3505#	  3505	  3511#	  3511	  3513#	  3513	  3530#	  3530	  3534#	  3534
	  3536#	  3536	  3538#	  3538	  3540#	  3540	  3570#	  3570	  3572#	  3572	  3573#	  3573	  3574#	  3574
	  3576#	  3576	  3578#	  3578	  3579#	  3579	  3580#	  3580	  3581#	  3581	  3582#	  3582	  3584#	  3584
	  3589#	  3589	  3591#	  3591	  3596#	  3596	  3598#	  3598	  3621#	  3621	  3623#	  3623	  3638#	  3638
	  3639#	  3639	  3640#	  3640	  3654#	  3654	  3656#	  3656	  3659#	  3659	  3669#	  3669	  3671#	  3671
	  3675#	  3675	  3695#	  3695	  3697#	  3697	  3699#	  3699	  3710#	  3710	  3711#	  3711	  3715#	  3715
	  3725#	  3725	  3729#	  3729	  3744#	  3744	  3747#	  3747	  3748#	  3748	  3749#	  3749	  3750#	  3750
	  3752#	  3752	  3786#	  3786	  3788#	  3788	  3790#	  3790	  3792#	  3792	  3796#	  3796	  3798#	  3798
	  3850#	  3850	  3856#	  3856	  3857#	  3857	  3858#	  3858	  3859#	  3859	  3868#	  3868	  3903#	  3903
	  3925#	  3925	  3933#	  3933	  3952#	  3952	  3971#	  3971	  3984#	  3984	  4001#	  4001	  4004#	  4004
	  4006#	  4006	  4010#	  4010	  4012#	  4012	  4015#	  4015	  4018#	  4018	  4052#	  4052	  4060#	  4060
	  4061#	  4061	  4063#	  4063	  4066#	  4066	  4068#	  4068	  4069#	  4069	  4071#	  4071	  4085#	  4085
	  4087#	  4087	  4106#	  4106	  4108#	  4108	  4124#	  4124	  4154#	  4154	  4160#	  4160	  4165#	  4165
	  4167#	  4167	  4171#	  4171	  4174#	  4174	  4176#	  4176	  4185#	  4185	  4196#	  4196	  4259#	  4259
Symbol cross reference

	  4266#	  4266	  4299#	  4299	  4311#	  4311	  4314#	  4314	  4317#	  4317	  4320#	  4320	  4337#	  4337	  4340#
	  4340	  4357#	  4357	  4370#	  4370	  4374#	  4374	  4383#	  4383	  4384#	  4384	  4389#	  4389	  4416#
	  4416	  4418#	  4418	  4425#	  4425	  4435#	  4435	  4437#	  4437	  4438#	  4438	  4439#	  4439	  4440#
	  4440	  4441#	  4441	  4442#	  4442	  4443#	  4443	  4444#	  4444	  4445#	  4445	  4451#	  4451	  4455#
	  4455	  4463#	  4463	  4471#	  4471	  4488#	  4488	  4491#	  4491	  4494#	  4494	  4531#	  4531	  4535#
	  4535	  4537#	  4537	  4538#	  4538	  4541#	  4541	  4557#	  4557	  4580#	  4580	  4603#	  4603	  4625#
	  4625	  4628#	  4628	  4632#	  4632	  4638#	  4638	  4640#	  4640	  4721#	  4721	  4723#	  4723	  4732#
	  4732	  4735#	  4735	  4744#	  4744	  4756#	  4756	  4757#	  4757	  4759#	  4759	  4764#	  4764	  4774#
	  4774	  4775#	  4775	  4777#	  4777	  4797#	  4797	  4801#	  4801	  4803#	  4803	  4805#	  4805	  4818#
	  4818	  4823#	  4823	  4832#	  4832	  4834#	  4834	  4858#	  4858	  4889#	  4889	  4890#	  4890	  4906#
	  4906	  4908#	  4908	  4909#	  4909	  4910#	  4910	  4911#	  4911	  4923#	  4923	  4924#	  4924	  4927#
	  4927	  4930#	  4930	  4942#	  4942	  4944#	  4944	  4945#	  4945	  4946#	  4946	  4957#	  4957	  4959#
	  4959	  4960#	  4960	  4961#	  4961	  4978#	  4978	  4980#	  4980	  4982#	  4982	  4984#	  4984	  5019#
	  5019	  5021#	  5021	  5023#	  5023	  5026#	  5026	  5044#	  5044	  5100#	  5100	  5101#	  5101	  5111#
	  5111	  5113#	  5113	  5125#	  5125	  5126#	  5126	  5136#	  5136	  5138#	  5138	  5175#	  5175	  5179#
	  5179
..SACC	  1376#	  1376	  1377	  1545#	  1545	  1546	  1904#	  1904	  1905	  1984#	  1984	  1985	  2008#	  2008
	  2009	  2033#	  2033	  2034	  2116#	  2116	  2117	  2351#	  2351	  2352	  2518#	  2518	  2519	  2564#
	  2564	  2565	  2598#	  2598	  2599	  2650#	  2650	  2651	  2772#	  2772	  2773	  3616#	  3616	  3617
	  3653#	  3653	  3654	  4246#	  4246	  4247	  4623#	  4623	  4624	  5281#	  5281	  5282
..SMSK	  1376#	  1376	  1377	  1545#	  1545	  1546	  1904#	  1904	  1905	  1984#	  1984	  1985	  2008#	  2008
	  2009	  2033#	  2033	  2034	  2116#	  2116	  2117	  2351#	  2351	  2352	  2518#	  2518	  2519	  2564#
	  2564	  2565	  2598#	  2598	  2599	  2650#	  2650	  2651	  2772#	  2772	  2773	  3616#	  3616	  3617
	  3653#	  3653	  3654	  4246#	  4246	  4247	  4623#	  4623	  4624	  5281#	  5281	  5282
..STKN	  1546#	  1546	  1547	  1626#	  1626	  1627	  2034#	  2034	  2035	  2417#	  2417	  2418
..STKQ	  1546#	  1546	  1626#	  1626	  2034#	  2034	  2417#	  2417
..STKR	  1546#	  1548	  1626#	  1628	  2034#	  2036	  2417#	  2419
..TMSK	  1376#	  1376	  1377	  1545#	  1545	  1546	  1904#	  1904	  1905	  1984#	  1984	  1985	  2008#	  2008
	  2009	  2033#	  2033	  2034	  2116#	  2116	  2117	  2351#	  2351	  2352	  2518#	  2518	  2519	  2564#
	  2564	  2565	  2598#	  2598	  2599	  2650#	  2650	  2651	  2772#	  2772	  2773	  3616#	  3616	  3617
	  3653#	  3653	  3654	  4246#	  4246	  4247	  4623#	  4623	  4624	  5281#	  5281	  5282
..TNAC	  2033#	  2033	  2034	  2116#	  2116	  2117	  2351#	  2351	  2352	  2772#	  2772	  2773	  5281#	  5281
	  5282
..TSA1	  2121#	  2121	  2236#	  2236	  2238#	  2238	  2252#	  2252	  2382#	  2382	  2731#	  2731	  2895#	  2895
	  3164#	  3164	  3288#	  3288	  3309#	  3309	  4320#	  4320	  4324#	  4324	  4354#	  4354	  4357#	  4357
	  4721#	  4721	  4757#	  4757
..TX1	  1384#	  1384	  1386#	  1386	  1395#	  1395	  1397#	  1397	  1416#	  1416	  1681#	  1681	  1683#	  1683
	  1923#	  1923	  1937#	  1937	  1940#	  1940	  2012#	  2012	  2724#	  2724	  2896#	  2896	  3439#	  3439
	  4325#	  4325	  4355#	  4355	  5158#	  5158	  5178#	  5178
..TX2	  1384#	  1384	  1385	  1386#	  1387	  1395#	  1395	  1396	  1397#	  1398	  1416#	  1417	  1681#	  1681
	  1682	  1683#	  1683	  1684	  1923#	  1923	  1924	  1937#	  1937	  1938	  1940#	  1940	  1941	  2012#
	  2012	  2013	  2724#	  2724	  2725	  2896#	  2896	  2897	  3439#	  3439	  3440	  4325#	  4325	  4326
	  4355#	  4355	  4356	  5158#	  5158	  5159	  5178#	  5178	  5179
..X	  1075#	  1075	  1122#	  1122	  1124#	  1124	  1307#	  1307	  1308#	  1308	  2663#	  2663	  2664#	  2664
	  2831#	  2831	  2832#	  2832	  3777#	  3777	  3778#	  3778	  4498#	  4498	  4499#	  4499
.A16	  1546	  1626	  2034	  2417
.CPJOB	  1257
.CPSK0	   756#	  2334	  2767
.FPAC0	   490#	  2116	  2351	  2650	  2772	  5281
.FPAC1	   490#	  2116	  2351	  2650	  2772	  5281	  5481
.FPAC2	   490#	  2116	  2351	  2650	  2772	  5281	  5481
.FPAC3	   490#	  2116	  2351	  2772	  5281	  5481
.FPAC4	   490#	  2772	  5281	  5481
.FPAC5	   490#	  2772	  5281	  5481
Symbol cross reference

.FPAC6	   490#	  2772	  5281	  5481
.FWORD	   773	   774	   820	   823	   824	   857	   858	   859	   860	   861	   862	   865	   868	   869
	   870	   871	   872	   876	   877	   883	   884	   885	   886	   887	   888	   889	   890	   896
	   913	   914	   915	   916	   928	   929	   930	   934	   935	   936	   937	   938	   939	   940
	   941	   963	   983	   984	   985	   986	   987	   999	  1000
.LAACT	   672#
.LABCT	   678#	  1289	  1741	  1840	  1841	  2071	  2072
.LABFA	   679#	  1288	  1478	  1507	  1538	  1553	  1651	  1730	  1739	  1801	  1810	  1844	  1914
.LACLR	   665#	  1281	  1307	  1308	  1312	  1340	  1380	  1505	  1569
.LADSC	   681#	  1398
.LAFCN	   673#	  1273	  1945	  1963
.LAPRM	   675#	  1336
.LAQUA	   680#	  1383	  1786	  1875
.LASAS	   668#	  1307	  1308	  1315
.LASCH	   666#	  1307	  1308	  1313
.LASCO	   669#	  1307	  1308	  1316
.LASET	   664#	  1280	  1307	  1308	  1311	  1944	  1962
.LASTC	   667#	  1307	  1308	  1314
.LATOP	  1243#
.LAVAL	   676#	  1348
.LAZCO	   670#	  1283	  1307	  1308	  1317
.LHALF	   821	   822	   843	   844	   845	   846	   847	   848	   849	   850	   851	   852	   853	   855
	   856	   863	   864	   866	   867	   897	   898	   903	   904	   905	   906	   907	   908	   909
	   910	   911	   912	   917	   918	   919	   920	   921	   922	   923	   924	   925	   926	   927
	   972	   973	   974	   975	   976	   977	   978	   979	   980	   981	   982	   992
.LOW.	  1006
.LPCOD	   693#	  1122	  1124	  1155	  1156	  1157
.LPLAS	   689#	  1122	  1124	  1143	  1144	  1145
.LPLOC	   697#	  1122	  1124
.LPMAC	   686#	  1122	  1124	  1134	  1135	  1136
.LPMCO	   687#	  1122	  1124	  1137	  1138	  1139
.LPMTI	   692#	  1122	  1124	  1152	  1153	  1154
.LPNID	   695#	  1122	  1124	  1161	  1162	  1163
.LPNNM	   694#	  1122	  1124	  1158	  1159	  1160
.LPNUM	   688#	  1122	  1124	  1140	  1141	  1142
.LPRLI	   690#	  1122	  1124	  1146	  1147	  1148
.LPSRV	   696#	  1122	  1124	  1164	  1165	  1166
.LPTIM	   691#	  1122	  1124	  1149	  1150	  1151
.NPAC	   490#	   490	  5481
.RHALF	   822	   843	   844	   845	   846	   847	   848	   849	   850	   851	   852	   853	   855	   856
	   864	   867	   898	   903	   904	   905	   906	   907	   908	   909	   910	   911	   912	   918
	   919	   920	   921	   922	   923	   924	   925	   926	   927	   972	   973	   974	   975	   976
	   977	   978	   979	   980	   981	   982	   992
.SAC	  1376	  1413	  1414	  1415	  1445	  1446	  1447	  1475	  1476	  1545	  1904	  1932	  1933	  1984
	  2008	  2033	  2116	  2121	  2122	  2236	  2237	  2238	  2239	  2252	  2253	  2351	  2364	  2365
	  2382	  2383	  2518	  2564	  2576	  2577	  2598	  2650	  2731	  2732	  2772	  2895	  2896	  2903
	  2904	  2950	  2951	  2959	  2960	  2961	  2972	  2973	  2974	  3082	  3083	  3164	  3165	  3288
	  3289	  3309	  3310	  3337	  3338	  3347	  3348	  3349	  3470	  3471	  3476	  3477	  3494	  3495
	  3500	  3501	  3502	  3503	  3504	  3505	  3511	  3512	  3513	  3530	  3531	  3574	  3575	  3576
	  3596	  3597	  3598	  3616	  3621	  3622	  3623	  3653	  4001	  4002	  4010	  4011	  4012	  4015
	  4016	  4069	  4070	  4071	  4085	  4086	  4087	  4106	  4107	  4108	  4165	  4166	  4167	  4174
	  4175	  4176	  4185	  4186	  4246	  4320	  4321	  4324	  4325	  4340	  4341	  4354	  4355	  4357
	  4358	  4384	  4385	  4623	  4628	  4629	  4638	  4639	  4721	  4722	  4757	  4758	  4775	  4776
	  4777	  4797	  4798	  4834	  4835	  4858	  4859	  5111	  5112	  5113	  5136	  5137	  5138	  5281
Symbol cross reference

.XSTKS	  1546	  1626	  2034	  2417
Macro/Opdef cross reference

ACDEF	   480#	   490
ACVAR	   495#	  2116	  2351	  2650	  2772	  5281
ADJBP	  2523	  2526	  2567	  2569	  2579	  3674	  3800	  4744
ADJSP	  1738	  2033	  2116	  2351	  2772	  5281
BEGSTR	   772	   819	   827	   875	   882	   895	   933	   962	   998
BIT	   772#	   775	   819#	   825	   827#	   829	   830	   831	   834	   835	   836	   837	   838	   839
	   840	   841	   873	   875#	   878	   882#	   891	   895#	   900	   901	   902	   932	   933#	   942
	   962#	   965	   966	   967	   968	   969	   970	   971	   990	   991	   994	   998#	  1001
BITS	   410#	  4048	  4193	  4479
BUG.	  2261	  2656	  2815	  3262	  5427
BUG0.	  2659	  2821	  3271	  5428
BUG1.	  2659	  2821	  3271	  5428
BUG2.	  2659	  2821	  3271	  5428
CALL	  1249	  1259	  1264	  1291	  1297	  1331	  1377	  1401	  1407	  1481	  1487	  1510	  1516	  1540
	  1561	  1659	  1686	  1726	  1733	  1790	  1795	  1799	  1808	  1812	  1814	  1838	  1854	  1879
	  1884	  1917	  1925	  1942	  1987	  1992	  1998	  2014	  2043	  2045	  2118	  2125	  2129	  2141
	  2146	  2149	  2159	  2186	  2221	  2222	  2223	  2224	  2227	  2246	  2254	  2263	  2265	  2267
	  2295	  2296	  2301	  2303	  2307	  2308	  2311	  2323	  2361	  2370	  2374	  2376	  2378	  2381
	  2398	  2427	  2429	  2435	  2441	  2471	  2496	  2499	  2533	  2538	  2541	  2545	  2573	  2604
	  2606	  2610	  2612	  2614	  2616	  2620	  2624	  2628	  2700	  2708	  2736	  2778	  2791	  2803
	  2805	  2807	  2825	  2827	  2906	  2911	  2912	  2913	  2915	  2917	  2919	  2921	  2942	  2946
	  2954	  2967	  2968	  2971	  3002	  3024	  3026	  3028	  3032	  3037	  3114	  3155	  3157	  3160
	  3166	  3167	  3199	  3203	  3211	  3294	  3304	  3323	  3324	  3325	  3343	  3346	  3363	  3369
	  3391	  3401	  3407	  3409	  3411	  3412	  3414	  3432	  3442	  3450	  3458	  3479	  3508	  3533
	  3535	  3537	  3542	  3587	  3742	  3806	  3853	  3866	  3869	  3895	  3898	  3905	  3922	  3930
	  3954	  3966	  3985	  4022	  4039	  4058	  4126	  4157	  4162	  4169	  4173	  4252	  4264	  4271
	  4284	  4297	  4315	  4322	  4342	  4344	  4346	  4386	  4388	  4401	  4481	  4528	  4533	  4540
	  4543	  4555	  4560	  4562	  4563	  4577	  4579	  4583	  4585	  4586	  4598	  4601	  4605	  4719
	  4725	  4730	  4753	  4762	  4784	  4799	  4807	  4811	  4825	  4826	  4828	  4836	  4838	  4975
	  4987	  4995	  4998	  5014	  5040	  5057	  5060	  5081	  5083	  5106	  5108	  5130	  5134	  5150
	  5163	  5259	  5286	  5382	  5395	  5443
CALLRE	  2655	  2783	  3220	  3420	  3755	  3805	  3849	  3852	  3945	  3948	  3995	  4000	  4003	  4007
	  4285	  5073	  5109	  5275	  5277	  5432	  5458
DO.	  1559	  1567	  1684	  1935	  2010	  2040
DRSTAC	  2033	  2116	  2351	  2772	  5281
DSAVAC	  2033	  2116	  2351	  2772	  5281
ELSE.	  1341	  1341#	  1347#	  1351	  1351#	  1358#	  1385	  1385#	  1394#	  1396	  1396#	  1410#	  1412	  1412#
	  1417#	  1570	  1570#	  1572	  1573#	  1574#	  1787	  1787#	  1805#	  1876	  1876#	  1888	  1889#	  1891#
	  1943	  1943#	  1946	  1946#	  1951#	  1954#	  1993	  1993#	  1996#	  1999	  1999#	  2002#	  2171	  2171#
	  2176#	  2247	  2247#	  2251	  2251#	  2256#	  2257#	  2433	  2433#	  2436#	  2730	  2730#	  2734#	  2746
	  2746#	  2749	  2750#	  2751#	  2790	  2790#	  2793#	  2813	  2813#	  2822	  2823#	  2826#	  2857	  2857#
	  2859	  2860#	  2861#	  2876	  2876#	  2881	  2882#	  2883#	  2910	  2910#	  2914#	  2952	  2952#	  2963#
	  3061	  3061#	  3065#	  3084	  3084#	  3087#	  3096	  3096#	  3099#	  3135	  3135#	  3137	  3138#	  3141#
	  3150	  3150#	  3152#	  3186	  3186#	  3189#	  3305	  3305#	  3308	  3309#	  3311#	  3474	  3474#	  3478
	  3478#	  3482	  3483#	  3484#	  3486#	  3509	  3509#	  3514#	  3661	  3661#	  3664#	  4020	  4020#	  4023#
	  4084	  4084#	  4089#	  4105	  4105#	  4110#	  4164	  4164#	  4168#	  4372	  4372#	  4376#	  4434	  4434#
	  4436	  4436#	  4446#	  4447#	  4490	  4490#	  4493#	  4630	  4630#	  4641	  4642#	  4643#
ENDAV.	  2117#	  2270	  2352#	  2638	  2651#	  2756	  2773#	  5182	  5282#	  5315
ENDDO.	  1564	  1577	  1690	  1957	  2020	  2049
ENDIF.	  1341	  1341#	  1347	  1347#	  1351	  1351#	  1358	  1358#	  1385	  1385#	  1394	  1394#	  1396	  1396#
	  1410	  1410#	  1412	  1412#	  1417	  1417#	  1570	  1570#	  1574	  1574#	  1787	  1787#	  1805	  1805#
	  1876	  1876#	  1891	  1891#	  1943	  1943#	  1946	  1946#	  1951	  1951#	  1954	  1954#	  1993	  1993#
	  1996	  1996#	  1999	  1999#	  2002	  2002#	  2171	  2171#	  2176	  2176#	  2247	  2247#	  2251	  2251#
	  2256	  2256#	  2257	  2257#	  2433	  2433#	  2436	  2436#	  2730	  2730#	  2734	  2734#	  2746	  2746#
Macro/Opdef cross reference

	  2751	  2751#	  2790	  2790#	  2793	  2793#	  2813	  2813#	  2826	  2826#	  2857	  2857#	  2861	  2861#	  2876
	  2876#	  2883	  2883#	  2910	  2910#	  2914	  2914#	  2952	  2952#	  2963	  2963#	  3061	  3061#	  3065
	  3065#	  3084	  3084#	  3087	  3087#	  3096	  3096#	  3099	  3099#	  3135	  3135#	  3141	  3141#	  3150
	  3150#	  3152	  3152#	  3186	  3186#	  3189	  3189#	  3305	  3305#	  3311	  3311#	  3474	  3474#	  3478
	  3478#	  3484	  3484#	  3486	  3486#	  3509	  3509#	  3514	  3514#	  3661	  3661#	  3664	  3664#	  4020
	  4020#	  4023	  4023#	  4084	  4084#	  4089	  4089#	  4105	  4105#	  4110	  4110#	  4164	  4164#	  4168
	  4168#	  4372	  4372#	  4376	  4376#	  4434	  4434#	  4436	  4436#	  4446	  4446#	  4447	  4447#	  4490
	  4490#	  4493	  4493#	  4630	  4630#	  4643	  4643#
ENDLP.	  1559	  1559#	  1564#	  1567	  1567#	  1577#	  1684	  1684#	  1690#	  1935	  1935#	  1957#	  2010	  2010#
	  2020#	  2040	  2040#	  2049#
ENDSTR	   772#	   775	   819#	   825	   827#	   873	   875#	   878	   882#	   891	   895#	   932	   933#	   942
	   962#	   994	   998#	  1001
ENDSV.	  1548#	  1628#	  1637	  2036#	  2052	  2419#
EQ	   437#	  5481
ETHLOK	  2744	  2851	  5282
ETHULK	  2753	  2855	  5287
EXCTUX	  1185	  1195	  1233	  1273	  1288	  1336	  1348	  1383	  1398	  1478	  1507	  1538	  1553	  1651
	  1730	  1739	  1801	  1810	  1844	  1914
EXCTXU	  1226	  1706	  1760	  1761	  1819
EXIT.	  1559	  1559#	  1564#	  1567	  1567#	  1577#	  1684	  1684#	  1690#	  1935	  1935#	  1957#	  2010	  2010#
	  2020#	  2040	  2040#	  2049#
EXT	   742
FIELD	   772#	   775	   819#	   825	   827#	   828	   833	   873	   875#	   878	   882#	   891	   895#	   899
	   932	   933#	   942	   962#	   964	   989	   994	   998#	  1001
FIELDM	   772#	   773	   774	   775	   819#	   820	   821	   822	   823	   824	   825	   827#	   843	   844
	   845	   846	   847	   848	   849	   850	   851	   852	   853	   855	   856	   857	   858	   859
	   860	   861	   862	   863	   864	   865	   866	   867	   868	   869	   870	   871	   872	   873
	   875#	   876	   877	   878	   882#	   883	   884	   885	   886	   887	   888	   889	   890	   891
	   895#	   896	   897	   898	   903	   904	   905	   906	   907	   908	   909	   910	   911	   912
	   913	   914	   915	   916	   917	   918	   919	   920	   921	   922	   923	   924	   925	   926
	   927	   928	   929	   930	   932	   933#	   934	   935	   936	   937	   938	   939	   940	   941
	   942	   962#	   963	   972	   973	   974	   975	   976	   977	   978	   979	   980	   981	   982
	   983	   984	   985	   986	   987	   992	   994	   998#	   999	  1000	  1001
FILLER	   772#	   775	   819#	   825	   827#	   832	   873	   875#	   878	   882#	   891	   895#	   932	   933#
	   942	   962#	   994	   998#	  1001
FREEAC	   482#	   489
HIGHES	   439#	  5481
HWORD	   772#	   775	   819#	   821	   822	   825	   827#	   843	   844	   845	   846	   847	   848	   849
	   850	   851	   852	   853	   855	   856	   863	   864	   866	   867	   873	   875#	   878	   882#
	   891	   895#	   897	   898	   903	   904	   905	   906	   907	   908	   909	   910	   911	   912
	   917	   918	   919	   920	   921	   922	   923	   924	   925	   926	   927	   932	   933#	   942
	   962#	   972	   973	   974	   975	   976	   977	   978	   979	   980	   981	   982	   992	   994
	   998#	  1001
IFIW	  1311	  1312	  1313	  1314	  1315	  1316	  1317	  2667	  2668	  2669	  2670	  2671	  2672	  2673
	  2674	  2676	  2677	  2678	  2679	  2680	  2835	  2836	  2837	  3815	  3816	  3817	  3818	  3819
	  3820	  3821	  3822	  3823	  3824	  3825	  3826	  3827	  3828	  3830	  3831	  3832	  3833	  3834
	  3835	  3912	  3913	  3914	  3915	  3916	  3917	  4504	  4506	  4508	  4510	  4512	  4514
IFNSK.	  2813	  3061	  3509
IFSKP.	  1341	  1351	  1385	  1396	  1412	  1570	  1787	  1876	  1943	  1946	  1993	  1999	  2171	  2247
	  2251	  2433	  2730	  2746	  2790	  2857	  2876	  2910	  2952	  3084	  3096	  3135	  3150	  3186
	  3305	  3474	  3478	  3661	  4020	  4084	  4105	  4164	  4372	  4434	  4436	  4490	  4630
INCFLG	  2417#	  2417	  2419	  2432
ITERR	   711#	  1260	  1266	  1275	  1278	  1293	  1298	  1541
LFTBT.	   829	   830	   831	   834	   835	   836	   837	   838	   839	   840	   841	   900	   901	   902
Macro/Opdef cross reference

	   965	   966	   967	   968	   969	   970	   971	   990	   991
LHDSP.	  1059#	  1311	  1312	  1313	  1314	  1315	  1316	  1317	  2676	  2677	  2678	  2679	  2680	  2835
	  2836	  2837	  3830	  3831	  3832	  3833	  3834	  3835
LOAD	  1191	  1200	  1436	  1656	  1705	  1723	  1758	  1806	  1827	  1938	  1941	  1991	  1997	  2013
	  2204	  2248	  2299	  2305	  2354	  2394	  2438	  2442	  2445	  2469	  2494	  2497	  2529	  2536
	  2539	  2575	  2607	  2613	  2617	  2621	  2625	  2693	  2722	  2723	  2788	  2899	  2902	  2908
	  2949	  3055	  3057	  3058	  3063	  3088	  3119	  3120	  3131	  3142	  3215	  3216	  3300	  3386
	  3438	  3443	  3475	  3480	  3534	  3536	  3538	  3540	  3572	  3578	  3669	  3749	  3792	  3971
	  4004	  4299	  4311	  4317	  4370	  4389	  4437	  4438	  4441	  4451	  4463	  4471	  4557	  4580
	  4625	  4640	  4732	  4756	  4801	  4805	  4818	  4832	  4923	  4924	  5100	  5101	  5125	  5126
	  5175
LOOP.	  1559	  1559#	  1564#	  1567	  1567#	  1577#	  1684	  1684#	  1690#	  1935	  1935#	  1957#	  2010	  2010#
	  2020#	  2040	  2040#	  2049#
LSLDT.	  1064#	  4504	  4506	  4508	  4510	  4512	  4514
MASK.	   828	   832	   833	   899	   964	   989
MAX.	  1054#	  1075	  1121	  1308	  2664	  2832	  3778	  4499
MAXCNT	  1626#	  1626	  1628	  1633	  1637#
MCENT	   408#
MIN.	  1044#	  1123	  1307	  2663	  2831	  3777	  4498
MOVX	  1342	  1349	  1405	  1485	  1514	  1556	  1985	  1989	  2121	  2156	  2157	  2236	  2238	  2244
	  2252	  2382	  2384	  2396	  2420	  2467	  2470	  2492	  2495	  2498	  2520	  2537	  2540	  2565
	  2600	  2619	  2623	  2627	  2726	  2731	  2801	  2874	  3022	  3031	  3036	  3164	  3288	  3291
	  3302	  3309	  3404	  3436	  3447	  3506	  3585	  3637	  3754	  3865	  3897	  3904	  4021	  4320
	  4335	  4357	  4542	  4561	  4584	  4604	  4721	  4757	  4783	  4827	  4977	  5018	  5258	  5280
MSKPTR	  1546#	  1546	  1557	  1562
MSKSTR	   773	   774	   820	   821	   822	   823	   824	   828	   829	   830	   831	   833	   834	   835
	   836	   837	   838	   839	   840	   841	   843	   844	   845	   846	   847	   848	   849	   850
	   851	   852	   853	   855	   856	   857	   858	   859	   860	   861	   862	   863	   864	   865
	   866	   867	   868	   869	   870	   871	   872	   876	   877	   883	   884	   885	   886	   887
	   888	   889	   890	   896	   897	   898	   899	   900	   901	   902	   903	   904	   905	   906
	   907	   908	   909	   910	   911	   912	   913	   914	   915	   916	   917	   918	   919	   920
	   921	   922	   923	   924	   925	   926	   927	   928	   929	   930	   934	   935	   936	   937
	   938	   939	   940	   941	   963	   964	   965	   966	   967	   968	   969	   970	   971	   972
	   973	   974	   975	   976	   977	   978	   979	   980	   981	   982	   983	   984	   985	   986
	   987	   989	   990	   991	   992	   999	  1000
NOP	   402#	  1265	  1292	  1542	  2362	  3433	  4343	  4808
NOSKD1	   406#
NXTWRD	   772#	   775	   819#	   825	   827#	   843	   845	   847	   849	   851	   853	   856	   873	   875#
	   878	   882#	   891	   895#	   904	   906	   908	   910	   912	   919	   921	   923	   925	   927
	   932	   933#	   942	   962#	   973	   975	   977	   979	   981	   994	   998#	  1001
OD.	  1559	  1559#	  1564	  1564#	  1567	  1567#	  1577	  1577#	  1684	  1684#	  1690	  1690#	  1935	  1935#
	  1957	  1957#	  2010	  2010#	  2020	  2020#	  2040	  2040#	  2049	  2049#
OKSKD1	   407#
OPSTR	  1475	  1932	  2017	  2364	  2366	  2430	  2532	  2572	  2576	  2745	  2782	  2784	  2798	  2799
	  2856	  2875	  2903	  2950	  2964	  2977	  2993	  3004	  3008	  3012	  3014	  3016	  3018	  3059
	  3060	  3082	  3162	  3193	  3194	  3195	  3259	  3298	  3337	  3470	  3476	  3494	  3496	  3530
	  3573	  3579	  3638	  3639	  3640	  3654	  3656	  3671	  3697	  3699	  3711	  3715	  3729	  3786
	  3788	  3790	  3798	  3850	  3856	  3858	  3952	  3984	  4001	  4006	  4015	  4124	  4154	  4160
	  4171	  4185	  4314	  4340	  4384	  4416	  4425	  4435	  4488	  4491	  4535	  4537	  4538	  4541
	  4628	  4632	  4638	  4744	  4759	  4764	  4797	  4823	  4834	  4858	  4906	  4942	  4957	  4959
OPSTRM	  1413	  1445	  2219	  2423	  2425	  2437	  2439	  2443	  2448	  2530	  2534	  2535	  2630	  2797
	  2802	  2959	  2972	  2976	  2978	  3023	  3139	  3140	  3205	  3227	  3228	  3235	  3236	  3299
	  3306	  3307	  3347	  3498	  3499	  3500	  3503	  3511	  3574	  3581	  3589	  3591	  3596	  3621
	  3695	  3710	  3725	  4010	  4069	  4085	  4106	  4165	  4174	  4603	  4774	  4775	  4889	  4890
Macro/Opdef cross reference

	  5111	  5136
OWGP.	  1681	  1683	  1923	  1937	  1940	  2012	  2300	  2306	  2392	  3296	  3416	  3746	  5043
PARTB.	  1097#	  1134	  1137	  1140	  1143	  1146	  1149	  1152	  1155	  1158	  1161	  1164
PJRST	  2291	  2312
PRGALL	   456#	  5481
PRGNUM	   444#	  5481
PRGSYM	   452#	  5481
PRSTAC	  1376	  1545	  1904	  1984	  2008	  2518	  2564	  2598	  2650	  3616	  3653	  4246	  4623
PSAVAC	  1376	  1545	  1904	  1984	  2008	  2518	  2564	  2598	  2650	  3616	  3653	  4246	  4623
PTR1	  2034#	  2034	  2038	  2041	  2052#
PTR2	  2034#	  2034	  2039	  2042	  2052#
PXCT	  1185	  1195	  1226	  1233	  1234	  1273	  1288	  1289	  1336	  1348	  1383	  1398	  1478	  1507
	  1538	  1553	  1560	  1611	  1651	  1687	  1706	  1730	  1739	  1741	  1760	  1761	  1786	  1801
	  1810	  1819	  1825	  1840	  1841	  1844	  1875	  1914	  1945	  1963	  2071	  2072
PXGEN	  1185	  1195	  1226	  1233	  1273	  1288	  1336	  1348	  1383	  1398	  1478	  1507	  1538	  1553
	  1651	  1706	  1730	  1739	  1760	  1761	  1801	  1810	  1819	  1844	  1914
RESCD	   403#	  1080	  1602
RESDT	   405#	  1006
RET	  1086	  1087	  1089	  1091	  1092	  1228	  1333	  1339	  1344	  1357	  1378	  1392	  1402	  1408
	  1477	  1482	  1488	  1511	  1517	  1592	  1615	  1634	  1660	  1727	  1757	  1781	  1791	  1796
	  1800	  1809	  1837	  1839	  1843	  1853	  1855	  1880	  1885	  1918	  1926	  1964	  1967	  1988
	  2003	  2018	  2037	  2047	  2062	  2074	  2258	  2268	  2327	  2335	  2339	  2353	  2360	  2400
	  2449	  2472	  2500	  2546	  2583	  2636	  2661	  2702	  2709	  2725	  2733	  2737	  2754	  2768
	  2777	  2863	  2884	  2898	  2901	  2907	  2920	  2929	  3103	  3115	  3168	  3212	  3219	  3312
	  3339	  3350	  3364	  3399	  3402	  3459	  3485	  3497	  3517	  3543	  3592	  3599	  3624	  3643
	  3655	  3700	  3926	  3934	  3967	  4040	  4046	  4092	  4102	  4112	  4125	  4128	  4177	  4187
	  4197	  4253	  4391	  4417	  4428	  4529	  4556	  4578	  4599	  4728	  4731	  4800	  4839	  4891
	  4912	  4931	  4947	  4958	  4996	  5015	  5041	  5058	  5084	  5107	  5132	  5139	  5151	  5153
	  5177	  5180	  5279	  5288	  5313	  5321	  5350	  5358	  5385	  5478
RETBAD	   716#	  1333	  1339	  1344	  1357	  1378	  1392	  1402	  1408	  1477	  1482	  1488	  1511	  1517
	  1660	  1727	  1781	  1791	  1796	  1800	  1809	  1837	  1843	  1853	  1880	  1885	  1918	  1926
	  1964	  1967	  1988	  2003	  2074
RETSKP	  1094	  1196	  1205	  1239	  1304	  1363	  1423	  1450	  1465	  1494	  1523	  1526	  1578	  1617
	  1711	  1742	  1768	  1804	  1815	  1846	  1860	  1892	  1953	  1970	  1995	  2001	  2016	  2050
	  2075	  2979	  3040	  3066	  3206	  3472	  3488	  3663	  3676	  3785	  3809	  3854	  3899	  3906
	  3955	  3969	  3988	  4014	  4024	  4072	  4272	  4456	  4544	  4564	  4587	  4606	  4782	  4785
	  4829	  4882	  4887	  4962	  4989	  5027	  5039	  5045	  5103	  5114	  5260	  5412	  5448
SAVEAC	  1376	  1545	  1904	  1984	  2008	  2033	  2116	  2351	  2518	  2564	  2598	  2650	  2772	  3616
	  3653	  4246	  4623	  5281
SE1ENT	  2115	  2288	  2350	  2771
SETONE	  2121	  2225	  2975	  3164	  3288	  4357	  4721
SETZRO	  1525	  2139	  2140	  2236	  2238	  2252	  2382	  2731	  2748	  2787	  3151	  3163	  3309	  3335
	  3361	  3455	  4320	  4337	  4383	  4418	  4442	  4443	  4757	  4910	  4945
SPCSAV	  1376	  1545	  1904	  1984	  2008	  2033	  2116	  2351	  2518	  2564	  2598	  2650	  2772	  3616
	  3653	  4246	  4623	  5281
STKVAR	  1546	  1626	  2034	  2417
STOR	  1136	  1139	  1142	  1145	  1148	  1154	  1393	  1409	  1460	  1489	  1518	  1927	  2154	  2161
	  2163	  2165	  2167	  2169	  2178	  2184	  2187	  2189	  2191	  2195	  2197	  2199	  2207	  2226
	  2241	  2243	  2249	  2393	  2395	  2421	  2468	  2493	  2527	  2528	  2601	  2634	  2635	  2742
	  2743	  2747	  2750	  2752	  2785	  2786	  2858	  2860	  2862	  2923	  2958	  3001	  3003	  3011
	  3013	  3015	  3017	  3019	  3025	  3027	  3034	  3039	  3089	  3102	  3126	  3136	  3143	  3292
	  3297	  3301	  3340	  3385	  3405	  3417	  3419	  3440	  3446	  3448	  3454	  3457	  3481	  3487
	  3570	  3580	  3582	  3584	  3659	  3675	  3744	  3747	  3748	  3750	  3752	  3796	  3857	  3859
	  3868	  3903	  3925	  3933	  4018	  4052	  4060	  4061	  4063	  4066	  4068	  4196	  4259	  4266
Macro/Opdef cross reference

	  4374	  4439	  4440	  4444	  4445	  4455	  4494	  4531	  4723	  4735	  4803	  4908	  4909	  4911	  4927
	  4930	  4944	  4946	  4960	  4961	  4978	  4980	  4982	  4984	  5019	  5021	  5023	  5026	  5044
	  5179
SWAPCD	   404#	  1128	  1639
TMNN	  2895	  4324	  4354
TOP.	  1559	  1559#	  1563	  1564#	  1567	  1567#	  1576	  1577#	  1684	  1684#	  1688	  1690#	  1935	  1935#
	  1956	  1957#	  2010	  2010#	  2019	  2020#	  2040	  2040#	  2048	  2049#
TRVAR	   475#	  1032	  1033
TXNE	  2724	  3439
TXNN	  1384	  1395	  2896	  4325	  4355
TXO	  1386	  1397	  1416	  1681	  1683	  1923	  1937	  1940	  2012	  5158	  5178
UMOVE	  1273	  1288	  1336	  1348	  1383	  1398	  1478	  1507	  1538	  1553	  1651	  1730	  1739	  1801
	  1810	  1844	  1914
UMOVEM	  1706	  1760	  1761	  1819
USRPTR	  1546#	  1546	  1555	  1560
USRSAV	  1376	  1545	  1904	  1984	  2008	  2033	  2116	  2351	  2518	  2564	  2598	  2650	  2772	  3616
	  3653	  4246	  4623	  5281
WORD	   772#	   773	   774	   775	   819#	   820	   823	   824	   825	   827#	   857	   858	   859	   860
	   861	   862	   865	   868	   869	   870	   871	   872	   873	   875#	   876	   877	   878	   882#
	   883	   884	   885	   886	   887	   888	   889	   890	   891	   895#	   896	   913	   914	   915
	   916	   928	   929	   930	   932	   933#	   934	   935	   936	   937	   938	   939	   940	   941
	   942	   962#	   963	   983	   984	   985	   986	   987	   994	   998#	   999	  1000	  1001
XBLT.	  1422	  1444	  1493	  1522	  1552	  1859	  1909	  1950	  2213	  2705	  2999	  5402
XBLTXU	  1666	  1676	  1696	  1710	  1766	  1803	  1823	  1845
XCTBU	   416#	  1560	  1611	  1687
XCTU	   415#	  1289	  1741	  1786	  1825	  1840	  1841	  1875	  1945	  1963	  2071	  2072
XMOVEI	  1192	  1202	  1233	  1420	  1438	  1440	  1491	  1492	  1520	  1521	  1549	  1550	  1566	  1665
	  1671	  1680	  1695	  1709	  1762	  1802	  1822	  1857	  1886	  1890	  1906	  1907	  1922	  1931
	  1936	  1939	  1948	  1949	  1965	  2011	  2196	  2211	  2212	  2216	  2242	  2245	  2363	  2391
	  2397	  2531	  2571	  2599	  2704	  2941	  2945	  2969	  2997	  2998	  3098	  3156	  3159	  3198
	  3202	  3290	  3295	  3303	  3341	  3344	  3362	  3415	  3431	  3441	  3456	  3507	  3586	  3745
	  3753	  4056	  4160	  4172	  4926	  4929	  4983	  4986	  4994	  5024	  5042	  5056	  5399	  5411
	  5456
XP	   539
$HIGH	  1080	  1128	  1602	  1639
$LOW	  1006
$PSECT	  1006	  1080	  1128	  1602	  1639
$RELOC	   533
%ACCOD	   877#
%ACLNG	   876#	  2191	  2469
%CBAKQ	   914#	  3162
%CBCSB	   903#	  4337	  4370	  4374	  4383
%CBCTI	   921#	  3017
%CBDLL	   912#	  3361	  3494	  3503	  3511	  3574	  3596	  3621
%CBDNI	   916#	  2978	  3057	  3058	  3193	  3298	  3573
%CBERR	   911#	  3385
%CBFLG	   899#
%CBKAF	   930#
%CBKTI	   922#	  3019
%CBLID	   898#	  3082	  3089	  3120	  3215	  3536
%CBLNK	   896#
%CBLOC	   929#
%CBLRA	   907#	  3142	  3143
%CBMRN	   902#	  4324	  4357
Macro/Opdef cross reference

%CBMRS	   901#	  3164	  4354
%CBMSL	   919#	  3013	  4463
%CBMTF	   917#	  3003
%CBNBF	   920#	  3015
%CBNUM	   925#	  3025
%CBPTC	   923#	  3027
%CBQUA	   910#
%CBRID	   897#	  3001	  3119	  3335	  3386	  3534
%CBRLC	   927#	  2305	  3039
%CBRPV	   918#	  3011
%CBRRF	   900#	  3530	  4320
%CBRSC	   926#	  1191	  1758	  2013	  2299	  3034
%CBRSQ	   906#	  3131	  3136	  3538
%CBRTC	   909#	  3151	  3476	  3500
%CBSBQ	   915#	  4160	  4314
%CBSDC	   904#	  4085	  4106	  4165	  4340	  4384
%CBSNM	   928#
%CBSTA	   924#	  2908	  2923	  2958	  2975	  3126	  3216	  3337	  3340	  4311
%CBTIM	   908#	  3163	  3440	  3470	  3481	  3487
%CBTSQ	   905#	  3443	  3446	  3540
%CBXBQ	   913#
%CCIMR	   938#	  3227	  3235
%CCISR	   939#	  4890
%CCMSK	   941#
%CCRCV	   934#	  2976	  3205
%CCRES	   940#
%CCRTR	   936#	  3499
%CCSEQ	   937#	  3140
%CCXMT	   935#	  3307	  3591
%GBHID	   824#
%GBLC	   822#	  1409	  2207	  2539	  2576
%GBNAM	   823#
%GBNC	   821#	  1927	  1938	  1941	  2199	  2536	  2575
%GBRAT	   820#	  1393	  2197	  2532	  2572
%HCIMR	   887#	  3228	  3236
%HCISR	   888#	  4889
%HCMSK	   890#
%HCRCV	   883#	  2797
%HCRES	   889#
%HCRTR	   885#	  3498
%HCSEQ	   886#	  3139
%HCXMT	   884#	  3306	  3589
%HNACS	   841#
%HNANY	   830#
%HNCFL	   833#	  2364	  2382	  2438
%HNCIP	   831#	  2731	  2895	  3288	  3309
%HNCLS	   836#
%HNCON	   848#	  1723	  4069	  4174
%HNFIL	   835#
%HNFLG	   828#
%HNHST	   857#
%HNID	   869#
%HNIDC	   867#	  1518	  1525	  2161	  2204	  2497	  2625
%HNLAS	   850#	  1145	  2169	  2445	  2899	  4317
Macro/Opdef cross reference

%HNLOK	   865#	  2225	  2366
%HNMAC	   845#	  1136	  2184	  2903
%HNMCM	   871#
%HNMCO	   847#	  1139	  2189	  2607
%HNMTI	   853#	  1154	  2167	  2354	  2442
%HNMXC	   843#	  2178	  2950
%HNNAC	   846#	  2902	  2949	  2972	  3347	  5101	  5126
%HNNAM	   868#
%HNNCC	   844#	  1806	  2959
%HNNDD	   840#
%HNNIQ	   860#	  2745	  2750	  2752
%HNNMC	   866#	  1475	  1489	  2154	  2494	  2617	  2621
%HNNRB	   856#	  5100	  5111	  5125	  5136
%HNNSV	   864#	  1413	  1436	  1445	  1656	  1705	  1932	  2195	  2529
%HNNUM	   849#	  1142	  2613
%HNNXI	   863#	  2187	  3088	  3102
%HNOTH	   834#
%HNPID	   862#	  2249	  2394	  3300	  3572	  3749
%HNPRG	   855#
%HNQAC	   858#	  1991
%HNQIC	   859#	  1997
%HNRLI	   851#	  1148	  2163	  3475
%HNRUN	   829#	  2121	  2252
%HNSCQ	   861#	  2782	  2785	  2786	  2856	  2860	  2862
%HNSMT	   870#
%HNSRV	   872#
%HNSVD	   837#
%HNSVN	   839#
%HNSVR	   838#
%HNTIM	   852#	  1460	  2165
%MDALA	  4984	  5026
%MDAUX	  4978	  5019
%MDBYT	  3454	  4455	  4980	  5021
%MDVMC	  4982	  5023
%QLBWD	  1000#	  2140	  2964	  4171	  4438	  4440	  4441	  4443	  4445	  4908	  4910	  4923	  4927	  4942
	  4946	  4960
%QLFWD	   999#	  1827	  2017	  2139	  3055	  3063	  3496	  4124	  4299	  4389	  4416	  4425	  4435	  4437
	  4439	  4442	  4444	  4906	  4909	  4911	  4924	  4930	  4944	  4945	  4957	  4959	  4961
%SBATS	   972#	  3857
%SBCBA	   987#	  3952	  4006	  4061
%SBCHR	   992#	  4723	  4756
%SBFCC	   970#
%SBFLG	   964#
%SBFOU	   968#
%SBLID	   976#	  4052	  4185	  4196	  4832
%SBLNK	   963#
%SBMDS	   973#	  3859	  4638	  4640
%SBOPC	   981#	  3925
%SBOPN	   984#
%SBOUT	   969#
%SBRCR	   978#	  4015	  4018	  4068	  4775	  4858
%SBREA	   979#	  3903	  4557	  4580
%SBREJ	   966#
%SBREM	   989#
Macro/Opdef cross reference

%SBRID	   975#	  4001	  4063	  4834
%SBSDP	   965#
%SBSNC	   980#	  3868
%SBSNM	   983#
%SBSPC	   982#	  1200	  3933
%SBSPN	   985#
%SBSTA	   974#	  4004	  4060	  4531
%SBSTO	   971#
%SBSTR	   967#
%SBTDB	   986#	  3971	  4154	  4259	  4625	  4805	  4818
%SBTTO	   990#	  4721	  4757
%SBXCR	   977#	  4010	  4066	  4628	  4732	  4735	  4797	  4801	  4803
%SBXNF	   991#	  4266	  5175	  5179
%UELW0	   773#
%UELW1	   774#	  2747	  2748	  2784	  2787	  2858
%UNADS	  3584	  3752
%UNBFA	  2393	  2421	  2423	  2425	  2430	  2437	  2439	  2443	  2448	  2468	  2493	  2528	  2530	  2535
	  2601	  2630	  2798	  2799	  3004	  3008	  3012	  3014	  3016	  3018	  3292	  3297	  3405	  3417
	  3448	  3457	  3639	  3640	  3656	  3669	  3671	  3675	  3697	  3699	  3711	  3715	  3729	  3748
	  3786	  3788	  3790	  3798	  3850	  3856	  3858	  3984	  4491	  4535	  4537	  4538	  4541	  4603
	  4744	  4759	  4764	  4823	  5044
%UNBSZ	  2527	  2534	  2634	  2802	  2993	  3023	  3419	  3455	  3638	  3654	  3659	  3695	  3710	  3725
	  3744	  3792	  3796	  4418	  4451	  4471	  4488	  4494	  4632	  4774
%UNCBA	  2243	  2742	  2788
%UNCHN	  2236
%UNDAD	  2219	  2723	  3299	  3581
%UNPAD	  2238
%UNPID	  2248	  2395	  3301	  3578	  3580	  3750
%UNPRO	  2241
%UNRID	  2226	  2635	  2693	  2722	  3582	  3747
%UNSAD	  2977	  3059	  3060	  3194	  3195	  3259	  3579
%UNSID	  2743
%UNSTA	  2875
%UNUID	  3570
..0001	  1341#	  1347	  5481
..0002	  1341#	  1347	  5481
..0003	  1341#	  1347	  5481
..0004	  1341#	  1347	  5481
..0007	  1351#	  1358	  5481
..0010	  1351#	  1358	  5481
..0011	  1351#	  1358	  5481
..0012	  1351#	  1358	  5481
..0015	  1385#	  1394	  5481
..0016	  1385#	  1394	  5481
..0017	  1385#	  1394	  5481
..0020	  1385#	  1394	  5481
..0023	  1396#	  1410	  5481
..0024	  1396#	  1410	  5481
..0025	  1396#	  1410	  5481
..0026	  1396#	  1410	  5481
..0031	  1412#	  1417	  5481
..0032	  1412#	  1417	  5481
..0033	  1412#	  1417	  5481
..0034	  1412#	  1417	  5481
Macro/Opdef cross reference

..0037	  1559#	  1564	  5481
..0040	  1559#	  1564	  5481
..0041	  1559#	  1564	  5481
..0042	  1559#	  1564	  5481
..0043	  1559#	  1564	  5481
..0046	  1567#	  1577	  5481
..0047	  1567#	  1577	  5481
..0050	  1567#	  1577	  5481
..0051	  1567#	  1577	  5481
..0052	  1567#	  1577	  5481
..0055	  1570#	  1574	  5481
..0056	  1570#	  1574	  5481
..0057	  1570#	  1574	  5481
..0060	  1570#	  1574	  5481
..0063	  1684#	  1690	  5481
..0064	  1684#	  1690	  5481
..0065	  1684#	  1690	  5481
..0066	  1684#	  1690	  5481
..0067	  1684#	  1690	  5481
..0072	  1787#	  1805	  5481
..0073	  1787#	  1805	  5481
..0074	  1787#	  1805	  5481
..0075	  1787#	  1805	  5481
..0100	  1876#	  1891	  5481
..0101	  1876#	  1891	  5481
..0102	  1876#	  1891	  5481
..0103	  1876#	  1891	  5481
..0106	  1935#	  1957	  5481
..0107	  1935#	  1957	  5481
..0110	  1935#	  1957	  5481
..0111	  1935#	  1957	  5481
..0112	  1935#	  1957	  5481
..0115	  1943#	  1954	  5481
..0116	  1943#	  1954	  5481
..0117	  1943#	  1954	  5481
..0120	  1943#	  1954	  5481
..0123	  1946#	  1951	  5481
..0124	  1946#	  1951	  5481
..0125	  1946#	  1951	  5481
..0126	  1946#	  1951	  5481
..0131	  1993#	  1996	  5481
..0132	  1993#	  1996	  5481
..0133	  1993#	  1996	  5481
..0134	  1993#	  1996	  5481
..0137	  1999#	  2002	  5481
..0140	  1999#	  2002	  5481
..0141	  1999#	  2002	  5481
..0142	  1999#	  2002	  5481
..0145	  2010#	  2020	  5481
..0146	  2010#	  2020	  5481
..0147	  2010#	  2020	  5481
..0150	  2010#	  2020	  5481
..0151	  2010#	  2020	  5481
..0154	  2040#	  2049	  5481
Macro/Opdef cross reference

..0155	  2040#	  2049	  5481
..0156	  2040#	  2049	  5481
..0157	  2040#	  2049	  5481
..0160	  2040#	  2049	  5481
..0163	  2171#	  2176	  5481
..0164	  2171#	  2176	  5481
..0165	  2171#	  2176	  5481
..0166	  2171#	  2176	  5481
..0171	  2247#	  2257	  5481
..0172	  2247#	  2257	  5481
..0173	  2247#	  2257	  5481
..0174	  2247#	  2257	  5481
..0177	  2251#	  2256	  5481
..0200	  2251#	  2256	  5481
..0201	  2251#	  2256	  5481
..0202	  2251#	  2256	  5481
..0205	  2433#	  2436	  5481
..0206	  2433#	  2436	  5481
..0207	  2433#	  2436	  5481
..0210	  2433#	  2436	  5481
..0213	  2730#	  2734	  5481
..0214	  2730#	  2734	  5481
..0215	  2730#	  2734	  5481
..0216	  2730#	  2734	  5481
..0221	  2746#	  2751	  5481
..0222	  2746#	  2751	  5481
..0223	  2746#	  2751	  5481
..0224	  2746#	  2751	  5481
..0227	  2790#	  2793	  5481
..0230	  2790#	  2793	  5481
..0231	  2790#	  2793	  5481
..0232	  2790#	  2793	  5481
..0235	  2813#	  2826	  5481
..0236	  2813#	  2826	  5481
..0237	  2813#	  2826	  5481
..0240	  2813#	  2826	  5481
..0243	  2857#	  2861	  5481
..0244	  2857#	  2861	  5481
..0245	  2857#	  2861	  5481
..0246	  2857#	  2861	  5481
..0251	  2876#	  2883	  5481
..0252	  2876#	  2883	  5481
..0253	  2876#	  2883	  5481
..0254	  2876#	  2883	  5481
..0257	  2910#	  2914	  5481
..0260	  2910#	  2914	  5481
..0261	  2910#	  2914	  5481
..0262	  2910#	  2914	  5481
..0265	  2952#	  2963	  5481
..0266	  2952#	  2963	  5481
..0267	  2952#	  2963	  5481
..0270	  2952#	  2963	  5481
..0273	  3061#	  3065	  5481
..0274	  3061#	  3065	  5481
Macro/Opdef cross reference

..0275	  3061#	  3065	  5481
..0276	  3061#	  3065	  5481
..0301	  3084#	  3087	  5481
..0302	  3084#	  3087	  5481
..0303	  3084#	  3087	  5481
..0304	  3084#	  3087	  5481
..0307	  3096#	  3099	  5481
..0310	  3096#	  3099	  5481
..0311	  3096#	  3099	  5481
..0312	  3096#	  3099	  5481
..0315	  3135#	  3141	  5481
..0316	  3135#	  3141	  5481
..0317	  3135#	  3141	  5481
..0320	  3135#	  3141	  5481
..0323	  3150#	  3152	  5481
..0324	  3150#	  3152	  5481
..0325	  3150#	  3152	  5481
..0326	  3150#	  3152	  5481
..0331	  3186#	  3189	  5481
..0332	  3186#	  3189	  5481
..0333	  3186#	  3189	  5481
..0334	  3186#	  3189	  5481
..0337	  3305#	  3311	  5481
..0340	  3305#	  3311	  5481
..0341	  3305#	  3311	  5481
..0342	  3305#	  3311	  5481
..0345	  3474#	  3486	  5481
..0346	  3474#	  3486	  5481
..0347	  3474#	  3486	  5481
..0350	  3474#	  3486	  5481
..0353	  3478#	  3484	  5481
..0354	  3478#	  3484	  5481
..0355	  3478#	  3484	  5481
..0356	  3478#	  3484	  5481
..0361	  3509#	  3514	  5481
..0362	  3509#	  3514	  5481
..0363	  3509#	  3514	  5481
..0364	  3509#	  3514	  5481
..0367	  3661#	  3664	  5481
..0370	  3661#	  3664	  5481
..0371	  3661#	  3664	  5481
..0372	  3661#	  3664	  5481
..0375	  4020#	  4023	  5481
..0376	  4020#	  4023	  5481
..0377	  4020#	  4023	  5481
..0400	  4020#	  4023	  5481
..0403	  4084#	  4089	  5481
..0404	  4084#	  4089	  5481
..0405	  4084#	  4089	  5481
..0406	  4084#	  4089	  5481
..0411	  4105#	  4110	  5481
..0412	  4105#	  4110	  5481
..0413	  4105#	  4110	  5481
..0414	  4105#	  4110	  5481
Macro/Opdef cross reference

..0417	  4164#	  4168	  5481
..0420	  4164#	  4168	  5481
..0421	  4164#	  4168	  5481
..0422	  4164#	  4168	  5481
..0425	  4372#	  4376	  5481
..0426	  4372#	  4376	  5481
..0427	  4372#	  4376	  5481
..0430	  4372#	  4376	  5481
..0433	  4434#	  4447	  5481
..0434	  4434#	  4447	  5481
..0435	  4434#	  4447	  5481
..0436	  4434#	  4447	  5481
..0441	  4436#	  4446	  5481
..0442	  4436#	  4446	  5481
..0443	  4436#	  4446	  5481
..0444	  4436#	  4446	  5481
..0447	  4490#	  4493	  5481
..0450	  4490#	  4493	  5481
..0451	  4490#	  4493	  5481
..0452	  4490#	  4493	  5481
..0455	  4630#	  4643	  5481
..0456	  4630#	  4643	  5481
..0457	  4630#	  4643	  5481
..0460	  4630#	  4643	  5481
..INDF	  1341	  1351	  1385	  1396	  1412	  1570	  1787	  1876	  1943	  1946	  1993	  1999	  2171	  2247
	  2251	  2433	  2730	  2746	  2790	  2813	  2857	  2876	  2910	  2952	  3061	  3084	  3096	  3135
	  3150	  3186	  3305	  3474	  3478	  3509	  3661	  4020	  4084	  4105	  4164	  4372	  4434	  4436
	  4490	  4630
..OWGP	  1681	  1683	  1923	  1937	  1940	  2012	  2300	  2306	  2392	  3296	  3416	  3746	  5043
..RSDF	  1347	  1358	  1394	  1410	  1417	  1574	  1805	  1891	  1951	  1954	  1996	  2002	  2176	  2256
	  2257	  2436	  2734	  2751	  2793	  2826	  2861	  2883	  2914	  2963	  3065	  3087	  3099	  3141
	  3152	  3189	  3311	  3484	  3486	  3514	  3664	  4023	  4089	  4110	  4168	  4376	  4446	  4447
	  4493	  4643
..SVDF	  1341	  1351	  1385	  1396	  1412	  1570	  1787	  1876	  1943	  1946	  1993	  1999	  2171	  2247
	  2251	  2433	  2730	  2746	  2790	  2813	  2857	  2876	  2910	  2952	  3061	  3084	  3096	  3135
	  3150	  3186	  3305	  3474	  3478	  3509	  3661	  4020	  4084	  4105	  4164	  4372	  4434	  4436
	  4490	  4630
..SVLD	  1559	  1567	  1684	  1935	  2010	  2040
..TAGE	  1341	  1342#	  1347#	  1351	  1352#	  1358#	  1385	  1386#	  1394#	  1396	  1397#	  1410#	  1412	  1413#
	  1417#	  1570	  1571#	  1572	  1573	  1574#	  1787	  1788#	  1805#	  1876	  1877#	  1888	  1889	  1891#
	  1943	  1944#	  1946	  1947#	  1951#	  1954#	  1993	  1994#	  1996#	  1999	  2000#	  2002#	  2171	  2172#
	  2176#	  2247	  2248#	  2251	  2252#	  2256#	  2257#	  2433	  2434#	  2436#	  2730	  2731#	  2734#	  2746
	  2747#	  2749	  2750	  2751#	  2790	  2791#	  2793#	  2813	  2815#	  2822	  2823	  2826#	  2857	  2858#
	  2859	  2860	  2861#	  2876	  2877#	  2881	  2882	  2883#	  2910	  2911#	  2914#	  2952	  2953#	  2963#
	  3061	  3063#	  3065#	  3084	  3085#	  3087#	  3096	  3097#	  3099#	  3135	  3136#	  3137	  3138	  3141#
	  3150	  3151#	  3152#	  3186	  3187#	  3189#	  3305	  3306#	  3308	  3309	  3311#	  3474	  3475#	  3478
	  3479#	  3482	  3483	  3484#	  3486#	  3509	  3511#	  3514#	  3661	  3662#	  3664#	  4020	  4021#	  4023#
	  4084	  4085#	  4089#	  4105	  4106#	  4110#	  4164	  4165#	  4168#	  4372	  4373#	  4376#	  4434	  4435#
	  4436	  4437#	  4446#	  4447#	  4490	  4491#	  4493#	  4630	  4631#	  4641	  4642	  4643#
..TAGF	  1341	  1342#	  1347	  1347#	  1351	  1352#	  1358	  1358#	  1385	  1386#	  1394	  1394#	  1396	  1397#
	  1410	  1410#	  1412	  1413#	  1417	  1417#	  1570	  1571#	  1573	  1573#	  1574	  1574#	  1787	  1788#
	  1805	  1805#	  1876	  1877#	  1889	  1889#	  1891	  1891#	  1943	  1944#	  1946	  1947#	  1951	  1951#
	  1954	  1954#	  1993	  1994#	  1996	  1996#	  1999	  2000#	  2002	  2002#	  2171	  2172#	  2176	  2176#
	  2247	  2248#	  2251	  2252#	  2256	  2256#	  2257	  2257#	  2433	  2434#	  2436	  2436#	  2730	  2731#
Macro/Opdef cross reference

	  2734	  2734#	  2746	  2747#	  2750	  2750#	  2751	  2751#	  2790	  2791#	  2793	  2793#	  2813	  2815#	  2823
	  2823#	  2826	  2826#	  2857	  2858#	  2860	  2860#	  2861	  2861#	  2876	  2877#	  2882	  2882#	  2883
	  2883#	  2910	  2911#	  2914	  2914#	  2952	  2953#	  2963	  2963#	  3061	  3063#	  3065	  3065#	  3084
	  3085#	  3087	  3087#	  3096	  3097#	  3099	  3099#	  3135	  3136#	  3138	  3138#	  3141	  3141#	  3150
	  3151#	  3152	  3152#	  3186	  3187#	  3189	  3189#	  3305	  3306#	  3309	  3309#	  3311	  3311#	  3474
	  3475#	  3478	  3479#	  3483	  3483#	  3484	  3484#	  3486	  3486#	  3509	  3511#	  3514	  3514#	  3661
	  3662#	  3664	  3664#	  4020	  4021#	  4023	  4023#	  4084	  4085#	  4089	  4089#	  4105	  4106#	  4110
	  4110#	  4164	  4165#	  4168	  4168#	  4372	  4373#	  4376	  4376#	  4434	  4435#	  4436	  4437#	  4446
	  4446#	  4447	  4447#	  4490	  4491#	  4493	  4493#	  4630	  4631#	  4642	  4642#	  4643	  4643#
..TYNN	  2895	  4324	  4354
.ACV1	   503#	  2116	  2351	  2650	  2772	  5281
.ACV2	   506#	  2116	  2351	  2650	  2772	  5281
.CPYRT	   398
.ENAV1	   512#	  2270	  2638	  2756	  5182	  5315
.ENAV2	   516#	  2270	  2638	  2756	  5182	  5315
.ENAV3	   519#	  2270	  2638	  2756	  5182	  5315
.ENSV1	  1637	  2052
.ENSV2	  1637	  2052
.ENSV3	  1637	  2052
.ERRT	   721#	   725	   726	   727	   728	   729	   730	   731	   732	   733	   734	   735	   736	   737
.POPX	  1347	  1358	  1394	  1410	  1417	  1564	  1574	  1577	  1690	  1805	  1891	  1951	  1954	  1957
	  1996	  2002	  2020	  2049	  2176	  2256	  2257	  2436	  2734	  2751	  2793	  2826	  2861	  2883
	  2914	  2963	  3065	  3087	  3099	  3141	  3152	  3189	  3311	  3484	  3486	  3514	  3664	  4023
	  4089	  4110	  4168	  4376	  4446	  4447	  4493	  4643
.POPX2	  1347	  1358	  1394	  1410	  1417	  1564	  1574	  1577	  1690	  1805	  1891	  1951	  1954	  1957
	  1996	  2002	  2020	  2049	  2176	  2256	  2257	  2436	  2734	  2751	  2793	  2826	  2861	  2883
	  2914	  2963	  3065	  3087	  3099	  3141	  3152	  3189	  3311	  3484	  3486	  3514	  3664	  4023
	  4089	  4110	  4168	  4376	  4446	  4447	  4493	  4643
.POPX3	  1347	  1358	  1394	  1410	  1417	  1564	  1574	  1577	  1690	  1805	  1891	  1951	  1954	  1957
	  1996	  2002	  2020	  2049	  2176	  2256	  2257	  2436	  2734	  2751	  2793	  2826	  2861	  2883
	  2914	  2963	  3065	  3087	  3099	  3141	  3152	  3189	  3311	  3484	  3486	  3514	  3664	  4023
	  4089	  4110	  4168	  4376	  4446	  4447	  4493	  4643
.POPX4	  1347	  1358	  1394	  1410	  1417	  1564	  1574	  1577	  1690	  1805	  1891	  1951	  1954	  1957
	  1996	  2002	  2020	  2049	  2176	  2256	  2257	  2436	  2734	  2751	  2793	  2826	  2861	  2883
	  2914	  2963	  3065	  3087	  3099	  3141	  3152	  3189	  3311	  3484	  3486	  3514	  3664	  4023
	  4089	  4110	  4168	  4376	  4446	  4447	  4493	  4643
.PSHX	  1341	  1351	  1385	  1396	  1412	  1559	  1567	  1570	  1684	  1787	  1876	  1935	  1943	  1946
	  1993	  1999	  2010	  2040	  2171	  2247	  2251	  2433	  2730	  2746	  2790	  2813	  2857	  2876
	  2910	  2952	  3061	  3084	  3096	  3135	  3150	  3186	  3305	  3474	  3478	  3509	  3661	  4020
	  4084	  4105	  4164	  4372	  4434	  4436	  4490	  4630
.PSHX1	  1341	  1341#	  1347	  1347#	  1351	  1351#	  1358	  1358#	  1385	  1385#	  1394	  1394#	  1396	  1396#
	  1410	  1410#	  1412	  1412#	  1417	  1417#	  1559	  1559#	  1564	  1564#	  1567	  1567#	  1570	  1570#
	  1574	  1574#	  1577	  1577#	  1684	  1684#	  1690	  1690#	  1787	  1787#	  1805	  1805#	  1876	  1876#
	  1891	  1891#	  1935	  1935#	  1943	  1943#	  1946	  1946#	  1951	  1951#	  1954	  1954#	  1957	  1957#
	  1993	  1993#	  1996	  1996#	  1999	  1999#	  2002	  2002#	  2010	  2010#	  2020	  2020#	  2040	  2040#
	  2049	  2049#	  2171	  2171#	  2176	  2176#	  2247	  2247#	  2251	  2251#	  2256	  2256#	  2257	  2257#
	  2433	  2433#	  2436	  2436#	  2730	  2730#	  2734	  2734#	  2746	  2746#	  2751	  2751#	  2790	  2790#
	  2793	  2793#	  2813	  2813#	  2826	  2826#	  2857	  2857#	  2861	  2861#	  2876	  2876#	  2883	  2883#
	  2910	  2910#	  2914	  2914#	  2952	  2952#	  2963	  2963#	  3061	  3061#	  3065	  3065#	  3084	  3084#
	  3087	  3087#	  3096	  3096#	  3099	  3099#	  3135	  3135#	  3141	  3141#	  3150	  3150#	  3152	  3152#
	  3186	  3186#	  3189	  3189#	  3305	  3305#	  3311	  3311#	  3474	  3474#	  3478	  3478#	  3484	  3484#
	  3486	  3486#	  3509	  3509#	  3514	  3514#	  3661	  3661#	  3664	  3664#	  4020	  4020#	  4023	  4023#
	  4084	  4084#	  4089	  4089#	  4105	  4105#	  4110	  4110#	  4164	  4164#	  4168	  4168#	  4372	  4372#
	  4376	  4376#	  4434	  4434#	  4436	  4436#	  4446	  4446#	  4447	  4447#	  4490	  4490#	  4493	  4493#
Macro/Opdef cross reference

	  4630	  4630#	  4643	  4643#
.PSHX2	  1341	  1351	  1385	  1396	  1412	  1559	  1567	  1570	  1684	  1787	  1876	  1935	  1943	  1946
	  1993	  1999	  2010	  2040	  2171	  2247	  2251	  2433	  2730	  2746	  2790	  2813	  2857	  2876
	  2910	  2952	  3061	  3084	  3096	  3135	  3150	  3186	  3305	  3474	  3478	  3509	  3661	  4020
	  4084	  4105	  4164	  4372	  4434	  4436	  4490	  4630
.XCMSY	  5481
.XCRF1	  5481#    !?