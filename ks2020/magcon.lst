MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 1
MAGCON.MAC	 6-JUL-77 09:25		*** WORDS OF WISDOM ***

     1				TITLE MAGCON ************* CHARACTER SET CONVERTER **********   
     2				SUBTTL                          *** WORDS OF WISDOM ***
     3
     4
     5
     6
     7
     8
     9
    10
    11
    12
    13
    14
    15
    16
    17
    18
    19
    20				;********************************************************************
    21				;*                                                                  *
    22				;*      NO FORCE, HOWEVER GREAT, CAN STRETCH A CORD, HOWEVER        *
    23				;*      FINE, INTO A HORIZONTAL LINE, WHICH SHALL BE ABSOLUTELY     *
    24				;*      STRAIGHT...AND SO IS THE WAY OF AN EAGLE IN THE AIR; THE    *
    25				;*      WAY OF A SERPENT UPON A ROCK; THE WAY OF A SHIP IN THE      *
    26				;*      MIDST OF THE SEA; AND THE WAY OF A MAN WITH A MAID...FOR    *
    27				;*      HOWEVER BEAUTIFUL AND FREE, STILL IMPERFECT....             *
    28				;*                                                                  *
    29				;********************************************************************
    30
    31
    32
    33
    34
    35
    36
    37
    38
    39
    40
    41
    42
    43
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 2
MAGCON.MAC	 6-JUL-77 09:25		*** DEFINITIONS ***

    44				SUBTTL                          *** DEFINITIONS ***
    45
    46				;       ASSEMBLER DIRECTIVES.
    47
    48	400000'			TWOSEG
    49				SALL
    50				EXTERNAL        JOBFF,JOBREL,JOBREN,JOBUUO,JOBSA
    51				EXTERNAL        JOB41,JOBDDT,.JBTPC,JOBAPR,JOBCNI
    52
    53				;       ACCUMULATORS.
    54
    55			000000	S=0                                     ;BIT REGISTER.
    56			000001	OF=1                                    ;USED FOR DEVICE STATUS.
    57			000002	IF=2                                    ;USED FOR DEVICE STATUS.
    58			000003	T1=3                                    ;TEMPORARY AC'S.
    59			000004	T2=4
    60			000005	T3=5
    61			000006	P1=<T4=6>                                       ;MAYBE YOU CAN DEPEND ON AC'S.
    62			000007	P2=7
    63			000010	P3=10
    64			000011	P4=11
    65			000012	OCNT=<SIDE=12>                          ;INDEX IN DECODER AND COUNTER.
    66			000013	ICNT=<WD=13>                            ;OUTPUT WORD AND COUNTER.
    67			000014	CH=14                                   ;HOLDS A CHARACTER.
    68			000015	OM=15                                   ;MODE INDEX.
    69			000016	IM=16                                   ;MODE INDEX.
    70			000017	PDP=17                                  ;PUSH-DOWN POINTER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 3
MAGCON.MAC	 6-JUL-77 09:25		*** DEFINITIONS ***

    71				;       BITS SET BY COMMAND DECODER IN S.
    72
    73			000001	COL==1                                  ;SET BY CD IF COLON FOUND.
    74			000002	PER==2                                  ;SET BY CD IF PERIOD FOUND.
    75			000004	SLH==4                                  ;SET BY CD IF SLASH FOUND.
    76			000010	BRK==10                                 ;SET BY CD IF BRACKET FOUND.
    77			000020	IO==20                                  ;SET IF _ OR = FOUND BY CD.
    78			000040	EOL==40                                 ;SET WHEN EOL FOUND.
    79			000100	SOM==100                                ;SET WITH ALL OF THE ABOVE.
    80			000200	DEV==200                                ;SAYS WE HAVE A DEVICE.
    81			000400	NUM==400                                ;SAYS WE HAVE PPN.
    82			001000	REL==1000                               ;SAYS WE HAVE REEL SERIAL NUMBER.
    83			002000	PAR==2000                               ;SET TO INDICATE WE HAVE PARITY.
    84			004000	MODE==4000                              ;SET TO INDICATE WE HAVE MODE.
    85			010000	BLK==10000                              ;SET TO INDICATE WE HAVE BLOCKING FACTOR.
    86			020000	ADV==20000                              ;SET TO INDICATE WE HAVE ADVANCE NUMBER.
    87			040000	ATS==40000                              ;SET BY CD WHEN "@" FOUND.
    88			100000	XBUF==100000                            ;SET TO INDICATE WE HAVE A BUFFER SWITCH.
    89			200000	ALT==200000                             ;AN ALTMODE WAS THE DELIMITER.
    90			200000	SPC==200000                             ;SET IF A CRLF IS NEEDED.
    91			400000	IOT==400000                             ;SET WHEN LOOKING AT INPUT SPECS.
    92		000001	000000	DATA==1000000                           ;SAYS WE MAY HAVE A TABLE FILE NAME COMING.
    93		000002	000000	DEN==2000000                            ;SAYS WE HAVE DENSITY.
    94		000004	000000	LAB==4000000                            ;SET TO INDICATE WE HAVE LABEL TYPE.
    95		000010	000000	BAD==10000000                           ;SET IF A BAD CHARACTER IS TYPED.
    96		000020	000000	REC==20000000                           ;SAYS WE HAVE RECORD SIZE.
    97		000040	000000	NODIS==40000000                         ;SAYS THERE IS NO DISPATCH TABLE.
    98		000100	000000	FNDONE==100000000                       ;SAYS WE HAVE FOUND ONE MATCH.
    99		000200	000000	FNDTWO==200000000                       ;SAYS WE FOUND MORE THEN ONE MATCH.
   100		000400	000000	NOCHK==400000000                        ;DON'T CHECK INPUT CHARACTER.
   101		001000	000000	STAR==1000000000                        ;WE HAVE SEEN A STAR ON INPUT.
   102		002000	000000	BAC==2000000000                         ;WE HAVE BACKSPACE ARGUMENT.
   103		004000	000000	ADVR==4000000000
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 4
MAGCON.MAC	 6-JUL-77 09:25		*** DEFINITIONS ***

   104				;       INDEXES INTO CCL BLOCK.
   105
   106			000001	CCLDEV==1                               ;CCL DEVICE.
   107			000003	CCLNAM==3                               ;NAME OF CCL FILE.
   108			000006	CCLPPN==6                               ;PPN OF ONWER.
   109			000007	CCLOPN==7                               ;OPEN MME.
   110			000010	CCLLOK==10                              ;LOOKUP MME.
   111			000011	CCLGET==11                              ;INPUT MME.
   112			000012	CCLREL==12                              ;RELEASE MME.
   113			000013	CCLBUF==13                              ;INBUF MME.
   114			000014	CCLHED==14                              ;BUFFER HEADER.
   115
   116				;       INDEXES INTO IMPURE DATA BLOCK.
   117
   118		777777	777777	CHAN==-1                                ;CHANNEL FILE IS OPEN ON.
   119			000000	STATUS==0                               ;STATUS BITS FOR OPEN.
   120			000001	DEVICE==1                               ;DEVICE FOR OPEN.
   121			000002	BUFFER==2                               ;POINTER TO POINTER TO BUFFERS.
   122			000003	NAME==3                                 ;FILE NAME POSITION FOR LOOKUP.
   123			000004	EXT==4                                  ;FILE EXTENSION POSITION.
   124			000005	DATTIM==5                               ;DATE TIME WORD.
   125			000006	PPN==6                                  ;PPN WORD.
   126			000007	MOD==7                                  ;MOD WORD FOR DATA BLOCK.
   127			000010	BLKFCT==10                              ;BLOCKING FACTOR.
   128			000011	RECSIZ==11                              ;RECORD SIZE.
   129			000012	ADVAN==12                               ;ADVANCE COUNT.
   130			000013	LABEL==13                               ;LABEL TYPE.
   131			000014	DENSITY==14                             ;MAG-TAPE DENSITY.
   132			000015	VOL==15                                 ;CURRENT VOLUME FOR MAG-TAPE.
   133			000016	PERGE==16                               ;PERGE NUMBER FOR MAG-TAPE.
   134			000017	CHRMOD==17                              ;FILE MODE (CHARACTER SET).
   135			000020	SEC==20                                 ;SECTORS FOR BLOCKING FACTOR.
   136			000021	BUFNUM==21                              ;NUMBER OF BUFFERS TO USE.
   137			000022	BACSPC==22                              ;BACKSPACE ARGUMENT.
   138			000023	BYTSIZ==23                              ;FAST TAPE WORD
   139			000026	FSTTAP==26                              ;FAST TAPE WORD
   140			000027	RECADV==27				;RECORD ADVANCE COUNT WORD
   141			000003	THREE==<TWO==<ONE==<ZERO==0>+1>+1>+1    ;INDEXES FOR RETURNS.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 5
MAGCON.MAC	 6-JUL-77 09:25		*** DEFINITIONS ***

   142				;       BITS SET IN IF OR OF.
   143
   144			000001	NOWIND==1                               ;DO NOT REWIND DEVICE.
   145			010000	AWIND==10000                            ;DON'T REWIND AFTER OPERATION.
   146			020000	BWIND==20000                            ;DON'T REWIND BEFORE OPERATION.
   147			000002	UNLOAD==2                               ;UNLOAD DEVICE.
   148			000004	NOHEAD==4                               ;NO LINE PRINTER HEADINGS.
   149			000010	IND==10                                 ;INITIALIZE IN INDUSTRY MODE.
   150			000020	NOERROR==20                             ;SET IF IGNORING ERRORS.
   151			000040	SPAN==40                                ;RECORDS CROSS BLOCKS.
   152			001000	WDEV==1000                              ;DEVICE IS WILD DISK (ALL STR).
   153			000100	WNAME==100                              ;WE HAVE A WILD NAME.
   154			000200	WEXT==200                               ;WE HAVE A WILD EXTENSION.
   155			002000	WP==2000                                ;PROJECT NUMBER IS WILD.
   156			004000	WPN==4000                               ;PROGRAM NUMBER IS WILD.
   157			007300	WILD==WDEV!WNAME!WEXT!WP!WPN            ;SOMETHING IS WILD.
   158			000400	SCAN==400                               ;SAYS TO SCAN MTA FOR FILE.
   159			040000	NOCRLF==40000                           ;ASCII FILE HAS NO CRLF'S.
   160		000020	000000	MTA==20000000                           ;DEVICE IS A MAG-TAPE.
   161		200000	000000	DSK==200000000000                       ;DEVICE IS A DISK.
   162		100000	000000	CDR==100000000000                       ;DEVICE IS A CARD READER.
   163		100000	000000	CDP==100000000000                       ;DEVICE IS A CARD PUNCH.
   164		040000	000000	LPT==40000000000                        ;DEVICE IS A LINE PRINTER.
   165		000400	000000	PTP==400000000                          ;DEVICE IS A TAPE PUNCH.
   166		000200	000000	PTR==200000000                          ;DEVICE IS A TAPE READER.
   167		000010	000000	TTY==10000000                           ;DEVICE IS A TTY.
   168		000002	000000	IPT==2000000                            ;DEVICE CAN DO INPUT.
   169		000001	000000	OTP==1000000                            ;DEVICE CAN DO OUTPUT.
   170		340630	000000	GDEV==DSK!CDR!CDP!LPT!PTP!PTR!TTY!MTA;  DEVICE CAN BE USED.
   171		010000	000000	B5==010000000000                        ;FAST TAPE BIT
   172		000040	000000	B12==000040000000                       ;BIT FOR TAPE 7TRK UNIT
   173
   174				;       BITS SET IN S.
   175
   176			000001	FF==1                                   ;LAST CHARACTER WAS A FORM FEED.
   177			000002	EOR==2                                  ;END OF RECORD HAS BEEN SEEN.
   178			000004	FREAD==4                                ;FIRST READ BIT.
   179			000010	LHEAD==10                               ;SAYS WE ARE DOING HEADINGS FOR LPT.
   180			000020	TERM==20                                ;END LABELS ARE NEXT.
   181			000040	FIN==40                                 ;SET IF END OF REEL.
   182			000200	NI.ERR==200                             ;SET TO IGNORE INPUT ERRORS.
   183			000400	HDR==400                                ;SET TO DENOTE WORKING ON HEADERS.
   184			001000	HUNG==1000                              ;SET TO DENOTE DEVICE IS HUNG.
   185			002000	NO.PRI==2000                            ;DON'T TYPE HUNG MESSAGE.
   186			004000	PRG==4000                               ;SET TO INDICATE WE HAVE PURGED LABEL.
   187			010000	NI.LST==10000                           ;SET TO IGNORE IOBLK ERRORS.
   188			020000	FFLG==20000                             ;FIRST TIME FLAG.
   189			040000	BAC==40000                              ;SET TO SAY WE WANT THE SAME CHARACTER.
   190			100000	L.HDR==100000                           ;LABEL READ IS A HEADER.
   191			200000	L.EOF==200000                           ;LABEL READ IS A TRAILER.
   192			400000	L.EOV==400000                           ;LABEL READ IS END OF REEL.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 6
MAGCON.MAC	 6-JUL-77 09:25		*** DEFINITIONS ***

   193				;       BITS SET IN SOME KIND OF A STATUS WORD.
   194
   195			001000	EVEN==1000                              ;PARITY BIT FOR EVEN.
   196			000000	ODD==0                                  ;JUST FOR CLEARNESS.
   197			000040	SYNC==40                                ;STAY EVEN WITH DEVICE.
   198			000014	BIN==14                                 ;DEVICE DATA MODE.
   199			000017	DMP==17                                 ;DEVICE DATA MODE FOR DATA FILE.
   200			000000	ASC==0                                  ;ASCII DATA MODE.
   201			000004	TRK7==4                                 ;MTA IS A SEVEN TRACK DRIVE.
   202			000001	ER.IDV==1                               ;HUNG DEVICE TRAP.
   203			000002	ER.ICC==2                               ;CONTROL-C TRAP.
   204			000004	ER.OFL==4                               ;DISK OFF LINE TRAP.
   205			000010	ER.FUL==10                              ;DISK FULL TRAP.
   206			000020	ER.QEX==20                              ;QUOTA BEING EXCEEDED TRAP.
   207			000040	ER.TLX==40                              ;RUN TIME LIMIT EXCEEDED.
   208			000077	ER.ALL==ER.IDV!ER.ICC!ER.OFL!ER.FUL!ER.QEX!ER.TLX ;PROBLEM TRAPS.
   209			400000	E.LOK==400000                           ;DEVICE IS WRITE LOCKED.
   210			200000	E.HAD==200000                           ;HARDWARE FAILURE.
   211			100000	E.PAR==100000                           ;PARITY ERROR.
   212			040000	E.IOB==40000                            ;I/O BLOCK TOO LARGE.
   213			020000	E.EOF==20000                            ;END OF FILE.
   214			004000	E.BOT==4000                             ;WE ARE AT LOAD POINT.
   215			002000	E.EOT==2000                             ;END OF TAPE.
   216			740000	E.ERR==E.LOK!E.HAD!E.PAR!E.IOB          ;ERROR BITS.
   217		000001	000000	NOR==1000000                            ;MODE NEEDS INPUT RECORD SIZE.
   218		000002	000000	NIR==2000000                            ;MODE NEEDS OUTPUT RECORD SIZE.
   219		000004	000000	EXW==4000000                            ;MODE NEEDS EXTRA WORDS FOR BUFFER.
   220		000010	000000	TAB==10000000                           ;SAYS CHARACTER SET HAS TABS.
   221		000007	000000	GDSK==7000000                           ;DISK DEVICE IS GENERIC.
   222
   223				;       INDEXS INTO MODE TABLE.
   224
   225			000000	INI==0                                  ;INPUT DISPATCH.
   226			000001	OUTI==1                                 ;OUTPUT INITIALIZATION.
   227			000002	OUTC==2                                 ;PUT ONE CHARACTER.
   228			000003	OUTR==3                                 ;FINISH OUTPUT RECORD.
   229			000004	OUTB==4                                 ;FINISH OUTPUT BLOCK.
   230			000005	OUTF==5                                 ;FINISH OUTPUT FILE.
   231			000006	MSIZ==6                                 ;BYTE SIZE AND BYTES PER WORD.
   232			000007	MPTR==7                                 ;BYTE POINTER FOR MODE.
   233			000010	FPTR==10                                ;POINTER TO DATA FILE ENTRY.
   234			000011	STS==11                                 ;STATUS BITS FOR MODE.
   235			000012	CNAM==12                                ;CHARACTER SET NAME IN SIXBIT.
   236
   237				;       CPU FLAGS.
   238
   239			200000	PDL==200000                             ;PDL OVERFLOW TRAP.
   240			020000	MPV==20000                              ;MEMORY PROTECTION VIOLATION.
   241			010000	NXM==10000                              ;NON-EXISTENT MEMORY.
   242			400000	REP==400000                             ;REPETITIVE ENABLE.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 7
MAGCON.MAC	 6-JUL-77 09:25		*** DEFINITIONS ***

   243				;       MASTER MODE SYMBOLS.
   244
   245			000001	.CH==1                                  ;OUTPUT A CHARACTER.
   246			000004	.DEV==4                                 ;GET DEVICE CHARACTERISTICS.
   247			000003	.STR==3                                 ;OUTPUT A STRING.
   248			000004	.LN==4                                  ;INPUT A LINE AND WAIT.
   249			000012	.TERM==12                               ;TERMINATE EXECUTION.
   250			000011	.CORE==11                               ;AJUST CORE ALLOCATION.
   251			000023	.TIME==23                               ;GET TIME OF DAY.
   252			000014	.DATE==14                               ;GET THE DATE.
   253			000000	.RESET==0                               ;RESET I/O.
   254			000011	.CLR==11                                ;CLEAR INPUT BUFFER.
   255			000027	.TIM==27                                ;GET RUN TIME.
   256			000064	.NAM==64                                ;GET PHYSICAL NAME FOR DEVICE.
   257			000014	.SKP==14                                ;SKIP IF LINE CAN BE INPUTTED.
   258			000031	.SLP==31                                ;SLEEP FOR A WHILE.
   259			000072	.WAIT==72                               ;HIBERNATE FOR A WHILE.
   260			000000	.WAT==0                                 ;WAIT FOR MAG-TAPE OPERATION.
   261			000001	.REW==1                                 ;REWIND TO LOAD POINT.
   262			000006	.SKR==6                                 ;SKIP A RECORD.
   263			000007	.BSR==7                                 ;BACKSPACE RECORD.
   264			000011	.UNL==11                                ;REWIND AND UNLOAD.
   265			000016	.SKF==16                                ;SKIP A FILE.
   266			000017	.BSF==17                                ;BACKSPACE FILE.
   267			0001ND==101                               ;INITIALIZE FOR INDUSTRY TAPE.
   268			000035	.RUN==35                                ;RUN A PROGRAM.
   269			000016	.ENB==16                                ;ENABLE APR TRAPS.
   270			000054	.STS==54                                ;GET DEVICE CONI BITS.
   271			000112	.TAPE==112                              ;GET MAG-TAPE DENSITY.
   272			000040	.NODEL==40                              ;RETAIN OLD FILE.
   273			000024	.PPN==24                                ;GET MY PPN.
   274			000030	.PJOB==30                               ;GET MY JOB NUMBER.
   275			000041	.TAB==41                                ;GET A TABLE ENTRY.
   276			000045	.DCHR==45                               ;GET DEVICE CHARACTERISTICS.
   277			000047	.JLST==47                               ;READ MY SEARCH LIST.
   278			000066	.GLST==66                               ;READ SOME LIST.
   279			000046	.ALST==46                               ;READ SYSTEM STRUCTURE LIST.
   280			000001	.ASC==1                                 ;STRING IS ASCIZ IN UME CALL.
   281			000002	.SIX==2                                 ;STRING IS ONE SIXBIT WORD.
   282			000006	.LTP==6                                 ;GET TTY LINE STUFF.
   283			000101	.SIZ==101                               ;GET BUFFER SZE FOR DEVICE.
   284			000010	.IOSTP==10                              ;WAIT FOR I/O TO STOP.
   285			000110	.PATH==110                              ;READ SEARCH PATH.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 8
MAGCON.MAC	 6-JUL-77 09:25		*** DEFINITIONS ***

   286				;       USEFUL OPDEFS.
   287
   288				OPDEF   UME     [OCT 001000000000]      ;USER MODE ENTRY.
   289				OPDEF   MME     [OCT 047000000000]      ;MASTER MODE ENTRY.
   290				OPDEF   EME     [OCT 051000000000]      ;EXECUTIVE MODE ENTRY.
   291				OPDEF   GOTO    [OCT 254000000000]      ;LOAD PC WITH E.
   292				OPDEF   NOP     [OCT 255000000000]      ;NO OPERATION.
   293				OPDEF   DRIVE   [OCT 072000000000]      ;MAG-TAPE OPERATOR.
   294				OPDEF   GOSUB   [OCT 260740000000]      ;SUBROUTINE CALL.
   295				OPDEF   SAVE    [OCT 261740000000]      ;SAVE A LOCATION.
   296				OPDEF   UNSAVE  [OCT 262740000000]      ;UNSAVE A LOCATION.
   297
   298				;       SOME MACROS.
   299
   300				DEFINE  RETURN  (LOC)
   301				        <IFN LOC, <GOTO RET0-LOC>
   302				        IFE LOC, <POPJ PDP,RET0>>
   303
   304				DEFINE  USE     (CORE,CONTENTS)
   305				        <IFNB <CORE>, <IFB <CONTENTS>, <ZZ==0
   306				                IFE "CODE"-"CORE", <ZZ==1
   307				                        IFGE .-400000, <RELOC .>
   308				                        IFL .-400000, <LOW==.
   309				                        RELOC HGH>>
   310				                IFE "DATA"-"CORE", <ZZ==1
   311				                        IFL .-400000, <RELOC .>
   312				                        IFGE .-400000, <HGH==.
   313				                        RELOC LOW>>
   314				        IFE ZZ, <PRINTX ? BAD CALL TO USE MACRO>>>
   315				        IFNB <CORE>, <IFNB <CONTENTS>, <ZZ==.
   316				                        LOC     CORE
   317				                        EXP     CONTENTS
   318				                        RELOC   ZZ>>
   319				        IFB <CORE>, <IFB <CONTENTS>, <PRINTX % NO ARGUMENT FOR USE MACRO>>
   320				        PURGE ZZ>
   321
   322				DEFINE  FTABLE  (NUM)
   323				        <RADIX 10
   324				        IFE NUM, <EXP .YY.>
   325				        IFG NUM, <.YY.==NUM/128
   326				                IFN <NUM-<<NUM/128>*128>>, <.YY.==.YY.+1>
   327				                .XX.==.YY.*128
   328				                XWD -.XX.,.ZZ.+1
   329				                .YY.==XWD -.XX.,.ZZ.+1
   330				                .ZZ.=.ZZ.+<.XX./128>>
   331				        IFL NUM, <RELOC .
   332				                PURGE .XX.,.YY.
   333				                .ZZ.==0>
   334				        RADIX 8>
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 9
MAGCON.MAC	 6-JUL-77 09:25		*** DEFINITIONS ***

   335				DEFINE  OP      (AC,FLG,MM)             ;CREATE THE RIGHT TEST.
   336				        <IFE FLG, <PRINTX % NO BIT ARGUMENT FOR OP MACRO>
   337				        IFN FLG, <IFN FLG&777777, <IFN FLG&777777000000, <TD'MM AC,[FLG]>>
   338				        IFE FLG&777777, <TL'MM AC,(FLG)>
   339				        IFE FLG&777777000000, <TR'MM AC,FLG>>>
   340
   341				DEFINE  TEST    (AC,FLG,M1,M2,LOC)      ;GENERATE A SKIP IF LOC IS NULL
   342				        <IFB <LOC>, <OP AC,FLG,M1>      ;ELSE GENERATE A JUMP TO LOC.
   343				        IFNB <LOC>, <OP AC,FLG,M2
   344				                XLIST
   345				        GOTO    LOC
   346				                LIST>>
   347
   348				DEFINE  ON      (AC,FLG)                ;TURN SOME BITS ON.
   349				        <OP     AC,FLG,O>
   350
   351				DEFINE  OFF     (AC,FLG)                ;TURN SOME BITS OFF.
   352				        <OP     AC,FLG,Z>
   353
   354				DEFINE  IF.ON   (AC,FLG,LOC)            ;SKIP OR JUMP IF BITS ARE ON.
   355				        <TEST   AC,FLG,NN,NE,LOC>
   356
   357				DEFINE  IF.OFF  (AC,FLG,LOC)            ;SKIP OR JUMP IF BITS ARE OFF.
   358				        <TEST   AC,FLG,NE,NN,LOC>
   359
   360				DEFINE  TNO     (AC,FLG,LOC)            ;SKIP OR JUMP IF ON AND TURN ON.
   361				        <TEST   AC,FLG,ON,OE,LOC>
   362
   363				DEFINE  TEO     (AC,FLG,LOC)            ;SKIP OR JUMP IF OFF AND TURN ON.
   364				        <TEST   AC,FLG,OE,ON,LOC>
   365
   366				DEFINE  TNZ     (AC,FLG,LOC)            ;SKIP OR JUMP IF ON AND TURN OFF.
   367				        <TEST   AC,FLG,ZN,ZE,LOC>
   368
   369				DEFINE  TEZ     (AC,FLG,LOC)            ;SKIP OR JUMP IF OFF AND TURN OFF.
   370				        <TEST   AC,FLG,ZE,ZN,LOC>
   371
   372				DEFINE  PRINT   (STRING)
   373				        <EME    .STR,[ASCIZ  #STRING
   374				#]
   375					SETZM	COLUMN>
   376
   377				DEFINE  BRANCH  (WHERE,LOC)
   378				        <GOSUB  WHERE
   379				                XLIST
   380				        IRP (LOC), <GOTO LOC>
   381				                LIST>
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 10
MAGCON.MAC	 6-JUL-77 09:25		*** DEFINITIONS ***

   382				DEFINE  MTABLE  (TYP)
   383				        <MODTAB: IRP (TYP), <EXP TYP'MOD
   384				                 XLIST>
   385				                 LIST>
   386
   387				DEFINE  TABLE   (NAM,TYP,SIZ,LEN,STS)
   388				        <TYP'MOD: EXP   INI'TYP
   389				                  XLIST
   390				                  EXP   OTI'TYP
   391				                  EXP   OTC'TYP
   392				                  EXP   OTR'TYP
   393				                  EXP   OTB'TYP
   394				                  EXP   OTF'TYP
   395				                  XWD   ^D'SIZ,^D36/^D'SIZ
   396				                  POINT SIZ,ZERO
   397				                  FTABLE LEN
   398				                  EXP   STS
   399				                  <SIXBIT "NAM">
   400				                  LIST>
   401
   402				DEFINE  BSS     (LOC,SIZE)
   403				        <IFB <SIZE>, <BLOCK LOC>
   404				        IFNB <SIZE>, <LOC: BLOCK SIZE>>
   405
   406				DEFINE  ENABLE  (ARG)
   407				        <EME    .SKP,ZERO
   408				                XLIST
   409				        NOP     ZERO
   410				                LIST>
   411
   412				DEFINE  DIARET
   413				        <MOVEI  T1,.
   414				        XLIST
   415				        MOVEM   T1,DIAFLG
   416				        LIST>
   417
   418				DEFINE  EQUATE  (VAL,SYM)
   419				        <IRP (SYM), <SYM==VAL>>
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 11
MAGCON.MAC	 6-JUL-77 09:25		*** DEFINITIONS ***

   420				DEFINE  CBLK    (CHAN,DEP)
   421				        <XLIST
   422				        ZZ==CHAN
   423				        REPEAT  DEP,
   424				        <YY==.
   425				        EXP     ZZ
   426				        BSS     TWO
   427				        EXP     .+12
   428				        BSS     4
   429				        OPEN    ZZ,.-7
   430				        LOOKUP  ZZ,.-5
   431				        IN      ZZ,ZERO
   432				        RELEASE ZZ,ZERO
   433				        INBUF   ZZ,ZERO
   434				        BSS     THREE
   435				        CCLCNT==.-YY
   436				        ZZ==ZZ+1>
   437				        PURGE   YY,ZZ
   438				        LIST>
   439
   440				DEFINE  DEVOP   (OP,CHAN,LOC)
   441				        <OFF    S,HUNG
   442				                XLIST
   443				        AOS     %IO
   444				        OP      CHAN,LOC
   445				                LIST>
   446
   447				;       THINGS WITH NO OTHER PLACE TO LIVE.
   448
   449		000501	446253	VERSION==0B2!5B11!1B17!'DRK'
   450			000134	.JBINT==134                     ;JNM...DO WE REALLY NEED THIS?
   451			400000	HGH==400000                             ;FOR USE MACRO.
   452			000000	LOW==000000                             ;FOR USE MACRO.
   453			400000	NEC==400000                             ;SAYS CHARACTER CAN'T BE CONVERTED.
   454			000011	WF==<JF==<CF==<HF==<DF==<MF==<UF==IF+1>+1>+1>+1>+1>+1>+1;       CHANNEL DEFINITIONS.
   455				IFNDEF CCLLEN, <CCLLEN==5>              ;NUMBER OF NESTING IN CCL FILES.
   456				IFNDEF TMPLEN, <TMPLEN==10>             ;LENGTH OF TEMPORARY STACK.
   457				IFNDEF PDPSIZ, <PDPSIZ==150>            ;PUSH-DOWN LIST SIZE.
   458				IFNDEF PATSIZ, <PATSIZ==100>            ;SIZE OF PATCH AREA.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 12
MAGCON.MAC	 6-JUL-77 09:25		*** IMPURE DATA AREA ***

   459				SUBTTL                  *** IMPURE DATA AREA ***
   460
   461	000000'			        USE     DATA
   462
   463				;       DATA AREA FOR MOD WORDS AND FILE SPECIFICATIONS.
   464
   465	000000'			FSTMEM: BSS     ONE                     ;WORD FOR CHANNEL NUMBER.
   466	000001'			OFILE:  BSS     ONE                     ;STATUS BITS FOR OPEN.
   467	000002'			        BSS     ONE                     ;DEVICE FOR OPEN.
   468	000003'			        BSS     ONE                     ;POINTER IN OUTPUT BUFFER HEADERS.
   469	000004'			        BSS     ONE                     ;FILE NAME.
   470	000005'			        BSS     ONE                     ;FILE EXTENSION.
   471	000006'			        BSS     ONE                     ;DATE TIME PROTECTION WORD.
   472	000007'			        BSS     ONE                     ;PROJECT-PROGRAM NUMBER.
   473	000010'			        BSS     ONE                     ;MOD WORD FOR OUTPUT DEVICE AND FILE.
   474	000011'			        BSS     ONE                     ;BLOCKING FACTOR.
   475	000012'			        BSS     ONE                     ;RECORD SIZE.
   476	000013'			        BSS     ONE                     ;NUMBER OF FILES TO ADVANCE.
   477	000014'			        BSS     ONE                     ;LABEL TYPE.
   478	000015'			        BSS     ONE                     ;MAG-TAPE DENSITY.
   479	000016'			        BSS     ONE                     ;VOLUME NUMBER.
   480	000017'			        BSS     ONE                     ;NOT USED.
   481	000020'			OUTMOD: BSS     ONE                     ;OUTPUT CHARACTER SET INDEX.
   482	000021'			OBLK:   BSS     ONE                     ;BLOCKS TO READ FOR BLKFCT.
   483	000022'			        BSS     ONE                     ;NUMBER OF BUFFERS TO USE.
   484	000023'			        BSS     ONE                     ;NUMBER OF FILES TO BACKSPACE.
   485	000024'			        BSS     ONE                     ;# OF BITS PER BYTE
   486	000025'			        BSS     TWO                     ;MASK WORDS FOR WILD CARDS
   487	000027'			        BSS     ONE                     ;FAST TAPE SWITCH
   488	000030'			        BSS     ONE                     ;WORD FOR CHANNEL NUMBER.
   489	000031'				BSS	ONE			;# OF RECORDS TO ADVANCE
   490	000032'			IFILE:  BSS     ONE                     ;STATUS BITS FOR OPEN.
   491	000033'			        BSS     ONE                     ;DEVICE FOR OPEN.
   492	000034'			        BSS     ONE                     ;POINTER TO INPUT BUFFER HEADERS.
   493	000035'			        BSS     ONE                     ;FILE NAME.
   494	000036'			        BSS     ONE                     ;EXTENSION.
   495	000037'			        BSS     ONE                     ;DATE TIME PROTECTION WORD.
   496	000040'			        BSS     ONE                     ;PROJECT-PROGRAM NUMBER.
   497	000041'			        BSS     ONE                     ;MOD WORD FOR INPUT SPECIFICATIONS.
   498	000042'			        BSS     ONE                     ;BLOCKING FACTOR.
   499	000043'			        BSS     ONE                     ;RECORD SIZE OR SIZE OF LARGEST BLOCK.
   500	000044'			        BSS     ONE                     ;NUMBER OF FILES TO ADVANCE.
   501	000045'			        BSS     ONE                     ;LABEL TYPE.
   502	000046'			        BSS     ONE                     ;MAG-TAPE DENSITY.
   503	000047'			        BSS     ONE                     ;VOLUME NUMBER FOR MAG-TAPE.
   504	000050'			        BSS     ONE                     ;NEW REEL NUMBER AFTER PERGE.
   505	000051'			INPMOD: BSS     ONE                     ;INPUT CHARACTER SET INDEX.
   506	000052'			IBLK:   BSS     ONE                     ;BLOCKS TO READ FOR BLKFCT.
   507	000053'			        BSS     ONE                     ;NUMBER OF BUFFERS TO USE.
   508	000054'			        BSS     ONE                     ;NUMBER OF FILES TO BACKSPACE.
   509	000055'			        BSS     ONE                     ;# OF BITS PER BYTE
   510	000056'			        BSS     TWO                     ;MASK WORDS FOR WILD CARDS.
   511	000060'			        BSS     ONE                     ;FAST TAPE SWITCH
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 12-2
MAGCON.MAC	 6-JUL-77 09:25		*** IMPURE DATA AREA ***

   512	000061'				BSS	ONE			;# OF RECORDS TO ADVANCE
   513	000062'			TELWRD: BSS     ONE                     ;ZERO IT TALKING.
   514	000063'			LSTWRD: BSS     ONE                     ;NON-ZERO IF LISTING.
   515	000064'			FSTWRD: BSS     ONE                     ;NON-ZERO IF FAST LIST.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 13
MAGCON.MAC	 6-JUL-77 09:25		*** IMPURE DATA AREA ***

   516				;BUFFERS AND SAVED LOCATIONS FOR THINGS.
   517
   518	000065'			BSS     INPBUF,^D21                     ;SAVE AREA FOR INPUT LABEL.
   519	000112'			BSS     OUTBUF,^D21                     ;SAVE AREA FOR OUTPUT LABEL.
   520	000137'			BSS     STACK,PDPSIZ                    ;PUSH-DOWN STACK.
   521	000307'			BSS     OBUF,3                          ;OUTPUT BUFFER HEADER.
   522	000312'			BSS     IBUF,3                          ;INPUT BUFFER HEADER.
   523	000315'			BSS     OIBUF,3                         ;OUTPUT-INPUT BUFFER AREA.
   524	000320'			BSS     BUFF,^D24                       ;OUTPUT-INPUT BUFFER.
   525	000350'			BSS	TORCNT,ONE			;TOTAL # RECORDS WRITTEN.
   526	000351'			BSS	TOBCNT,ONE			;TOTAL # BLOCKS WRITTEN.
   527	000352'			BSS	TIRCNT,ONE			;TOTAL # RECORDS READ.
   528	000353'			BSS	TIBCNT,ONE			;TOTAL # BLOCKS READ.
   529	000354'			BSS     ORCNT,ONE                       ;# RECORDS WRITTEN TO CURRENT FILE.
   530	000355'			BSS     OBCNT,ONE                       ;# BLOCKS WRITTEN TO CURRENT FILE.
   531	000356'			BSS     IRCNT,ONE                       ;# RECORDS READ FROM CURRENT FILE.
   532	000357'			BSS     IBCNT,ONE                       ;# BLOCKS READ FROM CURRENT FILE.
   533	000360'			BSS	OBCSAV,ONE			;SAVE BLOCK COUNT
   534	000361'			BSS     NOCHR,ONE                       ;NUMBER OF BAD CHARACTERS.
   535	000362'			BSS     RELNUM,ONE                      ;NUMBER OF MAG-TAPE REEL SET FROM LABEL.
   536	000363'			BSS     %IO,ONE                         ;NUMBER OF DEVICE ACESSES.
   537	000364'			BSS     %TIME,ONE                       ;RUN TIME.
   538	000365'			BSS     IFCNT,ONE                       ;INPUT FILE COUNT.
   539	000366'			BSS     OFCNT,ONE                       ;OUTPUT FILE COUNT.
   540	000367'			BSS     INPERR,ONE                      ;INPUT PARITY ERRORS.
   541	000370'			BSS     OTPERR,ONE                      ;OUTPUT PARITY ERRORS.
   542	000371'			BSS     SPCCNT,ONE                      ;COUNT OF CHARACTERS TYPED DURING COMMAND.
   543	000372'			BSS     ISEC,ONE                        ;NUMBER OF SECTORS READ.
   544	000373'			BSS     OSEC,ONE                        ;NUMBER OF SECTORS WRITTEN.
   545	000374'			BSS     TCH,ONE                         ;LAST CHARACTER READ.
   546	000375'			BSS     TEMP,ONE                        ;REGISTER FOR TEMPORARY STORAGE.
   547	000376'			BSS     TEMP1,ONE                       ;TEMPORARY REGISTER.
   548	000377'			BSS     LSTDEV,ONE                      ;LAST DISK DEVICE USED.
   549	000400'			BSS     SEARCH,ONE                      ;SAYS WE ARE SEARCHING.
   550	000401'			BSS     SYSSRH,ONE                      ;SAYS WE ARE USING DEVICE SYS.
   551	000402'			BSS     RUNFLG,ONE                      ;SAYS WE ARE DOING SOMETHING.
   552	000403'			BSS     RECPTR,ONE                      ;POINTER TO ALTER BUFFER.
   553	000404'			BSS     LSTPTR,ONE                      ;POINTER TO CTRL WORD.
   554	000405'			BSS     CURPTR,ONE                      ;CURRENT POINTER TO ALTER BUFFER.
   555	000406'			BSS     UNAME,TWO                       ;USED FOR USER NAME.
   556	000410'			BSS     TABPTR,ONE                      ;USED FOR PTR TO A TABLE WE WANT TO LIST.
   557	000411'			BSS     TABLST,ONE                      ;FLAG TO LIST OPTIONS.
   558	000412'			BSS     SP36M,ONE                       ;FLAG FOR SPECIAL 36-BIT MODE.
   559	000413'			BSS     ITEM,ONE
   560	000414'			BSS     ULTRAT,ONE                      ;FLAG THAT SAYS THIS IS AN ULTRA TEK TAPE
   561	000415'			BSS     RETCHR,ONE                      ;RETAIN ALL CHARACTERS FLAG
   562	000416'			BSS     DELBLK,ONE                      ;DELETE TRAILING SPACES FLAG
   563	000417'			BSS     SPCNT,ONE                       ;COUNT OF CONSECUTIVE SPACES BEFORE CR
   564	000420'			BSS     HIGHT,ONE       		;HIGHEST DENSITY FOR THIS HANDLER
   565	000421'			BSS     MIDT,ONE        		;MEDIUM DENSITY FOR THIS HANDLER
   566	000422'			BSS     LOWT,ONE        		;LOWEST DENSITY FOR THIS HANDLER
   567	000423'			BSS     TBSIZE,ONE      		;NUMBER OF ENTRIES IN THE INPUT CONVERSION TABLE
   568	000424'			BSS     SKPCHK,ONE      		;FLAG TO SKIP IF FILLING OUTPUT REC. W/SPACES-ASCII
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 13-2
MAGCON.MAC	 6-JUL-77 09:25		*** IMPURE DATA AREA ***

   569	000425'			BSS 	MOVCHO,ONE  			;NO. OF BITS TO ROTATE
   570	000426'			BSS 	MOVCHI,ONE  			;NO. OF BITS TO ROTATE
   571	000427'			BSS 	EXTCHO,ONE          		;EXTRA BITS,,# OF EXTRA BITS
   572	000430'			BSS 	EXTCHI,ONE  			;EXTRA BITS,, # OF EXTRA BITS
   573	000431'			BSS 	DISOUT,ONE  			;BYTE ADJUSTMENT COUNT
   574	000432'			BSS 	DISIN,ONE           		;BYTE ADJUSTMENT COUNT
   575	000433'			BSS	 SAVCH,ONE           		;SAVE REAL CHARACTER BEING TRANSLATED
   576	000434'			BSS 	WLDEXT,ONE				;USED FOR GENERATEING WILD EXT AND FILE AAME
   577	000435'			BSS 	WLDISK,ONE				;FLAG TO SEE IF INIT CHANNEL
   578	000436'			BSS	COLUMN,ONE				;POSITION OF CURSOR ON THE LINE (-1)
   579	000437'			BSS	CONVWD,TWO				;SAVE LOCATION FOR I/O CONVERSION WORDS.
   580			000446'	OMSAV5==.+5
   581	000441'			BSS	OMSAVE,^D11			;SAVE BUFFER FOR MODE TABLE
   582			000453'	LSTMEM==.-1                             ;LAST IMPURE LOCATION TO CLEAR.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 14
MAGCON.MAC	 6-JUL-77 09:25		*** IMPURE DATA AREA ***

   583				;STORAGE FOR THINGS THAT ARE RETAINED ACROSS RUNS.
   584
   585	000454'	777600	001242'	UFDARG:	-200,,UFDBUF			;ARGUMENT BLOCK FOR READING
   586	000455'				BSS	6			;UFD'S - INCLUDES UFDCNT.
   587	000463'			UFDCNT:	BSS	1
   588	000464'			UFDPTR:	BSS	1			;POINTER INTO UFDBUF.
   589	000465'	777600	001467'	MFDARG:	-200,,MFDBUF			;ARGUMENT BLOCK FOR READING MFD'S
   590	000466'	120000	000000		SIXBIT	/*/			;WILD CARD UFD NAME SEARCH.
   591	000467'	654644	000000		SIXBIT	/UFD/			;EXTENSION IS 'UFD'
   592	000470'				BSS	4
   593	000474'			MFDCNT:	BSS	1			;ENTRY COUNT RETURNED HERE.
   594	000475'			MFDPTR:	BSS	1			;POINTER INTO MFDBUF.
   595	000476'			BSS     AC,20                           ;SAVE AREA FOR THE AC'S.
   596	000516'			BSS     DATE,ONE                        ;DATE OF CRASH.
   597	000517'			BSS     TIME,ONE                        ;TIME OF CRASH.
   598	000520'			BSS     PRGNAM,ONE                      ;PROGRAM NAME.
   599	000521'	000000	000137'	XWD     ZERO,STACK                      ;LOCATION OF THE STACK.
   600	000522'			BSS     PC,ONE                          ;LOCATION OF CRASH.
   601	000523'			BSS     SYSNAM,4                        ;SYSTEM NAME.
   602	000527'			PATCH:  BSS     PAT,PATSIZ              ;PATCH AREA.
   603	000627'			BSS     LABSTR,ONE                      ;STRUCTURE FROM TAPE LABEL.
   604	000630'			BSS     LABNAM,TWO                      ;LABEL NAME TO TYPE ON ERROR.
   605	000632'			BSS     LABDTW,ONE                      ;DATE AND PROTECTION WORD.
   606	000633'			BSS     LABPPN,ONE                      ;PPN WORD FROM LABEL.
   607	000634'			BSS     LABSIZ,ONE                      ;SIZE OF FILE IN BLOCKS.
   608	000635'			BSS     LABVOL,ONE                      ;VOLUME NUMBER READ FROM LABEL.
   609	000636'			BSS     LABTOT,ONE                      ;TOTAL BLOCKS FOUND.
   610	000637'			BSS     LABCNT,ONE                      ;TOTAL FILES FOUND.
   611	000640'			BSS     PASS,TWO                        ;PASSWORD FOR GE LABELS.
   612	000642'			BSS     RETWRD,ONE                      ;RETAIN WORD.
   613	000643'			BSS     CMDLST,TWO                      ;DUMP MODE COMMAND LIST
   614	000645'			BSS     KLUDGE,ONE                      ;KLUDGE TO FIX STACK
   615	000646'			BSS     IJOBFF,ONE                      ;SAVE LOCATION FOR JOBFF.
   616	000647'			BSS     OJOBFF,ONE                      ;SAVE LOCATION FOR JOBFF.
   617	000650'			BSS     TRPBLK,TWO                      ;TRAP BLOCK FOR HUNG DEVICE.
   618	000652'			BSS     TRPPC,ONE                       ;PC WORD AT TRAP.
   619	000653'			BSS     TRPCHN,ONE                      ;CHANNEL THAT CAUSED TRAP.
   620	000654'			BSS     LSTSTR,ONE                      ;LAST STRUCTURE USED IN LIST.
   621	000655'			BSS     LSTPPN,ONE                      ;LAST PPN USED IN LIST.
   622	000656'			BSS     CCLFLG,ONE                      ;NONE ZERO IF USING CCL FILE.
   623	000657'			BSS     CCLCOR,ONE                      ;COPY OF JOBFF WHEN CCL FILE OPEN.
   624	000660'			BSS     DIAFLG,ONE                      ;RETURN ADDRESS FOR ERRORS IN DIALOG MODE.
   625	000661'			BSS     TBLKN,ONE                       ;NO. OF BLKS. TO TRANSFER
   626	000662'			BSS     SBLKN,ONE                       ;NO. OF BLKS. TO SKIP BEFORE TRANSFER
   627	000663'			BSS     MFILES,ONE                      ;NEGATIVE IF MULTIPLE FILE OUTPUT
   628	000664'			BSS     SAVPTR,ONE                      ;SAVE BUFFER HEADER POINTER
   629	000665'			BSS     SAVCNT,ONE                      ;SAVE BUFFER HEADER COUNT
   630	000666'			BSS     MTAWD,ONE               ;UGETF WORD FOR MTA TO GET DENSITIES
   631	000667'			BSS     SUBSTF,ONE              ;FLAG TO SAY WE HAD A SUBSTITUTION
   632	000670'			BSS     RPTFLG,ONE                      ;REPEAT FLAG
   633	000671'			BSS     SAVDEV,ONE              ;SAVE DEVICE JUST ENTERED
   634	000672'			BSS	SAVMOD,ONE		;SAVE MODE JUST ENTERED
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 15
MAGCON.MAC	 6-JUL-77 09:25		*** PROGRAM START AND INITIALIZATION ***

   635				SUBTTL                  *** PROGRAM START AND INITIALIZATION ***
   636
   637				;PROGRAM TO CONVERT BETWEEN CHARACTER SETS.
   638
   639				;
   640				;  VERSION INFORMATION.
   641				;  PLEASE SEE MAGCON.INF FOR INFORMATION ABOUT CHANGES AND FIXES.
   642				;
   643			000005	TYMSPC==5
   644			000002	TYMREL==2
   645				;V4-13    FAST EVEN PARITY HANDLING
   646				;V4-14    FIXES TSR 55593, OTHER CHANGES ALSO (1/77 A. GADOL)
   647				;V4-15    FIXES TSR 55585, OTHER CHANGES ALSO (2/77 A. GADOL)
   648				;V4-16	FIXES TSR 64430, OTHER CHANGES ALSO (2/77 A. GADOL)
   649				;V4-17	FIXES TSR 53705, OTHER CHANGES ALSO (3/77 A. GADOL)
   650				;V5-0	FIXES TSR'S 55596,64217,64357, OTHER CHANGES ALSO (4/77 A. GADOL)
   651	000137			        LOC 137
   652	000137	000005	000002	        XWD TYMSPC,TYMREL
   653	000673'			        RELOC
   654
   655	400000'			        USE     CODE
   656
   657		777777	777760	GETLIC==-20
   658			100000	OPRLIC==100000
   659
   660
   661	400000'	634740	000017	START:  TDZA    PDP,PDP                 ;NORMAL START.
   662	400001'	476000	000017	        SETOM   PDP                     ;CCL ENTRY.
   663	400002'	561140	777760	        HRROI T1,GETLIC
   664	400003'	047140	000041	        GETTAB T1,
   665	400004'	400140	000000	         SETZ T1,
   666	400005'	607140	100000	        TLNN T1,OPRLIC
   667				        GOTO [OUTSTR [ASCIZ /
   668				OPER LICENSE REQUIRED.
   669				/]
   670	400006'	254000	413537'	                EXIT]
   671	400007'	402000	000434'		SETZM	WLDEXT
   672	400010'	402000	000435'		SETZM	WLDISK
   673	400011'	331000	000017	        SKIPL PDP
   674	400012'	476000	000660'	        SETOM   DIAFLG          ;START OUT IN DIALOG MODE.
   675	400013'	201200	000003	        MOVEI   T2,THREE                ;GETTAB TABLE.
   676	400014'	047140	000030	        MME     T1,.PJOB                ;MY JOB NUMBER.
   677	400015'	504200	000003	        HRL     T2,T1                   ;XWD FOR GETTAB.
   678	400016'	047200	000041	        MME     T2,.TAB                 ;GET MY NAME.
   679	400017'	200200	413541'	        MOVE    T2,[SIXBIT "MAGCON"]    ;IF GETTAB FAILS.
   680	400020'	202200	000520'	        MOVEM   T2,PRGNAM               ;SAVE MY NAME.
   681	400021'	047000	000000	        MME     .RESET                  ;STOP THE WORLD.
   682	400022'	201140	400057'	        MOVEI   T1,NTHERE               ;PICK UP REENTER ADDRESS.
   683	400023'	202140	000000*	        MOVEM   T1,JOBREN               ;STORE IT IN PLACE.
   684	400024'	402000	000642'	        SETZM   RETWRD                  ;CLEAR RETAIN WORD.
   685	400025'	402000	002721'	        SETZM   DFFLG                   ;NO DATA FILE NOW.
   686	400026'	200140	413542'	        MOVE    T1,[GOSUB UME0]         ;SET UP UME DISPATCH INSTRUCTION.
   687	400027'	202140	000000*	        MOVEM   T1,JOB41                ;SAVE IT.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 15-2
MAGCON.MAC	 6-JUL-77 09:25		*** PROGRAM START AND INITIALIZATION ***

   688	400030'	402000	000656'	        SETZM   CCLFLG                  ;NOT USING CCL FILE NOW.
   689	400031'	322740	400036'	        JUMPE   PDP,START1              ;JUMP IF NOT CCL ENTRY.
   690	400032'	515140	446353	        HRLZI   T1,'DSK'                ;SET DEVICE FOR DATA FILE.
   691	400033'	202140	002724'	        MOVEM   T1,DATDEV+1             ;SET DEVICE.
   692	400034'	402000	002731'	        SETZM   DATFIL+3                ;CLEAR PPN WORD.
   693	400035'	254000	400057'	        GOTO    NTHERE                  ;YES CONTINUE ON.
   694	400036'	200740	413543'	START1: MOVE    PDP,[IOWD PDPSIZ,STACK] ;SET UP PUSH-DOWN POINTER.
   695	400037'	200140	000520'	        MOVE    T1,PRGNAM               ;GET OUR NAME.
   696	400040'	260740	410705'	        GOSUB   PUTSIX                  ;PRINT IT.
   697	400041'	051140	413544'	        EME     .STR,[ASCIZ " (V"]
   698	400042'	554300	000137	        HLRZ P1,137
   699	400043'	260740	410673'	        GOSUB PUTOCT
   700	400044'	051140	413545'	        EME     .STR,[ASCIZ "."]
   701	400045'	550300	000137	        HRRZ    P1,137
   702	400046'	260740	410673'	        GOSUB PUTOCT
   703	400047'	051140	413546'	        EME     .STR,[ASCIZ ") HERE AT "];SAY GOOD THINGS.
   704	400050'	047140	000023	        MME     T1,.TIME                ;GET THE TIME OF DAY.
   705	400051'	260740	411402'	        GOSUB   TYPTIM                  ;PRINT THE TIME OF DAY.
   706	400052'	051040	413551'	        EME     .CH,[EXP " "]           ;SEPARATE THINGS.
   707	400053'	047140	000014	        MME     T1,.DATE                ;GET THE DATE.
   708	400054'	260740	411363'	        GOSUB   TYPDAT                  ;PRINT THE DATE.
   709	400055'	260740	410441'	        GOSUB   CRLF                    ;SKIP A LINE.
   710	400056'	254000	400072'	        GOTO    NTH0                    ;START THINGS ROLLING.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 16
MAGCON.MAC	 6-JUL-77 09:25		*** PROGRAM START AND INITIALIZATION ***

   711				;HERE TO GET ANOTHER COMMAND.
   712
   713	400057'	051600	000000	NTHERE: ENABLE  TTY                     ;CLEAR CONTROL O.
   714	400061'	336000	000660'	        SKIPN   DIAFLG                  ;IF NOT DIALOG MODE,
   715	400062'	051140	413552'	        PRINT   (Ready.)
   716	400063'	402000	000436'	                ;TELL HIM WE'RE READY.
   717	400064'	051040	413554'	        EME     .CH,[EXP 12]            ;SKIP A LINE.
   718	400065'	200740	413543'	NTH1:   MOVE    PDP,[IOWD PDPSIZ,STACK] ;SET UP PUSH-DOWN POINTER.
   719	400066'	336000	000642'	        SKIPN   RETWRD                  ;SKIP IF RETAINING.
   720	400067'	254000	400072'	        GOTO    NTH0                    ;ELSE CARRY ON.
   721	400070'	476000	000642'	        SETOM   RETWRD                  ;FLAG NOT TO PERFORM COMMAND.
   722	400071'	334140	413555'	        SKIPA   T1,[XWD INPBUF,INPBUF+1];POINTER FOR PARTIAL BLT.
   723	400072'	200140	413556'	NTH0:   MOVE    T1,[XWD FSTMEM,FSTMEM+1];POINTER FOR INITIAL BLT.
   724	400073'	402003	777777	        SETZM   -1(T1)                  ;CLEAR FIRST WORD.
   725	400074'	251140	000453'	        BLT     T1,LSTMEM               ;DO IT.
   726	400075'	402000	000034'	        SETZM   IFILE+BUFFER            ;CLEAR BUFFER POINTER.
   727	400076'	402000	000003'	        SETZM   OFILE+BUFFER            ;CLEAR BUFFER POINTER.
   728	400077'	553000	000041'	        HRRZS   IFILE+MOD               ;CLEAR DEVICE MOD BITS.
   729	400100'	553000	000010'	        HRRZS   OFILE+MOD               ;CLEAR DEVICE MOD BITS.
   730	400101'	071100	000000	        RELEASE IF,ZERO                 ;RELEASE INPUT CHANNEL.
   731	400102'	071040	000000	        RELEASE OF,ZERO                 ;RELEASE OUTPUT CHANNEL.
   732	400103'	071300	000000	        RELEASE HF,ZERO                 ;RELEASE HELP FILE CHANNEL.
   733	400104'	071140	000000	        RELEASE UF,ZERO                 ;RELEASE UFD CHANNEL.
   734	400105'	071200	000000	        RELEASE MF,ZERO                 ;RELEASE MFD CHANNEL.
   735	400106'	200140	000657'	        MOVE    T1,CCLCOR               ;COPY OF JOBFF FOR CCL COMMAND.
   736	400107'	331000	000656'	        SKIPL   CCLFLG                  ;SKIP IF IN CCL COMMAND.
   737	400110'	554140	000000*	        HLRZ    T1,JOBSA                ;COPY SAVED JOBFF.
   738	400111'	202140	000000*	        MOVEM   T1,JOBFF                ;RESTORE IT.
   739	400112'	047140	000011	        MME     T1,.CORE                ;BACK TO START SIZE.
   740	400113'	255000	000000	        NOP                             ;IGNORE ERRORS.
   741	400114'	200140	413557'	        MOVE    T1,[SIXBIT "0001"]      ;RESET VOLUME NUMBER.
   742	400115'	202140	000047'	        MOVEM   T1,IFILE+VOL            ;INTO INPUT SPECS.
   743	400116'	202140	000016'	        MOVEM   T1,OFILE+VOL            ;INTO OUTPUT SPECS.
   744	400117'	201140	000002	        MOVEI   T1,IF                   ;GET INPUT CHANNEL NUMBER.
   745	400120'	202140	000031'	        MOVEM   T1,IFILE+CHAN           ;SAVE IT.
   746	400121'	201140	000001	        MOVEI   T1,OF                   ;GET THE OUTPUT CHANNEL NUMBER.
   747	400122'	202140	000000'	        MOVEM   T1,OFILE+CHAN           ;SAVE THE NUMBER.
   748	400123'	260740	412227'	        GOSUB   TRPSET                  ;SET UP TRAP BLOCK.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 17
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

   749				SUBTTL          *** COMMAND DECODER ***
   750
   751				;ENTER HERE TO DECODE A COMMAND STRING OF THE FORM:
   752				;ODEV:FILENAME.EXT(USERNAME)/X/Y_IDEV:FILENAME.EXT(USERNAME)/X/Y
   753
   754	400124'	332000	000660'	GETCOM: SKIPE   DIAFLG          ;IF WE WEREN'T IN DIALOG, DON'T GO BACK.
   755	400125'	254000	400302'	        GOTO    DIALOG          ;USE DIALOG AUTOMATICALLY.
   756	400126'	402000	000660'	        SETZM   DIAFLG                  ;CLEAR RETURN FLAG.
   757	400127'	051140	413560'	        EME     .STR,[ASCIZ "> "]       ;FLAG WE WANT A COMMAND.
   758	400130'	201000	000002	        MOVEI   S,TWO                   ;POSITION ON LINE.
   759	400131'	202000	000371'	        MOVEM   S,SPCCNT                ;SET THE SPACE COUNTER.
   760	400132'	402000	000000	        SETZM   S                       ;CLEAR THE FLAGS.
   761	400133'	201500	000001'	        MOVEI   SIDE,OFILE              ;SET DECODER INDEX.
   762	400134'	260740	402356'	        GOSUB   GETSIX                  ;GET A COMMAND WORD.
   763	400135'	606000	000040	        IF.OFF  S,EOL,CHKDEM            ;IF NOT END OF COMMAND JUMP.
   764	400137'	322540	400124'	        JUMPE   WD,GETCOM               ;JUMP IF THERE IS A COMMAND.
   765	400140'	202540	000376'	        MOVEM   WD,TEMP1                ;SAVE THE COMMAND WORD.
   766	400141'	200300	413561'	        MOVE    P1,[XWD -COMCNT,COMTAB] ;AOBJ WORD FOR TABLE.
   767	400142'	201340	412617'	        MOVEI   P2,COMDIS               ;COMMAND DISPATCH TABLE.
   768	400143'	254000	402370'	        GOTO    UNICOM                  ;GO FIND A UNIQUE COMMAND.
   769	400144'	336000	000642'	NOTCOM: SKIPN   RETWRD                  ;SKIP IF RETAINING.
   770	400145'	254000	410246'	        GOTO    COMERR                  ;ELSE COMMAND ERROR.
   771	400146'	334540	000376'	        SKIPA   WD,TEMP1                ;SKIP INTO GOODNESS.
   772	400147'	260740	402356'	GETWOD: GOSUB   GETSIX                  ;GET A COMMAND WORD.
   773	400150'	602000	000001	CHKDEM: IF.OFF  S,COL                   ;IS THE DEVICE BIT SET.
   774	400151'	260740	401722'	        GOSUB   GETDEV                  ;YES SET UP DEVICE.
   775	400152'	606000	000010	        IF.OFF S,BRK,CHK1
   776	400154'	260740	401756'	        GOSUB GETPPN
   777	400155'	602000	000002	CHK1:   IF.OFF  S,PER                   ;FILE NAME BIT.
   778	400156'	260740	401734'	        GOSUB   GETNAM                  ;GET THE FILE NAME.
   779	400157'	602000	000010	        IF.OFF  S,BRK                   ;IS THERE A PPN COMING.
   780	400160'	260740	401756'	        GOSUB   GETPPN                  ;YES READ IT IN.
   781	400161'	602000	040000	        IF.ON   S,ATS,CCLCOM            ;OPEN CCL FILE.
   782	400163'	602000	000004	SW.RET: IF.ON   S,SLH,GETSW             ;JUMP IF IT IS A SWITCH.
   783	400165'	602000	000020	        IF.ON   S,IO,RESYNC             ;IF _ OR = RECYCLE DECODER.
   784	400167'	602000	000040	        IF.ON   S,EOL,ENDCOM            ;IF END OF COMMAND JUMP.
   785	400171'	254000	410246'	        GOTO    COMERR                  ;ELSE ILLEGAL COMMAND.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 18
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

   786				;HERE ON AN EXIT COMMAND.
   787
   788	400172'	047000	000000	STOP:   MME     .RESET                  ;RESET THE WORLD.
   789	400173'	047040	000012	        MME     ONE,.TERM               ;AND STOP.
   790	400174'	254000	400000'	        GOTO    START                   ;IN CASE OF CONTINUE.
   791
   792				;HERE ON A DDT OR DEBUG COMMAND.
   793
   794	400175'	336140	000000*	DEBUG:  SKIPN   T1,JOBDDT               ;SKIP IF DDT IS HERE.
   795	400176'	254000	410261'	        GOTO    DDTERR                  ;TELL HIM WHAT IS WRONG.
   796	400177'	261740	413562'	CALDDT: SAVE    [NTHERE]                ;RETURN TO THE STACK.
   797	400200'	402000	000000*	        SETZM   JOBAPR                  ;DON'T ALLOW APR TRAPS.
   798	400201'	402000	000134	        SETZM   .JBINT                  ;DON'T ALLOW DEVICE TRAPS.
   799	400202'	051600	000000	DDTCAL: ENABLE  TTY                     ;CLEAR CONTROL O.
   800	400204'	260740	410441'	        GOSUB   CRLF                    ;SKIP A LINE.
   801	400205'	051140	413563'	        EME     .STR,[ASCIZ "DEBUGGER HERE"];TELL HIMM WHAT IS GOING ON.
   802	400206'	254003	000000	        GOTO    ZERO(T1)                ;CALL THE DEBUGGER.
   803
   804				;HERE ON A BYE COMMAND.
   805
   806	400207'	051440	000000	LOGOFF: EME     .CLR,ZERO               ;CLEAR THE TTY BUFFERS.
   807	400210'	260740	410441'	        GOSUB   CRLF                    ;SKIP A LINE.
   808	400211'	201140	413121'	        MOVEI   T1,LOGPRG               ;POINTER TO PARAMETERS.
   809	400212'	047140	000035	        MME     T1,.RUN                 ;RUN LOGOUT.
   810	400213'	254000	400172'	        GOTO    STOP                    ;THE MME FAILED.
   811
   812				;HERE ON A RETAIN COMMAND.
   813
   814	400214'	476000	000642'	RETAIN: SETOM   RETWRD                  ;FLAG RETAINED COMMAND.
   815	400215'	254000	400057'	        GOTO    NTHERE                  ;CONTINUE ON.
   816
   817				;HERE ON AN ERASE COMMAND.
   818
   819	400216'	402000	000642'	ERASE:  SETZM   RETWRD                  ;CLEAR RETAIN WORD.
   820	400217'	254000	400057'	        GOTO    NTHERE                  ;CONTINUE ON.
   821
   822				;HERE ON A REWIND COMMAND
   823
   824	400220'	201500	000032'	REWNOW: MOVEI   SIDE,IFILE              ;USE INPUT INFO.
   825	400221'	201140	000010	        MOVEI T1,10                     ;WHERE WE ARE ON THE LINE.
   826	400222'	202140	000371'	        MOVEM T1,SPCCNT                 ;SAVE THE COUNT
   827	400223'	051140	413566'	        EME     .STR,[ASCIZ "DEVICE: "]
   828	400224'	260740	402356'	        GOSUB   GETSIX
   829	400225'	606000	000001	        IF.OFF  S,COL,COMERR
   830	400227'	260740	401722'	        GOSUB   GETDEV                  ;GET DEVICE
   831	400230'	606000	000040	        IF.OFF  S,EOL,COMERR
   832	400232'	200152	000001	        MOVE    T1,DEVICE(SIDE)         ;GET DEVICE CHARS.
   833	400233'	322140	410246'	        JUMPE   T1,COMERR
   834	400234'	047140	000004	        MME     T1,.DEV
   835	400235'	607140	000020	        IF.OFF  T1,MTA,COMERR
   836	400237'	050100	000032'	        OPEN    IF,IFILE+STATUS
   837	400240'	254000	410246'	        GOTO    COMERR
   838	400241'	072100	000001	        DRIVE   IF,.REW                 ;REWIND IT.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 18-2
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

   839	400242'	071100	000000	        RELEASE IF,
   840	400243'	254000	400057'	        GOTO    NTHERE                  ;AND GET NEXT COMMAND
   841				;HERE ON A PERFORM COMMAND.
   842
   843	400244'	051040	413554'	PERFOR: EME     .CH,[EXP 12]            ;SKIP A LINE.
   844	400245'	200140	000520'	        MOVE    T1,PRGNAM               ;GET OUT NAME.
   845	400246'	260740	410705'	        GOSUB   PUTSIX                  ;PRINT IT.
   846	400247'	051040	413570'	        EME     .CH,[EXP 11]            ;TAB A LITTLE.
   847	400250'	047140	000023	        MME     T1,.TIME                ;GET THE TIME OF DAY.
   848	400251'	260740	411402'	        GOSUB   TYPTIM                  ;PRINT THE TIME.
   849	400252'	051040	413570'	        EME     .CH,[EXP 11]            ;TAB TO NEXT ZONE.
   850	400253'	047140	000014	        MME     T1,.DATE                ;GET THE DATE.
   851	400254'	260740	411363'	        GOSUB   TYPDAT                  ;TYPE THE DATE.
   852	400255'	260740	410441'	        GOSUB   CRLF                    ;SKIP A LINE.
   853	400256'	051040	413554'	        EME     .CH,[EXP 12]            ;SKIP A LINE.
   854	400257'	336000	000642'	        SKIPN   RETWRD                  ;SKIP IF THERE IS A COMMAND.
   855	400260'	254000	410232'	        GOTO    NOCOM                   ;TELL HIM NO GO.
   856	400261'	553000	000642'	        HRRZS   RETWRD                  ;FLAG THAT WE DO THIS ONE.
   857	400262'	336140	000666'	        SKIPN   T1,MTAWD                ;GET TAPE INFORMATION
   858	400263'	254000	400301'	        GOTO    PERFOY                  ;NO TAPES THEN SKIP FOLLOWING
   859	400264'	200440	000001'	        MOVE    P4,OFILE                ;GET STATUS BITS        
   860	400265'	602440	001000	        IF.ON   P4,EVEN,B5B12           ;LOOK AT FAST TAPE AND 7TK BITS
   861	400267'	200440	000032'	        MOVE    P4,IFILE
   862	400270'	606440	001000	        IF.OFF  P4,EVEN,PERFOY          ;NO EVEN HERE THEN ODD
   863	400272'	607140	010040	B5B12:  IF.OFF  T1,B5!B12,PERFOY        ;FAST TAPE AND 7TRK CONT CHECK
   864	400274'	200700	000051'	        MOVE    IM,INPMOD               ;GET INPUT MODE
   865	400275'	302700	413340'	        CAIE    IM,IMGMOD               ;IS IT IMAGE MODE?
   866	400276'	254000	400301'	        GOTO    PERFOY                  ;OFF TO WORK
   867	400277'	201640	413353'	        MOVEI   OM,OCTMOD
   868	400300'	202640	000020'	        MOVEM   OM,OUTMOD               ;SET OUTPUT MODE
   869	400301'	254000	402652'	PERFOY: GOTO    ENDCM0          	;AND DO IT.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 19
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

   870				;HERE FOR DIALOG MODE. DIALOG IS ENTERED BY TYPING ONLY
   871				;AN ALTMODE ON THE LINE. IT IS LEFT BY TYPING A CONTROL C
   872				;NOTE: ANY COMMAND UP TO THIS POINT IS ERASED.
   873
   874	400302'	256000	410441'	DIALOG:	XCT	CRLF			;SKIP A LINE.
   875	400303'	403000	000000'		SETZB	S,FSTMEM		;CLEAR FIRST MEMORY CELL.
   876	400304'	200140	413556'		MOVE	T1,[XWD FSTMEM,FSTMEM+1]	;BLT POINTER.
   877	400305'	251140	000453'		BLT	T1,LSTMEM		;CLEAR ANY RETAINED COMMAND.
   878	400306'	200140	413557'		MOVE	T1,[SIXBIT "0001"]	;VOLUME NUMBER EXPECTED.
   879	400307'	202140	000047'		MOVEM	T1,IFILE+VOL		;SET IT.
   880	400310'	202140	000016'		MOVEM	T1,OFILE+VOL		;IN BOTH SPECIFICATONS.
   881	400311'	403000	000642'		SETZB	S,RETWRD		;FLAG NOT TO RETAIN COMMAND.
   882	400312'	201500	000032'		MOVEI	SIDE,IFILE		;SET AN INDEX.
   883	400313'	256000	410441'		XCT	CRLF			;SKIP A LINE.
   884	400314'	051140	413571'		PRINT	(*** Input specifications ***)
   885	400315'	402000	000436'
   886	400316'	260740	400330'		GOSUB	DIAGET			;GET THE SPECS.
   887	400317'	201500	000001'		MOVEI	SIDE,OFILE		;SET AN INDEX.
   888	400320'	402000	000000		SETZM	S			;CLEAR A REGISTER.
   889	400321'	256000	410441'		XCT	CRLF			;SKIP A LINE.
   890	400322'	051140	413600'		PRINT	(*** Output specifications ***)
   891	400323'	402000	000436'
   892	400324'	260740	400330'		GOSUB	DIAGET			;GET THE SPEC.
   893	400325'	563000	000642'		HRROS	RETWRD			;FLAG COMMAND SHOULD BE RETAINED.
   894	400326'	476000	000660'		SETOM	DIAFLG			;CLEAR RETURN FLAG.
   895	400327'	254000	400244'		GOTO	PERFOR			;PERFORM THE COMMAND.
   896	400330'	201140	400330'	DIAGET:	DIARET	
   897							;SET RETURN ADDRESS.
   898	400332'	260740	401370'		GOSUB	DIA0			;GET FILE INFO
   899	400333'	606000	000040	DIAG1:	IF.OFF	S,EOL,COMERR		;COMMAND ERROR IF NOT EOL.
   900	400335'	200152	000001		MOVE	T1,DEVICE(SIDE)		;GET THE DEVICE.
   901	400336'	322140	400410'		JUMPE	T1,WBEDSK		;JUMP IF WILL BE DISK.
   902	400337'	047140	000004		MME	T1,.DEV			;SEE WHAT IT IS.
   903	400340'	261740	000003		SAVE	T1
   904	400341'	607140	000020		IF.OFF	T1,MTA,DIA1A		;IF NOT MAG TAPE, SKIP
   905	400343'	201140	000017		MOVEI	T1,17			;THE TAPE CHECKING.
   906	400344'	402000	000666'		SETZM	MTAWD			;KNOW WHAT WE START WITH
   907	400345'	200212	000001		MOVE	T2,DEVICE(SIDE)
   908	400346'	400240	000000		SETZ	T3,
   909	400347'	050140	000003		OPEN	T1,T1
   910					GOTO	[MOVE T2,SIDE		;TRY TO INIT THE DEVICE.
   911					XCT	QUES			;IF IT'S NOT AVAILABLE, TELL
   912	400350'	254000	413607'		GOTO	NODEV1]			;USER AND ASK QUESTIONS AGAIN.
   913	400351'	402000	000666'	DIAG2:	SETZM	MTAWD
   914	400352'	201140	000002		MOVEI	T1,2
   915	400353'	474200	000000		SETO	T2,
   916	400354'	073140	000003		UGETF	T1,T1			;GET THE PERTINENT INFO
   917	400355'	316200	413612'		CAMN	T2,[-1]			;CHECK FOR INFORMATION
   918	400356'	254000	400404'		GOTO	DIA1A-1			;UGETF FAILED SO TAKE WHATS THERE
   919	400357'	202200	000666'		MOVEM	T2,MTAWD		;SAVE THE RESULTS
   920	400360'	302500	000001'		CAIE	SIDE,OFILE		;IF WE ARE OPENING MAG TAPE
   921	400361'	254000	400375'		GOTO	DIAG3			;FOR OUTPUT, THEN CHECK
   922	400362'	607200	400000		TLNN	T2,E.LOK		;WRITE PROTECTION.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 19-2
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

   923	400363'	254000	400375'		GOTO	DIAG3			;EVERYTHING IS OK.
   924	400364'	201240	000015		MOVEI	T3,15			;TAPE IS WRITE PROTECTED.
   925	400365'	542240	000005'		HRRM	T3,OFILE+EXT		;TELL USER AND GIVE HER/HIM
   926	400366'	260740	410036'		GOSUB	TYPE			;A CHANCE TO CORRECT IT.
   927	400367'	051140	413613'		PRINT	(REMOUNT TAPE IF YOU WISH TO CONTINUE)
   928	400370'	402000	000436'
   929	400371'	051140	413623'		EME	.STR,[ASCIZ "CONTINUE? "]
   930	400372'	260740	401460'		GOSUB	YESNO			;SEE IF USER IS READY.
   931	400373'	254000	400351'		GOTO	DIAG2			;YES - RECHECK TAPE.
   932	400374'	254000	400330'		GOTO	DIAGET			;NO - ASK QUESTIONS AGAIN.
   933
   934	400375'	402012	000026	DIAG3:	SETZM	FSTTAP(SIDE)
   935	400376'	135240	413626'		LDB	T3,[POINT 1,T2,5]	;GET FAST TAPE BIT
   936	400377'	135200	413627'		LDB	T2,[POINT 1,T2,12]	;GET 7 TRACK BIT
   937	400400'	332000	000005		SKIPE	T3			;FAST TAPE?
   938	400401'	336000	000004		SKIPN	T2			;YES, 7 TRACK?
   939	400402'	334000	000000		SKIPA				;NO
   940	400403'	476012	000026		SETOM	FSTTAP(SIDE)		;YES
   941	400404'	071140	000000		RELEASE	T1,
   942	400405'	262740	000003	DIA1A:	UNSAVE	T1
   943	400406'	607140	200020		IF.OFF	T1,DSK!MTA,DIA6		;JUMP IF NOT A DIRECTORY DEVICE.
   944	400410'	201140	400410'	WBEDSK:	DIARET
   945	400412'	260740	401063'		GOSUB	Q2			;ASK ABOUT MODE
   946	400413'	260740	401100'	DIA3A:	GOSUB	Q3CLR			;CLEAR SPAN ATTRIBUTE.
   947	400414'	200152	000017		MOVE	T1,CHRMOD(SIDE)		;DON'T ASK SPAN QUESTION
   948	400415'	302140	413516'		CAIE	T1,VEBMOD		;IF THE MODE JUST SET
   949	400416'	306140	413366'		CAIN	T1,SIXMOD		;IS A VARIABLE LENGTH
   950	400417'	254000	400426'		GOTO	DIA3			;RECORD MODE, THEN SET
   951	400420'	303140	413325'		CAILE	T1,GEAMOD		;THE SPAN ATTRIBUTE.
   952	400421'	254000	400427'		GOTO	DIA4			;LEAVE CLEAR IF ANY
   953	400422'	201140	400422'		DIARET
   954	400424'	260740	401075'		GOSUB	Q3			;FIXED MODE.  ASK THE
   955	400425'	334000	000000		SKIPA				;QUESTION FOR ASCII MODES.
   956	400426'	260740	401077'	DIA3:	GOSUB	Q3SET
   957	400427'	260740	401153'	DIA4:	GOSUB	Q4SET			;SET NOCRLF (DEFAULT).
   958	400430'	200152	000017		MOVE	T1,CHRMOD(SIDE)		;DON' NEED TO ASK THE
   959	400431'	303140	413325'		CAILE	T1,GEAMOD		;CRLF QUESTION UNLESS
   960	400432'	254000	400436'		GOTO	DIA5			;IN AN ASCII MODE.
   961	400433'	201140	400433'		DIARET
   962	400435'	260740	401150'		GOSUB	Q4			;CR'S IN ASCII FILE?
   963	400436'	201140	400436'	DIA5:	DIARET
   964	400440'	200152	000017		MOVE	T1,CHRMOD(SIDE)		;NEED NOT ASK FOR
   965	400441'	302140	413353'		CAIE	T1,OCTMOD		;RECORD SIZE IF
   966	400442'	260740	401104'		GOSUB	Q5			;OCTAL MODE.
   967	400443'	201140	400443'		DIARET
   968	400445'	402012	000010		SETZM	BLKFCT(SIDE)		;BLOCK FACTOR DISK DEFAULT.
   969	400446'	200152	000001		MOVE	T1,DEVICE(SIDE)		;DON'T ASK BLOCK FACTOR
   970	400447'	047140	000004		MME	T1,.DEV			;GET DEVICE CHARACTERISTICS.
   971	400450'	603140	200000		IF.ON	T1,DSK,DIA6		;QUESTION FOR DISK OR
   972	400452'	350012	000010		AOS	BLKFCT(SIDE)		;DEFAULT FOR TAPES.
   973	400453'	200152	000007		MOVE	T1,MOD(SIDE)		;VARIABLE LENGTH RECORD
   974	400454'	260740	401131'		GOSUB	Q6			;BLOCKING FACTOR
   975	400455'	201140	400455'	DIA6:	DIARET
   976	400457'	260740	401141'		GOSUB	Q8			;STOP ON ERRORS?
   977	400460'	260740	401162'		GOSUB	Q9CLR			;DEFAULT HEADERS FOR LPT.
   978	400461'	510152	000001		HLLZ	T1,DEVICE(SIDE)		;GET THE DEVICE
   979	400462'	312140	413630'		CAME	T1,[SIXBIT /LPT/]	;GET ITS CHARACTERISTICS
   980	400463'	254000	400470'		GOTO	DIA11			;JUMP IF NOT LPT
   981	400464'	201140	400464'		DIARET
   982	400466'	260740	401157'		GOSUB	Q9			;HEADERS FOR LPT?
   983	400467'	254000	400571'		GOTO	CHKENT			;DONE WITH LPT INFO - ASK IF OK
   984	400470'	200152	000001	DIA11:	MOVE	T1,DEVICE(SIDE)		;GET DEVICE AND
   985	400471'	047140	000004		MME	T1,.DEV			;CHARACTERISTICS BACK.
   986	400472'	607140	000020		IF.OFF	T1,MTA,DIA22		;SKIP MTA STUFF IF NOT MTA
   987	400474'	402000	000414'		SETZM	ULTRAT			;SET NO ULTRA TECH TAPE.
   988	400475'	201140	400475'		DIARET
   989	400477'	260740	401173'		GOSUB	Q11			;DENSITY
   990	400500'	201140	400500'		DIARET
   991	400502'	135140	402216'		LDB	T1,DENPTR		;IF 9-TRACK TAPE, DEFAULT
   992	400503'	332000	000003		SKIPE	T1			;PARITY TO ODD, AND DON'T
   993	400504'	254000	400507'		GOTO	DIA12			;ASK THE PARITY
   994	400505'	260740	402032'		GOSUB	ODDRET			;QUESTION.
   995	400506'	334000	000000		SKIPA
   996	400507'	260740	401205'	DIA12:	GOSUB	Q12			;PARITY
   997	400510'	201140	400510'		DIARET
   998	400512'	260740	401217'		GOSUB	Q13			;ADVANCE FILES COUNTER
   999	400513'	201140	400513'		DIARET
  1000	400515'	402012	000027		SETZM	RECADV(SIDE)		;SET DEFAULT REC. ADVANCE.
  1001	400516'	302500	000032'		CAIE	SIDE,IFILE		;ONLY ASK Q14 IF
  1002	400517'	254000	400523'		GOTO	DIA15			;INPUTTING FROM TAPE.
  1003	400520'	200152	000017		MOVE	T1,CHRMOD(SIDE)		;ASK RECORD ADVANCE
  1004	400521'	302140	413340'		CAIE	T1,IMGMOD		;QUESTION UNLESS IN
  1005	400522'	260740	401241'		GOSUB	Q14			;IMAGE MODE.
  1006	400523'	201140	400523'	DIA15:	DIARET
  1007	400525'	260740	401251'		GOSUB	Q15			;WHEN TO REWIND
  1008	400526'	201140	400526'		DIARET
  1009	400530'	260740	401263'		GOSUB	Q16			;TAKE CARE OF TABLES
  1010	400531'	260740	401324'		GOSUB	Q18CLR			;SPECIAL 36 BIT MODE
  1011	400532'	260740	401332'		GOSUB	Q19CLR
  1012	400533'	200152	000017		MOVE	T1,CHRMOD(SIDE)		;IF IN AN 8-BIT
  1013	400534'	305140	413503'		CAIGE	T1,EBCMOD		;MODE, THEN SET UP AS
  1014	400535'	306140	413312'		CAIN	T1,HPAMOD		;INDUSTRY MODE, ELSE
  1015	400536'	260740	401331'		GOSUB	Q19SET			;CONTINUE ON.
  1016	400537'	201140	400537'		DIARET
  1017	400541'	260740	401336'		GOSUB	Q20
  1018	400542'	302500	000032'	DIA22:	CAIE	SIDE,IFILE
  1019	400543'	254000	400550'		GOTO	DIA7
  1020	400544'	201140	400544'		DIARET
  1021	400546'	260740	401344'		GOSUB	Q22			;MULTIPLE OUTPUT FILES
  1022	400547'	254000	400571'		GOTO	CHKENT
  1023	400550'	201140	400550'	DIA7:	DIARET
  1024	400552'	476000	000415'		SETOM	RETCHR
  1025	400553'	402000	000416'		SETZM	DELBLK
  1026	400554'	200152	000001		MOVE	T1,DEVICE(SIDE)
  1027	400555'	047140	000004		MME	T1,.DEV
  1028	400556'	607140	200000		IF.OFF	T1,DSK,CHKENT
  1029	400560'	200152	000017		MOVE	T1,CHRMOD(SIDE)
  1030	400561'	303140	413325'		CAILE	T1,GEAMOD
  1031	400562'	254000	400571'		GOTO	CHKENT
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 19-4
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1032	400563'	200140	000043'		MOVE	T1,RECSIZ+IFILE
  1033	400564'	313140	000012'		CAMLE	T1,RECSIZ+OFILE
  1034	400565'	260740	401354'		GOSUB	Q23
  1035	400566'	201140	400566'		DIARET
  1036	400570'	260740	401361'		GOSUB	Q24
  1037				CHKENT:	EME	.STR,[ASCIZ "
  1038	400571'	051140	413631'	ALL "]
  1039	400572'	306500	000032'		CAIN	SIDE,IFILE
  1040	400573'	051140	413633'		EME	.STR,[ASCIZ "INPUT "]
  1041	400574'	306500	000001'		CAIN	SIDE,OFILE
  1042	400575'	051140	413635'		EME	.STR,[ASCIZ "OUTPUT "]
  1043	400576'	051140	413637'		EME	.STR,[ASCIZ "ENTRIES CORRECT? "]
  1044	400577'	260740	401460'		GOSUB	YESNO
  1045	400600'	263740	412060'		RETURN	ZERO
  1046	400601'	201140	400601'	GITEM:	DIARET
  1047					EME	.STR,[ASCIZ "
  1048	400603'	051140	413643'	ITEM TO CHANGE: "]
  1049	400604'	201140	000020		MOVEI	T1,^D16
  1050	400605'	202140	000371'		MOVEM	T1,SPCCNT
  1051	400606'	660000	000001		ON	S,COL
  1052	400607'	260740	402311'		GOSUB	NUMVAL
  1053	400610'	202340	000413'		MOVEM	P2,ITEM
  1054	400611'	323340	400601'		JUMPLE	P2,GITEM
  1055	400612'	336027	401032'		SKIPN	@CTAB-2(P2)
  1056	400613'	254000	400601'		GOTO	GITEM
  1057	400614'	303340	000030		CAILE	P2,CMAX			;CHECK RANGE OF
  1058	400615'	254000	400601'		GOTO	GITEM			;ITEM NUMBER.
  1059	400616'	302340	000001		CAIE	P2,1
  1060	400617'	254000	400631'		GOTO	C1A
  1061	400620'	200152	000001		MOVE	T1,DEVICE(SIDE)
  1062	400621'	202140	000671'		MOVEM	T1,SAVDEV
  1063	400622'	201140	400622'		DIARET
  1064	400624'	260740	401370'		GOSUB	DIA0
  1065	400625'	200152	000001		MOVE	T1,DEVICE(SIDE)
  1066	400626'	316140	000671'		CAMN	T1,SAVDEV
  1067	400627'	254000	400571'		GOTO	CHKENT
  1068	400630'	254000	400333'		GOTO	DIAG1
  1069	400631'	200152	000001	C1A:	MOVE	T1,DEVICE(SIDE)
  1070	400632'	322140	400634'		JUMPE	T1,C1B
  1071	400633'	047140	000004		MME	T1,.DEV
  1072	400634'	254027	401032'	C1B:	GOTO	@CTAB-2(P2)		;JUMP TO ROUTINE.
  1073
  1074	400635'	607140	200020	C2:	IF.OFF	T1,DSK!MTA,GITEM
  1075	400637'	201140	400637'		DIARET
  1076	400641'	200212	000017		MOVE	T2,CHRMOD(SIDE)		;IF THE USER CHANGES THE
  1077	400642'	202200	000672'		MOVEM	T2,SAVMOD		;MODE SO IT IS DIFFERENT
  1078	400643'	260740	401063'		GOSUB	Q2			;FROM THE PREVIOUS ONE,
  1079	400644'	200152	000017		MOVE	T1,CHRMOD(SIDE)		;THEN GO BACK AND ASK
  1080	400645'	316140	000672'		CAMN	T1,SAVMOD		;THE REST OF THE DIALOG.
  1081	400646'	254000	400571'		GOTO	CHKENT
  1082	400647'	254000	400413'		GOTO	DIA3A
  1083	400650'	607140	200020	C3:	IF.OFF	T1,DSK!MTA,GITEM
  1084	400652'	201140	400652'		DIARET
  1085	400654'	260740	401075'		GOSUB	Q3
  1086	400655'	254000	400571'		GOTO	CHKENT
  1087	400656'	607140	200020	C4:	IF.OFF	T1,DSK!MTA,GITEM
  1088	400660'	201140	400660'		DIARET
  1089	400662'	200152	000017		MOVE	T1,CHRMOD(SIDE)
  1090	400663'	303140	413325'		CAILE	T1,GEAMOD		;UNLESS IN AN ASCII MODE,
  1091	400664'	254000	400601'		GOTO	GITEM			;DON'T ASK CRLF
  1092	400665'	260740	401150'		GOSUB	Q4			;QUESTION.
  1093	400666'	254000	400571'		GOTO	CHKENT
  1094	400667'	201140	400667'	C5:	DIARET
  1095	400671'	200152	000017		MOVE	T1,CHRMOD(SIDE)
  1096	400672'	306140	413353'		CAIN	T1,OCTMOD
  1097	400673'	254000	400601'		GOTO	GITEM
  1098	400674'	260740	401104'		GOSUB	Q5
  1099	400675'	254000	400571'		GOTO	CHKENT
  1100	400676'	603140	200000	C6:	IF.ON	T1,DSK,GITEM		;QUESTION IF DISK DEVICE
  1101	400700'	201140	400700'		DIARET
  1102	400702'	200152	000007		MOVE	T1,MOD(SIDE)		;OR VARIABLE RECORD
  1103	400703'	260740	401131'		GOSUB	Q6
  1104	400704'	254000	400571'		GOTO	CHKENT
  1105	400705'	201140	400705'	C8:	DIARET
  1106	400707'	260740	401141'		GOSUB	Q8
  1107	400710'	254000	400571'		GOTO	CHKENT
  1108	400711'	510152	000001	C9:	HLLZ	T1,DEVICE(SIDE)
  1109	400712'	312140	413630'		CAME	T1,[SIXBIT /LPT/]
  1110	400713'	254000	400601'		GOTO	GITEM
  1111	400714'	201140	400714'		DIARET
  1112	400716'	260740	401157'		GOSUB	Q9
  1113	400717'	254000	400571'		GOTO	CHKENT
  1114	400720'	200140	000020'		MOVE	T1,CHRMOD+OFILE
  1115	400721'	302500	000001'	C10:	CAIE	SIDE,OFILE
  1116	400722'	254000	400601'		GOTO	GITEM
  1117	400723'	200200	000020'		MOVE	T2,CHRMOD+OFILE
  1118	400724'	307200	413325'		CAIG	T2,GEAMOD
  1119	400725'	254000	400601'		GOTO	GITEM
  1120	400726'	200200	000051'		MOVE	T2,CHRMOD+IFILE
  1121	400727'	303200	413325'		CAILE	T2,GEAMOD
  1122	400730'	254000	400601'		GOTO	GITEM
  1123	400731'	200200	000041'		MOVE	T2,MOD+IFILE
  1124	400732'	254000	400736'		GOTO	C11T16
  1125	400733'	135200	402216'	C12:	LDB	T2,DENPTR
  1126	400734'	336000	000004		SKIPN	T2
  1127	400735'	254000	400601'		GOTO	GITEM
  1128	400736'	607140	000020	C11T16:	IF.OFF	T1,MTA,GITEM
  1129	400740'	201140	400740'		DIARET
  1130	400742'	200340	000413'		MOVE	P2,ITEM
  1131	400743'	260767	401003'		GOSUB	@QTAB-^D10(P2)
  1132	400744'	254000	400571'		GOTO	CHKENT
  1133	400745'	302500	000032'	C18:	CAIE	SIDE,IFILE
  1134	400746'	254000	400601'		GOTO	GITEM
  1135	400747'	607140	000020	C18T19:	IF.OFF	T1,MTA,GITEM
  1136	400751'	201140	400751'		DIARET
  1137	400753'	200152	000017		MOVE	T1,CHRMOD(SIDE)
  1138	400754'	305140	413503'		CAIGE	T1,EBCMOD
  1139	400755'	306140	413312'		CAIN	T1,HPAMOD
  1140	400756'	334000	000000		SKIPA
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 19-6
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1141	400757'	254000	400601'		GOTO	GITEM
  1142	400760'	200340	000413'		MOVE	P2,ITEM
  1143	400761'	260767	401003'		GOSUB	@QTAB-^D10(P2)
  1144	400762'	254000	400571'		GOTO	CHKENT
  1145	400763'	607140	000020	C20:	IF.OFF	T1,MTA,GITEM
  1146	400765'	201140	400765'		DIARET
  1147	400767'	260740	401336'		GOSUB	Q20
  1148	400770'	254000	400571'		GOTO	CHKENT
  1149	400771'	201140	400771'	C22:	DIARET
  1150	400773'	302500	000032'		CAIE	SIDE,IFILE
  1151	400774'	254000	400601'		GOTO	GITEM
  1152	400775'	260740	401344'		GOSUB	Q22
  1153	400776'	254000	400571'		GOTO	CHKENT
  1154	400777'	200200	000043'	C23:	MOVE	T2,RECSIZ+IFILE
  1155	401000'	317200	000012'		CAMG	T2,RECSIZ+OFILE
  1156	401001'	254000	400601'		GOTO	GITEM
  1157	401002'	603140	200000	C23T24:	IF.OFF	T1,DSK
  1158	401003'	302500	000001'		CAIE	SIDE,OFILE
  1159	401004'	254000	400601'		GOTO	GITEM
  1160	401005'	200152	000017		MOVE	T1,CHRMOD(SIDE)
  1161	401006'	303140	413325'		CAILE	T1,GEAMOD
  1162	401007'	254000	400601'		GOTO	GITEM
  1163	401010'	201140	401010'		DIARET
  1164	401012'	200340	000413'		MOVE	P2,ITEM
  1165	401013'	260767	401003'		GOSUB	@QTAB-^D10(P2)
  1166	401014'	254000	400571'		GOTO	CHKENT
  1167
  1168	401015'	000000	401166'	QTAB:	Q10
  1169	401016'	000000	401173'		Q11
  1170	401017'	000000	401205'		Q12
  1171	401020'	000000	401217'		Q13
  1172	401021'	000000	401241'		Q14
  1173	401022'	000000	401251'		Q15
  1174	401023'	000000	401263'		Q16
  1175	401024'	000000	000000		0
  1176	401025'	000000	401321'		Q18
  1177	401026'	000000	401327'		Q19
  1178	401027'	000000	401336'		Q20
  1179	401030'	000000	000000		0
  1180	401031'	000000	401344'		Q22
  1181	401032'	000000	401354'		Q23
  1182	401033'	000000	401361'		Q24
  1183
  1184			000030	CMAX==	^D24
  1185	401034'	000000	400635'	CTAB:	C2
  1186	401035'	000000	400650'		C3
  1187	401036'	000000	400656'		C4
  1188	401037'	000000	400667'		C5
  1189	401040'	000000	400676'		C6
  1190	401041'	000000	000000		0
  1191	401042'	000000	400705'		C8
  1192	401043'	000000	400711'		C9
  1193	401044'	000000	400721'		C10
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 19-7
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1194	401045'	000000	400736'		C11T16
  1195	401046'	000000	400733'		C12
  1196	401047'	000000	400736'		C11T16
  1197	401050'	000000	400736'		C11T16
  1198	401051'	000000	400736'		C11T16
  1199	401052'	000000	400736'		C11T16
  1200	401053'	000000	000000		0
  1201	401054'	000000	400745'		C18
  1202	401055'	000000	400747'		C18T19
  1203	401056'	000000	400763'		C20
  1204	401057'	000000	000000		0
  1205	401060'	000000	400771'		C22
  1206	401061'	000000	400777'		C23
  1207	401062'	000000	401002'		C23T24
  1208
  1209	401063'	201140	000011	Q2:	MOVEI	T1,^D9			;PLACE ON LINE.
  1210	401064'	202140	000371'		MOVEM	T1,SPCCNT		;SAVE IT.
  1211	401065'	350000	000411'		AOS	TABLST			;SET LIST OPTION FLAG.
  1212	401066'	051140	413647'		EME	.STR,[ASCIZ "2. MODE: "]	;ASK FOR THE MODE.
  1213	401067'	660000	000001		ON	S,COL			;SO WE THINK A COLON WAS TYPED.
  1214	401070'	260740	402062'		GOSUB	SW.M+2			;GET THE MODE.
  1215	401071'	402000	000411'		SETZM	TABLST
  1216	401072'	606000	000040		IF.OFF	S,EOL,COMERR		;JUMP IF NOT EOL.
  1217	401074'	263740	412060'		RETURN	ZERO
  1218
  1219	401075'	051140	413651'	Q3:	EME	.STR,[ASCIZ "3. VARIABLE LENGTH RECORDS? "]
  1220	401076'	260740	401460'		GOSUB	YESNO			;GET THE ANSWER.
  1221	401077'	334140	413657'	Q3SET:	SKIPA	T1,[IORM T2,MOD(SIDE)]	;IF YES,SET BIT.
  1222	401100'	200140	413660'	Q3CLR:	MOVE	T1,[ANDCAM T2,MOD(SIDE)]	;SET UP TO CLEAR.
  1223	401101'	201200	000040		MOVEI	T2,SPAN			;GET THE BIT.
  1224	401102'	256000	000003		XCT	T1			;SET OR CLEAR IT.
  1225	401103'	263740	412060'		RETURN	ZERO
  1226
  1227	401104'	200152	000007	Q5:	MOVE	T1,MOD(SIDE)
  1228	401105'	602140	000040		IF.OFF	T1,SPAN
  1229	401106'	254000	401117'		GOTO	Q5A
  1230	401107'	201140	000020	Q5B:	MOVEI	T1,^D16			;WHERE WE ARE ON LINE.
  1231	401110'	202140	000371'		MOVEM	T1,SPCCNT		;SAVE THE COUNT.
  1232	401111'	051140	413661'		EME	.STR,[ASCIZ "5. RECORD SIZE: "]
  1233	401112'	660000	000001		ON	S,COL			;SO A COL IS SEEN.
  1234	401113'	260740	402102'		GOSUB	SW.R+2			;GET THE RECORD SIZE.
  1235	401114'	606000	000040		IF.OFF	S,EOL,COMERR		;JUMP IF NOT EOL
  1236	401116'	263740	412060'		RETURN	ZERO
  1237
  1238	401117'	201140	000030	Q5A:	MOVEI	T1,^D24			;WHERE WE ARE ON LINE
  1239	401120'	202140	000371'		MOVEM	T1,SPCCNT		;SAVE COUNT
  1240	401121'	051140	413665'		EME	.STR,[ASCIZ "5A. MAXIMUM RECORD SIZE: "]
  1241	401122'	660000	000001		ON	S,COL			;SAY A COLON WAS SEEN
  1242	401123'	260740	402102'		GOSUB	SW.R+2			;GET AND SAVE THE RECORD SIZE
  1243	401124'	336012	000010		SKIPN	BLKFCT(SIDE)		;MAKE DEFAULT BLOCK
  1244	401125'	350012	000010		AOS	BLKFCT(SIDE)		;FACTOR = 1.
  1245	401126'	606000	000040		IF.OFF	S,EOL,COMERR		;JUMP IF NOT EOL
  1246	401130'	263740	412060'		RETURN	ZERO
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 19-8
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1247
  1248	401131'	201140	000024	Q6:	MOVEI	T1,^D20			;PLACE ON LINE.
  1249	401132'	202140	000371'		MOVEM	T1,SPCCNT		;FOR ERROR ROUTINE.
  1250	401133'	051140	413673'		EME	.STR,[ASCIZ "6. BLOCKING FACTOR: "]
  1251	401134'	660000	000001		ON	S,COL			;SO WE THINK A COLON WAS TYPED.
  1252	401135'	260740	402075'		GOSUB	SW.B+2			;GET THE BLOCKING FACTOR.
  1253	401136'	606000	000040		IF.OFF	S,EOL,COMERR		;JUMP IF NOT EOL
  1254	401140'	263740	412060'		RETURN	ZERO
  1255
  1256				;Q7:    MOVEI   T1,^D12                 ;PLACE ON LINE.
  1257				;       MOVEM   T1,SPCCNT               ;SAVE THE LINE POSITION.
  1258				;       EME     .STR,[ASCIZ "7. BUFFERS: "]     ;ASK HOW MANY BUFFERS.
  1259				;       ON      S,COL                   ;FLAG TO GET ARGUMENT.
  1260				;       GOSUB   SW.BUF+2                        ;GET THE BUFFER SWITCH.
  1261				;       IF.OFF  S,EOL,COMERR                    ;IF NOT EOL.
  1262				;       RETURN  ZERO
  1263
  1264	401141'	402000	000016	Q8:	SETZM	IM			;CLEAR A REGISTER.
  1265	401142'	051140	413700'		EME	.STR,[ASCIZ "8. STOP ON ERRORS? "]
  1266	401143'	260740	401460'		GOSUB	YESNO			;GET A REPLY.
  1267	401144'	334000	000000		SKIPA
  1268	401145'	660700	000020		ON	IM,NOERROR		;LIGHT A BIT.
  1269	401146'	436712	000007		IORM	IM,MOD(SIDE)
  1270	401147'	263740	412060'		RETURN	ZERO
  1271
  1272	401150'	051140	413704'	Q4:	EME	.STR,[ASCIZ "4. CRLF'S IN ASCII FILE? "]
  1273	401151'	260740	401460'		GOSUB	YESNO			;GET A REPLY.
  1274	401152'	334140	413660'	Q4CLR:	SKIPA	T1,[ANDCAM T2,MOD(SIDE)]	;SET UP TO CLEAR.
  1275	401153'	200140	413657'	Q4SET:	MOVE	T1,[IORM T2,MOD(SIDE)]	;IF YES,SET BIT.
  1276	401154'	201200	040000		MOVEI	T2,NOCRLF		;GET THE BIT.
  1277	401155'	256000	000003		XCT	T1			;SET OR CLEAR IT.
  1278	401156'	263740	412060'		RETURN	ZERO
  1279
  1280	401157'	051140	413712'	Q9:	EME	.STR,[ASCIZ "9. HEADERS FOR LPT? "]
  1281	401160'	260740	401460'		GOSUB	YESNO			;GET A REPLY.
  1282	401161'	334140	413660'	Q9SET:	SKIPA	T1,[ANDCAM T2,MOD(SIDE)]	;SET UP TO CLEAR.
  1283	401162'	200140	413657'	Q9CLR:	MOVE	T1,[IORM T2,MOD(SIDE)]	;IF YES,SET BIT.
  1284	401163'	201200	000004		MOVEI	T2,NOHEAD		;GET THE BIT.
  1285	401164'	256000	000003		XCT	T1			;SET OR CLEAR IT.
  1286	401165'	263740	412060'		RETURN	ZERO			;AND RETURN.
  1287
  1288	401166'	051140	413717'	Q10:	EME	.STR,[ASCIZ "10. IS THIS AN ULTRA TECH TAPE? "]
  1289	401167'	402000	000414'		SETZM	ULTRAT
  1290	401170'	260740	401460'		GOSUB	YESNO
  1291	401171'	476000	000414'		SETOM	ULTRAT
  1292	401172'	263740	412060'		RETURN	ZERO
  1293
  1294	401173'	201140	000015	Q11:	MOVEI	T1,^D13			;PLACE ON LINE.
  1295	401174'	202140	000371'		MOVEM	T1,SPCCNT		;SAVE THE SPACE COUNT.
  1296	401175'	350000	000411'		AOS	TABLST			;SET LIST OPTION FLAG.
  1297	401176'	051140	413726'		EME	.STR,[ASCIZ "11. DENSITY: "]	;ASK FOR THE TAPES DENSITY.
  1298	401177'	660000	000001		ON	S,COL			;TO FLAG ARGUMENT.
  1299	401200'	260740	402157'		GOSUB	SW.D+2			;READ IT IN.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 19-9
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1300	401201'	402000	000411'		SETZM	TABLST
  1301	401202'	606000	000040		IF.OFF	S,EOL,COMERR		;JUMP IF NOT EOL
  1302	401204'	263740	412060'		RETURN	ZERO
  1303
  1304	401205'	201140	000014	Q12:	MOVEI	T1,^D12			;PLACE ON LINE.
  1305	401206'	202140	000371'		MOVEM	T1,SPCCNT		;SAVE THE COUNTER.
  1306	401207'	350000	000411'		AOS	TABLST			;SET LIST OPTION FLAG.
  1307	401210'	051140	413731'		EME	.STR,[ASCIZ "12. PARITY: "]	;ASK FOR PARITY.
  1308	401211'	660000	000001		ON	S,COL			;TO FLAG ARGUMENT.
  1309	401212'	260740	402025'		GOSUB	SW.P+2			;AND GET IT.
  1310	401213'	402000	000411'		SETZM	TABLST
  1311	401214'	606000	000040		IF.OFF	S,EOL,COMERR		;JUMP IF NOT EOL
  1312	401216'	263740	412060'		RETURN	ZERO
  1313
  1314	401217'	201140	000023	Q13:	MOVEI	T1,^D19			;PLACE ON LINE.
  1315	401220'	202140	000371'		MOVEM	T1,SPCCNT		;SAVE FOR ERROR ROUTINE.
  1316	401221'	051140	413734'		EME	.STR,[ASCIZ "13. ADVANCE FILES: "]	;ASK FOR AN ADVANCE COUNTER.
  1317	401222'	660000	000001		ON	S,COL			;TO FLAG ARGUMENT.
  1318	401223'	260740	402107'		GOSUB	SW.A+2			;READ IT IN.
  1319	401224'	606000	000040		IF.OFF	S,EOL,COMERR		;ERROR IF NOT EOL
  1320	401226'	322340	401231'		JUMPE	P2,.+3
  1321	401227'	402012	000022		SETZM	BACSPC(SIDE)
  1322	401230'	263740	412060'		RETURN	ZERO
  1323
  1324	401231'	201140	000017		MOVEI	T1,^D15			;PLACE ON LINE.
  1325	401232'	202140	000371'		MOVEM	T1,SPCCNT		;SET COUNTER.
  1326	401233'	051140	413740'		EME	.STR,[ASCIZ "    BACKSPACE: "]	;TELL HIM WE WANT BACKSPACE ARGUMENT.
  1327	401234'	660000	000001		ON	S,COL			;SET COL BIT.
  1328	401235'	260740	402114'		GOSUB	SW.BK+2			;GET AN ARGUMENT.
  1329	401236'	606000	000040		IF.OFF	S,EOL,COMERR		;JUMP IF NOT EOL.
  1330	401240'	263740	412060'		RETURN	ZERO
  1331
  1332	401241'	201140	000025	Q14:	MOVEI	T1,^D21			;PLACE ON LINE.
  1333	401242'	202140	000371'		MOVEM	T1,SPCCNT		;SET COUNTER.
  1334	401243'	051140	413744'		EME	.STR,[ASCIZ "14. ADVANCE RECORDS: "]
  1335	401244'	660000	000001		ON	S,COL			;TO FLAG ARGUMENT.
  1336	401245'	260740	402121'		GOSUB	SW.AR+2			;GET AN ARGUMENT.
  1337	401246'	606000	000040		IF.OFF	S,EOL,COMERR		;ERROR IF NOT EOL.
  1338	401250'	263740	412060'		RETURN	ZERO
  1339
  1340	401251'	201140	000014	Q15:	MOVEI	T1,^D12			;PLACE ON LINE.
  1341	401252'	202140	000371'		MOVEM	T1,SPCCNT		;SAVE IT.
  1342	401253'	350000	000411'		AOS	TABLST			;SET LIST OPTION FLAG.
  1343	401254'	051140	413751'		EME	.STR,[ASCIZ "15. REWIND: "]	;ASK IF DOESN'T WANT TO WIND.
  1344	401255'	660000	000001		ON	S,COL			;FLAG WE HAVE SEEN A COLON.
  1345	401256'	260740	402141'		GOSUB	NOREW			;SET THE SWITCH.
  1346	401257'	402000	000411'		SETZM	TABLST
  1347	401260'	606000	000040		IF.OFF	S,EOL,COMERR		;JUMP IF NOT EOL.
  1348	401262'	263740	412060'		RETURN	ZERO
  1349
  1350	401263'	201140	000013	Q16:	MOVEI	T1,^D11			;PLACE ON LINE.
  1351	401264'	202140	000371'		MOVEM	T1,SPCCNT		;SAVE CHARACTER POSITION.
  1352	401265'	350000	000411'		AOS	TABLST			;SET LIST OPPTION FLAG.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 19-10
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1353	401266'	051140	413754'		EME	.STR,[ASCIZ "16. LABEL: "]	;ASK FOR LABEL TYPE.
  1354	401267'	660000	000001		ON	S,COL			;ARGUMENT IS NEXT.
  1355	401270'	260740	402174'		GOSUB	SW.L+2			;READ THE LABEL TYPE.
  1356	401271'	402000	000411'		SETZM	TABLST
  1357	401272'	606000	000040		IF.OFF	S,EOL,COMERR		;JUMP IF NOT END OF LINE.
  1358	401274'	322440	401320'		JUMPE	P4,DIA4Y		;JUMP IF NO LABEL TYPE.
  1359	401275'	302500	000001'		CAIE	SIDE,OFILE		;SKIP IF OUTPUT SPEC.
  1360	401276'	254000	401307'		GOTO	DIA4X			;DON'T ASK FOR REEL ON INPUT.
  1361	401277'	201140	000012		MOVEI	T1,^D10			;PLACE ON LINE.
  1362	401300'	202140	000371'		MOVEM	T1,SPCCNT		;SAVE POINTER.
  1363	401301'	051140	413757'		EME	.STR,[ASCIZ "    REEL: "]	;ASK FOR REEL NUMBER.
  1364	401302'	660000	000001		ON	S,COL			;TO FLAG ARGUMENT.
  1365	401303'	260740	402206'		GOSUB	SW.RL+2			;READ IT.
  1366	401304'	606000	000040		IF.OFF	S,EOL,COMERR		;JUMP IF DIDN'T END RIGHT.
  1367	401306'	254000	401320'		GOTO	DIA4Y
  1368	401307'	200152	000007	DIA4X:	MOVE	T1,MOD(SIDE)
  1369	401310'	306500	000032'		CAIN	SIDE,IFILE
  1370	401311'	602140	007300		IF.ON	T1,WILD,DIA4Y
  1371	401313'	402000	000016		SETZM	IM
  1372	401314'	051140	413762'		EME	.STR,[ASCIZ "    SCAN TAPE FOR FILE? "]
  1373	401315'	260740	401460'		GOSUB	YESNO			;GET A REPLY
  1374	401316'	660700	000400		ON	IM,SCAN			;SET SCAN BIT
  1375	401317'	436712	000007		IORM	IM,MOD(SIDE)		;SET THE MODE BITS.
  1376	401320'	263740	412060'	DIA4Y:	RETURN	ZERO
  1377
  1378	401321'	051140	413767'	Q18:	EME	.STR,[ASCIZ "18. SPECIAL 36-BIT MODE? "]
  1379	401322'	260740	401460'		GOSUB	YESNO
  1380	401323'	334140	413775'	Q18SET:	SKIPA	T1,[SETOM SP36M]	;SET THE BIT.
  1381	401324'	200140	413776'	Q18CLR:	MOVE	T1,[SETZM SP36M]	;CLEAR IT.
  1382	401325'	256000	000003		XCT	T1			;DO THE OPERATION.
  1383	401326'	263740	412060'		RETURN	ZERO
  1384
  1385	401327'	051140	413777'	Q19:	EME	.STR,[ASCIZ "19. INDUSTRY TAPE? "]
  1386	401330'	260740	401460'		GOSUB	YESNO			;GET A REPLY.
  1387	401331'	334140	413657'	Q19SET:	SKIPA	T1,[IORM T2,MOD(SIDE)]
  1388	401332'	200140	413660'	Q19CLR:	MOVE	T1,[ANDCAM T2,MOD(SIDE)]
  1389	401333'	201200	000010		MOVEI	T2,IND
  1390	401334'	256000	000003		XCT	T1
  1391	401335'	263740	412060'		RETURN	ZERO
  1392
  1393	401336'	402000	000016	Q20:	SETZM	IM
  1394	401337'	051140	414003'		EME	.STR,[ASCIZ "20. UNLOAD TAPE? "]
  1395	401340'	260740	401460'		GOSUB	YESNO
  1396	401341'	660700	000002		ON	IM,UNLOAD		;SET A BIT
  1397	401342'	436712	000007		IORM	IM,MOD(SIDE)
  1398	401343'	263740	412060'		RETURN	ZERO
  1399
  1400	401344'	051140	414007'	Q22:	EME	.STR,[ASCIZ "22. MULTIPLE OUTPUT FILES FOR THIS INPUT FILE? "]
  1401	401345'	402000	000663'		SETZM	MFILES
  1402	401346'	260740	401460'		GOSUB	YESNO			;GET A REPLY
  1403	401347'	334000	000000		SKIPA
  1404	401350'	263740	412060'		RETURN	ZERO
  1405	401351'	260740	401441'		GOSUB	SETBLK			;YES, SET UP INFO
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 19-11
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1406	401352'	476000	000663'		SETOM	MFILES
  1407	401353'	263740	412060'		RETURN	ZERO			;RETURN.
  1408
  1409	401354'	051140	414021'	Q23:	EME	.STR,[ASCIZ "23. ONLY 1 OUTPUT RECORD PER INPUT RECORD? "]
  1410	401355'	402000	000415'		SETZM	RETCHR
  1411	401356'	260740	401460'		GOSUB	YESNO
  1412	401357'	476000	000415'		SETOM	RETCHR
  1413	401360'	263740	412060'		RETURN	ZERO
  1414
  1415	401361'	051140	414032'	Q24:	EME	.STR,[ASCIZ "24. DELETE TRAILING BLANKS? "]
  1416	401362'	402000	000417'		SETZM	SPCNT
  1417	401363'	260740	401460'		GOSUB	YESNO
  1418	401364'	334140	414040'	Q24SET:	SKIPA	T1,[SETOM DELBLK]
  1419	401365'	200140	414041'	Q24CLR:	MOVE	T1,[SETZM DELBLK]
  1420	401366'	256000	000003		XCT	T1
  1421	401367'	263740	412060'		RETURN	ZERO
  1422
  1423	401370'			Q1:
  1424	401370'	201140	000006	DIA0:	MOVEI   T1,6			;PLACE ON LINE
  1425	401371'	202140	000371'		MOVEM	T1,SPCCNT		;FOR ERROR ROUTINE
  1426	401372'	402012	000003		SETZM	NAME(SIDE)
  1427	401373'	402012	000004		SETZM	EXT(SIDE)
  1428	401374'	051140	414042'		EME	.STR,[ASCIZ "1. FILE: "]	;ASK FOR DEV:FILE.EXT(USERNAME).
  1429	401375'	260740	402356'	DIA0B:	GOSUB	GETSIX			;GET A SIXBIT WORD
  1430	401376'	306600	000041		CAIN	CH,"!"			;IF A "!" IS FOUND,
  1431	401377'	254000	401435'		GOTO	OUTDIA			;LEAVE DIALOG MODE
  1432	401400'	602000	000010		IF.OFF	S,BRK
  1433	401401'	260740	401756'		GOSUB	GETPPN			;IF "(" FOUND, GET USER NAME
  1434	401402'	606000	000001		TRNN	S,COL			;IF ":" FOUND, GET DEVICE
  1435					GOTO	[MOVSI T1,'DSK'		;IF NOT, SUPPLY IT
  1436					MOVEM	T1,DEVICE(SIDE)
  1437	401403'	254000	414044'		GOTO	DIA1]
  1438	401404'	260740	401722'		GOSUB	GETDEV			;GET THE DEVICE
  1439	401405'	260740	401733'	DIA1:	GOSUB	NAMCHK			;GET THE FILE NAME
  1440	401406'	606000	000010		IF.OFF	S,BRK,DIA0A		;JUMP IF NO PPN.
  1441	401410'	332012	000006		SKIPE	,PPN(SIDE)		;IF ALLREADY HAVE PPN,
  1442	401411'	254000	410246'		GOTO	COMERR			;ERROR!
  1443	401412'	260740	401756'		GOSUB	GETPPN			;ELSE GET PPN.
  1444	401413'	554152	000001	DIA0A:	HLRZ	T1,DEVICE(SIDE)		;GET DEVICE TYPE
  1445	401414'	306500	000032'		CAIN	SIDE,IFILE		;DOING INPUT?
  1446	401415'	302140	446353		CAIE	T1,'DSK'		;AND FROM DISK?
  1447	401416'	263740	412060'		RETURN	ZERO			;NEITHEER, RETURN
  1448	401417'	200152	000007		MOVE	T1,MOD(SIDE)		;GET FILE FLAG BITS
  1449	401420'	602140	000300		IF.ON	T1,WNAME!WEXT,RET0	;NO DO IF WILD
  1450	401422'	041400	000000		INIT	JF,0
  1451	401423'	446353	000000		SIXBIT	/DSK/
  1452	401424'	000000	000000		0
  1453	401425'	254000	401422'		GOTO	.-3
  1454	401426'	200152	000003		MOVE	T1,NAME(SIDE)
  1455	401427'	510212	000004		HLLZ	T2,EXT(SIDE)
  1456	401430'	400240	000000		SETZ	T3,
  1457	401431'	200312	000006		MOVE	T4,PPN(SIDE)
  1458	401432'	076400	000003		LOOKUP	JF,T1
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 19-12
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1459	401433'	254000	410310'		GOTO	NOWLD
  1460	401434'	263740	412060'		RETURN	ZERO
  1461
  1462	401435'	051200	000003	OUTDIA:	EME	.LN,T1			;GET A CHARACTER
  1463	401436'	306140	000012		CAIN	T1,12			;IS IT A LINE FEED?
  1464	401437'	254000	400126'		GOTO	GETCOM+2		;YES, LEAVE DIALOG MODE
  1465	401440'	254000	401435'		GOTO	OUTDIA			;NO, KEEP LOOKING
  1466
  1467				;HERE TO GET INFO ON NO. OF BLOCKS TO TRANSFER AND SKIP
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 20
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1468	401441'	201140	000036	SETBLK:	MOVEI	T1,^D30		;SET RETURN ADDRESS.
  1469	401442'	202140	000371'	        MOVEM   T1,SPCCNT                       ;SAVE CHARACTER POSITION
  1470	401443'	051140	414047'	        EME     .STR,[ASCIZ "    NUMBER OF BLOCKS TO SKIP: "]
  1471	401444'	660000	000001	        ON      S,COL                   ;SAY WE HAVE SEEN A COLON
  1472	401445'	260740	402311'	        GOSUB   NUMVAL                  ;GET A NUMBER
  1473	401446'	202340	000662'	        MOVEM   P2,SBLKN
  1474				                                ;SET RETURN ADDRESS
  1475	401447'	201140	000042	        MOVEI   T1,^D34
  1476	401450'	202140	000371'	        MOVEM   T1,SPCCNT                       ;SAVE CHARACTER POSITION
  1477	401451'	051140	414056'	        EME     .STR,[ASCIZ "    NUMBER OF BLOCKS TO TRANSFER: "]
  1478	401452'	660000	000001	        ON      S,COL
  1479	401453'	260740	402311'	        GOSUB   NUMVAL                  ;GET A NUMBER
  1480	401454'	323340	401450'	        JUMPLE P2,.-4                   ;DON'T LET HER SAY ZERO
  1481	401455'	271340	000001	        ADDI    P2,1                    ;ADD 1 FOR SETUP.
  1482	401456'	202340	000661'	        MOVEM   P2,TBLKN                ;SAVE IT
  1483	401457'	263740	412060'	        RETURN  ZERO                    ;AND RETURN
  1484
  1485	401460'	661000	000010	YESNO:  ON      S,BAD                   ;IGNORE BAD CHARACTERS.
  1486	401461'	200300	414065'	        MOVE    P1,[XWD -YESCNT,YESTAB] ;POINTER FOR TABLE SCAN.
  1487	401462'	201340	413131'	        MOVEI   P2,YESDIS               ;DISPATCH TABLE.
  1488	401463'	254000	402367'	        GOTO    UNIMAT                  ;CHECK COMMAND.
  1489	401464'	606000	000040	YESRET: IF.OFF  S,EOL,XYNRET            ;BAD ANSWER.
  1490	401466'	263740	412060'	        RETURN  ZERO                    ;YES RETURN.
  1491	401467'	606000	000040	NORET:  IF.OFF  S,EOL,XYNRET            ;BAD ANSWER.
  1492	401471'	254000	412057'	        RETURN  ONE                     ;NO RETURN.
  1493	401472'	606000	000040	XYNRET: IF.ON   S,EOL                   ;SKIP IF END OF LINE.
  1494	401473'	260740	402457'	        GOSUB   GETONE                  ;FIND END OF LINE.
  1495	401474'	606000	000040	        IF.ON   S,EOL                   ;SKIP IF EOL.
  1496	401475'	254000	401473'	        GOTO    .-2                     ;TRY AGAIN.
  1497	401476'	051140	414066'	        PRINT   (? Answer YES or NO.)
  1498	401477'	402000	000436'
  1499	401500'	262740	000003	        UNSAVE  T1                      ;GET THE RETURN FROM STACK.
  1500	401501'	254003	777776	        GOTO    -TWO(T1)                ;TRY AGAIN.
  1501				;HERE ON A PRINT COMMAND TO DISPLAY THE CURRENT COMMAND.
  1502
  1503	401502'	336000	000642'	XPRINT: SKIPN   RETWRD                  ;SKIP IF RETAINING.
  1504	401503'	254000	400057'	        GOTO    NTHERE                  ;ELSE IGNORE COMMAND.
  1505	401504'	260740	410441'	        GOSUB   CRLF                    ;SKIP A LINE.
  1506	401505'	051140	414073'	        EME     .STR,[ASCIZ "OUT= "]    ;SAY OUTPUT IS COMING.
  1507	401506'	201500	000001'	        MOVEI   SIDE,OFILE              ;GET INDEX FOR OUTPUT SIDE.
  1508	401507'	260740	401513'	        GOSUB   XPRNT0                  ;TELL GOOD THINGS.
  1509	401510'	051140	414075'	        EME     .STR,[ASCIZ "IN=  "]    ;SAY INPUT IS COMING.
  1510	401511'	201500	000032'	        MOVEI   SIDE,IFILE              ;INPUT INDEX.
  1511	401512'	261740	413562'	        SAVE    [NTHERE]                ;RETURN TO THE STACK.
  1512
  1513				;HERE TO TYPE OUT THE COMMAND FOR ONE SIDE OF THE EQUAL SIGN.
  1514
  1515	401513'	200452	000007	XPRNT0: MOVE    P4,MOD(SIDE)            ;GET THE MOD BITS.
  1516	401514'	260740	410063'	        GOSUB   TYPNAM                  ;TYPE DEV:FILENAME.EXT(USERNAME)
  1517	401515'	336312	000010	        SKIPN   P1,BLKFCT(SIDE)         ;BLOCKING FACTOR YET.
  1518	401516'	254000	401521'	        GOTO    XPRNT1                  ;NO CONTINUE.
  1519	401517'	051140	414077'	        EME     .STR,[ASCIZ "/BLOCK:"]  ;TELL HIM BLOCKING FACTOR IS NEXT.
  1520	401520'	260740	410672'	        GOSUB   DECOUT                  ;PRINT IT.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 20-2
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1521	401521'	336312	000011	XPRNT1: SKIPN   P1,RECSIZ(SIDE)         ;IS THERE A RECORD SIZE.
  1522	401522'	254000	401527'	        GOTO    XPRNT2                  ;NO DO THE NEXT THING.
  1523	401523'	554140	000006	        HLRZ    T1,P1                   ;GET THE LEFT HALF.
  1524	401524'	326140	401527'	        JUMPN   T1,XPRNT2               ;JUMP IF WE DID IT.
  1525	401525'	051140	414101'	        EME     .STR,[ASCIZ "/RECORD:"] ;FLAG RECORD SIZE.
  1526	401526'	260740	410672'	        GOSUB   DECOUT                  ;OUTPUT IT.
  1527	401527'	336312	000012	XPRNT2: SKIPN   P1,ADVAN(SIDE)          ;IS THERE AN ADVANCING COUNT.
  1528	401530'	254000	401533'	        GOTO    XPRNT8                  ;NO JUMP.
  1529	401531'	051140	414103'	        EME     .STR,[ASCIZ "/ADVANCE:"] ;TELL HIM THE ADVANCE COUNTER.
  1530	401532'	260740	410672'	        GOSUB   DECOUT                  ;PRINT IT.
  1531	401533'	336312	000016	XPRNT8: SKIPN   P1,PERGE(SIDE)          ;IS THERE A REEL SWITCH.
  1532	401534'	254000	401537'	        GOTO    XPRNT9                  ;NO...
  1533	401535'	051140	414105'	        EME     .STR,[ASCIZ "/REEL:"]   ;TELL WHAT IS COMING.
  1534	401536'	260740	410672'	        GOSUB   DECOUT                  ;PRINT IT.
  1535	401537'	200152	000000	XPRNT9: MOVE    T1,STATUS(SIDE)         ;GET THE DEVICE STATUS WORD.
  1536	401540'	606140	001000	        IF.OFF  T1,EVEN,XPRNT3          ;JUMP IF ODD PARITY.
  1537	401542'	051140	414107'	        EME     .STR,[ASCIZ "/PARITY:EVEN"] ;SAY EVEN PARITY.
  1538	401543'	135140	402154'	XPRNT3: LDB     T1,SVDPTR                ;GET THE DENSITY BITS.
  1539	401544'	323140	401551'	        JUMPLE  T1,XPRNT4               ;JUMP IF NONE SPECIFIED.
  1540	401545'	370000	000003	        SOS     T1                      ;CORRECT IT.
  1541	401546'	051140	414112'	        EME     .STR,[ASCIZ "/DENSITY:"] ;FLAG DENSITY IS COMING.
  1542	401547'	200143	413057'	        MOVE    T1,DN.TAB(T1)           ;GET THE SIXBIT WORD.
  1543	401550'	260740	410705'	        GOSUB   PUTSIX                  ;PRINT IT.
  1544	401551'	336152	000017	XPRNT4: SKIPN   T1,CHRMOD(SIDE)         ;GET THE CHARACTER SET INDEX.
  1545	401552'	254000	401556'	        GOTO    XPRNT5                  ;NONE YET.
  1546	401553'	051140	414114'	        EME     .STR,[ASCIZ "/MODE:"]   ;TELL HIM THE MODE.
  1547	401554'	200143	000012	        MOVE    T1,CNAM(T1)             ;GET THE SIXBIT MODE.
  1548	401555'	260740	410705'	        GOSUB   PUTSIX                  ;PRINT THE MODE.
  1549	401556'	336152	000013	XPRNT5: SKIPN   T1,LABEL(SIDE)          ;LABEL TYPE YET.
  1550	401557'	254000	401563'	        GOTO    XPRNTD                  ;NO JUMP.
  1551	401560'	051140	414116'	        EME     .STR,[ASCIZ "/LABEL:"]  ;FLAG LABEL TYPE COMING.
  1552	401561'	200143	412667'	        MOVE    T1,LB.TAB(T1)           ;GET THE TYPE SPECIFIED.
  1553	401562'	260740	410705'	        GOSUB   PUTSIX                  ;PRINT IT.
  1554	401563'	336312	000021	XPRNTD: SKIPN   P1,BUFNUM(SIDE)         ;DID HE SPECIFY BUFFERS.
  1555	401564'	254000	401567'	        GOTO    XPRNTA                  ;NO CONTINUE ON.
  1556	401565'	051140	414120'	        EME     .STR,[ASCIZ "/BUFFERS:"];SAY BUFFERS IS NEXT.
  1557	401566'	260740	410672'	        GOSUB   DECOUT                  ;PRINT THE NUMBER.
  1558	401567'	336312	000022	XPRNTA: SKIPN   P1,BACSPC(SIDE)         ;ANY BACKSPACE COUNTER.
  1559	401570'	254000	401573'	        GOTO    XPNT99                  ;NO FORGET IT.
  1560	401571'	051140	414122'	        EME     .STR,[ASCIZ "/BACKSPACE:"];TELL WHAT IS COMING.
  1561	401572'	260740	410672'	        GOSUB   DECOUT                  ;PRINT IT.
  1562	401573'	200412	000007	XPNT99: MOVE    P3,MOD(SIDE)            ;GET THE MOD BITS.
  1563	401574'	640400	030000	        TRC     P3,AWIND!BWIND          ;COMPLEMENT WIND BITS.
  1564	401575'	646400	030000	        TRCN    P3,AWIND!BWIND          ;SKIP IF BOTH NOT ON.
  1565	401576'	660400	000001	        ON      P3,NOWIND               ;FLAG BO]H ON.
  1566	401577'	606400	030001	        IF.OFF  P3,AWIND!BWIND!NOWIND,XPNT88;JUMP IF NONE ON.
  1567	401601'	051140	414125'	        EME     .STR,[ASCIZ "/NOREWIND:"];FLAG A NOWIND.
  1568	401602'	602400	010000	        IF.OFF  P3,AWIND                ;SKIP IF NOT AFTER.
  1569	401603'	200140	413036'	        MOVE    T1,REWTAB               ;POINTER TO AFTER MESSAGE.
  1570	401604'	602400	020000	        IF.OFF  P3,BWIND                ;SKIP IF NOT BEFORE.
  1571	401605'	200140	413037'	        MOVE    T1,REWTAB+1             ;POINTER TO BEFORE MESSAGE.
  1572	401606'	602400	000001	        IF.OFF  P3,NOWIND               ;SKIP IF NOT NEVER.
  1573	401607'	200140	413040'	        MOVE    T1,REWTAB+2             ;POINTER TO ALWAYS MESSAGE.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 20-3
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1574	401610'	260740	410705'	        GOSUB   PUTSIX                  ;SEND MESSAGE.
  1575	401611'	302500	000001'	XPNT88: CAIE    SIDE,OFILE              ;ONLY ON THE OUTPUT SIDE.
  1576	401612'	254000	401636'	        GOTO    XPRNT6                  ;CONTINUE ON.
  1577	401613'	332000	000062'	        SKIPE   TELWRD                  ;SKIP IF TALKING.
  1578	401614'	051140	414130'	        EME     .STR,[ASCIZ "/NOTELL"]  ;TELL HIM NO TALK.
  1579	401615'	336000	000063'	        SKIPN   LSTWRD                  ;SKIP IF LISTING.
  1580	401616'	254000	401623'	        GOTO    XPRNTZ                  ;CARRY ON.
  1581	401617'	200140	414134'	        MOVE    T1,[EME .STR,[ASCIZ "/LIST"]];IF LIST OPTION.
  1582	401620'	332000	000064'	        SKIPE   FSTWRD                  ;SKIP IF NORMAL LIST.
  1583	401621'	200140	414137'	        MOVE    T1,[EME .STR,[ASCIZ "/FLIST"]];FOR FAST LIST.
  1584	401622'	256000	000003	        XCT     T1                      ;PRINT IT.
  1585	401623'	332000	000640'	XPRNTZ: SKIPE   PASS                    ;IS THERE A PASSWORD.
  1586	401624'	254000	401627'	        GOTO    XPRNTB                  ;YES TYPE IT.
  1587	401625'	336000	000641'	        SKIPN   PASS+1                  ;CHECK THE OTHER HALF.
  1588	401626'	254000	401636'	        GOTO    XPRNT6                  ;NO PASSWORD.
  1589	401627'	051140	414140'	XPRNTB: EME     .STR,[ASCIZ "/PASSWORD:"] ;TELL HIM PASSWORD IS NEXT.
  1590	401630'	200300	414143'	        MOVE    P1,[POINT 6,PASS]       ;GET A POINTER.
  1591	401631'	134600	000006	XPRNTC: ILDB    CH,P1                   ;GET A CHARACTER.
  1592	401632'	201614	000040	        MOVEI   CH," "(CH)              ;CONVERT IT TO ASCII.
  1593	401633'	051040	000014	        EME     .CH,CH                  ;PRINT IT.
  1594	401634'	312300	414144'	        CAME    P1,[XWD 600,PASS+1]     ;SKIP IF DONE.
  1595	401635'	254000	401631'	        GOTO    XPRNTC                  ;ELSE DO MORE.
  1596	401636'	515440	777771	XPRNT6: HRLZI   P4,-NWUCNT              ;COUNT OF OTHER SWITCHES.
  1597	401637'	200412	000007	        MOVE    P3,MOD(SIDE)            ;GET THE MOD BITS.
  1598	401640'	612411	412660'	        TDNE    P3,NWUTAB(P4)           ;TEST A BIT.
  1599	401641'	260740	401644'	        GOSUB   XPRNT7                  ;THIS ONE IS ON.
  1600	401642'	253440	401640'	        AOBJN   P4,.-2                  ;DO THE NEXT ONE.
  1601	401643'	254000	410441'	        GOTO    CRLF                    ;SKIP A LINE AND EXIT.
  1602	401644'	051040	414145'	XPRNT7: EME     .CH,[EXP "/"]           ;FLAG A SWITCH.
  1603	401645'	200151	412707'	        MOVE    T1,SW.TAB(P4)           ;GET ITS NAME.
  1604	401646'	254000	410705'	        GOTO    PUTSIX                  ;PRINT IT.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 21
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1605				;HERE WHEN AN "@" IS FOUND IN THE COMMAND STRING. THIS MEANS
  1606				;TAKE THE DEV:FILE.EXT(USERNAME) POINTED TO BY THE AC SIDE AND
  1607				;OPEN IT. IF THE FILE IS FOUND USE IT FOR INPUT TO MAGCON.
  1608
  1609	401647'	261740	000371'	CCLCOM: SAVE    SPCCNT                  ;SAVE THE CHARACTER POSITION.
  1610	401650'	606000	000040	        IF.ON   S,EOL                   ;SKIP IF AT END OF COMMAND.
  1611	401651'	260740	402457'	        GOSUB   GETONE                  ;GET A CHARACTER.
  1612	401652'	606000	000040	        IF.ON   S,EOL                   ;SKIP IT AT END OF LINE.
  1613	401653'	254000	401651'	        GOTO    .-2                     ;SKIP REST OF COMMAND.
  1614	401654'	262740	000371'	        UNSAVE  SPCCNT                  ;RESTORE THE CHARACTER POSITION.
  1615	401655'	260740	401733'	        GOSUB   NAMCHK                  ;MAYBE SOMETHING IN WD.
  1616	401656'	331300	000656'	        SKIPL   P1,CCLFLG               ;GET POINTER TO LAST BLOCK.
  1617	401657'	201300	000654'	        MOVEI   P1,CCLBLK+1-CCLCNT      ;NONE USE FIRST.
  1618	401660'	271300	000020	        ADDI    P1,CCLCNT               ;POINT POINTER TO NEXT BLOCK.
  1619	401661'	553000	000006	        HRRZS   P1                      ;ZERO THE LEFT HALF.
  1620	401662'	301300	001012'	        CAIL    P1,CCLEND               ;ARE WE TOO DEEP.
  1621	401663'	254000	410373'	        GOTO    TOODEP                  ;CCL FILES NESTED TO DEEPLY.
  1622	401664'	542300	000656'	        HRRM    P1,CCLFLG               ;SAVE POINTER.
  1623	401665'	515152	000003	        HRLZI   T1,NAME(SIDE)           ;SOURCE FOR BLT.
  1624	401666'	541146	000003	        HRRI    T1,CCLNAM(P1)           ;POINTER TO SPOT IN BLOCK.
  1625	401667'	251146	000006	        BLT     T1,CCLPPN(P1)           ;SAVE TE NAME.
  1626	401670'	200152	000001	        MOVE    T1,DEVICE(SIDE)         ;GET THE DEVICE.
  1627	401671'	202146	000001	        MOVEM   T1,CCLDEV(P1)           ;SAVE THE DEVICE.
  1628	401672'	047140	000004	        MME     T1,.DEV                 ;GET THE CHARACTERISTICS.
  1629	401673'	336000	000003	        SKIPN   T1                      ;DOES IT EXIST.
  1630	401674'	265140	401712'	        JSP     T1,CCLBAK               ;NO CCL DEVICE.
  1631	401675'	255000	407746'	        NOP     NOEXT                   ;WHERE TO GO.
  1632	401676'	607140	200000	        IF.OFF  T1,DSK,NOUSE    ;CAN'T USE DEVICE.
  1633	401700'	256006	000007	        XCT     CCLOPN(P1)              ;OPEN THE DEVICE.
  1634	401701'	254000	401717'	        GOTO    CCLNDV                  ;DEVICE NOT AVAILABLE.
  1635	401702'	255000	407741'	        NOP     NODEV                   ;WHERE TO GO.
  1636	401703'	256006	000010	        XCT     CCLLOK(P1)              ;OPEN THE FILE.
  1637	401704'	254000	410050'	        GOTO    NOCCL                   ;CAN'T FIND FILE.
  1638	401705'	563000	000656'	        HRROS   CCLFLG                  ;FLAG WE HAVE A CCL FILE.
  1639	401706'	256006	000013	        XCT     CCLBUF(P1)              ;GET A BUFFER.
  1640	401707'	550140	400111*	        HRRZ    T1,JOBFF                ;GET THE FIRST FREE.
  1641	401710'	202140	000657'	        MOVEM   T1,CCLCOR               ;SAVE FOR CORE MME.
  1642	401711'	254000	400065'	        GOTO    NTH1                    ;READ FILE AND DO COMMAND.
  1643	401712'	550200	000656'	CCLBAK: HRRZ    T2,CCLFLG               ;GET THE POINTER WORD.
  1644	401713'	256004	000012	        XCT     CCLREL(T2)              ;RELEASE DEVICE.
  1645	401714'	275200	000020	        SUBI    T2,CCLCNT               ;POINT IT RIGHT.
  1646	401715'	542200	000656'	        HRRM    T2,CCLFLG               ;REPLACE FLAG.
  1647	401716'	254023	000000	        GOTO    @ZERO(T1)               ;CALL ERROR ROUTINE.
  1648	401717'	255026	000007	CCLNDV: NOP     @CCLOPN(P1)             ;POINTER TO DEVICE.
  1649	401720'	265140	401712'	        JSP     T1,CCLBAK               ;BACK UP POINTER.
  1650	401721'	255000	407741'	        NOP     NODEV                   ;WHERE TO GO ON ERROR.
  1651
  1652	000673'			        USE     DATA
  1653
  1654			001012'	CCLEND==.-1
  1655
  1656	401722'			        USE     CODE
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 22
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1657				;HERE TO GET THE DEVICE SPECIFIED FROM THE USER.
  1658
  1659	401722'	660000	000200	GETDEV: ON      S,DEV                   ;SAY WE HAVE SEEN A DEVICE.
  1660	401723'	201140	001000	        MOVEI   T1,WDEV                 ;GET WILD DEVICE BIT.
  1661	401724'	412152	000007	        ANDCAM  T1,MOD(SIDE)            ;TURN IT OFF.
  1662	401725'	260740	401751'	        GOSUB   CHKNAM                  ;SEE IF IT IS WILD.
  1663	401726'	200152	000007		MOVE	T1,MOD(SIDE)		;GET THE MOD BITS.
  1664	401727'	602140	001000	        IF.OFF  T1,WDEV                 ;SKIP IF NOT WILD.
  1665	401730'	205540	446353	        MOVSI   WD,'DSK'                ;SET THE RIGHT NAME.
  1666	401731'	202552	000001	        MOVEM   WD,DEVICE(SIDE)         ;SAVE THE DEVICE IN BLOCK.
  1667	401732'	254000	402356'	        GOTO    GETSIX                  ;GET NEXT COMMAND WORD.
  1668
  1669				;HERE TO GET THE FILE NAME SPECIFIED FROM
  1670				;THE USER.
  1671
  1672	401733'	322540	412060'	NAMCHK: JUMPE   WD,RET0                 ;JUMP IF NO NAME.
  1673	401734'	201140	000300	GETNAM: MOVEI   T1,WNAME!WEXT           ;GET THE WILD BITS.
  1674	401735'	412152	000007	        ANDCAM  T1,MOD(SIDE)            ;TURN OFF WILD BITS.
  1675	401736'	201140	000100		MOVEI	T1,WNAME		;SET UP WILD NAME BIT PATTERN.
  1676	401737'	260740	401751'	        GOSUB   CHKNAM                  ;CHECK OUT THE NAME.
  1677	401740'	202552	000003	        MOVEM   WD,NAME(SIDE)           ;SAVE THE FILE NAME.
  1678	401741'	402000	000013	        SETZM   WD                      ;CLEAR COMMAND WORD.
  1679	401742'	602000	000002	        IF.OFF  S,PER                   ;SKIP IF NO EXTENSION.
  1680	401743'	260740	402356'	        GOSUB   GETSIX                  ;GET THE EXTENSION.
  1681	401744'	201140	000200		MOVEI	T1,WEXT			;SET UP WILD EXT. BIT PATTERN.
  1682	401745'	260740	401751'	        GOSUB   CHKNAM                  ;CHECK FOR WILDS.
  1683	401746'	202552	000004		MOVEM	WD,EXT(SIDE)		;SAVE THE EXTENSION.
  1684	401747'	402000	000013	        SETZM   WD                      ;CLEAR WD TO DO GOOD THINGS LATER.
  1685	401750'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  1686	401751'	607000	001000	CHKNAM:	IF.ON	S,STAR			;IS IT WILD?
  1687	401752'	263740	412060'	        RETURN  ZERO                    ;NO.
  1688	401753'	436152	000007	        IORM    T1,MOD(SIDE)            ;AND LEAVE A TRACE.
  1689	401754'	621000	001000	        OFF     S,STAR                  ;TURN OFF STAR BIT.
  1690	401755'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 23
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1691				;HERE TO PICK UP A PPN FROM THE USER.
  1692
  1693	401756'	660000	000400	GETPPN: ON      S,NUM                   ;SAY WE HAVE A PPN.
  1694	401757'	201140	006000	        MOVEI   T1,WP!WPN               ;GET THE WILD BITS.
  1695	401760'	412152	000007	        ANDCAM  T1,MOD(SIDE)            ;AND CLEAR THEM.
  1696	401761'	260740	401733'	        GOSUB   NAMCHK                  ;SEE IF THERE IS SOMETHING IN WD.
  1697	401762'	260740	401770'	        GOSUB   GETUSR          ;GET USER NAME
  1698	401763'	602000	000040	        IF.ON   S,EOL,RET0      ;ALLOW ON CLOSING PAREN. AT EOL
  1699	401765'	302600	000051	        CAIE    CH,")"          ;MUST HAVE RIGHT DELIMITER.
  1700	401766'	254000	410247'	        GOTO PPNERR             ;BAD USERNAME OR CANNOT GET PPN
  1701	401767'	254000	402356'	        GOTO    GETSIX          ;GET NEXT WORD
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 24
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1702				;HERE TO PICK UP A USER NAME FROM THE USER
  1703	401770'	260740	402435'	GETUSR: GOSUB GET12             ;GET UP TO 12 CHARACTERS
  1704	401771'	041400	000000	        INIT JF,0               ;INITIALIZE DSK
  1705	401772'	446353	000000	        SIXBIT  /DSK/
  1706	401773'	000000	000000	        0
  1707	401774'	254000	410247'	        GOTO    PPNERR
  1708	401775'	201140	000003	        MOVEI   T1,3
  1709	401776'	551200	000406'	        HRRZI   T2,UNAME        ;USE USERNAME IN LOOKUP
  1710	401777'	515240	410000	        HRLZI   T3,(SIXBIT/A/)  ;FOR ANY FILE
  1711	402000'	515300	420000	        HRLZI   T4,(SIXBIT/B/)
  1712	402001'	076400	000003	        LOOKUP  JF,T1           ;LOOK IT UP
  1713	402002'	255000	000000	        NOP                     ;DOES NOT MATTER IF IT'S NOT THERE
  1714	402003'	306200	000406'	        CAIN    T2,UNAME                ;IF WE STILL HAVE ADDRESS,WE'VE FAILED
  1715	402004'	254000	410247'	        GOTO    PPNERR
  1716	402005'	071400	000000	        RELEASE JF,
  1717	402006'	202212	000006	        MOVEM T2,PPN(SIDE)              ;SAVE PPN
  1718	402007'	263740	412060'	        RETURN  ZERO
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 25
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1719				;HERE TO GET THE SWITCHES FROM THE USER.
  1720
  1721	402010'	260740	401733'	GETSW:  GOSUB   NAMCHK                  ;SEE IF ANYTHING IN WD.
  1722	402011'	200300	414146'	        MOVE    P1,[XWD -SW.CNT,SW.TAB] ;AOBJ WORD FOR TABLE SCAN.
  1723	402012'	201340	412762'	        MOVEI   P2,SW.DIS               ;SWITCH DISPATCH TABLE.
  1724	402013'	261740	414147'	        SAVE    [SW.RET]                ;PUT A RETURN ON THE STACK.
  1725	402014'	254000	402367'	        GOTO    UNIMAT                  ;MATCH IT AND DISPATCH.
  1726
  1727				;HERE TO PICK UP AND SET THE BITS FOR ANY
  1728				;SWITCH THAT DOES NOT TAKE AN ARGUMENT.
  1729
  1730	402015'	200151	412660'	SW.NWU: MOVE    T1,NWUTAB(P4)           ;PICK UP THE BIT TO SET.
  1731	402016'	436152	000007	        IORM    T1,MOD(SIDE)            ;SET THE BIT.
  1732	402017'	263740	412060'	        RETURN  ZERO                    ;RETURN FOR NEXT COMMAND.
  1733
  1734				;HERE TO TURN BITS OFF IN A STATUS WORD.
  1735
  1736	402020'	200151	412651'	SW.OFF: MOVE    T1,NWUTAB-NWUCNT(P4)    ;GET THE BIT TO TURN OFF.
  1737	402021'	412152	000007	        ANDCAM  T1,MOD(SIDE)            ;TURN IT OFF.
  1738	402022'	263740	412060'	        RETURN  ZERO                    ;GET THE NEXT COMMAND.
  1739
  1740				;HERE TO PICK UP THE VALUE OF THE PARITY
  1741				;SWITCH. IF NOT SPECIFIED THIS SWITCH DEFAULTS
  1742				;TO ODD PARITY.
  1743
  1744	402023'	662000	002000	SW.P:   TNO     S,PAR,SWERR             ;ONLY HERE ONCE.
  1745	402025'	606000	000001	        IF.OFF  S,COL,FOMERR            ;NEED THE COLON BIT.
  1746	402027'	200300	414150'	        MOVE    P1,[XWD -PR.CNT,PR.TAB] ;AOBJ WORD FOR TABLE SCAN.
  1747	402030'	201340	413054'	        MOVEI   P2,PR.DIS               ;DISPATCH TABLE.
  1748	402031'	254000	402367'	        GOTO    UNIMAT                  ;MATCH THE COMMAND.
  1749	402032'	334140	414151'	ODDRET: SKIPA   T1,[ANDCAM T2,STATUS(SIDE)] ;TO CLEAR THE EVEN PARITY BIT.
  1750	402033'	200140	414152'	EVERET: MOVE    T1,[IORM T2,STATUS(SIDE)] ;TO SET THE EVEN PARITY BIT.
  1751	402034'	201200	001000	        MOVEI   T2,EVEN                 ;THE BIT TO DO THINGS WITH.
  1752	402035'	256000	000003	        XCT     T1                      ;DO IT.
  1753	402036'	263740	412060'	        RETURN  ZERO                    ;BACK TO SENDER.
  1754
  1755				;HERE ON A TELL SWITCH.
  1756
  1757	402037'	402000	000062'	XTELL:  SETZM   TELWRD                  ;CLEAR TALK WORD.
  1758	402040'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  1759
  1760				;HERE ON A NOTELL SWITCH
  1761
  1762	402041'	476000	000062'	XNTELL: SETOM   TELWRD                  ;SET TELWRD NON-ZERO.
  1763	402042'	263740	412060'	        RETURN  ZERO                    ;AND RETURN.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 26
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1764				;HERE TO READ THE PASSWORD FOR GE LABELS.
  1765
  1766	402043'	606000	000001	SW.PW:  IF.OFF  S,COL,FOMERR            ;MUST HAVE A COLON.
  1767	402045'	200240	414143'	        MOVE    T3,[POINT 6,PASS]       ;SET POINTER TO STORAGE.
  1768	402046'	402000	000640'	        SETZM   PASS                    ;CLEAR STORAGE.
  1769	402047'	402000	000641'	        SETZM   PASS+1                  ;CLEAR STORAGE.
  1770	402050'	661000	000400	PASLOP: ON      S,NOCHK                 ;DON'T VALIDATE INPUT.
  1771	402051'	260740	402457'	        GOSUB   GETONE                  ;GET A CHARACTER.
  1772	402052'	602000	000100	        IF.ON   S,SOM,RET0              ;RETURN IF DELIMITER.
  1773	402054'	275600	000040	        SUBI    CH," "                  ;CONVERT IT TO SIXBIT.
  1774	402055'	312240	414144'	        CAME    T3,[XWD 600,PASS+1]     ;SKIP IF POINTER HAS RUN OUT.
  1775	402056'	136600	000005	        IDPB    CH,T3                   ;ELSE SAVE THE CHARACTER.
  1776	402057'	254000	402050'	        GOTO    PASLOP                  ;LOOP UNTIL A DELIMITER.
  1777
  1778				;HERE TO SET THE CONVERSION MODE THAT IS TO
  1779				;BE DONE.
  1780
  1781	402060'	662000	004000	SW.M:   TNO     S,MODE,SWERR            ;ONLY ONE MODE PER FILE.
  1782	402062'	606000	000001	        IF.OFF  S,COL,FOMERR            ;FORMAT ERROR IF NO COLON.
  1783	402064'	200300	414153'	        MOVE    P1,[XWD -M.CNT,M.TAB]   ;POINTER TO TABLE.
  1784	402065'	201340	412656'	        MOVEI   P2,M.DIS                ;MODE DISPATCH TABLE.
  1785	402066'	661000	000040	        ON      S,NODIS                 ;SHORT DISPATCH TABLE.
  1786	402067'	254000	402367'	        GOTO    UNIMAT                  ;FIND A MATCH.
  1787	402070'	200451	413261'	M.RET:  MOVE    P4,MODTAB(P4)           ;GET TABLE ADDRESS OF DATA.
  1788	402071'	202452	000017	        MOVEM   P4,CHRMOD(SIDE)         ;SAVE THE MODE.
  1789	402072'	263740	412060'	        RETURN  ZERO                    ;BACK FOR THE NEXT ONE.
  1790
  1791				;HERE TO SET UP THE BLOCKING FACTOR.
  1792
  1793	402073'	662000	010000	SW.B:   TNO     S,BLK,SWERR             ;ONLY ONE BLOCKING FACTOR.
  1794	402075'	260740	402311'	        GOSUB   NUMVAL                  ;GET THE VALUE OF THE SWITCH.
  1795	402076'	202352	000010	        MOVEM   P2,BLKFCT(SIDE)         ;SAVE THE BLOCKING FACTOR.
  1796	402077'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  1797
  1798				;HERE TO SET UP THE RECORD SIZE FOR THE FILE.
  1799
  1800	402100'	663000	000020	SW.R:   TNO     S,REC,SWERR             ;ONLY HERE ONCE.
  1801	402102'	260740	402311'	        GOSUB   NUMVAL                  ;READ THE VALUE.
  1802	402103'	202352	000011	        MOVEM   P2,RECSIZ(SIDE)         ;SAVE THE RECORD SIZE.
  1803	402104'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  1804
  1805				;HERE TO PICK UP THE VALUE OF THE ADVANCE SWITCH.
  1806
  1807	402105'	662000	020000	SW.A:   TNO     S,ADV,SWERR             ;ONLY ONCE HERE.
  1808	402107'	260740	402311'	        GOSUB   NUMVAL                  ;GET THE VALUE.
  1809	402110'	202352	000012	        MOVEM   P2,ADVAN(SIDE)          ;SAVE IN DATA BLOCK.
  1810	402111'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  1811
  1812				;HERE TO GET THE BACKSPACE ARGUMENT.
  1813
  1814	402112'	662000	040000	SW.BK:  TNO     S,BAC,SWERR             ;ONLY HERE ONCE.
  1815	402114'	260740	402311'	        GOSUB   NUMVAL                  ;GET THE ARGUMENT.
  1816	402115'	202352	000022	        MOVEM   P2,BACSPC(SIDE)         ;SAVE THE ARGUMENT.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 26-2
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1817	402116'	263740	412060'	        RETURN  ZERO                    ;BACK FOR MORE.
  1818
  1819				;HERE TO GET VALUE OF ADVANCE RECORDS SWITCH.
  1820
  1821	402117'	663000	004000	SW.AR:	TNO	S,ADVR,SWERR		;ONLY HERE ONCE.
  1822	402121'	260740	402311'		GOSUB	NUMVAL			;GET THE ARGUMENT.
  1823	402122'	202352	000027		MOVEM	P2,RECADV(SIDE)		;SAVE THE ARGUMENT.
  1824	402123'	263740	412060'		RETURN	ZERO			;BACK FOR MORE.
  1825
  1826				;HERE FOR A REWIND SWITCH.
  1827
  1828	402124'	606000	000001	REWIND: IF.OFF  S,COL,FOMERR            ;JUMP IF NO COLON.
  1829	402126'	200300	414154'	        MOVE    P1,[XWD -REWCNT,REWTAB] ;AOBJN POINTER FOR TABLE SCAN.
  1830	402127'	201340	413042'	        MOVEI   P2,REWDIS               ;DISPATCH TABLE.
  1831	402130'	661000	000040	        ON      S,NODIS                 ;SHORT DISPATCH TABLE.
  1832	402131'	254000	402367'	        GOTO    UNIMAT                  ;FIND A MATCH.
  1833	402132'	301440	000003	REWRET: CAIL    P4,THREE                ;DID HE TYPE OMITT.
  1834	402133'	254000	402151'	        GOTO    NOW0                    ;YES DON'T REWIND.
  1835	402134'	201140	030000	REW0:   MOVEI T1,AWIND+BWIND
  1836	402135'	436152	000007	        IORM T1,MOD(SIDE)
  1837	402136'	200151	413046'	        MOVE    T1,REWBIT(P4)           ;GET THE BIT.
  1838	402137'	412152	000007	        ANDCAM  T1,MOD(SIDE)            ;SET IT.
  1839	402140'	263740	412060'	        RETURN  ZERO                    ;AND RETURN.
  1840
  1841				;HERE FOR A NOWIND SWITCH.
  1842
  1843	402141'	606000	000001	NOREW:  IF.OFF  S,COL,FOMERR            ;JUMP IF NO COLON.
  1844	402143'	200300	414154'	        MOVE    P1,[XWD -REWCNT,REWTAB] ;POINTER FOR TABLE SCAN.
  1845	402144'	201340	413044'	        MOVEI   P2,NORDIS               ;DISPATCH TABLE POINTER.
  1846	402145'	661000	000040	        ON      S,NODIS                 ;SHORT DISPATCH TABLE.
  1847	402146'	254000	402367'	        GOTO    UNIMAT                  ;FIND A MATCH.
  1848	402147'	301440	000003	NOWRET: CAIL    P4,THREE                ;DID HE TYPE OMITT.
  1849	402150'	254000	402134'	        GOTO    REW0                    ;YES REWIND IT.
  1850	402151'	200151	413046'	NOW0:   MOVE    T1,REWBIT(P4)           ;GET THE BIT TO CLEAR.
  1851	402152'	436152	000007	        IORM    T1,MOD(SIDE)            ;CLEAR THE BITS.
  1852	402153'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 27
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1853				;HERE TO PICK UP THE VALUE OF THE DENSITY SWITCH.
  1854
  1855	402154'	070212	000014	SVDPTR: POINT 2,DENSITY(SIDE),28
  1856
  1857	402155'	663000	000002	SW.D:   TNO     S,DEN,SWERR             ;ONLY ONE DENSITY PER FILE.
  1858	402157'	606000	000001	        IF.OFF  S,COL,FOMERR            ;NEED THE COLON BIT HERE.
  1859	402161'	332000	000666'	        SKIPE MTAWD
  1860	402162'	254000	402217'	        GOTO SW.D1
  1861	402163'	200300	414155'	        MOVE    P1,[XWD -DN.CNT,DN.TAB] ;SET UP POINTER.
  1862	402164'	201340	413062'	        MOVEI   P2,DN.DIS               ;DISPATCH TABLE.
  1863	402165'	661000	000040	        ON      S,NODIS                 ;SHORT DISPATCH TABLE.
  1864	402166'	254000	402367'	        GOTO    UNIMAT                  ;FIND A MATCH.
  1865	402167'	350000	000011	D.RET:  AOS     P4                      ;BUMP THE COUNTER.
  1866	402170'	137440	402154'	        DPB     P4,SVDPTR               ;SET THE DENSITY.
  1867	402171'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  1868
  1869				;HERE TO GET THE LABEL TYPE.
  1870
  1871	402172'	663000	000004	SW.L:   TNO     S,LAB,SWERR             ;CAN ONLY HAVE ONE LABEL TYPE.
  1872	402174'	606000	000001	        IF.OFF  S,COL,FOMERR            ;FORMAT ERROR IF NO COLON.
  1873	402176'	200300	414156'	        MOVE    P1,[XWD -LB.CNT,LB.TAB] ;SET POINTER.
  1874	402177'	201340	412676'	        MOVEI   P2,LB.DIS               ;DISPATCH TABLE.
  1875	402200'	661000	000040	        ON      S,NODIS                 ;SHORT DISPATCH TABLE.
  1876	402201'	254000	402367'	        GOTO    UNIMAT                  ;GO FIND A MATCH.
  1877	402202'	202452	000013	L.RET:  MOVEM   P4,LABEL(SIDE)          ;SAVE THE LABEL TYPE.
  1878	402203'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  1879
  1880				;HERE TO GET THE VALUE OF THE REEL SERIAL NUMBER THAT
  1881				;SHOULD BE WRITTEN IN THE OUTPUT LABEL IF THE LABEL
  1882				;TYPE SPECIFIED USES A REEL SERIAL NUMBER.
  1883
  1884	402204'	662000	001000	SW.RL:  TNO     S,REL,SWERR             ;ONLY HERE ONCE.
  1885	402206'	260740	402311'	        GOSUB   NUMVAL                  ;READ THE SWITCH'S VALUE.
  1886	402207'	202352	000016	        MOVEM   P2,PERGE(SIDE)          ;SAVE THE SERIAL NUMBER.
  1887	402210'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  1888
  1889				;HERE FOR THE RETAIN SWITCH IN THE COMMAND STRING.
  1890
  1891	402211'	476000	000642'	SW.KEP: SETOM   RETWRD                  ;FLAG RETAIN MODE.
  1892	402212'	263740	412060'	        RETURN  ZERO                    ;GET THE NEXT ONE.
  1893
  1894				;HERE ON A PERFORM SWITCH. SET THE FLAG TO SAY WE WILL DO IT.
  1895				;AND EXIT.
  1896
  1897	402213'	476000	000642'	SW.GO:  SETOM   RETWRD                  ;RETAIN COMMAND FIRST.
  1898	402214'	553000	000642'	        HRRZS   RETWRD                  ;FLAG THAT WE ARE TO DO IT.
  1899	402215'	263740	412060'	        RETURN  ZERO                    ;AND RETURN.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 28
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1900				;HERE TO PICK UP DENISTY SWITCH IF 1600, 6250 ALLOWED
  1901	402216'	270100	000666'	DENPTR: POINT 1,MTAWD,12
  1902
  1903	402217'	200300	414157'	SW.D1:  MOVE P1,[XWD -DN1.CT,DN1.TB]    ;SET UP POINTER
  1904	402220'	201340	413071'	        MOVEI P2,DN1.DS                 ;DISPATCH TABLE
  1905	402221'	661000	000040	        ON S,NODIS                      ;SHORT DISPATCH TABLE
  1906	402222'	254000	402367'	        GOTO    UNIMAT                  ;FIND A MATCH
  1907	402223'	514151	413073'	D1.RT:  HRLZ T1,DN2.TB(P4)              ;GET BITS TO MATCH MTAWD
  1908	402224'	200200	000666'	        MOVE T2,MTAWD
  1909	402225'	616200	000003	        TDNN T2,T1                      ;AND MAKE SURE IT'S ALLOWED HERE
  1910	402226'	254000	402270'	        GOTO DENOUT                     ;TELL USER OPTIONS
  1911	402227'	402000	000420'	        SETZM HIGHT
  1912	402230'	402000	000421'	        SETZM MIDT
  1913	402231'	402000	000422'	        SETZM LOWT
  1914	402232'	200200	402216'	        MOVE T2,DENPTR
  1915	402233'	211240	000005	        MOVNI T3,5
  1916	402234'	260740	402260'	        GOSUB NXTDEN
  1917	402235'	254000	402247'	        GOTO DONDEN
  1918	402236'	202140	000420'	        MOVEM T1,HIGHT
  1919	402237'	345240	402247'	        AOJGE T3,DONDEN
  1920	402240'	260740	402260'	        GOSUB NXTDEN
  1921	402241'	254000	402247'	        GOTO DONDEN
  1922	402242'	202140	000421'	        MOVEM T1,MIDT
  1923	402243'	345240	402247'	        AOJGE T3,DONDEN
  1924	402244'	260740	402260'	        GOSUB NXTDEN
  1925	402245'	254000	402247'	        GOTO DONDEN
  1926	402246'	202140	000422'	        MOVEM T1,LOWT
  1927	402247'	201200	000001	DONDEN: MOVEI T2,1
  1928	402250'	200151	413073'	        MOVE T1,DN2.TB(P4)
  1929	402251'	316140	000422'	        CAMN T1,LOWT
  1930	402252'	254000	402256'	        GOTO DEN1
  1931	402253'	340200	000000	        AOJ T2,
  1932	402254'	312140	000421'	        CAME T1,MIDT
  1933	402255'	340200	000000	        AOJ T2,
  1934	402256'	137200	402154'	DEN1:   DPB T2,SVDPTR
  1935	402257'	263740	412060'	        RETURN ZERO
  1936
  1937	402260'	134140	000004	NXTDEN: ILDB T1,T2
  1938	402261'	326140	402264'	        JUMPN T1,.+3
  1939	402262'	341240	402260'	        AOJL T3,NXTDEN
  1940	402263'	263740	412060'	        RETURN ZERO
  1941	402264'	200140	000005	        MOVE T1,T3
  1942	402265'	271140	000005	        ADDI T1,5
  1943	402266'	200143	413073'	        MOVE T1,DN2.TB(T1)
  1944	402267'	254000	412057'	        RETURN ONE
  1945
  1946				DENOUT: EME .STR,[ASCIZ "
  1947				THIS HANDLER CAN ONLY USE DENSITIES OF:
  1948	402270'	051140	414160'	"]
  1949	402271'	200200	000410'	        MOVE T2,TABPTR
  1950	402272'	200240	402216'	        MOVE T3,DENPTR
  1951	402273'	134140	000005	        ILDB T1,T3
  1952	402274'	322140	402300'	        JUMPE T1,DENINC
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 28-2
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1953	402275'	200144	000000	        MOVE T1,ZERO(T2)
  1954	402276'	260740	410705'	        GOSUB PUTSIX
  1955	402277'	260740	410441'	        GOSUB CRLF
  1956	402300'	253200	402273'	DENINC: AOBJN T2,.-5
  1957	402301'	200740	414171'	        MOVE PDP,[IOWD PDPSIZ+1,STACK+1]
  1958	402302'	260740	410441'	        GOSUB CRLF
  1959	402303'	254020	000660'	        GOTO @DIAFLG
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 29
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  1960				;HERE TO GET THE NUMBER OF BUFFERS TO USE.
  1961
  1962	402304'	662000	100000	SW.BUF: TNO     S,XBUF,SWERR            ;JUMP IF BEEN HERE BEFORE.
  1963	402306'	260740	402311'	        GOSUB   NUMVAL                  ;GET THE VALUE OF THE ARGUMENT.
  1964	402307'	202352	000021	        MOVEM   P2,BUFNUM(SIDE)         ;SAVE THE NUMBER.
  1965	402310'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  1966
  1967				;HERE TO READ THE VALUE OF A NUMERIC SWITCH.
  1968
  1969	402311'	606000	000001	NUMVAL: IF.OFF  S,COL,FOMERR            ;MUST HAVE THE COLON.
  1970	402313'	261740	000371'	        SAVE    SPCCNT                  ;SAVE THE CHARACTER COUNT.
  1971	402314'	260740	402604'	NUMRTY: GOSUB   GETDEC                  ;GET THE ARGUMENT.
  1972	402315'	254000	402323'	        JRST    BADNUM                  ;NOT A NUMBER
  1973	402316'	262740	000003	        UNSAVE  T1                      ;GET BACK CHARACTER COUNT.
  1974	402317'	350000	000003	        AOS     T1                      ;BUMP FOR CHARACTER READ.
  1975	402320'	316140	000371'	        CAMN    T1,SPCCNT               ;MUST HAVE SOMETHING.
  1976	402321'	254000	410254'	        GOTO    FOMERR                  ;FORMAT ERROR.
  1977	402322'	263740	412060'	        RETURN  ZERO                    ;BACK TO SENDER.
  1978
  1979	402323'	051200	000014	BADNUM: INCHWL  CH                      ;FIND END OF LINE
  1980	402324'	302600	000012	        CAIE    CH,12
  1981	402325'	254000	402323'	        JRST    BADNUM
  1982				        OUTSTR  [ASCIZ /
  1983	402326'	051140	414172'	NOT A NUMBER - REENTER: /]              ;PROMPT FOR CORRECTION
  1984	402327'	254000	402314'	        JRST    NUMRTY                  ;TRY AGAIN
  1985
  1986
  1987				;HERE ON A LIST SWITCH OR AN FLIST SWITCH.
  1988
  1989	402330'	476000	000064'	XFLST:  SETOM   FSTWRD                  ;SET FOR A FAST LIST.
  1990	402331'	334000	000000	        SKIPA                           ;SET THE LIST WORD.
  1991	402332'	402000	000064'	XLST:   SETZM   FSTWRD                  ;CLEAR FAST LIST WORD.
  1992	402333'	476000	000063'	        SETOM   LSTWRD                  ;SET TO DO A LIST.
  1993	402334'	263740	412060'	        RETURN  ZERO                    ;RETURN.
  1994
  1995				;HERE ON A NOLIST SWITCH.
  1996
  1997	402335'	402000	000063'	XNLST:  SETZM   LSTWRD                  ;CLEAR LIST WORD.
  1998	402336'	402000	000064'	        SETZM   FSTWRD                  ;CLEAR FAST WORD.
  1999	402337'	263740	412060'	        RETURN  ZERO                    ;AND RETURN.
  2000
  2001				;HERE TO RECYCLE THE COMMAND DECODER FOR THE
  2002				;INPUT FILE SPECIFICATIONS.
  2003
  2004	402340'	260740	401733'	RESYNC: GOSUB   NAMCHK                  ;SEE IF FILE NAME IS PRESENT.
  2005	402341'	662000	400000	        TNO     S,IOT,COMERR            ;ONLY HERE ONCE.
  2006	402343'	201500	000032'	        MOVEI   SIDE,IFILE              ;CHANGE COMMAND INDEX.
  2007	402344'	632000	414200'	        TNZ     S,DEV!NUM!DEN!PAR!ADV!LAB!MODE!REL!BLK!REC!XBUF!ADVR,GETWOD
  2008	402346'	200540	000004'	        MOVE    WD,OFILE+NAME           ;GET THE COMMAND WORD.
  2009	402347'	200300	414201'	        MOVE    P1,[XWD -E.CNT,E.TAB]   ;POINTER TO TABLE.
  2010	402350'	201340	413101'	        MOVEI   P2,E.DIS                ;POINTER TO DISPATCH TABLE.
  2011	402351'	661000	000040	        ON      S,NODIS                 ;SHORT DISPATCH TABLE.
  2012	402352'	254000	402370'	        GOTO    UNICOM                  ;FIND THE COMMAND.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 29-2
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  2013	402353'	336000	000005'	E.RET:  SKIPN   OFILE+EXT               ;ONLY IF JUST A NAME.
  2014	402354'	434011	413103'	        IOR     S,E.BIT(P4)             ;SET DELAYED COMMAND BIT.
  2015	402355'	254000	400147'	        GOTO    GETWOD                  ;GET THE NEXT COMMAND WORD.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 30
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  2016				;HERE TO GET A SIXBIT WORD FROM THE COMMAND STRING.
  2017				;RETURNS THE WORD IN WD WHEN A DELIMITER IS FOUND.
  2018
  2019	402356'	200240	414202'	GETSIX: MOVE    T3,[POINT 6,WD]         ;SET POINTER TO STORAGE.
  2020	402357'	402000	000013	        SETZM   WD                      ;AND THEN CLEAR STORAGE.
  2021	402360'	260740	402457'	SIXLOP: GOSUB   GETONE                  ;GET A CHARACTER.
  2022	402361'	602000	000100	        IF.ON   S,SOM,RET0              ;RETURN IF DELIMITER FOUND.
  2023	402363'	275600	000040	        SUBI    CH," "                  ;CONVERT IT TO SIXBIT.
  2024	402364'	603240	770000	        IF.OFF  T3,77B5                 ;IF WD IS NOT FULL
  2025	402365'	136600	000005	        IDPB    CH,T3                   ;STACH THE CHARACTER.
  2026	402366'	254000	402360'	        GOTO    SIXLOP                  ;LOOP UNTIL DONE.
  2027
  2028				;HERE TO FIND A UNIQUE MATCH FOR A SIXBIT WORD. ENTER WITH A
  2029				;POINTER TO THE SIXBIT TABLE IN P1, A POINTER TO THE DISPATCH
  2030				;TABLE IN P2, AND THE LENGTH OF THE TABLE IN THE UPPER HALF OF P1.
  2031
  2032	402367'	260740	402356'	UNIMAT: GOSUB   GETSIX                  ;GET A WORD.
  2033	402370'	621000	000300	UNICOM: OFF     S,FNDONE!FNDTWO         ;TURN OFF FOUND BITS.
  2034	402371'	200140	000013	        MOVE    T1,WD                   ;COPY COMMAND WORD.
  2035	402372'	476000	000004	        SETOM   T2                      ;INITIALIZE MASK.
  2036	402373'	322140	402377'	GETMSK: JUMPE   T1,GOTMSK               ;JUMP IF MASK IS RIGHT.
  2037	402374'	242140	000006	        LSH     T1,6                    ;SHIFT A CHARACTER OUT.
  2038	402375'	242200	777772	        LSH     T2,-6                   ;FIX UP THE MASK.
  2039	402376'	254000	402373'	        GOTO    GETMSK                  ;TRY AGAIN.
  2040	402377'	200140	000006	GOTMSK: MOVE    T1,P1                   ;COPY AOBJN WORD.
  2041	402400'	321200	402412'	NXTENT: JUMPL   T2,TRYNXT               ;IF NO COMMAND DON'T CHECK.
  2042	402401'	200243	000000	        MOVE    T3,ZERO(T1)             ;GET A TABLE ENTRY.
  2043	402402'	420240	000004	        ANDCM   T3,T2                   ;ISOLATE THE CHARACTERS WE WANT.
  2044	402403'	316543	000000	        CAMN    WD,ZERO(T1)             ;IS IT AN EXACT MATCH.
  2045	402404'	254000	402432'	        GOTO    GOTMAT                  ;YES WE HAVE IT.
  2046	402405'	312240	000013	        CAME    T3,WD                   ;IS IT A PARTIAL MATCH.
  2047	402406'	254000	402412'	        GOTO    TRYNXT                  ;NO TRY THE NEXT ONE.
  2048	402407'	663000	000100	        TEO     S,FNDONE                ;WE HAVE FOUND ONE MATCH.
  2049	402410'	667000	000300	        TNO     S,FNDONE!FNDTWO         ;LOOKS LIKE WE FOUND TWO.
  2050	402411'	550400	000003	        HRRZ    P3,T1                   ;SAVE THE INDEX.
  2051	402412'	253140	402400'	TRYNXT: AOBJN   T1,NXTENT               ;CHECK THE WHOLE LIST.
  2052	402413'	603000	000100	        IF.OFF  S,FNDONE                ;DID WE FIND ANYTING.
  2053	402414'	603000	000200	        IF.OFF  S,FNDTWO                ;OR TOO MUCH.
  2054	402415'	550400	000003	        HRRZ    P3,T1                   ;GET ERROR INDEX.
  2055	402416'	402000	000013	COMGO:  SETZM   WD                      ;CLEAR INPUT WORD.
  2056	402417'	275406	000000	        SUBI    P3,ZERO(P1)             ;P3 IS RELATIVE POINTER TO DISPATCH.
  2057	402420'	201450	000000	        MOVEI   P4,ZERO(P3)             ;COPY INDEX.
  2058	402421'	271407	000000	        ADDI    P3,ZERO(P2)             ;P3 IS NOW ABSOLUTE IF LONG DISPATCH.
  2059	402422'	201147	000000	        MOVEI   T1,ZERO(P2)             ;ASSUME GOODNESS.
  2060	402423'	603000	000100	        IF.OFF  S,FNDONE                ;DID WE FIND ONE.
  2061	402424'	603000	000200	        IF.OFF  S,FNDTWO                ;OR TOO MANY.
  2062	402425'	201147	000001	        MOVEI   T1,ONE(P2)              ;YES SET ERROR RETURN.
  2063	402426'	202300	000410'	        MOVEM   P1,TABPTR               ;SAVE POINTER TO TABLE FOR LISTING.
  2064	402427'	623000	000040	        TEZ     S,NODIS                 ;IS THERE A LONG DISPATCH TABLE.
  2065	402430'	254023	000000	        GOTO    @ZERO(T1)               ;NO USE SHORT TABLE.
  2066	402431'	254030	000000	        GOTO    @ZERO(P3)               ;USE LONG TABLE.
  2067	402432'	661000	000100	GOTMAT: ON      S,FNDONE                ;WE HAVE FOUND A MATCH.
  2068	402433'	550400	000003	        HRRZ    P3,T1                   ;SAVE EXACT MATCH INDEX.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 30-2
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  2069	402434'	254000	402416'	        GOTO    COMGO                   ;AND THEN GO TO IT.
  2070
  2071				;HERE TO INPUT UP TO 12 CHARACTERS INTO UNAME
  2072	402435'	200240	414203'	GET12:  MOVE    T3,[POINT 6,UNAME]
  2073	402436'	402000	000406'	        SETZM   ,UNAME
  2074	402437'	402000	000407'	        SETZM   ,UNAME+1
  2075	402440'	260740	402457'	GET12A:	GOSUB   GETONE          ;GET ONE CHARACTER
  2076	402441'	621000	001000		OFF	S,STAR
  2077	402442'	302600	000056		CAIE	CH,"."		;CHECK IT FOR VALID CHARACTER.
  2078	402443'	306600	000052		CAIN	CH,"*"
  2079	402444'	254000	402454'		GOTO	GET12B
  2080	402445'	301600	000101	        CAIL    CH,"A"          ;CHECK IT FOR A VALID CHARACTER
  2081	402446'	303600	000132	        CAILE   CH,"Z"
  2082	402447'	334000	000000	        SKIPA                   ;MAYBE NO GOOD
  2083	402450'	254000	402454'	        GOTO    GET12B
  2084	402451'	301600	000060	        CAIL    CH,"0"
  2085	402452'	303600	000071	        CAILE   CH,"9"
  2086	402453'	263740	412060'	        RETURN  ZERO            ;RETURN IF NOT A VALID CHARACTER
  2087	402454'	275600	000040	GET12B:	SUBI    CH," "		;CONVERT IT TO SIXBIT.
  2088	402455'	136600	000005	        IDPB    CH,T3           ;SAVE CHARACTER
  2089	402456'	254000	402440'	        GOTO    GET12A
  2090
  2091				;HERE TO GET ONE CHARACTER AND TO SET ALL THE
  2092				;FLAGS THAT DESCRIBE THAT CHARACTER.
  2093
  2094	402457'	620000	240177	GETONE: OFF     S,COL!PER!SLH!BRK!IO!EOL!SPC!ATS!SOM ;CLEAR SOME FLAGS.
  2095	402460'	332000	000402'	GETCHR: SKIPE   RUNFLG                  ;SKIP IF NOT RUNNING.
  2096	402461'	254000	402464'	        GOTO    GTONE1                  ;JUMP IF SO.
  2097	402462'	335000	000656'	        SKIPGE  CCLFLG                  ;SKIP IF NOT IN CCL FILE.
  2098	402463'	260740	402554'	        GOSUB   REDCCL                  ;READ CCL FILE.
  2099	402464'	051200	000014	GTONE1: EME     .LN,CH                  ;GET A CHARACTER.
  2100	402465'	306600	000012	        CAIN    CH,12                   ;IGNORE LINE-FEEDS.
  2101	402466'	254000	402460'	        GOTO    GETCHR                  ;GET ANOTHER CHARACTER.
  2102	402467'	302600	000015	        CAIE    CH,15                   ;WAS THAT A RETURN.
  2103	402470'	254000	402474'	        GOTO    GTONE0                  ;NO LOOK AT CHCRACTER.
  2104	402471'	336000	000402'	        SKIPN   RUNFLG                  ;SKIP IF RUNNING.
  2105	402472'	331000	000656'	        SKIPL   CCLFLG                  ;SKIP IF CCL FILE.
  2106	402473'	051200	000003	        EME     .LN,T1                  ;YES READ LINE-FEED.
  2107	402474'	306600	000011	GTONE0: CAIN    CH,11                   ;IS THIS A TAB.
  2108	402475'	254000	402546'	        GOTO    CNTTAB                  ;COUNT THE TAB.
  2109	402476'	350000	000371'	        AOS     SPCCNT                  ;COUNT THE CHARACTER.
  2110	402477'	603000	000400	        IF.ON   S,NOCHK,GETCH0          ;INCLUDE SPACES IF NO CHECK.
  2111	402501'	306600	000040	        CAIN    CH," "                  ;IS IT A SPACE.
  2112	402502'	254000	402460'	        GOTO    GETCHR                  ;THEN GET ANOTHER.
  2113	402503'	515140	777764	GETCH0: HRLZI   T1,-CH.CNT              ;COUNT OF DELIMITERS.
  2114	402504'	554203	412563'	        HLRZ    T2,CH.CHR(T1)           ;MAKE A SELECTION.
  2115	402505'	312600	000004	        CAME    CH,T2                   ;AND TEST FOR A MATCH.
  2116	402506'	253140	402504'	        AOBJN   T1,.-2                  ;TEST THE WHOLE LIST.
  2117	402507'	325140	402515'	        JUMPGE  T1,MAKUP                ;BACK TO SENDER NOT SPECIAL.
  2118	402510'	550143	412563'	        HRRZ    T1,CH.CHR(T1)           ;GET THE BITS.
  2119	402511'	434000	000003	        IOR     S,T1                    ;SET THEM.
  2120	402512'	602000	200000	        IF.ON   S,SPC,CRLF              ;SPECIAL CHARACTER.
  2121	402514'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 30-3
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  2122	402515'	301600	000140	MAKUP:  CAIL    CH,140                  ;LOWER CASE.
  2123	402516'	620600	000040	        OFF     CH," "                  ;MAKE IT UPPER CASE.
  2124	402517'	623000	000400	        TEZ     S,NOCHK                 ;SHOULD WE VALIDATE INPUT.
  2125	402520'	263740	412060'	        RETURN  ZERO                    ;NO SO RETURN.
  2126	402521'	302600	000054	        CAIE    CH,","                  ;LET HIM HAVE A COMA.
  2127	402522'	306600	000051	        CAIN    CH,")"                  ;IS THIS A BRACKET.
  2128	402523'	263740	412060'		RETURN	ZERO			;YES - IT IS O.K.
  2129	402524'	306600	000077	        CAIN    CH,"?"                  ;IS IT A QUESTION MARK.
  2130	402525'	263740	412060'		RETURN	ZERO			;THIS IS O.K.
  2131	402526'	306600	000052	        CAIN    CH,"*"                  ;IS IT A STAR.
  2132	402527'	254000	402542'	        GOTO    GOTSTR                  ;YES.
  2133	402530'	306600	000043		CAIN	CH,"#"			;IS IT A "#" (WILD CHARACTER)?
  2134	402531'	254000	402542'		GOTO	GOTSTR			;YES.
  2135	402532'	305600	000060	        CAIGE   CH,"0"                  ;IS IT LESS THEN ZERO.
  2136	402533'	254000	410234'	        GOTO    BADCHR                  ;ILLEGAL CHARACTER.
  2137	402534'	307600	000071	        CAIG    CH,"9"                  ;BUT LESS THEN NINE.
  2138	402535'	263740	412060'		RETURN	ZERO			;CHARACTER IS NUMERIC.
  2139	402536'	301600	000101	        CAIL    CH,"A"                  ;IS IT IN THE ALPHABET.
  2140	402537'	303600	000132	        CAILE   CH,"Z"                  ;IS IT PAST THE TOP.
  2141	402540'	254000	410234'	        GOTO    BADCHR                  ;YES IT IS ILLEGAL.
  2142	402541'	263740	412060'		RETURN	ZERO			;BACK TO CALLER.
  2143	402542'	661000	001000	GOTSTR: ON      S,STAR                  ;LIGHT STAR BIT.
  2144	402543'	263740	412060'	        RETURN  ZERO                    ;AND RETURN.
  2145	402544'	370000	000371'	BADSTR: SOS     SPCCNT                  ;POINT POINTER TO STAR.
  2146	402545'	254000	410234'	        GOTO    BADCHR                  ;SAY BAD CHARACTER.
  2147	402546'	200140	000371'	CNTTAB: MOVE    T1,SPCCNT               ;GET THE SPACE COUNT.
  2148	402547'	231140	000010	        IDIVI   T1,^D8                  ;GET THE POSITIONS TAB MOVED US.
  2149	402550'	201140	000010	        MOVEI   T1,^D8                  ;SPACES PER TAB.
  2150	402551'	274140	000004	        SUB     T1,T2                   ;T1 HAS SPACES MOVED.
  2151	402552'	272140	000371'	        ADDM    T1,SPCCNT               ;UPDATE THE SPACE COUNT.
  2152	402553'	254000	402460'	        GOTO    GETCHR                  ;GET THE NEXT CHARACTER.
  2153	402554'	550600	000656'	REDCCL: HRRZ    CH,CCLFLG               ;GET POINTERS TO THINGS.
  2154	402555'	375014	000016	        SOSGE   CCLHED+2(CH)            ;SKIP IF DATA IN BUFFER.
  2155	402556'	254000	402567'	        GOTO    CCLUP                   ;FILL UP THE BUFFER.
  2156	402557'	134614	000015	        ILDB    CH,CCLHED+1(CH)         ;GET A CHARACTER.
  2157	402560'	322600	402554'	        JUMPE   CH,REDCCL               ;IGNORE NULLS.
  2158	402561'	306600	000012	        CAIN    CH,12                   ;SKIP IF NOT LINE-FEED.
  2159	402562'	254000	402554'	        GOTO    REDCCL                  ;IGNORE LINE-FEEDS.
  2160	402563'	051040	000014	        EME     .CH,CH                  ;PRINT IT.
  2161	402564'	306600	000015	        CAIN    CH,15                   ;SKIP IF NOT RETURN.
  2162	402565'	051040	413554'	        EME     .CH,[EXP 12]            ;SKIP A LINE.
  2163	402566'	254000	412057'	        RETURN  ONE                     ;SKIP RETURN.
  2164	402567'	620000	001000	CCLUP:  OFF     S,HUNG                  ;CLEAR HUNG DEVICE BIT.
  2165	402570'	350000	000363'	        AOS     %IO                     ;COUNT DEVICE ACCESS.
  2166	402571'	256014	000011	        XCT     CCLGET(CH)              ;FILL UP THE BUFFER.
  2167	402572'	254000	402554'	        GOTO    REDCCL                  ;CARRY ON.
  2168	402573'	256014	000012	        XCT     CCLREL(CH)              ;RELEASE CHANNEL.
  2169	402574'	275600	000020	        SUBI    CH,CCLCNT               ;DECREMENT TO PREVIOUS BLOCK.
  2170	402575'	542600	000656'	        HRRM    CH,CCLFLG               ;SAVE POINTER.
  2171	402576'	305600	000673'	        CAIGE   CH,CCLBLK               ;HAVE WE DONE THEM ALL.
  2172	402577'	402000	000656'	        SETZM   CCLFLG                  ;NO LONGER IN CCL FILE.
  2173	402600'	262757	000000	        UNSAVE  ZERO(PDP)               ;POP RETURN TO STACK.
  2174	402601'	660000	000140	        ON      S,EOL!SOM               ;MAKE IT AN EOL CHARACTER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 30-4
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  2175	402602'	201600	000015	        MOVEI   CH,15                   ;LOAD ONE TO MAKE SURE.
  2176	402603'	254000	410441'	        GOTO    CRLF                    ;SKIP A LINE AND EXIT.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 31
MAGCON.MAC	 6-JUL-77 09:25		*** COMMAND DECODER ***

  2177				;HERE TO GET EITHER A DECIMAL NUMBER OR OCTAL
  2178				;NUMBER FROM THE USER.
  2179
  2180	402604'	201300	000012	GETDEC: MOVEI   P1,^D10         ;SET THE RADIX.
  2181	402605'	402000	000007	        SETZM   P2                      ;ZERO STORAGE.
  2182	402606'	260740	402457'	NXTDIG: GOSUB   GETONE                  ;GET A CHARACTER.
  2183	402607'	602000	000100	        IF.OFF  S,SOM                   ;DELIMITER.
  2184	402610'	254000	412057'	        RETURN  ONE                     ;YES SKIP RETURN
  2185	402611'	301600	000060	        CAIL    CH,"0"                  ;MUST BE GREATER THEN 0-1.
  2186	402612'	301606	000060	        CAIL    CH,"0"(P1)              ;BUT LESS THEN BASE.
  2187	402613'	263740	412060'	        RETURN  ZERO                    ;BAD NUMBER.
  2188	402614'	220340	000006	        IMUL    P2,P1                   ;MULTIPLY NUMBER BY BASE.
  2189	402615'	271354	777720	        ADDI    P2,-"0"(CH)             ;ADD IN NEW DIGIT.
  2190	402616'	254000	402606'	        GOTO    NXTDIG                  ;GET ANOTHER ONE.
  2191
  2192				;HERE TO CALL THE PROGRAM "TABLE" INTO CORE AND GIVE
  2193				;IT A CCL ENTRY. WHEN TABLE GETS THIS TYPE OF START
  2194				;IT WILL CREATE THE DATA FILE "DSK:MAGCON.DAT" WITH THE
  2195				;CONVERSION TABLES IN IT. "TABLE" WILL THEN RERUN MAGCON
  2196				;GIVING IT A CCL ENTRY.
  2197
  2198	402617'	205140	637163	CRETAB: MOVSI   T1,'SYS'                ;TRY DEVICE "SYS" FIRST.
  2199	402620'	260740	402624'	        GOSUB   RUNIT                   ;TRY TO RUN IT.
  2200	402621'	205140	446353	        MOVSI   T1,'DSK'                ;IF ERROR ON "SYS" TRY "DSK".
  2201	402622'	260740	402624'	        GOSUB   RUNIT                   ;TRY AND RUN IT.
  2202	402623'	254000	410237'	        GOTO    NOMAKE                  ;IF ERROR HERE NO RUN.
  2203	402624'	202140	001014'	RUNIT:  MOVEM   T1,TABDEV+1             ;SAVE THE DEVICE FOR LOOKUP.
  2204	402625'	202140	001016'	        MOVEM   T1,TABRUN               ;SAVE DEVICE TO RUN FROM.
  2205	402626'	402000	001022'	        SETZM   TABFIL+3                ;CLEAR PPN WORD.
  2206	402627'	050100	001013'	        OPEN    IF,TABDEV               ;GET THE DEVICE.
  2207	402630'	263740	412060'	        RETURN  ZERO                    ;CAN'T HAVE DEVICE.
  2208	402631'	076100	001017'	        LOOKUP  IF,TABFIL               ;FIND THE FILE.
  2209	402632'	263740	412060'	        RETURN  ZERO                    ;CAN'T FIND FILE.
  2210	402633'	200140	414204'	        MOVE    T1,[XWD ONE,TABRUN]     ;POINTER TO BLOCK.
  2211	402634'	513000	001020'	        HLLZS TABFIL+1
  2212	402635'	402000	001021'	        SETZM TABFIL+2
  2213	402636'	402000	001022'	        SETZM TABFIL+3
  2214	402637'	047140	000035	        MME     T1,.RUN                 ;RUN THE FILE.
  2215	402640'	263740	412060'	        RETURN  ZERO                    ;CAN'T RUN IT.
  2216
  2217	001013'			        USE     DATA
  2218
  2219	001013'	000000	000017	TABDEV: XWD     ZERO,DMP                ;SO NO BUFFERS.
  2220	001014'	637163	000000	        SIXBIT  "SYS"
  2221	001015'			        BSS     ONE
  2222	001016'	637163	000000	TABRUN: SIXBIT  "SYS"
  2223	001017'	554147	644142	TABFIL: SIXBIT  "MAGTAB"
  2224	001020'	634166	000000	        SIXBIT  "SAV"
  2225	001021'			        BSS     3
  2226
  2227	402641'			        USE     CODE
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 32
MAGCON.MAC	 6-JUL-77 09:25		*** END OF COMMAND ***

  2228				SUBTTL                          *** END OF COMMAND ***
  2229
  2230				;HERE ON COMMAND END TO START IT GOING.
  2231
  2232	402641'	260740	401733'	ENDCOM: GOSUB   NAMCHK                  ;MAKE SURE IT IS OVER.
  2233	402642'	200140	000642'	        MOVE    T1,RETWRD               ;GET THE PERFORM WORD.
  2234	402643'	326140	402652'	        JUMPN   T1,ENDCM0               ;JUMP IF RETAINING.
  2235	402644'	606000	400000	        IF.OFF  S,IOT,COMERR            ;ONE INPUT AND ONE OUTPUT DEVICE.
  2236	402646'	612000	414205'	        IF.ON   S,DEN!PAR!BLK!ADV!LAB!MODE!REC!REL!XBUF!ADVR,ENDCM0
  2237	402650'	623000	000001	        TNZ     S,DATA,GETTNM           ;IF ON GET DATA FILE NAME.
  2238	402652'	402000	000000	ENDCM0: SETZM   S                       ;CLEAR FLAGS.
  2239	402653'	200040	000002'	        MOVE    OF,OFILE+DEVICE         ;GET NAME OF DEVICE.
  2240	402654'	047040	000004	        MME     OF,.DEV                 ;GET ITS CHARACTERISTICS.
  2241	402655'	336000	000001	        SKIPN   OF                      ;DOES IT EXIST.
  2242	402656'	265140	407746'	        JSP     T1,NOEXT                ;NOT FOUND.
  2243	402657'	513000	000001	        HLLZS   OF                      ;ZERO OUT RIGHT HALF.
  2244	402660'	437040	000010'	        IORB    OF,OFILE+MOD            ;SET THE MOD BITS.
  2245	402661'	200100	000033'	        MOVE    IF,IFILE+DEVICE         ;SET UP DEVICE.
  2246	402662'	047100	000004	        MME     IF,.DEV                 ;GET CHARACTERISTICS.
  2247	402663'	336000	000002	        SKIPN   IF                      ;DOES IT EXIST.
  2248	402664'	265140	407746'	        JSP     T1,NOEXT                ;NOPE...NOT THERE.
  2249	402665'	513000	000002	        HLLZS   IF                      ;SET UP BITS.
  2250	402666'	437100	000041'	        IORB    IF,IFILE+MOD            ;SET ALL THE MOD BITS.
  2251	402667'	554140	000012'	        HLRZ    T1,OFILE+RECSIZ         ;GET THE OUTPUT RECORD SIZE.
  2252	402670'	332000	000003	        SKIPE   T1                      ;DID WE SET IT.
  2253	402671'	402000	000012'	        SETZM   OFILE+RECSIZ            ;YES SO CLEAR IT.
  2254	402672'	201140	000014	        MOVEI   T1,BIN                  ;MODE.
  2255	402673'	436140	000001'	        IORM    T1,OFILE+STATUS         ;SET THEM.
  2256	402674'	436140	000032'	        IORM    T1,IFILE+STATUS         ;SET THEM.
  2257	402675'	515140	000307'	        HRLZI   T1,OBUF                 ;GET POINTER TO BUFFER HEADER.
  2258	402676'	603040	000020	        IF.OFF  OF,MTA                  ;IS THIS MAG-TAPE.
  2259	402677'	541140	000315'	        HRRI    T1,OIBUF                ;YES SO GET A INPUT HEADER.
  2260	402700'	202140	000003'	        MOVEM   T1,OFILE+BUFFER         ;SAVE IN PLACE.
  2261	402701'	201140	000312'	        MOVEI   T1,IBUF                 ;GET POINTER TO INPUT HEADER.
  2262	402702'	552140	000034'	        HRRZM   T1,IFILE+BUFFER         ;SAVE IN PLACE.
  2263	402703'	607040	340630	        IF.OFF  OF,GDEV,NOOUSE          ;CAN'T USE THIS DEVICE.
  2264	402705'	603040	200020	        IF.ON   OF,MTA!DSK,OPNO1        ;JUMP IF THIS IS MTA OR DSK.
  2265	402707'	607040	000001	        IF.OFF  OF,OTP,NOOUT            ;JUMP IF CAN'T DO OUTPUT.
  2266
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 33
MAGCON.MAC	 6-JUL-77 09:25		*** END OF COMMAND ***

  2267	402711'	201140	000000	        MOVEI   T1,ASC                  ;ASCII DATA MODE.
  2268	402712'	202140	000001'	        MOVEM   T1,OFILE+STATUS         ;SAVE AS STATUS FOR DEVICE.
  2269	402713'	200140	000020'	        MOVE    T1,OFILE+CHRMOD         ;GET THE MODE OF OUTPUT.
  2270	402714'	306140	413353'	        CAIN    T1,OCTMOD               ;ALLOW OCTAL OUTPUT.
  2271	402715'	254000	402724'	        GOTO    OPNO1                   ;DON'T CHANGE TO ASCII.
  2272	402716'	402000	000011'	        SETZM   OFILE+BLKFCT            ;SET BLOCKING FACTOR TO ZERO.
  2273	402717'	336140	000012'	        SKIPN   T1,OFILE+RECSIZ         ;SKIP IF RECORD SPECIFIED.
  2274	402720'	525140	377777	        HRLOI   T1,377777               ;RECORD SIZE TO INFINITY.
  2275	402721'	202140	000012'	        MOVEM   T1,OFILE+RECSIZ         ;SAVE THE RECORD SIZE.
  2276	402722'	201140	413277'	        MOVEI   T1,ASCMOD               ;SO WE READ THE RIGHT TABLES.
  2277	402723'	202140	000020'	        MOVEM   T1,OFILE+CHRMOD         ;SAVE CHARACTER MODE.
  2278	402724'	200140	000015'	OPNO1:  MOVE    T1,OFILE+DENSITY        ;SET DENSITY UP FOR MAG-TAPE.
  2279	402725'	603040	000020	        IF.OFF  OF,MTA                  ;IS THIS MAG-TAPE.
  2280	402726'	436140	000001'	        IORM    T1,OFILE+STATUS         ;OR INTO PLACE.
  2281	402727'	607100	340630	        IF.OFF  IF,GDEV,NOIUSE          ;CAN'T USE THIS DEVICE.
  2282	402731'	603100	200020	        IF.ON   IF,MTA!DSK,OPNI1        ;JUMP IF DSK OR MTA.
  2283	402733'	607100	000002	        IF.OFF  IF,IPT,NOINP            ;JUMP IF CAN'T DO INPUT.
  2284	402735'	201140	000000	        MOVEI   T1,ASC                  ;ASCII DATA MODE.
  2285	402736'	202140	000032'	        MOVEM   T1,IFILE+STATUS         ;SAVE AS DEVICE STATUS.
  2286	402737'	402000	000042'	        SETZM   IFILE+BLKFCT            ;SET BLOCKING FACTOR TO ZERO.
  2287	402740'	201140	413277'	        MOVEI   T1,ASCMOD               ;SET INDEX FOR TABLES.
  2288	402741'	202140	000051'	        MOVEM   T1,IFILE+CHRMOD         ;SAVE DEVICE DATA MODE.
  2289	402742'	200140	000046'	OPNI1:  MOVE    T1,IFILE+DENSITY        ;SET UP DENSITY FOR MTA.
  2290	402743'	603100	000020	        IF.OFF  IF,MTA                  ;IS IT A MAG-TAPE.
  2291	402744'	436140	000032'	        IORM    T1,IFILE+STATUS         ;SET IT.
  2292	402745'	336000	000063'	        SKIPN   LSTWRD                  ;ARE WE GOING TO LIST IT.
  2293	402746'	254000	402756'	        GOTO    OPNIP0                  ;NO JUMP.
  2294	402747'	602040	007300	        IF.OFF  OF,WILD                 ;SKIP IF NOT WILD.
  2295	402750'	402000	000004'	        SETZM   OFILE+NAME              ;CLEAR NAME IF WILD.
  2296	402751'	620040	007300	        OFF     OF,WILD                 ;TURN OFF WILD BITS.
  2297	402752'	202040	000010'	        MOVEM   OF,OFILE+MOD            ;SET INTO STORAGE.
  2298	402753'	336000	000035'	        SKIPN   IFILE+NAME              ;SKIP IF FILE NAME.
  2299	402754'	435100	000300	        IORI    IF,WNAME!WEXT           ;ELSE MAKE NAME WILD.
  2300	402755'	202100	000041'	        MOVEM   IF,IFILE+MOD            ;SAVE THEM.
  2301	402756'	332000	000004'	OPNIP0: SKIPE   OFILE+NAME              ;OUTPUT NAME SPECIFIED?
  2302	402757'	254000	402763'	        GOTO    ONDEV                   ;YES - CHECK INPUT NAME.
  2303	402760'	260740	411716'		GOSUB	DREAM			;CREATE A NAME IF DISK
  2304	402761'	202140	000004'	        MOVEM   T1,OFILE+NAME           ;OUTPUT AND TAPE INPUT.
  2305	402762'	202200	000005'	        MOVEM   T2,OFILE+EXT            ;SAVE EXTENSION.
  2306	402763'	332000	000035'	ONDEV:  SKIPE   IFILE+NAME              ;INPUT NAME SPECIFIED?
  2307	402764'	254000	402770'	        GOTO    OFFDEV                  ;YES TAKE IT OFF THE DEVICE.
  2308	402765'	260740	411716'		GOSUB	DREAM			;CREATE A NAME IF DISK
  2309	402766'	202140	000035'	        MOVEM   T1,IFILE+NAME           ;OUTPUT AND TAPE INPUT.
  2310	402767'	202200	000036'	        MOVEM   T2,IFILE+EXT            ;SAVE THE EXTENSION FOR MME.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 34
MAGCON.MAC	 6-JUL-77 09:25		*** END OF COMMAND ***

  2311	402770'	336700	000051'	OFFDEV: SKIPN   IM,INPMOD               ;SKIP IF WE HAVE A MODE.
  2312	402771'	201700	413277'	        MOVEI   IM,ASCMOD               ;ELSE MAKE IT ASCII.
  2313	402772'	202700	000051'	        MOVEM   IM,INPMOD               ;SAVE THE MODE.
  2314	402773'	336640	000020'	        SKIPN   OM,OUTMOD               ;SKIP IF HAVE A MODE.
  2315	402774'	201640	413277'	        MOVEI   OM,ASCMOD               ;ELSE MAKE IT ASCII.
  2316	402775'	202640	000020'	        MOVEM   OM,OUTMOD               ;SAVE THE MODE.
  2317	402776'	336000	000063'	        SKIPN   LSTWRD                  ;ARE WE GOING TO LIST.
  2318	402777'	254000	403011'	        GOTO    CHKREC                  ;NO CHECK ON MODE.
  2319	403000'	607100	200020	        IF.OFF  IF,MTA!DSK,CANLST       ;JUMP IF DEVICE CAN'T DO IT.
  2320	403002'	306640	413353'	        CAIN    OM,OCTMOD               ;CAN'T HAVE OCTAL OUTPUT.
  2321	403003'	254000	410276'	        GOTO    BADMOD                  ;COMPLAIN.
  2322	403004'	660100	000400	        ON      IF,SCAN                 ;TURN ON THE SCAN BIT FOR MTA.
  2323	403005'	202100	000041'	        MOVEM   IF,IFILE+MOD            ;SAVE THEM.
  2324	403006'	201140	000120	        MOVEI   T1,^D80                 ;DEFAULT RECORD SIZE.
  2325	403007'	202140	000043'	        MOVEM   T1,IFILE+RECSIZ         ;SET THE RECORD SIZE.
  2326	403010'	402000	000042'	        SETZM   IFILE+BLKFCT            ;CLEAR BLOCKING FACTOR.
  2327	403011'	200140	000043'	CHKREC: MOVE    T1,IFILE+RECSIZ         ;GET THE INPUT RECORD SIZE.
  2328	403012'	336000	000012'	        SKIPN   OFILE+RECSIZ            ;IF THERE IS NOT AN OUTPUT
  2329	403013'	202140	000012'	        MOVEM   T1,OFILE+RECSIZ         ;SIZE USE THE INPUT SIZE.
  2330	403014'	306700	413353'	        CAIN    IM,OCTMOD               ;IS INPUT OCTAL.
  2331	403015'	254000	410301'	        GOTO    NOOCT                   ;CAN ONLY BE OUTPUT MODE.
  2332	403016'	302700	413340'	        CAIE    IM,IMGMOD               ;IS INPUT IMAGE.
  2333	403017'	254000	403043'	        GOTO    TSTOUT                  ;NO CHECK ON THE OUTPUT MODE.
  2334	403020'	302640	413353'	        CAIE    OM,OCTMOD               ;IF INPUT IS IMAGE THEN
  2335	403021'	306640	413340'	        CAIN    OM,IMGMOD               ;OUTPUT MUST BE IMAGE OR OCTAL.
  2336	403022'	334000	000000	        SKIPA                           ;OUTPUT IS RIGHT.
  2337	403023'	254000	410277'	        GOTO    MOD0ER                  ;MODE ERROR.
  2338	403024'	201140	000001	SETIMG: MOVEI   T1,ONE                  ;BLOCKING FACTOR FOR IMAGE.
  2339	403025'	306640	413353'	        CAIN    OM,OCTMOD               ;SKIP IF NOT OCTAL MODE.
  2340	403026'	402000	000003	        SETZM   T1                      ;CLEAR BLOCKING FACTOR FOR OCTAL.
  2341	403027'	202140	000042'	        MOVEM   T1,IFILE+BLKFCT         ;SET AS BLOCKING FACTOR.
  2342	403030'	202140	000011'	        MOVEM   T1,OFILE+BLKFCT         ;SET AS OUTPUT BLOCKING FACTOR.
  2343	403031'	201140	001750	        MOVEI   T1,^D1000               ;DEFAULT RECORD SIZE.
  2344	403032'	336000	000043'	        SKIPN   IFILE+RECSIZ            ;IS THERE A RECORD SIZE.
  2345	403033'	202140	000043'	        MOVEM   T1,IFILE+RECSIZ         ;SET OURS.
  2346	403034'	336000	000012'	        SKIPN   OFILE+RECSIZ            ;IS THERE AN OUTPUT ONE.
  2347	403035'	202140	000012'	        MOVEM   T1,OFILE+RECSIZ         ;SET THE DEFAULT.
  2348	403036'	620100	000040	        OFF     IF,SPAN                 ;CAN'T SPAN BLOCKS IN THIS MODE.
  2349	403037'	202100	000041'	        MOVEM   IF,IFILE+MOD            ;SAVE IN STORAGE.
  2350	403040'	620040	000040	        OFF     OF,SPAN                 ;CAN'T SPAN BLOCKS IN THIS MODE.
  2351	403041'	202040	000010'	        MOVEM   OF,OFILE+MOD            ;SAVE IN STORAGE.
  2352	403042'	254000	403052'	        GOTO    TSTCOM                  ;GO SEE IF WE START.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 35
MAGCON.MAC	 6-JUL-77 09:25		*** END OF COMMAND ***

  2353	403043'	302640	413353'	TSTOUT: CAIE    OM,OCTMOD               ;IS OUTPUT OCTAL
  2354	403044'	306640	413340'	        CAIN    OM,IMGMOD               ;OR IMAGE. IF SO TEST
  2355	403045'	334000	000000	        SKIPA                           ;THE INPUT FOR IMAGE.
  2356	403046'	254000	403052'	        GOTO    TSTCOM                  ;NONE OF THESE SO CONTINUE.
  2357	403047'	201700	413340'	        MOVEI   IM,IMGMOD               ;FORCE TO IMAGE INPUT.
  2358	403050'	202700	000051'	        MOVEM   IM,IFILE+CHRMOD         ;SAVE THE MODE.
  2359	403051'	254000	403024'	        GOTO    SETIMG                  ;SET IMAGE MODE.
  2360	403052'	554140	000642'	TSTCOM: HLRZ    T1,RETWRD               ;GET THE FLAG WORD FOR GO.
  2361	403053'	332000	000003	        SKIPE   T1                      ;SKIP IF IT IS TIME.
  2362	403054'	254000	400057'	        GOTO    NTHERE                  ;ELSE DO THE COMMAND AGAIN.
  2363	403055'	476000	000402'	        SETOM   RUNFLG                  ;SAY WE ARE NOW ACTIVE.
  2364	403056'	047140	000027	        MME     T1,.TIM                 ;GET OUR RUN TIME.
  2365	403057'	202140	000364'	        MOVEM   T1,%TIME                ;SAVE THE RUN TIME.
  2366	403060'	050100	000032'	        OPEN    IF,IFILE+STATUS         ;OPEN THE INPUT DEVICE.
  2367	403061'	265140	407741'	        JSP     T1,NODEV                ;CAN'T HAVE DEVICE.
  2368	403062'	200200	000020'	        MOVE    T2,CHRMOD+OFILE
  2369	403063'	306200	413516'	        CAIN    T2,VEBMOD
  2370				        JRST    [MOVEI T2,17
  2371				                 MOVEM T2,OFILE
  2372	403064'	254000	414206'	                 JRST TST1]
  2373	403065'	050040	000001'	TST1:   OPEN    OF,OFILE+STATUS         ;OPEN OUTPUT DEVICE.
  2374	403066'	265140	407741'	        JSP     T1,NODEV                ;CAN'T HAVE DEVICE.
  2375	403067'	200140	000016	        MOVE    T1,IM                   ;SET ARGUMENTS FOR GETTAB.
  2376	403070'	200200	000015	        MOVE    T2,OM                   ;SET OTHER.
  2377	403071'	332000	000670'		SKIPE	RPTFLG			;IF REPEATING, DO
  2378	403072'	254000	403075'		GOTO	.+3			;NOT GET SUBSTITUTIONS.
  2379	403073'	260740	412401'	        GOSUB   GETTAB                  ;LOAD THE TABLES.
  2380	403074'	260740	403660'	        GOSUB   SETSUB                  ;GET ANY SUBSTITUTIONS.
  2381	403075'	554156	000006	        HLRZ    T1,MSIZ(IM)             ;GET THE INPUT BYTE SIZE.
  2382	403076'	137140	414211'	        DPB     T1,[POINT 6,IBUF+1,11]  ;SET THE BYTE SIZE.
  2383	403077'	554155	000006	        HLRZ    T1,MSIZ(OM)             ;GET THE OUTPUT BYTE SIZE.
  2384	403100'	137140	414212'	        DPB     T1,[POINT 6,OBUF+1,11]  ;SET THE OUTPUT SIZE.
  2385	403101'	200156	000011	        MOVE    T1,STS(IM)              ;GET THE INPUT STATUS BITS.
  2386	403102'	607140	000002	        IF.OFF  T1,NIR,CHKOUT           ;JUMP IF DON'T NEED RECORD SIZE.
  2387	403104'	336000	000043'	        SKIPN   IFILE+RECSIZ            ;MAKE SURE WE HAVE IT.
  2388	403105'	254000	410244'	        GOTO    NOIREC                  ;GET A RECORD SIZE.
  2389	403106'	200155	000011	CHKOUT: MOVE    T1,STS(OM)              ;GET THE OUTPUT BITS.
  2390	403107'	607140	000001	        IF.OFF  T1,NOR,CHKDEV           ;JUMP IF DON'T NEED A RECORD SIZE.
  2391	403111'	336000	000012'	        SKIPN   OFILE+RECSIZ            ;ELSE MAKE SURE WE HAVE IT.
  2392	403112'	254000	410267'	        GOTO NOOREC
  2393	403113'	200140	000002'	CHKDEV: MOVE    T1,OFILE+DEVICE         ;LOAD AC WITH NAME WE HAVE.
  2394	403114'	047140	000064	        MME     T1,.NAM                 ;GET THE REAL NAME.
  2395	403115'	254000	403126'	        GOTO    SETINP                  ;FORGET IT IF MME FAILS.
  2396	403116'	200200	000033'	        MOVE    T2,IFILE+DEVICE         ;LOAD AC WITH OTHER'S NAME.
  2397	403117'	047200	000064	        MME     T2,.NAM                 ;GET ITS NAME.
  2398	403120'	254000	403126'	        GOTO    SETINP                  ;JUMP IF MME FAILS.
  2399	403121'	312140	000004	        CAME    T1,T2                   ;SEE IF THEY MATCH.
  2400	403122'	254000	403126'	        GOTO    SETINP                  ;NO MATCH SO O.K.
  2401	403123'	557000	000003	        HLRZS   T1                      ;EXCHANGE HALFS.
  2402	403124'	306140	556441	        CAIN    T1,'MTA'                ;MTA CAN'T GO BOTH WAYS.
  2403	403125'	254000	410304'	        GOTO    SAMDEV                  ;CAN'T DO INPUT AND OUTPUT TO ONE TAPE.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 36
MAGCON.MAC	 6-JUL-77 09:25		*** DO YOUR THING ***

  2404				SUBTTL                          *** DO YOUR THING ***
  2405
  2406				;HERE AFTER THE COMMAND DECODER TO SET UP BUFFERS
  2407				;IF DEVICE IS A MAG-TAPE.
  2408
  2409	403126'	200140	401707*	SETINP: MOVE    T1,JOBFF                ;PICK UP THE CURRENT JOBFF.
  2410	403127'	202140	000646'	        MOVEM   T1,IJOBFF               ;SAVE FOR LATER.
  2411	403130'	260740	407006'	        GOSUB   MONIBF                  ;GET SOME BUFFERS.
  2412	403131'	607040	000020	        IF.OFF  OF,MTA,SETIP            ;IS OUTPUT DEVICE A MAG-TAPE.
  2413	403133'	336140	000027'	        SKIPN T1,OFILE+FSTTAP
  2414	403134'	254000	403155'	        GOTO SETIN1
  2415	403135'	327140	403151'	        JUMPG T1,SETDIS
  2416	403136'	200140	000001'	        MOVE T1,OFILE+STATUS
  2417	403137'	602140	001000	        IF.ON T1,EVEN,SETIN2
  2418	403141'	402000	000027'	        SETZM OFILE+FSTTAP
  2419	403142'	254000	403155'	        GOTO SETIN1
  2420	403143'	201500	000001'	SETIN2: MOVEI SIDE,OFILE
  2421	403144'	260740	403221'	        GOSUB   SETBYT
  2422	403145'	202200	000425'	        MOVEM T2,MOVCHO
  2423	403146'	200200	414213'	        MOVE T2,[MTAPE OF,]
  2424	403147'	542140	000004	        HRRM T1,T2
  2425	403150'	202200	000431'	        MOVEM T2,DISOUT
  2426	403151'	200200	000431'	SETDIS: MOVE T2,DISOUT
  2427	403152'	256000	000004	        XCT T2
  2428	403153'	201140	000010	        MOVEI T1,^D8
  2429	403154'	137140	414212'	        DPB T1,[POINT 6,OBUF+1,11]
  2430	403155'	602040	020000	SETIN1: IF.OFF  OF,BWIND                ;SHOULD WE MOVE THE TAPE.
  2431	403156'	072040	000001	        DRIVE   OF,.REW                 ;REWIND THE TAPE.
  2432	403157'	607100	000020	SETIP:  IF.OFF  IF,MTA,SETOUT           ;JUMP IF NOT MAG-TAPE.
  2433	403161'	336140	000060'	        SKIPN T1,IFILE+FSTTAP
  2434	403162'	254000	403203'	        GOTO SETIP1
  2435	403163'	327140	403177'	        JUMPG T1,SETDIN
  2436	403164'	200140	000032'	        MOVE T1,IFILE+STATUS
  2437	403165'	602140	001000	        IF.ON T1,EVEN,SETIP2
  2438	403167'	402000	000060'	        SETZM IFILE+FSTTAP
  2439	403170'	254000	403203'	        GOTO SETIP1
  2440	403171'	201500	000032'	SETIP2: MOVEI SIDE,IFILE
  2441	403172'	260740	403221'	        GOSUB SETBYT
  2442	403173'	202200	000426'	        MOVEM T2,MOVCHI
  2443	403174'	200200	414214'	        MOVE T2,[MTAPE IF,]
  2444	403175'	542140	000004	        HRRM T1,T2
  2445	403176'	202200	000432'	        MOVEM T2,DISIN
  2446	403177'	200200	000432'	SETDIN: MOVE T2,DISIN
  2447	403200'	256000	000004	        XCT T2
  2448	403201'	201140	000010	        MOVEI T1,^D8
  2449	403202'	137140	414211'	        DPB T1,[POINT 6,IBUF+1,11]
  2450	403203'	602100	020000	SETIP1: IF.OFF  IF,BWIND                ;SHOULD WE REWIND INPUT.
  2451	403204'	072100	000001	        DRIVE   IF,.REW                 ;BACK TO LOAD POINT.
  2452	403205'	201140	000312'	        MOVEI   T1,IBUF                 ;GET POINTER TO BUFFER HEADER.
  2453	403206'	201500	000032'	        MOVEI   SIDE,IFILE              ;GET POINTER TO PARAMETERS.
  2454	403207'	260740	406626'	        GOSUB   MAKE                    ;BUILD THE BUFFERS.
  2455
  2456				;HERE TO SET UP THE OUTPUT BUFFERS IF MAG-TAPE
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 36-2
MAGCON.MAC	 6-JUL-77 09:25		*** DO YOUR THING ***

  2457				;IS THE OUTPUT DEVICE.
  2458
  2459	403210'	200140	403126*	SETOUT: MOVE    T1,JOBFF                ;COPY JOB FIRST FREE.
  2460	403211'	202140	000647'	        MOVEM   T1,OJOBFF               ;STORE FOR LATER.
  2461	403212'	260740	407007'	        GOSUB   MONOBF                  ;GET SOME BUTTERS.
  2462	403213'	607040	000020	        IF.OFF  OF,MTA,POSINP           ;START NOW IF THIS ISN'T A MAG-TAPE.
  2463	403215'	201140	000307'	        MOVEI   T1,OBUF                 ;GET POINTER TO BUFFER HEADER.
  2464	403216'	201500	000001'	        MOVEI   SIDE,OFILE              ;GET POINTER TO PARAMETERS.
  2465	403217'	260740	406626'	        GOSUB   MAKE                    ;BUILD THE BUFFERS.
  2466	403220'	254000	403257'	        GOTO POSINP
  2467
  2468	403221'	200152	000011	SETBYT: MOVE T1,RECSIZ(SIDE)    ;GET NO. OF CHARACTERS IN THIS RECORD
  2469	403222'	550212	000017	        HRRZ T2,CHRMOD(SIDE)    ;GET SIZE OF CHARACTER
  2470	403223'	554244	000006	        HLRZ T3,MSIZ(T2)
  2471	403224'	302200	413340'	        CAIE T2,IMGMOD          ;IMAGE MODE FOR FAST TAPES
  2472	403225'	306200	413353'	        CAIN T2,OCTMOD          ;OR OCTAL SO MAKE NEW BYTE SIZE
  2473	403226'	201240	000006	        MOVEI T3,6              ;NEW BYTE SIZE
  2474	403227'	202252	000026	        MOVEM T3,FSTTAP(SIDE)   ;SAVE NO. OF BITS PER BYTE
  2475	403230'	306200	413516'	        CAIN    T2,VEBMOD       ;IF VARIABLE DON'T DO BYTE ADJUST
  2476	403231'	254000	403251'	        JRST    SETBY1
  2477	403232'	200212	000007	        MOVE    T2,MOD(SIDE)    ;GET THE MODE BITS
  2478	403233'	606200	040000	        IF.OFF  T2,NOCRLF,SETBY1        ;DON'T DO BYTE ADJUST FOR VARIABLE
  2479	403235'	220140	000005	        IMUL T1,T3              ;COMPUTE NO. OF BITS PER RECORD
  2480	403236'	231140	000006	        IDIVI T1,6              ;GET ADJUSTED NO. OB BYTES
  2481	403237'	332000	000004	        SKIPE T2                ;SKIP IF NO REMAINDER
  2482	403240'	271140	000001	        ADDI T1,1               ;ADD 1 FOR PARTIAL BYTE
  2483	403241'	202152	000011	        MOVEM T1,RECSIZ(SIDE)   ;AND SAVE AS NEW RECORD SIZE
  2484	403242'	332012	000010	        SKIPE BLKFCT(SIDE)      ;SKIP IF NO BLOCKING FACTOR
  2485	403243'	220152	000010	        IMUL T1,BLKFCT(SIDE)    ;MULTIPLY BY BLOCKING FACTOR
  2486				;       IMUL T1,FSTTAP(SIDE)    ; GET # OF BITS PER BLOCK
  2487	403244'	231140	000004	        IDIVI T1,4              ;COMPUTE NEW NO. OF BYTES PER BLOCK
  2488	403245'	322200	403251'	        JUMPE   T2,SETBY1       ;IF EVEN WORDS, DONT WORRY
  2489	403246'	275200	000004	        SUBI    T2,4
  2490	403247'	213000	000004	        MOVNS   T2
  2491	403250'	334000	000000	        SKIPA
  2492	403251'	400200	000000	SETBY1: SETZ    T2,             ;EVEN WORDS ARGUMENT IT 201
  2493	403252'	200140	000004	        MOVE T1,T2              ;RETURN IN T1
  2494	403253'	271140	000201	        ADDI T1,201
  2495	403254'	201200	000052	        MOVEI T2,^D42           ;COMPUTE NO. OF PLACES TO ROTATE FOR
  2496	403255'	274212	000026	        SUB T2,FSTTAP(SIDE)     ; EXTRA BITS
  2497	403256'	263740	412060'	        RETURN ZERO
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 37
MAGCON.MAC	 6-JUL-77 09:25		*** DO YOUR THING ***

  2498				;HERE TO POSITION THE TAPES IF WE HAVE TAPES.
  2499
  2500	403257'	607100	000020	POSINP: IF.OFF  IF,MTA,POSOUT           ;JUMP IF NO INPUT TAPE.
  2501	403261'	072100	000000	        DRIVE   IF,.WAT                 ;STOP THE TAPE.
  2502	403262'	200300	000044'	        MOVE    P1,IFILE+ADVAN          ;GET THE ADVANCE COUNT.
  2503	403263'	274300	000054'	        SUB     P1,IFILE+BACSPC         ;SUBTRACT BACKSPACE COUNTER.
  2504	403264'	606000	001000	        IF.ON   S,EVEN                  ;IF EVEN PARITY THEN 
  2505	403265'	662000	010000	        TEO     S,NI.LST                ;IGNORE THESE ERRORS
  2506	403266'	322300	403302'	        JUMPE   P1,POSOUT               ;JUMP IF ALRIGHT.
  2507	403267'	327300	403272'	        JUMPG   P1,POSI0                ;JUMP IF ADVANCE.
  2508	403270'	213000	000006	        MOVNS   P1                      ;MAKE COUNT POSITIVE.
  2509	403271'	334340	414215'	        SKIPA   P2,[DRIVE IF,.BSF]      ;TO GO BACKWARDS.
  2510	403272'	200340	414216'	POSI0:  MOVE    P2,[DRIVE IF,.SKF]      ;TO GO FORWARDS.
  2511	403273'	256000	000007	        XCT     P2                      ;MOVE THE TAPE.
  2512	403274'	072100	000000	        DRIVE   IF,.WAT                 ;WAIT FOR IT.
  2513	403275'	367300	403273'	        SOJG    P1,.-2                  ;COUNT DOWN COUNTER.
  2514	403276'	312340	414215'	        CAME    P2,[DRIVE IF,.BSF]      ;DID WE GO BACKWARDS.
  2515	403277'	254000	403302'	        GOTO    POSOUT                  ;NO.
  2516	403300'	061100	004000	        STATO   IF,E.BOT                ;AT BEGINNING OF TAPE.
  2517	403301'	072100	000006	        DRIVE   IF,.SKR                 ;NO SKIP TAPE MARK.
  2518	403302'	607040	000020	POSOUT: IF.OFF  OF,MTA,DYT              ;JUMP IF NOT OUTPUT MTA.
  2519	403304'	072040	000000	        DRIVE   OF,.WAT                 ;BE SURE IT IS STOPPED.
  2520	403305'	200300	000013'	        MOVE    P1,OFILE+ADVAN          ;GET THE ADVANCE COUNTER.
  2521	403306'	274300	000023'	        SUB     P1,OFILE+BACSPC         ;SUBTRACT BACKSPACE COUNTER.
  2522	403307'	322300	403323'	        JUMPE   P1,DYT                  ;JUMP IF TAPES ARE O.K.
  2523	403310'	327300	403313'	        JUMPG   P1,POSO0                ;JUMP IF ADVANCE.
  2524	403311'	213000	000006	        MOVNS   P1                      ;MAKE COUNT POSITIVE.
  2525	403312'	334340	414217'	        SKIPA   P2,[DRIVE OF,.BSF]      ;TO GO BACKWARDS.
  2526	403313'	200340	414220'	POSO0:  MOVE    P2,[DRIVE OF,.SKF]      ;TO GO FORWARDS.
  2527	403314'	256000	000007	        XCT     P2                      ;MOVE THE TAPE.
  2528	403315'	072040	000000	        DRIVE   OF,.WAT                 ;WAIT FOR IT.
  2529	403316'	367300	403314'	        SOJG    P1,.-2                  ;COUNT DOWN COUNTER.
  2530	403317'	312340	414217'	        CAME    P2,[DRIVE OF,.BSF]      ;DID WE GO BACKWARDS.
  2531	403320'	254000	403323'	        GOTO    DYT                     ;NO...
  2532	403321'	061040	004000	        STATO   OF,E.BOT                ;AT BEGINNING OF TAPE.
  2533	403322'	072040	000006	        DRIVE   OF,.SKR                 ;SKIP TAPE MARK.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 38
MAGCON.MAC	 6-JUL-77 09:25		*** DO YOUR THING ***

  2534				;HERE TO START THE BALL OF WAX ROLLING.
  2535
  2536	403323'	260740	410747'	DYT:    GOSUB   LOKWLD                  ;GET A FILE NAME.
  2537	403324'	254000	410310'	        GOTO    NOWLD                   ;NONE TO GET.
  2538	403325'	666000	020000	GETINP: TEO     S,FFLG,CREIT            ;JUMP IF FIRST TIME.
  2539	403327'	606040	000300	        IF.OFF  OF,WNAME!WEXT,INIMOD    ;JUMP IF NOT WILD.
  2540	403331'	606040	000300	CREIT:	IF.OFF  OF,WNAME!WEXT,CREATE    ;JUMP IF NORMAL OUTPUT.
  2541	403333'	200300	000035'	        MOVE    P1,IFILE+NAME           ;GET THE NAME OF THE INPUT.
  2542	403334'	200340	000036'	        MOVE    P2,IFILE+EXT            ;GET ITS EXTENSION.
  2543	403335'	260740	411710'	        GOSUB   MOVNM0                  ;GET THE NAME OF THE OUTPUT.
  2544	403336'	260740	410505'	        GOSUB   ABORT                   ;ALWAYS SKIPS.
  2545	403337'	603040	000020	CREATE: IF.OFF  OF,MTA                  ;SKIP IF NOT MTA.
  2546	403340'	260740	405263'	        GOSUB   OUTLAB                  ;ELSE WRITE A LABEL.
  2547	403341'	510140	000002'		HLLZ	T1,DEVICE+OFILE		;SKIP IF NOT LPT.
  2548	403342'	316140	413630'		CAMN	T1,[SIXBIT /LPT/]
  2549	403343'	260740	406414'	        GOSUB   HDRLPT                  ;PUT OUT A HEADING.
  2550	403344'	607040	200000	        IF.OFF  OF,DSK,INIMOD           ;JUMP IF ENTER DOES NOTHING.
  2551	403346'	261740	000007'	        SAVE    OFILE+PPN               ;SAVE THE PPN WORD.
  2552	403347'	076040	000004'	        LOOKUP  OF,OFILE+NAME           ;SEE IF FILE EXISTS(UPDATE IF IT DOES).
  2553	403350'	254000	403355'	        GOTO    .+5
  2554				        EME     .STR,[ASCIZ "
  2555	403351'	051140	414221'	OKAY TO WRITE ON OLD FILE? "]
  2556	403352'	260740	401460'	        GOSUB   YESNO
  2557	403353'	254000	403356'	        GOTO    CREA1           	;ITS OK
  2558	403354'	254000	400057'	        GOTO    NTHERE
  2559	403355'	260740	410005'	        GOSUB   CHKLOK
  2560	403356'	513000	000005'	CREA1:  HLLZS 	OFILE+NAME+1
  2561	403357'	402000	000006'	        SETZM 	OFILE+NAME+2            ;ZERO OUT DATES
  2562	403360'	200157	000000	        MOVE 	T1,(PDP)           	;GET PPN AGAIN
  2563	403361'	202140	000007'	        MOVEM 	T1,OFILE+PPN            ;AND RESTORE FOR THIS ENTER
  2564	403362'	077040	000004'	        ENTER   OF,OFILE+NAME           ;CREATE A FILE.
  2565	403363'	254000	410010'	        GOTO    NOOPN                   ;CAN'T DO IT.
  2566	403364'	262740	000007'	        UNSAVE  OFILE+PPN               ;RESTORE IT.
  2567	403365'	201500	000001'	INIMOD: MOVEI   SIDE,OFILE              ;INDEX FOR OUTPUT FILE.
  2568	403366'	260740	406757'	        GOSUB   SECTOR                  ;COMPUTE SECTORS NEEDED.
  2569	403367'	201500	000032'	        MOVEI   SIDE,IFILE              ;INDEX FOR THE INPUT FILE.
  2570	403370'	260740	406757'		GOSUB   SECTOR                  ;GET THE INPUT SECTORS.
  2571	403371'	200500	000011'	        MOVE    OCNT,OFILE+BLKFCT       ;GET THE OUTPUT BLOCKING FACTOR.
  2572	403372'	200540	000042'	        MOVE    ICNT,IFILE+BLKFCT       ;GET THE INPUT BLOCKING FACTOR.
  2573	403373'	332000	000063'	        SKIPE   LSTWRD                  ;SKIP IF LISTING.
  2574	403374'	254000	403403'	        GOTO    PROD1                   ;JUMP WHEN LISTING.
  2575	403375'	260740	407174'	        GOSUB   FILL                    ;GET THE FIRST BUFFER.
  2576	403376'	254000	403422'	        GOTO    ENDCOP                  ;FILE IS ZERO LENGTH.
  2577	403377'	350000	000356'	        AOS     IRCNT                   ;COUNT FIRST RECORD.
  2578	403400'	350000	000357'	        AOS     IBCNT                   ;COUNT FIRST BLOCK.
  2579	403401'	350000	000352'		AOS	TIRCNT			;DO THE SAME FOR THE
  2580	403402'	350000	000353'		AOS	TIBCNT			;TOTAL COUNTS.
  2581	403403'	336000	000061'	PROD1:	SKIPN	IFILE+RECADV		;IF THE USER REQUESTED
  2582	403404'	254000	403416'		GOTO	PROD2			;THAT RECORDS BE
  2583	403405'	201140	000441'		MOVEI	T1,OMSAVE		;SKIPPED, THEN SET UP
  2584	403406'	504140	000020'		HRL	T1,OUTMOD		;A DUMMY MODE TABLE
  2585	403407'	251140	000453'		BLT	T1,LSTMEM		;WITH A "RETURN ZERO"
  2586	403410'	201200	412060'		MOVEI	T2,RET0			;INDICATED AS EACH
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 38-2
MAGCON.MAC	 6-JUL-77 09:25		*** DO YOUR THING ***

  2587	403411'	202200	000442'		MOVEM	T2,OMSAVE+1		;OUTPUT EXECUTION
  2588	403412'	515140	000442'		HRLZI	T1,OMSAVE+1
  2589	403413'	541140	000443'		HRRI	T1,OMSAVE+2
  2590	403414'	251140	000446'		BLT	T1,OMSAV5
  2591	403415'	201640	000441'		MOVEI	OM,OMSAVE
  2592	403416'	260775	000001	PROD2:  GOSUB   @OUTI(OM)               ;INITIALIZE OUTPUT.
  2593	403417'	332000	000063'	        SKIPE   LSTWRD                  ;SKIP IF LISTING.
  2594	403420'	254000	404063'	        GOTO    INILST                  ;GOT LIST A DIRECTORY.
  2595	403421'	260776	000000	        GOSUB   @INI(IM)                ;DISPATCH.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 39
MAGCON.MAC	 6-JUL-77 09:25		*** END OF CONVERSION ***

  2596				SUBTTL                          *** END OF CONVERSION ***
  2597
  2598				;HERE WHEN WE ARE DONE WITH A FILE.
  2599
  2600	403422'	350000	000365'	ENDCOP: AOS     IFCNT                   ;COUNT THE FILE.
  2601	403423'	336000	000063'	        SKIPN   LSTWRD                  ;SKIP IF LISTING.
  2602	403424'	332000	000062'	        SKIPE   TELWRD                  ;SKIP IF WANTS TO KNOW.
  2603	403425'	254000	403460'	        GOTO    PROCED                  ;ELSE SKIP IT.
  2604	403426'	606100	007300	        IF.OFF  IF,WILD,PROCED          ;JUMP IF INPUT ISN'T WILD.
  2605	403430'	201500	000032'		MOVEI	SIDE,IFILE		;WANT TO LOOK AT INPUT FILE.
  2606	403431'	603040	000010	        IF.OFF  OF,TTY                  ;SKIP IF OUTPUT ISN'T TO TTY.
  2607	403432'	051040	413554'	        EME     .CH,[EXP 12]            ;FORM THE PAGE.
  2608	403433'	200140	000520'	        MOVE    T1,PRGNAM               ;GET OUR NAME.
  2609	403434'	260740	410705'	        GOSUB   PUTSIX                  ;PRINT IT.
  2610	403435'	051140	413733'	        EME     .STR,[ASCIZ ": "]       ;DELIMIT THE NAME.
  2611	403436'	350000	000436'		AOS	COLUMN			;KEEP TRACK
  2612	403437'	350000	000436'		AOS	COLUMN			;OF CURSOR.
  2613	403440'	200440	000041'	        MOVE    P4,IFILE+MOD            ;GET THE MOD BITS.
  2614	403441'	620440	007300	        OFF     P4,WILD                 ;TURN OFF WILD BITS.
  2615	403442'	260740	410063'	        GOSUB   TYPNAM                  ;PRINT IT.
  2616	403443'	201300	000050		MOVEI	P1,^D40			;ADJUST COLUMN POSITION
  2617	403444'	274300	000436'		SUB	P1,COLUMN		;SO THAT WE LINE UP
  2618	403445'	361300	403451'	ENDCP1:	SOJL	P1,ENDCP2		;THE PRINTING OF THE
  2619	403446'	051140	413632'		EME	.STR,[ASCIZ " "]	;BLOCK AND RECORD COUNTS.
  2620	403447'	350000	000436'		AOS	COLUMN			;KEEP TRACK OF CURSOR.
  2621	403450'	254000	403445'		GOTO	ENDCP1
  2622	403451'	200300	000357'	ENDCP2:	MOVE	P1,IBCNT		;GET # BLOCKS READ FROM
  2623	403452'	260740	410672'		GOSUB	DECOUT			;THIS FILE AND PRINT IT.
  2624	403453'	051140	414227'		EME	.STR,[ASCIZ " BLK. "]	;PRINT THE IDENTIFIER.
  2625	403454'	200300	000356'		MOVE	P1,IRCNT		;GET # RECORDS READ FROM
  2626	403455'	260740	410672'		GOSUB	DECOUT			;THIS FILE AND PRINT IT.
  2627	403456'	051140	414231'		PRINT	( rec. read.)
  2628	403457'	402000	000436'			;PRINT THE IDENTIFIER.
  2629	403460'	402000	000357'	PROCED:	SETZM	IBCNT			;RESET FILE RECORD AND
  2630	403461'	402000	000356'		SETZM	IRCNT			;BLOCK COUNTS.
  2631	403462'	603040	000010		IF.OFF  OF,TTY                  ;SKIP IF NOT TTY.
  2632	403463'	070040	000000	        CLOSE   OF,ZERO                 ;FORCE TTY BUFFERS OUT.
  2633	403464'	051600	000000	        ENABLE  TTY                     ;CLEAR CONTROL O.
  2634	403466'	070100	000000	        CLOSE   IF,ZERO                 ;CLOSE INPUT FILE.
  2635	403467'	062100	000003	        GETSTS  IF,T1                   ;GET STATUS ON CLOSE.
  2636	403470'	602140	740000	        IF.OFF  T1,E.ERR                ;ERROR DURING CLOSE.
  2637	403471'	051140	414234'	        PRINT   (% Error during close of input file.)
  2638	403472'	402000	000436'
  2639	403473'	620000	004004	        OFF     S,PRG!FREAD             ;CLEAR PURGE BIT AND FIRST READ BIT.
  2640	403474'	606100	007300	        IF.OFF  IF,WILD,CLO1            ;IF NOT WILD INPUT CLOSE.
  2641	403476'	606040	000300	        IF.OFF  OF,WNAME!WEXT,NXTONE    ;JUMP IF NOT WILD OUTPUT.
  2642	403500'	350000	000366'	CLO1:   AOS     OFCNT                   ;COUNT OUTPUT FILE.
  2643	403501'	603040	040000	        IF.OFF  OF,LPT                  ;SKIP IF NOT LPT.
  2644	403502'	260740	406436'	        GOSUB   EOFLPT                  ;PUT OUT A HEADING.
  2645	403503'	260740	403615'	        GOSUB   CLO6                    ;CLOSE AND TEST FOR ERRORS
  2646	403504'	603040	000020	        IF.OFF  OF,MTA                  ;WRITE EOF LABEL IF MAG-TAPE.
  2647	403505'	260740	405316'	        GOSUB   EOFLAB                  ;WRITE A TRAILER.
  2648	403506'	336000	000063'	        SKIPN   LSTWRD                  ;SKIP IF LISTING.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 39-2
MAGCON.MAC	 6-JUL-77 09:25		*** END OF CONVERSION ***

  2649	403507'	332000	000062'	        SKIPE   TELWRD                  ;SKIP IF WANTS TO KNOW.
  2650	403510'	254000	403541'	        GOTO    CLO1A                   ;ELSE SKIP IT.
  2651	403511'	201500	000001'		MOVEI	SIDE,OFILE		;WANT TO LOOK AT OUTPUT FILE.
  2652	403512'	603040	000010	        IF.OFF  OF,TTY                  ;SKIP IF OUTPUT ISN'T TO TTY.
  2653	403513'	051040	413554'	        EME     .CH,[EXP 12]            ;FORM THE PAGE.
  2654	403514'	200140	000520'	        MOVE    T1,PRGNAM               ;GET OUR NAME.
  2655	403515'	260740	410705'	        GOSUB   PUTSIX                  ;PRINT IT.
  2656	403516'	051140	413733'	        EME     .STR,[ASCIZ ": "]       ;DELIMIT THE NAME.
  2657	403517'	350000	000436'		AOS	COLUMN			;KEEP TRACK
  2658	403520'	350000	000436'		AOS	COLUMN			;OF CURSOR.
  2659	403521'	200440	000010'	        MOVE    P4,OFILE+MOD            ;GET THE MOD BITS.
  2660	403522'	620440	007300	        OFF     P4,WILD                 ;TURN OFF WILD BITS.
  2661	403523'	260740	410063'	        GOSUB   TYPNAM                  ;PRINT IT.
  2662	403524'	201300	000050		MOVEI	P1,^D40			;ADJUST COLUMN POSITION SO
  2663	403525'	274300	000436'		SUB	P1,COLUMN		;THAT WE LINE UP THE
  2664	403526'	361300	403532'	CLO1B:	SOJL	P1,CLO1C		;PRINTING OF THE BLOCK
  2665	403527'	051140	413632'		EME	.STR,[ASCIZ " "]	;AND RECORD COUNTS.
  2666	403530'	350000	000436'		AOS	COLUMN			;KEEP TRACK OF CURSOR.
  2667	403531'	254000	403526'		GOTO	CLO1B
  2668	403532'	200300	000355'	CLO1C:	MOVE	P1,OBCNT		;GET # BLOCKS WRITTEN FROM
  2669	403533'	260740	410672'		GOSUB	DECOUT			;THIS FILE AND PRINT IT.
  2670	403534'	051140	414227'		EME	.STR,[ASCIZ " BLK. "]	;PRINT THE IDENTIFIER.
  2671	403535'	200300	000354'		MOVE	P1,ORCNT		;GET # RECORDS WRITTEN FROM
  2672	403536'	260740	410672'		GOSUB	DECOUT			;THIS FILE AND PRINT IT.
  2673	403537'	051140	414244'		PRINT	( rec. written.)
  2674	403540'	402000	000436'		;PRINT THE IDENTIFIER.
  2675	403541'	402000	000355'	CLO1A:	SETZM	OBCNT			;RESET FILE RECORD AND
  2676	403542'	402000	000354'		SETZM	ORCNT			;BLOCK COUNTS.
  2677	403543'	602100	007300	        IF.ON   IF,WILD,NXTONE          ;JUMP IF WILD INPUT.
  2678	403545'	607100	000020	CLO3:   IF.OFF  IF,MTA,CLO4             ;JUMP IF NOT MAG-TAPE.
  2679	403547'	602100	000002	        IF.OFF  IF,UNLOAD               ;SHOULD WE UNLOAD IT.
  2680	403550'	072100	000011	        DRIVE   IF,.UNL                 ;YES UNLOAD IT.
  2681	403551'	602100	010000	        IF.OFF  IF,AWIND                ;SKIP IF CAN MOVE IT.
  2682	403552'	072100	000001	        DRIVE   IF,.REW                 ;REWIND IT.
  2683	403553'	607040	000020	CLO4:   IF.OFF  OF,MTA,CLO5             ;JUMP IF OUTPUT ISN'T MTA.
  2684	403555'	602040	000002	        IF.OFF  OF,UNLOAD               ;SKIP IF CAN'T UNLOAD IT.
  2685	403556'	072040	000011	        DRIVE   OF,.UNL                 ;REWIND AND UNLOAD.
  2686	403557'	602040	010000	        IF.OFF  OF,AWIND                ;SKIP IF CAN'T MOVE IT.
  2687	403560'	072040	000001	        DRIVE   OF,.REW                 ;REWIND.
  2688	403561'	331000	000663'	CLO5:   SKIPL   MFILES
  2689	403562'	260740	411562'	        GOSUB   STAT                    ;THEN TELL HIM GOOD THINGS.
  2690	403563'	051600	000000	CLO5B:	ENABLE	TTY
  2691	403565'	260740	410441'	        GOSUB   CRLF
  2692	403566'	051140	414250'	        EME     .STR,[ASCIZ "REPEAT SPECIFICATIONS? "]
  2693	403567'	260740	401460'	        GOSUB   YESNO                   ;GET ANSWER
  2694	403570'	334000	000000	        SKIPA                           ;IF YES, GO GET FILE NAME
  2695				        GOTO    [SETZM RPTFLG
  2696				                SETZM   MFILES
  2697	403571'	254000	414255'	                GOTO    NTHERE]
  2698	403572'	200140	000657'	        MOVE 	T1,CCLCOR
  2699	403573'	331000	000656'	        SKIPL 	CCLFLG
  2700	403574'	554140	400110*	        HLRZ 	T1,JOBSA
  2701	403575'	202140	403210*	        MOVEM 	T1,JOBFF
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 39-3
MAGCON.MAC	 6-JUL-77 09:25		*** END OF CONVERSION ***

  2702	403576'	047140	000011	        MME 	T1,.CORE
  2703	403577'	255000	000000	        NOP
  2704	403600'	260740	403623'	        GOSUB   SETUP
  2705	403601'	254000	400244'	        GOTO    PERFOR
  2706	403602'	260740	410756'	NXTONE: GOSUB   GETNXT                  ;GET THE NEXT FILE.
  2707	403603'	254000	403607'	        GOTO    NOMORE                  ;NO MORE TO GET.
  2708	403604'	606040	000300	        IF.OFF  OF,WNAME!WEXT,GETINP    ;DON'T CLEAR COUNTERS IF NOT WILD.
  2709	403606'	254000	403325'	        GOTO    GETINP                  ;PROCESS THE FILE.
  2710	403607'	201140	403500'	NOMORE: MOVEI   T1,CLO1                 ;GET A DISPATCH ADDRESS.
  2711	403610'	602040	000300	        IF.OFF  OF,WNAME!WEXT           ;SKIP IF WILD OUTPUT.
  2712	403611'	201140	403545'	        MOVEI   T1,CLO3                 ;ELSE CHANGE DISPATCH.
  2713	403612'	620100	007300	        OFF     IF,WILD                 ;TURN OFF WILD BITS.
  2714	403613'	620040	007300	        OFF     OF,WILD                 ;IN BOTH SPECS.
  2715	403614'	254003	000000	        GOTO    ZERO(T1)                ;DISPATCH.
  2716
  2717	403615'	070040	000000	CLO6:   CLOSE   OF,ZERO                 ;WRITE AN EOF MARK
  2718	403616'	062040	000003	        GETSTS  OF,T1                   ;TEST FOR ERRORS
  2719	403617'	602140	740000	        IF.OFF  T1,E.ERR                ;ANY ERRORS.
  2720	403620'	051140	414260'	        PRINT   (? ERROR DURING CLOSE OF OUTPUT FILE.)
  2721	403621'	402000	000436'
  2722	403622'	263740	412060'	        RETURN  ZERO
  2723
  2724	403623'	402000	000000	SETUP:  SETZM S
  2725	403624'	476000	000670'	        SETOM RPTFLG
  2726	403625'	201140	403625'	        DIARET 
  2727				                 	;SET RETURN ADDRESS
  2728	403627'	201500	000032'		MOVEI	SIDE,IFILE		;SEE IF ANY CHANGES
  2729	403630'	476000	000645'	        SETOM   KLUDGE                  ;DON'T CLOBBER RETURN ADDRESS
  2730	403631'	260740	400571'		GOSUB	CHKENT			;TO THE SPECIFICATIONS
  2731	403632'	402000	000645'	        SETZM   KLUDGE                  ;MADE IT BACK OK
  2732	403633'	201140	403633'		DIARET
  2733	403635'	402000	000000		SETZM	S			;ARE DESIRED.
  2734	403636'	201500	000001'		MOVEI	SIDE,OFILE		;LOOK AT OUTPUT AND
  2735	403637'	476000	000645'	        SETOM   KLUDGE                  ;DON'T CLOBBER RETURN ADR
  2736	403640'	260740	400571'		GOSUB	CHKENT			;INPUT SPECS.
  2737	403641'	402000	000645'	        SETZM   KLUDGE                  ;MADE IT BACK AGAIN
  2738	403642'	476000	000660'	SETUP1: SETOM   DIAFLG                  ;CLEAR RETURN FLAG
  2739	403643'	402000	000642'	        SETZM   RETWRD
  2740	403644'	563000	000642'	        HRROS   RETWRD
  2741	403645'	402000	000377'	        SETZM   LSTDEV  		;TO KEEP SEARCH LIST STRAIGHT
  2742	403646'	402000	000350'	        SETZM   TORCNT
  2743	403647'	402000	000351'	        SETZM   TOBCNT
  2744	403650'	402000	000352'	        SETZM   TIRCNT
  2745	403651'	402000	000353'	        SETZM   TIBCNT
  2746	403652'	402000	000365'	        SETZM   IFCNT
  2747	403653'	402000	000366'	        SETZM   OFCNT
  2748	403654'	402000	000361'	        SETZM   NOCHR
  2749	403655'	402000	000363'	        SETZM   %IO
  2750	403656'	200500	000011'	        MOVE    OCNT,OFILE+BLKFCT
  2751	403657'	263740	412060'	        RETURN  ZERO
  2752
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 40
MAGCON.MAC	 6-JUL-77 09:25		*** END OF CONVERSION ***

  2753				;HERE TO GET ANY SUBSTITUTIONS THE USER WISHES TO MAKE
  2754	403660'	202140	000423'	SETSUB: MOVEM 	T1,TBSIZE         	;SAVE PTR TO GET SIZE OF INPUT TABLE
  2755	403661'	051140	414270'	        EME 	.STR,[ASCIZ "SUBSTITUTIONS? "]
  2756	403662'	260740	401460'	        GOSUB 	YESNO
  2757	403663'	254000	403666'	        GOTO	.+3
  2758	403664'	402000	000667'		SETZM 	SUBSTF
  2759	403665'	263740	412060'	        RETURN 	ZERO
  2760	403666'	476000	000667'	        SETOM 	SUBSTF
  2761	403667'	200140	000423'	        MOVE 	T1,TBSIZE
  2762	403670'	574243	000010	        HLRE 	T3,FPTR(T1)
  2763	403671'	210240	000005	        MOVN 	T3,T3
  2764	403672'	202240	000423'	        MOVEM 	T3,TBSIZE
  2765				SETSQ:  EME 	.STR,[ASCIZ "MAKE SUBSTITUTIONS:
  2766	403673'	051140	414274'	"]
  2767	403674'	051000	000014	SETS1:  EME 	CH          		;WAIT AND INPUT CHARACTER
  2768	403675'	306600	000015	        CAIN 	CH,15
  2769	403676'	254000	403674'	        GOTO    SETS1
  2770	403677'	306600	000012		CAIN 	CH,12
  2771	403700'	254000	403722'	        GOTO 	SETS2
  2772	403701'	305600	000040	        CAIGE 	CH,40
  2773	403702'	254000	403673'	        GOTO 	SETSQ
  2774	403703'	051140	414301'	        EME 	.STR,[ASCIZ " FOR "]
  2775	403704'	051000	000003	        EME 	T1
  2776	403705'	305600	000040	        CAIGE 	CH,40
  2777	403706'	254000	403673'	        GOTO 	SETSQ
  2778	403707'	051000	000004	        EME 	T2
  2779	403710'	302200	000012	        CAIE 	T2,12
  2780	403711'	254000	403707'	        GOTO 	.-2
  2781	403712'	200240	000423'	        MOVE 	T3,TBSIZE
  2782	403713'	554205	001710'	SETS3:  HLRZ 	T2,TAB1-1(T3)
  2783	403714'	312200	000003	        CAME 	T2,T1
  2784	403715'	254000	403720'	        GOTO 	.+3
  2785	403716'	550214	002311'	        HRRZ 	T2,TAB2(CH)
  2786	403717'	542205	001710'	        HRRM 	T2,TAB1-1(T3)
  2787	403720'	367240	403713'	        SOJG 	T3,SETS3
  2788	403721'	254000	403674'	        GOTO 	SETS1
  2789	403722'	263740	412060'	SETS2:  RETURN 	ZERO
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 41
MAGCON.MAC	 6-JUL-77 09:25		*** READ/WRITE LOOP ***

  2790				SUBTTL                          *** READ/WRITE LOOP ***
  2791
  2792				;HERE TO COUNT THE NEXT RECORD AND READ A BLOCK IF
  2793				;IT IS TIME.
  2794
  2795	403723'	363540	403727'	RENEW:  SOJLE   ICNT,REN1               ;JUMP IF TIME FOR A BLOCK.
  2796	403724'	350000	000356'	REN0:   AOS     IRCNT                   ;COUNT THE RECORD.
  2797	403725'	350000	000352'		AOS	TIRCNT
  2798	403726'	254000	412057'	        RETURN  ONE                     ;GIVE GOOD RETURN.
  2799	403727'	332540	000042'	REN1:   SKIPE   ICNT,IFILE+BLKFCT       ;SKIP IF THERE IS A BLOCKING FACTOR.
  2800	403730'	602100	000040	        IF.ON   IF,SPAN,REN5            ;JUMP IF SPANNING.
  2801	403732'	607100	200020	        IF.OFF  IF,DSK!MTA,REN5         ;JUMP IF NOT DSK OR MTA.
  2802	403734'	200140	000372'	REN2:   MOVE    T1,ISEC                 ;GET THE SECTORS READ.
  2803	403735'	311140	000052'	        CAML    T1,IBLK                 ;HAVE WE READ ENOUGH.
  2804	403736'	254000	403742'	        GOTO    REN3                    ;YES READ THE NEXT DATA BLOCK.
  2805	403737'	260740	407174'	        GOSUB   FILL                    ;SKIP OVER A BLOCK.
  2806	403740'	263740	412060'	        RETURN  ZERO                    ;END OF FILE.
  2807	403741'	254000	403734'	        GOTO    REN2                    ;TEST AGAIN.
  2808	403742'	402000	000372'	REN3:   SETZM   ISEC                    ;RESET SECTORS READ.
  2809	403743'	260740	407174'	        GOSUB   FILL                    ;GET A BLOCK.
  2810	403744'	263740	412060'	        RETURN  ZERO                    ;EOF FOUND.
  2811	403745'	350000	000357'	REN4:   AOS     IBCNT                   ;COUNT THE BLOCK.
  2812	403746'	350000	000353'		AOS	TIBCNT
  2813	403747'	254000	403724'	        GOTO    REN0                    ;GO COUNT THE RECORD.
  2814	403750'	662000	000004	REN5:   TNO     S,FREAD,REN4            ;JUMP IF NOT FIRST TIME HERE.
  2815	403752'	200140	000042'		MOVE	T1,IFILE+BLKFCT
  2816	403753'	307140	000001		CAIG	T1,1
  2817	403754'	254000	403757'		GOTO	REN6
  2818	403755'	350000	000357'		AOS	IBCNT
  2819	403756'	350000	000353'		AOS	TIBCNT
  2820	403757'	254000	412057'	REN6:	RETURN  ONE                     ;ELSE RETURN WITHOUT COUNTING.
  2821
  2822				;HERE TO SET THE COUNT RIGHT WHEN WE FINISH IN THE MIDDLE
  2823				;OF A RECORD FOR AN UNBLOCKED FILE.
  2824
  2825	403760'	476000	000012	SETCNT: SETOM   OCNT                    ;FLAG WE WRITE BLOCK.
  2826	403761'	332000	000042'	        SKIPE   IFILE+BLKFCT            ;IS IT BLOCKED.
  2827	403762'	263740	412060'	        RETURN  ZERO                    ;NO RETURN.
  2828	403763'	350000	000356'	        AOS     IRCNT                   ;COUNT THE RECORD.
  2829	403764'	350000	000357'	        AOS     IBCNT                   ;COUNT THE BLOCK.
  2830	403765'	350000	000352'		AOS	TIRCNT
  2831	403766'	350000	000353'		AOS	TIBCNT
  2832	403767'	263740	412060'	        RETURN  ZERO                    ;RETURN TO CALLER.
  2833
  2834				;HERE TO CONVERT THE CHARACTER AND CALL THE
  2835				;OUTPUT ROUTINE.
  2836
  2837	403770'	550614	001711'	CHANGE: HRRZ    CH,TAB1(CH)             ;CONVERT IT.
  2838	403771'	622600	400000	        TEZ     CH,NEC                  ;IS THIS A BAD CHARACTER.
  2839	403772'	350000	000361'	        AOS     NOCHR                   ;YES COUNT IT.
  2840	403773'	254035	000002	        GOTO    @OUTC(OM)               ;STACH THE CHARACTER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 42
MAGCON.MAC	 6-JUL-77 09:25		*** READ/WRITE LOOP ***

  2841				;HERE TO WRITE THE CURRENT BLOCK AND TO SEE IF WE MUST
  2842				;WRITE SOME BLANK ONES TO FILL OUT THE BLOCKING FACTOR.
  2843
  2844	403774'	312500	000011'	UPDAT:  CAME    OCNT,OFILE+BLKFCT       ;ARE WE AT A BLOCK BOUNDARY.
  2845	403775'	254000	404003'	        GOTO    UPDA                    ;NO SO WRITE THIS BLOCK.
  2846	403776'	263740	412060'	        RETURN  ZERO                    ;RETURN NOTHING TO WRITE.
  2847	403777'	350000	000354'	UPDATE: AOS     ORCNT                   ;COUNT THE RECORD PROCESSED.
  2848	404000'	350000	000350'		AOS	TORCNT
  2849	404001'	373000	000012	        SOSLE   OCNT                    ;TIME FOR A NEW BLOCK.
  2850	404002'	263740	412060'	        RETURN  ZERO                    ;NO BACK TO CALLER.
  2851	404003'	350000	000355'	UPDA:   AOS     OBCNT                   ;COUNT THE BLOCK.
  2852	404004'	260775	000004	        GOSUB   @OUTB(OM)               ;FINISH BLOCK OFF.
  2853	404005'	350000	000351'		AOS	TOBCNT
  2854	404006'	260740	412330'	        GOSUB   CHKOPR                  ;CHECK OPERATOR COMMAND.
  2855	404007'	332500	000011'	UPDB:   SKIPE   OCNT,OFILE+BLKFCT       ;IS THERE NO BLOCKING FACTOR.
  2856	404010'	602040	000040	        IF.OFF  OF,SPAN                 ;OR ARE WE SPANNING.
  2857	404011'	263740	412060'	        RETURN  ZERO                    ;IF SO, RETURN
  2858	404012'	607040	200020	        IF.ON   OF,DSK!MTA              ;IF NOT DSK OR MTA
  2859	404013'	263740	412060'	        RETURN  ZERO            ;DEVICE THEN RETURN
  2860	404014'	260740	407344'	        GOSUB   EMPTY                   ;TO THE DEVICE.
  2861	404015'	200140	000373'	UPD1:   MOVE    T1,OSEC                 ;GET THE SECTORS WRITTEN.
  2862	404016'	311140	000021'	        CAML    T1,OBLK                 ;HAVE WE WRITTEN ENOUGH.
  2863	404017'	254000	404024'	        GOTO    UPD2                    ;YES IT IS ALRIGHT.
  2864	404020'	133000	000310'	        IBP     OBUF+1                  ;SO IT WILL WRITE.
  2865	404021'	370000	000311'	        SOS     OBUF+2                  ;DECREMENT COUNT.
  2866	404022'	260740	407344'	        GOSUB   EMPTY                   ;WRITE EMPTY ONES.
  2867	404023'	254000	404015'	        GOTO    UPD1                    ;CONTINUE LOOP.
  2868	404024'	402000	000373'	UPD2:   SETZM   OSEC                    ;RESET SECTOR COUNTER.
  2869	404025'	263740	412060'	        RETURN  ZERO                    ;AND RETURN
  2870
  2871	404026'	350000	000366'	CHKT:   AOS     OFCNT                   ;COUNT OUTPUT FILE
  2872	404027'	402000	000355'		SETZM	OBCNT			;RESET BLOCK AND RECORD
  2873	404030'	402000	000354'		SETZM	ORCNT			;COUNTS FOR CURRENT FILE.
  2874	404031'	260740	403615'	        GOSUB   CLO6                    ;AND CLOSE IT
  2875	404032'	260740	411562'	        GOSUB   STAT                    ;OUTPUT STATS
  2876	404033'	051600	000000	        ENABLE  TTY
  2877	404035'	260740	410441'	        GOSUB   CRLF
  2878	404036'	051140	414303'	        EME     .STR,[ASCIZ "ANOTHER FILE? "]
  2879	404037'	260740	401460'	        GOSUB   YESNO
  2880	404040'	334000	000000	        SKIPA                           ;ANSWERED YES!
  2881	404041'	254000	403422'	        GOTO    ENDCOP                  ;FINISHED
  2882	404042'	260740	403623'	        GOSUB   SETUP                   ;SET IT UP FOR NEXT FILE
  2883	404043'	260740	401441'	        GOSUB   SETBLK                  ;GET NO. OF BLKS.
  2884	404044'	261740	000007'	        SAVE    OFILE+PPN
  2885	404045'	076040	000004'	        LOOKUP  OF,OFILE+NAME           ;WRITE FILE IN UPDATE MODE IF NECESSARY
  2886	404046'	260740	410005'	        GOSUB   CHKLOK                  ;AND CHECK FOR ANY ERRORS
  2887	404047'	077040	000004'	        ENTER   OF,OFILE+NAME
  2888	404050'	254000	410010'	        GOTO    NOOPN                   ;WE FAILED
  2889	404051'	262740	000007'	        UNSAVE  OFILE+PPN
  2890	404052'	660000	040000	        TRO     S,BAC           ;USE CHARACTER JUST PICKED UP FIRST
  2891	404053'	350000	000356'	        AOS     IRCNT
  2892	404054'	350000	000357'	        AOS     IBCNT
  2893	404055'	350000	000352'		AOS	TIRCNT
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 42-2
MAGCON.MAC	 6-JUL-77 09:25		*** READ/WRITE LOOP ***

  2894	404056'	350000	000353'		AOS	TIBCNT
  2895	404057'	260775	000001	        GOSUB   @OUTI(OM)               ;INITIALIZE OUTPUT
  2896	404060'	370017	000000	        SOS     0(PDP)
  2897	404061'	370017	000000	        SOS     0(PDP)
  2898	404062'	263740	412060'	        RETURN  ZERO
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 43
MAGCON.MAC	 6-JUL-77 09:25		*** LIST I/O ROUTINES ***

  2899				SUBTTL                  *** LIST I/O ROUTINES ***
  2900
  2901	404063'	660000	010000	INILST: ON      S,NI.LST                ;TURN NO ERROR BIT ON.
  2902	404064'	402000	000636'	        SETZM   LABTOT                  ;CLEAR TOTAL BLOCKS.
  2903	404065'	402000	000637'	        SETZM   LABCNT                  ;CLEAR TOTAL FILES.
  2904	404066'	402000	000654'	        SETZM   LSTSTR                  ;CLEAR LAST STRUCTURE FOUND.
  2905	404067'	402000	000655'	        SETZM   LSTPPN                  ;CLEAR LAST PPN FOUND.
  2906	404070'	607100	000020	IN0LST: IF.OFF  IF,MTA,IN1LST           ;JUMP IF INPUT ISN'T MTA.
  2907	404072'	402000	000634'	        SETZM   LABSIZ                  ;CLEAR FILE SIZE.
  2908	404073'	260740	407174'	INMLST: GOSUB   FILL                    ;FILL UP THE BUFFER.
  2909	404074'	254000	404102'	        GOTO    INELST                  ;FOUND EOF.
  2910	404075'	350000	000634'	        AOS     LABSIZ                  ;COUNT THE BLOCK IN THIS FILE.
  2911	404076'	350000	000357'	        AOS     IBCNT                   ;ACCUMULATE BLOCKS.
  2912	404077'	350000	000353'		AOS	TIBCNT			;ACCUMULATE TOTAL BLOCKS.
  2913	404100'	260740	412330'	        GOSUB   CHKOPR                  ;CHECK FOR A COMMAND.
  2914	404101'	254000	404073'	        GOTO    INMLST                  ;DO IT AGAIN.
  2915	404102'	062100	000003	INELST: GETSTS  IF,T1                   ;GET THE DEVICE STATUS.
  2916	404103'	606140	002000	        IF.OFF  T1,E.EOT,IN1LST         ;JUMP IF ERROR WASN'T EOT.
  2917	404105'	332000	000045'	        SKIPE   IFILE+LABEL             ;SKIP IF NOT LABELS.
  2918	404106'	254000	404073'	        GOTO    INMLST                  ;ELSE FIND THE LABEL.
  2919	404107'	201140	413277'	IN1LST: MOVEI   T1,ASCMOD               ;MUST HAVE ASCII INPUT TABLES.
  2920	404110'	200200	000015	        MOVE    T2,OM                   ;GET THE OUTPUT INDEX.
  2921	404111'	260740	412401'	        GOSUB   GETTAB                  ;GET THE RIGHT TABLES.
  2922	404112'	204140	000631'	        MOVS    T1,LABNAM+1             ;GET THE EXTENSION.
  2923	404113'	302140	654644	        CAIE    T1,'UFD'                ;IS THIS A UFD.
  2924	404114'	254000	404131'	        GOTO    INFLST                  ;NO LIST A FILE.
  2925	404115'	554140	000630'	        HLRZ    T1,LABNAM               ;GET THE PROJECT NUMBER.
  2926	404116'	260740	404263'	        GOSUB   INOLST                  ;LIST AN OCTAL NUMBER.
  2927	404117'	201600	000054	        MOVEI   CH,","                  ;TO SEPARATE THINGS.
  2928	404120'	260740	403770'	        GOSUB   CHANGE                  ;PUT THE CHARACTER AWAY.
  2929	404121'	550140	000630'	        HRRZ    T1,LABNAM               ;GET THE OTHER HALF.
  2930	404122'	260740	404227'	        GOSUB   IN3LST                  ;PRINT IT.
  2931	404123'	363300	404127'	        SOJLE   P1,INULST               ;JUMP IF DONE ENOUGH.
  2932	404124'	201600	000040	        MOVEI   CH," "                  ;LOAD A SPACE.
  2933	404125'	260740	403770'	        GOSUB   CHANGE                  ;PUT IT AWAY.
  2934	404126'	254000	404123'	        GOTO    .-3                     ;CONTINUE ON.
  2935	404127'	001040	414306'	INULST: UME     .ASC,[ASCIZ "  "]       ;TAB TO NEXT ZONE.
  2936	404130'	254000	404134'	        GOTO    INXLST                  ;DO THE REST.
  2937	404131'	001100	000630'	INFLST: UME     .SIX,LABNAM             ;TYPE THE NAME.
  2938	404132'	001040	414307'	        UME     .ASC,[ASCIZ "   "]      ;TAB A LITTLE.
  2939	404133'	001100	000631'	        UME     .SIX,LABNAM+1           ;TYPE THE EXTENSION.
  2940	404134'	336000	000064'	INXLST: SKIPN   FSTWRD                  ;SKIP IF FAST LIST.
  2941	404135'	260740	404242'	        GOSUB   IN4LST                  ;TYPE OTHER GOOD THINGS.
  2942	404136'	200140	000627'	        MOVE    T1,LABSTR               ;GET THIS STRUCTURE.
  2943	404137'	316140	000654'	        CAMN    T1,LSTSTR               ;SKIP IF DIFFERENT FROM LAST.
  2944	404140'	254000	404152'	        GOTO    IN2LST                  ;DON'T TYPE IF THE SAME.
  2945	404141'	202140	000654'	        MOVEM   T1,LSTSTR               ;SAVE AS THE LAST ONE.
  2946	404142'	200300	414310'	        MOVE    P1,[POINT 6,LABSTR]     ;POINTER TO STORAGE.
  2947	404143'	134600	000006	IN6LST: ILDB    CH,P1                   ;GET A CHARACTER.
  2948	404144'	322600	404151'	        JUMPE   CH,IN7LST               ;JUMP IF DONE.
  2949	404145'	201614	000040	        MOVEI   CH," "(CH)              ;CONVERT TO ASCII.
  2950	404146'	260740	403770'	        GOSUB   CHANGE                  ;STORE IT AWAY.
  2951	404147'	603300	770000	        IF.ON   P1,77B5,IN6LST          ;JUMP IF MORE.
  2952
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 44
MAGCON.MAC	 6-JUL-77 09:25		*** LIST I/O ROUTINES ***

  2953	404151'	001040	414311'	IN7LST: UME     .ASC,[ASCIZ ":   "]     ;TAB A LITTLE.
  2954	404152'	336300	000633'	IN2LST: SKIPN   P1,LABPPN               ;SKIP IF A PPN IS THERE.
  2955	404153'	254000	404172'	        GOTO    IN8LST                  ;ELSE SKIP AHEAD.
  2956	404154'	316300	000655'	        CAMN    P1,LSTPPN               ;SKIP IF DIFFERENT.
  2957	404155'	254000	404172'	        GOTO    IN8LST                  ;ELSE SKIP AHEAD.
  2958	404156'	202300	000655'	        MOVEM   P1,LSTPPN               ;SAVE AS THE LAST PPN.
  2959	404157'	201600	000133	        MOVEI   CH,"["                  ;TO SPECIFY PPN COMING.
  2960	404160'	260740	403770'	        GOSUB   CHANGE                  ;PUT IT AWAY.
  2961	404161'	554140	000006	        HLRZ    T1,P1                   ;GET THE PROJECT NUMBER.
  2962	404162'	260740	404227'	        GOSUB   IN3LST                  ;PRINT IT.
  2963	404163'	201600	000054	        MOVEI   CH,","                  ;TO SEPARATE P FROM PN.
  2964	404164'	260740	403770'	        GOSUB   CHANGE                  ;PRINT IT.
  2965	404165'	550140	000633'	        HRRZ    T1,LABPPN               ;GET THE OTHER HALF.
  2966	404166'	260740	404227'	        GOSUB   IN3LST                  ;PRINT IT.
  2967	404167'	201600	000135	        MOVEI   CH,"]"                  ;TO FINISH IT OFF.
  2968	404170'	260740	410121'	        GOSUB   NAMOUT          ;IF WE CAN GET NAME, OUTPUT IT.
  2969	404171'	260740	403770'	        GOSUB   CHANGE                  ;SEND IT.
  2970	404172'	260775	000003	IN8LST: GOSUB   @OUTR(OM)               ;CALL OUTPUT ROUTINE TO FINISH RECORD.
  2971	404173'	603040	000010	        IF.OFF  OF,TTY                  ;SKIP IF NOT TTY.
  2972	404174'	260740	407344'	        GOSUB   EMPTY                   ;ELSE EMPTY THE BUFFER.
  2973	404175'	607100	000020	        IF.OFF  IF,MTA,INNLST           ;GET NEXT IF NOT MTA.
  2974	404177'	062100	000003	        GETSTS  IF,T1                   ;GET THE DEVICE STATUS.
  2975	404200'	602140	002000	        IF.ON   T1,E.EOT,INDLST         ;IF EOT WE ARE DONE.
  2976	404202'	260740	404223'	INNLST: GOSUB   NXTGET                  ;GET THE NEXT ONE.
  2977	404203'	254000	404070'	        GOTO    IN0LST                  ;CARRY ON.
  2978	404204'	260775	000003	INDLST: GOSUB   @OUTR(OM)               ;SKIP A LINE.
  2979	404205'	332000	000064'	        SKIPE   FSTWRD                  ;SKIP IF NORMAL LIST.
  2980	404206'	254000	404217'	        GOTO    INZLST                  ;FINISH UP.
  2981	404207'	001040	414312'	        UME     .ASC,[ASCIZ "   TOTAL OF "]
  2982	404210'	200140	000636'	        MOVE    T1,LABTOT               ;TOTAL BLOCKS.
  2983	404211'	260740	404230'	        GOSUB   IN3ALT                  ;ENTER IT.
  2984	404212'	001040	414315'	        UME     .ASC,[ASCIZ " BLOCKS IN "]
  2985	404213'	200140	000637'	        MOVE    T1,LABCNT               ;TOTAL FILES.
  2986	404214'	260740	404230'	        GOSUB   IN3ALT                  ;ENTER IT.
  2987	404215'	001040	414320'	        UME     .ASC,[ASCIZ " FILES."]
  2988	404216'	260775	000003	        GOSUB   @OUTR(OM)               ;FINISH LINE.
  2989	404217'	260775	000005	INZLST: GOSUB   @OUTF(OM)               ;FINISH OFF THE FILE.
  2990	404220'	620100	007300	        OFF     IF,WILD                 ;TURN OFF WILD BITS.
  2991	404221'	620000	010000	        OFF     S,NI.LST                ;TURN OFF NO ERROR BIT.
  2992	404222'	254000	403422'	        GOTO    ENDCOP                  ;ALL DONE HERE.
  2993	404223'	260740	412033'	NXTGET: GOSUB   STORE                   ;SAVE THE AC'S.
  2994	404224'	260740	410756'	        GOSUB   GETNXT                  ;GET THE NEXT FILE.
  2995	404225'	254000	412057'	        RETURN  ONE                     ;NONE TO GET.
  2996	404226'	263740	412060'	        RETURN  ZERO                    ;RETURN WITH NEXT.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 45
MAGCON.MAC	 6-JUL-77 09:25		*** LIST I/O ROUTINES ***

  2997	404227'	334340	414322'	IN3LST: SKIPA   P2,[10]                 ;SET BASE TO BASE 8.
  2998	404230'	201340	000012	IN3ALT: MOVEI   P2,^D10                 ;SET BASE TO BASE 10.
  2999	404231'	201300	000007	        MOVEI   P1,^D7                  ;SO WE KNOW HOW MANY WENT.
  3000	404232'	231147	000000	        IDIVI   T1,ZERO(P2)             ;SLICE OFF A DIGIT.
  3001	404233'	506217	000000	        HRLM    T2,ZERO(PDP)            ;SAVE A DIGIT.
  3002	404234'	370000	000006	        SOS     P1                      ;COUNT THE DIGIT.
  3003	404235'	332000	000003	        SKIPE   T1                      ;SKIP IF DONE.
  3004	404236'	260740	404232'	        GOSUB   IN3ALT+2                ;DO THE NEXT ONE.
  3005	404237'	554617	000000	        HLRZ    CH,ZERO(PDP)            ;GET A DIGIT.
  3006	404240'	201614	000060	        MOVEI   CH,"0"(CH)              ;MAKE IT ASCII.
  3007	404241'	254000	403770'	        GOTO    CHANGE                  ;PUT IT AWAY...
  3008	404242'	350000	000637'	IN4LST: AOS     LABCNT                  ;COUNT THE FILE.
  3009	404243'	200140	000634'	        MOVE    T1,LABSIZ               ;GET THE FILE SIZE.
  3010	404244'	272140	000636'	        ADDM    T1,LABTOT               ;UPDATE THE TOTAL.
  3011	404245'	260740	404264'	        GOSUB   IN9LST                  ;ENTER IT.
  3012	404246'	001040	414323'	        UME     .ASC,[ASCIZ "   <"]     ;FLAG PROTECTION COMING.
  3013	404247'	135140	414324'	        LDB     T1,[POINT 9,LABDTW,8]   ;GET THE PROTECTION.
  3014	404250'	201600	000060	        MOVEI   CH,"0"                  ;IF WE MUST PAD.
  3015	404251'	307140	000077	        CAIG    T1,77                   ;SKIP IF NOT NEED.
  3016	404252'	260740	403770'	        GOSUB   CHANGE                  ;PAD A ZERO.
  3017	404253'	307140	000007	        CAIG    T1,7                    ;SEE IF NEED ANOTHER.
  3018	404254'	260740	403770'	        GOSUB   CHANGE                  ;PUT IT IN.
  3019	404255'	260740	404227'	        GOSUB   IN3LST                  ;PLACE IT.
  3020	404256'	001040	414325'	        UME     .ASC,[ASCIZ ">   "]     ;FINISH IT OFF.
  3021	404257'	550140	000632'	        HRRZ    T1,LABDTW               ;GET THE DATE.
  3022	404260'	260740	410623'	        GOSUB   PUTXDT                  ;PRINT THE DATE.
  3023	404261'	001040	414307'	        UME     .ASC,[ASCIZ "   "]      ;TO NEXT ZONE.
  3024	404262'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  3025	404263'	334340	414322'	INOLST: SKIPA   P2,[10]                 ;SET THE BASE.
  3026	404264'	201340	000012	IN9LST: MOVEI   P2,^D10                 ;SET THE BASE.
  3027	404265'	201300	000007	        MOVEI   P1,^D7                  ;CHARACTERS TO PRINT.
  3028	404266'	231147	000000	I90LST: IDIVI   T1,ZERO(P2)             ;SLICE OFF A DIGIT.
  3029	404267'	506217	000000	        HRLM    T2,ZERO(PDP)            ;SAVE THE DIGIT.
  3030	404270'	370000	000006	        SOS     P1                      ;COUNT THE DIGIT.
  3031	404271'	326140	404276'	        JUMPN   T1,I92LST               ;JUMP IF MORE.
  3032	404272'	201600	000040	I91LST: MOVEI   CH," "                  ;LOAD A SPACE.
  3033	404273'	363300	404277'	        SOJLE   P1,I93LST               ;JUMP IF ENOUGH.
  3034	404274'	260740	403770'	        GOSUB   CHANGE                  ;FILL WITH A SPACE.
  3035	404275'	254000	404272'	        GOTO    I91LST                  ;CHECK AGAIN.
  3036	404276'	260740	404266'	I92LST: GOSUB   I90LST                  ;GET THE NEXT ONE.
  3037	404277'	554617	000000	I93LST: HLRZ    CH,ZERO(PDP)            ;GET A DIGIT.
  3038	404300'	201614	000060	        MOVEI   CH,"0"(CH)              ;CONVERT IT TO ASCII.
  3039	404301'	254000	403770'	        GOTO    CHANGE                  ;PUT IT AWAY.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 46
MAGCON.MAC	 6-JUL-77 09:25		*** ASCII I/O ROUTINES ***

  3040				SUBTTL                  *** ASCII I/O ROUTINES ***
  3041
  3042				;HERE TO READ ASCII CHARACTERS FROM THE INPUT
  3043				;FILE AND SEND THEM TO THE OUTPUT FILES. HANDLES SEVEN
  3044				;EIGHT, OR NINE BIT ASCII.
  3045
  3046	404302'	200340	000043'	INIASC: MOVE    P2,IFILE+RECSIZ         ;LOAD THE RECORD SIZE.
  3047	404303'	201300	000010	IN5ASC: MOVEI   P1,^D8                  ;TAB COUNT.
  3048	404304'	260740	407154'	IN0ASC: GOSUB   GET                     ;GET A CHARACTER.
  3049	404305'	254035	000005	        GOTO    @OUTF(OM)               ;END OF FILE.
  3050	404306'	405600	000177	        ANDI    CH,177                  ;JUST THE DATA BITS.
  3051	404307'	322600	404304'	        JUMPE   CH,IN0ASC               ;IGNORE NULLS.
  3052	404310'	202600	000433'	        MOVEM CH,SAVCH
  3053	404311'	306600	000015	        CAIN    CH,15                   ;IS IT END OF RECORD.
  3054	404312'	254000	404322'	        GOTO    IN1ASC                  ;YES PROCESS EOR.
  3055	404313'	306600	000011	        CAIN    CH,11                   ;IS IT A TAB.
  3056	404314'	254000	404351'	        GOTO    IN2ASC                  ;TAKE CARE OF IT.
  3057	404315'	260740	403770'	IN3ASC: GOSUB   CHANGE                  ;SEND IT.
  3058	404316'	602100	040000	        IF.OFF  IF,NOCRLF               ;SKIP IF CRLF'S ARE EXPECTED.
  3059	404317'	363340	404336'	        SOJLE   P2,IN6ASC               ;JUMP IF END OF RECORD.
  3060	404320'	367300	404304'	        SOJG    P1,IN0ASC               ;JUMP IF TAB IS GOOD.
  3061	404321'	254000	404303'	        GOTO    IN5ASC                  ;CONTINUE ON.
  3062	404322'	606100	040000	IN1ASC: IF.OFF  IF,NOCRLF,IN9ASC        ;JUMP IF CRLF'S ARE EXPECTED.
  3063	404324'	332000	000043'	        SKIPE   IFILE+RECSIZ            ;IS THERE A RECORD SIZE.
  3064	404325'	254000	410231'	        GOTO    BADFOM                  ;CAN'T HAVE RECSIZ IF CRLF PRESENT.
  3065	404326'	332000	000414'	IN9ASC: SKIPE ULTRAT
  3066	404327'	254000	404360'	        GOTO FIXULT
  3067	404330'	260740	407154'	        GOSUB   GET                     ;GET THE NEXT CHARACTER.
  3068	404331'	254035	000005	        GOTO    @OUTF(OM)               ;END OF FILE FOUND.
  3069	404332'	405600	000177	        ANDI    CH,177                  ;JUST THE DATA BITS.
  3070	404333'	322600	404322'	        JUMPE   CH,IN1ASC               ;IGNORE NULLS.
  3071	404334'	302600	000012	        CAIE    CH,12                   ;IS IT A LINE FEED.
  3072	404335'	660000	040000	        ON      S,BAC                   ;NO SO REGET IT.
  3073	404336'	260740	403723'	IN6ASC: GOSUB   RENEW                   ;HANDLE END OF RECORD.
  3074	404337'	254035	000005	        GOTO    @OUTF(OM)               ;END OF FILE FOUND.
  3075	404340'	260775	000003	        GOSUB   @OUTR(OM)               ;FINISH THE OUTPUT RECORD.
  3076	404341'	332140	000061'		SKIPE	T1,IFILE+RECADV		;ARE WE FINISHED
  3077	404342'	602100	000040		IF.OFF	IF,SPAN			;ADVANCING RECORDS?
  3078	404343'	370000	000003		SOS	T1
  3079	404344'	311140	000356'		CAML	T1,IRCNT
  3080	404345'	254000	404302'		GOTO	INIASC			;IF SO, THEN SET UP TO
  3081	404346'	200640	000020'		MOVE	OM,OUTMOD		;OUTPUT TO DEVICE.
  3082	404347'	260775	000001		GOSUB	@OUTI(OM)		;INIT. OUTPUT ROUTINE.
  3083	404350'	254000	404302'	        GOTO    INIASC                  ;CONTINUE ON.
  3084	404351'	200155	000011	IN2ASC: MOVE    T1,STS(OM)              ;GET THE OUTPUT STATE WORD.
  3085	404352'	603140	000010	        IF.ON   T1,TAB,IN3ASC           ;JUMP IF OUTPUT HAS TABS
  3086	404354'	201600	000040	IN4ASC: MOVEI   CH," "                  ;LOAD A SPACE.
  3087	404355'	260740	403770'	        GOSUB   CHANGE                  ;INTO OUTPUT BUFFER.
  3088	404356'	367300	404354'	        SOJG    P1,IN4ASC               ;CONTINUE FOR TAB COUNT.
  3089	404357'	254000	404303'	        GOTO    IN5ASC                  ;RESET THE TAB COUNTER.
  3090
  3091	404360'	201600	000025	FIXULT: MOVEI CH,25     ;THE END OF RECORD THEY WANT
  3092	404361'	260740	403771'	        GOSUB CHANGE+1
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 46-2
MAGCON.MAC	 6-JUL-77 09:25		*** ASCII I/O ROUTINES ***

  3093	404362'	254000	404330'	        GOTO IN9ASC+2
  3094
  3095				EQUATE  INIASC,<INIGEA,INIHPA>
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 47
MAGCON.MAC	 6-JUL-77 09:25		*** ASCII I/O ROUTINES ***

  3096				;HERE TO INITIALIZE THE ASCII OUTPUT ROUTINE.
  3097
  3098	404363'	200400	000012'	OTIASC: MOVE    P3,OFILE+RECSIZ         ;SET UP RECORD SIZE.
  3099	404364'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  3100
  3101				;HERE TO ENTER ONE ASCII CHARACTER INTO THE OUTPUT BUFFER.
  3102
  3103	404365'	334140	414326'	OTCASC: SKIPA T1,[1]    ;IF NORMAL ENTRY, USE 1
  3104	404366'	400140	000000	        SETZ T1,        ;IF FROM OTRASC, SKIP CHECKS
  3105	404367'	202140	000424'	        MOVEM T1,SKPCHK
  3106	404370'	322600	412060'	        JUMPE   CH,RET0                 ;DON'T SAVE NULLS.
  3107	404371'	620000	000002	        OFF     S,EOR                   ;NOT AT RECORD END NOW.
  3108	404372'	602040	040000	        IF.OFF OF,NOCRLF                ;SKIP IF CRLF'S ARE EXPECTED
  3109
  3110	404373'	361400	404377'	        SOJL    P3,OT0ASC               ;JUMP IF RECORD IS FULL.
  3111	404374'	332000	000416'	        SKIPE   DELBLK
  3112	404375'	254000	404453'	        GOTO    CHKBLN
  3113	404376'	260740	407334'	        GOSUB   PUT                     ;WRITE THE CHARACTER.
  3114	404377'	200600	000433'	OT0ASC: MOVE CH,SAVCH
  3115	404400'	307600	000024	        CAIG    CH,24                   ;IS IT A SPECIAL CHARACTER.
  3116	404401'	254000	404410'	        GOTO    OT2ASC                  ;YES SEE IF SPECIAL CHARACTER.
  3117	404402'	620000	000001	OT1ASC: OFF     S,FF                    ;NOT AT TOP OF FORM.
  3118	404403'	336000	000424'	        SKIPN SKPCHK
  3119	404404'	263740	412060'	        RETURN ZERO
  3120	404405'	336000	000415'	        SKIPN   RETCHR
  3121	404406'	322400	404422'	        JUMPE P3,OTRAC0
  3122	404407'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  3123	404410'	302600	000012	OT2ASC: CAIE    CH,12                   ;IS IT A LINE FEED.
  3124	404411'	306600	000013	        CAIN    CH,13                   ;OR VERTICAL TAB.
  3125	404412'	254000	404420'	        GOTO    OT3ASC                  ;YES NO LONGER AT THE TOP.
  3126	404413'	301600	000021	        CAIL    CH,21                   ;DEVICE CONTROL CHARACTER.
  3127	404414'	254000	404420'	        GOTO    OT3ASC                  ;YES NOT AT TOP ANY MORE.
  3128	404415'	302600	000014	        CAIE    CH,14                   ;IS IT A FORM FEED.
  3129	404416'	254000	404402'	        GOTO    OT1ASC                  ;NO SO EXIT.
  3130	404417'	664000	000001	        TROA    S,FF                    ;NOW AT TOP OF PAGE.
  3131	404420'	620000	000001	OT3ASC: OFF     S,FF                    ;NOT AT TOP OF FORM.
  3132	404421'	254000	404363'	        GOTO    OTIASC                  ;RESET RECORD COUNTER. FOR THESE.
  3133
  3134				;HERE TO FINISH OFF THE ASCII RECORD.
  3135
  3136	404422'	260740	403760'	OTRAC0: GOSUB   SETCNT                  ;SET UP COUNTERS.
  3137	404423'	660000	000002	OTRASC: ON      S,EOR                   ;AT END OF RECORD.
  3138	404424'	606040	040000	        IF.OFF  OF,NOCRLF,OTRAS1        ;JUMP IF FILE CAN HAVE CRLF'S.
  3139	404426'	201600	000040	        MOVEI   CH," "                  ;SPACE FILL THE RECORD.
  3140	404427'	260740	404366'	        GOSUB   OTCASC+1                        ;UNTIL THE COUNTER RUNS OUT.
  3141	404430'	325400	404426'	        JUMPGE  P3,.-2                  ;UNTIL IT FINISHES CONTINUE.
  3142	404431'	660000	000002	        ON S,EOR                ;MAKE SURE EOR BIT IS SET
  3143	404432'	603040	200020	        IF.ON   OF,MTA!DSK,OTRAS2       ;JUMP UNLESS THIS IS AN ASCII ONLY DEVICE.
  3144	404434'	402000	000417'	OTRAS1: SETZM SPCNT
  3145	404435'	201600	000015	        MOVEI   CH,15                   ;GET A RETURN.
  3146	404436'	260740	407334'	        GOSUB   PUT                     ;INTO THE BUFFER.
  3147	404437'	201600	000012	        MOVEI   CH,12                   ;AND A LINE FEED.
  3148	404440'	260740	407334'	        GOSUB   PUT                     ;INTO THE BUFFER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 47-2
MAGCON.MAC	 6-JUL-77 09:25		*** ASCII I/O ROUTINES ***

  3149	404441'	402000	000014	OTRAS2: SETZM   CH                      ;SET THE CHARACTER TO NULL
  3150	404442'	332000	000027'	        SKIPE   OFILE+FSTTAP            ;CHECK FOR FAST TAPE
  3151	404443'	260740	407401'	        GOSUB   FIXFST                  ;IF IT IS, FINISH THE RECORD
  3152	404444'	332000	000027'	        SKIPE   OFILE+FSTTAP            ;AND THEN ANOTHER
  3153	404445'	402000	000427'	        SETZM   EXTCHO                  ;NO EXTRA BITS TO WORRY ABOUT NEXT RECORD
  3154	404446'	260740	403777'	        GOSUB   UPDATE                  ;COUNT RECORD WRITTEN.
  3155	404447'	254000	404363'	        GOTO    OTIASC                  ;RE-INITIALIZE.
  3156
  3157				;HERE ON INPUT END OF FILE TO FINISH OFF THE OUTPUT FILE.
  3158
  3159	404450'	606000	000002	OTFASC: IF.OFF  S,EOR,OTRAC0            ;FINISH THIS RECORD IF NEEDED.
  3160	404452'	254000	403774'	        GOTO    UPDAT                   ;ELSE CHECK ON THE BLOCK
  3161
  3162				EQUATE  RET0,<OTBASC>
  3163				EQUATE  OTIASC,<OTIGEA,OTIHPA>
  3164				EQUATE  OTCASC,<OTCGEA,OTCHPA>
  3165				EQUATE  OTRASC,<OTRGEA>
  3166				EQUATE  OTBASC,<OTBGEA,OTBHPA>
  3167				EQUATE  OTFASC,<OTFGEA>
  3168
  3169	404453'	302600	000040	CHKBLN: CAIE CH," "
  3170	404454'	254000	404457'	        GOTO    CHKBL1
  3171	404455'	350000	000417'	        AOS     SPCNT
  3172	404456'	254000	404377'	        GOTO    OT0ASC
  3173	404457'	326400	404463'	CHKBL1: JUMPN P3,CHKBL3
  3174	404460'	402000	000417'	        SETZM   SPCNT
  3175	404461'	260740	407334'	CHKBL2: GOSUB   PUT
  3176	404462'	254000	404377'	        GOTO    OT0ASC
  3177	404463'	336000	000417'	CHKBL3: SKIPN   SPCNT
  3178	404464'	254000	404461'	        GOTO    CHKBL2
  3179	404465'	261740	000014	        SAVE    CH
  3180	404466'	201600	000040	        MOVEI CH," "
  3181	404467'	260740	407334'	        GOSUB   PUT
  3182	404470'	372000	000417'	        SOSE    SPCNT
  3183	404471'	254000	404467'	        GOTO    .-2
  3184	404472'	262740	000014	        UNSAVE  CH
  3185	404473'	254000	404461'	        GOTO    CHKBL2
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 48
MAGCON.MAC	 6-JUL-77 09:25		*** ASCII I/O ROUTINES ***

  3186				;HERE TO FINISH OFF THE HPASC RECORD
  3187	404474'	260740	403760'	OTRHP0: GOSUB 	SETCNT                  ;SET UP COUNTERS
  3188	404475'	660000	000002	OTRHPA: ON      S,EOR                   ;AT END OF RECORD
  3189	404476'	606040	040000	        IF.OFF  OF,NOCRLF,OTRHP1        ;JUMP IF FILE CAN HAVE CRLF'S
  3190	404500'	201600	000040	        MOVEI 	CH," "                  ;SPACE FILL THE RECORD
  3191	404501'	260740	404366'	        GOSUB   OTCHPA+1                ;UNTIL THE COUNTER RUNS OUT.
  3192	404502'	325400	404500'	        JUMPGE 	P3,.-2                  ;UNTIL IT FINISHES, CONTIUE
  3193	404503'	200140	000355'		MOVE	T1,OBCNT		;SAVE BLOCK COUNT
  3194	404504'	202140	000360'		MOVEM	T1,OBCSAV		;FOR A TEST.
  3195	404505'	660000	000002	        ON 	S,EOR
  3196	404506'	607040	200020	        IF.OFF  OF,MTA!DSK,OTRHP1       ;JUMP UNLESS THIS IS AN ASCII ONLY
  3197	404510'	260740	403777'	        GOSUB   UPDATE                   ;WRITE OUT RECORD AND COUNT IT.
  3198	404511'	200140	000355'		MOVE	T1,OBCNT		;ARE WE AT A
  3199	404512'	312140	000360'		CAME	T1,OBCSAV		;BLOCK BOUNDARY?
  3200	404513'	072040	000013	        MTAPE   OF,13                   ;WRITE INTER-RECORD GAP
  3201	404514'	254000	404363'	        GOTO    OTIHPA
  3202	404515'	201600	000015	OTRHP1: MOVEI 	CH,15                   ;GET A RETURN
  3203	404516'	260740	407334'	        GOSUB 	PUT                     ;INTO THE BUFFER
  3204	404517'	201600	000012	        MOVEI 	CH,12                   ;AND A LINE FEED
  3205	404520'	260740	407334'	        GOSUB 	PUT                     ;INTO THE BUFFER
  3206	404521'	260740	403777'	        GOSUB 	UPDATE                  ;COUNT RECORD WRITTEN
  3207	404522'	254000	404363'	        GOTO 	OTIHPA                  ;RE-INITIALIZE
  3208
  3209				;HERE ON INPUT END OF FILE TO FINISH OFF THE OUTPUT FILE
  3210
  3211	404523'	312400	000012'	OTFHPA: CAME 	P3,OFILE+RECSIZ
  3212	404524'	602000	000002	        IF.ON 	S,EOR,UPDAT              ;FINISH THIS RECORD IF NEEDED
  3213	404526'	254000	404474'	        GOTO    OTRHP0                  ;ELSE CHECK ON THE BLOCK.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 49
MAGCON.MAC	 6-JUL-77 09:25		*** IMAGE I/O ROUTINES ***

  3214				SUBTTL          *** IMAGE I/O ROUTINES ***
  3215
  3216				;HERE TO READ A FILE IN BUFFER MODE AND EITHER BLT THE
  3217				;INPUT BUFFER TO THE OUTPUT BUFFER IF GOING IMAGE TO IMAGE
  3218				;OR TO PASS A WORD AT TIME IF GOING FROM IMAGE TO OCTAL.
  3219
  3220	404527'	306640	413340'	INIIMG: CAIN    OM,IMGMOD               ;IS OUTPUT IMAGE.
  3221	404530'	254000	404544'	        GOTO    IMGBLT                  ;YES USE BLT'S.
  3222	404531'	200300	000372'	        MOVE    P1,ISEC                 ;GET THE SECTORS READ.
  3223	404532'	260740	407154'	IN0IMG: GOSUB   GET                     ;GET A WORD.
  3224	404533'	254035	000005	        GOTO    @OUTF(OM)               ;END OF FILE.
  3225	404534'	260775	000002	        GOSUB   @OUTC(OM)               ;GET RID OF A WORD.
  3226	404535'	316300	000372'	        CAMN    P1,ISEC                 ;DID WE READ A BLOCK.
  3227	404536'	254000	404532'	        GOTO    IN0IMG                  ;NO CONTINUE.
  3228	404537'	350300	000357'	        AOS     P1,IBCNT                ;COUNT THE BLOCK.
  3229	404540'	350000	000356'	        AOS     IRCNT                   ;COUNT THE RECORD.
  3230	404541'	350000	000353'		AOS	TIBCNT
  3231	404542'	350000	000352'		AOS	TIRCNT
  3232	404543'	254000	404532'	        GOTO    IN0IMG                  ;CARRY ON.
  3233	404544'	350000	000354'	IMGBLT: AOS     ORCNT                   ;COUNT THE RECORD CLOSE WRITES.
  3234	404545'	350000	000355'	        AOS     OBCNT                   ;COUNT THE BLOCK CLOSE WRITES.
  3235	404546'	350000	000350'		AOS	TORCNT
  3236	404547'	350000	000351'		AOS	TOBCNT
  3237	404550'	337000	000307'	IMGBT1: SKIPG   OBUF                    ;HAS AN OUTPUT BEEN DONE.
  3238	404551'	067040	000000	        OUTPUT  OF,ZERO                 ;DO ONE TO SET THE RING AS USED.
  3239	404552'	350000	000313'	        AOS     IBUF+1                  ;GET A POINTER TO THIS BUFFER.
  3240	404553'	402000	000373'	        SETZM   OSEC                    ;CLEAR SECTORS WRITTEN.
  3241	404554'	514140	000313'	IMGBT0: HRLZ    T1,IBUF+1               ;C(T1)LH IS SOURCE POINTER.
  3242	404555'	200200	000311'	        MOVE    T2,OBUF+2               ;C(T2) SIZE OF THE TARGET.
  3243	404556'	200240	000314'	        MOVE    T3,IBUF+2               ;C(T3) SIZE OF THE SOURCE.
  3244	404557'	311200	000005	        CAML    T2,T3                   ;WILL SOURCE FIT IN TARGET.
  3245	404560'	200200	000005	        MOVE    T2,T3                   ;COPY WHAT IS LEFT.
  3246	404561'	272200	000313'	        ADDM    T2,IBUF+1               ;UPDATE POINTER.
  3247	404562'	200300	000314'	        MOVE    P1,IBUF+2               ;GET THE COUNT LEFT.
  3248	404563'	274300	000004	        SUB     P1,T2                   ;ACCOUNT FOR WORDS TO MOVE.
  3249	404564'	202300	000314'	        MOVEM   P1,IBUF+2               ;UPDATE THE COUNT.
  3250	404565'	260740	407133'	        GOSUB   BUF2                    ;MOVE THE BUFFER.
  3251	404566'	336000	000311'	        SKIPN   OBUF+2                  ;IS OUTPUT BUFFER FULL.
  3252	404567'	260740	407344'	        GOSUB   EMPTY                   ;WRITE BUFFER.
  3253	404570'	333000	000314'	        SKIPLE  IBUF+2                  ;SKIP IF BUFFER IS ALL GONE.
  3254	404571'	254000	404554'	        GOTO    IMGBT0                  ;GET THE NEXT SECTION.
  3255	404572'	200300	000373'	        MOVE    P1,OSEC                 ;GET BLOCKS WRITTEN.
  3256	404573'	272300	000355'	        ADDM    P1,OBCNT                ;UPDATE BLOCK COUNT.
  3257	404574'	272300	000354'	        ADDM    P1,ORCNT                ;UPDATE RECORD COUNT.
  3258	404575'	272300	000351'		ADDM	P1,TOBCNT
  3259	404576'	272300	000350'		ADDM	P1,TORCNT
  3260	404577'	260740	407174'	        GOSUB   FILL                    ;GET THE NEXT BUFFER.
  3261	404600'	263740	412060'	        RETURN  ZERO                    ;NONE TO GET.
  3262	404601'	350000	000356'	        AOS     IRCNT                   ;COUNT THE RECORD.
  3263	404602'	350000	000357'	        AOS     IBCNT                   ;COUNT THE BLOCK.
  3264	404603'	350000	000352'		AOS	TIRCNT
  3265	404604'	350000	000353'		AOS	TIBCNT
  3266	404605'	260740	412330'	        GOSUB   CHKOPR                  ;CHECK FOR COMMAND.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 49-2
MAGCON.MAC	 6-JUL-77 09:25		*** IMAGE I/O ROUTINES ***

  3267	404606'	254000	404550'	        GOTO    IMGBT1                  ;DO THE NEXT ONE.
  3268
  3269				EQUATE  RET0,<OTIIMG>
  3270				EQUATE  ABORT,<OTCIMG,OTRIMG,OTBIMG,OTFIMG>
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 50
MAGCON.MAC	 6-JUL-77 09:25		*** OCTAL OUTPUT ROUTINE ***

  3271				SUBTTL          *** OCTAL OUTPUT ROUTINE ***
  3272
  3273				;HERE TO DUMP A FILE IN OCTAL MODE.
  3274
  3275	404607'	660000	000010	OTIOCT: ON      S,LHEAD                 ;CAN'T USE US TO STORE CHARACTERS.
  3276	404610'	402000	002716'	        SETZM   OT0TMP                  ;CLEAR WORD COUNTER.
  3277	404611'	607040	000010	        IF.ON   OF,TTY                  ;SKIP IF TTY OUTPUT.
  3278	404612'	001040	414327'	        UME     .ASC,[BYTE (7)14,0]     ;SEND A FORM FEED.
  3279	404613'	201400	000005	OT0OCT: MOVEI   P3,5                    ;WORDS PER LINE IF TTY.
  3280	404614'	607040	000010	        IF.ON   OF,TTY                  ;SKIP IF TTY IS OUTPUT DEVICE.
  3281	404615'	201400	000011	        MOVEI   P3,11                   ;WORDS PER LINE IF OTHER DEVICE.
  3282	404616'	202400	002717'	        MOVEM   P3,OT1TMP               ;SAVE WORDS PER LINE.
  3283	404617'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  3284
  3285				;HERE TO DUMP ONE WORD ONTO THE OUTPUT DEVICE.
  3286
  3287	404620'	336140	000666'	OTCOCT: SKIPN T1,MTAWD                  ;GET MTAWD FOR CHECK
  3288	404621'	254000	404632'	        GOTO    OTCOCT+12               ;SKIP THIS JUNK IF NO TAPES
  3289	404622'	200200	000032'	        MOVE    T2,IFILE                ;GET STATUS BITS OF INPUT
  3290	404623'	602200	001000	        IF.ON   T2,EVEN,OTCOCT+10       ;ON, NOW CHECK FAST AND 7TRK
  3291	404625'	200200	000001'	        MOVE    T2,OFILE
  3292	404626'	606200	001000	        IF.OFF  T2,EVEN,OTCOCT+12
  3293	404630'	603140	010040	        IF.ON   T1,B5!B12,OTEOCT         ;IF FAST AND 7TRK THEN ONE CAHR AT A TIME
  3294	404632'	316400	002717'	        CAMN    P3,OT1TMP               ;ARE WE AT A NEW LINE.
  3295	404633'	254000	404654'	        GOTO    OT4OCT                  ;YES HANDLE NEW LINE STUFF.
  3296	404634'	200440	414330'	OT1OCT: MOVE    P4,[POINT 3,T3]         ;GET A POINTER TO DATA.
  3297	404635'	200240	000014	        MOVE    T3,CH                   ;COPY OUTPUT WORD.
  3298	404636'	001040	414307'	        UME     .ASC,[ASCIZ "   "]      ;SEPARATE THINGS.
  3299	404637'	134600	000011	OT2OCT: ILDB    CH,P4                   ;GET A CHARACTER.
  3300	404640'	201614	000060	        MOVEI   CH,"0"(CH)              ;MAKE IT ASCII.
  3301	404641'	260740	407334'	        GOSUB   PUT                     ;WRITE IT OUT.
  3302	404642'	603440	770000	        IF.ON   P4,77B5,OT2OCT          ;JUMP IF HAVE MORE.
  3303	404644'	367400	412060'	        SOJG    P3,RET0                 ;JUMP IF NOT AT LINES END.
  3304	404645'	350000	000354'	OT3OCT: AOS     ORCNT                   ;COUNT THE RECORD.
  3305	404646'	350000	000355'	        AOS     OBCNT                   ;COUNT THE BLOCK.
  3306	404647'	350000	000350'		AOS	TORCNT
  3307	404650'	350000	000351'		AOS	TOBCNT
  3308	404651'	001040	414243'	        UME     .ASC,[BYTE (7)15,12,0]  ;SKIP A LINE.
  3309	404652'	260740	412330'	        GOSUB   CHKOPR                  ;CHECK FOR COMMAND.
  3310	404653'	254000	404613'	        GOTO    OT0OCT                  ;RESET COUNTER.
  3311	404654'	261740	000014	OT4OCT: SAVE    CH                      ;SAVE THE DATA WORD.
  3312	404655'	201600	000050	        MOVEI   CH,"("                  ;TO DELIMIT WORD NUMBER.
  3313	404656'	260740	407334'	        GOSUB   PUT                     ;PLACE IT.
  3314	404657'	200240	002716'	        MOVE    T3,OT0TMP               ;GET THE WORD NUMBER.
  3315	404660'	200440	414331'	        MOVE    P4,[POINT 3,T3,17]      ;GET A POINTER TO IT.
  3316	404661'	260740	404637'	        GOSUB   OT2OCT                  ;WRITE IT OUT.
  3317	404662'	201600	000051	        MOVEI   CH,")"                  ;TO DELIMIT IT.
  3318	404663'	260740	407334'	        GOSUB   PUT                     ;PRINT IT.
  3319	404664'	262740	000014	        UNSAVE  CH                      ;GET THE DATA WORD BACK.
  3320	404665'	272400	002716'	        ADDM    P3,OT0TMP               ;UPDATE WORD COUNTER.
  3321	404666'	254000	404634'	        GOTO    OT1OCT                  ;PLACE THE DATA WORD.
  3322
  3323				;HERE ON END OF FILE.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 50-2
MAGCON.MAC	 6-JUL-77 09:25		*** OCTAL OUTPUT ROUTINE ***

  3324
  3325	404667'	316400	002717'	OTFOCT: CAMN    P3,OT1TMP               ;ARE WE IN THE MIDDLE OF THE LINE.
  3326	404670'	263740	412060'	        RETURN  ZERO                    ;NO SO RETURN.
  3327	404671'	254000	404645'	        GOTO    OT3OCT                  ;FINISH LINE AND RETURN.
  3328	404672'	260740	407334'	OTEOCT: GOSUB   PUT             ;STUFF CH IN TO BUFFER
  3329	404673'	263740	412060'	        RETURN  ZERO            ;NEXT
  3330
  3331
  3332				EQUATE  ABORT,<INIOCT,OTROCT,OTBOCT>
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 51
MAGCON.MAC	 6-JUL-77 09:25		*** SIXBIT I/O ROUTINES ***

  3333				SUBTTL                  *** SIXBIT I/O ROUTINES ***
  3334
  3335				;HERE TO READ A SIXBIT FILE AND PASS A CHARACTER
  3336				;AT A TIME TO THE OUTPUT ROUTINES.
  3337
  3338	404674'	200300	000313'	IN0SIX: MOVE    P1,IBUF+1               ;GET THE BUFFER POINTER.
  3339	404675'	607300	770000	        IF.OFF  P1,77B5,INISIX          ;IF NOT AT A WORD BOUNDARY
  3340	404677'	133000	000313'	        IBP     IBUF+1                  ;BUMP POINTER ONE POSITION
  3341	404700'	370000	000314'	        SOS     IBUF+2                  ;AND COUNT AND THEN
  3342	404701'	254000	404674'	        GOTO    IN0SIX                  ;TEST FOR A WORD BOUNDARY.
  3343	404702'	260740	407154'	INISIX: GOSUB   GET                     ;MAKE SURE NOT EOF.
  3344	404703'	254035	000005	        GOTO    @OUTF(OM)               ;FINISH OFF FILE.
  3345	404704'	135300	414332'	        LDB     P1,[POINT 12,@IBUF+1,35];GET THE RECORD SIZE.
  3346	404705'	205140	770000	        MOVSI   T1,770000               ;SET BYTE POINTER TO NEXT WORD.
  3347	404706'	412140	000313'	        ANDCAM  T1,IBUF+1               ;POINTER NOW POINTS RIGHT.
  3348	404707'	211140	000005	        MOVNI   T1,5                    ;NUMBER OF PLACES POINTER MOVED.
  3349	404710'	272140	000314'	        ADDM    T1,IBUF+2               ;UPDATE THE COUNTER.
  3350	404711'	322300	404674'	        JUMPE   P1,IN0SIX               ;DON'T DO ZERO CTRL WORDS.
  3351	404712'	361300	404717'	IN1SIX: SOJL    P1,IN2SIX               ;HAS COUNTER RUN OUT.
  3352	404713'	260740	407154'	        GOSUB   GET                     ;NO GET A WORD.
  3353	404714'	254035	000005	        GOTO    @OUTF(OM)               ;END OF FILE SHOULDN'T HAPPEN??
  3354	404715'	260740	403770'	        GOSUB   CHANGE                  ;CONVERT THE CHARACTER.
  3355	404716'	254000	404712'	        GOTO    IN1SIX                  ;AND LOOP.
  3356	404717'	260740	403723'	IN2SIX: GOSUB   RENEW                   ;GET THE NEXT RECORD.
  3357	404720'	254035	000005	        GOTO    @OUTF(OM)               ;END OF THE FILE.
  3358	404721'	260775	000003	        GOSUB   @OUTR(OM)               ;FINISH THE OUTPUT RECORD.
  3359	404722'	332140	000061'		SKIPE	T1,IFILE+RECADV		;ARE WE FINISHED
  3360	404723'	602100	000040		IF.OFF	IF,SPAN
  3361	404724'	370000	000003		SOS	T1
  3362	404725'	311140	000356'		CAML	T1,IRCNT		;ADVANCING RECORDS?
  3363	404726'	254000	404674'		GOTO	IN0SIX			;IF SO, THEN SET UP TO
  3364	404727'	200640	000020'		MOVE	OM,OUTMOD		;OUTPUT TO DEVICE.
  3365	404730'	260775	000001		GOSUB	@OUTI(OM)		;INIT. OUTPUT ROUTINE.
  3366	404731'	254000	404674'	        GOTO    IN0SIX                  ;GET A NEW CONTROL WORD.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 52
MAGCON.MAC	 6-JUL-77 09:25		*** SIXBIT I/O ROUTINES ***

  3367				;HERE TO INITAILIZE THE OUTPUT ROUTINE.
  3368
  3369	404732'	260740	406716'	OTISIX: GOSUB   GETBUF                  ;GET AN ALTER BUFFER.
  3370	404733'	402000	002714'	OT0SIX: SETZM   OSIZE                   ;SET SIZE OF RECORD TO ZERO.
  3371	404734'	200400	000405'	        MOVE    P3,CURPTR               ;GET THE CURRENT BUFFER POINTER.
  3372	404735'	312400	000403'	        CAME    P3,RECPTR               ;ARE WE AT THE TOP.
  3373	404736'	350000	000010	        AOS     P3                      ;NO SO BUMP POINTER.
  3374	404737'	552400	000404'	        HRRZM   P3,LSTPTR               ;AND MAKE IT THE LAST POINTER.
  3375	404740'	350000	000405'	        AOS     CURPTR                  ;POINT POINTER TO START OF RECORD.
  3376	404741'	200400	000012'	        MOVE    P3,OFILE+RECSIZ         ;GET THE RECORD SIZE.
  3377	404742'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  3378
  3379				;HERE TO PUT ONE CHARACTER INTO THE ALTER BUFFER.
  3380
  3381	404743'	361400	412060'	OTCSIX: SOJL    P3,RET0                 ;RETURN IF RECORD IS FULL.
  3382	404744'	350000	002714'	        AOS     OSIZE                   ;COUNT THE CHARACTER.
  3383	404745'	136600	000405'	        IDPB    CH,CURPTR               ;SAVE THE CHARACTER.
  3384	404746'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  3385
  3386				;HERE TO FINISH OFF THE CURRENT RECORD AND WRITE ITS CTRL WORD.
  3387
  3388	404747'	260740	403760'	OT2SIX: GOSUB   SETCNT                  ;SET COUNTERS RIGHT.
  3389	404750'	550600	002351'	OTRSIX: HRRZ    CH,TAB2+40              ;LOAD A SPACE.
  3390	404751'	336000	002714'	        SKIPN   OSIZE                   ;CHECK SIZE OF RECORD.
  3391	404752'	260740	404743'	        GOSUB   OTCSIX                  ;SO RECORD IS KNOWN.
  3392	404753'	200400	002714'	        MOVE    P3,OSIZE                ;GET THE RECORD SIZE.
  3393	404754'	202420	000404'	        MOVEM   P3,@LSTPTR              ;STASH IT IN THE BUFFER.
  3394	404755'	402000	000014	OT1SIX: SETZM   CH                      ;PUT IN SPACES.
  3395	404756'	200400	000405'	        MOVE    P3,CURPTR               ;GET THE CURRENT POINTER.
  3396	404757'	607400	770000	        IF.OFF  P3,77B5,OT3SIX          ;JUMP IT AT WORD BOUNDARY.
  3397	404761'	136600	000405'	        IDPB    CH,CURPTR               ;ELSE PUSH POINTER TO A WORD
  3398	404762'	254000	404755'	        GOTO    OT1SIX                  ;BOUNDARY AND LOOP.
  3399	404763'	260740	403777'	OT3SIX: GOSUB   UPDATE                  ;COUNT THIS RECORD.
  3400	404764'	254000	404733'	        GOTO    OT0SIX                  ;RE-INITIALIZE.
  3401
  3402				;HERE TO FINISH OFF A BLOCK WHEN WE HAVE BEEN CALLED FROM UPDATE.
  3403
  3404	404765'	260740	407032'	OTBSIX: GOSUB   BUFMOV                  ;MOVE ALTER BUFFER TO OUTPUT BUFFER.
  3405	404766'	200140	000403'	        MOVE    T1,RECPTR               ;GET POINTER TO TOP.
  3406	404767'	202140	000405'	        MOVEM   T1,CURPTR               ;SAVE IT AS THE CURRENT POINTER.
  3407	404770'	263740	412060'	        RETURN  ZERO                    ;AND RETURN.
  3408
  3409				;HERE TO FINISH OFF THE FILE.
  3410
  3411	404771'	332000	002714'	OTFSIX: SKIPE   OSIZE                   ;SKIP IF JUST FINISHED A RECORD.
  3412	404772'	254000	404747'	        GOTO    OT2SIX                  ;FINISH RECORD AND WRITE BLOCK.
  3413	404773'	370000	000405'	        SOS     CURPTR                  ;POINTER POINTER RIGHT.
  3414	404774'	254000	403774'	        GOTO    UPDAT                   ;FINISH IT OFF.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 53
MAGCON.MAC	 6-JUL-77 09:25		*** BCD BCL GEBCD AND FIXED EBCDIC I/O ROUTINES ***

  3415				SUBTTL          *** BCD BCL GEBCD AND FIXED EBCDIC I/O ROUTINES ***
  3416
  3417				;HERE TO GET A CHARACTER FROM THE INPUT BUFFER AND WRITE
  3418				;IT TO THE OUTPUT BUFFER. NOTE THIS ROUTINE WILL HANDLE
  3419				;ANY FORMAT PROVIDED THE FORMAT HAS NO CTRL WORDS AND NO
  3420				;CHARACTERS IN THE RECORDS THAT HAVE A SPECIAL MEANING.
  3421				;THE BYTE SIZE OF THE CHARACTER SET HAS NO MEANING HERE.
  3422
  3423	404775'	200300	000043'	INIBGE: MOVE    P1,IFILE+RECSIZ         ;GET THE RECORD SIZE.
  3424	404776'	201340	000010	IN5BGE: MOVEI   P2,^D8                  ;SPACES PER TAB.
  3425	404777'	361300	405007'	IN0BGE: SOJL    P1,IN1BGE               ;JUMP IF RECORD HAS EXPIRED.
  3426	405000'	260740	407154'	        GOSUB   GET                     ;GET A WORD.
  3427	405001'	254035	000005	        GOTO    @OUTF(OM)               ;END OF FILE.
  3428	405002'	306700	413503'	        CAIN    IM,EBCMOD               ;IS THIS EBCDIC.
  3429	405003'	254000	405020'	        GOTO    IN3BGE                  ;YES CHECK FOR A TAB.
  3430	405004'	260740	403770'	IN2BGE: GOSUB   CHANGE                  ;CONVERT THE CHARACTER.
  3431	405005'	367340	404777'	        SOJG    P2,IN0BGE               ;JUMP IF TAB IS STILL THERE.
  3432	405006'	254000	404776'	        GOTO    IN5BGE                  ;CARRY ON...
  3433	405007'	260740	403723'	IN1BGE: GOSUB   RENEW                   ;GET THE NEXT RECORD.
  3434	405010'	254035	000005	        GOTO    @OUTF(OM)               ;END OF FILE FOUND.
  3435	405011'	260775	000003	        GOSUB   @OUTR(OM)               ;FINISH THE OUTPUT RECORD.
  3436	405012'	332140	000061'		SKIPE	T1,IFILE+RECADV		;ARE WE FINISHED
  3437	405013'	311140	000356'		CAML	T1,IRCNT		;ADVANCING RECORDS?
  3438	405014'	254000	404775'		GOTO	INIBGE			;IF SO, THEN SET UP TO
  3439	405015'	200640	000020'		MOVE	OM,OUTMOD		;OUTPUT TO DEVICE.
  3440	405016'	260775	000001		GOSUB	@OUTI(OM)		;INIT. OUTPUT ROUTINE.
  3441	405017'	254000	404775'	        GOTO    INIBGE                  ;CONTINUE ON..
  3442	405020'	302600	000005	IN3BGE: CAIE    CH,5                    ;CHECK FOR EBCDIC TAB.
  3443	405021'	254000	405004'	        GOTO    IN2BGE                  ;NOT ONE.
  3444	405022'	200155	000011	        MOVE    T1,STS(OM)              ;GET THE OUTPUT STATE WORD.
  3445	405023'	603140	000010	        IF.ON   T1,TAB,IN2BGE           ;JUMP IF IT HAS TABS.
  3446	405025'	201600	000100	IN4BGE: MOVEI   CH,100                  ;LOAD A SPACE.
  3447	405026'	260740	403770'	        GOSUB   CHANGE                  ;CONVERT IT.
  3448	405027'	367340	405025'	        SOJG    P2,IN4BGE               ;FOR THE COUNT.
  3449	405030'	254000	404776'	        GOTO    IN5BGE                  ;CONTINUE ON.
  3450
  3451				EQUATE  INIBGE,<INIFIX,INICDC,INIBCL,INIBCD,INIXBD,INIEBC,INIHBD>
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 54
MAGCON.MAC	 6-JUL-77 09:25		*** BCD BCL GEBCD AND FIXED EBCDIC I/O ROUTINES ***

  3452				;HERE TO INITIALIZE THE OUTPUT ROUTINE FOR CHARACTER
  3453				;SETS THAT HAVE NO CONTROL WORDS.
  3454
  3455	405031'	200400	000012'	OTIBGE: MOVE    P3,OFILE+RECSIZ         ;GET THE RECORD SIZE.
  3456	405032'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  3457
  3458				;HERE TO WRITE ONE CHARACTER OUT INTO THE
  3459				;OUTPUT BUFFER.
  3460
  3461	405033'	361400	412060'	OTCBGE: SOJL    P3,RET0                 ;RETURN IF RECORD IS FULL.
  3462	405034'	254000	407334'	        GOTO    PUT                     ;ELSE ADD TO BUFFER.
  3463
  3464				;HERE TO FINSIH OFF THE RECORD.
  3465
  3466	405035'	260740	403760'	OT0BGE: GOSUB   SETCNT                  ;SET COUNTERS RIGHT AND SET FLAG.
  3467	405036'	550600	002351'	OTRBGE: HRRZ    CH,TAB2+40              ;GET A SPACE FOR THIS SET.
  3468	405037'	260740	405033'	        GOSUB   OTCBGE                  ;AND WRITE IT OUT.
  3469	405040'	325400	405036'	        JUMPGE  P3,OTRBGE               ;CONTINUE FOR THE RECORD SIZE.
  3470	405041'	261740	000310'	        SAVE    OBUF+1                  ;SAVE BUFFER POINTER.
  3471	405042'	603040	000020		IF.ON	OF,MTA,OT2BGE		;DON'T FILL WORD IF MAG TAPE OUTPUT.
  3472	405044'	200200	000001'	OT1BGE: MOVE T2,OFILE                   ;GET OUT STATUS BITS
  3473	405045'	602200	001000	        IF.ON T2,EVEN,OT3BGE            ;IF EVEN PARITY THEN CHANGE 3
  3474	405047'	554215	000006	        HLRZ    T2,MSIZ(OM)             ;GET BYTE SIZE.
  3475	405050'	201140	000044	        MOVEI   T1,^D36                 ;BITS PER WORD.
  3476	405051'	231144	000000	        IDIVI   T1,ZERO(T2)             ;UNUSED BITS IN T2.
  3477	405052'	135140	414333'	        LDB     T1,[POINT 6,OBUF+1,5]   ;GET THE BITS LEFT IN WORD.
  3478	405053'	306144	000000	        CAIN    T1,ZERO(T2)             ;SKIP IF NOT AT WORD BOUNDARY.
  3479	405054'	254000	405060'	        GOTO    OT2BGE                  ;WE ARE AT A BOUNDARY.
  3480	405055'	550600	002351'	        HRRZ    CH,TAB2+40              ;LOAD A SPACE.
  3481	405056'	136600	000310'	        IDPB    CH,OBUF+1               ;SAVE THE SPACE.
  3482	405057'	254000	405044'	        GOTO    OT1BGE                  ;TRY AGAIN.
  3483	405060'	262740	000310'	OT2BGE: UNSAVE  OBUF+1                  ;RESTORE POINTER.
  3484	405061'	260740	403777'	        GOSUB   UPDATE                  ;COUNT THE RECORD.
  3485	405062'	254000	405031'	        GOTO    OTIBGE                  ;RE-INITIALIZE.
  3486
  3487
  3488				;HERE IF EVEN PARITY FAST TAPE UNITS ARE OUTPUT DEVICE
  3489				;LOOKING FOR FINAL SIX BIT CHAR TO PAD LAST WORD 
  3490				;THE LAST 4 BITS ARE ZERO BY HARDWARE FUNCTIONS.
  3491
  3492	405063'	554215	000006	OT3BGE: HLRZ    T2,MSIZ(OM)             ;BYTE SIZE FOR OUTPUT
  3493	405064'	201140	000044	        MOVEI   T1,^D36                 ;MAX BITS PER WORD
  3494	405065'	231144	000000	        IDIVI   T1,ZERO(T2)             ;UNUSED BITS IN TO INDEX
  3495	405066'	135140	414333'	        LDB     T1,[POINT 6,OBUF+1,5]   ;GET BIT POSI FROM HEADER
  3496	405067'	306144	000004	        CAIN    T1,4(T2)                ;THIS MODE ENDS WITH 4
  3497	405070'	254000	405060'	        GOTO    OT2BGE                  ;NOW HAVE WORD BOUNDARY
  3498	405071'	550600	002351'	        HRRZ    CH,TAB2+40              ;LOAD SPACE TO PAD WORD
  3499	405072'	136600	000310'	        IDPB    CH,OBUF+1               ;PUT IN BUFFER
  3500	405073'	254000	405044'	        GOTO    OT1BGE                  ;NOW SEE IF BOUNDARY CORRECT..
  3501
  3502				;HERE ON INPUT END OF FILE TO FINISH OFF THE
  3503				;OUTPUT FILE.
  3504
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 54-2
MAGCON.MAC	 6-JUL-77 09:25		*** BCD BCL GEBCD AND FIXED EBCDIC I/O ROUTINES ***

  3505	405074'	312400	000012'	OTFBGE: CAME    P3,OFILE+RECSIZ         ;SKIP IF JUST FINISHED A RECORD.
  3506	405075'	254000	405035'	        GOTO    OT0BGE                  ;FINISH RECORD AND WRITE BLOCK.
  3507	405076'	254000	403774'	        GOTO    UPDAT                   ;DON'T WRITE EXTRA RECORDS.
  3508
  3509				EQUATE  RET0,<OTBBGE>
  3510				EQUATE  OTIBGE,<OTIHBD,OTIEBC,OTIXBD,OTIBCD,OTIBCL,OTIFIX,OTICDC>
  3511				EQUATE  OTCBGE,<OTCHBD,OTCEBC,OTCXBD,OTCBCD,OTCBCL,OTCFIX,OTCCDC>
  3512				EQUATE  OTRBGE,<OTRHBD,OTREBC,OTRXBD,OTRBCD,OTRBCL,OTRFIX,OTRCDC>
  3513				EQUATE  OTBBGE,<OTBHBD,OTBEBC,OTBXBD,OTBBCD,OTBBCL,OTBFIX,OTBCDC>
  3514				EQUATE  OTFBGE,<OTFHBD,OTFEBC,OTFXBD,OTFBCD,OTFBCL,OTFFIX,OTFCDC>
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 55
MAGCON.MAC	 6-JUL-77 09:25		*** VARABLE EBCDIC I/O ROUTINES ***

  3515				SUBTTL                  *** VARABLE EBCDIC I/O ROUTINES ***
  3516
  3517				;HERE TO READ FROM A VARABLE EBCDIC FILE.
  3518
  3519	405077'	525540	377777	INIVEB: HRLOI   ICNT,377777             ;SO WE WON'T READ A BLOCK.
  3520	405100'	260740	405137'	        GOSUB   IN3VEB                  ;GET A BLOCK CTRL WORD.
  3521	405101'	322300	405077'	        JUMPE   P1,INIVEB               ;IGNORE ZERO CTRL WORDS.
  3522	405102'	275300	000004	        SUBI    P1,4                    ;SUBTRACT LENGTH OF CTRL WORD.
  3523	405103'	202300	002713'	        MOVEM   P1,IVBCNT               ;SAVE THE BLOCK LENGTH.
  3524	405104'	260740	405137'	IN0VEB: GOSUB   IN3VEB                  ;GET A RECORD CTRL WORD.
  3525	405105'	250300	002713'	        EXCH    P1,IVBCNT               ;PUT BLOCK CTRL IN AN AC.
  3526	405106'	274300	002713'	        SUB     P1,IVBCNT               ;SUBTRACT RECORD FROM BLOCK.
  3527	405107'	250300	002713'	        EXCH    P1,IVBCNT               ;REPLACE THE BLOCK WORD.
  3528	405110'	275300	000004	        SUBI    P1,4                    ;SUBTRACT LENGTH OF CTRL WORD.
  3529	405111'	201340	000010	IN5VEB: MOVEI   P2,^D8                  ;SPACES PER TAB.
  3530	405112'	361300	405122'	IN1VEB: SOJL    P1,IN2VEB               ;JUMP IF CTRL RAN OUT.
  3531	405113'	260740	407154'	        GOSUB   GET                     ;GET A WORD.
  3532	405114'	254035	000005	        GOTO    @OUTF(OM)               ;FOUND END OF FILE.
  3533	405115'	306600	000005	        CAIN    CH,5                    ;SEE IF IT IS A TAB.
  3534	405116'	254000	405154'	        GOTO    IN6VEB                  ;HANDLE TABS.
  3535	405117'	260740	403770'	IN8VEB: GOSUB   CHANGE                  ;CONVERT AND WRITE.
  3536	405120'	367340	405112'	        SOJG    P2,IN1VEB               ;DECREMENT TAB COUNT AND TEST.
  3537	405121'	254000	405111'	        GOTO    IN5VEB                  ;CONTINUE LOOP.
  3538	405122'	337000	002713'	IN2VEB: SKIPG   IVBCNT                  ;HAS BLOCK EXPIRED.
  3539	405123'	476000	000013	        SETOM   ICNT                    ;FLAG WE NEED A NEW ONE.
  3540	405124'	260740	403723'	        GOSUB   RENEW                   ;GET THE NEXT RECORD.
  3541	405125'	254035	000005	        GOTO    @OUTF(OM)               ;END OF FILE.
  3542	405126'	260775	000003	        GOSUB   @OUTR(OM)               ;FINISH THE OUTPUT RECORD.
  3543	405127'	332140	000061'		SKIPE	T1,IFILE+RECADV		;ARE WE FINISHED
  3544	405130'	313140	000356'		CAMLE	T1,IRCNT		;ADVANCING RECORDS?
  3545	405131'	254000	405134'		GOTO	IN9VEB			;IF SO, THEN SET UP TO
  3546	405132'	200640	000020'		MOVE	OM,OUTMOD		;OUTPUT TO DEVICE.
  3547	405133'	260775	000001		GOSUB	@OUTI(OM)		;INIT. OUTPUT ROUTINE.
  3548	405134'	333000	002713'	IN9VEB:	SKIPLE  IVBCNT                  ;DID BLOCK EXPIRE.
  3549	405135'	254000	405104'	        GOTO    IN0VEB                  ;NO SO GET A RECORD CTRL WORD.
  3550	405136'	254000	405077'	        GOTO    INIVEB                  ;YES SO GET A NEW BLOCK WORD.
  3551	405137'	260740	405147'	IN3VEB: GOSUB   IN4VEB                  ;GET A BYTE.
  3552	405140'	200300	000014	        MOVE    P1,CH                   ;TO A BETTER AC.
  3553	405141'	242300	000010	        LSH     P1,^D8                  ;SHIFT FIRST INTO PLACE.
  3554	405142'	260740	405147'	        GOSUB   IN4VEB                  ;GET THE NEXT BYTE.
  3555	405143'	434300	000014	        IOR     P1,CH                   ;SET UP COUNTER.
  3556	405144'	260740	405147'	        GOSUB   IN4VEB                  ;SKIP PASS UNUSED BYTES.
  3557	405145'	260740	405147'	        GOSUB   IN4VEB                  ;SKIP PASS UNUSED BYTES.
  3558	405146'	263740	412060'	        RETURN  ZERO                    ;RETURN.
  3559	405147'	260740	407154'	IN4VEB: GOSUB   GET                     ;GET A BYTE.
  3560	405150'	334000	000000	        SKIPA                           ;END OF FILE RETURN.
  3561	405151'	263740	412060'	        RETURN  ZERO                    ;RETURN WITH BYTE.
  3562	405152'	274740	414334'	        SUB     PDP,[XWD TWO,TWO]       ;FIX UP THE PUSH-DOWN POINTER.
  3563	405153'	254035	000005	        GOTO    @OUTF(OM)               ;END OF FILE DISPATCH.
  3564	405154'	200155	000011	IN6VEB: MOVE    T1,STS(OM)              ;GET THE OUTPUT STATE WORD.
  3565	405155'	603140	000010	        IF.ON   T1,TAB,IN8VEB           ;JUMP IF OUTPUT HAS TABS.
  3566	405157'	201600	000100	IN7VEB: MOVEI   CH,100                  ;LOAD A SPACE.
  3567	405160'	260740	403770'	        GOSUB   CHANGE                  ;CONVERT IT.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 55-2
MAGCON.MAC	 6-JUL-77 09:25		*** VARABLE EBCDIC I/O ROUTINES ***

  3568	405161'	367340	405157'	        SOJG    P2,IN7VEB               ;CONTIUE FOR COUNT.
  3569	405162'	254000	405111'	        GOTO    IN5VEB                  ;CONTINUE ON...
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 56
MAGCON.MAC	 6-JUL-77 09:25		*** VARABLE EBCDIC I/O ROUTINES ***

  3570				;HERE TO INITIALIZE THE VARABLE EBCDIC OUTPUT ROUTINE.
  3571
  3572	405163'	260740	406716'	OTIVEB: GOSUB   GETBUF                  ;GET AN ALTER BUFFER.
  3573	405164'	402000	002715'	        SETZM   OBSIZE                  ;INIT BLOCK SIZE.
  3574	405165'	402000	002714'	OT0VEB: SETZM   OSIZE                   ;INIT RECORD SIZE.
  3575	405166'	200400	000405'	        MOVE    P3,CURPTR               ;GET THE CURRENT POINTER.
  3576	405167'	202400	000404'	        MOVEM   P3,LSTPTR               ;MAKE IT LAST POINTER.
  3577	405170'	316400	000403'	        CAMN    P3,RECPTR               ;ARE WE STARTING A BLOCK.
  3578	405171'	350000	000405'	        AOS     CURPTR                  ;YES SO MAKE ROOM FOR BLOCK CTRL WORD.
  3579	405172'	316400	000403'	        CAMN    P3,RECPTR               ;WAS THAT THE SAME.
  3580	405173'	350000	000404'	        AOS     LSTPTR                  ;PUSH BY BLOCK CTRL WORD.
  3581	405174'	200400	000012'	        MOVE    P3,OFILE+RECSIZ         ;SET UP RECORD SIZE.
  3582	405175'	350000	000405'	        AOS     CURPTR                  ;PUSH BY FUTURE CTRL WORD.
  3583	405176'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  3584
  3585				;HERE TO PUT ONE CHARACTER INTO THE ALTER BUFFER.
  3586
  3587	405177'	361400	412060'	OTCVEB: SOJL    P3,RET0                 ;RETURN IF BUFFER IS FULL.
  3588	405200'	350000	002714'	        AOS     OSIZE                   ;COUNT THE CHARACTER.
  3589	405201'	136600	000405'	        IDPB    CH,CURPTR               ;SAVE THE CHARACTER.
  3590	405202'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  3591
  3592				;HERE TO WRITE A CTRL WORD ONTO THIS RECORD.
  3593
  3594	405203'	260740	403760'	OT3VEB: GOSUB   SETCNT                  ;FLAG BLOCK TO GO AND SET COUNTER.
  3595	405204'	550600	002351'	OTRVEB: HRRZ    CH,TAB2+40              ;LOAD A SPACE.
  3596	405205'	336000	002714'	        SKIPN   OSIZE                   ;GET THE SIZE.
  3597	405206'	260740	405177'	        GOSUB   OTCVEB                  ;SO RECORD IS SEEN.
  3598	405207'	200400	002714'	        MOVE    P3,OSIZE                ;GET SIZE OF RECORD.
  3599	405210'	200140	000404'	        MOVE    T1,LSTPTR               ;POINTER TO WHERE IT GOES.
  3600	405211'	260740	405222'	        GOSUB   OT1VEB                  ;PLACE IT IN THE RECORD.
  3601	405212'	272400	002715'	        ADDM    P3,OBSIZE               ;UPDATE BLOCK WORD.
  3602	405213'	260740	403777'	        GOSUB   UPDATE                  ;WRITE THE RECORD.
  3603	405214'	254000	405165'	        GOTO    OT0VEB                  ;RE-INITIALIZE.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 57
MAGCON.MAC	 6-JUL-77 09:25		*** VARABLE EBCDIC I/O ROUTINES ***

  3604				;HERE TO WRITE A BLOCK CTRL WORD ONTO THE BLOCK THAT IS ABOUT
  3605				;TO LEAVE US.
  3606
  3607	405215'	200400	002715'	OTBVEB: MOVE    P3,OBSIZE               ;GET THE BLOCK SIZE.
  3608	405216'	200140	000403'	        MOVE    T1,RECPTR               ;POINTER TO WHERE IT GOES.
  3609	405217'	260740	405222'	        GOSUB   OT1VEB                  ;WRITE THE BLOCK CTRL WORD.
  3610	405220'	402000	002715'	        SETZM   OBSIZE                  ;CLEAR BLOCK SIZE.
  3611	405221'	254000	404765'	        GOTO    OTBSIX                  ;COPY ALTER BUFFER TO OUTPUT BUFFER.
  3612	405222'	271400	000004	OT1VEB: ADDI    P3,4                    ;ADD IN THE SIZE OF THE CTRL WORD.
  3613	405223'	135600	414335'	        LDB     CH,[POINT 8,P3,27]      ;GET THE FIRST EIGHT BITS.
  3614	405224'	136600	000003	        IDPB    CH,T1                   ;SAVE THEM IN BUFFER.
  3615	405225'	136400	000003	        IDPB    P3,T1                   ;SAVE THE NEXT EIGHT BITS.
  3616				;        MOVEI   CH,100                  ;PUT SPACES IN THE REMAINING
  3617	405226'	201600	000000		MOVEI	CH,ZERO		;JILL MARCIN WANTS 0'S INSTEAD
  3618	405227'	136600	000003	        IDPB    CH,T1                   ;TWO BYTES OF THE CTRL WORD
  3619	405230'	136600	000003	        IDPB    CH,T1                   ;FOR THIS RECORD.
  3620	405231'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  3621
  3622				;HERE ON INPUT END OF FILE.
  3623
  3624	405232'	332000	002714'	OTFVEB: SKIPE   OSIZE                   ;SKIP IF JUST WROTE A RECORD.
  3625	405233'	254000	405203'	        GOTO    OT3VEB                  ;FINISH RECORD AND WRITE THE BLOCK.
  3626	405234'	550140	000403'	        HRRZ    T1,RECPTR               ;GET POINTER TO BUFFER.
  3627	405235'	550200	000405'	        HRRZ    T2,CURPTR               ;POINTER INTO BUFFER.
  3628	405236'	306144	777776	        CAIN    T1,-2(T2)               ;SEE IF AT THE TOP.
  3629	405237'	370000	000405'	        SOS     CURPTR                  ;DECREMENT FOR BLOCK WORD.
  3630	405240'	370000	000405'	        SOS     CURPTR                  ;DECREMENT FOR RECORD CTRL WORD.
  3631	405241'	254000	403774'	        GOTO    UPDAT                   ;FINISH THE FILE.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 58
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  3632				SUBTTL                          *** THINK ABOUT LABELS ***
  3633
  3634				;HERE TO READ THE LABEL AND TO DISPATCH TO THE
  3635				;APPROPRIATE ROUTINE TO HANDLE ITS FORMAT.
  3636
  3637	405242'	051600	000000	INPLAB: ENABLE  TTY                     ;CLEAR THE TTY.
  3638	405244'	200140	000045'	        MOVE    T1,IFILE+LABEL          ;GET LABEL INDEX.
  3639	405245'	550143	412700'	        HRRZ    T1,LB.TYP(T1)           ;COPY DISPATCH.
  3640	405246'	620000	700000	        OFF     S,L.HDR!L.EOF!L.EOV     ;TURN OFF LABEL BITS.
  3641	405247'	200200	413555'	        MOVE    T2,[XWD INPBUF,INPBUF+1];XWD FOR BLT.
  3642	405250'	402000	000065'	        SETZM   INPBUF                  ;CLEAR THE FIRST.
  3643	405251'	251200	000111'	        BLT     T2,INPBUF+^D20          ;CLEAR BUFFER.
  3644	405252'	260743	000000	        GOSUB   ZERO(T1)                ;CHECK LABEL OUT.
  3645	405253'	263740	412060'	        RETURN  ZERO                    ;NOT THAT TYPE OF LABEL.
  3646	405254'	606000	100000	        IF.OFF  S,L.HDR,RET3            ;JUMP IF NOT HEADER.
  3647	405256'	260740	411670'	        GOSUB   TSTNAM                  ;SEE IF NAME MATCHES.
  3648	405257'	254000	412057'	        RETURN  ONE                     ;NO MATCH ON NAME.
  3649	405260'	312400	000047'	        CAME    P3,IFILE+VOL            ;IS THE VOLUME RIGHT.
  3650	405261'	254000	412056'	        RETURN  TWO                     ;INCORRECT VOLUME.
  3651	405262'	254000	412055'	        RETURN  THREE                   ;LABEL PASSED BITS ARE SET.
  3652
  3653				;HERE TO CHECK AND WRITE OUTPUT LABELS. HERE WE
  3654				;ALSO DO INITIAL POSITIONING OF THE DEVICE.
  3655
  3656	405263'	606040	000010	OUTLAB: IF.OFF  OF,IND,OUTLA2           ;WHICH MODE FOR THE TAPE.
  3657	405265'	200140	000020'	        MOVE    T1,OFILE+CHRMOD
  3658	405266'	302140	413503'	        CAIE    T1,EBCMOD               ;CHECK ONLY FOR EBCDIC
  3659	405267'	254000	405305'	        GOTO    OUTLA1
  3660	405270'	200140	000010'	        MOVE    T1,OFILE+MOD            ;GET THE MODE BITS
  3661	405271'	606140	040000	        IF.OFF  T1,NOCRLF,OUTLA1        ;FORGET BYTE ADJUSTMENT FOR VARIABLE
  3662	405273'	200140	000012'	        MOVE    T1,OFILE+RECSIZ
  3663	405274'	332000	000011'	        SKIPE   OFILE+BLKFCT            ;DONT MULTIPLY BY ZERO
  3664	405275'	220140	000011'	        IMUL    T1,OFILE+BLKFCT         ;GET THE NUMBER OF CHARACTERS
  3665	405276'	231140	000004	        IDIVI   T1,4                    ;HOW MANY ARE LEFT
  3666	405277'	322200	405305'	        JUMPE   T2,OUTLA1               ;ZERO NEEDS NO SPECIAL TREATMENT
  3667	405300'	275200	000004	        SUBI    T2,4
  3668	405301'	213000	000004	        MOVNS   T2
  3669	405302'	270200	414336'	        ADD     T2,[DRIVE OF,101]       ;ADD TO MAKE INSTRUCTION
  3670	405303'	256000	000004	        XCT     T2                      ;AND EXECUTE IT
  3671	405304'	254000	405306'	        JRST    OUTLA2                  ;SKIP THE OTHER INITILIZE
  3672	405305'	072040	000101	OUTLA1: DRIVE   OF,.IND                 ;INDUSTRIAL.
  3673	405306'	051600	000000	OUTLA2: ENABLE  TTY                     ;CLEAR THE TTY.
  3674	405310'	200140	000014'	        MOVE    T1,OFILE+LABEL          ;GET THE LABEL INDEX.
  3675	405311'	554143	412700'	        HLRZ    T1,LB.TYP(T1)           ;COPY DISPATCH.
  3676	405312'	200200	414337'	        MOVE    T2,[XWD OUTBUF,OUTBUF+1];XWD FOR BLT.
  3677	405313'	402000	000112'	        SETZM   OUTBUF                  ;CLEAR FIRST WORD.
  3678	405314'	251200	000136'	        BLT     T2,OUTBUF+^D20          ;CLEAR BUFFER.
  3679	405315'	254003	000000	        GOTO    ZERO(T1)                ;DISPATCH.
  3680
  3681				;HERE WHEN WE ARE READY TO WRITE AN EOF LABEL
  3682				;TO THE TAPE.
  3683
  3684	405316'	660000	000020	EOFLAB: ON      S,TERM                  ;NOTE THAT THIS IS EOF.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 58-2
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  3685	405317'	260740	405263'	        GOSUB   OUTLAB                  ;OTHER WISE HANDLE AS HDR.
  3686	405320'	620000	000020	        OFF     S,TERM                  ;TURN OFF TERMINAL BIT.
  3687	405321'	062040	000003	        GETSTS  OF,T1                   ;GET DEVICE STATUS.
  3688	405322'	602140	740000	        IF.OFF  T1,E.ERR                ;ANY ERRORS.
  3689	405323'	051140	414340'	        PRINT   (? Error during close of output file.)
  3690	405324'	402000	000436'
  3691	405325'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 59
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  3692				;HERE IF NO LABEL TYPE WAS SPECIFIED.
  3693
  3694	405326'	072100	000007	LB.NON: DRIVE   IF,.BSR                 ;BACK UP OVER RECORD READ.
  3695	405327'	072100	000000	        DRIVE   IF,.WAT                 ;WAIT FOR IT.
  3696	405330'	200300	000035'	        MOVE    P1,IFILE+NAME           ;GET THE NAME.
  3697	405331'	510340	000036'	        HLLZ    P2,IFILE+EXT            ;GET THE EXTENSION.
  3698	405332'	200400	000047'	        MOVE    P3,IFILE+VOL            ;GET THE VOLUME NUMBER.
  3699	405333'	602100	000300	        IF.ON   IF,WNAME!WEXT,LB.0NO    ;JUMP IF WILD.
  3700	405335'	202300	000630'	LB.NST: MOVEM   P1,LABNAM               ;SAVE FIRST HALF OF NAME.
  3701	405336'	202340	000631'	        MOVEM   P2,LABNAM+1             ;SAVE THE SECOND HALF.
  3702	405337'	202400	000635'	        MOVEM   P3,LABVOL               ;SAVE THE VOLUME NUMBER.
  3703	405340'	047140	000014	        MME     T1,.DATE                ;GET THE DATE TODAY.
  3704	405341'	202140	000632'	        MOVEM   T1,LABDTW               ;SAVE THE DATE.
  3705	405342'	660000	100000	        ON      S,L.HDR                 ;SAY WE FOUND A HEADER.
  3706	405343'	254000	411412'	        GOTO    LABFIL                  ;GO FILL IN DEFAULTS.
  3707	405344'	260740	411716'	LB.0NO: GOSUB   DREAM                   ;GET A FUNNY NAME.
  3708	405345'	606100	000100	        IF.OFF  IF,WNAME,LB.1NO         ;JUMP IF NAME ISN'T WILD.
  3709	405347'	200300	000003	        MOVE    P1,T1                   ;COPY FUNNY NAME.
  3710	405350'	202300	000035'	        MOVEM   P1,IFILE+NAME           ;MAKE IT THE NAME.
  3711	405351'	606100	000200	LB.1NO: IF.OFF  IF,WEXT,LB.NST          ;JUMP IF TRUE EXTENSION.
  3712	405353'	200340	000004	        MOVE    P2,T2                   ;COPY FUNNY EXTENSION.
  3713	405354'	202340	000036'	        MOVEM   P2,IFILE+EXT            ;SAVE AS EXTENSION.
  3714	405355'	254000	405335'	        GOTO    LB.NST                  ;SAVE THIS INFO.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 60
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  3715				;HERE TO CHECK ON A SPECIAL LABEL THAT HAS
  3716				;INFORMATION ONLY VALID FOR DECSYSTEM-10.
  3717
  3718	405356'	200140	000016	LB.IMI: MOVE    T1,IM                   ;GET THE INPUT MODE.
  3719	405357'	260740	407610'	        GOSUB   CVTLAB                  ;CONVERT THE LABEL.
  3720	405360'	200140	000065'	        MOVE    T1,INPBUF               ;GET THE IDENTIFIER.
  3721	405361'	316140	414350'	        CAMN    T1,[SIXBIT "HEAD"]      ;SKIP IF NOT HEADER LABEL.
  3722	405362'	660000	100000	        ON      S,L.HDR                 ;LIGHT HEADER BIT.
  3723	405363'	316140	414351'	        CAMN    T1,[SIXBIT "TRAIL"]     ;SKIP IF NOT TRAILER.
  3724	405364'	660000	200000	        ON      S,L.EOF                 ;LIGHT EOF BIT.
  3725	405365'	316140	414352'	        CAMN    T1,[SIXBIT "REEL"]      ;SKIP IF NOT END OF REEL.
  3726	405366'	660000	400000	        ON      S,L.EOV                 ;LIGHT VOLUME BIT.
  3727	405367'	606000	700000	        IF.ON   S,L.HDR!L.EOF!L.EOV     ;SKIP IF WE FOUND ONE.
  3728	405370'	263740	412060'	        RETURN  ZERO                    ;GIVE NO LABEL RETURN.
  3729	405371'	200300	000067'	        MOVE    P1,INPBUF+2             ;GET THE FILE NAME.
  3730	405372'	510340	000070'	        HLLZ    P2,INPBUF+3             ;GET THE EXTENSION.
  3731	405373'	202300	000630'	        MOVEM   P1,LABNAM               ;SAVE THE NAME.
  3732	405374'	202340	000631'	        MOVEM   P2,LABNAM+1             ;SAVE THE EXTENSION.
  3733	405375'	200400	000076'	        MOVE    P3,INPBUF+11            ;GET THE VOLUME NUMBER.
  3734	405376'	202400	000635'	        MOVEM   P3,LABVOL               ;SAVE THE VOLUME NUMBER.
  3735	405377'	200140	000066'	        MOVE    T1,INPBUF+1             ;GET THE STRUCTURE.
  3736	405400'	202140	000627'	        MOVEM   T1,LABSTR               ;SAVE IT.
  3737	405401'	200140	000074'	        MOVE    T1,INPBUF+7             ;GET THE CREATION DATE.
  3738	405402'	260740	411442'	        GOSUB   DATCOB                  ;COMPRESS IT.
  3739	405403'	202140	000632'	        MOVEM   T1,LABDTW               ;SAVE THE DATE.
  3740	405404'	200200	000073'	        MOVE    T2,INPBUF+6             ;GET THE PROTECTION BITS.
  3741	405405'	260740	411424'	        GOSUB   TOBIN                   ;CONVERT IT IT BINARY.
  3742	405406'	137240	414324'	        DPB     T3,[POINT 9,LABDTW,8]   ;SAVE THE PROTECTION BITS.
  3743	405407'	200200	000071'	        MOVE    T2,INPBUF+4             ;GET THE PROJECT NUMBER.
  3744	405410'	260740	411424'	        GOSUB   TOBIN                   ;CONVERT IT.
  3745	405411'	506240	000633'	        HRLM    T3,LABPPN               ;SAVE THE FIRST HALF.
  3746	405412'	200200	000072'	        MOVE    T2,INPBUF+5             ;GET THE PROGRAM NUMBER.
  3747	405413'	260740	411424'	        GOSUB   TOBIN                   ;CONVERT IT.
  3748	405414'	542240	000633'	        HRRM    T3,LABPPN               ;SAVE THE PROGRAM NUMBER.
  3749	405415'	254000	412057'	        RETURN  ONE                     ;BACK TO CALLER.
  3750
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 61
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  3751				;HERE IF LABELS ARE TO BE CHECKED FOR BCL
  3752				;FORMAT.
  3753
  3754	405416'	200140	000016	LB.IBL: MOVE    T1,IM                   ;GET THE MODE OF INPUT FILE.
  3755	405417'	260740	407610'	        GOSUB   CVTLAB                  ;CONVERT THE LABEL TO SIXBIT.
  3756	405420'	200140	000065'	        MOVE    T1,INPBUF               ;MUST BE " LABEL".
  3757	405421'	312140	414353'	        CAME    T1,[SIXBIT " LABEL"]    ;MAKE SURE IT IS RIGHT.
  3758	405422'	263740	412060'	        RETURN  ZERO                    ;NOT A LEGAL LABEL.
  3759	405423'	200340	414354'	        MOVE    P2,[POINT 6,INPBUF+2,29];POINT TO LABEL-ID.
  3760	405424'	200300	414355'	        MOVE    P1,[POINT 6,T1]         ;POINT TO STORAGE WORD.
  3761	405425'	201400	000006	        MOVEI   P3,^D6                  ;COUNT TO COPY.
  3762	405426'	260740	411343'	        GOSUB   PLACE                   ;COPY THE CHARACTERS.
  3763	405427'	200300	000003	        MOVE    P1,T1                   ;COPY TO BETTER AC.
  3764	405430'	202300	000630'	        MOVEM   P1,LABNAM               ;SAVE FIRST HALF OF NAME.
  3765	405431'	510340	000036'	        HLLZ    P2,IFILE+EXT            ;GET THE EXTENSION.
  3766	405432'	402000	000631'	        SETZM   LABNAM+1                ;ZERO SECOND HALF.
  3767	405433'	135400	414356'	        LDB     P3,[POINT 18,INPBUF+4,17];PICK UP THE VOLUME NUMBER.
  3768	405434'	242400	000014	        LSH     P3,^D12                 ;SHIFT INTO PLACE.
  3769	405435'	661400	200000	        ON      P3,'0     '             ;ADD A LEADING ZERO.
  3770	405436'	202400	000635'	        MOVEM   P3,LABVOL               ;SAVE THE VOLUME NUMBER.
  3771	405437'	135140	414357'	        LDB     T1,[POINT 6,INPBUF+6,23];PICK UP FLAG BIT FOR EOF.
  3772	405440'	302140	000020	        CAIE    T1,'0'                  ;SEE IF FLAGED AS EOF.
  3773	405441'	660000	400000	        ON      S,L.EOV                 ;SET END OF VOLUME BIT.
  3774	405442'	602000	400000	        IF.ON   S,L.EOV,RET1            ;RETURN IF WE SET IT.
  3775	405444'	660000	100000	        ON      S,L.HDR                 ;SET HEADER BIT.
  3776	405445'	550140	000071'	        HRRZ    T1,INPBUF+4             ;GET THE FIRST HALF.
  3777	405446'	242140	000014	        LSH     T1,^D12                 ;SHIFT INTO PLACE.
  3778	405447'	135200	414360'	        LDB     T2,[POINT 12,INPBUF+5,11];GET THE SECON HALF.
  3779	405450'	434140	000004	        IOR     T1,T2                   ;COMBINE THEM.
  3780	405451'	242140	000006	        LSH     T1,^D6                  ;SET IT RIGHT.
  3781	405452'	260740	411462'	        GOSUB   DATBCL                  ;COMPRESS THE DATE.
  3782	405453'	254000	411412'	        GOTO    LABFIL                  ;FILL IN THE DEFAULTS.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 62
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  3783				;HERE TO CHECK LABELS WRITTEN IN DEC-COBOL
  3784				;FORMAT.
  3785
  3786	405454'	260740	407571'	LB.NCL: GOSUB   GETLAB                  ;READ A LABEL BLOCK.
  3787	405455'	263740	412060'	        RETURN  ZERO                    ;BAD WE MADE A MISTAKE.
  3788	405456'	200140	000016	LB.ICL: MOVE    T1,IM                   ;GET THE MODE OF INPUT.
  3789	405457'	260740	407610'	        GOSUB   CVTLAB                  ;CONVERT THE LABEL TO SIXBIT.
  3790	405460'	135140	414361'	        LDB     T1,[POINT 24,INPBUF,23] ;PICK UP HEADER WORD.
  3791	405461'	316140	414362'	        CAMN    T1,[SIXBIT "  VOL1"]    ;IS THIS A VOLUME LABEL.
  3792	405462'	254000	405454'	        GOTO    LB.NCL                  ;READ THE NEXT BLOCK IN.
  3793	405463'	316140	414363'	        CAMN    T1,[SIXBIT "  HDR1"]    ;IS IT A HEADER LABEL.
  3794	405464'	660000	100000	        ON      S,L.HDR                 ;SET HEADER BIT.
  3795	405465'	316140	414364'	        CAMN    T1,[SIXBIT "  EOF1"]    ;TEST FOR EOF LABEL.
  3796	405466'	660000	200000	        ON      S,L.EOF                 ;SET EOF BIT.
  3797	405467'	316140	414365'	        CAMN    T1,[SIXBIT "  EOV1"]    ;TEST FOR END OF REEL.
  3798	405470'	660000	400000	        ON      S,L.EOV                 ;SET END OF TAPE BIT.
  3799	405471'	606000	700000	        IF.ON   S,L.HDR!L.EOF!L.EOV     ;SKIP IF WE FOUND A LABEL.
  3800	405472'	263740	412060'	        RETURN  ZERO                    ;NOT A LABEL.
  3801	405473'	200340	414366'	        MOVE    P2,[POINT 6,INPBUF,23]  ;POINTER TO LABEL-ID.
  3802	405474'	200300	414367'	        MOVE    P1,[POINT 6,LABNAM]     ;POINTER TO STORAGE WORD.
  3803	405475'	402000	000631'	        SETZM   LABNAM+1                ;CLEAR TARGET.
  3804	405476'	201400	000011	        MOVEI   P3,^D9                  ;CHARACTERS TO PLACE.
  3805	405477'	260740	411343'	        GOSUB   PLACE                   ;PLACE THEM.
  3806	405500'	200300	000630'	        MOVE    P1,LABNAM               ;LOAD FIRST HALF OF NAME.
  3807	405501'	200340	000631'	        MOVE    P2,LABNAM+1             ;LOAD SECOND HALF OF NAME.
  3808	405502'	135140	414370'	        LDB     T1,[POINT 18,INPBUF+4,35];GET FIRST HALF OF NUMBER.
  3809	405503'	135200	414371'	        LDB     T2,[POINT 6,INPBUF+5,5] ;GET THE OTHER HALF.
  3810	405504'	242200	000036	        LSH     T2,^D30                 ;LEFT JUSTIFY DIGITS.
  3811	405505'	246140	000022	        LSHC    T1,^D18                 ;SHIFT INTO PLACE.
  3812	405506'	200400	000003	        MOVE    P3,T1                   ;COPY TO RETURN AC.
  3813	405507'	202400	000635'	        MOVEM   P3,LABVOL               ;SAVE THE VOLUME NUMBER.
  3814	405510'	135140	414372'	        LDB     T1,[POINT 6,INPBUF+6,35];GET THE FIRST HALF OF DATE.
  3815	405511'	242140	000036	        LSH     T1,^D30                 ;SHIFT INTO PLACE.
  3816	405512'	135200	414373'	        LDB     T2,[POINT 29,INPBUF+7,29];GET THE OTHER BITS.
  3817	405513'	434140	000004	        IOR     T1,T2                   ;MAKE ONE WORD.
  3818	405514'	260740	411442'	        GOSUB   DATCOB                  ;COMPRESS THE DATE.
  3819	405515'	254000	411412'	        GOTO    LABFIL                  ;FILL IN DEFAULTS.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 63
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  3820				;HERE TO CHECK LABELS WRITTEN IN GE635 BCD.
  3821
  3822	405516'	201140	413455'	LB.IGE: MOVEI   T1,XBDMOD               ;GET MODE FOR LABELS.
  3823	405517'	260740	407610'	        GOSUB   CVTLAB                  ;CONVERT IT TO SIXBIT.
  3824	405520'	200140	000065'	        MOVE    T1,INPBUF               ;GET FIRST WORD OF LABEL.
  3825	405521'	200200	000066'	        MOVE    T2,INPBUF+1             ;GET THE SECOND WORD OF LABEL.
  3826	405522'	316140	414374'	        CAMN    T1,[SIXBIT "GE  60"]    ;TEST THE FIRST WORD.
  3827	405523'	312200	414375'	        CAME    T2,[SIXBIT "0 BTL "]    ;TEST THE SECOND WORD.
  3828	405524'	254000	405530'	        GOTO    LB.0GE                  ;CHECK FOR EOF AND EOR.
  3829	405525'	200200	000067'	        MOVE    T2,INPBUF+2             ;GET THE THIRD WORD OF LABEL.
  3830	405526'	316200	414376'	        CAMN    T2,[SIXBIT "GE PHX"]    ;TEST THE THIRD WORD.
  3831	405527'	660000	100000	        ON      S,L.HDR                 ;SET THE HEADER BIT.
  3832	405530'	316140	414377'	LB.0GE: CAMN    T1,[SIXBIT " EOF  "]    ;SEE IF END OF FILE LABEL.
  3833	405531'	660000	200000	        ON      S,L.EOF                 ;SET EOF BIT.
  3834	405532'	316140	414400'	        CAMN    T1,[SIXBIT " EOR  "]    ;SEE IF END OF REEL.
  3835	405533'	660000	400000	        ON      S,L.EOV                 ;SET END OF REEL BIT.
  3836	405534'	606000	700000	        IF.ON   S,L.HDR!L.EOF!L.EOV     ;SKIP IF WE FOUND A LABEL.
  3837	405535'	263740	412060'	        RETURN  ZERO                    ;NOT A GE LABEL.
  3838	405536'	606000	100000	        IF.OFF  S,L.HDR,RET1            ;RETURN IF NOT HEADER.
  3839	405540'	200300	000070'	        MOVE    P1,INPBUF+3             ;GET THE NAME IN THE LABEL.
  3840	405541'	510340	000036'	        HLLZ    P2,IFILE+EXT            ;GET THE EXTENSION.
  3841	405542'	242300	000006	        LSH     P1,6                    ;SHIFT INTO PLACE.
  3842	405543'	202300	000630'	        MOVEM   P1,LABNAM               ;SAVE THE LABEL NAME.
  3843	405544'	402000	000631'	        SETZM   LABNAM+1                ;CLEAR OTHER HALF.
  3844	405545'	200140	000035'	        MOVE    T1,IFILE+NAME           ;GET THE NAME SPECIFIED.
  3845	405546'	405140	000077	        ANDI    T1,77                   ;ONLY CHECK FIVE CHARACTERS.
  3846	405547'	434300	000003	        IOR     P1,T1                   ;SO COMPARE WILL ONLY CHECK FIVE.
  3847	405550'	200400	000072'	        MOVE    P3,INPBUF+5             ;GET THE VOLUME NUMBER.
  3848	405551'	242400	000014	        LSH     P3,^D12                 ;SHIFT INTO PLACE.
  3849	405552'	202400	000635'	        MOVEM   P3,LABVOL               ;SAVE THE VOLUME NUMBER.
  3850	405553'	135140	414401'	        LDB     T1,[POINT 30,INPBUF+6,35] ;GET THE DATE.
  3851	405554'	242140	000006	        LSH     T1,6                    ;SHIFT INTO PLACE.
  3852	405555'	260740	411462'	        GOSUB   DATBCL                  ;COMPRESS THE DATE.
  3853	405556'	254000	411412'	        GOTO    LABFIL                  ;FILL IN DEFAULTS.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 64
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  3854				;HERE TO READ AND VERIFY IBM LABELS.
  3855
  3856	405557'	260740	407571'	LB.NBM: GOSUB   GETLAB                  ;READ A LABEL BLOCK.
  3857	405560'	263740	412060'	        RETURN  ZERO                    ;BAD WE MADE A MISTAKE.
  3858	405561'	201140	413427'	LB.IBM: MOVEI   T1,BCDMOD               ;SET BCD MODE.
  3859	405562'	201200	000002	        MOVEI   T2,IF                   ;CHANNEL FOR INPUT FILE.
  3860	405563'	047200	000054	        MME     T2,.STS                 ;GET THE CONI WORD.
  3861	405564'	334000	000000	        SKIPA                           ;IF IT FAILS USE EBCDIC.
  3862	405565'	606200	000004	        IF.ON   T2,TRK7                 ;IF SEVEN TRACK WE'RE GOLDEN.
  3863	405566'	201140	413503'	        MOVEI   T1,EBCMOD               ;ELSE GET EBCDIC.
  3864	405567'	260740	407610'	        GOSUB   CVTLAB                  ;CONVERT THE LABEL TO SIXBIT.
  3865	405570'	135140	414361'	        LDB     T1,[POINT 24,INPBUF,23] ;GET THE LABEL TYPE.
  3866	405571'	316140	414362'	        CAMN    T1,[SIXBIT "  VOL1"]    ;CHECK FOR VOLUME LABEL.
  3867	405572'	254000	405557'	        GOTO    LB.NBM                  ;GET THE NEXT LABEL BLOCK.
  3868	405573'	316140	414363'	        CAMN    T1,[SIXBIT "  HDR1"]    ;SEE IF HEADER LABEL.
  3869	405574'	660000	100000	        ON      S,L.HDR                 ;SET THE HEADER BIT.
  3870	405575'	316140	414364'	        CAMN    T1,[SIXBIT "  EOF1"]    ;TEST FOR END OF FILE LABEL.
  3871	405576'	660000	200000	        ON      S,L.EOF                 ;SET EOF BIT.
  3872	405577'	316140	414365'	        CAMN    T1,[SIXBIT "  EOV1"]    ;TEST FOR END OF REEL.
  3873	405600'	660000	400000	        ON      S,L.EOV                 ;SET END OF REEL BIT.
  3874	405601'	606000	700000	        IF.ON   S,L.HDR!L.EOF!L.EOV     ;SKIP IF WE FOUND A LABEL.
  3875	405602'	263740	412060'	        RETURN  ZERO                    ;ELSE GIVE ERROR RETURN.
  3876	405603'	200140	414366'	        MOVE    T1,[POINT 6,INPBUF,23]  ;POINTER TO FILE NAME.
  3877	405604'	200200	414402'	        MOVE    T2,[POINT 6,P1]         ;POINTER TO STORAGE.
  3878	405605'	201240	000006	        MOVEI   T3,^D6                  ;NUMBER TO PLACE.
  3879	405606'	201400	000021	        MOVEI   P3,^D17                 ;MAX NUMBER TO READ.
  3880	405607'	260740	411544'	        GOSUB   COPY                    ;COPY TO STORAGE.
  3881	405610'	200200	414403'	        MOVE    T2,[POINT 6,P2]         ;SET POINTER TO STORAGE.
  3882	405611'	201240	000003	        MOVEI   T3,^D3                  ;SET MAX COUNT TO PLACE.
  3883	405612'	260740	411544'	        GOSUB   COPY                    ;COPY THEM TO STORAGE.
  3884	405613'	202300	000630'	        MOVEM   P1,LABNAM               ;SAVE FIRST HALF OF NAME.
  3885	405614'	202340	000631'	        MOVEM   P2,LABNAM+1             ;SAVE THE SECOND HALF.
  3886	405615'	135140	414370'	        LDB     T1,[POINT 18,INPBUF+4,35];GET FIRST PART OF VOLUME NUMBER.
  3887	405616'	135200	414371'	        LDB     T2,[POINT 6,INPBUF+5,5] ;GET THE SECOND HALF.
  3888	405617'	242200	000036	        LSH     T2,^D30                 ;RIGHT JUSTIFY SECOND HALF.
  3889	405620'	246140	000022	        LSHC    T1,^D18                 ;ALL INTO ONE WORD.
  3890	405621'	200400	000003	        MOVE    P3,T1                   ;COPY TO RETURN AC.
  3891	405622'	202400	000635'	        MOVEM   P3,LABVOL               ;SAVE THE VOLUME NUMBER.
  3892	405623'	200140	000074'	        MOVE    T1,INPBUF+7             ;GET THE DATE.
  3893	405624'	260740	411462'	        GOSUB   DATBCL                  ;COMPRESS THE DATE.
  3894	405625'	254000	411412'	        GOTO    LABFIL                  ;GO FILL IN DEFAULTS.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 65
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  3895				;HERE TO WRITE SPECIAL LABELS THAT HAVE INFORMATION
  3896				;FOR DECSYSTEM-10 ONLY.
  3897
  3898	405626'	200300	414350'	LB.OMI: MOVE    P1,[SIXBIT "HEAD"]      ;LOAD HEADER WORD.
  3899	405627'	602000	000020	        IF.OFF  S,TERM                  ;SKIP IF NOT TRAILER.
  3900	405630'	200300	414351'	        MOVE    P1,[SIXBIT "TRAIL"]     ;LOAD TRAILER WORD.
  3901	405631'	602000	000040	        IF.OFF  S,FIN                   ;SKIP IF NOT END OF REEL.
  3902	405632'	200300	414352'	        MOVE    P1,[SIXBIT "REEL"]      ;LOAD END OF REEL WORD.
  3903	405633'	202300	000112'	        MOVEM   P1,OUTBUF               ;SAVE THE IDENTIFIER.
  3904	405634'	200300	000031'	        MOVE    P1,IFILE+CHAN           ;GET THE CHANNEL FOR INPUT.
  3905	405635'	047300	000064	        MME     P1,.NAM                 ;GET THE REAL NAME.
  3906	405636'	200300	000033'	        MOVE    P1,IFILE+DEVICE         ;IF MME FAILS.
  3907	405637'	202300	000113'	        MOVEM   P1,OUTBUF+1             ;SAVE DEVICE WHERE IT CAME FROM.
  3908	405640'	200300	000004'	        MOVE    P1,OFILE+NAME           ;GET THE NAME.
  3909	405641'	202300	000114'	        MOVEM   P1,OUTBUF+2             ;SAVE THE NAME.
  3910	405642'	510300	000005'	        HLLZ    P1,OFILE+EXT            ;GET THE EXTENSION.
  3911	405643'	202300	000115'	        MOVEM   P1,OUTBUF+3             ;SAVE THE EXTENSION.
  3912	405644'	332140	000007'	        SKIPE   T1,OFILE+PPN            ;GET THE PPN TO WRITE IT AS.
  3913	405645'	254000	405650'	        GOTO    .+3                     ;CONTINUE ON WITH PPN IN T1.
  3914	405646'	336140	000040'	        SKIPN   T1,IFILE+PPN            ;GET THE INPUT PPN IF THERE.
  3915	405647'	047140	000024	        MME     T1,.PPN                 ;NO PPN USE CURRENT.
  3916	405650'	255000	000000	        NOP                             ;IN CASE OF JACCT.
  3917	405651'	260740	412130'	        GOSUB   MAK2                    ;CONVERT TO TWO WORDS.
  3918	405652'	202140	000116'	        MOVEM   T1,OUTBUF+4             ;SAVE THE PROJECT NUMBER.
  3919	405653'	202200	000117'	        MOVEM   T2,OUTBUF+5             ;SAVE THE PROGRAM NUMBER.
  3920	405654'	135140	414404'	        LDB     T1,[POINT 9,IFILE+DATTIM,8] ;LOAD PROTECTION BITS.
  3921	405655'	260740	412130'	        GOSUB   MAK2                    ;CONVERT TO SIXBIT.
  3922	405656'	202200	000120'	        MOVEM   T2,OUTBUF+6             ;SAVE THE PROTECTION CODE.
  3923	405657'	135140	414405'	        LDB     T1,[POINT 12,IFILE+DATTIM,35] ;LOAD DATE OF CREATION.
  3924	405660'	200300	414406'	        MOVE    P1,[POINT 6,OUTBUF+7]   ;GET A POINTER TO BUFFER.
  3925	405661'	260740	411327'	        GOSUB   COBDAT                  ;PLACE DATE OF CRETATION.
  3926	405662'	047140	000014	        MME     T1,.DATE                ;GET TODAYS DATE.
  3927	405663'	260740	411327'	        GOSUB   COBDAT                  ;PUT IT AWAY.
  3928	405664'	200300	000016'	        MOVE    P1,OFILE+VOL            ;GET THE VOLUME NUMBER OF TAPE.
  3929	405665'	202300	000123'	        MOVEM   P1,OUTBUF+11            ;SAVE THE VOLUME NUMBER.
  3930	405666'	200140	000017'	        MOVE    T1,OFILE+PERGE          ;GET THE REEL SERIAL NUMBER.
  3931	405667'	260740	412127'	        GOSUB   MAKTWO                  ;CONVERT TO TWO WORDS.
  3932	405670'	202200	000124'	        MOVEM   T2,OUTBUF+12            ;SAVE THE SERIAL NUMBER.
  3933	405671'	200140	000355'	        MOVE    T1,OBCNT                ;GET THE BLOCK.
  3934	405672'	606000	000060	        IF.ON   S,TERM!FIN              ;SKIP IF TRAILER OR REEL LABEL.
  3935	405673'	402000	000003	        SETZM   T1                      ;ZERO BLOCK COUNTER.
  3936	405674'	260740	412127'	        GOSUB   MAKTWO                  ;CONVERT TO TWO WORDS.
  3937	405675'	202200	000125'	        MOVEM   T2,OUTBUF+13            ;SAVE BLOCKS WRITTEN.
  3938	405676'	200140	000354'	        MOVE    T1,ORCNT                ;GET THE RECORD COUNTER.
  3939	405677'	606000	000060	        IF.ON   S,TERM!FIN              ;SKIP IF TRAILER OR REEL LABEL.
  3940	405700'	402000	000003	        SETZM   T1                      ;CLEAR RECORD COUNTER.
  3941	405701'	260740	412127'	        GOSUB   MAKTWO                  ;CONVERT TO TWO WORDS.
  3942	405702'	200340	414407'	        MOVE    P2,[POINT 6,T1,23]      ;POINTER TO WHAT WE WANT.
  3943	405703'	200300	414410'	        MOVE    P1,[POINT 6,OUTBUF+14]  ;POINTER TO STORAGE.
  3944	405704'	201400	000010	        MOVEI   P3,^D8                  ;NUMBER TO PLACE.
  3945	405705'	260740	411343'	        GOSUB   PLACE                   ;PLACE THEM.
  3946	405706'	200200	000015	        MOVE    T2,OM                   ;GET THE OUTPUT INDEX.
  3947	405707'	254000	406214'	        GOTO    LB.CLO                  ;WRITE LABEL TO TAPE.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 66
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  3948				;HERE TO PRODUCE IBM 360/OS LABELS.
  3949
  3950	405710'	201200	413427'	LB.OBM: MOVEI   T2,BCDMOD               ;ASSUME A SEVEN TRACK DRIVE.
  3951	405711'	201140	000001	        MOVEI   T1,OF                   ;GET OUTPUT DEVICE CHANNEL.
  3952	405712'	047140	000054	        MME     T1,.STS                 ;GET LAST CONI WORD.
  3953	405713'	334000	000000	        SKIPA                           ;USE EBCDIC IF MME FAILS.
  3954	405714'	606140	000004	        IF.ON   T1,TRK7                 ;SKIP IF SEVEN TRACK DRIVE.
  3955	405715'	201200	413503'	        MOVEI   T2,EBCMOD               ;ELSE USE EBCDIC.
  3956	405716'	202200	000376'	        MOVEM   T2,TEMP1                ;SAVE WHAT WE DECIDED ON.
  3957	405717'	602000	000020	        IF.ON   S,TERM,LB.OBH           ;JUMP IF TRAILER.
  3958	405721'	062040	000003	        GETSTS  OF,T1                   ;GET THE DEVICE STATUS.
  3959	405722'	606140	004000	        IF.OFF  T1,E.BOT,LB.OBH         ;ONLY WRITE VOL'S AT BOT.
  3960	405724'	332000	000017'	        SKIPE   OFILE+PERGE             ;REEL NUMBER SPECIFIED.
  3961	405725'	254000	406130'	        GOTO    LB.PBM                  ;YES PERGE THE LABEL.
  3962	405726'	200200	000376'	        MOVE    T2,TEMP1                ;GET THE MODE OF THE LABEL.
  3963	405727'	260740	407631'	        GOSUB   REDOUT                  ;READ THE OUTPUT LABEL.
  3964	405730'	254000	410326'	        GOTO    BADTM                   ;EOF MARK FOUND.
  3965	405731'	072040	000007	        DRIVE   OF,.BSR                 ;BACK UP OVER LABEL.
  3966	405732'	072040	000000	        DRIVE   OF,.WAT                 ;WAIT FOR COMPLETION.
  3967	405733'	135140	414411'	        LDB     T1,[POINT 24,OUTBUF,23] ;GET THE IDENTIFIER.
  3968	405734'	316140	414363'	        CAMN    T1,[SIXBIT "  HDR1"]    ;IS IT A HEADER LABEL.
  3969	405735'	254000	405766'	        GOTO    LB.OBH                  ;YES SO DON'T WRITE A VOL LABEL.
  3970	405736'	312140	414362'	        CAME    T1,[SIXBIT "  VOL1"]    ;IS IT A VOLUME LABEL.
  3971	405737'	254000	410264'	        GOTO    NOTLAB                  ;NO SO ERROR.
  3972	405740'	200340	414412'	        MOVE    P2,[POINT 6,OUTBUF,23]  ;POINTER TO SERIAL NUMBER.
  3973	405741'	200300	414413'	        MOVE    P1,[POINT 6,RELNUM]     ;POINTER TO STORAGE.
  3974	405742'	201400	000006	        MOVEI   P3,^D6                  ;CHARACTERS TO MOVE.
  3975	405743'	260740	411343'	        GOSUB   PLACE                   ;MOVE THEM.
  3976	405744'	200300	414414'	LB.BVL: MOVE    P1,[POINT 6,OUTBUF]     ;POINTER TO STORAGE.
  3977	405745'	200340	414416'	        MOVE    P2,[POINT 6,[SIXBIT "VOL1"]];IDENTIFIER.
  3978	405746'	201400	000004	        MOVEI   P3,^D4                  ;CHARACTERS TO MOVE.
  3979	405747'	260740	411343'	        GOSUB   PLACE                   ;MOVE THEM.
  3980	405750'	200340	414413'	        MOVE    P2,[POINT 6,RELNUM]     ;POINTER TO REEL NUMBER.
  3981	405751'	201400	000006	        MOVEI   P3,^D6                  ;NUMBER TO PLACE.
  3982	405752'	260740	411343'	        GOSUB   PLACE                   ;MOVE THEM TO BUFFER.
  3983	405753'	201600	000020	        MOVEI   CH,'0'                  ;A LONELY ZERO.
  3984	405754'	136600	000006	        IDPB    CH,P1                   ;PLACE INTO BUFFER.
  3985	405755'	201400	000036	        MOVEI   P3,^D30                 ;COUNT FOR SOME SPACES.
  3986	405756'	260740	411347'	        GOSUB   SPACE                   ;PLACE THEM INTO BUFFER.
  3987	405757'	200340	414421'	        MOVE    P2,[POINT 6,[SIXBIT "DIGITAL"]];PLACE THAT DID THIS.
  3988	405760'	201400	000007	        MOVEI   P3,^D7                  ;A COUNTER.
  3989	405761'	260740	411343'	        GOSUB   PLACE                   ;INTO BUFFER.
  3990	405762'	201400	000040	        MOVEI   P3,^D32                 ;SOME MORE SPACES.
  3991	405763'	260740	411347'	        GOSUB   SPACE                   ;ADD THEM TO BUFFER.
  3992	405764'	200200	000376'	        MOVE    T2,TEMP1                ;GET MODE OF OUTPUT.
  3993	405765'	260740	407677'	        GOSUB   WRILAB                  ;WRITE THE LABEL.
  3994	405766'	200300	414414'	LB.OBH: MOVE    P1,[POINT 6,OUTBUF]     ;SET A NEW POINTER.
  3995	405767'	200340	414423'	        MOVE    P2,[POINT 6,[SIXBIT "HDR1"]];HEADER ONE ID.
  3996	405770'	602000	000020	        IF.OFF  S,TERM                  ;IS THIS REALLY EOF.
  3997	405771'	200340	414425'	        MOVE    P2,[POINT 6,[SIXBIT "EOF1"]];CHANGE MESSAGE.
  3998	405772'	602000	000040	        IF.OFF  S,FIN                   ;IS THIS REALLY JUST END OF REEL.
  3999	405773'	200340	414427'	        MOVE    P2,[POINT 6,[SIXBIT "EOV1"]];CHANGE MESSAGE.
  4000	405774'	201400	000004	        MOVEI   P3,^D4                  ;COUNT TO PLACE.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 66-2
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  4001	405775'	260740	411343'	        GOSUB   PLACE                   ;INTO BUFFER.
  4002	405776'	200340	414430'	        MOVE    P2,[POINT 6,OFILE+NAME] ;POINTER TO FILE-ID.
  4003	405777'	201400	000011	        MOVEI   P3,^D9                  ;CHARACTERS TO MOVE.
  4004	406000'	260740	411343'	        GOSUB   PLACE                   ;IN TO BUFFER.
  4005	406001'	201400	000016	        MOVEI   P3,^D14                 ;CHARACTERS TO SPACE.
  4006	406002'	260740	411347'	        GOSUB   SPACE                   ;INTO BUFFER.
  4007	406003'	200340	414431'	        MOVE    P2,[POINT 6,OFILE+VOL]  ;POINTER TO VOLUME NUMBER.
  4008	406004'	201400	000004	        MOVEI   P3,^D4                  ;NUMBER TO MOVE.
  4009	406005'	260740	411343'	        GOSUB   PLACE                   ;INTO BUFFER.
  4010	406006'	201400	000013	        MOVEI   P3,^D11                 ;SOME MORE SPACES.
  4011	406007'	260740	411347'	        GOSUB   SPACE                   ;INTO BUFFER.
  4012	406010'	047140	000014	        MME     T1,.DATE                ;GET TODAY'S DATE.
  4013	406011'	260740	411761'	        GOSUB   BCLDAT                  ;INTO BUFFER.
  4014	406012'	402000	000014	        SETZM   CH                      ;AN UNWANTED SPACE.
  4015	406013'	136600	000006	        IDPB    CH,P1                   ;SAVE IT.
  4016	406014'	047140	000014	        MME     T1,.DATE                ;GET THE DATE AGAIN.
  4017	406015'	271140	001730	        ADDI    T1,^D984                ;SAVE FACTOR.
  4018	406016'	260740	411761'	        GOSUB   BCLDAT                  ;INTO BUFFER.
  4019	406017'	201600	000020	        MOVEI   CH,'0'                  ;A LITTLE ZERO.
  4020	406020'	136600	000006	        IDPB    CH,P1                   ;INTO BUFFER.
  4021	406021'	606000	000020	        IF.OFF  S,TERM,LB.IBH           ;JUMP IF HEADER.
  4022	406023'	200140	000355'	        MOVE    T1,OBCNT                ;GET THE BLOCK COUNT.
  4023	406024'	260740	412127'	        GOSUB   MAKTWO                  ;INTO TWO WORDS.
  4024	406025'	334340	414432'	        SKIPA   P2,[POINT 6,T2]         ;SET POINTER.
  4025	406026'	200340	414434'	LB.IBH: MOVE    P2,[POINT 6,[SIXBIT "000000"]];FILL BLOCK COUNT WITH ZEROS.
  4026	406027'	201400	000006	        MOVEI   P3,^D6                  ;COUNT TO MOVE.
  4027	406030'	260740	411343'	        GOSUB   PLACE                   ;INTO BUFFER.
  4028	406031'	201400	000024	        MOVEI   P3,^D20                 ;SOME SPACES.
  4029	406032'	260740	411347'	        GOSUB   SPACE                   ;INTO BUFFER.
  4030	406033'	200200	000376'	        MOVE    T2,TEMP1                ;GET THE MODE OF OUTPUT.
  4031	406034'	260740	407677'	        GOSUB   WRILAB                  ;WRITE THE LABEL.
  4032	406035'	200300	414414'	        MOVE    P1,[POINT 6,OUTBUF]     ;GET NEW POINTER.
  4033	406036'	200340	414436'	        MOVE    P2,[POINT 6,[SIXBIT "HDR2"]];ASSUME HEADER LABEL.
  4034	406037'	602000	000020	        IF.OFF  S,TERM                  ;SKIP IF NOT EOF.
  4035	406040'	200340	414440'	        MOVE    P2,[POINT 6,[SIXBIT "EOF2"]];CHANGE MESSAGE.
  4036	406041'	602000	000040	        IF.OFF  S,FIN                   ;SKIP IF NOT END OF REEL.
  4037	406042'	200340	414442'	        MOVE    P2,[POINT 6,[SIXBIT "EOV2"]];CHANGE MESSAGE.
  4038	406043'	201400	000004	        MOVEI   P3,^D4                  ;COUNT TO PUT.
  4039	406044'	260740	411343'	        GOSUB   PLACE                   ;INTO BUFFER.
  4040	406045'	550140	000015	        HRRZ    T1,OM                   ;GET THE OUTPUT MODE.
  4041	406046'	402000	000004	        SETZM   T2                      ;CLEAR INDEX.
  4042	406047'	306140	413516'	        CAIN    T1,VEBMOD               ;IS IT VARIABLE EBCDIC.
  4043	406050'	201200	000001	        MOVEI   T2,ONE                  ;YES SET INDEX TO ONE.
  4044	406051'	306140	413503'	        CAIN    T1,EBCMOD               ;IS IF FIXED EBCDIC.
  4045	406052'	201200	000002	        MOVEI   T2,TWO                  ;YES SET INDEX TO TWO.
  4046	406053'	200604	414443'	        MOVE    CH,[EXP 'U','V','F'](T2);GET DISCRIPTOR.
  4047	406054'	136600	000006	        IDPB    CH,P1                   ;INTO BUFFER.
  4048	406055'	200140	000012'	        MOVE    T1,OFILE+RECSIZ         ;GET THE RECORD SIZE.
  4049	406056'	270144	414446'	        ADD     T1,[EXP 0,4,0](T2)      ;ADD IN THE OFFSET.
  4050	406057'	332000	000011'	        SKIPE   OFILE+BLKFCT            ;SKIP IF NO BLOCKING FACTOR.
  4051	406060'	220140	000011'	        IMUL    T1,OFILE+BLKFCT         ;MULTIPLY BY BLOCKING FACTOR.
  4052	406061'	270144	414446'	        ADD     T1,[EXP 0,4,0](T2)      ;ADD IN OFFSET.
  4053	406062'	261740	000004	        SAVE    T2                      ;SAVE THE INDEX.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 66-3
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  4054	406063'	260740	412127'	        GOSUB   MAKTWO                  ;CONVERT IT TO TWO WORDS.
  4055	406064'	200340	414451'	        MOVE    P2,[POINT 6,T2,5]       ;POINTER TO WHAT WE WANT.
  4056	406065'	201400	000005	        MOVEI   P3,^D5                  ;CHARACTERS TO PLACE.
  4057	406066'	260740	411343'	        GOSUB   PLACE                   ;INTO BUFFER.
  4058	406067'	262740	000004	        UNSAVE  T2                      ;RESTORE THE INDEX.
  4059	406070'	200140	000012'	        MOVE    T1,OFILE+RECSIZ         ;GET THE RECORD SIZE.
  4060	406071'	270144	414446'	        ADD     T1,[EXP 0,4,0](T2)      ;ADD IN THE OFFSET.
  4061	406072'	220144	414452'	        IMUL    T1,[EXP 0,1,1](T2)      ;PRODUCE RECORD SIZE.
  4062	406073'	260740	412127'	        GOSUB   MAKTWO                  ;CONVERT TO TWO WORDS.
  4063	406074'	200340	414451'	        MOVE    P2,[POINT 6,T2,5]       ;POINTER TO WHAT WE WANT.
  4064	406075'	201400	000005	        MOVEI   P3,^D5                  ;CHARACTERS TO PLACE.
  4065	406076'	260740	411343'	        GOSUB   PLACE                   ;INTO BUFFER.
  4066	406077'	201140	000001	        MOVEI   T1,OF                   ;GET THE OUTPUT CHANNEL NUMBER.
  4067	406100'	047140	000112	        MME     T1,.TAPE                ;GET THE DENSITY OF THE TAPE.
  4068	406101'	201140	000003	        MOVEI   T1,3                    ;MAKE IT 800 IF IT FAILS.
  4069	406102'	271140	000017	        ADDI    T1,'0'-1                ;MAKE IT SIXBIT.
  4070	406103'	136140	000006	        IDPB    T1,P1                   ;INTO BUFFER.
  4071	406104'	201600	000020	        MOVEI   CH,'0'                  ;LOAD A ZERO FOR EOF.
  4072	406105'	602000	000040	        IF.OFF  S,FIN                   ;SKIP IF NOT EOV.
  4073	406106'	201600	000021	        MOVEI   CH,'1'                  ;DENOTE END OF REEL.
  4074	406107'	136600	000006	        IDPB    CH,P1                   ;SAVE IT IN THE BUFFER.
  4075	406110'	200340	414455'	        MOVE    P2,[POINT 6,PRGNAM]     ;POINT TO OUR NAME.
  4076	406111'	201400	000006	        MOVEI   P3,^D6                  ;CHARACTERS IN NAME.
  4077	406112'	260740	411343'	        GOSUB   PLACE                   ;INTO BUFFER.
  4078	406113'	200340	414457'	        MOVE    P2,[POINT 6,[SIXBIT "  /"]];SOME GOOD THINGS.
  4079	406114'	201400	000003	        MOVEI   P3,^D3                  ;CHARACTERS TO MOVE.
  4080	406115'	260740	411343'	        GOSUB   PLACE                   ;INTO BUFFER.
  4081	406116'	201400	000014	        MOVEI   P3,^D12                 ;COUNT FOR SOME SPACES.
  4082	406117'	260740	411347'	        GOSUB   SPACE                   ;INTO BUFFER.
  4083	406120'	201600	000042	        MOVEI   CH,'B'                  ;LOAD A B FOR BLOCKED RECORDS.
  4084	406121'	602040	000040	        IF.OFF  OF,SPAN                 ;ARE WE SPANNING.
  4085	406122'	201600	000063	        MOVEI   CH,'S'                  ;YES LOAD AN S.
  4086	406123'	136600	000006	        IDPB    CH,P1                   ;SAVE IT IN THE BUFFER.
  4087	406124'	201400	000051	        MOVEI   P3,^D41                 ;FINISH THE RECORD WITH
  4088	406125'	260740	411347'	        GOSUB   SPACE                   ;SPACES.
  4089	406126'	200200	000376'	        MOVE    T2,TEMP1                ;GET THE MODE OF THE LABEL.
  4090	406127'	254000	406214'	        GOTO    LB.CLO                  ;WRITE THE LABEL.
  4091
  4092				;HERE TO PEGE AN IBM LABEL.
  4093
  4094	406130'	662000	004000	LB.PBM: TEO     S,PRG                   ;BEEN HERE BEFORE.
  4095	406131'	354140	000017'	        AOSA    T1,OFILE+PERGE          ;YES SO BUMP NUMBER.
  4096	406132'	200140	000017'	        MOVE    T1,OFILE+PERGE          ;NO SO GET THE PERGE NUMBER.
  4097	406133'	260740	412127'	        GOSUB   MAKTWO                  ;CONVERT IT TO TWO WORDS.
  4098	406134'	200300	414413'	        MOVE    P1,[POINT 6,RELNUM]     ;POINTER TO STORAGGE.
  4099	406135'	200340	414432'	        MOVE    P2,[POINT 6,T2]         ;POINTER TO NUMBER.
  4100	406136'	201400	000006	        MOVEI   P3,^D6                  ;COUNT TO MOVE.
  4101	406137'	260740	411343'	        GOSUB   PLACE                   ;INTO STORAGE.
  4102	406140'	062040	000003	        GETSTS  OF,T1                   ;GET THE DEVICE STATUS.
  4103	406141'	606140	004000	        IF.OFF  T1,E.BOT,LB.OBH         ;VOL1 ONLY AT BOT.
  4104	406143'	254000	405744'	        GOTO    LB.BVL                  ;OTHERWISE LABELS ARE STANDARD.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 67
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  4105				;HERE TO WRITE GE635 LABELS IN GE635 BCD.
  4106
  4107	406144'	200300	414414'	LB.OGE: MOVE    P1,[POINT 6,OUTBUF]     ;SET POINTER TO BUFFER.
  4108	406145'	602000	000020	        IF.ON   S,TERM,LB.GED           ;JUMP IF REALLY TRAILERS.
  4109	406147'	200340	414464'	        MOVE    P2,[POINT 6,[SIXBIT "GE  600 BTL GE PHX "]];IDENTIFIER.
  4110	406150'	201400	000023	        MOVEI   P3,^D19                 ;COUNTER.
  4111	406151'	260740	411343'	        GOSUB   PLACE                   ;PUT IT IN THE BUFFER.
  4112	406152'	200340	414430'	        MOVE    P2,[POINT 6,OFILE+NAME] ;POINTER TO LABEL ID.
  4113	406153'	201400	000005	        MOVEI   P3,^D5                  ;FIVE CHARACTERS IN NAME.
  4114	406154'	260740	411343'	        GOSUB   PLACE                   ;INTO BUFFER.
  4115	406155'	402000	000014	        SETZM   CH                      ;AN UNUSED SPACE.
  4116	406156'	136600	000006	        IDPB    CH,P1                   ;PLACE IT IN THE BUFFER.
  4117	406157'	200340	414430'	        MOVE    P2,[POINT 6,OFILE+NAME] ;POINTER TO SERIAL SAME AS NAME.
  4118	406160'	201400	000005	        MOVEI   P3,^D5                  ;COUNT TO PUT.
  4119	406161'	260740	411343'	        GOSUB   PLACE                   ;INTO BUFFER.
  4120	406162'	201400	000002	        MOVEI   P3,^D2                  ;SOME SPACES.
  4121	406163'	260740	411347'	        GOSUB   SPACE                   ;ADD TO BUFFER.
  4122	406164'	200340	414431'	        MOVE    P2,[POINT 6,OFILE+VOL]  ;POINTER TO VOLUME NUMBER.
  4123	406165'	201400	000004	        MOVEI   P3,^D4                  ;COUNT TO PUT.
  4124	406166'	260740	411343'	        GOSUB   PLACE                   ;INTO BUFFER.
  4125	406167'	402000	000014	        SETZM   CH                      ;ANOTHER OUT OF PLACE SPACE.
  4126	406170'	136600	000006	        IDPB    CH,P1                   ;PLACE IN THE BUFFER.
  4127	406171'	047140	000014	        MME     T1,.DATE                ;GET THE DATE.
  4128	406172'	260740	411761'	        GOSUB   BCLDAT                  ;TO FORMAT WE WANT.
  4129	406173'	200340	414466'	        MOVE    P2,[POINT 6,[SIXBIT "   000"]];UNUSED THINGS.
  4130	406174'	201400	000006	        MOVEI   P3,^D6                  ;COUNT TO PLACE.
  4131	406175'	260740	411343'	        GOSUB   PLACE                   ;ADD TO THE BUFFER.
  4132	406176'	200340	414143'	        MOVE    P2,[POINT 6,PASS]       ;POINTER TO PASSWORD.
  4133	406177'	201400	000014	        MOVEI   P3,^D12                 ;CHARACTERS IN PASSWORD.
  4134	406200'	260740	411343'	        GOSUB   PLACE                   ;PUT IT IN THE BUFFER.
  4135	406201'	332000	000640'	        SKIPE   PASS                    ;IS THERE A PASSWORD.
  4136	406202'	254000	406205'	        GOTO    LB.PRT                  ;YES PROTECT THE TAPE.
  4137	406203'	336000	000641'	        SKIPN   PASS+1                  ;TRY OTHER HALF.
  4138	406204'	334340	414470'	        SKIPA   P2,[POINT 6,[SIXBIT "!!!000"]];NO PROTECTION.
  4139	406205'	200340	414472'	LB.PRT: MOVE    P2,[POINT 6,[SIXBIT "!!!^00"]];PROTECTION WORD.
  4140	406206'	201400	000006	        MOVEI   P3,^D6                  ;COUNT TO PLACE.
  4141	406207'	260740	411343'	        GOSUB   PLACE                   ;INTO BUFFER.
  4142	406210'	201600	000020	        MOVEI   CH,'0'                  ;FILL THE REST OF THE LABEL
  4143	406211'	201400	000016	        MOVEI   P3,^D14                 ;WITH ZEROS.
  4144	406212'	260740	411350'	        GOSUB   ANYCHR                  ;INTO BUFFER.
  4145	406213'	201200	413455'	        MOVEI   T2,XBDMOD               ;MODE TO WRITE IT IN.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 68
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  4146				;HERE TO WRITE THE LABEL TO THE TAPE.
  4147
  4148	406214'	260740	407677'	LB.CLO: GOSUB   WRILAB                  ;WRITE THE LABEL TO TAPE.
  4149	406215'	070040	000000	        CLOSE   OF,ZERO                 ;WRITE AN EOF MARK.
  4150	406216'	062040	000003	        GETSTS  OF,T1                   ;GET THE DEVICE STATUS.
  4151	406217'	622140	740000	        TEZ     T1,E.ERR                ;SKIP IF NO ERROR.
  4152	406220'	051140	414473'	        PRINT   (% Error while writing label.")
  4153	406221'	402000	000436'
  4154	406222'	060043	000000	        SETSTS  OF,ZERO(T1)             ;RESET THE STATUS.
  4155	406223'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  4156	406224'	200340	414502'	LB.GED: MOVE    P2,[POINT 6,[SIXBIT " EOF  "]];ASSUME END OF FILE.
  4157	406225'	602000	000040	        IF.OFF  S,FIN                   ;SKIP IF WE ARE RIGHT.
  4158	406226'	200340	414503'	        MOVE    P2,[POINT 6,[SIXBIT " EOR  "]];SET IT AS END OF REEL.
  4159	406227'	201400	000006	        MOVEI   P3,^D6                  ;COUNT TO PLACE.
  4160	406230'	260740	411343'	        GOSUB   PLACE                   ;INTO BUFFER.
  4161	406231'	200140	000355'	        MOVE    T1,OBCNT                ;GET THE BLOCKS WRITTEN.
  4162	406232'	260740	412127'	        GOSUB   MAKTWO                  ;CONVERT TO TWO WORDS.
  4163	406233'	200340	414432'	        MOVE    P2,[POINT 6,T2]         ;POINT TO WHAT WE WANT.
  4164	406234'	201400	000006	        MOVEI   P3,^D6                  ;SIX TO PLACE.
  4165	406235'	260740	411343'	        GOSUB   PLACE                   ;PLACE THEM.
  4166	406236'	201600	000020	        MOVEI   CH,'0'                  ;FILL THE REST OF THE LABEL
  4167	406237'	201400	000104	        MOVEI   P3,^D68                 ;WITH ZEROS.
  4168	406240'	260740	411350'	        GOSUB   ANYCHR                  ;FINISH THE LABEL.
  4169	406241'	254000	406213'	        GOTO    LB.CLO-1                ;WRITE THE LABEL.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 69
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  4170				;HERE TO READ AND WRITE OUTPUT LABELS
  4171				;IN BCL FORMAT.
  4172
  4173	406242'	602000	000020	LB.OBL: IF.ON   S,TERM,LB.BGN           ;JUMP IF TRAILER.
  4174	406244'	062040	000003	        GETSTS  OF,T1                   ;GET THE DEVICE STATUS.
  4175	406245'	606140	004000	        IF.OFF  T1,E.BOT,LB.BGN         ;JUMP IF NOT AT BOT.
  4176	406247'	332000	000017'	        SKIPE   OFILE+PERGE             ;SERIAL NUMBER SPECIFIED.
  4177	406250'	254000	406347'	        GOTO    LB.PBL                  ;YES PERGE THE LABEL.
  4178	406251'	200200	000015	        MOVE    T2,OM                   ;GET THE MODE OF THE OUTPUT.
  4179	406252'	260740	407631'	        GOSUB   REDOUT                  ;READ THE OUTPUT LABEL.
  4180	406253'	254000	410326'	        GOTO    BADTM                   ;EOF MARK FOUND.
  4181	406254'	072040	000007	        DRIVE   OF,.BSR                 ;BACK UP TO START OF LABEL.
  4182	406255'	072040	000000	        DRIVE   OF,.WAT                 ;WAIT FOR COMPLETION.
  4183	406256'	200140	000112'	        MOVE    T1,OUTBUF               ;PICK UP HEADER WORD.
  4184	406257'	312140	414353'	        CAME    T1,[SIXBIT " LABEL"]    ;MAKE SURE IT IS A LABEL.
  4185	406260'	254000	410264'	        GOTO    NOTLAB                  ;YOU LOOSE.
  4186	406261'	200340	414504'	        MOVE    P2,[POINT 6,OUTBUF+10,29];POINT TO REEL NUMBER.
  4187	406262'	200300	414413'	        MOVE    P1,[POINT 6,RELNUM]     ;POINTER TO STORAGE.
  4188	406263'	201400	000005	        MOVEI   P3,^D5                  ;CHARACTERS TO COPY.
  4189	406264'	260740	411343'	        GOSUB   PLACE                   ;COPY THEM.
  4190	406265'	200300	414414'	LB.BGN: MOVE    P1,[POINT 6,OUTBUF]     ;POINTER TO STORAGE.
  4191	406266'	200340	414510'	        MOVE    P2,[POINT 6,[SIXBIT " LABEL  0000000 0"]];IDENTIFIER.
  4192	406267'	201400	000021	        MOVEI   P3,^D17                 ;COUNT TO PLACE.
  4193	406270'	260740	411343'	        GOSUB   PLACE                   ;PLACE IT IN PLACE.
  4194	406271'	200340	414430'	        MOVE    P2,[POINT 6,OFILE+NAME] ;POINTER TO LABEL-ID.
  4195	406272'	201400	000006	        MOVEI   P3,^D6                  ;SIX CHARACTERS IN ID.
  4196	406273'	260740	411343'	        GOSUB   PLACE                   ;INTO BUFFER.
  4197	406274'	201340	000000	        MOVEI   P2,' '                  ;PUT IN AN UNUSED SPACE.
  4198	406275'	136340	000006	        IDPB    P2,P1                   ;PUT IT INTO LABEL.
  4199	406276'	200340	414511'	        MOVE    P2,[POINT 6,OFILE+VOL,5];POINTER TO VOLUME NUMBER.
  4200	406277'	201400	000003	        MOVEI   P3,^D3                  ;VOLUME GOES FROM 1-999.
  4201	406300'	260740	411343'	        GOSUB   PLACE                   ;PUT IT AWAY.
  4202	406301'	047140	000014	        MME     T1,.DATE                ;GET TODAY'S DATE.
  4203	406302'	260740	411761'	        GOSUB   BCLDAT                  ;CONVERT TO FORMAT WE WANT.
  4204	406303'	201600	000020	        MOVEI   CH,'0'                  ;SOME UNUSED POSITIONS.
  4205	406304'	201400	000002	        MOVEI   P3,^D2                  ;COUNTER.
  4206	406305'	260740	411350'	        GOSUB   ANYCHR                  ;PUT THEM AWAY.
  4207	406306'	047140	000014	        MME     T1,.DATE                ;GET TODAY'S DATE AGAIN.
  4208	406307'	271140	001730	        ADDI    T1,^D984                ;ADD IN SAVE FACTOR.
  4209	406310'	260740	411761'	        GOSUB   BCLDAT                  ;CONVERT DATE.
  4210	406311'	201340	000020	        MOVEI   P2,'0'                  ;LOAD A ZERO FOR END OF FILE.
  4211	406312'	602000	000040	        IF.OFF  S,FIN                   ;IS THIS END OF FILE.
  4212	406313'	201340	000021	        MOVEI   P2,'1'                  ;NO JUST END OF REEL.
  4213	406314'	136340	000006	        IDPB    P2,P1                   ;SAVE IT IN BUFFER.
  4214	406315'	606000	000020	        IF.OFF  S,TERM,LB.HDR           ;JUMP IF THIS IS REALLY HEADER.
  4215	406317'	200140	000355'	        MOVE    T1,OBCNT                ;PICK UP BLOCKS WRITTEN.
  4216	406320'	260740	412127'	        GOSUB   MAKTWO                  ;CONVERT IT TO TWO WORDS.
  4217	406321'	200340	414451'	        MOVE    P2,[POINT 6,T2,5]       ;POINT TO WHAT WE WANT.
  4218	406322'	201400	000005	        MOVEI   P3,^D5                  ;FIVE CHARACTERS TO COPY.
  4219	406323'	260740	411343'	        GOSUB   PLACE                   ;COPY TO OUTPUT BUFFER.
  4220	406324'	200140	000354'	        MOVE    T1,ORCNT                ;GET RECORD COUNT.
  4221	406325'	260740	412127'	        GOSUB   MAKTWO                  ;MAKE TWO WORDS.
  4222	406326'	200340	414512'	        MOVE    P2,[POINT 6,T1,29]      ;POINT TO WHAT WE WANT.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 69-2
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  4223	406327'	201400	000007	        MOVEI   P3,^D7                  ;CHARACTERS TO PLACE.
  4224	406330'	260740	411343'	        GOSUB   PLACE                   ;PLACE THEM INTO PLACE.
  4225	406331'	201600	000020	        MOVEI   CH,'0'                  ;UNUSED POSITION.
  4226	406332'	136600	000006	        IDPB    CH,P1                   ;PUT IT AWAY.
  4227	406333'	200340	414413'	LB.FIN: MOVE    P2,[POINT 6,RELNUM]     ;POINTER TO REEL NUMBER.
  4228	406334'	201400	000005	        MOVEI   P3,^D5                  ;FIVE CHARACTERS TO PUT.
  4229	406335'	260740	411343'	        GOSUB   PLACE                   ;PLACE THEM.
  4230	406336'	201400	000032	        MOVEI   P3,^D26                 ;POSITIONS LEFT.
  4231	406337'	201600	000020	        MOVEI   CH,'0'                  ;FINISH BUFFER WITH ZEROS.
  4232	406340'	260740	411350'	        GOSUB   ANYCHR                  ;FILL THE BUFFER.
  4233	406341'	200200	000015	        MOVE    T2,OM                   ;GET THE MODE OF THE OUTPUT.
  4234	406342'	254000	406214'	        GOTO    LB.CLO                  ;WRITE THE LABEL.
  4235	406343'	201400	000015	LB.HDR: MOVEI   P3,^D13                 ;IF HEADER WE DON'T WRITE
  4236	406344'	201600	000020	        MOVEI   CH,'0'                  ;BLOCK AND RECORD COUNTS.
  4237	406345'	260740	411350'	        GOSUB   ANYCHR                  ;FILL THESE WITH ZEROS.
  4238	406346'	254000	406333'	        GOTO    LB.FIN                  ;DO THE REST.
  4239
  4240				;HERE IF THE LABELS ARE TO BE WRITTEN IN BCL FORMAT
  4241				;BUT NOT CHECKED FIRST. IN THIS CASE THE REEL NUMBER
  4242				;OF THE TAPE WAS SPECIFIED IN THE REEL SWITCH.
  4243
  4244	406347'	662000	004000	LB.PBL: TEO     S,PRG                   ;HAVE WE ALREADY DONE THIS.
  4245	406350'	354140	000017'	        AOSA    T1,OFILE+PERGE          ;YES SO BUMP REEL NUMBER FOR LABEL.
  4246	406351'	200140	000017'	        MOVE    T1,OFILE+PERGE          ;GET THE NEW NUMBER.
  4247	406352'	260740	412127'	        GOSUB   MAKTWO                  ;CONVERT IT TO SIXBIT.
  4248	406353'	200300	414413'	        MOVE    P1,[POINT 6,RELNUM]     ;POINTER TO STORAGE.
  4249	406354'	200340	414451'	        MOVE    P2,[POINT 6,T2,5]       ;POINTER TO WHAT WE WANT.
  4250	406355'	201400	000005	        MOVEI   P3,^D5                  ;COUNT TO PLACE.
  4251	406356'	260740	411343'	        GOSUB   PLACE                   ;PLACE THEM.
  4252	406357'	254000	406265'	        GOTO    LB.BGN                  ;OTHERWISE LABELS ARE STANDARD.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 70
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  4253				;HERE TO WRITE OUT DEC-COBOL HEADER AND TRAILER LABELS.
  4254
  4255	406360'	200340	414423'	LB.OCL: MOVE    P2,[POINT 6,[SIXBIT "HDR1"]];ASSUME HEADER LABEL.
  4256	406361'	602000	000020	        IF.OFF  S,TERM                  ;IS THIS A TERMINAL LABEL.
  4257	406362'	200340	414425'	        MOVE    P2,[POINT 6,[SIXBIT "EOF1"]];YES CHANGE MESSAGE.
  4258	406363'	602000	000040	        IF.OFF  S,FIN                   ;IS THIS REALLY JUST END OF REEL.
  4259	406364'	200340	414427'	        MOVE    P2,[POINT 6,[SIXBIT "EOV1"]];JUST END OF REEL.
  4260	406365'	200300	414414'	        MOVE    P1,[POINT 6,OUTBUF]     ;SET POINTER TO LABEL BUFFER.
  4261	406366'	201400	000004	        MOVEI   P3,^D4                  ;COUNT TO PLACE.
  4262	406367'	260740	411343'	        GOSUB   PLACE                   ;PUT IT INTO BUFFER.
  4263	406370'	200340	414430'	        MOVE    P2,[POINT 6,OFILE+NAME] ;POINTER TO NAME.
  4264	406371'	201400	000011	        MOVEI   P3,^D9                  ;NINE CHARACTERS IN NAME.
  4265	406372'	260740	411343'	        GOSUB   PLACE                   ;INTO BUFFER.
  4266	406373'	201400	000016	        MOVEI   P3,^D14                 ;FOURTEEN SPACES.
  4267	406374'	260740	411347'	        GOSUB   SPACE                   ;INTO BUFFER.
  4268	406375'	200340	414431'	        MOVE    P2,[POINT 6,OFILE+VOL]  ;GET VOLUME NUMBER.
  4269	406376'	201400	000004	        MOVEI   P3,^D4                  ;GET THE COUNT OF CHARACTERS.
  4270	406377'	260740	411343'	        GOSUB   PLACE                   ;PUT IT INTO BUFFER.
  4271	406400'	201400	000012	        MOVEI   P3,^D10                 ;SET COUNT.
  4272	406401'	260740	411347'	        GOSUB   SPACE                   ;INTO BUFFER.
  4273	406402'	047140	000014	        MME     T1,.DATE                ;GET THE DATE.
  4274	406403'	260740	411327'	        GOSUB   COBDAT                  ;FIX IT INTO PLACE.
  4275	406404'	201400	000041	        MOVEI   P3,^D33                 ;NUMBER OF PLACES LEFT.
  4276	406405'	260740	411347'	        GOSUB   SPACE                   ;SPACES TO BUFFER.
  4277	406406'	200200	000015	        MOVE    T2,OM                   ;GET THE MODE OF THE OUTPUT.
  4278	406407'	211340	000120	        MOVNI   P2,^D80                 ;CHARACTERS IN LABEL.
  4279	406410'	260740	407677'	        GOSUB   WRILAB                  ;WRITE THE LABEL TO TAPE.
  4280	406411'	602000	000020	        IF.OFF  S,TERM                  ;IS THIS AN EOF LABEL.
  4281	406412'	070040	000000	        CLOSE   OF,ZERO                 ;YES WRITE EOF MARK.
  4282	406413'	263740	412060'	        RETURN  ZERO                    ;BACK TO SENDER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 71
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  4283				;HERE TO PUT OUT A HEADER FOR THE LINE PRINTER.
  4284
  4285	406414'	602040	000004	HDRLPT: IF.ON   OF,NOHEAD,RET0          ;RETURN IF NOT WANTED.
  4286	406416'	660000	000010	        ON      S,LHEAD                 ;SAY WE ARE DOING HEADERS.
  4287	406417'	047340	000024	        MME     P2,.PPN                 ;GET OUR PPN
  4288	406420'	255000	000000	        NOP                             ;IN CASE OF JACCT.
  4289	406421'	260740	410130'	        GOSUB   GETUNM                  ;AND USER NAME TOO.
  4290	406422'	200140	414513'	        MOVE    T1,[POINT 7,HDRWRD]     ;SET POINTER TO STORAGE
  4291	406423'	200200	414203'	        MOVE    T2,[POINT 6,UNAME]      ;SET POINTER TO USER NAME
  4292	406424'	211300	000014	        MOVNI   P1,^D12                 ;12 CHARS IN USER NAME
  4293	406425'	134240	000004	        ILDB    T3,T2                   ;GET A SIXBIT  CHARACTER
  4294	406426'	201245	000040	        MOVEI   T3," "(T3)              ;CONVERT TO ASCII
  4295	406427'	136240	000003	        IDPB    T3,T1                   ;SAVE IT
  4296	406430'	346300	406425'	        AOJN    P1,.-3                  ;CONTINUE FOR THE COUNT
  4297	406431'	402000	000004	        SETZM   T2                      ;SET END FLAG.
  4298	406432'	136200	000003	        IDPB    T2,T1                   ;SAVE IT.
  4299	406433'	403300	000007	        SETZB   P1,P2                   ;CLEAR COUNTERS.
  4300	406434'	260740	406540'	        GOSUB   MATRIX                  ;BLACKOUT SOMETHINGS.
  4301	406435'	254000	406460'	        GOTO    XNAME                   ;TYPE THE FILE NAME.
  4302
  4303				;HERE TO PUT A TRAILER HEADER ON THE LINE PRINTER.
  4304
  4305	406436'	602040	000004	EOFLPT: IF.ON   OF,NOHEAD,RET0          ;RETURN IF NOT WANTED.
  4306	406440'	660000	000010	        ON      S,LHEAD                 ;SAY WE ARE DOING HEADINGS.
  4307	406441'	201600	000014	        MOVEI   CH,14                   ;GET A FORM FEED FIRST.
  4308	406442'	626000	000001	        TNZ     S,FF                    ;SKIP IF LAST WAS A FORM.
  4309	406443'	260740	410612'	        GOSUB   UME4                    ;ONTO THE DEVICE.
  4310	406444'	260740	406540'	        GOSUB   MATRIX                  ;START IT GOING.
  4311	406445'	047140	000023	EOF1:   MME     T1,.TIME                ;GET THE TIME OF DAY.
  4312	406446'	405140	000077	        ANDI    T1,77                   ;MASK OUT SOME BITS.
  4313	406447'	301140	000025	        CAIL    T1,ENDCNT               ;SEE IF OUT OF THE TABLE.
  4314	406450'	254000	406445'	        GOTO    EOF1                    ;TRY AGAIN.
  4315	406451'	316140	001031'	        CAMN    T1,LSTVAL               ;IS IT THE SAME AS THE LAST.
  4316	406452'	254000	406445'	        GOTO    EOF1                    ;TRY AGAIN.
  4317	406453'	202140	001031'	        MOVEM   T1,LSTVAL               ;SAVE THE LAST ONE.
  4318	406454'	200143	413134'	        MOVE    T1,ENDTAB(T1)           ;GET THE LOCATION OF THE MESSAGE.
  4319	406455'	200203	000001	        MOVE    T2,ONE(T1)              ;GET THE SECOND HALF.
  4320	406456'	200143	000000	        MOVE    T1,ZERO(T1)             ;GET THE FIRST HALF.
  4321	406457'	260740	406516'	        GOSUB   CODE                    ;PUT IT INTO ASCII.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 72
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  4322				;HERE TO PLACE THE FILE NAME AND THE ASSORTED OTHER
  4323				;THINGS ON THE PRINTER.
  4324
  4325	406460'	260740	406570'	XNAME:  GOSUB   PICTURE                 ;PUT THE PICTURE OUT.
  4326	406461'	200140	000004'	        MOVE    T1,OFILE+NAME           ;GET THE NAME.
  4327	406462'	510200	000005'	        HLLZ    T2,OFILE+EXT            ;GET THE EXTENSION.
  4328	406463'	260740	406513'	        GOSUB   DECODE                  ;SET IT UP RIGHT.
  4329	406464'	260740	406570'	        GOSUB   PICTURE                 ;ONTO THE LINE PRINTER.
  4330	406465'	260740	406540'	        GOSUB   MATRIX                  ;BLACKOUT SOMETINGS.
  4331	406466'	001040	414243'	        UME     .ASC,[BYTE (7)15,12,0]  ;SKIP A LINE.
  4332	406467'	047200	000030	        MME     T2,.PJOB                ;GET MY JOB NUMBER.
  4333	406470'	514200	000004	        HRLZ    T2,T2                   ;INTO THE RIGHT HALF.
  4334	406471'	541200	000031	        HRRI    T2,31                   ;TABLE ENTRY FOR NAME.
  4335	406472'	047200	000041	        MME     T2,.TAB                 ;GET FIRST HALF OF NAME.
  4336	406473'	402000	000004	        SETZM   T2                      ;CLEAR IF CAN'T GET IT.
  4337	406474'	001100	000004	        UME     .SIX,T2                 ;INTO BUFFER.
  4338	406475'	047200	000030	        MME     T2,.PJOB                ;GET MY JOB NUMBER BACK.
  4339	406476'	514200	000004	        HRLZ    T2,T2                   ;INTO RIGHT HALF.
  4340	406477'	541200	000032	        HRRI    T2,32                   ;SECOND HALF OF NAME.
  4341	406500'	047200	000041	        MME     T2,.TAB                 ;GET THE ENTRY.
  4342	406501'	402000	000004	        SETZM   T2                      ;CLEAR IF CAN'T GET IT.
  4343	406502'	001100	000004	        UME     .SIX,T2                 ;INTO BUFFER.
  4344	406503'	001040	414307'	        UME     .ASC,[ASCIZ "   "]      ;TO SEPARATE THINGS.
  4345	406504'	260740	410622'	        GOSUB   PUTDAT                  ;PUT THE DATE.
  4346	406505'	001040	414307'	        UME     .ASC,[ASCIZ "   "]      ;SEPARATE THINGS.
  4347	406506'	260740	410636'	        GOSUB   PUTTIM                  ;PUT A TIME STAMP ON IT.
  4348	406507'	201600	000014	        MOVEI   CH,14                   ;A FORM FEED.
  4349	406510'	260740	407334'	        GOSUB   PUT                     ;INTO BUFFER.
  4350	406511'	620000	000010	        OFF     S,LHEAD                 ;HEADINGS ARE DONE.
  4351	406512'	254000	407344'	        GOTO    EMPTY                   ;WRITE THE BUFFERS.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 73
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  4352				;HERE TO CONVERT TWO SIXBIT WORDS TO ASCII.
  4353
  4354	406513'	322200	406516'	DECODE: JUMPE   T2,CODE                 ;DON'T ADD PERIOD IF NO EXTENSION.
  4355	406514'	242200	777772	        LSH     T2,-6                   ;MAKE ROOM FOR PERIOD.
  4356	406515'	434200	414514'	        IOR     T2,[SIXBIT "."]         ;ADD A PERIOD.
  4357	406516'	200240	414355'	CODE:   MOVE    T3,[POINT 6,T1]         ;GET A POINTER TO DATA.
  4358	406517'	200400	414513'	        MOVE    P3,[POINT 7,HDRWRD]     ;POINTER TO STORAGE.
  4359	406520'	211300	000015	        MOVNI   P1,15                   ;SET THE MAX TO DO.
  4360	406521'	211340	000014	        MOVNI   P2,^D12                 ;NUMBER OF CHARACTERS TO DO.
  4361	406522'	134600	000005	CODE1:  ILDB    CH,T3                   ;GET A CHARACTER.
  4362	406523'	322600	406527'	        JUMPE   CH,CODE2                ;DON'T DO NULLS.
  4363	406524'	201614	000040	        MOVEI   CH," "(CH)              ;CONVERT TO ASCII.
  4364	406525'	136600	000010	        IDPB    CH,P3                   ;SAVE IT.
  4365	406526'	350000	000006	        AOS     P1                      ;COUNT THE CHARACTER.
  4366	406527'	346340	406522'	CODE2:  AOJN    P2,CODE1                ;JUMP IF STILL HAVE MORE.
  4367	406530'	402000	000014	        SETZM   CH                      ;FOR END FLAG.
  4368	406531'	136600	000010	        IDPB    CH,P3                   ;SAVE IT.
  4369	406532'	210300	000006	        MOVN    P1,P1                   ;MAKE P1 POSITIVE.
  4370	406533'	221300	000006	        IMULI   P1,6                    ;SIX SPACES PER CHARACTER.
  4371	406534'	402000	000007	        SETZM   P2                      ;CLEAR P1+1.
  4372	406535'	246300	777777	        LSHC    P1,-1                   ;DIVIDE P1 BY TWO.
  4373	406536'	241340	000001	        ROT     P2,1                    ;SO IT CAN BE USED AS AN INDEX.
  4374	406537'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 74
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  4375				;HERE TO SEND SOME "X"'S TO THE LINE PRINTER.
  4376
  4377	406540'	260740	406544'	MATRIX: GOSUB   MAT0                    ;CALL THE X PRINTER TWICE.
  4378	406541'	260740	406544'	        GOSUB   MAT0                    ;ONE MORE TIME.
  4379	406542'	001040	414243'	        UME     .ASC,[BYTE (7)15,12,0]  ;SKIP A LINE.
  4380	406543'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  4381	406544'	211440	000203	MAT0:   MOVNI   P4,^D131                ;NUMBER OF POSITIONS.
  4382	406545'	201600	000130	        MOVEI   CH,"X"                  ;CHARACTER TO PRINT.
  4383	406546'	260740	410612'	        GOSUB   UME4                    ;PLACE IT.
  4384	406547'	346440	406545'	        AOJN    P4,.-2                  ;CONTINUE ON.
  4385	406550'	001040	414243'	        UME     .ASC,[BYTE (7)15,12,0]  ;SKIP A LINE.
  4386	406551'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  4387
  4388				;HERE TO PRINT A CHARACTER POSTION ALL FILLED IN.
  4389
  4390	406552'	260740	406554'	BLACKO: GOSUB   BLACK                   ;CALL THE STAR PRINTER
  4391	406553'	260740	406554'	        GOSUB   BLACK                   ;THREE TINES.
  4392	406554'	211440	000005	BLACK:  MOVNI   P4,5                    ;GET A COUNTER.
  4393	406555'	201600	000052	        MOVEI   CH,"*"                  ;CHAARACTER TO PRINT.
  4394	406556'	260740	410612'	        GOSUB   UME4                    ;ON THE DEVICE.
  4395	406557'	346440	406555'	        AOJN    P4,.-2                  ;LOOP ON THAT.
  4396	406560'	201600	000040	        MOVEI   CH," "                  ;A SPACE TO SEPARATE THINGS.
  4397	406561'	254000	410612'	        GOTO    UME4                    ;ONTO THE DEVICE.
  4398
  4399				;HERE TO PRINT SOME BLANKS TO EVEN THINGS UP.
  4400
  4401	406562'	322300	412060'	XSPACE: JUMPE   P1,RET0                 ;JUMP IF DON'T NEED ANY.
  4402	406563'	210440	000006	        MOVN    P4,P1                   ;GET THE NEGATIVE COUNT.
  4403	406564'	201600	000040	        MOVEI   CH," "                  ;GET A SPACE.
  4404	406565'	260740	407334'	        GOSUB   PUT                     ;INTO THE BUFFER.
  4405	406566'	346440	406564'	        AOJN    P4,.-2                  ;FOR THE COUNT.
  4406	406567'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 75
MAGCON.MAC	 6-JUL-77 09:25		*** THINK ABOUT LABELS ***

  4407				;HERE TO PRINT THE BLOCK LETTERS ON THE LINE PRINTER.
  4408
  4409	406570'	211400	000043	PICTUR: MOVNI   P3,43                   ;SET UP BITS IN MAP.
  4410	406571'	200200	414513'	        MOVE    T2,[POINT 7,HDRWRD]     ;POINTER TO THINGS TO PLACE.
  4411	406572'	260740	406552'	        GOSUB   BLACKOUT                ;BEGIN IT GOING.
  4412	406573'	001040	406624'	        UME     .ASC,BLANK              ;SOME BLANKS.
  4413	406574'	260740	406562'	        GOSUB   XSPACE                  ;EVEN THINGS UP.
  4414	406575'	134240	000004	        ILDB    T3,T2                   ;GET A BYTE.
  4415	406576'	322240	406601'	        JUMPE   T3,.+3                  ;JUMP IF AT END.
  4416	406577'	260740	406611'	        GOSUB   XPUT                    ;INTO BUFFER.
  4417	406600'	254000	406575'	        GOTO    .-3                     ;CONTINUE LOOP.
  4418	406601'	260740	406562'	        GOSUB   XSPACE                  ;SOME SPACES.
  4419	406602'	001047	406624'	        UME     .ASC,BLANK(P2)          ;SOME ODD SPACES.
  4420	406603'	260740	406552'	        GOSUB   BLACKOUT                ;WIPE THINGS OUT.
  4421	406604'	001040	414243'	        UME     .ASC,[BYTE (7)15,12,0]  ;NEXT LINE.
  4422	406605'	271400	000005	        ADDI    P3,5                    ;SET NEXT BIT PATTERN.
  4423	406606'	321400	406571'	        JUMPL   P3,PICTURE+1            ;TEST AND JUMP IF HAVE MORE.
  4424	406607'	001040	414243'	        UME     .ASC,[BYTE (7)15,12,0]  ;NEXT LINE.
  4425	406610'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  4426
  4427				;HERE TO ACTUALLY PUT THE STUFF OUT.
  4428
  4429	406611'	200245	413121'	XPUT:   MOVE    T3,CHRTAB-40(T3)        ;GET A BIT PATTERN.
  4430	406612'	241250	000043	        ROT     T3,43(P3)               ;DIAL A FIVE BIT GROUP.
  4431	406613'	211440	000005	        MOVNI   P4,5                    ;SET UP COUNTER.
  4432	406614'	201600	000040	XPUT1:  MOVEI   CH," "                  ;LOAD A SPACE.
  4433	406615'	335000	000005	        SKIPGE  T3                      ;SKIP IF O.K.
  4434	406616'	201600	000100	        MOVEI   CH,"@"                  ;ELSE SET IT FOR ON BIT.
  4435	406617'	260740	410612'	        GOSUB   UME4                    ;TO THE DEVICE.
  4436	406620'	241240	000001	        ROT     T3,1                    ;DIAL NEXT BIT.
  4437	406621'	341440	406614'	        AOJL    P4,XPUT1                ;CONTINUE ON.
  4438	406622'	201600	000040	        MOVEI   CH," "                  ;A TRAILING SPACE.
  4439	406623'	254000	407334'	        GOTO    PUT                     ;TO THE LINE PRINTER.
  4440
  4441	406624'	201004	020100	BLANK:  ASCIZ   "         "
	406625'	201004	020000
  4442
  4443	001024'			        USE     DATA
  4444
  4445	001024'			BSS     HDRWRD,5
  4446	001031'			BSS     LSTVAL,ONE
  4447
  4448	406626'			        USE     CODE
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 76
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4449				SUBTTL                          *** BASIC I/O ROUTINES ***
  4450
  4451				;HERE TO BUILD BUFFERS FOR MAG-TAPE.
  4452
  4453	406626'	550252	000017	MAKE:   HRRZ    T3,CHRMOD(SIDE)         ;GET THE MODE OF THE INPUT.
  4454	406627'	332012	000026	        SKIPE   FSTTAP(SIDE)
  4455	406630'	254000	406633'	        GOTO    .+3                     ;WE HAVE TO GO THROUGH THIS
  4456	406631'	336012	000011	        SKIPN   RECSIZ(SIDE)            ;GET THE RECORD SIZE.
  4457	406632'	263740	412060'	        RETURN  ZERO                    ;NONE SPECIFIED USE DEFAULT.
  4458	406633'	200212	000011	        MOVE    T2,RECSIZ(SIDE)         ;GET THE RECORD SIZE
  4459	406634'	307240	413325'	        CAIG    T3,GEAMOD               ;SKIP IF NOT ASCII.
  4460	406635'	271200	000002	        ADDI    T2,TWO                  ;ACCOUNT FOR CRLF.
  4461	406636'	200305	000011	        MOVE    P1,STS(T3)              ;GET THE STATUS WORD.
  4462	406637'	271206	000000	        ADDI    T2,ZERO(P1)             ;ADD WHAT IS NEEDED FOR CTRL WORD.
  4463	406640'	332012	000026	        SKIPE FSTTAP(SIDE)
  4464				        GOTO [MOVEI P2,4
  4465	406641'	254000	414515'	                GOTO MAKE2A]
  4466	406642'	550345	000006	        HRRZ    P2,MSIZ(T3)             ;GET THE BYTES PER WORD.
  4467	406643'	302240	413366'	        CAIE    T3,SIXMOD               ;SKIP IF SIXBIT.
  4468	406644'	254000	406650'	        GOTO    MAKE1                   ;ELSE FORGET NEXT FEW THINGS.
  4469	406645'	271207	777777	MAKE2A: ADDI    T2,-1(P2)               ;FORCE TO A WORD BOUNDARY.
  4470	406646'	231207	000000	        IDIVI   T2,ZERO(P2)             ;PRODUCE INTEGER PART.
  4471	406647'	221207	000000	        IMULI   T2,ZERO(P2)             ;PRODUCE A WORD MULTIPLE.
  4472	406650'	332012	000010	MAKE1:  SKIPE   BLKFCT(SIDE)            ;BAG THE MULTIPLY IF ZERO.
  4473	406651'	220212	000010	        IMUL    T2,BLKFCT(SIDE)         ;MULTIPLY BY BLOCKING FACTOR.
  4474	406652'	603300	000004	        IF.OFF  P1,EXW                  ;DO WE NEED EXTRA STUFF.
  4475	406653'	271206	000000	        ADDI    T2,ZERO(P1)             ;YES SO ADD IT IN.
  4476	406654'	271207	777777	        ADDI    T2,-1(P2)               ;ADD BYTE SIZE MINUS ONE.
  4477	406655'	230200	000007	        IDIV    T2,P2                   ;BUFFFER LENGTH IN WORDS.
  4478	406656'	332012	000026	        SKIPE FSTTAP(SIDE)
  4479				        GOTO [SAVE T2
  4480				                IDIVI T2,3
  4481				                SKIPE T3
  4482				                ADDI T2,1
  4483				                MOVE T3,T2
  4484				                UNSAVE T2
  4485				                ADD T2,T3
  4486	406657'	254000	414517'	                GOTO MAKE1B]
  4487	406660'	271200	000001	MAKE1B: ADDI    T2,ONE                  ;A LITTLE OVERHEAD.
  4488	406661'	305200	000101	        CAIGE   T2,^D65                 ;MUST HAVE ROOM FOR HEADERS.
  4489	406662'	201200	000101	        MOVEI   T2,^D65                 ;MAKE ROOM FOR THEM.
  4490	406663'	550143	000000	        HRRZ    T1,ZERO(T1)             ;GET ADDRESS OF FIRST BUFFER.
  4491	406664'	336412	000021	        SKIPN   P3,BUFNUM(SIDE)         ;GET NUMBER OF BUFFERS.
  4492	406665'	201400	000002	        MOVEI   P3,TWO                  ;DEFAULT IS TWO.
  4493	406666'	201344	000002	        MOVEI   P2,TWO(T2)              ;GET TOTAL SIZE OF BUFFERS.
  4494	406667'	221350	000000	        IMULI   P2,ZERO(P3)             ;COMPUTE TOTAL WORDS NEEDED.
  4495	406670'	271343	777777	        ADDI    P2,-1(T1)               ;GET THE LAST LOCATION NEEDED.
  4496	406671'	542340	403575*	        HRRM    P2,JOBFF                ;SET IT AS FIRST FREE.
  4497	406672'	317340	000000*	        CAMG    P2,JOBREL               ;DO WE NEED MORE CORE.
  4498	406673'	254000	406700'	        GOTO    MAKE1A                  ;NO IT IS ALRIGHT.
  4499	406674'	301340	372000	        CAIL P2,^D128000
  4500	406675'	254000	410270'	        GOTO NOCORE
  4501	406676'	047340	000011	        MME     P2,.CORE                ;GET SOME CORE.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 76-2
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4502	406677'	254000	410270'	        GOTO    NOCORE                  ;CAN'T GET IT.
  4503	406700'	515303	777777	MAKE1A: HRLZI   P1,-1(T1)               ;GET ADDRESS OF THE TOP OF BUFFERS.
  4504	406701'	541303	000000	        HRRI    P1,ZERO(T1)             ;GET THE ADDRESS PLUS ONE.
  4505	406702'	550340	406671*	        HRRZ    P2,JOBFF                ;GET THE LAST LOCATION.
  4506	406703'	402006	777777	        SETZM   -1(P1)                  ;CLEAR FIRST WORD.
  4507	406704'	251307	777777	        BLT     P1,-1(P2)               ;CLEAR OUT JUNK.
  4508	406705'	334300	000003	        SKIPA   P1,T1                   ;GET POINTER TO FIRST INTO P1.
  4509	406706'	551307	000000	MAKE2:  HRRZI   P1,ZERO(P2)             ;GET POINTER TO NEXT BUFFER.
  4510	406707'	201346	000000	        MOVEI   P2,ZERO(P1)             ;GET ADDRESS OF THIS BUFFER.
  4511	406710'	505344	000000	        HRLI    P2,ZERO(T2)             ;SET THE SIZE OF BUFFER.
  4512	406711'	271344	000002	        ADDI    P2,TWO(T2)              ;POINT P2 TO NEXT BUFFER.
  4513	406712'	202346	000000	        MOVEM   P2,ZERO(P1)             ;PLACE IN THIS ONE'S HEADER.
  4514	406713'	367400	406706'	        SOJG    P3,MAKE2                ;JUMP IF NEED TO DO MORE.
  4515	406714'	542146	000000	        HRRM    T1,ZERO(P1)             ;LINK LAST TO FIRST.
  4516	406715'	263740	412060'	        RETURN  ZERO                    ;AND RETURN.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 77
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4517				;HERE TO SET ASIDE A BUFFER AREA FOR VARIABLE LENGTH
  4518				;OUTPUT BLOCKS.
  4519
  4520	406716'	336140	000403'	GETBUF: SKIPN   T1,RECPTR               ;BEEN HERE BEFORE.
  4521	406717'	254000	406722'	        GOTO    GTBF0                   ;NO CONTINUE ON.
  4522	406720'	202140	000405'	        MOVEM   T1,CURPTR               ;SAVE AS CURRENT POINTER.
  4523	406721'	263740	412060'	        RETURN  ZERO                    ;AND RETURN.
  4524	406722'	550255	000006	GTBF0:  HRRZ    T3,MSIZ(OM)             ;GET THE BYTES/WORD.
  4525	406723'	200200	000012'	        MOVE    T2,OFILE+RECSIZ         ;GET THE OUTPUT RECORD SIZE.
  4526	406724'	200155	000011	        MOVE    T1,STS(OM)              ;GET THE STATUS WORD.
  4527	406725'	271203	000000	        ADDI    T2,ZERO(T1)             ;ADD IN SIZE OF CTRL WORD.
  4528	406726'	332000	000011'	        SKIPE   OFILE+BLKFCT            ;NO SKIP IF BLOCKING FACTOR.
  4529	406727'	220200	000011'	        IMUL    T2,OFILE+BLKFCT         ;MULTIPLY BY BLOCKING FACTOR.
  4530	406730'	603140	000004	        IF.OFF  T1,EXW                  ;DO WE NEED MORE.
  4531	406731'	271203	000000	        ADDI    T2,ZERO(T1)             ;YES SO ADD IT IN.
  4532	406732'	271205	777777	        ADDI    T2,-1(T3)               ;ADD BYTE SIZE MINUS ONE.
  4533	406733'	230200	000005	        IDIV    T2,T3                   ;T2 IS LENGTH NEEDED IN WORDS.
  4534	406734'	200240	406702*	        MOVE    T3,JOBFF                ;FIRST LOCATION FREE.
  4535	406735'	201445	000001	        MOVEI   P4,ONE(T3)              ;START OF THE BUFFER.
  4536	406736'	201251	000001	        MOVEI   T3,ONE(P4)              ;COPY TO ANOTHER AC.
  4537	406737'	270240	000004	        ADD     T3,T2                   ;END OF THE BUFFER.
  4538	406740'	542240	406734*	        HRRM    T3,JOBFF                ;UPDATE TOP OF CORE.
  4539	406741'	435240	001777	        IORI    T3,1777                 ;ROUND UP TO K.
  4540	406742'	317240	406672*	        CAMG    T3,JOBREL               ;DO WE HAVE ENOUGH.
  4541	406743'	254000	406746'	        GOTO    .+3                     ;DON'T ASK FOR MORE.
  4542	406744'	047240	000011	        MME     T3,.CORE                ;GET MORE CORE.
  4543	406745'	254000	410270'	        GOTO    NOCORE                  ;NO MORE CORE YOU LOOSE.
  4544	406746'	514200	000011	        HRLZ    T2,P4                   ;START OF BUFFER.
  4545	406747'	541211	000001	        HRRI    T2,ONE(P4)              ;START OF BUFFER PLUS ONE.
  4546	406750'	402011	000000	        SETZM   ZERO(P4)                ;CLEAR FIRST WORD.
  4547	406751'	200240	406740*	        MOVE    T3,JOBFF                ;GET POINTER TO END OF CORE.
  4548	406752'	251205	777777	        BLT     T2,-1(T3)               ;CLEAR THE BUFFERS.
  4549	406753'	500455	000007	        HLL     P4,MPTR(OM)             ;GET A BYTE POINTER TO BUFFER.
  4550	406754'	202440	000403'	        MOVEM   P4,RECPTR               ;SET AS THE RECORD POINTER.
  4551	406755'	202440	000405'	        MOVEM   P4,CURPTR               ;ALSO AS CURRENT POINTER.
  4552	406756'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 78
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4553				;HERE TO COMPUTE THE NUMBER OF SECTORS TO WRITE
  4554				;IN ORDER TO SATISFY THE BLOCKING FACTOR.
  4555
  4556	406757'	200252	000007	SECTOR: MOVE    T3,MOD(SIDE)            ;GET THE DEVICE BITS.
  4557	406760'	607240	200000	        IF.OFF  T3,DSK,SEC0             ;JUMP IF NOT DSK.
  4558	406762'	550252	000017	        HRRZ    T3,CHRMOD(SIDE)         ;GET THE FILE MODE.
  4559	406763'	200212	000011	        MOVE    T2,RECSIZ(SIDE)         ;GET THE RECORD SIZE.
  4560	406764'	200305	000011	        MOVE    P1,STS(T3)              ;MODE STATUS BITS.
  4561	406765'	271206	000000	        ADDI    T2,ZERO(P1)             ;ADD IN SIZE OF CTRL WORD.
  4562	406766'	336012	000010	        SKIPN   BLKFCT(SIDE)            ;DO WE HAVE A BLOCKING FACTOR.
  4563	406767'	254000	407004'	        GOTO    SEC0                    ;NO WE DON'T.
  4564	406770'	220212	000010	        IMUL    T2,BLKFCT(SIDE)         ;MULTIPLY BY BLOCKING FACTOR.
  4565	406771'	603300	000004	        IF.OFF  P1,EXW                  ;DO WE NEED EXTRA STUFF.
  4566	406772'	271206	000000	        ADDI    T2,ZERO(P1)             ;YES SO ADD IT IN.
  4567	406773'	550245	000006	        HRRZ    T3,MSIZ(T3)             ;GET BYTES/WORD.
  4568	406774'	271205	777777	        ADDI    T2,-1(T3)               ;ADD BYTE SIZE MINUS ONE.
  4569	406775'	230200	000005	        IDIV    T2,T3                   ;WORDS FOR A BLOCK.
  4570	406776'	200152	000007	        MOVE    T1,MOD(SIDE)            ;DEVICE MODE BITS.
  4571	406777'	201240	000200	        MOVEI   T3,200                  ;WORDS PER BLOCK ON DISK.
  4572	407000'	271205	777777	        ADDI    T2,-1(T3)               ;ADD BLOCK SIZE MINUS ONE.
  4573	407001'	231205	000000	        IDIVI   T2,ZERO(T3)             ;T3 HAS SECTORS FOR BLOCK.
  4574	407002'	202212	000020	        MOVEM   T2,SEC(SIDE)            ;SAVE IN DATA BLOCK.
  4575	407003'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  4576	407004'	476012	000020	SEC0:   SETOM   SEC(SIDE)               ;FOR ALL THOSE BAD GUYS.
  4577	407005'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 79
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4578				;HERE TO DO AN "INBUF" OR "OUTBUF" FOR A DEVICE BUT TO
  4579				;MAKE SURE WE HAVE ENOUGH CORE BEFORE WE DO IT.
  4580
  4581	407006'	334500	414527'	MONIBF: SKIPA   SIDE,[IFILE]            ;INDEX TO INPUT STUFF.
  4582	407007'	201500	000001'	MONOBF: MOVEI   SIDE,OFILE              ;INDEX FOR OUTPUT STUFF.
  4583	407010'	336212	000021	        SKIPN   T2,BUFNUM(SIDE)         ;GET NUMBER OF BUFFERS.
  4584	407011'	201200	000002	        MOVEI   T2,TWO                  ;DEFAULT TO MAKE.
  4585	407012'	201252	000000	        MOVEI   T3,STATUS(SIDE)         ;POINTER FOR MME.
  4586	407013'	047240	000101	        MME     T3,.SIZ                 ;GET THE BUFFER SIZE FOR MODE.
  4587	407014'	201240	000203	        MOVEI   T3,203                  ;DEFAULT IF IT FAILS.
  4588	407015'	550240	000005	        HRRZ    T3,T3                   ;ZERO LEFT HALF.
  4589	407016'	221244	000000	        IMULI   T3,ZERO(T2)             ;T3 HAS WORDS NEEDED.
  4590	407017'	270240	406751*	        ADD     T3,JOBFF                ;COMPUTE LAST WORD NEEDED.
  4591	407020'	435240	001777	        IORI    T3,1777                 ;CONVERT TO A K BOUNDARY.
  4592	407021'	317240	406742*	        CAMG    T3,JOBREL               ;SEE IF ENOUGH ROOM.
  4593	407022'	254000	407025'	        GOTO    .+3                     ;WE HAVE ENOUGH.
  4594	407023'	047240	000011	        MME     T3,.CORE                ;GET SOME MORE.
  4595	407024'	254000	410270'	        GOTO    NOCORE                  ;YOU LOOSE.
  4596	407025'	200140	414530'	        MOVE    T1,[INBUF IF,ZERO(T2)]  ;GET BUFFERS FOR INPUT.
  4597	407026'	302500	000032'	        CAIE    SIDE,IFILE              ;SKIP OF THAT'S WHAT WE WANT.
  4598	407027'	200140	414531'	        MOVE    T1,[OUTBUF OF,ZERO(T2)] ;ELSE CHANGE TO OUTPUT.
  4599	407030'	256000	000003	        XCT     T1                      ;GET THE BUFFERS.
  4600	407031'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 80
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4601				;HERE TO MOVE THE ALTER BUFFER INTO THE
  4602				;OUTPUT BUFFER.
  4603
  4604	407032'	550240	000405'	BUFMOV: HRRZ    T3,CURPTR               ;GET END OF BUFFER
  4605	407033'	550200	000403'	        HRRZ    T2,RECPTR               ;GET BEGINNING
  4606	407034'	307244	000000	        CAIG    T3,0(T2)                ;IS ANYTHING THERE?
  4607	407035'	263740	412060'	        RETURN  ZERO                    ;IF NOT, RETURN
  4608	407036'	261740	000003	        SAVE    T1
  4609	407037'	200140	000020'	        MOVE    T1,OFILE+CHRMOD                 ;IS MODE VEB?
  4610	407040'	306140	413516'	        CAIN    T1,VEBMOD
  4611	407041'	254000	407073'	        JRST    BUF00                   ;IF SO, GO TO BUF00
  4612	407042'	262740	000003	        UNSAVE  T1
  4613	407043'	332000	000011'	        SKIPE   OFILE+BLKFCT            ;IS THERE A BLOCKING FACTOR?
  4614	407044'	602040	000040	        IF.ON   OF,SPAN,BUF3            ;IF NOT, DON'T DO BLT
  4615	407046'	337000	000307'	        SKIPG   OBUF                    ;HAS BUFFER BEEN USED?
  4616	407047'	067040	000000	        OUTPUT  OF,ZERO                 ;NO, USE IT
  4617	407050'	275244	777777	        SUBI    T3,-1(T2)               ;GET SIZE OF SOURCE
  4618	407051'	135200	414532'	        LDB     T2,[POINT 17,@OBUF,17]  ;GET SIZE OF TARGET
  4619	407052'	370000	000004	        SOS     T2
  4620	407053'	504140	000403'	        HRL     T1,RECPTR               ;SOURCE FOR BLT
  4621	407054'	311200	000005	BUF0:   CAML    T2,T3                   ;WILL IT FIT?
  4622	407055'	254000	407132'	        GOTO    BUF1                    ;YES, DO IT
  4623	407056'	261740	000003	        SAVE    T1                      ;SAVE XWD FOR BLT
  4624	407057'	261740	000004	        SAVE    T2                      ;SAVE DESTINATION LENGTH
  4625	407060'	261740	000005	        SAVE    T3                      ;SAVE SOURCE LENGTH
  4626	407061'	260740	407133'	        GOSUB   BUF2                    ;MOVE A SEGMENT
  4627	407062'	260740	407344'	        GOSUB   EMPTY                   ;WRITE IT TO DEVICE
  4628	407063'	262740	000005	        UNSAVE  T3                      ;RESTORE SOURCE LENGTH
  4629	407064'	262740	000004	        UNSAVE  T2                      ;RESTORE DESTINATION LENGTH
  4630	407065'	262740	000003	        UNSAVE  T1                      ;RESTORE XWD FOR BLT
  4631	407066'	554400	000003	        HLRZ    P3,T1                   ;GET OLD SOURCE
  4632	407067'	271404	000000	        ADDI    P3,ZERO(T2)             ;GET NEXT SEGMENT
  4633	407070'	504140	000010	        HRL     T1,P3                   ;CREATE XWD FOR NEXT BLT
  4634	407071'	274240	000004	        SUB     T3,T2                   ;ACCOUNT FOR NEXT MOVE
  4635	407072'	254000	407054'	        GOTO    BUF0                    ;DO NEXT SEGMENT
  4636	407073'	262740	000003	BUF00:  UNSAVE  T1
  4637	407074'	274240	000004	        SUB     T3,T2                   ;HOW MANY WORDS?
  4638	407075'	350000	000005	        AOS     T3
  4639	407076'	450240	000000	        SETCA   T3,                     ;GET 2'S COMPLIMENT OF LENGTH
  4640	407077'	350000	000005	        AOS     T3
  4641	407100'	507000	000005	        HRLS    T3                      ;PUT IN LHS
  4642	407101'	370000	000004	        SOS     T2                      ;DECREMENT BUFFER ADR
  4643	407102'	540240	000004	        HRR     T3,T2                   ;PUT IN RHS
  4644	407103'	202240	000643'	        MOVEM   T3,CMDLST               ;SAVE IN CMDLST
  4645	407104'	200200	002714'	        MOVE    T2,OSIZE                ;GET SIZE OF RECORD
  4646	407105'	271200	000010	        ADDI    T2,^D8                  ;PLUS SIZE OF HEADER
  4647	407106'	231200	000004	        IDIVI   T2,4                    ;DIVIDE BY WORD SIZE
  4648	407107'	201200	000105	        MOVEI   T2,105                  ;GET MTAPE CODE
  4649	407110'	274200	000005	        SUB     T2,T3
  4650	407111'	336000	000005	        SKIPN   T3
  4651	407112'	201200	000101	        MOVEI   T2,101
  4652	407113'	200240	414213'	        MOVE    T3,[MTAPE OF,]          ;CONSTRUCT COMMAND
  4653	407114'	540240	000004	        HRR     T3,T2
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 80-2
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4654	407115'	256000	000005	        XCT     T3                      ;PERFORM BYTE ADJUST
  4655	407116'	057040	000643'	        OUT     OF,CMDLST               ;WRITE OUT BUFFER
  4656	407117'	263740	412060'	        RETURN  ZERO                    ;IF NO ERROR, RETURN
  4657	407120'	062040	000004	        GETSTS  OF,T2                   ;GET ERROR BITS
  4658	407121'	602200	002000	        IF.ON   T2,E.EOT,EOTERR         ;JUMP IF EOT
  4659	407123'	602200	040000	        IF.ON   T2,E.IOB,NOROOM         ;JUMP IF NO ROOM
  4660	407125'	606200	100000	        IF.OFF  T2,E.PAR,LOKERR         ;JUMP IF NOT PARITY ERROR
  4661	407127'	606040	000020	        IF.OFF  OF,NOERROR,PARERR       ;TYPE MESSAGE IF HE WANTS IT
  4662	407131'	263740	412060'	        RETURN  ZERO                    ;RETURN TO CALLER
  4663	407132'	200200	000005	BUF1:   MOVE    T2,T3                   ;COPY WHAT IS LEFT
  4664	407133'	200240	000004	BUF2:   MOVE    T3,T2                   ;COPY WORDS TO MOVE.
  4665	407134'	550615	000006	        HRRZ    CH,MSIZ(OM)             ;GET OUTPUT CHARACTERS/WORD.
  4666	407135'	220240	000014	        IMUL    T3,CH                   ;T3_CHARACTERS TO MOVE.
  4667	407136'	250240	000311'	        EXCH    T3,OBUF+2               ;T3_BUFCNT OBUF+2_CHR TO MOVE.
  4668	407137'	276240	000311'	        SUBM    T3,OBUF+2               ;ACCOUNT FOR CHARACTERS MOVED.
  4669	407140'	550240	000310'	        HRRZ    T3,OBUF+1               ;POINTER TO BUFFER MINUS ONE.
  4670	407141'	541145	000001	        HRRI    T1,ONE(T3)              ;XWD FOR BLT.
  4671	407142'	271244	000000	        ADDI    T3,ZERO(T2)             ;COMPUTE LAST WORD OF BUFFER.
  4672	407143'	542240	000310'	        HRRM    T3,OBUF+1               ;SAVE BYTE POINTER.
  4673	407144'	251145	000000	        BLT     T1,ZERO(T3)             ;MOVE THE BUFFER.
  4674	407145'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  4675	407146'	200400	000403'	BUF3:   MOVE    P3,RECPTR               ;GET THE POINTER TO TOP.
  4676	407147'	134600	000010	BUF4:   ILDB    CH,P3                   ;GET A BYTE.
  4677	407150'	260740	407334'	        GOSUB   PUT                     ;TO THE OUTPUT BUFFER.
  4678	407151'	312400	000405'	        CAME    P3,CURPTR               ;SKIP IF ALL DONE.
  4679	407152'	254000	407147'	        GOTO    BUF4                    ;ELSE MOVE THE REST.
  4680	407153'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 81
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4681				;HERE TO GET A CHARACTER FROM THE BUFFER.
  4682
  4683	407154'	622000	040000	GET:    TNZ     S,BAC,GET2              ;JUMP IF WANT SAME CHARACTER.
  4684	407156'	332140	000060'	        SKIPE T1,IFILE+FSTTAP
  4685	407157'	254000	407265'	        GOTO GFXFST
  4686	407160'	375000	000314'	GET1A:  SOSGE   IBUF+2                  ;DECREMENT THE COUNT.
  4687	407161'	254000	407167'	        GOTO    GET1                    ;NEED TO FILL THE BUFFER.
  4688	407162'	332000	000412'	        SKIPE   SP36M
  4689	407163'	260740	407236'	        GOSUB   GET36
  4690	407164'	134600	000313'	        ILDB    CH,IBUF+1               ;GET A BYTE.
  4691	407165'	202600	000374'	        MOVEM   CH,TCH                  ;SAVE IN CASE WE WANT IT LATTER.
  4692	407166'	254000	412057'	        RETURN  ONE                     ;BACK TO SENDER.
  4693	407167'	260740	407174'	GET1:   GOSUB   FILL                    ;READ THE NEXT BLOCK.
  4694	407170'	263740	412060'	        RETURN  ZERO                    ;END OF FILE RETURN.
  4695	407171'	254000	407160'	        GOTO    GET1A                   ;GET THE NEXT WORD.
  4696	407172'	200600	000374'	GET2:   MOVE    CH,TCH                  ;GET LAST CHARACTER BACK.
  4697	407173'	254000	412057'	        RETURN  ONE                     ;TAKE IT TO HIM.
  4698	407174'	350000	000372'	FILL:   AOS     ISEC                    ;COUNT THE BLOCK TO READ.
  4699	407175'	332000	000060'	        SKIPE   IFILE+FSTTAP            ;CHECK FOR FAST TAPE
  4700	407176'	402000	000430'	        SETZM   EXTCHI                  ;ZAP THE COUNT TO RESTART IT
  4701	407177'	620000	001000	        DEVOP   IN,IF,ZERO              ;FILE UP THE BUFFERS.
  4702	407202'	254000	407251'	        GOTO    CK36                    ;ADJUST BYTE COUNT FOR 36 MODE
  4703	407203'	062100	000003	FILCHK: GETSTS  IF,T1                   ;GET DEVICE STATUS.
  4704	407204'	606140	740000	        IF.OFF  T1,E.ERR,CHKEOF         ;JUMP IF EOF.
  4705	407206'	602000	000200	        IF.ON   S,NI.ERR,RET1           ;NO ERRORS FOR LABELS OR SKIPPING.
  4706	407210'	602140	100000	        IF.ON   T1,E.PAR,GETPAR         ;PARITY ERROR FOUND.
  4707	407212'	602000	010000	        IF.ON   S,NI.LST,RET1           ;LIST IGNORES OTHER ERRORS.
  4708	407214'	254000	412244'	        GOTO    LKIERR                  ;JUMP REAL ERROR.
  4709	407215'	606100	000020	GETPAR: IF.OFF  IF,NOERROR,IPERR        ;JUMP IF WANTS SEE IT.
  4710	407217'	350000	000367'	        AOS     INPERR                  ;COUNT THE ERROR.
  4711	407220'	254000	412057'	        RETURN  ONE                     ;BACK TO SENDER.
  4712	407221'	602140	020000	CHKEOF: IF.ON   T1,E.EOF,INPEND         ;JUMP IF EOF.
  4713	407223'	602000	010000	        IF.OFF  S,NI.LST                ;RETURN IF NO ERROR.
  4714	407224'	606140	002000	        IF.ON   T1,E.EOT                ;SKIP IF END OF TAPE.
  4715	407225'	254000	412057'	        RETURN  ONE                     ;ELSE GIVE GOOD RETURN.
  4716	407226'	263740	412060'	        RETURN  ZERO                    ;OTHERWISE GIVE EOF RETURN.
  4717	407227'	334140	414216'	INPABT: SKIPA   T1,[DRIVE IF,.SKF]      ;SKIP FOR LEGAL LABEL AT EOF.
  4718	407230'	334140	414533'	INPAB0: SKIPA   T1,[DRIVE IF,.BSR]      ;BACK UP FOR ERROR ON LABEL.
  4719	407231'	332000	000045'	        SKIPE   IFILE+LABEL             ;DON'T DO ANYTHING FOR NO LABELS.
  4720	407232'	256000	000003	        XCT     T1                      ;DO THE FUNCTION.
  4721	407233'	072100	000000	        DRIVE   IF,.WAT                 ;WAIT FOR IT.
  4722	407234'	620000	000620	        OFF     S,HDR!NI.ERR!TERM       ;CLEAR BITS SET FOR HEADER.
  4723	407235'	263740	412060'	        RETURN  ZERO                    ;GIVE EOF RETURN.
  4724
  4725				;HERE FOR SPECIAL 36-BIT MODE
  4726	407236'	554600	000313'	GET36:  HLRZ    CH,IBUF+1
  4727	407237'	302600	041000	        CAIE    CH,41000
  4728	407240'	263740	412060'	        RETURN  ZERO
  4729	407241'	201600	040400	        MOVEI   CH,40400
  4730	407242'	506600	000313'	        HRLM    CH,IBUF+1
  4731	407243'	134140	000313'	        ILDB    T1,IBUF+1
  4732	407244'	134600	000313'	        ILDB    CH,IBUF+1
  4733	407245'	137140	414534'	        DPB     T1,[XWD 40400,CH]
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 81-2
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4734	407246'	201140	401000	        MOVEI   T1,401000
  4735	407247'	506140	000313'	        HRLM    T1,IBUF+1
  4736	407250'	254000	412057'	        RETURN  ONE
  4737
  4738	407251'	201140	000002	CK36:   MOVEI T1,IF     ;GET INPUT CHANNEL
  4739	407252'	047140	000054	        DEVSTS T1,      ;UUO TO SEE IF WE HAVE EXTRA BYTES
  4740	407253'	400140	000000	        SETZ T1,
  4741	407254'	242140	777756	        LSH T1,-22      ;EXTRA BYTES IN 15,16,17
  4742	407255'	405140	000007	        ANDI T1,7
  4743	407256'	272140	000314'	        ADDM T1,IBUF+2  ;ADD TO NORMAL COUNT
  4744	407257'	336000	000412'	        SKIPN   ,SP36M                          ;IF NOT SPECIAL MODE, SKIP ALL THIS
  4745	407260'	254000	407264'	        GOTO    .+4
  4746	407261'	200140	000314'	        MOVE    T1,IBUF+2                       ;GET NORMAL BYTE COUNT
  4747	407262'	242140	777775	        LSH     T1,-3                           ;COMPUTE DIFFERENCE
  4748	407263'	272140	000314'	        ADDM    T1,IBUF+2                       ;ADD TO NORMAL
  4749	407264'	254000	411521'	        GOTO    BCLCHK                          ;SEE IF EOF -- WHAT THING THIS IS.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 82
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4750	407265'	260740	407160'	GFXFST: GOSUB   GET1A   ;GET A CHARACTER
  4751	407266'	263740	412060'	        RETURN ZERO
  4752	407267'	200140	000060'	        MOVE    T1,IFILE+FSTTAP                 ;THIS COULD HAVE BEEN CLOBBERED
  4753	407270'	307140	000006	        CAIG T1,6       ;ONLY SIXBIT?
  4754	407271'	254000	412057'	        RETURN ONE      ;YES, DONE!
  4755	407272'	200240	000014	        MOVE T3,CH      ;SAVE CHARACTER
  4756	407273'	306140	000044	        CAIN T1,^D36
  4757	407274'	254000	407324'	        GOTO GETALL     ;IF USER WANTS WHOLE WORD, GO GET ONE
  4758	407275'	332000	000430'	        SKIPE EXTCHI    ;ANY EXTRA BITS?
  4759	407276'	254000	407304'	        GOTO GFXF1      ;YES, GO GET THEM
  4760	407277'	201200	000006	        MOVEI T2,6
  4761	407300'	552200	000430'	        HRRZM T2,EXTCHI ;SAVE NO. OF BITS
  4762	407301'	506240	000430'	        HRLM T3,EXTCHI  ;SAVE EXTRA BITS
  4763	407302'	360340	000000	        SOJ P2,         ;DECREMENT THE CHARACTER COUNT
  4764	407303'	254000	407265'	        GOTO    GFXFST  ;GOTO GFXFST WAS ORIGINAL COMMAND INSTRUCTION
  4765	407304'	554200	000430'	GFXF1:  HLRZ T2,EXTCHI  ;GET EXTRA BITS
  4766	407305'	242240	000036	        LSH T3,^D30     ;POSITION NEW BITS
  4767	407306'	200140	000060'	        MOVE T1,IFILE+FSTTAP
  4768	407307'	553000	000430'	        HRRZS EXTCHI
  4769	407310'	274140	000430'	        SUB T1,EXTCHI
  4770	407311'	246220	000003	        LSHC T2,@T1
  4771	407312'	200600	000004	        MOVE CH,T2      ;GET BITS TO RETURN
  4772	407313'	202600	000374'	        MOVEM   CH,TCH  ;SAVE FOR LATER
  4773	407314'	200140	000430'	        MOVE T1,EXTCHI
  4774	407315'	271140	000006	        ADDI T1,6
  4775	407316'	274140	000060'	        SUB T1,IFILE+FSTTAP     ;# LEFT
  4776	407317'	552140	000430'	        HRRZM T1,EXTCHI
  4777	407320'	400200	000000	        SETZ T2,
  4778	407321'	246220	000003	        LSHC T2,@T1
  4779	407322'	506200	000430'	        HRLM T2,EXTCHI
  4780	407323'	254000	412057'	        RETURN ONE
  4781
  4782	407324'	200200	414535'	GETALL: MOVE T2,[POINT 6,CH]
  4783	407325'	400600	000000	        SETZ CH,
  4784	407326'	137240	000004	        DPB T3,T2
  4785	407327'	201140	000005	        MOVEI T1,5
  4786	407330'	260740	407160'	        GOSUB GET1A
  4787	407331'	137600	000004	        DPB CH,T2
  4788	407332'	367140	407330'	        SOJG T1,.-2
  4789	407333'	254000	412057'	        RETURN ONE
  4790
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 83
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4791				;HERE TO WRITE ONE CHARACTER INTO THE BUFFER.
  4792
  4793	407334'	332140	000027'	PUT:    SKIPE T1,OFILE+FSTTAP
  4794	407335'	260740	407401'	        GOSUB   FIXFST
  4795	407336'	375000	000311'	PUT1:   SOSGE   OBUF+2                  ;DECREMENT THE COUNT.
  4796	407337'	254000	407342'	        GOTO    WRITE                   ;EMPTY THE BUFFER.
  4797	407340'	136600	000310'	        IDPB    CH,OBUF+1               ;SAVE THE WORD.
  4798	407341'	263740	412060'	        RETURN  ZERO                    ;BACK TO SENDER.
  4799	407342'	260740	407344'	WRITE:  GOSUB   EMPTY                   ;WRITE IT OUT.
  4800	407343'	254000	407336'	        GOTO    PUT1                    ;CONTINUE LOOP.
  4801	407344'	332000	000373'	EMPTY:  SKIPE   OSEC
  4802				        GOTO    [SOSG   SBLKN
  4803				                GOTO    EMPT1
  4804				                SOS     OBCNT                   ;DON'T COUNT THIS BLOCK
  4805						SOS	TOBCNT
  4806				                SETZ    T1
  4807				                SKIPN   OFILE+BLKFCT
  4808				                SOSA    T1
  4809				                SUB     T1,OFILE+BLKFCT
  4810						ADDM	T1,ORCNT
  4811						ADDM	T1,TORCNT
  4812				                MOVE    T1,SAVPTR               ;RESTORE HEADER POINTER
  4813				                MOVEM   T1,OBUF+1
  4814				                MOVE    T1,SAVCNT               ;RESTORE HEADER COUNT
  4815				                MOVEM           T1,OBUF+2
  4816	407345'	254000	414536'	                GOTO    RET0]
  4817	407346'	350000	000373'	EMPT1:  AOS     OSEC                    ;COUNT OUTPUT SECTOR
  4818	407347'	261740	000307'	        SAVE    OBUF
  4819	407350'	620000	001000	        DEVOP   OUT,OF,ZERO             ;WRITE THE BUFFER.
  4820	407353'	254000	407367'	        GOTO    EMPT2
  4821	407354'	262740	000003	        UNSAVE  T1
  4822	407355'	062040	000003	        GETSTS  OF,T1                   ;GET DEVICE STATUS
  4823	407356'	602140	002000	        IF.ON   T1,E.EOT,EOTERR         ;JUMP IF EOT
  4824	407360'	602140	040000	        IF.ON   T1,E.IOB,NOROOM         ;JUMP IF NO ROOM
  4825	407362'	606140	100000	        IF.OFF  T1,E.PAR,LOKERR         ;JUMP IF NOT PARITY ERROR.
  4826	407364'	606040	000020	        IF.OFF  OF,NOERROR,PARERR       ;TYPE MESSAGE IF HE WANTS IT.
  4827	407366'	263740	412060'	        RETURN  ZERO                    ;YES WE GIVE NORMAL RETURN.
  4828	407367'	262740	000003	EMPT2:  UNSAVE  T1
  4829	407370'	325140	407375'	        JUMPGE  T1,.+5
  4830	407371'	200140	000310'	        MOVE    T1,OBUF+1               ;SAVE POINTER
  4831	407372'	202140	000664'	        MOVEM   T1,SAVPTR
  4832	407373'	200140	000311'	        MOVE    T1,OBUF+2               ;SAVE COUNT
  4833	407374'	202140	000665'	        MOVEM   T1,SAVCNT
  4834	407375'	332000	000663'	        SKIPE   MFILES
  4835	407376'	372000	000661'	        SOSE    TBLKN
  4836	407377'	263740	412060'	        RETURN  ZERO
  4837	407400'	254000	404026'	        GOTO    CHKT
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 84
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4838	407401'	200240	000014	FIXFST: MOVE T3,CH      ;GET CHARACTER
  4839	407402'	332000	000427'	        SKIPE EXTCHO    ;ANY EXTRA CHARACTER?
  4840	407403'	254000	407430'	        GOTO FIXEXT     ;YES, TAKE CARE OF THEM
  4841	407404'	306140	000044	        CAIN T1,^D36    ;NEED TO SEND WHOLE WORD?
  4842	407405'	254000	407443'	        GOTO SENDAL     ;YES, GO DO IT
  4843	407406'	400200	000000	        SETZ T2,        ;GET READY FOR SHIFT
  4844	407407'	246220	000425'	        LSHC T2,@MOVCHO ;GET BITS TO WRITE NOW
  4845	407410'	200600	000004	FIXF1:  MOVE CH,T2      ;SAVE THEM
  4846	407411'	275140	000006	        SUBI T1,6       ;COMPUTE NO. OF EXTRA BITS
  4847	407412'	201200	000022	        MOVEI T2,^D18   ;ARRANGE EXTRA BITS
  4848	407413'	274200	000003	        SUB T2,T1       ;SHIFT HALF WORD - NO. OF BITS
  4849	407414'	213000	000004	        MOVNS T2        ;SHIFT RIGHT
  4850	407415'	553000	000004	        HRRZS T2
  4851	407416'	242260	000004	        LSH T3,@T2      ;POSITION IT
  4852	407417'	512240	000427'	        HLLZM T3,EXTCHO ;SAVE BITS
  4853	407420'	542140	000427'	        HRRM T1,EXTCHO  ;SAVE NO. OF BITS
  4854	407421'	305140	000006	        CAIGE T1,6      ;MORE THAN 6 BITS LEFT OVER?
  4855	407422'	263740	412060'	        RETURN  ZERO    ;NO, WRITE CHARACTER AND RETURN TO CALLER
  4856	407423'	260740	407336'	        GOSUB PUT1      ;YES, WRITE CHARACTER AND RETURN HERE
  4857	407424'	360400	000000	        SOJ P3,         ;DECREMENT CHARACTER COUNT
  4858	407425'	554600	000427'	        HLRZ CH,EXTCHO
  4859	407426'	402000	000427'	        SETZM EXTCHO
  4860	407427'	263740	412060'	        RETURN  ZERO            ;GO BACK
  4861	407430'	554200	000427'	FIXEXT: HLRZ T2,EXTCHO  ;GET EXTRA BITS
  4862	407431'	553000	000427'	        HRRZS EXTCHO    ;GET NO. OF BITS
  4863	407432'	200140	000425'	        MOVE T1,MOVCHO  ;GET NO. OF PLACES TO ROTATE
  4864	407433'	275140	000006	        SUBI T1,6       ;LESS 1 CHAR.
  4865	407434'	242260	000003	        LSH T3,@T1      ;GET BITS IN POSITION
  4866	407435'	201140	000006	        MOVEI T1,6
  4867	407436'	274140	000427'	        SUB T1,EXTCHO   ;GET NO. OF BITS NEEDED
  4868	407437'	246220	000003	        LSHC T2,@T1     ;GET NEW 6 BITS TOGETHER
  4869	407440'	200140	000027'	        MOVE T1,OFILE+FSTTAP    ;GET BITS PER BYTE
  4870	407441'	270140	000427'	        ADD T1,EXTCHO
  4871	407442'	254000	407410'	        GOTO FIXF1
  4872
  4873	407443'	201140	000006	SENDAL: MOVEI T1,6
  4874	407444'	246220	000425'	SEND1:  LSHC T2,@MOVCHO
  4875	407445'	200600	000004	        MOVE CH,T2
  4876	407446'	261740	000003	        SAVE T1
  4877	407447'	260740	407336'	        GOSUB PUT1
  4878	407450'	262740	000003	        UNSAVE T1
  4879	407451'	367140	407444'	        SOJG T1,SEND1
  4880	407452'	262740	000003	        UNSAVE  T1              ;GET RID OF CALL TO FIXFST
  4881	407453'	263740	412060'	        RETURN ZERO
  4882
  4883	407454'	332140	000027'	ENDEXT: SKIPE T1,OFILE+FSTTAP
  4884	407455'	336000	000427'	        SKIPN EXTCHO
  4885	407456'	263740	412060'	        RETURN ZERO
  4886	407457'	360400	000000	        SOJ P3,
  4887	407460'	554600	000427'	        HLRZ CH,EXTCHO
  4888	407461'	275140	000006	        SUBI T1,6
  4889	407462'	242620	000003	        LSH CH,@T1
  4890	407463'	402000	000427'	        SETZM EXTCHO
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 84-2
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4891	407464'	254000	407336'	        GOTO PUT1
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 85
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4892				;HERE FROM INPUT ROUTINE TO GET NEXT REEL.
  4893
  4894	407465'	051600	000000	INPEND: ENABLE  TTY                     ;CLEAR CONTROL O.
  4895	407467'	070100	000000	        CLOSE   IF,ZERO                 ;DO THIS TO RESET EOF FLAG.
  4896	407470'	622000	000200	        TNZ     S,NI.ERR,RET0           ;RETURN IF NOT LEGAL EOF.
  4897	407472'	062100	000003	        GETSTS  IF,T1                   ;SEE IF ERROR.
  4898	407473'	602140	740000	        IF.OFF  T1,E.ERR                ;TEST ERROR BITS.
  4899	407474'	051140	414555'	        PRINT   (% Error during eof label check.)
  4900	407475'	402000	000436'
  4901	407476'	607100	000020	        IF.OFF  IF,MTA,RET0             ;RETURN IF NOT MAG-TAPE.
  4902	407500'	660000	000400	        ON      S,HDR                   ;SET HEADER BIT.
  4903	407501'	260740	412033'	        GOSUB   STORE                   ;SAVE THE AC'S.
  4904	407502'	260740	407571'	        GOSUB   GETLAB                  ;READ A LABEL BLOCK.
  4905	407503'	254000	407230'	        GOTO    INPAB0                  ;CAN'T BE A LABEL IF EOF.
  4906	407504'	336000	000045'		SKIPN	IFILE+LABEL		;SKIP IF NOT NO LABEL
  4907	407505'	606100	000300		IF.ON	IF,WNAME!WEXT
  4908	407506'	334000	000000		SKIPA
  4909	407507'	370000	000434'		SOS	WLDEXT		;SET BACK FILE COUNTER
  4910	407510'	260740	405242'	        BRANCH  INPLAB,<INPAB0,INPABT,INPABT> ;SEE IF WE HAVE A LABEL.
  4911	407514'	606000	400000	        IF.OFF  S,L.EOV,INPABT          ;JUMP IF NOT EOV.
  4912	407516'	620000	000020	        OFF     S,TERM                  ;CLEAR HEADER BIT.
  4913	407517'	260740	411562'	        GOSUB   STAT                    ;PROGRAM GOODNESS.
  4914	407520'	402000	000357'	        SETZM   IBCNT                   ;CLEAR BLOCKS READ.
  4915	407521'	402000	000356'	        SETZM   IRCNT                   ;CLEAR RECORDS READ.
  4916	407522'	402000	000353'		SETZM	TIBCNT
  4917	407523'	402000	000352'		SETZM	TIRCNT
  4918	407524'	200140	000047'	        MOVE    T1,IFILE+VOL            ;GET CURRENT VOLUME NUMBER.
  4919	407525'	260740	412117'	        GOSUB   BMPVOL                  ;INCREMENT THE NUMBER.
  4920	407526'	202140	000047'	        MOVEM   T1,IFILE+VOL            ;REPLACE IT.
  4921	407527'	660000	002000	TAINP:  ON      S,NO.PRI                ;SET FORCE HUNG DEVICE BIT.
  4922	407530'	072100	000011	        DRIVE   IF,.UNL                 ;UNLOAD DEVICE.
  4923	407531'	051140	414564'	        PRINT   (% Mount next input tape on same drive.)
  4924	407532'	402000	000436'
  4925	407533'	071100	000000	        RELEASE IF,ZERO                 ;RELEASE THE DEVICE.
  4926	407534'	260740	412227'	        GOSUB   TRPSET                  ;RESET TRAP BLOCK.
  4927	407535'	050100	000032'	        OPEN    IF,IFILE                ;GET THE DEVICE BACK.
  4928	407536'	265140	407741'	        JSP     T1,NODEV                ;CAN'T HAVE IT....
  4929	407537'	554156	000006	        HLRZ    T1,MSIZ(IM)             ;GET THE BYTE SIZE.
  4930	407540'	137140	414211'	        DPB     T1,[POINT 6,IBUF+1,11]  ;SET THE BYTE SIZE.
  4931	407541'	072100	000000	        DRIVE   IF,.WAT                 ;MAKE SURE IT IS READY.
  4932	407542'	072100	000001	        DRIVE   IF,.REW                 ;REWIND THE DEVICE.
  4933	407543'	072100	000000	        DRIVE   IF,.WAT                 ;DRIVE DEVICE TO COMPLETION.
  4934	407544'	620000	002000	        OFF     S,NO.PRI                ;PRINT HUNG MESSAGE NOW.
  4935	407545'	200140	000646'	        MOVE    T1,IJOBFF               ;GET SAVED TOP OF CORE.
  4936	407546'	250140	407017*	        EXCH    T1,JOBFF                ;PUT IN PLACE FOR EXEC.
  4937	407547'	261740	000003	        SAVE    T1                      ;SAVE CURRENT VALUE.
  4938	407550'	064100	000002	        INBUF   IF,TWO                  ;GET SOME BUFFERS.
  4939	407551'	201140	000312'	        MOVEI   T1,IBUF                 ;POINTER TO HEADERS.
  4940	407552'	201500	000032'	        MOVEI   SIDE,IFILE              ;POINTER TO PARAMETERS.
  4941	407553'	260740	406626'	        GOSUB   MAKE                    ;MAKE NEW BUFFERS.
  4942	407554'	262740	407546*	        UNSAVE  JOBFF                   ;PUT BACK TOP OF CORE.
  4943	407555'	261740	414575'	        SAVE    [TAINP-1]               ;PLACE A RETURN ON THE STACK.
  4944	407556'	260740	407571'	        GOSUB   GETLAB                  ;GET A LABEL BLOCK.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 85-2
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4945	407557'	254000	410324'	        GOTO    BADEOF                  ;BAD FILE MARK FOUND.
  4946	407560'	260740	405242'	        BRANCH  INPLAB,<NOLAB,NOMAT,BADVOL> ;BRANCH ON LABEL FOUND.
  4947	407564'	606000	100000	        IF.OFF  S,L.HDR,NOLAB           ;JUMP IF NOT THE RIGHT TYPE.
  4948	407566'	620000	002400	        OFF     S,NO.PRI!HDR            ;CLEAR INDICATOR BITS.
  4949	407567'	274740	414576'	        SUB     PDP,[XWD ONE,ONE]       ;FIX THE STACK.
  4950	407570'	254000	412057'	        RETURN  ONE                     ;GO FILL IT UP.
  4951
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 87
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4952				;HERE TO FILL THE BUFFER RING WITH A BUFFER THAT SHOULD
  4953				;CONTAIN A LABEL OF SOME KIND.
  4954
  4955	407571'	062100	000003	GETLAB: GETSTS  IF,T1                   ;GET THE DEVICE STATUS.
  4956	407572'	660140	000040	        ON      T1,SYNC                 ;SYNC WITH THE DEVICE.
  4957	407573'	060103	000000	        SETSTS  IF,ZERO(T1)             ;RESET THE STATUS.
  4958	407574'	602100	000010	        IF.OFF  IF,IND                  ;SKIP IF OUR MODE.
  4959	407575'	072100	000101	        DRIVE   IF,.IND                 ;ELSE SET THEIRS.
  4960	407576'	660000	000200	        ON      S,NI.ERR                ;TURN ON EOF RETURN FLAG.
  4961	407577'	260740	407174'	        GOSUB   FILL                    ;FILL THE BUFFER WITH A LABEL.
  4962	407600'	370017	000000	        SOS     ZERO(PDP)               ;DECREMENT TO GIVE ERROR RETURN.
  4963	407601'	350017	000000	        AOS     ZERO(PDP)               ;INCREMENT FOR NORMAL RETURN.
  4964	407602'	620000	000200	        OFF     S,NI.ERR                ;TURN OFF EOF RETURN FLAG.
  4965	407603'	062100	000003	        GETSTS  IF,T1                   ;GET DEVICE STATUS.
  4966	407604'	620000	000040	        OFF     S,SYNC                  ;TURN OFF SYNC BIT.
  4967	407605'	060103	000000	        SETSTS  IF,ZERO(T1)             ;RESET STATUS.
  4968	407606'	476000	000314'	        SETOM   IBUF+2                  ;FLAG BUFFER WILL BE USED.
  4969	407607'	263740	412060'	        RETURN  ZERO                    ;TO CALLER.
  4970
  4971				;HERE TO CONVERT THE LABEL JUST READ INTO THE BUFFER
  4972				;RING INTO SIXBIT AND TO STORE THAT BUFFER IN "INPBUF" FOR
  4973				;FURTHER PROCESSING.
  4974
  4975	407610'	205400	440700	CVTLAB: MOVSI   P3,(POINT 7,ZERO)       ;POINTER FOR IMAGE MODE.
  4976	407611'	302140	413340'	        CAIE    T1,IMGMOD               ;SKIP IF IMAGE MODE.
  4977	407612'	200403	000007	        MOVE    P3,MPTR(T1)             ;GET A BYTE POINTER.
  4978	407613'	200200	000015	        MOVE    T2,OM                   ;GET THE OUTPUT INDEX.
  4979	407614'	260740	412401'	        GOSUB   GETTAB                  ;GET THE RIGHT TABLES.
  4980	407615'	200300	414577'	        MOVE    P1,[POINT 6,INPBUF]     ;POINTER TO BUFFER.
  4981	407616'	211340	000120	        MOVNI   P2,^D80                 ;MAX CHARACTERS IN ANY LABEL.
  4982	407617'	200140	000312'	        MOVE    T1,IBUF                 ;GET A POINTER TO CURRENT BUFFER.
  4983	407620'	271403	000002	        ADDI    P3,TWO(T1)              ;POINT P3 TO BUFFER.
  4984	407621'	134600	000010	RED0:   ILDB    CH,P3                   ;GET A BYTE.
  4985	407622'	554614	001711'	        HLRZ    CH,TAB1(CH)             ;CONVERT IT TO ASCII.
  4986	407623'	275600	000040	        SUBI    CH," "                  ;NOW TO SIXBIT.
  4987	407624'	136600	000006	        IDPB    CH,P1                   ;SAVE IT IN BUFFER.
  4988	407625'	346340	407621'	        AOJN    P2,RED0                 ;CONTINUE LOOP.
  4989	407626'	200140	000016	REVIVE: MOVE    T1,IM                   ;GET THE TRUE INPUT MODE.
  4990	407627'	200200	000015	        MOVE    T2,OM                   ;GET THE TRUE OUTPUT MODE.
  4991	407630'	254000	412401'	        GOTO    GETTAB                  ;GET THE RIGHT TABLES.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 88
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  4992				;HERE TO READ THE LABEL FROM THE OUTPUT DEVICE IF THE
  4993				;DEVICE IS A MAG-TAPE AND TO CONVERT IT TO SIXBIT
  4994				;AND STORE IT IN OUTBUF FOR FURTHER PROCESSING.
  4995
  4996	407631'	200300	414600'	REDOUT: MOVE    P1,[XWD OIBUF,OIBUF+1]  ;BLT POINTER.
  4997	407632'	402000	000315'	        SETZM   OIBUF                   ;CLEAR FIRST WORD.
  4998	407633'	251300	000347'	        BLT     P1,BUFF+^D23            ;CLEAR CORE.
  4999	407634'	200300	414601'	        MOVE    P1,[XWD 400000,BUFF+1]  ;SET UP BUFFER ON OUTPUT DEVICE.
  5000	407635'	202300	000315'	        MOVEM   P1,OIBUF                ;INTO BUFFER HEADER.
  5001	407636'	205300	440700	        MOVSI   P1,(POINT 7,ZERO)       ;POINTER IF IMAGE MODE.
  5002	407637'	302200	413340'	        CAIE    T2,IMGMOD               ;SKIP IF IMAGE MODE.
  5003	407640'	510304	000007	        HLLZ    P1,MPTR(T2)             ;GET THE OUTPUT POINTER.
  5004	407641'	202300	000316'	        MOVEM   P1,OIBUF+1              ;SET THE POINTER UP.
  5005	407642'	200140	000016	        MOVE    T1,IM                   ;GET THE INPUT MODE.
  5006	407643'	260740	412401'	        GOSUB   GETTAB                  ;GET THE RIGHT TABLES.
  5007	407644'	200300	414602'	        MOVE    P1,[XWD ^D21,BUFF+1]    ;LINK WORD.
  5008	407645'	202300	000321'	        MOVEM   P1,BUFF+1               ;SET IT IN BUFFER HEADER.
  5009	407646'	200300	414414'	        MOVE    P1,[POINT 6,OUTBUF]     ;POINTER TO BUFFER.
  5010	407647'	211340	000120	        MOVNI   P2,^D80                 ;MAX CHARACTERS IN LABEL.
  5011	407650'	620000	001000	        DEVOP   IN,OF,ZERO              ;READ THE LABEL.
  5012	407653'	254000	407670'	        GOTO    RED0B                   ;START THE COPY.
  5013	407654'	062040	000003	        GETSTS  OF,T1                   ;A LITTLE ERROR.
  5014	407655'	602140	020000	        IF.ON   T1,E.EOF,RET0           ;JUMP IF EOF.
  5015	407657'	602140	600000	        IF.ON   T1,E.LOK!E.HAD,LOKERR   ;JUMP IF HARD ERROR.
  5016	407661'	606140	100000	        IF.OFF  T1,E.PAR,RED0B          ;JUMP IF NOT PARITY ERROR.
  5017	407663'	350000	000370'	        AOS     OTPERR                  ;COUNT AN OUTPUT ERROR.
  5018	407664'	602040	000020	        IF.ON   OF,NOERROR,RED0B        ;JUMP IF IGNORING.
  5019	407666'	262740	000003	        UNSAVE  T1                      ;CLEAN UP THE STACK.
  5020	407667'	254000	407773'	        GOTO    OPERR                   ;SAY THERE IS AN ERROR.
  5021	407670'	134600	000316'	RED0B:  ILDB    CH,OIBUF+1              ;GET A CHARACTER.
  5022	407671'	554614	002311'	        HLRZ    CH,TAB2(CH)             ;CONVERT IT TO ASCII.
  5023	407672'	275600	000040	        SUBI    CH," "                  ;CONVERT IT TO SIXBIT.
  5024	407673'	136600	000006	        IDPB    CH,P1                   ;STORE THE CHARACTER.
  5025	407674'	346340	407670'	        AOJN    P2,RED0B                ;JUMP IF NOT DONE.
  5026	407675'	350017	000000	        AOS     ZERO(PDP)               ;SKIP RETURN FOR A JOB WELL DONE.
  5027	407676'	254000	407626'	        GOTO    REVIVE                  ;GET THE RIGHT TABLES BACK.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 89
MAGCON.MAC	 6-JUL-77 09:25		*** BASIC I/O ROUTINES ***

  5028				;HERE TO WRITE OUT THE LABEL IN OUTBUF TO
  5029				;MAG-TAPE. WE DO CONVERSION HERE FROM SIXBIT TO WHAT
  5030				;EVER CODE THE TAPE IS TO BE WRITTEN IN.
  5031
  5032	407677'	337000	000307'	WRILAB: SKIPG   OBUF                    ;HAS THE BUFFER BEEN USED.
  5033	407700'	067040	000000	        OUTPUT  OF,ZERO                 ;NO SO USE IT.
  5034	407701'	201300	000007	        MOVEI   P1,7                    ;BYTE SIZE IF IMAGE MODE.
  5035	407702'	302200	413340'	        CAIE    T2,IMGMOD               ;SKIP IF IMAGE MODE.
  5036	407703'	554304	000006	        HLRZ    P1,MSIZ(T2)             ;GET OUTPUT BYTE POINTER.
  5037	407704'	137300	414212'	        DPB     P1,[POINT 6,OBUF+1,11]  ;SAVE THE SIZE.
  5038	407705'	200140	000016	        MOVE    T1,IM                   ;INPUT INDEX.
  5039	407706'	260740	412401'	        GOSUB   GETTAB                  ;READ THE RIGHT TABLES.
  5040	407707'	261740	000311'	        SAVE    OBUF+2                  ;SAVE THE COUNTER.
  5041	407710'	550203	000006	        HRRZ    T2,MSIZ(T1)             ;GET THE BYTES PER WORD.
  5042	407711'	135140	414532'	        LDB     T1,[POINT 17,@OBUF,17]  ;GET THE BUFFER SIZE.
  5043	407712'	201143	777777	        MOVEI   T1,-1(T1)               ;JUST THE DATA WORDS.
  5044	407713'	220140	000004	        IMUL    T1,T2                   ;GET THE COUNTER.
  5045	407714'	202140	000311'	        MOVEM   T1,OBUF+2               ;SET COUNTER FOR BUFFER.
  5046	407715'	200300	414414'	        MOVE    P1,[POINT 6,OUTBUF]     ;POINTER TO STORAGE.
  5047	407716'	211340	000120	        MOVNI   P2,^D80                 ;MAX. CHARACTERS IN LABEL.
  5048	407717'	134600	000006	WRITE0: ILDB    CH,P1                   ;GET A CHARACTER.
  5049	407720'	271600	000040	        ADDI    CH," "                  ;CONVERT IT TO ASCII.
  5050	407721'	550614	002311'	        HRRZ    CH,TAB2(CH)             ;TO THE OUTPUT SET.
  5051	407722'	260740	407334'	        GOSUB   PUT                     ;INTO OUTPUT BUFFER.
  5052	407723'	346340	407717'	        AOJN    P2,WRITE0               ;CONTINUE FOR ALL.
  5053	407724'	260740	407344'	        GOSUB   EMPTY                   ;WRITE THE LABEL.
  5054	407725'	554315	000006	        HLRZ    P1,MSIZ(OM)             ;GET TRUE OUTPUT POINTER.
  5055	407726'	137300	414212'	        DPB     P1,[POINT 6,OBUF+1,11]  ;RESET IT.
  5056	407727'	262740	000311'	        UNSAVE  OBUF+2                  ;RESTORE THE COUNTER.
  5057	407730'	254000	407626'	        GOTO    REVIVE                  ;GET THE RIGHT TABLES BACK.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 90
MAGCON.MAC	 6-JUL-77 09:25		*** ERROR MESSAGES ***

  5058				SUBTTL                          *** ERROR MESSAGES ***
  5059
  5060	407731'	550200	000656'	NOUSE:  HRRZ    T2,CCLFLG               ;POINTER TO DEVICE BLOCK.
  5061	407732'	254000	407735'	        GOTO    QUES                    ;TYPE ERROR MESSAGE.
  5062	407733'	334200	414603'	NOOUSE: SKIPA   T2,[OFILE]              ;GET DATA INDEX.
  5063	407734'	201200	000032'	NOIUSE: MOVEI   T2,IFILE                ;GET DATA INDEX.
  5064	407735'	051140	413642'	QUES:   EME     .STR,[ASCIZ "? "]       ;FOR BATCH.
  5065	407736'	260740	407754'	        GOSUB   NAMIT                   ;TELL HIM THE DEVICE IN ERR.
  5066	407737'	051140	414604'	        EME     .STR,[ASCIZ " CAN'T BE USED."]
  5067	407740'	254000	410003'	        GOTO    CLEAR1                  ;ANOTHER CHANCE FOR HIM.
  5068
  5069	407741'	256000	407735'	NODEV:  XCT     QUES                    ;FOR BATCH.
  5070	407742'	551223	777776	        HRRZI   T2,@-2(T1)              ;GET POINTER TO DEVICE NAME.
  5071	407743'	260740	407754'	NODEV1: GOSUB   NAMIT                   ;PRINT ITS NAME.
  5072	407744'	051140	414610'	        EME     .STR,[ASCIZ " IS NOT AVAILABLE."]
  5073	407745'	254000	410003'	        GOTO    CLEAR1                  ;CLEAR THE FLAGS AND EXIT.
  5074
  5075	407746'	256000	407735'	NOEXT:  XCT     QUES                    ;FOR BATCH.
  5076	407747'	551163	777774	        HRRZI   T1,@-4(T1)              ;GET POINTER TO DEVICE NAME.
  5077	407750'	201203	777777	        MOVEI   T2,-DEVICE(T1)          ;GET POINTER TO DATA AREA.
  5078	407751'	260740	407754'		GOSUB   NAMIT                   ;TELL ME WHAT IT IS.
  5079	407752'	051140	414614'	        EME     .STR,[ASCIZ " DOESN'T EXIST."]
  5080	407753'	254000	410003'	        GOTO    CLEAR1                  ;BYE..BYE..
  5081
  5082	407754'	051140	414620'	NAMIT:  EME     .STR,[ASCIZ /DEVICE "/] ;FOR CLEARNESS.
  5083	407755'	200144	777777	        MOVE    T1,CHAN(T2)             ;GET THE CHANNEL NUMBER.
  5084	407756'	047140	000064	        MME     T1,.NAM                 ;GET THE REAL NAME.
  5085	407757'	200144	000001	        MOVE    T1,DEVICE(T2)           ;GET THE NAME WE HAVE.
  5086	407760'	260740	410705'	        GOSUB   PUTSIX                  ;PRINT IT.
  5087	407761'	051140	414622'	        EME     .STR,[ASCIZ /"/]        ;DELIMIT DEVICE NAME.
  5088	407762'	263740	412060'	        RETURN  ZERO                    ;BACK TO SENDER.
  5089
  5090	407763'	256000	407735'	NOOUT:  XCT     QUES                    ;FOR BATCH.
  5091	407764'	201200	000001'	        MOVEI   T2,OFILE                ;GET THE DATA INDEX.
  5092	407765'	260740	407754'	        GOSUB   NAMIT                   ;TELL HIM ITS NAME.
  5093	407766'	254000	410256'	        GOTO    NOOUT1                  ;TELL HIM NO OUTPUT.
  5094	407767'	256000	407735'	NOINP:  XCT     QUES                    ;FOR BATCH.
  5095	407770'	201200	000032'	        MOVEI   T2,IFILE                ;GET THE DATA INDEX.
  5096	407771'	260740	407754'	        GOSUB   NAMIT                   ;PRINT ITS NAME.
  5097	407772'	254000	410257'	        GOTO    NOINP1                  ;TELL HIM NO INPUT.
  5098
  5099	407773'	051140	414623'	OPERR:  EME     .STR,[ASCIZ "? OUTPUT"] ;SAY IT IS OUTPUT ERROR.
  5100	407774'	254000	410305'	        GOTO    PARERR                  ;THEN SAY THE REST.
  5101	407775'	051140	414625'	IPERR:  EME     .STR,[ASCIZ "? INPUT"]  ;SAY INPUT ERROR.
  5102	407776'	254000	410305'	        GOTO    PARERR                  ;THEN TELL THE REST.
  5103
  5104	407777'	051140	414627'	HADERR: EME     .STR,[ASCIZ "? UNRECOVERABLE I/O ERROR STATUS "]
  5105	410000'	211240	000006	        MOVNI   T3,^D6                  ;NUMBER OF DIGITS TO PLACE.
  5106	410001'	246140	777756	        LSHC    T1,-^D18                ;SHIFT STATUS INTO T2.
  5107	410002'	265440	411354'	        JSP     P4,OCTOUT+1             ;PRINT IT.
  5108	410003'	402000	000000	CLEAR1: SETZM   S                       ;CLEAR S.
  5109	410004'	254000	410415'	        GOTO    ERREXT                  ;AND RESTART.
  5110
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 90-2
MAGCON.MAC	 6-JUL-77 09:25		*** ERROR MESSAGES ***

  5111				;HERE TO CHECK ERROR ON LOOKUP FOR OUTPUT FILE. (DO IT IN UPDATE MODE)
  5112				;ONLY FILE NOT FOUND IS AN ACCEPTABLE ERROR.
  5113	410005'	550140	000005'	CHKLOK: HRRZ    T1,OFILE+EXT            ;GET ERROR CODE
  5114	410006'	326140	410010'	        JUMPN   T1,NOOPN                ;FOUND A READ ERROR ON OLD FILE.
  5115	410007'	263740	412060'	        RETURN  ZERO                    ;ALL IS WELL - RETURN
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 91
MAGCON.MAC	 6-JUL-77 09:25		*** ERROR MESSAGES ***

  5116				;HERE TO TELL WHY WE COULDN'T CREATE OR READ A FILE.
  5117
  5118	410010'	201500	000001'	NOOPN:  MOVEI   SIDE,OFILE              ;GET THE INDEX.
  5119	410011'	550140	000005'	        HRRZ    T1,OFILE+EXT            ;GET THE ERROR INDEX.
  5120	410012'	326140	410017'	        JUMPN   T1,NOFILE+1             ;JUMP IF O.K.
  5121	410013'	201140	777776	        MOVEI   T1,-TWO                 ;SET MESSAGE RIGHT.
  5122	410014'	542140	000005'	        HRRM    T1,OFILE+EXT            ;SAVE IT.
  5123	410015'	334000	000000	        SKIPA                           ;SKIP INTO GOODNESS.
  5124	410016'	201500	000032'	NOFILE: MOVEI   SIDE,IFILE              ;GET THE INDEX TO DATA.
  5125	410017'	262752	000006	        UNSAVE  PPN(SIDE)               ;RESTORE PPN WORD.
  5126	410020'	051140	413642'	        EME     .STR,[ASCIZ "? "]       ;GIVE ERROR SIGNAL.
  5127	410021'	260740	410036'	        GOSUB   TYPE                    ;TYPE THE MESSAGE.
  5128	410022'	402000	000000	        SETZM   S                       ;CLEAR ERROR BITS.
  5129	410023'	254000	410416'	        GOTO    ERR2                    ;AND EXIT.
  5130
  5131				;HERE IF A FILE CAN'T BE ACCESSED.
  5132
  5133	410024'	603100	200000	MAYBE:  IF.OFF  IF,DSK                  ;SKIP IF NOT DISK.
  5134	410025'	606100	007300	        IF.OFF  IF,WILD,NOFILE          ;IF NOT WILD JUMP.
  5135	410027'	262740	000040'	        UNSAVE  IFILE+PPN               ;RESTORE THE PPN.
  5136	410030'	200440	000041'	        MOVE    P4,IFILE+MOD            ;GET THE MOD BITS.
  5137	410031'	620440	007300	        OFF     P4,WILD                 ;TURN OFF WILD BITS.
  5138	410032'	201500	000032'	        MOVEI   SIDE,IFILE              ;INDEX TO DATA BASE.
  5139	410033'	051140	414636'	WARN:   EME     .STR,[ASCIZ "% "]       ;FLASH A WARNING.
  5140	410034'	260740	410037'	        GOSUB   TYPEIT                  ;TYPE THE ERROR.
  5141	410035'	254000	411203'	        GOTO    NXTDSK          ;MUST BE DSK.
  5142
  5143				;HERE TO TYPE DEV:FILENAME.EXT(USERNAME) ERROR MESSAGE.
  5144
  5145	410036'	200452	000007	TYPE:   MOVE    P4,MOD(SIDE)            ;GET THE MOD BITS.
  5146	410037'	051140	414637'	TYPEIT: EME     .STR,[ASCIZ /FILE "/]   ;A LITTLE IDENTIFIER.
  5147	410040'	260740	410063'	TYPE0:  GOSUB   TYPNAM                  ;TYPE DEV:FILENAME.EXT(USERNAME).
  5148	410041'	051140	414622'	        EME     .STR,[ASCIZ /"/]        ;FINISH IT OFF.
  5149	410042'	570312	000004	        HRRE    P1,EXT(SIDE)            ;GET THE ERROR CODE.
  5150	410043'	303300	000027	        CAILE   P1,ERRCNT               ;SEE IF IN RANGE.
  5151	410044'	201300	000027	        MOVEI   P1,ERRCNT               ;SET OUR OWN.
  5152	410045'	200306	410175'	        MOVE    P1,ERRMES(P1)           ;GET POINTER TO STRING.
  5153	410046'	051146	000000	        EME     .STR,ZERO(P1)           ;TELL WHY.
  5154	410047'	254000	410441'	        GOTO    CRLF                    ;SKIP A LINE AND EXIT.
  5155
  5156				;HERE WHEN WE CAN'T OPEN THE CCL FILE.
  5157
  5158	410050'	200452	000007	NOCCL:  MOVE    P4,MOD(SIDE)            ;GET THE MOD BITS.
  5159	410051'	602440	007300	        IF.ON   P4,WILD,NOCCL0          ;JUMP IF WILD BITS WERE ON.
  5160	410053'	402000	000000	        SETZM   S                       ;CLEAR STATUS REGISTER.
  5161	410054'	550500	000656'	        HRRZ    SIDE,CCLFLG             ;GET THE POINTER TO FILE NAME.
  5162	410055'	256000	407735'	        XCT     QUES                    ;FOR BATCH.
  5163	410056'	260740	410037'	        GOSUB   TYPEIT                  ;PRINT MESSAGE.
  5164	410057'	265140	401712'	        JSP     T1,CCLBAK               ;BACK UP POINTER.
  5165	410060'	255000	410416'	        NOP     ERR2                    ;WHERE TO GO.
  5166	410061'	201300	414641'	NOCCL0: MOVEI   P1,[ASCIZ "? ILLEGAL CCL FILE NAME."]
  5167	410062'	254000	410374'	        GOTO    FSTEOL                  ;TYPE THE MESAGE.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 92
MAGCON.MAC	 6-JUL-77 09:25		*** ERROR MESSAGES ***

  5168				;HERE TO TYPE DEV:NAME.EXT(USERNAME)
  5169
  5170	410063'	200152	777777	TYPNAM: MOVE    T1,CHAN(SIDE)           ;GET THE CHANNEL NUMBER.
  5171	410064'	047140	000064	        MME     T1,.NAM                 ;GET ITS REAL NAME.
  5172	410065'	200152	000001	        MOVE    T1,DEVICE(SIDE)         ;MME FAILED.
  5173	410066'	602440	001000	        IF.OFF  P4,WDEV                 ;SKIP IF TRUE DEVICE.
  5174	410067'	205140	120000	        MOVSI   T1,'*  '                ;FLAG WILD DEVICE.
  5175	410070'	260740	410705'	        GOSUB   PUTSIX                  ;PRINT ITS NAME.
  5176	410071'	051040	414646'	        EME     .CH,[EXP ":"]           ;TO SIGNIFY DEVICE.
  5177	410072'	200312	000003	TYPNM0: MOVE    P1,NAME(SIDE)           ;GET THE FILE NAME.
  5178	410073'	200352	000004	        MOVE    P2,EXT(SIDE)            ;GET THE EXTENSION.
  5179	410074'	200152	000001	        MOVE    T1,DEVICE(SIDE)         ;GET THE DEVICE.
  5180	410075'	047140	000004	        MME     T1,.DEV                 ;GET THE CHARACTERISTICS.
  5181	410076'	607140	200000	        IF.ON   T1,DSK                  ;SKIP IF DSK.
  5182	410077'	402012	000006	        SETZM   PPN(SIDE)               ;CLEAR PPN WORD.
  5183	410100'	602440	000100	        IF.OFF  P4,WNAME                ;SKIP IF TRUE NAME.
  5184	410101'	205300	120000	        MOVSI   P1,'*  '                ;ELSE USE A WILD CHARACTER.
  5185	410102'	602440	000200	        IF.OFF  P4,WEXT                 ;SKIP IF TRUE EXTENSION.
  5186	410103'	205340	120000	        MOVSI   P2,'*  '                ;SET WILD CHARACTER.
  5187	410104'	260740	410714'	        GOSUB   PUTNAM                  ;PRINT THE NAME.
  5188	410105'	554312	000006	        HLRZ    P1,PPN(SIDE)            ;GET THE PROJECT NUMBER.
  5189	410106'	606440	006000	        IF.ON   P4,WP!WPN               ;SKIP IF WILD PPN.
  5190	410107'	322300	412060'	        JUMPE   P1,RET0                 ;JUMP IF NONE.
  5191	410110'	051040	414647'	        EME     .CH,[EXP "("]           ;START OF PPN WORD.
  5192	410111'	200352	000006	        MOVE    P2,PPN(SIDE)            ;GET PPN
  5193	410112'	260740	410130'	        GOSUB   GETUNM          ;GET USER NAME IN UNAME
  5194	410113'	200140	000406'	        MOVE    T1,UNAME                ;GET FIRST HALF
  5195	410114'	260740	410705'	        GOSUB   PUTSIX          ;AND OUTPUT IT
  5196	410115'	200140	000407'	        MOVE    T1,UNAME+1              ;GET SECOND HALF
  5197	410116'	260740	410705'	        GOSUB   PUTSIX          ;AND OUTPUT IT
  5198	410117'	051040	414650'	        EME     .CH,[EXP ")"]           ;FINISH THE PPN WORD.
  5199	410120'	263740	412060'	        RETURN  ZERO                    ;RETURN TO CALLER.
  5200
  5201	410121'	001040	414307'	NAMOUT: UME     .ASC,[ASCIZ "   "]
  5202	410122'	200340	000633'	        MOVE    P2,LABPPN               ;GET THIS PPN
  5203	410123'	260740	410130'	        GOSUB   GETUNM                  ;AND GET THE USER NAME
  5204	410124'	001100	000406'	        UME     .SIX,UNAME
  5205	410125'	001100	000407'	        UME     .SIX,UNAME+1
  5206	410126'	001040	414651'	        UME     .ASC,[ASCIZ"    "]
  5207	410127'	263740	412060'	        RETURN  ZERO
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 93
MAGCON.MAC	 6-JUL-77 09:25		*** ERROR MESSAGES ***

  5208				;HERE TO GET USER NAME FOR A PPN IN P2
  5209	410130'	515140	000037	GETUNM: HRLZI   T1,37           ;A SIXBIT QUESTION MARK IN CASE WE FAIL.
  5210	410131'	202140	000406'	        MOVEM   T1,UNAME
  5211	410132'	402000	000407'	        SETZM   UNAME+1
  5212	410133'	041400	000017	        INIT    JF,17           ;INIT SYS IN DUMP MODE
  5213	410134'	637163	000000	        SIXBIT  /SYS/
  5214	410135'	000000	000000	        0
  5215	410136'	263740	412060'	        RETURN  ZERO
  5216	410137'	515140	446554	        HRLZI   T1,(SIXBIT/DUL/)
  5217	410140'	515200	637163	        HRLZI   T2,(SIXBIT/SYS/)
  5218	410141'	400240	000000	        SETZ    T3,
  5219	410142'	200300	001032'	        MOVE    T4,SYSPP
  5220	410143'	076400	000003	        LOOKUP  JF,T1           ;LOOKUP DUL.SYS
  5221	410144'	263740	412060'	        RETURN  ZERO
  5222	410145'	200140	000007	        MOVE    T1,P2           ;GET PPN
  5223	410146'	231140	000145	        IDIVI   T1,^D101        ;HASH IT
  5224	410147'	271200	000001	        ADDI    T2,1            ;GET CURSOR POSITION
  5225	410150'	074420	000004	GETOV:  USETI   JF,@T2          ;SET UP TO READ FROM THAT BLOCK
  5226	410151'	066400	001033'	        INPUT   JF,DULLST       ;DO IT...
  5227	410152'	063400	776000	        STATZ   JF,776000       ;CHECK FOR ERRORS
  5228	410153'	263740	412060'	        RETURN  ZERO
  5229	410154'	400140	000000	        SETZ    T1,
  5230	410155'	336203	001035'	DULNXT: SKIPN   T2,DULBLK(T1)
  5231	410156'	263740	412060'	        RETURN  ZERO
  5232	410157'	331000	000004	        SKIPL   ,T2
  5233	410160'	254000	410163'	        GOTO    .+3
  5234	410161'	553200	000000	        HRRZS   T2,
  5235	410162'	254000	410150'	        GOTO    GETOV
  5236	410163'	312200	000007	        CAME    T2,P2           ;DO WE HAVE RIGHT PPN?
  5237				        GOTO    [ADDI T1,3
  5238	410164'	254000	414652'	                GOTO    DULNXT]
  5239	410165'	071400	000000	        RELEASE JF,
  5240	410166'	200203	001036'	        MOVE    T2,DULBLK+1(T1)
  5241	410167'	202200	000406'	        MOVEM   T2,UNAME        ;SAVE FIRST HALF
  5242	410170'	200203	001037'	        MOVE T2,DULBLK+2(T1)
  5243	410171'	202200	000407'	        MOVEM T2,UNAME+1        ;SAVE SECOND HALF
  5244	410172'	263740	412060'	        RETURN  ZERO
  5245
  5246	001032'			        USE DATA
  5247	001032'	000001	000004	SYSPP:  XWD 1,4         ;SYS
  5248	001033'	777600	001034'	DULLST: IOWD    200,DULBLK
  5249	001034'	000000	000000	        0
  5250	001035'			BSS     DULBLK,200
  5251
  5252	410173'			        USE CODE
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 94
MAGCON.MAC	 6-JUL-77 09:25		*** ERROR MESSAGES ***

  5253	410173'	000000	414654'	        [ASCIZ " IS AN ILLEGAL FILE NAME."]             ; (-2)
  5254	410174'	000000	414662'	        [ASCIZ " IS NON-EXISTENT."]                             ;(-1)
  5255	410175'	000000	414666'	ERRMES: [ASCIZ " IS NOT SAVED."]                                ; (0)
  5256	410176'	000000	414671'	        [ASCIZ " HAS NO UFD."]                                  ; (1)
  5257	410177'	000000	414674'	        [ASCIZ " PROTECTION FAILURE."]                          ; (2)
  5258	410200'	000000	414701'	        [ASCIZ " IS BEING MODIFIED."]                           ; (3)
  5259	410201'	000000	414705'	        [ASCIZ " UNKNOWN EXECUTIVE ERROR RETURN."]              ; (4)
  5260	410202'	000000	414705'	        [ASCIZ " UNKNOWN EXECUTIVE ERROR RETURN."]              ; (5)
  5261	410203'	000000	414714'	        [ASCIZ " HAS A RIB ERROR."]                             ; (6)
  5262	410204'	000000	414705'	        [ASCIZ " UNKNOWN EXECUTIVE ERROR RETURN."]              ; (7)
  5263	410205'	000000	414705'	        [ASCIZ " UNKNOWN EXECUTIVE ERROR RETURN."]              ; (10)
  5264	410206'	000000	414705'	        [ASCIZ " UNKNOWN EXECUTIVE ERROR RETURN."]              ; (11)
  5265	410207'	000000	414705'	        [ASCIZ " UNKNOWN EXECUTIVE ERROR RETURN."]              ; (12)
  5266	410210'	000000	414705'	        [ASCIZ " UNKNOWN EXECUTIVE ERROR RETURN."]              ; (13)
  5267	410211'	000000	414720'	        [ASCIZ " NO ROOM ON FILE STRUCTURE."]                   ; (14)
  5268	410212'	000000	414726'	        [ASCIZ " STRUCTURE IS WRITE-LOCKED."]                   ; (15)
  5269	410213'	000000	414734'	        [ASCIZ " EXECUTIVE TABLE SPACE EXCEEDED."]              ; (16)
  5270	410214'	000000	414705'	        [ASCIZ " UNKNOWN EXECUTIVE ERROR RETURN."]              ; (17)
  5271	410215'	000000	414705'	        [ASCIZ " UNKNOWN EXECUTIVE ERROR RETURN."]              ; (20)
  5272	410216'	000000	414743'	        [ASCIZ " CAN'T SUPERSEDE AN EXISTING DIRECTORY."]       ; (21)
  5273	410217'	000000	414705'	        [ASCIZ " UNKNOWN EXECUTIVE ERROR RETURN."]              ; (22)
  5274	410220'	000000	414753'	        [ASCIZ " IS MISSING AN SFD IN IT'S PATH."]              ; (23)
  5275	410221'	000000	414762'	        [ASCIZ " HAS NO SEARCH LIST."]                          ; (24)
  5276	410222'	000000	414767'	        [ASCIZ " WILL NEST TOO DEEPLY."]                        ; (25)
  5277	410223'	000000	414774'	        [ASCIZ " HAS NO WRITABLE FILE STRUCTURE."]              ; (26)
  5278	410224'	000000	414705'	        [ASCIZ " UNKNOWN EXECUTIVE ERROR RETURN."]              ; (27)
  5279			000027	ERRCNT==.-ERRMES-1
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 95
MAGCON.MAC	 6-JUL-77 09:25		*** ERROR MESSAGES ***

  5280	410225'	051140	415003'	NOHELP: EME     .STR,[ASCIZ /% CAN'T PROVIDE HELP FOR "/]
  5281	410226'	200140	001701'	        MOVE    T1,HFILE                ;GET THE NAME WANTED.
  5282	410227'	260740	410705'	        GOSUB   PUTSIX                  ;PRINT IT.
  5283	410230'	254000	410353'	        GOTO    BACK                    ;EXIT.
  5284	410231'	334300	415024'	BADFOM: SKIPA   P1,[[ASCIZ "? RECORD SIZE NON-ZERO WITH CARRIAGE-RETURNS IN FILE."]]
  5285	410232'	201300	415025'	NOCOM:  MOVEI   P1,[ASCIZ "? NO COMMAND TO PERFORM."]
  5286	410233'	254000	410306'	        GOTO    CLEAR
  5287	410234'	663000	000010	BADCHR: TNO     S,BAD,RET0              ;ONLY ONE BAD CHARACTER PER LINE.
  5288	410236'	334300	415042'	        SKIPA   P1,[[ASCIZ "? ILLEGAL COMMAND SYNTAX CHARACTER."]]
  5289	410237'	201300	415043'	NOMAKE: MOVEI   P1,[ASCIZ "? CAN'T CREATE TABLES."]
  5290	410240'	254000	410374'	        GOTO    FSTEOL
  5291	410241'	071240	000000	NOTAB:  RELEASE DF,ZERO
  5292	410242'	402000	002721'	        SETZM   DFFLG
  5293	410243'	334300	415057'	        SKIPA   P1,[[ASCIZ "? CAN'T FIND CONVERSION TABLES."]]
  5294	410244'	201300	415060'	NOIREC: MOVEI   P1,[ASCIZ "? NEED RECORD SWITCH FOR INPUT SPECIFICATIONS."]
  5295	410245'	254000	410306'	        GOTO    CLEAR
  5296	410246'	334300	415100'	COMERR: SKIPA   P1,[[ASCIZ "? CAN'T UNDERSTAND COMMAND."]]
  5297	410247'	201300	415101'	PPNERR: MOVEI   P1,[ASCIZ "? INCORRECT PROJECT-PROGRAMMER NUMBER."]
  5298	410250'	254000	410374'	        GOTO    FSTEOL
  5299	410251'	334300	415121'	IMPSW:  SKIPA   P1,[[ASCIZ "? ILLEGAL SWITCH IN COMMAND STRING."]]
  5300	410252'	201300	415122'	SWERR:  MOVEI   P1,[ASCIZ "? SWITCH APPEARS TWICE IN SAME SPECIFICATIONS."]
  5301	410253'	254000	410374'	        GOTO    FSTEOL
  5302	410254'	201300	415134'	FOMERR: MOVEI   P1,[ASCIZ "? BAD MODIFIER FOR SWITCH."]
  5303	410255'	254000	410374'	        GOTO    FSTEOL
  5304	410256'	334300	415146'	NOOUT1: SKIPA   P1,[[ASCIZ " CAN'T DO OUTPUT."]]
  5305	410257'	201300	415147'	NOINP1: MOVEI   P1,[ASCIZ " CAN'T DO INPUT."]
  5306	410260'	254000	410306'	        GOTO    CLEAR
  5307	410261'	334300	415161'	DDTERR: SKIPA   P1,[[ASCIZ "? DEBUGGER IS NOT LOADED."]]
  5308	410262'	201300	415162'	LOCK:   MOVEI   P1,[ASCIZ "? OUTPUT DEVICE IS WRITE LOCKED."]
  5309	410263'	254000	410306'	        GOTO    CLEAR
  5310	410264'	334300	415202'	NOTLAB: SKIPA   P1,[[ASCIZ "? FORMAT ERROR IN LABEL ON OUTPUT DEVICE."]]
  5311	410265'	201300	415203'	BLKERR: MOVEI   P1,[ASCIZ "? BLOCKING FACTOR OR RECORD SIZE INCORRECTLY SPECIFIED."]
  5312	410266'	254000	410410'	        GOTO    ERR1
  5313	410267'	334300	415231'	NOOREC: SKIPA   P1,[[ASCIZ "? NEED RECORD SWITCH FOR OUTPUT SPECIFICATIONS."]]
  5314	410270'	201300	415232'	NOCORE: MOVEI   P1,[ASCIZ "? INSUFFICIENT MEMORY FOR OPERATION."]
  5315	410271'	254000	410306'	        GOTO    CLEAR
  5316	410272'	201300	415242'	EOTERR: MOVEI   P1,[ASCIZ "? EOT ENCOUNTERED BEFORE COMPLETING COMMAND."]
  5317	410273'	254000	410306'	        GOTO    CLEAR
  5318	410274'	201300	415253'	NOROOM: MOVEI   P1,[ASCIZ "? QUOTA, RIB, OR FILE STRUCTURE CAPACITY EXCEEDED."]
  5319	410275'	254000	410306'	        GOTO    CLEAR
  5320	410276'	334300	415276'	BADMOD: SKIPA   P1,[[ASCIZ "? OCTAL MODE CAN'T BE USED WITH LIST."]]
  5321	410277'	201300	415277'	MOD0ER: MOVEI   P1,[ASCIZ "? IMAGE OR OCTAL OUTPUT IS REQUIRED WITH IMAGE INPUT."]
  5322	410300'	254000	410306'	        GOTO    CLEAR
  5323	410301'	334300	415321'	NOOCT:  SKIPA   P1,[[ASCIZ "? OCTAL IS AN OUTPUT ONLY MODE."]]
  5324	410302'	201300	415322'	IOERR:  MOVEI   P1,[ASCIZ "? INPUT DEVICE I/O ERROR."]
  5325	410303'	254000	410306'	        GOTO    CLEAR
  5326	410304'	334300	415342'	SAMDEV: SKIPA   P1,[[ASCIZ "? CAN'T USE SAME MAG-TAPE FOR INPUT AND OUTPUT."]]
  5327	410305'	201300	415343'	PARERR: MOVEI   P1,[ASCIZ " CHECKSUM OR PARITY ERROR ENCOUNTERED."]
  5328	410306'	402000	000000	CLEAR:  SETZM   S
  5329	410307'	254000	410410'	        GOTO    ERR1
  5330	410310'	211140	000001	NOWLD:  MOVNI   T1,ONE                  ;INDEX FOR MESSAGE.
  5331	410311'	542140	000036'	        HRRM    T1,IFILE+EXT            ;SAVE THE INDEX.
  5332	410312'	261740	000040'	        SAVE    IFILE+PPN               ;SO ERROR ROUTINE WORKS RIGHT.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 95-2
MAGCON.MAC	 6-JUL-77 09:25		*** ERROR MESSAGES ***

  5333	410313'	254000	410016'	        GOTO    NOFILE                  ;TELL HIM IT DOESN'T EXIST.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 96
MAGCON.MAC	 6-JUL-77 09:25		*** ERROR MESSAGES ***

  5334	410314'	256000	407735'	CANLST: XCT     QUES                    ;FOR BATCH.
  5335	410315'	201200	000032'	        MOVEI   T2,IFILE                ;POINTER TO THINGS.
  5336	410316'	260740	407754'	        GOSUB   NAMIT                   ;NAME THE DEVICE.
  5337	410317'	051140	415353'	        EME     .STR,[ASCIZ " HAS NO DIRECTORY."]
  5338	410320'	254000	410003'	        GOTO    CLEAR1                  ;EXIT.
  5339
  5340	410321'	260740	410366'	NOLAB:  GOSUB   QW                      ;FLASH A ? OR %.
  5341	410322'	201300	415357'	        MOVEI   P1,[ASCIZ "FORMAT ERROR IN LABEL ON INPUT DEVICE."]
  5342	410323'	254000	410410'	        GOTO    ERR1
  5343	410324'	602100	000700	BADEOF: IF.ON   IF,WNAME!WEXT!SCAN,RET0 ;RETURN IF WILD OR SCANNING.
  5344	410326'	201300	415367'	BADTM:  MOVEI   P1,[ASCIZ "? UNEXPECTED FILE MARK ENCOUNTERED WHILE READING LABEL."]
  5345	410327'	254000	410410'	        GOTO    ERR1                    ;TELL OF THE ERROR.
  5346	410330'	602100	000700	BADVOL: IF.OFF  IF,WNAME!WEXT!SCAN
  5347	410331'	254003	000000	        GOTO    ZERO(T1)                ;RETURN FOR WILD CARDS.
  5348	410332'	260740	410366'	        GOSUB   QW                      ;FLASH A ? OR %.
  5349	410333'	051140	415403'	        EME     .STR,[ASCIZ /VOLUME NUMBER IS "/]
  5350	410334'	200140	000635'	        MOVE    T1,LABVOL               ;GET THE NUMBER IN ERROR.
  5351	410335'	260740	410705'	        GOSUB   PUTSIX                  ;PRINT NUMBER WE FOUND.
  5352	410336'	051140	415407'	        EME     .STR,[ASCIZ /" SHOULD BE "/]
  5353	410337'	200140	000047'	        MOVE    T1,IFILE+VOL            ;GET CORRECT VOLUME NUMBER.
  5354	410340'	260740	410705'	        GOSUB   PUTSIX                  ;PRINT IT.
  5355	410341'	254000	410353'	        GOTO    BACK                    ;EXIT...
  5356
  5357	410342'	260740	410366'	NOMAT:  GOSUB   QW                      ;FLASH A ? OF %.
  5358	410343'	051140	415412'	        EME     .STR,[ASCIZ /LABEL-ID OF "/]
  5359	410344'	200300	000630'	        MOVE    P1,LABNAM               ;GET FIRST HALF OF ID.
  5360	410345'	200340	000631'	        MOVE    P2,LABNAM+1             ;GET THE SECOND HALF.
  5361	410346'	260740	410714'	        GOSUB   PUTNAM                  ;TYPE THE ID.
  5362	410347'	051140	415415'	        EME     .STR,[ASCIZ /" DOESN'T MATCH FILE-ID OF "/]
  5363	410350'	200300	000035'	        MOVE    P1,IFILE+NAME           ;COPY FILE NAME.
  5364	410351'	200340	000036'	        MOVE    P2,IFILE+EXT            ;COPY EXTENSION.
  5365	410352'	260740	410714'	        GOSUB   PUTNAM                  ;PRINT THE NAME.
  5366	410353'	201300	415423'	BACK:   MOVEI   P1,[ASCIZ /"./]         ;FORMAT.
  5367	410354'	254000	410410'	        GOTO    ERR1                    ;START AGAIN.
  5368
  5369				;HERE TO SKIP A FILE.
  5370
  5371	410355'	660100	000020	SKPFIL: ON      IF,NOERROR              ;NO ERRORS WHILE SKIPPING.
  5372	410356'	660000	000200	        ON      S,NI.ERR                ;GET A RETURN ON ANY EOF.
  5373	410357'	260740	412330'	SKP0:   GOSUB   CHKOPR                  ;CHECK FOR COMMAND.
  5374	410360'	260740	407174'	        GOSUB   FILL                    ;DON'T DO A DRIVE BECAUSE TAPE
  5375	410361'	334000	000000	        SKIPA                           ;COULD HAVE TAPE MARKS WRITTEN
  5376	410362'	254000	410357'	        GOTO    SKP0                    ;IN THE SAME PARITY AS THE TAPE.
  5377	410363'	200100	000041'	        MOVE    IF,IFILE+MOD            ;RESET THE MODE BITS.
  5378	410364'	620000	000200	        OFF     S,NI.ERR                ;NORMAL RETURNS ON EOF.
  5379	410365'	263740	412060'	        RETURN  ZERO                    ;RETURN TO CALLER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 97
MAGCON.MAC	 6-JUL-77 09:25		*** ERROR MESSAGES ***

  5380				;HERE TO TYPE A QUESTION MARK OR A PERCENT SIGN.
  5381
  5382	410366'	201140	407735'	QW:     MOVEI   T1,QUES                 ;IF FATAL.
  5383	410367'	602000	000400	        IF.OFF  S,HDR                   ;SKIP IF HEADER LABEL.
  5384	410370'	201140	410033'	        MOVEI   T1,WARN                 ;IF NOT FATAL.
  5385	410371'	256003	000000	        XCT     ZERO(T1)                ;PRINT SOMETHING.
  5386	410372'	263740	412060'	        RETURN  ZERO                    ;RETURN.
  5387	410373'	201300	415424'	TOODEP: MOVEI   P1,[ASCIZ "% COMMAND FILES NESTED TOO DEEPLY -- COMMAND IGNORED."]
  5388
  5389				;HERE ON AN ERROR MESSAGE WHEN PROCESSING A COMMAND.
  5390
  5391	410374'	661000	000010	FSTEOL: ON      S,BAD                   ;SET ERROR BITS.
  5392	410375'	261740	000371'	        SAVE    SPCCNT                  ;SAVE THE SPACE COUNT.
  5393	410376'	606000	000040	        IF.ON   S,EOL                   ;ARE WE THERE ALREADY.
  5394	410377'	260740	402457'	        GOSUB   GETONE                  ;FIND END OF LINE.
  5395	410400'	606000	000040	        IF.ON   S,EOL                   ;IS IT END OF LINE.
  5396	410401'	254000	410377'	        GOTO    .-2                     ;NO TRY AGAIN.
  5397	410402'	402000	000000	        SETZM   S                       ;CLEAR SO WE DON'T GET CONFUSED.
  5398	410403'	262740	000003	        UNSAVE  T1                      ;GET THE COUNT BACK.
  5399	410404'	363140	410407'	        SOJLE   T1,ERR0                 ;JUMP IF AT CORRECT POSTION.
  5400	410405'	051040	413551'	        EME     .CH,[EXP " "]           ;TAB TO POSITION.
  5401	410406'	254000	410404'	        GOTO    .-2                     ;CONTINUE TO TAB.
  5402	410407'	051140	415437'	ERR0:   EME     .STR,[BYTE (7)"^",15,12,0];POINT TO ERROR.
  5403	410410'	051600	000000	ERR1:   ENABLE  TTY                     ;LET HIM SEE ERRORS.
  5404	410412'	051146	000000	        EME     .STR,ZERO(P1)           ;SEND MESSAGE.
  5405	410413'	332000	000411'	        SKIPE   TABLST                  ;IF FLAG  IS SET...
  5406	410414'	260740	410444'	        GOSUB   LISTAB                  ;GO TO LIST OPTIONS.
  5407	410415'	260740	410441'	ERREXT: GOSUB   CRLF                    ;SKIP A LINE.
  5408	410416'	337000	000660'	ERR2:   SKIPG   DIAFLG                  ;SKIP IF IN DIALOG MODE.
  5409	410417'	254000	410432'	        GOTO    ERR3                    ;NOT IN DIALOG MODE.
  5410	410420'	336000	000645'	        SKIPN   KLUDGE                  ;HORRIBLE KLUDGE TO FIX STACK
  5411	410421'	200740	415440'	        MOVE    PDP,[IOWD PDPSIZ-1,STACK+1];SAVE TOP ELEMEMT.
  5412	410422'	332000	000645'	        SKIPE   KLUDGE                  ;MAKE SURE WE GET BACK TO SETUP1
  5413	410423'	200740	415441'	        MOVE    PDP,[IOWD PDPSIZ-2,STACK+2] ;SAVE TOP TWO ELEMENTS
  5414	410424'	402000	000645'	        SETZM   KLUDGE
  5415	410425'	332000	000670'		SKIPE	RPTFLG
  5416	410426'	253000	000017		AOBJN	PDP
  5417	410427'	255000	000000		JFCL
  5418	410430'	256000	410441'	        XCT     CRLF                    ;SKIP A LINE.
  5419	410431'	254020	000660'	        GOTO    @DIAFLG                 ;GIVE ERROR RETURN.
  5420	410432'	606000	000400	ERR3:   IF.OFF  S,HDR,NODEL             ;ARE WE CHECKING MULTI-REEL LABELS.
  5421	410434'	254000	412057'	        RETURN  ONE                     ;YES GIVE SKIP RETURN.
  5422	410435'	607040	200000	NODEL:  IF.OFF  OF,DSK,NTHERE   ;JUMP IF A CLOSE DOES NOTHING.
  5423	410437'	070040	000000	        CLOSE   OF,ZERO                 ;PUT THE FILE ON THE DEVICE.
  5424	410440'	254000	400057'	        GOTO    NTHERE                  ;START ALL OVER AGAIN.
  5425	410441'	051140	414243'	CRLF:   EME     .STR,[BYTE (7)15,12,0]  ;SEND CRLF.
  5426	410442'	402000	000436'		SETZM	COLUMN
  5427	410443'	263740	412060'	        RETURN  ZERO                    ;VANISH....
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 98
MAGCON.MAC	 6-JUL-77 09:25		*** ERROR MESSAGES ***

  5428				;HERE TO LIST TABLE OF OPTIONS.
  5429
  5430	410444'	260740	410441'	LISTAB: GOSUB   CRLF                    ;OUTPUT A CRLF
  5431	410445'	260740	410441'	        GOSUB   CRLF                    ;AND ANOTHER
  5432	410446'	051140	415442'	        EME     .STR,[ASCIZ "OPTIONS ARE:"]
  5433	410447'	200200	000410'	        MOVE    T2,TABPTR               ;GET POINTER TO TABLE
  5434	410450'	260740	410441'	        GOSUB   CRLF                    ;OUTPUT A CRLF
  5435	410451'	200144	000000	        MOVE    T1,ZERO(T2)             ;GET NEXT  WORD FROM TABLE
  5436	410452'	260740	410705'	        GOSUB   PUTSIX                  ;AND OUTPUT IT.
  5437	410453'	253200	410450'	        AOBJN   T2,.-3                  ;IF MORE, KEEP GOING...
  5438	410454'	263740	412060'	        RETURN  ZERO                    ;IF DONE, RETURN
  5439				;HERE ON A CONTROL C INTERCEPT.
  5440
  5441	410455'	331140	000656'	CTLC:   SKIPL   T1,CCLFLG               ;SKIP IF IN CCL FILE.
  5442	410456'	254000	410464'	        GOTO    CTLC0                   ;ELSE CARRY ON.
  5443	410457'	553000	000003	        HRRZS   T1                      ;SO A GOOD COMPARE CAN BE DONE.
  5444	410460'	307140	000674'	        CAIG    T1,CCLBLK+1             ;DONE ALL BUT ONE.
  5445	410461'	553000	000656'	        HRRZS   CCLFLG                  ;YES.
  5446	410462'	265140	401712'	        JSP     T1,CCLBAK               ;BACK UP POINTER.
  5447	410463'	255000	410455'	        NOP     CTLC                    ;POINTER FOR RETURN.
  5448	410464'	603040	200000	CTLC0:  IF.OFF  OF,DSK          ;SKIP IF CLOSE DOES NOTHING.
  5449	410465'	070040	000040	        CLOSE   OF,.NODEL               ;DON'T DELETE OUTPUT.
  5450	410466'	332000	000402'	        SKIPE   RUNFLG                  ;SKIP IF RUNNING.
  5451	410467'	260740	410441'	        GOSUB   CRLF                    ;SKIP A LINE.
  5452	410470'	332000	000402'	        SKIPE   RUNFLG                  ;SKIP IF NOT RUNNING.
  5453	410471'	051140	415445'	        PRINT   (***Job aborted)
  5454	410472'	402000	000436'	        ;TELL HIM WHAT HE DID.
  5455	410473'	476000	000003	        SETOM   T1                      ;FLAG OUR TTY.
  5456	410474'	051300	000003	        EME     .LTP,T1                 ;GET TTY BITS.
  5457	410475'	335000	000003	        SKIPGE  T1                      ;SKIP IF NOT PTY.
  5458	410476'	254000	400172'	        GOTO    STOP                    ;TO EASE THE MIND OF BATCH.
  5459	410477'	254000	400057'	        GOTO    NTHERE                  ;GO FLASH READY.
  5460	410500'	051600	000000	STOPIT: ENABLE  TTY                     ;LET HIM SEE WHAT HE DID.
  5461	410502'	051140	415451'	        PRINT   (stop)
  5462	410503'	402000	000436'	                  ;HERE TO STOP BEFORE WE PLANNED.
  5463	410504'	254000	410435'	        GOTO    NODEL                   ;GO CLOSE THE OUTPUT FILE.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 99
MAGCON.MAC	 6-JUL-77 09:25		*** ERROR MESSAGES ***

  5464				;HERE WHEN SOMETHING UNIMAGINABLE HAS
  5465				;HAPPENED TO US AND WE CAN'T CONTINUE.
  5466				;BECASUE OF A PROGRAM BUG....
  5467
  5468	410505'	051600	000000	ABORT:  ENABLE  TTY                     ;CLEAR GARBAGE.
  5469	410507'	256000	410441'	        XCT     CRLF                    ;DON'T FORGET FORMAT.
  5470	410510'	202740	000515'	        MOVEM   17,AC+17                ;SAVE AC 17.
  5471	410511'	551740	000476'	        HRRZI   17,AC                   ;SET UP BLT POINTER.
  5472	410512'	251740	000514'	        BLT     17,AC+16                ;SAVE THE ACS.
  5473	410513'	200740	000515'	        MOVE    17,AC+17                ;RESTORE AC 17.
  5474	410514'	051140	415453'	ABORT1: EME     .STR,[ASCIZ "***SYSTEM ABORT AT "]
  5475	410515'	262740	000004	        UNSAVE  T2                      ;GET ERROR ADDRESS BACK.
  5476	410516'	370000	000004	        SOS     T2                      ;BACK UP TO ERROR LOCATION.
  5477	410517'	265440	411353'	        JSP     P4,OCTOUT               ;PRINT IT.
  5478	410520'	256000	410441'	        XCT     CRLF                    ;LITTLE FORMAT...
  5479	410521'	402000	000004	        SETZM   T2                      ;CLEAR AN INDEX.
  5480	410522'	551140	000011	GSNAM:  HRRZI   T1,11                   ;GETTAB TABLE.
  5481	410523'	505144	000000	        HRLI    T1,ZERO(T2)             ;INDEX INTO TABLE.
  5482	410524'	047140	000041	        MME     T1,.TAB                 ;GET A WORD OF THE SYSTEM NAME.
  5483	410525'	255000	000000	        NOP                             ;IGNORE ERRORS.
  5484	410526'	202144	000523'	        MOVEM   T1,SYSNAM(T2)           ;SAVE IT.
  5485	410527'	350000	000004	        AOS     T2                      ;BUMP INDEX.
  5486	410530'	302200	000004	        CAIE    T2,4                    ;DONE THEM ALL???
  5487	410531'	254000	410522'	        GOTO    GSNAM                   ;NO KEEP GOING.
  5488	410532'	200200	000520'	        MOVE    T2,PRGNAM               ;GET OUR NAME.
  5489	410533'	202200	002735'	        MOVEM   T2,DMPFIL               ;SET NAME OF FILE.
  5490	410534'	200217	000001	        MOVE    T2,ONE(PDP)             ;GET ADDRESS OF CALL.
  5491	410535'	275200	000001	        SUBI    T2,ONE                  ;POINT TO CALL.
  5492	410536'	202200	000522'	        MOVEM   T2,PC                   ;SAVE THE LOCATION.
  5493	410537'	047140	000014	        MME     T1,.DATE                ;GET THE DATE.
  5494	410540'	202140	000516'	        MOVEM   T1,DATE                 ;SAVE IT.
  5495	410541'	047140	000023	        MME     T1,.TIME                ;GET THE TIME OF DAY.
  5496	410542'	202140	000517'	        MOVEM   T1,TIME                 ;SAVE THE TIME.
  5497	410543'	550140	407021*	        HRRZ    T1,JOBREL               ;GET LAST LOCATION LOADED.
  5498	410544'	275140	000137	        SUBI    T1,137                  ;JUST OUR STUFF.
  5499	410545'	210140	000003	        MOVN    T1,T1                   ;MAKE IT NEGATIVE.
  5500	410546'	506140	002742'	        HRLM    T1,DMPLST+1             ;SAVE IOW WORD.
  5501	410547'	050240	002732'	        OPEN    DF,DMPDEV               ;GET THE DEVICE.
  5502	410550'	254000	410556'	        GOTO    ABTEND                  ;FORGET IT IF ERROR.
  5503	410551'	077240	002735'	        ENTER   DF,DMPFIL               ;GET A FILE.
  5504	410552'	254000	410556'	        GOTO    ABTEND                  ;FORGET IT ON ERRORS.
  5505	410553'	620000	001000	        DEVOP   OUTPUT,DF,DMPLST        ;WRITE US OUT.
  5506	410556'	070240	000000	ABTEND: CLOSE   DF,ZERO                 ;PLACE US ON DISK.
  5507	410557'	071240	000000	        RELEASE DF,ZERO                 ;GET RID OF THE CHANNEL.
  5508	410560'	402000	002721'	        SETZM   DFFLG                   ;FLAG NO CHANNEL.
  5509	410561'	256000	410441'	        XCT     CRLF                    ;ONE MORE LINE DOWN PAGE.
  5510	410562'	051440	000000	        EME     .CLR,ZERO               ;CLEAR BUFFERS.
  5511	410563'	332140	400175*	        SKIPE   T1,JOBDDT               ;SKIP IF NO DDT.
  5512	410564'	254000	400177'	        GOTO    CALDDT                  ;ELSE GET IT HERE.
  5513	410565'	254000	400057'	        GOTO    NTHERE                  ;TRY AGAIN.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 100
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  5514				SUBTTL          *** UTILITY ROUTINES ***
  5515
  5516				;HERE FROM LOCATION 40 ON A USER MODE ENTRY (UME).
  5517
  5518	410566'	260740	412065'	UME0:   GOSUB   SAV2                    ;SAVE SOME AC'S.
  5519	410567'	200300	000000*	        MOVE    P1,JOBUUO               ;PICK UP THE UME.
  5520	410570'	135140	415457'	        LDB     T1,[POINT 4,P1,12]      ;GET THE AC FIELD.
  5521	410571'	306140	000001	        CAIN    T1,.ASC                 ;IS IT AN ASCII UME.
  5522	410572'	254000	410576'	        GOTO    UME1                    ;YES GO TO IT.
  5523	410573'	306140	000002	        CAIN    T1,.SIX                 ;IS IT A SIXBIT ONE.
  5524	410574'	254000	410603'	        GOTO    UME2                    ;YES GO TO IT.
  5525	410575'	260740	410505'	        GOSUB   ABORT                   ;ILLEGAL UME.
  5526
  5527				;HERE FOR AN ASCIZ STRING.
  5528
  5529	410576'	505300	440700	UME1:   HRLI    P1,(POINT 7,0)          ;SET UP A BYTE POINTER.
  5530	410577'	134600	000006	        ILDB    CH,P1                   ;GET AN ASCII CHARACTR.
  5531	410600'	322600	412060'	        JUMPE   CH,RET0                 ;A ZERO ENDS IT.
  5532	410601'	260740	410612'	        GOSUB   UME4                    ;CONVERT THE CHARACTER.
  5533	410602'	254000	410577'	        GOTO    UME1+1                  ;CONTINUE LOOP.
  5534
  5535				;HERE FOR ONE SIXBIT WORD.
  5536
  5537	410603'	505300	440600	UME2:   HRLI    P1,(POINT 6,0)          ;SET UP BYTE POINTER TO THE DATA.
  5538	410604'	134600	000006	UME3:   ILDB    CH,P1                   ;GET A CHARACTER.
  5539	410605'	201614	000040	        MOVEI   CH," "(CH)              ;CONVERT IT TO ASCII.
  5540	410606'	260740	410612'	        GOSUB   UME4                    ;CONVERT THE CHARACTER.
  5541	410607'	603300	770000	        IF.ON   P1,77B5,UME3            ;JUMP IF HAVE MORE.
  5542	410611'	263740	412060'	        RETURN  ZERO                    ;RETURN TO CALLER.
  5543
  5544				;HERE TO CONVERT THE CHARACTER.
  5545
  5546	410612'	550614	002311'	UME4:   HRRZ    CH,TAB2(CH)             ;TO THE OUTPUT SET.
  5547	410613'	602600	400000	        IF.OFF  CH,NEC                  ;SKIP IF GOOD CHARACTER.
  5548	410614'	350000	000361'	        AOS     NOCHR                   ;COUNT THE BAD CHARACTER.
  5549	410615'	622600	400000	        TEZ     CH,NEC                  ;WAS IT BAD.
  5550	410616'	550600	002445'	        HRRZ    CH,TAB2+"\"             ;GET THE DEFAULT.
  5551	410617'	602000	000010	        IF.ON   S,LHEAD,PUT             ;JUMP IF LPT HEADER.
  5552	410621'	254035	000002	        GOTO    @OUTC(OM)               ;AND WRITE IT.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 101
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  5553				;HERE TO SEND A DATE STAMP TO THE OUTPUT DEVICE.
  5554
  5555	410622'	047140	000014	PUTDAT: MME     T1,.DATE                ;GET THE DATE.
  5556	410623'	231140	000037	PUTXDT: IDIVI   T1,^D31                 ;GET THE DAYS INTO T2.
  5557	410624'	350000	000004	        AOS     T2                      ;THE CORRECT DAY.
  5558	410625'	261740	000004	        SAVE    T2                      ;SAVE IT.
  5559	410626'	231140	000014	        IDIVI   T1,^D12                 ;GET THE  MONTH IN T2.
  5560	410627'	350000	000004	        AOS     T2                      ;CORRECTED MONTH.
  5561	410630'	201143	000100	        MOVEI   T1,^D64(T1)             ;GET THE YEAR.
  5562	410631'	250157	000000	        EXCH    T1,ZERO(PDP)            ;PUT THE YEAR ON THE STACK.
  5563	410632'	261740	000003	        SAVE    T1                      ;THE DAYS ARE NEXT.
  5564	410633'	261740	000004	        SAVE    T2                      ;AND THEN THE MONTH.
  5565	410634'	201300	000057	        MOVEI   P1,"/"                  ;CHARACTER TO SEPARATE THINGS.
  5566	410635'	254000	410646'	        GOTO    PDTBUF                  ;MOVE TH PDL TO THE BUFFER.
  5567
  5568				;HERE TO SEND A TIME STAMP TO THE OUTPUT DEVICE.
  5569
  5570	410636'	047140	000023	PUTTIM: MME     T1,.TIME                ;GET THE TIME OF DAY.
  5571	410637'	231140	001750	        IDIVI   T1,^D1000               ;MSEC. IN T2.
  5572	410640'	231140	000074	        IDIVI   T1,^D60                 ;SECONDS IN T2.
  5573	410641'	261740	000004	        SAVE    T2                      ;ONTO THE STACK.
  5574	410642'	231140	000074	        IDIVI   T1,^D60                 ;MIN IN P2 HOURS IN P1.
  5575	410643'	261740	000004	        SAVE    T2                      ;MINUTES TO STACK.
  5576	410644'	261740	000003	        SAVE    T1                      ;HOURS TO THE STACK.
  5577	410645'	201300	000072	        MOVEI   P1,":"                  ;CHARACTER TO DELIMIT THINGS.
  5578
  5579				;HERE TO MOVE THE TOP THREE ELEMENTS OF THE STACK INTO THE BUFFER
  5580				;AS NUMBERS.
  5581
  5582	410646'	211340	000003	PDTBUF: MOVNI   P2,3                    ;TIMES TO DO IT.
  5583	410647'	262740	000004	PDTBU0: UNSAVE  T2                      ;GET AN ITEM.
  5584	410650'	260740	410655'	        GOSUB   ZPUT                    ;MOVE IT.
  5585	410651'	342340	412060'	        AOJE    P2,RET0                 ;JUMP IF DONE.
  5586	410652'	201606	000000	        MOVEI   CH,ZERO(P1)             ;GET THE DELIMITER.
  5587	410653'	260740	410612'	        GOSUB   UME4                    ;PLACE.
  5588	410654'	254000	410647'	        GOTO    PDTBU0                  ;DO THE NEXT ONE.
  5589	410655'	305200	000012	ZPUT:   CAIGE   T2,^D10                 ;IS IT BETTER THEN 10.
  5590	410656'	001040	415460'	        UME     .ASC,[ASCIZ "0"]        ;NO SO ADD A ZERO.
  5591	410657'	231200	000012	        IDIVI   T2,^D10                 ;SLICE OFF A DIGIT.
  5592	410660'	506257	000000	        HRLM    T3,ZERO(PDP)            ;SAVE A DIGIT.
  5593	410661'	332000	000004	        SKIPE   T2                      ;SKIP IF DONE.
  5594	410662'	260740	410657'	        GOSUB   .-3                     ;CONTINUE ON.
  5595	410663'	554617	000000	        HLRZ    CH,ZERO(PDP)            ;GET A DIGIT BACK.
  5596	410664'	201614	000060	        MOVEI   CH,"0"(CH)              ;CONVERT TO ASCII.
  5597	410665'	254000	410612'	        GOTO    UME4                    ;INTO THE BUFFER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 102
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  5598				;HERE TO PRINT P1 AS A THREE DIGIT NUMBER.
  5599
  5600	410666'	305300	000144	THEDIG: CAIGE   P1,^D100                ;DOES IT PASS.
  5601	410667'	051040	415461'	        EME     .CH,[EXP "0"]           ;PAD.
  5602
  5603				;HERE TO PRINT AC P1 AS A TWO DIGIT NUMBER.
  5604
  5605	410670'	305300	000012	TWODIG: CAIGE   P1,^D10                 ;IS IT LESS THEN 10.
  5606	410671'	051040	415461'	        EME     .CH,[EXP "0"]           ;YES ADD A ZERO.
  5607				                                        ;FALL INTO DECOUT.
  5608
  5609				;HERE TO PRINT P1 AS A DECIMAL NUMBER.
  5610
  5611	410672'	334400	413554'	DECOUT: SKIPA   P3,[^D10]               ;SET THE RADIX.
  5612	410673'	201400	000010	PUTOCT: MOVEI   P3,10                   ;SET THE RADIX.
  5613	410674'	200140	000006	        MOVE    T1,P1                   ;TO A BETTER AC.
  5614	410675'	230140	000010	        IDIV    T1,P3                   ;SLICE OFF A DIGIT.
  5615	410676'	506217	000000	        HRLM    T2,ZERO(PDP)            ;SAVE DIGIT.
  5616	410677'	332000	000003	        SKIPE   T1                      ;DONE YET.
  5617	410700'	260740	410675'	        GOSUB   PUTOCT+2                ;NO CONTINU.
  5618	410701'	554157	000000	        HLRZ    T1,ZERO(PDP)            ;COPY DIGIT.
  5619	410702'	201143	000060	        MOVEI   T1,"0"(T1)              ;CONVERT TO ASCII.
  5620	410703'	051040	000003	        EME     .CH,T1                  ;PRINT IT.
  5621	410704'	263740	412060'	        RETURN  ZERO                    ;TRY AGAIN.
  5622
  5623				;HERE TO PRINT T1 AS A SIXBIT WORD.
  5624
  5625	410705'	322140	412060'	PUTSIX: JUMPE   T1,RET0                 ;SUPPRESS TRAILING SPACES.
  5626	410706'	135600	415462'	        LDB     CH,[POINT 6,T1,5]       ;GET A CHARACTER.
  5627	410707'	201614	000040	        MOVEI   CH," "(CH)              ;CONVERT TO ASCII.
  5628	410710'	051040	000014	        EME     .CH,CH                  ;PRINT IT.
  5629	410711'	350000	000436'		AOS	COLUMN
  5630	410712'	242140	000006	        LSH     T1,6                    ;GET NEXT CHARACTER INTO POSITION.
  5631	410713'	254000	410705'	        GOTO    PUTSIX                  ;LOOP UNTIL DONE.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 103
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  5632				;HERE TO PRINT THE FILE NAME IN P1 AND P2.
  5633
  5634	410714'	513000	000007	PUTNAM: HLLZS   P2                      ;CLEAR THE RIGHT HALF.
  5635	410715'	316340	415463'	        CAMN    P2,[SIXBIT "UFD"]       ;IS THIS A UFD.
  5636	410716'	254000	410725'	        GOTO    PUTNM0                  ;YES.
  5637	410717'	200140	000006	        MOVE    T1,P1                   ;COPY TO BETTER AC.
  5638	410720'	260740	410705'	        GOSUB   PUTSIX                  ;PRINT IT.
  5639	410721'	332140	000007	        SKIPE   T1,P2                   ;TEST AND COPY.
  5640	410722'	051040	415464'	        EME     .CH,[EXP "."]           ;FOR EXTENSION.
  5641	410723'	350000	000436'		AOS	COLUMN
  5642	410724'	254000	410705'	        GOTO    PUTSIX                  ;PRINT IT.
  5643	410725'	051040	414647'	PUTNM0: EME     .CH,[EXP "("]           ;SIGNAL PPN COMING.
  5644	410726'	261740	000006	        SAVE    P1                      ;SAVE UFD NAME.
  5645	410727'	557000	000006	        HLRZS   P1                      ;GET HALF OF IT.
  5646	410730'	260740	410673'	        GOSUB   PUTOCT                  ;PRINT IT.
  5647	410731'	051040	415465'	        EME     .CH,[EXP ","]           ;SEPARATE P FROM PN.
  5648	410732'	262740	000006	        UNSAVE  P1                      ;GET IT BACK.
  5649	410733'	553000	000006	        HRRZS   P1                      ;ZERO LEFT HALF.
  5650	410734'	260740	410673'	        GOSUB   PUTOCT                  ;PRINT IT.
  5651	410735'	051140	415466'	        EME     .STR,[ASCIZ ").UFD"]    ;TELL THE REST.
  5652	410736'	200140	000436'		MOVE	T1,COLUMN
  5653	410737'	271140	000007		ADDI	T1,7
  5654	410740'	202140	000436'		MOVEM	T1,COLUMN
  5655	410741'	263740	412060'	        RETURN  ZERO                    ;RETURN TO CALLER.
  5656
  5657				;HERE TO BRANCH ON THE DEVICE TYPE.
  5658
  5659	410742'	603100	200000	WLDDEV: IF.ON   IF,DSK,RET0             ;DISK RETURN.
  5660	410744'	603100	000020	        IF.ON   IF,MTA,RET1             ;MAG-TAPE RETURN.
  5661	410746'	254000	412056'	        RETURN  TWO                     ;NON-DIRECTORY DEVICE.
  5662
  5663				;HERE ON THE INITIAL CALL TO FIND A FILE.
  5664
  5665	410747'	260740	412061'	LOKWLD: GOSUB   SAV4                    ;SAVE SOME AC'S.
  5666	410750'	260740	410742'	        BRANCH  WLDDEV,<WLDDSK,WLDMTA> ;BRANCH ON DEVICE.
  5667	410753'	620100	007700	        OFF     IF,WILD!SCAN            ;DEVICE DOESN'T HAVE WILDS.
  5668	410754'	620040	007700	        OFF     OF,WILD!SCAN            ;CLEAR WILD BITS.
  5669	410755'	254000	412057'	        RETURN  ONE                     ;AND SAY WE HAVE A FILE.
  5670
  5671				;HERE ON A CALL FOR A FILE WHEN WE HAVE ALREADY FOUND
  5672				;ONE ON THE DEVICE.
  5673
  5674	410756'	260740	412061'	GETNXT: GOSUB   SAV4                    ;SAVE SOME AC'S.
  5675	410757'	260740	410742'	        BRANCH  WLDDEV,<NXTDSK,WLDMTA> ;BRANCH ON DEVICE.
  5676	410762'	263740	412060'	        RETURN  ZERO                    ;OTHER DEVICES DON'T HAVE ANY.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 104
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  5677				;HERE TO FIND A FILE ON MAG-TAPE.
  5678
  5679	410763'	260740	407571'	WLDMTA: GOSUB   GETLAB                  ;GET A LABEL INTO CORE.
  5680	410764'	254000	411001'	        GOTO    WDMTA0                  ;END OF FILE FOUND.
  5681	410765'	260740	405242'	        BRANCH  INPLAB,<NXTBLK,NXTNAM>  ;BRANCH ON WHAT WE READ.
  5682	410770'	265140	410330'	        JSP     T1,BADVOL               ;BAD VOLUME FOUND.
  5683	410771'	606000	100000	        IF.OFF  S,L.HDR,NXTBLK          ;CHECK NEXT IF NOT HDR.
  5684	410773'	336140	000045'	        SKIPN   T1,IFILE+LABEL          ;GET THE LABEL INDEX.
  5685	410774'	254000	412057'	        RETURN  ONE                     ;TAPE IS AT THE RIGHT SPOT.
  5686	410775'	550143	412700'	        HRRZ    T1,LB.TYP(T1)           ;GET THE DISPATCH ADDRESS.
  5687	410776'	302140	405456'	        CAIE    T1,LB.ICL               ;IF NOT DEC LABEL TYPE
  5688	410777'	260740	410355'	        GOSUB   SKPFIL                  ;SKIP EOF MARK AFTER LABEL.
  5689	411000'	254000	412057'	        RETURN  ONE                     ;FOUND A FILE FOR HIM.
  5690
  5691	411001'	602100	000700	WDMTA0: IF.OFF  IF,WNAME!WEXT!SCAN      ;SKIP IF NOT SEARCHING.
  5692	411002'	263740	412060'	        RETURN  ZERO                    ;ELSE GIVE EOF RETURN.
  5693	411003'	332000	000045'	        SKIPE   IFILE+LABEL             ;SKIP IF NO LABEL TYPE.
  5694	411004'	254000	410326'	        GOTO    BADTM                   ;ELSE UNEXPECTED FILE MARK.
  5695	411005'	254000	412057'	        RETURN  ONE                     ;IGNORE FILE MARK.
  5696
  5697	411006'	606100	000700	NXTBLK: IF.ON   IF,WNAME!WEXT!SCAN      ;IF WILD OR SCANNING SKIP.
  5698	411007'	254000	410321'	        GOTO    NOLAB                   ;ELSE TELL BAD THINGS.
  5699	411010'	200140	000045'	NXTFIL: MOVE    T1,IFILE+LABEL          ;GET THE LABEL INDEX.
  5700	411011'	550143	412700'	        HRRZ    T1,LB.TYP(T1)           ;GET THE DISPATCH ADDRESS.
  5701	411012'	302140	405456'	        CAIE    T1,LB.ICL               ;SKIP IF DEC LABELS.
  5702	411013'	254000	411016'	        GOTO    SKPIT                   ;SKIP AHEAD.
  5703	411014'	602000	100000	        IF.ON   S,L.HDR,WLDMTA          ;IF NOT HEADER SKIP.
  5704	411016'	260740	410355'	SKPIT:  GOSUB   SKPFIL                  ;SKIP A FILE ON TAPE.
  5705	411017'	254000	410763'	        GOTO    WLDMTA                  ;AND CHECK FOR A LABEL.
  5706
  5707	411020'	606100	000700	NXTNAM: IF.OFF  IF,WNAME!WEXT!SCAN,NOMAT;JUMP IF NOT WILD OR SCANNING.
  5708	411022'	254000	411010'	        GOTO    NXTFIL                  ;ELSE GO TO THE NEXT FILE.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 106
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  5709				;HERE FOR A WILD CARD LOOKUP ON DISK.
  5710
  5711	411023'	200140	000033'	WLDDSK: MOVE    T1,IFILE+DEVICE         ;GET THE DEVICE NAMED.
  5712	411024'	200200	415470'	        MOVE    T2,[XWD ONE,T1]         ;POINTER FOR MME.
  5713	411025'	047200	000045	        MME     T2,.DCHR                ;GET THE CHARACTERISTICS OF IT.
  5714	411026'	254000	411043'	        GOTO    SYSDEV                  ;IF MME FAILS MUST BE SYS.
  5715	411027'	200140	000033'	        MOVE    T1,IFILE+DEVICE         ;GET THE DEVICE NAMED.
  5716	411030'	202140	001235'	        MOVEM   T1,PATH                 ;SAVE IT.
  5717	411031'	200140	415471'	        MOVE    T1,[XWD 5,PATH]         ;POINTER TO MME.
  5718	411032'	047140	000110	        MME     T1,.PATH                ;SEE IF REALLY SYS.
  5719	411033'	254000	411037'	        GOTO    TSTDEV                  ;ERROR CONTINUE ON.
  5720	411034'	200140	415472'	        MOVE    T1,[XWD 1,4]            ;SYS PPN.
  5721	411035'	316140	001237'	        CAMN    T1,PATH+2               ;IS THIS SYS.
  5722	411036'	254000	411043'	        GOTO    SYSDEV                  ;FLAG SYSTEM SEARCH.
  5723	411037'	607200	000007	TSTDEV: IF.OFF  T2,GDSK,GENDEV          ;JUMP IF GENERIC DISK.
  5724	411041'	200140	000033'	        MOVE    T1,IFILE+DEVICE         ;GET THE DEVICE NAMED.
  5725	411042'	254000	411101'	        GOTO    USEDEV                  ;AND USE IT.
  5726	411043'	476000	000401'	SYSDEV: SETOM   SYSSRH                  ;FLAG SYSTEM SEARCH.
  5727	411044'	476000	000400'	GENDEV: SETOM   SEARCH                  ;FLAG WE ARE SEARCHING.
  5728	411045'	336000	000400'	NXTSTR: SKIPN   SEARCH                  ;SKIP IF SEARCHING.
  5729	411046'	263740	412060'	        RETURN  ZERO                    ;ELSE WE ARE DONE.
  5730	411047'	336140	000377'	        SKIPN   T1,LSTDEV               ;GET THE LAST DEVICE USED.
  5731	411050'	476000	000003	        SETOM   T1                      ;IF NONE START FROM THE TOP.
  5732	411051'	332000	000401'	        SKIPE   SYSSRH                  ;SKIP IF THIS JOBS LIST.
  5733	411052'	254000	411065'	        GOTO    SYSLOK                  ;ELSE USE THE SYSTEM LIST.
  5734	411053'	602100	001000	        IF.ON   IF,WDEV,USEALL          ;USE EVERY DEVICE IF WILD DSK.
  5735	411055'	200200	415470'	        MOVE    T2,[XWD ONE,T1]         ;POINTER FOR MME.
  5736	411056'	047200	000047	        MME     T2,.JLST                ;GET A STRUCTURE.
  5737	411057'	263740	412060'	        RETURN  ZERO                    ;QUIT ON ERRORS.
  5738	411060'	254000	411076'	        GOTO    GOTDEV                  ;USE THIS DEVICE.
  5739	411061'	200140	000377'	USEALL: MOVE    T1,LSTDEV               ;GET THE LAST DEVICE USED.
  5740	411062'	047140	000046	        MME     T1,.ALST                ;GET THE NEXT ONE.
  5741	411063'	263740	412060'	        RETURN  ZERO                    ;RETURN ON ERROR.
  5742	411064'	254000	411076'	        GOTO    GOTDEV                  ;USE THE DEVICE.
  5743	411065'	202140	001456'	SYSLOK: MOVEM   T1,GOBLST+2             ;SAVE THE LAST DEVICE USED.
  5744	411066'	402000	001454'	        SETZM   GOBLST                  ;SPECIFY SYSTEM LIST.
  5745	411067'	200140	415472'	        MOVE    T1,[XWD 1,4]            ;SYSTEM PPN.
  5746	411070'	202140	000040'	        MOVEM   T1,IFILE+PPN            ;SET THE SYS PPN AS OURS.
  5747	411071'	202140	001455'	        MOVEM   T1,GOBLST+1             ;SAVE IT.
  5748	411072'	200140	415473'	        MOVE    T1,[XWD THREE,GOBLST]   ;POINTER FOR EXEC.
  5749	411073'	047140	000066	        MME     T1,.GLST                ;GET A STRUCTURE.
  5750	411074'	263740	412060'	        RETURN  ZERO                    ;QUIT ON ERRORS.
  5751	411075'	200140	001456'	        MOVE    T1,GOBLST+2             ;GET THE DEVICE NAME.
  5752	411076'	316140	413612'	GOTDEV: CAMN    T1,[-1]                 ;HAVE WE REACHED THE END.
  5753	411077'	263740	412060'	        RETURN  ZERO                    ;YES RETURN.
  5754	411100'	322140	412060'	        JUMPE   T1,RET0                 ;JUMP IF AT THE FENCE.
  5755	411101'	202140	000377'	USEDEV: MOVEM   T1,LSTDEV               ;SAVE AS THE LAST DEVICE USED.
  5756	411102'	202140	001461'	        MOVEM   T1,UFDDEV+1             ;SET IN PARAMETER BLOCK.
  5757	411103'	202140	001446'	        MOVEM   T1,MFDDEV+1             ;SAVE FOR THE MFD.
  5758	411104'	606100	006000	        IF.OFF  IF,WP!WPN,ONLUFD        ;IF NOT ACCROSS PPNS NO NEED FOR MFD.
  5759	411106'	050200	001445'	        OPEN    MF,MFDDEV               ;OPEN CHANNEL FOR THE MFD.
  5760	411107'	254000	411045'	        GOTO    NXTSTR                  ;DO NEXT IF THIS FAILS.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 107
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  5761				;HERE WHEN READY TO START ON A NEW UFD.
  5762
  5763	411110'	050140	001460'	ONLUFD: OPEN    UF,UFDDEV               ;OPEN THE DEVICE.
  5764	411111'	254000	411045'	        GOTO    NXTSTR                  ;IF ERROR GET THE NEXT.
  5765	411112'	336140	000040'	        SKIPN   T1,IFILE+PPN            ;PPN SPECIFIED.
  5766	411113'	047140	000024	        MME     T1,.PPN                 ;NO GET THE CURRENT ONE.
  5767	411114'	255000	000000	        NOP                             ;IN CASE OF JACCT.
  5768	411115'	332000	000401'	        SKIPE   SYSSRH                  ;IS IT REALLY THE SYSTEM PPN.
  5769	411116'	200140	415472'	        MOVE    T1,[XWD 1,4]            ;YES GET ITS PPN.
  5770	411117'	202140	000040'	        MOVEM   T1,IFILE+PPN            ;SAVE THE PPN.
  5771	411120'	606100	006000	        IF.OFF  IF,WP!WPN,OPNUFD        ;JUMP IF PPN ISN'T WILD.
  5772	411122'	200140	414576'	        MOVE    T1,[XWD ONE,ONE]        ;MFD PPN.
  5773	411123'	202140	001450'	        MOVEM   T1,MFDNAM               ;SAVE ITS NAME.
  5774	411124'	202140	001453'	        MOVEM   T1,MFDNAM+3             ;SAVE THE PPN OF THE OWNER.
  5775	411125'	205140	654644	        MOVSI   T1,'UFD'                ;THE MFD IS ITS OWN UFD.
  5776	411126'	202140	001451'	        MOVEM   T1,MFDNAM+1             ;SAVE THE EXTENSION.
  5777	411127'	402000	001452'	        SETZM   MFDNAM+2                ;CLEAR DATE TIME PROTECTION WORD.
  5778	411130'	076200	001450'	        LOOKUP  MF,MFDNAM               ;OPEN THE MFD.
  5779	411131'	254000	411316'	        GOTO    MFDERR                  ;ERROR ON LOOKUP.
  5780	411132'	373000	000474'	MFDWDS:	SOSLE	MFDCNT			;BUFFER EMPTY?
  5781	411133'	254000	411142'		JRST	MFDGET			;NO - GET NEXT ENTRY.
  5782	411134'	350000	000363'		AOS	%IO			;COUNT DEVICE ACCESSES.
  5783	411135'	200140	415474'		MOVE	T1,[33,,MF]		;SET UP AND READ A
  5784	411136'	043140	000465'		CHANIO	T1,MFDARG		;BUFFER FULL OF ENTRIES.
  5785	411137'	254000	411151'		GOTO	RDMFER			;EOF OR ERROR RETURN.
  5786	411140'	200140	000465'	MFDSET:	MOVE	T1,MFDARG		;RESET POINTER INTO MFDBUF.
  5787	411141'	202140	000475'		MOVEM	T1,MFDPTR
  5788	411142'	200160	000475'	MFDGET:	MOVE	T1,@MFDPTR		;GET A PPN.
  5789	411143'	350000	000475'		AOS	MFDPTR			;INCREMENT BUFFER POINTER,
  5790	411144'	350000	000475'		AOS	MFDPTR			;AND ONCE AGAIN.
  5791	411145'	254000	411162'		GOTO	OPNUFD			;GO OPEN THE UFD.
  5792	411146'	606100	006000	NXTPPN: IF.OFF  IF,WP!WPN,NXTSTR        ;JUMP IF NOT WILD PPN.
  5793	411150'	254000	411132'		GOTO	MFDWDS			;GET A UFD.
  5794	411151'	062200	000003	RDMFER:	GETSTS  MF,T1                   ;SLIGHT ERROR.
  5795	411152'	602140	020000	        IF.ON   T1,E.EOF,NXTSTR         ;IF DONE THEM ALL GET NEXT STR.
  5796	411154'	606100	000020	        IF.OFF  IF,NOERROR,IPERR        ;JUMP IF WANTS TO KNOW.
  5797	411156'	350000	000367'	        AOS     INPERR                  ;COUNT THE ERROR.
  5798	411157'	051140	415475'	        PRINT   (% Parity or checksum error reading MFD.)
  5799	411160'	402000	000436'
  5800	411161'	254000	411140'		JRST	MFDSET
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 108
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  5801				;HERE WITH A PPN TO USE IN T1.
  5802
  5803	411162'	202140	001463'	OPNUFD: MOVEM   T1,UFDNAM               ;SAVE THE NAME OF THE UFD.
  5804	411163'	202140	000633'	        MOVEM   T1,LABPPN               ;SAVE THE PPN.
  5805	411164'	205140	654644	        MOVSI   T1,'UFD'                ;UFD EXTENSION.
  5806	411165'	202140	001464'	        MOVEM   T1,UFDNAM+1             ;SAVE THE EXTENSION.
  5807	411166'	402000	001465'	        SETZM   UFDNAM+2                ;CLEAR DATE TIME PROTECTION WORD.
  5808	411167'	200140	414576'	        MOVE    T1,[XWD ONE,ONE]        ;MFD PPN.
  5809	411170'	202140	001466'	        MOVEM   T1,UFDNAM+3             ;SAVE THE PPN.
  5810	411171'	076140	001463'	        LOOKUP  UF,UFDNAM               ;OPEN THE DIRECTORY.
  5811	411172'	254000	411321'	        GOTO    UFDERR                  ;ERROR ON LOOKUP.
  5812	411173'	200140	000035'		MOVE	T1,IFILE+NAME		;GET DESIRED FILENAME AND
  5813	411174'	510200	000036'		HLLZ	T2,IFILE+EXT		;EXTENSION.  SET UP THE
  5814	411175'	124140	000455'		DMOVEM	T1,UFDARG+1		;REST OF THE ARGUMENT
  5815	411176'	403140	000004		SETZB	T1,T2			;BLOCK FOR THE CHANIO
  5816	411177'	124140	000457'		DMOVEM	T1,UFDARG+3		;CALL.  WE WILL BE
  5817	411200'	124140	000461'		DMOVEM	T1,UFDARG+5		;RETRIEVING THE FILE
  5818	411201'	402000	000463'		SETZM	UFDCNT			;NAME AND EXTENSION
  5819	411202'	254000	411205'		GOTO	UFDWDS			;ONLY.
  5820	411203'	606100	007300	NXTDSK: IF.OFF  IF,WILD,RET0            ;JUMP IF NOT WILD.
  5821				;
  5822				;  HERE FOR READING UFD ENTRIES (FILE NAMES)
  5823				;
  5824	411205'	373000	000463'	UFDWDS:	SOSLE	UFDCNT			;BUFFER EMPTY?
  5825	411206'	254000	411215'		GOTO	UFDGET			;NO - GET NEXT ENTRY.
  5826	411207'	350000	000363'		AOS	%IO			;COUNT NUMBER OF DEVICE ACCESSES.
  5827	411210'	200140	415506'		MOVE	T1,[33,,UF]		;SET UP AND READ
  5828	411211'	043140	000454'		CHANIO	T1,UFDARG		;A BUFFER FULL OF ENTRIES.
  5829	411212'	254000	411245'		GOTO	RDUFER			;EOF OR ERROR.
  5830	411213'	200140	000454'	UFDSET:	MOVE	T1,UFDARG		;SET UP POINTER INTO UFDBUF
  5831	411214'	202140	000464'		MOVEM	T1,UFDPTR		;WHICH CONTAINS UFD ENTRIES.
  5832	411215'	120320	000464'	UFDGET:	DMOVE	P1,@UFDPTR		;GET A NAME AND EXTENSION
  5833	411216'	124300	000630'		DMOVEM	P1,LABNAM		;AND SAVE THEM.
  5834	411217'	350000	000464'		AOS	UFDPTR			;INCREMENT BUFFER POINTER,
  5835	411220'	350000	000464'		AOS	UFDPTR			;AND AGAIN.
  5836	411221'	260740	411701'		GOSUB	MOVNAM			;SAVE NAME IF WILD SEARCH.
  5837	411222'	255000	000000		JFCL				;MUST ALWAYS RETURN+1.
  5838	411223'	200140	001461'	        MOVE    T1,UFDDEV+1             ;GET THE STRUCTURE'S NAME.
  5839	411224'	202140	000627'	        MOVEM   T1,LABSTR               ;SAVE THE NAME.
  5840	411225'	250140	000033'	        EXCH    T1,IFILE+DEVICE         ;MAKE IT HIS.
  5841	411226'	050100	000032'	        OPEN    IF,IFILE+STATUS         ;OPEN THIS STRUCTURE.
  5842	411227'	254000	411243'	        GOTO    DK0NXT                  ;SHOULD NEVER HAPPEN.
  5843	411230'	202140	000033'	        MOVEM   T1,IFILE+DEVICE         ;GIVE HIM HIS DEVICE BACK.
  5844	411231'	554156	000006	        HLRZ    T1,MSIZ(IM)             ;GET THE INPUT BYTE SIZE.
  5845	411232'	137140	414211'	        DPB     T1,[POINT 6,IBUF+1,11]  ;SET THE SIZE WE WANT.
  5846	411233'	200140	000646'	        MOVE    T1,IJOBFF               ;GET INPUT JOB FIRST FREE.
  5847	411234'	250140	407554*	        EXCH    T1,JOBFF                ;SET IT AS CURRENT.
  5848	411235'	261740	000003	        SAVE    T1                      ;SAVE FIRST FREE.
  5849	411236'	260740	407006'	        GOSUB   MONIBF                  ;GET SOME BUFFERS.
  5850	411237'	262740	411234*	        UNSAVE  JOBFF                   ;RESTORE FIRST FREE.
  5851	411240'	200140	001463'	        MOVE    T1,UFDNAM               ;GET THE PPN WE FOUND THIS IN.
  5852	411241'	202140	000040'	        MOVEM   T1,IFILE+PPN            ;SAVE THE PPN.
  5853	411242'	254000	411256'	        GOTO    OPNIT                   ;OPEN THE FILE.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 108-2
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  5854	411243'	202140	000033'	DK0NXT: MOVEM   T1,IFILE+DEVICE         ;REPLACE THE DEVICE.
  5855	411244'	254000	411045'	        GOTO    NXTSTR                  ;TRY THE NEXT STRUCTURE.
  5856	411245'	062140	000003	RDUFER:	GETSTS	UF,T1			;GET READ STATUS.
  5857	411246'	602140	020000		IF.ON	T1,E.EOF,NXTPPN		;IF EOF, GET NEXT PPN.
  5858	411250'	606100	000020		IF.OFF	IF,NOERROR,IPERR	;REPORT THE ERROR AND STOP
  5859	411252'	350000	000367'		AOS	INPERR			;IF THE USER WANTS IT, ELSE
  5860	411253'	051140	415507'		PRINT	(% Parity or checksum error reading UFD.)
  5861	411254'	402000	000436'
  5862	411255'	254000	411213'		GOTO	UFDSET			;REPORT, COUNT, AND TRY TO CONTINUE.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 109
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  5863				;HERE TO OPEN THE FILE THAT HAS BEEN SELECTED.
  5864
  5865	411256'	402000	000635'	OPNIT:  SETZM   LABVOL                  ;CLEAR VOLUME NUMBER.
  5866	411257'	332000	000064'	        SKIPE   FSTWRD                  ;SKIP IT NOT FAST LIST.
  5867	411260'	254000	412057'	        RETURN  ONE                     ;DON'T OPEN IT FOR FAST LIST.
  5868	411261'	261740	000040'	        SAVE    IFILE+PPN               ;SAVE THE PPN.
  5869	411262'	047140	000024	        CALLI   T1,24   ;GET PPN
  5870	411263'	255000	000000	        JFCL
  5871	411264'	316140	000040'	        CAMN    T1,IFILE+PPN
  5872	411265'	254000	411276'	        GOTO    OPN1
  5873	411266'	561140	777760	        HRROI   T1,-20
  5874	411267'	047140	000041	        GETTAB  T1,
  5875	411270'	400140	000000	        SETZ    T1,
  5876	411271'	603140	000012	        TLNE    T1,12
  5877	411272'	254000	411276'	        GOTO    OPN1
  5878	411273'	201140	000002	        MOVEI T1,2
  5879	411274'	542140	000036'	        HRRM    T1,IFILE+EXT
  5880	411275'	254000	410016'	        GOTO    NOFILE
  5881	411276'	076100	000035'	OPN1:   LOOKUP  IF,IFILE+NAME           ;OPEN THE FILE.
  5882	411277'	254000	410024'	        GOTO    MAYBE                   ;MAYBE STOP NOW.
  5883	411300'	574140	000040'	        HLRE    T1,IFILE+PPN            ;IF DSK THIS IS SIZE.
  5884	411301'	325140	411306'	        JUMPGE  T1,GOTSIZ               ;IF POSITIVE IT IS BLOCKS.
  5885	411302'	213000	000003	        MOVNS   T1                      ;GET THE POSITIVE WORDS.
  5886	411303'	231140	000200	        IDIVI   T1,200                  ;CONVERT TO BLOCKS.
  5887	411304'	332000	000004	        SKIPE   T2                      ;SKIP IF EVEN.
  5888	411305'	350000	000003	        AOS     T1                      ;ROUND UP.
  5889	411306'	262740	000040'	GOTSIZ: UNSAVE  IFILE+PPN               ;RESTORE THE PPN.
  5890	411307'	202140	000634'	        MOVEM   T1,LABSIZ               ;SAVE THE SIZE OF THE FILE.
  5891	411310'	200140	000037'	        MOVE    T1,IFILE+DATTIM         ;GET THE DATE, TIME, PROT WORD.
  5892	411311'	404140	415520'	        AND     T1,[EXP 777B8]          ;JUST THE PROTECTION BITS.
  5893	411312'	202140	000632'	        MOVEM   T1,LABDTW               ;SAVE IT FOR DISK.
  5894	411313'	135140	414405'	        LDB     T1,[POINT 12,IFILE+DATTIM,35] ;GET THE DATE.
  5895	411314'	542140	000632'	        HRRM    T1,LABDTW               ;SAVE IT.
  5896	411315'	254000	412057'	        RETURN  ONE                     ;GIVE GOOD RETURN.
  5897
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 110
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  5898				;HERE ON A MFD LOOKUP ERROR.
  5899
  5900	411316'	201500	001445'	MFDERR: MOVEI   SIDE,MFDDEV             ;GET POINTER TO THINGS.
  5901	411317'	260740	411324'	        GOSUB   DIRERR                  ;TELL OF ERROR.
  5902	411320'	254000	411045'	        GOTO    NXTSTR                  ;AND TRY NEXT STRUCTURE.
  5903
  5904				;HERE ON A UFD LOOKUP ERROR.
  5905
  5906	411321'	201500	001460'	UFDERR: MOVEI   SIDE,UFDDEV             ;GET POINTER TO THINGS.
  5907	411322'	260740	411324'	        GOSUB   DIRERR                  ;TYPE THE ERROR MESAGE.
  5908	411323'	254000	411146'	        GOTO    NXTPPN                  ;TRY AGAIN.
  5909
  5910				;HERE TO TYPE ERROR MESSAGES FOR MFD AND UFD LOOKUP ERRORS.
  5911
  5912	411324'	051140	415521'	DIRERR: EME     .STR,[ASCIZ /% DIRECTORY "/]
  5913	411325'	402000	000011	        SETZM   P4                      ;CLEAR FLAGS.
  5914	411326'	254000	410040'	        GOTO    TYPE0                   ;SEND THE MESSAGE.
  5915
  5916	001235'			        USE     DATA
  5917
  5918	001235'			BSS     PATH,5
  5919	001242'			BSS     UFDBUF,200
  5920	001442'	777600	001241'	UFDCTL: IOWD    200,UFDBUF
  5921	001443'			        BSS     ONE
  5922	001444'	000000	000004	        EXP     MF
  5923	001445'	000000	000017	MFDDEV: EXP     DMP
  5924	001446'			        BSS     TWO
  5925	001450'			BSS     MFDNAM,4
  5926	001454'			BSS     GOBLST,THREE
  5927	001457'	000000	000003	        EXP     UF
  5928	001460'	000000	000017	UFDDEV: EXP     DMP
  5929	001461'			        BSS     TWO
  5930	001463'			BSS     UFDNAM,4
  5931	001467'			BSS     MFDBUF,200
  5932	001667'	777600	001466'	MFDCTL: IOWD    200,MFDBUF
  5933	001670'			        BSS     ONE
  5934
  5935	411327'			        USE     CODE
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 111
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  5936				;HERE TO PLACE THE DATE INTO THE BUFFER AS
  5937				;YYMMDD.
  5938
  5939	411327'	231140	000037	COBDAT: IDIVI   T1,^D31                 ;DAYS INTO T2.
  5940	411330'	261740	000004	        SAVE    T2                      ;SAVE THE DAYS.
  5941	411331'	231140	000014	        IDIVI   T1,^D12                 ;MONTHS IN T2.
  5942	411332'	261740	000004	        SAVE    T2                      ;SAVE THE MONTH.
  5943	411333'	201143	000100	        MOVEI   T1,^D64(T1)             ;GET THIS YEAR.
  5944	411334'	260740	412004'	        GOSUB   DEPTWO                  ;INTO BUFFER.
  5945	411335'	262740	000003	        UNSAVE  T1                      ;GET THE MONTHS BACK.
  5946	411336'	350000	000003	        AOS     T1                      ;FOR THE ONE LOST.
  5947	411337'	260740	412004'	        GOSUB   DEPTWO                  ;ADD INTO BUFFER.
  5948	411340'	262740	000003	        UNSAVE  T1                      ;GET THE DAYS.
  5949	411341'	350000	000003	        AOS     T1                      ;COUNT EXTRA DAY.
  5950	411342'	254000	412004'	        GOTO    DEPTWO                  ;INTO BUFFER.
  5951
  5952				;HERE TO COPY THE NUMBER OF CHARACTERS SPECIFIED BY
  5953				;THE COUNT IN P3 AND POINTER IN P2 TO THE POINTER
  5954				;IN P1.
  5955
  5956	411343'	134600	000007	PLACE:  ILDB    CH,P2                   ;GET A CHARACTER.
  5957	411344'	136600	000006	        IDPB    CH,P1                   ;SAVE IT.
  5958	411345'	367400	411343'	        SOJG    P3,PLACE                ;DO THEM ALL.
  5959	411346'	263740	412060'	        RETURN  ZERO                    ;TO SENDER.
  5960
  5961				;HERE TO PLACE A FEW SPACES INTO THE LABEL
  5962				;BUFFER. PUTS SPACES BY THE POINTER IN P1 AND FOR THE COUNT
  5963				;IN P3.
  5964
  5965	411347'	402000	000014	SPACE:  SETZM   CH                      ;SET CH TO A SPACE.
  5966	411350'	136600	000006	ANYCHR: IDPB    CH,P1                   ;WRITE IT INTO THE BUFFER.
  5967	411351'	367400	411350'	        SOJG    P3,ANYCHR               ;CONTINUE ON.
  5968	411352'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  5969
  5970				;HERE TO PRINT T2 AS A TWELVE DIGIT OCTAL NUMBER.
  5971
  5972	411353'	211240	000014	OCTOUT: MOVNI   T3,^D12                 ;DUMP A WORD.
  5973	411354'	402000	000003	        SETZM   T1                      ;ZERO STORAGE.
  5974	411355'	246140	000003	        LSHC    T1,3                    ;GET A DIGIT.
  5975	411356'	201603	000060	        MOVEI   CH,"0"(T1)              ;CONVERT AND MOVE.
  5976	411357'	051040	000014	        EME     .CH,CH                  ;PRINT.
  5977	411360'	346240	411354'	        AOJN    T3,OCTOUT+1             ;CONTINUE FOR TWELVE.
  5978	411361'	051040	413551'	        EME     .CH,[EXP " "]           ;ADD A SPACE.
  5979	411362'	254011	000000	        GOTO    ZERO(P4)                ;RETURN TO CALLER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 112
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  5980				;HERE TO TYPE OUT THE DATE CONTAINED IN T1.
  5981
  5982	411363'	231140	000037	TYPDAT: IDIVI   T1,^D31                 ;GET THE DAYS IN T2.
  5983	411364'	261740	000004	        SAVE    T2                      ;SAVE THEM.
  5984	411365'	231140	000014	        IDIVI   T1,^D12                 ;GET THE MONTH IN T2
  5985	411366'	201143	000100	        MOVEI   T1,^D64(T1)             ;GET THE YEAR IN T1.
  5986	411367'	250157	000000	        EXCH    T1,ZERO(PDP)            ;PUT THE YEAR ON THE STACK.
  5987	411370'	261740	000003	        SAVE    T1                      ;PLACE THE DAY ON THE STACK.
  5988	411371'	201304	000001	        MOVEI   P1,ONE(T2)              ;MONTHS TO A BETTER AC.
  5989	411372'	260740	410670'	        GOSUB   TWODIG                  ;PRINT THE MONTH.
  5990	411373'	051040	414145'	        EME     .CH,[EXP "/"]           ;DELIMIT THE MONTH.
  5991	411374'	262740	000006	        UNSAVE  P1                      ;GET THE DAYS BACK.
  5992	411375'	201306	000001	        MOVEI   P1,ONE(P1)              ;SET THE DAYS RIGHT.
  5993	411376'	260740	410670'	        GOSUB   TWODIG                  ;PRINT THE DAY OF THE MONTH.
  5994	411377'	051040	414145'	        EME     .CH,[EXP "/"]           ;DELIMIT THE DAY.
  5995	411400'	262740	000006	        UNSAVE  P1                      ;GET THE YEAR.
  5996	411401'	254000	410670'	        GOTO    TWODIG                  ;PRINT THE YEAR.
  5997
  5998				;HERE TO TYPE THE TIME OF DAY CONTAINED IN T1.
  5999
  6000	411402'	231140	165140	TYPTIM: IDIVI   T1,^D60000              ;SLICE OFF MILLISECONDS.
  6001	411403'	231140	000074	        IDIVI   T1,^D60                 ;HOURS IN T1 MINUTES IN T2.
  6002	411404'	261740	000004	        SAVE    T2                      ;SAVE THE MINUTES.
  6003	411405'	200300	000003	        MOVE    P1,T1                   ;TO A BETTER AC.
  6004	411406'	260740	410670'	        GOSUB   TWODIG                  ;PRINT THE HOURS.
  6005	411407'	051040	414646'	        EME     .CH,[EXP ":"]           ;DELIMIT HOURS FROM SECONDS.
  6006	411410'	262740	000006	        UNSAVE  P1                      ;GET THE MINUTES BACK.
  6007	411411'	254000	410670'	        GOTO    TWODIG                  ;PRINT THE MINUTES.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 113
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6008				;HERE TO FILL IN DEFAULTS FOR THE LABELS.
  6009
  6010	411412'	202140	000632'	LABFIL: MOVEM   T1,LABDTW               ;SAVE THE LABEL DATE.
  6011	411413'	205140	446353	        MOVSI   T1,'DSK'                ;GET THE DEVICE.
  6012	411414'	202140	000627'	        MOVEM   T1,LABSTR               ;SAVE THE DEVICE.
  6013	411415'	201140	000057	        MOVEI   T1,057                  ;PROTECTION BITS.
  6014	411416'	137140	415524'	        DPB     T1,[POINT 8,LABDTW,8]   ;SET THE PROTECTION WORD.
  6015	411417'	336140	000007'	        SKIPN   T1,OFILE+PPN            ;IS TERE A PPN.
  6016	411420'	047140	000024	        MME     T1,.PPN                 ;USE THE CURRENT ONE.
  6017	411421'	255000	000000	        NOP                             ;IN CASE OF JACCT.
  6018	411422'	202140	000633'	        MOVEM   T1,LABPPN               ;SAVE THE PPN WORD.
  6019	411423'	254000	412057'	        RETURN  ONE                     ;GIVE GOOD LABEL RETURN.
  6020
  6021				;HERE TO TAKE A SIXBIT NUMBER CONTAINED IN T2
  6022				;AND CONVERT IT TO AN OCTAL NUMBER.
  6023
  6024	411424'	260740	412063'	TOBIN:  GOSUB   SAV3                    ;SAVE SOME AC'S.
  6025	411425'	201400	000010	        MOVEI   P3,10                   ;SET OCTAL RADIX.
  6026	411426'	254000	411431'	        GOTO    TOOCT1                  ;CONVERT IT.
  6027	411427'	260740	412063'	TOOCT:  GOSUB   SAV3                    ;SAVE SOME AC'S.
  6028	411430'	201400	000012	        MOVEI   P3,^D10                 ;SET RADIX TO TEN.
  6029	411431'	402000	000005	TOOCT1: SETZM   T3                      ;CLEAR RESULT.
  6030	411432'	434200	414433'	        IOR     T2,[SIXBIT "000000"]    ;ADD LEADING ZEROS.
  6031	411433'	200300	414432'	        MOVE    P1,[POINT 6,T2]         ;POINT TO DATA.
  6032	411434'	134340	000006	TOOCT0: ILDB    P2,P1                   ;GET A CHARACTER.
  6033	411435'	221250	000000	        IMULI   T3,ZERO(P3)             ;SHIFT LEFT FOR BASE.
  6034	411436'	271247	777760	        ADDI    T3,-'0'(P2)             ;ADD IN NEW DIGIT.
  6035	411437'	603300	770000	        IF.ON   P1,77B5,TOOCT0          ;JUMP IF MORE TO GO.
  6036	411441'	263740	412060'	        RETURN  ZERO                    ;ELSE RETURN TO CALLER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 114
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6037				;HERE TO TAKE THE DATE IN THE FORM YYMMDD IN T1
  6038				;AND CONVERT IT TO ((YEAR-1964)*12+(MONTH-1))*31+DAY-1.
  6039
  6040	411442'	135200	415525'	DATCOB: LDB     T2,[POINT 12,T1,11]     ;LOAD THE YEAR.
  6041	411443'	260740	411427'	        GOSUB   TOOCT                   ;MAKE IT OCTAL.
  6042	411444'	275240	000100	        SUBI    T3,^D64                 ;YEAR-1964.
  6043	411445'	221240	000014	        IMULI   T3,^D12                 ;(YEAR-1964)*12.
  6044	411446'	261740	000005	        SAVE    T3                      ;SAVE THE DATE SO FAR.
  6045	411447'	135200	415526'	        LDB     T2,[POINT 12,T1,23]     ;GET THE MONTH.
  6046	411450'	260740	411427'	        GOSUB   TOOCT                   ;CONVERT IT TO OCTAL.
  6047	411451'	262740	000004	        UNSAVE  T2                      ;GET THE ACCUMULATED DATE BACK.
  6048	411452'	271205	777777	        ADDI    T2,-ONE(T3)             ;(YEAR-1964)*12+(MONTH-1).
  6049	411453'	221200	000037	        IMULI   T2,^D31                 ;((YEAR-1964)*12+(MONTH-1))*31.
  6050	411454'	261740	000004	        SAVE    T2                      ;SAVE IT.
  6051	411455'	135200	415527'	        LDB     T2,[POINT 12,T1,35]     ;GET THE DAY.
  6052	411456'	260740	411427'	        GOSUB   TOOCT                   ;CONVERT IT TO OCTAL.
  6053	411457'	262740	000003	        UNSAVE  T1                      ;GET THE ACCUMULATED DATE BACK.
  6054	411460'	271145	777777	        ADDI    T1,-ONE(T3)             ;((YEAR-1964)*12+(MONTH-1))*31+DAY-1.
  6055	411461'	263740	412060'	        RETURN  ZERO                    ;COMPRESSED DATE IN T1.
  6056
  6057				;HERE TO TAKE THE DATE IN THE FORM YYDDD IN T1
  6058				;AND CONVERT IT TO ((YEAR-1964)*12+(MONTH-1))*31+DAY-1.
  6059
  6060	411462'	135200	415525'	DATBCL: LDB     T2,[POINT 12,T1,11]     ;GET THE YEAR.
  6061	411463'	260740	411427'	        GOSUB   TOOCT                   ;CONVERT TO OCTAL.
  6062	411464'	261740	000005	        SAVE    T3                      ;SAVE FOR LATER.
  6063	411465'	275240	000100	        SUBI    T3,^D64                 ;YEAR-1964.
  6064	411466'	221240	000014	        IMULI   T3,^D12                 ;(YEAR-1964)*12.
  6065	411467'	261740	000005	        SAVE    T3                      ;SAVE IT ON THE STACK.
  6066	411470'	135200	415530'	        LDB     T2,[POINT 18,T1,29]     ;COPY THE DAYS.
  6067	411471'	260740	411427'	        GOSUB   TOOCT                   ;CONVERT IT TO OCTAL.
  6068	411472'	515200	777765	        HRLZI   T2,-^D11                ;COUNTER FOR MONTH SCAN.
  6069	411473'	311244	412020'	        CAML    T3,MONTH+1(T2)          ;HAVE WE PASSED THE MONTH.
  6070	411474'	253200	411473'	        AOBJN   T2,.-1                  ;NO CONTINUE.
  6071	411475'	262740	000003	        UNSAVE  T1                      ;GET THE ACCUMULATED DATE BACK.
  6072	411476'	271144	777777	        ADDI    T1,-ONE(T2)             ;(YEAR-1964)*12+(MONTH-1).
  6073	411477'	221140	000037	        IMULI   T1,^D31                 ;((YEAR-1964)*12+(MONTH-1))*31.
  6074	411500'	274244	412016'	        SUB     T3,MONTH-1(T2)          ;DAYS IN THIS MONTH IN T3.
  6075	411501'	271145	777777	        ADDI    T1,-ONE(T3)             ;((YEAR-1964)*12+(MONTH-1))*31+DAY-1
  6076	411502'	307240	000073	        CAIG    T3,^D59                 ;SKIP IF PAST FEB.
  6077	411503'	254000	411510'	        GOTO    DATBL0                  ;JUMP IF NOT PAST FEB.
  6078	411504'	200217	000000	        MOVE    T2,ZERO(PDP)            ;GET THE YEAR BACK.
  6079	411505'	231200	000004	        IDIVI   T2,^D4                  ;SEE IF IT IS A LEAP YEAR.
  6080	411506'	336000	000005	        SKIPN   T3                      ;SKIP IF NOT.
  6081	411507'	370000	000003	        SOS     T1                      ;SUBTRACT OFF EXTRA DAY.
  6082	411510'	262740	000004	DATBL0: UNSAVE  T2                      ;CLEAN UP THE STACK.
  6083	411511'	263740	412060'	        RETURN  ZERO                    ;COMPRESSED DATE IN T1.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 115
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6084				;HERE TO CHECK FOR DEVICE ERRORS.
  6085
  6086	411512'	602140	400000	LOKERR: IF.ON   T1,E.LOK,LOCK           ;JUMP IF DEVICE IS WRITE LOCKED.
  6087	411514'	602140	200000	        IF.ON   T1,E.HAD,HADERR         ;JUMP IF HARDWARE ERROR.
  6088	411516'	602140	040000	        IF.ON   T1,E.IOB,BLKERR         ;JUMP IF USER ERROR.
  6089	411520'	260740	410505'	        GOSUB   ABORT                   ;IF NOT ONE OF THESE REAL BUG.
  6090
  6091				;HERE TO SEE IF WE HAVE READ AN EOF.
  6092
  6093	411521'	550440	000313'	BCLCHK: HRRZ    P4,IBUF+1               ;PICK UP POINTER TO DATA.
  6094	411522'	200443	000001	        MOVE    P4,ONE(T1)              ;GET DATA WORD.
  6095	411523'	312440	415531'	        CAME    P4,[XWD 170000,0]       ;IS IT AN EOF MARK.
  6096	411524'	316440	415532'	        CAMN    P4,[XWD 230000,0]       ;NINE TRACK EOF.
  6097	411525'	334000	000000	        SKIPA                           ;IT PASSED THAT.
  6098	411526'	254000	412057'	        RETURN  ONE                     ;FORGET IT.
  6099	411527'	550456	000006	        HRRZ    P4,MSIZ(IM)             ;GET THE BYTES PER WORD.
  6100	411530'	312440	000314'	        CAME    P4,IBUF+2               ;DID WE GET JUST THAT MANY.
  6101	411531'	254000	412057'	        RETURN  ONE                     ;NO -- MUST BE DATA.
  6102	411532'	047100	000010	        MME     IF,.IOSTP               ;WAIT FOR I/O TO STOP.
  6103	411533'	062100	000011	        GETSTS  IF,P4                   ;GET THE DEVICE STATUS.
  6104	411534'	602440	000040	        IF.ON   P4,SYNC,INPEND          ;IF SYNC'ED JUMP.
  6105	411536'	336440	000053'	        SKIPN   P4,IFILE+BUFNUM         ;GET THE NUMBER OF BUFFERS.
  6106	411537'	201440	000002	        MOVEI   P4,TWO                  ;DEFAULT NUMBER.
  6107	411540'	363440	407465'	BCLCK0: SOJLE   P4,INPEND               ;JUMP IF DONE ENOUGH.
  6108	411541'	072100	000007	        DRIVE   IF,.BSR                 ;BACK UP PLEASE.
  6109	411542'	072100	000000	        DRIVE   IF,.WAT                 ;WAIT FOR IT.
  6110	411543'	254000	411540'	        GOTO    BCLCK0                  ;DO IT AGAIN.
  6111
  6112				;HERE TO FUDGE UP THE IBM LABEL NAME.
  6113
  6114	411544'	402004	000000	COPY:   SETZM   ZERO(T2)                ;CLEAR TARGET.
  6115	411545'	361400	412060'	COPY0:  SOJL    P3,RET0                 ;JUMP IF READ ENOUGH.
  6116	411546'	134600	000003	        ILDB    CH,T1                   ;GET A CHARACTER.
  6117	411547'	322600	411557'	        JUMPE   CH,COPY1                ;ALLOW SPACES.
  6118	411550'	305600	000020	        CAIGE   CH,'0'                  ;IS IT BETTER THEN ZERO.
  6119	411551'	254000	411545'	        GOTO    COPY0                   ;NO IGNORE IT.
  6120	411552'	307600	000031	        CAIG    CH,'9'                  ;IS IT GREATER THEN NINE.
  6121	411553'	254000	411557'	        GOTO    COPY1                   ;A DIGIT IS LEGAL.
  6122	411554'	301600	000041	        CAIL    CH,'A'                  ;IS IT LESS THEN A.
  6123	411555'	303600	000072	        CAILE   CH,'Z'                  ;OR GREATER THEN Z.
  6124	411556'	254000	411545'	        GOTO    COPY0                   ;YES SO IGNORE.
  6125	411557'	136600	000004	COPY1:  IDPB    CH,T2                   ;SAVE THE CHARACTER.
  6126	411560'	367240	411545'	        SOJG    T3,COPY0                ;JUMP IF HAVE ROOM.
  6127	411561'	263740	412060'	        RETURN  ZERO                    ;ELSE RETURN.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 116
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6128				;HERE TO TELL HOW MANY CPU SECONDS AND HOW MANY TIMES
  6129				;WE ACCESSED A DEVICE.
  6130
  6131	411562'	260740	410441'	STAT:   GOSUB   CRLF                    ;YES SKIP A LINE.
  6132	411563'	047140	000023	        MME     T1,.TIME                ;GET TIME OF DAY
  6133	411564'	260740	411402'	        GOSUB   TYPTIM                  ;AND OUTPUT IT
  6134	411565'	260740	410441'	        GOSUB   CRLF                    ;...ANOTHER CRLF
  6135	411566'	402000	000006	        SETZM   P1                      ;SPECIFY THIS JOB.
  6136	411567'	047300	000027	        MME     P1,.TIM                 ;GET THE RUN TIME.
  6137	411570'	274300	000364'	        SUB     P1,%TIME                ;SUBTRACT START TIME.
  6138	411571'	231300	001750	        IDIVI   P1,^D1000               ;CONVERT TO SECONDS.
  6139	411572'	260740	410672'	        GOSUB   DECOUT                  ;PRINT THE SECONDS.
  6140	411573'	051040	415464'	        EME     .CH,[EXP "."]           ;DELIMIT THEM FROM FRACTIONS.
  6141	411574'	200300	000007	        MOVE    P1,P2                   ;MOVE TO BETTER AC.
  6142	411575'	260740	410666'	        GOSUB   THEDIG                  ;PRINT AS THREE DIGITS.
  6143	411576'	051140	415533'	        EME     .STR,[ASCIZ " SEC. "]   ;TELL HIM WHAT THAT WAS.
  6144	411577'	200300	000363'	        MOVE    P1,%IO                  ;GET I/O UNITS.
  6145	411600'	260740	410672'	        GOSUB   DECOUT                  ;PRINT THEM.
  6146	411601'	051140	415535'	        PRINT   ( I/O units.)
  6147	411602'	402000	000436'	           ;SO HE KNOWS WHAT WE ARE PRINTING.
  6148	411603'	550300	410543*	        HRRZ    P1,JOBREL               ;OCTAL LOCATIONS USED.
  6149	411604'	260740	410673'	        GOSUB   PUTOCT                  ;PRINT THEM.
  6150	411605'	051140	415540'	        PRINT   ( octal locations used.);SO HE KNOWS WHAT WE USED.
  6151	411606'	402000	000436'
  6152
  6153				;HERE TO TELL HOW MANY BLOCKS WE HAVE READ AND HOW MANY RECORDS
  6154				;THERE WERE IN THE BLOCKS.
  6155
  6156	411607'	200300	000353'		MOVE	P1,TIBCNT		;GET # TOTAL BLOCKS READ.
  6157	411610'	260740	410672'	        GOSUB   DECOUT                  ;PRINT THEM.
  6158	411611'	051140	414227'	        EME     .STR,[ASCIZ " BLK. "]   ;TELL HIM WHAT IT IS.
  6159	411612'	200300	000352'		MOVE	P1,TIRCNT		;GET # TOTAL RECORDS READ.
  6160	411613'	260740	410672'	        GOSUB   DECOUT                  ;SHOW IT TO HIM.
  6161	411614'	051140	414231'	        PRINT   ( rec. read.)
  6162	411615'	402000	000436'	           ;TELL HIM WHAT IT MEANS.
  6163
  6164				;HERE TO TELL HOW MANY BLOCKS WE WROTE AND HOW MANY
  6165				;RECORDS WERE IN THOSE BLOCKS.
  6166
  6167	411616'	200140	000041'	        MOVE    T1,IFILE+MOD            ;GET THE INPUT BITS.
  6168	411617'	606140	000300	        IF.OFF  T1,WNAME!WEXT,STAT88    ;JUMP IF INPUT ISN'T WILD.
  6169	411621'	200140	000010'	        MOVE    T1,OFILE+MOD            ;GET THE OUTPUT MOD BITS.
  6170	411622'	602140	000300	        IF.ON   T1,WNAME!WEXT,STAT9     ;MEANINGLESS IF WILD.
  6171	411624'	200300	000351'	STAT88: MOVE    P1,TOBCNT               ;GET TOTAL # BLOCKS WRITTEN.
  6172	411625'	260740	410672'	        GOSUB   DECOUT                  ;PRINT THEM.
  6173	411626'	051140	414227'	        EME     .STR,[ASCIZ " BLK. "]   ;TELL HIM WHAT HE JUST SAW.
  6174	411627'	200300	000350'	        MOVE    P1,TORCNT               ;GET TOTAL # RECORDS WRITTEN.
  6175	411630'	260740	410672'	        GOSUB   DECOUT                  ;PRINT THEM.
  6176	411631'	051140	414244'	        PRINT   ( rec. written.)
  6177	411632'	402000	000436'	        ;SO HE KNOWS WHAT HE SEES.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 117
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6178				;HERE TO TELL HOW MANY FILES WE HAVE LOOKED AT.
  6179
  6180	411633'	200300	000365'	STAT9:  MOVE    P1,IFCNT                ;GET THE INPUT FILE COUNT.
  6181	411634'	571346	777777	        HRREI   P2,-1(P1)               ;ONLY IF MORE THEN ONE.
  6182	411635'	323340	411641'	        JUMPLE  P2,STAT6                ;JUMP IF NOT MORE.
  6183	411636'	260740	410672'	        GOSUB   DECOUT                  ;TELL HOW MANY.
  6184	411637'	051140	415545'	        PRINT   ( input files read.)
  6185	411640'	402000	000436'	    ;SO HE KNOWS.
  6186	411641'	200300	000366'	STAT6:  MOVE    P1,OFCNT                ;GET THE OUTPUT COUNT.
  6187	411642'	571346	777777	        HRREI   P2,-1(P1)               ;ONLY IF MORE THEN ONE.
  6188	411643'	323340	411647'	        JUMPLE  P2,STAT7                ;JUMP IF NOT ENOUGH.
  6189	411644'	260740	410672'	        GOSUB   DECOUT                  ;TELL HOW MANY.
  6190	411645'	051140	415552'	        PRINT   ( output files written.);SO HE KNOWS.
  6191	411646'	402000	000436'
  6192
  6193				;HERE TO TELL THE BAD THINGS THAT HAPPENED WHILE
  6194				;WE WERE CONVERTING THE CHARACTER SETS.
  6195
  6196	411647'	336300	000361'	STAT7:  SKIPN   P1,NOCHR                ;COUNT OF NON-CONVERTS.
  6197	411650'	254000	411654'	        GOTO    STAT2                   ;TELL NOTHING IF GOOD.
  6198	411651'	260740	410672'	        GOSUB   DECOUT                  ;TELL THE BAD NEWS.
  6199	411652'	051140	415557'	        PRINT   ( bad characters found.);SO HE KNOWS WHAT IT IS.
  6200	411653'	402000	000436'
  6201
  6202				;HERE TO TELL ABOUT DEVICE ERRORS IF THERE WERE ANY.
  6203
  6204	411654'	336300	000367'	STAT2:  SKIPN   P1,INPERR               ;ARE THERE ANY INPUT ERRORS.
  6205	411655'	254000	411661'	        GOTO    STAT4                   ;NO IGNORE IT.
  6206	411656'	260740	410672'	        GOSUB   DECOUT                  ;PRINT THEM.
  6207	411657'	051140	415564'	        PRINT   ( input parity errors.)
  6208	411660'	402000	000436'
  6209	411661'	336300	000370'	STAT4:  SKIPN   P1,OTPERR               ;ANY OUTPUT ERRORS.
  6210	411662'	254000	411666'	        GOTO    STAT5                   ;NO SO SKIP IT ALL.
  6211	411663'	260740	410672'	        GOSUB   DECOUT                  ;PRINT THE VALUE.
  6212	411664'	051140	415571'	        PRINT   ( output parity errors.)
  6213	411665'	402000	000436'
  6214	411666'	051440	000000	STAT5:  EME     .CLR,ZERO               ;CLEAR BUFFERS.
  6215	411667'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 118
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6216				;HERE TO CHECK ON A FILE OR LABEL NAME.
  6217
  6218	411670'	602100	000100	TSTNAM: IF.ON   IF,WNAME,CHKEXT         ;IF WILD NAME CHECK EXT.
  6219	411672'	312300	000035'	        CAME    P1,IFILE+NAME           ;DOES NAME MATCH.
  6220	411673'	263740	412060'	        RETURN  ZERO                    ;NOT THE RIGHT ONE.
  6221	411674'	602100	000200	CHKEXT: IF.ON   IF,WEXT,MOVNAM          ;MOVE NAME INTO PLACE IF WILD.
  6222	411676'	513000	000036'	        HLLZS   IFILE+EXT               ;ZERO THE RIGHT HALF.
  6223	411677'	312340	000036'	        CAME    P2,IFILE+EXT            ;CHECK THE EXTENSION.
  6224	411700'	263740	412060'	        RETURN  ZERO                    ;NO MATCH.
  6225	411701'	602100	000100	MOVNAM: IF.OFF  IF,WNAME                ;SKIP IF NAME ISN'T WILD.
  6226	411702'	202300	000035'	        MOVEM   P1,IFILE+NAME           ;SAVE THIS NAME.
  6227	411703'	602100	000200	        IF.OFF  IF,WEXT                 ;SKIP IF NOT WILD EXTENSION.
  6228	411704'	202340	000036'	        MOVEM   P2,IFILE+EXT            ;ELSE SAVE THIS ONE.
  6229	411705'	200300	000630'	        MOVE    P1,LABNAM               ;GET FIRST HALF OF THE NAME.
  6230	411706'	200340	000631'	        MOVE    P2,LABNAM+1             ;GET THE SECOND HALF.
  6231	411707'	254000	412057'		RETURN	ONE
  6232	411710'	602040	000100	MOVNM0: IF.OFF  OF,WNAME                ;SKIP IF OUTPUT NAME IS TRUE.
  6233	411711'	202300	000004'	        MOVEM   P1,OFILE+NAME           ;SAVE THIS NAME.
  6234	411712'	602040	000200	        IF.OFF  OF,WEXT                 ;SKIP IF EXTENSION IS TRUE.
  6235	411713'	202340	000005'	        MOVEM   P2,OFILE+EXT            ;SAVE THE EXTENSION.
  6236	411714'	254000	412057'	        RETURN  ONE                     ;GIVE FOUND RETURN.
  6237
  6238				;HERE TO GET A FUNNY NAME.
  6239
  6240	411715'	262740	000006	DREAM0: UNSAVE	T4	;RETURN T4
  6241	411716'	350140	000434'	DREAM:	AOS	T1,WLDEXT	;ADD TO SEQ. EXT. NAME
  6242	411717'	551240	202020		HRRZI	T3,'000'	;FILLER EXT.
  6243	411720'	260740	411750'		GOSUB	WLD3		;MAKE CORRECT EXT.
  6244	411721'	505140	465154		HRLI	T1,'FIL'	;HALF FILE NAME
  6245	411722'	540140	000005		HRR	T1,T3		;REST OF FILE NAME
  6246	411723'	514200	000005		HRLZ	T2,T3		;EXT. NAME
  6247	411724'	554240	000002'		HLRZ	T3,OFILE+DEVICE	;GET OUTPUT DEVICE
  6248	411725'	306240	446353		CAIN	T3,'DSK'	;SEE IF DISK
  6249	411726'	336000	000046'		SKIPN	IFILE+DENSITY	;SEE IF INPUT FROM TAPE
  6250	411727'	263740	412060'		RETURN	ZERO		;MUST BE BOTH
  6251	411730'	332000	000435'		SKIPE	WLDISK		;SEE IF INITED CHANNEL
  6252	411731'	254000	411737'		GOTO	DREAM1
  6253	411732'	041440	000000		INIT	WF,0
  6254	411733'	446353	000000		SIXBIT/DSK/
  6255	411734'	000000	000000		0
  6256	411735'	254000	411732'		GOTO	.-3
  6257	411736'	476000	000435'		SETOM	WLDISK		;SHOWS GOT CHANNEL
  6258	411737'	261740	000006	DREAM1: SAVE	T4		;SAVE WHATEVER IN T4
  6259	411740'	400240	000000		SETZ	T3,
  6260	411741'	200300	000007'		MOVE	T4,OFILE+PPN	;GET PPN OF NEW OUT FILE
  6261	411742'	076440	000003		LOOKUP	WF,T1		;SEE IF WILD NAME EXISTS
  6262	411743'	334000	000000		SKIPA			;NO, WE WILL USE IT
  6263	411744'	254000	411715'		GOTO	DREAM0		;ITS THERE, GET ANOTHER NAME
  6264	411745'	262740	000006		UNSAVE	T4		;RETURN T4
  6265	411746'	513200	000004		HLLZS	T2,T2		;ZERO IT OUT
  6266	411747'	263740	412060'		RETURN	ZERO		;NOW RETURN
  6267	411750'	231140	000012	WLD3:	IDIVI	T1,^D10		;CREATE EXT AND FILE NAME
  6268	411751'	506217	000000		HRLM	T2,ZERO(PDP)	;SAVE REMAINER
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 118-2
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6269	411752'	332000	000003		SKIPE	T1		;SKIP IF NO MORE TO DIVIDE
  6270	411753'	260740	411750'		GOSUB	WLD3		;CREATE MORE EXT.
  6271	411754'	554217	000000		HLRZ	T2,ZERO(PDP)	;GET VALUE
  6272	411755'	271200	000020		ADDI	T2,20		;MAKE SIXBIT
  6273	411756'	242240	000006		LSH	T3,6		;SHIFT EXT. AREA
  6274	411757'	270240	000004		ADD	T3,T2		;ADD NEW VALUE
  6275	411760'	263740	412060'		RETURN	ZERO		;DO NEXT DIGIT IF ANY
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 119
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6276				;HERE TO CONVERT THE DATE CONTAINED IN T1 TO
  6277				;YYDDD AND DEPOSIT THIS BY THE POINTER IN P1.
  6278
  6279	411761'	231140	000037	BCLDAT: IDIVI   T1,^D31                 ;GET THE DAYS.
  6280	411762'	261740	000004	        SAVE    T2                      ;STICK ONTO STACK.
  6281	411763'	231140	000014	        IDIVI   T1,^D12                 ;GET THE MONTHS.
  6282	411764'	200204	412017'	        MOVE    T2,MONTH(T2)            ;GET DAYS SO FAR IN YEAR.
  6283	411765'	262740	000005	        UNSAVE  T3                      ;GET DAYS BACK.
  6284	411766'	271205	000001	        ADDI    T2,ONE(T3)              ;T2 HAS DAYS SO FAR IN YEAR.
  6285	411767'	261740	000004	        SAVE    T2                      ;SAVE THE DAYS.
  6286	411770'	201143	000100	        MOVEI   T1,^D64(T1)             ;UPDATE THE YEAR.
  6287	411771'	200200	000003	        MOVE    T2,T1                   ;COPY TO ANOTHER AC.
  6288	411772'	231200	000004	        IDIVI   T2,4                    ;MUST BE SURE THIS ISN'T A LEAP YEAR.
  6289	411773'	326240	411777'	        JUMPN   T3,BYEAR                ;JUMP IF NOT A LEAP YEAR.
  6290	411774'	200257	000000	        MOVE    T3,ZERO(PDP)            ;GET DAYS BACK.
  6291	411775'	303240	000073	        CAILE   T3,^D59                 ;ARE WE PAST FEB.
  6292	411776'	350017	000000	        AOS     ZERO(PDP)               ;YES SO COUNT EXTRA DAY.
  6293	411777'	260740	412004'	BYEAR:  GOSUB   DEPTWO                  ;PUT TWO DIGITS OUT.
  6294	412000'	262740	000003	        UNSAVE  T1                      ;GET THE DAYS BACK.
  6295	412001'	201200	000020	        MOVEI   T2,'0'                  ;IN CASE WE MUST PAD.
  6296	412002'	305140	000144	        CAIGE   T1,^D100                ;SKIP IF BETTER THEN 100.
  6297	412003'	136200	000006	        IDPB    T2,P1                   ;PAD A ZERO.
  6298	412004'	201200	000020	DEPTWO: MOVEI   T2,'0'                  ;IN CASE WE MUST PAD.
  6299	412005'	305140	000012	        CAIGE   T1,^D10                 ;IS IT BETTER THEN 10.
  6300	412006'	136200	000006	        IDPB    T2,P1                   ;NO PAD IN A ZERO.
  6301	412007'	231140	000012	        IDIVI   T1,^D10                 ;SLICE OFF A DIGIT.
  6302	412010'	506217	000000	        HRLM    T2,ZERO(PDP)            ;SAVE A DIGIT.
  6303	412011'	332000	000003	        SKIPE   T1                      ;SKIP IF LAST DIGIT.
  6304	412012'	260740	412007'	        GOSUB   .-3                     ;CONTINUE FOR ALL DIGITS.
  6305	412013'	554157	000000	        HLRZ    T1,ZERO(PDP)            ;GET A DIGIT FROM STACK.
  6306	412014'	201603	000020	        MOVEI   CH,'0'(T1)              ;CONVERT TO SIXBIT.
  6307	412015'	136600	000006	        IDPB    CH,P1                   ;PUT INTO BUFFER.
  6308	412016'	263740	412060'	        RETURN  ZERO                    ;BACK TO SENDER.
  6309
  6310	412017'	000000	000000	MONTH:  DEC     0,31,59,90,120,151,181,212,243,273,304,334
	412020'	000000	000037
	412021'	000000	000073
	412022'	000000	000132
	412023'	000000	000170
	412024'	000000	000227
	412025'	000000	000265
	412026'	000000	000324
	412027'	000000	000363
	412030'	000000	000421
	412031'	000000	000460
	412032'	000000	000516
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 120
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6311				;HERE TO SAVE THE AC'S ON THE STACK. AC 0(S) IS GLOBAL ACROSS
  6312				;ALL ROUTINES AND IS NOT SAVED. AC 17(PDP) IS THE PUSH-DOWN POINTER
  6313				;AND SHOULD NOT BE SAVED. ***CAUTION SHOULD BE USED IN CALLING THIS
  6314				;ROUTINE FOR IT USES SPACE RAPIDLY ON THE STACK. NOTE RETURNS TO PC,
  6315				;PC+1, PC+2, AND PC+3 ARE HANDLED CORRECTLY. THE RETURN FROM THE
  6316				;ROUTINE THAT CALLS THIS ROUTINE WILL RESTORE THE AC'S.
  6317
  6318	412033'	250057	000000	STORE:  EXCH    1,0(PDP)                ;SAVE AC ONE.
  6319	412034'	202040	000375'	        MOVEM   1,TEMP                  ;SAVE POINTER TO RETURN.
  6320	412035'	551057	000001	        HRRZI   1,1(PDP)                ;DESTINATION FOR BLT.
  6321	412036'	505040	000002	        HRLI    1,2                     ;SOURCE FOR BLT.
  6322	412037'	251057	000015	        BLT     1,15(PDP)               ;SAVE THE AC'S.
  6323	412040'	270740	415576'	        ADD     PDP,[XWD 15,15]         ;UPDATE PDP.
  6324	412041'	201040	000003	        MOVEI   1,3                     ;BUMP RETURN FOR SKIP.
  6325	412042'	272057	777762	        ADDM    1,-16(PDP)              ;RETURN IS NOW TO PC+3.
  6326	412043'	200057	777763	        MOVE    1,-15(PDP)              ;RESTORE AC 1.
  6327	412044'	260760	000375'	        GOSUB   @TEMP                   ;RETURN TO SENDER.
  6328	412045'	370017	777762	        SOS     -16(PDP)                ;DECREMENT FOR NORMAL RETURN.
  6329	412046'	370017	777762	        SOS     -16(PDP)                ;DECREMENT FOR RETURN TO PC+2.
  6330	412047'	370017	777762	        SOS     -16(PDP)                ;DECREMENT FOR RETURN TO PC+1.
  6331	412050'	515717	777763	        HRLZI   16,-15(PDP)             ;SOURCE FOR BLT.
  6332	412051'	541700	000001	        HRRI    16,1                    ;DESTINATION FOR BLT.
  6333	412052'	251700	000016	        BLT     16,16                   ;RESTORE THE AC'S.
  6334	412053'	274740	415577'	        SUB     PDP,[XWD 16,16]         ;UPDATE PDP.
  6335	412054'	263740	412060'	        RETURN  ZERO                    ;BACK TO SENDER.
  6336
  6337				;STACK MANIPULATORS.
  6338
  6339	412055'	350017	000000	RET3:   AOS     ZERO(PDP)               ;RETURN TO PC+3.
  6340	412056'	350017	000000	        AOS     ZERO(PDP)               ;RETURN TO PC+2.
  6341	412057'	350017	000000	RET1:   AOS     ZERO(PDP)               ;RETURN TO PC+1.
  6342	412060'	263740	412060'	RET0:   RETURN  ZERO                    ;RETURN TO PC+0.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 121
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6343				;HERE TO SAVE THE P AC'S ON THE STACK. SKIP RETURNS HANDLED.
  6344
  6345	412061'	261740	415600'	SAV4:   SAVE    [XWD -4,ZERO]           ;AC'S TO SAVE.
  6346	412062'	254000	412066'	        GOTO    SAVEAC                  ;GO SAVE THEM.
  6347	412063'	261740	415601'	SAV3:   SAVE    [XWD -3,ZERO]           ;AC'S TO SAVE.
  6348	412064'	254000	412066'	        GOTO    SAVEAC                  ;SAVE THEM.
  6349	412065'	261740	415602'	SAV2:   SAVE    [XWD -2,ZERO]           ;AC'S TO SAVE.
  6350	412066'	250317	777777	SAVEAC: EXCH    P1,-1(PDP)              ;SAVE AC P1.
  6351	412067'	202300	000375'	        MOVEM   P1,TEMP                 ;SAVE RETURN ADDRESS.
  6352	412070'	201300	000003	        MOVEI   P1,3                    ;TO FIX UP RETURN.
  6353	412071'	272317	777776	        ADDM    P1,-2(PDP)              ;RETURN IS NOW TO PC+3.
  6354	412072'	262740	000006	        UNSAVE  P1                      ;GET AOBJ WORD FOR SAVE.
  6355	412073'	252300	412076'	        AOBJP   P1,.+3                  ;JUMP IF SAVED ENOUGH.
  6356	412074'	261746	000006	        SAVE    P1(P1)                  ;SAVE AN AC.
  6357	412075'	254000	412073'	        GOTO    .-2                     ;DO THE NEXT.
  6358	412076'	261740	000006	        SAVE    P1                      ;SAVE AC P1.
  6359	412077'	201306	000001	        MOVEI   P1,ONE(P1)              ;POINT P1 TO RETURN.
  6360	412100'	276740	000006	        SUBM    PDP,P1                  ;MAKE P1 POINT TO ADR OF RETURN.
  6361	412101'	553000	000006	        HRRZS   P1                      ;CLEAR P1 RIGHT HALF.
  6362	412102'	261740	000006	        SAVE    P1                      ;PLACE IT ON THE TOP OF THE STACK.
  6363	412103'	200306	000001	        MOVE    P1,ONE(P1)              ;RESTORE P1.
  6364	412104'	260760	000375'	        GOSUB   @TEMP                   ;DISPATCH...
  6365	412105'	370037	000000	        SOS     @ZERO(PDP)              ;RETURN TO PC.
  6366	412106'	370037	000000	        SOS     @ZERO(PDP)              ;RETURN TO PC+1.
  6367	412107'	370037	000000	        SOS     @ZERO(PDP)              ;RETURN TO PC+2.
  6368	412110'	262740	000006	        UNSAVE  P1                      ;TAKE POINTER OFF STACK.
  6369	412111'	262740	000006	        UNSAVE  P1                      ;NUMBER OF AC'S SAVED.
  6370	412112'	363300	412115'	        SOJLE   P1,.+3                  ;JUMP IF DONE ENOUGH.
  6371	412113'	262746	000006	        UNSAVE  P1(P1)                  ;RESTORE AN AC.
  6372	412114'	254000	412112'	        GOTO    .-2                     ;CONTINUE ON.
  6373	412115'	262740	000006	        UNSAVE  P1                      ;RESTORE P1.
  6374	412116'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  6375
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 122
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6376				;HERE TO INCREMENT THE VOLUME NUMBER.
  6377
  6378	412117'	270140	415603'	BMPVOL: ADD     T1,[OCT 464646470000]   ;ADD ONE AND HANDLE CARRIES.
  6379	412120'	200200	000003	        MOVE    T2,T1                   ;COPY TO BETTER AC.
  6380	412121'	404200	415604'	        AND     T2,[OCT 606060600000]   ;ISOLATE CARRY BITS.
  6381	412122'	242200	777775	        LSH     T2,-3                   ;PUT THEM IN PLACE.
  6382	412123'	274140	000004	        SUB     T1,T2                   ;FUDGE UP CARRIES.
  6383	412124'	404140	415605'	        AND     T1,[OCT 171717170000]   ;NOW HAVE BINARY NUMBER.
  6384	412125'	434140	415606'	        IOR     T1,[OCT 202020200000]   ;BACK TO SIXBIT.
  6385	412126'	263740	412060'	        RETURN  ZERO                    ;TO SENDER...
  6386
  6387				;HERE TO TAKE THE NUMBER CONTAINED IN T1 AND CONVERT IT TO
  6388				;A TWO WORD QUANTITY STORED IN T1 AND T2.
  6389
  6390	412127'	334340	413554'	MAKTWO: SKIPA   P2,[^D10]               ;SET RADIX TO TEN.
  6391	412130'	201340	000010	MAK2:   MOVEI   P2,10                   ;SET THE RADIX TO EIGHT.
  6392	412131'	231147	000000	        IDIVI   T1,ZERO(P2)             ;SLICE OFF A DIGIT.
  6393	412132'	506217	000000	        HRLM    T2,ZERO(PDP)            ;STORE ON THE STACK.
  6394	412133'	326140	412136'	        JUMPN   T1,.+3                  ;JUMP IF NOT DONE.
  6395	412134'	200140	414433'	        MOVE    T1,[SIXBIT "000000"]    ;STUFF IN LEADING ZEROS.
  6396	412135'	334200	000003	        SKIPA   T2,T1                   ;IN BOTH WORDS.
  6397	412136'	260740	412131'	        GOSUB   MAK2+1                  ;CONTINUE IF NOT DONE.
  6398	412137'	554257	000000	        HLRZ    T3,ZERO(PDP)            ;PICK UP A DIGIT.
  6399	412140'	246140	000006	        LSHC    T1,6                    ;MAKE ROOM FOR IT.
  6400	412141'	271205	000020	        ADDI    T2,'0'(T3)              ;CONVERT AND ADD.
  6401	412142'	263740	412060'	        RETURN  ZERO                    ;BACK TO SENDER.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 123
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6402				;HERE WHEN THE GIG IS UP AND THE TRAP HAS SPRUNG.
  6403
  6404	412143'	261740	000652'	TRAP:   SAVE    TRPPC                   ;STACK THE RETURN ADDRESS.
  6405	412144'	260740	412033'	        GOSUB   STORE                   ;SAVE THE AC'S.
  6406	412145'	261740	000653'	        SAVE    TRPCHN                  ;SAVE THE CHANNEL AND CLASS BITS.
  6407	412146'	260740	412227'	        GOSUB   TRPSET                  ;RESET THE TRAP.
  6408	412147'	262740	000010	        UNSAVE  P3                      ;GET THE BITS BACK.
  6409	412150'	554340	000010	        HLRZ    P2,P3                   ;GET THE CLASS BITS.
  6410	412151'	602340	000002	        IF.ON   P2,ER.ICC,CTLC          ;STOP ON CTRL/C.
  6411	412153'	602340	000040	        IF.ON   P2,ER.TLX,NOTIME        ;JUMP IF TIME RAN OUT.
  6412	412155'	606340	000077	        IF.ON   P2,ER.ALL               ;IF NOT OTHERS THEN
  6413	412156'	263740	412060'	        RETURN  ZERO                    ;IGNORE THESE PROBLEMS.
  6414	412157'	666000	001000	        TNO     S,HUNG                  ;ONLY TYPE IT ONCE.
  6415	412160'	602000	002000	        IF.ON   S,NO.PRI,TRPCHK         ;DON'T TYPE IF FORCED.
  6416	412162'	553000	000010	        HRRZS   P3                      ;SO WE CAN USE AS AN INDEX.
  6417	412163'	305400	000007	        CAIGE   P3,CF                   ;SKIP IF CCL FILE.
  6418	412164'	254000	412171'	        GOTO    OTHDEV                  ;CHECK OTHERS.
  6419	412165'	275400	000007	        SUBI    P3,CF                   ;MAKE CHANNEL OFFSET FROM CF.
  6420	412166'	221400	000020	        IMULI   P3,CCLCNT               ;PRODUCE OFFSET FROM CCLBLK.
  6421	412167'	201210	000673'	        MOVEI   T2,CCLBLK(P3)           ;PRODUCE PONTER.
  6422	412170'	334000	000000	        SKIPA                           ;SKIP INTO GOODNESS.
  6423	412171'	201230	415606'	OTHDEV: MOVEI   T2,@[EXP OFILE,IFILE,UFDDEV,MFDDEV,DATDEV,HLPDEV]-OF(P3)
  6424	412172'	051600	000000	        ENABLE  TTY                     ;CLEAR THE TELETYPE.
  6425	412174'	260740	410441'	        GOSUB   CRLF                    ;SKIP A LINE.
  6426	412175'	051140	414636'	        EME     .STR,[ASCIZ "% "]       ;GIVE WARNING SIGNAL.
  6427	412176'	260740	407754'	        GOSUB   NAMIT                   ;NAME THE DEVICE.
  6428	412177'	602340	000004	        IF.OFF  P2,ER.OFL               ;SKIP IF UNIT IS ON LINE.
  6429	412200'	051140	415615'	        PRINT   ( has dropped off line.);TELL HIM UNIT ISN'T READY.
  6430	412201'	402000	000436'
  6431	412202'	602340	000010	        IF.OFF  P2,ER.FUL               ;SKIP IF UNIT IS NOT FULL.
  6432	412203'	051140	415622'	        PRINT   ( is full.)
  6433	412204'	402000	000436'	             ;SAY UNIT IS NO LONGER WITH US.
  6434	412205'	602340	000020	        IF.OFF  P2,ER.QEX               ;ARE WE GOING OVER QUOTA.
  6435	412206'	051140	415625'	        PRINT   ( quota being exceeded.);TELL HIM WE ARE GOING INTO OVERDRAW.
  6436	412207'	402000	000436'
  6437	412210'	602340	000001	        IF.OFF  P2,ER.IDV               ;SKIP IF DEVICE NEEDS NO ACTION.
  6438	412211'	051140	415632'	        PRINT   ( is not ready!)
  6439	412212'	402000	000436'	        ;TELL HIM WHAT IS WRONG.
  6440	412213'	201140	000005	TRPCHK: MOVEI   T1,5                    ;SLEEP TIME.
  6441	412214'	200200	415636'	        MOVE    T2,[XWD 10,^D5000]      ;LOAD HIBERNATE ARGS.
  6442	412215'	047140	000072	        MME     T1,.WAIT                ;WAIT AWILE.
  6443	412216'	047140	000031	        MME     T1,.SLP                 ;SLEEP IF WAIT FAILS.
  6444	412217'	621040	000010	        OFF     OF,TTY                  ;TURN GOING TO TTY OFF.
  6445	412220'	260740	412330'	        GOSUB   CHKOPR                  ;CHECK FOR A COMMAND.
  6446	412221'	200040	000010'	        MOVE    OF,OFILE+MOD            ;FIX THE MOD BITS.
  6447	412222'	263740	412060'	        RETURN  ZERO                    ;TRY AGAIN.
  6448
  6449				;HERE WHEN THIS USER'S RUN TIME LIMIT IS ALMOST EXCEEDED.
  6450
  6451	412223'	256000	410441'	NOTIME: XCT     CRLF                    ;SKIP A LINE.
  6452	412224'	051140	415637'	        PRINT   (***Run time limit almost exceeded)
  6453	412225'	402000	000436'
  6454	412226'	254000	410500'	        GOTO    STOPIT                  ;SAVE THE FILE.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 124
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6455				;HERE TO ENABLE US FOR DEVICE AND APR TRAPS.
  6456				;THE TRAPS THAT WE WILL CATCH ARE AS FOLLOWS
  6457				;FOR THE APR:
  6458				;       PDL OVERFLOW.
  6459				;       REFERENCE TO NXM.
  6460				;       MEMORY PROTECTION VIOLATION.
  6461				;FOR DEVICES:
  6462				;       DEVICE NOT READY.
  6463				;       QUOTA BEING EXCEEDED ON DISK.
  6464				;       DISK UNIT GOING OFF LINE.
  6465				;       DISK UNIT BECOMING FULL.
  6466
  6467	412227'	201140	412274'	TRPSET: MOVEI   T1,APRTRP               ;APR TRAP LOCATION.
  6468	412230'	202140	400200*	        MOVEM   T1,JOBAPR               ;PLACE TO TRAP TO.
  6469	412231'	201140	630000	        MOVEI   T1,REP!PDL!MPV!NXM      ;THINGS TO TRAP ON.
  6470	412232'	047140	000016	        MME     T1,.ENB                 ;ENABLE THE TRAPS.
  6471	412233'	201140	000650'	        MOVEI   T1,TRPBLK               ;GET POINTER TO BLOCK.
  6472	412234'	202140	000134	        MOVEM   T1,.JBINT               ;SAVE SO EXEC WILL KNOW.
  6473	412235'	200140	415647'	        MOVE    T1,[XWD 4,TRAP]         ;BLOCK LENGTH AND TRAP LOC.
  6474	412236'	202140	000650'	        MOVEM   T1,TRPBLK               ;SAVE IN BLOCK.
  6475	412237'	200140	415650'	        MOVE    T1,[XWD 400000,ER.ALL]  ;DON'T TYPE MESSAGES AND CLASS BITS.
  6476	412240'	202140	000651'	        MOVEM   T1,TRPBLK+1             ;SAVE IN BLOCK.
  6477	412241'	402000	000652'	        SETZM   TRPPC                   ;CLEAR PC WORD TO ALLOW MULTIPLE TRAPS.
  6478	412242'	402000	000653'	        SETZM   TRPCHN                  ;CLEAR CHANNEL NUMBER.
  6479	412243'	263740	412060'	        RETURN  ZERO                    ;AWAY...
  6480
  6481				;HERE FOR AN INPUT ERROR FROM THE LAST INPUT MME.
  6482
  6483	412244'	602140	200000	LKIERR: IF.ON   T1,E.HAD,HADERR         ;JUMP IF HARD DEVICE ERROR.
  6484	412246'	602140	040000	        IF.ON   T1,E.IOB,BLKERR         ;JUMP IF USER ERROR.
  6485	412250'	606140	400000	        IF.ON   T1,E.LOK                ;MAKE SURE THERE IS AN ERROR.
  6486	412251'	260740	410505'	        GOSUB   ABORT                   ;ELSE NO OTHER REASON TO BE HERE.
  6487	412252'	260740	410742'	        BRANCH  WLDDEV,<DSKERR,IOERR,IOERR,IOERR> ;BRANCH ON DEVICE TYPE.
  6488	412257'	201300	414636'	DSKERR: MOVEI   P1,[ASCIZ "% "]         ;IF IN A WILD CARD RUN.
  6489	412260'	606100	007300	        IF.ON   IF,WILD                 ;TEST THE WILD BITS.
  6490	412261'	201300	413642'	        MOVEI   P1,[ASCIZ "? "]         ;FATAL ERROR.
  6491	412262'	551140	000002	        HRRZI   T1,2                    ;PROTECTION FAILURE CODE.
  6492	412263'	542140	000036'	        HRRM    T1,IFILE+EXT            ;SET THE ERROR CODE.
  6493	412264'	260740	412033'	        GOSUB   STORE                   ;SAVE THE AC'S.
  6494	412265'	200440	000041'	        MOVE    P4,IFILE+MOD            ;GET THE MOD BITS.
  6495	412266'	620440	007300	        OFF     P4,WILD                 ;TURN OFF WILD BITS.
  6496	412267'	201500	000032'	        MOVEI   SIDE,IFILE              ;INDEX TO DATA.
  6497	412270'	260740	410037'	        GOSUB   TYPEIT                  ;PRINT DEV:NAME.EXT(USERNAME).
  6498	412271'	606100	007300	        IF.OFF  IF,WILD,ERREXT          ;JUMP IF FATAL.
  6499	412273'	263740	412060'	        RETURN  ZERO                    ;ELSE RETURN.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 125
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6500				;HERE ON AN APR TRAP. THE TRAPS THAT ARE DETECTED ARE
  6501				;PDL OVERFLOW, MEMORY PROTECTION VIOLATION, AND REFERENCES TO
  6502				;NON-EXISTENT MEMORY. A MESSAGE IS TYPE TO TELL THE CAUSE
  6503				;THE PROBLEM IS CLEARED AND DDT IS CALLED IF IT IS HERE, ELSE
  6504				;WE GO TO ABORT. NOTE THE AC'S ARE SAVED IN 'AC'.
  6505
  6506	412274'	202740	000515'	APRTRP: MOVEM   17,AC+17                ;SAVE AC 17.
  6507	412275'	551740	000476'	        HRRZI   17,AC                   ;XWD FOR BLT.
  6508	412276'	251740	000514'	        BLT     17,AC+16                ;SAVE THE AC'S.
  6509	412277'	051600	000000	        ENABLE  TTY                     ;CLEAR THE TELTYPE.
  6510	412301'	200140	000000*	        MOVE    T1,JOBCNI               ;GET THE APR FLAGS.
  6511	412302'	602140	200000	        IF.OFF  T1,PDL                  ;SKIP IF NOT PDL OVERFLOW.
  6512	412303'	200740	415651'	        MOVE    PDP,[IOWD TMPLEN,TMPLST];GET A NEW POINTER.
  6513	412304'	261740	000000*	        SAVE    .JBTPC                  ;SAVE PLACE OF ERROR.
  6514	412305'	350017	000000	        AOS     ZERO(PDP)               ;SO ABORT WILL DO GOOD THINGS.
  6515	412306'	256000	410441'	        XCT     CRLF                    ;SKIP A LINE.
  6516	412307'	602140	200000	        IF.OFF  T1,PDL                  ;WAS IT PDL OVERFLOW.
  6517	412310'	051140	415652'	        EME     .STR,[ASCIZ "***PUSH-DOWN LIST OVERFLOW"]
  6518	412311'	602140	020000	        IF.OFF  T1,MPV                  ;MEMORY PROTECTION VIOLATION.
  6519	412312'	051140	415660'	        EME     .STR,[ASCIZ "***MEMORY PROTECTION VIOLATION"]
  6520	412313'	602140	010000	        IF.OFF  T1,NXM                  ;REFERENCE TO NON-EXISTENT MEMORY.
  6521	412314'	051140	415667'	        EME     .STR,[ASCIZ "***NON-EXISTENT MEMORY REFERENCED"]
  6522	412315'	606140	230000	        IF.ON   T1,PDL!MPV!NXM          ;IF NONE OF THESE REAL BUG.
  6523	412316'	254000	410514'	        GOTO    ABORT1                  ;SO BUMB.
  6524	412317'	051140	415456'	        EME     .STR,[ASCIZ " AT "]     ;TELL HIM WHERE.
  6525	412320'	200200	412304*	        MOVE    T2,.JBTPC               ;GET THE LOCATION OF THE TRAP.
  6526	412321'	265440	411353'	        JSP     P4,OCTOUT               ;PRINT IT.
  6527	412322'	256000	410441'	        XCT     CRLF                    ;SKIP A LINE.
  6528	412323'	201140	630000	        MOVEI   T1,REP!PDL!NXM!MPV      ;BITS TO REENABLE.
  6529	412324'	047140	000016	        MME     T1,.ENB                 ;ENABLE IT AGAIN.
  6530	412325'	332140	410563*	        SKIPE   T1,JOBDDT               ;SKIP IF NO DDT.
  6531	412326'	254000	400177'	        GOTO    CALDDT                  ;ELSE GET IT HERE.
  6532	412327'	254000	400057'	        GOTO    NTHERE                  ;ELSE START OVER.
  6533
  6534	001671'			        USE     DATA
  6535
  6536	001671'			BSS     TMPLST,TMPLEN                   ;TEMPORARY STACK.
  6537
  6538	412330'			        USE     CODE
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 126
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6539				;HERE TO CHECK FOR AN OPERATOR COMMAND WHILE WE ARE RUNNING.
  6540
  6541	412330'	607040	000010	CHKOPR: IF.ON   OF,TTY                  ;SKIP IF GOING TO TTY.
  6542	412331'	051600	000000	        EME     .SKP,ZERO               ;SKIP ON INPUT REQUEST.
  6543	412332'	263740	412060'	        RETURN  ZERO                    ;RETURN IF NOTHING.
  6544	412333'	260740	412033'	        GOSUB   STORE                   ;SAVE THE AC'S.
  6545	412334'	261740	000000	        SAVE    S                       ;SAVE THE STATUS REGISTER.
  6546	412335'	200300	415676'	        MOVE    P1,[XWD -RUNLEN,RUNTAB] ;POINTER TO COMMAND TABLE.
  6547	412336'	201340	413112'	        MOVEI   P2,RUNDIS               ;POINTER TO DISPATCH TABLE.
  6548	412337'	205000	000010	        MOVSI   S,(BAD)                 ;SO BAD CHARACTERS RETURN.
  6549	412340'	261740	415677'	        SAVE    [OPRRET]                ;TO GET BACK HERE.
  6550	412341'	254000	402367'	        GOTO    UNIMAT                  ;READ THE COMAMND.
  6551	412342'	334140	415700'	OPRRET: SKIPA   T1,[NOP]                ;LOAD A NOP FOR ILLEGAL COMMAND.
  6552	412343'	200140	415701'	        MOVE    T1,[TRZ S,HUNG]         ;TO TURN OFF HUNG DEVICE BIT.
  6553	412344'	262740	000000	        UNSAVE  S                       ;RESTORE THE STATUS REGISTER.
  6554	412345'	256000	000003	        XCT     T1                      ;DO NOTHING OR SOMETHING.
  6555	412346'	051440	000000	        EME     .CLR,ZERO               ;CLEAR THE BUFFERS.
  6556	412347'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  6557
  6558				;HERE ON A RUNTIME DDT OR DEBUG COMMAND.
  6559
  6560	412350'	336140	412325*	RUNDDT: SKIPN   T1,JOBDDT               ;IS DDT LOADED.
  6561	412351'	254000	412375'	        GOTO    BADRUN                  ;NO...
  6562	412352'	254000	400202'	        GOTO    DDTCAL                  ;CALL DDT.
  6563
  6564				;HERE ON A RUNTIME WHAT COMMAND.
  6565
  6566	412353'	260740	411562'	RUNWHT: GOSUB   STAT                    ;TELL GOOD THINGS.
  6567	412354'	334000	000000	        SKIPA                           ;SKIP INTO GOODNESS.
  6568	412355'	260740	410441'	RUNFIL: GOSUB   CRLF                    ;SKIP A LINE.
  6569	412356'	402000	000011	        SETZM   P4                      ;CLEAR A REGISTER.
  6570	412357'	201500	000001'	        MOVEI   SIDE,OFILE              ;POINTER TO THINGS.
  6571	412360'	051140	414073'	        EME     .STR,[ASCIZ "OUT= "]    ;TELL OUTPUT COMING.
  6572	412361'	260740	410063'	        GOSUB   TYPNAM                  ;TYPE THE NAME.
  6573	412362'	260740	410441'	        GOSUB   CRLF                    ;SKIP A LINE.
  6574	412363'	201500	000032'	        MOVEI   SIDE,IFILE              ;POINTER TO INPUT THINGS.
  6575	412364'	051140	414075'	        EME     .STR,[ASCIZ "IN=  "]    ;TELL INPUT COMING.
  6576	412365'	260740	410063'	        GOSUB   TYPNAM                  ;TYPE THE NAME.
  6577	412366'	260740	410441'	        GOSUB   CRLF                    ;SKIP AN EXTRA LINE HERE.
  6578	412367'	350017	000000	        AOS     ZERO(PDP)               ;FOR A SKIP RETURN.
  6579	412370'	254000	410441'	        GOTO    CRLF                    ;SKIP A LINE AND EXIT.
  6580
  6581				;HERE ON A RUNTIME PAUSE COMMAND.
  6582
  6583	412371'	260740	410441'	PAUSE:  GOSUB   CRLF                    ;SKIP A LINE.
  6584	412372'	051140	415702'	        EME     .STR,[ASCIZ "***JOB HALTEDJob halted"]  ;TELL WHAT HE DID.
  6585	412373'	047040	000012	        MME     ONE,.TERM               ;STOP...
  6586	412374'	254000	412057'	        RETURN  ONE                     ;SKIP RETURN.
  6587
  6588				;HERE ON A LEGAL BUT BAD RUNTIME COMMAND.
  6589
  6590	412375'	051140	415707'	BADRUN: PRINT   (What?)
  6591	412376'	402000	000436'	                 ;COMPLAIN.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 126-2
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6592	412377'	051040	413554'	        EME     .CH,[EXP 12]            ;SKIP A LINE.
  6593	412400'	263740	412060'	        RETURN  ZERO                    ;RETURN.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 127
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6594				;HERE TO GET THE RIGHT CONVERSION TABLES INTO
  6595				;CORE.
  6596
  6597	412401'	332000	002721'	GETTAB: SKIPE   DFFLG                   ;IS DATA FILE OPEN.
  6598	412402'	254000	412406'		GOTO	GETTB2			;YES.
  6599	412403'	124140	000437'		DMOVEM	T1,CONVWD		;NO - SAVE PARAMETERS
  6600	412404'	260740	412467'		GOSUB	GETTM0			;AND OPEN UP THE FILE.
  6601	412405'	120140	000437'		DMOVE	T1,CONVWD		;GET BACK PARAMETERS.
  6602	412406'	504240	000003	GETTB2:	HRL     T3,T1                   ;GET THE INPUT INDEX.
  6603	412407'	540240	000004	        HRR     T3,T2                   ;GET THE OUTPUT INDEX.
  6604	412410'	332000	000667'		SKIPE   SUBSTF                  ;IF WE SUBSTITUTED LAST TIME...
  6605	412411'	254000	412414'	        GOTO    GETTB1                  ;BE SURE TO READ IN NEW TABLES.
  6606	412412'	316240	002720'	        CAMN    T3,DFPTR                ;SKIP IF NOT THE ONES WE HAVE.
  6607	412413'	263740	412060'	        RETURN  ZERO                    ;RETURN IF THEY ARE.
  6608	412414'	202240	002720'	GETTB1:	MOVEM   T3,DFPTR                ;SAVE FOR NEXT TIME.
  6609	412415'	200243	000010		MOVE    T3,FPTR(T1)             ;GET BLOCK NUMBER AND WORD COUNT.
  6610	412416'	074245	000000	        USETI   DF,ZERO(T3)             ;SELECT A BLOCK.
  6611	412417'	541240	001710'	        HRRI    T3,TAB1-1               ;SET UP IOWD.
  6612	412420'	260740	412443'	        GOSUB   REDTAB                  ;COPY TABLE INTO CORE.
  6613	412421'	200244	000010	        MOVE    T3,FPTR(T2)             ;GET BLOCK NUMBER AND WORD COUNT.
  6614	412422'	074245	000000	        USETI   DF,ZERO(T3)             ;DIAL A BLOCK.
  6615	412423'	541240	002310'	        HRRI    T3,TAB2-1               ;SET UP IOWD.
  6616	412424'	260740	412443'	        GOSUB   REDTAB                  ;GET THE SECOND TABLE.
  6617	412425'	515240	777400	        HRLZI   T3,-^D256               ;SET LENGTH OF TABLES.
  6618	412426'	554605	001711'	TG0:    HLRZ    CH,TAB1(T3)             ;GET A TABLE ENTRY.
  6619	412427'	606600	400000	        IF.OFF  CH,NEC,TG2              ;JUMP IF GOOD CHARACTER.
  6620	412431'	201600	000134	TG1:    MOVEI   CH,"\"                  ;GET A BAD CHARACTER.
  6621	412432'	550614	002311'	        HRRZ    CH,TAB2(CH)             ;CONVERT TO OUTPUT SET.
  6622	412433'	660600	400000	        ON      CH,NEC                  ;NOTE THAT IT IS BAD.
  6623	412434'	254000	412440'	        GOTO    TG3                     ;SAVE IT.
  6624	412435'	550614	002311'	TG2:    HRRZ    CH,TAB2(CH)             ;CONVERT A GOOD CHARACTER.
  6625	412436'	602600	400000	        IF.ON   CH,NEC,TG1              ;JUMP IF A BAD CONVERSION.
  6626	412440'	542605	001711'	TG3:    HRRM    CH,TAB1(T3)             ;REPLACE IN FIRST TABLE.
  6627	412441'	253240	412426'	        AOBJN   T3,TG0                  ;CONTINUE LOOP.
  6628	412442'	263740	412060'	        RETURN  ZERO                    ;BACK TO CALLER.
  6629
  6630				;HERE TO READ A CONVERSION TABLE INTO
  6631				;CORE.
  6632
  6633	412443'	202240	002711'	REDTAB: MOVEM   T3,CTRL                 ;SAVE IOWD WORD.
  6634	412444'	402000	002712'	        SETZM   CTRL+1                  ;SET TERMINATOR.
  6635	412445'	620000	001000	        DEVOP   IN,DF,CTRL              ;READ THE TABLE INTO PLACE.
  6636	412450'	263740	412060'	        RETURN  ZERO                    ;PERFECT.
  6637	412451'	201300	415711'	        MOVEI   P1,[ASCIZ "? ERROR READING DATA FILE."]
  6638	412452'	254000	410306'	        GOTO    CLEAR                   ;BOMB OFF.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 128
MAGCON.MAC	 6-JUL-77 09:25		*** UTILITY ROUTINES ***

  6639				;HERE TO SET UP THE NAME OF THE FILE THAT HOLDS
  6640				;THE CONVERSION FILES.
  6641
  6642	412453'	200140	000033'	GETTNM: MOVE    T1,IFILE+DEVICE         ;GET DEVICE.
  6643	412454'	202140	002724'	        MOVEM   T1,DATDEV+1             ;SAVE THE DEVICE.
  6644	412455'	336140	000035'	        SKIPN   T1,IFILE+NAME           ;IS THERE A NAME.
  6645	412456'	254000	410241'	        GOTO    NOTAB                   ;NO SO ERROR.
  6646	412457'	202140	002726'	        MOVEM   T1,DATFIL               ;SAVE HIS NAME.
  6647	412460'	200140	000036'	        MOVE    T1,IFILE+EXT            ;GET THE EXTENSION.
  6648	412461'	202140	002727'	        MOVEM   T1,DATFIL+1             ;SAVE THE EXTENSION.
  6649	412462'	200140	000040'	        MOVE    T1,IFILE+PPN            ;GET PPN IF THERE.
  6650	412463'	202140	002731'	        MOVEM   T1,DATFIL+3             ;SAVE IT.
  6651	412464'	260740	412506'	        GOSUB   LOOK                    ;SEE IF FILE IS THERE.
  6652	412465'	254000	410241'	        GOTO    NOTAB                   ;CAN'T FIND IT.
  6653	412466'	254000	400057'	        GOTO    NTHERE                  ;START ALL OVER.
  6654
  6655				;HERE TO SEE IF THE DATA FILE IS AROUND. TRY WHAT EVER
  6656				;IS IN THE PARAMETER AREA FIRST AND THEN TRY "SYS:MAGCON.DAT".
  6657				;PARAMETER AREA INITIALLY CONTAINS "DSK:MAGCON.DAT".
  6658
  6659	412467'	260740	412506'	GETTM0: GOSUB   LOOK                    ;TRY WHAT'S THERE FIRST.
  6660	412470'	254000	412474'		GOTO	GETTM1			;NO GOOD.
  6661					EME	.STR,[ASCIZ/
  6662	412471'	051140	415717'	USING "DSK:MAGCON.DAT" CONVERSION FILE - OK? /]
  6663	412472'	260740	401460'		GOSUB	YESNO			;GET CONFIRMATION.
  6664	412473'	263740	412060'		RETURN	ZERO			;CONFIRMED - GO AHEAD.
  6665	412474'	205240	637163	GETTM1:	MOVSI   T3,'SYS'                ;TRY SYS.
  6666	412475'	202240	002724'	        MOVEM   T3,DATDEV+1             ;SAVE THE DEVICE.
  6667	412476'	200240	413541'	        MOVE    T3,[SIXBIT "MAGCON"]    ;TRY  "MAGCON.DAT".
  6668	412477'	202240	002726'	        MOVEM   T3,DATFIL               ;SAVE THE NAME.
  6669	412500'	205240	444164	        MOVSI   T3,'DAT'                ;GET A DEFAULT EXTENSION.
  6670	412501'	202240	002727'	        MOVEM   T3,DATFIL+1             ;SAVE THE EXTENSION.
  6671	412502'	402000	002731'	        SETZM   DATFIL+3                ;SPECIFIY THIS PPN.
  6672	412503'	260740	412506'	        GOSUB   LOOK                    ;SEE IF THERE NOW.
  6673	412504'	254000	410241'	        GOTO    NOTAB                   ;YOU LOOSE.
  6674	412505'	263740	412060'	        RETURN  ZERO                    ;MADE IT.
  6675	412506'	050240	002723'	LOOK:   OPEN    DF,DATDEV               ;INIT THE DEVICE.
  6676	412507'	263740	412060'	        RETURN  ZERO                    ;ERROR RETURN.
  6677	412510'	076240	002726'	        LOOKUP  DF,DATFIL               ;GET THE FILE.
  6678	412511'	263740	412060'	        RETURN  ZERO                    ;ERROR RETURN.
  6679	412512'	402000	002720'	        SETZM   DFPTR                   ;CLEAR POINTER.
  6680	412513'	476000	002721'	        SETOM   DFFLG                   ;FLAG WE HAVE FILE.
  6681	412514'	254000	412057'	        RETURN  ONE                     ;BACK TO CALLER.
  6682
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 129
MAGCON.MAC	 6-JUL-77 09:25		*** HELP SUPPLIED HERE ***

  6683				SUBTTL                          *** HELP SUPPLIED HERE ***
  6684				;HERE ON A HELP SWITCH OR HELP OR EXPLAIN COMMAND.
  6685
  6686	412515'	200540	000520'	SW.H:   MOVE    WD,PRGNAM               ;GET THE DEFAULT.
  6687	412516'	602000	000001	        IF.OFF  S,COL                   ;JUMP IF NO ARGUMENT.
  6688	412517'	260740	402356'	        GOSUB   GETSIX                  ;GET A HELP FILE NAME.
  6689	412520'	202540	001701'	        MOVEM   WD,HFILE                ;SAVE THE NAME.
  6690	412521'	606000	000040	HELP1:  IF.ON   S,EOL                   ;SKIP IF END OF COMMAND.
  6691	412522'	260740	402457'	        GOSUB   GETONE                  ;SCAN TO END OF LINE.
  6692	412523'	606000	000040	        IF.OFF  S,EOL,HELP1             ;FIND END OF LINE.
  6693	412525'	050300	412560'	        OPEN    HF,HLPDEV               ;OPEN THE DEVICE.
  6694	412526'	254000	410225'	        GOTO    NOHELP                  ;CAN'T PROVIDE HELP.
  6695	412527'	076300	001701'	        LOOKUP  HF,HFILE                ;OPEN THE FILE.
  6696	412530'	254000	410225'	        GOTO    NOHELP                  ;CAN'T PROVIDE HELP.
  6697	412531'	200140	411237*	        MOVE    T1,JOBFF                ;GET FIRST FREE.
  6698	412532'	275140	000001	        SUBI    T1,ONE                  ;TO SET UP IOWD.
  6699	412533'	542140	001707'	        HRRM    T1,HFCTL                ;SET CTRL WORD.
  6700	412534'	271140	000201	        ADDI    T1,201                  ;LAST LOCATION NEEDED.
  6701	412535'	435140	001777	        IORI    T1,1777                 ;TO A K BOUNDARY.
  6702	412536'	317140	411603*	        CAMG    T1,JOBREL               ;SKIP IF NEED MORE CORE.
  6703	412537'	254000	412542'	        GOTO    .+3                     ;O.K. LIKE IT IS.
  6704	412540'	047140	000011	        MME     T1,.CORE                ;GET MORE CORE.
  6705	412541'	254000	410270'	        GOTO    NOCORE                  ;NO CORE YOU LOOSE.
  6706	412542'	260740	410441'	        GOSUB   CRLF                    ;SKIP A LINE.
  6707	412543'	620000	001000	HELP2:  DEVOP   IN,HF,HFCTL             ;READ A BLOCK.
  6708	412546'	254000	412553'	        GOTO    HELP3                   ;CONTINUE ON.
  6709	412547'	062300	000003	        GETSTS  HF,T1                   ;GET THE DEVICE STATUS.
  6710	412550'	606140	760000	        IF.OFF  T1,E.ERR!E.EOF,HELP3    ;JUMP IF NO ERROR.
  6711	412552'	254000	400057'	        GOTO    NTHERE                  ;ON ANY ERROR CALL IT EOF.
  6712	412553'	550140	001707'	HELP3:  HRRZ    T1,HFCTL                ;GET POINTER TO BUFFER.
  6713	412554'	402003	000201	        SETZM   201(T1)                 ;FOR ASCIZ.
  6714	412555'	051143	000001	        EME     .STR,ONE(T1)            ;SEND THE BUFFER.
  6715	412556'	254000	412543'	        GOTO    HELP2                   ;CONTINUE ON.
  6716
  6717	412557'	000000	000006	        EXP     HF
  6718	412560'	000000	000017	HLPDEV: EXP     DMP
  6719	412561'	637163	000000	        SIXBIT  "SYS"
  6720	412562'			        BSS     ONE
  6721
  6722	001701'			        USE     DATA
  6723
  6724	001701'	564155	450000	HFILE:  SIXBIT  "NAME"
  6725	001702'	505460	000000	        SIXBIT  "HLP"
  6726	001703'			        BSS     4
  6727	001707'	777600	777777	HFCTL:  IOWD    200,ZERO
  6728	001710'			        BSS     ONE
  6729
  6730	412563'			        USE     CODE
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 130
MAGCON.MAC	 6-JUL-77 09:25		*** TABLES ***

  6731				SUBTTL                  *** TABLES ***
  6732
  6733	412563'	000100	040100	CH.CHR: XWD     "@",ATS!SOM                     ;DELIMITER TABLE.
  6734	412564'	000072	000101	        XWD     ":",COL!SOM
  6735	412565'	000056	000102	        XWD     ".",PER!SOM
  6736	412566'	000050	000110	        XWD     "(",BRK!SOM
  6737	412567'	000057	000104	        XWD     "/",SLH!SOM
  6738	412570'	000137	000120	        XWD     "_",IO!SOM
  6739	412571'	000075	000120	        XWD     "=",IO!SOM
  6740	412572'	000015	000140	        XWD     15,EOL!SOM
  6741	412573'	000033	200140	        XWD     33,EOL!SPC!ALT!SOM
  6742	412574'	000041	000100	        XWD     "!",SOM                 ;FOR  LEAVING DIALOG MODE
  6743	412575'	000175	200140	        XWD     175,EOL!SPC!ALT!SOM
  6744	412576'	000176	200140	        XWD     176,EOL!SPC!ALT!SOM
  6745			000014	CH.CNT==.-CH.CHR
  6746
  6747	412577'	554153	450000	COMTAB: <SIXBIT "MAKE">                         ;COMMAND TABLE.
  6748	412600'	445141	545747	        <SIXBIT "DIALOG">
  6749	412601'	644562	555156	        <SIXBIT "TERMINATE">
  6750	412602'	427145	000000	        <SIXBIT "BYE">
  6751	412603'	616551	640000	        <SIXBIT "QUIT">
  6752	412604'	457051	640000	        <SIXBIT "EXIT">
  6753	412605'	444464	000000	        <SIXBIT "DDT">
  6754	412606'	444542	654747	        <SIXBIT "DEBUGGER">
  6755	412607'	504554	600000	        <SIXBIT "HELP">
  6756	412610'	457060	544151	        <SIXBIT "EXPLAIN">
  6757	412611'	624564	415156	        <SIXBIT "RETAIN">
  6758	412612'	456241	634500	        <SIXBIT "ERASE">
  6759	412613'	626556	000000	        <SIXBIT "RUN">
  6760	412614'	604562	465762	        <SIXBIT "PERFORM">
  6761	412615'	606251	566400	        <SIXBIT "PRINT">
  6762	412616'	624567	515644	        <SIXBIT "REWIND">
  6763			000020	COMCNT==.-COMTAB
  6764
  6765	412617'	000000	402617'	COMDIS: XWD     ZERO,CRETAB                     ;COMMAND DISPATCH TABLE.
  6766	412620'	000000	400302'	        XWD     ZERO,DIALOG
  6767	412621'	000000	400172'	        XWD     ZERO,STOP
  6768	412622'	000000	400207'	        XWD     ZERO,LOGOFF
  6769	412623'	000000	400172'	        XWD     ZERO,STOP
  6770	412624'	000000	400172'	        XWD     ZERO,STOP
  6771	412625'	000000	400175'	        XWD     ZERO,DEBUG
  6772	412626'	000000	400175'	        XWD     ZERO,DEBUG
  6773	412627'	000000	412515'	        XWD     ZERO,SW.H
  6774	412630'	000000	412515'	        XWD     ZERO,SW.H
  6775	412631'	000000	400214'	        XWD     ZERO,RETAIN
  6776	412632'	000000	400216'	        XWD     ZERO,ERASE
  6777	412633'	000000	400244'	        XWD     ZERO,PERFOR
  6778	412634'	000000	400244'	        XWD     ZERO,PERFOR
  6779	412635'	000000	401502'	        XWD     ZERO,XPRINT
  6780	412636'	000000	400220'	        XWD     ZERO,REWNOW
  6781	412637'	000000	400144'	        XWD     ZERO,NOTCOM
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 131
MAGCON.MAC	 6-JUL-77 09:25		*** TABLES ***

  6782	412640'	416343	515100	M.TAB:  <SIXBIT "ASCII">                        ;TABLE TO SET CONVERSION INDEX.
  6783	412641'	506041	634351	        <SIXBIT "HPASCII">
  6784	412642'	474541	634351	        <SIXBIT "GEASCII">
  6785	412643'	515541	474500	        <SIXBIT "IMAGE">
  6786	412644'	574364	415400	        <SIXBIT "OCTAL">
  6787	412645'	635170	425164	        <SIXBIT "SIXBIT">
  6788	412646'	465170	635170	        <SIXBIT "FIXSIX">
  6789	412647'	424354	000000	        <SIXBIT "BCL">
  6790	412650'	424344	000000	        <SIXBIT "BCD">
  6791	412651'	434443	000000	        <SIXBIT "CDC">
  6792	412652'	474542	434400	        <SIXBIT "GEBCD">
  6793	412653'	505756	424344	        <SIXBIT "HONBCD">
  6794	412654'	454243	445143	        <SIXBIT "EBCDIC">
  6795	412655'	664542	434451	        <SIXBIT "VEBCDIC">
  6796			000016	M.CNT==.-M.TAB
  6797
  6798	412656'	000000	402070'	M.DIS:  XWD     ZERO,M.RET                      ;DISPATCH TABLE FOR MODE.
  6799	412657'	000000	410254'	        XWD     ZERO,FOMERR
  6800
  6801	412660'	000000	000004	NWUTAB: XWD     ZERO,NOHEAD                     ;BITS FOR SWITCHES.
  6802	412661'	000000	040000	        XWD     ZERO,NOCRLF
  6803	412662'	000000	000002	        XWD     ZERO,UNLOAD
  6804	412663'	000000	000010	        XWD     ZERO,IND
  6805	412664'	000000	000020	        XWD     ZERO,NOERROR
  6806	412665'	000000	000040	        XWD     ZERO,SPAN
  6807	412666'	000000	000400	        XWD     ZERO,SCAN
  6808			000007	NWUCNT==.-NWUTAB
  6809
  6810	412667'	565756	450000	LB.TAB: <SIXBIT "NONE">                         ;LABEL TYPE TABLE.
  6811	412670'	555156	450000	        <SIXBIT "MINE">
  6812	412671'	426562	625765	        <SIXBIT "BURROUGHS">
  6813	412672'	445147	516441	        <SIXBIT "DIGITAL">
  6814	412673'	444543	000000	        <SIXBIT "DEC">
  6815	412674'	514255	000000	        <SIXBIT "IBM">
  6816	412675'	474526	232500	        <SIXBIT "GE635">
  6817			000007	LB.CNT==.-LB.TAB
  6818
  6819	412676'	000000	402202'	LB.DIS: XWD     ZERO,L.RET                      ;DISPATCH FOR LABELS.
  6820	412677'	000000	410254'	        XWD     ZERO,FOMERR
  6821
  6822	412700'	412060'	405326'	LB.TYP: XWD     RET0,LB.NON                     ;LABEL DISPATCH TABLE.
  6823	412701'	405626'	405356'	        XWD     LB.OMI,LB.IMI
  6824	412702'	406242'	405416'	        XWD     LB.OBL,LB.IBL
  6825	412703'	406360'	405456'	        XWD     LB.OCL,LB.ICL
  6826	412704'	406360'	405456'	        XWD     LB.OCL,LB.ICL
  6827	412705'	405710'	405561'	        XWD     LB.OBM,LB.IBM
  6828	412706'	406144'	405516'	        XWD     LB.OGE,LB.IGE
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 132
MAGCON.MAC	 6-JUL-77 09:25		*** TABLES ***

  6829	412707'	565750	454144	SW.TAB: <SIXBIT "NOHEADER">                     ;SWITCH TABLE.
  6830	412710'	565743	625446	        <SIXBIT "NOCRLF">
  6831	412711'	655654	574144	        <SIXBIT "UNLOAD">
  6832	412712'	515644	656364	        <SIXBIT "INDUSTRY">
  6833	412713'	565745	626257	        <SIXBIT "NOERROR">
  6834	412714'	636041	560000	        <SIXBIT "SPAN">
  6835	412715'	634341	560000	        <SIXBIT "SCAN">
  6836	412716'	504541	444562	        <SIXBIT "HEADER">
  6837	412717'	436254	460000	        <SIXBIT "CRLF">
  6838	412720'	565765	565457	        <SIXBIT "NOUNLOAD">
  6839	412721'	565751	564465	        <SIXBIT "NOINDUSTRY">
  6840	412722'	456262	576200	        <SIXBIT "ERROR">
  6841	412723'	565763	604156	        <SIXBIT "NOSPAN">
  6842	412724'	565763	434156	        <SIXBIT "NOSCAN">
  6843	412725'	444556	635164	        <SIXBIT "DENSITY">
  6844	412726'	544142	455400	        <SIXBIT "LABEL">
  6845	412727'	555744	450000	        <SIXBIT "MODE">
  6846	412730'	425457	435300	        <SIXBIT "BLOCK">
  6847	412731'	425453	635172	        <SIXBIT "BLKSIZE">
  6848	412732'	604162	516471	        <SIXBIT "PARITY">
  6849	412733'	414466	415643	        <SIXBIT "ADVANCE">
  6850	412734'	504554	600000	        <SIXBIT "HELP">
  6851	412735'	624543	576244	        <SIXBIT "RECORD">
  6852	412736'	624543	000000	        <SIXBIT "REC">
  6853	412737'	624543	635172	        <SIXBIT "RECSIZE">
  6854	412740'	624545	540000	        <SIXBIT "REEL">
  6855	412741'	604163	636757	        <SIXBIT "PASSWORD">
  6856	412742'	624564	415156	        <SIXBIT "RETAIN">
  6857	412743'	626556	000000	        <SIXBIT "RUN">
  6858	412744'	604562	465762	        <SIXBIT "PERFORM">
  6859	412745'	457060	544151	        <SIXBIT "EXPLAIN">
  6860	412746'	426546	464562	        <SIXBIT "BUFFERS">
  6861	412747'	545163	640000	        <SIXBIT "LIST">
  6862	412750'	565754	516364	        <SIXBIT "NOLIST">
  6863	412751'	465451	636400	        <SIXBIT "FLIST">
  6864	412752'	644554	540000	        <SIXBIT "TELL">
  6865	412753'	565764	455454	        <SIXBIT "NOTELL">
  6866	412754'	624567	515644	        <SIXBIT "REWIND">
  6867	412755'	565762	456751	        <SIXBIT "NOREWIND">
  6868	412756'	424143	536360	        <SIXBIT "BACKSPACE">
  6869	412757'	635351	606245		<SIXBIT "SKIPRECORDS">
  6870	412760'	444554	425441		<SIXBIT "DELBLANKS">
  6871	412761'	565744	455442		<SIXBIT "NODELBLANKS">
  6872			000053	SW.CNT==.-SW.TAB
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 133
MAGCON.MAC	 6-JUL-77 09:25		*** TABLES ***

  6873	412762'	000000	402015'	SW.DIS: XWD     ZERO,SW.NWU                     ;DISPATCH TABLE FOR SWITCHES.
  6874	412763'	000000	402015'	        XWD     ZERO,SW.NWU
  6875	412764'	000000	402015'	        XWD     ZERO,SW.NWU
  6876	412765'	000000	402015'	        XWD     ZERO,SW.NWU
  6877	412766'	000000	402015'	        XWD     ZERO,SW.NWU
  6878	412767'	000000	402015'	        XWD     ZERO,SW.NWU
  6879	412770'	000000	402015'	        XWD     ZERO,SW.NWU
  6880	412771'	000000	402020'	        XWD     ZERO,SW.OFF
  6881	412772'	000000	402020'	        XWD     ZERO,SW.OFF
  6882	412773'	000000	402020'	        XWD     ZERO,SW.OFF
  6883	412774'	000000	402020'	        XWD     ZERO,SW.OFF
  6884	412775'	000000	402020'	        XWD     ZERO,SW.OFF
  6885	412776'	000000	402020'	        XWD     ZERO,SW.OFF
  6886	412777'	000000	402020'	        XWD     ZERO,SW.OFF
  6887	413000'	000000	402155'	        XWD     ZERO,SW.D
  6888	413001'	000000	402172'	        XWD     ZERO,SW.L
  6889	413002'	000000	402060'	        XWD     ZERO,SW.M
  6890	413003'	000000	402073'	        XWD     ZERO,SW.B
  6891	413004'	000000	402073'	        XWD     ZERO,SW.B
  6892	413005'	000000	402023'	        XWD     ZERO,SW.P
  6893	413006'	000000	402105'	        XWD     ZERO,SW.A
  6894	413007'	000000	412515'	        XWD     ZERO,SW.H
  6895	413010'	000000	402100'	        XWD     ZERO,SW.R
  6896	413011'	000000	402100'	        XWD     ZERO,SW.R
  6897	413012'	000000	402100'	        XWD     ZERO,SW.R
  6898	413013'	000000	402204'	        XWD     ZERO,SW.RL
  6899	413014'	000000	402043'	        XWD     ZERO,SW.PW
  6900	413015'	000000	402211'	        XWD     ZERO,SW.KEP
  6901	413016'	000000	402213'	        XWD     ZERO,SW.GO
  6902	413017'	000000	402213'	        XWD     ZERO,SW.GO
  6903	413020'	000000	412515'	        XWD     ZERO,SW.H
  6904	413021'	000000	402304'	        XWD     ZERO,SW.BUF
  6905	413022'	000000	402332'	        XWD     ZERO,XLST
  6906	413023'	000000	402335'	        XWD     ZERO,XNLST
  6907	413024'	000000	402330'	        XWD     ZERO,XFLST
  6908	413025'	000000	402037'	        XWD     ZERO,XTELL
  6909	413026'	000000	402041'	        XWD     ZERO,XNTELL
  6910	413027'	000000	402124'	        XWD     ZERO,REWIND
  6911	413030'	000000	402141'	        XWD     ZERO,NOREW
  6912	413031'	000000	402112'	        XWD     ZERO,SW.BK
  6913	413032'	000000	402117'		XWD	ZERO,SW.AR
  6914	413033'	000000	401364'		XWD	ZERO,Q24SET
  6915	413034'	000000	401365'		XWD	ZERO,Q24CLR
  6916	413035'	000000	410251'	        XWD     ZERO,IMPSW
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 134
MAGCON.MAC	 6-JUL-77 09:25		*** TABLES ***

  6917	413036'	414664	456200	REWTAB: <SIXBIT "AFTER">                        ;REWIND SWITCH ARGUMENTS.
  6918	413037'	424546	576245	        <SIXBIT "BEFORE">
  6919	413040'	415467	417163	        <SIXBIT "ALWAYS">
  6920	413041'	575551	640000	        <SIXBIT "OMIT">
  6921			000004	REWCNT==.-REWTAB
  6922
  6923	413042'	000000	402132'	REWDIS: XWD     ZERO,REWRET                     ;DISPATCH TABLE FOR REWIND.
  6924	413043'	000000	410254'	        XWD     ZERO,FOMERR
  6925
  6926	413044'	000000	402147'	NORDIS: XWD     ZERO,NOWRET                     ;DISPATCH TABLE FOR NOWIND.
  6927	413045'	000000	410254'	        XWD     ZERO,FOMERR
  6928
  6929	413046'	000000	010000	REWBIT: XWD     ZERO,AWIND                      ;BITS FOR REWIND OR NOWIND.
  6930	413047'	000000	020000	        XWD     ZERO,BWIND
  6931	413050'	000000	030000	        XWD     ZERO,AWIND!BWIND
  6932	413051'	000000	030000	        XWD     ZERO,AWIND!BWIND
  6933
  6934	413052'	574444	000000	PR.TAB: <SIXBIT "ODD">                          ;PARITY TABLE.
  6935	413053'	456645	560000	        <SIXBIT "EVEN">
  6936			000002	PR.CNT==.-PR.TAB
  6937
  6938	413054'	000000	402032'	PR.DIS: XWD     ZERO,ODDRET                     ;DISPATCH FOR PARITY.
  6939	413055'	000000	402033'	        XWD     ZERO,EVERET
  6940	413056'	000000	410254'	        XWD     ZERO,FOMERR
  6941
  6942	413057'	222020	000000	DN.TAB: <SIXBIT "200">                          ;DENSITY TABLE.
  6943	413060'	252526	000000	        <SIXBIT "556">
  6944	413061'	302020	000000	        <SIXBIT "800">
  6945			000003	DN.CNT==.-DN.TAB
  6946
  6947	413062'	000000	402167'	DN.DIS: XWD     ZERO,D.RET                      ;DISPATCH TABLE FOR DENSITY.
  6948	413063'	000000	410254'	        XWD     ZERO,FOMERR
  6949	413064'	262225	200000	DN1.TB: <SIXBIT "6250">
  6950	413065'	212620	200000	        <SIXBIT "1600">
  6951	413066'	302020	000000	        <SIXBIT "800">
  6952	413067'	252526	000000	        <SIXBIT "556">
  6953	413070'	222020	000000	        <SIXBIT "200">
  6954			000005	DN1.CT==.-DN1.TB
  6955
  6956	413071'	000000	402223'	DN1.DS: XWD     ZERO,D1.RT
  6957	413072'	000000	410254'	        XWD     ZERO,FOMERR
  6958
  6959	413073'	000000	000020	DN2.TB: 20
  6960	413074'	000000	000010	        10
  6961	413075'	000000	000004	        4
  6962	413076'	000000	000002	        2
  6963	413077'	000000	000001	        1
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 135
MAGCON.MAC	 6-JUL-77 09:25		*** TABLES ***

  6964	413100'	444164	410000	E.TAB:  <SIXBIT "DATA">                         ;COMMANDS THAT USE = OR _.
  6965			000001	E.CNT=.-E.TAB
  6966
  6967	413101'	000000	402353'	E.DIS:  XWD     ZERO,E.RET                      ;DISPATCH TABLE FOR SPECIALS.
  6968	413102'	000000	400147'	        XWD     ZERO,GETWOD
  6969
  6970	413103'	000001	000000	E.BIT:  EXP     DATA                            ;BITS TO SET FOR SPECIALS.
  6971
  6972	413104'	444464	000000	RUNTAB: <SIXBIT "DDT">                          ;RUNTIME COMMANDS.
  6973	413105'	444542	654747	        <SIXBIT "DEBUGGER">
  6974	413106'	675041	640000	        <SIXBIT "WHAT">
  6975	413107'	465154	456300	        <SIXBIT "FILES">
  6976	413110'	636457	600000	        <SIXBIT "STOP">
  6977	413111'	604165	634500	        <SIXBIT "PAUSE">
  6978			000006	RUNLEN==.-RUNTAB
  6979
  6980	413112'	000000	412350'	RUNDIS: XWD     ZERO,RUNDDT                     ;RUNTIME DISPATCH TABLE.
  6981	413113'	000000	412350'	        XWD     ZERO,RUNDDT
  6982	413114'	000000	412353'	        XWD     ZERO,RUNWHT
  6983	413115'	000000	412355'	        XWD     ZERO,RUNFIL
  6984	413116'	000000	410500'	        XWD     ZERO,STOPIT
  6985	413117'	000000	412371'	        XWD     ZERO,PAUSE
  6986	413120'	000000	412375'	        XWD     ZERO,BADRUN
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 136
MAGCON.MAC	 6-JUL-77 09:25		*** TABLES ***

  6987	001711'			        USE     DATA
  6988
  6989	001711'			BSS     TAB1,^D256                              ;CONVERSION TABLES.
  6990	002311'			BSS     TAB2,^D256
  6991	002711'			BSS     CTRL,TWO                                ;I/O LIST FOR DATA FILE.
  6992	002713'			BSS     IVBCNT,ONE                              ;EBCDIC BLOCK COUNT.
  6993	002714'			BSS     OSIZE,ONE                               ;SIZE OF OUTPUT RCORD.
  6994	002715'			BSS     OBSIZE,ONE                              ;SIZE OF OUTPUT BLOCK.
  6995	002716'			BSS     OT0TMP,ONE                              ;WORD FOR OCTAL.
  6996	002717'			BSS     OT1TMP,ONE                              ;LINE COUNT FOR OCTAL.
  6997
  6998	002720'			BSS     DFPTR,ONE                               ;INDEX POINTERS FOR TABLES.
  6999	002721'			BSS     DFFLG,ONE                               ;NON-ZERO IF DATA FILE IS OPEN.
  7000	002722'	000000	000005	        EXP     DF                              ;CHANNEL NUMBER.
  7001	002723'	000000	000017	DATDEV: XWD     ZERO,DMP                        ;DEVICE FOR DATA FILE.
  7002	002724'	446353	000000	        SIXBIT  "DSK"
  7003	002725'			        BSS     ONE
  7004	002726'	554147	435756	DATFIL: SIXBIT  "MAGCON"                        ;NAME OF DATA FILE.
  7005	002727'	444164	000000	        SIXBIT  "DAT"
  7006	002730'			        BSS     TWO
  7007
  7008	002732'	000000	000017	DMPDEV: XWD     ZERO,DMP                        ;DUMP OF US TO DISK.
  7009	002733'	446353	000000	        SIXBIT  "DSK"                           ;ON DEVICE DISK.
  7010	002734'			        BSS     ONE
  7011	002735'	564155	450000	DMPFIL: SIXBIT  "NAME"                          ;NAME TO DUMP TO.
  7012	002736'	445560	000000	        SIXBIT  "DMP"
  7013	002737'			        BSS     TWO
  7014	002741'	777747	000475'	DMPLST: IOWD    SYSNAM+4-AC,AC
  7015	002742'	000000	000136	        XWD     ZERO,136
  7016	002743'			        BSS     ONE
  7017
  7018	413121'			        USE     CODE
  7019
  7020	413121'	637163	000000	LOGPRG: SIXBIT  "SYS"                           ;FOR RUN ON LOGOUT.
  7021	413122'	545747	576564	        SIXBIT  "LOGOUT"
  7022	413123'			        BSS     4
  7023
  7024	413127'	714563	000000	YESTAB: <SIXBIT "YES">                          ;USED FOR YES NO REPLIES.
  7025	413130'	565700	000000	        <SIXBIT "NO">
  7026			000002	YESCNT==.-YESTAB
  7027
  7028	413131'	000000	401464'	YESDIS: XWD     ZERO,YESRET                     ;RETURNS FOR YES NO REPLIES.
  7029	413132'	000000	401467'	        XWD     ZERO,NORET
  7030	413133'	000000	401472'	        XWD     ZERO,XYNRET
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 137
MAGCON.MAC	 6-JUL-77 09:25		*** TABLES ***

  7031				;TABLE OF MESSAGES THAT ARE PUT ON THE TRAILING
  7032				;HEADER.
  7033
  7034	413134'	000000	415731'	ENDTAB: [SIXBIT "END         "]
  7035	413135'	000000	415733'	        [SIXBIT "FINIS       "]
  7036	413136'	000000	415735'	        [SIXBIT "TERMINUS    "]
  7037	413137'	000000	415737'	        [SIXBIT "CEASE       "]
  7038	413140'	000000	415741'	        [SIXBIT "HALT        "]
  7039	413141'	000000	415743'	        [SIXBIT "STOP        "]
  7040	413142'	000000	415745'	        [SIXBIT "CLOSE       "]
  7041	413143'	000000	415747'	        [SIXBIT "CONCLUDE    "]
  7042	413144'	000000	415751'	        [SIXBIT "ARREST      "]
  7043	413145'	000000	415753'	        [SIXBIT "CHECKMATE   "]
  7044	413146'	000000	415755'	        [SIXBIT "TERMINATE   "]
  7045	413147'	000000	415757'	        [SIXBIT "DIE         "]
  7046	413150'	000000	415761'	        [SIXBIT "COOL_IT     "]
  7047	413151'	000000	415763'	        [SIXBIT "REST        "]
  7048	413152'	000000	415765'	        [SIXBIT "CRASH       "]
  7049	413153'	000000	415767'	        [SIXBIT "THE_END     "]
  7050	413154'	000000	415771'	        [SIXBIT "STOP_THE_CPU"]
  7051	413155'	000000	415773'	        [SIXBIT "BREAK       "]
  7052	413156'	000000	415775'	        [SIXBIT "STOP_CODE   "]
  7053	413157'	000000	415777'	        [SIXBIT "RIGHT_ON    "]
  7054	413160'	000000	416001'	        [SIXBIT "TRASH       "]
  7055			000025	ENDCNT==.-ENDTAB
  7056
  7057				;CHARACTER TABLE FOR LINE PRINTER HEADINGS.
  7058
  7059	413161'	000000	000000	CHRTAB: BYTE (5) 00,00,00,00,00,00,00           ; SP
  7060	413162'	102041	020010	        BYTE (5) 04,04,04,04,04,00,04           ; !
  7061	413163'	245000	000000	        BYTE (5) 12,12,00,00,00,00,00           ; "
  7062	413164'	245372	575224	        BYTE (5) 12,12,37,12,37,12,12           ; #
  7063	413165'	117647	627710	        BYTE (5) 04,37,24,37,05,37,04           ; $
  7064	413166'	634421	042346	        BYTE (5) 31,31,02,04,10,23,23           ; %
  7065	413167'	212105	116232	        BYTE (5) 10,24,10,24,23,22,15           ; &
  7066	413170'	141000	000000	        BYTE (5) 06,02,00,00,00,00,00           ; '
  7067	413171'	104204	101010	        BYTE (5) 04,10,20,20,20,10,04           ; (
  7068	413172'	101010	204210	        BYTE (5) 04,02,01,01,01,02,04           ; )
  7069	413173'	012566	672500	        BYTE (5) 00,25,16,33,16,25,00           ; *
  7070	413174'	002047	620400	        BYTE (5) 00,04,04,37,04,04,00           ; +
  7071	413175'	000000	001410	        BYTE (5) 00,00,00,00,00,14,04           ; ,
  7072	413176'	000007	600000	        BYTE (5) 00,00,00,37,00,00,00           ; -
  7073	413177'	000000	001430	        BYTE (5) 00,00,00,00,00,14,14           ; .
  7074	413200'	000010	421040	        BYTE (5) 00,00,01,02,04,10,20           ; /
  7075	413201'	350635	346134	        BYTE (5) 16,21,23,25,31,21,16           ; 0
  7076	413202'	106041	020434	        BYTE (5) 04,14,04,04,04,04,16           ; 1
  7077	413203'	350410	421076	        BYTE (5) 16,21,01,02,04,10,37           ; 2
  7078	413204'	350410	406134	        BYTE (5) 16,21,01,02,01,21,16           ; 3
  7079	413205'	451227	610204	        BYTE (5) 22,22,22,37,02,02,02           ; 4
  7080	413206'	770340	206134	        BYTE (5) 37,20,34,01,01,21,16           ; 5
  7081	413207'	350207	506134	        BYTE (5) 16,20,20,36,21,21,16           ; 6
  7082	413210'	760410	421040	        BYTE (5) 37,01,01,02,04,10,20           ; 7
  7083	413211'	350613	506134	        BYTE (5) 16,21,21,16,21,21,16           ; 8
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 137-2
MAGCON.MAC	 6-JUL-77 09:25		*** TABLES ***

  7084	413212'	350613	604134	        BYTE (5) 16,21,21,17,01,01,16           ; 9
  7085	413213'	003060	030600	        BYTE (5) 00,06,06,00,06,06,00           ; :
  7086	413214'	003060	030604	        BYTE (5) 00,06,06,00,06,06,02           ; ;
  7087	413215'	042104	040404	        BYTE (5) 02,04,10,20,10,04,02           ; <
  7088	413216'	000370	174000	        BYTE (5) 00,00,37,00,37,00,00           ; =
  7089	413217'	202020	210420	        BYTE (5) 10,04,02,01,02,04,10           ; >
  7090	413220'	350410	420010	        BYTE (5) 16,21,01,02,04,00,04           ; ?
  7091	413221'	350615	726516	        BYTE (5) 16,21,21,27,25,25,07           ; @
  7092	413222'	350614	376142	        BYTE (5) 16,21,21,21,37,21,21           ; A
  7093	413223'	750617	506174	        BYTE (5) 36,21,21,36,21,21,36           ; B
  7094	413224'	370204	102036	        BYTE (5) 17,20,20,20,20,20,17           ; C
  7095	413225'	750614	306174	        BYTE (5) 36,21,21,21,21,21,36           ; D
  7096	413226'	770207	502076	        BYTE (5) 37,20,20,36,20,20,37           ; E
  7097	413227'	770207	502040	        BYTE (5) 37,20,20,36,20,20,20           ; F
  7098	413230'	370204	136134	        BYTE (5) 17,20,20,20,27,21,16           ; G
  7099	413231'	430617	706142	        BYTE (5) 21,21,21,37,21,21,21           ; H
  7100	413232'	342041	020434	        BYTE (5) 16,04,04,04,04,04,16           ; I
  7101	413233'	020410	306134	        BYTE (5) 01,01,01,01,21,21,16           ; J
  7102	413234'	430627	112142	        BYTE (5) 21,21,22,34,22,21,21           ; K
  7103	413235'	410204	102076	        BYTE (5) 20,20,20,20,20,20,37           ; L
  7104	413236'	435654	306142	        BYTE (5) 21,33,25,21,21,21,21           ; M
  7105	413237'	430715	316142	        BYTE (5) 21,21,31,25,23,21,21           ; N
  7106	413240'	350614	306134	        BYTE (5) 16,21,21,21,21,21,16           ; O
  7107	413241'	750617	502040	        BYTE (5) 36,21,21,36,20,20,20           ; P
  7108	413242'	350614	326232	        BYTE (5) 16,21,21,21,25,22,15           ; Q
  7109	413243'	750617	522242	        BYTE (5) 36,21,21,36,24,22,21           ; R
  7110	413244'	370203	404174	        BYTE (5) 17,20,20,16,01,01,36           ; S
  7111	413245'	762041	020410	        BYTE (5) 37,04,04,04,04,04,04           ; T
  7112	413246'	430614	306176	        BYTE (5) 21,21,21,21,21,21,37           ; U
  7113	413247'	430614	305210	        BYTE (5) 21,21,21,21,21,12,04           ; V
  7114	413250'	430614	327342	        BYTE (5) 21,21,21,21,25,33,21           ; W
  7115	413251'	430521	052142	        BYTE (5) 21,21,12,04,12,21,21           ; X
  7116	413252'	430521	020410	        BYTE (5) 21,21,12,04,04,04,04           ; Y
  7117	413253'	760421	042076	        BYTE (5) 37,01,02,04,10,20,37           ; Z
  7118	413254'	304102	041030	        BYTE (5) 14,10,10,10,10,10,14           ; [
  7119	413255'	000202	020202	        BYTE (5) 00,00,20,10,04,02,01           ; \
  7120	413256'	141020	410214	        BYTE (5) 06,02,02,02,02,02,06           ; ]
  7121	413257'	002165	220400	        BYTE (5) 00,04,16,25,04,04,00           ; ^
  7122	413260'	000000	000000	        BYTE (5) 00,00,00,00,00,00,00           ; SPACE USED IN MESSAGES.
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 138
MAGCON.MAC	 6-JUL-77 09:25		*** TABLES ***

  7123				;THE FOLLOWING TABLES ARE FOR THE CHARACTER SET MODES.
  7124				;THE MACRO "MTABLE" WILL SET UP THE POINTERS TO THE MODE
  7125				;DATA BLOCK. WHILE THE MACRO "TABLE" WILL SET ALL THE DATA
  7126				;ABOUT A CERTAIN CHARACTER SET.
  7127
  7128	413261'			FTABLE  -123456                                 ;MUST BE BEFORE WHAT FOLLOWS.
  7129
  7130	413261'	000000	413277'	MTABLE  <ASC,HPA,GEA,IMG,OCT,SIX,FIX,BCL,BCD,CDC,XBD,HBD,EBC,VEB>
  7131	413277'	000000	404302'	TABLE   ASCII,ASC,7,128,NOR!TAB
  7132	413312'	000000	404302'	TABLE   HPASCII,HPA,8,0,NOR!TAB
  7133	413325'	000000	404302'	TABLE   GEASCII,GEA,9,0,NOR!TAB
  7134	413340'	000000	404527'	TABLE   IMAGE,IMG,36,0,0
  7135	413353'	000000	410505'	TABLE   OCTAL,OCT,7,0,0
  7136	413366'	000000	404702'	TABLE   SIXBIT,SIX,6,64,NOR!6
  7137	413401'	000000	404775'	TABLE   FIXSIX,FIX,6,0,NOR!NIR
  7138	413414'	000000	404775'	TABLE   BCL,BCL,6,64,NOR!NIR
  7139	413427'	000000	404775'	TABLE   BCD,BCD,6,64,NOR!NIR
  7140	413442'	000000	404775'	TABLE   CDC,CDC,6,64,NOR!NIR
  7141	413455'	000000	404775'	TABLE   GEBCD,XBD,6,64,NOR!NIR
  7142	413470'	000000	404775'	TABLE   HONBCD,HBD,6,64,NOR!NIR
  7143	413503'	000000	404775'	TABLE   EBCDIC,EBC,8,256,NOR!NIR!TAB
  7144	413516'	000000	405077'	TABLE   VEBCDIC,VEB,8,0,NOR!EXW!TAB!4
  7145
  7146			400000'	        END     START
  7147
NO ERRORS DETECTED
HI-SEG. BREAK IS 416003
LO-SEG. BREAK IS 002744
9K CORE USED
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 139
MAGCON.MAC	 6-JUL-77 09:25		SYMBOL TABLE

ABORT		410505'		BUFNUM		000021	SPD	CHKBL1		404457'		CTAB		401034'	
ABORT1		410514'		BWIND		020000	SPD	CHKBL2		404461'		CTLC		410455'	
ABTEND		410556'		BYEAR		411777'		CHKBL3		404463'		CTLC0		410464'	
AC		000476'		BYTSIZ		000023	SPD	CHKBLN		404453'		CTRL		002711'	
ADV		020000	SPD	C10		400721'		CHKDEM		400150'		CURPTR		000405'	
ADVAN		000012	SPD	C11T16		400736'		CHKDEV		403113'		CVTLAB		407610'	
ADVR	004000	000000	SPD	C12		400733'		CHKENT		400571'		D.RET		402167'	
ALT		200000	SPD	C18		400745'		CHKEOF		407221'		D1.RT		402223'	
ANYCHR		411350'		C18T19		400747'		CHKEXT		411674'		DATA	000001	000000	SPD
APRTRP		412274'		C1A		400631'		CHKLOK		410005'		DATBCL		411462'	
ASC		000000	SPD	C1B		400634'		CHKNAM		401751'		DATBL0		411510'	
ASCMOD		413277'		C2		400635'		CHKOPR		412330'		DATCOB		411442'	
ATS		040000	SPD	C20		400763'		CHKOUT		403106'		DATDEV		002723'	
AWIND		010000	SPD	C22		400771'		CHKREC		403011'		DATE		000516'	
B12	000040	000000	SPD	C23		400777'		CHKT		404026'		DATFIL		002726'	
B5	010000	000000	SPD	C23T24		401002'		CHRMOD		000017	SPD	DATTIM		000005	SPD
B5B12		400272'		C3		400650'		CHRTAB		413161'		DDTCAL		400202'	
BAC		040000	SPD	C4		400656'		CK36		407251'		DDTERR		410261'	
BACK		410353'		C5		400667'		CLEAR		410306'		DEBUG		400175'	
BACSPC		000022	SPD	C6		400676'		CLEAR1		410003'		DECODE		406513'	
BAD	000010	000000	SPD	C8		400705'		CLO1		403500'		DECOUT		410672'	
BADCHR		410234'		C9		400711'		CLO1A		403541'		DELBLK		000416'	
BADEOF		410324'		CALDDT		400177'		CLO1B		403526'		DEN	000002	000000	SPD
BADFOM		410231'		CANLST		410314'		CLO1C		403532'		DEN1		402256'	
BADMOD		410276'		CCLBAK		401712'		CLO3		403545'		DENINC		402300'	
BADNUM		402323'		CCLBLK		000673'		CLO4		403553'		DENOUT		402270'	
BADRUN		412375'		CCLBUF		000013	SPD	CLO5		403561'		DENPTR		402216'	
BADSTR		402544'		CCLCNT		000020	SPD	CLO5B		403563'		DENSIT		000014	SPD
BADTM		410326'		CCLCOM		401647'		CLO6		403615'		DEPTWO		412004'	
BADVOL		410330'		CCLCOR		000657'		CMAX		000030	SPD	DEV		000200	SPD
BCDMOD		413427'		CCLDEV		000001	SPD	CMDLST		000643'		DEVICE		000001	SPD
BCLCHK		411521'		CCLEND		001012'	SPD	CNAM		000012	SPD	DEVSTS	047000	000054	
BCLCK0		411540'		CCLFLG		000656'		CNTTAB		402546'		DF		000005	SPD
BCLDAT		411761'		CCLGET		000011	SPD	COBDAT		411327'		DFFLG		002721'	
BCLMOD		413414'		CCLHED		000014	SPD	CODE		406516'		DFPTR		002720'	
BIN		000014	SPD	CCLLEN		000005	SPD	CODE1		406522'		DIA0		401370'	
BLACK		406554'		CCLLOK		000010	SPD	CODE2		406527'		DIA0A		401413'	
BLACKO		406552'		CCLNAM		000003	SPD	COL		000001	SPD	DIA0B		401375'	
BLANK		406624'		CCLNDV		401717'		COLUMN		000436'		DIA1		401405'	
BLK		010000	SPD	CCLOPN		000007	SPD	COMCNT		000020	SPD	DIA11		400470'	
BLKERR		410265'		CCLPPN		000006	SPD	COMDIS		412617'		DIA12		400507'	
BLKFCT		000010	SPD	CCLREL		000012	SPD	COMERR		410246'		DIA15		400523'	
BMPVOL		412117'		CCLUP		402567'		COMGO		402416'		DIA1A		400405'	
BRK		000010	SPD	CDCMOD		413442'		COMTAB		412577'		DIA22		400542'	
BUF0		407054'		CDP	100000	000000	SPD	CONVWD		000437'		DIA3		400426'	
BUF00		407073'		CDR	100000	000000	SPD	COPY		411544'		DIA3A		400413'	
BUF1		407132'		CF		000007	SPD	COPY0		411545'		DIA4		400427'	
BUF2		407133'		CH		000014		COPY1		411557'		DIA4X		401307'	
BUF3		407146'		CH.CHR		412563'		CREA1		403356'		DIA4Y		401320'	
BUF4		407147'		CH.CNT		000014	SPD	CREATE		403337'		DIA5		400436'	
BUFF		000320'		CHAN	777777	777777	SPD	CREIT		403331'		DIA6		400455'	
BUFFER		000002	SPD	CHANGE		403770'		CRETAB		402617'		DIA7		400550'	
BUFMOV		407032'		CHK1		400155'		CRLF		410441'		DIAFLG		000660'	
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 139-2
MAGCON.MAC	 6-JUL-77 09:25		SYMBOL TABLE

DIAG1		400333'		ENDCP1		403445'		GEAMOD		413325'		GTONE1		402464'	
DIAG2		400351'		ENDCP2		403451'		GENDEV		411044'		HADERR		407777'	
DIAG3		400375'		ENDEXT		407454'		GET		407154'		HBDMOD		413470'	
DIAGET		400330'		ENDTAB		413134'		GET1		407167'		HDR		000400	SPD
DIALOG		400302'		EOF1		406445'		GET12		402435'		HDRLPT		406414'	
DIRERR		411324'		EOFLAB		405316'		GET12A		402440'		HDRWRD		001024'	
DISIN		000432'		EOFLPT		406436'		GET12B		402454'		HELP1		412521'	
DISOUT		000431'		EOL		000040	SPD	GET1A		407160'		HELP2		412543'	
DK0NXT		411243'		EOR		000002	SPD	GET2		407172'		HELP3		412553'	
DMP		000017	SPD	EOTERR		410272'		GET36		407236'		HF		000006	SPD
DMPDEV		002732'		ER.ALL		000077	SPD	GETALL		407324'		HFCTL		001707'	
DMPFIL		002735'		ER.FUL		000010	SPD	GETBUF		406716'		HFILE		001701'	
DMPLST		002741'		ER.ICC		000002	SPD	GETCH0		402503'		HGH		413121'	SPD
DN.CNT		000003	SPD	ER.IDV		000001	SPD	GETCHR		402460'		HIGHT		000420'	
DN.DIS		413062'		ER.OFL		000004	SPD	GETCOM		400124'		HLPDEV		412560'	
DN.TAB		413057'		ER.QEX		000020	SPD	GETDEC		402604'		HPAMOD		413312'	
DN1.CT		000005	SPD	ER.TLX		000040	SPD	GETDEV		401722'		HUNG		001000	SPD
DN1.DS		413071'		ERASE		400216'		GETINP		403325'		I90LST		404266'	
DN1.TB		413064'		ERR0		410407'		GETLAB		407571'		I91LST		404272'	
DN2.TB		413073'		ERR1		410410'		GETLIC	777777	777760	SPD	I92LST		404276'	
DONDEN		402247'		ERR2		410416'		GETMSK		402373'		I93LST		404277'	
DREAM		411716'		ERR3		410432'		GETNAM		401734'		IBCNT		000357'	
DREAM0		411715'		ERRCNT		000027	SPD	GETNXT		410756'		IBLK		000052'	
DREAM1		411737'		ERREXT		410415'		GETONE		402457'		IBUF		000312'	
DRIVE	072000	000000		ERRMES		410175'		GETOV		410150'		ICNT		000013	
DSK	200000	000000	SPD	EVEN		001000	SPD	GETPAR		407215'		IF		000002	
DSKERR		412257'		EVERET		402033'		GETPPN		401756'		IFCNT		000365'	
DULBLK		001035'		EXIT	047000	000012		GETSIX		402356'		IFILE		000032'	
DULLST		001033'		EXT		000004	SPD	GETSW		402010'		IJOBFF		000646'	
DULNXT		410155'		EXTCHI		000430'		GETTAB		412401'		IM		000016	
DYT		403323'		EXTCHO		000427'		GETTAB	047000	000041		IMGBLT		404544'	
E.BIT		413103'		EXW	000004	000000	SPD	GETTB1		412414'		IMGBT0		404554'	
E.BOT		004000	SPD	FF		000001	SPD	GETTB2		412406'		IMGBT1		404550'	
E.CNT		000001		FFLG		020000	SPD	GETTM0		412467'		IMGMOD		413340'	
E.DIS		413101'		FILCHK		407203'		GETTM1		412474'		IMPSW		410251'	
E.EOF		020000	SPD	FILL		407174'		GETTNM		412453'		IN0ASC		404304'	
E.EOT		002000	SPD	FIN		000040	SPD	GETUNM		410130'		IN0BGE		404777'	
E.ERR		740000	SPD	FIXEXT		407430'		GETUSR		401770'		IN0IMG		404532'	
E.HAD		200000	SPD	FIXF1		407410'		GETWOD		400147'		IN0LST		404070'	
E.IOB		040000	SPD	FIXFST		407401'		GFXF1		407304'		IN0SIX		404674'	
E.LOK		400000	SPD	FIXMOD		413401'		GFXFST		407265'		IN0VEB		405104'	
E.PAR		100000	SPD	FIXULT		404360'		GITEM		400601'		IN1ASC		404322'	
E.RET		402353'		FNDONE	000100	000000	SPD	GOBLST		001454'		IN1BGE		405007'	
E.TAB		413100'		FNDTWO	000200	000000	SPD	GOSUB	260740	000000		IN1LST		404107'	
EBCMOD		413503'		FOMERR		410254'		GOTDEV		411076'		IN1SIX		404712'	
EME	051000	000000		FPTR		000010	SPD	GOTMAT		402432'		IN1VEB		405112'	
EMPT1		407346'		FREAD		000004	SPD	GOTMSK		402377'		IN2ASC		404351'	
EMPT2		407367'		FSTEOL		410374'		GOTO	254000	000000		IN2BGE		405004'	
EMPTY		407344'		FSTMEM		000000'		GOTSIZ		411306'		IN2LST		404152'	
ENDCM0		402652'		FSTTAP		000026	SPD	GOTSTR		402542'		IN2SIX		404717'	
ENDCNT		000025	SPD	FSTWRD		000064'		GSNAM		410522'		IN2VEB		405122'	
ENDCOM		402641'		GDEV	340630	000000	SPD	GTBF0		406722'		IN3ALT		404230'	
ENDCOP		403422'		GDSK	000007	000000	SPD	GTONE0		402474'		IN3ASC		404315'	
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 139-3
MAGCON.MAC	 6-JUL-77 09:25		SYMBOL TABLE

IN3BGE		405020'		INULST		404127'		LB.IGE		405516'		MFDARG		000465'	
IN3LST		404227'		INXLST		404134'		LB.IMI		405356'		MFDBUF		001467'	
IN3VEB		405137'		INZLST		404217'		LB.NBM		405557'		MFDCNT		000474'	
IN4ASC		404354'		IO		000020	SPD	LB.NCL		405454'		MFDCTL		001667'	
IN4BGE		405025'		IOERR		410302'		LB.NON		405326'		MFDDEV		001445'	
IN4LST		404242'		IOT		400000	SPD	LB.NST		405335'		MFDERR		411316'	
IN4VEB		405147'		IPERR		407775'		LB.OBH		405766'		MFDGET		411142'	
IN5ASC		404303'		IPT	000002	000000	SPD	LB.OBL		406242'		MFDNAM		001450'	
IN5BGE		404776'		IRCNT		000356'		LB.OBM		405710'		MFDPTR		000475'	
IN5VEB		405111'		ISEC		000372'		LB.OCL		406360'		MFDSET		411140'	
IN6ASC		404336'		ITEM		000413'		LB.OGE		406144'		MFDWDS		411132'	
IN6LST		404143'		IVBCNT		002713'		LB.OMI		405626'		MFILES		000663'	
IN6VEB		405154'		JF		000010	SPD	LB.PBL		406347'		MIDT		000421'	
IN7LST		404151'		JOB41		400027'	EXT	LB.PBM		406130'		MME	047000	000000	
IN7VEB		405157'		JOBAPR		412230'	EXT	LB.PRT		406205'		MOD		000007	SPD
IN8LST		404172'		JOBCNI		412301'	EXT	LB.TAB		412667'		MOD0ER		410277'	
IN8VEB		405117'		JOBDDT		412350'	EXT	LB.TYP		412700'		MODE		004000	SPD
IN9ASC		404326'		JOBFF		412531'	EXT	LHEAD		000010	SPD	MODTAB		413261'	
IN9LST		404264'		JOBREL		412536'	EXT	LISTAB		410444'		MONIBF		407006'	
IN9VEB		405134'		JOBREN		400023'	EXT	LKIERR		412244'		MONOBF		407007'	
INCHWL	051200	000000		JOBSA		403574'	EXT	LOCK		410262'		MONTH		412017'	
IND		000010	SPD	JOBUUO		410567'	EXT	LOGOFF		400207'		MOVCHI		000426'	
INDLST		404204'		KLUDGE		000645'		LOGPRG		413121'		MOVCHO		000425'	
INELST		404102'		L.EOF		200000	SPD	LOKERR		411512'		MOVNAM		411701'	
INFLST		404131'		L.EOV		400000	SPD	LOKWLD		410747'		MOVNM0		411710'	
INI		000000	SPD	L.HDR		100000	SPD	LOOK		412506'		MPTR		000007	SPD
INIASC		404302'		L.RET		402202'		LOW		002744'	SPD	MPV		020000	SPD
INIBCD		404775'	SPD	LAB	000004	000000	SPD	LOWT		000422'		MSIZ		000006	SPD
INIBCL		404775'	SPD	LABCNT		000637'		LPT	040000	000000	SPD	MTA	000020	000000	SPD
INIBGE		404775'		LABDTW		000632'		LSTDEV		000377'		MTAWD		000666'	
INICDC		404775'	SPD	LABEL		000013	SPD	LSTMEM		000453'	SPD	NAMCHK		401733'	
INIEBC		404775'	SPD	LABFIL		411412'		LSTPPN		000655'		NAME		000003	SPD
INIFIX		404775'	SPD	LABNAM		000630'		LSTPTR		000404'		NAMIT		407754'	
INIGEA		404302'	SPD	LABPPN		000633'		LSTSTR		000654'		NAMOUT		410121'	
INIHBD		404775'	SPD	LABSIZ		000634'		LSTVAL		001031'		NEC		400000	SPD
INIHPA		404302'	SPD	LABSTR		000627'		LSTWRD		000063'		NI.ERR		000200	SPD
INIIMG		404527'		LABTOT		000636'		M.CNT		000016	SPD	NI.LST		010000	SPD
INILST		404063'		LABVOL		000635'		M.DIS		412656'		NIR	000002	000000	SPD
INIMOD		403365'		LB.0GE		405530'		M.RET		402070'		NO.PRI		002000	SPD
INIOCT		410505'	SPD	LB.0NO		405344'		M.TAB		412640'		NOCCL		410050'	
INISIX		404702'		LB.1NO		405351'		MAK2		412130'		NOCCL0		410061'	
INIVEB		405077'		LB.BGN		406265'		MAKE		406626'		NOCHK	000400	000000	SPD
INIXBD		404775'	SPD	LB.BVL		405744'		MAKE1		406650'		NOCHR		000361'	
INMLST		404073'		LB.CLO		406214'		MAKE1A		406700'		NOCOM		410232'	
INNLST		404202'		LB.CNT		000007	SPD	MAKE1B		406660'		NOCORE		410270'	
INOLST		404263'		LB.DIS		412676'		MAKE2		406706'		NOCRLF		040000	SPD
INPAB0		407230'		LB.FIN		406333'		MAKE2A		406645'		NODEL		410435'	
INPABT		407227'		LB.GED		406224'		MAKTWO		412127'		NODEV		407741'	
INPBUF		000065'		LB.HDR		406343'		MAKUP		402515'		NODEV1		407743'	
INPEND		407465'		LB.IBH		406026'		MAT0		406544'		NODIS	000040	000000	SPD
INPERR		000367'		LB.IBL		405416'		MATRIX		406540'		NOERRO		000020	SPD
INPLAB		405242'		LB.IBM		405561'		MAYBE		410024'		NOEXT		407746'	
INPMOD		000051'		LB.ICL		405456'		MF		000004	SPD	NOFILE		410016'	
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 139-4
MAGCON.MAC	 6-JUL-77 09:25		SYMBOL TABLE

NOHEAD		000004	SPD	OBLK		000021'		OT4OCT		404654'		OTIEBC		405031'	SPD
NOHELP		410225'		OBSIZE		002715'		OTBASC		412060'	SPD	OTIFIX		405031'	SPD
NOINP		407767'		OBUF		000307'		OTBBCD		412060'	SPD	OTIGEA		404363'	SPD
NOINP1		410257'		OCNT		000012		OTBBCL		412060'	SPD	OTIHBD		405031'	SPD
NOIREC		410244'		OCTMOD		413353'		OTBBGE		412060'	SPD	OTIHPA		404363'	SPD
NOIUSE		407734'		OCTOUT		411353'		OTBCDC		412060'	SPD	OTIIMG		412060'	SPD
NOLAB		410321'		ODD		000000	SPD	OTBEBC		412060'	SPD	OTIOCT		404607'	
NOMAKE		410237'		ODDRET		402032'		OTBFIX		412060'	SPD	OTISIX		404732'	
NOMAT		410342'		OF		000001		OTBGEA		412060'	SPD	OTIVEB		405163'	
NOMORE		403607'		OFCNT		000366'		OTBHBD		412060'	SPD	OTIXBD		405031'	SPD
NOOCT		410301'		OFFDEV		402770'		OTBHPA		412060'	SPD	OTP	000001	000000	SPD
NOOPN		410010'		OFILE		000001'		OTBIMG		410505'	SPD	OTPERR		000370'	
NOOREC		410267'		OIBUF		000315'		OTBOCT		410505'	SPD	OTRAC0		404422'	
NOOUSE		407733'		OJOBFF		000647'		OTBSIX		404765'		OTRAS1		404434'	
NOOUT		407763'		OM		000015		OTBVEB		405215'		OTRAS2		404441'	
NOOUT1		410256'		OMSAV5		000446'	SPD	OTBXBD		412060'	SPD	OTRASC		404423'	
NOP	255000	000000		OMSAVE		000441'		OTCASC		404365'		OTRBCD		405036'	SPD
NOR	000001	000000	SPD	ONDEV		402763'		OTCBCD		405033'	SPD	OTRBCL		405036'	SPD
NORDIS		413044'		ONE		000001	SPD	OTCBCL		405033'	SPD	OTRBGE		405036'	
NORET		401467'		ONLUFD		411110'		OTCBGE		405033'		OTRCDC		405036'	SPD
NOREW		402141'		OPERR		407773'		OTCCDC		405033'	SPD	OTREBC		405036'	SPD
NOROOM		410274'		OPN1		411276'		OTCEBC		405033'	SPD	OTRFIX		405036'	SPD
NOTAB		410241'		OPNI1		402742'		OTCFIX		405033'	SPD	OTRGEA		404423'	SPD
NOTCOM		400144'		OPNIP0		402756'		OTCGEA		404365'	SPD	OTRHBD		405036'	SPD
NOTIME		412223'		OPNIT		411256'		OTCHBD		405033'	SPD	OTRHP0		404474'	
NOTLAB		410264'		OPNO1		402724'		OTCHPA		404365'	SPD	OTRHP1		404515'	
NOUSE		407731'		OPNUFD		411162'		OTCIMG		410505'	SPD	OTRHPA		404475'	
NOW0		402151'		OPRLIC		100000	SPD	OTCOCT		404620'		OTRIMG		410505'	SPD
NOWIND		000001	SPD	OPRRET		412342'		OTCSIX		404743'		OTROCT		410505'	SPD
NOWLD		410310'		ORCNT		000354'		OTCVEB		405177'		OTRSIX		404750'	
NOWRET		402147'		OSEC		000373'		OTCXBD		405033'	SPD	OTRVEB		405204'	
NTH0		400072'		OSIZE		002714'		OTEOCT		404672'		OTRXBD		405036'	SPD
NTH1		400065'		OT0ASC		404377'		OTFASC		404450'		OUTB		000004	SPD
NTHERE		400057'		OT0BGE		405035'		OTFBCD		405074'	SPD	OUTBUF		000112'	
NUM		000400	SPD	OT0OCT		404613'		OTFBCL		405074'	SPD	OUTC		000002	SPD
NUMRTY		402314'		OT0SIX		404733'		OTFBGE		405074'		OUTDIA		401435'	
NUMVAL		402311'		OT0TMP		002716'		OTFCDC		405074'	SPD	OUTF		000005	SPD
NWUCNT		000007	SPD	OT0VEB		405165'		OTFEBC		405074'	SPD	OUTI		000001	SPD
NWUTAB		412660'		OT1ASC		404402'		OTFFIX		405074'	SPD	OUTLA1		405305'	
NXM		010000	SPD	OT1BGE		405044'		OTFGEA		404450'	SPD	OUTLA2		405306'	
NXTBLK		411006'		OT1OCT		404634'		OTFHBD		405074'	SPD	OUTLAB		405263'	
NXTDEN		402260'		OT1SIX		404755'		OTFHPA		404523'		OUTMOD		000020'	
NXTDIG		402606'		OT1TMP		002717'		OTFIMG		410505'	SPD	OUTR		000003	SPD
NXTDSK		411203'		OT1VEB		405222'		OTFOCT		404667'		OUTSTR	051140	000000	
NXTENT		402400'		OT2ASC		404410'		OTFSIX		404771'		P1		000006	
NXTFIL		411010'		OT2BGE		405060'		OTFVEB		405232'		P2		000007	
NXTGET		404223'		OT2OCT		404637'		OTFXBD		405074'	SPD	P3		000010	
NXTNAM		411020'		OT2SIX		404747'		OTHDEV		412171'		P4		000011	
NXTONE		403602'		OT3ASC		404420'		OTIASC		404363'		PAR		002000	SPD
NXTPPN		411146'		OT3BGE		405063'		OTIBCD		405031'	SPD	PARERR		410305'	
NXTSTR		411045'		OT3OCT		404645'		OTIBCL		405031'	SPD	PASLOP		402050'	
OBCNT		000355'		OT3SIX		404763'		OTIBGE		405031'		PASS		000640'	
OBCSAV		000360'		OT3VEB		405203'		OTICDC		405031'	SPD	PAT		000527'	
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 139-5
MAGCON.MAC	 6-JUL-77 09:25		SYMBOL TABLE

PATCH		000527'		Q19CLR		401332'		RETCHR		000415'		SETOUT		403210'	
PATH		001235'		Q19SET		401331'		RETWRD		000642'		SETS1		403674'	
PATSIZ		000100	SPD	Q2		401063'		REVIVE		407626'		SETS2		403722'	
PAUSE		412371'		Q20		401336'		REW0		402134'		SETS3		403713'	
PC		000522'		Q22		401344'		REWBIT		413046'		SETSQ		403673'	
PDL		200000	SPD	Q23		401354'		REWCNT		000004	SPD	SETSUB		403660'	
PDP		000017		Q24		401361'		REWDIS		413042'		SETUP		403623'	
PDPSIZ		000150	SPD	Q24CLR		401365'		REWIND		402124'		SETUP1		403642'	
PDTBU0		410647'		Q24SET		401364'		REWNOW		400220'		SIDE		000012	
PDTBUF		410646'		Q3		401075'		REWRET		402132'		SIXLOP		402360'	
PER		000002	SPD	Q3CLR		401100'		REWTAB		413036'		SIXMOD		413366'	
PERFOR		400244'		Q3SET		401077'		RPTFLG		000670'		SKP0		410357'	
PERFOY		400301'		Q4		401150'		RUNDDT		412350'		SKPCHK		000424'	
PERGE		000016	SPD	Q4CLR		401152'		RUNDIS		413112'		SKPFIL		410355'	
PICTUR		406570'		Q4SET		401153'		RUNFIL		412355'		SKPIT		411016'	
PLACE		411343'		Q5		401104'		RUNFLG		000402'		SLH		000004	SPD
POSI0		403272'		Q5A		401117'		RUNIT		402624'		SOM		000100	SPD
POSINP		403257'		Q5B		401107'		RUNLEN		000006	SPD	SP36M		000412'	
POSO0		403313'		Q6		401131'		RUNTAB		413104'		SPACE		411347'	
POSOUT		403302'		Q8		401141'		RUNWHT		412353'		SPAN		000040	SPD
PPN		000006	SPD	Q9		401157'		S		000000		SPC		200000	SPD
PPNERR		410247'		Q9CLR		401162'		SAMDEV		410304'		SPCCNT		000371'	
PR.CNT		000002	SPD	Q9SET		401161'		SAV2		412065'		SPCNT		000417'	
PR.DIS		413054'		QTAB		401015'		SAV3		412063'		STACK		000137'	
PR.TAB		413052'		QUES		407735'		SAV4		412061'		STAR	001000	000000	SPD
PRG		004000	SPD	QW		410366'		SAVCH		000433'		START		400000'	
PRGNAM		000520'		RDMFER		411151'		SAVCNT		000665'		START1		400036'	
PROCED		403460'		RDUFER		411245'		SAVDEV		000671'		STAT		411562'	
PROD1		403403'		REC	000020	000000	SPD	SAVE	261740	000000		STAT2		411654'	
PROD2		403416'		RECADV		000027	SPD	SAVEAC		412066'		STAT4		411661'	
PTP	000400	000000	SPD	RECPTR		000403'		SAVMOD		000672'		STAT5		411666'	
PTR	000200	000000	SPD	RECSIZ		000011	SPD	SAVPTR		000664'		STAT6		411641'	
PUT		407334'		RED0		407621'		SBLKN		000662'		STAT7		411647'	
PUT1		407336'		RED0B		407670'		SCAN		000400	SPD	STAT88		411624'	
PUTDAT		410622'		REDCCL		402554'		SEARCH		000400'		STAT9		411633'	
PUTNAM		410714'		REDOUT		407631'		SEC		000020	SPD	STATUS		000000	SPD
PUTNM0		410725'		REDTAB		412443'		SEC0		407004'		STOP		400172'	
PUTOCT		410673'		REL		001000	SPD	SECTOR		406757'		STOPIT		410500'	
PUTSIX		410705'		RELNUM		000362'		SEND1		407444'		STORE		412033'	
PUTTIM		410636'		REN0		403724'		SENDAL		407443'		STS		000011	SPD
PUTXDT		410623'		REN1		403727'		SETBLK		401441'		SUBSTF		000667'	
Q1		401370'		REN2		403734'		SETBY1		403251'		SVDPTR		402154'	
Q10		401166'		REN3		403742'		SETBYT		403221'		SW.A		402105'	
Q11		401173'		REN4		403745'		SETCNT		403760'		SW.AR		402117'	
Q12		401205'		REN5		403750'		SETDIN		403177'		SW.B		402073'	
Q13		401217'		REN6		403757'		SETDIS		403151'		SW.BK		402112'	
Q14		401241'		RENEW		403723'		SETIMG		403024'		SW.BUF		402304'	
Q15		401251'		REP		400000	SPD	SETIN1		403155'		SW.CNT		000053	SPD
Q16		401263'		RESYNC		402340'		SETIN2		403143'		SW.D		402155'	
Q18		401321'		RET0		412060'		SETINP		403126'		SW.D1		402217'	
Q18CLR		401324'		RET1		412057'		SETIP		403157'		SW.DIS		412762'	
Q18SET		401323'		RET3		412055'		SETIP1		403203'		SW.GO		402213'	
Q19		401327'		RETAIN		400214'		SETIP2		403171'		SW.H		412515'	
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 139-6
MAGCON.MAC	 6-JUL-77 09:25		SYMBOL TABLE

SW.KEP		402211'		TOOCT1		411431'		UPD2		404024'		XPRNTD		401563'	
SW.L		402172'		TOODEP		410373'		UPDA		404003'		XPRNTZ		401623'	
SW.M		402060'		TORCNT		000350'		UPDAT		403774'		XPUT		406611'	
SW.NWU		402015'		TRAP		412143'		UPDATE		403777'		XPUT1		406614'	
SW.OFF		402020'		TRK7		000004	SPD	UPDB		404007'		XSPACE		406562'	
SW.P		402023'		TRPBLK		000650'		USEALL		411061'		XTELL		402037'	
SW.PW		402043'		TRPCHK		412213'		USEDEV		411101'		XYNRET		401472'	
SW.R		402100'		TRPCHN		000653'		VEBMOD		413516'		YESCNT		000002	SPD
SW.RET		400163'		TRPPC		000652'		VERSIO	000501	446253	SPD	YESDIS		413131'	
SW.RL		402204'		TRPSET		412227'		VOL		000015	SPD	YESNO		401460'	
SW.TAB		412707'		TRYNXT		402412'		WARN		410033'		YESRET		401464'	
SWERR		410252'		TST1		403065'		WBEDSK		400410'		YESTAB		413127'	
SYNC		000040	SPD	TSTCOM		403052'		WD		000013		ZERO		000000	SPD
SYSDEV		411043'		TSTDEV		411037'		WDEV		001000	SPD	ZPUT		410655'	
SYSLOK		411065'		TSTNAM		411670'		WDMTA0		411001'		%IO		000363'	
SYSNAM		000523'		TSTOUT		403043'		WEXT		000200	SPD	%TIME		000364'	
SYSPP		001032'		TTY	000010	000000	SPD	WF		000011	SPD	.ALST		000046	SPD
SYSSRH		000401'		TWO		000002	SPD	WILD		007300	SPD	.ASC		000001	SPD
T1		000003		TWODIG		410670'		WLD3		411750'		.BSF		000017	SPD
T2		000004		TYMREL		000002	SPD	WLDDEV		410742'		.BSR		000007	SPD
T3		000005		TYMSPC		000005	SPD	WLDDSK		411023'		.CH		000001	SPD
T4		000006		TYPDAT		411363'		WLDEXT		000434'		.CLR		000011	SPD
TAB	000010	000000	SPD	TYPE		410036'		WLDISK		000435'		.CORE		000011	SPD
TAB1		001711'		TYPE0		410040'		WLDMTA		410763'		.DATE		000014	SPD
TAB2		002311'		TYPEIT		410037'		WNAME		000100	SPD	.DCHR		000045	SPD
TABDEV		001013'		TYPNAM		410063'		WP		002000	SPD	.DEV		000004	SPD
TABFIL		001017'		TYPNM0		410072'		WPN		004000	SPD	.ENB		000016	SPD
TABLST		000411'		TYPTIM		411402'		WRILAB		407677'		.GLST		000066	SPD
TABPTR		000410'		UF		000003	SPD	WRITE		407342'		.IND		000101	SPD
TABRUN		001016'		UFDARG		000454'		WRITE0		407717'		.IOSTP		000010	SPD
TAINP		407527'		UFDBUF		001242'		XBDMOD		413455'		.JBINT		000134	SPD
TBLKN		000661'		UFDCNT		000463'		XBUF		100000	SPD	.JBTPC		412320'	EXT
TBSIZE		000423'		UFDCTL		001442'		XFLST		402330'		.JLST		000047	SPD
TCH		000374'		UFDDEV		001460'		XLST		402332'		.LN		000004	SPD
TELWRD		000062'		UFDERR		411321'		XNAME		406460'		.LTP		000006	SPD
TEMP		000375'		UFDGET		411215'		XNLST		402335'		.NAM		000064	SPD
TEMP1		000376'		UFDNAM		001463'		XNTELL		402041'		.NODEL		000040	SPD
TERM		000020	SPD	UFDPTR		000464'		XPNT88		401611'		.PATH		000110	SPD
TG0		412426'		UFDSET		411213'		XPNT99		401573'		.PJOB		000030	SPD
TG1		412431'		UFDWDS		411205'		XPRINT		401502'		.PPN		000024	SPD
TG2		412435'		ULTRAT		000414'		XPRNT0		401513'		.RESET		000000	SPD
TG3		412440'		UME	001000	000000		XPRNT1		401521'		.REW		000001	SPD
THEDIG		410666'		UME0		410566'		XPRNT2		401527'		.RUN		000035	SPD
THREE		000003	SPD	UME1		410576'		XPRNT3		401543'		.SIX		000002	SPD
TIBCNT		000353'		UME2		410603'		XPRNT4		401551'		.SIZ		000101	SPD
TIME		000517'		UME3		410604'		XPRNT5		401556'		.SKF		000016	SPD
TIRCNT		000352'		UME4		410612'		XPRNT6		401636'		.SKP		000014	SPD
TMPLEN		000010	SPD	UNAME		000406'		XPRNT7		401644'		.SKR		000006	SPD
TMPLST		001671'		UNICOM		402370'		XPRNT8		401533'		.SLP		000031	SPD
TOBCNT		000351'		UNIMAT		402367'		XPRNT9		401537'		.STR		000003	SPD
TOBIN		411424'		UNLOAD		000002	SPD	XPRNTA		401567'		.STS		000054	SPD
TOOCT		411427'		UNSAVE	262740	000000		XPRNTB		401627'		.TAB		000041	SPD
TOOCT0		411434'		UPD1		404015'		XPRNTC		401631'		.TAPE		000112	SPD
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77 PAGE 139-7
MAGCON.MAC	 6-JUL-77 09:25		SYMBOL TABLE

.TERM		000012	SPD	
.TIM		000027	SPD	
.TIME		000023	SPD	

MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

ABORT	  2544	  3270	  3332	  5468#	  5525	  6089	  6486
ABORT1	  5474#	  6523
ABTEND	  5502	  5504	  5506#
AC	   595#	  5470	  5471	  5472	  5473	  6506	  6507	  6508	  7014
ADV	    86#	  1807	  2007	  2008	  2236	  2237
ADVAN	   129#	  1527	  1809	  2502	  2520
ADVR	   103#	  1821	  1822	  2007	  2008	  2236	  2237
ALT	    89#	  6741	  6743	  6744
ANYCHR	  4144	  4168	  4206	  4232	  4237	  5966#	  5967
APRTRP	  6467	  6506#
ASC	   200#	  2267	  2284
ASCMOD	  2276	  2287	  2312	  2315	  2919	  7130	  7131#
ATS	    87#	   781	  2094	  6733
AWIND	   145#	  1563	  1564	  1566	  1568	  1835	  2681	  2686	  6929	  6931	  6932
B12	   172#	   863	   864	  3293	  3294
B5	   171#	   863	   864	  3293	  3294
B5B12	   861	   863#
BAC	   102#	   189#	  1814	  2890	  3072	  4683
BACK	  5283	  5355	  5366#
BACSPC	   137#	  1321	  1558	  1816	  2503	  2521
BAD	    95#	  1485	  1486	  5287	  5288	  5391	  5392	  6548
BADCHR	  2136	  2141	  2146	  5287#
BADEOF	  4945	  5343#
BADFOM	  3064	  5284#
BADMOD	  2321	  5320#
BADNUM	  1972	  1979#	  1981
BADRUN	  6561	  6590#	  6986
BADSTR	  2145#
BADTM	  3964	  4180	  5344#	  5694
BADVOL	  4947	  5346#	  5682
BCDMOD	  3858	  3950	  7131	  7139#
BCLCHK	  4749	  6093#
BCLCK0	  6107#	  6110
BCLDAT	  4013	  4018	  4128	  4203	  4209	  6279#
BCLMOD	  7131	  7138#
BIN	   198#	  2254
BLACK	  4390	  4391	  4392#
BLACKO	  4390#	  4411	  4420
BLANK	  4412	  4419	  4441#
BLK	    85#	  1793	  2007	  2008	  2236	  2237
BLKERR	  5311#	  6089	  6485
BLKFCT	   127#	   968	   972	  1243	  1244	  1517	  1795	  2272	  2286	  2326	  2341	  2342	  2484	  2485
	  2571	  2572	  2750	  2799	  2815	  2826	  2844	  2855	  3663	  3664	  4050	  4051	  4472	  4473
	  4528	  4529	  4562	  4564	  4613	  4807	  4809
BMPVOL	  4919	  6378#
BRK	    76#	   775	   779	  1432	  1440	  2094	  6736
BUF0	  4621#	  4635
BUF00	  4611	  4636#
BUF1	  4622	  4663#
BUF2	  3250	  4626	  4664#
BUF3	  4615	  4675#
BUF4	  4676#	  4679
BUFF	   524#	  4998	  4999	  5007	  5008
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

BUFFER	   121#	   726	   727	  2260	  2262
BUFMOV	  3404	  4604#
BUFNUM	   136#	  1554	  1964	  4491	  4583	  6105
BWIND	   146#	  1563	  1564	  1566	  1570	  1835	  2430	  2450	  6930	  6931	  6932
BYEAR	  6289	  6293#
BYTSIZ	   138#
C10	  1115#	  1193
C11T16	  1124	  1128#	  1194	  1196	  1197	  1198	  1199
C12	  1125#	  1195
C18	  1133#	  1201
C18T19	  1135#	  1202
C1A	  1060	  1069#
C1B	  1070	  1072#
C2	  1074#	  1185
C20	  1145#	  1203
C22	  1149#	  1205
C23	  1154#	  1206
C23T24	  1157#	  1207
C3	  1083#	  1186
C4	  1087#	  1187
C5	  1094#	  1188
C6	  1100#	  1189
C8	  1105#	  1191
C9	  1108#	  1192
CALDDT	   796#	  5512	  6531
CANLST	  2320	  5334#
CCLBAK	  1630	  1643#	  1649	  5164	  5446
CCLBLK	  1617	  1654#	  2171	  5444	  6421
CCLBUF	   113#	  1639
CCLCNT	  1617	  1618	  1645	  1654#	  2169	  6420
CCLCOM	   782	  1609#
CCLCOR	   623#	   735	  1641	  2698
CCLDEV	   106#	  1627
CCLEND	  1620	  1654#
CCLFLG	   622#	   688	   736	  1616	  1622	  1638	  1643	  1646	  2097	  2105	  2153	  2170	  2172	  2699
	  5060	  5161	  5441	  5445
CCLGET	   111#	  2166
CCLHED	   114#	  2154	  2156
CCLLEN	   455	  1654
CCLLOK	   110#	  1636
CCLNAM	   107#	  1624
CCLNDV	  1634	  1648#
CCLOPN	   109#	  1633	  1648
CCLPPN	   108#	  1625
CCLREL	   112#	  1644	  2168
CCLUP	  2155	  2164#
CDCMOD	  7131	  7140#
CDP	   163#	   170
CDR	   162#	   170
CF	   454#	  1654	  6417	  6419
CH	    67#	  1430	  1591	  1592	  1593	  1699	  1773	  1775	  1979	  1980	  2023	  2025	  2077	  2078
	  2080	  2081	  2084	  2085	  2087	  2088	  2099	  2100	  2102	  2107	  2111	  2115	  2122	  2123
	  2126	  2127	  2129	  2131	  2133	  2135	  2137	  2139	  2140	  2153	  2154	  2156	  2157	  2158
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

	  2160	  2161	  2166	  2168	  2169	  2170	  2171	  2175	  2185	  2186	  2189	  2767	  2768	  2770	  2772
	  2776	  2785	  2837	  2838	  2927	  2932	  2947	  2948	  2949	  2959	  2963	  2967	  3005	  3006
	  3014	  3032	  3037	  3038	  3050	  3051	  3052	  3053	  3055	  3069	  3070	  3071	  3086	  3091
	  3106	  3114	  3115	  3123	  3124	  3126	  3128	  3139	  3145	  3147	  3149	  3169	  3179	  3180
	  3184	  3190	  3202	  3204	  3297	  3299	  3300	  3311	  3312	  3317	  3319	  3383	  3389	  3394
	  3397	  3442	  3446	  3467	  3480	  3481	  3498	  3499	  3533	  3552	  3555	  3566	  3589	  3595
	  3613	  3614	  3617	  3618	  3619	  3983	  3984	  4014	  4015	  4019	  4020	  4046	  4047	  4071
	  4073	  4074	  4083	  4085	  4086	  4115	  4116	  4125	  4126	  4142	  4166	  4204	  4225	  4226
	  4231	  4236	  4307	  4348	  4361	  4362	  4363	  4364	  4367	  4368	  4382	  4393	  4396	  4403
	  4432	  4434	  4438	  4665	  4666	  4676	  4690	  4691	  4696	  4726	  4727	  4729	  4730	  4732
	  4733	  4755	  4771	  4772	  4782	  4783	  4787	  4797	  4838	  4845	  4858	  4875	  4887	  4889
	  4984	  4985	  4986	  4987	  5021	  5022	  5023	  5024	  5048	  5049	  5050	  5530	  5531	  5538
	  5539	  5546	  5547	  5549	  5550	  5586	  5595	  5596	  5626	  5627	  5628	  5956	  5957	  5965
	  5966	  5975	  5976	  6116	  6117	  6118	  6120	  6122	  6123	  6125	  6306	  6307	  6618	  6619
	  6620	  6621	  6622	  6624	  6625	  6626
CH.CHR	  2114	  2118	  6733#	  6745
CH.CNT	  2113	  6745#
CHAN	   118#	   745	   747	  3904	  5083	  5170
CHANGE	  2837#	  2928	  2933	  2950	  2960	  2964	  2969	  3007	  3016	  3018	  3034	  3039	  3057	  3087
	  3092	  3354	  3430	  3447	  3535	  3567
CHK1	   776	   777#
CHKBL1	  3170	  3173#
CHKBL2	  3175#	  3178	  3185
CHKBL3	  3173	  3177#
CHKBLN	  3112	  3169#
CHKDEM	   764	   773#
CHKDEV	  2391	  2393#
CHKENT	   983	  1022	  1029	  1031	  1037#	  1067	  1081	  1086	  1093	  1099	  1104	  1107	  1113	  1132
	  1144	  1148	  1153	  1166	  2730	  2736
CHKEOF	  4705	  4712#
CHKEXT	  6219	  6221#
CHKLOK	  2559	  2886	  5113#
CHKNAM	  1662	  1676	  1682	  1686#
CHKOPR	  2854	  2913	  3266	  3309	  5373	  6445	  6541#
CHKOUT	  2387	  2389#
CHKREC	  2318	  2327#
CHKT	  2871#	  4837
CHRMOD	   134#	   947	   958	   964	  1003	  1012	  1029	  1076	  1079	  1089	  1095	  1114	  1117	  1120
	  1137	  1160	  1544	  1788	  2269	  2277	  2288	  2358	  2368	  2469	  3657	  4453	  4558	  4609
CHRTAB	  4429	  7059#
CK36	  4702	  4738#
CLEAR	  5286	  5295	  5306	  5309	  5315	  5317	  5319	  5322	  5325	  5328#	  6638
CLEAR1	  5067	  5073	  5080	  5108#	  5338
CLO1	  2641	  2642#	  2710
CLO1A	  2650	  2675#
CLO1B	  2664#	  2667
CLO1C	  2664	  2668#
CLO3	  2678#	  2712
CLO4	  2679	  2683#
CLO5	  2684	  2688#
CLO5B	  2690#
CLO6	  2645	  2717#	  2874
CMAX	  1057	  1184#
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

CMDLST	   613#	  4644	  4655
CNAM	   235#	  1547
CNTTAB	  2108	  2147#
COBDAT	  3925	  3927	  4274	  5939#
CODE	  4321	  4354	  4357#
CODE1	  4361#	  4366
CODE2	  4362	  4366#
COL	    73#	   773	   829	  1051	  1213	  1233	  1241	  1251	  1298	  1308	  1317	  1327	  1335	  1344
	  1354	  1364	  1434	  1471	  1478	  1745	  1766	  1782	  1828	  1843	  1858	  1872	  1969	  2094
	  6687	  6734
COLUMN	   578#	   716	   885	   891	   928	  1498	  2611	  2612	  2617	  2620	  2628	  2638	  2657	  2658
	  2663	  2666	  2674	  2721	  3690	  4153	  4900	  4924	  5426	  5454	  5462	  5629	  5641	  5652
	  5654	  5799	  5861	  6147	  6151	  6162	  6177	  6185	  6191	  6200	  6208	  6213	  6430	  6433
	  6436	  6439	  6453	  6591
COMCNT	   766	  6763#
COMDIS	   767	  6765#
COMERR	   770	   785	   830	   832	   833	   836	   837	   900	  1217	  1236	  1246	  1254	  1302	  1312
	  1320	  1330	  1338	  1348	  1358	  1367	  1442	  2006	  2236	  5296#
COMGO	  2055#	  2069
COMTAB	   766	  6747#	  6763
CONVWD	   579#	  6599	  6601
COPY	  3880	  3883	  6114#
COPY0	  6115#	  6119	  6124	  6126
COPY1	  6117	  6121	  6125#
CREA1	  2557	  2560#
CREATE	  2541	  2545#
CREIT	  2539	  2540#
CRETAB	  2198#	  6765
CRLF	   709	   800	   807	   852	   874	   883	   889	  1505	  1601	  1955	  1958	  2121	  2176	  2691
	  2877	  5154	  5407	  5418	  5425#	  5430	  5431	  5434	  5451	  5469	  5478	  5509	  6131	  6134
	  6425	  6451	  6515	  6527	  6568	  6573	  6577	  6579	  6583	  6706
CTAB	  1055	  1072	  1185#
CTLC	  5441#	  5447	  6411
CTLC0	  5442	  5448#
CTRL	  6633	  6634	  6636	  6991#
CURPTR	   554#	  3371	  3375	  3383	  3395	  3397	  3406	  3413	  3575	  3578	  3582	  3589	  3627	  3629
	  3630	  4522	  4551	  4604	  4678
CVTLAB	  3719	  3755	  3789	  3823	  3864	  4975#
D.RET	  1865#	  6947
D1.RT	  1907#	  6956
DATA	    92#	  2237	  2238	  6970
DATBCL	  3781	  3852	  3893	  6060#
DATBL0	  6077	  6082#
DATCOB	  3738	  3818	  6040#
DATDEV	   691	  6423	  6643	  6666	  6675	  7001#
DATE	   596#	  5494
DATFIL	   692	  6646	  6648	  6650	  6668	  6670	  6671	  6677	  7004#
DATTIM	   124#	  3920	  3923	  5891	  5894
DDTCAL	   799#	  6562
DDTERR	   795	  5307#
DEBUG	   794#	  6771	  6772
DECODE	  4328	  4354#
DECOUT	  1520	  1526	  1530	  1534	  1557	  1561	  2623	  2626	  2669	  2672	  5611#	  6139	  6145	  6157
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

	  6160	  6172	  6175	  6183	  6189	  6198	  6206	  6211
DELBLK	   562#	  1025	  1418	  1419	  3111
DEN	    93#	  1857	  1858	  2007	  2008	  2236	  2237
DEN1	  1930	  1934#
DENINC	  1952	  1956#
DENOUT	  1910	  1946#
DENPTR	   991	  1125	  1901#	  1914	  1950
DENSIT	   131#	  1855	  2278	  2289	  6249
DEPTWO	  5944	  5947	  5950	  6293	  6298#
DEV	    80#	  1659	  2007	  2008
DEVICE	   120#	   832	   900	   907	   969	   978	   984	  1026	  1061	  1065	  1069	  1108	  1436	  1444
	  1626	  1666	  2239	  2245	  2393	  2396	  2547	  3906	  5077	  5085	  5172	  5179	  5711	  5715
	  5724	  5840	  5843	  5854	  6247	  6642
DF	   454#	  5291	  5501	  5503	  5506	  5507	  6610	  6614	  6636	  6675	  6677	  7000
DFFLG	   685	  5292	  5508	  6597	  6680	  6999#
DFPTR	  6606	  6608	  6679	  6998#
DIA0	   898	  1064	  1424#
DIA0A	  1441	  1444#
DIA0B	  1429#
DIA1	  1437	  1439#
DIA11	   980	   984#
DIA12	   993	   996#
DIA15	  1002	  1006#
DIA1A	   905	   918	   942#
DIA22	   987	  1018#
DIA3	   950	   956#
DIA3A	   946#	  1082
DIA4	   952	   957#
DIA4X	  1360	  1368#
DIA4Y	  1358	  1367	  1371	  1376#
DIA5	   960	   963#
DIA6	   944	   972	   975#
DIA7	  1019	  1023#
DIAFLG	   624#	   674	   714	   754	   756	   894	   897	   945	   954	   962	   964	   968	   976	   982
	   989	   991	   998	  1000	  1007	  1009	  1017	  1021	  1024	  1036	  1047	  1064	  1076	  1085
	  1089	  1095	  1102	  1106	  1112	  1130	  1137	  1147	  1150	  1164	  1959	  2727	  2733	  2738
	  5408	  5419
DIAG1	   899#	  1068
DIAG2	   913#	   931
DIAG3	   921	   923	   934#
DIAGET	   886	   892	   896#	   932
DIALOG	   755	   874#	  6766
DIRERR	  5901	  5907	  5912#
DISIN	   574#	  2445	  2446
DISOUT	   573#	  2425	  2426
DK0NXT	  5842	  5854#
DMP	   199#	  2219	  5923	  5928	  6718	  7001	  7008
DMPDEV	  5501	  7008#
DMPFIL	  5489	  5503	  7011#
DMPLST	  5500	  5506	  7014#
DN.CNT	  1861	  6945#
DN.DIS	  1862	  6947#
DN.TAB	  1542	  1861	  6942#	  6945
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

DN1.CT	  1903	  6954#
DN1.DS	  1904	  6956#
DN1.TB	  1903	  6949#	  6954
DN2.TB	  1907	  1928	  1943	  6959#
DONDEN	  1917	  1919	  1921	  1923	  1925	  1927#
DREAM	  2303	  2308	  3707	  6241#
DREAM0	  6240#	  6263
DREAM1	  6252	  6258#
DSK	   161#	   170	   943	   944	   971	   972	  1028	  1029	  1074	  1075	  1083	  1084	  1087	  1088
	  1100	  1101	  1157	  1158	  1632	  1633	  2264	  2265	  2282	  2283	  2319	  2320	  2550	  2551
	  2801	  2802	  2858	  2859	  3143	  3144	  3196	  3197	  4557	  4558	  5133	  5134	  5181	  5182
	  5422	  5423	  5448	  5449	  5659	  5660
DSKERR	  6488	  6488#
DULBLK	  5230	  5240	  5242	  5248	  5250#
DULLST	  5226	  5248#
DULNXT	  5230#	  5238
DYT	  2519	  2522	  2531	  2536#
E.BIT	  2014	  6970#
E.BOT	   214#	  2516	  2532	  3959	  4103	  4175
E.CNT	  2009	  6965#
E.DIS	  2010	  6967#
E.EOF	   213#	  4712	  5014	  5795	  5857	  6710
E.EOT	   215#	  2916	  2975	  4658	  4714	  4823
E.ERR	   216#	  2636	  2719	  3688	  4151	  4704	  4898	  6710
E.HAD	   210#	   216	  5015	  6087	  6483
E.IOB	   212#	   216	  4659	  4824	  6088	  6484
E.LOK	   209#	   216	   922	  5015	  6086	  6485
E.PAR	   211#	   216	  4660	  4706	  4825	  5016
E.RET	  2013#	  6967
E.TAB	  2009	  6964#	  6965
EBCMOD	  1013	  1138	  3428	  3658	  3863	  3955	  4044	  7131	  7143#
EMPT1	  4803	  4817#
EMPT2	  4820	  4828#
EMPTY	  2860	  2866	  2972	  3252	  4351	  4627	  4799	  4801#	  5053
ENDCM0	   869	  2234	  2237	  2238#
ENDCNT	  4313	  7055#
ENDCOM	   785	  2232#
ENDCOP	  2576	  2600#	  2881	  2992
ENDCP1	  2618#	  2621
ENDCP2	  2618	  2622#
ENDEXT	  4883#
ENDTAB	  4318	  7034#	  7055
EOF1	  4311#	  4314	  4316
EOFLAB	  2647	  3684#
EOFLPT	  2644	  4305#
EOL	    78#	   763	   784	   831	   899	  1216	  1235	  1245	  1253	  1301	  1311	  1319	  1329	  1337
	  1347	  1357	  1366	  1489	  1491	  1493	  1495	  1610	  1612	  1698	  2094	  2174	  5393	  5395
	  6690	  6692	  6740	  6741	  6743	  6744
EOR	   177#	  3107	  3137	  3142	  3159	  3188	  3195	  3212
EOTERR	  4659	  4824	  5316#
ER.ALL	   208#	  6412	  6475
ER.FUL	   205#	   208	  6431
ER.ICC	   203#	   208	  6410
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

ER.IDV	   202#	   208	  6437
ER.OFL	   204#	   208	  6428
ER.QEX	   206#	   208	  6434
ER.TLX	   207#	   208	  6411
ERASE	   819#	  6776
ERR0	  5399	  5402#
ERR1	  5312	  5329	  5342	  5345	  5367	  5403#
ERR2	  5129	  5165	  5408#
ERR3	  5409	  5420#
ERRCNT	  5150	  5151	  5279#
ERREXT	  5109	  5407#	  6499
ERRMES	  5152	  5255#	  5279
EVEN	   195#	   860	   862	  1536	  1751	  2417	  2437	  2504	  3290	  3292	  3473
EVERET	  1750#	  6939
EXT	   123#	   925	  1427	  1455	  1683	  2013	  2305	  2310	  2542	  3697	  3713	  3765	  3840	  3910
	  4327	  5113	  5119	  5122	  5149	  5178	  5331	  5364	  5813	  5879	  6222	  6223	  6228	  6235
	  6492	  6647
EXTCHI	   572#	  4700	  4758	  4761	  4762	  4765	  4768	  4769	  4773	  4776	  4779
EXTCHO	   571#	  3153	  4839	  4852	  4853	  4858	  4859	  4861	  4862	  4867	  4870	  4884	  4887	  4890
EXW	   219#	  4474	  4475	  4530	  4531	  4565	  4566	  7145
FF	   176#	  3117	  3130	  3131	  4308
FFLG	   188#	  2538
FILCHK	  4703#
FILL	  2575	  2805	  2809	  2908	  3260	  4693	  4698#	  4961	  5374
FIN	   181#	  3901	  3934	  3939	  3998	  4036	  4072	  4157	  4211	  4258
FIXEXT	  4840	  4861#
FIXF1	  4845#	  4871
FIXFST	  3151	  4794	  4838#
FIXMOD	  7131	  7137#
FIXULT	  3066	  3091#
FNDONE	    98#	  2033	  2034	  2048	  2049	  2050	  2052	  2053	  2060	  2061	  2067	  2068
FNDTWO	    99#	  2033	  2034	  2049	  2050	  2053	  2054	  2061	  2062
FOMERR	  1746	  1767	  1783	  1829	  1844	  1859	  1873	  1970	  1976	  5302#	  6799	  6820	  6924	  6927
	  6940	  6948	  6957
FPTR	   233#	  2762	  6609	  6613
FREAD	   178#	  2639	  2814
FSTEOL	  5167	  5290	  5298	  5301	  5303	  5391#
FSTMEM	   465#	   723	   875	   876
FSTTAP	   139#	   934	   940	  2413	  2418	  2433	  2438	  2474	  2496	  3150	  3152	  4454	  4463	  4478
	  4684	  4699	  4752	  4767	  4775	  4793	  4869	  4883
FSTWRD	   515#	  1582	  1989	  1991	  1998	  2940	  2979	  5866
GDEV	   170#	  2263	  2264	  2281	  2282
GDSK	   221#	  5723	  5724
GEAMOD	   951	   959	  1030	  1090	  1118	  1121	  1161	  4459	  7131	  7133#
GENDEV	  5724	  5727#
GET	  3048	  3067	  3223	  3343	  3352	  3426	  3531	  3559	  4683#
GET1	  4687	  4693#
GET12	  1703	  2072#
GET12A	  2075#	  2089
GET12B	  2079	  2083	  2087#
GET1A	  4686#	  4695	  4750	  4786
GET2	  4684	  4696#
GET36	  4689	  4726#
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

GETALL	  4757	  4782#
GETBUF	  3369	  3572	  4520#
GETCH0	  2111	  2113#
GETCHR	  2095#	  2101	  2112	  2152
GETCOM	   754#	   764	  1464
GETDEC	  1971	  2180#
GETDEV	   774	   830	  1438	  1659#
GETINP	  2538#	  2709
GETLAB	  3786	  3856	  4904	  4944	  4955#	  5679
GETLIC	   657#	   663
GETMSK	  2036#	  2039
GETNAM	   778	  1673#
GETNXT	  2706	  2994	  5674#
GETONE	  1494	  1611	  1771	  2021	  2075	  2094#	  2182	  5394	  6691
GETOV	  5225#	  5235
GETPAR	  4707	  4709#
GETPPN	   776	   780	  1433	  1443	  1693#
GETSIX	   762	   772	   828	  1429	  1667	  1680	  1701	  2019#	  2032	  6688
GETSW	   783	  1721#
GETTAB	  2379	  2921	  4979	  4991	  5006	  5039	  6597#
GETTB1	  6605	  6608#
GETTB2	  6598	  6602#
GETTM0	  6600	  6659#
GETTM1	  6660	  6665#
GETTNM	  2238	  6642#
GETUNM	  4289	  5193	  5203	  5209#
GETUSR	  1697	  1703#
GETWOD	   772#	  2008	  2015	  6968
GFXF1	  4759	  4765#
GFXFST	  4685	  4750#	  4764
GITEM	  1046#	  1054	  1056	  1058	  1075	  1084	  1088	  1091	  1097	  1101	  1110	  1116	  1119	  1122
	  1127	  1129	  1134	  1136	  1141	  1146	  1151	  1156	  1159	  1162
GOBLST	  5743	  5744	  5747	  5748	  5751	  5926#
GOTDEV	  5738	  5742	  5752#
GOTMAT	  2045	  2067#
GOTMSK	  2036	  2040#
GOTSIZ	  5884	  5889#
GOTSTR	  2132	  2134	  2143#
GSNAM	  5480#	  5487
GTBF0	  4521	  4524#
GTONE0	  2103	  2107#
GTONE1	  2096	  2099#
HADERR	  5104#	  6088	  6484
HBDMOD	  7131	  7142#
HDR	   183#	  4722	  4902	  4948	  5383	  5420
HDRLPT	  2549	  4285#
HDRWRD	  4290	  4358	  4410	  4445#
HELP1	  6690#	  6693
HELP2	  6707#	  6715
HELP3	  6708	  6711	  6712#
HF	   454#	   732	  6693	  6695	  6708	  6709	  6717
HFCTL	  6699	  6708	  6712	  6727#
HFILE	  5281	  6689	  6695	  6724#
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

HGH	   451#	   655	  1652#	  1656	  2217#	  2227	  4443#	  4448	  5246#	  5252	  5916#	  5935	  6534#	  6538
	  6722#	  6730	  6987#	  7018
HIGHT	   564#	  1911	  1918
HLPDEV	  6423	  6693	  6718#
HPAMOD	  1014	  1139	  7131	  7132#
HUNG	   184#	  2164	  4701	  4819	  5011	  5505	  6414	  6552	  6635	  6707
I90LST	  3028#	  3036
I91LST	  3032#	  3035
I92LST	  3031	  3036#
I93LST	  3033	  3037#
IBCNT	   532#	  2578	  2622	  2629	  2811	  2818	  2829	  2892	  2911	  3228	  3263	  4914
IBLK	   506#	  2803
IBUF	   522#	  2261	  2382	  2449	  2452	  3239	  3241	  3243	  3246	  3247	  3249	  3253	  3338	  3340
	  3341	  3345	  3347	  3349	  4686	  4690	  4726	  4730	  4731	  4732	  4735	  4743	  4746	  4748
	  4930	  4939	  4968	  4982	  5845	  6093	  6100
ICNT	    66#	  2572	  2795	  2799	  3519	  3539
IF	    57#	   454	   730	   744	   836	   838	   839	  2206	  2208	  2245	  2246	  2247	  2249	  2250
	  2281	  2282	  2283	  2290	  2299	  2300	  2319	  2322	  2323	  2348	  2349	  2366	  2432	  2443
	  2450	  2451	  2500	  2501	  2509	  2510	  2512	  2514	  2516	  2517	  2604	  2634	  2635	  2640
	  2677	  2678	  2679	  2680	  2681	  2682	  2713	  2800	  2801	  2906	  2915	  2973	  2974	  2990
	  3058	  3062	  3077	  3360	  3694	  3695	  3699	  3708	  3711	  3859	  4596	  4702	  4703	  4709
	  4717	  4718	  4721	  4738	  4895	  4897	  4901	  4907	  4922	  4925	  4927	  4931	  4932	  4933
	  4938	  4955	  4957	  4958	  4959	  4965	  4967	  5133	  5134	  5343	  5346	  5371	  5377	  5659
	  5660	  5667	  5691	  5697	  5707	  5734	  5758	  5771	  5792	  5796	  5820	  5841	  5858	  5881
	  6102	  6103	  6108	  6109	  6218	  6221	  6225	  6227	  6489	  6498
IFCNT	   538#	  2600	  2746	  6180
IFILE	   490#	   726	   728	   742	   745	   824	   836	   861	   879	   882	  1001	  1018	  1032	  1039
	  1120	  1123	  1133	  1150	  1154	  1369	  1445	  1510	  2006	  2245	  2250	  2256	  2262	  2285
	  2286	  2288	  2289	  2291	  2298	  2300	  2306	  2309	  2310	  2323	  2325	  2326	  2327	  2341
	  2344	  2345	  2349	  2358	  2366	  2387	  2396	  2433	  2436	  2438	  2440	  2453	  2502	  2503
	  2541	  2542	  2569	  2572	  2581	  2605	  2613	  2728	  2799	  2815	  2826	  2917	  3046	  3063
	  3076	  3289	  3359	  3423	  3436	  3543	  3638	  3649	  3696	  3697	  3698	  3710	  3713	  3765
	  3840	  3844	  3904	  3906	  3914	  3920	  3923	  4581	  4597	  4684	  4699	  4719	  4752	  4767
	  4775	  4906	  4918	  4920	  4927	  4940	  5063	  5095	  5124	  5135	  5136	  5138	  5331	  5332
	  5335	  5353	  5363	  5364	  5377	  5684	  5693	  5699	  5711	  5715	  5724	  5746	  5765	  5770
	  5812	  5813	  5840	  5841	  5843	  5852	  5854	  5868	  5871	  5879	  5881	  5883	  5889	  5891
	  5894	  6105	  6167	  6219	  6222	  6223	  6226	  6228	  6249	  6423	  6492	  6494	  6496	  6574
	  6642	  6644	  6647	  6649
IJOBFF	   615#	  2410	  4935	  5846
IM	    69#	   864	   865	  1264	  1268	  1269	  1371	  1374	  1375	  1393	  1396	  1397	  2311	  2312
	  2313	  2330	  2332	  2357	  2358	  2375	  2381	  2385	  2595	  3428	  3718	  3754	  3788	  4929
	  4989	  5005	  5038	  5844	  6099
IMGBLT	  3221	  3233#
IMGBT0	  3241#	  3254
IMGBT1	  3237#	  3267
IMGMOD	   865	  1004	  2332	  2335	  2354	  2357	  2471	  3220	  4976	  5002	  5035	  7131	  7134#
IMPSW	  5299#	  6916
IN0ASC	  3048#	  3051	  3060
IN0BGE	  3425#	  3431
IN0IMG	  3223#	  3227	  3232
IN0LST	  2906#	  2977
IN0SIX	  3338#	  3342	  3350	  3363	  3366
IN0VEB	  3524#	  3549
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

IN1ASC	  3054	  3062#	  3070
IN1BGE	  3425	  3433#
IN1LST	  2907	  2917	  2919#
IN1SIX	  3351#	  3355
IN1VEB	  3530#	  3536
IN2ASC	  3056	  3084#
IN2BGE	  3430#	  3443	  3446
IN2LST	  2944	  2954#
IN2SIX	  3351	  3356#
IN2VEB	  3530	  3538#
IN3ALT	  2983	  2986	  2998#	  3004
IN3ASC	  3057#	  3086
IN3BGE	  3429	  3442#
IN3LST	  2930	  2962	  2966	  2997#	  3019
IN3VEB	  3520	  3524	  3551#
IN4ASC	  3086#	  3088
IN4BGE	  3446#	  3448
IN4LST	  2941	  3008#
IN4VEB	  3551	  3554	  3556	  3557	  3559#
IN5ASC	  3047#	  3061	  3089
IN5BGE	  3424#	  3432	  3449
IN5VEB	  3529#	  3537	  3569
IN6ASC	  3059	  3073#
IN6LST	  2947#	  2952
IN6VEB	  3534	  3564#
IN7LST	  2948	  2953#
IN7VEB	  3566#	  3568
IN8LST	  2955	  2957	  2970#
IN8VEB	  3535#	  3566
IN9ASC	  3063	  3065#	  3093
IN9LST	  3011	  3026#
IN9VEB	  3545	  3548#
IND	   149#	  1389	  3656	  4958	  6804
INDLST	  2976	  2978#
INELST	  2909	  2915#
INFLST	  2924	  2937#
INI	   225#	  2595
INIASC	  3046#	  3080	  3083	  3095	  7131
INIBCD	  3451#	  7139
INIBCL	  3451#	  7138
INIBGE	  3423#	  3438	  3441	  3451
INICDC	  3451#	  7140
INIEBC	  3451#	  7143
INIFIX	  3451#	  7137
INIGEA	  3095#	  7133
INIHBD	  3451#	  7142
INIHPA	  3095#	  7132
INIIMG	  3220#	  7134
INILST	  2594	  2901#
INIMOD	  2540	  2551	  2567#
INIOCT	  3332#	  7135
INISIX	  3340	  3343#	  7136
INIVEB	  3519#	  3521	  3550	  7144
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

INIXBD	  3451#	  7141
INMLST	  2908#	  2914	  2918
INNLST	  2974	  2976#
INOLST	  2926	  3025#
INPAB0	  4718#	  4905	  4911
INPABT	  4717#	  4911	  4912
INPBUF	   518#	   722	  3641	  3642	  3643	  3720	  3729	  3730	  3733	  3735	  3737	  3740	  3743	  3746
	  3756	  3759	  3767	  3771	  3776	  3778	  3790	  3801	  3808	  3809	  3814	  3816	  3824	  3825
	  3829	  3839	  3847	  3850	  3865	  3876	  3886	  3887	  3892	  4980
INPEND	  4713	  4894#	  6105	  6107
INPERR	   540#	  4710	  5797	  5859	  6204
INPLAB	  3637#	  4910	  4946	  5681
INPMOD	   505#	   864	  2311	  2313
INULST	  2931	  2935#
INXLST	  2936	  2940#
INZLST	  2980	  2989#
IO	    77#	   783	  2094	  6738	  6739
IOERR	  5324#	  6488
IOT	    91#	  2005	  2235
IPERR	  4710	  5101#	  5797	  5859
IPT	   168#	  2283	  2284
IRCNT	   531#	  2577	  2625	  2630	  2796	  2828	  2891	  3079	  3229	  3262	  3362	  3437	  3544	  4915
ISEC	   543#	  2802	  2808	  3222	  3226	  4698
ITEM	   559#	  1053	  1130	  1142	  1164
IVBCNT	  3523	  3525	  3526	  3527	  3538	  3548	  6992#
JF	   454#	  1450	  1458	  1704	  1712	  1716	  5212	  5220	  5225	  5226	  5227	  5239
JOB41	    51%	   687
JOBAPR	    51%	   797	  6468
JOBCNI	    51%	  6510
JOBDDT	    51%	   794	  5511	  6530	  6560
JOBFF	    50%	   738	  1640	  2409	  2459	  2701	  4496	  4505	  4534	  4538	  4547	  4590	  4936	  4942
	  5847	  5850	  6697
JOBREL	    50%	  4497	  4540	  4592	  5497	  6148	  6702
JOBREN	    50%	   683
JOBSA	    50%	   737	  2700
JOBUUO	    50%	  5519
KLUDGE	   614#	  2729	  2731	  2735	  2737	  5410	  5412	  5414
L.EOF	   191#	  3640	  3724	  3727	  3796	  3799	  3833	  3836	  3871	  3874
L.EOV	   192#	  3640	  3726	  3727	  3773	  3774	  3798	  3799	  3835	  3836	  3873	  3874	  4911
L.HDR	   190#	  3640	  3646	  3705	  3722	  3727	  3775	  3794	  3799	  3831	  3836	  3838	  3869	  3874
	  4947	  5683	  5703
L.RET	  1877#	  6819
LAB	    94#	  1871	  1872	  2007	  2008	  2236	  2237
LABCNT	   610#	  2903	  2985	  3008
LABDTW	   605#	  3013	  3021	  3704	  3739	  3742	  5893	  5895	  6010	  6014
LABEL	   130#	  1549	  1877	  2917	  3638	  3674	  4719	  4906	  5684	  5693	  5699
LABFIL	  3706	  3782	  3819	  3853	  3894	  6010#
LABNAM	   604#	  2922	  2925	  2929	  2937	  2939	  3700	  3701	  3731	  3732	  3764	  3766	  3802	  3803
	  3806	  3807	  3842	  3843	  3884	  3885	  5359	  5360	  5833	  6229	  6230
LABPPN	   606#	  2954	  2965	  3745	  3748	  5202	  5804	  6018
LABSIZ	   607#	  2907	  2910	  3009	  5890
LABSTR	   603#	  2942	  2946	  3736	  5839	  6012
LABTOT	   609#	  2902	  2982	  3010
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

LABVOL	   608#	  3702	  3734	  3770	  3813	  3849	  3891	  5350	  5865
LB.0GE	  3828	  3832#
LB.0NO	  3700	  3707#
LB.1NO	  3709	  3711#
LB.BGN	  4174	  4176	  4190#	  4252
LB.BVL	  3976#	  4104
LB.CLO	  3947	  4090	  4148#	  4169	  4234
LB.CNT	  1873	  6817#
LB.DIS	  1874	  6819#
LB.FIN	  4227#	  4238
LB.GED	  4109	  4156#
LB.HDR	  4215	  4235#
LB.IBH	  4022	  4025#
LB.IBL	  3754#	  6824
LB.IBM	  3858#	  6827
LB.ICL	  3788#	  5687	  5701	  6825	  6826
LB.IGE	  3822#	  6828
LB.IMI	  3718#	  6823
LB.NBM	  3856#	  3867
LB.NCL	  3786#	  3792
LB.NON	  3694#	  6822
LB.NST	  3700#	  3712	  3714
LB.OBH	  3958	  3960	  3969	  3994#	  4104
LB.OBL	  4173#	  6824
LB.OBM	  3950#	  6827
LB.OCL	  4255#	  6825	  6826
LB.OGE	  4107#	  6828
LB.OMI	  3898#	  6823
LB.PBL	  4177	  4244#
LB.PBM	  3961	  4094#
LB.PRT	  4136	  4139#
LB.TAB	  1552	  1873	  6810#	  6817
LB.TYP	  3639	  3675	  5686	  5700	  6822#
LHEAD	   179#	  3275	  4286	  4306	  4350	  5551
LISTAB	  5406	  5430#
LKIERR	  4708	  6483#
LOCK	  5308#	  6087
LOGOFF	   806#	  6768
LOGPRG	   808	  7020#
LOKERR	  4661	  4826	  5016	  6086#
LOKWLD	  2536	  5665#
LOOK	  6651	  6659	  6672	  6675#
LOW	   452#	   655#	  1652	  1656#	  2217	  2227#	  4443	  4448#	  5246	  5252#	  5916	  5935#	  6534	  6538#
	  6722	  6730#	  6987	  7018#
LOWT	   566#	  1913	  1926	  1929
LPT	   164#	   170	  2643	  2644
LSTDEV	   548#	  2741	  5730	  5739	  5755
LSTMEM	   582#	   725	   877	  2585
LSTPPN	   621#	  2905	  2956	  2958
LSTPTR	   553#	  3374	  3393	  3576	  3580	  3599
LSTSTR	   620#	  2904	  2943	  2945
LSTVAL	  4315	  4317	  4446#
LSTWRD	   514#	  1579	  1992	  1997	  2292	  2317	  2573	  2593	  2601	  2648
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

M.CNT	  1783	  6796#
M.DIS	  1784	  6798#
M.RET	  1787#	  6798
M.TAB	  1783	  6782#	  6796
MAK2	  3917	  3921	  6391#	  6397
MAKE	  2454	  2465	  4453#	  4941
MAKE1	  4468	  4472#
MAKE1A	  4498	  4503#
MAKE1B	  4486	  4487#
MAKE2	  4509#	  4514
MAKE2A	  4465	  4469#
MAKTWO	  3931	  3936	  3941	  4023	  4054	  4062	  4097	  4162	  4216	  4221	  4247	  6390#
MAKUP	  2117	  2122#
MAT0	  4377	  4378	  4381#
MATRIX	  4300	  4310	  4330	  4377#
MAYBE	  5133#	  5882
MF	   454#	   734	  5759	  5778	  5783	  5794	  5922
MFDARG	   589#	  5784	  5786
MFDBUF	   589	  5931#	  5932
MFDCNT	   593#	  5780
MFDCTL	  5932#
MFDDEV	  5757	  5759	  5900	  5923#	  6423
MFDERR	  5779	  5900#
MFDGET	  5781	  5788#
MFDNAM	  5773	  5774	  5776	  5777	  5778	  5925#
MFDPTR	   594#	  5787	  5788	  5789	  5790
MFDSET	  5786#	  5800
MFDWDS	  5780#	  5793
MFILES	   627#	  1401	  1406	  2688	  2696	  4834
MIDT	   565#	  1912	  1922	  1932
MOD	   126#	   728	   729	   973	  1102	  1123	  1221	  1222	  1227	  1269	  1274	  1275	  1282	  1283
	  1368	  1375	  1387	  1388	  1397	  1448	  1515	  1562	  1597	  1661	  1663	  1674	  1688	  1695
	  1731	  1737	  1836	  1838	  1851	  2244	  2250	  2297	  2300	  2323	  2349	  2351	  2477	  2613
	  2659	  3660	  4556	  4570	  5136	  5145	  5158	  5377	  6167	  6169	  6446	  6494
MOD0ER	  2337	  5321#
MODE	    84#	  1781	  2007	  2008	  2236	  2237
MODTAB	  1787	  7130#
MONIBF	  2411	  4581#	  5849
MONOBF	  2461	  4582#
MONTH	  6069	  6074	  6282	  6310#
MOVCHI	   570#	  2442
MOVCHO	   569#	  2422	  4844	  4863	  4874
MOVNAM	  5836	  6222	  6225#
MOVNM0	  2543	  6232#
MPTR	   232#	  4549	  4977	  5003
MPV	   240#	  6469	  6518	  6522	  6528
MSIZ	   231#	  2381	  2383	  2470	  3474	  3492	  4466	  4524	  4567	  4665	  4929	  5036	  5041	  5054
	  5844	  6099
MTA	   160#	   170	   835	   836	   904	   905	   943	   944	   986	   987	  1074	  1075	  1083	  1084
	  1087	  1088	  1128	  1129	  1135	  1136	  1145	  1146	  2258	  2259	  2264	  2265	  2279	  2280
	  2282	  2283	  2290	  2291	  2319	  2320	  2412	  2413	  2432	  2433	  2462	  2463	  2500	  2501
	  2518	  2519	  2545	  2546	  2646	  2647	  2678	  2679	  2683	  2684	  2801	  2802	  2858	  2859
	  2906	  2907	  2973	  2974	  3143	  3144	  3196	  3197	  3471	  3472	  4901	  4902	  5660	  5661
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

MTAWD	   630#	   857	   906	   913	   919	  1859	  1901	  1908	  3287
NAMCHK	  1439	  1615	  1672#	  1696	  1721	  2004	  2232
NAME	   122#	  1426	  1454	  1623	  1677	  2008	  2295	  2298	  2301	  2304	  2306	  2309	  2541	  2552
	  2560	  2561	  2564	  2885	  2887	  3696	  3710	  3844	  3908	  4002	  4112	  4117	  4194	  4263
	  4326	  5177	  5363	  5812	  5881	  6219	  6226	  6233	  6644
NAMIT	  5065	  5071	  5078	  5082#	  5092	  5096	  5336	  6427
NAMOUT	  2968	  5201#
NEC	   453#	  2838	  5547	  5549	  6619	  6622	  6625
NI.ERR	   182#	  4705	  4722	  4896	  4960	  4964	  5372	  5378
NI.LST	   187#	  2505	  2901	  2991	  4707	  4713
NIR	   218#	  2386	  2387	  7138	  7139	  7140	  7141	  7142	  7143	  7144
NO.PRI	   185#	  4921	  4934	  4948	  6415
NOCCL	  1637	  5158#
NOCCL0	  5160	  5166#
NOCHK	   100#	  1770	  1771	  2110	  2111	  2124	  2125
NOCHR	   534#	  2748	  2839	  5548	  6196
NOCOM	   855	  5285#
NOCORE	  4500	  4502	  4543	  4595	  5314#	  6705
NOCRLF	   159#	  1276	  2478	  3058	  3062	  3108	  3138	  3189	  3661	  6802
NODEL	  5421	  5422#	  5463
NODEV	  1635	  1650	  2367	  2374	  4928	  5069#
NODEV1	   912	  5071#
NODIS	    97#	  1785	  1786	  1831	  1832	  1846	  1847	  1863	  1864	  1875	  1876	  1905	  1906	  2011
	  2012	  2064	  2065
NOERRO	   150#	  1268	  4661	  4709	  4826	  5018	  5371	  5796	  5858	  6805
NOEXT	  1631	  2242	  2248	  5075#
NOFILE	  5120	  5124#	  5135	  5333	  5880
NOHEAD	   148#	  1284	  4285	  4305	  6801
NOHELP	  5280#	  6694	  6696
NOINP	  2284	  5094#
NOINP1	  5097	  5305#
NOIREC	  2388	  5294#
NOIUSE	  2282	  5063#
NOLAB	  4947	  4948	  5340#	  5698
NOMAKE	  2202	  5289#
NOMAT	  4947	  5357#	  5708
NOMORE	  2707	  2710#
NOOCT	  2331	  5323#
NOOPN	  2565	  2888	  5114	  5118#
NOOREC	  2392	  5313#
NOOUSE	  2264	  5062#
NOOUT	  2266	  5090#
NOOUT1	  5093	  5304#
NOR	   217#	  2390	  2391	  7132	  7133	  7134	  7137	  7138	  7139	  7140	  7141	  7142	  7143	  7144
	  7145
NORDIS	  1845	  6926#
NORET	  1491#	  7029
NOREW	  1345	  1843#	  6911
NOROOM	  4660	  4825	  5318#
NOTAB	  5291#	  6645	  6652	  6673
NOTCOM	   769#	  6781
NOTIME	  6412	  6451#
NOTLAB	  3971	  4185	  5310#
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

NOUSE	  1633	  5060#
NOW0	  1834	  1850#
NOWIND	   144#	  1565	  1566	  1572
NOWLD	  1459	  2537	  5330#
NOWRET	  1848#	  6926
NTH0	   710	   720	   723#
NTH1	   718#	  1642
NTHERE	   682	   693	   713#	   796	   815	   820	   840	  1504	  1511	  2362	  2558	  2697	  5423	  5424
	  5459	  5513	  6532	  6653	  6711
NUM	    81#	  1693	  2007	  2008
NUMRTY	  1971#	  1984
NUMVAL	  1052	  1472	  1479	  1794	  1801	  1808	  1815	  1822	  1885	  1963	  1969#
NWUCNT	  1596	  1736	  6808#
NWUTAB	  1598	  1730	  1736	  6801#	  6808
NXM	   241#	  6469	  6520	  6522	  6528
NXTBLK	  5682	  5684	  5697#
NXTDEN	  1916	  1920	  1924	  1937#	  1939
NXTDIG	  2182#	  2190
NXTDSK	  5141	  5676	  5820#
NXTENT	  2041#	  2051
NXTFIL	  5699#	  5708
NXTGET	  2976	  2993#
NXTNAM	  5682	  5707#
NXTONE	  2642	  2678	  2706#
NXTPPN	  5792#	  5858	  5908
NXTSTR	  5728#	  5760	  5764	  5793	  5796	  5855	  5902
OBCNT	   530#	  2668	  2675	  2851	  2872	  3193	  3198	  3234	  3256	  3305	  3933	  4022	  4161	  4215
	  4804
OBCSAV	   533#	  3194	  3199
OBLK	   482#	  2862
OBSIZE	  3573	  3601	  3607	  3610	  6994#
OBUF	   521#	  2257	  2384	  2429	  2463	  2864	  2865	  3237	  3242	  3251	  3470	  3477	  3481	  3483
	  3495	  3499	  4615	  4618	  4667	  4668	  4669	  4672	  4795	  4797	  4813	  4815	  4818	  4830
	  4832	  5032	  5037	  5040	  5042	  5045	  5055	  5056
OCNT	    65#	  2571	  2750	  2825	  2844	  2849	  2855
OCTMOD	   867	   965	  1096	  2270	  2320	  2330	  2334	  2339	  2353	  2472	  7131	  7135#
OCTOUT	  5107	  5477	  5972#	  5977	  6526
ODD	   196#
ODDRET	   994	  1749#	  6938
OF	    56#	   731	   746	  2239	  2240	  2241	  2243	  2244	  2258	  2263	  2264	  2265	  2279	  2294
	  2296	  2297	  2350	  2351	  2373	  2412	  2423	  2430	  2431	  2462	  2518	  2519	  2525	  2526
	  2528	  2530	  2532	  2533	  2539	  2540	  2545	  2550	  2552	  2564	  2606	  2631	  2632	  2641
	  2643	  2646	  2652	  2683	  2684	  2685	  2686	  2687	  2708	  2711	  2714	  2717	  2718	  2856
	  2858	  2885	  2887	  2971	  3108	  3138	  3143	  3189	  3196	  3200	  3238	  3277	  3280	  3471
	  3656	  3669	  3672	  3687	  3951	  3958	  3965	  3966	  4066	  4084	  4102	  4149	  4150	  4154
	  4174	  4181	  4182	  4281	  4285	  4305	  4598	  4614	  4616	  4652	  4655	  4657	  4661	  4820
	  4822	  4826	  5012	  5013	  5018	  5033	  5422	  5423	  5448	  5449	  5668	  6232	  6234	  6423
	  6444	  6446	  6541
OFCNT	   539#	  2642	  2747	  2871	  6186
OFFDEV	  2307	  2311#
OFILE	   466#	   727	   729	   743	   747	   761	   859	   880	   887	   920	   925	  1033	  1041	  1114
	  1115	  1117	  1155	  1158	  1359	  1507	  1575	  2008	  2013	  2239	  2244	  2251	  2253	  2255
	  2260	  2268	  2269	  2272	  2273	  2275	  2277	  2278	  2280	  2295	  2297	  2301	  2304	  2305
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

	  2328	  2329	  2342	  2346	  2347	  2351	  2368	  2371	  2373	  2391	  2393	  2413	  2416	  2418	  2420
	  2464	  2520	  2521	  2547	  2551	  2552	  2560	  2561	  2563	  2564	  2566	  2567	  2571	  2651
	  2659	  2734	  2750	  2844	  2855	  2884	  2885	  2887	  2889	  3098	  3150	  3152	  3211	  3291
	  3376	  3455	  3472	  3505	  3581	  3657	  3660	  3662	  3663	  3664	  3674	  3908	  3910	  3912
	  3928	  3930	  3960	  4002	  4007	  4048	  4050	  4051	  4059	  4095	  4096	  4112	  4117	  4122
	  4176	  4194	  4199	  4245	  4246	  4263	  4268	  4326	  4327	  4525	  4528	  4529	  4582	  4609
	  4613	  4793	  4807	  4809	  4869	  4883	  5062	  5091	  5113	  5118	  5119	  5122	  6015	  6169
	  6233	  6235	  6247	  6260	  6423	  6446	  6570
OIBUF	   523#	  2259	  4996	  4997	  5000	  5004	  5021
OJOBFF	   616#	  2460
OM	    68#	   867	   868	  2314	  2315	  2316	  2320	  2334	  2335	  2339	  2353	  2354	  2376	  2383
	  2389	  2591	  2592	  2840	  2852	  2895	  2920	  2970	  2978	  2988	  2989	  3049	  3068	  3074
	  3075	  3081	  3082	  3084	  3220	  3224	  3225	  3344	  3353	  3357	  3358	  3364	  3365	  3427
	  3434	  3435	  3439	  3440	  3444	  3474	  3492	  3532	  3541	  3542	  3546	  3547	  3563	  3564
	  3946	  4040	  4178	  4233	  4277	  4524	  4526	  4549	  4665	  4978	  4990	  5054	  5552
OMSAV5	   580#	  2590
OMSAVE	   581#	  2583	  2587	  2588	  2589	  2591
ONDEV	  2302	  2306#
ONE	   141#	   465	   466	   467	   468	   469	   470	   471	   472	   473	   474	   475	   476	   477
	   478	   479	   480	   481	   482	   483	   484	   485	   487	   488	   489	   490	   491	   492
	   493	   494	   495	   496	   497	   498	   499	   500	   501	   502	   503	   504	   505	   506
	   507	   508	   509	   511	   512	   513	   514	   515	   525	   526	   527	   528	   529	   530
	   531	   532	   533	   534	   535	   536	   537	   538	   539	   540	   541	   542	   543	   544
	   545	   546	   547	   548	   549	   550	   551	   552	   553	   554	   556	   557	   558	   559
	   560	   561	   562	   563	   564	   565	   566	   567	   568	   569	   570	   571	   572	   573
	   574	   575	   576	   577	   578	   596	   597	   598	   600	   603	   605	   606	   607	   608
	   609	   610	   612	   614	   615	   616	   618	   619	   620	   621	   622	   623	   624	   625
	   626	   627	   628	   629	   630	   631	   632	   633	   634	   789	  1492	  1493	  1944	  1945
	  2062	  2163	  2164	  2184	  2185	  2210	  2221	  2338	  2798	  2799	  2820	  2821	  2995	  2996
	  3648	  3649	  3749	  3750	  4043	  4319	  4446	  4487	  4535	  4536	  4545	  4670	  4692	  4693
	  4697	  4698	  4711	  4712	  4715	  4716	  4736	  4737	  4754	  4755	  4780	  4781	  4789	  4790
	  4949	  4950	  4951	  5330	  5421	  5422	  5490	  5491	  5669	  5670	  5685	  5686	  5689	  5690
	  5695	  5696	  5712	  5735	  5772	  5808	  5867	  5868	  5896	  5897	  5921	  5933	  5988	  5992
	  6019	  6020	  6048	  6054	  6072	  6075	  6094	  6098	  6099	  6101	  6102	  6231	  6232	  6236
	  6237	  6284	  6359	  6363	  6585	  6586	  6587	  6681	  6682	  6698	  6714	  6720	  6728	  6992
	  6993	  6994	  6995	  6996	  6998	  6999	  7003	  7010	  7016
ONLUFD	  5759	  5763#
OPERR	  5020	  5099#
OPN1	  5872	  5877	  5881#
OPNI1	  2283	  2289#
OPNIP0	  2293	  2301#
OPNIT	  5853	  5865#
OPNO1	  2265	  2271	  2278#
OPNUFD	  5772	  5791	  5803#
OPRLIC	   658#	   666
OPRRET	  6549	  6551#
ORCNT	   529#	  2671	  2676	  2847	  2873	  3233	  3257	  3304	  3938	  4220	  4810
OSEC	   544#	  2861	  2868	  3240	  3255	  4801	  4817
OSIZE	  3370	  3382	  3390	  3392	  3411	  3574	  3588	  3596	  3598	  3624	  4645	  6993#
OT0ASC	  3110	  3114#	  3172	  3176
OT0BGE	  3466#	  3506
OT0OCT	  3279#	  3310
OT0SIX	  3370#	  3400
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

OT0TMP	  3276	  3314	  3320	  6995#
OT0VEB	  3574#	  3603
OT1ASC	  3117#	  3129
OT1BGE	  3472#	  3482	  3500
OT1OCT	  3296#	  3321
OT1SIX	  3394#	  3398
OT1TMP	  3282	  3294	  3325	  6996#
OT1VEB	  3600	  3609	  3612#
OT2ASC	  3116	  3123#
OT2BGE	  3472	  3479	  3483#	  3497
OT2OCT	  3299#	  3303	  3316
OT2SIX	  3388#	  3412
OT3ASC	  3125	  3127	  3131#
OT3BGE	  3474	  3492#
OT3OCT	  3304#	  3327
OT3SIX	  3397	  3399#
OT3VEB	  3594#	  3625
OT4OCT	  3295	  3311#
OTBASC	  3162#	  3166	  7132
OTBBCD	  3513#	  7140
OTBBCL	  3513#	  7139
OTBBGE	  3509#	  3513
OTBCDC	  3513#	  7141
OTBEBC	  3513#	  7144
OTBFIX	  3513#	  7138
OTBGEA	  3166#	  7134
OTBHBD	  3513#	  7143
OTBHPA	  3166#	  7133
OTBIMG	  3270#	  7135
OTBOCT	  3332#	  7136
OTBSIX	  3404#	  3611	  7137
OTBVEB	  3607#	  7145
OTBXBD	  3513#	  7142
OTCASC	  3103#	  3140	  3164	  7132
OTCBCD	  3511#	  7140
OTCBCL	  3511#	  7139
OTCBGE	  3461#	  3468	  3511
OTCCDC	  3511#	  7141
OTCEBC	  3511#	  7144
OTCFIX	  3511#	  7138
OTCGEA	  3164#	  7134
OTCHBD	  3511#	  7143
OTCHPA	  3164#	  3191	  7133
OTCIMG	  3270#	  7135
OTCOCT	  3287#	  3288	  3291	  3293	  7136
OTCSIX	  3381#	  3391	  7137
OTCVEB	  3587#	  3597	  7145
OTCXBD	  3511#	  7142
OTEOCT	  3294	  3328#
OTFASC	  3159#	  3167	  7132
OTFBCD	  3514#	  7140
OTFBCL	  3514#	  7139
OTFBGE	  3505#	  3514
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

OTFCDC	  3514#	  7141
OTFEBC	  3514#	  7144
OTFFIX	  3514#	  7138
OTFGEA	  3167#	  7134
OTFHBD	  3514#	  7143
OTFHPA	  3211#	  7133
OTFIMG	  3270#	  7135
OTFOCT	  3325#	  7136
OTFSIX	  3411#	  7137
OTFVEB	  3624#	  7145
OTFXBD	  3514#	  7142
OTHDEV	  6418	  6423#
OTIASC	  3098#	  3132	  3155	  3163	  7132
OTIBCD	  3510#	  7140
OTIBCL	  3510#	  7139
OTIBGE	  3455#	  3485	  3510
OTICDC	  3510#	  7141
OTIEBC	  3510#	  7144
OTIFIX	  3510#	  7138
OTIGEA	  3163#	  7134
OTIHBD	  3510#	  7143
OTIHPA	  3163#	  3201	  3207	  7133
OTIIMG	  3269#	  7135
OTIOCT	  3275#	  7136
OTISIX	  3369#	  7137
OTIVEB	  3572#	  7145
OTIXBD	  3510#	  7142
OTP	   169#	  2265	  2266
OTPERR	   541#	  5017	  6209
OTRAC0	  3121	  3136#	  3160
OTRAS1	  3139	  3144#
OTRAS2	  3144	  3149#
OTRASC	  3137#	  3165	  7132
OTRBCD	  3512#	  7140
OTRBCL	  3512#	  7139
OTRBGE	  3467#	  3469	  3512
OTRCDC	  3512#	  7141
OTREBC	  3512#	  7144
OTRFIX	  3512#	  7138
OTRGEA	  3165#	  7134
OTRHBD	  3512#	  7143
OTRHP0	  3187#	  3213
OTRHP1	  3190	  3197	  3202#
OTRHPA	  3188#	  7133
OTRIMG	  3270#	  7135
OTROCT	  3332#	  7136
OTRSIX	  3389#	  7137
OTRVEB	  3595#	  7145
OTRXBD	  3512#	  7142
OUTB	   229#	  2852
OUTBUF	   519#	  3676	  3677	  3678	  3903	  3907	  3909	  3911	  3918	  3919	  3922	  3924	  3929	  3932
	  3937	  3943	  3967	  3972	  3976	  3994	  4032	  4107	  4183	  4186	  4190	  4260	  5009	  5046
OUTC	   227#	  2840	  3225	  5552
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

OUTDIA	  1431	  1462#	  1465
OUTF	   230#	  2989	  3049	  3068	  3074	  3224	  3344	  3353	  3357	  3427	  3434	  3532	  3541	  3563
OUTI	   226#	  2592	  2895	  3082	  3365	  3440	  3547
OUTLA1	  3659	  3662	  3666	  3672#
OUTLA2	  3657	  3671	  3673#
OUTLAB	  2546	  3656#	  3685
OUTMOD	   481#	   868	  2314	  2316	  2584	  3081	  3364	  3439	  3546
OUTR	   228#	  2970	  2978	  2988	  3075	  3358	  3435	  3542
P1	    61#	   698	   701	   766	  1486	  1517	  1521	  1523	  1527	  1531	  1554	  1558	  1590	  1591
	  1594	  1616	  1617	  1618	  1619	  1620	  1622	  1624	  1625	  1627	  1633	  1636	  1639	  1648
	  1722	  1746	  1783	  1829	  1844	  1861	  1873	  1903	  2009	  2040	  2056	  2063	  2180	  2186
	  2188	  2502	  2503	  2506	  2507	  2508	  2513	  2520	  2521	  2522	  2523	  2524	  2529	  2541
	  2616	  2617	  2618	  2622	  2625	  2662	  2663	  2664	  2668	  2671	  2931	  2946	  2947	  2951
	  2954	  2956	  2958	  2961	  2999	  3002	  3027	  3030	  3033	  3047	  3060	  3088	  3222	  3226
	  3228	  3247	  3248	  3249	  3255	  3256	  3257	  3258	  3259	  3338	  3339	  3345	  3350	  3351
	  3423	  3425	  3521	  3522	  3523	  3525	  3526	  3527	  3528	  3530	  3552	  3553	  3555	  3696
	  3700	  3709	  3710	  3729	  3731	  3760	  3763	  3764	  3802	  3806	  3839	  3841	  3842	  3846
	  3877	  3884	  3898	  3900	  3902	  3903	  3904	  3905	  3906	  3907	  3908	  3909	  3910	  3911
	  3924	  3928	  3929	  3943	  3973	  3976	  3984	  3994	  4015	  4020	  4032	  4047	  4070	  4074
	  4086	  4098	  4107	  4116	  4126	  4187	  4190	  4198	  4213	  4226	  4248	  4260	  4292	  4296
	  4299	  4359	  4365	  4369	  4370	  4372	  4401	  4402	  4461	  4462	  4474	  4475	  4503	  4504
	  4506	  4507	  4508	  4509	  4510	  4513	  4515	  4560	  4561	  4565	  4566	  4980	  4987	  4996
	  4998	  4999	  5000	  5001	  5003	  5004	  5007	  5008	  5009	  5024	  5034	  5036	  5037	  5046
	  5048	  5054	  5055	  5149	  5150	  5151	  5152	  5153	  5166	  5177	  5184	  5188	  5190	  5284
	  5285	  5288	  5289	  5293	  5294	  5296	  5297	  5299	  5300	  5302	  5304	  5305	  5307	  5308
	  5310	  5311	  5313	  5314	  5316	  5318	  5320	  5321	  5323	  5324	  5326	  5327	  5341	  5344
	  5359	  5363	  5366	  5387	  5404	  5519	  5520	  5529	  5530	  5537	  5538	  5541	  5565	  5577
	  5586	  5600	  5605	  5613	  5637	  5644	  5645	  5648	  5649	  5832	  5833	  5957	  5966	  5988
	  5991	  5992	  5995	  6003	  6006	  6031	  6032	  6035	  6135	  6136	  6137	  6138	  6141	  6144
	  6148	  6156	  6159	  6171	  6174	  6180	  6181	  6186	  6187	  6196	  6204	  6209	  6219	  6226
	  6229	  6233	  6297	  6300	  6307	  6350	  6351	  6352	  6353	  6354	  6355	  6356	  6358	  6359
	  6360	  6361	  6362	  6363	  6368	  6369	  6370	  6371	  6373	  6488	  6490	  6546	  6637
P2	    62#	   767	  1053	  1054	  1055	  1057	  1059	  1072	  1130	  1131	  1142	  1143	  1164	  1165
	  1320	  1473	  1480	  1481	  1482	  1487	  1723	  1747	  1784	  1795	  1802	  1809	  1816	  1823
	  1830	  1845	  1862	  1874	  1886	  1904	  1964	  2010	  2058	  2059	  2062	  2181	  2188	  2189
	  2509	  2510	  2511	  2514	  2525	  2526	  2527	  2530	  2542	  2997	  2998	  3000	  3025	  3026
	  3028	  3046	  3059	  3424	  3431	  3448	  3529	  3536	  3568	  3697	  3701	  3712	  3713	  3730
	  3732	  3759	  3765	  3801	  3807	  3840	  3881	  3885	  3942	  3972	  3977	  3980	  3987	  3995
	  3997	  3999	  4002	  4007	  4024	  4025	  4033	  4035	  4037	  4055	  4063	  4075	  4078	  4099
	  4109	  4112	  4117	  4122	  4129	  4132	  4138	  4139	  4156	  4158	  4163	  4186	  4191	  4194
	  4197	  4198	  4199	  4210	  4212	  4213	  4217	  4222	  4227	  4249	  4255	  4257	  4259	  4263
	  4268	  4278	  4287	  4299	  4360	  4366	  4371	  4373	  4419	  4464	  4466	  4469	  4470	  4471
	  4476	  4477	  4493	  4494	  4495	  4496	  4497	  4499	  4501	  4505	  4507	  4509	  4510	  4511
	  4512	  4513	  4763	  4981	  4988	  5010	  5025	  5047	  5052	  5178	  5186	  5192	  5202	  5222
	  5236	  5360	  5364	  5582	  5585	  5634	  5635	  5639	  5956	  6032	  6034	  6141	  6181	  6182
	  6187	  6188	  6223	  6228	  6230	  6235	  6390	  6391	  6392	  6409	  6410	  6411	  6412	  6428
	  6431	  6434	  6437	  6547
P3	    63#	  1562	  1563	  1564	  1565	  1566	  1568	  1570	  1572	  1597	  1598	  2050	  2054	  2056
	  2057	  2058	  2066	  2068	  3098	  3110	  3121	  3141	  3173	  3192	  3211	  3279	  3281	  3282
	  3294	  3303	  3320	  3325	  3371	  3372	  3373	  3374	  3376	  3381	  3392	  3393	  3395	  3396
	  3455	  3461	  3469	  3505	  3575	  3576	  3577	  3579	  3581	  3587	  3598	  3601	  3607	  3612
	  3613	  3615	  3649	  3698	  3702	  3733	  3734	  3761	  3767	  3768	  3769	  3770	  3804	  3812
	  3813	  3847	  3848	  3849	  3879	  3890	  3891	  3944	  3974	  3978	  3981	  3985	  3988	  3990
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

	  4000	  4003	  4005	  4008	  4010	  4026	  4028	  4038	  4056	  4064	  4076	  4079	  4081	  4087	  4100
	  4110	  4113	  4118	  4120	  4123	  4130	  4133	  4140	  4143	  4159	  4164	  4167	  4188	  4192
	  4195	  4200	  4205	  4218	  4223	  4228	  4230	  4235	  4250	  4261	  4264	  4266	  4269	  4271
	  4275	  4358	  4364	  4368	  4409	  4422	  4423	  4430	  4491	  4492	  4494	  4514	  4631	  4632
	  4633	  4675	  4676	  4678	  4857	  4886	  4975	  4977	  4983	  4984	  5611	  5612	  5614	  5958
	  5967	  6025	  6028	  6033	  6115	  6408	  6409	  6416	  6417	  6419	  6420	  6421	  6423
P4	    64#	   859	   860	   861	   862	  1358	  1515	  1596	  1598	  1600	  1603	  1730	  1736	  1787
	  1788	  1833	  1837	  1848	  1850	  1865	  1866	  1877	  1907	  1928	  2014	  2057	  2613	  2614
	  2659	  2660	  3296	  3299	  3302	  3315	  4381	  4384	  4392	  4395	  4402	  4405	  4431	  4437
	  4535	  4536	  4544	  4545	  4546	  4549	  4550	  4551	  5107	  5136	  5137	  5145	  5158	  5159
	  5173	  5183	  5185	  5189	  5477	  5913	  5979	  6093	  6094	  6095	  6096	  6099	  6100	  6103
	  6104	  6105	  6106	  6107	  6494	  6495	  6526	  6569
PAR	    83#	  1744	  2007	  2008	  2236	  2237
PARERR	  4662	  4827	  5100	  5102	  5327#
PASLOP	  1770#	  1776
PASS	   611#	  1585	  1587	  1590	  1594	  1767	  1768	  1769	  1774	  4132	  4135	  4137
PAT	   602#
PATCH	   602#
PATH	  5716	  5717	  5721	  5918#
PATSIZ	   458	   602
PAUSE	  6583#	  6985
PC	   600#	  5492
PDL	   239#	  6469	  6511	  6516	  6522	  6528
PDP	    70#	   661	   662	   673	   689	   694	   718	  1045	  1217	  1225	  1236	  1246	  1254	  1270
	  1278	  1286	  1292	  1302	  1312	  1322	  1330	  1338	  1348	  1376	  1383	  1391	  1398	  1404
	  1407	  1413	  1421	  1447	  1460	  1483	  1490	  1685	  1687	  1690	  1718	  1732	  1738	  1753
	  1758	  1763	  1789	  1796	  1803	  1810	  1817	  1824	  1839	  1852	  1867	  1878	  1887	  1892
	  1899	  1935	  1940	  1957	  1965	  1977	  1993	  1999	  2086	  2121	  2125	  2128	  2130	  2138
	  2142	  2144	  2173	  2187	  2207	  2209	  2215	  2497	  2562	  2722	  2751	  2759	  2789	  2806
	  2810	  2827	  2832	  2846	  2850	  2857	  2859	  2869	  2896	  2897	  2898	  2996	  3001	  3005
	  3024	  3029	  3037	  3099	  3119	  3122	  3261	  3283	  3326	  3329	  3377	  3384	  3407	  3456
	  3558	  3561	  3562	  3583	  3590	  3620	  3645	  3691	  3728	  3758	  3787	  3800	  3837	  3857
	  3875	  4155	  4282	  4374	  4380	  4386	  4406	  4425	  4457	  4516	  4523	  4552	  4575	  4577
	  4600	  4607	  4656	  4662	  4674	  4680	  4694	  4716	  4723	  4728	  4751	  4798	  4827	  4836
	  4855	  4860	  4881	  4885	  4949	  4962	  4963	  4969	  5026	  5088	  5115	  5199	  5207	  5215
	  5221	  5228	  5231	  5244	  5379	  5386	  5411	  5413	  5416	  5427	  5438	  5490	  5542	  5562
	  5592	  5595	  5615	  5618	  5621	  5655	  5676	  5692	  5729	  5737	  5741	  5750	  5753	  5959
	  5968	  5986	  6036	  6055	  6078	  6083	  6127	  6215	  6220	  6224	  6250	  6266	  6268	  6271
	  6275	  6290	  6292	  6302	  6305	  6308	  6318	  6320	  6322	  6323	  6325	  6326	  6328	  6329
	  6330	  6331	  6334	  6335	  6339	  6340	  6341	  6342	  6350	  6353	  6360	  6365	  6366	  6367
	  6374	  6385	  6393	  6398	  6401	  6413	  6447	  6479	  6499	  6512	  6514	  6543	  6556	  6578
	  6593	  6607	  6628	  6636	  6664	  6674	  6676	  6678
PDPSIZ	   457	   520	   694	   718	  1957	  5411	  5413
PDTBU0	  5583#	  5588
PDTBUF	  5566	  5582#
PER	    74#	   777	  1679	  2094	  6735
PERFOR	   843#	   895	  2705	  6777	  6778
PERFOY	   858	   863	   864	   866	   869#
PERGE	   133#	  1531	  1886	  3930	  3960	  4095	  4096	  4176	  4245	  4246
PICTUR	  4325	  4329	  4409#	  4423
PLACE	  3762	  3805	  3945	  3975	  3979	  3982	  3989	  4001	  4004	  4009	  4027	  4039	  4057	  4065
	  4077	  4080	  4101	  4111	  4114	  4119	  4124	  4131	  4134	  4141	  4160	  4165	  4189	  4193
	  4196	  4201	  4219	  4224	  4229	  4251	  4262	  4265	  4270	  5956#	  5958
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

POSI0	  2507	  2510#
POSINP	  2463	  2466	  2500#
POSO0	  2523	  2526#
POSOUT	  2501	  2506	  2515	  2518#
PPN	   125#	  1441	  1457	  1717	  2551	  2563	  2566	  2884	  2889	  3912	  3914	  5125	  5135	  5182
	  5188	  5192	  5332	  5746	  5765	  5770	  5852	  5868	  5871	  5883	  5889	  6015	  6260	  6649
PPNERR	  1700	  1707	  1715	  5297#
PR.CNT	  1746	  6936#
PR.DIS	  1747	  6938#
PR.TAB	  1746	  6934#	  6936
PRG	   186#	  2639	  4094	  4244
PRGNAM	   598#	   680	   695	   844	  2608	  2654	  4075	  5488	  6686
PROCED	  2603	  2605	  2629#
PROD1	  2574	  2581#
PROD2	  2582	  2592#
PTP	   165#	   170
PTR	   166#	   170
PUT	  3113	  3146	  3148	  3175	  3181	  3203	  3205	  3301	  3313	  3318	  3328	  3462	  4349	  4404
	  4439	  4677	  4793#	  5051	  5552
PUT1	  4795#	  4800	  4856	  4877	  4891
PUTDAT	  4345	  5555#
PUTNAM	  5187	  5361	  5365	  5634#
PUTNM0	  5636	  5643#
PUTOCT	   699	   702	  5612#	  5617	  5646	  5650	  6149
PUTSIX	   696	   845	  1543	  1548	  1553	  1574	  1604	  1954	  2609	  2655	  5086	  5175	  5195	  5197
	  5282	  5351	  5354	  5436	  5625#	  5631	  5638	  5642
PUTTIM	  4347	  5570#
PUTXDT	  3022	  5556#
Q1	  1423#
Q10	  1168	  1288#
Q11	   989	  1169	  1294#
Q12	   996	  1170	  1304#
Q13	   998	  1171	  1314#
Q14	  1005	  1172	  1332#
Q15	  1007	  1173	  1340#
Q16	  1009	  1174	  1350#
Q18	  1176	  1378#
Q18CLR	  1010	  1381#
Q18SET	  1380#
Q19	  1177	  1385#
Q19CLR	  1011	  1388#
Q19SET	  1015	  1387#
Q2	   945	  1078	  1209#
Q20	  1017	  1147	  1178	  1393#
Q22	  1021	  1152	  1180	  1400#
Q23	  1034	  1181	  1409#
Q24	  1036	  1182	  1415#
Q24CLR	  1419#	  6915
Q24SET	  1418#	  6914
Q3	   954	  1085	  1219#
Q3CLR	   946	  1222#
Q3SET	   956	  1221#
Q4	   962	  1092	  1272#
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

Q4CLR	  1274#
Q4SET	   957	  1275#
Q5	   966	  1098	  1227#
Q5A	  1229	  1238#
Q5B	  1230#
Q6	   974	  1103	  1248#
Q8	   976	  1106	  1264#
Q9	   982	  1112	  1280#
Q9CLR	   977	  1283#
Q9SET	  1282#
QTAB	  1131	  1143	  1165	  1168#
QUES	   911	  5061	  5064#	  5069	  5075	  5090	  5094	  5162	  5334	  5382
QW	  5340	  5348	  5357	  5382#
RDMFER	  5785	  5794#
RDUFER	  5829	  5856#
REC	    96#	  1800	  1801	  2007	  2008	  2236	  2237
RECADV	   140#	  1000	  1823	  2581	  3076	  3359	  3436	  3543
RECPTR	   552#	  3372	  3405	  3577	  3579	  3608	  3626	  4520	  4550	  4605	  4620	  4675
RECSIZ	   128#	  1032	  1033	  1154	  1155	  1521	  1802	  2251	  2253	  2273	  2275	  2325	  2327	  2328
	  2329	  2344	  2345	  2346	  2347	  2387	  2391	  2468	  2483	  3046	  3063	  3098	  3211	  3376
	  3423	  3455	  3505	  3581	  3662	  4048	  4059	  4456	  4458	  4525	  4559
RED0	  4984#	  4988
RED0B	  5012	  5017	  5019	  5021#	  5025
REDCCL	  2098	  2153#	  2157	  2159	  2167
REDOUT	  3963	  4179	  4996#
REDTAB	  6612	  6616	  6633#
REL	    82#	  1884	  2007	  2008	  2236	  2237
RELNUM	   535#	  3973	  3980	  4098	  4187	  4227	  4248
REN0	  2796#	  2813
REN1	  2795	  2799#
REN2	  2802#	  2807
REN3	  2804	  2808#
REN4	  2811#	  2815
REN5	  2801	  2802	  2814#
REN6	  2817	  2820#
RENEW	  2795#	  3073	  3356	  3433	  3540
REP	   242#	  6469	  6528
RESYNC	   784	  2004#
RET0	  1045	  1217	  1225	  1236	  1246	  1254	  1270	  1278	  1286	  1292	  1302	  1312	  1322	  1330
	  1338	  1348	  1376	  1383	  1391	  1398	  1404	  1407	  1413	  1421	  1447	  1450	  1460	  1483
	  1490	  1492	  1672	  1685	  1687	  1690	  1699	  1718	  1732	  1738	  1753	  1758	  1763	  1773
	  1789	  1796	  1803	  1810	  1817	  1824	  1839	  1852	  1867	  1878	  1887	  1892	  1899	  1935
	  1940	  1944	  1965	  1977	  1993	  1999	  2023	  2086	  2121	  2125	  2128	  2130	  2138	  2142
	  2144	  2163	  2184	  2187	  2207	  2209	  2215	  2497	  2586	  2722	  2751	  2759	  2789	  2798
	  2806	  2810	  2820	  2827	  2832	  2846	  2850	  2857	  2859	  2869	  2898	  2995	  2996	  3024
	  3099	  3106	  3119	  3122	  3162	  3261	  3269	  3283	  3303	  3326	  3329	  3377	  3381	  3384
	  3407	  3456	  3461	  3509	  3558	  3561	  3583	  3587	  3590	  3620	  3645	  3648	  3650	  3651
	  3691	  3728	  3749	  3758	  3787	  3800	  3837	  3857	  3875	  4155	  4282	  4286	  4306	  4374
	  4380	  4386	  4401	  4406	  4425	  4457	  4516	  4523	  4552	  4575	  4577	  4600	  4607	  4656
	  4662	  4674	  4680	  4692	  4694	  4697	  4711	  4715	  4716	  4723	  4728	  4736	  4751	  4754
	  4780	  4789	  4798	  4816	  4827	  4836	  4855	  4860	  4881	  4885	  4897	  4902	  4950	  4969
	  5015	  5088	  5115	  5190	  5199	  5207	  5215	  5221	  5228	  5231	  5244	  5288	  5344	  5379
	  5386	  5421	  5427	  5438	  5531	  5542	  5585	  5621	  5625	  5655	  5660	  5661	  5669	  5676
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

	  5685	  5689	  5692	  5695	  5729	  5737	  5741	  5750	  5753	  5754	  5821	  5867	  5896	  5959	  5968
	  6019	  6036	  6055	  6083	  6098	  6101	  6115	  6127	  6215	  6220	  6224	  6231	  6236	  6250
	  6266	  6275	  6308	  6335	  6342#	  6342	  6374	  6385	  6401	  6413	  6447	  6479	  6499	  6543
	  6556	  6586	  6593	  6607	  6628	  6636	  6664	  6674	  6676	  6678	  6681	  6822
RET1	  3775	  3839	  4706	  4708	  5661	  6341#
RET3	  3647	  6339#
RETAIN	   814#	  6775
RETCHR	   561#	  1024	  1410	  1412	  3120
RETWRD	   612#	   684	   719	   721	   769	   814	   819	   854	   856	   881	   893	  1503	  1891	  1897
	  1898	  2233	  2360	  2739	  2740
REVIVE	  4989#	  5027	  5057
REW0	  1835#	  1849
REWBIT	  1837	  1850	  6929#
REWCNT	  1829	  1844	  6921#
REWDIS	  1830	  6923#
REWIND	  1828#	  6910
REWNOW	   824#	  6780
REWRET	  1833#	  6923
REWTAB	  1569	  1571	  1573	  1829	  1844	  6917#	  6921
RPTFLG	   632#	  2377	  2695	  2725	  5415
RUNDDT	  6560#	  6980	  6981
RUNDIS	  6547	  6980#
RUNFIL	  6568#	  6983
RUNFLG	   551#	  2095	  2104	  2363	  5450	  5452
RUNIT	  2199	  2201	  2203#
RUNLEN	  6546	  6978#
RUNTAB	  6546	  6972#	  6978
RUNWHT	  6566#	  6982
S	    55#	   758	   759	   760	   763	   773	   775	   777	   779	   781	   782	   783	   784	   829
	   831	   875	   881	   888	   899	  1051	  1213	  1216	  1233	  1235	  1241	  1245	  1251	  1253
	  1298	  1301	  1308	  1311	  1317	  1319	  1327	  1329	  1335	  1337	  1344	  1347	  1354	  1357
	  1364	  1366	  1432	  1434	  1440	  1471	  1478	  1485	  1489	  1491	  1493	  1495	  1610	  1612
	  1659	  1679	  1686	  1689	  1693	  1698	  1744	  1745	  1766	  1770	  1772	  1781	  1782	  1785
	  1793	  1800	  1807	  1814	  1821	  1828	  1831	  1843	  1846	  1857	  1858	  1863	  1871	  1872
	  1875	  1884	  1905	  1962	  1969	  2005	  2007	  2011	  2014	  2022	  2033	  2048	  2049	  2052
	  2053	  2060	  2061	  2064	  2067	  2076	  2094	  2110	  2119	  2120	  2124	  2143	  2164	  2174
	  2183	  2235	  2236	  2237	  2238	  2504	  2505	  2538	  2639	  2724	  2733	  2814	  2890	  2901
	  2991	  3072	  3107	  3117	  3130	  3131	  3137	  3142	  3159	  3188	  3195	  3212	  3275	  3640
	  3646	  3684	  3686	  3705	  3722	  3724	  3726	  3727	  3773	  3774	  3775	  3794	  3796	  3798
	  3799	  3831	  3833	  3835	  3836	  3838	  3869	  3871	  3873	  3874	  3899	  3901	  3934	  3939
	  3957	  3996	  3998	  4021	  4034	  4036	  4072	  4094	  4108	  4157	  4173	  4211	  4214	  4244
	  4256	  4258	  4280	  4286	  4306	  4308	  4350	  4683	  4701	  4705	  4707	  4713	  4722	  4819
	  4896	  4902	  4911	  4912	  4921	  4934	  4947	  4948	  4960	  4964	  4966	  5011	  5108	  5128
	  5160	  5287	  5328	  5372	  5378	  5383	  5391	  5393	  5395	  5397	  5420	  5505	  5551	  5683
	  5703	  6414	  6415	  6545	  6548	  6552	  6553	  6635	  6687	  6690	  6692	  6707
SAMDEV	  2403	  5326#
SAV2	  5518	  6349#
SAV3	  6024	  6027	  6347#
SAV4	  5665	  5674	  6345#
SAVCH	   575#	  3052	  3114
SAVCNT	   629#	  4814	  4833
SAVDEV	   633#	  1062	  1066
SAVEAC	  6346	  6348	  6350#
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

SAVMOD	   634#	  1077	  1080
SAVPTR	   628#	  4812	  4831
SBLKN	   626#	  1473	  4802
SCAN	   158#	  1374	  2322	  5343	  5346	  5667	  5668	  5691	  5697	  5707	  6807
SEARCH	   549#	  5727	  5728
SEC	   135#	  4574	  4576
SEC0	  4558	  4563	  4576#
SECTOR	  2568	  2570	  4556#
SEND1	  4874#	  4879
SENDAL	  4842	  4873#
SETBLK	  1405	  1468#	  2883
SETBY1	  2476	  2479	  2488	  2492#
SETBYT	  2421	  2441	  2468#
SETCNT	  2825#	  3136	  3187	  3388	  3466	  3594
SETDIN	  2435	  2446#
SETDIS	  2415	  2426#
SETIMG	  2338#	  2359
SETIN1	  2414	  2419	  2430#
SETIN2	  2418	  2420#
SETINP	  2395	  2398	  2400	  2409#
SETIP	  2413	  2432#
SETIP1	  2434	  2439	  2450#
SETIP2	  2438	  2440#
SETOUT	  2433	  2459#
SETS1	  2767#	  2769	  2788
SETS2	  2771	  2789#
SETS3	  2782#	  2787
SETSQ	  2765#	  2773	  2777
SETSUB	  2380	  2754#
SETUP	  2704	  2724#	  2882
SETUP1	  2738#
SIDE	    65#	   761	   824	   832	   882	   887	   900	   907	   910	   920	   934	   940	   947	   958
	   964	   968	   969	   972	   973	   978	   984	  1000	  1001	  1003	  1012	  1018	  1026	  1029
	  1039	  1041	  1061	  1065	  1069	  1076	  1079	  1089	  1095	  1102	  1108	  1115	  1133	  1137
	  1150	  1158	  1160	  1221	  1222	  1227	  1243	  1244	  1269	  1274	  1275	  1282	  1283	  1321
	  1359	  1368	  1369	  1375	  1387	  1388	  1397	  1426	  1427	  1436	  1441	  1444	  1445	  1448
	  1454	  1455	  1457	  1507	  1510	  1515	  1517	  1521	  1527	  1531	  1535	  1544	  1549	  1554
	  1558	  1562	  1575	  1597	  1623	  1626	  1661	  1663	  1666	  1674	  1677	  1683	  1688	  1695
	  1717	  1731	  1737	  1749	  1750	  1788	  1795	  1802	  1809	  1816	  1823	  1836	  1838	  1851
	  1855	  1877	  1886	  1964	  2006	  2420	  2440	  2453	  2464	  2468	  2469	  2474	  2477	  2483
	  2484	  2485	  2496	  2567	  2569	  2605	  2651	  2728	  2734	  4453	  4454	  4456	  4458	  4463
	  4472	  4473	  4478	  4491	  4556	  4558	  4559	  4562	  4564	  4570	  4574	  4576	  4581	  4582
	  4583	  4585	  4597	  4940	  5118	  5124	  5125	  5138	  5145	  5149	  5158	  5161	  5170	  5172
	  5177	  5178	  5179	  5182	  5188	  5192	  5900	  5906	  6496	  6570	  6574
SIXLOP	  2021#	  2026
SIXMOD	   949	  4467	  7131	  7136#
SKP0	  5373#	  5376
SKPCHK	   568#	  3105	  3118
SKPFIL	  5371#	  5688	  5704
SKPIT	  5702	  5704#
SLH	    75#	   782	  2094	  6737
SOM	    79#	  1772	  2022	  2094	  2174	  2183	  6733	  6734	  6735	  6736	  6737	  6738	  6739	  6740
	  6741	  6742	  6743	  6744
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

SP36M	   558#	  1380	  1381	  4688	  4744
SPACE	  3986	  3991	  4006	  4011	  4029	  4082	  4088	  4121	  4267	  4272	  4276	  5965#
SPAN	   151#	  1223	  1228	  2348	  2350	  2800	  2856	  3077	  3360	  4084	  4614	  6806
SPC	    90#	  2094	  2120	  6741	  6743	  6744
SPCCNT	   542#	   759	   826	  1050	  1210	  1231	  1239	  1249	  1295	  1305	  1315	  1325	  1333	  1341
	  1351	  1362	  1425	  1469	  1476	  1609	  1614	  1970	  1975	  2109	  2145	  2147	  2151	  5392
SPCNT	   563#	  1416	  3144	  3171	  3174	  3177	  3182
STACK	   520#	   599	   694	   718	  1957	  5411	  5413
STAR	   101#	  1686	  1687	  1689	  1690	  2076	  2077	  2143	  2144
START	   661#	   790	  7146
START1	   689	   694#
STAT	  2689	  2875	  4913	  6131#	  6566
STAT2	  6197	  6204#
STAT4	  6205	  6209#
STAT5	  6210	  6214#
STAT6	  6182	  6186#
STAT7	  6188	  6196#
STAT88	  6169	  6171#
STAT9	  6171	  6180#
STATUS	   119#	   836	  1535	  1749	  1750	  2255	  2256	  2268	  2280	  2285	  2291	  2366	  2373	  2416
	  2436	  4585	  5841
STOP	   788#	   810	  5458	  6767	  6769	  6770
STOPIT	  5460#	  6454	  6984
STORE	  2993	  4903	  6318#	  6405	  6493	  6544
STS	   234#	  2385	  2389	  3084	  3444	  3564	  4461	  4526	  4560
SUBSTF	   631#	  2758	  2760	  6604
SVDPTR	  1538	  1855#	  1866	  1934
SW.A	  1318	  1807#	  6893
SW.AR	  1336	  1821#	  6913
SW.B	  1252	  1793#	  6890	  6891
SW.BK	  1328	  1814#	  6912
SW.BUF	  1962#	  6904
SW.CNT	  1722	  6872#
SW.D	  1299	  1857#	  6887
SW.D1	  1860	  1903#
SW.DIS	  1723	  6873#
SW.GO	  1897#	  6901	  6902
SW.H	  6686#	  6773	  6774	  6894	  6903
SW.KEP	  1891#	  6900
SW.L	  1355	  1871#	  6888
SW.M	  1214	  1781#	  6889
SW.NWU	  1730#	  6873	  6874	  6875	  6876	  6877	  6878	  6879
SW.OFF	  1736#	  6880	  6881	  6882	  6883	  6884	  6885	  6886
SW.P	  1309	  1744#	  6892
SW.PW	  1766#	  6899
SW.R	  1234	  1242	  1800#	  6895	  6896	  6897
SW.RET	   782#	  1724
SW.RL	  1365	  1884#	  6898
SW.TAB	  1603	  1722	  6829#	  6872
SWERR	  1745	  1782	  1794	  1801	  1808	  1815	  1822	  1858	  1872	  1885	  1963	  5300#
SYNC	   197#	  4956	  4966	  6104
SYSDEV	  5714	  5722	  5726#
SYSLOK	  5733	  5743#
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

SYSNAM	   601#	  5484	  7014
SYSPP	  5219	  5247#
SYSSRH	   550#	  5726	  5732	  5768
T1	    58#	   663	   664	   665	   666	   676	   677	   682	   683	   686	   687	   690	   691	   695
	   704	   707	   722	   723	   724	   725	   735	   737	   738	   739	   741	   742	   743	   744
	   745	   746	   747	   794	   802	   808	   809	   825	   826	   832	   833	   834	   835	   844
	   847	   850	   857	   863	   876	   877	   878	   879	   880	   896	   897	   900	   901	   902
	   903	   904	   905	   909	   914	   916	   941	   942	   943	   944	   945	   947	   948	   949
	   951	   953	   954	   958	   959	   961	   962	   963	   964	   965	   967	   968	   969	   970
	   971	   973	   975	   976	   978	   979	   981	   982	   984	   985	   986	   988	   989	   990
	   991	   992	   997	   998	   999	  1000	  1003	  1004	  1006	  1007	  1008	  1009	  1012	  1013
	  1014	  1016	  1017	  1020	  1021	  1023	  1024	  1026	  1027	  1028	  1029	  1030	  1032	  1033
	  1035	  1036	  1046	  1047	  1049	  1050	  1061	  1062	  1063	  1064	  1065	  1066	  1069	  1070
	  1071	  1074	  1075	  1076	  1079	  1080	  1083	  1084	  1085	  1087	  1088	  1089	  1090	  1094
	  1095	  1096	  1100	  1101	  1102	  1105	  1106	  1108	  1109	  1111	  1112	  1114	  1128	  1129
	  1130	  1135	  1136	  1137	  1138	  1139	  1145	  1146	  1147	  1149	  1150	  1157	  1160	  1161
	  1163	  1164	  1209	  1210	  1221	  1222	  1224	  1227	  1228	  1230	  1231	  1238	  1239	  1248
	  1249	  1274	  1275	  1277	  1282	  1283	  1285	  1294	  1295	  1304	  1305	  1314	  1315	  1324
	  1325	  1332	  1333	  1340	  1341	  1350	  1351	  1361	  1362	  1368	  1370	  1380	  1381	  1382
	  1387	  1388	  1390	  1418	  1419	  1420	  1424	  1425	  1435	  1436	  1444	  1446	  1448	  1449
	  1454	  1458	  1462	  1463	  1468	  1469	  1475	  1476	  1499	  1500	  1523	  1524	  1535	  1536
	  1538	  1539	  1540	  1542	  1544	  1547	  1549	  1552	  1569	  1571	  1573	  1581	  1583	  1584
	  1603	  1623	  1624	  1625	  1626	  1627	  1628	  1629	  1630	  1632	  1640	  1641	  1647	  1649
	  1660	  1661	  1663	  1664	  1673	  1674	  1675	  1681	  1688	  1694	  1695	  1708	  1712	  1730
	  1731	  1736	  1737	  1749	  1750	  1752	  1835	  1836	  1837	  1838	  1850	  1851	  1907	  1909
	  1918	  1922	  1926	  1928	  1929	  1932	  1937	  1938	  1941	  1942	  1943	  1951	  1952	  1953
	  1973	  1974	  1975	  2034	  2036	  2037	  2040	  2042	  2044	  2050	  2051	  2054	  2059	  2062
	  2065	  2068	  2106	  2113	  2114	  2116	  2117	  2118	  2119	  2147	  2148	  2149	  2150	  2151
	  2198	  2200	  2203	  2204	  2210	  2214	  2233	  2234	  2242	  2248	  2251	  2252	  2254	  2255
	  2256	  2257	  2259	  2260	  2261	  2262	  2267	  2268	  2269	  2270	  2273	  2274	  2275	  2276
	  2277	  2278	  2280	  2284	  2285	  2287	  2288	  2289	  2291	  2304	  2309	  2324	  2325	  2327
	  2329	  2338	  2340	  2341	  2342	  2343	  2345	  2347	  2360	  2361	  2364	  2365	  2367	  2374
	  2375	  2381	  2382	  2383	  2384	  2385	  2386	  2389	  2390	  2393	  2394	  2399	  2401	  2402
	  2409	  2410	  2413	  2415	  2416	  2417	  2424	  2428	  2429	  2433	  2435	  2436	  2437	  2444
	  2448	  2449	  2452	  2459	  2460	  2463	  2468	  2479	  2480	  2482	  2483	  2485	  2487	  2493
	  2494	  2547	  2548	  2562	  2563	  2583	  2584	  2585	  2588	  2589	  2590	  2608	  2635	  2636
	  2654	  2698	  2700	  2701	  2702	  2710	  2712	  2715	  2718	  2719	  2726	  2727	  2732	  2733
	  2754	  2761	  2762	  2775	  2783	  2802	  2803	  2815	  2816	  2861	  2862	  2915	  2916	  2919
	  2922	  2923	  2925	  2929	  2942	  2943	  2945	  2961	  2965	  2974	  2975	  2982	  2985	  3000
	  3003	  3009	  3010	  3013	  3015	  3017	  3021	  3028	  3031	  3076	  3078	  3079	  3084	  3085
	  3103	  3104	  3105	  3193	  3194	  3198	  3199	  3241	  3287	  3293	  3346	  3347	  3348	  3349
	  3359	  3361	  3362	  3405	  3406	  3436	  3437	  3444	  3445	  3475	  3476	  3477	  3478	  3493
	  3494	  3495	  3496	  3543	  3544	  3564	  3565	  3599	  3608	  3614	  3615	  3618	  3619	  3626
	  3628	  3638	  3639	  3644	  3657	  3658	  3660	  3661	  3662	  3664	  3665	  3674	  3675	  3679
	  3687	  3688	  3703	  3704	  3709	  3718	  3720	  3721	  3723	  3725	  3735	  3736	  3737	  3739
	  3754	  3756	  3757	  3760	  3763	  3771	  3772	  3776	  3777	  3779	  3780	  3788	  3790	  3791
	  3793	  3795	  3797	  3808	  3811	  3812	  3814	  3815	  3817	  3822	  3824	  3826	  3832	  3834
	  3844	  3845	  3846	  3850	  3851	  3858	  3863	  3865	  3866	  3868	  3870	  3872	  3876	  3886
	  3889	  3890	  3892	  3912	  3914	  3915	  3918	  3920	  3923	  3926	  3930	  3933	  3935	  3938
	  3940	  3942	  3951	  3952	  3954	  3958	  3959	  3967	  3968	  3970	  4012	  4016	  4017	  4022
	  4040	  4042	  4044	  4048	  4049	  4051	  4052	  4059	  4060	  4061	  4066	  4067	  4068	  4069
	  4070	  4095	  4096	  4102	  4103	  4127	  4150	  4151	  4154	  4161	  4174	  4175	  4183	  4184
	  4202	  4207	  4208	  4215	  4220	  4222	  4245	  4246	  4273	  4290	  4295	  4298	  4311	  4312
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

	  4313	  4315	  4317	  4318	  4319	  4320	  4326	  4357	  4490	  4495	  4503	  4504	  4508	  4515	  4520
	  4522	  4526	  4527	  4530	  4531	  4570	  4596	  4598	  4599	  4608	  4609	  4610	  4612	  4620
	  4623	  4630	  4631	  4633	  4636	  4670	  4673	  4684	  4703	  4704	  4706	  4712	  4714	  4717
	  4718	  4720	  4731	  4733	  4734	  4735	  4738	  4739	  4740	  4741	  4742	  4743	  4746	  4747
	  4748	  4752	  4753	  4756	  4767	  4769	  4770	  4773	  4774	  4775	  4776	  4778	  4785	  4788
	  4793	  4806	  4808	  4809	  4810	  4811	  4812	  4813	  4814	  4815	  4821	  4822	  4823	  4824
	  4825	  4828	  4829	  4830	  4831	  4832	  4833	  4841	  4846	  4848	  4853	  4854	  4863	  4864
	  4865	  4866	  4867	  4868	  4869	  4870	  4873	  4876	  4878	  4879	  4880	  4883	  4888	  4889
	  4897	  4898	  4918	  4920	  4928	  4929	  4930	  4935	  4936	  4937	  4939	  4955	  4956	  4957
	  4965	  4967	  4976	  4977	  4982	  4983	  4989	  5005	  5013	  5014	  5015	  5016	  5019	  5038
	  5041	  5042	  5043	  5044	  5045	  5070	  5076	  5077	  5083	  5084	  5085	  5106	  5113	  5114
	  5119	  5120	  5121	  5122	  5164	  5170	  5171	  5172	  5174	  5179	  5180	  5181	  5194	  5196
	  5209	  5210	  5216	  5220	  5222	  5223	  5229	  5230	  5237	  5240	  5242	  5281	  5330	  5331
	  5347	  5350	  5353	  5382	  5384	  5385	  5398	  5399	  5435	  5441	  5443	  5444	  5446	  5455
	  5456	  5457	  5480	  5481	  5482	  5484	  5493	  5494	  5495	  5496	  5497	  5498	  5499	  5500
	  5511	  5520	  5521	  5523	  5555	  5556	  5559	  5561	  5562	  5563	  5570	  5571	  5572	  5574
	  5576	  5613	  5614	  5616	  5618	  5619	  5620	  5625	  5626	  5630	  5637	  5639	  5652	  5653
	  5654	  5682	  5684	  5686	  5687	  5699	  5700	  5701	  5711	  5712	  5715	  5716	  5717	  5718
	  5720	  5721	  5724	  5730	  5731	  5735	  5739	  5740	  5743	  5745	  5746	  5747	  5748	  5749
	  5751	  5752	  5754	  5755	  5756	  5757	  5765	  5766	  5769	  5770	  5772	  5773	  5774	  5775
	  5776	  5783	  5784	  5786	  5787	  5788	  5794	  5795	  5803	  5804	  5805	  5806	  5808	  5809
	  5812	  5814	  5815	  5816	  5817	  5827	  5828	  5830	  5831	  5838	  5839	  5840	  5843	  5844
	  5845	  5846	  5847	  5848	  5851	  5852	  5854	  5856	  5857	  5869	  5871	  5873	  5874	  5875
	  5876	  5878	  5879	  5883	  5884	  5885	  5886	  5888	  5890	  5891	  5892	  5893	  5894	  5895
	  5939	  5941	  5943	  5945	  5946	  5948	  5949	  5973	  5974	  5975	  5982	  5984	  5985	  5986
	  5987	  6000	  6001	  6003	  6010	  6011	  6012	  6013	  6014	  6015	  6016	  6018	  6040	  6045
	  6051	  6053	  6054	  6060	  6066	  6071	  6072	  6073	  6075	  6081	  6086	  6087	  6088	  6094
	  6116	  6132	  6167	  6168	  6169	  6170	  6241	  6244	  6245	  6261	  6267	  6269	  6279	  6281
	  6286	  6287	  6294	  6296	  6299	  6301	  6303	  6305	  6306	  6378	  6379	  6382	  6383	  6384
	  6392	  6394	  6395	  6396	  6399	  6440	  6442	  6443	  6467	  6468	  6469	  6470	  6471	  6472
	  6473	  6474	  6475	  6476	  6483	  6484	  6485	  6491	  6492	  6510	  6511	  6516	  6518	  6520
	  6522	  6528	  6529	  6530	  6551	  6552	  6554	  6560	  6599	  6601	  6602	  6609	  6642	  6643
	  6644	  6646	  6647	  6648	  6649	  6650	  6697	  6698	  6699	  6700	  6701	  6702	  6704	  6709
	  6710	  6712	  6713	  6714
T2	    59#	   675	   677	   678	   679	   680	   907	   910	   915	   917	   919	   922	   935	   936
	   938	  1076	  1077	  1117	  1118	  1120	  1121	  1123	  1125	  1126	  1154	  1155	  1221	  1222
	  1223	  1274	  1275	  1276	  1282	  1283	  1284	  1387	  1388	  1389	  1455	  1643	  1644	  1645
	  1646	  1709	  1714	  1717	  1749	  1750	  1751	  1908	  1909	  1914	  1927	  1931	  1933	  1934
	  1937	  1949	  1953	  1956	  2035	  2038	  2041	  2043	  2114	  2115	  2150	  2305	  2310	  2368
	  2369	  2370	  2371	  2376	  2396	  2397	  2399	  2422	  2423	  2424	  2425	  2426	  2427	  2442
	  2443	  2444	  2445	  2446	  2447	  2469	  2470	  2471	  2472	  2475	  2477	  2478	  2481	  2488
	  2489	  2490	  2492	  2493	  2495	  2496	  2586	  2587	  2778	  2779	  2782	  2783	  2785	  2786
	  2920	  3001	  3029	  3242	  3244	  3245	  3246	  3248	  3289	  3290	  3291	  3292	  3472	  3473
	  3474	  3476	  3478	  3492	  3494	  3496	  3627	  3628	  3641	  3643	  3666	  3667	  3668	  3669
	  3670	  3676	  3678	  3712	  3740	  3743	  3746	  3778	  3779	  3809	  3810	  3816	  3817	  3825
	  3827	  3829	  3830	  3859	  3860	  3862	  3877	  3881	  3887	  3888	  3919	  3922	  3932	  3937
	  3946	  3950	  3955	  3956	  3962	  3992	  4024	  4030	  4041	  4043	  4045	  4046	  4049	  4052
	  4053	  4055	  4058	  4060	  4061	  4063	  4089	  4099	  4145	  4163	  4178	  4217	  4233	  4249
	  4277	  4291	  4293	  4297	  4298	  4319	  4327	  4332	  4333	  4334	  4335	  4336	  4337	  4338
	  4339	  4340	  4341	  4342	  4343	  4354	  4355	  4356	  4410	  4414	  4458	  4460	  4462	  4469
	  4470	  4471	  4473	  4475	  4476	  4477	  4479	  4480	  4482	  4483	  4484	  4485	  4487	  4488
	  4489	  4493	  4511	  4512	  4525	  4527	  4529	  4531	  4532	  4533	  4537	  4544	  4545	  4548
	  4559	  4561	  4564	  4566	  4568	  4569	  4572	  4573	  4574	  4583	  4584	  4589	  4596	  4598
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

	  4605	  4606	  4617	  4618	  4619	  4621	  4624	  4629	  4632	  4634	  4637	  4642	  4643	  4645	  4646
	  4647	  4648	  4649	  4651	  4653	  4657	  4658	  4659	  4660	  4663	  4664	  4671	  4760	  4761
	  4765	  4770	  4771	  4777	  4778	  4779	  4782	  4784	  4787	  4843	  4844	  4845	  4847	  4848
	  4849	  4850	  4851	  4861	  4868	  4874	  4875	  4978	  4990	  5002	  5003	  5035	  5036	  5041
	  5044	  5060	  5062	  5063	  5070	  5077	  5083	  5085	  5091	  5095	  5217	  5224	  5225	  5230
	  5232	  5234	  5236	  5240	  5241	  5242	  5243	  5335	  5433	  5435	  5437	  5475	  5476	  5479
	  5481	  5484	  5485	  5486	  5488	  5489	  5490	  5491	  5492	  5557	  5558	  5560	  5564	  5573
	  5575	  5583	  5589	  5591	  5593	  5615	  5712	  5713	  5723	  5735	  5736	  5813	  5815	  5887
	  5940	  5942	  5983	  5988	  6002	  6030	  6031	  6040	  6045	  6047	  6048	  6049	  6050	  6051
	  6060	  6066	  6068	  6069	  6070	  6072	  6074	  6078	  6079	  6082	  6114	  6125	  6246	  6265
	  6268	  6271	  6272	  6274	  6280	  6282	  6284	  6285	  6287	  6288	  6295	  6297	  6298	  6300
	  6302	  6379	  6380	  6381	  6382	  6393	  6396	  6400	  6421	  6423	  6441	  6525	  6603	  6613
T3	    60#	   908	   924	   925	   935	   937	  1456	  1710	  1767	  1774	  1775	  1915	  1919	  1923
	  1939	  1941	  1950	  1951	  2019	  2024	  2025	  2042	  2043	  2046	  2072	  2088	  2470	  2473
	  2474	  2479	  2762	  2763	  2764	  2781	  2782	  2786	  2787	  3243	  3244	  3245	  3296	  3297
	  3314	  3315	  3742	  3745	  3748	  3878	  3882	  4293	  4294	  4295	  4357	  4361	  4414	  4415
	  4429	  4430	  4433	  4436	  4453	  4459	  4461	  4466	  4467	  4481	  4483	  4485	  4524	  4532
	  4533	  4534	  4535	  4536	  4537	  4538	  4539	  4540	  4542	  4547	  4548	  4556	  4557	  4558
	  4560	  4567	  4568	  4569	  4571	  4572	  4573	  4585	  4586	  4587	  4588	  4589	  4590	  4591
	  4592	  4594	  4604	  4606	  4617	  4621	  4625	  4628	  4634	  4637	  4638	  4639	  4640	  4641
	  4643	  4644	  4649	  4650	  4652	  4653	  4654	  4663	  4664	  4666	  4667	  4668	  4669	  4670
	  4671	  4672	  4673	  4755	  4762	  4766	  4784	  4838	  4851	  4852	  4865	  5105	  5218	  5592
	  5972	  5977	  6029	  6033	  6034	  6042	  6043	  6044	  6048	  6054	  6062	  6063	  6064	  6065
	  6069	  6074	  6075	  6076	  6080	  6126	  6242	  6245	  6246	  6247	  6248	  6259	  6273	  6274
	  6283	  6284	  6289	  6290	  6291	  6398	  6400	  6602	  6603	  6606	  6608	  6609	  6610	  6611
	  6613	  6614	  6615	  6617	  6618	  6626	  6627	  6633	  6665	  6666	  6667	  6668	  6669	  6670
T4	    61#	  1457	  1711	  5219	  6240	  6258	  6260	  6264
TAB	   220#	  3085	  3086	  3445	  3446	  3565	  3566	  7132	  7133	  7134	  7144	  7145
TAB1	  2782	  2786	  2837	  4985	  6611	  6618	  6626	  6989#
TAB2	  2785	  3389	  3467	  3480	  3498	  3595	  5022	  5050	  5546	  5550	  6615	  6621	  6624	  6990#
TABDEV	  2203	  2206	  2219#
TABFIL	  2205	  2208	  2211	  2212	  2213	  2223#
TABLST	   557#	  1211	  1215	  1296	  1300	  1306	  1310	  1342	  1346	  1352	  1356	  5405
TABPTR	   556#	  1949	  2063	  5433
TABRUN	  2204	  2210	  2222#
TAINP	  4921#	  4943
TBLKN	   625#	  1482	  4835
TBSIZE	   567#	  2754	  2761	  2764	  2781
TCH	   545#	  4691	  4696	  4772
TELWRD	   513#	  1577	  1757	  1762	  2602	  2649
TEMP	   546#	  6319	  6327	  6351	  6364
TEMP1	   547#	   765	   771	  3956	  3962	  3992	  4030	  4089
TERM	   180#	  3684	  3686	  3899	  3934	  3939	  3957	  3996	  4021	  4034	  4108	  4173	  4214	  4256
	  4280	  4722	  4912
TG0	  6618#	  6627
TG1	  6620#	  6626
TG2	  6620	  6624#
TG3	  6623	  6626#
THEDIG	  5600#	  6142
THREE	   141#	   675	  1654	  1833	  1848	  3651	  3652	  5748	  5926
TIBCNT	   528#	  2580	  2745	  2812	  2819	  2831	  2894	  2912	  3230	  3265	  4916	  6156
TIME	   597#	  5496
TIRCNT	   527#	  2579	  2744	  2797	  2830	  2893	  3231	  3264	  4917	  6159
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

TMPLEN	   456	  6512	  6536
TMPLST	  6512	  6536#
TOBCNT	   526#	  2743	  2853	  3236	  3258	  3307	  4805	  6171
TOBIN	  3741	  3744	  3747	  6024#
TOOCT	  6027#	  6041	  6046	  6052	  6061	  6067
TOOCT0	  6032#	  6036
TOOCT1	  6026	  6029#
TOODEP	  1621	  5387#
TORCNT	   525#	  2742	  2848	  3235	  3259	  3306	  4811	  6174
TRAP	  6404#	  6473
TRK7	   201#	  3862	  3954
TRPBLK	   617#	  6471	  6474	  6476
TRPCHK	  6416	  6440#
TRPCHN	   619#	  6406	  6478
TRPPC	   618#	  6404	  6477
TRPSET	   748	  4926	  6407	  6467#
TRYNXT	  2041	  2047	  2051#
TST1	  2372	  2373#
TSTCOM	  2352	  2356	  2360#
TSTDEV	  5719	  5723#
TSTNAM	  3647	  6218#
TSTOUT	  2333	  2353#
TTY	   167#	   170	  2606	  2607	  2631	  2632	  2652	  2653	  2971	  2972	  3277	  3278	  3280	  3281
	  6444	  6445	  6541	  6542
TWO	   141#	   486	   510	   555	   579	   604	   611	   613	   617	   758	  1500	  1654	  3562	  3650
	  3651	  4045	  4460	  4492	  4493	  4512	  4584	  4938	  4983	  5121	  5661	  5662	  5924	  5929
	  6106	  6991	  7006	  7013
TWODIG	  5605#	  5989	  5993	  5996	  6004	  6007
TYMREL	   644#	   652
TYMSPC	   643#	   652
TYPDAT	   708	   851	  5982#
TYPE	   926	  5127	  5145#
TYPE0	  5147#	  5914
TYPEIT	  5140	  5146#	  5163	  6497
TYPNAM	  1516	  2615	  2661	  5147	  5170#	  6572	  6576
TYPNM0	  5177#
TYPTIM	   705	   848	  6000#	  6133
UF	   454#	   733	  5763	  5810	  5827	  5856	  5927
UFDARG	   585#	  5814	  5816	  5817	  5828	  5830
UFDBUF	   585	  5919#	  5920
UFDCNT	   587#	  5818	  5824
UFDCTL	  5920#
UFDDEV	  5756	  5763	  5838	  5906	  5928#	  6423
UFDERR	  5811	  5906#
UFDGET	  5825	  5832#
UFDNAM	  5803	  5806	  5807	  5809	  5810	  5851	  5930#
UFDPTR	   588#	  5831	  5832	  5834	  5835
UFDSET	  5830#	  5862
UFDWDS	  5819	  5824#
ULTRAT	   560#	   987	  1289	  1291	  3065
UME0	   686	  5518#
UME1	  5522	  5529#	  5533
UME2	  5524	  5537#
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

UME3	  5538#	  5542
UME4	  4309	  4383	  4394	  4397	  4435	  5532	  5540	  5546#	  5587	  5597
UNAME	   555#	  1709	  1714	  2072	  2073	  2074	  4291	  5194	  5196	  5204	  5205	  5210	  5211	  5241
	  5243
UNICOM	   768	  2012	  2033#
UNIMAT	  1488	  1725	  1748	  1786	  1832	  1847	  1864	  1876	  1906	  2032#	  6550
UNLOAD	   147#	  1396	  2679	  2684	  6803
UPD1	  2861#	  2867
UPD2	  2863	  2868#
UPDA	  2845	  2851#
UPDAT	  2844#	  3160	  3213	  3414	  3507	  3631
UPDATE	  2847#	  3154	  3197	  3206	  3399	  3484	  3602
UPDB	  2855#
USEALL	  5735	  5739#
USEDEV	  5725	  5755#
VEBMOD	   948	  2369	  2475	  4042	  4610	  7131	  7144#
VERSIO	   449#
VOL	   132#	   742	   743	   879	   880	  3649	  3698	  3928	  4007	  4122	  4199	  4268	  4918	  4920
	  5353
WARN	  5139#	  5384
WBEDSK	   901	   944#
WD	    66#	   764	   765	   771	  1665	  1666	  1672	  1677	  1678	  1683	  1684	  2008	  2019	  2020
	  2034	  2044	  2046	  2055	  6686	  6689
WDEV	   152#	   157	  1660	  1664	  5173	  5734
WDMTA0	  5680	  5691#
WEXT	   154#	   157	  1449	  1673	  1681	  2299	  2539	  2540	  2641	  2708	  2711	  3699	  3711	  4907
	  5185	  5343	  5346	  5691	  5697	  5707	  6168	  6170	  6221	  6227	  6234
WF	   454#	  6253	  6261
WILD	   157#	  1370	  2294	  2296	  2604	  2614	  2640	  2660	  2677	  2713	  2714	  2990	  5134	  5137
	  5159	  5667	  5668	  5820	  6489	  6495	  6498
WLD3	  6243	  6267#	  6270
WLDDEV	  5659#	  5666	  5675	  6487
WLDDSK	  5667	  5711#
WLDEXT	   576#	   671	  4909	  6241
WLDISK	   577#	   672	  6251	  6257
WLDMTA	  5667	  5676	  5679#	  5704	  5705
WNAME	   153#	   157	  1449	  1673	  1675	  2299	  2539	  2540	  2641	  2708	  2711	  3699	  3708	  4907
	  5183	  5343	  5346	  5691	  5697	  5707	  6168	  6170	  6218	  6225	  6232
WP	   155#	   157	  1694	  5189	  5758	  5771	  5792
WPN	   156#	   157	  1694	  5189	  5758	  5771	  5792
WRILAB	  3993	  4031	  4148	  4279	  5032#
WRITE	  4796	  4799#
WRITE0	  5048#	  5052
XBDMOD	  3822	  4145	  7131	  7141#
XBUF	    88#	  1962	  2007	  2008	  2236	  2237
XFLST	  1989#	  6907
XLST	  1991#	  6905
XNAME	  4301	  4325#
XNLST	  1997#	  6906
XNTELL	  1762#	  6909
XPNT88	  1567	  1575#
XPNT99	  1559	  1562#
XPRINT	  1503#	  6779
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

XPRNT0	  1508	  1515#
XPRNT1	  1518	  1521#
XPRNT2	  1522	  1524	  1527#
XPRNT3	  1537	  1538#
XPRNT4	  1539	  1544#
XPRNT5	  1545	  1549#
XPRNT6	  1576	  1588	  1596#
XPRNT7	  1599	  1602#
XPRNT8	  1528	  1531#
XPRNT9	  1532	  1535#
XPRNTA	  1555	  1558#
XPRNTB	  1586	  1589#
XPRNTC	  1591#	  1595
XPRNTD	  1550	  1554#
XPRNTZ	  1580	  1585#
XPUT	  4416	  4429#
XPUT1	  4432#	  4437
XSPACE	  4401#	  4413	  4418
XTELL	  1757#	  6908
XYNRET	  1490	  1492	  1493#	  7030
YESCNT	  1486	  7026#
YESDIS	  1487	  7028#
YESNO	   930	  1044	  1220	  1266	  1273	  1281	  1290	  1373	  1379	  1386	  1395	  1402	  1411	  1417
	  1485#	  2556	  2693	  2756	  2879	  6663
YESRET	  1489#	  7028
YESTAB	  1486	  7024#	  7026
YY	  1654#	  1654
ZERO	   141#	   599	   713	   714	   730	   731	   732	   733	   734	   799	   800	   802	   806	  1045
	  1217	  1225	  1236	  1246	  1254	  1270	  1278	  1286	  1292	  1302	  1312	  1322	  1330	  1338
	  1348	  1376	  1383	  1391	  1398	  1404	  1407	  1413	  1421	  1447	  1460	  1483	  1490	  1647
	  1654	  1685	  1687	  1690	  1718	  1732	  1738	  1753	  1758	  1763	  1789	  1796	  1803	  1810
	  1817	  1824	  1839	  1852	  1867	  1878	  1887	  1892	  1899	  1935	  1940	  1953	  1965	  1977
	  1993	  1999	  2042	  2044	  2056	  2057	  2058	  2059	  2065	  2066	  2086	  2121	  2125	  2128
	  2130	  2138	  2142	  2144	  2173	  2187	  2207	  2209	  2215	  2219	  2497	  2632	  2633	  2634
	  2690	  2691	  2715	  2717	  2722	  2751	  2759	  2789	  2806	  2810	  2827	  2832	  2846	  2850
	  2857	  2859	  2869	  2876	  2877	  2898	  2996	  3000	  3001	  3005	  3024	  3028	  3029	  3037
	  3099	  3119	  3122	  3238	  3261	  3283	  3326	  3329	  3377	  3384	  3407	  3456	  3476	  3478
	  3494	  3558	  3561	  3583	  3590	  3617	  3620	  3637	  3638	  3644	  3645	  3673	  3674	  3679
	  3691	  3728	  3758	  3787	  3800	  3837	  3857	  3875	  4149	  4154	  4155	  4281	  4282	  4320
	  4374	  4380	  4386	  4406	  4425	  4457	  4462	  4470	  4471	  4475	  4490	  4494	  4504	  4509
	  4510	  4511	  4513	  4515	  4516	  4523	  4527	  4531	  4546	  4552	  4561	  4566	  4573	  4575
	  4577	  4589	  4596	  4598	  4600	  4607	  4616	  4632	  4656	  4662	  4671	  4673	  4674	  4680
	  4694	  4702	  4716	  4723	  4728	  4751	  4798	  4820	  4827	  4836	  4855	  4860	  4881	  4885
	  4894	  4895	  4925	  4957	  4962	  4963	  4967	  4969	  4975	  5001	  5012	  5026	  5033	  5088
	  5115	  5153	  5199	  5207	  5215	  5221	  5228	  5231	  5244	  5291	  5347	  5379	  5385	  5386
	  5403	  5404	  5423	  5427	  5435	  5438	  5460	  5461	  5468	  5469	  5481	  5506	  5507	  5510
	  5542	  5562	  5586	  5592	  5595	  5615	  5618	  5621	  5655	  5676	  5692	  5729	  5737	  5741
	  5750	  5753	  5959	  5968	  5979	  5986	  6033	  6036	  6055	  6078	  6083	  6114	  6127	  6214
	  6215	  6220	  6224	  6250	  6266	  6268	  6271	  6275	  6290	  6292	  6302	  6305	  6308	  6335
	  6339	  6340	  6341	  6342	  6345	  6347	  6349	  6365	  6366	  6367	  6374	  6385	  6392	  6393
	  6398	  6401	  6413	  6424	  6425	  6447	  6479	  6499	  6509	  6510	  6514	  6542	  6543	  6555
	  6556	  6578	  6593	  6607	  6610	  6614	  6628	  6636	  6664	  6674	  6676	  6678	  6727	  6765
	  6766	  6767	  6768	  6769	  6770	  6771	  6772	  6773	  6774	  6775	  6776	  6777	  6778	  6779
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

	  6780	  6781	  6798	  6799	  6801	  6802	  6803	  6804	  6805	  6806	  6807	  6819	  6820	  6873	  6874
	  6875	  6876	  6877	  6878	  6879	  6880	  6881	  6882	  6883	  6884	  6885	  6886	  6887	  6888
	  6889	  6890	  6891	  6892	  6893	  6894	  6895	  6896	  6897	  6898	  6899	  6900	  6901	  6902
	  6903	  6904	  6905	  6906	  6907	  6908	  6909	  6910	  6911	  6912	  6913	  6914	  6915	  6916
	  6923	  6924	  6926	  6927	  6929	  6930	  6931	  6932	  6938	  6939	  6940	  6947	  6948	  6956
	  6957	  6967	  6968	  6980	  6981	  6982	  6983	  6984	  6985	  6986	  7001	  7008	  7015	  7028
	  7029	  7030	  7132	  7133	  7134	  7135	  7136	  7137	  7138	  7139	  7140	  7141	  7142	  7143
	  7144	  7145
ZPUT	  5584	  5589#
ZZ	   461#	   461	   655#	   655	  1652#	  1652	  1654#	  1654	  1656#	  1656	  2217#	  2217	  2227#	  2227
	  4443#	  4443	  4448#	  4448	  5246#	  5246	  5252#	  5252	  5916#	  5916	  5935#	  5935	  6534#	  6534
	  6538#	  6538	  6722#	  6722	  6730#	  6730	  6987#	  6987	  7018#	  7018
%IO	   536#	  2165	  2749	  4702	  4820	  5012	  5506	  5782	  5826	  6144	  6636	  6708
%TIME	   537#	  2365	  6137
.ALST	   279#	  5740
.ASC	   280#	  2935	  2938	  2953	  2981	  2984	  2987	  3012	  3020	  3023	  3278	  3298	  3308	  4331
	  4344	  4346	  4379	  4385	  4412	  4419	  4421	  4424	  5201	  5206	  5521	  5590
.BSF	   266#	  2509	  2514	  2525	  2530
.BSR	   263#	  3694	  3965	  4181	  4718	  6108
.CH	   245#	   706	   717	   843	   846	   849	   853	  1593	  1602	  2160	  2162	  2607	  2653	  5176
	  5191	  5198	  5400	  5601	  5606	  5620	  5628	  5640	  5643	  5647	  5976	  5978	  5990	  5994
	  6005	  6140	  6592
.CLR	   254#	   806	  5510	  6214	  6555
.CORE	   250#	   739	  2702	  4501	  4542	  4594	  6704
.DATE	   252#	   707	   850	  3703	  3926	  4012	  4016	  4127	  4202	  4207	  4273	  5493	  5555
.DCHR	   276#	  5713
.DEV	   246#	   834	   902	   970	   985	  1027	  1071	  1628	  2240	  2246	  5180
.ENB	   269#	  6470	  6529
.GLST	   278#	  5749
.IND	   267#	  3672	  4959
.IOSTP	   284#	  6102
.JBINT	   450#	   798	  6472
.JBTPC	    51%	  6513	  6525
.JLST	   277#	  5736
.LN	   248#	  1462	  2099	  2106
.LTP	   282#	  5456
.NAM	   256#	  2394	  2397	  3905	  5084	  5171
.NODEL	   272#	  5449
.PATH	   285#	  5718
.PJOB	   274#	   676	  4332	  4338
.PPN	   273#	  3915	  4287	  5766	  6016
.RESET	   253#	   681	   788
.REW	   261#	   838	  2431	  2451	  2682	  2687	  4932
.RUN	   268#	   809	  2214
.SIX	   281#	  2937	  2939	  4337	  4343	  5204	  5205	  5523
.SIZ	   283#	  4586
.SKF	   265#	  2510	  2526	  4717
.SKP	   257#	   713	   799	  2633	  2690	  2876	  3637	  3673	  4894	  5403	  5460	  5468	  6424	  6509
	  6542
.SKR	   262#	  2517	  2533
.SLP	   258#	  6443
.STR	   247#	   697	   700	   703	   715	   757	   801	   827	   884	   890	   927	   929	  1037	  1040
	  1042	  1043	  1047	  1212	  1219	  1232	  1240	  1250	  1265	  1272	  1280	  1288	  1297	  1307
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Symbol cross reference

	  1316	  1326	  1334	  1343	  1353	  1363	  1372	  1378	  1385	  1394	  1400	  1409	  1415	  1428	  1470
	  1477	  1497	  1506	  1509	  1519	  1525	  1529	  1533	  1537	  1541	  1546	  1551	  1556	  1560
	  1567	  1578	  1581	  1583	  1589	  1946	  2554	  2610	  2619	  2624	  2627	  2637	  2656	  2665
	  2670	  2673	  2692	  2720	  2755	  2765	  2774	  2878	  3689	  4152	  4899	  4923	  5064	  5066
	  5072	  5079	  5082	  5087	  5099	  5101	  5104	  5126	  5139	  5146	  5148	  5153	  5280	  5337
	  5349	  5352	  5358	  5362	  5402	  5404	  5425	  5432	  5453	  5461	  5474	  5651	  5798	  5860
	  5912	  6143	  6146	  6150	  6158	  6161	  6173	  6176	  6184	  6190	  6199	  6207	  6212	  6426
	  6429	  6432	  6435	  6438	  6452	  6517	  6519	  6521	  6524	  6571	  6575	  6584	  6590	  6661
	  6714
.STS	   270#	  3860	  3952
.TAB	   275#	   678	  4335	  4341	  5482
.TAPE	   271#	  4067
.TERM	   249#	   789	  6585
.TIM	   255#	  2364	  6136
.TIME	   251#	   704	   847	  4311	  5495	  5570	  6132
.UNL	   264#	  2680	  2685	  4922
.WAIT	   259#	  6442
.WAT	   260#	  2501	  2512	  2519	  2528	  3695	  3966	  4182	  4721	  4931	  4933	  6109
.XX.	  7128	  7132#	  7132	  7137#	  7137	  7139#	  7139	  7140#	  7140	  7141#	  7141	  7142#	  7142	  7143#
	  7143	  7144#	  7144
.YY.	  7128	  7132#	  7132	  7133	  7134	  7135	  7136	  7137#	  7137	  7138	  7139#	  7139	  7140#	  7140
	  7141#	  7141	  7142#	  7142	  7143#	  7143	  7144#	  7144	  7145
.ZZ.	  7128#	  7132	  7132#	  7137	  7137#	  7139	  7139#	  7140	  7140#	  7141	  7141#	  7142	  7142#	  7143
	  7143#	  7144	  7144#
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Macro/Opdef cross reference

BRANCH	   378#	  4910	  4946	  5666	  5675	  5681	  6487
BSS	   403#	   465	   466	   467	   468	   469	   470	   471	   472	   473	   474	   475	   476	   477
	   478	   479	   480	   481	   482	   483	   484	   485	   486	   487	   488	   489	   490	   491
	   492	   493	   494	   495	   496	   497	   498	   499	   500	   501	   502	   503	   504	   505
	   506	   507	   508	   509	   510	   511	   512	   513	   514	   515	   518	   519	   520	   521
	   522	   523	   524	   525	   526	   527	   528	   529	   530	   531	   532	   533	   534	   535
	   536	   537	   538	   539	   540	   541	   542	   543	   544	   545	   546	   547	   548	   549
	   550	   551	   552	   553	   554	   555	   556	   557	   558	   559	   560	   561	   562	   563
	   564	   565	   566	   567	   568	   569	   570	   571	   572	   573	   574	   575	   576	   577
	   578	   579	   581	   586	   587	   588	   592	   593	   594	   595	   596	   597	   598	   600
	   601	   602	   603	   604	   605	   606	   607	   608	   609	   610	   611	   612	   613	   614
	   615	   616	   617	   618	   619	   620	   621	   622	   623	   624	   625	   626	   627	   628
	   629	   630	   631	   632	   633	   634	  1654	  2221	  2225	  4445	  4446	  5250	  5918	  5919
	  5921	  5924	  5925	  5926	  5929	  5930	  5931	  5933	  6536	  6720	  6726	  6728	  6989	  6990
	  6991	  6992	  6993	  6994	  6995	  6996	  6998	  6999	  7003	  7006	  7010	  7013	  7016	  7022
CBLK	   421#	  1654
DEVOP	   441#	  4701	  4819	  5011	  5505	  6635	  6707
DEVSTS	  4739
DIARET	   413#	   896	   944	   953	   961	   963	   967	   975	   981	   988	   990	   997	   999	  1006
	  1008	  1016	  1020	  1023	  1035	  1046	  1063	  1075	  1084	  1088	  1094	  1101	  1105	  1111
	  1129	  1136	  1146	  1149	  1163	  2726	  2732
DRIVE	   293#	   838	  2431	  2451	  2501	  2509	  2510	  2512	  2514	  2517	  2519	  2525	  2526	  2528
	  2530	  2533	  2680	  2682	  2685	  2687	  3669	  3672	  3694	  3695	  3965	  3966	  4181	  4182
	  4717	  4718	  4721	  4922	  4931	  4932	  4933	  4959	  6108	  6109
EME	   290#	   697	   700	   703	   706	   713	   715	   717	   757	   799	   801	   806	   827	   843
	   846	   849	   853	   884	   890	   927	   929	  1037	  1040	  1042	  1043	  1047	  1212	  1219
	  1232	  1240	  1250	  1265	  1272	  1280	  1288	  1297	  1307	  1316	  1326	  1334	  1343	  1353
	  1363	  1372	  1378	  1385	  1394	  1400	  1409	  1415	  1428	  1462	  1470	  1477	  1497	  1506
	  1509	  1519	  1525	  1529	  1533	  1537	  1541	  1546	  1551	  1556	  1560	  1567	  1578	  1581
	  1583	  1589	  1593	  1602	  1946	  2099	  2106	  2160	  2162	  2554	  2607	  2610	  2619	  2624
	  2627	  2633	  2637	  2653	  2656	  2665	  2670	  2673	  2690	  2692	  2720	  2755	  2765	  2767
	  2774	  2775	  2778	  2876	  2878	  3637	  3673	  3689	  4152	  4894	  4899	  4923	  5064	  5066
	  5072	  5079	  5082	  5087	  5099	  5101	  5104	  5126	  5139	  5146	  5148	  5153	  5176	  5191
	  5198	  5280	  5337	  5349	  5352	  5358	  5362	  5400	  5402	  5403	  5404	  5425	  5432	  5453
	  5456	  5460	  5461	  5468	  5474	  5510	  5601	  5606	  5620	  5628	  5640	  5643	  5647	  5651
	  5798	  5860	  5912	  5976	  5978	  5990	  5994	  6005	  6140	  6143	  6146	  6150	  6158	  6161
	  6173	  6176	  6184	  6190	  6199	  6207	  6212	  6214	  6424	  6426	  6429	  6432	  6435	  6438
	  6452	  6509	  6517	  6519	  6521	  6524	  6542	  6555	  6571	  6575	  6584	  6590	  6592	  6661
	  6714
ENABLE	   407#	   713	   799	  2633	  2690	  2876	  3637	  3673	  4894	  5403	  5460	  5468	  6424	  6509
EQUATE	   419#	  3095	  3162	  3163	  3164	  3165	  3166	  3167	  3269	  3270	  3332	  3451	  3509	  3510
	  3511	  3512	  3513	  3514
EXIT	   670
FTABLE	   323#	  7128	  7132	  7133	  7134	  7135	  7136	  7137	  7138	  7139	  7140	  7141	  7142	  7143
	  7144	  7145
GETTAB	   664	  5874
GOSUB	   294#	   686	   696	   699	   702	   705	   708	   709	   748	   762	   772	   774	   776	   778
	   780	   800	   807	   828	   830	   845	   848	   851	   852	   886	   892	   898	   926	   930
	   945	   946	   954	   956	   957	   962	   966	   974	   976	   977	   982	   989	   994	   996
	   998	  1005	  1007	  1009	  1010	  1011	  1015	  1017	  1021	  1034	  1036	  1044	  1052	  1064
	  1078	  1085	  1092	  1098	  1103	  1106	  1112	  1131	  1143	  1147	  1152	  1165	  1214	  1220
	  1234	  1242	  1252	  1266	  1273	  1281	  1290	  1299	  1309	  1318	  1328	  1336	  1345	  1355
	  1365	  1373	  1379	  1386	  1395	  1402	  1405	  1411	  1417	  1429	  1433	  1438	  1439	  1443
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Macro/Opdef cross reference

	  1472	  1479	  1494	  1505	  1508	  1516	  1520	  1526	  1530	  1534	  1543	  1548	  1553	  1557	  1561
	  1574	  1599	  1611	  1615	  1662	  1676	  1680	  1682	  1696	  1697	  1703	  1721	  1771	  1794
	  1801	  1808	  1815	  1822	  1885	  1916	  1920	  1924	  1954	  1955	  1958	  1963	  1971	  2004
	  2021	  2032	  2075	  2098	  2182	  2199	  2201	  2232	  2303	  2308	  2379	  2380	  2411	  2421
	  2441	  2454	  2461	  2465	  2536	  2543	  2544	  2546	  2549	  2556	  2559	  2568	  2570	  2575
	  2592	  2595	  2609	  2615	  2623	  2626	  2644	  2645	  2647	  2655	  2661	  2669	  2672	  2689
	  2691	  2693	  2704	  2706	  2730	  2736	  2756	  2805	  2809	  2852	  2854	  2860	  2866	  2874
	  2875	  2877	  2879	  2882	  2883	  2886	  2895	  2908	  2913	  2921	  2926	  2928	  2930	  2933
	  2941	  2950	  2960	  2962	  2964	  2966	  2968	  2969	  2970	  2972	  2976	  2978	  2983	  2986
	  2988	  2989	  2993	  2994	  3004	  3011	  3016	  3018	  3019	  3022	  3034	  3036	  3048	  3057
	  3067	  3073	  3075	  3082	  3087	  3092	  3113	  3136	  3140	  3146	  3148	  3151	  3154	  3175
	  3181	  3187	  3191	  3197	  3203	  3205	  3206	  3223	  3225	  3250	  3252	  3260	  3266	  3301
	  3309	  3313	  3316	  3318	  3328	  3343	  3352	  3354	  3356	  3358	  3365	  3369	  3388	  3391
	  3399	  3404	  3426	  3430	  3433	  3435	  3440	  3447	  3466	  3468	  3484	  3520	  3524	  3531
	  3535	  3540	  3542	  3547	  3551	  3554	  3556	  3557	  3559	  3567	  3572	  3594	  3597	  3600
	  3602	  3609	  3644	  3647	  3685	  3707	  3719	  3738	  3741	  3744	  3747	  3755	  3762	  3781
	  3786	  3789	  3805	  3818	  3823	  3852	  3856	  3864	  3880	  3883	  3893	  3917	  3921	  3925
	  3927	  3931	  3936	  3941	  3945	  3963	  3975	  3979	  3982	  3986	  3989	  3991	  3993	  4001
	  4004	  4006	  4009	  4011	  4013	  4018	  4023	  4027	  4029	  4031	  4039	  4054	  4057	  4062
	  4065	  4077	  4080	  4082	  4088	  4097	  4101	  4111	  4114	  4119	  4121	  4124	  4128	  4131
	  4134	  4141	  4144	  4148	  4160	  4162	  4165	  4168	  4179	  4189	  4193	  4196	  4201	  4203
	  4206	  4209	  4216	  4219	  4221	  4224	  4229	  4232	  4237	  4247	  4251	  4262	  4265	  4267
	  4270	  4272	  4274	  4276	  4279	  4289	  4300	  4309	  4310	  4321	  4325	  4328	  4329	  4330
	  4345	  4347	  4349	  4377	  4378	  4383	  4390	  4391	  4394	  4404	  4411	  4413	  4416	  4418
	  4420	  4435	  4626	  4627	  4677	  4689	  4693	  4750	  4786	  4794	  4799	  4856	  4877	  4903
	  4904	  4910	  4913	  4919	  4926	  4941	  4944	  4946	  4961	  4979	  5006	  5039	  5051	  5053
	  5065	  5071	  5078	  5086	  5092	  5096	  5127	  5140	  5147	  5163	  5175	  5187	  5193	  5195
	  5197	  5203	  5282	  5336	  5340	  5348	  5351	  5354	  5357	  5361	  5365	  5373	  5374	  5394
	  5406	  5407	  5430	  5431	  5434	  5436	  5451	  5518	  5525	  5532	  5540	  5584	  5587	  5594
	  5617	  5638	  5646	  5650	  5665	  5666	  5674	  5675	  5679	  5681	  5688	  5704	  5836	  5849
	  5901	  5907	  5944	  5947	  5989	  5993	  6004	  6024	  6027	  6041	  6046	  6052	  6061	  6067
	  6089	  6131	  6133	  6134	  6139	  6142	  6145	  6149	  6157	  6160	  6172	  6175	  6183	  6189
	  6198	  6206	  6211	  6243	  6270	  6293	  6304	  6327	  6364	  6397	  6405	  6407	  6425	  6427
	  6445	  6486	  6487	  6493	  6497	  6544	  6566	  6568	  6572	  6573	  6576	  6577	  6583	  6600
	  6612	  6616	  6651	  6659	  6663	  6672	  6688	  6691	  6706
GOTO	   291#	   667	   693	   710	   720	   755	   764	   768	   770	   776	   782	   783	   784	   785
	   790	   795	   802	   810	   815	   820	   830	   832	   836	   837	   840	   855	   858	   861
	   863	   864	   866	   869	   895	   900	   905	   910	   912	   918	   921	   923	   931	   932
	   944	   950	   952	   960	   972	   980	   983	   987	   993	  1002	  1019	  1022	  1029	  1031
	  1056	  1058	  1060	  1067	  1068	  1072	  1075	  1081	  1082	  1084	  1086	  1088	  1091	  1093
	  1097	  1099	  1101	  1104	  1107	  1110	  1113	  1116	  1119	  1122	  1124	  1127	  1129	  1132
	  1134	  1136	  1141	  1144	  1146	  1148	  1151	  1153	  1156	  1159	  1162	  1166	  1217	  1229
	  1236	  1246	  1254	  1302	  1312	  1320	  1330	  1338	  1348	  1358	  1360	  1367	  1371	  1431
	  1435	  1437	  1441	  1442	  1450	  1453	  1459	  1464	  1465	  1488	  1490	  1492	  1496	  1500
	  1504	  1518	  1522	  1528	  1532	  1537	  1545	  1550	  1555	  1559	  1567	  1576	  1580	  1586
	  1588	  1595	  1601	  1604	  1613	  1621	  1633	  1634	  1637	  1642	  1647	  1667	  1699	  1700
	  1701	  1707	  1715	  1725	  1745	  1746	  1748	  1767	  1773	  1776	  1782	  1783	  1786	  1794
	  1801	  1808	  1815	  1822	  1829	  1832	  1834	  1844	  1847	  1849	  1858	  1859	  1860	  1864
	  1872	  1873	  1876	  1885	  1906	  1910	  1917	  1921	  1925	  1930	  1944	  1959	  1963	  1970
	  1976	  2006	  2008	  2012	  2015	  2023	  2026	  2039	  2045	  2047	  2065	  2066	  2069	  2079
	  2083	  2089	  2096	  2101	  2103	  2108	  2111	  2112	  2121	  2132	  2134	  2136	  2141	  2146
	  2152	  2155	  2159	  2163	  2167	  2176	  2184	  2190	  2202	  2236	  2237	  2238	  2264	  2265
	  2266	  2271	  2282	  2283	  2284	  2293	  2302	  2307	  2318	  2320	  2321	  2331	  2333	  2337
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Macro/Opdef cross reference

	  2352	  2356	  2359	  2362	  2378	  2387	  2388	  2391	  2392	  2395	  2398	  2400	  2403	  2413	  2414
	  2418	  2419	  2433	  2434	  2438	  2439	  2463	  2466	  2479	  2501	  2515	  2519	  2531	  2537
	  2539	  2540	  2541	  2551	  2553	  2557	  2558	  2565	  2574	  2576	  2582	  2594	  2603	  2605
	  2621	  2641	  2642	  2650	  2667	  2678	  2679	  2684	  2695	  2697	  2705	  2707	  2709	  2715
	  2757	  2769	  2771	  2773	  2777	  2780	  2784	  2788	  2798	  2801	  2802	  2804	  2807	  2813
	  2815	  2817	  2820	  2840	  2845	  2863	  2867	  2881	  2888	  2907	  2909	  2914	  2917	  2918
	  2924	  2934	  2936	  2944	  2952	  2955	  2957	  2974	  2976	  2977	  2980	  2992	  2995	  3007
	  3035	  3039	  3049	  3054	  3056	  3061	  3063	  3064	  3066	  3068	  3074	  3080	  3083	  3086
	  3089	  3093	  3112	  3116	  3125	  3127	  3129	  3132	  3139	  3144	  3155	  3160	  3170	  3172
	  3176	  3178	  3183	  3185	  3190	  3197	  3201	  3207	  3213	  3221	  3224	  3227	  3232	  3254
	  3267	  3288	  3291	  3293	  3294	  3295	  3303	  3310	  3321	  3327	  3340	  3342	  3344	  3353
	  3355	  3357	  3363	  3366	  3397	  3398	  3400	  3412	  3414	  3427	  3429	  3432	  3434	  3438
	  3441	  3443	  3446	  3449	  3462	  3472	  3474	  3479	  3482	  3485	  3497	  3500	  3506	  3507
	  3532	  3534	  3537	  3541	  3545	  3549	  3550	  3563	  3566	  3569	  3603	  3611	  3625	  3631
	  3647	  3648	  3650	  3651	  3657	  3659	  3662	  3679	  3700	  3706	  3709	  3712	  3714	  3749
	  3775	  3782	  3792	  3819	  3828	  3839	  3853	  3867	  3894	  3913	  3947	  3958	  3960	  3961
	  3964	  3969	  3971	  4022	  4090	  4104	  4109	  4136	  4169	  4174	  4176	  4177	  4180	  4185
	  4215	  4234	  4238	  4252	  4286	  4301	  4306	  4314	  4316	  4351	  4397	  4417	  4439	  4455
	  4464	  4465	  4468	  4479	  4486	  4498	  4500	  4502	  4521	  4541	  4543	  4558	  4563	  4593
	  4595	  4615	  4622	  4635	  4659	  4660	  4661	  4662	  4679	  4684	  4685	  4687	  4692	  4695
	  4697	  4702	  4705	  4706	  4707	  4708	  4710	  4711	  4713	  4715	  4736	  4745	  4749	  4754
	  4757	  4759	  4764	  4780	  4789	  4796	  4800	  4802	  4803	  4816	  4820	  4824	  4825	  4826
	  4827	  4837	  4840	  4842	  4871	  4891	  4897	  4902	  4905	  4911	  4912	  4945	  4947	  4948
	  4950	  4991	  5012	  5015	  5016	  5017	  5019	  5020	  5027	  5057	  5061	  5067	  5073	  5080
	  5093	  5097	  5100	  5102	  5109	  5129	  5135	  5141	  5154	  5160	  5167	  5233	  5235	  5237
	  5238	  5283	  5286	  5288	  5290	  5295	  5298	  5301	  5303	  5306	  5309	  5312	  5315	  5317
	  5319	  5322	  5325	  5329	  5333	  5338	  5342	  5344	  5345	  5347	  5355	  5367	  5376	  5396
	  5401	  5409	  5419	  5421	  5423	  5424	  5442	  5458	  5459	  5463	  5487	  5502	  5504	  5512
	  5513	  5522	  5524	  5533	  5542	  5552	  5566	  5588	  5597	  5631	  5636	  5642	  5660	  5661
	  5667	  5669	  5676	  5680	  5682	  5684	  5685	  5689	  5694	  5695	  5698	  5702	  5704	  5705
	  5708	  5714	  5719	  5722	  5724	  5725	  5733	  5735	  5738	  5742	  5759	  5760	  5764	  5772
	  5779	  5785	  5791	  5793	  5796	  5797	  5811	  5819	  5821	  5825	  5829	  5842	  5853	  5855
	  5858	  5859	  5862	  5867	  5872	  5877	  5880	  5882	  5896	  5902	  5908	  5914	  5950	  5979
	  5996	  6007	  6019	  6026	  6036	  6077	  6087	  6088	  6089	  6098	  6101	  6105	  6110	  6119
	  6121	  6124	  6169	  6171	  6197	  6205	  6210	  6219	  6222	  6231	  6236	  6252	  6256	  6263
	  6346	  6348	  6357	  6372	  6411	  6412	  6416	  6418	  6454	  6484	  6485	  6488	  6499	  6523
	  6531	  6532	  6550	  6561	  6562	  6579	  6586	  6598	  6605	  6620	  6623	  6626	  6638	  6645
	  6652	  6653	  6660	  6673	  6681	  6693	  6694	  6696	  6703	  6705	  6708	  6711	  6715
IF.OFF	   358#	   763	   773	   775	   777	   779	   829	   831	   835	   862	   863	   899	   904	   943
	   986	  1028	  1074	  1083	  1087	  1128	  1135	  1145	  1157	  1216	  1228	  1235	  1245	  1253
	  1301	  1311	  1319	  1329	  1337	  1347	  1357	  1366	  1432	  1440	  1489	  1491	  1536	  1566
	  1568	  1570	  1572	  1632	  1664	  1679	  1745	  1766	  1782	  1828	  1843	  1858	  1872	  1969
	  2024	  2052	  2053	  2060	  2061	  2183	  2235	  2258	  2263	  2265	  2279	  2281	  2283	  2290
	  2294	  2319	  2386	  2390	  2412	  2430	  2432	  2450	  2462	  2478	  2500	  2518	  2539	  2540
	  2545	  2550	  2604	  2606	  2631	  2636	  2640	  2641	  2643	  2646	  2652	  2678	  2679	  2681
	  2683	  2684	  2686	  2708	  2711	  2719	  2801	  2856	  2906	  2916	  2971	  2973	  3058	  3062
	  3077	  3108	  3138	  3159	  3189	  3196	  3292	  3339	  3360	  3396	  3646	  3656	  3661	  3688
	  3708	  3711	  3838	  3899	  3901	  3959	  3996	  3998	  4021	  4034	  4036	  4072	  4084	  4103
	  4157	  4175	  4211	  4214	  4256	  4258	  4280	  4474	  4530	  4557	  4565	  4660	  4661	  4704
	  4709	  4713	  4825	  4826	  4898	  4901	  4911	  4947	  4958	  5016	  5133	  5134	  5173	  5183
	  5185	  5346	  5383	  5420	  5422	  5448	  5547	  5683	  5691	  5707	  5723	  5758	  5771	  5792
	  5796	  5820	  5858	  6168	  6225	  6227	  6232	  6234	  6428	  6431	  6434	  6437	  6498	  6511
	  6516	  6518	  6520	  6619	  6687	  6692	  6710
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Macro/Opdef cross reference

IF.ON	   355#	   781	   782	   783	   784	   860	   971	  1100	  1370	  1449	  1493	  1495	  1610	  1612
	  1686	  1698	  1772	  2022	  2110	  2120	  2236	  2264	  2282	  2417	  2437	  2504	  2677	  2800
	  2858	  2951	  2975	  3085	  3143	  3212	  3277	  3280	  3290	  3293	  3302	  3445	  3471	  3473
	  3565	  3699	  3727	  3774	  3799	  3836	  3862	  3874	  3934	  3939	  3954	  3957	  4108	  4173
	  4285	  4305	  4614	  4658	  4659	  4705	  4706	  4707	  4712	  4714	  4823	  4824	  4907	  5014
	  5015	  5018	  5159	  5181	  5189	  5343	  5393	  5395	  5541	  5551	  5659	  5660	  5697	  5703
	  5734	  5795	  5857	  6035	  6086	  6087	  6088	  6104	  6170	  6218	  6221	  6410	  6411	  6412
	  6415	  6483	  6484	  6485	  6489	  6522	  6541	  6625	  6690
INCHWL	  1979
MME	   289#	   676	   678	   681	   704	   707	   739	   788	   789	   809	   834	   847	   850	   902
	   970	   985	  1027	  1071	  1628	  2214	  2240	  2246	  2364	  2394	  2397	  2702	  3703	  3860
	  3905	  3915	  3926	  3952	  4012	  4016	  4067	  4127	  4202	  4207	  4273	  4287	  4311	  4332
	  4335	  4338	  4341	  4501	  4542	  4586	  4594	  5084	  5171	  5180	  5482	  5493	  5495	  5555
	  5570	  5713	  5718	  5736	  5740	  5749	  5766	  6016	  6102	  6132	  6136	  6442	  6443	  6470
	  6529	  6585	  6704
MTABLE	   383#	  7130
NOP	   292#	   714	   740	   800	  1631	  1635	  1648	  1650	  1713	  2634	  2691	  2703	  2877	  3638
	  3674	  3916	  4288	  4895	  5165	  5404	  5447	  5461	  5469	  5483	  5767	  6017	  6425	  6510
	  6551
OFF	   352#	  1689	  2033	  2076	  2094	  2123	  2164	  2296	  2348	  2350	  2614	  2639	  2660	  2713
	  2714	  2990	  2991	  3107	  3117	  3131	  3640	  3686	  4350	  4701	  4722	  4819	  4912	  4934
	  4948	  4964	  4966	  5011	  5137	  5378	  5505	  5667	  5668	  6444	  6495	  6635	  6707
ON	   349#	  1051	  1213	  1233	  1241	  1251	  1268	  1298	  1308	  1317	  1327	  1335	  1344	  1354
	  1364	  1374	  1396	  1471	  1478	  1485	  1565	  1659	  1693	  1770	  1785	  1831	  1846	  1863
	  1875	  1905	  2011	  2067	  2143	  2174	  2322	  2901	  3072	  3137	  3142	  3188	  3195	  3275
	  3684	  3705	  3722	  3724	  3726	  3769	  3773	  3775	  3794	  3796	  3798	  3831	  3833	  3835
	  3869	  3871	  3873	  4286	  4306	  4902	  4921	  4956	  4960	  5371	  5372	  5391	  6622
OP	   336#	   763	   773	   775	   777	   779	   781	   782	   783	   784	   829	   831	   835	   860
	   862	   863	   899	   904	   943	   971	   986	  1028	  1051	  1074	  1083	  1087	  1100	  1128
	  1135	  1145	  1157	  1213	  1216	  1228	  1233	  1235	  1241	  1245	  1251	  1253	  1268	  1298
	  1301	  1308	  1311	  1317	  1319	  1327	  1329	  1335	  1337	  1344	  1347	  1354	  1357	  1364
	  1366	  1370	  1374	  1396	  1432	  1440	  1449	  1471	  1478	  1485	  1489	  1491	  1493	  1495
	  1536	  1565	  1566	  1568	  1570	  1572	  1610	  1612	  1632	  1659	  1664	  1679	  1686	  1689
	  1693	  1698	  1744	  1745	  1766	  1770	  1772	  1781	  1782	  1785	  1793	  1800	  1807	  1814
	  1821	  1828	  1831	  1843	  1846	  1857	  1858	  1863	  1871	  1872	  1875	  1884	  1905	  1962
	  1969	  2005	  2007	  2011	  2022	  2024	  2033	  2048	  2049	  2052	  2053	  2060	  2061	  2064
	  2067	  2076	  2094	  2110	  2120	  2123	  2124	  2143	  2164	  2174	  2183	  2235	  2236	  2237
	  2258	  2263	  2264	  2265	  2279	  2281	  2282	  2283	  2290	  2294	  2296	  2319	  2322	  2348
	  2350	  2386	  2390	  2412	  2417	  2430	  2432	  2437	  2450	  2462	  2478	  2500	  2504	  2505
	  2518	  2538	  2539	  2540	  2545	  2550	  2604	  2606	  2614	  2631	  2636	  2639	  2640	  2641
	  2643	  2646	  2652	  2660	  2677	  2678	  2679	  2681	  2683	  2684	  2686	  2708	  2711	  2713
	  2714	  2719	  2800	  2801	  2814	  2838	  2856	  2858	  2901	  2906	  2916	  2951	  2971	  2973
	  2975	  2990	  2991	  3058	  3062	  3072	  3077	  3085	  3107	  3108	  3117	  3131	  3137	  3138
	  3142	  3143	  3159	  3188	  3189	  3195	  3196	  3212	  3275	  3277	  3280	  3290	  3292	  3293
	  3302	  3339	  3360	  3396	  3445	  3471	  3473	  3565	  3640	  3646	  3656	  3661	  3684	  3686
	  3688	  3699	  3705	  3708	  3711	  3722	  3724	  3726	  3727	  3769	  3773	  3774	  3775	  3794
	  3796	  3798	  3799	  3831	  3833	  3835	  3836	  3838	  3862	  3869	  3871	  3873	  3874	  3899
	  3901	  3934	  3939	  3954	  3957	  3959	  3996	  3998	  4021	  4034	  4036	  4072	  4084	  4094
	  4103	  4108	  4151	  4157	  4173	  4175	  4211	  4214	  4244	  4256	  4258	  4280	  4285	  4286
	  4305	  4306	  4308	  4350	  4474	  4530	  4557	  4565	  4614	  4658	  4659	  4660	  4661	  4683
	  4701	  4704	  4705	  4706	  4707	  4709	  4712	  4713	  4714	  4722	  4819	  4823	  4824	  4825
	  4826	  4896	  4898	  4901	  4902	  4907	  4911	  4912	  4921	  4934	  4947	  4948	  4956	  4958
	  4960	  4964	  4966	  5011	  5014	  5015	  5016	  5018	  5133	  5134	  5137	  5159	  5173	  5181
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Macro/Opdef cross reference

	  5183	  5185	  5189	  5287	  5343	  5346	  5371	  5372	  5378	  5383	  5391	  5393	  5395	  5420	  5422
	  5448	  5505	  5541	  5547	  5549	  5551	  5659	  5660	  5667	  5668	  5683	  5691	  5697	  5703
	  5707	  5723	  5734	  5758	  5771	  5792	  5795	  5796	  5820	  5857	  5858	  6035	  6086	  6087
	  6088	  6104	  6168	  6170	  6218	  6221	  6225	  6227	  6232	  6234	  6410	  6411	  6412	  6414
	  6415	  6428	  6431	  6434	  6437	  6444	  6483	  6484	  6485	  6489	  6495	  6498	  6511	  6516
	  6518	  6520	  6522	  6541	  6619	  6622	  6625	  6635	  6687	  6690	  6692	  6707	  6710
OUTSTR	   667	  1982
PRINT	   373#	   715	   884	   890	   927	  1497	  2627	  2637	  2673	  2720	  3689	  4152	  4899	  4923
	  5453	  5461	  5798	  5860	  6146	  6150	  6161	  6176	  6184	  6190	  6199	  6207	  6212	  6429
	  6432	  6435	  6438	  6452	  6590
RETURN	   301#	  1045	  1217	  1225	  1236	  1246	  1254	  1270	  1278	  1286	  1292	  1302	  1312	  1322
	  1330	  1338	  1348	  1376	  1383	  1391	  1398	  1404	  1407	  1413	  1421	  1447	  1460	  1483
	  1490	  1492	  1685	  1687	  1690	  1718	  1732	  1738	  1753	  1758	  1763	  1789	  1796	  1803
	  1810	  1817	  1824	  1839	  1852	  1867	  1878	  1887	  1892	  1899	  1935	  1940	  1944	  1965
	  1977	  1993	  1999	  2086	  2121	  2125	  2128	  2130	  2138	  2142	  2144	  2163	  2184	  2187
	  2207	  2209	  2215	  2497	  2722	  2751	  2759	  2789	  2798	  2806	  2810	  2820	  2827	  2832
	  2846	  2850	  2857	  2859	  2869	  2898	  2995	  2996	  3024	  3099	  3119	  3122	  3261	  3283
	  3326	  3329	  3377	  3384	  3407	  3456	  3558	  3561	  3583	  3590	  3620	  3645	  3648	  3650
	  3651	  3691	  3728	  3749	  3758	  3787	  3800	  3837	  3857	  3875	  4155	  4282	  4374	  4380
	  4386	  4406	  4425	  4457	  4516	  4523	  4552	  4575	  4577	  4600	  4607	  4656	  4662	  4674
	  4680	  4692	  4694	  4697	  4711	  4715	  4716	  4723	  4728	  4736	  4751	  4754	  4780	  4789
	  4798	  4827	  4836	  4855	  4860	  4881	  4885	  4950	  4969	  5088	  5115	  5199	  5207	  5215
	  5221	  5228	  5231	  5244	  5379	  5386	  5421	  5427	  5438	  5542	  5621	  5655	  5661	  5669
	  5676	  5685	  5689	  5692	  5695	  5729	  5737	  5741	  5750	  5753	  5867	  5896	  5959	  5968
	  6019	  6036	  6055	  6083	  6098	  6101	  6127	  6215	  6220	  6224	  6231	  6236	  6250	  6266
	  6275	  6308	  6335	  6342	  6374	  6385	  6401	  6413	  6447	  6479	  6499	  6543	  6556	  6586
	  6593	  6607	  6628	  6636	  6664	  6674	  6676	  6678	  6681
SAVE	   295#	   796	   903	  1511	  1609	  1724	  1970	  2551	  2884	  3179	  3311	  3470	  4053	  4479
	  4608	  4623	  4624	  4625	  4818	  4876	  4937	  4943	  5040	  5332	  5392	  5558	  5563	  5564
	  5573	  5575	  5576	  5644	  5848	  5868	  5940	  5942	  5983	  5987	  6002	  6044	  6050	  6062
	  6065	  6258	  6280	  6285	  6345	  6347	  6349	  6356	  6358	  6362	  6404	  6406	  6513	  6545
	  6549
TABLE	   388#	  7131	  7132	  7133	  7134	  7135	  7136	  7137	  7138	  7139	  7140	  7141	  7142	  7143
	  7144
TEO	   364#	  2048	  2505	  2538	  4094	  4244
TEST	   342#	   763	   773	   775	   777	   779	   781	   782	   783	   784	   829	   831	   835	   860
	   862	   863	   899	   904	   943	   971	   986	  1028	  1074	  1083	  1087	  1100	  1128	  1135
	  1145	  1157	  1216	  1228	  1235	  1245	  1253	  1301	  1311	  1319	  1329	  1337	  1347	  1357
	  1366	  1370	  1432	  1440	  1449	  1489	  1491	  1493	  1495	  1536	  1566	  1568	  1570	  1572
	  1610	  1612	  1632	  1664	  1679	  1686	  1698	  1744	  1745	  1766	  1772	  1781	  1782	  1793
	  1800	  1807	  1814	  1821	  1828	  1843	  1857	  1858	  1871	  1872	  1884	  1962	  1969	  2005
	  2007	  2022	  2024	  2048	  2049	  2052	  2053	  2060	  2061	  2064	  2110	  2120	  2124	  2183
	  2235	  2236	  2237	  2258	  2263	  2264	  2265	  2279	  2281	  2282	  2283	  2290	  2294	  2319
	  2386	  2390	  2412	  2417	  2430	  2432	  2437	  2450	  2462	  2478	  2500	  2504	  2505	  2518
	  2538	  2539	  2540	  2545	  2550	  2604	  2606	  2631	  2636	  2640	  2641	  2643	  2646	  2652
	  2677	  2678	  2679	  2681	  2683	  2684	  2686	  2708	  2711	  2719	  2800	  2801	  2814	  2838
	  2856	  2858	  2906	  2916	  2951	  2971	  2973	  2975	  3058	  3062	  3077	  3085	  3108	  3138
	  3143	  3159	  3189	  3196	  3212	  3277	  3280	  3290	  3292	  3293	  3302	  3339	  3360	  3396
	  3445	  3471	  3473	  3565	  3646	  3656	  3661	  3688	  3699	  3708	  3711	  3727	  3774	  3799
	  3836	  3838	  3862	  3874	  3899	  3901	  3934	  3939	  3954	  3957	  3959	  3996	  3998	  4021
	  4034	  4036	  4072	  4084	  4094	  4103	  4108	  4151	  4157	  4173	  4175	  4211	  4214	  4244
	  4256	  4258	  4280	  4285	  4305	  4308	  4474	  4530	  4557	  4565	  4614	  4658	  4659	  4660
	  4661	  4683	  4704	  4705	  4706	  4707	  4709	  4712	  4713	  4714	  4823	  4824	  4825	  4826
MAGCON ************* CHARACTER SET CONVERTER **********   	MACRO 12.3-46.0 09:28  6-JUL-77
MAGCON.MAC	 6-JUL-77 09:25		Macro/Opdef cross reference

	  4896	  4898	  4901	  4907	  4911	  4947	  4958	  5014	  5015	  5016	  5018	  5133	  5134	  5159	  5173
	  5181	  5183	  5185	  5189	  5287	  5343	  5346	  5383	  5393	  5395	  5420	  5422	  5448	  5541
	  5547	  5549	  5551	  5659	  5660	  5683	  5691	  5697	  5703	  5707	  5723	  5734	  5758	  5771
	  5792	  5795	  5796	  5820	  5857	  5858	  6035	  6086	  6087	  6088	  6104	  6168	  6170	  6218
	  6221	  6225	  6227	  6232	  6234	  6410	  6411	  6412	  6414	  6415	  6428	  6431	  6434	  6437
	  6483	  6484	  6485	  6489	  6498	  6511	  6516	  6518	  6520	  6522	  6541	  6619	  6625	  6687
	  6690	  6692	  6710
TEZ	   370#	  2064	  2124	  2838	  4151	  5549
TNO	   361#	  1744	  1781	  1793	  1800	  1807	  1814	  1821	  1857	  1871	  1884	  1962	  2005	  2049
	  2814	  5287	  6414
TNZ	   367#	  2007	  2237	  4308	  4683	  4896
UME	   288#	  2935	  2937	  2938	  2939	  2953	  2981	  2984	  2987	  3012	  3020	  3023	  3278	  3298
	  3308	  4331	  4337	  4343	  4344	  4346	  4379	  4385	  4412	  4419	  4421	  4424	  5201	  5204
	  5205	  5206	  5590
UNSAVE	   296#	   942	  1499	  1614	  1973	  2173	  2566	  2889	  3184	  3319	  3483	  4058	  4484	  4612
	  4628	  4629	  4630	  4636	  4821	  4828	  4878	  4880	  4942	  5019	  5056	  5125	  5135	  5398
	  5475	  5583	  5648	  5850	  5889	  5945	  5948	  5991	  5995	  6006	  6047	  6053	  6071	  6082
	  6240	  6264	  6283	  6294	  6354	  6368	  6369	  6371	  6373	  6408	  6553
USE	   305#	   461	   655	  1652	  1656	  2217	  2227	  4443	  4448	  5246	  5252	  5916	  5935	  6534
	  6538	  6722	  6730	  6987	  7018    cJ<E