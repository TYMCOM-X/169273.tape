DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 1
DR.MAC	11-SEP-79 17:43		KS-10 INSTRUCTION DEFINITIONS

     1				TITLE	 DR11C diagnostic to run on KS-2020 (stand alone)
     2				comment |
     3
     4				Copyright (C) 1979 by Tymshare, Inc.
     5						      20705 Valley Green Drive
     6						      Cupertino, CA   95014
     7
     8
     9				This software may be used or copied only as follows:
    10				1) For use on a system which is owned by Tymshare; or
    11				2) with specific written permission from Tymshare.
    12
    13					|
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 2
DR.MAC	11-SEP-79 17:43		KS-10 INSTRUCTION DEFINITIONS

    14				comment |
    15					Note: DDT should be assembled with EDDT=1 and DDTLOC=200000.
    16					This forces the start address of DDT to be out of the way of
    17					DR and makes it easy to remember for restarting from the CTY.
    18					|
    19
    20			000001	T1=1	; Local use prefered
    21			000002	T2=2
    22			000003	T3=3
    23			000004	B=4	; Base address of current DR
    24			000005	I=5	; Local to trap routines
    25			000006	I1=6	; Local to trap routines
    26			000007	TST=7	; The current test (al la .TST)
    27			000010	P=10	; Stack Pointer
    28			000011	A=11	; Used by main routines only
    29			000012	DR=12	; Logical # of DR11C under test
    30			000013	C=13	; Local to IO routines
    31			000014	D=14	; Local to IO routines
    32			000015	M1=15	; Local to MSG routines
    33			000016	M2=16	; Local to MSG routines
    34
    35				;	DR11C register offsets
    36
    37			000000	DRCSR==0			; Control Status Register
    38			000002	DROB==2				; Output Buffer
    39			000004	DRIB==4				; Input Buffer
    40
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 3
DR.MAC	11-SEP-79 17:43		KS-10 INSTRUCTION DEFINITIONS

    41
    42				SUBTTL KS-10 INSTRUCTION DEFINITIONS
    43				        XLIST
    44					LIST
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 4
DR.MAC	11-SEP-79 17:43		Locations of location depend. data

    45				subttl	Locations of location depend. data
    46
    47			001000	EPT==1000
    48			002000	TRP==EPT+1000
    49			003000	ORG==TRP+1000
    50
    51				subttl	Macros to do messages
    52
    53				define	MSG (A)	<
    54						MOVE M1,[POINT 7,[ASCIZ \A\]]
    55						PUSHJ P,CTYSO
    56				>
    57				define	MSGNL <
    58						MOVE M1,[POINT 7,[BYTE (7)15,12]]
    59						PUSHJ P,CTYSO
    60				>
    61				define	MSGBIT (A) <
    62						MOVE M1,A
    63						PUSHJ P,CTYBO
    64				>
    65				define	MSGOCT (A) <
    66						MOVE M1,A
    67						PUSHJ P,CTYOO
    68				>
    69				define	MSGDEC (A) <
    70						MOVE M1,A
    71						PUSHJ P,CTYDO; 
    72				>
    73
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 5
DR.MAC	11-SEP-79 17:43		Macros to do messages

    74				; setup ept and upt and interrupt vectors and stuff
    75
    76	001103			LOC EPT+103			; UBA 3 trap vector
    77	001103	000000	002000	EXP TRP
    78
    79	001422			LOC EPT+422			; PDL overflow
    80	001422	264000	003271	JSR PDLOV
    81
    82	001502			LOC EPT+502			; Page Fail new PC
    83	001502	000000	003277	EXP PAGFAL
    84
    85	001600			LOC EPT+600			; Page map
    86					; AccessAllowed+Writable+Cacheable 
    87	001600	500000	520001		XWD 500000,520001	; page 0 not cached
    88					XLIST
    89					LIST
    90
    91
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 6
DR.MAC	11-SEP-79 17:43		Macros to do messages

    92				; setup interrupt vectors for UBA 3
    93
    94			000200	TRPCNT=	200			; number of vectors
    95
    96	002000			LOC	TRP
    97				REPEAT	TRPCNT,<
    98					TRPADR==.-TRP
    99					JSR [	Z
   100						MOVE I1,@.
   101						MOVEI I,TRPADR
   102						JRST TRPSER]
   103					XLIST
   104				>
   105
   106			000000		TRPADR==.-TRP
   107					JSR [	Z
   108						MOVE I1,@.
   109						MOVEI I,TRPADR
   110	002000	264000	005101			JRST TRPSER]
   111					XLIST
   112					LIST
   113
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 7
DR.MAC	11-SEP-79 17:43		MAIN	- begin executable code and location indep. data here 

   114				subttl	MAIN	- begin executable code and location indep. data here 
   115
   116	003000			LOC	ORG			; begin code and data
   117
   118	003000			TRPTAB:	BLOCK TRPCNT		; Bits for each trap vector...
   119								; 0=trap not expected, cause error
   120								; if we trap through this vector;
   121								; >0=set given bits in INTFLG for
   122								; polling later.
   123
   124				; called at interrupt level
   125				; called with return address in I1 and vector/4 in I
   126				; will check for TRPTAB[I] zero and cause "bad trap error" if so,
   127				; if TRPTAB[I] is non-zero (set by NxtDr) then this interrupt may
   128				; be expected and the value of TRPTAB[I] is OR'd in to INTFLG
   129
   130	003200	000000	000000	TRPOPC:	Z			; Save OPC here
   131	003201	202300	003200	TRPSER:	MOVEM I1,TRPOPC
   132	003202	200305	003000		MOVE I1,TRPTAB(I)
   133	003203	322300	003206		JUMPE I1,BADTRP		; Trap not expected
   134	003204	436300	005066		IORM I1,INTFLGG		; Set flags in INTFLG
   135
   136	003205	254520	003200		JEN @TRPOPC		; Dismiss
   137	003206	221240	000004	BADTRP:	IMULI I,4		; Convert to vector number
   138	003207	332000	005077		SKIPE .QUIET		; Complain if enabled
   139	003210	254000	003225		  JRST BADTR1
   140	003211	261400	000015		PUSH P,M1
   141	003212	261400	000013		PUSH P,C
   142					msgnl^
   143	003213	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   144	003214	260400	003227			PUSHJ P,CTYSO
   145					msg <TRP: unexpected; vec=>^
   146	003215	200640	006110			MOVE M1,[POINT 7,[ASCIZ \TRP: unexpected; vec=\]]
   147	003216	260400	003227			PUSHJ P,CTYSO
   148					msgoct I^
   149	003217	200640	000005			MOVE M1,I
   150	003220	260400	003237			PUSHJ P,CTYOO
   151					msgnl^
   152	003221	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   153	003222	260400	003227			PUSHJ P,CTYSO
   154	003223	262400	000013		POP P,C
   155	003224	262400	000015		POP P,M1
   156	003225	350000	005071	BADTR1:	AOS TRPERR
   157	003226	254520	003200		JEN @TRPOPC
   158
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 8
DR.MAC	11-SEP-79 17:43		Routines to handle MSG to CTY

   159				SUBTTL	Routines to handle MSG to CTY
   160
   161	003227			CTYSO:	;	CTY String Output routine
   162	003227	134540	000015		ILDB C,M1	
   163	003230	322540	006111		JUMPE C,[POPJ P,]
   164	003231	260400	003342		PUSHJ P,CTYOUT
   165	003232	254000	003227		JRST CTYSO
   166
   167	003233			CTYBO:	;	CTY Bit pattern Output routine
   168	003233	622640	200000		TRZE M1,200000		; Int A bit on?
   169					  JRST [PUSH P,M1
   170						msg <IntA+>^
   171						MOVE M1,[POINT 7,[ASCIZ \IntA+\]]
   172						PUSHJ P,CTYSO
   173				^
   174						POP P,M1
   175	003234	254000	006115			JRST .+1]
   176	003235	622640	400000		TRZE M1,400000		; Int B bit on?
   177					  JRST [PUSH P,M1
   178						msg <IntB+>^
   179						MOVE M1,[POINT 7,[ASCIZ \IntB+\]]
   180						PUSHJ P,CTYSO
   181				^
   182						POP P,M1
   183	003236	254000	006125			JRST .+1]
   184
   185	003237			CTYOO:	;	CTY Octal Output routine
   186	003237	261400	000015		PUSH P,M1
   187	003240	554650	000000		HLRZ M1,(P)		; get left half
   188	003241	322640	003245		JUMPE M1,CTYOO1
   189	003242	260400	003251		PUSHJ P,CTYHO
   190					msg <,,>		; do ,, if necessary
   191	003243	200640	006133			MOVE M1,[POINT 7,[ASCIZ \,,		\]]
   192	003244	260400	003227			PUSHJ P,CTYSO
   193	003245	550650	000000	CTYOO1:	HRRZ M1,(P)		; get right half
   194	003246	260400	003251		PUSHJ P,CTYHO
   195	003247	262400	000015		POP P,M1
   196	003250	263400	000000		POPJ P,
   197
   198	003251			CTYHO:	;	CTY Halfword octal Output routine
   199	003251	231640	000010		IDIVI M1,10
   200	003252	261400	000016		PUSH P,M2
   201	003253	332000	000015		SKIPE M1
   202	003254	260400	003251		  PUSHJ P,CTYHO
   203	003255	262400	000016		POP P,M2
   204	003256	201556	000060		MOVEI C,"0"(M2)
   205	003257	260400	003342		PUSHJ P,CTYOUT
   206	003260	263400	000000		POPJ P,
   207
   208	003261			CTYDO: 	;	CTY Decimal Output routine
   209	003261	231640	000012		IDIVI M1,12	
   210	003262	261400	000016		PUSH P,M2
   211	003263	332000	000015		SKIPE M1
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 8-2
DR.MAC	11-SEP-79 17:43		Routines to handle MSG to CTY

   212	003264	260400	003261		  PUSHJ P,CTYDO
   213	003265	262400	000016		POP P,M2
   214	003266	201556	000060		MOVEI C,"0"(M2)
   215	003267	260400	003342		PUSHJ P,CTYOUT
   216	003270	263400	000000		POPJ P,
   217
   218
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 9
DR.MAC	11-SEP-79 17:43		Trap routines

   219				subttl	Trap routines
   220
   221	003271	000000	000000	PDLOV:	Z			; Should NEVER happen!!!
   222					msg <PDL OV; PC = >^
   223	003272	200640	006137			MOVE M1,[POINT 7,[ASCIZ \PDL OV; PC = \]]
   224	003273	260400	003227			PUSHJ P,CTYSO
   225					msgoct PDLOV^
   226	003274	200640	003271			MOVE M1,PDLOV
   227	003275	260400	003237			PUSHJ P,CTYOO
   228	003276	254000	003423		JRST START
   229
   230			001500	PFW==	EPT+500			; hard address of page fail word
   231			001501	PAGOPC==EPT+501			; old PC of word causing PF
   232
   233				OPDEF	JUMPT [JUMP]		; if this is found following an 
   234								; instruction that caused a page fail 
   235								; then JRST to its effective address
   236
   237	003277			PAGFAL:	;	Page Fail trap handler
   238	003277	261400	000001		PUSH P,T1
   239	003300	200040	001501		MOVE T1,PAGOPC		; get PF causing instruction
   240	003301	135040	006140		LDB T1,[point 9,1(T1),8]; get op code of instruction after trap
   241	003302	306040	000320		CAIN T1,<JUMPT>_<^D9-^D36>	; is it a JUMP?
   242	003303	254000	003325		  JRST PAGFA1
   243	003304	261400	000015		PUSH P,M1
   244	003305	261400	000013		PUSH P,C
   245					msgnl^
   246	003306	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   247	003307	260400	003227			PUSHJ P,CTYSO
   248					msg <Page Fail; PFW = >	; otherwise, describe the problem
   249	003310	200640	006145			MOVE M1,[POINT 7,[ASCIZ \Page Fail; PFW = 	\]]
   250	003311	260400	003227			PUSHJ P,CTYSO
   251					msgoct PFW^
   252	003312	200640	001500			MOVE M1,PFW
   253	003313	260400	003237			PUSHJ P,CTYOO
   254					msg <; PC = >^
   255	003314	200640	006150			MOVE M1,[POINT 7,[ASCIZ \; PC = \]]
   256	003315	260400	003227			PUSHJ P,CTYSO
   257					msgoct PAGOPC^
   258	003316	200640	001501			MOVE M1,PAGOPC
   259	003317	260400	003237			PUSHJ P,CTYOO
   260					msgnl^
   261	003320	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   262	003321	260400	003227			PUSHJ P,CTYSO
   263	003322	262400	000013		POP P,C
   264	003323	262400	000015		POP P,M1
   265	003324	334040	006151		SKIPA T1,[1]		; return to instruction after
   266	003325	200040	006152	PAGFA1:	  MOVE T1,[Z @1]	; return to E of inst after trap
   267	003326	272040	001501		ADDM T1,PAGOPC
   268	003327	262400	000001		POP P,T1
   269	003330	254120	001501		JRSTF @PAGOPC		; return somewhere
   270
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 10
DR.MAC	11-SEP-79 17:43		IO SUBROUTINES

   271				SUBTTL	IO SUBROUTINES
   272
   273	003331	332000	000032	CTYSIC: SKIPE CTYIWD		; char test
   274	003332	350010	000000		  AOS (P)
   275	003333	263400	000000		POPJ P,
   276
   277	003334	336540	000032	CTYIN:	SKIPN C,CTYIWD		; read char
   278	003335	254000	003334		  JRST .-1
   279	003336	402000	000032		SETZM CTYIWD
   280	003337	405540	000177		ANDI C,177
   281	003340	263400	000000		POPJ P,
   282
   283	003341	000000	000001	COL1:	1			; indicated carriage at COL 1
   284
   285	003342			CTYOUT: 			; write a char
   286	003342	306540	000012		CAIN C,12		; is it a LF?
   287					  JRST [SKIPE COL1	; are we already at a new line (COL 1)?
   288						  POPJ P,	;   yes - just return
   289						SETOM COL1	; no - set flag and do LF
   290	003343	254000	006153			JRST .+1]
   291	003344	303540	000040		CAILE C,40		; printing character?
   292	003345	402000	003341		  SETZM COL1		;   yes - not at COL1 any more
   293	003346	261400	000013		PUSH P,C		; save C
   294	003347	332000	000033		SKIPE CTYOWD		; exec mode write char
   295	003350	254000	003347		  JRST .-1
   296	003351	660540	000400		TRO C,CTYOVL
   297	003352	202540	000033		MOVEM C,CTYOWD
   298	003353	700200	012000		WRAPR 12000		; TICKLE 8080
   299	003354	332000	000033		SKIPE CTYOWD		; (hack for EDDT)
   300	003355	254000	003354		  JRST .-1
   301	003356	262400	000013		POP P,C			; get back original character
   302	003357	263400	000000		POPJ P,
   303
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 11
DR.MAC	11-SEP-79 17:43		INITIALIZE

   304				SUBTTL INITIALIZE
   305
   306				EXTERN DDT
   307	003360			PDL:	BLOCK 40		; la Stack!
   308	003420	000000	000000	RUNFLG:	Z			; flag to indicate running
   309	003421	000000	000000	EXPECT:	Z			; data expected
   310	003422	000000	000000	ERRCNT:	Z			; bad data counter
   311
   312	003423	200400	006157	START:	MOVE P,[IOWD 40,PDL]	; init la Stack!
   313
   314	003424	700200	061760		WRAPR 61760		; CLEAR AND DISABLE ALL
   315	003425	700600	011577		WRPI 11577		; CLEAR AND DISABLE ALL
   316
   317	003426	200040	000116		MOVE T1,116		; Patch up symbol table for EDDT
   318	003427	202040	000036		MOVEM T1,36
   319
   320	003430	402000	000033		SETZM CTYOWD		; CLEAR CTY LOCATIONS
   321	003431	402000	000032		SETZM CTYIWD
   322
   323	003432	701200	020001		WREBR 1B22+EPT/1000	; EPT at page EPT/1000, trap enable
   324	003433	701140	006160		WRUBR [5B2+EPT/1000]	; UPT at same page!
   325	003434	201040	000044		MOVEI T1,44		; PIA 4 for high and low
   326	003435	713060	006161		WRIO T1,@[3,,763100]	; Setup UBA 3 Status Register
   327	003436	700600	002377		WRPI 2377		; Enable All, Enable System
   328
   329	003437	201040	000017		MOVEI T1,DR.CNT-1	; Get DR count
   330	003440	400100	000000		SETZ T2,
   331	003441	200201	005026	ST1:	MOVE B,DR.ADR(T1)	; Get DR base address
   332	003442	713104	000000		WRIO T2,DRCSR(B)	; Reset DR
   333	003443	320000	003444		JUMPT .+1		; Ignore UB timeout trap
   334	003444	365040	003441		SOJGE T1,ST1
   335
   336					msgnl^
   337	003445	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   338	003446	260400	003227			PUSHJ P,CTYSO
   339					msg <DR11C diagnostic - Version 1>; Say HELLO
   340	003447	200640	006170			MOVE M1,[POINT 7,[ASCIZ \DR11C diagnostic - Version 1\]]
   341	003450	260400	003227			PUSHJ P,CTYSO
   342					msgnl^
   343	003451	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   344	003452	260400	003227			PUSHJ P,CTYSO
   345
   346	003453	476000	000012		SETOM DR		; Set defaults
   347	003454	476000	000007		SETOM TST
   348	003455	476000	005074		SETOM .DR
   349	003456	476000	005075		SETOM .TST
   350	003457	402000	005067		SETZM PATERR		; Clear counters, etc.
   351	003460	402000	005070		SETZM CSRERR
   352	003461	402000	005071		SETZM TRPERR
   353	003462	402000	005072		SETZM PATMSK
   354	003463	402000	005073		SETZM CSRMSK
   355	003464	402000	003420		SETZM RUNFLG		; Not running
   356
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 11-2
DR.MAC	11-SEP-79 17:43		INITIALIZE

   357	003465	264000	004007		JSR CP			; Process command(s)
   358
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 12
DR.MAC	11-SEP-79 17:43		MAIN TEST LOOP - do all test as appropriate

   359				SUBTTL  MAIN TEST LOOP - do all test as appropriate
   360
   361	003466	335000	005074	DRfail:	SKIPGE .DR		; Can we get another?
   362	003467	254000	003510		  JRST NxtDR		;    yes - go do it
   363					msgnl^
   364	003470	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   365	003471	260400	003227			PUSHJ P,CTYSO
   366					msg <?DR>		; Here if would loop looking for good DR
   367	003472	200640	006173			MOVE M1,[POINT 7,[ASCIZ \?DR		\]]
   368	003473	260400	003227			PUSHJ P,CTYSO
   369					msgoct .DR^
   370	003474	200640	005074			MOVE M1,.DR
   371	003475	260400	003237			PUSHJ P,CTYOO
   372					msg <: not responding>^
   373	003476	200640	006200			MOVE M1,[POINT 7,[ASCIZ \: not responding\]]
   374	003477	260400	003227			PUSHJ P,CTYSO
   375					msgnl^
   376	003500	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   377	003501	260400	003227			PUSHJ P,CTYSO
   378					msg <?diagnostic halted>^
   379	003502	200640	006205			MOVE M1,[POINT 7,[ASCIZ \?diagnostic halted\]]
   380	003503	260400	003227			PUSHJ P,CTYSO
   381					msgnl^
   382	003504	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   383	003505	260400	003227			PUSHJ P,CTYSO
   384	003506	402000	003420		SETZM RUNFLG
   385	003507	264000	004007		JSR CP
   386
   387	003510	474340	000000	NxtDR:	SETO TST,		; Clear test start at beginning
   388	003511	335040	005074		SKIPGE T1,.DR		; If spcific DR selected
   389	003512	201052	000001		  MOVEI T1,1(DR)	;   Select next one
   390	003513	231040	000020		IDIVI T1,DR.CNT		; T2 _ T1 mod DR.CNT
   391	003514	202100	000012		MOVEM T2,DR		; Save new logical DR number
   392	003515	200212	005026		MOVE B,DR.ADR(DR)	; Get DR base address
   393	003516	712004	000000		RDIO DRCSR(B)		; See if DR exists
   394	003517	320000	003466		JUMPT DRfail		;   If trap, go to next DR
   395	003520	250100	000012		EXCH T2,DR		; Use new DR but keep around old one
   396	003521	335000	005075		SKIPGE .TST		; Are all tests enabled?
   397	003522	332000	005077		 SKIPE .QUIET		;  Should we be quiet?
   398	003523	254000	003536		  JRST NDR1
   399					msgnl^
   400	003524	200640	006102			MOV[POINT 7,[BYTE (7)15,12]]
   401	003525	260400	003227			PUSHJ P,CTYSO
   402					msg <Testing DR>	; Print DR number
   403	003526	200640	006211			MOVE M1,[POINT 7,[ASCIZ \Testing DR	\]]
   404	003527	260400	003227			PUSHJ P,CTYSO
   405				     	msgoct DR^
   406	003530	200640	000012			MOVE M1,DR
   407	003531	260400	003237			PUSHJ P,CTYOO
   408				     	msg <:>^
   409	003532	200640	006213			MOVE M1,[POINT 7,[ASCIZ \:\]]
   410	003533	260400	003227			PUSHJ P,CTYSO
   411				     	msgnl^
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 12-2
DR.MAC	11-SEP-79 17:43		MAIN TEST LOOP - do all test as appropriate

   412	003534	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   413	003535	260400	003227			PUSHJ P,CTYSO
   414	003536	264000	004007	NDR1:	JSR CP			; Process command if waiting
   415	003537	400040	000000		SETZ T1,		; Clear CSR
   416	003540	713044	000000		WRIO T1,DRCSR(B)
   417	003541	402000	003000		SETZM TRPTAB		; Clear expected vector int flags
   418	003542	200040	006214		MOVE T1,[TRPTAB,TRPTAB+1]
   419	003543	251040	003177		BLT T1,TRPTAB+TRPCNT-1
   420	003544	200052	005046		MOVE T1,DR.VEC(DR)
   421	003545	242040	777776		LSH T1,-2		; T1 _ T1/4
   422	003546	201100	200000		MOVEI T2,INTA
   423	003547	202101	003000		MOVEM T2,TRPTAB+0(T1)	; INT A HANDLER
   424	003550	201100	400000		MOVEI T2,INTB
   425	003551	202101	003001		MOVEM T2,TRPTAB+1(T1)	; INT B HANDLER
   426	003552	476000	000007		SETOM TST		; Next test is pattern 0
   427	
   428	003553	264000	004007	NxtTst:	JSR CP			; Process command if one waiting
   429	003554	335040	005075		SKIPGE T1,.TST		; If specific test selected
   430	003555	201047	000001		  MOVEI T1,1(TST)	;   Select next one
   431	003556	202040	000007		MOVEM T1,TST		; Use new test 
   432	003557	305340	200000	DoTest:	CAIGE TST,200000	; See if a pattern test
   433	003560	254000	003571		  JRST RWtest		;   Yes - dispatch to pattern tester
   434	003561	305340	200020		CAIGE TST,200020	; See if CSR test
   435	003562	254000	003710		  JRST CStest		;   Yes - dispatch to CSR tester
   436	003563	254000	003510		JRST NxtDR		; None of these - done with tests
   437
   438
   439				SUBTTL	PAUSE for PDP-11 to loop data back to us
   440
   441	003564	261400	000001	Pause:	PUSH P,T1		; Save T1
   442	003565	200040	005100		MOVE T1,.TIME
   443	003566	367040	003566		SOJG T1,.		; Wait for '11 to respond for loopback
   444	003567	262400	000001		POP P,T1
   445	003570	263400	000000		POPJ P,
   446
   447
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 13
DR.MAC	11-SEP-79 17:43		R/W TEST - tries to read/write all possible data through link

   448				SUBTTL	R/W TEST - tries to read/write all possible data through link
   449
   450				; Call here with TST/ data pattern
   451					; expects B/ base address of DR
   452					; uses A,T1,T2,T3; calls MSGxxx who use C,D,M1
   453					; also uses ERRCNT,EXPECT
   454				; This routine is called once for each data value to be tested for each
   455				; DR by the routine NxtDR. RWTEST will return when the
   456				; data read is correct or if "continue on error" is set or if "Halt
   457				; on error" is set and the operator does a continue in KS10 console
   458				; mode.  
   459
   460	003571	402000	003422	RWtest:	SETZM ERRCNT		; Zero error count
   461	003572	542340	000003		HRRM TST,T3		; Good data
   462	003573	506340	000003		HRLM TST,T3
   463	003574	202140	003421		MOVEM T3,EXPECT		; Initially expect good data
   464	003575	264000	004007	RWTRY:	JSR CP			; Do a command if one waiting
   465	003576	713344	000002		WRIO TST,DROB(B)	; Write data
   466	003577	712104	000002		RDIO T2,DROB(B)		; See if it stuck
   467	003600	504440	000002		HRL A,T2		; OB in LH
   468	003601	260400	003564		PUSHJ P,PAUSE		; Wait for slow loopback if necessary
   469	003602	712104	000004		RDIO T2,DRIB(B)		; Read looped back data
   470	003603	540440	000002		HRR A,T2		; IB in RH
   471	003604	200040	000011		MOVE T1,A		; compute mask of error bits
   472	003605	430040	000003		XOR T1,T3
   473	003606	436040	005072		IORM T1,PATMSK		; save mask
   474	003607	316440	003421		CAMN A,EXPECT		; Is it expected?
   475	003610	254000	003660		  JRST RW1		;   expected
   476								; not expected
   477	003611	336000	003422		SKIPN ERRCNT		; Print count if any
   478	003612	254000	003626		  JRST RW2		;   no count
   479								; count
   480	003613	332000	005077		SKIPE .QUIET
   481	003614	254000	003626		  JRST RW2
   482					msg <; >^
   483	003615	200640	006216			MOVE M1,[POINT 7,[ASCIZ \; \]]
   484	003616	260400	003227			PUSHJ P,CTYSO
   485					msgdec ERRCNT^
   486	003617	200640	003422			MOVE M1,ERRCNT
   487	003620	260400	003261			PUSHJ P,CTYDO; 
   488					msg < times>^
   489	003621	200640	006221			MOVE M1,[POINT 7,[ASCIZ \ times\]]
   490	003622	260400	003227			PUSHJ P,CTYSO
   491					msgnl^
   492	003623	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   493	003624	260400	003227			PUSHJ P,CTYSO
   494	003625	402000	003422		SETZM ERRCNT		; clear count for this error
   495
   496	003626			RW2:	; -- data not expected --
   497	003626	322040	003667		JUMPE T1,RWOKAY		; Is it good data?
   498								; data is bad
   499	003627	202440	003421		MOVEM A,EXPECT		; expect same data again
   500	003630	332000	005077		SKIPE .QUIET
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 13-2
DR.MAC	11-SEP-79 17:43		R/W TEST - tries to read/write all possible data through link

   501	003631	254000	003660		  JRST RW1
   502					msg <PAT: >^
   503	003632	200640	006224			MOVE M1,[POINT 7,[ASCIZ \PAT: \]]
   504	003633	260400	003227			PUSHJ P,CTYSO
   505					msgoct TST^
   506	003634	200640	000007			MOVE M1,TST
   507	003635	260400	003237			PUSHJ P,CTYOO
   508					msg <; OUTBUF=>^
   509	003636	200640	006227			MOVE M1,[POINT 7,[ASCIZ \; OUTBUF=\]]
   510	003637	260400	003227			PUSHJ P,CTYSO
   511	003640	554100	000011		HLRZ T2,A
   512					msgoct T2^
   513	003641	200640	000002			MOVE M1,T2
   514	003642	260400	003237			PUSHJ P,CTYOO
   515					msg <; INBUF=>^
   516	003643	200640	006232			MOVE M1,[POINT 7,[ASCIZ \; INBUF=\]]
   517	003644	260400	003227			PUSHJ P,CTYSO
   518	003645	550100	000011		HRRZ T2,A
   519					msgoct T2^
   520	003646	200640	000002			MOVE M1,T2
   521	003647	260400	003237			PUSHJ P,CTYOO
   522					msg <; mask=>^
   523	003650	200640	006235			MOVE M1,[POINT 7,[ASCIZ \; mask=\]]
   524	003651	260400	003227			PUSHJ P,CTYSO
   525					msgoct T1^
   526	003652	200640	000001			MOVE M1,T1
   527	003653	260400	003237			PUSHJ P,CTYOO
   528	003654	336000	005076		SKIPN .SW		; If any but loop on error, need CRLF
   529	003655	254000	003660		  JRST RW1		;   0=loop on error
   530					msgnl^
   531	003656	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   532	003657	260400	003227			PUSHJ P,CTYSO
   533
   534	003660			RW1:	; -- data was expected --
   535	003660	322040	003667		JUMPE T1,RWOKAY		; Is it good data?
   536								; data is bad
   537	003661	350000	003422		AOS ERRCNT		; Count failures
   538	003662	350000	005067		AOS PATERR		; Count pattern failures
   539	003663	200040	005076		MOVE T1,.SW		; What to do on error
   540	003664	322040	003575		JUMPE T1,RWTRY		; 0=loop on error, go try again
   541	003665	306040	000001		CAIN T1,1		; 1=halt on error, die!
   542	003666	254200	003667	%H1:	  HALT .+1
   543								; 2=continue on error, return
   544	003667	254000	003553	RWOKAY: JRST NxtTst		; End of this test
   545
   546
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 14
DR.MAC	11-SEP-79 17:43		CSR bit R/W test

   547				SUBTTL	CSR bit R/W test
   548
   549				; Call here with B/ DR11C base address
   550					; TST/ 200000+N where N is a test number in [0:15]
   551					; uses T1, T2, T3, EXPECT and ERRCNT
   552					; calls MSGxxx who use C,D,M1
   553				; This routine is called once for each CSR value to be tested for each
   554				; DR by the routine NxtDR.  CSTEST will return when the
   555				; data read is correct or if "continue on error" is set or if "Halt
   556				; on error" is set and the operator does a continue in KS10 console
   557				; mode.  Note that interrupts are tested at the same time.
   558
   559			200000	IntA==1B19			; set in INTFLG by TRPSER
   560			400000	IntB==1B18			; set in INTFLG by TRPSER
   561			000200	ReqA==1B<35-7>			; read only
   562			100000	ReqB==1B<35-15>			; read only
   563			000100	EnbA==1B<35-6>			; r/w
   564			000040	EnbB==1B<35-5>			; r/w
   565			000001	BitA==1B<35-0>			; r/w
   566			000002	BitB==1B<35-1>			; r/w
   567
   568				;	 write	  	        expect
   569	003670	000000	000000	CS.TAB:	0                    ,,0
   570	003671	000001	000201		0               +BitA,,0               +BitA               +ReqA
   571	003672	000002	100002		0          +BitB     ,,0          +BitB               +ReqB
   572	003673	000003	100203		0          +BitB+BitA,,0          +BitB+BitA          +ReqB+ReqA
   573	003674	000100	000100		0     +EnbA          ,,0     +EnbA
   574	003675	000101	200301		0     +EnbA     +BitA,,0     +EnbA     +BitA     +IntA     +ReqA
   575	003676	000102	100102		0     +EnbA+BitB     ,,0     +EnbA+BitB               +ReqB
   576	003677	000103	300303		0     +EnbA+BitB+BitA,,0     +EnbA+BitB+BitA     +IntA+ReqB+ReqA
   577	003700	000040	000040		0+EnbB               ,,0+EnbB               
   578	003701	000041	000241		0+EnbB          +BitA,,0+EnbB          +BitA               +ReqA
   579	003702	000042	500042		0+EnbB     +BitB     ,,0+EnbB     +BitB     +IntB     +ReqB
   580	003703	000043	500243		0+EnbB     +BitB+BitA,,0+EnbB     +BitB+BitA+IntB     +ReqB+ReqA
   581	003704	000140	000140		0+EnbB+EnbA          ,,0+EnbB+EnbA
   582	003705	000141	200341		0+EnbB+EnbA     +BitA,,0+EnbB+EnbA     +BitA     +IntA     +ReqA
   583	003706	000142	500142		0+EnbB+EnbA+BitB     ,,0+EnbB+EnbA+BitB     +IntB     +ReqB
   584	003707	000143	700343		0+EnbB+EnbA+BitB+BitA,,0+EnbB+EnbA+BitB+BitA+IntB+IntA+ReqB+ReqA
   585
   586	003710	402000	003422	CStest:	SETZM ERRCNT		; Zero error count
   587	003711	201047	600000		MOVEI T1,-200000(TST)	; Get CSR test #
   588	003712	554101	003670		HLRZ T2,CS.TAB(T1)	; What to write
   589	003713	550141	003670		HRRZ T3,CS.TAB(T1)	; What to hope for
   590	003714	202140	003421		MOVEM T3,EXPECT		; What to expect
   591	003715	264000	004007	CStry:	JSR CP			; Test for command
   592	003716	400040	000000		SETZ T1,		; Reset the CSR
   593	003717	713044	000000		WRIO T1,DRCSR(B)
   594	003720	402000	005066		SETZM INTFLG		; Clear interrupt flags
   595	003721	713104	000000		WRIO T2,DRCSR(B)	; Write it
   596	003722	260400	003564		PUSHJ P,PAUSE		; Pause if necessary for softloop
   597	003723	712444	000000		RDIO A,DRCSR(B)		; What do we have?
   598	003724	434440	005066		IOR A,INTFLG		; Merge in interrupts (bits 16-17)
   599	003725	200040	000011		MOVE T1,A		; Mask bits in error
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 14-2
DR.MAC	11-SEP-79 17:43		CSR bit R/W test

   600	003726	430040	000003		XOR T1,T3
   601	003727	436040	005073		IORM T1,CSRMSK		; Save mask
   602	003730	316440	003421		CAMN A,EXPECT		; Did we expect that?
   603	003731	254000	003777		  JRST CS1		;   expected
   604	  
   605	003732	336000	003422		SKIPN ERRCNT		; Print error count if any
   606	003733	254000	003747		  JRST CS2
   607	
   608	003734	332000	005077		SKIPE .QUIET
   609	003735	254000	003747		  JRST CS2
   610					msg <; >^
   611	003736	200640	006216			MOVE M1,[POINT 7,[ASCIZ \; \]]
   612	003737	260400	003227			PUSHJ P,CTYSO
   613					msgdec ERRCNT^
   614	003740	200640	003422			MOVE M1,ERRCNT
   615	003741	260400	003261			PUSHJ P,CTYDO; 
   616					msg < times>^
   617	003742	200640	006221			MOVE M1,[POINT 7,[ASCIZ \ times\]]
   618	003743	260400	003227			PUSHJ P,CTYSO
   619					msgnl^
   620	003744	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   621	003745	260400	003227			PUSHJ P,CTYSO
   622	003746	402000	003422		SETZM ERRCNT
   623
   624	003747			CS2:	; -- Data not expected --
   625	003747	322040	004006		JUMPE T1,CSOKAY		; Is data good?
   626								; Data is incorrect
   627	003750	202440	003421		MOVEM A,EXPECT
   628	003751	332000	005077		SKIPE .QUIET
   629	003752	254000	003777		  JRST CS1
   630					msg <BIT: >^
   631	003753	200640	006240			MOVE M1,[POINT 7,[ASCIZ \BIT: \]]
   632	003754	260400	003227			PUSHJ P,CTYSO
   633					msgoct T2^
   634	003755	200640	000002			MOVE M1,T2
   635	003756	260400	003237			PUSHJ P,CTYOO
   636					msg <; expected=>^
   637	003757	200640	006244			MOVE M1,[POINT 7,[ASCIZ \; expected=\]]
   638	003760	260400	003227			PUSHJ P,CTYSO
   639					msgbit T3^
   640	003761	200640	000003			MOVE M1,T3
   641	003762	260400	003233			PUSHJ P,CTYBO
   642					msg <; CSR=>^
   643	003763	200640	006247			MOVE M1,[POINT 7,[ASCIZ \; CSR=\]]
   644	003764	260400	003227			PUSHJ P,CTYSO
   645					msgbit A^
   646	003765	200640	000011			MOVE M1,A
   647	003766	260400	003233			PUSHJ P,CTYBO
   648					msg <; mask=>^
   649	003767	200640	006235			MOVE M1,[POINT 7,[ASCIZ \; mask=\]]
   650	003770	260400	003227			PUSHJ P,CTYSO
   651					msgbit T1^
   652	003771	200640	000001			MOVE M1,T1
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 14-3
DR.MAC	11-SEP-79 17:43		CSR bit R/W test

   653	003772	260400	003233			PUSHJ P,CTYBO
   654	003773	336000	005076		SKIPN .SW		; If any but loop on error, need CRLF
   655	003774	254000	003777		  JRST CS1		;   0=loop on error
   656					msgnl^
   657	003775	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   658	003776	260400	003227			PUSHJ P,CTYSO
   659
   660	003777			CS1:	; -- Data was expected --
   661	003777	322040	004006		JUMPE T1,CSOKAY		; Good data?
   662								; Data is bad
   663	004000	350000	003422		AOS ERRCNT		; Another error
   664	004001	350000	005070		AOS CSRERR
   665	004002	200040	005076		MOVE T1,.SW		; Get what to do on error
   666	004003	322040	003715		JUMPE T1,CStry		; 0=loop on error
   667	004004	306040	000001		CAIN T1,1
   668	004005	254200	004006	%H2:	  HALT .+1		; 1=halt on error
   669								; 2=continue on error
   670	004006	254000	003553	CSokay:	JRST NxtTst		; End of this test
   671
   672
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 15
DR.MAC	11-SEP-79 17:43		Command processor - command definition

   673				SUBTTL	Command processor - command definition
   674
   675				; call here to get a command...
   676				; returns immediately if there is not character waiting
   677				; processes command if char is waiting
   678				; may never return to caller (ie. may JRST somewhere)
   679				; will not return if RUNFLG = 0 (ie. diagnostic not running)
   680
   681	004007	000000	000000	CP:	Z
   682	004010	260400	003331		PUSHJ P,CTYSIC		; character there?
   683	004011	254000	004020		  JRST CP1		; no, do nothing
   684					msgnl	^
   685	004012	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   686	004013	260400	003227			PUSHJ P,CTYSO
   687	004014	260400	003334		PUSHJ P,CTYIN		; get character
   688	004015	301540	000140		CAIL C,140		; convert to upper case
   689	004016	275540	000040		  SUBI C,40
   690	004017	256013	004047	DISP:	XCT CHRTAB(C)		; do it
   691	004020	336000	003420	CP1:	SKIPN RUNFLG		; running?
   692	004021	254000	004010		  JRST CP+1		;   no - loop
   693	004022	254120	004007		JRSTF @CP		; yes, return
   694
   695	004023	000000	003423	OCTER:	START			; Place to go to in case of error
   696	004024	400040	000000	OCTIN:	SETZ T1,
   697	004025	260400	003334	OCTIN1:	PUSHJ P,CTYIN
   698	004026	306540	000033		CAIN C,33		; "escape" means -1
   699					  JRST [msg <[all]>^
   700						MOVE M1,[POINT 7,[ASCIZ \[all]\]]
   701						PUSHJ P,CTYSO
   702				^
   703						msgnl^
   704						MOVE M1,[POINT 7,[BYTE (7)15,12]]
   705						PUSHJ P,CTYSO
   706				^
   707						SETO T1,
   708						AOS (P)		; skip return
   709	004027	254000	006253			POPJ P,]
   710	004030	306540	000032		CAIN C,32		; ^Z means go to DDT
   711	004031	264000	004344		  JSR %Z.CMD
   712	004032	306540	000015		CAIN C,15		; "return" means we got it
   713					  JRST [msgnl^
   714						MOVE M1,[POINT 7,[BYTE (7)15,12]]
   715						PUSHJ P,CTYSO
   716				^
   717						AOS (P)		; skip return
   718	004033	254000	006262			POPJ P,]
   719	004034	306540	000025		CAIN C,25		; ^U ignore this command
   720					  JRST [msg < ^U>^
   721						MOVE M1,[POINT 7,[ASCIZ \ ^U\]]
   722						PUSHJ P,CTYSO
   723				^
   724						msgnl^
   725						MOVE M1,[POINT 7,[BYTE (7)15,12]]
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 15-2
DR.MAC	11-SEP-79 17:43		Command processor - command definition

   726						PUSHJ P,CTYSO
   727				^
   728	004035	254000	006270			POPJ P,]	; return to caller (error)
   729	004036	306540	000177		CAIN C,177		; RUBOUT - delete one
   730					  JRST [JUMPN T1,QQ	; Don't back up too far
   731						  msg <>	^
   732						MOVE M1,[POINT 7,[ASCIZ \	\]]
   733						PUSHJ P,CTYSO
   734				^; Bell
   735						  JRST OCTIN1	; go back
   736					QQ:	msg < >	^
   737						MOVE M1,[POINT 7,[ASCIZ \ 	\]]
   738						PUSHJ P,CTYSO
   739				^; <BS><SP><BS>
   740						LSH T1,-3	; delete the char
   741	004037	254000	006301			JRST OCTIN1]
   742	004040	260400	003342		PUSHJ P,CTYOUT		; echo it
   743	004041	301540	000060		CAIL C,"0"		; is it a valid digit
   744	004042	303540	000067		 CAILE C,"7"
   745					  JRST [MOVEI C,7
   746						PUSHJ P,CTYOUT
   747						msg <? >^
   748						MOVE M1,[POINT 7,[ASCIZ \? \]]
   749						PUSHJ P,CTYSO
   750				^
   751	004043	254000	006313			JRST OCTIN]
   752	004044	242040	000003		LSH T1,3
   753	004045	271053	777720		ADDI T1,-"0"(C)		; add in this digit
   754	004046	254000	004025		JRST OCTIN1
   755
   756			000140	CHRCNT=140
   757					XLIST
   758					LIST
   759
   760	004207	201540	000007	.BEEP:	MOVEI C,7		; Ring bell to signify illegal command
   761	004210	260400	003342		PUSHJ P,CTYOUT
   762	004211	263400	000000		POPJ P,
   763
   764				define	BEEP (ADR) <		;; ring bell, complain and jump
   765				JRST [	PUSHJ P,.BEEP
   766					JRSTF ADR
   767				]>
   768
   769				define	CHRDEF (CH,ADR) <	;; call this to map a subroutine to
   770					LOC CHRTAB+ch		;; a particular command character
   771					JSR adr
   772					LOC >
   773
   774
   775				subttl	? Command - print help message
   776
   777				chrdef	"?",HELP^	
   778	004146	264000	004212		JSR HELP
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 15-3
DR.MAC	11-SEP-79 17:43		? Command - print help message

   779	004212	000000	000000	HELP:	Z
   780	004213	200640	006320		MOVE M1,[point 7,HLPMSG]; inform user of his fate
   781	004214	260400	003227		PUSHJ P,CTYSO		; type it all out
   782	004215	254120	004212		JRSTF @HELP
   783	004216			HLPMSG:	ASCIZ \
   784	004216	064251	767312	One of following...
	004217	203374	620314
	004220	677315	467756
	004221	647354	727134
   785	004222	270321	220100	  All (tests enable)
	004223	407315	420120
	004224	723136	372346
	004225	203135	660704
   786	004226	663125	106424	  Bits (in DR CSR) #
	004227	201010	264750
	004230	715005	064734
	004231	202112	220206
	004232	516445	120106
   787	004233	064244	020206	  Continue on error
	004234	677356	464734
	004235	727124	067734
	004236	203136	271336
   788	004237	710321	220100	  Device (logical no) #
	004240	423136	664706
	004241	625005	066336
	004242	637234	360730
	004243	203355	724500
   789	004244	214321	220100	  Error status is...
	004245	427456	267744
	004246	203476	460750
	004247	727464	064746
   790	004250	271345	606424	  Halt on error
	004251	201011	060730
	004252	721015	767100
	004253	627456	267744
   791	004254	064244	020230	  Loop on error
	004255	677376	020336
	004256	671014	571344
   792	004257	677441	505100	  Map devices
	004260	202334	170100
	004261	623136	664706
   793	004262	627461	505100	  Next test
	004263	202354	574350
	004264	203514	571750
   794	004265	064244	020240	  Pattern (16 bits) #
	004266	607516	462744
	004267	671005	030554
	004270	203055	172346
   795	004271	245004	306424	  Run (diagnostic)
	004272	201012	272734
	004273	201214	464702
	004274	637355	771750
   796	004275	647065	106424	  Stop (diagnostic)
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 15-4
DR.MAC	11-SEP-79 17:43		? Command - print help message

	004276	201012	372336
	004277	701005	062322
	004300	607175	667746
	004301	723234	324432
   797	004302	051004	050752	  Quiet (no messages)
	004303	647136	420120
	004304	673364	066712
	004305	717474	163712
   798	004306	715221	505100	  Verbose (messages)
	004307	202554	571304
	004310	677474	520120
	004311	667136	371702
	004312	637136	324432
   799	004313	051004	053720	  What is going on?
	004314	607504	064746
	004315	203175	764734
	004316	635015	767176
   800	004317	064244	020274	  ^C boot ten [confirm]
	004320	415014	267736
	004321	721016	462734
	004322	202674	367734
	004323	633236	266672
   801	004324	064244	020274	  ^Z ddt
	004325	551014	462350
   802	004326	064244	020176	  ?
   803	004327	064240	000000	\
   804
   805
   806				subttl	^C Command - boot ten
   807
   808				chrdef	"C"-100,%C.CMD^	
   809	004052	264000	004330		JSR %C.CMD
   810	004330	000000	000000	%C.CMD:	Z
   811					msg <^C boot ten [confirm]>^
   812	004331	200640	006326			MOVE M1,[POINT 7,[ASCIZ \^C boot ten [confirm]\]]
   813	004332	260400	003227			PUSHJ P,CTYSO
   814	004333	260400	003334		PUSHJ P,CTYIN
   815	004334	302540	000015		CAIE C,15
   816					  JRST [msg < XXX>^
   817						MOVE M1,[POINT 7,[ASCIZ \ XXX\]]
   818						PUSHJ P,CTYSO
   819				^
   820						msgnl^
   821						MOVE M1,[POINT 7,[BYTE (7)15,12]]
   822						PUSHJ P,CTYSO
   823				^
   824	004335	254000	006331			JRSTF @%C.CMD]
   825					msgnl^
   826	004336	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   827	004337	260400	003227			PUSHJ P,CTYSO
   828	004340	205000	020000		MOVSI (RLBOOT)		; bit to say "please reboot"
   829	004341	436000	000031		IORM RLWORD		; send to the 8080
   830	004342	700200	012000		WRAPR 12000		; knock on the door
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 15-5
DR.MAC	11-SEP-79 17:43		^C Command - boot ten

   831	004343	254200	004343		HALT .
   832
   833
   834				subttl	^Z Command - enter DDT at breakpoint or cold-start
   835
   836				chrdef	"Z"-100,%Z.CMD^	
   837	004101	264000	004344		JSR %Z.CMD
   838	004344	000000	000000	%Z.CMD:	Z
   839	004345	200040	006336		MOVE T1,[JRSTF @%Z.CMD]
   840	004346	312040	004347		CAME T1,%Z		; is a breakpoint set?
   841	004347	254120	004344	%Z:	  JRSTF @%Z.CMD		; should set a breakpoint here!
   842					msg <^Z DDT (%Z$G to return)>; no breakpoint - jrst to DDT
   843	004350	200640	006344			MOVE M1,[POINT 7,[ASCIZ \^Z DDT (%Z$G to return)\]]
   844	004351	260400	003227			PUSHJ P,CTYSO
   845	004352	254000	000000*		JRST DDT
   846
   847
   848				subttl	A Command - enable all tests
   849
   850				chrdef	"A",A.CMD^	
   851	004150	264000	004353		JSR A.CMD
   852	004353	000000	000000	A.CMD:	Z
   853					msg <All (tests enable)>^
   854	004354	200640	006351			MOVE M1,[POINT 7,[ASCIZ \All (tests enable)\]]
   855	004355	260400	003227			PUSHJ P,CTYSO
   856					msgnl^
   857	004356	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   858	004357	260400	003227			PUSHJ P,CTYSO
   859	004360	476000	005075		SETOM .TST		; enable all tests
   860	004361	254120	004353		JRSTF @A.CMD
   861
   862
   863				subttl 	B Command - set test to DR CSR bit N
   864
   865				chrdef	"B",B.CMD^	
   866	004151	264000	004362		JSR B.CMD
   867	004362	000000	000000	B.CMD:	Z
   868					msg <Bits (16 bits) >^
   869	004363	200640	006356			MOVE M1,[POINT 7,[ASCIZ \Bits (16 bits) \]]
   870	004364	260400	003227			PUSHJ P,CTYSO
   871	004365	260400	004024	B.CMD1:	PUSHJ P,OCTIN		; get bit pattern in T1
   872	004366	254120	004362		  JRSTF @B.CMD
   873	004367	201100	000017		MOVEI T2,17
   874	004370	554142	003670	B.C1:	HLRZ T3,CS.TAB(T2)	; get bits
   875	004371	316040	000003		CAMN T1,T3		; does it match?
   876	004372	254000	004414		  JRST B.C2		;   yes!
   877	004373	365100	004370		SOJGE T2,B.C1		; no - try next one
   878					msg <?invalid; bit patterns are:>^
   879	004374	200640	006365			MOVE M1,[POINT 7,[ASCIZ \?invalid; bit patterns are:\]]
   880	004375	260400	003227			PUSHJ P,CTYSO
   881					msgnl^
   882	004376	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   883	004377	260400	003227			PUSHJ P,CTYSO
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 15-6
DR.MAC	11-SEP-79 17:43		B Command - set test to DR CSR bit N

   884					msg <  >^
   885	004400	200640	006367			MOVE M1,[POINT 7,[ASCIZ \  \]]
   886	004401	260400	003227			PUSHJ P,CTYSO
   887	004402	201100	000017		MOVEI T2,17
   888	004403	554042	003670	B.C3:	HLRZ T1,CS.TAB(T2)
   889					msgoct T1^
   890	004404	200640	000001			MOVE M1,T1
   891	004405	260400	003237			PUSHJ P,CTYOO
   892					msg <,>^
   893	004406	200640	006371			MOVE M1,[POINT 7,[ASCIZ \,\]]
   894	004407	260400	003227			PUSHJ P,CTYSO
   895	004410	365100	004403		SOJGE T2,B.C3
   896					msgnl^
   897	004411	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   898	004412	260400	003227			PUSHJ P,CTYSO
   899	004413	254120	004362		JRSTF @B.CMD
   900	004414	202100	005075	B.C2:	MOVEM T2,.TST		; save test index
   901	004415	254120	004362		JRSTF @B.CMD
   902
   903
   904				subttl	C Command - continue on errors
   905
   906				chrdef	"C",C.CMD^	
   907	004152	264000	004416		JSR C.CMD
   908	004416	000000	000000	C.CMD:	Z
   909					msg <Continue on errors>^
   910	004417	200640	006376			MOVE M1,[POINT 7,[ASCIZ \Continue on errors\]]
   911	004420	260400	003227			PUSHJ P,CTYSO
   912					msgnl^
   913	004421	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   914	004422	260400	003227			PUSHJ P,CTYSO
   915	004423	201040	000002		MOVEI T1,2		; .SW code for CONTINUE on error
   916	004424	202040	005076		MOVEM T1,.SW		; save what to do for later
   917	004425	254120	004416		JRSTF @C.CMD
   918
   919
   920				subttl	D Command - set device to test
   921
   922				chrdef	"D",D.CMD^	
   923	004153	264000	004426		JSR D.CMD
   924	004426	000000	000000	D.CMD:	Z
   925					msg <Device (logical no) >^
   926	004427	200640	006404			MOVE M1,[POINT 7,[ASCIZ \Device (logical no) \]]
   927	004430	260400	003227			PUSHJ P,CTYSO
   928	004431	260400	004024	D.CMD1:	PUSHJ P,OCTIN		; get octal argument
   929	004432	254120	004426		  JRSTF @D.CMD		; ^U escape out of command
   930	004433	303040	000017		CAILE T1,DR.CNT-1	; test for in range
   931	004434	254000	004443		  JRST BADDEV		; out of range - beep
   932	004435	321040	004441		JUMPL T1,D.CMD2		; okay if [all]
   933	004436	200101	005026		MOVE T2,DR.ADR(T1)	; get base address
   934	004437	712102	000000		RDIO T2,(T2)		; does it exist?
   935	004440	320000	004443		JUMPT BADDEV		; does not exist
   936	004441	202040	005074	D.CMD2:	MOVEM T1,.DR		; save index of DR number
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 15-7
DR.MAC	11-SEP-79 17:43		D Command - set device to test

   937	004442	254000	003510		JRST NxtDR
   938	004443			BADDEV:	msg <?non-existant device>^
   939	004443	200640	006412			MOVE M1,[POINT 7,[ASCIZ \?non-existant device\]]
   940	004444	260400	003227			PUSHJ P,CTYSO
   941					msgnl^
   942	004445	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   943	004446	260400	003227			PUSHJ P,CTYSO
   944	004447	254120	004426		JRSTF @D.CMD
   945
   946
   947				subttl	E Command - display error status
   948
   949				chrdef	"E",E.CMD^	
   950	004154	264000	004450		JSR E.CMD
   951	004450	000000	000000	E.CMD:	Z			; display all error stuff for fun
   952					msg <Error status is...>^
   953	004451	200640	006417			MOVE M1,[POINT 7,[ASCIZ \Error status is...\]]
   954	004452	260400	003227			PUSHJ P,CTYSO
   955					msgnl^
   956	004453	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   957	004454	260400	003227			PUSHJ P,CTYSO
   958					msg <  PAT: count=>^
   959	004455	200640	006423			MOVE M1,[POINT 7,[ASCIZ \  PAT: count=\]]
   960	004456	260400	003227			PUSHJ P,CTYSO
   961					msgdec PATERR^
   962	004457	200640	005067			MOVE M1,PATERR
   963	004460	260400	003261			PUSHJ P,CTYDO; 
   964	004461	402000	005067		SETZM PATERR		; zero it
   965					msg <; mask=>^
   966	004462	200640	006235			MOVE M1,[POINT 7,[ASCIZ \; mask=\]]
   967	004463	260400	003227			PUSHJ P,CTYSO
   968					msgoct PATMSK^
   969	004464	200640	005072			MOVE M1,PATMSK
   970	004465	260400	003237			PUSHJ P,CTYOO
   971	004466	402000	005072		SETZM PATMSK
   972					msgnl^
   973	004467	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   974	004470	260400	003227			PUSHJ P,CTYSO
   975					msg <  BIT: count=>^
   976	004471	200640	006427			MOVE M1,[POINT 7,[ASCIZ \  BIT: count=\]]
   977	004472	260400	003227			PUSHJ P,CTYSO
   978					msgdec CSRERR^
   979	004473	200640	005070			MOVE M1,CSRERR
   980	004474	260400	003261			PUSHJ P,CTYDO; 
   981	004475	402000	005070		SETZM CSRERR		; zero them all!
   982					msg <; mask=>^
   983	004476	200640	006235			MOVE M1,[POINT 7,[ASCIZ \; mask=\]]
   984	004477	260400	003227			PUSHJ P,CTYSO
   985					msgbit CSRMSK^
   986	004500	200640	005073			MOVE M1,CSRMSK
   987	004501	260400	003233			PUSHJ P,CTYBO
   988	004502	402000	005073		SETZM CSRMSK
   989					msgnl^
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 15-8
DR.MAC	11-SEP-79 17:43		E Command - display error status

   990	004503	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
   991	004504	260400	003227			PUSHJ P,CTYSO
   992					msg <  TRP: count=>^
   993	004505	200640	006433			MOVE M1,[POINT 7,[ASCIZ \  TRP: count=\]]
   994	004506	260400	003227			PUSHJ P,CTYSO
   995					msgdec TRPERR^
   996	004507	200640	005071			MOVE M1,TRPERR
   997	004510	260400	003261			PUSHJ P,CTYDO; 
   998	004511	402000	005071		SETZM TRPERR		; zero them!
   999					msgnl^
  1000	004512	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1001	004513	260400	003227			PUSHJ P,CTYSO
  1002	004514	254120	004450		JRSTF @E.CMD
  1003
  1004
  1005				subttl	F Command - set Fast loop (hardware maint cable)
  1006
  1007				chrdef	"F",F.CMD		; Not available
  1008	004155	264000	004515		JSR F.CMD		
  1009	004515	000000	000000	F.CMD:	Z
  1010					msg <Fast (hard loop)>^
  1011	004516	200640	006440			MOVE M1,[POINT 7,[ASCIZ \Fast (hard loop)\]]
  1012	004517	260400	003227			PUSHJ P,CTYSO
  1013					msgnl^
  1014	004520	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1015	004521	260400	003227			PUSHJ P,CTYSO
  1016	004522	402000	005100		SETZM .TIME		; # time loop for good data
  1017	004523	254120	004515		JRSTF @F.CMD
  1018
  1019
  1020				subttl	H Command - set Halt on Error
  1021
  1022				chrdef	"H",H.CMD^	
  1023	004157	264000	004524		JSR H.CMD
  1024	004524	000000	000000	H.CMD:	Z
  1025					msg <Halt on error>^
  1026	004525	200640	006444			MOVE M1,[POINT 7,[ASCIZ \Halt on error\]]
  1027	004526	260400	003227			PUSHJ P,CTYSO
  1028					msgnl^
  1029	004527	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1030	004530	260400	003227			PUSHJ P,CTYSO
  1031	004531	201040	000001		MOVEI T1,1		; .SW code for HALT
  1032	004532	202040	005076		MOVEM T1,.SW		; save flag for later
  1033	004533	254120	004524		JRSTF @H.CMD
  1034
  1035
  1036				subttl	L Command - set Loop on Error
  1037
  1038				chrdef	"L",L.CMD^	
  1039	004163	264000	004534		JSR L.CMD
  1040	004534	000000	000000	L.CMD:	Z
  1041					msg <Loop on errors>^
  1042	004535	200640	006450			MOVE M1,[POINT 7,[ASCIZ \Loop on errors\]]
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 15-9
DR.MAC	11-SEP-79 17:43		L Command - set Loop on Error

  1043	004536	260400	003227			PUSHJ P,CTYSO
  1044					msgnl^
  1045	004537	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1046	004540	260400	003227			PUSHJ P,CTYSO
  1047	004541	201040	000000		MOVEI T1,0		; .SW code for LOOP on errors
  1048	004542	202040	005076		MOVEM T1,.SW
  1049	004543	254120	004534		JRSTF @L.CMD
  1050
  1051
  1052				subttl	M Command - display map of existing DRs
  1053
  1054				chrdef	"M",M.CMD^	
  1055	004164	264000	004544		JSR M.CMD
  1056	004544	000000	000000	M.CMD:	Z
  1057					msg <Map DR11C's:>^
  1058	004545	200640	006454			MOVE M1,[POINT 7,[ASCIZ \Map DR11C's:\]]
  1059	004546	260400	003227			PUSHJ P,CTYSO
  1060					msgnl^
  1061	004547	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1062	004550	260400	003227			PUSHJ P,CTYSO
  1063	004551	201040	000017		MOVEI T1,DR.CNT-1	; DR counter
  1064	004552	200101	005026	M.CMD1:	MOVE T2,DR.ADR(T1)	; get DR base address
  1065	004553	712102	000000		RDIO T2,DRCSR(T2)	; try to read CSR
  1066	004554	320000	004573		JUMPT M.CMD2		; did it time out?
  1067					msg <  DR>^
  1068	004555	200640	006456			MOVE M1,[POINT 7,[ASCIZ \  DR\]]
  1069	004556	260400	003227			PUSHJ P,CTYSO
  1070					msgoct T1		; DR number
  1071	004557	200640	000001			MOVE M1,T1		
  1072	004560	260400	003237			PUSHJ P,CTYOO
  1073					msg <: adr=>^
  1074	004561	200640	006461			MOVE M1,[POINT 7,[ASCIZ \: adr=\]]
  1075	004562	260400	003227			PUSHJ P,CTYSO
  1076					msgoct DR.ADR(T1)	; type UBA address
  1077	004563	200641	005026			MOVE M1,DR.ADR(T1)	
  1078	004564	260400	003237			PUSHJ P,CTYOO
  1079					msg < vec=>^
  1080	004565	200640	006464			MOVE M1,[POINT 7,[ASCIZ \ vec=\]]
  1081	004566	260400	003227			PUSHJ P,CTYSO
  1082					msgoct DR.VEC(T1)	; type vector address
  1083	004567	200641	005046			MOVE M1,DR.VEC(T1)	
  1084	004570	260400	003237			PUSHJ P,CTYOO
  1085					msgnl^
  1086	004571	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1087	004572	260400	003227			PUSHJ P,CTYSO
  1088	004573	365040	004552	M.CMD2:	SOJGE T1,M.CMD1		; try next DR
  1089	004574	254120	004544		JRSTF @M.CMD
  1090
  1091
  1092				subttl	N Command - go to next test pattern
  1093
  1094				chrdef	"N",N.CMD^	
  1095	004165	264000	004575		JSR N.CMD
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 15-10
DR.MAC	11-SEP-79 17:43		N Command - go to next test pattern

  1096	004575	000000	000000	N.CMD:	Z
  1097	004576	336000	003420		SKIPN RUNFLG		; legal only if running
  1098					  beep @N.CMD^		
  1099	004577	254000	006465	]^
  1100					msg <Next test>^
  1101	004600	200640	006471			MOVE M1,[POINT 7,[ASCIZ \Next test\]]
  1102	004601	260400	003227			PUSHJ P,CTYSO
  1103					msgnl^
  1104	004602	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1105	004603	260400	003227			PUSHJ P,CTYSO
  1106	004604	335040	005075		SKIPGE T1,.TST
  1107	004605	254000	003553		  JRST NxtTst
  1108	004606	350000	000001		AOS T1
  1109	004607	231040	200020		IDIVI T1,200020
  1110	004610	202100	005075		MOVEM T2,.TST
  1111	004611	254000	003553		JRST NxtTst
  1112
  1113
  1114				subttl	P Command - set pattern for test
  1115
  1116				chrdef	"P",P.CMD^	
  1117	004167	264000	004612		JSR P.CMD
  1118	004612	000000	000000	P.CMD:	Z
  1119					msg <Pattern (16 bits) >^
  1120	004613	200640	006476			MOVE M1,[POINT 7,[ASCIZ \Pattern (16 bits) \]]
  1121	004614	260400	003227			PUSHJ P,CTYSO
  1122	004615	260400	004024		PUSHJ P,OCTIN		; get octal argument
  1123	004616	254120	004612		  JRSTF @P.CMD		; abort with ^U
  1124	004617	202040	005075		MOVEM T1,.TST		; don't bother checking bounds
  1125	004620	254120	004612		JRSTF @P.CMD
  1126
  1127
  1128				subttl	Q Command - set quiet - no messages
  1129
  1130				chrdef	"Q",Q.CMD^	
  1131	004170	264000	004621		JSR Q.CMD
  1132	004621	000000	000000	Q.CMD:	Z
  1133					msg <Quiet (no messages)>^
  1134	004622	200640	006503			MOVE M1,[POINT 7,[ASCIZ \Quiet (no messages)\]]
  1135	004623	260400	003227			PUSHJ P,CTYSO
  1136					msgnl^
  1137	004624	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1138	004625	260400	003227			PUSHJ P,CTYSO
  1139	004626	476000	005077		SETOM .QUIET		; make it quiet
  1140	004627	254120	004621		JRSTF @Q.CMD
  1141
  1142				subttl	R Command - Run
  1143
  1144				chrdef	"R",R.CMD^	
  1145	004171	264000	004630		JSR R.CMD
  1146	004630	000000	000000	R.CMD:	Z
  1147	004631	332000	003420		SKIPE RUNFLG
  1148					  beep @R.CMD^		
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 15-11
DR.MAC	11-SEP-79 17:43		R Command - Run

  1149	004632	254000	006504	]^
  1150					msg <Run (diagnostic)>^
  1151	004633	200640	006512			MOVE M1,[POINT 7,[ASCIZ \Run (diagnostic)\]]
  1152	004634	260400	003227			PUSHJ P,CTYSO
  1153					msgnl^
  1154	004635	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1155	004636	260400	003227			PUSHJ P,CTYSO
  1156	004637	476000	003420		SETOM RUNFLG
  1157	004640	254120	004630		JRSTF @R.CMD
  1158
  1159
  1160				subttl	S Command - Stop
  1161
  1162				chrdef	"S",S.CMD^	
  1163	004172	264000	004641		JSR S.CMD
  1164	004641	000000	000000	S.CMD:	Z
  1165	004642	336000	003420		SKIPN RUNFLG
  1166					  beep @S.CMD^		
  1167	004643	254000	006513	]^
  1168					msg <Stop (diagnostic)>^
  1169	004644	200640	006521			MOVE M1,[POINT 7,[ASCIZ \Stop (diagnostic)\]]
  1170	004645	260400	003227			PUSHJ P,CTYSO
  1171					msgnl^
  1172	004646	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1173	004647	260400	003227			PUSHJ P,CTYSO
  1174	004650	402000	003420		SETZM RUNFLG
  1175	004651	254120	004641		JRSTF @S.CMD
  1176
  1177
  1178				subttl	U Command - set unfast loopback (PDP-11 echo)
  1179
  1180				chrdef	"U",U.CMD^	
  1181	004174	264000	004652		JSR U.CMD
  1182	004652	000000	000000	U.CMD:	Z
  1183					msg <Unfast (soft loopback)>^
  1184	004653	200640	006527			MOVE M1,[POINT 7,[ASCIZ \Unfast (soft loopback)\]]
  1185	004654	260400	003227			PUSHJ P,CTYSO
  1186					msgnl^
  1187	004655	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1188	004656	260400	003227			PUSHJ P,CTYSO
  1189	004657	200040	004662		MOVE T1,U.TAB		; get count for soft loopback
  1190	004660	202040	005100		MOVEM T1,.TIME
  1191	004661	254120	004652		JRSTF @U.CMD
  1192	004662	000000	001000	U.TAB:	1000			; #loops to do waiting for data
  1193
  1194
  1195				subttl	V Command - set verbose - print messages
  1196
  1197				chrdef	"V",V.CMD^	
  1198	004175	264000	004663		JSR V.CMD
  1199	004663	000000	000000	V.CMD:	Z
  1200					msg <Verbose (messages)>^
  1201	004664	200640	006534			MOVE M1,[POINT 7,[ASCIZ \Verbose (messages)\]]
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 15-12
DR.MAC	11-SEP-79 17:43		V Command - set verbose - print messages

  1202	004665	260400	003227			PUSHJ P,CTYSO
  1203					msgnl^
  1204	004666	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1205	004667	260400	003227			PUSHJ P,CTYSO
  1206	004670	402000	005077		SETZM .QUIET		; make it noisy
  1207	004671	254120	004663		JRSTF @V.CMD
  1208
  1209
  1210				subttl	W Command - explain what is going on
  1211
  1212				chrdef	"W",W.CMD^	
  1213	004176	264000	004672		JSR W.CMD
  1214	004672	000000	000000	W.CMD:	Z
  1215					msg <What (is going on?)>^
  1216	004673	200640	006541			MOVE M1,[POINT 7,[ASCIZ \What (is going on?)\]]
  1217	004674	260400	003227			PUSHJ P,CTYSO
  1218					msgnl^
  1219	004675	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1220	004676	260400	003227			PUSHJ P,CTYSO
  1221
  1222				define	J.MSG (adr,txt) <
  1223					JRST   [msg <txt>
  1224						msgnl
  1225						JRST adr]
  1226					W.ADR==adr
  1227				>
  1228				define	W.MSG (txt) <
  1229					JRST   [msg <txt>
  1230						msgnl
  1231						JRST W.ADR]
  1232				>
  1233				define	w.dsp (var,msg) <
  1234					W.ADR==E'var
  1235					MOVE T1,var
  1236					ANDI T1,77777		; only right 15 bits
  1237					CAIL T1,E'var-B'var
  1238					  w.msg <msg>
  1239					JRST B'var(T1)
  1240				>
  1241
  1242					w.dsp RUNFLG,<  Run (diagnostic)>^
  1243	004677	200040	003420		MOVE T1,RUNFLG
  1244	004700	405040	077777		ANDI T1,77777		; only right 15 bits
  1245	004701	301040	000001		CAIL T1,ERUNFLG-BRUNFLG
  1246	004702	254000	006547			JRST W.ADR]
  1247	004703	254001	004704		JRST BRUNFLG(T1)
  1248	004704			BRUNFL:	w.msg <  Stop (diagnostic)>^
  1249	004704	254000	006561			JRST W.ADR]
  1250	004705			ERUNFL:
  1251					w.dsp .SW,<?? illegal .SW ??>^
  1252	004705	200040	005076		MOVE T1,.SW
  1253	004706	405040	077777		ANDI T1,77777		; only right 15 bits
  1254	004707	301040	000003		CAIL T1,E.SW-B.SW
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 15-13
DR.MAC	11-SEP-79 17:43		W Command - explain what is going on

  1255	004710	254000	006573			JRST W.ADR]
  1256	004711	254001	004712		JRST B.SW(T1)
  1257	004712			B.SW:	w.msg <  Loop on error>^
  1258	004712	254000	006605			JRST W.ADR]
  1259					w.msg <  Halt on error>^
  1260	004713	254000	006617			JRST W.ADR]
  1261					w.msg <  Continue on error>^
  1262	004714	254000	006631			JRST W.ADR]
  1263	004715			E.SW:	
  1264					w.dsp .QUIET,<  Quiet (no messages)>^
  1265	004715	200040	005077		MOVE T1,.QUIET
  1266	004716	405040	077777		ANDI T1,77777		; only right 15 bits
  1267	004717	301040	000001		CAIL T1,E.QUIET-B.QUIET
  1268	004720	254000	006644			JRST W.ADR]
  1269	004721	254001	004722		JRST B.QUIET(T1)
  1270	004722			B.QUIE:	w.msg <  Verbose (messages)>^
  1271	004722	254000	006657			JRST W.ADR]
  1272	004723			E.QUIE:
  1273	004723	332000	005100		SKIPE .TIME
  1274					  j.msg E.TIME,<  Unfast (soft loopback)>^
  1275	004724	254000	006672			JRST E.TIME]
  1276	004725			E.TIME:	
  1277	004725	335000	005074		SKIPGE .DR		; all enabled?
  1278	004726	254000	004736		  JRST .DR1		;   yes
  1279					msg <  Device (logical no) >^
  1280	004727	200640	006704			MOVE M1,[POINT 7,[ASCIZ \  Device (logical no) \]]
  1281	004730	260400	003227			PUSHJ P,CTYSO
  1282					msgoct .DR^
  1283	004731	200640	005074			MOVE M1,.DR
  1284	004732	260400	003237			PUSHJ P,CTYOO
  1285					msgnl^
  1286	004733	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1287	004734	260400	003227			PUSHJ P,CTYSO
  1288	004735	254000	004754		JRST E.DR
  1289	004736			.DR1:	msg <  Device (logical no) [all]>^
  1290	004736	200640	006713			MOVE M1,[POINT 7,[ASCIZ \  Device (logical no) [all]\]]
  1291	004737	260400	003227			PUSHJ P,CTYSO
  1292					msgnl^
  1293	004740	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1294	004741	260400	003227			PUSHJ P,CTYSO
  1295	004742	335000	000012		SKIPGE DR		; is it a valid DR number?
  1296	004743	254000	004754		  JRST E.DR		;   no
  1297					msg <  Current device is DR>^
  1298	004744	200640	006721			MOVE M1,[POINT 7,[ASCIZ \  Current device is DR\]]
  1299	004745	260400	003227			PUSHJ P,CTYSO
  1300					msgoct DR^
  1301	004746	200640	000012			MOVE M1,DR
  1302	004747	260400	003237			PUSHJ P,CTYOO
  1303					msg <:>^
  1304	004750	200640	006213			MOVE M1,[POINT 7,[ASCIZ \:\]]
  1305	004751	260400	003227			PUSHJ P,CTYSO
  1306					msgnl^
  1307	004752	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 15-14
DR.MAC	11-SEP-79 17:43		W Command - explain what is going on

  1308	004753	260400	003227			PUSHJ P,CTYSO
  1309	004754			E.DR:
  1310	004754	335040	005075		SKIPGE T1,.TST		; are all tests enabled?
  1311	004755	254000	004777		  JRST .TST1		;   yes
  1312	004756	622040	200000		TRZE T1,200000		; is it a pattern?
  1313	004757	254000	004767		  JRST .TST2		;   no - its bits
  1314					msg <  Pattern (16 bits) >^
  1315	004760	200640	006727			MOVE M1,[POINT 7,[ASCIZ \  Pattern (16 bits) \]]
  1316	004761	260400	003227			PUSHJ P,CTYSO
  1317					msgoct T1^
  1318	004762	200640	000001			MOVE M1,T1
  1319	004763	260400	003237			PUSHJ P,CTYOO
  1320					msgnl^
  1321	004764	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1322	004765	260400	003227			PUSHJ P,CTYSO
  1323	004766	254000	005025		JRST E.TST
  1324	004767			.TST2:	msg <  Bits (in CSR) >^
  1325	004767	200640	006734			MOVE M1,[POINT 7,[ASCIZ \  Bits (in CSR) \]]
  1326	004770	260400	003227			PUSHJ P,CTYSO
  1327	004771	554041	003670		HLRZ T1,CS.TAB(T1)	; lookup bit pattern from tst #
  1328					msgoct T1^
  1329	004772	200640	000001			MOVE M1,T1
  1330	004773	260400	003237			PUSHJ P,CTYOO
  1331					msgnl^
  1332	004774	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1333	004775	260400	003227			PUSHJ P,CTYSO
  1334	004776	254000	005025		JRST E.TST
  1335	004777			.TST1:	msg <  All (tests enable)>^
  1336	004777	200640	006742			MOVE M1,[POINT 7,[ASCIZ \  All (tests enable)\]]
  1337	005000	260400	003227			PUSHJ P,CTYSO
  1338					msgnl^
  1339	005001	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1340	005002	260400	003227			PUSHJ P,CTYSO
  1341	005003	335040	000007		SKIPGE T1,TST		; is current test defined?
  1342	005004	254000	005025		  JRST E.TST		;   no - don't mention it
  1343	005005	622040	200000		TRZE T1,200000		; is it a pattern?
  1344	005006	254000	005016		  JRST .TST3		;   no - its bits
  1345					msg <  Current test is PAT: >^
  1346	005007	200640	006750			MOVE M1,[POINT 7,[ASCIZ \  Current test is PAT: \]]
  1347	005010	260400	003227			PUSHJ P,CTYSO
  1348					msgoct T1^
  1349	005011	200640	000001			MOVE M1,T1
  1350	005012	260400	003237			PUSHJ P,CTYOO
  1351					msgnl^
  1352	005013	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1353	005014	260400	003227			PUSHJ P,CTYSO
  1354	005015	254000	005025		JRST E.TST
  1355	005016			.TST3:	msg <  Current test is BIT: >^
  1356	005016	200640	006756			MOVE M1,[POINT 7,[ASCIZ \  Current test is BIT: \]]
  1357	005017	260400	003227			PUSHJ P,CTYSO
  1358	005020	554041	003670		HLRZ T1,CS.TAB(T1)	; lookup bit pattern from tst #
  1359					msgoct T1^
  1360	005021	200640	000001			MOVE M1,T1
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 15-15
DR.MAC	11-SEP-79 17:43		W Command - explain what is going on

  1361	005022	260400	003237			PUSHJ P,CTYOO
  1362					msgnl^
  1363	005023	200640	006102			MOVE M1,[POINT 7,[BYTE (7)15,12]]
  1364	005024	260400	003227			PUSHJ P,CTYSO
  1365	005025			E.TST:	
  1366
  1367	005025	254120	004672		JRSTF @W.CMD		; return
  1368
  1369
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 16
DR.MAC	11-SEP-79 17:43		miscellaneous storage locations

  1370				SUBTTL	miscellaneous storage locations
  1371
  1372			767770	%DRA==	767770			; address of first DR
  1373			000300	%DRV==	300			; vector of first DR
  1374			000020	DR.CNT==^D16			; maximum number of DR's
  1375				DR.ADR:	repeat DR.CNT,<		;; UB addresses of DR's
  1376					XWD 3,%DRA
  1377					%DRA==%DRA-10
  1378					XLIST>
  1379						;; UB addresses of DR's
  1380	005026	000003	767770		XWD 3,%DRA
  1381			767760		%DRA==%DRA-10
  1382					XLIST
  1383					LIST
  1384				DR.VEC:	repeat DR.CNT,<		;; vector addresses of DR's
  1385					XWD 0,%DRV
  1386					%DRV==%DRV+10
  1387					XLIST>
  1388						;; vector addresses of DR's
  1389	005046	000000	000300		XWD 0,%DRV
  1390			000310		%DRV==%DRV+10
  1391					XLIST
  1392					LIST
  1393
  1394		777777	777777	ALL==	-1
  1395
  1396	005066	000000	000000	INTFLG:	Z			; gets bits set when interrupts occur
  1397	005067	000000	000000	PATERR:	Z			; count of pattern errors
  1398	005070	000000	000000	CSRERR:	Z			; count of bit R/W errors
  1399	005071	000000	000000	TRPERR:	Z			; count of unexpected trap errors
  1400	005072	000000	000000	PATMSK:	Z			; mask of pattern errors
  1401	005073	000000	000000	CSRMSK:	Z			; mask of bit R/W errors
  1402
  1403	005074	777777	777777	.DR:	ALL			; DR index number (or ALL)
  1404	005075	777777	777777	.TST:	ALL			; test number (or ALL)
  1405					; 0..177777		; R/W pattern test
  1406					; 200000..200017	; CSR bit R/W test
  1407					; 200020		; test after last
  1408	005076	000000	000000	.SW:	0			; switches
  1409					; 0 = loop on error
  1410					; 1 = halt on error
  1411					; 2 = continue on error
  1412	005077	000000	000000	.QUIET:	0			; 0=loud,#0=quiet
  1413	005100	000000	000000	.TIME:	0			; # time to loop waiting for data
  1414
  1415
  1416
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 17
DR.MAC	11-SEP-79 17:43		miscellaneous storage locations

  1417			003423	END	START
  1418
NO ERRORS DETECTED
PROGRAM BREAK IS 000000
ABSLUTE BREAK IS 006757
6K CORE USED
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 18
DR.MAC	11-SEP-79 17:43		SYMBOL TABLE

A		000011		CTYSO		003227		LI.CO4		000010	SPD	M2		000016	
A.CMD		004353		D		000014		LI.CO5		000004	SPD	N.CMD		004575	
ALL	777777	777777	SPD	D.CMD		004426		LI.CO6		000002	SPD	NDR1		003536	
APRID	700000	000000		D.CMD1		004431		LI.CO7		000001	SPD	NXTDR		003510	
APRSER		077777	SPD	D.CMD2		004441		LI.COF		001000	SPD	NXTTST		003553	
B		000004		DDT		004352	EXT	LI.CON		002000	SPD	OCTER		004023	
B.C1		004370		DISP		004017		LI.CPP		020000	SPD	OCTIN		004024	
B.C2		004414		DOTEST		003557		LI.CPS		010000	SPD	OCTIN1		004025	
B.C3		004403		DR		000012		LI.IP1		040000	SPD	ORG		003000	SPD
B.CMD		004362		DR.ADR		005026		LI.IP2		020000	SPD	P		000010	
B.CMD1		004365		DR.CNT		000020	SPD	LI.IP3		010000	SPD	P.CMD		004612	
B.QUIE		004722		DR.VEC		005046		LI.IP4		004000	SPD	PAGFA1		003325	
B.SW		004712		DRCSR		000000	SPD	LI.IP5		002000	SPD	PAGFAL		003277	
BADDEV		004443		DRFAIL		003466		LI.IP6		001000	SPD	PAGOPC		001501	SPD
BADTR1		003225		DRIB		000004	SPD	LI.IP7		000400	SPD	PATERR		005067	
BADTRP		003206		DROB		000002	SPD	LI.IPA		077400	SPD	PATMSK		005072	
BCIO	715000	000000		E.CMD		004450		LI.PIA		000200	SPD	PAUSE		003564	
BCIOB	725000	000000		E.DR		004754		LI.PIF		000400	SPD	PDL		003360	
BITA		000001	SPD	E.QUIE		004723		LI.PIN		000200	SPD	PDLOV		003271	
BITB		000002	SPD	E.SW		004715		LI.PR1	000100	000000	SPD	PFW		001500	SPD
BRUNFL		004704		E.TIME		004725		LI.PR2	000040	000000	SPD	PXCT	256000	000000	
BSIO	714000	000000		E.TST		005025		LI.PR3	000020	000000	SPD	Q.CMD		004621	
BSIOB	724000	000000		ENBA		000100	SPD	LI.PR4	000010	000000	SPD	QQ		006277	
C		000013		ENBB		000040	SPD	LI.PR5	000004	000000	SPD	R.CMD		004630	
C.CMD		004416		EPT		001000	SPD	LI.PR6	000002	000000	SPD	RDAPR	700240	000000	
CHRCNT		000140		ERRCNT		003422		LI.PR7	000001	000000	SPD	RDEBR	701240	000000	
CHRTAB		004047		ERUNFL		004705		LI.REQ		004000	SPD	RDINT	702240	000000	
CLRPT	701100	000000		EXPECT		003421		LP.80C		000020	SPD	RDIO	712000	000000	
COL1		003341		F.CMD		004515		LP.80E	000020	000000	SPD	RDIOB	722000	000000	
CP		004007		H.CMD		004524		LP.80I		000020	SPD	RDPI	700640	000000	
CP1		004020		HELP		004212		LP.CSF		020000	SPD	RDTIME	702200	000000	
CS.TAB		003670		HLPMSG		004216		LP.DSF		040000	SPD	RDUBR	701040	000000	
CS1		003777		I		000005		LP.ESF		100000	SPD	REQA		000200	SPD
CS2		003747		I1		000006		LP.HEE	000200	000000	SPD	REQB		100000	SPD
CSOKAY		004006		INTA		200000	SPD	LP.HPE		000200	SPD	RLACT	010000	000000	SPD
CSRERR		005070		INTB		400000	SPD	LP.I8C		002000	SPD	RLALIV		177400	SPD
CSRMSK		005073		INTFLG		005066		LP.INT		000010	SPD	RLBOOT	020000	000000	SPD
CSTEST		003710		JUMPT	320000	000000		LP.IOR		200000	SPD	RLWORD		000031	SPD
CSTRY		003715		KPALVE		000033	SPD	LP.ITD		000040	SPD	RUNFLG		003420	
CTYBO		003233		KPALVL		000010	SPD	LP.ITE	000040	000000	SPD	RW1		003660	
CTYDO		003261		L.CMD		004534		LP.NEE	000400	000000	SPD	RW2		003626	
CTYHO		003251		LG.CAC	007000	000000	SPD	LP.NXM		000400	SPD	RWOKAY		003667	
CTYICH		000377	SPD	LG.EPT		003777	SPD	LP.PFE	001000	000000	SPD	RWTEST		003571	
CTYIN		003334		LG.KLP		040000	SPD	LP.PIA		000007	SPD	RWTRY		003575	
CTYIVL		000400	SPD	LG.LAB	400000	000000	SPD	LP.PWF		001000	SPD	S.CMD		004641	
CTYIWD		000032	SPD	LG.LUB	100000	000000	SPD	LP.SEE	000100	000000	SPD	ST1		003441	
CTYOCH		000377	SPD	LG.PAC	000700	000000	SPD	LP.SPE		000100	SPD	START		003423	
CTYOO		003237		LG.TEN		020000	SPD	LP.SSF		010000	SPD	T1		000001	
CTYOO1		003245		LG.UPT		003777	SPD	LP.TIM		000040	SPD	T2		000002	
CTYOUT		003342		LI.ACO		000177	SPD	M.CMD		004544		T3		000003	
CTYOVL		000400	SPD	LI.CO1		000100	SPD	M.CMD1		004552		TIOE	710000	000000	
CTYOWD		000033	SPD	LI.CO2		000040	SPD	M.CMD2		004573		TIOEB	720000	000000	
CTYSIC		003331		LI.CO3		000020	SPD	M1		000015		TION	711000	000000	
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79 PAGE 18-2
DR.MAC	11-SEP-79 17:43		SYMBOL TABLE

TIONB	721000	000000		
TRP		002000	SPD	
TRPADR		000177	SPD	
TRPCNT		000200		
TRPERR		005071		
TRPOPC		003200		
TRPSER		003201		
TRPTAB		003000		
TST		000007		
U.CMD		004652		
U.TAB		004662		
UMOVE	704000	000000		
UMOVEM	705000	000000		
V.CMD		004663		
W.ADR		004725	SPD	
W.CMD		004672		
WRADB	255000	000000		
WRAPR	700200	000000		
WREBR	701200	000000		
WRINT	702640	000000		
WRIO	713000	000000		
WRIOB	723000	000000		
WRPI	700600	000000		
WRTIME	702600	000000		
WRUBR	701140	000000		
%C.CMD		004330		
%DRA		767570	SPD	
%DRV		000500	SPD	
%H1		003666		
%H2		004005		
%Z		004347		
%Z.CMD		004344		
.BEEP		004207		
.DR		005074		
.DR1		004736		
.QUIET		005077		
.SW		005076		
.TIME		005100		
.TST		005075		
.TST1		004777		
.TST2		004767		

DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79
DR.MAC	11-SEP-79 17:43		Symbol cross reference

A	    28#	   467	   470	   471	   474	   499	   511	   518	   597	   598	   599	   602	   627	   646
A.CMD	   851	   852#	   860
ALL	  1394#	  1403	  1404
APRSER	    44#
B	    23#	   331	   332	   392	   393	   416	   465	   466	   469	   593	   595	   597
B.C1	   874#	   877
B.C2	   876	   900#
B.C3	   888#	   895
B.CMD	   866	   867#	   872	   899	   901
B.CMD1	   871#
B.QUIE	  1267	  1269	  1270#
B.SW	  1254	  1256	  1257#
BADDEV	   931	   935	   938#
BADTR1	   139	   156#
BADTRP	   133	   137#
BITA	   565#	   570	   572	   574	   576	   578	   580	   582	   584
BITB	   566#	   571	   572	   575	   576	   579	   580	   583	   584
BRUNFL	  1245	  1247	  1248#
C	    30#	   141	   154	   162	   163	   204	   214	   244	   263	   277	   280	   286	   291	   293
	   296	   297	   301	   688	   689	   690	   698	   710	   712	   719	   729	   743	   744	   745
	   753	   760	   815
C.CMD	   907	   908#	   917
CHRCNT	   756#	   758
CHRTAB	   690	   758#	   778	   809	   837	   851	   866	   907	   923	   950	  1008	  1023	  1039	  1055
	  1095	  1117	  1131	  1145	  1163	  1181	  1198	  1213
COL1	   283#	   287	   289	   292
CP	   357	   385	   414	   428	   464	   591	   681#	   692	   693
CP1	   683	   691#
CS.TAB	   569#	   588	   589	   874	   888	  1327	  1358
CS1	   603	   629	   655	   660#
CS2	   606	   609	   624#
CSOKAY	   625	   661	   670#
CSRERR	   351	   664	   979	   981	  1398#
CSRMSK	   354	   601	   986	   988	  1401#
CSTEST	   435	   586#
CSTRY	   591#	   666
CTYBO	   167#	   641	   647	   653	   987
CTYDO	   208#	   212	   487	   615	   963	   980	   997
CTYHO	   189	   194	   198#	   202
CTYICH	    44#
CTYIN	   277#	   687	   697	   814
CTYIVL	    44#
CTYIWD	    44#	   273	   277	   279	   321
CTYOCH	    44#
CTYOO	   150	   185#	   227	   253	   259	   371	   407	   507	   514	   521	   527	   635	   891	   970
	  1072	  1078	  1084	  1284	  1302	  1319	  1330	  1350	  1361
CTYOO1	   188	   193#
CTYOUT	   164	   205	   215	   285#	   742	   746	   761
CTYOVL	    44#	   296
CTYOWD	    44#	   294	   297	   299	   320
CTYSIC	   273#	   682
CTYSO	   144	   147	   153	   161#	   165	   172	   180	   192	   224	   247	   250	   256	   262	   338
	   341	   344	   365	   368	   374	   377	   380	   383	   401	   404	   410	   413	   484	   490
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79
DR.MAC	11-SEP-79 17:43		Symbol cross reference

	   493	   504	   510	   517	   524	   532	   612	   618	   621	   632	   638	   644	   650	   658	   686
	   701	   705	   715	   722	   726	   733	   738	   749	   781	   813	   818	   822	   827	   844
	   855	   858	   870	   880	   883	   886	   894	   898	   911	   914	   927	   940	   943	   954
	   957	   960	   967	   974	   977	   984	   991	   994	  1001	  1012	  1015	  1027	  1030	  1043
	  1046	  1059	  1062	  1069	  1075	  1081	  1087	  1102	  1105	  1121	  1135	  1138	  1152	  1155
	  1170	  1173	  1185	  1188	  1202	  1205	  1217	  1220	  1246	  1249	  1255	  1258	  1260	  1262
	  1268	  1271	  1275	  1281	  1287	  1291	  1294	  1299	  1305	  1308	  1316	  1322	  1326	  1333
	  1337	  1340	  1347	  1353	  1357	  1364
D	    31#
D.CMD	   923	   924#	   929	   944
D.CMD1	   928#
D.CMD2	   932	   936#
DDT	   306%	   845
DISP	   690#
DOTEST	   432#
DR	    29#	   346	   389	   391	   392	   395	   406	   420	  1295	  1301
DR.ADR	   331	   392	   933	  1064	  1077	  1375#
DR.CNT	   329	   390	   930	  1063	  1374#	  1375	  1384
DR.VEC	   420	  1083	  1384#
DRCSR	    37#	   332	   393	   416	   593	   595	   597	  1065
DRFAIL	   361#	   394
DRIB	    39#	   469
DROB	    38#	   465	   466
E.CMD	   950	   951#	  1002
E.DR	  1288	  1296	  1309#
E.QUIE	  1265	  1267	  1272#
E.SW	  1252	  1254	  1263#
E.TIME	  1275	  1276	  1276#
E.TST	  1323	  1334	  1342	  1354	  1365#
ENBA	   563#	   573	   574	   575	   576	   581	   582	   583	   584
ENBB	   564#	   577	   578	   579	   580	   581	   582	   583	   584
EPT	    47#	    48	    76	    79	    82	    85	    89	   230	   231	   323	   324
ERRCNT	   310#	   460	   477	   486	   494	   537	   586	   605	   614	   622	   663
ERUNFL	  1243	  1245	  1250#
EXPECT	   309#	   463	   474	   499	   590	   602	   627
F.CMD	  1008	  1009#	  1017
H.CMD	  1023	  1024#	  1033
HELP	   778	   779#	   782
HLPMSG	   780	   783#
I	    24#	   109	   112	   132	   137	   149
I1	    25#	   108	   112	   131	   132	   133	   134
INTA	   422	   559#	   574	   576	   582	   584
INTB	   424	   560#	   579	   580	   583	   584
INTFLG	   134	   594	   598	  1396#
KPALVE	    44#
KPALVL	    44#
L.CMD	  1039	  1040#	  1049
LG.CAC	    44#
LG.EPT	    44#
LG.KLP	    44#
LG.LAB	    44#
LG.LUB	    44#
LG.PAC	    44#
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79
DR.MAC	11-SEP-79 17:43		Symbol cross reference

LG.TEN	    44#
LG.UPT	    44#
LI.ACO	    44#
LI.CO1	    44#	    44
LI.CO2	    44#	    44
LI.CO3	    44#	    44
LI.CO4	    44#	    44
LI.CO5	    44#	    44
LI.CO6	    44#	    44
LI.CO7	    44#	    44
LI.COF	    44#
LI.CON	    44#
LI.CPP	    44#
LI.CPS	    44#
LI.IP1	    44#	    44
LI.IP2	    44#	    44
LI.IP3	    44#	    44
LI.IP4	    44#	    44
LI.IP5	    44#	    44
LI.IP6	    44#	    44
LI.IP7	    44#	    44
LI.IPA	    44#
LI.PIA	    44#
LI.PIF	    44#
LI.PIN	    44#
LI.PR1	    44#
LI.PR2	    44#
LI.PR3	    44#
LI.PR4	    44#
LI.PR5	    44#
LI.PR6	    44#
LI.PR7	    44#
LI.REQ	    44#
LP.80C	    44#
LP.80E	    44#
LP.80I	    44#
LP.CSF	    44#
LP.DSF	    44#
LP.ESF	    44#
LP.HEE	    44#
LP.HPE	    44#
LP.I8C	    44#
LP.INT	    44#
LP.IOR	    44#
LP.ITD	    44#
LP.ITE	    44#
LP.NEE	    44#
LP.NXM	    44#
LP.PFE	    44#
LP.PIA	    44#
LP.PWF	    44#
LP.SEE	    44#
LP.SPE	    44#
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79
DR.MAC	11-SEP-79 17:43		Symbol cross reference

LP.SSF	    44#
LP.TIM	    44#
M.CMD	  1055	  1056#	  1089
M.CMD1	  1064#	  1088
M.CMD2	  1066	  1088#
M1	    32#	   140	   143	   146	   149	   152	   155	   162	   168	   169	   171	   174	   176	   177
	   179	   182	   186	   187	   188	   191	   193	   195	   199	   201	   209	   211	   223	   226
	   243	   246	   249	   252	   255	   258	   261	   264	   337	   340	   343	   364	   367	   370
	   373	   376	   379	   382	   400	   403	   406	   409	   412	   483	   486	   489	   492	   503
	   506	   509	   513	   516	   520	   523	   526	   531	   611	   614	   617	   620	   631	   634
	   637	   640	   643	   646	   649	   652	   657	   685	   700	   704	   714	   721	   725	   732
	   737	   748	   780	   812	   817	   821	   826	   843	   854	   857	   869	   879	   882	   885
	   890	   893	   897	   910	   913	   926	   939	   942	   953	   956	   959	   962	   966	   969
	   973	   976	   979	   983	   986	   990	   993	   996	  1000	  1011	  1014	  1026	  1029	  1042
	  1045	  1058	  1061	  1068	  1071	  1074	  1077	  1080	  1083	  1086	  1101	  1104	  1120	  1134
	  1137	  1151	  1154	  1169	  1172	  1184	  1187	  1201	  1204	  1216	  1219	  1246	  1249	  1255
	  1258	  1260	  1262	  1268	  1271	  1275	  1280	  1283	  1286	  1290	  1293	  1298	  1301	  1304
	  1307	  1315	  1318	  1321	  1325	  1329	  1332	  1336	  1339	  1346	  1349	  1352	  1356	  1360
	  1363
M2	    33#	   200	   203	   204	   210	   213	   214
N.CMD	  1095	  1096#	  1099
NDR1	   398	   414#
NXTDR	   362	   387#	   436	   937
NXTTST	   428#	   544	   670	  1107	  1111
OCTER	   695#
OCTIN	   696#	   751	   871	   928	  1122
OCTIN1	   697#	   735	   741	   754
ORG	    49#	   116
P	    27#	   140	   141	   144	   147	   150	   153	   154	   155	   163	   164	   169	   172	   174
	   177	   180	   182	   186	   187	   189	   192	   193	   194	   195	   196	   200	   202	   203
	   205	   206	   210	   212	   213	   215	   216	   224	   227	   238	   243	   244	   247	   250
	   253	   256	   259	   262	   263	   264	   268	   274	   275	   281	   288	   293	   301	   302
	   312	   338	   341	   344	   365	   368	   371	   374	   377	   380	   383	   401	   404	   407
	   410	   413	   441	   444	   445	   468	   484	   487	   490	   493	   504	   507	   510	   514
	   517	   521	   524	   527	   532	   596	   612	   615	   618	   621	   632	   635	   638	   641
	   644	   647	   650	   653	   658	   682	   686	   687	   697	   701	   705	   708	   709	   715
	   717	   718	   722	   726	   728	   733	   738	   742	   746	   749	   758	   761	   762	   781
	   813	   814	   818	   822	   827	   844	   855	   858	   870	   871	   880	   883	   886	   891
	   894	   898	   911	   914	   927	   928	   940	   943	   954	   957	   960	   963	   967	   970
	   974	   977	   980	   984	   987	   991	   994	   997	  1001	  1012	  1015	  1027	  1030	  1043
	  1046	  1059	  1062	  1069	  1072	  1075	  1078	  1081	  1084	  1087	  1099	  1102	  1105	  1121
	  1122	  1135	  1138	  1149	  1152	  1155	  1167	  1170	  1173	  1185	  1188	  1202	  1205	  1217
	  1220	  1246	  1249	  1255	  1258	  1260	  1262	  1268	  1271	  1275	  1281	  1284	  1287	  1291
	  1294	  1299	  1302	  1305	  1308	  1316	  1319	  1322	  1326	  1330	  1333	  1337	  1340	  1347
	  1350	  1353	  1357	  1361	  1364
P.CMD	  1117	  1118#	  1123	  1125
PAGFA1	   242	   266#
PAGFAL	    83	   237#
PAGOPC	   231#	   239	   258	   267	   269
PATERR	   350	   538	   962	   964	  1397#
PATMSK	   353	   473	   969	   971	  1400#
PAUSE	   441#	   468	   596
PDL	   307#	   312
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79
DR.MAC	11-SEP-79 17:43		Symbol cross reference

PDLOV	    80	   221#	   226
PFW	   230#	   252
Q.CMD	  1131	  1132#	  1140
QQ	   730	   736#	   737
R.CMD	  1145	  1146#	  1149	  1157
REQA	   561#	   570	   572	   574	   576	   578	   580	   582	   584
REQB	   562#	   571	   572	   575	   576	   579	   580	   583	   584
RLACT	    44#
RLALIV	    44#
RLBOOT	    44#	   828
RLWORD	    44#	   829
RUNFLG	   308#	   355	   384	   691	  1097	  1147	  1156	  1165	  1174	  1243
RW1	   475	   501	   529	   534#
RW2	   478	   481	   496#
RWOKAY	   497	   535	   544#
RWTEST	   433	   460#
RWTRY	   464#	   540
S.CMD	  1163	  1164#	  1167	  1175
ST1	   331#	   334
START	   228	   312#	   695	  1417
T1	    20#	   238	   239	   240	   241	   265	   266	   267	   268	   317	   318	   325	   326	   329
	   331	   334	   388	   389	   390	   415	   416	   418	   419	   420	   421	   423	   425	   429
	   430	   431	   441	   442	   443	   444	   471	   472	   473	   497	   526	   535	   539	   540
	   541	   587	   588	   589	   592	   593	   599	   600	   601	   625	   652	   661	   665	   666
	   667	   696	   707	   730	   740	   752	   753	   839	   840	   875	   888	   890	   915	   916
	   930	   932	   933	   936	  1031	  1032	  1047	  1048	  1063	  1064	  1071	  1077	  1083	  1088
	  1106	  1108	  1109	  1124	  1189	  1190	  1243	  1244	  1245	  1247	  1252	  1253	  1254	  1256
	  1265	  1266	  1267	  1269	  1310	  1312	  1318	  1327	  1329	  1341	  1343	  1349	  1358	  1360
T2	    21#	   330	   332	   391	   395	   422	   423	   424	   425	   466	   467	   469	   470	   511
	   513	   518	   520	   588	   595	   634	   873	   874	   877	   887	   888	   895	   900	   933
	   934	  1064	  1065	  1110
T3	    22#	   461	   462	   463	   472	   589	   590	   600	   640	   874	   875
TRP	    48#	    49	    77	    96	   106	   112
TRPADR	   106#	   109	   112#	   112
TRPCNT	    94#	    97	   118	   419
TRPERR	   156	   352	   996	   998	  1399#
TRPOPC	   130#	   131	   136	   157
TRPSER	   110	   112	   131#
TRPTAB	   118#	   132	   417	   418	   419	   423	   425
TST	    26#	   347	   387	   426	   430	   431	   432	   434	   461	   462	   465	   506	   587	  1341
U.CMD	  1181	  1182#	  1191
U.TAB	  1189	  1192#
V.CMD	  1198	  1199#	  1207
W.ADR	  1243#	  1246	  1249	  1252#	  1255	  1258	  1260	  1262	  1265#	  1268	  1271	  1276#
W.CMD	  1213	  1214#	  1367
%C.CMD	   809	   810#	   824
%DRA	  1372#	  1380	  1381	  1381#	  1383	  1383#
%DRV	  1373#	  1389	  1390	  1390#	  1392	  1392#
%H1	   542#
%H2	   668#
%Z	   840	   841#
%Z.CMD	   711	   837	   838#	   839	   841
.BEEP	   758	   760#	  1099	  1149	  1167
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79
DR.MAC	11-SEP-79 17:43		Symbol cross reference

.DR	   348	   361	   370	   388	   936	  1277	  1283	  1403#
.DR1	  1278	  1289#
.QUIET	   138	   397	   480	   500	   608	   628	  1139	  1206	  1265	  1412#
.SW	   528	   539	   654	   665	   916	  1032	  1048	  1252	  1408#
.TIME	   442	  1016	  1190	  1273	  1413#
.TST	   349	   396	   429	   859	   900	  1106	  1110	  1124	  1310	  1404#
.TST1	  1311	  1335#
.TST2	  1313	  1324#
.TST3	  1344	  1355#
DR11C diagnostic to run on KS-2020 (stand alone)	MACRO 12.4-46.0 17:46 11-SEP-79
DR.MAC	11-SEP-79 17:43		Macro/Opdef cross reference

APRID	    44#
BCIO	    44#
BCIOB	    44#
BEEP	   764#	  1098	  1148	  1166
BSIO	    44#
BSIOB	    44#
CHRDEF	   769#	   777	   808	   836	   850	   865	   906	   922	   949	  1007	  1022	  1038	  1054	  1094
	  1116	  1130	  1144	  1162	  1180	  1197	  1212
CLRPT	    44#
J.MSG	  1222#	  1274
JUMPT	   233#	   241	   333	   394	   935	  1066
MSG	    53#	   145	   170	   178	   190	   222	   248	   254	   339	   366	   372	   378	   402	   408
	   482	   488	   502	   508	   515	   522	   610	   616	   630	   636	   642	   648	   699	   720
	   731	   736	   747	   811	   816	   842	   853	   868	   878	   884	   892	   909	   925	   938
	   952	   958	   965	   975	   982	   992	  1010	  1025	  1041	  1057	  1067	  1073	  1079	  1100
	  1119	  1133	  1150	  1168	  1183	  1200	  1215	  1246	  1249	  1255	  1258	  1260	  1262	  1268
	  1271	  1275	  1279	  1289	  1297	  1303	  1314	  1324	  1335	  1345	  1355
MSGBIT	    61#	   639	   645	   651	   985
MSGDEC	    69#	   485	   613	   961	   978	   995
MSGNL	    57#	   142	   151	   245	   260	   336	   342	   363	   375	   381	   399	   411	   491	   530
	   619	   656	   684	   703	   713	   724	   820	   825	   856	   881	   896	   912	   941	   955
	   972	   989	   999	  1013	  1028	  1044	  1060	  1085	  1103	  1136	  1153	  1171	  1186	  1203
	  1218	  1246	  1249	  1255	  1258	  1260	  1262	  1268	  1271	  1275	  1285	  1292	  1306	  1320
	  1331	  1338	  1351	  1362
MSGOCT	    65#	   148	   225	   251	   257	   369	   405	   505	   512	   519	   525	   633	   889	   968
	  1070	  1076	  1082	  1282	  1300	  1317	  1328	  1348	  1359
PXCT	    44#
RDAPR	    44#
RDEBR	    44#
RDINT	    44#
RDIO	    44#	   393	   466	   469	   597	   934	  1065
RDIOB	    44#
RDPI	    44#
RDTIME	    44#
RDUBR	    44#
TIOE	    44#
TIOEB	    44#
TION	    44#
TIONB	    44#
UMOVE	    44#
UMOVEM	    44#
W.DSP	  1233#	  1242	  1251	  1264
W.MSG	  1228#	  1246	  1248	  1255	  1257	  1259	  1261	  1268	  1270
WRADB	    44#
WRAPR	    44#	   298	   314	   830
WREBR	    44#	   323
WRINT	    44#
WRIO	    44#	   326	   332	   416	   465	   593	   595
WRIOB	    44#
WRPI	    44#	   315	   327
WRTIME	    44#
WRUBR	    44#	   324 @