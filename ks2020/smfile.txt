DSQDF								PAGE 1






				IDENTIFICATION
				--------------

	PRODUCT CODE:		AH-E522B-DD

	DIAGNOSTIC CODE:	DSQDF

	PRODUCT NAME:		DSQDFB0 DECSYSTEM 2020
				DIAGNOSTICS FE-FILE PROGRAM

	VERSION:		0.2

	DATE RELEASED:		DECEMBER 1978

	AUTHOR:			JOHN R. KIRCHOFF

	MAINTAINED BY:		DIAGNOSTIC ENGINEERING GROUP

		        COPYRIGHT (C) 1978

	        DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.

	THIS SOFTWARE IS FURNISHED UNDER A LICENSE FOR  USE  ONLY  ON  A
	SINGLE COMPUTER SYSTEM AND MAY BE COPIED ONLY WITH THE INCLUSION
	OF THE ABOVE COPYRIGHT NOTICE.   THIS  SOFTWARE,  OR  ANY  OTHER
	COPIES  THEREOF, MAY NOT BE PROVIDED OR OTHERWISE MADE AVAILABLE
	TO ANY OTHER PERSON EXCEPT FOR USE ON SUCH SYSTEM AND TO ONE WHO
	AGREES  TO  THESE  LICENSE TERMS.  TITLE TO AND OWNERSHIP OF THE
	SOFTWARE  SHALL  AT   ALL  TIMES  REMAIN  IN  DIGITAL  EQUIPMENT
	CORPORATION.

	THE INFORMATION IN THIS DOCUMENT IS SUBJECT  TO  CHANGE  WITHOUT
	NOTICE  AND  SHOULD  NOT BE CONSTRUED AS A COMMITMENT BY DIGITAL
	EQUIPMENT CORPORATION.

	DIGITAL EQUIPMENT CORPORATION ASSUMES NO  RESPONSIBILITY FOR THE
	USE  OR  RELIABILITY  OF  ITS SOFTWARE IN EQUIPMENT WHICH IS NOT
	SUPPLIED BY DIGITAL EQUIPMENT CORPORATION.
SMFILE - DECSYSTEM 2020 DIAGNOSTICS FE-FILE PROGRAM

DISK
----

	THE SYSTEM DISK WILL CONTAIN A RESERVED (CONTIGUOUS) FE-FILE
AREA FOR THE 8080 CONSOLE PROCESSOR'S USE.

  TOPS-20 -- <ROOT-DIRECTORY>BOOTSTRAP.BIN
  TOPS-10 -- [6,2020]KS10FE.BIN

	THIS FE-FILE AREA WILL CONTAIN THE KS-10 MICROCODE, THE SYSTEM
AND DIAGNOSTIC PRE-BOOTS AND BOOTSTRAPS, THE BOOTCHECK 1 MICROCODE,
THE BOOTCHECK 2 DIAGNOSTIC CODE, AND 247 [0-366(8)] FRONT-END
INDIRECT 8080 COMMAND FILES.
 
	THIS AREA WILL BE POINTER TO BY WORDS IN THE HOME BLOCK.  THERE
WILL BE THREE WORDS USED IN THE HOME BLOCK.  WORD 1 PROVIDES THE DISK
ADDRESS OF THE FE-FILE AREA.  WORD 2 PROVIDES THE LENGTH OF THE FE-FILE
AREA.  WORD 3 PROVIDES THE 8080 FORMAT TRACK/CYLINDER/SECTOR ADDRESS.

	HOME BLOCK
	----------
	I
	I---------
  101	I  DISK ADDRESS OF FE-FILE AREA (SECTOR #)
	I---------
  102	I  LENGTH (# OF SECTORS)
	I---------
  103	I  8080 TRACK/CYL/SECTOR
	I---------
	I
	----------


	THE 8080 TRACK/CYLINDER/SECTOR WORD WILL BE AS FOLLOWS:

	          3-11              23-27            31-35
	------------------------------------------------------
	I 000 I           I 0'S I           I 000 I          I
	------------------------------------------------------
		  ^		     ^			^
		  I                  I			I
	       CYLINDER            TRACK              SECTOR
SMFILE - DECSYSTEM 2020 DIAGNOSTICS FE-FILE PROGRAM

	THE FIRST PAGE IN THE FE-FILE AREA WILL BE USED AS AN 8080
DIRECTORY TO CONTAIN PHYSICAL DISK ADDRESSES AND LENGTHS FOR THE
ASSOCIATED FILES CONTAINED WITHIN THE REMAINDER OF THE FE-FILE AREA.

	THE POINTER WORDS WILL BE IN THE 8080 TRACK/CYL/SECTOR FORMAT
AND THE PAGE ##,,LENGTH WORD WILL BE IN THE STARTING PAGE NUMBER IN THE
FILE AND THE NUMBER OF 512 WORD PAGES.

THIS FILE WILL BE AS FOLLOWS:

	FE-FILE PAGE 0

		--------------
WORD	0	I  POINTER TO FREE SPACE
	1	I    PAGE #,,LENGTH
		I-------------
	2	I  POINTER TO MICROCODE
	3	I    PAGE #,,LENGTH
		I-------------
	4	I  POINTER TO MONITOR PRE-BOOT
	5	I    PAGE #,,LENGTH
		I-------------
	6	I  POINTER TO DIAGNOSTIC PRE-BOOT
	7	I    PAGE #,,LENGTH
		I-------------
	10	I  POINTER TO BOOTCHECK 1 MICROCODE
	11	I    PAGE #,,LENGTH
		I-------------
	12	I  POINTER TO BOOTCHECK 2 PRE-BOOT
	13	I    PAGE #,,LENGTH
		I-------------
	14	I  POINTER TO MONITOR BOOT
	15	I    PAGE #,,LENGTH
		I-------------
	16	I  POINTER TO DIAGNOSTIC BOOT
	17	I    PAGE #,,LENGTH
		I-------------
	20	I  POINTER TO BOOTCHECK 2
	21	I    PAGE #,,LENGTH
		I-------------
	22	I  POINTER TO INDIRECT FILE 0
	23	I    PAGE #,,LENGTH
		I-------------
	24	I  POINTER TO INDIRECT FILE 1
	25	I    PAGE #,,LENGTH
		I-------------
		/   ...
		I-------------
	776	I  POINTER TO INDIRECT FILE 366(8)
	777	I    PAGE #,,LENGTH
		--------------
SMFILE - DECSYSTEM 2020 DIAGNOSTICS FE-FILE PROGRAM

		--------------
PAGE 1		I
		I  MICROCODE - 12 PAGES
		I
		--------------

		--------------
PAGE 13		I
		I  MONITOR PRE-BOOT - 1 PAGE
		I
		--------------

		--------------
PAGE 14		I
		I  DIAGNOSTICS PRE-BOOT - 1 PAGE
		I
		--------------

		--------------
PAGE 15		I
		I  BOOTCHECK 1 MICROCODE - 12 PAGES
		I
		--------------

		--------------
PAGE 27		I
		I  BOOTCHECK 2 PRE-BOOT - 1 PAGE
		I
		--------------
		I
		/
		I
		--------------
LAST PAGE	I
		I
		I
		--------------

	FREE SPACE STARTS AT PAGE 28 ON "RESET" WITH THE BOOTS AND OTHER
FILES ASSIGNED SPACE AS APPROPRIATE.

	THE FREE SPACE POINTER STARTS WITH THE PAGE #,,LENGTH WORD EQUAL
TO (^D28,,<LENGTH FROM HOME BLOCK 102 - ^D28>).
SMFILE - DECSYSTEM 2020 DIAGNOSTICS FE-FILE PROGRAM

	THE SMFILE PROGRAM WILL HAVE THE FOLLOWING COMMANDS TO GENERATE
AND MAINTAIN THE FE-FILE SYSTEM:

	1.	DEPOSIT	(BC1,CRAM)

	2.	DEBUG	(CLEAR,SET)

	3.	ECHO	(YES,NO)

	4.	EXAMINE	(BC1,CRAM)

	5.	EXIT

	6.	HELP

	7.	INFORMATION	(DISK,FEFILE,FREE,INDIRECT)

	8.	OUTPUT	(BC1,CRAM,MTBOOT,RAM)

	9.	PUSH

	10.	RDBC1	("FILE.EXT")

	11.	READ	("FILE.EXT")

	12.	SERIAL	"NUMBER"

	13.	TAKE	("FILE.EXT")

	14.	TYPE	(INDIRECT) (0-366(8))

	15.	WRITE	(BC1,BC2,BOOT,CRAM,DIAGBT,DONE,INDIRECT,RESET,SETUP)
SMFILE - DECSYSTEM 2020 DIAGNOSTICS FE-FILE PROGRAM

	THE WRITE COMMAND WILL HAVE THE FOLLOWING ARGUMENTS:

	A.	BC1

	B.	BC2 "FILE"

	C.	BOOT "FILE"

	D.	CRAM

	E.	DIAGBT "FILE"

	F.	INDIRECT "0-366(8)" "FILE"

	G.	RESET

	H.	SETUP "DEV:"

	I.	DONE

	THE OUTPUT COMMAND WILL HAVE THE FOLLOWING ARGUMENTS:

	A.	BC1 "FILE".RAM

	B.	CRAM "FILE".RAM

	C.	RAM "FILE".RAM

	D.	MTBOOT "INPUT".EXE AS "MTBOOT".RDI
SMFILE - DECSYSTEM 2020 DIAGNOSTICS FE-FILE PROGRAM

	AN EXAMPLE SET OF COMMANDS NECESSARY TO CREAT THE FRONT-END
FILE SYSTEM ON DISK FOR THE DECSYSTEM 2020:

	@RUN SMFILE
	DECSYSTEM-2020 FE-FILE PROGRAM
	VERSION #.#
	[FOR HELP TYPE "HELP"]
	SMFILE>WRITE SETUP DEV:
	SMFILE>WRITE RESET
	SMFILE>READ KS10.ULD
	SMFILE>SERIAL ####
	SMFILE>WRITE CRAM
	SMFILE>WRITE BOOT SMBOOT.EXE
	SMFILE>WRITE DIAGBT SMMON.EXE
	SMFILE>WRITE BC2 SMBC2.EXE
	SMFILE>WRITE DONE
	SMFILE>EXIT

	AN EXAMPLE PROCEDURE FOR CREATING THE MICROCODE AND READ-IN 
FILE TO BE THEN COPIED ONTO THE FRONT OF THE "SYSTEM" MAGTAPE FOR
MAGTAPE BOOTING:

	@RUN SMFILE
	DECSYSTEM-2020 FE-FILE PROGRAM
	VERSION #.#
	[FOR HELP TYPE "HELP"
	SMFILE>READ KS10.ULD
	SMFILE>OUTPUT CRAM KS10.RAM
	SMFILE>OUTPUT MTBOOT MTBOOT.EXE AS MTBOOT.RDI
	SMFILE>EXIT
SMFILE - DECSYSTEM 2020 DIAGNOSTICS FE-FILE PROGRAM

	THE FRONT-END INDIRECT FILES CONTAIN FRONT-END MICRO-PROCESSOR
COMMANDS THAT ARE USED AS IF THE USER HAD TYPED THEM DIRECTLY.  SEVERAL
COMMANDS MAY BE PUT ON A SINGLE LINE WITH COMMANDS SEPARATED BY COMMAS.
A COMMAND LINE MAY BE UP TO 80 CHARACTERS LONG.  THE INDIRECT FILE MAY
CONTAIN MANY LINES OF COMMANDS WITH THE FILE BEING LIMITED TO A MAXIMUM
OF 2047(10) CHARACTERS.  THE INPUT FILE USED TO CREATE THE FRONT-END
INDIRECT FILE WILL CONTAIN CR/LF PAIRS TO END LINES BUT THESE WILL BE
STRIPPED TO CR ONLY IN THE INDIRECT FILE.

	THE BYTES OF THE INDIRECT FILE WILL BE ARRANGED INTO THE
FOLLOWING FORMAT TO FACILIATE THEIR USE BY THE FRONT-END MICRO-
PROCESSOR:

	   0-3      4-11    12-19    20-27    28-35
	---------------------------------------------
	I 0000 I  CHAR 4 I CHAR 3 I CHAR 2 I CHAR 1 I
	---------------------------------------------
	I 0000 I  CHAR 8 I CHAR 7 I CHAR 6 I CHAR 5 I
	---------------------------------------------
	I		   /----/ 		    I
	---------------------------------------------
	I 0000 I  0 BYTE I CHAR Z I CHAR Y I CHAR X I
	---------------------------------------------

	THE FRONT-END INDIRECT FILE WILL TERMINATE WITH A ZERO BYTE.
SMFILE - DECSYSTEM 2020 DIAGNOSTICS FE-FILE PROGRAM

	THE FOLLOWING HALT ADDRESSES DURING THE DISK PRE-BOOT
OPERATION INDICATE THE FOLLOWING FAILURES:

	HALT 1001 - TRIED TO OVERLOAD PRE-BOOT
	HALT 1002 - DISK RETRY FAILURE
	HALT 1003 - NO RH-11 BASE ADDRESS

	THE FOLLOWING HALT STATUS BLOCK IS SAVED IF THE DISK
PRE-BOOT FAILS:

	LOC	100 - 8080 DISK ADDRESS
	LOC	101 - MEMORY PAGE ADDRESS
	LOC	102 - T3, SELECTION PICKUP POINTER
	LOC	103 - RPCS1, CONTROL AND STATUS 1 REG
	LOC	104 - RPCS10, CONTROL AND STATUS 2 REG
	LOC	105 - RPDS, DRIVE STATUS REG
	LOC	106 - RPER1, ERROR 1 REG
	LOC	107 - RPER2, ERROR 2 REG
	LOC	110 - RPER3, ERROR 3 REG
	LOC	111 - UBA PAGING RAM LOCATION 0
	LOC	112 - UBA STATUS REG
	LOC	113 - PRE-BOOT VERSION

	THE FOLLOWING HALT ADDRESSES DURING THE MAGTAPE PRE-BOOT
OPERATION INDICATE THE FOLLOWING FAILURES:

	HALT 1001 - TRIED TO OVERLOAD PRE-BOOT
	HALT 1002 - MAGTAPE READ ERROR
	HALT 1003 - NO RH-11 BASE ADDRESS
	HALT 1004 - MAGTAPE SKIP EOF ERROR

	THE FOLLOWING HALT STATUS BLOCK IS SAVED IF THE MAGTAPE
PRE-BOOT FAILS:

	LOC	100 - 0
	LOC	101 - MEMORY PAGE ADDRESS
	LOC	102 - T3, SLECECTION PICKUP POINTER
	LOC	103 - MTCS1, CONTROL AND STATUS 1 REG
	LOC	104 - MTCS2, CONTROL AND STATUS 2 REG
	LOC	105 - MTDS, DRIVE STATUS REG
	LOC	106 - MTER, ERROR REG
	LOC	107 - 0
	LOC	110 - 0
	LOC	111 - UBA PAGING RAM LOCATION 0
	LOC	112 - UBA STATUS REG
	LOC	113 - PRE-BOOT VERSION

[END]
    