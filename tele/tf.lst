TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1
TPARAM	23-DEC-86 12:29	

     1				;PROGRAM CAPABILITIES
     2			000100	ACRCAP==:100                 ;I MAY RECEIVE RANK COMPRESSED DATA RECORD
     3			000040	KATCAP==:40                  ;I MAY RECEIVE KATAKANA DATA
     4			000020	BINCAP==:20                  ;I MAY RECEIVE BINARY DATA
     5			000010	UPDCAP==:10                  ;I MAY RECEIVE BINARY UPDATE MODE DATA
     6				;ASSEMBLY AND TEST SWITCHES
     7			000001	TESTNG== 1                   ;PRINT LOGIN MESSAGES FROM SLAVE HOST
     8				;PROTOCOL VERSION
     9			000001	VERNUM==:1
    10				;MESSAGE TYPES
    11			000100	MBOT== 100      ;LOWER BOUND FOR MESSAGE TYPES
    12			000101	DNRCOD== 101 ;REQUEST SLAVE TO BE DONOR.  NO RESPONSE.
    13			000102	RCVCOD== 102 ;REQUEST SLAVE TO BE RECEIVER.  NO RESPONSE.
    14			000103	FLKCOD== 103 ;ASCII FILE NAME FOLLOWS AFTER 1 BYTE GIVING COUNT.
    15				;              (RETURNS FAILCD IF FILE NOT FOUND OR FLKSCD IF FILE FOUND.
    16				;              (IF THE SLAVE & CONTROLLER ARE BOTH 940 THEN THE USUAL
    17				;              (SECURITY RULES ARE RELAXEED AND THE LOOKUP SUCCEEDS
    18				;              (IF THE FILE IS PRESENT, RETURNING 9 BYTES CONTAINING
    19				;              (INFORMATION FROM THE FIRST 3 WORDS OF THE FD ENTRY.
    20			000104	SUCCOD== 104 ;OPTION ACCEPTED
    21			000105	ULKCOD== 105 ;ASCII USERNAME FOLLOWS AFTER 1 BYTE GIVING COUNT.
    22				;              (LOOKS UP THE USER NAME IN THE LUD AND RETURNS A ULKSCD IF
    23				;              (FOUND AND A ULKRCD IF NOT FOUND.  IF THE SLAVE & CONTROLLER
    24				;              (ARE BOTH 940 THEN A SUPER GFD IS PERFORMED TO REACH THE
    25				;              (FILE DIRECTORY OF THE SPECIFIED USER, AND GAN, FDPT, AND UUN
    26				;              (FROM THE LUD ENTRY ARE RETURNED AS 9 BYTES.
    27			000106	FLKFCD== 106 ;FILE NOT FOUND--NOT CONSIDERED AN ERROR
    28			000107	ABTCOD==: 107 ;STOP WHAT YOU ARE DOING, ABORT
    29			000110	BCMCOD== 110 ;START DATA RECORD, BINARY COMPRESSION METHOD
    30			000111	ACMCOD== 111 ;START DATA RECORD, ASCII COMPRESSION METHOD
    31			000112	ACKCOD== 112 ;ACKNOWLEDGEE RECORD CHECKSUM AND BYTECOUNT MATCH
    32			000113	NAKCOD== 113 ;CHECKSUM AND/OR BYTECOUNT DO NOT MATCH
    33			000114	FINCD1== 114 ;DONOR HAS SENT ALL RECORDS IN FILE AND IS HAPPY.  FOLLOWED
    34				;              (BY 1 BYTE COUNT OF BYTES FOLLOWING  TOTAL FILE BYTES SENT
    35				;              (BY DONOR.  USED BY UPDATE MODE CLOSE TO TRUNCATE FILE TO
    36				;              (THE CORRECT DATA LENGTH.  WHEN DONOR AND RECEIVER
    37				;              (ARE BOTH 940 THIS WILL BE 3 BYTES CONTAINING CPTOP.
    38			000115	FINCD2== 115 ;RECEIVER HAS WRITTEN AND CLOSED FILE SUCCESSFULLY
    39			000116	FPFCOD== 116 ;FILE PROTECTION FAILURE
    40			000117	OPFCOD== 117 ;OPEN FAILURE
    41			000120	BZCOD==  120 ;BUFFER ZAPPED
    42				; OPTION TYPES 121-130 RESPOND 104 OR 133 IF NOT IMPLEMENTED
    43			000121	CPACOD== 121 ;SPECIFY COMPRESSION.  FOLLOWED BY 1 BYTE
    44				;              (0= NONE
    45				;              (1= BINARY
    46				;              (2= ASCII
    47				;              (3= ASCII AUTO
    48			000122	ONLCOD== 122 ;ON LOWER CASE.  FOLLOWED BY A BYTE OF ALL 1'S TO PERMIT
    49				;              (LOWER CASE, ALL 0'S TO CONVERT LOWER TO UPPER CASE
    50				;              (DEFAULT IS TO PERMIT LOWER CASE
    51			000124	TRUCOD== 124 ;FOLLOWED BY 1 BYTE INDICATING COLUMN TO BEGIN
    52				;              (TRUNCATION.  IF 0 THEN TURN OFF TRUNCATION.
    53			000125	TRICOD== 125 ;REMOVE TRAILING BLANKS.  FOLLOWED BY A BYTE OF ALL 1'S
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-2
TPARAM	23-DEC-86 12:29	

    54				;              (TO SUPPRESS TRAILING BLANKS OR A BYTE OF ALL 0'S TO KEEP
    55				;              (TRAILING BLANKS  (DEFAULT)
    56			000127	VARCOD== 127 ;PRODUCE VARIABLE LENGTH RECORDS (DEFAULT)
    57				;              (FOLLOWED BY 4 BYTES GIVING MAXIMUM RECORD SIZE
    58			000130	FIXCOD== 130 ;PAD WITH BLANKS TO MAKE FIXED LENGTH RECORDS.
    59				;              (FOLLOWED BY 4 BYES OF RECORD LENGTH.
    60			000131	LOGCOD==:131 ;TELL SLAVE TO LOG OFF
    61			000132	CHKCOD== 132 ;START DATA CHECKSUM RECORD
    62			000133	NICOD==  133 ;REQUESTED OPERATION IS NOT IMPLEMENTED
    63			000134	EORCOD== 134 ;END OF TRANSMISSION RECORD
    64			000135	EOTCOD== 135 ;TRANSMISSION RECORD IS LAST IN FILE
    65			000136	QUICOD==:136 ;ABORT THE CURRENT OPERATION, QUIT SLAVE, AND RETURN
    66				;              (TO OPERATING SYSTEM COMMAND LEVEL.
    67			000137	OPNCOD== 137 ;REQUEST SLAVE OPEN FILE FOR DATA TRANSFER (DIRECTION
    68				;              (DETERMINED BY PREVIOUS 101 OR 102 CODE.  FOLLOWED BY 1 BYTE
    69				;              (TRANSMISSION TYPE, AND POSSIBLY, OTHER BYTES
    70				;              (TYPE = 1 ASCII MODE TRANSFER.  NO BYTES FOLLOW
    71				;              (TYPE = 2 EBCDIC MODE TRANSFER.  NO BYTES FOLLOW
    72				;              (TYPE = 3 BINARY MODE TRANSFER.  THE RECEIVE FILE, IF
    73				;              (PRESENT, IS TO BE ERASED.  FOLLOWED BY 1 BYTE OF BINARY
    74				;              (PARAMETERS.
    75				;              (TYPE = 4 BINARY UPDATE MODE TRANSFER.  DONOR AND RECEIVER
    76				;              (WILL EXCHANGE CHECK RECORDS.  FOLLOWED BY 1 BYTE OF BINARY
    77				;              (PARAMETERS AND 2 BYTES OF UPDATE MODE BLOCKSIZE.
    78				;              (TYPE = 5 KATAKANA MODE TRANSFER.  NO BYTES FOLLOW
    79				;              (TYPE = 6 IMAGE MODE TRANSFER.  NO BYTES FOLLOW
    80				;              (POSSIBLE RESPONSES ARE  133 (UPDATE MODE NOT IMPLEMENTED
    81				;              (OR PARAMETERS NOT ACCEPTABLE), 104 (FILE OPENED), 116
    82				;              (FILE PROTECTION FAILURE), OR 117 (FILE OPEN FAILURE).
    83			000140	FENQCD== 140 ;REQUEST SLAVE DONOR TO SEND FILE ATTRIBUTES.  RETURNS 104
    84				;              (PLUS 1 BYTE COUNT OF BYTES FOLLOWING.
    85			000141	FATTCD== 141 ;PREPARE SLAVE RECEIVER TO OPEN FILE.  FOLLOWED BY 1 BYTE
    86				;              (COUNT OF BYTES FOLLOWING.  WHEN DONOR AND RECEIVER ARE BOTH
    87				;              (940 SEND 9 BYTES  3 BYTES FFDPT, 3 BYTES FDWD0, AND
    88				;              (3 BYTES FDWD2.  NO RESPONSE IS GIVEN.
    89			000142	INSCOD== 142 ;SET INSTALLER LICENSE.  FOLLOWED BY 6 BYTE CIPHER.
    90			000143	WHYCOD==: 143 ;SOLICIT EXPLANATION OF LATEST ERROR
    91			000144	RSPCOD==: 144 ;CODE FOLLOWED BY ASCII STRING TO BE PRINTED AT TERMINAL
    92				;              (STRING TERMINATED BY A NUL BYTE OR ANY CONTROL CODE.
    93			000145	BADCOD== 145 ;UNEXPECTED CONTROL CODE RECEIVED
    94			000146	ERRCOD== 146 ;FILE SYSTEM ERROR WRITING OR READING FILE
    95			000147	PERCOD== 147 ;FILE SYSTEM ERROR POSITIONING FILE
    96			000150	ERASCD== 150 ;FILE SYSTEM ERROR ERASING RECEIVE FILE
    97			000152	TRPCOD== 152 ;PROGRAM TRAP
    98			000153	FLKRCD== 153 ;LOOKUP FAILURE--PROBABLY SYNTAX
    99			000154	ULKFCD== 154 ;GFD FAILURE
   100			000160	ULKSCD== 160 ;GFD SUCCESS
   101			000161	FLKSCD== 161 ;FILE LOOKUP SUCCESS
   102			000177	MTOP== 177      ;UPPER BOUND FOR MESSAGE TYPES
   103				;TRANSMISSION PARAMETERS
   104			050000	MAXRS== ^D512*^D40             ;MAXIMUM RECORD SIZE--40 PAGES
   105			010000	MINRS== ^D512*^D8            ;MININUM RECORD SIZE--8 PAGES
   106			014000	TSTRS== ^D6144                 ;SAMPLE SIZE FOR STATISTICS (CONSTANT)
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-3
TPARAM	23-DEC-86 12:29	

   107				;                               WILL BE 2 PAGES FOR BF=6
   108				;BINARY PARAMETERS FOR ASCII, KATAKANA, AND IMAGE MODE
   109			000407	KMODE==:  407                   ;1000+0011+1=BYTESIZE=9,BLOCKING=4,FILL=LEFT
   110			001000	SMODE==: 1000                   ;000+0000+0  INDICATES SERIAL MODE
   111			000345	IXMODE==: 345            ;111+0010+1==BYTESIZE=8,BLOCKING=3,FILL=LEFT
   112			000351	XMODE==: 351            ;111+0100+1==BYTESIZE=8,BLOCKING=5,FILL=LEFT
   113			000311	AMODE==: 311            ;110+0100+1==BYTESIZE=7,BLOCKING=5,FILL=LEFT
   114				;ASCII CHARACTER VALUES
   115			000010	TABSIZ== 10
   116			000003	ETX==: 3        ;CONTROL-C
   117			000011	HT== 11
   118			000012	LF== 12
   119			000015	CR== 15
   120			000030	CAN==: 30
   121			000031	EM==: 31
   122			000033	ESC==: 33
   123			000036	RS== 36
   124			000037	US==: 37
   125			000040	BL== 40
   126			000050	LPAREN== 50
   127			000051	RPAREN== 51
   128			000072	COLON== 72
   129				;COMPRESSION OPTIONS
   130			000001	AUTO==:1
   131			000002	ASCII==:2
   132			000400	NONE==: 400  ;NO OPTIONS, SET TO KEEP COPT NON-ZERO
   133				;REPEATED CHAR COMPRESSION PARAMETERS
   134			000200	BIASP== 200                ;BIAS FOR PREFERRED CHARACTER COMPRESSION CODE
   135			000202	MAXP== ^D130                 ;MAXIMUM COUNT FOR PREFERRED CHARACTER
   136			000003	MINP== 3                   ;MININUM COUNT FOR PREFERRED CHARACTER
   137			000010	BIASC== 10                 ;BIAS FOR REPEATED CHARACTER COMPRESSION CODE
   138			000073	MAXC== ^D59                  ;MAXIMUM COUNT FOR REPEATED CHARACTER
   139			000004	MINC== 4                   ;MININUM COUNT FOR REPEATED CHARACTER
   140				;RANK COMPRESSION PARAMETERS
   141			000010	BIASPA== 10                  ;BIAS FOR PREFERRED BYTE COMPRESSION CODE
   142			000021	MAXPA== ^D17                  ;MAXIMUM COUNT FOR PREFERRED BYTE
   143			000002	MINPA== 2                   ;MININUM COUNT FOR PREFERRED BYTE
   144			000032	BIASA== 32                 ;BIAS FOR ALL TRANSLATING CHARACTERS
   145			000010	NM== ^D8                   ;MASTER CHARACTERS-- 32 THRU 41
   146			000007	LM== NM-1
   147			000025	NC== ^D21                  ;COMBINING CHARACTERS-- 32 THRU 56
   148			000024	LC== NC-1
   149			000076	NT== ^D62                    ;TRANSLATING CHARACTERS-- 32 THRU 127
   150			000075	LT== NT-1
   151				; CHECK BLOCK LAYOUT
   152			000000	FCK1== 0
   153			000400	FCK2== ^D256
   154			001000	FCK3== ^D512
   155				; DONOR AND RECEIVER FILENAME INDEXES
   156		777777	777777	FSIZE== -1
   157			000003	FEXT== 3
   158			000015	UNAME== 15
   159			000017	SYS== 17
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-4
TPARAM	23-DEC-86 12:29	

   160			000020	FNAME== 20
   161				; AUXCAL DEFINITIONS
   162			000000	IICHW== 0       ;INPUT IMAGE CHAR, WAIT
   163			000001	IICHS== 1       ;INPUT IMAGE CHAR, SKIP
   164			000003	OICH== 3        ;OUTPUT IMAGE CHAR
   165			000004	OICHI== 4       ;OUTPUT IMAGE CHAR IMMEDIATE
   166			000007	CLRBO==:7       ;CLEAR OUTPUT BUFFER
   167			000012	YELLOW==: 12     ;SEND YELLOW BALL
   168			000032	SDVIOS== 32     ;SET DEVIOS
   169			000034	IBIO== 34       ;INITIATE BLOCK I/O MODE
   170			000035	INBW== 35       ;INPUT A BLOCK (WAIT)
   171			000036	INBS== 36       ;INPUT A BLOCK (SKIP)
   172			000037	OB== 37         ;OUTPUT A BLOCK
   173			000040	TBI== 40        ;TERMINATE BLOCK INPUT
   174			000041	TBO== 41        ;TERMINATE BLOCK OUTPUT
   175			000042	LBIO== 42       ;LEAVE BLOCK I/O MODE
   176			000043	SLVPRT== 43     ;SLAVE COMMAND PORT
   177			000052	ASCSTG== 52     ;OUTPUT ASCII STRING
   178				; DEVIOS BITS
   179			000014	IOMOD==14       ;BINARY MODE
   180			020000	IODEND==20000   ;MASK FOR IODEND BIT (BIT 22)
   181			000200	NOECHO==200     ;NO ECHO BIT (AFFECTS COMMAND PORT)
   182				; UUO DEFINITIONS
   183				IFDEF UUOFLG<UUOTAB: BLOCK 0>
   184				DEFINE  OPD     (A,B) <U==U+1
   185				OPDEF A [U*1000000000]
   186				IFDEF UUOFLG<JRST B>>
   187			000000	U==0
   188			000001	 OPD OUTSTR,OSTRUU^U==U+1
   189			000002	 OPD INCHWL,INCHUU^U==U+1
   190			000003	 OPD OUTCHR,OCHRUU^U==U+1
   191			000004	 OPD OUTCHI,OCHIUU^U==U+1
   192			000005	 OPD CLRBFO,CLROUU^U==U+1
   193			000006	 OPD CLRBFI,CLRIUU^U==U+1
   194				;***  WARNING *** FLAGS IN MASTER ARE NOT PRESERVED FROM ONE FILE TO NEXT
   195				;***    SEE "SAVREG" IN TELECO.MAC WHICH ZEROES ALL ACCUMULATORS
   196				;FLAGS IN LH OF ACCUMULATOR F
   197			000001	LUDFLG== 1      ;LUD HAS BEEN OPENED IF 1
   198				;FLAGS IN RH OF ACCUMULATOR F
   199			000001	SORTFG== 1     ;SORT HAS BEEN PERFORMED IF 1
   200			000002	HSW== 2        ;RECORD HEADER HAS BEEN CREATED IF 1
   201			000004	LCO== 4        ;PERMIT LOWER CASE OUTPUT IF 1
   202			000010	LEFTFG== 10    ;LEFT FILL IF 1
   203			000020	SERFLG== 20    ;SERIAL MODE IF 1
   204			000040	UPDMOD== 40    ;READ CONTENTS FROM FILE BEFORE WRITING IF 1
   205			000100	IGNEOF== 100   ;IGNORE END OF BLOCK IF 1
   206			000200	CHGFLG== 200   ;PAGE CHANGED BY MASKING OPERATION IF 1
   207			000400	MASKFG== 400   ;PAGE MUST BE MASKED PRIOR TO USE
   208			001000	DEFFLG== 1000   ;IINIT TO CALL ROUTINE "DEFER" WHEN BLOCK INPUT DONE
   209			002000	MSGSW==  2000   ;ONCE-ONLY FLAG FOR COPYST
   210			004000	BI==     4000   ;INDICATES BLOCK INPUT STARTED IF 1
   211			010000	TI==    10000   ;INDICATES BLOCK INPUT TERMINATED IF 1
   212			020000	SWB==   20000   ;ONCE-ONLY SWITCH FOR SWBAC
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1
FLAGS	23-DEC-86 12:29	

   213			040000	FILFND==  40000  ;FILE FOUND BY SLAVE IF 1.
   214			100000	EDIT10== 100000 ;EDIT-10 FILE BEING TRANSMITTED IN ASCII MODE IF 1
   215			200000	ILLCHR== 200000 ;DISALLOWED CHAR IN FILENAME (SEE GET10)
   216				; GENERAL-PURPOSE REGISTERS  (TOUCHED BY EVERYONE)
   217			000000	R0=0
   218			000001	R1=1
   219			000002	R2=2
   220				;REGISTERS TOUCHED ONLY BY A,ACTRANS,BCTRANS
   221				;R3-R5 USED IN CHECKSUMMING FILE (BEFORE TRANSMISSION)
   222			000003	R3=3            ;HOLDING REGISTER FOR C.  PRESERVE IN CW AND W MACROS
   223			000004	R4=4
   224			000004	RC=4          ;HOLDING REGISTER.  PRESERVE IN CW AND W MACROS.
   225			000005	R5=5
   226			000005	PREFER=5        ;PREFERRED COMPRESSION CHAR.
   227			000006	RCC=6            ;REGISTER USED FOR REPEAT COUNT
   228				; SPECIAL PURPOSE REGISTERS
   229			000007	C=7             ;CHARACTER BEING READ(WRITTEN) FROM(TO) FILE OR BEING
   230				;               WRITTEN(READ) TO(FROM) OUTPUT(INPUT) BUFFER.
   231			000010	RANK=10         ;RANK OF FIRST(SECOND) CHAR OF A MASTER-COMBINING
   232				;               PAIR.  **MUST** FOLLOW C.
   233			000011	AS=11           ;STATE FOR ROUTINE A.
   234			000012	GS=12           ;STATE FOR ROUTINE GB.
   235			000013	GX=13           ;INDEX FOR ROUTINE GB.
   236			000014	PS=14           ;STATE FOR ROUTINE PB.
   237			000015	PX=15           ;INDEX FOR ROUTINE PB.
   238			000016	F=16            ;FLAGS
   239			000017	P=17            ;PUSHDOWN LIST POINTER
   240				;CHANNEL ASSIGNMENTS
   241			000001	FIL== 1
   242			000002	TRPDSK== 2
   243			000003	LUD== 3
   244				DEFINE W(A),<
   245				 MOVE C,A
   246				 PUSHJ P,CW
   247				 >
   248				DEFINE W1(A,%B),<
   249				 MOVE C,A
   250				 CAIG C,EM
   251				 CAIG C,CAN-1
   252				 JRST %B
   253				 W [CAN]
   254				 MOVE C,A
   255				%B: PUSHJ P,CW
   256				 >
   257				DEFINE W2(A,%B,%C),<
   258				 MOVE C,A
   259				 CAIG C,EM
   260				 CAIG C,CAN-1
   261				 JRST %B
   262				REPEAT 2,<
   263				 W [CAN]
   264				 W A
   265				>
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1
W	23-DEC-86 12:29	

   266				 JRST %C
   267				%B: REPEAT 2,<PUSHJ P,CW>
   268				%C:
   269				 >
   270				DEFINE W3(A,%B,%C),<
   271				 MOVE C,A
   272				 CAIG C,EM
   273				 CAIG C,CAN-1
   274				 JRST %B
   275				REPEAT 3,<
   276				 W [CAN]
   277				 W A
   278				>
   279				 JRST %C
   280				%B: REPEAT 3,<PUSHJ P,CW>
   281				%C:
   282				 >
   283				DEFINE LNKMSG(A),<
   284				 MOVEI C,A
   285				 PUSHJ P,SCOD
   286				 PUSHJ P,SNDYEL
   287				 >
   288				DEFINE DI(A,%B,%C),<
   289				 HRLZ R0,C
   290				 MOVE R1,[%C,,%B]
   291				 HRR (R1)
   292				 CAME (R1)
   293				 AOBJN R1,.-2
   294				 TLNN R1,400000
   295				 JSR BAD
   296				 HRRZ R1,(R1)
   297				 JRST @R1
   298				%B:
   299				 IRP A,<
   300				 DIS A
   301				 >
   302				%C==%B-.
   303				 >
   304				DEFINE DIS(A),<
   305				 XWD A
   306				 >
   307			000000	OFF==0
   308				DEFINE TIMER(A),<
   309				 IFG A,<PUSHJ P,STARTT
   310				 EXP A>
   311				 IFE A,<SETOM TIMFLG>
   312				 >
   313				TITLE TF -- CODE TO TRANSMIT FILE
   314
   315				ENTRY TF,ELOR,SLOR,SPOR,EPOR,RUPCNT,SNAK,SACK,INITRN
   316				ENTRY GC60,GCOD,GC,SCOD,SBYTE,SINIT,RINIT,GBCOD
   317				ENTRY RCR,SCR,DSTRY,RRANKT,VERIF
   318				ENTRY SNDYEL,SUCROU,OPNROU,DEFER
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1
TF.MAC	23-DEC-86 12:29	

   319				;EXTERNAL ROUTINES
   320				EXTERN BGC,CW,FLUSH,ABIOIP,LVBI,OINIT,IINIT
   321				EXTERN SPA,UPA,COPYST,CKTIM
   322				EXTERN SWBAC,GA,GB,SIZE,ITF
   323				EXTERN BAD,UIO
   324				EXTERN FPF,OPF,FWER,FPEW,FERER,STARTT
   325				EXTERN ZAPINT,CPOPJ1
   326				; CELLS CONTAINING EXECUTABLE INSTRUCTIONS:
   327				EXTERN ACKROU,G,TRANS
   328				; EXTERNAL STORAGE
   329				EXTERN CCNT,RECL,RECL1,LRECL,COUNTB,BP,BP0,CCR,CCR0,RECSIZ
   330				EXTERN TRTOT,ETIME,RTT,TIMFLG
   331				EXTERN CHECK,ICHECK,ICOUNT,TOTCCT
   332				EXTERN URECL,UCCR0,UBP0,URTT
   333				EXTERN DNOR,RCVR,RPTR,RPTR0,DPTR,DPTR0,DCPTR,RCPTR,DCC
   334				EXTERN CHKCOUNT,VERIF1,VERIF2,VERIF3
   335				EXTERN TMODE,RPARAM,TPARAM,TBLOCK,RBLOCK,BF,UTBLOCK
   336				EXTERN MASTER,DONOR,SW10,SW370
   337				EXTERN T,PANIC,ESCRTN
   338				EXTERN ST,STE,RANKT,AUXPRT
   339				EXTERN RBLIC,CPTOP1,CPTOP2
   340				EXTERN NAKCTR,SCOD1,LCOD,LCOD1,IRTT
   341
   342				; TRANSMIT FILE.  RECEIVER MUST BE IN BLOCK INPUT MODE
   343	000000'	260740	000000*	TF: PUSHJ P,ITF         ;INITIALIZE TRANSMITTERS AND FILE READERS
   344	000001'	200000	000000*	 MOVE TMODE
   345	000002'	200040	000000*	 MOVE R1,TPARAM
   346	000003'	260740	000000*	 PUSHJ P,SPA            ;SELECT PARAMETERS FOR SPECIAL MODES
   347	000004'	202040	000002*	 MOVEM R1,TPARAM
   348	000005'	260740	000000*	 PUSHJ P,UPA       ;UNPACK BINARY PARAMETERS
   349				; OPEN LAST NAMED FILE FOR INPUT.  A NOP.
   350				; INITIALIZE FOR TRANSMISSION
   351	000006'	260740	000573'	 PUSHJ P,INITRN
   352				; IF WE ARE MASTER SEND FILE ATTRIBUTES HERE
   353	000007'	336000	000000*	 SKIPN MASTER   ;ARE WE MASTER
   354	000010'	254000	000046'	 JRST TF0       ;NO, SLAVE
   355	000011'	336000	000000*	 SKIPN SW10     ;ARE WE TALKING TO A PDP-10
   356	000012'	254000	000025'	 JRST TF00      ;NO
   357	000013'	201340	000141	 MOVEI C,FATTCD
   358	000014'	260740	000745'	 PUSHJ P,SCOD
   359	000015'	201340	000206	 MOVEI C,206    ;SIX BYTES
   360	000016'	260740	000753'	 PUSHJ P,SBYTE
   361	000017'	201040	000006	 MOVEI R1,6
   362	000020'	200100	001336'	 MOVE R2,[POINT 6,RBLIC]
   363	000021'	134340	000002	 ILDB C,R2
   364	000022'	435340	000200	 IORI C,200
   365	000023'	260740	000753'	 PUSHJ P,SBYTE
   366	000024'	367040	000021'	 SOJG R1,.-3
   367				; SEND OPNCOD.
   368	000025'	260740	001270'	TF00: PUSHJ P,OPNROU
   369				; GET RESPONSE
   370	000026'	260740	000600'	 PUSHJ P,GC60
   371				 DI <<SUCCOD,TF01>,<FPFCOD,FPF>,<OPFCOD,OPF>>^
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-2
TF.MAC	23-DEC-86 12:29	

   372	000027'	514000	000007	 HRLZ R0,C
   373	000030'	200040	001337'	 MOVE R1,[..0001,,..0002]
   374	000031'	540001	000000	 HRR (R1)
   375	000032'	312001	000000	 CAME (R1)
   376	000033'	253040	000031'	 AOBJN R1,.-2
   377	000034'	607040	400000	 TLNN R1,400000
   378	000035'	264000	000000*	 JSR BAD
   379	000036'	550041	000000	 HRRZ R1,(R1)
   380	000037'	254020	000001	 JRST @R1
   381	000040'	000104	000043'	 XWD SUCCOD,TF01
   382	000041'	000116	000000*	 XWD FPFCOD,FPF
   383	000042'	000117	000000*	 XWD OPFCOD,OPF
   384	000043'	620700	002000	TF01: TRZ F,MSGSW       ;ONCE-ONLY SWITCH FOR COPYST
   385	000044'	402000	000000*	 SETZM CCNT             ;ZERO TOTAL CHARACTER COUNT
   386	000045'	260740	000000*	 PUSHJ P,COPYST         ;PRINT "COPY STARTING" MESSAGES
   387	000046'	260740	000000*	TF0: PUSHJ P,SIZE       ;CALCULATE CCR=NO. OF FILE BYTES TO SEND
   388	000047'	202000	000000*	 MOVEM CCR0             ;SIZE RETURNS CCR IN R0.
   389	000050'	201000	060000	 MOVEI MINRS*6
   390	000051'	202000	000000*	 MOVEM RECSIZ           ;LOGICAL RECORD SIZE
   391	000052'	200040	000001*	 MOVE R1,TMODE
   392	000053'	200001	000063'	 MOVE GCHT(R1)
   393	000054'	202000	000000*	 MOVEM G                ;STORE APPROPRIATE PUSHJ
   394	000055'	254001	000055'	 JRST .(R1)
   395	000056'	254000	000072'	 JRST TF1
   396	000057'	264000	000000*	 JSR UIO                ;EBCDIC MODE NOT IMPLEMENTED
   397	000060'	254000	000072'	 JRST TF3
   398	000061'	254000	000227'	 JRST TF4
   399	000062'	254000	000072'	 JRST TF1               ;KATAKANA TREAT LIKE ASCII
   400	000063'	254000	000072'	 JRST TF3               ;IMAGE TREAT LIKE BINARY
   401			000063'	GCHT=.-1
   402	000064'	260740	000000*	 PUSHJ P,GA
   403	000065'	260740	000064*	 PUSHJ P,GA
   404	000066'	260740	000000*	 PUSHJ P,GB
   405	000067'	260740	000066*	 PUSHJ P,GB
   406	000070'	260740	000065*	 PUSHJ P,GA
   407	000071'	260740	000067*	 PUSHJ P,GB
   408
   409				; ASCII TRANSMISSION MODE TMODE=1
   410
   411	000072'			TF1:
   412
   413				; BINARY TRANSMISSION MODE TMODE=3
   414
   415	000072'			TF3:
   416
   417				; ANALYZE THE FIRST 6144 BYTES (APPROX. 2 PAGES) FOR PREFERRED COMPRESSION CHAR
   418
   419	000072'	201000	014000	 MOVEI TSTRS
   420	000073'	317000	000000*	 CAMG CCR
   421	000074'	254000	000076'	 JRST .+2
   422	000075'	200000	000073*	 MOVE CCR
   423	000076'	202000	000000*	 MOVEM COUNTB
   424	000077'	620700	000001	 TRZ F,SORTFG
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-3
TF.MAC	23-DEC-86 12:29	

   425	000100'	200040	001340'	 MOVE R1,[ST,,ST+1]
   426	000101'	402000	000000*	 SETZM ST
   427	000102'	251040	777777*	 BLT R1,STE-1
   428	000103'	256000	000054*	 XCT G
   429	000104'	254000	000103'	 JRST .-1
   430	000105'	260740	000000*	 PUSHJ P,SWBAC          ;SWITCH TO DUPLICATE OR RANK COMPRESSION
   431				; INITIALIZE RECORD
   432	000106'	260740	000763'	TA5: PUSHJ P,RINIT      ;PREPARE PHYSICAL RECORD
   433	000107'	260740	000523'	 PUSHJ P,SPOR
   434	000110'	260740	000476'	TA1: PUSHJ P,SLOR       ;START LOCICAL OUTPUT RECORD
   435	000111'	254000	000143'	 JRST TA2               ;FINISHED
   436	000112'	256000	000000*	 XCT TRANS              ;TRANSMIT RECORD.  MAKES RECORD HEADER.
   437	000113'	260740	000513'	 PUSHJ P,ELOR1          ;UPDATE RECL1
   438	000114'	260740	000516'	 PUSHJ P,ELOR           ;UPDATE RECL
   439	000115'	200000	000000*	 MOVE TOTCCT
   440	000116'	307000	360000	 CAIG MAXRS*6           ;END RECORD IF IT IS GETTING TOO LARGE
   441	000117'	254000	000110'	 JRST TA1
   442	000120'	260740	000777'	 PUSHJ P,ENDREC         ;TERMINATE RECORD
   443	000121'	260740	000604'	 PUSHJ P,GCOD           ;GET RESPONSE
   444				 DI <<ACKCOD,TA6>,<NAKCOD,TA5>,<ERRCOD,FWER>,<PERCOD,FPEW>>^
   445	000122'	514000	000007	 HRLZ R0,C
   446	000123'	200040	001341'	 MOVE R1,[..0003,,..0004]
   447	000124'	540001	000000	 HRR (R1)
   448	000125'	312001	000000	 CAME (R1)
   449	000126'	253040	000124'	 AOBJN R1,.-2
   450	000127'	607040	400000	 TLNN R1,400000
   451	000130'	264000	000035*	 JSR BAD
   452	000131'	550041	000000	 HRRZ R1,(R1)
   453	000132'	254020	000001	 JRST @R1
   454	000133'	000112	000137'	 XWD ACKCOD,TA6
   455	000134'	000113	000106'	 XWD NAKCOD,TA5
   456	000135'	000146	000000*	 XWD ERRCOD,FWER
   457	000136'	000147	000000*	 XWD PERCOD,FPEW
   458	000137'	260740	000540'	TA6: PUSHJ P,RUPCNT
   459	000140'	260740	000000*	 PUSHJ P,CKTIM
   460	000141'	260740	000532'	 PUSHJ P,EPOR           ;END PHYSICAL RECORD TRANSMITTED AND RECEIVED SUCCESSFULLY
   461	000142'	254000	000106'	 JRST TA5
   462	000143'	606700	000002	TA2: TRNN F,HSW         ;ANYTHING STARTED
   463	000144'	254000	000164'	 JRST TAEND             ;NO
   464	000145'	260740	000777'	 PUSHJ P,ENDREC
   465	000146'	260740	000604'	 PUSHJ P,GCOD
   466				 DI <<ACKCOD,TAEND>,<NAKCOD,TA5>,<ERRCOD,FWER>,<PERCOD,FPEW>>^
   467	000147'	514000	000007	 HRLZ R0,C
   468	000150'	200040	001342'	 MOVE R1,[..0005,,..0006]
   469	000151'	540001	000000	 HRR (R1)
   470	000152'	312001	000000	 CAME (R1)
   471	000153'	253040	000151'	 AOBJN R1,.-2
   472	000154'	607040	400000	 TLNN R1,400000
   473	000155'	264000	000130*	 JSR BAD
   474	000156'	550041	000000	 HRRZ R1,(R1)
   475	000157'	254020	000001	 JRST @R1
   476	000160'	000112	000164'	 XWD ACKCOD,TAEND
   477	000161'	000113	000106'	 XWD NAKCOD,TA5
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-4
TF.MAC	23-DEC-86 12:29	

   478	000162'	000146	000135*	 XWD ERRCOD,FWER
   479	000163'	000147	000136*	 XWD PERCOD,FPEW
   480	000164'	260740	000540'	TAEND: PUSHJ P,RUPCNT
   481	000165'	260740	000000*	 PUSHJ P,LVBI           ;TERMINATE BLOCK INPUT IF STARTED
   482	000166'	201340	000114	 MOVEI C,FINCD1
   483	000167'	260740	000745'	 PUSHJ P,SCOD
   484	000170'	201340	000004	 MOVEI C,4
   485	000171'	260740	000753'	 PUSHJ P,SBYTE
   486	000172'	200100	001343'	 MOVE R2,[POINT 8,CPTOP1,3]     ;**IMPORTANT SBYTE PRESERVES R2
   487				 REPEAT 4,<ILDB C,R2
   488				 PUSHJ P,SBYTE>
   489	000173'	134340	000002	ILDB C,R2
   490	000174'	260740	000753'	 PUSHJ P,SBYTE
   491	000175'	134340	000002	ILDB C,R2
   492	000176'	260740	000753'	 PUSHJ P,SBYTE
   493	000177'	134340	000002	ILDB C,R2
   494	000200'	260740	000753'	 PUSHJ P,SBYTE
   495	000201'	134340	000002	ILDB C,R2
   496	000202'	260740	000753'	 PUSHJ P,SBYTE
   497	000203'	200340	000000*	 MOVE C,CPTOP2
   498	000204'	260740	000753'	 PUSHJ P,SBYTE
   499	000205'	260740	001252'	 PUSHJ P,SNDYEL
   500	000206'	260740	000165*	 PUSHJ P,LVBI           ;SENSE IODEND FOR BLOCK INPUT IF STARTED
   501	000207'	260740	000600'	 PUSHJ P,GC60
   502				 DI <<FINCD2,TAFIN>,<ERRCOD,FWER>,<PERCOD,FPEW>,<ERASCD,FERER>>^
   503	000210'	514000	000007	 HRLZ R0,C
   504	000211'	200040	001344'	 MOVE R1,[..0007,,..0010]
   505	000212'	540001	000000	 HRR (R1)
   506	000213'	312001	000000	 CAME (R1)
   507	000214'	253040	000212'	 AOBJN R1,.-2
   508	000215'	607040	400000	 TLNN R1,400000
   509	000216'	264000	000155*	 JSR BAD
   510	000217'	550041	000000	 HRRZ R1,(R1)
   511	000220'	254020	000001	 JRST @R1
   512	000221'	000115	000225'	 XWD FINCD2,TAFIN
   513	000222'	000146	000162*	 XWD ERRCOD,FWER
   514	000223'	000147	000163*	 XWD PERCOD,FPEW
   515	000224'	000150	000000*	 XWD ERASCD,FERER
   516	000225'	070040	000000	TAFIN: CLOSE FIL,
   517	000226'	263740	000000	 POPJ P,                ;RETURN FROM TF
   518
   519				; BINARY UPDATE TRANSMISSION MODE TMODE=4
   520	000227'	660700	020000	TF4: TRO F,SWB          ;ONCE-ONLY SWITCH FOR SWBAC
   521	000230'	200000	000000*	 MOVE TBLOCK            ;REDEFINE RECSIZ FOR 1 DISK BLOCK
   522	000231'	202000	000051*	 MOVEM RECSIZ
   523	000232'	201000	000000*	BEX: MOVEI DNOR
   524	000233'	202000	000000*	 MOVEM DCPTR            ;POINTER TO DONOR CHECKSUM BLOCK
   525	000234'	201000	000377	 MOVEI ^D255
   526	000235'	202000	000000*	 MOVEM DCC              ;MAXIMUM 256 BLOCKS PER EXCHANGE
   527	000236'	260740	000523'	 PUSHJ P,SPOR
   528				; USE EXISTING CODE TO HANDLE EACH EXCHANGE OF UP TO 256 BLOCKS
   529				; THE PHYSICAL "RECORD" IS THE CHECK RECORD EXCHANGE AND
   530				; CORRESPONDING DATA RECORDS.  THE LOGICAL "RECORD" IS ONE DISK BLOCK.
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-5
TF.MAC	23-DEC-86 12:29	

   531	000237'	400140	000000	BEXL: SETZ R3,          ;ZERO BITS 0-22 OF CHECKSUM
   532	000240'	400200	000000	 SETZ R4,               ;ZERO BITS 23-45 OF CHECKSUM
   533	000241'	400240	000000	 SETZ R5,               ;ZERO BITS 46-68 OF CHECKSUM
   534	000242'	260740	000551'	 PUSHJ P,USLOR          ;MAKES LRECL=RECSIZ, EVEN PAST END OF FILE
   535	000243'	254000	000317'	 JRST BEXFIN
   536	000244'	260740	000071*	BEXB: PUSHJ P,GB        ;GET A BYTE FROM THE FILE TO PUT INTO CHECKSUM
   537	000245'	254000	000310'	 JRST BEXCK             ;GOT ONE
   538	000246'	404140	001345'	 AND R3,[37,,777777]    ;EXTRACT 23 BITS
   539	000247'	404200	001345'	 AND R4,[37,,777777]    ;EXTRACT 23 BITS
   540	000250'	404240	001345'	 AND R5,[37,,777777]    ;EXTRACT 23 BITS
   541	000251'	200040	000233*	 MOVE R1,DCPTR
   542	000252'	202141	000000	 MOVEM R3,FCK1(R1)      ;SAVE FIRST PART OF CHECKSUM
   543	000253'	202201	000400	 MOVEM R4,FCK2(R1)      ;AND SECOND PART
   544	000254'	202241	001000	 MOVEM R5,FCK3(R1)      ;AND THIRD PART
   545	000255'	350000	000251*	 AOS DCPTR
   546	000256'	260740	000516'	 PUSHJ P,ELOR
   547	000257'	371000	000235*	 SOSL DCC
   548	000260'	254000	000237'	 JRST BEXL              ;DO NEXT BLOCK
   549				; FULL CHECK RECORD IS BUILT.  EXCHANGE CHECK RECORDS AND SEND DATA RECORDS.
   550	000261'	201000	000134	SCRAA: MOVEI EORCOD
   551	000262'	260740	001171'	 PUSHJ P,SCR            ;SEND CHECK RECORD TERMINATED BY EOR CODE
   552	000263'	260740	001042'	SCRBB: PUSHJ P,RCR      ;RECEIVE CHECK RECORD
   553	000264'	254000	000261'	 JRST SCRAA             ;OUR CHECK RECORD WAS NAK'D
   554	000265'	254000	000304'	 JRST SCRDD             ;VALID CHECK RECORD RECEIVED
   555	000266'	254000	000271'	 JRST SCRCC             ;SOME OTHER RECORD TYPE WAS RECEIVED
   556	000267'	260740	000561'	 PUSHJ P,SNAK           ;BAD CHECK RECORD--TRY TO COAX A RETRY
   557	000270'	254000	000263'	 JRST SCRBB
   558	000271'			SCRCC: DI <<ERRCOD,FWER>,<PERCOD,FPEW>>^
   559	000271'	514000	000007	 HRLZ R0,C
   560	000272'	200040	001346'	 MOVE R1,[..0011,,..0012]
   561	000273'	540001	000000	 HRR (R1)
   562	000274'	312001	000000	 CAME (R1)
   563	000275'	253040	000273'	 AOBJN R1,.-2
   564	000276'	607040	400000	 TLNN R1,400000
   565	000277'	264000	000216*	 JSR BAD
   566	000300'	550041	000000	 HRRZ R1,(R1)
   567	000301'	254020	000001	 JRST @R1
   568	000302'	000146	000222*	 XWD ERRCOD,FWER
   569	000303'	000147	000223*	 XWD PERCOD,FPEW
   570				; SEND UP TO RECL DATA BYTES, MUCH LESS OR NONE IF CHECK RECORDS MATCH.
   571	000304'	201000	000134	SCRDD: MOVEI EORCOD     ;ALL DATA RECORDS END WITH EOR
   572	000305'	260740	000334'	 PUSHJ P,USND           ;SEND DATA
   573	000306'	260740	000532'	 PUSHJ P,EPOR           ;ENDS THIS GROUP OF 256 BLOCKS
   574	000307'	254000	000232'	 JRST BEX               ;GET NEXT BUNCH
   575	000310'	221140	000015	BEXCK: IMULI R3,^D13
   576	000311'	270140	000007	 ADD R3,C
   577	000312'	221200	000021	 IMULI R4,^D17
   578	000313'	270200	000007	 ADD R4,C
   579	000314'	221240	000023	 IMULI R5,^D19
   580	000315'	270240	000007	 ADD R5,C
   581	000316'	254000	000244'	 JRST BEXB              ;GET NEXT BYTE
   582				; LAST EXCHANGE
   583	000317'	337000	000000*	BEXFIN: SKIPG RECL
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-6
TF.MAC	23-DEC-86 12:29	

   584	000320'	254000	000164'	 JRST TAEND
   585	000321'	201000	000134	BEXFAA: MOVEI EORCOD
   586	000322'	260740	001171'	 PUSHJ P,SCR
   587	000323'	260740	001042'	BEXFBB: PUSHJ P,RCR
   588	000324'	254000	000321'	 JRST BEXFAA    ;NAK
   589	000325'	254000	000331'	 JRST BEXFDD    ;GOOD CHECK RECORD REC'D
   590	000326'	254000	000271'	 JRST SCRCC     ;SOME OTHER RECORD TYPE
   591	000327'	260740	000561'	 PUSHJ P,SNAK
   592	000330'	254000	000323'	 JRST BEXFBB
   593	000331'	201000	000135	BEXFDD: MOVEI EOTCOD
   594	000332'	260740	000334'	 PUSHJ P,USND   ;LAST DATA RECORD OF BUNCH TO END WITH EOT
   595	000333'	254000	000164'	 JRST TAEND
   596
   597				; SEND DATA RECORDS FOR NON-MATCHING CHECK RECORD ENTRIES
   598
   599	000334'	202000	000000*	USND: MOVEM URTT        ;SAVE RECORD TERMINATION TYPE
   600	000335'	400000	000000	 SETZ R0,
   601	000336'	250000	000317*	 EXCH R0,RECL
   602	000337'	202000	000000*	 MOVEM URECL
   603	000340'	250000	000047*	 EXCH R0,CCR0
   604	000341'	202000	000000*	 MOVEM UCCR0
   605	000342'	200000	000000*	 MOVE BP0
   606	000343'	202000	000000*	 MOVEM UBP0
   607	000344'	622700	020000	 TRZE F,SWB
   608	000345'	260740	000105*	 PUSHJ P,SWBAC          ;SELECT COMPRESSION METHOD
   609	000346'	201000	000232*	 MOVEI DNOR
   610	000347'	202000	000000*	 MOVEM DPTR
   611	000350'	202000	000000*	 MOVEM DPTR0
   612	000351'	201000	000000*	 MOVEI RCVR
   613	000352'	202000	000000*	 MOVEM RPTR
   614	000353'	202000	000000*	 MOVEM RPTR0
   615	000354'	260740	000763'	USND1: PUSHJ P,RINIT
   616	000355'	260740	000523'	 PUSHJ P,SPOR
   617	000356'	200000	000353*	 MOVE RPTR0
   618	000357'	202000	000352*	 MOVEM RPTR
   619	000360'	200000	000350*	 MOVE DPTR0
   620	000361'	202000	000347*	 MOVEM DPTR
   621	000362'	260740	000551'	USND2: PUSHJ P,USLOR
   622	000363'	254000	000434'	 JRST USND3             ;FINISHED
   623	000364'	200040	000361*	 MOVE R1,DPTR
   624	000365'	200100	000357*	 MOVE R2,RPTR
   625	000366'	200001	000000	 MOVE FCK1(R1)
   626	000367'	312002	000000	 CAME FCK1(R2)
   627	000370'	254000	000471'	 JRST USND6
   628	000371'	200001	000400	 MOVE FCK2(R1)
   629	000372'	312002	000400	 CAME FCK2(R2)
   630	000373'	254000	000471'	 JRST USND6
   631	000374'	350000	000364*	USND5: AOS DPTR
   632	000375'	350000	000365*	 AOS RPTR
   633	000376'	260740	000516'	 PUSHJ P,ELOR           ;UPDATE RECL
   634	000377'	200000	000115*	 MOVE TOTCCT
   635	000400'	307000	360000	 CAIG MAXRS*6
   636	000401'	254000	000362'	 JRST USND2
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-7
TF.MAC	23-DEC-86 12:29	

   637	000402'	201000	000134	 MOVEI EORCOD
   638	000403'	202000	000000*	 MOVEM RTT
   639	000404'	260740	000777'	 PUSHJ P,ENDREC         ;WE SENT SOMETHING
   640	000405'	260740	000206*	 PUSHJ P,LVBI           ;SENSE IODEND
   641	000406'	260740	000604'	 PUSHJ P,GCOD
   642				 DI <<ACKCOD,USND2A>,<NAKCOD,USND1>,<ERRCOD,FWER>,<PERCOD,FPEW>>^
   643	000407'	514000	000007	 HRLZ R0,C
   644	000410'	200040	001347'	 MOVE R1,[..0013,,..0014]
   645	000411'	540001	000000	 HRR (R1)
   646	000412'	312001	000000	 CAME (R1)
   647	000413'	253040	000411'	 AOBJN R1,.-2
   648	000414'	607040	400000	 TLNN R1,400000
   649	000415'	264000	000277*	 JSR BAD
   650	000416'	550041	000000	 HRRZ R1,(R1)
   651	000417'	254020	000001	 JRST @R1
   652	000420'	000112	000424'	 XWD ACKCOD,USND2A
   653	000421'	000113	000354'	 XWD NAKCOD,USND1
   654	000422'	000146	000302*	 XWD ERRCOD,FWER
   655	000423'	000147	000303*	 XWD PERCOD,FPEW
   656	000424'	260740	000540'	USND2A: PUSHJ P,RUPCNT
   657	000425'	260740	000140*	 PUSHJ P,CKTIM
   658	000426'	260740	000532'	 PUSHJ P,EPOR
   659	000427'	200000	000375*	 MOVE RPTR
   660	000430'	202000	000356*	 MOVEM RPTR0
   661	000431'	200000	000374*	 MOVE DPTR
   662	000432'	202000	000360*	 MOVEM DPTR0
   663	000433'	254000	000354'	 JRST USND1
   664	000434'	606700	000002	USND3: TRNN F,HSW
   665	000435'	254000	000460'	 JRST USND4             ;NOTHING STARTED
   666	000436'	200000	000334*	 MOVE URTT
   667	000437'	202000	000403*	 MOVEM RTT
   668	000440'	260740	000777'	 PUSHJ P,ENDREC
   669	000441'	260740	000405*	 PUSHJ P,LVBI           ;SENSE IODEND
   670	000442'	260740	000604'	 PUSHJ P,GCOD
   671				 DI <<ACKCOD,USND4>,<NAKCOD,USND1>,<ERRCOD,FWER>,<PERCOD,FPEW>>^
   672	000443'	514000	000007	 HRLZ R0,C
   673	000444'	200040	001350'	 MOVE R1,[..0015,,..0016]
   674	000445'	540001	000000	 HRR (R1)
   675	000446'	312001	000000	 CAME (R1)
   676	000447'	253040	000445'	 AOBJN R1,.-2
   677	000450'	607040	400000	 TLNN R1,400000
   678	000451'	264000	000415*	 JSR BAD
   679	000452'	550041	000000	 HRRZ R1,(R1)
   680	000453'	254020	000001	 JRST @R1
   681	000454'	000112	000460'	 XWD ACKCOD,USND4
   682	000455'	000113	000354'	 XWD NAKCOD,USND1
   683	000456'	000146	000422*	 XWD ERRCOD,FWER
   684	000457'	000147	000423*	 XWD PERCOD,FPEW
   685				; RESTORE EVERYTHING
   686	000460'	260740	000540'	USND4: PUSHJ P,RUPCNT
   687	000461'	260740	000425*	 PUSHJ P,CKTIM
   688	000462'	200000	000337*	 MOVE URECL
   689	000463'	202000	000336*	 MOVEM RECL
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-8
TF.MAC	23-DEC-86 12:29	

   690	000464'	200000	000341*	 MOVE UCCR0
   691	000465'	202000	000340*	 MOVEM CCR0
   692	000466'	200000	000343*	 MOVE UBP0
   693	000467'	202000	000342*	 MOVEM BP0
   694	000470'	263740	000000	 POPJ P,                ;RETURN FROM USND
   695	000471'	606700	010000	USND6: TRNN F,TI        ;HAS INPUT BEEN TERMINATED
   696	000472'	260740	000441*	 PUSHJ P,LVBI           ;NO, ISSUE TERMINATE REQUEST NOW
   697	000473'	256000	000112*	 XCT TRANS
   698	000474'	260740	000513'	 PUSHJ P,ELOR1
   699	000475'	254000	000374'	 JRST USND5
   700
   701				; START LOGICAL OUTPUT RECORD
   702	000476'	200000	000075*	SLOR: MOVE CCR
   703	000477'	274000	000463*	 SUB RECL
   704	000500'	307000	000000	 CAIG 0
   705	000501'	263740	000000	 POPJ P,        ;FINISHED
   706	000502'	201040	000135	 MOVEI R1,EOTCOD
   707	000503'	317000	000231*	 CAMG RECSIZ
   708	000504'	254000	000507'	 JRST .+3
   709	000505'	201040	000134	 MOVEI R1,EORCOD
   710	000506'	200000	000503*	 MOVE RECSIZ
   711	000507'	202040	000437*	 MOVEM R1,RTT   ;RECORD TERMINATION TYPE
   712	000510'	202000	000000*	 MOVEM LRECL    ;LOGICAL RECORD LENGTH
   713	000511'	202000	000076*	 MOVEM COUNTB   ;QUANTUM FOR FILE SYSTEM
   714	000512'	254000	000000*	 JRST CPOPJ1    ;SKIP RETURN
   715
   716				; END LOGICAL OUTPUT RECORD.  ADVANCE RECL1 BY LRECL.
   717	000513'	200000	000510*	ELOR1: MOVE LRECL
   718	000514'	272000	000000*	 ADDM RECL1
   719	000515'	263740	000000	 POPJ P,
   720
   721				; END LOGICAL OUTPUT RECORD.
   722	000516'	400000	000000	ELOR: SETZ R0,
   723	000517'	250000	000513*	 EXCH R0,LRECL
   724	000520'	272000	000477*	 ADDM RECL
   725	000521'	272000	000000*	 ADDM BP
   726	000522'	263740	000000	 POPJ P,
   727
   728				; START PHYSICAL OUTPUT RECORD
   729	000523'	402000	000520*	SPOR: SETZM RECL
   730	000524'	402000	000514*	 SETZM RECL1
   731	000525'	200000	000467*	 MOVE BP0
   732	000526'	202000	000521*	 MOVEM BP
   733	000527'	200000	000465*	 MOVE CCR0
   734	000530'	202000	000476*	 MOVEM CCR
   735	000531'	263740	000000	 POPJ P,
   736
   737				; END PHYSICAL OUTPUT RECORD
   738	000532'	400000	000000	EPOR: SETZ R0,
   739	000533'	250000	000523*	 EXCH R0,RECL
   740	000534'	272000	000525*	 ADDM BP0
   741	000535'	210000	000000	 MOVN R0,R0
   742	000536'	272000	000527*	 ADDM CCR0
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-9
TF.MAC	23-DEC-86 12:29	

   743	000537'	263740	000000	 POPJ P,
   744
   745				; UPDATE CCNT=COUNT OF FILE BYTES RECEIVED
   746	000540'	400000	000000	RUPCNT: SETZ R0,
   747	000541'	250000	000524*	 EXCH RECL1
   748	000542'	272000	000044*	 ADDM CCNT
   749	000543'	400000	000000	 SETZ R0,
   750	000544'	250000	000377*	 EXCH TOTCCT
   751	000545'	272000	000000*	 ADDM TRTOT
   752	000546'	047000	000023	 MSTIME R0,
   753	000547'	202000	000000*	 MOVEM ETIME    ;END TIME
   754	000550'	263740	000000	 POPJ P,
   755
   756				; START LOGICAL OUTPUT RECORD--UPDATE MODE
   757	000551'	200000	000530*	USLOR: MOVE CCR
   758	000552'	274000	000533*	 SUB RECL
   759	000553'	307000	000000	 CAIG 0
   760	000554'	263740	000000	 POPJ P,
   761	000555'	200000	000506*	 MOVE RECSIZ
   762	000556'	202000	000517*	 MOVEM LRECL
   763	000557'	202000	000511*	 MOVEM COUNTB
   764	000560'	254000	000512*	 JRST CPOPJ1    ;SKIP RETURN
   765
   766				; SEND NAK
   767	000561'			SNAK: LNKMSG NAKCOD^
   768	000561'	201340	000113	 MOVEI C,NAKCOD
   769	000562'	260740	000745'	 PUSHJ P,SCOD
   770	000563'	260740	001252'	 PUSHJ P,SNDYEL
   771	000564'	375000	000000*	 SOSGE NAKCTR
   772	000565'	264000	000000*	 JSR ZAPINT     ;SIMULATE LOSS OF CIRCUIT
   773	000566'	263740	000000	 POPJ P,
   774
   775				; SEND ACKNOWLEDGEMENT
   776	000567'			SACK: LNKMSG ACKCOD^
   777	000567'	201340	000112	 MOVEI C,ACKCOD
   778	000570'	260740	000745'	 PUSHJ P,SCOD
   779	000571'	260740	001252'	 PUSHJ P,SNDYEL
   780	000572'	263740	000000	 POPJ P,
   781
   782				; INITIALIZE NAKCTR
   783	000573'	201000	000002	INITRN: MOVEI 2
   784	000574'	202000	000564*	 MOVEM NAKCTR
   785	000575'	201000	000000*	 MOVEI PANIC
   786	000576'	202000	000000*	 MOVEM ESCRTN   ;KILL CIRCUIT ON ESCAPE
   787	000577'	263740	000000	 POPJ P,
   788
   789				; FETCH CONTROL CODE WITH 60 SECOND TIMER
   790	000600'			GC60: TIMER 60^
   791	000600'	260740	000000*	 IFG 60,<PUSHJ P,STARTT
   792	000601'	000000	000060	 EXP 60>
   793	000602'	260740	000604'	 PUSHJ P,GCOD
   794	000603'	263740	000000	 POPJ P,
   795
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-10
TF.MAC	23-DEC-86 12:29	

   796				; FETCH CONTROL CODE
   797	000604'	260740	000622'	GCOD: PUSHJ P,GC
   798	000605'	302340	000030	 CAIE C,CAN
   799	000606'	254000	000611'	 JRST .+3
   800	000607'	260740	000622'	 PUSHJ P,GC
   801	000610'	254000	000604'	 JRST GCOD
   802	000611'	302340	000031	 CAIE C,EM
   803	000612'	254000	000604'	 JRST GCOD
   804	000613'	260740	000622'	 PUSHJ P,GC
   805	000614'	307340	000177	 CAIG C,MTOP
   806	000615'	307340	000100	 CAIG C,MBOT
   807	000616'	254000	000604'	 JRST GCOD
   808	000617'	202340	000000*	 MOVEM C,LCOD
   809	000620'	350000	000000*	 AOS TIMFLG     ;ACTIVITY COUNT
   810	000621'	263740	000000	 POPJ P,
   811
   812				; GET CHAR (NOT BUFFERED).  DESTROYS R0
   813	000622'	504000	000000*	GC: HRL R0,AUXPRT
   814	000623'	541000	000000	 HRRI R0,IICHW  ;INPUT IMAGE CHAR, WAIT
   815	000624'	042000	000007	 AUXCAL R0,C
   816	000625'	264000	000565*	 JSR ZAPINT     ;CIRCUIT ZAPPED
   817	000626'	200000	000007	 IFG TESTNG,<MOVE C
   818	000627'	260740	000632'	 PUSHJ P,TRACE>
   819	000630'	350000	000620*	 AOS TIMFLG     ;CHAR INPUT
   820	000631'	263740	000000	 POPJ P,
   821
   822				 IFG TESTNG,<
   823	000632'	331020	000643'	TRACE::SKIPL @ITPT
   824	000633'	254000	000640'	 JRST TRACE1
   825	000634'	261740	000001	 PUSH P,R1
   826	000635'	201040	000644'	 MOVEI R1,ITBUF
   827	000636'	202040	000643'	 MOVEM R1,ITPT
   828	000637'	262740	000001	 POP P,R1
   829	000640'	202020	000643'	TRACE1: MOVEM @ITPT
   830	000641'	350000	000643'	 AOS ITPT
   831	000642'	263740	000000	 POPJ P,
   832	000643'	000000	000644'	ITPT: ITBUF
   833	000644'			ITBUF: BLOCK 100
   834	000744'	777777	777777	 EXP -1
   835				 >
   836				; SEND CONTROL CODE (FROM C)
   837	000745'	202340	000000*	SCOD: MOVEM C,SCOD1     ;SAVE C
   838	000746'	201340	000031	 MOVEI C,EM
   839	000747'	260740	000753'	 PUSHJ P,SBYTE
   840	000750'	200340	000745*	 MOVE C,SCOD1
   841	000751'	260740	000753'	 PUSHJ P,SBYTE
   842	000752'	263740	000000	 POPJ P,
   843
   844				; SEND BYTE.  DESTROYS R0.
   845	000753'	504000	000622*	SBYTE: HRL R0,AUXPRT
   846	000754'	541000	000003	 HRRI R0,OICH
   847	000755'	042000	000007	 AUXCAL R0,C
   848	000756'	200000	000007	 IFG TESTNG,<MOVE C
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-11
TF.MAC	23-DEC-86 12:29	

   849	000757'	435000	400000	 IORI 400000
   850	000760'	260740	000632'	 PUSHJ P,TRACE>
   851	000761'	350000	000630*	 AOS TIMFLG     ;CHAR OUTPUT
   852	000762'	263740	000000	 POPJ P,
   853
   854				; INITIALIZE PHYSICAL RECORD
   855	000763'	402000	000000*	RINIT: SETZM CHECK      ;ZERO THE CHECKSUM
   856	000764'	260740	000000*	 PUSHJ P,OINIT          ;ZEROES TOTCCT
   857	000765'	620700	000002	 TRZ F,HSW              ;NO HEADER YET
   858	000766'	263740	000000	 POPJ P,
   859
   860				; SEND LEAST SIGNIFICANT 24 BITS OF R0 (BUFFERED)
   861	000767'	200040	001351'	BSWD: MOVE R1,[POINT 8,R0,11]   ;* IMPORTANT CW PRESERVES R1
   862				 REPEAT 3,<ILDB C,R1
   863				 PUSHJ P,CW>
   864	000770'	134340	000001	ILDB C,R1
   865	000771'	260740	000000*	 PUSHJ P,CW
   866	000772'	134340	000001	ILDB C,R1
   867	000773'	260740	000771*	 PUSHJ P,CW
   868	000774'	134340	000001	ILDB C,R1
   869	000775'	260740	000773*	 PUSHJ P,CW
   870	000776'	263740	000000	 POPJ P,
   871
   872				; END PHYSICAL RECORD
   873	000777'	260740	001003'	ENDREC: PUSHJ P,ENDR1   ;ALWAYS SKIPS
   874	001000'	000000	000507*	 EXP RTT                ;ADDR. OF CELL CONTAINING RECORD TERMINATION TYPE
   875	001001'	260740	001252'	 PUSHJ P,SNDYEL
   876	001002'	263740	000000	 POPJ P,
   877
   878				; MAKE RECORD ENDING.  DOES NOT SEND YELLOW BALL.  SHOULD BE FOLLOWED BY
   879				;       ADDRESS OF CELL CONTAINING RECORD TERMINATION TYPE
   880	001003'			ENDR1: W [EM]^
   881	001003'	200340	001352'	 MOVE C,[EM]
   882	001004'	260740	000775*	 PUSHJ P,CW
   883	001005'	200077	000000	 MOVE R1,@(P)
   884	001006'	200341	000000	 MOVE C,(R1)
   885	001007'	260740	001004*	 PUSHJ P,CW
   886	001010'	200100	000544*	 MOVE R2,TOTCCT
   887	001011'	200000	000763*	 MOVE CHECK
   888	001012'	260740	000767'	 PUSHJ P,BSWD
   889	001013'	200000	000002	 MOVE R2
   890	001014'	260740	000767'	 PUSHJ P,BSWD
   891	001015'	260740	000000*	 PUSHJ P,FLUSH          ;FLUSH OUTPUT.  DO NOT WAIT FOR COMPLETION.
   892	001016'	254000	000560*	 JRST CPOPJ1
   893
   894				; FETCH CONTROL CODE (BUFFERED)
   895
   896	001017'	260740	000000*	GBCOD: PUSHJ P,BGC
   897	001020'	302340	000030	 CAIE C,CAN
   898	001021'	254000	001024'	 JRST .+3
   899	001022'	260740	001017*	 PUSHJ P,BGC
   900	001023'	254000	001017'	 JRST GBCOD
   901	001024'	302340	000031	 CAIE C,EM
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-12
TF.MAC	23-DEC-86 12:29	

   902	001025'	254000	001017'	 JRST GBCOD
   903	001026'	202340	000000*	 MOVEM C,ICHECK         ;INITIALIZE INPUT CHECKSUM
   904	001027'	201000	000001	 MOVEI 1
   905	001030'	202000	000000*	 MOVEM ICOUNT           ;AND COUNT
   906	001031'	260740	001022*	 PUSHJ P,BGC
   907	001032'	307340	000177	 CAIG C,MTOP
   908	001033'	307340	000100	 CAIG C,MBOT
   909	001034'	254000	001017'	 JRST GBCOD
   910	001035'	202340	000000*	 MOVEM C,LCOD1
   911	001036'	350000	000761*	 AOS TIMFLG     ;ACTIVITY COUNT
   912	001037'	263740	000000	 POPJ P,
   913
   914				; INITIALIZE RECEIVE
   915
   916	001040'	260740	000000*	SINIT: PUSHJ P,IINIT
   917	001041'	263740	000000	 POPJ P,
   918
   919				; READ CHECK RECORD.  RETURNS
   920				;       +1 IF NAK IS RECEIVED.
   921				;       +2 IF GOOD RECORD IS RECEIVED
   922				;       +3 IF SOME OTHER RECORD TYPE IS RECEIVED
   923				;       +4 IF BAD (CHECK) RECORD IS RECEIVED.
   924	001042'	260740	001040'	RCR: PUSHJ P,SINIT
   925	001043'	260740	001017'	 PUSHJ P,GBCOD
   926	001044'	306340	000113	 CAIN C,NAKCOD
   927	001045'	254000	001132'	 JRST RCR1
   928	001046'	302340	000132	 CAIE C,CHKCOD
   929	001047'	254000	001130'	 JRST RCR3
   930	001050'	201100	000351*	 MOVEI R2,RCVR
   931	001051'	260740	001031*	 PUSHJ P,BGC
   932	001052'	202340	000000*	 MOVEM C,CHKCOUNT
   933	001053'	202340	000000*	 MOVEM C,T
   934				;READ 9 BYTES TO FCK1-FCK3.  IMPORTANT BGC SHOULD PRESERVE R0-R1-R2
   935	001054'	200040	001353'	RCR0: MOVE R1,[POINT 8,FCK1(R2),11]
   936				 REPEAT 3,<PUSHJ P,BGC
   937				 IDPB C,R1>
   938	001055'	260740	001051*	PUSHJ P,BGC
   939	001056'	136340	000001	 IDPB C,R1
   940	001057'	260740	001055*	PUSHJ P,BGC
   941	001060'	136340	000001	 IDPB C,R1
   942	001061'	260740	001057*	PUSHJ P,BGC
   943	001062'	136340	000001	 IDPB C,R1
   944	001063'	200040	001354'	 MOVE R1,[POINT 8,FCK2(R2),11]
   945				 REPEAT 3,<PUSHJ P,BGC
   946				  IDPB C,R1>
   947	001064'	260740	001061*	PUSHJ P,BGC
   948	001065'	136340	000001	  IDPB C,R1
   949	001066'	260740	001064*	PUSHJ P,BGC
   950	001067'	136340	000001	  IDPB C,R1
   951	001070'	260740	001066*	PUSHJ P,BGC
   952	001071'	136340	000001	  IDPB C,R1
   953	001072'	200040	001355'	 MOVE R1,[POINT 8,FCK3(R2),11]
   954				 REPEAT 3,<PUSHJ P,BGC
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-13
TF.MAC	23-DEC-86 12:29	

   955				        IDPB C,R1>
   956	001073'	260740	001070*	PUSHJ P,BGC
   957	001074'	136340	000001	        IDPB C,R1
   958	001075'	260740	001073*	PUSHJ P,BGC
   959	001076'	136340	000001	        IDPB C,R1
   960	001077'	260740	001075*	PUSHJ P,BGC
   961	001100'	136340	000001	        IDPB C,R1
   962	001101'	271100	000001	 ADDI R2,1
   963	001102'	371000	001053*	 SOSL T
   964	001103'	254000	001054'	 JRST RCR0
   965	001104'	202100	000000*	 MOVEM R2,RCPTR
   966	001105'	260740	001077*	RCR00: PUSHJ P,BGC
   967	001106'	302340	000031	 CAIE C,EM
   968	001107'	254000	001105'	 JRST RCR00
   969	001110'	260740	001105*	 PUSHJ P,BGC
   970	001111'	202340	000000*	 MOVEM C,IRTT
   971				 DI <<EOTCOD,RCR01>,<EORCOD,RCR01>>^
   972	001112'	514000	000007	 HRLZ R0,C
   973	001113'	200040	001356'	 MOVE R1,[..0017,,..0020]
   974	001114'	540001	000000	 HRR (R1)
   975	001115'	312001	000000	 CAME (R1)
   976	001116'	253040	001114'	 AOBJN R1,.-2
   977	001117'	607040	400000	 TLNN R1,400000
   978	001120'	264000	000451*	 JSR BAD
   979	001121'	550041	000000	 HRRZ R1,(R1)
   980	001122'	254020	000001	 JRST @R1
   981	001123'	000135	001125'	 XWD EOTCOD,RCR01
   982	001124'	000134	001125'	 XWD EORCOD,RCR01
   983	001125'	260740	001134'	RCR01: PUSHJ P,VERIF
   984	001126'	254000	001131'	 JRST RCR2
   985	001127'	350017	000000	RCR4: AOS (P)   ;BAD RECORD
   986	001130'	350017	000000	RCR3: AOS (P)   ;SOME OTHER RECORD TYPE
   987	001131'	350017	000000	RCR2: AOS (P)   ;GOOD CHECK RECORD
   988	001132'	402000	001010*	RCR1: SETZM TOTCCT      ;NAK.
   989	001133'	263740	000000	 POPJ P,        ;DON'T INCLUDE CHECK RECORD COUNT IN TOTCCT.
   990
   991				; VERIFY RECORD CHECKSUM AND BYTECOUNT AND SKIP IF BAD
   992
   993	001134'	476000	000000*	VERIF: SETOM VERIF1
   994	001135'	200000	001026*	 MOVE ICHECK
   995	001136'	404000	001357'	 AND [77,,777777]       ;TRIM TO 24 BITS
   996	001137'	202000	000000*	 MOVEM VERIF2
   997	001140'	200000	001030*	 MOVE ICOUNT
   998	001141'	404000	001357'	 AND [77,,777777]       ;TRIM TO 24 BITS
   999	001142'	202000	000000*	 MOVEM VERIF3
  1000	001143'	260740	001160'	 PUSHJ P,GBWORD
  1001	001144'	312000	001137*	 CAME VERIF2
  1002	001145'	350000	001134*	 AOS VERIF1
  1003	001146'	260740	001160'	 PUSHJ P,GBWORD
  1004	001147'	312000	001142*	 CAME VERIF3
  1005	001150'	350000	001145*	 AOS VERIF1
  1006	001151'	200000	001140*	 MOVE ICOUNT
  1007	001152'	202000	001132*	 MOVEM TOTCCT
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-14
TF.MAC	23-DEC-86 12:29	

  1008	001153'	331000	001150*	 SKIPL VERIF1
  1009	001154'	350017	000000	 AOS (P)
  1010	001155'	335000	001153*	 SKIPGE VERIF1
  1011	001156'	260740	000573'	 PUSHJ P,INITRN
  1012	001157'	263740	000000	 POPJ P,
  1013
  1014				; READ 3 BYTES TO R0.
  1015
  1016	001160'	400000	000000	GBWORD: SETZ R0,        ;**IMPORTANT BGC PRESERVES R0 AND R2
  1017	001161'	200100	001351'	 MOVE R2,[POINT 8,R0,11]
  1018				 REPEAT 3,<PUSHJ P,BGC
  1019				 IDPB C,R2>
  1020	001162'	260740	001110*	PUSHJ P,BGC
  1021	001163'	136340	000002	 IDPB C,R2
  1022	001164'	260740	001162*	PUSHJ P,BGC
  1023	001165'	136340	000002	 IDPB C,R2
  1024	001166'	260740	001164*	PUSHJ P,BGC
  1025	001167'	136340	000002	 IDPB C,R2
  1026	001170'	263740	000000	 POPJ P,
  1027
  1028				; SEND CHECK RECORD.  MAY BE USED BY EITHER DONOR OR RECEIVER.  IT
  1029				;       WILL DEFER SENDING A YELLOW BALL UNTIL A READ IS PUT UP.
  1030	001171'	202000	001102*	SCR: MOVEM T    ;SAVE RECORD TERMINATION TYPE
  1031	001172'	260740	000763'	 PUSHJ P,RINIT
  1032				 W [EM]^
  1033	001173'	200340	001352'	 MOVE C,[EM]
  1034	001174'	260740	001007*	 PUSHJ P,CW
  1035				 W [CHKCOD]^
  1036	001175'	200340	001360'	 MOVE C,[CHKCOD]
  1037	001176'	260740	001174*	 PUSHJ P,CW
  1038	001177'	200340	000255*	 MOVE C,DCPTR
  1039	001200'	275340	000001*	 SUBI C,DNOR+1
  1040	001201'	260740	001176*	 PUSHJ P,CW     ;ONE BYTE= NO. OF BLOCKS TO EXCHANGE - 1
  1041	001202'	201100	000346*	 MOVEI R2,DNOR
  1042	001203'	200040	001353'	SCR1: MOVE R1,[POINT 8,FCK1(R2),11]
  1043				 REPEAT 3,<ILDB C,R1
  1044				 PUSHJ P,CW>
  1045	001204'	134340	000001	ILDB C,R1
  1046	001205'	260740	001201*	 PUSHJ P,CW
  1047	001206'	134340	000001	ILDB C,R1
  1048	001207'	260740	001205*	 PUSHJ P,CW
  1049	001210'	134340	000001	ILDB C,R1
  1050	001211'	260740	001207*	 PUSHJ P,CW
  1051	001212'	200040	001354'	 MOVE R1,[POINT 8,FCK2(R2),11]
  1052				 REPEAT 3,<ILDB C,R1
  1053				 PUSHJ P,CW>
  1054	001213'	134340	000001	ILDB C,R1
  1055	001214'	260740	001211*	 PUSHJ P,CW
  1056	001215'	134340	000001	ILDB C,R1
  1057	001216'	260740	001214*	 PUSHJ P,CW
  1058	001217'	134340	000001	ILDB C,R1
  1059	001220'	260740	001216*	 PUSHJ P,CW
  1060	001221'	200040	001355'	 MOVE R1,[POINT 8,FCK3(R2),11]
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-15
TF.MAC	23-DEC-86 12:29	

  1061				 REPEAT 3,<ILDB C,R1
  1062				 PUSHJ P,CW>
  1063	001222'	134340	000001	ILDB C,R1
  1064	001223'	260740	001220*	 PUSHJ P,CW
  1065	001224'	134340	000001	ILDB C,R1
  1066	001225'	260740	001223*	 PUSHJ P,CW
  1067	001226'	134340	000001	ILDB C,R1
  1068	001227'	260740	001225*	 PUSHJ P,CW
  1069	001230'	271100	000001	 ADDI R2,1
  1070	001231'	312100	001177*	 CAME R2,DCPTR
  1071	001232'	254000	001203'	 JRST SCR1
  1072	001233'	260740	001003'	 PUSHJ P,ENDR1  ;TERMINATE RECORD
  1073	001234'	000000	001171*	 EXP T          ;T CONTAINS TERMINATION TYPE
  1074	001235'	660700	001000	 TRO F,DEFFLG   ;PRIME TO SEND YELLOW BALL WHEN INPUT IS DONE
  1075	001236'	200000	001361'	 MOVE [PUSHJ P,SNDYEL]
  1076	001237'	202000	000000*	 MOVEM ACKROU
  1077	001240'	263740	000000	 POPJ P,
  1078
  1079				; DESTROY RECORD CHECKSUM AND COUNT TO FORCE RETRANSMISSION
  1080	001241'	047000	000023	DSTRY: MSTIME R0,
  1081	001242'	272000	001151*	 ADDM ICOUNT
  1082	001243'	432000	001135*	 XORM ICHECK
  1083	001244'	263740	000000	 POPJ P,
  1084
  1085				; READ RANK TABLE FROM RECORD HEADER
  1086	001245'	200100	001362'	RRANKT: MOVE R2,[-NT,,RANKT]
  1087	001246'	260740	001166*	 PUSHJ P,BGC
  1088	001247'	202342	000000	 MOVEM C,(R2)
  1089	001250'	253100	001246'	 AOBJN R2,.-2
  1090	001251'	263740	000000	 POPJ P,
  1091
  1092
  1093				; ROUTINES EXECUTED BY DEFER.
  1094
  1095				; SEND YELLOW BALL.  SENDS CR TO 370.
  1096	001252'	504040	000753*	SNDYEL: HRL R1,AUXPRT
  1097	001253'	332000	000000*	 SKIPE SW370
  1098	001254'	254000	001261'	 JRST SNDY1
  1099	001255'	541040	000012	 HRRI R1,YELLOW
  1100	001256'	042040	000000	 AUXCAL R1,
  1101	001257'	350000	001036*	 AOS TIMFLG     ;ACTIVITY COUNTER
  1102	001260'	263740	000000	 POPJ P,
  1103	001261'	201340	000011	SNDY1: MOVEI C,HT
  1104	001262'	260740	000753'	 PUSHJ P,SBYTE
  1105	001263'	263740	000000	 POPJ P,
  1106
  1107				; RETURN SUCCESS CODE
  1108	001264'			SUCROU: LNKMSG SUCCOD^
  1109	001264'	201340	000104	 MOVEI C,SUCCOD
  1110	001265'	260740	000745'	 PUSHJ P,SCOD
  1111	001266'	260740	001252'	 PUSHJ P,SNDYEL
  1112	001267'	263740	000000	 POPJ P,
  1113
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 1-16
TF.MAC	23-DEC-86 12:29	

  1114				; USED BY MASTER ONLY TO SEND OPNCOD
  1115
  1116	001270'	201340	000137	OPNROU: MOVEI C,OPNCOD
  1117	001271'	260740	000745'	 PUSHJ P,SCOD
  1118	001272'	200340	000052*	 MOVE C,TMODE
  1119	001273'	260740	000753'	 PUSHJ P,SBYTE
  1120	001274'	307340	000004	 CAIG C,4
  1121	001275'	307340	000002	 CAIG C,2
  1122	001276'	254000	001322'	 JRST OPN1
  1123				; WHEN CALLED FROM TF SEND RPARAM.  FROM RF SEND TPARAM.
  1124	001277'	200340	000000*	 MOVE C,RPARAM          ;BINARY PARAMETERS FOR RECEIVER
  1125	001300'	336000	000000*	 SKIPN DONOR            ;ARE WE DONOR
  1126	001301'	200340	000004*	 MOVE C,TPARAM          ;NO, SEND PARAMETERS FOR TRANSMISSION
  1127	001302'	260740	000753'	 PUSHJ P,SBYTE
  1128	001303'	200000	001272*	 MOVE TMODE
  1129	001304'	302000	000004	 CAIE 4
  1130	001305'	254000	001322'	 JRST OPN1
  1131	001306'	200000	000000*	 MOVE BF
  1132	001307'	242000	000007	 LSH R0,7               ;BLOCKSIZE IS ONE DISC BLOCK (128 WORDS)
  1133	001310'	602700	000020	 TRNE F,SERFLG          ;EXCEPT WHEN USING SERIAL MODE
  1134	001311'	242000	777777	 LSH R0,-1              ;BF IS FOR 2 WORDS
  1135	001312'	332000	000000*	 SKIPE UTBLOCK
  1136	001313'	200000	001312*	 MOVE UTBLOCK
  1137	001314'	202000	000230*	 MOVEM TBLOCK
  1138	001315'	202000	000000*	 MOVEM RBLOCK
  1139	001316'	135340	001363'	 LDB C,[POINT 8,TBLOCK,27]
  1140	001317'	260740	000753'	 PUSHJ P,SBYTE
  1141	001320'	135340	001364'	 LDB C,[POINT 8,TBLOCK,35]
  1142	001321'	260740	000753'	 PUSHJ P,SBYTE
  1143	001322'	260740	001252'	OPN1: PUSHJ P,SNDYEL
  1144	001323'	263740	000000	 POPJ P,
  1145
  1146				; ROUTINE CALLED WHEN WE DO FIRST BLOCK INPUT REQUEST.
  1147
  1148	001324'	261740	000000	DEFER: PUSH P,R0
  1149	001325'	261740	000001	 PUSH P,R1
  1150	001326'	261740	000002	 PUSH P,R2
  1151	001327'	261740	000007	 PUSH P,C
  1152	001330'	256000	001237*	 XCT ACKROU
  1153	001331'	262740	000007	 POP P,C
  1154	001332'	262740	000002	 POP P,R2
  1155	001333'	262740	000001	 POP P,R1
  1156	001334'	262740	000000	 POP P,R0
  1157	001335'	263740	000000	 POPJ P,
  1158				 END
  1159
NO ERRORS DETECTED
PROGRAM BREAK IS 001365
4K CORE USED
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 2
TF.MAC	23-DEC-86 12:29		SYMBOL TABLE

ABIOIP		000000	EXT	CPOPJ1		001016'	EXT	FWER		000456'	EXT	MAXC		000073	SPD
ABTCOD		000107	SIN	CPTOP1		001343'	EXT	G		000103'	EXT	MAXP		000202	SPD
ACKCOD		000112	SPD	CPTOP2		000203'	EXT	GA		000070'	EXT	MAXPA		000021	SPD
ACKROU		001330'	EXT	CR		000015	SPD	GB		000244'	EXT	MAXRS		050000	SPD
ACMCOD		000111	SPD	CW		001227'	EXT	GBCOD		001017'	ENT	MBOT		000100	SPD
ACRCAP		000100	SIN	DCC		000257'	EXT	GBWORD		001160'		MINC		000004	SPD
AMODE		000311	SIN	DCPTR		001231'	EXT	GC		000622'	ENT	MINP		000003	SPD
AS		000011		DEFER		001324'	ENT	GC60		000600'	ENT	MINPA		000002	SPD
ASCII		000002	SIN	DEFFLG		001000	SPD	GCHT		000063'		MINRS		010000	SPD
ASCSTG		000052	SPD	DNOR		001202'	EXT	GCOD		000604'	ENT	MSGSW		002000	SPD
AUTO		000001	SIN	DNRCOD		000101	SPD	GS		000012		MSTIME	047000	000023	
AUXPRT		001252'	EXT	DONOR		001300'	EXT	GX		000013		MTOP		000177	SPD
BAD		001120'	EXT	DPTR		000431'	EXT	HSW		000002	SPD	NAKCOD		000113	SPD
BADCOD		000145	SPD	DPTR0		000432'	EXT	HT		000011	SPD	NAKCTR		000574'	EXT
BCMCOD		000110	SPD	DSTRY		001241'	ENT	IBIO		000034	SPD	NC		000025	SPD
BEX		000232'		EDIT10		100000	SPD	ICHECK		001243'	EXT	NICOD		000133	SPD
BEXB		000244'		ELOR		000516'	ENT	ICOUNT		001242'	EXT	NM		000010	SPD
BEXCK		000310'		ELOR1		000513'		IGNEOF		000100	SPD	NOECHO		000200	SPD
BEXFAA		000321'		EM		000031	SIN	IICHS		000001	SPD	NONE		000400	SIN
BEXFBB		000323'		ENDR1		001003'		IICHW		000000	SPD	NT		000076	SPD
BEXFDD		000331'		ENDREC		000777'		IINIT		001040'	EXT	OB		000037	SPD
BEXFIN		000317'		EORCOD		000134	SPD	ILLCHR		200000	SPD	OFF		000000	SPD
BEXL		000237'		EOTCOD		000135	SPD	INBS		000036	SPD	OICH		000003	SPD
BF		001306'	EXT	EPOR		000532'	ENT	INBW		000035	SPD	OICHI		000004	SPD
BGC		001246'	EXT	ERASCD		000150	SPD	INCHWL	002000	000000		OINIT		000764'	EXT
BI		004000	SPD	ERRCOD		000146	SPD	INITRN		000573'	ENT	ONLCOD		000122	SPD
BIASA		000032	SPD	ESC		000033	SIN	INSCOD		000142	SPD	OPF		000042'	EXT
BIASC		000010	SPD	ESCRTN		000576'	EXT	IODEND		020000	SPD	OPFCOD		000117	SPD
BIASP		000200	SPD	ETIME		000547'	EXT	IOMOD		000014	SPD	OPN1		001322'	
BIASPA		000010	SPD	ETX		000003	SIN	IRTT		001111'	EXT	OPNCOD		000137	SPD
BINCAP		000020	SIN	F		000016		ITBUF		000644'		OPNROU		001270'	ENT
BL		000040	SPD	FATTCD		000141	SPD	ITF		000000'	EXT	OUTCHI	004000	000000	
BP		000526'	EXT	FCK1		000000	SPD	ITPT		000643'		OUTCHR	003000	000000	
BP0		000534'	EXT	FCK2		000400	SPD	IXMODE		000345	SIN	OUTSTR	001000	000000	
BSWD		000767'		FCK3		001000	SPD	KATCAP		000040	SIN	P		000017	
BZCOD		000120	SPD	FENQCD		000140	SPD	KMODE		000407	SIN	PANIC		000575'	EXT
C		000007		FERER		000224'	EXT	LBIO		000042	SPD	PERCOD		000147	SPD
CAN		000030	SIN	FEXT		000003	SPD	LC		000024	SPD	PREFER		000005	
CCNT		000542'	EXT	FIL		000001	SPD	LCO		000004	SPD	PS		000014	
CCR		000551'	EXT	FILFND		040000	SPD	LCOD		000617'	EXT	PX		000015	
CCR0		000536'	EXT	FINCD1		000114	SPD	LCOD1		001035'	EXT	QUICOD		000136	SIN
CHECK		001011'	EXT	FINCD2		000115	SPD	LEFTFG		000010	SPD	R0		000000	
CHGFLG		000200	SPD	FIXCOD		000130	SPD	LF		000012	SPD	R1		000001	
CHKCOD		000132	SPD	FLKCOD		000103	SPD	LM		000007	SPD	R2		000002	
CHKCOU		001052'	EXT	FLKFCD		000106	SPD	LOGCOD		000131	SIN	R3		000003	
CKTIM		000461'	EXT	FLKRCD		000153	SPD	LPAREN		000050	SPD	R4		000004	
CLRBFI	006000	000000		FLKSCD		000161	SPD	LRECL		000556'	EXT	R5		000005	
CLRBFO	005000	000000		FLUSH		001015'	EXT	LT		000075	SPD	RANK		000010	
CLRBO		000007	SIN	FNAME		000020	SPD	LUD		000003	SPD	RANKT		001362'	EXT
COLON		000072	SPD	FPEW		000457'	EXT	LUDFLG		000001	SPD	RBLIC		001336'	EXT
COPYST		000045'	EXT	FPF		000041'	EXT	LVBI		000472'	EXT	RBLOCK		001315'	EXT
COUNTB		000557'	EXT	FPFCOD		000116	SPD	MASKFG		000400	SPD	RC		000004	
CPACOD		000121	SPD	FSIZE	777777	777777	SPD	MASTER		000007'	EXT	RCC		000006	
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87 PAGE 2-2
TF.MAC	23-DEC-86 12:29		SYMBOL TABLE

RCPTR		001104'	EXT	SW370		001253'	EXT	USND1		000354'		
RCR		001042'	ENT	SWB		020000	SPD	USND2		000362'		
RCR0		001054'		SWBAC		000345'	EXT	USND2A		000424'		
RCR00		001105'		SYS		000017	SPD	USND3		000434'		
RCR01		001125'		T		001234'	EXT	USND4		000460'		
RCR1		001132'		TA1		000110'		USND5		000374'		
RCR2		001131'		TA2		000143'		USND6		000471'		
RCR3		001130'		TA5		000106'		UTBLOC		001313'	EXT	
RCR4		001127'		TA6		000137'		VARCOD		000127	SPD	
RCVCOD		000102	SPD	TABSIZ		000010	SPD	VERIF		001134'	ENT	
RCVR		001050'	EXT	TAEND		000164'		VERIF1		001155'	EXT	
RECL		000552'	EXT	TAFIN		000225'		VERIF2		001144'	EXT	
RECL1		000541'	EXT	TBI		000040	SPD	VERIF3		001147'	EXT	
RECSIZ		000555'	EXT	TBLOCK		001364'	EXT	VERNUM		000001	SIN	
RINIT		000763'	ENT	TBO		000041	SPD	WHYCOD		000143	SIN	
RPARAM		001277'	EXT	TESTNG		000001	SPD	XMODE		000351	SIN	
RPAREN		000051	SPD	TF		000000'	ENT	YELLOW		000012	SIN	
RPTR		000427'	EXT	TF0		000046'		ZAPINT		000625'	EXT	
RPTR0		000430'	EXT	TF00		000025'		..0001	777777	777775	SPD	
RRANKT		001245'	ENT	TF01		000043'		..0002		000040'		
RS		000036	SPD	TF1		000072'		..0003	777777	777774	SPD	
RSPCOD		000144	SIN	TF3		000072'		..0004		000133'		
RTT		001000'	EXT	TF4		000227'		..0005	777777	777774	SPD	
RUPCNT		000540'	ENT	TI		010000	SPD	..0006		000160'		
SACK		000567'	ENT	TIMFLG		001257'	EXT	..0007	777777	777774	SPD	
SBYTE		000753'	ENT	TMODE		001303'	EXT	..0010		000221'		
SCOD		000745'	ENT	TOTCCT		001152'	EXT	..0011	777777	777776	SPD	
SCOD1		000750'	EXT	TPARAM		001301'	EXT	..0012		000302'		
SCR		001171'	ENT	TRACE		000632'	INT	..0013	777777	777774	SPD	
SCR1		001203'		TRACE1		000640'		..0014		000420'		
SCRAA		000261'		TRANS		000473'	EXT	..0015	777777	777774	SPD	
SCRBB		000263'		TRICOD		000125	SPD	..0016		000454'		
SCRCC		000271'		TRPCOD		000152	SPD	..0017	777777	777776	SPD	
SCRDD		000304'		TRPDSK		000002	SPD	..0020		001123'		
SDVIOS		000032	SPD	TRTOT		000545'	EXT	
SERFLG		000020	SPD	TRUCOD		000124	SPD	
SINIT		001040'	ENT	TSTRS		014000	SPD	
SIZE		000046'	EXT	U		000006	SPD	
SLOR		000476'	ENT	UBP0		000466'	EXT	
SLVPRT		000043	SPD	UCCR0		000464'	EXT	
SMODE		001000	SIN	UIO		000057'	EXT	
SNAK		000561'	ENT	ULKCOD		000105	SPD	
SNDY1		001261'		ULKFCD		000154	SPD	
SNDYEL		001252'	ENT	ULKSCD		000160	SPD	
SORTFG		000001	SPD	UNAME		000015	SPD	
SPA		000003'	EXT	UPA		000005'	EXT	
SPOR		000523'	ENT	UPDCAP		000010	SIN	
ST		000101'	EXT	UPDMOD		000040	SPD	
STARTT		000600'	EXT	URECL		000462'	EXT	
STE		000000	EXT	URTT		000436'	EXT	
SUCCOD		000104	SPD	US		000037	SIN	
SUCROU		001264'	ENT	USLOR		000551'		

TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87
TF.MAC	23-DEC-86 12:29		Symbol cross reference

ABIOIP	   320%
ABTCOD	    28#
ACKCOD	    31#	   454	   476	   652	   681	   777
ACKROU	   327%	  1076	  1152
ACMCOD	    30#
ACRCAP	     2#
AMODE	   113#
AS	   233#
ASCII	   131#
ASCSTG	   177#
AUTO	   130#
AUXPRT	   338%	   813	   845	  1096
BAD	   323%	   378	   451	   473	   509	   565	   649	   678	   978
BADCOD	    93#
BCMCOD	    29#
BEX	   523#	   574
BEXB	   536#	   581
BEXCK	   537	   575#
BEXFAA	   585#	   588
BEXFBB	   587#	   592
BEXFDD	   589	   593#
BEXFIN	   535	   583#
BEXL	   531#	   548
BF	   335%	  1131
BGC	   320%	   896	   899	   906	   931	   938	   940	   942	   947	   949	   951	   956	   958	   960
	   966	   969	  1020	  1022	  1024	  1087
BI	   210#
BIASA	   144#
BIASC	   137#
BIASP	   134#
BIASPA	   141#
BINCAP	     4#
BL	   125#
BP	   329%	   725	   732
BP0	   329%	   605	   693	   731	   740
BSWD	   861#	   888	   890
BZCOD	    41#
C	   229#	   357	   359	   363	   364	   372	   445	   467	   482	   484	   489	   491	   493	   495
	   497	   503	   559	   576	   578	   580	   643	   672	   768	   777	   798	   802	   805	   806
	   808	   815	   817	   837	   838	   840	   847	   848	   864	   866	   868	   881	   884	   897
	   901	   903	   907	   908	   910	   926	   928	   932	   933	   939	   941	   943	   948	   950
	   952	   957	   959	   961	   967	   970	   972	  1021	  1023	  1025	  1033	  1036	  1038	  1039
	  1045	  1047	  1049	  1054	  1056	  1058	  1063	  1065	  1067	  1088	  1103	  1109	  1116	  1118
	  1120	  1121	  1124	  1126	  1139	  1141	  1151	  1153
CAN	   120#	   798	   897
CCNT	   329%	   385	   748
CCR	   329%	   420	   422	   702	   734	   757
CCR0	   329%	   388	   603	   691	   733	   742
CHECK	   331%	   855	   887
CHGFLG	   206#
CHKCOD	    61#	   928	  1036
CHKCOU	   334%	   932
CKTIM	   321%	   459	   657	   687
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87
TF.MAC	23-DEC-86 12:29		Symbol cross reference

CLRBO	   166#
COLON	   128#
COPYST	   321%	   386
COUNTB	   329%	   423	   713	   763
CPACOD	    43#
CPOPJ1	   325%	   714	   764	   892
CPTOP1	   339%	   486
CPTOP2	   339%	   497
CR	   119#
CW	   320%	   865	   867	   869	   882	   885	  1034	  1037	  1040	  1046	  1048	  1050	  1055	  1057
	  1059	  1064	  1066	  1068
DCC	   333%	   526	   547
DCPTR	   333%	   524	   541	   545	  1038	  1070
DEFER	   318	  1148#
DEFFLG	   208#	  1074
DNOR	   333%	   523	   609	  1039	  1041
DNRCOD	    12#
DONOR	   336%	  1125
DPTR	   333%	   610	   620	   623	   631	   661
DPTR0	   333%	   611	   619	   662
DSTRY	   317	  1080#
EDIT10	   214#
ELOR	   315	   438	   546	   633	   722#
ELOR1	   437	   698	   717#
EM	   121#	   802	   838	   881	   901	   967	  1033
ENDR1	   873	   880#	  1072
ENDREC	   442	   464	   639	   668	   873#
EORCOD	    63#	   550	   571	   585	   637	   709	   982
EOTCOD	    64#	   593	   706	   981
EPOR	   315	   460	   573	   658	   738#
ERASCD	    96#	   515
ERRCOD	    94#	   456	   478	   513	   568	   654	   683
ESC	   122#
ESCRTN	   337%	   786
ETIME	   330%	   753
ETX	   116#
F	   238#	   384	   424	   462	   520	   607	   664	   695	   857	  1074	  1133
FATTCD	    85#	   357
FCK1	   152#	   542	   625	   626	   935	  1042
FCK2	   153#	   543	   628	   629	   944	  1051
FCK3	   154#	   544	   953	  1060
FENQCD	    83#
FERER	   324%	   515
FEXT	   157#
FIL	   241#	   516
FILFND	   213#
FINCD1	    33#	   482
FINCD2	    38#	   512
FIXCOD	    58#
FLKCOD	    14#
FLKFCD	    27#
FLKRCD	    98#
FLKSCD	   101#
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87
TF.MAC	23-DEC-86 12:29		Symbol cross reference

FLUSH	   320%	   891
FNAME	   160#
FPEW	   324%	   457	   479	   514	   569	   655	   684
FPF	   324%	   382
FPFCOD	    39#	   382
FSIZE	   156#
FWER	   324%	   456	   478	   513	   568	   654	   683
G	   327%	   393	   428
GA	   322%	   402	   403	   406
GB	   322%	   404	   405	   407	   536
GBCOD	   316	   896#	   900	   902	   909	   925
GBWORD	  1000	  1003	  1016#
GC	   316	   797	   800	   804	   813#
GC60	   316	   370	   501	   790#
GCHT	   392	   401#
GCOD	   316	   443	   465	   641	   670	   793	   797#	   801	   803	   807
GS	   234#
GX	   235#
HSW	   200#	   462	   664	   857
HT	   117#	  1103
IBIO	   169#
ICHECK	   331%	   903	   994	  1082
ICOUNT	   331%	   905	   997	  1006	  1081
IGNEOF	   205#
IICHS	   163#
IICHW	   162#	   814
IINIT	   320%	   916
ILLCHR	   215#
INBS	   171#
INBW	   170#
INITRN	   315	   351	   783#	  1011
INSCOD	    89#
IODEND	   180#
IOMOD	   179#
IRTT	   340%	   970
ITBUF	   826	   832	   833#
ITF	   322%	   343
ITPT	   823	   827	   829	   830	   832#
IXMODE	   111#
KATCAP	     3#
KMODE	   109#
LBIO	   175#
LC	   148#
LCO	   201#
LCOD	   340%	   808
LCOD1	   340%	   910
LEFTFG	   202#
LF	   118#
LM	   146#
LOGCOD	    60#
LPAREN	   126#
LRECL	   329%	   712	   717	   723	   762
LT	   150#
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87
TF.MAC	23-DEC-86 12:29		Symbol cross reference

LUD	   243#
LUDFLG	   197#
LVBI	   320%	   481	   500	   640	   669	   696
MASKFG	   207#
MASTER	   336%	   353
MAXC	   138#
MAXP	   135#
MAXPA	   142#
MAXRS	   104#	   440	   635
MBOT	    11#	   806	   908
MINC	   139#
MINP	   136#
MINPA	   143#
MINRS	   105#	   389
MSGSW	   209#	   384
MTOP	   102#	   805	   907
NAKCOD	    32#	   455	   477	   653	   682	   768	   926
NAKCTR	   340%	   771	   784
NC	   147#	   148
NICOD	    62#
NM	   145#	   146
NOECHO	   181#
NONE	   132#
NT	   149#	   150	  1086
OB	   172#
OFF	   307#
OICH	   164#	   846
OICHI	   165#
OINIT	   320%	   856
ONLCOD	    48#
OPF	   324%	   383
OPFCOD	    40#	   383
OPN1	  1122	  1130	  1143#
OPNCOD	    67#	  1116
OPNROU	   318	   368	  1116#
P	   239#	   343	   346	   348	   351	   358	   360	   365	   368	   370	   386	   387	   402	   403
	   404	   405	   406	   407	   430	   432	   433	   434	   437	   438	   442	   443	   458	   459
	   460	   464	   465	   480	   481	   483	   485	   490	   492	   494	   496	   498	   499	   500
	   501	   517	   527	   534	   536	   546	   551	   552	   556	   572	   573	   586	   587	   591
	   594	   608	   615	   616	   621	   633	   639	   640	   641	   656	   657	   658	   668	   669
	   670	   686	   687	   694	   696	   698	   705	   719	   726	   735	   743	   754	   760	   769
	   770	   773	   778	   779	   780	   787	   791	   793	   794	   797	   800	   804	   810	   818
	   820	   825	   828	   831	   839	   841	   842	   850	   852	   856	   858	   865	   867	   869
	   870	   873	   875	   876	   882	   883	   885	   888	   890	   891	   896	   899	   906	   912
	   916	   917	   924	   925	   931	   938	   940	   942	   947	   949	   951	   956	   958	   960
	   966	   969	   983	   985	   986	   987	   989	  1000	  1003	  1009	  1011	  1012	  1020	  1022
	  1024	  1026	  1031	  1034	  1037	  1040	  1046	  1048	  1050	  1055	  1057	  1059	  1064	  1066
	  1068	  1072	  1075	  1077	  1083	  1087	  1090	  1102	  1104	  1105	  1110	  1111	  1112	  1117
	  1119	  1127	  1140	  1142	  1143	  1144	  1148	  1149	  1150	  1151	  1153	  1154	  1155	  1156
	  1157
PANIC	   337%	   785
PERCOD	    95#	   457	   479	   514	   569	   655	   684
PREFER	   226#
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87
TF.MAC	23-DEC-86 12:29		Symbol cross reference

PS	   236#
PX	   237#
QUICOD	    65#
R0	   217#	   372	   445	   467	   503	   559	   600	   601	   603	   643	   672	   722	   723	   738
	   739	   741	   746	   749	   752	   813	   814	   815	   845	   846	   847	   861	   972	  1016
	  1017	  1080	  1132	  1134	  1148	  1156
R1	   218#	   345	   347	   361	   366	   373	   374	   375	   376	   377	   379	   380	   391	   392
	   394	   425	   427	   446	   447	   448	   449	   450	   452	   453	   468	   469	   470	   471
	   472	   474	   475	   504	   505	   506	   507	   508	   510	   511	   541	   542	   543	   544
	   560	   561	   562	   563	   564	   566	   567	   623	   625	   628	   644	   645	   646	   647
	   648	   650	   651	   673	   674	   675	   676	   677	   679	   680	   706	   709	   711	   825
	   826	   827	   828	   861	   864	   866	   868	   883	   884	   935	   939	   941	   943	   944
	   948	   950	   952	   953	   957	   959	   961	   973	   974	   975	   976	   977	   979	   980
	  1042	  1045	  1047	  1049	  1051	  1054	  1056	  1058	  1060	  1063	  1065	  1067	  1096	  1099
	  1100	  1149	  1155
R2	   219#	   362	   363	   486	   489	   491	   493	   495	   624	   626	   629	   886	   889	   930
	   935	   944	   953	   962	   965	  1017	  1021	  1023	  1025	  1041	  1042	  1051	  1060	  1069
	  1070	  1086	  1088	  1089	  1150	  1154
R3	   222#	   531	   538	   542	   575	   576
R4	   223#	   532	   539	   543	   577	   578
R5	   225#	   533	   540	   544	   579	   580
RANK	   231#
RANKT	   338%	  1086
RBLIC	   339%	   362
RBLOCK	   335%	  1138
RC	   224#
RCC	   227#
RCPTR	   333%	   965
RCR	   317	   552	   587	   924#
RCR0	   935#	   964
RCR00	   966#	   968
RCR01	   981	   982	   983#
RCR1	   927	   988#
RCR2	   984	   987#
RCR3	   929	   986#
RCR4	   985#
RCVCOD	    13#
RCVR	   333%	   612	   930
RECL	   329%	   583	   601	   689	   703	   724	   729	   739	   758
RECL1	   329%	   718	   730	   747
RECSIZ	   329%	   390	   522	   707	   710	   761
RINIT	   316	   432	   615	   855#	  1031
RPARAM	   335%	  1124
RPAREN	   127#
RPTR	   333%	   613	   618	   624	   632	   659
RPTR0	   333%	   614	   617	   660
RRANKT	   317	  1086#
RS	   123#
RSPCOD	    91#
RTT	   330%	   638	   667	   711	   874
RUPCNT	   315	   458	   480	   656	   686	   746#
SACK	   315	   776#
SBYTE	   316	   360	   365	   485	   490	   492	   494	   496	   498	   839	   841	   845#	  1104	  1119
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87
TF.MAC	23-DEC-86 12:29		Symbol cross reference

	  1127	  1140	  1142
SCOD	   316	   358	   483	   769	   778	   837#	  1110	  1117
SCOD1	   340%	   837	   840
SCR	   317	   551	   586	  1030#
SCR1	  1042#	  1071
SCRAA	   550#	   553
SCRBB	   552#	   557
SCRCC	   555	   558#	   590
SCRDD	   554	   571#
SDVIOS	   168#
SERFLG	   203#	  1133
SINIT	   316	   916#	   924
SIZE	   322%	   387
SLOR	   315	   434	   702#
SLVPRT	   176#
SMODE	   110#
SNAK	   315	   556	   591	   767#
SNDY1	  1098	  1103#
SNDYEL	   318	   499	   770	   779	   875	  1075	  1096#	  1111	  1143
SORTFG	   199#	   424
SPA	   321%	   346
SPOR	   315	   433	   527	   616	   729#
ST	   338%	   425	   426
STARTT	   324%	   791
STE	   338%	   427
SUCCOD	    20#	   381	  1109
SUCROU	   318	  1108#
SW10	   336%	   355
SW370	   336%	  1097
SWB	   212#	   520	   607
SWBAC	   322%	   430	   608
SYS	   159#
T	   337%	   933	   963	  1030	  1073
TA1	   434#	   441
TA2	   435	   462#
TA5	   432#	   455	   461	   477
TA6	   454	   458#
TABSIZ	   115#
TAEND	   463	   476	   480#	   584	   595
TAFIN	   512	   516#
TBI	   173#
TBLOCK	   335%	   521	  1137	  1139	  1141
TBO	   174#
TESTNG	     7#	   817	   822	   848
TF	   315	   343#
TF0	   354	   387#
TF00	   356	   368#
TF01	   381	   384#
TF1	   395	   399	   411#
TF3	   397	   400	   415#
TF4	   398	   520#
TI	   211#	   695
TIMFLG	   330%	   809	   819	   851	   911	  1101
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87
TF.MAC	23-DEC-86 12:29		Symbol cross reference

TMODE	   335%	   344	   391	  1118	  1128
TOTCCT	   331%	   439	   634	   750	   886	   988	  1007
TPARAM	   335%	   345	   347	  1126
TRACE	   818	   823#	   850
TRACE1	   824	   829#
TRANS	   327%	   436	   697
TRICOD	    53#
TRPCOD	    97#
TRPDSK	   242#
TRTOT	   330%	   751
TRUCOD	    51#
TSTRS	   106#	   419
U	   187#	   188	   188#	   189	   189#	   190	   190#	   191	   191#	   192	   192#	   193	   193#	   194
UBP0	   332%	   606	   692
UCCR0	   332%	   604	   690
UIO	   323%	   396
ULKCOD	    21#
ULKFCD	    99#
ULKSCD	   100#
UNAME	   158#
UPA	   321%	   348
UPDCAP	     5#
UPDMOD	   204#
URECL	   332%	   602	   688
URTT	   332%	   599	   666
US	   124#
USLOR	   534	   621	   757#
USND	   572	   594	   599#
USND1	   615#	   653	   663	   682
USND2	   621#	   636
USND2A	   652	   656#
USND3	   622	   664#
USND4	   665	   681	   686#
USND5	   631#	   699
USND6	   627	   630	   695#
UTBLOC	   335%	  1135	  1136
UUOFLG	   183	   189	   190	   191	   192	   193	   194
VARCOD	    56#
VERIF	   317	   983	   993#
VERIF1	   334%	   993	  1002	  1005	  1008	  1010
VERIF2	   334%	   996	  1001
VERIF3	   334%	   999	  1004
VERNUM	     9#
WHYCOD	    90#
XMODE	   112#
YELLOW	   167#	  1099
ZAPINT	   325%	   772	   816
..0001	   373	   384#
..0002	   373	   381#	   384
..0003	   446	   458#
..0004	   446	   454#	   458
..0005	   468	   480#
..0006	   468	   476#	   480
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87
TF.MAC	23-DEC-86 12:29		Symbol cross reference

..0007	   504	   516#
..0010	   504	   512#	   516
..0011	   560	   570#
..0012	   560	   568#	   570
..0013	   644	   656#
..0014	   644	   652#	   656
..0015	   673	   685#
..0016	   673	   681#	   685
..0017	   973	   983#
..0020	   973	   981#	   983
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87
TF.MAC	23-DEC-86 12:29		Macro/Opdef cross reference

CLRBFI	   194#
CLRBFO	   193#
DI	   288#	   371	   444	   466	   502	   558	   642	   671	   971
DIS	   304#	   381	   382	   383	   454	   455	   456	   457	   476	   477	   478	   479	   512	   513
	   514	   515	   568	   569	   652	   653	   654	   655	   681	   682	   683	   684	   981	   982
INCHWL	   190#
LNKMSG	   283#	   767	   776	  1108
MSTIME	   752	  1080
OPD	   184#	   188	   189	   190	   191	   192	   193
OUTCHI	   192#
OUTCHR	   191#
OUTSTR	   189#
TIMER	   308#	   790
W	   244#	   880	  1032	  1035
W1	   248#
W2	   257#
W3	   270#
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87
TF.MAC	23-DEC-86 12:29		Opcode cross reference

ADD	   576	   578	   580
ADDI	   962	  1069
ADDM	   718	   724	   725	   740	   742	   748	   751	  1081
AND	   538	   539	   540	   995	   998
AOBJN	   376	   449	   471	   507	   563	   647	   676	   976	  1089
AOS	   545	   631	   632	   809	   819	   830	   851	   911	   985	   986	   987	  1002	  1005	  1009
	  1101
AUXCAL	   815	   847	  1100
BLOCK	   833
BLT	   427
CAIE	   798	   802	   897	   901	   928	   967	  1129
CAIG	   440	   635	   704	   759	   805	   806	   907	   908	  1120	  1121
CAIN	   926
CAME	   375	   448	   470	   506	   562	   626	   629	   646	   675	   975	  1001	  1004	  1070
CAMG	   420	   707
CLOSE	   516
DEFINE	   184	   244	   248	   257	   270	   283	   288	   304	   308
END	  1158
ENTRY	   315	   316	   317	   318
EXCH	   601	   603	   723	   739	   747	   750
EXP	   792	   834	   874	  1073
EXTERN	   320	   321	   322	   323	   324	   325	   327	   329	   330	   331	   332	   333	   334	   335
	   336	   337	   338	   339	   340
HRL	   813	   845	  1096
HRLZ	   372	   445	   467	   503	   559	   643	   672	   972
HRR	   374	   447	   469	   505	   561	   645	   674	   974
HRRI	   814	   846	  1099
HRRZ	   379	   452	   474	   510	   566	   650	   679	   979
IDPB	   939	   941	   943	   948	   950	   952	   957	   959	   961	  1021	  1023	  1025
IFDEF	   183	   189	   190	   191	   192	   193	   194
IFE	   793
IFG	   791	   817	   822	   848
ILDB	   363	   489	   491	   493	   495	   864	   866	   868	  1045	  1047	  1049	  1054	  1056	  1058
	  1063	  1065	  1067
IMULI	   575	   577	   579
IORI	   364	   849
IRP	   381	   454	   476	   512	   568	   652	   681	   981
JRST	   354	   356	   380	   394	   395	   397	   398	   399	   400	   421	   429	   435	   441	   453
	   461	   463	   475	   511	   535	   537	   548	   553	   554	   555	   557	   567	   574	   581
	   584	   588	   589	   590	   592	   595	   622	   627	   630	   636	   651	   663	   665	   680
	   699	   708	   714	   764	   799	   801	   803	   807	   824	   892	   898	   900	   902	   909
	   927	   929	   964	   968	   980	   984	  1071	  1098	  1122	  1130
JSR	   378	   396	   451	   473	   509	   565	   649	   678	   772	   816	   978
LDB	  1139	  1141
LSH	  1132	  1134
MOVE	   344	   345	   362	   373	   391	   392	   422	   425	   439	   446	   468	   486	   497	   504
	   521	   541	   560	   605	   617	   619	   623	   624	   625	   628	   634	   644	   659	   661
	   666	   673	   688	   690	   692	   702	   710	   717	   731	   733	   757	   761	   817	   840
	   848	   861	   881	   883	   884	   886	   887	   889	   935	   944	   953	   973	   994	   997
	  1006	  1017	  1033	  1036	  1038	  1042	  1051	  1060	  1075	  1086	  1118	  1124	  1126	  1128
	  1131	  1136
MOVEI	   357	   359	   361	   389	   419	   482	   484	   523	   525	   550	   571	   585	   593	   609
	   612	   637	   706	   709	   768	   777	   783	   785	   826	   838	   904	   930	  1041	  1103
TF -- CODE TO TRANSMIT FILE	MACRO 12.5-46.0 08:12 25-OCT-87
TF.MAC	23-DEC-86 12:29		Opcode cross reference

	  1109	  1116
MOVEM	   347	   388	   390	   393	   423	   522	   524	   526	   542	   543	   544	   599	   602	   604
	   606	   610	   611	   613	   614	   618	   620	   638	   660	   662	   667	   689	   691	   693
	   711	   712	   713	   732	   734	   753	   762	   763	   784	   786	   808	   827	   829	   837
	   903	   905	   910	   932	   933	   965	   970	   996	   999	  1007	  1030	  1076	  1088	  1137
	  1138
MOVN	   741
OPDEF	   189	   190	   191	   192	   193	   194
POINT	   362	   486	   861	   935	   944	   953	  1017	  1042	  1051	  1060	  1139	  1141
POP	   828	  1153	  1154	  1155	  1156
POPJ	   517	   694	   705	   719	   726	   735	   743	   754	   760	   773	   780	   787	   794	   810
	   820	   831	   842	   852	   858	   870	   876	   912	   917	   989	  1012	  1026	  1077	  1083
	  1090	  1102	  1105	  1112	  1144	  1157
PUSH	   825	  1148	  1149	  1150	  1151
PUSHJ	   343	   346	   348	   351	   358	   360	   365	   368	   370	   386	   387	   402	   403	   404
	   405	   406	   407	   430	   432	   433	   434	   437	   438	   442	   443	   458	   459	   460
	   464	   465	   480	   481	   483	   485	   490	   492	   494	   496	   498	   499	   500	   501
	   527	   534	   536	   546	   551	   552	   556	   572	   573	   586	   587	   591	   594	   608
	   615	   616	   621	   633	   639	   640	   641	   656	   657	   658	   668	   669	   670	   686
	   687	   696	   698	   769	   770	   778	   779	   791	   793	   797	   800	   804	   818	   839
	   841	   850	   856	   865	   867	   869	   873	   875	   882	   885	   888	   890	   891	   896
	   899	   906	   916	   924	   925	   931	   938	   940	   942	   947	   949	   951	   956	   958
	   960	   966	   969	   983	  1000	  1003	  1011	  1020	  1022	  1024	  1031	  1034	  1037	  1040
	  1046	  1048	  1050	  1055	  1057	  1059	  1064	  1066	  1068	  1072	  1075	  1087	  1104	  1110
	  1111	  1117	  1119	  1127	  1140	  1142	  1143
REPEAT	   487	   862	   936	   945	   954	  1018	  1043	  1052	  1061
SETOM	   993
SETZ	   531	   532	   533	   600	   722	   738	   746	   749	  1016
SETZM	   385	   426	   729	   730	   855	   988
SKIPE	  1097	  1135
SKIPG	   583
SKIPGE	  1010
SKIPL	   823	  1008
SKIPN	   353	   355	  1125
SOJG	   366
SOSGE	   771
SOSL	   547	   963
SUB	   703	   758
SUBI	  1039
TITLE	   313
TLNN	   377	   450	   472	   508	   564	   648	   677	   977
TRNE	  1133
TRNN	   462	   664	   695
TRO	   520	  1074
TRZ	   384	   424	   857
TRZE	   607
XCT	   428	   436	   697	  1152
XORM	  1082
XWD	   381	   382	   383	   454	   455	   456	   457	   476	   477	   478	   479	   512	   513	   514
	   515	   568	   569	   652	   653	   654	   655	   681	   682	   683	   684	   981	   982   G/