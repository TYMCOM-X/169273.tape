


BACKUP.DOC -- Changes from V3(411) TO V4(440)
June 1982






























COPYRIGHT (C) 1974,1980,1981,1982 BY
DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.


THIS SOFTWARE IS FURNISHED UNDER A LICENSE AND MAY BE USED AND  COPIED
ONLY  IN  ACCORDANCE  WITH  THE  TERMS  OF  SUCH  LICENSE AND WITH THE
INCLUSION OF THE ABOVE COPYRIGHT NOTICE.  THIS SOFTWARE OR  ANY  OTHER
COPIES  THEREOF MAY NOT BE PROVIDED OR OTHERWISE MADE AVAILABLE TO ANY
OTHER PERSON.  NO TITLE TO AND OWNERSHIP OF  THE  SOFTWARE  IS  HEREBY
TRANSFERRED.

THE INFORMATION IN THIS SOFTWARE IS SUBJECT TO CHANGE  WITHOUT  NOTICE
AND  SHOULD  NOT  BE  CONSTRUED  AS  A COMMITMENT BY DIGITAL EQUIPMENT
CORPORATION.

DIGITAL ASSUMES NO RESPONSIBILITY FOR THE USE OR  RELIABILITY  OF  ITS
SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DIGITAL.
BKP4.DOC                                                        Page 2


BACKUP.DOC -- Changes from V3(411) TO V4(440)
June 1982



1.0  SUMMARY

This is a combined development and maintenance release  of  BACKUP,  a
program for transferring files between disk and magnetic tape.

Version 4 of BACKUP must  be  loaded  with  field  image  versions  of
HELPER,  WILD,  and  SCAN.   ENDECR and USGSUB are modules specific to
BACKUP;  the ones to be used for loading  BACKUP  are  distributed  on
this tape.

BACKUP version 4 is supported by Digital  Equipment  Corporation,  and
runs  on all supported monitors as released.  Version 4 supersedes all
previous versions, and includes edits up to #440.

Documentation  for  using  BACKUP  is  contained  in  the  help   file
BACKUP.HLP,  the  TOPS10  Operating  System  Commands  Manual, and the
TOPS10 Operator's Guide of the TOPS10 software notebooks.   A  program
logic  manual  for BACKUP and the worker module BACKRS can be produced
by submitting the source files (BACKUP.MAC and BACKRS.MAC)  to  RUNOFF
Version 10.



2.0  EXTERNAL CHANGES

     1.  A new verb, USAGE, which enables USAGE Accounting,  has  been
         implemented.     BACKUP    will   send   IPCF   messages   to
         [SYSTEM]ACTDAE describing  the  disk  space  usage  for  each
         directory  saved.   This  is  a  SAVE  only  operation and is
         similar but more accurate than  the  FACT  option  to  SPACE.
         This requires a new subroutine package USGSUB on REL:.

     2.  Volume switching  for  multi-reel  volume-sets  is  now  done
         automatically through PULSAR, the tape label processor.  When
         end-of-volume is reached  on  a  tape,  a  MOUNT  request  is
         automatically  submitted to the operator.  After the operator
         has fulfilled the  MOUNT  request,  processing  of  the  last
         BACKUP  command  will continue where it left off.  BACKUP has
         no control over  volume  switching.   Because  of  this,  the
         REPEAT  and  MULTIREEL  verbs  which depend on BACKUP knowing
         when end-of-volume has been reached, will  not  work.   Cases
         where  automatic  volume  switching is NOT in effect are when
         the label type (as specified by the LABEL-TYPE switch of  the
         MOUNT  command)  is  BYPASS, BLP or USER-EOT.  In the case of
         BYPASS and BLP (which are the same) BACKUP will perform as in
         the  past  (i.e.  the REPEAT and MULTIREEL switches will work
         and BACKUP will supply the  usual  $BKPEOT  operator  message
         when  EOV  is  reached,  assuming  the user has not specified
         NOMULTIREEL).  In the case of USER-EOT, BACKUP will  be  able
         to  process  the  REPEAT  and  MULTIREEL  switches,  but when
BKP4.DOC                                                        Page 3


         end-of-volume is reached on a  multireel  save,  BACKUP  will
         prompt  PULSAR  to submit a normal mount request to mount the
         next tape, and print the %BKPAMD warning to inform  the  user
         instead of giving the old $BKPEOT operator message.  For more
         information concerning PULSAR and tape  processing  the  user
         should refer to the new TOPS-10 Tape Label Reference Manual.

     3.  Several new error messages have  been  installed  in  BACKUP;
         they are documented in section 6.

     4.  To facilitate USAGE Accounting when the user does not wish to
         backup  files,  a  modification to the handling of a nul tape
         device has been implemented.  If the user specifies "TAPE n",
         where  n  is a nul device (i.e.  NUL:), BACKUP will recognize
         this fact.  When a SAVE operation is performed,  BACKUP  will
         only   do  the  minimal  amount  of  work  needed  for  USAGE
         Accounting (assuming USAGE has been specified).   This  means
         that  BACKUP  will  no longer attempt to copy data to the nul
         device, thus  considerably  increasing  the  speed  of  USAGE
         Accounting.

     5.  If volume switching is being performed (i.e.  anything  other
         than  BYPASS  or  BLP),  the  user  should avoid specifying a
         physical device name when issueing the TAPE command.  If  the
         user  specifies  a physical instead of a logical device name,
         and a volume switch occurs where the operator places the  new
         volume  on  a  different  physical  device, BACKUP will still
         believe that the tape is on the original drive.   BACKUP  has
         no  way  of  knowing that the drive has changed, and thus any
         succeeding operations will fail since BACKUP will use the old
         physical  device  name.  If a logical name is used, then that
         name is automatically applied  to  the  new  device,  and  no
         problems will occur.

     6.  BACKUP can now be run from SFDs.

     7.  Restores to multi-pack file structures will continue to  load
         balance files.  Requires MCO 10133.




3.0  KNOWN BUGS AND DEFICIENCIES

The following deficiencies are known to exist in Version 4:

     1.  Full  .SCWLD  style  of  pattern  replacements  is  not   yet
         implemented.

     2.  "'NOT'",  etc.,  in  full  .LKWLD   implementation   is   not
         operational.

BKP4.DOC                                                        Page 4


4.0  INSTALLATION INSTRUCTIONS

Files involved:

BACKUP.MAC, BACKRS.MAC, ENDECR.MAC, USGSUB.MAC -- source  files  which
make up this product.

BACKUP.EXE -- the executable file.

BACKUP.HLP -- the help file.

BACKUP.DOC -- the documentation file.

To install BACKUP on your system, copy the file BACKUP.EXE to SYS:.

The distributed version of BUILD.CTL was used to  first  build  BACKUP
using  field  image  software.   Customers  who wish to rebuild BACKUP
after installing any changes can use  BUILD.CTL  as  a  guide  to  the
building  process.  In that case, however, it is unlikely that the CTL
file can be executed without modification on most  user  systems.   In
particular,  attention  should  be  given to ersatz devices, structure
names, PPNs and other such system parameters.

The following TOPS-10 commands provide a quick way of creating  a  new
version of BACKUP.EXE.  To build the program you must use MACRO V.53A:

     .LOAD BACKUP.MAC, BACKRS.MAC
     .SSAVE BACKUP

This assumes MACTEN.UNV, UUOSYM.UNV and SCNMAC.UNV are on device  UNV:
and that SCAN.REL, WILD.REL, HELPER.REL, ENDECR.REL and USGSUB.REL are
on REL:.



5.0  INTERNAL CHANGES

Edit                      Description

412       Be more lenient with the batch operator when requesting that
                  the  response  to BKPEOT be GO.  Some users may wish
          to type tape    information after the GO  for  documentation
          purposes.   As long as GO has been typed, ignore the rest of
          the line and proceed.

413       RENAME the UFD after saving it if  the  user  has  specified
          USAGE.   This  is to update .RBLAD in the UFD rib.  Also fix
          up the USAGE  verb  to  check  if  user  is  allowed  to  do
          accounting.  New fatal error message BKPCDU.

414       Change BKPAMD from a warning to an informational message.

415       Deleted by edit 435.

416       Needs edits 421 and 432.  Return filename  on  WHAT  runtime
BKP4.DOC                                                        Page 5


          command with /PRINT and /LIST.

417       Make sure account string pointer is legitimate before trying
          to  save  the  account  string.  If it is not, then assume a
          null string.

420       When clearing the use bits in the buffer ring  so  that  the
          buffers  can  be  rewritten, also set the virgin buffer bit.
          This will prompt the monitor to reset its buffer counters so
          that  they  do not get out of sync with the actual number of
          buffers available to be written (according to  the  new  use
          bit settings).

421       Needs edit 432.
          Initialize THSRDB every time a new file is to be started.

422       Replaced by edit 436.

423       Set new bit RB.NLB when ENTERing files on  disk.   This  new
          bit  will  cause the file to be written on the emptiest unit
          in the structure regardless  of  the  state  of  other  open
          files.  MCO 10133 must be installed.

424       Improve edit 254.

425       Set NOSCAN flag when ENTER fails due to SFD  not  found  and
          MAKSFD tries to create one.

426       Requires edit 433 and edit 437.
          Inform the user  of  possible  label  type  conflicts.   Add
          warning  message  BKPDLT.   The  second message, BKPTGC will
          give the option to the user to continue or to quit.

427       Set RP.BFA if bad file was saved while doing restore.

430       Conditionalize a line of Usage code that got missed.

431       Use field image version of SCAN and WILD (versions 7D).

432       QAR 10-06849    BAH 5-Mar-82
          Edit 421 was not complete.  It  caused  ill  mem  refs  when
          doing  SAVEs  with  /REPEAT  switch  on the second save of a
          file.

433       In-house        BAH 1-Apr-82
          Edit 426 needs some  extra  checking.   Any  combination  of
          label types BYPASS, UNLABELLED, and USER-EOT are also OK.

434       None.   BAH     5-Apr-82
          BACKUP still believes ACs 0, 7, 11, and 17  contain  correct
          GETSEG  information  from the RUN UUO.  Use GETTABs instead.
          Also do  some  code  and  comment  cleanup  such  as  delete
          internal UUOSYM definitions.

435       None.   BAH     13-Apr-82
BKP4.DOC                                                        Page 6


          Delete edit 415.  It does not solve the  problem  stated  in
          SPR 10-30827, trashes files, and skips tape error reporting.
          More investating needs to be done before the bug is fixed.

436       10-32229        BAH 21-Apr-82
          The creation date/time is not restored correctly if  a  file
          is  being superseded.  There are other pieces of information
          that can be destroyed by  the  subroutine  HOLDIT.   Rewrite
          HOLDIT  to use its own LOOKUP block.  This edit deletes edit
          422 and some parts of other edits  that  tried  to  preserve
          file information piecemeal.

437       In-house.       BAH 26-MAY-82
          Edit 426 stored the label type iff the user typed  the  TAPE
          command.   Also  store  the  label  type if the logical name
          BACKUP is being used.  This edit moves  the  routine  LABTYP
          from  BACKRS  to  BACKUP  which  is the only module that has
          calls to it.  Also create the routine LABCLR  to  clear  any
          tape labelling errors if any exist.  If the device specified
          by the TAPE command  was  NUL:,  skip  density  checking  in
          routine TAPOPE.

440       In-house.       BAH 18-Jun-82
          Output error 14 after the OUT UUO @DSKIN/OUT.  WAIT UUOs are
          done  before the GETSTS.  The monitor clears error bits when
          the WAIT UUO is done causing the GETSTS to return  no  error
          bits.  BACKUP then reports only the data mode for the error.
          Do the GETSTS before the WAIT.



6.0  NEW ERROR MESSAGES

This section documents new error messages incorporated into BACKUP.



6.1  New Informational Messages

[BKPAMD Asking MDA for next volume]

          GALAXY has submitted a mount  request  to  the  operator  to
          mount the next volume of a multi-reel set.



6.2  New Warning Messages


%BKPDLT Tape being read [label-type] was written [label-type]

          A label conflict exists on a restore.  The user mounted  the
          tape  with  the  label-type  reported  first;   however, the
          label-type reported second was the label-type used to  write
          the  tape.   This  error  message  is always followed by the
BKP4.DOC                                                        Page 7


          $BKPTGC error.  Any combination  of  BYPASS,  USER-EOT,  and
          NOLABEL is not reported.

%BKPNCU Not enough Core for Usage accounting

          The CORE UUO failed while trying to get more memory so  that
          Usage accounting could be performed.  The SAVE operation was
          aborted.

%BKPPUD Please use .DISMOUNT monitor command instead of UNLOAD

          The  UNLOAD  verb  can  only  be  used  when  bypass   label
          processing  is  in  effect, as when /LABEL:BYPASS is used in
          the MOUNT command.  The user must exit BACKUP  and  use  the
          DISMOUNT monitor command.

$BKPTGC errors may occur type "GO" to continue..

          This error message always follows the  error  %BKPDLT.   The
          user has an option to continue the restore.



6.3  New Fatal Error Messages

?BKPCDU Cannot do USAGE Accounting from this PPN

          The user specified USAGE but is not running BACKUP from  the
          correct  PPN.   The  user  must  run  BACKUP  from  the  PPN
          specified by the %LDFFA option to the GETTAB command.   This
          is the full file access PPN and is usually [1,2].

?BKPDVF DEVOP. failed with error code [code]

          This message may follow either the ?BKPTLE  or  the  ?BKPCGT
          error  message  and  indicates that the DEVOP.  monitor call
          (.DFRES function) to retrieve the  device  status  code  has
          failed.   The code returned indicates the reason for failure
          and is described, along with the DEVOP.   monitor  call,  in
          the  TOPS-10  Monitor  Calls manual.  After this message has
          been printed, BACKUP exits to monitor level.  CONTINUEs  are
          disallowed, the user must restart BACKUP.

?BKPOPA [error message], operation aborted

          This message may follow either the ?BKPTLE  or  the  ?BKPCGT
          error  message  and  provides  one of several error messages
          specifying the label error that occured.  The error  message
          corresponds to the device status code returned by the .DFRES
          function of the DEVOP.  monitor call, which is described  in
          the  TOPS-10  Monitor  Calls manual.  After this message has
          been printed, BACKUP exits to monitor level.  CONTINUEs  are
          disallowed, the user must restart BACKUP.

?BKPTLE Error detected by tape label handler
BKP4.DOC                                                        Page 8


          PULSAR detected an error while  BACKUP  was  performing  the
          specified   operation   (SAVE,  RESTORE,  etc.).   You  have
          probably mounted  the  wrong  tape,  and  do  not  have  the
          required   access   priviledges  to  perform  the  requested
          operation.  This message is always followed  by  either  the
          ?BKPOPA or the ?BKPDVF error message.



[End of BKP4.DOC]

[BKP3.DOC is appended as an integral part of BKP4.DOC]
BKP3.DOC                                                        Page 9


BACKUP.DOC -- Changes from V2A(313) TO V3(411)
March 1981



1.0  SUMMARY

This is a combined development and maintenance release  of  BACKUP,  a
program for transferring files between disk and magnetic tape.

Version 3 of BACKUP must be loaded with SCAN Version 7B, WILD  Version
7A, and field image versions of HELPER, ENDECR and USGSUB.

BACKUP version 3 is supported by Digital  Equipment  Corporation,  and
runs  on all supported monitors as released.  Version 3 supercedes all
previous versions, and includes edits up to #410.

Documentation  for  using  BACKUP  is  contained  in  the  help   file
BACKUP.HLP,  the  Operating  System  Commands  Manual,  and the System
Programming Procedures and Techniques section of the TOPS-10  software
notebooks.   A  program  logic manual for BACKUP and the worker module
BACKRS can be produced by submitting the source files (BACKUP.MAC  and
BACKRS.MAC) to RUNOFF Version 10.



2.0  EXTERNAL CHANGES

      1.  There have been several changes and corrections  to  default
          path  handling  that  may  affect  users.  These changes are
          mentioned in the next three points.

      2.  The path specification [-] is defined as the  current  path,
          as opposed to the current path plus all inferiors.

      3.  The blank default  for  INTERCHANGE  mode  RESTOREs  is  now
          defined  as  the current path, rather than the UFD.  This is
          the same as using the [-] path specification.

      4.  When a PPN is not specified,  the  default  is  the  current
          paths' UFD (and all inferior SFDs) rather than the logged in
          PPN.  The exception to this rule is noted  in  the  previous
          point.

      5.  When using /MULTIREEL (the default setting), the tape number
          will not be reinitialized to 1 for each new SAVE command.

      6.  Several new error messages have been installed into  BACKUP,
          they are documented in section 6.

      7.  A modification to the handling of a nul tape device has been
          implemented.   If  the user specifies "TAPE n", where n is a
          nul device (i.e.  NULACKUP will  recognize  this  fact.
          When  a  SAVE  operation is performed, BACKUP will no longer
          attempt to copy data to the nul device.  Also,  BACKUP  will
BKP3.DOC                                                       Page 10


          only LOOKUP the file if the user has specified LIST, DELETE,
          or SDELETE.



3.0  KNOWN BUGS AND DEFICIENCIES

          The following deficiencies are known to exist in Version 3:

      1.  Full .SCWLD  style  of  pattern  replacements  are  not  yet
          implemented.

      2.  "'NOT'",  etc.,  in  full  .LKWLD  implementation   is   not
          operational.



4.0  INSTALLATION INSTRUCTIONS

Files involved:

BACKUP.MAC, BACKRS.MAC -- source files which make up this product.

BACKUP.EXE -- the executable files.

BACKUP.HLP -- the help file.

BACKUP.DOC -- the documentation file.

BACKUP.PLM, BACKRS.PLM -- program logic  manuals  extracted  from  the
          source files by RUNOFF V.10.

To install BACKUP Version 3 on your system, copy the  file  BACKUP.EXE
to SYS:.

The distributed version of BUILD.CTL was used to  first  build  BACKUP
using  field  image  software.   Customers  who wish to rebuild BACKUP
after installing any changes can use  BUILD.CTL  as  a  guide  to  the
building  process.  In that case, however, it is unlikely that the CTL
file can be executed without modification on most  user  systems.   In
particular,  attention  should  be  given to ersatz devices, structure
names, PPNs and other such system parameters.

The following TOPS-10 commands provide a quick way of creating  a  new
version of BACKUP.EXE.  To build the program you must use MACRO V.53A:

     .LOAD BACKUP.MAC, BACKRS.MAC
     .SSAVE BACKUP

This assumes MACTEN.UNV, UUOSYM.UNV and SCNMAC.UNV are on device  UNV:
and  that  SCAN.REL  (SCAN  Version  7B), WLD7A.REL (WILD Version 7A),
HELPER.REL, ENDECR.REL and USGSUB.REL are on REL:.
BKP3.DOC                                                       Page 11


5.0  INTERNAL CHANGES

Edit                     Description

314       Don't throw away high segment if run from tape.

315       Fix edit 303 to remove magic numbers  and  syncronize  stack
          when error occurs;  also remove objectionable comment lines.

316       Make backup  handle  defaults  more  discreetly,  especially
          version-numbers.

317       Fix edit 230;  it looks for the PPN in the wrong place  when
          setting up for an /SDELETE CHKACC

320       Keep the contents of the TTY buffer  symchronized  with  the
          PSI  interrupts  in  order  to  avoid  unprocessed  commands
          waiting in the TTY buffer.

321       Use out-of-sequence records, warning user of the  occurance.
          Don't reject unexpected repeater records.

322       Prevent BACKRS from renaming files to a 000 protection  code
          when they are split or last on a tape.

323       Speed up restore by not doing an extra lookup  to  determine
          file size.

324       Save .RBPPN where necessary to prevent losing  the  path  to
          the file.

325       Correct default path handling

326       Correct tape density handling:  make sure density  gets  set
          for   EOT   and   other  operations,  make  density  setting
          consistent, avoid loss of density during error recovery.

327       Make INITIAL specifications containing SFDs work.

330       Change certain BYTE pseudo-ops so that BACKRS  will  compile
          under MACRO version 53A.

331       Handle interchange-mode restores as a special case, so  that
          they default to the current path instead of the UFD.

332       Make [-] function as current path, not as current path  plus
          all inferiors.

333       Supress  Supercede  display  during  WHAT  when  saving  and
          checking.

334       Show block number in WHAT.

335       Place  all  possible   FRS   support   code   under   FT$FRS
          conditional.
BKP3.DOC                                                       Page 12


336       Make the current path's UFD the  blank-default  PPN,  rather
          than using the logged-in PPN.

337       Prevent many monitor disk accesses and thereby speed up  the
          SAVE  operation by holding onto a file in the current UFD so
          that the monitor PPB for  the  UFD  is  preserved  over  the
          entire SAVE of that UFD.

340       Prevent  BACKRS   from   adding   spurious   characters   to
          three-character filenames being RESUMED.

341       Add three-level handling of time and date switches.   LOCAL,
          GLOBAL,  and  PERMANENT stickyness.  (The feature is under a
          feature-test switch because it represents a major change  in
          historical behavior that will not be desired by all users.)

342       Extend edit 337 (speed SAVES up by  about  25%)  to  include
          RESTORE.   Also modify edit 337 slightly to make the RESTORE
          changes easy to integrate.

343       Disallow wild PPNS while RESTORING in INTERCHANGE mode.

344       Feature - when using /MULTIREEL (DEFAULT), tape number  will
          not be reinitialized to 1 for each new SAVE command.

345       Use MDA to get volume switching  done,  if  the  label  type
          suggests  that  this  may  work.   also,  if  tape  name  is
          defaulted to BACKUP, use the logical name BACKUP instead  of
          the DEVNAM to which it maps.

346       Fix for EDIT 343 to  allow  [*,*],  which  will  default  to
          current path.

347       Add a flag in the COMMUNICATIONS SECTION to flag when /tpnum
          is used so the number won't get trashed.

350       Check for lower case ALL in the PRINT command scanning.

351       Change edit 314 so it will  run  a  little  faster.   Update
          disclaimers.

352       Fix BACKRS so that when DSK or ALL is specified with  a  PPN
          on a RESTORE we will not halt with a file not found error if
          the first structure with that PPN fails.

353       Fix routine TSTRPT in  BACKRS  so  that  when  checking  the
          buffer  count, we only test the right half of the word.  The
          left half  is  reserved  for  monitor  bookkeeping  and  may
          contain data.

354       Fix BACKRS so that when restoring files, the  creation  date
          is   restored   properly.    This   did   not   happen  when
          checkpointing was being done, or when  a  file  was  written
          across volumes.
BKP3.DOC                                                       Page 13


355       If /REPEAT has been given along with /DELETE, do not  delete
          a  file  that  was  written across volumes until it has been
          rewritten.

356       Fix problems with files split across  reels  in  INTERCHANGE
          mode  and  files  protected by FILDAE.  Do protection rename
          for all non-[1,2] restores and for [1,2] if  protected  000>
          or  FILDAE  protected.  GETTAB users default protection then
          system default protection if AD.PRO = 0.

357       Use FILOP.  instead of USETI or  USETO  when  positioning  a
          file.   18  bits  is  not  always  large  enough for a block
          specification, FILOP.  provides  a  whole  word  (36  bits).
          This  change is not necessary for USETIs that merely positon
          to the beginning or end of a file.

360       Fix BACKUP so that it can be run execute only.

361       Fix /LIST so that it will not split the list file if  it  is
          written to an SFD.

362       Remove LABEL  verb  since  BACKUP  will  never  be  able  to
          manipulate label types.

363       Make BKPPUD merely a warning and not a fatal error message.

364       Implement USAGE verb for USAGE Accounting.  BACKUP will send
          IPCF  messages  to  [SYSTEM]ACTDAE describing the disk space
          usage for  each  directory  saved.   This  is  a  SAVE  only
          operation  and  is  similar  but more accurate than the FACT
          option to SPACE.  This requires  a  new  subroutine  package
          USGSUB on REL:

365       Fix code for density setting in TAPOPN to  restore  argument
          in AC 1 which may be modified by new patch to TAPOPN.

366       Fix problems with PRINT and LIST when a path  contains  five
          levels of SFD's.

367       Check for error after performing SKIP.  If one occurs  print
          new error message BKPSKF.

370       Make W a legal abbreviation for WHAT all the time.

371       Fix up edit 344 a bit.  Get rid of NTPE which is  no  longer
          used.

372       Initialize S.SRF and S.SRD to -1 so that user defaults  will
          be applied correctly.

373       Make sure that a mistyped runtime  command  returns  an  IRC
          error.   Make  GO  the  only  valid  response in the case of
          BACKUP running from a batch job and waiting to  continue  on
          the next tape.
BKP3.DOC                                                       Page 14


374       Initialize F$MBF, F$MSN and S.NFS properly so that  MBEFORE,
          MSINCE and NFS can be set in SWITCH.INI.

375       Check for a null tape device during TAPE command.  If device
          is  null,  then  make  sure  only  minimal work is done (for
          USAGE) when processing files (i.e.   don't  do  actual  file
          transfers).

376       Change "RELEASE HOLD" to "RELEASE HOLD," at RLSSTR+3 and  at
          HOLDRL+2.

377       If the log file for the LIST option is found in  LIB:,  thus
          generating an error code 5, CLOSE the file and reENTER it in
          non-update mode.

400       Make edit 375 even faster if user  does  not  specify  LIST,
          DELETE, or SDELETE.

401       Speed up edit 373 a little bit in OPRCM1.

402       Fix BACKUP so that it will recognize errors detected by  the
          tape label handler and print out appropriate error messages.

403       Make CHECK ALL:  work in interchange mode.

404       Only do TAPOP.  to clear  tape  label  errors  if  an  error
          actually occured.  This TAPOP.  performs a rewind.

405       Generate more informative error messages when the TAPOP.  to
          force  end  of  volume processing fails.  New errors message
          BKPINS.

406       Default structure name to DSK:  in RSTFIL.

407       Some more fixing up for when we encounter tape label errors.

410       Several codes returned by the DEVOP.,  .DFRES  monitor  call
          are  nonfatal,  informative  messages.  Test for these cases
          and don't clear the bits since this will  rewind  the  tape.
          When  opening  a  tape, only test for label errors if a TAPE
          command is being executed.

411       Make sure that the tape device is actually controlled by MDA
          before  deciding  if an UNLOAD operation would fail.  If MDA
          is not controlling the device or if BYPASS label  processing
          has been specified then the UNLOAD will work.



6.0  NEW ERROR MESSAGES

This section documents new error  messages  incorporated  into  BACKUP
since  the  last  update  of  the  BACKUP  specification in the System
Programming Procedures and Techniques section of the TOPS-10  software
notebooks.
BKP3.DOC                                                       Page 15


6.1  DELETED MESSAGES

%BKPDIO Disk I/O error [error bits] during [spec]

          This error message has been  superceded  by  two  new  error
          messages, %BKPDIE and %BKPDOE, which are defined below.

?BKPIRC Invalid run time command -- type KILL to abort run first

          The text of this error message has been changed to:

          ?BKPIRC Invalid run time command

6.2  NEW OPERATOR MESSAGES

$?BKPICG Invalid command, please make sure that tape is ready then
respond GO

          This error message is sent to the batch  operator's  console
          if he replies to the $BKPEOT or the $BKPTWL message with any
          response other than GO.  The operator should make sure  that
          the  next  tape  has been mounted correctly and then respond
          with GO.

6.3  NEW WARNING MESSAGES

%BKPAMD Asking MDA for next volume

          A mount request has been submitted by GALAXY to the operator
          to mount the next volume of a multi-reel set.

%BKPBMT Block missed on tape, expected [spec] (block = n)

          The block number of the current block is greater  than  that
          of the block expected, data may be missing.  This message is
          always followed  by  the  %BKPFLC  error  message  which  is
          described below.

%BKPCRH Cannot read HOME block for structure "[file structure]"

          While doing independent super I/O, the HOME block could  not
          be  read.   This error can only occur if the FT$IND assembly
          switch is on, which is unsupported.

%BKPDFE Disk file had errors when SAVEd [spec]

          The specified file being restored or checked had disk errors
          when it was saved.  The data may be corrupted.

%BKPDIE disk input error [error bits] (block = n) during [spec]

          A disk input error occured  while  attempting  to  save  the
          specified  file.   The  error bits are those returned by the
          monitor GETSTS call.  The block number is  the  block  where
          the  error  occured.  It may contain corrupted data when the
BKP3.DOC                                                       Page 16


          file is restored.

%BKPDOE Disk output error [error bits] during [spec]

          A disk output error occured while attempting  to  write  the
          specified  file.   The  error bits are those returned by the
          monitor GETSTS call.  The transfer will be aborted for  this
          file.

%BKPDSE Disk save error (block = n) [spec]

          The specified file being restored  or  checked  had  a  disk
          error  when  the  indicated block was saved.  That block may
          contain unreliable  information.   This  warning  is  always
          followed  by  %BKPDFE when the restore or check operation is
          completed.

%BKPFLC File continuing with [spec] (block = n)

          This message immediately follows the %BKPBMT  error  message
          described above.  The block number is the number of the next
          block read after the occurance of the %BKPBMT error message.

%BKPFRE File RENAME error [error bits] ([code]) [spec]

          File rename error for the indicated file.   The  error  code
          included is that returned by the monitor, and the error code
          abbreviation is listed in the TOPS-10 monitor calls  manual,
          Appendix  E.   This  warning  occurs at the end of a restore
          operation on a file when the proper protection code and size
          estimate are given to the file using a RENAME UUO.

%BKPNCU Not enough Core for Usage accounting

          The CORE UUO failed while trying to get more memory so  that
          Usage accounting could be performed.  The SAVE operation was
          aborted.

%BKPPBR Prior block repeated rereading/rewritting from [spec] (block =
          n)

          An out of sequence record was found.  This  record  will  be
          used in place of the prior corresponding record.

%BKPPUD Please use .DISMOUNT monitor command instead of UNLOAD

          The  UNLOAD  verb  can  only  be  used  when  bypass   label
          processing  is  in  effect, as when /LABEL:BYPASS is used in
          the MOUNT command.  The user must exit BACKUP  and  use  the
          DISMOUNT monitor command.

%BKPSDI Specified density incorrect, density  used  is  code  [density
          code]

          The user has  specified  an  illegal  density.   This  error
BKP3.DOC                                                       Page 17


          message returns the density code of the density that will be
          used.  This code may be interpreted by  refering  to  .TFDEN
          function  of  the  TAPOP.  monitor call in the Monitor Calls
          Reference Manual.

6.4  NEW FATAL ERROR MESSAGES

?BKPCGT Can't get next tape

          The mount request for the next volume in  a  multi-reel  set
          failed.   This  message  is  always  followed  by either the
          ?BKPDVF,  ?BKPINS  or  the  ?BKPOPA  error  message.   These
          messages describe the failure in more detail.

?BKPDVF DEVOP. failed with error code [code]

          This message may follow either the ?BKPTLE  or  the  ?BKPCGT
          error  message  and  indicates that the DEVOP.  monitor call
          (.DFRES function) to retrieve the  device  status  code  has
          failed.   The code returned indicates the reason for failure
          and is described, along with the DEVOP.   monitor  call,  in
          the  TOPS-10  Monitor  Calls manual.  After this message has
          been printed, BACKUP exits to monitor level.  CONTINUEs  are
          disallowed, the user must restart BACKUP.

?BKPINS Insufficient number of reels specified

          The user did not specify enough reels in the MOUNT  request.
          This  error  can  only  occur during a read operation.  This
          error is always preceeded  by  the  ?BKPCGT  error  message.
          After this message has been printed, BACKUP exits to monitor
          level.   The  user  should  submit  another  MOUNT   request
          specifying all the appropriate volumes.

?BKPNZT Negative and zero tape numbers illegal

          The argument to  the  TPNUMB  command  was  not  a  positive
          decimal integer.

?BKPOPA [error message], operation aborted

          This message may follow either the ?BKPTLE  or  the  ?BKPCGT
          error  message  and  provides  one of several error messages
          specifying the label error that occured.  The error  message
          corresponds to the device status code returned by the .DFRES
          function of the DEVOP.  monitor call, which is described  in
          the  TOPS-10  Monitor  Calls manual.  After this message has
          been printed, BACKUP exits to monitor level.  CONTINUEs  are
          disallowed, the user must restart BACKUP.

?BKPSKF SKIP failed, tape position error

          The SKIP operation failed.  The user should NOT attempt  any
          further read or write operations until the tape is correctly
          repositioned.  Failure to position the tape correctly  could
BKP3.DOC                                                       Page 18


          result  in  overwriting  existing data or reading files from
          the wrong saveset.

?BKPTLE Error detected by tape label handler

          An error was detected by PULSAR's tape label  handler  while
          performing  the  specified  operation  (SAVE, RESTORE,etc.).
          The most likely  case  is  that  the  wrong  tape  has  been
          mounted,  and  the  user  does  not have the required access
          priviledges  to  perform  the  requested  operation.    This
          message  is  always  followed  by  either the ?BKPOPA or the
          ?BKPDVF error message.

?BKPWPI Wild PPN Illegal in INTERCHANGE mode

          When doing a RESTORE in INTERCHANGE mode,  wildcarding  only
          the  project  or  only  the  programmer  number  is illegal.
          Wildcarding both is legal.  The user  must  either  wildcard
          both or neither.



[End of BKP3.DOC]

[BKP2A.DOC is appended as an integral part of BKP3.DOC]
BKP2A.DOC                                                      Page 19


BACKUP.DOC -- Changes from V2(216) to V2A(307)
July 1978



1.0  SUMMARY

This is a maintenance release of BACKUP, a  program  for  transferring
files between disk and magnetic tape.

Version 2A of BACKUP must be loaded with SCAN Version 7B, WILD Version
7A, and field image versions of HELPER and ENDECR.  BACKUP runs on all
supported monitors and has been tested under 603 monitors.


Documentation  for  using  BACKUP  is  contained  in  the  help   file
BACKUP.HLP,   and  in  the  specifications  section  of  the  software
notebooks.  A program logic manual for BACKUP and it's  worker  module
BACKRS  can be produced by submitting the source files (BACKUP.MAC and
BACKRS.MAC) to RUNOFF Version 10.



2.0  EXTERNAL CHANGES

There is only one external change from Version 2:   the  default  file
specifications  that  are  used  when files are restored from magnetic
tape to disk.  All defaults are defined in the help file.



3.0  KNOWN BUGS AND DEFICIENCIES

The following deficiencies are known to exist in Version 2A:

Full .SCWLD style of pattern replacements are not yet implemented.

"'NOT'", etc., in full .LKWLD implementation is not operational.
BKP2A.DOC                                                      Page 20


4.0  INSTALLATION INSTRUCTIONS

Files involved:

BACKUP.MAC, BACKRS.MAC -- source files which make up this product.

BACKUP.EXE -- the executable files.

BACKUP.RNH -- input to RUNOFF V.10 to make the help file.

BACKUP.HLP -- the help file.

BACKUP.PLM, BACKRS.PLM -- program logic manuals extracted from the the
source files by RUNOFF V.10.

To build the program you must use MACRO V.52:

     .LOAD BACKUP.MAC, BACKRS.MAC
     .SSAVE BACKUP

This assumes MACTEN.UNV, UUOSYM.UNV and SCNMAC.UNV are on device  UNV:
and  that  SCAN.REL  (SCAN  Version  7B), WLD7A.REL (WILD Version 7A),
HELPER.REL and ENDECR.REL are on REL:.



5.0  INTERNAL CHANGES

None.



[End of BKP2A.DOC]

[BKP2.DOC is appended as an integral part of BKP2A.DOC]
BKP2.DOC                                                       Page 21


BACKUP.DOC -- Changes from V1 to V2(216)
October 1975



1.0  SUMMARY

This is the first field release of BACKUP, a program  for  transfering
files  between  disk  and  magnetic  tape.   This version of BACKUP is
intended to replace FAILSAFE  as  the  system  program  for  providing
backup storage of the disk file stucture system on magnetic tape.

Version 2 of BACKUP must be loaded with SCAN version 7B, WILD  version
7A, and field image versions of HELPER and ENDECR.  BACKUP runs on all
supported monitors, and has been tested under 602 monitors.


Documentation  for  using  BACKUP  is  contained  in  the  help   file
BACKUP.HLP,   and  in  the  specifications  section  of  the  software
notebooks.  A program logic manual for BACKUP and it's  worker  module
BACKRS  can be produced by submitting the source files (BACKUP.MAC and
BACKRS.MAC) to RUNOFF version 10.



2.0  EXTERNAL CHANGES

Version 1 of BACKUP ran only interchange mode, a mode in which  system
dependent  overhead  information  was not included on tape.  Version 2
has been expanded to  support  running  in  non-interchange  mode  and
including  all  system  information  on  tape.   This  mode is now the
default and running in interchange mode  is  enabled  by  means  of  a
switch.  All switches listed in the documentation are now supported.



3.0  KNOWN BUGS AND DEFICIENCIES

The following deficiences are known to exist in version 2:

Full .SCWLD style of pattern replacements  are  not  yet  implemented.
Waiting for DEC command standard.

"'NOT'", etc., in full .LKWLD implementation is not yet implemented.

LABEL command and writing labels are not yet implemented.
BKP2.DOC                                                       Page 22


4.0  INSTALLATION INSTRUCTIONS

Files involved:

BACKUP.MAC, BACKRS.MAC -- source files which make up this product.

BACKUP.SHR, BACKUP.LOW -- the executable files.

BACKUP.RNH -- input to RUNOFF v.10 to make the help file.

BACKUP.HLP -- the help file.

BACKUP.PLM, BACKRS.PLM -- program logic  manuals  extracted  from  the
source files by RUNOFF v.10.

To build the program, you must use MACRO v.50:

     .LOAD BACKUP.MAC,BACKRS.MAC
     .SSAVE BACKUP

This assumes MACTEN.UNV, UUOSYM.UNV and SCNMAC.UNV are on device  UNV:
and  that  SCN7B.REL  (SCAN  version 7B), WLD7A.REL (WILD version 7A),
HELPER.REL and ENDECR.REL are on REL:.



5.0  INTERNAL CHANGES

None.



[End of BKP2.DOC]

[BKP1.DOC is appended as an integral part of BKP2.DOC]
BKP1.DOC                                                       Page 23


BACKUP.DOC -- V1
April 1975



1.0  SUMMARY

This is the first release of BACKUP, a program for  transfering  files
between  systems  via  mag  tape.   Version 1 of BACKUP is designed to
facilitate  interchange  of  files  between  sites,   and   soon   all
DECsystem-10 software will be distributed in BACKUP format.  Version 1
of BACKUP supports interchange mode only.  In this  mode  BACKUP  does
not  write  system  specific information on tape, but only information
which is critical to the file itself.  On a restore,  system  defaults
are applied.  Version 1 is NOT intended as a replacement for FAILSAFE.
We strongly recommend against attempting to use it for  this  purpose.
(A future version of BACKUP will be generalized to support other modes
and will be suitable for performing system backup.)

Version 1 is being distributed to allow sites to become familiar  with
the  program which will become the principle tool for all DECsystem-10
software distributions.  A phased switch-over to  Backup  is  planned.
First,   a  parallel  distribution  (using  BACKUP  and  FAILSAFE)  of
unbundled software to selected test sites will be tried.  Next a  full
software  distribution  in parallel to all sites will be accomplished.
If problems are discovered and corrected during these  tests,  version
1A  of BACKUP will be created and distributed.  Finally, on successful
completion of these distributions,  regular  use  of  BACKUP  for  all
release  distributions will begin and FAILSAFE format releases will no
longer be available.

Version 1 of BACKUP is classed as support category C.   Please  report
reactions,  suggestions and problems with BACKUP via SPRs.  We solicit
your input, and it will be forwarded directly to BACKUP's  developers.
However,  no  SPRs  will  be  answered  and  no correspondence will be
entered into.  This early distribution of BACKUP has been done to give
your  installation  a chance to gain experience with this new program.
You may view it as an opportunity to participate in  field-testing  an
important new product.

This version of BACKUP must be loaded with SCAN version 7A, and  field
image  versions  of  HELPER  and ENDECR.  BACKUP runs on all supported
monitors.

Documentation  for  using  BACKUP  is  contained  in  the  help   file
BACKUP.HLP.   A program logic manual for BACKUP and it's worker module
BACKRS can be produced by submitting the source files (BACKUP.MAC  and
BACKRS.MAC) to RUNOFF version 10.
BKP1.DOC                                                       Page 24


1.1  Disclaimers

     1.  Version 1 of BACKUP does not replace failsafe.

     2.  Not all features are implemented or tested.  Expect  problems
         if you experiment with untested features.

     3.  BACKUP is support category  C.   Do  not  ask  your  software
         specialist  for  help.   SPRs  will  be  acknowledged but not
         answered.



2.0  EXTERNAL CHANGES

None.



3.0  KNOWN BUGS AND DEFICIENCIES

The following deficiences are known to exist in version 1:

Only interchange mode is supported.

Write recovery code to rewrite on tape errors doesn't work.

On read, the last occurance of a repeated block should be used instead
of the first.

Switches /NOSTRS and /OKPROTECTION are not supported.

Full .SCWLD style of pattern replacements are not yet implemented.

Unused INTERNs between routines should be cleaned out.

"'NOT'", etc., in full .LKWLD implementation is not yet supported.

Human interface on reel switching is poorly designed.

LABEL command and writing labels are not yet implemented.

T$CON record on new reel has not been implemented.  This is needed  to
ensure that new reel playback does not require previous reel.

Files cannot be non-contiguous on playback.  Allow this and omit  tape
blocks on write which are totally zero.

Fully general disk devices are not yet implemented.

There are duplicated internal routines, which should be fixed by force
loading parts of SCAN into the low segment.
BKP1.DOC                                                       Page 25


4.0  INSTALLATION INSTRUCTIONS

Files involved:

BACKUP.MAC, BACKRS.MAC -- source files which make up this product.

BACKUP.SHR, BACKUP.LOW -- the executable files.

BACKUP.RNH -- input to RUNOFF v.10 to make the help file.

BACKUP.HLP -- the help file.

BACKUP.PLM, BACKRS.PLM -- program logic  manuals  extracted  from  the
source files by RUNOFF v.10.

To build the program, you must use MACRO v.50:

     .LOAD BACKUP.MAC,BACKRS.MAC
     .SSAVE BACKUP

This assumes C.UNV  and  SCNMAC.UNV  are  on  device  UNV:   and  that
SCAN.REL (version 7A), HELPER.REL and ENDECR.REL are on REL:.

NOTE:  DIRECT cannot as  yet  read  BACKUP  format  tapes.   Directory
listings can be produced by BACKUP by using the PRINT verb.



5.0  INTERNAL CHANGES

Not applicable for this release.



[End of BKP1.DOC]
    V-ø