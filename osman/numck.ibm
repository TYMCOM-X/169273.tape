   IDENTIFICATION DIVISION.                                       00010
   PROGRAM-ID.                    PD.                                        00020
   AUTHOR.                IDSI.                                         00030
   REMARKS.               TRANSMISSION SOFTWARE: VERSION 07.          00                00040
            RELEASE DATE 09-01-88                       00050
            IBM ANS COBOL.                                    00060
   ENVIRONMENT DIVISION.                                      00070
   CONFIGURATION SECTION.                                     00080
   SOURCE-COMPUTER.             DECSYSTEM-10.          
   OBJECT-COMPUTER.             DECSYSTEM-10.          
      * LINES 13 AND 15 MAYBE NEEDED FOR ASCII  MACHINES                00110
      *           PROGRAM COLLATING SEQUENCE IS EBCDIC.                       00120
   SPECIAL-NAMES.                                         00130
       ALPHABET EBCDIC IS EBCDIC.                                 00140
       C01 IS NEXT-PAGE.                                      00150
   INPUT-OUTPUT SECTION.                                      00160
   FILE-CONTROL.                                          00170
      *                                     00180
      ***********************************************************           00190
      *                                     00200
       SELECT PRINT-FILE    ASSIGN TO PRTR.                               00210
       SELECT UPDATE-FILE   ASSIGN TO UPDFL.                              00220
       SELECT TRANS-FILE    ASSIGN TO TRANSFL.                            00230
       SELECT  OLDTP70-FILE ASSIGN TO OLD216.                             00240
       SELECT OUTTP70-FILE  ASSIGN TO NEW216.                             00250
   DATA DIVISION.                                         00260
   FILE SECTION.                                          00270
   FD  OLDTP70-FILE                             00280
       RECORD CONTAINS 216 CHARACTERS                       00290
       BLOCK CONTAINS 5 RECORDS                         00300
       LABEL RECORDS ARE STANDARD.                                    00310
   01  INTP-REC.                                          00320
       05  I-X-QSIP.                                          00330
         10  I-ISSUER            PIC X(6).                        00340
         10  I-ISSUE             PIC X(2).                        00350
         10  I-UNQ-CD            PIC X.                           00360
         10  I-X-CD              PIC X.                           00370
       05  I-ISR-QSIP REDEFINES I-X-QSIP.                                 00380
         10  I-ISSUE-R     PIC X(8).                              00390
         10  FILLER        PIC X(2).                              00400
       05  I-X-TIC.                                       00410
         10  I-PRIM-TIC          PIC X(4).                        00420
         10  I-GRP-ID            PIC X.                           00430
         10  I-CLASS-ID          PIC X.                           00440
       05  I-SIC             PIC X(4).                        00450
       05  I-ISSUER-DESCRIP          PIC X(28).                           00460
       05  I-ISSUE-DESCRIP.                                       00470
         10  FILLER              PIC X(13).                           00480
         10  I-FUT-DP4-CD            PIC X.                           00490
         10  FILLER              PIC X(6).                        00500
       05  I-PRICE-SECT.                                      00510
         10  I-PRICE-DT          PIC 9(4).                        00520
         10  I-VOL               PIC 9(7).                        00530
         10  I-HIGH              PIC 9(4)V9(3).                       00540
         10  I-HIGH4 REDEFINES I-HIGH    PIC 9(3)V9(4).                       00550
         10  I-LOW               PIC 9(4)V9(3).                       00560
         10  I-LOW4 REDEFINES I-LOW      PIC 9(3)V9(4).                       00570
         10  I-CLOSE             PIC 9(4)V9(3).                       00580
         10  I-CLOSE4 REDEFINES I-CLOSE      PIC 9(3)V9(4).                       00590
         10  I-ADJ-PREV-CLOSE        PIC 9(4)V9(3).                       00600
         10  I-ADJ-PREV-CLOSE4 REDEFINES                    00610
         I-ADJ-PREV-CLOSE        PIC 9(3)V9(4).                       00620
       05  I-IND-SECT.                                        00630
         10  I-ISS-TYPE          PIC X.                           00640
         10  I-TRD-TYPE          PIC X.                           00650
         10  I-ISS-ST            PIC X.                           00660
         10  I-XPRICE-ST         PIC X.                           00670
         10  I-SUPP-TYPE REDEFINES I-XPRICE-ST PIC X.                         00680
         10  I-SNP-RATE REDEFINES I-SUPP-TYPE PIC X.                          00690
         10  I-MAT-DT            PIC 9(8).                        00700
         10  I-EXP-DT   REDEFINES I-MAT-DT   PIC 9(8).                        00710
         10  I-COUP-RATE         PIC 9(2)V9(4).                       00720
         10  I-ADJ-FACT REDEFINES I-COUP-RATE PIC 9(2)V9(4).                      00730
         10  I-TRD-ADJ   REDEFINES I-ADJ-FACT PIC 9(3)V9(3).                      00740
         10  I-MRG-IND           PIC X.                           00750
         10  I-BOND-FORM REDEFINES I-MRG-IND PIC X.                           00760
         10  I-TRD-UN-ST   REDEFINES I-MRG-IND PIC X.                         00770
         10  I-LAST-TDT          PIC 9(6).                        00780
         10  I-XREFQSIP REDEFINES I-LAST-TDT   PIC X(6).                          00790
       05  I-EARN-IAD-SECT.                                       00800
         10  I-END12-DT          PIC 9(2).                        00810
         10  I-ERN-PER-SHR           PIC 9(2)V9(3).                       00820
         10  I-NEG-IND           PIC X.                           00830
         10  I-SHRS-OUT          PIC 9(7).                        00840
         10  I-IAD-FOOT          PIC 9.                           00850
         10  I-IAD               PIC 9(1)V9(3).                       00860
       05  I-BOND-QUAL-SECT REDEFINES I-EARN-IAD-SECT.                        00870
         10  FILLER              PIC X(6).                        00880
         10  I-SNP               PIC X.                           00890
         10  I-MOODY-RATE            PIC X.                           00900
         10  I-AMT-OUT           PIC X(7).                        00910
         10  I-YIELD-2-MAT           PIC 9(2)V9(3).                       00920
       05  I-UND-STK-SECT REDEFINES I-EARN-IAD-SECT.                          00930
         10  I-UND-STK-PRICE         PIC 9(4)V9(3).                       00940
         10  FILLER              PIC X.                           00950
         10  I-OPEN-INT          PIC X(7).                        00960
         10  I-OVER-10K-ADJ.                                      00970
       15  I-P-ADJ-IND           PIC 9.                           00980
       15  I-HIGH-ADJ            PIC 9.                           00990
       15  I-LOW-ADJ         PIC 9.                           01000
       15  I-CLOSE-ADJ           PIC 9.                           01010
       15  I-ADJ-PREV-CLOSE-ADJ      PIC 9.                           01020
       05  I-DIVIDEND-AREAS.                                      01030
         10  I-DIVSECT-1-2 OCCURS 2 TIMES.                                01040
       15  I-DIV-AMT         PIC 9(2)V9(4).                       01050
       15  I-DIV-EXDIS-DT        PIC 9(6).                        01060
       15  I-DIV-REC-DT          PIC 9(6).                        01070
       15  I-DIV-PAY-DT          PIC 9(6).                        01080
       15  I-DIV-PAY-MTD         PIC X.                           01090
       15  I-DIV-PAY-ODR         PIC X.                           01100
       15  I-DIV-TX-BS           PIC X.                           01110
       15  I-DIV-LR-CD           PIC X.                           01120
       15  I-DIV-FQ-CD           PIC X.                           01130
       15  I-DIV2-BRR-CD REDEFINES                      01140
           I-DIV-FQ-CD           PIC X.                           01150
       15  I-DIV2-TRANS-CD       PIC X.                           01160
       15  I-DIV-RV-IND          PIC X.                           01170
       15  I-DIV-ECODE           PIC X.                           01180
   FD  OUTTP70-FILE                             01190
       RECORD CONTAINS 216 CHARACTERS                       01200
       BLOCK CONTAINS 5 RECORDS                         01210
       LABEL RECORDS ARE STANDARD.                                    01220
   01  OUTP216-REC     PIC X(216).                                01230
   FD  UPDATE-FILE                              01240
       RECORD CONTAINS 40 CHARACTERS                        01250
       BLOCK CONTAINS 2 RECORDS                         01260
       LABEL RECORDS ARE STANDARD.                                    01270
   01  UPD-CONT-REC.                                          01280
       05  FILLER            PIC X(22).                           01290
       05  UC-CON-IND            PIC 9.                           01300
       05  FILLER            PIC X.                           01310
       05  UC-1.                                          01320
         10  UC-ISSUER-1         PIC X(16).                           01330
       05  UC-2 REDEFINES UC-1.                                   01340
         10  UC-ISSUER-2         PIC X(12).                           01350
         10  UC-ISSUE-1          PIC X(4).                        01360
       05  UC-3 REDEFINES UC-1.                                   01370
         10  UC-ISSUE-2          PIC X(16).                           01380
       05  UC-4 REDEFINES UC-1.                                   01390
         10  UC-TICK             PIC X(6).                        01400
         10  FILLER              PIC XX.                          01410
         10  UC-SIC              PIC X(4).                        01420
         10  UC-ISS-TYPE         PIC X.                           01430
         10  UC-TRD-TYPE         PIC X.                           01440
         10  UC-ISS-ST           PIC X.                           01450
         10  FILLER              PIC X.                           01460
       05  UC-5 REDEFINES UC-1.                                   01470
         10  UC-EXP-DT           PIC X(8).                        01480
         10  UC-ADJ-FACT         PIC 9(2)V9(4).                       01490
         10  UC-BOND-FORM            PIC X.                           01500
         10  FILLER              PIC X.                           01510
   01  UPD-REC.                                           01520
       05  U-X-QSIP.                                          01530
         10  U-ISSUER            PIC X(6).                        01540
         10  U-ISSUE             PIC X(2).                        01550
         10  U-UNQ-CD            PIC X.                           01560
         10  U-X-CD              PIC X.                           01570
       05  U-ISR-QSIP REDEFINES U-X-QSIP.                                 01580
         10  U-ISSUE-R     PIC X(8).                              01590
         10  FILLER        PIC X(2).                              01600
       05  U-REC-TYPE            PIC X.                           01610
       88  U-IS-BULL VALUES 'D', 'E', 'F'.                            01620
       88  U-HAS-CONT VALUE 'E'.                                  01630
       88  U-IS-CAP VALUE 'F'.                                    01640
       05  U-RPT-DT.                                          01650
         10  U-RPT-Y             PIC 9.                           01660
         10  U-RPT-MM            PIC 9(2).                        01670
         10  U-RPT-DD            PIC 9(2).                        01680
       05  U-EFCT-DT.                                         01690
         10  U-EFCT-Y            PIC 9.                           01700
         10  U-EFCT-MM           PIC 9(2).                        01710
         10  U-EFCT-DD           PIC 9(2).                        01720
       05  STAT-CHNG-INFO.                                    01730
         10  U-ISS-ST            PIC X.                           01740
         10  FILLER              PIC X.                           01750
         10  U-XREF-QSIP.                                     01760
       15  U-XREF-ISSUER         PIC X(6).                        01770
       15  U-XREF-ISSUE          PIC X(2).                        01780
         10  U-XREF-UNQ-CD         PIC X.                             01790
         10  U-XREF-X-CD           PIC X.                             01800
         10  U-XREF-FLAG           PIC 9.                             01810
           88  U-HAS-XREF VALUE 1.                                01820
           88  U-HAS-UCUS VALUE 2.                                01830
         10  U-REF-PR            PIC 9(5).                        01840
         10  U-MG-PR REDEFINES U-REF-PR      PIC 9(3)V9(2).                       01850
         10  U-ISS-TYPE          PIC X.                           01860
       05  CAP-CHNG-INFO REDEFINES STAT-CHNG-INFO.                            01870
         10  C-CAP-IND           PIC X.                           01880
         10  C-CAP-SECT          PIC 9.                           01890
         10  C-IAD-SECT.                                      01900
      * CAP CHANGE 6                                01910
       15  C-IAD             PIC 9(2)V9(3).                       01920
       15  C-IAD-FOOT            PIC X.                           01930
       15  C-BOND-SUPP-TYPE REDEFINES C-IAD-FOOT                01940
                       PIC X.                             01950
       15  C-EPS             PIC 99V999.                          01960
       15  C-EPS-IND         PIC X.                           01970
       15  C-12M-END-Y           PIC 9.                           01980
       15  C-12M-END-DT          PIC 99.                          01990
       15  FILLER            PIC X.                           02000
       15  C-ISS-TYPE            PIC X.                           02010
         10  C-RECAP-SECT REDEFINES C-IAD-SECT.                           02020
      * CAP CHANGE 7                                02030
       15  C-ADJ-FAC         PIC 9(2)V9(4).                       02040
       15  C-SHRS-OUT            PIC 9(8).                        02050
       15  FILLER            PIC XXX.                         02060
         10  C-TRD-REV-SECT   REDEFINES C-IAD-SECT.                           02070
      * CAP CHANGE 9                                02080
       15  C-MARG-IND            PIC X.                           02090
       15  C-TRD-UNT-ST REDEFINES                       02100
           C-MARG-IND            PIC X.                           02110
       15  C-BOND-FORM REDEFINES                        02120
           C-MARG-IND            PIC X.                           02130
       15  C-X-PR-ST         PIC X.                           02140
       15  C-TRANS-CD            PIC X.                           02150
       15  C-OPT-IND         PIC X.                           02160
       15  C-TRD-UNT-ADJ         PIC 9(3)V9(3).                       02170
       15  FILLER            PIC X(4).                        02180
       15  C-MOODY-FIN-QL        PIC X.                           02190
       15  C-SNP-BD-RATE         PIC X.                           02200
       15  FILLER            PIC X.                           02210
   FD  TRANS-FILE                               02220
       RECORD CONTAINS 40 CHARACTERS                        02230
       BLOCK CONTAINS 2 RECORDS                         02240
       LABEL RECORDS ARE STANDARD.                                    02250
   01  TRANS-REC.                                         02260
       05  T-ISSUE-R             PIC X(8).                        02270
       05  FILLER            PIC X(32).                           02280
   01  TRANS-LABEL.                                       02290
       05  DUMMY             PIC X(5).                        02300
       05  T-SCALE-FLAG          PIC X(1).                        02310
       05  T-LABEL               PIC X(4).                        02320
       05  T-EXT-ISTYP-FLAG          PIC X(1).                        02330
       05  FILLER            PIC X(23).                           02340
       05  T-LABEL-DT            PIC 9(6).                        02350
   01  T-PRICE-REC.                                       02360
       05  T-X-QSIP.                                          02370
         10  T-ISSUER            PIC X(6).                        02380
         88  TNOTE-TBOND VALUES '912810', '912827'.                           02390
         10  T-ISSUE             PIC X(2).                        02400
         10  T-UNQ-CD            PIC X.                           02410
         10  T-X-CD              PIC X.                           02420
       05  T-FUT-QSIP REDEFINES T-X-QSIP.                                 02430
         10  T-FUT-NINE          PIC X(3).                        02440
         10  T-FUT-NUM           PIC X(3).                        02450
         10  T-EX-MT-CD          PIC X.                           02460
         10  T-EX-YR-CD          PIC X.                           02470
         10  T-FUT-X-CD          PIC X.                           02480
         10  T-TEL-FUT-CD            PIC X.                           02490
       05  T-REC-TYPE            PIC X.                           02500
       88  T-STOCK-PRICE VALUE 'K'.                               02510
       88  T-BOND-PRICE VALUE 'L'.                           02520
       88  T-OPTION-PRICE VALUE 'M'.                              02530
       88  T-OPTION-BA VALUE 'N'.                                 02540
       88  T-FUTURE-PRICE VALUE 'O'.                              02550
       88  T-DIV VALUE 'P'.                                   02560
       88  T-RBI VALUE 'R'.                                   02570
       88  T-MTG VALUE 'S'.                                   02580
       88  T-CALL VALUE 'T'.                                  02590
       88  T-FUTURE-OI VALUE 'U'.                                 02600
       88  T-NOT-PRICE VALUE 'P', 'R', 'S', 'T'.                          02610
       05  T-TRD-TYPE            PIC X.                           02620
       05  T-PRICING-DT.                                      02630
         10  T-PR-MM             PIC 9(2).                        02640
         10  T-PR-DD             PIC 9(2).                        02650
       05  T-VOL             PIC 9(5).                        02660
       05  T-PRICES.                                          02670
         10  T-CLOSE             PIC 9(5).                        02680
         10  T-HIGH              PIC 9(4).                        02690
         10  T-LOW               PIC 9(4).                        02700
       05  T-PRC-REP-CODE            PIC X.                           02710
       88  IN-THOU VALUE '0'.                                 02720
       88  IN-HUND VALUE '1'.                                 02730
       88  WITH-32NDS VALUE '2'.                                  02740
       88  IN-8THS VALUE '3'.                                 02750
       88  IN-16THS VALUE '4'.                                    02760
       88  IN-32NDS VALUE '5'.                                    02770
       88  IN-64THS VALUE '6'.                                    02780
       88  T-EQUITY-OPT VALUE '1'.                                02790
       88  T-INDEX-OPT VALUE '2'.                                 02800
       88  T-CURRENCY-OPT VALUE '3'.                              02810
       88  T-INTEREST-OPT VALUE '4'.                              02820
       88  T-DEBT-OPT VALUE '5'.                                  02830
       88  T-FUTURE-OPT VALUE '6'.                                02840
       05  T-FUT-DIVISOR REDEFINES T-PRC-REP-CODE PIC X.                          02850
       05  T-YLD-2-MAT           PIC 9(2)V9(3).                       02860
       05  T-FUT-CASH-PRICE REDEFINES T-YLD-2-MAT PIC 9(5).                       02870
       05  T-OFLOW REDEFINES T-YLD-2-MAT.                                 02880
         10  T-OPT-PRC-CODE          PIC X.                           02890
         88  T-OPT-OFLOW VALUES 'A'.                              02900
         10  T-VOL-HO            PIC 9.                           02910
         10  T-CLOSE-HO          PIC 9.                           02920
         10  T-HIGH-HO           PIC 9.                           02930
         10  T-LOW-HO            PIC 9.                           02940
       05  T-UPRC REDEFINES T-YLD-2-MAT.                              02950
         10  T-UND-STK-PR            PIC 9(5).                        02960
                                        02970
   01  REG-BOND-REC.                                          02980
       05  R-QSIP.                                        02990
         10  R-ISSUER            PIC X(6).                        03000
         10  R-ISSUE             PIC X(2).                        03010
         10  R-ECODE             PIC X.                           03020
         10  FILLER              PIC X.                           03030
       05  R-CHK-DG              PIC 9.                           03040
       05  R-ISS-TYPE            PIC X.                           03050
       05  R-INT-PMT             PIC 9(3)V9(3).                       03060
       05  FILLER            PIC X(5).                        03070
       05  R-REC-DT.                                          03080
         10  R-REC-Y             PIC 9.                           03090
         10  R-REC-MM            PIC 9(2).                        03100
         10  R-REC-DD            PIC 9(2).                        03110
       05  R-PMT-DT.                                          03120
         10  R-PMT-Y             PIC 9.                           03130
         10  R-PMT-MM            PIC 9(2).                        03140
         10  R-PMT-DD            PIC 9(2).                        03150
       05  R-PMT-FQ              PIC X.                           03160
       05  R-BOND-IND            PIC X.                           03170
       05  R-LR-CD               PIC X.                           03180
       05  R-TRANS-CD            PIC X.                           03190
       05  R-PMT-MTD             PIC X.                           03200
       05  R-PMT-CD              PIC X.                           03210
       05  R-TX-BS-CD            PIC X.                           03220
   01  BID-ASK-REC.                                       03230
       05  FILLER            PIC X(11).                           03240
       05  BA-DATE.                                       03250
       10  BA-DT-Y           PIC 9.                           03260
       10  BA-DT-MM          PIC 99.                          03270
       10  BA-DT-DD          PIC 99.                          03280
       05  BA-IND            PIC 9.                           03290
       88  BA-UPD-OPEN-INT VALUES  0, 1, 3, 4.                            03300
       88  BA-UPD-BA VALUES 2, 3, 4.                              03310
       88  BA-ADJ-OPEN-INT VALUES 1, 4.                               03320
       05  BA-ASK            PIC 9(5)V9(3).                       03330
       05  BA-BID            PIC 9(5)V9(3).                       03340
       05  BA-OPEN-INT           PIC 9(7).                        03350
   01  CALL-REC.                                          03360
       05  FILLER            PIC X(8).                        03370
       05  C-ENTRY-CODE          PIC X.                           03380
       05  C-REV-CODE            PIC X.                           03390
       05  FILLER            PIC X.                           03400
       05  C-SAP-PG-NO           PIC X(5).                        03410
       05  C-CALL-Y              PIC 9.                           03420
       05  C-CALL-MM             PIC 99.                          03430
       05  C-CALL-DD             PIC 99.                          03440
       05  C-CALL-ISS-TYPE           PIC X.                           03450
       05  C-SF-CODE             PIC X.                           03460
       05  C-CALL-TYPE           PIC X.                           03470
       05  C-REDEMPTION          PIC X.                           03480
       05  C-PREMIUM-CODE            PIC X.                           03490
       05  C-CALL-AMT            PIC 9(7).                        03500
       05  C-CALL-PRICE          PIC 9(4)V9(3).                       03510
   FD  PRINT-FILE                               03520
       RECORD CONTAINS 132 CHARACTERS                       03530
       LABEL RECORDS ARE STANDARD.                                    03540
   01  PRINT-REC.                                         03550
       05  P-MESS.                                        03560
         10  PRINT-MESS    PIC X(60).                                 03570
         10  FILLER        PIC X(72).                                 03580
       05  PRINT-LINE REDEFINES P-MESS PIC X(132).                            03590
      *                                     03600
      ***********************************************************           03610
      *                                     03620
   WORKING-STORAGE SECTION.                                       03630
      *                                     03640
   01  TEMP-STRG.                                         03650
       05  W-IAD-FOOT      PIC X.                                 03660
       05  W-IAD       PIC 9(2)V9(3).                             03670
       05  WS-10-ADJ-PRC        PIC 9(5)V9(3).                            03680
       05  WS-OVER-10-K REDEFINES WS-10-ADJ-PRC.                              03690
       10  WS-10-ADJ-FACT    PIC 9.                               03700
       10  WS-10-ADJ-SEC     PIC 9(4)V9(3).                           03710
       05  WHOLE-32NDS       PIC 9(10).                               03720
       05  FRAC-32NDS        PIC 9(5)V9(3).                           03730
       05  WS-TODAYS-DT.                                      03740
       10  WS-TD-YY          PIC 99.                              03750
       10  WS-TD-MD          PIC 9(4).                            03760
       05  XDIS-DT-TEMP.                                      03770
       10  XDIS-DT-YY        PIC 99.                              03780
       10  XDIS-DT-MD        PIC 9(4).                            03790
       05  WS-DT.                                         03800
       10  WS-D-MM     PIC 99.                                03810
       10  WS-D-DD     PIC 99.                                03820
       10  WS-D-YY     PIC 99.                                03830
       05  WS-DT-N REDEFINES WS-DT PIC 9(6).                              03840
       05  WS-YMD.                                        03850
       10  WS-YMD-YY     PIC 99.                              03860
       10  WS-YMD-MM     PIC 99.                              03870
       10  WS-YMD-DD     PIC 99.                              03880
       05  WS-YMD-N REDEFINES WS-YMD PIC 9(6).                            03890
       05  WS-XD.                                         03900
       10  WS-XD-YY     PIC 99.                               03910
       10  WS-XD-MM     PIC 99.                               03920
       10  WS-XD-DD     PIC 99.                               03930
       05  WS-XD-N REDEFINES WS-XD PIC 9(6).                              03940
       05  WS-D-YYYY       PIC 9(4).                              03950
       05  WS-M-CNT        PIC 9(4)   COMP.                           03960
       05  ITN-CNT         PIC 9(4)   COMP.                           03970
       05  TODAYS-DT.                                         03980
       10  TD-MM       PIC 99.                                03990
       10  TD-DD       PIC 99.                                04000
       10  TD-YY       PIC 99.                                04010
       05  TODAYS-DT-N REDEFINES TODAYS-DT.                               04020
       10  TODAYS-DT-FT    PIC 9(4).                              04030
       10  FILLER      PIC 9(2).                              04040
       05  SAVE-DATE.                                         04050
       10  S-YYYY-1    PIC 9(4).                              04060
       10  S-DT-FT     PIC 9(4).                              04070
       05  CHK-DATE.                                          04080
       10  YYYY-1      PIC 9(4).                              04090
       10  MM-1        PIC 99.                                04100
       10  DD-1        PIC 99.                                04110
       05  XDIV-DT1.                                          04120
       10  XDIV-DT-FT1     PIC 9(4).                              04130
       10  XDIV-DT-YY1     PIC 99.                                04140
       05  TD-YYYY         PIC 9(4)   COMP.                           04150
       05  TD-M-CNT        PIC 9(4)   COMP.                           04160
       05  FIX-DT.                                        04170
       10  D-MM        PIC 99.                                04180
       10  D-DD        PIC 99.                                04190
       10  D-YY        PIC 99.                                04200
       05  FIX-DT-N REDEFINES FIX-DT      PIC 9(6).                           04210
       05 FIX-FTH REDEFINES FIX-DT-N.                                 04220
      10  FIX-FST      PIC 9(4).                              04230
      10  FILLER       PIC 9(2).                              04240
       05  DIV         PIC 9(5)      COMP.                        04250
       05  WS-CLOSE-INT    PIC 9(6).                              04260
       05  WS-HIGH-INT     PIC 9(6).                              04270
       05  WS-LOW-INT      PIC 9(6).                              04280
       05  TEMP-PRCS       PIC 9(4)V9(5).                             04290
       05  TEMP-HIGH       PIC 9(5)V9(5).                             04300
       05  TEMP-HIGH-R REDEFINES TEMP-HIGH.                               04310
       10  TEMP-HIGH-OFLOW PIC 9.                                 04320
       10  FILLER      PIC 9(9).                              04330
       05  TEMP-LOW        PIC 9(5)V9(5).                             04340
       05  TEMP-LOW-R REDEFINES TEMP-LOW.                                 04350
       10  TEMP-LOW-OFLOW  PIC 9.                                 04360
       10  FILLER      PIC 9(9).                              04370
       05  TEMP-CLOSE      PIC 9(5)V9(5).                             04380
       05  TEMP-CLOSE-R REDEFINES TEMP-CLOSE.                             04390
       10  TEMP-CLOSE-OFLOW PIC 9.                                04400
       10  FILLER      PIC 9(9).                              04410
       05  TEMP-BID        PIC 9(5)V9(3).                             04420
       05  TEMP-BID-R REDEFINES TEMP-BID.                                 04430
       10  TEMP-BID-ADJ    PIC 9.                                 04440
       10  TEMP-OP-BID     PIC 9(4)V9(3).                             04450
       05  TEMP-ASK        PIC 9(5)V9(3).                             04460
       05  TEMP-ASK-R REDEFINES TEMP-ASK.                                 04470
       10  TEMP-ASK-ADJ    PIC 9.                                 04480
       10  TEMP-OP-ASK     PIC 9(4)V9(3).                             04490
       05  FUT-TEMP-PRICE      PIC 9(5)V9(3).                             04500
       05  HI-X-QSIP       PIC X(10).                                 04510
       05  HI-TRD-TYPE     PIC X.                                 04520
       05  HI-HIGH         PIC 9(4)V9(3).                             04530
       05  HI-LOW      PIC 9(4)V9(3).                             04540
       05  HI-CLOSE        PIC 9(4)V9(3).                             04550
       05  HI-ADJ-PREV-CLOSE   PIC 9(4)V9(3).                             04560
       05  HI-HIGH-ADJ     PIC 9.                                 04570
       05  HI-LOW-ADJ      PIC 9.                                 04580
       05  HI-CLOSE-ADJ    PIC 9.                                 04590
       05  HI-ADJ-PREV-CLOSE-ADJ      PIC 9.                              04600
       05  HOLD-IAD-CUSIP      PIC X(8) VALUE 'XXXXXXXX'.                         04610
       05  HOLD-IAD        PIC 99V999.                                04620
       05  HOLD-LAST-TRDNDT    PIC 9(6).                              04630
       05  VOL-TEMP        PIC 9(7).                              04640
       05  TEMP-DT         PIC 9(4).                              04650
   01  TEST-ISS-TYPE       PIC X.                                 04660
       88  TEST-IS-STOCK VALUES '0', '1', '2', '4', '7', '8',           04670
                '9', 'A', 'E', 'F', 'G', 'Q'.                     04680
       88  TEST-IS-BOND VALUES '3', '5', '6', 'H', 'I', 'J', 'K',           04690
               'L', 'M', 'N', 'O', 'P', 'R', 'S',           04700
               'T', 'U', 'V', 'W', 'X', 'Y', 'Z'.                     04710
       88  TEST-IS-OPTION VALUES 'B', 'D'.                                04720
       88  TEST-IS-EQUITY-OPTION VALUE 'B'.                               04730
       88  TEST-IS-FUTURE VALUE 'C'.                                  04740
      *                                     04750
      *                                     04760
   01  FLAGS.                                             04770
       05  NOT-OLD-TRD     PIC X VALUE  'F'.                              04780
       88  NEW-TRD-TYPE      VALUE  'T'.                              04790
       05  REC-NOT-TRADED      PIC X VALUE  'F'.                              04800
       88  NOT-TRADED        VALUE  'T'.                              04810
       05  ADD-A-REC       PIC X VALUE 'F'.                           04820
       88  NEW-REC       VALUE 'T'.                           04830
       05  BAD-NEWS        PIC 9 VALUE 0.                             04840
       88  FATAL-ERROR       VALUE 1.                             04850
       05  CAP-7       PIC X VALUE 'F'.                           04860
       88  CAP-7-REC         VALUE 'T'.                           04870
       05  OPT-SCALE-FLAG        PIC X VALUE 'F'.                         04880
       88  PRICE-PER-SHARE VALUE 'T'.                                 04890
       05  ISS-TYPE-FLAG   PIC X VALUE 'F'.                           04900
       88  NON-EXTENDED VALUE 'T'.                                04910
       05  C5-STAT-CHANGE      PIC X VALUE 'F'.                           04920
       88  C5-CHANGE       VALUE 'T'.                             04930
       05  ENDFILES.                                          04940
       10  W-ENDUPD    PIC X VALUE 'F'.                           04950
           88  ENDUPD        VALUE 'T'.                           04960
       10  W-ENDTRANS      PIC X VALUE 'F'.                           04970
           88  ENDTRANS      VALUE 'T'.                           04980
       10  W-ENDOLDTP      PIC X VALUE 'F'.                           04990
           88  ENDOLDTP        VALUE 'T'.                             05000
       05  ENDFILES-2 REDEFINES ENDFILES.                                 05010
       10  W-ENDALL    PIC XXX.                               05020
           88  ENDALL        VALUE 'TTT'.                             05030
      *                                     05040
      *                                     05050
   01  CNTRS.                                             05060
       05  W-OLDTP-CNT     PIC 9(6) VALUE 0 COMP.                         05070
       05  W-OUTP-CNT      PIC 9(6) VALUE 0 COMP.                         05080
       05  W-TRANS-CNT     PIC 9(6) VALUE 0 COMP.                         05090
       05  W-UPD-CNT       PIC 9(6) VALUE 0 COMP.                         05100
       05  CR-CNT      PIC 9(6) VALUE 0 COMP.                         05110
       05  NO-DESCRIP-CNT      PIC 9(6)  VALUE 0 COMP.                        05120
       05  SC-CNT      PIC 9(6) VALUE 0 COMP.                         05130
       05  NSC-CNT         PIC 9(6) VALUE 0 COMP.                         05140
       05  SCNG-CNT        PIC 9(6) VALUE 0 COMP.                         05150
       05  CONT-CNT        PIC 9(6) VALUE 0 COMP.                         05160
       05  PR-CNT      PIC 9(6) VALUE 0 COMP.                         05170
       05  BA-CNT      PIC 9(6) VALUE 0 COMP.                         05180
       05  OI-CNT      PIC 9(6) VALUE 0 COMP.                         05190
       05  RB-CNT      PIC 9(6) VALUE 0 COMP.                         05200
       05  DR-CNT      PIC 9(6) VALUE 0 COMP.                         05210
       05  CL-CNT      PIC 9(6) VALUE 0 COMP.                         05220
       05  STAT-CON-CNT    PIC 9(2) VALUE 0  COMP.                        05230
       05  PT-BLK      PIC 9(6) VALUE 0 COMP.                         05240
       05  NO-9BLKS        PIC 9     VALUE 0 COMP.                        05250
       05  BLK-SZ      PIC 9     VALUE 5 COMP.                        05260
       05  FT-BLK      PIC 9(6)  VALUE 0 COMP.                        05270
       05  P-CNT       PIC 9(6) VALUE 0 COMP.                         05280
       05  BADPR-CNT       PIC 9(6) VALUE 0 COMP.                         05290
       05  I           PIC 9(4)      COMP.                        05300
       05  J           PIC 9(4)      COMP.                        05310
       05  P           PIC 9    VALUE 1  COMP.                        05320
       05  M           PIC 9(2)      COMP.                        05330
      *                                     05340
   01  MESSAGES.                                          05350
 1     05 FILLER PIC X(30) VALUE '40 TO 216 CONVERT  VERSION 7.          0'.                    05360
 2     05 FILLER PIC X(30) VALUE 'NORMAL END-OF-JOB         '.                    05370
 3     05 FILLER PIC X(30) VALUE 'ALL I/O FILES OPENED      '.                    05380
 4     05 FILLER PIC X(30) VALUE 'EOF BEFORE HEADER RECORD READ '.                    05390
 5     05 FILLER PIC X(30) VALUE 'NO HEADER RECORD ON TRANS FILE'.                    05400
 6      05 FILLER PIC X(30) VALUE 'NO DATE RECORD ON TRANS FILE  '.                   05410
 7      05 FILLER PIC X(30) VALUE 'TRANS EOF BEFORE SEPARATOR REC'.                   05420
 8      05 FILLER PIC X(30) VALUE 'RECS SEPARATED, (BULT, PR/DIV)'.                   05430
 9      05 FILLER PIC X(30) VALUE 'ERROR IN PRIMING READS    '.                   05440
10      05 FILLER PIC X(30) VALUE 'INPUT BUFFERS FILLED      '.                   05450
11      05 FILLER PIC X(30) VALUE 'ALL FILES CLOSED      '.                   05460
12      05 FILLER PIC X(30) VALUE 'MAIN PROCESSING STARTED   '.                   05470
13      05 FILLER PIC X(30) VALUE 'CONTINUATION RECORD EXPECTED  '.                   05480
14      05 FILLER PIC X(30) VALUE 'CAPIT.           SECTION NUMBER ERROR   '.                   05490
15      05 FILLER PIC X(30) VALUE 'EXTRA STATUS CONTIN.           RECORDS  '.                   05500
16      05 FILLER PIC X(30) VALUE 'DIV.           SECTION NUMBER INVALID   '.                   05510
17      05 FILLER PIC X(30) VALUE 'UNCODE 216-PNTR OUT OF BOUNDS '.                   05520
18      05 FILLER PIC X(30) VALUE 'NEW DATA 216 PNTR OUT OF BNDS '.                   05530
19      05 FILLER PIC X(30) VALUE 'JOB STOPPED=> CANT ADJUST DATE'.                   05540
20      05 FILLER PIC X(30) VALUE 'UPD FILE EOF-TRAILER MISSING  '.                   05550
21      05 FILLER PIC X(30) VALUE 'TRAN FILE EOF-TRAILER MISSING '.                   05560
22      05 FILLER PIC X(30) VALUE 'OLDTP FILE EOF-TRAILER MISSING'.                   05570
23      05 FILLER PIC X(30) VALUE 'TRANS-FILE LABEL READ     '.                   05580
24      05 FILLER PIC X(30) VALUE 'DATE COMPUTED FROM TRANS.           REC '.                   05590
25      05 FILLER PIC X(30) VALUE 'PROBLEMS >100: JOB TERMINATED.          '.                   05600
26      05 FILLER PIC X(30) VALUE 'BOND CURRENT YIELD ZERO FOR:  '.                   05610
27      05 FILLER PIC X(30) VALUE 'STATUS CONTIN.           OUT OF ORDER   '.                   05620
      *                                     05630
   01  MESSAGE-TABLE REDEFINES MESSAGES.                              05640
       05 MESS         OCCURS  26 PIC X(30).                          05650
      *                                     05660
      *                                     05670
   01  MESS-REC.                                          05680
       05  FILLER      PIC X VALUE SPACES.                            05690
       05  FILLER      PIC X(9) VALUE '****     '.                        05700
       05  MESG        PIC X(30).                                 05710
       05  FILLER      PIC X(4) VALUE '****'.                         05720
       05  FILLER      PIC X(89) VALUE SPACES.                        05730
      *                                     05740
   01  HEAD-1.                                            05750
       05  FILLER      PIC X(27) VALUE SPACES.                        05760
       05  FILLER      PIC X(7) VALUE '------ '.                          05770
       05  FILLER      PIC X(45) VALUE                  05780
       '40 TO 216 CONVERT SOFTWARE PROCESSING SUMMARY'.                       05790
       05  FILLER      PIC X(7) VALUE ' ------'.                          05800
       05  FILLER      PIC X(46) VALUE SPACES.                        05810
      *                                     05820
   01  HDR-1.                                             05830
       05  FILLER      PIC X(15) VALUE 'DATE FROM HDR :'.                     05840
       05  HDR-DT      PIC 9(6) VALUE ZERO.                           05850
       05  FILLER      PIC X(39) VALUE SPACES.                        05860
   01  HDR-REC.                                           05870
       05  FILLER      PIC X(15) VALUE 'HEADER RECORD :'.                     05880
       05  HDR         PIC X(40) VALUE SPACES.                        05890
       05  FILLER      PIC X(5) VALUE SPACES.                         05900
   01  LAST-T-REC.                                        05910
       05  FILLER      PIC X(15) VALUE 'LAST PR/DV REC:'.                     05920
       05  LT-REC      PIC X(40) VALUE SPACES.                        05930
       05  FILLER      PIC X(5) VALUE SPACES.                         05940
   01  LAST-U-REC.                                        05950
       05  FILLER      PIC X(15) VALUE 'LAST BULT.           REC:'.                     05960
       05  LT-U-REC        PIC X(40) VALUE SPACES.                        05970
       05  FILLER      PIC X(5) VALUE SPACES.                         05980
   01  LAST-O-REC.                                        05990
       05  FILLER      PIC X(15) VALUE 'LAST NEW  216 :'.                     06000
       05  OUT-QSIP-SAVE   PIC X(10).                                 06010
       05  OUT-TIC-SAVE    PIC X(06).                                 06020
       05  OUT-SIC-SAVE    PIC X(04).                                 06030
       05  OUT-DESC-SAVE   PIC X(20).                                 06040
   01  LINE-2.                                            06050
       05  FILLER      PIC X VALUE ' '.                           06060
       05  FILLER      PIC X(15) JUST RIGHT VALUE               06070
       'TOTAL RECORDS '.                                      06080
       05  FILLER      PIC X(30) JUST RIGHT VALUE               06090
       '        OLDTP70 UPDATE'.                              06100
       05  FILLER      PIC X(20) JUST RIGHT VALUE               06110
       '  TRANS   OUTTP70   '.                                    06120
   01  TOT-LINE.                                          06130
       05  FILLER      PIC XX VALUE ' '.                              06140
       05  FILLER      PIC X(25) VALUE                  06150
                  'LESS SEPARATOR/HEADER REC'.                    06160
       05  FILLER      PIC X(5) VALUE SPACES.                         06170
       05  TOT-OLD         PIC Z(4)99BB.                              06180
       05  TOT-UPD         PIC Z(4)99B.                               06190
       05  TOT-TRANS       PIC Z(4)99BBBB.                            06200
       05  TOT-OUT         PIC Z(4)99BBBB.                            06210
   01  LINE-3.                                            06220
       05  FILLER      PIC X VALUE ' '.                           06230
       05  FILLER      PIC X(26) JUST RIGHT VALUE               06240
       ' PROCESSING TOTALS: UPD'.                                 06250
       05  FILLER      PIC X(33) VALUE SPACES.                        06260
   01  PART-TOT.                                          06270
       05  FILLER      PIC X VALUE ' '.                           06280
       05  FILLER      PIC X(26) VALUE SPACES.                        06290
       05  PT-TYPE         PIC X(15).                                 06300
       05  OUT-PT      PIC Z(4)99.                                06310
       05  FILLER      PIC X(12) VALUE SPACES.                        06320
   01  PART-TOT-1.                                        06330
       05  FILLER      PIC X VALUE ' '.                           06340
       05  FILLER      PIC X(26) VALUE SPACES.                        06350
       05  PT-TYPE-1       PIC X(15) VALUE                  06360
                  'RECORDS TO DATE'.                          06370
       05  FILLER      PIC X(18) VALUE SPACES.                        06380
   01  SUB-HEAD.                                          06390
       05  FILLER      PIC X VALUE ' '.                           06400
       05  FILLER      PIC X(26) JUST RIGHT VALUE 'TRANS'.                    06410
       05  FILLER      PIC X(33) VALUE SPACES.                        06420
   01  SUB-HEAD-1.                                        06430
       05  FILLER      PIC X VALUE ' '.                           06440
       05  FILLER      PIC X(26) JUST RIGHT VALUE               06450
                     '     OLDTP70'.                      06460
       05  FILLER      PIC X(33) VALUE SPACES.                        06470
   01  SUB-HEAD-2.                                        06480
       05  FILLER      PIC X VALUE ' '.                           06490
       05  FILLER      PIC X(26) JUST RIGHT VALUE               06500
                     '     OUTTP70'.                      06510
       05  FILLER      PIC X(33) VALUE SPACES.                        06520
      *                                     06530
   01  ERR-LINE.                                          06540
       05  FILLER      PIC X VALUE ' '.                           06550
       05  FILLER      PIC X(30) JUST RIGHT VALUE               06560
         'AT CUSIP: OUTTP70   UPD'.                               06570
       05  FILLER      PIC X(29) JUST RIGHT VALUE               06580
         '   TRANS     DIVIDEND'.                                 06590
      *                                     06600
   01  ERR-LINE-1.                                        06610
       05  FILLER      PIC X VALUE ' '.                           06620
       05  FILLER      PIC X(9) VALUE SPACES.                         06630
       05  ERR-O-QSIP      PIC X(10).                                 06640
       05  FILLER      PIC X(4) VALUE SPACES.                         06650
       05  ERR-U-QSIP      PIC X(10).                                 06660
       05  FILLER      PIC X(4) VALUE SPACES.                         06670
       05  ERR-T-QSIP      PIC X(10).                                 06680
       05  FILLER      PIC X(4) VALUE SPACES.                         06690
       05  ERR-D-QSIP      PIC X(8).                              06700
   01  ERR-LINE-2.                                        06710
       05  FILLER      PIC X VALUE ' '.                           06720
       05  FILLER      PIC X(9) VALUE SPACES.                         06730
       05  O-ERR-QSIP      PIC X(10).                                 06740
       05  FILLER         PIC X(103) VALUE SPACES.                        06750
      *                                     06760
   01  ID-1.                                          06770
       05  FILLER      PIC X(57) JUST RIGHT VALUE               06780
       'INTERACTIVE DATA CORPORATION'.                                06790
       05  FILLER      PIC X(26) JUST RIGHT VALUE               06800
       '40 TO 216 CONVERT SOFTWARE'.                                  06810
       05  FILLER      PIC X(49) VALUE SPACES.                        06820
      *                                     06830
   01  ID-2.                                          06840
       05  FILLER      PIC X(30) VALUE SPACES.                        06850
       05  FILLER      PIC X(26) VALUE                  06860
         'ID:         PD;  VERSION 07.          00;'.                                06870
       05  FILLER      PIC X(27) VALUE                  06880
         ' RELEASE DATE   09-01-88   '.                               06890
      *                                     06900
   01  DASHES.                                            06910
       05  FILLER      PIC X(30) VALUE SPACES.                        06920
       05  FILLER      PIC X(53) VALUE ALL '-'.                           06930
       05  FILLER      PIC X(49) VALUE SPACES.                        06940
      *                                     06950
   01  REVISIONS.                                         06960
       05  REV-IND OCCURS 5    PIC X.                                 06970
   01  REV-WORD                                 06980
       REDEFINES REVISIONS     PIC X(5).                              06990
      *                                     07000
   01  REV-WORD-VALUES.                                       07010
       05  FILLER  PIC X(25) VALUE '0000100100001100100001010'.                       07020
       05  FILLER  PIC X(25) VALUE '0110001110000000001000001'.                       07030
       05  FILLER  PIC X(25) VALUE '0000100001000010000100001'.                       07040
       05  FILLER  PIC X(25) VALUE '0000100001000011010010110'.                       07050
       05  FILLER  PIC X(25) VALUE '1100011010111001111010000'.                       07060
       05  FILLER  PIC X(25) VALUE '1001000001000010000100001'.                       07070
       05  FILLER  PIC X(25) VALUE '0000100001000010000100001'.                       07080
       05  FILLER  PIC X(5)  VALUE '00001'.                               07090
      *                                     07100
   01  R-W-V  REDEFINES REV-WORD-VALUES.                              07110
       05  RW-TABLE OCCURS 36  PIC X(5).                              07120
      *                                     07130
   01  RW-CODES        PIC X(37) VALUE                  07140
       'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890#'.                           07150
   01  R-W-C  REDEFINES RW-CODES.                                 07160
       05  REV-CODE-TABLE OCCURS 37 PIC X.                                07170
      *                                     07180
   01  OUTP-REC.                                          07190
       05  O-X-QSIP.                                          07200
         10  O-ISSUER            PIC X(6).                        07210
         10  O-ISSUE             PIC X(2).                        07220
         10  O-UNQ-CD            PIC X.                           07230
         10  O-X-CD              PIC X.                           07240
       05  O-ISR-QSIP REDEFINES O-X-QSIP.                                 07250
         10  O-ISSUE-R           PIC X(8).                        07260
         10  FILLER              PIC X(2).                        07270
       05  O-X-TIC.                                       07280
         10  O-PRIM-TIC          PIC X(4).                        07290
         10  O-GRP-ID            PIC X.                           07300
         10  O-CLASS-ID          PIC X.                           07310
       05  O-SIC             PIC X(4).                        07320
       05  O-ISSUER-DESCRIP          PIC X(28).                           07330
       05  O-ISSUER-R REDEFINES O-ISSUER-DESCRIP.                             07340
         10  O-ISSUER-1            PIC X(16).                         07350
         10  O-ISSUER-2            PIC X(12).                         07360
       05  O-ISSUER-CHK REDEFINES O-ISSUER-DESCRIP.                           07370
         10  O-DESCRIP-CHK         PIC X(4).                          07380
         10  FILLER            PIC X(24).                         07390
       05  O-ISSUE-DESCRIP.                                       07400
         10  FILLER              PIC X(13).                           07410
         10  O-FUT-DP4-CD            PIC X.                           07420
         10  FILLER              PIC X(6).                        07430
       05  O-ISSUE-R1 REDEFINES O-ISSUE-DESCRIP.                              07440
         10  O-ISSUE-1           PIC X(4).                        07450
         10  O-ISSUE-2           PIC X(16).                           07460
       05  O-ISSUE-R2 REDEFINES O-ISSUE-DESCRIP.                              07470
         10  FILLER              PIC X(19).                           07480
         10  O-OP-TYPE           PIC X.                           07490
       88  O-EQUITY-OPT VALUE '1'.                                07500
       88  O-INDEX-OPT VALUE '2'.                                 07510
       88  O-CURRENCY-OPT VALUE '3'.                              07520
       88  O-INTEREST-OPT VALUE '4'.                              07530
       88  O-DEBT-OPT VALUE '5'.                                  07540
       88  O-FUTURE-OPT VALUE '6'.                                07550
       05  O-PRICE-SECT.                                      07560
         10  O-PRICE-DT          PIC 9(4).                        07570
         10  O-VOL               PIC 9(7).                        07580
         10  O-HIGH              PIC 9(4)V9(3).                       07590
         10  O-HIGH4 REDEFINES O-HIGH    PIC 9(3)V9(4).                       07600
         10  O-LOW               PIC 9(4)V9(3).                       07610
         10  O-LOW4 REDEFINES O-LOW      PIC 9(3)V9(4).                       07620
         10  O-CLOSE             PIC 9(4)V9(3).                       07630
         10  O-CLOSE4 REDEFINES O-CLOSE      PIC 9(3)V9(4).                       07640
         10  O-ADJ-PREV-CLOSE        PIC 9(4)V9(3).                       07650
         10  O-ADJ-PREV-CLOSE4 REDEFINES                    07660
       O-ADJ-PREV-CLOSE          PIC 9(3)V9(4).                       07670
       05  O-IND-SECT.                                        07680
         10  O-ISS-TYPE          PIC X.                           07690
         10  O-TRD-TYPE          PIC X.                           07700
         10  O-ISS-ST            PIC X.                           07710
         10  O-XPRICE-ST         PIC X.                           07720
         10  O-SUPP-TYPE REDEFINES O-XPRICE-ST PIC X.                         07730
         10  O-SNP-RATE REDEFINES O-SUPP-TYPE PIC X.                          07740
         10  O-MAT-DT.                                        07750
       15  O-MAT-MM          PIC 99.                          07760
       15  O-MAT-DD          PIC 99.                          07770
       15  O-MAT-YYYY            PIC 9(4).                        07780
         10  O-EXP-DT   REDEFINES O-MAT-DT   PIC 9(8).                        07790
         10  O-COUP-RATE         PIC 9(2)V9(4).                       07800
         10  O-ADJ-FACT REDEFINES O-COUP-RATE PIC 9(2)V9(4).                      07810
         10  O-TRD-ADJ   REDEFINES O-COUP-RATE PIC 9(3)V9(3).                     07820
         10  O-MRG-IND           PIC X.                           07830
         10  O-BOND-FORM REDEFINES O-MRG-IND PIC X.                           07840
         10  O-TRD-UN-ST   REDEFINES O-MRG-IND PIC X.                         07850
         10  O-LAST-TDT.                                      07860
       15  O-MMDD            PIC 9(4).                        07870
       15  O-YY              PIC 99.                          07880
         10  O-XREFQSIP REDEFINES O-LAST-TDT   PIC X(6).                          07890
       05  O-EARN-IAD-SECT.                                       07900
         10  O-END12-DT          PIC 9(2).                        07910
         10  O-ERN-PER-SHR           PIC 9(2)V9(3).                       07920
         10  O-NEG-IND           PIC X.                           07930
         10  O-SHRS-OUT          PIC 9(7).                        07940
         10  O-IAD-FOOT          PIC 9.                           07950
         10  O-IAD               PIC 9(1)V9(3).                       07960
       05  O-BOND-QUAL-SECT REDEFINES O-EARN-IAD-SECT.                        07970
         10  FILLER              PIC X(6).                        07980
         10  O-SNP-BD            PIC X.                           07990
         10  O-MOODY-RATE            PIC X.                           08000
         10  O-AMT-OUT           PIC X(7).                        08010
         10  O-YIELD-2-MAT           PIC 9(2)V9(3).                       08020
       05  O-FUT-CASH-PRICE-SECT REDEFINES O-EARN-IAD-SECT.                       08030
         10  O-FUT-CASH-PRICE      PIC 9(5)V9(3).                         08040
         10  O-FUT-OPEN-INTEREST       PIC 9(7).                          08050
         10  FILLER             PIC X(5).                         08060
       05  O-UND-STK-SECT REDEFINES O-EARN-IAD-SECT.                          08070
         10  O-UND-STK-PRICE         PIC 9(4)V9(3).                       08080
         10  O-OPEN-INT-ADJ-IND      PIC 9.                           08090
         10  O-OPEN-INT          PIC X(7).                        08100
         10  O-OVER-10K-ADJ.                                      08110
       15  O-P-ADJ-IND           PIC 9.                           08120
       15  O-HIGH-ADJ            PIC 9.                           08130
       15  O-LOW-ADJ         PIC 9.                           08140
       15  O-CLOSE-ADJ           PIC 9.                           08150
       15  O-ADJ-PREV-CLOSE-ADJ      PIC 9.                           08160
       05  O-DIVIDEND-AREAS.                                      08170
         10  O-DIVSECT-1-2 OCCURS 2 TIMES.                                08180
       15  O-DIV-AMT         PIC 9(2)V9(4).                       08190
       15  O-DIV-XDIS-DT         PIC 9(6).                        08200
       15  O-DIV-REC-DT          PIC 9(6).                        08210
       15  O-DIV-PAY-DT          PIC 9(6).                        08220
       15  O-DIV-PAY-MTD         PIC X.                           08230
       15  O-DIV-PAY-ODR         PIC X.                           08240
       15  O-DIV-TX-BS           PIC X.                           08250
       15  O-DIV-LR-CD           PIC X.                           08260
       15  O-DIV-FQ-CD           PIC X.                           08270
       15  O-DIV2-BRR-CD REDEFINES                      08280
           O-DIV-FQ-CD           PIC X.                           08290
       15  O-DIV2-TRANS-CD       PIC X.                           08300
       15  O-DIV-RV-IND          PIC X.                           08310
       15  O-DIV-ECODE           PIC X.                           08320
       05  O-ALT-2ND-DIV REDEFINES                          08330
       O-DIVIDEND-AREAS.                                      08340
         10  FILLER              PIC X(29).                           08350
         10  O-OP-IAD            PIC 99V999.                          08360
         10  O-OP-UCUS           PIC X(8).                        08370
         10  O-OP-ASK-ADJ            PIC X.                           08380
         10  O-OP-BID-ADJ            PIC X.                           08390
         10  O-OP-BA-DATE            PIC 9(6).                        08400
         10  O-OP-ASK            PIC 9(4)V9(3).                       08410
         10  O-OP-BID            PIC 9(4)V9(3).                       08420
       05  O-BOND-INT-PMNT-SECT REDEFINES                       08430
                O-DIVIDEND-AREAS.                             08440
         10  O-ENTRY-CODE            PIC X.                           08450
         10  O-SAP-PG-NO         PIC X(5).                        08460
         10  O-CALL-DATE         PIC 9(6).                        08470
         10  O-REV-CODE          PIC X.                           08480
         10  O-CALL-ISS-TYPE         PIC X.                           08490
         10  O-SF-CODE           PIC X.                           08500
         10  O-CALL-TYPE         PIC X.                           08510
         10  O-REDEMPTION            PIC X.                           08520
         10  O-PREMIUM-CODE          PIC X.                           08530
         10  O-CALL-AMT          PIC 9(7).                        08540
         10  O-CALL-PRICE            PIC 9(4)V9(3).                       08550
         10  O-BD-CUR-YLD            PIC 9(2)V9(4).                       08560
         10  O-BD-INT-PMT            PIC 9(3)V9(3).                       08570
         10  O-BD-REC-DT         PIC 9(6).                        08580
         10  O-BD-PMT-DT         PIC 9(6).                        08590
         10  O-BD-PMT-MTD            PIC X.                           08600
         10  O-BD-PMT-CD         PIC X.                           08610
         10  O-BD-TX-BS-CD           PIC X.                           08620
         10  O-BD-LR-CD          PIC X.                           08630
         10  O-BD-PMT-FQ         PIC X.                           08640
         10  O-BD-TRANS-CD           PIC X.                           08650
         10  O-BD-RV-IND         PIC X.                           08660
         10  O-BD-ECODE          PIC X.                           08670
   01  OUTP-216-REC REDEFINES OUTP-REC.                               08680
       05  FILLER            PIC X(10).                           08690
       05  O-DATA            PIC X(206).                          08700
      *                                     08710
   01  W-DIV-REC             PIC X(80) VALUE SPACES.                  08720
   01  W-DIV REDEFINES W-DIV-REC.                                 08730
       03  DIV-REC  OCCURS 2.                                     08740
       05  D-QSIP.                                        08750
         10  D-ISSUE-R           PIC X(8).                        08760
         10  D-ECODE             PIC X.                           08770
         10  D-DIV-SECT-NUM          PIC 9.                           08780
       05  D-X-QSIP REDEFINES D-QSIP.                                 08790
         10  D-ISSUER            PIC  X(6).                           08800
         10  D-ISSUE           PIC X(2).                          08810
         10  FILLER            PIC X(2).                          08820
       05  D-CHK-DG              PIC 9.                           08830
       05  D-ISS-TYPE            PIC X.                           08840
       05  D-AMT-RATE            PIC 9(2)V9(4).                       08850
       05  D-XDIS-AMT-DT.                                     08860
         10  D-XDIS-Y            PIC 9.                           08870
         10  D-XDIS-MM           PIC 9(2).                        08880
         10  D-XDIS-DD           PIC 9(2).                        08890
       05  D-REC-DT.                                          08900
         10  D-REC-Y             PIC 9.                           08910
         10  D-REC-MM            PIC 9(2).                        08920
         10  D-REC-DD            PIC 9(2).                        08930
       05  D-PAY-DT.                                          08940
         10  D-PAY-Y             PIC 9.                           08950
         10  D-PAY-MM            PIC 9(2).                        08960
         10  D-PAY-DD            PIC 9(2).                        08970
       05  D-LR-CD               PIC 9.                           08980
       05  D-REV-IND             PIC X.                           08990
       05  D-BRR-CD              PIC X.                           09000
       05  D-TRANS-CD            PIC X.                           09010
       05  D-PMT-MTD             PIC X.                           09020
       05  D-PMT-ODR             PIC X.                           09030
       05  D-TX-BS-CD            PIC X.                           09040
      *                                     09050
   01  COM-DIV-REC               PIC X(80) VALUE SPACES.                  09060
   01  COM-DIV REDEFINES COM-DIV-REC.                                 09070
       03  COM-OPT-DIV-REC OCCURS 2.                                  09080
       05  COM-OPT-QSIP.                                      09090
         10  COM-OPT-ISSUE-R         PIC X(8).                        09100
         10  COM-OPT-ECODE           PIC X.                           09110
         10  COM-OPT-DIV-SECT-NUM        PIC 9.                           09120
       05  COM-OPT-X-QSIP REDEFINES COM-OPT-QSIP.                             09130
         10  COM-OPT-ISSUER          PIC  X(6).                           09140
         10  COM-OPT-ISSUE         PIC X(2).                          09150
         10  FILLER            PIC X(2).                          09160
       05  COM-OPT-CHK-DG            PIC 9.                           09170
       05  COM-OPT-ISS-TYPE          PIC X.                           09180
       05  COM-OPT-AMT-RATE          PIC 9(2)V9(4).                       09190
       05  COM-OPT-XDIS-AMT-DT.                                   09200
         10  COM-OPT-XDIS-Y          PIC 9.                           09210
         10  COM-OPT-XDIS-MM         PIC 9(2).                        09220
         10  COM-OPT-XDIS-DD         PIC 9(2).                        09230
       05  COM-OPT-REC-DT.                                    09240
         10  COM-OPT-REC-Y           PIC 9.                           09250
         10  COM-OPT-REC-MM          PIC 9(2).                        09260
         10  COM-OPT-REC-DD          PIC 9(2).                        09270
       05  COM-OPT-PAY-DT.                                    09280
         10  COM-OPT-PAY-Y           PIC 9.                           09290
         10  COM-OPT-PAY-MM          PIC 9(2).                        09300
         10  COM-OPT-PAY-DD          PIC 9(2).                        09310
       05  COM-OPT-LR-CD         PIC 9.                           09320
       05  COM-OPT-REV-IND           PIC X.                           09330
       05  COM-OPT-BRR-CD            PIC X.                           09340
       05  COM-OPT-TRANS-CD          PIC X.                           09350
       05  COM-OPT-PMT-MTD           PIC X.                           09360
       05  COM-OPT-PMT-ODR           PIC X.                           09370
       05  COM-OPT-TX-BS-CD          PIC X.                           09380
   01  W-NINES         PIC X(216) VALUE ALL '9'.                          09390
   PROCEDURE DIVISION.                                        09400
   JOB-START SECTION.                                         09410
   JOB-START-PARA.                                        09420
      * TOP LEVEL ROUTINE                               09430
                                        09440
      * OPEN PRINT FILE AND DISPLAY HEADER                      09450
       PERFORM PRINT-ID.                                      09460
                                        09470
      * OPEN FILES                                  09480
       PERFORM OPEN-FILES.                                    09490
                                        09500
      * READ THE LABEL RECORD - IF NOT THERE END PROCESSING                 09510
       PERFORM READ-LABEL.                                    09520
       IF FATAL-ERROR GO TO STOP-RUN.                                 09530
                                        09540
      * READ THE DATE RECORD - IF NOT THERE END PROCESSING              09550
       PERFORM LABEL-DT.                                      09560
       IF FATAL-ERROR GO TO STOP-RUN.                                 09570
                                        09580
      * READ THE BULLETINS FROM THE TRAN FILE, PUTTING THEM INTO            09590
      * A SEPARATE FILE - IF ERRORS END PROCESSING                  09600
       PERFORM SEP-REC.                                       09610
       IF FATAL-ERROR GO TO STOP-RUN.                                 09620
                                        09630
      * READ THE BULLETIN FILE UNTIL FIND FIRST VALID BULLETIN RECORD           09640
      * READ THE TRAN FILE UNTIL FIND FIRST VALID TRAN RECORD               09650
      * - IF ERRORS END PROCESSING                          09660
       PERFORM LOAD-BUF.                                      09670
       IF FATAL-ERROR GO TO STOP-RUN.                                 09680
                                        09690
      * PROCESS THE DATA FILES - IF ERRORS END PROCESSING               09700
       PERFORM MAIN-JOB.                                      09710
       IF FATAL-ERROR GO TO STOP-RUN.                                 09720
                                        09730
      * PAD OUTPUT 216 FILE WITH 9'S RECORDS TILL END OF BLOCK              09740
       PERFORM END-OF-OUTPUT-NINES.                                   09750
                                        09760
      * PRINT MESSAGE - NORMAL END OF JOB                       09770
       MOVE +2 TO M.                                          09780
       PERFORM WRITE-MESS.                                    09790
                                        09800
      * END OF JOB PROCESSING STARTS HERE                       09810
   STOP-RUN.                                          09820
                                        09830
      * WRITE OUT SUMMARY INFO TO PRINT FILE                    09840
       PERFORM WRITE-SUMMARY.                                     09850
                                        09860
      * CLOSE THE FILES                             09870
       PERFORM CLOSE-FILES.                                       09880
       STOP RUN.                                          09890
      *********************************************************             09900
      *********************************************************             09910
      *                                     09920
   PRINT-ID SECTION.                                          09930
   PRINT-ID-PARA.                                         09940
      * OPEN PRINT FILE AND DISPLAY HEADER                      09950
       OPEN OUTPUT PRINT-FILE.                                    09960
       WRITE PRINT-REC FROM ID-1 AFTER ADVANCING NEXT-PAGE.                       09970
       WRITE PRINT-REC FROM ID-2 AFTER ADVANCING 2 LINES.                         09980
       WRITE PRINT-REC FROM DASHES AFTER ADVANCING 1 LINES.                       09990
       MOVE SPACES TO PRINT-REC.                                  10000
       WRITE PRINT-REC AFTER ADVANCING 6 LINES.                           10010
      *                                     10020
      *********************************************************             10030
      *                                     10040
   OPEN-FILES SECTION.                                        10050
   OPEN-FILES-PARA.                                       10060
       OPEN INPUT OLDTP70-FILE WITH NO REWIND,                  10070
          TRANS-FILE.                                     10080
       OPEN OUTPUT OUTTP70-FILE, UPDATE-FILE.                             10090
       MOVE +3 TO M   PERFORM WRITE-MESS.                                 10100
   OF-EXIT.           EXIT.                                         10110
      *                                     10120
      *********************************************************             10130
      *                                     10140
   READ-LABEL SECTION.                                        10150
   READ-LABEL-PARA.                                       10160
       MOVE +0 TO I.                                          10170
   RL-READ.                                           10180
       READ TRANS-FILE AT END                           10190
      * EOF BEFORE LABEL RECORD FOUND - WRITE ERROR AND ABEND               10200
      MOVE +4 TO M                              10210
      PERFORM WRITE-MESS                            10220
      MOVE 1 TO BAD-NEWS                            10230
      GO TO RL-EXIT.                                      10240
       COMPUTE I = I + 1.                                     10250
       IF I GREATER 3                               10260
      * 4 READS WITHOUT FINDING LABEL RECORD - WRITE ERROR AND ABEND            10270
      MOVE +5 TO M                              10280
      PERFORM WRITE-MESS                            10290
      MOVE 1 TO BAD-NEWS                            10300
      GO TO RL-EXIT.                                      10310
       IF T-LABEL NOT EQUAL TO 'TRAN' AND                       10320
      DUMMY NOT EQUAL TO 'LABEL'                        10330
      * IF NOT LABEL RECORD, READ AGAIN                         10340
      GO TO RL-READ.                                      10350
                                        10360
      * FOUND LABEL RECORD, SET FLAGS AND WRITE PROGRESS MESSAGE            10370
       IF T-SCALE-FLAG = 'S'                            10380
      MOVE 'T' TO OPT-SCALE-FLAG.                                 10390
       IF T-EXT-ISTYP-FLAG = 'N'                        10400
      MOVE 'T' TO ISS-TYPE-FLAG.                                  10410
       MOVE +23 TO M.                                         10420
       PERFORM WRITE-MESS.                                    10430
       MOVE TRANS-REC TO HDR.                                     10440
   RL-EXIT.           EXIT.                                         10450
      *                                     10460
      *********************************************************             10470
      *                                     10480
   LABEL-DT   SECTION.                                        10490
   LABEL-DT-PARA.                                         10500
      * READ THE DATE RECORD AND SET CURRENT DATE VARIABLES                 10510
                                        10520
       READ TRANS-FILE AT END                           10530
      * IF EOF WITH NO DATE RECORD, WRITE ERROR AND ABEND               10540
      MOVE +6 TO M                              10550
      PERFORM WRITE-MESS                            10560
      MOVE 1 TO BAD-NEWS                            10570
      GO TO LD-EXIT.                                      10580
                                        10590
       MOVE T-LABEL-DT TO TODAYS-DT, HDR-DT.                              10600
       MOVE TD-YY TO WS-TD-YY.                                    10610
       MOVE TODAYS-DT-FT TO WS-TD-MD.                                 10620
                                        10630
      * COMPUTE THE CENTURY - DATE LESS THAN 1970 ASSUMES 21ST CENTURY          10640
       COMPUTE TD-YYYY = TD-YY + 1900.                                10650
       IF TD-YYYY LESS 1970                             10660
      ADD +100 TO TD-YYYY.                                    10670
       MOVE TD-YYYY TO S-YYYY-1.                                  10680
       MOVE TODAYS-DT-FT TO S-DT-FT.                                  10690
       COMPUTE TD-M-CNT = TD-YYYY * 12 + TD-MM.                           10700
                                        10710
      * WRITE PROGRESS MESSAGE                          10720
       MOVE +24 TO M.                                         10730
       PERFORM WRITE-MESS.                                    10740
   LD-EXIT.           EXIT.                                         10750
      *                                     10760
      *********************************************************             10770
      *                                     10780
   SEP-REC SECTION.                                       10790
   SEP-REC-PARA.                                          10800
      * READ THE BULLETINS FROM THE TRAN FILE, PUTTING THEM INTO            10810
      * A SEPARATE FILE                             10820
                                        10830
   SR-READ.                                           10840
       READ TRANS-FILE INTO UPD-REC AT END                      10850
      * EOF BEFORE TRAN RECORDS FOUND - WRITE ERROR AND ABEND               10860
      MOVE +7 TO M                              10870
      PERFORM WRITE-MESS                            10880
      MOVE 1 TO BAD-NEWS                            10890
      GO TO SR-EXIT.                                      10900
                                        10910
       IF U-ISSUER EQUAL TO '999999'                        10920
      NEXT SENTENCE                             10930
       ELSE                                 10940
      * IF HAVEN'T HIT 9'S SEPARATOR RECORD, WRITE RECORD TO UPDATE             10950
      * FILE AND READ NEXT RECORD                           10960
      WRITE UPD-REC                             10970
      GO TO SR-READ.                                      10980
                                        10990
      * WRITE 9'S SEPARATOR RECORD TO UPDATE FILE                   11000
       WRITE UPD-REC.                                         11010
                                        11020
      * CLOSE FILE AND REOPEN FOR INPUT                         11030
       CLOSE UPDATE-FILE.                                     11040
       OPEN INPUT UPDATE-FILE.                                    11050
                                        11060
      * WRITE PROGRESS MESSAGE                          11070
       MOVE +8 TO M.                                          11080
       PERFORM WRITE-MESS.                                    11090
   SR-EXIT.           EXIT.                                         11100
      *                                     11110
      *********************************************************             11120
      *                                     11130
   LOAD-BUF SECTION.                                          11140
   LOAD-BUF-PARA.                                         11150
      * PERFORMS THE PRIMING READS OF THE 3 INPUT FILES,                11160
      * AND INITIALIZES THE OUTPUT CUSIP TO THE LOWEST OF               11170
      * THE INPUT CUSIPS                                11180
                                        11190
      * READ THE BULLETIN FILE UNTIL FIND FIRST VALID BULLETIN RECORD           11200
       PERFORM UPD-READ.                                      11210
       IF U-ISSUER EQUAL TO '000000'                        11220
      PERFORM UPD-READ UNTIL (ENDUPD) OR                    11230
      (U-ISSUER NOT EQUAL TO '000000').                               11240
                                        11250
       MOVE U-X-QSIP TO O-X-QSIP.                                 11260
                                        11270
      * READ THE TRAN FILE UNTIL FIND FIRST VALID TRAN RECORD               11280
       PERFORM TRANS-READ.                                    11290
       IF T-ISSUER EQUAL TO '000000'                        11300
      PERFORM TRANS-READ UNTIL (ENDTRANS) OR                    11310
      (T-ISSUER NOT EQUAL TO '000000').                               11320
                                        11330
       IF T-X-QSIP < O-X-QSIP                           11340
      MOVE T-X-QSIP TO O-X-QSIP.                                  11350
                                        11360
      * READ IN THE FIRST OLD 216 RECORD                        11370
       PERFORM OLDTP-READ.                                    11380
                                        11390
       IF I-X-QSIP < O-X-QSIP                           11400
      MOVE I-X-QSIP TO O-X-QSIP.                                  11410
                                        11420
      * WRITE PROGRESS OR ERROR MESSAGE                         11430
       IF FATAL-ERROR                               11440
      MOVE +9 TO M                              11450
       ELSE                                 11460
      MOVE +10 TO M.                                      11470
       PERFORM WRITE-MESS.                                    11480
   LB-EXIT.           EXIT.                                         11490
      *                                     11500
      **********************************************************            11510
      *                                     11520
   CLOSE-FILES SECTION.                                       11530
   CLOSE-FILES-PARA.                                          11540
      * CLOSE THE FILES                             11550
       MOVE +11 TO M.                                         11560
       PERFORM WRITE-MESS.                                    11570
       CLOSE OLDTP70-FILE, UPDATE-FILE, TRANS-FILE, OUTTP70-FILE,           11580
         PRINT-FILE.                                      11590
   CF-EXIT.           EXIT.                                         11600
      *                                     11610
      *********************************************************             11620
      *                                     11630
   MAIN-JOB SECTION.                                          11640
   MAIN-JOB-PARA.                                         11650
      * PROCESS DATA UNTIL END OF ALL FILES OR FATAL ERROR              11660
       MOVE +12 TO M.                                         11670
       PERFORM WRITE-MESS.                                    11680
       PERFORM MAIN-RTN UNTIL ENDALL OR FATAL-ERROR.                          11690
   MAIN-JOB-EXIT.           EXIT.                                       11700
      *                                     11710
      *********************************************************             11720
      *                                     11730
   MAIN-RTN SECTION.                                          11740
   MAIN-RTN-PARA.                                         11750
      * PROCESSES INPUT DATA                            11760
                                        11770
       IF NOT ENDOLDTP AND                          11780
      I-X-QSIP NOT > U-X-QSIP AND                       11790
      I-X-QSIP NOT > T-X-QSIP                       11800
      PERFORM OLD-RTN                           11810
       ELSE IF NOT ENDUPD AND                           11820
      U-X-QSIP NOT > T-X-QSIP                       11830
      * IF THE UPDATE RECORD HAS THE LOWEST CUSIP, PROCESS IT               11840
      PERFORM UPD-RTN                           11850
       ELSE IF NOT ENDTRANS AND                         11860
      T-X-QSIP NOT > U-X-QSIP OR                        11870
      (T-ISSUE-R = O-ISSUE-R AND T-NOT-PRICE)                   11880
      * IF THE TRAN RECORD HAS THE LOWEST CUSIP, PROCESS IT                 11890
      PERFORM PROC-TRANS.                                     11900
       IF O-X-QSIP < I-X-QSIP AND                       11910
      O-X-QSIP < U-X-QSIP AND                       11920
      O-X-QSIP < T-X-QSIP AND                       11930
      NOT (T-ISSUE-R = O-ISSUE-R AND T-NOT-PRICE)               11940
      PERFORM WRITE-OUTPUT.                                   11950
   MR-EXIT.           EXIT.                                         11960
                                        11970
      **********************************************************            11980
      ****      MAIN-RTN SUBROUTINES        ****            11990
      **********************************************************            12000
   OLD-RTN SECTION.                                       12010
   OLD-RTN-PARA.                                          12020
       MOVE 'F' TO ADD-A-REC, CAP-7, NOT-OLD-TRD.                             12030
       MOVE 'T' TO REC-NOT-TRADED.                                    12040
       MOVE INTP-REC TO OUTP-REC.                                 12050
       PERFORM OUTREC-INIT.                                       12060
       MOVE I-X-QSIP TO HI-X-QSIP.                                    12070
       MOVE I-TRD-TYPE TO HI-TRD-TYPE.                                12080
       MOVE I-CLOSE TO HI-CLOSE.                                  12090
       MOVE I-CLOSE-ADJ TO HI-CLOSE-ADJ.                              12100
       MOVE I-CLOSE-ADJ TO HI-CLOSE-ADJ.                              12110
       MOVE I-ADJ-PREV-CLOSE TO HI-ADJ-PREV-CLOSE.                            12120
       MOVE I-ADJ-PREV-CLOSE-ADJ TO HI-ADJ-PREV-CLOSE-ADJ.                        12130
       MOVE I-LOW TO HI-LOW.                                      12140
       MOVE I-LOW-ADJ TO HI-LOW-ADJ.                                  12150
       MOVE I-HIGH TO HI-HIGH.                                    12160
       MOVE I-HIGH-ADJ TO HI-HIGH-ADJ.                                12170
   SKIP-C.                                            12180
       PERFORM OLDTP-READ.                                    12190
       IF I-ISS-ST = 'C'                            12200
      ADD +1 TO P-CNT                           12210
      GO TO SKIP-C.                                       12220
   ORTN-EXIT.           EXIT.                                       12230
      *                                     12240
   OLDTP-READ SECTION.                                        12250
   OLDTP-READ-PARA.                                       12260
      * READ IN THE OLD 216 RECORD                          12270
                                        12280
       IF ENDOLDTP                              12290
      GO TO OR-EXIT                             12300
       ELSE                                 12310
      READ OLDTP70-FILE AT END                          12320
         MOVE 1 TO BAD-NEWS                         12330
         MOVE  22 TO M                          12340
         PERFORM WRITE-MESS                         12350
         PERFORM SHOW-QSIP                          12360
         MOVE 'T' TO W-ENDOLDTP                         12370
         GO TO OR-EXIT.                                       12380
       IF I-ISSUER EQUAL TO '999999'                        12390
      MOVE 'T' TO W-ENDOLDTP                        12400
      GO TO OR-EXIT                             12410
       ELSE                                 12420
      ADD 1 TO  W-OLDTP-CNT                         12430
      * FOR STOCKS RESET THE SPLIT ADJUSTMENT FACTOR TO 1               12440
      MOVE I-ISS-TYPE TO TEST-ISS-TYPE                      12450
      IF TEST-IS-STOCK                          12460
         MOVE '1' TO I-ADJ-FACT.                                  12470
                                        12480
   OR-EXIT.           EXIT.                                         12490
      *                                     12500
      *********************************************************             12510
      *                                     12520
   UPD-RTN SECTION.                                       12530
   UPD-RTN-PARA.                                          12540
      *                                     12550
      *  PROCESS UPDATE - BULLETINS AND CAPITALIZATION CHANGES              12560
      *                                     12570
       IF U-X-QSIP NOT = O-X-QSIP                       12580
      * THIS CUSIP WAS NOT ON THE INPUT 216 FILE, SO MAKE A                 12590
      * SKELETON RECORD                             12600
      MOVE U-X-QSIP TO O-X-QSIP                         12610
      PERFORM NEW-RECRD                             12620
      IF U-ISS-ST EQUAL TO '1' OR '3' OR '4' OR 'K' OR 'N'              12630
         ADD +1 TO SC-CNT                           12640
      ELSE                                  12650
         ADD +1 TO NSC-CNT.                                   12660
                                        12670
      * PROCESS THIS UPDATE RECORD                          12680
       PERFORM PROC-UPD.                                      12690
                                        12700
      * READ THE NEXT UPDATE RECORD                         12710
       PERFORM UPD-READ.                                      12720
                                        12730
   UR-EXIT.           EXIT.                                         12740
      *                                     12750
      **********************************************************            12760
      *                                     12770
      ****      UPD-RTN SUBROUTINES         ****            12780
      **********************************************************            12790
      *                                     12800
   NEW-RECRD SECTION.                                         12810
   NEW-RECRD-PARA.                                        12820
      *                                     12830
      * INITIALIZE THE OUTPUT RECORD FIELDS                     12840
       MOVE W-NINES TO O-DATA.                                    12850
       MOVE ZEROS TO O-PRICE-SECT.                                    12860
       MOVE ZEROS TO O-DIVIDEND-AREAS.                                12870
       MOVE 'H' TO O-DIV-RV-IND(1), O-DIV-RV-IND(2).                          12880
       MOVE '2' TO O-DIV-ECODE(1), O-DIV-ECODE(2).                            12890
       MOVE 'T' TO ADD-A-REC.                                     12900
       PERFORM OUTREC-INIT.                                       12910
                                        12920
      * IF ADDING FOR A PRICE TRAN RECORD, SET DEFAULT ISSUE TYPE           12930
       IF O-X-QSIP = T-X-QSIP                           12940
      MOVE '4' TO O-ISS-ST                          12950
      IF T-FUTURE-PRICE                             12960
         MOVE 'C' TO O-ISS-TYPE                         12970
      ELSE IF T-BOND-PRICE                          12980
         MOVE '6' TO O-ISS-TYPE                         12990
      ELSE IF T-STOCK-PRICE                         13000
         MOVE '0' TO O-ISS-TYPE                         13010
      ELSE IF T-OPTION-PRICE                        13020
         IF T-EQUITY-OPT                            13030
            MOVE 'B' TO O-ISS-TYPE                      13040
         ELSE                               13050
            MOVE 'D' TO O-ISS-TYPE.                               13060
                                        13070
   NR-EXIT.           EXIT.                                         13080
      *                                     13090
      **********************************************************            13100
      *                                     13110
   WRITE-OUTPUT SECTION.                                      13120
   WRITE-OUTPUT-PARA.                                         13130
      * DOES SOME UPDATES TO OUTPUT 216 RECORD AND WRITES IT                13140
                                        13150
       IF O-ISS-ST = 'E'                            13160
      * DO NOT KEEP OLD RECORD ON EXCHANGE CHANGES                  13170
      GO TO WO-EXIT.                                      13180
                                        13190
       MOVE O-ISS-TYPE TO TEST-ISS-TYPE.                              13200
       IF C5-CHANGE                             13210
      MOVE 'F' TO C5-STAT-CHANGE                        13220
       ELSE                                 13230
      * IF HAVEN'T HAD 'C' OR '5' STATUS BULLETIN,                  13240
      * TEST IF SECURITY HAS MATURED                        13250
      IF TEST-IS-OPTION OR TEST-IS-BOND OR TEST-IS-FUTURE           13260
         MOVE O-MAT-YYYY TO YYYY-1                      13270
         MOVE O-MAT-MM TO MM-1                          13280
         MOVE O-MAT-DD TO DD-1                          13290
         IF (CHK-DATE  LESS SAVE-DATE)                      13300
            IF (O-ISS-ST EQUAL TO '0')                      13310
           MOVE '5' TO O-ISS-ST                     13320
            ELSE IF (O-ISS-ST EQUAL TO '5')                 13330
           MOVE 'C' TO O-ISS-ST                     13340
            ELSE                                13350
           NEXT SENTENCE                        13360
         ELSE                               13370
            NEXT SENTENCE                           13380
      ELSE                                  13390
         NEXT SENTENCE.                                       13400
                                        13410
       IF TEST-IS-EQUITY-OPTION                         13420
      * FILL IN OPTIONS DIVIDEND SECTION                        13430
      PERFORM CHK-COM-DIV VARYING P FROM 1 BY 1 UNTIL P > 2             13440
       ELSE IF TEST-IS-STOCK                            13450
      * PROCESS DIVIDENDS                               13460
      PERFORM CHK-DIV-RECS.                                   13470
                                        13480
       PERFORM TRD-RT.                                        13490
       IF O-DESCRIP-CHK EQUAL TO '9999' AND O-X-QSIP NOT EQUAL TO           13500
             '9999999999'                       13510
      ADD +1 TO NO-DESCRIP-CNT.                                   13520
       IF O-X-QSIP NOT EQUAL TO '9999999999'                    13530
      ADD +1 TO W-OUTP-CNT.                                   13540
                                        13550
       IF NON-EXTENDED                              13560
      * IF THEY DON'T WANT EXTENDED ISSUE TYPE, CONVERT TO NON-EXTENDED         13570
      IF O-ISS-TYPE NOT < 'H' AND O-ISS-TYPE NOT > 'Z'              13580
         AND O-ISS-TYPE NOT = 'Q'                       13590
         MOVE '6' TO O-ISS-TYPE.                                  13600
                                        13610
       IF TEST-IS-EQUITY-OPTION                         13620
      * IF AN OPTION'S UNDERLYING SECURITY HAD A NEW IAD REPORTED,              13630
      * PUT IT IN OPTION RECORD                             13640
      IF O-OP-UCUS = HOLD-IAD-CUSIP                     13650
         MOVE HOLD-IAD TO O-OP-IAD.                               13660
                                        13670
       WRITE OUTP216-REC FROM OUTP-REC.                               13680
       MOVE O-X-QSIP TO OUT-QSIP-SAVE.                                13690
       MOVE O-X-TIC TO OUT-TIC-SAVE.                                  13700
       MOVE O-SIC TO OUT-SIC-SAVE.                                    13710
       MOVE O-ISSUER-DESCRIP TO OUT-DESC-SAVE.                            13720
       IF NEW-REC                               13730
      MOVE 'F' TO ADD-A-REC.                                  13740
       MOVE 'T' TO REC-NOT-TRADED.                                    13750
       MOVE 'F' TO CAP-7, NOT-OLD-TRD.                                13760
                                        13770
   WO-EXIT.                                           13780
       EXIT.                                          13790
      *                                     13800
      **********************************************************            13810
      *                                     13820
   TRD-RT   SECTION.                                          13830
   TRD-RT-PARA.                                           13840
      *                                     13850
      *  CHECKS TO SEE IF RECORD TRADED.                                  13860
      *  ADJUSTS TRADE TYPE, ISSUE-STATUS, ADJUSTMENT FACTOR,               13870
      *  ADJUSTMENT TO PREVIOUS CLOSE WHERE EVER NECESSARY.                           13880
      *                                     13890
       MOVE O-ISS-TYPE TO TEST-ISS-TYPE.                              13900
       IF NOT-TRADED                                13910
      IF O-TRD-TYPE EQUAL TO 'Z' OR NEW-TRD-TYPE                13920
      *  IF ACTIVE FOR DIVIDENDS ONLY, OR HAS A NEW TRADE TYPE,             13930
      *  DON'T UPDATE TRADE TYPE, PREVIOUS CLOSE OR YIELD               13940
         GO TO TT-EXIT                          13950
      ELSE                                  13960
      *  SET UNTRADED SECURITY'S TRADE TYPE TO 9                    13970
         MOVE '9' TO O-TRD-TYPE                         13980
         IF NOT TEST-IS-STOCK                       13990
            GO TO TT-EXIT                           14000
         ELSE IF (O-ADJ-FACT NOT EQUAL TO 1 AND 0) AND              14010
             NOT (NEW-REC)                          14020
      *  IF IS A STOCK AND HAS SPLIT, ADJUST PREVIOUS CLOSE                 14030
            COMPUTE O-ADJ-PREV-CLOSE =                      14040
           O-ADJ-PREV-CLOSE * O-ADJ-FACT                    14050
            GO TO TT-EXIT                           14060
         ELSE                               14070
            GO TO TT-EXIT                           14080
       ELSE                                 14090
      NEXT SENTENCE.                                      14100
       IF (O-ISS-ST EQUAL TO '3' OR '4')                    14110
      IF NEW-REC                                14120
         NEXT SENTENCE                          14130
      ELSE                                  14140
      *  IF ISSUE STATUS WAS 3 OR 4, AND RECORD ISN'T NEW, RESET            14150
      *  ISSUE STATUS TO 0                              14160
         MOVE '0' TO O-ISS-ST                       14170
       ELSE IF O-ISS-ST EQUAL TO 'N'                        14180
      *  IF WAS A NEW RECORD, AND HAS TRADED, SET ISSUE STATUS TO 4             14190
      MOVE '4' TO O-ISS-ST                          14200
       ELSE IF O-ISS-ST EQUAL TO '1' OR '2' OR '5' OR '6'               14210
                  OR '7' OR '8' OR '9'                  14220
      *  LEAVE THESE ISSUE STATUS' ALONE                        14230
      NEXT SENTENCE                             14240
       ELSE                                 14250
      *  RESET ALL REMAINING STATUS' TO 0                       14260
      MOVE '0' TO O-ISS-ST.                                   14270
                                        14280
      *  CALCULATE CURRENT YIELD FOR BONDS                      14290
       IF (O-UNQ-CD EQUAL TO 'U' OR 'Z')                    14300
      *  BONDS TRADING FLAT HAVE NO NEW YIELD                       14310
      NEXT SENTENCE                             14320
       ELSE IF (O-ISS-ST = '0' OR '1' OR '3' OR '4' OR '6' OR           14330
               '8' OR '9')                      14340
      IF O-X-CD = 'L' OR 'M'                        14350
      *  LISTED BONDS WITH ACTIVE STATUS - YIELD IS AS FOLLOWS              14360
         IF O-TRD-TYPE EQUAL TO '8' OR 'A' AND O-LOW                14370
      *  BID/ASK OR MODEL PRICES USE BID (O-LOW)                    14380
            NOT EQUAL TO 0                          14390
            COMPUTE O-BD-CUR-YLD =                      14400
            ((O-COUP-RATE * 100.          0) / O-LOW)                 14410
         ELSE IF O-TRD-TYPE EQUAL TO '9'                    14420
            IF O-VOL EQUAL TO 0 AND O-LOW NOT EQUAL TO 0            14430
      *  UNTRADED WITH BID/ASK USE OLD BID (O-LOW)                  14440
           COMPUTE O-BD-CUR-YLD ROUNDED =                   14450
               ((O-COUP-RATE * 100.          0) / O-LOW)              14460
            ELSE IF O-CLOSE NOT EQUAL TO 0                  14470
      *  OTHER UNTRADED USE CLOSE                           14480
           COMPUTE O-BD-CUR-YLD ROUNDED =                   14490
               ((O-COUP-RATE * 100.          0) / O-CLOSE)            14500
            ELSE                                14510
      *  IF NO BID OR CLOSE, WRITE ERROR                        14520
           MOVE 0 TO O-BD-CUR-YLD                       14530
           MOVE +26 TO M                        14540
           PERFORM WRITE-MESS                       14550
           MOVE O-X-QSIP TO O-ERR-QSIP                  14560
           MOVE ERR-LINE-2 TO PRINT-LINE                    14570
           WRITE PRINT-REC AFTER ADVANCING 1 LINES              14580
         ELSE IF O-VOL EQUAL TO 0 AND                       14590
      * IF TRADE TYPE NO '8', 'A', '9', AND NOT '0', USE BID (O-LOW)            14600
             O-TRD-TYPE NOT EQUAL TO '0' AND                14610
             O-LOW NOT EQUAL TO 0                       14620
             COMPUTE O-BD-CUR-YLD ROUNDED =                 14630
                ((O-COUP-RATE * 100.          0) / O-LOW)             14640
         ELSE IF O-CLOSE NOT EQUAL TO 0                     14650
      * IF TRADE TYPE '0' AND HAVE CLOSE, USE CLOSE                 14660
            COMPUTE O-BD-CUR-YLD ROUNDED =                  14670
            ((O-COUP-RATE * 100.          0) / O-CLOSE)               14680
         ELSE                               14690
      * IF TRADE TYPE '0' AND NO CLOSE, PRINT ERROR                 14700
            MOVE 0 TO O-BD-CUR-YLD                      14710
            MOVE +26 TO M                           14720
            PERFORM WRITE-MESS                          14730
            MOVE O-X-QSIP TO O-ERR-QSIP                     14740
            MOVE ERR-LINE-2 TO PRINT-LINE                   14750
            WRITE PRINT-REC AFTER ADVANCING 1 LINES                 14760
      ELSE IF O-X-CD EQUAL TO 'N' OR 'O' OR 'P' OR              14770
                  'S' OR 'X'                    14780
      *  NON-LISTED BONDS GET YIELD AS FOLLOWS                      14790
         IF O-TRD-TYPE EQUAL TO '9' AND                     14800
            O-ADJ-PREV-CLOSE NOT EQUAL TO 0                 14810
      *  IF UNTRADED, USE ADJUSTED PREVIOUS CLOSE                   14820
            COMPUTE O-BD-CUR-YLD =                      14830
          ((O-COUP-RATE * 100.          0) / O-ADJ-PREV-CLOSE)            14840
         ELSE IF O-LOW NOT EQUAL TO 0                       14850
      *  IF TRADED AND HAVE BID (O-LOW), USE BID                    14860
           COMPUTE O-BD-CUR-YLD = ((O-COUP-RATE                 14870
                       * 100.          0) / O-LOW)            14880
         ELSE IF O-CLOSE NOT EQUAL TO 0                     14890
      *  NO BID, SO USE CLOSE                           14900
           COMPUTE O-BD-CUR-YLD =                       14910
              ((O-COUP-RATE * 100.          0) / O-CLOSE)                 14920
         ELSE                               14930
      *  NO BID, NO CLOSE, PRINT ERROR                          14940
            MOVE 0 TO O-BD-CUR-YLD                      14950
            MOVE +26 TO M                           14960
            PERFORM WRITE-MESS                          14970
            MOVE O-X-QSIP TO O-ERR-QSIP                     14980
            MOVE ERR-LINE-2 TO PRINT-LINE                   14990
            WRITE PRINT-REC AFTER ADVANCING 1 LINES                 15000
         ELSE                               15010
            NEXT SENTENCE                           15020
      ELSE                                  15030
         NEXT SENTENCE.                                       15040
                                        15050
       IF TEST-IS-STOCK                             15060
      IF NEW-REC                                15070
         IF CAP-7-REC                           15080
            NEXT SENTENCE                           15090
         ELSE                               15100
      *  NEW STOCKS WITHOUT CAP CHANGE 7, SET ADJUSTMENT FACTOR TO 1            15110
            MOVE '1' TO O-ADJ-FACT                      15120
      ELSE IF O-TRD-TYPE EQUAL TO '1' OR CAP-7-REC              15130
      *  IF EXISTING STOCK HAS A SPLIT, ADJUST PREVIOUS CLOSE               15140
         COMPUTE O-ADJ-PREV-CLOSE = O-ADJ-PREV-CLOSE *              15150
                      O-ADJ-FACT                15160
      ELSE                                  15170
         NEXT SENTENCE.                                       15180
   TT-EXIT.           EXIT.                                         15190
      *                                     15200
      **********************************************************            15210
      ****       TRANS-UPD-OLD SUBROUTINES      ****            15220
      **********************************************************            15230
      *                                     15240
   UPD-READ    SECTION.                                       15250
   UPD-READ-PARA.                                         15260
       IF ENDUPD                                15270
      GO TO UR-EXIT                             15280
       ELSE                                 15290
      READ UPDATE-FILE AT END                       15300
         MOVE 1 TO BAD-NEWS                         15310
         MOVE +20 TO M                          15320
         PERFORM WRITE-MESS                         15330
         PERFORM SHOW-QSIP                          15340
         MOVE 'T' TO W-ENDUPD                       15350
         GO TO UR-EXIT.                                       15360
       IF U-ISSUER EQUAL TO '999999'                        15370
      MOVE 'T' TO W-ENDUPD                          15380
       ELSE                                 15390
      MOVE UPD-REC TO LT-U-REC                          15400
      ADD  1 TO W-UPD-CNT.                                    15410
   UR-EXIT.           EXIT.                                         15420
      *                                     15430
      *********************************************************             15440
      *                                     15450
   PROC-UPD   SECTION.                                    15460
   PROC-UPD-PARA.                                         15470
      *                                     15480
      *  CHECKS TO SEE IF BULLETIN RECORD IS A STATUS CHANGE,STATUS             15490
      *  CAPITALIZATION CHANGE OR STATUS CONTINUATION RECORD                15500
      *                                     15510
       IF U-IS-CAP                              15520
      PERFORM CAP-REC                           15530
       ELSE IF U-IS-BULL                            15540
      IF UC-CON-IND GREATER 0                       15550
         PERFORM STAT-CON                           15560
      ELSE                                  15570
         PERFORM STAT-CHNG.                                   15580
      *                                     15590
      *********************************************************             15600
      ****        PROC-UPD SUBROUTINES         ****             15610
      *********************************************************             15620
      *                                     15630
   CAP-REC SECTION.                                       15640
   CAP-REC-PARA.                                          15650
       ADD 1 TO CR-CNT.                                       15660
       IF C-CAP-SECT EQUAL TO 6                         15670
      PERFORM IAD-6                             15680
       ELSE IF C-CAP-SECT EQUAL TO 7                        15690
      PERFORM RECAP-7                           15700
       ELSE IF C-CAP-SECT EQUAL TO 9                        15710
      PERFORM TRD-REV-9                             15720
       ELSE                                 15730
      PERFORM CAP-SEC-ERROR.                                  15740
      *::::::::::::::::::::::::::::::::::::::::::::::::::::                 15750
   IAD-6 SECTION.                                         15760
   IAD-6-PARA.                                            15770
       MOVE C-ISS-TYPE TO TEST-ISS-TYPE.                              15780
       IF TEST-IS-BOND                              15790
      MOVE C-BOND-SUPP-TYPE TO O-SUPP-TYPE                  15800
      GO TO I-6-EXIT.                                     15810
       MOVE C-IAD-FOOT TO W-IAD-FOOT.                                 15820
       MOVE C-IAD TO W-IAD.                                       15830
       IF W-IAD-FOOT EQUAL TO '9'                       15840
      MOVE 0 TO W-IAD                           15850
       ELSE IF W-IAD-FOOT EQUAL TO '7'                      15860
      MOVE '8' TO W-IAD-FOOT                        15870
      COMPUTE W-IAD = (W-IAD / 10)                      15880
       ELSE IF W-IAD LESS 10                            15890
      NEXT SENTENCE                             15900
       ELSE IF W-IAD LESS 20                            15910
      MOVE '1' TO W-IAD-FOOT                        15920
      COMPUTE W-IAD = (W-IAD - 10)                      15930
       ELSE IF W-IAD LESS 30                            15940
      MOVE '2' TO W-IAD-FOOT                        15950
      COMPUTE W-IAD = (W-IAD - 20)                      15960
       ELSE                                 15970
      MOVE '7' TO W-IAD-FOOT                        15980
      COMPUTE W-IAD = (W-IAD / 10).                               15990
       MOVE W-IAD-FOOT TO O-IAD-FOOT.                                 16000
       MOVE W-IAD      TO O-IAD.                                  16010
       MOVE C-EPS TO O-ERN-PER-SHR.                                   16020
       MOVE C-EPS-IND TO O-NEG-IND.                                   16030
       MOVE C-12M-END-DT TO O-END12-DT.                               16040
      * SAVE THE LATEST IAD UPDATE TO PUT IN OPTIONS RECORDS                16050
       MOVE W-IAD TO HOLD-IAD.                                    16060
       MOVE U-ISSUE-R TO HOLD-IAD-CUSIP.                              16070
   I-6-EXIT.           EXIT.                                        16080
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::           16090
   RECAP-7 SECTION.                                       16100
   RECAP-7-PARA.                                          16110
       IF O-ISS-TYPE EQUAL TO 'B' OR 'C' OR 'D'                 16120
      *  OPTIONS AND FUTURES DON'T HAVE CAP 7'S, SO SKIP ANY U GET              16130
      GO TO R-7-EXIT.                                     16140
       MOVE C-SHRS-OUT   TO O-SHRS-OUT.                               16150
       MOVE C-ADJ-FAC    TO O-ADJ-FACT.                               16160
       IF C-ADJ-FAC NOT EQUAL TO 1.          0                        16170
      MOVE 'T' TO CAP-7                             16180
       ELSE                                 16190
      NEXT SENTENCE.                                      16200
   R-7-EXIT.           EXIT.                                        16210
      *                                     16220
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::           16230
      *                                     16240
   TRD-REV-9   SECTION.                                       16250
   TRD-REV-9-PARA.                                        16260
       MOVE C-ISS-TYPE TO TEST-ISS-TYPE.                              16270
       IF TEST-IS-BOND                              16280
      MOVE C-SNP-BD-RATE TO O-SNP-BD                    16290
      MOVE C-MOODY-FIN-QL TO O-MOODY-RATE                   16300
      MOVE C-TRANS-CD TO O-BD-TRANS-CD                      16310
      IF C-BOND-FORM EQUAL '9'                          16320
         NEXT SENTENCE                          16330
      ELSE                                  16340
         MOVE C-BOND-FORM TO O-BOND-FORM                    16350
       ELSE IF TEST-IS-STOCK                            16360
      MOVE C-SNP-BD-RATE  TO O-SNP-RATE                     16370
      MOVE C-MARG-IND TO O-MRG-IND                      16380
      MOVE C-TRANS-CD TO O-DIV2-TRANS-CD(2)                 16390
       ELSE IF TEST-IS-OPTION                           16400
      MOVE C-TRD-UNT-ST  TO O-TRD-UN-ST                     16410
      MOVE C-X-PR-ST    TO O-XPRICE-ST                      16420
      MOVE C-TRD-UNT-ADJ TO O-TRD-ADJ.                                16430
   T-R-EXIT.           EXIT.                                        16440
      *:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::            16450
   CAP-SEC-ERROR SECTION.                                     16460
   CAP-SEC-ERROR-PARA.                                        16470
       MOVE +14 TO M.                                         16480
       PERFORM WRITE-MESS.                                    16490
       PERFORM SHOW-QSIP.                                     16500
       MOVE 2 TO BAD-NEWS.                                    16510
      *                                     16520
      *********************************************************             16530
      *                                     16540
   STAT-CON SECTION.                                          16550
   STAT-CON-PARA.                                         16560
       ADD +1 TO STAT-CON-CNT.                                    16570
       ADD +1 TO CONT-CNT.                                    16580
       IF STAT-CON-CNT GREATER 5                        16590
      MOVE 0 TO STAT-CON-CNT                        16600
      MOVE +15 TO M   PERFORM WRITE-MESS                    16610
      PERFORM SHOW-QSIP                             16620
      MOVE 2   TO BAD-NEWS                          16630
      GO TO STAT-CON-EXIT                           16640
       ELSE IF UC-CON-IND = 1                           16650
      MOVE UC-ISSUER-1 TO O-ISSUER-1                    16660
       ELSE IF UC-CON-IND = 2                           16670
      MOVE UC-ISSUER-2 TO O-ISSUER-2                    16680
      MOVE UC-ISSUE-1 TO O-ISSUE-1                      16690
       ELSE IF UC-CON-IND = 3                           16700
      MOVE UC-ISSUE-2 TO O-ISSUE-2                      16710
       ELSE IF UC-CON-IND = 4                           16720
      MOVE UC-TICK     TO O-X-TIC                       16730
      MOVE UC-SIC      TO O-SIC                         16740
      MOVE UC-ISS-TYPE TO O-ISS-TYPE                    16750
      MOVE UC-TRD-TYPE TO O-TRD-TYPE                    16760
      MOVE UC-ISS-ST   TO O-ISS-ST                      16770
       ELSE IF UC-CON-IND = 5                           16780
      MOVE UC-EXP-DT   TO O-EXP-DT                      16790
      MOVE UC-ADJ-FACT TO O-ADJ-FACT                    16800
      MOVE O-ISS-TYPE TO TEST-ISS-TYPE                      16810
      IF TEST-IS-STOCK                          16820
         MOVE UC-BOND-FORM TO O-SNP-RATE                    16830
      ELSE                                  16840
         MOVE UC-BOND-FORM TO O-BOND-FORM                   16850
       ELSE                                 16860
      MOVE +13 TO M  PERFORM WRITE-MESS                     16870
      MOVE 2   TO BAD-NEWS                          16880
      PERFORM SHOW-QSIP.                                      16890
   STAT-CON-EXIT.           EXIT.                                       16900
      *                                     16910
      *********************************************************             16920
      *                                     16930
   STAT-CHNG SECTION.                                         16940
   STAT-CHNG-PARA.                                        16950
       MOVE O-ISS-TYPE TO TEST-ISS-TYPE.                              16960
       ADD 1 TO SCNG-CNT.                                     16970
       IF U-ISS-ST NOT EQUAL TO 'G'                         16980
      MOVE U-ISS-ST TO O-ISS-ST.                                  16990
       IF U-HAS-CONT                                17000
      MOVE +0 TO STAT-CON-CNT.                                    17010
       IF U-ISS-ST EQUAL TO 'A' OR 'D' OR 'S' OR                    17020
                'T' OR 'X' OR 'Y'                   17030
      MOVE 0 TO O-HIGH, O-LOW, O-CLOSE, O-VOL                   17040
      MOVE TODAYS-DT-FT TO O-PRICE-DT                       17050
      IF TEST-IS-OPTION AND O-P-ADJ-IND EQUAL TO '1'                17060
         MOVE '0' TO O-HIGH-ADJ                         17070
         MOVE '0' TO O-LOW-ADJ                          17080
         MOVE '0' TO O-CLOSE-ADJ                        17090
      ELSE                                  17100
         NEXT SENTENCE                          17110
       ELSE                                 17120
      NEXT SENTENCE.                                      17130
       IF U-HAS-XREF                                17140
      MOVE U-XREF-ISSUER TO O-XREFQSIP                      17150
       ELSE IF U-HAS-UCUS                           17160
      MOVE U-XREF-QSIP TO O-OP-UCUS.                              17170
       IF U-ISS-ST   EQUAL TO '8' OR '9'                    17180
      MOVE U-EFCT-MM  TO WS-D-MM, O-MAT-MM                  17190
      MOVE U-EFCT-DD  TO WS-D-DD, O-MAT-DD                  17200
      MOVE U-EFCT-Y   TO WS-D-YY                        17210
      PERFORM TRANS-DT-FIX                          17220
      MOVE WS-D-YYYY TO O-MAT-YYYY.                               17230
       IF (U-ISS-ST EQUAL TO '5' OR 'C')                    17240
      MOVE 'T' TO C5-STAT-CHANGE.                                 17250
                                        17260
       IF TEST-IS-BOND AND U-ISS-ST = '5'                       17270
      * TEST IF BOND WAS CALLED OR MATURED AND SET CALL ENTRY CODE              17280
         MOVE O-MAT-YYYY TO YYYY-1                      17290
         MOVE O-MAT-MM TO MM-1                          17300
         MOVE O-MAT-DD TO DD-1                          17310
         IF CHK-DATE  NOT > SAVE-DATE                       17320
            MOVE '5' TO O-ENTRY-CODE.                                 17330
                                        17340
   STAT-CHNG-EXIT.           EXIT.                                      17350
      *                                     17360
      *********************************************************             17370
      ****      COMMON AND MISCELLANEOUS SUBROUTINES   ****             17380
      *********************************************************             17390
      *                                     17400
   PROC-TRANS    SECTION.                                     17410
   PROC-TRANS-PARA.                                       17420
                                        17430
       IF T-X-QSIP NOT = O-X-QSIP AND                       17440
      NOT (T-ISSUE-R = O-ISSUE-R AND T-NOT-PRICE)               17450
      * THIS CUSIP WAS NOT ON THE INPUT 216 FILE, SO MAKE A                 17460
      * SKELETON RECORD                             17470
      MOVE T-X-QSIP TO O-X-QSIP                         17480
      PERFORM NEW-RECRD                             17490
      ADD +1 TO NSC-CNT.                                      17500
      *                                     17510
      *  PROCESSES THE VARIOUS KINDS OF TRANSMISSION RECORDS                17520
      *                                     17530
       IF T-FUTURE-PRICE                            17540
      PERFORM FUTURE-REC-PROC                       17550
      IF NOT-TRADED                             17560
         NEXT SENTENCE                          17570
      ELSE                                  17580
         PERFORM NEW-TRDNDT                         17590
       ELSE IF T-DIV                                17600
      ADD 1 TO DR-CNT                           17610
      IF T-ISSUE-R NOT EQUAL TO D-ISSUE-R (1)                   17620
         MOVE SPACES TO DIV-REC (2)                     17630
         MOVE TRANS-REC TO DIV-REC (1)                      17640
         IF R-ISS-TYPE EQUAL TO '0'                     17650
            IF T-ISSUE-R NOT EQUAL TO                       17660
             COM-OPT-ISSUE-R (1)                    17670
           MOVE SPACES TO COM-OPT-DIV-REC (2)               17680
           MOVE TRANS-REC TO COM-OPT-DIV-REC (1)                17690
            ELSE                                17700
           MOVE TRANS-REC TO COM-OPT-DIV-REC (2)                17710
         ELSE                               17720
            NEXT SENTENCE                           17730
      ELSE                                  17740
         MOVE TRANS-REC TO DIV-REC (2)                      17750
         IF R-ISS-TYPE EQUAL TO '0'                     17760
            IF T-ISSUE-R NOT EQUAL TO                       17770
            COM-OPT-ISSUE-R (1)                     17780
           MOVE SPACES TO COM-OPT-DIV-REC (2)               17790
           MOVE TRANS-REC TO COM-OPT-DIV-REC (1)                17800
            ELSE                                17810
           MOVE TRANS-REC TO COM-OPT-DIV-REC (2)                17820
         ELSE                               17830
            NEXT SENTENCE                           17840
       ELSE IF T-STOCK-PRICE OR T-BOND-PRICE OR T-OPTION-PRICE              17850
      PERFORM PRICE-REC-PROC                        17860
      IF NOT-TRADED                             17870
         NEXT SENTENCE                          17880
      ELSE                                  17890
         PERFORM NEW-TRDNDT                         17900
       ELSE IF T-OPTION-BA                          17910
      ADD 1 TO BA-CNT                           17920
      PERFORM BA-REC-PROC                           17930
      IF NOT-TRADED                             17940
         NEXT SENTENCE                          17950
      ELSE                                  17960
         PERFORM NEW-TRDNDT                         17970
       ELSE IF T-FUTURE-OI                          17980
      ADD 1 TO OI-CNT                           17990
      PERFORM FUT-OI-PROC                           18000
       ELSE IF T-RBI                                18010
      IF T-ISSUE-R EQUAL TO O-ISSUE-R                       18020
         PERFORM REG-BOND-PROC                          18030
      ELSE                                  18040
         NEXT SENTENCE                          18050
       ELSE IF T-CALL                               18060
      ADD 1 TO CL-CNT                           18070
      IF T-ISSUE-R EQUAL TO O-ISSUE-R                       18080
         PERFORM CALL-BOND-PROC                         18090
      ELSE                                  18100
         NEXT SENTENCE                          18110
       ELSE                                 18120
      NEXT SENTENCE.                                      18130
       PERFORM TRANS-READ.                                    18140
      *                                     18150
      *******************************************************               18160
      ****     PROC-TRANS SUBROUTINES        ****               18170
      *******************************************************               18180
      *                                     18190
   TRANS-READ SECTION.                                        18200
   TRANS-READ-PARA.                                       18210
       IF ENDTRANS                              18220
      GO TO TR-EXIT                             18230
       ELSE                                 18240
      READ TRANS-FILE AT END                        18250
         MOVE 1 TO BAD-NEWS                         18260
         MOVE +21 TO M                          18270
         PERFORM WRITE-MESS                         18280
         PERFORM SHOW-QSIP                          18290
         MOVE 'T' TO W-ENDTRANS                         18300
         GO TO TR-EXIT.                                       18310
       IF T-ISSUER EQUAL TO '999999'                        18320
      MOVE 'T' TO W-ENDTRANS                        18330
       ELSE                                 18340
      MOVE TRANS-REC TO LT-REC                          18350
      ADD 1 TO W-TRANS-CNT                          18360
      IF T-STOCK-PRICE AND T-UNQ-CD = 'W'                   18370
         MOVE '1' TO T-UNQ-CD                       18380
      ELSE                                  18390
         NEXT SENTENCE.                                       18400
   TR-EXIT.           EXIT.                                         18410
      *                                     18420
      *********************************************************             18430
      *                                     18440
   NEW-TRDNDT SECTION.                                        18450
   NEW-TRDNDT-PARA.                                       18460
       IF O-TRD-TYPE EQUAL TO 'Z'                       18470
         GO TO NEW-TD-EXIT.                                   18480
       IF (O-TRD-TYPE EQUAL TO 'A')                         18490
      OR ((O-TRD-TYPE EQUAL TO '8')  AND                    18500
          NOT (O-X-CD EQUAL TO 'G' OR 'H' OR 'I' OR 'N' OR              18510
                   'O' OR 'P' OR 'S' OR 'U' OR              18520
                   'W' OR 'X' OR 'Y'))              18530
      *  IF HAVE MODEL PRICE, OR BID/ASK PRICING AND EXCH IS NOT            18540
      *  A BID/ASK EXCH, SET PRICING DATE, BUT DON'T RESET LAST             18550
      *  TRADE DATE                                 18560
      MOVE T-PRICING-DT TO O-PRICE-DT                       18570
       ELSE                                 18580
      * HAVE NEW TRADE DATA, SET PRICE DATE AND LAST TRADE DATE             18590
      MOVE T-PRICING-DT TO O-PRICE-DT                       18600
      MOVE HOLD-LAST-TRDNDT TO O-LAST-TDT.                            18610
   NEW-TD-EXIT.           EXIT.                                         18620
      *                                     18630
      *********************************************************             18640
      *                                     18650
   FUTURE-REC-PROC SECTION.                                       18660
   FUTURE-REC-PROC-PARA.                                      18670
       IF T-CLOSE EQUAL TO 0 AND T-LOW EQUAL TO 0                   18680
                  AND T-HIGH EQUAL TO 0                 18690
      ADD +1 TO BADPR-CNT                           18700
      GO TO FRP-EXIT                            18710
       ELSE                                 18720
      NEXT SENTENCE.                                      18730
       ADD 1 TO PR-CNT.                                       18740
       MOVE 'F' TO REC-NOT-TRADED.                                    18750
       MOVE T-TRD-TYPE TO O-TRD-TYPE.                                 18760
       MOVE T-VOL TO O-VOL.                                       18770
       IF (NEW-REC OR O-TRD-TYPE EQUAL TO  '8' OR '9')              18780
      NEXT SENTENCE                             18790
       ELSE IF O-FUT-DP4-CD EQUAL TO '4'                    18800
      MOVE O-CLOSE4 TO O-ADJ-PREV-CLOSE4                    18810
       ELSE                                 18820
      MOVE O-CLOSE TO O-ADJ-PREV-CLOSE.                               18830
       IF T-FUT-DIVISOR EQUAL TO '1'                        18840
      MOVE 10 TO DIV                            18850
       ELSE IF T-FUT-DIVISOR EQUAL TO '2' OR 'F'                    18860
      MOVE 100 TO DIV                           18870
       ELSE IF T-FUT-DIVISOR EQUAL TO '3'                       18880
      MOVE 1000 TO DIV                          18890
       ELSE IF T-FUT-DIVISOR EQUAL TO '4'                       18900
      MOVE 10000 TO DIV.                                      18910
       COMPUTE TEMP-PRCS =    (T-CLOSE / DIV).                            18920
       COMPUTE TEMP-HIGH =    ((T-CLOSE + T-HIGH) / DIV).                     18930
       COMPUTE TEMP-LOW  =    ((T-CLOSE - T-LOW ) / DIV).                     18940
       IF O-FUT-DP4-CD EQUAL TO '4'                         18950
      MOVE TEMP-PRCS TO O-CLOSE4                        18960
      MOVE TEMP-HIGH TO O-HIGH4                         18970
      MOVE TEMP-LOW TO O-LOW4                       18980
       ELSE                                 18990
      MOVE TEMP-PRCS TO O-CLOSE                         19000
      MOVE TEMP-HIGH TO O-HIGH                          19010
      MOVE TEMP-LOW  TO O-LOW.                                    19020
       IF (T-FUT-DIVISOR EQUAL TO 'F') AND                      19030
       (T-YLD-2-MAT GREATER 0 AND LESS 99)                  19040
      MOVE T-YLD-2-MAT TO O-YIELD-2-MAT.                              19050
       COMPUTE FUT-TEMP-PRICE =    (T-FUT-CASH-PRICE / DIV).                      19060
       MOVE FUT-TEMP-PRICE TO O-FUT-CASH-PRICE.                           19070
   FRP-EXIT.           EXIT.                                        19080
      *                                     19090
      *********************************************************             19100
      *                                     19110
   PRICE-REC-PROC SECTION.                                    19120
   PRICE-REC-PROC-PARA.                                       19130
      *                                     19140
      * ADJUSTED PREVIOUS CLOSE CASH EX-DISTRIBUTIONS ARE NOT               19150
      * REFLECTED IN ADJUSTED PREVIOUS CLOSE.                                 19160
      * FURTHER TESTING FOR CONDITIONS OF TRD -TYPE GOING FROM              19170
      * 0-9 OR 8-9 ALSO CHECK FUTURE-REC-PROC                       19180
      *                                     19190
       IF ((T-CLOSE EQUAL TO 0) AND (T-LOW EQUAL TO 0) AND              19200
             (T-HIGH EQUAL TO 0))                   19210
      MOVE T-TRD-TYPE TO O-TRD-TYPE                     19220
      MOVE 'T' TO NOT-OLD-TRD                       19230
      ADD +1 TO BADPR-CNT                           19240
       ELSE                                 19250
      MOVE 'F' TO REC-NOT-TRADED                        19260
      IF (NEW-REC AND T-TRD-TYPE EQUAL TO '1') OR               19270
             (T-TRD-TYPE EQUAL TO '9')                  19280
         PERFORM PRICE-CAL                          19290
         PERFORM TRD-APC                            19300
      ELSE                                  19310
         PERFORM TRD-APC                            19320
         PERFORM PRICE-CAL.                                   19330
       ADD 1 TO PR-CNT.                                       19340
   PRP-EXIT.           EXIT.                                        19350
      *                                     19360
      **********************************************************            19370
      *                                     19380
   TRD-APC SECTION.                                       19390
   TRD-APC-PARA.                                          19400
                                        19410
      * UPDATE THE TRADE TYPE FROM THE TRAN RECORD                  19420
       MOVE T-TRD-TYPE TO O-TRD-TYPE.                                 19430
                                        19440
      * IF THERE IS NO INPUT 216, SET APC TO 0'S                    19450
       IF HI-X-QSIP NOT = O-X-QSIP                          19460
      MOVE 0 TO O-ADJ-PREV-CLOSE                        19470
      MOVE 0 TO O-ADJ-PREV-CLOSE-ADJ                    19480
      GO TO TRD-APC-EXIT.                                     19490
                                        19500
      * UPDATE THE ADJUSTED PREVIOUS CLOSE, IF NECESSARY                19510
       IF NOT (O-X-CD EQUAL TO  'G' OR 'H' OR 'I' OR                19520
               'N' OR 'O' OR 'P' OR 'S' OR              19530
               'U' OR 'W' OR 'X' OR 'Y')                19540
      * IF NOT A BID/ASK EXCHANGE.          .          .                                  19550
      IF HI-TRD-TYPE NOT < '0' AND HI-TRD-TYPE < '8'                19560
      * AND IT DID TRADE YESTERDAY, THEN USE YESTERDAY'S CLOSE              19570
         MOVE HI-CLOSE TO O-ADJ-PREV-CLOSE                  19580
         MOVE HI-CLOSE-ADJ TO O-ADJ-PREV-CLOSE-ADJ              19590
      ELSE                                  19600
      * NO TRADE SO KEEP OLD ADJUSTED PREVIOUS CLOSE                    19610
         MOVE HI-ADJ-PREV-CLOSE TO O-ADJ-PREV-CLOSE                 19620
         MOVE HI-ADJ-PREV-CLOSE-ADJ TO O-ADJ-PREV-CLOSE-ADJ             19630
       ELSE                                 19640
      * IS A BID/ASK EXCHANGE                           19650
      IF HI-TRD-TYPE NOT < '0' AND HI-TRD-TYPE < '9'                19660
      * DID PRICE YESTERDAY                             19670
         IF HI-LOW NOT = 0                          19680
      * USE THE LOW (BID) IF WE HAVE IT                         19690
            MOVE HI-LOW TO O-ADJ-PREV-CLOSE                 19700
            MOVE HI-LOW-ADJ TO O-ADJ-PREV-CLOSE-ADJ                 19710
         ELSE                               19720
      * YESTERDAY'S BID NOT AVAILABLE, USE YESTERDAY'S ASK              19730
            MOVE HI-HIGH TO O-ADJ-PREV-CLOSE                    19740
            MOVE HI-HIGH-ADJ TO O-ADJ-PREV-CLOSE-ADJ                19750
      ELSE                                  19760
      * NO BID/ASK SO KEEP OLD ADJUSTED PREVIOUS CLOSE                  19770
         MOVE HI-ADJ-PREV-CLOSE TO O-ADJ-PREV-CLOSE                 19780
         MOVE HI-ADJ-PREV-CLOSE-ADJ TO O-ADJ-PREV-CLOSE-ADJ.                      19790
   TRD-APC-EXIT.           EXIT.                                        19800
      *                                     19810
      ***********************************************************           19820
      *                                     19830
   PRICE-CAL SECTION.                                         19840
   PRICE-CAL-PARA.                                        19850
      * CONVERT PRICES TO PROPER REPRESENTATION                     19860
                                        19870
      * CONVERT VOLUMES                             19880
      * BONDS REPORT VOLUME AS IS                           19890
      * IF OPTION OVERFLOW, ADD HIGH ORDER DIGIT, ELSE OPTIONS              19900
      * REPORT VOLUME AS IS                             19910
      * STOCKS ADD HIGH ORDER DIGIT AND MULTIPLY BY 100                 19920
       IF T-BOND-PRICE                              19930
      MOVE T-VOL TO O-VOL                           19940
       ELSE IF T-OPTION-PRICE                           19950
      IF T-OPT-OFLOW                            19960
         COMPUTE VOL-TEMP = (T-VOL-HO * 100000) + T-VOL             19970
         MOVE VOL-TEMP TO O-VOL                         19980
      ELSE                                  19990
         MOVE T-VOL TO O-VOL                        20000
       ELSE                                 20010
       COMPUTE VOL-TEMP = (T-VOL-HO * 100000) + T-VOL               20020
       COMPUTE VOL-TEMP = VOL-TEMP * 100                    20030
       MOVE VOL-TEMP TO O-VOL.                                    20040
                                        20050
      * MOVE PRICE DATA TO WORKING STORAGE, CONVERTING OFFSETS TO           20060
      * REAL PRICES                                 20070
       IF T-STOCK-PRICE OR (T-OPTION-PRICE AND T-OPT-OFLOW)             20080
      * ADD HIGH ORDER DIGITS FOR STOCKS OR OVERFLOWED OPTIONS              20090
      COMPUTE WS-CLOSE-INT = (T-CLOSE-HO * 100000) + T-CLOSE            20100
      COMPUTE WS-HIGH-INT =  WS-CLOSE-INT +                 20110
                 ((T-HIGH-HO * 10000) + T-HIGH)             20120
      COMPUTE WS-LOW-INT =   WS-CLOSE-INT -                 20130
                 ((T-LOW-HO * 10000) + T-LOW)           20140
       ELSE                                 20150
      MOVE T-CLOSE TO WS-CLOSE-INT                      20160
      COMPUTE WS-HIGH-INT =  WS-CLOSE-INT + T-HIGH              20170
      COMPUTE WS-LOW-INT =   WS-CLOSE-INT - T-LOW.                        20180
                                        20190
      * FIGURE SCALING FACTOR                           20200
       IF T-STOCK-PRICE OR T-BOND-PRICE                     20210
      * STOCKS AND BONDS USE SCALING INDICATOR                      20220
      IF IN-THOU                                20230
         MOVE 1000 TO DIV                           20240
      ELSE IF IN-HUND OR WITH-32NDS                     20250
         MOVE 100 TO DIV                            20260
      ELSE IF IN-8THS                           20270
         MOVE 8 TO DIV                          20280
      ELSE IF IN-16THS                          20290
         MOVE 16 TO DIV                             20300
      ELSE IF IN-32NDS                          20310
         MOVE 32 TO DIV                             20320
      ELSE IF IN-64THS                          20330
         MOVE 64 TO DIV                             20340
      ELSE                                  20350
         NEXT SENTENCE                          20360
       ELSE IF T-CURRENCY-OPT                           20370
      * CURRENCY OPTIONS ARE IN DOLLARS AND CENTS                   20380
      MOVE 100 TO DIV                           20390
       ELSE IF T-INTEREST-OPT OR T-DEBT-OPT                     20400
      * INTEREST RATE AND DEBT OPTIONS ARE IN 64THS                 20410
      MOVE 64 TO DIV                            20420
       ELSE                                 20430
      * ALL OTHER OPTIONS ARE IN 8THS                       20440
      MOVE 8 TO DIV.                                      20450
                                        20460
      * APPLY SCALING FACTORS                           20470
       COMPUTE TEMP-CLOSE ROUNDED = (WS-CLOSE-INT / DIV).                         20480
       COMPUTE TEMP-HIGH ROUNDED = (WS-HIGH-INT / DIV).                           20490
       COMPUTE TEMP-LOW ROUNDED = (WS-LOW-INT / DIV).                         20500
                                        20510
       IF T-X-CD = 'P' AND TNOTE-TBOND                      20520
      * TREASURY NOTES AND BONDS NEED LOW ORDER DIGITS ADDED,               20530
      * TO MAKE 32NDS IN DECIMAL REPRESENTATION                     20540
      COMPUTE WHOLE-32NDS ROUNDED = TEMP-CLOSE * 32                 20550
      COMPUTE FRAC-32NDS ROUNDED = WHOLE-32NDS / 32                 20560
      MOVE FRAC-32NDS TO TEMP-CLOSE                     20570
      COMPUTE WHOLE-32NDS ROUNDED = TEMP-HIGH * 32              20580
      COMPUTE FRAC-32NDS ROUNDED = WHOLE-32NDS / 32                 20590
      MOVE FRAC-32NDS TO TEMP-HIGH                      20600
      COMPUTE WHOLE-32NDS ROUNDED = TEMP-LOW * 32               20610
      COMPUTE FRAC-32NDS ROUNDED = WHOLE-32NDS / 32                 20620
      MOVE FRAC-32NDS TO TEMP-LOW                       20630
       ELSE                                 20640
      NEXT SENTENCE.                                      20650
                                        20660
       IF T-OPTION-PRICE                            20670
      * SET OPTION PRICE CODE AND RESCALE PRICES IF NECESSARY               20680
      IF PRICE-PER-SHARE                            20690
         IF T-EQUITY-OPT OR T-INDEX-OPT                     20700
            MOVE '0' TO O-DIV-LR-CD (1)                     20710
            COMPUTE TEMP-CLOSE ROUNDED = TEMP-CLOSE / 100           20720
            COMPUTE TEMP-HIGH ROUNDED = TEMP-HIGH / 100             20730
            COMPUTE TEMP-LOW ROUNDED = TEMP-LOW / 100               20740
         ELSE IF T-CURRENCY-OPT                         20750
            MOVE '0' TO O-DIV-LR-CD (1)                     20760
         ELSE IF T-INTEREST-OPT OR T-DEBT-OPT                   20770
            MOVE '1' TO O-DIV-LR-CD (1)                     20780
            IF O-TRD-UN-ST = '7'                        20790
           COMPUTE TEMP-CLOSE ROUNDED = TEMP-CLOSE /            20800
               (100 * O-TRD-ADJ)                    20810
           COMPUTE TEMP-HIGH ROUNDED = TEMP-HIGH /              20820
               (100 * O-TRD-ADJ)                    20830
           COMPUTE TEMP-LOW ROUNDED = TEMP-LOW /                20840
               (100 * O-TRD-ADJ)                    20850
            ELSE                                20860
           COMPUTE TEMP-CLOSE ROUNDED = TEMP-CLOSE /            20870
               (10 * O-TRD-ADJ)                 20880
           COMPUTE TEMP-HIGH ROUNDED = TEMP-HIGH /              20890
               (10 * O-TRD-ADJ)                 20900
           COMPUTE TEMP-LOW ROUNDED = TEMP-LOW /                20910
               (10 * O-TRD-ADJ)                 20920
         ELSE                               20930
            NEXT SENTENCE                           20940
      ELSE IF T-EQUITY-OPT OR T-INDEX-OPT                   20950
         MOVE '2' TO O-DIV-LR-CD (1)                    20960
      ELSE IF T-CURRENCY-OPT                        20970
         MOVE '0' TO O-DIV-LR-CD (1)                    20980
      ELSE IF T-INTEREST-OPT OR T-DEBT-OPT                  20990
         MOVE '3' TO O-DIV-LR-CD (1)                    21000
      ELSE                                  21010
         NEXT SENTENCE                          21020
       ELSE                                 21030
      NEXT SENTENCE.                                      21040
                                        21050
       MOVE TEMP-CLOSE   TO O-CLOSE.                                  21060
       MOVE TEMP-HIGH    TO O-HIGH.                                   21070
       MOVE TEMP-LOW     TO O-LOW.                                    21080
                                        21090
       IF T-BOND-PRICE                              21100
      * MOVE YIELD TO MATURITY FOR BONDS                        21110
      MOVE T-YLD-2-MAT TO O-YIELD-2-MAT                     21120
       ELSE IF T-OPTION-PRICE AND NOT T-OPT-OFLOW                   21130
      * OPTIONS NOT OVERFLOWED HAVE UNDERLYING PRICE IN 64THS               21140
      COMPUTE O-UND-STK-PRICE ROUNDED =                     21150
             T-UND-STK-PR / 64                      21160
       ELSE IF T-OPTION-PRICE                           21170
      * MOVE PRICE OVERFLOW FIELDS AND SET PRICE OVERFLOW FLAG              21180
      MOVE TEMP-HIGH-OFLOW TO O-HIGH-ADJ                    21190
      MOVE TEMP-LOW-OFLOW TO O-LOW-ADJ                      21200
      MOVE TEMP-CLOSE-OFLOW TO O-CLOSE-ADJ                  21210
      IF (TEMP-HIGH-OFLOW NOT = 0) OR                       21220
         (TEMP-LOW-OFLOW NOT = 0) OR                    21230
         (TEMP-CLOSE-OFLOW NOT = 0)                     21240
         MOVE 0 TO O-P-ADJ-IND                          21250
      ELSE                                  21260
         MOVE 1 TO O-P-ADJ-IND                          21270
       ELSE                                 21280
      NEXT SENTENCE.                                      21290
                                        21300
   PCS-EXIT.           EXIT.                                        21310
      *                                     21320
      *********************************************************             21330
      *                                     21340
   BA-REC-PROC SECTION.                                       21350
   BA-REC-PROC-PARA.                                          21360
      * PROCESS OPTION BID-ASK RECORDS                          21370
                                        21380
      * IF BID/ASK IS UPDATED, SET BID AND ASK                      21390
       IF BA-UPD-BA                             21400
      IF PRICE-PER-SHARE                            21410
         IF O-EQUITY-OPT OR O-INDEX-OPT                     21420
            COMPUTE TEMP-BID ROUNDED = BA-BID / 100                 21430
            COMPUTE TEMP-ASK ROUNDED = BA-ASK / 100                 21440
         ELSE IF O-INTEREST-OPT OR O-DEBT-OPT                   21450
            IF O-TRD-UN-ST = '7'                        21460
           COMPUTE TEMP-BID ROUNDED = BA-BID /              21470
               (100 * O-TRD-ADJ)                    21480
           COMPUTE TEMP-ASK ROUNDED = BA-ASK /              21490
               (100 * O-TRD-ADJ)                    21500
            ELSE                                21510
           COMPUTE TEMP-BID ROUNDED = BA-BID /              21520
               (10 * O-TRD-ADJ)                 21530
           COMPUTE TEMP-ASK ROUNDED = BA-ASK /              21540
               (10 * O-TRD-ADJ)                 21550
         ELSE                               21560
            NEXT SENTENCE                           21570
      ELSE                                  21580
         MOVE BA-BID TO TEMP-BID                        21590
         MOVE BA-ASK TO TEMP-ASK.                                 21600
       IF BA-UPD-BA                             21610
      MOVE TEMP-OP-ASK TO O-OP-ASK                      21620
      MOVE TEMP-OP-BID TO O-OP-BID                      21630
      MOVE TEMP-ASK-ADJ TO O-OP-ASK-ADJ                     21640
      MOVE TEMP-BID-ADJ TO O-OP-BID-ADJ                     21650
      MOVE BA-DT-Y      TO WS-D-YY                      21660
      MOVE BA-DT-MM     TO WS-D-MM                      21670
      MOVE BA-DT-DD     TO WS-D-DD                      21680
      PERFORM TRANS-DT-FIX                          21690
      MOVE WS-D-YY TO WS-YMD-YY                         21700
      MOVE WS-D-MM TO WS-YMD-MM                         21710
      MOVE WS-D-DD TO WS-YMD-DD                         21720
      MOVE WS-YMD-N TO O-OP-BA-DATE.                              21730
                                        21740
      * IF OPEN INTEREST IS UPDATE, SET OPEN INTEREST                   21750
       IF BA-UPD-OPEN-INT                           21760
      MOVE BA-OPEN-INT TO O-OPEN-INT                    21770
      IF O-TRD-TYPE = '9'                           21780
         MOVE 'I' TO O-TRD-TYPE.                                  21790
                                        21800
      * IF OPEN INTEREST HAS BEEN ADJUSTED, SET INDICATOR               21810
       IF BA-ADJ-OPEN-INT                           21820
      MOVE 1 TO O-OPEN-INT-ADJ-IND                      21830
       ELSE                                 21840
      MOVE 0 TO O-OPEN-INT-ADJ-IND.                               21850
   BA-REC-PROC-EXIT.           EXIT.                                    21860
      *                                     21870
      *********************************************************             21880
      *                                     21890
   CALL-BOND-PROC  SECTION.                                       21900
   CALL-BOND-PROC-PARA.                                       21910
      * UPDATE THE CALL BOND DATA FROM A CALL BOND RECORD               21920
       MOVE C-ENTRY-CODE      TO O-ENTRY-CODE.                            21930
       MOVE C-REV-CODE    TO O-REV-CODE.                              21940
       MOVE C-SAP-PG-NO   TO O-SAP-PG-NO.                             21950
       MOVE C-CALL-Y      TO WS-D-YY.                                 21960
       MOVE C-CALL-MM     TO WS-D-MM.                                 21970
       MOVE C-CALL-DD     TO WS-D-DD.                                 21980
       PERFORM TRANS-DT-FIX.                                      21990
       MOVE WS-DT-N     TO O-CALL-DATE.                               22000
       MOVE C-CALL-ISS-TYPE    TO O-CALL-ISS-TYPE.                        22010
       MOVE C-SF-CODE     TO O-SF-CODE.                               22020
       MOVE C-CALL-TYPE   TO O-CALL-TYPE.                             22030
       MOVE C-REDEMPTION      TO O-REDEMPTION.                            22040
       MOVE C-PREMIUM-CODE    TO O-PREMIUM-CODE.                              22050
       MOVE C-CALL-AMT    TO O-CALL-AMT.                              22060
       MOVE C-CALL-PRICE      TO O-CALL-PRICE.                            22070
                                        22080
   CALL-BOND-PROC-EXIT.           EXIT.                                     22090
      *                                     22100
      *********************************************************             22110
      *                                     22120
   FUT-OI-PROC SECTION.                                       22130
   FUT-OI-PROC-PARA.                                          22140
       MOVE BA-OPEN-INT TO O-FUT-OPEN-INTEREST.                           22150
   FUT-OI-REC-PROC-EXIT.           EXIT.                                    22160
      *                                     22170
      *                                     22180
      *********************************************************             22190
      *                                     22200
   REG-BOND-PROC SECTION.                                     22210
   REG-BOND-PROC-PARA.                                        22220
       MOVE '00000' TO REV-WORD.                                  22230
       ADD 1 TO RB-CNT.                                       22240
       IF  (R-PMT-MTD NOT EQUAL TO O-BD-PMT-MTD) OR                 22250
       (R-PMT-CD  NOT EQUAL TO O-BD-PMT-CD ) OR                 22260
       (R-TX-BS-CD NOT EQUAL TO O-BD-TX-BS-CD)                  22270
       MOVE '1' TO REV-IND (1).                                   22280
       IF  (R-INT-PMT  NOT EQUAL TO O-BD-INT-PMT)                   22290
       MOVE '1' TO REV-IND (2).                                   22300
       IF  (R-TRANS-CD NOT EQUAL TO O-BD-TRANS-CD)                  22310
       MOVE '1' TO REV-IND (3).                                   22320
       MOVE R-ECODE    TO O-BD-ECODE.                                 22330
       MOVE R-ISS-TYPE TO O-ISS-TYPE.                                 22340
       MOVE R-INT-PMT  TO O-BD-INT-PMT.                               22350
       MOVE R-PMT-FQ   TO O-BD-PMT-FQ.                                22360
       MOVE R-LR-CD    TO O-BD-LR-CD.                                 22370
       MOVE R-TRANS-CD TO O-BD-TRANS-CD.                              22380
       MOVE R-PMT-MTD  TO O-BD-PMT-MTD.                               22390
       MOVE R-PMT-CD   TO O-BD-PMT-CD.                                22400
       MOVE R-TX-BS-CD TO O-BD-TX-BS-CD.                              22410
       MOVE R-REC-MM TO WS-D-MM.                                  22420
       MOVE R-REC-DD TO WS-D-DD.                                  22430
       MOVE R-REC-Y  TO WS-D-YY.                                  22440
       PERFORM TRANS-DT-FIX.                                      22450
       IF  (WS-DT-N NOT EQUAL TO O-BD-REC-DT)                   22460
            MOVE '1' TO REV-IND (3).                              22470
       MOVE WS-DT-N TO O-BD-REC-DT.                                   22480
       MOVE R-PMT-MM TO WS-D-MM.                                  22490
       MOVE R-PMT-DD TO WS-D-DD.                                  22500
       MOVE R-PMT-Y  TO WS-D-YY.                                  22510
       PERFORM TRANS-DT-FIX.                                      22520
       IF  (WS-DT-N NOT EQUAL TO O-BD-PMT-DT)                   22530
            MOVE '1' TO REV-IND (4).                              22540
       MOVE WS-DT-N TO O-BD-PMT-DT.                                   22550
       IF R-ECODE EQUAL TO '3' PERFORM FIND-REV-CODE                22560
      ELSE      MOVE 'H' TO O-BD-RV-IND.                              22570
   RBP-EXIT.           EXIT.                                        22580
      *                                     22590
      *********************************************************             22600
      *                                     22610
   FIND-REV-CODE SECTION.                                     22620
   FIND-REV-CODE-PARA.                                        22630
       MOVE 1 TO J.                                       22640
   FRC-LOOP.                                          22650
       IF REV-WORD EQUAL TO RW-TABLE (J)                    22660
       MOVE REV-CODE-TABLE (J) TO O-BD-RV-IND                   22670
       GO TO FRC-EXIT                           22680
         ELSE                                   22690
       ADD 1 TO J.                                        22700
       IF J LESS 38 GO TO FRC-LOOP.                                   22710
   FRC-EXIT.           EXIT.                                        22720
      *                                     22730
      *********************************************************             22740
      *                                     22750
   CHK-COM-DIV SECTION.                                       22760
   CHK-COM-DIV-PARA.                                          22770
      *                                     22780
      *  CHECK COMMON STOCK DIVIDEND AREA FOR OPTION                    22790
      *  AND MOVE LATEST CASH DIVIDEND TO FIRST DIVIDEND AREA               22800
      *                                     22810
       IF (COM-OPT-ISSUER (P) = O-ISSUER) AND                   22820
      (COM-OPT-PMT-MTD (P) = '1' OR '2' OR '3' OR '4')              22830
      * THE CUSIP MATCHES AND THIS IS A CASH DIVIDEND                   22840
      IF COM-OPT-DIV-SECT-NUM (P) NOT EQUAL TO '1' AND '2'              22850
      * BAD DIV SECTION NUMBER, REPORT ERROR                    22860
          MOVE 2 TO BAD-NEWS                        22870
          MOVE +16 TO M   PERFORM WRITE-MESS                    22880
          PERFORM SHOW-QSIP                         22890
      ELSE                                  22900
      * CHECK THE EX-DIS DATE TO SEE IF ANY NEW CASH DIV IS LATER           22910
      * THAN ONE ALREADY IN BUCKET                          22920
         MOVE O-DIV-XDIS-DT (1) TO WS-DT-N                  22930
         MOVE WS-D-YY TO WS-XD-YY                       22940
         MOVE WS-D-MM TO WS-XD-MM                       22950
         MOVE WS-D-DD TO WS-XD-DD                       22960
         MOVE COM-OPT-XDIS-MM (P) TO WS-D-MM                    22970
         MOVE COM-OPT-XDIS-DD (P) TO WS-D-DD                    22980
         MOVE COM-OPT-XDIS-Y (P) TO WS-D-YY                 22990
         PERFORM TRANS-DT-FIX                       23000
         MOVE WS-D-YY TO WS-YMD-YY                      23010
         MOVE WS-D-MM TO WS-YMD-MM                      23020
         MOVE WS-D-DD TO WS-YMD-DD                      23030
         IF WS-YMD-N > WS-XD-N                          23040
            MOVE WS-DT-N TO O-DIV-XDIS-DT (1)                   23050
            MOVE COM-OPT-AMT-RATE (P) TO O-DIV-AMT (1)              23060
            MOVE COM-OPT-LR-CD (P) TO O-DIV-LR-CD (1)               23070
            MOVE COM-OPT-REV-IND (P) TO O-DIV-RV-IND (1)            23080
            MOVE COM-OPT-PMT-MTD (P)  TO O-DIV-PAY-MTD (1)              23090
            MOVE COM-OPT-PMT-ODR (P) TO O-DIV-PAY-ODR (1)           23100
            MOVE COM-OPT-TX-BS-CD (P) TO O-DIV-TX-BS (1)            23110
            MOVE COM-OPT-REC-MM (P) TO WS-D-MM                  23120
            MOVE COM-OPT-REC-DD (P) TO WS-D-DD                  23130
            MOVE COM-OPT-REC-Y (P) TO WS-D-YY                   23140
            PERFORM TRANS-DT-FIX                        23150
            MOVE WS-DT-N TO O-DIV-REC-DT (1)                    23160
            MOVE COM-OPT-PAY-MM (P) TO WS-D-MM                  23170
            MOVE COM-OPT-PAY-DD (P) TO WS-D-DD                  23180
            MOVE COM-OPT-PAY-Y (P) TO WS-D-YY                   23190
            PERFORM TRANS-DT-FIX                        23200
            MOVE WS-DT-N TO O-DIV-PAY-DT (1).                             23210
   CCD-EXIT.           EXIT.                                        23220
      *                                     23230
      *********************************************************             23240
      *                                     23250
   CHK-DIV-RECS SECTION.                                      23260
   CHK-DIV-RECS-PARA.                                         23270
       MOVE +1 TO P.                                          23280
   CD-LOOP.                                           23290
       IF P GREATER 2 OR D-ISSUE-R (P) EQUAL TO SPACES              23300
                    GO TO CD-EXIT.                        23310
       IF (D-ISSUE-R (P) EQUAL TO O-ISSUE-R)                    23320
       PERFORM DIV-REC-PROC                         23330
       ADD +1 TO P                              23340
       GO TO CD-LOOP.                                     23350
   CD-EXIT.           EXIT.                                         23360
      *                                     23370
      *********************************************************             23380
      *                                     23390
   DIV-REC-PROC SECTION.                                      23400
   DIV-REC-PROC-PARA.                                         23410
       IF D-DIV-SECT-NUM (P) NOT EQUAL TO '1' AND '2'               23420
       MOVE 2 TO BAD-NEWS                           23430
       MOVE +16 TO M   PERFORM WRITE-MESS                   23440
       PERFORM SHOW-QSIP                            23450
       GO TO DRP-EXIT.                                    23460
       MOVE D-DIV-SECT-NUM (P) TO I.                                  23470
       MOVE D-ECODE (P)     TO O-DIV-ECODE (I).                           23480
       MOVE D-ISS-TYPE (P) TO O-ISS-TYPE.                                 23490
       MOVE D-AMT-RATE (P) TO O-DIV-AMT (I).                              23500
       MOVE D-LR-CD (P)     TO O-DIV-LR-CD (I).                           23510
       MOVE D-REV-IND (P)   TO O-DIV-RV-IND (I).                              23520
       MOVE D-BRR-CD (P) TO O-DIV2-BRR-CD (2)                   23530
       MOVE D-TRANS-CD (P) TO O-DIV2-TRANS-CD (2).                            23540
       MOVE D-PMT-MTD (P)    TO O-DIV-PAY-MTD (I).                        23550
       MOVE D-PMT-ODR (P)   TO O-DIV-PAY-ODR (I).                             23560
       MOVE D-TX-BS-CD (P)  TO O-DIV-TX-BS (I).                           23570
       MOVE D-XDIS-MM (P)   TO WS-D-MM.                               23580
       MOVE D-XDIS-DD (P)   TO WS-D-DD.                               23590
       MOVE D-XDIS-Y (P)    TO WS-D-YY.                               23600
       PERFORM TRANS-DT-FIX.                                      23610
       MOVE WS-DT-N     TO O-DIV-XDIS-DT (I).                             23620
       MOVE D-REC-MM (P)    TO WS-D-MM.                               23630
       MOVE D-REC-DD (P)    TO WS-D-DD.                               23640
       MOVE D-REC-Y (P)     TO WS-D-YY.                               23650
       PERFORM TRANS-DT-FIX.                                      23660
       MOVE WS-DT-N     TO O-DIV-REC-DT (I).                              23670
       MOVE D-PAY-MM (P)    TO WS-D-MM.                               23680
       MOVE D-PAY-DD (P)    TO WS-D-DD.                               23690
       MOVE D-PAY-Y (P)     TO WS-D-YY.                               23700
       PERFORM TRANS-DT-FIX.                                      23710
       MOVE WS-DT-N     TO O-DIV-PAY-DT (I).                              23720
   DRP-EXIT.           EXIT.                                        23730
      *                                     23740
      *********************************************************             23750
      *                                     23760
   TRANS-DT-FIX   SECTION.                                    23770
   TRANS-DT-FIX-PARA.                                         23780
       IF WS-D-MM EQUAL TO  99    MOVE  9999  TO WS-D-YYYY              23790
                  ADD 90 TO WS-D-YY                 23800
                  GO TO TDF-EXIT.                         23810
       ADD 70 TO WS-D-YY.                                     23820
       MOVE 0 TO ITN-CNT.                                     23830
   ONEDIG-DT-ADJ.                                         23840
       IF ITN-CNT GREATER 6 MOVE +19 TO M PERFORM WRITE-MESS            23850
              PERFORM CLOSE-FILES                       23860
              STOP RUN.                                   23870
       COMPUTE WS-D-YYYY =    (WS-D-YY + 1900).                           23880
       IF WS-D-YYYY LESS 1970 ADD 100 TO WS-D-YYYY.                           23890
       COMPUTE WS-M-CNT =    (WS-D-YYYY * 12 + WS-D-MM).                      23900
       IF (TD-M-CNT - WS-M-CNT) LESS 12 NEXT SENTENCE               23910
       ELSE            ADD 10 TO WS-D-YY                    23920
               ADD 1  TO ITN-CNT                    23930
               GO TO ONEDIG-DT-ADJ.                           23940
   TDF-EXIT.           EXIT.                                        23950
      *                                     23960
      *********************************************************             23970
      *                                     23980
   END-OF-OUTPUT-NINES SECTION.                                   23990
   END-OF-OUTPUT-NINES-PARA.                                      24000
       DIVIDE BLK-SZ INTO W-OUTP-CNT GIVING FT-BLK REMAINDER PT-BLK         24010
       ON SIZE ERROR DISPLAY W-OUTP-CNT.                              24020
       SUBTRACT PT-BLK FROM BLK-SZ GIVING NO-9BLKS                  24030
        ON SIZE ERROR DISPLAY NO-9BLKS.                               24040
       PERFORM W-NINES-OUT NO-9BLKS TIMES.                                24050
      *                                     24060
      *********************************************************             24070
      *                                     24080
   W-NINES-OUT SECTION.                                       24090
   W-NINES-OUT-PARA.                                          24100
       WRITE OUTP216-REC FROM W-NINES.                                24110
      *                                     24120
      *********************************************************             24130
      *                                     24140
   OUTREC-INIT SECTION.                                       24150
   OUTREC-INIT-PARA.                                          24160
      *  SETS PREVIOUS TRADE DATE,                          24170
      *  INITIALIZES DIVIDEND OR BOND ENTRY CODES.                            24180
      *                                     24190
       IF O-TRD-TYPE NOT < '0' AND O-TRD-TYPE < '8' OR              24200
      ((O-TRD-TYPE EQUAL TO '8')  AND                       24210
          (O-X-CD EQUAL TO 'G' OR 'H' OR 'I' OR 'N' OR              24220
                   'O' OR 'P' OR 'S' OR 'U' OR              24230
                   'W' OR 'X' OR 'Y'))              24240
      * IF THE PREVIOUS PRICE WAS NOT A MODEL PRICE OR BID ASK QUOTE,           24250
      * OR IT WAS A BID ASK QUOTE FROM A BID/ASK TYPE EXCHANGE,             24260
      * THEN SAVE THE PRICE DATE FOR LATER USE AS THE                   24270
      * PREVIOUS TRADE DATE                             24280
      MOVE O-PRICE-DT TO FIX-FST                        24290
      IF TD-MM EQUAL TO 1 AND T-PR-MM EQUAL TO 12               24300
         COMPUTE D-YY =    TD-YY - 1                    24310
         MOVE FIX-DT   TO HOLD-LAST-TRDNDT                  24320
      ELSE                                  24330
         MOVE TD-YY TO D-YY                         24340
         MOVE FIX-DT TO HOLD-LAST-TRDNDT                    24350
       ELSE                                 24360
      * PREVIOUS PRICING DATA WAS NOT TRADE, SO KEEP OLD LAST TRADE DATE        24370
      MOVE O-LAST-TDT TO HOLD-LAST-TRDNDT.                            24380
                                        24390
       IF (O-X-CD EQUAL TO 'G') GO TO OI-EXIT.                            24400
       IF (O-X-CD LESS 'L') OR (O-X-CD EQUAL TO 'U' OR 'V' OR 'R')          24410
         IF O-DIV-ECODE (1) NOT EQUAL TO '0'                24420
              MOVE '2' TO O-DIV-ECODE (1)                   24430
              IF O-DIV-ECODE (2) NOT EQUAL TO '0'               24440
               MOVE '2' TO O-DIV-ECODE (2)              24450
               GO TO OI-EXIT                    24460
               ELSE GO TO OI-EXIT                       24470
        ELSE IF O-DIV-ECODE (2) NOT EQUAL TO '0'                24480
              MOVE '2' TO O-DIV-ECODE (2)                   24490
               GO TO OI-EXIT                    24500
            ELSE GO TO OI-EXIT                      24510
       ELSE NEXT SENTENCE.                                    24520
       IF O-X-CD EQUAL TO 'Q' GO TO OI-EXIT.                              24530
       IF O-BD-ECODE NOT EQUAL TO '4' AND '9' MOVE 2 TO O-BD-ECODE.                   24540
   OI-EXIT.           EXIT.                                         24550
      *                                     24560
      *********************************************************             24570
      *                                     24580
   SHOW-QSIP SECTION.                                         24590
   SHOW-QSIP-PARA.                                        24600
       MOVE SPACES TO PRINT-REC.                                  24610
       MOVE ERR-LINE TO PRINT-MESS.                                   24620
       WRITE PRINT-REC AFTER ADVANCING 2 LINES.                           24630
       MOVE O-X-QSIP TO ERR-O-QSIP.                                   24640
       MOVE U-X-QSIP TO ERR-U-QSIP.                                   24650
       MOVE T-X-QSIP TO ERR-T-QSIP.                                   24660
       MOVE D-ISSUE-R (P) TO ERR-D-QSIP.                              24670
       MOVE ERR-LINE-1 TO PRINT-MESS.                                 24680
       WRITE PRINT-REC AFTER ADVANCING 1 LINES.                           24690
       MOVE SPACES TO PRINT-REC.                                  24700
       WRITE PRINT-REC AFTER ADVANCING 2 LINES.                           24710
   S-Q-EXIT.           EXIT.                                        24720
      *                                     24730
      *********************************************************             24740
      *                                     24750
   WRITE-MESS SECTION.                                        24760
   WRITE-MESS-PARA.                                       24770
       MOVE MESS (M) TO MESG.                                     24780
       WRITE PRINT-REC FROM MESS-REC AFTER ADVANCING 1 LINES.                     24790
      *                                     24800
      *********************************************************             24810
      *                                     24820
   WRITE-SUMMARY SECTION.                                     24830
   WRITE-SUMMARY-PARA.                                        24840
       MOVE SPACES TO PRINT-REC.                                  24850
       MOVE HEAD-1 TO PRINT-LINE.                                 24860
       WRITE PRINT-REC AFTER ADVANCING NEXT-PAGE.                             24870
       MOVE DASHES TO PRINT-LINE.                                 24880
       WRITE PRINT-REC AFTER ADVANCING 1 LINES.                           24890
       MOVE SPACES TO PRINT-LINE.                                 24900
       MOVE HDR-1 TO PRINT-MESS.                                  24910
       WRITE PRINT-REC AFTER ADVANCING 7 LINES.                           24920
       MOVE HDR-REC TO PRINT-MESS.                                    24930
       WRITE PRINT-REC AFTER ADVANCING 2 LINES.                           24940
       MOVE LAST-T-REC TO PRINT-MESS.                                 24950
       WRITE PRINT-REC AFTER ADVANCING 2 LINES.                           24960
       MOVE LAST-U-REC TO PRINT-MESS.                                 24970
       WRITE PRINT-REC AFTER ADVANCING 2 LINES.                           24980
       MOVE LAST-O-REC TO PRINT-MESS.                                 24990
       WRITE PRINT-REC AFTER ADVANCING 2 LINES.                           25000
       MOVE LINE-2 TO PRINT-LINE.                                 25010
       WRITE PRINT-REC AFTER ADVANCING 5 LINES.                           25020
       MOVE W-OLDTP-CNT TO TOT-OLD.                                   25030
       MOVE W-UPD-CNT   TO TOT-UPD.                                   25040
       MOVE W-TRANS-CNT TO TOT-TRANS.                                 25050
       MOVE W-OUTP-CNT  TO TOT-OUT.                                   25060
       MOVE TOT-LINE TO PRINT-LINE.                                   25070
       WRITE PRINT-REC AFTER ADVANCING 2 LINES.                           25080
       MOVE SPACES TO PRINT-LINE.                                 25090
       MOVE LINE-3 TO PRINT-LINE.                                 25100
       WRITE PRINT-REC AFTER ADVANCING 5 LINES.                           25110
       MOVE 'ADDITIONS      ' TO PT-TYPE.                                 25120
       MOVE SC-CNT TO OUT-PT.                                     25130
       PERFORM PT-PRINT.                                      25140
       MOVE 'CAP CHANGES    ' TO PT-TYPE.                                 25150
       MOVE CR-CNT   TO OUT-PT.                                   25160
       PERFORM PT-PRINT.                                      25170
       MOVE 'STATUS CHANGES ' TO PT-TYPE.                                 25180
       MOVE SCNG-CNT TO OUT-PT.                                   25190
       PERFORM PT-PRINT.                                      25200
       MOVE 'STAT CONTINUES ' TO PT-TYPE.                                 25210
       MOVE CONT-CNT TO OUT-PT.                                   25220
       PERFORM PT-PRINT.                                      25230
       MOVE SUB-HEAD TO PRINT-MESS.                                   25240
       WRITE PRINT-REC AFTER ADVANCING 4 LINES.                           25250
       MOVE 'ADDS-NO DESC' TO PT-TYPE.                                25260
       MOVE NSC-CNT TO OUT-PT.                                    25270
       PERFORM PT-PRINT.                                      25280
       MOVE 'PRICES     ' TO PT-TYPE.                                 25290
       MOVE PR-CNT TO OUT-PT.                                     25300
       PERFORM PT-PRINT.                                      25310
       MOVE 'OPTION BID/ASKS' TO PT-TYPE.                                 25320
       MOVE BA-CNT TO OUT-PT.                                     25330
       PERFORM PT-PRINT.                                      25340
       MOVE 'FUTURES OPENINT' TO PT-TYPE.                                 25350
       MOVE OI-CNT TO OUT-PT.                                     25360
       PERFORM PT-PRINT.                                      25370
       MOVE 'REG BONDS      ' TO PT-TYPE.                                 25380
       MOVE RB-CNT TO OUT-PT.                                     25390
       PERFORM PT-PRINT.                                      25400
       MOVE 'DIVIDENDS      '  TO PT-TYPE.                                25410
       MOVE DR-CNT TO OUT-PT.                                     25420
       PERFORM PT-PRINT.                                      25430
       MOVE 'BOND CALLS    '  TO PT-TYPE.                                 25440
       MOVE CL-CNT TO OUT-PT.                                     25450
       PERFORM PT-PRINT.                                      25460
       MOVE 'ZERO PRICE DATA'  TO PT-TYPE.                                25470
       MOVE BADPR-CNT TO OUT-PT.                                  25480
       PERFORM PT-PRINT.                                      25490
       MOVE SPACES TO PRINT-REC.                                  25500
       MOVE SUB-HEAD-1 TO PRINT-MESS.                                 25510
       WRITE PRINT-REC AFTER ADVANCING 4 LINES.                           25520
       MOVE 'PURGES     '  TO PT-TYPE.                                25530
       MOVE P-CNT TO OUT-PT.                                      25540
       PERFORM PT-PRINT.                                      25550
       MOVE SPACES TO PRINT-REC.                                  25560
       MOVE SUB-HEAD-2 TO PRINT-MESS.                                 25570
       WRITE PRINT-REC AFTER ADVANCING 4 LINES.                           25580
       MOVE PART-TOT-1 TO PRINT-LINE.                                 25590
       WRITE PRINT-REC AFTER ADVANCING 1 LINES.                           25600
       MOVE 'WITHOUT DESCRP ' TO PT-TYPE.                                 25610
       MOVE NO-DESCRIP-CNT TO OUT-PT.                                 25620
       PERFORM PT-PRINT.                                      25630
      *                                     25640
      *********************************************************             25650
      *                                     25660
   PT-PRINT SECTION.                                          25670
   PT-PRINT-PARA.                                         25680
       MOVE PART-TOT TO PRINT-MESS.                                   25690
       WRITE PRINT-REC AFTER ADVANCING 1 LINES.                           25700
      *********************************************************             25710
      ******************* END OF PROGRAM **********************             25720
      *********************************************************             25730
 o HI