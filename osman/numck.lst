    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1
    NUMCK.CBL    18-APR-77  20:21

    0001    IDENTIFICATION DIVISION.
    0002    PROGRAM-ID.                    PD.
    0003    AUTHOR.                IDSI.
    0004    REMARKS.               TRANSMISSION SOFTWARE: VERSION 07.          00
    0005            RELEASE DATE 09-01-88
    0006            IBM ANS COBOL.
    0007    ENVIRONMENT DIVISION.
    0008    CONFIGURATION SECTION.
    0009    SOURCE-COMPUTER. DECsystem-10. 
    0010    OBJECT-COMPUTER.             DECSYSTEM-10.
    0011  *  LINES 13 AND 15 MAYBE NEEDED FOR ASCII  MACHINES
    0012  *            PROGRAM COLLATING SEQUENCE IS EBCDIC.
    0013    SPECIAL-NAMES.
    0014       ALPHABET EBCDIC IS EBCDIC.
	       ^

***				FATAL - IMPROPER CLAUSE

    0015       C01 IS NEXT-PAGE.
    0016    INPUT-OUTPUT SECTION.
    0017    FILE-CONTROL.
    0018  * 
    0019  * **********************************************************
    0020  * 
    0021       SELECT PRINT-FILE    ASSIGN TO PRTR.
    0022       SELECT UPDATE-FILE   ASSIGN TO UPDFL.
    0023       SELECT TRANS-FILE    ASSIGN TO TRANSFL.
    0024       SELECT  OLDTP70-FILE ASSIGN TO OLD216.
    0025       SELECT OUTTP70-FILE  ASSIGN TO NEW216.
    0026    DATA DIVISION.
    0027    FILE SECTION.
    0028    FD  OLDTP70-FILE
	        ^

***				FATAL - THIS FILE NOT SELECTED
***				FATAL - VALUE OF ID REQUIRED

    0029       RECORD CONTAINS 216 CHARACTERS
    0030       BLOCK CONTAINS 5 RECORDS
    0031       LABEL RECORDS ARE STANDARD.
    0032    01  INTP-REC.
    0033       05  I-X-QSIP.
    0034         10  I-ISSUER            PIC X(6).
    0035         10  I-ISSUE             PIC X(2).
    0036         10  I-UNQ-CD            PIC X.
    0037         10  I-X-CD              PIC X.
    0038       05  I-ISR-QSIP REDEFINES I-X-QSIP.
    0039         10  I-ISSUE-R     PIC X(8).
    0040         10  FILLER        PIC X(2).
    0041       05  I-X-TIC.
    0042         10  I-PRIM-TIC          PIC X(4).
    0043         10  I-GRP-ID            PIC X.
    0044         10  I-CLASS-ID          PIC X.
    0045       05  I-SIC             PIC X(4).
    0046       05  I-ISSUER-DESCRIP          PIC X(28).
    0047       05  I-ISSUE-DESCRIP.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-1
    NUMCK.CBL    18-APR-77  20:21

    0048         10  FILLER              PIC X(13).
    0049         10  I-FUT-DP4-CD            PIC X.
    0050         10  FILLER              PIC X(6).
    0051       05  I-PRICE-SECT.
    0052         10  I-PRICE-DT          PIC 9(4).
    0053         10  I-VOL               PIC 9(7).
    0054         10  I-HIGH              PIC 9(4)V9(3).
    0055         10  I-HIGH4 REDEFINES I-HIGH    PIC 9(3)V9(4).
    0056         10  I-LOW               PIC 9(4)V9(3).
    0057         10  I-LOW4 REDEFINES I-LOW      PIC 9(3)V9(4).
    0058         10  I-CLOSE             PIC 9(4)V9(3).
    0059         10  I-CLOSE4 REDEFINES I-CLOSE      PIC 9(3)V9(4).
    0060         10  I-ADJ-PREV-CLOSE        PIC 9(4)V9(3).
    0061         10  I-ADJ-PREV-CLOSE4 REDEFINES
    0062         I-ADJ-PREV-CLOSE        PIC 9(3)V9(4).
    0063       05  I-IND-SECT.
    0064         10  I-ISS-TYPE          PIC X.
    0065         10  I-TRD-TYPE          PIC X.
    0066         10  I-ISS-ST            PIC X.
    0067         10  I-XPRICE-ST         PIC X.
    0068         10  I-SUPP-TYPE REDEFINES I-XPRICE-ST PIC X.
    0069         10  I-SNP-RATE REDEFINES I-SUPP-TYPE PIC X.
    0070         10  I-MAT-DT            PIC 9(8).
    0071         10  I-EXP-DT   REDEFINES I-MAT-DT   PIC 9(8).
    0072         10  I-COUP-RATE         PIC 9(2)V9(4).
    0073         10  I-ADJ-FACT REDEFINES I-COUP-RATE PIC 9(2)V9(4).
    0074         10  I-TRD-ADJ   REDEFINES I-ADJ-FACT PIC 9(3)V9(3).
    0075         10  I-MRG-IND           PIC X.
    0076         10  I-BOND-FORM REDEFINES I-MRG-IND PIC X.
    0077         10  I-TRD-UN-ST   REDEFINES I-MRG-IND PIC X.
    0078         10  I-LAST-TDT          PIC 9(6).
    0079         10  I-XREFQSIP REDEFINES I-LAST-TDT   PIC X(6).
    0080       05  I-EARN-IAD-SECT.
    0081         10  I-END12-DT          PIC 9(2).
    0082         10  I-ERN-PER-SHR           PIC 9(2)V9(3).
    0083         10  I-NEG-IND           PIC X.
    0084         10  I-SHRS-OUT          PIC 9(7).
    0085         10  I-IAD-FOOT          PIC 9.
    0086         10  I-IAD               PIC 9(1)V9(3).
    0087       05  I-BOND-QUAL-SECT REDEFINES I-EARN-IAD-SECT.
    0088         10  FILLER              PIC X(6).
    0089         10  I-SNP               PIC X.
    0090         10  I-MOODY-RATE            PIC X.
    0091         10  I-AMT-OUT           PIC X(7).
    0092         10  I-YIELD-2-MAT           PIC 9(2)V9(3).
    0093       05  I-UND-STK-SECT REDEFINES I-EARN-IAD-SECT.
    0094         10  I-UND-STK-PRICE         PIC 9(4)V9(3).
    0095         10  FILLER              PIC X.
    0096         10  I-OPEN-INT          PIC X(7).
    0097         10  I-OVER-10K-ADJ.
    0098       15  I-P-ADJ-IND           PIC 9.
    0099       15  I-HIGH-ADJ            PIC 9.
    0100       15  I-LOW-ADJ         PIC 9.
    0101       15  I-CLOSE-ADJ           PIC 9.
    0102       15  I-ADJ-PREV-CLOSE-ADJ      PIC 9.
    0103       05  I-DIVIDEND-AREAS.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-2
    NUMCK.CBL    18-APR-77  20:21

    0104         10  I-DIVSECT-1-2 OCCURS 2 TIMES.
    0105       15  I-DIV-AMT         PIC 9(2)V9(4).
    0106       15  I-DIV-EXDIS-DT        PIC 9(6).
    0107       15  I-DIV-REC-DT          PIC 9(6).
    0108       15  I-DIV-PAY-DT          PIC 9(6).
    0109       15  I-DIV-PAY-MTD         PIC X.
    0110       15  I-DIV-PAY-ODR         PIC X.
    0111       15  I-DIV-TX-BS           PIC X.
    0112       15  I-DIV-LR-CD           PIC X.
    0113       15  I-DIV-FQ-CD           PIC X.
    0114       15  I-DIV2-BRR-CD REDEFINES
    0115           I-DIV-FQ-CD           PIC X.
	           ^

***				FATAL - AN ENTRY CONTAINING, OR SUBORDINATE TO AN ENTRY
***				CONTAINING, AN 'OCCURS' CLAUSE MAY NOT BE REDEFINED

    0116       15  I-DIV2-TRANS-CD       PIC X.
    0117       15  I-DIV-RV-IND          PIC X.
    0118       15  I-DIV-ECODE           PIC X.
    0119    FD  OUTTP70-FILE
	        ^

***				FATAL - THIS FILE NOT SELECTED

    0120       RECORD CONTAINS 216 CHARACTERS
    0121       BLOCK CONTAINS 5 RECORDS
    0122       LABEL RECORDS ARE STANDARD.
    0123    01  OUTP216-REC     PIC X(216).
    0124    FD  UPDATE-FILE
	        ^

***				FATAL - THIS FILE NOT SELECTED

    0125       RECORD CONTAINS 40 CHARACTERS
    0126       BLOCK CONTAINS 2 RECORDS
    0127       LABEL RECORDS ARE STANDARD.
    0128    01  UPD-CONT-REC.
    0129       05  FILLER            PIC X(22).
    0130       05  UC-CON-IND            PIC 9.
    0131       05  FILLER            PIC X.
    0132       05  UC-1.
    0133         10  UC-ISSUER-1         PIC X(16).
    0134       05  UC-2 REDEFINES UC-1.
    0135         10  UC-ISSUER-2         PIC X(12).
    0136         10  UC-ISSUE-1          PIC X(4).
    0137       05  UC-3 REDEFINES UC-1.
    0138         10  UC-ISSUE-2          PIC X(16).
    0139       05  UC-4 REDEFINES UC-1.
    0140         10  UC-TICK             PIC X(6).
    0141         10  FILLER              PIC XX.
    0142         10  UC-SIC              PIC X(4).
    0143         10  UC-ISS-TYPE         PIC X.
    0144         10  UC-TRD-TYPE         PIC X.
    0145         10  UC-ISS-ST           PIC X.
    0146         10  FILLER              PIC X.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-3
    NUMCK.CBL    18-APR-77  20:21

    0147       05  UC-5 REDEFINES UC-1.
    0148         10  UC-EXP-DT           PIC X(8).
    0149         10  UC-ADJ-FACT         PIC 9(2)V9(4).
    0150         10  UC-BOND-FORM            PIC X.
    0151         10  FILLER              PIC X.
    0152    01  UPD-REC.
    0153       05  U-X-QSIP.
    0154         10  U-ISSUER            PIC X(6).
    0155         10  U-ISSUE             PIC X(2).
    0156         10  U-UNQ-CD            PIC X.
    0157         10  U-X-CD              PIC X.
    0158       05  U-ISR-QSIP REDEFINES U-X-QSIP.
    0159         10  U-ISSUE-R     PIC X(8).
    0160         10  FILLER        PIC X(2).
    0161       05  U-REC-TYPE            PIC X.
    0162       88  U-IS-BULL VALUES 'D', 'E', 'F'.
    0163       88  U-HAS-CONT VALUE 'E'.
    0164       88  U-IS-CAP VALUE 'F'.
    0165       05  U-RPT-DT.
    0166         10  U-RPT-Y             PIC 9.
    0167         10  U-RPT-MM            PIC 9(2).
    0168         10  U-RPT-DD            PIC 9(2).
    0169       05  U-EFCT-DT.
    0170         10  U-EFCT-Y            PIC 9.
    0171         10  U-EFCT-MM           PIC 9(2).
    0172         10  U-EFCT-DD           PIC 9(2).
    0173       05  STAT-CHNG-INFO.
    0174         10  U-ISS-ST            PIC X.
    0175         10  FILLER              PIC X.
    0176         10  U-XREF-QSIP.
    0177       15  U-XREF-ISSUER         PIC X(6).
    0178       15  U-XREF-ISSUE          PIC X(2).
    0179         10  U-XREF-UNQ-CD         PIC X.
    0180         10  U-XREF-X-CD           PIC X.
    0181         10  U-XREF-FLAG           PIC 9.
    0182           88  U-HAS-XREF VALUE 1.
    0183           88  U-HAS-UCUS VALUE 2.
    0184         10  U-REF-PR            PIC 9(5).
    0185         10  U-MG-PR REDEFINES U-REF-PR      PIC 9(3)V9(2).
    0186         10  U-ISS-TYPE          PIC X.
    0187       05  CAP-CHNG-INFO REDEFINES STAT-CHNG-INFO.
    0188         10  C-CAP-IND           PIC X.
    0189         10  C-CAP-SECT          PIC 9.
    0190         10  C-IAD-SECT.
    0191  *  CAP CHANGE 6
    0192       15  C-IAD             PIC 9(2)V9(3).
    0193       15  C-IAD-FOOT            PIC X.
    0194       15  C-BOND-SUPP-TYPE REDEFINES C-IAD-FOOT
    0195                       PIC X.
    0196       15  C-EPS             PIC 99V999.
    0197       15  C-EPS-IND         PIC X.
    0198       15  C-12M-END-Y           PIC 9.
    0199       15  C-12M-END-DT          PIC 99.
    0200       15  FILLER            PIC X.
    0201       15  C-ISS-TYPE            PIC X.
    0202         10  C-RECAP-SECT REDEFINES C-IAD-SECT.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-4
    NUMCK.CBL    18-APR-77  20:21

    0203  *  CAP CHANGE 7
    0204       15  C-ADJ-FAC         PIC 9(2)V9(4).
    0205       15  C-SHRS-OUT            PIC 9(8).
    0206       15  FILLER            PIC XXX.
    0207         10  C-TRD-REV-SECT   REDEFINES C-IAD-SECT.
    0208  *  CAP CHANGE 9
    0209       15  C-MARG-IND            PIC X.
    0210       15  C-TRD-UNT-ST REDEFINES
    0211           C-MARG-IND            PIC X.
    0212       15  C-BOND-FORM REDEFINES
    0213           C-MARG-IND            PIC X.
    0214       15  C-X-PR-ST         PIC X.
    0215       15  C-TRANS-CD            PIC X.
    0216       15  C-OPT-IND         PIC X.
    0217       15  C-TRD-UNT-ADJ         PIC 9(3)V9(3).
    0218       15  FILLER            PIC X(4).
    0219       15  C-MOODY-FIN-QL        PIC X.
    0220       15  C-SNP-BD-RATE         PIC X.
    0221       15  FILLER            PIC X.
    0222    FD  TRANS-FILE
	        ^

***				FATAL - THIS FILE NOT SELECTED

    0223       RECORD CONTAINS 40 CHARACTERS
    0224       BLOCK CONTAINS 2 RECORDS
    0225       LABEL RECORDS ARE STANDARD.
    0226    01  TRANS-REC.
    0227       05  T-ISSUE-R             PIC X(8).
    0228       05  FILLER            PIC X(32).
    0229    01  TRANS-LABEL.
    0230       05  DUMMY             PIC X(5).
    0231       05  T-SCALE-FLAG          PIC X(1).
    0232       05  T-LABEL               PIC X(4).
    0233       05  T-EXT-ISTYP-FLAG          PIC X(1).
    0234       05  FILLER            PIC X(23).
    0235       05  T-LABEL-DT            PIC 9(6).
    0236    01  T-PRICE-REC.
    0237       05  T-X-QSIP.
    0238         10  T-ISSUER            PIC X(6).
    0239         88  TNOTE-TBOND VALUES '912810', '912827'.
    0240         10  T-ISSUE             PIC X(2).
    0241         10  T-UNQ-CD            PIC X.
    0242         10  T-X-CD              PIC X.
    0243       05  T-FUT-QSIP REDEFINES T-X-QSIP.
    0244         10  T-FUT-NINE          PIC X(3).
    0245         10  T-FUT-NUM           PIC X(3).
    0246         10  T-EX-MT-CD          PIC X.
    0247         10  T-EX-YR-CD          PIC X.
    0248         10  T-FUT-X-CD          PIC X.
    0249         10  T-TEL-FUT-CD            PIC X.
    0250       05  T-REC-TYPE            PIC X.
    0251       88  T-STOCK-PRICE VALUE 'K'.
    0252       88  T-BOND-PRICE VALUE 'L'.
    0253       88  T-OPTION-PRICE VALUE 'M'.
    0254       88  T-OPTION-BA VALUE 'N'.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-5
    NUMCK.CBL    18-APR-77  20:21

    0255       88  T-FUTURE-PRICE VALUE 'O'.
    0256       88  T-DIV VALUE 'P'.
    0257       88  T-RBI VALUE 'R'.
    0258       88  T-MTG VALUE 'S'.
    0259       88  T-CALL VALUE 'T'.
    0260       88  T-FUTURE-OI VALUE 'U'.
    0261       88  T-NOT-PRICE VALUE 'P', 'R', 'S', 'T'.
    0262       05  T-TRD-TYPE            PIC X.
    0263       05  T-PRICING-DT.
    0264         10  T-PR-MM             PIC 9(2).
    0265         10  T-PR-DD             PIC 9(2).
    0266       05  T-VOL             PIC 9(5).
    0267       05  T-PRICES.
    0268         10  T-CLOSE             PIC 9(5).
    0269         10  T-HIGH              PIC 9(4).
    0270         10  T-LOW               PIC 9(4).
    0271       05  T-PRC-REP-CODE            PIC X.
    0272       88  IN-THOU VALUE '0'.
    0273       88  IN-HUND VALUE '1'.
    0274       88  WITH-32NDS VALUE '2'.
    0275       88  IN-8THS VALUE '3'.
    0276       88  IN-16THS VALUE '4'.
    0277       88  IN-32NDS VALUE '5'.
    0278       88  IN-64THS VALUE '6'.
    0279       88  T-EQUITY-OPT VALUE '1'.
    0280       88  T-INDEX-OPT VALUE '2'.
    0281       88  T-CURRENCY-OPT VALUE '3'.
    0282       88  T-INTEREST-OPT VALUE '4'.
    0283       88  T-DEBT-OPT VALUE '5'.
    0284       88  T-FUTURE-OPT VALUE '6'.
    0285       05  T-FUT-DIVISOR REDEFINES T-PRC-REP-CODE PIC X.
    0286       05  T-YLD-2-MAT           PIC 9(2)V9(3).
    0287       05  T-FUT-CASH-PRICE REDEFINES T-YLD-2-MAT PIC 9(5).
    0288       05  T-OFLOW REDEFINES T-YLD-2-MAT.
    0289         10  T-OPT-PRC-CODE          PIC X.
    0290         88  T-OPT-OFLOW VALUES 'A'.
    0291         10  T-VOL-HO            PIC 9.
    0292         10  T-CLOSE-HO          PIC 9.
    0293         10  T-HIGH-HO           PIC 9.
    0294         10  T-LOW-HO            PIC 9.
    0295       05  T-UPRC REDEFINES T-YLD-2-MAT.
    0296         10  T-UND-STK-PR            PIC 9(5).
    0297  
    0298    01  REG-BOND-REC.
    0299       05  R-QSIP.
    0300         10  R-ISSUER            PIC X(6).
    0301         10  R-ISSUE             PIC X(2).
    0302         10  R-ECODE             PIC X.
    0303         10  FILLER              PIC X.
    0304       05  R-CHK-DG              PIC 9.
    0305       05  R-ISS-TYPE            PIC X.
    0306       05  R-INT-PMT             PIC 9(3)V9(3).
    0307       05  FILLER            PIC X(5).
    0308       05  R-REC-DT.
    0309         10  R-REC-Y             PIC 9.
    0310         10  R-REC-MM            PIC 9(2).    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-6
    NUMCK.CBL    18-APR-77  20:21

    0311         10  R-REC-DD            PIC 9(2).
    0312       05  R-PMT-DT.
    0313         10  R-PMT-Y             PIC 9.
    0314         10  R-PMT-MM            PIC 9(2).
    0315         10  R-PMT-DD            PIC 9(2).
    0316       05  R-PMT-FQ              PIC X.
    0317       05  R-BOND-IND            PIC X.
    0318       05  R-LR-CD               PIC X.
    0319       05  R-TRANS-CD            PIC X.
    0320       05  R-PMT-MTD             PIC X.
    0321       05  R-PMT-CD              PIC X.
    0322       05  R-TX-BS-CD            PIC X.
    0323    01  BID-ASK-REC.
    0324       05  FILLER            PIC X(11).
    0325       05  BA-DATE.
    0326       10  BA-DT-Y           PIC 9.
    0327       10  BA-DT-MM          PIC 99.
    0328       10  BA-DT-DD          PIC 99.
    0329       05  BA-IND            PIC 9.
    0330       88  BA-UPD-OPEN-INT VALUES  0, 1, 3, 4.
    0331       88  BA-UPD-BA VALUES 2, 3, 4.
    0332       88  BA-ADJ-OPEN-INT VALUES 1, 4.
    0333       05  BA-ASK            PIC 9(5)V9(3).
    0334       05  BA-BID            PIC 9(5)V9(3).
    0335       05  BA-OPEN-INT           PIC 9(7).
    0336    01  CALL-REC.
    0337       05  FILLER            PIC X(8).
    0338       05  C-ENTRY-CODE          PIC X.
    0339       05  C-REV-CODE            PIC X.
    0340       05  FILLER            PIC X.
    0341       05  C-SAP-PG-NO           PIC X(5).
    0342       05  C-CALL-Y              PIC 9.
    0343       05  C-CALL-MM             PIC 99.
    0344       05  C-CALL-DD             PIC 99.
    0345       05  C-CALL-ISS-TYPE           PIC X.
    0346       05  C-SF-CODE             PIC X.
    0347       05  C-CALL-TYPE           PIC X.
    0348       05  C-REDEMPTION          PIC X.
    0349       05  C-PREMIUM-CODE            PIC X.
    0350       05  C-CALL-AMT            PIC 9(7).
    0351       05  C-CALL-PRICE          PIC 9(4)V9(3).
    0352    FD  PRINT-FILE
	        ^

***				FATAL - THIS FILE NOT SELECTED

    0353       RECORD CONTAINS 132 CHARACTERS
    0354       LABEL RECORDS ARE STANDARD.
    0355    01  PRINT-REC.
    0356       05  P-MESS.
    0357         10  PRINT-MESS    PIC X(60).
    0358         10  FILLER        PIC X(72).
    0359       05  PRINT-LINE REDEFINES P-MESS PIC X(132).
    0360  * 
    0361  * **********************************************************
     *     P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-7
    NUMCK.CBL    18-APR-77  20:21

    0363    WORKING-STORAGE SECTION.
    0364  * 
    0365    01  TEMP-STRG.
    0366       05  W-IAD-FOOT      PIC X.
    0367       05  W-IAD       PIC 9(2)V9(3).
    0368       05  WS-10-ADJ-PRC        PIC 9(5)V9(3).
    0369       05  WS-OVER-10-K REDEFINES WS-10-ADJ-PRC.
    0370       10  WS-10-ADJ-FACT    PIC 9.
    0371       10  WS-10-ADJ-SEC     PIC 9(4)V9(3).
    0372       05  WHOLE-32NDS       PIC 9(10).
    0373       05  FRAC-32NDS        PIC 9(5)V9(3).
    0374       05  WS-TODAYS-DT.
    0375       10  WS-TD-YY          PIC 99.
    0376       10  WS-TD-MD          PIC 9(4).
    0377       05  XDIS-DT-TEMP.
    0378       10  XDIS-DT-YY        PIC 99.
    0379       10  XDIS-DT-MD        PIC 9(4).
    0380       05  WS-DT.
    0381       10  WS-D-MM     PIC 99.
    0382       10  WS-D-DD     PIC 99.
    0383       10  WS-D-YY     PIC 99.
    0384       05  WS-DT-N REDEFINES WS-DT PIC 9(6).
    0385       05  WS-YMD.
    0386       10  WS-YMD-YY     PIC 99.
    0387       10  WS-YMD-MM     PIC 99.
    0388       10  WS-YMD-DD     PIC 99.
    0389       05  WS-YMD-N REDEFINES WS-YMD PIC 9(6).
    0390       05  WS-XD.
    0391       10  WS-XD-YY     PIC 99.
    0392       10  WS-XD-MM     PIC 99.
    0393       10  WS-XD-DD     PIC 99.
    0394       05  WS-XD-N REDEFINES WS-XD PIC 9(6).
    0395       05  WS-D-YYYY       PIC 9(4).
    0396       05  WS-M-CNT        PIC 9(4)   COMP.
    0397       05  ITN-CNT         PIC 9(4)   COMP.
    0398       05  TODAYS-DT.
    0399       10  TD-MM       PIC 99.
    0400       10  TD-DD       PIC 99.
    0401       10  TD-YY       PIC 99.
    0402       05  TODAYS-DT-N REDEFINES TODAYS-DT.
    0403       10  TODAYS-DT-FT    PIC 9(4).
    0404       10  FILLER      PIC 9(2).
    0405       05  SAVE-DATE.
    0406       10  S-YYYY-1    PIC 9(4).
    0407       10  S-DT-FT     PIC 9(4).
    0408       05  CHK-DATE.
    0409       10  YYYY-1      PIC 9(4).
    0410       10  MM-1        PIC 99.
    0411       10  DD-1        PIC 99.
    0412       05  XDIV-DT1.
    0413       10  XDIV-DT-FT1     PIC 9(4).
    0414       10  XDIV-DT-YY1     PIC 99.
    0415       05  TD-YYYY         PIC 9(4)   COMP.
    0416       05  TD-M-CNT        PIC 9(4)   COMP.
    0417       05  FIX-DT.
    0418       10  D-MM        PIC 99.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-8
    NUMCK.CBL    18-APR-77  20:21

    0419       10  D-DD        PIC 99.
    0420       10  D-YY        PIC 99.
    0421       05  FIX-DT-N REDEFINES FIX-DT      PIC 9(6).
    0422       05 FIX-FTH REDEFINES FIX-DT-N.
    0423      10  FIX-FST      PIC 9(4).
    0424      10  FILLER       PIC 9(2).
    0425       05  DIV         PIC 9(5)      COMP.
    0426       05  WS-CLOSE-INT    PIC 9(6).
    0427       05  WS-HIGH-INT     PIC 9(6).
    0428       05  WS-LOW-INT      PIC 9(6).
    0429       05  TEMP-PRCS       PIC 9(4)V9(5).
    0430       05  TEMP-HIGH       PIC 9(5)V9(5).
    0431       05  TEMP-HIGH-R REDEFINES TEMP-HIGH.
    0432       10  TEMP-HIGH-OFLOW PIC 9.
    0433       10  FILLER      PIC 9(9).
    0434       05  TEMP-LOW        PIC 9(5)V9(5).
    0435       05  TEMP-LOW-R REDEFINES TEMP-LOW.
    0436       10  TEMP-LOW-OFLOW  PIC 9.
    0437       10  FILLER      PIC 9(9).
    0438       05  TEMP-CLOSE      PIC 9(5)V9(5).
    0439       05  TEMP-CLOSE-R REDEFINES TEMP-CLOSE.
    0440       10  TEMP-CLOSE-OFLOW PIC 9.
    0441       10  FILLER      PIC 9(9).
    0442       05  TEMP-BID        PIC 9(5)V9(3).
    0443       05  TEMP-BID-R REDEFINES TEMP-BID.
    0444       10  TEMP-BID-ADJ    PIC 9.
    0445       10  TEMP-OP-BID     PIC 9(4)V9(3).
    0446       05  TEMP-ASK        PIC 9(5)V9(3).
    0447       05  TEMP-ASK-R REDEFINES TEMP-ASK.
    0448       10  TEMP-ASK-ADJ    PIC 9.
    0449       10  TEMP-OP-ASK     PIC 9(4)V9(3).
    0450       05  FUT-TEMP-PRICE      PIC 9(5)V9(3).
    0451       05  HI-X-QSIP       PIC X(10).
    0452       05  HI-TRD-TYPE     PIC X.
    0453       05  HI-HIGH         PIC 9(4)V9(3).
    0454       05  HI-LOW      PIC 9(4)V9(3).
    0455       05  HI-CLOSE        PIC 9(4)V9(3).
    0456       05  HI-ADJ-PREV-CLOSE   PIC 9(4)V9(3).
    0457       05  HI-HIGH-ADJ     PIC 9.
    0458       05  HI-LOW-ADJ      PIC 9.
    0459       05  HI-CLOSE-ADJ    PIC 9.
    0460       05  HI-ADJ-PREV-CLOSE-ADJ      PIC 9.
    0461       05  HOLD-IAD-CUSIP      PIC X(8) VALUE 'XXXXXXXX'.
    0462       05  HOLD-IAD        PIC 99V999.
    0463       05  HOLD-LAST-TRDNDT    PIC 9(6).
    0464       05  VOL-TEMP        PIC 9(7).
    0465       05  TEMP-DT         PIC 9(4).
    0466    01  TEST-ISS-TYPE       PIC X.
    0467       88  TEST-IS-STOCK VALUES '0', '1', '2', '4', '7', '8',
    0468                '9', 'A', 'E', 'F', 'G', 'Q'.
    0469       88  TEST-IS-BOND VALUES '3', '5', '6', 'H', 'I', 'J', 'K',
    0470               'L', 'M', 'N', 'O', 'P', 'R', 'S',
    0471               'T', 'U', 'V', 'W', 'X', 'Y', 'Z'.
    0472       88  TEST-IS-OPTION VALUES 'B', 'D'.
    0473       88  TEST-IS-EQUITY-OPTION VALUE 'B'.
    0474       88  TEST-IS-FUTURE VALUE 'C'.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-9
    NUMCK.CBL    18-APR-77  20:21

    0475  * 
    0476  * 
    0477    01  FLAGS.
    0478       05  NOT-OLD-TRD     PIC X VALUE  'F'.
    0479       88  NEW-TRD-TYPE      VALUE  'T'.
    0480       05  REC-NOT-TRADED      PIC X VALUE  'F'.
    0481       88  NOT-TRADED        VALUE  'T'.
    0482       05  ADD-A-REC       PIC X VALUE 'F'.
    0483       88  NEW-REC       VALUE 'T'.
    0484       05  BAD-NEWS        PIC 9 VALUE 0.
    0485       88  FATAL-ERROR       VALUE 1.
    0486       05  CAP-7       PIC X VALUE 'F'.
    0487       88  CAP-7-REC         VALUE 'T'.
    0488       05  OPT-SCALE-FLAG        PIC X VALUE 'F'.
    0489       88  PRICE-PER-SHARE VALUE 'T'.
    0490       05  ISS-TYPE-FLAG   PIC X VALUE 'F'.
    0491       88  NON-EXTENDED VALUE 'T'.
    0492       05  C5-STAT-CHANGE      PIC X VALUE 'F'.
    0493       88  C5-CHANGE       VALUE 'T'.
    0494       05  ENDFILES.
    0495       10  W-ENDUPD    PIC X VALUE 'F'.
    0496           88  ENDUPD        VALUE 'T'.
    0497       10  W-ENDTRANS      PIC X VALUE 'F'.
    0498           88  ENDTRANS      VALUE 'T'.
    0499       10  W-ENDOLDTP      PIC X VALUE 'F'.
    0500           88  ENDOLDTP        VALUE 'T'.
    0501       05  ENDFILES-2 REDEFINES ENDFILES.
    0502       10  W-ENDALL    PIC XXX.
    0503           88  ENDALL        VALUE 'TTT'.
    0504  * 
    0505  * 
    0506    01  CNTRS.
    0507       05  W-OLDTP-CNT     PIC 9(6) VALUE 0 COMP.
    0508       05  W-OUTP-CNT      PIC 9(6) VALUE 0 COMP.
    0509       05  W-TRANS-CNT     PIC 9(6) VALUE 0 COMP.
    0510       05  W-UPD-CNT       PIC 9(6) VALUE 0 COMP.
    0511       05  CR-CNT      PIC 9(6) VALUE 0 COMP.
    0512       05  NO-DESCRIP-CNT      PIC 9(6)  VALUE 0 COMP.
    0513       05  SC-CNT      PIC 9(6) VALUE 0 COMP.
    0514       05  NSC-CNT         PIC 9(6) VALUE 0 COMP.
    0515       05  SCNG-CNT        PIC 9(6) VALUE 0 COMP.
    0516       05  CONT-CNT        PIC 9(6) VALUE 0 COMP.
    0517       05  PR-CNT      PIC 9(6) VALUE 0 COMP.
    0518       05  BA-CNT      PIC 9(6) VALUE 0 COMP.
    0519       05  OI-CNT      PIC 9(6) VALUE 0 COMP.
    0520       05  RB-CNT      PIC 9(6) VALUE 0 COMP.
    0521       05  DR-CNT      PIC 9(6) VALUE 0 COMP.
    0522       05  CL-CNT      PIC 9(6) VALUE 0 COMP.
    0523       05  STAT-CON-CNT    PIC 9(2) VALUE 0  COMP.
    0524       05  PT-BLK      PIC 9(6) VALUE 0 COMP.
    0525       05  NO-9BLKS        PIC 9     VALUE 0 COMP.
    0526       05  BLK-SZ      PIC 9     VALUE 5 COMP.
    0527       05  FT-BLK      PIC 9(6)  VALUE 0 COMP.
    0528       05  P-CNT       PIC 9(6) VALUE 0 COMP.
    0529       05  BADPR-CNT       PIC 9(6) VALUE 0 COMP.
    0530       05  I           PIC 9(4)      COMP.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-10
    NUMCK.CBL    18-APR-77  20:21

    0531       05  J           PIC 9(4)      COMP.
    0532       05  P           PIC 9    VALUE 1  COMP.
    0533       05  M           PIC 9(2)      COMP.
    0534  * 
    0535    01  MESSAGES.
    0536       05 FILLER PIC X(30) VALUE '40 TO 216 CONVERT  VERSION 7.          0'.
	          ^

***				NON-NUMERIC LITERAL IN VALUE CLAUSE TRUNCATED TO SIZE OF ITEM

    0537       05 FILLER PIC X(30) VALUE 'NORMAL END-OF-JOB         '.
    0538       05 FILLER PIC X(30) VALUE 'ALL I/O FILES OPENED      '.
    0539       05 FILLER PIC X(30) VALUE 'EOF BEFORE HEADER RECORD READ '.
    0540       05 FILLER PIC X(30) VALUE 'NO HEADER RECORD ON TRANS FILE'.
    0541        05 FILLER PIC X(30) VALUE 'NO DATE RECORD ON TRANS FILE  '.
    0542        05 FILLER PIC X(30) VALUE 'TRANS EOF BEFORE SEPARATOR REC'.
    0543        05 FILLER PIC X(30) VALUE 'RECS SEPARATED, (BULT, PR/DIV)'.
    0544        05 FILLER PIC X(30) VALUE 'ERROR IN PRIMING READS    '.
    0545        05 FILLER PIC X(30) VALUE 'INPUT BUFFERS FILLED      '.
    0546        05 FILLER PIC X(30) VALUE 'ALL FILES CLOSED      '.
    0547        05 FILLER PIC X(30) VALUE 'MAIN PROCESSING STARTED   '.
    0548        05 FILLER PIC X(30) VALUE 'CONTINUATION RECORD EXPECTED  '.
    0549        05 FILLER PIC X(30) VALUE 'CAPIT.           SECTION NUMBER ERROR   '.
	           ^

***				NON-NUMERIC LITERAL IN VALUE CLAUSE TRUNCATED TO SIZE OF ITEM

    0550        05 FILLER PIC X(30) VALUE 'EXTRA STATUS CONTIN.           RECORDS  '.
	           ^

***				NON-NUMERIC LITERAL IN VALUE CLAUSE TRUNCATED TO SIZE OF ITEM

    0551        05 FILLER PIC X(30) VALUE 'DIV.           SECTION NUMBER INVALID   '.
	           ^

***				NON-NUMERIC LITERAL IN VALUE CLAUSE TRUNCATED TO SIZE OF ITEM

    0552        05 FILLER PIC X(30) VALUE 'UNCODE 216-PNTR OUT OF BOUNDS '.
    0553        05 FILLER PIC X(30) VALUE 'NEW DATA 216 PNTR OUT OF BNDS '.
    0554        05 FILLER PIC X(30) VALUE 'JOB STOPPED=> CANT ADJUST DATE'.
    0555        05 FILLER PIC X(30) VALUE 'UPD FILE EOF-TRAILER MISSING  '.
    0556        05 FILLER PIC X(30) VALUE 'TRAN FILE EOF-TRAILER MISSING '.
    0557        05 FILLER PIC X(30) VALUE 'OLDTP FILE EOF-TRAILER MISSING'.
    0558        05 FILLER PIC X(30) VALUE 'TRANS-FILE LABEL READ     '.
    0559        05 FILLER PIC X(30) VALUE 'DATE COMPUTED FROM TRANS.           REC '.
	           ^

***				NON-NUMERIC LITERAL IN VALUE CLAUSE TRUNCATED TO SIZE OF ITEM

    0560        05 FILLER PIC X(30) VALUE 'PROBLEMS >100: JOB TERMINATED.          '.
	           ^

***				NON-NUMERIC LITERAL IN VALUE CLAUSE TRUNCATED TO SIZE OF ITEM

    0561        05 FILLER PIC X(30) VALUE 'BOND CURRENT YIELD ZERO FOR:  '.
    0562        05 FILLER PIC X(30) VALUE 'STATUS CONTIN.           OUT OF ORDER   '.
	           ^    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-11
    NUMCK.CBL    18-APR-77  20:21


***				NON-NUMERIC LITERAL IN VALUE CLAUSE TRUNCATED TO SIZE OF ITEM

    0563  * 
    0564    01  MESSAGE-TABLE REDEFINES MESSAGES.
    0565       05 MESS         OCCURS  26 PIC X(30).
    0566  * 
    0567  * 
    0568    01  MESS-REC.
    0569       05  FILLER      PIC X VALUE SPACES.
    0570       05  FILLER      PIC X(9) VALUE '****     '.
    0571       05  MESG        PIC X(30).
    0572       05  FILLER      PIC X(4) VALUE '****'.
    0573       05  FILLER      PIC X(89) VALUE SPACES.
    0574  * 
    0575    01  HEAD-1.
    0576       05  FILLER      PIC X(27) VALUE SPACES.
    0577       05  FILLER      PIC X(7) VALUE '------ '.
    0578       05  FILLER      PIC X(45) VALUE
    0579       '40 TO 216 CONVERT SOFTWARE PROCESSING SUMMARY'.
    0580       05  FILLER      PIC X(7) VALUE ' ------'.
    0581       05  FILLER      PIC X(46) VALUE SPACES.
    0582  * 
    0583    01  HDR-1.
    0584       05  FILLER      PIC X(15) VALUE 'DATE FROM HDR :'.
    0585       05  HDR-DT      PIC 9(6) VALUE ZERO.
    0586       05  FILLER      PIC X(39) VALUE SPACES.
    0587    01  HDR-REC.
    0588       05  FILLER      PIC X(15) VALUE 'HEADER RECORD :'.
    0589       05  HDR         PIC X(40) VALUE SPACES.
    0590       05  FILLER      PIC X(5) VALUE SPACES.
    0591    01  LAST-T-REC.
    0592       05  FILLER      PIC X(15) VALUE 'LAST PR/DV REC:'.
    0593       05  LT-REC      PIC X(40) VALUE SPACES.
    0594       05  FILLER      PIC X(5) VALUE SPACES.
    0595    01  LAST-U-REC.
    0596       05  FILLER      PIC X(15) VALUE 'LAST BULT.           REC:'.
	           ^

***				NON-NUMERIC LITERAL IN VALUE CLAUSE TRUNCATED TO SIZE OF ITEM

    0597       05  LT-U-REC        PIC X(40) VALUE SPACES.
    0598       05  FILLER      PIC X(5) VALUE SPACES.
    0599    01  LAST-O-REC.
    0600       05  FILLER      PIC X(15) VALUE 'LAST NEW  216 :'.
    0601       05  OUT-QSIP-SAVE   PIC X(10).
    0602       05  OUT-TIC-SAVE    PIC X(06).
    0603       05  OUT-SIC-SAVE    PIC X(04).
    0604       05  OUT-DESC-SAVE   PIC X(20).
    0605    01  LINE-2.
    0606       05  FILLER      PIC X VALUE ' '.
    0607       05  FILLER      PIC X(15) JUST RIGHT VALUE
    0608       'TOTAL RECORDS '.
    0609       05  FILLER      PIC X(30) JUST RIGHT VALUE
    0610       '        OLDTP70 UPDATE'.
    0611       05  FILLER      PIC X(20) JUST RIGHT VALUE    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-12
    NUMCK.CBL    18-APR-77  20:21

    0612       '  TRANS   OUTTP70   '.
    0613    01  TOT-LINE.
    0614       05  FILLER      PIC XX VALUE ' '.
    0615       05  FILLER      PIC X(25) VALUE
    0616                  'LESS SEPARATOR/HEADER REC'.
    0617       05  FILLER      PIC X(5) VALUE SPACES.
    0618       05  TOT-OLD         PIC Z(4)99BB.
    0619       05  TOT-UPD         PIC Z(4)99B.
    0620       05  TOT-TRANS       PIC Z(4)99BBBB.
    0621       05  TOT-OUT         PIC Z(4)99BBBB.
    0622    01  LINE-3.
    0623       05  FILLER      PIC X VALUE ' '.
    0624       05  FILLER      PIC X(26) JUST RIGHT VALUE
    0625       ' PROCESSING TOTALS: UPD'.
    0626       05  FILLER      PIC X(33) VALUE SPACES.
    0627    01  PART-TOT.
    0628       05  FILLER      PIC X VALUE ' '.
    0629       05  FILLER      PIC X(26) VALUE SPACES.
    0630       05  PT-TYPE         PIC X(15).
    0631       05  OUT-PT      PIC Z(4)99.
    0632       05  FILLER      PIC X(12) VALUE SPACES.
    0633    01  PART-TOT-1.
    0634       05  FILLER      PIC X VALUE ' '.
    0635       05  FILLER      PIC X(26) VALUE SPACES.
    0636       05  PT-TYPE-1       PIC X(15) VALUE
    0637                  'RECORDS TO DATE'.
    0638       05  FILLER      PIC X(18) VALUE SPACES.
    0639    01  SUB-HEAD.
    0640       05  FILLER      PIC X VALUE ' '.
    0641       05  FILLER      PIC X(26) JUST RIGHT VALUE 'TRANS'.
    0642       05  FILLER      PIC X(33) VALUE SPACES.
    0643    01  SUB-HEAD-1.
    0644       05  FILLER      PIC X VALUE ' '.
    0645       05  FILLER      PIC X(26) JUST RIGHT VALUE
    0646                     '     OLDTP70'.
    0647       05  FILLER      PIC X(33) VALUE SPACES.
    0648    01  SUB-HEAD-2.
    0649       05  FILLER      PIC X VALUE ' '.
    0650       05  FILLER      PIC X(26) JUST RIGHT VALUE
    0651                     '     OUTTP70'.
    0652       05  FILLER      PIC X(33) VALUE SPACES.
    0653  * 
    0654    01  ERR-LINE.
    0655       05  FILLER      PIC X VALUE ' '.
    0656       05  FILLER      PIC X(30) JUST RIGHT VALUE
    0657         'AT CUSIP: OUTTP70   UPD'.
    0658       05  FILLER      PIC X(29) JUST RIGHT VALUE
    0659         '   TRANS     DIVIDEND'.
    0660  * 
    0661    01  ERR-LINE-1.
    0662       05  FILLER      PIC X VALUE ' '.
    0663       05  FILLER      PIC X(9) VALUE SPACES.
    0664       05  ERR-O-QSIP      PIC X(10).
    0665       05  FILLER      PIC X(4) VALUE SPACES.
    0666       05  ERR-U-QSIP      PIC X(10).
    0667       05  FILLER      PIC X(4) VALUE SPACES.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-13
    NUMCK.CBL    18-APR-77  20:21

    0668       05  ERR-T-QSIP      PIC X(10).
    0669       05  FILLER      PIC X(4) VALUE SPACES.
    0670       05  ERR-D-QSIP      PIC X(8).
    0671    01  ERR-LINE-2.
    0672       05  FILLER      PIC X VALUE ' '.
    0673       05  FILLER      PIC X(9) VALUE SPACES.
    0674       05  O-ERR-QSIP      PIC X(10).
    0675       05  FILLER         PIC X(103) VALUE SPACES.
    0676  * 
    0677    01  ID-1.
    0678       05  FILLER      PIC X(57) JUST RIGHT VALUE
    0679       'INTERACTIVE DATA CORPORATION'.
    0680       05  FILLER      PIC X(26) JUST RIGHT VALUE
    0681       '40 TO 216 CONVERT SOFTWARE'.
    0682       05  FILLER      PIC X(49) VALUE SPACES.
    0683  * 
    0684    01  ID-2.
    0685       05  FILLER      PIC X(30) VALUE SPACES.
    0686       05  FILLER      PIC X(26) VALUE
	           ^

***				NON-NUMERIC LITERAL IN VALUE CLAUSE TRUNCATED TO SIZE OF ITEM

    0687         'ID:         PD;  VERSION 07.          00;'.
    0688       05  FILLER      PIC X(27) VALUE
    0689         ' RELEASE DATE   09-01-88   '.
    0690  * 
    0691    01  DASHES.
    0692       05  FILLER      PIC X(30) VALUE SPACES.
    0693       05  FILLER      PIC X(53) VALUE ALL '-'.
    0694       05  FILLER      PIC X(49) VALUE SPACES.
    0695  * 
    0696    01  REVISIONS.
    0697       05  REV-IND OCCURS 5    PIC X.
    0698    01  REV-WORD
    0699       REDEFINES REVISIONS     PIC X(5).
    0700  * 
    0701    01  REV-WORD-VALUES.
    0702       05  FILLER  PIC X(25) VALUE '0000100100001100100001010'.
    0703       05  FILLER  PIC X(25) VALUE '0110001110000000001000001'.
    0704       05  FILLER  PIC X(25) VALUE '0000100001000010000100001'.
    0705       05  FILLER  PIC X(25) VALUE '0000100001000011010010110'.
    0706       05  FILLER  PIC X(25) VALUE '1100011010111001111010000'.
    0707       05  FILLER  PIC X(25) VALUE '1001000001000010000100001'.
    0708       05  FILLER  PIC X(25) VALUE '0000100001000010000100001'.
    0709       05  FILLER  PIC X(5)  VALUE '00001'.
    0710  * 
    0711    01  R-W-V  REDEFINES REV-WORD-VALUES.
    0712       05  RW-TABLE OCCURS 36  PIC X(5).
    0713  * 
    0714    01  RW-CODES        PIC X(37) VALUE
    0715       'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890#'.
    0716    01  R-W-C  REDEFINES RW-CODES.
    0717       05  REV-CODE-TABLE OCCURS 37 PIC X.
    0718  * 
    0719    01  OUTP-REC.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-14
    NUMCK.CBL    18-APR-77  20:21

    0720       05  O-X-QSIP.
    0721         10  O-ISSUER            PIC X(6).
    0722         10  O-ISSUE             PIC X(2).
    0723         10  O-UNQ-CD            PIC X.
    0724         10  O-X-CD              PIC X.
    0725       05  O-ISR-QSIP REDEFINES O-X-QSIP.
    0726         10  O-ISSUE-R           PIC X(8).
    0727         10  FILLER              PIC X(2).
    0728       05  O-X-TIC.
    0729         10  O-PRIM-TIC          PIC X(4).
    0730         10  O-GRP-ID            PIC X.
    0731         10  O-CLASS-ID          PIC X.
    0732       05  O-SIC             PIC X(4).
    0733       05  O-ISSUER-DESCRIP          PIC X(28).
    0734       05  O-ISSUER-R REDEFINES O-ISSUER-DESCRIP.
    0735         10  O-ISSUER-1            PIC X(16).
    0736         10  O-ISSUER-2            PIC X(12).
    0737       05  O-ISSUER-CHK REDEFINES O-ISSUER-DESCRIP.
    0738         10  O-DESCRIP-CHK         PIC X(4).
    0739         10  FILLER            PIC X(24).
    0740       05  O-ISSUE-DESCRIP.
    0741         10  FILLER              PIC X(13).
    0742         10  O-FUT-DP4-CD            PIC X.
    0743         10  FILLER              PIC X(6).
    0744       05  O-ISSUE-R1 REDEFINES O-ISSUE-DESCRIP.
    0745         10  O-ISSUE-1           PIC X(4).
    0746         10  O-ISSUE-2           PIC X(16).
    0747       05  O-ISSUE-R2 REDEFINES O-ISSUE-DESCRIP.
    0748         10  FILLER              PIC X(19).
    0749         10  O-OP-TYPE           PIC X.
    0750       88  O-EQUITY-OPT VALUE '1'.
    0751       88  O-INDEX-OPT VALUE '2'.
    0752       88  O-CURRENCY-OPT VALUE '3'.
    0753       88  O-INTEREST-OPT VALUE '4'.
    0754       88  O-DEBT-OPT VALUE '5'.
    0755       88  O-FUTURE-OPT VALUE '6'.
    0756       05  O-PRICE-SECT.
    0757         10  O-PRICE-DT          PIC 9(4).
    0758         10  O-VOL               PIC 9(7).
    0759         10  O-HIGH              PIC 9(4)V9(3).
    0760         10  O-HIGH4 REDEFINES O-HIGH    PIC 9(3)V9(4).
    0761         10  O-LOW               PIC 9(4)V9(3).
    0762         10  O-LOW4 REDEFINES O-LOW      PIC 9(3)V9(4).
    0763         10  O-CLOSE             PIC 9(4)V9(3).
    0764         10  O-CLOSE4 REDEFINES O-CLOSE      PIC 9(3)V9(4).
    0765         10  O-ADJ-PREV-CLOSE        PIC 9(4)V9(3).
    0766         10  O-ADJ-PREV-CLOSE4 REDEFINES
    0767       O-ADJ-PREV-CLOSE          PIC 9(3)V9(4).
    0768       05  O-IND-SECT.
    0769         10  O-ISS-TYPE          PIC X.
    0770         10  O-TRD-TYPE          PIC X.
    0771         10  O-ISS-ST            PIC X.
    0772         10  O-XPRICE-ST         PIC X.
    0773         10  O-SUPP-TYPE REDEFINES O-XPRICE-ST PIC X.
    0774         10  O-SNP-RATE REDEFINES O-SUPP-TYPE PIC X.
    0775         10  O-MAT-DT.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-15
    NUMCK.CBL    18-APR-77  20:21

    0776       15  O-MAT-MM          PIC 99.
    0777       15  O-MAT-DD          PIC 99.
    0778       15  O-MAT-YYYY            PIC 9(4).
    0779         10  O-EXP-DT   REDEFINES O-MAT-DT   PIC 9(8).
    0780         10  O-COUP-RATE         PIC 9(2)V9(4).
    0781         10  O-ADJ-FACT REDEFINES O-COUP-RATE PIC 9(2)V9(4).
    0782         10  O-TRD-ADJ   REDEFINES O-COUP-RATE PIC 9(3)V9(3).
    0783         10  O-MRG-IND           PIC X.
    0784         10  O-BOND-FORM REDEFINES O-MRG-IND PIC X.
    0785         10  O-TRD-UN-ST   REDEFINES O-MRG-IND PIC X.
    0786         10  O-LAST-TDT.
    0787       15  O-MMDD            PIC 9(4).
    0788       15  O-YY              PIC 99.
    0789         10  O-XREFQSIP REDEFINES O-LAST-TDT   PIC X(6).
    0790       05  O-EARN-IAD-SECT.
    0791         10  O-END12-DT          PIC 9(2).
    0792         10  O-ERN-PER-SHR           PIC 9(2)V9(3).
    0793         10  O-NEG-IND           PIC X.
    0794         10  O-SHRS-OUT          PIC 9(7).
    0795         10  O-IAD-FOOT          PIC 9.
    0796         10  O-IAD               PIC 9(1)V9(3).
    0797       05  O-BOND-QUAL-SECT REDEFINES O-EARN-IAD-SECT.
    0798         10  FILLER              PIC X(6).
    0799         10  O-SNP-BD            PIC X.
    0800         10  O-MOODY-RATE            PIC X.
    0801         10  O-AMT-OUT           PIC X(7).
    0802         10  O-YIELD-2-MAT           PIC 9(2)V9(3).
    0803       05  O-FUT-CASH-PRICE-SECT REDEFINES O-EARN-IAD-SECT.
    0804         10  O-FUT-CASH-PRICE      PIC 9(5)V9(3).
    0805         10  O-FUT-OPEN-INTEREST       PIC 9(7).
    0806         10  FILLER             PIC X(5).
    0807       05  O-UND-STK-SECT REDEFINES O-EARN-IAD-SECT.
    0808         10  O-UND-STK-PRICE         PIC 9(4)V9(3).
    0809         10  O-OPEN-INT-ADJ-IND      PIC 9.
    0810         10  O-OPEN-INT          PIC X(7).
    0811         10  O-OVER-10K-ADJ.
    0812       15  O-P-ADJ-IND           PIC 9.
    0813       15  O-HIGH-ADJ            PIC 9.
    0814       15  O-LOW-ADJ         PIC 9.
    0815       15  O-CLOSE-ADJ           PIC 9.
    0816       15  O-ADJ-PREV-CLOSE-ADJ      PIC 9.
    0817       05  O-DIVIDEND-AREAS.
    0818         10  O-DIVSECT-1-2 OCCURS 2 TIMES.
    0819       15  O-DIV-AMT         PIC 9(2)V9(4).
    0820       15  O-DIV-XDIS-DT         PIC 9(6).
    0821       15  O-DIV-REC-DT          PIC 9(6).
    0822       15  O-DIV-PAY-DT          PIC 9(6).
    0823       15  O-DIV-PAY-MTD         PIC X.
    0824       15  O-DIV-PAY-ODR         PIC X.
    0825       15  O-DIV-TX-BS           PIC X.
    0826       15  O-DIV-LR-CD           PIC X.
    0827       15  O-DIV-FQ-CD           PIC X.
    0828       15  O-DIV2-BRR-CD REDEFINES
    0829           O-DIV-FQ-CD           PIC X.
	           ^
    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-16
    NUMCK.CBL    18-APR-77  20:21

***				FATAL - AN ENTRY CONTAINING, OR SUBORDINATE TO AN ENTRY
***				CONTAINING, AN 'OCCURS' CLAUSE MAY NOT BE REDEFINED

    0830       15  O-DIV2-TRANS-CD       PIC X.
    0831       15  O-DIV-RV-IND          PIC X.
    0832       15  O-DIV-ECODE           PIC X.
    0833       05  O-ALT-2ND-DIV REDEFINES
    0834       O-DIVIDEND-AREAS.
    0835         10  FILLER              PIC X(29).
    0836         10  O-OP-IAD            PIC 99V999.
    0837         10  O-OP-UCUS           PIC X(8).
    0838         10  O-OP-ASK-ADJ            PIC X.
    0839         10  O-OP-BID-ADJ            PIC X.
    0840         10  O-OP-BA-DATE            PIC 9(6).
    0841         10  O-OP-ASK            PIC 9(4)V9(3).
    0842         10  O-OP-BID            PIC 9(4)V9(3).
    0843       05  O-BOND-INT-PMNT-SECT REDEFINES
    0844                O-DIVIDEND-AREAS.
    0845         10  O-ENTRY-CODE            PIC X.
    0846         10  O-SAP-PG-NO         PIC X(5).
    0847         10  O-CALL-DATE         PIC 9(6).
    0848         10  O-REV-CODE          PIC X.
    0849         10  O-CALL-ISS-TYPE         PIC X.
    0850         10  O-SF-CODE           PIC X.
    0851         10  O-CALL-TYPE         PIC X.
    0852         10  O-REDEMPTION            PIC X.
    0853         10  O-PREMIUM-CODE          PIC X.
    0854         10  O-CALL-AMT          PIC 9(7).
    0855         10  O-CALL-PRICE            PIC 9(4)V9(3).
    0856         10  O-BD-CUR-YLD            PIC 9(2)V9(4).
    0857         10  O-BD-INT-PMT            PIC 9(3)V9(3).
    0858         10  O-BD-REC-DT         PIC 9(6).
    0859         10  O-BD-PMT-DT         PIC 9(6).
    0860         10  O-BD-PMT-MTD            PIC X.
    0861         10  O-BD-PMT-CD         PIC X.
    0862         10  O-BD-TX-BS-CD           PIC X.
    0863         10  O-BD-LR-CD          PIC X.
    0864         10  O-BD-PMT-FQ         PIC X.
    0865         10  O-BD-TRANS-CD           PIC X.
    0866         10  O-BD-RV-IND         PIC X.
    0867         10  O-BD-ECODE          PIC X.
    0868    01  OUTP-216-REC REDEFINES OUTP-REC.
    0869       05  FILLER            PIC X(10).
    0870       05  O-DATA            PIC X(206).
    0871  * 
    0872    01  W-DIV-REC             PIC X(80) VALUE SPACES.
    0873    01  W-DIV REDEFINES W-DIV-REC.
    0874       03  DIV-REC  OCCURS 2.
    0875       05  D-QSIP.
    0876         10  D-ISSUE-R           PIC X(8).
    0877         10  D-ECODE             PIC X.
    0878         10  D-DIV-SECT-NUM          PIC 9.
    0879       05  D-X-QSIP REDEFINES D-QSIP.
	                              ^

***				FATAL - AN ENTRY CONTAINING, OR SUBORDINATE TO AN ENTRY    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-17
    NUMCK.CBL    18-APR-77  20:21

***				CONTAINING, AN 'OCCURS' CLAUSE MAY NOT BE REDEFINED

    0880         10  D-ISSUER            PIC  X(6).
    0881         10  D-ISSUE           PIC X(2).
    0882         10  FILLER            PIC X(2).
    0883       05  D-CHK-DG              PIC 9.
    0884       05  D-ISS-TYPE            PIC X.
    0885       05  D-AMT-RATE            PIC 9(2)V9(4).
    0886       05  D-XDIS-AMT-DT.
    0887         10  D-XDIS-Y            PIC 9.
    0888         10  D-XDIS-MM           PIC 9(2).
    0889         10  D-XDIS-DD           PIC 9(2).
    0890       05  D-REC-DT.
    0891         10  D-REC-Y             PIC 9.
    0892         10  D-REC-MM            PIC 9(2).
    0893         10  D-REC-DD            PIC 9(2).
    0894       05  D-PAY-DT.
    0895         10  D-PAY-Y             PIC 9.
    0896         10  D-PAY-MM            PIC 9(2).
    0897         10  D-PAY-DD            PIC 9(2).
    0898       05  D-LR-CD               PIC 9.
    0899       05  D-REV-IND             PIC X.
    0900       05  D-BRR-CD              PIC X.
    0901       05  D-TRANS-CD            PIC X.
    0902       05  D-PMT-MTD             PIC X.
    0903       05  D-PMT-ODR             PIC X.
    0904       05  D-TX-BS-CD            PIC X.
    0905  * 
    0906    01  COM-DIV-REC               PIC X(80) VALUE SPACES.
    0907    01  COM-DIV REDEFINES COM-DIV-REC.
    0908       03  COM-OPT-DIV-REC OCCURS 2.
    0909       05  COM-OPT-QSIP.
    0910         10  COM-OPT-ISSUE-R         PIC X(8).
    0911         10  COM-OPT-ECODE           PIC X.
    0912         10  COM-OPT-DIV-SECT-NUM        PIC 9.
    0913       05  COM-OPT-X-QSIP REDEFINES COM-OPT-QSIP.
	                                    ^

***				FATAL - AN ENTRY CONTAINING, OR SUBORDINATE TO AN ENTRY
***				CONTAINING, AN 'OCCURS' CLAUSE MAY NOT BE REDEFINED

    0914         10  COM-OPT-ISSUER          PIC  X(6).
    0915         10  COM-OPT-ISSUE         PIC X(2).
    0916         10  FILLER            PIC X(2).
    0917       05  COM-OPT-CHK-DG            PIC 9.
    0918       05  COM-OPT-ISS-TYPE          PIC X.
    0919       05  COM-OPT-AMT-RATE          PIC 9(2)V9(4).
    0920       05  COM-OPT-XDIS-AMT-DT.
    0921         10  COM-OPT-XDIS-Y          PIC 9.
    0922         10  COM-OPT-XDIS-MM         PIC 9(2).
    0923         10  COM-OPT-XDIS-DD         PIC 9(2).
    0924       05  COM-OPT-REC-DT.
    0925         10  COM-OPT-REC-Y           PIC 9.
    0926         10  COM-OPT-REC-MM          PIC 9(2).
    0927         10  COM-OPT-REC-DD          PIC 9(2).
    0928       05  COM-OPT-PAY-DT.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-18
    NUMCK.CBL    18-APR-77  20:21

    0929         10  COM-OPT-PAY-Y           PIC 9.
    0930         10  COM-OPT-PAY-MM          PIC 9(2).
    0931         10  COM-OPT-PAY-DD          PIC 9(2).
    0932       05  COM-OPT-LR-CD         PIC 9.
    0933       05  COM-OPT-REV-IND           PIC X.
    0934       05  COM-OPT-BRR-CD            PIC X.
    0935       05  COM-OPT-TRANS-CD          PIC X.
    0936       05  COM-OPT-PMT-MTD           PIC X.
    0937       05  COM-OPT-PMT-ODR           PIC X.
    0938       05  COM-OPT-TX-BS-CD          PIC X.
    0939    01  W-NINES         PIC X(216) VALUE ALL '9'.
    0940    PROCEDURE DIVISION.
    0941    JOB-START SECTION.
    0942    JOB-START-PARA.
    0943  *  TOP LEVEL ROUTINE
    0944  
    0945  *  OPEN PRINT FILE AND DISPLAY HEADER
    0946       PERFORM PRINT-ID.
    0947  
    0948  *  OPEN FILES
    0949       PERFORM OPEN-FILES.
    0950  
    0951  *  READ THE LABEL RECORD - IF NOT THERE END PROCESSING
    0952       PERFORM READ-LABEL.
    0953       IF FATAL-ERROR GO TO STOP-RUN.
    0954  
    0955  *  READ THE DATE RECORD - IF NOT THERE END PROCESSING
    0956       PERFORM LABEL-DT.
    0957       IF FATAL-ERROR GO TO STOP-RUN.
    0958  
    0959  *  READ THE BULLETINS FROM THE TRAN FILE, PUTTING THEM INTO
    0960  *  A SEPARATE FILE - IF ERRORS END PROCESSING
    0961       PERFORM SEP-REC.
    0962       IF FATAL-ERROR GO TO STOP-RUN.
    0963  
    0964  *  READ THE BULLETIN FILE UNTIL FIND FIRST VALID BULLETIN RECORD
    0965  *  READ THE TRAN FILE UNTIL FIND FIRST VALID TRAN RECORD
    0966  *  - IF ERRORS END PROCESSING
    0967       PERFORM LOAD-BUF.
    0968       IF FATAL-ERROR GO TO STOP-RUN.
    0969  
    0970  *  PROCESS THE DATA FILES - IF ERRORS END PROCESSING
    0971       PERFORM MAIN-JOB.
    0972       IF FATAL-ERROR GO TO STOP-RUN.
    0973  
    0974  *  PAD OUTPUT 216 FILE WITH 9'S RECORDS TILL END OF BLOCK
    0975       PERFORM END-OF-OUTPUT-NINES.
    0976  
    0977  *  PRINT MESSAGE - NORMAL END OF JOB
    0978       MOVE +2 TO M.
    0979       PERFORM WRITE-MESS.
    0980  
    0981  *  END OF JOB PROCESSING STARTS HERE
    0982    STOP-RUN.
    0983  
    0984  *  WRITE OUT SUMMARY INFO TO PRINT FILE    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-19
    NUMCK.CBL    18-APR-77  20:21

    0985       PERFORM WRITE-SUMMARY.
    0986  
    0987  *  CLOSE THE FILES
    0988       PERFORM CLOSE-FILES.
    0989       STOP RUN.
    0990  * ********************************************************
    0991  * ********************************************************
    0992  * 
    0993    PRINT-ID SECTION.
    0994    PRINT-ID-PARA.
    0995  *  OPEN PRINT FILE AND DISPLAY HEADER
    0996       OPEN OUTPUT PRINT-FILE.
    0997       WRITE PRINT-REC FROM ID-1 AFTER ADVANCING NEXT-PAGE.
	                                                 ^

***				FATAL - IDENTIFIER, NUMERIC LITERAL, OR MNEMONIC-NAME EXPECTED

    0998       WRITE PRINT-REC FROM ID-2 AFTER ADVANCING 2 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    0999       WRITE PRINT-REC FROM DASHES AFTER ADVANCING 1 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    1000       MOVE SPACES TO PRINT-REC.
    1001       WRITE PRINT-REC AFTER ADVANCING 6 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    1002  * 
    1003  * ********************************************************
    1004  * 
    1005    OPEN-FILES SECTION.
    1006    OPEN-FILES-PARA.
    1007       OPEN INPUT OLDTP70-FILE WITH NO REWIND,
    1008          TRANS-FILE.
    1009       OPEN OUTPUT OUTTP70-FILE, UPDATE-FILE.
    1010       MOVE +3 TO M   PERFORM WRITE-MESS.
    1011    OF-EXIT.           EXIT.
    1012  * 
    1013  * ********************************************************
    1014  * 
    1015    READ-LABEL SECTION.
    1016    READ-LABEL-PARA.
    1017       MOVE +0 TO I.
    1018    RL-READ.
    1019       READ TRANS-FILE AT END
	                          ^
    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-20
    NUMCK.CBL    18-APR-77  20:21

***				'INVALID KEY' ASSUMED

    1020  *  EOF BEFORE LABEL RECORD FOUND - WRITE ERROR AND ABEND
    1021      MOVE +4 TO M
    1022      PERFORM WRITE-MESS
    1023      MOVE 1 TO BAD-NEWS
    1024      GO TO RL-EXIT.
    1025       COMPUTE I = I + 1.
    1026       IF I GREATER 3
    1027  *  4 READS WITHOUT FINDING LABEL RECORD - WRITE ERROR AND ABEND
    1028      MOVE +5 TO M
    1029      PERFORM WRITE-MESS
    1030      MOVE 1 TO BAD-NEWS
    1031      GO TO RL-EXIT.
    1032       IF T-LABEL NOT EQUAL TO 'TRAN' AND
    1033      DUMMY NOT EQUAL TO 'LABEL'
    1034  *  IF NOT LABEL RECORD, READ AGAIN
    1035      GO TO RL-READ.
    1036  
    1037  *  FOUND LABEL RECORD, SET FLAGS AND WRITE PROGRESS MESSAGE
    1038       IF T-SCALE-FLAG = 'S'
    1039      MOVE 'T' TO OPT-SCALE-FLAG.
    1040       IF T-EXT-ISTYP-FLAG = 'N'
    1041      MOVE 'T' TO ISS-TYPE-FLAG.
    1042       MOVE +23 TO M.
    1043       PERFORM WRITE-MESS.
    1044       MOVE TRANS-REC TO HDR.
    1045    RL-EXIT.           EXIT.
    1046  * 
    1047  * ********************************************************
    1048  * 
    1049    LABEL-DT   SECTION.
    1050    LABEL-DT-PARA.
    1051  *  READ THE DATE RECORD AND SET CURRENT DATE VARIABLES
    1052  
    1053       READ TRANS-FILE AT END
	                          ^

***				'INVALID KEY' ASSUMED

    1054  *  IF EOF WITH NO DATE RECORD, WRITE ERROR AND ABEND
    1055      MOVE +6 TO M
    1056      PERFORM WRITE-MESS
    1057      MOVE 1 TO BAD-NEWS
    1058      GO TO LD-EXIT.
    1059  
    1060       MOVE T-LABEL-DT TO TODAYS-DT, HDR-DT.
    1061       MOVE TD-YY TO WS-TD-YY.
    1062       MOVE TODAYS-DT-FT TO WS-TD-MD.
    1063  
    1064  *  COMPUTE THE CENTURY - DATE LESS THAN 1970 ASSUMES 21ST CENTURY
    1065       COMPUTE TD-YYYY = TD-YY + 1900.
    1066       IF TD-YYYY LESS 1970
    1067      ADD +100 TO TD-YYYY.
    1068       MOVE TD-YYYY TO S-YYYY-1.
    1069       MOVE TODAYS-DT-FT TO S-DT-FT.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-21
    NUMCK.CBL    18-APR-77  20:21

    1070       COMPUTE TD-M-CNT = TD-YYYY * 12 + TD-MM.
    1071  
    1072  *  WRITE PROGRESS MESSAGE
    1073       MOVE +24 TO M.
    1074       PERFORM WRITE-MESS.
    1075    LD-EXIT.           EXIT.
    1076  * 
    1077  * ********************************************************
    1078  * 
    1079    SEP-REC SECTION.
    1080    SEP-REC-PARA.
    1081  *  READ THE BULLETINS FROM THE TRAN FILE, PUTTING THEM INTO
    1082  *  A SEPARATE FILE
    1083  
    1084    SR-READ.
    1085       READ TRANS-FILE INTO UPD-REC AT END
	                                       ^

***				'INVALID KEY' ASSUMED

    1086  *  EOF BEFORE TRAN RECORDS FOUND - WRITE ERROR AND ABEND
    1087      MOVE +7 TO M
    1088      PERFORM WRITE-MESS
    1089      MOVE 1 TO BAD-NEWS
    1090      GO TO SR-EXIT.
    1091  
    1092       IF U-ISSUER EQUAL TO '999999'
    1093      NEXT SENTENCE
    1094       ELSE
    1095  *  IF HAVEN'T HIT 9'S SEPARATOR RECORD, WRITE RECORD TO UPDATE
    1096  *  FILE AND READ NEXT RECORD
    1097      WRITE UPD-REC
	      ^

***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    1098      GO TO SR-READ.
    1099  
    1100  *  WRITE 9'S SEPARATOR RECORD TO UPDATE FILE
    1101       WRITE UPD-REC.
	       ^

***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    1102  
    1103  *  CLOSE FILE AND REOPEN FOR INPUT
    1104       CLOSE UPDATE-FILE.
    1105       OPEN INPUT UPDATE-FILE.
    1106  
    1107  *  WRITE PROGRESS MESSAGE
    1108       MOVE +8 TO M.
    1109       PERFORM WRITE-MESS.
    1110    SR-EXIT.           EXIT.
    1111  * 
    1112  * ********************************************************
    1113  *     P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-22
    NUMCK.CBL    18-APR-77  20:21

    1114    LOAD-BUF SECTION.
    1115    LOAD-BUF-PARA.
    1116  *  PERFORMS THE PRIMING READS OF THE 3 INPUT FILES,
    1117  *  AND INITIALIZES THE OUTPUT CUSIP TO THE LOWEST OF
    1118  *  THE INPUT CUSIPS
    1119  
    1120  *  READ THE BULLETIN FILE UNTIL FIND FIRST VALID BULLETIN RECORD
    1121       PERFORM UPD-READ.
    1122       IF U-ISSUER EQUAL TO '000000'
    1123      PERFORM UPD-READ UNTIL (ENDUPD) OR
    1124      (U-ISSUER NOT EQUAL TO '000000').
    1125  
    1126       MOVE U-X-QSIP TO O-X-QSIP.
    1127  
    1128  *  READ THE TRAN FILE UNTIL FIND FIRST VALID TRAN RECORD
    1129       PERFORM TRANS-READ.
    1130       IF T-ISSUER EQUAL TO '000000'
    1131      PERFORM TRANS-READ UNTIL (ENDTRANS) OR
    1132      (T-ISSUER NOT EQUAL TO '000000').
    1133  
    1134       IF T-X-QSIP < O-X-QSIP
    1135      MOVE T-X-QSIP TO O-X-QSIP.
    1136  
    1137  *  READ IN THE FIRST OLD 216 RECORD
    1138       PERFORM OLDTP-READ.
    1139  
    1140       IF I-X-QSIP < O-X-QSIP
    1141      MOVE I-X-QSIP TO O-X-QSIP.
    1142  
    1143  *  WRITE PROGRESS OR ERROR MESSAGE
    1144       IF FATAL-ERROR
    1145      MOVE +9 TO M
    1146       ELSE
    1147      MOVE +10 TO M.
    1148       PERFORM WRITE-MESS.
    1149    LB-EXIT.           EXIT.
    1150  * 
    1151  * *********************************************************
    1152  * 
    1153    CLOSE-FILES SECTION.
    1154    CLOSE-FILES-PARA.
    1155  *  CLOSE THE FILES
    1156       MOVE +11 TO M.
    1157       PERFORM WRITE-MESS.
    1158       CLOSE OLDTP70-FILE, UPDATE-FILE, TRANS-FILE, OUTTP70-FILE,
    1159         PRINT-FILE.
    1160    CF-EXIT.           EXIT.
    1161  * 
    1162  * ********************************************************
    1163  * 
    1164    MAIN-JOB SECTION.
    1165    MAIN-JOB-PARA.
    1166  *  PROCESS DATA UNTIL END OF ALL FILES OR FATAL ERROR
    1167       MOVE +12 TO M.
    1168       PERFORM WRITE-MESS.
    1169       PERFORM MAIN-RTN UNTIL ENDALL OR FATAL-ERROR.
	               ^    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-23
    NUMCK.CBL    18-APR-77  20:21


***				FATAL - THIS PROCEDURE NAME IS NOT DEFINED

    1170    MAIN-JOB-EXIT.           EXIT.
    1171  * 
    1172  * ********************************************************
    1173      *
	      ^

***				FATAL - ONLY NOTES MAY APPEAR IN REMAINDER OF THIS PARAGRAPH

    1174    MAIN-RTN SECTION.
    1175    MAIN-RTN-PARA.
    1176  *  PROCESSES INPUT DATA
    1177  
    1178       IF NOT ENDOLDTP AND
    1179      I-X-QSIP NOT > U-X-QSIP AND
    1180      I-X-QSIP NOT > T-X-QSIP
    1181      PERFORM OLD-RTN
    1182       ELSE IF NOT ENDUPD AND
    1183      U-X-QSIP NOT > T-X-QSIP
    1184  *  IF THE UPDATE RECORD HAS THE LOWEST CUSIP, PROCESS IT
    1185      PERFORM UPD-RTN
    1186       ELSE IF NOT ENDTRANS AND
    1187      T-X-QSIP NOT > U-X-QSIP OR
    1188      (T-ISSUE-R = O-ISSUE-R AND T-NOT-PRICE)
    1189  *  IF THE TRAN RECORD HAS THE LOWEST CUSIP, PROCESS IT
    1190      PERFORM PROC-TRANS.
    1191       IF O-X-QSIP < I-X-QSIP AND
    1192      O-X-QSIP < U-X-QSIP AND
    1193      O-X-QSIP < T-X-QSIP AND
    1194      NOT (T-ISSUE-R = O-ISSUE-R AND T-NOT-PRICE)
    1195      PERFORM WRITE-OUTPUT.
    1196    MR-EXIT.           EXIT.
    1197  
    1198  * *********************************************************
    1199  * ***      MAIN-RTN SUBROUTINES        ****
    1200  * *********************************************************
    1201    OLD-RTN SECTION.
    1202    OLD-RTN-PARA.
    1203       MOVE 'F' TO ADD-A-REC, CAP-7, NOT-OLD-TRD.
    1204       MOVE 'T' TO REC-NOT-TRADED.
    1205       MOVE INTP-REC TO OUTP-REC.
    1206       PERFORM OUTREC-INIT.
    1207       MOVE I-X-QSIP TO HI-X-QSIP.
    1208       MOVE I-TRD-TYPE TO HI-TRD-TYPE.
    1209       MOVE I-CLOSE TO HI-CLOSE.
    1210       MOVE I-CLOSE-ADJ TO HI-CLOSE-ADJ.
    1211       MOVE I-CLOSE-ADJ TO HI-CLOSE-ADJ.
    1212       MOVE I-ADJ-PREV-CLOSE TO HI-ADJ-PREV-CLOSE.
    1213       MOVE I-ADJ-PREV-CLOSE-ADJ TO HI-ADJ-PREV-CLOSE-ADJ.
    1214       MOVE I-LOW TO HI-LOW.
    1215       MOVE I-LOW-ADJ TO HI-LOW-ADJ.
    1216       MOVE I-HIGH TO HI-HIGH.
    1217       MOVE I-HIGH-ADJ TO HI-HIGH-ADJ.
    1218    SKIP-C.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-24
    NUMCK.CBL    18-APR-77  20:21

    1219       PERFORM OLDTP-READ.
    1220       IF I-ISS-ST = 'C'
    1221      ADD +1 TO P-CNT
    1222      GO TO SKIP-C.
    1223    ORTN-EXIT.           EXIT.
    1224  * 
    1225    OLDTP-READ SECTION.
    1226    OLDTP-READ-PARA.
    1227  *  READ IN THE OLD 216 RECORD
    1228  
    1229       IF ENDOLDTP
    1230      GO TO OR-EXIT
    1231       ELSE
    1232      READ OLDTP70-FILE AT END
    1233         MOVE 1 TO BAD-NEWS
    1234         MOVE  22 TO M
    1235         PERFORM WRITE-MESS
    1236         PERFORM SHOW-QSIP
    1237         MOVE 'T' TO W-ENDOLDTP
    1238         GO TO OR-EXIT.
    1239       IF I-ISSUER EQUAL TO '999999'
    1240      MOVE 'T' TO W-ENDOLDTP
    1241      GO TO OR-EXIT
    1242       ELSE
    1243      ADD 1 TO  W-OLDTP-CNT
    1244  *  FOR STOCKS RESET THE SPLIT ADJUSTMENT FACTOR TO 1
    1245      MOVE I-ISS-TYPE TO TEST-ISS-TYPE
    1246      IF TEST-IS-STOCK
    1247         MOVE '1' TO I-ADJ-FACT.
    1248  
    1249    OR-EXIT.           EXIT.
    1250  * 
    1251  * ********************************************************
    1252  * 
    1253    UPD-RTN SECTION.
    1254    UPD-RTN-PARA.
    1255  * 
    1256  *   PROCESS UPDATE - BULLETINS AND CAPITALIZATION CHANGES
    1257  * 
    1258       IF U-X-QSIP NOT = O-X-QSIP
    1259  *  THIS CUSIP WAS NOT ON THE INPUT 216 FILE, SO MAKE A
    1260  *  SKELETON RECORD
    1261      MOVE U-X-QSIP TO O-X-QSIP
    1262      PERFORM NEW-RECRD
    1263      IF U-ISS-ST EQUAL TO '1' OR '3' OR '4' OR 'K' OR 'N'
    1264         ADD +1 TO SC-CNT
    1265      ELSE
    1266         ADD +1 TO NSC-CNT.
    1267  
    1268  *  PROCESS THIS UPDATE RECORD
    1269       PERFORM PROC-UPD.
    1270  
    1271  *  READ THE NEXT UPDATE RECORD
    1272       PERFORM UPD-READ.
    1273  
    1274    UR-EXIT.           EXIT.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-25
    NUMCK.CBL    18-APR-77  20:21

    1275  * 
    1276  * *********************************************************
    1277  * 
    1278  * ***      UPD-RTN SUBROUTINES         ****
    1279  * *********************************************************
    1280  * 
    1281    NEW-RECRD SECTION.
    1282    NEW-RECRD-PARA.
    1283  * 
    1284  *  INITIALIZE THE OUTPUT RECORD FIELDS
    1285       MOVE W-NINES TO O-DATA.
    1286       MOVE ZEROS TO O-PRICE-SECT.
    1287       MOVE ZEROS TO O-DIVIDEND-AREAS.
    1288       MOVE 'H' TO O-DIV-RV-IND(1), O-DIV-RV-IND(2).
    1289       MOVE '2' TO O-DIV-ECODE(1), O-DIV-ECODE(2).
    1290       MOVE 'T' TO ADD-A-REC.
    1291       PERFORM OUTREC-INIT.
    1292  
    1293  *  IF ADDING FOR A PRICE TRAN RECORD, SET DEFAULT ISSUE TYPE
    1294       IF O-X-QSIP = T-X-QSIP
    1295      MOVE '4' TO O-ISS-ST
    1296      IF T-FUTURE-PRICE
    1297         MOVE 'C' TO O-ISS-TYPE
    1298      ELSE IF T-BOND-PRICE
    1299         MOVE '6' TO O-ISS-TYPE
    1300      ELSE IF T-STOCK-PRICE
    1301         MOVE '0' TO O-ISS-TYPE
    1302      ELSE IF T-OPTION-PRICE
    1303         IF T-EQUITY-OPT
    1304            MOVE 'B' TO O-ISS-TYPE
    1305         ELSE
    1306            MOVE 'D' TO O-ISS-TYPE.
    1307  
    1308    NR-EXIT.           EXIT.
    1309  * 
    1310  * *********************************************************
    1311  * 
    1312    WRITE-OUTPUT SECTION.
    1313    WRITE-OUTPUT-PARA.
    1314  *  DOES SOME UPDATES TO OUTPUT 216 RECORD AND WRITES IT
    1315  
    1316       IF O-ISS-ST = 'E'
    1317  *  DO NOT KEEP OLD RECORD ON EXCHANGE CHANGES
    1318      GO TO WO-EXIT.
    1319  
    1320       MOVE O-ISS-TYPE TO TEST-ISS-TYPE.
    1321       IF C5-CHANGE
    1322      MOVE 'F' TO C5-STAT-CHANGE
    1323       ELSE
    1324  *  IF HAVEN'T HAD 'C' OR '5' STATUS BULLETIN,
    1325  *  TEST IF SECURITY HAS MATURED
    1326      IF TEST-IS-OPTION OR TEST-IS-BOND OR TEST-IS-FUTURE
    1327         MOVE O-MAT-YYYY TO YYYY-1
    1328         MOVE O-MAT-MM TO MM-1
    1329         MOVE O-MAT-DD TO DD-1
    1330         IF (CHK-DATE  LESS SAVE-DATE)    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-26
    NUMCK.CBL    18-APR-77  20:21

    1331            IF (O-ISS-ST EQUAL TO '0')
    1332           MOVE '5' TO O-ISS-ST
    1333            ELSE IF (O-ISS-ST EQUAL TO '5')
    1334           MOVE 'C' TO O-ISS-ST
    1335            ELSE
    1336           NEXT SENTENCE
    1337         ELSE
    1338            NEXT SENTENCE
    1339      ELSE
    1340         NEXT SENTENCE.
    1341  
    1342       IF TEST-IS-EQUITY-OPTION
    1343  *  FILL IN OPTIONS DIVIDEND SECTION
    1344      PERFORM CHK-COM-DIV VARYING P FROM 1 BY 1 UNTIL P > 2
    1345       ELSE IF TEST-IS-STOCK
    1346  *  PROCESS DIVIDENDS
    1347      PERFORM CHK-DIV-RECS.
    1348  
    1349       PERFORM TRD-RT.
    1350       IF O-DESCRIP-CHK EQUAL TO '9999' AND O-X-QSIP NOT EQUAL TO
    1351             '9999999999'
    1352      ADD +1 TO NO-DESCRIP-CNT.
    1353       IF O-X-QSIP NOT EQUAL TO '9999999999'
    1354      ADD +1 TO W-OUTP-CNT.
    1355  
    1356       IF NON-EXTENDED
    1357  *  IF THEY DON'T WANT EXTENDED ISSUE TYPE, CONVERT TO NON-EXTENDED
    1358      IF O-ISS-TYPE NOT < 'H' AND O-ISS-TYPE NOT > 'Z'
    1359         AND O-ISS-TYPE NOT = 'Q'
    1360         MOVE '6' TO O-ISS-TYPE.
    1361  
    1362       IF TEST-IS-EQUITY-OPTION
    1363  *  IF AN OPTION'S UNDERLYING SECURITY HAD A NEW IAD REPORTED,
    1364  *  PUT IT IN OPTION RECORD
    1365      IF O-OP-UCUS = HOLD-IAD-CUSIP
    1366         MOVE HOLD-IAD TO O-OP-IAD.
    1367  
    1368       WRITE OUTP216-REC FROM OUTP-REC.
	       ^

***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    1369       MOVE O-X-QSIP TO OUT-QSIP-SAVE.
    1370       MOVE O-X-TIC TO OUT-TIC-SAVE.
    1371       MOVE O-SIC TO OUT-SIC-SAVE.
    1372       MOVE O-ISSUER-DESCRIP TO OUT-DESC-SAVE.
    1373       IF NEW-REC
    1374      MOVE 'F' TO ADD-A-REC.
    1375       MOVE 'T' TO REC-NOT-TRADED.
    1376       MOVE 'F' TO CAP-7, NOT-OLD-TRD.
    1377  
    1378    WO-EXIT.
    1379       EXIT.
    1380  * 
    1381  * *********************************************************
    1382  *     P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-27
    NUMCK.CBL    18-APR-77  20:21

    1383    TRD-RT   SECTION.
    1384    TRD-RT-PARA.
    1385  * 
    1386  *   CHECKS TO SEE IF RECORD TRADED.
    1387  *   ADJUSTS TRADE TYPE, ISSUE-STATUS, ADJUSTMENT FACTOR,
    1388  *   ADJUSTMENT TO PREVIOUS CLOSE WHERE EVER NECESSARY.
    1389  * 
    1390       MOVE O-ISS-TYPE TO TEST-ISS-TYPE.
    1391       IF NOT-TRADED
    1392      IF O-TRD-TYPE EQUAL TO 'Z' OR NEW-TRD-TYPE
    1393  *   IF ACTIVE FOR DIVIDENDS ONLY, OR HAS A NEW TRADE TYPE,
    1394  *   DON'T UPDATE TRADE TYPE, PREVIOUS CLOSE OR YIELD
    1395         GO TO TT-EXIT
    1396      ELSE
    1397  *   SET UNTRADED SECURITY'S TRADE TYPE TO 9
    1398         MOVE '9' TO O-TRD-TYPE
    1399         IF NOT TEST-IS-STOCK
    1400            GO TO TT-EXIT
    1401         ELSE IF (O-ADJ-FACT NOT EQUAL TO 1 AND 0) AND
    1402             NOT (NEW-REC)
    1403  *   IF IS A STOCK AND HAS SPLIT, ADJUST PREVIOUS CLOSE
    1404            COMPUTE O-ADJ-PREV-CLOSE =
    1405           O-ADJ-PREV-CLOSE * O-ADJ-FACT
    1406            GO TO TT-EXIT
    1407         ELSE
    1408            GO TO TT-EXIT
    1409       ELSE
    1410      NEXT SENTENCE.
    1411       IF (O-ISS-ST EQUAL TO '3' OR '4')
    1412      IF NEW-REC
    1413         NEXT SENTENCE
    1414      ELSE
    1415  *   IF ISSUE STATUS WAS 3 OR 4, AND RECORD ISN'T NEW, RESET
    1416  *   ISSUE STATUS TO 0
    1417         MOVE '0' TO O-ISS-ST
    1418       ELSE IF O-ISS-ST EQUAL TO 'N'
    1419  *   IF WAS A NEW RECORD, AND HAS TRADED, SET ISSUE STATUS TO 4
    1420      MOVE '4' TO O-ISS-ST
    1421       ELSE IF O-ISS-ST EQUAL TO '1' OR '2' OR '5' OR '6'
    1422                  OR '7' OR '8' OR '9'
    1423  *   LEAVE THESE ISSUE STATUS' ALONE
    1424      NEXT SENTENCE
    1425       ELSE
    1426  *   RESET ALL REMAINING STATUS' TO 0
    1427      MOVE '0' TO O-ISS-ST.
    1428  
    1429  *   CALCULATE CURRENT YIELD FOR BONDS
    1430       IF (O-UNQ-CD EQUAL TO 'U' OR 'Z')
    1431  *   BONDS TRADING FLAT HAVE NO NEW YIELD
    1432      NEXT SENTENCE
    1433       ELSE IF (O-ISS-ST = '0' OR '1' OR '3' OR '4' OR '6' OR
    1434               '8' OR '9')
    1435      IF O-X-CD = 'L' OR 'M'
    1436  *   LISTED BONDS WITH ACTIVE STATUS - YIELD IS AS FOLLOWS
    1437         IF O-TRD-TYPE EQUAL TO '8' OR 'A' AND O-LOW
    1438  *   BID/ASK OR MODEL PRICES USE BID (O-LOW)    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-28
    NUMCK.CBL    18-APR-77  20:21

    1439            NOT EQUAL TO 0
    1440            COMPUTE O-BD-CUR-YLD =
    1441            ((O-COUP-RATE * 100.          0) / O-LOW)
	                              1^         2^

***				1) FATAL - UNBALANCED PARENTHESES
***				2) FATAL - STATEMENT EXPECTED

    1442         ELSE IF O-TRD-TYPE EQUAL TO '9'
    1443            IF O-VOL EQUAL TO 0 AND O-LOW NOT EQUAL TO 0
    1444  *   UNTRADED WITH BID/ASK USE OLD BID (O-LOW)
    1445           COMPUTE O-BD-CUR-YLD ROUNDED =
    1446               ((O-COUP-RATE * 100.          0) / O-LOW)
	                                             ^

***				FATAL - STATEMENT EXPECTED

    1447            ELSE IF O-CLOSE NOT EQUAL TO 0
    1448  *   OTHER UNTRADED USE CLOSE
    1449           COMPUTE O-BD-CUR-YLD ROUNDED =
    1450               ((O-COUP-RATE * 100.          0) / O-CLOSE)
	                                             ^

***				FATAL - STATEMENT EXPECTED

    1451            ELSE
    1452  *   IF NO BID OR CLOSE, WRITE ERROR
    1453           MOVE 0 TO O-BD-CUR-YLD
    1454           MOVE +26 TO M
    1455           PERFORM WRITE-MESS
    1456           MOVE O-X-QSIP TO O-ERR-QSIP
    1457           MOVE ERR-LINE-2 TO PRINT-LINE
    1458           WRITE PRINT-REC AFTER ADVANCING 1 LINES
    1459         ELSE IF O-VOL EQUAL TO 0 AND
    1460  *  IF TRADE TYPE NO '8', 'A', '9', AND NOT '0', USE BID (O-LOW)
    1461             O-TRD-TYPE NOT EQUAL TO '0' AND
    1462             O-LOW NOT EQUAL TO 0
    1463             COMPUTE O-BD-CUR-YLD ROUNDED =
    1464                ((O-COUP-RATE * 100.          0) / O-LOW)
	                                              ^

***				FATAL - STATEMENT EXPECTED

    1465         ELSE IF O-CLOSE NOT EQUAL TO 0
    1466  *  IF TRADE TYPE '0' AND HAVE CLOSE, USE CLOSE
    1467            COMPUTE O-BD-CUR-YLD ROUNDED =
    1468            ((O-COUP-RATE * 100.          0) / O-CLOSE)
	                                         1^           2^

***				1) FATAL - STATEMENT EXPECTED
***				2) PERIOD ASSUMED

    1469         ELSE
    1470  *  IF TRADE TYPE '0' AND NO CLOSE, PRINT ERROR
    1471            MOVE 0 TO O-BD-CUR-YLD
    1472            MOVE +26 TO M    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-29
    NUMCK.CBL    18-APR-77  20:21

    1473            PERFORM WRITE-MESS
    1474            MOVE O-X-QSIP TO O-ERR-QSIP
    1475            MOVE ERR-LINE-2 TO PRINT-LINE
    1476            WRITE PRINT-REC AFTER ADVANCING 1 LINES
    1477      ELSE IF O-X-CD EQUAL TO 'N' OR 'O' OR 'P' OR
	      ^

***				FATAL - STATEMENT EXPECTED

    1478                  'S' OR 'X'
    1479  *   NON-LISTED BONDS GET YIELD AS FOLLOWS
    1480         IF O-TRD-TYPE EQUAL TO '9' AND
    1481            O-ADJ-PREV-CLOSE NOT EQUAL TO 0
    1482  *   IF UNTRADED, USE ADJUSTED PREVIOUS CLOSE
    1483            COMPUTE O-BD-CUR-YLD =
    1484          ((O-COUP-RATE * 100.          0) / O-ADJ-PREV-CLOSE)
	                                        ^

***				FATAL - STATEMENT EXPECTED

    1485         ELSE IF O-LOW NOT EQUAL TO 0
    1486  *   IF TRADED AND HAVE BID (O-LOW), USE BID
    1487           COMPUTE O-BD-CUR-YLD = ((O-COUP-RATE
    1488  *  100.          0) / O-LOW)
    1489         ELSE IF O-CLOSE NOT EQUAL TO 0
    1490  *   NO BID, SO USE CLOSE
    1491           COMPUTE O-BD-CUR-YLD =
    1492              ((O-COUP-RATE * 100.          0) / O-CLOSE)
	                                           1^           2^

***				1) FATAL - STATEMENT EXPECTED
***				2) PERIOD ASSUMED

    1493         ELSE
    1494  *   NO BID, NO CLOSE, PRINT ERROR
    1495            MOVE 0 TO O-BD-CUR-YLD
    1496            MOVE +26 TO M
    1497            PERFORM WRITE-MESS
    1498            MOVE O-X-QSIP TO O-ERR-QSIP
    1499            MOVE ERR-LINE-2 TO PRINT-LINE
    1500            WRITE PRINT-REC AFTER ADVANCING 1 LINES
    1501         ELSE
    1502            NEXT SENTENCE
    1503      ELSE
	      ^

***				FATAL - STATEMENT EXPECTED

    1504         NEXT SENTENCE.
    1505  
    1506       IF TEST-IS-STOCK
    1507      IF NEW-REC
    1508         IF CAP-7-REC
    1509            NEXT SENTENCE
    1510         ELSE
    1511  *   NEW STOCKS WITHOUT CAP CHANGE 7, SET ADJUSTMENT FACTOR TO 1    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-30
    NUMCK.CBL    18-APR-77  20:21

    1512            MOVE '1' TO O-ADJ-FACT
    1513      ELSE IF O-TRD-TYPE EQUAL TO '1' OR CAP-7-REC
    1514  *   IF EXISTING STOCK HAS A SPLIT, ADJUST PREVIOUS CLOSE
    1515         COMPUTE O-ADJ-PREV-CLOSE = O-ADJ-PREV-CLOSE *
    1516                      O-ADJ-FACT
    1517      ELSE
    1518         NEXT SENTENCE.
    1519    TT-EXIT.           EXIT.
    1520  * 
    1521  * *********************************************************
    1522  * ***       TRANS-UPD-OLD SUBROUTINES      ****
    1523  * *********************************************************
    1524  * 
    1525    UPD-READ    SECTION.
    1526    UPD-READ-PARA.
    1527       IF ENDUPD
    1528      GO TO UR-EXIT
    1529       ELSE
    1530      READ UPDATE-FILE AT END
	                          ^

***				'INVALID KEY' ASSUMED

    1531         MOVE 1 TO BAD-NEWS
    1532         MOVE +20 TO M
    1533         PERFORM WRITE-MESS
    1534         PERFORM SHOW-QSIP
    1535         MOVE 'T' TO W-ENDUPD
    1536         GO TO UR-EXIT.
    1537       IF U-ISSUER EQUAL TO '999999'
    1538      MOVE 'T' TO W-ENDUPD
    1539       ELSE
    1540      MOVE UPD-REC TO LT-U-REC
    1541      ADD  1 TO W-UPD-CNT.
    1542    UR-EXIT.           EXIT.
    1543  * 
    1544  * ********************************************************
    1545  * 
    1546    PROC-UPD   SECTION.
    1547    PROC-UPD-PARA.
    1548  * 
    1549  *   CHECKS TO SEE IF BULLETIN RECORD IS A STATUS CHANGE,STATUS
    1550  *   CAPITALIZATION CHANGE OR STATUS CONTINUATION RECORD
    1551  * 
    1552       IF U-IS-CAP
    1553      PERFORM CAP-REC
    1554       ELSE IF U-IS-BULL
    1555      IF UC-CON-IND GREATER 0
    1556         PERFORM STAT-CON
    1557      ELSE
    1558         PERFORM STAT-CHNG.
    1559  * 
    1560  * ********************************************************
    1561  * ***        PROC-UPD SUBROUTINES         ****
    1562  * ********************************************************
    1563  *     P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-31
    NUMCK.CBL    18-APR-77  20:21

    1564    CAP-REC SECTION.
    1565    CAP-REC-PARA.
    1566       ADD 1 TO CR-CNT.
    1567       IF C-CAP-SECT EQUAL TO 6
    1568      PERFORM IAD-6
    1569       ELSE IF C-CAP-SECT EQUAL TO 7
    1570      PERFORM RECAP-7
    1571       ELSE IF C-CAP-SECT EQUAL TO 9
    1572      PERFORM TRD-REV-9
    1573       ELSE
    1574      PERFORM CAP-SEC-ERROR.
    1575  * ::::::::::::::::::::::::::::::::::::::::::::::::::::
    1576    IAD-6 SECTION.
    1577    IAD-6-PARA.
    1578       MOVE C-ISS-TYPE TO TEST-ISS-TYPE.
    1579       IF TEST-IS-BOND
    1580      MOVE C-BOND-SUPP-TYPE TO O-SUPP-TYPE
    1581      GO TO I-6-EXIT.
    1582       MOVE C-IAD-FOOT TO W-IAD-FOOT.
    1583       MOVE C-IAD TO W-IAD.
    1584       IF W-IAD-FOOT EQUAL TO '9'
    1585      MOVE 0 TO W-IAD
    1586       ELSE IF W-IAD-FOOT EQUAL TO '7'
    1587      MOVE '8' TO W-IAD-FOOT
    1588      COMPUTE W-IAD = (W-IAD / 10)
    1589       ELSE IF W-IAD LESS 10
    1590      NEXT SENTENCE
    1591       ELSE IF W-IAD LESS 20
    1592      MOVE '1' TO W-IAD-FOOT
    1593      COMPUTE W-IAD = (W-IAD - 10)
    1594       ELSE IF W-IAD LESS 30
    1595      MOVE '2' TO W-IAD-FOOT
    1596      COMPUTE W-IAD = (W-IAD - 20)
    1597       ELSE
    1598      MOVE '7' TO W-IAD-FOOT
    1599      COMPUTE W-IAD = (W-IAD / 10).
    1600       MOVE W-IAD-FOOT TO O-IAD-FOOT.
    1601       MOVE W-IAD      TO O-IAD.
    1602       MOVE C-EPS TO O-ERN-PER-SHR.
    1603       MOVE C-EPS-IND TO O-NEG-IND.
    1604       MOVE C-12M-END-DT TO O-END12-DT.
    1605  *  SAVE THE LATEST IAD UPDATE TO PUT IN OPTIONS RECORDS
    1606       MOVE W-IAD TO HOLD-IAD.
    1607       MOVE U-ISSUE-R TO HOLD-IAD-CUSIP.
    1608    I-6-EXIT.           EXIT.
    1609  * ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    1610    RECAP-7 SECTION.
    1611    RECAP-7-PARA.
    1612       IF O-ISS-TYPE EQUAL TO 'B' OR 'C' OR 'D'
    1613  *   OPTIONS AND FUTURES DON'T HAVE CAP 7'S, SO SKIP ANY U GET
    1614      GO TO R-7-EXIT.
    1615       MOVE C-SHRS-OUT   TO O-SHRS-OUT.
    1616       MOVE C-ADJ-FAC    TO O-ADJ-FACT.
    1617       IF C-ADJ-FAC NOT EQUAL TO 1.          0
	                                 1^         2^^
    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-32
    NUMCK.CBL    18-APR-77  20:21

***				1) FATAL - STATEMENT EXPECTED
***				2) FATAL - STATEMENT EXPECTED
***				2) PERIOD ASSUMED

    1618      MOVE 'T' TO CAP-7
    1619       ELSE
	       ^

***				FATAL - STATEMENT EXPECTED

    1620      NEXT SENTENCE.
    1621    R-7-EXIT.           EXIT.
    1622  * 
    1623  * ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    1624  * 
    1625    TRD-REV-9   SECTION.
    1626    TRD-REV-9-PARA.
    1627       MOVE C-ISS-TYPE TO TEST-ISS-TYPE.
    1628       IF TEST-IS-BOND
    1629      MOVE C-SNP-BD-RATE TO O-SNP-BD
    1630      MOVE C-MOODY-FIN-QL TO O-MOODY-RATE
    1631      MOVE C-TRANS-CD TO O-BD-TRANS-CD
    1632      IF C-BOND-FORM EQUAL '9'
    1633         NEXT SENTENCE
    1634      ELSE
    1635         MOVE C-BOND-FORM TO O-BOND-FORM
    1636       ELSE IF TEST-IS-STOCK
    1637      MOVE C-SNP-BD-RATE  TO O-SNP-RATE
    1638      MOVE C-MARG-IND TO O-MRG-IND
    1639      MOVE C-TRANS-CD TO O-DIV2-TRANS-CD(2)
    1640       ELSE IF TEST-IS-OPTION
    1641      MOVE C-TRD-UNT-ST  TO O-TRD-UN-ST
    1642      MOVE C-X-PR-ST    TO O-XPRICE-ST
    1643      MOVE C-TRD-UNT-ADJ TO O-TRD-ADJ.
    1644    T-R-EXIT.           EXIT.
    1645  * :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    1646    CAP-SEC-ERROR SECTION.
    1647    CAP-SEC-ERROR-PARA.
    1648       MOVE +14 TO M.
    1649       PERFORM WRITE-MESS.
    1650       PERFORM SHOW-QSIP.
    1651       MOVE 2 TO BAD-NEWS.
    1652  * 
    1653  * ********************************************************
    1654  * 
    1655    STAT-CON SECTION.
    1656    STAT-CON-PARA.
    1657       ADD +1 TO STAT-CON-CNT.
    1658       ADD +1 TO CONT-CNT.
    1659       IF STAT-CON-CNT GREATER 5
    1660      MOVE 0 TO STAT-CON-CNT
    1661      MOVE +15 TO M   PERFORM WRITE-MESS
    1662      PERFORM SHOW-QSIP
    1663      MOVE 2   TO BAD-NEWS
    1664      GO TO STAT-CON-EXIT
    1665       ELSE IF UC-CON-IND = 1    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-33
    NUMCK.CBL    18-APR-77  20:21

    1666      MOVE UC-ISSUER-1 TO O-ISSUER-1
    1667       ELSE IF UC-CON-IND = 2
    1668      MOVE UC-ISSUER-2 TO O-ISSUER-2
    1669      MOVE UC-ISSUE-1 TO O-ISSUE-1
    1670       ELSE IF UC-CON-IND = 3
    1671      MOVE UC-ISSUE-2 TO O-ISSUE-2
    1672       ELSE IF UC-CON-IND = 4
    1673      MOVE UC-TICK     TO O-X-TIC
    1674      MOVE UC-SIC      TO O-SIC
    1675      MOVE UC-ISS-TYPE TO O-ISS-TYPE
    1676      MOVE UC-TRD-TYPE TO O-TRD-TYPE
    1677      MOVE UC-ISS-ST   TO O-ISS-ST
    1678       ELSE IF UC-CON-IND = 5
    1679      MOVE UC-EXP-DT   TO O-EXP-DT
    1680      MOVE UC-ADJ-FACT TO O-ADJ-FACT
    1681      MOVE O-ISS-TYPE TO TEST-ISS-TYPE
    1682      IF TEST-IS-STOCK
    1683         MOVE UC-BOND-FORM TO O-SNP-RATE
    1684      ELSE
    1685         MOVE UC-BOND-FORM TO O-BOND-FORM
    1686       ELSE
    1687      MOVE +13 TO M  PERFORM WRITE-MESS
    1688      MOVE 2   TO BAD-NEWS
    1689      PERFORM SHOW-QSIP.
    1690    STAT-CON-EXIT.           EXIT.
    1691  * 
    1692  * ********************************************************
    1693  * 
    1694    STAT-CHNG SECTION.
    1695    STAT-CHNG-PARA.
    1696       MOVE O-ISS-TYPE TO TEST-ISS-TYPE.
    1697       ADD 1 TO SCNG-CNT.
    1698       IF U-ISS-ST NOT EQUAL TO 'G'
    1699      MOVE U-ISS-ST TO O-ISS-ST.
    1700       IF U-HAS-CONT
    1701      MOVE +0 TO STAT-CON-CNT.
    1702       IF U-ISS-ST EQUAL TO 'A' OR 'D' OR 'S' OR
    1703                'T' OR 'X' OR 'Y'
    1704      MOVE 0 TO O-HIGH, O-LOW, O-CLOSE, O-VOL
    1705      MOVE TODAYS-DT-FT TO O-PRICE-DT
    1706      IF TEST-IS-OPTION AND O-P-ADJ-IND EQUAL TO '1'
    1707         MOVE '0' TO O-HIGH-ADJ
    1708         MOVE '0' TO O-LOW-ADJ
    1709         MOVE '0' TO O-CLOSE-ADJ
    1710      ELSE
    1711         NEXT SENTENCE
    1712       ELSE
    1713      NEXT SENTENCE.
    1714       IF U-HAS-XREF
    1715      MOVE U-XREF-ISSUER TO O-XREFQSIP
    1716       ELSE IF U-HAS-UCUS
    1717      MOVE U-XREF-QSIP TO O-OP-UCUS.
    1718       IF U-ISS-ST   EQUAL TO '8' OR '9'
    1719      MOVE U-EFCT-MM  TO WS-D-MM, O-MAT-MM
    1720      MOVE U-EFCT-DD  TO WS-D-DD, O-MAT-DD
    1721      MOVE U-EFCT-Y   TO WS-D-YY    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-34
    NUMCK.CBL    18-APR-77  20:21

    1722      PERFORM TRANS-DT-FIX
    1723      MOVE WS-D-YYYY TO O-MAT-YYYY.
    1724       IF (U-ISS-ST EQUAL TO '5' OR 'C')
    1725      MOVE 'T' TO C5-STAT-CHANGE.
    1726  
    1727       IF TEST-IS-BOND AND U-ISS-ST = '5'
    1728  *  TEST IF BOND WAS CALLED OR MATURED AND SET CALL ENTRY CODE
    1729         MOVE O-MAT-YYYY TO YYYY-1
    1730         MOVE O-MAT-MM TO MM-1
    1731         MOVE O-MAT-DD TO DD-1
    1732         IF CHK-DATE  NOT > SAVE-DATE
    1733            MOVE '5' TO O-ENTRY-CODE.
    1734  
    1735    STAT-CHNG-EXIT.           EXIT.
    1736  * 
    1737  * ********************************************************
    1738  * ***      COMMON AND MISCELLANEOUS SUBROUTINES   ****
    1739  * ********************************************************
    1740  * 
    1741    PROC-TRANS    SECTION.
    1742    PROC-TRANS-PARA.
    1743  
    1744       IF T-X-QSIP NOT = O-X-QSIP AND
    1745      NOT (T-ISSUE-R = O-ISSUE-R AND T-NOT-PRICE)
    1746  *  THIS CUSIP WAS NOT ON THE INPUT 216 FILE, SO MAKE A
    1747  *  SKELETON RECORD
    1748      MOVE T-X-QSIP TO O-X-QSIP
    1749      PERFORM NEW-RECRD
    1750      ADD +1 TO NSC-CNT.
    1751  * 
    1752  *   PROCESSES THE VARIOUS KINDS OF TRANSMISSION RECORDS
    1753  * 
    1754       IF T-FUTURE-PRICE
    1755      PERFORM FUTURE-REC-PROC
    1756      IF NOT-TRADED
    1757         NEXT SENTENCE
    1758      ELSE
    1759         PERFORM NEW-TRDNDT
    1760       ELSE IF T-DIV
    1761      ADD 1 TO DR-CNT
    1762      IF T-ISSUE-R NOT EQUAL TO D-ISSUE-R (1)
    1763         MOVE SPACES TO DIV-REC (2)
    1764         MOVE TRANS-REC TO DIV-REC (1)
    1765         IF R-ISS-TYPE EQUAL TO '0'
    1766            IF T-ISSUE-R NOT EQUAL TO
    1767             COM-OPT-ISSUE-R (1)
    1768           MOVE SPACES TO COM-OPT-DIV-REC (2)
    1769           MOVE TRANS-REC TO COM-OPT-DIV-REC (1)
    1770            ELSE
    1771           MOVE TRANS-REC TO COM-OPT-DIV-REC (2)
    1772         ELSE
    1773            NEXT SENTENCE
    1774      ELSE
    1775         MOVE TRANS-REC TO DIV-REC (2)
    1776         IF R-ISS-TYPE EQUAL TO '0'
    1777            IF T-ISSUE-R NOT EQUAL TO    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-35
    NUMCK.CBL    18-APR-77  20:21

    1778            COM-OPT-ISSUE-R (1)
    1779           MOVE SPACES TO COM-OPT-DIV-REC (2)
    1780           MOVE TRANS-REC TO COM-OPT-DIV-REC (1)
    1781            ELSE
    1782           MOVE TRANS-REC TO COM-OPT-DIV-REC (2)
    1783         ELSE
    1784            NEXT SENTENCE
    1785       ELSE IF T-STOCK-PRICE OR T-BOND-PRICE OR T-OPTION-PRICE
    1786      PERFORM PRICE-REC-PROC
    1787      IF NOT-TRADED
    1788         NEXT SENTENCE
    1789      ELSE
    1790         PERFORM NEW-TRDNDT
    1791       ELSE IF T-OPTION-BA
    1792      ADD 1 TO BA-CNT
    1793      PERFORM BA-REC-PROC
    1794      IF NOT-TRADED
    1795         NEXT SENTENCE
    1796      ELSE
    1797         PERFORM NEW-TRDNDT
    1798       ELSE IF T-FUTURE-OI
    1799      ADD 1 TO OI-CNT
    1800      PERFORM FUT-OI-PROC
    1801       ELSE IF T-RBI
    1802      IF T-ISSUE-R EQUAL TO O-ISSUE-R
    1803         PERFORM REG-BOND-PROC
    1804      ELSE
    1805         NEXT SENTENCE
    1806       ELSE IF T-CALL
    1807      ADD 1 TO CL-CNT
    1808      IF T-ISSUE-R EQUAL TO O-ISSUE-R
    1809         PERFORM CALL-BOND-PROC
    1810      ELSE
    1811         NEXT SENTENCE
    1812       ELSE
    1813      NEXT SENTENCE.
    1814       PERFORM TRANS-READ.
    1815  * 
    1816  * ******************************************************
    1817  * ***     PROC-TRANS SUBROUTINES        ****
    1818  * ******************************************************
    1819  * 
    1820    TRANS-READ SECTION.
    1821    TRANS-READ-PARA.
    1822       IF ENDTRANS
    1823      GO TO TR-EXIT
    1824       ELSE
    1825      READ TRANS-FILE AT END
	                         ^

***				'INVALID KEY' ASSUMED

    1826         MOVE 1 TO BAD-NEWS
    1827         MOVE +21 TO M
    1828         PERFORM WRITE-MESS
    1829         PERFORM SHOW-QSIP    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-36
    NUMCK.CBL    18-APR-77  20:21

    1830         MOVE 'T' TO W-ENDTRANS
    1831         GO TO TR-EXIT.
    1832       IF T-ISSUER EQUAL TO '999999'
    1833      MOVE 'T' TO W-ENDTRANS
    1834       ELSE
    1835      MOVE TRANS-REC TO LT-REC
    1836      ADD 1 TO W-TRANS-CNT
    1837      IF T-STOCK-PRICE AND T-UNQ-CD = 'W'
    1838         MOVE '1' TO T-UNQ-CD
    1839      ELSE
    1840         NEXT SENTENCE.
    1841    TR-EXIT.           EXIT.
    1842  * 
    1843  * ********************************************************
    1844  * 
    1845    NEW-TRDNDT SECTION.
    1846    NEW-TRDNDT-PARA.
    1847       IF O-TRD-TYPE EQUAL TO 'Z'
    1848         GO TO NEW-TD-EXIT.
    1849       IF (O-TRD-TYPE EQUAL TO 'A')
    1850      OR ((O-TRD-TYPE EQUAL TO '8')  AND
    1851          NOT (O-X-CD EQUAL TO 'G' OR 'H' OR 'I' OR 'N' OR
    1852                   'O' OR 'P' OR 'S' OR 'U' OR
    1853                   'W' OR 'X' OR 'Y'))
    1854  *   IF HAVE MODEL PRICE, OR BID/ASK PRICING AND EXCH IS NOT
    1855  *   A BID/ASK EXCH, SET PRICING DATE, BUT DON'T RESET LAST
    1856  *   TRADE DATE
    1857      MOVE T-PRICING-DT TO O-PRICE-DT
    1858       ELSE
    1859  *  HAVE NEW TRADE DATA, SET PRICE DATE AND LAST TRADE DATE
    1860      MOVE T-PRICING-DT TO O-PRICE-DT
    1861      MOVE HOLD-LAST-TRDNDT TO O-LAST-TDT.
    1862    NEW-TD-EXIT.           EXIT.
    1863  * 
    1864  * ********************************************************
    1865  * 
    1866    FUTURE-REC-PROC SECTION.
    1867    FUTURE-REC-PROC-PARA.
    1868       IF T-CLOSE EQUAL TO 0 AND T-LOW EQUAL TO 0
    1869                  AND T-HIGH EQUAL TO 0
    1870      ADD +1 TO BADPR-CNT
    1871      GO TO FRP-EXIT
    1872       ELSE
    1873      NEXT SENTENCE.
    1874       ADD 1 TO PR-CNT.
    1875       MOVE 'F' TO REC-NOT-TRADED.
    1876       MOVE T-TRD-TYPE TO O-TRD-TYPE.
    1877       MOVE T-VOL TO O-VOL.
    1878       IF (NEW-REC OR O-TRD-TYPE EQUAL TO  '8' OR '9')
    1879      NEXT SENTENCE
    1880       ELSE IF O-FUT-DP4-CD EQUAL TO '4'
    1881      MOVE O-CLOSE4 TO O-ADJ-PREV-CLOSE4
    1882       ELSE
    1883      MOVE O-CLOSE TO O-ADJ-PREV-CLOSE.
    1884       IF T-FUT-DIVISOR EQUAL TO '1'
    1885      MOVE 10 TO DIV    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-37
    NUMCK.CBL    18-APR-77  20:21

    1886       ELSE IF T-FUT-DIVISOR EQUAL TO '2' OR 'F'
    1887      MOVE 100 TO DIV
    1888       ELSE IF T-FUT-DIVISOR EQUAL TO '3'
    1889      MOVE 1000 TO DIV
    1890       ELSE IF T-FUT-DIVISOR EQUAL TO '4'
    1891      MOVE 10000 TO DIV.
    1892       COMPUTE TEMP-PRCS =    (T-CLOSE / DIV).
    1893       COMPUTE TEMP-HIGH =    ((T-CLOSE + T-HIGH) / DIV).
    1894       COMPUTE TEMP-LOW  =    ((T-CLOSE - T-LOW ) / DIV).
    1895       IF O-FUT-DP4-CD EQUAL TO '4'
    1896      MOVE TEMP-PRCS TO O-CLOSE4
    1897      MOVE TEMP-HIGH TO O-HIGH4
    1898      MOVE TEMP-LOW TO O-LOW4
    1899       ELSE
    1900      MOVE TEMP-PRCS TO O-CLOSE
    1901      MOVE TEMP-HIGH TO O-HIGH
    1902      MOVE TEMP-LOW  TO O-LOW.
    1903       IF (T-FUT-DIVISOR EQUAL TO 'F') AND
    1904       (T-YLD-2-MAT GREATER 0 AND LESS 99)
    1905      MOVE T-YLD-2-MAT TO O-YIELD-2-MAT.
    1906       COMPUTE FUT-TEMP-PRICE =    (T-FUT-CASH-PRICE / DIV).
    1907       MOVE FUT-TEMP-PRICE TO O-FUT-CASH-PRICE.
    1908    FRP-EXIT.           EXIT.
    1909  * 
    1910  * ********************************************************
    1911  * 
    1912    PRICE-REC-PROC SECTION.
    1913    PRICE-REC-PROC-PARA.
    1914  * 
    1915  *  ADJUSTED PREVIOUS CLOSE CASH EX-DISTRIBUTIONS ARE NOT
    1916  *  REFLECTED IN ADJUSTED PREVIOUS CLOSE.
    1917  *  FURTHER TESTING FOR CONDITIONS OF TRD -TYPE GOING FROM
    1918  *  0-9 OR 8-9 ALSO CHECK FUTURE-REC-PROC
    1919  * 
    1920       IF ((T-CLOSE EQUAL TO 0) AND (T-LOW EQUAL TO 0) AND
    1921             (T-HIGH EQUAL TO 0))
    1922      MOVE T-TRD-TYPE TO O-TRD-TYPE
    1923      MOVE 'T' TO NOT-OLD-TRD
    1924      ADD +1 TO BADPR-CNT
    1925       ELSE
    1926      MOVE 'F' TO REC-NOT-TRADED
    1927      IF (NEW-REC AND T-TRD-TYPE EQUAL TO '1') OR
    1928             (T-TRD-TYPE EQUAL TO '9')
    1929         PERFORM PRICE-CAL
    1930         PERFORM TRD-APC
    1931      ELSE
    1932         PERFORM TRD-APC
    1933         PERFORM PRICE-CAL.
    1934       ADD 1 TO PR-CNT.
    1935    PRP-EXIT.           EXIT.
    1936  * 
    1937  * *********************************************************
    1938  * 
    1939    TRD-APC SECTION.
    1940    TRD-APC-PARA.
    1941      P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-38
    NUMCK.CBL    18-APR-77  20:21

    1942  *  UPDATE THE TRADE TYPE FROM THE TRAN RECORD
    1943       MOVE T-TRD-TYPE TO O-TRD-TYPE.
    1944  
    1945  *  IF THERE IS NO INPUT 216, SET APC TO 0'S
    1946       IF HI-X-QSIP NOT = O-X-QSIP
    1947      MOVE 0 TO O-ADJ-PREV-CLOSE
    1948      MOVE 0 TO O-ADJ-PREV-CLOSE-ADJ
    1949      GO TO TRD-APC-EXIT.
    1950  
    1951  *  UPDATE THE ADJUSTED PREVIOUS CLOSE, IF NECESSARY
    1952       IF NOT (O-X-CD EQUAL TO  'G' OR 'H' OR 'I' OR
    1953               'N' OR 'O' OR 'P' OR 'S' OR
    1954               'U' OR 'W' OR 'X' OR 'Y')
    1955  *  IF NOT A BID/ASK EXCHANGE.          .          .
    1956      IF HI-TRD-TYPE NOT < '0' AND HI-TRD-TYPE < '8'
    1957  *  AND IT DID TRADE YESTERDAY, THEN USE YESTERDAY'S CLOSE
    1958         MOVE HI-CLOSE TO O-ADJ-PREV-CLOSE
    1959         MOVE HI-CLOSE-ADJ TO O-ADJ-PREV-CLOSE-ADJ
    1960      ELSE
    1961  *  NO TRADE SO KEEP OLD ADJUSTED PREVIOUS CLOSE
    1962         MOVE HI-ADJ-PREV-CLOSE TO O-ADJ-PREV-CLOSE
    1963         MOVE HI-ADJ-PREV-CLOSE-ADJ TO O-ADJ-PREV-CLOSE-ADJ
    1964       ELSE
    1965  *  IS A BID/ASK EXCHANGE
    1966      IF HI-TRD-TYPE NOT < '0' AND HI-TRD-TYPE < '9'
    1967  *  DID PRICE YESTERDAY
    1968         IF HI-LOW NOT = 0
    1969  *  USE THE LOW (BID) IF WE HAVE IT
    1970            MOVE HI-LOW TO O-ADJ-PREV-CLOSE
    1971            MOVE HI-LOW-ADJ TO O-ADJ-PREV-CLOSE-ADJ
    1972         ELSE
    1973  *  YESTERDAY'S BID NOT AVAILABLE, USE YESTERDAY'S ASK
    1974            MOVE HI-HIGH TO O-ADJ-PREV-CLOSE
    1975            MOVE HI-HIGH-ADJ TO O-ADJ-PREV-CLOSE-ADJ
    1976      ELSE
    1977  *  NO BID/ASK SO KEEP OLD ADJUSTED PREVIOUS CLOSE
    1978         MOVE HI-ADJ-PREV-CLOSE TO O-ADJ-PREV-CLOSE
    1979         MOVE HI-ADJ-PREV-CLOSE-ADJ TO O-ADJ-PREV-CLOSE-ADJ.
    1980    TRD-APC-EXIT.           EXIT.
    1981  * 
    1982  * **********************************************************
    1983  * 
    1984    PRICE-CAL SECTION.
    1985    PRICE-CAL-PARA.
    1986  *  CONVERT PRICES TO PROPER REPRESENTATION
    1987  
    1988  *  CONVERT VOLUMES
    1989  *  BONDS REPORT VOLUME AS IS
    1990  *  IF OPTION OVERFLOW, ADD HIGH ORDER DIGIT, ELSE OPTIONS
    1991  *  REPORT VOLUME AS IS
    1992  *  STOCKS ADD HIGH ORDER DIGIT AND MULTIPLY BY 100
    1993       IF T-BOND-PRICE
    1994      MOVE T-VOL TO O-VOL
    1995       ELSE IF T-OPTION-PRICE
    1996      IF T-OPT-OFLOW
    1997         COMPUTE VOL-TEMP = (T-VOL-HO * 100000) + T-VOL    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-39
    NUMCK.CBL    18-APR-77  20:21

    1998         MOVE VOL-TEMP TO O-VOL
    1999      ELSE
    2000         MOVE T-VOL TO O-VOL
    2001       ELSE
    2002       COMPUTE VOL-TEMP = (T-VOL-HO * 100000) + T-VOL
    2003       COMPUTE VOL-TEMP = VOL-TEMP * 100
    2004       MOVE VOL-TEMP TO O-VOL.
    2005  
    2006  *  MOVE PRICE DATA TO WORKING STORAGE, CONVERTING OFFSETS TO
    2007  *  REAL PRICES
    2008       IF T-STOCK-PRICE OR (T-OPTION-PRICE AND T-OPT-OFLOW)
    2009  *  ADD HIGH ORDER DIGITS FOR STOCKS OR OVERFLOWED OPTIONS
    2010      COMPUTE WS-CLOSE-INT = (T-CLOSE-HO * 100000) + T-CLOSE
    2011      COMPUTE WS-HIGH-INT =  WS-CLOSE-INT +
    2012                 ((T-HIGH-HO * 10000) + T-HIGH)
    2013      COMPUTE WS-LOW-INT =   WS-CLOSE-INT -
    2014                 ((T-LOW-HO * 10000) + T-LOW)
    2015       ELSE
    2016      MOVE T-CLOSE TO WS-CLOSE-INT
    2017      COMPUTE WS-HIGH-INT =  WS-CLOSE-INT + T-HIGH
    2018      COMPUTE WS-LOW-INT =   WS-CLOSE-INT - T-LOW.
    2019  
    2020  *  FIGURE SCALING FACTOR
    2021       IF T-STOCK-PRICE OR T-BOND-PRICE
    2022  *  STOCKS AND BONDS USE SCALING INDICATOR
    2023      IF IN-THOU
    2024         MOVE 1000 TO DIV
    2025      ELSE IF IN-HUND OR WITH-32NDS
    2026         MOVE 100 TO DIV
    2027      ELSE IF IN-8THS
    2028         MOVE 8 TO DIV
    2029      ELSE IF IN-16THS
    2030         MOVE 16 TO DIV
    2031      ELSE IF IN-32NDS
    2032         MOVE 32 TO DIV
    2033      ELSE IF IN-64THS
    2034         MOVE 64 TO DIV
    2035      ELSE
    2036         NEXT SENTENCE
    2037       ELSE IF T-CURRENCY-OPT
    2038  *  CURRENCY OPTIONS ARE IN DOLLARS AND CENTS
    2039      MOVE 100 TO DIV
    2040       ELSE IF T-INTEREST-OPT OR T-DEBT-OPT
    2041  *  INTEREST RATE AND DEBT OPTIONS ARE IN 64THS
    2042      MOVE 64 TO DIV
    2043       ELSE
    2044  *  ALL OTHER OPTIONS ARE IN 8THS
    2045      MOVE 8 TO DIV.
    2046  
    2047  *  APPLY SCALING FACTORS
    2048       COMPUTE TEMP-CLOSE ROUNDED = (WS-CLOSE-INT / DIV).
    2049       COMPUTE TEMP-HIGH ROUNDED = (WS-HIGH-INT / DIV).
    2050       COMPUTE TEMP-LOW ROUNDED = (WS-LOW-INT / DIV).
    2051  
    2052       IF T-X-CD = 'P' AND TNOTE-TBOND
    2053  *  TREASURY NOTES AND BONDS NEED LOW ORDER DIGITS ADDED,    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-40
    NUMCK.CBL    18-APR-77  20:21

    2054  *  TO MAKE 32NDS IN DECIMAL REPRESENTATION
    2055      COMPUTE WHOLE-32NDS ROUNDED = TEMP-CLOSE * 32
    2056      COMPUTE FRAC-32NDS ROUNDED = WHOLE-32NDS / 32
    2057      MOVE FRAC-32NDS TO TEMP-CLOSE
    2058      COMPUTE WHOLE-32NDS ROUNDED = TEMP-HIGH * 32
    2059      COMPUTE FRAC-32NDS ROUNDED = WHOLE-32NDS / 32
    2060      MOVE FRAC-32NDS TO TEMP-HIGH
    2061      COMPUTE WHOLE-32NDS ROUNDED = TEMP-LOW * 32
    2062      COMPUTE FRAC-32NDS ROUNDED = WHOLE-32NDS / 32
    2063      MOVE FRAC-32NDS TO TEMP-LOW
    2064       ELSE
    2065      NEXT SENTENCE.
    2066  
    2067       IF T-OPTION-PRICE
    2068  *  SET OPTION PRICE CODE AND RESCALE PRICES IF NECESSARY
    2069      IF PRICE-PER-SHARE
    2070         IF T-EQUITY-OPT OR T-INDEX-OPT
    2071            MOVE '0' TO O-DIV-LR-CD (1)
    2072            COMPUTE TEMP-CLOSE ROUNDED = TEMP-CLOSE / 100
    2073            COMPUTE TEMP-HIGH ROUNDED = TEMP-HIGH / 100
    2074            COMPUTE TEMP-LOW ROUNDED = TEMP-LOW / 100
    2075         ELSE IF T-CURRENCY-OPT
    2076            MOVE '0' TO O-DIV-LR-CD (1)
    2077         ELSE IF T-INTEREST-OPT OR T-DEBT-OPT
    2078            MOVE '1' TO O-DIV-LR-CD (1)
    2079            IF O-TRD-UN-ST = '7'
    2080           COMPUTE TEMP-CLOSE ROUNDED = TEMP-CLOSE /
    2081               (100 * O-TRD-ADJ)
    2082           COMPUTE TEMP-HIGH ROUNDED = TEMP-HIGH /
    2083               (100 * O-TRD-ADJ)
    2084           COMPUTE TEMP-LOW ROUNDED = TEMP-LOW /
    2085               (100 * O-TRD-ADJ)
    2086            ELSE
    2087           COMPUTE TEMP-CLOSE ROUNDED = TEMP-CLOSE /
    2088               (10 * O-TRD-ADJ)
    2089           COMPUTE TEMP-HIGH ROUNDED = TEMP-HIGH /
    2090               (10 * O-TRD-ADJ)
    2091           COMPUTE TEMP-LOW ROUNDED = TEMP-LOW /
    2092               (10 * O-TRD-ADJ)
    2093         ELSE
    2094            NEXT SENTENCE
    2095      ELSE IF T-EQUITY-OPT OR T-INDEX-OPT
    2096         MOVE '2' TO O-DIV-LR-CD (1)
    2097      ELSE IF T-CURRENCY-OPT
    2098         MOVE '0' TO O-DIV-LR-CD (1)
    2099      ELSE IF T-INTEREST-OPT OR T-DEBT-OPT
    2100         MOVE '3' TO O-DIV-LR-CD (1)
    2101      ELSE
    2102         NEXT SENTENCE
    2103       ELSE
    2104      NEXT SENTENCE.
    2105  
    2106       MOVE TEMP-CLOSE   TO O-CLOSE.
    2107       MOVE TEMP-HIGH    TO O-HIGH.
    2108       MOVE TEMP-LOW     TO O-LOW.
    2109      P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-41
    NUMCK.CBL    18-APR-77  20:21

    2110       IF T-BOND-PRICE
    2111  *  MOVE YIELD TO MATURITY FOR BONDS
    2112      MOVE T-YLD-2-MAT TO O-YIELD-2-MAT
    2113       ELSE IF T-OPTION-PRICE AND NOT T-OPT-OFLOW
    2114  *  OPTIONS NOT OVERFLOWED HAVE UNDERLYING PRICE IN 64THS
    2115      COMPUTE O-UND-STK-PRICE ROUNDED =
    2116             T-UND-STK-PR / 64
    2117       ELSE IF T-OPTION-PRICE
    2118  *  MOVE PRICE OVERFLOW FIELDS AND SET PRICE OVERFLOW FLAG
    2119      MOVE TEMP-HIGH-OFLOW TO O-HIGH-ADJ
    2120      MOVE TEMP-LOW-OFLOW TO O-LOW-ADJ
    2121      MOVE TEMP-CLOSE-OFLOW TO O-CLOSE-ADJ
    2122      IF (TEMP-HIGH-OFLOW NOT = 0) OR
    2123         (TEMP-LOW-OFLOW NOT = 0) OR
    2124         (TEMP-CLOSE-OFLOW NOT = 0)
    2125         MOVE 0 TO O-P-ADJ-IND
    2126      ELSE
    2127         MOVE 1 TO O-P-ADJ-IND
    2128       ELSE
    2129      NEXT SENTENCE.
    2130  
    2131    PCS-EXIT.           EXIT.
    2132  * 
    2133  * ********************************************************
    2134  * 
    2135    BA-REC-PROC SECTION.
    2136    BA-REC-PROC-PARA.
    2137  *  PROCESS OPTION BID-ASK RECORDS
    2138  
    2139  *  IF BID/ASK IS UPDATED, SET BID AND ASK
    2140       IF BA-UPD-BA
    2141      IF PRICE-PER-SHARE
    2142         IF O-EQUITY-OPT OR O-INDEX-OPT
    2143            COMPUTE TEMP-BID ROUNDED = BA-BID / 100
    2144            COMPUTE TEMP-ASK ROUNDED = BA-ASK / 100
    2145         ELSE IF O-INTEREST-OPT OR O-DEBT-OPT
    2146            IF O-TRD-UN-ST = '7'
    2147           COMPUTE TEMP-BID ROUNDED = BA-BID /
    2148               (100 * O-TRD-ADJ)
    2149           COMPUTE TEMP-ASK ROUNDED = BA-ASK /
    2150               (100 * O-TRD-ADJ)
    2151            ELSE
    2152           COMPUTE TEMP-BID ROUNDED = BA-BID /
    2153               (10 * O-TRD-ADJ)
    2154           COMPUTE TEMP-ASK ROUNDED = BA-ASK /
    2155               (10 * O-TRD-ADJ)
    2156         ELSE
    2157            NEXT SENTENCE
    2158      ELSE
    2159         MOVE BA-BID TO TEMP-BID
    2160         MOVE BA-ASK TO TEMP-ASK.
    2161       IF BA-UPD-BA
    2162      MOVE TEMP-OP-ASK TO O-OP-ASK
    2163      MOVE TEMP-OP-BID TO O-OP-BID
    2164      MOVE TEMP-ASK-ADJ TO O-OP-ASK-ADJ
    2165      MOVE TEMP-BID-ADJ TO O-OP-BID-ADJ    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-42
    NUMCK.CBL    18-APR-77  20:21

    2166      MOVE BA-DT-Y      TO WS-D-YY
    2167      MOVE BA-DT-MM     TO WS-D-MM
    2168      MOVE BA-DT-DD     TO WS-D-DD
    2169      PERFORM TRANS-DT-FIX
    2170      MOVE WS-D-YY TO WS-YMD-YY
    2171      MOVE WS-D-MM TO WS-YMD-MM
    2172      MOVE WS-D-DD TO WS-YMD-DD
    2173      MOVE WS-YMD-N TO O-OP-BA-DATE.
    2174  
    2175  *  IF OPEN INTEREST IS UPDATE, SET OPEN INTEREST
    2176       IF BA-UPD-OPEN-INT
    2177      MOVE BA-OPEN-INT TO O-OPEN-INT
    2178      IF O-TRD-TYPE = '9'
    2179         MOVE 'I' TO O-TRD-TYPE.
    2180  
    2181  *  IF OPEN INTEREST HAS BEEN ADJUSTED, SET INDICATOR
    2182       IF BA-ADJ-OPEN-INT
    2183      MOVE 1 TO O-OPEN-INT-ADJ-IND
    2184       ELSE
    2185      MOVE 0 TO O-OPEN-INT-ADJ-IND.
    2186    BA-REC-PROC-EXIT.           EXIT.
    2187  * 
    2188  * ********************************************************
    2189  * 
    2190    CALL-BOND-PROC  SECTION.
    2191    CALL-BOND-PROC-PARA.
    2192  *  UPDATE THE CALL BOND DATA FROM A CALL BOND RECORD
    2193       MOVE C-ENTRY-CODE      TO O-ENTRY-CODE.
    2194       MOVE C-REV-CODE    TO O-REV-CODE.
    2195       MOVE C-SAP-PG-NO   TO O-SAP-PG-NO.
    2196       MOVE C-CALL-Y      TO WS-D-YY.
    2197       MOVE C-CALL-MM     TO WS-D-MM.
    2198       MOVE C-CALL-DD     TO WS-D-DD.
    2199       PERFORM TRANS-DT-FIX.
    2200       MOVE WS-DT-N     TO O-CALL-DATE.
    2201       MOVE C-CALL-ISS-TYPE    TO O-CALL-ISS-TYPE.
    2202       MOVE C-SF-CODE     TO O-SF-CODE.
    2203       MOVE C-CALL-TYPE   TO O-CALL-TYPE.
    2204       MOVE C-REDEMPTION      TO O-REDEMPTION.
    2205       MOVE C-PREMIUM-CODE    TO O-PREMIUM-CODE.
    2206       MOVE C-CALL-AMT    TO O-CALL-AMT.
    2207       MOVE C-CALL-PRICE      TO O-CALL-PRICE.
    2208  
    2209    CALL-BOND-PROC-EXIT.           EXIT.
    2210  * 
    2211  * ********************************************************
    2212  * 
    2213    FUT-OI-PROC SECTION.
    2214    FUT-OI-PROC-PARA.
    2215       MOVE BA-OPEN-INT TO O-FUT-OPEN-INTEREST.
    2216    FUT-OI-REC-PROC-EXIT.           EXIT.
    2217  * 
    2218  * 
    2219  * ********************************************************
    2220  * 
    2221    REG-BOND-PROC SECTION.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-43
    NUMCK.CBL    18-APR-77  20:21

    2222    REG-BOND-PROC-PARA.
    2223       MOVE '00000' TO REV-WORD.
    2224       ADD 1 TO RB-CNT.
    2225       IF  (R-PMT-MTD NOT EQUAL TO O-BD-PMT-MTD) OR
    2226       (R-PMT-CD  NOT EQUAL TO O-BD-PMT-CD ) OR
    2227       (R-TX-BS-CD NOT EQUAL TO O-BD-TX-BS-CD)
    2228       MOVE '1' TO REV-IND (1).
    2229       IF  (R-INT-PMT  NOT EQUAL TO O-BD-INT-PMT)
    2230       MOVE '1' TO REV-IND (2).
    2231       IF  (R-TRANS-CD NOT EQUAL TO O-BD-TRANS-CD)
    2232       MOVE '1' TO REV-IND (3).
    2233       MOVE R-ECODE    TO O-BD-ECODE.
    2234       MOVE R-ISS-TYPE TO O-ISS-TYPE.
    2235       MOVE R-INT-PMT  TO O-BD-INT-PMT.
    2236       MOVE R-PMT-FQ   TO O-BD-PMT-FQ.
    2237       MOVE R-LR-CD    TO O-BD-LR-CD.
    2238       MOVE R-TRANS-CD TO O-BD-TRANS-CD.
    2239       MOVE R-PMT-MTD  TO O-BD-PMT-MTD.
    2240       MOVE R-PMT-CD   TO O-BD-PMT-CD.
    2241       MOVE R-TX-BS-CD TO O-BD-TX-BS-CD.
    2242       MOVE R-REC-MM TO WS-D-MM.
    2243       MOVE R-REC-DD TO WS-D-DD.
    2244       MOVE R-REC-Y  TO WS-D-YY.
    2245       PERFORM TRANS-DT-FIX.
    2246       IF  (WS-DT-N NOT EQUAL TO O-BD-REC-DT)
    2247            MOVE '1' TO REV-IND (3).
    2248       MOVE WS-DT-N TO O-BD-REC-DT.
    2249       MOVE R-PMT-MM TO WS-D-MM.
    2250       MOVE R-PMT-DD TO WS-D-DD.
    2251       MOVE R-PMT-Y  TO WS-D-YY.
    2252       PERFORM TRANS-DT-FIX.
    2253       IF  (WS-DT-N NOT EQUAL TO O-BD-PMT-DT)
    2254            MOVE '1' TO REV-IND (4).
    2255       MOVE WS-DT-N TO O-BD-PMT-DT.
    2256       IF R-ECODE EQUAL TO '3' PERFORM FIND-REV-CODE
    2257      ELSE      MOVE 'H' TO O-BD-RV-IND.
    2258    RBP-EXIT.           EXIT.
    2259  * 
    2260  * ********************************************************
    2261  * 
    2262    FIND-REV-CODE SECTION.
    2263    FIND-REV-CODE-PARA.
    2264       MOVE 1 TO J.
    2265    FRC-LOOP.
    2266       IF REV-WORD EQUAL TO RW-TABLE (J)
    2267       MOVE REV-CODE-TABLE (J) TO O-BD-RV-IND
    2268       GO TO FRC-EXIT
    2269         ELSE
    2270       ADD 1 TO J.
    2271       IF J LESS 38 GO TO FRC-LOOP.
    2272    FRC-EXIT.           EXIT.
    2273  * 
    2274  * ********************************************************
    2275  * 
    2276    CHK-COM-DIV SECTION.
    2277    CHK-COM-DIV-PARA.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-44
    NUMCK.CBL    18-APR-77  20:21

    2278  * 
    2279  *   CHECK COMMON STOCK DIVIDEND AREA FOR OPTION
    2280  *   AND MOVE LATEST CASH DIVIDEND TO FIRST DIVIDEND AREA
    2281  * 
    2282       IF (COM-OPT-ISSUER (P) = O-ISSUER) AND
    2283      (COM-OPT-PMT-MTD (P) = '1' OR '2' OR '3' OR '4')
    2284  *  THE CUSIP MATCHES AND THIS IS A CASH DIVIDEND
    2285      IF COM-OPT-DIV-SECT-NUM (P) NOT EQUAL TO '1' AND '2'
    2286  *  BAD DIV SECTION NUMBER, REPORT ERROR
    2287          MOVE 2 TO BAD-NEWS
    2288          MOVE +16 TO M   PERFORM WRITE-MESS
    2289          PERFORM SHOW-QSIP
    2290      ELSE
    2291  *  CHECK THE EX-DIS DATE TO SEE IF ANY NEW CASH DIV IS LATER
    2292  *  THAN ONE ALREADY IN BUCKET
    2293         MOVE O-DIV-XDIS-DT (1) TO WS-DT-N
    2294         MOVE WS-D-YY TO WS-XD-YY
    2295         MOVE WS-D-MM TO WS-XD-MM
    2296         MOVE WS-D-DD TO WS-XD-DD
    2297         MOVE COM-OPT-XDIS-MM (P) TO WS-D-MM
    2298         MOVE COM-OPT-XDIS-DD (P) TO WS-D-DD
    2299         MOVE COM-OPT-XDIS-Y (P) TO WS-D-YY
    2300         PERFORM TRANS-DT-FIX
    2301         MOVE WS-D-YY TO WS-YMD-YY
    2302         MOVE WS-D-MM TO WS-YMD-MM
    2303         MOVE WS-D-DD TO WS-YMD-DD
    2304         IF WS-YMD-N > WS-XD-N
    2305            MOVE WS-DT-N TO O-DIV-XDIS-DT (1)
    2306            MOVE COM-OPT-AMT-RATE (P) TO O-DIV-AMT (1)
    2307            MOVE COM-OPT-LR-CD (P) TO O-DIV-LR-CD (1)
    2308            MOVE COM-OPT-REV-IND (P) TO O-DIV-RV-IND (1)
    2309            MOVE COM-OPT-PMT-MTD (P)  TO O-DIV-PAY-MTD (1)
    2310            MOVE COM-OPT-PMT-ODR (P) TO O-DIV-PAY-ODR (1)
    2311            MOVE COM-OPT-TX-BS-CD (P) TO O-DIV-TX-BS (1)
    2312            MOVE COM-OPT-REC-MM (P) TO WS-D-MM
    2313            MOVE COM-OPT-REC-DD (P) TO WS-D-DD
    2314            MOVE COM-OPT-REC-Y (P) TO WS-D-YY
    2315            PERFORM TRANS-DT-FIX
    2316            MOVE WS-DT-N TO O-DIV-REC-DT (1)
    2317            MOVE COM-OPT-PAY-MM (P) TO WS-D-MM
    2318            MOVE COM-OPT-PAY-DD (P) TO WS-D-DD
    2319            MOVE COM-OPT-PAY-Y (P) TO WS-D-YY
    2320            PERFORM TRANS-DT-FIX
    2321            MOVE WS-DT-N TO O-DIV-PAY-DT (1).
    2322    CCD-EXIT.           EXIT.
    2323  * 
    2324  * ********************************************************
    2325  * 
    2326    CHK-DIV-RECS SECTION.
    2327    CHK-DIV-RECS-PARA.
    2328       MOVE +1 TO P.
    2329    CD-LOOP.
    2330       IF P GREATER 2 OR D-ISSUE-R (P) EQUAL TO SPACES
    2331                    GO TO CD-EXIT.
    2332       IF (D-ISSUE-R (P) EQUAL TO O-ISSUE-R)
    2333       PERFORM DIV-REC-PROC    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-45
    NUMCK.CBL    18-APR-77  20:21

    2334       ADD +1 TO P
    2335       GO TO CD-LOOP.
    2336    CD-EXIT.           EXIT.
    2337  * 
    2338  * ********************************************************
    2339  * 
    2340    DIV-REC-PROC SECTION.
    2341    DIV-REC-PROC-PARA.
    2342       IF D-DIV-SECT-NUM (P) NOT EQUAL TO '1' AND '2'
    2343       MOVE 2 TO BAD-NEWS
    2344       MOVE +16 TO M   PERFORM WRITE-MESS
    2345       PERFORM SHOW-QSIP
    2346       GO TO DRP-EXIT.
    2347       MOVE D-DIV-SECT-NUM (P) TO I.
    2348       MOVE D-ECODE (P)     TO O-DIV-ECODE (I).
    2349       MOVE D-ISS-TYPE (P) TO O-ISS-TYPE.
    2350       MOVE D-AMT-RATE (P) TO O-DIV-AMT (I).
    2351       MOVE D-LR-CD (P)     TO O-DIV-LR-CD (I).
    2352       MOVE D-REV-IND (P)   TO O-DIV-RV-IND (I).
    2353       MOVE D-BRR-CD (P) TO O-DIV2-BRR-CD (2)
    2354       MOVE D-TRANS-CD (P) TO O-DIV2-TRANS-CD (2).
    2355       MOVE D-PMT-MTD (P)    TO O-DIV-PAY-MTD (I).
    2356       MOVE D-PMT-ODR (P)   TO O-DIV-PAY-ODR (I).
    2357       MOVE D-TX-BS-CD (P)  TO O-DIV-TX-BS (I).
    2358       MOVE D-XDIS-MM (P)   TO WS-D-MM.
    2359       MOVE D-XDIS-DD (P)   TO WS-D-DD.
    2360       MOVE D-XDIS-Y (P)    TO WS-D-YY.
    2361       PERFORM TRANS-DT-FIX.
    2362       MOVE WS-DT-N     TO O-DIV-XDIS-DT (I).
    2363       MOVE D-REC-MM (P)    TO WS-D-MM.
    2364       MOVE D-REC-DD (P)    TO WS-D-DD.
    2365       MOVE D-REC-Y (P)     TO WS-D-YY.
    2366       PERFORM TRANS-DT-FIX.
    2367       MOVE WS-DT-N     TO O-DIV-REC-DT (I).
    2368       MOVE D-PAY-MM (P)    TO WS-D-MM.
    2369       MOVE D-PAY-DD (P)    TO WS-D-DD.
    2370       MOVE D-PAY-Y (P)     TO WS-D-YY.
    2371       PERFORM TRANS-DT-FIX.
    2372       MOVE WS-DT-N     TO O-DIV-PAY-DT (I).
    2373    DRP-EXIT.           EXIT.
    2374  * 
    2375  * ********************************************************
    2376  * 
    2377    TRANS-DT-FIX   SECTION.
    2378    TRANS-DT-FIX-PARA.
    2379       IF WS-D-MM EQUAL TO  99    MOVE  9999  TO WS-D-YYYY
    2380                  ADD 90 TO WS-D-YY
    2381                  GO TO TDF-EXIT.
    2382       ADD 70 TO WS-D-YY.
    2383       MOVE 0 TO ITN-CNT.
    2384    ONEDIG-DT-ADJ.
    2385       IF ITN-CNT GREATER 6 MOVE +19 TO M PERFORM WRITE-MESS
    2386              PERFORM CLOSE-FILES
    2387              STOP RUN.
    2388       COMPUTE WS-D-YYYY =    (WS-D-YY + 1900).
    2389       IF WS-D-YYYY LESS 1970 ADD 100 TO WS-D-YYYY.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-46
    NUMCK.CBL    18-APR-77  20:21

    2390       COMPUTE WS-M-CNT =    (WS-D-YYYY * 12 + WS-D-MM).
    2391       IF (TD-M-CNT - WS-M-CNT) LESS 12 NEXT SENTENCE
    2392       ELSE            ADD 10 TO WS-D-YY
    2393               ADD 1  TO ITN-CNT
    2394               GO TO ONEDIG-DT-ADJ.
    2395    TDF-EXIT.           EXIT.
    2396  * 
    2397  * ********************************************************
    2398  * 
    2399    END-OF-OUTPUT-NINES SECTION.
    2400    END-OF-OUTPUT-NINES-PARA.
    2401       DIVIDE BLK-SZ INTO W-OUTP-CNT GIVING FT-BLK REMAINDER PT-BLK
    2402       ON SIZE ERROR DISPLAY W-OUTP-CNT.
    2403       SUBTRACT PT-BLK FROM BLK-SZ GIVING NO-9BLKS
    2404        ON SIZE ERROR DISPLAY NO-9BLKS.
    2405       PERFORM W-NINES-OUT NO-9BLKS TIMES.
    2406  * 
    2407  * ********************************************************
    2408  * 
    2409    W-NINES-OUT SECTION.
    2410    W-NINES-OUT-PARA.
    2411       WRITE OUTP216-REC FROM W-NINES.
	       ^

***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2412  * 
    2413  * ********************************************************
    2414  * 
    2415    OUTREC-INIT SECTION.
    2416    OUTREC-INIT-PARA.
    2417  *   SETS PREVIOUS TRADE DATE,
    2418  *   INITIALIZES DIVIDEND OR BOND ENTRY CODES.
    2419  * 
    2420       IF O-TRD-TYPE NOT < '0' AND O-TRD-TYPE < '8' OR
    2421      ((O-TRD-TYPE EQUAL TO '8')  AND
    2422          (O-X-CD EQUAL TO 'G' OR 'H' OR 'I' OR 'N' OR
    2423                   'O' OR 'P' OR 'S' OR 'U' OR
    2424                   'W' OR 'X' OR 'Y'))
    2425  *  IF THE PREVIOUS PRICE WAS NOT A MODEL PRICE OR BID ASK QUOTE,
    2426  *  OR IT WAS A BID ASK QUOTE FROM A BID/ASK TYPE EXCHANGE,
    2427  *  THEN SAVE THE PRICE DATE FOR LATER USE AS THE
    2428  *  PREVIOUS TRADE DATE
    2429      MOVE O-PRICE-DT TO FIX-FST
    2430      IF TD-MM EQUAL TO 1 AND T-PR-MM EQUAL TO 12
    2431         COMPUTE D-YY =    TD-YY - 1
    2432         MOVE FIX-DT   TO HOLD-LAST-TRDNDT
    2433      ELSE
    2434         MOVE TD-YY TO D-YY
    2435         MOVE FIX-DT TO HOLD-LAST-TRDNDT
    2436       ELSE
    2437  *  PREVIOUS PRICING DATA WAS NOT TRADE, SO KEEP OLD LAST TRADE DATE
    2438      MOVE O-LAST-TDT TO HOLD-LAST-TRDNDT.
    2439  
    2440       IF (O-X-CD EQUAL TO 'G') GO TO OI-EXIT.
    2441       IF (O-X-CD LESS 'L') OR (O-X-CD EQUAL TO 'U' OR 'V' OR 'R')    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-47
    NUMCK.CBL    18-APR-77  20:21

    2442         IF O-DIV-ECODE (1) NOT EQUAL TO '0'
    2443              MOVE '2' TO O-DIV-ECODE (1)
    2444              IF O-DIV-ECODE (2) NOT EQUAL TO '0'
    2445               MOVE '2' TO O-DIV-ECODE (2)
    2446               GO TO OI-EXIT
    2447               ELSE GO TO OI-EXIT
    2448        ELSE IF O-DIV-ECODE (2) NOT EQUAL TO '0'
    2449              MOVE '2' TO O-DIV-ECODE (2)
    2450               GO TO OI-EXIT
    2451            ELSE GO TO OI-EXIT
    2452       ELSE NEXT SENTENCE.
    2453       IF O-X-CD EQUAL TO 'Q' GO TO OI-EXIT.
    2454       IF O-BD-ECODE NOT EQUAL TO '4' AND '9' MOVE 2 TO O-BD-ECODE.
    2455    OI-EXIT.           EXIT.
    2456  * 
    2457  * ********************************************************
    2458  * 
    2459    SHOW-QSIP SECTION.
    2460    SHOW-QSIP-PARA.
    2461       MOVE SPACES TO PRINT-REC.
    2462       MOVE ERR-LINE TO PRINT-MESS.
    2463       WRITE PRINT-REC AFTER ADVANCING 2 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2464       MOVE O-X-QSIP TO ERR-O-QSIP.
    2465       MOVE U-X-QSIP TO ERR-U-QSIP.
    2466       MOVE T-X-QSIP TO ERR-T-QSIP.
    2467       MOVE D-ISSUE-R (P) TO ERR-D-QSIP.
    2468       MOVE ERR-LINE-1 TO PRINT-MESS.
    2469       WRITE PRINT-REC AFTER ADVANCING 1 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2470       MOVE SPACES TO PRINT-REC.
    2471       WRITE PRINT-REC AFTER ADVANCING 2 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2472    S-Q-EXIT.           EXIT.
    2473  * 
    2474  * ********************************************************
    2475  * 
    2476    WRITE-MESS SECTION.
    2477    WRITE-MESS-PARA.
    2478       MOVE MESS (M) TO MESG.
    2479       WRITE PRINT-REC FROM MESS-REC AFTER ADVANCING 1 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-48
    NUMCK.CBL    18-APR-77  20:21

***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2480  * 
    2481  * ********************************************************
    2482  * 
    2483    WRITE-SUMMARY SECTION.
    2484    WRITE-SUMMARY-PARA.
    2485       MOVE SPACES TO PRINT-REC.
    2486       MOVE HEAD-1 TO PRINT-LINE.
    2487       WRITE PRINT-REC AFTER ADVANCING NEXT-PAGE.
	                                       ^

***				FATAL - IDENTIFIER, NUMERIC LITERAL, OR MNEMONIC-NAME EXPECTED

    2488       MOVE DASHES TO PRINT-LINE.
    2489       WRITE PRINT-REC AFTER ADVANCING 1 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2490       MOVE SPACES TO PRINT-LINE.
    2491       MOVE HDR-1 TO PRINT-MESS.
    2492       WRITE PRINT-REC AFTER ADVANCING 7 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2493       MOVE HDR-REC TO PRINT-MESS.
    2494       WRITE PRINT-REC AFTER ADVANCING 2 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2495       MOVE LAST-T-REC TO PRINT-MESS.
    2496       WRITE PRINT-REC AFTER ADVANCING 2 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2497       MOVE LAST-U-REC TO PRINT-MESS.
    2498       WRITE PRINT-REC AFTER ADVANCING 2 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2499       MOVE LAST-O-REC TO PRINT-MESS.
    2500       WRITE PRINT-REC AFTER ADVANCING 2 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-49
    NUMCK.CBL    18-APR-77  20:21


    2501       MOVE LINE-2 TO PRINT-LINE.
    2502       WRITE PRINT-REC AFTER ADVANCING 5 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2503       MOVE W-OLDTP-CNT TO TOT-OLD.
    2504       MOVE W-UPD-CNT   TO TOT-UPD.
    2505       MOVE W-TRANS-CNT TO TOT-TRANS.
    2506       MOVE W-OUTP-CNT  TO TOT-OUT.
    2507       MOVE TOT-LINE TO PRINT-LINE.
    2508       WRITE PRINT-REC AFTER ADVANCING 2 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2509       MOVE SPACES TO PRINT-LINE.
    2510       MOVE LINE-3 TO PRINT-LINE.
    2511       WRITE PRINT-REC AFTER ADVANCING 5 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2512       MOVE 'ADDITIONS      ' TO PT-TYPE.
    2513       MOVE SC-CNT TO OUT-PT.
    2514       PERFORM PT-PRINT.
    2515       MOVE 'CAP CHANGES    ' TO PT-TYPE.
    2516       MOVE CR-CNT   TO OUT-PT.
    2517       PERFORM PT-PRINT.
    2518       MOVE 'STATUS CHANGES ' TO PT-TYPE.
    2519       MOVE SCNG-CNT TO OUT-PT.
    2520       PERFORM PT-PRINT.
    2521       MOVE 'STAT CONTINUES ' TO PT-TYPE.
    2522       MOVE CONT-CNT TO OUT-PT.
    2523       PERFORM PT-PRINT.
    2524       MOVE SUB-HEAD TO PRINT-MESS.
    2525       WRITE PRINT-REC AFTER ADVANCING 4 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2526       MOVE 'ADDS-NO DESC' TO PT-TYPE.
    2527       MOVE NSC-CNT TO OUT-PT.
    2528       PERFORM PT-PRINT.
    2529       MOVE 'PRICES     ' TO PT-TYPE.
    2530       MOVE PR-CNT TO OUT-PT.
    2531       PERFORM PT-PRINT.
    2532       MOVE 'OPTION BID/ASKS' TO PT-TYPE.
    2533       MOVE BA-CNT TO OUT-PT.
    2534       PERFORM PT-PRINT.
    2535       MOVE 'FUTURES OPENINT' TO PT-TYPE.    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-50
    NUMCK.CBL    18-APR-77  20:21

    2536       MOVE OI-CNT TO OUT-PT.
    2537       PERFORM PT-PRINT.
    2538       MOVE 'REG BONDS      ' TO PT-TYPE.
    2539       MOVE RB-CNT TO OUT-PT.
    2540       PERFORM PT-PRINT.
    2541       MOVE 'DIVIDENDS      '  TO PT-TYPE.
    2542       MOVE DR-CNT TO OUT-PT.
    2543       PERFORM PT-PRINT.
    2544       MOVE 'BOND CALLS    '  TO PT-TYPE.
    2545       MOVE CL-CNT TO OUT-PT.
    2546       PERFORM PT-PRINT.
    2547       MOVE 'ZERO PRICE DATA'  TO PT-TYPE.
    2548       MOVE BADPR-CNT TO OUT-PT.
    2549       PERFORM PT-PRINT.
    2550       MOVE SPACES TO PRINT-REC.
    2551       MOVE SUB-HEAD-1 TO PRINT-MESS.
    2552       WRITE PRINT-REC AFTER ADVANCING 4 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2553       MOVE 'PURGES     '  TO PT-TYPE.
    2554       MOVE P-CNT TO OUT-PT.
    2555       PERFORM PT-PRINT.
    2556       MOVE SPACES TO PRINT-REC.
    2557       MOVE SUB-HEAD-2 TO PRINT-MESS.
    2558       WRITE PRINT-REC AFTER ADVANCING 4 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2559       MOVE PART-TOT-1 TO PRINT-LINE.
    2560       WRITE PRINT-REC AFTER ADVANCING 1 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2561       MOVE 'WITHOUT DESCRP ' TO PT-TYPE.
    2562       MOVE NO-DESCRIP-CNT TO OUT-PT.
    2563       PERFORM PT-PRINT.
    2564  * 
    2565  * ********************************************************
    2566  * 
    2567    PT-PRINT SECTION.
    2568    PT-PRINT-PARA.
    2569       MOVE PART-TOT TO PRINT-MESS.
    2570       WRITE PRINT-REC AFTER ADVANCING 1 LINES.
	       ^

***				FATAL - 'ADVANCING' ALLOWED ONLY ON SEQUENTIAL FILES
***				FATAL - 'INVALID KEY' CLAUSE REQUIRED

    2571  * ********************************************************    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE 1-51
    NUMCK.CBL    18-APR-77  20:21

    2572  * ****************** END OF PROGRAM **********************
    2573  * ********************************************************    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE W-1
    NUMCK.CBL    18-APR-77  20:21

WARNINGS:

    0564  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0833  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0843  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0868  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0873  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    0907  REDEFINITION IS NOT THE SAME SIZE AS THE REDEFINED ITEM
    1070  MOST SIGNIFICANT DIGITS TRUNCATED ON TD-M-CNT
    1285  RIGHT-MOST TRUNCATION ON O-DATA
    1368  RIGHT-MOST TRUNCATION ON OUTP-REC
    1372  RIGHT-MOST TRUNCATION ON OUT-DESC-SAVE
    1404  MOST SIGNIFICANT DIGITS TRUNCATED ON O-ADJ-PREV-CLOSE
    1404  LEAST SIGNIFICANT DIGITS TRUNCATED ON O-ADJ-PREV-CLOSE
    1440  MOST SIGNIFICANT DIGITS TRUNCATED ON O-BD-CUR-YLD
    1515  MOST SIGNIFICANT DIGITS TRUNCATED ON O-ADJ-PREV-CLOSE
    1515  LEAST SIGNIFICANT DIGITS TRUNCATED ON O-ADJ-PREV-CLOSE
    1601  MOST SIGNIFICANT DIGITS TRUNCATED ON O-IAD
    1615  MOST SIGNIFICANT DIGITS TRUNCATED ON O-SHRS-OUT
    1892  MOST SIGNIFICANT DIGITS TRUNCATED ON TEMP-PRCS
    1896  MOST SIGNIFICANT DIGITS TRUNCATED ON O-CLOSE4
    1896  LEAST SIGNIFICANT DIGITS TRUNCATED ON O-CLOSE4
    1897  MOST SIGNIFICANT DIGITS TRUNCATED ON O-HIGH4
    1897  LEAST SIGNIFICANT DIGITS TRUNCATED ON O-HIGH4
    1898  MOST SIGNIFICANT DIGITS TRUNCATED ON O-LOW4
    1898  LEAST SIGNIFICANT DIGITS TRUNCATED ON O-LOW4
    1900  LEAST SIGNIFICANT DIGITS TRUNCATED ON O-CLOSE
    1901  MOST SIGNIFICANT DIGITS TRUNCATED ON O-HIGH
    1901  LEAST SIGNIFICANT DIGITS TRUNCATED ON O-HIGH
    1902  MOST SIGNIFICANT DIGITS TRUNCATED ON O-LOW
    1902  LEAST SIGNIFICANT DIGITS TRUNCATED ON O-LOW
    2003  MOST SIGNIFICANT DIGITS TRUNCATED ON VOL-TEMP
    2010  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-CLOSE-INT
    2018  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-LOW-INT
    2048  MOST SIGNIFICANT DIGITS TRUNCATED ON TEMP-CLOSE
    2049  MOST SIGNIFICANT DIGITS TRUNCATED ON TEMP-HIGH
    2050  MOST SIGNIFICANT DIGITS TRUNCATED ON TEMP-LOW
    2056  MOST SIGNIFICANT DIGITS TRUNCATED ON FRAC-32NDS
    2059  MOST SIGNIFICANT DIGITS TRUNCATED ON FRAC-32NDS
    2062  MOST SIGNIFICANT DIGITS TRUNCATED ON FRAC-32NDS
    2080  MOST SIGNIFICANT DIGITS TRUNCATED ON TEMP-CLOSE
    2082  MOST SIGNIFICANT DIGITS TRUNCATED ON TEMP-HIGH
    2084  MOST SIGNIFICANT DIGITS TRUNCATED ON TEMP-LOW
    2087  MOST SIGNIFICANT DIGITS TRUNCATED ON TEMP-CLOSE
    2089  MOST SIGNIFICANT DIGITS TRUNCATED ON TEMP-HIGH
    2091  MOST SIGNIFICANT DIGITS TRUNCATED ON TEMP-LOW
    2106  MOST SIGNIFICANT DIGITS TRUNCATED ON O-CLOSE
    2106  LEAST SIGNIFICANT DIGITS TRUNCATED ON O-CLOSE
    2107  MOST SIGNIFICANT DIGITS TRUNCATED ON O-HIGH
    2107  LEAST SIGNIFICANT DIGITS TRUNCATED ON O-HIGH
    2108  MOST SIGNIFICANT DIGITS TRUNCATED ON O-LOW
    2108  LEAST SIGNIFICANT DIGITS TRUNCATED ON O-LOW
    2115  MOST SIGNIFICANT DIGITS TRUNCATED ON O-UND-STK-PRICE
    2147  MOST SIGNIFICANT DIGITS TRUNCATED ON TEMP-BID
    2149  MOST SIGNIFICANT DIGITS TRUNCATED ON TEMP-ASK
    2152  MOST SIGNIFICANT DIGITS TRUNCATED ON TEMP-BID    P R O G R A M   P D 		COBOL 100A(370001)	 3-OCT-88  13:37		PAGE W-2
    NUMCK.CBL    18-APR-77  20:21

    2154  MOST SIGNIFICANT DIGITS TRUNCATED ON TEMP-ASK
    2390  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-M-CNT
    2479  RIGHT-MOST TRUNCATION ON MESS-REC


74 FATAL ERRORS, 74 WARNINGS
  j 