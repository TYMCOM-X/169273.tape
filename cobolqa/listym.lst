    P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 1
    LISTYM.CBL    19-NOV-65  18:29

    0001  * *********************************************************************
    0002  * 
    0003  * 	INVENTORY SYSTEM LISTING ROUTINES
    0004  * 
    0005  * *********************************************************************
    0006  
    0007    IDENTIFICATION DIVISION.
    0008    PROGRAM-ID. LISTYM.
    0009    AUTHOR. JIM WESTLAKE.
    0010    REMARKS. LIST ROUTINES FOR INVENTORY SYSTEM.
    0011  
    0012    ENVIRONMENT DIVISION.
    0013    CONFIGURATION SECTION.
    0014    SPECIAL-NAMES.
    0015  	CHANNEL (1) IS TOP.
    0016  
    0017    INPUT-OUTPUT SECTION.
    0018    FILE-CONTROL.
    0019  	SELECT MAST-FILE ASSIGN TO DSK
    0020  	ACCESS MODE IS INDEXED
    0021  	SYMBOLIC KEY IS M-KEY
    0022  	RECORD KEY IS M-REC-KEY
    0023  	RECORDING MODE IS SIXBIT.
    0024  
    0025  	SELECT SITE-FILE ASSIGN TO DSK
    0026  	ACCESS MODE IS INDEXED
    0027  	SYMBOLIC KEY IS S-KEY
    0028  	RECORD KEY IS S-REC-KEY
    0029  	RECORDING MODE IS SIXBIT.
    0030  
    0031  	SELECT NAME-FILE ASSIGN TO DSK
    0032  	ACCESS MODE IS INDEXED
    0033  	SYMBOLIC KEY IS N-KEY
    0034  	RECORD KEY IS N-SITE-NO
    0035  	RECORDING MODE IS SIXBIT.
    0036  
    0037  	SELECT HIST-FILE ASSIGN TO DSK
    0038  	ACCESS MODE IS INDEXED
    0039  	SYMBOLIC KEY IS H-KEY
    0040  	RECORD KEY IS H-REC-KEY
    0041  	RECORDING MODE IS SIXBIT.
    0042  
    0043  	SELECT LIST-FILE ASSIGN  TO DSK
    0044  	ACCESS MODE IS SEQUENTIAL
    0045  	RECORDING MODE IS ASCII.
    0046  
    0047  	SELECT LIST-SORT ASSIGN TO DSK DSK DSK DSK DSK DSK.
    0048  
    0049  	SELECT HIST-SORT ASSIGN TO DSK DSK DSK DSK DSK DSK.
    0050      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 2
    LISTYM.CBL    19-NOV-65  18:29

    0051  * *********************************************************************
    0052  * 
    0053  * 	F I L E     D E S C R I P T I O N S
    0054  * 
    0055  * *********************************************************************
    0056  
    0057    DATA DIVISION.
    0058    FILE SECTION.
    0059  
    0060    FD	MAST-FILE
    0061  	COPY FDMAST.
    0062C       BLOCK CONTAINS 8 RECORDS 
    0063C       RECORD CONTAINS 90 CHARACTERS 
    0064C       LABEL RECORDS ARE STANDARD 
    0065C       VALUE OF IDENTIFICATION IS 'TYM10MIDX'.
    0066C   01  MAST-REC.
    0067C       02      M-REC-KEY.
    0068C         04    M-REC-PN-PL.
    0069C           06  M-PARTNO        PIC X(11).
    0070C           06  M-PL            PIC X.
    0071C       02      M-FLAG          PIC X.
    0072C       02      M-CREF          PIC X.
    0073C       02      M-DESC.
    0074C         04    M-CREF-SEE      PIC X(4).
    0075C         04    M-CREF-PN-PL.
    0076C           06  M-CREF-PARTNO   PIC X(11).
    0077C           06  M-CREF-PL       PIC X.
    0078C         04    FILLER          PIC X(5).
    0079C       02      M-VC            PIC X(2).
    0080C       02      M-VPN           PIC X(14).
    0081C       02      M-REV-CREF.
    0082C         04    M-REV-CREF-PN   PIC X(11).
    0083C         04    M-REV-CREF-PL   PIC X.
    0084C       02      M-PRICE         PIC 9999V99.
    0085C       02      M-RR            PIC X.
    0086C       02      M-REC-QUAN      PIC 9(4).
    0087C       02      M-OPT           PIC X(10).
    0088C       02      M-SITES         PIC 999.
    0089C       02      FILLER          PIC X(3).
    0090                    
    0091    FD	SITE-FILE
    0092  	COPY FDSITE.
    0093C       BLOCK CONTAINS 18 RECORDS 
    0094C       RECORD CONTAINS 36 CHARACTERS 
    0095C       LABEL RECORDS ARE STANDARD 
    0096C       VALUE OF IDENTIFICATION IS 'TYM10SIDX'.
    0097C   01  SITE-REC.
    0098C       02      S-REC-KEY.
    0099C         04    S-SITE-NO       PIC 99.
    0100C         04    S-PARTNO        PIC X(11).
    0101C         04    S-REC-NO        PIC 9.
    0102C       02      S-LOC           PIC X(5).
    0103C       02      S-MAX           PIC 9999.
    0104C       02      S-ON-HAND       PIC 9999.
    0105C       02      S-FLAG          PIC X.
    0106C       02      S-ON-ORDER      PIC 9999.    P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 2-1
    LISTYM.CBL    19-NOV-65  18:29

    0107C       02      FILLER          PIC X(4).
    0108C   01  SITE-REC-A.
    0109C       02      FILLER          PIC X(14).
    0110C       02      S-ORD-NO        PIC 9999.
    0111C       02      S-ORD-QUAN      PIC 9999.
    0112C       02      S-REQ-NO        PIC 9(5).
    0113C       02      FILLER          PIC X(9).
    0114                    
    0115      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 3
    LISTYM.CBL    19-NOV-65  18:29

    0116    FD	HIST-FILE
    0117  	COPY FDHIST.
    0118C       BLOCK CONTAINS 21 RECORDS 
    0119C       RECORD CONTAINS 30 CHARACTERS 
    0120C       VALUE OF IDENTIFICATION IS 'TYM10HIDX'.
    0121C   01  HIST-REC.
    0122C       02      H-REC-KEY.
    0123C         04    H-REC-PN-PL.
    0124C           06  H-PARTNO        PIC X(11).
    0125C           06  H-PL            PIC X.
    0126C         04    H-ENTRY-NO      PIC 9999.
    0127C       02      H-SITE-NO       PIC 99.
    0128C       02      H-QUAN          PIC 9999.
    0129C       02      H-DATE          PIC 9999.
    0130C       02      H-XFER          PIC X.
    0131C       02      H-XFER-SITE     PIC 99.
    0132C       02      FILLER          PIC X.
    0133                    
    0134  
    0135    FD	NAME-FILE
    0136  	COPY FDNAME.
    0137C       BLOCK CONTAINS 5 RECORDS 
    0138C       RECORD CONTAINS 150 CHARACTERS 
    0139C       LABEL RECORDS ARE STANDARD 
    0140C       VALUE OF IDENTIFICATION IS 'TYM10NIDX'.
    0141C   01  NAME-REC.
    0142C       02      N-SITE-NO       PIC 99.
    0143C       02      FILLER          PIC X.
    0144C       02      N-NAME          PIC X(30).
    0145C       02      N-ADRS-1        PIC X(30).
    0146C       02      N-ADRS-2        PIC X(30).
    0147C       02      N-CITY          PIC X(24).
    0148C       02      N-ZIP           PIC 9(5).
    0149C       02      N-PHONE.
    0150C         04    N-AC            PIC 9(3).
    0151C         04    N-PHO.
    0152C           06  N-PHO-1         PIC 999.
    0153C           06  N-PHO-2         PIC 9999.
    0154C       02      N-PL            PIC X.
    0155C       02      N-PASS.
    0156C         04    N-PASS-1        PIC X(6).
    0157C         04    N-PASS-2        PIC X(6).
    0158C       02      N-LOCK          PIC 9.
    0159C       02      N-ORD-FM        PIC 99.
    0160C       02      FILLER          PIC XX.
    0161                    
    0162      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 4
    LISTYM.CBL    19-NOV-65  18:29

    0163    FD	LIST-FILE
    0164  	BLOCK CONTAINS 4 RECORDS
    0165  	RECORD CONTAINS 132 CHARACTERS
    0166  	VALUE OF IDENTIFICATION IS LIST-FILE-NAME.
    0167  
    0168    01	LIST-REC.
    0169  	02	L-PARTNO	PIC X(12).
    0170  	02	FILLER		PIC X(2).
    0171  	02	L-DESC		PIC X(21).
    0172  	02	FILLER		PIC X(3).
    0173  	02	L-VC		PIC X(2).
    0174  	02	FILLER		PIC X(2).
    0175  	02	L-VPN		PIC X(14).
    0176  	02	FILLER		PIC X(3).
    0177  	02	L-LOC		PIC X(5).
    0178  	02	FILLER		PIC X(3).
    0179  	02	L-MAX		PIC Z(4).
    0180  	02	FILLER		PIC X(2).
    0181  	02	L-ON-HAND	PIC Z(4).
    0182  	02	FILLER		PIC X(2).
    0183  	02	L-FLAG		PIC X(2).
    0184  	02	FILLER		PIC X(3).
    0185  	02	L-ORDER-INFO.
    0186  	  04	L-ORD-NO	PIC 9(4).
    0187  	  04	FILLER		PIC X(2).
    0188  	  04	L-ORD-QUAN	PIC ZZZ9.
    0189  	  04	FILLER		PIC X(3).
    0190  	  04	L-ORD-DATE	PIC X(8).
    0191  	02	FILLER		PIC X(3).
    0192  	02	L-OPT		PIC X(10).
    0193  	02	FILLER		PIC X(2).
    0194  	02	L-SITE-PARTNO	PIC X(11).
    0195  	02	FILLER		PIC X.
    0196  
    0197    01	PRICE-LIST-REC.
    0198  	02	PL-PARTNO	PIC X(11).
    0199  	02	FILLER		PIC X(3).
    0200  	02	PL-DESC		PIC X(21).
    0201  	02	FILLER		PIC X(3).
    0202  	02	PL-VC		PIC X(2).
    0203  	02	FILLER		PIC X(2).
    0204  	02	PL-VPN		PIC X(14).
    0205  	02	FILLER		PIC X(3).
    0206  	02	PL-LOC		PIC X(5).
    0207  	02	FILLER		PIC X(3).
    0208  	02	PL-MAX		PIC Z(4).
    0209  	02	FILLER		PIC X(2).
    0210  	02	PL-ON-HAND	PIC Z(4).
    0211  	02	FILLER		PIC X(5).
    0212  	02	PL-PRICE	PIC ZZ,ZZZ.ZZ.
    0213  	02	FILLER		PIC X(4).
    0214  	02	PL-PRICE-EXT	PIC Z,ZZZ,ZZZ.ZZ.
    0215      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 5
    LISTYM.CBL    19-NOV-65  18:29

    0216  * *****************************
    0217  * 	LIST REC'S (CONT)
    0218  * *****************************
    0219  
    0220    01	ORDER-LIST-REC.
    0221  	02	ORD-PARTNO	PIC X(11).
    0222  	02	FILLER		PIC X(2).
    0223  	02	ORD-MAST	PIC X(12).
    0224  	02	FILLER		PIC X(2).
    0225  	02	ORD-DESC	PIC X(21).
    0226  	02	FILLER		PIC X(2).
    0227  	02	ORD-VC		PIC X(2).
    0228  	02	FILLER		PIC X(2).
    0229  	02	ORD-VPN		PIC X(14).
    0230  	02	FILLER		PIC X(2).
    0231  	02	ORD-MAX		PIC Z(4).
    0232  	02	FILLER		PIC X(2).
    0233  	02	ORD-ON-HAND	PIC Z(4).
    0234  	02	FILLER		PIC X(4).
    0235  	02	ORD-QUAN	PIC Z(4).
    0236  	02	FILLER		PIC X(3).
    0237  	02	ORD-AVAIL	PIC Z(4).
    0238  	02	FILLER		PIC X(2).
    0239  	02	ORD-FLAG	PIC X(3).
    0240  	02	FILLER		PIC X(2).
    0241  	02	ORD-ORD-NO	PIC 9(4).
    0242  	02	FILLER		PIC X(2).
    0243  	02	ORD-ORD-DATE	PIC X(8).
    0244      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 6
    LISTYM.CBL    19-NOV-65  18:29

    0245  * *****************************
    0246  * 	LIST REC'S (CONT)
    0247  * *****************************
    0248  
    0249    01	USE-LIST-REC.
    0250  	02	U-PARTNO	PIC X(12).
    0251  	02	FILLER		PIC X(2).
    0252  	02	U-DESC		PIC X(21).
    0253  	02	FILLER		PIC X(2).
    0254  	02	U-VC		PIC X(2).
    0255  	02	FILLER		PIC X(2).
    0256  	02	U-VPN		PIC X(14).
    0257  	02	FILLER		PIC X(2).
    0258  	02	U-SITE-MAX	PIC Z(4).
    0259  	02	U-FLAG		PIC X.
    0260  	02	FILLER		PIC X(2).
    0261  	02	U-PCT-6		PIC Z(4).
    0262  	02	U-PCT-X		PIC X.
    0263  	02	FILLER		PIC X(2).
    0264  	02	U-PRICE		PIC ZZ,ZZZ.99.
    0265  	02	FILLER		PIC X(5).
    0266  	02	U-USE-12	PIC ZZZZZ.
    0267  	02	FILLER		PIC X(2).
    0268  	02	U-UP-12		PIC ZZZ,ZZZ.99.
    0269  	02	FILLER		PIC X(2).
    0270  	02	U-USE-6		PIC ZZZZZ.
    0271  	02	FILLER		PIC X(2).
    0272  	02	U-UP-6		PIC ZZZ,ZZZ.99.
    0273  	02	FILLER		PIC X(2).
    0274  	02	U-CHANGE.
    0275  	  04	U-CHG-SIGN	PIC X.
    0276  	  04	U-CHG-QUAN	PIC ZZZZ.
    0277  	  04	U-CHG-PCT-SIGN	PIC X.
    0278      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 7
    LISTYM.CBL    19-NOV-65  18:29

    0279  * *****************************
    0280  * 	LIST REC'S (CONT)
    0281  * *****************************
    0282  
    0283    01	MAST-LIST-REC.
    0284  	02	ML-PARTNO	PIC X(12).
    0285  	02	FILLER		PIC X(3).
    0286  	02	ML-DESC		PIC X(21).
    0287  	02	FILLER		PIC X(3).
    0288  	02	ML-VC		PIC X(2).
    0289  	02	FILLER		PIC X(2).
    0290  	02	ML-VPN		PIC X(14).
    0291  	02	FILLER		PIC X(3).
    0292  	02	ML-SITES	PIC Z(3).
    0293  	02	FILLER		PIC X(3).
    0294  	02	ML-PRICE	PIC ZZZZ.99.
    0295  	02	FILLER		PIC X(3).
    0296  	02	ML-RR		PIC X.
    0297  	02	FILLER		PIC X(3).
    0298  	02	ML-OPT		PIC X(10).
    0299  	02	FILLER		PIC X(4).
    0300  	02	ML-REC-QUAN	PIC Z(4).
    0301  	02	FILLER		PIC X(3).
    0302  	02	ML-REV-CREF	PIC X(12).
    0303  	02	FILLER		PIC X(3).
    0304  	02	ML-FLAG		PIC X.
    0305  	02	ML-CREF		PIC X.
    0306      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 8
    LISTYM.CBL    19-NOV-65  18:29

    0307  * *****************************
    0308  * 	SORT RECORDS
    0309  * *****************************
    0310  
    0311    SD	LIST-SORT.
    0312    01	LIST-SORT-REC.
    0313  	02	LS-PARTNO.
    0314  	  04	LS-PN		PIC X(11).
    0315  	  04	LS-PL		PIC X.
    0316  	02	LS-SITE-PARTNO	PIC X(11).
    0317  	02	LS-DESC		PIC X(21).
    0318  	02	LS-VC		PIC X(2).
    0319  	02	LS-VPN		PIC X(14).
    0320  	02	LS-OPT		PIC X(10).
    0321  	02	LS-LOC		PIC X(5).
    0322  	02	LS-FLAG		PIC X.
    0323  
    0324  
    0325    SD	HIST-SORT.
    0326    01	HIST-SORT-REC.
    0327  	02	HS-KEY.
    0328  	  04	HS-SITE-NO	PIC 99.
    0329  	  04	HS-REC-PN-PL.
    0330  	    06	HS-PARTNO	PIC X(11).
    0331  	    06	HS-PL		PIC X.
    0332  	02	HS-QUAN		PIC 9999.
    0333  	02	HS-DATE		PIC 9999.
    0334  	02	HS-XFER		PIC X.
    0335  	02	HS-XFER-SITE	PIC 99.
    0336      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 9
    LISTYM.CBL    19-NOV-65  18:29

    0337  * *********************************************************************
    0338  * 
    0339  * 	W O R K I N G     S T O R A G E 
    0340  * 
    0341  * *********************************************************************
    0342  
    0343    WORKING-STORAGE SECTION.
    0344  * *****************************
    0345  * 	ACCUMULATORS
    0346  * *****************************
    0347    77	I		PIC 99   USAGE COMP.
    0348    77	X		PIC 9999 USAGE COMP.
    0349    77	Y		PIC 9999 USAGE COMP.
    0350    77	Z		PIC 9999 USAGE COMP.
    0351  
    0352    77	WS-LINE			PIC 999 USAGE COMP.
    0353    01	WS-PAGE			PIC 999.
    0354    01	WS-PRICE-EXT		PIC 99999V99.
    0355    01	WS-SITE-TOTAL		PIC 9999999V99.
    0356    01	WS-GRAND-TOTAL		PIC 9999999V99.
    0357  
    0358    01	USE-TOTALS.
    0359  	02	USE-12			PIC 9999.
    0360  	02	USE-12-TOT		PIC 99999.
    0361  	02	USE-12P-TOT		PIC 999999V99.
    0362  	02	USE-6			PIC 9999.
    0363  	02	USE-6-TOT		PIC 99999.
    0364  	02	USE-6P-TOT		PIC 999999V99.
    0365  	02	USE-F6			PIC 9999.
    0366  	02	USE-CHG			PIC 9999V99.
    0367  	02	USE-SITE-PCT	PIC 9999V99.
    0368    01	USE-SIGN		PIC X.
    0369  
    0370  
    0371  * *****************************
    0372  * 	ISAM FILE KEYS
    0373  * *****************************
    0374  
    0375    01	S-KEY.
    0376  	02	S-K-SITE-NO	PIC 99.
    0377  	02	S-K-PARTNO	PIC X(11).
    0378  	02	S-K-REC-NO	PIC 9.
    0379  
    0380    01	H-KEY.
    0381  	02	H-K-PN-PL.
    0382  	  04	H-K-PARTNO	PIC X(11).
    0383  	  04	H-K-PL		PIC X.
    0384  	02	H-K-ENTRY-NO	PIC 9999.
    0385  
    0386    01	M-KEY.
    0387  	02	M-K-PN-PL.
    0388  	  04	M-K-PARTNO	PIC X(11).
    0389  	  04	M-K-PL		PIC X.
    0390  
    0391    01	N-KEY			PIC 99.
    0392      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 10
    LISTYM.CBL    19-NOV-65  18:29

    0393  * *****************************
    0394  * 	CONTROL & RESPONSE LOC'S
    0395  * *****************************
    0396  
    0397    01	WS-MACRO-ARG.
    0398  	02	WS-MACRO-ARG-1.
    0399  	  04	FILLER		PIC X(5) USAGE DISPLAY-6.
    0400  	  04	WS-MACRO-ARG-N	PIC X    USAGE DISPLAY-6.
    0401  	02	WS-MACRO-ARG-2.
    0402  	  04	FILLER		PIC X(5) USAGE DISPLAY-6.
    0403  	  04	WS-MACRO-ARG-EN	PIC X    USAGE DISPLAY-6.
    0404    01	WS-ENA			PIC 9.
    0405    01	WS-ANS			PIC X.
    0406    01	RET-CODE		PIC 9.
    0407    01	WS-PARTNO		PIC X(11).
    0408    01	WS-QUAN			PIC S9999.
    0409    01	WS-ORD-NO		PIC 9999.
    0410    01	WS-LIST-FLAG		PIC X.
    0411  
    0412    01	AGE-12.
    0413  	02	AGE-12-YEAR	PIC 9.
    0414  	02	AGE-12-DAY	PIC 999.
    0415    01	AGE-6.
    0416  	02	AGE-6-YEAR	PIC 9.
    0417  	02	AGE-6-DAY	PIC 999.
    0418      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 11
    LISTYM.CBL    19-NOV-65  18:29

    0419  * *****************************
    0420  * 	LISTING CONTROL LOC'S
    0421  * *****************************
    0422  
    0423    01	LIST-FILE-NAME.
    0424  	02	WS-LIST-NAME.
    0425  	  04	WS-LIST-NAME-1	PIC X(4).
    0426  	  04	WS-LIST-NAME-2	PIC 99.
    0427  	02	WS-LIST-EXT	PIC X(3)  VALUE 'LST'.
    0428    01	WS-LIST-OPT-STRING.
    0429  	02	WS-LIST-OPT-OUT		PIC X.
    0430  	02	WS-LIST-OPT-REST	PIC X(9).
    0431  
    0432    01	WS-LIST-SORT-ALL.
    0433  	02	WS-LIST-PARTNO		PIC X.
    0434  	02	WS-LIST-DESC		PIC X.
    0435  	02	WS-LIST-OPT		PIC X.
    0436  	02	WS-LIST-LOC		PIC X.
    0437  	02	WS-LIST-VC		PIC X.
    0438    01	WS-LIST-SORT-1 REDEFINES WS-LIST-SORT-ALL.
    0439  	02	WS-LIST-SORT		PIC X OCCURS 5 TIMES.
    0440  
    0441    01	WS-LIST-CREF-ALL.
    0442  	02	WS-LIST-CREF		PIC X OCCURS 5 TIMES.
    0443  
    0444    01	WS-LIST-ZERO-ALL.
    0445  	02	WS-LIST-ZERO		PIC X OCCURS 5 TIMES.
    0446  
    0447    01	WS-LIST-SITE			PIC XX.
    0448    01	WS-LIST-SITE-NO			PIC 99.
    0449    01	WS-LIST-SITE-NEXT		PIC 99.
    0450    01	WS-LIST-OPT-COUNT		PIC 99.
    0451      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 12
    LISTYM.CBL    19-NOV-65  18:29

    0452  * *****************************
    0453  * 	DATE/TIME CONTROL LOCS.
    0454  * *****************************
    0455    01	WS-TEMP-DATE USAGE DISPLAY-7.
    0456  	02	WSTY		PIC 99.
    0457  	02	WSTM		PIC 99.
    0458  	02	WSTD		PIC 99.
    0459  	02	WSTH		PIC 99.
    0460  	02	WSTMIN		PIC 99.
    0461  	02	WSTSEC		PIC 99.
    0462    01	WS-DATE USAGE DISPLAY-7.
    0463  	02	WS-MONTH	PIC 99.
    0464  	02	FILLER		PIC X VALUE '-'.
    0465  	02	WS-DAY		PIC 99.
    0466  	02	FILLER		PIC X VALUE '-'.
    0467  	02	WS-YEAR.
    0468  		04 WS-YEAR-DIGIT-1	PIC 9.
    0469  		04 WS-YEAR-DIGIT-2	PIC 9.
    0470    01	JULIAN-DATE.
    0471  	02	JULIAN-YEAR	PIC 9.
    0472  	02	JULIAN-DAY	PIC 999.
    0473    01	DATE-TABLE-DA    0474  	02	FILLER		PIC 999 VALUE ZERO.
    0475  	02	FILLER		PIC 999 VALUE 31.
    0476  	02	FILLER		PIC 999 VALUE 59.
    0477  	02	FILLER		PIC 999 VALUE 90.
    0478  	02	FILLER		PIC 999 VALUE 120.
    0479  	02	FILLER		PIC 999 VALUE 151.
    0480  	02	FILLER		PIC 999 VALUE 181.
    0481  	02	FILLER		PIC 999 VALUE 212.
    0482  	02	FILLER		PIC 999 VALUE 243.
    0483  	02	FILLER		PIC 999 VALUE 273.
    0484  	02	FILLER		PIC 999 VALUE 304.
    0485  	02	FILLER		PIC 999 VALUE 334.
    0486  	02	FILLER		PIC 999 VALUE 366.
    0487    01	DATE-TABLE REDEFINES DATE-TABLE-DATA.
    0488  	02	DATE-TBL	PIC 999 OCCURS 13 TIMES.
    0489  
    0490  
    0491  * FOLLOWING TO CONVERT BACK FROM JULIAN DATE
    0492  
    0493    01	WS-JULIAN-DATE.
    0494  	02	WS-CONV-YEAR	PIC 9.
    0495  	02	WS-CONV-DAY	PIC 999.
    0496    01	WS-DATE-OUT.
    0497  	02	WS-MONTH-OUT	PIC 99.
    0498  	02	WS-D-SEP-1	PIC X.
    0499  	02	WS-DAY-OUT	PIC 99.
    0500  	02	WS-D-SEP-2	PIC X.
    0501  	02	WS-YEAR-OUT.
    0502  	  04	WS-YEAR-OUT-1	PIC 9.
    0503  	  04	WS-YEAR-OUT-2	PIC 9.
    0504      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 13
    LISTYM.CBL    19-NOV-65  18:29

    0505  * *********************************************************************
    0506  * 
    0507  * 	LISTING HEADERS
    0508  * 
    0509  * *********************************************************************
    0510  
    0511    01	LIST-HDR-1.
    0512  	02	L-SORT	PIC X(4).
    0513  	02	FILLER		PIC X(2)  VALUE SPACES.
    0514  	02	LIST-CREF	PIC X.
    0515  	02	LIST-ZERO	PIC X.
    0516  	02	FILLER		PIC X(12) VALUE SPACES.
    0517  	02	LIST-DATE	PIC X(8).
    0518  	02	FILLER		PIC X(3)  VALUE '  <'.
    0519  	02	L-JULIAN-DATE	PIC 9(4).
    0520  	02	FILLER		PIC X(10) VALUE '>'.
    0521  	02	LIST-NAME	PIC X(9)  JUSTIFIED RIGHT.
    0522  	02	FILLER		PIC X(13) VALUE ' LISTING FOR '.
    0523  	02	LIST-SITE-NAME	PIC X(30).
    0524  	02	FILLER		PIC X(4)  VALUE '   ('.
    0525  	02	LIST-SITE-NO	PIC 99.
    0526  	02	FILLER		PIC X(21) VALUE ')'.
    0527  	02	FILLER		PIC X(5)  VALUE 'PAGE'.
    0528  	02	L-PAGE		PIC Z(3).
    0529  
    0530    01	LIST-HDR-N		PIC X(132).
    0531  
    0532    01	LIST-HDR-2.
    0533  	02	FILLER		PIC X(20) VALUE 'PART NUMBER   DESCRI'.
    0534  	02	FILLER		PIC X(20) VALUE 'PTION             VC'.
    0535  	02	FILLER		PIC X(20) VALUE '  VPN OR GENERIC'.
    0536  	02	FILLER		PIC X(20) VALUE 'LOC     MAX   O/H  *'.
    0537  	02	FILLER		PIC X(20) VALUE '*   ORD#  QUAN     D'.
    0538  	02	FILLER		PIC X(20) VALUE 'ATE     OPTION      '.
    0539  	02	FILLER		PIC X(12) VALUE 'SITE PARTNO'.
    0540  
    0541    01	LIST-HDR-3.
    0542  	02	FILLER		PIC X(12) VALUE '******'.
    0543  	02	LIST-TOT-LINES	PIC Z(5).
    0544  	02	FILLER		PIC X(17) VALUE ' TOTAL LINE ITEMS'.
    0545  
    0546    01	LIST-HDR-4.
    0547  	02	FILLER		PIC X(20) VALUE 'PART NUMBER   DESCRI'.
    0548  	02	FILLER		PIC X(20) VALUE 'PTION             VC'.
    0549  	02	FILLER		PIC X(20) VALUE '  VPN OR GENERIC'.
    0550  	02	FILLER		PIC X(20) VALUE 'LOC     MAX   O/H'.
    0551  	02	FILLER		PIC X(20) VALUE '     PRICE      EXT '.
    0552  	02	FILLER		PIC X(5)  VALUE 'PRICE'.
    0553  
    0554    01	LIST-HDR-5.
    0555  	02	FILLER		PIC X(20) VALUE '******   GRAND TOTAL'.
    0556      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 14
    LISTYM.CBL    19-NOV-65  18:29

    0557  * *****************************
    0558  * 	LIST HDR'S (CONT)
    0559  * *****************************
    0560  
    0561    01	LIST-HDR-6.
    0562  	02	FILLER		PIC X(20) VALUE 'PART NUMBER*  DESCRI'.
    0563  	02	FILLER		PIC X(20) VALUE 'PTION            VC '.
    0564  	02	FILLER		PIC X(18) VALUE ' VPN OR GENERIC'.
    0565  	02	H6-MAX		PIC X(7)  VALUE 'MAX'.
    0566  	02	H6-PERCENT	PIC X(4)  VALUE 'PCT6'.
    0567  	02	FILLER		PIC X(20) VALUE '      PRICE     12-M'.
    0568  	02	FILLER		PIC X(20) VALUE 'O    PRICE-12   6-MO'.
    0569  	02	FILLER		PIC X(13) VALUE '     PRICE-6'.
    0570  	02	FILLER		PIC X(8)  VALUE '  CHANGE'.
    0571  
    0572    01	LIST-HDR-7.
    0573  	02	FILLER		PIC X(10) VALUE SPACES.
    0574  	02	H7-DATE		PIC X(8).
    0575  	02	FILLER		PIC X(4)  VALUE '   <'.
    0576  	02	H7-JULIAN-DATE	PIC 9(4).
    0577  	02	FILLER		PIC X(20) VALUE '>'.
    0578  	02	FILLER		PIC X(20) VALUE 'TYMAINT INVENTORY - '.
    0579  	02	FILLER		PIC X(20) VALUE 'MASTER FILE LISTING '.
    0580  	02	FILLER		PIC X(20) VALUE SPACES.
    0581  	02	FILLER		PIC X(20) VALUE '                 PAG'.
    0582  	02	FILLER		PIC X(2)  VALUE 'E '.
    0583  	02	H7-PAGE		PIC Z(3).
    0584  
    0585    01	LIST-HDR-8.
    0586  	02	FILLER		PIC X(20) VALUE 'PART NUMBER*   DESCR'.
    0587  	02	FILLER		PIC X(20) VALUE 'IPTION             V'.
    0588  	02	FILLER		PIC X(20) VALUE 'C  VPN OR GENERIC  S'.
    0589  	02	FILLER		PIC X(20) VALUE 'ITES   PRICE    R   '.
    0590  	02	FILLER		PIC X(20) VALUE 'OPTION         REC  '.
    0591  	02	FILLER		PIC X(20) VALUE ' REV CREF P/N  FLGS '.
    0592  
    0593    01	LIST-HDR-9.
    0594  	02	FILLER		PIC X(20) VALUE 'PART NUMBER  MAST PA'.
    0595  	02	FILLER		PIC X(20) VALUE 'RTNO*  DESCRIPTION  '.
    0596  	02	FILLER		PIC X(20) VALUE '          VC  VPN OR'.
    0597  	02	FILLER		PIC X(20) VALUE ' GENERIC   MAX   O/H'.
    0598  	02	FILLER		PIC X(20) VALUE '    QUAN  AVAIL  FLG'.
    0599  	02	H9-BO		PIC X(16) VALUE '  ORD#    DATE  '.
    0600    01	H9-BO-DATA		PIC X(16) VALUE '  ORD#    DATE  '.
    0601  
    0602    01	LIST-HDR-10.
    0603  	02	FILLER		PIC X(7)  VALUE '*****  '.
    0604  	02	H10-LINES	PIC 9(4).
    0605  	02	FILLER		PIC X(12) VALUE ' ORDER LINES'.
    0606      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 15
    LISTYM.CBL    19-NOV-65  18:29

    0607  * *********************************************************************
    0608  * 
    0609  * 	P R O C E D U R E     D I V I S I O N
    0610  * 
    0611  * *********************************************************************
    0612  
    0613    PROCEDURE DIVISION.
    0614  	MOVE SPACES TO WS-MACRO-ARG.
    0615  	ENTER MACRO INVINI USING WS-MACRO-ARG.
    0616  	IF WS-MACRO-ARG-1 NOT = 'RUN' OR WS-MACRO-ARG-EN NOT NUMERIC
    0617  		ENTER MACRO LOGOFF.
    0618  	MOVE WS-MACRO-ARG-EN TO WS-ENA.
    0619  	DISPLAY 'INVENTORY LISTING ROUTINES'.
    0620  	PERFORM DATE.
    0621  	DISPLAY WS-DATE '	<' JULIAN-DATE '>'.
    0622  	DISPLAY ' '.
    0623  
    0624    PROC.
    0625  	DISPLAY 'PROCEDURE: ' WITH NO ADVANCING.
    0626  	ACCEPT WS-ANS.
    0627  	IF WS-ANS = 'A' GO TO MASTER-LIST;
    0628  	ELSE, IF WS-ANS = 'B' GO TO BACKORDER-LIST;
    0629  	ELSE, IF WS-ANS = 'E' OR WS-ANS = 'Q'
    0630  		ENTER MACRO MONITR;
    0631  	ELSE, IF WS-ANS = 'H' GO TO USAGE-LIST;
    0632  	ELSE, IF WS-ANS = 'I' GO TO LIST-SITE-INVENTORY;
    0633  	ELSE, IF WS-ANS = 'M'
    0634  		MOVE 'MASTYM' TO WS-MACRO-ARG
    0635  		MOVE WS-ENA TO WS-MACRO-ARG-EN
    0636  		ENTER MACRO RUNNIT USING WS-MACRO-ARG;
    0637  	ELSE, IF WS-ANS = 'O' GO TO ORDER-LIST;
    0638  	ELSE, IF WS-ANS = 'P' GO TO SITE-PRICE-LIST;
    0639  	ELSE, IF WS-ANS = 'S' 
    0640  		MOVE 'SITTYM' TO WS-MACRO-ARG
    0641  		MOVE WS-ENA TO WS-MACRO-ARG-EN
    0642  		ENTER MACRO RUNNIT USING WS-MACRO-ARG;
    0643  	ELSE, IF WS-ANS = 'Y'
    0644  		MOVE 'RECTYM' TO WS-MACRO-ARG
    0645  		MOVE WS-ENA TO WS-MACRO-ARG-EN
    0646  		ENTER MACRO RUNNIT USING WS-MACRO-ARG;
    0647  	ELSE, IF WS-ANS = 'Z'
    0648  		MOVE 'CONTYM' TO WS-MACRO-ARG
    0649  		MOVE WS-ENA TO WS-MACRO-ARG-EN
    0650  		ENTER MACRO RUNNIT USING WS-MACRO-ARG;
    0651  	ELSE, IF WS-ANS = '?' GO TO HELP;
    0652  	ELSE, DISPLAY '* INVALID - TYPE ? FOR HELP *'
    0653  		GO TO PROC.
    0654      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 16
    LISTYM.CBL    19-NOV-65  18:29

    0655  * *********************************************************************
    0656  * 
    0657  * 	HELP - TYPE LIST OF VALID PROCEDURES
    0658  * 
    0659  * *********************************************************************
    0660  
    0661    HELP.
    0662  	DISPLAY 'VALID PROCEDURES ARE:'.
    0663  	DISPLAY 'A	LIST MASTER FILE'.
    0664  	DISPLAY 'B	BACKORDER LIST BY SITE'.
    0665  	DISPLAY 'E	EXIT'.
    0666  	DISPLAY 'H	USAGE HISTORY LISTING'.
    0667  	DISPLAY 'I	INVENTORY LIST BY SITE'.
    0668  	DISPLAY 'M	ENTER MASTYM (MASTER FILE PROGRAM)'.
    0669  	DISPLAY 'O	REPRINT PARTS ORDER'.
    0670  	DISPLAY 'Q	QUIT (EXIT)'.
    0671  	DISPLAY 'P	PRICE LISTING BY SITE'.
    0672  	DISPLAY 'S	ENTER SITTYM (SITE INVENTORY PROGRAM)'.
    0673  	DISPLAY '?	TYPE THIS TEXT'.
    0674  	DISPLAY ' '.
    0675  	GO TO PROC.
    0676  
    0677      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 17
    LISTYM.CBL    19-NOV-65  18:29

    0678  * *********************************************************************
    0679  * 
    0680  * 	BACKORDER LIST
    0681  * 
    0682  * *********************************************************************
    0683  
    0684    BACKORDER-LIST.
    0685  	DISPLAY 'BACKORDER LISTING'.
    0686  	MOVE 'BACKORDER' TO LIST-NAME.
    0687  	MOVE 'BORDERLST' TO LIST-FILE-NAME.
    0688  	MOVE WS-DATE TO LIST-DATE.
    0689  	MOVE JULIAN-DATE TO L-JULIAN-DATE.
    0690  	OPEN INPUT NAME-FILE.
    0691  	MOVE SPACES TO S-K-PARTNO.
    0692  	MOVE ZERO TO S-K-REC-NO X Y.
    0693  	MOVE H9-BO-DATA TO H9-BO.
    0694    BACKORDER-CMD.
    0695  	DISPLAY 'ENTER SITE # <NN>, OR <A> FOR ALL, <X> TO EXIT - '
    0696  		WITH NO ADVANCING.
    0697  	ACCEPT WS-LIST-SITE.
    0698  	IF WS-LIST-SITE = 'A'
    0699  		MOVE LOW-VALUE TO S-KEY
    0700  		GO TO ORDER-ALL-START;
    0701  	ELSE, IF WS-LIST-SITE NOT NUMERIC
    0702  		CLOSE NAME-FILE
    0703  		GO TO PROC.
    0704  	MOVE WS-LIST-SITE TO N-KEY S-K-SITE-NO WS-LIST-NAME-2.
    0705  	READ NAME-FILE INVALID KEY
    0706  		DISPLAY '* SITE # ' N-KEY ' NON-EXISTANT'
    0707  		GO TO BACKORDER-CMD.
    0708  	DISPLAY 'BACKORDER LIST FOR ' N-NAME ' OK ? ' WITH NO ADVANCING.
    0709  	PERFORM YES-NO.
    0710  	IF WS-ANS = 'N'
    0711  		GO TO BACKORDER-CMD.
    0712  	GO TO ORDER-ALL-START.
    0713      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 18
    LISTYM.CBL    19-NOV-65  18:29

    0714  * *********************************************************************
    0715  * 
    0716  * 	SITES INVENTORY LISTING ROUTINE
    0717  * 
    0718  * *********************************************************************
    0719  
    0720    LIST-SITE-INVENTORY.
    0721  	DISPLAY 'LIST SITE INVENTORY'.
    0722  
    0723    LIST-GET-SITE.
    0724  	MOVE 'SITES' TO WS-LIST-NAME.
    0725  	MOVE 'INVENTORY' TO LIST-NAME.
    0726  	MOVE LIST-HDR-2 TO LIST-HDR-N.
    0727  	DISPLAY 'ENTER SITE TO LIST(NN), OR <A> FOR ALL, <X> TO EXIT - '
    0728  		WITH NO ADVANCING.
    0729  	ACCEPT WS-LIST-SITE.
    0730  	IF WS-LIST-SITE = 'A'
    0731  		DISPLAY 'START WITH SITE # ' WITH NO ADVANCING
    0732  		ACCEPT WS-LIST-SITE-NO;
    0733  	ELSE, IF WS-LIST-SITE ='X'
    0734  		GO TO PROC;
    0735  	ELSE, IF WS-LIST-SITE NUMERIC
    0736  		MOVE WS-LIST-SITE TO WS-LIST-SITE-NO WS-LIST-NAME-2
    0737  		MOVE SPACES TO WS-LIST-SITE;
    0738  	ELSE, DISPLAY '**INVALID - ' WITH NO ADVANCING
    0739  		GO TO LIST-GET-SITE.
    0740    LIST-GET-OPTIONS.
    0741  	MOVE 1 TO X.
    0742  	DISPLAY 'ENTER SORT OPTIONS - ' WITH NO ADVANCING.
    0743  	PERFORM LIST-DECODE-STRING THRU LIST-DECODE-STRING-END.
    0744  	IF RET-CODE NOT = ZERO
    0745  		IF RET-CODE NOT = 9
    0746  			GO TO LIST-OPTION-ERROR;
    0747  		ELSE, DISPLAY '** ABORTING **'
    0748  			GO TO PROC.
    0749  	MOVE 6 TO X.
    0750  	DISPLAY 'ENTER SORTS TO INCLUDE CREF DATA - ' WITH NO ADVANCING.
    0751  	PERFORM LIST-DECODE-STRING THRU LIST-DECODE-STRING-END.
    0752  	IF RET-CODE NOT = ZERO
    0753  		IF RET-CODE NOT = 9
    0754  			GO TO LIST-OPTION-ERROR;
    0755  		ELSE, DISPLAY '** ABORTING **'
    0756  			GO TO PROC.
    0757  	MOVE 11 TO X.
    0758  	DISPLAY 'ENTER SORTS TO INCLUDE ZERO RECORDS - '
    0759  		WITH NO ADVANCING.
    0760  	PERFORM LIST-DECODE-STRING THRU LIST-DECODE-STRING-END.
    0761  	IF RET-CODE NOT = 0
    0762  		IF RET-CODE NOT = 9
    0763  			GO TO LIST-OPTION-ERROR;
    0764  		ELSE, DISPLAY '** ABORTING **'
    0765  			GO TO PROC.
    0766  	OPEN INPUT SITE-FILE MAST-FILE NAME-FILE OUTPUT LIST-FILE.
    0767  	MOVE WS-LIST-SITE-NO TO WS-LIST-SITE-NEXT.
    0768      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 19
    LISTYM.CBL    19-NOV-65  18:29

    0769  * **********************************
    0770  * 	SITE INV LIST (CONT)
    0771  * **********************************
    0772  
    0773    LIST-SITE-LOOP.
    0774  	MOVE WS-LIST-SITE-NEXT TO WS-LIST-SITE-NO.
    0775  	DISPLAY '< LISTING SITE # ' WS-LIST-SITE-NO ' >'.
    0776  	PERFORM LIST-SITE-DATA THRU LIST-SITE-DATA-END.
    0777  	IF RET-CODE = 0
    0778  		IF WS-LIST-SITE = 'A'
    0779  			GO TO LIST-SITE-LOOP;
    0780  		ELSE, NEXT SENTENCE;
    0781  	ELSE, IF RET-CODE = 9
    0782  		NEXT SENTENCE;
    0783  	ELSE, DISPLAY '** ERROR RETURN FROM LIST-SITE-DATA - RET-CODE = '
    0784  		RET-CODE.
    0785  	CLOSE SITE-FILE NAME-FILE MAST-FILE LIST-FILE.
    0786  	DISPLAY WS-LIST-NAME '.LST IS ON DISK...'.
    0787  	GO TO PROC.
    0788  
    0789    LIST-OPTION-ERROR.
    0790  	DISPLAY 'ERROR SPECIFYING LIST OPTIONS - RE-ENTER'.
    0791  	GO TO LIST-GET-OPTIONS.
    0792  
    0793    LIST-SITE-DATA.
    0794  	IF WS-LIST-PARTNO = '*'
    0795  		PERFORM LIST-PARTNO.
    0796  	IF WS-LIST-DESC = '*'
    0797  		PERFORM LIST-DESC.
    0798  	IF WS-LIST-OPT = '*'
    0799  		PERFORM LIST-OPT.
    0800  	IF WS-LIST-LOC = '*'
    0801  		PERFORM LIST-LOC.
    0802  	IF WS-LIST-VC = '*'
    0803  		PERFORM LIST-VC.
    0804    LIST-SITE-DATA-END. EXIT.
    0805  * *****************************
    0806  * 	SITE INV LIST (CONT)
    0807  * 	LIST SORT ROUTINES
    0808  * *****************************
    0809  
    0810    LIST-PARTNO.
    0811  	MOVE 1 TO Y.
    0812  	MOVE 'P/N' TO L-SORT.
    0813  	PERFORM LIST-SITE-SETUP.
    0814  	SORT LIST-SORT ON ASCENDING KEY LS-PARTNO
    0815  	INPUT PROCEDURE IS LIST-SORT-INPUT THRU LSI-END
    0816  	OUTPUT PROCEDURE IS LIST-SORT-OUTPUT THRU LSO-END.
    0817    LIST-DESC.
    0818  	MOVE 2 TO Y.
    0819  	MOVE 'DESC' TO L-SORT.
    0820  	PERFORM LIST-SITE-SETUP.
    0821  	SORT LIST-SORT ON ASCENDING KEY LS-DESC LS-VPN
    0822  	INPUT PROCEDURE IS LIST-SORT-INPUT THRU LSI-END
    0823  	OUTPUT PROCEDURE IS LIST-SORT-OUTPUT THRU LSO-END.
    0824    LIST-OPT.    P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 19-1
    LISTYM.CBL    19-NOV-65  18:29

    0825  	MOVE 3 TO Y.
    0826  	MOVE 'OPT' TO L-SORT.
    0827  	PERFORM LIST-SITE-SETUP.
    0828  	SORT LIST-SORT ON ASCENDING KEY LS-OPT LS-PARTNO
    0829  	INPUT PROCEDURE IS LIST-SORT-INPUT THRU LSI-END
    0830  	OUTPUT PROCEDURE IS LIST-SORT-OUTPUT THRU LSO-END.
    0831    LIST-LOC.
    0832  	MOVE 4 TO Y.
    0833  	MOVE 'LOC' TO L-SORT.
    0834  	PERFORM LIST-SITE-SETUP.
    0835  	SORT LIST-SORT ON ASCENDING KEY LS-LOC LS-PARTNO
    0836  	INPUT PROCEDURE IS LIST-SORT-INPUT THRU LSI-END
    0837  	OUTPUT PROCEDURE IS LIST-SORT-OUTPUT THRU LSO-END.
    0838    LIST-VC.
    0839  	MOVE 5 TO Y.
    0840  	MOVE 'VC' TO L-SORT.
    0841  	PERFORM LIST-SITE-SETUP.
    0842  	SORT LIST-SORT ON ASCENDING KEY LS-VC LS-VPN
    0843  	INPUT PROCEDURE IS LIST-SORT-INPUT THRU LSI-END
    0844  	OUTPUT PROCEDURE IS LIST-SORT-OUTPUT THRU LSO-END.
    0845    LIST-END-OF-FIELD-SORTS.
    0846  
    0847    LIST-SITE-SETUP.
    0848  	MOVE WS-LIST-SITE-NO TO S-K-SITE-NO N-KEY.
    0849  	MOVE SPACES TO S-K-PARTNO.
    0850  	MOVE ZERO TO S-K-REC-NO.
    0851  	READ SITE-FILE INVALID KEY
    0852  		DISPLAY '** ERROR SYNCHRONIZING TO SITE DATA **'
    0853  		GO TO SITE-FILE-ERROR.
    0854    LIST-SITE-SETUP-END.
    0855      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 20
    LISTYM.CBL    19-NOV-65  18:29

    0856  * *****************************
    0857  * 	SITE INV LIST (CONT)
    0858  * INPUT 'SCANNER' TO DECODE
    0859  *  LIST SORT OPTIONS
    0860  * *****************************
    0861  
    0862    LIST-DECODE-STRING.
    0863  	IF X = 1
    0864  		MOVE SPACES TO WS-LIST-SORT-ALL WS-LIST-CREF-ALL
    0865  		MOVE SPACES TO WS-LIST-ZERO-ALL.
    0866  	ACCEPT WS-LIST-OPT-STRING.
    0867  	MOVE ZERO TO WS-LIST-OPT-COUNT.
    0868    LIST-DECODE-STRING-LOOP.
    0869  	IF WS-LIST-OPT-OUT = 'P' MOVE 1 TO Y;
    0870  	ELSE, IF WS-LIST-OPT-OUT = 'D' MOVE 2 TO Y;
    0871  	ELSE, IF WS-LIST-OPT-OUT = 'O' MOVE 3 TO Y;
    0872  	ELSE, IF WS-LIST-OPT-OUT = 'L' MOVE 4 TO Y;
    0873  	ELSE, IF WS-LIST-OPT-OUT = 'V' MOVE 5 TO Y;
    0874  	ELSE, IF WS-LIST-OPT-OUT = SPACES
    0875  		MOVE 0 TO RET-CODE
    0876  		GO TO LIST-DECODE-STRING-END;
    0877  	ELSE, IF WS-LIST-OPT-OUT = 'X'
    0878  		MOVE 9 TO RET-CODE
    0879  		GO TO LIST-DECODE-STRING-END;
    0880  	ELSE, GO TO LIST-DECODE-STRING-ERROR.
    0881  	IF X = 1
    0882  		MOVE '*' TO WS-LIST-SORT(Y);
    0883  	ELSE, IF X = 6 AND WS-LIST-SORT(Y) = '*'
    0884  		MOVE '*' TO WS-LIST-CREF(Y);
    0885  	ELSE, IF X = 11 AND WS-LIST-SORT(Y) = '*'
    0886  		MOVE '*' TO WS-LIST-ZERO(Y);
    0887  	ELSE, GO TO LIST-DECODE-STRING-ERROR.
    0888  	MOVE WS-LIST-OPT-REST TO WS-LIST-OPT-STRING
    0889  	GO TO LIST-DECODE-STRING-LOOP.
    0890    LIST-DECODE-STRING-ERROR.
    0891  	MOVE 1 TO RET-CODE.
    0892    LIST-DECODE-STRING-END. EXIT.
    0893      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 21
    LISTYM.CBL    19-NOV-65  18:29

    0894      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 22
    LISTYM.CBL    19-NOV-65  18:29

    0895  * *****************************
    0896  * 	SITE INV LIST (CONT)
    0897  * 	SORT INPUT ROUTINE
    0898  * *****************************
    0899  
    0900    LIST-SORT-INPUT.
    0901  	IF WS-LIST-CREF(Y) = '*' MOVE 1 TO X;
    0902  	ELSE, MOVE ZERO TO X.
    0903  	IF WS-LIST-ZERO(Y) = '*' MOVE 1 TO Y;
    0904  	ELSE, MOVE ZERO TO Y.
    0905  	MOVE LOW-VALUE TO S-KEY.
    0906    LSI-LOOP-1.
    0907  	READ SITE-FILE INVALID KEY
    0908  		MOVE 9 TO RET-CODE
    0909  		GO TO LSI-END.
    0910  	IF S-SITE-NO NOT = WS-LIST-SITE-NO
    0911  		MOVE ZERO TO RET-CODE
    0912  		MOVE S-SITE-NO TO WS-LIST-SITE-NEXT
    0913  		GO TO LSI-END.
    0914  	IF S-REC-NO NOT = 0 OR (Y = 0 AND(S-LOC = SPACES AND S-MAX = 0))
    0915  		GO TO LSI-LOOP-1.
    0916  	MOVE SPACES TO LIST-SORT-REC.
    0917  	MOVE S-PARTNO TO LS-PARTNO WS-PARTNO.
    0918  	MOVE S-LOC TO LS-LOC.
    0919  	PERFORM GET-MASTER THRU GET-MASTER-END.
    0920  	IF RET-CODE NOT = 1
    0921  		MOVE '** NOT IN MAST FILE *' TO LS-DESC
    0922  		GO TO LSI-RELEASE.
    0923  	IF M-PARTNO NOT = WS-PARTNO
    0924  		MOVE M-REC-PN-PL TO LS-PARTNO
    0925  		MOVE S-PARTNO TO LS-SITE-PARTNO.
    0926    LSI-LOAD-MASTER-DATA.
    0927  	MOVE M-DESC TO LS-DESC.
    0928  	MOVE M-VC TO LS-VC.
    0929  	MOVE M-VPN TO LS-VPN.
    0930  	MOVE M-OPT TO LS-OPT.
    0931  	RELEASE LIST-SORT-REC.
    0932    LSI-LOOP-2.
    0933  	IF X = ZERO OR M-REV-CREF = SPACES
    0934  		GO TO LSI-LOOP-1.
    0935  	MOVE SPACES TO LIST-SORT-REC.
    0936  	MOVE M-REV-CREF TO M-K-PN-PL.
    0937  	MOVE M-K-PARTNO TO LS-PARTNO.
    0938  	MOVE 'C' TO LS-FLAG.
    0939  	READ MAST-FILE INVALID KEY
    0940  		GO TO LSI-CREF-INVALID.
    0941  	GO TO LSI-LOAD-MASTER-DATA.
    0942    LSI-CREF-INVALID.
    0943  	MOVE '** REV CREF ERROR **' TO LS-DESC.
    0944  	MOVE 'FM' TO LS-VC.
    0945  	MOVE WS-PARTNO TO LS-VPN.
    0946    LSI-RELEASE.
    0947  	RELEASE LIST-SORT-REC.
    0948  	GO TO LSI-LOOP-1.
    0949    LSI-END. EXIT.
    0950      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 23
    LISTYM.CBL    19-NOV-65  18:29

    0951      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 24
    LISTYM.CBL    19-NOV-65  18:29

    0952  * *****************************
    0953  * 	SITE INV LIST (CONT)
    0954  * 	SORT OUTPUT ROUTINE
    0955  * *****************************
    0956  
    0957    LIST-SORT-OUTPUT.
    0958  	PERFORM LIST-HEADER-INIT THRU LIST-HEADER-END.
    0959  	MOVE ZERO TO Z.
    0960    LSO-LOOP-1.
    0961  	IF WS-LINE NOT < 55
    0962  		PERFORM LIST-HEADER THRU LIST-HEADER-END.
    0963  	MOVE SPACES TO LIST-REC.
    0964  	RETURN LIST-SORT AT END
    0965  		GO TO LSO-END.
    0966  	ADD 1 TO Z.
    0967  	MOVE LS-PARTNO TO L-PARTNO.
    0968  	MOVE LS-DESC TO L-DESC.
    0969  	MOVE LS-VC TO L-VC.
    0970  	MOVE LS-VPN TO L-VPN.
    0971  	MOVE LS-OPT TO L-OPT.
    0972  	MOVE LS-LOC TO L-LOC.
    0973  	MOVE LS-SITE-PARTNO TO L-SITE-PARTNO.
    0974  	IF LS-FLAG NOT = SPACES
    0975  		WRITE LIST-REC AFTER ADVANCING 1 LINE
    0976  		ADD 1 TO WS-LINE
    0977  		GO TO LSO-LOOP-1.
    0978  	MOVE WS-LIST-SITE-NO TO S-K-SITE-NO.
    0979  	IF LS-SITE-PARTNO = SPACES
    0980  		MOVE LS-PN TO WS-PARTNO S-K-PARTNO;
    0981  	ELSE, MOVE LS-SITE-PARTNO TO WS-PARTNO S-K-PARTNO.
    0982  	MOVE ZERO TO S-K-REC-NO.
    0983  	READ SITE-FILE INVALID KEY
    0984  		DISPLAY '**ERROR IN LIST-SORT-OUTPUT**'
    0985  		GO TO SITE-FILE-ERROR.
    0986  	MOVE S-MAX TO L-MAX.
    0987  	MOVE S-ON-HAND TO L-ON-HAND.
    0988  	IF S-LOC NOT = SPACES AND S-MAX > S-ON-HAND
    0989  		COMPUTE WS-QUAN = (S-MAX * .4) - S-ON-HAND
    0990  		IF WS-QUAN > ZERO
    0991  			MOVE '*' TO L-FLAG.
    0992  	IF S-ON-ORDER = ZERO
    0993  		GO TO LSO-WRITE.
    0994  	MOVE S-ON-ORDER TO WS-QUAN.
    0995  	MOVE LOW-VALUE TO S-KEY.
    0996      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 25
    LISTYM.CBL    19-NOV-65  18:29

    0997  * *****************************
    0998  * 	SITE INV LIST (CONT)
    0999  * 	SORT OUTPUT
    1000  * *****************************
    1001  
    1002    LSO-LOOP-2.
    1003  	READ SITE-FILE INVALID KEY
    1004  		GO TO LSO-ORD-ERROR.
    1005  	IF S-PARTNO NOT = WS-PARTNO
    1006  		GO TO LSO-ORD-ERROR.
    1007  	MOVE S-ORD-NO TO L-ORD-NO WS-JULIAN-DATE.
    1008  	MOVE S-ORD-QUAN TO L-ORD-QUAN.
    1009  	PERFORM DATE-CONV THRU DATE-CONV-END.
    1010  	MOVE WS-DATE-OUT TO L-ORD-DATE.
    1011  	WRITE LIST-REC  AFTER ADVANCING 1 LINE.
    1012  	ADD 1 TO WS-LINE.
    1013  	SUBTRACT S-ORD-QUAN FROM WS-QUAN.
    1014  	IF WS-QUAN > ZERO
    1015  		MOVE SPACES TO LIST-REC
    1016  		GO TO LSO-LOOP-2.
    1017  	GO TO LSO-LOOP-1.
    1018  
    1019    LSO-ORD-ERROR.
    1020  	MOVE '** ORDER ERROR **' TO L-ORDER-INFO.
    1021    LSO-WRITE.
    1022  	WRITE LIST-REC AFTER ADVANCING 1 LINE.
    1023  	ADD 1 TO WS-LINE.
    1024  	GO TO LSO-LOOP-1.
    1025    LSO-END. 
    1026  	MOVE SPACES TO LIST-REC.
    1027  	WRITE LIST-REC AFTER ADVANCING 1 LINE.
    1028  	MOVE Z TO LIST-TOT-LINES.
    1029  	WRITE LIST-REC FROM LIST-HDR-3 AFTER ADVANCING 1 LINE.
    1030      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 26
    LISTYM.CBL    19-NOV-65  18:29

    1031  * *********************************************************************
    1032  * 
    1033  * 	MASTER FILE LISTING (A)
    1034  * 
    1035  * *********************************************************************
    1036  
    1037    MASTER-LIST.
    1038  	DISPLAY 'LIST MASTER FILE'.
    1039  	MOVE 'MASTERLST' TO LIST-FILE-NAME.
    1040  	MOVE ZERO TO X WS-PAGE.
    1041  	MOVE WS-DATE TO H7-DATE.
    1042  	MOVE JULIAN-DATE TO H7-JULIAN-DATE.
    1043  	OPEN INPUT MAST-FILE OUTPUT LIST-FILE.
    1044  
    1045    MASTER-LIST-HEADER.
    1046  	ADD 1 TO WS-PAGE.
    1047  	MOVE WS-PAGE TO H7-PAGE.
    1048  	MOVE ZERO TO WS-LINE.
    1049  	WRITE LIST-REC FROM LIST-HDR-7 AFTER ADVANCING TOP.
    1050  	WRITE LIST-REC FROM LIST-HDR-8 AFTER ADVANCING 2 LINES.
    1051  	MOVE SPACES TO LIST-REC.
    1052  	WRITE LIST-REC AFTER ADVANCING 1 LINE.
    1053  
    1054    MASTER-LIST-LOOP.
    1055  	READ MAST-FILE INVALID KEY
    1056  		GO TO MASTER-LIST-END.
    1057  	ADD 1 TO WS-LINE.
    1058  	IF WS-LINE > 55
    1059  		PERFORM MASTER-LIST-HEADER.
    1060  	ADD 1 TO X.
    1061  	MOVE M-PARTNO TO ML-PARTNO.
    1062  	MOVE M-DESC TO ML-DESC.
    1063  	MOVE M-VC TO ML-VC.
    1064  	MOVE M-VPN TO ML-VPN.
    1065  	MOVE M-SITES TO ML-SITES.
    1066  	MOVE M-PRICE TO ML-PRICE.
    1067  	MOVE M-RR TO ML-RR.
    1068  	MOVE M-OPT TO ML-OPT.
    1069  	MOVE M-REC-QUAN TO ML-REC-QUAN.
    1070  	MOVE M-REV-CREF TO ML-REV-CREF.
    1071  	MOVE M-FLAG TO ML-FLAG.
    1072  	MOVE M-CREF TO ML-CREF.
    1073  	WRITE LIST-REC AFTER ADVANCING 1 LINE.
    1074  	GO TO MASTER-LIST-LOOP.
    1075  
    1076    MASTER-LIST-END.
    1077  	MOVE X TO LIST-TOT-LINES.
    1078  	WRITE LIST-REC FROM LIST-HDR-3 AFTER ADVANCING 2 LINES.
    1079  	CLOSE MAST-FILE LIST-FILE.
    1080  	DISPLAY 'MASTER.LST IS ON DISK...'.
    1081  	GO TO PROC.
    1082      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 27
    LISTYM.CBL    19-NOV-65  18:29

    1083  * *********************************************************************
    1084  * 
    1085  * 	ORDER LIST (REPRINT A PARTS ORDER)
    1086  * 	
    1087  * 	** "ORDER-ALL" ROUTINES USED IN BACKORERR-LIST ROUTINE, TOO
    1088  * 
    1089  * *********************************************************************
    1090  
    1091    ORDER-LIST.
    1092  	DISPLAY 'RE-PRINT PARTS ORDERS'.
    1093  	MOVE 'ORDER' TO LIST-NAME.
    1094  	MOVE 'ORDER LST' TO LIST-FILE-NAME.
    1095  	DISPLAY 'ENTER ORDER NUMBER TO LIST - ' WITH NO ADVANCING.
    1096  	ACCEPT WS-ORD-NO.
    1097  	MOVE WS-ORD-NO TO L-JULIAN-DATE WS-JULIAN-DATE.
    1098  	PERFORM DATE-CONV THRU DATE-CONV-END.
    1099  	MOVE WS-DATE-OUT TO LIST-DATE.
    1100  	MOVE SPACES TO H9-BO.
    1101  	MOVE 'O' TO WS-LIST-SITE.
    1102  	MOVE LOW-VALUE TO S-KEY.
    1103  	OPEN INPUT NAME-FILE.
    1104  
    1105    ORDER-ALL-START.
    1106  	MOVE SPACES TO L-SORT LIST-CREF LIST-ZERO.
    1107  	MOVE LIST-HDR-9 TO LIST-HDR-N.
    1108  	OPEN INPUT SITE-FILE MAST-FILE.
    1109  	READ SITE-FILE INVALID KEY
    1110  		GO TO SITE-FIRST-READ-ERROR.
    1111  	OPEN OUTPUT LIST-FILE.
    1112  	MOVE LOW-VALUE TO S-KEY.
    1113    ORDER-ALL-NEW-SITE.
    1114  	MOVE S-SITE-NO TO WS-LIST-SITE-NO.
    1115  	MOVE ZERO TO X Y.
    1116  	MOVE 99 TO WS-LINE.
    1117    ORDER-ALL-LOOP.
    1118  	READ SITE-FILE INVALID KEY
    1119  		GO TO ORDER-ALL-END.
    1120    ORDER-ALL-LOOP-1.
    1121  	IF S-REC-NO NOT = ZERO
    1122  		DISPLAY '* ORDER ERROR - SITE-REC = ' SITE-REC
    1123  		GO TO ORDER-ALL-LOOP.
    1124  	IF S-SITE-NO NOT = WS-LIST-SITE-NO
    1125  		PERFORM ORDER-ALL-TOTAL THRU ORDER-ALL-TOTAL-END
    1126  		IF WS-LIST-SITE = 'A' OR WS-LIST-SITE = 'O'
    1127  			GO TO ORDER-ALL-NEW-SITE;
    1128  		ELSE, GO TO ORDER-ALL-END.
    1129  	IF S-ON-ORDER = ZERO
    1130  		GO TO ORDER-ALL-LOOP.
    1131  	IF WS-LINE > 50
    1132  		IF X > ZERO
    1133  			PERFORM LIST-HEADER THRU LIST-HEADER-END;
    1134  	     ELSE, PERFORM ORDER-HEADER-INIT THRU LIST-HEADER-END.
    1135      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 28
    LISTYM.CBL    19-NOV-65  18:29

    1136  * *****************************
    1137  * 	ORDER LIST (CONT)
    1138  * *****************************
    1139  
    1140  	MOVE SPACES TO LIST-REC.
    1141  	MOVE S-PARTNO TO WS-PARTNO ORD-PARTNO.
    1142  	MOVE S-MAX TO ORD-MAX.
    1143  	MOVE S-ON-HAND TO ORD-ON-HAND.
    1144  	PERFORM GET-MASTER THRU GET-MASTER-END.
    1145  	IF RET-CODE = ZERO
    1146  		MOVE SPACES TO MAST-REC
    1147  		MOVE '*NOT IN MAST-FILE*' TO ORD-DESC
    1148  		GO TO ORDER-ALL-LOOP-2.
    1149  	IF M-PARTNO NOT = WS-PARTNO
    1150  		MOVE M-REC-PN-PL TO ORD-MAST.
    1151  	MOVE M-DESC TO ORD-DESC.
    1152  	MOVE M-VC TO ORD-VC.
    1153  	MOVE M-VPN TO ORD-VPN.
    1154    ORDER-ALL-LOOP-2.
    1155  	READ SITE-FILE INVALID KEY
    1156  		GO TO ORDER-ALL-END.
    1157  	IF S-PARTNO NOT = WS-PARTNO
    1158  		GO TO ORDER-ALL-LOOP-1.
    1159  	IF WS-LIST-SITE = 'O' AND WS-ORD-NO NOT = S-ORD-NO
    1160  		GO TO ORDER-ALL-LOOP-2.
    1161  	ADD 1 TO Y.
    1162  	MOVE S-ORD-QUAN TO ORD-QUAN.
    1163  	IF WS-LIST-SITE NOT = 'O'
    1164  		MOVE S-ORD-NO TO ORD-ORD-NO WS-JULIAN-DATE
    1165  		PERFORM DATE-CONV THRU DATE-CONV-END
    1166  		MOVE WS-DATE-OUT TO ORD-ORD-DATE.
    1167  	WRITE LIST-REC AFTER ADVANCING 1 LINE.
    1168  	ADD 1 TO WS-LINE.
    1169  	GO TO ORDER-ALL-LOOP-2.
    1170  
    1171    ORDER-ALL-TOTAL.
    1172  	IF Y = ZERO
    1173  		GO TO ORDER-ALL-TOTAL-END.
    1174  	MOVE Y TO H10-LINES.
    1175  	WRITE LIST-REC FROM LIST-HDR-10 AFTER ADVANCING 2 LINES.
    1176    ORDER-ALL-TOTAL-END. EXIT.
    1177  
    1178    ORDER-ALL-END.
    1179  	PERFORM ORDER-ALL-TOTAL THRU ORDER-ALL-TOTAL-END.
    1180  	CLOSE MAST-FILE SITE-FILE NAME-FILE LIST-FILE.
    1181  	DISPLAY LIST-FILE-NAME ' IS ON DISK...'.
    1182  	GO TO PROC.
    1183      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 29
    LISTYM.CBL    19-NOV-65  18:29

    1184  * *********************************************************************
    1185  * 
    1186  * 	SITE PRICE LISTING
    1187  * 
    1188  * *********************************************************************
    1189  
    1190    SITE-PRICE-LIST.
    1191  	DISPLAY 'INVENTORY PRICE LISTING BY SITE'.
    1192  	MOVE 'PRICE LST' TO LIST-FILE-NAME.
    1193  	MOVE 'PRICE' TO LIST-NAME.
    1194  	MOVE LIST-HDR-4 TO LIST-HDR-N.
    1195  	DISPLAY 'ENTER SITE TO LIST<NN>, OR <A> FOR ALL, <X> TO EXIT - '
    1196  		WITH NO ADVANCING.
    1197  	ACCEPT WS-LIST-SITE.
    1198  	IF WS-LIST-SITE = 'A'
    1199  		MOVE LOW-VALUE TO S-KEY;
    1200  	ELSE, IF WS-LIST-SITE NUMERIC
    1201  		MOVE WS-LIST-SITE TO S-KEY
    1202  		MOVE ZERO TO S-K-REC-NO;
    1203  	ELSE, GO TO PROC.
    1204  	OPEN INPUT SITE-FILE NAME-FILE MAST-FILE.
    1205  	READ SITE-FILE INVALID KEY
    1206  		GO TO SITE-FIRST-READ-ERROR.
    1207  	MOVE SPACES TO L-SORT LIST-CREF LIST-ZERO.
    1208  	MOVE ZERO TO WS-GRAND-TOTAL.
    1209  	MOVE WS-DATE TO LIST-DATE.
    1210  	MOVE JULIAN-DATE TO L-JULIAN-DATE.
    1211  	OPEN OUTPUT LIST-FILE.
    1212    SITE-PRICE-NEW-SITE.
    1213  	MOVE S-SITE-NO TO N-KEY.
    1214  	READ NAME-FILE INVALID KEY
    1215  		DISPLAY '* NAME-REC NOT FOUND FOR SITE ' N-KEY
    1216  		MOVE '* UNKNOWN *' TO N-NAME.
    1217  	MOVE N-NAME TO LIST-SITE-NAME.
    1218  	MOVE N-KEY TO LIST-SITE-NO.
    1219  	MOVE ZERO TO I WS-SITE-TOTAL WS-PAGE.
    1220  	MOVE 99 TO WS-LINE.
    1221    SITE-PRICE-LOOP.
    1222  	IF WS-LINE > 49
    1223  		PERFORM LIST-HEADER THRU LIST-HEADER-END.
    1224  	MOVE LOW-VALUE TO S-KEY.
    1225  	READ SITE-FILE INVALID KEY
    1226  		GO TO SITE-PRICE-END.
    1227  	IF S-SITE-NO NOT = N-KEY
    1228  		IF WS-LIST-SITE = 'A'
    1229  			PERFORM SITE-PRICE-TOTAL
    1230  			GO TO SITE-PRICE-NEW-SITE;
    1231  		ELSE, GO TO SITE-PRICE-END.
    1232  	IF S-REC-NO NOT = 0 OR (S-LOC = SPACES AND S-ON-HAND = 0)
    1233  		GO TO SITE-PRICE-LOOP.
    1234      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 30
    LISTYM.CBL    19-NOV-65  18:29

    1235  * *****************************
    1236  * 	SITE PRICE LIST (CONT)
    1237  * *****************************
    1238  
    1239  	ADD 1 TO I.
    1240  	MOVE S-PARTNO TO PL-PARTNO WS-PARTNO.
    1241  	MOVE S-LOC TO PL-LOC.
    1242  	MOVE S-MAX TO PL-MAX.
    1243  	MOVE S-ON-HAND TO PL-ON-HAND.
    1244  	PERFORM GET-MASTER THRU GET-MASTER-END.
    1245  	IF RET-CODE = ZERO
    1246  		MOVE SPACES TO MAST-REC
    1247  		MOVE '*NOT IN MAST FILE*' TO M-DESC.
    1248  	MOVE M-DESC TO PL-DESC.
    1249  	MOVE M-VC TO PL-VC.
    1250  	MOVE M-VPN TO PL-VPN.
    1251  	MOVE M-PRICE TO PL-PRICE.
    1252  	MULTIPLY M-PRICE BY S-ON-HAND GIVING WS-PRICE-EXT.
    1253  	MOVE WS-PRICE-EXT TO PL-PRICE-EXT.
    1254  	ADD WS-PRICE-EXT TO WS-SITE-TOTAL.
    1255  	WRITE LIST-REC AFTER ADVANCING 1 LINE.
    1256  	ADD 1 TO WS-LINE.
    1257  	GO TO SITE-PRICE-LOOP.
    1258  
    1259    SITE-PRICE-TOTAL.
    1260  	MOVE I TO LIST-TOT-LINES.
    1261  	MOVE LIST-HDR-3 TO LIST-REC.
    1262  	MOVE WS-SITE-TOTAL TO PL-PRICE-EXT.
    1263  	ADD WS-SITE-TOTAL TO WS-GRAND-TOTAL.
    1264  	WRITE LIST-REC AFTER ADVANCING 2 LINES.
    1265    SITE-PRICE-TOTAL-END.
    1266  
    1267    SITE-PRICE-END.
    1268  	PERFORM SITE-PRICE-TOTAL.
    1269  	IF WS-LIST-SITE = 'A'
    1270  		MOVE LIST-HDR-5 TO LIST-REC
    1271  		MOVE WS-GRAND-TOTAL TO PL-PRICE-EXT
    1272  		WRITE LIST-REC AFTER ADVANCING 2 LINES.
    1273  	DISPLAY LIST-FILE-NAME ' IS ON DISK...'.
    1274  	CLOSE MAST-FILE SITE-FILE NAME-FILE LIST-FILE.
    1275  	GO TO PROC.
    1276  
    1277    SITE-FIRST-READ-ERROR.
    1278  	IF WS-LIST-SITE = 'A' OR WS-LIST-SITE = 'O'
    1279  		DISPLAY '** ERROR IN SITE FILE - NO DATA ?? **';
    1280  	ELSE, DISPLAY '** ERROR SYNCHRONIZING TO SITE DATA'
    1281  		DISPLAY '** NO DATA FOUND FOR SITE # ' S-SITE-NO.
    1282  	CLOSE SITE-FILE NAME-FILE MAST-FILE.
    1283  	GO TO PROC.
    1284      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 31
    LISTYM.CBL    19-NOV-65  18:29

    1285  * *********************************************************************
    1286  * 
    1287  * 	USAGE HISTORY LISTINGS
    1288  * 
    1289  * *********************************************************************
    1290  
    1291    USAGE-LIST.
    1292  	DISPLAY 'PARTS USAGE LISTINGS'.
    1293  	MOVE 'P/N' TO L-SORT.
    1294  	MOVE SPACES TO LIST-CREF LIST-ZERO WS-LIST-FLAG.
    1295  	MOVE WS-DATE TO LIST-DATE.
    1296  	MOVE JULIAN-DATE TO L-JULIAN-DATE.
    1297  	MOVE 'USAGE LST' TO LIST-FILE-NAME.
    1298  	MOVE 'USAGE' TO LIST-NAME.
    1299  	MOVE ZERO TO WS-PAGE X Y Z USE-12 USE-12-TOT USE-12P-TOT.
    1300  	MOVE ZERO TO USE-6 USE-6-TOT USE-6P-TOT S-K-REC-NO.
    1301  	MOVE 99 TO WS-LINE.
    1302    USAGE-LIST-CMD.
    1303  	DISPLAY 'LIST BY (P)ARTNO, (S)ITE, OR (X) TO EXIT - '
    1304  		WITH NO ADVANCING.
    1305  	ACCEPT WS-ANS.
    1306  	IF WS-ANS = 'S'
    1307  		GO TO USAGE-SITE-LIST;
    1308  	ELSE, IF WS-ANS = 'P' NEXT SENTENCE;
    1309  	ELSE, GO TO PROC.
    1310    USAGE-PARTNO-LIST.
    1311  	MOVE LOW-VALUE TO H-KEY.
    1312  	MOVE 'ALL SITES' TO LIST-SITE-NAME.
    1313  	MOVE SPACES TO H6-MAX H6-PERCENT.
    1314  	MOVE LIST-HDR-6 TO LIST-HDR-N.
    1315  	OPEN INPUT HIST-FILE MAST-FILE OUTPUT LIST-FILE.
    1316    USE-PARTNO-LOOP.
    1317  	READ HIST-FILE INVALID KEY
    1318  		PERFORM USE-ALL-DONE THRU USE-ALL-DONE-END
    1319  		CLOSE HIST-FILE MAST-FILE LIST-FILE
    1320  		DISPLAY LIST-FILE-NAME ' IS ON DISK...'
    1321  		GO TO PROC.
    1322  	IF H-ENTRY-NO = ZERO
    1323  		IF Y = ZERO
    1324  			GO TO USE-PARTNO-LOOP;
    1325  		ELSE, PERFORM USE-ALL-BREAK THRU USE-ALL-BREAK-END
    1326  			GO TO USE-PARTNO-LOOP.
    1327  	MOVE H-PARTNO TO WS-PARTNO.
    1328  	MOVE H-PL TO N-PL.
    1329  	IF H-XFER NOT = 'X'
    1330  		IF H-DATE > AGE-12
    1331  			ADD H-QUAN TO USE-12
    1332  		IF H-DATE > AGE-6
    1333  			ADD H-QUAN TO USE-6.
    1334  	ADD 1 TO Y.
    1335  	GO TO USE-PARTNO-LOOP.
    1336  * *****************************
    1337  * 	USAGE LIST - BY SITE
    1338  * *****************************
    1339  
    1340    USAGE-SITE-LIST.    P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 31-1
    LISTYM.CBL    19-NOV-65  18:29

    1341  	OPEN INPUT NAME-FILE.
    1342    USAGE-SITE-CMD.
    1343  	DISPLAY 'INCLUDE SITE LEVEL CHECK ? ' WITH NO ADVANCING.
    1344  	PERFORM YES-NO.
    1345  	IF WS-ANS = 'Y'
    1346  		MOVE 'A' TO WS-LIST-FLAG.
    1347  	DISPLAY 'ENTER SITE#<NN>, OR <A> FOR ALL, <X> TO EXIT - '
    1348  		WITH NO ADVANCING.
    1349  	ACCEPT WS-LIST-SITE.
    1350  	IF WS-LIST-SITE NUMERIC
    1351  		NEXT SENTENCE;
    1352  	ELSE, IF WS-LIST-SITE = 'A'
    1353  		GO TO USAGE-SITE-START;
    1354  	ELSE, CLOSE NAME-FILE
    1355  		GO TO PROC.
    1356  	MOVE WS-LIST-SITE TO N-KEY.
    1357  	READ NAME-FILE INVALID KEY
    1358  		DISPLAY '* SITE # ' N-KEY ' NON-EXISTANT'
    1359  		GO TO USAGE-SITE-CMD.
    1360  	DISPLAY 'LIST USAGE FOR ' N-NAME ' OK ? ' WITH NO ADVANCING.
    1361  	PERFORM YES-NO.
    1362  	IF WS-ANS = 'N'
    1363  		GO TO USAGE-SITE-CMD.
    1364  
    1365    USAGE-SITE-START.
    1366  	MOVE LIST-HDR-6 TO LIST-HDR-N.
    1367  	OPEN INPUT HIST-FILE MAST-FILE SITE-FILE OUTPUT LIST-FILE.
    1368  	MOVE 99 TO WS-LIST-SITE-NO.
    1369  	SORT HIST-SORT ON ASCENDING HS-KEY
    1370  	INPUT PROCEDURE IS USAGE-SITE-SORT THRU USS-END
    1371  	OUTPUT PROCEDURE IS USAGE-SITE-OUT THRU USO-END.
    1372  	CLOSE HIST-FILE MAST-FILE LIST-FILE NAME-FILE SITE-FILE.
    1373  	DISPLAY LIST-FILE-NAME ' IS ON DISK...'.
    1374  	GO TO PROC.
    1375  
    1376    USAGE-SITE-SORT.
    1377  	MOVE LOW-VALUE TO H-KEY.
    1378    USS-LOOP.
    1379  	READ HIST-FILE INVALID KEY
    1380  		GO TO USS-END.
    1381  	IF H-ENTRY-NO = ZERO
    1382  		GO TO USS-LOOP.
    1383  	IF WS-LIST-SITE NOT = 'A' AND H-SITE-NO NOT = N-KEY
    1384  		GO TO USS-LOOP.
    1385  	MOVE H-SITE-NO TO HS-SITE-NO.
    1386  	MOVE H-REC-PN-PL TO HS-REC-PN-PL.
    1387  	MOVE H-QUAN TO HS-QUAN.
    1388  	MOVE H-DATE TO HS-DATE.
    1389  	MOVE H-XFER TO HS-XFER.
    1390  	MOVE H-XFER-SITE TO HS-XFER-SITE.
    1391  	RELEASE HIST-SORT-REC.
    1392  	GO TO USS-LOOP.
    1393    USS-END. EXIT.
    1394      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 32
    LISTYM.CBL    19-NOV-65  18:29

    1395  * *****************************
    1396  * 	USAGE - BY SITE (CONT)
    1397  * *****************************
    1398  
    1399    USAGE-SITE-OUT.
    1400  	RETURN HIST-SORT AT END
    1401  		PERFORM USE-ALL-DONE THRU USE-ALL-DONE-END
    1402  		GO TO USO-END.
    1403  	IF HS-SITE-NO NOT = WS-LIST-SITE-NO
    1404  		PERFORM USE-ALL-DONE THRU USE-ALL-DONE-END
    1405  		MOVE HS-SITE-NO TO WS-LIST-SITE-NO S-K-SITE-NO
    1406  		PERFORM LIST-HEADER-INIT THRU  LIST-HEADER-END
    1407  		MOVE ZERO TO Y Z  USE-TOTALS;
    1408  	ELSE, IF HS-PARTNO NOT = WS-PARTNO
    1409  		PERFORM USE-ALL-BREAK THRU USE-ALL-BREAK-END.
    1410  	MOVE HS-PARTNO TO WS-PARTNO.
    1411  	MOVE HS-PL TO N-PL.
    1412  	IF HS-DATE > AGE-12
    1413  		ADD HS-QUAN TO USE-12.
    1414  	IF HS-DATE > AGE-6
    1415  		ADD HS-QUAN TO USE-6.
    1416  	ADD 1 TO Y.
    1417  	GO TO USAGE-SITE-OUT.
    1418    USO-END. EXIT.
    1419  * *****************************
    1420  * 	USAGE - COMMON ROUTINES
    1421  * 	   FOR SITE & PARTNO LISTS
    1422  * *****************************
    1423  
    1424    USE-ALL-BREAK.
    1425  	IF Y = ZERO
    1426  		GO TO USE-ALL-BREAK-END.
    1427  	MOVE ZERO TO Y.
    1428  	ADD 1 TO Z.
    1429  	IF WS-LINE > 49
    1430  		PERFORM LIST-HEADER THRU LIST-HEADER-END.
    1431  	PERFORM GET-MASTER THRU GET-MASTER-END.
    1432  	IF RET-CODE NOT = 1
    1433  		MOVE SPACES TO MAST-REC
    1434  		MOVE '*NOT IN MAST-FILE*' TO M-DESC.
    1435  	MOVE SPACES TO LIST-REC.
    1436  	MOVE M-PARTNO TO U-PARTNO S-K-PARTNO.
    1437  	MOVE M-DESC TO U-DESC.
    1438  	MOVE M-VC TO U-VC.
    1439  	MOVE M-VPN TO U-VPN.
    1440  	MOVE M-PRICE TO U-PRICE.
    1441  	IF WS-LIST-FLAG NOT = 'A'
    1442  		GO TO USE-ALL-BREAK-GO.
    1443  	READ SITE-FILE INVALID KEY
    1444  		MOVE '?' TO U-PCT-X
    1445  		GO TO USE-ALL-BREAK-GO.
    1446  	MOVE S-MAX TO U-SITE-MAX.
    1447  	COMPUTE USE-SITE-PCT = ((USE-6 / S-MAX) * 100).
    1448  	MOVE USE-SITE-PCT TO U-PCT-6.
    1449  	MOVE '%' TO U-PCT-X.
    1450    USE-ALL-BREAK-GO.    P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 32-1
    LISTYM.CBL    19-NOV-65  18:29

    1451  	IF USE-12 NOT = ZERO
    1452  		MOVE USE-12 TO U-USE-12
    1453  		MULTIPLY M-PRICE BY USE-12 GIVING WS-PRICE-EXT
    1454  		MOVE WS-PRICE-EXT TO U-UP-12
    1455  		ADD USE-12 TO USE-12-TOT
    1456  		ADD WS-PRICE-EXT TO USE-12P-TOT.
    1457  	IF USE-6 NOT = ZERO
    1458  		MOVE USE-6 TO U-USE-6
    1459  		MULTIPLY M-PRICE BY USE-6 GIVING WS-PRICE-EXT
    1460  		MOVE WS-PRICE-EXT TO U-UP-6
    1461  		ADD USE-6 TO USE-6-TOT
    1462  		ADD WS-PRICE-EXT TO USE-6P-TOT.
    1463  	MOVE ZERO TO USE-CHG.
    1464  	SUBTRACT USE-6 FROM USE-12 GIVING USE-F6.
    1465  	IF USE-F6 = USE-6
    1466  		NEXT SENTENCE;
    1467  	ELSE, IF USE-F6 > USE-6
    1468  		COMPUTE USE-CHG = (((USE-F6 - USE-6)/USE-F6)* 100)
    1469  		MOVE '-' TO USE-SIGN;
    1470  	ELSE, COMPUTE USE-CHG = (((USE-6 - USE-F6)/USE-F6)* 100)
    1471  		MOVE '+' TO USE-SIGN.
    1472  	IF USE-CHG > 25
    1473  		IF USE-F6 NOT = ZERO
    1474  			MOVE USE-SIGN TO U-CHG-SIGN
    1475  			MOVE USE-CHG TO U-CHG-QUAN
    1476  			MOVE '%' TO U-CHG-PCT-SIGN;
    1477  		ELSE, MOVE '+++++' TO U-CHANGE.
    1478  	MOVE ZERO TO USE-6 USE-12.
    1479  	WRITE LIST-REC AFTER ADVANCING 1 LINE.
    1480  	ADD 1 TO WS-LINE.
    1481    USE-ALL-BREAK-END. EXIT.
    1482  * *****************************
    1483  * 	USAGE - COMMON ROUTINES
    1484  * 		(CONT)
    1485  * *****************************
    1486  
    1487    USE-ALL-DONE.
    1488  	IF Z = ZERO
    1489  		GO TO USE-ALL-DONE-END.
    1490  	PERFORM USE-ALL-BREAK THRU USE-ALL-BREAK-END.
    1491  	MOVE Z TO LIST-TOT-LINES.
    1492  	MOVE LIST-HDR-3 TO LIST-REC.
    1493  	MOVE USE-12-TOT TO U-USE-12.
    1494  	MOVE USE-12P-TOT TO U-UP-12.
    1495  	MOVE USE-6-TOT TO U-USE-6.
    1496  	MOVE USE-6P-TOT TO U-UP-6.
    1497  	MOVE ZERO TO USE-CHG.
    1498  	SUBTRACT USE-6-TOT FROM USE-12-TOT.
    1499  	IF USE-12-TOT = USE-6-TOT
    1500  		NEXT SENTENCE;
    1501  	ELSE, IF USE-12-TOT > USE-6-TOT
    1502  	   COMPUTE USE-CHG = (((USE-12-TOT - USE-6-TOT)/USE-12-TOT)*100)
    1503  		MOVE '-' TO USE-SIGN;
    1504  	ELSE,
    1505  	   COMPUTE USE-CHG = (((USE-6-TOT - USE-12-TOT)/USE-12-TOT)*100)
    1506  		MOVE '+' TO USE-SIGN.    P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 32-2
    LISTYM.CBL    19-NOV-65  18:29

    1507  	IF USE-CHG NOT = ZERO
    1508  		IF USE-12-TOT NOT = ZERO
    1509  			MOVE USE-SIGN TO U-CHG-SIGN
    1510  			MOVE USE-CHG TO U-CHG-QUAN
    1511  			MOVE '%' TO U-CHG-PCT-SIGN;
    1512  		ELSE, MOVE '+++++' TO U-CHANGE.
    1513  	WRITE LIST-REC AFTER ADVANCING 2 LINES.
    1514    USE-ALL-DONE-END. EXIT.
    1515      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 33
    LISTYM.CBL    19-NOV-65  18:29

    1516  * *****************************
    1517  * 	HEADER ROUTINES
    1518  * *****************************
    1519  
    1520    ORDER-HEADER-INIT.
    1521  	MOVE '*' TO WS-ANS.
    1522    LIST-HEADER-INIT.
    1523  	MOVE WS-LIST-SITE-NO TO N-KEY LIST-SITE-NO.
    1524  	READ NAME-FILE INVALID KEY
    1525  		GO TO NAME-FILE-ERROR.
    1526  	MOVE ZERO TO WS-PAGE.
    1527  	MOVE N-NAME TO LIST-SITE-NAME.
    1528  	IF WS-ANS = '*'
    1529  		GO TO LIST-HEADER.
    1530  	MOVE WS-DATE TO LIST-DATE.
    1531  	MOVE JULIAN-DATE TO L-JULIAN-DATE.
    1532  	IF X = 1
    1533  		MOVE 'X' TO LIST-CREF;
    1534  	ELSE, MOVE '-' TO LIST-CREF.
    1535  	IF Y = 1
    1536  		MOVE 'Z' TO LIST-ZERO;
    1537  	ELSE, MOVE '-' TO LIST-ZERO.
    1538    LIST-HEADER.
    1539  	ADD 1 TO WS-PAGE.
    1540  	MOVE WS-PAGE TO L-PAGE.
    1541  	MOVE ZERO TO WS-LINE.
    1542  	WRITE LIST-REC FROM LIST-HDR-1 AFTER ADVANCING TOP.
    1543  	WRITE LIST-REC FROM LIST-HDR-N AFTER ADVANCING 2 LINES.
    1544  	MOVE SPACES TO LIST-REC.
    1545  	WRITE LIST-REC AFTER ADVANCING 1 LINES.
    1546    LIST-HEADER-END. EXIT.
    1547      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 34
    LISTYM.CBL    19-NOV-65  18:29

    1548  * ***********************************************************
    1549  * 	DATE - ROUTINE TO FORMAT 'TODAY' AND COMPUTE JULIAN DATE
    1550  * 	CALLED FROM FIRST PHASE OF PROCEDURE DIVISION
    1551  * ***********************************************************
    1552  
    1553    DATE.
    1554  	MOVE TODAY TO WS-TEMP-DATE.
    1555  	MOVE WSTM TO WS-MONTH, I.
    1556  	MOVE WSTD TO WS-DAY.
    1557  	MOVE WSTY TO WS-YEAR.
    1558  	MOVE DATE-TBL (I) TO JULIAN-DAY.
    1559  	ADD WSTD TO JULIAN-DAY.
    1560  	MOVE WS-YEAR-DIGIT-2 TO JULIAN-YEAR.
    1561  	SUBTRACT 1 FROM JULIAN-YEAR GIVING AGE-12-YEAR.
    1562  	MOVE JULIAN-DAY TO AGE-12-DAY.
    1563  	IF JULIAN-DAY > 182
    1564  		MOVE JULIAN-YEAR TO AGE-6-YEAR
    1565  		SUBTRACT 182 FROM JULIAN-DAY GIVING AGE-6-DAY;
    1566  	ELSE, SUBTRACT 1 FROM JULIAN-YEAR GIVING AGE-6-YEAR
    1567  		COMPUTE AGE-6-DAY = (365 - (182 - JULIAN-DAY)).
    1568    DATE-END.
    1569  
    1570  
    1571  * *****************************
    1572  *  ROUTINE TO CONV BACK FM JULIAN
    1573  *  CALLED W/ JULIAN-DATE IN WS-JULIAN-DATE
    1574  * *****************************
    1575  
    1576    DATE-CONV.
    1577  	IF WS-CONV-DAY > 365 
    1578  		MOVE '*ERROR*' TO WS-DATE-OUT
    1579  		GO TO DATE-CONV-END.
    1580  	MOVE 1 TO I.
    1581    DATE-CONV-LOOP.
    1582  	IF DATE-TBL(I) NOT > WS-CONV-DAY
    1583  		ADD 1 TO I
    1584  		GO TO DATE-CONV-LOOP.
    1585  	SUBTRACT 1 FROM I.
    1586  	MOVE I TO WS-MONTH-OUT.
    1587  	SUBTRACT DATE-TBL(I) FROM WS-CONV-DAY GIVING WS-DAY-OUT.
    1588  	MOVE WS-YEAR-DIGIT-1 TO WS-YEAR-OUT-1.
    1589  	MOVE WS-CONV-YEAR TO WS-YEAR-OUT-2.
    1590  	MOVE '-' TO WS-D-SEP-1 WS-D-SEP-2.
    1591    DATE-CONV-END. EXIT.
    1592  
    1593    YES-NO.
    1594  	ACCEPT WS-ANS.
    1595  	IF WS-ANS NOT = 'Y' AND WS-ANS NOT = 'N'
    1596  		DISPLAY '!! Y OR N ONLY !!'
    1597  		GO TO YES-NO.
    1598    YES-NO-END.
    1599      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 35
    LISTYM.CBL    19-NOV-65  18:29

    1600  * *********************************************************************
    1601  * 
    1602  * 	MASTER-FILE READ ROUTINE
    1603  * 
    1604  * *********************************************************************
    1605  
    1606    GET-MASTER.
    1607  	MOVE WS-PARTNO TO M-K-PARTNO.
    1608  	MOVE SPACES TO M-K-PL.
    1609    GET-MASTER-LOOP.
    1610  	READ MAST-FILE INVALID KEY
    1611  		MOVE 0 TO RET-CODE
    1612  		GO TO GET-MASTER-END.
    1613  	IF M-FLAG = 1 AND M-K-PL = SPACES
    1614  		MOVE N-PL TO M-K-PL
    1615  		GO TO GET-MASTER-LOOP.
    1616  	IF M-CREF = 'X'
    1617  		MOVE M-CREF-PN-PL TO M-K-PN-PL
    1618  		GO TO GET-MASTER-LOOP.
    1619  	MOVE 1 TO RET-CODE.
    1620    GET-MASTER-END.
    1621      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE 36
    LISTYM.CBL    19-NOV-65  18:29

    1622  * *********************************************************************
    1623  * 
    1624  * 	FILE ERROR ROUTINES
    1625  * 
    1626  * *********************************************************************
    1627  
    1628    SITE-FILE-ERROR.
    1629  	DISPLAY '** SITE-FILE ERROR **'.
    1630  	DISPLAY 'S-KEY = ' S-KEY '	SITE-REC = ' SITE-REC.
    1631  	DISPLAY '** F A T A L **'.
    1632  	STOP RUN.
    1633  
    1634    NAME-FILE-ERROR.
    1635  	DISPLAY '** NAME-FILE ERROR **'.
    1636  	DISPLAY 'N-KEY = ' N-KEY.
    1637  	DISPLAY 'NAME-REC:'.
    1638  	DISPLAY NAME-REC.
    1639  	DISPLAY '** F A T A L **'.
    1640  	STOP RUN.
    1641      P R O G R A M   L I S T Y M 		COBOL 100A(370001)	11-MAY-77  14:29		PAGE W-1
    LISTYM.CBL    19-NOV-65  18:29

WARNINGS:

    0989  LEAST SIGNIFICANT DIGITS TRUNCATED ON WS-QUAN
    1252  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-PRICE-EXT
    1447  MOST SIGNIFICANT DIGITS TRUNCATED ON USE-SITE-PCT
    1448  LEAST SIGNIFICANT DIGITS TRUNCATED ON U-PCT-6
    1453  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-PRICE-EXT
    1459  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-PRICE-EXT
    1468  MOST SIGNIFICANT DIGITS TRUNCATED ON USE-CHG
    1470  MOST SIGNIFICANT DIGITS TRUNCATED ON USE-CHG
    1475  LEAST SIGNIFICANT DIGITS TRUNCATED ON U-CHG-QUAN
    1502  MOST SIGNIFICANT DIGITS TRUNCATED ON USE-CHG
    1505  MOST SIGNIFICANT DIGITS TRUNCATED ON USE-CHG
    1510  LEAST SIGNIFICANT DIGITS TRUNCATED ON U-CHG-QUAN
    1587  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-DAY-OUT


NO FATAL ERRORS, 13 WARNINGS
   WL;: