    P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 1
    RECTYM.CBL    22-SEP-65  22:14

    0001  * *********************************************************************
    0002  * 
    0003  * 	R E C O M M E N D E D     S P A R E S     R O U T I N E S
    0004  * 
    0005  * *********************************************************************
    0006  
    0007    IDENTIFICATION DIVISION.
    0008    PROGRAM-ID. RECTYM.
    0009    AUTHOR. JIM WESTLAKE.
    0010    REMARKS. TYMAINT-10 RECOMMENDED SPARES ROUTINES.
    0011  
    0012    ENVIRONMENT DIVISION.
    0013    CONFIGURATION SECTION.
    0014    SPECIAL-NAMES.
    0015  	CHANNEL (1) IS TOP.
    0016  
    0017    INPUT-OUTPUT SECTION.
    0018    FILE-CONTROL.
    0019  	SELECT MAST-FILE ASSIGN TO DSK
    0020  	ACCESS MODE IS INDEXED
    0021  	SYMBOLIC KEY IS MAST-KEY
    0022  	RECORD KEY IS M-REC-KEY
    0023  	RECORDING MODE IS SIXBIT.
    0024  
    0025  	SELECT SITE-FILE ASSIGN TO DSK
    0026  	ACCESS MODE IS INDEXED
    0027  	SYMBOLIC KEY IS S-KEY
    0028  	RECORD KEY IS S-REC-KEY
    0029  	RECORDING MODE IS SIXBIT.
    0030  
    0031  	SELECT REC-FILE ASSIGN TO DSK
    0032  	ACCESS MODE IS INDEXED
    0033  	SYMBOLIC KEY IS REC-KEY
    0034  	RECORD KEY IS REC-REC-KEY
    0035  	RECORDING MODE IS SIXBIT.
    0036  
    0037  	SELECT LIST-FILE ASSIGN TO DSK
    0038  	ACCESS MODE IS SEQUENTIAL
    0039  	RECORDING MODE IS ASCII.
    0040  
    0041  	SELECT NEW-FILE ASSIGN TO DSK
    0042  	ACCESS MODE IS SEQUENTIAL
    0043  	RECORDING MODE IS ASCII.
    0044  
    0045  	SELECT GEN-SORT ASSIGN TO DSK DSK DSK DSK DSK.
    0046      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 2
    RECTYM.CBL    22-SEP-65  22:14

    0047  * *********************************************************************
    0048  * 
    0049  * 	F I L E     D E S C R I P T I O N S
    0050  * 
    0051  * *********************************************************************
    0052  
    0053    DATA DIVISION.
    0054    FILE SECTION.
    0055  
    0056    FD	MAST-FILE
    0057  	COPY FDMAST.
    0058C       BLOCK CONTAINS 8 RECORDS 
    0059C       RECORD CONTAINS 90 CHARACTERS 
    0060C       LABEL RECORDS ARE STANDARD 
    0061C       VALUE OF IDENTIFICATION IS 'TYM10MIDX'.
    0062C   01  MAST-REC.
    0063C       02      M-REC-KEY.
    0064C         04    M-REC-PN-PL.
    0065C           06  M-PARTNO        PIC X(11).
    0066C           06  M-PL            PIC X.
    0067C       02      M-FLAG          PIC X.
    0068C       02      M-CREF          PIC X.
    0069C       02      M-DESC.
    0070C         04    M-CREF-SEE      PIC X(4).
    0071C         04    M-CREF-PN-PL.
    0072C           06  M-CREF-PARTNO   PIC X(11).
    0073C           06  M-CREF-PL       PIC X.
    0074C         04    FILLER          PIC X(5).
    0075C       02      M-VC            PIC X(2).
    0076C       02      M-VPN           PIC X(14).
    0077C       02      M-REV-CREF.
    0078C         04    M-REV-CREF-PN   PIC X(11).
    0079C         04    M-REV-CREF-PL   PIC X.
    0080C       02      M-PRICE         PIC 9999V99.
    0081C       02      M-RR            PIC X.
    0082C       02      M-REC-QUAN      PIC 9(4).
    0083C       02      M-OPT           PIC X(10).
    0084C       02      M-SITES         PIC 999.
    0085C       02      FILLER          PIC X(3).
    0086                    
    0087      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 3
    RECTYM.CBL    22-SEP-65  22:14

    0088  * **********************************
    0089  * 	FILE DESCRIPTIONS (CONT)
    0090  * **********************************
    0091  
    0092    FD	SITE-FILE
    0093  	COPY FDSITE.
    0094C       BLOCK CONTAINS 18 RECORDS 
    0095C       RECORD CONTAINS 36 CHARACTERS 
    0096C       LABEL RECORDS ARE STANDARD 
    0097C       VALUE OF IDENTIFICATION IS 'TYM10SIDX'.
    0098C   01  SITE-REC.
    0099C       02      S-REC-KEY.
    0100C         04    S-SITE-NO       PIC 99.
    0101C         04    S-PARTNO        PIC X(11).
    0102C         04    S-REC-NO        PIC 9.
    0103C       02      S-LOC           PIC X(5).
    0104C       02      S-MAX           PIC 9999.
    0105C       02      S-ON-HAND       PIC 9999.
    0106C       02      S-FLAG          PIC X.
    0107C       02      S-ON-ORDER      PIC 9999.
    0108C       02      FILLER          PIC X(4).
    0109C   01  SITE-REC-A.
    0110C       02      FILLER          PIC X(14).
    0111C       02      S-ORD-NO        PIC 9999.
    0112C       02      S-ORD-QUAN      PIC 9999.
    0113C       02      S-REQ-NO        PIC 9(5).
    0114C       02      FILLER          PIC X(9).
    0115                    
    0116      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 4
    RECTYM.CBL    22-SEP-65  22:14

    0117  * **********************************
    0118  * 	FILE DESCRIPTIONS (CONT)
    0119  * **********************************
    0120  
    0121    FD	REC-FILE
    0122  	COPY FDREC.
    0123C       BLOCK CONTAINS 15 RECORDS 
    0124C       RECORD CONTAINS 42 CHARACTERS 
    0125C       LABEL RECORDS ARE STANDARD 
    0126C       VALUE OF IDENTIFICATION IS 'TYM10RIDX'.
    0127C   01  REC-REC.
    0128C       02      REC-REC-KEY.
    0129C               04 REC-OPTION   PIC X(10).
    0130C               04 REC-PARTNO   PIC X(11).
    0131C       02      REC-QUANS.
    0132C               04 REC-QUAN-1   PIC 9999.
    0133C               04 REC-QUAN-2   PIC 9999.
    0134C               04 REC-QUAN-3   PIC 9999.
    0135C               04 REC-QUAN-4   PIC 9999.
    0136C       02      REC-PL-ALL      PIC X.
    0137C       02      FILLER          PIC X(4).
    0138                   
    0139  
    0140  
    0141  
    0142    FD	NEW-FILE
    0143  	COPY FDNEW.
    0144C       BLOCK CONTAINS 42 RECORDS 
    0145C       RECORD CONTAINS 18 CHARACTERS 
    0146C       LABEL RECORDS ARE STANDARD 
    0147C       VALUE OF IDENTIFICATION IS 'SITE  SEQ'.
    0148C   01  NEW-REC.
    0149C       02      NEW-REC-KEY.
    0150C               04 NEW-PARTNO   PIC X(11).
    0151C       02      NEW-MAX         PIC 9999.
    0152C       02      FILLER          PIC XXX.
    0153                   
    0154  
    0155  
    0156  
    0157    SD	GEN-SORT.
    0158    01	GEN-SORT-REC.
    0159  	02	GS-PARTNO	PIC X(11).
    0160  	02	GS-QUANS.
    0161  	  04	GS-QUAN-1	PIC 9999.
    0162  	  04	GS-QUAN-2	PIC 9999.
    0163  	  04	GS-QUAN-3	PIC 9999.
    0164  	  04	GS-QUAN-4	PIC 9999.
    0165      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 5
    RECTYM.CBL    22-SEP-65  22:14

    0166  * **********************************
    0167  * 	FILE DESCRIPTIONS (CONT)
    0168  * **********************************
    0169  
    0170    FD	LIST-FILE
    0171  	BLOCK CONTAINS 5 RECORDS
    0172  	RECORD CONTAINS 132 CHARACTERS
    0173  	VALUE OF IDENTIFICATION IS LIST-FILE-NAME.
    0174  
    0175    01	LIST-REC			PIC X(132).
    0176  
    0177    01	CONFIG-LIST-REC.
    0178  	02	CL-PARTNO	PIC X(11).
    0179  	02	FILLER		PIC X.
    0180  	02	CL-DESC		PIC X(21).
    0181  	02	FILLER		PIC X.
    0182  	02	CL-VC		PIC XX.
    0183  	02	FILLER		PIC X.
    0184  	02	CL-VPN		PIC X(14).
    0185  	02	FILLER		PIC XX.
    0186  	02	CL-MAX		PIC ZZZ9.
    0187  	02	FILLER		PIC XX.
    0188  	02	CL-ON-HAND	PIC ZZZ9.
    0189  	02	FILLER		PIC XX.
    0190  	02	CL-PRICE	PIC ZZZ9.99.
    0191  	02	FILLER		PIC X.
    0192  	02	CL-QUAN-1	PIC ZZZ9.
    0193  	02	FILLER		PIC X.
    0194  	02	CL-PRICE-1	PIC ZZZZZ9.99.
    0195  	02	FILLER		PIC X.
    0196  	02	CL-QUAN-2	PIC ZZZ9.
    0197  	02	FILLER		PIC X.
    0198  	02	CL-PRICE-2	PIC ZZZZZ9.99.
    0199  	02	FILLER		PIC X.
    0200  	02	CL-QUAN-3	PIC ZZZ9.
    0201  	02	FILLER		PIC X.
    0202  	02	CL-PRICE-3	PIC ZZZZZ9.99.
    0203  	02	FILLER		PIC X.
    0204  	02	CL-QUAN-4	PIC ZZZ9.
    0205  	02	FILLER		PIC X.
    0206  	02	CL-PRICE-4	PIC ZZZZZ9.99.
    0207      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 6
    RECTYM.CBL    22-SEP-65  22:14

    0208  * *********************************************************************
    0209  * 
    0210  * 	W O R K I N G     S T O R A G E
    0211  * 
    0212  * *********************************************************************
    0213  
    0214    WORKING-STORAGE SECTION.
    0215  
    0216  * *****************************
    0217  * 	ACCUMULATORS
    0218  * *****************************
    0219  
    0220    77	I		PIC 999.
    0221    77	J		PIC 999.
    0222    77	L		PIC 9.
    0223    77	O		PIC 999.
    0224    77	X		PIC 999.
    0225    77	WS-LINE		PIC 999.
    0226    01	WS-PAGE		PIC 999.
    0227  
    0228  * *****************************
    0229  * 	ISAM FILE KEYS
    0230  * *****************************
    0231  
    0232    01	MAST-KEY.
    0233  	02	M-K-PN-PL.
    0234  	  04	M-K-PARTNO	PIC X(11).
    0235  	  04	M-K-PL		PIC X.
    0236    01	WS-MAST-FILE-OPEN	PIC X.
    0237    01	MAST-REC-SAVE		PIC X(90).
    0238  
    0239    01	S-KEY.
    0240  	02	S-K-SITE-NO	PIC 99.
    0241  	02	S-K-PARTNO	PIC X(11).
    0242  	02	S-K-REC-NO	PIC 9.
    0243    01	WS-SITE-FILE-OPEN	PIC X.
    0244  
    0245    01	REC-KEY.
    0246  	02	REC-K-OPTION	PIC X(10).
    0247  	02	REC-K-PARTNO	PIC X(11).
    0248    01	WS-REC-FILE-OPEN	PIC X.
    0249    01	REC-REC-SAVE		PIC X(42).
    0250  
    0251      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 7
    RECTYM.CBL    22-SEP-65  22:14

    0252  * *****************************
    0253  * 	CONTROL LOCATIONS
    0254  * *****************************
    0255  
    0256    01	WS-ENA		PIC 9.
    0257    01	WS-MACRO-ARG.
    0258  	02	WS-MACRO-ARG-1.
    0259  	  04	FILLER		PIC X(5) USAGE DISPLAY-6.
    0260  	  04	WS-MACRO-ARG-N	PIC X    USAGE DISPLAY-6.
    0261  	02	WS-MACRO-ARG-2.
    0262  	  04	FILLER		PIC X(5) USAGE DISPLAY-6.
    0263  	  04	WS-MACRO-ARG-EN	PIC X    USAGE DISPLAY-6.
    0264    01	WS-ANS			PIC X.
    0265    01	RET-CODE		PIC 9.
    0266  
    0267    01	WS-PL		PIC X.
    0268    01	WS-SITE-NAME	PIC X(20).
    0269    01	WS-SITE-NO	PIC 99.
    0270    01	WS-FIELD-NAME	PIC XXXX.
    0271    01	WS-PARTNO	PIC X(11).
    0272    01	WS-DESC		PIC X(21).
    0273    01	WS-CREF-DATA.
    0274  	02 FILLER	PIC X(4).
    0275  	02 WS-CREF-PARTNO	PIC X(11).
    0276  	02 FILLER		PIC X(6).
    0277    01	WS-VC		PIC XX.
    0278    01	WS-VPN		PIC X(14).
    0279    01	WS-MAX		PIC 999.
    0280    01	WS-QUAN		PIC 999.
    0281    01	WS-SYS-OPT.
    0282  	02	WS-S-OPT	PIC X(3).
    0283  	02	WS-S-OPT-NO	PIC 999.
    0284  	02	FILLER		PIC X(4).
    0285  
    0286    01	WS-OPTION	PIC X(10).
    0287    01	WS-OPTION-TABLE.
    0288  	02	WS-OPT-TBL	PIC X(10) OCCURS 25 TIMES.
    0289    01	WS-DEV-ENTRY.
    0290  	02	WS-DEV-BLANK	PIC X VALUE SPACES.
    0291  	02	WS-DEV-NAME	PIC X(9).
    0292  
    0293    01	LIST-FILE-NAME		PIC X(9).
    0294    01	WS-PARTIAL-FLAG		PIC X VALUE SPACES.
    0295      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 8
    RECTYM.CBL    22-SEP-65  22:14

    0296  * *****************************
    0297  * 	TOTAL ACCUMULATORS
    0298  * 	FOR LIST TOTALS
    0299  * *****************************
    0300  
    0301    01	WS-ITEMS-ALL.
    0302  	02	WS-ITEMS-1	PIC 9999.
    0303  	02	WS-ITEMS-2	PIC 9999.
    0304  	02	WS-ITEMS-3	PIC 9999.
    0305  	02	WS-ITEMS-4	PIC 9999.
    0306  
    0307    01	WS-PRICE-ALL.
    0308  	02	WS-PRICE-1	PIC 99999V99.
    0309  	02	WS-PRICE-2	PIC 99999V99.
    0310  	02	WS-PRICE-3	PIC 99999V99.
    0311  	02	WS-PRICE-4	PIC 99999V99.
    0312    01	WS-PRICE-TOT-ALL.
    0313  	02	WS-PRICE-TOT-1	PIC 999999V99.
    0314  	02	WS-PRICE-TOT-2	PIC 999999V99.
    0315  	02	WS-PRICE-TOT-3	PIC 999999V99.
    0316  	02	WS-PRICE-TOT-4	PIC 999999V99.
    0317    01	WS-GRAND-TOT-ALL.
    0318  	02	WS-GRAND-TOT-1	PIC 999999V99.
    0319  	02	WS-GRAND-TOT-2	PIC 999999V99.
    0320  	02	WS-GRAND-TOT-3	PIC 999999V99.
    0321  	02	WS-GRAND-TOT-4	PIC 999999V99.
    0322  
    0323      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 9
    RECTYM.CBL    22-SEP-65  22:14

    0324  * *****************************
    0325  * 	HEADERS
    0326  * *****************************
    0327  
    0328    01	TYPE-OPT-HDR-1.
    0329  	02	FILLER	PIC X(22) VALUE SPACES.
    0330  	02	FILLER	PIC X(23) VALUE 'RECOMMENDED SPARES FOR '.
    0331  	02	TYPE-HDR-OPT	PIC X(10).
    0332  
    0333    01	TYPE-OPT-HDR-2.
    0334  	02	FILLER	PIC X(20) VALUE 'PART NUMBER DESCRIPT'.
    0335  	02	FILLER	PIC X(20) VALUE 'ION         VPN OR G'.
    0336  	02	FILLER	PIC X(20) VALUE 'ENERIC   PRICE   Q-1'.
    0337  	02	FILLER	PIC X(12) VALUE ' Q-2 Q-3 Q-4'.
    0338  
    0339    01	T-REC.
    0340  	02	T-PARTNO	PIC X(11).
    0341  	02	FILLER		PIC X.
    0342  	02	T-DESC		PIC X(18).
    0343  	02	FILLER		PIC XX.
    0344  	02	T-VPN		PIC X(14).
    0345  	02	FILLER		PIC X.
    0346  	02	T-PRICE		PIC ZZZ9.99.
    0347  	02	T-FLAG		PIC X.
    0348  	02	FILLER		PIC XX.
    0349  	02	T-QUAN-1	PIC ZZZ.
    0350  	02	FILLER		PIC X.
    0351  	02	T-QUAN-2	PIC ZZZ.
    0352  	02	FILLER		PIC X.
    0353  	02	T-QUAN-3	PIC ZZZ.
    0354  	02	FILLER		PIC X.
    0355  	02	T-QUAN-4	PIC ZZZ.
    0356  
    0357    01	T-TOTAL-LINE.
    0358  	02	FILLER		PIC X(6) VALUE 'LEVEL '.
    0359  	02	T-TOTAL-LEVEL	PIC 9.
    0360  	02	FILLER		PIC X(5) VALUE SPACES.
    0361  	02	T-LINE-ITEMS	PIC ZZZ9.
    0362  	02	FILLER	PIC X(22) VALUE ' LINE ITEMS - PRICE = '.
    0363  	02	T-TOTAL-PRICE	PIC ZZZZZ9.99.
    0364      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 10
    RECTYM.CBL    22-SEP-65  22:14

    0365  * *****************************
    0366  * 	HEADERS (CONT)
    0367  * *****************************
    0368  
    0369    01	WS-HDR-1.
    0370  	02	FILLER		PIC X(129).
    0371  	02	WS-HDR-PAGE	PIC ZZZ.
    0372    01	WS-HDR-2		PIC X(132).
    0373  
    0374    01	LC-HDR-1.
    0375  	02	FILLER		PIC X(42) VALUE SPACES.
    0376  	02	LC1-SITE-NAME	PIC X(20).
    0377  	02	FILLER		PIC X(19) VALUE ' TEST REC-LIST FOR '.
    0378  	02	LC-OPTION	PIC X(10).
    0379  	02	FILLER		PIC X(33) VALUE SPACES.
    0380  	02	FILLER		PIC X(5)  VALUE 'PAGE '.
    0381  	02	FILLER		PIC X(3) VALUE SPACES.
    0382    01	LC-HDR-2.
    0383  	02	FILLER		PIC X(20) VALUE 'PART NUMBER DESCRIPT'.
    0384  	02	FILLER		PIC X(20) VALUE 'ION           VC VPN'.
    0385  	02	FILLER		PIC X(20) VALUE ' OR GENERIC   MAX   '.
    0386  	02	FILLER		PIC X(20) VALUE 'O/H   PRICE    Q-1  '.
    0387  	02	FILLER		PIC X(20) VALUE 'PRICE-1   Q-2  PRICE'.
    0388  	02	FILLER		PIC X(20) VALUE '-2   Q-3  PRICE-3   '.
    0389  	02	FILLER		PIC X(12) VALUE 'Q-4  PRICE-4'.
    0390  
    0391    01	LC-HDR-3.
    0392  	02	FILLER		PIC X(42) VALUE SPACES.
    0393  	02	FILLER		PIC X(20) VALUE 'RECOMMENDED SPARES L'.
    0394  	02	FILLER		PIC X(8)  VALUE 'IST FOR '.
    0395  	02	LC3-SITE-NAME	PIC X(20).
    0396  	02	FILLER		PIC X(34).
    0397  	02	FILLER		PIC X(8)  VALUE 'PAGE    '.
    0398  
    0399    01	LC-TOT-LINE	PIC X(22) VALUE 'TOTAL LINE ITEMS/PRICE'.
    0400  
    0401  
    0402  * *****************************
    0403  * 	MESSAGES, ETC
    0404  * *****************************
    0405  
    0406    01	MSG-FILE-ERROR.
    0407  	02	FILLER		PIC X(14) VALUE '** ERROR ON A '.
    0408  	02	MSG-ERR-TYPE	PIC X(7).
    0409  	02	FILLER		PIC X(4)  VALUE ' TO '.
    0410  	02	MSG-ERR-FILE	PIC X(4).
    0411  	02	FILLER		PIC X(8)  VALUE '-FILE **'.
    0412  
    0413    01	MSG-FATAL		PIC X(15) VALUE '** F A T A L **'.
    0414      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 11
    RECTYM.CBL    22-SEP-65  22:14

    0415  * *********************************************************************
    0416  * 
    0417  * 	P R O C E D U R E     D I V I S I O N
    0418  * 
    0419  * *********************************************************************
    0420  
    0421    PROCEDURE DIVISION.
    0422  
    0423  * *****************************
    0424    DECLARATIVES.
    0425  * *****************************
    0426  
    0427    MAST-BUSY SECTION.
    0428  	USE AFTER STANDARD ERROR PROCEDURE ON MAST-FILE OPEN.
    0429  
    0430    MAST-BUSY-ROUTINE.
    0431  	DISPLAY '<MAST-FILE BUSY - WAITING...>'.
    0432  	ENTER MACRO WAIT.
    0433  
    0434    REC-BUSY SECTION.
    0435  	USE AFTER STANDARD ERROR PROCEDURE ON REC-FILE OPEN.
    0436  
    0437    REC-BUSY-ROUTINE.
    0438  	DISPLAY '<REC-FILE BUSY - WAITING...>'.
    0439  	ENTER MACRO WAIT.
    0440  
    0441  * *****************************
    0442    END DECLARATIVES.
    0443  * *****************************
    0444      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 12
    RECTYM.CBL    22-SEP-65  22:14

    0445    MAIN-PROGRAM SECTION.
    0446    START-PROGRAM-HERE.
    0447  
    0448  * *****************************
    0449  * 	START PROGRAM HERE
    0450  * *****************************
    0451  
    0452  	MOVE SPACES TO WS-MACRO-ARG.
    0453  	ENTER MACRO INVINI USING WS-MACRO-ARG.
    0454  	IF WS-MACRO-ARG-1 NOT = 'RUN' OR WS-MACRO-ARG-EN NOT NUMERIC
    0455  		ENTER MACRO LOGOFF.
    0456  	MOVE WS-MACRO-ARG-EN TO WS-ENA.
    0457  	DISPLAY 'RECOMMENDED SPARES ROUTINES'.
    0458  	DISPLAY ' '.
    0459  
    0460  * *****************************
    0461  * 	PROCEDURE DISPATCH
    0462  * *****************************
    0463  
    0464    PROC.
    0465  	DISPLAY 'PROCEDURE: ' WITH NO ADVANCING.
    0466  	ACCEPT WS-ANS.
    0467  	IF WS-ANS = 'A' GO TO ADD-REC;
    0468  	ELSE, IF WS-ANS = 'C' GO TO CHANGE-REC;
    0469 E, IF WS-ANS = 'D' GO TO DELETE-REC;
    0470  	ELSE, IF WS-ANS = 'E' OR WS-ANS = 'Q'
    0471  		IF WS-ENA = ZERO STOP RUN;
    0472  		ELSE, ENTER MACRO LOGOFF;
    0473  	ELSE, IF WS-ANS = 'G' GO TO GENERATE-SITE-FILE;
    0474  	ELSE, IF WS-ANS = 'L' GO TO LIST-CONFIGURATION;
    0475  	ELSE, IF WS-ANS = 'M'
    0476  		MOVE 'MASTYM' TO WS-MACRO-ARG
    0477  		MOVE WS-ENA TO WS-MACRO-ARG-EN
    0478  		ENTER MACRO RUNNIT USING WS-MACRO-ARG.
    0479  	IF WS-ANS = 'O' GO TO TYPE-OPTIONS;
    0480  	ELSE, IF WS-ANS = 'S'
    0481  		MOVE 'SITTYM' TO WS-MACRO-ARG
    0482  		MOVE WS-ENA TO WS-MACRO-ARG-EN
    0483  		ENTER MACRO RUNNIT USING WS-MACRO-ARG;
    0484  	ELSE, IF WS-ANS = 'T' GO TO TYPE-OPTION;
    0485  	ELSE, IF WS-ANS = 'Z'
    0486  		MOVE 'CONTYM' TO WS-MACRO-ARG
    0487  		MOVE WS-ENA TO WS-MACRO-ARG-EN
    0488  		ENTER MACRO RUNNIT USING WS-MACRO-ARG;
    0489  	ELSE, IF WS-ANS = '?' GO TO HELP;
    0490  	ELSE, DISPLAY 'INVALID - TYPE ? FOR HELP'
    0491  		GO TO PROC.
    0492      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 13
    RECTYM.CBL    22-SEP-65  22:14

    0493  * *********************************************************************
    0494  * 
    0495  * 	HELP ROUTINE - TYPES LIST OF VALID PROCEDURES
    0496  * 
    0497  * *********************************************************************
    0498  
    0499    HELP.
    0500  	DISPLAY 'VALID COMMANDS ARE:'.
    0501  	DISPLAY 'A - ADD RECORDS TO REC-FILE'.
    0502  	DISPLAY 'C - CHANGE RECORDS IN REC-FILE'.
    0503  	DISPLAY 'D - DELETE RECORDS FROM REC-FILE'.
    0504  	DISPLAY 'E - EXIT'.
    0505  	DISPLAY 'G - GENERATE SITE RECOMMENDED SPARES FILE'.
    0506  	DISPLAY 'L - LIST REC-FILE'.
    0507  	DISPLAY 'M - ENTER MASTYM (MASTER FILE ROUTINES)'.
    0508  	DISPLAY 'O - TYPE OPTIONS IN REC-FILE'.
    0509  	DISPLAY 'Q - QUIT (EXIT)'.
    0510  	DISPLAY 'S - ENTER SITTYM (SITE INVENTORY SYSTEM)'.
    0511  	DISPLAY 'T - TYPE RECOMMENDED SPARES FOR AN OPTION'.
    0512  	DISPLAY '? - TYPE THIS TEXT'.
    0513  	DISPLAY ' '.
    0514  	GO TO PROC.
    0515      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 14
    RECTYM.CBL    22-SEP-65  22:14

    0516  * *********************************************************************
    0517  * 
    0518  * 	ADD-REC - ROUTINE TO ADD OPTIONS/RECORDS TO REC-FILE
    0519  * 
    0520  * *********************************************************************
    0521  
    0522    ADD-REC.
    0523  
    0524    ADD-REC-OPT-LOOP.
    0525  	DISPLAY 'ADD SPARES FOR OPTION - ' WITH NO ADVANCING.
    0526  	ACCEPT WS-DEV-NAME.
    0527  	IF WS-DEV-NAME = '.'
    0528  		GO TO PROC.
    0529  	MOVE WS-DEV-ENTRY TO REC-KEY.
    0530  	PERFORM READ-REC-FILE THRU READ-REC-FILE-END.
    0531  	IF RET-CODE NOT = 1
    0532  		GO TO ADD-REC-WRITE-PRIME.
    0533  	DISPLAY WS-DEV-NAME ' EXISTS IN REC-FILE - PROCEED ?'
    0534  		WITH NO ADVANCING.
    0535  	PERFORM YES-NO.
    0536  	IF WS-ANS = 'N'
    0537  		GO TO ADD-REC-OPT-LOOP;
    0538  		ELSE, MOVE WS-DEV-NAME TO REC-KEY
    0539  			MOVE REC-PL-ALL TO WS-PL
    0540  			GO TO ADD-REC-PARTNO-LOOP.
    0541    ADD-REC-WRITE-PRIME.
    0542    ADD-REC-PL-LOOP.
    0543  	DISPLAY 'P/L - ' WITH NO ADVANCING.
    0544  	ACCEPT WS-PL.
    0545  	IF WS-PL NOT = 'D' AND WS-PL NOT = 'I' AND WS-PL NOT = 'X'
    0546  		DISPLAY '** INVALID - '
    0547  		GO TO ADD-REC-PL-LOOP.
    0548  	PERFORM OPEN-O-REC-FILE THRU OPEN-O-REC-FILE-END.
    0549  	MOVE WS-DEV-ENTRY TO REC-KEY.
    0550  	MOVE WS-PL TO REC-PL-ALL.
    0551  	PERFORM WRITE-REC-REC THRU WRITE-REC-REC-END.
    0552  	MOVE WS-DEV-NAME TO REC-K-OPTION.
    0553  	PERFORM WRITE-REC-REC THRU WRITE-REC-REC-END.
    0554  	PERFORM CLOSE-REC-FILE THRU CLOSE-REC-FILE-END.
    0555    ADD-REC-PARTNO-LOOP.
    0556  	DISPLAY 'P/N: ' WITH NO ADVANCING.
    0557  	ACCEPT WS-PARTNO.
    0558  	IF WS-PARTNO = SPACES
    0559  		GO TO ADD-REC-PARTNO-LOOP;
    0560  	ELSE, IF WS-PARTNO = '.'
    0561  		GO TO ADD-REC-OPT-LOOP.
    0562  	MOVE WS-PARTNO TO REC-K-PARTNO.
    0563  	PERFORM READ-REC-FILE THRU READ-REC-FILE-END.
    0564  	IF RET-CODE NOT = 1
    0565  		GO TO ADD-REC-GET-DATA.
    0566  	DISPLAY 'OPT-P/N ' REC-KEY ' ALREADY EXISTS - ABORTING'.
    0567  	GO TO ADD-REC-PARTNO-LOOP.
    0568      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 15
    RECTYM.CBL    22-SEP-65  22:14

    0569  * *****************************
    0570  * 	ADD (CONT)
    0571  * *****************************
    0572  
    0573    ADD-REC-GET-DATA.
    0574  	PERFORM READ-MASTER THRU READ-MASTER-END.
    0575  	IF RET-CODE = 1
    0576  		GO TO ADD-REC-GO.
    0577  	DISPLAY WS-PARTNO ' NOT IN MASTER FILE - ADD ? '
    0578  		WITH NO ADVANCING.
    0579  	PERFORM YES-NO.
    0580  	IF WS-ANS = 'N'
    0581  		DISPLAY '* ABORTING *'
    0582  		GO TO ADD-REC-PARTNO-LOOP.
    0583  	DISPLAY 'DESC: ' WITH NO ADVANCING.
    0584  	ACCEPT M-DESC.
    0585  	DISPLAY 'VPN: ' WITH NO ADVANCING.
    0586  	ACCEPT M-VPN.
    0587  	DISPLAY 'VC: ' WITH NO ADVANCING.
    0588  	ACCEPT M-VC.
    0589  	DISPLAY 'PRICE: ' WITH NO ADVANCING.
    0590  	ACCEPT M-PRICE.
    0591    ADD-GET-RR-CODE.
    0592  	DISPLAY 'R/R CODE - ' WITH NO ADVANCING.
    0593  	ACCEPT M-RR.
    0594  	IF M-RR NOT = 'E' AND M-RR NOT = 'R'
    0595  		DISPLAY '* INVALID - VALID R/R CODES ARE:'
    0596  		DISPLAY 'E - EXPENDABLE'
    0597  		DISPLAY 'R - REPAIRABLE'
    0598  		GO TO ADD-GET-RR-CODE.
    0599  	MOVE WS-OPTION TO M-OPT.
    0600  	PERFORM WRITE-MAST-REC THRU WRITE-MAST-REC-END.
    0601      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 16
    RECTYM.CBL    22-SEP-65  22:14

    0602  * *****************************
    0603  * 	ADD (CONT)
    0604  * *****************************
    0605  
    0606    ADD-REC-GO.
    0607  	IF M-PRICE = ZERO
    0608  		DISPLAY 'PRICE: ' WITH NO ADVANCING
    0609  		ACCEPT M-PRICE.
    0610  	DISPLAY 'QUAN-1: ' WITH NO ADVANCING.
    0611  	ACCEPT REC-QUAN-1.
    0612  	IF REC-QUAN-1 = 0
    0613  		MOVE 1 TO REC-QUAN-1
    0614  		MOVE ZERO TO REC-QUAN-2 REC-QUAN-3 REC-QUAN-4
    0615  		GO TO ADD-REC-QUAN-END.
    0616  	DISPLAY 'QUAN-2: ' WITH NO ADVANCING.
    0617  	ACCEPT REC-QUAN-2.
    0618  	IF REC-QUAN-2 = 0
    0619  		MOVE ZERO TO REC-QUAN-3 REC-QUAN-4
    0620  		GO TO ADD-REC-QUAN-END.
    0621  	DISPLAY 'QUAN-3: ' WITH NO ADVANCING.
    0622  	ACCEPT REC-QUAN-3.
    0623  	IF REC-QUAN-3 = 0
    0624  		MOVE ZERO TO REC-QUAN-4
    0625  		GO TO ADD-REC-QUAN-END.
    0626  	DISPLAY 'QUAN-4: ' WITH NO ADVANCING.
    0627  	ACCEPT REC-QUAN-4.
    0628    ADD-REC-QUAN-END.
    0629  	DISPLAY 'OK? ' WITH NO ADVANCING.
    0630  	PERFORM YES-NO.
    0631  	IF WS-ANS = 'N'
    0632  		GO TO ADD-REC-PARTNO-LOOP.
    0633  	PERFORM WRITE-REC-REC THRU WRITE-REC-REC-END.
    0634  	IF M-OPT = SPACES OR M-OPT = 'SYSTEM'
    0635  		MOVE REC-OPTION TO M-OPT;
    0636  	ELSE, IF M-OPT = REC-OPTION
    0637  		NEXT SENTENCE;
    0638  		ELSE, MOVE M-OPT TO WS-SYS-OPT
    0639  			IF WS-S-OPT = 'SYS'
    0640  				ADD 1 TO WS-S-OPT-NO
    0641  				MOVE WS-SYS-OPT TO M-OPT;
    0642  			ELSE, MOVE 'SYS' TO WS-S-OPT
    0643  				MOVE 2 TO WS-S-OPT-NO
    0644  				MOVE WS-SYS-OPT TO M-OPT.
    0645  	IF REC-QUAN-1 > M-REC-QUAN
    0646  		MOVE REC-QUAN-1 TO M-REC-QUAN.
    0647  	PERFORM REWRITE-MAST-REC THRU REWRITE-MAST-REC-END.
    0648  	GO TO ADD-REC-PARTNO-LOOP.
    0649      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 17
    RECTYM.CBL    22-SEP-65  22:14

    0650  * *********************************************************************
    0651  * 
    0652  * 	CHANGE RECORDS IN RECOMMENDED SPARES FILE
    0653  * 
    0654  * *********************************************************************
    0655    CHANGE-REC.
    0656  	DISPLAY 'CHANGE RECORDS IN REC-FILE'.
    0657  	DISPLAY ' '.
    0658    CHANGE-REC-OPT-LOOP.
    0659  	DISPLAY 'OPTION: ' WITH NO ADVANCING.
    0660  	ACCEPT REC-K-OPTION.
    0661  	IF REC-K-OPTION = '.'
    0662  		GO TO PROC.
    0663  	MOVE SPACES TO REC-K-PARTNO.
    0664  	PERFORM READ-REC-FILE THRU READ-REC-FILE-END.
    0665  	IF RET-CODE NOT = 1
    0666  		DISPLAY 'OPTION ' REC-K-OPTION ' NOT IN REC-FILE'
    0667  		GO TO CHANGE-REC-OPT-LOOP.
    0668    CHANGE-REC-PN-LOOP.
    0669  	PERFORM CLOSE-OUT-REC-FILE THRU CLOSE-OUT-REC-FILE-END.
    0670  	DISPLAY REC-K-OPTION '/  P/N- ' WITH NO ADVANCING.
    0671  	ACCEPT REC-K-PARTNO.
    0672  	IF REC-K-PARTNO = '.'
    0673  		GO TO CHANGE-REC-OPT-LOOP.
    0674  	PERFORM READ-REC-FILE THRU READ-REC-FILE-END.
    0675  	IF RET-CODE NOT = 1
    0676  		DISPLAY REC-KEY '  NOT IN REC-FILE'
    0677  		GO TO CHANGE-REC-PN-LOOP.
    0678    CHANGE-REC-LOOP.
    0679  	DISPLAY 'QUAN-1 = ' REC-QUAN-1 '   QUAN-1 - ' WITH NO ADVANCING.
    0680  	ACCEPT REC-QUAN-1.
    0681  	DISPLAY 'QUAN-2 = ' REC-QUAN-2 '   QUAN-2 - ' WITH NO ADVANCING.
    0682  	ACCEPT REC-QUAN-2.
    0683  	DISPLAY 'QUAN-3 = ' REC-QUAN-3 '   QUAN-3 - ' WITH NO ADVANCING.
    0684  	ACCEPT REC-QUAN-3.
    0685  	DISPLAY 'QUAN-4 = ' REC-QUAN-4 '   QUAN-4 - ' WITH NO ADVANCING.
    0686  	ACCEPT REC-QUAN-4.
    0687  	DISPLAY 'OK ?  ' WITH NO ADVANCING.
    0688  	PERFORM YES-NO.
    0689  	IF WS-ANS = 'N'
    0690  		DISPLAY '** ABORTING **'
    0691  		GO TO CHANGE-REC-PN-LOOP.
    0692  	PERFORM REWRITE-REC-REC THRU REWRITE-REC-REC-END.
    0693  	GO TO CHANGE-REC-PN-LOOP.
    0694      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 18
    RECTYM.CBL    22-SEP-65  22:14

    0695  * *********************************************************************
    0696  * 
    0697  * 	DELETE RECORDS FROM RECOMMENDED SPARES FILE
    0698  * 
    0699  * *********************************************************************
    0700  
    0701    DELETE-REC.
    0702  	DISPLAY 'DELETE RECORDS FROM REC-FILE'.
    0703    DELETE-REC-OPT-LOOP.
    0704  	DISPLAY 'OPTION: ' WITH NO ADVANCING.
    0705  	ACCEPT REC-K-OPTION.
    0706  	IF REC-K-OPTION = '.'
    0707  		GO TO PROC.
    0708    DELETE-REC-PN-LOOP.
    0709  	PERFORM CLOSE-OUT-REC-FILE THRU CLOSE-OUT-REC-FILE-END.
    0710  	DISPLAY REC-K-OPTION ' / P/N: ' WITH NO ADVANCING.
    0711  	ACCEPT REC-K-PARTNO.
    0712  	IF REC-K-PARTNO = '.'
    0713  		GO TO DELETE-REC-OPT-LOOP.
    0714  	PERFORM OPEN-IO-REC-FILE THRU OPEN-IO-REC-FILE-END.
    0715  	DELETE REC-REC INVALID KEY
    0716  		DISPLAY REC-KEY ' NON-EXISTANT'.
    0717  	GO TO DELETE-REC-PN-LOOP.
    0718      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 19
    RECTYM.CBL    22-SEP-65  22:14

    0719  * *********************************************************************
    0720  * 
    0721  * 	GENERATE RECOMMENDED SPARES FILE FOR SITE CONFIGURATION
    0722  * 
    0723  * *********************************************************************
    0724  
    0725    GENERATE-SITE-FILE.
    0726  	ENTER MACRO CONCHK USING WS-MACRO-ARG.
    0727  	IF WS-MACRO-ARG-N = '!'
    0728  		DISPLAY '** SYSTEM CONTROLLED **'
    0729  		IF WS-ENA NOT = ZERO
    0730  			DISPLAY '* GEN NOT ALLOWED DURING PRIME TIME *'
    0731  			GO TO PROC.
    0732  	PERFORM OPEN-I-REC-FILE THRU OPEN-I-REC-FILE-END.
    0733  	DISPLAY 'GENERATE SPARES  FILE FOR SITE'.
    0734  	DISPLAY 'SITE NAME - ' WITH NO ADVANCING.
    0735  	ACCEPT LC3-SITE-NAME.
    0736  	MOVE LC-HDR-3 TO WS-HDR-1.
    0737  	MOVE LC-HDR-2 TO WS-HDR-2.
    0738  	MOVE ZERO TO WS-PAGE WS-LINE.
    0739    GEN-SITE-LEVEL.
    0740  	DISPLAY 'GEN AT LEVEL (1 TO 4) - ' WITH NO ADVANCING.
    0741  	ACCEPT L.
    0742  	IF L NOT > 0 AND L NOT < 5
    0743  		GO TO GEN-SITE-LEVEL.
    0744  	DISPLAY 'STOCK FROM SITE # ' WITH NO ADVANCING.
    0745  	ACCEPT S-K-SITE-NO.
    0746  	MOVE ZERO TO S-K-REC-NO.
    0747  	PERFORM ACCEPT-CONFIGURATION THRU ACCEPT-CONFIG-END.
    0748  	IF RET-CODE NOT = 1
    0749  		GO TO PROC.
    0750  	PERFORM OPEN-I-SITE-FILE THRU OPEN-I-SITE-FILE-END.
    0751  	PERFORM OPEN-I-MAST-FILE THRU OPEN-I-MAST-FILE-END.
    0752  	MOVE 'SITE  LST' TO LIST-FILE-NAME.
    0753  	OPEN OUTPUT LIST-FILE NEW-FILE.
    0754  	PERFORM HEADER.
    0755  	SORT GEN-SORT ON ASCENDING KEY GS-PARTNO
    0756  	INPUT PROCEDURE IS GEN-SORT-INPUT THRU GSI-END
    0757  	OUTPUT PROCEDURE IS GEN-SORT-OUTPUT THRU GSO-END.
    0758  	CLOSE NEW-FILE LIST-FILE.
    0759  	DISPLAY 'SITE-FILE = SITE.SEQ / LIST-FILE = SITE.LST'.
    0760  	GO TO PROC.
    0761  
    0762    GEN-SORT-INPUT.
    0763  	PERFORM GET-NEXT-OPTION THRU GET-NEXT-OPTION-END.
    0764  	IF RET-CODE NOT = 1
    0765  		GO TO GSI-END.
    0766    GEN-SORT-INPUT-LOOP.
    0767  	PERFORM READ-REC-SEQ-OPT THRU READ-REC-SEQ-OPT-END.
    0768  	IF RET-CODE NOT = 1
    0769  		GO TO GEN-SORT-INPUT.
    0770  	MOVE REC-K-PARTNO TO GS-PARTNO.
    0771  	MOVE REC-QUANS TO GS-QUANS.
    0772  	RELEASE GEN-SORT-REC.
    0773  	GO TO GEN-SORT-INPUT-LOOP.
    0774    GSI-END. EXIT.    P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 19-1
    RECTYM.CBL    22-SEP-65  22:14

    0775  
    0776      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 20
    RECTYM.CBL    22-SEP-65  22:14

    0777  * *****************************
    0778  * 	GENERATE SITE (CONT)
    0779  * *****************************
    0780  
    0781    GEN-SORT-OUTPUT.
    0782  	MOVE SPACES TO NEW-REC.
    0783  	MOVE ZERO TO WS-MAX.
    0784  	RETURN GEN-SORT AT END
    0785  		DISPLAY 'NO RECORDS RET FM GEN-SORT **'
    0786  		GO TO GSO-END.
    0787  	MOVE ZERO TO WS-MAX.
    0788  	MOVE GS-PARTNO TO WS-PARTNO.
    0789  	GO TO GEN-SORT-OUTPUT-LOOP-START.
    0790    GEN-SORT-OUTPUT-LOOP.
    0791  	RETURN GEN-SORT AT END
    0792  		GO TO GSO-END.
    0793    GEN-SORT-OUTPUT-LOOP-START.
    0794  	IF L = 1
    0795  		MOVE GS-QUAN-1 TO WS-QUAN;
    0796  	ELSE, IF L = 2
    0797  		MOVE GS-QUAN-2 TO WS-QUAN;
    0798  	ELSE, IF L = 3
    0799  		MOVE GS-QUAN-3 TO WS-QUAN;
    0800  	ELSE, MOVE GS-QUAN-4 TO WS-QUAN.
    0801  	IF GS-PARTNO = WS-PARTNO
    0802  		IF WS-QUAN > WS-MAX
    0803  			MOVE WS-QUAN TO WS-MAX
    0804  			MOVE GS-QUANS TO REC-QUANS
    0805  			GO TO GEN-SORT-OUTPUT-LOOP;
    0806  		ELSE, GO TO GEN-SORT-OUTPUT-LOOP.
    0807  	MOVE WS-PARTNO TO NEW-PARTNO.
    0808  	MOVE WS-MAX TO NEW-MAX.
    0809  	WRITE NEW-REC.
    0810  	PERFORM LIST-CONFIG-LINE THRU LIST-CONFIG-LINE-END.
    0811  	MOVE GS-QUANS TO REC-QUANS.
    0812  	MOVE WS-QUAN TO WS-MAX.
    0813  	MOVE GS-PARTNO TO WS-PARTNO.
    0814  	GO TO GEN-SORT-OUTPUT-LOOP.
    0815    GSO-END.
    0816  	MOVE WS-PARTNO TO NEW-PARTNO.
    0817  	MOVE WS-MAX TO NEW-MAX.
    0818  	WRITE NEW-REC.
    0819  	PERFORM LIST-CONFIG-LINE THRU LIST-CONFIG-LINE-END.
    0820  	PERFORM LIST-CONFIG-TOTAL THRU LIST-CONFIG-TOTAL-END.
    0821      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 21
    RECTYM.CBL    22-SEP-65  22:14

    0822  * *********************************************************************
    0823  * 
    0824  * 	TYPE OPTIONS SUPPORTED IN REC-FILE
    0825  * 
    0826  * *********************************************************************
    0827  
    0828    TYPE-OPTIONS.
    0829  	DISPLAY ' '.
    0830  	DISPLAY 'OPTIONS SUPPORTED:'
    0831  	DISPLAY ' '.
    0832  	MOVE ZERO TO WS-LINE.
    0833  	PERFORM CLOSE-REC-FILE THRU CLOSE-REC-FILE-END.
    0834  	PERFORM OPEN-I-REC-FILE THRU OPEN-I-REC-FILE-END.
    0835  	MOVE LOW-VALUE TO REC-KEY.
    0836    TYPE-OPTIONS-LOOP.
    0837  	READ REC-FILE INVALID KEY
    0838  		GO TO REC-FILE-ERROR.
    0839  	MOVE REC-OPTION TO WS-DEV-ENTRY.
    0840  	IF WS-DEV-BLANK NOT = SPACES
    0841  		MOVE SPACES TO WS-DEV-BLANK
    0842  		GO TO TYPE-OPTIONS-END.
    0843  	ADD 1 TO WS-LINE.
    0844  	DISPLAY REC-OPTION '	P/L=' REC-PL-ALL.
    0845  	GO TO TYPE-OPTIONS-LOOP.
    0846  
    0847    TYPE-OPTIONS-END.
    0848  	DISPLAY ' '.
    0849  	DISPLAY WS-LINE ' TOTAL OPTIONS'.
    0850  	DISPLAY ' '.
    0851  	GO TO PROC.
    0852      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 22
    RECTYM.CBL    22-SEP-65  22:14

    0853  * *********************************************************************
    0854  * 
    0855  * 	LIST RECOMMENDED SPARES FOR SITE CONFIGURATION
    0856  * 
    0857  * *********************************************************************
    0858  
    0859    LIST-CONFIGURATION.
    0860  	ENTER MACRO CONCHK USING WS-MACRO-ARG.
    0861  	IF WS-MACRO-ARG-N = '!'
    0862  		DISPLAY '** SYSTEM CONTROLLED **'
    0863  		IF WS-ENA NOT = ZERO
    0864  			DISPLAY '* LIST NOT ALLOWED DURING PRIME TIME *'
    0865  			GO TO PROC.
    0866  	MOVE 'CONFIGLST' TO LIST-FILE-NAME.
    0867  	PERFORM OPEN-I-REC-FILE THRU OPEN-I-REC-FILE-END.
    0868  	PERFORM OPEN-I-MAST-FILE THRU OPEN-I-MAST-FILE-END.
    0869  	PERFORM OPEN-I-SITE-FILE THRU OPEN-I-SITE-FILE-END.
    0870  	OPEN OUTPUT LIST-FILE.
    0871  	DISPLAY 'LIST RECOMMENDED SPARES FOR SITE CONFIGURATION.'
    0872  	DISPLAY 'SITE NAME - ' WITH NO ADVANCING.
    0873  	ACCEPT WS-SITE-NAME.
    0874  	MOVE WS-SITE-NAME TO LC1-SITE-NAME.
    0875  	MOVE LC-HDR-2 TO WS-HDR-2.
    0876  	DISPLAY 'STOCK FROM SITE # ' WITH NO ADVANCING.
    0877  	ACCEPT S-K-SITE-NO.
    0878  	MOVE ZERO TO S-K-REC-NO.
    0879  	MOVE ZERO TO WS-GRAND-TOT-ALL.
    0880  	PERFORM ACCEPT-CONFIGURATION THRU ACCEPT-CONFIG-END.
    0881  	IF RET-CODE NOT = 1
    0882  		CLOSE LIST-FILE
    0883  		GO TO PROC.
    0884    LIST-CONFIG-OPT-LOOP.
    0885  	MOVE ZEROS TO WS-PRICE-TOT-ALL WS-ITEMS-ALL.
    0886  	PERFORM GET-NEXT-OPTION THRU GET-NEXT-OPTION-END.
    0887  	IF RET-CODE NOT = 1
    0888  		GO TO LIST-CONFIG-END.
    0889  	MOVE WS-OPTION TO LC-OPTION.
    0890  	MOVE LC-HDR-1 TO WS-HDR-1.
    0891  	PERFORM HEADER.
    0892    LIST-CONFIG-ITEM-LOOP.
    0893  	PERFORM READ-REC-SEQ-OPT THRU READ-REC-SEQ-OPT-END.
    0894  	IF RET-CODE NOT = 1
    0895  		GO TO LIST-CONFIG-OPT-END.
    0896  	MOVE REC-PARTNO TO WS-PARTNO.
    0897  	PERFORM LIST-CONFIG-LINE THRU LIST-CONFIG-LINE-END.
    0898  	GO TO LIST-CONFIG-ITEM-LOOP.
    0899    LIST-CONFIG-OPT-END.
    0900  	PERFORM LIST-CONFIG-TOTAL THRU LIST-CONFIG-TOTAL-END.
    0901  	GO TO LIST-CONFIG-OPT-LOOP.
    0902      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 23
    RECTYM.CBL    22-SEP-65  22:14

    0903  * *****************************
    0904  * 	LIST CONFIG (CONT)
    0905  * *****************************
    0906  
    0907    LIST-CONFIG-LINE.
    0908  	MOVE SPACES TO CONFIG-LIST-REC.
    0909  	PERFORM READ-MASTER THRU READ-MASTER-END.
    0910  	IF RET-CODE NOT = 1
    0911  		MOVE '* NOT IN MAST FILE *' TO CL-DESC
    0912  		GO TO LIST-CONFIG-NO-MASTER.
    0913  	MOVE M-PARTNO TO CL-PARTNO.
    0914  	MOVE M-DESC TO CL-DESC.
    0915  	MOVE M-VC TO CL-VC.
    0916  	MOVE M-VPN TO CL-VPN.
    0917  	MOVE M-PRICE TO CL-PRICE.
    0918  	PERFORM GET-SITE-REC THRU GET-SITE-REC-END.
    0919  	IF RET-CODE NOT = 1
    0920  		GO TO LIST-CONFIG-NO-MASTER.
    0921  	MOVE S-MAX TO CL-MAX.
    0922  	MOVE S-ON-HAND TO CL-ON-HAND.
    0923    LIST-CONFIG-NO-MASTER.
    0924  	PERFORM COMPUTE-REC-PRICES THRU COMPUTE-REC-PRICES-END.
    0925  	IF REC-QUAN-1 > 0
    0926  		MOVE REC-QUAN-1 TO CL-QUAN-1
    0927  		MOVE WS-PRICE-1 TO CL-PRICE-1.
    0928  	IF REC-QUAN-2 > 0
    0929  		MOVE REC-QUAN-2 TO CL-QUAN-2
    0930  		MOVE WS-PRICE-2 TO CL-PRICE-2.
    0931  	IF REC-QUAN-3 > 0
    0932  		MOVE REC-QUAN-3 TO CL-QUAN-3
    0933  		MOVE WS-PRICE-3 TO CL-PRICE-3.
    0934  	IF REC-QUAN-4 > 0
    0935  		MOVE REC-QUAN-4 TO CL-QUAN-4
    0936  		MOVE WS-PRICE-4 TO CL-PRICE-4.
    0937  	WRITE CONFIG-LIST-REC AFTER ADVANCING 1 LINE.
    0938  	ADD 1 TO WS-LINE.
    0939  	IF WS-LINE > 55
    0940  		PERFORM HEADER.
    0941    LIST-CONFIG-LINE-END. EXIT.
    0942      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 24
    RECTYM.CBL    22-SEP-65  22:14

    0943  * *****************************
    0944  * 	LIST CONFIG (CONT)
    0945  * *****************************
    0946    LIST-CONFIG-TOTAL.
    0947  	MOVE SPACES TO CONFIG-LIST-REC.
    0948  	WRITE CONFIG-LIST-REC AFTER ADVANCING 1 LINE.
    0949  	MOVE LC-TOT-LINE TO CONFIG-LIST-REC.
    0950  	MOVE WS-ITEMS-1 TO CL-QUAN-1.
    0951  	MOVE WS-PRICE-TOT-1 TO CL-PRICE-1.
    0952  	MOVE WS-ITEMS-2 TO CL-QUAN-2.
    0953  	MOVE WS-PRICE-TOT-2 TO CL-PRICE-2.
    0954  	MOVE WS-ITEMS-3 TO CL-QUAN-3.
    0955  	MOVE WS-PRICE-TOT-3 TO CL-PRICE-3.
    0956  	MOVE WS-ITEMS-4 TO CL-QUAN-4.
    0957  	MOVE WS-PRICE-TOT-4 TO CL-PRICE-4.
    0958  	WRITE CONFIG-LIST-REC AFTER ADVANCING 1 LINE.
    0959    LIST-CONFIG-TOTAL-END. EXIT.
    0960  
    0961    LIST-CONFIG-END.
    0962  	MOVE WS-GRAND-TOT-ALL TO WS-PRICE-TOT-ALL.
    0963  	MOVE ZEROS TO WS-ITEMS-ALL.
    0964  	PERFORM LIST-CONFIG-TOTAL THRU LIST-CONFIG-TOTAL-END.
    0965  	CLOSE REC-FILE MAST-FILE LIST-FILE.
    0966  	DISPLAY LIST-FILE-NAME ' IS ON DISK'.
    0967  	GO TO PROC.
    0968      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 25
    RECTYM.CBL    22-SEP-65  22:14

    0969  * *********************************************************************
    0970  * 
    0971  * 	TYPE RECOMMENDED SPARES FOR AN OPTION
    0972  * 
    0973  * *********************************************************************
    0974  
    0975    TYPE-OPTION.
    0976  	DISPLAY 'TYPE RECOMMENDED SPARES FOR AN OPTION'
    0977  	PERFORM OPEN-I-REC-FILE THRU OPEN-I-REC-FILE-END.
    0978  	PERFORM OPEN-I-SITE-FILE THRU OPEN-I-SITE-FILE-END.
    0979  	PERFORM OPEN-I-MAST-FILE THRU OPEN-I-MAST-FILE-END.
    0980    TYPE-OPTION-LOOP.
    0981  	DISPLAY 'FULL LISTING ? ' WITH NO ADVANCING.
    0982  	PERFORM YES-NO.
    0983  	IF WS-ANS = 'Y'
    0984  		MOVE SPACES TO WS-PARTIAL-FLAG;
    0985  	ELSE, MOVE 'P' TO WS-PARTIAL-FLAG.
    0986  	MOVE ZEROS TO WS-ITEMS-ALL WS-PRICE-ALL.
    0987  	DISPLAY 'OPTION - ' WITH NO ADVANCING.
    0988  	ACCEPT WS-OPTION.
    0989  	IF WS-OPTION = '.'
    0990  		GO TO PROC.
    0991  	MOVE WS-OPTION TO REC-K-OPTION.
    0992  	MOVE SPACES TO REC-K-PARTNO.
    0993  	READ REC-FILE INVALID KEY
    0994  		DISPLAY WS-OPTION ' NOT IN REC-FILE'
    0995  		GO TO TYPE-OPTION-LOOP.
    0996  	MOVE REC-PL-ALL TO WS-PL.
    0997  	IF WS-PL = 'D'
    0998  		MOVE ZERO TO S-K-SITE-NO;
    0999  	ELSE, IF WS-PL = 'X'
    1000  		MOVE 1 TO S-K-SITE-NO;
    1001  	ELSE, IF WS-PL = 'I'
    1002  		MOVE 2 TO S-K-SITE-NO.
    1003  	MOVE ZERO TO S-K-REC-NO.
    1004  	DISPLAY 'TYPE <CR> TO BEGIN -'.
    1005  	ACCEPT WS-ANS.
    1006  	MOVE ZERO TO WS-LINE.
    1007  	MOVE REC-PL-ALL TO WS-PL.
    1008  	MOVE WS-OPTION TO TYPE-HDR-OPT.
    1009    TYPE-OPTION-HEADER.
    1010  	DISPLAY TYPE-OPT-HDR-1.
    1011  	DISPLAY ' '.
    1012  	DISPLAY TYPE-OPT-HDR-2.
    1013  	DISPLAY ' '.
    1014    TYPE-OPTION-LINE.
    1015  	MOVE LOW-VALUE TO REC-KEY.
    1016  	READ REC-FILE INVALID KEY
    1017  		GO TO TYPE-OPTION-END.
    1018  	IF REC-OPTION NOT = WS-OPTION
    1019  		GO TO TYPE-OPTION-END.
    1020  	MOVE REC-PARTNO TO T-PARTNO WS-PARTNO.
    1021  	PERFORM READ-MASTER THRU READ-MASTER-END.
    1022  	IF RET-CODE = 0
    1023  		MOVE 'M' TO T-FLAG
    1024  		MOVE '* NOT IN MAST FILE *' TO T-DESC    P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 25-1
    RECTYM.CBL    22-SEP-65  22:14

    1025  		GO TO TYPE-OPTION-NO-MASTER.
    1026  	PERFORM GET-SITE-REC THRU GET-SITE-REC-END.
    1027  	IF RET-CODE = ZERO
    1028  		MOVE 'S' TO T-FLAG
    1029  		GO TO TYPE-OPTION-NO-SITE.
    1030  	IF S-LOC = SPACES OR S-MAX < REC-QUAN-1
    1031  		MOVE 'Q' TO T-FLAG;
    1032  	ELSE, IF S-ON-HAND < REC-QUAN-1
    1033  		MOVE '-' TO T-FLAG;
    1034  	ELSE,IF WS-PARTIAL-FLAG = 'P'
    1035  		GO TO TYPE-OPTION-LINE;
    1036  	ELSE, MOVE SPACES TO T-FLAG.
    1037      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 26
    RECTYM.CBL    22-SEP-65  22:14

    1038  * *****************************
    1039  * 	TYPE OPTION (CONT)
    1040  * *****************************
    1041  
    1042    TYPE-OPTION-NO-SITE.
    1043  	MOVE M-DESC TO T-DESC.
    1044  	MOVE M-VPN TO T-VPN.
    1045  	MOVE M-PRICE TO T-PRICE.
    1046    TYPE-OPTION-NO-MASTER.
    1047  	MOVE REC-QUAN-1 TO T-QUAN-1.
    1048  	MOVE REC-QUAN-2 TO T-QUAN-2.
    1049  	MOVE REC-QUAN-3 TO T-QUAN-3.
    1050  	MOVE REC-QUAN-4 TO T-QUAN-4.
    1051  	IF REC-QUAN-1 NOT = 0
    1052  	    ADD 1 TO WS-ITEMS-1
    1053  	    COMPUTE WS-PRICE-1 = WS-PRICE-1 + (M-PRICE * REC-QUAN-1).
    1054  	IF REC-QUAN-2 NOT = 0
    1055  	    ADD 1 TO WS-ITEMS-2
    1056  	    COMPUTE WS-PRICE-2 = WS-PRICE-2 + (M-PRICE * REC-QUAN-2).
    1057  	IF REC-QUAN-3 NOT = 0
    1058  	    ADD 1 TO WS-ITEMS-3
    1059  	    COMPUTE WS-PRICE-3 = WS-PRICE-3 + (M-PRICE * REC-QUAN-3).
    1060  	IF REC-QUAN-4 NOT = 0
    1061  	    ADD 1 TO WS-ITEMS-4
    1062  	    COMPUTE WS-PRICE-4 = WS-PRICE-4 + (M-PRICE * REC-QUAN-4).
    1063  	ADD 1 TO WS-LINE.
    1064  	DISPLAY T-REC.
    1065  	GO TO TYPE-OPTION-LINE.
    1066  
    1067    TYPE-OPTION-END.
    1068  	DISPLAY ' '.
    1069  	MOVE 1 TO T-TOTAL-LEVEL.
    1070  	MOVE WS-ITEMS-1 TO T-LINE-ITEMS.
    1071  	MOVE WS-PRICE-1 TO T-TOTAL-PRICE.
    1072  	DISPLAY T-TOTAL-LINE.
    1073  	MOVE 2 TO T-TOTAL-LEVEL.
    1074  	MOVE WS-ITEMS-2 TO T-LINE-ITEMS.
    1075  	MOVE WS-PRICE-2 TO T-TOTAL-PRICE.
    1076  	DISPLAY T-TOTAL-LINE.
    1077  	MOVE 3 TO T-TOTAL-LEVEL.
    1078  	MOVE WS-ITEMS-3 TO T-LINE-ITEMS.
    1079  	MOVE WS-PRICE-3 TO T-TOTAL-PRICE.
    1080  	DISPLAY T-TOTAL-LINE.
    1081  	MOVE 4 TO T-TOTAL-LEVEL.
    1082  	MOVE WS-ITEMS-4 TO T-LINE-ITEMS.
    1083  	MOVE WS-PRICE-4 TO T-TOTAL-PRICE.
    1084  	DISPLAY T-TOTAL-LINE.
    1085  	DISPLAY '-' WITH NO ADVANCING.
    1086  	ACCEPT WS-ANS.
    1087  	GO TO TYPE-OPTION-LOOP.
    1088      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 27
    RECTYM.CBL    22-SEP-65  22:14

    1089  
    1090    REC-FILE-ERROR.
    1091  	DISPLAY '**CONTENT ERROR IN REC-FILE - FATAL**'.
    1092  	CLOSE REC-FILE.
    1093  	STOP RUN.
    1094      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 28
    RECTYM.CBL    22-SEP-65  22:14

    1095  * *********************************************************************
    1096  * 	COMMON SUBROUTINES
    1097  * *********************************************************************
    1098  
    1099    YES-NO.
    1100  	ACCEPT WS-ANS.
    1101  	IF WS-ANS NOT = 'Y' AND WS-ANS NOT = 'N'
    1102  		DISPLAY 'Y OR N ONLY'
    1103  		GO TO YES-NO.
    1104    YES-NO-END.
    1105  
    1106  
    1107  * *********************************************************************
    1108  * 	ROUTINE TO PRINT A HEADER FROM WS-HDR-1 AND WS-HDR-2
    1109  * *********************************************************************
    1110  
    1111    HEADER.
    1112  	ADD 1 TO WS-PAGE.
    1113  	MOVE WS-PAGE TO WS-HDR-PAGE.
    1114  	MOVE 0 TO WS-LINE.
    1115  	WRITE LIST-REC FROM WS-HDR-1 AFTER ADVANCING TOP.
    1116  	WRITE LIST-REC FROM WS-HDR-2 AFTER ADVANCING 2 LINES.
    1117    HEADER-END.
    1118  * *********************************************************************
    1119  * 	ROUTINE TO COMPUTE 3 LEVELS OF REC PRICING
    1120  * *********************************************************************
    1121  
    1122    COMPUTE-REC-PRICES.
    1123  	IF REC-QUAN-1 > 0
    1124  		ADD 1 TO WS-ITEMS-1
    1125  		MULTIPLY M-PRICE BY REC-QUAN-1 GIVING WS-PRICE-1
    1126  		ADD WS-PRICE-1 TO WS-PRICE-TOT-1
    1127  		ADD WS-PRICE-1 TO WS-GRAND-TOT-1;
    1128  	ELSE, MOVE ZERO TO WS-PRICE-1.
    1129  	IF REC-QUAN-2 > 0
    1130  		ADD 1 TO WS-ITEMS-2
    1131  		MULTIPLY M-PRICE BY REC-QUAN-2 GIVING WS-PRICE-2
    1132  		ADD WS-PRICE-2 TO WS-PRICE-TOT-2
    1133  		ADD WS-PRICE-2 TO WS-GRAND-TOT-2;
    1134  	ELSE, MOVE ZERO TO WS-PRICE-2.
    1135  	IF REC-QUAN-3 > 0
    1136  		ADD 1 TO WS-ITEMS-3
    1137  		MULTIPLY M-PRICE BY REC-QUAN-3 GIVING WS-PRICE-3
    1138  		ADD WS-PRICE-3 TO WS-PRICE-TOT-3
    1139  		ADD WS-PRICE-3 TO WS-GRAND-TOT-3;
    1140  	ELSE, MOVE ZERO TO WS-PRICE-3.
    1141  	IF REC-QUAN-4 > 0
    1142  		ADD 1 TO WS-ITEMS-4
    1143  		MULTIPLY M-PRICE BY REC-QUAN-4 GIVING WS-PRICE-4
    1144  		ADD WS-PRICE-4 TO WS-PRICE-TOT-4
    1145  		ADD WS-PRICE-4 TO WS-GRAND-TOT-4;
    1146  	ELSE, MOVE ZERO TO WS-PRICE-4.
    1147    COMPUTE-REC-PRICES-END.
    1148      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 29
    RECTYM.CBL    22-SEP-65  22:14

    1149  * *********************************************************************
    1150  * 
    1151  * 	ROUTINE TO ACCEPT A SYSTEM CONFIGURATION & LOAD INTO TABLE
    1152  * 
    1153  * 	RET-CODE = 1 SUCCESSFUL
    1154  * 		   2 TABLE O'FLOWED
    1155  * 
    1156  * *********************************************************************
    1157  
    1158    ACCEPT-CONFIGURATION.
    1159  	MOVE ZERO TO O.
    1160  	DISPLAY ' ENTER OPTION<CR>; AT END TYPE <END>'.
    1161    ACCEPT-CONFIG-LOOP.
    1162  	ACCEPT REC-KEY.
    1163  	IF REC-KEY = SPACES
    1164  		GO TO ACCEPT-CONFIG-LOOP;
    1165  	ELSE, IF REC-KEY = 'END'
    1166  		MOVE 1 TO RET-CODE
    1167  		GO TO ACCEPT-CONFIG-END;
    1168  	ELSE, IF REC-KEY = 'ALL' AND O = 0
    1169  		MOVE 999 TO O
    1170  		MOVE 1 TO RET-CODE
    1171  		GO TO ACCEPT-CONFIG-GET-FIRST.
    1172  	READ REC-FILE INVALID KEY
    1173  		DISPLAY REC-KEY ' NOT IN REC-FILE - IGNORED'
    1174  		GO TO ACCEPT-CONFIG-LOOP.
    1175  	MOVE 1 TO X.
    1176    ACCEPT-CONFIG-CHECK-DUP.
    1177  	IF X NOT > O
    1178  		IF WS-OPT-TBL(X) NOT = REC-KEY
    1179  			ADD 1 TO X
    1180  			GO TO ACCEPT-CONFIG-CHECK-DUP;
    1181  		ELSE, DISPLAY 'DUPLICATE ENTRY - IGNORED'
    1182  			GO TO ACCEPT-CONFIG-LOOP.
    1183  	ADD 1 TO O.
    1184  	IF O > 25
    1185  		DISPLAY 'DEVICE TABLE OVERFLOW - **FATAL**'
    1186  		MOVE 2 TO RET-CODE
    1187  		GO TO ACCEPT-CONFIG-END.
    1188  	MOVE REC-KEY TO WS-OPT-TBL(O).
    1189  	GO TO ACCEPT-CONFIG-LOOP.
    1190    ACCEPT-CONFIG-END. EXIT.
    1191  
    1192    ACCEPT-CONFIG-GET-FIRST.
    1193  	MOVE LOW-VALUE TO REC-KEY.
    1194  	READ REC-FILE INVALID KEY
    1195  		DISPLAY 'INVALID KEY AT ACCEPT-CONFIG-GET-FIRST'
    1196  		STOP RUN.
    1197  	MOVE REC-OPTION TO WS-DEV-ENTRY.
    1198  	IF WS-DEV-BLANK = SPACES GO TO ACCEPT-CONFIG-GET-FIRST.
    1199  	MOVE REC-OPTION TO WS-OPTION.
    1200  	GO TO ACCEPT-CONFIG-END.
    1201      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 30
    RECTYM.CBL    22-SEP-65  22:14

    1202  * *********************************************************************
    1203  * 	ROUTINE TO EXTRACT NEXT OPTION FROM TABLE
    1204  * 	RET-CODE = 1 SUCCESSFUL
    1205  * 		  2 NO MORE OPTIONS IN TABLE
    1206  * *********************************************************************
    1207  
    1208    GET-NEXT-OPTION.
    1209  	IF O NOT = 999
    1210  		GO TO GET-NEXT-OPTION-GO.
    1211  	IF REC-PARTNO = SPACES AND REC-OPTION NOT = SPACES
    1212  		MOVE  1 TO RET-CODE
    1213  		GO TO GET-NEXT-OPTION-END.
    1214  	MOVE LOW-VALUE TO REC-KEY.
    1215  	READ REC-FILE INVALID KEY
    1216  		MOVE 2 TO RET-CODE
    1217  		GO TO GET-NEXT-OPTION-END.
    1218  	IF REC-PARTNO NOT = SPACES
    1219  		DISPLAY ' ERROR IN REC-FILE TRYING TO FIND SEQ OPTION'
    1220  		DISPLAY 'REC-REC-KEY = ' REC-REC-KEY
    1221  		STOP RUN.
    1222  	MOVE 1 TO RET-CODE.
    1223  	GO TO GET-NEXT-OPTION-END.
    1224    GET-NEXT-OPTION-GO.
    1225  	IF O = 0
    1226  		MOVE 2 TO RET-CODE
    1227  		GO TO GET-NEXT-OPTION-END.
    1228  	MOVE WS-OPT-TBL(O) TO REC-KEY.
    1229  	SUBTRACT 1 FROM O.
    1230  	READ REC-FILE INVALID KEY
    1231  		DISPLAY 'ERROR UNLOADING OPTION TABLE'
    1232  		DISPLAY 'REC-KEY = ' REC-KEY '  O = ' O
    1233  		DISPLAY '**FATAL ERROR**'
    1234  		STOP RUN.
    1235  	MOVE 1 TO RET-CODE.
    1236    GET-NEXT-OPTION-END.
    1237  	MOVE REC-OPTION TO WS-OPTION.
    1238  	MOVE REC-PL-ALL TO WS-PL.
    1239      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 31
    RECTYM.CBL    22-SEP-65  22:14

    1240  * *********************************************************************
    1241  * 	ROUTINE TO  SEQ READ REC-FILE FOR CURRENT OPT
    1242  * 	RET-CODE = 1 SUCCESSFUL
    1243  * 		   2 NO MORE RECORDS FOR CURRENT OPTION
    1244  * *********************************************************************
    1245  
    1246    READ-REC-SEQ-OPT.
    1247  	MOVE LOW-VALUE TO REC-KEY.
    1248  	READ REC-FILE INVALID KEY
    1249  		MOVE 2 TO RET-CODE
    1250  		GO TO READ-REC-SEQ-OPT-END.
    1251  	MOVE REC-REC-KEY TO REC-KEY.
    1252  	IF REC-K-OPTION NOT = WS-OPTION
    1253  		MOVE 2 TO RET-CODE
    1254  		GO TO READ-REC-SEQ-OPT-END.
    1255  	MOVE 1 TO RET-CODE.
    1256    READ-REC-SEQ-OPT-END. EXIT.
    1257      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 32
    RECTYM.CBL    22-SEP-65  22:14

    1258  * *********************************************************************
    1259  * 
    1260  * 	MASTER FILE HANDLERS
    1261  * 
    1262  * *********************************************************************
    1263  
    1264    OPEN-I-MAST-FILE.
    1265  	IF WS-MAST-FILE-OPEN = 'I' OR WS-MAST-FILE-OPEN = 'B'
    1266  		GO TO OPEN-I-MAST-FILE-END;
    1267  	ELSE, IF WS-MAST-FILE-OPEN NOT = SPACES
    1268  		CLOSE MAST-FILE.
    1269  	OPEN INPUT MAST-FILE.
    1270  	MOVE 'I' TO WS-MAST-FILE-OPEN.
    1271    OPEN-I-MAST-FILE-END. EXIT.
    1272  
    1273    OPEN-O-MAST-FILE.
    1274  	IF WS-MAST-FILE-OPEN = 'O' OR WS-MAST-FILE-OPEN = 'B'
    1275  		GO TO OPEN-O-MAST-FILE-END;
    1276  	ELSE, IF WS-MAST-FILE-OPEN NOT = SPACES
    1277  		CLOSE MAST-FILE.
    1278  	OPEN OUTPUT MAST-FILE.
    1279  	MOVE 'O' TO WS-MAST-FILE-OPEN.
    1280    OPEN-O-MAST-FILE-END. EXIT.
    1281  
    1282    OPEN-IO-MAST-FILE.
    1283  	IF WS-MAST-FILE-OPEN = 'B'
    1284  		GO TO OPEN-IO-MAST-FILE-END;
    1285  	ELSE, IF WS-MAST-FILE-OPEN NOT = SPACES
    1286  		CLOSE MAST-FILE.
    1287  	OPEN I-O MAST-FILE.
    1288  	MOVE 'B' TO WS-MAST-FILE-OPEN.
    1289    OPEN-IO-MAST-FILE-END. EXIT.
    1290  
    1291    READ-MASTER.
    1292  	PERFORM OPEN-I-MAST-FILE THRU OPEN-I-MAST-FILE-END.
    1293  	MOVE WS-PARTNO TO MAST-KEY.
    1294    READ-MASTER-LOOP.
    1295  	READ MAST-FILE INVALID KEY
    1296  		MOVE ZERO TO RET-CODE
    1297  		GO TO READ-MASTER-END.
    1298  	IF M-FLAG = 1 AND M-K-PL = SPACES
    1299  		MOVE WS-PL TO M-K-PL
    1300  		GO TO READ-MASTER-LOOP.
    1301  	IF M-CREF = 'X'
    1302  		MOVE M-CREF-PN-PL TO MAST-KEY
    1303  		GO TO READ-MASTER-LOOP.
    1304  	MOVE 1 TO RET-CODE.
    1305    READ-MASTER-END. EXIT.
    1306      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 33
    RECTYM.CBL    22-SEP-65  22:14

    1307  * *****************************
    1308  * 	MASTER FILE (CONT)
    1309  * *****************************
    1310  
    1311    WRITE-MAST-REC.
    1312  	IF WS-MAST-FILE-OPEN NOT = 'O' AND WS-MAST-FILE-OPEN NOT = 'B'
    1313  		MOVE MAST-REC TO MAST-REC-SAVE
    1314  		PERFORM OPEN-O-MAST-FILE THRU OPEN-O-MAST-FILE-END
    1315  		MOVE MAST-REC-SAVE TO MAST-REC.
    1316  	WRITE MAST-REC INVALID KEY
    1317  		GO TO MAST-WRITE-ERROR.
    1318    WRITE-MAST-REC-END. EXIT.
    1319  
    1320    REWRITE-MAST-REC.
    1321  	IF WS-MAST-FILE-OPEN NOT = 'B'
    1322  		MOVE MAST-REC TO MAST-REC-SAVE
    1323  		PERFORM OPEN-IO-MAST-FILE THRU OPEN-IO-MAST-FILE-END
    1324  		MOVE MAST-REC-SAVE TO MAST-REC.
    1325  	REWRITE MAST-REC INVALID KEY
    1326  		GO TO MAST-REWRITE-ERROR.
    1327    REWRITE-MAST-REC-END. EXIT.
    1328  
    1329    MAST-WRITE-ERROR.
    1330  	MOVE 'WRITE' TO MSG-ERR-TYPE.
    1331  	GO TO MAST-ERROR-ALL.
    1332    MAST-REWRITE-ERROR.
    1333  	MOVE 'REWRITE' TO MSG-ERR-TYPE.
    1334    MAST-ERROR-ALL.
    1335  	MOVE 'MAST' TO MSG-ERR-FILE.
    1336  	DISPLAY MSG-FILE-ERROR.
    1337  	DISPLAY 'MAST-KEY: ' MAST-KEY '    WS-PARTNO: ' WS-PARTNO.
    1338  	DISPLAY 'MAST-REC: ' MAST-REC.
    1339  	GO TO FATAL-FILE-ERROR.
    1340      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 34
    RECTYM.CBL    22-SEP-65  22:14

    1341  * *********************************************************************
    1342  * 
    1343  * 	RECOMMENDED SPARES FILE HANDLERS
    1344  * 
    1345  * *********************************************************************
    1346  
    1347    OPEN-I-REC-FILE.
    1348  	IF WS-REC-FILE-OPEN = 'I' OR WS-REC-FILE-OPEN = 'B'
    1349  		GO TO OPEN-I-REC-FILE-END;
    1350  	ELSE, IF WS-REC-FILE-OPEN NOT = SPACES
    1351  		CLOSE REC-FILE.
    1352  	OPEN INPUT REC-FILE.
    1353  	MOVE 'I' TO WS-REC-FILE-OPEN.
    1354    OPEN-I-REC-FILE-END. EXIT.
    1355  
    1356    OPEN-O-REC-FILE.
    1357  	IF WS-REC-FILE-OPEN = 'O' OR WS-REC-FILE-OPEN = 'B'
    1358  		GO TO OPEN-O-REC-FILE-END;
    1359  	ELSE, IF WS-REC-FILE-OPEN NOT = SPACES
    1360  		CLOSE REC-FILE.
    1361  	OPEN OUTPUT REC-FILE.
    1362  	MOVE 'O' TO WS-REC-FILE-OPEN.
    1363    OPEN-O-REC-FILE-END. EXIT.
    1364  
    1365    OPEN-IO-REC-FILE.
    1366  	IF WS-REC-FILE-OPEN = 'B'
    1367  		GO TO OPEN-IO-REC-FILE-END;
    1368  	ELSE, IF WS-REC-FILE-OPEN NOT = SPACES
    1369  		CLOSE REC-FILE.
    1370  	OPEN I-O REC-FILE.
    1371  	MOVE 'B' TO WS-REC-FILE-OPEN.
    1372    OPEN-IO-REC-FILE-END. EXIT.
    1373  
    1374    READ-REC-FILE.
    1375  	PERFORM OPEN-I-REC-FILE THRU OPEN-I-REC-FILE-END.
    1376  	READ REC-FILE INVALID KEY
    1377  		MOVE ZERO TO RET-CODE
    1378  		GO TO READ-REC-FILE-END.
    1379  	MOVE 1 TO RET-CODE.
    1380    READ-REC-FILE-END. EXIT.
    1381  
    1382    WRITE-REC-REC.
    1383  	IF WS-REC-FILE-OPEN NOT = 'O' AND WS-REC-FILE-OPEN NOT = 'B'
    1384  		MOVE REC-REC TO REC-REC-SAVE
    1385  		PERFORM OPEN-O-REC-FILE THRU OPEN-O-REC-FILE-END
    1386  		MOVE REC-REC-SAVE TO REC-REC.
    1387  	WRITE REC-REC INVALID KEY
    1388  		GO TO REC-WRITE-ERROR.
    1389    WRITE-REC-REC-END. EXIT.
    1390      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 35
    RECTYM.CBL    22-SEP-65  22:14

    1391  * *****************************
    1392  * 	REC FILE (CONT)
    1393  * *****************************
    1394  
    1395    REWRITE-REC-REC.
    1396  	IF WS-REC-FILE-OPEN NOT = 'B'
    1397  		MOVE REC-REC TO REC-REC-SAVE
    1398  		PERFORM OPEN-IO-REC-FILE THRU OPEN-IO-REC-FILE-END
    1399  		MOVE REC-REC-SAVE TO REC-REC.
    1400  	REWRITE REC-REC INVALID KEY
    1401  		GO TO REC-REWRITE-ERROR.
    1402    REWRITE-REC-REC-END. EXIT.
    1403  
    1404    CLOSE-OUT-REC-FILE.
    1405  	IF WS-REC-FILE-OPEN = 'B' OR WS-REC-FILE-OPEN = 'O'
    1406  		CLOSE REC-FILE
    1407  		MOVE SPACES TO WS-REC-FILE-OPEN.
    1408    CLOSE-OUT-REC-FILE-END. EXIT.
    1409  
    1410    CLOSE-REC-FILE.
    1411  	IF WS-REC-FILE-OPEN NOT = SPACES
    1412  		CLOSE REC-FILE
    1413  		MOVE SPACES TO WS-REC-FILE-OPEN.
    1414    CLOSE-REC-FILE-END. EXIT.
    1415  
    1416    REC-WRITE-ERROR.
    1417  	MOVE 'WRITE' TO MSG-ERR-TYPE.
    1418  	GO TO REC-ERROR-ALL.
    1419    REC-REWRITE-ERROR.
    1420  	MOVE 'REWRITE' TO MSG-ERR-TYPE.
    1421    REC-ERROR-ALL.
    1422  	MOVE 'REC' TO MSG-ERR-FILE.
    1423  	DISPLAY MSG-FILE-ERROR.
    1424  	DISPLAY 'REC-KEY: ' REC-KEY '     WS-PARTNO: ' WS-PARTNO.
    1425  	DISPLAY 'REC-REC: ' REC-REC.
    1426    FATAL-FILE-ERROR.
    1427  	DISPLAY MSG-FATAL.
    1428  	ENTER MACRO LOGOFF.
    1429      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 36
    RECTYM.CBL    22-SEP-65  22:14

    1430  * *********************************************************************
    1431  * 
    1432  * 	SITE FILE HANDLERS
    1433  * 
    1434  * *********************************************************************
    1435  
    1436    OPEN-I-SITE-FILE.
    1437  	IF WS-SITE-FILE-OPEN = 'I' OR WS-SITE-FILE-OPEN = 'B'
    1438  		GO TO OPEN-I-SITE-FILE-END;
    1439  	ELSE, IF WS-SITE-FILE-OPEN NOT = SPACES
    1440  		CLOSE SITE-FILE.
    1441  	OPEN INPUT SITE-FILE.
    1442  	MOVE 'I' TO WS-SITE-FILE-OPEN.
    1443    OPEN-I-SITE-FILE-END. EXIT.
    1444  
    1445    CLOSE-SITE-FILE.
    1446  	IF WS-SITE-FILE-OPEN NOT = SPACES
    1447  		CLOSE SITE-FILE
    1448  		MOVE SPACES TO WS-SITE-FILE-OPEN.
    1449    CLOSE-SITE-FILE-END. EXIT.
    1450  
    1451    GET-SITE-REC.
    1452  	MOVE M-PARTNO TO S-K-PARTNO.
    1453  	READ SITE-FILE INVALID KEY
    1454  		MOVE ZERO TO RET-CODE
    1455  		GO TO GET-SITE-REC-END.
    1456  	MOVE 1 TO RET-CODE.
    1457    GET-SITE-REC-END. EXIT.
    1458      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE 37
    RECTYM.CBL    22-SEP-65  22:14

    1459      P R O G R A M   R E C T Y M 		COBOL 100A(370001)	11-MAY-77  14:38		PAGE W-1
    RECTYM.CBL    22-SEP-65  22:14

WARNINGS:

    0795  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-QUAN
    0797  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-QUAN
    0799  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-QUAN
    0800  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-QUAN
    1024  RIGHT-MOST TRUNCATION ON T-DESC
    1043  RIGHT-MOST TRUNCATION ON T-DESC
    1047  MOST SIGNIFICANT DIGITS TRUNCATED ON T-QUAN-1
    1048  MOST SIGNIFICANT DIGITS TRUNCATED ON T-QUAN-2
    1049  MOST SIGNIFICANT DIGITS TRUNCATED ON T-QUAN-3
    1050  MOST SIGNIFICANT DIGITS TRUNCATED ON T-QUAN-4
    1053  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-PRICE-1
    1056  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-PRICE-2
    1059  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-PRICE-3
    1062  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-PRICE-4
    1125  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-PRICE-1
    1131  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-PRICE-2
    1137  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-PRICE-3
    1143  MOST SIGNIFICANT DIGITS TRUNCATED ON WS-PRICE-4
    1188  RIGHT-MOST TRUNCATION ON WS-OPT-TBL


NO FATAL ERRORS, 19 WARNINGS
   N@t