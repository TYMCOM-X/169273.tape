






















                         DCP Programmers Guide
                                May 24, 1982

                  TYMSHARE Netwokr Technology Division
                             Cupertino, Ca.
DCP Programmers Guide                                  Table of Contents


                           Table of Contents                             





Section                                                             Page




1.     Introduction           .  .  .  .  .  .  .  .  .  .  .  .  .  . 1


2.     DCP register definitions  .  .  .  .  .  .  .  .  .  .  .  .  . 2


3.     Receive function definitions .  .  .  .  .  .  .  .  .  .  .  . 3

       3.1    CARDET - Carrier detect  .  .  .  .  .  .  .  .  .  .  . 3

       3.2    CARLOS - Carrier loss .  .  .  .  .  .  .  .  .  .  .  . 4

       3.3    DSRSET - DSR set   .  .  .  .  .  .  .  .  .  .  .  .  . 5

       3.4    DSRCLR - DSR clear .  .  .  .  .  .  .  .  .  .  .  .  . 6

       3.5    RXVDAT - Receive data character   .  .  .  .  .  .  .  . 7

       3.6    XMTDON - Transmit done   .  .  .  .  .  .  .  .  .  .  . 8

       3.7    DCPOK - DCP passed internal diagnostics .  .  .  .  .  . 9

       3.8    PORTOK - Port vector initialized ok  .  .  .  .  .  .   10

       3.9    EOMDET - Transmit underrun  .  .  .  .  .  .  .  .  .   11

       3.10   TXDMAB - Transmit DMA abort response .  .  .  .  .  .   12

       3.11   DSPMEM - Display memory word   .  .  .  .  .  .  .  .   13

       3.12   REGDMP - Register dump   .  .  .  .  .  .  .  .  .  .   14

       3.13   ROMERR - DCP EPROM checksum error .  .  .  .  .  .  .   15

       3.14   MEMERR - Memory diagnostic error  .  .  .  .  .  .  .   16

       3.15   FUNERR - Invalid transmit function   .  .  .  .  .  .   17

       3.16   PRTERR - Invalid port number   .  .  .  .  .  .  .  .   18


4.     Transmit function definitions   .  .  .  .  .  .  .  .  .  .   19



TYMSHARE Network Technology Division, Cupertino, Ca.                   i
DCP Programmers Guide                                  Table of Contents


       4.1    EXDIAG - EXECUTE INTERNAL DIAGNOSTICS   .  .  .  .  .   19

       4.2    BOOT11 - Copy bootstrap to LSI-11 .  .  .  .  .  .  .   20

       4.3    EXMMEM - Examine DCP memory    .  .  .  .  .  .  .  .   21

       4.4    DEPMEM - Deposit into DCP memory  .  .  .  .  .  .  .   22

       4.5    DMPREG - Dump DCP internal registers .  .  .  .  .  .   23

       4.6    ZAPALL - Reinitialize all ports   .  .  .  .  .  .  .   24

       4.7    EXECUT - Enable SIO scanning   .  .  .  .  .  .  .  .   25

       4.8    ASYPAR - Initialize an asynchronous port   .  .  .  .   26

       4.9    TXDATA - Transmit data   .  .  .  .  .  .  .  .  .  .   28

       4.10   SETDTR - Set data terminal ready  .  .  .  .  .  .  .   29

       4.11   CLRDTR - Clear data terminal ready   .  .  .  .  .  .   30

       4.12   BREAK - Break line .  .  .  .  .  .  .  .  .  .  .  .   31

       4.13   ENDBRK - End break .  .  .  .  .  .  .  .  .  .  .  .   32

       4.14   CFGPRT - Configure port vector .  .  .  .  .  .  .  .   33

       4.15   TXSOM - Transmit start of messagge   .  .  .  .  .  .   34

       4.16   TXEOM - Transmit end of message   .  .  .  .  .  .  .   35

       4.17   SYNPAR - Initialize synchronous port .  .  .  .  .  .   36

       4.18   SRCHSY - Enter search synch mode  .  .  .  .  .  .  .   37

       4.19   STRPSY - Select strip synch mode  .  .  .  .  .  .  .   38

       4.20   Transmit data without CRC   .  .  .  .  .  .  .  .  .   39

       4.21   Transmit two data bytes  .  .  .  .  .  .  .  .  .  .   40

       4.22   Initialize SDLC port  .  .  .  .  .  .  .  .  .  .  .   41

       4.23   Configure high priority port   .  .  .  .  .  .  .  .   42

       4.24   Start DMA output   .  .  .  .  .  .  .  .  .  .  .  .   43

       4.25   Abort DMA output   .  .  .  .  .  .  .  .  .  .  .  .   44







TYMSHARE Network Technology Division, Cupertino, Ca.                  ii
DCP Programmers Guide


























































TYMSHARE Network Technology Division, Cupertino, Ca.
DCP Programmers Guide                                       Introduction


1    Introduction     

   This  document  contains the  complete  DCP-PDP11  software interface
specification.  The  DCP is controlled  by receiving  transmit functions
from a LSI-11 and responds by sending the LSI-11 receive  functions.  To
send a function to  the DCP the LSI-11 must  wait for the TXFUN  byte to
become zero indicating that the DCP is ready for another function.  Then
the necessary data must be loaded into the transmit data registers.  The
function code  must be  loaded after the  rest of  the message  has been
loaded.  There  is no  interrupt generated  by the  DCP when  a transmit
function is accepted.  A new receive function will be sent to the LSI-11
when the  last receive  function byte  has been  cleared by  the LSI-11.
Upon  receiving a  function from  the DCP  the entire  function  must be
copied from the  DCP registers before  zeroing the DCP  receive function
byte.  Interrupts to the LSI-11 will be generated only after  the EXECUT
function has been  sent to the  DCP.  In CRC  mode using DDCMP  the node
speaking to the DCP (not the one the DCP is plugged into) must idle sync
or flag  characters between  messages.  This is  necessary to  flush the
character hold-off buffer in the DCP.





































TYMSHARE Network Technology Division, Cupertino, Ca.                   1
DCP Programmers Guide                           DCP register definitions


2    DCP register definitions       

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   RXPORT      |  RXFUNCTION   |       162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         RECEIVE DATA          |       162002
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        (RECEIVE DATA)         |       162004
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        (RECEIVE DATA)         |       162006
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    TXPORT     |  TXFUNCTION   |       162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        TRANSMIT DATA          |       162012
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       (TRANSMIT DATA)         |       162014
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       (TRANSMIT DATA)         |       162016
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+




































TYMSHARE Network Technology Division, Cupertino, Ca.                   2
DCP Programmers Guide                       Receive function definitions


3    Receive function definitions       



3.1    CARDET - Carrier detect          

FUNCTION:  Carrier detect

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |            2  |   162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Carrier detected.  The physical line  DCD on the SIO has gone  to the
active state.





































TYMSHARE Network Technology Division, Cupertino, Ca.                   3
DCP Programmers Guide                       Receive function definitions


3.2    CARLOS - Carrier loss          

FUNCTION:    Carrier loss detected

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |            4  |   162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   The carrier detect signal has been lost.










































TYMSHARE Network Technology Division, Cupertino, Ca.                   4
DCP Programmers Guide                       Receive function definitions


3.3    DSRSET - DSR set          

FUNCTION:       DSRSET - DSR set
15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |            6  |   162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Data set ready signal to the SIO has been turned on.











































TYMSHARE Network Technology Division, Cupertino, Ca.                   5
DCP Programmers Guide                       Receive function definitions


3.4    DSRCLR - DSR clear          

FUNCTION:       DSRCLR - DSR clear

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           10  |   162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Data set ready signal has been cleared.










































TYMSHARE Network Technology Division, Cupertino, Ca.                   6
DCP Programmers Guide                       Receive function definitions


3.5    RXVDAT - Receive data character           

FUNCTION:       RXVDAT - Receive data character

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           12  |   162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|a|b|c|d|///////|   DATA BYTE   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Receive  data character.   The following  error and  status  bits are
possible.

    a =>  Receiver error.  This bit  is the inclusive or  of all
          the other receiver error bits.

    b =>  Framing error  (asynchronous mode)  / CRC  result non-
          zero (synchronous mode; this is not an error bit).

    c =>  Overrun error.

    d =>  Parity error.































TYMSHARE Network Technology Division, Cupertino, Ca.                   7
DCP Programmers Guide                       Receive function definitions


3.6    XMTDON - Transmit done          

FUNCTION:       XMTDON - Transmit done

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           14  |   162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   The DCP transmit  buffer is empty and  ready to accept more  data.  A
command to send another character can be issued.  If no other command is
issued thee transmitter will go into its idle state.








































TYMSHARE Network Technology Division, Cupertino, Ca.                   8
DCP Programmers Guide                       Receive function definitions


3.7    DCPOK - DCP passed internal diagnostics            

FUNCTION:       DCPOK - DCP passed internal diagnostics

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|           16  |   162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   This function is returned in response to the  initialization function
EXDIAG upon the successful completion of DCP internal  diagnostics.  See
EXDIAG for further details.








































TYMSHARE Network Technology Division, Cupertino, Ca.                   9
DCP Programmers Guide                       Receive function definitions


3.8    PORTOK - Port vector initialized ok            

FUNCTION:       PORTOK - Port vector initialized ok

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           20  |   162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   This port has been initialized properly and the hardware for the port
really exists.









































TYMSHARE Network Technology Division, Cupertino, Ca.                  10
DCP Programmers Guide                       Receive function definitions


3.9    EOMDET - Transmit underrun          

FUNCTION:       EOMDET - Transmit underrun

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           22  |   162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Transmit  underrun  occurs  when  the  CRC  is  being  transmitted in
response to a TXEOM request.   The LSI-11 may send another  character at
this point and it will be transmitted after the CRC has  been completely
sent.  The CRC is reset after the CRC has been sent.  It is  not correct
to send a TXSOM if the next message is to be concatenated to  the first.
Any pad characters must be sent after the under run is received, because
the next interrupt (transmit buffer empty) is sent after idle syncs have
been sent.



































TYMSHARE Network Technology Division, Cupertino, Ca.                  11
DCP Programmers Guide                       Receive function definitions


3.10    TXDMAB - Transmit DMA abort response             

FUNCTION:       TXDMAB - Transmit DMA abort response

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           24  |   162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        LAST DMA ADDRESS       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   A  Transmit DMA  abort request  has been  honored and  the  next data
address to be transmitted (always even) is returned.









































TYMSHARE Network Technology Division, Cupertino, Ca.                  12
DCP Programmers Guide                       Receive function definitions


3.11    DSPMEM - Display memory word            

FUNCTION:       DSPMEM - Display memory word

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|           40  |   162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        MEMORY ADDRESS         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          DATA WORD            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          DATA WORD            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   This debug function displays two words from the DCP's internal memory
in response to the EXMMEM function.





































TYMSHARE Network Technology Division, Cupertino, Ca.                  13
DCP Programmers Guide                       Receive function definitions


3.12    REGDMP - Register dump           

FUNCTION:       REGDMP - Register dump

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|           42  |   162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           REGISTER            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           REGISTER            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           REGISTER            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Three register dump  functions are received  in response to  a single
DMPREG function.  The register fields return the values as follows:

    1)  AX,BX,CX

    2)  DX, SP, BP

    3)  SI, DI, Status flags































TYMSHARE Network Technology Division, Cupertino, Ca.                  14
DCP Programmers Guide                       Receive function definitions


3.13    ROMERR - DCP EPROM checksum error             

FUNCTION:       ROMERR - DCP EPROM checksum error

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|          376  |   162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| EPROM CHKSUM  |  CALC CHKSUM  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   This is a fatal hardware error.  The EPROM'S checksum does  not agree
with the calculated  checksum.  This function  will only be  returned in
response to a EXDIAG function.








































TYMSHARE Network Technology Division, Cupertino, Ca.                  15
DCP Programmers Guide                       Receive function definitions


3.14    MEMERR - Memory diagnostic error            

FUNCTION:       MEMERR - Memory diagnostic error

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|          374  |   162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       FAILING ADDRESS         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        EXPECTED DATA          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        RETURNED DATA          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   This is a fatal  hardware error.  The DCP internal  memory diagnostic
failed.   This function  is returned  in response  to a  EXDIAG function
during initialization.




































TYMSHARE Network Technology Division, Cupertino, Ca.                  16
DCP Programmers Guide                       Receive function definitions


3.15    FUNERR - Invalid transmit function            

FUNCTION:       FUNERR - Invalid transmit function

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |          372  |   162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|//////////|  BAD FUNCTION |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   This function  is returned in  response to an  invalid number  in the
transmit  function  field of  a  transmit function.   An  incorreect DCP
driver in the LSI-11 can cause this.








































TYMSHARE Network Technology Division, Cupertino, Ca.                  17
DCP Programmers Guide                       Receive function definitions


3.16    PRTERR - Invalid port number            

FUNCTION:       PRTERR - Invalid port number

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |          370  |   162000
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   A transmit function with an out-of-range port number will  cause this
error.  During initialization this function is returned to indicate that
an  attempt was  made to  initialize an  SIO port  that does  not really
exist.







































TYMSHARE Network Technology Division, Cupertino, Ca.                  18
DCP Programmers Guide                      Transmit function definitions


4    Transmit function definitions       



4.1    EXDIAG - EXECUTE INTERNAL DIAGNOSTICS           

FUNCTION:       EXDIAG - EXECUTE INTERNAL DIAGNOSTICS

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|            2  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   This function  resets the  DCP and  executes internal  diagnostics to
verify that the  internal RAM, ROM and  registers are good.   The proper
initialization protocol is to send the EXDIAG function, set a  timer and
pole the receive  function register until a  DCPOK is returned.   If the
timer goes off an error  message should have been returned.   The LSI-11
driver must not write into the DCP registers while diagnostics are being
executed because the registers are also tested.
































TYMSHARE Network Technology Division, Cupertino, Ca.                  19
DCP Programmers Guide                      Transmit function definitions


4.2    BOOT11 - Copy bootstrap to LSI-11            

FUNCTION:       BOOT11 - Reserved!

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|            4  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   This function is reserved for use by the bootstrap.  This  causes the
DCP to load  the LSI-11 bootstrap into  LSI-11 memory at  location 1000.
To reboot  the LSI-11 the  program must disable  interrupts and  jump to
location 173000.  No program should ever send this function!







































TYMSHARE Network Technology Division, Cupertino, Ca.                  20
DCP Programmers Guide                      Transmit function definitions


4.3    EXMMEM - Examine DCP memory             

FUNCTION:       EXMMEM - Examine DCP memory

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|            6  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          DCP ADDRESS          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   This debug function  is used to examine  four DCP memory  bytes.  The
address does not have to be on a word boundary.









































TYMSHARE Network Technology Division, Cupertino, Ca.                  21
DCP Programmers Guide                      Transmit function definitions


4.4    DEPMEM - Deposit into DCP memory            

FUNCTION:       DEPMEM - Deposit a word into DCP memory

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|           10  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          DCP ADDRESS          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             DATA              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   This debug function is used  to deposit a word into DCP  memory.  The
address does not have to be on an even byte boundary.







































TYMSHARE Network Technology Division, Cupertino, Ca.                  22
DCP Programmers Guide                      Transmit function definitions


4.5    DMPREG - Dump DCP internal registers            

FUNCTION:       DMPREG - Dump DCP internal registers

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|           12  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   This debug function returns three REGDMP functions with  the contents
of some DCP internal registers (see DMPREG description).









































TYMSHARE Network Technology Division, Cupertino, Ca.                  23
DCP Programmers Guide                      Transmit function definitions


4.6    ZAPALL - Reinitialize all ports           

FUNCTION:       ZAPALL - Reinitialize all ports

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|           14  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   This function disables all ports, both synchronous and asynchronous.










































TYMSHARE Network Technology Division, Cupertino, Ca.                  24
DCP Programmers Guide                      Transmit function definitions


4.7    EXECUT - Enable SIO scanning           

FUNCTION:       EXECUT - Enable SIO scanning

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|           16  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   This function enables interrupts on all subsequent  receive functions
from the DCP and causes the DCP to begin scanning the ports.









































TYMSHARE Network Technology Division, Cupertino, Ca.                  25
DCP Programmers Guide                      Transmit function definitions


4.8    ASYPAR - Initialize an asynchronous port            

FUNCTION:       ASYPAR - Initialize an asynchronous port

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           20  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////| a |b|c| d |///////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   BAUD RATE VALUE FROM TABLE  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

    a => Stop bits
         01 - One stop bit
         10 - One and a half stop bits
         11 - Two stop bits

    b => Parity sense select
         0 - Odd parity
         1 - Even parity

    c => Parity enable
         0 - No parity
         1 - Parity enable

    d => Character size not including any parity bits
         00 - 5 bits
         01 - 6 bits
         10 - 7 bits
         11 - 8 bits


Baud rate value table:

Baud rate       Decimal value   Octal value
   50           2304            4400
   75           1536            3000
  110           1047            2027
  134.5          857            1531
  150            768            1400
  200            576            1100
  300            384             600
  400            288             440
  600            192             300
 1000            115             163
 1200             96             140
 1800             64             100
 2000             58              72
 2200             52              64
 2400             48              60
 3600             32              40


TYMSHARE Network Technology Division, Cupertino, Ca.                  26
DCP Programmers Guide                      Transmit function definitions


 4800             24              30
 7200             16              20
 9600             12              14
19200              6               6
38400              3               3



















































TYMSHARE Network Technology Division, Cupertino, Ca.                  27
DCP Programmers Guide                      Transmit function definitions


4.9    TXDATA - Transmit data          

FUNCTION:       TXDATA - Transmit data

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           22  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|   DATA BYTE   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Transmit one data byte.










































TYMSHARE Network Technology Division, Cupertino, Ca.                  28
DCP Programmers Guide                      Transmit function definitions


4.10    SETDTR - Set data terminal ready             

FUNCTION:       SETDTR - Set data terminal ready

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           24  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Turn on the data terminal ready signal.










































TYMSHARE Network Technology Division, Cupertino, Ca.                  29
DCP Programmers Guide                      Transmit function definitions


4.11    CLRDTR - Clear data terminal ready             

FUNCTION:       CLRDTR - Clear data terminal ready

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           26  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Clear data terminal ready.










































TYMSHARE Network Technology Division, Cupertino, Ca.                  30
DCP Programmers Guide                      Transmit function definitions


4.12    BREAK - Break line           

FUNCTION:       BREAK - Break line

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           30  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Initiate a break condition (marking state) on the line.










































TYMSHARE Network Technology Division, Cupertino, Ca.                  31
DCP Programmers Guide                      Transmit function definitions


4.13    ENDBRK - End break           

FUNCTION:       ENDBRK - End break

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           32  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   End break condition on line.










































TYMSHARE Network Technology Division, Cupertino, Ca.                  32
DCP Programmers Guide                      Transmit function definitions


4.14    CFGPRT - Configure port vector            

FUNCTION:       CFGPRT - Configure port vector

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           34  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       INTERRUPT VECTOR        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Initialize the interrupt vector for  this port and check to  see that
the hardware  really exists  and responds  properly.  A  simple hardware
verification  routine  is  executed  by  this  function.   This function
returns a PORTOK if sucessful.  PRTERR is returned if the  hardware does
not exist or the Z80-SIO fails to pass the diagnostic.






































TYMSHARE Network Technology Division, Cupertino, Ca.                  33
DCP Programmers Guide                      Transmit function definitions


4.15    TXSOM - Transmit start of messagge             

FUNCTION:       TXSOM - Transmit start of messagge

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           36  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|   DATA BYTE   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Transmit start of synchronous message.  This function initializes the
CRC (if enabled) and terminates the idle state.









































TYMSHARE Network Technology Division, Cupertino, Ca.                  34
DCP Programmers Guide                      Transmit function definitions


4.16    TXEOM - Transmit end of message             

FUNCTION:       TXEOM - Transmit end of message

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           40  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|   DATA BYTE   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Transmit end  of synchronous data  message.  This function  sends the
last data character,  sends the CRC bytes  (if CRC transmit  is enabled)
and causes the line to idle synch characters or mark (as selected during
port initialization).







































TYMSHARE Network Technology Division, Cupertino, Ca.                  35
DCP Programmers Guide                      Transmit function definitions


4.17    SYNPAR - Initialize synchronous port            

FUNCTION:       SYNPAR - Initialize synchronous port

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           42  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////|a|b|c|d|  SYNCH CHAR   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Initialize  a synchronous  port.  The  following bits  enable various
options.

    a =>  Transmit CRC enable.

    b =>  Search and idle single synch = 0, double synch = 1.

    c =>  Idle synch character  = 0, idle  mark = 1.   Note that
          mark idle only works  correctly in bisync mode  if the
          correct TXSOM and  TXEOM protocol is  observed.  TXDMA
          may  be used  to  start a  message in  mark  idle mode
          instead of TXSOM (if transmit CRC is not desired).

    d =>  Receive CRC enable.





























TYMSHARE Network Technology Division, Cupertino, Ca.                  36
DCP Programmers Guide                      Transmit function definitions


4.18    SRCHSY - Enter search synch mode             

FUNCTION:       SRCHSY - Enter search synch mode

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           44  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|/////////////|a|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Enter search synch mode.  This function allows strip synch mode to be
entered  simultaneously  with  search synch  mode  to  eliminate  a race
condition.

OPTIONS:

      a => Strip synch enable = 1




































TYMSHARE Network Technology Division, Cupertino, Ca.                  37
DCP Programmers Guide                      Transmit function definitions


4.19    STRPSY - Select strip synch mode             

FUNCTION:       STRPSY - Select strip synch mode

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           46  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|/////////////|a|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Select strip synch mode.

OPTIONS:

        a => Strip synch enable = 1






































TYMSHARE Network Technology Division, Cupertino, Ca.                  38
DCP Programmers Guide                      Transmit function definitions


4.20    Transmit data without CRC           

FUNCTION:      Transmit data without CRC

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           50  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|   DATA BYTE   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Transmit data in CRC mode without CRC on the data byte.










































TYMSHARE Network Technology Division, Cupertino, Ca.                  39
DCP Programmers Guide                      Transmit function definitions


4.21    Transmit two data bytes           

FUNCTION:      Transmit two data bytes

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           52  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  DATA BYTE 2  |  DATA BYTE 1  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Transmit two data bytes (low byte first).










































TYMSHARE Network Technology Division, Cupertino, Ca.                  40
DCP Programmers Guide                      Transmit function definitions


4.22    Initialize SDLC port          

FUNCTION:     Initialize SDLC port

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           54  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Initialize port in SDLC mode.










































TYMSHARE Network Technology Division, Cupertino, Ca.                  41
DCP Programmers Guide                      Transmit function definitions


4.23    Configure high priority port           

FUNCTION:     Configure high priority port

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           56  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|///////////////|///////////////|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   This function is the same as function 34 except that the port  is put
on  the high  priority scan  list.  This  function should  be  used with
synchronous ports only.








































TYMSHARE Network Technology Division, Cupertino, Ca.                  42
DCP Programmers Guide                      Transmit function definitions


4.24    Start DMA output          

FUNCTION:    TXDMA - Start DMA output

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           60  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  ADDRESS EXT. |  BYTE COUNT   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             DATA  ADDRESS     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Send a block of data starting at the physical memory address supplied
(may be odd).  The positive byte count specifies the number of  bytes to
send.  The address extension contains bits 21-17 of the  physical memory
address.  This  function may  be used  in asynchronous,  synchronous and
SDLC modes.




































TYMSHARE Network Technology Division, Cupertino, Ca.                  43
DCP Programmers Guide                      Transmit function definitions


4.25    Abort DMA output          

FUNCTION:    DMAABT - Abort DMA output

15             8 7             0
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PORT NUMBER  |           62  |   162010
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

DESCRIPTION:

   Ends  a DMA  transfer  within two  character times  (due  to hardware
buffering) and  returns a TXDMAB  message with the  address of  the next
data that was to be sent.  This function shortens the transfer  but does
not change the transmitter state, ie., a TXEOM command may  be necessary
to properly terminate the transfer.  Other data transfer commands may be
issued  when the  XMTDOM  message arrives  (some time  after  the TXDMAB
message).






































TYMSHARE Network Technology Division, Cupertino, Ca.                  44
    o ;=